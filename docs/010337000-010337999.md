# StackOverflow 问答 10337000-10337999

# java - 使用 Struts html taglib 创建动态 html 表

> ID：10337001
> 
> 赞同：0
> 
> 时间：2012-04-26T15:54:55.523
> 
> 标签：java, html, struts

我想创建struts表单“html：form”，但在这个表单中输入例如“html：select”需要它来创建动态，我的意思是我将添加按钮，该按钮将为包含另一个struts html输入的表添加其他行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T08:54:29.580

使用 JavaScript：

HTML：

```
<table id="aTable">
    <tr><td>row 1</td></tr>
    <tr><td>row 2</td></tr>
</table>
<button id="newrow">Add row</>​ 
```

JavaScript

```
$(document).ready(function(){
  $("#newrow").click(function(){
    $('#aTable tr:last').after('<tr><td>row 3</td></tr>');
  } 
  );
});​ 
```

请参阅该小提琴： http: [//jsfiddle.net/vzasC/](http://jsfiddle.net/vzasC/)以运行此示例。

# c# - 简单的单词差异算法

> ID：10337006
> 
> 赞同：11
> 
> 时间：2012-04-26T15:55:09.280
> 
> 标签：c#, windows-phone-7, diff

我正在寻找一种简单轻量级的算法来比较两个简单的字符串。

例如，如果我们采用这两个字符串：

*   “敏捷的棕色狐狸跳过了懒狗”
*   “狡猾的棕色狐狸扑倒了疯狗”

它应该告诉我第二个单词的 2 个首字母不同，等等。

现在我有一个非常简单的算法来比较单词：

```
/// <summary>
    /// Make a diff between two strings and returns words indices
    /// </summary>
    /// <param name="a"></param>
    /// <param name="b"></param>
    /// <returns></returns>
    public static List<int> Diff(string a, string b)
    {
        List<int> indices = new List<int>();

        string[] asplit = a.Split(' ');
        string[] bsplit = b.Split(' ');

        for (int i = 0; i < asplit.Length; i++)
        {
            if (bsplit.Length > i)
            {
                if (asplit[i].CompareTo(bsplit[i]) != 0)
                {
                    indices.Add(i);
                }
            }
        }

        return indices;
    } 
```

所以这将告诉我哪些单词（使用空格字符拆分）是不同的。

我在这里阅读了许多关于实现复杂算法或使用现有库的主题。

但是我接受了 .NET 紧凑框架 (WP7) 的再培训，我不想要可以比较两个文件或两个文本的东西，我只需要一个单词比较。

有没有适合的库或算法？谢谢 ：）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T19:01:04.743

你可以看看[DiffPlex](http://diffplex.codeplex.com/)项目。

核心功能看起来像是在 \DiffPlex\Differ.cs 它甚至有一个 Silverlight 查看器，但它可能需要一些移植。

**编辑：**

我想补充一点，根据您的问题，DiffPlex 专门支持单词比较。隐藏在所有其他字符、线条等比较方法中可能并不明显。

# email - 从 SSRS 2005 报告发送电子邮件

> ID：10337010
> 
> 赞同：2
> 
> 时间：2012-04-26T15:55:29.170
> 
> 标签：email, reporting-services

我有一个使用 SSRS 2005 生成的报告。它包含多个页面，每个页面都有特定的员工信息，包括电子邮件地址。用户希望单击报告标题上的按钮，向此报告中的每个人发送一封电子邮件，并附上他/她的个人信息页面。任何帮助将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:20:28.033

您无法从已执行的报告中发送电子邮件。通过电子邮件发送报告的唯一方法是创建[订阅](http://msdn.microsoft.com/en-us/library/ms159762%28v=sql.100%29.aspx)

# java - 如何修复“构造函数调用可覆盖的方法”

> ID：10337011
> 
> 赞同：14
> 
> 时间：2012-04-26T15:55:29.763
> 
> 标签：java, constructor, overriding

我有以下设置，它给了我一条消息，指出“构造函数调用可覆盖的方法”。我知道这正在发生，但我的问题是如何修复它，以便代码仍然有效并且消息消失。

```
public interface Foo{
   void doFoo();
}
public class FooImpl implements Foo{
 @Override{
 public void doFoo(){
    //.. Do important code
 }
}
public class Bar{
  private FooImpl fi;
  public Bar(){
    fi = new FooImpl();
    fi.doFoo(); // The message complains about this line
  }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-10-08T20:02:24.233

> 正如@Voo 所说，
> 
> > 您的问题是关于在已经完全构造的对象上调用虚拟方法。在构造对象上调用虚方法的众所周知的缺点是众所周知的，但在这里不适用

**来自[Effective Java 2nd Edition](http://www.oracle.com/technetwork/java/effectivejava-136174.html)，第 17 项：设计和记录继承，否则禁止它：**

> 一个类必须遵守更多的限制以允许继承。构造函数不得直接或间接调用可覆盖的方法。如果您违反此规则，将导致程序失败。超类构造函数在子类构造函数之前运行，因此子类中的覆盖方法将在子类构造函数运行之前被调用。如果覆盖方法依赖于子类构造函数执行的任何初始化，则该方法将不会按预期运行。

在对象构造期间调用可覆盖的方法可能会导致使用未初始化的数据，从而导致运行时异常或意外结果。

**构造函数必须只调用最终或私有的方法**

您可以使用静态工厂方法来解决必须从`Bar class`.

**Effective Java，第 1 项：考虑静态工厂方法而不是构造函数**

> 类允许客户端获取自身实例的常规方法是提供公共构造函数。还有另一种技术应该成为每个程序员工具包的一部分。一个类可以提供一个公共静态工厂方法，它只是一个返回类实例的静态方法。

所以，你去有界面：

```
public interface Foo {
     void doFoo();
} 
```

和实施：

```
public class FooImpl implements Foo {
   @Override
   public void doFoo() {
   //.. Do important code
   }
} 
```

要使用您的工厂方法创建您的类，您可以通过以下方式工作：

*   `private Foo fi`使用接口而不是来定义类的变量，`private FooImpl fi`在具体类型上使用接口是良好封装和松散耦合代码的关键。

*   将您的默认构造函数设为私有，以防止在外部实例化您的类。

    private Bar() { // 防止实例化 }

*   删除对构造函数中存在的方法的所有调用。

*   创建你的静态工厂方法

最后你得到一个`Bar`带有工厂方法的类，如：

```
public class Bar {
    private Foo fi;

    private Bar() {// Prevents instantiation
        fi = new FooImpl();
    }

    public static Bar createBar() {
        Bar newBar = new Bar();
        newBar.fi.doFoo(); 

        return newBar;
    }
} 
```

我的老板说：“声纳警告是关于*症状*的，而不是关于*疾病*的。能治好病最好。” ！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-26T16:04:45.467

如果您以后不需要重写该方法，则可以将 doFoo 声明为 final：

`public final void doFoo() { }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:05:20.967

您的 IDE 会告诉您这一点，因为它可能不安全。您可以提供任何实现或 doFoo 并在启动时将所有 Bar 对象设置为不同的东西。在大多数情况下，这似乎是一个糟糕的设计选择。

似乎您在构造函数中使用了策略模式。在构造函数中使用策略或任何其他可覆盖的行为是不明智的。在其他地方使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-24T11:43:49.607

您看到的错误来源是[PMD](http://pmd.sourceforge.net/pmd-4.2.6/rules/design.html)（在此处搜索“overr”），并且在再次构建示例时，此版本的 PMD（4.2.6）不会触发此警告。Sonar 只是集成了 PMD、Checkstyle 等工具，并提供了一个概览。因此，请检查您使用的是哪个版本的声纳（和 PMD）。

您可以在 Sonar 中查看：`Sonar > Quality Profiles > Search for "overr"`应该突出显示您正在使用的规则。

在 Sonar 中，您可以检查您正在使用的 PMD 版本。转到`Sonar > Configuration > Update Center`，然后查看您正在使用的 PMD 版本。

# jsf-2 - 是否应该将 PARTIAL_STATE_SAVING 设置为 false？

> ID：10337015
> 
> 赞同：10
> 
> 时间：2012-04-26T15:55:39.763
> 
> 标签：jsf-2, myfaces, mojarra

似乎今天（2012 年 4 月），MyFaces 和 Mojarra 的 JSF 2.1 实现在部分状态保存方面都存在缺陷，并且 PARTIAL_STATE_SAVING 应该设置为 false。

这是真的？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-26T16:24:19.470

> *是否应该将 PARTIAL_STATE_SAVING 设置为 false？*

**仅**当您遇到与 web 应用程序中的部分状态保存相关的一般缺陷时，*实际上无法*以其他方式解决/变通。部分状态保存在整体性能和内存使用方面具有主要优势。另请参阅[为什么 JSF 将 UI 组件的状态保存在服务器上？](https://stackoverflow.com/questions/5474316/why-does-jsf-need-to-save-the-state-of-ui-components-on-the-server-side/5475564#5475564)

我不能 100% 可靠地代表 MyFaces，但在 Mojarra 中，当您绑定标签处理程序的任何属性时，部分状态保存问题的根本原因将显现出来（标签处理程序可以通过标签上缺少`rendered`属性来识别）例如 JSTL 标记）到视图范围的 bean，或者当您将 JSF 组件的`id`or`binding`属性绑定到视图范围的 bean 时（这些属性即在构建/恢复视图期间解析）。

[此问题是由JSF 问题 1492](https://github.com/eclipse-ee4j/mojarra/issues/1496)和[JSF 规范问题 787](https://github.com/javaee/javaserverfaces-spec/issues/787)中所述的鸡蛋问题引起的：启用部分状态保存后，视图范围的 bean 存储在部分视图状态中。因此，要提取视图范围的 bean，必须恢复部分视图状态。在恢复（构建）视图期间，将评估所有上述属性中的 EL。但是，由于此时没有可用的视图范围 bean 实例，因此将创建一个全新的实例。但是，这会将其所有属性设置为默认值！在恢复视图并取回原始视图范围的 bean 后，它们将被放回视图范围，覆盖在恢复视图期间创建的（临时）实例。但是这些属性的 EL 表达式已经基于完全不同的实例进行了评估，无法恢复。

自 Mojarra 2.1.18 和 2.2.0 以来，通过在会话中存储视图范围的 bean 解决了这个鸡蛋问题。如果由于某种原因无法升级，那么这确实可以通过设置为来禁用部分状态保存来`javax.faces.PARTIAL_STATE_SAVING`解决`false`。另一种方法是*根本不*将上述属性绑定到视图范围的 bean，而是寻找替代解决方案。

您也可以`javax.faces.FULL_STATE_SAVING_VIEW_IDS`改为设置。这允许您指定需要关闭部分状态保存的所有视图 ID 的逗号分隔列表：

```
<context-param>
    <param-name>javax.faces.FULL_STATE_SAVING_VIEW_IDS</param-name>
    <param-value>/some.xhtml,/other.xhtml</param-value>
</context-param> 
```

这使您可以尽可能多地从部分状态保存中受益，并且仅为部分状态保存相关问题实际上无法修复的视图子集关闭它。

### 也可以看看：

*   [JSF 2.0 中的通信 -`@ViewScoped`在标记处理程序中失败](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ViewScopedFailsInTagHandlers)

# javascript - YUI 中的 onDomReady 在 DOM 似乎准备好之前触发？

> ID：10337018
> 
> 赞同：1
> 
> 时间：2012-04-26T15:55:52.127
> 
> 标签：javascript, yui

我有一个非常特殊的情况。

我正在调试一个用相当复杂（而且速度很慢）的框架编写的 Web 应用程序中的问题。

作为代码的一部分，它在 YUI 中加载并运行以下脚本：

```
function() {
    YU.Event.onDOMReady(function() { init(); });
} 
```

`init()`JS函数在哪里。

**问题**：有时（大约 1/2 次），当调用 init() 函数时，似乎还没有加载 DOM。更准确地说，`document.getElementById();`调用返回`null`值，当我加载 Internet Explorer 调试器 (IE8) 并在 `getElementById()`调用行上设置断点时，调试器的 HTML 选项卡仅显示`"Loading..."`

（该应用程序与 FireFox 不兼容，因此我无法使用 Firebug）

我会很感激关于**为什么会发生这种情况**（只有 50% 的时间）以及如何进行调查的任何想法。

如果这有帮助，当有人对应用程序进行更改时问题就开始了，这涉及通过 appendChild() 向 DOM 动态添加一些东西

请注意，我正在专门寻找如何解决过早`onDOMReady()`调用，而不是像“`getElementById()`在循环中调用 setTimeout 直到非空的解决方法”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T16:15:18.703

如果您使用的是 DOM `appendChild()`，请改用 YUI 版本..

我发现如果我`appendChild()`直接在 Dom 对象上使用它并不能在所有浏览器（IE7）中工作。您使用的是 DOM`appendChild()`还是 YUI `appendChild()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-29T19:11:12.947

1.  该问题是特定于 IE8 的。它在 IE10 上消失了。

2.  I fixed it by adding a small wait loop. Interestingly, the loop didn't need to be long (couple milliseconds) - I'm at a loss as to WHY this fixed the issue on IE8, but it did.

# css - 更改悬停时元素的所有实例的属性（CSS）

> ID：10337020
> 
> 赞同：1
> 
> 时间：2012-04-26T15:55:59.763
> 
> 标签：css, hover, elements

我有一组文章元素，使用第 n 个子元素，奇数元素的背景颜色设置为蓝色，其余为红色。

见这里：http: [//jsfiddle.net/8KFwh/4/](http://jsfiddle.net/8KFwh/4/)

当您将鼠标悬停在其中一个上时，我希望能够将所有文章元素的背景颜色更改为白色。此外，您将鼠标悬停在上面的那个会将其背景颜色更改为绿色，除了一个之外，所有文章元素都是白色的。

我知道在 JS 中很容易做到，但我很想知道是否可以在 CSS 中做到。

谢谢，欢迎任何帮助:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:07:40.383

如果您将所有文章包装在一个 div 中，例如

```
<div class="hover-test">
    <article class="post">ABC</article>
    <article class="post">ABC</article>
    <article class="post">ABC</article>
    <article class="post">ABC</article>
</div> 
```

并使用这个 CSS 是可能的。

```
.post:hover {
background-color:green;
}

.hover-test:hover .post {
background-color: white;
}

.hover-test:hover .post:hover {
background-color: green;
} 
```

不过，这可能不适用于所有浏览器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-26T15:59:25.150

你的意思是这样吗？[http://jsfiddle.net/mkoistinen/8KFwh/5/](http://jsfiddle.net/mkoistinen/8KFwh/5/)

# mysql - MySQL正确的连接方法，用于包括和排除右表的一对多关系

> ID：10337024
> 
> 赞同：0
> 
> 时间：2012-04-26T15:56:14.710
> 
> 标签：mysql, join

我一直在尝试解决这个 MySQL 问题......问题的一半是我的问题的措辞，如果之前已经解决了，我深表歉意，我做了很多搜索，但无法找到解决方案。

我有两个表，分别称为 orders 和 order_items 每个订单可以包含许多订单项目。

我需要进行搜索以返回仅包含一个订单项目而不包含另一个订单的订单，反之亦然。

为了说明这一点：

表订单

```
order_id
1
2
3

```

表 order_items

```
order_item_id | order_item_type | order_id
1 | 一个 | 1
2 | 一个 | 2
3 | 乙| 2
4 | 乙| 3

```

我需要做的是获得仅包含项目 A、仅包含项目 B 以及两者的订单。

如您所见，只有项目 A 应该返回订单 1，只有项目 B 应该返回订单 3，并且两者都应该返回订单 2。

尽管我尽了最大的努力，但我什么也做不了。这是目前仅使用 A 项返回订单的尝试

```
    选择 *
    来自订单
    左外连接 order_items
    ON order_items.order_id = orders.order_id
    在哪里 order_items.order_item_type IN ('A')
    AND order_items.order_item_type 不在（'B'）
    GROUP BY orders.order_id

```

有经验的人可能会猜到我的尝试，这会返回订单 1 和订单 2。我认为这可能可以通过子查询来完成，但我相信可以通过正确的连接来完成......只是不知道如何去做吧。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:16:37.317

选择单个 order_item 时：

```
SELECT i.* FROM order_items i
WHERE i.order_item_type = 'A' AND
  (SELECT COUNT(order_id) FROM order_items WHERE order_id = i.order_id) = 1 
```

选择了两个ord​​er_item：

```
SELECT i.* FROM order_items i
WHERE i.order_item_type IN ('A', 'B') AND
  (SELECT COUNT(order_id) FROM order_items WHERE order_id = i.order_id) = 2 
```

并根据需要加入`orders`表格。

# python - 通过蛋黄或点子看到的包裹

> ID：10337029
> 
> 赞同：3
> 
> 时间：2012-04-26T15:56:43.507
> 
> 标签：python, pip, pymssql, yolk

我需要一些帮助来了解 pip 和 yolk 的工作原理

我跑了`pip install pymssql`，它安装了 pymssql 版本`2.0.0b1-dev-20111019`，但后来决定我想恢复到旧版本。

我跑去`yolk -V pymssql`检查我有哪些可用的版本，但它只返回 `pymssql 1.0.2`. 我安装的版本不应该也出现吗？

通过网站搜索 pypi 发现 1.0.2 是唯一可用的版本。这是否意味着 pip 正在使用 pypi 以外的资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T02:28:32.620

`yolk``PyPI`据我所知，仅通过 XMLRPC API 搜索，同时`pip`爬网寻找适合的“最佳”包 - 种子页面是`http://pypi.python.org/simple/<PACKAGE_NAME>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:28:12.820

是的，看看 pip.log 文件，看看它在哪里搜索包。我认为 yolk 只是查看在 pypi 上注册的内容，但 pip 正在到处寻找它可以找到的最新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:59:06.877

我通常使用 -flag （双详细或非常详细）运行`pip`...`-vv`在
htis 情况下会产生：

$ pip install -v -v --no-install pymssql

```
Downloading/unpacking pymssql
  Getting page http://pypi.python.org/simple/pymssql
  URLs to search for versions for pymssql:
  * http://pypi.python.org/simple/pymssql/
  Getting page http://pymssql.sourceforge.net
  Getting page http://sourceforge.net/project/showfiles.php?group_id=40059&amp;package_id=32202
  Getting page http://code.google.com/p/pymssql/
  Getting page http://code.google.com/p/pymssql/downloads/list
  Analyzing links from page http://pypi.python.org/simple/pymssql/
   [... snip ...]
  Found link http://pymssql.googlecode.com/files/pymssql-2.0.0b1-dev-20111019.tar.gz (from http://code.google.com/p/pymssql/), version: 2.0.0b1-dev-20111019
   [... snip ...]
  Using version 2.0.0b1-dev-20111019 (newest of versions: 2.0.0b1-dev-20111019, 2.0.0b1-dev-20111019, 1.0.2, 1.0.2, 1.0.1, 1.0.1, 1.0.0)
  Downloading pymssql-2.0.0b1-dev-20111019.tar.gz (5.0Mb): 
  Downloading from URL http://pymssql.googlecode.com/files/pymssql-2.0.0b1-dev-20111019.tar.gz (from http://code.google.com/p/pymssql/)
...Downloading pymssql-2.0.0b1-dev-20111019.tar.gz (5.0Mb): 5.0Mb downloaded
  Running setup.py egg_info for package pymssql
   [... snip ...] 
```

这样你就可以清楚地看到它的下载位置。

# mercurial - 使用 hg (Mercurial) 提交到私有开发服务器而不弄乱共享存储库的历史？

> ID：10337031
> 
> 赞同：3
> 
> 时间：2012-04-26T15:56:54.620
> 
> 标签：mercurial

我正在尝试使用 Mercurial 和私有开发服务器改进我们的开发过程，但需要一些关于我们情况下的最佳实践的建议。

*   我们有所有开发人员都可以访问的集中式 mercurial 存储库。
*   每个开发人员都有一台 windows 机器，并使用 NuSphere IDE 进行开发。
*   每个开发人员都有一个私有的 linux 开发服务器，通常在他们的本地网络上可用，但半定期需要通过 VPN 远程访问。

现在，我希望每个开发人员都能够进行开发工作，在他们的私有开发服务器上查看结果，并且在对一个块感到满意时能够将其推送到集中存储库并带有一个很好的提交消息。然后，这将在登台服务器上进行测试，然后继续运行。

但是每个开发人员应该如何通过他们自己的开发机器与他们自己的开发机器共享他们通过他们的 IDE 在他们的 Windows 机器上所做的更改。我曾尝试在开发机器上设置 SAMBA 共享，但通过远程连接速度非常慢。

有人告诉我，我也应该在这部分过程中使用 Mercurial。但是，如果每个开发人员都将所有更改提交到他们的本地存储库，然后在将更改推送到集中存储库时将其推送到他们的私有开发服务器，我们将有大量非常小的提交。这将削弱提交消息的质量，例如“添加丢失的}”、“修复错字 x”或完全丢失提交消息等。

我已经查看了有关合并提交历史的verious hg扩展，但我相信我会遇到问题，因为提交将存在于 2 个存储库（开发机器和开发服务器）上，并且从其中一个存储库中删除提交似乎会导致下次推送的问题。

如何使用 Mercurial 实现持续开发/提交到开发服务器的目标，同时又不混淆共享存储库的历史？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:16:44.803

看起来您想要 Rebase 功能与`--collapse`. 这允许您将分支压缩为单个提交。查看[RebaseExtension](http://mercurial.selenic.com/wiki/RebaseExtension)文档，尤其是查看`--collapse`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T08:48:46.257

我没有看到您提到的那种细粒度提交的问题。为什么要为了“更清晰的历史”而引入复杂的工作流程？细化提交也有许多优点，例如更改流程更易于理解和代码审查，并且您可以轻松挑选对其他人也有用的修复。

如果您的开发人员在推送到主存储库时输入了对合并提交中完成的工作的清晰描述，那么您可以通过只遵循主分支上的合并并忽略所有开发人员分支来遵循相对干净的开发路线。如果您需要更多详细信息，例如因为您想对特定问题进行代码审查或调试，您可以深入到分支中。

回覆。空提交消息，Mercurial 将拒绝签入丢失的提交消息，如果您的同事试图通过输入“。”来绕过它。或“-”，那么您可能应该责骂他们；p。或者添加一个传入的钩子，如果它们真的很顽固，它会阻止它们。

# xcode - Xcode/ ios5 - Long Touch 手势调用两次

> ID：10337032
> 
> 赞同：2
> 
> 时间：2012-04-26T15:56:54.683
> 
> 标签：xcode, uisegmentedcontrol, selected, gestures

我有一个分段控件，允许短手势和长手势。短手势识别很好。长手势方法被调用了两次。我在挠头，为什么。

这是构建颜色工具栏的代码的一部分：

```
UILongPressGestureRecognizer* longPressGestureRec =
    [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(longPress:)];
    longPressGestureRec.minimumPressDuration = 1.5;
    //longPressGestureRec.cancelsTouchesInView = NO;
    [colorControl addGestureRecognizer:longPressGestureRec]; 
```

这是 longPress 方法的一部分：

```
-(void) longPress:(id)sender {
    NSLog(@"%s", __FUNCTION__);     
    switch (colorIndex) {
        case 0:
            [self showMoreWhiteColors:(id)sender];
            break;

        case 1:
            [self showMoreRedColors:(id)sender];
            break; 
```

通过查看日志，我可以看到每次按住按钮时都会调用两次 longPress 方法。

任何想法我做错了什么，失踪，没有做......？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T02:12:37.237

我只是检查状态是否除了 UIGestureRecognizerStateBegan 之外的任何东西，然后在执行我想要的代码之前返回。所以：

```
-(void) longPressGesture:(UIGestureRecognizer*)gesture
{
    if ( gesture.state != UIGestureRecognizerStateBegan )
       return; // discard everything else

   // do something in response to long gesture
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-28T18:07:48.153

```
- (void)handleLongPress:(UILongPressGestureRecognizer *)gesture {
if(UIGestureRecognizerStateBegan == gesture.state) {
    // Called on start of gesture, do work here
}

if(UIGestureRecognizerStateChanged == gesture.state) {
    // Do repeated work here (repeats continuously) while finger is down
}

if(UIGestureRecognizerStateEnded == gesture.state) {
    // Do end work here when finger is lifted
} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-04T08:26:59.650

或者你可以这样做。

```
-(void)handleLongPress:(UILongPressGestureRecognizer *)gesture {
      switch(gesture.state){
       case UIGestureRecognizerStateBegan:

            // Do your stuff here.
            NSLog(@"State Began");
            break;
       case UIGestureRecognizerStateChanged:
            NSLog(@"State changed");
            break;
       case UIGestureRecognizerStateEnd:
            NSLog(@"State End");
            break;
       default:
            break;
      }
} 
```

# android - 什么是 postUrl：AlbumEntry insertEntry = myPicasa.insert(postUrl, myAlbum);

> ID：10337033
> 
> 赞同：0
> 
> 时间：2012-04-26T15:56:55.100
> 
> 标签：android, api, picasa

我正在尝试理解和使用 Picasa Api，我正在使用此示例[https://developers.google.com/picasa-web/docs/2.0/developers_guide_java?hl=nl-NL](https://developers.google.com/picasa-web/docs/2.0/developers_guide_java?hl=nl-NL)，所以我正在尝试使用以下代码创建一个新专辑：

```
AlbumEntry myAlbum = new AlbumEntry();

    myAlbum.setTitle(new PlainTextConstruct(title));
    myAlbum.setDescription(new PlainTextConstruct(description));

    AlbumEntry insertedEntry = myPicasa.insert(postUrl, myAlbum); 
```

现在是我的问题，我如何找到 postUrl，或者我必须在那里填写什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:08:04.797

根据链接的文档，`postURL`似乎是需要插入照片的相册的 ID。它可以在 Java 中这样构造：

```
URL albumPostUrl = new URL("https://picasaweb.google.com/data/feed/api/user/username/albumid/albumid"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:12:52.477

这是您添加相册所需要的。

```
URL postUrl = new URL("https://picasaweb.google.com/data/feed/api/user/" + username); 
```

# c# - 我可以从 C# 转换为 asp.Net 以在线托管应用程序吗？

> ID：10337035
> 
> 赞同：2
> 
> 时间：2012-04-26T15:56:59.503
> 
> 标签：c#, asp.net, flash, web-hosting

是否可以将 C# 应用程序转换为 asp.Net 网页？我想要做的就是在我的网站上显示应用程序！？该网站是用 Flash 制作的，如果我选择直接打开应用程序，它会下载 .exe，这不是我假装的。

编辑：应用程序只有大约 30 个按钮，除了第一个之外还有一个额外的表单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:05:47.883

您的所有标准 C# 类/库都应该顺利迁移。您将遇到的困难是将（大概）winforms 用户界面转换为功能齐全的 Web 界面。没有直接转换，但大多数 winforms 控件都有一个近似的 web 等效项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:00:22.107

[听起来像是CodeDOM](http://msdn.microsoft.com/en-us/library/650ax5cx.aspx)的一个很好的潜在候选者。本文应该为您[指明](http://www.codeproject.com/Articles/9307/Converting-WinForms-Web-Forms-using-CodeDom)正确的方向；它演示了如何将 Windows 表单转换为 Web 表单，并且从屏幕截图中看起来非常成功。

归根结底，手动处理它可能更容易。除非这是一个非常简单的应用程序，否则您可能不得不硬着头皮自己动手做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T16:00:26.343

我认为这个问题最简单的答案是，不。桌面应用程序和 Web 应用程序具有完全不同的结构，即使您可以在后面的代码中使用 C#。没有简单的方法可以将桌面应用程序项目转换为我所知道的 ASP.net 项目。

# python - 如何在 Google App Engine for Python 中在同一天但在不同时间发送电子邮件？

> ID：10337042
> 
> 赞同：0
> 
> 时间：2012-04-26T15:57:34.130
> 
> 标签：python, google-app-engine, cron-task

我使用 cron 任务在每个星期六 9:00 向我的应用程序用户发送邮件。但是如果有很多用户，这会不会有问题？如果是，我能做些什么来改进我的代码。我可以指定一个 cron 任务，例如“从 9:00 到 23:00”，以确保所有用户都能收到电子邮件吗？我听说过任务队列，但我不知道如何使用它。我真的需要吗？

编辑

我终于设法使任务队列使用此代码。

```
class SendMailHandler(webapp.RequestHandler):
    def get(self):
        members = Members.all()
        for member in members:
            taskqueue.add(url='/send', params={'sender_address':sender_address,
                                                   'user_address':user_address,
                                                   'subject':subject,
                                                   'html':html})

class SendMail(webapp.RequestHandler):
    def post(self):
        sender_address = self.request.get('sender_address')
        user_address = self.request.get('user_address')
        subject = self.request.get('subject')
        html = self.request.get('html')

        mail.send_mail(sender=sender_address, to=user_address, subject=subject, body='', html=html)

application = webapp.WSGIApplication([('/sendmail', SendMailHandler),
                                  ('/send', SendMail)], debug=True) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T19:19:01.400

App Engine cron 任务与 App Engine 中的其他任务一样，需要 10 分钟才能完成。如果您需要更多时间，您可以使用[后端](https://developers.google.com/appengine/docs/python/config/backends)，或者您可以将发送分成跨任务队列的块。

编辑：这是任务队列的文档：[https ://developers.google.com/appengine/docs/python/taskqueue/](https://developers.google.com/appengine/docs/python/taskqueue/)

如果我要编写这段代码（出于尼克详述的原因，我不会），我会做的是决定某种分片。假设您在“成员”数据库模型中有一个“收件人”字段：创建 26 个任务，其中一个将处理所有以“a”、“b”等开头的电子邮件地址。

您可能会发现该特定方案导致分布不均——也许一项任务最终完成了 50% 的工作，因为出于某种原因，您的大多数用户都有一个以“m”开头的电子邮件地址。如果发生这种情况，您可以改为基于“目标”地址的哈希进行分片。关键是要以某种方式分解您的成员并启动一个任务来处理每个块，并将块的一些标识符作为任务的参数。俗话说，编写代码和优化分片留给读者作为练习。（当然，如果您对实施有具体问题，请询问！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T15:40:50.247

我实际上只是有这个确切的问题。我以前从未对 stackoverflow 做出过回答，所以请善待。

我正在做的实际上是使用 cron 作业（安排在东部时间凌晨 3:30）来启动任务以进入任务队列。从那里您可以添加一个 ETA 作为创建任务的一部分。这接受 python 日期时间值。从这里你可以做逻辑来确定你是否需要现在运行任务，或者你是否想根据时区计算一个新的 ETA，等等。

这是我正在做的一小段代码。此代码是从我的 Cron 处理程序执行的。然后我会发送一封与您的做法类似的电子邮件。请注意，我将时区信息存储在 dic 中，并将其与从存储数据中获取的信息进行比较。这在未来可能不是超级灵活，但现在它适用于我需要做的事情。如果您有其他获取该信息的方法，则可以采用不同的方式。

```
bigtimezonedic = {'America/New_York' : 0, 'America/Detroit' : 0, 'America/Kentucky/Louisville' : : 0, 'America/Kentucky/Monticello' : 0, 'America/Indiana/Indianapolis' : 0, 'America/Indiana    /Vincennes' : 0, 'America/Indiana/Winamac' : 0, 'America/Indiana/Marengo' : 0, 'America/Indiana/Petersburg' : 0, 'America/Indiana/Vevay' : 0, 'America/Chicago' : 1, 'America/Indiana/Tell_City' : 1, 'America/Indiana/Knox': 1, 'America/Menominee' : 1, 'America/North_Dakota/Center' : 1, 'America/North_Dakota/New_Salem' : 1, 'America/Denver' : 2, 'America/Boise' : 2, 'America/Shiprock' : 2, 'America/Phoenix' : 2, 'America/Los_Angeles' : 3, 'America/Anchorage' : 4, 'America/Juneau' : 4, 'America/Yakutat' : 4, 'America/Nome' : 4, 'America/Adak' : 5, 'Pacific/Honolulu' : 5}

calendar_list = calendarHTML.all()
    for calendar in calendar_list:
         if bigtimezonedic.has_key(calendar.calendarTimeZone):
             if bigtimezonedic[calendar.calendarTimeZone] == 0:
                taskqueue.add(url='/emailsender',
                        params=dict(calendaruserid=calendar.userid,
                            calendarid=calendar.calendarId))
             else:
                taskqueue.add(url='/emailsender',
                        params=dict(calendaruserid=calendar.userid,
                            calendarid=calendar.calendarId),
                     eta=datetime.datetime.now() +
                     datetime.timedelta(hours=bigtimezonedic[calendar.calendarTimeZone]))
         else:
            logging.info('There is an unsupported timezone!') 
```

# html - 如何在中心的“li”中对齐多个图像

> ID：10337045
> 
> 赞同：1
> 
> 时间：2012-04-26T15:57:51.370
> 
> 标签：html, css, alignment

我正在做一个网站，但我不知道如何对齐包含在 <li> 中的图像。

在这里你可以看到页面 - [http://www.dansid.cz/praginfo/services.php?l=de](http://www.dansid.cz/praginfo/services.php?l=de)

我需要这些图像自动居中对齐，如何使用 CSS 做到这一点？

您可以通过右键单击 Firefox 或 Chrome 并单击检查元素来查看 CSS 等。

感谢您的回答:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:23:17.463

通过`li`si 中的图像假设您指的是在您的站点中找到的缩略图，您可以通过声明它们`display:inline-block`而不是`float:left`然后通过在其中设置`text-align:center`属性来简单地将它们居中在它们的容器中，如下所示：

```
#navlist li {
   display:inline-block;
   *display:inline; /* ie7 fix */
} 
```

注意：删除浮动属性。

```
#navlist {
   text-align:center;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T15:58:50.807

`text-align: center`尝试使用宽度大于图像的 li 元素的父 li

如果您想将整个 ul 与中心对齐，那么我建议给它以下属性：

```
margin: 0 auto;
display: block;
width: //your width; 
```

# java - 构建可重用的 Wicket 组件

> ID：10337049
> 
> 赞同：2
> 
> 时间：2012-04-26T15:58:01.257
> 
> 标签：java, forms, architecture, wicket

所以这不是一个非常普遍的问题，但我希望有人能给我一些关于架构的指导，以便我可以构建以下可重用的检票口组件。

这是skitch上的粗略草图：

[https://skitch.com/cmagnollay/8sn2s/multitextform](https://skitch.com/cmagnollay/8sn2s/multitextform)

我知道，画得很棒吧？所以本质上，这个表单组件（我认为这是使用正确的类）将用于在表单上添加用户定义的输入数量。当用户点击 TextInputField 旁边的 - 按钮时，它会删除该 inputField。当他们点击 + 按钮时，会添加一个新的空白字段。显然，当用户单击按钮时，组件将需要使用 AJAX 来更新组件，但我的问题是如何构建它。这是一节课吗？两个（一个用于整个组件，一个用于带有 - 按钮的输入字段），我应该使用哪些类来执行此操作？我希望对象尽可能通用以促进重用。这是我到目前为止所拥有的：

```
public class MultiTextInput<T> extends FormComponent<List<T>>
{
    private static final long serialVersionUID = 1L;

    private final String removeInputButtonName = "removeInputButton";
    private final String addInputButtonIdName = "addInputButton";

    private int numInputs = 1;
    private List<TextField<T>> inputFieldList = new ArrayList<TextField<T>>();

    public MultiTextInput(String id, IModel<T> model) 
    {
        super(id);

        inputFieldList.add(new TextField<T>("input1", model));

        add(inputFieldList.get(0));
        addAddInputFieldMarkup();
    }

    /**
     * Adds an "add" button.
     */
    private void addAddInputFieldMarkup()
    {
        Button addInputButton = new Button(this.addInputButtonIdName + numInputs);
        addInputButton.add(new AjaxFormComponentUpdatingBehavior("onclick"){

            private static final long serialVersionUID = 1L;

            @Override
            protected void onUpdate(AjaxRequestTarget target) 
            {
                numInputs++;

                inputFieldList.add(new TextField<T>("input" + numInputs));

                target.add(MultiTextInput.this);
            }

        });
    }

    /**
     * Adds a "remove" button.
     */
    private void addRemoveInputFieldMarkup()
    {
        Button removeInputButton = new Button(this.removeInputButtonName + numInputs);
        removeInputButton.add(new AjaxFormComponentUpdatingBehavior("onclick"){

            private static final long serialVersionUID = 1L;

            @Override
            protected void onUpdate(AjaxRequestTarget arg0)
            {
                // TODO Auto-generated method stub

            }

        });
    }

} 
```

正如我所说，我只是想习惯于考虑制作 Wicket 组件。我在 OO 方面有很多经验，但并不是特别在 wicket 方面。感谢您的帮助和指导！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T21:06:37.663

我想实现所需行为的最简单方法是使用由 List 支持的 ListView。并在按下添加/删除按钮后重新加载。

这是一个代码涂鸦（未经测试）

```
public abstract class MultiTextPanel<T> extends Panel {

public MultiTextPanel(String id, IModel<ArrayList<T>> model) {
    super(id, model);

    final Form<ArrayList<T>> multiTextForm = new Form<ArrayList<T>>("multiTextForm", model);
    add(multiTextForm);

    final ListView<T> listView = new ListView<T>("listView", model) {

        @Override
        protected void populateItem(final ListItem<T> item) {
            // TODO Auto-generated method stub
            TextField<T> textField = new TextField<T>("textField", item.getModel());
            add(textField);

            AjaxSubmitLink removeButton = new AjaxSubmitLink("removeButton", multiTextForm) {

                @Override
                protected void onSubmit(AjaxRequestTarget target, Form<?> form) {
                    multiTextForm.getModelObject().remove(item.getModelObject());
                    target.addComponent(multiTextForm);
                }

                @Override
                protected void onError(AjaxRequestTarget target, Form<?> form) {
                    //errors should be ignored, we shoudlnt validate in our form, so this shouldnt happen anyway
                    multiTextForm.getModelObject().remove(item.getModelObject());
                    target.addComponent(multiTextForm);
                }

            };              
            add(removeButton);

        }

    };
    add(listView);

    AjaxSubmitLink addButton = new AjaxSubmitLink("addButton", multiTextForm) {

        @Override
        protected void onError(AjaxRequestTarget target, Form<?> form) {
            //errors should be ignored, we shoudlnt validate in our form, so this shouldnt happen anyway
            multiTextForm.getModelObject().add(createNewT());
            target.addComponent(multiTextForm);
        }

        @Override
        protected void onSubmit(AjaxRequestTarget target, Form form) {
            multiTextForm.getModelObject().add(createNewT());
            target.addComponent(multiTextForm);
        }
    };
    add(addButton);

}

public abstract T createNewT();} 
```

基本的html：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:wicket="http://wicket.sourceforge.net/" xml:lang="en" lang="en">
<wicket:panel>
    <form wicket:id="multiTextForm">
        <wicket:container wicket:id="listView">
            <input type="text" wicket:id="textField" />
            <a wicket:id="removeButton">-</a>
        </wicket:container>
    </form>
    <a wicket:id="addButton">+</a>
</wicket:panel> 
```

我所做的唯一特别的事情是在 ListView 周围放置一个表单，这样我们就可以在我们创建的面板中提交（在这个阶段很可能不需要验证，应该以如下形式完成保存屏幕）。

此实现的缺点是您将始终重新加载完整的表单，因此会产生大量开销。仅添加/删除 1 行，但重新渲染 n(-/+)1。

# php - 如何显示当前有多少用户在线

> ID：10337050
> 
> 赞同：1
> 
> 时间：2012-04-26T15:58:10.370
> 
> 标签：php, ajax, jquery

我需要向我的用户展示当前在线的其他用户我可以维护登录和注销日志，基于此我可以计算在线人数，但很多时候用户没有注销，所以我的计数无效.

以下是显示用户在线的标准：

1.  用户刚刚登录

2.  用户当前正在查看页面

3.  用户打开了左侧选项卡，但当前正在另一个选项卡中浏览

4.  使用已打开选项卡，但已最小化网络浏览器

以下是不应在线显示使用的标准

1.  用户已登出；

2.  用户 dosent 希望在线显示

3.  用户关闭了浏览器并打开了选项卡

4.  用户关闭浏览器

我不知道该怎么做。我在服务器端使用 php 和 mysql 和 mongo db 作为数据库，请帮助我...

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-26T16:32:26.260

只有一种方法可以确保用户“在线”。要做到这一点，您需要了解“在线”人们通常指的是当时在线的**用户**；虽然检查这并不容易（甚至不可能），但检查用户是否在`x`一段时间内进行了任何操作非常容易，这是大多数程序员的选择。

这很容易：

1.  您在名为 的数据库中为每个登录用户创建一个字段`last_activity`。
2.  每次用户访问您设置`last_activity`为当前`time()`标记的页面。
3.  您定义用户在被视为*离线*`$x`之前可以空闲（不浏览任何新页面）的秒数。（通常是 15 分钟或 30 分钟或 1 小时）。
**   你做一个简单的查询，比如`"SELECT * FROM users WHERE last_activity >= ". (time() - $x)`*   `$x`您现在有一个在几秒钟内加载页面的用户列表。*

 *与其他事情不同，在 PHP 和 Web 浏览器中，无法确定用户何时关闭了浏览器中的某个页面，因此从技术上讲，不可能知道用户何时关闭了浏览器窗口或退出了您的网站。

顺便说一句，我撒了谎，有一种方法，但它真的很贵，所以请多考虑一下，因为它可能会使您的服务器崩溃或类似的事情：

1.  在用户表中创建`last_activity`字段（如下所示）。
2.  创建每秒钟都`y`需要的 Javascript 代码（使用 AJAX） `update.php`（只是一个示例）。
3.  将该 javascript 放在您网站的每个页面中（考虑`y`是更大的数字（< 30 秒可能不好））。
4.  创建使用当前戳`update.php`更新的位置。`last_activity``time()`
5.  `$x = $y + 1`当您想找出在线人时，请执行与之前使用相同的查询。

使用最新的解决方案，您可以*确保*当用户不再在页面上时，他也不会运行 AJAX 调用，然后在`y`几秒钟内将不再被视为在线。这是一个与第一个非常相似的解决方案，但您可以设置`y`为小于前一个`x`. 通过这种方式，您可以获得有关用户浏览器窗口当前状态的更多信息，但您的数据库负载比以前要多得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:01:31.130

几乎所有显示用户在线的网站实际上都显示“用户在最后 X 分钟内在线”。只需跟踪每个用户上次加载页面的时间，并计算在最后 X 分钟内有多少用户这样做（X 是您想要考虑的“在线”）*

# ruby-on-rails - ruby(1.9.3) on rails(3.2.3) Activerecord-odbc-adapter

> ID：10337051
> 
> 赞同：5
> 
> 时间：2012-04-26T15:58:10.370
> 
> 标签：ruby-on-rails, ruby, activerecord, odbc

我有一个遗留数据库（Progress OpenEdge），需要用于无数报告。我可以使用 ruby​​ 1.8.6 和 rails 2.0（odbc-adapter 和 odbc-rails）。

由于不再支持 1.8.6 并且 rails 2.0 很旧，我想更新。3.2.3 是否支持 odbc-adapter？

任何输入表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T09:44:31.457

你必须在你的 gemfile 中加入以下行： gem 'ruby-odbc' 然后运行 ​​bundle install。

我想这就是你要找的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T11:07:58.273

除了使用来自 Elevate Software 的名为 DBISAM 的旧数据库外，我遇到了同样的问题。

DBISAM 不支持很多东西。但我需要更新数据库上的内容，而且我不是 wWindows 生态系统爱好者。

我会查看`ruby-odbc`并向大家报告

**编辑** 我发现使用 RDBI 解决了我的问题。`gem rdbi`

# .htaccess - 如何在 .htaccess 重定向中使用“NOT”运算符？

> ID：10337057
> 
> 赞同：2
> 
> 时间：2012-04-26T15:58:29.670
> 
> 标签：.htaccess, redirect

我正在使用 .htaccess 将用户从多个旧域重定向到新域。像这样的东西：

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{HTTP_HOST} oldsite1.com
RewriteRule ^(.*)$ http://newsite.com%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} oldsite2.com
RewriteRule ^(.*)$ http://newsite.com%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTP_HOST} oldsite3.com
RewriteRule ^(.*)$ http://newsite.com%{REQUEST_URI} [R=301,L] 
```

但是，我想知道是否可以使用 NOT 运算符重定向除 newsite.com 之外的任何域，如下所示：

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond != %{HTTP_HOST} http://newsite.com
RewriteRule ^(.*)$ http://newsite.com%{REQUEST_URI} [R=301,L] 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:05:02.160

官方手册：[http ://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)

您放置`!=`在错误的位置 PLUS`%{HTTP_HOST}`仅包含域名，因此不应存在任何协议：

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{HTTP_HOST} !=newsite.com
RewriteRule ^(.*)$ http://newsite.com%{REQUEST_URI} [R=301,L] 
```

# powershell - PowerShell 1.0 版 - 写入事件日志

> ID：10337059
> 
> 赞同：3
> 
> 时间：2012-04-26T15:58:43.300
> 
> 标签：powershell, event-log

我们有一个使用 PowerShell 1.0 的客户端。我知道在 PowerShell 2.0 中，我有`Write-EventLog` *commandlet*。但是，这不会出现在 PowerShell 1.0 中。我希望我的脚本将事件记录到事件日志中，主要用于调试目的。

如何使用 PowerShell 1.0 执行此操作：？而且，不，我无法将此计算机升级到 PowerShell 2.0。这是一台客户生产机器，他们不想触碰上面的软件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:11:12.433

您可以使用 .NET EventLog 类来执行此操作。使用起来非常简单，例如：

```
$eventSource = "MyAppName"
if (![Diagnostics.EventLog]::SourceExists($eventSource))
{
    [Diagnostics.EventLog]::CreateEventSource($eventSource, "Application")
}

[Diagnostics.EventLog]::WriteEntry($eventSource, "message", [Diagnostics.EventLogEntryType]::Error) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T17:09:21.480

您可能只需访问[.NET EventLog 类](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)即可写入日志。

# zend-framework - ZF 在插件中使用占位符

> ID：10337060
> 
> 赞同：0
> 
> 时间：2012-04-26T15:58:49.823
> 
> 标签：zend-framework, plugins, placeholder

我正在尝试实现一个插件来处理对持久事务中成功或失败的用户的响应。当响应为假时，我对执行表单提交的操作使用 _forward 并显示占位符消息，但是当响应为真时，我使用 _redirect 来浏览并显示新记录。

我的问题是，当我使用 _redirect 时，浏览器不显示占位符消息。我将在这里显示代码：

```
/**
 * Plugin
 */
class Application_Plugin_PostMessage extends Zend_Controller_Plugin_Abstract
{

  public function postDispatch(Zend_Controller_Request_Abstract $request)
  {
      $message = $request->getParam('message');
      $error = $request->getParam('error');

      if (null !== $message || null !== $error) {
          $layout = Zend_Layout::getMvcInstance();
          $view = $layout->getView();
          $placeHolder = $view->placeholder('message');
          $placeHolder->setPostfix('</div>');

          if (null !== $error) {
              $placeHolder->setPrefix('<div class="errorMessage">')
                          ->append($error);
          }
          elseif (null !== $message) {
              $placeHolder->setPrefix('<div class="infoMessage">')
                          ->append($message);
          }
      }
  }

}

/**
 * Controller
 */
class My_FooController extends Zend_Controller_Action
{
    public function init()
    {
        $front = Zend_Controller_Front::getInstance();
        $front->registerPlugin(new Application_Plugin_PostMessage());
    }

    ...

    public function browseAction()
    {
        ...
        // No message is shown here on redirect
        ...
    }

    public function newAction()
    {
        ...
        // This code shows the placeholder on _forward call
        ...
    }

    public function insertAction()
    {
        if(true) {
            return $this->_redirect('/my/foo/browse?message='
                 . urlencode("success message"));
        }
        else {
            return $this->_forward('new', null, null, array(
                'error' => 'error messsage'
            ));
        }
    }

} 
```

我不能在成功时使用 _forward，因为我不想使用 [F5] 键重复插入操作

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:04:18.813

这就是 Flash Messenger 的用途：

[http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelper.flashmessenger.basicusage](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelper.flashmessenger.basicusage)

它将消息存储在您的会话中，无需像您一样传递消息。

# c - 如何使用C程序获取当前位置的字符？

> ID：10337062
> 
> 赞同：0
> 
> 时间：2012-04-26T15:58:50.260
> 
> 标签：c, file-io, fseek

我正在尝试编写一个 C 程序来获取文件中偏移一些字节的字符，让我们说三个如下

```
fseek(fp,3,SEEK_CUR); 
```

我希望打印该特定字节所代表的字符。例如，如果我的文件包含类似下面的内容，我需要每隔三个字符打印一次。

```
//reading from file// 
```

问题是使用`while`循环后我无法打印所需的结果。打印的第一个字符是第四个字符而不是第三个字符。

```
while(fp!=EOF)
{
    fseek(fp,3,SEEK_CUR);
    ch = fgetc (fp);
    printf("%c",ch);
} 
```

你能帮我理解这有什么错误吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:03:12.193

`fgetc`将文件偏移量移动一。尝试以下操作：

```
fseek(fp,3,SEEK_CUR);
while(fp!=EOF)
{
    ch = fgetc (fp); // moves offset by 1
    fseek(fp,2,SEEK_CUR); // moves offset by another 2
    printf("%c",ch);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:04:01.583

fgetc 还将文件指针前移一个字符。因此，循环的每次迭代都会将文件指针推进总共 4 个字符。出于您的目的，听起来您只想将 3 更改为 2：`fseek(fp,2,SEEK_CUR);`

# java - 可以在超类中声明一个返回子类类型对象的方法吗？

> ID：10337066
> 
> 赞同：0
> 
> 时间：2012-04-26T15:58:53.677
> 
> 标签：java, generics, type-safety

我有一个名为 Calculator 的类，它被许多其他类扩展。它有一个名为 intern() 的方法，内容如下：

```
 public DailyValueCalculator intern() {
    if (TimeSeriesIterator.containsMatchingCalculator(this)) {
        TimeSeriesIterator.removeCalculator(this);
        return TimeSeriesIterator.getMatchingCalculator(this);
    } else {
        return this;
    }
} 
```

如果我有一个叫做 bc 的 BetaCalculator，我希望能够通过说来实习它

```
bc = bc.intern(); 
```

目前虽然我不得不说

```
bc = (BetaCalculator) bc.intern(); 
```

有什么方法可以使 intern() 方法始终具有调用它的类型的返回类型？如果没有办法做到这一点，有没有理由不可能做到这一点？

我知道的可能的解决方案虽然不满意：

1.  在我编写的每个计算器中重写 intern() 方法
2.  将 intern() 方法传递给一个 Class 并让它返回一个 T（例如

    <T extends DailyValueCalculator> T intern(Class<T> returnType){...}

3.  给 DailyValueCalculator 一个类型 <T>（即使其成为 DailyValueCalculator<T>），所有子类都需要指定 T 等于子类的类型，然后让 intern() 返回一个 T。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:05:46.513

如果你自己键入你的超类，你可以做到这一点。这是一个例子：

```
public abstract class SuperClass<S extends SuperClass<S>> {

    public S intern() {
        return (S) this;
    }

    public static class SubClass extends SuperClass<SubClass> {

        private void methodOnlyInSubClass() {
            System.out.println("subclass method");
        }

        public void myMethod() {
            SubClass sub = intern();
            sub.methodOnlyInSubClass();
        }

    }

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-26T16:04:22.160

不，没有办法做到这一点。想一想：我知道你知道 intern 方法只会返回同一个类，但是编译器怎么可能呢？

# android - Android DatePicker 日期格式可以修改吗？

> ID：10337069
> 
> 赞同：2
> 
> 时间：2012-04-26T15:59:01.930
> 
> 标签：android, datepicker

Android 开发者网站[http://developer.android.com/resources/tutorials/views/hello-datepicker.html](http://developer.android.com/resources/tutorials/views/hello-datepicker.html)上的基本 DatePicker似乎以 4-26-2012 格式显示。可以将该格式更改为 04-26-2012 吗？它似乎显示 Md-yyyy 但我需要它显示 MM-dd-yyyy 所以 01-01-2012 而不是 1-1-2012。可以像这样调整基本的 DatePicker 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:29:31.493

希望你只在哪里寻找这个。要覆盖 DatePicker 格式，最好的办法是覆盖其构造函数之一，并对原始代码稍作编辑。您可以在代码中为您编辑 ViewGroup，但我会认真考虑不这样做。

请参阅此[Android：如何将 DatePicker 视图日期格式从 MM/dd/yyyy 更改为 dd/MM/yyyy？](https://stackoverflow.com/questions/7208769/android-how-to-change-the-datepicker-view-date-format-from-mm-dd-yyyy-to-dd-mm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T17:06:00.890

您知道您可以提取日期、月份、年份、小时、分钟和秒，然后将其填充并以您想要的任何格式使用。只需创建一个函数。这就是我在处理 .NET Web 服务、SQL Server 和 android 时解决日期问题的方法。

# ruby-on-rails-3 - 使用 Memcached / Dalli 从缓存中排除图像

> ID：10337076
> 
> 赞同：2
> 
> 时间：2012-04-26T15:59:16.440
> 
> 标签：ruby-on-rails-3, caching, memcached, dalli

我最近使用 Dalli gem 为我的 Rails 应用程序使用 memcached heroku 插件实现了缓存。但我发现，当部署到 Heroku 时，它还会缓存我的所有静态资产，包括图像，这很快就会炸毁我的 memcached 大小。heroku 日志的示例看起来像

```
cache: [GET /assets/application.css] fresh
app[web.1]: cache: [GET /assets/sign-in-twitter.gif] fresh
app[web.1]: cache: [GET /assets/ajax-loader.gif] fresh
app[web.1]: cache: [GET /assets/sign-in-facebook.gif] fresh 
```

特别是对于索引页，对于每个不同的请求，缓存大小都会增加大约 5MB。这种行为是可配置的吗？我可以将 memcached 配置为仅缓存我的片段缓存而不是主动缓存每个页面中的每个图像吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-23T05:55:39.047

使用 dalli gem，在`config/environments/production.rb`：

```
config.action_dispatch.rack_cache = {
  :metastore => Dalli::Client.new,
  :entitystore => '文件:tmp/cache/rack/body',
  :allow_reload => 假
}

```

上述配置将元存储信息缓存在 memcached 中，但将资产的实际主体缓存到文件系统中。

在`config/application.rb`：

```
如果！Rails.env.development？&& !Rails.env.test?
  config.middleware.insert_before Rack::Cache, Rack::Static, urls: [config.assets.prefix], root: 'public'
结尾

```

**Rack::Static 用法：**
  Rack *::Static*中间件提供带有匹配前缀的 url 到根目录。在这里，我将*config.assets.prefix*作为我的 url 前缀，默认为*'/assets'*。*这应该直接从public/assets*目录中提供任何资产，而不是点击*Rails::Cache*。这仅在您在生产中运行*'rake assets:precompile'*时才有效，否则*'public/assets'*中将没有预编译的资产。

# mysql - 当键自动递增时插入忽略？

> ID：10337082
> 
> 赞同：0
> 
> 时间：2012-04-26T15:59:25.610
> 
> 标签：mysql

我有一个非常基本的表，由一个 auto_incrementing id 列（主键）和一个包含一些不同文本的 TEXT 列组成。

我需要在这个表中插入数据，但我不想插入重复的行。我想使用`INSERT IGNORE INTO`但显然`IGNORE`使用表的键来确定该行是否重复。由于我表中的关键字段是自动递增的，这意味着重复项永远不会出现。

我的桌子设计有更好的方法吗？TEXT 列是否也需要成为键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:01:24.393

为您的 TEXT 列创建一个唯一索引：

错误将被忽略。

见[http://dev.mysql.com/doc/refman/5.1/en/insert.html](http://dev.mysql.com/doc/refman/5.1/en/insert.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:04:30.510

**编辑：**只需按照本教程，您应该设置 [http://www.tutorialspoint.com/mysql/mysql-handling-duplicates.htm](http://www.tutorialspoint.com/mysql/mysql-handling-duplicates.htm)

您已经拥有的要点，只需将 TEXT 设置为主键，您就不必担心，只要您像前面所说的那样执行 Insert Ignore。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:14:31.860

我建议使用前插入触发器并使用前 255 个字符的哈希 (MD5)

运行此示例

```
drop database if exists jakobud;
create database jakobud;
use jakobud
create table mytext
(
    id int not null auto_increment,
    txt text not null,
    txtmd5 char(32) not null default '',
    primary key (id),
    unique key (txtmd5)
);
DELIMITER $$    
CREATE TRIGGER mytext_bi
    BEFORE INSERT ON mytext
    FOR EACH ROW    
BEGIN
    DECLARE found_count INT;

    SELECT COUNT(1) INTO found_count
    FROM mytext WHERE txtmd5 = MD5(LEFT(new.txt,10));
    IF found_count = 1 THEN
        SELECT COUNT(1) INTO found_count FROM table_that_does_not_exist;
    END IF;
    SET new.txtmd5 = MD5(LEFT(new.txt,10));
END; $$    
DELIMITER ; 
```

然后将一堆数据加载到mytext中

这将忽略前 255 个字符的 MD5 重复项。

我是这样写的，所以你不需要在 txt 字段本身上创建索引

有什么好处？auto_increment 不会跳过，因为如果输入的文本的前 255 个字符的 MD5 不是唯一的，我会故意中断触发器

试试看 ！！！

# objective-c - 如何替换字符串中的部分字符串？

> ID：10337083
> 
> 赞同：2
> 
> 时间：2012-04-26T15:59:29.700
> 
> 标签：objective-c, ios, replace, nsstring, str-replace

我想替换字符串中的字符串。让我解释一下我的确切目标是什么。

这是我的字符串

```
<p>Hello Webseite i want to replace<p>thisPTag</p>which is in the middle 
of the word or in the end of the sentence</p>. 
```

如果我使用

```
[string stringByReplacingOccurrencesOfString:@"<p>" withString:@"|break|"]; 
```

它只替换第一个

**. 但我想替换**所有 p 标签**，不管是否在句子中，之前或之后的空格也没关系。
**那么我该怎么做呢？****

 **不是很重要，但很高兴知道：
请记住，我不想剥离 html，我只想替换 p-tag 以在此处设置中断以获取正确的 SSML 和 TTS（文本转语音）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T16:17:42.603

它有效（全部`<p>`被替换）。你可能只是混淆`<p>`和`</p>`. 这些是不同的文字，因此必须单独替换它们：

```
NSString * a = @"<p>Hello Webseite i want to replace<p>thisPTag</p>which is in the middle of the word or in the end of the sentence</p>. ";

NSString * b = [a stringByReplacingOccurrencesOfString:@"<p>" withString:@"|break|"];
b =  [b stringByReplacingOccurrencesOfString:@"</p>" withString:@"|break|"];

NSLog(@"%@",b); 
```

这打印：

> |break|你好网站我想替换|break|thisPTag|break|位于单词中间或句尾的|break|。**

# jquery - 无法为文件上传输入值调用 jQuery Ajax 方法

> ID：10337086
> 
> 赞同：0
> 
> 时间：2012-04-26T15:59:37.233
> 
> 标签：jquery

我正在尝试从 jQuery 调用服务器端方法。它在 Firefox 中运行良好，但在 IE8 和 IE9 中运行良好。

请找到以下代码示例：

```
 <div>  
    <asp:FileUpload ID="flAppIcon" runat="server" onchange="GetFileSize();"/>
    <asp:HiddenField ID="_hdnAppIcon" runat="server" Value="0" />
</div>

<script type="text/javascript" language="javascript">
    function GetFileSize() {
        var PageURL = '<%= ResolveUrl("~/WebForm16.aspx") %>'
        var test = ($('#<%=flAppIcon.ClientID%>').val()).toString();
        $("#<%=_hdnAppIcon.ClientID%>").val(test);
        alert($("#<%=_hdnAppIcon.ClientID%>").val());
        $.ajax({
            type: "POST",
            url: PageURL + '/GetFileSizeDetails',
            data: '{file: "' + $("#<%=_hdnAppIcon.ClientID%>")[0].value + '"}',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: OnSuccess,
            failure: function (response) {
                alert(response.d);
            }
        });
    }

    function OnSuccess(response) {
        alert(response.d);
    }
</script> 

[System.Web.Services.WebMethod]
public static string GetFileSizeDetails(string file)
{
    return "100";
} 
```

谁能帮我知道这个问题的根本原因？

谢谢和问候， 桑托什库马尔帕特罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:23:36.287

由于`$("#<%=_hdnAppIcon.ClientID%>")[0].value`具有格式：`C:\fakepath\your-file.jpg`，当它通过 WebMethod 转到服务器端时，它将不是有效的 JSON

您正在选择文件路径而不是大小。根据您的函数名称，我假设您希望将文件大小发送回服务器。

尝试使用

```
$("#<%=_hdnAppIcon.ClientID%>")[0].files[0].size 
```

代替

```
$("#<%=_hdnAppIcon.ClientID%>")[0].value 
```

# cordova - “启动并运行”问题（Phonegap 2012 年 4 月）

> ID：10337093
> 
> 赞同：0
> 
> 时间：2012-04-26T16:00:15.453
> 
> 标签：cordova

**在建立了一些移动网站之后，我真的很想冒险并开始使用 Phonegap。**我在安装了 OS X 10.7.3 的 MacBook Pro 上。获得了最新版本的 Xcode、git、ant 和 make。

从 phonegap 网站下载了最新的 phonegap 版本（即 Cordova.dmg）并安装了它，虽然我不确定它去了哪里以及我是否需要对它做任何其他事情。我认为，由于我可以在 Xcode 中将单页视图视为 iOS 应用程序选项，这应该足以证明它已正确安装。对？

无论如何，我已经在 Google-d 中寻找了基本的 phonegap 教程，而我真正喜欢的那个是[PhoneGap Beginner's Guide](http://www.netmagazine.com/tutorials/getting-started-phonegap) ，因为它作为一个 phonegapp 新手对我说话，并附有分步说明。

但是，有一些问题让我无法继续前进。我明白了：

```
 $ git clone git://github.com/phonegap/phonegap-iphone.git 
```

这就是麻烦开始的时候。我收到以下消息：

```
Cloning into 'phonegap-iphone'...
  fatal: remote error: 
Could not find repository phonegap/phonegap-iphone 
```

好的，所以可能存储库已关闭，我开始寻找其他存储库。而且我已经 git 下载了一些可用的存储库。. . 但他们中的任何一个都没有 phonegap-iphone.git 文件夹/分支或任何应该正确调用的东西。（是的，我也是一个 git 初学者。）

所以我永远不会：

```
$ cd phonegap-iphone
$ make $ open PhoneGapLibInstaller.pkg 
```

是因为有些东西过时了吗？我无法访问正确的 github 存储库吗？

任何指向最新 phonegap 教程的指针和/或链接将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T05:13:42.823

好吧有几件事...

1.  欢迎来到Phonegap / Cordova！

2.  安装 DMG，您将需要所有 phonegap / cordova 框架

3.  安装后，我强烈建议您开始关注 Google 群组（许多非常优秀、聪明的人正在努力使平台变得更好）[链接](https://groups.google.com/forum/?fromgroups#!forum/phonegap)

4.  现在您已安装启动 xCode，您将看到一个 Cordova 项目，选择它并按照 phonegap 网站上的入门步骤进行操作。

**入门**

1.  安装 Cordova.DMG

2.  打开 xCode 并选择 Cordova Project

3.  给它你的项目名称，公司应该是 com.yourName

4.  现在在模拟器中运行应用程序，它会给你一个错误，上面写着“没有找到 www 文件夹或 Index.html。

5.  现在转到 finder 并找到项目的文件夹，您将在那里看到一个名为...'WWW' 的新文件夹，将其拖到您的 xCode 项目中。（将其放入 xCode 中的项目文件夹中）请确保在执行此操作时选中“为任何文件夹创建组”单选按钮以及将项目复制到目标

6.  现在保存并再次运行应用程序... BAM，您将收到一条通知，上面写着 Cordova 正在运行！

7.  就是这样！将您的 www 文件夹视为服务器上的根文件夹，您可以嵌套内容并拥有其他文件夹。

# postgresql - PostgreSQL：转储和恢复

> ID：10337095
> 
> 赞同：13
> 
> 时间：2012-04-26T16:00:18.980
> 
> 标签：postgresql

我为 PostgreSQL 使用 EMS SQL 管理器，我需要转储困难的数据库（域、300 多个存储过程/函数、触发器、数据等）。这个工具做不到。

请建议我为 postgres 提供良好的 GUI 工具。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-26T16:13:05.570

您始终可以只使用**命令行**实用程序。
转储集群：

```
pg_dumpall -p 5432 > /path/to/my/dump_file.sql 
```

转储单个数据库：

```
pg_dump -p 5432 mydb > /path/to/my/mydb_dump.sql 
```

仅转储架构：

```
pg_dump -p 5432 mydb -s > /path/to/my/mydb_dump_schema.sql 
```

[更多在手册中。](https://www.postgresql.org/docs/current/reference-client.html)

如果要还原到空数据库，则可能需要在还原*之前*运行：

```
DROP DATABASE IF EXISTS mydb;
CREATE DATABASE mydb; 
```

在这种情况下不需要`--clean`选项。`pg_dump`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-18T21:35:19.347

备份你的数据库不需要工具。我们可以用终端做

所有命令都应该以 postgres 用户身份运行。

```
 sudo su - postgres 
```

备份单个数据库

```
pg_dump db_name > db_backup.sql 
```

恢复单个数据库

```
psql db_name < db_backup.sql 
```

备份整个 postgres 数据库集群

```
pg_dumpall > cluster_backup.sql 
```

恢复整个 postgres 数据库集群

```
psql -f cluster_backup.sql postgres 
```

[有关更多命令备份命令](http://www.rubytreesoftware.com/resources/basic-postgresql-backup-and-restore)，请参阅此源

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T16:05:14.893

[pgAdmin3](http://www.pgadmin.org/)可以解决问题，它在安装程序中包含 pg_dump 和 pg_restore。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-18T13:50:13.883

pg_dump -U uguryilmaz modaltrans_dev > backup.sql

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-04T07:09:53.670

如果您使用 md5 身份验证技术并希望使用特定用户来获取数据库转储，您可以这样做

```
$ pg_dump -U username -p 5432 dbname > filename-to-backup-to.sql 
```

为避免在还原时出现凭据和用户名问题，您可以使用`--no-owner`标志

```
$ pg_dump --no-owner -U username -p 5432 dbname > filename-to-backup-to.sql 
```

要恢复备份，请使用以下命令

```
$ psql -U username -d dbname -f filename-to-backup-to.sql 
```

# php - 反向mysql_fetch_assoc (mysql_set_assoc/mysql_encode_assoc)

> ID：10337099
> 
> 赞同：0
> 
> 时间：2012-04-26T16:00:36.873
> 
> 标签：php, mysql

是否有函数编码关联数组以在 mySQL`INSERT`命令中使用？

这样你可以这样做：

```
$array = mysql_fetch_assoc($result);
$array['key'] = 'updated_value';
mysql_query('INSERT INTO table ' . mysql_encode_assoc($array)); 
```

mysql_encode_assoc 输入：

```
array(
    'name' => 'bob',
    'vehicle' => 'car'
) 
```

mysql_encode_assoc 输出：

```
'(name, vehicle) VALUES(bob, car)' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:05:02.190

现在有：

```
function mysql_encode_assoc($array) {
    $kenc = Array();
    $venc = Array();
    foreach($array as $k=>$v) {
        $kenc[] = "`".mysql_real_escape_string($k)."`";
        if( $v === null) $venc[] = "NULL";
        else $venc[] = '"'.mysql_real_escape_string($v).'"';
    }
    $keys = "(".implode(",",$kenc).")";
    $vals = "(".implode(",",$venc).")";
    return $keys." VALUES ".$vals;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:02:46.453

我知道没有内置功能。但是你可以很容易地使用**[`array_keys()`](http://il.php.net/manual/en/function.array-keys.php)**and **[`array_values()`](http://il.php.net/manual/en/function.array-values.php)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:06:36.263

没有内置功能。

```
$sql = array();
foreach ($anArray as $f=>$v) $sql[] = "`{$f}`" = "'".mysql_real_escape_string($v)."'";
$query = "INSERT INTO table SET ".join(",", $sql); 
```

# iphone - 完成在 iPhone 上运行

> ID：10337100
> 
> 赞同：20
> 
> 时间：2012-04-26T16:00:42.420
> 
> 标签：iphone, xcode, device

我正在尝试在 iPhone 4S 上测试我的应用程序。当我从 Xcode 构建和运行时，项目已成功编译，但之后 Xcode 说：

> 完成在 MyiPhone 上运行 MyApp.app

该应用程序在模拟器上完美运行，并且配置文件正常工作（我尝试加载一个空应用程序并且它工作正常）。

如果我尝试手动加载应用程序，我会收到以下消息：

> /Users/ *** /Documents/App/AppName/DerivedData/AppName/Build/Products/Release-iphoneos/AppName.app 处的应用程序的 Info.plist 指定了 AppName 的 CFBundleExecutable，它不存在。

哪里有问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-04T14:46:19.660

XCode 与设备创建的连接相当脆弱，如果调试测试中出现任何问题，很容易损坏，最常见的情况是开发人员在将构建移动到设备时停止构建。

当这种情况发生时，我会经历一些常规的事情。如果一个不起作用，我会在列表中更进一步。

*   **检查您的签名证书** ：如果您过多地弄乱证书，则可能会发生此错误。确保您当前的方案在进行调试构建时使用调试签名，如果当前的调试签名证书是调试证书，请检查您的应用程序设置。（不是 AppStore、AdHoc 或 Enterprise）。

*   **重新建立与设备的连接** ：查看管理器中的设备下方。检查您正在使用的设备是否存在并标有绿色子弹。如果是橙色或灰色，请重新将设备与 USB 连接。为预防起见，请在拔出电缆后等待几秒钟，然后再插入。如果您从 Mac 或连接 iDevice 的部件中弹出电缆，则应该没有区别。

*   **重新激活 iDevice 上的开发** ：由于不知道为什么会发生这种情况，一些设备不时恢复到非开发阶段。单击“管理器”>“设备”下的“启用开发”似乎可以清除此问题。

*   **刷新 XCode 设备连接** ：经常需要的东西，您可以简单地关闭 XCode（为了安全起见，也关闭 iPhone 模拟器）并重新启动它。删除 iDevice 上的调试应用程序也是一个好主意。

*   **重新启动您的 iDevice** ：虽然看起来很乏味，但有时需要重新启动您的 iDevice，因为设备上的管道可能已损坏。

*   **重启你的开发机器** ：如果一切都失败了，通常需要重启你的 mac。我从来没有遇到过这个错误，现在没有修复它。

我希望这份清单能帮助你完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-05-18T18:24:48.290

尝试清理项目。 `SHIFT+CMD+K`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-04T06:48:31.100

在 iPhone 5s 上运行项目时，在 XCode 9 中发现了相同的错误。清理项目，它将工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-04T06:28:20.217

1.  干净的。
2.  建造。
3.  跑。

这对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-29T09:21:21.277

我有类似的问题。当我在 iPad2 上运行程序时，它会在设备上编译并安装应用程序，等待一段时间，然后显示警报。然后我按照以下步骤

1) 从设备中删除了该应用程序。

2) 断开 iPad 并再次尝试。

然后它在设备中成功运行。如果这不能解决您的问题，请执行

将您的应用程序重命名为其他名称并尝试运行。它会运行。最后，您可以使用 Ad Hod 分发制作“ipa”文件，并可以在设备上进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-29T09:28:15.453

看起来您正在尝试在设备上运行发布产品。您可能正在使用生产密钥对其进行签名。运行它作为调试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-30T21:42:27.580

也许我完全不同意这个猜测，但我最后一次得到同样的消息是当我在 Info.plist 中设置了一些目标设备不符合的必需硬件功能时。（例如，需要相机并尝试在 iPad1 上运行应用程序。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-02T01:58:11.660

我刚刚完成了一个类似的问题。

在设备 (iPad 1) 和模拟器上运行的应用程序在 iPad 上停止加载，但在模拟器上**继续像以前一样运行**。当以设备为目标“运行”时，它会编译并立即进入“完成运行...”。

我做了所有常见的事情——从设备中删除应用程序，运行 Product/Clean，删除派生数据，关闭计算机和设备，但没有运气。其他开发应用程序已加载并运行良好。

这个应用程序使用 GameKit。当我从 Info.plist 中删除 gameKit 要求时，应用程序再次加载并在设备上正确运行 - 包括 GameKit 功能（不开玩笑）。当我重新添加 gameKit 时，它又失败了。当我将 gameKit 要求添加到其他应用程序时，它们也无法加载到设备上。设备上的 gameKit 设置似乎发生了一些事情，尽管 gameKit 在那里并且一如既往地运行。我怀疑这与沙盒的状态有关。

我必须进行一些更改才能让应用程序在 iPhone 上运行，我也会对其进行测试。如果我整理出来我会重新发布。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-01T16:42:09.520

Si 似乎 XCode 构建、运行和完成，但应用程序未能部署，甚至没有复制到设备。

事实上，XCode 项目中应该有一些东西被破坏了。这很容易损坏。最好的做法是从头开始构建一个新项目。如果需要，不要忘记添加 armv6 支持。

这对我来说很有效！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-25T08:59:19.053

检查设备日志

可能会出现您正在使用的配置文件，该配置文件不允许为您的目标列出的权利之一。

例如

权利“权利名称”具有配置配置文件“您的配置文件名称”不允许的值

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-26T13:32:41.657

对我来说，通常的罪魁祸首是我的设备上已经有一个应用商店。

不同/相同的版本号可能会使事情变得更糟。我没有深入研究它，因为删除我设备上已有的版本通常可以解决问题。

# jquery - jstree open_all 事件触发两次

> ID：10337104
> 
> 赞同：1
> 
> 时间：2012-04-26T16:01:00.293
> 
> 标签：jquery, jstree

我的要求之一是加载（通过 ajax on demand）在 jstree 上选择的节点的所有子节点，并返回其下叶节点的所有锚元素 id。我可以通过将所选节点传递给 open_all 方法并在 open_all 事件中返回前导节点的 ID 来做到这一点。但是，我的问题是，当所选的是除根以外的非叶节点时，open_all事件会发射两次。如果所选节点是根节点或叶节点，它可以正常工作。任何帮助是极大的赞赏。

```
$tree
    .bind("loaded.jstree", function(event, data) {
        //alert("Tree loaded");
    })
    .bind("select_node.jstree", function(event, data) {            
        data.inst.open_all(data.rslt.obj, true);
    })
    .bind("check_node.jstree", function(event, data) { 
        //checkboxes are enabled on some pages
        data.inst.open_all(data.rslt.obj, true);
    })
    .bind("open_all.jstree", function(event, data) {
      //get all ids of leaf nodes under selected node if selected node is 
      //non-leaf node. If selected node is a leaf node return it's id.

      //alert(leaf_ids); 

      //**Here is my problem:** The alert box pops up twice if 
      //open_all was passed a non-leaf node other than root.The first time 
      //ids are empty but the second time I see the ids.           
    })
    .jstree({
        "plugins": plugins_include,
        "core": core_options,
        "html_data": html_data,
        "themes": {
            "theme": "classic",
            "dots": false,
            "icons": false
        },
        "strings": { loading: "Loading..." },
        "checkbox": {
            "override_ui": true
        },
        "ui": { "select_multiple_modifier": false }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T15:58:43.540

我不得不修改 jstree 插件的 open_all 方法来解决我的问题。

我在 open_all 函数的最后一行添加了一个条件：this.is_open(original_obj)

// 以便在所有节点打开后触发回调
if ( **this.is_open(original_obj) &&** original_obj.find('li.jstree-closed').length === 0) { this.__callback({ "obj": original_obj }); }

一旦我进行了此更改，警报框就会停止弹出两次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T01:53:41.110

我不知道您使用 open_all 进行绑定是否有更深层次的原因，但 open_node 也是一种选择。

```
.bind("open_node.jstree", function (event, data) {
    var node = $(data.rslt.obj);
    var nodeID = node.attr('id');

    var children = $.jstree._reference(node)._get_children(node);
    if (children.length==0){
    // Dynamically load node since it has nothing loaded yet
    }
}) 
```

# artificial-intelligence - 使用机器学习进行数据聚类

> ID：10337105
> 
> 赞同：-2
> 
> 时间：2012-04-26T16:01:15.423
> 
> 标签：artificial-intelligence, machine-learning, neural-network, cluster-analysis

有人使用神经网络方法对数据进行聚类吗？特别

1.  ART 神经网络（自适应共振理论）或
2.  Kohonen 自组织地图

与 k-means 或任何其他基于距离的聚类算法相比，它们如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T15:03:23.530

自组织图 (SOM) 与 K-Means 有一些内部相似之处，但也有重要区别。SOM 实际上将您的数据从原始数据空间（通常是高维）映射到地图空间（通常是二维），同时尝试保留原始数据密度和邻域关系。它不会直接为您提供聚类，但可以帮助您直观地检查数据并识别聚类。

我对 ART 网络知之甚少。

# linux - 如何重新编译 libc 以使用软浮点？

> ID：10337112
> 
> 赞同：1
> 
> 时间：2012-04-26T16:01:41.740
> 
> 标签：linux, floating-point, mips, libc

必须为某个软件包升级 Libc（通过 apt-get）。不再需要该软件包，并且通过 apt-get 升级 libc 我无法再从源代码构建某些其他程序。我需要重新编译 libc 以使用软浮点而不是硬浮点，这样我才能再次编译我需要的程序。

现在我收到这样的警告：

> 警告：/usr/lib64/libc_nonshared.a(elf-init.oS) 使用硬浮动，foobar 使用软浮动

...并运行已编译的 foobar 将导致错误：

> 浮点异常

系统本身采用 MIPS64 架构。在通过apt-get升级libc之前，这些程序编译运行成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T01:44:36.523

重新编译 libc 很困难。您最好的选择是在线查找预编译的 64 位软浮点 libc，或者从备份中恢复您的原始版本。查看免费的[CodeSourcery Lite](http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/editions/lite-edition/) MIPS 工具链，其中包括许多不同的 libc 版本。

# ruby-on-rails - 如何使用 ActiveRecord 编写此加入约束

> ID：10337113
> 
> 赞同：2
> 
> 时间：2012-04-26T16:01:43.987
> 
> 标签：ruby-on-rails, activerecord

我应该如何用 ActiveRecord 写这个：

```
select stores.id, stores.name, store_specials.active 
from stores 
left outer join store_specials on 
     (store_specials.store_id = stores.id and store_specials.special_id = 1) 
where stores.active = true; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:52:14.203

**导轨 3.x**

```
Stores.select("stores.id, stores.name, store_specials.active").joins("LEFT OUTER JOIN tore_specials ON store_specials.store_id = stores.id AND store_specials.special_id = 1).where("store_specials.active = true") 
```

希望这是你需要的

# wcf - TransX WCF 和多线程

> ID：10337116
> 
> 赞同：0
> 
> 时间：2012-04-26T16:01:50.213
> 
> 标签：wcf

我对 WCF 和多线程有一些疑问。我的计划是将项目放置到线程池中，并让它处理来自 MSMQ 队列的消息。我还将在 WAS 中托管 WCF。

我想知道此时线程将如何工作。例如消息将被 WCF 绑定到 MSMQ 队列拾取，我知道 WAS 将在需要时启动服务。但是假设我们有 100 条消息要处理（例如每秒 100 条消息）——这些消息会以线程方式还是单线程方式传递？

如果以线程方式，那么如何最好地提交或中止事务？有什么特别的考虑吗？

很抱歉这些问题 - 只需要澄清这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:31:19.897

目前尚不清楚“将项目放置到线程池中”的作用，但在 WCF 端，使用`netMsmqBinding`与其他 WCF 绑定类似的方式处理“调用”的服务。不同之处在于“调用”实际上是队列中的 MSMQ 消息。

这篇[关于 netMsmqBinding](http://answers.oreilly.com/topic/2007-how-to-support-queued-calls-in-windows-communication-foundation-wcf/)的文章非常清楚地解释了绑定的工作原理。如果您使用其默认 InstanceContext 设置配置 WCF 服务（每个调用或每个会话，具体取决于 .NET 版本），则服务实例将从队列中提取消息，就好像它们每个都是标准调用一样。MSMQ 和 WCF 中有一些设置会影响此行为以使消息按顺序处理，但这不是默认设置。

让 WCF 为您处理多线程，方法是将服务设置为每次调用（或每个会话），对于事务，请查看[MSDN 中此示例中](http://msdn.microsoft.com/en-us/library/ms751445.aspx)的代码以了解如何使用它们。

# jquery - jQuery 内容加载脚本 - 帮助查找代码

> ID：10337119
> 
> 赞同：-4
> 
> 时间：2012-04-26T16:02:02.590
> 
> 标签：jquery, dynamic, loading

整个下午，

我试图找到一个 jquery 内容加载脚本，

我目前正在开发一个视频网站，

（例如，如果用户点击观看次数最多的视频，它将更改从 php 文档中获取视频来源的视频）

```
<div id="video-section" class="with-ads">
<!-- Videos Go Here -->
</div> 
```

有人可以指点我一个可以工作的像样的脚本吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:24:00.397

你只想做一个 .load 类似于这个

```
<a href="#" id="mostviewed">Most Viewed</a>
<div id="video-section" class="with-ads">
<!-- Videos Go Here -->
</div>​

$(document).ready(function() {
    $('#mostviewed').click(function(event) {
        $('#video-section').load('WHEREEVER YOUR PHP FILE IS HERE');
    });
});​ 
```

如果您想将视频数据分组到一个文件中，即观看次数最多、精选内容等，您甚至可以在加载时拍摄动作或类似内容。

# java - 是否可以在不消耗流的情况下读取 HttpRequest 参数？

> ID：10337120
> 
> 赞同：5
> 
> 时间：2012-04-26T16:02:11.740
> 
> 标签：java, servlets, servlet-filters

我在[这里查看](https://github.com/usmanismail/sitebricks/blob/ec106ea572bb58e8769cf0f4d1f6df54fd601521/sitebricks/src/main/java/com/google/sitebricks/HiddenMethodFilter.java)sitebricks 中 HiddenMethodFilter 的实现：

在第 65 行有以下代码：

```
try {
    String methodName = httpRequest.getParameter(this.hiddenFieldName);
    if ("POST".equalsIgnoreCase(httpRequest.getMethod()) && !Strings.empty(methodName)) {
    .... 
```

它检查是否设置了特定参数并使用它来包装请求。但是，在读取该参数时，它将消耗流并且最终的 servlet 将无法读取任何数据。

避免这种情况的最佳方法是什么？[我在这里](https://github.com/usmanismail/sitebricks/blob/7bed9a6886f6b8702e40530b2130c7fb5abc5fc2/sitebricks/src/main/java/com/google/sitebricks/HiddenMethodFilter.java)实现了 HttpServletRequestWrapper ，它将流的内容读入字节数组。然而，这可能会使用大量内存来存储请求。

```
private HttpServletRequestWrapper getWrappedRequest(HttpServletRequest httpRequest, final byte[] reqBytes)
   throws IOException {

final ByteArrayInputStream byteInput = new ByteArrayInputStream(reqBytes);
return new HttpServletRequestWrapper(httpRequest) {

  @Override
  public ServletInputStream getInputStream() throws IOException {
    ServletInputStream sis = new ServletInputStream() {

      @Override
      public int read() throws IOException {
        return byteInput.read();
      }
    };
    return sis;
  }
};
} 
```

有没有更好的办法？我们可以在不消耗流的情况下读取参数吗？（类似于 peek 的东西）我们可以重置流吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:40:53.773

如果您正在使用`POST`请求并从中读取参数，`httpRequest`这将影响您，`InputStream`并且您将在需要读取它的其他部分遇到问题。
这在[ServletRequest#getParameter](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameter%28java.lang.String%29) javadoc 中有说明：

> 如果参数数据是在请求正文中发送的，例如发生在 HTTP POST 请求中，那么直接通过 getInputStream() 或 getReader() 读取正文可能会干扰此方法的执行。

`ServletInputStream`派生自`InputStream`并继承了实际上是无操作的`markSupported` `reset`etc，因此您无法重置`ServletInputStream`.
这意味着你将不得不消费它。

# c# - 如何在不粘贴的情况下从内存中获取复制的文本？

> ID：10337127
> 
> 赞同：1
> 
> 时间：2012-04-26T16:02:34.477
> 
> 标签：c#, asp.net

我有一个要求，即当用户复制任何文本时，系统应该将复制的文本从内存中获取到程序中，而不需要用户将其粘贴到 txtbox 或类似控件中。我在互联网上搜索，但没有得到任何信息。有人可以建议或提供一些参考资料，以便我可以关注...??????

任何帮助将不胜感激......！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:05:20.670

从 Web 开发的角​​度来看，您不能直接访问剪贴板。您必须在剪贴板中创建 Flash 或 Silverlight 挂钩才能获取数据。

[例子](http://code.google.com/p/zeroclipboard/)

[另一个例子](http://trephine.org/t/index.php?title=Browser_clipboard_access)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:05:24.513

出于安全原因，您将永远无法在 Javascript 中执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:12:51.327

正如已经指出的那样，出于安全原因，对于在浏览器中的页面上运行的所有组件，访问剪贴板要么是不可能的，要么是受限的（受限 == 不太可能被任何人启用，尤其是对于这种“在剪贴板上监视”的目的）。

对于独立应用程序，您可以一直扫描剪贴板或使用剪贴板过滤器。

本机功能围绕[SetClipboardViewer](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649052%28v=vs.85%29.aspx)和[GetClipboardData](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649039%28v=vs.85%29.aspx)。

托管：[剪贴板](http://msdn.microsoft.com/en-us/library/system.windows.clipboard.aspx)。

# javascript - 如何汇总 JavaScript 错误？

> ID：10337128
> 
> 赞同：3
> 
> 时间：2012-04-26T16:02:34.753
> 
> 标签：javascript, error-handling

在下面的代码中，我故意抛出一个错误，但在 Chrome 中（仅用于测试目的）它不会汇总到问题。如何将错误汇总到父级范围？

```
try {
  setTimeout(function() {
    console.log("Throwing Error...");
    throw({message:"Ouch!"});
  }, 500);
} catch(e) {
  console.log(e.message);
} 
```

Chrome 回复：

```
Uncaught #<Object>
  (anonymous function) 
```

这是我正在使用的完整示例；当我需要“鲍勃”时，它（故意）超时。我想捕获 requirejs 错误，以便我可以使用更强大的应用程序错误系统来通知学习者。

```
(function() {
try {
  var scriptVersion = "1.0.0.1"
  window.onload = function() {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "//content.com/pkg/" + scriptVersion + "/require-jquery.js";
    script.async = false;
    script.done = false;
    // OnReadyStateChange for older IE browsers
    script.onload = script.onreadystatechange = function() {
      if(!(this.done) && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
        this.done = true;
        require.config({
          baseUrl: "//content.com/pkg/" + scriptVersion
        });
        require(["bob"]);
      }
    }
    document.getElementsByTagName("head")[0].appendChild(script);
  }
} catch(e) {
  console.log(e);
}
})(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:08:11.740

请参阅下面的编辑以了解如何解决 requireJS 的实际问题。

问题是该`setTimeout()`函数在父范围内运行并且没有错误地完成。它（与系统一起）安排未来的回调事件，但是当该回调在未来发生时，父级的执行范围已经完成，并且回调从顶层的系统启动，就像一个新的系统事件（例如点击事件处理程序）。

虽然父闭包仍然存在，因为内部的匿名函数`setTimeout()`仍然可以引用这些变量，但父作用域的实际执行已经完成，因此 try/catch 的作用域就完成了。

匿名函数的执行上下文`setTimeout()`是顶级的（由系统启动），因此没有可以放入 try/catch 的父上下文。您可以在匿名函数中放入 try/catch，但从那里抛出只会回到系统，这就是所谓的`setTimeout()`回调。

要让您自己的代码捕获回调中发生的任何异常`setTimeout()`，您需要在回调中放置一个 try/catch。

```
 setTimeout(function() {
    try {
        console.log("Throwing Error...");
        throw({message:"Ouch!"});
    } catch(e) {
        console.log(e.message);
    }
  }, 500); 
```

如果您解释了您要解决的真正问题是什么（而不是这个制造的测试用例），我们也许能够提供一些有用的选项。

* * *

**现在编辑**您已经展示了您真正想要解决的问题。require.js 库通过调用该`onError`方法来启动每个错误。该`onError`方法的默认实现是引发异常的原因。您可以分配自己的`onError`处理程序并在回调中处理错误而不是异常。这听起来是正确的方法。

从requirejs源：

```
/**
 * Any errors that require explicitly generates will be passed to this
 * function. Intercept/override it if you want custom error handling.
 * @param {Error} err the error object.
 */
req.onError = function (err) {
    throw err;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:11:16.423

前面的回答者解释正确。

另一种思考方式是它不起作用，因为 setTimeout 可以正常完成并且在最初运行时不会抛出异常。当您不再在 try-catch 块中时，它会稍后执行。

如果您将 try catch 放在 setTimeout 函数中，它将起作用，如下所示：

```
 setTimeout(function() {
     try {
         console.log("Throwing Error...");
         throw({message:"Ouch!"});
     } catch(e) {
       console.log(e.message);
     }
      }, 500); 
```

如果您还有问题，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:04:16.497

当浏览器调用回调时，您会在块`throw`之后的某个时间发生。`catch``setTimeout`

（`catch`使用逻辑范围，而不是词法范围）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-09T07:49:40.373

像这样使用包装函数。

```
// wrapper function
var tryable = function(closure, catchCallback) {
    closure(function(callback) {
        return function() {
            try {
                callback();
            } catch(e) {
                catchCallback(e);
            }
        };
    });
};

function throwException() {
    throw new Error("Hi");
}
tryable(function(catchable) {
    setTimeout(catchable(throwException), 1000);
}, function(e) {
    console.log("Error:)", e);
}); 
```

# coldfusion - CFCHART 标题动态填充

> ID：10337135
> 
> 赞同：1
> 
> 时间：2012-04-26T16:02:53.380
> 
> 标签：coldfusion, cfchart

我正在使用 CFCHART 即时生成很棒的图表。根据选择标准动态更改图表的标题会很好......我一直在尝试通过设置一个字符串graphTitle来做到这一点，该字符串根据选择有条件地填充。我想做的只是为每个标准开始一个新行。

例如：假设我有一个包含大量选择标准的图表。我希望图表标题看起来像这样：（当然，中断表示一行的结束）

```
Fiscal Year 2006 to projected 2013 (Break)
Hires of African American Heritage candidates (Break)
Whom are Female
From New Mexico, California, Texas and Colorado (Break)
With an Age of 29+ (Break)
With a breakdown of Degree Achievement: 
```

我尝试在标题中使用`<SPAN>`and标签。`<BR />`没有运气。还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:33:49.733

如果您的意思是要在图表标题中添加换行符以使其“换行”，则可以尝试像这样添加 ascii 编码的换行符...

```
<Csfet linefeed = chr(10) & chr(13)/> 
```

那么你的变量将是

```
<cfset mytitle = "fiscal year 2006 to projected 2012 #linefeed# Hires of..."/> 
```

等等 - 你明白了。注意：您可能需要“just” chr(10) 或者您可能需要两者。你需要进行实验。我不“知道”这会奏效。如果是我并且我想要一些复杂的东西来装饰图表，我想我会绘制一个只有 x 和 y 轴标签的普通“未装饰”图表，然后使用 HTML 在图表之外设置我的标题。我会更好地控制这种方式。

无论如何，如果这不起作用，请尝试摆弄“样式”属性。您可以提供带有各种选项的 XML () var - 但恐怕它没有很好的文档记录。Ray 在他的博客上有一些关于此的内容。

# ruby-on-rails-3 - 如果没有命名范围，那么如何？

> ID：10337142
> 
> 赞同：2
> 
> 时间：2012-04-26T16:03:12.210
> 
> 标签：ruby-on-rails-3, activerecord

我最近发现了范围（我 == Rails noob）。凉爽的。但是我发现[命名范围已经死了。](http://www.railway.at/2010/03/09/named-scopes-are-dead/)我想做对，所以我改变了这个：

```
 def Foo
    scope :only_some, where('some conditions') 
```

为此（按照指示）：

```
class << self

   def only_some
      where('some conditions')
   end

end 
```

然后这停止工作：

```
bar.foos.only_some 
```

例外：

```
undefined method `only_some' for #<ActiveRecord::Relation:0x007fb398d99178> 
```

我究竟做错了什么？我应该继续使用范围吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T04:28:57.780

相反，在查询关联对象时，作用域优于类方法，原因有二：

1.  范围简化了复杂查询的生成。将作用域视为“惰性”序列，仅在调用者需要该值时（即最后）才被评估。因此，您可以通过链接作用域方法来构造复杂的查询，而不必担心多个 SQL 查询会影响性能。您也可以在类方法中这样做，但灵活性较差。您必须在这些类方法中使用“作用域”方法来作用于当前作用域。

2.  您可以在关联对象的集合以及单个对象上调用范围方法。这是因为 ActiveRecord 关联是 ActiveRecord::Relation 类的实例，可以在其上调用范围方法，而类方法则不然。而这正是您面临的问题。在您的示例中，当您将“only_some”定义为范围方法时，ActiveRecord 将在 ActiveRecord::Relation 对象上调用“only_some”，该对象反过来将在每个 foo 上调用该方法。但是当你把它重新定义为一个类方法时，你只能在模型类 Foo 上调用这个方法。

# asp.net - 仅下载 Telerik 二进制文件

> ID：10337143
> 
> 赞同：-1
> 
> 时间：2012-04-26T16:03:12.253
> 
> 标签：asp.net, dll, telerik

有没有办法只下载二进制文件而不是包含所有演示等的 1.2 GB 的 Telerik Ajax？

完成事情的下载路径在[这里](http://www.telerik.com/download-trial-file.aspx?pid=561)。

期待中的感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:29:39.770

使用试用帐户[注册/登录。](https://www.telerik.com/account/login.aspx?ReturnUrl=/account/default.aspx)

转到管理产品 > 试用下载 > 下载链接 > 选择“使用 HOTFIX（仅限 DLL 和脚本/皮肤）”

[http://www.telerik.com/help/aspnet-ajax/introduction-using-hotfix.html](http://www.telerik.com/help/aspnet-ajax/introduction-using-hotfix.html)

> **注意**：如果您是第一次安装 Telerik 产品，我们建议您下载完整的软件包（MSI 或 ZIP 文件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:15:53.443

我知道您可以选择在购买控件后只下载二进制文件，但我认为试用版不提供该选项。

# jquery - jquery远程验证：将远程数据传递给函数

> ID：10337144
> 
> 赞同：0
> 
> 时间：2012-04-26T16:03:31.820
> 
> 标签：jquery, jquery-validate

我的代码

```
var validator = $("#form-utente").validate( {
    rules: {
        login: { checkLogin: true }
    }
} 
```

我的“checkLogin”功能...

```
$.validator.addMethod("checkLogin", function(value, element) {
    return eval($.ajax({
        url: "checkLogin.cfm",
        async: false,
        data: {
            login: function() {
                return $("#login").val();
            },
        }
    }).remoteData);
}); 
```

checkLogin.cfm (remoteData) 在我需要“true”时返回“false”，反之亦然。

我如何评估远程数据？...

我需要类似的东西：

```
rules: {
    login: { checkLogin: function(remoteData) {
        if(remoteData == true) {
            return false;
        } else {
            return true;
        }
    }}
} 
```

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:17:16.777

通常，您会使用`remote`jquery.validate 中的规则进行使用远程服务的验证。您的实现假设一个同步调用，根据 jQuery 文档，它可能“暂时锁定浏览器，在请求处于活动状态时禁用任何操作”。如果在每次更改或模糊事件后检查它，这可能会变得非常糟糕，就像默认的验证行为一样。

不幸的是，`remote`它没有为您提供一个挂钩来更改您收到的数据的解释方式：

```
success: function(response) {
    ...
    var valid = response === true; 
```

虽然您可以在设置规则时覆盖实施`success`，但这将要求您复制规则使用的逻辑来管理表单的验证状态（[第 1035 - 1050 行](https://github.com/jzaefferer/jquery-validation/blob/master/jquery.validate.js#L1035)）。

所以...假设您对插件进行了一些小改动，如下所示：

```
success: function(response) {
    ...
    var valid = ($.isPlainObject(param) && param.isValidResponse) ?
        param.isValidResponse(response) : 
        response === true; 
```

然后将您的规则设置为：

```
login: {
    remote: {
        url: "checkLogin.cfm",
        data: {
            login: function() {
               return $("#login").val();
            },
        },
        isValidResponse: function(response) {
            // do something with response
            // return true or false
        }
    }
} 
```

然后，您应该能够以任何需要的方式解析响应。让我知道这是否有帮助。

# javafx-2 - 如何使用 Swing 在 JavaFX 2.2 中进行拖放操作？

> ID：10337150
> 
> 赞同：1
> 
> 时间：2012-04-26T16:04:07.793
> 
> 标签：javafx-2

我在位于 JPanel 上的 JFXPanel 上的拖放事件有问题。当我将拖动消息推送到 DragBoard 时，应用程序的 javaFX 部分不再工作。我认为它与摇摆事件机制有关，但我不确定。其他事件没有问题。这让我很困惑。这个问题有什么解决办法吗？提前致谢。

```
public class MyScene extends Scene {

    public MyScene(VBox vBoxMainLayout) {
        super(vBoxMainLayout);

        HBox hBox = new HBox();
        hBox.setPrefSize(10000, 10000);
        hBox.setSpacing(40);

        Button buttonSource = new Button("Source");
        buttonSource.setMinSize(60, 30);

        buttonSource.setOnDragDetected(new EventHandler<MouseEvent>() {
            public void handle(MouseEvent event) {
                Dragboard db = startDragAndDrop(TransferMode.ANY);

                ClipboardContent content = new ClipboardContent();
                String message = "Drag operatation is done";
                content.putString(message);
                db.setContent(content);
                event.consume();
            }
        });

        buttonSource.setOnDragDone(new EventHandler<DragEvent>() {
            public void handle(DragEvent event) {

                event.consume();
            }
        });

        TextArea textAreaTarget = new TextArea();
        textAreaTarget.setMinSize(200, 500);

        hBox.getChildren().add(buttonSource);
        hBox.getChildren().add(textAreaTarget);

        vBoxMainLayout.getChildren().add(hBox);
    }

}

public class Main extends Application {

    public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage stage) {
        VBox vBoxMainLayout = new VBox();
        MyScene myScene = new MyScene(vBoxMainLayout);

        JFrame frame = new JFrame();
        JFXPanel arg0 = new JFXPanel();
        arg0.setScene(myScene);
        frame.getContentPane().add(arg0);
        frame.setVisible(true);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T14:31:32.493

这是 JavaFX 2.1 中的一个已知死锁并被推到 2.2（这就是我从 oracle 学到的），但我想它仍然没有解决。

# google-analytics - 谷歌分析多个配置文件

> ID：10337152
> 
> 赞同：0
> 
> 时间：2012-04-26T16:04:14.750
> 
> 标签：google-analytics, analytics

我们有大量网站 (>50)，我们希望使用分析软件对其进行跟踪。我们还希望通过一个控制台跟踪所有站点的总访问次数。

我做了一些研究，谷歌支持的方法是安装一个“msater”跟踪配置文件，并使用过滤器在每个域上创建子配置文件。但是，由于最多 50 个站点，这不允许创建超过 49 个不同的站点，这意味着拥有大约 300 个站点将产生 6 个“主”配置文件，然后需要手动组合这些配置文件。

我还使用自定义变量尝试了每个站点的多个配置文件，例如

```
var _gaq = _gaq || [];
_gaq.push(['t1._setAccount', 'UA-xxx-01']);
_gaq.push(['t1._setAllowLinker', true]);
_gaq.push(['t1._trackPageview']);

var _gaq = _gaq || [];
_gaq.push(['t2._setAccount', 'UA-xxx-02']);
_gaq.push(['t2._setAllowLinker', true]);
_gaq.push(['t2._trackPageview']); 
```

但是我读到这可能会导致数据没有被正确记录，并且似乎被谷歌强烈反对。

有没有一种简单的方法来组合多个配置文件？如果可能的话，我宁愿坚持使用谷歌，而且我们的预算很紧，所以买不起谷歌分析工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:54:08.423

Google 不支持这种方法，因为您需要了解技术站点上的一些内容。话虽如此，您尝试做的事情是可能的，但请务必查看您的数据。您的个人资料数量有限，只能由 Google 增加 - 您必须通过[Google Analytics 认证合作伙伴](http://www.google.com/analytics/partners/index.html)，因为他们是唯一可以直接请求的人（他们仍然可能拒绝）。

更好的方法是帐户方法。当您达到限制时，开始使用另一组登录凭据创建帐户，将您的原始电子邮件添加为管理员，然后从帐户中删除辅助用户（这样您就不会再次达到限制）。

您需要注意的技术问题是 Google Analytics（分析）会在每个页面加载时创建多组 cookie。在随后的页面查看中，它会选择哪组 cookie，因此您会看到高新访问者、高跳出率和相当不可用的数据。正确调用该`_setAllowHash`方法，您将通过让 GA 共享 cookie 来避免该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:42:48.150

好的，根据官方的 Google Analytics Developer guides，正确的方法是使用以下代码：

```
_gaq.push(
    ['_setAccount', 'UA-XXXXX-1'],
    ['_trackPageview'],
    ['b._setAccount', 'UA-XXXXX-2'],
    ['b._trackPageview']
); 
```

[https://developers.google.com/analytics/devguides/collection/gajs/#MultipleCommands](https://developers.google.com/analytics/devguides/collection/gajs/#MultipleCommands)

但是，如上所述，谷歌表示这种做事方式不是 100% 支持的。

# php - 如何使用 PHP 删除 MySQL 数据库中的所有记录？

> ID：10337158
> 
> 赞同：0
> 
> 时间：2012-04-26T16:04:24.490
> 
> 标签：php, mysql, sql

我想在数据库中废弃我的所有记录。我只想使用 PHP 脚本，而不是 PhpMyAdmin。我将使用 MySQL 数据库管理员帐户。我应该使用什么 SQL 查询？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-26T16:06:06.153

您可以运行查询：

```
/* Assumes the existence of a few key variables
   and further, that your user has the appropriate permissions */

mysql_connect( $host, $user, $pass ) or die( mysql_error() );
mysql_select_db( $db ) or die( mysql_error() );

mysql_query( "TRUNCATE TABLE tablename" ); 
```

或者

```
mysql_query( "DELETE FROM tablename" ); 
```

### 警告！

这些查询将导致**所有**记录被删除。如果您只想删除某些记录，请添加一个`where`子句：

```
mysql_query( "DELETE FROM tablename WHERE userid = 5" ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:43:14.067

要完全清空数据库，删除所有表（如果您真的想要这样做），请运行这个 PHP 脚本。

```
<?php

header('Content-Type: text/plain');

$link = mysqli_connect('host', 'username', 'password');
mysqli_select_db($link, 'database_name');
mysqli_set_charset($link, 'utf8');

$sql = 'SHOW TABLE STATUS FROM `database_name`;';
$result = mysqli_query($link, $sql);

$rows = array();
while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
    $rows[] = $row;
}

$n = 0;
foreach ($rows as $row) {
    $sql = 'DROP TABLE IF EXISTS `' . mysql_real_escape_string($row['Name']) . '`;';
    mysqli_query($link, $sql);
    ++$n;
}

echo $n . 'tables dropped' . PHP_EOL;
exit(__FILE__ . ': ' . __LINE__); 
```

# c++ - 'SalesTaxPct' 未在此范围内声明

> ID：10337166
> 
> 赞同：1
> 
> 时间：2012-04-26T16:04:56.530
> 
> 标签：c++

我是 C++ 新手。我正在努力解决价值传递的问题，没有人能以我能理解的方式解释我做错了什么。我知道这是我的错，但我正在寻求有关我的代码的帮助。请帮忙！

```
#include <iostream>
using namespace std;

double getValues();
double getSalesTax(double SalesTaxPct);
double gettotal_price(double base, double opt);
void PrintFinal(double base,double opt,double SalesTaxPct);

// function to control all other functions
int main()
{
    getValues();
    getSalesTax(SalesTaxPct);
    PrintFinal(base,pt,SalesTaxPct);
}

// function to calculate sales tax percent into decimal 
double getSalesTax( double SalesTaxPct )    

{
    double SalesTax;

    SalesTax = SalesTaxPct / 100;

    return SalesTax;
}

// function to find total
double gettotal_price(double base, double opt, double SalesTax)

{

    return = (base + opt) * (1 + SalesTax);

}

// function to show user all values input and also total
void PrintFinal(double base, double opt, double SalesTaxPct)

{
    cout << "Base vehicle price: $" << base << endl;

    cout << "Options Price: $" << opt << endl;

    cout << "Sales tax pct: " << SalesTaxPct << "%" << endl;

    cout << "Total vehicle price: $" << gettotal_price(double base, double opt, double SalesTax) << endl;

}

// function to get input values
void getValues()
{
    double base, double opt, double SalesTaxPct;

    cout << "Enter a base vehicle price: " << endl;
    cin >> base;

    cout << "Enter options price: " << endl;
    cin >> opt;

    cout << "Enter a sales tax percent: " << endl;
    cin >> SalesTaxPct;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:19:03.573

当您在 中时`main`，让我们回顾一下程序看到的内容：

```
int main()
{
    getValues();
    getSalesTax(SalesTaxPct);
    PrintFinal(base,pt,SalesTaxPct);
} 
```

此时您的程序知道的唯一变量是：`getValues()`、`getSalesTax()`、`gettotal_price()`和`PrintFinal()`。警告告诉您，此时您的程序`SalesTaxPct`尚未声明，并且查看程序知道的变量/函数列表，我们发现它确实`SalesTaxPct`不在列表中。我们期望的价值`SalesTaxPct`来自哪里？

看起来这来自函数`getValues`，我们是从用户输入中获取的。但是，任何时候，`{ ... }`大括号内的东西都不能在外面访问。因此，`SalesTaxPct`只是函数内部的“范围内” `getValues`。如果您希望它可以在该功能之外访问（您这样做），您需要稍微改变一下。

```
int main()
{
    double base;
    double opt;
    double SalesTaxPct;
    getValues(base, opt, SalesTaxPct);
    getSalesTax(SalesTaxPct);
    PrintFinal(base, opt, SalesTaxPct);
} 
```

现在，当我们需要它们时，我们所有的变量仍然存在`main`。但是，这里仍然存在一个问题。我们希望我们传入的更改`getValues`来更改`main`. 这意味着我们不能“按值”传递，因为这将首先制作一个副本，然后更改这些副本（不是我们想要的）。相反，我们需要说明我们所做的更改需要以某种方式从函数返回：

```
void getValues(double & base, double & opt, double & SalesTaxPct); 
```

那一点`&`意味着我们不是制作副本并更改该副本，而是告诉函数对我们直接传入的变量进行操作。这被称为“通过引用传递”。

在您的代码的其他部分也有一些类似的问题，但也许现在您可以弄清楚如何解决它们。

# python - django 使用 setattr 更改图像文件位置

> ID：10337167
> 
> 赞同：0
> 
> 时间：2012-04-26T16:04:58.743
> 
> 标签：python, django, image, django-models

在我的项目中，我有一个带有学校模型和学校建议模型的应用程序。

学校模型具有各种图像的字段，例如徽标、印章等：

```
seal_image = models.ImageField(upload_to="sealimgs", null=True, blank=True)
logo_image = models.ImageField(upload_to="logos", null=True, blank=True) 
```

schoolsuggestion 模型有一个字段表示相应的学校字段是什么，还有一个图像字段。

```
field_name = models.CharField(max_length=255, default="")
image_field = models.ImageField(upload_to='img', null=True, blank=True) 
```

当学校建议获得批准时，我覆盖了 save 以便它通过 getattr(field_name) 获取关联学校的字段并使用 setattr(field_name, image_field) 设置它（我正在简化语法，但你明白了）。

问题是，文件仍然保存在 img 中，大概是因为我使用的是 setattr 而不是图像字段特定的保存，它会将其上传到正确的目录。

那么我该怎么做呢？有意义的是，我可能会以某种方式获取属性的 upload_to 值，以某种方式使用该文件路径重新保存图像，然后在重新保存的图像上使用 setattr，但我不知道如何做前两个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:01:31.167

我修改了上传到这个函数，并将其包含在类 def 上面的文件中：

```
def get_upload_to(instance, filename):
    return School._meta.get_field(instance.field_name).upload_to+"/"+filename 
```

# objective-c - 格式化浮点数以进行显示时限制小数位数和总位数

> ID：10337171
> 
> 赞同：8
> 
> 时间：2012-04-26T16:05:03.767
> 
> 标签：objective-c, cocoa-touch, nsnumberformatter, decimal-point

我需要最有效地在有限宽度的区域中打印一个浮点值。我使用的是`NSNumberFormatter`，并且我将小数点后的两个数字设置为默认值，这样当我有一个类似的数字时，`234.25`它会按原样打印：`234.25`. 但是当我`1234.25`有时，我希望它被打印为：`1234.3`，并且 `11234.25`应该被打印`11234`。

我需要在点之后最多两位数，如果我在点之后有数字，则总共最多需要五位数字，但如果整数部分有更多，它也应该打印超过五位数字。

我看不到限制`NSNumberFormatter`. 这是否意味着我应该编写自己的函数来以这种方式格式化数字？如果是这样，那么获取数字的整数和小数部分的位数的正确方法是什么？我也更喜欢使用`CGFLoat`，而不是`NSNumber`避免额外的类型转换。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-26T16:29:00.620

您正在寻找“最大有效数字”和“最大小数位数”的组合，以及特定的舍入行为。`NSNumberFormatter`等于任务：

```
float twofortythreetwentyfive = 234.25;
float onetwothreefourtwentyfive = 1234.25;
float eleventwothreefourtwentyfive = 11234.25;

NSNumberFormatter * formatter =  [[NSNumberFormatter alloc] init];
[formatter setUsesSignificantDigits:YES];
[formatter setMaximumSignificantDigits:5];
[formatter setMaximumFractionDigits:2];
[formatter setRoundingMode:NSNumberFormatterRoundCeiling];

NSLog(@"%@", [formatter stringFromNumber:[NSNumber numberWithFloat:twofortythreetwentyfive]]);
NSLog(@"%@", [formatter stringFromNumber:[NSNumber numberWithFloat:onetwothreefourtwentyfive]]);
NSLog(@"%@", [formatter stringFromNumber:[NSNumber numberWithFloat:eleventwothreefourtwentyfive]]); 
```

结果：

> 2012-04-26 16:32:04.481 有效数字[11565:707] 234.25
> 2012-04-26 16:32:04.482 有效数字[11565:707] 1234.3
> 2012-04-26 16:32:04.483 有效数字[11565:707] 11235

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:28:58.770

**代码 ：**

```
#define INTPARTSTR(X) [NSString stringWithFormat:@"%d",(int)X]
#define DECPARTSTR(X) [NSString stringWithFormat:@"%d",(int)(((float)X-(int)X)*100)]

- (NSString*)formatFloat:(float)f
{
    NSString* result;

    result = [NSString stringWithFormat:@"%.2f",f];

    if ([DECPARTSTR(f) isEqualToString:@"0"]) return INTPARTSTR(f);
    if ([INTPARTSTR(f) length]==5) return INTPARTSTR(f);

    if ([result length]>5)
    {
        int diff = (int)[result length]-7;

        NSString* newResult = @"";

        for (int i=0; i<[result length]-diff-1; i++)
            newResult = [newResult stringByAppendingFormat:@"%c",[result characterAtIndex:i]];

        return newResult;
    }

    return result;
} 
```

* * *

**测试它：**

```
- (void)awakeFromNib
{
    NSLog(@"%@",[self formatFloat:234.63]);
    NSLog(@"%@",[self formatFloat:1234.65]);
    NSLog(@"%@",[self formatFloat:11234.65]);
    NSLog(@"%@",[self formatFloat:11234]);
} 
```

**输出 ：**

```
2012-04-26 19:27:24.429 newProj[1798:903] 234.63
2012-04-26 19:27:24.432 newProj[1798:903] 1234.6
2012-04-26 19:27:24.432 newProj[1798:903] 11234
2012-04-26 19:27:24.432 newProj[1798:903] 11234 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:07:02.820

这是我在代码中实现这一点的方式。不知道效率如何，希望不会差。

所以我创建了一个全局 NSNumberFormatter

```
NSNumberFormatter* numFormatter; 
```

并在某处初始化它：

```
numFormatter=[[NSNumberFormatter alloc]init]; 
```

然后我使用以下函数格式化数字：

```
- (NSString*)formatFloat:(Float32)number withOptimalDigits:(UInt8)optimalDigits maxDecimals:(UInt8)maxDecimals
{
    NSString* result;
    UInt8 intDigits=(int)log10f(number)+1;
    NSLog(@"Formatting %.5f with maxDig: %d maxDec: %d intLength: %d",number,optimalDigits,maxDecimals,intDigits);  

    numFormatter.maximumFractionDigits=maxDecimals;
    if(intDigits>=optimalDigitis-maxDecimals) {
        numFormatter.usesSignificantDigits=YES;
        numFormatter.maximumSignificantDigits=(intDigits>optimalDigits)?intDigits:optimalDigits;
    } else {
        numFormatter.usesSignificantDigits=NO;
    }
    result = [numFormatter stringFromNumber:[NSNumber numberWithFloat:number]];

    return result;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-12-25T05:12:17.767

在 iOS 8上使用`maximumFractionDigits`和`maximumSignificantDigits`一起使用时这是一个错误吗？`NSNumberForamtter`

```
 NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
        formatter.maximumFractionDigits = 2;  
        formatter.maximumSignificantDigits = 3;
        NSLog(@"%@", [formatter stringFromNumber:@(0.3333)]); // output 0.333 expected 0.33 
```

如果我只使用它就可以正常工作`maximumFractionDigits`

```
 NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
        formatter.maximumFractionDigits = 2;
        NSLog(@"%@", [formatter stringFromNumber:@(0.3333)]); // output expected .33 
```

[NSNumberFormatter maximumFractionDigits 和 maximumSignificantDigits 错误](https://stackoverflow.com/questions/27644341/nsnumberforamtter-maximumfractiondigits-and-maximumsignificantdigits-bug)

# postgresql - 如何强制删除 Postgresql 中的运算符？

> ID：10337173
> 
> 赞同：1
> 
> 时间：2012-04-26T16:05:13.473
> 
> 标签：postgresql

我的数据库有从整数到文本的隐式转换，所以我遇到了一些“运算符不是唯一的”问题。我正在尝试删除运算符 || (text, anynonarray) 没有成功，错误信息是

> 错误：无法删除运算符 ||(text,anynonarray)，因为数据库系统需要它 SQL 状态：2BP01

我有另一个没有这个运算符的数据库，所以我认为有可能。我不能在数百个查询中添加显式转换，也不能删除隐式转换。有办法强制移除这个操作员吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T20:43:20.100

看来我明白了。诀窍是直接从 pg_operator 表中删除。

```
delete from pg_operator where oprname = '||' and (oprleft = 25 or oprleft = 2776 ) and oprleft != oprright 
```

因为我想删除这些运算符：

> 运算符 ||("文本", anynonarray);
> 
> 运算符 ||(anynonarray, "text");

我不知道是否有任何影响，但到目前为止似乎还可以。

# embedded - Synopsys USB OTG 控制器 (2.65a) 在 USB 设备模式下偶尔会截断同步 IN

> ID：10337174
> 
> 赞同：0
> 
> 时间：2012-04-26T16:05:14.437
> 
> 标签：embedded, usb, usb-otg

我在设备模式下使用 Synopsys OTG 内核。使用专用于该端点的周期性 FIFO 对等时 IN 高速端点 (USB 2.0) 进行编程，以实现每微帧的最大传输量（3 个 1024 字节的数据包）。它在 99+% 的时间里都有效。但有时传输会被截断。例如，前 1024 个字节将使用 DATA0 PID（而不是正确的 DATA2 PID）进入总线，其余 2048 个字节将不会被发送。由于我已经正确编程了数据包计数、多重计数、最大数据包大小和传输大小，我不确定是什么原因造成的。

显然这是一个非常具体的问题，我不太希望得到答案，但我认为在黑暗中试一试值得一试。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:02:33.023

同步传输不保证数据包的传递。因此，如果主机控制器有其他活动传输，它将默默地丢弃同步数据包。如果您需要保证包装交付，您应该使用批量转移（但它不会保证交付时间）。

同步是理想的应用程序，如声音或视频流，您需要恒定的传输时间，但丢失一些帧是可以的。

该规范对总线进行了限制，允许为全速总线上的定期传输（中断和同步）分配不超过 90% 的任何帧。在高速总线上，这个限制减少到不超过 80% 的微帧可以分配给定期传输。(c) [http://www.beyondlogic.org/usbnutshell/usb4.shtml](http://www.beyondlogic.org/usbnutshell/usb4.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-02T20:45:13.260

回答我自己的问题，以防它可以帮助别人。这个 OTG 控制器似乎有一个错误，即 TX FIFO 并不总是正确清空。我发现一个成功的解决方法是在每次 TX 之后刷新 FIFO。它很快，截断症状消失了。

# asp.net - 创建会话变量会自动创建一个 cookie

> ID：10337192
> 
> 赞同：0
> 
> 时间：2012-04-26T16:06:14.360
> 
> 标签：asp.net, asp.net-mvc-3, cookies, session-variables

标题中的问题。我认为会话变量存储在内存中，唯一创建的 cookie 是 SessionID cookie。出于某种原因，每次我创建会话变量时，它也会创建一个同名的 cookie。这是正常行为吗？

代码：

```
HttpContext.Current.Session[varName.ToString()] = value; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:05:45.377

> 这是正常行为吗？

是的，这是绝对正常的。默认情况下，会话由 cookie 跟踪。因此，当您将某些内容存储到会话中时，会将具有唯一 ID 的 cookie 发送给客户端，以便在后续请求中，该客户端发送该 cookie，并且服务器能够使用该 ID 检索它存储在内存中的任何内容。

如果在后续请求中更新会话值，则不会有新的 cookie。会话已与此客户端关联。

# javascript - 如何在页面加载时自动打开电子邮件

> ID：10337193
> 
> 赞同：3
> 
> 时间：2012-04-26T16:06:14.163
> 
> 标签：javascript, html, mailto

我想在 html 页面加载时自动打开一封带有收件人和主题的电子邮件。我只需要使用 mailto 功能。有人可以帮我怎么做吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T16:08:44.123

将用户重定向到一个`mailto`链接。这可以通过基本的 JavaScript 来完成：

```
location.href = "mailto:you@example.com?subject=Test+Message"; 
```

只需考虑以下事实：

1.  现在很多人使用在线电子邮件（GMail、hotmail 等）——不是我个人，而是……其他人。
2.  如果用户有一个桌面电子邮件程序，您将强制在他们身上打开一个意外的窗口。
3.  如果用户有一个桌面电子邮件程序，但从未设置过，那就更糟了——就像第 1 点中大多数人的情况一样。窗口会打开，然后整个“电子邮件设置”过程就会开始。

小心点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T17:23:39.660

尝试这样的事情

```
 <html>
       <head>

       <script type="text/javascript">
        function mymessage()
        {
         location.href = "mailto:you@example.com?subject=Hello";

         }
        </script>
    </head>

    <body onload="mymessage()">
    </body>

     </html> 
```

# android - 无法从 K-9 电子邮件应用程序收到未读电子邮件

> ID：10337195
> 
> 赞同：1
> 
> 时间：2012-04-26T16:06:18.477
> 
> 标签：android, email, broadcastreceiver

我正在尝试从 K-9 电子邮件客户端获取未读电子邮件列表。我正在使用以下代码：

```
public class EmailReceiver extends BroadcastReceiver{
public static final Uri k9uri = Uri.parse("content://com.fsck.k9.messageprovider/inbox_messages/");
static String[] messages_projection = new String[] {"subject", "preview", "unread"};

@Override
public void onReceive(Context context, Intent intent) {
    try {
        Context mContext = context;
        Cursor curSt = mContext.getContentResolver().query(k9uri, messages_projection, "unread='true'", null, null);
        curSt.moveToFirst();
... 
```

问题是它返回收件箱中的所有消息，无论它们是否被阅读。我已经从已读和未读消息中查看了“未读”列的内容，它们确实分别具有值“真”和“假”。我已经为此寻找解决方案，但无法提出解决方案。有没有人遇到过这个问题。如果是这样，是否有解决此问题的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:09:32.180

只需过滤数组即可。

# python - 在 python 中处理 unicode 字符的问题

> ID：10337197
> 
> 赞同：1
> 
> 时间：2012-04-26T16:06:20.287
> 
> 标签：python, unicode

我编写了以下代码用于将内容写入文件，

```
 with codecs.open(name,"a","utf8") as myfile:
         myfile.write(str(eachrecord[1]).encode('utf8'))
         myfile.write(" ")
         myfile.write(str(eachrecord[0]).encode('utf8'))
         myfile.write("\n")` 
```

上面的代码在编写 uni-code 字符时无法正常工作......即使我正在使用编解码器并进行编码。我不断收到错误

> UnicodeEncodeError：“ascii”编解码器无法在位置 6 编码字符 u'\xe1'：序数不在范围内（128）

谁能看到我做错了什么？

**编辑：**

```
with codecs.open(name,"a","utf8") as myfile:
                    myfile.write(unicode(eachrecord[1]))
                    myfile.write(" ")
                    myfile.write(unicode(eachrecord[0]))
                    myfile.write("\n") 
```

这行得通..感谢所有快速的评论和答案..这真的很有帮助..直到你们告诉我，我才意识到 python 有“unicode”选项

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:12:28.187

删除`str()`呼叫。他们正在使用默认编码（`ascii`在这种情况下）进行隐式编码。

# c# - XBAP - FullTrust 部署

> ID：10337198
> 
> 赞同：0
> 
> 时间：2012-04-26T16:06:23.283
> 
> 标签：c#, deployment, certificate, clickonce, xbap

我有一个想要发布的 XBAP 应用程序。这个应用程序需要 FullTrust，所以我需要签名。

我可以这样做并发布应用程序。但是，没有我的证书的客户无法安装/运行该应用程序，他们必须在安装之前安装证书。
有没有办法避免或自动化它？要么在部署中嵌入证书安装（单击一次），要么签署应用程序使用服务，如 VerySign（例如）？

SSL 是一个可能对这里有所帮助的主题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:59:57.573

您需要按照您的建议使用来自受信任的证书颁发机构（例如 Verisign）的证书对 clickonce 进行签名。否则，您将需要用户将您生成的证书分发给您的用户，并让他们将其安装在本地计算机上。

# android - 启动时出现 Android Eclipse 错误

> ID：10337199
> 
> 赞同：0
> 
> 时间：2012-04-26T16:06:26.417
> 
> 标签：android, eclipse

我正在使用 Eclipse 开发一个 android 应用程序。在我昨晚尝试将其部署到我的设备之前，一切都进行得很顺利。当我单击运行时，我看到了以下内容：

```
[2012-04-26 09:00:52 - Unicyclist] Android Launch!
[2012-04-26 09:00:52 - Unicyclist] adb is running normally.
[2012-04-26 09:00:52 - Unicyclist] Performing com.unicycle.UnicyclistActivity activity launch
[2012-04-26 09:00:52 - Unicyclist] Automatic Target Mode: Unable to detect device compatibility. Please select a target device.
[2012-04-26 09:01:05 - Unicyclist] Uploading Unicyclist.apk onto device 'SH0AZR805746'
[2012-04-26 09:01:05 - Unicyclist] Failed to install Unicyclist.apk on device 'SH0AZR805746': No such file or directory
[2012-04-26 09:01:05 - Unicyclist] com.android.ddmlib.SyncException: No such file or directory
[2012-04-26 09:01:05 - Unicyclist] Launch canceled! 
```

听起来它试图在手机上安装的目录丢失了。或者它可能是我电脑上的一个目录？通过搜索我找不到任何关于此的内容，而且**我不确定如何调试它。**

*   这是电话，不是虚拟设备。

*   手机正在运行 cyanogenmod，而不是库存。

*   昨晚更新了一堆应用程序（相关？）我从备份中重新映像了手机，并且应用程序正确部署。然后我更新了自上次备份以来更改的应用程序，并将其放置一夜。今天早上，它不会再次部署（同样的问题）

*   该应用程序在另一台平板电脑上启动正常，在虚拟设备上启动正常

*   我的开发环境位于保管箱文件夹中，如果这有什么不同的话。我在 Windows 和 2 台 linux 计算机上进行开发之间切换。

*   使用此手机的两台 linux 计算机上都出现同样的问题（尚未尝试 windows）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:43:26.610

问题是 Eclipse 无法找到您的 apk 文件。只需尝试构建干净。[这](https://stackoverflow.com/questions/6450738/failed-to-install-apk-on-device-local-path-doesnt-exist)是另一个类似的问题。

# perl - Selenium WebDriver 与 Perl

> ID：10337205
> 
> 赞同：2
> 
> 时间：2012-04-26T16:07:06.510
> 
> 标签：perl, selenium-webdriver

我正在尝试使用 Perl 绑定运行 Selenium 驱动程序，并且由于缺乏示例和文档，我遇到了一些障碍。我已经想出了如何做一些基本的事情，但我似乎遇到了一些其他简单事情的问题，比如使用 package.xml 验证页面上的文本`Remote::Driver`。

如果我尝试做这样的事情：

```
$sel->get("https://www.yahoo.com/" );
$ret = $sel->find_element("//div[contains( text(),'Thursday, April 26, 2012')]"); 
```

我收到一条消息，说找不到该元素。我正在使用 xpath，因为驱动程序包似乎没有专门用于查找文本的子程序.. 至少不是我找到的。

如果我的 xpath 设置错误或者有人知道更好的方法，那将非常有帮助。我也遇到了一些按钮点击的问题..但这似乎应该更容易并且困扰着我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:08:28.390

在网页上查找文本并将该文本与使用 Selenium::Remote::Driver 的某些“已知良好值”进行比较可以实现如下：

文件：SomeWebApp.pm

```
package SomeWebApp;

sub get_text_present {

    my $self = shift;
    my $target = shift;
    my $locator = shift;

    my $text = $self->{driver}->find_element($target, $locator)->get_text();

    return $text;

} 
```

在您的测试脚本中的某处：test.pl

```
my $text = $some_web_app->get_text_present("MainContent_RequiredFieldValidator6", "id"); 
```

上面使用 $locator 标识的定位方案找到 $target 标识的元素，并将其存储在变量 $text 中。然后，您可以根据需要/需要使用它来比较/验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T19:16:20.230

https 的加载速度比 http 慢一点。虽然 WebDriver 非常适合等到它发现请求的页面已完全加载，但也许你需要在这里给它一点帮助。添加**睡眠（2）；**在 get() 调用之后，看看它是否有效。如果是这样，请尝试减少到​​ 1 秒。您还可以调用 get_title 来查看您是否已加载您认为拥有的页面。

另一种可能性是您的文本目标与页面上的内容并不*完全相同*。您可以尝试先查找一个单词，例如“April”，然后查看是否命中，然后展开直到找到不匹配的内容（例如，该字符串实际上是否有换行符或换行符？HTML 怎么样？实体，例如不间断空间？）。此外，您正在 div 下的任何地方寻找那段文本（所有子文本应该是连接的，然后搜索完成）。这更有可能撒网太广，而不是什么都得不到，但值得知道。

# php - 文本解码后输出 \r\n - PHP

> ID：10337206
> 
> 赞同：1
> 
> 时间：2012-04-26T16:07:07.267
> 
> 标签：php, encoding, str-replace, nl2br

我正在构建一个应用程序，用户可以在其中将注释输入文本区域。然后在输入数据库时​​对注释进行编码。当我解码返回值时，nl2br 函数不起作用。它不会用 br 标签替换 \r\n 。当不编码/解码文本时，它可以工作。

我正在使用以下代码对我的信息进行编码/解码：[http ://www.myphpscripts.net/tutorial.php?id=9](http://www.myphpscripts.net/tutorial.php?id=9)

如果我进入一个文本区域：

```
Hello  
World 
```

它对其进行编码，然后在解码时返回

```
Hello\r\nWorld. 
```

我可以执行 str_replace，但据我了解，根据浏览器的不同，textarea 可能使用 \n 或 \r 而不是 \r\n。

不知道什么是好的解决方案......请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:51:58.247

如果您要转换的文本位于“<textarea>”中，请不要使用“<br />”。

如果要将文本转换为放置在文本区域中，请使用...

```
str_ireplace("\r\n", "\n", $db_string); //or something similar 
```

如果要将文本转换为放置在文本区域之外，请使用...

```
str_ireplace(array("\r\n", "\n", "\r"), '<br />', $db_string); 
```

Separate browsers use whatever, but I believe they all can read just "\n". However on a side note, the operating system determines "\r\n" vs "\n". Just use "\n". So replace "\r\n" with "\n". Or just leave "\r\n", **use either, as long as you don't put br tags into your textarea tags you'll be all set.**

Mac = Linux = \n Windows = \r\n

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:35:28.260

我已经`Hello\r\nWorld.`使用 zend studio 7.2.0 在 Windows 操作系统中检查了您的解码字符串。我发现 nl2br() 在这两种情况下都可以正常工作`\r\n and \n`。你应该仔细检查你解码的字符串。可能是您在编码之前正在执行addslashes()。如果是这样，那么您必须在使用nl2br() 之前使用stripslashes()。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-26T16:11:13.930

你可以`stripslashes($text)`用来剥离那些。但是，我建议找出添加斜线的原因。你在用`addslashes`吗？

# c# - 异常未在 C# 中捕获

> ID：10337208
> 
> 赞同：-1
> 
> 时间：2012-04-26T16:07:21.020
> 
> 标签：c#, .net

我有一个 Windows 服务应用程序。我已将所有代码放在 try 块中，但有时应用程序仍会崩溃。以下是我从事件查看器收到的错误消息，我无法从代码中找出任何内容。谁能帮我解决这个问题

```
Fault bucket , type 0
Event Name: CLR20r3
Response: Not available
Cab Id: 0

Problem signature:
P1: bgfcimportjobs.exe
P2: 1.0.0.12
P3: 4f8ee332
P4: mscorlib
P5: 2.0.0.0
P6: 4e1539fa
P7: 349e
P8: 1c5
P9: System.IO.IOException
P10: 

Attached files:

These files may be available here:
C:\ProgramData\Microsoft\Windows\WER\ReportQueue\AppCrash_bgfcimportjobs.e_70609b5d8d50b31a8e1a14872a72bb7a82791b3a_2d2ac10e

Analysis symbol: 
Rechecking for solution: 0
Report Id: 1f7048c8-8f63-11e1-8875-b499ba03bf80
Report Status: 4 
```

提前致谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:11:52.540

你真的确定这一切都在 try-catch 之内吗？您需要在所有事件处理程序和类似的东西周围添加它。

由于这是一个 IO 异常，你有读/写文件的代码吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:14:24.933

您的代码位于 Try 块中，但您尝试后是否有 Catch 部分？

```
try
{
   some code...
}
catch(Exception e) 
{
    string message = e.Message;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:55:26.613

你抓住了**正确的例外**吗？
你至少应该赶上*System.IO。**IOException***或其基类。
在*catch*块中，您应该记录整个异常，即：

```
try
{
  your code...
}
catch(IOException e) 
{
  YourLogger.WriteMessage(e);
} 
```

因此，您还可以获得异常的堆栈跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:12:53.743

您是否以某种方式记录捕获的异常，以便您可以实际看到它是什么？

此外 - 您可以运行 Debugger.Launch() - [http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx) - 并逐步查看发生了什么

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T17:12:20.557

可能是您没有捕获 try 块抛出的异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T08:56:56.967

打开 VS 2010。转到 Debug > Exceptions 菜单。现在选中 Throw 类别下的所有复选框。

使用 Debug > Attach to Process 执行服务并附加进程。

现在，如果出现任何错误，执行将告诉引发问题的代码。

# linux - 操作系统如何知道物理内存的实际大小？

> ID：10337210
> 
> 赞同：7
> 
> 时间：2012-04-26T16:07:23.157
> 
> 标签：linux, memory-management, operating-system, kernel

当电脑启动的那一刻加载操作系统，操作系统是如何知道硬件信息的，是否有一些io指令或引导程序从bios获取信息。？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T16:10:33.760

主板固件（也称为 BIOS、ACPI 接口或 EFI）允许操作系统找出系统中 RAM 和 ROM 的物理映射。

例如，这是引导 Linux 的输出：

```
[    0.000000] BIOS-provided physical RAM map:
[    0.000000]  BIOS-e820: 0000000000000000 - 0000000000098c00 (usable)
[    0.000000]  BIOS-e820: 0000000000098c00 - 00000000000a0000 (reserved)
[    0.000000]  BIOS-e820: 00000000000e6000 - 0000000000100000 (reserved)
[    0.000000]  BIOS-e820: 0000000000100000 - 00000000bfea0000 (usable)
[    0.000000]  BIOS-e820: 00000000bfeae000 - 00000000bfeb0000 type 9
[    0.000000]  BIOS-e820: 00000000bfeb0000 - 00000000bfec0000 (ACPI data)
[    0.000000]  BIOS-e820: 00000000bfec0000 - 00000000bfef0000 (ACPI NVS)
[    0.000000]  BIOS-e820: 00000000bfef0000 - 00000000c0000000 (reserved)
[    0.000000]  BIOS-e820: 00000000ffc00000 - 0000000100000000 (reserved)
[    0.000000]  BIOS-e820: 0000000100000000 - 0000000c40000000 (usable) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-25T19:37:53.617

从基于 BIOS 的系统启动的操作系统使用 INT 0x15, AX=0xE820查询[查询系统地址映射函数。](http://www.uruk.org/orig-grub/mem64mb.html)

基于 UEFI 的操作系统通常会使用[GetMemoryMap()](http://wiki.phoenix.com/wiki/index.php/EFI_BOOT_SERVICES#GetMemoryMap.28.29)接口获取物理内存映射。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T16:12:15.893

[在台式机或笔记本电脑等机器上，内存量由BIOS](http://en.wikipedia.org/wiki/BIOS)或[UEFI](http://en.wikipedia.org/wiki/Extensible_Firmware_Interface)提供给操作系统

# javascript - 当前或最受支持的 NodeJS 框架/lib 选项？

> ID：10337215
> 
> 赞同：1
> 
> 时间：2012-04-26T16:07:54.770
> 
> 标签：javascript, node.js, coffeescript, v8

我正在寻找使用 NodeJS 构建一个相当强大的应用程序，但是（对于 Node 来说是新手）我想要一些更有经验的开发人员的意见。

我读过一些关于 flatiron、express / zappa 等的好东西。可悲的是，目前 Node 似乎没有像[http://ruby-toolbox.com](http://ruby-toolbox.com)这样的东西来真正获得一个很好的选择范围。

我需要记住的两件主要事情是，我想使用 CoffeeScript 进行开发，并且这个应用程序可能会与也访问相同数据库的姊妹 Rails 应用程序进行大量交互。

似乎我看过的一些项目，例如 zappa，已经有几个月没有看到一些开发活动了。

**哪些框架拥有最多的社区并满足我的希望？您是否有任何您认为最有用的框架或库组合？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T17:26:56.897

如果您来自 Rails，我建议您查看[http://towerjs.org/](http://towerjs.org/)：

> Tower.js 建立在 Node 的 Connect 和 Express 之上，以 Ruby on Rails 为蓝本。从头开始为客户端和服务器构建。

事情是这样的：Node.js 还不到三年。它吸引了许多非常聪明的开发人员的极大关注，但你不能期望 Rails 生态系统的成熟程度。并非 RoR 世界中的所有东西都具有 Node.js 类似物，您将不得不期望进行更多的低级编码来完成您需要完成的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:12:42.780

是的，有很多听起来很棒但现在已经不复存在的项目。

在寻找好的活跃项目方面，这个页面是一个很好的起点：[https ://github.com/joyent/node/wiki/modules](https://github.com/joyent/node/wiki/modules)

我推荐的一些模块包括

Async Forever n 时刻

否则，快递几乎是普遍的，我以前没听说过熨斗或扎帕

# c# - 继承类的方法传递给基类

> ID：10337220
> 
> 赞同：1
> 
> 时间：2012-04-26T16:08:06.020
> 
> 标签：c#, inheritance, coding-style

我有一种感觉，我做错了。我是抽象类等的新手，并且已经阅读了一些教程，但我不知道如何将它应用于我的情况。我认为我的设计可能有问题，但我想不出另一种方法来做到这一点。我的公司生产了几台不同的计算机，我需要能够监控电池信息。虽然获取信息不是问题，但要弄清楚如何将不同的命令发送到基类来完成我需要它做的事情。假设我想获得我的电池 1 电压。在一个单元上，命令是 0x0418，在另一个单元上是 0x453。因此，在我的信息类中，我进行了测试以查看模型是什么。我有一个名为电池的基类，它有一堆标准的每个电池的变量（电池电压、充电 ic、

现在我对类的设计我认为是正确的（可能是错误的，因为我不擅长抽象和多态）。我有一个面板，最后会显示我从 BatteryInformation 类获得的信息。像 Battery1Cell1Label.Text = batteryInfo.GetCell1(1); Battery2Cell1Label = batteryInfo.GetCell1(2)。

所以在我的基类中，我想我需要一个 GetValue(byte command) （因为它是一个嵌入式控制器命令来获取每种不同类型的信息。）也许我应该停止说话，只是发布我所拥有的代码并告诉你我的错误。

电池.cs

```
public abstract class Battery<T> //not sure that the <T> is right
{
    public string Information { get; private set; }
    public float Cell1 { get; private set; }
    public float Cell2 { get; private set; }
    public float Cell3 { get; private set; }
    public float Cell4 { get; private set; }
    public int FCC { get; private set; }
    public bool ChargeIC { get; private set; }
    public int StartCharge { get; private set; }
    public int CurrentCharge { get; private set; }
    public bool Exists { get; private set; }

    protected internal void GetValue(byte command)
    {
        //Use Embedded controller to get said value
        //ECPort.ReadEC(command);
        //Testing Purposeses
        Console.WriteLine(command);
    }
} 
```

电池8800.cs

```
class Battery8800 : Battery<Battery8800>
{
    public Battery8800() : base()
    {

    }
    public void GetValue(BatteryCommands command)
    {
        base.GetValue((byte)command);
    }

    public enum BatteryCommands
    {
        Battery1VoltageHigh = 0x0402,
        Battery1VoltageLow = 0x0403,
        Batt1ChargeCurrentHigh = 0x0404,
        Batt1ChargeCurrentLow = 0x0405,
        Battery1MaxError = 0x0407,
        Battery1RSOC = 0x0409,
        Battery1FCCHigh = 0x040E,
        Battery1FCCLow = 0x040F,
        Battery1DCHigh = 0x0412,
        Battery1DCLow = 0x0413,
        Battery1Cell1High = 0x0418,
        Battery1Cell1Low = 0x0419,
        Battery1Cell2High = 0x041A,
        Battery1Cell2Low = 0x041B,
        Battery1Cell3High = 0x041C,
        Battery1Cell3Low = 0x041D,
        Battery1Cell4High = 0x041E,
        Battery1Cell4Low = 0x041F,
        PowerSource1 = 0x0420,
//many more commands for battery 2 etc etc
    }
} 
```

电池信息.cs

```
class BatteryInformation
{
    public Battery battery1; //error says it needs 1 type of argument
    public Battery battery2; //error says it needs 1 type of argument
    public BatteryInformation()
    {

        switch (UnitModel.GetModelEnum())
        {
            case UnitModel.DLIModel.DLI8300M:
                battery1 = new Battery8300();
                battery2 = new Battery8300();
                break;
            case UnitModel.DLIModel.DLI8400:
                battery1 = new Battery8400();
                battery2 = new Battery8400();
                break;
            case UnitModel.DLIModel.DLI8500:
                battery1 = new Battery8500();
                break;
            case UnitModel.DLIModel.DLI8500P:
                battery1 = new Battery8500P();
                break;
            case UnitModel.DLIModel.DLI8800:
                battery1 = new Battery8800();
                break;
            case UnitModel.DLIModel.DLI9200:
                battery1 = new Battery9200();
                break;
            default:
                break;
        }
        //for testing purposes
        battery1 = new Battery8800();
        battery1.DoThis(Battery8800.BatteryCommands.Batt1ChargeCurrentHigh);
    }
} 
```

是的草稿保存！刚停电，我没有松口，而是一句话！

所以当我的电脑重新打开时，我想在我的电池面板课上做这样的事情可能会更好。

```
 //in my timer_tick event
    BatteryInformation.UpdateBatteries();
    battery1Cell1Label.Text = BatteryInformation.Battery1.Cell1.ToString();
    //etc etc 
```

但我仍然需要让这个工作，但我很难弄清楚如何进行抽象。感谢您的时间。

**编辑**

我想我会以错误的方式解决这个问题。

```
class Battery1_8400 : Battery
{
    public override bool Update()
    {
        //TODO finish
        Exists = GetValue((ushort)Commands.PowerSource) != 0xFF;
        if (Exists)
        {
            Cell1 = GetValue((ushort)Commands.Cell1Low, (ushort)Commands.Cell1High) / 1000.0f;
            Cell2 = GetValue((ushort)Commands.Cell2Low, (ushort)Commands.Cell2High) / 1000.0f;
            Cell3 = GetValue((ushort)Commands.Cell3Low, (ushort)Commands.Cell3High) / 1000.0f;
            FCC = GetValue((ushort)Commands.FCCLow, (ushort)Commands.FCCHigh);
            Voltage = GetValue((ushort)Commands.VoltageLow, (ushort)Commands.VoltageHigh);
            return true;
        }
        else
        {
            return false;
        }
    }
    private enum Commands
    {
        PowerSource = 0x0480,
        Charge = 0x0432,
        RSOC = 0x0734,
        DCLow = 0x0402,
        DCHigh = 0x0403,
        FCCLow = 0x0404,
        FCCHigh = 0x0405,
        MaxError = 0x0730,
        Cell1Low = 0x0778,
        Cell1High = 0x0779,
        Cell2Low = 0x077C,
        Cell2High = 0x077D,
        Cell3Low = 0x0780,
        Cell3High = 0x0781,
        VoltageLow = 0x0438,
        VoltageHigh = 0x0439,
        ChargeCurrentLow = 0x0728,
        ChargeCurrentHigh = 0x0729,
        ChargeIC = 0x1A03,
    }
} 
```

我有 9 个文件，就更新命令的工作方式而言，它们都是相同的，区别在于枚举。每个类的命令略有不同。查看batter2_8400.cs 的枚举

```
 private enum Commands
    {
        PowerSource = 0x0480,
        Charge = 0x04C2,
        RSOC = 0x0834,
        DCLow = 0x0492,
        DCHigh = 0x0493,
        FCCLow = 0x0494,
        FCCHigh = 0x0495,
        MaxError = 0x0830,
        Cell1Low = 0x0878,
        Cell1High = 0x0879,
        Cell2Low = 0x087C,
        Cell2High = 0x087D,
        Cell3Low = 0x0880,
        Cell3High = 0x0881,
        VoltageLow = 0x04C8,
        VoltageHigh = 0x04C9,
        ChargeCurrentLow = 0x0828,
        ChargeCurrentHigh = 0x0829,
        ChargeIC = 0x1A04,
    } 
```

该更新命令与其他 7 个文件相同。对我来说似乎有点糟糕的设计，但我不知道该怎么做。顺便说一句，这就是我得到一个答案和收到的几条评论之后我的课程的样子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:28:38.047

您的基类 BatteryInformation 应该具有您需要检索的每个值的抽象属性，如下所示：

```
public abstract class BatteryInfo {
    // int should be replaced with the actual data type of the value
    public abstract int VoltageHigh { get; }
    public abstract int VoltageLow { get; }
    // etc. for each value you need
} 
```

然后在您的子类中实现每个属性

```
public class Battery8800 : BatteryInfo {
    public override int VoltageHigh {
        get {
          int value;
          // do code to retrieve value
          return value;
        }
    }
} 
```

另外，我会在某个地方提供一个你的 UI 可以使用的方法，如下所示：

```
 public IEnumerable<BatteryInfo> GetAllBatteryInfo() {
   // get each battery
 } 
```

这样，用户界面就无需担心如何检索每个电池的电池信息。这允许您使用列表或网格样式控件之一来查看电池信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:17:34.687

最后我想我知道我应该做什么了。它对我来说看起来很干净，似乎很有意义。也许你可以批评它？

```
public abstract class Battery
{
    public string Information { get; set; }
    public float Cell1 { get {return GetValue(Cell1Low, Cell1High) / 1000.0f;} }
    public float Cell2 { get {return GetValue(Cell2Low, Cell2High) / 1000.0f;} }
    public float Cell3 { get {return GetValue(Cell3Low, Cell3High) / 1000.0f;} }
    public float Cell4 { get {return GetValue(Cell4Low, Cell4High) / 1000.0f;} }
    public float Voltage { get {return GetValue(VoltageLow, VoltageHigh);} }
    public int DC { get {return GetValue(DCLow, DCHigh);} }
    public int FCC { get {return GetValue(FCCLow, FCCHigh);} }
    //public bool ChargeIC { get {return } }
    //public int StartCharge { get {return } }
    //public int CurrentCharge { get {return } }
    public bool Exists { get {return GetValue(PowerSource) != 0xFF} }
    public int FCCPercent { get {return ((FCC * 100) / DC);} }

    /// <summary>
    /// Gets a value depending on the Embedded controller
    /// </summary>
    /// <param name="low">The low byte command to process</param>
    /// <param name="high">The high byte command to process</param>
    /// <returns></returns>
    private int GetValue(ushort low, ushort high)
    {
        //Use Embedded controller to get said value
        //ECPort.ReadEC(command);
        //Testing Purposeses
        var lowValue = ECPort.ReadEC(low);
        var highValue = ECPort.ReadEC(high);
        return (int)((highValue << 8) + lowValue);
    }

    private int GetValue(ushort command)
    {
        return (int)ECPort.ReadEC(command);
    }

    public abstract ushort PowerSource {get;}
    public abstract ushort Charge{get;}
    public abstract ushort RSOC{get;}
    public abstract ushort DCLow{get;}
    public abstract ushort DCHigh{get;}
    public abstract ushort FCCLow{get;}
    public abstract ushort FCCHigh{get;}
    public abstract ushort MaxError{get;}
    public abstract ushort Cell1Low{get;}
    public abstract ushort Cell1High{get;}
    public abstract ushort Cell2Low{get;}
    public abstract ushort Cell2High{get;}
    public abstract ushort Cell3Low{get;}
    public abstract ushort Cell3High{get;}
    public abstract ushort Cell4Low { get; }
    public abstract ushort Cell4High { get; }
    public abstract ushort VoltageLow{get;}
    public abstract ushort VoltageHigh{get;}
    public abstract ushort ChargeCurrentLow{get;}
    public abstract ushort ChargeCurrentHigh{get;}
    public abstract ushort ChargeIC{get;}

} 
```

然后在我继承它的子类上，一个例子就是这个

```
class Battery1_8400 : Battery
{
    public override ushort PowerSource { get {return 0x0480;}}
    public override ushort Charge { get {return  0x0432;}}
    public override ushort RSOC { get {return  0x0734;}}
    public override ushort DCLow { get {return  0x0402;}}
    public override ushort DCHigh { get {return  0x0403;}}
    public override ushort FCCLow { get {return  0x0404;}}
    public override ushort FCCHigh { get {return  0x0405;}}
    public override ushort MaxError { get {return  0x0730;}}
    public override ushort Cell1Low { get {return  0x0778;}}
    public override ushort Cell1High { get {return  0x0779;}}
    public override ushort Cell2Low { get {return  0x077C;}}
    public override ushort Cell2High { get {return  0x077D;}}
    public override ushort Cell3Low { get {return  0x0780;}}
    public override ushort Cell3High { get {return  0x0781;}}
    public override ushort VoltageLow { get {return  0x0438;}}
    public override ushort VoltageHigh { get {return  0x0439;}}
    public override ushort ChargeCurrentLow { get {return  0x0728;}}
    public override ushort ChargeCurrentHigh { get {return  0x0729;}}
    public override ushort ChargeIC { get {return  0x1A03;}}
} 
```

现在我所要做的就是编辑一个文件battery.cs，如果我需要对其进行更改。

# jquery - 让 supersized.js 和 jquery 循环同时制作动画

> ID：10337229
> 
> 赞同：0
> 
> 时间：2012-04-26T16:08:30.643
> 
> 标签：jquery, animation, cycle, supersized

我在这个网站上使用了两个插件“supersized.js”和“jquery cycle”。

[http://countrypleasin.com/new/](http://countrypleasin.com/new/)

我正在寻找**与标题图像周期同步的超大背景动画**。（文件）。到目前为止，一厢情愿的想法并没有削减它。由于加载时间，我的标题将比我的背景旋转稍早开始动画。

谢谢

$

```
 $(document).ready(function(){
            $.supersized({

                //Functionality
                slideshow               :   1,      //Slideshow on/off
                autoplay                :   1,      //Slideshow starts playing automatically
                start_slide             :   1,      //Start slide (0 is random)
                random                  :   0,      //Randomize slide order (Ignores start slide)
                slide_interval          :   5000,   //Length between transitions
                transition              :   1,      //0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
                transition_speed        :   400,    //Speed of transition
                new_window              :   1,      //Image links open in new window/tab
                pause_hover             :   0,      //Pause slideshow on hover
                keyboard_nav            :   1,      //Keyboard navigation on/off
                performance             :   1,      //0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)
                image_protect           :   1,      //Disables image dragging and right click with Javascript
                image_path              :   'images/', //Default image path

                //Size & Position
                min_width               :   0,      //Min width allowed (in pixels)
                min_height              :   0,      //Min height allowed (in pixels)
                vertical_center         :   0,      //Vertically center background
                horizontal_center       :   1,      //Horizontally center background
                fit_portrait            :   1,      //Portrait images will not exceed browser height
                fit_landscape           :   0,      //Landscape images will not exceed browser width

                //Components
                navigation              :   0,      //Slideshow controls on/off
                thumbnail_navigation    :   0,      //Thumbnail navigation
                slide_counter           :   0,      //Display slide numbers
                slide_captions          :   0,      //Slide caption (Pull from "title" in slides array)
                slides                  :   [       //Slideshow Images
                                                    {image : 'images/bg3.jpg'},  
                                                    {image : 'images/bg2.jpg'},
                                                    {image : 'images/bg1.jpg'}

                                            ]

            }); 
        });

        $(document).ready(function() {
$('h1.home_headline').cycle({
    fx: 'scrollRight', // choose your transition type, ex: fade, scrollUp, shuffle, etc...
    speed:   400,
    timeout: 5000,
    delay:    1000,
    autostop:      true,     // true to end slideshow after X transitions (where X == slide count) 
    autostopCount: 25,

}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T00:44:46.670

我刚刚遇到了完全相同的问题，并且能够通过在开始动画之前添加一些加载条件来使其工作。可能有一种更优雅的方法可以做到这一点，但这至少有效！

首先在 $(window).load() 而不是 $(document).ready 上启动两个动画，以确保首先加载所有图像，使用以下 API 调用设置超大的暂停状态：

```
$(function(){
//pause supersized slideshow
api.playToggle();
}); 
```

设置一个函数，我们可以调用它来在 jQuery Cycle 更改幻灯片之前推进超大幻灯片。它需要知道幻灯片的总数以确保它正确循环。（可能有一种无需手动输入即可计算的方法）

```
var $i = 1;
var $slideTotal = 3;

function slideAdvance()
{
    api.goTo($i);
    $i++;
    if ($i > $slideTotal)
    {
        $i = 1;
    }
} 
```

然后，您可以设置 jquery 循环以在更改幻灯片之前运行您的函数，如下所示：

```
//Start animated banner
$('#banner').cycle({
    fx: 'scrollRight', // choose your transition type, ex: fade, scrollUp, shuffle, etc...
    speed:   400,
    timeout: 5000,
    delay:    1000,
    autostop:      true,     // true to end slideshow after X transitions (where X == slide count) 
    autostopCount: 25,
    before: slideAdvance
}); 
```

瞧，你有你的同步横幅。这还有一个额外的好处，即超大将使用 jquery 自动停止。

# java - 使用hibernate检查数据库表中某些记录的最快方法

> ID：10337233
> 
> 赞同：-3
> 
> 时间：2012-04-26T16:08:44.177
> 
> 标签：java, hibernate, query-optimization

我有使用hibernate orm与db一起工作的java应用程序？那么在数据库中检查记录存在（映射到休眠对象）的最快方法是什么

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T16:19:05.740

使用[`entityManager.find`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#find%28java.lang.Class,%20java.lang.Object%29).

[文档](http://docs.jboss.org/hibernate/entitymanager/3.6/reference/en/html_single/)中的示例：

```
long catId = 1234L;
em.find( Cat.class, new Long(catId) ); 
```

或者，计算记录：

```
Integer count = (Integer) session.createQuery("select count(*) from Cats c where c.id = :catId")
                          .setLong("catId", 1234L)
                          .uniqueResult();
boolean exists = count > 0; 
```

# ruby - 使用 Ruby 求值，将值存储在变量 (x) 中，逐行读取输入文件，将 y 替换为 x，输出文件

> ID：10337237
> 
> 赞同：0
> 
> 时间：2012-04-26T16:08:52.510
> 
> 标签：ruby

总的来说，我对脚本编写还很陌生，所以在学习 ruby​​ 的过程中我仍然学到了很多东西。

我不确定我的标题有多清晰，所以我将向您展示我的开头。

```
puts "Enter the hostname in the format [SID-Profile] -->"
var1 = gets

puts "Enter the IP address and Mask in the format [1.2.3.4 255.255.255.0] -->"
var2 = gets 
```

这就是我的努力失败的地方，我开始怀疑我是否以非常实际的方式解决了这个问题。

我想问一系列问题，将问题的答案保存在变量中，然后导入一个文件，逐行读取，在文件中找到@HOSTNAME，并将其替换为 var1 中保存的值。一旦搜索了整个文件并且 @HOSTNAME 的所有实例都已替换为 var1，请重新开始 var2。当我第一次想到它时，这似乎很快，但我被卡住了。

有任何想法吗？如果还有其他方法，我也很想听听。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:43:46.057

没有真正的方法可以使用 ruby​​ 在文件中进行替换，但你可以作弊。

我会同时进行两次替换，这样您就不必两次读取文件。尝试这个

```
data = IO.readlines("filename")
puts "Enter Hostname"
hostname = gets.chomp
puts "Enter IP"
ip = gets.chomp
data.each do |line|
  line.gsub("@HOSTNAME",hostname)
  line.gsub!("@IPADDRESS",ip)
  puts line
end 
```

这将读取文件并将其打印到屏幕上，以便您可以查看并验证输出。

然后，您可以将脚本的输出定向到新文件，最后将新文件移动到旧文件的位置。

# c# - 按日期时间选择器值过滤访问填充的dataGridView C#

> ID：10337242
> 
> 赞同：1
> 
> 时间：2012-04-26T16:09:16.510
> 
> 标签：c#, ms-access, datagridview, filter, datetimepicker

使用下面的代码，我想对其进行修改，以便 dataGridView (dgReceived) 被“dateTimePicker1”过滤（如图所示）。从**ACCESS**数据库中检索数据非常有用，但我需要添加该过滤器功能。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.OleDb;

namespace dataGridView
{
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            OleDbConnection vcon = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;data source=C:\Query Form\Database.accdb");
            vcon.Open();
            DataSet ds = new DataSet();
            OleDbDataAdapter daReceived = new OleDbDataAdapter();

            OleDbCommand slctReceived = new OleDbCommand("SELECT * FROM script_Received", vcon);
            daReceived.SelectCommand = slctReceived;
            daReceived.Fill(ds, "tblReceived");

            dgReceived.DataSource = ds.Tables["tblReceived"];

        }

        private void dgReceived_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:25:42.387

您可以使用位于表和 DGV 数据源之间的[BindingSource进行过滤。](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.aspx)

它具有用于过滤数据的过滤器属性。

# javascript - 我可以在 Google Maps Styling API 上隐藏非海洋/海洋吗

> ID：10337243
> 
> 赞同：4
> 
> 时间：2012-04-26T16:09:17.637
> 
> 标签：javascript, google-maps-api-3

我确实在仔细检查，因为我认为答案是否定的：我可以隐藏不是海洋/海洋的水体，即湖泊。一位客户评论说，这些较小的水体使地图看起来“复杂”。

这是我的样式规则：

```
fsdStyles = [
        {
            featureType: 'all',
            stylers: [
                {visibility: 'off'},
                {hue: '#00162b'}
            ]
        },
        {
            featureType: 'administrative.country',
            stylers: [
                { visibility: 'on' }
            ]
        },
        {
            featureType: 'water',
            stylers: [
                { hue: '#002f56' },
                { saturation: 85 },
                { lightness: -84 },
                { visibility: 'simplified' }
            ]
        }
]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T17:07:04.923

不，您不能关闭您描述的功能。并且只有单一的特征类型：`water`，没有子类型，因此没有真正的方法可以用一种方式来设计湖泊，用另一种方式来设计海洋。

# java - 将图形添加到 JButton

> ID：10337244
> 
> 赞同：1
> 
> 时间：2012-04-26T16:09:19.663
> 
> 标签：java, swing, awt, jpanel, jbutton

我正在构建一个数独游戏，我正在尝试为每个按钮添加不同的图形。我遇到的问题是让图形看起来正确。我对此进行了编辑以显示我的工作。我现在遇到的最大问题是我的绘图覆盖了我的按钮，所以我无法在按钮顶部获取图像......我要么得到按钮，要么得到绘图。

```
import java.awt.Graphics;
import java.awt.*;
import javax.swing.*;
import java.awt.image.*;

public class SudokuViewWorks extends JPanel {

  private JPanel centerBoard;
  private int cellSize = 48;
  private int Rows;
  private int Cols;
  private int boardSize;
  private MyPanel[][] region;

  public SudokuViewWorks(SudokuBase sb){
    super(new GridLayout(3,3,3,3));
    setVisible(true);

    SudokuBase board = sb;
    Rows = board.rows;
    Cols = board.columns;
    boardSize = Rows * Cols;
     //setBorder(BorderFactory.createLineBorder(Color.black));
     region= new MyPanel[3][3];

     for (int i =0; i < 3; i++){
        for(int j =0; j<3; j++) {
          region[i][j] = new MyPanel(i);
          add(region[i][j]);
          //repaint();

    setPreferredSize(new Dimension(boardSize*cellSize + (boardSize*2 + 11), boardSize*cellSize +(boardSize*2 + 11)));

  }

    //public void paintComponent(Graphics g){

      // a panel for the sudoku board
      //centerBoard = new JPanel(new GridLayout(boardSize, boardSize));

        //Cell button = new Cell(boardSize,boardSize);
        //JButton button = new JButton();
        //ImageIcon icon = new ImageIcon(drawSymbol(g,i));
        //button.setIcon(icon);
        //button.setLayout
        //centerBoard.add(new MyPanel(i));

      }

      //add Jpanel
      //add(region);

    }

    class MyPanel extends JPanel {
      public int num;
      JLabel[][] label = new JLabel[3][3];

      public MyPanel(int numb) {
        super(new GridLayout(3,3,1,1));
        for(int i=0; i<3; i++) {
          for (int j = 0; j<3; j++) {
            label[i][j] = new JLabel("i");
            //label[i][j] = new Cell(boardSize,boardSize);
            add(label[i][j]);
            num = numb;
            setBorder(BorderFactory.createLineBorder(Color.black));
            setVisible(true);

          }
        }
         repaint();
      }

      public Dimension getPreferredSize() {
        return new Dimension(50,50);
      }

      public void paintComponent(Graphics g) {
        //super.paintComponent(g);

      switch(num) {
      case 1:  g.setColor(Color.BLUE);
               g.drawRect(15, 15, 25, 25);

      case 2: g.drawOval(67, 67, 25, 25);
              g.drawString("one", 10,20);

      case 3: g.drawLine(119, 119, 144, 144);
              g.drawString("2", 60,70);
              g.drawLine(144, 119, 119, 144);

      case 4: g.setColor(Color.YELLOW);
           //g.fillRect(10, 20, 80, 70);
           //g.setColor(Color.RED);

      case 5:  g.setColor(Color.GREEN);
               g.fillOval(50, 25, 25, 25); 

      case 6: g.fillOval(50, 25, 25, 25);

      case 7: g.fillOval(50, 25, 25, 25);

      case 8: g.fillOval(50, 25, 25, 25);

      case 9: g.fillOval(50, 25, 25, 25);
      }
       //repaint();

      }
    }

  /**
   * here is the method we are testing against
   */
  public static SudokuBase makeBoard() {
      SudokuBase board = new SudokuBoard(2, 3);
      board.setValue(0, 3, 6);
      board.setValue(0, 5, 1);
      board.setValue(1, 2, 4);
      board.setValue(1, 4, 5);
      board.setValue(1, 5, 3);
      board.setValue(2, 3, 3);
      board.setValue(3, 2, 6);
      board.setValue(4, 0, 2);
      board.setValue(4, 1, 3);
      board.setValue(4, 3, 1);
      board.setValue(5, 0, 6);
      board.setValue(5, 2, 1);
      board.fixGivens();
      board.setValue(1, 0, 6);
      board.setValue(3, 1, 5);
      return board;
   }

  /**public void setSelected(int row, int col){
  }
  public int getSelectedRow(){
  }
  public int getSelectedColumn(){
  }*/

  public static void main(String[] args) {
      JFrame win = new JFrame("Test board");
      win.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

      SudokuViewWorks view = new SudokuViewWorks(makeBoard());

     //win.add(ggo);
      win.add(view);
      win.setVisible(true);
      win.pack();
   }

} 
```

# linux - g++ -D 标志有什么作用？

> ID：10337248
> 
> 赞同：26
> 
> 时间：2012-04-26T16:09:44.840
> 
> 标签：linux, compilation, g++, flags

我正在看一个 CFLAGS -

```
CFLAGS=-g -w -D LINUX -O3 -fpermissive 
```

在 Makefile 中。-D 标志有什么作用？我在手册页上看到

```
-D name
    Predefine name as a macro, with definition 1\. 
```

但我不知道如何解释。我的解释是……它使 LINUX 成为一个宏，并且只在 linux 环境中执行 -03 和 -fpermissive 。是对的吗？如果不是，那又如何？谢谢你的帮助

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-26T16:12:59.193

相当于`#define LINUX 1`在正在编译的文件的源代码中添加语句。它对其他编译标志没有任何影响。这样做的原因是它是一种`#ifdef`在代码中启用语句的简单方法。所以你可以有这样的代码：

```
#ifdef LINUX
   foo;
#endif 
```

`-D`仅当启用了您可以使用标志控制的宏时才会启用它。因此，无需编辑源文件即可在编译时启用/禁用条件编译语句是一种简单的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:13:26.270

它与 没有任何关系`-O3`。基本上，它的含义与

```
#define LINUX 1 
```

在编译文件的开头。

# salesforce - SOQL 查询不返回在 visualforce 页面上确实存在的行

> ID：10337249
> 
> 赞同：1
> 
> 时间：2012-04-26T16:09:53.857
> 
> 标签：salesforce, apex-code, visualforce, soql

SOQL 查询未返回对象中确实存在的 visualforce 页面上的行 我在通过 visualforce 页面上的 SOQL 查询检索对象中存在的记录时遇到问题

我怎么知道它们的存在？我使用了 force explorer 和 workbench，以下返回记录

```
SELECT Code__c FROM External_membership_label__c WHERE Code__c = '3' 
```

好的，所以visualforce页面没有返回上面的记录，下面的代码（代码中的几行）

```
 public String gvlLCCODE {get;set;}

  if(gvlLCCODE != null || gvlLCCODE != ''){

        List<External_membership_label__c> exisitingGVLcodes = [SELECT Code__c FROM External_membership_label__c WHERE Code__c = :gvlLCCODE];

        if (exisitingGVLcodes.Size() > 0){
            //blahh blahh
        }
} 
```

有什么建议么？我有调试告诉我“gvlLCCODE”有一个存在于对象中的值。另外，如果我将 SOQL 更改为，例如，从 users 表中返回当前用户，它会返回一条记录，然后进入 IF 语句。

我认为这是我错过的安全问题。但我也检查了这些。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T21:32:42.370

首先，你应该听基里尔关于 && 的信息，这两个条件都应该满足，而不仅仅是一个。同样，`||`是没有意义的，公式`(a!=b)|(a!=c)`对于任何`a`时候都是正确的，`b!=c`就像这里的情况一样

其次，听起来您肯定在这里遇到了安全问题。`with sharing`验证从to更改扩展的声明`without sharing`并运行。如果您获得该行，则您与该行共享安全问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T20:49:07.497

好吧，首先，在您的 IF 语句中，您可能想要使用 &&，而不是 ||。

你的测试方法有问题吗？如果是这样，那是因为默认情况下该方法无权访问现有记录。

# c# - DateTime.ToOADate() 的问题

> ID：10337252
> 
> 赞同：6
> 
> 时间：2012-04-26T16:10:10.863
> 
> 标签：c#, datetime

DateTime.ToOaDate() 有一些我无法理解的地方。

这就是我所拥有的

```
var plainDate = "01/07/2011";
var dateTime1 = DateTime.Parse(plainDate, new CultureInfo("en-GB"));
var value = dateTime1.ToOADate();
var dateTime2 = DateTime.Parse(DateTime.FromOADate(value).ToString(), new CultureInfo("en-GB")); 
```

dateTime1 和 dateTime2 应该是一样的吧？我只将普通日期转换为刻度，然后将其恢复为具有相同文化的 DateTime，但实际上当我运行它时 dateTime2 的值是 (7-Jan-2011) 而不是 (1-Jul-2011)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T16:14:38.627

我认为这是因为您对 ToString 的调用未指定文化信息。

也试试`ToString(new CultureInfo("en-GB"))`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T16:15:07.083

当你这样做时`DateTime.Parse`，你正在指定你期望传入日期的格式。

当您这样做时`ToString()`，您指定应使用当前文化来格式化日期。

在这里，我猜你`Thread.CurrentThread.CurrentCulture.DateTimeFormat`正在返回美国格式。因此，当您使用 en-GB 解析它时，返回 1 月 7 日`DateTime.FromOADate(value).ToString()`。`07/01/2011`

# javascript - 如何将一个动画与另一个动画合并？

> ID：10337253
> 
> 赞同：1
> 
> 时间：2012-04-26T16:10:13.587
> 
> 标签：javascript, jquery

我最近发布了一个关于移动多个图像的问题，并从 Beetroot 获得了一些建议（感谢 Beetroot ！！）

我正在尝试为游戏板上的图片制作动画。

我已经设法使用具有回调函数的 .animate() 功能来再次运行动画。

我遇到的问题是，随着每个动画运行图像“加速”到“巡航”速度，在“减速”停止之前继续一段距离，然后再次开始这个过程。

这样做的效果是图像以一种激增的方式移动。

是否可以使动画模糊以使图像不会在动画之间“减速”？

我在下面包含了动画函数的代码。

我已尽我所能对其进行评论，并且可以在[此处](http://tranquilityeden.co.uk/colony/example.php)看到该页面的示例。要使其工作，请单击“ind”点并从弹出窗口中选择“sawmill”升级。

```
 function WalkTo(ImgID,Crnt_Coord)
{
    //ImgID is a cobination of the coordinate the picture started on plus the word "worker".
    //Crnt_Coord is the current coordinate the image is on
    var index = parseInt(ImgID.replace("worker", ""));
    var Image = Animate_Image[index];// this array holds the Ids for the images for the $(Image) jquery code later.

    var Current_Coord = Crnt_Coord;
    if(Crnt_Coord==Animate_End_Coord[index])
        {Animate_Delivered[index]=1;} //checks to see if image has arrived at destination and sets the delivered to 1
    if(Crnt_Coord==index)
        {Animate_Delivered[index]=0;}// checks to see if image is back at starting location, sets delivered back to 0 so object can start journey again.

    var End_Coord;//destination
    if(Animate_Delivered[index]==0){End_Coord = Animate_End_Coord[index];}//if image has not arrived it gets the destination from an array
    else{End_Coord = index;}//delivered now set to 1 and destination is set as startposition.

    //I now run a simple path finding function to determine next move, it returns as a string the next coodinate and the bearing (north,east,south,west)
    var bearing_next_coord = Direction(Current_Coord,End_Coord);
    var bearing = bearing_next_coord[0];
    var Next_Coord = parseInt(bearing_next_coord.substring(1));

    var pos = $(Image).position();//Gets the current pixel position of the image
    var left = pos.left;
    var top = pos.top;

    var imgSrc = "images/animations/"+Animate_Job[index]+"_dude_"+bearing+".gif";//changes the image so worker appears to turn
        //The switch below then sets the distance and direction for the image to travel in the .animate
        switch(bearing)
        {
        case "n":
        top-=60;
        break;
        case "e":
        left+=60;
        break;
        case "s":
        top+=60;
        break;
        case "w":
        left-=60;
        break;
        }
    if(zone_array[Next_Coord]==""){$(Image).attr("src", "images/icons/boat.gif");}//changes image to boat if the image needs to cross water
    else{$(Image).attr("src", imgSrc);}//for land use the imgSrc
    //finally the animate using the varibles set above, then set the function to run again with new "currentCoordinate"
    $(Image).animate({left: left,top: top}, 1500, function(){WalkTo(ImgID,Next_Coord)});

} 
```

提前感谢您的帮助！！

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:12:18.800

指定持续时间后将动画缓动设置为“线性”，以防止动画加速或减速。这样，巡航速度将始终保持不变，因此动画永远不会加速或减速；它只会以相同的速度开始和停止，并在更改动画时保持该速度。

```
$(Image).animate({left: left,top: top}, 1500, 'linear' function(){WalkTo(ImgID,Next_Coord)}); 
```

# php - 守护一个 php 脚本

> ID：10337254
> 
> 赞同：0
> 
> 时间：2012-04-26T16:10:14.217
> 
> 标签：php

我想在 Linux 中的 PHP 5.3 下守护一个 php 脚本（Jobque.php）

这个想法是这样调用脚本：

```
php -f ./application/Model/Jobque.php start 
```

然后脚本会执行一个 shell_exec 将自己置于后台并进行这样的处理

```
nohup php -f /var/.../application/Model/Jobque.php process 2> /dev/null & echo $! 
```

最后一个命令确实在后台启动脚本，一切都很好，但是当我从脚本本身发出这个命令时，脚本会一直等到执行停止（从不）

这是我用来将脚本作为守护进程启动的功能 - Windows 部分有效

```
public function start_daemon() {
        if (file_exists ( $this->pidfile ))
            die ( 'process is already running - process pidfile already exists -> ' . $this->pidfile );
        $cmd = 'php -f ' . __FILE__ . ' process';
        if (substr ( php_uname (), 0, 7 ) == "Windows") {
            $WshShell = new COM ( "WScript.Shell" );
            $oExec = $WshShell->Run ( "$cmd /C dir /S %windir%", 0, false );
            exec ( 'TASKLIST /NH /FO "CSV" /FI "imagename eq php.exe" /FI "cputime eq 00:00:00"', $output );
            $output = explode ( '","', $output [0] );
            $pid = $output [1];
            file_put_contents ( $this->pidfile, $pid );
        } else {
            $execstr = "nohup $cmd 2> /dev/null & echo $!";
            //echo $execstr; -- the execstr is right in itself
            $PID = shell_exec ( $execstr );
            //echo $PID; -- we never get here
            file_put_contents ( $this->pidfile, $PID );
        }
        echo ('JobQue daemon started with pidfile:' . $this->pidfile);
    } 
```

我在这里做错了什么，如何做对？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:15:05.603

看看： http: [//pear.php.net/package/System_Daemon](http://pear.php.net/package/System_Daemon)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T06:27:20.463

我最终使用 pcntl_fork 来守护 Linux 下的脚本，如下所示：

```
public function start_daemon($worker) {
        if (file_exists ( $this->get_pidfile ( $worker ) ))
            die ( 'process is already running - process pidfile already exists -> ' . $this->get_pidfile ( $worker ) . "\n" );
        $cmd = 'php -f ' . __FILE__ . ' process';
        if ($this->is_win) {
            $WshShell = new COM ( "WScript.Shell" );
            $oExec = $WshShell->Run ( "$cmd /C dir /S %windir%", 0, false );
            exec ( 'TASKLIST /NH /FO "CSV" /FI "imagename eq php.exe" /FI "cputime eq 00:00:00"', $output );
            $output = explode ( '","', $output [0] );
            $pid = $output [1];
            file_put_contents ( $this->get_pidfile ( $worker ), $pid );
            echo ('JobQue daemon started with pidfile:' . $this->get_pidfile ( $worker ) . "\n");
        } else {
            $PID = pcntl_fork ();
            if ($PID) {
                file_put_contents ( $this->get_pidfile ( $worker ), $PID );
                echo ('JobQue daemon started with pidfile:' . $this->get_pidfile ( $worker ) . "\n");
                exit (); // kill parent
            }
            posix_setsid (); // become session leader
            chdir ( "/" );
            umask ( 0 ); // clear umask
            $this->process_jobs (); //start infinite loop
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T14:43:33.067

看一下 daemonize 命令：[http ://software.clapper.org/daemonize/index.html](http://software.clapper.org/daemonize/index.html)

或者，ubuntu 上的“新贵”：http: [//upstart.ubuntu.com/](http://upstart.ubuntu.com/)

# html - HTML5 Websocket 脚本在 Ubuntu 中工作，在 Win7 或 WinXP 中不工作

> ID：10337255
> 
> 赞同：1
> 
> 时间：2012-04-26T16:10:17.250
> 
> 标签：html, node.js, websocket, socket.io, phpwebsocket

我已经在我的 Win7 机器上安装了[lemmingzshadow / php-websocket](https://github.com/lemmingzshadow/php-websocket)，这很简单：

1.  将内容解压缩到我的 htdocs 文件夹中。
2.  从命令行执行 server.php。
3.  从支持 Websockets 的浏览器请求文件 /client/status.html。

### 现在这是我在运行 Google Chrome 19 / Windows 7 的本地机器上得到的结果

![Win7](../Images/b05c5991877900aee0e0767dedd39733.png) [点击放大](https://i.stack.imgur.com/CcBwy.jpg)

它显示“已连接”30 秒（不显示来自服务器的信息）然后显示“已断开连接”，这是相关的命令行输出：

![命令行报告](../Images/75f5153a7b25707543c05fb0fe5e7192.png)

### 使用 Firefox 12 / WinXP 从另一台计算机通过 LAN 访问脚本时完全相同的问题

![WINXP](../Images/0c911717db90ddf407953848794e22c6.png) [点击放大](https://i.stack.imgur.com/KiCkR.jpg)

### 它似乎只在使用 Firefox 7.0.1 或 Chromium 从我的 VirtualBox Ubuntu 访问它时才有效

![Ubuntu](../Images/d718a1e34934f2db51abcece3ed1fa2a.png) [点击放大](https://i.stack.imgur.com/g5Z8D.jpg)

自从我试图弄清楚为什么会发生这种情况已经好几天了，尝试了其他 Websocket 脚本，它们只有在我从 Ubuntu 访问它们时才起作用。我什至在 Ubuntu / XAMPP 上安装了同样的脚本，但仍然遇到同样的问题（脚本在 Ubuntu 上运行良好，但在其他操作系统上却没有）。

我为此发疯，知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T06:48:25.833

在该代码 (lemmingzshadow) 中，默认行为是服务器屏蔽它发送给客户端的数据：

连接.php： `public function send($payload, $type = 'text', $masked = true)`

出于某种原因，这将在 Chrome 18 中运行，但它违反了最新的 websocket 规范并且在 Chrome 19 中不起作用。

> RFC 6455 第 5.1 节：
> 
> > 服务器不得屏蔽它发送给客户端的任何帧。如果客户端检测到屏蔽帧，它必须关闭连接。

# c - 与其他两个进程的通信进程

> ID：10337263
> 
> 赞同：0
> 
> 时间：2012-04-26T16:10:50.067
> 
> 标签：c, linux, systems-programming

我逐行阅读以下文件（file.txt）：

```
 1
   -5
   6
  -8
  -33
  21 
```

父进程向一个进程发送负数，向第二个进程发送正数：

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <sys/wait.h>

void Fils1(int *tube1)
{
  int n;
  int cpt = 0;
  close (tube1[1]);

  while (read (tube1[0], &n, 1) >0)
  {
    cpt+=n;
  }

  printf("Son 1, count : %i \n", cpt);
  exit (1) ;
}

void Fils2(int *tube2)
{
  int n;
  int cpt = 0;
  close (tube2[1]);

  while (read (tube2[0], &n, 1) >0)
  {
    cpt+=n;
  }

  printf("Son 2, count : %i \n", cpt);
  exit (1) ;
}

int main(int argc, char *argv[])
{
 FILE* file;
 int n;

 file = fopen (argv[1], "r");

 if (file == NULL){
      printf("Error open file %s\n", argv[1]);
      exit(1);
  }

 int tube1[2];
 int tube2[2];

 if (pipe(tube1) != 0)
 {
   fprintf(stderr, "Error tube 1\n");
   return EXIT_FAILURE;
 }

 if (pipe(tube2) != 0)
 {
   fprintf(stderr, "Error tube 2\n");
   return EXIT_FAILURE;
 }

 int pid1 = fork();

 if(pid1 == 0)
 {
    printf("Creation of the first son ! \n");
    Fils1 (tube1);
 }
 else
 {
    int pid2 = fork();
    if(pid2 == 0)
    {
      printf("Creation of the second son ! \n");
      Fils2 (tube2);
    }
    else
    {
       printf("I'm the father! \n");

       close (tube1[0]);
       close (tube2[0]);

       while (!feof(file))
       {
         fscanf (file,"%d",&n);
         if (n>0)
         {
             write (tube1[1], &n, 1);
         }
         else
         {
           write (tube2[1], &n, 1);
         }
       }
      fclose (file); 

      if(wait(NULL) == -1)
      {
        printf("Error wait()\n");
        exit(1);
      }
    }
 }

 return EXIT_SUCCESS;
} 
```

每个儿子都在数数，并将其显示在屏幕上。

当我执行时，我只有：

```
I'm the father!
Creation of the first son!
Creation of the second son! 
```

当我也期待

```
 Son1, count : 28
   Son2, count : 46 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:26:14.400

问题是您没有按照应有的方式关闭管道。

*   Child1 应该关闭`tube2`（两端）
*   Child2 应该关闭`tube1`（两端）；
*   父母应该关闭写结束（之后`while`）

# kineticjs - 如何使用 KineticJS 创建从一个圆圈到另一个圆圈的箭头？

> ID：10337267
> 
> 赞同：1
> 
> 时间：2012-04-26T16:11:14.110
> 
> 标签：kineticjs

如何使用 KinectJS 创建从一个圆圈到另一个圆圈的箭头？

我有 2 个圆，半径 = r，行程 = 1。我如何做一个平滑的圆形箭头，或者只是从一个到另一个的路径？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:34:47.557

如果你只想要一条简单的线，你可以使用

```
 Kinetic.Line({
        points: [circle1.getX(), circle1.getY(), circle2.getX(), circle2.getY()],
        stroke: 'red',
        strokeWidth: 15,
        lineCap: 'round',
        lineJoin: 'round'
 }); 
```

可以使用 Kinetic.Spline() 创建曲线

```
 var spline = new Kinetic.Spline({
    points: [{
      x: circle1.getX(),
      y: circle1.getY()
    }, {
      x: (circle1.getX()+circle2.getX())/2, 
      y: (circle1.getY()+circle2.getX())/2 +50   // modify this 50 to something that makes it round
    }, {
      x: circle2.getX(),
      y: circle2.getY()
    }],
    stroke: 'red',
    strokeWidth: 2,
    lineCap: 'round',
    tension: 1
  }); 
```

# asp.net-mvc-3 - 在特定的 ASP .NET MVC 3 字段上设置授权？

> ID：10337268
> 
> 赞同：1
> 
> 时间：2012-04-26T16:11:14.240
> 
> 标签：asp.net-mvc-3, authorization

是否可以在 MVC 3 中的特定字段上设置授权？

我最初的想法（和 MSDN 研究）表明 [Authorize] 标签仅用于控制器级别的操作（创建、编辑、索引等）。我可以在控制器操作上执行此操作：

```
[Authorize(Roles = "RoleA,RoleB")]
   public ActionResult Create()
    {            
        return View(new Tracking());
    } 
```

场景是两个角色（RoleA 和 RoleB）可以访问“编辑”控制器。但只有 RoleA 可以更改第一个字段。其他角色 (B) 只能查看该字段。

我想在特定领域做这样的事情：

```
[Required]
[Range(1, 99)]
[Authorize(Roles = "RoleA")]
public int Sequence { get; set; } 
```

**更新1：**

对 StackOverflow 兔子角色的更多研究表明我需要使用部分视图。

所以在我看来，我添加了这段代码：

```
<div>
    @if (Context.User.IsInRole("RoleA"))
    {
        @Html.Partial("_SequenceEdit")
    }
    else
    {
       @Html.Partial("_SequenceView")
    }

</div> 
```

因此，如果用户是 RoleA，他们将获得允许编辑“序列”字段的部分视图。否则，他们只能看到“序列”字段。

我的视图只有部分视图如下所示：

```
<div class="editor-label">
        @Html.LabelFor(model => model.Sequence)
    </div>
    <div class="editor-field">
        @Html.DisplayFor(model => model.Sequence)
        @Html.HiddenFor(model => model.Sequence)
        @Html.ValidationMessageFor(model => model.Sequence)
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T16:00:48.680

我看到您已经想出了如何修改视图以便不向角色 B 中的用户显示文本框。但是您还应该进行服务器端验证以确保只有角色 A 中的用户可以编辑该字段。

```
[Authorize(Roles = "RoleA,RoleB")]
[HttpPost]
public ActionResult Edit(int trackingID, Tracking newTrackingObject)
{
    // grab the current version of the tracking object from your data repo
    var oldTrackingObject = trackingRepo.GetByID(trackingID);

    // check if the user is in role A and edit the sequence number
    if(Context.User.IsInRole("RoleA"))
        oldTrackingObject.Sequence = newTrackingObject.Sequence;

    // continue processing the new tracking object

    // after all processing is done, persist the edited tracking object back to the repo
    trackingRepo.Update(oldTrackingObject);
    trackingRepo.SaveChanges();
} 
```

这将防止角色 B 中的用户通过手动编辑隐藏的表单字段（例如使用 FireBug 或类似工具）来更改序列字段。

# ruby-on-rails - 当控制器看起来像这样时，将 POST 卷曲到 Rails 应用程序

> ID：10337274
> 
> 赞同：0
> 
> 时间：2012-04-26T16:11:40.257
> 
> 标签：ruby-on-rails, post, curl

我正在尝试 curl POST 我的 Rails 应用程序以创建一个新的 Entry 对象。问题是我的 entries_controller 创建操作如下所示：

```
 def create
        @user = current_user
        @entry = @user.entries.build(params[:entry])

        respond_to do |format|
         if @entry.save
          format.html { redirect_to landing_page_url, notice: 'Entry was successfully created.' }
          format.json { render json: @entry, status: :created, location: @entry }
         else
          format.html { render action: "new" }
          format.json { render json: @entry.errors, status: :unprocessable_entity }
         end
        end
       end 
```

调用 @user.entries.build 只会返回一个异常，因为 current_user 不存在。问题是当我使用浏览器创建条目时（当我登录并创建 current_user 变量时），创建操作效果很好，但我不知道是否可以在不更改控制器逻辑的情况下卷曲 POST 并创建一个条目。如果不可能，有人可以帮助找到正确的方向来构建控制器逻辑（与 curl POST 兼容）吗？

如果这是一个愚蠢的问题，我很抱歉，我对这一切都很陌生。

PS：我正在使用 Rails 3.2.3，如果有帮助的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:46:12.203

不确定您如何创建 current_user （它基于什么），但这必须存在才能使您的方法正常工作。如果您可以将参数传递给指定用户并将 current_user 设置为`current_user ||= params[:user]`... 的操作，请注意此操作的安全隐患。

您确实应该在设置 current_user 的操作上有一个 before_filter （我假设是通过登录）。

# sql-server - 计算字符串列 SQL 中的逻辑表达式

> ID：10337282
> 
> 赞同：3
> 
> 时间：2012-04-26T16:12:23.033
> 
> 标签：sql-server, tsql, sql-server-2005

我有一个包含列**id** (int)、**逻辑表达式**(varchar) 和**结果**(bit) 的表。逻辑表达式存储在一个 varchar 中，我需要对其进行评估并将结果放入**结果**列。例如，该列可能包含：

```
'1=1'
'2<3 AND 1^1=1'
'3>4 OR 4<2' 
```

结果列应包含

```
1
0
0 
```

目前我正在使用游标来导航行并使用动态 sql 来评估表达式。

```
"IF(" + @expression + ") SET @result = 1" 
```

有没有更好、更有效的方法来做到这一点？理想情况下，我想摆脱光标。有任何想法吗？使用程序集会更好地执行此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:35:00.337

我会选择CLR。

我在这里发布了一个非常相似的答案：[Convert string with expression to decimal](https://stackoverflow.com/questions/10277884/convert-string-with-expression-to-decimal/10278603#10278603)

事实上，上面的答案对于（和任何其他简单的表达式）未经修改就可以正常工作：

```
SELECT dbo.eval('1=1' )
SELECT dbo.eval('3>4 OR 4<2' ) 
```

但是，使用`^`(caret) 运算符的操作会失败 - 您需要调整 CLR 以处理按位 XOR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T05:22:47.110

前段时间，我在 SQL 中编写了一个用户定义的函数来给出计算中缀算术表达式的十进制结果，例如 1+2+3+4/(5-2)。代码在[这里](http://users.drew.edu/skass/sql/Infix.sql.txt)。您可能可以将其调整为适用于您的布尔表达式。它使用了一个名为 Sequence0_8000 的整数表，您可以按照您想要的任何方式填充该表。

# security - 在 .net 4.0 中运行 ANTS 探查器时出现 System.Security.VerificationException

> ID：10337283
> 
> 赞同：7
> 
> 时间：2012-04-26T16:12:24.510
> 
> 标签：security, .net-4.0, profiler, full-trust, red-gate-ants

我使用 RedGate 的 ANTS Performance Profiler 已经有一段时间了。我们最近将我们的 3rd 方 dll (Telerik) 更新到了他们的 .net 4.0 版本。当我们这样做时，我不再可以分析我们的代码，因为只要我点击 Telerik 控件，我就会得到：

> System.Security.VerificationException：操作可能会破坏运行时的稳定性。

我与 RedGate 交谈，他们告诉我，“基本上，这完全取决于 Microsoft 及其对 CASPOL 的更改。ANTS 具有更多功能，这些功能需要高权限，以便 ANTS 可以在运行环境中从程序集中读取元数据......”

**他们的建议是在完全信任模式下运行该过程。我怎么做？**

我尝试对我们的 Assembly.cs 文件进行调整，但由于问题似乎不是由我们的代码产生的，因此在调整代码方面我无能为力。

PS 我们的应用程序是 WPF/Winforms 桌面应用程序。我通过更改 web.config 找到了 Web 应用程序的解决方案，但我似乎无法真正找到等效的解决方案（或者如果存在则理解它）。

# c - 在 C 中打印一个非常大的整数

> ID：10337284
> 
> 赞同：1
> 
> 时间：2012-04-26T16:12:27.120
> 
> 标签：c

我在浮点变量中存储了一个非常大的数字，但是当我打印它时，我只想显示整数部分，小数点后什么也不显示。

对于 int 或 long 范围内的数字，我会进行强制转换，但这对我没有帮助，因为我要打印的数字对于 int 或 long 来说太长了。

我看过这个解释：[http](http://www.cprogramming.com/tutorial/printf-format-strings.html) ://www.cprogramming.com/tutorial/printf-format-strings.html但我没有成功解决这个问题。

这是我的代码和我尝试进行铸造：

```
double sum=552074001368;
long long_sum;
long_sum = (long)(sum);      //int casting for double "add" 
if(sum>=0) printf("=\n%ld\n",long_sum);
else printf("=\n%ld\n",-long_sum); 
```

我不想使用特定的精度，`printf("%15f")`因为这个变量会波动，有时很短，比如 4 位数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:17:25.027

使用精度修饰符`.0`并打印`floor`数字：

```
printf("%.0f\n", floor(sum)); 
```

（或者 的`floor`，`abs`如果您只想要幅度，如您的示例代码中所示。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T16:18:55.647

我想你追求的是`%.0f`. 例如：

```
#include <stdio.h>

int main(){

    double x = 1234.567;

    printf("%.0f", x);
    return 0;
} 
```

...印刷：

```
1235 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:44:18.440

这条线是有问题的：

```
double sum=552074001368; 
```

由于这是一个整数文字，编译器将首先检查该数字是否适合`int`, then `long`, then `long long`。如果它不适合`long long`我怀疑你会得到一个编译器错误或未定义的行为环绕，我不确定哪个。

如果您的编译器支持`long long`，那么代码将起作用，并且该数字将存储在临时文件中`long long`（将被优化掉）。然后`long long`将其存储在`double`.

相反，这样写：

```
double sum=552074001368.0; 
```

.0 语法为您提供了一个双浮点文字，根本不涉及整数类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:29:43.233

你为什么要投射到很长的时间？使用 printf 格式说明符来控制打印的字符和数量。 [http://www.cplusplus.com/reference/clibrary/cstdio/printf/](http://www.cplusplus.com/reference/clibrary/cstdio/printf/)

请记住，宽度和精度都可以由变量指定，并且不必在编译时知道：

```
printf("=\n%.*lf\n", 4, sum); // print 4 places behind the decimal point

 int i;
 i = 5;
// print only the whole number part of sum and output at least i characters,
//    pad with leading spaces if number requires fewer than i characters 
printf("=\n%*.*lf\n", i, 0, sum); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T22:17:54.863

```
double sum=552074001368LL;
long long long_sum;
long_sum = (long long)(sum);
if(sum>=0) printf("=\n%lld\n",long_sum);
else printf("=\n%lld\n",-long_sum); 
```

# database - 扫描数据库并发送特定标签更改的电子邮件

> ID：10337287
> 
> 赞同：0
> 
> 时间：2012-04-26T16:12:36.133
> 
> 标签：database, email, database-scan

我有一个包含一些商品的数据库。这些商品在这个数据库中有一个价格。我想以某种方式扫描这个数据库，当产品价格发生变化时，我想向特定地址发送电子邮件。这可能吗？我应该使用什么编程语言 php？我该怎么做才能解决这个问题？我对数据库很陌生，我们将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:22:06.247

您可以缓存所有价格并运行一个选择所有价格并比较它们的脚本，或者您可以在 UPDATE 上设置一个触发器，该触发器将调用用户定义的函数或存储过程。从那里，您可以选择发送电子邮件的内容/位置。

# ruby-on-rails - 无法在 Heroku 上使用 Devise 登录

> ID：10337288
> 
> 赞同：0
> 
> 时间：2012-04-26T16:12:41.653
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我最近使用他们的指南将我的第一个应用程序推送到了 heroku。（https://devcenter.heroku.com/articles/rails3）考虑到推送，一切都很好。现在我访问了我的应用程序并尝试注册，现在每次我尝试注册或登录时都会从我的公共文件夹中出现错误 500 页面。

该应用程序当前仅包含我的 gem 依赖项。

```
gem 'devise'
gem 'haml'
gem 'cancan'
gem 'easy_roles'
gem 'paperclip'
gem 'therubyracer'
gem 'activeadmin'
gem 'formtastic' 
```

如果我得到heroku日志：

```
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/validations.rb:50:in `save'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/attribute_methods/dirty.rb:22:in `save'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:241:in `block (2 levels) in save'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
2012-04-26T16:03:15+00:00 heroku[router]: POST cold-mist-6471.herokuapp.com/users/sign_in dyno=web.1 queue=0 wait=0ms service=224ms status=500 bytes=643
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/devise-2.0.4/lib/devise/models/trackable.rb:26:in `update_tracked_fields!'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:208:in `transaction'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:241:in `block in save'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:240:in `save'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/devise-2.0.4/lib/devise/hooks/trackable.rb:7:in `block in <top (required)>'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/hooks.rb:14:in `block in _run_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/hooks.rb:9:in `each'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/hooks.rb:9:in `_run_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/proxy.rb:113:in `authenticate!'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/proxy.rb:165:in `set_user'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/proxy.rb:298:in `_perform_authentication'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/devise-2.0.4/app/controllers/devise/sessions_controller.rb:14:in `create'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/hooks.rb:14:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:53:in `_run_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rendering.rb:10:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/base.rb:167:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:447:in `_run__77755734840326551__process_action__4521632167829203251__callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/callbacks.rb:17:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications.rb:123:in `instrument'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications.rb:123:in `block in instrument'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rescue.rb:29:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/base.rb:121:in `process'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rack_delegation.rb:14:in `dispat

2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/rendering.rb:45:in `process'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:66:in `dispatch'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal.rb:203:in `dispatch'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal.rb:246:in `block in action'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:66:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:30:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/mapper.rb:40:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:68:in `block in call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `each'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:589:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/sass-3.1.16/lib/sass/plugin/rack.rb:54:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:34:in `catch'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:35:in `block in call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.1.1/lib/warden/manager.rb:34:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:35:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/head.rb:14:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/query_cache.rb:64:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/cookies.rb:338:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/flash.rb:242:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/logger.rb:16:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/logger.rb:26:in `call_app'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/request_id.rb:22:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `_run__4075917817454350211__call__1038533202048283850__callbacks'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/static.rb:53:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:479:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:155:in `invalidate'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:143:in `pass'
2012-04-26T16:03:15+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
2012-04-26T16:03:15+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
2012-04-26T16:03:15+00:00 app[web.1]: cache: [POST /users/sign_in] invalidate, pass
2012-04-26T16:03:15+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'
2012-04-26T16:03:15+00:00 app[web.1]: 
2012-04-26T16:03:15+00:00 app[web.1]: 
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:71:in `call!'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application.rb:220:in `call'
2012-04-26T16:03:15+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/log_tailer.rb:14:in `call' 
```

我只是不知道为什么这不起作用...

本地的一切都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T06:14:32.460

看起来你还没有迁移 heroku 的数据库。

尝试：

```
heroku run rake db:migrate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T13:57:22.103

嗯，找到了。

我正在将一个角色写入一个新添加的列。这没有按预期工作。

# django - 为通用 get_context_data 扩展通用视图类

> ID：10337290
> 
> 赞同：17
> 
> 时间：2012-04-26T16:12:43.467
> 
> 标签：django, django-generic-views

我经常看到自己不得不在我的许多观点的上下文中添加相同的额外变量。

```
def get_context_data(self, **kwargs):
    # Call the base implementation first to get a context
    context = super(MyListView, self).get_context_data(**kwargs)
    # Add in the house
    context['house'] = self.get_object().house
    return context 
```

由于我不喜欢重复自己，我想我可以创建一个扩展视图的新类，然后我可以将所有视图基于新的扩展视图类。问题是，我使用了 4 类视图：CreateView、UpdateView、ListView 和 DeleteView。我真的必须为每个人创建一个新课程吗？

没有像 Django“基础”视图类之类的东西吗？也许更聪明的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-26T18:04:03.837

创建一个混合：

```
from django.views.generic.base import ContextMixin

class HouseMixin(ContextMixin):
  def get_house(self):
    # Get the house somehow
    return house

  def get_context_data(self, **kwargs):
    ctx = super(HouseMixin, self).get_context_data(**kwargs)
    ctx['house'] = self.get_house()
    return ctx 
```

然后在您的其他类中，您将使用多重继承：

```
class HouseEditView(HouseMixin, UpdateView):
  pass

class HouseListView(HouseMixin, ListView):
  pass 
```

依此类推，那么所有这些观点都会`house`在上下文中产生。

# facebook - 用户在 Facebook Auth Dialogue Javascript SDK 中跳过权限

> ID：10337295
> 
> 赞同：3
> 
> 时间：2012-04-26T16:12:55.137
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-authentication

我在使用 facebook javascript sdk 的页面选项卡中有一个应用程序。当新用户使用该应用程序时，我会看到预期的“使用 facebook 登录”弹出窗口。我也有一些扩展权限，我在 FB.Login 的范围参数中添加了这些权限。用户使用 facebook 登录后，我看到了预期的扩展权限弹出窗口。唯一的问题是如果用户跳过扩展权限，对话会返回一个 access_token，但它对扩展权限无效。下面的代码示例。

```
window.fbAsyncInit = function () {
    FB.Canvas.setAutoGrow();
    FB.init({
        appId: facebookAppId, 
        status: true, // check login status
    });

    function updateFBInfo(response) {
        console.log('updateResp:');
        if (response.authResponse) {
            //user is already logged in and connected
            FB.api('/me', function (info) {
                displayUserInfo(info, response);
            });
        }
        else {
            FB.login(function (loginResponse) {
                if (loginResponse.authResponse) {
                    FB.api('/me', function (info) {
                        displayUserInfo(info, loginResponse);
                    });
                }
            }, { scope: 'email,manage_pages,offline_access,publish_stream' });
        }
    }

    FB.getLoginStatus(updateFBInfo);
}; 
```

我想我的问题是，我错过了什么（这一定很简单），或者有没有办法检查返回的 accesss_token 是否真的有效？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T16:19:48.243

在继续之前，您需要明确检查权限。如果他们没有提供必要的权限，您需要再次显示`FB.login()`必要的范围。

这是检查权限的代码：

```
FB.api('/me/permissions', function (response) {
            var perms = response.data[0];
            // Check for publish_stream permission in this case....
            if (perms.publish_stream) {                
                // User has permission
            } else {                
                // User DOESN'T have permission. Perhaps ask for them again with FB.login?
            }                                            
    } ); 
```

# java - jmeter 给出错误没有可用的缓冲区空间（达到最大连接数？）：连接

> ID：10337302
> 
> 赞同：1
> 
> 时间：2012-04-26T16:13:28.850
> 
> 标签：java, unit-testing, jmeter, load-testing, socketexception

```
Number of threads = 20 
Ramp-up period = 10 
Loop count = 200 
```

一段时间后出现错误：

```
java.net.SocketException: No buffer space available (maximum connections reached?): connect
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:163)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:395)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:530)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:234)
    at sun.net.www.http.HttpClient.New(HttpClient.java:307)
    at sun.net.www.http.HttpClient.New(HttpClient.java:324)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:970)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:911)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:836)
    at org.apache.jmeter.protocol.http.sampler.HTTPJavaImpl.sample(HTTPJavaImpl.java:483)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy.sample(HTTPSamplerProxy.java:62)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1018)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1004)
    at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:411)
    at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:297)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:51:56.403

似乎您的问题可能不是 jmeter 实例而是 os / env 问题。

1.  根据这些链接查看建议：
    [寻找 java.net.SocketException：没有可用的缓冲区空间](https://stackoverflow.com/questions/1226155/hunt-down-java-net-socketexception-no-buffer-space-available)
    [http://www.codeweblog.com/no-buffer-space-available/](http://www.codeweblog.com/no-buffer-space-available/)

2.  如果您想在 WinXP 之类的操作系统上运行您的 jmeter，请查看[这些说明](http://support.microsoft.com/kb/196271)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T15:59:50.910

可能是您没有关闭连接。尝试更改采样器上的 Keep Alive 选项，但请记住检查来自真实浏览器的真实请求实际发送的内容（您不想掩盖潜在问题）。也可能是您的服务器未配置为关闭连接，这又可能是您的应用程序的一个真正问题。

# ms-access - Access 2003，需要代码导入文件，运行spec转换为文本，然后重命名文件

> ID：10337306
> 
> 赞同：2
> 
> 时间：2012-04-26T16:13:37.227
> 
> 标签：ms-access, import

我在这方面遇到了很大的困难——有人可以帮忙吗？我需要用于导入文件的命令按钮的代码（文件每次都会不同，但始终是 txt. 或 csv），运行将所有数据类型转换为文本的导入规范（该规范称为 SpecsTest），然后调用表“Scrubbed”（不是原始文件名）。我也无法创建一个有效的宏——挑战是每次运行时原始文件名都会不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:20:14.417

没有用过 Access，但是用 Excel 做了很多。尝试这个：

```
Dim ds As FileDialog
Set ds = Application.FileDialog(msoFileDialogOpen)
ds.Show
Dim path as String
path = ds.SelectedItems(1) 
```

您必须添加一些检查以确保选择了文件等，但这应该让您走上正确的轨道。顺便说一句，您可以在 FileDialog 中配置默认​​目录、过滤器等，因此您应该能够限制用户搞砸导入的倾向，但您永远无法分辨。

# jquery - -1 的 eval 加法不起作用

> ID：10337312
> 
> 赞同：0
> 
> 时间：2012-04-26T16:14:18.207
> 
> 标签：jquery, eval

我在使用这个 js 代码时遇到了问题：

```
$('.downvoted').live('click',function(){
var ele = $(this);
var truc = ele.prev('.score_position');

$.post('ajax/vote.php', { vote :ele.attr('title') }, function(data) {
    if(data == 'done'){
        ele.removeClass('downvoted').addClass('downvote').html('<img src="images/down.png" />');
        truc.html(eval(truc.html()+1));
    }
});
return false;
}); 
```

所以我在另外 3 次有同样的功能来投票、取消投票和投票。它运行良好，但有一个例外，如果 truc.html() 为 -1，则它变为 -11 而不是 0。

知道为什么它不起作用吗？（你们可以在这里尝试：http: [//91.121.154.130/](http://91.121.154.130/?sort=last&#) ?sort=last with id:azerty pw:azerty）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:15:59.013

不要`eval()`用于这种工作！在 Javascript 中使用`parseInt`,`Number(...)`或任何其他多种将值转换为数字的方法。

```
truc.html(parseInt(truc.html(), 10) + 1); 
```

注意函数中的第二个参数`parseInt`。这意味着您希望将传入的值解析为以 10 为底的数字。如果您将一个以 0 开头的数字传入`parseInt`函数中而不指定基数，您将得到一个意外和不需要的结果。

或者

```
truc.html(Number(truc.html())+1); 
```

甚至这样：

```
truc.html(truc.html()*1 + 1); 
```

这是有效的，因为将字符串数字乘以一个结果会将变量转换为数字。小心——如果你乘的变量不是一个有效的数字，你会得到`NaN`！

你不能简单地做的原因`truc.html(truc.html()+1);`是因为`.html()`返回一个字符串值。如果您在 Javascript 中将数字添加到字符串，则该数字会简单地连接到字符串，并且不会执行任何数学运算。（例如“-1”+“1”等于“-11”）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T16:15:41.750

首先尝试将值解析（从不使用`eval`）为整数：

```
truc.html( parseInt( truc.html(), 10 ) + 1 ); 
```

请记住，`+`它还在 JavaScript 中执行字符串连接。如果你有一个字符串，'1'，你*添加*一个整数 1 到它，它会得到一个字符串 '11'。

首先将字符串解析为整数，然后执行数学运算，得到您预期的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T16:16:41.937

这个问题是因为 javascript 的连接器是加号`+`，如果解析为字符串 a`+`将导致字符串连接，而不是所需的加法。通过确保 JS使用如下函数将您解析`truc.html()`为 int 来修复它：`parseInt()`

```
truc.html( parseInt( truc.html(), 10 ) + 1 ); 
```

也不知道你为什么首先使用 eval，Elliot 已经触及了那里的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T16:16:36.693

```
truc.html(parseInt( truc.html(), 10 ) + 1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:16:23.337

您需要确保该值是整数，并且`.text()`在这种情况下 Use of 更好。

```
parseInt(truc.text(), 10)+1 
```

# android - ListView 中的复选框在屏幕旋转时消失

> ID：10337316
> 
> 赞同：1
> 
> 时间：2012-04-26T16:14:29.800
> 
> 标签：android, android-listview, rotation, checkbox

我的应用程序**首先要做的是****通过设置可见性**来加载**不可见**`ListView`的项目。当用户点击菜单按钮时，它将打开和关闭可见性和其他一些布局。下面是代码，我删除了一些不必要的部分：**`CheckBoxes``View.Gone`**`CheckBox`

```
private void editmodeSwitch(boolean flag){
    // get topbar, bottombar, and bottombar2
    LinearLayout topbar = (LinearLayout) findViewById(R.id.task_topbar_linearLayout);
    LinearLayout bottombar = (LinearLayout) findViewById(R.id.task_bottombar1_linearlayout);
    LinearLayout bottombar2 = (LinearLayout) findViewById(R.id.task_bottombar2_linearlayout);

    if(flag){
        isEditmodeOn = true;            

        // make topbar and bottombar2 visilble, but bottombar gone
        topbar.setVisibility(View.VISIBLE);
        bottombar.setVisibility(View.GONE);
        bottombar2.setVisibility(View.VISIBLE);

        // make checkboxes visible in listview visible as well
        for(int i=0; i<listView.getChildCount(); i++){
            LinearLayout ll = (LinearLayout) listView.getChildAt(i);
            CheckBox cb = (CheckBox) ll.findViewById(R.id.task_row_checkBox1);
            cb.setVisibility(View.VISIBLE);
        }
    }
    else{
        isEditmodeOn = false;

        topbar.setVisibility(View.GONE);
        bottombar.setVisibility(View.VISIBLE);
        bottombar2.setVisibility(View.GONE);

        // set each checkbox false and its visibility gone
        for(int i=0; i<listView.getChildCount(); i++){
            LinearLayout ll = (LinearLayout) listView.getChildAt(i);
            CheckBox cb = (CheckBox) ll.findViewById(R.id.task_row_checkBox1);
            cb.setVisibility(View.GONE);
            cb.setChecked(false);
        }
    }
} 
```

它工作正常，但问题是屏幕旋转时应用程序不起作用（更改屏幕方向）。一切正常，因为它显示了一些布局，但只有`CheckBoxes in list items. Below is the code in`onCreate()`：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.task_layout);

    initialize();
    loadDB();
    updateListAdapter(list_title, list_date);

    // in case of screen rotation
    if(savedInstanceState != null){
        isEditmodeOn = savedInstanceState.getBoolean(EDITMODE_CHECK);
        isItemChecked = savedInstanceState.getBoolean(ITEM_CHECK);

        if(isEditmodeOn){
            if(!isItemChecked){
                Log.i(tag, "item NOT checked");
                editmodeSwitch(true);
            } else{
                //this is something different so please don't mind
                deditmodeSwitch(savedInstanceState.getBooleanArray(LIST_CB_CHECK));
            }
        }
    }
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);

    // save values for rotation
    outState.putBoolean(EDITMODE_CHECK, isEditmodeOn);
    outState.putBoolean(ITEM_CHECK, isItemChecked);
    outState.putBooleanArray(LIST_CB_CHECK, list_cb_check);
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    Log.i(tag, "you're in onRestoreInstanceState()");

    // in case of screen rotation
    if(savedInstanceState != null){
        isEditmodeOn = savedInstanceState.getBoolean(EDITMODE_CHECK);
        isItemChecked = savedInstanceState.getBoolean(ITEM_CHECK);

        if(isEditmodeOn){
            if(!isItemChecked){
                Log.i(tag, "item NOT checked");
                editmodeSwitch(true);
            } else{
                // this is for something else so please ignore this part
                editmodeSwitch(savedInstanceState.getBooleanArray(LIST_CB_CHECK));
            }
        }
    } 
```

我猜是**最后`ListView`正在加载**。因此，即使 in 中的代码`onCreate()`可见`CheckBoxes`，它`CheckBoxes`也会再次变为不可见，因为它在 xml 中的初始化将这样做。但是，我被困在这里，需要您的建议来解决这个问题。谁能帮我？

以防万一，下面是 getview 的布局 xml 文件的复选框代码。

```
<CheckBox android:id="@+id/task_row_checkBox1" android:gravity="right" 
    android:layout_width="wrap_content" android:layout_height="wrap_content" 
    android:visibility="gone"
    /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:47:24.270

覆盖`onSaveInstanceState`以保存屏幕旋转的值，并`onRestoreInstanceState`作为：

```
protected void onCreate(Bundle savedInstanceState) {

    if(null != savedInstanceState)
            {
                Boolean IntTest = savedInstanceState.getBoolean("ITEM_CHECK");
                Boolean StrTest = savedInstanceState.getBoolean("ITEM_CHECK");
                Log.e(TAG, "onCreate get the   savedInstanceState+IntTest="+IntTest+"+StrTest="+StrTest);        
            }
}
        @Override
        public void onSaveInstanceState(Bundle savedInstanceState) {
            // Save away the CheckBoxes states, so we still have it if the activity
            // needs to be killed while paused.

          savedInstanceState.putBoolean(EDITMODE_CHECK, 0);
          savedInstanceState.putBoolean(ITEM_CHECK, 0);
          super.onSaveInstanceState(savedInstanceState);
          Log.e(TAG, "onSaveInstanceState");
        } 
        @Override
        public void onRestoreInstanceState(Bundle savedInstanceState) {
          super.onRestoreInstanceState(savedInstanceState);
          Boolean IntTest = savedInstanceState.getBoolean(EDITMODE_CHECK);
          Boolean StrTest = savedInstanceState.getBoolean(ITEM_CHECK);
          Log.e(TAG, "onRestoreInstanceState+IntTest="+IntTest+"+StrTest="+StrTest);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:30:09.707

与覆盖 onCreate 的方式类似，您可以覆盖 onConfigurationChanged(...)，您可以将其设置为在屏幕改变方向时运行。

为了在屏幕旋转时触发 OnConfigurationChanged(...)，您需要编辑清单并将该关系/规则放入。

这很容易做到，但需要一些解释，之前在这个问题中已经回答过： [Activity restart on rotation Android](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)

编辑：这是关于如何处理配置更改的开发指南 [http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)

编辑#2：首先，让我建议使用 Imran 的解决方案。它更好地遵循开发人员指南，最终结果将是相同的。

**现在，对于 onConfigurationChanged 解决方案。**

看看你在用你的 onCreate 做什么：

1) 设置视图。（此时复选框已隐藏。对吗？）

2）调用您的数据库并确定您是否应该显示复选框（编辑模式）

3) 使所有复选框可见。

现在，onConfigurationChanged 还调用 setContentView，此时您的所有复选框都将再次隐藏。所以你需要重复使你的复选框可见的过程（上面的#3）。您可能不需要重复第 2 步，因为应该保留该值，但我不确定您的应用程序的逻辑是如何工作的，因此您*可能*需要重新执行第 2 步。

那有意义吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T14:33:55.407

根据我的经验，getview 似乎在最后被触发，这就是为什么 'onRestoreInstanceState()' 和 'onConfigurationChanged()' 无法成功的原因，因为 getview 将重置我的复选框作为布局 xml 文件中的初始化不可见。

因此，我能找到的唯一解决方案是我必须在 getview 中控制它们以获得答案。

# c# - Microsoft.Expression.Encoder.MediaItem 的可靠性如何？

> ID：10337319
> 
> 赞同：0
> 
> 时间：2012-04-26T16:14:43.320
> 
> 标签：c#, video-streaming, video-processing, quicktime, video-encoding

我正在使用`Microsoft.Expression.Encoder`命名空间通过以下方法获取 VideoFile Upload 的缩略图：

```
 MediaItem video = new MediaItem(file);
                int Duration = video.FileDuration.Seconds;
                using (var bitmap = video.MainMediaFile.GetThumbnail
                        (new TimeSpan(0, 0, (int)Duration / 2),
                        new System.Drawing.Size(640, 480)
                      ))
                {
                    bitmap.Save(Path.Combine(_fileDirectory, UniqueId + "_thumb.jpg"));
                } 
```

构造函数 new MediaItem(file) 需要在机器上安装本机软件，例如用于 .MOV 文件的 QuickTime Player，我想知道如果每分钟上传 500 个视频，这种情况的可靠性如何，因为它使用 QuicktimePlayer 获取文件info 并且每个线程都可以同时使用 QuickTimePlayer 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:30:53.337

您很可能需要自己进行测试。尝试在单个线程和多个线程中运行它。使用线程池可能是明智的，因为线程可以重复使用。

原因是所有硬件都不同，同一个应用程序的行为可能会有所不同，例如，单个视频卡可能不允许您同时运行两个负载，但是如果您有多个视频卡，则很可能是可能的。

PS 我不了解视频处理（或 Microsoft.Expression.Encoder 命名空间）。

# jquery - JQuery 选择器在我的多级导航栏上无法正常工作

> ID：10337326
> 
> 赞同：4
> 
> 时间：2012-04-26T16:15:17.367
> 
> 标签：jquery, html

我正在尝试制作一个具有多个级别的简单水平导航栏（但现在，我只制作了一个具有一个子级别的导航栏）。我在[这里](http://www.webdesigndev.com/web-development/create-the-fanciest-dropdown-menu-you-ever-saw)按照本教程进行了一些修改：

```
<ul id = "sample2">
    <li>
        <a href="#">About Us</a>
        <ul>
            <li><a href="#">Website</a></li>
            <li><a href="#">Creator</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Our Products</a>
        <ul>
            <li><a href="#">Product 1</a></li>
            <li><a href="#">Product 2</a></li>
            <li><a href="#">Just give us money</a></li>
        </ul>
    </li>
    <li>
        <a href="#">FAQs</a>
        <ul>
            <li><a href="#">What is this?</a></li>
            <li><a href="#">Why should I care???</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Contact</a>
        <ul>
            <li><a href="#">Telephone</a></li>
            <li><a href="#">Mobile Phone</a></li>
            <li><a href="#">E-mail</a></li>
        </ul>
    </li>
    <li><a href="#">Login</a></li>
</ul> 
```

我在主目录上只使用了一个 id，`<ul>`并且我正在使用`#sample2 ul`而不是在那些上使用类来访问子级别。

但是，当我使用 JQuery 代码时它根本不起作用：

```
$(function () {
    $('#sample2 ul').each(function () {
        $(this).parent().eq(0).hover(function () {
            $('#sample2 ul:eq(0)', this).show(100);
            }, function () {
            $('#sample2 ul:eq(0)', this).hide(100);
        });
    });
}); 
```

同样，我只将教程的`.dropdown`类更改为`#sample2 ul`.

但是，如果我按照教程的方式进行操作（即在子级别上分配一个 id 或一个类），它确实有效，尽管我认为这是不必要的，因为`<ul>`可以使用 css 选择器选择这些 sub-s。

我究竟做错了什么？这些子级别真的只能使用分配的类/ID来选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:50:39.573

这应该可以解决问题。 [jsFiddle](http://jsfiddle.net/bXX7F/1/)

```
$(function () {
    $('#sample2').on('hover', 'li', showSubMenu);
    $('#sample2').on('mouseleave', hideSubMenus);
});

function showSubMenu(){
    $(this).siblings().children('ul').hide(100);
    $(this).children('ul').show(100);
}
function hideSubMenus(){
    $(this).find('ul').hide(100);
} 
```

编辑：您似乎对 jQuery 以及如何使用选择器（尤其是带有上下文的选择器，例如`$(selector, context)`）有些困惑。

在您的示例中，`$('#sample2 ul')`将选择每个`ul`#sample 2 的后代。如果您想为每个添加相同的悬停效果`ul`，`$('#sample2 ul').hover(handler)`或者`$('#sample2 ul').on('hover', handler)`将为您执行此操作。问题是，您不能将鼠标悬停在隐藏的项目上。所以你真正想要的是选择`li`#sample2 下的并将你的处理程序附加到他们的悬停事件。

在悬停事件处理程序中，您使用选择器`$('#sample2 ul:eq(0)', this)`。该选择器中的“this”提供了`#sample2 ul:eq(0)` 将在其中查找的上下文。在事件处理程序中，`this`指的是与该事件相关的元素。在这种情况下，悬停在`li`. Eq(0) 在选择器的引号内没有位置，作为一般规则，应避免作为任何 jQuery 选择器的一部分。因为在上下文中没有`#sample2`元素`this`并且因为`:eq(0)`选择器格式错误，`$('#sample2 ul:eq(0)', this)`将返回一个空的 jQuery 对象（未选择任何内容）。你想要的处理程序是`$(this).children('ul')`. 这将得到`ul`当前悬停的 li 的直接子代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:23:25.227

编辑：这次知道了，我已经测试过了，所以我知道这是可行的，以下是您需要的 js：

```
$(function () {
    $('#sample2 ul').each(function () {
        $(this).parent().children('a').eq(0).hover(function () {
            $(this).parent().children('ul').show(100);
            }, function () {
            $(this).parent().children('ul').hide(100);
        });
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:19:05.727

`#sample2 ul`表示获取`<UL>`ID 为 sample2 的元素的子元素。

您正在寻找的是`ul#sample2`作为选择器，这意味着获取`<UL>`具有 ID sample2 的元素

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T16:19:16.443

你真的不需要jquery。一点简单的 CSS 就会得到想要的结果：

```
​ul#sample2 li ul
{
    display:none;
}
​ul#sample2 li:hover ul
{
    display:block;
}​​​ 
```

[**-- 看演示 --**](http://jsfiddle.net/Curt/hDGmV/)

编辑：这是一个 3 级示例：

[**-- 3 级演示 --**](http://jsfiddle.net/Curt/hDGmV/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:20:26.927

```
$('#sample2 > li').hover(
function() {
   // show
   $('ul', this).show(100);
},
function() {
  // hide
  $('ul', this).hide(100);
}); 
```

[演示](http://jsfiddle.net/hxDmp/3/)

# c# - 延迟加载相关实体不适用于 Entity Framework 4.1

> ID：10337327
> 
> 赞同：2
> 
> 时间：2012-04-26T16:15:18.117
> 
> 标签：c#, entity-framework-4.1, repository-pattern

我们有一个项目使用 Entity Framework 4.1 Code First 进行数据存储。它的编码方式是将 EF 抽象为存储库模式。当从存储库中获取实体时，数据集会传递一个巨大的包含字符串列表，告诉它所有应该获取的相关实体。这会导致一个非常庞大的查询，可能需要 10 秒才能运行 - 即使数据库中没有数据！

已经有很多使用存储库编写的代码来访问数据库，我需要在不破坏模式的情况下理想地提高性能。

我正在尝试进行更改，以便在搜索数据库时，不会将包含字符串传递给数据集（或者只是最小的包含字符串）。当从数据库中获取实体时，它们的相关实体将在首次访问时通过延迟加载来加载。

我有一个名为 Donation 的类，其导航属性如下：

```
public virtual Employee Donor { get; private set; } 
```

Donation 和 Employee 类都有一个私有的无参数构造函数。使用包含字符串“Donor”时，我可以获取捐赠列表，并在返回时附上捐赠者。

当我从没有包含字符串的存储库中获取捐赠时，捐赠者通常返回为空。如果碰巧我以相关员工的身份登录，系统其他地方的另一个查询将已经从 Employee 存储库中获取了我的 Employee 实体。发生这种情况时，将返回捐赠并正确设置员工！很明显，如果数据已经从较早的查询中可用，则数据正在“延迟加载”。但总的来说，我不会已经查询捐赠者和所有其他实体。

谁能建议我做错了什么？对不起，很长的问题。如果需要，我可以发布更多代码，但它是完全不同的。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:18:19.207

我相信，如果您遵循此页面上的指南[http://msdn.microsoft.com/en-us/library/dd468057.aspx](http://msdn.microsoft.com/en-us/library/dd468057.aspx) ，您应该会得到您想要的结果。特别是使您的无参数构造函数受到保护，这应该会有所帮助。

但是，请查看指南的其余部分。

# emacs - 是否有更改 emacs 颜色方案的指南？

> ID：10337330
> 
> 赞同：7
> 
> 时间：2012-04-26T16:15:25.777
> 
> 标签：emacs

在终端中，当我尝试使用 emacs 时，颜色不好，大多数时候我无法正确看到文本。

在 vim 我知道我可以改变颜色方案`:colo <colorscheme_name>`

emacs中是否有类似的东西？将不胜感激有关更改颜色的正确步骤的教程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:54:49.727

我不确定教程，但在我脑海中，你可能想要做的是：`M-x customize`然后导航到名为“Faces”的部分 - 你会得到一堆与配色方案和其他字体相关的设置- 相关设置。

但是 Emacs 有大量与文本显示方式相关的自定义项。我正在使用这个[http://www.nongnu.org/color-theme/](http://www.nongnu.org/color-theme/)但你可以在这里找到很多信息：[http](http://emacswiki.org/emacs/ColorTheme) ://emacswiki.org/emacs/ColorTheme （emacswiki 基本上是首先要咨询*的*资源当您遇到任何与 Emacs 相关的问题时）。

显然，您可以通过添加不同的设置在 .emacs 文件中执行此操作，但我建议先使用更改设置生成的内容，看看它是如何工作的，然后自己添加（一旦您从自定义缓冲区，它会将更改保存到 .emacs 文件中 - 然后您可以打开它并查看它到底做了什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-07T05:41:15.433

```
M-x load-theme 
```

然后使用箭头选择一个主题。

*在此处添加以方便参考（@deong 通过已接受答案下的评论分享了此答案）。*

# c# - 我一直在使用 OleDbConnection 和 OleDbCommand 插入记录而崩溃

> ID：10337331
> 
> 赞同：1
> 
> 时间：2012-04-26T16:15:26.100
> 
> 标签：c#, sql, winforms, ms-access, oledb

```
 OleDbConnection conn = new OleDbConnection(connectionString);
        conn.Open();
        cmd = new OleDbCommand(sqlQuery, conn);
        cmd.CommandText = "INSERT INTO tickets (ProblemIncidentDate, ProblemIncidentTime, user, StateTagNumber, ProblemType, ProblemDescription, ProblemStatus) VALUES (@ProblemDate,@ProblemTime,@userIDNumber,@StateTag,@ProblemType,@ProblemDescription,@ProblemStatus)";
        cmd.Parameters.Add("@ProblemDate", OleDbType.Date).Value = labelProblemDate.Text.Trim();
        cmd.Parameters.Add("@ProblemTime", OleDbType.DBTimeStamp).Value = labelProblemTime.Text.Trim();
        cmd.Parameters.Add("@userIDNumber", OleDbType.Integer).Value = Convert.ToInt32(userID.ToString());
        cmd.Parameters.Add("@StateTag", OleDbType.VarChar).Value = textBoxStateTagNumber.Text.Trim();
        cmd.Parameters.Add("@ProblemType", OleDbType.VarChar).Value = comboBoxProblemType.SelectedItem.ToString();
        cmd.Parameters.Add("@ProblemDescription", OleDbType.VarChar).Value = textBoxProblemDescription.Text.Trim();
        cmd.Parameters.Add("@ProblemStatus", OleDbType.VarChar).Value = "Open";            
        cmd.ExecuteNonQuery();          //At this line exception is generating 
        conn.Close(); 
```

我的数据库是 Microsoft Access 2007

以下是字段类型

```
ID                  AutoNumber
ProblemIncidentDate Date/Time
ProblemIncidentTime Date/Time
user                Number
StateTagNumber      Text
ProblemType         Text
ProblemDescription  Memo
ProblemResolution   Memo
ProblemStatus       Text 
```

我无法弄清楚为什么它会崩溃

控制台消息说

System.Data.dll 中出现“System.Data.OleDb.OleDbException”类型的第一次机会异常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:19:31.060

尝试使用正确的数据类型，例如

```
cmd.Parameters.Add("@ProblemDate", OleDbType.Date).Value = DateTime.Parse(labelProblemDate.Text.Trim());

cmd.Parameters.Add("@userIDNumber", OleDbType.Integer).Value = Convert.Int32(userID.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:31:29.730

从我的评论转换：

> 尝试在 [user] 周围加上括号，它可能是关键字。此外，您将字符串传递到 Integer 和 DateTime 字段中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:35:58.933

我与不同的 OleDb 提供者合作，发现有些不喜欢命名参数，而是使用“？” 作为参数的占位符。请注意，参数需要以与插入相同的顺序添加（就像您一样），所以尝试更改为..

```
insert into YourTable( fld1, fld2, fld3 ) values ( ?, ?, ? ) 
```

# iphone - 在 iPhone 5.1 (XCode 4.3.2) 上无法切换视图

> ID：10337333
> 
> 赞同：1
> 
> 时间：2012-04-26T16:15:26.977
> 
> 标签：iphone, ios, uiviewcontroller

我正在尝试开发一个使用 4 个视图（基于视图的应用程序）的 iPhone 应用程序，我想从一个视图导航到另一个视图。例如，如果提交 ID 按钮自动向 UIViewController 发送消息以切换到视图 2，并且在视图 2 中选择一个单元格将加载视图 3，那将是理想的选择。

在此处查看情节提要的屏幕截图[。](http://dl.dropbox.com/u/17432601/Screen%20Shot%202012-04-26%20at%2017.08.16.png)

我不知道该怎么做，所以我尝试使用单独的按钮在视图之间切换，但这也不起作用，我不知道为什么。

您可以查看[我上传到 Dropbox](http://dl.dropbox.com/u/17432601/Project%20C.zip)的源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:13:59.240

首先，我建议在您的问题中发布您的代码。尽管我确信其他人很感激您提供了代码的保管箱链接，但大多数人可能对将文件下载到他们的计算机、解压缩和启动项目（我就是其中之一）没有兴趣。

话虽如此，让我们确保您清楚故事板和一般视图控制器层次结构原则。在您的故事板中，您有四个 UIViewController 被拖到您的工作区中。因此，您不是在切换单个 UIViewController 的视图，而是告诉它从 View1 切换到 View2 再到 View3 等等。您需要告诉视图控制器层次结构（在您的情况下，可能需要由 UINavigationController 管理），将视图控制器推入和/或弹出其堆栈。看来您在视图控制器之间设置了一些 segues。你在调用`performSegueWithIdentifier:sender:`你的代码吗？或者，您可以连接 Submit ID 按钮，以几乎相同的方式对 View Controller 2 执行 push segue。

一旦你有这个工作，你可以覆盖`prepareForSegue:sender:`从 ViewController1 发送信息到 ViewController2 等等。

# css - 如何对齐右侧的 Facebook、Twitter、Google+ 和 LinkedIn 按钮？

> ID：10337334
> 
> 赞同：1
> 
> 时间：2012-04-26T16:15:35.800
> 
> 标签：css, wordpress, button, social

我有基于 WordPress 的互联网门户。有一个 Facebook Like 按钮（对齐 - 右），但是当我尝试在右侧集成其他按钮（Twitter、LinkedIn 和 Google+）时，它们会移到左侧。我不知道如何将它们全部对齐。对CSS没有太多了解，所以这就是我寻求帮助的原因。

**现在是这样的：**

[![](../Images/9d75c526a29af29fdac9f1061ba05dfa.png)](https://i.stack.imgur.com/dD2im.jpg)

**这就是我想要的样子：**

[![](../Images/23df31d4e00f16d4e7a6eebd97ae1252.png)](https://i.stack.imgur.com/AATMq.jpg)

**这是我的 single_post.php 代码：**

```
<?php the_content(); ?>
<div class="clear"></div>
<?php wp_reset_query(); ?>
<?php wp_link_pages('before=<p class="pagination">&after=</p>'); ?>
<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/lt_LT/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>  
<div class="fb-like" data-send="false" data-layout="box_count" data-width="700" data-show-faces="false" data-font="lucida grande"></div>    
<div class="clear"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T09:02:19.620

嘿，我认为你应该这样做

在您的社交图标中定义浮动属性并根据您的设计定义**边距填充宽度高度**

**CSS**

```
.social{
float:right;
    border:solid 1px green;
}
.fb, .twit, .share, .gplus{
float:left;
    width:100px;
    height:100px;
    overflow:hidden;
    border-left:solid 1px red;
} 
```

**HTML**

```
<div class="social">
    <div class="fb">FB</div>
    <div class="twit">TWIT</div>
    <div class="share">Share</div>
    <div class="gplus">Gp</div>
</div> 
```

现场演示[http://jsfiddle.net/3ELc5/](http://jsfiddle.net/3ELc5/)

# kml - Google 地球在我的透明 png 叠加层中添加了随机黑色矩形 - 如何在创建 png 或 kml 时避免这种情况？

> ID：10337338
> 
> 赞同：1
> 
> 时间：2012-04-26T16:15:44.247
> 
> 标签：kml, google-earth

在图像查看器中查看 PNG，这是正常的。在 Google 地球中将 PNG 视为叠加层，在图像的透明区域附近添加随机黑色矩形。如何在 PNG 生成或 KML 中避免这种情况？PNG 是 BufferedImage.TYPE_4BYTE_ABGR

# string - 使用 VBA Print 语句写入文件 - 没有空格分隔符

> ID：10337344
> 
> 赞同：3
> 
> 时间：2012-04-26T16:15:58.407
> 
> 标签：string, ms-access, vba

在使用 MS Access 制作与 QuickBooks IIF 一起使用的文件时，我需要一个制表符分隔的文件，标识符之间没有空格。我打开了这个输出文件，所有文件都进入了文件，但字符串的两边都有**空格。**下面是我开始的：

```
Print #1, "!TRNS", vbTab, "TRNSID", vbTab, "TRNSTYPE", vbTab, "DATE" 'etc... 
```

我将其修改为：

```
Print #1, "!TRNS", vbTab, Trim(strTRNSID), vbTab, Trim("TRNSTYPE"), vbTab, "DATE" 'etc... 
```

使用修剪功能的输出文件文件中的空格不会被消除；所以我的意思是用制表符发送的字符串在字符串的两侧仍然有空格。

我如何摆脱这些空间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:36:48.230

在将字符串传递给 Print 命令之前连接字符串怎么样？

```
Print #1, "!TRNS" & vbTab & Trim(strTRNSID) & vbTab & Trim("TRNSTYPE") & vbTab & "DATE" 
```

您需要确保每个项目都转换为字符串，否则我认为应该没问题

# iphone - iPhone cocos2d“预期的说明符-限定符-列表之前...”等

> ID：10337356
> 
> 赞同：0
> 
> 时间：2012-04-26T16:16:46.743
> 
> 标签：iphone, ios, cocos2d-iphone, compiler-errors

我正在使用 cocos2d 框架开发 iPhone 游戏，最近遇到了一个我似乎无法解决的问题。在我的项目中添加了一个新类并在其中做了一些工作之后，我尝试编译我的代码，而我什至没有接触过的几个类都坏了。似乎这些类只是忘记了如何导入外部类。我在我的几个课程中都遇到了错误，但这里有一个例子：

```
#import "cocos2d.h"
#import "XZombie.h"
#import "WayPoint.h"
#import "XBuilding.h"

//@class XBuilding;

@interface Hoarde : CCNode
{
    float _spawnRate;
    int _totalXombies;
    NSMutableArray *_path;
    XBuilding *_target;
    NSMutableArray *_zombies;
    bool _zombiesReset;
}

@property (nonatomic) float spawnRate;
@property (nonatomic) int totalXombies;
@property (nonatomic, retain) NSMutableArray *path;
@property (nonatomic, retain) XBuilding *target;
@property (nonatomic, retain) NSMutableArray *zombies;
@property (nonatomic, assign) bool zombiesReset;

- (id) initWithZombieCount:(int)totalXombies Target:(XBuilding *) target SpawnRate:(float)spawnrate;
- (void) resetZombies;

@end 
```

我在“`XBuilding *_target;`
如果我取消注释”的行上得到错误`@class XBuilding;`，错误就会消失，所以虽然这并不能真正解决我的问题，但它给了我一个解决它的工具。

* * *

如果我`@class`对所有我遇到问题的文件都做了这个技巧，我可以解决这个问题。问题是，除了说明符限定符列表错误之外，我还遇到了一个新的但类似的错误。一些代码行给了我`Expected a ')' before *token`或`Expected a ';' before *token`. 这些行通常也会给我前面的错误，所以@class 技巧也很有效，但我一点也不知道为什么这些东西正在做它正在做的事情。我在某处（我认为是 cocos2d 论坛）读到将 .m 文件重命名为 .mm 可能会奏效，但对我来说不是。

所以，虽然我可以继续我的项目，但我真的很想知道将来如何避免类似的事情发生……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T01:52:44.820

请检查是否存在循环依赖，例如导入`ClassB.h`，`ClassA.h`反之亦然。这是发生“预期的说明符限定符列表之前...”错误的典型场景。

我建议只`@class`在你的头文件中使用，除了：

*   `#import`超类
*   `#import`你的类实现的协议

头文件应该`#import`在你的实现文件中编辑。

[“Objective-C 编程语言”](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocDefiningClasses.html)说：

> 该`@class`指令最大限度地减少了编译器和链接器看到的代码量，因此是给出类名前向声明的最简单方法。简单来说，它避免了在导入文件时可能会出现的潜在问题，而这些文件又会导入其他文件。例如，如果一个类声明了另一个类的静态类型实例变量，并且它们的两个接口文件相互导入，则任何一个类都无法正确编译。

更多参考：

*   [@class 与 #import](https://stackoverflow.com/questions/322597/class-vs-import)
*   [http://www.iphonedevsdk.com/forum/iphone-sdk-development/54417-expected-specifier-qualifier-list-before-xxxappdelegate-error.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/54417-expected-specifier-qualifier-list-before-xxxappdelegate-error.html)

# java - Hibernate：我如何加入一个表？

> ID：10337357
> 
> 赞同：2
> 
> 时间：2012-04-26T16:16:48.240
> 
> 标签：java, hibernate, criteria

我在加入表格时遇到问题。实际上，我真的迷失了如何去做。我有这个 Hibernate 表映射。

```
<class name="Technology" table="TECHNOLOGIES">
    <id name="technoId">
        <column name="techno_id" />
        <generator class="identity" />
    </id>        
    <property name="description" type="java.lang.String">
        <column name="description" />
    </property>
    <many-to-one name="parent" class="Technology" />
</class> 
```

列 parent 与同一个表相关。一个表格的例子，这样你就可以理解我了。

techno_id | 描述 | 父母

1------------“Java”----------空

2------------“休眠”-----1

3------------“HQL”------------2

4------------“.NET”----------空

5------------“NHibernate”----4

那基本上是表格的一个例子，它没有真实的数据，它只是一个例子。我想要做的是，在一个接收 techno_id 的方法中，使用 Criteria 或 HQL 运行，这也会给我带来一个带有孩子 ID 的结果列表。例如，如果我向方法发送“1”techno_id，它应该给我带来一个 ID 为“1、2、3”的列表。我希望我尽可能清楚，你可以帮助我。谢谢，对不起我的英语jaja。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T04:38:54.893

有两种方法可以做到这一点。

1.  按标准：

    ```
    1\. For specific level fetching : e.g 3 level fetching(As per your example)
    public Technology getAllChildrenTechnology(long parentID){
     Crtieria criteria = session.createCriteria(Technology.class);
     criteria.add(Restriction.eq("id",parentID));
     criteria.setFetchMode("parent",FetchMode.JOIN);
     criteria.setFetchMode("parent.parent",FetchMode.JOIN);
     criteria.setResultTransformer(criteria.DISTINCT_ROOT_PROPERTY);
     Technology techno = (Technology)criteria.uniqueResult();
     return techno;
    }

    2\. For N level Fetching : You need to create n level for loop.(Recursive loop using above). 
    ```

2.  通过懒惰：

    hibernate 中有一个特性允许我们在不使用条件的情况下获取一些连接。

    ```
    <many-to-one name="parent" class="Technology"  lazy="false"/> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T08:28:21.857

我相信这个问题并不是 Hibernate 特有的。即使您正在编写 SQL，也没有简单的方法来获取一个节点及其所有后代，而无需在设计中进行特殊处理。

最简单的方法是让每个技术包含子技术列表（双向关系）。然后递归遍历 Technology 的孩子。

如果您需要从持久性存储中快速检索，则必须在设计中满足这一要求。一种方法是在我之前为类似问题写的答案中描述的。[https://stackoverflow.com/a/7524077/395202](https://stackoverflow.com/a/7524077/395202) 这种方法对 Hibernate 并不友好（它仍然有效，只是需要特别注意）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:27:50.830

您需要使用带有反向的连接标签

```
<join table ="Technologies" inverse ="true" optional = "false">
  <key column = "techno_id"/>
  <many-to-one name="parent" class="Technology" />
</join> 
```

# mysql - 我找不到mysql提示符

> ID：10337358
> 
> 赞同：1
> 
> 时间：2012-04-26T16:16:50.127
> 
> 标签：mysql, scripting

我知道这是一个愚蠢的问题，但我只是找不到可以在我的 cPanel 上运行 MySQL 脚本的地方。像这样的脚本：

```
># mysql -u root –p mysql 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:18:54.923

您需要使用 Secure SHell (SSH) 之类的工具登录服务器。

看看你的 cpanel 是否有 shell 选项。

如果是 mac/linux，您可能可以从本地机器的 shell 中使用 ssh：

```
ssh [yourFTPuser]@[yourwebsitedomain] 
```

如果您使用的是 Windows，请尝试使用 SSH 程序，例如 putty。

# php - 为单个站点使用自定义 PHP.INI。Windows 2003、64 位、IIS7.5、PHP 5.3.6

> ID：10337359
> 
> 赞同：3
> 
> 时间：2012-04-26T16:16:53.200
> 
> 标签：php, iis-7.5, windows-server-2003

我在单个站点上有一个 PHP 脚本，需要我将上传大小的最大值设置得相当高。我不希望在全球范围内这样做。

根据 PHP 文档，我无法设置某些变量的值，例如`post_max_size`，`max_file_uploads`或`upload_max_filesize`使用`ini_set`. 我在这里看到了许多在 UNIX 机器上运行 PHP 或在运行 Apache 的 Windows 上运行的解决方案，但没有一个使用 IIS 对我来说很清楚。

我的理解是，有一种方法可以让我拥有一个自定义 php.ini 文件来覆盖特定的 php.ini 值。

理想情况下，我希望在文件夹中有一个 php.ini 文件，其中包含一个看起来像这样的脚本：

```
[PHP]
post_max_size = 200M
max_file_uploads = 5
upload_max_filesize = 200M 
```

如果不在我的服务器上全局设置值，我如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T22:09:36.347

您可以使用 PHPRC 环境变量为每个网站设置单独的 ini 文件，如[http://php.net/manual/en/configuration.file.php](http://php.net/manual/en/configuration.file.php)所述。

这是一篇关于如何为 IIS 6 和 7 设置它的文章。

[http://learn.iis.net/page.aspx/745/enable-per-site-php-configuration-on-iis-60-and-iis-7-and-above/](http://learn.iis.net/page.aspx/745/enable-per-site-php-configuration-on-iis-60-and-iis-7-and-above/)

希望这可以帮助

# javascript - 如何在没有 AJAX 的情况下向 CouchDB 提交数据（使用普通表单 PUT）

> ID：10337361
> 
> 赞同：1
> 
> 时间：2012-04-26T16:17:08.787
> 
> 标签：javascript, forms, couchdb

我想知道如何在不使用 AJAX 的情况下向 CouchDB 提交数据。AJAX 很棒，但仍然有一些人关闭了 JavaScript，以及其他各种不完全依赖 JavaScript 的原因。

我想知道如何通过普通的 HTML 表单提交（POST 请求）向 CouchDB 提交数据。我在 action 属性中放了什么？我应该期待我的数据会发生什么？

我尝试自己对此进行测试，但收效甚微。我也搜索了指南和维基，但无济于事。如果已经有一篇文章会摇滚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T13:19:04.747

看看[更新处理程序](http://wiki.apache.org/couchdb/Document_Update_Handlers)。

# javascript - 'this' 在下面的 javascript 中代表什么？

> ID：10337368
> 
> 赞同：3
> 
> 时间：2012-04-26T16:17:50.187
> 
> 标签：javascript, call, this

（对不起，`this`javascript中的另一个问题。）

我有下面的代码，我想知道最后调用中的“this”代表什么——窗口还是鸟？

```
var Bird = (function () {
    Bird.name = 'Bird';

    function Bird(name) {
        this.name = name;
    }

    Bird.prototype.move = function (feet) {
        return alert(this.name + (" flew" + feet + "ft."));
    };

    return Bird;

}).call(this); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T16:20:12.560

好吧，假设没有父范围，它是`window`

编辑：参见示例：http: [//jsfiddle.net/Umseu/1](http://jsfiddle.net/Umseu/1)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T16:20:01.123

可能`window`，因为它不在任何特定的上下文中赋予`this`任何特殊含义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T16:20:13.643

窗户。`.call(this)`没有写在鸟里面。它只是调用一个碰巧返回“Bird”“构造函数”的匿名函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T16:22:37.433

`console.log(this)`在匿名函数的第一行调用。即返回范围，`window`.

# tridion - GUI 扩展 - 资源无法加载

> ID：10337370
> 
> 赞同：7
> 
> 时间：2012-04-26T16:18:03.433
> 
> 标签：tridion

我对我到底做错了什么有点不知所措，所以希望通过把它扔在那里，有人应该能够指出一些对我来说很明显的东西。

正在创建一个新的 GUI 扩展，它将作为按钮位于 Tridion 功能区栏的新事件选项卡上。我可以让按钮出现，但是按钮没有出现图标并且总是被禁用，这让我相信扩展的样式表和 javascript 资源没有加载：S

我的编辑器配置如下：

```
<?xml version="1.0"?>
<Configuration xmlns="http://www.sdltridion.com/2009/GUI/Configuration/Merge" xmlns:cfg="http://www.sdltridion.com/2009/GUI/Configuration" xmlns:ext="http://www.sdltridion.com/2009/GUI/extensions" xmlns:cmenu="http://www.sdltridion.com/2009/GUI/extensions/ContextMenu">

<resources>
<cfg:filters/>
<cfg:groups>      
  <cfg:group name="Events.Cvent">
    <cfg:fileset>
      <cfg:file type="style">/Theme/cvent.css</cfg:file>
      <cfg:file type="reference">Events.Commands.Cvent</cfg:file>
    </cfg:fileset>
  </cfg:group>
  <cfg:group name="Events.Cvent.Commandset">
    <cfg:fileset>
      <cfg:file type="script">/Scripts/cvent.js</cfg:file>
    </cfg:fileset>
    <cfg:dependencies>
      <cfg:dependency>Tridion.Web.UI.Editors.CME</cfg:dependency>
      <cfg:dependency>Tridion.Web.UI.Editors.CME.commands</cfg:dependency>
    </cfg:dependencies>
  </cfg:group>
</cfg:groups>
  </resources>
<definitionfiles/>
<extensions>
<ext:dataextenders/>
<ext:editorextensions>
  <ext:editorextension target="CME">
    <ext:editurls/>
    <ext:listdefinitions/>
    <ext:taskbars/>
    <ext:commands/>
    <ext:commandextensions/>
    <ext:contextmenus/>        
    <ext:lists/>
    <ext:tabpages/>
    <ext:toolbars/>
    <ext:ribbontoolbars>
      <ext:add>
        <ext:extension assignid="EventsPage" name="Events">
          <ext:control/>
          <ext:pagetype/>
          <ext:apply>
            <ext:view name="DashboardView">
              <ext:control id="DashboardToolbar"/>
            </ext:view>
          </ext:apply>
        </ext:extension>
        <ext:extension assignid="EventsAdministrationGroup" pageid="EventsPage" name="Administration">
          <ext:group/>
          <ext:apply>
            <ext:view name="DashboardView">
              <ext:control id="DashboardToolbar"/>
            </ext:view>
          </ext:apply>
        </ext:extension>
        <ext:extension assignid="CventBtn" groupid="EventsAdministrationGroup" name="Import Cvent Events" pageid="EventsPage">
          <ext:command>Cvent</ext:command>
          <ext:title>Import Cvent Events</ext:title>
          <ext:dependencies>
            <cfg:dependency>Events.Cvent</cfg:dependency>               
          </ext:dependencies>
          <ext:apply>
            <ext:view name="DashboardView">
              <ext:control id="DashboardToolbar"/>
            </ext:view>
          </ext:apply>
        </ext:extension>
      </ext:add>
    </ext:ribbontoolbars>
  </ext:editorextension>
</ext:editorextensions>
<ext:modelextensions/>
</extensions>

 <commands>    
    <cfg:commandset id="Events.Commands.Cvent">
  <cfg:command name="Cvent" implementation="Events.Commands.OpenCvent"/>
  <cfg:dependencies>
    <cfg:dependency>Events.Cvent.Commandset</cfg:dependency>        
  </cfg:dependencies>
</cfg:commandset>
  </commands>
  <contextmenus/>
  <localization/>

  <settings>
    <defaultpage/>
    <editurls/>
    <listdefinitions/>
    <theme>
      <path>/Theme/</path>
    </theme>
    <customconfiguration>
      <clientconfiguration xmlns="http://www.sdltridion.com/2009/GUI/Configuration/Merge">
        <Cventurl xmlns="http://www.sdltridion.com/2009/GUI/Configuration/Merge">/Cvent/Cvent.aspx</Cventurl>
      </clientconfiguration>
    </customconfiguration>
  </settings>

</Configuration> 
```

根据配置，我需要的所有资源文件（javascript 和 css）都在目录中。我的 GUI JS 如下所示：

```
Type.registerNamespace("Events.Commands");

Events.Commands.OpenCvent = function Commands$OpenCvent(name)
{
    Type.enableInterface(this, "Events.Commands.OpenCvent");
    this.addInterface("Tridion.Cme.Command", ["Cvent"]);
    this.properties.url;
};

Events.Commands.OpenCvent.prototype._isAvailable = function OpenCvent$_isAvailable(selection, pipeline) 
{
    return true;
};

Events.Commands.OpenCvent.prototype._isEnabled = function OpenCvent$_isEnabled(selection, pipeline) 
{
    return true;
};

Events.Commands.OpenCvent.prototype._execute = function OpenCvent$_execute(selection, pipeline) 
{   
    window.open('www.google.com');  
}; 
```

重新启动 Tridion 仍然没有，我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T11:23:34.380

您可以通过使用 ?mode=js 和 ?mode=css 参数加载 CME 来检查您的文件是否包含在内。

不要忘记这些文件被大量缓存 - 只是更改配置不会使缓存无效。您需要增加 System.config 中的 @modification 属性（以使所有客户端的缓存无效） - 或者只需手动清除浏览器缓存（开发时最容易）。

如果您的更改不在这些文件中，则可能是您的编辑器配置有问题。正如 Chris 所指出的，只有在包含依赖于文件的其他内容时才会包含文件。如果启用跟踪，您可以看到为什么您的文件未包含在生成的日志文件 (Tridion.Web.trace) 中。

查看本文的第 6 节，了解有关如何执行此操作的更多信息：[http ://www.sdltridionworld.com/articles/sdltridion2011/tutorials/debugging_the_tridion_2011_cme.aspx](http://www.sdltridionworld.com/articles/sdltridion2011/tutorials/debugging_the_tridion_2011_cme.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T17:17:14.483

我不能告诉你你的扩展到底有什么问题，但也许你可以看看现有的 GUI 扩展（实际上是几个扩展），也许你可以比较你的问题。看看 PowerTools [http://code.google.com/p/tridion-2011-power-tools/](http://code.google.com/p/tridion-2011-power-tools/)

还有一些关于[http://www.sdltridionworld.com](http://www.sdltridionworld.com)的好例子，例如[http://www.sdltridionworld.com/articles/sdltridion2011/tutorials/GUIextensionIn8steps.aspx](http://www.sdltridionworld.com/articles/sdltridion2011/tutorials/GUIextensionIn8steps.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T18:41:17.420

我相信除非在配置的命令集节点中使用和引用它们，否则依赖项实际上不会被加载。您能否包含完整的 editor.config 而不仅仅是摘录？

# objective-c - 从Objective-C中的XML id号返回NSMutableArray的计数？

> ID：10337374
> 
> 赞同：0
> 
> 时间：2012-04-26T16:18:31.777
> 
> 标签：objective-c, xml, arrays, count, nsmutablearray

我正在从 XML 文件中构建一个 NSMutableArray，并且需要返回 XML 文件中每个常驻 id 的计数。是否有可能做到这一点？

```
<residents>
<resident id="1">
    <name>
        <first>Daffy</first>
        <last>Duck</last>
    </name>
</resident>

<resident id="2">
    <name>
        <first>Mickey</first>
        <last>Mouse</last>
    </name>
</resident> 
```

ETC...

我将使用与此类似的代码返回计数：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
NSLog(@"Count = %i", [appDelegate.residents count]);
return [appDelegate.residents count]; 
```

有什么建议么？

对于数组，在我的 AppDelegate.h 中我有：

```
 @interface AppDelegate : UIResponder <UIApplicationDelegate>
{
    UIWindow *window;
    UINavigationController *navigationController;

    NSMutableArray *residents; 
}

@property (strong, nonatomic) UIWindow *window;
@property (nonatomic, retain) IBOutlet UINavigationController *navigationController;
@property (nonatomic, retain) NSMutableArray *residents; 
```

在 XMLAppDelegate.h 我使用：

```
 @interface XMLAppDelegate : NSObject <UIApplicationDelegate> {

    UIWindow *window;
    UINavigationController *navigationController;

    NSMutableArray *residents;
}

@property (nonatomic, retain) IBOutlet UIWindow *window;
@property (nonatomic, retain) IBOutlet UINavigationController *navigationController;
@property (nonatomic, retain) NSMutableArray *residents;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:09:14.017

据我了解，您只需要 . 如果是这样，您可以执行以下操作。

```
NSData *data = // your XML Data either from webservice or local file. Not xml string but the Data.
NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
[parser setDelegate:self];
[parser parse]; 
```

此代码将是您获取数据的地方。在您的 .h 文件中：

```
@interface yourViewController : UIViewController {
     NSInteger resedintsCount;
} 
```

在您的 .m 文件中：

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{ 
      if([elementName isEqualsToString:@"resident"]) {
           resedintsCount++;
      }
}

- (void)parserDidEndDocument:(NSXMLParser *)parser {
     // you can use resedintsCount 
} 
```

我假设您正在视图控制器中获取 XML 数据。如果您在 AppDelegate 或任何其他类中获得它，那么即使是相同的过程也会在那里。不过，如果您有任何困惑，请随时提问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T20:24:02.253

您需要使用 NSXMLParser（和 NSXMLParserDelegate 分别）并将 XML 数据正确解析到 NSMutableArray 中，然后才能计算任何内容。此外，为了存储日常人的 XML 数据，您可能希望将信息放入 NSMutableDictionaries。

在 .h @interface 中，您需要创建 IVAR（仅示例）：

```
 @interface YourObject : UIViewController <NSXMLParserDelegate> {
   NSXMLParser *parser;
   NSString *currentElement;
   NSMutableString *firstName;
   NSMutableString *lastName;
   NSMutableArray *residents;
 } 
```

在 .m 代码的某处，调用它：

```
 NSString *xmlLocationString = @"http://www.website.com/feed.xml";
   NSURL *xmlLocationURL = [NSURL URLWithString:xmlLocationString];
   parser = [[NSXMLParser alloc] initWithContentsOfURL:xmlLocationURL];
   [parser setDelegate:self];
   [parser setShouldProcessNamespaces:NO];
   [parser setShouldReportNamespacePrefixes:NO];
   [parser setShouldResolveExternalEntities:NO];
   [parser parse]; 
```

当然，设置代理方法，它将实际将 XML 文档解析到 NSMutableArray 中：

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{    

  currentElement = nil;
  currentElement = [elementName copy];
  if ([elementName isEqualToString:@"day"]) {
    firstName = [[NSMutableString alloc]init];
    lastName = [[NSMutableString alloc]init];
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

   string = [string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];
   string = [string stringByTrimmingCharactersInSet:[NSCharacterSet controlCharacterSet]];

   if ([currentElement isEqualToString:@"first"]) {
    [firstName appendString:string];
   } else if ([currentElement isEqualToString:@"last"]) {
    [lastName appendString:string];
   } else {
     ...
   }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{   
      if ([elementName isEqualToString:@"day"]) {
        NSMutableDictionary *dictionary = [[NSMutableDictionary alloc] init];
        [dictionary setObject:firstName forKey:@"fname"];
        [dictionary setObject:lastName forKey:@"lname"];
        //And finally
        [residents addObject:dictionary];
      }
} 
```

然后，您可以在代码中的任何位置调用

```
[residents count]; 
```

得到居民的总数。

***注意：我只是边走边写这段代码，它可能有一些错误***

# javascript - 如何将 svg 图像附加到另一个 svg 图像的 rect 元素？

> ID：10337375
> 
> 赞同：1
> 
> 时间：2012-04-26T16:18:35.930
> 
> 标签：javascript, svg, d3.js

我尝试`rect`使用 d3 将 svg 图像附加到 svg 图像中的元素并尝试

```
chart.selectAll("rect.bar")
  .each(function(datum, index) {
    d3.select(this)
      .append("svg:image")
        // ..some attributes
  }); 
```

这增加`<image>`了 dom，但图像不显示。我也尝试使用 jquery`this`在`.each`块中进行选择，将其添加到 dom 中，但也没有显示。

对于 jquery，我添加了它

```
$(this).after("<svg:image xlink:href='/images/image.svg' x='20' y='20' width='20' height='20'/>"); 
```

在元素中使用`svg`and`xlink`命名空间`html`

```
<html lang="en" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
```

我已经能够创建一个图像，但我想根据价值创建更多`rect.bar`图像。`.selectAll``datum`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:06:07.347

我需要使用 jquery 来选择父元素，以便图像不会放在*元素内*，而是放在它`rect.bar`旁边。代码在这里：

```
chart.selectAll("rect.bar")
  .each(function(datum, index) {
    var rectBar = $(this).parent()[0]; // Needs parent object, otherwise it will append inside rect
    var num = 4;

    for (var i = 0; i < num; i++) {
      d3.select(rectBar)
        .append("svg:image")
          // ...some attributes
    }
  }); 
```

本身也`.parent()`不起作用。我需要明确地做`.parent()[0]`. 不知道为什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:26:25.247

我不知道这对你是否重要，但我相信你可以在不使用 jquery 的情况下做到这一点。Mike Bostock 的“ [D3 Workshop](http://bost.ocks.org/mike/d3/workshop/) ”演示文稿展示了如何在 DOM 中正确选择和附加元素。

一旦您可以选择任何元素，您就可以附加任何 SVG 绘图（例如，矩形、圆形、文本等，甚至是外部图像）。要控制附加图像的位置，我相信您可以简单地使用“dx”和“dy”坐标偏移控制器。

在示例“[混合常见 HTML 布局结构的多个 D3 饼图](http://bl.ocks.org/2141479)”中，我首先根据 HTML 页面上的 HTML DIV 位置创建多个 SVG 画布。然后，我将条形图放置在 SVG 画布上的特定位置。然后我将图例项目符号附加并放置在同一个 SVG 画布上的不同点。最后，我将图例文本附加并放置在同一 SVG 画布的不同位置。在每种情况下，我都使用 dx 和 dy 坐标控制器来控制对象的放置。

我希望这有帮助，

坦率

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:27:11.307

像这样试试。

```
chart.selectAll("rect.bar")
  .each(function(datum, index) {
    $(this).append("<img href='http://www.mysite.com/images/test.jpg' />")
        // ..some attributes
  }); 
```

# tomcat - 如何使 Tomcat 读取允许来自与 server.xml 不同位置的 IP

> ID：10337377
> 
> 赞同：0
> 
> 时间：2012-04-26T16:18:42.203
> 
> 标签：tomcat, tomcat7, server.xml

我希望普通用户能够将允许的 IP 地址添加到 Tomcat 防火墙，而无需手动编辑 server.xml 文件（所以我不必这样做）。有没有办法做到这一点（不重新生成 server.xml 文件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T21:01:03.400

没有理想的方法来做到这一点。

动态编辑此列表的唯一方法是通过 JMX。您可以编写一个 servlet（适当保护）来执行此操作，或者提供完整的 JMX 访问权限（相当于完全的管理员访问权限）并使用 JConsole 或类似的。缺点是更改无法持久化。

# c# - 尝试使用 c# 和 Ionic.dll 将两个 zip 文件合并为 1

> ID：10337383
> 
> 赞同：0
> 
> 时间：2012-04-26T16:18:58.107
> 
> 标签：c#, dotnetzip

这是代码

```
ZipFile zipnew = ZipFile.Read(strPath);
if (!File.Exists(path))
{
    using (ZipFile zip = new ZipFile())
    {
        zip.Save(path);
    }
}
    string tmpname = fpath + "\\abtemp";
    ZipFile zipold = ZipFile.Read(path);
    foreach (ZipEntry zenew in zipnew)
    {
        string flna = zenew.FileName.ToString();
        string tfn = '@' + flna.Replace("\\", "/");
        Stream fstream = File.Open(tmpname, FileMode.OpenOrCreate, FileAccess.Write);
        zenew.Extract(fstream);
        string l = fstream.Length.ToString();
        fstream.Close();

        using (StreamReader sr = new StreamReader(tmpname))
        {
            var zn = zipold.UpdateEntry(flna, sr.BaseStream);
            sr.Close();
            sr.Dispose();
            fstream.Dispose();
        }
    }

    zipnew.Dispose();
    File.Delete(tmpname);
    File.Delete(strPath); 
```

问题是：我没有收到任何错误，也没有文件从 zipnew 合并到 zipold。Zipold 是一个空白的 zip 文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T13:40:08.143

你的代码对我来说不是 100% 清楚，变量 tfn 似乎没有被使用，我并没有完全关注所有的处置/删除。
但从好的方面来说，我确实让您的代码正常工作，主要问题是您没有调用 zipold 的保存方法。

```
 string path = "d:\\zipold.zip";
    ZipFile zipnew = ZipFile.Read("d:\\zipnew.zip");
    if (!File.Exists(path))
    {
        using (ZipFile zip = new ZipFile())
        {
            zip.Save(path);
        }
    }
    string tmpname = "d:" + "\\temp.dat";
    ZipFile zipold = ZipFile.Read(path);
    foreach (ZipEntry zenew in zipnew)
    {
        string flna = zenew.FileName.ToString();
        //string tfn = '\\' + flna.Replace("\\", "/"); useless line
        Stream fstream = File.Open(tmpname, FileMode.OpenOrCreate, FileAccess.Write);
        zenew.Extract(fstream);
        string l = fstream.Length.ToString();
        fstream.Close();
        using (StreamReader sr = new StreamReader(tmpname))
        {
            var zn = zipold.UpdateEntry(flna, sr.BaseStream);
            zipold.Save();
            sr.Close();
            sr.Dispose();
            fstream.Dispose();
        }

    }
    zipnew.Dispose(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-29T12:53:42.157

```
 static void Main(string[] args)
    {
        try
        {
            using (ZipFile zip1 = new ZipFile())
            {
                zip1.AddFile(@"SCAN0002.PDF");
                zip1.AddFile(@"SCAN0003.PDF");
                zip1.Save("SCAN0002.ZIP");
            }

            using (ZipFile zip2 = new ZipFile())
            {
                zip2.AddFile(@"SCAN0004.PDF");
                zip2.AddFile(@"SCAN0005.PDF");
                zip2.AddFile(@"SCAN0006.PDF");
                zip2.Save("SCAN0003.ZIP");
            }

            ZipFile z3 = new ZipFile().Read2(File.ReadAllBytes("SCAN0002.ZIP"));
            ZipFile z4 = new ZipFile().Read2(File.ReadAllBytes("SCAN0003.ZIP"));
            using (ZipFile zip3 = new ZipFile())
            {
                zip3.Marge(z3).Marge(z4);
                zip3.Save("SCAN0004.ZIP");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    } 
```

并扩展类

```
public static class ZipFileExt
{
    public static ZipFile Read2(this ZipFile item, byte[] data)
    {
        return ZipFile.Read(new MemoryStream(data));
    }
    public static ZipFile Marge(this ZipFile item, ZipFile file)
    {
        foreach (var entry in file)
            item.AddEntry(entry.FileName, entry.Extract2Byte());
        return item;
    }
    public static byte[] Extract2Byte(this ZipEntry entry)
    {
        using (var ms = new MemoryStream())
        {
            entry.Extract(ms);
            return ms.ToArray();
        }
    }
} 
```

\P/

[http://www.youtube.com/watch?v=Y7dRBmMsevk&list=RD02xcFzsvnMmXY](http://www.youtube.com/watch?v=Y7dRBmMsevk&list=RD02xcFzsvnMmXY)

# php - ADODB PHP MS-SQL SERVER SAVE() 问题

> ID：10337390
> 
> 赞同：1
> 
> 时间：2012-04-26T16:19:27.187
> 
> 标签：php, sql-server, adodb

经过大量研究，我可以连接 ADOBD mssql y free tds，但现在我遇到了另一个问题，我尝试使用 Active record ，插入指令但我做不到，ado 没有给我发送任何错误.. . 这是我的脚本：

```
include('adodb/adodb.inc.php');
include('adodb/adodb-active-record.inc.php');

$db = ADONewConnection('mssql'); # eg 'mysql' or 'postgres'
$db->Connect('*********', "*********", '**********', "**********");
ADOdb_Active_Record::SetDatabaseAdapter($db);
ADODB_Active_Record::$_changeNames = FALSE;
$db->debug = true;
#the following example use a table that was created with this statement
$rs = $db->Execute("select top 3 * from banks order by 1 desc");
print "<pre>";
print_r($rs->GetRows());
print "</pre>";
#create an empty class to work with our new table
class banks extends ADOdb_Active_Record {}  $banks2 = new banks();
$banks2->desc_bank = 'Banco '.date("H:i:s d/m/Y");
$banks2->save(); // this save() will fail on INSERT as favorite_color is a must fill...

echo "<br/> Guarde: el id = '$banks2->id_bank - $banks2->desc_bank ".date("H:i:s d/m/Y")."'";
$ok = $banks2->Save();

if (!$ok) $err = $banks2->ErrorMsg();
echo "<br> Error= $err";
unset($banks);
// $rs = $db->Execute("insert into banks values('".'Banco '.date("H:i:s d/m/Y")."')");
$rs = $db->Execute("select top 3 *  from banks order by 1 desc");
print "<pre>";
    print_r($rs->GetRows());
print "</pre>";
echo "<br/> Acabe: ".date("H:i:s d/m/Y"); 
```

如果我取消注释它所做的正常插入，但这不是活动记录

```
This is the response:

> (mssql): select top 3 * from banks order by 1 desc  

Array
(
    [0] => Array
        (
            [0] => 26
            [1] => Banco 10:54:29 26/04/2012     
        )

    [1] => Array
        (
            [0] => 25
            [1] => Banco 10:54:18 26/04/2012     
        )

    [2] => Array
        (
            [0] => 23
            [1] => BANSEFI 2                     
        )

)

(mssql): select c.name,t.name,c.length,c.isnullable, c.status, (case when c.xusertype=61 then 0 else c.xprec end), (case when c.xusertype=61 then 0 else c.xscale end) from syscolumns c join systypes t on t.xusertype=c.xusertype join sysobjects o on o.id=c.id where o.name='banks'   (mssql): select distinct k.column_name,ordinal_position from information_schema.key_column_usage k, information_schema.table_constraints tc where tc.constraint_name = k.constraint_name and tc.constraint_type = 'PRIMARY KEY' and k.table_name = 'banks' and k.table_catalog like 'tss_dev%' order by ordinal_position   (mssql): INSERT INTO banks(id_bank,desc_bank) VALUES (?,?)   [ (0=>null) (1=>'Banco 11:05:42 26/04/2012') ] sp_executesql N'INSERT INTO banks(id_bank,desc_bank) VALUES (@P0,@P1); select SCOPE_IDENTITY()',N'@P0 CHAR, @P1 NVARCHAR(25)',@P0=NULL, @P1=N'Banco 11:05:42 26/04/2012'
(mssql): select SCOPE_IDENTITY()   (mssql): select max(id_bank) from banks  
Guarde: el id = '26 - Banco 11:05:42 26/04/2012 11:05:42 26/04/2012'
Error= (mssql): select top 3 * from banks order by 1 desc  

Array
(
    [0] => Array
        (
            [0] => 26
            [1] => Banco 10:54:29 26/04/2012     
        )

    [1] => Array
        (
            [0] => 25
            [1] => Banco 10:54:18 26/04/2012     
        )

    [2] => Array
        (
            [0] => 23
            [1] => BANSEFI 2                     
        )

)

Acabe: 11:05:42 26/04/2012 
```

这是表银行

```
 USE [tss_dev]
GO

/****** Object:  Table [dbo].[banks]    Script Date: 26/04/2012 11:17:08 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[banks](
    [id_bank] [smallint] IDENTITY(22,1) NOT NULL,
    [desc_bank] [char](30) NOT NULL,
 CONSTRAINT [PK_banks_id_bank] PRIMARY KEY CLUSTERED 
(
    [id_bank] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

EXEC sys.sp_addextendedproperty @name=N'MS_SSMA_SOURCE', @value=N'tss_sales_demo.banks' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'banks'
GO 
```

谢谢你的帮助伙计们..!!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T11:42:11.900

我使用这个覆盖类，使用 adodb 活动记录修复 MSSQL 保存方法

```
class MSSQL_Active_Record extends ADOdb_Active_Record {
    // The fix for default save method which is error in MSSQL
    function Save($pk = 'id')
    {
        $db = $this->DB();
        $db->Execute("SET IDENTITY_INSERT {$this->_table} ON");

        $this->$pk  = $this->LastInsertID($db, $pk) + 1;
        parent::Save();

        $db->Execute("SET IDENTITY_INSERT {$this->_table} OFF");
    }
} 
```

# database - 如何在joomla中显示数据库数据

> ID：10337392
> 
> 赞同：1
> 
> 时间：2012-04-26T16:19:36.733
> 
> 标签：database, joomla

我是 joomlah 的新手。到目前为止，我已经完成了以下内容：
1\. 我已经将它安装在 wamp 服务器上。
2\. 我创建了几篇文章。
3\. 我在带有 wamp 的数据库上创建了另一个模式。

现在，我需要做两件事，我想知道最佳实践是什么
1\. 创建一个以某种格式显示数据的模板文章
2\. 从数据库加载数据。

由于这个问题的很多答案都指的是旧版本或 2009 年的答案，我想知道今天推荐的方法是什么。
（我应该用 PHP 做吗？有推荐的插件吗？）
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T21:56:56.883

您有 2 个选择：

1.  使用本教程[创建一个自定义组件](http://docs.joomla.org/Developing_a_Model-View-Controller_%28MVC%29_Component_for_Joomla!1.6)（组件是负责在 Joomla 的主要区域中显示内容的扩展类型）

2.  浏览[Joomla！](http://extensions.joomla.org)现有解决方案的[扩展目录(JED) - 可能从“](http://extensions.joomla.org)[表格和列表](http://extensions.joomla.org/extensions/news-display/tables-a-lists)”类别开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T10:56:00.840

我已经使用 Table JX 扩展几年了。虽然它是商业的，但我认为它物有所值。它有一个非常简单的用户界面，您只需单击即可执行基本操作，例如在文章中显示数据库表。

他们的网页不是最好的，但演示信息量很大：[http ://www.toolsjx.com/table-jx/demo](http://www.toolsjx.com/table-jx/demo)

# replace - Prolog 将“+”替换为“-”

> ID：10337395
> 
> 赞同：2
> 
> 时间：2012-04-26T16:19:47.270
> 
> 标签：replace, prolog, term

我想写一个谓词`invert(X, Y)`，它成立 when `Y`is`X`但每次出现`+`替换为`-`。

例如

```
?- invert(2 + 3, 2 - 3). 
yes. 
```

例如

```
?- invert(3 + (2 + 4), X). 
X = 3 - (2 - 4). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:31:12.333

您可以使用 univ`=..`来检查表达式的条款，并将运算符替换为`+/2`运算`-/2`符。

```
invert(Left+Right, ILeft-IRight):-
  !,
  invert(Left, ILeft),
  invert(Right, IRight).
invert(Exp, IExp):-
  Exp=..[Functor|Args],
  findall(NArg,
    ( member(Arg, Args),
      invert(Arg, NArg)
    ), NArgs),
  IExp=..[Functor|NArgs]. 
```

第一个子句处理带有主函子 + 的术语。第二条适用于具有不同主函子的术语。

[编辑] 正如其中一条评论所暗示的，当 的两个参数都未实例化时，您可以更改第一个子句以避免无限循环`invert/2`，只需将其替换为该子句

```
invert(Exp, ILeft-IRight):-
  Exp=..[+, Left, Right],
  !,
  invert(Left, ILeft),
  invert(Right, IRight). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:51:20.587

我会建议一些更简单的东西：

```
invert(P,P):-atomic(P). % P is konstant, e.g. invert(3,3)->true
invert(T-P,T1-P1):-invert(P,P1),invert(T,T1).
invert(T+P,T1-P1):-invert(P,P1),invert(T,T1). 
```

# locking - 信号量/互斥锁/解锁频率

> ID：10337397
> 
> 赞同：1
> 
> 时间：2012-04-26T16:19:49.707
> 
> 标签：locking, mutex, semaphore, critical-section, unlock

我有一些代码需要使用信号量或互斥锁来锁定。代码是这样的：

```
callA();
callB();
callC();
.
.
.
callZ(); 
```

我想知道锁定它的有效方法。我正在考虑的选项是

*   在 callA() 之前锁定，在 callZ() 之后解锁。我担心的是锁定会保持相当长的一段时间。

*   每次函数调用后锁定和解锁。我担心抓取和释放锁的“开销太大”。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:10:39.617

这完全取决于您的用例。您可以容忍多少锁定/解锁/锁定/解锁性能损失？权衡一下，你愿意在等待锁的同时再做一个任务块多久？一些线程是延迟关键的还是交互式的，而其他线程是批量的还是低优先级的？是否有其他任务会通过其他代码路径获取相同的锁？如果是这样，那些看起来像什么？`callA`如果,等中的关键部分`callB`真的是分开的，那么你想使用 26 个不同的锁吗？还是他们操作相同的数据，迫使您使用单个锁？

顺便说一句，如果您使用的是 Linux，请务必使用（pthreads）互斥锁，而不是信号量。互斥锁的快速路径完全是用户空间。在没有争用时锁定和解锁它们非常便宜。信号量没有捷径可走。

在不知道其他任何事情的情况下，我建议使用细粒度锁定，特别是如果您的各个函数已经组织好，不会做出只有在所有函数都持有锁的情况下才会成立的假设。但正如我所说，这真的取决于你在做什么以及你为什么这样做。

# sql - 使用外键

> ID：10337402
> 
> 赞同：0
> 
> 时间：2012-04-26T16:20:10.023
> 
> 标签：sql, foreign-keys

我是外键新手，但我非常了解这个概念。

我找到了很多关于如何创建/删除它们的文档，但没有找到如何使用它们。我的架构如下。

库存表：

```
零件编号 | 型号 | 类型 | 小贩
------------------------------
1 | DDR2 | 内存 | 店铺1
2 | DDR3 | 内存 | 店铺1
3 | WD1 | 硬盘 | 店铺2
4 | WD2 | 硬盘 | 店铺2

```

然后产品表

```
产品编号 | 姓名 | 第 1 部分 | 第 2 部分 ...
1 | PC1 | 1 | 2
2 | PC1 | 3 | 4

```

我如何使用`select`获得

```
| PC1 | DDr2 | DDR3 |
| PC1 | WD1  | WD2  | 
```

和`PartID2`外`PartID3`键链接到`PartID`主键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:33:43.957

外键的概念是将一个表中的 ID 链接到另一个表中的唯一 ID 列表。在您的示例中，您有具有唯一 ID 的唯一部件和可以使用这些部件的产品，因此在您的产品表中，您可以在多行中使用多个部件 ID。

外键用于保持数据库中的引用完整性，您可以使用连接来获取所需的数据：

```
SELECT A.NAME,
       B.Model,
       C.Model
FROM PRODUCTS A
       INNER JOIN PARTS B ON B.PARTID1 = A.PARTID
       INNER JOIN PARTS C ON C.PARTID1 = A.PARTID
WHERE A.PRODID = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:30:20.893

简短的回答是你可以做

```
 select p.name, a.model as part1, b.model as part2, c.model as part3 
   from product p, stock a, stock b, stock c 
   where p.partid1 = a.partid and p.partid2 = b.partid and p.partid3 = c.partid 
```

更长的答案是，对于您正在尝试做的事情，这并不是一个好的表格设计。它假定您始终对任何项目都有固定数量的零件（或至少不超过某个固定数量）。更好的设计是：

```
Part Table:
partID | model | type | vendor

Product Table:
productID | name

Product_Parts Table:
productID | partID 
```

其中 Product_parts 中的 productID 是 Product 的外键，partID 是 Part 表的外键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:26:06.753

```
SELECT s1.Name, p1.Model, p2.Model FROM stock st 
    INNER JOIN product p1
       ON st.PartID1 = p1.PartID1
          INNER JOIN product p2
             ON st.PartID2 = p2.PartID1 
```

一次 JOIN 首先连接股票和零件表，然后再次将此连接的结果连接到零件表。

SQL 解析器将使用部分表作为两个单独的表，因此您可以在单行中从同一个表中获得两个结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:27:14.147

您可以在同一个 sql 语句中多次加入一个表。在这种情况下，您需要加入您的库存表两次，一次是为了获取产品中每个零件的名称。

```
SELECT pr.ProdID, s1.Model, s2.Model
FROM Product pr, Stock s1, Stock s2
WHERE pr.PartID1 = s1.PartID
AND pr.PartID2 = s2.PartID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:28:26.097

使用 a表示如果or值设置为 NULL `LEFT OUTER JOIN`，产品仍将返回事件。`Part1ID``Part2ID`

```
SELECT          P.Name,
                S1.Model,
                S2.Model
FROM            Product P
LEFT OUTER JOIN Stock S1 ON P.PartID1 = S1.PartID
INNER JOIN      Stock S2 ON P.PartID2 = S2.PartID 
```

# race-condition - 克服无锁引用计数中的竞争条件

> ID：10337404
> 
> 赞同：2
> 
> 时间：2012-04-26T16:20:13.790
> 
> 标签：race-condition, lock-free, reference-counting

想象一下这样的结构：

```
struct my_struct {
    uint32_t refs
    ...
} 
```

通过查找表获取指针：

```
struct my_struct** table;

my_struct* my_struct_lookup(const char* name)
{
    my_struct* s = table[hash(name)];

    /* EDIT: Race condition here. */

    atomic_inc(&s->refs);

    return s;
} 
```

在多线程模型中，取消引用和原子增量之间存在竞争。鉴于这是对性能非常关键的代码，我想知道解引用和原子增量之间的这种竞争通常是如何解决或解决的？

编辑：通过查找表获取指向`my_struct`结构的指针时，有必要首先取消对结构的引用以增加其引用计数。当其他线程可能正在更改引用计数并可能释放对象本身时，这会在多线程代码中产生问题，而另一个线程随后会取消引用指向不存在内存的指针。再加上先发制人和一些坏运气，这可能是灾难的根源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:51:42.400

一种解决方案是使用 freelist，而不是 malloc() 和 free()。这有明显的缺点。

另一种是实现无锁垃圾回收（也称为安全内存回收）。

这个领域有很多专利，但是基于epoch的LFGC似乎是不受限制的。

使用此方法的结果是元素仅在没有线程指向它们时才被释放。

前一种解决方案很容易实现。当然，您需要一个无锁空闲列表，或者您的整个系统不再是无锁的。

后者确实不复杂，但需要学习有问题的算法，这需要一些时间和研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T17:45:36.067

正如上面有人所说，您可以稍后释放内存链表，因此您的指针永远不会无效。在某些情况下，这是一种方便的方法。

或者....你可以用你的 32 位指针创建一个 64 位结构，并有 32 位用于引用计数和其他标志。如果将结构包装在联合中，则可以在结构上使用 64 位原子操作：

```
union my_struct_ref {
    struct { 
      unsigned int       cUse     : 16,
                         fDeleted : 1;    // etc 
      struct my_struct  *s;
    } Data;
    unsigned long n64;
} 
```

您可以以可读的方式使用结构的数据部分，并且可以在 n64 位部分上使用 CAS。

```
my_struct* my_struct_lookup(const char* name)
{
    struct my_struct_ref Old, New;
    int iHash = hash(name);

    // concurrency loop
    while (1) {
      Old.n64 = table[iHash].n64;
      if (Old.Data.fDeleted)
        return NULL;
      New.n64 = Old.n64;
      New.Data.cRef++;
      if (CAS(&table[iHash].n64, Old.n64, New.n64)) // CAS = atomic compare and swap
        return New.Data.s; // success
      // we get here if some other thread changed the count or deleted our pointer
      // in between when we got a copy of it int old.  Just loop to try again.
    } 
} 
```

如果您使用 64 位指针，则需要执行 128 位 CAS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:08:28.830

除了您确定的种族之外，您还有一个普遍的**内存一致性**问题。

即使您可以以无锁方式使表修改原子化，`my_struct*`与上次修改它的线程相比，从不同线程看到的内存块仍然可能是“陈旧的”。这不适用于`my_struct.refs`（前提是您*始终*使用原子访问它），但适用于所有其他字段。这是每个 CPU 内核“私有”的写入缓冲区和高速缓存的结果。

保证您看到正确的内存内容的唯一方法是使用内存屏障。然而，一个典型的锁*也是*一个内存屏障，那么为什么不首先使用锁呢？

无锁编程比最初看起来要复杂得多，OTOH 锁可以非常快，尤其是在很少发生争用时。您是否真的对基于锁的实现进行了基准测试并确认锁定确实是您的瓶颈？

# inno-setup - Inno Setup：始终通过界面运行任务，从不通过命令行运行

> ID：10337409
> 
> 赞同：1
> 
> 时间：2012-04-26T16:20:27.277
> 
> 标签：inno-setup

我的设置的一部分在通过命令行调用它时我不想运行，但总是通过界面运行它。

我是通过 [task] 执行此操作的，并且根本没有在命令行选项中传递该特定任务。

我的问题是，通过界面运行此设置时，我什至不想将此选项提供给用户，而且我找不到从设置界面隐藏任务的方法。

有没有办法隐藏这个任务？或者另一种更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T07:42:03.043

从“界面”（大概是资源管理器？）运行安装程序和从命令提示符运行之间没有自然的区别。

也许你的意思是`/silent`？如果是这样，请使用该`WizardSilent()`功能。

如果您不希望它保持沉默，您可以传递您自己的`/skipXYZ`参数，然后使用`GetCmdTail()`或检查`{param:...}`

# c# - 在 C# 中将数据保存到文件中

> ID：10337410
> 
> 赞同：10
> 
> 时间：2012-04-26T16:20:29.003
> 
> 标签：c#, file, save

所以我目前正在做一个为探路者角色扮演游戏制作自动角色表的项目，并且不知道如何保存数据。我想将所有变量的当前值保存到扩展名为 .pfcsheet 的文件中，稍后再打开。我用谷歌搜索，找不到说明如何执行此操作的内容，只是如何保存文本框的内容。我尝试使用 saveFileDialog 控件，但它一直给我一个“文件名无效”错误，似乎没有人知道为什么。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-03-14T22:40:23.390

我刚刚写[了一篇关于将对象数据保存为 Binary、XML 或 Json 的博文](http://blog.danskingdom.com/saving-and-loading-a-c-objects-data-to-an-xml-json-or-binary-file/)。听起来您可能想要使用二进制序列化，但也许您希望在应用程序之外编辑文件，在这种情况下 XML 或 Json 可能会更好。以下是各种格式的功能。有关更多详细信息，请参阅我的博客文章。

## 二进制

```
/// <summary>
/// Writes the given object instance to a binary file.
/// <para>Object type (and all child types) must be decorated with the [Serializable] attribute.</para>
/// <para>To prevent a variable from being serialized, decorate it with the [NonSerialized] attribute; cannot be applied to properties.</para>
/// </summary>
/// <typeparam name="T">The type of object being written to the XML file.</typeparam>
/// <param name="filePath">The file path to write the object instance to.</param>
/// <param name="objectToWrite">The object instance to write to the XML file.</param>
/// <param name="append">If false the file will be overwritten if it already exists. If true the contents will be appended to the file.</param>
public static void WriteToBinaryFile<T>(string filePath, T objectToWrite, bool append = false)
{
    using (Stream stream = File.Open(filePath, append ? FileMode.Append : FileMode.Create))
    {
        var binaryFormatter = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
        binaryFormatter.Serialize(stream, objectToWrite);
    }
}

/// <summary>
/// Reads an object instance from a binary file.
/// </summary>
/// <typeparam name="T">The type of object to read from the XML.</typeparam>
/// <param name="filePath">The file path to read the object instance from.</param>
/// <returns>Returns a new instance of the object read from the binary file.</returns>
public static T ReadFromBinaryFile<T>(string filePath)
{
    using (Stream stream = File.Open(filePath, FileMode.Open))
    {
        var binaryFormatter = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
        return (T)binaryFormatter.Deserialize(stream);
    }
} 
```

## XML

需要将 System.Xml 程序集包含在您的项目中。

```
/// <summary>
/// Writes the given object instance to an XML file.
/// <para>Only Public properties and variables will be written to the file. These can be any type though, even other classes.</para>
/// <para>If there are public properties/variables that you do not want written to the file, decorate them with the [XmlIgnore] attribute.</para>
/// <para>Object type must have a parameterless constructor.</para>
/// </summary>
/// <typeparam name="T">The type of object being written to the file.</typeparam>
/// <param name="filePath">The file path to write the object instance to.</param>
/// <param name="objectToWrite">The object instance to write to the file.</param>
/// <param name="append">If false the file will be overwritten if it already exists. If true the contents will be appended to the file.</param>
public static void WriteToXmlFile<T>(string filePath, T objectToWrite, bool append = false) where T : new()
{
    TextWriter writer = null;
    try
    {
        var serializer = new XmlSerializer(typeof(T));
        writer = new StreamWriter(filePath, append);
        serializer.Serialize(writer, objectToWrite);
    }
    finally
    {
        if (writer != null)
            writer.Close();
    }
}

/// <summary>
/// Reads an object instance from an XML file.
/// <para>Object type must have a parameterless constructor.</para>
/// </summary>
/// <typeparam name="T">The type of object to read from the file.</typeparam>
/// <param name="filePath">The file path to read the object instance from.</param>
/// <returns>Returns a new instance of the object read from the XML file.</returns>
public static T ReadFromXmlFile<T>(string filePath) where T : new()
{
    TextReader reader = null;
    try
    {
        var serializer = new XmlSerializer(typeof(T));
        reader = new StreamReader(filePath);
        return (T)serializer.Deserialize(reader);
    }
    finally
    {
        if (reader != null)
            reader.Close();
    }
} 
```

## json

您必须包含对 Newtonsoft.Json 程序集的引用，该程序集可以从[Json.NET NuGet Package](http://www.nuget.org/packages/Newtonsoft.Json)获得。

```
/// <summary>
/// Writes the given object instance to a Json file.
/// <para>Object type must have a parameterless constructor.</para>
/// <para>Only Public properties and variables will be written to the file. These can be any type though, even other classes.</para>
/// <para>If there are public properties/variables that you do not want written to the file, decorate them with the [JsonIgnore] attribute.</para>
/// </summary>
/// <typeparam name="T">The type of object being written to the file.</typeparam>
/// <param name="filePath">The file path to write the object instance to.</param>
/// <param name="objectToWrite">The object instance to write to the file.</param>
/// <param name="append">If false the file will be overwritten if it already exists. If true the contents will be appended to the file.</param>
public static void WriteToJsonFile<T>(string filePath, T objectToWrite, bool append = false) where T : new()
{
    TextWriter writer = null;
    try
    {
        var contentsToWriteToFile = JsonConvert.SerializeObject(objectToWrite);
        writer = new StreamWriter(filePath, append);
        writer.Write(contentsToWriteToFile);
    }
    finally
    {
        if (writer != null)
            writer.Close();
    }
}

/// <summary>
/// Reads an object instance from an Json file.
/// <para>Object type must have a parameterless constructor.</para>
/// </summary>
/// <typeparam name="T">The type of object to read from the file.</typeparam>
/// <param name="filePath">The file path to read the object instance from.</param>
/// <returns>Returns a new instance of the object read from the Json file.</returns>
public static T ReadFromJsonFile<T>(string filePath) where T : new()
{
    TextReader reader = null;
    try
    {
        reader = new StreamReader(filePath);
        var fileContents = reader.ReadToEnd();
        return JsonConvert.DeserializeObject<T>(fileContents);
    }
    finally
    {
        if (reader != null)
            reader.Close();
    }
} 
```

## 例子

```
// To save the characterSheet variable contents to a file.
WriteToBinaryFile<CharacterSheet>("C:\CharacterSheet.pfcsheet", characterSheet);

// To load the file contents back into a variable.
CharacterSheet characterSheet = ReadFromBinaryFile<CharacterSheet>("C:\CharacterSheet.pfcsheet"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-26T16:22:53.730

我想你可能想要这样的东西

```
// Compose a string that consists of three lines.
string lines = "First line.\r\nSecond line.\r\nThird line.";

// Write the string to a file.
System.IO.StreamWriter file = new System.IO.StreamWriter("c:\\test.txt");
file.WriteLine(lines);

file.Close(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T16:25:41.387

看看[`XMLSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)课堂。

如果您想保存对象的状态并能够在其他时间轻松地重新创建它们，那么序列化是您最好的选择。

对其进行序列化，以便返回完整格式的 XML。`StreamWriter`使用该类将其写入文件。

稍后，您可以读入文件的内容，并将其与您要填充的对象的实例一起传递给序列化程序类，序列化程序也将负责反序列化。

这是从[Microsoft Support](http://support.microsoft.com/kb/815813)获取的代码片段：

```
using System;

public class clsPerson
{
  public  string FirstName;
  public  string MI;
  public  string LastName;
}

class class1
{ 
   static void Main(string[] args)
   {
      clsPerson p=new clsPerson();
      p.FirstName = "Jeff";
      p.MI = "A";
      p.LastName = "Price";
      System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(p.GetType());

      // at this step, instead of passing Console.Out, you can pass in a 
      // Streamwriter to write the contents to a file of your choosing.
      x.Serialize(Console.Out, p);

      Console.WriteLine();
      Console.ReadLine();
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-26T16:33:44.710

这是一个类似于 Sachin 的简单示例。建议对非托管文件资源使用“using”语句：

```
 // using System.IO;
        string filepath = @"C:\test.txt";
        using (StreamWriter writer = new StreamWriter(filepath))
        {
            writer.WriteLine("some text");
        } 
```

[using 语句（C# 参考）](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-26T16:24:03.257

这是 MSDN 关于如何将文本写入文件的指南的文章：

[http://msdn.microsoft.com/en-us/library/8bh11f1k.aspx](http://msdn.microsoft.com/en-us/library/8bh11f1k.aspx)

我将从那里开始，然后在您继续开发时发布其他更具体的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-04T16:08:42.173

一个班轮：

```
System.IO.File.WriteAllText(@"D:\file.txt", content); 
```

如果文件不存在，它会创建文件，如果存在则覆盖它。确保您具有适当的权限来写入该位置，否则您将获得异常。

[https://msdn.microsoft.com/en-us/library/ms143375%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396](https://msdn.microsoft.com/en-us/library/ms143375%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396)

[将字符串写入文本文件并确保它始终覆盖现有内容。](https://stackoverflow.com/questions/1225857/write-string-to-text-file-and-ensure-it-always-overwrites-the-existing-content)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-26T16:23:12.027

从 System.IO 命名空间（尤其是 File 或 FileInfo 对象）开始应该可以帮助您入门。

[http://msdn.microsoft.com/en-us/library/system.io.file.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.aspx)

[http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)

# javascript - 与 Google 地图网站不同，Google 地图地理编码器不会找到不准确地址的地点

> ID：10337423
> 
> 赞同：3
> 
> 时间：2012-04-26T16:21:45.413
> 
> 标签：javascript, google-maps-api-3

我正在尝试使用 Google Maps 地理编码服务。我复制了代码，它似乎找到了很好的地址（例如“13 Marine Terrace Aberystwyth”），但没有找到像“Rummers Wine Bar，Aberystwyth”这样的其他地方，即使实际的谷歌地图网站根本没有问题。

这是我的代码，稍作修改以用于阿伯里斯特威斯地区，但以其他方式复制形式[https://developers.google.com/maps/documentation/javascript/tutorial](https://developers.google.com/maps/documentation/javascript/tutorial)

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

        <link rel="stylesheet" type="text/css" href="styles.css" />

    <script type="text/javascript"

/*you can use https if you want it secure!!!    set java scrip sensor to true and read from gps!*/

      src="http://maps.googleapis.com/maps/api/js?key=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXo-tdDimvjIs&sensor=false&region=GB">
    </script>
    <script type="text/javascript">

var geocoder;
  var map;
  function initialize() {
     geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(52.4156, -4.0829);
    var myOptions = {
      zoom: 14,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  }

   function codeAddress() {
    var address = document.getElementById("address").value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
         map.setCenter(results[0].geometry.location);
         var marker = new google.maps.Marker({
             map: map,
             position: results[0].geometry.location

         });

      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
            function code ()
                           {document.write(results[0].geometry.location);}
    });
  }
      </script>
    </head>

<body onload="initialize()">
 <div id="map_canvas" style="width: 320px; height: 480px;"></div>
  <div>
   <input id="address" type="textbox" value="aberystwyth">
   <input type="button" value="Encode" onclick="codeAddress()">
  </div>
      </script>
     <script type="text/javascript">
    code();
   </script>
 </body> 
```

这是一个链接：[http ://users.aber.ac.uk/avh9/thesite/geocodeaber.html](http://users.aber.ac.uk/avh9/thesite/geocodeaber.html)

谁能告诉我为什么以及如何解决它？或地理编码的任何替代方案......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T19:52:39.687

Google Maps API 中有一个名为[Places Library的库。](https://developers.google.com/maps/documentation/javascript/places)您可以使用其或方法来搜索 POI 和地标。~~`search()`~~ `nearbySearch()``textSearch()`

# salesforce - 如何模拟来自页面控制器的按钮单击？

> ID：10337426
> 
> 赞同：2
> 
> 时间：2012-04-26T16:22:08.103
> 
> 标签：salesforce, apex-code, visualforce

我正在 Visualforce 中创建一个类似 Google 的应用程序，用户在其中输入搜索词，单击搜索，结果显示在搜索框下方。作为其中的一部分，当用户单击 Search 时，会设置一个 actionStatus 以在搜索过程中显示“Loading...”：

```
<apex:commandButton value="Search" action="{!runQuery}" status="loading"/> 
```

现在我正在尝试设置登录页面，它只是一个带有输入字段和搜索按钮的页面，用于初始搜索。在 Google 风格中，第一次搜索会将用户带到显示结果的页面，搜索框向上移动到顶部。

问题是我不知道如何在页面加载时调用 actionStatus。当用户点击一个按钮时这很容易，但是当从登录页面搜索时，会加载一个新页面*然后*执行搜索。目前我只是让控制器的构造函数检查参数，如果找到，`runQuery()`手动调用，但这只会延迟页面加载时间并且不会调用 actionStatus。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T21:24:06.820

采用

```
<apex:actionFunction name="runQueryJS" action="{!runQuery}" status="loading" /> 
```

创建一个客户端调用点，然后在 body 的加载事件（或您要从中运行查询的任何其他位置）附加一个处理程序，该处理程序将调用`runQueryJS()`javascript 函数，该函数将执行 Ajax 调用以进行搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:25:07.883

添加 onLoad 事件调用不起作用，但将其放在页面的最后，就在结束`apex:page`标记之前，似乎。我不完全确定为什么，但它很干净并且可以完成工作。

```
<script>
    runQuery();
</script> 
```

# c# - 如何显示可下载的链接

> ID：10337427
> 
> 赞同：2
> 
> 时间：2012-04-26T16:22:20.530
> 
> 标签：c#, asp.net, asp.net-mvc, html-helper

我正在尝试使用 ActionLink 在我的 MVC 应用程序的视图上显示可下载链接：

```
<div>
<%= Html.ActionLink("Test","Download","Admin") %>
</div>

public ActionResult Download()
{   
    var cd = new System.Net.Mime.ContentDisposition
    {        
        FileName = "Download Me", 
        Inline = false, 
    };
    Response.AppendHeader("Content-Disposition", cd.ToString());
    byte[] csvBytes = Encoding.ASCII.GetBytes("hello");
    return File(csvBytes, "csv","DownloadMe.csv");
} 
```

该链接显示在 UI 上，但是当我单击它时，我收到“找不到端点”错误。我是 MVC 的新手，第一次尝试这个。有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:29:17.960

我认为您对控制器方法有一些问题：

```
public FileResult Download()
{
    byte[] csvBytes = Encoding.ASCII.GetBytes("hello");
    return File(csvBytes, "text/csv","DownloadMe.csv");
} 
```

1.  你想返回一个`FileResult`，而不是一个`ActionResult`。
2.  mime 类型`text/csv`不仅仅是`csv`.
3.  我不认为内容处置是必需的，但我会在你让它工作之前将其取出，然后在必要时将其添加回来。

# jquery-ui - 无法在chrome中使用knockoutjs禁用jqueryui按钮

> ID：10337429
> 
> 赞同：4
> 
> 时间：2012-04-26T16:22:32.777
> 
> 标签：jquery-ui, knockout.js

我有以下非常简单的代码：

**html**

```
<a data-bind="enable: selected()" href="http://www.google.com">Click Me</a> 
```

**javascript**

```
function pageViewModel() {
    var self = this;
    self.selected = ko.observable();
}
$(document).ready(function() {
    $("a").button();
    ko.applyBindings(new pageViewModel());
}); 
```

这在 IE9 中有效，但在 Chrome 中无效（即，锚标记看起来像 IE9 中的禁用按钮，但在 Chrome 中，标签看起来像/是启用按钮）。我还尝试通过使用以下绑定直接操作 css 来禁用按钮：

```
<a data-bind="css: {ui-button-disabled: !selected(), ui-state-disabled: !selected()}">Click Me</a> 
```

但显然，knockoutjs 不喜欢我正在使用的类中包含 - 的事实。

所以现在我被困住了。有没有人知道如何让这两个浏览器都使用 jqueryui 和 knockoutjs？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-26T16:28:09.520

您可以将类名括在引号中：

```
<a data-bind="css: {'ui-button-disabled': !selected(), 'ui-state-disabled': !selected()}">Click Me</a> 
```

不过，更好的方法是使用自定义绑定来设置按钮的禁用选项：

```
ko.bindingHandlers.button = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        $(element).button();
    },
    update: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            disabled = ko.utils.unwrapObservable(value.disabled);

        $(element).button("option", "disabled", disabled);
    }
}; 
```

然后你可以像这样绑定它：

```
<a data-bind="button: { disabled: !selected() }">Click Me</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:39:53.797

代替

```
<a data-bind="enable: selected()" href="http://www.google.com">Click Me</a> 
```

尝试

```
<a data-bind="enable: selected" href="http://www.google.com">Click Me</a> 
```

# plsql - 在 PL/SQL 中访问绑定变量

> ID：10337433
> 
> 赞同：0
> 
> 时间：2012-04-26T16:22:51.483
> 
> 标签：plsql, buffer, bind-variables, ora-06502

我正在尝试在 Oracle Express Edition 编辑器中运行一个程序。当我执行程序时，我得到一个错误

```
ORA-06502: PL/SQL: numeric or value error: character string buffer too small 
```

谁能帮我理解为什么我会出错以及如何修复代码？

```
VARIABLE gvn_total_salary NUMBER;
DECLARE
   vn_base_salary NUMBER := 3000;
   vn_bonus NUMBER := 1000;
BEGIN
   :gvn_total_salary := vn_base_salary + vn_bonus;
END; 
```

我得到的输出

```
ORA-06502: PL/SQL: numeric or value error: character string buffer too small 

Run By SYSTEM 
Parsing Schema SYSTEM 
Script Started Thursday, April 26, 2012 
 3 seconds ago 
Elapsed time 0.01 seconds 
Statements Processed 1 
Successful 0 
With Errors 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:53:36.007

通过绑定变量的声明，该代码在 SQL*Plus 中对我来说可以正常工作

```
SQL> VARIABLE gvn_total_salary NUMBER;
SQL> DECLARE
  2     vn_base_salary NUMBER := 3000;
  3     vn_bonus NUMBER := 1000;
  4  BEGIN
  5     :gvn_total_salary := vn_base_salary + vn_bonus;
  6  END;
  7  /

PL/SQL procedure successfully completed.

SQL> print gvn_total_salary

GVN_TOTAL_SALARY
----------------
            4000 
```

您可以使用 SQL*Plus 连接到数据库并运行相同的东西吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:37:51.303

你实际上想要完成什么？该脚本不会在 sqlplus 或 Oracle Developer 或我能想到的任何 PL/SQL 执行环境中执行。实际上，我不明白您如何传递绑定变量 :gvn_total_salary 以及如何获得您所描述的错误。您应该得到未声明的“绑定变量 gvn_total_salary”之类的内容。

# vb.net - 如何使属性窗口中的自定义属性在通过代码更改时刷新？

> ID：10337434
> 
> 赞同：0
> 
> 时间：2012-04-26T16:22:53.453
> 
> 标签：vb.net

这是一些代码：

```
ReadOnly Property X() As Integer
    Get
        Return PointerX
    End Get
End Property

ReadOnly Property Y() As Integer
    Get
        Return PointerY
    End Get
End Property

Private Sub Proj_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles Me.MouseMove
    PointerX = e.X
    PointerY = e.Y
End Sub 
```

我想让属性窗口在每次鼠标移动时更新 X 和 Y 的属性，以便用户立即看到它们。我知道这很愚蠢，但这是我的任务。

![在此处输入图像描述](../Images/db23cfc5708493fd22f8ac9596f86772.png)

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:07:36.740

这不是一个 Windows 窗体项目。

您创建了一个包含默认 UserControl 的 Windows 控件库，当您“运行”时，您会看到您的 UserControl 被托管，这就是您看到 PropertyGrid 控件的原因。

您需要在解决方案中创建或添加一个新项目，即 Windows 窗体应用程序，并将其设置为“启动项目”（鼠标右键单击表单项目并选择“设置为启动项目”）。

重建解决方案后，您的 UserControl“Proj”将从工具箱中可用，您可以将其放置在表单上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:30:28.413

我强烈建议在 WPF 中使用 OnPropertyChanged 事件在属性更改时通知所有侦听器来执行此项目。然后，让 PropertyGrid 监听它所代表的对象上的所有此类事件，更新适当的属性。WPF 非常适合这些东西......

# jquery - 将类添加到链接

> ID：10337436
> 
> 赞同：-3
> 
> 时间：2012-04-26T16:23:08.080
> 
> 标签：jquery, hyperlink, addclass, location-href

我需要帮助为这些链接添加一个类：

```
<a class="campusIcon km-icon" onclick ="window.location.href='indexHome.html'" data-rel="external">Campus</a>
<a class="searchIcon km-icon"  onclick ="window.location.href='indexListView.html'"  data-rel="external">Search</a>
<a class="mapIcon km-icon"  onclick ="window.location.href='indexKBlock.html'"  data-rel="external">Map</a>
<a class="favIcon km-icon" onclick ="window.location.href='indexChart.html'" data-rel="external">Fav</a> 
```

我要添加的类是`km-state-active`. 如果我在`onClick`事件中添加类，那么我会添加我的类但`location.href`不起作用。

那么，有什么问题，我该如何解决呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:24:59.007

你的意思是这样的？：

```
$("a").click(function(){
    $(this).toggleClass("km-state-active");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:26:55.417

尝试这个：

**HTML：**

```
<a class="campusIcon km-icon"  href="indexHome.html" data-rel="external">Campus</a> 
<a class="searchIcon km-icon" href="indexListView.html" data-rel="external">Search</a> 
<a class="mapIcon km-icon" href="indexKBlock.html" data-rel="external">Map</a> 
<a class="favIcon km-icon" href="indexChart.html" data-rel="external">Fav</a>​ 
```

**jQuery：**

```
$("a").on('click', function() {
   $(this).addClass("km-state-active").attr('href', 'YOUR_URL');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:27:27.163

为什么要使用内联代码来处理对锚标记的点击？为什么不：

**JS**

```
$("a").click(function() {
    $(this).addClass("km-state-active");
}); 
```

**HTML**

```
<a class="campusIcon km-icon"  href="indexHome.html" data-rel="external">Campus</a> 
<a class="searchIcon km-icon" href="indexListView.html" data-rel="external">Search</a> 
<a class="mapIcon km-icon" href="indexKBlock.html" data-rel="external">Map</a> 
<a class="favIcon km-icon" href="indexChart.html" data-rel="external">Fav</a>​ 
```

**附加信息**

这是一篇不错的文章（旧但很好）：[为什么内联 CSS 和 JavaScript 代码是如此糟糕](http://css.dzone.com/news/why-inline-css-and-javascript-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:27:30.877

你不应该使用内联脚本。这是一个不好的做法。更新您的标记，使其看起来与此类似。

```
<a class="campusIcon km-icon" href ="indexHome.html" data-rel="external">Campus</a> 
```

并使用 jQuery 在点击时添加类

```
$("a").on('click', function() {
    $(this).addClass("km-state-active");
}); 
```

# android - 在 android webview 中禁用弹出窗口拦截器

> ID：10337442
> 
> 赞同：2
> 
> 时间：2012-04-26T16:23:29.580
> 
> 标签：android, webview, popup

我正在开发一个应用程序，其中很大一部分有一系列有用的链接，这些链接在 web 视图中打开。我的链接可以正常工作，但至少有一个网站需要禁用弹出窗口阻止程序。我无论如何都找不到禁用 webview 的弹出窗口阻止程序。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:06:00.167

您可能需要`setSupportMultipleWindows`在`WebSettings`

> 告诉 WebView 是否支持多窗口。

[http://developer.android.com/reference/android/webkit/WebSettings.html#setSupportMultipleWindows(boolean)](http://developer.android.com/reference/android/webkit/WebSettings.html#setSupportMultipleWindows%28boolean%29)

你可以这样做：

```
WebSettings settings = webview.getSettings();  
settings.setSupportMultipleWindows(true); 
```

# objective-c - removeFromSuperview 无法正常工作

> ID：10337446
> 
> 赞同：1
> 
> 时间：2012-04-26T16:24:02.323
> 
> 标签：objective-c, ios, view

在班上

```
@interface StartScene : UIView 
```

我称之为一个实例

```
@interface HelpView : UIView {
    GameOverMenu* gorm;
    PlayScene* tView;
} 
```

并使用`addSubview`. 我这里也有大量代码

```
-(void) removemyself {
    [tView removeFromSuperview];
    [gorm removeFromSuperview];
    [self removeFromSuperview];
}

-(void)restartPlay {
    [tView removeFromSuperview];
    [self playSceneDidLoad];
}

-(void)gameOverDidLoad {
    [tView removeFromSuperview];
    gorm = [[GameOverMenu alloc]initWithFrame:CGRectMake(0, 0, 320, 520)];
    gorm.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"backGround.jpg"]];
    [gorm checkScore:Scores];
    [self addSubview:gorm];
}

-(void)playSceneDidLoad {
    [gorm removeFromSuperview];
    tView = [[PlayScene alloc]initWithFrame:CGRectMake(0, 0, 320, 520)];
    tView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"backGround.jpg"]];
    [self addSubview:tView];
    [tView ooneFingerTwoTaps];
} 
```

和两个子类`HelpView`：

```
@interface PlayScene : HelpView

@interface GameOverMenu : HelpView <UITextFieldDelegate> 
```

当`StartScene`我按下按钮时，会创建一个实例并调用`HelpView`init 方法。`playSceneDidLoad`

里面`PlayScene`有调用`restartPlay`方法的重启按钮。游戏失败时`gameOverDidLoad`调用方法。

并且在两者`PlayScene`中`GameOverMenu`都有退出按钮，它调用`removemyself`方法，应该将播放器返回到主菜单。

乍一看它应该可以正常工作，但是如果我多次按下重新启动按钮而不是尝试按下退出，则会发生视图未从超级视图中删除，现在只需按下退出按钮即可将它们一一删除。我们停在 HelpView 上，它并没有自行删除（即使我尝试在`[super removeFromSuperview];`某个地方打电话。

我需要及时正确删除视图并在按下退出时进入主菜单（StartScene）。我不认为很多观点相互覆盖是一个好的变体。问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T17:42:18.343

好吧，我发现重点是，如果从子类调用超类的方法并且有这样的命令`[self removeFromSuperview];`or `[(someOtherSubview) removeFromSuperview];`，则它是使用 self 或 (someOtherSubview) 的子类。如果我们的子类没有指向的 subView，那么该命令将什么也不做。如果有`[self removeFromSubview];`，子类将自行删除。

实际上我通过使用按钮作为超类的子视图解决了这个问题。

# java - 编辑axis2.xml 文件以包含超时参数会影响客户端存根吗？

> ID：10337450
> 
> 赞同：1
> 
> 时间：2012-04-26T16:24:15.210
> 
> 标签：java, axis2

我敢肯定任何熟悉 Axis2 的人都看过这个页面无数次： [http ://axis.apache.org/axis2/java/core/docs/http-transport.html#timeout_config](http://axis.apache.org/axis2/java/core/docs/http-transport.html#timeout_config)

我需要在客户端超时，这似乎是一个相当普遍的要求。该页面上的简介说您可以编辑 XML 文件，或将代码添加到客户端存根。我的理解是这两种方法都会影响客户端存根，并且我期望生成的存根会有所不同。运行比较后，无论axis2.xml中是否有超时参数，生成的存根都没有差异。所以我想知道更改 XML 文件的作用，以及它是否会影响客户端存根，或者它是否仅用于在 servlet 上部署 Axis2。

预先感谢您的帮助！我很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T12:22:20.537

文档说**传输级别中存在超时实例**，这意味着它对生成的任何 wsdl 或存根都没有影响。它只是将您的服务配置为在给定时间内通过传输层超时。

就像 Web 应用程序的 web.xml 中的超时标记一样。

# python - Python 使用参数循环调用 shell 命令

> ID：10337451
> 
> 赞同：0
> 
> 时间：2012-04-26T16:24:18.727
> 
> 标签：python, shell, loops, subprocess

以下小脚本应该每 10 分钟运行一次带有参数的 shell 命令。它曾经正确运行过一次（30 分钟前），但现在没有打球（应该再执行 2 次该过程）。我犯了错误吗？

```
而（真）：
  subprocess.call(["command","param"])
  时间.sleep(600)

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:26:57.020

无论您的命令是什么，您的 subprocess.call 都可能被阻止。我怀疑它是您的 python 脚本，而是无论 shell 命令可能是什么（花费太长时间）。

您可以通过检查返回码来判断您的命令是否完成：

`print subprocess.call(["command","param"])`

如果成功，它应该打印`0`，或者如果命令有问题，则引发异常。但是如果你从来没有看到连续的打印，那么它就永远不会从调用中返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:28:23.107

如果您不需要等待命令完成，请尝试 subprocess.Popen。

从文档中，

> subprocess.call：运行args描述的命令。**等待命令完成**，然后返回 returncode 属性。

# java - 使用 Jena 读取限制值

> ID：10337455
> 
> 赞同：4
> 
> 时间：2012-04-26T16:24:25.387
> 
> 标签：java, jena, owl, protege

我有一个对象限制定义如下

```
hasYear some integer[minLength 2, maxLength 4, >=1995, <=2012] 
```

如何使用 Jena 读取限制中定义的各个值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T18:59:29.497

您可以使用不同的方法。首先，您可以通过`Model`以下代码遍历 Jena：

```
model.read(...);
StmtIterator si = model.listStatements(
        model.getResource("required property uri"), RDFS.range, (RDFNode) null);
while (si.hasNext()) {
    Statement stmt = si.next();
    Resource range = stmt.getObject().asResource();
    // get restrictions collection
    Resource nextNode = range.getPropertyResourceValue(OWL2.withRestrictions);
    for (;;) {
        Resource restr = nextNode.getPropertyResourceValue(RDF.first);
        if (restr == null)
            break;

        StmtIterator pi = restr.listProperties();
        while (pi.hasNext()) {
            Statement restrStmt = pi.next();
            Property restrType = restrStmt.getPredicate();
            Literal value = restrStmt.getObject().asLiteral();
            // print type and value for each restriction
            System.out.println(restrType + " = " + value);
        }
        // go to the next element of collection
        nextNode = nextNode.getPropertyResourceValue(RDF.rest);
    }
} 
```

如果您使用`OntModel`RDF 图形代码的表示，可以使用 of 来简化

```
model.listRestrictions()
ontClass.asRestriction()
etc. 
```

[这种方法的好例子](https://stackoverflow.com/questions/7779927/get-restrictions-on-classes-in-jena/7805455)（感谢 Ian Dickinson）

另一种方法是使用 SPARQL 1.1 查询，意义相同

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
SELECT ?datatype ?restr_type ?restr_value {
    ?prop rdfs:range ?range.
    ?range owl:onDatatype ?datatype;
        owl:withRestrictions ?restr_list.
    ?restr_list rdf:rest*/rdf:first ?restr.
    ?restr ?restr_type ?restr_value
} 
```

# iphone - 我在 plist 中的信息未保存

> ID：10337465
> 
> 赞同：0
> 
> 时间：2012-04-26T16:25:00.597
> 
> 标签：iphone, objective-c, ios, ipad

我在 plist 中有一些设置，但是当我杀死我的应用程序时，我丢失了存储在那里的所有数据。

这是我正在使用的代码：

。H

```
@property (retain, nonatomic) NSString *plistFilePath;
-(IBAction)setHomepage:(id)sender;

.m

@syntehzise plistFilePath;

-(IBAction)setHomepage:(id)sender{
plistFilePath = [NSString stringWithString:[[NSBundle mainBundle] pathForResource:@"settings" ofType:@"plist"]];
    NSMutableDictionary *data= [[NSMutableDictionary alloc] initWithContentsOfFile:plistFilePath];
    [data setObject:@"http://www.google.com" forKey:@"Homepage"];
    [data writeToFile:plistFilePath atomically:YES];
    [data release];  

} 
```

难道我做错了什么？我应该使用不同的类还是不同的方法？请帮助我，因为我不知道为什么我会很好地存储信息，但是当我杀死应用程序时，我会丢失它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:29:52.790

应用程序包是只读的。如果您想分发文件然后对其进行更新，请在您的应用程序首次运行时将其从捆绑包中移至文档文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T17:11:42.073

如前所述，捆绑包是只读的。

尽量避免在复制的 plist 中设置“设置”，因为 plist 只是要管理的另一件事。相反，为什么不使用NSUserDefaults 并从默认 plist 中[导入您的默认值。](http://mobile.tutsplus.com/tutorials/iphone/nsuserdefaults_iphone-sdk/)例如，向您的项目添加一个新的 plist，并将其添加到您的委托：

```
// Get the shared defaults object
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

// Register the defaults each time the app loads
NSString *defaultsFile = [[NSBundle mainBundle] pathForResource:@"Defaults" ofType:@"plist"];
NSDictionary *defaultsDict = [NSDictionary dictionaryWithContentsOfFile:defaultsFile];
[defaults registerDefaults:defaultsDict]; 
```

现在您可以像这样保存数据：

```
// Store the data
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:@"http://mattmelton.co.uk" forKey:@"HomePage"];
[defaults synchronize]; 
```

并像这样检索它：

```
// Retrieve data
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *homePage = [defaults objectForKey:@"HomePage"]; 
```

而且您不必担心外部文件。当然，您的默认 plist 可以是平台、用户或设备特定的！

希望这可以帮助！

# objective-c - 在 Xcode 调试器中检查数组的内容

> ID：10337468
> 
> 赞同：10
> 
> 时间：2012-04-26T16:25:33.267
> 
> 标签：objective-c, xcode, debugging

假设我创建了一个数组：

```
NSArray *newArray = [NSArray arrayWithObjects:@"foo", @"bar", @"sdfsf", nil]; 
```

在 Xcode 中，当我在断点处停止并检查时，`newArray`我看到它显示“3 个对象”，但是当我单击显示三角形时，我看到的只是一个`NSObject`，并且似乎无法查看该数组包含的内容。

在实践中，我正在使用一系列自定义对象，看到嵌套或检查它们的属性是一件非常痛苦的事情。

任何人都可以提供一些关于使用它的更好方法的见解吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-26T16:37:06.997

如果它在范围内，您只需键入

```
po newArray 
```

进入调试器，它将打印描述。

或者，如果您更喜欢单击事物，则只需右键单击控制台左侧面板中的对象，然后单击“打印...的描述”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:32:49.637

我是 NSLog 的粉丝。你也应该是:)

```
NSLog(@"contents of newArray: %@", newArray); 
```

# php - PHP脚本管道电子邮件解析

> ID：10337472
> 
> 赞同：0
> 
> 时间：2012-04-26T16:25:56.643
> 
> 标签：php, email

我正在做这个管道 php 脚本来获取到达的电子邮件并解析它并显示它。我使用了本教程：[http](http://www.damnsemicolon.com/php/parse-emails-in-php-with-email-piping-part-1) ://www.damnsemicolon.com/php/parse-emails-in-php-with-email-piping-part-1 （以及以下），我使用标准电子邮件进行了尝试已经发送到我的服务器，它运行良好，但后来我尝试了另一个，我得到了很多错误。我使用了 print_r($decoded); 向我展示电子邮件的所有不同部分，而不是获得完全解析的电子邮件，电子邮件的所有内容都转到 $decode[0]['body]; 为什么会这样？（我不会发布代码，因为它与教程相同）

```
print_r($decode)= Array (
    [0] => Array ( 
         [Headers] => Array ( ) 
         [Parts] => Array ( ) 
         [Position] => 0 
         [Body] => ï»¿From jtferreira@teste.local Thu Apr 26 12:33:44 2012 Received: from [192.168.1.92] by ubuntuserver.lan with esmtp (Exim 4.76) (envelope-from ) id 1SNMxE-0000VB-TR for jtferreira@teste.local; Thu, 26 Apr 2012 12:33:44 +0100 Message-ID: <4F993299.8040605@teste.local> Date: Thu, 26 Apr 2012 12:33:45 +0100 From: =?ISO-8859-1?Q?=22Jo=E3o_Ferreira_=28m=E1quina_virtual=29=22?= User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20120327 Thunderbird/11.0.1 MIME-Version: 1.0 To: jtferreira@teste.local Subject: Sample Email Content-Type: text/plain; charset=ISO-8859-1; format=flowed Content-Transfer-Encoding: 8bit It's the same? 
         [BodyPart] => 1 
         [BodyLength] => 744 
     )
 ) 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T09:56:47.790

正如马里奥所说，问题出在 UTF 8-BOM 上。如果有人遇到此问题，我建议您使用以下代码：

```
<?php
// substitua pelo caminho para o arquivo que deseja limpar
$file = "C:/wamp/www/wordpress/wp-content/themes/basic-gray/lib/langs.php";
print removeUTF8BOM($file) ? 'BOM removido!' : 'Não havia BOM a ser removido...';

function removeUTF8BOM($fil) {
$newcontent = '';
$first = false;
$fh = fopen($fil, 'r');
  while($part = fread($fh, 1024)) {
    if(!$first) {
      if(preg_match('/^\xEF\xBB\xBF/', $part)) {
      $newcontent = preg_replace('/^\xEF\xBB\xBF/', "", $part);
      } else {
      fclose($fh);
      return false;
      }
    $first = true;
    } else $newcontent .= $part;
  }
fclose($fh);
$fh = fopen($fil, 'w');
fwrite($fh, $newcontent);
fclose($fh);
return true;
}
?> 
```

(http://www.caugb.com.br/2009/07/remover-o-bom-de-arquivos-em-utf-8/)

# c# - 线程安全数据集

> ID：10337474
> 
> 赞同：2
> 
> 时间：2012-04-26T16:26:08.677
> 
> 标签：c#, dataset, thread-safety

我想对 DataTable/DataSet 线程安全进行更新操作。有 ~20 个线程，每个线程使用 DataTable 的`Rows.Find(pk)`方法更新 ~40 行全局 DataTable。每个线程都将更新不同的 DataTable 行。

我正在为 DataSet 使用以下包装类。这种方法是线程安全的吗？

```
public sealed class MyDataSet{

    public static DataSet ds = new DataSet();

    public static UpdateRow(key,data)
    {
        object _lock = new object();
        DataRow dr = ds.Tables[0].Rows.Find(key);
        lock(_lock){          
            dr.AcceptChanges();
            dr.BeginEdit();
            dr["col"] = data;
            dr.EndEdit();
        }
    }
} 
```

此方法从`for`循环中调用。

```
for(int x=0; x<40; x++;){
    if(someCondition)
    .
    .
    .
    MyDataSet.UpdateRow(key,data);
    .
    .
    .
    } 
```

一切都在多线程环境中完成。UpdateRow 方法线程安全吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:29:51.237

不，这不安全。你应该改变你的代码：

```
public sealed class MyDataSet{

    public static DataSet ds = new DataSet();

    private static object _lock = new object();

    public static UpdateRow(key,data)
    {
        lock(_lock){
            DataRow dr = ds.Tables[0].Rows.Find(key);
            dr.AcceptChanges();
            dr.BeginEdit();
            dr["col"] = data;
            dr.EndEdit();
        }
    }
} 
```

您的`_lock`对象应该是程序中的静态对象，以使其成为良好的锁。你`Find`应该在锁定的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:29:45.070

> UpdateRow 方法线程安全吗？

不，这不对。每次输入该方法时，您都会在**新对象**上创建一个锁。您锁定的对象在所有线程中必须相同 - 否则锁定将永远不会被视为“被占用”，因为每个线程都会愉快地在它之后丢弃的对象上创建一个新锁。实现此目的的一种方法是将您锁定的对象也设为静态。

# c++ - 使用指针数组中的对象调用重载的友元 ostream 插入运算符返回内存地址

> ID：10337477
> 
> 赞同：0
> 
> 时间：2012-04-26T16:26:20.580
> 
> 标签：c++

我编写了一个重载的插入运算符，它返回一个对象的所有数据。出于某种原因，当我试图称它为 ie 时。cout << *pkgArray[index] 它什么也不显示，但是如果我在没有 * 的情况下执行它，它会返回一个内存地址。下面是重载的运算符和我使用它的尝试。

```
ostream& operator<<(ostream& o, const OverNight& bObj) {
  stringstream ss;
  ss << bObj.getAddress() <<  ", " << bObj.getCity() << ", " << bObj.getState() << ", "     << bObj.getZip();
  string fullAddress = ss.str();
  ss.str("");
  int newWeight = bObj.getWeight();
  ss << "$" << bObj.getUnitPrice() + bObj.getAdditional() << "/ounce";
  string costPerOunce = ss.str();
  o << left 
      << setw(1) << "|"
      << setw(20) << bObj.getsname() 
      << setw(1) << "|"
      << setw(20) << bObj.getName() 
      << setw(1) << "|"
      << setw(60) << fullAddress 
      << setw(1) << "|" 
      << setw(10) << bObj.getType()
      << setw(1) << "|"
      << setw(10) << costPerOunce
      << setw(1) << "|"
      << endl;
  o << left << "+" << setfill('-') << setw(136) << right << "+" << endl;
  o << setfill(' '); // clears the hyphen filler.
  return o;
  } 

int main() {
    Package *pkgArray[15]; // package class is abstract.
    OverNight *onObj; // assigned to pkgArray later on.
    TwoDay *tdObj; // assigned to pkgArray later on.

    // pkgArray is a pointerArray filled with objects of 2 derived classes.
    for (int index = 0; index < max; index++) {
        cout << pkgArray[index];
    }
} 
```

我试过*pkgArray[index]和&pkgArray[index]，后者返回一个内存地址，第一个什么也不返回。我对 c++ 相当陌生，感觉我已经尝试了一切来解决这个问题。

**编辑：我添加了 pkgArray 的声明和分配给它的对象。我无法根据作业使用向量。**

在进一步研究问题后，我发现正在发生的事情，是重载的运算符没有处理正在传递的对象。我已经尝试取消引用 pkgArray，并完成了基类中重载的插入运算符的功能，这很有效。现在我的问题是我需要从动态数组中取出派生类的对象。我尝试在取消引用时应用优先级，但无济于事。声明如下。

过夜 * onObj; // 将被分配派生类对象的指针。两天 * tdObj; // 将被分配派生类对象的指针 Package * pkgArray[15]; // 这是一个Package类型的动态数组，它是基类

在创建过夜对象和两天对象后，它们被分配给包数组。

我正在尝试运行一个循环，该循环使用存储在动态数组中的派生对象调用重写的 << 运算符。在完成这项任务的过程中，我学到了很多东西，但显然还不足以解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:38:50.553

对多态层次结构中的对象进行 I/O 的通常模式并不是很明显。你通常大致这样实现它：

```
#include <iostream>
#include <vector>

class Base {
public:
    virtual std::ostream &write(std::ostream &os) const {
        return os << "Base\n";
    }
};

class D1 : public Base {
public:
    virtual std::ostream &write(std::ostream &os) const {
        return os << "Derived 1\n";
    }
};

class D2 : public Base {
public:
    virtual std::ostream &write(std::ostream &os) const {
        return os << "Derived 2\n";
    }
};

std::ostream &operator<<(std::ostream &os, Base const &b){
    return b.write(os);
}

int main(){
    std::vector<Base *> objects;
    Base b;
    D1 d1;
    D2 d2;

    objects.push_back(&b);
    objects.push_back(&d1);
    objects.push_back(&d2);

    for (int i=0; i<3; i++)
        std::cout << *objects[i];
    return 0;
} 
```

在这种情况下，结果是：

```
Base
Derived 1
Derived 2 
```

......正如你所希望的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:46:24.143

`*pkgArray[index]`尝试取消引用未定义为指针的对象，因此 * 对编译器没有意义（它使用指针变量中包含的第一个字节和类型描述来解释位于内存中的数据，这对它来说只是字节直到通过取消引用提供更多信息）。

您可能正在接收尚未为重载的 ostream 定义正确解释的对象引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T01:20:16.220

我已经弄清楚发生了什么。当我将派生类的对象分配给基类类型的动态数组时，只有内存地址被存储为基类类型。因此，当我运行循环时，我只能获取基类（包）类型的对象，因此，正在寻找 OverNight 类型对象的重载运算符永远不会被调用。

# javascript - Javascript 模块模式。如何访问模块内的全局变量

> ID：10337478
> 
> 赞同：0
> 
> 时间：2012-04-26T16:26:25.837
> 
> 标签：javascript, module, closures

我看过下面的代码

```
var MODULE = (function () {
var my = {},
    privateVariable = 1;

function privateMethod() {
    // ...
}

my.moduleProperty = 1;
my.moduleMethod = function () {
    // ...
};

return my;
 }()); 
```

可以像 MODULE.moduleProperty 一样访问属性...对吗？但是如何访问模块内部的全局变量 privateVariable 和 privateMethod()（它们是模块内部的全局变量......对吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:33:39.963

不，它们不是全局变量，它们是匿名函数内部的局部变量。

您可以从函数内的任何代码访问它们，但在函数之外它们不能直接访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:46:45.060

您只能从模块代码本身中访问它们，如下所示：

```
var MODULE = (function () { 
 var my = {},
 privateVariable = 1;
 function privateMethod() {
  alert('this is private!');
 }

 my.moduleProperty = 1;
 my.moduleMethod = function () {
  privateMethod();
  return privateVariable;
 };
 return my;
}()); 
```

这样做：

```
MODULE.moduleMethod(); 
```

将调用私有方法（并警告“这是私有的！”）并返回 privateVariable 的值。

无法访问 MODULE 范围之外的 privateVariable 或 privateMethod。

```
var MODULE = (function() {
 //...declare your module as above
}());

console.log(MODULE.privateVariable); //logs undefined 
```

希望这有助于为您解决问题。

# wpf - 如何将“DependenyProperty”绑定到另一个可附加的“DependencyProperty”？

> ID：10337481
> 
> 赞同：0
> 
> 时间：2012-04-26T16:26:53.150
> 
> 标签：wpf, binding

我想要一个单例，其中包含一些我可以绑定的值**S1**和**S2 。**目标是在其值更改时更新一些 UIElements。问题是我想在一个重用的`DataTemplate`. 这意味着我不能直接绑定到单例的依赖属性，但必须在外部设置。

要正确传递更新，值必须是`DependencyProperty`. 因为我不知道我必须绑定哪个属性，所以我创建了另一个与值相同类型的可附加属性**AttProperty 。**现在我尝试将**S1**绑定到**AttProperty**但这给了我一个错误：

> 附加信息：不能在“TextBox”类型的“SetAttProperty”属性上设置“绑定”。只能在 DependencyObject 的 DependencyProperty 上设置“绑定”。

**那么我怎样才能将一个可附加的绑定`DependencyProperty`到另一个`DependencyProperty`**呢？

这是我到目前为止的单例代码（C#）：

```
public class DO : DependencyObject
{
  // Singleton pattern (Expose a single shared instance, prevent creating additional instances)
  public static readonly DO Instance = new DO();
  private DO() { }
  public static readonly DependencyProperty S1Property = DependencyProperty.Register(
    "S1", typeof(string), typeof(DO),
    new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender));
  public string S1
  {
    get { return (string)GetValue(S1Property); }
    set { SetValue(S1Property, value); }
  }
  public static readonly DependencyProperty AttProperty = DependencyProperty.RegisterAttached( 
    "Att", typeof(string), typeof(DO), 
    new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender) );
  public static void SetAttProperty(DependencyObject depObj, string value)
  {
    depObj.SetValue(AttProperty, value);
  }
  public static string GetAttProperty(DependencyObject depObj)
  {
    return (string)depObj.GetValue(AttProperty);
  }
} 
```

这是有问题的事情（XAML）：

```
<TextBox Name="Input" Text="" TextChanged="Input_TextChanged" local:DO.AttProperty="{Binding Source={x:Static local:DO.Instance}, Path=S1}" /> 
```

**更新**

随着李博进的变化，错误消失了。但是仍然存在一个问题 - 如果我现在尝试在附加属性的帮助下更新单例，如下所示：

```
<TextBox local:DO.Att="{Binding Source={x:Static local:DO.Instance}, Path=S1, Mode=TwoWay}" Text="{Binding Path=(local:DO.Att), RelativeSource={RelativeSource Self}, Mode=TwoWay}"/> 
```

**为什么值没有传播到单例中的 S1？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:54:44.077

我认为您没有正确命名您的附加属性的获取/设置访问器，如此[处所述](http://msdn.microsoft.com/en-us/library/ms749011.aspx)。试试这个：

```
 public static readonly DependencyProperty AttProperty = DependencyProperty.RegisterAttached(
      "Att", typeof(string), typeof(DO),
      new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender));
    public static void SetAtt(DependencyObject depObj, string value)
    {
        depObj.SetValue(AttProperty, value);
    }
    public static string GetAtt(DependencyObject depObj)
    {
        return (string)depObj.GetValue(AttProperty);
    } 
```

示例绑定：

```
<TextBlock local:DO.Att="{Binding Source={x:Static local:DO.Instance}, Path=S1}"  Text="{Binding Path=(local:DO.Att),RelativeSource={RelativeSource Self}}"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T08:27:53.420

您需要实现 INotifyPropertyChanged 并将更改连接到依赖属性更改。

```
public class DO : DependencyObject,INotifyPropertyChanged {
        // Singleton pattern (Expose a single shared instance, prevent creating additional instances) 
        public static readonly DO Instance = new DO();
        private DO() { }
        public static readonly DependencyProperty S1Property = DependencyProperty.Register(
          "S1", typeof(string), typeof(DO),
          new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender,onS1Changed));

        private static void onS1Changed(DependencyObject d, DependencyPropertyChangedEventArgs e) {
            DO item = d as DO;
            if (item != null) item.OnPropertyChanged(new PropertyChangedEventArgs("S1"));
        }

        public string S1 {
            get { return (string)GetValue(S1Property); }
            set { SetValue(S1Property, value); }
        }
        public static readonly DependencyProperty AttProperty = DependencyProperty.RegisterAttached(
          "Att", typeof(string), typeof(DO),
          new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender,onAttChanged));

        private static void onAttChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) {
            DO item = d as DO;
            if (item != null) item.OnPropertyChanged(new PropertyChangedEventArgs("Att"));
        }

        public static void SetAttProperty(DependencyObject depObj, string value) {
            depObj.SetValue(AttProperty, value);
        }
        public static string GetAttProperty(DependencyObject depObj) {
            return (string)depObj.GetValue(AttProperty);
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void OnPropertyChanged(PropertyChangedEventArgs e) {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, e);
        }
   } 
```

# php - 如何使用php在文本中查找多个出现的标签？

> ID：10337492
> 
> 赞同：0
> 
> 时间：2012-04-26T16:27:29.060
> 
> 标签：php, find, preg-match, preg-match-all

我有一个使用 preg_match_all 的简单 php 示例

```
$str = " 
Line 1: This is a string 
Line 2: [img] image_path [/img] Should not be [img] image_path2 [/img] included. 
Line 3: End of test [img] image_path3 [/img] string."; 

preg_match_all("~\[img](.+)\[/img]~i", $str, $m); 

var_dump($m); 
```

我希望它回来

```
array(
    [0] =>image_path
    [1] =>image_path2
    [2] =>image_path3
) 
```

出于某种原因，我没有得到这个结果。

蚂蚁的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:31:32.450

将其更改为：

```
preg_match_all("~\[img](.+?)\[/img]~i", $str, $m); 

var_dump($m[1]); 
```

你需要的原因`?`是让它“非贪婪”。使用您的代码，它从第一个开始标记匹配到最后一个结束标记。`+`和运算符默认情况下是贪婪的`*`，消耗尽可能多的字符。`?`修饰符停止此行为。

您需要转储`$m[1]`而不是`$m`因为`preg_match*`也匹配整个匹配的字符串，而不仅仅是标记的捕获。

现场示例：http: [//ideone.com/vXk9W](http://ideone.com/vXk9W)

# c++ - 如何开发新的 Qt GUI 控件？

> ID：10337498
> 
> 赞同：1
> 
> 时间：2012-04-26T16:28:06.883
> 
> 标签：c++, qt

有一些 Qt 控件，如 QButton、QLabel 等。我可以开发新的 Qt GUI 控件，例如 QAccordion 或 Qribbon 控件吗？

这是如何完成的，我可以从哪里阅读和了解它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:31:50.730

[您可以通过继承 QWidget](http://qt-project.org/doc/qt-4.8/QWidget.html)或现有 QWidget 子类来创建自己的小部件（例如，[QFrame](http://qt-project.org/doc/qt-4.8/qframe.html)）

不过，老实说，在这个阶段，我建议您先熟悉 Qt 的工作原理，然后再尝试创建全新的小部件。有几本关于 Qt 的书，我最喜欢的是[这本](https://rads.stackoverflow.com/amzn/click/com/0131872494)，除其他外，它向您展示了如何创建自己的小部件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T17:02:49.000

> 我可以开发新的吗

是的。

> 如何开发新的自己的 qt gui 控件？
> 
> 我在哪里可以阅读和学习？

您应该阅读[qt 文档](http://doc.qt.io/)。文档非常好，所以没有理由不阅读它。

[模拟时钟](https://doc.qt.io/archives/4.6/widgets-analogclock.html)示例展示了如何创建自定义小部件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:42:29.100

在这里你可以看到如何使用它 qtdesigner [http://doc.qt.io/qt-4.8/designer-creating-custom-widgets.html](http://doc.qt.io/qt-4.8/designer-creating-custom-widgets.html)

# iphone - 将图像从 Iphone 上传到 WCF 服务：流还是 REST？

> ID：10337499
> 
> 赞同：0
> 
> 时间：2012-04-26T16:28:07.180
> 
> 标签：iphone, wcf, image, upload

我用谷歌搜索了很多这个问题，我有点困惑。我需要将图像从 Iphone 上传到 WCF 服务。我已经有一个正在工作的 WCF，它以“流”模式接收图像。但我在某处读到必须使用 REST WCF 才能在 iphone 上工作。我应该怎么办？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T18:35:04.837

If you're uploading a image "as is" from the iPhone, I imagine that you're already using the REST mode in WCF to do that. If your service endpoint uses the `webHttpBinding` and has a `webHttpBehavior` added to it, then you're already in the "WCF REST" realm (the official name is "WCF WebHTTP Endpoints", but it's more known as WCF REST endpoints).

Even if you're not using WCF REST, if what you have is working for you, then you're fine.

# multilingual - TYPO3：添加了新语言并找不到 404 页面

> ID：10337500
> 
> 赞同：0
> 
> 时间：2012-04-26T16:28:07.327
> 
> 标签：multilingual, typo3, typoscript, realurl

我在 TYPO3 项目中添加了一种新的网站语言。新的网站语言有`id=2`. 但是如果我打电话给`www.your-domain.com/hr.html`我`404 - page not found`（通常应该出现翻译语言的起始页）。菜单也显示不带`/hr/`. 我可以用`http://www.your-domain.com/index.php?L=2`. Typo3 的配置看起来像

```
config {
    linkVars = L 
    sys_language_mode = content_fallback
    sys_language_overlay = hideNonTranslated
    sys_language_uid = 0
    language = de
    locale_all = de_DE
    htmlTag_langKey = de-DE
}

[globalVar = GP:L=1]
config {
     sys_language_uid = 1
     language = en
     local_all = en_GB
     htmlTag_langKey = en-GB
}
[global]

[globalVar = GP:L=2]
config {
     sys_language_uid = 2
     language = hr
     local_all = hr_HR
     htmlTag_langKey = hr-HR
}
[global] 
```

RealURL 配置是

```
'preVars' => array (
    '0' => array (
        'GETvar' => 'no_cache',
        'valueMap' => array (
            'nc' => '1',
        ),
        'noMatch' => 'bypass'
    ),
    '1' => array (
        'GETvar' => 'L',
        'valueMap' => array (
            'de' => '0',
            'en' => '1',
                'hr' => '2',
        ),
            'valueDefault' => 'de',
        'noMatch' => 'bypass',
    ),
        '2' => array (
        'GETvar' => 'lang',
        'valueMap' => array (
            'de' => '0',
            'en' => '1',
                'hr' => '2',
        ),
            'valueDefault' => 'de',
        'noMatch' => 'bypass',
    ), 
```

对我来说，看起来一切都应该正常工作，但事实并非如此。我还清除了 RealURL 缓存

```
 $TYPO3_CONF_VARS['SC_OPTIONS']['t3lib/class.t3lib_tcemain.php']['clearAllCache_additionalTables']['tx_realurl_urldecodecache'] = 'tx_realurl_urldecodecache'; 
    $TYPO3_CONF_VARS['SC_OPTIONS']['t3lib/class.t3lib_tcemain.php']['clearAllCache_additionalTables']['tx_realurl_urlencodecache'] = 'tx_realurl_urlencodecache'; 
    $TYPO3_CONF_VARS['SC_OPTIONS']['t3lib/class.t3lib_tcemain.php']['clearAllCache_additionalTables']['tx_realurl_pathcache'] = 'tx_realurl_pathcache'; 
```

并`localconf.php`按下`Clear all caches`按钮。我正在使用 realurl 1.12.1 和 Typo3 4.5.5。我也看了看`htaccess`，没有发现什么特别的。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T14:18:50.067

页面上`urltool`已删除，但包含的`urltoolconf_realurl.php`仍然存在（使用旧设置）。这包括`localconf.php`覆盖了我的设置`realurl_conf.php`（包括新语言）。

但仍有一些菜单`index.php?id=69&L=2`在 URL 中而不是在说话的 URL 中。所以它们是指向其他页面的链接，我必须再次设置链接并确保有可用的翻译（即使在文件夹中......）。

# objective-c - 我应该使用哪种类型来保存具有相同密钥的许多对象？(iOS)

> ID：10337505
> 
> 赞同：0
> 
> 时间：2012-04-26T16:28:18.093
> 
> 标签：objective-c, ios

我应该使用哪种类型来保存具有相同密钥的许多对象？

我应该将数据发布到其中一个参数是建议的服务器并且它包含用户 ID。这个参数应该不止一个。所以我很困惑我应该使用哪种数据类型来保存它们。例如数组或字典应该看起来像

```
{
  @"suggestedTo" = 111,
  @"suggestedTo" = 222,
  @"suggestedTo" = 333,
  etc.
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:35:18.713

这通常使用集合字典（或数组，如果数据是有序的）来处理。所以在这种情况下，你会有类似的东西：

```
NSSet *suggestedTo = [NSSet setWithObjects:[NSNumber numberWithInt:111],
                                           [NSNumber numberWithInt:222],
                                           [NSNumber numberWithInt:333], nil];
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:suggestedTo,
                                                                @"suggestedTo", nil]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:34:32.333

您可以使用数组字典

```
NSArray      *suggestedTos = [[NSArray alloc] initWithObjects:
                               [NSNumber numberWithInt:111],
                               [NSNumber numberWithInt:222],
                               [NSNumber numberWithInt:333], nil];

NSDictionary *myDictionary = [[NSDictionary alloc] initWithObjectsAndKeys:
                               suggestedTos, @"suggestedTo", nil]; 
```

# javascript - 从 JavaScript 数组中删除 HTML 代码？

> ID：10337509
> 
> 赞同：0
> 
> 时间：2012-04-26T16:28:31.173
> 
> 标签：javascript, jquery, html, youtube, href

嗨，我在名为 song 的 JavaScript 文件中有以下代码：

```
var marchMD = new Array();
marchMD[0] = ["Save the Best for Last - Vanessa Williams"];
marchMD[1] = ["Informer - Snow"];
marchMD[2] = ["The Sign - Ace of Base"];    

for (var i=0;i<marchMD.length; i++) {
    songList = songList + '<p><a href="#" id="songtext">' + marchMD[i] + '</a></p>';
}
$('#songs').html(songList); 
```

加载后，文件 youtube 中的后续 javaScript 会与上面的代码发生反应：

```
$(document).ready(function() {

    $('#songs p').click(function(e) {

        var $el = $(e.currentTarget);
        var search = $el.html();
        //alert(search);
        //return;

        var keyword = encodeURIComponent(search);
        var yt_url = 'http://gdata.youtube.com/feeds/api/videos?q=' + keyword + '&format=5&max-results=1&v=2&alt=jsonc';

        $.ajax({
            type:"GET",
            url: yt_url,
            dataType: "jsonp",
            success: function(response) {
                if(response.data.items) {
                    $.each(response.data.items, function(i, data) {
                        var video_id = data.id;
                        var video_frame = "<iframe width='420' height='315' src='http://www.youtube.com/embed/" + video_id + "' frameborder='0' type='text/html'></iframe>";
                        $("#ytVid").html(video_frame);
                    });
                } else {
                    $("#ytVid").hmtl("<div id='no'> No Video</div>");
                }
            }
        });
    });
}); 
```

我在上面的代码中的警报是一个测试，看看它是否会返回任何东西，它不会。但是，如果我从代码中删除 href html 标记，则此方法有效。我拥有它的原因是，当有人单击其中一首歌曲时，它会将他们带到页面顶部以在 youtube 中查看该歌曲。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:35:12.837

如果您知道包含您的链接的元素只会包含您的链接，您可以使用`text()`去除 HTML 格式，如下所示：

```
 var search = $el.text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:46:07.447

当你`<a>`在那里时，也`var search = $el.html();`包括标签，而不仅仅是文本。尝试这个：

```
 $('#songs p').click(function(e) {
        var search = $(this).find('a').html(); 
```

# c - 如何在 GtkEntry 中选择文本

> ID：10337513
> 
> 赞同：5
> 
> 时间：2012-04-26T16:28:38.517
> 
> 标签：c, gtk, gtkentry

我有带有 GtkEntry 的对话框窗口。我想在对话框窗口对用户可见后立即选择条目中的所有文本。我试过这个，但它不起作用，我看不到任何选择：

```
static void OnEntryShow(GtkWidget *entry, gpointer user_data)
{
     gtk_editable_select_region(GTK_EDITABLE(entry), 0, -1);
}
...
gtk_entry_set_text(GTK_ENTRY(myEntry), "text");
g_signal_connect(myEntry, "show", G_CALLBACK(OnEntryShow), NULL);
if (gtk_dialog_run(GTK_DIALOG(myDialog)) == GTK_RESPONSE_OK)
... 
```

GtkDialog 变得可见后，如何在 GtkEntry 中选择文本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T22:37:09.650

也许您希望 GtkEntry 获得焦点？

尝试这个：

```
gtk_widget_grab_focus (entry); 
```

`entry`在这种情况下，指向您的 GtkEntry 小部件的指针在哪里。

该函数的文档可以在[这里](http://developer.gnome.org/gtk/stable/GtkWidget.html#gtk-widget-grab-focus)找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-25T20:16:21.113

您应该使用[此处](https://developer.gnome.org/gtk3/stable/GtkEditable.html#gtk-editable-select-region)记录的功能。

`text_entry.select_region(0,2)`将选择前两个字符，而`(0, -1)`将选择整个文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-20T04:38:06.557

这是我使用`get_iter_at_offset`and`select_range`函数用于 gtkmm 的解决方案。

```
Gtk::TextIter match_start = m_textBuffer->get_iter_at_offset(0);
Gtk::TextIter match_end = m_textBuffer->get_iter_at_offset(-1); // -1 to select all
m_textBuffer->select_range(match_start,match_end); 
```

# iphone - 屏幕上的CGRect网格？

> ID：10337515
> 
> 赞同：1
> 
> 时间：2012-04-26T16:28:53.060
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone

我想在屏幕中心创建一个矩形网格，在边缘留下一些空间。之所以需要这样做，是因为我在随机点喷出不同的精灵，并且它们不断在吃掉其他精灵的顶部产生。所以我想如果有一种方法可以创建一个类来创建网格并返回一个随机矩形并将其标记为占用，只要精灵停留在该矩形中并在之后使其自由。

如果我能得到一些帮助或任何提示，那就太好了。也欢迎任何其他实现这一目标的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:51:39.390

您可以嵌套两个`for`循环，一个用于行，一个用于列，使它们都运行 5 次，并在每个循环中将 x 位置和 y 位置增加屏幕宽度和高度的五分之一，并将这些坐标放入`CGRrect`. 那会做你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T04:11:18.767

感谢@andrewx 的帮助。这将在给定范围内创建 CGRect ，然后返回一个随机值。

```
-(void) makeCGRectArray{

rectsArray = [[NSMutableArray alloc] init];

for (int x = 30; x<=420; x= x+60) {
    for (int y=40; y<=280; y=y+40) {

        CGRect newRect = CGRectMake(x, y, 60, 40);
        [rectsArray addObject:[NSValue valueWithCGRect:newRect]];
    }
}

[self getRandomCgrect:rectsArray];

}

 -(CGRect) getRandomCgrect:(NSMutableArray*) rectArray{

    NSInteger randomPoint = (arc4random() % (49));

    CGRect randomRect = [[rectsArray objectAtIndex:randomPoint] CGRectValue];

    self.isOccupied = YES;
    return randomRect;
} 
```

# php - PHP和MySQL的初学者问题

> ID：10337516
> 
> 赞同：0
> 
> 时间：2012-04-26T16:28:55.057
> 
> 标签：php, mysql, html, css

我对 PHP 和 MySQL 很陌生。只是为朋友设计网站作为一种爱好，因此非常感谢任何帮助。当我的页面上有一个简单的联系表格时，我在提交信息时不断收到错误消息。这是PHP：

```
<?php
$con = mysql_connect("localhost","user","password");
if (!$con))  {
die('Could not connect: ' . mysql_error());
 }

mysql_select_db("database_name", $con);

$sql="INSERT INTO contact (first_name, last_name, email, phone, message)
VALUES
('$_POST[first_name]','$_POST[last_name]','$_POST[email]','$_POST[phone]','$_POST[message])";

if (!mysql_query($sql,$con)) {
die('Error: ' . mysql_error());
}
echo "1 record added";

mysql_close($con);
?> 
```

我在必要时输入了我的用户名和密码，但我将“localhost”保留在那里。这个对吗？我通过 webhostingpad 托管。我还在上面插入了我的数据库名称。这是我的 HTML：

```
<!--Start of order form-->

<form id="contactform" method="POST" action="http://www.talephotography.com/insert.php">
<p><label>First Name:<br />
<input type="text" name="first_name" class="textfield" value="" />
</label></p>

<p><label>Last Name:<br />
<input type="text" name="last_name" class="textfield" value="" />
</label></p>

<p><label>Email: <br />
<input type="text" name="email" class="textfield" value="" />
</label></p>

<p><label>Phone: <br />
<input type="text" name="phone" class="textfield" value="" />
</label></p>

<p><label>Message: <br />
<textarea name="message" class="textarea" cols="45" rows="5"></textarea>
</label></p>

<p><input type="submit" name="submit" class="button" value="Submit" /></p>
</form>
<!--End of order form--> 
```

我可以在任何需要的地方详细说明。

* * *

更改了一些代码，但它只是将电子邮件地址发布到数据库。

```
mysql_select_db("databasename", $con);

$first = mysql_real_escape_string($_POST['first']);
$last = mysql_real_escape_string($_POST['last']);
$email = strip_tags(mysql_real_escape_string($_POST['email']));
$number = preg_replace('/[^0-9]/', '', $_POST['number']);
$number =  (int) $number;

$sql="INSERT INTO contact (first, last, email, phone);
VALUES
('$first','$last','$email','$number')"; 
```

这是我的代码，但是当我检查我的数据库时，列出的唯一信息是电子邮件地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:31:40.477

`localhost`如果数据库服务器与 Web 服务器在同一台机器上，则该选项是正确的。当您设置数据库时，它应该在某个地方告诉您需要连接的内容。

除此之外，**逃避你的-----------ing输入！！！！**

说真的，把这些变量彻底清洗干净[`mysql_real_escape_string`](http://php.net/mysql-real-escape-string)，然后将它们**连接**到查询中。你以后会感谢我的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T09:49:27.200

它的查询是错误的，你有一个 ; 那是在您的查询中间。

```
$sql="INSERT INTO contact (first, last, email, phone);
   VALUES
('$first','$last','$email','$number')"; 
```

请注意它在第一行的末尾。将其更改为：

```
$sql="INSERT INTO contact  VALUES
('$first','$last','$email','$number')"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T11:38:57.430

问题出在你的第三行

```
$con = mysql_connect("localhost","user","password");
if (!$con))  {
die('Could not connect: ' . mysql_error());
} 
```

第三行有一个额外的右括号`)`。删除它，然后瞧！

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:48:00.847

`)`您的 if 语句中有一个额外的内容：

```
if (!$con))  { 
```

应该

```
if (!$con)  { 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T17:14:42.753

```
 if (!$con)) it is wrong one extra ')' present here, remove ')' and then execute 
```

例如

```
 if (!$con){

        //do something

           } 
```

# php - 如何排除函数中需要的变量？

> ID：10337520
> 
> 赞同：0
> 
> 时间：2012-04-26T16:29:17.397
> 
> 标签：php, function

如何排除函数中需要的变量？

IE：

```
function foo($name,$address,$pizza_preference,$date)
{
if(!$pizza_preference)
{
return array($name,$address,$date);    
}
else
{
return array($name,$address,$pizza_preference,$date);
}
} 
```

调用此函数时，我将如何设置它`$pizza_preference`不是必需的，而是可选的？因此，如果您只在函数中输入 3 个参数，它会省略`$pizza_preference`，或者我是否必须这样做，所以当您输入 0 时它不会返回它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:30:45.113

只需为其定义一个默认值。然后您可以使用该函数而不传递值：

```
function foo($name,$address,$date,$pizza_preference=null)
{
    if(!$pizza_preference)
    {
        return array($name,$address,$date);    
    }
    else
    {
        return array($name,$address,$pizza_preference,$date);
    }
} 
```

通常将具有默认值的变量放在参数列表的末尾，这样在调用函数时就不必包含空白参数。

有关更多信息，请参阅PHP 网站上的[默认参数值。](http://www.php.net/manual/en/functions.arguments.php#functions.arguments.default)

**更新**

如果您将有多个具有默认值的参数并希望能够单独跳过它们，您可以将数组作为唯一参数传递并从那里读取值：

```
function foo(array $parameters)
{
    if(!$parameters['pizza_preference'])
    {
        return array($parameters['name'],$parameters['address'],$parameters['date']);    
    }
    else
    {
        return array($parameters['name'],$parameters['address'],$parameters['date'],$parameters['pizza_preference']);  
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:43:12.330

我建议（而且我总是这样做）将参数作为 Object..

```
function foo($params)
{
  if(!$params->pizza_preference)
  {
    return array($pizza_preference->name,$pizza_preference->address,$pizza_preference->date);    
  }
  else
  {
    return array($pizza_preference->name,$pizza_preference->pizza_preference->address,$pizza_preference,$pizza_preference->date);
  }
} 
```

示例用法：

```
$p1 = new stdClass;
$p1->name = 'same name';
$p1->address ='same address';
$p1->pizza_preference = '1';
$p1->date = '26-04-2012';

$p2 = new stdClass;
$p2->name = 'same name';
$p2->address ='same address';
$p2->date = '26-04-2012';

foo($p1); //will return the first array
foo($p2); //will return the second array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:37:33.817

作为一种替代方法，您可以使用关联数组作为单个参数，然后在函数内部检查它，如下所示：

```
function foo($args) {
    $name = (!empty($args['name']) ? $args['name'] : NULL);
    $address = (!empty($args['address']) ? $args['address'] : NULL);
    $pizza_preference = (!empty($args['pizza_preference']) ? $args['pizza_preference'] : NULL);
    $date = (!empty($args['date']) ? $args['date'] : NULL);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:31:32.587

那么你需要更改签名......不需要的任何东西都应该放在最后：

```
function foo($name, $address, $date, $pizza_preference = null) {

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:31:48.000

您可以在函数声明中设置默认值：

```
function foo($name,$address,$date,$pizza_preference=null)
{
   if($pizza_preference === null)
   {
      return array($name,$address,$date);    
   }
   else
   {
      return array($name,$address,$pizza_preference,$date);
   }
} 
```

# c++ - 如何在 Oracle PRO*C 中按名称绑定

> ID：10337523
> 
> 赞同：1
> 
> 时间：2012-04-26T16:29:23.527
> 
> 标签：c++, sql, oracle, select, binding

我得到了一个带有绑定变量的查询，其中同一个绑定变量多次出现，例如：

```
select *
  from some_table
  where param1 = :parm1 and
        applied_date = (select min(applied_date)
                          from some_table
                          where param1 = :parm1) 
```

当我在 sqlplus 中运行此查询时，Oracle 似乎是按名称绑定的。ie 认识到 parm1 的第一次和第二次出现是同一个参数，并且只提示我一次 parm1 的值。但是，当我在我的 C++ 程序中将绑定变量描述到绑定描述符中时，它总是按位置绑定。

```
EXEC SQL DESCRIBE BIND VARIABLES FOR my_stmt INTO myBindDesc 
```

myBindDesc->F 的值是 2 而不是 1，在我填充它们之前，查询不会正确执行，即使它是相同的值。我的问题是：有没有办法在 PRO*C 中按名称绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:21:08.700

我无法确定导致此问题的原因，但您可以通过多种方式重写查询以仅使用 :VAR 一次。我希望这可以帮助你 - 如果不明白，至少解决你的问题：

```
SELECT *
FROM some_table tout
JOIN (
    SELECT MIN(param1) AS "param1_min", MIN(applied_date) AS "applied_date_min"
    FROM some_table
    WHERE param1 = :parm1
) taux ON (1=1
AND tout.param1 = taux.param1_min
AND tout.applied_date = taux.applied_date_min
) 
```

# vb.net - 无法索引，因为它没有默认属性错误

> ID：10337524
> 
> 赞同：2
> 
> 时间：2012-04-26T16:29:24.053
> 
> 标签：vb.net, winforms

你好，我在 VB NET 中比较新。所以，也许我的问题会显得幼稚。

VB代码：

```
 Public Class InputBox
  Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)   Handles Button1.Click

Dim a, b, S, p
    a = InputBox("Enter length")
    b = InputBox("Enter width")
    S = a * b                           
    p = a + a + b + b               
  End Sub

End Class 
```

在 InputBox 行中我收到此错误：

```
 Class 'LearningVB.InputBox' cannot be indexed because it has no default property 
```

这个错误是什么意思？

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:31:15.167

`InputBox`是一个*类*，如此处声明：

```
Public Class InputBox 
```

如果您尝试使用[内置的 VB 辅助函数](http://msdn.microsoft.com/en-us/library/6z0ak68w%28v=vs.90%29.aspx)，我怀疑您需要*更改*类的名称（这听起来是个好主意）*或*完全限定函数调用。（老实说，我什至不完全确定你会怎么做……）

# php - 头部标签显示在 CakePhp 上的主体内部

> ID：10337532
> 
> 赞同：2
> 
> 时间：2012-04-26T16:29:56.460
> 
> 标签：php, html, cakephp, tags

我在 CakePhp 2.0 上有一个奇怪的错误，其中 head 标签呈现为空，并且属于 head 的所有标签在任何内容之前呈现到正文中。

这是布局 default.ctp 的样子：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <?php echo $this->Html->charset(); ?>
    <title>
        <?php echo $title_for_layout; ?>
    </title>
    <?php
        echo $this->Html->meta('icon');
        echo $this->Html->script(array('librerias/jquery.tools.min'));
        echo $this->Html->css('cake.generic');
        echo $this->Html->css('webfront');
        echo $scripts_for_layout;
    ?>
</head>
<body>
    <div id="container">
        <div id="header">
        </div>
(the rest of the html render)
</body>
</html> 
```

正如萤火虫所说，这就是它的渲染方式：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
<body>
&#65279;&#65279;
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title> Usuarios </title> **(IE moves the title tag on the head manually, it seems)**
    **(IE displays the DOCTYPE on its debugging console here)**
    <link rel="icon" type="image/x-icon" href="/web/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/web/favicon.ico">
    <script src="/web/js/librerias/jquery.tools.min.js" type="text/javascript">
    <link href="/web/css/cake.generic.css" type="text/css" rel="stylesheet">
    <link href="/web/css/webfront.css" type="text/css" rel="stylesheet">
    <div id="container">
        <div id="header"> </div>
        (the rest of the html render)
</body>
</html> 
```

这已经够糟糕了，因为它会扭曲 DOCTYPE 标记并使 IE 呈现页面非常错误。

另外，我有另一个测试站点，它不会发生此错误。事实上，我切换了布局，错误是一样的。

有人知道为什么会这样吗？我在网上找不到类似的东西，我对此一无所知。任何帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:10:38.947

终于我们得到了这个问题的答案。出现在 utf-8 编码中的是 Cake 的 php 和臭名昭著的字符 ﻿。通过更改在最终布局之前传递的 php 文件的每个编码，我们解决了这个问题。

谢谢你的帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-13T08:09:35.030

你有 BOM char 的文件。使用 BOM Detector 程序

java : [http://www.javapractices.com/topic/TopicAction.do?Id=257](http://www.javapractices.com/topic/TopicAction.do?Id=257) [推荐][查找并删除]

1- 检查 URL 是否存在 BOM
2- 从文件
php 中删除 BOM：http: [//www.dotvoid.com/2010/04/detecting-utf-bom-byte-order-mark/](http://www.dotvoid.com/2010/04/detecting-utf-bom-byte-order-mark/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T05:45:59.207

您在布局文件中缺少一个结束标记。

```
 <body>
        <div id="container">
            <div id="header">
            </div>
    (the rest of the html render)
    </body>
    </html> 
```

应作如下修正

```
 <body>
        <div id="container">
            <div id="header">
            </div>
    (the rest of the html render)
        </div>
    </body>
    </html> 
```

# python - 在 numpy 数组中查找最大 N 个元素的快速方法

> ID：10337533
> 
> 赞同：56
> 
> 时间：2012-04-26T16:29:59.437
> 
> 标签：python, sorting, numpy

我知道我可以这样做：

```
import numpy as np
N=10
a=np.arange(1,100,1)
np.argsort()[-N:] 
```

但是，它非常慢，因为它进行了完整的排序。

我想知道 numpy 是否提供了一些快速完成的方法。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-11-24T17:50:20.710

`numpy 1.8`实现`partition`并`argpartition`执行部分排序（在 O(n) 时间内，而不是 O(n) * log(n) 的完整排序）。

```
import numpy as np

test = np.array([9,1,3,4,8,7,2,5,6,0])

temp = np.argpartition(-test, 4)
result_args = temp[:4]

temp = np.partition(-test, 4)
result = -temp[:4] 
```

结果：

```
>>> result_args
array([0, 4, 8, 5]) # indices of highest vals
>>> result
array([9, 8, 6, 7]) # highest vals 
```

定时：

```
In [16]: a = np.arange(10000)

In [17]: np.random.shuffle(a)

In [18]: %timeit np.argsort(a)
1000 loops, best of 3: 1.02 ms per loop

In [19]: %timeit np.argpartition(a, 100)
10000 loops, best of 3: 139 us per loop

In [20]: %timeit np.argpartition(a, 1000)
10000 loops, best of 3: 141 us per loop 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-04-26T16:35:58.790

该[`bottleneck`](http://pypi.python.org/pypi/Bottleneck)模块有一个快速的部分排序方法，可以直接使用 Numpy 数组：[`bottleneck.partition()`](http://berkeleyanalytics.com/bottleneck/reference.html#bottleneck.partition).

请注意，`bottleneck.partition()`返回排序后的实际值，如果您想要排序值的索引（`numpy.argsort()`返回的内容），您应该使用[`bottleneck.argpartition()`](http://berkeleyanalytics.com/bottleneck/reference.html#bottleneck.argpartition).

我进行了基准测试：

*   `z = -bottleneck.partition(-a, 10)[:10]`
*   `z = a.argsort()[-10:]`
*   `z = heapq.nlargest(10, a)`

其中`a`是一个随机的 1,000,000 元素数组。

时间安排如下：

*   `bottleneck.partition()`：每个循环 25.6 毫秒
*   `np.argsort()`: 每个循环 198 毫秒
*   `heapq.nlargest()`: 每个循环 358 毫秒

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-05-08T14:28:03.177

我遇到了这个问题，因为这个问题已经有 5 年了，我不得不重做所有基准测试并更改瓶颈的语法（现在已经没有`partsort`了`partition`）。

我使用了与 kwgoodman 相同的参数，除了检索到的元素数量，我增加到 50（以更好地适应我的特定情况）。

我得到了这些结果：

```
bottleneck 1: 01.12 ms per loop
bottleneck 2: 00.95 ms per loop
pandas      : 01.65 ms per loop
heapq       : 08.61 ms per loop
numpy       : 12.37 ms per loop
numpy 2     : 00.95 ms per loop 
```

因此，bottleneck_2 和 numpy_2（adas 的解决方案）被捆绑在一起。但是，使用`np.percentile`(numpy_2) 您已经对那些 topN 元素进行了排序，而其他解决方案并非如此。另一方面，如果您也对这些元素的索引感兴趣，则百分位数没有用。

我也添加了 pandas，它在下面使用瓶颈，如果有的话（[http://pandas.pydata.org/pandas-docs/stable/install.html#recommended-dependencies](http://pandas.pydata.org/pandas-docs/stable/install.html#recommended-dependencies)）。如果您已经有一个 pandas Series 或 DataFrame 开始，那么您就掌握得很好，只需使用`nlargest`就可以了。

用于基准测试的代码如下（请使用 python 3）：

```
import time
import numpy as np
import bottleneck as bn
import pandas as pd
import heapq

def bottleneck_1(a, n):
    return -bn.partition(-a, n)[:n]

def bottleneck_2(a, n):
    return bn.partition(a, a.size-n)[-n:]

def numpy(a, n):
    return a[a.argsort()[-n:]]

def numpy_2(a, n):
    M = a.shape[0]
    perc = (np.arange(M-n,M)+1.0)/M*100
    return np.percentile(a,perc)

def pandas(a, n):
    return pd.Series(a).nlargest(n)

def hpq(a, n):
    return heapq.nlargest(n, a)

def do_nothing(a, n):
    return a[:n]

def benchmark(func, size=1000000, ntimes=100, topn=50):
    t1 = time.time()
    for n in range(ntimes):
        a = np.random.rand(size)
        func(a, topn)
    t2 = time.time()
    ms_per_loop = 1000000 * (t2 - t1) / size
    return ms_per_loop

t1 = benchmark(bottleneck_1)
t2 = benchmark(bottleneck_2)
t3 = benchmark(pandas)
t4 = benchmark(hpq)
t5 = benchmark(numpy)
t6 = benchmark(numpy_2)
t0 = benchmark(do_nothing)

print("bottleneck 1: {:05.2f} ms per loop".format(t1 - t0))
print("bottleneck 2: {:05.2f} ms per loop".format(t2 - t0))
print("pandas      : {:05.2f} ms per loop".format(t3 - t0))
print("heapq       : {:05.2f} ms per loop".format(t4 - t0))
print("numpy       : {:05.2f} ms per loop".format(t5 - t0))
print("numpy 2     : {:05.2f} ms per loop".format(t6 - t0)) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-05-05T15:02:18.250

提出的瓶颈解决方案中的每个负号

```
-bottleneck.partsort(-a, 10)[:10] 
```

制作数据的副本。我们可以通过执行删除副本

```
bottleneck.partsort(a, a.size-10)[-10:] 
```

还有建议的numpy解决方案

```
a.argsort()[-10:] 
```

返回索引而不是值。解决方法是使用索引来查找值：

```
a[a.argsort()[-10:]] 
```

两种瓶颈解决方案的相对速度取决于初始数组中元素的顺序，因为这两种方法在不同点对数据进行分区。

换句话说，使用任何一个特定的随机数组进行计时可以使任何一种方法看起来都更快。

平均 100 个随机数组的时间，每个数组有 1,000,000 个元素，给出

```
-bn.partsort(-a, 10)[:10]: 1.76 ms per loop
bn.partsort(a, a.size-10)[-10:]: 0.92 ms per loop
a[a.argsort()[-10:]]: 15.34 ms per loop 
```

其中时序代码如下：

```
import time
import numpy as np
import bottleneck as bn

def bottleneck_1(a):
    return -bn.partsort(-a, 10)[:10]

def bottleneck_2(a):
    return bn.partsort(a, a.size-10)[-10:]

def numpy(a):
    return a[a.argsort()[-10:]]

def do_nothing(a):
    return a

def benchmark(func, size=1000000, ntimes=100):
    t1 = time.time()
    for n in range(ntimes):
        a = np.random.rand(size)
        func(a)
    t2 = time.time()
    ms_per_loop = 1000000 * (t2 - t1) / size
    return ms_per_loop

t1 = benchmark(bottleneck_1)
t2 = benchmark(bottleneck_2)
t3 = benchmark(numpy)
t4 = benchmark(do_nothing)

print "-bn.partsort(-a, 10)[:10]: %0.2f ms per loop" % (t1 - t4)
print "bn.partsort(a, a.size-10)[-10:]: %0.2f ms per loop" % (t2 - t4)
print "a[a.argsort()[-10:]]: %0.2f ms per loop" % (t3 - t4) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-04-26T16:34:54.627

也许`heapq.nlargest`

```
import numpy as np
import heapq

x = np.array([1,-5,4,6,-3,3])

z = heapq.nlargest(3,x) 
```

结果：

```
>>> z
[6, 4, 3] 
```

如果你想找到`n`最大元素的索引，`bottleneck`你可以使用 `bottleneck.argpartsort`

```
>>> x = np.array([1,-5,4,6,-3,3])
>>> z = bottleneck.argpartsort(-x, 3)[:3]
>>> z
array([3, 2, 5] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-05T22:44:06.780

您还可以使用 numpy 的百分位函数。在我的情况下，它比bottleneck.partsort（）稍微快一点：

```
import timeit
import bottleneck as bn

N,M,K = 10,1000000,100

start = timeit.default_timer()
for k in range(K):
    a=np.random.uniform(size=M)
    tmp=-bn.partsort(-a, N)[:N]
stop = timeit.default_timer()
print (stop - start)/K

start = timeit.default_timer()
perc = (np.arange(M-N,M)+1.0)/M*100
for k in range(K):
    a=np.random.uniform(size=M)
    tmp=np.percentile(a,perc)
stop = timeit.default_timer()
print (stop - start)/K 
```

每个循环的平均时间：

*   瓶颈.partsort()：59 毫秒
*   np.percentile()：54 毫秒

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-26T16:35:47.373

如果将数组存储为数字列表没有问题，您可以使用

```
import heapq
heapq.nlargest(N, a) 
```

获得`N`最大的成员。

# forms - IronPython 错误，当使用在 SharpDevelop 中创建的 ShowDialog() 方法时，“'TextBox' 对象没有属性 'text'”

> ID：10337534
> 
> 赞同：0
> 
> 时间：2012-04-26T16:30:01.360
> 
> 标签：forms, textbox, ironpython, sharpdevelop

我试图在另一个 IDE 中调用在 SharpDevelop 中设计的表单。我收到以下错误消息：“文本框”对象没有属性“文本”。当我在另一个 IDE 中运行包含下面显示的行的脚本时，就会发生这种情况。问题出在脚本本身还是在 SharpDevelop 中编写的 Form1 类中？我该如何解决这个问题？

```
import myform
import System

f = myform.Form1()
if f.ShowDialog() == System.Windows.Forms.DialogResult.OK:
    dx = f._directionx.text
    dy = f._directiony.text
    dz = f._directionz.text
    nb = f._nbofiterations.text
    w = f._width.text
    h = f._height.text 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:36:28.143

由于您似乎正在使用 IronPython（已将其`System.Windows.Forms`赠送），我猜您`TextBox`是 Forms 元素。

如果是这样，您需要该`.Text`属性 - .NET 库中的所有内容（我知道的属性、函数/方法）都以大写字母开头。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-06-08T19:41:22.270

将 .text 更改为 .Text dx = f._directionx.Text 等等 C sharp 是区分大小写的语言

# mysql - MySQL选择不同的不起作用

> ID：10337536
> 
> 赞同：1
> 
> 时间：2012-04-26T16:30:02.560
> 
> 标签：mysql

我有一个包含 1 个表的数据库，其中包含以下行：

```
id      name     date
-----------------------
1       Mike     2012-04-21
2       Mike     2012-04-25
3       Jack     2012-03-21
4       Jack     2012-02-12 
```

我只想提取不同的值，这样我只会得到 Mike 和 Jack 一次。我有一个搜索脚本的代码：

```
SELECT DISTINCT name FROM table WHERE name LIKE '%$string%' ORDER BY id DESC 
```

但它不起作用。它输出 Mike，Mike，Jack，Jack。

为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:43:43.423

由于该`ORDER BY id DESC`子句，该查询被视为编写而成：

```
SELECT DISTINCT name, id
  FROM table
 ORDER BY id DESC; 
```

除了这些`id`列不返回给用户（你）。结果集必须包含`id`才能按它排序。显然，这个结果集有四行，所以这就是返回的内容。（道德：不要按隐藏列排序——除非你知道它会对你的查询做什么。）

尝试：

```
SELECT DISTINCT name
  FROM table
 ORDER BY name; 
```

（根据心血来潮有或没有 DESC）。这将只返回两行。

如果您需要知道`id`每个名称的一个，请考虑：

```
SELECT name, MIN(id)
  FROM table
 GROUP BY name
 ORDER BY MIN(id) DESC; 
```

你可以使用 MAX 来达到同样好的效果。

所有这些都适用于所有 SQL 数据库，包括 MySQL。MySQL 有一些规则允许您省略 GROUP BY 子句，结果有些不确定。我建议不要利用该功能。

很长一段时间（甚至现在）SQL 标准不允许您按不在选择列表中的列进行排序，正是为了避免这样的混淆。当结果集不包含排序数据时，结果集的排序称为“本质排序”；如果排序列都出现在结果集中，这是“无关紧要的排序”，因为您有足够的数据来自己对数据进行排序。

# java - 将事件从自定义组件传递给父组件

> ID：10337539
> 
> 赞同：2
> 
> 时间：2012-04-26T16:30:15.480
> 
> 标签：java, swing

我有一个扩展 JComponent 的自定义组件。当您单击它时，它会使用 MouseListener 捕获事件。根据组件的状态和您单击的位置，存储在其中的数据会更新。

**发生这种情况时如何通知父容器，同时保持它完全独立？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:37:47.967

我自己，我会使用 JComponent 附带的 PropertyChangeSupport，然后在程序状态发生变化时触发你的 notify 方法。

例如：

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;

import javax.swing.*;

public class PropChangeEg {
   private static void createAndShowGui() {
      final JLabel counterLabel = new JLabel(" ", SwingConstants.CENTER);

      CustomComponent myCustomComponent = new CustomComponent();
      myCustomComponent.addPropertyChangeListener(new PropertyChangeListener() {

         @Override
         public void propertyChange(PropertyChangeEvent pcEvt) {
            if (pcEvt.getPropertyName().equals(CustomComponent.COUNTER)) {
               String text = "Counter: " + pcEvt.getNewValue();
               counterLabel.setText(text);
            }
         }
      });

      JFrame frame = new JFrame("PropChangeEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.add(myCustomComponent, BorderLayout.CENTER);
      frame.add(counterLabel, BorderLayout.PAGE_END);
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

@SuppressWarnings("serial")
class CustomComponent extends JComponent {
   public static final String COUNTER = "counter";
   private int counter = 0;

   public CustomComponent() {
      setLayout(new FlowLayout());
      add(new JButton(new AbstractAction("Increment Counter") {

         @Override
         public void actionPerformed(ActionEvent arg0) {
            setCounter(counter + 1);
         }
      }));
      add(new JButton(new AbstractAction("Decrement Counter") {

         @Override
         public void actionPerformed(ActionEvent arg0) {
            setCounter(counter - 1);
         }
      }));
   }

   //@Override // not needed!!
   //public void addPropertyChangeListener(PropertyChangeListener listener) {
   //   super.addPropertyChangeListener(listener);
   //}

   //@Override // not needed!!
   //public void removePropertyChangeListener(PropertyChangeListener listener) {
   //   super.removePropertyChangeListener(listener);
   //}

   public void setCounter(int counter) {
      int oldValue = this.counter;
      int newValue = counter;
      this.counter = newValue;
      firePropertyChange(COUNTER, oldValue, newValue);
   }

   public int getCounter() {
      return counter;
   }

} 
```

关于评论：

ChangeListener 也可以正常工作。1+ to user129 ...但我喜欢PCL的地方是我可以指定要监听的属性的名称，让我可以监听多个不同状态的变化，这样可以从MVC设计创建一个完整的视图与控制完全解耦。所以我的建议是：如果你只收听一个状态，那么一定要使用 ChangeListener，但如果你要收听多个状态，请使用 PCL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T17:13:03.033

你可以使用 ChangeListener 它应该为你工作

# c# - 建立在自定义流之上

> ID：10337548
> 
> 赞同：3
> 
> 时间：2012-04-26T16:30:41.887
> 
> 标签：c#, stream

我创建了一个基于无状态协议的流，认为 2 个 Web 服务器相互发送非常有限的请求。

因此，双方都不知道我是否突然停止，因为没有连接会关闭，根本不会有请求。请求中可能存在合法的差距，因此我不想将缺少它们视为失去联系。

我想要做的是发送一个心跳说“我还活着”，但当我从流中读取时，我显然不想要心跳数据，所以我的问题。

**如何创建一个新的流类来包装另一个流并发送心跳数据而不将其暴露给调用代码？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:37:09.167

假设双方有 2 个类似的实现：发送带有标头的每个数据块，以便您可以安全地发送零数据心跳块。即将外部流上的写入转换为内部流上的多个写入，例如“{Data, 100 bytes, [bytes]}, {Data, 13 bytes, [bytes]}”，心跳看起来像“{Ping, 0 bytes, [] }”。在接收端立即以类似的空 Ping 响应。

# android - 有时我的应用程序会崩溃，为什么？

> ID：10337550
> 
> 赞同：0
> 
> 时间：2012-04-26T16:30:47.723
> 
> 标签：android

就像标题所说的那样，我的应用程序偶尔会崩溃，我不确定它为什么会这样。

这是代码：

这是我得到输入的地方： public class SearchActivity extends Activity {

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.search);

    final EditText edittext = (EditText) findViewById(R.id.edittext);
    edittext.setOnKeyListener(new OnKeyListener() {
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // If the event is a key-down event on the "enter" button
            if ((event.getAction() == KeyEvent.ACTION_DOWN)
                    && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                // Perform action on key press
                String query = edittext.getText().toString();
                // gets the text and makes sure its a string
                Intent intent = new Intent(SearchActivity.this,
                        DissertationActivity.class);
                intent.putExtra("query1", query);
                startActivity(intent);

                return true;
            }
            return false;
        }
    });

    final Button button = (Button) findViewById(R.id.searchButton);
    button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            String query = edittext.getText().toString();
            // gets the text and makes sure its a string

            Intent intent = new Intent(SearchActivity.this,
                    DissertationActivity.class);
            intent.putExtra("query1", query);
            startActivity(intent);

        }
    });

}
 } 
```

// 检索结果的第二个活动

```
 public class DissertationActivity extends ListActivity {
/** Called when the activity is first created. */

public ArrayList<String> book_Array = new ArrayList<String>();
ArrayAdapter<String> adapter;

String href = "";
String href1 = "";
String search_Word = "";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Bundle extras = getIntent().getExtras();
    search_Word = extras.getString("query1");

    adapter = new ArrayAdapter<String>(this, R.layout.list_item_1,
            book_Array);
    setListAdapter(adapter);

    new LoadingProgressBar().execute();

}

class LoadingProgressBar extends AsyncTask<String, Integer, String> {

    ProgressDialog pDialog = new ProgressDialog(DissertationActivity.this);

    protected void onPreExecute() {
        this.pDialog.setMessage("Loading");
        this.pDialog.show();

    }

    @Override
    protected String doInBackground(String... params) {

        ListView lv = getListView();
        lv.setTextFilterEnabled(true);

        try {
            Document doc = null;
            Document guestLink = null;

            guestLink = Jsoup.connect("https://aulib.abdn.ac.uk:443/F")
                    .get();
            Element link = guestLink.select("p > a").first();
            href1 = link.attr("href");
            href = href1.substring(0, href1.length() - 2); // removes -0
                                                            // from
                                                            // the

            // href_Array.add(href); //adds href to the array because string
            // wont add to the public var.
            doc = Jsoup.connect(
                    href + "&request=" + search_Word
                            + "&find_code=WRD&adjacent=N&x=0&y=0").get();
            // System.out.println(doc);
            Elements headings = doc.select("td:eq(3)");
            // System.out.println(headings);
            for (Element heading : headings) {
                // System.out.println(heading.text());
                String j = heading.text();

                book_Array.add(j);

            }

        } catch (IOException e) {
            e.printStackTrace();

        }

        book_Array.remove(0);
        book_Array.remove(1);
        book_Array.remove(2);
        book_Array.remove("Search");
        book_Array.remove(" | ");
        book_Array.remove(0);

        pDialog.dismiss();

        lv.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> a, View v, int position,
                    long id) {

                int query = position;

                Intent intent = new Intent(DissertationActivity.this,
                        FullDetailsActivity.class);
                intent.putExtra("href", href);
                intent.putExtra("query1", (int) query);
                intent.putExtra("search_Word", search_Word);

                startActivity(intent);

            }

        });
        return null;
    }

} 
```

}

这是堆栈跟踪（对不起，我不知道如何格式化）：

```
04-26 17:17:20.722: E/WindowManager(8576):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
04-26 17:19:41.679: E/AndroidRuntime(8608): FATAL EXCEPTION: AsyncTask #5
04-26 17:19:41.679: E/AndroidRuntime(8608): java.lang.RuntimeException: An error occured while executing doInBackground()
04-26 17:19:41.679: E/AndroidRuntime(8608):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.lang.Thread.run(Thread.java:1019)
04-26 17:19:41.679: E/AndroidRuntime(8608): Caused by: java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:257)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.ArrayList.remove(ArrayList.java:406)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at com.library_app.DissertationActivity$LoadingProgressBar.doInBackground(DissertationActivity.java:102)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at com.library_app.DissertationActivity$LoadingProgressBar.doInBackground(DissertationActivity.java:1)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-26 17:19:41.679: E/AndroidRuntime(8608):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-26 17:19:41.679: E/AndroidRuntime(8608):     ... 4 more
04-26 17:19:41.879: E/WindowManager(8608): Activity com.library_app.DissertationActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@407aadc8 that was originally added here
04-26 17:19:41.879: E/WindowManager(8608): android.view.WindowLeaked: Activity com.library_app.DissertationActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@407aadc8 that was originally added here
04-26 17:19:41.879: E/WindowManager(8608):  at android.view.ViewRoot.<init>(ViewRoot.java:259)
04-26 17:19:41.879: E/WindowManager(8608):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
04-26 17:19:41.879: E/WindowManager(8608):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
04-26 17:19:41.879: E/WindowManager(8608):  at android.view.Window$LocalWindowManager.addView(Window.java:465)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.Dialog.show(Dialog.java:241)
04-26 17:19:41.879: E/WindowManager(8608):  at com.library_app.DissertationActivity$LoadingProgressBar.onPreExecute(DissertationActivity.java:59)
04-26 17:19:41.879: E/WindowManager(8608):  at android.os.AsyncTask.execute(AsyncTask.java:391)
04-26 17:19:41.879: E/WindowManager(8608):  at com.library_app.DissertationActivity.onCreate(DissertationActivity.java:49)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1722)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2953)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread.access$1600(ActivityThread.java:123)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:943)
04-26 17:19:41.879: E/WindowManager(8608):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-26 17:19:41.879: E/WindowManager(8608):  at android.os.Looper.loop(Looper.java:130)
04-26 17:19:41.879: E/WindowManager(8608):  at android.app.ActivityThread.main(ActivityThread.java:3835)
04-26 17:19:41.879: E/WindowManager(8608):  at java.lang.reflect.Method.invokeNative(Native Method)
04-26 17:19:41.879: E/WindowManager(8608):  at java.lang.reflect.Method.invoke(Method.java:507)
04-26 17:19:41.879: E/WindowManager(8608):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
04-26 17:19:41.879: E/WindowManager(8608):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
04-26 17:19:41.879: E/WindowManager(8608):  at dalvik.system.NativeStart.main(Native Method) 
```

它只会偶尔崩溃。它总是在我搜索某些东西之后。我还注意到，如果我使用手机上的按钮返回并尝试再次搜索某些内容，它会崩溃，不是每次都崩溃，而是偶尔崩溃。

什么会导致崩溃？我将如何解决它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:36:38.337

```
"Caused by: java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0" 
```

显示您正在尝试访问大小为 0（空）的数组

```
"at java.util.ArrayList.remove" 
```

告诉我它是由您试图从数组中删除项目引起的。

可能是以下行之一：

```
book_Array.remove(0);
book_Array.remove(1);
book_Array.remove(2);
book_Array.remove("Search");
book_Array.remove(" | ");
book_Array.remove(0); 
```

导致它，因为您没有检查任何地方以确保您的 book_array 实际上具有这些值。

```
at com.library_app.DissertationActivity$LoadingProgressBar.doInBackground(DissertationActivity.java:102) 
```

为您提供导致异常的确切行，因此您可以检查该行并确保在执行之前验证您的值。（在 logcat 中双击该行，如果您使用的是 Eclipse，它将带您到该行代码）

# c# - ASP.NET AJAX Slider 跳过步骤

> ID：10337551
> 
> 赞同：0
> 
> 时间：2012-04-26T16:30:52.773
> 
> 标签：c#, asp.net, .net, asp.net-ajax, ajaxcontroltoolkit

我们在一个页面上使用了多个滑块扩展器，并且在其中一些上它有点跳过步骤。例如，一个滑块的最小值为 0，最大值为 10，steps 属性设置为 10。但是当你滑动它时，它总是跳过 5，所以你从 1-4 开始，然后跳过 5，然后 6-10 . 所以你永远不能选择5。

页面上的许多滑块也会发生同样的情况（即使它们具有不同的最小值、最大值和步长值）。

知道我们搞砸了什么吗？

ASP:

```
<p>
<span class="helpText">Number Music stream per hour</span>
<asp:HyperLink ID="lnkMusicStream" runat="server"></asp:HyperLink>
<span class="maptextimg">
    <img class="helpTxtImg" src="~/html/images/buttons/help_icon.png" alt="help" title="<%=getNoOfMusicStreamHelpText() %>" />
</span>
<span class="numbers">
    <asp:Label ID="lblMusicIntervals" runat="server" />
</span>
</p>
<p>
<span>
    <asp:TextBox ID="txtMusicStream" runat="server" AutoPostBack="true" />
    <span class="size">
        <asp:Label ID="lbltxtMusicStream" runat="server" /></span>
    <ajaxToolkit:SliderExtender ID="txtMusicStream_SliderExtender" runat="server" TargetControlID="txtMusicStream"
        BehaviorID="txtMusicStream" BoundControlID="lbltxtMusicStream" EnableKeyboard="true"
        TooltipText="{0}" HandleCssClass="handleBar" HandleImageUrl="~/html/images/buttons/handle.png">
    </ajaxToolkit:SliderExtender>
</span>
</p> 
```

代码隐藏：

```
txtMusicStream_SliderExtender.Maximum = Sliders.GetSliderValues(SliderType.Streaming)["MaximumMusic"];
txtMusicStream_SliderExtender.Minimum = Sliders.GetSliderValues(SliderType.Streaming)["MinimumMusic"];
txtMusicStream_SliderExtender.Steps = int.Parse((txtMusicStream_SliderExtender.Maximum / Sliders.GetSliderValues(SliderType.Streaming)["MusicSteps"]).ToString());
txtMovieStream_SliderExtender.Steps = int.Parse((txtMovieStream_SliderExtender.Maximum / Sliders.GetSliderValues(SliderType.Streaming)["MovieSteps"]).ToString()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T12:31:34.510

我发现设置与“离散步骤”相关的步骤，它的实际含义有待明确定义（据我所知）。但是当滑块的最小值为 0 时，您需要在实际步数上加 1。

即：如果slider1.Max =5 和slider1.Min =0 和slider1.steps=5 那么值2 将被跳过以支持3。

如果我是对的，其背后的基本原理是它实际上将范围分成 2 个相等的部分，如果平均点是小数，它会将它四舍五入到更高的整数并跳转那个整数。

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T06:29:45.907

请验证您是否获得了正确的值，包括“5”，因为您的代码看起来不错。

尝试在您的页面中使用这种简单的方法，如果这有效，那么您肯定错过了一些东西：

```
<cc1:SliderExtender ID="SliderExtender1" BoundControlID="slider1_display" Decimals="0"
     runat="server" TargetControlID="slider1" EnableHandleAnimation="true"
    TooltipText="{0}">
</cc1:SliderExtender>
<asp:TextBox ID="slider1" runat="server"></asp:TextBox>
<asp:Label ID="slider1_display" runat="server"></asp:Label> 
```

代码背后：

```
SliderExtender1.Minimum = 0;
SliderExtender1.Maximum = 10; 
```

# macos - 在 Mac os x Lion 上构建和安装 Lua 5.2.0

> ID：10337558
> 
> 赞同：3
> 
> 时间：2012-04-26T16:31:13.457
> 
> 标签：macos, build, lua, installation

我已经阅读了很多网站上关于如何在 mac os x Leopard 而不是 Lion 上构建/安装 Lua 5.2.0 的说明。

所以我的问题是：“我如何从在我的 Mac 上安装和/或构建 Lua 到在我的计算机上编写代码？”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T18:01:06.887

改编自[Lua 常见问题解答](http://www.lua.org/faq.html#1.1)：

```
curl -R -O http://www.lua.org/ftp/lua-5.2.0.tar.gz
tar zxf lua-5.2.0.tar.gz
cd lua-5.2.0
make macosx test install 
```

你需要一个 C 编译器。如果您还没有，请获取 Xcode。

这适用于 Leopard 和 Lion（以及其他版本的 Mac OS X）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-19T01:17:54.297

我相信在这样做之前，你应该进入终端并输入 chmod a+x 然后它应该允许文件运行，并且没有那个 chmod 错误。

# c++ - C ++模板参数中的常量表达式

> ID：10337563
> 
> 赞同：1
> 
> 时间：2012-04-26T16:31:28.840
> 
> 标签：c++, templates, gcc, c++11

我有一个模板，它需要一个 char 参数，如：

```
A<'T'> 
```

我将我的 T 存储在一个变量中，例如：

`const char ch = str[0];`//str 是我程序中的一个字符串

`constexpr char ch = str[0];`// 这对我也不起作用

我正在努力实现这一目标：

```
A<ch>(); 
```

我正在使用 gcc 4.7 并涉足 constexpr 但我无法完成这项工作

有什么办法让这个工作吗？任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T16:34:19.497

这只有在*一切*都是常量表达式的情况下才有效：

```
constexpr char str[] = "Hello World";
constexpr char ch = str[0];
A<ch> x; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:34:27.130

如果 的内容`str`是在运行时定义的，那么就没有办法实现这一点。编译器要求您在编译期间设置模板值。

这就是为什么这是有效的：

```
A<'a'>(); 
```

因为`'a'`是一个常数值，在编译过程中是已知的。但是这个：

```
void foo(const std::string &value) {
    A<value[0]> t;
} 
```

不是，因为`value[0]`尽管 是一个常数值，但在编译期间是未知的。

# asp.net-mvc - 在 .NET Web 应用程序中可以安全地使用 dot-less 吗？

> ID：10337566
> 
> 赞同：0
> 
> 时间：2012-04-26T16:31:32.320
> 
> 标签：asp.net-mvc, less, dotless

我在徘徊，如果我们可以在 ASP.NET MVC 应用程序中安全地使用[Less Css for .NET 。](http://www.dotlesscss.org/)

它是否有设计师和开发人员应该意识到的关键缺点/缺点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T17:00:21.370

我是 dotless 的开发人员，我认为它有优势..

下面列出了 less.js 和 dotless 之间的区别。大多数是积极的差异。

[https://github.com/dotless/dotless/wiki/Less-js-differences](https://github.com/dotless/dotless/wiki/Less-js-differences)

如果您有任何疑虑，我还建议您查看我们的未解决问题列表。

[https://github.com/dotless/dotless/issues?labels=&milestone=&state=open](https://github.com/dotless/dotless/issues?labels=&milestone=&state=open)

关于 MVC，我们支持到 asp 3.5。对于 4.5，我们有一个[开放的 bug 来支持它](https://github.com/dotless/dotless/issues/148)，并且在那个 bug 中[提供了在 MVC 4.5 中使用它的要点](https://gist.github.com/2002958)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:35:06.517

是的，您可以安全地将 .less{} 与 ASP.NET MVC 应用程序一起使用。它在您的 web.config 中注册为 MVC 未处理的 .less 文件的处理程序，因此可以安全地路由到适当的处理程序。

您还可以在 Google 上快速搜索“dotless mvc”。有几个博客解释了如何正确配置您的应用以使用 .less{}。{}

# java - 如何使用 java web 服务上传文件

> ID：10337571
> 
> 赞同：-1
> 
> 时间：2012-04-26T16:31:50.003
> 
> 标签：java, web-services, file-upload

如何使用 java web 服务上传文件。

我尝试使用 FileUplaod java jar。但是失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:37:59.340

只是为了确定，你拼写`FileUpload`正确吗？

# c# - wcf 配置文件与代码配置的优缺点

> ID：10337573
> 
> 赞同：10
> 
> 时间：2012-04-26T16:31:51.483
> 
> 标签：c#, wcf, configuration

我有一个自托管的 C# WCF 服务，它为各种目的创建了 20 多个端点。每个都在代码本身中配置，并在服务的 app.config 中使用一些基本配置项，例如端口和地址。该服务非常适合经过测试的客户，但尚未经过广泛测试。

我对标准的 wcf 配置文件方法有点了解，因为我担心最终用户会把事情搞砸，因此一切都在代码中完成。

在配置文件中进行配置是一个更好的主意，因为这样最终用户可以根据他们的需要对其进行自定义，还是代码中的方法足以满足大多数需求？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T16:38:04.170

WCF 的主要好处之一是将连接细节从代码中抽象出来。如果您需要更改任何服务参数，可以更轻松地通过 web.config 进行更改，而无需重新编译。例如，您可能需要更改“端口和地址”。如果您从代码中执行此操作，则需要重新构建，这可能不切实际。此外，我不确定为什么最终用户会正常使用 web.config，除非确实有必要。

简而言之，除非您有充分的理由不使用配置文件，否则您应该使用它们以获得 WCF 提供的抽象的全部好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:40:56.247

你需要问自己一些问题

*   不同的开发者在他们的机器上有不同的价值观吗？
*   其他不使用 c# 的人是否必须更改这些设置值？（例如管理员）
*   以后是否需要针对性能调整某些值（例如消息大小）？

如果这些问题的答案是肯定的，那么您需要将设置移动到 .config 文件中。如果您担心了解其他设置的客户端会在意外中弄乱您的 wcf 设置，您始终可以通过将`configSource`属性添加到每个标签的 web.config 或 app.config 文件中来分离设置，并将部分配置放在单独的子目录中的文件，以减少意外更改的可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:41:30.583

简单地，

如果您使用该`.config`文件，那么您将能够在编译代码后更改配置。这可能是好是坏，取决于您的情况。

# php - 从搜索 php 脚本创建错误页面

> ID：10337579
> 
> 赞同：0
> 
> 时间：2012-04-26T16:32:21.433
> 
> 标签：php, mysql, search

如果出现错误，是否可以更改我的搜索脚本以将客户端引导到不同的页面？

我希望将它们定向到 search_error1.php，而不是出现文本“未找到结果！”。

我希望将它们定向到 search_error2.php，而不是出现“您尚未输入搜索字段”文本。

```
<?php

$error = '';

if (isset($_POST['Submit'])) {
if (!empty($_POST['reg'])) {

$record = $_POST['reg'];

$query = mysql_query("SELECT * FROM reg_add WHERE reg='" . mysql_real_escape_string($record) . "'");
$result = mysql_num_rows($query);

if ($result != 0) {

$row = mysql_fetch_array($query);

$first_name = $row['first_name'];
$last_name = $row['last_name'];
$reg = $row['reg'];

} else {$error = 'No result have been found!';}

} else {$error = 'You have not entered the search field, <a     href="javascript:history.back(1)">Go back</a>.';}

}

if (!empty($error)) { echo $error; } 

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:36:41.537

是的

采用`header()`

[http://se2.php.net/manual/en/function.header.php](http://se2.php.net/manual/en/function.header.php)

```
} else { header("Location: search_error1.php"); exit; }

} else { header("Location: search_error2.php"); exit; } 
```

您的代码（+ 预期）如下所示：

```
<?php
if (isset($_POST['Submit'])) {
    if (!empty($_POST['reg'])) {

        $record = $_POST['reg'];

        $query = mysql_query("SELECT * FROM reg_add WHERE reg='" . mysql_real_escape_string($record) . "'");
        $result = mysql_num_rows($query);

        if ($result != 0) {

            $row = mysql_fetch_array($query);

            $first_name = $row['first_name'];
            $last_name = $row['last_name'];
            $reg = $row['reg'];

        } else {
            header("Location: search_error1.php");
            exit;
        }

    } else {
        header("Location: search_error2.php");
        exit;
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:36:52.787

而不是`echo`ing 错误，使用标头重定向。例子。

`header("Location: search_error1.php");`

# mysql - 使用 MySQL 参考表的 SSIS 模糊查找

> ID：10337580
> 
> 赞同：1
> 
> 时间：2012-04-26T16:32:24.420
> 
> 标签：mysql, ssis

我是 SSIS 的新手。我的源数据库和目标数据库都是 MySQL 5.5。我能够设置示例测试 ssis 包以在 MySql db 之间运行。现在，我需要对数据流进行模糊查找。我的参考表也属于 MySQL。那么如何使用 MySQL 进行模糊查找呢？任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:26:05.340

模糊查找转换只能用于 SQL Server 数据源。您可以在 SQL Server 数据库中暂存 MySQL 数据。如果这是不可能的，这个线程列出了一些替代方案：

[如何使用 PHP 对 MYSQL 中的公司名称进行模糊匹配以实现自动完成？](https://stackoverflow.com/questions/369755/how-do-i-do-a-fuzzy-match-of-company-names-in-mysql-with-php-for-auto-complete)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T08:13:18.890

我发现以下文章对于设置模糊查找和分组非常有用，它们适用于 SQL Server，但我认为没有任何具体内容会阻止您使用 MySQL 服务器作为数据存储。

*   [http://www.sqlteam.com/article/using-fuzzy-lookup-transformations-in-sql-server-integration-services](http://www.sqlteam.com/article/using-fuzzy-lookup-transformations-in-sql-server-integration-services)
*   [http://www.bimonkey.com/2009/06/the-fuzzy-lookup-transformation/](http://www.bimonkey.com/2009/06/the-fuzzy-lookup-transformation/)
*   [http://msdn.microsoft.com/en-us/library/ms345128.aspx](http://msdn.microsoft.com/en-us/library/ms345128.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T14:56:34.077

过程完全一样，`source -> fuzzy lookup -> destination`不管来源是 SQL、mySQL 还是文本文件，模糊查找的行为都是一样的。

对 SQL Server 的限制是在查找时使用的引用表必须在 SQL Server 2000 或更高版本上

我知道的唯一仅限于 SQl Server 的任务是数据分析任务

# joomla - joomla 强制原始输出

> ID：10337582
> 
> 赞同：2
> 
> 时间：2012-04-26T16:32:31.953
> 
> 标签：joomla, joomla2.5

我如何在 joomla 2.5 中强制原始输出而不在 url 中传递 &format=raw ？

我试过这个`controller.php`

```
require_once (JPATH_BASE.DS.'libraries'.DS.'joomla'.DS.'document'.DS.'raw'.DS.'raw.php');
JFactory::$document = new JDocumentRaw();
//doesn't work, outputs only "Array" 
```

和

```
JRequest::setVar('tmpl', 'component');//doesn't disable view rendering 
```

和

```
$document = &JFactory::getDocument();
$doc = &JDocument::getInstance('raw');
$document = $doc;
//gives me Strict Standards: Only variables should be assigned by reference in ...
//and doesn't disable view rendering 
```

由于我打印原始输出，我什至不构建 Jview 和东西，只是`die()`从控制器，但我想看看是否有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T17:35:03.560

要更改文档类型并加载您需要的新渲染器（将“raw”更改为“yourDocType”）：

```
if (JRequest::getVar('format') != 'raw') {
    $url = JURI::current() . '?' . $_SERVER['QUERY_STRING'] . '&format=raw';
    header('Location: ' . $url);
    // or if you dont mind a text/html header ...
    // redirect($url);
} 
```

或者：

```
 JRequest::setVar('format','raw');
    JFactory::$document = null;
    JFactory::getDocument(); 
```

或者：

```
 JFactory::$document = JDocument::getInstance('raw'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-26T21:22:39.183

好吧，对我来说，我正在以其他方式做，没有生的，一切顺利

```
$mainfraim = & JFactory::getApplication();
        $idContact = JRequest::getVar('id_contact');
        $modelContact = $this->getModel('clientcontact');
        if($modelContact->delete($idContact))
            print "1";
        else 
            print "0";
        $mainfraim->close(); 
```

我打开 JFactory 我做任何我想做的事，然后我关闭它以获得结果如果你想要 JSON，我会回显我想要的任何东西，这很简单

```
 $matches = array_slice($matches, 0, 15);

        echo json_encode($matches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T18:02:46.957

您必须使用`setType`for`JDocument`而不是获取新实例。您还需要`view.raw.php`view 而不是`view.html.php`.

将下面的代码添加到您的控制器应该可以解决您的问题。

```
public function __construct()
{
    parent::__construct();

    $document = JFactory::getDocument();
    $document->setType('raw');
} 
```

* * *

您还可以创建自己的输出模板（例如`tmpl=max4ever`，代替`tmpl=component`）...并以您喜欢的方式自定义输出。[请参阅此线程中的答案](https://stackoverflow.com/questions/10248080/joomla-module-or-component-to-be-render-on-a-blank-page/10249535#10249535)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:38:40.013

有点晚了，但是当我需要这个的时候，我花了太多时间去打猎，所以听你说。

我使用这段代码来加载 Joomla 平台，它使“一切都可用”，然后根据我的需要编写自己的输出。就我而言，我希望“api”调用与我们拥有的另一个系统进行交互，所以把它放在我的根目录中（以及一些其他的安全检查），瞧——使用 JSON 或 XML 输出，这就成功了。

**在我的根目录中作为“index_api.php”**

```
// We are a valid Joomla entry point.
define('_JEXEC', 1);

// Setup the base path related constant.
define('JPATH_SITE', dirname(__FILE__));
define('JPATH_BASE', JPATH_SITE);
define('JPATH_PLATFORM', JPATH_BASE . '/libraries');

// Import the platform
require_once JPATH_PLATFORM.'/import.php';

define('DS', DIRECTORY_SEPARATOR);

if (file_exists(JPATH_BASE . '/includes/defines.php'))
    include_once JPATH_BASE . '/includes/defines.php';

if (!defined('_JDEFINES'))
    require_once JPATH_BASE.'/includes/defines.php';

require_once JPATH_BASE.'/includes/framework.php';

// Instantiate the application.
$app = JFactory::getApplication('site');

// Make sure that the Joomla Platform has been successfully loaded.
if (!class_exists('JLoader'))
    exit('Joomla Platform not loaded.');

/* Now try some standard Joomla stuff. None of the below is necessary, just showing that Joomla is loaded and running*/
$config = new JConfig();

$db = JFactory::getDbo();
$query = $db->getQuery(true);
$query->select('version_id');
$query->from('#__schemas');
$query->where('extension_id=700');
$db->setQuery($query);
$db->query();
if($db->getErrorNum()) {
    die($db->getErrorMsg());
}else{
    echo "<pre>Joomla Version is ".$db->loadResult()."</pre>";

}

echo "<pre>".print_r($config,true)."</pre>";
echo "<pre>".print_r($db,true)."</pre>";
echo "<pre>".print_r($app,true)."</pre>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-17T16:31:33.240

在您的查询字符串中，放置以下变量：

```
format=custom
view=viewName 
```

如果您有一个视图，例如名为`json`，您将在名为的视图父文件夹中创建视图文件夹：`json`

在其中放置视图文件并在文件名中使用格式类型。

```
view.json.php 
```

在您输入的 url 字符串中（例如）：

```
index.php?option=com_customcomponent&view=Json&format=json 
```

这将调用 json 视图并加载`view.json.php`视图文件。类名将是`customcomponentViewJson`

如果您实际使用的是 json 输出，则需要在文档上设置适当的 mime 标头。

```
$doc = JFactory::getDocument();
$doc->setMimeEncoding('application/json'); 
```

这是一篇关于在 Joomla 中使用 json 的好文章：http: [//docs.joomla.org/Generating_JSON_output](http://docs.joomla.org/Generating_JSON_output)

这适用于 Joomla 2.5，我认为是 1.5。如果格式设置为 html 或 xml 以外的任何内容，我认为 Joomla 假定原始输出类型并在没有站点模板的情况下发回组件响应。即您想要的原始响应，例如 json 消息。

这似乎没有很好的记录并且难以理解。我在这个问题上花了几个令人沮丧的时间，所以希望这对某人有所帮助。

# javascript - 替换标签内的第一个字符

> ID：10337586
> 
> 赞同：4
> 
> 时间：2012-04-26T16:32:49.963
> 
> 标签：javascript, jquery

如何使用jQuery将除最后一个标签字符$符号之外的每个标签的第一个字符更改为£？

这是代码：

```
<p align="center" id="myradio">
    <label>$25.00 </label>
    <input checked="checked" class="hide_input" name="amount" type="radio" value="25.00" />
    <label>$50.00</label>
    <input class="hide_input" name="amount" type="radio" value="50.00" />
    <label>$100.00</label>
    <input class="hide_input" name="amount" type="radio" value="100.00" />
    <label>$250.00</label>
    <input class="hide_input" name="amount" type="radio" value="250.00" />
    <label>$500.00</label>
    <input class="hide_input" name="amount" type="radio" value="500.00" />
    <label>$1000.00</label>
    <input class="hide_input" name="amount" type="radio" value="1000.00" />
    <label>other amount</label>
    <input class="show_input" id="other" name="amount" type="radio" value="" />
</p> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T16:35:54.410

您可以使用内部循环来交换字符：

```
$("#myradio label").html(function(){
    return this.innerHTML.replace( '$', '£' ); 
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:35:34.113

```
$("#myradio label:not(:last)").each(function() {
    $(this).text($(this).text().replace(/^\$/, "£"));
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T16:37:30.827

```
 $('#myradio label').each(function() {
       $(this).text('£' + $(this).text().substr(1));
    }); 
```

这基本上采用标签的子字符串，从第一个字符开始（直到结尾） - 这是没有 $ 符号的文本。并将其附加到英镑符号。此连接文本用于替换现有文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T16:39:29.133

```
$('#myradio label').html(function() {
   return this.innerHTML.replace(/^\$/,'£');
}); 
```

# php - 如何选择一个 Distinct 值，然后按使用 mysql 和 PHP 返回的金额排序？

> ID：10337590
> 
> 赞同：0
> 
> 时间：2012-04-26T16:33:08.340
> 
> 标签：php, mysql

好的，所以我尝试使用此[线程](https://stackoverflow.com/questions/4348024/how-to-return-distinct-values-and-their-count)上列出的解决方案，并且我得到了一些工作，但不是全部。我正在尝试显示不同的结果，然后按返回结果的数量排序。Soo 如果一个 ID 有 4 个调查的结果，它会显示 4。显然我可以这样做`myql_num_rows`但是，我不知道如何按该数量排序，所以它将显示为... 4 3 2 1 而不是.. 2 4 1 3

这是我到目前为止所拥有的，我认为我的 Select 语句是正确的，我只需要正确地回显它。

```
<?php
$query_db = ("SELECT DISTINCT SGSID FROM SGresult WHERE SGFACemail = '$email'");
$result = mysql_query($query_db, $surveys) or die(mysql_error());

$i = 0;
while ($row = mysql_fetch_assoc($result)) {

$SGSID = $row['SGSID'];
//INSERTED MODIFIED SELECT STATEMENT HERE
$query_check = ("SELECT SGpID, count(*) AS numCount FROM SGresult WHERE SGFACemail = '$email' AND  SGSID = '$SGSID' GROUP BY SGpID");

$result_c = mysql_query($query_check, $surveys) or die(mysql_error());
$row2 = mysql_fetch_array($result_c);
$SGpID = $row2[3];
echo $row2['numCount'];

//tried num_rows statement to return value of numCount
//$num_rows2 = mysql_num_rows($result_c, $row2['numCount']);
$num_rows = mysql_num_rows($result_c);

$query_name = ("SELECT * FROM SGsurveyID WHERE SGSID = '$SGSID'");

$result_F = mysql_query($query_name, $surveys) or die(mysql_error($surveys));
$name_row = mysql_fetch_row($result_F);

<?php echo $row2['numCount'];  //this returns results, but not the amount of rows 
  $i++;?>

  <tr>
        <td><?php echo $i;?></td>
        <td><?php echo $name_row[1];?></td>
        <td><?php echo $num_rows;  ?></td>
        <td> <?php echo $row2['numCount']; ?></td>
      </tr>
      <?php

} 
```

因此，回顾一下，我基本上是尝试对 DISTINCT 结果中返回的行数进行 GROUP BY AND ORDER BY 。

再次感谢您的帮助和指点。请原谅凌乱的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T18:10:32.333

利用`SELECT DISTINCT SGSID FROM SGresult WHERE SGFACemail = '$email' ORDER BY SGSID desc`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:55:11.990

您想同时使用 group by 和 order by 是对的。

我不认为 mysql 对语法上的组/顺序很严格，但如果这不起作用，请告诉我，我有点生疏了。

```
SELECT SGpID
  , count(*) AS numCount
FROM SGresult
WHERE SGFACemail = '$email' 
  AND  SGSID = '$SGSID' 
GROUP BY SGpID
ORDER BY numCount desc 
```

这是针对标有“ `//INSERTED MODIFIED SELECT STATEMENT HERE`”的查询。我很确定你可以从一个查询中得到你想要的所有东西，但我不太明白你想要做什么，也无法弄清楚你的模式是什么样的。

# c# - 使用 ravendb 构建警报系统的最佳实践

> ID：10337604
> 
> 赞同：1
> 
> 时间：2012-04-26T16:34:06.540
> 
> 标签：c#, ravendb

我想使用 ravendb 构建一个警报系统。

实际上我存储书籍如下：

```
public class Book
{
    public string Id { get; set; }
    public string Title { get; set; }
    public string Description {get;set;}
} 
```

用户可以创建一些与书名和描述相匹配的警报。

警报是这样定义的：

```
public class Alert
{
    public string UserId{get;set;}
    public string Keywords{get;set;}
} 
```

当一本书发布，或者一些编辑然后匹配用户警报时，我通知用户什么（通过电子邮件或类似的东西）。

因此，任何人都有最佳实践来建立一个有效的警报系统，而无需在每次发布或编辑一本书时循环所有警报并执行搜索查询以获得匹配的书？

编辑：我使用 Rhino.ESB 是为了在书籍发布或编辑时得到通知，我的问题不是关于如何获得书籍更新的通知。但实际上如何有效地将书籍与这些更新的警报相匹配。

编辑：StackOverFlow 似乎在标签上使用订阅机制来向用户发送与这些标签相关的问题的电子邮件。简要介绍这种机制应该是一个开始。任何的想法 ？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:01:09.737

约安，

你基本上做一个反向搜索。

```
public void Handle(BookUpdated msg)
{
    var book = Session.Load<Book>(msg.BookId);
    var alerts = Session.Query<Alerts>()
        .Search(x=>x.Keywords, book.Description)
        .ToList();

    // alert for book

} 
```

请注意，您需要正确进行分页，并考虑如果您有一本书有很多警报会发生什么。

# java - 如何使用反射检查对象的通用类型？

> ID：10337605
> 
> 赞同：4
> 
> 时间：2012-04-26T16:34:14.750
> 
> 标签：java, generics, reflection

我需要检查类的字段是否为`List<String>`. 我尝试使用以下代码来做到这一点：

```
for (Field formField : formClass.getDeclaredFields()) {    
  ...
  if (formField.getGenericType().equals((Class<List<String>>)(Class<?>)List.class)) {
    ...
  }
} 
```

这似乎是一个错误的代码，因为`formField.getGenericType().equals((Class<List<String>>)(Class<?>)List.class)`即使`false`在实际上是`List<String>`.

另一种方法是首先测试一个字段是否`List`带有，`formField.getType().equals(List.class)`然后检查它是否是通用的`formField.getGenericType() instanceof ParameterizedType`，最后检查类型参数的类。

但我认为有一种更短的方法来实现这种检查。在那儿？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T17:34:30.197

```
import java.lang.reflect.Field;
import java.lang.reflect.ParameterizedType;
import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.List;

public class Main {
    private List<String> strings;
    private List<ReflectionUtils> list;
    public static void main(String[] args) {
        List<Class> genericTypes = ReflectionUtils.getGenericType(Main.class);
        for(Class genericType : genericTypes) {
            System.out.println(genericType.getName());
        }
    }
}

class ReflectionUtils {
    public static List<Class> getGenericType(Class clazz) {
        List<Class> genericTypes = new ArrayList<Class>();
        Field[] fields = clazz.getDeclaredFields();
        for(Field field : fields) {
            Class c = getGenericType(field);
            if(c != null) {
                genericTypes.add(c);
            }
        }
        return genericTypes;
    }

    public static Class getGenericType(Field field) {
        Type genericType = field.getGenericType();
        if(genericType instanceof ParameterizedType) {
            ParameterizedType parameterizedType = (ParameterizedType) genericType;
            return (Class) parameterizedType.getActualTypeArguments()[0];
        }
        return null;
    }
} 
```

示例的输出：

```
java.lang.String
ReflectionUtils 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T19:39:43.480

您可以像这样使用[Guava](http://guava-libraries.googlecode.com)的新[TypeToken](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/reflect/TypeToken.html)类（将包含在 12.0 版中……它的候选发布版本目前在 Maven 中可用）：

```
for (Field formField : formClass.getDeclaredFields()) {    
  ...
  TypeToken<?> type = TypeToken.of(formField.getGenericType());
  if (type.equals(new TypeToken<List<String>>(){}) {
    ...
  }
} 
```

请注意，这仅在类字段实际声明为`List<String>`、 而不是`List<T>`或时才有效`ArrayList<String>`。如果您希望它匹配`ArrayList<String>`或实现任何其他类型，`List<String>`则可以改为执行以下检查：

```
if (new TypeToken<List<String>>(){}.isAssignableFrom(type)) { 
```

如果您正在处理的类是一个在其类型中指定是什么的子类，则实际上可以找出是否有一个在声明类中声明的`List<String>`字段。举个例子：`List<T>``T`

```
class Foo<T> {
  private List<T> list;
  ...
}

class StringFoo extends Foo<String> { // T is specified in here
  ...
}

TypeToken<StringFoo> stringFooType = TypeToken.of(StringFoo.class);
// iterate through superclasses of StringFoo
for (TypeToken<?> superclass : stringFooType.getTypes().classes()) {
  for (Field field : superclass.getRawType().getDeclaredFields()) {
    // actually resolves T to String for the List<T> field using info from
    // StringFoo's type
    TypeToken<?> type = stringFooType.resolveType(field.getGenericType());
    if (new TypeToken<List<String>>(){}.isAssignableFrom(type)) {
      System.out.println("List<String> found!");
    }
  }
} 
```

有更多信息`TypeToken`可用[here](http://code.google.com/p/guava-libraries/wiki/ReflectionExplained#TypeToken)。

# extjs4.1 - 覆盖extjs中的记录值

> ID：10337606
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:14.987
> 
> 标签：extjs4.1

我有以下代码

```
 var record = form.getRecord();
    var values = form.getValues();
    record.set(values); 
   // record.data.DeliveryFrom = "test1";
    record.set('DeliveryFrom', 'test2');
    record.save(); 
```

从表单中获取值后，我希望覆盖属性 DeliveryFrom。但是，当我在萤火虫 DeliveryFrom 中查看结果时，我为空。你会在上面看到我尝试了 2 种不同的方法来设置这个值。

我正在使用 extjs 4.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T17:42:29.930

这*应该*有效（假设`Ext.form.Basic)`如果不是（如果它`Ext.form.Panel`）形成它，那么使用`form.getForm()`：

```
var record = form.getRecord();
form.updateRecord(record); //We use update record, its almost the same as you were using but in just one call
record.beginEdit(); //Put the record in edit mode
record.set( 'DeliveryFrom', 'test2');
record.endEdit(); //End editing the record and commit changes
record.save(); //Commit changes to backend 
```

# c++ - 使用线程 C++ 停止 while 循环

> ID：10337610
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:26.483
> 
> 标签：c++, loops, while-loop, interrupt

我无法停止`KeyListener`函数中的 while 循环。该函数每 10 秒`Timer`声明`Active`一次`false`。但是函数`while`中的循环仍然`KeyListener`继续运行。

我不知道为什么循环继续运行；每个循环它都应该测试是否`Active`为真，如果不是（因为 10 秒后它应该被关闭），则循环不应该运行。但确实如此。

```
void KeyListener(bool Active)
{
    cout << Active << endl; //debug
    while (Active==true){ 
        cout << "loop still running." << endl; //debug
        Sleep(100);
        for (int i=8;i<=190;i++){ 
            if (GetAsyncKeyState(i) == -32767){
                KeyWrite(i); // (turns the numbers into characters)
            }       
        }
    }
}

void Timer(void* pParams){
    while (true){
        Sleep(10000); 
        KeyListener(false); // Active = false
        cout << "KeyListener(false)" << endl; // debug
    }
}

int main()
{
    _beginthread( Timer, 0, NULL ); 
    KeyListener(true);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:42:18.743

您的每个调用`KeyListener`都有自己的 Active 副本，因为它是一个函数参数。

您需要使这个值对两个线程都可用。它应该是一个全球性的。它需要被标记`volatile`，否则编译器会将值存储到寄存器中，并且永远不会从主内存中读取它，或者它甚至可能将其变成无限循环。

更好的方法是使用某种事件或条件变量，它们将被正确地线程同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:40:18.430

您有两个不同的线程调用相同的函数。这创造了两种*不同的* `Active`价值。

再次调用函数不会影响上一次调用的参数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:40:41.603

10 秒后，单独的线程调用`KeyListener(false)`. **这为该函数调用**设置`Active`了 false 。但是，原函数调用**不受影响**。新调用无法影响旧调用的非静态局部变量。**`KeyListener(true)`**

 ***** * *

```
volatile bool Active;

void KeyListener()
{
    cout << Active << endl; //debug
    while (Active==true){ 
        cout << "loop still running." << endl; //debug
        Sleep(100);
        for (int i=8;i<=190;i++){ 
            if (GetAsyncKeyState(i) == -32767){
                KeyWrite(i); // (turns the numbers into characters)
            }       
        }
    }
}

void Timer(void* pParams){
    while (true){
        Sleep(10000); 
        Active = false
        cout << "Active = false" << endl; // debug
    }
}

int main()
{
    Active = true;
    _beginthread( Timer, 0, NULL ); 
    KeyListener();

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:42:58.493

你说

> 每个周期都应该测试 Active 是否为真 这可能并非如此。编译器可能正在优化该比较，因为它没有看到对该块中的 Active 执行任何操作。我建议您对 Active 使用 volatile 说明符，以确保代码每次都检查 Active 的内存值。

```
volatile bool Active; 
```

编辑：另外，正如有人指出的那样，在您的 Timer 函数中，您出于某种原因调用 KeyListener(false)。您应该将 Active 设置为 false（已被注释掉）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:46:56.257

我很确定 Timer 调用的 KeyListener 函数与主函数调用不同。仅在主线程中调用 KeyListener，然后在您的另一个线程中，让它访问共享变量并将其设置为 false。****

# xml - 保存在 WCF 服务中创建的列表，以便在服务重新启动时查看它

> ID：10337612
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:29.207
> 
> 标签：xml, wcf, list, save

我有一个 WCF 服务，我想在其中保存一个在服务运行时创建的 XML 列表，以便在服务关闭后保存，即在重新启动服务时查看它。调用 HTTP POST 时会将项目添加到列表中。但是，当程序中返回列表项的 HTTP GET 方法在重新启动服务后被调用时，它不会显示列表项，因为它们没有保存。我与此问题相关的问题是：

1) 如何保存列表以供将来参考？2）是否有某种机制可以在每次服务关闭时保存此列表，以便在重新启动服务时可以查看？

还有一个指针：我不希望将列表项保存为本地机器上的 xml 文件！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T20:36:41.093

Tim 的建议是合理的，但是您不需要自定义服务主机来执行此操作。主要是将数据内容写入持久存储，在更新后的某个时间点。当您收到 POST 时，更新内存中的数据表示，然后将事物写入文件系统上的 xml 文件。

```
 public void DoPost()
  {
      UpdateData();
      SaveDataToFilesystem();
  } 
```

重新启动时，从文件中读取（如果存在）。

要处理并发，您必须在`Update()`and`Save()`方法中锁定数据。

如果系统负载很高，则将“写入文件文件系统”推迟到最多每 10 秒左右一次。

```
 public void DoPost()
  {
      UpdateData();
      QueueWriteToFilesystem();
  }

  private MyInternalDataType data;
  private DateTime lastWrite = new DateTime(1970,1,1); // init value
  private void QueueWriteToFilesystem()
  {
      ThreadPool.QueueUserWorkItem( MaybeWrite );
  }

  private int delayInMilliseconds = 1000 * 10; // 10 seconds
  private void MaybeWrite()
  {
      System.Threading.Thread.Sleep(delayInMilliseconds);
      lock (data)
      {
          var delta = System.DateTime.Now - lastWrite;
          if (delta < new System.TimeSpan(0, 0, 0, 0, delayInMilliseconds))
          {
              // less than 10s since last write
              // do nothing
              return;
          }
          ActuallySaveToFilesystem();
          lastWrite = System.DateTime.Now;
      }
  } 
```

对于真正的高并发性，您不希望在每个请求中都排队一个新的工作项。相反，您只需使用写入的专用线程。

```
 public void DoPost()
  {
      UpdateData();
      lastUpdate = System.DateTime.Now;
  }

  private void DedicatedWriter()
  {
      do
      {
          System.Threading.Thread.Sleep(delayInMilliseconds);
          lock (data)
          {
              var delta = lastUpdate - lastWrite;
              if (delta < new System.TimeSpan(0, 0, 0, 0, 200))
              {
                  // small amount of time since prior write;
                  // do nothing
                  return;
              }
              ActuallySaveToFilesystem();
              lastWrite = System.DateTime.Now;
          }
      } while (true);
  } 
```

您还可以使用 AutoResetEvents 来通知编写器线程唤醒。

# javascript - JQuery 附加标签没有 ID 或类

> ID：10337614
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:34.660
> 
> 标签：javascript, jquery

我有重复的**nobr**标签，我无法添加 ID 或 Class。

如何找到包含文本字符串的特定**nobr标签？**

```
<nobr>Due Date</nobr>
<nobr>Test</nobr>
<nobr>Hello</nobr>

$(document).ready(function() {
    $('<nobr>Due Date').append('<span class="ms-formvalidation" title="This is a required field." > *</span>');
}); 
```

如果我只是有：

```
 $("nobr").append("*"); 
```

那么所有的 nobr 都会受到影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:37:03.530

```
$('nobr').filter(function() {
  return $(this).text() == 'Due Date';
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:39:49.100

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

```
$(document).ready(function() {
  $("nobr:contains('Due Date')").append('<span class="ms-formvalidation" title="This is a required field." > *</span>');
}); 
```

工作示例：http: [//jsfiddle.net/EnigmaMaster/FkZcY/](http://jsfiddle.net/EnigmaMaster/FkZcY/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T16:43:11.907

```
$('nobr').get(1); // get the second one 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T16:36:11.753

像这样使用包含伪选择器

```
 $("nobr:contains(Test)").append("*"); 
```

这是文档：[http ://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T16:36:48.627

```
$("nobr").each(function() {
    if( $(this).text() == "hello world" ) {
       // this is the element with the text in it
    }
}); 
```

我不是 jQuery 人，可能有更好的解决方案。

# jquery - jQuery 在鼠标悬停时将图像放置在适当的位置

> ID：10337616
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:40.587
> 
> 标签：jquery, image, resize

我有一堆画廊图像，我显示为小缩略图（大约 50 像素大）。当用户将鼠标悬停在小图像上时，会“长出”一个更大的图像（最大 100 像素），这样他们就可以更好地看到它。

我有这段代码，它计算出图像在页面上的位置，在顶部应用另一个图像（绝对定位），然后增长它。

```
$(document).on("mouseover", "img.grow", function() {
    var iid = $(this).attr("id");
    var isr = $(this).attr("src");
    var loc = $(this).offset();
    $("body").append('<img class="grown" id="o' + iid + '" src="' + isr + '" style="position: fixed; z-index: 1505; top: ' + loc.top + 'px; left: ' + loc.left + 'px; width: 33px;" />');
    $(".grown").animate({
        width: '100px', 
        marginLeft: '-25',
        marginTop: '-15'
    }, 250);
}).on("mouseleave", "img.grow", function() {
    var iid = $(this).attr("id");
    $("img#o" + iid).fadeOut(100, function() {
        $(this).remove(); 
    });
}); 
```

不过，我得到了可怕的“反弹”——因为新图像被放置在原始图像之上，它会导致“鼠标离开”触发。显然我不希望这种情况发生，但我需要使用绝对定位的图像来阻止布局被左右晃动。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:41:48.983

事实证明，到目前为止，最简单的答案是将 mouseleave 应用于创建的图像，而不是下面的图像。最终代码：

```
$(document).on("mouseover", "img.grow", function() {
    var iid = $(this).attr("id");
    var isr = $(this).attr("src");
    var loc = $(this).offset();
    $("body").append('<img class="grown" id="o' + iid + '" src="' + isr + '" style="position: fixed; z-index: 1505; top: ' + loc.top + 'px; left: ' + loc.left + 'px; width: 33px;" />');
    $(".grown").animate({
        width: '100px', 
        marginLeft: '-25',
        marginTop: '-15'
    }, 250);
}).on("mouseleave", "img.grow", function() {
    var iid = $(this).attr("id");
    $("img#o" + iid).fadeOut(100, function() {
        $(this).remove(); 
    });
}); 
```

JSFiddle：http: [//jsfiddle.net/Grimdotdotdot/FLB8E/](http://jsfiddle.net/Grimdotdotdot/FLB8E/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:40:22.207

我认为您以错误的方式进行此操作，它太混乱了。怎么样：

*   创建一个您想要增长到的完整大小的容器

*   将图像应用`BACKGROUND-IMAGE`为`x,y`位置`center,center`

*   此图像是全尺寸图像，但最初您将其设置`BACKGROUND-SIZE`为 60%

*   悬停动画此属性

或与此类似的过程。

# c - 缓存使用、空间局部性和延迟

> ID：10337618
> 
> 赞同：4
> 
> 时间：2012-04-26T16:34:43.120
> 
> 标签：c, caching, pthreads, parallel-processing, localityofreference

我正在学习有关空间局部性的缓存操作。（到目前为止，我的参考资料是Lin 和 Snyder*的《并行编程原理》 、*[本教程](http://www.hardwaresecrets.com/printpage/How-The-Memory-Cache-Works/481)，当然还有 Wikipedia。）

以下面的例子为例，使用 gcc 编译，在 Windows 7 Professional 上运行，使用 Intel Core2 Duo CPU (L7500)。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main()
{
    int *array;
    int length;
    int count;
    int range;
    int i;

    // generate an array of a million integers between 0 and 99
    length = 1000000;
    range = 100;
    array = calloc(length, sizeof(int));
    srand(time(NULL));
    for(i = 0; i < length; i++)
    {
        array[i] = rand() % range;
        // printf("%d\n", array[i]);
    }

    // count the number of occurrences of 3 in the array
    count=0;
    for(i=0; i<length; i++)
    {
        if(array[i]==3)
        {
            count++;
        }
    }
    printf("count = %6d\n", count);

    return 0;
} 
```

现在在例程的后半部分，将读取整个整数数组，因此 CPU 应根据空间位置提前将它们加载到缓存中。但是在循环期间的任何时候，有多少数组可以/应该/应该加载到缓存中？一次一个缓存行（64 字节/每个 int 4 字节 = 16 个整数），它的大块，还是一举一动整个数组？

此外，据我了解，将数据从 RAM 加载到缓存（或根据教科书，从非本地内存到本地内存）所涉及的延迟可能比实际运行例程所需的时间要重要得多。真的？

现在假设我们将此代码移动到多处理器/多核机器上，并将代码的计数部分更改为在 4、8、16 等并行线程中运行（使用 pthreads），对数组的单独部分进行计数，然后添加私人最后一起计算。这是否会导致 RAM 到缓存延迟的多次单独出现，从而使并行版本的运行速度比串行版本慢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:52:53.927

是的，内存速度和延迟确实在许多算法中占主导地位，因此有必要尽可能有效地使用内存缓存来加速这些算法。

并行运行*可能会*损害您的性能，但通常不会。弄清楚这一点需要大量的测试和调整。

例如，以连接到一组 RAM 的四核芯片为例。如果算法需要最大速度的内存读取并且计算总是比 RAM 速度快，那么并行运行将不会获得任何收益，并且可能会减慢速度。

但是如果你有一个双插槽系统，每个 CPU 都会有自己的 RAM，算法会加快。

或者，系统可能会从 1 组 RAM 升级到 4 组，并从单通道切换到四通道 RAM 配置。那时，RAM 速度可能会超过计算速度，四核将从运行更多线程中受益。

在我看来，每个内核运行一个线程通常会使您受益，并将利用系统升级。运行单线程可能会避免少量的同步开销，但在以后总会限制程序。

# php - 为什么我的代码没有回显任何内容？

> ID：10337620
> 
> 赞同：0
> 
> 时间：2012-04-26T16:34:55.797
> 
> 标签：php, mysql

我的代码不会对我产生影响，但我相信它应该可以工作。我试图让它告诉我，如果它在我的数据库中找到一行，则匹配它并告诉我我已登录，或者如果它没有找到任何行，则回显该组合无效。无论如何，它没有回应一件事？我对此很陌生，我似乎无法弄清楚。请发挥你的魔力，伙计们？

注意：查询中引用的所有数据库确实存在，并且它也连接到该数据库。

谢谢！

```
<?php

if (isset($_POST['username'])&&isset($_POST['password'])) 
{
$username = $_POST['username'];
$password = $_POST['password'];
$password_hash = md5($password);

if (!empty($username)&&!empty($password)) 
{
    $query = "SELECT `id` FROM `users` WHERE `username`='$username' AND `password`='$password_hash'";
    if ($query_run = mysql_query($query)) 
    {
        $query_num_rows = mysql_num_rows($query_run);
        if ($query_num_rows==0) 
        {
            echo 'Invalid username password combination';
        }
            else 
        {
            echo 'Ok.';
        }
    }
}
}

?>

<form action="<?php echo $current_file; ?>" method="POST">
Username: <input type="text" name="username" class="login"> 
Password: <input type="password" name="password" class="login">
<input type="submit" value="Login">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:44:33.153

您没有连接到数据库。您需要添加如下内容：

```
$link = mysql_connect("localhost", "mysql_user", "mysql_password"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:46:12.820

你有很多 else 没有相应的 else 语句来打印一些东西。如果其中一个条件为假，您将不会得到任何输出。尝试：

```
if (isset($_POST['username'])&&isset($_POST['password'])) 
{
   $username = $_POST['username'];
   $password = $_POST['password'];
   $password_hash = md5($password);

   if (!empty($username)&&!empty($password)) 
   {
      $query = "SELECT `id` FROM `users` WHERE `username`='$username' AND `password`='$password_hash'";
      if ($query_run = mysql_query($query)) 
      {
          $query_num_rows = mysql_num_rows($query_run);
          if ($query_num_rows==0) 
          {
               echo 'Invalid username password combination';
          }
          else 
          {
             echo 'Ok.';
          }
      }
      else echo 'query exeution returned false';
   }
   else echo 'empty username or password';
}
else echo 'not isset username or pwd'; 
```

最后，如果即使使用这个 else stataments 也没有输出，那么如果出现任何致命错误并在打印任何输出之前阻止执行，请查看日志！

# java - 如何检测浏览器是桌面浏览器还是移动浏览器？我想使用 Java 但不想使用 WURFL

> ID：10337621
> 
> 赞同：2
> 
> 时间：2012-04-26T16:34:59.247
> 
> 标签：java, javascript, mobile, desktop, wurfl

我需要一个能够让我检测浏览器是移动设备（即 iPhone、Android 手机）、台式机还是平板电脑（即 iPad、Nook）的解决方案。根据检测，它将重定向到适当的站点。

我可以使用 WURFL，但这是针对私人公司的，它们很便宜，而且不会为商业许可证付费。我不介意公开 WURFL 代码本身。但是该类将在 JSP 页面中进行操作。如果我只需要公开使用 WURFL API 代码的类，而不是公开周围的 JSP 代码，也许我可以使用它。这就是问题所在：在商业实体背后，关于 WURFL API，什么被视为公共信息？我也必须让我的 JSP 页面开源吗？

如果我不能使用 WURFL，而无需支付商业许可，是否还有另一种 Java 甚至 JavaScript 的捆绑解决方案？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:48:58.253

你应该看看[sebarmeli/JS-Redirection-Mobile-Site](https://github.com/sebarmeli/JS-Redirection-Mobile-Site)，它基于 javascript，免费和开源，易于使用和健壮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-10T04:20:41.450

如果您喜欢 WURFL 并且可以选择 JavaScript，我建议您查看[http://wurfl.io/](http://wurfl.io/)

简而言之，如果你导入一个很小的 ​​JS 文件：

```
<script type='text/javascript' src="//wurfl.io/wurfl.js"></script> 
```

您将得到一个 JSON 对象，如下所示：

```
{
 "complete_device_name":"Google Nexus 7",
 "is_mobile":true,
 "form_factor":"Tablet"
} 
```

（当然，这是假设您使用的是 Nexus 7）并且您将能够执行以下操作：

```
if(WURFL.form_factor == "Tablet"){
    //dostuff();
} 
```

这就是你要找的。

免责声明：我是 WURFL 的发明者，我为提供这项免费服务的公司工作。谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T08:49:07.860

请注意，基于正则表达式的解决方案（例如 JS-Redirection-Mobile-Site）将无法正确分类某些浏览器。目前最大的问题是 Android 平板电脑，其中许多将被这些解决方案识别为移动设备。如果您真的想确保一切正常，您将不得不使用服务器端解决方案，但 Android 平板电脑可能尚未对相关站点构成足够的流量，因此值得处理。

免责声明：我为服务器端设备检测解决方案提供商工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:59:01.297

查看[51degrees.mobi](http://51degrees.codeplex.com/)，他们提供了您在 Mozilla 公共许可版本 2 下所需的一些数据。

[SourceForge](http://sourceforge.net/projects/fiftyone/)也有一个独立的 PHP 版本，可以快速实施。

# asp.net - 将 machineKey 添加到 machine.config

> ID：10337634
> 
> 赞同：20
> 
> 时间：2012-04-26T16:35:41.757
> 
> 标签：asp.net, .net, encryption, web-config, machine.config

我想将 machineKey 添加到我的 machine.config 中，因为我正在使用 Web 农场场景中的 web.config 连接字符串的编程加密。

我的问题是，我应该将 machineKey 放在 machine.config 文件中的什么位置？那里没有我可以替换的，我怀疑它是自动生成的，那么它应该放在哪里？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-26T16:45:32.547

把它放在下面`<system.web>`

如果您需要生成密钥，请使用[此 SO 帖子中显示的过程](https://stackoverflow.com/a/35619199/3845390)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-26T16:43:45.887

内部[`<system.web>`](http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx)：

```
<system.web>
    <machineKey 
        validationKey="....." 
        decryptionKey="....." 
    /> 
```

至少在我的文件底部。我认为 system.web 中元素的顺序并不重要，只要它是 system.web 元素正下方的顶层即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-04T14:48:00.017

从站点获取密钥可能存在安全风险。

有一个简单的方法，只需使用您的 IIS 控制台

[![在开始中输入 inetMgr](../Images/55fae60985439c31c680476c4fd5197a.png)](https://i.stack.imgur.com/5wYo2.png)

IIS 控制台打开。单击计算机密钥

[![电脑钥匙](../Images/44a20236638539d792aabe887c53a3da.png)](https://i.stack.imgur.com/vsnAd.png)

下一步是设置您的密钥。选择适当的，取消标记框以手动生成您的密钥，最后单击**Generate Keys**。

[![生成密钥的屏幕](../Images/5ce9d92e730f3559c252c92247c8bb66.png)](https://i.stack.imgur.com/cC4t5.png)

最后，进入您的 Web.Config 并在上面设置标签。

[![在 web.config 中设置密钥](../Images/e438309feddb454d3f57b4ef9d328de7.png)](https://i.stack.imgur.com/8WqhK.png)

z

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-24T20:22:47.813

将代码放入并从此链接生成机器密钥

[http://www.eggheadcafe.com/articles/GenerateMachineKey/GenerateMachineKey.aspx](http://www.eggheadcafe.com/articles/GenerateMachineKey/GenerateMachineKey.aspx)

# c# - Facebook XMPP 聊天 C#

> ID：10337635
> 
> 赞同：3
> 
> 时间：2012-04-26T16:35:44.113
> 
> 标签：c#, facebook, xmpp, chat

我正在尝试使用 C# 连接到 Facebook 聊天。

我能够获取访问代码和访问令牌，但是当我们尝试对聊天进行身份验证时它最终失败了，它给出了一个错误，说它没有经过身份验证。

我想我搞错了`ComposeResponse`。请帮我。:)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text;
using System.Net.Sockets;
using System.IO;
using System.Security.Cryptography;
using System.Net;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string url = Request.Url.AbsoluteUri;

        if (Request.QueryString["code"] == null)
        {
            Response.Redirect(GetFacebookOAuthUrl());
        }

        var Demo = GetMAccessToken(Request.QueryString["code"]);

        TcpClient FacebookClient = new TcpClient();
        FacebookClient.Connect("chat.facebook.com", 5222);
        NetworkStream myns = FacebookClient.GetStream();

        string xml = "<?xml version='1.0'?>" +
        "<stream:stream " +
        "id='1' " +
        "to='chat.facebook.com' " +
        "xmlns='jabber:client' " +
        "xmlns:stream='http://etherx.jabber.org/streams' " +
        "version='1.0' >";

        StreamWriter mySw = new StreamWriter(myns);
        mySw.WriteLine(xml);  //sending initial request
        mySw.Flush();

        byte[] serverResponseByte = new byte[1024];
        int myBytesRead = 0;
        StringBuilder myResponseAsSB = new StringBuilder();

        //reading response from the server to see the supported authentication methods 
        do
        {
            myBytesRead = myns.Read(serverResponseByte, 0, serverResponseByte.Length);
            myResponseAsSB.Append(System.Text.Encoding.UTF8.GetString(serverResponseByte, 0, myBytesRead));

        } while (myns.DataAvailable);

        myResponseAsSB.Clear();

        xml = "<auth " +
        "xmlns='urn:ietf:params:xml:ns:xmpp-sasl' " +
        "mechanism='X-FACEBOOK-PLATFORM'  />";

        mySw.WriteLine(xml);
        mySw.Flush();   //sending response to server to use X-FACEBOOK-PLATFORM

        //reading challenge send by the server
        do
        {
            myBytesRead = myns.Read(serverResponseByte, 0, serverResponseByte.Length);
            myResponseAsSB.Append(System.Text.Encoding.UTF8.GetString(serverResponseByte, 0, myBytesRead));

        } while (myns.DataAvailable);

        myResponseAsSB.Replace("<challenge xmlns=\"urn:ietf:params:xml:ns:xmpp-sasl\">", "");
        myResponseAsSB.Replace("</challenge>", "");

        //converting challenge string to normal string
        byte[] myregularstrigbytes = Convert.FromBase64String(myResponseAsSB.ToString());
        string myregularstring = System.Text.Encoding.UTF8.GetString(myregularstrigbytes);

        string response = ComposeResponse(myregularstring, Demo);

        byte[] myResponseByte = Encoding.UTF8.GetBytes(response.ToString());

        string myEncodedResponseToSend = Convert.ToBase64String(myResponseByte);
        xml = String.Format("<response xmlns=\"urn:ietf:params:xml:ns:xmpp-sasl\">{0}</response>", myEncodedResponseToSend);
        mySw.WriteLine(xml);
        mySw.Flush();   //sending the response to the server with my parameters

        myResponseAsSB.Clear();

        //checking if authentication succeed 
        do
        {
            myBytesRead = myns.Read(serverResponseByte, 0, serverResponseByte.Length);
            myResponseAsSB.Append(System.Text.Encoding.UTF8.GetString(serverResponseByte, 0, myBytesRead));

        } while (myns.DataAvailable);

        // It fails here..
        string result_ = myResponseAsSB.ToString();
    }

    private string ComposeResponse(string serverresponse, string AccessToken)
    {
        string version = serverresponse.Split('&')[0].Split('=')[1];
        string method = serverresponse.Split('&')[1].Split('=')[1];
        string nonce = serverresponse.Split('&')[2].Split('=')[1];
        string appId = "421025367912155";

        string Response = "api_key=" + appId
        + "&call_id=" + 0
        + "&method=" + method
        + "&nonce=" + nonce
        + "&access_token=" + AccessToken
        + "&v='1.0'";

        return Response;
    }

    public string GetMAccessToken(string Code)
    {
        string AccessToken;

        string RequestToken = "https://graph.facebook.com/oauth/access_token?" +
        "client_id=421025367912155" +
        "&redirect_uri=http://localhost:2155/FBintegration/" +
        "&client_secret=10d4cfc72892a8c291ff0a8f6fc0003f" +
        "&code=" + Code ;

        WebRequest req = WebRequest.Create(RequestToken);

        WebResponse Response = req.GetResponse();

        Stream dataStream = Response.GetResponseStream();

        // Open the stream using a StreamReader for easy access.
        StreamReader reader = new StreamReader(dataStream);
        // Read the content.
        string responseFromServer = reader.ReadToEnd();

        string[] Res = responseFromServer.Split(new char[] {'&'},StringSplitOptions.RemoveEmptyEntries);

        AccessToken = Res[0];

        AccessToken = AccessToken.Replace("access_token=", "");

        return AccessToken;
    }

    public string GetFacebookOAuthUrl()
    {
         string RedirectUrl = "https://www.facebook.com/dialog/oauth?scope=xmpp_login" +
            "&client_id=421025367912155" +
            "&redirect_uri=" + new System.Uri("http://localhost:2155/FBintegration/");

         return RedirectUrl;
    }
} 
```

# cakephp - 带有数据和新表的 CakePHP 模型关联表

> ID：10337638
> 
> 赞同：0
> 
> 时间：2012-04-26T16:35:48.517
> 
> 标签：cakephp, associations

我有一张表（药物），其中列出了该表中的所有药物。Drugs 有一个 french_information 和 french_information 属于 Drugs。我希望用户能够单击一种药物，显示有关它的信息，然后选择法语并让它显示添加法语信息的视图，同时显示所选药物信息，并带有为其添加法语信息的字段并将其存储在 french_information 表中。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:41:22.283

你不会的。

除非您有学生数据，否则无需在学生表中包含 Mentor 数据。

创建学生后，您可以将其与相应的导师 ID 一起添加到学生表中。如果您愿意，您可以随时在 Student 模型中添加 beforeSave() ，以确保在保存之前导师没有附加学生。

如果由于某种原因你觉得你的学生表中必须有空数据，你总是可以在任何操作（运行一次）中编写一些代码，在这些操作中循环每个 Mentor，为 $student 构建一个数组并保存它——比如这：

```
$mentors = $this->Mentor->find('all');
foreach($mentors as $mentor) {
    $this->Student->create();
    $student = array('mentor_id'=>$mentor['id']);
    $this->Mentor->Student->save($student);
} 
```

或者，您可以编写 SQL 并直接在数据库上运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:43:01.050

这可能会奏效。不过，您最终会得到空`student_name`字段。

```
INSERT INTO `students` (mentor_id) SELECT id FROM `mentors`; 
```

# dom - 如何访问与 D3 SVG 对象相关的 DOM 元素？

> ID：10337640
> 
> 赞同：68
> 
> 时间：2012-04-26T16:35:54.953
> 
> 标签：dom, svg, visualization, data-visualization, d3.js

我正在尝试通过尝试他们的[基本气泡图](http://mbostock.github.com/d3/ex/bubble.html)之一来学习 D3 。第一个任务：弄清楚如何拖动一个气泡并让它在被拖动时成为最上面的对象。（问题是让 D3 的对象模型映射到 DOM，但我会到达那里......）

要拖动它，我们可以使用它们提供的代码简单地调用 d3 的拖动行为：

```
var drag = d3.behavior.drag()
    .on("dragstart", dragstart)
    .on("drag", dragmove)
    .on("dragend", dragend); 
```

效果很好。拖得好。现在，我们如何让它成为最顶层的项目？在此处搜索“svg z-index”，很快就会发现更改索引的唯一方法是将对象在 DOM 中进一步向下移动。好的。它们并不容易，因为单个气泡没有 ID，但是在控制台中乱来，我们可以找到其中一个气泡对象：

```
$("text:contains('TimeScale')").parent() 
```

我们可以将它移动到包含 svg 元素的末尾：

```
.appendTo('svg') 
```

完成后拖动它，它是最顶部的项目。到目前为止，一切都很好，*如果*您完全在 DOM 中工作。

但是：我真正想做的是在拖动给定对象/气泡时自动发生这种情况。D3 提供了一个模型`dragstart()`和`dragend()`函数，允许我们在拖动过程中嵌入一个语句来做我们想做的事情。D3 提供了`d3.select(this)`允许我们访问*d3 的*对象表示的语法，该对象表示您当前正在拖动的对象/气泡。但是我如何干净地将它们返回的大量数组转换为对我可以交互的 DOM 元素的引用，并且 - 例如 - 将其移动到 svg 容器的末尾，或在 DOM 中执行其他引用，例如表单提交?

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2014-02-25T19:56:14.517

您还可以通过[selection.node() 方法获取选择所代表的 DOM 元素](https://github.com/d3/d3-selection/blob/master/README.md#selection_node)

```
var selection = d3.select(domElement);

// later via the selection you can retrieve the element with .node()
var elt = selection.node(); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-26T20:56:10.033

SVG 文档中的任何 DOM 元素都将具有[`ownerSVGElement`](https://developer.mozilla.org/en/DOM/SVGElement)引用它所在的 SVG 文档的属性。

D3 的选择只是嵌套数组，上面有额外的方法；如果你`.select()`编辑了一个 DOM 元素，你可以用 得到它`[0][0]`，例如：

```
var foo = d3.select(someDOM);

// later, where you don't have someDOM but you do have foo
var someDom = foo[0][0];
var svgRoot = someDom.ownerSVGElement; 
```

但是请注意，如果您正在使用`d3.select(this)`then`this`已经*是*DOM 元素；您无需将其包装在 D3 选择中即可展开它。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-26T18:12:33.790

如果需要，可以在追加时将 ID 和类分配给各个元素：

```
node.append("circle.bubble")
.attr("r", function(d) { return d.r; })
.style("fill", function(d) { return fill(d.packageName); })
.attr("id", function(d, i) { return ("idlabel_" + i)})
.attr("class", "bubble")
; 
```

然后您可以使用 selectAll("circle.bubble") 按类选择或按 id 选择并修改属性，如下所示：

```
var testCircle = svg.select("#idlabel_3")
.style("stroke-width", 8); 
```

# api - Google Address API URL 街道地址示例

> ID：10337641
> 
> 赞同：1
> 
> 时间：2012-04-26T16:35:55.250
> 
> 标签：api, street-address

我成功地使用我的街道地址输入（起点和终点）创建了谷歌地图但是，当我对谷歌地址 API 使用相同的精确测试时，JSON 响应显示了许多地址，但它们似乎都不是有效的。例如，我正在使用科罗拉多州的地址，它正在返回加利福尼亚州某个城市的同一街道地址的方向。这不一致，因为某些地址可以正常工作......所以，我认为问题在于我的 url 结构，但我找不到包含街道地址的 Google Address API 示例。他们所有的例子都只引用了城市和州。因此，如果不查看特定的街道地址示例，就很难看到参数的外观。有人可以提供对我有帮助的帖子或示例或链接吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:29:06.007

谷歌地图是一种地址*近似*服务。举例来说，进入几乎任何位置的街景，左上角应该显示“地址是近似的”。Google 和其他此类服务不会验证地址的存在或可送达性。

根据您的描述，您的 URL 很可能是正确组装的（尽管您还没有发布它，所以除非您这样做，否则我们无法确定），而 Google 只是在做它最擅长的事情：制作给出的最佳猜测。

如果您只寻找*有效*地址，则需要连接到[CASS 认证的](http://smartystreets.com/what-is/cass-certification)服务。

我在[SmartyStreets](http://smartystreets.com)工作；我们提供了一个名为[LiveAddress的](http://smartystreets.com/products/liveaddress-api)[API](http://smartystreets.com/what-is/api) ，它只返回*有效*地址。那里有一些，因此我们鼓励您自己进行研究，但您不会找到任何其他可以免费使用的（具有完整功能，无限期）。

 *如果您需要正确的方向，我建议您通过 LiveAddress 之类的 API 运行起始地址和目的地地址，然后将这些结果提交给 Google。到那时，您将确定您处于正确的状态。:)

希望这会有所帮助；如果您对地址有任何其他问题，请告诉我。*

# mysql - 如何根据满足的某些条件加入两个表？

> ID：10337644
> 
> 赞同：0
> 
> 时间：2012-04-26T16:36:03.583
> 
> 标签：mysql

我有两张桌子，**样品**

```
sample_id   status  member_id
1           pass    2
2           pending 2
3           pending 2
4           pending 1 
```

和**投票**

```
vote_id sample_id   member_id
1           1           1
2           1           1
3           1           5
4           2           2 
```

`samples.sample_id`和都是`votes.vote_id`自动递增的，`samples.member_id`并且`votes.member_id`应该加入`where samples.member_id=someUserId`。

我想返回一组 samples.sample_id 的结果集

1.  samples.status 待定
2.  未`samples.member_id`提交样品
3.  `votes.member_id`没有投票给样本

## 示例 1

例如，如果`member_id`为 1，则结果集应为

```
2
3 
```

由于`samples.status where samples.sample_id = 1`不是`pending`，并`samples.member_id`提交了`samples.sample_id`4。

## 示例 2

如果`member_id`是 2，结果集应该是

```
4 
```

自从`samples.member_id`提交了`samples.sample_id`1-3。

## 示例 3

如果`member_id`是 3，结果集应该是

```
2
3
4 
```

由于`samples.status where samples.sample_id = 1`不是`pending`

**编辑** 在必须满足的三个条件中，我可以通过以下条件满足第一个条件

```
SELECT * FROM samples
LEFT OUTER JOIN votes on samples.sample_id = votes.vote_id
WHERE samples.status='pending' 
```

但我正在努力满足其他两个条件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:54:05.547

```
SELECT  sample_id
FROM    samples
WHERE   status = 'pending'
        AND member_id <> $someUserId
        AND sample_id NOT IN
        (
        SELECT  sample_id
        FROM    votes
        WHERE   member_id = $someUserId
        ) 
```

# ruby-on-rails-3 - Form_for 在不同部分输入和提交按钮

> ID：10337647
> 
> 赞同：2
> 
> 时间：2012-04-26T16:36:19.043
> 
> 标签：ruby-on-rails-3

有没有办法将一个表单（使用 form_for）拆分为两个部分？我想在一个部分有文本框，在另一个有我的提交按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T07:07:35.257

你可以这样做：

```
# _post_form.html.erb
<%= form_for(@post) do |f| %>
 <% @form = f%>
 <%= render 'form_fields'%>
 <%= render 'form_actions'%>
<% end %>

# _form_fields.html.erb
<div class="field">
 <%= @form.label :name %><br />
 <%= @form.text_field :name %>
</div>
<div class="field">
 <%= @form.label :title %><br />
 <%= @form.text_field :title %>
</div>
<div class="field">
 <%= @form.label :content %><br />
 <%= @form.text_area :content %>
</div>

# _form_actions.html.erb
<div class="actions">
  <%= @form.submit %>
</div> 
```

# java - LMAX Disruptor vs JMS Provider

> ID：10337664
> 
> 赞同：3
> 
> 时间：2012-04-26T16:37:23.300
> 
> 标签：java, concurrency, jms, message-queue

不久前有人告诉我有关 LMAX 干扰器以及与标准消息队列相比它的性能如何。我下载了最新版本，发现它是一个普通的 JAR，其中包含许多类和类型，这些类和类型都围绕其超快的 RingerBuffer 对象。

归根结底，基于队列的 JMS 提供者最终会归结为管理 Java 队列对象（或者，更可能是并发队列）的大量代码。所以在这方面，我看到了 LMAX Disruptor 和 JMS 提供者（或者更确切地说，它是内部队列）之间的比较。

但是一个 JMS 提供者不仅仅是几个队列。它是一个完整的中间件应用程序，用于处理与消费者和生产者之间的消息传递。我想知道 LMAX 土地上是否有等效的 JMS 提供程序？

最好以与任何其他 JMS 代理类似的方式连接到“Disruptor Broker”，并向其读取/写入消息。

是否存在这样的事情，或者我在这里离基地很远？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T21:03:08.830

主要区别在于 Disruptor 被设计为在同一进程中工作。为什么？出于性能原因（简短回答）。更长的答案是，如果你不小心使用 JMS 接口、套接字连接、锁定和多线程的额外开销，将会有更高的开销，这会使 Disruptor 相形见绌。

一个快速的 JMS 服务每秒可以处理超过 20,000 条消息，但中断器的设计目的是处理超过 2000 万条消息的速率。要实现这一点，这意味着您不能做 JMS 认为可以的某些事情。（往上看）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-27T16:05:15.040

那时组织开发了自己的内部使用框架（CRUD、ORM 等）。我有机会使用的框架之一是内部消息缓冲区（中介），它确保应用程序部分（如消息消费者）和更慢（间歇性）的处理/持久化/网络部分之间的异步解耦。该中介器是基于 ActiveMQ 构建的，该 ActiveMQ 与应用程序一起启动并仅用于专用应用程序实例。

如今，我们有一个可用的环形缓冲区框架 Disruptor（或基于它的 Reactor），没有理由再次发明轮子（感谢开源）。Disruptor 的目的是通过 FIFO 缓冲区带来异步解耦，并使其使用起来更加快捷方便。

Disruptor 相对于 JMS 的优势：

1.  上面提到的方法是相同的，而且速度要快得多。
2.  无需支持、维护和支付外部中间件组件。
3.  它在应用程序内部，无需涉及任何 TCP 连接、网络或其他垃圾外部慢速瓶颈资源，并且依赖于它和他们的团队。
4.  Disruptor 有很多特性，比如并行消费和处理（workers vs handlers）策略，开箱即用，或者您可以根据您的行为要求实现自己的策略。

[破坏者维基](https://github.com/LMAX-Exchange/disruptor/wiki/Getting-Started)

# javascript - 使用和不使用 d3.json() 驱动 D3 图表

> ID：10337668
> 
> 赞同：2
> 
> 时间：2012-04-26T16:37:31.347
> 
> 标签：javascript, json, d3.js, transition, interpolation

我有一段代码可以创建一个甜甜圈（即 d3.layout.pie()）。

我曾经通过以下方式加载JSON数据

```
d3.json(jsonFilePath,
    function(json) {
             //logic
             ....
            }) 
```

我的可视化是交互式的（即，甜甜圈的大小不同，包括 innerRadius 和“d”属性）。所以我正确实现了三种情况，输入、删除和更新以及 attrTween 函数来转换“d”属性。

它一直工作到现在。我决定实现某种缓存机制（即，我有一个保存数据的变量，以便数据被预取一次并在需要时重新使用）。我测试了我的缓存的行为并且它正在工作。**这是一个片段...**

```
if(cache[name] == undefined) {
    console.log('Loading data and create viz');

    // Loading all the JSONs for this name
    var remaining = revs.length; 
    // revs is an array w/ json file names to load (elements in the form r1, r4 etc.)

    var current = {};

    for (var i in revs) {
        d3.json(revs[i] + ".json" , function(json) {

            current["r"+json.revision] = json;

            if (!--remaining) {
                // Data loaded, here, hence setting cache
                cache[appName] = current;
                createViz(rev);
            }
        }); 
    }
} 
```

我说到点子上了。我用对包含加载的 JSON 字符串的缓存数据的简单访问替换了我用来加载数据的方式，所以现在代替上面的代码块，我有一些看起来像的东西

```
var currentCache = cache[someName];
var json = currentCache[revisionName]; 
```

当我检查 json 变量时，json 已正确加载并且看起来很好。关键是现在过渡不再起作用，我收到了很多消息，例如

```
Error: Problem parsing d="M2.1431318985078682e-14,-350A350,350 0 1,1 NaN,NaNLNaN,NaNA230.68565589945686,230.68565589945686 0 1,0 1.412542250532388e-14,-230.68565589945686Z" 
```

我之前已经遇到过这些消息，但现在问题是我不知道为什么会这样。代码没有改变，而不是使用 d3.json() 我使用来自变量的 json 字符串。有什么建议吗？

我附上部分代码以供参考...

```
// An array of objects such as {"name" : myObject, "calls" : 23}
var calls = json.children;

var donut = d3.layout.pie()
    .value(function(d) { return d.calls; })
    .sort(null)

var arcs = d3.select("#vizGroup")
    .selectAll(".callSlice")
    .data(donut(calls));

//update
arcs
    .data(donut(calls))
    .transition()
    .duration(750)
    .attrTween("d", arcTween)
    .style("fill", function(d) { return somecolor(d.data.name); } )

//enter
arcs.enter()
    .append("svg:path")
    .style("fill", function(d) { return somecolor(d.data.name); } )
    .attr("stroke", "#EEF")
    .attr('class', 'callSlice')
    .each(function(d) { this._current = d; })
    .transition()
    .duration(750)
    .attrTween("d", arcTween)

//remove
arcs.exit().remove();

function arcTween(a) {
    a.innerRadius = myScale(myVariable);

    var i = d3.interpolate({
        startAngle: this._current.startAngle, 
        endAngle: this._current.endAngle,
        innerRadius: this._current.innerRadius}, a);

    this._current = i(0);

    return function(t) {
        return arc(i(t));
    };
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T17:11:39.477

您的代码段引用了一个未定义的变量`rev`。另外，不要对数组使用[for-in 循环。](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for...in)我假设你的意思是这样的：

```
for (var i = 0, n = revs.length; i < n; ++i) {
  d3.json(revs[i] + ".json", function(json) {
    var rev = revs[i];
    /* do something with rev here */
  }); 
} 
```

或者等效地，像这样：

```
for (var i = 0, n = revs.length; i < n; ++i) {
  var rev = revs[i];
  d3.json(revs[i] + ".json", function(json) {
    /* do something with rev here */
  }); 
} 
```

这些都不会按预期工作，因为 d3.json 回调是异步的，并且闭包不会在 for 循环的当前迭代中捕获`rev`（或就此而言）的值：它们捕获的是*引用*，而不是*值*，并且因此，当稍后调用回调时，所有回调将看到for 循环 ( ) 的*最后*一次迭代中的值，而不是调用每个 d3.json 时的值。`i`***`revs.length`***

 ***您可以通过使用闭包捕获值来解决此问题。例如：

```
for (var i = 0, n = revs.length; i < n; ++i) {
  fetch(revs[i]);
}

function fetch(rev) {
  d3.json(rev + ".json", function(json) {
    /* do something with rev here */
  }); 
} 
```

这是有效的，因为 的每个唯一值`rev`都由函数捕获`fetch`。有关闭包的更多信息，请参阅：

*   [http://jibbering.com/faq/notes/closures/](http://jibbering.com/faq/notes/closures/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:51:21.323

我认为您没有包含有问题的代码，我怀疑这是您的 JSON 缓存代码。我的猜测是您仍在异步获取 JSON，但您正在尝试立即使用它。`d3.json()`接受一个在实际加载数据之前不会调用的回调函数 - 我在您当前的代码中没有看到任何类似的结构，所以除非您加载 JSON 内联，而不是从远程文件加载，否则很可能是问题。

在这种情况下，手动检查控制台无济于事，因为当您检查控制台时，数据*已经*加载——当您的代码实际运行时，您就会遇到问题。***

# android - Google Analytics + EasyTracker (Android) 在快速切换时跟踪相同的活动

> ID：10337669
> 
> 赞同：1
> 
> 时间：2012-04-26T16:37:31.413
> 
> 标签：android, google-analytics

我注意到，当我在活动之间快速切换时，GoogleAnalytics 会发送所有具有相同名称的 GET 请求（活动跟踪）（在日志中查看）。

在调用 GoogleAnalytics 库之前，我附上了 EasyTracker 的源代码，并将调试器带到了 EasyTracker 代码的最后一点。那里的活动名称是正确的。之后，一切都是一个黑盒子（没有 GoogleAnalytics 的来源），然后我在日志中看到 GET 具有相同的名称。

GET 请求几乎相同。唯一的区别是参数 utmqt。

它是什么？它是 GoogleAnalytics 的错误吗？其他人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-15T23:38:56.383

从这个用于 GA 的 Java 库的实现中，看起来“utmqt”是发出 GA 请求和请求实际被分派到网络之间的时间差： [https ://code.google.com/p/ jgoogleanalytictracker/source/browse/trunk/src/main/java/com/dmurph/tracking/dispatch/AnalyticsDispatcher.java?r=65](https://code.google.com/p/jgoogleanalyticstracker/source/browse/trunk/src/main/java/com/dmurph/tracking/dispatch/AnalyticsDispatcher.java?r=65)

更新：另见[https://github.com/AttackPattern/CSharpAnalytics/blob/b227da375341876ec77deb8e49c4c4c2ef0c1cef/Source/CSharpAnalytics/Protocols/Urchin/UrchinParameterDefinitions.cs](https://github.com/AttackPattern/CSharpAnalytics/blob/b227da375341876ec77deb8e49c4c4c2ef0c1cef/Source/CSharpAnalytics/Protocols/Urchin/UrchinParameterDefinitions.cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T09:46:53.587

可能跟发货时间有关系？您可以更改分析发送新数据之间的秒数吗？我认为默认情况下是 60 秒这篇[文章](http://www.xatik.com/2012/03/27/how-to-use-google-analytics-in-android-applications/)通过添加时间参数解释了如何做到这一点

TIME（用秒数更改 TIME 值）

如果它太短，请注意它不会压倒用户的连接

# django - 更新现有记录或创建新记录

> ID：10337670
> 
> 赞同：1
> 
> 时间：2012-04-26T16:37:33.723
> 
> 标签：django, django-models

如果不创建新条目，如果条目已经存在，我正在尝试更新数据库。

```
def saveprofile(request):
    location = request.POST['location']
    email = request.POST['email']
    if request.user.is_authenticated():
        userprofile = UserProfiles(user=request.user)
        if userprofile:
           userprofile.location=location
           userprofile.email=email
           userprofile.save()
           return render_to_response('profile.html',{'pfields':userprofile})
        else:
           userprofile = UserProfiles(user=request.user, location=location, email=email)
           userprofile.save()
           return render_to_response('profile.html',{'pfields':userprofile}) 
```

它在扔

> （1062，“密钥‘user_id’的重复条目‘15’”）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-31T01:46:45.593

您可以使用[`get_or_create`](https://docs.djangoproject.com/en/2.0/ref/models/querysets/#get-or-create)更简单的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:55:40.530

您必须使用`get`Django 来获取现有对象，而不是创建新对象，这就是您调用`UserProfiles(user=request.user)`当前正在执行的操作。

例如：

```
try:
    userprofile = UserProfiles.objects.get(user=request.user)
except DoesNotExist:
    # create object here. 
```

有关更多信息，请参阅[此链接](https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-a-single-object-with-get)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:58:57.377

首先，虽然您确实可以通过这种方式手动处理表单，但使用 Django 处理表单的“正确方法”是使用[`django.forms`](https://docs.djangoproject.com/en/dev/topics/forms/). 话虽如此……</p>

我假设您的`UserProfiles`模型不包含显式主键。这意味着，Django 会自动创建自己的字段，称为`id`.

现在，当您使用构造函数创建模型的新实例时，该`id`字段将保持为空。它不会从数据库中获取任何东西，它会创建一个新对象。之后，您为其字段分配一些值。请注意，以下两个是等价的：

```
userprofile = UserProfiles(user=request.user, location=location, email=email)

# and
userprofile = UserProfiles(user=request.user)
userprofile.location=location
userprofile.email=email 
```

因为在这两种情况下，您只需创建一个新对象并设置 和的`user`值。`location``email`

一旦您尝试保存此对象，就会收到错误消息。

正确的做法是首先从数据库中获取对象：

```
try:
    profile = UserProfiles.objects.get(user=request.user)
except DoesNotExist:
    # Handle the case where a new object is needed.
else:
    # Handle the case where you need to update an existing object. 
```

有关更多信息，请查看[https://docs.djangoproject.com/en/dev/topics/db/queries/](https://docs.djangoproject.com/en/dev/topics/db/queries/)

# c# - 如何使用 CString 引用调用非托管 C++ DLL

> ID：10337672
> 
> 赞同：1
> 
> 时间：2012-04-26T16:37:34.907
> 
> 标签：c#, c++, mfc, command-line-interface

使用 VS2010，我正在围绕一个在其公共接口中使用 MFC CStrings 的非托管 C++ DLL 构建一个 C++/CLI 包装 DLL。非托管 C++ DLL 包含一个我需要访问的类。我的问题是这个类包含使用 CString 引用的方法，例如：

```
BOOL GetUnits(eSysOfUnits sysUnit, CString &Unit, Cstring &Format); 
```

在我的 C++/CLI 包装器中，我试图像这样访问它

```
BOOL GetUmUnits(eSysU sysunit, String^ %cunit, String^ %format)
{
   GetUnits(sysunit, marshal_as<CString>(cunit), marshal_as<CString>(format));
} 
```

这给了我一个编译器错误说明

> C2665: msclr::interop::marshal_as : 3 个重载都不能转换所有参数类型

GetUmUnits 将通过 C# 表单访问。cunit 和 format 需要由非托管代码更新。

我做错了什么不可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:09:00.107

您的包装器必须将托管对象转换`String^`为实际`CString`对象并直接传递它。编组器不知道如何创建`CString`对象。

不同版本的 MFC有不同的`CString`版本，因此您必须链接到与非托管 DLL 构建一个相同的 MFC 版本。

# c# - 插入/编辑表 A 时如何编辑表 B

> ID：10337674
> 
> 赞同：0
> 
> 时间：2012-04-26T16:37:45.980
> 
> 标签：c#, linq, dynamic-data

我正在使用动态数据 (Linq) 创建一个管理页面。我有一个包含用户的表和一个控制用户可以访问哪些帐户的表。

UserAccess 具有 User 和 Account 的外键

当我添加新用户或编辑现有用户时，我需要能够设置该用户有权访问的帐户，因此我需要能够在插入/编辑用户时访问和修改 UserAccess 表。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T17:50:16.623

我能想到的几种设置初始值的方法： 您可以在数据库中设置一个 UPDATE INSERT 触发器，以创建一组默认的 UserAccess 值。或者，您可以捕获 System.Data.Linq.Changeset，然后在对名为 User 的对象进行插入或更新时，触发 Linq 函数以设置初始值。在应用程序中，您必须在创建新用户时提醒用户设置访问权限。

# xml - Qt读取Xml文件QXmlStreamReader - 陷入循环

> ID：10337677
> 
> 赞同：0
> 
> 时间：2012-04-26T16:37:49.017
> 
> 标签：xml, qt

这是我要阅读的 XML 格式：

```
<base>
    <pasta>name
      <musica>my audio.mp3</musica>
      <musica>my audio.mp3</musica>
      <musica>my audio.mp3</musica>
      <musica>my audio.mp3</musica>
    </pasta>
    <pasta>name2
      <musica>my audio.mp3</musica>
      <musica>my audio.mp3</musica>
    </pasta>
</base> 
```

我用来读取 xml 的代码：

```
QList<PastaBase>* BaseWrapper::carregarDeXml(QString caminhoArquivoXml)
{
    //Carrega do XML
    QFile arquivoXml(caminhoArquivoXml);
    if(!arquivoXml.open(QIODevice::ReadOnly))
    {
        QString s(QString::fromUtf8("Erro ao abrir arquivo de base"));
        QMessageBox::warning(0, "Erro", s);
        throw QString("Erro ao abrir arquivo de base");
    }
    QList<PastaBase> *base = new QList<PastaBase>();
    QXmlStreamReader r;
    r.setDevice(&arquivoXml);
    while(!r.atEnd() && !r.hasError())
    {
        r.readNext();

        if(r.isStartElement())
        {
            if(r.name().toString() == QString("pasta"))
            {
                PastaBase p;
                p.setNome(r.readElementText());
                r.readNextStartElement();
                while(r.name().toString() == QString("musica"))
                {
                    std::cout << "elemento: " << r.name().toLatin1().constData() << " - valor: " << r.readElementText().toLatin1().constData() << std::endl;
                    p.getMidias()->append(r.readElementText());
                    r.readNextStartElement();
                }
                base->append(p);
            }
        }
    }
    arquivoXml.close();
    return base;
} 
```

输出 - 卡在 while 循环中：

```
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor: 
elemento: musica - valor:
...
...
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:33:52.160

你确定那是你正在运行的代码吗？我试图复制/粘贴它，但它没有编译...

`r.name()`返回一个[QStringRef](http://doc.qt.nokia.com/4.7-snapshot/qstringref.html)并且其中没有`toLatin1()`方法。如果我用该`toString()`方法替换它，那么它对我来说编译得很好。

但是您的问题不存在，我认为您在 xml 文件中所做的事情是非法的：

```
<pasta>you can't put something here
  <musica>my audio.mp3</musica>
  <musica>my audio.mp3</musica>
  <musica>my audio.mp3</musica>
  <musica>my audio.mp3</musica>
</pasta> 
```

导致无限循环的行是`p.setNome(r.readElementText());`因为如果您有子标签，则不能在此处键入文本。

我对 XML 不是很熟悉，但我真的认为你的问题就在这里。有人可以确认吗？

# c# - 删除和恢复窗口边框

> ID：10337680
> 
> 赞同：3
> 
> 时间：2012-04-26T16:38:00.477
> 
> 标签：c#, windows, winapi, border

我想在 C# 中删除另一个进程的窗口边框；我使用 RemoveMenu 删除边框。它几乎可以工作，但我还有两个问题：

*   我需要删除边框两次，第一次菜单栏仍然存在。
*   我无法恢复菜单

这是我已经写的：

```
public void RemoveBorders(IntPtr WindowHandle, bool Remove)
    {
        IntPtr MenuHandle = GetMenu(WindowHandle);

        if (Remove)
        {
            int count = GetMenuItemCount(MenuHandle);
            for (int i = 0; i < count; i++)
                RemoveMenu(MenuHandle, 0, (0x40 | 0x10));
        }
        else
        {
            SetMenu(WindowHandle,MenuHandle);
        }

        int WindowStyle = GetWindowLong(WindowHandle, -16);

        //Redraw
        DrawMenuBar(WindowHandle);
        SetWindowLong(WindowHandle, -16, (WindowStyle & ~0x00080000));
        SetWindowLong(WindowHandle, -16, (WindowStyle & ~0x00800000 | 0x00400000));
    } 
```

有人可以告诉我我做错了什么吗？我已经尝试保存 MenuHandle 并稍后恢复它，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-10T22:33:25.607

> *   我无法恢复菜单

这是因为您的 MenuHandle 是**局部**变量。

当对您的方法 RemoveBorders的**第一次调用结束时，垃圾收集器将删除 MenuHandle 并释放内存。**

第二**次**调用 RemoveBorders 时，MenuHandle 重新创建为新的**局部**变量，并重新分配给窗口菜单的当前状态 - 一个没有菜单项的菜单。

因此：

MenuHandle 不会保存窗口菜单的先前状态，这解释了为什么您无法恢复窗口菜单。

我对您的建议是制作 MenuHandle**全局**变量，并从 RemoveBorders 方法定义中定义它。

您可以将其定义为私有、受保护或公共字段，还可以为其定义另一个属性，但这是可选的，**不是**必需的。如果此属性更适合您，您也可以将其定义为静态。

以下是 MenuHandle 定义的一些示例：

```
private IntPtr MenuHandle;
//or
IntPtr MenuHandle; //Defined outside of RemoveBorders, which is defined below this line, to show that MenuHandle is not local variable.
public void RemoveBorders(IntPtr WindowHandle, bool Remove)
//or
protected IntPtr MenuHandle;
//or
public IntPtr MenuHandle
//or
private static IntPtr MenuHandle
//or
static IntPtr MenuHandle
//etc... 
```

您必须移动该行：

```
IntPtr MenuHandle = GetMenu(WindowHandle); 
```

里面：

```
if (Remove) 
```

在调用 GetMenuItemCount 函数之前。

您还必须修改该行，并至少删除 IntPtr，以声明 MenuHandle**不是** **局部**变量，并引用在RemoveBorders 方法之外定义的 MenuHandle**字段。**IntelliSense 仍会将其识别为**field**，并且**不会**提醒您未定义的错误。

如果 MenuHandle**不是** **静态**的，那么您也可以添加`this`. 删除 MenuHandle 之前的 IntPtr 之后的关键字（换句话说，您可以替换`IntPtr` 为`this.`），以记住 MenuHandle 不再是**局部** **变量**，因此垃圾收集器**不会**在 RemoveBorders 完成工作时将其删除。

当您启动程序时，MenuHandle 将被分配`IntPtr.Zero`为默认值。**当您第**一次调用 RemoveBorders时，MenuHandle 的值将设置为`if (Remove)`.

当 RemoveBorders**第**一次完成时，MenuHandle 不会被删除，而是保存窗口菜单的先前状态，在它的所有项目被删除之前。

因此，当您**第二**次调用 RemoveBorders 以恢复菜单时，执行程序将到达`if (Remove)`代码并立即跳转到`else`代码，因为 remove = false，并且在那里您调用 SetMenu 函数，当您给它**之前**的状态时自第**一次**调用 RemoveBorders以来的窗口菜单。这样你就可以最终恢复窗口的菜单。

我仍然不明白为什么你需要删除边框两次，第一次菜单栏仍然存在。我也想帮你解决这个问题，但不知道。在这种情况下，您的代码是正确的。抱歉，但我希望其他人可以为您解决此问题，并为您提供解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:53:21.167

尝试这个。这对我有用。在这个例子中，边框和菜单的移除是在它自己的应用程序内部完成的。但只需稍作调整，您就可以使其适用于外部窗口。

这些是我在代码中声明的一些常量

```
 const uint WS_BORDER = 0x00800000;
    const uint WS_DLGFRAME = 0x00400000;
    const uint WS_THICKFRAME = 0x00040000;
    const uint WS_CAPTION = WS_BORDER | WS_DLGFRAME;
    const uint WS_MINIMIZE = 0x20000000;
    const uint WS_MAXIMIZE = 0x01000000;
    const uint WS_SYSMENU = 0x00080000;
    const uint WS_VISIBLE = 0x10000000;
    const int GWL_STYLE = -16; 
```

对于窗口边框

```
 Point originallocation = this.Location;
Size originalsize = this.Size;

public void RemoveBorder(IntPtr windowHandle, bool removeBorder)
{

    uint currentstyle = (uint)GetWindowLongPtr(this.Handle, GWL_STYLE).ToInt64();
    uint[] styles = new uint[] { WS_CAPTION, WS_THICKFRAME, WS_MINIMIZE, WS_MAXIMIZE, WS_SYSMENU };

    foreach (uint style in styles)
    {

        if ((currentstyle & style) != 0)
        {

            if(removeBorder)
            {

                currentstyle &= ~style;
            }
            else
            {

                currentstyle |= style;
            }
        }
    }

    SetWindowLongPtr(windowHandle, GWL_STYLE, (IntPtr)(currentstyle));
    //this resizes the window to the client area and back. Also forces the window to redraw.
    if(removeBorder)
    {

        SetWindowPosPtr(this.Handle, (IntPtr)0, this.PointToScreen(this.ClientRectangle.Location).X, this.PointToScreen(this.ClientRectangle.Location).Y, this.ClientRectangle.Width, this.ClientRectangle.Height, 0);
    }
    else
    {

        SetWindowPosPtr(this.Handle, (IntPtr)0, originallocation.X, originallocation.Y, originalsize.Width, originalsize.Height, 0);
    }
} 
```

对于菜单，您可以这样做。

```
 public void RemoveMenu(IntPtr menuHandle, bool removeMenu)
    {
        uint menustyle = (uint)GetWindowLongPtr(menuStrip1.Handle, GWL_STYLE).ToInt64();

        SetWindowLongPtr(menuStrip1.Handle, GWL_STYLE, (IntPtr)(menustyle^WS_VISIBLE));
        // forces the window to redraw (makes the menu visible or not)
        this.Refresh();
    } 
```

另请注意，我使用带 IntPtr 作为参数的 GetWindowLongPtr、SetWindowLongPtr 和 SetWindowPosPtr，而不是 GetWindowLong、SetWindowLong 和 SetWindowPos int/uint。这是因为 x86/x64 兼容性。

这是我如何导入 GetWindowLongPtr

```
 [DllImport("user32.dll", EntryPoint = "GetWindowLong")]
    public static extern int GetWindowLong(IntPtr hWnd, int nIndex);

    [DllImport("user32.dll", EntryPoint = "GetWindowLongPtr")]
    public static extern IntPtr GetWindowLong64(IntPtr hWnd, int nIndex);

    public static IntPtr GetWindowLongPtr(IntPtr hWnd, int nIndex)
    {

        if (IntPtr.Size == 8)
        {

            return GetWindowLong64(hWnd, nIndex);
        }
        else
        {

            return new IntPtr(GetWindowLong(hWnd, nIndex));
        }
    } 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-22T21:44:45.677

我解决了您关于以下几点的问题：

> 我无法恢复菜单

关于你在另一点的问题

> 我需要删除边框两次，第一次菜单栏仍然存在。

抱歉，我**没有**解决方案，但我希望其他人能提供帮助。

删除定义您在问题中发布的 RemoveBorders 方法的所有代码，然后选择我在下面发布的所有以下代码**（**如果有效，请使用 Ctrl + A），复制它（鼠标右键单击 => 选择“复制"**或者**只是按 Ctrl + C 更快），然后将其粘贴（鼠标右键单击 => 选择“粘贴”**或**只是按 Ctrl + V 更快）到您的代码。在粘贴新代码之前，请确保代码编辑器中光标的位置位于定义 RemoveBorder 方法的旧代码所在的正确位置。我重新定义 RemoveBorders 的新代码是：

```
public IntPtr RemoveBorders(IntPtr WindowHandle, IntPtr MenuHandle)
{
    if (MenuHandle == IntPtr.Zero)
    {
        MenuHandle = GetMenu(WindowHandle);
        int count = GetMenuItemCount(MenuHandle);
        for (int i = 0; i < count; i++)
            RemoveMenu(MenuHandle, 0, (0x40 | 0x10));
    }
    else
    {
        SetMenu(WindowHandle,MenuHandle);
    }

    int WindowStyle = GetWindowLong(WindowHandle, -16);

    //Redraw
    DrawMenuBar(WindowHandle);
    SetWindowLong(WindowHandle, -16, (WindowStyle & ~0x00080000));
    SetWindowLong(WindowHandle, -16, (WindowStyle & ~0x00800000 | 0x00400000));
    return MenuHandle;
} 
```

从您的旧版本到我的新版本 RemoveBorders 方法所做的更改：

首先，方法的返回值从`void`变为`IntPtr`，所以代码行

`return MenuHandle;`

已添加到您上次调用`SetWindowLong`函数的下方。此更改的目的是对 RemoveBorders 进行编程，以返回属于该窗口的菜单句柄（在 C# 中为 IntPtr 类型），然后再将其边框从窗口中移除。这很重要，因为下次您再次调用 RemoveBorders 以恢复窗口的边框时，您需要归还其菜单的句柄。所以这就是 RemoveBorders ( `bool remove`) 的第二个参数被更改为的原因`IntPtr MenuHandle`，以允许您返回窗口的菜单并恢复其边框。结果，我不得不`IntPtr`在第一行代码中删除之前的 MenuHandle，以声明 MenuHandle 不再是**局部**变量，而是现在它是一个参数。将此参数设置为 IntPtr.Zero（这意味着`NULL`在 C++ 中），只要您想**删除**窗口的边框。由于删除参数已被替换，因此在我的新版本中不再存在，代码行`if (remove)`更改为

`if (MenuHandle == IntPtr.Zero)`

它会检查您是否没有为窗口提供任何菜单句柄，然后您想要删除它的边框。该操作在 if 语句中完成。如果你还给了窗口的菜单，那么MenuHandle 不是`NULL`（即`IntPtr.Zero`），然后代码被带入else 语句进行恢复。最后一个**非常重要的**更改是在调用 GetMenuItemCount 函数之前，在 if 语句块中移动第一行代码，删除 IntPtr 和调用 GetMenu 函数的位置，因为我们需要获取窗口的菜单并保留它，之前它的边界将被移除，而且**并非总是如此**. 如果没有这个更改，您将无法恢复窗口的边框，因为第一行代码将“丢弃”您返回的窗口菜单，因为您在窗口没有菜单时调用 GetMenu 函数，所以该函数的返回值为 NULL（C# 中的 IntPtr.Zero），因此在 else 块中，您将窗口的菜单设置为`IntPtr.Zero`（这意味着`NULL`在 C++ 中）。通过此更改，新的 RemoveBorders 方法应该可以正常工作，并允许您恢复窗口的边框。

从现在开始，您应该使用我的新版本来 RemoveBorders 而不是您的旧版本，以便能够恢复窗口的边框。我希望你能理解我在这个变化中的想法。说明很简单：定义类型的新变量`IntPtr`，并且每当您调用 RemoveBorders 以删除窗口的边框时，将该变量分配给该方法的返回值，以便在删除边框后保留并保存窗口的菜单。稍后您再次调用 RemoveBorders，但现在要恢复窗口的边框，因此您将第二个参数设置为保留窗口菜单的变量，即先前调用 RemoveBorders 方法的返回值。希望对你有帮助！

# google-docs-api - Google Document List API - 通过路径获取集合或项目？

> ID：10337684
> 
> 赞同：5
> 
> 时间：2012-04-26T16:38:19.727
> 
> 标签：google-docs-api, google-drive-api

我目前正在开发一个谷歌驱动客户端。[本](https://developers.google.com/google-apps/documents-list/)文档描述了如何通过 ID 访问集合或项目。但是怎么可能通过它的路径得到一个项目呢？

比如我想得到一个文件/documents/pictures/sunshine.png。如何在不知道其 ID 的情况下获取此文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T08:43:00.970

Alian，我对 Van Coding 也有同样的感觉。我的应用程序我只是使用 google doc 作为文档数据库。

我不想向我的客户公开 google doc UI。如果用户想编辑一个文件，我所做的就是以 html 格式下载该文件并将其显示在 html 编辑器中。

我大多数时候只知道一个文件名（因为它对用户来说比 resouceID 更敏感）并且需要在 google doc 中找到这个文件。因此，如果我可以通过路径访问文件将非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T18:33:24.657

使用当前版本的 API，无法通过文件名直接访问文件。此限制是由于用户可以在同一文件夹中拥有多个具有相同名称的文件。

访问文件的唯一方法是通过其 ID。该路径不是必需的，因为文件的元数据包含 parentsFolder 信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T20:03:34.903

您可以使用[google docs api](https://developers.google.com/google-apps/documents-list/#getting_a_list_of_documents_and_files)，并通过标题参数进行搜索，如果您在驱动器中使用某些应用程序制作了一些文档，则会返回该文档，我认为您必须添加范围[https://www.googleapis.com /auth/drive.file](https://www.googleapis.com/auth/drive.file)来获得授权。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-06T07:23:49.773

您可以通过查看 URL 来获取文档 ID。例如，如果我在浏览器中打开了一个文档，并且 URL 是：

[https://docs.google.com/a/apps.kingsacademy.edu.jo/document/d/1tb6oqih33k1BhadraHNdozizAB7kok-8WRHo_35xeVA/edit](https://docs.google.com/a/apps.kingsacademy.edu.jo/document/d/1tb6oqih33k1BhadraHNdozizAB7kok-8WRHo_35xeVA/edit)

那么Doc​​ument ID是：1tb6oqih33k1BhadraHNdozizAB7kok-8WRHo_35xeVA

# php - 如何使用 PHP 实现 OWASP 规则 5 来缓解 XSS

> ID：10337687
> 
> 赞同：2
> 
> 时间：2012-04-26T16:38:35.953
> 
> 标签：php, javascript, xss, owasp

[OWASP 规则 5](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet#RULE_.235_-_URL_Escape_Before_Inserting_Untrusted_Data_into_HTML_URL_Parameter_Values) 有人可以向我解释一下这是什么意思以及如何在 PHP 中实现它吗？

> 不要使用 URL 编码对完整或相对 URL 进行编码！如果不受信任的输入被放置到 href、src 或其他基于 URL 的属性中，则应该对其进行验证以确保它没有指向意外的协议，尤其是 Javascript 链接。然后应该像任何其他数据一样根据显示的上下文对 URL 进行编码。例如，HREF 链接中的用户驱动 URL 应该是属性编码的。

这个关于 SO 的答案似乎涵盖了其中的一部分： [输入是 URL，如何](https://stackoverflow.com/questions/1699231/input-is-url-how-to-protect-it-from-xss) 使用 makeHTMLAttributeSafe($string) 函数保护它免受 xss 的影响。但是如何检查它是否是“意外协议或 javascript 链接”？我应该搜索和替换某些“坏”关键字，如“javascript”、“脚本”、“onload”等吗？我的任何用户都没有必要输入这些术语的充分理由，因此我可以在必要时采用相当严厉的方法删除列入黑名单的术语。我花了很多时间试图理解 xss，并且非常感谢对此进行澄清。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:45:03.700

白名单，不要黑名单。`itms://`总会有您不知道的新协议（例如，iTunes用于其自身目的）。

选择您想要在链接中支持的协议（可能`http://`、`https://`、`mailto://`和可能`ftp://`）并阻止任何以不同协议开头的链接。

# c++ - MFC 应用程序静默关闭

> ID：10337688
> 
> 赞同：0
> 
> 时间：2012-04-26T16:38:37.777
> 
> 标签：c++, c, windows-xp

我不确定发生了什么。尽管启用了 Windows 错误报告，但未显示错误消息。我什至尝试从对话框析构函数中记录/显示消息。不知道如何调试它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:49:41.593

您可以使用[Process Dumper](http://www.microsoft.com/download/en/details.aspx?id=4060)在任何进程退出时获取内存转储。结果的事后调试可能有助于确定原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:04:13.747

您是否尝试过在调试器中运行它？如果它是 MFC 应用程序，它可能可以在 Visual C++ 调试器中运行。如果程序运行完成而没有错误，那么调试器——就像调试器经常做的那样——掩盖了真正的问题。然后建议使用@Steve Townsend 对 Process Dumper 的建议。

# asp.net - 从页面方法返回的字符串是html文本，无法返回显示在页面中

> ID：10337691
> 
> 赞同：0
> 
> 时间：2012-04-26T16:38:51.957
> 
> 标签：asp.net, vb.net, pagemethods

在我的应用程序中，我可以使用 pagemethods 从客户端调用服务器端函数。这没问题。我感到困惑的是服务器端函数的返回。我正在向客户端返回一个字符串（html 文本），该字符串应该在执行时运行并显示。

过去，我们使用 RS.Execute 来调用这些函数，调用后返回的 html 会显示在页面上。既然我们已经切换到pagemethods让应用程序在多个浏览器中工作，那么如何在success函数中让返回的html填充到页面中呢？感谢您的帮助。

代码示例

这是我的一个 java 脚本函数中的 pagemethod 调用

```
PageMethods.LoadChild(lnEntityID, lnEntityCat, GLOBALEQUIPID, FullExpand, 0,0, onSuccess, onFail); 
```

这行得通，因为我能够跟踪服务器端函数并看到被命中的函数——除了 LoadChild 返回一个字符串之外，你不需要更多的代码示例——这实际上是 html 文本。我的问题是需要在 onSuccess Javascript 函数中放置什么，以便 LoadChild 返回的文本可以放置在页面上，以便新的 div 和表格行（这是 html 返回的文本所代表的）立即显示在页面上随着我们的重新加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:50:37.690

假设您的页面上有：

```
<div id="myResult"></div> 
```

那么你的 onSuccess 脚本函数就是：

```
function onSuccess(args) {
    document.getElementById("myResult").innerHTML = args;
} 
```

# c++ - C++ 将查询字符串的所有值连接成一个字符串

> ID：10337695
> 
> 赞同：2
> 
> 时间：2012-04-26T16:39:01.940
> 
> 标签：c++, query-string, arrays

如果我得到一个指向字符数组的指针，比如说

```
char *c = .... 
```

和 c 指向一个字符数组，看起来像

```
0=A&1=B&2=C&3=D&4=E&5=F&6=G&7=H&8=I&9=J&10=K&11=L 
```

我将如何只获取此查询字符串中的值，并将其转换为另一个 char 数组或 std 字符串，如下所示：

```
ABCDEFGHIJKL 
```

**编辑：** 另外，我想您也可以先将 c 指向的 char 数组转换为字符串，我只是不确定如何解析字符串。
**编辑 2：** 另外，可能很方便知道的是该值只能是 1 个字符长（所以只有 1 个字母）。但是，名称（数字）可以是许多数字长......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:45:02.487

假设你有提升以下应该工作。

```
std::string str(c);
std::remove_if(str.begin(), str.end(), boost::is_any("123456789&=")); 
```

如果没有，我们可以自己制作。

```
struct is_any {
    std::string filter; 
    is_any(std::string filter) : filter(filter) {}
    bool operator()(char a){ return filter.find(a) != std::string::npos;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:46:56.070

使用 boost::split()。请参阅此类似问题的答案[https://stackoverflow.com/a/236976/10468](https://stackoverflow.com/a/236976/10468)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:54:00.230

如果你不想或不能使用 Boost，你也可以像这样提取值：

```
const char *query="0=A&1=B&2=C&3=D&4=E&5=F&6=G&7=H&8=I&9=J&10=K&11=L";
std::string values;
for (const char *p=query+1; *p; ++p) 
  if (p[-1]=='=')
    values += *p; 
```

字符串*值*包含结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:59:50.317

```
std::vector<char> results;
const char* str = "0=A&1=B&2=C&3=D&4=E&5=F&6=G&7=H&8=I&9=J&10=K&11=L";
const char* str_end = str + strlen(str);
const char* token = strstr(str, "=");
while(token && (token + 1 < str_end))
{
   results.push_back(*(++token));
   first_token = strstr(token, "=");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T17:06:12.773

好的旧字符串迭代：

```
char* str = "0=A&1=B&2=C&3=D&4=E&5=F&6=G&7=H&8=I&9=J&10=K&11=L";
int str_sz = strlen(str);

char dst[str_sz+1];
memset(dst, 0, str_sz+1);
int idx = 0;

for (int i = 0; i < str_sz; i++)
{   
    if (str[i] == '=')
    {   
        dst[idx] = str[i+1];
        idx++;
    }   
}   

std::cout << dst << std::endl; 
```

# ruby - 如何将自定义功能分配给格式动作？

> ID：10337698
> 
> 赞同：5
> 
> 时间：2012-04-26T16:39:23.797
> 
> 标签：ruby, formtastic

我的表格：

```
<%= semantic_form_for(@campaign) do |f| %>
...
  <%= f.actions do %>
    <%= f.action :submit, label: "Save"%>
    <%= f.action :submit, label: "Save & New" %>
    <%= f.action :cancel, label: "Cancel"%>
  <% end %>
<% end %> 
```

Campaign_controller.rb 中的函数：

```
 def save_and_new
    print 'SAVE_AND_NEW'
    @campaign = Campaign.find(params[:id])

    respond_to do |format|
      if @campaign.update_attributes(params[:campaign])
        format.html { redirect_to new_campaign_path, notice: 'Campaign was successfully usaved.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @campaign.errors, status: :unprocessable_entity }
      end
    end
  end 
```

路线.rb：

```
 resources :campaigns do 
    member do
      post 'save_and_new'
    end
  end 
```

路线，按功能：

```
save_and_new_campaign POST   /campaigns/:id/save_and_new(.:format) campaigns#save_and_new 
```

唯一我不明白的是，在调用函数时要写什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:32:15.477

我不确定你到底想用这个`save_and_new`动作做什么，但我可以告诉你为什么你没有触发它。

默认情况下，您使用 formtastic 创建的表单`semantic_form_for`将使用 RESTful 约定，即点击`create`新记录的`update`操作和现有记录的操作。如果您使用第一个提交按钮（标记为“保存”）成功点击`create`/`update`操作，但您希望第二个“保存和新建”按钮执行不同的操作，则需要检查`params[:commit]`控制器中 fork的值您对提交的处理。也许一些代码会更清楚。假设您正在提交更新现有记录：

```
def create
  if params[:commit] == "Save"
    # code for handling "Save" scenario
  else
    # code for handling "Save & New" scenario, perhaps even directly call:
    save_and_new
  end
end

def update
  if params[:commit] == "Save"
    # code for handling "Save" scenario
  else
    # code for handling "Save & New" scenario, perhaps even directly call:
    save_and_new
  end
end 
```

同样，我不清楚您要通过该`save_and_new`操作完成什么，并且质疑该假设可能会使您走上更好设计的道路，但要回答您的直接问题：检查`params[:commit]`in的值`create`或`update`应该让您正确的轨道。

# meteor - 流星包d3

> ID：10337699
> 
> 赞同：3
> 
> 时间：2012-04-26T16:39:26.577
> 
> 标签：meteor

因此，我查看了有问题的说明 How to build a Meteor package 并使用此代码为可视化库 d3 创建了一个

```
Package.describe({
 summary: "Make cool visualizations with d3"
});

Package.on_use(function (api) {
  api.use('d3', 'client');
  api.add_files('d3.v2.js', 'client');
}); 
```

我从我的 github checkout 运行了流星脚本（我添加这个包的地方）。然后我创建了一个新的流星应用程序，但我仍然没有看到 d3 被包含在内......我错过了一步吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T20:11:53.727

确保您运行的是自定义版本的流星，而不是默认安装。

然后`<your meteor> add <your package name>`从项目的根目录运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T23:21:49.713

补充一点。使用 d3 时，我从 Meteor 收到错误，直到我删除了上面包文件中的“服务器”引用。

# facebook - 页面选项卡中的 Facebook 应用程序不向非页面管理员用户显示？

> ID：10337701
> 
> 赞同：1
> 
> 时间：2012-04-26T16:39:34.580
> 
> 标签：facebook, facebook-apps, facebook-page

我遇到了最奇怪的问题。

我正在尝试实时发布我的页面标签 iframe 应用程序以供所有人查看，但由于某种原因，它不会出现在任何不是页面管理员的人身上。

我已使用此代码添加到可能页面`http://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL`

我认为它可能是沙盒模式，但它肯定被禁用了——而且它不是应用程序管理员，而是页面管理员可以看到它。所有正常的页面访问者都看不到它。

这就像我创建的第 5 页标签应用程序，我不明白为什么它没有出现在非页面管理员面前。

还有什么我可能错过的吗？我找不到任何不同的东西。

谢谢乔什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:11:13.420

在新的时间线 facebook 布局中，非页面管理员一次只能看到 12 个选项卡框。

我尝试添加的最新选项卡应用程序是 13 号框 - 因此没有人可以看到它。

当我以页面管理员身份登录时，显示所有选项卡的按钮中有一个数字 9。如果我然后以非管理员身份查看该页面，它会显示数字 8 - 并且没有选项可以展开或查看额外的隐藏选项卡。

选项卡列表末尾的选项卡是隐藏的，只有 12 个是可见的。

希望这可以帮助某人。

据我所知，无论您将喜欢计数选项卡框放在哪里，如果它超过第 12 位，它将与第 12 位交换位置。所以它总是可见的。

![在此处输入图像描述](../Images/0da7eda931716a32366392a9995efd93.png)

# .net - 使用来自内容页面事件处理程序的母版页方法更新母版页更新面板中的母版页文字

> ID：10337702
> 
> 赞同：2
> 
> 时间：2012-04-26T16:39:35.267
> 
> 标签：.net, updatepanel, master-pages

如何使用母版页方法从内容页事件处理程序修改母版页控件？这就是 .Net w/VB.Net

我在包含跟踪代码的母版页中有一个文字控件。内容页面有两个更新面板，通过注册表单控制流程。内容页面的更新面板 1 中按钮的事件处理程序必须更改母版页文字中的文本以发出转换信号。

*   在单独的确认页面上使用 PageLoad（表明所使用的母版页方法确实可以正常工作）：使用母版页方法，我可以在页面加载时使用母版页属性更改文字：myMaster.myProperty = myValue。在母版页属性中显示 Set myLiteral.Text = GetTheRightText(value) End Set
*   使用内容页面 UpdatePanels：通过简单的分配，我可以这样更改文字： myMaster.myUpdatePanelPropertyOrMethod = myValue 在 masterpage 方法或属性中显示 myLiteral.Text = value, myUpdatePanel.Update
*   使用 UpdatePanels：使用 masterpage 方法的任何内容都会导致更新面板为空：myLiteral.Text = GetTheRightText(value)，myUpdatePanel.Update 为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-29T04:49:43.853

这已经很晚了，但我刚刚找到了一个选项，因为我正在寻找类似的东西。

创建操作 Site.Master 所需的逻辑，然后从内容页面调用您的子/函数。

在您的 Site.Master 页面中

```
public sub DoWork()
'some logic here
End Sub 
```

然后在您的内容页面中，您需要“工作”的地方放置这个......

```
TryCast(Me.Master, SiteMaster).DoWork() 
```

希望这对您或某人有所帮助！

# solr - Solr 1.4：没有使用自定义 UpdateRequestProcessorFactory 提交

> ID：10337705
> 
> 赞同：0
> 
> 时间：2012-04-26T16:39:49.100
> 
> 标签：solr, processor, dih

我在 DIH 中使用 UpdateRequestProcessorChain 并得到数据未提交到索引的问题。我试图调试我的处理器并且它可以工作。完全导入命令的状态是：

```
<response>
<lst name="responseHeader">
    <int name="status">0</int>
    <int name="QTime">1</int>
</lst>
<lst name="initArgs">
    <lst name="defaults">
        <str name="update.processor">DataImportChain</str>
        <str name="config">data-config.xml</str>
    </lst>
</lst>
<str name="command">status</str>
<str name="status">idle</str>
<str name="importResponse"/>
<lst name="statusMessages">
    <str name="Total Requests made to DataSource">0</str>
    <str name="Total Rows Fetched">7</str>
    <str name="Total Documents Skipped">0</str>
    <str name="Full Dump Started">2012-04-26 17:47:44</str>
    <str name="">Indexing completed. Added/Updated: 6 documents. Deleted 0 documents.</str>
    <str name="Committed">2012-04-26 17:47:45</str>
    <str name="Optimized">2012-04-26 17:47:45</str>
    <str name="Total Documents Processed">6</str>
    <str name="Time taken ">0:0:1.174</str>
</lst>
<str name="WARNING">This response format is experimental.  It is likely to change in the future.</str> 
```

但是 catalina.out 中没有信息表明调用了提交过程：

```
26.04.2012 17:47:44 org.apache.solr.handler.dataimport.DataImporter doFullImport
INFO: Starting Full Import
26.04.2012 17:47:44 org.apache.solr.core.SolrCore execute
INFO: [dev] webapp=/solr path=/dataimport params={clean=true&commit=true&command=full-import} status=0 QTime=20 
26.04.2012 17:47:44 org.apache.solr.handler.dataimport.SolrWriter readIndexerProperties
INFO: Read dataimport.properties
26.04.2012 17:47:45 org.apache.solr.handler.dataimport.XPathEntityProcessor initXpathReader
INFO: Using xslTransformer: com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl
26.04.2012 17:47:45 org.apache.solr.handler.dataimport.DocBuilder finish
INFO: Import completed successfully
26.04.2012 17:47:45 org.apache.solr.handler.dataimport.SolrWriter readIndexerProperties
INFO: Read dataimport.properties
26.04.2012 17:47:45 org.apache.solr.handler.dataimport.SolrWriter persist
INFO: Wrote last indexed time to dataimport.properties
26.04.2012 17:47:45 org.apache.solr.handler.dataimport.DocBuilder execute
INFO: Time taken = 0:0:1.174 
```

日志中没有任何错误。如果我在没有 UpdateRequestProcessorChain 的情况下使用 DIH，则提交没有问题。有人知道这里可能出了什么问题吗？

这是我的 solrconfig.xml 中的配置：

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
        <str name="update.processor">DataImportChain</str>
        <str name="config">data-config.xml</str>  
    </lst>
</requestHandler>

<updateRequestProcessorChain name="DataImportChain" >
    <processor class="my.package.MyProcessorFactory" />
</updateRequestProcessorChain> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T08:39:31.830

您在 中遗漏了一些基本处理器`updateRequestProcessorChain`，这就是为什么没有任何反应。试试这个配置：

```
<updateRequestProcessorChain name="DataImportChain" >
    <processor class="my.package.MyProcessorFactory" />
    <processor class="solr.RunUpdateProcessorFactory" />
    <processor class="solr.LogUpdateProcessorFactory" />
</updateRequestProcessorChain> 
```

事实上，它`RunUpdateProcessorFactory`是在链中做“普通事情”的那个。如果你忘记了它，你正在预处理一些从未被索引的东西。

# ruby - 在 ruby 中猴子修补类的推荐方法

> ID：10337712
> 
> 赞同：29
> 
> 时间：2012-04-26T16:40:33.087
> 
> 标签：ruby, monkeypatching

我注意到在 ruby​​ 中有两种常见的猴子修补类的方法：

像这样定义类的新成员：

```
class Array
   def new_method
     #do stuff
   end
end 
```

并在类对象上调用 class_eval：

```
Array.class_eval do
   def new_method
      #do stuff
   end
end 
```

我想知道两者之间是否有任何区别，以及使用一种方法是否比另一种方法有优势？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-26T18:33:46.450

老实说，我曾经使用第一种形式（重新开课），因为它感觉更自然，但你的问题迫使我对这个主题进行一些研究，结果如下。

重新打开课程的问题在于，如果您打算重新打开的原始课程由于某种原因目前尚未定义，它将默默地定义一个新课程。结果可能不同：

1.  如果您不覆盖任何方法而只添加新方法并且定义了原始实现（例如，加载了最初定义类的文件），那么以后一切都会好起来的。

2.  如果您重新定义了一些方法并且稍后加载原始方法，您的方法将被其原始版本覆盖。

3.  最有趣的情况是当您使用标准[自动加载](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-autoload)或一些花哨的重新加载机制（如 Rails 中使用的机制）来加载/重新加载类时。其中一些解决方案依赖于引用未定义常量时调用的[const_missing](http://ruby-doc.org/core-1.9.3/Module.html#method-i-const_missing)。在这种情况下，自动加载机制会尝试找到未定义类的定义并加载它。但是，如果您自己定义类（而您打算重新打开已经定义的类），它将不再“丢失”，并且可能根本不会加载原始类，因为不会触发自动加载机制。

另一方面，如果您使用`class_eval`当前未定义类，您将立即收到通知。此外，当您在调用其`class_eval`方法时引用该类时，任何自动加载机制都将有机会定位类的定义并加载它。

考虑到这一点`class_eval`似乎是一种更好的方法。不过，我很乐意听到其他意见。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-01-13T02:09:43.363

**范围**

我认为 KL-7 没有指出的一大区别是新代码的解释范围：

如果您（重新）打开一个类来操作它，您添加的新代码将在（原始）类的范围内解释。
如果您使用[Module#class_eval](http://ruby-doc.org/core-2.3.0/Module.html#method-i-class_eval)来操作一个类，则您添加的新代码将在您对 #class_eval 的调用周围的范围内解释，并且不会知道类范围。如果不知道，这种行为可能违反直觉，并导致难以调试的错误。

```
CONSTANT    = 'surrounding scope'

# original class definition (uses class scope)
class C
  CONSTANT  = 'class scope'

  def fun()  p CONSTANT  end
end
C.new.fun    # prints: "class scope"

# monkey-patching with #class_eval: uses surrounding scope!
C.class_eval do
  def fun()  p CONSTANT  end
end
C.new.fun    # prints: "surrounding scope"

# monkey-patching by re-opening the class: uses scope of class C
class C
  def fun()  p CONSTANT  end
end
C.new.fun    # prints: "class scope" 
```

# asp.net - 如何用 FileUpload 控件的图像替换浏览器按钮？

> ID：10337713
> 
> 赞同：2
> 
> 时间：2012-04-26T16:40:39.880
> 
> 标签：asp.net, image, file-upload

我的页面中有一个 FileUpload 控件，如下所示。默认情况下，它有一个 Browse... 按钮。我想用具有自定义图像的 ImageButton 替换它。谁能告诉我如何实现这一目标？

```
<td width="40%" valign="top" align="center">
                <asp:FileUpload ID="FileUpload1" runat="server" />
</td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-30T01:43:08.883

经过一番搜索，我终于找到了[这个答案](https://stackoverflow.com/a/31047057/2228227)。由于我只需要用我的图像替换默认的“选择文件”按钮，因此我删除了大部分样式并更改了标记以满足我的需要。

我最终得到：

```
.file-upload {
  cursor: pointer;      
}

.file-upload input {
  top: 0;
  left: 0;
  margin: 0;
  /* Loses tab index in webkit if width is set to 0 */
  opacity: 0;
  filter: alpha(opacity=0);
} 
```

```
<label class="file-upload">
  <img src="../myimage.png" />
  <asp:FileUpload ID="myfile" runat="server" />
</label> 
```

我希望这可以帮助其他寻找类似解决方案的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-01T13:20:39.707

就像 Michael Leanos 的回答一样，但我做出了改变：

```
<style type="text/css">
    .file-upload 
    {
        cursor: pointer;      
    }

    .file-upload input 
    {
        /* the same icon width/heght */
        width:70px;
        height:70px;
        /* a z-index higher than the icon */
        z-index:999;
        /* less opcacity as possible */
        opacity: 0.01;        
        filter: alpha(opacity=0);
    }
</style> 
```

/* 在图标上尽可能的不透明度和低 z-index */

```
<label class="file-upload">
    <asp:FileUpload ID="up_Allegato" runat="server" type="file" accept="image/*" _capture="camera" Style="position: absolute; right: 100px; top: 150px; height: 70px; line-height: 19px;" />
    <asp:ImageButton ID="bt_Photo" runat="server" Visible="true" ImageUrl="images/action_edit24 x 200.png" OnClientClick="return false;" Style="position: absolute; right: 100px; top: 150px; height: 70px; line-height: 19px;z-index:6 ;opacity:100"/>
 </label> 
```

# javascript - 我在哪里可以找到 Closure 编译器的 jQuery Mobile 外部文件？

> ID：10337714
> 
> 赞同：2
> 
> 时间：2012-04-26T16:40:40.897
> 
> 标签：javascript, jquery-mobile, annotations, google-closure-compiler

我认为一切都在标题中，但对于那些想要一些上下文的人，我正在寻找一个用于 jQuery Mobile 的外部文件，以便以高级方式使用 Google Closure Compiler。

或者，有没有办法以优雅有效的方式生成此类文件？

我找不到任何东西，实际上我越来越接近手动定义我使用的函数，但它的效率非常低。欢迎帮助！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:51:40.577

据我所知，没有一个——至少没有人讨论过一个。一般来说，也没有一种简单的方法可以从 jQuery 代码生成外部变量。

主要的 jQuery externs 当前是从 api XML 生成的。我不知道 jQuery mobile 有这样的提要，这进一步增加了难度。

您最好的选择是手动编写外部变量。

# excel - 分解单元格的值并将分隔符两侧的值相乘

> ID：10337723
> 
> 赞同：0
> 
> 时间：2012-04-26T16:41:05.753
> 
> 标签：excel, excel-formula

我正在为我工​​作的学校的印刷设施开一张发票。

我非常接近，几乎可以正常工作。基本上我有一个纸张尺寸值的列表，可以从列表中的单元格中选择。如果选择与任何值匹配，则公式将对纸张区域进行数学运算。但我希望能够插入自定义纸张尺寸，例如“24x19”，并让公式计算出来。

我尝试将公式放入单元格中，例如“24 * 19”，但可以获得excel来实际进行数学运算 - 只需返回值。

因此，我继续尝试通过搜索“x”两侧的所有字符并重新声明其值来更改单元格的值，如下所示：

```
D12=((LEFT(D12(SEARCH("x", D12, 1))))*((RIGHT(D12(SEARCH("x", D12, 1)))) 
```

但也没有骰子，我只得到“#VALUE！”

作为第二个问题 - 我也不喜欢下面的 OR 实例。必须重新声明纸张大小的每个实例将很难维护 - 这可以简化吗？我渴望一个ELSE！任何帮助将不胜感激。

```
=IF(D12="A5",14.8*21,IF(D12="A4", 21*29.7,IF(D12="A3",29.7*42,IF(D12="A33",32.9*48.3,IF(D12="A2",42*59.4, IF(D12="A1",59.4*84.1, IF(OR(D12<>"A5", D12<>"A4",D12<>"A3",D12<>"A3+",D12<>"A2",D12<>"A1"), D12=((LEFT(D12(SEARCH("x", D12, 1))))*((RIGHT(D12(SEARCH("x", D12, 1)))) ))))))) 
```

感谢您的帮助和经验

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:25:01.970

假设您在单元格编号 D12 中有“24x19”。

将以下公式放在您想要答案的地方

```
=VALUE(LEFT(D12,FIND("x",D12)-1))*VALUE(RIGHT(D12,LEN(D12)-FIND("x",D12))) 
```

用您拥有的任何单元格替换上述公式中的 D12

# c# - 使用 sql 查询 (gridview) 从 dataTable 中检索值

> ID：10337736
> 
> 赞同：0
> 
> 时间：2012-04-26T16:42:06.903
> 
> 标签：c#, asp.net, sql

在行更新事件中，我想使用 sql 命令获取一个值，我知道我可以使用 e.oldvalues/e.newvalues 获取它。但我想用 sql 。这是我尝试过的：

```
 SQL = "SELECT Name FROM MyTable where RowID=@RowID";
          SqlDataSource1.SelectCommand = SQL;
            Label1.Text = SQL.ToString(); 
```

*   我得到错误：必须声明标量变量“@RowID”。

但是已经创建了 RowID 列 -> 键入 int ，递增 1 ，主键。

我不知道为什么不工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:58:44.253

select 语句`SELECT Name FROM MyTable where RowID=@RowID`要求`@RowID`从某处获得一个值。您将需要定义一个指定值的 SQL 参数，否则 SQL 将不知道要查看哪个记录来返回该`Name`字段。

`@RowID = SCOPE_IDENTITY()``MyTable`如果您在存储过程中并且想要使用该新记录，则会为您提供刚刚插入的记录的主键值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T05:27:35.230

在下面的示例中，我在网格中显示数据，然后允许用户异步激活或停用评论。我正在使用 UPDATE PANEL 来异步激活它。

您需要同时使用 rowDataBound 和 RowCommand 事件来实现这一点

通过这种方式，您可以获得行的 id 并查看您想对该行执行的操作，无论是编辑、删除还是像我在此示例中所做的那样，我更新**了一个 COLUMN**

```
 <asp:GridView ID="gvSHowMostViewedArticles"  runat="server" AllowPaging="True" 
         AutoGenerateColumns="False"  Width="920px" BackColor="White" 
         BorderColor="#CCCCCC" BorderStyle="None" BorderWidth="1px" CellPadding="4" 
         Font-Names="Verdana" Font-Size="X-Small" ForeColor="Black" 
         GridLines="Horizontal" PageSize="10"   onrowdatabound="gvSHowMostViewedArticles_RowDataBound" 
onrowcommand="gvSHowMostViewedArticles_RowCommand" onpageindexchanging="gvSHowMostViewedArticles_PageIndexChanging">

         <Columns>
          <asp:TemplateField HeaderText="Sno">
                <ItemTemplate>
                  <%# Container.DataItemIndex + 1 %>
               </ItemTemplate>
          </asp:TemplateField>
   <asp:BoundField DataField="ArticleTitle" HeaderText="Article Title" />
   <asp:BoundField DataField="FullName" HeaderText="Name" />
   <asp:BoundField DataField="Country" HeaderText="Country" />

<asp:TemplateField HeaderText="Message">
       <ItemTemplate>
           <asp:LinkButton ID="lnkBtnShowMessage" runat="server" Text="Read" CommandName="showMessage" CommandArgument='<%# Eval("ID") %>' />
                                                </ItemTemplate>
                                         </asp:TemplateField>
                                        <asp:TemplateField HeaderText="Activate">
                                                <ItemTemplate>
                                                    <asp:LinkButton ID="lnkBtnActivateComment" runat="server" Text="Activate" CommandName="ActivateComment" CommandArgument='<%# Eval("ID") %>' />
                                                </ItemTemplate>
                                         </asp:TemplateField>
                                        <asp:TemplateField HeaderText="De Activate">
                                                <ItemTemplate>
                                                    <asp:LinkButton ID="lnkBtnDeActivateComment" runat="server" Text="De-Activate" CommandName="DeActivateComment" CommandArgument='<%# Eval("ID") %>' />
                                                </ItemTemplate>
                                         </asp:TemplateField> 
```

```
 protected void gvSHowMostViewedArticles_RowDataBound(object sender, GridViewRowEventArgs e)
        {
            //Show Message
            LinkButton lb = e.Row.FindControl("lnkBtnShowMessage") as LinkButton;
            if (lb != null)
                ScriptManager.GetCurrent(this).RegisterAsyncPostBackControl(lb);

            //Activate
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                LinkButton lbActivate = e.Row.FindControl("lnkBtnActivateComment") as LinkButton;
                if (lbActivate != null)
                    ScriptManager.GetCurrent(this).RegisterAsyncPostBackControl(lbActivate);

                lbActivate.Attributes.Add("onclick", "javascript:return " +
                "confirm('Are you sure you want to Activate this comment " +
                DataBinder.Eval(e.Row.DataItem, "ID") + "')");
            }
            //De Activate
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                LinkButton lbActivate = e.Row.FindControl("lnkBtnDeActivateComment") as LinkButton;
                if (lbActivate != null)
                    ScriptManager.GetCurrent(this).RegisterAsyncPostBackControl(lbActivate);

                lbActivate.Attributes.Add("onclick", "javascript:return " +
                "confirm('Are you sure you want to De-Activate this comment " +
                DataBinder.Eval(e.Row.DataItem, "ID") + "')");
            }
        }

      protected void gvSHowMostViewedArticles_RowCommand(object sender, GridViewCommandEventArgs e)
        {
            //Show Message
            if (e.CommandName == "showMessage")
            {
                int sno = Convert.ToInt32(e.CommandArgument);
                string strSql = "SELECT * FROM Comments WHERE comID = " + sno;
                DataSet ds = DataProvider.Connect_Select(strSql);
                lblCommentMessage.Text = ds.Tables[0].Rows[0]["comMessage"].ToString();
            }

            // Activate Comment
            if (e.CommandName == "ActivateComment")
            {
                int sno = Convert.ToInt32(e.CommandArgument);
                String strSql = "UPDATE Comments SET Visible = 1 WHERE ID = " + sno;
                DataProvider.Connect_Select(strSql);
                lblCommentMessage.Text = "Activated";
            }

            // De Activate Comment
            if (e.CommandName == "DeActivateComment")
            {
                int sno = Convert.ToInt32(e.CommandArgument);
                String strSql = "UPDATE Comments SET Visible = 0 WHERE ID = " + sno;
                DataProvider.Connect_Select(strSql);

                lblCommentMessage.Text = "Deactivate";

            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:00:51.697

您的代码不知道您的参数。你必须告诉它名称/类型/值。

sqlDataSource.Parameters.Add("@RowId", System.Data.DbType.Int, 1);

# java - 将 HTTP 请求转换为 SOAP 请求

> ID：10337737
> 
> 赞同：2
> 
> 时间：2012-04-26T16:42:07.727
> 
> 标签：java, spring, http, rest, soap

我有一个程序（称为 programA），它在本地计算机上作为 Windows 服务运行，它拦截对端口 80 的任何请求，并在将请求转发到 Web 服务器/应用程序服务器之前对请求进行一些额外的工作。

我有一个应用程序服务器在另一台服务器上运行 Sring MVC 应用程序（programB），该服务器提供页面，这些页面将在运行 programA 的同一台机器上查看。同一个应用服务器运行着一个可以接受 SOAP 消息并返回 SOAP 请求的 Web 服务（programC）。

现在我想做的是使用以下事件序列生成 SOAP 消息。

```
Step 1 - User loads the GUI application (programB) on the browser.  
Step 2 - User selects a link on the page which results in an HTTP request to be generated. 
Step 3 - On its way out, the HTTP request is intercepted by programA and formatted into a SOAP message and forward the request as a SOAP request to the web service (programC).  
Step 4 - The web service(programC) processes the request and returns the SOAP response back to programA.  
Step 5 - programA formats the response and returns it back as an HTTP response back to programA as the response for the original HTTP request for it to be displayed on the GUI. 
```

programA 和 programC 是已经存在的现有应用程序，所以我只需要开发 MVC GUI 和`HTTP --> SOAP`和`SOAP --> HTTP`接口。

我正在努力解决的主要领域是第 3 步和第 5 步。具体来说，从 programB 到 programA 的数据格式是什么。

programA 是一个基于 java 的应用程序，可以接受任何基于文本的格式，并且可以配置为理解最常见的格式（XML、URL 参数等），或者可以更新以支持另一种格式（例如 Json）。

我的主要问题如下：

*   将程序A的请求作为HTTP请求发送到程序B以便程序B可以生成SOAP请求的最常见方法是什么。
*   XML 可能是 programA 最容易处理的格式，但是否可以将 XML 作为 HTTP 请求的一部分发送？我在考虑 Javascript，但有没有一种更简洁的方法来代替手动构建 XML 文本？
*   请求可以在每个链接中包含 name=value 参数。这些可以由programA使用，但听起来不够干净。

你有什么意见，你会使用什么格式？

# google-tv - Google TV VideoView“播放失败”

> ID：10337742
> 
> 赞同：0
> 
> 时间：2012-04-26T16:42:33.003
> 
> 标签：google-tv

我正在尝试在 Sony GTV（Android 3.2）上的 VideoView 中播放视频，当 VideoView 加载时出现“播放失败”对话框。ffmpeg -i 在我的视频中的输出是：

```
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'vz569287a41cd749cd8c0692a64d94453c.mp4':
  Metadata:
    major_brand     : isom
    minor_version   : 512
    compatible_brands: isomiso2avc1mp41
    creation_time   : 1970-01-01 00:00:00
    encoder         : Lavf53.4.0
  Duration: 00:00:21.96, start: 0.000000, bitrate: 1166 kb/s
    Stream #0:0(eng): Video: h264 (Constrained Baseline) (avc1 / 0x31637661), yuv420p, 576x432 [SAR 1:1 DAR 4:3], 1070 kb/s, 23.99 fps, 23.95 tbr, 479 tbn, 47.90 tbc
    Metadata:
      creation_time   : 1970-01-01 00:00:00
      handler_name    : VideoHandler
    Stream #0:1(eng): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, s16, 91 kb/s
    Metadata:
      creation_time   : 1970-01-01 00:00:00
      handler_name    : 
```

根据：[https](https://developers.google.com/tv/android/docs/gtv_media_formats) ://developers.google.com/tv/android/docs/gtv_media_formats应支持带有 aac 音频的 h264 基线，但 B 帧支持有限。有没有办法确定基线配置文件是问题所在？

该视频在运行 ICS 的平板电脑上播放良好（我没有可测试的 Honeycomb 平板电脑）。

该视频可在以下网址找到： [https ://view.vzaar.com/933735/video](https://view.vzaar.com/933735/video)

Logcat 输出（来自 Logitech Revue，Sony 设备不可用）：

```
04-26 18:38:36.409: W/AVInfo(1669): av_open_input_file https://view.vzaar.com/933735/video failed -2
04-26 18:38:36.409: I/MediaPlayerService(1669): getPlayerTypeFromProbe: https://view.vzaar.com/933735/video choose player type 0

04-26 18:40:45.325: I/AudioService(193):  AudioFocus  requestAudioFocus() from android.media.AudioManager@67001460com.google.tv.player.PlayerActivity$7@66c75718
04-26 18:40:45.373: D/MediaPlayer(21235): Couldn't open file on client side, trying server side
04-26 18:40:45.373: I/HDMIPassthru(1669): Creating pure ISMD based HDMIPassthruPlayer for Sodaville platform
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): ui_plane_match: 1, display_mode_size_match: 0, tgtW = 1280, tgtH = 720
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Update Video Params
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Ideal      : 1204x672 @ (38, 24)
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Ideal Crop : 0x0 @ (0, 0)
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Scale      : 1280x720
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Crop       : 1280x720 @ (0, 0)
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Src        : 1280x720 @ (0, 0)
04-26 18:40:45.373: V/GoogleTVMediaApi(1669): Dst        : 1280x720 @ (0, 0)
04-26 18:40:45.373: D/HDMIPassthru(1669): Create ISMD_HDMIPassthruPlayer
04-26 18:40:45.377: I/HDMIPassthru(1669): Got init display mode 1280x720p@59.939999   M
04-26 18:40:45.377: I/HDMIPassthru(1669): Set data source: hdmi://localhost?port=2
04-26 18:40:45.385: D/HDMIPassthru(1669): ISMD_HDMIPassthruPlayer prepareAsync (port=2 ignored, no input port control library detected)
04-26 18:40:45.405: D/MediaPlayer(21235): getMetadata
04-26 18:40:45.405: E/MediaPlayerService(1669): getMetadata failed -38
04-26 18:40:45.409: I/AudioService(193):  AudioFocus  requestAudioFocus() from android.media.AudioManager@67001460com.google.tv.player.PlayerActivity$7@66c75718
04-26 18:40:45.409: D/HDMIPassthru(1669): virtual android::status_t fishtank::ISMD_HDMIPassthruPlayer::setVolume(float, float) 1.000000 1.000000
04-26 18:40:45.409: D/HDMIPassthru(1669): android::status_t fishtank::ISMD_HDMIPassthruPlayer::applyVolume() 0
04-26 18:40:45.409: W/HDMIPassthru(1669): Failed to get dev handle for setOutputVolume.
04-26 18:40:45.409: D/HDMIPassthru(1669): ISMD_HDMIPassthruPlayer start
04-26 18:40:45.409: D/GtvResourceManager(137): Allocate resource holder for context 546063a61f 0x9485718 124
04-26 18:40:45.409: D/GtvResourceManager(137): Allocate resource holder for context 546063a61f 0x9487fc0 125
04-26 18:40:45.409: D/IsmdResourceManager(137): resource update 0 for 4 1 0x9485718
04-26 18:40:45.413: D/HDMIPassthru(1669): Action 0 for device type 4 index 1
04-26 18:40:45.417: D/IsmdResourceManager(137): resource update 0 for 1 0 0x9485718
04-26 18:40:45.417: D/HDMIPassthru(1669): Action 0 for device type 1 index 0
04-26 18:40:45.417: D/IsmdResourceManager(137): resource update 0 for 3 1 0x9485718
04-26 18:40:45.417: D/HDMIPassthru(1669): Action 0 for device type 3 index 1
04-26 18:40:45.417: D/IsmdResourceManager(137): resource update 0 for 0 4 0x9485718
04-26 18:40:45.417: D/HDMIPassthru(1669): Action 0 for device type 0 index 0
04-26 18:40:45.417: I/HDMIPassthru(1669): ISMD Passthru player was assigned plane 4
04-26 18:40:45.449: D/HDMIPassthru(1669): android::status_t fishtank::ISMD_HDMIPassthruPlayer::applyVolume() 0
04-26 18:40:45.449: D/HDMIPassthru(1669): virtual android::status_t fishtank::ISMD_HDMIPassthruPlayer::setVolume(float, float) 1.000000 1.000000
04-26 18:40:45.449: D/HDMIPassthru(1669): android::status_t fishtank::ISMD_HDMIPassthruPlayer::applyVolume() 0
04-26 18:40:45.449: I/AudioService(193):  AudioFocus  requestAudioFocus() from android.media.AudioManager@67001460com.google.tv.player.PlayerActivity$7@66c75718
04-26 18:40:45.449: D/HDMIPassthru(1669): virtual android::status_t fishtank::ISMD_HDMIPassthruPlayer::setVolume(float, float) 1.000000 1.000000
04-26 18:40:45.449: D/HDMIPassthru(1669): android::status_t fishtank::ISMD_HDMIPassthruPlayer::applyVolume() 0
04-26 18:40:45.489: I/HDMIPassthru(1669): IsVideoModeChangeNeeded, no change needed, staying in mode 1280x720p@59.94M
04-26 18:40:45.513: I/HDMIPassthru(1669): Audio Mode Change: 0 format 0 channel 0 Hz (0/0) 0 bits/sample.  Signal absent
04-26 18:40:45.513: I/HDMIPassthru(1669): Audio Input: Muted
04-26 18:40:45.513: W/HDMIPassthru(1669): Invalid audio mode received for dev 32\. (ismd_res = 0) ss 0 fs 0
04-26 18:40:45.513: I/HDMIPassthru(1669): Audio Input: Un-Muted
04-26 18:40:45.513: I/HDMIPassthru(1669): HDCP status = disabled.
04-26 18:40:45.513: I/HDMIPassthru(1669): handleVideoMute: video not muted
04-26 18:40:45.513: E/HDMIPassthru(1669): HDMI Passthru: Video Renderer Error Event Received
04-26 18:40:45.525: D/MediaDevicesService(282): Media devices in use (acquisition - Logitech01@com.logitech.harmony)
04-26 18:40:45.525: D/MediaDevicesService(282):  - Logitech01@com.logitech.harmony
04-26 18:40:45.537: D/DeviceAcquisitionService(333): ON_BIND: (DeviceId) - Logitech01 
```

我目前没有要测试的 Sony 设备，所以从 Logitech Revue 中取出了这个 logcat。奇怪的是，这里发生了一个更糟糕的问题，因为在设置视频 URI 时，Revue 只会显示黑屏，并且任何键盘输入都会导致 ANR。

我开始播放视频的代码如下所示：

```
public void onStart() {
    super.onStart();
    MediaController mc = new MediaController(getSlideActivity());
    mc.setAnchorView(mVideo);
    mVideo.setMediaController(mc);
    mVideo.setVideoURI(Uri.parse("https://view.vzaar.com/933735/video"));
    mVideo.start();
} 
```

我将视频播放代码修改为在 AsyncTask 中，它不再在 Revue 上崩溃（尽管视频不播放）：

```
new AsyncTask<Void, Void, Void>() {
        @Override
    protected Void doInBackground(Void... params) {
        Looper.prepare();   
        MediaController mc = new MediaController(getSlideActivity());
        mc.setAnchorView(mVideo);
        mVideo.setMediaController(mc);
        mVideo.setVideoURI(Uri.parse(mSlide.getMedia()));
        Looper.loop();
        return null;
    }

    @Override
    protected void onPostExecute(Void v) {
        mVideo.start();
    }
}.execute(); 
```

在向上面的 AsyncTask 添加一些日志记录语句后，我发现它永远不会超过调用“setVideoURI”的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T23:53:32.623

Google TV 上的 VideoView 与标准 Android 上的不同，因此根据 Les Vogel (Google TV DevRel)，URI 需要直接指向文件。

# javascript - 为什么我的函数之间的 setTimeouts 不起作用？

> ID：10337743
> 
> 赞同：0
> 
> 时间：2012-04-26T16:42:40.480
> 
> 标签：javascript, jquery, animation, raphael, settimeout

我有一系列拉斐尔动画，我想按特定顺序触发。

1.  淡入曲线。
2.  淡入球中。
3.  沿着曲线为球设置动画。

我在每个函数之间都有一个 setTimeout，但动画只是同时触发。

[在 JSFiddle](http://jsfiddle.net/5sA3Y/)或此处查看它：

```
Raphael("bounce", 640, 480, function () {
        var r = this,
            p =                 r.path("M0,77.255c0,0,269.393,37.431,412.96,247.653 c0,0,95.883-149.719,226.632-153.309").attr({stroke: "#666", opacity: .0, "stroke-width": 1}),
            len = p.getTotalLength(),
        e = r.circle(0, 0, 7).attr({stroke: "none", fill: "#000", opacity:0}).onAnimation(function () {
                var t = this.attr("transform");
            });
        r.customAttributes.along = function (v) {
            var point = p.getPointAtLength(v * len);
            return {
                transform: "t" + [point.x, point.y] + "r" + point.alpha
            };
        };
        e.attr({along: 0});

        var rotateAlongThePath = true;
        function fadecurve(ca,ba,aa,ab){
            ca.animate({opacity:1},2000);
            setTimeout(fadeball(ba,aa,ab),6000);
        }
        function fadeball(ba,aa,ab) {
               ba.animate({opacity:1},400);
               setTimeout(run(ba, aa,ab),5000);
        }
        function run(ba,aa,ab) {
               ba.animate({opacity:1},400);
               ba.animate({along: aa}, ab, ">", function () {
                ba.attr({along: aa});
            });
        }
        fadecurve(p,e,.9,500);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:44:38.977

使用匿名函数，例如：

```
setTimeout(function(){
  fadeball(ba,aa,ab);
},6000); 
```

随着`setTimeout(fadeball(ba,aa,ab),6000);`函数`fadeball`被立即调用，因为`()`这是问题所在。

确保`run`也以这种方式调用函数:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:46:27.820

问题在于你的函数在你的 setTimeout 中引用

```
setTimeout(fadeball(ba,aa,ab),6000); 
```

您在这里所做的是执行该函数，然后将结果分配为您的 setTimeout 的第一个参数，如果您使用匿名函数就可以了。

```
setTimeout(function(){
  fadeball(ba,aa,ab);
},6000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:45:35.703

您正在立即调用您的函数，然后将该函数的结果传递给`setTimeout`. 您需要将函数传递给`setTimeout`：

```
setTimeout(function(){
    fadeball(ba,aa,ab);
},6000); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T17:03:27.383

如果这是题外话，我很抱歉，但你这样做的方式是不可扩展的。虽然像这样设置重复超时适用于一些功能，但随着步数的增加，多步动画变得越来越麻烦。jQuery 可以对动画进行排序，但 jQuery 的内置动画队列通常不提供所需的功能（如瀑布属性）。这是[Frame.js](https://github.com/bishopZ/Frame.js)的更简洁、强大和可扩展的替代方案：

```
 var ca = p, ba = e, aa = .9, ab = 500;
  Frame(500, function(next){
      ca.animate({opacity:1}, 2000, next);
  });
  Frame(4000, function(next){
      ba.animate({opacity:1}, 400, next);
  });
  Frame(5000, function(next){
      ba.animate({opacity:1}, 400);
      ba.animate({along: aa}, ab, ">", next);
  });
  Frame(function(next){
      ba.attr({ along: aa });
      next();
  });
  Frame.init(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T16:47:24.370

JQuery 的 animate 函数有一个动画完成回调，因此您可以连续触发动画：

```
function SecondAnimation() { $('element').animate(....., ThirdAnimation); }
function ThirdAnimation() { $('element').animate(....., FourthAnimation); }
function FourthAnimation() { $('element').animate(.....); }

$('element').animate(....., SecondAnimation); 
```

# php - 如何设置你的 Linux 服务器每分钟执行一个 php 脚本

> ID：10337745
> 
> 赞同：0
> 
> 时间：2012-04-26T16:42:46.760
> 
> 标签：php, linux

如何设置我的 Linux 服务器以每分钟自动执行特定的 php 脚本？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:44:03.023

尝试[Cron 作业](http://en.wikipedia.org/wiki/Cron)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:44:46.493

使用 cron。

参考

*   [http://www.scrounge.org/linux/cron.html](http://www.scrounge.org/linux/cron.html)
*   [http://kevin.vanzonneveld.net/techblog/article/schedule_tasks_on_linux_using_crontab/](http://kevin.vanzonneveld.net/techblog/article/schedule_tasks_on_linux_using_crontab/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:05:40.353

在 linux 下，您可以通过指定脚本的完整路径来使用 crontab，例如：

```
*/2 * * * * /usr/bin/php /home/biji/script.php 
```

或者如果你把脚本放在网上，你可以使用 wget

```
*/2 * * * * wget http://yourserver/script.php -O /dev/null 
```

如果您需要更多的企业解决方案，您可以使用 zend 服务器使用作业队列（但它会很昂贵）：

> [http://www.zend.com/en/products/server/zend-server-job-queue](http://www.zend.com/en/products/server/zend-server-job-queue)

# jquery - 在 Rails 3.1 中放置 jquery/javascript

> ID：10337746
> 
> 赞同：0
> 
> 时间：2012-04-26T16:42:46.877
> 
> 标签：jquery, ruby-on-rails-3

我开始了解 rails 3.1 中的资产管道，现在我正在充分利用 jquery-rails gem 的潜力，即使用

```
 // require jquery_ujs 
```

并且没有将相关的 jquery 库放在我的 assets/javascripts.js 目录中（我知道新手错误）

我的下一个问题与我的 jquery/javascript 脚本在哪里有关。目前我将它们全部放在我的 application.js 文件中。将脚本放在它们相关的相关页面上会更好吗？例如，目前我有一个使用 fullcalendar.js 的日历页面，我是否应该将脚本放在此页面下

```
 <script type="text/javascript"> .........</script> 
```

在页面底部，或者我将其保留在 application.js 文件中。

我还注意到需要 jquery 的页面的渲染似乎加载得更快，这是因为我现在不再调用它们两次了吗？

所有建议表示赞赏

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:58:28.537

将整个脚本放在特定页面的底部并不是一个好主意。使用

```
<script>page_a_specific_function();</script> 
```

在页面底部启动页面特定的 javascript 是一个更好的解决方案。

您还可以为特定页面上的某些元素分配特定的 id 或类，然后检查这些是否存在于 javascript 中。如果您的页面有一个 id="calendar" 的元素，那么您的 .js 文件的特定部分将运行。

至于放置 javascript 的位置，您可以坚持通常的位置（可以在 application.js 中引用并很好地编译到一个文件中）。我将所有特定于应用程序的 javascript 放在 app/assets/javascripts 中，将第三方库放在 vendor/assets/javascripts 中。第三个位置是 lib/assets/javascript。

[SO](https://stackoverflow.com/questions/6167805/using-rails-3-1-where-do-you-put-your-page-specific-javascript-code)
[asciiccast 上关于资产管道的类似问题](http://asciicasts.com/episodes/279-understanding-the-asset-pipeline)

# xml - XML 和 XSL 没有得到想要的结果

> ID：10337749
> 
> 赞同：1
> 
> 时间：2012-04-26T16:42:58.663
> 
> 标签：xml, xslt

我有一个 XML 食谱文件。每个配方都使用一个元素定义，我的 XSL 我想使用`<xsl:for-each select="//recipe">`. 唯一的问题是我没有得到想要的结果。for-each 之外的所有内容都可以正常工作，并且可以显示，但 for-each 中的所有内容都没有出现。

我在我的 XSL 中没有看到任何错误，但我又不是最擅长创建它们。任何帮助，将不胜感激。

输出：

```
Testing HTML
Testing Body
Testing Table 
```

XML

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="recipe.xsl"?>
<recipesXML xmlns="http://www.w3schools.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.w3schools.com recipe.xsd ">
    <recipe>
        <name> Burnt Cookies </name>
        <image>images/burntcookie.jpg</image>
        <prepTime> 120 min </prepTime>
        <cookTime> 300 min </cookTime>
        <ingredients>Animal Crackers</ingredients>
        <instructions>
            <step num="1">Place Animal Crackers on a pan</step>
            <step num="2">Place Pan in Oven</step>
            <step num="3"> ... </step>
            <step num="4">Profit</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Delicious Black Bean Burritos</name>
        <image>images/</image>
        <prepTime>10 min</prepTime>
        <cookTime>15 min</cookTime>
        <ingredients>2 (10 inch) flour tortillas</ingredients>
        <ingredients>2 tablespoons vegetable oil</ingredients>
        <ingredients>1 small onion, chopped</ingredients>
        <ingredients>1/2 red bell pepper, chopped</ingredients>
        <ingredients>1 teaspoon minced garlic</ingredients>
        <ingredients>1 (15 ounce) can black beans, rinsed and drained</ingredients>
        <ingredients>1 teaspoon minced jalapeno peppers</ingredients>
        <ingredients>3 ounces cream cheese</ingredients>
        <ingredients>1/2 teaspoon salt</ingredients>
        <ingredients>2 tablespoons chopped fresh cilantro</ingredients>
        <instructions>
            <step num="1">Wrap tortillas in foil and place in oven heated to 350 degrees F (175 degrees C). Bake for 15 minutes or until heated through.</step>
            <step num="2">Heat oil in a 10-inch skillet over medium heat. Place onion, bell pepper, garlic and jalapenos in skillet, cook for 2 minutes stirring occasionally. Pour beans into skillet, cook 3 minutes stirring.</step>
            <step num="3">Cut cream cheese into cubes and add to skillet with salt. Cook for 2 minutes stirring occasionally. Stir cilantro into mixture.</step>
            <step num="4">Spoon mixture evenly down center of warmed tortilla and roll tortillas up. Serve immediately.</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Cream of Asparagus Soup</name>
        <image>images/aspSoup.jpg</image>
        <prepTime>30 min</prepTime>
        <cookTime>30 min</cookTime>
        <ingredients>1/4 cup margarine</ingredients>
        <ingredients>1 onion, chopped</ingredients>
        <ingredients>3 stalks celery, chopped</ingredients>
        <ingredients>3 tablespoons all-purpose flour</ingredients>
        <ingredients>4 cups water</ingredients>
        <ingredients>1 (10.5 ounce) can condensed chicken broth</ingredients>
        <ingredients>4 tablespoons chicken bouillon powder</ingredients>
        <ingredients>1 potato, peeled and diced</ingredients>
        <ingredients>1 pound fresh asparagus, trimmed and coarsely chopped</ingredients>
        <ingredients>3/4 cup half-and-half</ingredients>
        <ingredients>1 tablespoon soy sauce</ingredients> 
        <ingredients>1/4 teaspoon ground black pepper</ingredients> 
        <ingredients>1/4 teaspoon ground white pepper</ingredients> 
        <instructions>
            <step num="1">Melt butter or margarine in a heavy cooking pot. Add onions and chopped celery; saute until tender, about 4 minutes. Stir in flour, mixing well. Cook for about 1 minute, stirring constantly. Do not burn, or let it go lumpy. Add water, chicken broth, and chicken soup base; stir until smooth. Bring to a boil. Add diced potatoes and chopped asparagus. Reduce heat, and simmer for about 20 minutes.</step>
            <step num="2">Puree soup in a food processor or blender in batches. Return to pot.</step>
            <step num="3">Stir in half and half cream, soy sauce, and black and white pepper. Bring soup just to boil. Adjust seasonings to taste. Serve hot.</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Carrot Cake IV</name>
        <image>images/carrotcake.jpg</image>
        <prepTime>30 min</prepTime>
        <cookTime>30 min</cookTime>
        <ingredients>1 (18.5 ounce) package carrot cake mix</ingredients>
        <ingredients>1/2 cup water</ingredients>
        <ingredients>1/2 cup vegetable oil</ingredients>
        <ingredients>3 eggs</ingredients>
        <ingredients>1/2 cup finely chopped walnuts</ingredients>
        <ingredients>1 (8 ounce) can crushed pineapple with juice</ingredients>
        <instructions>
            <step num="1">Preheat oven to 350 degrees F (175 degrees C). Grease and flour two 8 inch round pans.</step>
            <step num="2">In large bowl, blend cake mix, oil, water, undrained pineapple, eggs, and nuts. Beat for 2 minutes with an electric mixer at medium speed. Spread batter into prepared pans.</step>
            <step num="3">Bake for 35 to 40 minutes, or until a toothpick inserted in the center comes out clean. Cool. Frost with cream cheese frosting.</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Eggy Veggie Bake</name>
        <image>images/eggveggie.jpg</image>
        <prepTime>10 min</prepTime>
        <cookTime>35 min</cookTime>
        <ingredients>1 tablespoon olive oil</ingredients>
        <ingredients>1 cup sliced halved zucchini</ingredients>
        <ingredients>3 green onions, chopped</ingredients>
        <ingredients>1/2 sweet onion, thinly sliced</ingredients>
        <ingredients>2 roma (plum) tomatoes, chopped</ingredients>
        <ingredients>1/2 cup chopped fresh mushrooms</ingredients>
        <ingredients>3 cups chopped baby spinach</ingredients>
        <ingredients>1/2 lemon, juiced</ingredients>
        <ingredients>Worcestershire sauce to taste</ingredients>
        <ingredients>hot sauce to taste</ingredients>
        <ingredients>garlic powder to taste</ingredients> 
        <ingredients>salt and ground black pepper to taste</ingredients> 
        <ingredients>1 1/2 cups liquid egg substitute</ingredients> 
        <ingredients>1/4 cup shredded Cheddar cheese</ingredients>
        <instructions>
            <step num="1">Preheat oven to 350 degrees F (175 degrees C). Spray an 8x8 inch baking dish with cooking spray.</step>
            <step num="2">Heat the olive oil in a skillet over medium-high heat. Place zucchini, green onions, onion, tomatoes, mushrooms, and spinach in the skillet. Sprinkle with lemon juice, Worcestershire sauce, and hot sauce. Season with garlic powder, salt, and pepper. Cook until tender. Transfer to the prepared baking dish. Pour egg substitute over the vegetables in the dish. Top with cheese.</step>
            <step num="3">Bake 20 minutes in the preheated oven, or until egg substitute is set and cheese is melted. Cut with a spatula and enjoy!</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Chicken and Bacon Shish Kabobs</name>
        <image>images/ChickenBaconShish.jpg</image>
        <prepTime>25 min</prepTime>
        <cookTime>20 min</cookTime>
        <ingredients>1/4 cup soy sauce</ingredients>
        <ingredients>1/4 cup cider vinegar</ingredients>
        <ingredients>2 tablespoons honey</ingredients>
        <ingredients>2 tablespoons canola oil</ingredients>
        <ingredients>10 large mushrooms, cut in half</ingredients>
        <ingredients>2 green onions, minced</ingredients>
        <ingredients>3 skinless, boneless chicken breast halves - cut into chunks</ingredients>
        <ingredients>1/2 pound sliced thick cut bacon, cut in half</ingredients>
        <ingredients>1 (8 ounce) can pineapple chunks, drained</ingredients>
        <ingredients>skewers</ingredients>
        <instructions>
            <step num="1">In a large bowl, mix the soy sauce, cider vinegar, honey, canola oil, and green onions. Place the mushrooms and chicken into the mixture, and stir to coat. Cover, and marinate in the refrigerator at least 1 hour.</step>
            <step num="2">Preheat grill for high heat.</step>
            <step num="3">Remove the mushrooms and chicken from the marinade and shake off excess. Pour the marinade into a small saucepan and bring to a boil over high heat. Reduce heat to medium-low and simmer for 10 minutes; set aside.</step>
            <step num="4">Wrap the chicken chunks with bacon, and thread onto skewers so that the bacon is secured. Alternate with mushroom halves and pineapple chunks.</step>
            <step num="5">Lightly oil the grill grate. Arrange skewers on the prepared grill. Cook 15 to 20 minutes, brushing occasionally with remaining soy sauce mixture, until bacon is crisp and chicken juices run clear.</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Amish Bread</name>
        <image>images/amishbread.jpg</image>
        <prepTime>5 min</prepTime>
        <cookTime>180 min</cookTime>
        <ingredients>2 3/4 cups bread flour</ingredients>
        <ingredients>1/4 cup canola oil</ingredients>
        <ingredients>1 teaspoon active dry yeast</ingredients>
        <ingredients>1/4 cup white sugar</ingredients>
        <ingredients>1/2 teaspoon salt</ingredients>
        <ingredients>18 tablespoons warm water</ingredients>
        <instructions>
            <step num="1">Place ingredients in the pan of the bread machine in the order recommended by the manufacturer. Select White Bread cycle; press Start.</step>
            <step num="2">When the dough has raised once and second cycle of kneading begins, turn machine off. Reset by pressing Start once again. This gives the dough two full raising cycles before the final raising cycle prior to baking.</step>
        </instructions>
    </recipe>
    <recipe>
        <name>Pizza Crust Fantastico</name>
        <image>images/pizzaCrustFantastico.jpg</image>
        <prepTime>20 min</prepTime>
        <cookTime>15 min</cookTime>
        <ingredients>1 1/2 cups warm water (110 degrees F/45 degrees C)</ingredients>
        <ingredients>1 tablespoon honey</ingredients>
        <ingredients>1 3/4 teaspoons active dry yeast</ingredients>
        <ingredients>2 1/2 cups all-purpose flour</ingredients>
        <ingredients>3/4 cup whole wheat flour</ingredients>
        <ingredients>1/4 cup corn flour</ingredients>
        <ingredients>1 teaspoon salt</ingredients>
        <ingredients>1 teaspoon ground black pepper</ingredients>
        <ingredients>1 teaspoon dried oregano</ingredients>
        <ingredients>1 teaspoon dried basil leaves</ingredients>
        <ingredients>1 teaspoon dried rosemary, chopped</ingredients> 
        <ingredients>1/2 cup tomato sauce</ingredients> 
        <ingredients>2 tablespoons olive oil</ingredients>
        <instructions>
            <step num="1">Pour warm water into a small bowl. Dissolve honey and yeast in water. Let stand until creamy, about 10 minutes.</step>
            <step num="2">In a large bowl, combine the all-purpose flour, whole wheat flour, corn flour, salt, black pepper, oregano, basil and rosemary. Add the yeast mixture, tomato sauce and olive oil; stir well to combine.</step>
            <step num="3">When the dough has pulled together, turn it out onto a lightly floured surface and knead until smooth and elastic, about 8 minutes. Lightly oil a large bowl, place the dough in the bowl and turn to coat with oil. Cover with a damp cloth and let rise in a warm place until doubled in volume, about 1 hour. Meanwhile, preheat oven to 450 degrees F (230 degrees C) place pizza stone in oven if one is to be used.</step>
            <step num="4">Deflate the dough and turn it out onto a lightly floured surface. Divide the dough into two equal pieces and form into rounds, cover and let rest for 10 minutes.</step>
            <step num="5">Roll the rounds out to crust size. Spread crusts with desired pizza sauce from the center outward and cover with desired toppings. Bake on preheated pizza stone or on lightly oiled pizza pans until cheese is bubbly and golden, about 12 minutes</step>
        </instructions>
    </recipe>
</recipesXML> 
```

XSL

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <html>
            Testing HTML
            <body>
                Testing Body
                <table border="1">
                 Testing Table
                    <xsl:for-each select="//recipe">
                        Testing Each Recipe
                        <tr>
                            <td>
                                Test
                                <xsl:element name="img">
                                    <xsl:attribute name="src"><xsl:value-of select="image"/></xsl:attribute>
                                    <xsl:attribute name="alt">recipe</xsl:attribute>
                                </xsl:element>
                            </td>
                            <td>
                                <xsl:value-of select="name"></xsl:value-of>
                            </td>
                        </tr>
                    </xsl:for-each>
                </table>
            </body>
        </html>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T17:01:52.853

这是因为 XML 中的默认命名空间`xmlns="http://www.w3schools.com"`。

你可以：

1.  从 XML 中删除它。

2.  添加命名空间，带有前缀，并在选择中使用前缀。( `select="//x:recipe"`)

3.  如果您使用的是 XSLT 2.0，`*`请在选择中用作前缀。( `select="//*:recipe"`)

4.  `local-name()`在选择中使用。( `select="//*[local-name() = 'recipe']"`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T21:39:30.853

顺便说一句，该 img 元素可以使用

```
<img src="{image}" alt="recipe"/> 
```

# assembly - FSTENV? 几乎找不到有关此指令的任何信息

> ID：10337750
> 
> 赞同：3
> 
> 时间：2012-04-26T16:43:01.160
> 
> 标签：assembly, x86, x87

我在一个程序中有这个指令：

```
FSTENV (28-BYTE) PTR SS:[ESP-1C] 
```

它有什么作用？

它使用和更新哪些寄存器？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:51:46.397

它存储浮点环境。其中包括：当前控制字、状态字、标签字、指令指针和操作数指针。这些存储在内存中的结构中。在 16 位模式下，该结构为 14 个字节。在 32 位模式下，它是 28 个字节。我完全不确定它在 64 位模式下是否可用（64 位模式主要使用 SSE 代替）[编辑：显然在 32 位和 64 位模式下操作相同。]

我不相信它会改变协处理器的任何当前状态[编辑：哎呀——确实如此，它掩盖了 FP 异常，但大多数人从不从一开始就取消掩盖它们，所以...]——但是当你使用`fldenv`，这会将状态恢复到您用于`fstenv`存储它时的状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T17:06:03.367

Jerry Coffins 答案是正确的。
如果您想知道`(28-BYTE) PTR SS:[ESP-1C]`:
这是存储 FP 环境的有效地址，它指定命令的 28 字节版本，并指向堆栈段中堆栈指针下方的 28 (0x1c) 字节。
我只是添加了英特尔的官方描述，这是我使用搜索引擎找到的。

> **描述**
> 
> 将当前 FPU 操作环境保存在目标操作数指定的内存位置，然后屏蔽所有浮点异常。FPU 操作环境由 FPU 控制字、状态字、标签字、指令指针、数据指针和最后操作码组成。IA-32 英特尔® 架构软件开发人员手册第 1 卷中的图 7-13 到 7-16 显示了存储环境在内存中的布局，具体取决于处理器的操作模式（受保护的或真实的）和当前操作数-size 属性（16 位或 32 位）。在虚拟 8086 模式下，使用实模式布局。
> 
> FSTENV 指令在存储 FPU 环境之前检查并处理任何未决的未屏蔽浮点异常；FNSTENV 指令没有。保存的图像反映了指令流中FSTENV/FNSTENV指令之前的所有浮点指令都已执行后FPU的状态。
> 
> 这些指令经常被异常处理程序使用，因为它们提供对 FPU 指令和数据指针的访问。环境通常保存在堆栈中。保存环境后屏蔽所有异常可防止浮点异常中断异常处理程序。英特尔® 架构兼容性
> 
> 在 MS-DOS* 操作系统兼容模式下运行 Pentium® 或 Intel486™ 处理器时，可能（在不寻常的情况下）在执行 FNSTENV 指令之前中断以处理未决的 FPU 异常。有关这些情况的描述，请参阅 IA-32 英特尔® 架构软件开发人员手册第 1 卷附录 D 中标题为“No-Wait FPU 指令可以在窗口中获取 FPU 中断”的部分。在 Pentium Pro 处理器上不能以这种方式中断 FNSTENV 指令。
> 
> **手术**
> 
> DEST[FPUControlWord) <- FPUControlWord;
> 
> DEST[FPUStatusWord) <- FPUStatusWord;
> 
> DEST[FPUTagWord) <- FPUTagWord;
> 
> DEST[FPUDataPointer) <- FPUDataPointer;
> 
> DEST[FPUInstructionPointer) <- FPUInstructionPointer;
> 
> DEST[FPULastInstructionOpcode) <- FPULastInstructionOpcode;
> 
> **受影响的 FPU 标志**
> 
> C0、C1、C2 和 C3 未定义。
> 
> **浮点异常**
> 
> 没有任何。
> 
> **保护模式异常**
> 
> GP(0) - 如果目标位于不可写段中。如果内存操作数有效地址超出 CS、DS、ES、FS 或 GS​​ 段限制。如果 DS、ES、FS 或 GS​​ 寄存器用于访问内存并且它包含一个空段选择器。
> 
> SS(0) - 如果内存操作数有效地址超出 SS 段限制。
> 
> NM - CR0 中的 EM 或 TS 已设置。
> 
> PF(fault-code) - 如果发生页面错误。
> 
> AC(0) - 如果启用对齐检查并在当前特权级别为 3 时进行未对齐的内存引用。实地址模式异常
> 
> GP - 如果内存操作数有效地址超出 CS、DS、ES、FS 或 GS​​ 段限制。
> 
> SS - 如果内存操作数有效地址超出 SS 段限制。
> 
> NM - CR0 中的 EM 或 TS 已设置。虚拟 8086 模式异常
> 
> GP(0) - 如果内存操作数有效地址超出 CS、DS、ES、FS 或 GS​​ 段限制。
> 
> SS(0) - 如果内存操作数有效地址超出 SS 段限制。
> 
> NM - CR0 中的 EM 或 TS 已设置。
> 
> PF(fault-code) - 如果发生页面错误。
> 
> AC(0) - 如果启用对齐检查并进行未对齐的内存引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-05-22T05:34:31.130

只是为了完整起见，这里是`FSTENV`/`FNSTENV`指令产生的内存布局。它在 x86-64`"Long 64-bit Mode"`和 x86中是相同的`"32 bit compatibility mode"`（除非您在 x86-64 中添加前缀`66h`。）

引用[这个笨重](https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-vol-1-manual.pdf)的英特尔文档，这是布局：

[![在此处输入图像描述](../Images/dac1b5eee4646b9987d14277dfb1b50d.png)](https://i.stack.imgur.com/7UmLY.png)

*（顺便说一句，上面的图像也应该被命名为“长模式”。）*

因此，如果我们以长 64 位模式运行实际测试：

[![在此处输入图像描述](../Images/f1b93d8c23f3c28ca6bff0bd5f2153aa.png)](https://i.stack.imgur.com/5sf7s.png)

`FNSTENV`并在具有以下上下文状态的指令后立即中断：

[![在此处输入图像描述](../Images/562e45fb4052b62b59acaa2299f891d7.png)](https://i.stack.imgur.com/6MtPj.png)

它返回的内存布局如下：

[![在此处输入图像描述](../Images/fa258610e40de890e8aebd7f9a114b06.png)](https://i.stack.imgur.com/EN5cu.png)

我不会隐瞒，这很奇怪。（从截断的 RIP 寄存器到看起来很奇怪的操作码。）但我猜出于遗留原因，它仍然受支持。

好消息是，在编写现代 x64 代码时，这些古老的 x87 FPU 指令如今已没有多少用途。在这种情况下，您绝对应该坚持使用`XMM0`直通`XMM15`寄存器及其相关指令来满足您的浮点需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-09T12:03:50.513

我想用不同的方法来回答这个问题。

FSTENV 不是“真正的”指令。
搜索“FNSTENV”操作码时可能会更幸运。

仔细查看编码（来自[Intel SDM](https://software.intel.com/en-us/articles/intel-sdm)）：

```
FSTENV   9B D9 /6  
FNSTENV  D9 /6 
```

看到前面的“9B”了吗？
它实际上是“FNSTENV”前面的“FWAIT”。

因此，“FSTENV”与许多其他指令一样，只是大多数汇编程序和反汇编程序都可以理解的约定。

英特尔手册确实提到了这个特性，但你不应该期望它在 100% 的情况下是准确的，有时它可能会忽略这些细节：

> FSTENV/FNSTENV — 存储 x87 FPU 环境（第 2A 卷 3-393）
> 
> 汇编器为 FSTENV 指令发出**两条指令（一条****FWAIT**指令**后跟一条 FNSTENV** 指令），处理器分别执行这些指令中的每一条。如果这些指令中的任何一条产生了异常，则保存 EIP 会指向导致异常的指令。

有很多这样的“特殊”指令。
例如，您可能会对[x86 中有多少 NOP](https://gist.github.com/Quasilyte/b60c94b9cb608d5b1a359d54f1be8aca)感到惊讶，它们通常是其他指令的别名。

## 奖金 - 有用的资源

[英特尔 XED](https://github.com/intelxed/xed)可以在您的斗争中派上用场，原因如下：

1.  它可以用作编码器/解码器来验证其他工具。
2.  它的[数据文件](https://github.com/intelxed/xed/tree/master/datafiles)是人类（和机器）可读的 ISA 信息的良好来源。您可能会找到解释数据文件结构的[工程注释。](https://github.com/intelxed/xed/blob/master/misc/engineering-notes.txt)

[Go asm](https://github.com/golang/arch/tree/master/x86)有一个名为[x86.csv](https://github.com/golang/arch/blob/master/x86/x86.v0.2.csv)的东西，它以英特尔 SDM 方式列出 x86 指令，但有时还包含附加信息。
如果您将其 grep 为“FSTENV”，您将看到与之关联的“伪”标签。
请注意，x86.v0.2.csv 可能会遗漏一些说明，尤其是来自较新扩展的说明（不过，这将在 v0.3 中修复）。

# jquery - 使用 JSON 和 jQuery 获取带有链接、回复或主题标签的推文时跳过推文

> ID：10337758
> 
> 赞同：2
> 
> 时间：2012-04-26T16:43:24.700
> 
> 标签：jquery, json, twitter

我正在开发一个网站，用户在其中输入一个随机单词并获取相关推文列表。

使用 json 获取包含链接、回复或主题标签的推文时，如何排除它们？

这是我的 jQuery 代码：

```
 <script>

        function go(){
          var url = "http://search.twitter.com/search.json?callback=results&q=" + $("#text").val();
          $("<script/>").attr("src", url).appendTo("body");  
            $("#text").remove();
        }

        $("#text").keydown(function(e){ if( e.which == 13 )  go(); });

        function results(r){
          window.results = r.results;
          window.theIndex = 0;
          displayNext();
        }
        function displayNext(){
          if( window.theIndex >= window.results.length ){
            return;
          }
          $('.content').remove();
            $('.helper').remove();
          createDiv( window.results[window.theIndex] );
          window.theIndex++;
          setTimeout(displayNext, 4000);
        }

        function createDiv(status){
          var tweets = status.text;
          $("<span class='content'>")
          .html(tweets)
          .appendTo("body");
          $("<span class='helper'>")
          .appendTo("body")
        }

        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T20:13:35.943

根据[Dev Twitter API 参考](https://dev.twitter.com/docs/api/1/get/search)，返回的 JSON 对象包含一个`result`属性，该属性是代表所有推文的 JSON 对象数组。这些 JSON 数组中特别感兴趣的两个属性是`entitites`属性和`to_user_id`属性。因此，要检查推文是否不是回复且不包含任何链接，您将检查是否`entities`为空对象且`to_user_id`为空。

将您的`displayNext`功能更改为此应该可以工作：

```
function displayNext(){
    if( window.theIndex >= window.results.length ){
        return;
    }
    $('.content').remove();
    $('.helper').remove();
    var result = window.results[window.theIndex];
    if (Object.keys(result.entities).length !== 0 && result.to_user_id === null) {
        createDiv( window.results[window.theIndex] );
        window.theIndex++;
        setTimeout(displayNext, 4000);
    }
}​ 
```

（请注意，我正在使用[How do I test for an empty JavaScript object?](https://stackoverflow.com/questions/679915/how-do-i-test-for-an-empty-javascript-object-from-json)中的答案来检查是否`entitites`为空对象。）

# wpf - WPF加载，以便我可以移动表单

> ID：10337759
> 
> 赞同：0
> 
> 时间：2012-04-26T16:43:26.683
> 
> 标签：wpf, vb.net, ms-access

我如何加载 WPF 的**主**窗体，以便在窗体处于公寓状态时一个单独的线程从数据库中获取数据？（可拖动/可移动）

我知道这可以通过从您的主窗体中打开一个新窗口来实现，如下所示：

```
Private Sub openOrderWindow()
    Dim OrderWindow As Orders = New Orders
    OrderWindow.ShowDialog()
End Sub

Private Sub ButtonImport_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles ButtonImport.Click
    Dim iThread As System.Threading.Thread = New System.Threading.Thread(AddressOf openOrderWindow)
    iThread.SetApartmentState(System.Threading.ApartmentState.STA)
    iThread.Start()
    ListViewOrderDetail.Focus()
    ' Me.Close()
End Sub 
```

因为我使用'ShowDialog'

但是在主窗口上我不能调用 ShowDialog

**我试过的：**

```
 Private Sub AccessDBFilling()
ListViewDataGrid.ItemsSource = Nothing
    accessdblist = Nothing
accessdblist = accessdb.GetFromAccess()
ListViewDataGrid.ItemsSource = accessdblist
End Sub

 Private Sub refresh()
    ListViewDataGrid.Dispatcher.Invoke(New Action(AddressOf AccessDBFilling))
End Sub

Private Sub Window_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
    iThread = New System.Threading.Thread(AddressOf refresh)
    iThread.SetApartmentState(System.Threading.ApartmentState.STA)
    iThread.Start()
End Sub 
```

* * *

我试过把`MyBase.ShowDialog()`和`.Show()`.9000+ 其他东西

我使用单独的线程从数据库加载的唯一好处是我可以立即看到屏幕（相反它是一个透明框，直到它加载）但我不能移动它或最小化它

有没有办法让它在加载时移动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T05:01:55.800

是的。你应该明白你做了什么。

```
ListViewDataGrid.Dispatcher.Invoke(New Action(AddressOf AccessDBFilling)) 
```

UI 控件的调度程序对应于 UI 线程。所以 UI 被冻结，因为您在 UI 线程上完全加载数据。

在这里你应该做什么：

```
Private Sub AccessDBFilling()
    ListViewDataGrid.ItemsSource = Nothing
    accessdblist = Nothing
    accessdblist = accessdb.GetFromAccess()
    //I'm not sure, but you can try the following lines of code. uncomment one of them.

    //ListViewDataGrid.Dispatcher.Invoke(() => ListViewDataGrid.ItemsSource = accessdblist);
    //ListViewDataGrid.ItemsSource = accessdblist;
End Sub

Private Sub Window_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
    Action loadFromDb = AccessDBFilling;
    loadFromDb.BeginInvoke();
End Sub 
```

因为我不知道VB，你应该从C#翻译它:)

# php - 如何将参数从 JQUERY 传递到 PHP 以更新会话变量？

> ID：10337763
> 
> 赞同：0
> 
> 时间：2012-04-26T16:43:38.963
> 
> 标签：php, jquery

我正在尝试将动态创建的下拉菜单中的选择/值传递给 php 文件并将其存储在会话变量中，但 php 没有获取任何参数。这是我在 Jquery 文件中的代码：

```
$('#fgdesignation').change(function ()
            {
                var project =$("#fgdesignation option::selected").text();
                var url='backend.php';
             // alert(project);
            $.post(url, {fgdname : project});

        }); 
```

这是php文件：

```
if(isset($_POST['fgdname'])) {
    $fgdname= $_POST['fgdname'];
    $_SESSION['fgdname']=$fgdname;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:49:54.823

尝试这个：

```
$('#fgdesignation').change(function () {
    var project = $("#fgdesignation").filter(':selected').val();
    var url = 'backend.php';
    // alert(project);
    $.post(url, {
        fgdname: project
    });
}); 
```

顺便说一句，我看到你正在使用`.text()`而不是`.val()`

取消注释`alert()`并查看是否返回值

**编辑**我做了`$("#fgdesignation").filter(':selected').val();`假设：`<select id="fgdesignation'>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:50:50.453

不要忘记添加

```
session_start() 
```

在 PHP 文件的顶部。而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:51:22.183

尝试：

```
$('#fgdesignation').change(function ()
            {
                var project =$("#fgdesignation option:selected").val();
                var url='backend.php';
             // alert(project);
            $.post(url, {fgdname : project}, function(response){alert(response);});

        }); 
```

您正在使用`.text()`而不是`.val()`，它返回当前选定选项的值，并且在您只需要一个时将 '::' 作为您的选择器。

在你的 PHP 文件中：

```
session_start(); // Important if you're not already doing it!
if(isset($_POST['fgdname'])) {
    $fgdname= $_POST['fgdname'];
    $_SESSION['fgdname']=$fgdname;
    echo $fgdname;
} 
```

如果一切按计划进行，您应该有一个警报框，其中包含您在选择框中选择的值，并将其显示在会话数组中。搏一搏。

# sql-server-2008 - 如何将下面的 SQL 表达式转换为 SSIS 中的派生列

> ID：10337770
> 
> 赞同：1
> 
> 时间：2012-04-26T16:43:52.070
> 
> 标签：sql-server-2008, ssis

> **可能重复：**
> [将 SQL 中的 CASE 表达式转换为 SSIS 中的派生列](https://stackoverflow.com/questions/9605540/convert-case-expression-in-sql-to-derived-column-in-ssis)

```
(CASE 
        WHEN CHARINDEX('%', 'FixedARMRateReductionLimit') > 0 THEN
            CAST(SUBSTRING('FixedARMRateReductionLimit', 0, CHARINDEX('%', 'FixedARMRateReductionLimit')) as decimal)/100
        WHEN 'FixedARMRateReductionLimit' = 'Weekly PMMS Rate' THEN
        0.35 else 0.02 end ) as fixedarmratereductionlimit 
```

有人可以帮助我

# css - font-face 无法确定 .svg 字体文件末尾的变量的使用

> ID：10337777
> 
> 赞同：1
> 
> 时间：2012-04-26T16:44:34.687
> 
> 标签：css, font-face

我在网上找到了这个 css，显然它使字体跨浏览器兼容！

```
@font-face {
    font-family: 'Yanone Kaffeesatz Regular';
    src: url('fonts/YanoneKaffeesatz-Regular-webfont.eot');
    src: url('fonts/YanoneKaffeesatz-Regular-webfont.eot?iefix') format('eot'),
         url('fonts/YanoneKaffeesatz-Regular-webfont.woff') format('woff'),
         url('fonts/YanoneKaffeesatz-Regular-webfont.ttf') format('truetype'),
         url('fonts/YanoneKaffeesatz-Regular-webfont.svg#webfont1BSMunJa') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

但是我无法弄清楚 .svg#webfont1BSMunJa 末尾的那个变量是什么，如果我使用的字体与示例站点上使用的不同，我是否需要更改该完成部分？它有什么作用？？

还有一个问题，double src: 有必要吗？在一些最后与 iefix 一致的示例中不存在。

在这个资源中，他们声明这种做事方式也应该在 ie6-9 中工作，但实际上没有加载 9 种以下的字体。[http://www.960development.com/how-to-write-cross-browser-font-face-syntax/](http://www.960development.com/how-to-write-cross-browser-font-face-syntax/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:58:38.767

前往[http://www.fontsquirrel.com/fontface/generator](http://www.fontsquirrel.com/fontface/generator)这将解释什么是必要的，什么不是必要的。

@font-face 在 IE9 下没有得到很好的支持。它的实施可能会非常失败。

如果您希望非网络安全字体与跨浏览器兼容，您应该尝试[http://typekit.com 。](http://typekit.com)这是一项付费（尽管价格相对较低）的服务。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T10:14:15.607

我发现的解决方案是这样的：

```
@font-face {
    font-family: 'PFRondaSeven';
    src: url('font/pf_ronda_seven_bold-webfont.eot');
    src: local('☺'),
         url('font/pf_ronda_seven_bold-webfont.woff') format('woff'),
         url('font/pf_ronda_seven_bold-webfont.ttf') format('truetype'),
         url('font/pf_ronda_seven_bold-webfont.svg#webfont2zOjOL6G') format('svg');
    font-weight: bold;
    font-style: normal;
} 
```

所以我改变了这个： url('fonts/YanoneKaffeesatz-Regular-webfont.eot?iefix') format('eot'),

到笑脸...

# php - 如何在 PHP 的 for each 循环中创建变量并为其赋值？

> ID：10337782
> 
> 赞同：0
> 
> 时间：2012-04-26T16:44:43.803
> 
> 标签：php

我有每个循环，当循环输出篮子数组中保存的项目时。这很好用，但我想在会话变量中为每个项目存储一些东西，以便我可以在其他地方使用这些信息，我试图在 foreach 循环中创建会话变量，但当然变量每次都需要有不同的名称它循环通过不同的项目。我研究过如何动态创建变量，我想不通。这是我一直觉得会派上用场的东西，但似乎很难，我只是避免它，但现在我想知道它是否可能。

这是我的 for each 循环代码，您可以在我要为篮子中的每个项目创建的三个会话变量中看到：

```
foreach ($basketarray as $value)
{
    echo "<div id='basketitems'><br/>                                       
    ".$value['name']."<br/>
    ".$value['id']."<br/>
     &pound;".$value['price']."<br/>
     ".$value['size']."<br/>
    Quantity: ".$value['quantity']."<br/><br/>
    <img id='searchimage' src=".$value['picture']." width='210' height='250' /><br/>";

    $_SESSION['Bprodid'] = $value['id'];
    $_SESSION['Bprodquantity'] = $value['quantity'];
    $_SESSION['Bprodprice'] = $value['price'];

echo "<form action='deletefrombasket.php' name='basketdelete$items' id='basketdelete$items' method='POST'>

    <input type='submit' name='".$value['basketid']."' value='Remove' id='basketid' name='basketid'/>

    </form></div>";

$items++;
}
?>
    <div id='basketdetails'>
<?php

echo "<p>items ". number_format($basketitems)."</p>";
echo "<p>Total &pound; ".number_format($baskettotal, 2, '.', ',')."</p>";

if($basketitems && $baskettotal !=0)
{
    echo "<a  href='clear.php'>Empty Basket</a>";
    echo "<a  href='checkout.php'>Checkout</a>";
} 
```

所以有可能做这样的事情吗？我试图通过使用计数器来创建可变名称，但我没有成功。

我会很感激任何建议。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:49:35.760

将值放入数组中。然后使用为每个循环递增的计数器将 sderver 作为每个值的键。

```
$counter = 0;
foreach ($basketarray as $value)
{
    // Code goes here

    $_SESSION['Bprodid'][$counter] = $value['id'];
    $_SESSION['Bprodquantity'][$counter]  = $value['quantity'];
    $_SESSION['Bprodprice']$counter[]  = $value['price'];

    // More code
    $counter++
} 
```

要访问每个值，请使用 for 循环：

```
$size = count($_SESSION['Bprodid']);
for ($i = 0; $i < $size; $i++)
{
    echo $_SESSION['Bprodid'][$i] . "<br>\n";
    echo $_SESSION['Bprodquantity'][$i] . "<br>\n";
    echo $_SESSION['Bprodprice'][$i] . "<br><br>\n";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:50:16.780

你的会话变量可以是一个多维数组，所以在循环之前你可以说：

```
$_SESSION['my_values'] = array(); 
```

在循环中：

```
$_SESSION['my_values'][$value['id']]['Bprodquantity'] = $value['quantity'];
$_SESSION['my_values'][$value['id']]['price'] = $value['price'];
// etc. 
```

**编辑：**要遍历您可以使用的所有值：

```
foreach ($_SESSION['my_values'] as $key => $values)
{
  echo $key; // the ID of your product
  echo $values['quantity']; // the quantity
  echo $values['price']; // the price
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:52:24.933

将您的值存储到一个数组`$products[$items]["prodId"]`中，依此类推，在循环之后将您的会话变量设置为数组，`$_SESSION["products"] = $products`. 然后，您可以访问这些项目，`$_SESSION["products"][$itemNumber]["prodId"]`依此类推。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T17:17:36.603

您可以使用 serialize() 和 unserialize() 函数将整个数组保存在会话中：

```
$_SESSION['sbasketarray'] = serialize($basketarray); 
```

在其他需要数据的脚本中：

```
if (isset ( $_SESSION['sbasketarray'] )) {
    $basketarray = unserialize  ( $_SESSION['sbasketarray'] );
} 
```

# java - 创建 ViewPart 时无法获取图像描述符

> ID：10337783
> 
> 赞同：1
> 
> 时间：2012-04-26T16:44:45.357
> 
> 标签：java, eclipse, eclipse-plugin, swt

创建新 ViewPart 时，我无法获取图像描述符。调试代码我看到我无法为我的插件获取 Bundle。

代码如下：

```
public class MyView extends ViewPart {
 ...
 public void createPartControl(Composite parent) {
    ...
    Bundle bundle = Platform.getBundle(MyPlugin.ID);
    // The bundle is null at this point but is not null in other
    // classes of my code
 }
} 
```

当我尝试获取时`Bundle`，此时它为空。我不明白的是该代码适用于我的代码的其他部分。

为什么我此时无法获得捆绑包？

# css - 删除和添加元素时有关 CSS 定位的建议

> ID：10337786
> 
> 赞同：2
> 
> 时间：2012-04-26T16:44:58.397
> 
> 标签：css, positioning

我有 3 个输入和一个图像（与 xy 和 z 测量有关）。它们都相当自然地定位，因此我使用左侧和顶部 px 值来使它们准确。到目前为止，我使用了相对定位。

我的问题是当我更改一个复选框时，我隐藏了 z 输入并更改了图像。当我这样做时，一切都以一种可怕的方式发生了变化。页面底部也有大量空白区域，这可能是由于图像使用了负的顶部值。

我应该使用绝对定位还是其他东西？

谢谢，

瑞克

FIDDLE： http: [//jsfiddle.net/WY2DX/52/](http://jsfiddle.net/WY2DX/52/)（使用 SCSS 可能是 CSS 问题：s）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:53:30.713

假设您需要添加和删除元素，您可能不应该使用相对定位。相对意味着元素在定位方面不会从 DOM 中移除，因此一个元素的大小和位置会影响下一个元素。

[十步学习 CSS 定位](http://www.barelyfitz.com/screencast/html-training/css/positioning/)是一个**很棒的**教程，它让你了解不同的定位方法。我相信您正在寻找的是**step 4**，`position:relative`对于父容器，然后`position:absolute`是您的 x、y 和 z 标签。

**编辑：**

我不完全清楚您的示例应该如何工作，但我想知道标签是否真的是为了自发定位，还是图像是？您可能还想考虑让标签正常定位，并`position:absolute`用于图像？

[http://jsfiddle.net/vh5pY/3/](http://jsfiddle.net/vh5pY/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:54:09.190

你能证明你正在使用的基本标记/css设置吗？

但是，是的，您的两个问题似乎都是由使用 [position: relative;] 引起的，因为它相对于其原始位置定位元素。意思是如果元素'A'最初出现在 0, 0 (X,Y) 并且你这样做 { position: relative; 左：120px；上：120px；}，元素“A”将重新定位到 120、120 (X,Y)，但它仍然在 0,0 (X,Y) 处占用“物理空间”。这样，当您隐藏或删除其中一个元素时，该“物理空间”将不再被使用，其余内容将发生变化以适应变化。

您可以使用绝对定位来避免这种情况，但这也可能取决于使用的上下文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T10:19:08.967

对父容器使用相对定位，对每个子项使用绝对定位。这样添加或删除子元素不会影响其任何兄弟元素。

# c# - Visual Studio 测试服务器上的 Server.TransferRequest

> ID：10337792
> 
> 赞同：2
> 
> 时间：2012-04-26T16:45:34.857
> 
> 标签：c#, asp.net, iis

我找不到有关此的任何信息...我不断收到一些错误，说我需要 IIS 集成模式。`Server.TransferRequest`不适用于视觉工作室？

我的开始选项说“使用默认服务器”。

以下是它的使用方式：

```
Server.TransferRequest("RegisterSuccess.aspx?email="+ tbEmail.Text); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:55:32.337

*“新`TransferRequest`方法使用`IIS 7`工作线程执行完整的请求。这意味着页面请求将通过完整的`ASP.NET`管道，让每个模块都有机会与请求进行交互。”*

查看更多[ASP.NET：使用 Server.TransferRequest](http://www.eggheadcafe.com/tutorials/asp-net/79c73563-408a-493e-a369-d4b380bce549/aspnet-using-servertransferrequest.aspx)

*“(ASP) 与 Internet 信息服务一起引入的功能`(IIS) version 5.0`是 ASP 内置服务器对象的一种传输方法。”*

查看更多[如何使用 Server.Transfer 方法](http://support.microsoft.com/kb/219294)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T16:57:31.023

正确的。这不适用于 VS 开发服务器。以下是[MSDN](http://msdn.microsoft.com/en-us/library/58wxa9w5.aspx)的详细信息。VS Dev Server 与 IIS 7 的匹配度不是很高，而且它不是在集成模式下运行的，所以如果你的生产环境是这样的，你最好不要使用它。而 TransferRequest 需要集成模式。

# android - Android - 从 1,440,000 行文本文件中提取特定行数据的有效方法

> ID：10337795
> 
> 赞同：1
> 
> 时间：2012-04-26T16:46:02.113
> 
> 标签：android, file, random-access

我有一个包含高程的地形数据，如下所示

每个文件包含 1,440,000 行

```
.
.
.
183
192
127
.
.
. 
```

我怎样才能直接从文件中访问特定的行，而不会浪费完整的数据内存负载？（在安卓中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:00:05.150

我相信您最好的选择是将文本文件转换为 SQLite 数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:55:03.660

您可能想要使用 BufferedInputStream：http: [//developer.android.com/reference/java/io/BufferedInputStream.html](http://developer.android.com/reference/java/io/BufferedInputStream.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:22:37.270

如果您可以将文件更改为二进制格式，您可以直接寻找您想要的位置并读取您需要的值。如果不是，您可能必须逐行读取并返回您想要的行（假设您无法计算字节位置，因为行可以具有不同的长度）。

在玩了太久之后，我得到了这个（虽然它未经测试）：

```
File f = new File ("yourfile.txt");
HashMap <Integer, String> result = readLines(f, 1, 5, 255);
String line5 = result.get(5); // or null if the file had no line 5

private static HashMap <Integer, String> readLines(File f, int... lines) {
    HashMap<Integer, String> result = new HashMap<Integer, String>();
    HashSet<Integer> linesSet = new HashSet<Integer>();
    for (int line : lines) {
        linesSet.add(Integer.valueOf(line));
    }
    BufferedReader br = null;
    try {
        br = new BufferedReader(new InputStreamReader(new FileInputStream(f), "UTF-8"));
        int line = 1; // starting at line 1
        String currentLine = null;
        while ((currentLine = br.readLine()) != null) {
            Integer i = Integer.valueOf(line);
            if (linesSet.contains(i))
                result.put(i, currentLine);
            line++;
        }
    } catch (FileNotFoundException e) {
        // file not found
    } catch (UnsupportedEncodingException e) {
        // bad encoding specified
    } catch (IOException e) {
        // could not read
    } finally {
        if (br != null) {
            try {
                br.close();
            } catch (IOException e) {
                // ignore.
            }
        }
    }
    return result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:59:53.163

我认为，您可以使用 java.nio.FileChannel.read(buffers, start, number)。

start 表示起始偏移量，number 是要读取的字节数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T17:39:06.907

如果记录是固定长度的，您可以计算并直接转到所需记录的字节位置。

如果记录是可变长度的，但包含非常大文件的顺序标识信息（例如记录号），则可能值得根据平均记录长度猜测起始位置，在此之前寻找一点，然后向前阅读以找到所需的行（如果您已经过去了一点）。

如果除了从头开始计数之外没有其他方法可以识别记录，您将不得不这样做。理想情况下，您会以一种不会在扫描期间创建对象然后让垃圾收集器清理它们的方式来做这件事......

# imagemagick - 使用 ImageMagick.NET 和 C# 通过裁剪调整大小

> ID：10337800
> 
> 赞同：9
> 
> 时间：2012-04-26T16:46:13.293
> 
> 标签：imagemagick, imagemagick.net

我有一个大图像，我想将其调整为 230×320（精确）。我希望系统在不丢失纵横比的情况下调整它的大小。即如果图像是 460×650，它应该首先调整到 230×325，然后裁剪额外的 5 个像素的高度。

我正在执行以下操作：

```
ImageMagickNET.Geometry geo = new ImageMagickNET.Geometry("230x320>");
img.Resize(geo); 
```

但是图像并没有被调整到 230×320 的精确尺寸。

我在 C# 4.0 中使用[ImageMagick.NET 。](http://imagemagick.codeplex.com/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-30T15:10:19.410

这就是我解决问题的方法。

```
private void ProcessImage(int width, int height, String filepath)
    {
        // FullPath is the new file's path.
        ImageMagickNET.Image img = new ImageMagickNET.Image(filepath);
        String file_name = System.IO.Path.GetFileName(filepath);

        if (img.Height != height || img.Width != width)
        {
            decimal result_ratio = (decimal)height / (decimal)width;
            decimal current_ratio = (decimal)img.Height / (decimal)img.Width;

            Boolean preserve_width = false;
            if (current_ratio > result_ratio)
            {
                preserve_width = true;
            }
            int new_width = 0;
            int new_height = 0;
            if (preserve_width)
            {
                new_width = width;
                new_height = (int)Math.Round((decimal)(current_ratio * new_width));
            }
            else
            {
                new_height = height;
                new_width = (int)Math.Round((decimal)(new_height / current_ratio));
            }

            String geomStr = width.ToString() + "x" + height.ToString();
            String newGeomStr = new_width.ToString() + "x" + new_height.ToString();

            ImageMagickNET.Geometry intermediate_geo = new ImageMagickNET.Geometry(newGeomStr);
            ImageMagickNET.Geometry final_geo = new ImageMagickNET.Geometry(geomStr);

            img.Resize(intermediate_geo);
            img.Crop(final_geo);

        }

        img.Write(txtDestination.Text + "\\" + file_name);
    } 
```

# image - 图像显示查找表和窗口宽度/级别

> ID：10337803
> 
> 赞同：1
> 
> 时间：2012-04-26T16:46:19.473
> 
> 标签：image, graphics, jai

我有一个关于带有**窗口宽度/级别的图像显示****查找表**的一般性问题。在我的例子中，我们使用单色显示，所以屏幕上有**256**个不同的像素值显示。我们的数据是有符号的短类型，**只有正值**，所以有**65536 个**可能的不同原始数据值。

 ******我们最初通过将 0 到 65535**原始数据值**与 0 到 255**像素值**映射来构建查找表，因为我们假设所有数据都应该显示在屏幕上。查找表是一个长度为 65536 的**字节数组，将映射的像素值（0 到 255 之间）以原始数据值作为查找表数组的****索引的**方式放入查找表数组中，得到对应的显示像素值。

现在用户更改窗口级别和宽度，例如级别 = 0，宽度 = 65536，这将显示小于 65536/2 的数据，那么我有两个选择：

1.  ***将所有大于 65536/2 的查找表像素值设置为 255（白色）并将 0 到 65535/2 的原始数据值与 0 – 255 像素值重新映射到查找表数组中；***

2.  ***只需将所有大于 65535/2 的查找表像素值设置为 255（白色）；***

**哪种方式是正确的？**我在想查找表应该是固定的。如果一个点是红色的（如果使用颜色），我认为无论用户想要查看哪个窗口级别和宽度，它都应该始终是红色的。 **正确的？**如果我们根据新的窗口级别和宽度再次重新映射，那个红点可能不再是红色了。**这个好吗？********

# sql - 使用 DateTime 列的 CASE 语句

> ID：10337806
> 
> 赞同：3
> 
> 时间：2012-04-26T16:46:29.727
> 
> 标签：sql, tsql

我的查询中有一个日期时间列，我想在这个查询中做一个 CASE。

如果 DateDelivered 列不为空，则显示日期，否则，显示字符串 'Pendent' 我该怎么做？

```
CASE WHEN DateDelivered IS NOT NULL THEN DateDelivered ELSE 'Pendent' END AS DateDelivered 2 
```

我收到了这个错误

```
Conversion failed when converting date and/or time from character string. 
```

整个查询

```
SELECT  San_Imovel.Imovel_Id ,
        San_Chave.DataHoraPegou ,
        CASE WHEN San_Chave.DateDelivered IS NOT NULL THEN San_Chave.DateDelivered
             ELSE ISNULL(CAST(San_Chave.DateDelivered AS VARCHAR), 'Pendent')
        END AS DateDelivered2 ,
        San_Usuario.NomeCompleto + ' - ' + sc.Apelido AS Nome ,
        San_Cliente.NomeCompleto AS NomeCliente ,
        San_Credenciada.Apelido ,
        San_Cliente.Cliente_Id ,
        San_ChaveImovel.QuantidadeChave
FROM    San_ChaveImovel
        JOIN San_Chave ON San_ChaveImovel.Chave_Id = San_Chave.Chave_Id
        JOIN San_Credenciada ON San_Chave.Credenciada_Id = San_Credenciada.Credenciada_Id
        JOIN San_Imovel ON San_ChaveImovel.Imovel_Id = San_Imovel.Imovel_Id
        JOIN San_Usuario ON San_Chave.Usuario_Id_Responsavel = San_Usuario.Usuario_Id
        JOIN San_Credenciada sc ON San_Usuario.Credenciada_Id = sc.Credenciada_Id
        JOIN San_Cliente ON San_Chave.Cliente_Id = San_Cliente.Cliente_Id 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T16:51:41.357

您正在尝试将“Pendent”转换为 DateTime，因为它将所有数据转换为相同的数据类型。此外，如果您只是检查 NULL，则可以使用 ISNULL 或 COALESCE。尝试这个：

```
ISNULL(CAST(DateDelivered AS VARCHAR), 'Pendent') 
```

您还可以指定 DateDelivered 的格式：

```
ISNULL(CONVERT(VARCHAR, DateDelivered, 101), 'Pendent') 
```

[在此处](http://msdn.microsoft.com/en-us/library/ms187928.aspx)查看 101 的更多选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T17:43:24.350

CASE 运算符返回的值与第一个结果子句的类型和大小相同。由于您无法将“待定”转换为 DateTime 值，因此必须将日期值转换为他们的 varchar 表示形式：

```
CASE WHEN DateDelivered IS NOT NULL THEN CONVERT(VARCHAR(10), DateDelivered, 120)
ELSE 'Pendent'
END AS DateDelivered 
```

在此示例中，您可以使用 a 获得相同的结果`ISNULL`：

```
ISNULL(CONVERT(VARCHAR(10), DateDelivered, 120), 'Pending') AS [DateDelivered] 
```

注意 1：将日期值转换为 varchar 时，我总是更喜欢`YYYY-MM-DD`order，因为它不是一种模棱两可的格式。

注意 2：请注意，`CASE`当它根据第一个结果子句的大小截断 varchar 值时，误用可能会导致更微妙的错误：

```
CASE WHEN 1=0 THEN 'A'
ELSE 'BBB'
END -- returns only 'B' !!! 
```

# iphone - 在后台启动 AVQueuePlayer

> ID：10337807
> 
> 赞同：2
> 
> 时间：2012-04-26T16:46:36.560
> 
> 标签：iphone, core-audio, avaudioplayer, avaudiosession

我有一个播放来自互联网的音频文件的 AVQueuePlayer。它可以在后台与应用程序一起执行并且做得很好（在后台播放并在后台异步获取新文件）。

当我允许 AVQueuePlayer 在将应用程序移动到后台之前开始播放时，一切都很好。为了开始播放我的应用程序必须先与几个服务通信，然后才能真正获得正确的文件来播放。

如果我在播放开始前的关键几秒钟内将应用程序移至后台，则 AVQueuePlayer 将不会播放。

为了能够在后台与服务对话，我总是首先通过 beginBackgroundTaskWithExpirationHandler 请求后台任务权限。

观察日志，我可以看到所有服务都正常完成（因此后台任务权限有效），并且 AVQueuePlayer 已使用多个 AVPlayerItems 正确初始化，但它不会开始播放。AVQueuePlayer.currentItem.status 也永远不会到达 AVPlayerStatusReadyToPlay。

我确保与 AVQueuePlayer 的所有交互都发生在主线程上。

我很困惑，如果应用程序在后台，无论我的设置如何，并且我拥有后台任务权限，AVQueuePlayer 都不会启动。

我以前能够用音频队列服务做类似的事情，但希望这次 AVQueuePlayer 和它更简单的 API 就足够了，但看来我必须回到音频队列服务和合作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:35:48.550

您必须在应用程序仍在前台时启动音频队列。必要时播放静音。看起来如果应用程序在进入后台时没有产生音频，则默认情况下它的音频会话被带走并提供给新的前台应用程序。因此，进入后台的应用程序没有可以播放任何内容的会话。

# javascript - 使用 JQuery/AJAX 从 PHP 返回 html 表

> ID：10337813
> 
> 赞同：0
> 
> 时间：2012-04-26T16:46:57.460
> 
> 标签：javascript, jquery

在用户选择选择选项后，我想弄清楚如何在 div 标签中显示表格，我快疯了。

jQuery/AJAX

```
$('#months').change(function() {

                  var month_sent = $('#months option:selected').text();

                  $.ajax ({
                      type: "GET",
                      dataType: 'text',
                      url: "db_connect.php",
                      data: "dept_sent=" + dept_sent + "&month_sent=" + month_sent + "&year_sent=" + year_sent,
                      success: function(data) {
                          $('#incident_table').html(data);
                      },
                      error: function() {
                        alert("Error!");
                      }

                  });
              }); 
```

PHP

```
 if ($dept && year && $month) {
      $query = "SELECT date,dept,area_name,ticket,description,resolution FROM incidents WHERE (dept = '$dept') AND (YEAR(date) = '$year') AND (MONTH(date) = '$month')";
      $query_image = "SELECT image_content FROM images WHERE dept_name = '$dept' AND year = '$year' AND month = '$month'";

      $result = mysql_query($query);
      $result_image = mysql_query($query_image);

      while ($row = mysql_fetch_assoc($result)) {
         // foreach ($row as $value) {
              $incident .= '<tr><td>'.$row['date'].'</td><td>'.$row['dept'].'</td><td>'.$row['area_name'].'</td><td>'.$row['ticket'].'</td><td>'.$row['description'].'</td><td>'.$row['resolution'].'</td></tr>';
          //}
      }
      echo $incident;
  } 
```

我需要做的就是能够在“事件” div 标签内显示表格

编辑：

```
<div style="border: 1px solid black; width:310px; height: 310px;" name="incidents" id="incidents">
      <table id="incident_table">
      </table>
  </div> 
```

请帮忙！:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:52:16.413

您在 PHP 的第一行中缺少**$** before **year**

改变这一行：
`if ($dept && year && $month) {`

对此：
`if ($dept && $year && $month) {`

首先尝试单独运行 PHP 文件以检查它是否正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T17:08:29.447

尝试将您的 php 更改为：

```
 if ($dept && year && $month) {
      print_r(1);exit;
      $query = "SELECT date,dept,area_name,ticket,description,resolution FROM incidents WHERE (dept = '$dept') AND (YEAR(date) = '$year') AND (MONTH(date) = '$month')";
      $query_image = "SELECT image_content FROM images WHERE dept_name = '$dept' AND year = '$year' AND month = '$month'";

      $result = mysql_query($query);
      $result_image = mysql_query($query_image);

      while ($row = mysql_fetch_assoc($result)) {
         // foreach ($row as $value) {
              $incident .= '<tr><td>'.$row['date'].'</td><td>'.$row['dept'].'</td><td>'.$row['area_name'].'</td><td>'.$row['ticket'].'</td><td>'.$row['description'].'</td><td>'.$row['resolution'].'</td></tr>';
          //}
      }
      echo $incident;
  } else print_r(0);exit; 
```

然后移动 print_r(1); 向下命令，直到您发现问题所在的行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:08:41.023

将动态内容插入`div`而不是插入空/不完整`table`结构

```
 success: function(dataHTML) {
      $('#incidents').html(dataHTML);
 }, 
```

并在 php

```
echo '<table id="incident_table">'.$incident.'</table>'; 
```

还阅读了关于 SQL 注入的其他评论和一年中缺少的 $

# javascript - 如何直接链接到特定的 JavaScript 选项卡？

> ID：10337814
> 
> 赞同：3
> 
> 时间：2012-04-26T16:47:09.147
> 
> 标签：javascript, html, css

我的网站有一个选项卡式界面，在所有页面中都一致使用。我可以链接到基本页面（第一个选项卡），但不知道如何链接到特定选项卡。

这是我的 JavaScript：

```
$(document).ready(function() {
  $(".tabs a").click(function() {
    var $this = $(this);
    $(".panel").hide();
    $(".tabs a.active").removeClass("active");
    $this.addClass("active").blur();
    var panel = $this.attr("href");
    $(panel).fadeIn(250);
    return false;
  });
$(".tabs li:first-of-type a").click();
}); 
```

我的每个页面都是这样设置的：

```
<div id="aboutContainer">
    <ul class="tabs">
        <li><a href="#panel1">About Us</a></li>
        <li><a href="#panel2">Contact Us</a></li>
        <li><a href="#panel3">Mailing List</a></li>
        <li><a href="#panel4">Terms</a></li>
        <li><a href="#panel5">Privacy Policy</a></li>
        <li><a href="#panel6">Help</a></li>
    </ul>
        <div class="panelContainer">
            <div class="panel" id="panel1">
                <?php include('includes/aboutme.php'); ?>
            </div>

            <div class="panel" id="panel2">
                <?php include('includes/contact.php'); ?>
            </div>

            <div class="panel" id="panel3">
                <?php include('includes/mailinglist.php'); ?>
            </div>

            <div class="panel" id="panel4">
                <?php include('includes/terms.php'); ?>             
            </div>

            <div class="panel" id="panel5">
                <?php include('includes/privacypolicy.php'); ?>
            </div>

            <div class="panel" id="panel6">
                <?php include('includes/cheekyreference.php'); ?>
            </div>
        </div>
</div> 
```

任何指针将不胜感激。我对 JavaScript 很陌生，无法在网上找到答案。

为了澄清一点：

如果我在 about.php 页面上，则选项卡式界面可以工作。但我试图建立的链接类型如下：如果我在另一个页面上，我想链接到关于页面上的特定选项卡。我有一个导航页脚，我希望能够单击“邮件列表”或“联系人”等超链接，并显示正确的页面和正确的选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T19:11:32.183

实现这一点的技术是使用 url 的哈希部分。例如：

> about.php#panel1

或者，类似地，使用 hashbang：

> about.php#!panel1

（如果您关心 SEO，则 hashbang 是一个更好的选择。）

然后，您需要在页面中包含一个脚本，该脚本将检测 url 的哈希部分，并相应地激活选项卡。

抱歉，我一直这样做，但没有可用的公开示例。当我有一个帖子时，我会更新帖子。

在 jQuery 中，它看起来像这样：

```
$(".tabs a[href="+window.location.hash+"]").click(); 
```

注意：您也可以使用查询字符串，但如果您已经在页面上，哈希将阻止页面刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:49:53.467

例如，如果您想专门单击“条款”选项卡，您可以：

`$(".tabs a[href='#panel14']").click();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T19:01:28.353

也许这是矫枉过正，但您应该能够通过客户端站点路由来做到这一点。

您首先需要设置根据地址栏中的 url 激活的“路由”，然后您可以在 about 上使用以下格式链接到 tab1 的链接，并在激活的路由中激活相应的选项卡（触发 click 事件在该选项卡上）。

这是一个提供 JavaScript 路由的 jQuery 插件的链接

[http://jsrouter.codeplex.com/](http://jsrouter.codeplex.com/)

当然还有其他路由解决方案，这里有一个关于主题 [javascript 客户端路由/路径库的 stackoverflow 帖子的链接](https://stackoverflow.com/questions/6566360/javascript-clientside-routing-pathing-library)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T16:57:33.600

```
$('a[href="#panel1"]').click(function() {
        //insert action here;
});​ 
```

# ios - UIWebView 界面生成器连接问题

> ID：10337815
> 
> 赞同：1
> 
> 时间：2012-04-26T16:47:11.113
> 
> 标签：ios, model-view-controller, uiwebview, interface-builder, uiwebviewdelegate

我的 .h 文件看起来像这样

```
@interface EventCell : UITableViewCell {
    UILabel *TitleLabel;
    UILabel *DateLabel;
    UIWebView *LocationLabel;
}

@property (nonatomic, retain) IBOutlet UILabel *TitleLabel;
@property (nonatomic, retain) IBOutlet UILabel *DateLabel;
@property (nonatomic, retain) IBOutlet UIWebView *LocationLabel;

@end 
```

在界面构建中，我的 UILabel 连接得很好。当菜单单击界面生成器中的对象时，我可以看到相应的变量将它们连接到。但是对于 UIWebView 我看不到将它连接到什么。菜单点击它只是显示`delegate`，我可以将它拖到某个地方，但我看不到如何将它连接到我的`location label`变量

帮助？我觉得我错过了一些非常明显的东西。洞察力赞赏

根本问题是在此 Web 视图中显示字符串信息（带有一些 html 格式），该视图当前不显示我的字符串数据，因为它没有连接到控制器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:15:31.013

您应该再次阅读有关 UIWebView 类的文档。一开始还好

> 根本问题是在此 Web 视图中显示字符串信息（带有一些 html 格式），该视图当前不显示我的字符串数据，因为它没有连接到控制器

我不确定我是否正确。您是否尝试将 UILabels 放入您的 UIWebView 实例中？无需将标签放入您的 webview，您只需将文本直接放入您的 html 代码 -> 创建方法，该方法将具有 2 个输入参数：

1.  标题字符串
2.  日期字符串

在该方法中，您将构建您的 html 代码（或从文件中读取），然后将其加载到 webview。

那应该做的事情，查看互联网上的一些 UIWebview 示例。

其次：转到界面生成器（再次打开 uitableviewcell 子类的 xib）并在左侧窗格中选择文件所有者对象。现在，只需按住 ctrl 键并将文件所有者与 UIWebview 连接（左键单击鼠标 + 拖动）。如果你想设置 UIWebview 的委托，做同样的事情，但以相反的方式。选择 uiwebview 对象，按住 ctrk + 左键单击 + 拖动到文件所有者的对象 - > 你去。

PS：你的单元格中真的需要 UIWebview 吗？没有其他方法可以实现您的目标吗？避免这样的事情 -> 将内容从 Internet 直接下载到您的 tableview 单元的 webview 实例中 -> 这会降低您的应用程序的性能

好吧，如果我还没有回答您的问题，请尝试解释您打算做什么->您想在单元格中显示什么->（您是否准备了诸如对象之类的数组中的数据还是要获取它们在线？真的有必要在你的情况下使用uiwebview吗？）

# c# - 如何创建具有不同类型单个元素的类型安全数组或集合？

> ID：10337822
> 
> 赞同：4
> 
> 时间：2012-04-26T16:47:33.917
> 
> 标签：c#, arrays, generics

我在 C# 中实现了一个方法，它接受一个类型的参数`object`，例如`SomeMethod(object argument)`. 我需要将不同类型的多个对象的集合传递给此方法。由于接口限制，我无法更改方法签名。

我正在考虑发送一个对象数组，`object[] myArray = new object[2]`但如果可能的话，我想强烈键入数组的每个元素。例如，我有两个对象，一个是 type `Foo`，另一个是`Bar`. 我想保证`myArray[0]`is`Foo`和`myArray[1]`is `Bar`。

我该怎么做？另一个集合类型或创建一个特殊类会更有意义吗？

更新：所有好的答案。元组看起来是最通用的方式，但正如我在评论中所说，我仅限于 3.5。结构可以工作，但是在对使用结构和类作为参数进行了一些研究之后，如果使用更大的结构，性能会受到轻微影响。（[来源](http://www.dotnetperls.com/struct-versus-class)- 请参阅基准部分）。所以我要去上课。谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:52:52.437

在集合中安全地存储一组不相关类型的唯一方法是使用中间类型，它将值限制为这些类型并将该类型存储在集合中。这是一个穷人受歧视的结合。

```
sealed class FooOrBar {
  public readonly Foo Foo;
  public readonly Bar Bar;
  public bool IsFoo { 
    get { return Foo != null; }
  }
  public bool IsBar {
    get { return Bar != null; }
  }
  public FooOrBar(Foo f) {
    Foo = f;
  }
  public FooOrBar(Bar b) {
    Bar = b;
  }
  public static implicit operator FooOrBar(Foo f) {
    return new FooOrBar(f);
  }
  public static implicit operator FooOrBar(Bar b) {
    return new FooOrBar(b);
  }
}

FooOrBar[] array = new FooOrBar[2];
array[0] = new Foo();
array[1] = new Bar();
array[2] = "test";  // Fails to compile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:54:46.240

> 我想保证 myArray[0] 是 Foo 并且 myArray[1] 是 Bar

An`Array`是某种类型的对象的集合。所以你不能保证这一点。这样做的唯一方法是创建一个复合类型 a`struct`或 a `class`。

但是，如果您的签名`SomeMethod(object argument)`是固定的，您仍然无法在该方法中静态地保证这一点。您能做的最好的事情是在外部确保您传递的参数类型正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T16:59:11.560

创建一个反映您需要的类或结构

```
public class FooBar
{
    public Foo Foo { get; set; }
    public Bar Bar { get; set; }
} 
```

然后像这样调用你的方法

```
SomeMethod(new FooBar { Foo = foo, Bar = bar }); 
```

像这样实现它

```
public SomeMethod(object argument)
{
    var fooBar = argument as FooBar;
    if (fooBar != null) {
        Foo foo = fooBar.Foo;
        Bar bar = fooBar.Bar;
        ...
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T17:08:22.367

使用 可能会更好`Tuple<>`，例如：

```
Foo foo = new Foo();
Bar bar = new Bar();
Tuple<Foo, Bar> fooBar = new Tuple(foo, bar);
SomeMethod(fooBar); 
```

但是如果没有关于您的代码的更多信息，很难判断它是否比`object[]`.

# nosql - 何时在 NoSQL 中创建新文档

> ID：10337823
> 
> 赞同：3
> 
> 时间：2012-04-26T16:47:56.507
> 
> 标签：nosql, couchdb

我刚刚开始使用 NoSQL（在我的情况下为 CouchDB），似乎无法回答我认为应该是一个简单的问题，即围绕创建新文档与将数据附加到现有文档的常见做法是什么。

我目前每个用户都有一个数据库（这意味着我只能让用户访问他们拥有的数据）。

所以在顶层，我的 CouchDB 看起来像：

> *   用户A_db
> *   用户B_db

假设我有一个简单的笔记本应用程序，每个用户可以拥有 1 个或多个笔记本，每个包含 1 个或多个笔记。

**是为每个笔记本添加一个文档的想法，如下所示：**

> *   用户A_db
>     *   NoteBook1_doc = {笔记：[{notebody：'foo'}，{notebody：'bar'}]}
>     *   NoteBook2_doc = {笔记：[{notebody：'baz'}，{notebody：'boo'}]}

**或者，无论文档*是*什么、它*包含*什么或它*与什么相关，是否**一切都*应该是完全平坦的？**

 ***> *   用户A_db
>     *   NoteBook1_doc = { id: 1 }
>     *   Note1_doc { id: 1, parentBook: 1, notebody: 'foo' }
>     *   Note2_doc { id: 2, parentBook: 1, notebody: 'bar' }
>     *   SomethingCompletelyDifferent_doc { id: 1, text: '所有的牛都吃草' }
>     *   AccountInformation_doc { 姓名：“鲍勃”，年龄：34 }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T06:04:54.420

这可以是任何一种方式，但要记住一个有用的事实是文档是 CouchDB 中原子事务的单元。如果*所有*数据都在一个文档中，您可以对 CouchDB 中的数据进行原子性事务性更改。

另外，回想一下，CouchDB*视图*被称为“视图”，因为它们让您以各种方式以完全一致的状态*查看数据。*视图始终代表您请求时数据的时间点快照。视图还可以[将数据整理](http://wiki.apache.org/couchdb/View_collation)在一起。例如，视图可以通过将各个笔记整理在一起来向您展示一个笔记本。

Joachim 说得对，这是一个判断电话，但就个人而言，我更倾向于您的第二个选项：每个笔记都是一份文件。***

# google-app-engine - Objectify4 使用列表条件查询列表属性

> ID：10337824
> 
> 赞同：3
> 
> 时间：2012-04-26T16:47:56.553
> 
> 标签：google-app-engine, google-cloud-datastore, gql, objectify

我有一个名为**Guy的对象，它有一个****女朋友**类型 Key[]的属性

给定一个 Longs 列表，这是女孩的 id，我想查询**所有将这些女孩中的任何一个作为女朋友的 Guy。**

例如*（家伙：gilfriends* **）** ：

 *```
 LuckyGuy: {a,b,c}
 Guy1: {b}
 Guy2: {c} 
```

我想要*g*例如：

```
 g({a,b}) = LuckyGuy, Guy1
 g({c})) = LuckyGuy, Guy2 
```

我可以做一个循环：

```
for(i..n)
    resultSet.add(
        objectifyFactory.begin().load().type(User.class).filter("girlfriends", girlfriendId[i])
    ); 
```

但我确信有一个直接的策略。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T01:36:46.333

数据存储不支持“或”查询。您需要分别查询每个“女朋友”ID，并组合结果集。*

# c# - Application_Launching 中的 WP7 网络客户端

> ID：10337825
> 
> 赞同：2
> 
> 时间：2012-04-26T16:47:57.850
> 
> 标签：c#, windows-phone-7, xaml

我使用两个不同的网络客户端来下拉数据以显示在我的应用程序的主页上。我想将此代码移动到 app.xaml.cs 以在用户访问主页之前下载数据。我不确定如何在主页上为我的列表框设置 itemssource。这是我到目前为止所拥有的。

Application_Launching 中的代码

```
 private void Application_Launching( object sender, LaunchingEventArgs e)
    {
        // WebClient jsonGenres
        WebClient jsonGenres = new WebClient();
        Uri apiGenres = new Uri( "http://api.beatport.com/catalog/3/genres" );
        jsonGenres.DownloadStringCompleted += newDownloadStringCompletedEventHandler (jsonGenres_GetDataCompleted);
        jsonGenres.DownloadStringAsync(apiGenres);

        // WebClient jsonHome
        WebClient jsonHome = new WebClient();
        Uri apiHome = new Uri ("http://api.beatport.com/catalog/3/beatport/home" );
        jsonHome.DownloadStringCompleted += newDownloadStringCompletedEventHandler (jsonHome_GetDataCompleted);
        jsonHome.DownloadStringAsync(apiHome);

    }

    // Deserialize genres data
    public void jsonGenres_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        GenresHome genresData = JsonConvert.DeserializeObject<GenresHome>(e.Result);

        ViewModel.Genres = genresData.results;
        //this.listGenres.ItemsSource = genresData.results;
    }

    // Deserialize home page data
    public void jsonHome_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        ReleasesHome homeData = JsonConvert.DeserializeObject<ReleasesHome>(e.Result);

        const int limit = 6;
        ViewModel.Releases = homeData.results.featuredReleases.Take(limit);
        //this.listRelease.ItemsSource = homeData.results.featuredReleases.Take(limit);
    } 
```

和我的主页 xaml 代码。

```
 <ListBox x:Name="listRelease" ItemsSource="{Binding ReleasesHome}" Grid.Row="0" ScrollViewer.VerticalScrollBarVisibility="Disabled" >
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <toolkit:WrapPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical">
                                <toolkit:HubTile Source="{Binding images.large.url}" MouseLeftButtonUp="releaseSelectedHandler" Margin="10" IsFrozen="True" />
                                <TextBlock Text="{Binding name}" Width="173" />
                                <ListBox ItemsSource="{Binding artists}" Height="28" ScrollViewer.VerticalScrollBarVisibility="Disabled" >
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding name}" Margin="10,0,0,0" Width="173" Style="{StaticResource PhoneTextSubtleStyle}" />
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </controls:PanoramaItem>

    <!--Panorama item four-->          
    <controls:PanoramaItem x:Name="genres" Header="genres">
    <!--Single line list-->
            <Grid>
                <ListBox x:Name="listGenres" ItemsSource="{Binding GenresHome}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical">
                                <TextBlock x:Name="genresTxtBlock" Text="{Binding name}" MouseLeftButtonUp="genreSelectedHandler" Margin="10,5,0,0" Style="{StaticResource PhoneTextExtraLargeStyle}" />                                      
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>       
            </Grid>        
    </controls:PanoramaItem> 
```

谢谢您的帮助。

**更新**

请参阅上面的更新代码和下面的我的 ViewModel

```
public class MainViewModel : INotifyPropertyChanged
{
    public MainViewModel()
    {

    }

    private IEnumerable<ResultGenreHome> _genres; // backing field
    public IEnumerable<ResultGenreHome> GenresHome
    { 
        get { return _genres; }
        set
        {
            _genres = value;
            OnPropertyChanged("GenresHome");
        }
    }

    private IEnumerable<FeaturedReleasesHome> _releases; // backing field
    public IEnumerable<FeaturedReleasesHome> ReleasesHome
    {
        get { return _releases; }
        set
        {
            _releases = value;
            OnPropertyChanged("ReleasesHome");
        }
    }

    private void OnPropertyChanged(string p)
    {
        throw new NotImplementedException();
    }

    public bool IsDataLoaded
    {
        get;
        private set;
    }

    public void LoadData()
    {
        this.IsDataLoaded = true;
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

我已经在主页后面的代码中设置了数据上下文。这是我第一次使用 ViewModel，所以我不确定我应该在这里放什么。该应用程序运行没有任何问题，但没有显示任何数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:52:20.483

您可以向 App 类添加一个属性并将其设置为保存下载和反序列化的数据。

您所要做的就是使用此属性加载页面的数据上下文。

**编辑**

覆盖 App 类的 OnStartup 并从 App.xaml 中删除 StartURI：

base.OnStartUp(e); Window1 w = new Window1(); w.DataContext = ViewModel; this.MainWindow = w; w.Show();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T17:44:36.550

查看默认的“Windows Phone 数据绑定应用程序”Windows Phone 项目。这个项目有一个它在应用程序中创建的 ViewModel，这个 ViewModel 由 MainPage 使用。MainPage 然后使用 Binding 来获取它需要的数据。您可以通过执行从 App 设置 ViewModel 中的数据

```
ViewModel.Genres = genresData.results; 
```

然后你的 xaml 看起来像

```
<ListBox ItemsSource="{Binding Genres}">
    ...
</ListBox> 
```

为了在设置流派时更新 UI，ViewModel 中的属性必须触发 PropertyChanged 事件

```
private IEnumerable<Genre> _genres; // backing field
public IEnumerable<Genre> Genres
{ 
    get { return _genres; }
    set
    {
        _genres = value;
        OnPropertyChanged("Genres");
    }
} 
```

发布部分也是如此。

# matlab - matlab中的加载命令加载空白文件

> ID：10337828
> 
> 赞同：2
> 
> 时间：2012-04-26T16:48:13.650
> 
> 标签：matlab, file-io

我在 matlab 中加载一个文件，但它被加载为一个空变量。

```
positive    0x0    [] 
```

并且正在使用

```
 load positive.txt 
```

但文件不为空。有什么不对吗？PS 我已经成功地从同一个文件夹中加载了其他文件。我也尝试将其重命名为positive.dat，但这也没有奏效。这是一个我保存为文本文件的excel文件。

以及文件的前几个条目，复制并粘贴

```
04  10  19
04  10  36
04  10  28
04  16  16
04  14  01
04  20  21
04  20  06
04  20  28
04  13  14
04  13  17
04  13  02
04  01  16 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:56:02.263

`load`command 仅适用`.mat`于以 MATLAB 格式保存的 MAT 文件（文件扩展名）或 ASCII 文件，通常在 MATLAB 中使用`save`command。对于所有其他文件格式，您应该使用其他命令。

对于文本文件，您可以使用`fopen`, `fscanf`, `fclose`. 对于二进制文件，您可以使用`fopen`, `fread`, `fclose`. `fopen`打开文件进行读取和/或写入，`fscanf`或`fread`从文件中读取数据（`fscanf`读取文本、`fread`二进制数据），然后`fclose`关闭文件。

对于 Excel 文件，您可以使用`xlsread`. `xlsread`不需要`fopen`或`fclose`。

# android - glMultMatrixf 的翻译，以及何时规范化

> ID：10337829
> 
> 赞同：1
> 
> 时间：2012-04-26T16:48:13.670
> 
> 标签：android, opengl, opengl-es-2.0, 3d

所以我可以更好地理解事情，我试图摆脱调用 gl 转换函数（glTranslatef / glRotatef 等），而是创建自己的矩阵并使用 glMultMatrixf()。

我为 x/y/z 旋转创建的矩阵似乎完美无缺，但我的平移矩阵似乎将我的网格的所有顶点折叠成一个轴。

我是否认为传递矩阵是错误的：

```
 { 1.0f,0.0f,0.0f,x
      0.0f,1.0f,0.0f,y,
      0.0f,0.0f,1.0f,z,
      0.0f,0.0f,0.0f,1.0f }; 
```

到 glMultMatrixf 和 glTranslatef(x,y,z) 一样吗？（我是专栏专业的。为了确保我没有完全倒退，我转置了上面的矩阵，但它仍然没有用。似乎把所有东西都压平到不同的轴上。）

我在某处错过了标准化步骤吗？什么时候标准化你的矩阵是个好主意。

提前感谢您对我的一些知识！

这些是我的旋转矩阵：XAxis

```
{ 1.0f, 0.0f, 0.0f, 0.0f,
  0.0f, (float) Math.cos(x), (float) -Math.sin(x), 0.0f,
  0.0f, (float) Math.sin(x), (float) Math.cos(x), 0.0f,
  0.0f, 0.0f, 0.0f, 1.0f }; 
```

Y轴

```
{ (float) Math.cos(y),0.0f,(float) Math.sin(y),0.0f,
   0.0f,1.0f,0.0f,0.0f,
  (float) -Math.sin(y),0.0f,(float) Math.cos(y),0.0f,
   0.0f,0.0f,0.0f,1.0f }; 
```

Z轴

```
 { (float) Math.cos(z),(float) -Math.sin(z),0,0,
   (float) Math.sin(z),(float) Math.cos(z),0,0,
   0.0f,0.0f,1.0f,0.0f,
   0.0f,0.0f,0.0f,1.0f }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T17:15:36.763

对我来说，这看起来是换位的。元素顺序应该是：

```
 0   4   8   12
   1   5   9   13
   2   6   10  14
   3   7   11  15 
```

但是你在元素 3 中有 x，它应该是元素 12（y 和 z 相同）。

===编辑===

抱歉刚刚注意到你已经说过你转置了它。但是 x 绝对应该在元素 12 中，只是为了为您确认。我认为你不必对矩阵做任何额外的事情来让它工作。

# multithreading - 如何由于其中一个线程中的致命错误而终止多线程程序而不会出现“纯虚拟调用”错误？

> ID：10337831
> 
> 赞同：1
> 
> 时间：2012-04-26T16:48:20.300
> 
> 标签：multithreading, visual-c++, console-application, runtime-error

我有一个控制台应用程序，它启动多个工作线程，几乎不需要同步。如果其中一个线程出现异常，我会使用`boost::copy_exception`它来将其返回到主线程。但是当我在检测到工作线程错误后退出主线程中的应用程序（使用`boost::rethrow_exception`或使用）时，我得到`exit(1)``"pure virtual function called."`

似乎其他工作线程仍在各个点运行，并且它们所依赖的一些对象在工作线程终止之前被主线程销毁（部分？）。我有点猜测，因为当我附加调试器时自然不会发生这种情况。

我怎样才能同时杀死所有线程以避免这种情况，最好不要添加大量的中断点？或者也许我完全误解了这个错误......

我在 Windows 7 64 位上使用 MSVC 9。

# jquery - jQuery unbind/die live 事件

> ID：10337832
> 
> 赞同：0
> 
> 时间：2012-04-26T16:48:20.347
> 
> 标签：jquery, unbind

我有一个简单的应用程序来添加引号和喜欢引号的可能性（不是 FB 之类的）。我有一个简单的 div 作为带有以下子项的按钮：一个包含总点赞数的跨度和一个用于某些文本的段落。我需要使用 .live() 因为某些内容是使用 AJAX 加载的。我需要取消绑定/终止该事件，因为一旦单击该 div 就无法再单击。但是因为使用 .live() 你不能使用 $(this) 我尝试使用 event.target 但这有一些问题。

我的 HTML：

```
<div class="btnlike">
<span>0</span>
<p>Click to vote</p>
</div> 
```

我的 Javascript（到目前为止，使用 event.target）

```
$(".btnlike").live('click',function(event){     

    var $target;
    if( $(event.target).is("div") ) {
        $target = $(event.target);
    } else {
        $target = $(event.target).parent();
    }

    $target.unbind(event);      

}); 
```

但我想使用 .die() 但因为 $(this) 不起作用还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:55:35.007

一种解决方案是仅检查它是否已在实时功能中的该元素上执行。

```
$(".btnlike").live('click',function(event){     
    if ($(this).data('clicked')) {
      // already ran it
      return; 
    }
    // mark it as being run
    $(this).data('clicked', true);
}); 
```

# java - 如何访问 IContributionItem 的组合框

> ID：10337833
> 
> 赞同：2
> 
> 时间：2012-04-26T16:48:29.173
> 
> 标签：java, eclipse, eclipse-plugin, swt

我设法按照下面列出的代码在 IToolBarManager 上添加了一个组合框。现在有没有人知道如何从该范围之外访问在 IContributionItem 内创建的组合框？

亲切的问候，基里亚科斯

```
IToolBarManager mgr = this.getViewSite().getActionBars().getToolBarManager();
IContributionItem comboCI = new ControlContribution("test") {
    protected Control createControl(Composite parent) {

        final Combo c = new Combo(parent, SWT.READ_ONLY);
        c.add("one");
        c.add("two");
        c.add("three");
        c.addSelectionListener(new SelectionAdapter() {
             public void widgetSelected(SelectionEvent e) {
                 c.add("four");
              }
              });
        return c;
    }
};        

mgr.add(comboCI); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T17:44:21.013

将组合变量放在 ControlContribution 类或 IContributionItem 接口中并创建一个 get 方法。

```
class ControlContribution implements IContributionItem {

    protected Combo combo;

    public Combo getCombo(){
        return combo;
    }
} 
```

这样，您无需在匿名类中声明它。

```
IContributionItem comboCI = new ControlContribution("test") {
protected Control createControl(Composite parent) {

    combo = new Combo(parent, SWT.READ_ONLY);
    combo.add("one");
    combo.add("two");
    combo.add("three");
    combo.addSelectionListener(new SelectionAdapter() {
         public void widgetSelected(SelectionEvent e) {
             combo.add("four");
          }
          });
    return combo;
}
}; 
```

你可以打电话

```
comboCI.getCombo(); 
```

显然，IContributionItem 接口需要有 getCombo() 方法

# sql - 进行多个联接时是否需要连续关系

> ID：10337834
> 
> 赞同：3
> 
> 时间：2012-04-26T16:48:34.387
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005

这两个语句/示例之间的结果或性能是否存在差异：

示例 1（连续的 INNER 关系）

```
 SELECT ID FROM TABLE T
    INNER JOIN TABLE2 T2 ON T.ID = T2.ID
    INNER JOIN TABLE3 T3 ON T2.ID = T3.ID 
```

示例 2（非连续 INNER 关系）

```
 SELECT ID FROM TABLE T
    INNER JOIN TABLE2 T2 ON T.ID = T2.ID
    INNER JOIN TABLE3 T3 ON T.ID = T3.ID 
```

* * *

或在这两个语句/示例之间：

示例 1（连续的 LEFT 关系）

```
 SELECT ID FROM TABLE T
    INNER JOIN TABLE2 T2 ON T.ID = T2.ID
    LEFT JOIN TABLE3 T3 ON T2.ID = T3.ID 
```

示例 2（非连续 LEFT 关系）

```
 SELECT ID FROM TABLE T
    INNER JOIN TABLE2 T2 ON T.ID = T2.ID
    LEFT JOIN TABLE3 T3 ON T.ID = T3.ID 
```

唯一的区别是第二个`Join`是 on`Table`而第一个例子是 on `Table2`。我很确定他们会返回相同的东西，但我只是在这里寻找更有经验的答案。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:09:30.650

结果没有区别。这些语句在功能上是等效的。

性能上的差异取决于具体的数据库和版本，以及数据。

我的经验是，在这样的简单情况下，两个查询之间的性能通常没有差异。SQL2008 优化器将根据统计信息（表的大小、索引的可用性）以任何有意义的顺序运行连接，无论您使用哪种方式编写此查询。

# mongodb - Virtuozzo 中的 MongoDB (OpenVZ)

> ID：10337835
> 
> 赞同：1
> 
> 时间：2012-04-26T16:48:42.497
> 
> 标签：mongodb, openvz, virtuozzo

我的服务器托管在 HostEurope 上，这是一个虚拟服务器

uname -a 提示

**Linux lvps176-28-21-237.dedicated.hosteurope.de 2.6.18-028stab095.1 #1 SMP Mon Oct 24 20:15:15 MSD 2011 x86_64 GNU/Linux**

他们正在运行 OpenVZ。根据 Virtuozzo 的最新版本 HostEurope 的支持，但是阅读 OpenVZ 上的版本历史，这个版本是旧的，已冻结，将不再维护。谁是对的？

我的实际问题是我想运行一个 MongoDB，但我遇到了这里解释的这个 OpenVZ 问题：

[OpenVZ 上报告的崩溃](https://jira.mongodb.org/browse/SERVER-1121)

那么，我能做些什么呢？有没有机会在这个版本的 OpenVZ 上解决 MongoDB 中的这个内存不足问题，还是我必须找到其他托管公司？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:14:47.980

不幸的是，不在当前版本的 OpenVZ 中。如果您在发布的该线程链接的底部看到，则有针对新 OpenVZ（RHEL6 或更高版本）的建议解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T19:31:40.867

使用 ulimit 怎么样？

ulimit -Sv 500000

将进程限制为 500GB

# javascript - JavaScript - Date 实例的 Date.UTC 结果

> ID：10337839
> 
> 赞同：0
> 
> 时间：2012-04-26T16:49:08.557
> 
> 标签：javascript

我有一个图表库，它期待日期值，就好像我已经调用过一样：

```
var utc = Date.UTC(2012, 1, 15); 
```

但我的服务器正在返回日期字符串。给定“2/15/2012”的日期字符串，是否有一种*简单*的方法可以获得相同的调用结果`Date.UTC(2012, 1, 15);`？

我在下面的工作，但我想知道是否有更简单的方法。

```
//correct result I'm shooting for
var utc = Date.UTC(2012, 1, 15);

//is there an easier way?
var d = new Date("2/15/2012");
var utc2 = Date.UTC(d.getFullYear(), d.getMonth(), d.getDate());

console.log(utc, "  ===  ", utc2, (utc === utc2) ? "SWEET" : "DAMNIT"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:54:45.987

您可以拆分传入的字符串（我知道，这很恶心，但这是我能想到的唯一其他解决方案）。

```
var dstring = "2/15/2012".split("/");
var utc = Date.UTC(dstring[2], dstring[0]-1, dstring[1]); 
```

月份的 -1 是为了抵消 0 索引月份。你甚至可以把它变成一个函数：

```
String.prototype.dateFromString = function() {
    var str = this.split("/");
    return [str[2], str[0]-1, str[1];
}

var dstring = "2/15/2012";
var utc = Date.UTC(dstring.dateFromString[0], dstring.dateFromString[1], dstring.dateFromString[2]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T16:59:29.157

如果日期始终采用`m/d/y`（或者至少还没有时区）格式，您可以附加`' UTC'`到它并使用`getTime`：

```
var mdy = "2/15/2012";
var utc = new Date(mdy + " UTC").getTime();

console.log(utc == Date.UTC(2012, 1, 15)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:03:30.637

一个班轮：

```
var utc = new Date(new Date('2012/02/30').toUTCString()).valueOf() 
```

# jquery-selectors - jquery选择器：仅将功能应用于当前元素

> ID：10337846
> 
> 赞同：0
> 
> 时间：2012-04-26T16:49:32.443
> 
> 标签：jquery-selectors, jquery

我有一个 jquery 函数，它发生在给定类的所有输入的焦点上。它工作得很好，除非当它被应用时，它适用于该类的所有输入。如何仅将功能应用于触发操作的功能？

请看我的[JSFiddle](http://jsfiddle.net/xi4xi4/sv9uZ/2/)

（点击日期时，全部清除。另外如果你输入了1，其他不返回默认提示）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:52:30.890

采用`$(this)`

```
$('.inputDay').focus(function() {         
    if ($(this).val() == "dd") {
        $(this).val("").css("color", "#000000");
    }
}); 
```

工作示例： http: [//jsfiddle.net/sv9uZ/3/](http://jsfiddle.net/sv9uZ/3/) （我也修复了其他代码以使用链接）

**编辑：** 为了避免`$(this)`每次调用（因为我们不止一次使用），我们可以将它存储到一个局部变量并使用它。感谢[Mathletics](https://stackoverflow.com/users/7469/mathletics)提出来。

```
$('.inputDay').focus(function() {
    var item=$(this); 
    if (item.val() == "dd") {
        item.val("").css("color", "#000000");
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:51:35.957

只需说 $(this).val <-- 而不是使用类。这将仅适用于当前的

给出类名将适用于所有匹配的类名。相反，这样说将仅适用于当前修改的那个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:54:33.340

我知道这已经得到解答，但通常当我这样做时，我会将我想要灰显的值存储在输入的标题属性中，这将允许您减少一些代码并执行以下操作：

```
$(document).ready(function() {
  $('.inputDay, .inputYear').focus(function(e){
    $this = $(this);
    $this.val() == $this.attr('title') ? $this.val('') : '';     
    $this.css("color", "#000");
  }).blur(function(){
    $this = $(this);
    if(!$this.val().length){
      $this.val($this.attr("title")).css("color", "#999");
    }
  });

  $('.inputDay, .inputYear').trigger('blur');    
}); 
```

这样您就不必将函数绑定到任何特定值，如“dd”或“yyyy”，这样它就可以被重用。

对于演示：http: [//jsfiddle.net/Wjmav/1/](http://jsfiddle.net/Wjmav/1/)

# ruby-on-rails - 选择 mongoid 中不为空或为空的位置

> ID：10337847
> 
> 赞同：85
> 
> 时间：2012-04-26T16:49:33.673
> 
> 标签：ruby-on-rails, mongoid

我修改了一个模型，使其包含一个新字段，例如...

`field :url, :type => String`

我使用activeadmin，所以当我创建一个新条目时`@model.url`是空的，并且在更改架构之前创建的条目中它是零。如何选择两者？我努力了：

```
# Returns nils and strings
Model.where(:url.ne => "").count 

# Returns strings and ""
Model.where(:url.ne => nil).count

# Returns strings, nils and ""
Model.where(:url.ne => ["", nil]).count 
```

或者，如果这种情况有最佳实践，请告诉我。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-26T18:36:35.333

Try

```
Model.where(:url.ne => "", :url.exists => true).count 
```

see [Mongoid Symbol Operators](http://mongoid.org/en/origin/docs/selection.html#symbol)

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2013-11-28T22:08:36.380

尝试

```
Model.where(:url.nin => ["", nil]).count 
```

即使在`url = nil`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-04-13T14:28:41.360

尝试：

```
Model.nin(url: ['', nil]) 
```

# php - PHP if, elseif 误用？

> ID：10337854
> 
> 赞同：0
> 
> 时间：2012-04-26T16:50:07.420
> 
> 标签：php, mysql, if-statement

因此，我正在处理网站的 php 部分，该部分需要根据使用 GET 传递给它的值的值执行不同的操作。URL 是正确的，但我遇到了只输入第一个 if 语句的问题（我用 echo 测试过。）

这是有问题的php：

```
$field = $_GET['value'];
$upc = $_GET['upc'];
$type = $_GET['field_type'];
echo $field;
echo $upc;
echo $type;

if ($type == "series") {
    $stmt = $db_connection -> stmt_init();
    $returnValue = "invalid";
    if ($stmt -> prepare("update graphic_novel_main set series='" . $field . "' where upc='" . $upc . "'") or die("<br/>Error Building Query!<br/>" . mysqli_error($db_connection))) {
        $stmt -> execute();
        echo "<div>change sucessful?</div>";
        $stmt -> close();
    } else {
        echo "error querying database!";
    }
}
if ($field == "subtitle") {
    $stmt1 = $db_connection -> stmt_init();
    $returnValue = "invalid";
    if ($stmt1 -> prepare("update graphic_novel_main set subtitle='" . $field . "' where upc='" . $upc . "'") or die("<br/>Error Building Query!<br/>" . mysqli_error($db_connection))) {
        $stmt1 -> execute();
        echo "<div>change sucessful?</div>";
        $stmt1 -> close();
    } else {
        echo "error querying database!";
    }
} 
```

顶部的回声显示正确的值。第一个 if 将正确执行。但第二个不会。

如果有人知道为什么这不起作用，如果你能告诉我那就太棒了

注意：我尝试将第二个 if 更改为“else if”和“elseif”，结果相同

# php - 使用 \n 分割 csv 文件是否安全？

> ID：10337858
> 
> 赞同：0
> 
> 时间：2012-04-26T16:50:20.517
> 
> 标签：php, parsing, csv, explode

`\n`使用字符拆分 csv 文件是否安全，`explode()`或者我也应该包括在内`\r`以确保安全？90% 的文件将来自 Windows 计算机，并且可能使用 ms excel 从 .xls 文件转换。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:53:08.677

你为什么不首先使用[`fgetcsv`](http://us3.php.net/manual/en/function.fgetcsv.php)？

请参阅该手册页上的以下注释：

> **注意**：如果 PHP 在读取 Macintosh 计算机上或由 Macintosh 计算机创建的文件时不能正确识别行结尾，则启用`auto_detect_line_endings`运行时配置选项可能有助于解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T16:53:56.927

您想将[fgetcsv](http://en.php.net/manual/en/function.fgetcsv.php) / [fgets](http://en.php.net/manual/en/function.fgets.php)与[auto_detect_line_ending](http://www.php.net/manual/en/filesystem.configuration.php#ini.auto-detect-line-endings)结合使用。

你需要数吗？在 fgetcsv 中增加一个计数器将**节省大量内存**和（cpu）时间，而不是完整的读入和额外的循环来计算读入。

如果您改变主意但想要保存一行甚至特定单元格以供以后处理，您也会更加灵活。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:01:37.697

怎么样：

```
$num_lines = count(file('your-file.csv')); 
```

不确定这会有多密集？

# stylus - 有没有办法在手写笔中以编程方式构建 CSS 选择器链？

> ID：10337864
> 
> 赞同：3
> 
> 时间：2012-04-26T16:50:51.320
> 
> 标签：stylus

我试图弄清楚，如何在“for in”循环中构建 CSS 选择器。

类似的东西：

```
ul
    for row in 1 .. 4
        li*{row}                 <=== thats the tricky part 
            padding: 10px * row 
```

它应该产生：

```
ul li{ padding: 10px }
ul li li{ padding: 20px }
ul li li li{ padding: 30px }
ul li li li li{ padding: 40px } 
```

那可能吗？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T10:27:36.220

是的，有可能：

```
ul
  el = ''
  for row in 1..4
    el += ' li'
    {el}
      padding row * 10px 
```

你可能想为此创建一个 mixin，我把它留给你作为练习！

**编辑：**输出：

```
ul li {
  padding: 10px;
}
ul li li {
  padding: 20px;
}
ul li li li {
  padding: 30px;
}
ul li li li li {
  padding: 40px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-31T09:09:37.207

为您执行此操作的混合/函数示例：

```
build_selector(selector, count)
  $out = selector

  for i in 1..count
    {$out}
        padding i * 10px
    $out += ' ' + selector

ul
    {build_selector(li, 4)} 
```

产生：

```
ul li {
    padding: 10px;
}

ul li li {
    padding: 20px;
} 
```

# matlab - Matlab无效表达式错误

> ID：10337865
> 
> 赞同：0
> 
> 时间：2012-04-26T16:50:53.793
> 
> 标签：matlab, sign

```
while  B(i,j,k) ~= 0
{ C = C + B(i,j,k);
  i++;
  j++;
  k++;
   }
end 
```

我试图在 double 中添加一个 mXnX3 矩阵以获得 (i,i,i) 元素的总和，但上面的声明给出了一个 matlab 错误。我似乎无法纠正它。帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T16:52:38.243

这很可能是错误，因为它不是正确的 Matlab 语法。你读过[文档](http://www.mathworks.com/help/techdoc/learn_matlab/bqr_2pl.html)吗？

要使用循环解决此问题，您可以编写：

```
C = 0;
for i=1:size(B,1)
   C = C + B(i,i,i);
end 
```

要以“Matlab”方式进行，您可以编写

```
nn = size(B,1);
C = sum(B(1:(nn^2+n+1):end)); 
```

注意：以上所有假设 B 是 nxnxn。

如果你想得到*所有*元素的总和，你可以简单地写

```
C = sum(B(:)); 
```

如果你真的想做一个三重循环，你写

```
C = 0;
[nI,nJ,nK]=size(B);
for i=1:nI
  for j=1:nJ
    for k=1:nK
       C = C + B(i,j,k);
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:52:05.167

`i++`不是有效的 Matlab。大括号也不是`{}`。

# build - 并行 GNU Make 为 Antlr 解析器生成文件多次运行命令

> ID：10337866
> 
> 赞同：4
> 
> 时间：2012-04-26T16:51:04.650
> 
> 标签：build, makefile, parallel-processing, antlr, gnu

我有一个生成文件规则来生成 antlr 解析器的输出文件：

```
XLexer.c XLexer.h XParser.c XParser.h X.tokens: X.g
    $(ANTLR) $(ANTLRFLAGS) X.g 
```

正如预期的那样，当 Xg 更改时，这可以正常工作并重建所有生成的文件。但是当我使用 -j 标志运行并行 make 时，上述规则对每个文件运行一次，因此在这种情况下，antlr 调用并行运行 5 次。

有没有办法执行这种类型的规则但只运行一次命令？我知道 .NOPARALLEL: 规则，但这违背了目的。如果一个已经在运行但没有成功，我试图使用一个锁定文件来导致多个运行退出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T16:59:22.773

除非所有的输出文件共享一个共同的词干（例如，“XLexer.c”和“XLexer.h”都有词干“XLexer”），否则在GNU make 中没有干净的方法可以做到这一点。有多种解决方法，例如使用哨兵文件：

```
XLexer.c XLexer.h XParser.c XParser.h X.tokens: dummy
    @

dummy: X.g
    $(ANTLR) $(ANTLRFLAGS) X.g && touch dummy 
```

在 CMCrossroads 的 Mr. Make 专栏上的[GNU Make 中的多输出规则](http://www.cmcrossroads.com/ask-mr-make/12908-rules-with-multiple-outputs-in-gnu-make)一文中对选项进行了详尽的描述。

（“@”行是一个“no-op”命令，但它很重要：没有它，GNU make 会假设`XLexer.c`和朋友永远不会通过增量重建来更新，所以你必须运行 make 两次才能对 Xg 进行任何更改生效）

或者，您可以使用更智能的 make 版本，例如[ElectricAccelerator](http://www.electric-cloud.com/products/electricaccelerator-dev.php)，它会自动为您解决这个问题（免责声明：我是 ElectricAccelerator 的架构师）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-20T16:11:15.350

模式规则的行为与普通规则不同；[手册](https://www.gnu.org/savannah-checkouts/gnu/make/manual/html_node/Pattern-Intro.html)说：

> 模式规则可能有多个目标。与普通规则不同，这不会像许多具有相同先决条件和配方的不同规则一样起作用。如果模式规则有多个目标，`make`则知道规则的配方负责生成所有目标。该配方仅执行一次以生成所有目标。

这将适用于您的情况，因为您有一个共同的词干 ( `X`)：

```
all: XLexer.c XLexer.h XParser.c XParser.h X.tokens
# (or more realistically, several targets that depend on the above)

%Lexer.c %Lexer.h %Parser.c %Parser.h %.tokens: %.g
    $(ANTLR) $(ANTLRFLAGS) $< 
```

# python - python urllib2 多下载

> ID：10337867
> 
> 赞同：2
> 
> 时间：2012-04-26T16:51:08.457
> 
> 标签：python, html, urllib

如何让下面的脚本一次下载多个链接，而不是使用 urllib2 一次下载一个？

Python：

```
from BeautifulSoup import BeautifulSoup
import lxml.html as html
import urlparse
import os, sys
import urllib2
import re

print ("downloading and parsing Bibles...")
root = html.parse(open('links.html'))
for link in root.findall('//a'):
  url = link.get('href')
  name = urlparse.urlparse(url).path.split('/')[-1]
  dirname = urlparse.urlparse(url).path.split('.')[-1]
  f = urllib2.urlopen(url)
  s = f.read()
  if (os.path.isdir(dirname) == 0): 
    os.mkdir(dirname)
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  full_path = os.path.join(dirname, name)
  open(full_path, 'w').write(converted)
  print(name)
print("DOWNLOADS COMPLETE!") 
```

链接.html

```
<a href="http://www.youversion.com/bible/gen.1.nmv-fas">http://www.youversion.com/bible/gen.1.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.2.nmv-fas">http://www.youversion.com/bible/gen.2.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.3.nmv-fas">http://www.youversion.com/bible/gen.3.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.4.nmv-fas">http://www.youversion.com/bible/gen.4.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.5.nmv-fas">http://www.youversion.com/bible/gen.5.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.6.nmv-fas">http://www.youversion.com/bible/gen.6.nmv-fas</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:00:00.903

Blainer，尝试穿线。

这是一个很好的实际例子

[http://www.ibm.com/developerworks/aix/library/au-threadingpython/](http://www.ibm.com/developerworks/aix/library/au-threadingpython/)

然后也引用 python std 库

[http://docs.python.org/library/threading.html](http://docs.python.org/library/threading.html)

如果您查看实际示例，它实际上有一个 urllib2 并发下载的线程版本示例。II 继续并带您进一步进入该过程，您将不得不使用修复此问题的部分来进一步解析您的 html。

```
#!/usr/bin/env python

import Queue
import threading
import urllib2
import time
import htmllib, formatter

class LinksExtractor(htmllib.HTMLParser):
    # derive new HTML parser

    def __init__(self, formatter):        
        # class constructor
        htmllib.HTMLParser.__init__(self, formatter)  
        # base class constructor
        self.links = []        
        # create an empty list for storing hyperlinks

    def start_a(self, attrs) :  # override handler of <A ...>...</A> tags
        # process the attributes
        if len(attrs) > 0 :
            for attr in attrs :
                if attr[0] == "href":         
                    # ignore all non HREF attributes
                    self.links.append(attr[1]) # save the link info in the list

    def get_links(self) :     
        # return the list of extracted links
        return self.links

format = formatter.NullFormatter()
htmlparser = LinksExtractor(format)

data = open("links.html")
htmlparser.feed(data.read())
htmlparser.close()

hosts = htmlparser.links

queue = Queue.Queue()

class ThreadUrl(threading.Thread):
    """Threaded Url Grab"""
    def __init__(self, queue):
        threading.Thread.__init__(self)
        self.queue = queue

    def run(self):
        while True:
            #grabs host from queue
            host = self.queue.get()

            ####################################
            ############FIX THIS PART###########
            #VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV#

            url = urllib2.urlopen(host)
            morehtml = url.read() # your own your own with this

            #signals to queue job is done
            self.queue.task_done()

start = time.time()
def main():
    #spawn a pool of threads, and pass them queue instance 
    for i in range(5):
        t = ThreadUrl(queue)
        t.setDaemon(True)
        t.start()

        #populate queue with data   
    for host in hosts:
        queue.put(host)

    #wait on the queue until everything has been processed     
    queue.join()

main()
print "Elapsed Time: %s" % (time.time() - start) 
```

# database - 从数据库中添加和删除条目

> ID：10337869
> 
> 赞同：1
> 
> 时间：2012-04-26T16:51:13.377
> 
> 标签：database, jsp, dictionary, javabeans

下面的代码来自我的addRemove.jsp，它服务的目的是要表单，一个用于向我的数据库的单词表提交一个新单词，一个用于删除一个。要添加一个词，必须完成 GermanName、gender 和 englishName。提交后，用户可以看到更新后的表格。

在此之下，我创建了一个删除表单，用户必须在其中指定 GermanName 值才能删除该单词。该按钮应将用户再次引导至更新的表格。问题是只有第一个提交按钮会重定向我。此外，似乎根本没有发生删除。我将只提供 addRemove.jsp，但如果您认为还需要查看它，我也可以发布 WordDataBean.java 文件。

添加删除.jsp

```
<?xml version = "1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<%-- beans used in this JSP --%>
<jsp:useBean id = "word" scope = "page"
             class = "org.me.jsp.beans.WordBean" />
<jsp:useBean id = "wordData" scope = "request"
             class = "org.me.jsp.beans.WordDataBean" />

<html xmlns = "http://www.w3.org/1999/xhtml">

    <head>
        <title>Student Registration Form</title>

        <style type = "text/css">
            body {
                font-family: tahoma, helvetica, arial, sans-serif;
            }

            table, tr, td {
                font-size: .9em;
                border: 1px groove;
                padding: 2px;
                background-color: white;
            }
        </style>
    </head>

    <body>
        <jsp:setProperty name = "word" property = "*" />

        <% // start scriptlet

                    if (word.getGermanName() == null
                            || word.getGender() == null
                            || word.getEnglishName() == null) {

        %> <%-- end scriptlet to insert fixed template data --%>

        <form method = "post" action = "addRemove.jsp">
            <p>To add a new word complete the form below</p>

            <table>
                <tr>
                    <td>German name</td>

                    <td>
                        <input type = "text" name = "germanName" />
                    </td>
                </tr>

                <tr>
                    <td>Gender</td>

                    <td>
                        <input type = "text" name = "gender" />
                    </td>
                </tr>

                <tr>
                    <td>English Name</td>

                    <td>
                        <input type = "text" name = "englishName" />
                    </td>
                </tr>

                <tr>
                    <td colspan = "2">
                        <input type = "submit"
                               value = "Submit" />
                    </td>
                </tr>
            </table>
        </form>

        <% // continue scriptlet
              } // end if
              else {
                  wordData.addWord(word);

        %> <%-- end scriptlet to insert jsp:forward action --%>

        <%-- forward to display word list --%>
        <jsp:forward page = "wordListView.jsp" />

        <% // continue scriptlet

                    }  // end else

        %> <%-- end scriptlet --%>

        <% // start scriptlet

                    if (word.getGermanName() == null
                            || word.getGender() == null
                            || word.getEnglishName() == null) {

        %> <%-- end scriptlet to insert fixed template data --%>

        <form method = "post" action = "addRemove.jsp">
            <p>To remove word complete the form below</p>

            <table>
                <tr>
                    <td>German name</td>

                    <td>
                        <input type = "text" name = "germanName" />
                    </td>
                </tr>

                <tr>
                    <td colspan = "2">
                        <input type = "submit"
                               value = "Remove" />
                    </td>
                </tr>
            </table>
        </form>

        <% // continue scriptlet
              } // end if
              else {
                  wordData.removeWord(word);

        %> <%-- end scriptlet to insert jsp:forward action --%>

        <%-- forward to display word list --%>
        <jsp:forward page = "wordListView.jsp" />

        <% // continue scriptlet

                    }  // end else

        %> <%-- end scriptlet --%>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T18:29:46.263

你的逻辑有严重的问题。

根据

```
if (word.getGermanName() == null
       || word.getGender() == null
       || word.getEnglishName() == null) { 
```

如果这三个值中的任何一个为 NULL，那么它将显示要添加的表单。如果没有，那么它将添加word using`wordData.addWord(word);`然后转发到`wordListView.jsp`. 所以，这适用于添加。

现在，您再次检查所有相同的三个字段，`null`并基于要删除的相同显示表单（即在文本框上）。在您删除按钮的情况下，第一个条件（您的意思是添加）将为真，它将显示具有 3 个输入字段的相同表单。

# jquery - 粘性项目，跟随 div

> ID：10337874
> 
> 赞同：1
> 
> 时间：2012-04-26T16:51:26.747
> 
> 标签：jquery, scroll

好的，问题。我想要，这个（见下面的演示链接）深灰色框（这将是图像的占位符）出现并滚动，而用户正在阅读长篇文章，但是当用户到达下一篇文章时，前一个框就在那里，它在哪里，下一个框开始滚动，依此类推。

现在，我可以管理第一个框以某种方式滑动，但是这个 html 中的所有这些框也会滑动。

我所需要的只是一点 jquery 增强功能，以使其正常工作。

这就是我到目前为止所做的[http://jsfiddle.net/yG5Gy/](http://jsfiddle.net/yG5Gy/)

以及，它自己的基本javascript：

```
$(".content").bind("scroll", function() {
    if ($(".content").scrollTop() + 275 <= $(".post_text").height()) {
        $(".post_img").css("top", $(".content").scrollTop());
    }
});​ 
```

谢谢，

/抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:20:44.263

您的问题的关键是您正在使用具有多个结果的类选择器。您需要使用 each 方法单独操作每个帖子：

```
$("li.entry").each(function(){
    // This will select only the image within the currently looped entry div
    $(this).find(".post_img");
} 
```

# insert - SmartClient：在单选项目之间插入控件

> ID：10337895
> 
> 赞同：0
> 
> 时间：2012-04-26T16:52:27.463
> 
> 标签：insert, controls, radio, smartclient

**问题**：

我正在浏览 SmartClient 论坛并阅读了一个问题（这里是[链接](http://forums.smartclient.com/showthread.php?t=21882&highlight=radio)），说明如下：

> **在单选选项之间插入一个选择框。**
> 
> 在 SmartClient 中，每当我使用单选组时，我都会指定一个值映射，所有单选选项按值映射中提到的顺序一起显示（一个接一个）。有什么方法可以在这些选项之间插入任何其他组件？我想要类似的东西，第一个单选选项然后是选择框，第二个选项然后是选择框等等......

**解决方案**：

我尝试了一些选项并进行了一些调整。我得到的是，如果您保持单选组项目的名称相同，然后将相同的项目传递给具有不同 valueMap 的动态表单控件，则可以实现此目的。我明白，没有代码很难想象一些事情:)。所以，我们开始......

但是等等 :) .... 别担心，我会分享代码，但我只想先显示结果。

**结果**：

![在此处输入图像描述](../Images/258c0253fc80f1483349110662eb1073.png)

**代码**：

```
<HTML>
<HEAD>
<SCRIPT>var isomorphicDir = "../content/isomorphic/";</SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_Core.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_Foundation.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_Containers.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_Grids.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_Forms.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_DataBinding.js"></SCRIPT>
<SCRIPT SRC="../content/isomorphic/system/modules/ISC_PluginBridges.js"></SCRIPT>
<SCRIPT SRC="sc_common.js"></SCRIPT>

<!-- Isomorphic Skin -->
<SCRIPT SRC="../content/isomorphic/skins/SilverWave/load_skin.js"></SCRIPT>
</HEAD>

<BODY>
<!-- $Id: cm_admin.js 875 2006-11-17 23:34:46Z sverma $ . -->
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">

isc.DynamicForm.create ({
    autoDraw: true,
    fields: [
        {
         name: "Radio",
         title: "Title One",
         type: "radioGroup",
         valueMap: {"1":"Yes"}
         },
         {
         name: "Shailendra",
         defaultValue: "Enjoy"
         },
         {
         name: "Radio",
         title: "Title Two",
         type: "radioGroup",
         valueMap: {"2":"No"}
         }
    ]
});

</SCRIPT>

</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T15:14:30.587

DynamicForm 也可以有一个 ID 属性以供参考，例如

```
isc.DynamicForm.create ({
ID:"DynamicForm1",
autoDraw: true,
fields: [
    {
     name: "Radio",
     title: "Title One",
     type: "radioGroup",
     valueMap: {"1":"Yes"}
     },
     {
     name: "Shailendra",
     defaultValue: "Enjoy"
     },
     {
     name: "Radio",
     title: "Title Two",
     type: "radioGroup",
     valueMap: {"2":"No"}
     }
] 
```

});

# c# - Resharper 无法识别 web.config 中的命名空间别名

> ID：10337897
> 
> 赞同：2
> 
> 时间：2012-04-26T16:52:36.617
> 
> 标签：c#, asp.net, visual-studio-2010, namespaces, resharper

在我的 ASP.NET WebApplication 中，我的 web.config 中有以下条目：

```
<pages controlRenderingCompatibilityVersion="3.5" clientIDMode="Static">
    <namespaces>
        <add namespace="XSS=Microsoft.Security.Application" />
    </namespaces>
</pages> 
```

这使我能够以一种简单快捷的方式在我的页面和控件中使用 AntiXSS-Library，而无需每次都使用完全限定的命名空间，如下所示：

```
<%# XSS.Encoder.HtmlEncode(Eval("something").ToString()) %> 
```

代替

```
<%# Microsoft.Security.Application.Encoder.HtmlEncode(Eval("Branche_lbl").ToString()) %> 
```

这在 ASP.NET 中完美运行，不幸的是 Resharper 似乎无法解析别名，将该行标记为错误并说

> 无法解析符号：XSS

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:49:56.867

这似乎是对 ASP.NET 的破解，并且没有记录在案……我们将考虑在 R# 7.0 中修复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T17:27:50.007

如果它编译得很好并且工作正常，你*可以*通过进入“检查选项”让 Resharper 忽略它。

# grails - GORM 自定义监听器

> ID：10337899
> 
> 赞同：0
> 
> 时间：2012-04-26T16:52:42.857
> 
> 标签：grails, listener, grails-orm, datastore

有人知道 GORM 的自定义监听器是如何工作的吗？我怎样才能实例化一个？我正在使用 Grails 2.0.1，文档在这个主题上完全没用。我无法注册我的侦听器，因为我需要数据存储来创建它，我不知道如何检索它。

解决了！如果有人遇到同样的问题，我会写解决方案。为了添加监听器，我以这种方式扩展了类*org.grails.datastore.mapping.engine.event.PersistenceEventListener*

```
class MyCustomListener implements PersistenceEventListener{
@Override
public boolean supportsEventType(Class<? extends ApplicationEvent> event) {
    return ValidationEvent.class.isAssignableFrom(event)
}

@Override
public boolean supportsSourceType(Class<?> clazz) {
    return true
}

@Override
public void onApplicationEvent(ApplicationEvent event) {
   log.debug 'My custom listener!'
}

@Override
public int getOrder() {
    return DEFAULT_ORDER;
} 
```

}

# html - 多张图片以相同方式放大的网页——如何实现？

> ID：10337901
> 
> 赞同：0
> 
> 时间：2012-04-26T16:52:49.237
> 
> 标签：html, image, web, zooming

我是经验丰富的 C++ 开发人员进行图像处理，但我的任务是创建一些网页来比较应用于一张图像的几种算法的不同结果。

我在任何与网络编程相关的事情上都是新手，所以我的问题是我应该使用什么工具来创建这样的网页？它应该显示几幅图像：源一及其由某些算法产生的变体。挑战在于我希望能够在不同位置以不同的放大倍率同时检查所有这些图像。

即初始页面可能看起来像这样，顶部有源图像：

![在此处输入图像描述](../Images/b476f597719a86f7d80fbf5e51f11db8.png)

然后我将鼠标光标悬停在源图像上，通过转动鼠标滚轮放大并将其拖动到感兴趣的区域，所以现在我可以看到如下内容：

![在此处输入图像描述](../Images/0de9ad6ceb68a2820779b57061d21f2b.png)

嗯，就是这样。我不需要任何漂亮的动画或花哨的选框预览。这只是一项务实的任务。我认为，有很多方法可以做到这一点，但对于新手来说，最简单的方法是什么？

谢谢。也许这个问题应该发布在与网络编程更相关的其他网站上？欢迎提供有关在何处发布的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T12:29:16.467

我认为您需要使用带有 CSS 技巧的 JS（JS 来控制 CSS）。

例如，使用 widht\height 参数 (CSS\HTML) 缩放图像，然后使用负边距 (CSS) 设置视点，然后使用溢出：隐藏在环绕图像的 div 上裁剪图像。

我可以推荐你使用**jQuery**。

*   您可以使用它来操作图像 (http://api.jquery.com/animate/)

*   您可以使用它来跟踪鼠标 (http://docs.jquery.com/Tutorials:Mouse_Position) 和滚动 (http://api.jquery.com/scroll/) 以进行交互式缩放

*   使用 .css 方法也很容易操作 CSS (http://api.jquery.com/css/)

这是一个**示例** [http://cs.scaytrase.ru/image_clip.html](http://cs.scaytrase.ru/image_clip.html)

您可以使用**.clipin**类值（*剪辑*、*顶部*和*左侧*）控制图像以设置视口和图像的*宽度*和*高度*参数以设置缩放

左侧缩略图是 4 倍缩放的右侧图片（原始 1280x1024，缩放到 500 像素放置）

通过通用**.clipout**类控制的图片大小

因此，您可以显示一张大图像，将鼠标移到它上面以在其他几张相同大小的图片中显示您需要的补丁。

# vb.net - VB.NET 文本到语音和多种语言

> ID：10337902
> 
> 赞同：0
> 
> 时间：2012-04-26T16:52:50.853
> 
> 标签：vb.net

我想在英文版 Windows 上的 vb.net 应用程序中使用 microsoft TTS 合成器（或任何可以工作的东西）在运行时切换语言。简而言之，我想做的是：

```
Dim tts As New SpeechSynthesizer
If Language.IsEnglish Then
      tts.SpeakAsync("Yes") ' English translation provided
ElseIf Language.IsFrenchCanadian Then
      tts.SpeakAsync("We") ' French translation will be provided
End If 
```

对此的任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-10T03:32:06.737

转到控制面板/语言。只需下载所需的语言包。下载后转到开始按钮和设置齿轮图标。时间和语言/地区和语言/您下载的所有语言包都在那里。单击您想要的一个，然后单击选项。在语音下，点击下载。这是win10的。

# lucene - 如何在 lucene 查询中正确转义 OR 和 AND？

> ID：10337908
> 
> 赞同：8
> 
> 时间：2012-04-26T16:53:14.647
> 
> 标签：lucene, analyzer

当我传入查询“state:OR”时，lucene 给出了一个错误，因为它认为“OR”是布尔子句的关键字，但在这里我实际上使用了俄勒冈州的缩写。

我已经看到引用 OR 因此查询变为 'state:"OR"' 使其工作。

但这听起来不是一个很好的方法，因为我必须对 lucene 使用的每个关键字进行字符串替换：AND OR NOT 和其他？我不知道有多少

我尝试直接构造查询而不是做queryParser.parse()，但似乎这并没有通过分析器，这是一个大问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T16:17:36.053

有很多方法可以避免这种情况，清洁剂是用前导反斜杠来逃避 AND、OR 和 & NOT，例如：

`\\AND \\OR \\NOT`

或者，代码解析器不会将它们的小写等效项解析为运算符

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T11:49:03.460

[Lucene 查询语法](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/queryparsersyntax.html)中只有 3 个独立的关键字——AND 、OR 和 NOT。（“TO”也被使用，但仅在范围查询内被识别。）

您的引用代码只需要识别在您的应用程序中实际用作术语的 Lucene 关键字（例如上面示例中的“OR”）可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-29T19:41:45.680

只是为了制作一份简历，在寻找这个问题的答案时，它可能会帮助其他人。

应该是正确的答案是 icyitscold 提供的评论

我们需要使用**小写**的保留字（OR、AND、NOT） （and、or、to），它不会给出任何错误并正确地进行搜索。

# html - 从 Google Drive 中检索文档列表

> ID：10337912
> 
> 赞同：2
> 
> 时间：2012-04-26T16:53:34.773
> 
> 标签：html, webpage, google-drive-api

这就是我想做的：

1.  从谷歌驱动器中检索我的个人视频列表。
2.  在网页中显示列表。
3.  [如此处所述，](https://stackoverflow.com/questions/10331837/recover-video-url-through-google-drive-api-in-order-to-stream-the-video-in-an-ht)检索单个视频 url 。
4.  获取绝对视频url后，用html5播放器播放视频。

看着[这个问题](https://stackoverflow.com/questions/10331342/access-to-all-files-on-a-users-google-drive)，我明白我不能这样做。

这是真的？？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:03:49.437

在网络应用程序中，您可以使用[Google Picker](https://developers.google.com/drive/integrate-open#open_files_using_the_google_picker)向您的用户显示一个对话框，以便他们可以从他们的 Drive 中选择一个文件。

# c++ - ofstream异常处理

> ID：10337915
> 
> 赞同：13
> 
> 时间：2012-04-26T16:53:48.717
> 
> 标签：c++, exception, exception-handling, ofstream

故意我有这个写入文件的方法，所以我试图处理我正在写入关闭文件的可能性的异常：

```
void printMe(ofstream& file)
{
        try
        {
            file << "\t"+m_Type+"\t"+m_Id";"+"\n";
        }
        catch (std::exception &e)
        {
            cout << "exception !! " << endl ;
        }
}; 
```

但显然 std::exception 不是关闭文件错误的适当异常，因为我故意尝试在已关闭的文件上使用此方法，但未生成我的“异常 !!”注释。

那么我应该写什么例外？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-26T16:58:16.270

Streams 默认不抛出异常，但你可以通过函数 call 告诉它们抛出异常`file.exceptions(~goodbit)`。

相反，检测错误的正常方法是简单地检查流的状态：

```
if (!file)
    cout << "error!! " << endl ; 
```

这样做的原因是，在许多常见情况下，无效读取只是小问题，而不是大问题：

```
while(std::cin >> input) {
    std::cout << input << '\n';
} //read until there's no more input, or an invalid input is found
// when the read fails, that's usually not an error, we simply continue 
```

相比：

```
for(;;) {
    try {
        std::cin >> input;
        std::cout << input << '\n';
    } catch(...) {
        break;
    }
} 
```

现场观看：http: [//ideone.com/uWgfwj](http://ideone.com/uWgfwj)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T16:58:39.043

**[ios_base::failure](http://www.cplusplus.com/reference/iostream/ios_base/failure/)**类型的异常，但是请注意，您应该使用**[ios::exceptions](http://www.cplusplus.com/reference/iostream/ios/exceptions/)**设置适当的标志来生成异常，否则只会设置内部状态标志来指示错误，这是流的默认行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-10-21T08:27:29.990

考虑以下：

```
void printMe(ofstream& file)
{
        file.exceptions(std::ofstream::badbit | std::ofstream::failbit);
        try
        {
            file << "\t"+m_Type+"\t"+m_Id";"+"\n";
        }
        catch (std::ofstream::failure &e) 
        {
            std::cerr << e.what() << std::endl;
        }
}; 
```

# windows-phone-7 - WP7 视图在哪里实例化？

> ID：10337926
> 
> 赞同：2
> 
> 时间：2012-04-26T16:54:39.587
> 
> 标签：windows-phone-7, windows-phone-7.1

有谁知道在 WP7 应用程序中实例化视图的位置？

它们是否由 Silverlight 导航框架实例化？SL Nav 框架是否负责实例化视图和导航？

或者视图是否在其他地方实例化并且导航框架只是获取视图实例的引用？如果是这样，我是否可以控制视图实例化并从 DI 容器实例化它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T05:18:49.897

要直接回答您的问题，我知道无法覆盖视图对象的创建。

然而，在 XAML 编程中，最好的做法是使用 ViewModel（控制器和模型的组合，并在属性上添加了更改跟踪）。ViewModel 堆栈通常像这样工作（从视图返回）：

*   查看 XAML 在根元素上包含一个 DataContext：`DataContext="{Binding PageNameViewModel, Source={Static ViewModelLocator}}"`
*   ViewModelLocator 添加到`Application.Resources`in 中`App.xaml`，并在启动期间由 App.xaml.cs 提供一个 DI 容器
*   ViewModelLocator 为每个页面的视图模型定义一个属性，每个属性都通过 DI 容器实例化 VM

有关更多信息，请搜索“MVVM Windows Phone”或查看以下项目：

*   [MVVM Lite](http://galasoft.ch/mvvm/)（可以说是 WP 最常用的 MVVM 框架，它进一步包含一个消息框架以促进更松散耦合的通信）
*   [WP7 指南](http://wp7guide.codeplex.com/)（Microsoft Patterns & Practices 示例应用程序，但通常被认为过于复杂）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T18:14:36.613

在 Windows Phone 中导航的默认方式是使用`NavigationService`. 要导航到新页面，请使用该`Navigate(Uri source)`方法。与其他平台不同，此方法仅将 Uri 作为参数。只有平台具有此方法的覆盖，该方法采用要导航到的对象。这是 Windows Phone 的限制。Uri 必须是 new 的位置`PhoneApplicationPage`。NavigationService 然后创建这个对象并导航到它，将当前页面放在它的 backstack 上。从那里您可以使用 GoBack 和 GoForward 方法在两个页面之间导航。希望这可以帮助

# clojure - 如何更好地迭代 Clojure 中的状态（monad？）

> ID：10337932
> 
> 赞同：7
> 
> 时间：2012-04-26T16:55:00.483
> 
> 标签：clojure, functional-programming, state, monads

我刚刚写了这段代码：

```
(defn parameters [transform-factory state]
  (lazy-seq (let [[r1 state] (uniform state)
                  [r2 state] (uniform state)
                  [t state] (transform-factory state)]
              (cons [t [r1 r2]] (parameters transform-factory state)))))

(defn repeated-transform [mosaic n transform-factory state]
  (reduce transform-square mosaic
    (take n (parameters transform-factory state)))) 
```

该`parameters`函数生成一个从 生成的惰性值序列，这些值`state`用于参数化某事物的重复转换（在本例中为“马赛克”）。

在我看来，这`parameters`显示了一个相当常见的模式，当你有一些`state`必须随身携带的东西时会出现（在这种情况下是为了生成随机值）。有这个名字吗？

有没有更好的方法来编写第一个函数？相关的问题往往可以用`reduce`“随身携带”的状态来解决，但在这里我没有什么可减少的。同样，`reductions`似乎不适合。这是一个单子的好例子吗？（从理论上的观点来看，我看不到您如何定义将多个实例组合为一个的方法，但这可能不会改变实际应用-它确实看起来像是单子在其他地方解决的问题，其中某些状态需要随身携带）。

（ps我提到了随机数，但由于与问题无关的原因，我不能用在幕后使用可变状态的解决方案来替换它 - 正如“正常”随机例程所做的那样）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T02:04:51.990

您当然可以查看 state monad，看看它是否适合您。

使用 monad 的一般准则是：

*   顺序执行（管道操作）
*   可重用的模块化副作用处理（例如：错误处理/日志记录/状态）
*   在纯函数中保持业务逻辑清晰

我发现（对于 Clojure）非常有用的一些关于 monad 的资源是

Adam Smyczek：Monads 简介（视频） [http://www.youtube.com/watch?v=ObR3qi4Guys](http://www.youtube.com/watch?v=ObR3qi4Guys)

和 Jim Duey：Clojure 中的 Monads [http://www.clojure.net/2012/02/02/Monads-in-Clojure/](http://www.clojure.net/2012/02/02/Monads-in-Clojure/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T20:30:05.677

[回答自己，因为这是迄今为止我找到的最佳解决方案]

*您可以将以上内容重写为函数*的折叠。所以函数变成了数据，状态是“通过”，使用的函数将每个函数依次应用到状态并累加结果。

我看不到一种优雅的方式来实现这一点——折叠的函数似乎是“新的”，你需要额外的样板来添加/分离状态和累加器——所以我将整个过程包装在一个名为`fold-over`. 源代码在[这里](https://github.com/andrewcooke/clojure-lab/blob/master/src/org/acooke/lab/state.clj#L20)，[使用的函数的例子在这里](https://github.com/andrewcooke/clojure-lab/blob/master/test/org/acooke/lab/state-test.clj#L40)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-02T22:10:13.110

你应该检查的是`->`和`->>`，线程宏。

而不是这样的代码：

```
(let [state (dosomething state)
      state (dosomethingelse state)
      state (dolastthing state)]
    state) 
```

你可以写：

```
(-> state (dosomething) (dosomethingelse) (dolasttthing)) 
```

哪个“线程”通过函数状态，最终返回它。

现在，您的代码并不完全符合我所写的内容。我想象它可以遵循的方式是，如果您的函数采用并返回哈希图。即（统一状态）可以返回`{:state state-val :r1 r1-val}`。

然后你可以像这样重写你的代码：

```
(->> {:state state} (merge uniform) (merge uniform) (transform-factory)) 
```

好看多了！:)

# scala - Akka 2.0 Remoting：如何在运行时启动/分配远程参与者

> ID：10337938
> 
> 赞同：3
> 
> 时间：2012-04-26T16:55:31.133
> 
> 标签：scala, akka

使用 akka 1.3.1，我以前能够做这样的事情：

`Actor.remote.start(config.server.host, config.server.port) Actor.remote.register("service", Actor.actorOf[ServiceHandler].start())`

这将使用提供的主机/端口配置启动远程服务器，然后允许我稍后在运行时注册远程服务。有没有办法在 Akka 2.0 中获得这种行为，而不必在 akka conf 文件中预定义所有内容？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T21:00:52.687

您的演员可以通过 2.0 中的远程处理中的路径自动访问。在此处阅读有关远程处理的文档：http: [//doc.akka.io/docs/akka/2.0.1/scala/remoting.html](http://doc.akka.io/docs/akka/2.0.1/scala/remoting.html)

# objective-c - 使用 segue 设置详细视图控制器

> ID：10337940
> 
> 赞同：2
> 
> 时间：2012-04-26T16:55:33.520
> 
> 标签：objective-c, object, memory-management, ios5

**背景：**

我有一个自定义 UIViewController 类，我在其中使用自定义注释填充 MKMapView。当用户选择注释时，会显示有关该注释的详细信息，并且还会出现一个按钮供用户选择并调出另一个 UIViewController，其中包含有关地图上该点的详细信息。

**编码：**

我通过创建具有 UserID 的类来初始化新的视图控制器（注意：`- (id) initWithUserID:(NSInteger) userID;`在 SecondViewController 的头文件中声明：

```
@interface SecondViewController ()

@property (nonatomic) NSInteger userID;

@end

@implementation RainFallDetailedViewController

@synthesize userID = _userID;

- (id) initWithUserID:(NSInteger) userID{

_userID = userID;
NSLOG(@"UserID: %i",self.userID); //correctly displays user id

return self;
}

- (void) viewWillAppear{
NSLOG(@"UserID: %i",self.userID); //userid is now 0 
```

按下按钮时创建视图控制器，然后立即执行第二个视图控制器的 segue：

```
- (void)mapView:(MKMapView *)mapView 
annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control {

if ([(UIButton*)control buttonType] == UIButtonTypeInfoLight){ //I'm looking for recognition of the correct button being pressed here.
    //SecondViewController is the second view controller with the detailed information about the map point.  
    //DataPoint is a custom class that contains the details regarding the map point.
    SecondViewController *detailedMapController = [[SecondViewController alloc] initWithUserID:((DataPoint *)view.annotation).userID]; 

    NSLOG(@"UserID: %i", ((DataPoint *)view.annotation).userID); //correctly displays userID

    [self performSegueWithIdentifier:@"PinDetail" sender:detailedMapController];

} 
} 
```

**问题：**

使用 NSLOG 我能​​够确认在创建类时该值被正确传递。但是，当我`userID`稍后在代码 (viewWillAppear) 中使用该属性时，它不再可供我使用。我假设有一个我没有处理的内存问题，但我似乎无法弄清楚。如何确保在创建时传递给类的值/对象留在那里？

*旁注：我最初尝试传递一个`PinData`对象，但遇到了同样的问题，所以我知道这不是 NSInteger 问题。我也遵循了 noa 的建议并使用`prepareForSegue`了，但是我遇到了上面提到的同样的问题*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:04:52.713

segue 负责实例化控制器。不要实例化另一个——它只会被丢弃，这就是为什么属性值似乎不固定的原因。

要设置视图控制器，`-prepareForSegue:`请在父视图控制器中覆盖：

```
- (void) prepareForSegue:(UIStoryboardSegue *) segue sender:(id) sender {
    if ([segue.identifier isEqualToString:@"PinDetail"]) {
        SecondViewController *vc = segue.destinationViewController;
        vc.userID = self.userID;
    }
} 
```

将上面的最后一段代码替换为：

```
self.userID = ((RainFallDataPoint *)view.annotation).userID;
[self performSegueWithIdentifier:@"PinDetail" sender:self]; 
```

# sql-server - 跨多个表的 SQL 唯一约束

> ID：10337944
> 
> 赞同：26
> 
> 时间：2012-04-26T16:55:42.053
> 
> 标签：sql-server, database-design, unique-constraint

我正在尝试跨多个表创建唯一约束。我发现在这里回答了类似的问题，但它们并没有完全抓住我想要做的事情的精神。

例如，我有三个表，t_Analog、t_Discrete、t_Message

```
CREATE TABLE t_Analog(
    [AppName] [nvarchar](20) NOT NULL,
    [ItemName] [nvarchar](32) NOT NULL,
    [Value] [float] NOT NULL,
    CONSTRAINT [uc_t_Analog] UNIQUE(AppName, ItemName)
)

CREATE TABLE t_Discrete(
    [AppName] [nvarchar](20) NOT NULL,
    [ItemName] [nvarchar](32) NOT NULL,
    [Value] [bit] NOT NULL,
    CONSTRAINT [uc_t_Discrete] UNIQUE(AppName, ItemName)
)

CREATE TABLE t_Message(
    [AppName] [nvarchar](20) NOT NULL,
    [ItemName] [nvarchar](32) NOT NULL,
    [Value] [nvarchar](256) NOT NULL,
    CONSTRAINT [uc_t_Message] UNIQUE(AppName, ItemName)
) 
```

我的目标是使 AppName 和 ItemName 在所有 3 个表中都是唯一的。例如，应用程序 X 中的项目名称 Y 不能同时存在于模拟表和离散表中。

请注意，此示例是人为设计的，每种类型的实际数据都不同且大到足以使组合表和添加类型列变得非常难看。

如果您对此方法有任何建议，我很想听听他们的意见！

**---- 开始编辑 2012-04-26 13:28 CST ----**

谢谢大家的答案！

似乎有可能修改此数据库的架构，这很好。

将这些表组合成一个表并不是一个真正可行的选择，因为每种类型的不匹配的列大约为 30 列（不幸的是，修改这些列不是一个选项）。这可能导致每一行中没有使用大部分列，这似乎是个坏主意。

添加第四张桌子，如 John Sikora 和其他人提到的，可能是一种选择，但我想先验证一下。

将 Schema 修改为：

```
CREATE TABLE t_AllItems(
    [id] [bigint] IDENTITY(1,1) NOT NULL,
    [itemType] [int] NOT NULL,
    [AppName] [nvarchar](20) NOT NULL,
    [ItemName] [nvarchar](32) NOT NULL,
    CONSTRAINT [pk_t_AllItems] PRIMARY KEY CLUSTERED ( [id] )
    CONSTRAINT [uc_t_AllItems] UNIQUE([id], [AppName], [ItemName])
) ON [PRIMARY]

CREATE TABLE t_Analog(
    [itemId] [bigint] NOT NULL,
    [Value] [float] NOT NULL,
    FOREIGN KEY (itemId) REFERENCES t_AllItems(id)
)

CREATE TABLE t_Discrete(
    [itemId] [bigint] NOT NULL,
    [Value] [bit] NOT NULL,
    FOREIGN KEY (itemId) REFERENCES t_AllItems(id)
)

CREATE TABLE t_Message(
    [itemId] [bigint] NOT NULL,
    [Value] [nvarchar](256) NOT NULL,
    FOREIGN KEY (itemId) REFERENCES t_AllItems(id)
) 
```

关于这种方法，我只有一个问题。这是否强制跨子表的唯一性？

例如，是否不存在具有 'id' 9 的 'Item' 表 t_Analog 的 'itemId' 为 9 和 'value' 为 9.3，同时 t_Message 的 'itemId' 为 9 和 'Value' “富”？

我可能不完全理解这种额外的表格方法，但我并不反对它。

如果我对此有误，请纠正我。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-26T17:00:00.263

专门为您希望唯一的这些值添加第 4 个表，然后使用一对多关系将此表中的这些键链接到其他表中。例如，您将拥有具有 ID、AppName 和 ItemName 的唯一表来组成其 3 列。然后将此表链接到其他表。

对于如何做到这一点，这里是一个很好的例子 [使用 SQL Server 创建一对多关系](https://stackoverflow.com/questions/1308339/create-a-one-to-many-relationship-using-sql-server)

**编辑：**这是我会做的，但考虑到您的服务器需求，您可以更改需要的内容：

```
CREATE TABLE AllItems(
    [id] [int] IDENTITY(1,1) NOT NULL,
    [itemType] [int] NOT NULL,
    [AppName] [nvarchar](20) NOT NULL,
    [ItemName] [nvarchar](32) NOT NULL,
    CONSTRAINT [pk_AllItems] PRIMARY KEY CLUSTERED ( [id] ASC )
) ON [PRIMARY]

CREATE TABLE Analog(
    [itemId] [int] NOT NULL,
    [Value] [float] NOT NULL
)

CREATE TABLE Discrete(
    [itemId] [int] NOT NULL,
    [Value] [bit] NOT NULL
)

CREATE TABLE Message(
    [itemId] [bigint] NOT NULL,
    [Value] [nvarchar](256) NOT NULL
)

ALTER TABLE [Analog] WITH CHECK 
    ADD CONSTRAINT [FK_Analog_AllItems] FOREIGN KEY([itemId])
REFERENCES [AllItems] ([id])
GO
ALTER TABLE [Analog] CHECK CONSTRAINT [FK_Analog_AllItems]
GO

ALTER TABLE [Discrete] WITH CHECK 
    ADD CONSTRAINT [FK_Discrete_AllItems] FOREIGN KEY([itemId])
REFERENCES [AllItems] ([id])
GO
ALTER TABLE [Discrete] CHECK CONSTRAINT [FK_Discrete_AllItems]
GO

ALTER TABLE [Message] WITH CHECK 
    ADD CONSTRAINT [FK_Message_AllItems] FOREIGN KEY([itemId])
REFERENCES [AllItems] ([id])
GO
ALTER TABLE [Message] CHECK CONSTRAINT [FK_Message_AllItems]
GO 
```

据我所知，您的语法很好，我只是因为我更熟悉它而将其更改为这种方式，但两者都应该工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-26T17:57:42.327

虽然您可能希望也可能不希望像其他答案所说的那样更改架构，但[索引视图](http://msdn.microsoft.com/en-us/library/dd171921.aspx)可以应用您正在谈论的约束：

```
CREATE VIEW v_Analog_Discrete_Message_UK WITH SCHEMABINDING AS
SELECT a.AppName, a.ItemName
FROM dbo.t_Analog a, dbo.t_Discrete b, dbo.t_Message c, dbo.Tally t
WHERE (a.AppName = b.AppName and a.ItemName = b.ItemName)
    OR (a.AppName = c.AppName and a.ItemName = c.ItemName)
    OR (b.AppName = c.AppName and b.ItemName = c.ItemName)
    AND t.N <= 2
GO
CREATE UNIQUE CLUSTERED INDEX IX_AppName_ItemName_UK
    ON v_Analog_Discrete_Message_UK (AppName, ItemName)
GO 
```

您将需要一个[“Tally”或数字表](http://www.sqlservercentral.com/articles/T-SQL/62867/)，或者必须以其他方式动态生成一个 Celko 风格：

```
-- Celko-style derived numbers table to 100k
select a.N + b.N * 10 + c.N * 100 + d.N * 1000 + e.N * 10000 + 1 as N
from (select 0 as N union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) a
      , (select 0 as N union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) b
      , (select 0 as N union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) c
      , (select 0 as N union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) d
      , (select 0 as N union all select 1 union all select 2 union all select 3 union all select 4 union all select 5 union all select 6 union all select 7 union all select 8 union all select 9) e
order by N 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:12:10.383

一种想法可能是将三个表结合起来：

```
CREATE TABLE t_Generic(
[AppName] [nvarchar](20) NOT NULL,
[ItemName] [nvarchar](32) NOT NULL,
[Type] [nvarchar](32) NOT NULL,
[AnalogValue] [Float] NULL,
[DiscreteValue] [bit] NULL,
[MessageValue] [nvarchar](256) NULL,
CONSTRAINT [uc_t_Generic] UNIQUE(AppName, ItemName)
) 
```

您的应用程序逻辑必须强制只填充一个值，并且您可以使用 Type 字段来跟踪该记录的类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T18:14:17.620

您还可以创建一个具有更多逻辑的约束并检查所有三个表。

[在此处](https://stackoverflow.com/a/2588427/128217)查看有关如何使用函数执行此操作的示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T17:01:19.013

这将表明规范化/数据库设计问题，特别是您应该将应用程序名称单独存储在一个表中（作为唯一/键），然后是第二列，表示它所链接的 ID，也许是第三列表示类型。

例如：

```
AppName – PrimaryKey - unique
ID – Foreign Key of either Discrete, Analog or message
Type – SMALLINT representing Discrete, analog or message. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-29T18:35:49.397

我使用而不是插入和更新触发器来解决此问题，如下所示：

```
CREATE TRIGGER tI_Analog ON t_Analog
INSTEAD OF INSERT
AS 
BEGIN
    SET NOCOUNT ON ;

    IF EXISTS (SELECT 1 FROM inserted AS I INNER JOIN t_Analog AS T
                   ON T.AppName = I.AppName AND T.ItemName = I.ItemName
               UNION ALL
               SELECT 1 FROM inserted AS I INNER JOIN t_Discrete AS T
                   ON T.AppName = I.AppName AND T.ItemName = I.ItemName
               UNION ALL
               SELECT 1 FROM inserted AS I INNER JOIN t_Message AS T
                   ON T.AppName = I.AppName AND T.ItemName = I.ItemName
              )
    BEGIN
        RAISERROR('Duplicate key', 16, 10) ;
    END
    ELSE
    BEGIN
        INSERT INTO t_Analog ( AppName, ItemName, Value )
        SELECT AppName, ItemName, Value FROM inserted ;
    END
END
GO

CREATE TRIGGER tU_Analog ON t_Analog
INSTEAD OF UPDATE
AS 
BEGIN
    SET NOCOUNT ON ;

    IF EXISTS (SELECT TOP(1) 1
                 FROM (SELECT T.AppName, T.ItemName, COUNT(*) AS numRecs
                         FROM
                            (SELECT I.AppName, I.ItemName
                               FROM inserted AS I INNER JOIN t_Analog AS T
                                 ON T.AppName = I.AppName AND T.ItemName = I.ItemName
                             UNION ALL
                             SELECT I.AppName, I.ItemName
                               FROM inserted AS I INNER JOIN t_Discrete AS T
                                 ON T.AppName = I.AppName AND T.ItemName = I.ItemName
                             UNION ALL
                             SELECT I.AppName, I.ItemName
                               FROM inserted AS I INNER JOIN t_Message AS T
                                 ON T.AppName = I.AppName AND T.ItemName = I.ItemName
                            ) AS T
                          GROUP BY T.AppName, T.ItemName
                        ) AS T
                WHERE T.numRecs > 1
              )
    BEGIN
        RAISERROR('Duplicate key', 16, 10) ;
    END
    ELSE
    BEGIN
        UPDATE T
           SET AppName = I.AppName
             , ItemName = I.ItemName
             , Value = I.Value
          FROM inserted AS I INNER JOIN t_Message AS T
            ON T.AppName = I.AppName AND T.ItemName = I.ItemName
        ;
    END
END
GO 
```

使用而不是触发器的一个警告是涉及身份字段时。此触发器阻止 INSERT INTO 命令的 OUTPUT 子句和 @@IDENTITY 变量正常工作。

# google-search - 网站未显示在 Google 搜索结果中？

> ID：10337945
> 
> 赞同：1
> 
> 时间：2012-04-26T16:55:49.367
> 
> 标签：google-search

我最近推出的一个网站没有显示在 Google 搜索结果中，尽管使用 Google 的网站管理员工具设置了该网站，并且该网站在 Bing 和 Yahoo 搜索中显示良好。

[http://andover-tc.gov.uk/](http://andover-tc.gov.uk/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:56:48.497

“*我最近推出的一个网站……* ”是这里的关键。给谷歌一些时间，它现在有更多重要的网站要抓取——它会在几周内找到你的。

在等待期间，您需要专注于宣传并让您的网站变得有用。

# .net - Yahoo YUI Compressor UTF-8 和文化支持

> ID：10337950
> 
> 赞同：1
> 
> 时间：2012-04-26T16:56:18.900
> 
> 标签：.net, utf-8, cultureinfo, yui-compressor

我正在使用 YUI JavaScriptCompressor 即时压缩 JavaScript，并且一个 JavaScript 文件包含俄语和其他语言字母，除此之外，如果我当前的线程文化设置为 hr-HR，那么它会将小数分隔符从“。”更改为 到 '，' ！？

这里是例子，克罗地亚文化

```
 Thread.CurrentThread.CurrentCulture = new CultureInfo("hr-HR");
  string js = "var dd = 0.9; var tt = 'Хорватия'";
  string compressed = JavaScriptCompressor.Compress(js); 
```

变量压缩的值为：

> var dd=0,9;var tt="????????";

更改了小数分隔符，单引号变为双引号，俄语脚本丢失。如果我将当前文化设置为 en-US，则压缩为：

> var dd=0.9;var tt="????????";

现在小数分隔符没有改变，但所有其他问题都存在，即使我将文化设置为俄语（“ru-RU”），俄语脚本仍然作为问号返回。

我完全感到困惑，所以我的问题是我在哪里可以设置编码和其他选项来改变这种行为，我看到的唯一会影响这种压缩的是 Compress 方法中的参数，但这些都没有帮助。

**更新 1**

我查看了源代码，有一种设置编码的方法，但是 YUI Compressor 仍在更改我的小数分隔符，这是代码：

```
 Thread.CurrentThread.CurrentCulture = new CultureInfo("hr-HR");
  string js = "var dd = 0.9; var tt = 'Хорватия'";
  JavaScriptCompressor jsc = new JavaScriptCompressor(js, false, Encoding.UTF8, CultureInfo.InvariantCulture);
  string compressed = jsc.Compress(); 
```

结果是：

> var dd=0,9;var tt="Хорватия";

将第 4 个参数中的文化更改为“en-US”也无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:44:50.900

我使用的 1.7.0.0 版本似乎存在一个错误，当我升级到 1.7.1.0 时，此代码按预期工作：

```
 Thread.CurrentThread.CurrentCulture = new CultureInfo("hr-HR");
  string js = "var dd = 0.9; var tt = 'Хорватия'";
  JavaScriptCompressor jsc = new JavaScriptCompressor(js, false, Encoding.UTF8, CultureInfo.InvariantCulture);
  string compressed = jsc.Compress(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-28T07:23:50.970

当您运行`js`使用标志的压缩时： `--nomunge`

# java - Amazon Ec2 FTP 写入权限

> ID：10337951
> 
> 赞同：19
> 
> 时间：2012-04-26T16:56:23.723
> 
> 标签：java, linux, tomcat, amazon-ec2, amazon-web-services

我能够使用 filezilla 成功连接到亚马逊 ec2 实例。我使用的用户名是 ec2-user。因此，当我尝试将我的应用程序战争转移到 tomcat 时，它说

```
/var/lib/tomcat6/webapps/RealEstateERP.war: open for write: permission denied
 Error: File transfer failed. 
```

我试图更改使用 filezilla 的权限，但不允许这样做。我知道没有写权限，但是我该如何更改它。

我是 linux 新手。请帮我。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-27T10:02:05.020

**ec2 用户**无权在 /var/lib/tomcat6/webapps/ 中写入文件。只有**root**用户可以这样做。您有两种方法可以这样做：

1) 使用 filezilla 将文件复制到 /home/ec2-user/。现在通过 putty SSH 进入 linux 机器。使用命令更改为 root 用户`sudo -s`。然后使用 command 将文件从 /home/ec2-user 复制到 /var/lib/tomcat6/webapps/ `cp -i RealEstateERP.war /var/lib/tomcat6/webapps/`。

2）通过putty SSH进入linux机器。使用命令更改为root用户。使用命令`sudo -s`为/var/lib/tomcat6/webapps/上的所有用户提供写权限`chmod 777 /var/lib/tomcat6/webapps/`。然后直接从filezilla复制文件到目录。

# interpreter - Cg 中使用的动态编译和某些脚本中使用的解释器有什么区别？

> ID：10337957
> 
> 赞同：0
> 
> 时间：2012-04-26T16:56:44.920
> 
> 标签：interpreter, cg, dynamic-compilation

在 Cg 教程中，它说 Cg 使用动态编译。我注意到它的编译器与解释器有一些相似之处，因为它们不需要在第一遍编译所有代码，如果存在错误，您会在运行 exe 时找到它。

但是，它们之间有什么区别。谁能给我一些细节？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:41:52.177

在这种情况下，Cg 代码是在运行时编译的。这类似于编译成中间形式（例如 p 代码等）的解释器。在 GPU 上执行此操作的主要原因是，编译结果可能会因运行时计算机的配置而略有不同。Cg （通常）编译为 OpenGL 汇编器（例如，'fp40' 或 'arbfp' 用于片段程序）。

确实，这个编译的汇编代码被 GPU 驱动程序进一步编译成微码，但这个过程对程序员是完全隐藏的（除非他们在 NVIDIA 等公司工作）。

# java - 通过 OSGI 运行时无法从已安装的扩展中实例化类

> ID：10337959
> 
> 赞同：2
> 
> 时间：2012-04-26T16:56:52.840
> 
> 标签：java, osgi, classloader, noclassdeffounderror

所以，我有一个安装的扩展（见[http://docs.oracle.com/javase/tutorial/ext/basics/index.html](http://docs.oracle.com/javase/tutorial/ext/basics/index.html)），我可以在 Eclipse 中看到。

我编写了一个简单的 rcp 应用程序，它试图在这个扩展中创建一个类的实例。但是，尽管一切都可以编译，但在创建实例时我得到了 NoClassDefFoundError 。

我假设这与 OSGi 有关，因为我可以运行一个简单的 java 应用程序来创建实例。

任何建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T11:01:08.543

我找到了另一种解决方案，即使用 arg 将父类加载器设置为“ext”类加载器

```
osgi.parentClassloader=ext 
```

除了我现在没有得到错误之外，还不确定这种更改的含义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T17:27:51.610

由于您的扩展类是由 JRE 提供的，因此它们需要由 OSGi 框架的系统包导出。

这可以通过将包添加到`org.osgi.framework.system.packages.extra`属性来实现（您可以将其设置为系统属性并将其传递到框架中）。

完成此操作并且您的消费包具有在其 MANIFEST.MF 的 Import-Package 条目中列出的那些包，您应该能够访问这些类。

JRE 扩展几乎是 OSGi 的对立面——我很想知道你为什么要这样做？

# c# - 将 SQL Server 查询转换为具有 ROW_NUMBER() 和 OVER 的 C# LINQ

> ID：10337961
> 
> 赞同：0
> 
> 时间：2012-04-26T16:56:58.137
> 
> 标签：c#, sql, sql-server, linq, row-number

我需要将此查询转换为 C# LINQ，但我不知道如何开始。感谢您的时间。

```
SELECT s.TextId, s.Title, s.CategoryId, s.Name, s.DateSent, Row
FROM 
   (SELECT t.TextId, t.Title, t.CategoryId, c.Name, t.DateSent, 
        ROW_NUMBER() OVER (PARTITION BY t.CategoryId ORDER BY t.datesent DESC) AS Row
    FROM Concept_Text t 
    JOIN Concept_Text_Categories c 
      ON t.CategoryId = c.CategoryId 
    JOIN Concept_Text_CategoryToPlugin cp 
      ON c.CategoryId = cp.CategoryId 
    JOIN Concept_Text_Plugins p 
      ON cp.PluginId = p.PluginId
    WHERE p.type = 12 AND (t.IsPublished = 'True') AND (Visible = 'True')
    GROUP BY t.TextId, t.Title, t.CategoryId, c.Name, t.DateSent) s
WHERE Row <=12 
```

在帮助下，到目前为止，我得到了这个

```
(from t in Concept_Text
   join c in Concept_Text_Categories on t.CategoryId equals c.CategoryId
   join cp in Concept_Text_CategoryToPlugin on c.CategoryId equals cp.CategoryID
   join p in Concept_Text_Plugins on cp.PluginID equals p.PluginID
   where p.Type == 12 && t.IsPublished && t.Visible
   group cp by new { t.TextId, t.Title, t.CategoryId, c.Name, t.DateSent } into gr
   orderby gr.Key.DateSent descending
   select new
   {
       gr.Key.TextId,
       gr.Key.Title,
       gr.Key.CategoryId,
       gr.Key.Name,
       gr.Key.DateSent
   }) 
```

现在唯一的问题是我们需要获得每个类别的 12 个条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:28:58.270

我认为是这样的：

```
var query = 
(
   from t in Concept_Texts
   join c in Concept_Text_Categories on t.CategoryId equals c.CategoryId
   join cp in Concept_Text_CategoryToPlugin on c.CategoryId equals cp.CategoryId
   join p in Concept_Text_Plugins on cp.CategoryId equals p.CategoryId

   where p.type = 12 && t.IsPublished == "True" AND t.Visible == "True"
   group cp by new {t.TextId, t.Title, t.CategoryId, c.Name, t.DateSent} into gr
   select new {
              gr.Key.TextId, 
              gr.Key.Title, 
              gr.Key.CategoryId, 
              gr.Key.Name, 
              gr.Key.DateSent,
              MinC = gr.Min(gcp=>gcp.CategoryId },
              MaxC = gr.Max(gcp=>gcp.CategoryId }
).Where(c=>c.CategoryId >= c.MinC && c.CategoryId <= c.MaxC)
 .OrderByDescending(c=>c.DateSent)
 .Skip(0).Take(12); 
```

你能用 LINQ Pad 测试一下吗？看看 SQL 产生了什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T12:57:41.687

```
(from c in Concept_Text_Categories
                            join cp in Concept_Text_CategoryToPlugin
                            on c.CategoryId equals CategoryID
                            join p in Concept_Text_Plugins
                            on PluginID equals p.PluginID
                            where p.Type == 12
                            && c.Enabled
                            && p.Enabled
                            orderby c.Name ascending
                            select new ()
                            {
                                CategoryId = c.CategoryId,
                                Name = c.Name,
                                Materias = (from t in Concept_Text
                                        where t.CategoryId == c.CategoryId
                                        && t.IsPublished
                                        && t.Visible
                                        orderby t.DateSent
                                        select new ()
                                        {
                                            TextId = t.TextId,
                                            Title = t.Title
                                        }).Take(12)
                            }) 
```

# android - 有意切换到 tabhost 中的另一个选项卡

> ID：10337963
> 
> 赞同：0
> 
> 时间：2012-04-26T16:57:06.527
> 
> 标签：android

我在选项卡主机中有 3 个选项卡，我想通过单击按钮切换到另一个选项卡。

```
TabSpec Tab1 = tabhost.newTabSpec("Tab1");
    jadwalUser.setIndicator("Tab1", getResources().getDrawable(R.drawable.style1));
    Intent in1 = new Intent(this, Tab1.class);
    Tab1.setContent(in1);

    TabSpec Tab2 = tabhost.newTabSpec("Tab2");
    Tab2.setIndicator("Tab2", getResources().getDrawable(R.drawable.style2));
    Intent in2 = new Intent(this, Tab2.class);
    Tab2.setContent(in2);

    TabSpec Tab3 = tabhost.newTabSpec("Tab3");
    Tab3.setIndicator("Tab3", getResources().getDrawable(R.drawable.style3));
    Intent in3 = new Intent(this, Tab3.class);
    Tab3.setContent(in3);

    tabhost.addTab(Tab1);
    tabhost.addTab(Tab2);
    tabhost.addTab(Tab3); 
```

我目前在 Tab1 中，当单击此按钮时，我想切换到 Tab2 ：

```
button1.setOnClickListener(new OnClickListener() {

public void onClick(View v) {
//What code here to switch to Tab2

}
} 
```

请帮帮我，谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:33:03.383

打电话有什么问题

TabHost 类的 setCurrentTab

如果你想通过意图来做到这一点，一种方法可能是

```
 Make your TabHost Activity single instance.

 override its onNewIntent delegate

 pass the id of the tab to open in the data of intent

 in onNewIntent call setCurrentTab method 
```

您还可以定义广播侦听器并发送广播以在选项卡之间切换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-29T08:36:27.510

只是您需要重新加载您的活动并设置`setCurrentItem(position)`为您最喜欢的标签索引。（索引从零开始）

# linq - Linq to sql查询多重继承

> ID：10337964
> 
> 赞同：0
> 
> 时间：2012-04-26T16:57:11.417
> 
> 标签：linq, linq-to-sql

这是数据库架构：![数据库架构](../Images/bf1bf01c2461115334f5f972e8851de8.png)

我有这个问题，我尝试只从也属于 GroupB 的 Group 表中获取数据，所以我`!g.IdGroup.Equals(a.IdGroup)`用于排除 GroupA 数据。我检查了 GroupA 和 GroupB ID 是否在 Group 表中，但我仍然从两个表中获取数据。我该如何解决这个问题？对不起我糟糕的英语，以及我糟糕的 sql/linq 知识。

```
var result = from a in db.GroupA
             from r in db.Registration
             join g in db.Group on r.IdGroup equals g.IdGroup
             where !g.IdGroup.Equals(a.IdGroup)
             select new {
                 g.Name
             }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:33:32.880

我认为您要查找的内容相当于 SQL 中的 NOT IN，也就是说，查询看起来像这样：

```
SELECT
    g.name
FROM
    Group g
WHERE
    g.IdGroup NOT IN (SELECT IDGroup FROM GroupA); 
```

这看起来像你想要的吗？

在这种情况下，等效的 LINQ 可以这样实现：

```
var result = from g in db.Group
             where !(from a in GroupA select a.IdGroup).Contains(g.IdGroup)
             select new {
                 g.Name
             }; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T17:10:53.010

通过查看 LINQ，不应该是这样吗？

```
var result = from a in db.GroupA
             join r in db.Registration on a.IdGroup equals r.IdGroup             
             join g in db.Group on r.IdGroup equals g.IdGroup
             where !g.IdGroup.Equals(a.IdGroup)
             select new {
                 g.Name
             }; 
```

# functional-programming - 如何将函数应用于变体？

> ID：10337965
> 
> 赞同：5
> 
> 时间：2012-04-26T16:57:23.633
> 
> 标签：functional-programming, ocaml

让这个类型=

```
type intC = int;;
type boolC = bool;
type stringC = string;;

type component = A of intC | B of boolC | C of stringC;; 
```

如果我想在组件 A 的类型 a 上应用函数，我是否需要系统地解构组件？

例如，我必须这样做：

```
let add comp =
  match comp with 
   | A i -> Some (i + 2) (*only A interests me, I return i + 2*)
   | _ -> None           (*otherwise I return nothing*) 
```

然后对于组件 A 上的任何功能？有什么办法可以避免你的冗余？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T18:53:25.733

这实际上取决于您将对您的类型执行哪种操作。

@nlucaroni 给出的解决方案非常好，但是如果你想做一些更通用（和复杂）的事情，你可以使用记录来保存你的部分映射函数：

```
type 'a component_m = {
  a : intC  -> 'a;
  b : boolC -> 'a;
  c : stringC -> 'a;
}

let map_component m = function
  | A a -> m.a a
  | B b -> m.b b
  | C c -> m.c c

let add = map_component {
  a = (fun x -> Some (x + 2)); 
  b = (fun _ -> None);
  c = (fun _ -> None);
} 
```

如果您不想`(fun _ -> None)`每次都编写函数，还可以使用扩展的默认值：

```
let none = {
  a = (fun _ -> None);
  b = (fun _ -> None);
  c = (fun _ -> None);
}

let add = map_component { none with a = fun x -> Some (x+2) } 
```

你可以用仿函数做同样的事情，但在我看来，这变得有点矫枉过正了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T17:46:50.333

您可以将高阶函数传递给为您进行组件销毁的函数，

```
let apply_if_a f = function
   | A i          -> Some (f i)
   | (B _ | C _)  -> None 
```

这个类型是，

```
val apply_if_a : (int -> 'a) -> component -> 'a option 
```

如您所见，任何函数的多态都应用于`A`. 此外，大多数人都远离包罗万象的 ，`_`，而是详尽无遗。

# c++ - c++ Build Error - 'this!= rhs'中的'operator!='不匹配|

> ID：10337967
> 
> 赞同：-1
> 
> 时间：2012-04-26T16:57:33.397
> 
> 标签：c++

不确定我将如何解释上述内容。

**'this != rhs' 中的 'operator!=' 不匹配| 错误| 从“Collection* {aka Collection*}”类型的右值初始化“Collection&”类型的非常量引用无效|**

我有两种方法，一种调用另一种方法。但是，当我按原样运行代码时，我会收到上面的错误消息。

```
Collection&  Collection::operator=(const Collection&& rhs)
        {
                   if (this!= rhs)// <--- Error |no match for 'operator!=' in 'this != rhs'
                    {
                        return copy(rhs);//<---Error| invalid initialization of non-const reference of type 'Collection&' from an rvalue of type 'Collection* {aka Collection*}'
                    }
                    return *this;
         }

Collection& Collection::copy(const Collection& coll)
{

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T17:00:36.377

假设你已经定义`operator!=`了，你会想说`if (*this != rhs)`。`this`如果要检查它们的值是否相等，则需要取消引用指针。否则，如果您要查看它们是否是完全相同的对象（可能在这种情况下），那么您需要获取`rhs`with的地址`this != &rhs`。此解决方案不需要任何运算符重载，因为您只是比较两个指针，任何类型的指针都已支持该指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T17:06:49.903

自赋值检查不再被视为惯用的 C++。它通常不如复制和交换。惯用的赋值运算符是这样的：

```
Collection& Collection::operator=(Collection rhs) {
    swap(rhs);
    return *this;
} 
```

这假设您已经定义了复制和移动构造函数和一个`swap`函数。此外，启用移动语义的类应该采用非常量右值引用。右值引用的全部目的是改变右值——`const`右值是毫无价值的。这是一个简单的示例，我使用堆分配`int`的资源作为示例资源。

```
class Collection {
    int* ptr; // example resource
public:
    Collection(const Collection& c) {
        ptr = new int(*c.ptr); // copy
    }
    Collection(Collection&& c) {
        ptr = c.ptr; // move
        c.ptr = nullptr;
    }
    void swap(Collection& rhs) {
        std::swap(ptr, rhs.ptr); // swap
    }
    Collection& operator=(Collection rhs) {
        swap(rhs);
        return *this;
    }
    ~Collection() {
        delete ptr; // rule of three, bitch
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:00:53.523

`this`是`Collection*`,`rhs`是`const Collection&&`. 你不能`!=`在他们之间。您应该转换`rhs`为`const Collection*`via `&rhs`。

```
if (this!= &rhs) 
```

更好的是，编写一个赋值运算符，如果你尝试自赋值也没关系。

# database - 我如何有效地检查 RavenDB 中的文档是否存在

> ID：10337970
> 
> 赞同：3
> 
> 时间：2012-04-26T16:57:46.887
> 
> 标签：database, database-design, nosql, data-modeling, ravendb

我有一个域实体联系人，联系人通过 MemberOf 属性与列表相关联（包含 RavenDB 中的列表 ID）

```
public class Contact
{
    public string Id { get; set; }
    public string Email { get; set; }
    public string Name { get; set; }
    public string Country { get; set; }
    public List<string> MemberOf { get; set; }
} 
```

我想使用**RavenDB**来存储联系人，上传联系人的方法之一是通过 CSV 文件（批量）。我在想当两个 CSV 文件具有相同的联系人时如何防止重复数据，我认为当联系人具有相同的电子邮件时是相同的 - 这与我的域逻辑有关。一个联系人可以是两个不同 CSV 列表的成员，例如
我正在上传两个具有相同电子邮件地址字段的 CSV 列表，问题是我希望联系人类将 MemeberOf 设置为有两个列表，这样可以防止我重复每个列表的条目，因为我的应用程序的域逻辑要求每封电子邮件使用一个联系人对象进行统计分析。

请也挑战我的设计，我可能没有最好的数据模型。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T20:00:22.873

RavenDB 为您强制执行的唯一唯一约束是文档 ID。因此，您可以使用的一种方法是将电子邮件地址设为文档 ID。然后，您可以编写如下代码：

```
using (var session = docStore.OpenSession())
{
    foreach (var csvItemToImport in csvfile)
    {
        var existingDoc = session.Load<Contact>(csvItemToImport.Email);    
        if (existingDoc == null)
        {
            //No doc with the given email exists, add a new one
            session.Store(new Contact{ ... });
        }
        else
        {
            existingDoc.MemberOf.Add(csvItemToImport.ListName)
            // No need to store the doc, it's tracked in the session automatically
        }     
    }
    //Save the changes so far back to the dBase, in a single batched transaction
    session.SaveChanges();
} 
```

因为 doc Id 是 url ( `/docs/contacts/blah@blah.co.uk`)，您可能需要进行一些转义以说明电子邮件地址中的“@”。

您的 POCO 将如下所示：

```
public class Contact
{
    public string Id { get; set; } //this is actually an email address 
    public string Name { get; set; }
    public string Country { get; set; }
    public List<string> MemberOf { get; set; }
} 
```

**如果您不希望文档 ID 成为电子邮件地址（无论出于何种原因），请**更新。**您可以使用[此处列出](http://richarddingwall.name/2012/03/06/quick-and-dirty-unique-constraints-in-raven-db/)的方法。它每次只存储 2 个文档，一个`Contact`文档和另一个确保唯一约束的文档。**

# c# - C# 中的球衣客户端

> ID：10337972
> 
> 赞同：0
> 
> 时间：2012-04-26T16:57:55.093
> 
> 标签：c#, xml, web-services, client, jersey

我有一个 Jersey 网络服务，它的客户端在 C# 中。按照片段。

```
var request =(HttpWebRequest)WebRequest.Create(uri);
        request.Method = "POST";
        request.ContentType = "application/xml";
        Stream stream = request.GetRequestStream();
        byte[] b = memstreamxml.ToArray();
        stream.Write(b, 0, b.Length);
        stream.Close();
        var response = (HttpWebResponse)request.GetResponse(); 
```

通过这个使用 xml 字节发布的请求，我得到 400 或 415 错误响应。我试图@Consumes 各种媒体类型，目前没有工作。有人可以告诉我如何将 xml 请求从 C# 发送到 jersey web 服务吗？我还使用@XmlRootElement 和我的pojo 来处理输入xml。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T03:59:01.730

当请求 contentType 为“application/x-www-form-urlencoded”并且 jersey webservice @Consumes APPLICATION_FORM_URLENCODED 时，我得到了它。事实上，contentType 没有问题，而是无法按照 webresource 的预期将 xml 输入到 POJO 对象中。因此，只要我将服务的参数类型修改为字符串，它就会开始工作。当然，除非有其他方法，否则您需要解析字符串 xml 来构建对象。

# mysql - 带有子查询的 MySQL IF..ELSE

> ID：10337973
> 
> 赞同：0
> 
> 时间：2012-04-26T16:58:06.487
> 
> 标签：mysql, sql, syntax-error

我有一个查询

```
SELECT IF((select COUNT(*) from produkty where name='ASROCK 760GM-GS3' and id_nokaut='7507601876693181035' and found ='0')=0, (insert into produkty (
         id_nokaut,
         name,
         shop_count,
         offer_count,
         price_min,
         price_max,
         price_avg,
         url,
         opis,
         socket,
         typ_pamieci,
         co,
         image_mini,
         image_medium,
         image_large,
         rate,
         thumbnail,
         image,
         found)
         values(
         '7507601876693181035',
         'ASROCK 760GM-GS3',
         '4',
         '4',
         '171,31',
         '195,00',
         '179,88',
         'http://www.nokaut.pl/plyty-glowne/asrock-760gm-gs3.html',
         'ASRock 760GM-GS3... ',
         'false',
         'false',
         'plyta',
         'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc90x90/asrock-760gm-gs3.jpg',
         'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc130x130/asrock-760gm-gs3.jpg',
         'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc500x500/asrock-760gm-gs3.jpg',
         '0.00',
         'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc90x90/asrock-760gm-gs3.jpg',
         'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc130x130/asrock-760gm-gs3.jpg',
         '1')), (update produkty set  id_nokaut = '7507601876693181035', shop_count = '4', offer_count = '4', price_min = '171,31', price_max = '195,00', price_avg = '179,88', url = 'http://www.nokaut.pl/plyty-glowne/asrock-760gm-gs3.html', opis = 'ASRock 760GM-GS3... ',  socket = 'false', typ_pamieci = 'false', co = 'plyta', image_mini = 'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc90x90/asrock-760gm-gs3.jpg', image_medium = 'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc130x130/asrock-760gm-gs3.jpg', image_large = 'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc500x500/asrock-760gm-gs3.jpg', rate = '0.00', thumbnail = 'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc90x90/asrock-760gm-gs3.jpg', image = 'http://nokautimg1.pl/p-da-99-da99e9e7b3eaebef049d1234fc5c15dc130x130/asrock-760gm-gs3.jpg', found = '1' where  name = 'ASROCK 760GM-GS3')); 
```

我正在尝试在 MySQL 中执行它，但它给出了 mi 错误：

> 第 4 行的 ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 1 行的“into produkty (id_nokaut, name, shop_cou') 中使用

我不知道出了什么问题，有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:02:58.613

```
INSERT
INTO    produkty (id_nokaut, name, ...)
VALUES  ('7507601876693181035', 'ASROCK 760GM-GS3', ...)
ON DUPLICATE KEY
UPDATE
        shop_count = VALUES(shop_count),
        offer_count = VALUES(offer_count),
        ... 
```

# c#-4.0 - 如何使用 Log4Net 在单个自定义 Log.Info 字段中输出大量项目（256 个项目）？

> ID：10337974
> 
> 赞同：0
> 
> 时间：2012-04-26T16:58:13.803
> 
> 标签：c#-4.0, log4net

我正在使用 Log4Net 并创建了一个自定义类，用于在 Windows 服务循环中格式化和输出到 CSV 文件：

```
private void AutoLogger(uint id, EdkDll.EE_DataChannel_t channel, double[] value)
        {

            try
            {
                log.Info(new Log
                {
                    ElapsedTime = timer.Elapsed.Minutes.ToString(),
                    UserId = id,
                    Action = channel.ToString(),
                    Value = value.ToString()
                });
            } 
```

问题是“值”对于循环的每次迭代都有 256 个值。我想在`log.Info(new Log`循环值的代码中创建一个循环。就像是：

```
log.Info(new Log
                {
                    ElapsedTime = timer.Elapsed.Minutes.ToString(),
                    UserId = id,
                    Channel = channel.ToString(),
                    for(int i = 0; i < value.Count; i++)
                    {  
                      "Value_" + i = value[i].ToString()
                    }
                }); 
```

但这是不可能的。知道怎么做吗？我的`Log`课看起来像这样：

```
public class Log
    {
        public DateTime DateAndTime { get; set; }
        public string ElapsedTime { get; set; }
        public string Level { get; set; }
        public uint UserId { get; set; }
        public string Action { get; set; }
        public string Value { get; set; }
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:48:56.253

你能不能把它循环成一个带分隔符的字符串（甚至可能是\n），然后是log.Info（newString）；？如果你想做很多，只需创建一个扩展方法......

EX：（注意：这不是经过测试的代码，我只是在这里输入的）

```
 string strBuffer ="";
    List<Dingus> dingusList = GetDingusList();
    foreach( Dingus dingus in dingusList )
    {
        \\if you have a ToString defined use it here, else just output all the properties of your object
        strBuffer+= dingus.name+" ,"+dingus.value+"\n";
    }
    log.Info(strBuffer); 
```

另一种方法在这里做的例子：

[http://www.l4ndash.com/Log4NetMailArchive%2Ftabid%2F70%2Fforumid%2F1%2Fpostid%2F15171%2Fview%2Ftopic%2FDefault.aspx](http://www.l4ndash.com/Log4NetMailArchive/tabid/70/forumid/1/postid/15171/view/topic/Default.aspx)

# linux - 使用各种快照技术时如何测试 MongoDB 的相对性能

> ID：10337979
> 
> 赞同：0
> 
> 时间：2012-04-26T16:58:43.900
> 
> 标签：linux, mongodb, snapshot

我想设置一个实验来评估 Mongo 如何使用各种支持快照的技术来执行。

*   ext3 上的 R1Soft HotCopy
*   xfs 上的 R1Soft HotCopy
*   带 ext3 的 LVM
*   带 xfs 的 LVM
*   btrfs

它需要受磁盘 IO 限制，因此我需要确保我的所有写入本质上都是同步的 - 否则我将需要创建一个违反 RAM 和交换约束的数据集，但我相信在每次插入时启用文件系统刷新将确保每个操作在下一个操作之前被刷新。

```
> db.runCommand({getlasterror:1,j:true}) 
```

我还能做些什么来真正锻炼 MongoDB 进程的 IO 特性？

*   我可以交错读取和写入。

我将测试诸如*恒定插入率*之类的东西，并观察该过程在以下期间的表现

1.  没有与快照相关的活动或存在。
2.  拍摄和提交快照时。
3.  当备份脚本正在读取快照时。
4.  当快照是冗余但处于活动状态时。
5.  当快照被停用时。

我希望确保在活动和硬件保持不变的同时，遇到相对的性能基准。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:55:46.923

罗布，这太棒了。这样做的结果应该使每个人都受益。

我想指出一些在您测试 MongoDB 生产部署的典型快照操作期间可能会有所帮助的事情。

**拍摄快照**

正如您所指出的，在实时服务器上拍摄快照的主要问题是 IO 争用。为了避免这种情况，大多数人会部署一个包含 3 个以上成员的副本集。

通常，在这种情况下，其中一个辅助节点要么是 fsync 并在快照期间被锁定，要么配置为隐藏成员，要么只是脱机。这允许在热备份（另一个辅助节点）仍可用于自动故障转移时拍摄快照。

这也确保了另外两件事。首先，可以及时完成快照（生产负载不影响备份时间），其次，拍摄快照所需的负载不会影响生产读取（在允许从辅助节点读取的情况下——slaveOk） .

**备份机制**

以上关于快照策略的观点很重要，因为大多数人忽略了辅助节点与主节点具有相同写入负载的事实。

MongoDB 没有多主复制。在给定时间，只有一个服务器（在集合/分片中）可用于写入（主服务器或主服务器）。

但是，当主节点接收写入和读取时，辅助节点会跟踪该主节点的 oplog（一个上限集合）。辅助节点发出定期请求，以查看是否有更多数据等待从此可尾游标读取。当存在时，这些 oplog 条目将从主节点读取并写入（是的——这需要一个写锁）到辅助节点。

然后辅助节点将 oplog 中的新条目应用到它们自己的数据副本（是的——这需要写锁）。

您可能知道这一切，但在进行这项很棒的研究时请记住这一点。

祝你好运！

# tfs - 服务器管理员但无法进入 Team Foundation Server

> ID：10337981
> 
> 赞同：1
> 
> 时间：2012-04-26T16:58:50.863
> 
> 标签：tfs, windows-server-2008

我正在尝试帮助服务器管理员授予我作为开发人员访问 TFS 项目的权限，但我们在进行过程中会收到错误消息。

我已成为 TFS 所在服务器的本地管理员，但是当我尝试进入 TFS 控制台以授予自己作为开发人员的权限时，我得到了包含的错误显示，如下所示：

![在此处输入图像描述](../Images/f426a80e19f48a0a42ce1537d5bebd02.png)

如何给自己适当的权限来管理 TFS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T10:49:26.307

您应该在这里检查两件事：

1.  确保您以管理员身份运行控制台。
2.  确保您有权直接与 SQL 对话。这通常通过 SQL Server Management Studio 中的安全文件夹设置。您将需要对 Tfs_Configuration 数据库和所有集合数据库的读/写权限。

鉴于显示的错误消息，2 可能是您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T18:43:43.770

您必须确保 SQL 服务（来自 SQL 配置管理器）都在该`NETWORK SERVICE`帐户下运行。

看起来情况并非如此。如果这意味着您用于运行 TFS 管理控制台的帐户不是 TFS 服务器的管理员。

如果您遵循设置过程，您应该拥有：

1.  使用给定帐户（通常是 TFSSETUP）、域成员和计算机管理员组成员安装的所有内容。
2.  SQL 服务的网络服务帐户。
3.  IIS Web 应用程序池和 TFS 服务帐户可以使用 NETWORK SERVICE 或域服务帐户（通常名为 TFSSERVICE）运行。

你知道安装 TFS 使用了什么样的配置吗？标准，定制？

# c++ - 从 SFML 中的tileset 加载一个tile

> ID：10337982
> 
> 赞同：1
> 
> 时间：2012-04-26T16:58:57.237
> 
> 标签：c++, sfml, tile

所以我得到了这样的[tileset：Tileset](http://i43.tinypic.com/qsuzq8.png)

如何在 SFML 中只加载一个图块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T20:48:01.610

将图像加载到纹理中（`sf::Image`如果使用 SFML 1.6，或者`sf::Texture`如果使用 SFML 2.0），然后为精灵设置子矩形。像这样的东西（使用 SFML 2.0）：

```
sf::Texture texture;
texture.loadFromFile("someTexture.png"); // just load the image into a texture

sf::IntRect subRect;
subRect.left = 100; // of course, you'll have to fill it in with the right values...
subRect.top = 175;
subRect.width = 80;
subrect.height = 90;

sf::Sprite sprite(texture, subRect);

// If you ever need to change the sub-rect, use this:
sprite.setTextureRect(someOtherSubRect); 
```

对于 SFML 1.6，它更像这样：

```
sf::Image image;
image.LoadFromFile("someTexture.png"); // just load the image into a texture

sf::IntRect subRect;
subRect.Left = 100; // of course, you'll have to fill it in with the right values...
subRect.Top = 175;
subRect.Right = 180;
subrect.Bottom = 265;

sf::Sprite sprite(image);
sprite.SetSubRect(subRect); 
```

请注意，您可能希望禁用图像/纹理的平滑，具体取决于您使用精灵的方式。如果您不禁用平滑，边缘可能会流血（如`texture.setSmooth(false)`或`image.SetSmooth(false)`）。

# php - 使用 cURL 输出

> ID：10337984
> 
> 赞同：6
> 
> 时间：2012-04-26T16:59:05.343
> 
> 标签：php, curl, twitter-streaming-api

我计划录制有关特定主题的实时推文。同样，我在 PHP 中使用带有 cURL 的 twitter 流 API。

这是代码：

```
<?php

$username = "xxxxx";
$password = "xxxxx";

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, 'https://stream.twitter.com/1/statuses/filter.json?         track=SEARCH_PARAMETER');
curl_setopt($ch, CURLOPT_USERPWD, $username.":".$password);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
$result = curl_exec($ch);
$jsonOBJ = json_decode ($result);

curl_close($ch);

print_r($jsonOBJ);
?> 
```

我的问题是，如果我将 CURLOPT_RETURNTRANSFER 设置为 0，我可以在终端上看到推文。但我无法存储在变量 $jsonOBJ 中并打印它。

请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T00:26:09.510

**更新**：请参阅消息末尾的新代码，这实际上用 cURL 很容易做到，但我第一次做错了。

我无法让 Twitter 流 API 使用 cURL 和 a 一起工作，`CURLOPT_READFUNCTION`但使用[fsockopen()](http://php.net/fsockopen)和`fread()`. 我不确定为什么 readfunction 没有像我之前成功使用它那样工作，但它一定与响应数据是“流式传输”并且不是使用 HTTP 分块编码发送的事实有关。本质上，我的读取函数从未被调用，因此我无法处理数据。

我使用的方法现在有效：

*   使用 fsockopen 连接到`ssl://stream.twitter.com`
*   使用流数据发出基本 HTTP 请求`fputs`
*   使用 HTTP 响应标头并确保没有错误
*   `fread`使用无限循环读取数量数据
*   每次读取一大块数据时，我都会调用一个内部缓冲区函数
*   缓冲区函数将新数据附加到缓冲区
*   缓冲区函数然后尝试处理缓冲区中的所有消息（如果我们有 1 条或更多完整消息）
*   在处理每条消息时，缓冲区会减少，直到它为空，然后函数返回并再次读取数据

我已经让它运行了几个小时，并且没有断开连接，并且我已经处理了超过 30,000 条消息，还没有出现任何错误。

基本上我实现了一个回调系统，这样每次从缓冲区中读取完整的消息时，它都会使用 json 消息调用用户定义的回调，这样应用程序就可以对消息执行任何它需要做的事情（例如插入到数据库）。

我还没有任何简短的片段可以在这里发布，但是如果你愿意，可以通过访问我的个人资料中列出的网站并填写联系表格给我发消息，我很乐意分享。如果有人有兴趣，也许我们可以一起工作。我这样做只是为了好玩，我对 Twitter 没有兴趣，也没有出于经济原因使用它。也许我最终会把它放在 GitHub 上。

*编辑：*

这是一些 cURL 代码，它们将连接到流 API 并将 JSON 消息传递给回调函数，因为它们可用。此示例使用 gzip 编码来节省带宽。

```
<?php

$USERNAME = 'youruser';
$PASSWORD = 'yourpass';
$QUERY    = 'nike';

/**
 * Called every time a chunk of data is read, this will be a json encoded message
 * 
 * @param resource $handle The curl handle
 * @param string   $data   The data chunk (json message)
 */
function writeCallback($handle, $data)
{
    /*
    echo "-----------------------------------------------------------\n";
    echo $data;
    echo "-----------------------------------------------------------\n";
    */

    $json = json_decode($data);
    if (isset($json->user) && isset($json->text)) {
        echo "@{$json->user->screen_name}: {$json->text}\n\n";
    }

    return strlen($data);
}

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, 'https://stream.twitter.com/1/statuses/filter.json?track=' . urlencode($QUERY));
curl_setopt($ch, CURLOPT_USERPWD, "$USERNAME:$PASSWORD");
curl_setopt($ch, CURLOPT_WRITEFUNCTION, 'writeCallback');
curl_setopt($ch, CURLOPT_TIMEOUT, 20); // disconnect after 20 seconds for testing
curl_setopt($ch, CURLOPT_VERBOSE, 1);  // debugging
curl_setopt($ch, CURLOPT_ENCODING,  'gzip, deflate'); // req'd to get gzip
curl_setopt($ch, CURLOPT_USERAGENT, 'tstreamer/1.0'); // req'd to get gzip

curl_exec($ch); // commence streaming

$info = curl_getinfo($ch);

var_dump($info); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T16:51:39.867

@Reza Sanaie 和其他可能觉得这很有帮助的人。

我使用了 SEARCH TWITTER API 并获得了实时推文。所以这可能会有所帮助。这是代码：

```
<?php
$query = "SEARCH_PARAMETER";
$request = "http://search.twitter.com/search.json?q=".urlencode($query);
$response = file_get_contents($request);
$jsonobj = json_decode($response);
 print_r($jsonobj);
?> 
```

我还设置了 MySQL 连接设置以将其推送到数据库中，并将此脚本添加到 crontab 中以自动化整个过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T17:10:42.477

我也在做同样的事情 :) 问题是当你在终端中做这件事时，它是一个流，所以连接会保持活动状态，直到你杀死它。（即 curl_exec() 没有完成）

尝试查看 CURLOPT_PROGRESSFUNCTION 和 CURLOPT_READFUNCTION。他们可能会给你一些提示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T17:24:44.557

我只是匆匆忙忙给你一个答案，就像今天要离开一样。看起来它应该工作。

下面是我使用的一个函数，我将一个 URL 和一些 XML 数据传递给它，它返回一个关联数组，表示成功为真或假，返回值作为字符串。

```
function do_curl($url, $data)
    {
    $ch = curl_init();    
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, 1); 
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
    $result = curl_exec ($ch);

    $curl_return=array();

    if (!is_string($result))
        {
        $curl_return['STATUS'] = FALSE;
        $curl_return['ERRMSG'] = curl_error($ch);
        }
    else
        {
        $curl_return['STATUS'] = TRUE;
        $curl_return['RESPONSE'] = $result;
        }
    curl_close($ch); 
    return $curl_return;
    } 
```

# sql - 这个SQL语句可以优化吗？

> ID：10337991
> 
> 赞同：0
> 
> 时间：2012-04-26T16:59:33.723
> 
> 标签：sql, sql-optimization

这似乎在大型数据集上花费了很长时间。将第一个和最后 3 个查询合并为 1 个会使其更快吗？有没有人对什么可以使它更快有任何意见？我很感激。

```
update "detail" set bal = (units * amount) where code_type = 'AB'; 
update "detail" set bal = (units * amount) where code_type = 'CD';
update "detail" set bal = (units * amount) where code_type = 'EF';
update "detail" set bal = (units * amount * -1) where code_type = 'GH';
update "detail" set bal = (units * amount * -1) where code_type = 'IK';
update "detail" set bal = (units * amount * -1) where code_type = 'LM';
update "detail" set bal = 0 where code_type = 'NO'; 
```

此外 -

```
update bill set pay = 
  (select round(sum(bd1.bal),2) from "detail" bd1 where 
  bd1.inv = bill.inv and 
  (bd1.code_type = 'AB' or bd1.code_type = 'CD')); 
update bill set pay = 0 where pay is null;
update bill set cost = 
  (select round(sum(bd2.bal),2) from "detail" bd2 where 
  bd2.inv = bill.inv and 
  (not (bd2.code_type = 'AB' or bd2.code_type = 'CD'))); 
update bill set cost = 0 where cost is null;
update bill set balance = round(cost + pay,2); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:21:41.547

性能可能很糟糕，因为您要更新整个表，并且要更新 12 次。如果桌子很大，那将需要时间。此外，这两个嵌入式子查询将每行运行一次。哎哟。

以下 frankenquery 将所有内容汇总到一个语句中。它仍然必须击中整个桌子，但至少它只击中一次。我无法检查语法或根据数据对其进行测试，但是这个或非常类似的东西应该可以工作。

已编辑，将其拆分为两个更新（因此，需要进行两次表扫描）

```
UPDATE Detail
 set
   bal = case
           when code_type in ('AB','CD','EF') then  bi.units * bi.amount
           when code_type in ('gh','ik','lm') then -bi.units * bi.amount
           when code_type = 'NO' then 0
           else bal  --  If none of the above, change nothing
         end 
```

和

```
UPDATE Bill
 set
   payments = isnull(bd1.amount, payments)  --  This changes nothing if nothing was calculated
  ,pay = case
           when pay is null then 0
           else pay
         end
   --  Ok, problem with cost: what if calculated amount is 0 and current value is non-zero?
   --  I've insufficient data here to correctly resolve all the possible permutations
  ,cost = case
            when bd2.amount is not null then cost
            when cost is null then 0
            else cost
          end
  ,balance = round(charges + isnull(bd1.amount, bi.payments), 2)
 from Bill bi
  --  These subqueries could be combined into one using similar CASE logic,
  --  and it would probably perform better (one table scan vs. two).  I'm
  --  leaving it this way for demonstration, and to keep the overall query
  --  a bit simpler.
  left outer join (select
                      inv
                     ,round(sum(bd1.bal), 2) amount
                    from detail
                    where code_type = 'AB'
                     or code_type = 'CD'
                    group by inv) bd1
   on bd1.inv = bi.inv  --  ADDED in second edit
  left outer join (select 
                      inv  --  RENAMED in second edit
                     ,round(sum(bd2.bal), 2) amount
                    from detail
                    where code_type <> 'AB'
                     and code_type <> 'CD'
                    group by inv) bd2  --  RENAMED in second edit
   on bd2.invoive = bi.inv  --  ADDED in second edit 
```

道德：`CASE`语句可以是 SQL 开发人员最好的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T18:28:42.357

第一个查询可以这样写：

```
UPDATE "detail"
SET    bal =
       CASE
              WHEN code_type = 'NO'
              THEN 0
              ELSE
                     CASE
                            WHEN code_type IN ('AB',
                                               'CD',
                                               'EF')THEN 1
                            ELSE -1
                     END
       END        * (units * amount)
WHERE  code_type IN ('AB','CD','EF','GH','IK','KL','NO'); 
```

在 code_type 上建立索引将快速过滤掉您需要更新的合格行。根据表结构的其余部分，您的速度可能会有所不同，但我认为这将是最快的版本。因为这里唯一重要的是基于代码类型的 0、1 或 -1，这就是您检查的内容，然后乘以单位*数量。

更新：您的第二批更新也可以一批写入：

```
UPDATE b
SET    payments = COALESCE(x.bal,0),
       cost     = COALESCE(y.bal,0),
       balance  = ROUND(charges + COALESCE(x.bal,0),2)
FROM   bill b
       LEFT OUTER JOIN
              ( SELECT  ROUND(SUM(bd1.bal),2) AS bal,
                       inv
              FROM     "detail" bd1
              WHERE    bd1.code_type IN ('AB',
                                         'CD')
              GROUP BY bd1.inv
              )
              x
       ON     x.inv = b.inv
       LEFT OUTER JOIN
              ( SELECT  ROUND(SUM(bd2.bal),2) AS bal,
                       invoice
              FROM     "detail" bd2
              WHERE    bd2.code_type NOT IN ('AB',
                                             'CD')
              GROUP BY bd2.invoice
              )
              y
       ON     y.invoice = b.invoice 
```

提高速度的提示：

*   明细表、code_type 和 inv 列的索引，在索引中包含 bal
*   明细表、code_type 和 invoice 列的索引，将 bal 包含在索引中。
*   账单表、inv 和发票上的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:07:31.770

我认为前 3 个语句可以在单个语句中执行，如下所示：

```
update detail set bal = (units * amount) where code_type in( 'AB','CD' ) 
```

同样，您也可以对接下来的 3 个语句执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T17:09:26.777

目前您正在为每个查询重新计算`units * amount`和`units * amount * -1`。计算`units * amount`一次并结合前几个查询应该可以提高性能，但我不知道能提高多少：

```
declare @total int
set @total = units * amount
update "detail" set bal = @total where code_type in ('AB', 'CD', 'EF');  
update "detail" set bal = (@total * -1) where code_type in ('GH', 'IK','LM');  
update "detail" set bal = 0 where code_type = 'NO'; 
```