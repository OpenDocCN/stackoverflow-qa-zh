# StackOverflow 问答 000361000-000361999

# design-patterns - 建模棋盘游戏的任何模式？

> ID：361002
> 
> 赞同：96
> 
> 时间：2008-12-11T21:24:26.600
> 
> 标签：design-patterns

为了好玩，我正在尝试将我儿子最喜欢的棋盘游戏之一编写为软件。最终我希望在它之上构建一个 WPF UI，但现在我正在构建模拟游戏及其规则的机器。

当我这样做时，我不断地看到许多棋盘游戏常见的问题，也许其他人已经比我更好地解决了这些问题。

（请注意，玩游戏的 AI 以及围绕高性能的模式对我来说并不有趣。）

到目前为止，我的模式是：

*   表示游戏框中实体的几种不可变类型，例如骰子、跳棋、卡片、棋盘、棋盘上的空格、金钱等。

*   每个玩家的一个对象，其中包含玩家资源（例如金钱、分数）、他们的姓名等。

*   代表游戏状态的对象：玩家，轮到谁，棋盘上的棋子布局等。

*   管理转弯顺序的状态机。例如，许多游戏都有一个小游戏前，每个玩家滚动看谁先走；那是开始状态。当一个玩家轮到开始时，他们首先滚动，然后移动，然后他们必须在原地跳舞，然后其他玩家猜测他们是什么品种的鸡，然后他们获得积分。

有没有我可以利用的现有技术？

**编辑：**我最近意识到的一件事是游戏状态可以分为两类：

*   **游戏神器状态**。“我有 10 美元”或“我的左手是蓝色的”。

*   **游戏序列状态**。“我翻了两次双打；下一次让我入狱”。状态机在这里可能有意义。

**编辑：**我真正在这里寻找的是实现多人回合制游戏（如国际象棋、拼字游戏或大富翁）的*最佳方式。*我确信我可以通过从头到尾完成它来创建这样一个游戏，但是，就像其他设计模式一样，可能有一些方法可以让事情变得更加顺利，如果没有仔细研究，这些方法并不明显。这就是我所希望的。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-02-17T19:45:14.597

看来这是我现在才注意到的一个 2 个月大的线程，但到底是什么。我之前曾为商业网络棋盘游戏设计和开发过游戏框架。我们有一个非常愉快的使用它的经验。

您的游戏可能处于（接近）无限数量的状态，因为诸如玩家 A 有多少钱，玩家 B 有多少钱等事物的排列......因此，我很确定你想要远离状态机。

我们框架背后的想法是将游戏状态表示为具有所有数据字段的结构，这些数据字段一起提供完整的游戏状态（即：如果您想将游戏保存到磁盘，则将该结构写出来）。

我们使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)来表示玩家可以进行的所有有效游戏动作。这是一个示例操作：

```
class RollDice : public Action
{
  public:
  RollDice(int player);

  virtual void Apply(GameState& gameState) const; // Apply the action to the gamestate, modifying the gamestate
  virtual bool IsLegal(const GameState& gameState) const; // Returns true if this is a legal action
}; 
```

所以你看到要决定一个动作是否有效，你可以构造那个动作，然后调用它的 IsLegal 函数，传入当前的游戏状态。如果有效，并且玩家确认了动作，就可以调用Apply函数来实际修改游戏状态。通过确保您的游戏代码只能通过创建和提交合法的 Actions 来修改游戏状态（也就是说，Action::Apply 系列方法是唯一直接修改游戏状态的东西），那么您可以确保您的游戏状态永远不会无效。此外，通过使用命令模式，您可以序列化玩家所需的动作，并通过网络发送它们以在其他玩家的游戏状态下执行。

这个系统最终出现了一个问题，结果证明它有一个相当优雅的解决方案。有时动作会有两个或多个阶段。例如，玩家可能会登陆大富翁中的一处房产，现在必须做出新的决定。从玩家掷骰子到他们决定是否购买房产之间的游戏状态是什么？我们通过在我们的游戏状态中添加一个“动作上下文”成员来管理这样的情况。动作上下文通常为空，表示游戏当前未处于任何特殊状态。当玩家掷骰子并将掷骰子动作应用于游戏状态时，它会意识到玩家已经登陆了一个未拥有的财产，并且可以创建一个新的“PlayerDecideToPurchaseProperty” 包含我们正在等待决策的玩家的索引的动作上下文。当 RollDice 动作完成时，我们的游戏状态表示它当前正在等待指定玩家决定是否购买房产。现在，所有其他操作的 IsLegal 方法很容易返回 false，但“BuyProperty”和“PassPropertyPurchaseOpportunity”操作除外，它们仅在游戏状态具有“PlayerDecideToPurchaseProperty”操作上下文时才合法。

通过使用动作上下文，在棋盘游戏的生命周期中，从来没有一个时间点的游戏状态结构不能完全准确地代表该时间点游戏中发生的事情。这是您的棋盘游戏系统非常理想的属性。当您可以通过只检查一个结构来找到您想知道的关于游戏中发生的一切的所有信息时，您编写代码会更容易。

此外，它很好地扩展到网络环境，客户端可以通过网络将他们的动作提交给主机，主机可以将动作应用于主机的“官方”游戏状态，然后将该动作回显给所有其他客户端以让他们将其应用于他们复制的游戏状态。

我希望这是简洁和有用的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-17T17:59:38.660

您的游戏引擎的基本结构使用[状态模式](http://en.wikipedia.org/wiki/State_pattern)。您的游戏盒中的项目是各种类别的[单身人士。](http://en.wikipedia.org/wiki/Singleton_pattern)每个状态的结构可以使用[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)或[Template Method](http://en.wikipedia.org/wiki/Template_method_pattern)。

[工厂](http://en.wikipedia.org/wiki/Factory_method_pattern)用于创建插入到玩家列表中的玩家，另一个单例。[GUI 将通过使用观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)来监视游戏引擎，并通过使用使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)创建的几个命令对象之一与之交互。Observer 和 Command 的使用可以在[被动视图](http://www.martinfowler.com/eaaDev/PassiveScreen.html)的上下文中使用，但是根据您的偏好，几乎可以使用任何 MVP/MVC 模式。保存游戏时，您需要获取当前状态的[纪念品](http://en.wikipedia.org/wiki/Memento_pattern)

我建议查看这个[网站](http://www.martinfowler.com/eaaDev/)上的一些模式，看看它们中的任何一个是否能抓住你作为起点。同样，您的游戏板的核心将是一个状态机。大多数游戏将由游戏前/设置和实际游戏两种状态表示。但是，如果您正在建模的游戏有几种不同的游戏模式，您可以拥有更多的状态。状态不必是连续的，例如战争游戏 Axis & Battles 有一个玩家可以用来解决战斗的战斗板。所以游戏前有三种状态，主板，战斗板，游戏不断在主板和战斗板之间切换。当然转弯顺序也可以用状态机来表示。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-21T09:24:18.663

我刚刚完成了使用多态性设计和实现基于状态的游戏。

`GamePhase`使用具有一个重要方法的名为的基本抽象类

```
abstract public GamePhase turn(); 
```

这意味着每个`GamePhase`对象都保存游戏的当前状态，调用`turn()`查看其当前状态并返回下一个`GamePhase`。

每个混凝土`GamePhase`都有保存**整个**游戏状态的构造函数。每个`turn()`方法里面都有一点游戏规则。虽然这分散了规则，但它使相关规则紧密相连。每个的最终结果`turn()`只是创建下一个`GamePhase`并将完整状态传递到下一个阶段。

这允许`turn()`非常灵活。根据您的游戏，给定状态可以分支到许多不同类型的阶段。这形成了所有游戏阶段的图表。

在最高级别，驱动它的代码非常简单：

```
GamePhase state = ...initial phase
while(true) {
    // read the state, do some ui work
    state = state.turn();
} 
```

这非常有用，因为我现在可以**轻松创建游戏的任何状态/阶段以进行测试**

现在回答你问题的第二部分，这在多人游戏中如何运作？`GamePhase`在需要用户输入的某些s 中，来自的调用`turn()`将询问当前`Player`他们`Strategy`给定的当前状态/阶段。 `Strategy`只是一个`Player`可以做出的所有可能决定的接口。此设置还允许`Strategy`使用 AI 实现！

Andrew Top 还说：

> 您的游戏可能处于（接近）无限数量的状态，因为诸如玩家 A 有多少钱，玩家 B 有多少钱等事物的排列......因此，我很确定你想要远离状态机。

我认为这种说法非常具有误导性，虽然确实有很多不同的游戏状态，但只有几个游戏阶段。为了处理他的示例，它只是我的具体`GamePhase`s 的构造函数的整数参数。

# 垄断

一些`GamePhase`s 的示例是：

*   游戏开始
*   PlayerRolls
*   PlayerLandsOnProperty（FreeParking、GoToJail、Go 等）
*   玩家交易
*   PlayerPurchasesProperty
*   玩家购买房屋
*   玩家购买酒店
*   PlayerPaysRent
*   玩家破产
*   （所有机会卡和公益金卡）

基地中的一些州`GamePhase`是：

*   球员名单
*   当前玩家（轮到谁）
*   玩家的金钱/财产
*   房产上的房屋/酒店
*   球员位置

然后一些阶段会根据需要记录自己的状态，例如 PlayerRolls 会记录玩家连续掷骰子的次数。一旦我们离开 PlayerRolls 阶段，我们就不再关心连续滚动了。

许多阶段可以重用并链接在一起。例如，`GamePhase` `CommunityChestAdvanceToGo`将使用当前状态创建下一个阶段`PlayerLandsOnGo`并返回它。在当前玩家的构造函数中，`PlayerLandsOnGo`将移动到围棋，他们的钱将增加 200 美元。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-11T22:32:06.977

当然有很多很多很多很多很多很多关于这个主题的资源。但我认为您在划分对象并让它们处理自己的事件/数据等方面是正确的。

在进行基于平铺的棋盘游戏时，您会发现在棋盘阵列和行/列之间以及其他功能之间进行映射的例程非常好。我记得我的第一个棋盘游戏（很久以前），当时我为如何从 boardarray 5 获取行/列而苦苦挣扎。

```
1  2  3  
4 (5) 6  BoardArray 5 = row 2, col 2
7  8  9 
```

怀旧。;)

无论如何，[http://www.gamedev.net/](http://www.gamedev.net/)是一个获取信息的好地方。 [http://www.gamedev.net/reference/](http://www.gamedev.net/reference/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-18T00:16:53.807

我可以在网上找到的大部分材料都是已发表的参考文献列表。[Game Design Patterns](http://www.gamedesignpatterns.org/)的出版物部分有文章和论文的 PDF 版本的链接。[其中许多看起来像设计模式游戏](http://www.exciton.cs.rice.edu/research/SIGCSE02/DP4Games.pdf)之类的学术论文。亚马逊还至少提供了一本书，[游戏设计中的模式](https://rads.stackoverflow.com/amzn/click/com/1584503548)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-11T21:33:10.390

[三环](http://www.threerings.com/code/)提供 LGPL 的 Java 库。Nenya 和 Vilya 是游戏相关内容的库。

当然，如果您的问题提到您可能遇到的平台和/或语言限制，这将有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-06-20T06:52:40.453

我同意 Pyrolistical 的回答，我更喜欢他的做事方式（不过我只是略过其他答案）。

巧合的是我也用了他的“GamePhase”命名。基本上，在回合制棋盘游戏的情况下，我会做的是让您的 GameState 类包含 Pyrolistical 提到的抽象 GamePhase 的对象。

可以说游戏状态是：

1.  卷
2.  移动
3.  买/不买
4.  监狱

您可以为每个状态提供具体的派生类。至少具有以下虚拟功能：

```
StartPhase();
EndPhase();
Action(); 
```

在 StartPhase() 函数中，您可以设置状态的所有初始值，例如禁用其他玩家的输入等等。

当调用 roll.EndPhase() 时，请确保 GamePhase 指针设置为下一个状态。

```
phase = new MovePhase();
phase.StartPhase(); 
```

例如，在此 MovePhase::StartPhase() 中，您可以将活动玩家的剩余移动设置为前一阶段滚动的数量。

现在有了这个设计，你可以在 Roll 阶段解决你的“3 x double = jail”问题。RollPhase 类可以处理自己的状态。例如

```
GameState state; //Set in constructor.
Die die;         // Only relevant to the roll phase.
int doublesRemainingBeforeJail;
StartPhase()
{
    die = new Die();
    doublesRemainingBeforeJail = 3;
}

Action()
{
    if(doublesRemainingBeforeJail<=0)
    {
       state.phase = new JailPhase(); // JailPhase::StartPhase(){set moves to 0};            
       state.phase.StartPhase();
       return;
    }

    int die1 = die.Roll();
    int die2 = die.Roll();

    if(die1 == die2)
    {
       --doublesRemainingBeforeJail;
       state.activePlayer.AddMovesRemaining(die1 + die2);
       Action(); //Roll again.
    }

    state.activePlayer.AddMovesRemaining(die1 + die2);
    this.EndPhase(); // Continue to moving phase. Player has X moves remaining.
} 
```

我与 Pyrolistical 的不同之处在于，所有事情都应该有一个阶段，包括玩家何时登陆社区胸部或其他东西。我会在 MovePhase 中处理这一切。这是因为如果你有太多的连续阶段，玩家很可能会觉得太“被引导”了。例如，如果有一个阶段，玩家只能购买房产，然后只能购买酒店，然后只能购买房屋，这就像没有自由一样。只需将所有这些部分整合到一个 BuyPhase 中，让玩家可以自由购买任何他想要的东西。BuyPhase 类可以轻松处理哪些购买是合法的。

最后让我们来谈谈游戏板。虽然二维数组很好，但我建议使用平铺图（平铺是板上的位置）。在垄断的情况下，它宁愿是一个双向链表。然后每个图块都会有一个：

1.  以前的瓷砖
2.  下一个瓷砖

因此，执行以下操作会容易得多：

```
While(movesRemaining>0)
  AdvanceTo(currentTile.nextTile); 
```

AdvanceTo 函数可以处理您的逐步动画或您喜欢的任何内容。当然，还要减少剩余的移动。

RS Conley 对 GUI 的观察者模式的建议很好。

我之前没有发过很多。希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-23T09:38:13.347

> 有没有我可以利用的现有技术？

如果您的问题不是特定于语言或平台的。那么我建议您考虑状态、备忘录、命令等的 AOP 模式。

.NET 对 AOP 的回答是什么？？？

也试着找一些很酷的网站，比如[http://www.chessbin.com](http://www.chessbin.com)

# delphi - 如何重命名exe文件

> ID：361023
> 
> 赞同：2
> 
> 时间：2008-12-11T21:28:08.637
> 
> 标签：delphi, linker, rename

假设我有一个通用的垂直市场应用程序，我想将它打包为两个单独的程序 aaa.exe 和 bbb.exe。有没有办法使用 Delphi 链接器创建一个与 DPR 名称不同的 EXE/DLL 文件？

**我不能只重命名文件**，因为我收到此错误

```
    bbb.exe - 无法定位组件
      此应用程序无法启动，因为 aaa.exe 无法找到。
      重新安装应用程序可能会解决此问题。

```

现在一般来说，我可以重命名一个可执行文件，但不能重命名这个。感谢您的评论指出我在这方面的愚蠢。有一个问题，显然不是一个正常的问题，甚至不一定与Delphi有关。

我正在使用 Delphi 7（如果在 2007/2009 年可能会很棒，因为我需要更多的升级素材）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-11T21:36:56.403

Delphi 2007 和 Delphi 2009 都使用 MSbuild。您可以使用 MSbuild 中的构建后事件来做几乎任何您想做的事情。例如，您可以使用复制任务将 EXE 复制到一个新的文件名中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T21:44:17.603

除了 Craig 的出色回答（投票赞成）之外，如果您不幸陷入 D7，Craig 所说的仍然适用，您只需要自己完成繁重的工作，即为自己创建一个构建脚本来构建您的应用程序，而不仅仅是从 IDE 编译，使用 dos 脚本或（甚至更好的）powershell，它需要一些前期工作，但从长远来看会给你更多的灵活性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-11T22:44:24.317

您可以自己使用像 FinalBuilder 甚至 MSBuild 这样的构建管理器。不过，我仍然建议升级到 Delphi 2009。2009 年还有许多其他精彩的补充。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T23:57:33.310

**为什么**编译后不能重命名文件？我没有得到整个 unix 参考。我可以重命名我在我的机器上找到的每个可执行文件，嗯......几乎每个人，只要他们当前没有执行。

为什么你不能？你没有告诉我们什么？

只需在资源管理器中右键单击文件，选择重命名，然后给它一个新名称。这对你不起作用吗？如果没有，请告诉我们原因，因为有些*事情*你没有告诉我们你的情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T23:12:08.503

不，您不能让编译器创建一个名称与项目名称不同的文件。

您可以将您的项目放在“项目组”中。将批处理项目附加到组中，并在该批处理项目中输入命令以重命名或复制文件。当你选择“Compile All”或“Build All”时，你的主项目将被处理，如果它编译成功，下一个项目也将被处理，运行批处理文件。

或者，由于您只是说要将其*打包*为两个程序，因此只需将安装程序配置为在安装期间使用不同的名称编写两个副本，而不是在构建环境中生成两个副本，然后分发文件的两个副本。

我不明白您关于编译后无法重命名文件的评论。完全允许重命名 EXE 文件，只要它当时不使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T22:46:09.930

或者，您可以让程序在运行时检查它自己的 exe 名称。如果它不是 aaa.exe 或 bbb.exe，则让它将自身复制到这两个名称中并终止（或启动它们！）

# c# - 使 WPF 窗口的行为类似于上下文菜单（正确显示/隐藏它）

> ID：361024
> 
> 赞同：2
> 
> 时间：2008-12-11T21:28:15.110
> 
> 标签：c#, .net, wpf, winapi

我想制作一个行为类似于上下文菜单的 WPF 窗口。

因此，例如 - 当我显示 wpf 窗口时，我希望它成为最顶层的窗口，并且从那里开始，如果用户单击该窗口之外的任何内容，我希望再次隐藏该窗口。

到目前为止，我已经尝试了很多技术，但我发现唯一可行的技术在这里展示。它第一次工作，但之后再也没有：

```
public TheWindow()
{
    InitializeComponent();
    this.Topmost = true;
}

void ShowMe()
{
    this.Show();
    this.CaptureMouse();
}

void Window_MouseDown(object sender, MouseButtonEventArgs e)
{
    /// TODO: Check if they clicked outside the window here!
    this.ReleaseMouseCapture();
    this.Hide();
} 
```

我也尝试只处理 Deactivated 事件，但由于某种原因它也只能在第一次工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T21:37:54.437

[PopUp](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx)是否不足以满足您的需求？它有一个[StaysOpen](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.staysopen.aspx)属性，可以让它像你描述的那样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T21:49:13.337

不知道这会有多大帮助，但如果您不一定需要 Window，我使用的一种技术是将 UserControl 放置在 Window 内。

根据任何条件，您将显示一个上下文菜单。在菜单中，我放置了一个菜单项，并且在其中放置了用户控件。它的行为与您想要的完全一样。您可以在屏幕上的任何位置显示上下文菜单，在其边界之外单击将关闭它。

请参阅：[http](http://andyonwpf.blogspot.com/2006/10/dropdownbuttons-in-wpf.html) ://andyonwpf.blogspot.com/2006/10/dropdownbuttons-in-wpf.html ，了解如何在屏幕上的任何位置显示上下文菜单的示例。此外，您需要覆盖 MenuItem 的默认模板，以便将鼠标悬停在菜单项上不会突出显示它。

# algorithm - 表示稀疏整数集？

> ID：361040
> 
> 赞同：13
> 
> 时间：2008-12-11T21:31:41.123
> 
> 标签：algorithm, set

以紧凑和快速的方式表示稀疏整数集（真正的 C 内存地址）的好方法是什么。我已经知道诸如位向量和游程编码之类的显而易见的事情。但我想要比每个集合元素一个单词更紧凑的东西。我需要添加和删除元素并测试成员资格。我不需要其他集合操作，比如联合。

多年前我读过一个这样的图书馆，但后来忘记了它的名字。我认为它是由惠普作为开源发布的，并且有一个女人的名字。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-11T23:03:06.183

您指的是一个 judy 数组。这是一个惠普项目。我认为它们在 ruby​​ 中使用并且在 c 中可用。非常有趣的数据结构。利用分配（至少）字对齐的事实，具有用于密集和稀疏范围的单独结构。

[http://judy.sourceforge.net/index.html](http://judy.sourceforge.net/index.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T21:53:29.083

一个非常紧凑的数据结构将是一个布隆过滤器，也许是一个支持删除的计数布隆过滤器。

[http://en.wikipedia.org/wiki/Bloom_filter](http://en.wikipedia.org/wiki/Bloom_filter)

> Bloom 过滤器由 Burton H. Bloom 在 1970 年构思，是一种节省空间的概率数据结构，用于测试元素是否是集合的成员。假阳性是可能的，但假阴性是不可能的。元素可以添加到集合中，但不能删除（尽管这可以通过计数过滤器解决）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T21:39:38.487

如果您只需要插入、删除和测试成员资格，那么哈希表应该很适合您。[您可以在此处](http://burtleburtle.net/bob/c/lookup3.c)找到一些用于散列 32 位整数的良好散列函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T21:50:46.500

如果您希望结构小于数据集，则可能应该查看某种树形排列。使 4 路的每个级别的树键从高端开始的 2 位开始，它可能会很好地压缩（如果指针具有任何程度的空间局部性）。诀窍是将其编码得足够紧凑（索引到节点数组？数组映射树？）。

# wcf - WCF wsHttpBinding 通过防火墙的有趣问题

> ID：361049
> 
> 赞同：5
> 
> 时间：2008-12-11T21:34:15.300
> 
> 标签：wcf, firewall, wshttpbinding, ws-addressing

我在 Internet 托管服务提供商中部署了一个 Web 应用程序。此 Web 应用程序使用部署在我公司应用程序服务器的 IIS 服务器上的 WCF 服务，为了对公司的数据库进行数据访问，出于安全原因，网络人员允许我通过防火墙公开此 WCF 服务。图表看起来像这样。

> [托管页面] ---> (Internet) ---> |防火墙`<Public IP>:<Port-X >`| ---> [带有 WCF 服务的 IIS `<Comp. Network Ip>:<Port-Y>`]

我还想使用 wsHttpBinding 来利用其安全功能，并加密敏感信息。

尝试后我收到以下错误：

> 异常详细信息：System.ServiceModel.EndpointNotFoundException：由于 EndpointDispatcher 的 AddressFilter 不匹配，接收方无法处理带有“http://:/service/WCFService.svc”的消息。检查发送方和接收方的 EndpointAddresses 是否一致。

做了一些研究，我发现 wsHttpBinding 使用 WS-Addressing 标准，并且阅读了这个标准，我了解到 SOAP 标头被增强以包含像“MessageID”、“ReplyTo”、“Action”和“To”这样的标签。

所以我猜测，因为客户端应用程序端点指定了防火墙 IP 地址和端口，并且服务使用与防火墙 IP 不同的内部网络地址进行回复，所以 WS-Addressing 会触发上述消息。我认为这是一个非常好的安全措施，但在我的场景中并不是很有用。

引用 WS-Addressing 标准提交 ( [http://www.w3.org/Submission/ws-addressing/](http://www.w3.org/Submission/ws-addressing/) )

> “由于目前广泛使用的网络技术范围（例如，NAT、DHCP、防火墙），许多部署无法为给定端点分配有意义的全局 URI。为了允许这些‘匿名’端点启动消息交换模式和接收回复时，WS-Addressing 定义了以下众所周知的 URI，供无法具有稳定、可解析 URI 的端点使用 [。http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous](http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous) “

**如何配置我的 wsHttpBinding 端点来寻址我的防火墙的 IP 并忽略或绕过 SOAP 消息头中的“To”WS-Addressing 标记中指定的地址？或者我是否必须更改我的服务端点配置中的某些内容？**

帮助和指导将不胜感激。

马尔科。

PS：虽然我找到了任何解决方案，但我使用 basicHttpBinding 当然绝对没有问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T07:24:32.207

您可以尝试使用以下方式装饰您的服务类：

```
[ServiceBehavior(AddressFilterMode = AddressFilterMode.Any)] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-15T05:14:19.903

处理此问题的更安全方法是将端点 ListenUri 设置为服务 Url，并将端点地址设置为客户端发送消息的外部端点。这样，服务“信任”仅指向该地址的消息，而不仅仅是任何地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T08:20:36.883

我不知道 Mitch Baker 的解决方案，从未尝试过。但这涉及修改生成的代码。还有另一种方法可以解决这个问题。

我假设您使用 svcutil.exe 生成客户端代码，并提供指向防火墙的 MEX 地址。执行此操作时，所需的所有配置都将添加到 App.config（或 Web.config）中。但是，配置中的服务地址将指向真实的服务地址（因为在 WSDL 文件中，服务的地址仍然是真实的服务地址）。

所以，我认为可以解决这个问题：

1.  通过提供 MEX 地址生成客户端代码（例如：http://:Port-X/service/wcfservice.svc?wsdl）。这将生成所有需要的配置。

2.  调用客户端构造函数时，将防火墙的 URI 作为 EnpointAddress，以及生成的配置的配置名称。这样，客户端将发送一条消息，就好像它正在将它发送到服务一样，但是发送到防火墙的地址：

    client = new ServiceClient(endpointConfigName, new System.ServiceModel.EndpointAddress("http://:Port-X/service/wcfservice.svc"));

# sql-server - 将 SAP Business One 连接到 SQL Server 2005 时，什么是

> ID：361062
> 
> 赞同：1
> 
> 时间：2008-12-11T21:38:22.110
> 
> 标签：sql-server, sql-server-2005, database-connection, sapb1

我们在一家小型制造公司运行 SAP Business One - Fourth Shift Edition。进来做安装/实施的咨询公司使用“sa”id/pass 初始连接数据库获取公司列表。从那时起，我必须假设它是用于将客户端软件连接到数据库的 sa id/pass。这合适吗？我不知道这些数据存储在哪里...作为 ODBC 连接？直接在注册表某处？它安全吗？在数据库安全中设置用户网络ID，然后使用“受信任的连接”设置会更好吗？还是大多数人在数据库中为每个用户创建一个单独的登录名并在客户端设置中使用它？

似乎最简单的方法是将用户网络登录添加到 sql server 安全性，以便他们可以使用“受信任的连接”......但是那不允许任何软件从该机器连接到数据库吗？

所以无论如何：设置它的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T03:10:14.250

sa 用法听起来像是灾难的秘诀。

在我见过的大多数安全模型中，无论您如何连接，所有经过身份验证的用户都可以读取第一个查找 SP、视图或表。即使应用程序具有专用登录，它也不是 sa。

在不了解 SAP 限制的情况下，我无法确定，但我们总是倾向于使用 Windows 身份验证和 Windows Active Directory 组。SQL Server 角色中允许这些组。因此，所有管理都在 AD 级别完成。数据库根据这些角色被锁定——即使应用程序具有 SQL Server 登录名或域登录名，它也将处于我们创建、命名和适当授予权限的数据库角色之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T17:07:17.463

我认为这实际上取决于您愿意提供/维护的安全级别。在 SAP Business One 中，创建新登录需要添加某些权限，例如授予数据库和 SBO-Common 的 db_creator 权限，或者访问读/写表和对存储过程的特定访问权限，这有点麻烦。

无论如何，为用户保留 sa 登录确实是一种不好的做法，但是您可以创建其他用户并在启动应用程序时更改登录用户。软件 CD 中有安装指南，您可以在其中通过分步指南查看该信息。如果您没有，请询​​问您的合作伙伴！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T12:53:05.117

那是非常错误的，sa帐户不应该用于一般用途。

应使用单独的（“应用程序”特定）用户帐户，以便：

*   可以在每个用户（应用程序）级别上应用安全性
*   如果应用程序出现任何问题（例如，它锁定了用户帐户），只有一个帐户会受到影响，并且很容易诊断问题

我也同意 Cade Roux 的评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T10:14:31.100

> 凯德...我不相信您能够在 Windows 中为“应用程序”赋予角色...

我认为他的意思是您将角色分配给用户，然后让应用程序使用该用户帐户。

> 所以你的意思是，如果我有一个“MYDOMAIN/nick”的用户 ID......那么在 AD 中你会将 MYDOMAIN/nick 分配给一个与使用同一个应用程序的其他人一起的组，然后在 SQL Server 中你会将该组添加到安全性并为其分配角色？

正确的。

> 我担心的是，如果我使用 MYDOMAIN/nick 登录我的机器......这会将我的整个机器激活为对 sql server 的“信任”（通过 windows 验证）......所以这意味着我可以启动 Visual Studio 并开始构建任何我想要的应用程序并可能直接连接到数据库并做任何我想做的事情......这也意味着我可以下载/安装的任何其他应用程序都可能访问该数据库......对吗？

对，那是正确的。因为您（MYDOMAIN/nick）受到信任。SQL Server 不知道您在 PC 上运行什么。

然而回到你原来的问题，你正在谈论的程序不应该连接到 MYDOMAIN/nick，它应该连接到用户名 MYDOMAIN/mycustomprogram。这是仅用于该程序的用户帐户。您可以从您的 PC 上运行该程序，但在这种情况下，它仍将使用用户名 MYDOMAIN/mycustomprogram，而不是 MYDOMAIN/nick。

然后，您可以在您的 PC 上安装第二个程序，该程序应使用第二个用户名对 SQL 服务器进行身份验证，例如 MYDOMAIN/mycustomprogram2

因此，在同一台 PC 上，您将拥有：

*   MYDOMAIN/昵称 (AD)
*   MYDOMAIN/mycustomprogram（SQL 或 AD 用户）
*   MYDOMAIN/mycustomprogram2（SQL 或 AD 用户）

在应用程序级别使用这些自定义用户名会覆盖 AD 身份验证。

这也意味着如果您对两个程序之一有问题，或者程序锁定了用户帐户等，则很容易诊断。

> 我了解到 SAP 客户端会加密其连接信息并将其存储在注册表中。

你说的是连接的哪一部分？我不知道有任何东西以这种方式存储。

这能回答你的问题吗？

请投票给有用的答案;-)

# language-agnostic - 函数式编程：不变性等

> ID：361066
> 
> 赞同：12
> 
> 时间：2008-12-11T21:39:48.767
> 
> 标签：language-agnostic, concurrency, functional-programming, immutability

我最近[问了一个](https://stackoverflow.com/questions/353912/functional-programming-state-vs-reassignment)关于函数式编程的问题，并收到了（好！）答案，引发了更多问题（有时似乎是学习的情况）。这里有几个例子：

1.  一个答案提到了不可变数据结构的优势：每个线程都可以拥有自己的副本。现在，对我来说，这听起来更像是一个版本控制系统（打个比方），不是锁定某人已签出的代码以使其无法被其他任何人修改，而是每个人都可以签出自己的副本。听起来不错。但是，在 VCS 中，您有“合并”更改的概念，以防两个人更改相同的内容。看起来这个问题肯定会出现在多线程场景中......那么当线程看到最新数据很重要时，如何“合并”？

2.  [这个答案](https://stackoverflow.com/questions/353912/functional-programming-state-vs-reassignment#355040)谈到了在对象的循环中执行操作的情况，以及如何每次都使用新对象而不是更新旧对象。但是，假设`bankAccount`在非循环场景中更新 - 例如 GUI 银行系统。操作员单击“更改利率”按钮，该按钮会触发一个事件（例如在 C# 中）执行类似`bankAccount.InterestRate = newRateFromUser`. 我觉得我在这里很密集，但希望我的例子是有道理的：必须有某种方式来更新对象，对吧？其他几件事可能取决于新数据。

无论如何，如果你能帮助我理解范式转变，我将不胜感激。我记得在简单的程序命令式编码方法的背景下学习 OOP 时，我的大脑经历了类似的“愚蠢阶段”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T23:14:19.403

想想 .Net 中的 String 类（它是一个不可变对象）。如果你在一个字符串上调用一个方法，你会得到一个新的副本：

```
String s1 = "there";
String s2 = s1.Insert(0, "hello ");

Console.Writeline("string 1: " + s1);
Console.Writeline("string 2: " + s2); 
```

这将输出：

*字符串 1：那里*

*字符串 2：你好*

将此行为与具有基本相同方法签名的 StringBuilder 进行比较：

```
StringBuilder sb  = new StringBuilder("there");
StringBuilder sb2 = sb.Insert(0, "hi ");

Console.WriteLine("sb 1: " + sb.ToString());
Console.WriteLine("sb 2: " + sb2.ToString()); 
```

因为 StringBuilder 是可变的，所以两个变量都指向同一个对象。输出将是：

*某人 1: 你好*

*某人2：你好*

因此，一旦创建了字符串，就绝对不能更改它。s1 将一直“在那里”直到时间结束（或直到它的垃圾被收集）。这在线程中很重要，因为您始终可以单步执行每个字符并打印其值，因为知道它总是会打印“那里”。如果您在创建 StringBuilder 后开始打印它，您可能会打印那里的前两个字符并获取'th'。现在，想象一下广告插入“嗨”出现了另一个线程。现在的价值不一样了！当您打印第三个字符时，它是 'hi' 中的空格。所以你打印：'th there'。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-11T23:29:43.367

对第 1 部分的回答：不可变对象本身不支持诸如“合并”之类的东西以允许合并两个线程更新的结果。对此有两种主要策略：悲观和乐观。如果你很悲观，你会假设两个线程很可能想要同时更新同一个数据。所以你使用锁定，这样第二个线程将冻结，直到第一个线程说它已经完成。如果您乐观地认为这种情况很少发生，您可以让两个线程处理它们自己的数据逻辑副本。首先完成的一个提供新版本，另一个必须从头开始 - 只是现在它从第一个线程更改的结果开始。这种昂贵的重启只是偶尔发生，

第 2 部分：纯函数式无状态语言并没有真正消除这个问题。即使是纯 Haskell 程序也可以有与之关联的状态。不同之处在于有状态代码具有不同的返回类型。操作状态的函数表示为对表示该状态的对象进行操作的一系列操作。在一个荒谬的例子中，考虑计算机的文件系统。每次程序修改文件的内容（甚至修改单个字节）时，它都会创建整个文件系统的新“版本”。通过扩展，整个宇宙的新版本。但现在让我们关注文件系统。检查文件系统的程序的任何其他部分现在可能会受到该修改字节的影响。因此，Haskell 说，在文件系统上运行的函数必须有效地传递代表文件系统版本的对象。然后因为手动处理这将是乏味的，它把需求翻过来，并说如果一个函数想要能够做 IO，它必须返回一种容器对象。容器内部是函数想要返回的值。但是容器作为证据表明该功能也有副作用或可以看到副作用。这意味着 Haskell 的类型系统能够区分具有副作用的函数和“纯”函数。所以它有助于包含和管理代码的状态，而不是真正消除它。它将要求从里到外，并说如果一个函数想要能够进行 IO，它必须返回一种容器对象。容器内部是函数想要返回的值。但是容器作为证据表明该功能也有副作用或可以看到副作用。这意味着 Haskell 的类型系统能够区分具有副作用的函数和“纯”函数。所以它有助于包含和管理代码的状态，而不是真正消除它。它将要求从里到外，并说如果一个函数想要能够进行 IO，它必须返回一种容器对象。容器内部是函数想要返回的值。但是容器作为证据表明该功能也有副作用或可以看到副作用。这意味着 Haskell 的类型系统能够区分具有副作用的函数和“纯”函数。所以它有助于包含和管理代码的状态，而不是真正消除它。s 类型系统能够区分具有副作用的函数和“纯”函数。所以它有助于包含和管理代码的状态，而不是真正消除它。s 类型系统能够区分具有副作用的函数和“纯”函数。所以它有助于包含和管理代码的状态，而不是真正消除它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T00:39:36.707

关于#2...

> 其他几件事可能取决于新数据。

这就是纯粹主义者所说的“效果”。多个对象引用同一个可变对象的概念是可变状态的本质和问题的症结所在。在 OOP 中，您可能有一个 BankAccount 类型的对象“a”，如果您在不同*时间*读取 a.Balance 或诸如此类的东西，您可能会看到不同的值。相反，在纯 FP 中，如果“a”的类型为 BankAccount，那么它是不可变的，并且无论时间如何都具有相同的值。

然而，由于 BankAccount 可能是我们想要建模的对象，其状态会随时间而变化，因此我们将在 FP 中将该信息编码为类型。因此，“a”可能具有“IO BankAccount”类型，或者其他一些基本上归结为使“a”实际上是一个函数，该函数将“以前的世界状态”（或以前的银行利率状态）作为输入，或其他），并返回一个新的世界状态。更新利率将是另一个具有表示效果的类型的操作（例如另一个 IO 操作），因此将返回一个新的“世界”，并且可能取决于利率（世界状态）的所有内容都将是具有知道它需要将该世界作为输入的类型。

因此，调用“a.Balance”或诸如此类的唯一可能方法是使用由于静态类型而强制执行某些“让我们到现在为止的世界历史”的代码已被正确探测到调用，无论输入的世界历史是什么，都会影响我们从 a.Balance 获得的结果。

阅读[State Monad](http://www.haskell.org/all_about_monads/html/statemonad.html)可能有助于了解您如何纯粹地建模“共享可变状态”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T21:54:53.590

1.  不可变数据结构不像 VCS。将不可变数据结构视为只读文件。如果它是只读的，那么在任何给定时间谁在读取文件的哪个部分都没有关系，每个人都会读取正确的信息。

2.  这个答案是关于[http://en.wikipedia.org/wiki/Monad_(functional_programming)](http://en.wikipedia.org/wiki/Monad_(functional_programming))

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-17T08:51:02.617

## [MVCC](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)（*多版本并发控制*）

[Rich Hickey 在他的视频演示](http://clojure.blip.tv/)中描述了您所指问题的解决方案。

**简而言之**：不是通过引用直接将数据传递给客户端，而是在间接上添加一层并将引用传递给对数据的引用。（*好吧，实际上你希望至少多一层间接性。但我们假设数据结构非常简单，就像“数组”一样。*）
由于数据是不可变的，每次数据都应该改变，你创建更改部分的副本（*如果是数组，您应该创建另一个数组！*）加上您创建对所有“更改”数据的另一个引用。
因此，对于使用第一个版本的数组的所有客户端，他们使用对第一个版本的引用。每个尝试访问第二个版本的客户端都使用第二个引用。
对于这种方法，“数组”数据结构不是很有趣，因为您无法拆分数据并且您被迫复制所有内容。但是对于像树这样更复杂的数据结构，数据结构的某些部分可以“共享”，因此您不必每次都复制所有内容。

有关详细信息，请查看这篇论文： Chris Okasaki 的[**“Purely Functional Data Structures”**](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T23:21:27.423

“不可变”的确切含义是：它不会改变。

函数式程序进行更新的方式是传递新事物。现有值永远不会改变：您只需构建一个新值并传递它。很多时候，新值与旧值共享状态；该技术的好例子是由 cons 单元组成的列表和[zipper](http://en.wikibooks.org/wiki/Haskell/Zippers)。

# c# - 关于 C# 短路评估的最佳实践是什么？

> ID：361069
> 
> 赞同：16
> 
> 时间：2008-12-11T21:41:08.750
> 
> 标签：c#

另一个帖子的评论中的答案和随后[的辩论](https://stackoverflow.com/questions/360899/c-math-problem#360931)促使我问：

在 C# 中 || 和 && 是逻辑运算符的短路版本 | 和 & 分别。

示例用法：

```
if (String.IsNullOrEmpty(text1) | String.IsNullOrEmpty(text2) | String.IsNullOrEmpty(text3))
{
    //...
} 
```

相对：

```
if (String.IsNullOrEmpty(text1) || String.IsNullOrEmpty(text2) || String.IsNullOrEmpty(text3))
{
    //...
} 
```

就编码实践而言，哪个更好用，为什么？

注意：我确实意识到这个问题与[这个](https://stackoverflow.com/questions/89154/benefits-of-using-short-circuit-evaluation)问题相似，但我相信它需要针对特定​​语言进行讨论。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-11T21:43:40.290

> 就编码实践而言，哪个更好用，为什么？

简单的答案：始终使用短路版本。根本没有理由不这样做。此外，您使代码更清晰，因为您表达了您的*意图*：逻辑评估。使用按位（逻辑）操作意味着您只需要：位操作，而不是逻辑评估（即使 MSDN 在应用于布尔值时也称它们为“逻辑运算符”）。

此外，由于短路仅评估需要评估的内容，因此通常更快，并且允许编写如下代码

```
bool nullorempty = str == null || str.Length == 0; 
```

（请注意，为了解决这个特定问题，已经存在更好的函数，即`string.IsNullOrEmpty`您在问题中也使用了该函数。）按位逻辑运算无法使用此代码，因为即使`str`是`null`，第二个表达式也会被评估，导致一个`NullReferenceException`。

**编辑**：如果您*希望*在逻辑上下文中发生副作用，请*仍然*不要使用按位运算。这是太聪明的典型例子。代码的下一个维护者（甚至是你自己，几周后）看到这段代码会想“嗯，这段代码可以被清除以使用条件运算符”，从而无意中破坏了代码。我同情负责修复此错误的人。

相反，如果您必须依赖副作用，请明确说明：

```
bool hasBuzzed = checkMakeBuzz();
bool isFrobbed = checkMakeFrob();
bool result = hasBuzzed || isFrobbed; 
```

当然，三行而不是一行。但结果是更清晰的代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-11T22:36:02.447

我将反过来回答这个问题：我**唯一**一次使用逻辑运算符是什么时候？

当我有一系列必须全部满足的（低成本）条件时，我有时会使用逻辑比较。例如：

```
bool isPasswordValid = true;

isPasswordValid &= isEightCharacters(password);
isPasswordValid &= containsNumeric(password);
isPasswordValid &= containsBothUppercaseAndLowercase(password);

return isPasswordValid; 
```

在我看来，以上内容比以下内容更具可读性：

```
return (isEightCharacters(password) &&
        containsNumberic(password)  &&
        containsBothUppercaseAndLowercase(password)); 
```

缺点是它有点深奥。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T21:48:53.070

当您只关心结果并希望尽快知道该结果并且即使不满足布尔条件也没有任何表达式具有必须发生的副作用时，请使用`&&`and 。`||`也就是说，几乎总是如此。

在必须评估每个表达式时使用`&`and `|`（例如，如果您的表达式有副作用）。但是，由于即使不满足布尔条件，您的程序所依赖的副作用也一定会发生，因此您可能不应该使用`&`and `|`。

例如，这可能非常愚蠢：

```
if (false & somethingThatUpdatesTheDatabase()) { /* ... */ } 
```

# javascript - IE 的非冒泡提交事件的解决方法

> ID：361073
> 
> 赞同：4
> 
> 时间：2008-12-11T21:41:33.897
> 
> 标签：javascript, ajax, internet-explorer, javascript-events

我正在开发一个带有大量 AJAX 的大型 Web 应用程序，其事件处理已经失控。我正在尝试建立一个[事件委托](http://icant.co.uk/sandbox/eventdelegation/)系统来管理所有这些，但我想知道是否有针对 IE 的非冒泡表单提交的解决方法（有很多通过 AJAX 插入/更新的表单）。我想出的最好的事情是每次我从 AJAX 调用得到响应时执行一些 javascript 来重新加载提交处理程序，但这看起来很难看。有任何想法吗？

此外，是否有人对哪些事件在不同版本的 IE 中没有正确传播有很好的参考？我很难找到好的信息（尽管[这个其他问题](https://stackoverflow.com/questions/265074/does-the-onchange-event-propagate)有点）。

* * *

该站点的一个真实示例：对某些用户内容进行了就地编辑。进行事件委托时，我会让主体监听提交事件，然后查看是什么元素触发了事件并相应地处理它。由于提交不会在 IE 中冒泡，因此这是行不通的。5 美元的解决方案是对所有其他事件进行事件委托，并在 Prototype 中使用类似这样的东西处理提交：

```
// call this onload:
$$('form').invoke('observe', 'submit', function(event) { /*delegate*/ }); 
```

但这不适用于动态创建的表单（如上所述，我每次都必须重新实例化处理程序），如果我可以在 IE 中“制作”表单提交气泡和只需在任何地方进行简单的委托（没有特殊情况等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T18:06:03.603

您可以让表单返回 false 并在提交按钮上查找 CLICK 事件而不是表单提交事件吗？然后通过 AJAX 调用以编程方式提交表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-30T01:05:52.363

Rails 3 rails.js 通过检测浏览器是否支持提交事件冒泡解决了这个问题，如果不支持，则将 onSubmit 方法绑定到表单的第一个焦点事件的处理程序。挺整洁的。

查看

[http://github.com/rails/rails/commit/f61d923d284062b4e4864d81c603157020198d06](http://github.com/rails/rails/commit/f61d923d284062b4e4864d81c603157020198d06)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T18:24:53.880

另一个需要考虑的选项可能是[reglib](http://blogs.oracle.com/greimer/entry/event_delegation_for_submit_change)。

最新的中继版本有一个允许提交委托的实现

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T15:25:51.087

您可以尝试的一种技术是只有两个表单：“工作”表单和隐藏的“提交”表单，并且页面上只有这两个表单。

“工作”表单是向用户显示的内容——它只是一个容器，可以包含来自各种表单的元素。表单上的各种按钮实际上并不提交，而是在 JavaScript 中调用表单处理程序/验证例程。

处理程序/验证例程动态设置“提交”表单的操作，并将所需元素动态添加到该表单，以便可以提交。

这样您就不会从标签本身添加和删除，您只是更改两个主要标签的外观和行为，从而避免所有令人讨厌的事件操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-06T20:02:41.013

Matt Kantor，我强烈建议你看看 NWEvents。正如您所说，它实际上强制在 IE 中冒泡，并以跨浏览器的方式使“事件委托”可用于任何其他事件。

NWEvents 源代码在[GitHub 上](http://github.com/dperini/nwevents)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T23:33:09.227

**到目前为止我考虑过的选项：**

*   我在问题本身中发布的糟糕解决方案。
*   [Inline Cop-out](http://peter.michaux.ca/articles/the-window-onload-problem-really-solved) - 始终保证工作，并且开销相对较低，但令人难以置信的突兀。我必须调整这个想法以与 Prototype 一起工作（这并不难，我可能只是编写一个 Event.fix(event) 函数来停止事件然后重新触发它以以其快乐的方式传播）。
*   [NWEvents](http://javascript.nwbox.com/NWEvents/) - 我没有机会过多地摆弄这个，但据说这会迫使*所有*事件冒泡。查看源代码，我不确定这实际上是否适用于动态创建的元素。我得再玩一会儿。

# .net - 如何等到远程 .NET 调试器附加

> ID：361077
> 
> 赞同：74
> 
> 时间：2008-12-11T21:42:19.480
> 
> 标签：.net, debugging, breakpoints, remote-debugging

今天我遇到了一个问题，我需要远程调试程序。该程序是从另一个系统启动的，所以我真的没有机会在命令行上与它进行交互。不过，我可以轻松更改其来源。

我需要做的是让程序正常启动，然后等待我用调试器附加到它。我想不出一个让我开心的方法。我确实找到了错误，但没有调试器的帮助。

```
while(true) { } 
```

让进程保持活力，然后我可以用调试器“设置下一条语句”，但这似乎很尴尬和粗鲁。

```
Console.ReadLine(); 
```

打字似乎很奇怪，因为实际上并没有控制台让我按下**回车**键。（它也不起作用。设置下一条语句，然后运行将带您回到 ReadLine() 等待。）

那么我可以将什么样的代码插入到 .NET/CLR/C# 程序中，上面写着“在这里等到我可以附加调试器”？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-02-16T09:49:40.157

您可以使用[System.Diagnostics.Debugger.IsAttached](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.isattached.aspx)属性来检查调试器是否附加到进程。此应用程序将等待，直到附加了调试器：

```
using System;
using System.Diagnostics;
using System.Threading;

namespace DebugApp
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Waiting for debugger to attach");
            while (!Debugger.IsAttached)
            {
                Thread.Sleep(100);
            }
            Console.WriteLine("Debugger attached");
        }
    }
}
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-09-14T17:45:52.887

这听起来正是您所需要的：

```
Debugger.Launch(); 
```

[http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx)

“启动并将调试器附加到进程。”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T21:55:19.080

我不知道，因为我从未尝试过，但我想知道您是否可以使用`System.Diagnostics.Debugger.Break()`它来使其达到断点，然后等待调试器附加。我假设远程调试器可以工作，但我不确定并且目前无法访问我可以轻松模拟它并测试我的理论的家庭环境。有一篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)谈论在 ASP.Net 应用程序中使用它，所以我想它会起作用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-14T11:57:37.990

附加远程调试器的工作方式与使用本地调试器完全相同。

首先，照常做：

```
System.Diagnostics.Debugger.Launch(); 
```

您将看到选择调试器的提示。此时执行已暂停，因此您可以附加远程调试器并从提示中选择“否”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:34:53.390

```
Debug.Assert(true); 
```

我猜也应该工作。顺便说一句，我有时也面临这个问题，我确实

```
MessageBox.Show() 
```

:P :P

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-11T21:55:24.073

设置一个超时，让您有时间附加调试器。

```
Thread.Sleep(30000); 
```

# vba - 应用程序打开时 Excel 2002 加载项未加载

> ID：361080
> 
> 赞同：0
> 
> 时间：2008-12-11T21:42:44.753
> 
> 标签：vba, excel, add-in, excel-2002

下午好，

我为 Excel 2002 创建了一个 Excel .xla 插件。我从中看到的这种奇怪行为只发生在我的机器上，而不会发生在我的同事身上。我想了解为什么。

该插件有一个 UDF 函数，可以从许多电子表格中调用。

*   我的加载项设置为在 Excel 打开时打开。当我打开一个空白电子表格时，它工作正常。

*   如果我双击引用加载项的 .XLS，Excel 将无法加载 VBA 项目，并且我得到 #NAME!。但是，如果我打开 Excel 然后打开电子表格，它工作正常。

我检查了帮助菜单下的黑名单“禁用项目”。那里什么都没有。这已经工作了很长时间；我不知道发生了什么变化。我已尝试使用我的加载项名称对所有注册表项进行核对，然后重试。还是不行。

有任何想法吗？谢谢。-艾伦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-06T20:52:22.007

最终我发现所有有问题的电子表格中都有 RTD/DDE 链接，结果数据源进程从未真正在我的机器上运行。一旦我去编辑链接并删除了这些链接，一切都很好。

# delphi - 我可以一次从两个数据集中进行查找吗？

> ID：361086
> 
> 赞同：1
> 
> 时间：2008-12-11T21:43:59.120
> 
> 标签：delphi, dataset, lookup

在[这个问题中，](https://stackoverflow.com/questions/346838/can-dataset-filtering-be-done-from-outside-the-dataset)我询问了将数据集分解为子集的问题，并得到了很好的回应。现在我有相反的问题。我有两个不同的数据集，代表一个共同祖先的两个不同子类的对象，我需要使用相同的 TDBLookupComboBox 同时搜索它们，使用两个属性，ID # 和 Name，存在于父级中班级。

查找字段允许您从多个源字段中查找内容，但只能在同一数据集中，而不是两个不同的数据集中。查找控件只允许您指定一个查找字段进行搜索。有谁知道我如何从两个数据集中获取数据以一起出现在组合框中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T21:53:34.013

创建您自己的采用多个数据源的 TDBLookupComboBox。. . . 我之前创建了数据库感知控件（特别是下拉组合框）。它们很容易做到，并为您提供所需的所有控制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T21:52:57.213

您可以将两个数据集中的记录克隆到一个包含两者并集的新数据集中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T21:51:52.143

答案在您链接到的[原始问题中。](https://stackoverflow.com/questions/346838/can-dataset-filtering-be-done-from-outside-the-dataset)你说两个数据集的成员有一个共同的祖先。因此，将所有这些对象记录放入单个 TClientDataset 中，然后对于您的两个后代数据集，只需让它们使用来自该基本数据集的克隆游标。因此，您可以将它们访问为不同的集合，或者作为它们的一个组合集合。

当然，问题在于添加到未共享基类的后代类中的任何数据，假设您有任何数据。. .

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T22:03:24.663

创建实际上是其他 TDataSet 的联合的 TDataSource 或 TDataSet 后代。然后在插入时，您要么总是插入到一个特定的 TDataSet 中，要么有基于某个字段的值的规则来确定要插入哪个 TDataSet。. . .

# c - 为什么以下打印“资源暂时不可用”？

> ID：361092
> 
> 赞同：4
> 
> 时间：2008-12-11T21:44:57.213
> 
> 标签：c, linux, file-io, select-function

为什么以下代码在 80% 的情况下打印“read()：资源暂时不可用”？那是 EAGAIN 代码，与 WOULD BLOCK 相同，表示没有数据等待读取，但 select 返回 1 表示有数据（在 Linux 中测试）：

```
#include <time.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/errno.h>

int main(int argc, char** argv)
{
    int fd = open("/dev/lp0", O_RDWR | O_NONBLOCK);
    int ret = 0;
    int status = 0;
    char buffer[1024];
    char teststr[] = "This is a test\n";
    char XMIT_STATUS_OFFLINE[] = {0x10,0x04,0x02};
    char XMIT_STATUS_ERROR[] = {0x10,0x04,0x03};
    char XMIT_STATUS_ROLL[] = {0x10,0x04,0x04};
    char XMIT_STATUS_SLIP[] = {0x10,0x04,0x05};
    fd_set rfds;
    FD_ZERO( &rfds );
    FD_SET( fd, &rfds );
    struct timeval sleep;
    sleep.tv_sec = 5;
    sleep.tv_usec = 0;

    /* Offline status */
    ret = write(fd, XMIT_STATUS_OFFLINE, sizeof(XMIT_STATUS_OFFLINE));
    //printf("write() returned %d\n", ret);

    do {
        ret = select( fd + 1, &rfds, NULL, NULL, &sleep );
    } while (ret < 0 && (errno == EINTR));

    ret = read(fd, buffer, 1024);
    if(ret == -1) {
        perror("read(): ");
    } else {
        status = buffer[0];
        if((status & 0x04) != 0)
        {
            printf("The cover is open.\n");
        } else {
            printf("OFFLINE is good.\n");
        }
    }
    close(fd);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T21:59:25.173

如果没有可用数据，您的 select 调用将在 5 秒超时后返回 0。您的代码将忽略这一点并尝试从设备中读取。检查 ret == 0 这将解决您的问题。

# c# - 调用批处理文件后服务在 WaitForExit 挂起

> ID：361097
> 
> 赞同：18
> 
> 时间：2008-12-11T21:46:04.293
> 
> 标签：c#, .net, service, windows-services

我有一项有时会调用批处理文件的服务。批处理文件需要 5-10 秒来执行：

```
System.Diagnostics.Process proc = new System.Diagnostics.Process(); // Declare New Process
    proc.StartInfo.FileName = fileName;
    proc.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
    proc.StartInfo.CreateNoWindow = true;
    proc.Start();
    proc.WaitForExit(); 
```

当我在控制台中运行相同的代码时，该文件确实存在并且代码有效。但是，当它在服务内部运行时，它会挂断在`WaitForExit()`. 我必须从进程中终止批处理文件才能继续。（我确定该文件存在，因为我可以在进程列表中看到它。）

我该如何解决这个挂断问题？

# 更新#1：

凯文的代码让我得到输出。我的一个批处理文件仍然挂起。

> "C:\EnterpriseDB\Postgres\8.3\bin\pg_dump.exe" -i -h localhost -p 5432 -U postgres -F p -a -D -v -f "c:\backupcasecocher\backupdateevent2008.sql" -t "\"public\".\"dateevent\"" "DbTest"

另一个批处理文件是：

> "C:\EnterpriseDB\Postgres\8.3\bin\vacuumdb.exe" -U postgres -d DbTest

我检查了路径，`postgresql`路径很好。输出目录确实存在并且仍然在服务之外工作。有任何想法吗？

# 更新#2：

我写了“C:\EnterpriseDB\Postgres\8.3\bin\pg_dump.exe”，而不是批处理文件的路径，`proc.StartInfo.FileName`并将所有参数添加到`proc.StartInfo.Arguments`. 结果没有改变，但我`pg_dump.exe`在进程窗口中看到了。同样，这只发生在服务内部。

# 更新#3：

我已经使用管理员组中的用户运行该服务，但无济于事。我恢复`null`了服务的用户名和密码

# 更新#4：

我创建了一个简单的服务来在事件日志中写入跟踪并执行其中包含“dir”的批处理文件。它现在会挂起`proc.Start();`- 我尝试将帐户从 LocalSystem 更改为**User**并设置管理员用户和密码，但仍然没有。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-11T21:54:43.730

这是我用来执行批处理文件的内容：

```
proc.StartInfo.FileName                 = target;
proc.StartInfo.RedirectStandardError    = true;
proc.StartInfo.RedirectStandardOutput   = true;
proc.StartInfo.UseShellExecute          = false;

proc.Start();

proc.WaitForExit
    (
        (timeout <= 0)
            ? int.MaxValue : timeout * NO_MILLISECONDS_IN_A_SECOND *
                NO_SECONDS_IN_A_MINUTE
    );

errorMessage = proc.StandardError.ReadToEnd();
proc.WaitForExit();

outputMessage = proc.StandardOutput.ReadToEnd();
proc.WaitForExit(); 
```

我不知道这是否对你有用，但我没有挂起的问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-01-07T09:47:59.020

```
using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Diagnostics;
    namespace VG
    {
        class VGe
        {
            [STAThread]
            static void Main(string[] args)
            {
                Process proc = null;
                try
                {                
                    string targetDir = string.Format(@"D:\adapters\setup");//this is where mybatch.bat lies
                    proc = new Process();
                    proc.StartInfo.WorkingDirectory = targetDir;
                    proc.StartInfo.FileName = "mybatch.bat";
                    proc.StartInfo.Arguments = string.Format("10");//this is argument
                    proc.StartInfo.CreateNoWindow = false;
                    proc.Start();
                    proc.WaitForExit();
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Exception Occurred :{0},{1}", ex.Message,ex.StackTrace.ToString());
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-09T05:13:26.640

```
 string targetDir = string.Format(@"D:\");//PATH
            proc = new Process();
            proc.StartInfo.WorkingDirectory = targetDir;
            proc.StartInfo.FileName = "GetFiles.bat";
            proc.StartInfo.Arguments = string.Format("10");//argument
            proc.StartInfo.CreateNoWindow = false;
            proc.Start();
            proc.WaitForExit(); 
```

经测试，工作清晰。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T21:58:52.317

批处理文件有什么作用？您确定该进程正在以足够的权限启动以执行批处理文件吗？服务可以被限制在他们被允许做的事情上。

还要确保您是否正在执行类似使用复制命令覆盖文件的操作，例如：

```
echo Y | copy foo.log c:\backup\ 
```

此外，请确保您使用批处理命令的完整路径等。如果批处理文件以某种“控制台”模式启动 GUI 应用程序，这也可能是一个问题。请记住，服务没有“桌面”（除非您启用“与桌面交互”）来绘制任何类型的窗口或消息框。在您的程序中，您可能希望打开 stdout 和 stderr 管道并在执行期间从它们中读取，以防您收到任何错误消息或任何东西。

WebServices 可能作为 IUSR 帐户或匿名帐户执行，这可能对您来说是个问题。如果在控制台中运行它时它有效，那只是第一步。:)

我不记得是否 System.Diagnostics。是否仅在调试中可用。可能不是，但其中一些可能是。我得为你检查一下。

希望这能给你一些想法。

拉里

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T15:10:41.837

pg_dump.exe 可能会提示用户输入。这个数据库需要认证吗？您是否依赖于服务中不存在的任何 ENVIRONMENT 变量？我不知道 pg_dump 但它会提示输入的其他可能原因是什么？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-12T18:51:16.197

我将采取的下一步是启动调试器，看看你是否能知道程序正在等待什么。如果您在汇编调试方面经验丰富，您可能能够使用 ProcExp、FileMon 等工具了解正在发生的事情。

作为 Windows SERVICE，而不是 Web 服务，会有很大的不同。无论如何，您是否尝试过我设置“允许服务与桌面交互”的建议？

如果你很绝望，你可以尝试启动 cmd.exe 而不是你的批处理文件。然后，使用 cmd.exe 的 cmd 行参数，您可以让 IT 启动批处理文件。如果您打开与桌面交互，这可能会给您一个 cmd 提示窗口来查看实际输出。

有关 cmd.exe 的完整帮助，只需键入 cmd /? 在任何命令提示符下。

拉里

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-13T19:35:24.450

这是解决方案。解决方案尚不清楚，因为我已经更改了很多次代码，现在它可以工作了！

我曾尝试使用用户帐户，但它不起作用。使用本地系统。这是执行的代码，主要是 Kevin 给我的。

```
 System.Diagnostics.Process proc = new System.Diagnostics.Process();
            proc.StartInfo.FileName = fileName;
            proc.StartInfo.RedirectStandardError = true;
            proc.StartInfo.RedirectStandardOutput = true;
            proc.StartInfo.UseShellExecute = false;

            proc.Start();
            proc.WaitForExit();
            output1 = proc.StandardError.ReadToEnd();
            proc.WaitForExit();
            output2 = proc.StandardOutput.ReadToEnd();
            proc.WaitForExit(); 
```

谢谢大家，我会投票给大家并接受凯文，因为他从一开始就帮助我。很奇怪，因为它现在可以工作了......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-15T23:53:46.207

Daok，看起来您唯一更改的是初始 WaitForExit() 的超时时间。你需要非常小心。如果某些东西*确实*挂起您的服务，它将永远不会返回（好吧，到目前为止，您所做的工作几乎都是如此......呵呵），但这对最终用户不利......

现在，也许您知道是什么导致它挂起，您可以进一步调试它并找到完整的解决方案......

那，或者在您可以监视的某个线程中将其关闭，如果挂起时间过长，则将其杀死。

只是我的 2 美分，通常不是很多。;)

# c - 执行“free(ppMapData[i])”时我的程序会崩溃什么？

> ID：361115
> 
> 赞同：0
> 
> 时间：2008-12-11T21:51:58.587
> 
> 标签：c, arrays, memory-management

我尝试制作`char`如下动态二维数组：

```
char** ppMapData = (char**)malloc(sizeof(char*)*iMapHeight);
for (int i=0; i< iMapHeight; i++)
{
    ppMapData[i] = (char*)malloc(sizeof(char)*iMapWidth);
    //do something
}

// do something

for (int i=0; i<iMapHeight; i++)
    free(ppMapData[i]);
free(ppMapData); 
```

对我来说看起来不错；但是，在运行时，我的程序在调用`free(ppMapData[i])`. 任何想法这里有什么问题。非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T21:55:28.783

一眼看去，frees 看起来不错。您应该测试的下一件事是确保您没有超出这些数组中的任何一个。这可能会导致内存分配系统出现问题。

如果您使用的是 Visual Studio，则可以调用 _CrtCheckMemory 来帮助验证您没有丢弃任何东西。该调用仅在 DEBUG 构建中有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T21:55:49.563

您是否在 malloc 之后检查了 NULL 值？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T21:56:12.463

您已将您的问题标记为“C++”。为什么不使用适当的 C++ 结构呢？例如 a`vector<vector<char> >`甚至（我可能会建议） a `vector<string>`？

**编辑**哦，好吧，a`vector<string>`可能不是你想要的。尽管如此，我还是强烈建议使用 C++-ier 解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T21:56:59.280

乍一看我没有看到问题，但这并不意味着它不存在。请确保您没有通过在“做某事”部分中的某处释放内存来进行双重释放。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T13:41:43.420

几个可能的答案：

1.  你确定你没有超出分配数组的末端吗？malloc 将在您分配的内存后立即存储重要信息，如果您覆盖它，就会发生坏事。

2.  您确定您没有修改 ppMapData 中的值吗？试图释放一个从未分配过的指针通常也是一件坏事。

3.  当你的程序崩溃时 i 的值是多少？是否一致？知道这将是有帮助的，并且可能具有指导意义

一些风格评论：

*   检查 malloc 的返回值（如果失败则为 NULL）。

*   不要强制转换 malloc 的返回值（如果您确实在编写 C 而不是 C++）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-11T22:30:06.467

如果它是一个二维数组，在两个维度上都有固定大小，我总是更喜欢：

```
char* array = (char*)malloc(iMapHeight*iMapWidth); 
```

并通过以下方式访问它：

```
char val = array[height*iMapWidth + width]; 
```

如果您愿意，可以将其包装在宏中：

```
#define GET_VAL(h, w) array[h*iMapWidth + w] 
```

乘法将比取消引用两个指针来查找值更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T21:52:23.097

假设//做某事不仅仅是评论，取出

// 做一点事

代码，看看它是否仍然崩溃。一次添加一个东西，直到它再次崩溃

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-17T22:13:14.613

从问题中的代码来看，您似乎并没有检查 malloc 是否成功。第一步检查 malloc 是否没有返回 NULL，这可能不是您的问题，因为

```
//do something 
```

可能正在使用新分配的内存，但如果不是，malloc 可能会在你不知道的情况下失败，直到它被免费取消引用。（我知道 malloc 不太可能失败，除非您正在为低内存环境进行开发，但它仍然值得检查）

其次`i`它崩溃时的价值是多少，几乎一样吗？

最后你能给我们提供核心转储吗？问题会更容易识别:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-17T22:18:09.673

如果您删除“做某事”代码，它仍然会崩溃吗？如果不是，则可能意味着您在“做某事”代码中破坏了内存，这就是您的错误所在，而不是在上面的代码中。

如果你在一个支持它的平台上，通过 Valgrind 运行它，发现细微的错误是无价的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-17T22:24:40.143

作为 joemucchiello 的替代品，

```
char **ppMapData = malloc(iMapHeight * sizeof(char*) +
                          iMapHeight * iMapWidth * sizeof(char)));

for (int i = 0; i < iMapHeight; i++) {
    ppMapData[i] = (char *)(ppMapData + iMapHeight) + i * iMapWidth;
    /* do something */
}

/* do something */

free(ppMapData); 
```

这会产生一个大分配，同时包含指针数组和字符数组。

但是，正如许多其他人所说，您发布的代码运行良好。" `// do something`" 段中一定有您尚未发布的内容导致此错误。

例如，如果您已经释放了`ppMapData[i]`，则不能再次释放它。`ppMapData[i] = NULL`有些人会通过在 any 之后立即设置来避免这种情况`free(ppMapData[i])`：这是有效的，因为 a`free(NULL)`是合法的并且什么都不做。我的偏好是*不*这样做，并**修复**任何会导致您陷入双重自由情况的设计。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-17T21:20:19.167

iMapHeight / iMapWidth 是常数吗？如果没有，它们可能会在两者之间进行更改，从而导致问题。此外，正如其他人所建议的，检查 malloc 是否返回 null。

# javascript - 获取页面上的选定文本和选定节点？

> ID：361130
> 
> 赞同：14
> 
> 时间：2008-12-11T21:56:10.763
> 
> 标签：javascript, firefox, xhtml, firefox-addon, selection

选择一块文本（可能跨越许多DOM节点）时，是否可以使用JavaScript提取所选文本和节点？

想象一下这段 HTML 代码：

```
<h1>Hello World</h1><p>Hi <b>there!</b></p> 
```

如果用户从“World...”开始启动 mouseDown 事件，然后在“there！”之后启动 mouseUp，我希望它会返回：

```
Text : { selectedText: "WorldHi there!" },
Nodes: [ 
  { node: "h1", offset: 6, length: 5 }, 
  { node: "p", offset: 0, length: 16 }, 
  { node: "p > b", offset: 0, length: 6 } 
] 
```

我尝试将 HTML 放入 textarea 中，但这只会让我获得 selectedText。我没有尝试过该`<canvas>`元素，但这可能是另一种选择。

如果不是 JavaScript，有没有办法使用 Firefox 扩展来实现？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-12T23:19:35.623

您将经历一段颠簸的旅程，但这很有可能。主要问题是 IE 和 W3C 为选择提供了完全不同的界面，因此如果您想要跨浏览器功能，那么您基本上必须将整个内容编写两次。此外，两个界面都缺少一些基本功能。

[Mozilla 开发者联系有关于W3C 选择](https://developer.mozilla.org/en/DOM/window.getSelection)的故事。[Microsoft在 MSDN 上记录了](http://msdn.microsoft.com/en-us/library/ms535869(VS.85).aspx)他们的系统。我建议从 PPK[对 range 的介绍](http://www.quirksmode.org/dom/range_intro.html)开始。

以下是我认为有效的一些基本功能：

```
// selection objects will differ between browsers
function getSelection () {
  return ( msie ) 
    ? document.selection
    : ( window.getSelection || document.getSelection )();
}

// range objects will differ between browsers
function getRange () {
  return ( msie ) 
      ? getSelection().createRange()
      : getSelection().getRangeAt( 0 )
}

// abstract getting a parent container from a range
function parentContainer ( range ) {
  return ( msie )
      ? range.parentElement()
      : range.commonAncestorContainer;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-09T15:55:32.987

我的[Rangy](http://code.google.com/p/rangy)库将通过统一 IE < 9 和所有其他主要浏览器中的不同 API，并`getNodes()`在其 Range 对象上提供一个函数，为您提供帮助：

```
function getSelectedNodes() {
    var selectedNodes = [];
    var sel = rangy.getSelection();
    for (var i = 0; i < sel.rangeCount; ++i) {
        selectedNodes = selectedNodes.concat( sel.getRangeAt(i).getNodes() );
    }
    return selectedNodes;
} 
```

在所有浏览器中获取所选文本都非常容易。在 Rangy 它只是

```
var selectedText = rangy.getSelection().toString(); 
```

没有范围：

```
function getSelectedText() {
    var sel, text = "";
    if (window.getSelection) {
        text = "" + window.getSelection();
    } else if ( (sel = document.selection) && sel.type == "Text") {
        text = sel.createRange().text;
    }
    return text;
} 
```

至于字符偏移，您可以`node`对选择中的任何节点执行类似的操作。请注意，这并不一定代表文档中的可见文本，因为它没有考虑折叠空格、通过 CSS 隐藏的文本、通过 CSS 定位在正常文档流之外的文本、由和块元素隐含的换行符`<br>`以及其他细微之处。

```
var sel = rangy.getSelection();
var selRange = sel.getRangeAt(0);
var rangePrecedingNode = rangy.createRange();
rangePrecedingNode.setStart(selRange.startContainer, selRange.startOffset);
rangePrecedingNode.setEndBefore(node);
var startIndex = rangePrecedingNode.toString().length;
rangePrecedingNode.setEndAfter(node);
var endIndex = rangePrecedingNode.toString().length;
alert(startIndex + ", " + endIndex); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-02T19:20:46.457

据我了解，这将返回选定的节点：当我有

```
<p> ... </p><p> ... </p><p> ... </p><p> ... </p><p> ... </p>...
<p> ... </p><p> ... </p><p> ... </p><p> ... </p><p> ... </p> 
```

很多节点，我只选择了几个，然后我只希望这些节点出现在列表中。

```
function getSelectedNodes() {
  // from https://developer.mozilla.org/en-US/docs/Web/API/Selection
  var selection = window.getSelection();
  if (selection.isCollapsed) {
    return [];
  };
  var node1 = selection.anchorNode;
  var node2 = selection.focusNode;
  var selectionAncestor = get_common_ancestor(node1, node2);
  if (selectionAncestor == null) {
    return [];
  }
  return getNodesBetween(selectionAncestor, node1, node2);
}

function get_common_ancestor(a, b)
{
    // from http://stackoverflow.com/questions/3960843/how-to-find-the-nearest-common-ancestors-of-two-or-more-nodes
    $parentsa = $(a).parents();
    $parentsb = $(b).parents();

    var found = null;

    $parentsa.each(function() {
        var thisa = this;

        $parentsb.each(function() {
            if (thisa == this)
            {
                found = this;
                return false;
            }
        });

        if (found) return false;
    });

    return found;
}

function isDescendant(parent, child) {
     // from http://stackoverflow.com/questions/2234979/how-to-check-in-javascript-if-one-element-is-a-child-of-another
     var node = child;
     while (node != null) {
         if (node == parent) {
             return true;
         }
         node = node.parentNode;
     }
     return false;
}

function getNodesBetween(rootNode, node1, node2) {
  var resultNodes = [];
  var isBetweenNodes = false;
  for (var i = 0; i < rootNode.childNodes.length; i+= 1) {
    if (isDescendant(rootNode.childNodes[i], node1) || isDescendant(rootNode.childNodes[i], node2)) {
      if (resultNodes.length == 0) {
        isBetweenNodes = true;
      } else {
        isBetweenNodes = false;
      }
      resultNodes.push(rootNode.childNodes[i]);
    } else if (resultNodes.length == 0) {
    } else if (isBetweenNodes) {
      resultNodes.push(rootNode.childNodes[i]);
    } else {
      return resultNodes;
    }
  };
 if (resultNodes.length == 0) {
    return [rootNode];
  } else if (isDescendant(resultNodes[resultNodes.length - 1], node1) || isDescendant(resultNodes[resultNodes.length - 1], node2)) {
    return resultNodes;
  } else {
    // same child node for both should never happen
    return [resultNodes[0]];
  }
} 
```

代码应位于：[https ://github.com/niccokunzmann/spiele-mit-kindern/blob/gh-pages/javascripts/feedback.js](https://github.com/niccokunzmann/spiele-mit-kindern/blob/gh-pages/javascripts/feedback.js)

我在这里发布了这个答案，因为我想在这里找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-25T15:09:30.240

如果您只想要范围，还有一种更短的方法。

```
function getRange(){
    return (navigator.appName=="Microsoft Internet Explorer")
        ? document.selection.createRange().parentElement()
        : (getSelection||document.getSelection)().getRangeAt(0).commonAncestorContainer
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-14T13:53:44.853

在 IE11+ 中工作的所有符合标准的代码。

**文本字符串**

```
window.getSelection().getRangeAt(0).toString() 
```

**起始节点**（即使文本被向后选择）：

```
window.getSelection().anchorNode 
```

**结束节点**（即使文本被向后选择）：

```
window.getSelection().focusNode 
```

你想了解更多吗？选择一些文本并在控制台中运行以下 JavaScript：

```
console.log(window.getSelection());
console.log(window.getSelection().getRangeAt(0)); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-11T22:26:08.737

您可能想从[http://javascript.internet.com/page-details/copy-selected-text.html开始](http://javascript.internet.com/page-details/copy-selected-text.html)

# sql - SQL 查询建议 - 最新项目

> ID：361135
> 
> 赞同：1
> 
> 时间：2008-12-11T21:56:59.343
> 
> 标签：sql, sql-server

我有一张表格，用于存储客户销售（在期刊上，如报纸上）数据。产品按问题存储。例子

```
托管产品问题 数量 日期 已售出
1 123 2 12 01052008
2 234 1 5 01022008
1 123 1 5 01012008
2 444 2 3 02052008

```

对于特定客户，我如何检索（什么是更快的方法）所有产品的最后一期？我可以提供 SQL Server 2000 和 2005 的示例吗？请注意，该表超过 500k 行。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T22:00:40.770

通用 SQL；SQL Server 的语法应该没有太大的不同：

```
SELECT prodid, max(issue) FROM sales WHERE custid = ? GROUP BY prodid; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T02:50:37.423

假设“最新”是由日期（而不是由问题编号）确定的，这种方法通常非常快，假设索引不错：

```
SELECT
     T1.prodid,
     T1.issue
FROM
     Sales T1
LEFT OUTER JOIN dbo.Sales T2 ON
     T2.custid = T1.custid AND
     T2.prodid = T1.prodid AND
     T2.datesold > T1.datesold
WHERE
     T1.custid = @custid AND
     T2.custid IS NULL 
```

处理 500k 行可能是笔记本电脑可以毫无问题地处理的事情，更不用说真正的服务器了，所以我不会为了“性能”而对数据库进行非规范化处理。不要通过在其他地方跟踪“最后售出”来增加额外的维护、不准确以及最令人头疼的问题。

编辑：我忘了提......这并没有专门处理两个问题具有相同确切日期的情况。对于这种情况，您可能需要根据您的业务规则对其进行调整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T22:12:27.643

这是一个新项目吗？如果是这样，我会警惕像这样设置你的数据库并阅读一些关于规范化的内容，这样你最终可能会得到这样的结果：

```
CustID LastName FirstName
------ -------- ---------
1      Woman    Test
2      Man      Test

ProdID ProdName
------ --------
123    NY Times
234    Boston Globe

ProdID IssueID PublishDate
------ ------- -----------
123    1       12/05/2008
123    2       12/06/2008

CustID OrderID OrderDate
------ ------- ---------
1      1       12/04/2008

OrderID ProdID IssueID Quantity
------- ------ ------- --------
1       123    1       5
2       123    2       12 
```

我必须更好地了解您的数据库才能提出更好的架构，但听起来您将太多东西构建到一个平面表中，这会导致很多问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T22:21:16.203

如果您正在寻找最新的销售日期，也许这就是您所需要的：

```
SELECT prodid, issue
  FROM Sales 
WHERE custid = @custid 
      AND datesold = SELECT MAX(datesold) 
                       FROM Sales s 
                      WHERE s.prodid = Sales.prodid
                         AND s.issue = Sales.issue
                        AND s.custid = @custid 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T22:02:14.417

查询现有的增长历史表太慢了！

强烈建议您创建一个新表 tblCustomerSalesLatest，其中存储每个客户的最后一个问题数据。并从那里选择。

# java - 绕过 FreeMarker 缓存？

> ID：361137
> 
> 赞同：3
> 
> 时间：2008-12-11T21:57:55.877
> 
> 标签：java, caching, freemarker

请求某些模板时是否可以绕过 Freemarker 缓存？我意识到我可能必须实现自己的 TemplateLoader 才能做到这一点，但即便如此，当请求模板 A 时，我看不到检查缓存的方法，但在请求模板 B 时绕过它？

如果这是不可能的，我只需要完全禁用缓存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T22:29:32.320

[尝试在您的配置](http://freemarker.sourceforge.net/docs/api/freemarker/template/Configuration.html#setTemplateUpdateDelay(int))上禁用缓存：

```
configuration.setTemplateUpdateDelay(0); 
```

这应该会导致它在每次请求时检查模板的更新版本。

要仅跳过某些模板的缓存，您只需要覆盖`getLastModified`以返回某些模板的非常旧的日期，从而强制重新加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T19:45:24.800

您可以在配置对象本身上设置它。有关详细信息，请参阅[此页面](http://freemarker.org/docs/pgui_config_templateloading.html#pgui_config_templateloading_caching)。

对于您的特定问题，您可以执行以下操作：

```
cfg.setSetting(Configuration.CACHE_STORAGE_KEY, "strong:0, soft:0"); 
```

# php - 将变量传递给输入

> ID：361151
> 
> 赞同：0
> 
> 时间：2008-12-11T22:02:04.153
> 
> 标签：php, html

我制作了一个名为 test.html 的 html 文件，然后以“ [http://site.com/test.html?test1=a](http://site.com/test.html?test1=a) ”的形式导航到它，但文本框保持空白。为什么是这样？

超级简单的代码

```
<html>
<head>
<title>Test</title>
</head>
<body >
 <input type=text name="test1">
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T22:04:39.717

该文件应该是一个 PHP 文件，所以 test.php。

然后可能是这样的：

```
<html>
<head>
    <title>Test</title>
</head>
<body>
    <input type="text" name="test1" value="<?php echo htmlspecialchars($_GET['test1'], ENT_QUOTES); ?>">
</body>
</html> 
```

在您的示例中它保持空白的原因是没有 PHP 代码将值放入字段中。它不是自动的。此外，在大多数服务器上（但并非总是如此），带有 .html 扩展名的文件不会被 PHP 解析。

此外，将它传递给[htmlspecialchars](http://us2.php.net/htmlspecialchars)函数将有助于防止[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T22:11:25.007

HTML 只是网络服务器的另一个文件扩展名，它不会做任何类型的处理，除非你已经做了一些事情来做到这一点。您是否希望打开[http://site.com/foo.txt?contents=helloworld](http://site.com/foo.txt?contents=helloworld)并在浏览器中看到“helloworld”？

我建议您在 PHP 上搜索一些教程（w3schools 通常适合这类事情），然后是“查询字符串”以及服务器端脚本的工作原理。您应该很快就可以开始使用基本的站点脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T22:15:10.727

如果您必须使用静态 html，则可以通过 javascript 读取 URL 并以这种方式填充文本框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T22:17:32.810

```
<html>
<head>
<title>Test</title>
</head>
<body >
 <input type=text name="test1" value="<?php echo htmlspecialchars($_GET['test1']);?>">
</body>
</html> 
```

# ms-office - 如何将自定义项目添加到 Microsoft Office 发送到菜单

> ID：361156
> 
> 赞同：0
> 
> 时间：2008-12-11T22:03:30.453
> 
> 标签：ms-office, send

是否可以扩展 Office 中的“发送到”菜单（不是 Windows 的；我知道该怎么做）。我想以源文档为目标启动我自己的应用程序。

更新：我正在寻找基于非 VSTO 的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T19:36:21.953

在 2007 中，您可以扩展功能区，并且应该能够将您的控件放在`FileSendMenu`选项卡 Office 菜单中的组中。我认为 Visual Studio 的最后一个 VSTO 插件中可用的设计器不支持此功能，因此您可能必须手工制作 xml。

```
<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="OnGetImage">
  <ribbon>
    <officeMenu>
      <menu idMso="FileSendMenu">
        <button id="oButtonId"
              insertAfterMso="FileInternetFax"
              getDescription="GetDescription"
              getLabel="GetLabel"
              getScreentip="GetSuperTip"
              getSupertip="GetSuperTip"
              getVisible="GetVisible"
              onAction="OnButtonPress"/>
      </menu>
    </officeMenu>
  </ribbon>
</customUI> 
```

您将需要一个事件处理程序（“OnButtonPress”）以及用于描述、图标等的处理程序。您可以使用 VBA 执行此操作，但我宁愿使用适当的加载项。

# ruby-on-rails - Rails 表单验证

> ID：361161
> 
> 赞同：22
> 
> 时间：2008-12-11T22:04:59.730
> 
> 标签：ruby-on-rails, forms, validation

我有一个 Rails 应用程序，它允许用户通过填写​​大量表单来构建数据库查询。我想知道在 Rails 中检查表单参数的最佳实践。以前，我让我的`results`方法（表单提交的方法）执行以下操作：

```
if params[:name] && !params[:name].blank?
  @name = params[:name]
else
  flash[:error] = 'You must give a name'
  redirect_to :action => 'index'
  return
end 
```

但是对于几个表单字段，看到每个表单都重复这种情况会让人厌烦。我不能将它们全部放在某个循环中以检查每个字段，因为这些字段的设置不同：

*   一个键： `params[:name]`
*   一个键和一个子键： `params[:image][:font_size]`
*   如果设置了另一个字段，则只期望填写某些表单字段

等等。这也是重复的，因为我`flash[:error]`为每个丢失/无效参数设置，并为每个参数重定向到相同的 URL。我切换到使用`before_filter`检查所有必要的表单参数并且仅在一切正常时才返回 true 的方法。然后 my`results`方法继续，变量被完全分配，不涉及检查：

```
@name = params[:name] 
```

在我的`validate_form`方法中，我有如下代码部分：

```
if (
  params[:analysis_type][:to_s] == 'development' ||
  params[:results_to_generate].include?('graph')
)
  {:graph_type => :to_s, :graph_width => :to_s,
   :theme => :to_s}.each do |key, sub_key|
    unless params[key] && params[key][sub_key]
      flash[:error] = "Cannot leave '#{Inflector.humanize(key)}' blank"
      redirect_to(url)
      return false
    end
  end
end 
```

我只是想知道我是否以最好的方式解决这个问题，或者在参数验证方面我是否遗漏了一些明显的东西。我担心这仍然不是最有效的技术，因为我有几个块在其中分配一个值`flash[:error]`，然后重定向到相同的 URL，然后返回 false。

*编辑澄清：* 我目前在模型中没有此验证的原因有两个：

*   我不是为了在数据库中创建或更新一行而尝试从用户那里收集数据。用户提交的所有数据在退出后都不会保存。当他们提交它以搜索数据库并生成一些东西时，它就全部使用了。
*   查询表单接受与多个模型有关的数据，并接受根本不属于模型的其他数据。例如，上面显示的图形类型和主题不连接到任何模型，它们只是传达有关用户希望如何显示其结果的信息。

*编辑以显示改进的技术：* 感谢 Jamis Buck 的[Raising the Right Exception 文章](http://weblog.jamisbuck.org/2007/3/7/raising-the-right-exception)，我现在使用特定于应用程序的异常。例如：

```
def results
  if params[:name] && !params[:name].blank?
    @name = params[:name]
  else
    raise MyApp::MissingFieldError
  end

  if params[:age] && !params[:age].blank? && params[:age].numeric?
    @age = params[:age].to_i
  else
    raise MyApp::MissingFieldError
  end
rescue MyApp::MissingFieldError => err
  flash[:error] = "Invalid form submission: #{err.clean_message}"
  redirect_to :action => 'index'
end 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-12T02:13:12.600

你可以试试 active_form ([http://github.com/cs/active_form/tree/master/lib/active_form.rb](http://github.com/cs/active_form/tree/master/lib/active_form.rb)） - 只是 ActiveRecord 减去数据库的东西。通过这种方式，您可以使用 AR 的所有验证内容，并像对待任何其他模型一样对待您的表单。

```
class MyForm < ActiveForm
  validates_presence_of :name
  validates_presence_of :graph_size, :if => # ...blah blah 
end

form = MyForm.new(params[:form])
form.validate
form.errors 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-11T22:13:44.067

看起来您正在控制器中进行验证，尝试将其放入模型中，它更适合那种事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-26T21:38:37.513

如果你今天要再次解决这个问题，你可以为查询参数集创建一个模型并使用 Rails 的内置验证，Rails 3 使用 ActiveModel::Validations 使这变得更容易，请参阅[这篇文章](http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-30T16:39:47.130

## 模型

```
class Person 
    include ActiveModel::Validations
    include ActiveModel::Conversion
    extend ActiveModel::Naming

    attr_accessor :name
    attr_accessor :email

    validates_presence_of :name,:message => "Please Provide User Name"
    validates_presence_of :email,:message => "Please Provide Email"
end 
```

请注意，您不一定需要保存/保留模型以进行验证。

## 控制器

```
@person.name= params["name"]
@person.email= params["email"]
@person.valid? 
```

一个你叫 .valid 的？模型上的方法，错误将填充到 @person 对象中。因此，

## 看法

```
<%if @person.errors.any? %>
     <%@person.errors.messages.each do|msg| %>
          <div class="alert alert-danger">
            <%=msg[0][1]%>
          </div>
     <%end%>
<%end%> 
```

# html - 是否可以将文本放在 HTML 中的 3d 按钮上？

> ID：361163
> 
> 赞同：1
> 
> 时间：2008-12-11T22:05:47.123
> 
> 标签：html, css

我想在我的网站上使用漂亮的 3d 按钮图像。但是，目前这种工作方式是文本是图像的一部分。

因此，当我想更改文本（或制作新按钮）时，需要 10 分钟的编辑工作，而不是 20 秒的文本更改。

我见过一些网站有一个空白按钮，上面有文字。

真正的诀窍是使*整个*图像可点击。我已经能够使图像内的链接可见，但这是一个糟糕的 UI。用户会期望在任何地方单击按钮，如果不这样做会使他们感到沮丧。

似乎他们在超链接周围包装了一个带有图像背景的 .DIV 标签。

```
<Div（带图像的类>
<a> 文本
</a>

```

示例： [https ://www.box.net/signup/g](https://www.box.net/signup/g)

有人对它的工作原理有任何见解或解释吗？

代码示例

```
<a href="#" class="button" style="position: relative;left:-5px;" 
   onmousedown="return false;" 
   onclick="document.forms['register_form'].submit(); return false;">
    <span>
        My text
    </span>
</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T22:09:41.063

使按钮成为背景图像：

```
<style>
div.button a {
    display: block;
    width: /* image width */;
    line-height: /* image height */;
    text-align: center;
    background: url(/* image uri */) no-repeat;
}
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T22:08:48.507

也许像

```
a { 
   width: something ; 
   height: something; 
   display: block; 
   background: url('hi.png'); 
 } 
```

还，

```
input { background: url('hi.png'); } 
```

是另一种选择

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T22:09:42.233

将你的锚设置为 display:block 并给它一个等于你的 div/背景图像的高度/宽度对你有帮助吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T22:11:56.520

您的示例只是将 CSS 样式放在 a 标签上...

从那里：

标签：

```
<a onclick="document.forms['register_form'].submit(); return false;"
   onmousedown="return false;" style="position: relative; left: -5px;"
   class="button" href="#">
    <span>Continue</span>
</a> 
```

请注意，他们出于某种原因使用 JS，而不是使用 href，我不喜欢那样。

然后，按钮类：

```
a.button 
{
    background:transparent url(../img/greenbutton2.gif) no-repeat scroll left top;
    font-size:16px;
    height:42px;
    line-height:42px;
    width:155px;
} 
```

这就是您链接到的那个网站是如何做到的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T23:08:42.360

我觉得[这](http://gwtfuse.blogspot.com/2007/11/how-to-make-nice-buttons-with-gwt.html)相当令人印象深刻。使用 GWT 设置超链接样式。

# c# - 将 Linq 中的值更新为 SQL IEnumerable

> ID：361167
> 
> 赞同：1
> 
> 时间：2008-12-11T22:07:06.013
> 
> 标签：c#, linq-to-sql

使用 Linq 到 SQL：

```
if(!parentlist.childlist.Contains(row1))
      parentlist.childlist.Add(row1);
else 
```

如何使用 row1 更新所需的子列表行？子列表的每一行都有一个唯一的 id。

`parentlist`实现`IEnumerable`和`childlist`是`IList`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-09T17:59:30.860

我不认为你可以这样做。您需要从 datacontaxt 中选择 chidlist 项，然后将行添加到其中并提交回来。

它真的不能令人满意，但我认为它只是 linq2sql 令人讨厌的限制之一。

# vb.net - 如何使用 ExecuteScalar 从 Oracle 数据库返回单个值？

> ID：361175
> 
> 赞同：4
> 
> 时间：2008-12-11T22:10:28.097
> 
> 标签：vb.net, oracle

一直在使用下面的代码从数据库中返回一条记录。我读过 ExecuteScalar 是返回单个记录的正确方法。不过，我从来没有让 ExecuteScalar 工作。我将如何更改它以使用 ExecuteScalar 在 VB.Net 中返回单个值？

```
 Dim oracleConnection As New OracleConnection
    oracleConnection.ConnectionString = LocalConnectionString()

    Dim cmd As New OracleCommand()
    Dim o racleDataAdapter As New OracleClient.OracleDataAdapter

    cmd.Connection = oracleConnection
    cmd.CommandText = "FALCON.CMS_DATA.GET_MAX_CMS_TH"
    cmd.CommandType = CommandType.StoredProcedure

    cmd.Parameters.Add(New OracleParameter("i_FACID_C", OracleType.Char)).Value = facilityShortName
    cmd.Parameters.Add(New OracleParameter("RS_MAX", OracleType.Cursor)).Direction = ParameterDirection.Output

    Try
        Using oracleConnection
            oracleConnection.Open()
            Using oracleDataAdapter
                oracleDataAdapter = New OracleClient.OracleDataAdapter(cmd)

                Dim workingDataSet As DataSet
                oracleDataAdapter.TableMappings.Add("OutputSH", "RS_MAX")
                workingDataSet = New DataSet
                oracleDataAdapter.Fill(workingDataSet)

                For Each row As DataRow In workingDataSet.Tables(0).Rows

                    Return CDate(row("MAXDATE"))

                Next
            End Using
        End Using 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:17:35.453

来自微软

“OracleCommand 类的 ExecuteOracleScalar() 方法用于执行返回单个值作为 OracleType 数据类型的 SQL 语句或存储过程。如果该命令返回结果集，该方法返回的第一列的值如果返回 REF CURSOR，则该方法返回空引用，而不是 REF CURSOR 指向的第一行的第一列的值。OracleCommand 类的 ExecuteScalar() 方法类似于 ExecuteOracleScalar()方法，但它返回一个值作为 .NET Framework 数据类型。

话虽如此，在使用 Oracle 存储过程时，这些方法都没有用。Oracle 存储过程不能将值作为 RETURN 语句的一部分返回，只能作为 OUT 参数返回 - 请参阅不返回数据的存储过程部分。此外，您不能返回结果集，除非通过 REF CURSOR 输出参数 - 这将在下一节中讨论。

您只能使用 RETURN 参数（如上一节所示）而不是使用 ExecuteScalar 方法之一来检索 Oracle 函数的返回值。”

[http://msdn.microsoft.com/en-us/library/ms971506.aspx](http://msdn.microsoft.com/en-us/library/ms971506.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T22:17:34.917

ExecuteScalar 返回单个值（标量）而不是记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T18:40:56.507

不确定为什么另一个答案被标记为已接受，因为它似乎没有回答您的问题

> 我将如何更改它以使用 ExecuteScaler 在 VB.Net 中返回单个值

ExecuteScalar 只会返回一个单一值 - 所以在编写命令的查询部分时请记住这一点。完成此操作的代码如下：

```
oracleConnection.Open
Dim obj as object 'Object to hold our return value
obj = cmd.ExecuteScalar()
oracleConnection.Close

If obj IsNot Nothing then
    Return CDate(obj)
end if 
```

# c++ - c++ 的首选命名约定是什么？

> ID：361176
> 
> 赞同：3
> 
> 时间：2008-12-11T22:10:43.497
> 
> 标签：c++, naming-conventions

查看 boost 库和 stl，然后查看人们的示例，我感到很困惑。似乎大写的类型名称都穿插着所有小写字母，并用下划线分隔。

这些天应该怎么做？我知道 .NET 世界有自己的一套约定，但它似乎与 C++ 领域完全不同。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T22:36:12.070

你打开了多少蠕虫罐头。

C++ 标准库对所有内容都使用**underscore_notation**，因为这是 C 标准库使用的。

因此，如果您希望您的代码在整体上看起来一致（并且实际上不使用外部库），那是唯一的方法。

你会看到 boost 使用相同的符号，因为他们的库经常被考虑用于未来的标准。

除此之外，还有许多约定，通常使用不同的符号来指定不同类型的符号。通常将**[CamelCase](http://en.wikipedia.org/wiki/CamelCase)**用于自定义类型，例如类和 typedef，而**使用 mixCase**用于变量，专门用于区分这两者，但这当然不是通用标准。

还有**[Hungarian Notation](http://en.wikipedia.org/wiki/Hungarian_notation)**，它进一步区分了特定的变量类型，尽管只是提到这个短语可能会激起一些编码人员的敌意。

作为一名优秀的 C++ 程序员，最好的答案是采用您所沉浸的代码中使用的任何约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T22:40:53.077

没有好的答案。如果您正在与现有代码库集成，那么匹配他们的风格是有意义的。如果你正在创建一个新的代码库，你可能想要建立简单的指导方针。

[谷歌有一些](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T23:03:08.990

根据图书馆和组织的不同，情况会有所不同。

例如，对于我正在构建的开发人员实用程序库，我正在为各种约定风格的约定包含友好的包装器模块。因此，例如，MFC 包装器模块对成员使用“m_typeMemberVariable”表示法，而 STL 包装器模块使用“member_variable”。我正在尝试构建它，以便使用的任何前端都将具有该类型前端的典型样式。

具有通用风格的问题是每个人都必须同意，并且（例如）对于每个讨厌匈牙利符号的人，还有其他人认为不使用匈牙利符号会损害代码可理解性的基本价值。因此，短期内不太可能有 C++ 的通用标准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T09:11:39.497

找到你觉得舒服的东西并坚持下去。某种形式的风格总比没有风格好，不要太拘泥于其他图书馆是如何做到的。

FWIW 我使用 Google C++ 风格指南（有一些调整）。

[http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)

# php - 使用 PHP 和 Linux 更好地支持 CURL

> ID：361193
> 
> 赞同：2
> 
> 时间：2008-12-11T22:15:41.550
> 
> 标签：php, mysql, linux, curl, curl-multi

我是 twittertrend.net 的开发人员，我想知道除了 curl_multi 之外，是否有更快的方法来获取 URL 的标题？我每分钟处理超过 250 个 URL，从 PHP 的角度来看，我需要一种非常快速的方法来做到这一点。可以使用 bash 脚本，然后输出标题或 C 应用程序，有什么可以更快的吗？我主要只用 PHP 编程，但我可以学习。目前，CURL_MULTI（一次提供 6 个 URL，工作还不错，但我更喜欢更快的东西？最终我想坚持使用 PHP 进行任何 MySQL 存储和处理。

谢谢，詹姆斯哈蒂格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T01:42:25.217

我最近写了一篇关于如何加速 curl_multi 的博客文章。基本上，我会在每个请求完成后立即处理它，并使用队列来保持大量请求同时进行。我在这项技术上取得了很好的成功，并且正在使用它每分钟处理约 6000 个 RSS 提要。我希望这有帮助！

[http://onlineaspect.com/2009/01/26/how-to-use-curl_multi-without-blocking/](http://onlineaspect.com/2009/01/26/how-to-use-curl_multi-without-blocking/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T22:24:41.347

获取 URL 标头的最简单方法是使用[get_headers()](http://www.php.net/get_headers)。性能方面，我认为您无法击败 curl_multi，但请尝试对其进行基准测试并查看。很难说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T22:32:52.123

回复：threading-via-bash-script，有可能，但不太可能：此类脚本的进程创建开销可能会降低速度。

如果是对您的导入，请启动一个只执行此类解析的守护程序，然后在本地连接到该守护程序。然后，您可以使用 C 或 C++ 或其他任何方式使该守护程序尽可能快地执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T22:36:09.903

curl_multi + 这些选项可能是您最好的选择：

```
curl_setopt ($ch, CURLOPT_HEADER, 1);
curl_setopt ($ch, CURLOPT_NOBODY, 1);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1); 
```

唯一的其他选择可能是将 wget 与

```
--server-response 
```

然后使用 C/C++、Java 等对其进行多线程处理。我不相信这最终会是一个更快的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T05:27:09.900

我认为您需要一个多进程批处理 URL 获取守护进程。PHP 不支持多线程，但没有什么可以阻止您生成多个 PHP 守护进程。

话虽如此，PHP 缺乏适当的垃圾收集器意味着长时间运行的进程可能会泄漏内存。

运行一个生成大量 php 程序实例（可配置，但受控数量）的守护进程，它当然必须能够读取工作队列、获取 URL 并以多种方式写入结果过程安全；多个 proc 不应该最终尝试做同样的工作。

您会希望所有这些都作为守护进程自主运行，而不是从 Web 服务器运行。真的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T22:29:53.533

如果您不介意进入非常低级别的内容，您可以使用套接字函数发送流水线的原始 HTTP 1.1 请求。

了解您当前使用的瓶颈在哪里 - 网络、CPU 等会有所帮助...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T01:54:32.107

好吧，我想出了以下几点： get_headers = 每个 URL 0.0606 秒 cURL = 每个 URL 0.01235 gethostbynamel = 每个 URL 0.001025 秒

我要做的是首先运行 gethostbynamel() 然后运行 ​​cURL，这应该会减少时间，因为它会一直解析主机，因此 cURL 将永远不会在加载 url 时卡住。

有异议吗？

# asp-classic - 设置与函数的连接

> ID：361204
> 
> 赞同：0
> 
> 时间：2008-12-11T22:17:34.683
> 
> 标签：asp-classic, vbscript, ado

我正在尝试使用 ASP 创建与我的数据库的连接，并且我有以下连接代码：

```
Set objConn = ConnectDB()
Set objRS   = objConn.Execute(query) 
```

我的页面顶部有一个包含文件：

```
<!--#include FILE=dbcano.inc--> 
```

当我调用我的页面时出现此错误：

> Microsoft VBScript 运行时错误“800a01f4”变量未定义：“ConnectDB”patti_trinkets.asp，第 9 行

这`ConnectDB()`是我创建的存储在`dbcano.inc`文件中的函数。

关于为什么我在调用我的页面时收到此错误的任何建议？

我的完整代码可以在这里找到：http: [//pastie.org/337183](http://pastie.org/337183)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T22:29:30.900

你不应该试试

```
ConnectDB(objConn) 
```

反而？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T22:47:10.363

好。它会找到包含文件，因为您没有得到

> “活动服务器页面错误 'ASP 0126'
> 
> 找不到包含文件 找不到包含
> 文件“dbcano.inc”

但是我认为应该返回连接对象的函数 ConnectDB 未被识别为函数，因此它认为它是一个未定义的变量。

要知道为什么，我们真的需要在包含文件中设置代码。

顺便说一句，请确保停止服务器以提供 .inc 文件中的内容。太多次，您会看到已移动 inc 文件的站点，并且某些旧页面提供“未找到包含文件。未找到包含文件“dbhandler.inc””，然后您只需输入 dbhandler。 inc 在浏览器中获取 sql-server 名称/ip、连接字符串和所有内容。这是众所周知的但仍然很常见的事情，只需使用更多关键字搜索错误消息即可获取可利用站点的列表。

# wpf - 单击另一个控件时如何仅使用 XAML 标记打开 WPF 弹出窗口？

> ID：361209
> 
> 赞同：63
> 
> 时间：2008-12-11T22:19:11.683
> 
> 标签：wpf, xaml, popup, eventtrigger

我有两个控件，一个 TextBlock 和一个 PopUp。当用户在文本块上单击 (MouseDown) 时，我想显示弹出窗口。我认为我可以使用弹出窗口上的 EventTrigger 来做到这一点，但我不能在 EventTrigger 中使用设置器，我只能启动故事板。我想在 XAML 中严格执行此操作，因为这两个控件位于模板中，而且我不知道如何在代码中找到弹出窗口。

这就是我在概念上想要做的，但不能因为你不能在 EventTrigger 中放置一个 setter（就像你可以使用 DataTrigger 一样）：

```
<TextBlock x:Name="CCD">Some text</TextBlock>

<Popup>
    <Popup.Style>
        <Style>
            <Style.Triggers>
                <EventTrigger SourceName="CCD" RoutedEvent="MouseDown">
                    <Setter Property="Popup.IsOpen" Value="True" />
                </EventTrigger>
            </Style.Triggers>
        </Style>
    </Popup.Style>
... 
```

当事件发生在不同的控件上时，在 XAML 中严格显示弹出窗口的最佳方式是什么？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-12-30T09:00:15.497

我做了一些简单的事情，但它有效。

我使用了一个典型的 ToggleButton，通过更改其控件模板将其重新设置为文本块。然后我只是将 ToggleButton 上的 IsChecked 属性绑定到弹出窗口上的 IsOpen 属性。Popup 有一些属性，如 StaysOpen，可让您修改关闭行为。

以下适用于 XamlPad。

```
 <StackPanel>
  <ToggleButton Name="button"> 
    <ToggleButton.Template>
      <ControlTemplate TargetType="ToggleButton">
        <TextBlock>Click Me Here!!</TextBlock>
      </ControlTemplate>      
    </ToggleButton.Template>
  </ToggleButton>
  <Popup IsOpen="{Binding IsChecked, ElementName=button}" StaysOpen="False">
    <Border Background="LightYellow">
      <TextBlock>I'm the popup</TextBlock>
    </Border>
  </Popup> 
 </StackPanel> 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-01-20T18:23:48.390

以下方法与 Helge Klein 的方法相同，只是当您单击 Popup 外部的任意位置（包括 ToggleButton 本身）时，弹出窗口会自动关闭：

```
<ToggleButton x:Name="Btn" IsHitTestVisible="{Binding ElementName=Popup, Path=IsOpen, Mode=OneWay, Converter={local:BoolInverter}}">
    <TextBlock Text="Click here for popup!"/>
</ToggleButton>

<Popup IsOpen="{Binding IsChecked, ElementName=Btn}" x:Name="Popup" StaysOpen="False">
    <Border BorderBrush="Black" BorderThickness="1" Background="LightYellow">
        <CheckBox Content="This is a popup"/>
    </Border>
</Popup> 
```

“BoolInverter”用于 IsHitTestVisible 绑定，因此当您再次单击 ToggleButton 时，弹出窗口关闭：

```
public class BoolInverter : MarkupExtension, IValueConverter
{
    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        return this;
    }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is bool)
            return !(bool)value;
        return value;
    }
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return Convert(value, targetType, parameter, culture);
    }
} 
```

[...这显示了将 IValueConverter 和 MarkupExtension 组合在一起](https://gist.github.com/1648802)的便捷技术。

我确实发现了这种技术的一个问题：当屏幕上同时出现两个弹出窗口时，WPF 是错误的。具体来说，如果您的切换按钮位于工具栏中的“溢出弹出窗口”上，则单击它后会打开两个弹出窗口。然后，您可能会发现，当您单击窗口上的其他任何位置时，第二个弹出窗口（您的弹出窗口）将保持打开状态。那时，关闭弹出窗口很困难。用户无法再次单击 ToggleButton 以关闭弹出窗口，因为 IsHitTestVisible 为 false，因为弹出窗口已打开！在我的应用程序中，我不得不使用一些技巧来缓解这个问题，例如主窗口上的以下测试，它说（以 Louis Black 的声音）“如果弹出窗口打开并且用户点击弹出窗口之外的某个位置，关闭该死的弹出窗口。”：

```
PreviewMouseDown += (s, e) =>
{
    // Workaround for popup not closing automatically when 
    // two popups are on-screen at once.
    if (Popup.IsOpen)
    {
        Point p = e.GetPosition(Popup.Child);
        if (!IsInRange(p.X, 0, ((FrameworkElement)Popup.Child).ActualWidth) ||
            !IsInRange(p.Y, 0, ((FrameworkElement)Popup.Child).ActualHeight))
            Popup.IsOpen = false;
    }
};
// Elsewhere...
public static bool IsInRange(int num, int lo, int hi) => 
    num >= lo && num <= hi; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-03-27T10:32:22.430

以下用于`EventTrigger`显示`Popup`. 这意味着我们不需要`ToggleButton`for 状态绑定。在本例中，使用了`Click`事件 a `Button`。您可以调整它以使用另一个元素/事件组合。

```
<Button x:Name="OpenPopup">Popup
    <Button.Triggers>
        <EventTrigger RoutedEvent="Button.Click">
            <EventTrigger.Actions>
                <BeginStoryboard>
                    <Storyboard>
                        <BooleanAnimationUsingKeyFrames 
                                 Storyboard.TargetName="ContextPopup" 
                                 Storyboard.TargetProperty="IsOpen">
                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True" />
                        </BooleanAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger.Actions>
        </EventTrigger>
    </Button.Triggers>
</Button>
<Popup x:Name="ContextPopup"
       PlacementTarget="{Binding ElementName=OpenPopup}"
       StaysOpen="False">
    <Label>Popupcontent...</Label>
</Popup> 
```

请注意，按名称`Popup`引用，`Button`反之亦然。所以和`x:Name="..."`都需要。`Popup``Button`

它实际上可以通过用[这个 SO Answer](https://stackoverflow.com/a/19841714/684096)中描述的自定义 EventTrigger Action替换这些`Storyboard`东西来进一步简化`SetProperty`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-11T22:49:10.423

我在其中的 MouseDown 部分遇到了一些问题，但这里有一些代码可以帮助您入门。

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <Control VerticalAlignment="Top">
            <Control.Template>
                <ControlTemplate>
                    <StackPanel>
                    <TextBox x:Name="MyText"></TextBox>
                    <Popup x:Name="Popup" PopupAnimation="Fade" VerticalAlignment="Top">
                        <Border Background="Red">
                            <TextBlock>Test Popup Content</TextBlock>
                        </Border>
                    </Popup>
                    </StackPanel>
                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="UIElement.MouseEnter" SourceName="MyText">
                            <BeginStoryboard>
                                <Storyboard>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetName="Popup" Storyboard.TargetProperty="(Popup.IsOpen)">
                                        <DiscreteBooleanKeyFrame KeyTime="00:00:00" Value="True"/>
                                    </BooleanAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                        <EventTrigger RoutedEvent="UIElement.MouseLeave" SourceName="MyText">
                            <BeginStoryboard>
                                <Storyboard>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetName="Popup" Storyboard.TargetProperty="(Popup.IsOpen)">
                                        <DiscreteBooleanKeyFrame KeyTime="00:00:00" Value="False"/>
                                    </BooleanAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Control.Template>
        </Control>
    </Grid>
</Window> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-01T09:08:49.433

另一种方法：

```
<Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                    <StackPanel>
                        <Image Source="{Binding ProductImage,RelativeSource={RelativeSource TemplatedParent}}" Stretch="Fill" Width="65" Height="85"/>
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        <Button x:Name="myButton" Width="40" Height="10">
                            <Popup Width="100" Height="70" IsOpen="{Binding ElementName=myButton,Path=IsMouseOver, Mode=OneWay}">
                                <StackPanel Background="Yellow">
                                    <ItemsControl ItemsSource="{Binding Produkt.SubProducts}"/>
                                </StackPanel>
                            </Popup>
                        </Button>
                    </StackPanel>
                </Border> 
```

# c# - MORPG 服务器未捕获断开连接

> ID：361212
> 
> 赞同：2
> 
> 时间：2008-12-11T22:20:07.313
> 
> 标签：c#, disconnect

好的，希望是简单的问题。我已经开始为一个简单的MORPG游戏制作一个简单的服务器，客户端连接，然后断开连接，简单，服务器捕获新客户端，但断开连接时没有捕获，这是怎么回事？

我希望它的一些愚蠢的明显。

这是我的服务器代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.IO;
using System.Threading;

namespace ChaWilPeiBle
{
    public partial class MainForm : Form
    {
        public bool ServerON = false;
        public TcpListener ServerL;
        public int ServerLoad = 2;
        public string ServerINFtxt = "";
        public ASCIIEncoding AE = new ASCIIEncoding();

        public MainForm()
        {
            InitializeComponent();
        }

        private void LBL_SS_Click(object sender, EventArgs e)
        {

        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            LBL_SS.ForeColor = Color.Red;
        }

        public void AddH(string S)
        {
            ServerINFtxt += S;
        }

        public void Server()
        {
            try
            {
                ServerL = new TcpListener(47);
                ServerL.Start();
                AddH("\nServer Started On Port 47");
            }
            catch(Exception e)
            {
                MessageBox.Show("Error starting Server.__________________\n"+e.ToString());
            }
            while (true)
            {
                TcpClient TCPC;
                TCPC = ServerL.AcceptTcpClient();
                if (ServerLoad < 100)
                {
                    Thread T = new Thread(HandleClient);
                    T.Start((object)TCPC);
                }
                else
                {
                    byte[] BYTES = AE.GetBytes("NoAccess:Full");
                    NetworkStream NS = TCPC.GetStream();
                    NS.Write(BYTES, 0, BYTES.Length);
                }
            }
        }

        public void HandleClient(object C)
        {
            ServerLoad++;
            TcpClient Client = (TcpClient)C;
            NetworkStream NS = Client.GetStream();
            AddH("Client Connected.\nServer Load: " + ServerLoad);
            Thread T = new Thread(ReadClient);
            T.Start(C);
            try
            {
                while (true) { NS.Write(AE.GetBytes(""), 0, AE.GetBytes("").Length); }
            }
            catch { }
            ServerLoad--;
            AddH("Client Disconnected.\nServer Load: " + ServerLoad);
        }

        public void ReadClient(object C)
        {
            //TcpClient Client = (TcpClient)C;
        }

        private void startStopToolStripMenuItem_Click(object sender, EventArgs e)
        {
                LBL_SS.Text = "Server On";
                LBL_SS.ForeColor = Color.Green;
                if (ServerON == false)
                {
                    Thread T = new Thread(Server);
                    T.Start();
                }
                ServerON = true;
        }

        private void Update_Tick(object sender, EventArgs e)
        {
            ServerINF.Text = ServerINFtxt;
            PB_SL.Value = ServerLoad;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T00:17:12.523

如果您在网络流上进行阻塞调用以读取并且它返回 0 字节作为它读取的长度，则意味着您的客户端已断开连接。在您尝试写入此连接之前，您不会收到异常。这是我对正在发生的事情的最佳猜测。

# c# - 如何多播使用 DirectShow 捕获的流？

> ID：361220
> 
> 赞同：2
> 
> 时间：2008-12-11T22:22:47.823
> 
> 标签：c#, video, streaming, directshow, multicast

我需要构建一个非常简单的流服务器。它需要能够从设备捕获视频，然后通过多播将该视频流式传输到 LAN 上的多个客户端。

[由于有人用 DirectShow.Net ( http://www.codeproject.com/KB/directx/directxcapture.aspx](http://www.codeproject.com/KB/directx/directxcapture.aspx) )编写的库，这部分的捕获非常容易（在 C# 中）。

我现在的问题是如何多播这个？这是我坚持的部分。我不确定下一步该做什么，或采取什么步骤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T22:29:55.540

没有可以插入和使用的过滤器。

你需要在这里做三件事：

1.  将视频压缩成 MPEG2 或 MPEG4
2.  将其复用到 MPEG 传输流中
3.  广播它

第 1 部分有很多可用的编解码器，有些设备甚至可以输出压缩视频。

第 3 部分也很简单。

主要问题与第 2 部分有关，因为 MPEG 传输流已获得专利。它已获得许可，因此您无法基于它开发自由软件（VLC 和 FFMPEG 违反了该许可），并且您必须支付数百美元才能获得一份规范副本。

如果你必须开发它，你需要：

*   获取 ISO/IEC 13818-1-2000 的副本（您可以从他们的网站下载 PDF 格式），它描述了 MPEG 传输流
*   开发一个渲染器过滤器，它采用 MPEG 基本流并将它们多路复用到传输流中

它必须是渲染器，因为传输流不是转换过滤器。有一些带外数据（程序分配表和参考时钟）需要定期发送，您需要保留一个工作线程来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T11:34:48.787

To achieve that you need to setup/write some kind of video streaming server.

I've used [VideoCapX](http://www.fathsoft.com/videocapx.html) for the same purpose on my project. The documentation and support is not top notch, but it's good enough. It's using WMV streaming technology. The stream is called [MMS](http://en.wikipedia.org/wiki/Microsoft_Media_Services) stream. You can view it with any most media player. I've tested with Windows Media Player, Media Player Classics and VLC. If you would like to see it's capability without writing any code just yet, take a look at [U-Broadcast](http://www.uticasoft.com/products/ubroadcast.htm), it uses VideoCapX to do the job behind the scene.

I've been using DirectShow.Net for almost 2 years, and I still find it hard to write a streaming server myself, due to the complexity of DirectShow technology.

Other than WMV, you can take a look at [Helix Server](https://helixcommunity.org/) or Apple Streaming Server. The latter one is not free, so is WMV Streaming Server from Microsoft.

You can also take a look at VLC or [Windows Media Encoder](http://en.wikipedia.org/wiki/Windows_Media_Encoder) to do streaming straight from the application. But so far I find U-Broadcast out do both of the above. VLC has some compatibility issue with codec and playback from non VLC player, WME has problem with starting up capturing device.

Good Luck

NOTE: I'm not associated with VideoCapX or it's company, I'm just a happy user of it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-12T20:52:17.157

[http://www.codeproject.com/KB/directx/DShowStreamingServer.aspx](http://www.codeproject.com/KB/directx/DShowStreamingServer.aspx)可能会有所帮助，[http ://en.wikipedia.org/wiki/VLC_media_player#cite_note-14](http://en.wikipedia.org/wiki/VLC_media_player#cite_note-14)

VLC 还“应该”能够从任何设备本地流式传输。

# javafx - 如何在 JavaFX 中创建自定义加载屏幕？

> ID：361225
> 
> 赞同：7
> 
> 时间：2008-12-11T22:24:17.913
> 
> 标签：javafx

我想为 JavaFX 应用程序创建一个自定义加载屏幕。不希望用户看到 Java 咖啡杯图标，我想把自己的图形放在那里！

我发现了如何提供静态图像，甚至是动画 GIF，但我对类似 Flash 的屏幕更感兴趣，我可以在其中指定图像在特定百分比下的状态。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-14T18:04:17.140

对于 JavaFX2，您可以设置自定义预加载器。您可以完全控制当时的场景。我没有亲自使用它们，但这可能是你想要的。 [http://docs.oracle.com/javafx/2/deployment/preloaders.htm](http://docs.oracle.com/javafx/2/deployment/preloaders.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T19:12:16.787

如果您按照[此博客条目](http://weblogs.java.net/blog/joshy/archive/2008/08/a_better_applet.html)中所示的方式进行设置，看起来答案将是“否” - 加载图形只是传递给小程序的整体选项的一部分。因为这个小程序可以是任何 java 代码（不仅仅是 javaFX），所以没有办法绑定你的自定义渲染器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-29T20:22:30.807

你应该使用java计时器：

```
Timer tm= new Timer(); 
Stage ilk;
int count;

public  void check() {      

    ilk=new Stage();
    TimerTask mission;

    gorev = new TimerTask() {
        @Override
        public void run() {

            Group root = new Group();     

            Scene scene;
            scene = new Scene(root, 960, 540);
            scene.setFill(Color.BLACK);
            ilk.setScene(scene);
            ilk.setTitle("Splash Screen"); 

            sayac++;
            if(count==5){
                tm.cancel();
                ilk.show();  
            }
        }
    };
    tm.schedule(mission, 0, 2000);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-19T00:56:21.267

更改咖啡杯图标：

```
stage.getIcons().add(new Image("images/myimage.png")); 
```

这里是一个非常清晰的预加载器屏幕和很棒的 css 的参考：http: [//docs.oracle.com/javafx/2/best_practices/jfxpub-best_practices.htm](http://docs.oracle.com/javafx/2/best_practices/jfxpub-best_practices.htm)

# java - 来自 IE 中的 servlet 的持久 cookie

> ID：361231
> 
> 赞同：6
> 
> 时间：2008-12-11T22:26:47.410
> 
> 标签：java, internet-explorer, servlets, cookies

我有一个从 servlet 生成的 cookie，我希望它是持久的——也就是说，设置 cookie，关闭 IE，重新启动它，仍然能够读取 cookie。我正在使用的代码如下：

```
HttpServletResponse response = 
    (HttpServletResponse) FacesContext.getCurrentInstance()
    .getExternalContext().getResponse();

Cookie cookie = new Cookie("someKey", "someValue");
cookie.setMaxAge(7 * 24 * 60 * 60);
response.addCookie(cookie); 
```

这在 Firefox 中效果很好，但在 IE 6/7 中，cookie 不会在浏览器重新启动之间保存。我已经检查了我在设置中能想到的所有内容，但无法弄清楚是什么导致 cookie 被删除。据我所知，使用正数调用 setMaxAge 会使 cookie 持久化。任何想法为什么会出错？

**编辑**

我已经使用 Olaf 建议的更多信息技巧验证了 cookie 正在尝试设置为会话 cookie，而不是持久性 cookie；最大年龄设置为“会话结束”。所以似乎没有为 IE 设置最大年龄 - 我已经验证在 Firefox 中，最大年龄设置正确。我仍然不知道发生了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-27T16:39:14.293

我对 Java 或 servlet 一无所知，但 IE 只会在 cookie 有过期日期的情况下保留它，设置 max-age 是不够的，IE 将继续将其视为会话 cookie。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T23:20:03.620

几个建议。

1.  您是否使用 fqdn 访问该站点？
2.  使用[fiddler](http://www.fiddlertool.com/fiddler/)检查 cookie 在 http 响应中的外观。
3.  检查 Internet 上的其他站点是否成功存储 cookie。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-10T14:38:32.620

这个[http://www.mail-archive.com/users@tomcat.apache.org/msg52249.html](http://www.mail-archive.com/users@tomcat.apache.org/msg52249.html)有答案，但并没有真正解释原因。

也就是说，通过编码@（这是版本 0 cookie 中不可接受的字符），在响应中发送的 cookie 将其版本设置为 0（IE 可接受）而不是 1（格式不同，因此 IE 不可接受）。

我的问题是一样的。我们对我们的 cookie 值进行 Base64 编码并将其发送下来。但是，Base64 包含像 '=' ... 这样的字符，这在版本 0 中也是非法的，因此 IE 无法接受。

留给我的谜团是：堆栈的某些部分足够“聪明”，可以识别 cookie 值作为版本 0 cookie 无效，并决定将响应作为版本 1 cookie 发送（其中包括明确的版本号、 “不可接受的”字符、max-age 而不是 expires 字段等）我不知道是 Tomcat、Faces、Spring 还是 javax.servlet 决定翻转版本。

底线：对 cookie 值的 URI 编码将确保设置给浏览器的 cookie 是版本 0，因此由 IE 持久化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-14T10:52:17.877

因为我不使用 Windows，所以这是一些模糊的记忆：如果您将 IE cookie 设置设置为每次设置 cookie 时“请求许可” - 它不显示 cookie 应该有效多长时间？此外，您可能希望将站点添加到另一个安全区域（本地或任何被调用的区域）以获得完全不同的设置，然后再试一次。

希望这可以帮助...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-15T17:34:15.770

我在 IE8 上也有类似的问题，除了使用 http 时 cookie 持续存在，而使用 https 时没有。智力乌龟的解决方案对我有用，因为我有 '=' 和其他字符在那里搞砸了。在我对 https cookie 进行编码之前，它在“会话结束”时显示为过期。在对值进行编码后，它会随着我传入的 maxAge 过期。这是我在设置之前和检索 cookie 值之前对 cookie 值进行编码/解码的方法：

```
public static String encodeString(String s) {
    String encodedString = s;

    try{
        encodedString = URLEncoder.encode(s, "UTF-8");
    } catch (UnsupportedEncodingException e) {}

    return encodedString;
}
public static String decodeString(String s) {
    String decodedString = s;

    try{
        decodedString = URLDecoder.decode(s, "UTF-8");
    } catch (UnsupportedEncodingException e) {}

    return decodedString;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-08T09:37:10.493

```
 try{
        encodedString = URLEncoder.encode(s, "UTF-8");
    } catch (UnsupportedEncodingException e) {}

    return encodedString;`a`
}
public static String decodeString(String s) {
    String decodedString = s;

    try{
        decodedString = URLDecoder.decode(s, "UTF-8");
    } catch (UnsupportedEncodingException e) {}

    return decodedString;
} 
```

# php - 在 $_SESSION 变量中缓存变量？

> ID：361245
> 
> 赞同：10
> 
> 时间：2008-12-11T22:30:05.437
> 
> 标签：php, session, caching

我正在制作一个 php Web 应用程序，它存储不与其他用户共享的用户特定信息。

将其中一些信息存储在 $_SESSION 变量中以进行缓存是否是个好主意？例如：缓存用户为其帐户创建的类别列表。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T22:40:30.410

只要您牢记这一点，这将是对会话机制的适当使用：

*   会话不会无限期地持续下去。
*   从会话中提取时，确保您确实得到了结果（如果会话已过期/清除，ASP.NET 将返回 NULL）
*   服务器重新启动可能会擦除会话缓存。
*   这样做是为了方便，而不是性能。对于高性能缓存，选择合适的机制（即[memcached](http://www.danga.com/memcached/)）

一个好的使用模式应该是这样的（ether cookies 或 session）：

*   用户登录
*   在会话/cookie 中存储首选项（背景颜色、最近查看的 10 条记录、类别）。
*   在呈现页面时，请参考 Session/Cookie 值（确保它们是有效值而不是 null）。

不能在 cookie 中做的事情

*   不要存储任何敏感的东西（使用会话）。
*   cookie 值不应授予/拒绝您访问任何内容（使用会话）。
*   陷阱错误，假设标志和字符串可能不是您所期望的，可能会丢失，可能会在传输过程中更改。

我敢肯定还有其他事情需要考虑，但这只是我的想法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T22:43:45.083

这可能适用于相对少量的数据，但您必须考虑一些事项：

1.  $_SESSION 存储在请求、磁盘或数据库上的文件或其他内容之间的某个位置，具体取决于您选择使用的内容（默认为文件）
2.  $_SESSION 对单个机器上的单个用户是本地的。
3.  会话有一个 TTL（生存时间），它们会在一段时间后消失（由您控制​​）
4.  在某些情况下，会话可能会阻塞（很少出现问题，但我遇到了流式闪存）如果您要缓存的数据要被多个用户访问，那么最好单独缓存它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T23:53:18.657

如果您只希望这些数据在他们的会话期间可用，那么可以。如果您希望它明天或现在 4 小时后可用，则需要将其保存到数据库中。

从技术上讲，您可以修改会话以拥有很长的生命周期，但要意识到如果他们使用不同的计算机、不同的浏览器或刷新他们的 cookie，他们将失去到他们的会话的链接，因此任何严重的事情你都应该在您的应用程序，将会话链接到他们的帐户并将数据保存在渗透的地方。

# ruby-on-rails - Rails 中的常量值

> ID：361247
> 
> 赞同：25
> 
> 时间：2008-12-11T22:30:10.523
> 
> 标签：ruby-on-rails, ruby, constants

我有一些数据想要存储在我的 Rails 应用程序的某个位置，因为我使用它来生成表单字段、检查提交的表单以确保其值有效等。基本上，我希望数据在一个位置，因为我利用它在几个地方。

以前，我`initialize`在控制器中定义一个方法并在该方法中初始化实例变量，例如`@graph_types = ['bar', 'line']`. 这似乎是一个坏主意，因为这实际上是全部`initialize`用于（初始化这些值）并且实例变量可以稍后更改，这是我不想要的。

现在，我在控制器中的任何方法之外定义常量，就在过滤器之后的顶部，然后冻结它们，例如`GraphTypes = ['bar', 'line'].freeze`.

我不想将这些数据存储在配置文件中，因为那样我就必须跟踪一个额外的文件，读入文件并解析它等等。我不想将这些数据存储在数据库中，因为那样似乎有点矫枉过正；我不需要做任何疯狂的 LEFT OUTER JOIN 类型的查询，将可用的图形类型与我的另一个常量相结合，比如`Themes = ['Keynote', 'Odeo', '37 Signals', 'Rails Keynote'].freeze`. 我不想将数据存储在 environment.rb 中，因为该数据仅与特定控制器有关。

考虑到这一切，我是否要采用这种“Ruby 方式”？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-13T02:45:42.540

对于不真正属于其他任何地方的常量，我有一个 StaticData 类。

```
 class StaticData

    GRAPH_TYPES = ['bar', 'line']

    SOMETHING_ELSE = ['A', 'B']

  end 
```

然后我得到它

```
StaticData::GRAPH_TYPES 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-11-09T22:33:23.667

[我之前对类似问题写](https://stackoverflow.com/questions/3856737/where-how-to-code-constants-in-rails-3-application/5814314#5814314)的相同答案适用并发布，因为该答案仍然出现在搜索结果中。

在控制器中放置一个常数是有意义的，因为常数直接与它相关。否则应将常量放在专用的初始化文件中：`Rails.root/config/initializers/constants.rb`.

根据 application.rb 中列出的评论：

```
# Application configuration should go into files in config/initializers
# -- all .rb files in that directory are automatically loaded 
```

[这在 Rails 3 中仍然有效。](https://github.com/rails/rails/blob/master/railties/lib/rails/generators/rails/app/templates/config/application.rb)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-11T23:03:16.010

我相信您目前正在做的事情很好；你说数据只属于一个控制器，因此它属于它。如果多个控制器需要它，或者如果它们比常量值更复杂，则其他方法可能有意义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T08:54:38.577

是的，你正在做的很好。不过，将常量称为 Ruby 更为惯用`GRAPH_TYPES`。

顺便说一句，我会避免`initialize`在你的控制器中定义。似乎它可能会导致麻烦。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T10:19:21.993

我同意 IDBD 和 Paradisepete 的一些观点。在模型中使用常量将是最好的方法，这样控制器会很瘦，而模型会很胖。请参阅[Rails 视图提示](http://zilkey.com/2008/5/5/rails-view-tips) 例如，如果您有一个指标控制器链接到一个指标模型。在度量模型类 Metric < ActiveRecord::Base GRAPHTYPES = ['bar', 'line']

然后在视图中你可以做类似的事情

f.select :graph_type, Metric::GRAPHTYPES

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T16:53:32.673

如果您正在生成与某些资源相关的表单，那么将其存储在模型中将是一个很好的变体。您不需要将其存储在数据库中，因为它可以是简单的类或实例变量/方法。

同样的想法也适用于验证。如果您正在验证资源/模型实例，那么将验证参数存储在模型类中将是合理的选择。

无论如何，它将更接近“厚模型和薄控制器”模式，然后是您提到的任何变体。

# regex - VbScript 中的正则表达式？

> ID：361248
> 
> 赞同：1
> 
> 时间：2008-12-11T22:30:43.470
> 
> 标签：regex, email, asp-classic, vbscript

VbScript 是否有 Regex 的本机实现？我需要验证旧 ASP 应用程序上的电子邮件地址。

任何指针都会很棒。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-18T14:32:19.147

Since the top answer here is in VB6 I thought I'd add one here in VBScript (since that's what the question is asking for):-

```
Option Explicit

Function GetEmailValidator()

  Set GetEmailValidator = New RegExp

  GetEmailValidator.Pattern = "^((?:[A-Z0-9_%+-]+\.?)+)@((?:[A-Z0-9-]+\.)+[A-Z]{2,4})$"

  GetEmailValidator.IgnoreCase = True

End Function

Dim EmailValidator : Set EmailValidator = GetEmailValidator() 
```

Now some tests:-

```
Response.Write EmailValidator.Test("") = False
Response.Write EmailValidator.Test(" ") = False
Response.Write EmailValidator.Test("somebody@domain.co.uk") = True
Response.Write EmailValidator.Test("someone@domain.com") = True
Response.Write EmailValidator.Test("some.body@domain.co.uk") = True
Response.Write EmailValidator.Test("broken@domain..co.uk") = False
Response.Write EmailValidator.Test("@oops.co.uk") = False
Response.Write EmailValidator.Test("name") = False
Response.Write EmailValidator.Test("name@uk") = False
Response.Write EmailValidator.Test("name@uk") = False
Response.Write EmailValidator.Test("name@domain.abcde") = False 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T22:40:26.227

这个例子是来自[LessThanDot的 AlexCuse](http://wiki.lessthandot.com/index.php/Using_Regular_Expressions_For_Pattern_Matching_in_Access)

```
Function ValidEmail(ByVal emailAddress) 

'this function will use regular expressions to check an '
'email address for validity '

'instantiate regex object container, output boolean '
Dim objRegEx, retVal 

'using late binding, vbscript reference is not required '
Set objRegEx = CreateObject("VBScript.RegExp") 

'.pattern -looks for a valid email address '
With objRegEx 
      .Pattern = "^\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$" 
      .IgnoreCase = True 
End With 

retVal = objRegEx.Test(emailAddress) 

'get rid of RegEx object '
Set objRegEx = Nothing 

ValidEmail = retVal 

End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T22:42:09.797

是的，确实如此。[这是微软的文档](http://msdn.microsoft.com/en-us/library/yab2dx62(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T22:47:31.907

就像其他人说的，是的。我只是想让您了解 devguru [vbscript](http://www.devguru.com/Technologies/vbscript/quickref/vbscript_list.html)文档，我发现它们往往是获得快速 vbscript 答案的好地方。这是[Regexp](http://www.devguru.com/Technologies/vbscript/quickref/regexp.html)对象的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T13:51:00.687

VBScript 有一个内置的 RegExp 对象，它是微软对 JavaScript 正则表达式的实现。我的网站上有[一篇关于 VBScript RegExp 对象](http://www.regular-expressions.info/vbscript.html)的文章，解释了如何使用它。

# c# - 为什么在 .net 2.0 中将 null 转换为原语（即：int）会引发 null ref 异常而不是无效的转换异常？

> ID：361258
> 
> 赞同：3
> 
> 时间：2008-12-11T22:34:43.087
> 
> 标签：c#, .net, .net-2.0, casting

我正在浏览一些代码，并遇到了我的组合框尚未初始化的情况。这是在 .NET 2.0 和以下代码中，this.cbRegion.SelectedValue 为空。

```
int id = (int)this.cbRegion.SelectedValue; 
```

此代码引发了一个空引用异常，而不是一个无效的强制转换异常。我想知道是否有人知道为什么它会抛出空引用异常而不是无效转换？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T22:43:28.000

它与[装箱](http://www.csharphelp.com/archives/archive100.html)和拆箱有关。它试图从盒子中取出一个 int（拆箱），但该对象为空，因此在它获得要转换的更改之前，您会得到一个空引用异常。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T22:49:32.700

如果你编译

```
object o = null;
int a = (int)o; 
```

并查看 MSIL 代码，您会看到类似

```
ldnull
...
unbox.any int32 
```

现在 unbox.any 的行为指定如下：

> 如果 obj 不是装箱类型，则会引发 InvalidCastException。
> 
> 如果 obj 是空引用，则会引发 NullReferenceException。

这就是您在代码中看到的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T22:39:26.433

它试图在投射之前读取对象。因此，您得到的是空异常而不是强制转换异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T22:40:49.050

例外是选定的值为空的值。它甚至从来没有进入演员阵容。

# java - 是否可以编写一个返回 T 的类对象的方法？

> ID：361266
> 
> 赞同：2
> 
> 时间：2008-12-11T22:37:15.283
> 
> 标签：java, generics

如果我有一个这样的基类

```
public abstract class XMLSubscription <T extends XMLMessage> 
```

是否可以在 XMLSubscription 中编写返回 T 的类对象的方法？

我想出的唯一可能的解决方案是让 XMLSubscription 的每个后代都有一个类似的方法：

```
public class XMLStatusSubscription extends XMLSubscription<XMLStatusMessage>
{
   public Class <XMLStatusMessage> getExpectedMessageType()
   {        
     return XMLStatusMessage.class;
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T22:45:43.643

不幸的是 - 是的，这是由于类型擦除 - 如果不以`Class`某种方式在运行时提供它，就无法返回对象。

幸运的是，这通常不会太难。这是我通常这样做/看到它完成的方式：

```
public abstract class XMLSubscription <T extends XMLMessage> {
    private Class<T> messageType;

    protected XMLSubscription(Class<T> messageType) {
        this.messageType = messageType;
    }

    public Class<T> getExpectedMessageType() {
        return this.messageType;
    }
}

public class XMLStatusSubscription extends XMLSubscription<XMLStatusMessage> {

    public XMLStatusSubscription() {
        super(XMLStatusMessage.class);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T22:51:06.190

如您所料，编译器会删除 T 。当您实例化对象时，它不知道它应该处理*XMLStatusMessage*对象。您的基类将定义以下模板方法，并且 1.5 的协变返回类型将使编译器对具体的子类感到满意：

```
public Class<T> getExpectedMessageType() 
```

有一个元注释：这看起来很像程序代码，其中调用*getExpectedMessageType()*然后根据返回类型采取行动。使用访问者模式可能会更好地实现这一点，访问者为*XMLMessage*的每个子类实现“doSomething”方法。

# php - PHP 中的网络爬虫链接/页面逻辑

> ID：361285
> 
> 赞同：1
> 
> 时间：2008-12-11T22:45:01.647
> 
> 标签：php, hyperlink, logic, web-crawler

我正在编写一个基本的爬虫，它只是用 PHP 缓存页面。

它所做的只是`get_file_contents`用来获取网页的内容和正则表达式来获取所有链接`<a href="URL">DESCRIPTION</a>`- 在它返回的那一刻：

```
Array {
[url] => URL
[desc] => DESCRIPTION
} 
```

我遇到的问题是弄清楚确定页面链接是否是本地的或是否可能位于完全不同的本地目录中的逻辑。

它可以是任意数量的组合：即`href="../folder/folder2/blah/page.html"`或`href="google.com"`或`href="page.html"`- 可能性是无穷无尽的。

解决这个问题的正确算法是什么？我不想丢失任何可能很重要的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T22:55:02.690

首先，正则表达式和 HTML 不能混用。采用：

```
foreach(DOMDocument::loadHTML($source)->getElementsByTagName('a') as $a)
{
  $a->getAttribute('href');
} 
```

可能超出您网站的链接以协议或开头`//`，即

```
http://example.com
//example.com/ 
```

`href="google.com"`是指向本地文件的链接。

但是，如果您想创建站点的静态副本，为什么不使用`wget`?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T19:16:14.613

让我们首先考虑本地链接的属性。

这些将是：

*   *没有*计划*也没有*主人的**亲戚*，或*
**   *绝对*的，带有“http”或“https”的方案以及与运行脚本的机器相匹配的*主机**

 *这就是您需要确定链接是否为本地的所有逻辑。

使用**[parse_url](http://php.net/parse_url)**函数分离出 URL 的不同组成部分，以识别*方案*和*主机*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T01:38:59.580

您必须在 href 中查找 http://。否则，您可以确定它是否以 ./ 或“./”的任何组合开头。如果您没有找到“/”，那么您将不得不假设它是一个文件。你想要一个脚本吗？

# sql-server - 具有自动完成功能、占用内存小且免费的良好数据库客户端（MS SQL Server）？

> ID：361289
> 
> 赞同：0
> 
> 时间：2008-12-11T22:46:07.510
> 
> 标签：sql-server, database, client, squirrel-sql

有什么建议吗？

目前我正在使用 Squirell，但它消耗了一些内存......我只是使用 sql 客户端运行一些查询并获得结果，但我绝对需要自动完成表、列等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T23:04:43.793

SQL Server Management Studio Express（智能感知仅适用于 Sql Server 2008）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T23:02:54.887

制作 SQLCompare 的 RedGate 有一个名为 SQL Prompt 的工具，它提供：

*   智能代码完成，用于快速、准确的脚本构建
*   便于代码可读性的脚本布局
*   跨数据库和链接服务器查询支持
*   与 SSMS、SSMS Express、查询分析器和 Visual Studio 集成
*   关键字格式化、代码片段集成、列选择器和更多功能

我只试用了 14 天的免费试用，用起来真的很好。我主要在查询分析器中工作，它在那里工作得很好。

[http://www.red-gate.com/products/SQL_Prompt/index.htm](http://www.red-gate.com/products/SQL_Prompt/index.htm)

不错的演示视频： [http ://www.red-gate.com/products/SQL_Prompt/video.htm](http://www.red-gate.com/products/SQL_Prompt/video.htm)

# php - PHP中的自然语言单位转换？

> ID：361296
> 
> 赞同：2
> 
> 时间：2008-12-11T22:47:03.500
> 
> 标签：php, nlp, units-of-measurement

我正在寻找一个可以从字符串中提取重量/高度数据的库（最好是 PHP）。

我希望我的用户输入诸如“我重 80 k，我身高 1.8m”甚至“220 lb”和“6' 1”之类的内容，并将其传递给可以提取数量和单位的函数。

有谁知道那里有类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T23:51:43.230

[Convert Measurements 1.1](http://webscripts.softpedia.com/script/Snippets/Convert-measurements-10141.html)执行您提到的许多转换以及更多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-01T18:40:10.627

您可能还想查看[Universal Converter](http://www.universalconverter.net)，它进行的转换比这些更多，开发人员致力于 NLP 支持。

# asp.net-mvc - ASP.NET MVC 缓存因控制器操作参数而异

> ID：361301
> 
> 赞同：3
> 
> 时间：2008-12-11T22:48:11.970
> 
> 标签：asp.net-mvc, caching, outputcache

有什么方法可以通过使用[outputcache](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute(v=vs.108).aspx)属性的控制器操作参数来改变缓存？如果我的参数以 REST 方式嵌入在 URL 中，我们有[varybyparam 。](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.varybyparam(v=vs.108).aspx)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T18:39:38.803

在 Action 方法中实现“VaryByParam”并不意味着“通过传递给该操作方法的参数而变化”也很重要。它的意思是“因传递给作为 HTTP 参数的操作方法的参数而异”。

```
[OutputCache(CacheProfile = "ContentPage", VaryByParam = "mode")]
public ActionResult Index(string key, string mode)
{

} 
```

假设此操作方法的路线是：

```
 routes.MapRoute(
   "video-route-short",
   "video/{key}",
   new { controller = "Video", action = "Index", key = (string)null }
  ); 
```

正如克雷格上面所说，关键参数是 URL 的一部分，因此缓存不适用于它 - 所以它基本上总是被缓存。

将通过 ' `?mode=1`' 类型发送的模式参数将应用于缓存。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T13:54:21.037

默认情况下，缓存以这种方式工作。不同的 URL 给出不同的缓存位置。也许您的问题中缺少一些东西，但是，如前所述，它已经以这种方式工作。

# sql - Oracle：如何获取刚刚插入的行的序列号？

> ID：361304
> 
> 赞同：23
> 
> 时间：2008-12-11T22:49:36.663
> 
> 标签：sql, oracle

如何获取刚刚插入的行的序列号？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-11T22:51:11.993

插入...返回。

```
declare
   s2 number;
 begin
   insert into seqtest2(x) values ('aaa') returning seq into s2;
   dbms_output.put_line(s2);
 end; 
```

这里的“seq”是指您要将其值存储到变量 s2 中的列的名称。

在蟒蛇中：

```
myseq=curs.var(cx_Oracle.NUMBER)
curs.prepare("insert into seqtest2(x) values('bbb') returning seq into :x")
curs.execute(None, x=myseq)
print int(myseq.getvalue()) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-11T23:15:25.457

**编辑：**正如 Mark Harrison 所指出的，这假设您可以控制插入记录的 id 的创建方式。如果您对此有完全的控制权和责任感，那么这*应该*可以...

* * *

使用存储过程执行插入并返回 id。

例如：对于带有 id 的名称表：

```
PROCEDURE insert_name(new_name    IN   names.name%TYPE, 
                      new_name_id OUT  names.id%TYPE)
IS
    new_id names.id%TYPE;
BEGIN
    SELECT names_sequence.nextVal INTO new_id FROM dual;
    INSERT INTO names(id, name) VALUES(new_id, new_name);
    new_name_id := new_id;
END; 
```

无论您是否不使用 ORM 层，对 CRUD 操作使用存储过程都是一个好主意，因为它使您的代码更加与数据库无关，有助于防止注入攻击等。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-03-30T14:12:55.770

我在 C# 中的回答，考虑到表“testtable”有一个“ID”列作为 PK 与 autoinc 序列和字段“testname”是一个 varchar 字段。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Oracle.DataAccess.Client;
using System.Data;

namespace ConsoleApplication3
{
class Program
{

    public static void Main(string[] args)
    {

        OracleConnection cn = new OracleConnection("your connection string here");

        string sql = "INSERT INTO testtable(testname) VALUES('testing2') RETURNING id INTO :LASTID";
        OracleParameter lastId = new OracleParameter(":LASTID", OracleDbType.Int32);

        lastId.Direction = ParameterDirection.Output;

        using (OracleCommand cmd = new OracleCommand(sql, cn))
        {
            cn.Open();
            cmd.Parameters.Add(lastId);
            cmd.ExecuteNonQuery();
            Console.WriteLine("Last ID: " + lastId.Value.ToString());
            cn.Close();
        }
        Console.WriteLine();
        Console.ReadKey(false);

    }
}
} 
```

# lamp - 我可以将 LAMP+AJAX 用于（几乎）实时系统吗？

> ID：361305
> 
> 赞同：0
> 
> 时间：2008-12-11T22:49:43.650
> 
> 标签：lamp, real-time, latency

我有一个作为 Windows 应用程序构建的当前系统，并且非常接近实时地执行某些任务。网络中有节点与我们的自定义服务器通信、通信状态以及发送和接收命令。

我们正在寻求迁移到 Web 部署平台。节点，比如说其中的 60-100 个，需要与服务器通信，并快速显示给客户端。我说的是毫秒，而不是秒。网络连接为 LAN/100mbit 或千兆位，从客户端到服务器的连接可靠快速。节点通信也很小，已经以XML消息的形式发送，规模不大，数量也不多。

我们的系统架构师有信心并向我们保证，这可以通过 LAMP + AJAX 完成。我个人以前曾参与过类似的系统，我对保证如此接近实时的消息传递持怀疑态度。

为了进行健全性检查，我错了吗？这可以用 LAMP 或任何类似的语言来完成（很好）吗？（不是 Java，我知道启动的 Java 小程序可以做到这一点）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T22:55:38.663

如果您谈论的是近实时应用程序，例如消息传递程序而不是实际实时，那么它可以完成。该技术被称为“长轮询”或[彗星](http://en.wikipedia.org/wiki/Comet_(programming))，并已被几家主要的网络初创公司（例如[Meebo ）成功使用。](http://www.meebo.com/)

HTML 5 规范还包括一个内置的[消息 API](http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html)，它应该真正推动这些技术成为主流，因为它在下一代浏览器（以及当前一代的一些浏览器）中实现。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-12-11T23:01:30.180

这其中的 AJAX 部分很好。Lightstreamer 和其他 Comet（Http 服务器推送）服务器等产品可以提供近乎实时的通信。

等式中的 LAMP 部分是让我担心的部分。你可能需要一个自定义的后端来实现高性能。洛杉矶的部分很好。您的申请需要可能会导致您重新考虑 MP。

# c# - C# 铸造性能影响

> ID：361307
> 
> 赞同：20
> 
> 时间：2008-12-11T22:51:00.950
> 
> 标签：c#

在 C# 中使用 'as' 关键字进行失败的强制转换时，将返回 null。后台发生了什么？它只是简单地抑制异常，因此我不必为失败编写处理代码吗？

与包裹在 try-catch 中的典型演员相比，我对它的性能特征很感兴趣。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-11T22:54:48.133

它使用 IL 指令[`isinst`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.isinst.aspx)来执行转换，而不是[`castclass`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.castclass.aspx)使用转换时使用的指令。这是一条特殊指令，如果它有效则执行强制转换，否则留`null`在堆栈中。所以不，它不只是抑制异常，而且比这样做要快几个数量级。

`isinst`请注意，指令之间的行为存在一些差异`castclass`- 主要的是`isinst`不考虑用户定义的强制转换运算符，它只考虑直接继承层次结构，例如，如果您定义以下两个没有继承层次结构但显式转换运算符：

```
class A
{
    public int Foo;
}

class B
{
    public int Foo;

    public static explicit operator B(A a)
    {
        return new B { Foo = a.Foo };
    }
} 
```

那么以下将成功：

```
var a = new A { Foo = 3 };
var b = (B)a;
Console.WriteLine(b.Foo); // prints 3 
```

但是，以下内容无法编译，出现错误“无法通过引用转换、装箱转换、拆箱转换、包装转换或空类型转换将类型 'A' 转换为 'B'”

```
var a = new A { Foo = 3 };
var b = a as B; 
```

因此，如果您确实设置了任何用户定义的强制转换（出于这个原因和其他原因，这对于引用类型通常是一个坏主意），那么您应该意识到这种差异。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T23:52:41.060

并添加到格雷格的优秀帖子......

第一次在运行时引用新类型时，CLR 将一个名为`COREINFO_CLASS_STRUCT`（或类似的）结构加载到内存中，其中包含指向`COREINFO_CLASS_STRUCT`该对象派生自的基类的对象的指针……这有效地`COREINFO_CLASS_STRUCT`为 Type 的继承链创建一个对象链表，该链在`COREINFO_CLASS_STRUCT`for中终止`System.Object`。当您执行`isinst`, （或类似的方法`castclass`）时，它只需找到`COREINFO_CLASS_STRUCT`您正在检查的对象的具体类型的内存结构，并遍历此链接列表以查看您尝试转换为的类型是否在列表中。

它还包含一个指向单独数组的指针，该数组包含该类型实现的所有接口，如果您尝试强制转换为接口，则必须单独搜索该数组。

# c++ - C++ 开发 GUI - 类？

> ID：361312
> 
> 赞同：1
> 
> 时间：2008-12-11T22:51:57.157
> 
> 标签：c++, user-interface, winapi, class

我不得不说我在 C++ 方面相当缺乏经验，不要对我太苛刻。

最近偶然发现了 win32 API 的奇妙之处，并选择练习使用它（此时我宁愿不使用 MFC/wxWidgets/etc，仅用于教育目的）。

好吧，我真正的问题是：您如何正确地将您的 win32 GUI 内容编码到类中。我的意思是，当然，您可以创建一个类来保存单个窗口句柄，允许更轻松地修改窗口属性，并具有更简化的 CreateWindow() 版本。但据我了解，您将需要一个消息泵和几个回调函数来创建您创建的窗口。将它们与类结合起来是如何工作的？

谁能在这里指出我正确的方向？只要有注释，我不介意阅读（很多）示例代码。

PS：我也很难找到关于将“资源文件”用于我的窗口装饰的良好（阅读：简单）文档。为此加分！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T22:57:58.360

我以 C++ 编程为生。我喜欢 C++。

也就是说，如果您在 .Net（例如 C#）中使用 Windows GUI，您的生活将会轻松得多。Win32 是非常低级的，您将构建大量可以通过 .Net 库免费获得的东西。Win32 不再是一个奇迹。:-)

如果你想学习 C++，选择 GUI 以外的东西来做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T22:57:43.057

我个人会使用 MFC 而不是在这里重新发明轮子。但是，如果您坚持需要一个应用程序对象，该对象在程序运行时被实例化，并且包含消息循环和将消息转发到正确窗口对象的机制。

至少，MFC 就是这样做的。我不确定 MFC 源代码是否可供下载，但如果您可以访问 Visual C++ 安装盘（任何版本），您应该能够在您的计算机上安装源代码以进行查看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T23:05:13.620

查看 MFC 或 ATL/WFC。如果你想重新发明轮子，最好的参考来源就是轮子本身，特别是因为源代码很容易获得。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T23:20:36.567

当我使用 Win32 API（后来转向 Linux 和跨平台解决方案）时，我遇到的最大问题是回调。特别是 winproc 一，又名消息泵。我发现[了这个](http://www.winterdom.com/dev/cpp/class.html)，这应该是一个很好的提示。当我推出自己的包装纸时，我按照该页面的建议进行了操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T00:47:47.047

我建议阅读Paul Dilascia 的[Windows++](https://rads.stackoverflow.com/amzn/click/com/020160891X)。它带您完成在 Windows API 之上用 C++ 构建类库的整个过程。它是为 16 位 Windows 编写的，但书中介绍的所有概念仍然适用。另外，你可以很便宜地买到它，因为它“过时”了。

并确保您了解消息饼干 ( `#include <windowsx.h>`)，它们可以防止您拔出过多的头发。;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T23:12:19.033

我建议不要重新发明轮子的唯一原因是您既不是 C++ 专家，也不是 Win32 API。试图同时学习两个不相关的科目不会有成效。如果您想在 C++ 方面做得更好，请为您非常了解的主题编写一个库。如果您想学习 Win32 API，请在为其创建（或使用）包装器之前对其进行原始编程以了解其工作原理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T23:26:21.207

[Reliable Software](http://www.relisoft.com/win32/index.htm)站点上有一个非常好的 C++ Windows API 教程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T23:37:21.747

了解这一点的最佳方法是阅读查尔斯·佩佐德的原著。他很好地展示了如何设置基本消息循环以及如何构建将各种事件路由到处理程序的语句。这里真正的问题是，通过重新发明一切，您将花费数小时编写和调试 Windows 事件处理代码，而不是编写自己的应用程序。

除非您有令人信服的理由自己这样做，否则使用其他人的构造（如 MFC）会更好地为您服务。

我看到自己编写所有这些代码的唯一原因是，如果您想在切换到 MFC 或类似的东西之前对它的工作原理有一个基本的了解。至少通过这种方式，您可以在永远忘记它之前了解它是如何工作的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T16:47:41.157

许多年前，我开发了一组类来封装 API（我们不能使用 MFC 的各种原因）。我从 MFC 源代码中学到了很多东西。

关键是每个窗口都有一个 UserInfo 数据成员——你可以用它做任何你想做的事情。您想要使用它的是类的**this**指针。

现在，另一个棘手的问题是消息处理程序回调函数不能是普通的类成员函数，因为 Windows 使用 C 调用而不是 C++。所以你的回调必须是静态的。但是，由于您已经保存了类的**this**指针，因此只需获取类的用户信息，将其转换为您的类的 this 指针，然后调用您需要的任何（非静态）类函数。

如果你计划得当，继承会很好地工作，包括窗口本身展示的所有继承（即，一个编辑是一个控件是一个窗口）。

# ruby - 使用soap4r从ruby生成soap消息时如何将name.value添加到标头

> ID：361313
> 
> 赞同：2
> 
> 时间：2008-12-11T22:52:22.553
> 
> 标签：ruby, attributes, header, element, soap4r

我从 wsdl 创建了一个驱动程序

当我调用我的请求时，我希望标头包含一个元素，即，我希望看到如下内容：

REPLACE_WITH_ACTUAL 等等等等

然而，环顾四周，每个人都在谈论继承 SOAP::Header::SimpleHandler 然后将一个实例注入到 driver.headerhandler

但是，如果我这样做，那么我最终会得到一个嵌套标题，即 REPLACE_WITH_ACTUAL

所以必须有一种方法可以将一个元素添加到现有的 headerhandler 中，这样我就可以做类似的事情

driver.headerhandler.AddElement（“会话”，“123”）

但我找不到任何方法来做到这一点。我也尝试过类似的东西

driver.headerhandler["session"]="123" 和其他类似的技巧，但我找不到任何方法来完成这项工作。

查看 driver.headerhandler.methods，我看不到任何明显的机制。

真的很感激一个指向如何做到这一点的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T19:29:41.250

好吧，我团队中的一位同事在查看了我之前发现的一些典型示例后解决了上述问题，包括[http://dev.ctor.org/soap4r/browser/trunk/sample/soapheader/authheader/中的示例客户端2.r​​b](http://dev.ctor.org/soap4r/browser/trunk/sample/soapheader/authheader/client2.rb)

事实证明，微不足道的（叹息）解决方案是替换

```
def on_simple_outbound
  if @sessionid
     { "sessionid" => @sessionid }
  end
end 
```

和

```
def on_simple_outbound
  if @sessionid
     @sessionid
  end
end 
```

现在，如果您只是将标头命名为“会话”（在 QName 创建中），您将得到未嵌套的标头，这正是我想要的。

我想我会在其他人可能遇到同样问题的情况下将我的解决方案粘贴到我自己的问题上。

# apache-flex - 带有单个切片的饼图标签

> ID：361316
> 
> 赞同：3
> 
> 时间：2008-12-11T22:54:02.427
> 
> 标签：apache-flex, charts

我正在使用 Flex 中的 PieChart 和 PieSeries 组件，但遇到了问题。当 PieSeries 的 labelPosition 属性设置为“inside”并且饼图中只有一个切片时，标签不会显示。

查看文档，我猜它的一些怪癖与删除内部标签的时间有关。文档内容如下：

> 在图表内绘制标签，在每个楔形的大约十分之七处居中。收缩标签以确保它们不会相互干扰。如果标签缩小到 calloutPointSize 属性下方，请将其移除。当两个标签重叠时，Flex 会优先考虑较大切片的标签。

一种解决方法是检测 1 个切片并将另一个元素添加到具有零值的 dataProvider 中，但显示的标签仍然不是我想要的位置，而且似乎没有办法移动它。

另一种解决方案是用画布包装 PieChart，并以与我用于标签的格式相同的格式在顶部呈现文本，但我真的不想走这条路（包括在图表的画布上呈现文本，这可能稍微少一点黑客，但仍然是黑客）。

这是一些演示我的问题的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application
  xmlns:mx="http://www.adobe.com/2006/mxml"
  layout="vertical"
  backgroundColor="white"
  >

  <mx:Script>
    <![CDATA[
      import mx.collections.ArrayCollection;
      [Bindable] public var pieData:ArrayCollection = new ArrayCollection([
        {value: 50, label: "This is a\nlong label"}
      ]);
      [Bindable] public var pieData2:ArrayCollection = new ArrayCollection([
        {value: 50, label: "This is a\nlong label"},
        {value: 0, label: ""}
      ]);
    ]]>
  </mx:Script>

  <mx:HBox
    width="100%"
    height="100%"
    >
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData }"
          field="value"
          labelField="label"
          labelPosition="callout"
          />
      </mx:series>
    </mx:PieChart>
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData }"
          field="value"
          labelField="label"
          labelPosition="insideWithCallout"
          />
      </mx:series>
    </mx:PieChart>
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData }"
          field="value"
          labelField="label"
          labelPosition="inside"
          />
      </mx:series>
    </mx:PieChart>
  </mx:HBox>

  <mx:HBox
    width="100%"
    height="100%"
    >
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData2 }"
          field="value"
          labelField="label"
          labelPosition="callout"
          />
      </mx:series>
    </mx:PieChart>
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData2 }"
          field="value"
          labelField="label"
          labelPosition="insideWithCallout"
          />
      </mx:series>
    </mx:PieChart>
    <mx:PieChart
      width="100%"
      height="100%"
      >
      <mx:series>
        <mx:PieSeries
          dataProvider="{ pieData2 }"
          field="value"
          labelField="label"
          labelPosition="inside"
          />
      </mx:series>
    </mx:PieChart>
  </mx:HBox>

</mx:Application> 
```

有没有人遇到过这个问题或知道解决方法/好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T11:10:57.730

我所能做的就是指出[这个错误报告](http://bugs.adobe.com/jira/browse/FLEXDMV-1569)，它看起来就是你遇到的。

恐怕我无法让建议的补丁正常工作，也许你会有更好的运气。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:58:43.947

Flex 图表旨在通过 CartesianDataCanvas 绘制。

*请参阅Flex Data Visualization Developer's Guide / Flex Charting Components / Using Events and Effects in Charts 中的*“在图表控件上绘图”

 *干杯

# ajax - 将图像从剪贴板粘贴到网站

> ID：361324
> 
> 赞同：9
> 
> 时间：2008-12-11T22:56:34.637
> 
> 标签：ajax, image, clipboard

我需要想出一个解决方案，让用户能够将图像粘贴到网站上，然后将该图像上传到 Web 服务器。我不确定什么是正确的解决方案 - 我很确定 javascript 是不可能的，因为我认为它不能处理二进制剪贴板数据（或任何剪贴板数据？）

所以，我不确定该怎么做。Java小程序可以做到这一点吗？或者可能是 Flash SWF？还有其他选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-04-06T13:27:24.787

或者这个[免费的](http://lassebunk.dk/2009/08/04/clipboard-java-applet/)（通过另一个 StackOverflow 问题）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-21T08:21:27.283

您可以为此使用纯 JavaScript，假设是 Chrome 或 Chrome Frame。由于大多数其他插件或小程序都需要特定的安装操作，因此您可能还需要安装[Chrome Frame](http://code.google.com/chrome/chromeframe/)，因为这将修复的不仅仅是粘贴事件。

[查看干净地包装 HTML Clipboard API 的 jQuery 插件的现场演示](http://strd6.com/2011/09/html5-javascript-pasting-image-data-in-chrome/)。此演示需要 Chrome 浏览器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T23:14:38.000

[Rad 上传](http://www.radinks.com/upload/applet.php)（Java 小程序）。它不是免费的，但相对便宜。

# php - PHP 中的持久 HTTP GET 变量

> ID：361329
> 
> 赞同：4
> 
> 时间：2008-12-11T23:00:41.570
> 
> 标签：php, http, get, methods

假设我有一些这样的代码

```
if(isset($_GET['foo']))
  //do something

if(isset($_GET['bar']))
  //do something else 
```

如果用户在 example.com/?foo=abc 并单击链接以设置 bar=xyz，我想轻松地将他们带到 example.com/?foo=abc&bar=xyz，而不是 example.com/?bar =xyz。

我可以想到一些非常混乱的方法来做到这一点，但我确信有一些我不知道并且无法通过谷歌追踪的更干净的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T23:18:44.777

这是一种方法....

```
//get passed params
//(you might do some sanitizing at this point)
$params=$_GET;

//morph the params with new values
$params['bar']='xyz';

//build new query string
$query='';
$sep='?';
foreach($params as $name=>$value)
{
    $query.=$sep.$name.'='.urlencode($value);
    $sep='&';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T23:19:19.457

如果您正在更新查询字符串，则需要确保您不执行类似的操作

```
$qs="a=1&b=2";
$href="$qs&b=4";
$href contains "a=1&b=2&b=4" 
```

如果需要，您真正想要做的是覆盖当前密钥。您可以使用这样的功能。（免责声明：离开我的头顶，可能有点窃听）

```
 function getUpdateQS($key,$value)
    {
       foreach ($_GET as $k => $v)
       {
            if ($k != $key)
            {
                $qs .= "$k=".urlencode($v)."&"
            }
            else
            {
                $qs .= "$key=".urlencode($value)."&";
            }
        }
        return $qs
    }

    <a href="reports.php?<?getupdateqs('name','byron');?">View report</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T23:06:34.193

如果已经设置了 foo ，只需设置将 bar 更改为 xyz 的链接也具有 foo=abc 。

```
$link = ($_GET['foo'] == 'abc') ? 'foo=abc&bar=xyz' : 'bar=xyz';
?>
<a href="whatever.php?<?= $link ?>">Click Me</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T23:07:12.320

您必须使用正确的 URL 查询字符串呈现链接才能实现这一点。这是您最终需要根据系统设置方式做出的设计决策。

我有一些网站有这个问题，我所做的是设置一个查询字符串全局变量，将当前页面数据设置为页面请求的顶部。

然后，当我渲染页面时，如果我需要使用当前的查询字符串，我会执行以下操作：

```
echo '<a href="myurl.php' . querystring . '&bar=foo'; 
```

它不是最干净的，但这完全取决于您的系统如何工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T00:22:46.707

保存一些代码并使用内置的[http_build_query](http://us3.php.net/manual/en/function.http-build-query.php)。我在我的一个项目中使用了这个包装器：

```
function to_query_string($array) {
    if(is_scalar($array)) $query = trim($array, '? \t\n\r\0\x0B'); // I could split on "&" and "=" do some urlencode-ing here
    else $query = http_build_query($array);
    return '?'.$query;
} 
```

此外，虽然它不经常使用，但您可以将 $_GET 放在赋值的左侧：

```
$_GET['overriden_or_new'] = 'new_value';
echo '<a href="'.to_query_string($_GET).'">Yeah!</a>'; 
```

除此之外，按照保罗迪克森所说的去做。

# visual-studio-2005 - VS2005 中的 SSE4 指令？

> ID：361330
> 
> 赞同：3
> 
> 时间：2008-12-11T23:00:51.570
> 
> 标签：visual-studio-2005, assembly, sse

我需要在使用 Visual Stdio 2005 编译的项目中使用 popcnt 指令
。内在函数`__popcnt()`仅适用于 VS2008，即使我在`__asm {}`块中编写，编译器似乎也无法识别该指令。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T01:45:49.020

[好的，这是一个疯狂的猜测，但是……假设您已经像这样](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/3e24f203-c516-41e2-a7bf-325452157336/)设置 VS2005来执行汇编语言，那么您可以从 Intel 获得[SSE4.1 手册](http://www.developers.net/filestore2/download/2550)并为每个 SSE4.1 操作码编写一个宏您需要根据masm32.com 上的此[线程（讨论 SSE2 的类似问题。）](http://www.masm32.com/board/index.php?topic=973.0)

例如，下面是从 masm32 链接下载的一些代码：

```
;SSE2 macros for MASM 6.14 by daydreamer aka Magnus Svensson

ADDPD MACRO M1,M2
    db 066h
    ADDPS M1,M2
ENDM

ADDSD MACRO M1,M2
    DB 0F2H
    ADDPS M1,M2
ENDM 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T12:19:16.890

作为一个小提示，您可以使用 __emit 将字节放入 VC++ 中的 __asm 块中。在很多情况下，这比与 masm 生成的对象链接要容易。我过去在 SSE3 是新的时候使用过这个（并且 VS 2003 不支持操作码）。

所有操作码[都由 Intel 详细记录](http://softwarecommunity.intel.com/isn/Downloads/Intel%20SSE4%20Programming%20Reference.pdf)。

# visual-studio-2008 - ASP.NET VS2008 Ajax 问题

> ID：361333
> 
> 赞同：1
> 
> 时间：2008-12-11T23:02:15.997
> 
> 标签：visual-studio-2008, asp.net-ajax, intellisense

我正在使用VS2008 Pro，问题如下。

我需要添加例如。

```
<asp:ScriptManager ID="ScriptManager1" runat="server"/>

<ajaxToolkit:FilteredTextBoxExtender ID="Filter1" runat="server" ValidChars="AEIOU" TargetControlID="TextBox1"></ajaxToolkit:FilteredTextBoxExtender> 
```

这个问题是`<ajaxToolkit........`没有被智能感知检测到的。我添加了参考`AjaxControlToolkit.dll`，但我仍然无法使用它们

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T22:29:34.190

我相信问题是你还没有注册 tagPrefix。

尝试将以下行添加到您的 web.config。

```
<pages>
  <controls>
    <add tagPrefix="ajaxToolkit" namespace="AjaxControlToolkit" assembly="AjaxControlToolkit"/>
  </controls>
</pages> 
```

这应该放在 system.web 部分。您可能已经定义了页面/控件部分，在这种情况下，只需将“添加”元素添加到控制部分。

# c# - C# 中的泛型集合是什么？

> ID：361336
> 
> 赞同：27
> 
> 时间：2008-12-11T23:02:57.557
> 
> 标签：c#, .net, generics

我正在尝试建立我的第一个通用列表并遇到了一些问题。我知道声明看起来像“ `List<T>`”，我`using System.Collections.Generic;`在页面顶部有。但是，Visual Studio 无法识别该`T`变量。

我错过了什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-12-11T23:10:32.657

`List<T>`意味着`List<WhateverTypeYouWantItToBeAListOf>`。例如：

如果我有一个员工类，并且我想要一个员工集合，我可以说：

```
List<Employee> employeeList = new List<Employee>(); 
```

然后我可以将`Employee`对象添加到该列表中，并使其成为类型安全的并扩展到我放入其中的任何员工对象。

像这样：

```
Employee emp1 = new Employee();
Employee emp2 = new Employee();

employeeList.Add(emp1);
employeeList.Add(emp2); 
```

`employeeList`现在持有`emp1`和`emp2`作为对象。

通用集合有几个方面，最重要的是它们提供了一种独立于对象的方式来拥有一个......好吧......对象集合。它们是类型安全的；这意味着任何集合都将包含一种类型的对象。你不会有一个`Animal`实例`List<Employee>`（当然，除非 Employee 是一个`Animal`继承自的基类。但是，在这一点上，你有更大的问题。

使用泛型编程是它自己的主题，值得（至少）在一本书中写一章。在非常高的层次上，使用泛型编程提供了另一种重用代码的方法——独立于任何类层次结构或特定类的实现细节。

更多信息[在这里](http://missingmanuals.com/pub/a/dotnet/2005/06/20/generics.html)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-11T23:06:22.680

您需要替换`T`另一种类型，例如`int`,`string`或您创建的类：

```
List<int> values = new List<int>();

values.Add(1);
values.Add(2);

int secondNumber = values[1]; // Yay! No casting or boxing required! 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-11T23:06:14.630

例如，如果您想要一个通用的整数列表 ( `int`)，您可以编写：

```
List<int> list = new List<int>(); 
```

`T`是一个类型参数，在您的代码中应该是一个实际类型。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T17:21:27.890

使“通用列表”通用的原因在于，您可以使用同一个类来创建苹果列表和土豆列表。当然，一旦您使用`new`操作员创建了一个列表，您就必须决定您希望它存储哪些对象，并通过将您存储的对象的类型名称放在`<>`.

以下行实际上告诉编译器：

```
List<Employee> employeeList = new List<Employee>(); 
```

“嘿，我需要一个可以处理类型对象的列表`Employee`；并且命名为`employeeList`！”

您以这种方式获得的列表对象不再是通用的。它只会接受和返回 type 的对象`Employee`。但是列表的行为是以“通用”方式定义的，并不关心它实际使用的是什么对象。它只是在内部调用它们' `T`'，因为对于列表应该做的所有事情，它的内容类型并不重要。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-11T23:14:29.153

考虑`T`为变量名。您必须指定其值，即。使通用类“特定”。因此，您可以创建`List<string>`、`List<int>`或`List`任何您想要的东西。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-11T23:07:03.727

您声明一个 Foo 对象列表，如下所示：

```
List<Foo> fooList; 
```

类型名称中的 是您在实例化它时放入通用列表的“真实”类型对象的占位符。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-12T17:04:07.347

当您执行 a 时`List<Object>`，请确保您的 Object 类是公开的。在默认的 VS 安装中，类作为“内部”开箱即用 - 这意味着您无法列出它们，因为它们比您声明的公共列表更难访问。

这让我……昨天。愚蠢的默认值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-11T23:04:16.837

您是在尝试使用 List 类还是在尝试构建自己的类？你的代码现在是什么样子的？

# winapi - 增加 GetOpenFileName 文件选择对话框的文件名字段中的字符数

> ID：361350
> 
> 赞同：5
> 
> 时间：2008-12-11T23:05:24.510
> 
> 标签：winapi, visual-c++, openfiledialog

我们的应用程序允许在通过 GetOpenFileName 函数显示的文件选择对话框中选择多个文件（这个问题也适用于使用 CFileDialog 等的人......）

可以在文件名字段中输入的字符数似乎是有限制的（259 似乎是一个神奇的数字——不知道为什么）。

[我们已尝试更改OPENFILENAME](http://msdn.microsoft.com/en-us/library/ms646839(VS.85).aspx)结构的以下成员：

lpstrFile - 指向我们自己的缓冲区，大小为 4K 字节 nMaxFile - 设置为 lpstrFile 的大小（我们正在编译 ANSI，所以这实际上是 4000

但是这些值似乎不会增加对话框中文件名字段的输入宽度。

我将尝试向控件发送 EM_SETLIMITTEXT 消息，但想知道其他人是否有解决方案。

编辑 - 自己解决了这个问题：[解决方案](https://stackoverflow.com/questions/361350/increase-number-of-characters-in-filename-field-of-getopenfilename-file-selecti#394443) 我不能接受我自己的答案，但这是为了后代。如果其他人有更好的解决方案，请发布 - 或者随时修改我的解决方案，以便未来的搜索者可以在顶部找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T23:18:01.307

原来编辑控件（至少在我的开发环境中）是一个组合框，所以`EM_SETLIMITTEXT`不合适。

相反，我`GetDlgCtrl`在文件打开对话框的父级上使用组合框（我在`OnInitDialog`处理程序中执行此操作），将其转换为`CComboBox*`，然后调用`LimitText()`以设置限制。

这也可以通过向`CB_LIMITTEXT`那些不与`CFileDialog`. 这里合适的值很可能`OPENFIILENAME.nMaxFile`就是传入的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T23:08:59.213

从[在 MSDN 上命名文件或目录](http://msdn.microsoft.com/en-us/library/aa365247.aspx)：

> 在 Windows API（以下段落中讨论的一些例外情况）中，路径的最大长度为`MAX_PATH`，定义为 260 个字符。

即使您可以从对话框中强制使用更长的字符串，在使用针对`MAX_PATH`.

文档继续说：

> Windows API 有许多函数也有 Unicode 版本，以允许最大总路径长度为 32,767 个字符的扩展长度路径。这种类型的路径由由反斜杠分隔的组件组成，每个组件都达到 GetVolumeInformation 函数的 lpMaximumComponentLength 参数中返回的值。要指定扩展长度的路径，请使用`"\\?\"`前缀。例如， `"\\?\D:\<very long path>"`。（此处使用的字符`<` `>`是为了清晰起见，不能作为有效路径字符串的一部分。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T23:12:37.240

我相信这是一个无法绕过的硬性限制。唯一重要的是当您要选择多个文件时，因为该限制足以满足最大文件名长度。

我在这些对话框中添加了一个“所有文件”按钮，用于打开文件夹中的所有文件；这是我找到的唯一解决方法。

# html - 使用嵌套 DIV 时，如何从 IE 获得所需的 z-index 行为？

> ID：361359
> 
> 赞同：0
> 
> 时间：2008-12-11T23:08:27.950
> 
> 标签：html, css, internet-explorer

我有三个 DIV，如下所示：

```
<div id="header">
    ...
</div>
<div id="content">
    <div id="popup">
        ...
    </div>
</div> 
```

DIV#header 是“位置：固定”，用作屏幕顶部的非滚动标题。DIV#content 中有一些内容，并且是“位置：相对”。DIV#popup 是“位置：绝对”，开始隐藏并在悬停时显示。

我希望弹出窗口位于页面的最高级别，因此如果它们重叠，它甚至高于 DIV#header。这在 Firefox 中运行良好，但在 IE 中，弹出窗口位于标题后面。我可以通过将 DIV#content 的 z-index 设置为高于标题来解决此问题，但是当然，当它们重叠时，DIV#content 也会显示在 DIV#header 上方，这是我不想要的。

听起来我可能会受到[此页面](http://annevankesteren.nl/2005/06/z-index)上描述的内容的影响。但是，据我了解，可以在所有元素上设置默认 z-index，如下所示：

```
* {
    z-index: 1
} 
```

应该解决这个问题（因为现在每个元素的 z-index 都会显式设置为 1），但是不是在 IE 中修复这个问题，而是在 Firefox 中破坏它（这样 Firefox 现在的行为类似于 IE）。

IE 中 z-indexes 的真正意义是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T23:52:17.223

IE 中有一个错误，我认为 IE8 已修复该错误，其中 z-index 堆栈为页面中存在的每个位置相对上下文重置。意味着不同相对定位容器内的 z-index 是独立的。

您描述的错误可能是相关的。尝试通过将弹出窗口定位在鼠标单击位置来替换相对位置。

另一个链接： [http ://therealcrisp.xs4all.nl/ie7beta/css_zindex.html](http://therealcrisp.xs4all.nl/ie7beta/css_zindex.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T00:10:46.310

如果 DIV#popup 应该总是出现在所有其他元素的顶部，为什么不把它提升到 DOM 的顶层呢？

```
<div id="header">
    ...
</div>
<div id="content">
    ...
</div>
<div id="popup">
    ...
</div> 
```

# c - 如何使用 ANSI C 以毫秒为单位测量时间？

> ID：361363
> 
> 赞同：144
> 
> 时间：2008-12-11T23:09:50.007
> 
> 标签：c, portability, time-precision

仅使用 ANSI C，有没有办法以毫秒或更高的精度测量时间？我正在浏览 time.h 但我只找到了第二个精度函数。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-12-12T00:08:42.383

没有提供优于 1 秒时间分辨率的 ANSI C 函数，但 POSIX 函数[`gettimeofday`](http://www.opengroup.org/onlinepubs/000095399/functions/gettimeofday.html)提供微秒分辨率。时钟功能仅测量进程执行所花费的时间量，并且在许多系统上并不准确。

你可以像这样使用这个函数：

```
struct timeval tval_before, tval_after, tval_result;

gettimeofday(&tval_before, NULL);

// Some code you want to time, for example:
sleep(1);

gettimeofday(&tval_after, NULL);

timersub(&tval_after, &tval_before, &tval_result);

printf("Time elapsed: %ld.%06ld\n", (long int)tval_result.tv_sec, (long int)tval_result.tv_usec); 
```

这会`Time elapsed: 1.000870`在我的机器上返回。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-12-15T16:05:13.563

```
#include <time.h>
clock_t uptime = clock() / (CLOCKS_PER_SEC / 1000); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-12-19T09:09:42.383

我总是使用 clock_gettime() 函数，从 CLOCK_MONOTONIC 时钟返回时间。返回的时间是以秒和纳秒为单位的时间量，从过去某个未指定的时间点开始，例如纪元的系统启动。

```
#include <stdio.h>
#include <stdint.h>
#include <time.h>

int64_t timespecDiff(struct timespec *timeA_p, struct timespec *timeB_p)
{
  return ((timeA_p->tv_sec * 1000000000) + timeA_p->tv_nsec) -
           ((timeB_p->tv_sec * 1000000000) + timeB_p->tv_nsec);
}

int main(int argc, char **argv)
{
  struct timespec start, end;
  clock_gettime(CLOCK_MONOTONIC, &start);

  // Some code I am interested in measuring 

  clock_gettime(CLOCK_MONOTONIC, &end);

  uint64_t timeElapsed = timespecDiff(&end, &start);
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2016-06-20T10:28:32.170

**实施便携式解决方案**

正如这里已经提到的那样，对于时间测量问题没有足够精确的适当的 ANSI 解决方案，我想写一下如何获得便携式的方法，如果可能的话，还有一个高分辨率的时间测量解决方案。

**单调时钟与时间戳**

一般来说，时间测量有两种方式：

*   单调时钟；
*   当前（日期）时间戳。

第一个使用单调时钟计数器（有时称为滴答计数器），它以预定义的频率对滴答进行计数，因此如果您有一个滴答值并且频率已知，您可以轻松地将滴答转换为经过的时间。实际上并不能保证单调时钟以任何方式反映当前系统时间，它也可能会计算自系统启动以来的滴答声。但它保证无论系统状态如何，时钟始终以递增的方式运行。通常频率与硬件高分辨率源绑定，这就是它提供高精度的原因（取决于硬件，但大多数现代硬件对高分辨率时钟源没有问题）。

第二种方式提供基于当前系统时钟值的（日期）时间值。它也可能具有较高的分辨率，但它有一个主要缺点：这种时间值会受到不同的系统时间调整的影响，即时区更改、夏令时 (DST) 更改、NTP 服务器更新、系统休眠等在。在某些情况下，您可以获得负的经过时间值，这可能导致未定义的行为。实际上这种时间源不如第一种可靠。

因此，时间间隔测量的第一条规则是尽可能使用单调时钟。它通常具有很高的精度，并且设计可靠。

**后备策略**

在实施便携式解决方案时，值得考虑一种备用策略：如果可用，则使用单调时钟，如果系统中没有单调时钟，则使用时间戳方法。

**视窗**

MSDN 上有一篇很棒的文章，名为[Acquiring high-resolution time stamps](https://msdn.microsoft.com/ru-ru/library/windows/desktop/dn553408(v=vs.85).aspx)，介绍了 Windows 上的时间测量，其中描述了您可能需要了解的有关软件和硬件支持的所有详细信息。要在 Windows 上获取高精度时间戳，您应该：

*   [使用QueryPerformanceFrequency](https://msdn.microsoft.com/ru-ru/library/windows/desktop/ms644905(v=vs.85).aspx)查询计时器频率（每秒滴答声）：

    ```
    LARGE_INTEGER tcounter;
    LARGE_INTEGER freq;    

    if (QueryPerformanceFrequency (&tcounter) != 0)
        freq = tcounter.QuadPart; 
    ```

    定时器频率在系统启动时是固定的，因此您只需获取一次。

*   [使用QueryPerformanceCounter](https://msdn.microsoft.com/ru-ru/library/windows/desktop/ms644904(v=vs.85).aspx)查询当前刻度值：

    ```
    LARGE_INTEGER tcounter;
    LARGE_INTEGER tick_value;

    if (QueryPerformanceCounter (&tcounter) != 0)
        tick_value = tcounter.QuadPart; 
    ```

*   将刻度缩放到经过的时间，即微秒：

    ```
    LARGE_INTEGER usecs = (tick_value - prev_tick_value) / (freq / 1000000); 
    ```

根据 Microsoft 的说法，在大多数情况下，在 Windows XP 和更高版本上使用这种方法应该不会有任何问题。但您也可以在 Windows 上使用两种备用解决方案：

*   [GetTickCount](https://msdn.microsoft.com/en-us/library/ms724408.aspx)提供自系统启动以来经过的毫秒数。它每 49.7 天包装一次，因此在测量更长的间隔时要小心。
*   [GetTickCount64](https://msdn.microsoft.com/en-us/library/ms724411.aspx)是 64 位版本`GetTickCount`，但从 Windows Vista 及更高版本开始可用。

**OS X (macOS)**

OS X (macOS) 有自己的马赫绝对时间单位，代表单调时钟。最好的开始方法是 Apple 的文章[Technical Q&A QA1398: Mach Absolute Time Units](https://developer.apple.com/library/mac/qa/qa1398/_index.html)，它描述了（带有代码示例）如何使用特定于 Mach 的 API 来获取单调刻度。还有一个关于它的本地问题，称为[Mac OS X](https://stackoverflow.com/questions/5167269/clock-gettime-alternative-in-mac-os-x)中的 clock_gettime 替代方案，最后可能会让您有点困惑如何处理可能的值溢出，因为计数器频率以分子和分母的形式使用。因此，一个简短的示例如何获取经过的时间：

*   获取时钟频率分子和分母：

    ```
    #include <mach/mach_time.h>
    #include <stdint.h>

    static uint64_t freq_num   = 0;
    static uint64_t freq_denom = 0;

    void init_clock_frequency ()
    {
        mach_timebase_info_data_t tb;

        if (mach_timebase_info (&tb) == KERN_SUCCESS && tb.denom != 0) {
            freq_num   = (uint64_t) tb.numer;
            freq_denom = (uint64_t) tb.denom;
        }
    } 
    ```

    你只需要这样做一次。

*   查询当前刻度值`mach_absolute_time`：

    ```
    uint64_t tick_value = mach_absolute_time (); 
    ```

*   使用先前查询的分子和分母将刻度缩放到经过的时间，即微秒：

    ```
    uint64_t value_diff = tick_value - prev_tick_value;

    /* To prevent overflow */
    value_diff /= 1000;

    value_diff *= freq_num;
    value_diff /= freq_denom; 
    ```

    防止溢出的主要思想是在使用分子和分母之前将刻度按比例缩小到所需的精度。由于初始计时器分辨率以纳秒为单位，我们将其除以`1000`得到微秒。您可以在 Chromium 的[time_mac.c](https://chromium.googlesource.com/chromium/src/base/+/master/time/time_mac.cc)中找到相同的方法。如果您真的需要纳秒级精度，请考虑阅读[如何使用 mach_absolute_time 而不会溢出？](https://stackoverflow.com/questions/23378063/how-can-i-use-mach-absolute-time-without-overflowing).

**Linux 和 UNIX**

`clock_gettime`调用是在任何 POSIX 友好系统上的最佳方式。它可以从不同的时钟源查询时间，我们需要的是`CLOCK_MONOTONIC`. 并非所有系统都`clock_gettime`支持`CLOCK_MONOTONIC`，因此您需要做的第一件事是检查其可用性：

*   如果`_POSIX_MONOTONIC_CLOCK`定义为一个值`>= 0`，则意味着它`CLOCK_MONOTONIC`是可用的；
*   如果`_POSIX_MONOTONIC_CLOCK`定义了`0`它意味着您应该另外检查它是否在运行时工作，我建议使用`sysconf`：

    ```
    #include <unistd.h>

    #ifdef _SC_MONOTONIC_CLOCK
    if (sysconf (_SC_MONOTONIC_CLOCK) > 0) {
        /* A monotonic clock presents */
    }
    #endif 
    ```

*   否则不支持单调时钟，您应该使用后备策略（见下文）。

的用法`clock_gettime`非常简单：

*   获取时间值：

    ```
    #include <time.h>
    #include <sys/time.h>
    #include <stdint.h>

    uint64_t get_posix_clock_time ()
    {
        struct timespec ts;

        if (clock_gettime (CLOCK_MONOTONIC, &ts) == 0)
            return (uint64_t) (ts.tv_sec * 1000000 + ts.tv_nsec / 1000);
        else
            return 0;
    } 
    ```

    我在这里将时间缩减到微秒。

*   用同样的方法计算与上一次收到的时间值的差：

    ```
    uint64_t prev_time_value, time_value;
    uint64_t time_diff;

    /* Initial time */
    prev_time_value = get_posix_clock_time ();

    /* Do some work here */

    /* Final time */
    time_value = get_posix_clock_time ();

    /* Time difference */
    time_diff = time_value - prev_time_value; 
    ```

最好的后备策略是使用`gettimeofday`调用：它不是单调的，但它提供了相当好的分辨率。这个想法与 with 相同`clock_gettime`，但要获得时间值，您应该：

```
#include <time.h>
#include <sys/time.h>
#include <stdint.h>

uint64_t get_gtod_clock_time ()
{
    struct timeval tv;

    if (gettimeofday (&tv, NULL) == 0)
        return (uint64_t) (tv.tv_sec * 1000000 + tv.tv_usec);
    else
        return 0;
} 
```

同样，时间值缩小到微秒。

**SGI IRIX**

[IRIX](https://en.wikipedia.org/wiki/IRIX)有`clock_gettime`调用，但缺少`CLOCK_MONOTONIC`. 相反，它有自己的单调时钟源`CLOCK_SGI_CYCLE`，您应该使用它而不是`CLOCK_MONOTONIC`with `clock_gettime`。

**Solaris 和 HP-UX**

Solaris 有自己的高分辨率计时器接口`gethrtime`，它以纳秒为单位返回当前计时器值。虽然较新版本的 Solaris 可能有，但如果您需要支持旧的 Solaris 版本`clock_gettime`，您可以坚持使用。`gethrtime`

用法很简单：

```
#include <sys/time.h>

void time_measure_example ()
{
    hrtime_t prev_time_value, time_value;
    hrtime_t time_diff;

    /* Initial time */
    prev_time_value = gethrtime ();

    /* Do some work here */

    /* Final time */
    time_value = gethrtime ();

    /* Time difference */
    time_diff = time_value - prev_time_value;
} 
```

HP-UX 缺少`clock_gettime`，但它支持`gethrtime`您应该以与在 Solaris 上相同的方式使用。

**操作系统**

[BeOS](https://en.wikipedia.org/wiki/BeOS)也有它自己的高分辨率计时器接口`system_time`，它返回自计算机启动以来经过的微秒数。

示例用法：

```
#include <kernel/OS.h>

void time_measure_example ()
{
    bigtime_t prev_time_value, time_value;
    bigtime_t time_diff;

    /* Initial time */
    prev_time_value = system_time ();

    /* Do some work here */

    /* Final time */
    time_value = system_time ();

    /* Time difference */
    time_diff = time_value - prev_time_value;
} 
```

**操作系统/2**

[OS/2](https://en.wikipedia.org/wiki/OS/2)有自己的 API 来检索高精度时间戳：

*   `DosTmrQueryFreq`使用（对于 GCC 编译器）查询计时器频率（每单位滴答声）：

    ```
    #define INCL_DOSPROFILE
    #define INCL_DOSERRORS
    #include <os2.h>
    #include <stdint.h>

    ULONG freq;

    DosTmrQueryFreq (&freq); 
    ```

*   使用以下命令查询当前刻度值`DosTmrQueryTime`：

    ```
    QWORD    tcounter;
    unit64_t time_low;
    unit64_t time_high;
    unit64_t timestamp;

    if (DosTmrQueryTime (&tcounter) == NO_ERROR) {
        time_low  = (unit64_t) tcounter.ulLo;
        time_high = (unit64_t) tcounter.ulHi;

        timestamp = (time_high << 32) | time_low;
    } 
    ```

*   将刻度缩放到经过的时间，即微秒：

    ```
    uint64_t usecs = (prev_timestamp - timestamp) / (freq / 1000000); 
    ```

**示例实现**

您可以查看实现上述所有策略的[plibsys](https://github.com/saprykin/plibsys)库（有关详细信息，请参见 ptimeprofiler*.c）。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-03-18T22:39:21.887

**`timespec_get`从 C11**

返回最多纳秒，四舍五入到实现的分辨率。

看起来像是来自 POSIX' 的 ANSI 盗版`clock_gettime`。

示例：`printf`在 Ubuntu 15.10 上每 100 毫秒执行一次：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

static long get_nanos(void) {
    struct timespec ts;
    timespec_get(&ts, TIME_UTC);
    return (long)ts.tv_sec * 1000000000L + ts.tv_nsec;
}

int main(void) {
    long nanos;
    long last_nanos;
    long start;
    nanos = get_nanos();
    last_nanos = nanos;
    start = nanos;
    while (1) {
        nanos = get_nanos();
        if (nanos - last_nanos > 100000000L) {
            printf("current nanos: %ld\n", nanos - start);
            last_nanos = nanos;
        }
    }
    return EXIT_SUCCESS;
} 
```

[C11 N1570 标准草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)7.27.2.5“timespec_get 函数说” ：

> 如果 base 是 TIME_UTC，则 tv_sec 成员设置为自实现定义的纪元以来的秒数，截断为整数，并且 tv_nsec 成员设置为整数纳秒，四舍五入为系统时钟的分辨率。(321)
> 
> 321) 尽管 struct timespec 对象以纳秒分辨率描述时间，但可用分辨率取决于系统，甚至可能大于 1 秒。

C++11 还得到了`std::chrono::high_resolution_clock`：[C++ Cross-Platform High-Resolution Timer](https://stackoverflow.com/questions/1487695/c-cross-platform-high-resolution-timer)

**glibc 2.21 实现**

可以在下面找到[`sysdeps/posix/timespec_get.c`](https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/posix/timespec_get.c;h=2609b2e72998aacc4ea537430c2278ebbf51b83a;hb=4e42b5b8f89f0e288e68be7ad70f9525aebc2cff)：

```
int
timespec_get (struct timespec *ts, int base)
{
  switch (base)
    {
    case TIME_UTC:
      if (__clock_gettime (CLOCK_REALTIME, ts) < 0)
        return 0;
      break;

    default:
      return 0;
    }

  return base;
} 
```

很清楚：

*   `TIME_UTC`目前仅支持

*   它转发到`__clock_gettime (CLOCK_REALTIME, ts)`，这是一个 POSIX API： http: [//pubs.opengroup.org/onlinepubs/9699919799/functions/clock_getres.html](http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_getres.html)

    Linux x86-64 有一个`clock_gettime`系统调用。

    请注意，这不是一种防故​​障的微基准测试方法，因为：

    *   `man clock_gettime`表示如果您在程序运行时更改某些系统时间设置，此度量可能会出现不连续性。当然，这应该是一个罕见的事件，您可以忽略它。

    *   这会测量挂墙时间，因此如果调度程序决定忘记您的任务，它似乎会运行更长时间。

    由于这些原因`getrusage()`，它可能是一个更好的 POSIX 基准测试工具，尽管它的最大精度较低。

    更多信息请参见：[在 Linux 中测量时间 - time vs clock vs getrusage vs clock_gettime vs gettimeofday vs timespec_get？](https://stackoverflow.com/questions/12392278/measure-time-in-linux-getrusage-vs-clock-gettime-vs-clock-vs-gettimeofday)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T00:15:16.457

您可能获得的最佳精度是通过使用仅 x86 的“rdtsc”指令，它可以提供时钟级分辨率（当然必须考虑 rdtsc 调用本身的成本，这可以在应用程序启动）。

这里的主要问题是测量每秒的时钟数，这应该不会太难。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-03-27T08:40:24.990

接受的答案已经足够好了。但我的解决方案更简单。我只是在 Linux 中测试，使用 gcc (Ubuntu 7.2.0-8ubuntu3.2) 7.2.0。

也使用`gettimeofday`, the`tv_sec`是秒的一部分，而 the`tv_usec`是**microseconds** ，而不是**milliseconds**。

```
long currentTimeMillis() {
  struct timeval time;
  gettimeofday(&time, NULL);

  return time.tv_sec * 1000 + time.tv_usec / 1000;
}

int main() {
  printf("%ld\n", currentTimeMillis());
  // wait 1 second
  sleep(1);
  printf("%ld\n", currentTimeMillis());
  return 0;
 } 
```

它打印：

`1522139691342`
`1522139692342`，正好一秒钟。
`^`

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2013-09-11T06:11:18.640

在窗户下：

```
SYSTEMTIME t;
GetLocalTime(&t);
swprintf_s(buff, L"[%02d:%02d:%02d:%d]\t", t.wHour, t.wMinute, t.wSecond, t.wMilliseconds); 
```

# language-agnostic - 是否应该从编程语言中删除（非接口类型的）继承？

> ID：361371
> 
> 赞同：14
> 
> 时间：2008-12-11T23:12:21.780
> 
> 标签：language-agnostic, inheritance, programming-languages, language-features

这是一个颇具争议的话题，在你说“不”之前，真的、真的需要吗？

我已经编程了大约 10 年，老实说，我无法回想起继承解决无法以其他方式解决的问题的时间。另一方面，当我使用继承时，我可以回忆起很多次，因为我觉得我必须这样做，或者因为我认为我很聪明并最终为此付出了代价。

从实现的角度来看，我真的看不出任何不能使用聚合或其他技术来代替继承的情况。

我唯一需要注意的是，我们仍然允许接口继承。

（更新）

让我们举例说明为什么需要它，而不是说“有时它只是需要”。这真的一点帮助都没有。你的证据在哪里？

（更新 2 代码示例）

这是经典的形状示例，更强大，更明确的 IMO，没有继承。在现实世界中，几乎从来没有真正“是”其他东西的情况。几乎总是“在条款中实施”更准确。

```
public interface IShape
{
    void Draw();
}

public class BasicShape : IShape
{
    public void Draw()
    {
        // All shapes in this system have a dot in the middle except squares.
        DrawDotInMiddle();
    }
}

public class Circle : IShape
{
    private BasicShape _basicShape;

    public void Draw()
    {
        // Draw the circle part
        DrawCircle();
        _basicShape.Draw();
    }
}

public class Square : IShape
{
    private BasicShape _basicShape;

    public void Draw()
    {
        // Draw the circle part
        DrawSquare();
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-11T23:18:31.907

不久前，我[在博客上写](http://msmvps.com/blogs/jon_skeet/archive/2007/02/27/wacky-ideas-1-inheritance-is-dead-long-live-mix-ins.aspx)了一个古怪的想法。

我不认为它应该被删除，但我认为默认情况下应该密封类以*阻止*不合适的继承。这是一个强大的工具，但它就像一把链锯——你真的不想使用它，除非它是完成这项工作的*完美*工具。否则你可能会开始失去四肢。

这些是潜在的语言功能，例如 IMO 的混合，这将使生活更容易。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-11T23:23:24.083

在您的基类有许多方法对每个派生类具有相同实现的情况下，继承可能非常有用，以使每个派生类都不必实现样板代码。以 .NET`Stream`类为例，它定义了以下方法：

```
public virtual int Read(byte[] buffer, int index, int count)
{
}

public int ReadByte()
{
    // note: this is only an approximation to the real implementation
    var buffer = new byte[1];
    if (this.Read(buffer, 0, 1) == 1)
    {
        return buffer[0];
    }

    return -1;
} 
```

因为继承是可用的，基类可以实现`ReadByte`所有实现的方法，而不必担心。在具有默认或固定实现的类上还有许多其他类似的方法。因此，在这种情况下，拥有一个非常有价值的东西，与您的选择要么让每个人重新实现所有东西，要么创建一个`StreamUtil`他们可以调用的类型类（yuk！）的接口相比。

澄清一下，通过继承，我创建一个`DerivedStream`类所需的代码如下：

```
public class DerivedStream : Stream
{
    public override int Read(byte[] buffer, int index, int count)
    {
        // my read implementation
    }
} 
```

而如果我们使用接口和方法的默认实现，`StreamUtil`我必须编写更多代码：

```
public class DerivedStream : IStream
{
    public int Read(byte[] buffer, int index, int count)
    {
        // my read implementation
    }

    public int ReadByte()
    {
        return StreamUtil.ReadByte(this);
    }
} 
```

}

因此，这不是更多的代码，而是将其乘以类上的更多方法，这只是编译器可以处理的不必要的样板文件。为什么要让事情比必要的实施更痛苦？我不认为继承是万能的，但如果使用得当，它会非常有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-12T06:31:19.537

当然，您可以在没有对象和继承的情况下愉快地编写出色的程序；函数式程序员一直都在这样做。但我们不要操之过急。任何对此主题感兴趣的人都应该查看 Xavier Leroy 受邀演讲中关于[Objective Caml 中的类与模块](http://pauillac.inria.fr/~xleroy/talks/icfp99.ps.gz)的幻灯片。**Xavier 很好地说明了继承在不同类型的软件进化**环境中哪些方面做得好，哪些方面做得不好。

所有语言都是图灵完备的，所以当然不需要继承。但作为继承价值的论据，我提出了[Smalltalk 蓝皮书](https://rads.stackoverflow.com/amzn/click/com/0201113716)，尤其是**Collection 层次结构**和**Number 层次结构**。我印象深刻的是，熟练的专家可以添加一种全新的数字（或集合）而不会干扰现有系统。

我还会提醒提问者继承的“杀手级应用”：GUI 工具包。一个设计良好的工具包（如果你能找到的话）可以非常非常容易地添加新类型的图形交互小部件。

说了这么多，我认为继承有先天的弱点（你的程序逻辑被一大堆类弄脏了），**它应该很少使用，而且只能由熟练的专业人员使用**。获得计算机科学学士学位的人几乎不知道继承——应该允许这样的人在需要时从其他类继承，但绝不应该编写其他程序员继承的代码。这份工作应该留给真正知道自己在做什么的高级程序员。他们应该不情愿地这样做！

对于使用完全不同的机制解决类似问题的有趣尝试，人们可能想查看[Haskell 类型的类](http://citeseer.ist.psu.edu/old/jones95system.html)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T12:53:26.497

我希望语言能够提供一些机制来更容易地委托给成员变量。例如，假设接口 I 有 10 个方法，类 C1 实现了这个接口。假设我想实现类 C2，它就像 C1，但方法 m1() 被覆盖。如果不使用继承，我会这样做（在 Java 中）：

```
public class C2 implements I {
    private I c1;

    public C2() {
       c1 = new C1();
    }

    public void m1() {
        // This is the method C2 is overriding.
    }

    public void m2() {
        c1.m2();
    }

    public void m3() {
        c1.m3();
    }

    ...

    public void m10() {
        c1.m10();
    }
} 
```

换句话说，我必须显式编写代码来将方法 m2..m10 的行为委托给成员变量 m1。这有点痛苦。它还使代码混乱，因此很难看到 C2 类中的真实逻辑。这也意味着每当向接口 I 添加新方法时，我必须显式向 C1 添加更多代码，以便将这些新方法委托给 C1。

我希望语言允许我说：C1 实现了 I，但如果 C1 缺少 I 的某些方法，则自动委托给成员变量 c1。这会将 C1 的大小缩小到

```
public class C2 implements I(delegate to c1) {
    private I c1;

    public C2() {
       c1 = new C1();
    }

    public void m1() {
        // This is the method C2 is overriding.
    }
} 
```

如果语言允许我们这样做，那么避免使用继承会容易得多。

这是我写的关于自动委托的[博客文章。](http://visionandexecution.org/?p=46#more-46)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-11T23:53:18.437

继承是可以使用的工具之一，当然也可以被滥用，但我认为语言必须有更多的变化才能删除基于类的继承。

让我们来看看我现在的世界，主要是 C# 开发。

为了让微软取消基于类的继承，他们必须为处理接口提供更强大的支持。诸如聚合之类的事情，我需要添加大量样板代码只是为了将接口连接到内部对象。无论如何，这确实应该完成，但在这种情况下将是一个要求。

换句话说，下面的代码：

```
public interface IPerson { ... }
public interface IEmployee : IPerson { ... }
public class Employee : IEmployee
{
    private Person _Person;
    ...

    public String FirstName
    {
        get { return _Person.FirstName; }
        set { _Person.FirstName = value; }
    }
} 
```

这基本上必须短得多，否则我会有很多这些属性只是为了让我的班级模仿一个足够好的人，就像这样：

```
public class Employee : IEmployee
{
    private Person _Person implements IPerson;
    ...
} 
```

这可以自动创建必要的代码，而不是我必须编写它。如果我将对象转换为 IPerson，仅返回内部引用是没有用的。

因此，必须先更好地支持基于类的继承，然后才能将其从桌面上取消。

此外，您将删除诸如可见性之类的内容。一个界面实际上只有两个可见性设置：存在和不存在。在某些情况下，或者我认为，您会被迫公开更多的内部数据，以便其他人可以更轻松地使用您的课程。

对于基于类的继承，您通常可以公开一些后代可以使用的访问点，但外部代码不能，您通常只需删除这些访问点，或者让它们对所有人开放。不确定我喜欢这两种选择。

我最大的问题是删除这些功能的具体意义是什么，即使计划是构建 D#，一种新的语言，如 C#，但没有基于类的继承。换句话说，即使你打算构建一门全新的语言，我仍然不能完全确定最终目标是什么。

如果不在正确的手中，目标是否是删除可能被滥用的东西？如果是这样，我有一英里长的各种编程语言的列表，我*真的*很想先看到地址。

在该列表的顶部：Delphi 中的**with**关键字。那个关键字不仅仅是在脚上射击自己，它就像编译器买了猎枪，来到你家并瞄准你。

我个人喜欢基于类的继承。当然，你可以把自己写到角落里。但我们都可以做到。删除基于类的继承，我只会找到一种新的方式来打击自己。

现在我把那把霰弹枪放在哪里了……

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-08T05:57:40.687

享受在所有类上实现 ISystemObject 的乐趣，这样您就可以访问 ToString() 和 GetHashcode()。

此外，祝 ISystemWebUIPage 界面好运。

如果您不喜欢继承，我的建议是完全停止使用 .NET。有太多的场景可以节省时间（请参阅 DRY：不要重复自己）。

如果使用继承会破坏您的代码，那么您需要退后一步重新考虑您的设计。

我更喜欢接口，但它们不是灵丹妙药。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-11T23:33:20.613

对于生产代码，我几乎从不使用继承。我对所有东西都使用接口（这有助于测试并提高可读性，即您可以只查看接口来读取公共方法并查看由于命名良好的方法和类名而发生的情况）。几乎我唯一一次使用继承是因为第三方库需要它。使用接口，我会得到相同的效果，但我会通过使用“委托”来模仿继承。

对我来说，这不仅更具可读性，而且更易于测试，也使重构变得更加容易。

我唯一能想到在测试中使用继承是创建我自己的特定测试用例，用于区分我系统中的测试类型。

所以我可能不会摆脱它，但出于上述原因，我选择尽可能不使用它。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-11T23:16:30.600

不，有时您需要继承。对于那些你不使用它的时候——不要使用它。您始终可以“仅”使用接口（在具有它们的语言中）和没有数据的 ADP 就像在那些没有它们的语言中的接口一样工作。但是我认为没有理由仅仅因为您觉得它并不总是需要而删除有时是必要的功能。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-12T06:57:02.623

我想我必须扮演魔鬼的拥护者。如果我们没有继承，那么我们将无法继承使用模板方法模式的抽象类。在 .NET 和 Java 等框架中有很多例子。Java中的线程就是这样一个例子：

```
// Alternative 1:
public class MyThread extends Thread {

    // Abstract method to implement from Thread
    // aka. "template method" (GoF design pattern)
    public void run() {
        // ...
    }
}

// Usage:
MyThread t = new MyThread();
t.start(); 
```

另一种选择是，在我的意思中，当你必须使用它时，它是*冗长的。*视觉杂乱复杂度上升。这是因为您需要先创建线程，然后才能实际使用它。

```
// Alternative 2:
public class MyThread implements Runnable {
    // Method to implement from Runnable:
    public void run() {
        // ...
    }
}

// Usage:
MyThread m = new MyThread();
Thread t = new Thread(m);
t.start();
// …or if you have a curious perversion towards one-liners
Thread t = new Thread(new MyThread());
t.start(); 
```

让我的魔鬼代言人脱帽致敬，我猜你可能会争辩说，第二种实现的好处是依赖注入或关注点分离，这有助于设计可测试的类。根据您对接口的定义（我听说过至少三个），抽象类可以被视为接口。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-12T15:12:56.947

需要吗？不。例如，您可以用 C 编写任何没有任何继承或对象的程序。您可以用汇编语言编写它，尽管它的可移植性较差。您可以在图灵机中编写它并对其进行仿真。有人设计了一种只有一条指令的计算机语言（如果不为零，则类似于减法和分支），您可以用它编写程序。

因此，如果您要问是否需要给定的语言特性（如继承、对象、递归或函数），答案是否定的。（也有例外——你必须能够循环并有条件地做事，尽管这些不需要作为语言中的明确概念来支持。）

因此，我觉得这类问题毫无用处。

像“我们什么时候应该使用继承”或“我们什么时候不应该”这样的问题更有用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-11T23:17:43.377

不。仅仅因为它不经常需要，并不意味着它从来不需要。与工具包中的任何其他工具一样，它可以（并且已经并且将会）被滥用。但是，这并不意味着**永远不**应该使用它。事实上，在某些语言（C++）中，在语言层面没有“接口”之类的东西，所以如果没有大的改变，你就不能禁止它。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-11T23:18:31.113

很多时候我发现自己选择基类而不是接口只是因为我有一些标准功能。在 C# 中，我现在可以使用扩展方法来实现这一点，但在某些情况下它仍然无法实现相同的目标。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-12T00:06:06.913

不，它不是*必需*的，但这并不意味着它不会提供整体利益，我认为这比担心是否绝对必要更重要。

最后，几乎所有现代软件语言结构都相当于语法糖——如果我们真的需要，我们都可以编写汇编代码（或使用打孔卡，或使用真空管）。

在我真正想要表达“is-a”关系的时候，我发现继承非常有用。继承似乎是表达这种意图的最清晰的方式。如果我将委托用于所有实现重用，我就会失去这种表达能力。

这允许滥用吗？当然可以。我经常看到一些问题，询问开发人员如何从一个类继承但隐藏一个方法，因为该方法不应该存在于子类中。那个人显然忽略了继承这一点，而应该指向委托。

我不使用继承，因为它是必需的，我使用它是因为它有时是完成这项工作的最佳工具。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-12T12:38:42.733

真的需要继承吗？取决于你所说的“真的”是什么意思。理论上你可以回到打孔卡或轻弹拨动开关，但这是一种糟糕的软件开发方式。

在过程语言中，是的，类继承无疑是一个福音。它为您提供了一种在某些情况下优雅地组织代码的方法。它不应该被过度使用，因为任何其他功能都不应该被过度使用。

例如，以这个线程中的 digiarnie 为例。他/她几乎对所有事情都使用接口，这与使用大量继承一样糟糕（可能比使用大量继承更糟糕）。

他的一些观点：

> 这有助于测试并提高可读性

它不做任何事情。你从来没有真正测试过一个接口，你总是测试一个对象，也就是一个类的实例化。并且必须查看完全不同的代码可以帮助您理解类的结构？我不这么认为。

不过，对于深层继承层次结构也是如此。理想情况下，您只想查看一个地方。

> 使用接口，我会得到相同的效果，但我会通过使用“委托”来模仿继承。

委托是一个非常好的主意，应该经常使用而不是继承（例如，策略模式就是这样做的）。但是接口与委托的关系为零，因为您根本无法在接口中指定任何行为。

> 也使重构变得更加容易。

对接口的早期承诺通常会使重构变得更难，而不是更容易，因为那时有更多地方需要改变。尽早过度使用继承比过度使用接口更好（好吧，不太糟糕），因为如果被修改的类不实现任何接口，则拉出委托类会更容易。并且经常从这些委托中获得有用的接口。

所以过度使用继承是一件坏事。过度使用接口是一件坏事。理想情况下，一个类既不会从任何东西继承（除了“对象”或语言等价物），也不会实现任何接口。但这并不意味着应该从语言中删除任何一个功能。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-11T23:26:31.923

我最初的想法是，你疯了。但是考虑了一会儿，我有点同意你的看法。我并不是说完全删除类继承（例如，具有部分实现的抽象类可能很有用），但我经常继承（双关语）写得不好的带有多级类继承的 OO 代码，除了膨胀之外，什么也没有添加到代码。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-11T23:43:29.737

请注意，继承意味着不再可能通过依赖注入来提供基类功能，以便在隔离其父类的情况下对派生类进行单元测试。

因此，如果您对依赖注入非常认真（我不是，但我确实想知道是否应该如此），那么无论如何您都无法从继承中获得太多用处。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-12T12:11:33.163

这是该主题的一个不错的观点：

[严格等价于雷格·布雷思韦特（Reg Braithwaite）](http://weblog.raganwald.com/2008/04/is-strictly-equivalent-to.html)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-12T14:41:52.923

如果有一个框架类几乎完全符合您的要求，但其接口的特定函数抛出 NotSupported 异常或出于某种其他原因您只想覆盖一个方法来执行特定于您的实现的事情，那么编写起来会容易得多一个子类并重写该方法，而不是编写一个全新的类并为该类中的其他 27 个方法中的每一个编写传递。

类似地，Java 怎么样，例如，每个对象都继承自 Object，因此自动具有 equals、hashcode 等的实现。我不必重新实现它们，当我想使用它时它“就可以工作”对象作为哈希表中的键。我不必为`Hashtable.hashcode(Object o)`方法编写默认传递，坦率地说，这似乎正在*远离*面向对象。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-02-02T21:41:05.680

我相信有时通过继承实现的更好的代码重用机制是[特征](http://en.wikipedia.org/wiki/Trait_(abstract_type))。查看此[链接 (pdf)](http://scg.unibe.ch/archive/papers/Scha03aTraits.pdf)以获得关于此的精彩讨论，包括特征和 mixin 之间的区别，以及为什么青睐特征。

有一些研究将特征引入[C# (pdf)](http://scg.unibe.ch/archive/projects/Reic05a.pdf)。

Perl 通过[Moose::Roles](http://search.cpan.org/~drolsky/Moose-0.94/lib/Moose/Manual/Roles.pod)具有特征。Scala 特征就像在[Ruby中的](http://juixe.com/techknow/index.php/2006/06/15/mixins-in-ruby/)[mixins](http://programming-scala.labs.oreilly.com/ch04.html#TraitsAsMixins)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-08T07:12:18.927

问题是，“应该从编程语言中删除（非接口类型的）继承吗？”

我说“不”，因为它会破坏大量现有代码。

除此之外，您是否应该使用继承，而不是接口继承？我主要是 C++ 程序员，我遵循*接口多重继承的严格对象模型，然后是类的单继承链*。具体的类是组件的“秘密”，它是朋友，所以没有人做生意。

为了帮助实现接口，我使用模板混合。这允许界面设计者提供代码片段来帮助实现常见场景的界面。作为一个组件开发人员，我觉得我可以去 mixin 购物来获得可重用的位，而不会被界面设计师认为我应该如何构建我的类所困扰。

话虽如此，mixin 范式对于 C++ 来说是非常独特的。如果没有这个，我希望继承对务实的程序员非常有吸引力。

# sharepoint - SharePoint 中的单元测试事件处理程序？

> ID：361372
> 
> 赞同：2
> 
> 时间：2008-12-11T23:12:28.520
> 
> 标签：sharepoint, unit-testing, sharepoint-2007, mocking

甚至可能吗？

到目前为止，我发现我们可以购买 TypeMock 来模拟 SharePoint 对象，然后使用任何免费的 Mocking 框架（[Moq](http://code.google.com/p/moq/)？）来完成剩下的工作。

你怎么看？

似乎没有 TypeMock，就不可能在 SharePoint 中进行单元测试。

为了正确测试我们的事件，我们需要给事件一个 SPItemEventProperties。该类是密封的，并且有一个需要 SPSite 的内部构造函数。

如果我使用 SPSite，我可以实例化该类并提供适当的值来测试我的事件。但是，我想删除该依赖项，并且 TypeMock 接缝是唯一能够做到这一点的人。

有什么办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T18:20:30.287

我还没有使用它，但我很想尝试这个产品：[TypeMock for SharePoint](http://www.typemock.com/sharepointpage.php)

多媒体页面上的视频介绍[（#5）](http://www.typemock.com/Multimedia.html)

[这是对 SharePoint 单元测试技巧](http://blogs.msdn.com/francischeung/archive/2008/08/22/unit-testing-sharepoint-2007-applications.aspx)的一个很好的小概述

jt

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T20:00:35.443

没有真正好的方法可以做到这一点。您可以尝试将您实际使用的 SPItemEventProperties 的部分拆分为单独的参数，以便您的事件处理程序获取 SPItemEventProperties，并调用实际的事件处理程序，将项目和 web.xml 传递给它。此时，只需对实际的事件处理程序进行单元测试（为特定参数传递适当的模拟对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T14:59:09.510

Currenlty typemock Isolator 是唯一可以伪造或[模拟 SharePoint](http://www.typemock.com/sharepointpage.php)的框架。这是因为它可以创建具有私有构造函数或密封的模拟对象，就像大多数 SharePoint 对象一样。

# ruby - 如何在 Ruby 中知道文件是否已完全下载

> ID：361374
> 
> 赞同：3
> 
> 时间：2008-12-11T23:13:01.700
> 
> 标签：ruby

我们的问题是我们的项目使用 wget 将文件下载到文件系统。我们正在使用 ruby​​ 读取下载的文件以获取数据。
如何判断文件是否已完全下载，因此我们不会读取半完整的文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T23:25:37.790

我问了一个[非常相似的问题](https://stackoverflow.com/questions/343391/detect-a-file-in-transit)并得到了一些很好的答案......总之，使用以下一种或多种组合：

*   将文件下载到保存区域，最后复制到您的输入目录；
*   使用下载完成后创建的标记文件来表示准备就绪；
*   轮询文件两次，看看它的大小是否停止增加；
*   检查文件的权限（某些下载进程会在下载过程中阻止读取）；
*   使用另一种方法，例如 Ruby 进程的线程内下载。

引用 Martin Cowie 的话，“这是一个像山一样古老的中间件问题”......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T23:23:57.280

典型的方法是将文件下载到临时位置，完成后将其“移动”到最终目的地进行处理。

# .net - “彻底”，设置 Jetbrain 的 TeamCity CI 服务器的教程

> ID：361386
> 
> 赞同：44
> 
> 时间：2008-12-11T23:16:00.900
> 
> 标签：.net, nunit, continuous-integration, teamcity

有谁知道我在哪里可以找到一个很好的教程来指导我如何设置 TeamCity CI 服务器？我是单元测试和敏捷开发理念的新手，所以我可以使用一些帮助来弄湿我的脚。我正在使用 NUnit 使用 Asp.NET 代码进行单元测试，并且更喜欢 TeamCity 服务器的 Windows 环境。请注意，我不知道如何为构建配置 NANT 或任何其他需要连续构建的东西。我刚刚对 .NET 代码进行了单元测试。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-13T06:19:07.040

DimeCasts.net 的人们有一个不错的[TeamCity 教程](http://www.dimecasts.net/Casts/ByTag/Team%20City)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-20T20:51:15.630

请注意，TeamCity 也可以使用 MSBuild，它可以运行 Visual Studio .sln 文件。当您开始涉足时，这是一个很好的起点 - 只需让构建服务器运行您的构建脚本，该脚本使用 MSBuild 来调用您的 .sln 文件。

我们在 Build 目录中签入我们的构建脚本，并且我们确保使用相对路径，因此任何人都可以运行构建。我们有大约 140 个项目（托管和非托管）以及许多其他活动（例如，从元数据自动生成类和对象）。

此外，在第一次设置 CI 服务器时，请准备好熟悉您的构建。在最初的几周内，当出现问题时，人们可能会将其归咎于 CI 服务器，而不是检查损坏的代码。了解您的构建并使其尽可能简单将有助于整个团队专注于更好地集成。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-05-20T21:48:07.853

[我发现了一系列关于设置 TeamCity、Subversion 和 Web Deploy](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity.html)的优秀博客文章。它为我节省了大量时间。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T15:36:53.017

1.  让 nant 编译您的代码并运行测试
2.  下载并安装teamcity
3.  在常规设置中将您的测试报告设置为构建工件

nunit 是一个很好的起点，因为它与 teamcity 配合得很好。

teamcity 的设置非常好，如果有任何问题，请发回

这里有一些帮助链接

*   [JPBoodhoo NAnt 入门系列](http://blog.jpboodhoo.com/NAntStarterSeries.aspx)
*   [简介](http://nant.sourceforge.net/release/latest/help/introduction/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-05-26T12:24:23.913

我写了一篇很长[的文章，介绍如何使用 ASP.Net 和 Web 部署项目来做到这一点](http://www.diaryofaninja.com/blog/2010/05/09/automated-site-deployments-with-teamcity-deployment-projects-amp-svn)- 听起来很合你的胃口（不知道我是否可以发布这个 - 模组？）：

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-20T20:38:01.990

我在“Pete W.'s Idea Book”博客上发现了一篇文章，它对我设置 TeamCity 和 Visual SVN 非常有用。 [VisualSVN + TeamCity + NAnt + SQL Server](http://web.archive.org/web/20100426134546/http://www.acceptedeclectic.com/2008/05/visualsvn-teamcity-nant-sql-server.html)

甚至谈到让 SQL Server 2005 与 TeamCity 一起工作（尽管我相信它与 TeamCity 4.x 一起开箱即用）。与 NAnt 的集成也有帮助。

这是一篇很好的介绍和教程文章。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-07T22:41:01.963

我最近写了一篇[关于使用 TeamCity 发布 winforms ClickOnce 部署](http://kellytadams.com/blog/2011/1/7/using-teamcity-to-publish-clickonce-packages-to-a-network-sh.html)的帖子。你没有具体提到你需要用你的 CI 环境构建什么样的东西，所以我不知道它有多适用。FWIW：

# architecture - 服务器向客户端询问信息？

> ID：361391
> 
> 赞同：0
> 
> 时间：2008-12-11T23:17:32.457
> 
> 标签：architecture, client-server, protocols

在客户端-服务器系统中，“向客户端询问”更多信息的服务器方法是否被认为是良好的架构？如果是这样，设计这种场景的最佳方法是什么？这有“模式”吗？

例如，假设最终用户在客户端 UI 中选择了他们想要删除的一组记录，然后客户端以该记录集作为参数对服务器进行“删除记录”调用。然后服务器找到那些以某种方式“特殊”的记录的子集，因此需要用户确认。服务器是否适合以某种方式“回调”客户端到称为“确认记录”的方法，同时仍继续从客户端到服务器的原始调用？

那么更复杂的服务器调用可能需要服务器和客户端之间的长时间“对话”呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T23:26:35.450

某种回复说“记录 x、y 和 z 未被删除，请使用`I_RELLY_WANT_TO`set 重试以删除它们”对我来说似乎是一个合理的解决方案。

一般模式；不要问，做事并报告，让客户决定下一步做什么。这可以作为对话形式在持久连接的上下文中完成。

不是我的领域，所以...添加 64mg NaCl

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T19:51:17.473

客户端正在发送要删除的文件列表，对吗？只需让服务器回复一个成功状态列表，指出哪个文件被删除，哪个文件没有被删除，也许，为什么它没有被删除（不存在，没有权限等）。

如果常见的情况是所有文件都已成功删除，则可能会在响应开始时使用状态字段指示是否所有文件都已删除，或者客户端是否需要实际评估状态代码以查看操作的进展情况。

有了这个响应，客户端应该能够更新它对服务器状态的看法，至少关于已选择删除的文件（即，从 UI 中删除那些已成功删除的文件，以及那些不再存在；另外，可能指示服务器由于缺少相应权限而无法删除的那些文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T01:41:41.620

像这样的回调会颠倒客户端和服务器的角色。在许多这些类型的架构中，客户端没有能力监听请求。如果是这样，您将开始关注 P2P 类型的系统。也许这样的事情可能会奏效。

```
client code: 
  special_records = server.deleteRecords(records)
  server.deleteSpecialRecords(special_records)

server code:
  def deleteRecords(records):
    special_records = detectSpecialRecords(records)
    reply(special_records)
    actuallyDeleteRecords(records - special_records) 
```

因此，第一次调用 deleteRecords 将返回这些需要显式删除的特殊记录的列表。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T04:40:56.033

我觉得这样的安排完全没问题。没有什么可以阻止服务器向客户端回复查询以获取更多信息并让客户端提供它。只要套接字连接打开，您就可以自由支配来回发送消息。

我见过一种安排，客户端向服务器发送消息，然后在服务器控制它时，它只是在标准输入/输出和本地计算机上的文件系统之上的一个小层。它工作得很好，而且速度非常快。

# javascript - javascript: addContent - 如何打包

> ID：361394
> 
> 赞同：1
> 
> 时间：2008-12-11T23:18:14.467
> 
> 标签：javascript, forms

在使用 addContent 的示例（位于[***randomsnippets.com***](http://www.randomsnippets.com/2008/04/14/how-to-dynamically-add-content-to-a-div-via-javascript/)）时，我偶然发现了一个问题，希望有人能提供帮助。这可能不是给这只猫剥皮的最佳/唯一方法，但我们有一个 PHP/MySQL 页面，必须在需要时修改为添加行以进行数据输入。

他们的方法有效（请在他们的页面上看一下），但是 FORM 元素 TEXTAREA 的值中有它自己的表单元素，包括 TEXTAREA。后一个 TEXTAREA 标记的关闭会中断第一个值并将剩余的代码扔到页面，而不是等待提交按钮插入。结果示例： [***单击此处***](http://www.facey.com/insert_content1.php)

Submit 按钮成功生成了留在里面的部分，但是您看到了问题。

* * *

## - 有没有办法使用 javascript addContent 函数，

## - 结合添加按钮的实用程序

## - 但是避免使用FORMS的包装？

* * *

谢谢你的帮助！

布莱恩

ps PHP 是透明的。将变量中包含的 HTML 直接包含为 TEXTAREA 的值会产生相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T23:47:03.957

我真的不明白您要在这里完成什么，但这没关系 - 明显的问题是您在`textarea`:`textarea`的文本中包含未转义的 HTML，就像您将转义文本一样HTML 文档中其他任何地方的内容（转换`<`为`&lt;` `>`to等）。您最终通过浏览器的 HTML 解析器返回文本这一事实并不重要 - 如果您希望文档正确加载，则必须对其进行转义：`&gt;` `&``&amp;`

### 例子：

*所需的内容，例如：*

```
<tr>
   <td bgcolor="#F3F3F3" align="center" colspan="3"><hr size="1" color="#C0C0C0"></td>
</tr> 
```

*将像这样包含在文本区域中：*

```
<textarea>
&lt;tr&gt;
   &lt;td bgcolor="#F3F3F3" align="center" colspan="3"&gt;&lt;hr size="1" color="#C0C0C0"&gt;&lt;/td&gt;
&lt;/tr&gt;
</textarea> 
```

# html - 通过 HTTP 处理文件上传的最佳方式

> ID：361395
> 
> 赞同：3
> 
> 时间：2008-12-11T23:18:21.550
> 
> 标签：html, http, file-upload

使用标准 HTML 输入通过网页上传文件对我来说总是很笨拙。如果用户尝试上传一个大文件，它可能会一直持续下去，并且他们不会得到文件实际上正在上传的队列。

我试图做一些事情，比如提供一个 gif 图形，它是一个动画图形栏，但它没有给用户任何关于上传多少的指示。我什至尝试过用 AJAX 做一个进度条，但那些总是很丑，而且似乎从来没有正常工作。

这一直是我的许多客户的问题，并且经常有人问我是否有更好的方法。有时我会为他们提供一个 FTP 站点，以便他们可以将其上传到那里，但这也不是一个实用的解决方案。

您认为从 HTML 处理 HTTP 文件上传的最佳方式是什么？您在互联网上看到过哪些好的想法/例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T23:29:23.367

可以使用许多客户端控件。

你可以

*   构建您自己的 ActiveX 控件。仅限 Windows/IE
*   使用 Flash 对文件进行排队，并使用标准文件上传协议一次将一个文件上传到服务器。
*   使用签名的 java 小程序上传。
*   编写浏览器插件。

来自谷歌的一些随机链接：

[http://www.element-it.com/MultiPowUpload.aspx](http://www.element-it.com/MultiPowUpload.aspx)

[http://www.codeproject.com/KB/aspnet/FlashUpload.aspx](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)

[http://www.dmxzone.com/forum/go/?36564](http://www.dmxzone.com/forum/go/?36564)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T23:32:04.517

有几种技术可以通过 HTTP 使用进度条进行异步文件传输，其中大多数涉及[Flash](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)或[XMLHttpRequest](http://www.sibsoft.net/xupload.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T23:41:45.900

我会在其中添加[swfupload](http://swfupload.org/)。这是一个开源的 Flash 上传器，如果用户没有 Flash，它可以优雅地降级。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T00:28:03.563

实际上只有一种通过浏览器上传的机制。但是，您可以通过提供一个进度条来显示上传正在进行以及以何种速度进行，从而对其进行修饰并使其更加用户友好。

这通常通过将上传表单定位到隐藏的 iframe 并使用 AJAX 调用来找出有多少文件已到达服务器来完成。

这是一个例子：

[超级上传](http://sourceforge.net/projects/megaupload "超级上传")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-30T17:26:26.357

如果您运行 mod_perl2 apache，则有[Apache2::UploadProgress](http://search.cpan.org/~ceeshek/Apache2-UploadProgress-0.2/lib/Apache2/UploadProgress.pm)模块。这会为 http 上传请求添加一个 id，然后您可以向服务器查询该上传的进度。内置支持在弹出窗口或上传页面中创建 AJAX 进度条。如果您想构建自己的进度显示，您可以将信息作为 XML 或 JSON 数据返回。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-30T17:32:29.907

[YUI Uploader 实用程序](http://developer.yahoo.com/yui/uploader/)使用基于 Flash的上传器，有很好的文档，并且有几个示例供您尝试。我已经在几个项目中使用过它，并且会推荐它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-30T17:40:20.037

我用这个作为一个相当简单和完整的工具。基本源代码很好，如有必要，您可以轻松自定义它。 [AJAX 文件上传](http://en.fileuploadajax.subgurim.net/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-22T20:49:44.240

有趣的是，没有人提到过[Dean Brettle的](http://www.brettle.com/)[NeatUpload](http://neatupload.codeplex.com/)上传组件，它有很多有趣的功能并且也可以在 MONO 上运行

# macos - 我可以从启动服务中隐藏目录/路径吗？

> ID：361430
> 
> 赞同：1
> 
> 时间：2008-12-11T23:31:24.987
> 
> 标签：macos

我希望能够构建测试应用程序（例如夜间的 Minefield/Firefox），而不需要 Launch Services 决定它们是打开分配的文件类型的最佳方式。

有没有办法从启动服务中隐藏我的 ~/src 目录，以便 Finder 不会在该文件夹中注册应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T23:46:29.013

我不知道隐藏的方法，但您*可以*更改开发应用程序的捆绑 ID，这样它们就不会被 LaunchServices 视为该内容类型/URI 方案的首选应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:54:10.230

特别是对于 Firefox，答案是：如果 OS X 找到多个可以处理 URL 方案的应用程序，它将使用具有*最高*版本号的应用程序。因此，要伪造 OS X，您可以编辑`mozilla-central/browser/app/macbuild/Contents/Info.plist.in`并更改`CFBundleShortVersionString`from

```
 <string>%APP_VERSION%</string> 
```

到

```
 <string>0.%APP_VERSION%</string> 
```

这样，OS X 会认为应用程序是 0.3.2apre1 版本，它会更喜欢“真正的”Firefox 版本。

一个更通用的解决方案可能是可能的。OS X 将更喜欢本地卷上的应用程序而不是远程卷上的应用程序，并且在本地应用程序中，它会更喜欢启动卷上的应用程序。因此，可以进行某种类型的环回挂载，并将源代码保持在环回“卷”上，这又会降低其优先级。

OS X 如何决定为给定文档或 URL 启动哪个应用程序：

[启动服务编程指南：首选应用程序](http://developer.apple.com/documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCConcepts/chapter_2_section_8.html#//apple_ref/doc/uid/TP30000999-CH202-BABBJJEF)

# python - 需要帮助了解如何在 Python 中使用不太复杂的正则表达式

> ID：361443
> 
> 赞同：1
> 
> 时间：2008-12-11T23:41:55.277
> 
> 标签：python, regex

我正在尝试了解有关正则表达式的更多信息，我相信下面有一个正则表达式，我相信会发现在高达 9990 亿的数字上缺少右括号的情况。我认为它下面的那个应该做同样的事情，但我没有得到类似的结果

```
 missingParenReg=re.compile(r"^\([$]*[0-9]{1,3}[,]?[0-9]{0,3}[,]?[0-9]{0,3}[,]?[0-9]{0,3}[.]*[0-9]*[^)]$")
   missingParenReg2=re.compile(r"^\([$]?([0-9]{1,3}[,]?)+[.]*[0-9]*[^)]$") 
```

我认为第二个说： 必须有一个开放的括号才能开始
可能有也可能没有一个美元符号
下一个组必须至少存在一次，但可以存在无限次
该组应该至少有一个数字，但可能多达三个
该组可能有 0 和 1 个逗号
在该组之后可能有也可能没有小数点
如果有小数点，则后面将有多达 0 但数不胜数的数字
最后不应该有一个结束括号。

我正在尝试理解这个神奇的东西，所以如果你有一个更优雅的解决方案，我将不胜感激对我的正则表达式进行更正（如果可以更正的话）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T23:57:50.237

是否有嵌套括号（您的正则表达式假设没有）？如果不：

```
whether_paren_is_missing = (astring[0] == '(' and not astring[-1] == ')') 
```

要验证美元金额部分：

```
import re

cents = r"(?:\.\d\d)" # cents 
re_dollar_amount = re.compile(r"""(?x)
    ^               # match at the very begining of the string
    \$?             # optional dollar sign
    (?:               # followed by
        (?:             # integer part  
        0               # zero
        |               # or
        [1-9]\d{,2}     # 1 to 3 digits (no leading zero) 
        (?:               # followed by
            (?:,\d{3})*     # zero or more three-digits groups with commas                          
            |               # or
            \d*             # zero or more digits without commas (no leading zero)
            )
        )
        (?:\.|%(cents)s)?   # optional f.p. part 
    |               # or
    %(cents)s       # pure f.p. '$.01'
    )
    $               # match end of string
    """ % vars()) 
```

允许：

```
    $0
    0
    234 美元
    22
    0.01 美元
    10000.12
    99.90 美元
    2,010,123
    1.00
    2,103.45
    $.10
    1美元。

```

禁止：

```
    01234
    00
    123.4X
    1.001
    .

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T00:14:10.407

正则表达式更棘手的部分不是让它们接受有效输入，而是让它们拒绝无效输入。例如，第二个表达式接受明显错误的输入，包括：

*   `(1,2,3,4`-- 每个逗号之间的一个数字
*   `(12,34,56`-- 每个逗号之间的两位数
*   `(1234......5`-- 不限小数点
*   `(1234,.5`-- 小数点前逗号
*   `(123,456789,012`-- 如果有逗号，它们应该在每个三元组之间
*   `(01234`-- 前导零不是常规的
*   `(123.4X`-- 最后一个字符不是结束括号

这是一个替代正则表达式，它应该拒绝上面的示例：

`[-+]?[$]?(0|[1-9]\d*|[1-9]\d{0,2}(,\d{3})*)(\.\d+)?`

*   可选的前导加/减。
*   可选的美元符号。
*   三个选项由 分隔`|`：
    *   单个零数字（对于 0.5 或简单的 0 等数字）。
    *   不带逗号的任意位数。第一个数字不能为零。
    *   逗号分隔的数字。第一个数字不能为零。第一个逗号前最多三位数字。每个逗号后面必须紧跟三位数字。
*   可选的单个小数点，后面必须跟一位或多位数字。

关于括号，如果您只关心括号是否平衡，那么您可以忽略精确解析出数字格式；只要相信括号之间的数字、小数点和逗号的任何组合都是有效的。如果输入与内部的正则表达式*不*匹配，则使用`(?!...)`计算为匹配的构造。

 *`(?!\([$\d.,]+\))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:16:29.250

我发现在定制正则表达式时使用[kiki非常有帮助。](http://code.google.com/p/kiki-re/)它直观地向您展示您的正则表达式发生了什么。这是一个巨大的节省时间。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-12T00:02:56.827

我一眼看到的一个区别是您的正则表达式不会找到如下字符串：

```
(123,,, 
```

这是因为更正后的版本要求逗号之间至少有一位数字。（我会说这是一个合理的要求。）

# communication - 如何在开发团队内平衡区域时间与开放和积极的沟通？

> ID：361451
> 
> 赞同：-4
> 
> 时间：2008-12-11T23:45:48.250
> 
> 标签：communication, collaboration

如何在开发团队中平衡“区域”时间与开放和积极的沟通？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T23:48:07.980

阅读“人品”

带门的办公室。

可以关闭的手机。

电子邮件

带白板的可用公共区域。

在某些发展阶段，大量协作非常有成效，而在其他时候，个人关注很重要。此外，人们的工作方式不同——你不想打扰那些在独处时做得更好的人，也不想孤立那些需要反馈和帮助的人。我会避免规则，只是向团队明确说明这是一个问题，每个开发人员都应该执行他们自己想要的环境。管理层应该支持它。

有用的会议很棒，但作为“开放式沟通”的工作环境的开放式牛棚是想要密切关注所有员工的 beancounter 或经理的梦想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T04:13:21.937

我们的办公室最近改用了蒂姆所说的“牛棚”风格。至少可以说，软件人员不为所动。为了解决这个问题，我们实现了以下内容：

1) 部门内部邮件列表

2) 开发团队内部邮件列表

3) 每个开发人员都可以通过 Google Talk 进行讨论，而无需离开我们的办公桌

4）耳机意味着“最好是重要的”

5) 如果超过 2 人需要一起交谈，你可以找一个会议空间，这样你就不会打扰你的同事。

6) 我们通常只使用电子邮件与客户交谈或通过附件向个人提供文件。

这些操作的结果是通信中的信噪比要好得多，因为您不会整天被电子邮件轰炸。

我们尝试过但效果不佳的一件事是 Google Talk 的“聚会聊天”功能（基本上使用 Google Talk 联系人作为精简的 IRC 聊天室）。这可能是因为我们的许多开发人员都很年轻（我们全年有 3 到 15 个大学合作社），但“聚会聊天”成为一个非常贴切的名称，它最终用于它的用途。

在我工作的地方，白板很少见，但我们向管理层出售了一个最多可供 6 人使用的房间的概念，他们可以躲起来进行密集的设计和开发。它有几块白板，一个门，除了一个之外的所有灯都可以关闭，这样你就不会觉得荧光太阳在你的头顶。这在您的工作环境中可能是不可能的，但如果将其视为紧张“区域”时间的空间。

# mysql - 不同机器上MySQL时间减法不一致

> ID：361455
> 
> 赞同：2
> 
> 时间：2008-12-11T23:47:32.223
> 
> 标签：mysql, date, subtraction

我有一个结构如下的 MySQL 查询：

```
SELECT time(c.start_time),
       time(c.end_time),
       time(c.end_time) - time(c.start_time) as 'opening_hours' 
FROM my_shop c; 
```

开始和结束时间的数据分别为 1970-01-01 07:00:00 和 1970-01-01 19:00:00。

在我的本地机器上，这个查询返回：

```
| 07:00:00 | 19:00:00 | 12 | 
```

但是在远程机器（生产）上它正在返回

```
| 07:00:00 | 19:00:00 | 120000 | 
```

关于为什么会发生这种情况以及如何解决它的任何想法？

两组数据是相同的，据我所知，两个 MySQL 安装也是相同的。

任何帮助深表感谢。

更新：

MySQL 的版本似乎略有不同：5.0.27-community-nt 与 5.0.51b-community-nt。这很可能是原因。

djt 提出了一个很好的观点，即比尔的解决方案没有考虑分钟数。以及这个 djt 的解决方案并不是我所需要的。

所以我想这个问题已经演变成如何减去两次，包括分钟，这样：

```
1970-01-01 19:00:00 - 1970-01-01 07:00:00 = 12 
1970-01-01 19:00:00 - 1970-01-01 07:30:00 = 11.5
1970-01-01 19:00:00 - 1970-01-01 07:45:00 = 11.25 
```

等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T00:49:43.690

我会这样做：

```
SELECT TIME(c.start_time),
       TIME(c.end_time),
       EXTRACT(HOUR FROM TIMEDIFF(TIME(c.end_time), TIME(c.start_time)))
         AS 'opening_hours' 
FROM my_shop c; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:53:36.740

通常导致不同输出的相同方法给人的印象是它是不同的服务器配置或版本。我真的无法提供帮助，但可能值得在您的查询中尝试以下方法：

> ```
> SELECT TIME(c.start_time),
>        TIME(c.end_time),
>        TIMEDIFF(TIME(c.end_time), TIME(c.start_time)) as 'opening_hours'
> 
> FROM my_shop c; 
> ```

这将为您提供开放时间、分钟和秒的格式化时间戳。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T04:53:26.163

有没有比这更好的解决方案：

```
SELECT EXTRACT(HOUR FROM TIMEDIFF(TIME(c.end_time), TIME(c.start_time))) 
+ ((EXTRACT(MINUTE FROM TIMEDIFF(TIME(c.end_time), TIME(c.start_time))))/60)
FROM my_shop c; 
```

# watin - 在不同的机器上访问不同的 url 以进行 Watin 测试

> ID：361456
> 
> 赞同：1
> 
> 时间：2008-12-11T23:47:36.717
> 
> 标签：watin

是否有一种通用的方法可以访问本地机器 csproj.user 文件以获取 watin 测试的网站 url，以便测试可以在每个开发人员本地服务器以及构建服务器上的 IIS 上运行？我想你可以自己解析 xml 文件，但我想知道是否有更清洁/更简单的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T04:07:05.710

我找到了这个

[作为单元测试设置的一部分启动 ASP.NET 开发 Web 服务器 (Cassini)？](https://stackoverflow.com/questions/328566/starting-aspnet-development-web-server-cassini-as-part-of-unit-test-setup)

最后只是用从我的测试项目到我的 Web 项目的相对路径做这样的事情。然后在构建服务器上设置适当的 csproj.user 文件。

公共静态字符串 GetDevelopmentServerURL(string csprojFileName) { XPathDocument doc = new XPathDocument(csprojFileName); XPathNavigator 导航器 = doc.CreateNavigator();

```
 XmlNamespaceManager manager = new XmlNamespaceManager(navigator.NameTable);
        manager.AddNamespace("msbuild",
            "http://schemas.microsoft.com/developer/msbuild/2003");

        const string xpath = "/msbuild:Project/msbuild:ProjectExtensions/"
                           + "msbuild:VisualStudio/msbuild:FlavorProperties/"
                           + "msbuild:WebProjectProperties";

        XPathNavigator webProjectPropertiesNode =
            navigator.SelectSingleNode(xpath, manager);
        XPathNavigator developmentServerPortNode =
            webProjectPropertiesNode.SelectSingleNode("msbuild:DevelopmentServerPort",
                manager);
        XPathNavigator developmentServerVPathNode =
            webProjectPropertiesNode.SelectSingleNode("msbuild:DevelopmentServerVPath",
                manager);
        XPathNavigator UseIIS =webProjectPropertiesNode.SelectSingleNode("msbuild:UseIIS",
    manager);
        XPathNavigator IISPath = webProjectPropertiesNode.SelectSingleNode("msbuild:IISUrl",
    manager);
        XPathNavigator UseCustomServer = webProjectPropertiesNode.SelectSingleNode("msbuild:UseCustomServer",manager);
        XPathNavigator CustomeServerPath = webProjectPropertiesNode.SelectSingleNode("msbuild:CustomServerUrl",
    manager);
        if (UseIIS.Value == "True")
            return IISPath.Value;
        if (UseCustomServer.Value == "True")
            return CustomeServerPath.Value;
        return "http://localhost:" + developmentServerPortNode.Value + developmentServerVPathNode;
    } 
```

# c# - C# - 无法设置 form.height

> ID：361457
> 
> 赞同：4
> 
> 时间：2008-12-11T23:47:46.093
> 
> 标签：c#, winforms, .net-2.0

我在 C# 表单上的一对按钮单击事件处理程序中有此代码：

```
class frmLogin
{
    private const int SHORT_HEIGHT = 120;
    private const int LONG_HEIGHT = 220;

    private EventHandler ExpandHandler;
    private EventHandler ShrinkHandler;

    public frmLogin()
    {
        InitializeComponent();
        ExpandHandler = new EventHandler(btnExpand_Click);
        ShrinkHandler = new EventHandler(btnShrink_Click);
        btnExpand.Click += ExpandHandler;
    }

    private void btnExpand_Click(object sender, EventArgs e)    
    {
        this.Height = LONG_HEIGHT;
        btnExpand.Text = "<< Hide Server";
        btnExpand.Click -= ExpandHandler;
        btnExpand.Click += ShrinkHandler;
    }

    private void btnShrink_Click(object sender, EventArgs e)
    {
        this.Height = SHORT_HEIGHT;
        btnExpand.Text = "Choose Server >>";
        btnExpand.Click -= ShrinkHandler;
        btnExpand.Click += ExpandHandler;
    }
} 
```

文本更改没有问题，但在一台特定的客户端机器上，戴尔 M4300 笔记本电脑工作站，高度更改不会生效。有没有人解决过类似的问题，如果有，解决方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T14:05:34.993

我的猜测：该机器上的 DPI 或系统字体大小不同，并且表单的 AutoScaleMode 是“Font”或“Dpi”，使表单的 MinimumSize 或 MaximumSize 阻止更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T02:32:24.480

检查笔记本电脑的显示模式，特别是检查纵横比设置。有时笔记本电脑会做一些奇怪的事情来促进宽而短的屏幕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T03:20:42.590

确保您没有将这些 AutoScale/Size/Whatever 属性之一设置为 true。

# jquery - 使用 XmlHttpRequest 时，有什么方法可以抑制浏览器在 401 响应中的登录提示

> ID：361467
> 
> 赞同：8
> 
> 时间：2008-12-11T23:54:58.310
> 
> 标签：jquery, ajax, internet-explorer, firefox, xmlhttprequest

我正在使用 jQuert .ajax 函数来调用页面方法。该站点正在使用 FormsAuthentication。因此，当身份验证票证到期时，对 page 方法的调用显然会导致重定向到登录页面。

现在，编写 System.Web.Handlers.ScriptModule 的天才们决定，如果出于某种原因，从 JavaScript 对页面方法或 Web 服务方法的 REST 样式调用导致 302 重定向，他们将只是简单地将响应 401 Unauthorized。这会导致浏览器弹出一个完全误导的登录 UI，因为用户尝试输入他们的用户名和密码，这没有任何意义，因为使用了 FormsAuthentication。最后，当用户单击“取消”时，401 将传递给错误处理程序。

那么，问题是，如何以任何方式禁用浏览器的登录 UI 提示？网上有人建议在 XHR 请求中使用用户名和密码，但似乎不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T00:39:22.977

我想我已经解决了。当然，依靠内部的 MS AJAX 相关错误并不是很好，但这将解决其他人面临这个问题的窍门。

基本上你所做的，是将**X-MicrosoftAjax**标头设置为值**Delta=true**（这里大小写很重要），ScriptModule 会将其解释为正常重定向，并将响应转换为**200**，但会设置**pageRedirect**数据要使用的页面上的任何 ScriptManager (MS-AJAX PageRequestManager) 的字符串。jQuery.ajax 函数仍然会将此视为错误，因此基本上您可以在 XHR 的 responseText 属性中检查**pageRedirect**并相应地处理它。就像将用户发送到某事的登录页面。

```
 $.ajax({
            type: "POST",
            url: postUrl + "/SomePageMethod",
            data: "{searchString:\"" + escape(searchString) + "\"}",
            contentType: "application/json; charset=utf-8",
            beforeSend: function(xhr) {
                xhr.setRequestHeader("X-MicrosoftAjax","Delta=true");
            },
            dataType: "json",
            success: onSuccess,
            error: onError
        });

function onError(xhr, e, textStatus) {
    var isAjaxRedirect = xhr.status == 200 && xhr.responseText.match(/pageRedirect/);
    if (isAjaxRedirect == "pageRedirect") {
        // forms authentication ticket expired
        location.href = "a session timeout page, or a login page or whatever";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-23T10:02:40.867

这可以在 IIS 中禁用。下面描述的详细信息适用于 IIS6，但不难找到 IIS7 及更高版本的相关项目。

1.  查找相关站点。
2.  在您的 IIS 版本中打开“目录安全”选项卡或相关选项卡
3.  单击“身份验证和访问控制”部分中的“编辑”
4.  取消勾选“集成 Windows 身份验证”

您应该不再在浏览器中看到弹出窗口，并且能够根据需要发回正确的状态代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-12T07:47:37.300

两者都是很好的答案。但是，如果您的网站托管在共享服务器中，您可能无法更改 IIS 设置，因此客户端解决方案会出现问题。我一直面临同样的问题，这篇文章拯救了我。我对解决方案的两分钱：在 jquery 中（至少在最新版本中），您可以使用名为“header”的参数来发送此标头而不使用“beforeSend”回调，我认为这可能是一种更清洁的方式相同。您还可以在此处添加其他标题信息：

```
$.ajax({
            type: "POST",
            url: postUrl + "/SomePageMethod",
            data: "{searchString:\"" + escape(searchString) + "\"}",
            contentType: "application/json; charset=utf-8",
        headers: { "cache-control": "no-cache", "X-MicrosoftAjax" : "Delta=true" },
            dataType: "json",
            success: onSuccess,
            error: onError
        }); 
```

我不知道这个header“Delta=true”，[经过一番研究](http://books.google.es/books?id=GkWTN3cVDRQC&pg=PA165&lpg=PA165&dq=que%20es%20x-microsoftajax%20delta=true&source=bl&ots=F1YYQipM4u&sig=Nm_VMJvDoPt0YSbp7mWpdG0HUWE&hl=es&sa=X&ei=Et5IU9mILaPx0gX7lYHABA&ved=0CI4BEOgBMAk#v=onepage&q=que%20es%20x-microsoftajax%20delta=true&f=false)，它似乎是一个header，告诉服务器你正在做的请求是一个异步回发请求。

AJAX 调用将在“错误”回调中返回 HTTP 状态 200（而不是“未授权”401），这意味着服务器请求以某种方式成功（尽管身份验证失败）。有点奇怪，但它的工作方式。

希望这可以帮助。

# c# - .NET 源代码可以硬编码调试断点吗？

> ID：361468
> 
> 赞同：76
> 
> 时间：2008-12-11T23:55:00.757
> 
> 标签：c#, visual-studio, .net-2.0, breakpoints

我正在寻找一种在.NET（特别是2.0，特别是C#）中为源代码触发调试中断的方法，就像在该点设置了断点一样，而不必记住在调试器中设置特定的断点，并且不干扰生产运行时。

我们的代码需要吞下生产中的异常，因此我们不会破坏链接到我们的客户端应用程序，但我正在尝试对其进行设置，以便如果碰巧在调试器中运行此类错误将弹出以进行分析，否则将被安全地忽略。

我的使用尝试`Debug.Assert(false)`并不理想，我认为它`Debug.Fail()`的行为方式相同。从理论上讲，它在生产中应该没有影响，并且在调试时确实会成功停止，但是根据设计（据我所知），如果您想忽略该错误，则无法继续执行，就像使用实际断点一样，就像我们在生产中吞下错误一样。它显然也破坏了对变量状态的评估，因为调试器实际上在本机系统代码中停止，而不是在我们的系统代码中，所以它的调试帮助是有限的。（也许我错过了一些重新审视事物以查看变量等发生的地方的方法。？？？）

我希望有类似的东西`Debug.Break()`，但它似乎不存在（除非可能在更高版本的 .NET 中？），而且`Debug`似乎也没有其他方法适用。

**更新：**虽然 ctacke 的答案是我所寻找的最佳匹配，但我还发现了 Debug.Assert() 的一个技巧——在调试器中运行时——暂停调试器，转到调试代码。断言调用挂起（以绿色突出显示，因为它在框架代码中已关闭）并点击 Step-Out (shift-F11)，然后在断言对话框中点击 Ignore。这将使调试器在断言返回时暂停（并且能够继续执行，就好像它没有发生一样，因为它被忽略了）。可能还有其他方法可以做同样的事情（点击重试会更直接吗？），但这种方式很直观。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2008-12-12T00:02:20.277

您可能正在追求这样的事情：

```
if(System.Diagnostics.Debugger.IsAttached)
  System.Diagnostics.Debugger.Break(); 
```

当然，这仍然会在发布版本中编译。如果您希望它的行为更像 Debug 对象，其中代码根本不存在于 Release 构建中，那么您可以执行以下操作：

```
 // Conditional("Debug") means that calls to DebugBreak will only be
    // compiled when Debug is defined. DebugBreak will still be compiled
    // even in release mode, but the #if eliminates the code within it.
    // DebuggerHidden is so that, when the break happens, the call stack
    // is at the caller rather than inside of DebugBreak.
    [DebuggerHidden]
    [Conditional("DEBUG")] 
    void DebugBreak()
    {
        if(System.Diagnostics.Debugger.IsAttached)
            System.Diagnostics.Debugger.Break();
    } 
```

然后在您的代码中添加对它的调用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-11T23:58:57.910

我曾经遇到过这种情况不起作用

```
System.Diagnostics.Debugger.Break(); 
```

但这确实

```
System.Diagnostics.Debugger.Launch(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-11T23:56:42.050

`System.Diagnostics.Debugger.Break`?

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-05-27T14:15:57.717

如果您只想有一行代码而不是 4 行，请换行

```
#if DEBUG
       if (Debugger.IsAttached)
            Debugger.Break();
#endif 
```

进入

```
public static class DebugHelper
{
    [DebuggerHidden]
    [Conditional("DEBUG")]
    public static void Stop()
    {
       if (Debugger.IsAttached)
            Debugger.Break();
    }
} 
```

并使用

```
DebugHelper.Stop(); 
```

`DebuggerHiddenAttribute`已添加以防止调试器在`Stop`方法的内部代码上停止并使用`F11`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-12T00:02:41.820

即使您吞下它，只需将 Visual Studio 配置为弹出调试器怎么样？

做这个：

*   转到调试-> 异常...
*   找到正确的例外，或者如果它是您自己的，则添加它
*   检查异常的“抛出”复选框

这将在引发异常的位置停止 Visual Studio，而不仅仅是在未处理异常的情况下。

[您可以在此处](http://www.mattbrindley.com/developing/windows/first-chance-exception-handlin/)查看更多信息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T08:12:19.710

我发现一个不错的技巧是将 Debugger.Break() 放在异常的 ctor 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-22T20:52:53.847

在 Visual Studio 2010 中，点击对话框上的**重试会将**`Debug.Assert`您带到失败的调试断言，就像您有一个断点一样。

# logging - 每个 Web 服务/页面使用单独的 log4net

> ID：361471
> 
> 赞同：3
> 
> 时间：2008-12-11T23:55:55.123
> 
> 标签：logging, log4net

我有一个包含多个 Web 服务的 Web 应用程序。此 Web 应用程序具有业务和持久层。是否可以为每个 Web 服务使用单独的日志附加程序（日志文件）？

这也适用于网页。本质上，我想分离我的日志不是基于类或层/命名空间，而是从入口点，可以是 Web 服务或网页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T01:23:06.197

您可以定义要在每个 Web 服务中获取的记录器：

```
namespace log4net
{
    public class LogManager
    {
        public static ILog GetLogger(string name);
        public static ILog GetLogger(Type type);
    }
} 
```

然后在您的应用程序中，您可以适当地调用每个记录器：

```
public class MyApp 
{
    // Define a static logger variable so that it references the
    // Logger instance named "MyApp".
private static readonly ILog log = LogManager.GetLogger(typeof(MyApp));

static void Main(string[] args) 
{
    // Set up a simple configuration that logs on the console.
    BasicConfigurator.Configure();

    log.Info("Entering application.");
    Bar bar = new Bar();
    bar.DoIt();
    log.Info("Exiting application.");
}
} 
```

确保更改`typeof`为正确的 Web 服务。

来源和更多信息[在这里](http://log4net.sourceforge.net/release/1.2.0.30316/doc/manual/introduction.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-19T21:12:00.340

我建议在每个页面中使用[嵌套诊断上下文](http://logging.apache.org/log4net/release/manual/contexts.html)(NDC)，然后根据 NDC 过滤日志输出。

NDC 信息将包含在从当前线程上下文记录的事件中，其中将包括页面代码、服务代码、存储库代码等。

使用[对 NDC 内容的过滤，](http://log4net.sourceforge.net/release/1.2.0.30316/doc/manual/introduction.html#loggers-and-appenders.filters)您可以将日志输出与各种服务分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T14:42:05.653

Gortok，这是我们处理日志的典型方式。但是，我的意思有所不同，我认为我的问题不够清楚。

这是一个假设的示例：我们有一个 Web 应用程序，它有一些管理页面和一些客户页面，我们希望每组页面有两个不同的 admin.log 和 customer.log 文件。两组页面都使用业务层（包括CustomerService、OrderService等）和存储层CustomerRepository、OrderRepository等）。应用程序中的所有层和类都在两组页面中使用，但我们希望将日志分开。当管理页面中发生异常并且您浏览与跟踪问题相关的日志时，这会更容易。您提到的记录事物的典型方式的解决方案并未涵盖这种情况，因为当您使用**typeof(MyApp)**（MyApp 是类或命名空间的名称）不会根据用户发起请求的页面来指示要使用的附加程序。

也许处理这种情况的一种方法是在整个应用程序中使用域值对象，并在用户在 UI 级别发起请求时将其值设置为适当的记录器，并在您在每个中定义记录器时使用该值作为构造函数参数班级。但我想知道在 log4net 中是否有更好的方法来处理我不知道的这种方法。

我的问题现在更清楚了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-28T18:12:30.283

我可以使用 PropertyFilter 来做到这一点。我在配置文件中定义了以下附加程序：

```
<appender name="UiFileAppender" type="log4net.Appender.RollingFileAppender">
  <file value="Log1.log" />
  <appendToFile value="true" />
  <rollingStyle value="Size" />
  <maxSizeRollBackups value="10" />
  <maximumFileSize value="5MB" />
  <staticLogFileName value="true" />
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
  </layout>
  <filter type="log4net.Filter.PropertyFilter">
    <Key value="channel"/>
    <StringToMatch value="ui" />
    <AcceptOnMatch value="true" />
  </filter>
  <filter type="log4net.Filter.DenyAllFilter" />
</appender>
<appender name="WsFileAppender" type="log4net.Appender.RollingFileAppender">
  <file value="Log1.log" />
  <appendToFile value="true" />
  <rollingStyle value="Size" />
  <maxSizeRollBackups value="10" />
  <maximumFileSize value="5MB" />
  <staticLogFileName value="true" />
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
  </layout>
  <filter type="log4net.Filter.PropertyFilter">
    <Key value="channel"/>
    <StringToMatch value="ws" />
    <AcceptOnMatch value="true" />
  </filter>
  <filter type="log4net.Filter.DenyAllFilter" />
</appender> 
```

上述 appender 的重要部分是标签。当用户使用 UI 时，我将“channel”属性设置为“ui”，如下代码：

```
log4net.GlobalContext.Properties["channel"] = "ui"; 
```

当用户使用网络服务时，我使用以下代码：

```
log4net.GlobalContext.Properties["channel"] = "ws"; 
```

发起请求时，我需要在最高级别的条目上设置“通道”属性。

# mysql - mysql：使用 AND 样式查询连接表 + 查找记录，而不是 OR

> ID：361477
> 
> 赞同：3
> 
> 时间：2008-12-11T23:58:27.600
> 
> 标签：mysql, sql, sql-match-all

注意：使用 MySQL 4.0，这意味着没有子查询（目前）。

我有 2 张桌子：

*   一个“user_details”表
*   一个“skills”表，其中包含 user_id 和一个“skill_id”，它映射到在别处定义的预定义技能集。

当前查询允许管理员通过选择技能来搜索用户，并且查询以 OR 方式工作，例如：

```
LEFT JOIN skills 
ON (ud.user_id = skills.user_id)  
WHERE skills.skill_id in (51, 52, 53, 54, 55)
GROUP BY ud.user_id 
```

这会返回太多记录，因此我希望此搜索字段以 AND 方式工作，其中用户必须具有所有选定的技能才能在搜索中返回。

如果子查询是最好的选择，那么升级 MySQL 是可能的。

编辑：与分组，计数，拥有等有关。您可以通过命令限制分组，并要求您返回多少匹配的行？（例如本例中的 5）。

编辑2：测试：

```
HAVING COUNT( * ) > 5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T00:33:46.140

您不需要子查询或联接。

```
SELECT user_id
FROM skills
WHERE skill_id IN (51, 52, 53, 54, 55)
GROUP BY user_id
HAVING COUNT(*) = 5; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:27:41.503

只需添加更多单连接。

INNER JOIN 技能 s ON u.id - us.userid AND Skill_id = $s1
INNER JOIN 技能 s ON u.id - us.userid AND Skill_id = $s2
INNER JOIN 技能 s ON u.id - us.userid AND Skill_id = $ s3
INNER JOIN 技能 s ON u.id - us.userid AND Skill_id = $s4
等。

它将被要求加入他们所有人。您不需要任何组或计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T01:46:07.710

如果您希望在同一查询中包含用户详细信息，您可以简单地执行以下操作：

```
SELECT * FROM user_details  
JOIN skills USING (user_id) 
WHERE skill_id IN (51, 52, 53, 54, 55) 
GROUP BY user_id 
HAVING COUNT(*) = 5 
```

# user-interface - 什么时候真正需要模态对话框？

> ID：361481
> 
> 赞同：9
> 
> 时间：2008-12-12T00:00:52.227
> 
> 标签：user-interface, usability, modal-dialog

模态对话框是邪恶的，但我一直在阅读“你应该尽可能删除模态*对话框*”

什么时候不能删除模态对话框？我的意思是，有哪些真正的模态任务迫使我们使用邪恶的模态对话框？

最常见的示例是“您要保存吗？” 我认为这是让用户点击 Save 而不是记住**用户输入是神圣**的概念的问题。如果您只是自动保存并能够“撤消”或进行修订，那么您无需询问用户是否要保存。

*   “你确定你要删除？” 取消删除
*   “你确定你要退出吗？” 你为什么要问这个？你就那么虚荣吗？

为什么我们需要模态对话框？

**编辑**

Webs 应用程序不算在我的书中，除非他们在浏览器中编写自己的 UI 窗口系统。Web 应用程序没有设置与桌面应用程序相同的工具。

**编辑 2**

我的问题与标记为重复的问题略有不同。我觉得模态对话框并不是最好的解决方案。提到的问题假设存在这种情况。

### 重复：[模态 UI 何时可接受](https://stackoverflow.com/questions/152938/when-is-modal-ui-acceptable)？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T00:05:39.753

### 模态对话框的用例

*   阻止应用程序流程，直到输入继续所需的信息，例如登录过程中的密码。
*   在集中式对话框中收集应用程序配置选项。在这种情况下，通常会在关闭对话框时应用更改，并且在进行编辑时禁用对应用程序的访问。
*   警告当前操作的影响是不可逆的。这是模态对话框的常见交互模式，但可用性专家也批评它对其预期用途（防止破坏性操作中的错误）无效，并且存在更好的替代方案。

（来源：[维基百科](http://en.wikipedia.org/wiki/Modal_window)）

### 当我使用它们时

在某些情况下，阻止他们做愚蠢的事情是绝对必要的。我的公司有一个网络应用程序，用户有时会在完成工作之前离开页面。`onbeforeunload`如果他们没有保存他们的工作，我们会使用 Modal（标准 JavaScript 函数）提示他们。

否则，如果我能提供帮助，我不会使用 Modals，当应用程序从我正在做的事情中窃取焦点时，我讨厌它。

**编辑**：当他们离开页面时，我们不会自动为他们保存他们的工作。我们在其他时间这样做，但不是在他们离开页面时，因此是 Modal。我确实写了可以在他们离开页面时进入并保存他们的工作的可能，但实现它并不是一个“好”的主意，特别是如果他们不小心删除了他们的工作并且不希望它自动保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:17:56.187

唯一比用户输入更神圣的是我知道的任何文件。除非我告诉你，否则你不应该修改任何包含实现细节的文件。因此像“你想保存吗？”这样的框。退出是必须的，因为我可能*不想*保存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-30T19:18:33.247

想象一个应用程序需要为某些操作打开一个对话框。现在想象这些将是非模态对话框：当一个对话框打开时，您可以更改选择，甚至更糟 - 调用一个不同的命令，该命令本身会打开另一个对话框。现在想象这些对话框将是模态的：那么您将不得不关闭对话框才能继续 - 您无法进入对话框下选择更改或两个命令正在等待输入的状态。

# asp.net - asp.net 文本框的列属性的实际像素大小

> ID：361487
> 
> 赞同：1
> 
> 时间：2008-12-12T00:04:56.837
> 
> 标签：asp.net, textbox, column-width

当我使用 columns 属性来确定 ASP.NET 文本框控件的宽度时，一列的确切像素大小是多少？

```
<asp:TextBox id="MyTextBox" runat="server" columns="10" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T00:30:47.143

Columns 属性映射到呈现的输入标记上的大小属性。

如果 size 为 10，那么浏览器应该以可以容纳 10 个字符并在输入字段中可见的大小呈现输入字段。但这仅适用于等宽字体，因为在许多其他字体中，“III”的像素长度与“MMM”不同。

所以通常你最好像 Ryan 所说的那样使用 CSS-width。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:17:22.007

我总是使用：

```
style="width: 250px;" 
```

这样你就可以准确地设置它。否则它将取决于文本框的字体大小以及浏览器呈现它的方式。

另一方面，行是我一直在努力解决的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-12T00:29:27.210

@Ryan Smith：我使用了您的建议并对其进行了修改，以使其可扩展到用户监控设置。

```
style="width: 100%" 
```

# silverlight - Silverlight 2 参数异常

> ID：361490
> 
> 赞同：3
> 
> 时间：2008-12-12T00:08:11.107
> 
> 标签：silverlight, silverlight-2.0

我有一个 silverlight 2 应用程序，它有一个来自单独的 assem/lib 的类的 ObservableCollection。当我在该集合上设置 ListBox.ItemsSource 并运行它时，我收到错误代码：

> 4004 “System.ArgumentException：值不在预期范围内。”

以下是部分代码：

```
public partial class Page : UserControl
{
    ObservableCollection<Some.Lib.Owner> ooc;

    public Page()
    {

        ooc = new ObservableCollection<Some.Lib.Owner>();
        Some.Lib.Owner o1 = new Some.Lib.Owner() { FirstName = "test1" };
        Some.Lib.Owner o2 = new Some.Lib.Owner() { FirstName = "test2" };
        Some.Lib.Owner o3 = new Some.Lib.Owner() { FirstName = "test3" };
        ooc.Add(o1);
        ooc.Add(o2);
        ooc.Add(o3);

        InitializeComponent();
        lb1.ItemsSource = ooc;
    }
} 
```

但是当我在同一个项目中创建 Owner 类时，一切正常。幕后是否有一些安全问题？此外，当我创建此 Silverlight 2 应用程序时，我使用的是生成 html 页面选项而不是 aspx 选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T00:47:53.240

您是在尝试使用标准类库还是“Silverlight 类库”？

因为 Silverlight 2 使用 CLR 的子集，所以它无法访问使用完整 CLR 编译的标准类库。要使用外部程序集，您必须将其创建为“Silverlight 类库”。这将创建一个仅包含 Silverlight 可用的命名空间的项目，并允许您在 Silverlight 项目中引用该程序集。

查看 MSDN 文章[“用于 Silverlight 的 .NET Framework 类库”](http://msdn.microsoft.com/en-us/library/cc838194(VS.95).aspx)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-24T00:52:34.190

这可能是因为您没有处理 SubmittedChanges() 中的失败。有关更多信息，请参见[http://www.scottleckie.com/2010/04/code-4004-unhandled-error-in-silverlight-application/](http://www.scottleckie.com/2010/04/code-4004-unhandled-error-in-silverlight-application/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-17T01:19:35.550

> 现在一切都在一个项目中。

是的，但不像你刚才那样做，而是分享、*链接到*文件。

当需要在应用程序和服务之间共享公共代码时，这是一个古老的 Silverlight 绝地*思维技巧。*`entity`这是在由于 .Net/CLR 中的差异而无法引入库时完成的。

诀窍是将文件作为*链接*包含到另一个项目中。这是如何

1.  在需要代码文件的目标（Silverlight 项目）文件夹中，右键单击然后`Add`选择`Existing Item...`或`shift` `alt` `A`。
2.  浏览到找到的源文件的位置并选择/那些文件。
3.  选择项目后，在`Add`按钮上选择下拉箭头。
4.  选择`Add as link`以将文件作为链接添加到文件夹中。

![在此处输入图像描述](https://i.stack.imgur.com/481u3.png)

完成后，只有一个副本，但建在两个不同的地方。

这样就可以访问该文件*，就好像*该文件实际上位于项目的文件夹中一样，但该文件实际上位于其他地方……并避免了 CLR 问题。

# c# - Silverlight 启用 WCF 服务、Web 服务、ADO.NET 数据服务

> ID：361491
> 
> 赞同：18
> 
> 时间：2008-12-12T00:08:28.313
> 
> 标签：c#, .net, silverlight, wcf, web-services

好的，所有这些在 Silverlight 控件中获取数据的方法都让我感到困惑。

我查看了 ADO.Net 数据服务、Web 服务和启用 Silverlight 的 WCF 服务。我只是不确定什么时候适合使用另一个。每个提供什么优点/缺点？

我已经构建了一个 Web 应用程序和一个 Silverlight 控件。我将向我的 Web 应用程序添加这 3 个选项之一，并从我的 Silverlight 组件中使用它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T05:25:10.810

从 silverlight 的角度来看，WCF 无论如何都受到严格限制，因此 WCF 的大多数*通常*的好处都不适用。然而，它仍然是一个相当不错的、一致的编程模型。

WCF 主要是一个 SOAP 堆栈，因此它非常擅长将数据呈现为刚性操作。ADO.NET 数据服务是一个 REST 堆栈，允许通过网络动态执行非常有表现力的查询。

我不知道它在 Silverlight 中的情况如何，但常规的 ADO.NET 数据服务代理（客户端应用程序上的位）对查询和返回服务器的数据更改具有非常丰富的支持。请注意，应用更改需要 a：实体框架，或 b：大量工作。但是您应该使用这种方法非常便宜地获得查询和更新。

使用 WCF，您可以获得更可控的堆栈，因此您需要编写所有您希望能够执行的不同操作。但这也意味着你有一个已知的攻击面等；像固定的 SOAP 端点那样利用锁定的 API 要困难得多。

重新常规 Web 服务（WCF 之前）：如果您想支持非常特定的遗留调用者，请仅走这条路线。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-19T17:50:35.400

我知道这是旧的，但我只想加我的 2 美分。

我强烈推荐使用 WCF；并通过启用 Silverlight 的 Web 服务使用 WCF 服务库项目。它们本质上是相同的，但是启用 Silverlight 的 Web 服务将绑定更改为基本而不是 ws*。它还添加了一个 asp.net 兼容模式属性。

* * *

*   WCF*通常*更快：请参阅“Windows Communication Foundation (WCF) 与现有分布式通信技术的性能比较”@ [http://msdn.microsoft.com/en-us/library/bb310550.aspx](http://msdn.microsoft.com/en-us/library/bb310550.aspx)

*   WCF 封装了 asmx、wse、msmq、企业服务和远程处理。

*   WCF 服务可以包含并在 iis、windows 窗体等中运行。

*   WCF 不限于使用 HTTP，但通过最少的配置也可以使用 tcp、命名管道等。

*   复杂的数据类型更容易公开和序列化。

*   WCF 的扩展性非常好。此外，它们还可用于合并 WF 的工作流程。

* * *

可能没有使用错误的技术，但似乎 Microsoft 将继续使用 WCF。另外，编写一个代码库要容易得多，只需对 WCF 服务进行一些配置更改即可以多种不同的方式公开该代码库。

我建议不要使用启用 Silverlight 的 Web 服务，因为 WCF 模型的编程结构设置得更好一些，但这可能是一个见仁见智的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T05:07:55.820

如果您必须在 Web 服务和 WCF 服务之间进行选择，我的建议是使用 WCF。它是更现代、更强大的技术。至于 ADO.Net 数据服务 - 如果您只需要从服务器上的数据库检索/提交一些数据，则可以使用它。

# modal-dialog - 为什么模态对话框是邪恶的？

> ID：361493
> 
> 赞同：42
> 
> 时间：2008-12-12T00:09:16.923
> 
> 标签：modal-dialog

重新提出最近的问题，[即模式对话框何时真正需要？](https://stackoverflow.com/questions/361481/when-are-modal-dialogs-truly-necessary). 为什么模态对话框是邪恶的？是因为人们无论如何都不读它们吗？因为它们经常执行得很差？还有什么？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-12T01:57:47.517

到目前为止，大约一半的答案是解决*确认*对话框的缺陷，而不是*模式*对话框的缺陷。虽然绝大多数确认对话框都是模态的，但这并不意味着这两个术语是同义词。

*模*态对话框是将程序置于特定*模式*并且不允许您在打开时执行与该模式不对应的任何操作的对话框。在最常见的实现中，这意味着您无法访问任何其他窗口。

这是邪恶的。

考虑一个地址簿应用程序。假设您在通讯录中有一个现有的人，并且您希望添加他们的室友。

*   如果“添加人员”对话框是非模态的，您可以在旧记录和新记录之间来回切换，复制和粘贴您的数据。
*   如果“添加人员”对话框是模态的，则在添加对话框打开时，您无法对旧记录执行任何操作。您可以在选择“添加”之前选择要复制的内容，但只有一件事。其他所有内容都必须手动重新输入。

在极少数情况下，您会遇到真正必须一次性完成的事情，而不允许用户在完成之前偏离该任务。模态对话框适用于这种情况。 *但这种情况非常罕见！* 这基本上是这个问题引用的另一个线程的重点。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-12-12T00:13:34.980

人们不阅读它们，这是一件好事。您希望人们围绕您的 UI 形成习惯，但是在弹出窗口中有一个重要的选择只会让用户点击 OK。

它们打断用户，阻止用户做其他事情。

如果您想从主窗口复制和粘贴一些东西怎么办？如果您想在模态对话框中复制消息怎么办？如果你**不在乎**怎么办。

只需比较 IE 的查找对话框与 Firefox

比较 IE 的“您希望我们为您记住此密码吗？” 到火狐

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-12-12T00:58:20.303

最好的 UI 是模态的。和最坏的一样。

模态 UI——不管它是由对话框、工具栏按钮还是文本提示构建的——只有在每个模式都符合用户过渡到它的期望时才是可取的。当程序意外转换到一种模式时……或者该模式要求用户拥有他没有现成的信息……那么这将导致用户困难，要么迫使他恢复到以前的模式，要么猜测适当的行动可能会产生不良后果。

非模态 UI 是一套完整的工具。有些与手头的工作相关，有些则不相关。用户必须具有足够的技能来选择正确的工具并以正确的方式应用它们。因此，虽然非模态 UI 永远不会像好的模态 UI（当前任务的正确工具）那样最佳，但它也永远不会像糟糕的模态 UI（错误的工具）那样次优。当前任务重重地砸在你粗心的手指上）。

对于非平凡的应用程序来说，设计一个好的模态 UI 可能是一项极其艰巨的任务，尤其是对于旨在供各种用户用于更广泛用途的通用程序而言。菜单系统和对话框试图弥合差距，在更大的非模态应用程序中允许小的、特定于任务的模态部分。然而，没有一个扩展得特别好，误用和过度使用给它们留下了坏名声，通常被视为懒惰程序员的第一个避难所。特别是对话框通常更多地被用作迫使用户进入程序员（或设计师）关于如何使用应用程序的想法*，*或者将困难的设计决策和棘手的错误处理放在用户身上的一种手段，而不是为了他们的同名目标沟通。

确实，Web 应用程序的兴起使这种趋势在众多论坛、新闻组和问答网站（例如这个）中浮出水面，因为程序员习惯于编写超线性逻辑，在程序需要时提示用户输入，而不是在程序需要时提示用户输入。对用户可用... 被迫进入一个用户可以非线性导航的系统，并且很可能将任何限制这种自由的尝试视为一种古怪的烦恼，而不是一种必要的邪恶。这些可怜的程序员的哀号在网络上回荡，因为他们试图将这种粗糙的模态行为强加到非模态系统上的尝试在他们周围崩溃了。对于我们这些长期在他们残酷的“对话”下受苦的人来说，这确实是一首可爱的曲子。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-12-12T01:46:39.597

在阅读我的答案之前，您必须仔细阅读以下消息的全部内容。所有进程、子进程、任务和线程都将无限期挂起，等待您的回答。而且，一旦你完全理解了这个信息，并且可能同意一些法律内容，以及所有这些的所有含义，那么只有这样你才能继续。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-12T00:13:50.987

在消费者风格的应用程序中，它们或多或少是无用的；用户不阅读它们，学会忽略它们，当他们阅读它们时，通常最终会感到困惑。我认为是/否/取消对话框是彻头彻尾的懒惰 UI 设计。“按钮说他们做什么”对话框稍微好一些，因为用户不需要阅读太多。

话虽这么说：在数据关键的 Intranet/“企业”应用程序中，它们或多或少有必要确认破坏性操作或健全检查可能允许但不推荐的非标准工作流程。

所以，我不认为它们在概念上是“邪恶的”，但通常是糟糕的 UI 设计的结果。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-12T00:13:51.203

它们是邪恶的，因为它们违反了用户应该能够指导软件操作的基本原则。模态对话框（通常是邪恶的对话框形式）将用户限制在一个动作上。

有些答案似乎误解了它是任何要求用户确认的弹出窗口。这可以在不占用整个应用程序或计算机的情况下完成；人们反对的正是这种行为。

在某些环境中，模式对话框仅将用户限制在单个应用程序的上下文中（或者可能更少）。非常糟糕的模式对话框会阻止用户在整个操作系统（例如 Windows）中执行任何其他操作。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-12T00:13:43.123

我不喜欢它们的原因之一是因为它们以串行方式显示信息（一次很多信息）而不是并行（您需要一次查看的所有信息），并行将允许用户选择他们想看什么，就像连续剧一样，你几乎迫使他们选择一个选项。

再加上他们打破了用户的控制流（例如，从你正在处理的对象上窃取焦点），我真的不喜欢这样做。因此，实际上用户只需点击 OK，以便他们可以回到他们正在做的事情并忽略对话框中的信息。

请注意，在某些情况下您仍然需要它们。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-12T00:14:48.393

维基[百科的文章](http://en.wikipedia.org/wiki/Modal_window#Criticisms)很好地总结了这些投诉。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-12T00:54:58.920

我不记得我第一次在哪里看到的，但是模式对话框的更好方法通常是允许轻松查找和使用“撤消”功能。当您删除文件时，Windows 资源管理器实际上会同时执行这两种操作。它要求确认（模态对话框），然后，在删除文件后，编辑菜单有一个“撤消删除”选项。当然，这只是访问回收站的一种简单方法，但在这种情况下，微软真的可以取消对话框。

关键是，您通常可以通过一些思考，也许还有一些额外的代码，而无需对话框，但对于懒惰的，或者更慷慨的，时间受限的开发人员来说，这太容易了。

也就是说，有时你真的*想要*一个对话。想想典型的“打印”对话框中的所有选项。哪个打印机？所有页面，还是只有几页？多少本？我不知道没有对话框你会怎么做......

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-12T01:30:36.180

Noboy 阅读它们，它们会中断程序流程。通常当用作错误通知时，它们是程序失败的前兆。当用户意识到正在发生的事情时，消息已经消失了，他们只能尽可能地回忆或发明消息。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-12T00:14:45.040

我个人认为这完全取决于它是如何完成的。

尝试复制 10 个文件，其中每个文件都存在于目标目录中，使用 Windows 资源管理器进行。

*每个文件*的单个模式对话框是否真的是此类操作中的正确答案。我知道你有“同意”，但整个循环系统应该以不同的方式构建。它应该将所有存在的文件收集到一个大列表中并询问一次“你想对这些文件做什么”，然后让我决定列表中的每个文件在单击“确定”并恢复操作之前要做什么.

很多时候对话框只是打断了正常的工作流程。

是的，人们不阅读对话框。因此，如果您必须使用对话框，那么一个黄金技巧就是改写它。

而不是“你想删除数据库中的这一行吗？”，试着用措辞来询问（但这不是正确的措辞）“你不想*删除*数据库中的这一行吗？” 这样，如果他们只是点击“是”，这是用户想要继续使用它的典型反应，他们最终会什么都不做。

# javascript - 当前的“在线用户”脚本

> ID：361494
> 
> 赞同：0
> 
> 时间：2008-12-12T00:09:24.723
> 
> 标签：javascript

用于在线显示当前访客或访客的最佳脚本是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T00:37:55.740

正如@Ryan Smith 所建议的，这在很大程度上取决于网站的实施细节。我确信有一个现成的框架提供了一个店面应用程序，其中包含所有的花里胡哨（比如你提到的脚本类型）；但是，这些可以是免费和开源的，也可以是非常昂贵的。

自己实现这样的脚本并不是很困难。假设您以某种形式的数据存储（通常是后端数据库）跟踪网站上的用户，您可以执行以下操作：

*   当页面加载时，触发发出 Ajax 请求的 JavaScript
*   让作为 Ajax 请求目标的页面选择存储活动用户的表中的行数。返回这个结果。
*   当请求完成时，让 Ajax 回调将数字插入到 DOM 中您想要的任何位置。

您可以将此过程设置为以特定间隔重复，以便动态更新包含脚本的页面，显示在线用户数量的相对最新计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:15:17.067

我认为这完全取决于您如何跟踪您的应用程序中谁在线。

通常，当有人登录时，您会为他们创建一个会话，您可以根据您使用的任何语言进行迭代。

您必须记住 HTTP 是一个无状态的环境，因此确定某人何时在线在很大程度上取决于您对他们多久以前登录的看法。

# frameworks - 您使用哪个框架来构建您的应用程序？

> ID：361495
> 
> 赞同：0
> 
> 时间：2008-12-12T00:10:13.147
> 
> 标签：frameworks, survey

有许多框架为构建应用程序提供框架，例如[CSLA](http://www.lhotka.net/cslanet/)、[XAF](http://www.devexpress.com/Products/NET/Application_Framework/)、[SCSF](http://msdn.microsoft.com/en-us/library/aa480482.aspx) ……

您是自己使用还是从头开始构建？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T00:35:06.853

.NET 是我最喜欢的框架。

我从事的应用程序通常过于复杂，无法融入“骨架”。然而，在处理 Winforms 时，我喜欢利用[CAB](http://msdn.microsoft.com/en-us/library/aa480450.aspx)来制作 UI。我不会说这是骨架，但或多或​​少是可以建造骨架的基础工作，然后可以在其上建造肉。我还喜欢使用 MVC 将 UI 连接到数据层。数据层通常是 LLBLGen 或 nHibernate。

对于为 Web 应用程序生成框架，[ASP.NET 动态数据](http://www.asp.net/dynamicdata/)框架看起来非常有前途。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T00:44:07.693

我只是使用我自己的类库，它处理诸如 SQL（不同引擎之间的差异）之类的事情，提供许多自定义数据结构和类型，IoC/依赖注入等。

我之前一直在使用 DevExpress 的 XPO 库，但是在遇到一些相当大的性能问题之后，我又回到了纯 SQL。

我从来没有使用过像你提到的那样更大的框架。早期的经验总是让我相信他们很强大，但也有限制。您通常最终会与他们做事的方式作斗争以实现更复杂的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-13T07:32:34.537

我在 2007 年使用 CSLA.NET 构建了一个大型 LOB Windows 应用程序（产权保险），基本上它是您构建业务对象的框架。业务对象是从具有预定义模板的数据库表中生成的。SP 主要用于数据访问。我个人不喜欢它，因为有很多代码和模板需要维护，我更喜欢 ORM 而不是基于模板的方法。

我一直在使用 XAF 构建另一个基于 Windows 的 HR 应用程序，它可以帮助您在 15 分钟内创建一个完整的应用程序，具有漂亮的 UI 和许多很酷的东西，如本地化、自定义、可换肤等。但是 XAF 的大问题是底层 XPO 的限制，以及性能不是很好。

# c++ - 从 char* 初始化 std::string 而不复制

> ID：361500
> 
> 赞同：50
> 
> 时间：2008-12-12T00:11:01.990
> 
> 标签：c++, string, memory-management, stl

我有一种情况，我需要像这样处理大量（许多 GB）的数据：

1.  通过附加许多较小的 (C char*) 字符串来构建一个大字符串
2.  修剪字符串
3.  将字符串转换为 C++ const std::string 进行处理（只读）
4.  重复

每次迭代中的数据都是独立的。

我的问题是，我想最小化（如果可能的话消除）堆分配的内存使用，因为它目前是我最大的性能问题。

有没有办法将 C 字符串 (char*) 转换为 stl C++ 字符串 (std::string) 而无需 std::string 在内部分配/复制数据？

或者，我可以使用字符串流或类似的东西来重新使用大缓冲区吗？

**编辑：**感谢您的回答，为了清楚起见，我认为修改后的问题是：

*如何有效地构建（通过多个附加）stl C++ 字符串。如果在一个循环中执行这个动作，每个循环都是完全独立的，我怎样才能重新使用这个分配的空间。*

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-12T00:35:41.080

如果不复制数据，您实际上无法形成 std​​::string 。一个字符串流可能会从一个传递到传递重用内存（尽管我认为标准对它是否真的必须保持沉默），但它仍然不会避免复制。

解决此类问题的常用方法是编写处理步骤 3 中的数据的代码，以使用开始/结束迭代器对；那么它可以很容易地处理一个 std::string、一个字符向量、一对原始指针等。与传递它像 std::string 这样的容器类型不同，它不再知道或关心内存是如何分配的，因为它仍然属于调用者。将这个想法推向其合乎逻辑的结论是[boost::range](http://www.boost.org/doc/libs/1_37_0/libs/range/index.html)，它添加了所有重载的构造函数，仍然让调用者只需传递一个带有 .begin() 和 .end() 的字符串/向量/列表/任何类型的容器，或者分开迭代器。

编写处理代码以在任意迭代器范围上工作后，您甚至可以编写自定义迭代器（不像听起来那么难，基本上只是一个具有一些标准 typedef 和运算符 ++/*/=/==/ 的对象!= 重载以获得一个只进的迭代器），它负责每次到达它正在处理的片段的末尾时前进到下一个片段，跳过空格（我假设这就是你的意思）修剪）。你根本不必连续组装整个字符串。这是否会获胜取决于您拥有多少碎片/多大的碎片。这本质上就是 Martin York 提到的 SGI 绳索：一个字符串，其中 append 形成一个片段的链表，而不是一个连续的缓冲区，因此适用于更长的值。

* * *

**更新**（因为我仍然偶尔看到对此答案的支持）：

C++17 引入了另一种选择：[std::string_view](http://en.cppreference.com/w/cpp/string/basic_string_view)，它在许多函数签名中替换了 std::string ，是对字符数据的非拥有引用。它可以从 std::string 隐式转换，但也可以从其他地方拥有的连续数据显式构造，避免 std::string 强加的不必要的复制。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-12T01:01:33.103

是否可以在步骤 1 中使用 C++ 字符串？如果你使用`string::reserve(size_t)`，你可以分配一个足够大的缓冲区来防止多个堆分配，同时附加较小的字符串，然后你可以在所有剩余的步骤中使用相同的 C++ 字符串。

有关该功能的更多信息，请参阅[此链接](http://en.cppreference.com/w/cpp/string/basic_string/reserve)`reserve`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-12T00:22:42.370

为了帮助处理非常大的字符串，SGI 在它的 STL 中有 Rope 类。
非标准但可能有用。

[http://www.sgi.com/tech/stl/Rope.html](http://www.sgi.com/tech/stl/Rope.html)

显然，绳索在标准的下一个版本中:-)
请注意开发人员的笑话。绳子是一根大绳子。（哈哈） ：-）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-13T21:23:49.847

这是一个横向思考的答案，不是直接解决问题，而是围绕它“思考”。可能有用，可能没用……

std::string 的只读处理实际上并不需要 std::string 功能的一个非常复杂的子集。您是否有可能对在 std::strings 上执行所有处理的代码进行搜索/替换，以便它采用其他类型？从一个空白类开始：

类轻量级字符串 { };

然后将所有 std::string 引用替换为轻量级字符串。执行编译以准确找出轻量级字符串上需要哪些操作才能充当直接替换。然后，您可以根据需要进行实施。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T00:20:32.873

每次迭代是否足够独立，以至于您可以为每次迭代使用相同的 std::string ？人们希望您的 std::string 实现足够聪明，可以在以前用于其他用途时为其分配 const char * 来重用内存。

将 char * 分配给 std::string 必须始终至少复制数据。内存管理是使用 std::string 的主要原因之一，因此您将无法覆盖它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T00:53:28.673

在这种情况下，最好直接处理 char*，而不是将其分配给 std::string。

# wysiwyg - FCK 编辑器替代品

> ID：361503
> 
> 赞同：17
> 
> 时间：2008-12-12T00:12:33.967
> 
> 标签：wysiwyg, fckeditor

我过去一直在为我的几个客户网站使用 FCK 编辑器。最近由于一些新的浏览器安全更新（我假设），一些功能现在正在破坏。

我计划将这些网站更新到最新版本，但有时我认为 FCK 过于复杂，而且往往会使我的客户感到困惑，而不是帮助他们。

还有什么其他的 HTML WYSIWYG（如果有的话）很好。我非常喜欢 FCK 的一些我想保留的项目：

*   基于 CSS 的下拉样式
*   自动插入的 HTML 模板
*   自动插入的 HTML 片段
*   文件上传器/浏览器

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-01-13T10:33:43.430

Aloha Editor 是 TinyMCE 和 CKEditor 的现代替代品。它允许您使用常见的文本框样式所见即所得编辑器作为 textarea 的替代品，但它也允许您直接编辑大多数 DOM 元素。这使得真正的所见即所得成为可能。它支持很多花哨的新 HTML5 和 CSS3 功能。

Aloha Editor 带有存储库 API、文件/图像/其他对象的自动完成功能和文件/图像/其他对象浏览器。

[http://www.alohaeditor.org/](http://www.alohaeditor.org/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-12T22:35:33.793

要获得这些功能，您很可能最终会得到一个与 FCKEditor 一样臃肿的解决方案。radEditor 是我曾经被迫使用过的最臃肿的垃圾。尽管他们声称有所改进，但最新版本并没有更好。可爱还可以，但要花钱。YUI 看起来不错，但我对它的使用还不够了解它的可扩展性或速度。

FCK 的最新版本（2.6+）要好得多。对话框不再是弹出窗口，因此它们可以在更多浏览器中使用。插件模型比我尝试过的其他模型更好，并且很容易在一个地方配置（我可能错了，但我认为 TinyMCE 需要嵌入每个实例的配置）。它们都生成不太理想的标记，但 FCK 做得最好，尤其是在最新版本中。将 FCK 工具栏自定义为基本要素，我认为您的客户会更喜欢它。我的会。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T00:29:36.880

来自 Yahoo YUI 的[Yahoo 编辑器](http://developer.yahoo.com/yui/editor/)

**更新：**

汇总其他答案：

[TinyMCE](http://tinymce.moxiecode.com/)

[可爱软](http://cutesoft.net/ASP.NET+WYSIWYG+Editor/default.aspx)

当然，还有[Markdown](https://blog.stackoverflow.com/2008/12/reverse-engineering-the-wmd-editor/)，它是你用来输入问题的那个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T00:28:40.800

[TinyMCE](http://tinymce.moxiecode.com/)是我个人的最爱。但是，您必须将其余部分硬塞进去。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-15T12:42:47.687

下一代 FCKEditor 现在以[CKEditor](http://ckeditor.com/)的形式提供。我最近将一个应用程序转换为使用以前使用过 FCKEditor 的应用程序，并发现它相当简单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-25T09:56:59.397

If you're already using jquery, then you may consider using markItUp! which is implemented as a jquery plug-in. It could be lighter than other editors with similar feature set which doesn't make use of any framework.

It supports HTML, Textile, Wiki Syntax, Markdown, BBcode. You can also use your custom syntax.

[http://markitup.jaysalvat.com/](http://markitup.jaysalvat.com/home/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T22:23:26.067

您是在说免费还是付费的控件？如果付费，我唯一使用的是 Telerik 的 radEditor。非常灵活，您基本上可以关闭任何东西并让它看起来像您想要的那样（即它是可换肤的）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T00:29:02.280

[CuteEditor](http://cutesoft.net/ASP.NET+WYSIWYG+Editor/default.aspx) （用于 ASP、ASP.NET 和 PHP 的商业版本）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-25T09:26:15.277

[netEditr.com](http://neteditr.com) is based on TinyMCE as the default WYSIWYG XHTML designer. Go have a test run and see if it fits your needs.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T00:59:26.977

您可以考虑 Flex 中的富文本编辑器。（或者 Silverlight，就​​此而言。）它更像是一个受控环境。

# spring - 用于 Spring 框架的应用服务器或 Web 服务器

> ID：361505
> 
> 赞同：4
> 
> 时间：2008-12-12T00:13:27.180
> 
> 标签：spring

首先：这可能是一个新手问题。然而，经过几次搜索，我找不到任何能让我走得更远的东西。

基本上，选择应用服务器而不是 Spring 框架来开发中等复杂的 Web 应用程序的原因是什么？我对 Spring 还很陌生，几年来做了一些核心 WebSphere。在阅读有关 Spring 的文章时，我发现它具有很多特性（事务、持久性、消息传递、连接器等）。Spring 在集群环境中是否难以扩展或管理？

欢迎任何意见。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T19:55:57.653

EAR 文件不是进行 Java EE 开发的必要条件。

不是非此即彼：如果您部署 Java EE 应用程序，您需要某种容器。

我已经在 Tomcat 和 WebLogic 上部署了 Spring 应用程序。我认为 WebLogic 是市场上最好的 Java EE 应用服务器。我是否部署到它的决定将严格基于可用性。

您已经看到 Spring 现在拥有自己的 Java EE 容器。它派生出 Tomcat 并将其与 OSGi 和 Spring 结合。我还没有尝试过，但是如果质量与他们的框架相似，那确实很有前途。

您真的在问“我什么时候会使用 Spring 编写应用程序？什么时候应该选择 EJB3？”

这些天我最喜欢的是春天。我可以做持久性、事务、消息传递、Web 服务以及我需要的所有其他事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:16:31.447

春天真棒。

不过，您的术语还很遥远。Spring 是一个框架。它是一个用于编写 Web 应用程序的库。

应用服务器是您的应用程序运行所在。您需要两者。例如，使用 Spring Framework 创建一个在 Tomcat 应用服务器中运行的应用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T19:58:14.357

Rod Johnson 的“Expert 1:1 Java EE Development without EJBs”是 Spring 的基础。这是一本很棒的书，但我想说它现在有点过时了。这本书是在考虑 EJB2 的情况下编写的。它是在 Spring 成为开源项目之前发布的。该框架现在已经到了 3.0 版，所以我想说这本书只具有历史意义。我建议对考虑 Spring 3.0 和 EJB3 的问题采取更现代的方法。

%

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T00:47:14.117

爸爸，

你让我到了那里，是的，术语是错误的。我的意思是 Spring + Web 容器与应用服务器。当然，Web 应用程序必须部署在某个地方。根据我的第一篇文章，我想这会将问题转移到服务器端功能上。

拓扑示例：Spring + Tomcat 与 WebSphere。

附带说明：人们争论 Tomcat 是否是一个应用服务器，许多人认为它更像是一个 Web 容器。您不能将 EAR 文件部署到 Tomcat，对吗？只需要一场战争，对吗？但这太学术了。

非常感谢

# sql-server - T-SQL 后台处理

> ID：361511
> 
> 赞同：1
> 
> 时间：2008-12-12T00:14:09.563
> 
> 标签：sql-server, tsql

我很难找到措辞，但是否可以向 MS SQL 服务器提供 SQL 查询并异步检索结果？

我想从 Web 请求提交查询，但我希望 Web 进程在 SQL 服务器继续处理查询并将结果转储到我可以稍后检索的临时表时终止。

或者是否有一些通用修饰符我可以附加到查询中以使其在后台处理结果（如 bash 中的“&”）。

更多信息

我管理一个站点，该站点允许受信任的用户在非常大的数据集上运行任意选择查询。我目前正在使用 Java 守护程序来检查“作业”表并运行结果，我只是希望可能有一个更本机的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T01:38:59.767

Based on your clarification, I think you might consider a derived OLAP database that's designed for those types of queries. Since they seem to be strategic to the business.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T00:20:31.067

请参阅此问题 [Start stored procedures 按顺序或并行](https://stackoverflow.com/questions/349951/start-stored-procedures-sequentially-or-in-parallel#349987)

实际上，您将让网页开始工作。该作业将异步执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T00:20:40.283

这实际上取决于您与数据库的通信方式。使用 ADO.NET，您可以使命令执行异步运行。如果您希望在构建的某个库的范围之外执行此操作，您可以将记录插入作业表，然后让 SQL 代理轮询表，然后将您的工作作为存储过程或其他东西运行。

尽管我猜想您的 Web 请求很可能是由 asp.net 接收的，但您可以使用 ADO.NET 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T01:18:15.740

由于 http 是无连接的，因此将检索与查询相关联的唯一方法是使用会话。然后，您将拥有所有这些答案，等待有人认领它们，并且无法知道连接（不存在）是否已断开。

在网页中，它几乎是使用它或失去它。

其他一些答案可能需要付出很多努力，但我不明白您正在寻找一个边缘案例，高科技选项。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-12T00:55:15.177

能够执行存储过程然后异步检索结果是一个复杂的话题。这并不适合胆小的人，我的第一个建议是重新检查您的设计并确定您实际上需要在数据层中异步处理您的请求。

根据您正在做什么，您应该查看 2 种技术... SQL Service Broker，它基本上允许您将请求排队并异步接收响应。它是在 SQL 2005 中引入的，从您提出问题的方式来看，它可能是最好的选择。

查看 MSDN 上相同数据库服务代理对话的教程：http: [//msdn.microsoft.com/en-us/library/bb839495 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/bb839495(SQL.90).aspx)

对于运行时间更长或处理更大的任务，我可能会考虑 Biztalk 或 Windows Workflow 之类的东西。这些框架（它们基本相同，它们来自 MS 的同一个团队）允许您启动可能在数小时、数天、数周甚至数月内不会返回的异步工作流。

# c++ - Entrek CodeSnitch 与 Windows Mobile 5/6

> ID：361527
> 
> 赞同：2
> 
> 时间：2008-12-12T00:22:28.457
> 
> 标签：c++, windows-mobile

我给 Entrek 发了邮件，他们似乎睡着了。

这里还有其他人使用 Entrek CodeSnitch 吗？如果是这样，您是否找到了将它与 Windows Mobile 5、6 或 6.1 一起使用的方法？

我*真的*需要验证我的应用程序没有任何内存泄漏等问题。CodeSnitch 做得很好。但仅适用于 Windows Mobile 2003。：/

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T00:39:18.780

什么不工作？是客户端连接问题吗？

旧版本使用 PlatMan 作为通信层，这从 Visual Studio 的角度来看是有问题的（CoreCon 附带），但如果您安装了任何具有 Platman（eVC、Platform Builder）的工具，那么自 WinMo 5 以来应该仍然可以正常工作.x 和 6.x 仍然基于 CE 5.0。

我知道 Entrek 有一个更新的 beta 版本（我有），所以你可以尝试再次 ping 它们。他们往往很忙，但我总是收到回复（虽然我很了解他们并且个人，所以这对你来说可能不是任何指标）。

我还看到他们[的网页上张贴了](http://www.entrek.com/support.htm)他们的电话号码。我会给他们打个电话。我记得他们说新版本应该解决 WinMo 问题（我很少使用 WinMo），所以绝对值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T02:25:40.003

我没有使用过 CodeSnitch。但是我已经成功地使用[Application Verifier Tool](http://www.microsoft.com/downloads/details.aspx?FamilyID=D275348A-D937-4D88-AE25-28702C78748D&displaylang=en)来识别我在 WM5 和 6 中的泄漏。

启动并运行它可能会有点痛苦。但我发现它是一个很好的工具，而且价格合适。

[这](http://www.windowsfordevices.com/articles/AT5485766681.html)是一个帮助您入门的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T21:24:48.253

我在 windows mobile 5、6 和 6.1 设备上使用过 CodeSnitch，没有任何问题。

[确保您已安装 v1.4 并应用了此处](http://www.entrek.com/products/Readme.htm)引用的 v1.4 补丁。

就像 ctackle 说的，你需要一个叫做 CoreCon 的旧通信层。我还发现[CETK](http://www.microsoft.com/downloads/details.aspx?FamilyID=40B7CEDB-DC8B-4503-8DC9-E75F8E8496C1&displaylang=en)中也有 CoreCon，它没有 eVC 或平台构建器那么大。

您需要设置设备连接设置以使用 ActiveSync（传输和启动服务器），连接被称为什么似乎并不重要，所以像 Pocket PC 这样的东西可以正常工作。

我发现的另一个问题是您需要编辑codesnitch 和procman 快捷方式并将“/targetcpu:armv4i”添加到命令行参数中，以便它们在WM 设备上工作。

我最近还发现他们对支持电子邮件也没有响应:(

# java - 在 Spring/JSP 中，应该在哪里进行格式化？

> ID：361529
> 
> 赞同：5
> 
> 时间：2008-12-12T00:22:45.023
> 
> 标签：java, spring, jsp, jstl, jsp-tags

我正在使用 Spring，但这个问题适用于所有 JSP 控制器类型设计。

JSP 页面引用由相应控制器填充的数据（使用标签）。我的问题是，在 JSP 或控制器中执行格式化的合适位置在哪里？

到目前为止，我一直在通过在控制器中格式化数据来准备数据。

```
public class ViewPersonController extends org.springframework.web.servlet.mvc.AbstractController
{
    private static final Format MY_DATE_FORMAT = new SimpleDateFormat(...);
    protected ModelAndView handleRequestInternal(HttpServletRequest request, HttpServletResponse response)
    {
        Person person = get person from backing service layer or database
        Map properties = new HashMap();

        // No formatting required, name is a String
        properties.put("name", person.getName());

        // getBirthDate() returns Date and is formatted by a Format
        properties.put("birthDate", MY_DATE_FORMAT.format(person.getBirthDate()));

        // latitude and longitude are separate fields in Person, but in the UI it's one field
        properties.put("location", person.getLatitude() + ", " + person.getLongitude());

        return new ModelAndView("viewPerson", "person", properties);
    }
} 
```

JSP 文件看起来像：

```
Name = <c:out value="${person. name}" /><br>
Birth Date = <c:out value="${person. birthDate}" /><br>
Location = <c:out value="${person. location}" /><br> 
```

我知道 JSP 确实有一些格式化的规定，

```
<%@ taglib uri="http://java.sun.com/jstl/fmt" prefix="fmt" %>
<fmt:formatDate type="date" value="${person. birthDate}" /> 
```

但这仅适用于 Java 的`java.util.Format`. 如果我需要更复杂或计算的值怎么办。在这种情况下，将代码放在 JSP 中会很麻烦（而且很难看）。

我很好奇这是否遵循 Spring/JSP/MVC 的精神。换句话说，控制器是视图的一部分吗？执行视图相关格式化的首选位置在哪里？我的控制器是否应该只返回对象（Person）而不是格式化值的 Map？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T00:55:09.077

JSP 通常没有很多（或任何？）代码，因此您的选择是

*   控制器
*   标签库

我会说，在大多数情况下，标签库可能是您想要的，因为通常视图是关心诸如格式化之类的事情的代码。

如果标准标签库不能让你到达那里，它们并不难创建，所以你可以自己动手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T01:09:43.103

我通常在 bean 或视图“助手”中进行格式化等。这有几个优点，包括：

1.  更容易测试
2.  灵活地更改您的视图技术，而无需担心移植或重写您在自定义标签库中所做的事情。
3.  更清洁、更易于维护控制器和查看代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T05:26:57.593

我更喜欢考虑格式化显示层的一部分，因此在 JSP 中完成。我最近使用了 Velocity，但与 JSP 的想法相同：控制器返回一个数据模型，视图负责将该数据呈现为可见表示。大量 JSP 标记库可满足常见需求。

您提到了复杂的或计算的值。这些听起来像是结果数据模型的元素，所以应该在控制器中完成，即使它们原则上可以由其他数据确定，例如 sum、max 和其他聚合值。在视图中格式化是指基本的东西，比如日期和数字格式、行分割、对齐。当然，数据和格式化表示之间的确切界限取决于应用程序，但我想你明白了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T03:47:35.267

我会这样做的方式是 -

Person 类的一个实例将是 ModelAndView 的模型中的唯一对象

我会将“表示逻辑”移动到 Person 类本身。例如，

```
public class Person {
    public String getLocation() {
        return this.latitude.concat(", ").concat(this.longitude);
    }
} 
```

我认为总的来说这种方法： 1 - 加强你的领域模型。2 - 减少代码重复（如果你想在另一个 JSP 中显示位置怎么办？用你的方法你会有很多重复的代码）

# asp.net - Linq to SQL 文件大小

> ID：361558
> 
> 赞同：0
> 
> 时间：2008-12-12T00:37:39.220
> 
> 标签：asp.net, linq, linq-to-sql

我想了解的是，如果我们将每张表放入一个 LinqToSQL 文件中，我们会失去性能吗？将每个表放在不同的 LinqToSQL 文件中是否更好，或者放在单个表中是否相同。

我希望我已经解释了我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T00:46:55.380

不会有运行时损失，但是一旦您在单个文件中处理数百万个表，它可能会减慢智能感知速度。

值得一提的是，默认的 SQL Metal 行为将数据库中的所有表放入一个文件中。

# php - 是否存在 PHP 生成器框架或参考？

> ID：361566
> 
> 赞同：1
> 
> 时间：2008-12-12T00:41:43.580
> 
> 标签：php, scripting, code-generation

回到脚本化的 ASP 和 ColdFusion 时代，我曾经从事为 ASP 或 ColdFusion 构建代码生成器的项目，通常使用 C++，以便在应用程序设计中更加面向对象，并且不需要开发人员编写脚本化代码，这通常是因其大小和复杂性而被称为“意大利面条代码”。

自从我从 2000 年开始编写 asp.net 代码以来，我根本不需要处理这个问题，因为该平台没有编写脚本。

我将来可能会从事 PHP 项目，我想知道是否存在任何 PHP 代码生成器，或者是否存在构建这些生成器的良好参考。它将适用于 Linux 平台，而不是针对运行 PHP 的 Win2008 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T00:45:12.810

为什么不直接用 PHP 构建一个合适的应用程序，而不是经历这些麻烦呢？最近的 PHP 是[完全面向对象的](http://us2.php.net/manual/en/language.types.object.php)，可以让你做一些相当不错的事情。甚至有一些[框架](https://stackoverflow.com/questions/20709/which-php-framework-will-get-me-to-a-usable-ui-the-fastest)可以帮助你做这种事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T00:49:06.903

在 PHP 中学习良好的开发实践比使用代码生成器要好。PHP 可能是一种脚本语言，但它非常强大，有一个很好的[OO 模型，很多好的](http://framework.zend.com/)[框架](http://www.php.net/zend-engine-2.php)和[其他](http://www.cakephp.org/)开源[包](http://solarphp.com/)。

无论是否在运行时编译，开发人员都可以创建设计良好且经过分解的代码库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:16:00.020

我对在动态语言（例如 PHP）的上下文中生成代码的优点持怀疑态度。您通常可以使用其他类型的抽象来获得相同的结果。与静态类型的编译语言不同，使用动态挂钩（例如 __get 和 __set 以及反射）来生成通用抽象对象相当容易。

# lucene - 对搜索结果应用一个或多个字段级过滤

> ID：361568
> 
> 赞同：1
> 
> 时间：2008-12-12T00:43:53.873
> 
> 标签：lucene

如何对返回的现有搜索结果应用一个或多个字段级过滤器`lucene`？

谢谢！埃德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-25T23:45:39.223

坦率地说，看看你的[发帖记录](https://stackoverflow.com/users/41625/meyahoocomaodzxyowykprbavs5sf701zowgzpc3svjv8)，你似乎在重复问同样或非常相似的问题。

对于 Lucene 和信息检索领域的一般帮助，[Lucene in Action](https://rads.stackoverflow.com/amzn/click/com/1932394281)非常出色，与您在此处获得的特定问题的具体答案相比，它将为您提供更好的基础。Lucene 还为您使用的任何版本提供了出色的[在线文档。](http://lucene.apache.org/java/2_4_0/)

# java - 使用 FileInputStream 读取 XML 文件（对于 Java）？

> ID：361570
> 
> 赞同：4
> 
> 时间：2008-12-12T00:45:01.420
> 
> 标签：java, xml, serialization, fileinputstream

对于我的项目，我必须使用 Java 和 XStream 序列化和反序列化随机树。我的老师制作了 Tree/RandomTree 算法，所以我不必担心。我不知道该怎么做：我正在使用 FileInputStream 读取/写入我序列化和反序列化的 xml 文件，但是当我反序列化时，我不知道用于读取文件的方法。读取文件后，我应该能够将其从 XML 转换，然后将其打印为字符串。这是我到目前为止所拥有的。（我正确导入了所有内容，只是没有将其添加到我的代码段中）。

```
FileInputStream fin;        

try
{
    // Open an input stream
    fin = new FileInputStream ("/Users/Pat/programs/randomtree.xml");

    //I don't know what to put below this, to read FileInpuStream object fin

    String dexml = (String)xstream.fromXML(fin);

    System.out.println(dexml);

    // Close our input stream
    fin.close();    

    System.out.println(dexml);

    // Close our input stream
    fin.close();        
}
// Catches any error conditions
catch (IOException e)
{
    System.err.println ("Unable to read from file");
    System.exit(-1);
} 
```

* * *

**编辑：** 我想通了；我不认为我必须将它打印为字符串，我只需要制作一个基准框架来计时它等等，但再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T01:47:41.857

该`xstream.fromXML()`方法将为您从输入流中读取。我认为问题在于您将返回值从`xstream.fromXML(fin)`String 转换为您最初序列化的对象类型（`RandomTree`我假设）。所以代码看起来像这样：

```
RandomTree tree = (RandomTree)xstream.fromXML(fin); 
```

编辑：在注释中澄清之后，作者的目标是首先读入一个字符串，以便在反序列化之前打印 XML 内容。考虑到这个目标，我建议看看[这个线程中提到的 IOUtils 库](https://stackoverflow.com/questions/326390/is-there-an-alternative-to-this-way-of-read-file-to-a-string-in-java#326413)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T02:12:54.350

根据我对[http://x-stream.github.io/tutorial.html](http://x-stream.github.io/tutorial.html)的了解（我以前从未使用过 XStream），您需要先定义您的类型。转换为 String 肯定是错误的，您可能需要自定义类型（取决于随机 XML 中的内容），然后您需要将 XML 标记映射到您的成员：

例如

```
xstream.alias("person", Person.class);
xstream.alias("phonenumber", PhoneNumber.class); 
```

这意味着它将您的 XML 中的“人”标签映射到您的 Person 类。

要反序列化，您可以执行以下操作：

```
RandomTree myRandomTree = (RandomTree)xstream.fromXML( xml ); 
```

此外，您正在关闭您的流两次，您可能希望在 finally 块中执行此操作:)

编辑：阅读了您上面的评论...

您的任务涉及两个步骤：

1.  反序列化
2.  序列化

为了序列化你的对象，你必须首先从你的输入文件中反序列化它。

要将您的对象输出为字符串，只需执行

```
String xml = xstream.toXML( myRandomTree ); 
```

# c# - 当我在 Javascript 中禁用它时，ASP.NET 组合框的值似乎发生了变化

> ID：361581
> 
> 赞同：3
> 
> 时间：2008-12-12T00:49:20.023
> 
> 标签：c#, javascript, asp.net, combobox

我有一个表单，用户可以在其中从组合框中选择组件类型，并且根据该组件，他们可能会或可能无法从另一个组合框中选择数据类型。

当用户选择组件类型时，客户端 javascript 会在更改时触发并在需要时设置数据类型组合框的值，并在需要时禁用数据类型组合框。奇怪的是：当该表单提交时，服务器端获取该数据类型组合框的值，而这不是我设置的！

我似乎把它缩小到一行javascript：

```
document.all("cmbDataType").disabled = true; 
```

如果该行被注释掉，它仍然会根据组件类型设置为正确的值，但不会被禁用，并且表单提交会根据客户端选择的值向服务器提供正确的值。

如果该行执行，那么尽管用户在禁用的组合框中看到了正确的值，但返回给服务器的值是不正确的。

我找不到其他人有同样的问题，所以我希望这不是什么超级奇怪的事情。浏览器是IE7，webapp是ASP.NET 2.0。感谢您的关注！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T01:25:25.240

发生这种情况的原因是 ASP.NET 2.0 默认情况下不提交禁用控件的值。（更准确地说，它不会在回发时更新服务器控件值。）您可以通过在 Page_Load 事件中添加以下行来覆盖它：

```
Page.Form.SubmitDisabledControls = true; 
```

或者您可以在表单标签中设置值：

```
<form id="myForm" runat="server" SubmitDisabledControls="true"> 
```

# design-patterns - 为什么要使用访客模式？

> ID：361583
> 
> 赞同：30
> 
> 时间：2008-12-12T00:51:49.443
> 
> 标签：design-patterns, visitor-pattern

**重复：[我什么时候应该使用访客设计模式](https://stackoverflow.com/questions/255214/when-should-i-use-the-visitor-design-pattern)**

为什么有人要使用访问者模式？我已经阅读了几篇文章，但我没有得到任何东西。

如果我需要一个功能来为自定义计费，我可以使用

```
Custom.Accept(BillVisitor) 
```

或类似的东西

```
Bill(Customer) 
```

第二个不太复杂，Bill 函数仍然与 Customer 类分开。那么我为什么要使用访问者模式呢？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-12T01:07:09.333

当您具有复杂的结构（即层次结构或其他不是简单线性的东西）时，就会出现问题。当您不能简单地迭代结构时，访问者非常方便。

如果我有一个层次结构（或树），每个节点都有一个子节点列表。当我想对树中的每个节点应用一个进程时，创建一个访问者是很愉快的。

然后一个节点可以将访问者应用到它自己，以及它的每个子节点。每个孩子，可传递地，做同样的事情（将访问者应用于它自己，然后是任何孩子）。

访问者的这种使用效果非常好。

当你有一个超级简单的数据结构时，Visitor 不会增加很多价值。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-12T08:10:13.597

访问者模式是针对不直接支持多分派的语言的 hack（C++ 和 Java 等语言仅支持基于对象的单分派。CLOS 支持多分派）。在这种情况下，如果您希望 Bill 和 Customer 都是多态的，您将不得不使用单一调度语言中的 BillVisitor 和 Customer 两个接口。例如：accept的实现通常是：

```
void accept(BillVisitor visitor) { visitor.bill(this); } // java syntax 
```

请注意，Customer#accept 和 BillVisitor#bill 都可以被它们各自的子类覆盖，从而产生非常丰富的运行时行为组合，否则无法实现。它实际上是大多数其他人在此描述的替代闭包的超集，可将功能应用于复杂的数据结构。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T01:40:34.413

访问者的另一个好处是它们易于扩展，如果您的语言允许，您甚至可以使用 lamdbas 来清理内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T19:15:01.437

在我的 CAD/CAM 应用程序中，我有路径和路径集合 (PathList)。有时我必须生成一组形状。我不仅要生成这个特定的形状集合，我还必须将它包含在另一个形状集合中。我经常需要十几个或更多参数来传达进行计算所需的所有信息。

我的 CAM 中的所有形状计算（简单或复杂）都汇集到一个 PathList 中，该路径列表被发送到不同的机器。

使用这种设计，最好进行一些设置，包括将结果添加到单个集合中。

Path Visitor 非常适合这一点。每个形状计算都被封装到它自己的类中，其属性根据需要而复杂。

所以 Kitchen Hood Visitor 可能有 8 个形状到路径列表

而厨房柜台访客增加了 6 个形状。

抽屉访客增加了一些。

然后我像任何其他形状生成器一样将生成的 PathList 传递给系统的其余部分。

通过添加另一个访问者或不运行一些访问者，我可以轻松地进行选择。对于一个只想要一个柜台和抽屉的人来说，我只需要运行两个访客。

生成的代码非常可读，当我在 3、5 或 10 年后重新访问该领域时，这一点很重要。此外，由于对一个访问者的封装更改对其他访问者的影响很小。

此外，我现在有一个标准化的设计模式，可以通过实现访问者模式向 PathList 添加任何新功能。

例如，过去我们的属性编辑器只能在单个路径上工作。当我们改为编辑多个路径时，很容易实现自定义访问者对所有路径进行全局更改。它比在委托中使用 for 循环更具可读性。

但最终归结为判断和偏好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T01:20:56.777

在这两种情况下，访问者都与客户类分开。如果您也想从调用者类中抽象出访问者，那么优势将是。在第二种情况下，调用类必须知道计费。相反，您可以在某个地方使用另一个例程来返回 IVisitor。然后调用代码可以调用 Custom.Accept(IVisitor) 并且不知道访问者在做什么。

基本上在这种情况下以及 S.Lott 提到的情况下，您可以将访问者视为代表。这是一个可以像对象一样传递并在需要时使用的函数。

# c# - 如何将单击事件处理程序分配给绘制的矩形的一部分？

> ID：361592
> 
> 赞同：4
> 
> 时间：2008-12-12T00:57:13.440
> 
> 标签：c#, winforms

想象一下，我使用 .NET 图形类来绘制一个矩形。

然后我如何分配一个事件，以便如果用户单击某个点或某个点范围，就会发生某些事情（单击事件处理程序）？

我正在通过 C# 和事件部分阅读 CLR，我从阅读的内容中想到了这个场景。

一个这样的代码示例将真正提高我对 C#/.NET 中事件的理解。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T01:11:01.277

您可以分配 Click 事件处理程序来控制将使用谁的表面来绘制矩形。这是一个小例子：当您单击矩形内部的表单时，它将以红色边框绘制当您在外部单击时，它将以黑色边框绘制。

```
public partial class Form1 : Form
{
    private Rectangle rect;
    private Pen pen = Pens.Black;

    public Form1()
    {
        InitializeComponent();
        rect = new Rectangle(10, 10, Width - 30, Height - 60);
        Click += Form1_Click;
    }

    protected override void OnPaint(PaintEventArgs e) 
    {
        base.OnPaint(e);
        e.Graphics.DrawRectangle(pen, rect);
    }

    void Form1_Click(object sender, EventArgs e)
    {
        Point cursorPos = this.PointToClient(Cursor.Position);
        if (rect.Contains(cursorPos)) 
        {
            pen = Pens.Red;
        }
        else
        {
            pen = Pens.Black;
        }
        Invalidate();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T04:48:37.827

[PointToClient](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx)方法将光标坐标转换为控件相对坐标。即，如果您的光标位于屏幕上的 (screenX, screenY) 位置，则它可以位于相对于表单左上角的 (formX, formY) 位置。我们需要调用它来将光标位置带入矩形使用的坐标系中。

[Invalidate](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invalidate(VS.71).aspx)方法使控件重绘自身。在我们的例子中，它触发 OnPaint 事件处理程序以使用新的边框颜色重绘矩形。

# flash - Web 应用程序会取代桌面应用程序吗？

> ID：361599
> 
> 赞同：15
> 
> 时间：2008-12-12T01:03:20.480
> 
> 标签：flash, air, cloud, javafx, google-gears

一切都会上云吗？如果有，在哪个方向？谷歌齿轮？闪存、空气、JavaFX？

* * *

### 另请参阅：[桌面开发重要吗？](https://stackoverflow.com/questions/655365/does-desktop-development-matter)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-12T02:58:01.153

不，直到有人提出一个很好的论据来*说明为什么我应该让其他人控制我的数据*。并保证我的 Internet 连接始终处于打开状态并且随处可用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-12T01:06:23.907

我问[魔术八球](http://web.ics.purdue.edu/~ssanty/cgi-bin/eightball.cgi)- 它说，“不可能！”

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-12T01:26:50.027

近十年来，我一直在问这个问题。在我的业务中，我们构建和销售 Windows 和 Web 应用程序，它们的功能大致相同。四年前我会告诉你，到现在我们已经 80 到 20 岁支持 Web 应用程序了。然而，就出货数量而言，我们仍然有大约 60-40 人支持 Windows 应用程序。

虽然我曾经认为接受软件即服务的真正障碍只是渴望更好、更丰富的用户界面（Silverlight、Air 等可以解决），但我现在倾向于认为存在许多人更喜欢一次性购买和本地控制，而不是网络连接订阅模式。因为这种偏好植根于个人对物有所值的看法，所以我认为技术不会像我们技术专家认为的那样迅速改变任何事情。因此，我敢打赌，Windows 应用程序与我们在一起的时间比我们开发人员预期的要长；至少再过10年。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-12T03:16:30.023

就我个人而言，我的梦想是随身携带一个包含操作系统和您使用的所有应用程序以及所有个人设置的 USB 记忆棒。您可以将此驱动器连接到您遇到的任何计算机，并且每次都可以获得您自己的个性化体验，无论您使用的是哪台计算机。您始终可以访问所有应用程序和所有数据。当您晚上回家或检查指定的计算机时，会执行备份，这样您就不必担心丢失所有数据。[这有点类似于Gdium](http://www.gdium.com/)和 G-Key所做的事情，但我认为/希望这样的想法在未来会变得更加流行。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-12T01:37:18.790

答案很可能是否定的，除非我们在宇宙中发现秘密物理或其他一些奇怪的漏洞。现在看一些科幻小说。

考虑到这一点，有一天我们可能拥有每秒可以处理 Gazillion FLOPS 的量子云服务器，但是据我们所知，我们无法以比光速更快的速度发送这些结果。

所以现在想象一下“超级云”，它可以在 1 毫秒内处理任何事情，但如果在几毫秒内无法收到这些结果，那么“性能很糟糕”。例如，想象一艘太空船，它不可能依赖云服务器，它需要一个“桌面”。

现在这听起来很疯狂，但即使在今天，截至 2008 年，光子从 CPU 芯片的一侧穿过到另一侧所需的时间比晶体管栅极状态发生变化所需的时间要长。所以我们已经达到了不超过光速的极限。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-12T01:32:08.207

所以我们只需要哑终端？我们以前不是来过这里吗？好吧，它们肯定会是更漂亮的多媒体应用程序等等。但是，哑终端，仍然如此。

钟摆似乎不应该摆动那么远。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T01:09:17.737

Web 技术真正取代桌面应用程序还需要很长一段时间，但我毫不怀疑它会在某个时候发生。技术进步太快且始终如一，以至于它不会发生。

不过，我怀疑您提到的任何技术都将是相关的。我认为浏览器将朝着类似虚拟机的状态发展，这种状态越来越有能力创造越来越好的网络体验。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-12T01:23:58.723

是的，但我怀疑将主导的技术是否存在。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-12T01:36:44.280

不可以。以数据为中心的应用程序和以通信为中心的应用程序可以云化。但是，以处理为中心的应用程序不太容易被转储到网络上。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T01:11:04.693

繁重的图像处理和游戏对于 Web 应用程序来说可能有点过于繁重，但我认为许多应用程序最终都会如此。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-12T01:18:14.130

不，桌面应用程序目前只是陷入困境。一旦我们最终解决了安全的小问题，它就会全面恢复。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-12T01:25:25.990

我真的不知道这会很快发生，我的意思是在未来 10 到 15 年内。或者甚至为什么一个人想要。密集型游戏、量化金融和科学与国防，这些都不会从在 Web 浏览器中运行中受益。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-12T01:34:31.227

我认为对于真正意义上的浏览器（HTML/Java/CSS/Flash/Whatever）要超越原生应用程序，计算机架构（CPU/内存）的性能必须变得非常强大，以至于你能够运行浏览器框架内的硬实时进程，并没有看到任何降低的确定性或硬实时性能。

这将需要在计算方面取得一些真正重大的进步，而目前预计未来十年不会出现这些进步。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-12T06:12:41.697

WebApps 在很多事情上都很棒，但真正的破坏者仍然是性能和本地硬件集成。

如果有一个很好的原生应用程序可以做某事，而一个 AIR 应用程序可以做同样的事情，我会一直使用原生应用程序。HTTP 有其局限性。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-12T06:26:28.440

我认为他们会互相合作。可以拥有 Web 托管的组件和本地的部件。Flex 应用程序可以使用本地和浏览器沙箱。如果 Silverlight 还没有，它将需要。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-12T06:38:07.560

许多人并不关心他们将家庭度假照片放在哪里，但大企业会*非常*小心他们在云端放出的东西。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-12T06:58:27.690

人们太忙于寻找“下一件大事”。真的没关系！当今存在的 Web 和桌面只不过是两个独立的应用平台。这些平台之间的界限越来越模糊，但对于开发应用程序的人来说，这两个平台各有利弊，最终，用户只关心最好的应用程序在哪里。

我说两者都会留下来，但很快你将无法从最终用户的角度区分它们。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-12T12:32:04.917

这就像争论花生酱将取代果冻一样。事实是，它们在许多情况下都可以单独使用，甚至更好地结合使用。就我个人而言，我认为未来将看到大多数情况下两者结合使用，而不是单独使用一个或另一个。也就是说，总会有单独的实例有意义——我认为维基百科或 flickr 不会很快成为独立的应用程序。同样，我确信有些桌面应用程序不会从启用网络中受益（尽管奇怪的是，我目前想不出一个好的例子）。

我也同意之前的海报，两者之间的界限会越来越模糊。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-12T01:20:38.760

目前有一些东西，比如[eyeOS](http://eyeos.org/en/)，它们正在取得长足的进步，但是当它归结为纯粹的性能和游戏时，浏览器可以做的事情是有限的。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-09-25T16:40:50.483

谷歌推出了[谷歌 Chrome 操作系统](http://googleblog.blogspot.com/2009/07/introducing-google-chrome-os.html)，以打赌桌面应用程序将不再是必不可少的。

# c# - 您如何阅读存档的事件日志文件？

> ID：361602
> 
> 赞同：4
> 
> 时间：2008-12-12T01:06:30.287
> 
> 标签：c#, .net, vb.net

是否有任何库或资源可用于解析/读取存档的事件日志？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T18:29:45.703

有这篇文章[Parsing event log(*.evt) 文件。](http://www.codeproject.com/KB/string/EventLogParser.aspx?fid=334874&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2018071#xx2018071xx) 然后是 Microsoft[事件日志文件格式文档](http://msdn.microsoft.com/en-us/library/bb309026(VS.85).aspx)（在 xp win 2003 上使用的 evt）。到目前为止，我能找到的关于新格式的唯一信息是来自某个[法医会议的 pdf。](http://www.dfrws.org/2007/proceedings/p65-schuster.pdf) 以及[如何将evt转换为evtx](http://blogs.technet.com/askperf/archive/2007/10/12/windows-vista-and-exported-event-log-files.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T11:42:58.993

您使用哪个 IIS 版本？如果您使用 IIS 6，您可以使用 Microsoft Log Parser 来查看它。从[IIS 6 资源工具包下载](http://support.microsoft.com/kb/840671)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T02:37:50.680

如果文件是 .evt，你可以运行 eventvwr，点击 Action->Open Log File 并选择归档文件和文件类型。

对于编程访问，有一个 .NET 类 System.Diagnostics.EventLog 可以满足您的一切需求。

# visual-studio - VS2008，IIS7 web 项目，非管理员。什么时候？

> ID：361605
> 
> 赞同：3
> 
> 时间：2008-12-12T01:09:19.673
> 
> 标签：visual-studio, visual-studio-2008, iis-7, windows-vista, uac

在不以管理员身份运行的情况下，我们可以使用 Visual Studio 2008 打开托管在 IIS7 中的 Web 应用程序项目之前需要做什么？我们是在谈论等待下一个版本的 Visual Studio 吗？是否有任何现有的解决方法？

我认为上面暗示了这一点，但这与Vista有关。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T23:45:53.117

我希望看到一个 IISAdmin 组，它授予开发人员的用户帐户管理 IIS 的权限，而不授予整个 PC 的完全管理员权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T19:09:14.137

绝不是一个糟糕的选择——我作为非管理员可以做的几乎所有其他开发。好像 IIS 下的代码也不需要管理员权限。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-12T03:02:01.270

我的**猜测**是永远不会。我认为在 IIS 中更改网站和虚拟目录总是需要管理员权限。

# java - 仅在运行新的 Java 1.6 时出现 Java IOException - 请有人

> ID：361609
> 
> 赞同：3
> 
> 时间：2008-12-12T01:11:57.780
> 
> 标签：java, windows-xp, ioexception

升级到 XP 和 Java 1.6 后，我们的一个 Intranet 应用程序在浏览器中运行 java 小程序时遇到问题。java applet 是一个文档编辑器，它接受一个参数来指示文档所在的位置。我假设它将这个文件复制到用户机器上进行编辑。我希望我知道更多，但我没有来源……大坝！

我们在运行 XP-IE6-Java 1.6 的机器上得到了 java.io.IOException。这个问题不会在我们较旧的 Win2K-IE6-Java 1.3 上发生，所以我们确定它与桌面隔离，而不是服务器（无论如何，99% 肯定）。

一点信息：如果您尝试连续运行两次小程序，它会在第二次运行。第一次失败了。此外，在橙色 java 加载徽标嵌入浏览器之前出现错误消息框。

我还在策略文件中输入了以下信息，并通过控制台重新加载了策略文件。

```
grant codeBase "http://intranetserver/*" {
    permission java.security.AllPermission; 
}; 
```

这是堆栈跟踪的转储。谢谢你的时间 ：-）

```
java.io.IOException：写入错误
    在 java.io.FileOutputStream.writeBytes（本机方法）
    在 java.io.FileOutputStream.write（未知来源）
    在 sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read（未知来源）
    在 sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read（未知来源）
    在 sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read（未知来源）
    在 sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.close（未知来源）
    在 com.docscience.dlstools.browser.editor.HTMLDocumentLoader.loadDocument(HTMLDocumentLoader.java:94)
    在 com.docscience.dlstools.browser.editor.HTMLDocumentLoader.loadDocument(HTMLDocumentLoader.java:113)
    在 com.docscience.dlstools.browser.editor.HTMLDocumentLoader.loadDocument(HTMLDocumentLoader.java:126)
    在 com.docscience.dlstools.browser.editor.dsBrowserEditor.loadPage(dsBrowserEditor.java:1623)
    在 com.docscience.dlstools.browser.editor.dsBrowserEditor.loadFile(dsBrowserEditor.java:1873)
    在 com.docscience.dlstools.browser.editor.dsBrowserEditor.(dsBrowserEditor.java:201)
    在 com.docscience.dlstools.browser.editor.DLSBrowserEditor.init(DLSBrowserEditor.java:38)
    在 sun.applet.AppletPanel.run（未知来源）
    在 java.lang.Thread.run（未知来源）

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T22:00:33.487

我解决了这个问题。在 java 控制面板中关闭临时文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T03:23:38.247

你说你从 Java v1.3 直接到 Java 1.6，你有没有机会用 Java 1.4 或 1.5 测试它？在这里，更多的上下文信息会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T09:17:44.833

您的代码是否已签名，或者您是否依赖策略文件中的设置？

我记得签名代码也有类似的问题。我不记得确切的情况，但事实证明，Java 控制台（高级选项卡，安全部分）中的[撤销检查（或者可能是 OCSP）设置](http://java.sun.com/javase/6/docs/technotes/guides/deployment/deployment-guide/jcp.html#advanced)在启用时第一次启动小程序时导致了一些问题。SUN 声明默认情况下它们都被禁用，因此除非您明确启用该设置，否则您不会遇到该问题。

您可能会查看并禁用两者，也许它可以解决问题，尽管可能不需要禁用撤销检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T12:19:55.297

如果您反编译并查看 HttpURLConnection 的源代码，您会看到写入 HTTP 缓存时发生异常。请参阅此处的文档：http: [//java.sun.com/javase/6/docs/technotes/guides/net/http-cache.html](http://java.sun.com/javase/6/docs/technotes/guides/net/http-cache.html)

您可能必须使用调试器来查看那里究竟发生了什么以及原因是什么。

# version-control - 如何在 P4Win 中获得延时视图？

> ID：361616
> 
> 赞同：5
> 
> 时间：2008-12-12T01:18:19.810
> 
> 标签：version-control, perforce, p4v, p4win

过去，在 Windows XP 机器上，我能够安装 P4V（Perforce 试图扼杀你的喉咙的愚蠢的独立于平台的 Perforce 可视化客户端），然后安装 P4Win（Perforce 出色的干净健壮成熟的可视化客户端）愚蠢地试图弃用）。

如果我按该顺序（并且仅按该顺序）进行安装，当我在 P4Win 的 Perforce 软件仓库中右键单击文件时，我将获得一个文件“延时视图”选项。这将启动 P4V 附带的延时视图应用程序，每个人都会很高兴。

我只是在 Vista 中完成了这些步骤，并且......没有骰子。右键单击文件时，我看不到延时视图选项。

任何人都知道我需要在 Vista 下执行哪些奇怪的安装步骤才能获得此选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T02:31:50.630

好的，我自己做了这个。我遵循的步骤是： 1\. 卸载我机器上的每一个 Perforce 产品。2\. 重启。3\. 安装 P4V。4\. 重启。5\. 安装 P4Win。6\. 重启。

然后延时视图（和修订图，另一个只能从 P4V 工具中获得的有用工具）出现在 P4Win 中。嘘！

顺便说一句，我尝试将它们全部卸载，然后以正确的顺序重新安装，而无需任何重新启动步骤……没有骰子。可能并非所有这些重启步骤都是必需的，但我想确定一下，它确实有效。

我想借此空间再次说一下：P4V 是驴粪，Perforce 需要停止试图将它塞进我们的喉咙，并继续在他们在 P4Win 中拥有的出色产品的基础上构建。再见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T13:16:36.963

此方法也适用于具有 64 位版本的 P4V 和 P4Win 的 Windows 7 64 位

# c# - ASP.NET MVC 与 WebForms 的大项目首页加载速度

> ID：361620
> 
> 赞同：3
> 
> 时间：2008-12-12T01:21:16.060
> 
> 标签：c#, asp.net-mvc, performance, webforms

我们有一个非常大的 ASP.NET WebForm（Web 应用程序）项目，其中包含对其他库、其他项目等的大量引用，并且大多数时候在编译后，我们第一次加载页面时需要很长时间才能渲染任何内容... 磁盘 IO 是主要问题。对于小型项目，它几乎是瞬间完成的，但是一旦你的项目变大，它会真正减慢开发速度并消除编程的乐趣。

我的问题：在 ASP.NET MVC 中编译后的首页加载时间是否与在大型项目的 ASP.NET Webforms 中一样长？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T02:05:15.847

MVC 仍然使用与 Web 窗体相同的 ASP.NET 框架，因此无论如何您都可能会看到类似的行为。

首次加载时间长是因为您的项目的构建输出仍然只是 IL 代码，需要在执行之前由 JIT 编译器编译成本机代码。您所做的任何代码更改都将导致您的应用程序之前缓存的本机代码被丢弃，因此 JIT 必须重新编译。自然，您的项目越大，JIT 处理它所需的时间就越长。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T05:27:25.347

您将在两种环境中看到相似的加载时间。

在这两种环境中，如果您的站点变大，您应该在部署之前预编译您的站点。这将消除第一页加载时的性能拖累。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:48:13.377

可以做很多事情来提高性能，在 MVC 应用程序中提供关注点分离的增强可以提供很大帮助。尽管默认视图引擎重用了 webforms，但 Views 的控制堆栈比典型的 webforms 简单得多，这很有帮助，更不用说替代视图引擎了。

“第一个视图”的命中来自必须 JIT 项目中使用的大量类/对象，它是第一页。

# php - IIS 上的 PHP、MySQL - 服务页面时未加载 MySQL

> ID：361621
> 
> 赞同：3
> 
> 时间：2008-12-12T01:21:47.667
> 
> 标签：php, mysql, iis, wimp

我已经尽我所能在 Windows Server 2003 上设置了 IIS (6.0)、PHP (5.2.8) 和 MySQL (5.1.30)，所有相关人员都在 IIS 和 PHP让事情互相交谈。

PHP 确实可以工作——但是，我不能使用 PHP 页面中的 mysql 或 mysqli 库。 **致命错误：**在...中找不到类 'mysqli'
**致命错误：**在...中调用未定义的函数 mysql_connect()

在 PHP 页面中使用 phpinfo() 时，不会出现与 MySQL 或 MySQLi 相关的信息。

但是，当我从命令行调用 PHP 时，例如

```
> php -r phpinfo() 
```

与 MySQL 和 MySQLi 相关的信息*确实*出现在其输出中。

重新启动 IIS 或操作系统不会产生进一步的影响。我在 PHP 根目录中只有一个 php.ini 文件。

我是否还需要以某种方式将 MySQL 连接到 IIS，还是还有其他问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T01:24:37.003

用于 PHP 命令行使用的 php.ini 文件可能与 Web 服务器使用的 php.ini 不同。您应该`phpinfo()`通过在 Web 服务器的文档空间下放置一个小的 PHP 脚本来获取信息：

```
<?php
phpinfo();
?> 
```

使用浏览器打开此 PHP 脚本，通过 URL 向您的 Web 服务器请求该 PHP 脚本。这将告诉您 Web 服务器认为您的 PHP 配置是什么。

另请记住，您需要重新启动 Web 服务器才能使对 php.ini 的编辑生效。它仅在 Web 服务器启动时读取 php.ini。

您的 IIS 实例正在使用的 php.ini 文件可能存在很多地方。有关详细信息，请参阅[http://php.net/manual/en/configuration.php](http://php.net/manual/en/configuration.php)或[http://www.iis-aid.com/articles/how_to_guides/where_php_ini_is_loaded_from](http://www.iis-aid.com/articles/how_to_guides/where_php_ini_is_loaded_from)。

`phpinfo()`查看在浏览器中查看时的输出，并查找“加载的配置文件”项。

# exception - 何时躲避异常以及何时处理异常

> ID：361628
> 
> 赞同：1
> 
> 时间：2008-12-12T01:27:45.593
> 
> 标签：exception, exception-handling

在决定是让方法躲避异常（即：让异常传播）还是在收到异常后处理它时，您使用什么指导方针？

这是我要问的一个例子

如果我有三个方法method1、2、3和3。Method1调用Method2，后者调用Method3。并且该异常仅在方法3中引发，我应该让异常向上传播如下（请原谅我的伪java；））

```
 method1 {
        try {
            call method2;
        } catch (exception e) {
            doErrorProcessing;
        }
    }

    method2 throws exception {
        call method3;
    }

    method3 throws exception {
        call readFile;
    } 
```

一旦异常引发如下，我什么时候应该处理它

```
 method1 {
        call method2;
    }

    method2 {
        call method3;
    }

    method3 {
        try {
            call readFille
        } catch (exception e) {
            doErrorProcessing;
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T01:38:09.473

我遵循的规则：

如果我可以修复异常，或者消除导致它的问题（有时这意味着完全忽略它），我会处理它。否则它会被传递到下一个级别。

而且我总是尝试在树中尽可能低地修复异常（即在它们发生后尽快） - 这会本地化异常处理并避免在您的上层中使用大型异常处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T01:37:18.273

就像软件中的所有答案一样，这对我来说是“取决于”。

事实上，大多数异常应该是异常的，所以通常我倾向于喜欢它们在它们发生时破坏应用程序。如果异常代表一些可恢复的错误情况，那么当您拥有安全操作所需的信息时，应该在调用堆栈中的点处处理它。这将包括用户可以纠正错误的情况，即捕获异常以将其报告给用户，以便他们可以采取适当的措施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T01:36:44.920

如果较低级别的例程知道如何处理异常情况，它可能应该处理它。如果它是一个与函数要执行的任务无关的异常情况，那么让它在更高级别上处理可能更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T01:38:55.667

只捕获您可以处理的异常。让其他一切从你身边经过。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-12T01:42:37.157

从 Java 的角度来看，我总是尝试使用未经检查的异常来避免在方法签名中添加 throws 声明。

然后我实际捕获异常的位置将取决于情况。我总是希望在异常适用的情况下尽可能地处理链中的异常。如果它是您期望应用程序崩溃的系统级异常，那么我可能有一个异常处理机制，它将“捕获所有”。

# asp.net - HTML 属性 bgcolor 已弃用：改用什么？

> ID：361633
> 
> 赞同：13
> 
> 时间：2008-12-12T01:31:59.267
> 
> 标签：asp.net, html

VStudio ASP.NET 给出以下消息：

```
Attribute 'bgcolor' is considered outdated. A newer construct is recommended. 
```

推荐的结构是什么？

`bgcolor`在一个`<td>`元素内。
另一个相关消息是：

```
Attribute 'bordercolor' is not a valid attribute of element 'table'. 
```

有谁知道我在哪里可以找到更新的替代品？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-12T01:36:28.400

[`BGColor`](http://webdesign.about.com/od/intermediatetutorials/a/aa080502a.htm)在 W3C HTML 4.0 规范中已弃用。

较新的网站和 Web 应用程序使用 CSS（层叠样式表）来呈现相同的内容，如下所示：

```
 body {
  background-color : #ffffff;
} 
```

对于表，请执行以下操作：

```
<table>

<tr id="row1">
   <th>Header 1</th>      <td>Cell 1</td>        <td>Cell 2</td>
</tr>
<tr id="row2">
   <th>Header 2</th>      <td>Cell 3</td>        <td>Cell 4</td>
</tr>
<tr id="row3">
   <th>Header 3</th>      <td>Cell 5</td>        <td>Cell 6</td>
</tr>
</table> 
```

在你的 CSS 中：

```
th { text-align: center; font-weight: bold; vertical-align: baseline }

td { vertical-align: middle  }

table  { border-collapse: collapse; background-color: #ffffff }
tr#row1 { border-top: 3px solid blue }
tr#row2 { border-top: 1px solid black }
tr#row3 { border-top: 1px solid black } 
```

这将使表格具有背景颜色，并对其余表格数据/表格行执行不同的操作。

只需将其放在您的样式表中并在您的网页上引用它，如下所示：

```
<link rel="stylesheet" href="style.css" TYPE="text/css" media="screen"> 
```

你可以在你的 CSS 中放任何你喜欢的东西，更多关于 CSS 的信息在[这里](http://www.addedbytes.com/cheat-sheets/css-cheat-sheet/)和[这里](http://www.javascriptkit.com/dhtmltutors/cssreference.shtml)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T01:36:03.130

最好的猜测是 CSS[`background-color`](http://www.w3schools.com/Css/pr_background-color.asp)和[`border-color`](http://www.w3schools.com/CSS/pr_border-color.asp)：

```
<table style="border-color: #ffffff;">

<td style="background-color: #000000;"> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T06:20:04.193

还值得注意的是，虽然不像单独的样式部分那样优雅，但现在使用内联样式这样做是有效的，如果这是您更舒服的：

```
<body style="background-color: #ccc;"> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T01:35:59.197

较新的替代品是级联样式表 (CSS)。不推荐使用任何控制 HTML 文档的视觉外观的属性或元素。应使用 CSS 指定视觉样式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T01:36:29.570

执行此类操作的推荐方法是使用 CSS。您可以为您的表格设置 CSS 类。像这样的东西：

CSS：

```
.MyTable {
    border: solid 2px #000;
}

.MySpecialCell {
    background-color: #F00;
} 
```

HTML：

```
<table class="MyTable">
    <tr>
        <td class="MySpecialCell">...</td>
    </tr>
</table> 
```

# javascript - 在 IE7 中调试 JavaScript

> ID：361635
> 
> 赞同：160
> 
> 时间：2008-12-12T01:33:10.717
> 
> 标签：javascript, internet-explorer-7

我需要在 Internet Explorer 7 中调试 JavaScript。

不幸的是，它的默认调试器没有为我提供太多信息。它告诉我出现错误的页面（不是特定的脚本）并给我一个行号。我不知道这是否与我的问题有关。

如果它可以将错误缩小到特定脚本上的行号（如 Firebug 可以），那就太好了。

是否有像 Firebug 在 Firefox 中那样在 IE7 中调试 JavaScript 的插件？

谢谢！

### 也可以看看：

[IE7 是否有“开发者模式”或像 Firefox/Chrome/Safari 这样的插件？](https://stackoverflow.com/questions/56615/does-ie7-have-a-developer-mode-or-plugin-like-firefoxchromesafari)

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-12-12T01:48:13.853

[Web 开发助手](http://web-development-helper.software.informer.com)非常好。

[IE 开发工具栏](http://www.microsoft.com/downloads/en/details.aspx?familyid=95E06CBE-4940-4218-B75D-B8856FCED535&displaylang=en)通常很有帮助，但遗憾的是不进行脚本调试

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-12-12T02:34:54.740

铁的事实是：IE 唯一好的调试器是 Visual Studio。

如果您没有钱购买真正的交易，请免费下载~~Visual Web Developer 2008 Express Edition~~ [Visual Web Developer 2010 Express Edition](http://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1AzurePack)。虽然前者允许您将调试器附加到已经运行的 IE，但后者不允许（至少我使用的以前的版本不允许这样做）。如果情况仍然如此，诀窍是用一个空网页创建一个简单的项目，“运行”它（它启动浏览器），现在导航到要调试的任何页面，然后开始调试。

Microsoft 在不同的事件中提供完整的 Visual Studio，通常带有许可证限制，但它们允许在家里修修补补。检查他们的日程安排和免费赠品清单。

另一个提示：首先尝试使用其他浏览器调试您的 Web 应用程序。我在 Opera 上取得了巨大的成功。不知何故，Opera 对 IE 及其错误的仿真非常接近，但调试器要好得多。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-12-12T02:56:06.930

你可能想试试 [微软脚本调试器](http://www.microsoft.com/downloads/details.aspx?familyid=2f465be0-94fd-4569-b3c4-dffdf19ccd99&displaylang=en) ，它已经很老了，但如果你偶然发现任何 javascript 错误，它会非常有用，调试器会弹出来告诉你哪一行出错了。当您进行正常冲浪时，有时可能会令人不快，但如果关闭，您可以关闭。

这里也是关于如何使用这个工具的一个很好的启动。 [操作方法：在 Internet Explorer 中调试 JavaScript](http://jonathanboutelle.com/2006/01/16/how-to-debug-javascript-in-internet-explorer/)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-12-12T01:45:38.583

我找到[了 DebugBar](http://www.debugbar.com)。

不如 Firebug，但接近。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2010-01-26T11:23:05.173

在 IE7 中，您可以通过在地址栏中粘贴以下内容来为当前页面调出 firebug lite：

```
javascript:var firebug=document.createElement('script');firebug.setAttribute('src','http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js');document.body.appendChild(firebug);(function(){if(window.firebug.version){firebug.init();}else{setTimeout(arguments.callee);}})();void(firebug); 
```

请参阅[http://getfirebug.com/lite.html](http://getfirebug.com/lite.html)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-22T18:12:47.983

Microsoft Script Editor 确实是一个选项，在我尝试过的其中一个更稳定的选项中——IE8 中的调试器很棒，但由于某种原因，每当我启动开发者工具时，IE8 需要一段时间，有时最多分钟，检查我的页面的 DOM 树。之后它似乎想在每次页面刷新时都这样做，这是一种折磨。

您*可以*在 Microsoft 脚本编辑器中检查变量的内容：如果您在 Debug > Window 下四处寻找，您可以打开局部变量检查、观察等。

另一种选择，Visual Web Dev，虽然体积庞大，但运行良好。要进行设置，请执行以下操作（从[此处](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)窃取）：

1.  应该在 IE 中打开调试。进入工具> Internet选项>高级并检查*禁用脚本调试（Internet Explorer）*是否未选中并*显示有关每个脚本错误的通知*已选中
2.  在 VWD 中创建一个新的空 Web 项目
3.  右键单击右上角解决方案资源管理器中的站点，转到浏览方式并确保您的默认浏览器设置为 IE（如果您是 Web 开发人员，可以合理地假设 IE*不是*您的默认浏览器，在这种情况下这不会是默认的..默认情况下）
4.  按F5，IE会打开。浏览到要调试的页面。
5.  现在，只要您遇到脚本错误或在其中一个 JS 文件中设置断点，VWD 就会打开。调试！

**更新**：顺便说一句，如果您在使用 IE8 的其他不错的调试器时遇到与我相同的减速，则有一种解决方法——如果您遇到或使 IE 遇到错误，那么它会弹出“您要调试”对话框和点击是的，调试器会立即出现。如果您“直接”进入调试模式，开发工具似乎永远不会检查 DOM。只有当你按下 F12 时它才会这样做。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T02:17:13.670

IE8 有很多改进的开发者工具。在此之前，最好先为 firefox 编写 javascript，然后使用 alert() 语句调试 IE。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-12T03:13:46.410

Microsoft Script Editor 可用于在 IE 中调试 Javascript。它比 Microsoft Script Debugger 错误更少，但具有相同的基本功能，不幸的是，它几乎仅限于逐步执行。我似乎无法检查变量或任何类似的方便的东西。此外，出于某种奇怪的原因，它仅随 Office XP/2003 一起提供。如果您正在玩游戏，请在[此处](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)了解更多信息。

我下载了 Eugene Lazutkin 提到的 Visual Web Developer 2008 Express Edition，但还没有机会尝试。我建议在脚本编辑器/调试器之前尝试一下。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-12T14:02:23.860

它不是一个完整的调试器，但我的 DP_DEBUG 扩展提供了一些（我认为）有用的功能，它们可以在 IE、Firefox 和 Opera（9+）中运行。

您可以“转储”复杂 JavaScript 对象（甚至系统对象）的可视化表示，进行简化的日志记录和计时。该组件提供了简单的方法来启用或禁用它，以便您可以根据需要将调试器留在原处进行生产工作。

[DP_Debug](http://depressedpress.com/javascript-extensions/dp_debug/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-02-23T02:08:24.590

IE9 开发人员工具对我有用。只需将“浏览器模式”菜单项设置为 IE7。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-07-19T16:22:16.713

嘿，我遇到了同样的问题，发现这个应用程序[IETESTER](http://www.my-debugbar.com/wiki/IETester/HomePage)。非常棒，它是一个捆绑了 IE 5.5、6 和 7 的应用程序。您当前拥有的 IE 版本无关紧要。这允许您并排拥有多个版本。

如果您在 IE 选项中启用 javascript 调试并安装了 Visual Studio，您甚至可以使用所有可用的调试选项（手表、条件断点等）在 VS 中调试 javascript

如果您想在错误发生之前开始调试，您只需输入该行

```
debugger; 
```

进入您的 JS 代码，这将带您进入 VS 以在此语句之后开始调试。

对于测试 JS 代码的向后兼容性，这对我来说绝对是惊人的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-07T21:23:41.170

使用Internet Explorer 8。然后尝试开发者工具..您也可以在兼容模式下基于IE 7进行调试

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-18T12:58:02.260

FireBug 精简版：http: [//getfirebug.com/firebuglite](http://getfirebug.com/firebuglite)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-10-08T14:26:07.317

答案很简单。

1.  获取 Internet Explorer 9
2.  按 F12 加载开发者工具
3.  将浏览器模式切换到IE7

![在 IE9 上切换浏览器模式](https://i.stack.imgur.com/C8Dqq.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-05-20T19:17:37.343

通过像[JSLint](http://www.jslint.com/)这样的 Javascript 静态分析工具运行代码可以捕获一些常见的 IE7 错误，例如对象定义中的尾随逗号。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-06-11T11:28:26.340

IE8 开发者工具可以切换到 IE7 模式![在此处输入图像描述](https://i.stack.imgur.com/ShQWe.jpg)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-10-19T11:57:56.603

如果您仍然需要调试 IE 7，IE 11 的仿真模式运行良好。

转到菜单：开发工具，然后进行仿真并进行设置。它还提供错误行信息。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-08-09T04:01:47.300

以下工具对我很有用：

1) [http://www.debugbar.com/](http://www.debugbar.com/)

提供方便的用户界面，具有源、样式、DOM、脚本、HTML 检查等功能。它还会显示 JS 文件中的实际错误（哪一行，哪个文件）。

2) [http://www.my-debugbar.com/wiki/CompanionJS/Installing](http://www.my-debugbar.com/wiki/CompanionJS/Installing)

提供 IE6 或 IE7 的控制台（原本不支持）

*   截屏

[![在此处输入图像描述](https://i.stack.imgur.com/NkfTU.png)](https://i.stack.imgur.com/NkfTU.png)

# c++ - 你如何制作linux GUI？

> ID：361648
> 
> 赞同：26
> 
> 时间：2008-12-12T01:37:08.617
> 
> 标签：c++, c, linux, native

我的主要经验是使用 C && C++，所以我更愿意留在他们身边。我不想使用 QT、GTK 或 wxWidgets 或任何工具包之类的东西。我想学习本机编程，这违背了目的。考虑到这一点，我也想避免使用 Java。

我了解 gnome 和 xfce 和 KDE 等都是 Linux 的桌面环境，安装的基础通常是 X (Xorg)。在为 Linux 编码时，您是为 X 编码还是为桌面环境编码？是否有适用于 Linux 的标准 Linux 标头（如 win32 有 windows.h）？还是每个桌面环境都有不同的编码方法？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-12T01:49:30.370

X 是一个可怕的编程层，尽管您打算避免使用 Java、QT 或任何优秀的 UI 抽象层，但编写到那个级别会对您自己造成伤害。我已经做到了（很久以前，当 Motif 在我们使用的平台上处于起步阶段时），如果有更简单的方法，我*不会再这样做了。*

您对“本机编程”一词的使用使我有些困惑。如果你想学习原生编程，那就是你选择调用的 API。使用类似的推理，您也不应该使用 C 进行编码，而是选择汇编程序（或直接机器代码），因为 C 提供了对硬件的抽象。

如果你想学习 X 编程，那很好。您最终将获得对界面的更多控制权，但几乎所有其他人在软件交付方面都将超越您。就我自己而言，我更喜欢编写可以在许多平台上使用的更高级别的 API——它给了我更快的交付时间和更大的市场潜力。

你不是用原子建造房子，而是用砖块建造它。我的建议是使用这些工具，这就是它们的用途。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-12-12T02:32:36.930

*我不想使用 QT、GTK 或 wxWidgets 或任何工具包之类的东西。我想学习本机编程，这违背了目的。*

不，你没有。回到 X11 的早期版本，如 R1 或 R2，我仅在 Xlib 中编写了一个完整的“Hello, world”程序。

大约 700 行 C.

你不想去那里。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-12T01:45:35.887

我猜你可以直接针对[Xlib](http://en.wikipedia.org/wiki/Xlib)编写 C 代码，但你最终会重新创建 GTK+ 或 QT 提供的所有功能，而 X 并不孤单。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-12T07:44:29.327

Unix（以及扩展，Linux）实际上并没有定义任何与 GUI 相关的内容。X 是常用的，它没有定义任何与小部件或样式或任何类似性质的东西 - 它主要关注绘图原语和事件处理。本质上，如果你想用纯 X 编写，你将定义屏幕上每个元素的形状和行为。如果您疯狂到放弃 X，那么您将在图形帧缓冲区级别工作...

你最好使用*一些*工具包——如果你正在寻找轻量级的东西，为什么不试试[FLTK](http://www.fltk.org/)呢？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-12T01:48:49.437

GTK、QT 和 wx 是构建在 X 之上的工具包，可提供更友好的 API。

如果您不使用现有的工具包，您将需要在非常低的级别编写内容 - 直接处理鼠标和键盘事件。如果你想要一个按钮或一个文本框，你必须使用低级 xlib 原语自己编写。

在尝试这个之前，您最好选择您喜欢的桌面环境的工具包并从它开始。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T01:50:49.200

在这种情况下，根本就没有“原生”这样的东西。Windows 和 OS X 只有一个官方选项，而 X 没有。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T04:26:51.380

Linux 和大多数其他类 Unix 操作系统的“本机”接口是 Xlib，它是 X11 的最低级 C API。

GTK、Qt 和其他（据我所知）都是以 Xlib 为核心实现的。正如其他人所说，Xlib 为您提供最大的控制权，但您必须为此努力（其他人可能会在交付产品方面绕着您转圈）。

作为参考，我个人用 C++ 实现了一个功能相当丰富且现代（即可流动）的跨平台（Win32 + X11）GUI 库。总计数约为 29 KLOC 的 C++，其中 X11 和 Win32 匀场需要约 2500 行。其余的用于平台中立的 Widget 实现。除非您准备做出这样的承诺，否则我强烈建议您使用更高级别的库之一（Qt 可能是我的选择，尽管我无法忍受预处理器方法）。

顺便说一句，Xlib 的一大优点是它的原始可移植性——任何带屏幕的 Unix 盒子都可以，而且它也可以在 Windows 和 OS X 上工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-08-07T06:57:18.030

我觉得有必要在这里反驳其他答案的一致意见。X11确实是低级。但要“真正”了解发生了什么，您应该对 X11 的工作原理有所了解。由于所有工具包都在 X 之上工作，因此无论您喜欢与否，您都在使用它。我懒得搜索的地方有很好的在线教程。它指导您构建一个简单的 Hello World。为此，您必须学习如何创建窗口、请求事件、映射窗口以及循环处理事件。你甚至可以在亚马逊上订购一些旧书。O'Reilly vols 1 和 2（目前获得最便宜的版本，但不早于 X11R4）对于参考和了解这些部件如何协同工作的完整故事至关重要。然而，为了学习，

正如其他人所说，在这段旅程的某个时刻，你会发现你已经受够了。两页代码只是为了选择一个视觉对象，然后您仍然必须填充一个颜色图，然后才能绘制您的自定义位图。然后进行了两天的重写和调试，意识到这一切*都*有效；你只是忘了`XFlush()`！

斗争很重要，因为一旦找到你喜欢的工具包，你就会更加欣赏这些工具包。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T02:41:48.363

我也建议使用lesstif/motif。它也建立在 X 之上，在我看来，学习曲线不像 GTK 或 Qt 那样陡峭。不过，您使用它构建的 UI 不会像您可以使用 GTK 或 Qt 构建的那样复杂。更多信息可以在[这里](http://www.lesstif.org/ "lesstif.org")找到。

正如其他人提到的那样，您可能不想 X，这很痛苦。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-07T08:07:12.350

为什么不从 Qt、wxWidgets 和 GTK 中选择一个并学习它的内部结构，而不是它的 API？我的意思不仅仅是为了它，而是为了贡献你觉得最吸引人的部分。通过这种方式，您将实现您的目标并为您和他人做一些有用的事情。我认为这比给自己分配一个相当人为的任务来构建应用程序并使用错误的工具更有意义。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-10-28T14:07:57.350

哦，是的，有这样“原生”的东西：

FBUI、svgalib、directfb、exa(kdrive)、SDL、Allegro..+Wayland，虽然不是主流。

[http://home.comcast.net/~fbui/](http://home.comcast.net/~fbui/)

[http://www.svgalib.org/](http://www.svgalib.org/)

[http://directfb.org/](http://directfb.org/)

[http://xorg.freedesktop.org/wiki/ExaStatus](http://xorg.freedesktop.org/wiki/ExaStatus)

+ [http://wayland.freedesktop.org/](http://wayland.freedesktop.org/)

# delphi - 最好的 Delphi n 层低带宽技术是什么？

> ID：361658
> 
> 赞同：9
> 
> 时间：2008-12-12T01:41:57.330
> 
> 标签：delphi, n-tier-architecture, datasnap, remobjects

我需要在需要集中数据和文件存储系统（用于文档成像）但有多个分支机构且相互连接性相对较差的环境中部署 Delphi 应用程序。我相信 3 层数据库应用程序是最好的选择，这样我可以提供丰富的桌面体验和相对轻量级的数据传输需求。到目前为止，我已经简要介绍了 Delphi Datasnap、kbmMW 和 Remobjects SDK。似乎 kbmmW 和 Remobjects SDK 使用的带宽最少。有没有人有在具有大量用户（我需要支持 700+）的具有挑战性的环境中部署任何这些技术的经验？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T14:30:10.820

要记住的一件事......不是用户数量，而是同时使用资源的用户数量将成为问题。如果可能，尝试开发您的应用程序“无状态服务器”，如果您发现必须向池中添加更多服务器以支持您的客户群，这将在长期内提供更大的灵活性。关于 n 层最困难的事情是超出第一台服务器的扩展……从一开始就计划好。每个请求不应该知道任何关于先前请求的信息......或者至少请求应该有一种传递上下文的方式，以便服务器可以在会话表或其他东西中查找它。

就个人而言，我会推荐 RemObjects。我已经使用它并取得了很好的效果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T03:46:17.123

取决于您是否绑定到远程数据集。如果您不受数据集约束，那么 SOAP 可能是一个不错的选择。或者，我所做的是编写自己的协议，本质上类似于 SOAP。这是在 SOAP 成为标准之前完成的，我很高兴我这样做了——这使您能够控制更多的数据流。假设您的连接性较差，那么您将花时间支持它。如果您支持的是您自己的代码而不是等待供应商，那就太好了。（尽管众所周知，KBM 和 REM 是相当不错的供应商。）

个人注意：文档成像应用程序中的 700 名用户因连接性差而听起来像一团糟。把钱花在升级连接上，因为从长远来看它会更便宜。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-12T08:19:10.287

Both kbmMW and RO SDK offer binary format, which is more compact than SOAP format,specially you are working with documents.

RO sdk seems to offer more GUI tools to help you doing your services.

Also give a [RealThinClient SDK](http://www.realthinclient.org/about_sdk.htm) a look, it's a lightweight remoting framework.

But what ever framework you go with, your design of work will make it fast or slow, I have some applications working on slow 128kb lines, and it's working perfect without any user complain, but I don't do a large transfer for files.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T21:34:21.340

我不知道它是否是最好/最有效的（很高兴你问了这个问题！），但我在使用 RemObjects SDK + DataAbstract 时取得了很好的结果。后者减少了很多管道细节，这很有帮助。仍在实施，但到目前为止一切顺利。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T20:54:50.420

If you really wanna go "low-bandwidth" use BSD Sockets API - that'll give you full control over what's being sent and there you can send as little information as you want. Of course then you'll have to implement all the tiers yourself, but hey - that's still *an option* :D

# c# - 从数据库填充 TreeView

> ID：361661
> 
> 赞同：16
> 
> 时间：2008-12-12T01:43:39.213
> 
> 标签：c#, asp.net, database, webforms, treeview

我有一个包含以下字段的数据库表（名为主题）：

1.  主题ID
2.  姓名
3.  父母身份

通过使用它们，我想在 c# 中填充 TreeView。我怎样才能做到这一点 ？

提前致谢...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-12T01:53:10.333

它可能会是这样的。如果您需要更多，请详细说明您想要做什么。

```
//In Page load
foreach (DataRow row in topics.Rows)
{
    TreeNode node = new TreeNode(dr["name"], dr["topicId"])
    node.PopulateOnDemand = true;

     TreeView1.Nodes.Add(node);
 }
 ///
 protected void PopulateNode(Object sender, TreeNodeEventArgs e)
 {
     string topicId = e.Node.Value;
     //select from topic where parentId = topicId.
     foreach (DataRow row in topics.Rows)
     {
         TreeNode node = new TreeNode(dr["name"], dr["topicId"])
         node.PopulateOnDemand = true;

         e.Node.ChildNodes.Add(node);
     }

 } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-12T02:35:30.810

不完全的。

最好不要一次加载所有内容，从而最好地处理树木。因此，您需要获取没有 parentID 的根节点（或主题）。然后将它们添加到树根节点，然后对于您添加的每个节点，您需要获取它的子节点。

```
foreach (DataRow row in topicsWithOutParents.Rows)
{
   TreeNode node = New TreeNode(... whatever);
   DataSet childNodes = GetRowsWhereParentIDEquals(row["topicId"]);
   foreach (DataRow child in childNodes.Rows)
   { 
       Treenode childNode = new TreeNode(..Whatever);
       node.Nodes.add(childNode);
   }
   Tree.Nodes.Add(node);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-04T19:47:20.823

这段代码对我来说运行得很好，检查一下，我认为它会对你有所帮助:)

;

```
protected void Page_Load(object sender, EventArgs e)
{
    DataSet ds = RunQuery("Select topicid,name from Topics where Parent_ID IS NULL");
       for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
       { 
           TreeNode root = new TreeNode(ds.Tables[0].Rows[i][1].ToString(),ds.Tables[0].Rows[i][0].ToString());
           root.SelectAction = TreeNodeSelectAction.Expand;
           CreateNode(root);
           TreeView1.Nodes.Add(root);
       }

}
void CreateNode(TreeNode node)
{
    DataSet ds = RunQuery("Select topicid, name from Category where Parent_ID =" + node.Value);
    if (ds.Tables[0].Rows.Count == 0)
    {
        return;
    }
    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        TreeNode tnode = new TreeNode(ds.Tables[0].Rows[i][1].ToString(), ds.Tables[0].Rows[i][0].ToString());
        tnode.SelectAction = TreeNodeSelectAction.Expand;
        node.ChildNodes.Add(tnode);
        CreateNode(tnode);
    }

}
DataSet RunQuery(String Query)
{
    DataSet ds = new DataSet();
    String connStr = "???";//write your connection string here;
    using (SqlConnection conn = new SqlConnection(connStr))
    {
        SqlCommand objCommand = new SqlCommand(Query, conn);
        SqlDataAdapter da = new SqlDataAdapter(objCommand);
        da.Fill(ds);
        da.Dispose();
    }
    return ds;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-04-11T13:14:49.433

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
        PopulateRootLevel();
}

private void PopulateRootLevel()
{
    SqlConnection objConn = new SqlConnection(connStr);
    SqlCommand objCommand = new SqlCommand(@"select FoodCategoryID,FoodCategoryName,(select count(*) FROM FoodCategories WHERE ParentID=c.FoodCategoryID) childnodecount FROM FoodCategories c where ParentID IS NULL", objConn);
    SqlDataAdapter da = new SqlDataAdapter(objCommand);
    DataTable dt = new DataTable();
    da.Fill(dt);
    PopulateNodes(dt, TreeView2.Nodes);
}

private void PopulateSubLevel(int parentid, TreeNode parentNode)
{
    SqlConnection objConn = new SqlConnection(connStr);
    SqlCommand objCommand = new SqlCommand(@"select FoodCategoryID,FoodCategoryName,(select count(*) FROM FoodCategories WHERE ParentID=sc.FoodCategoryID) childnodecount FROM FoodCategories sc where ParentID=@parentID", objConn);
    objCommand.Parameters.Add("@parentID", SqlDbType.Int).Value = parentid;
    SqlDataAdapter da = new SqlDataAdapter(objCommand);
    DataTable dt = new DataTable();
    da.Fill(dt);
    PopulateNodes(dt, parentNode.ChildNodes);
}

protected void TreeView1_TreeNodePopulate(object sender, TreeNodeEventArgs e)
{
    PopulateSubLevel(Int32.Parse(e.Node.Value), e.Node);
}

private void PopulateNodes(DataTable dt, TreeNodeCollection nodes)
{
    foreach (DataRow dr in dt.Rows)
    {
        TreeNode tn = new TreeNode();
        tn.Text = dr["FoodCategoryName"].ToString();
        tn.Value = dr["FoodCategoryID"].ToString();
        nodes.Add(tn);

        //If node has child nodes, then enable on-demand populating
        tn.PopulateOnDemand = ((int)(dr["childnodecount"]) > 0);
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-12-04T05:57:23.413

当没有大量数据时，连接数据库，获取数据并为子/子节点一次又一次地添加到树视图节点是不好的。它可以在一次尝试中完成。请参阅以下示例：
[http ://urenjoy.blogspot.com/2009/08/display-hierarchical-data-with-treeview.html](http://urenjoy.blogspot.com/2009/08/display-hierarchical-data-with-treeview.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-09T09:53:18.153

这段代码对我来说运行完美。认为它可能对希望在树视图中显示层次结构数据的人有用。到目前为止，我想这是最简单的。如果对您有帮助，请检查并投票。

参考：[https ://techbrij.com/display-hierarchical-data-with-treeview-in-asp-net](https://techbrij.com/display-hierarchical-data-with-treeview-in-asp-net)

C#代码：

```
 //dtTree  should be accessible in both page load and AddNodes()
    //DocsMenu is the treeview Id
          DataTable dtTree = new DataTable(); 
//declare your connection string
                protected void Page_Load(object sender, EventArgs e)
                {
                    //DataTable dtTree = new DataTable();
                    using (con)
                    {
                        con.Open();

                        string sQuery = "Select topicId,parentid,name from tbl_topicMaster";
                        SqlCommand cmd = new SqlCommand(sQuery, con);
                        cmd.CommandType = CommandType.Text;
                        SqlDataAdapter da = new SqlDataAdapter(cmd);
                        da.Fill(dtTree);
                        da.Dispose();
                        con.Close();
                    }

                    AddNodes(-1, DocsMenu.Nodes);
                }

                void AddNodes(int id, TreeNodeCollection tn)
                {
                    foreach (DataRow dr in dtTree.Select("parentid= " + id))
                    {
                        TreeNode sub = new TreeNode(dr["name"].ToString(), dr["topicId"].ToString());
                        tn.Add(sub);
                        AddNodes(Convert.ToInt32(sub.Value), sub.ChildNodes);
                    }
                } 
```

asp代码：

```
<asp:TreeView ID="DocsMenu" runat="server" ImageSet="BulletedList" 
        NodeIndent="15"  >  
                    <HoverNodeStyle Font-Underline="True" ForeColor="#6666AA" />
                    <NodeStyle Font-Names="Tahoma" Font-Size="8pt" ForeColor="Black" HorizontalPadding="2px"  
                        NodeSpacing="0px" VerticalPadding="2px"></NodeStyle>  
                    <ParentNodeStyle Font-Bold="False" />  
                    <SelectedNodeStyle BackColor="#B5B5B5" Font-Underline="False" HorizontalPadding="0px"  
                        VerticalPadding="0px" />
                                 </asp:TreeView> 
```

# python - Python - doctest 与 unittest

> ID：361675
> 
> 赞同：167
> 
> 时间：2008-12-12T01:50:19.310
> 
> 标签：python, unit-testing, comparison, doctest

我正在尝试开始在 Python 中进行单元测试，我想知道是否有人可以解释 doctest 和 unittest 的优缺点。

你会在什么条件下使用它们？

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2008-12-12T10:23:35.233

两者都很有价值。我使用 doctest 和[nose](https://pypi.python.org/pypi/nose/)来代替 unittest。我将 doctest 用于测试给出一个实际用作文档的使用示例的情况。一般来说，我不会让这些测试全面，仅仅为了提供信息。我有效地反向使用 doctest：不是根据我的 doctest 测试我的代码是否正确，而是根据代码检查我的文档是否正确。

原因是我发现全面的文档测试会使您的文档过于混乱，因此您最终会得到不可用的文档字符串或不完整的测试。

对于实际测试*代码*，目标是彻底测试每个案例，而不是通过示例来说明是做什么的，这是一个不同的目标，我认为其他框架更好地满足这一目标。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-12-12T01:53:38.960

我几乎完全使用 unittest。

偶尔，我会把一些东西放在一个 doctest 可用的 docstring 中。

95% 的测试用例都是单元测试。

为什么？我喜欢让文档字符串更短一些，更切中要害。有时测试用例有助于澄清文档字符串。大多数时候，应用程序的测试用例对于文档字符串来说太长了。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-03-20T20:22:31.257

doctesting 的另一个优点是您可以确保您的代码按照文档中的说明进行操作。一段时间后，软件更改可以使您的文档和代码做不同的事情。:-)

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2012-06-02T10:53:08.813

我是一名生物信息学家，我编写的大部分代码都是“一次，一项任务”脚本，这些代码只会运行一次或两次并执行单个特定任务。

在这种情况下，编写大型单元测试可能有点过头了，而 doctest 是一个有用的折衷方案。它们的编写速度更快，并且由于它们通常包含在代码中，因此它们允许始终关注代码的行为方式，而无需打开另一个文件。这在编写小脚本时很有用。

此外，当您必须将脚本传递给非编程专家的研究人员时，文档测试很有用。有些人发现很难理解单元测试的结构；另一方面，文档测试是简单的使用示例，因此人们只需复制和粘贴它们即可查看如何使用它们。

所以，继续我的回答：当你必须编写小脚本，以及当你必须将它们传递给非计算机科学家的研究人员或将它们展示给他们时，文档测试很有用。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-12-12T01:55:25.227

如果您刚开始接触单元测试的想法，我会从它开始，`doctest`因为它使用起来非常简单。它还自然地提供了一定程度的文档。对于使用 进行更全面的测试`doctest`，您可以将测试放在外部文件中，这样它就不会弄乱您的文档。

我建议`unittest`您是否来自使用过 JUnit 或类似软件的背景，您希望能够以与其他地方相同的方式编写单元测试。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-12T02:19:46.753

我专门使用单元测试；我认为 doctest 把主模块弄得太乱了。这可能与编写彻底的测试有关。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-12-12T03:25:02.330

两者都使用是一个有效且相当简单的选项。该`doctest`模块提供了`DoctTestSuite`和`DocFileSuite`方法，它们分别从模块或文件创建与单元测试兼容的测试套件。

所以我两者都使用，并且通常使用 doctest 进行简单的测试，这些测试需要很少或不需要设置（参数的简单类型）。我实际上认为一些 doctest 测试*有助于*记录功能，而不是减损它。

但是对于更复杂的情况，以及更全面的测试用例集，我使用 unittest，它提供了更多的控制和灵活性。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-12-05T11:18:02.680

我不使用 doctest 作为 unittest 的替代品。尽管它们有些重叠，但两个模块的功能不同：

*   我`unittest`用作单元测试框架，这意味着它可以帮助我快速确定任何修改对其余代码的影响。

*   我`doctest`用作保证注释（即文档字符串）仍然与当前版本的代码相关。

我从`unittest`. `doctest`解决了过时的注释误导代码维护的更微妙的危险。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-12T02:12:54.520

我几乎从不使用文档测试。我希望我的代码能够自我记录，并且文档字符串向用户提供文档。IMO 向模块添加数百行测试会使文档字符串的可读性大大降低。我还发现单元测试在需要时更容易修改。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-04-18T08:41:19.193

`Doctest`有时会导致错误的结果。特别是当输出包含转义序列时。例如

```
def convert():
    """
    >>> convert()
    '\xe0\xa4\x95'
    """
    a = '\xe0\xa4\x95'
    return a
import doctest
doctest.testmod() 
```

给

```
**********************************************************************
File "hindi.py", line 3, in __main__.convert
Failed example:
    convert()
Expected:
    'क'
Got:
    '\xe0\xa4\x95'
**********************************************************************
1 items had failures:
   1 of   1 in __main__.convert
***Test Failed*** 1 failures. 
```

也不检查输出的类型。它只是比较输出字符串。例如，它使某种类型有理，如果它是一个整数，它就像整数一样打印。然后假设你有返回理性的函数。因此，doctest 不会区分输出是有理整数还是整数。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-12T04:20:59.223

我更喜欢基于发现的系统（“nose”和“py.test”，目前使用前者）。

当测试作为文档也很好时，doctest 很好，否则它们往往会使代码过于混乱。

# algorithm - 图表上“漂亮”网格线间隔的算法

> ID：361681
> 
> 赞同：69
> 
> 时间：2008-12-12T01:54:19.800
> 
> 标签：algorithm, charts, graph

我需要一个相当聪明的算法来为图形（图表）提出“漂亮”的网格线。

例如，假设一个条形图的值为 10、30、72 和 60。您知道：

最小值：10 最大值：72 范围：62

第一个问题是：你从什么开始？在这种情况下，0 将是直观的值，但这不适用于其他数据集，所以我猜：

网格最小值应为 0 或低于范围内数据最小值的“好”值。或者，可以指定它。

网格最大值应该是高于该范围最大值的“好”值。或者，可以指定它（例如，如果您显示百分比，则可能需要 0 到 100，而与实际值无关）。

范围内的网格线（刻度线）的数量应该是指定的，或者是给定范围内的一个数字（例如 3-8），这样值是“不错的”（即整数），并且您可以最大限度地利用图表区域。在我们的示例中，80 将是一个合理的最大值，因为这将使用图表高度的 90% (72/80)，而 100 会浪费更多空间。

任何人都知道一个好的算法吗？语言是无关紧要的，因为我会在我需要的地方实现它。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-12T02:02:13.560

我已经用一种蛮力方法做到了这一点。首先，找出你可以放入空间的最大刻度线数。将值的总范围除以刻度数；这是刻度线的*最小*间距。现在计算以 10 为底的对数下限以获得刻度的大小，然后除以该值。您最终应该得到 1 到 10 范围内的值。只需选择大于或等于该值的整数并将其乘以之前计算的对数即可。这是您的最终刻度间距。

Python 中的示例：

```
import math

def BestTick(largest, mostticks):
    minimum = largest / mostticks
    magnitude = 10 ** math.floor(math.log(minimum, 10))
    residual = minimum / magnitude
    if residual > 5:
        tick = 10 * magnitude
    elif residual > 2:
        tick = 5 * magnitude
    elif residual > 1:
        tick = 2 * magnitude
    else:
        tick = magnitude
    return tick 
```

编辑：您可以自由更改“好”间隔的选择。一位评论者似乎对提供的选择不满意，因为实际的刻度数可能比最大值少 2.5 倍。这是一个小的修改，它定义了一个漂亮的间隔表。在示例中，我扩展了选择，以便刻度数不会小于最大值的 3/5。

```
import bisect

def BestTick2(largest, mostticks):
    minimum = largest / mostticks
    magnitude = 10 ** math.floor(math.log(minimum, 10))
    residual = minimum / magnitude
    # this table must begin with 1 and end with 10
    table = [1, 1.5, 2, 3, 5, 7, 10]
    tick = table[bisect.bisect_right(table, residual)] if residual < 10 else 10
    return tick * magnitude 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-12T02:09:48.630

有2个问题：

1.  确定所涉及的数量级，以及
2.  四舍五入到方便的地方。

您可以使用对数处理第一部分：

```
range = max - min;  
exponent = int(log(range));       // See comment below.
magnitude = pow(10, exponent); 
```

因此，例如，如果您的范围是 50 - 1200，则指数为 3，幅度为 1000。

然后通过确定网格中需要多少细分来处理第二部分：

```
value_per_division = magnitude / subdivisions; 
```

这是一个粗略的计算，因为指数已被截断为整数。您可能想要调整指数计算以更好地处理边界条件，*例如*通过舍入而不是采用`int()`如果最终细分太多。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-13T13:41:02.147

我使用以下算法。它与此处发布的其他人相似，但它是 C# 中的第一个示例。

```
public static class AxisUtil
{
    public static float CalcStepSize(float range, float targetSteps)
    {
        // calculate an initial guess at step size
        var tempStep = range/targetSteps;

        // get the magnitude of the step size
        var mag = (float)Math.Floor(Math.Log10(tempStep));
        var magPow = (float)Math.Pow(10, mag);

        // calculate most significant digit of the new step size
        var magMsd = (int)(tempStep/magPow + 0.5);

        // promote the MSD to either 1, 2, or 5
        if (magMsd > 5)
            magMsd = 10;
        else if (magMsd > 2)
            magMsd = 5;
        else if (magMsd > 1)
            magMsd = 2;

        return magMsd*magPow;
    }
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-12T02:19:55.147

CPAN[在这里](http://search.cpan.org/dist/Chart-Math-Axis/lib/Chart/Math/Axis.pm)提供了一个实现（见源链接）

另请参见*[图轴的 Tickmark 算法](https://stackoverflow.com/questions/237220/tickmark-algorithm-for-a-graph-axis)*

仅供参考，使用您的示例数据：

*   枫木：Min=8，Max=74，Labels=10,20,..,60,70，Ticks=10,12,14,..70,72
*   MATLAB：最小值=10，最大值=80，标签=10,20,,..,60,80

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-25T16:47:32.610

这是 JavaScript 中的另一个实现：

```
var calcStepSize = function(range, targetSteps)
{
  // calculate an initial guess at step size
  var tempStep = range / targetSteps;

  // get the magnitude of the step size
  var mag = Math.floor(Math.log(tempStep) / Math.LN10);
  var magPow = Math.pow(10, mag);

  // calculate most significant digit of the new step size
  var magMsd = Math.round(tempStep / magPow + 0.5);

  // promote the MSD to either 1, 2, or 5
  if (magMsd > 5.0)
    magMsd = 10.0;
  else if (magMsd > 2.0)
    magMsd = 5.0;
  else if (magMsd > 1.0)
    magMsd = 2.0;

  return magMsd * magPow;
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-10-01T16:36:05.013

取自上面的 Mark，一个稍微完整的 C# 中的 Util 类。这也计算了一个合适的第一个和最后一个刻度。

```
public  class AxisAssists
{
    public double Tick { get; private set; }

    public AxisAssists(double aTick)
    {
        Tick = aTick;
    }
    public AxisAssists(double range, int mostticks)
    {
        var minimum = range / mostticks;
        var magnitude = Math.Pow(10.0, (Math.Floor(Math.Log(minimum) / Math.Log(10))));
        var residual = minimum / magnitude;
        if (residual > 5)
        {
            Tick = 10 * magnitude;
        }
        else if (residual > 2)
        {
            Tick = 5 * magnitude;
        }
        else if (residual > 1)
        {
            Tick = 2 * magnitude;
        }
        else
        {
            Tick = magnitude;
        }
    }

    public double GetClosestTickBelow(double v)
    {
        return Tick* Math.Floor(v / Tick);
    }
    public double GetClosestTickAbove(double v)
    {
        return Tick * Math.Ceiling(v / Tick);
    }
} 
```

具有创建实例的能力，但如果您只想计算并丢弃它：

```
 double tickX = new AxisAssists(aMaxX - aMinX, 8).Tick; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-03T16:16:21.003

我是“[图表轴上的最佳缩放算法](https://stackoverflow.com/questions/8506881/nice-label-algorithm-for-charts-with-minimum-ticks/16363437#16363437)”的作者。它曾经托管在 trollop.org 上，但我最近移动了域/博客引擎。

请参阅我[对相关问题的回答](https://stackoverflow.com/questions/8506881/nice-label-algorithm-for-charts-with-minimum-ticks/16363437#16363437)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-03T20:33:27.917

我写了一个objective-c方法来为你的数据集的给定的最小值和最大值返回一个漂亮的轴刻度和漂亮的刻度：

```
- (NSArray*)niceAxis:(double)minValue :(double)maxValue
{
    double min_ = 0, max_ = 0, min = minValue, max = maxValue, power = 0, factor = 0, tickWidth, minAxisValue = 0, maxAxisValue = 0;
    NSArray *factorArray = [NSArray arrayWithObjects:@"0.0f",@"1.2f",@"2.5f",@"5.0f",@"10.0f",nil];
    NSArray *scalarArray = [NSArray arrayWithObjects:@"0.2f",@"0.2f",@"0.5f",@"1.0f",@"2.0f",nil];

    // calculate x-axis nice scale and ticks
    // 1\. min_
    if (min == 0) {
        min_ = 0;
    }
    else if (min > 0) {
        min_ = MAX(0, min-(max-min)/100);
    }
    else {
        min_ = min-(max-min)/100;
    }

    // 2\. max_
    if (max == 0) {
        if (min == 0) {
            max_ = 1;
        }
        else {
            max_ = 0;
        }
    }
    else if (max < 0) {
        max_ = MIN(0, max+(max-min)/100);
    }
    else {
        max_ = max+(max-min)/100;
    }

    // 3\. power
    power = log(max_ - min_) / log(10);

    // 4\. factor
    factor = pow(10, power - floor(power));

    // 5\. nice ticks
    for (NSInteger i = 0; factor > [[factorArray objectAtIndex:i]doubleValue] ; i++) {
        tickWidth = [[scalarArray objectAtIndex:i]doubleValue] * pow(10, floor(power));
    }

    // 6\. min-axisValues
    minAxisValue = tickWidth * floor(min_/tickWidth);

    // 7\. min-axisValues
    maxAxisValue = tickWidth * floor((max_/tickWidth)+1);

    // 8\. create NSArray to return
    NSArray *niceAxisValues = [NSArray arrayWithObjects:[NSNumber numberWithDouble:minAxisValue], [NSNumber numberWithDouble:maxAxisValue],[NSNumber numberWithDouble:tickWidth], nil];

    return niceAxisValues;
} 
```

您可以像这样调用该方法：

```
NSArray *niceYAxisValues = [self niceAxis:-maxy :maxy]; 
```

并让您设置轴：

```
double minYAxisValue = [[niceYAxisValues objectAtIndex:0]doubleValue];
double maxYAxisValue = [[niceYAxisValues objectAtIndex:1]doubleValue];
double ticksYAxis = [[niceYAxisValues objectAtIndex:2]doubleValue]; 
```

以防万一您想限制轴刻度的数量，请执行以下操作：

```
NSInteger maxNumberOfTicks = 9;
NSInteger numberOfTicks = valueXRange / ticksXAxis;
NSInteger newNumberOfTicks = floor(numberOfTicks / (1 + floor(numberOfTicks/(maxNumberOfTicks+0.5))));
double newTicksXAxis = ticksXAxis * (1 + floor(numberOfTicks/(maxNumberOfTicks+0.5))); 
```

代码的第一部分基于我在[这里](http://peltiertech.com/WordPress/calculate-nice-axis-scales-in-your-excel-worksheet/)找到的计算来计算漂亮的图形轴比例和类似于 excel 图形的刻度。它适用于所有类型的数据集。下面是一个 iPhone 实现的例子：

![在此处输入图像描述](https://i.stack.imgur.com/YHOhs.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T02:22:42.473

另一个想法是让轴的范围是值的范围，但将刻度线放在适当的位置..即7到22：

```
[- - - | - - - - | - - - - | - - ]
       10 15 20

```

至于选择刻度间距，我建议使用 10^x * i / n 形式的任意数字，其中 i < n 且 0 < n < 10。生成此列表，并对它们进行排序，您可以找到最大的数字使用二分搜索小于 value_per_division（如在 adam_liss 中）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-08-05T01:38:10.207

`ndex`使用从这里已经可用的答案中获得的很多灵感，这是我在 C 中的实现。请注意，数组中内置了一些可扩展性。

```
float findNiceDelta(float maxvalue, int count)
{
    float step = maxvalue/count,
         order = powf(10, floorf(log10(step))),
         delta = (int)(step/order + 0.5);

    static float ndex[] = {1, 1.5, 2, 2.5, 5, 10};
    static int ndexLenght = sizeof(ndex)/sizeof(float);
    for(int i = ndexLenght - 2; i > 0; --i)
        if(delta > ndex[i]) return ndex[i + 1] * order;
    return delta*order;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-10-04T12:57:10.290

在 R 中，使用

```
tickSize <- function(range,minCount){
    logMaxTick <- log10(range/minCount)
    exponent <- floor(logMaxTick)
    mantissa <- 10^(logMaxTick-exponent)
    af <- c(1,2,5) # allowed factors
    mantissa <- af[findInterval(mantissa,af)]
    return(mantissa*10^exponent)
} 
```

其中范围参数是域的最大最小值。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-07T13:22:26.743

这是我编写的一个 javascript 函数，用于将网格间隔舍`(max-min)/gridLinesNumber`入到漂亮的值。它适用于任何数字，请参阅带有详细注释的[要点](https://gist.github.com/grabantot/803b809ee45cd635f240)以了解它的工作原理以及如何调用它。

```
var ceilAbs = function(num, to, bias) {
  if (to == undefined) to = [-2, -5, -10]
  if (bias == undefined) bias = 0
  var numAbs = Math.abs(num) - bias
  var exp = Math.floor( Math.log10(numAbs) )

    if (typeof to == 'number') {
        return Math.sign(num) * to * Math.ceil(numAbs/to) + bias
    }

  var mults = to.filter(function(value) {return value > 0})
  to = to.filter(function(value) {return value < 0}).map(Math.abs)
  var m = Math.abs(numAbs) * Math.pow(10, -exp)
  var mRounded = Infinity

  for (var i=0; i<mults.length; i++) {
    var candidate = mults[i] * Math.ceil(m / mults[i])
    if (candidate < mRounded)
      mRounded = candidate
  }
  for (var i=0; i<to.length; i++) {
    if (to[i] >= m && to[i] < mRounded)
      mRounded = to[i]
  }
  return Math.sign(num) * mRounded * Math.pow(10, exp) + bias
} 
```

调用`ceilAbs(number, [0.5])`不同的数字将像这样对数字进行四舍五入：

```
301573431.1193228 -> 350000000
14127.786597236991 -> 15000
-63105746.17236853 -> -65000000
-718854.2201183736 -> -750000
-700660.340487957 -> -750000
0.055717507097870114 -> 0.06
0.0008068701205775142 -> 0.00085
-8.66660070605576 -> -9
-400.09256079792976 -> -450
0.0011740548815578223 -> 0.0015
-5.3003294346854085e-8 -> -6e-8
-0.00005815960629843176 -> -0.00006
-742465964.5184875 -> -750000000
-81289225.90985894 -> -85000000
0.000901771713513881 -> 0.00095
-652726598.5496342 -> -700000000
-0.6498901364393532 -> -0.65
0.9978325804695487 -> 1
5409.4078950583935 -> 5500
26906671.095639467 -> 30000000 
```

查看[小提琴](https://jsfiddle.net/grabantot/j3a9fz3p/)以试验代码。答案中的代码，要点和小提琴略有不同，我使用的是答案中给出的代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-08T12:44:37.270

如果您试图让比例尺在 VB.NET 图表上看起来正确，那么我使用了 Adam Liss 的示例，但请确保在设置最小和最大比例尺值时将它们从十进制类型的变量中传入（不是单或双类型）否则刻度线值最终设置为小数点后 8 位。例如，我有 1 个图表，其中我将最小 Y 轴值设置为 0.0001，将最大 Y 轴值设置为 0.002。如果我将这些值作为单曲传递给图表对象，我会得到 0.00048000001697801、0.000860000036482233 的刻度线值 .... 而如果我将这些值作为小数传递给图表对象，我会得到很好的刻度线值 0.00048、0.00086 .... ..

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-01-01T20:29:30.317

在蟒蛇中：

```
steps = [numpy.round(x) for x in np.linspace(min, max, num=num_of_steps)] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-11T14:33:07.540

**可以动态始终绘制 0 的答案**，处理正数和负数以及小数和大数，**给出刻度间隔大小和要绘制的**数量；用围棋写的

forcePlotZero 更改最大值的四舍五入方式，因此它总是会产生一个很好的倍数，然后再回到零。例子：

如果 forcePlotZero == false 那么 237 --> 240

如果 forcePlotZero == true 那么 237 --> 300

间隔的计算方法是将 10/100/1000 等的倍数作为最大值，然后减去，直到这些减法的累积总和小于最小值

这是函数的输出，以及显示 forcePlotZero

| 强制绘制零 | 最大和最小输入 | 舍入最大值和最小值 | 间隔 |
| --- | --- | --- | --- |
| forcePlotZero=false | 最小值：-104 最大值：240 | 最小：-160 最大：240 | 间隔计数：5 间隔大小：100 |
| forcePlotZero=true | 最小值：-104 最大值：240 | 最小：-200 最大：300 | 间隔计数：6 间隔大小：100 |
| forcePlotZero=false | 最小：40 最大：1240 | 最小：0 最大：1300 | 间隔计数：14 间隔大小：100 |
| forcePlotZero=false | 最小：200 最大：240 | 最小：190 最大：240 | 间隔计数：6 间隔大小：10 |
| forcePlotZero=false | 最小：0.7 最大：1.12 | 最小：0.6 最大：1.2 | 间隔计数：7 间隔大小：0.1 |
| forcePlotZero=false | 最小值：-70.5 最大值：-12.5 | 最小：-80 最大：-10 | 间隔计数：8 间隔大小：10 |

这是游乐场链接[https://play.golang.org/p/1IhiX_hRQvo](https://play.golang.org/p/1IhiX_hRQvo)

```
func getMaxMinIntervals(max float64, min float64, forcePlotZero bool) (maxRounded float64, minRounded float64, intervalCount float64, intervalSize float64) {

//STEP 1: start off determining the maxRounded value for the axis
precision := 0.0
precisionDampener := 0.0 //adjusts to prevent 235 going to 300, instead dampens the scaling to get 240
epsilon := 0.0000001
if math.Abs(max) >= 0 && math.Abs(max) < 2 {
    precision = math.Floor(-math.Log10(epsilon + math.Abs(max) - math.Floor(math.Abs(max)))) //counting number of zeros between decimal point and rightward digits
    precisionDampener = 1
    precision = precision + precisionDampener
} else if math.Abs(max) >= 2 && math.Abs(max) < 100 {
    precision = math.Ceil(math.Log10(math.Abs(max)+1)) * -1 //else count number of digits before decimal point
    precisionDampener = 1
    precision = precision + precisionDampener
} else {
    precision = math.Ceil(math.Log10(math.Abs(max)+1)) * -1 //else count number of digits before decimal point
    precisionDampener = 2
    if forcePlotZero == true {
        precisionDampener = 1
    }
    precision = precision + precisionDampener
}

useThisFactorForIntervalCalculation := 0.0 // this is needed because intervals are calculated from the max value with a zero origin, this uses range for min - max
if max < 0 {
    maxRounded = (math.Floor(math.Abs(max)*(math.Pow10(int(precision)))) / math.Pow10(int(precision)) * -1)
    useThisFactorForIntervalCalculation = (math.Floor(math.Abs(max)*(math.Pow10(int(precision)))) / math.Pow10(int(precision))) + ((math.Ceil(math.Abs(min)*(math.Pow10(int(precision)))) / math.Pow10(int(precision))) * -1)
} else {
    maxRounded = math.Ceil(max*(math.Pow10(int(precision)))) / math.Pow10(int(precision))
    useThisFactorForIntervalCalculation = maxRounded
}

minNumberOfIntervals := 2.0
maxNumberOfIntervals := 19.0
intervalSize = 0.001
intervalCount = minNumberOfIntervals

//STEP 2: get interval size (the step size on the axis)
for {
    if math.Abs(useThisFactorForIntervalCalculation)/intervalSize < minNumberOfIntervals || math.Abs(useThisFactorForIntervalCalculation)/intervalSize > maxNumberOfIntervals {
        intervalSize = intervalSize * 10
    } else {
        break
    }
}

//STEP 3: check that intervals are not too large, safety for max and min values that are close together (240, 220 etc)
for {
    if max-min < intervalSize {
        intervalSize = intervalSize / 10
    } else {
        break
    }
}

//STEP 4: now we can get minRounded by adding the interval size to 0 till we get to the point where another increment would make cumulative increments > min, opposite for negative in
minRounded = 0.0

if min >= 0 {
    for {
        if minRounded < min {
            minRounded = minRounded + intervalSize
        } else {
            minRounded = minRounded - intervalSize
            break
        }
    }
} else {
    minRounded = maxRounded //keep going down, decreasing by the interval size till minRounded < min
    for {
        if minRounded > min {
            minRounded = minRounded - intervalSize

        } else {
            break
        }
    }
}

//STEP 5: get number of intervals to draw
intervalCount = (maxRounded - minRounded) / intervalSize
intervalCount = math.Ceil(intervalCount) + 1 // include the origin as an interval

//STEP 6: Check that the intervalCount isn't too high
if intervalCount-1 >= (intervalSize * 2) && intervalCount > maxNumberOfIntervals {
    intervalCount = math.Ceil(intervalCount / 2)
    intervalSize *= 2
}

return} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-26T14:11:36.353

这是在 python 中，以 10 为基础。不涵盖您的所有问题，但我认为您可以在此基础上进行构建

```
import numpy as np

def create_ticks(lo,hi):
    s = 10**(np.floor(np.log10(hi - lo)))
    start = s * np.floor(lo / s)
    end = s * np.ceil(hi / s)
    ticks = [start]
    t = start
    while (t <  end):
        ticks += [t]
        t = t + s

    return ticks 
```

# hosting - 您如何跟踪客户的托管/域/SSL 证书到期日期？

> ID：361686
> 
> 赞同：0
> 
> 时间：2008-12-12T02:02:11.390
> 
> 标签：hosting, dns, certificate, ssl-certificate

本身不是编程问题，但对从事商业 Web 开发的人来说很有趣。

您如何跟踪所有客户的托管、域注册和 SSL 证书到期日期？

你只是保留一个电子表格还是有一些有用的软件呢？

我进行了广泛的搜索，找不到可用的软件，很想写点东西。由于要管理 100 多个客户，并且托管和域名分布在多家托管公司和注册商中，我的临时手段失败了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T02:56:53.947

我们把它变成一个编程问题怎么样！您可以使用此代码（C#），但我建议对其稍作修改（例如，将 url 放入文件中）并将其放入服务中。

此代码设置证书验证回调，HttpWebRequest 将在遇到证书时调用该回调。这让我们可以查看证书，通常这用于验证证书，但我们将查看到期时间，如果在 3 个月内，我们将向自己发送电子邮件。设置了一个计时器以每天运行一次检查。

```
using System.Net;
using System.Diagnostics;
using System.Net.Mail;
using System.Threading;

static void Main(string[] args)
{
    // List of URL's to check
    string[] urls = new string[]{
        "https://www.6bit.com/",
        "https://www.google.com/"
    };

    HttpWebRequest req = null;

    // Certificate check callback
    ServicePointManager.ServerCertificateValidationCallback = (state, cert, certChain, sslerr) =>
    {
        DateTime expiration = DateTime.Parse(cert.GetExpirationDateString());
        if (expiration < DateTime.Now.AddMonths(3))
        {
            Debug.WriteLine("Cert expiring on " + expiration.ToShortDateString());
            MailMessage msg = new MailMessage("SSLCheck@example.com", "josh@example.com", "SSL Certificate Expiring", "The ssl certificate for" + req.RequestUri.ToString() + " will expire on " + expiration.ToShortDateString());
            SmtpClient sc = new SmtpClient();
            sc.Send(msg);
        }

        return true;
    };

    // Request each url once a day so that the validation callback runs for each
    Timer t = new Timer(s =>
    {
        Array.ForEach(urls, url =>
        {
            try
            {
                req = (HttpWebRequest)HttpWebRequest.Create(url);
                HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
                resp.Close();
            }
            catch (Exception ex)
            {
                Debug.WriteLine("Error checking site: " + ex.ToString());
            }
        });
    }, null, TimeSpan.FromSeconds(0), TimeSpan.FromDays(1));  // Run the timer now and schedule to run once a day
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T02:06:57.153

使用通常用于管理时间/日程的任何工具可能比使用一些专门的工具更好。无论是 Outlook、Sunbird、Lightning、PDA、手机、纸质日历等。只需使用您通常用于跟踪日期的任何工具。

[添加]

详细地说，您希望将其与其他重要日期放在同一个地方的原因是它确保（至少一点）您注意列表。如果您使用的是其他类型的程序，那么很容易忙几个星期，忘记查看您的特殊工具，最终让一些不应该过期的东西过期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-25T15:26:29.217

关于管理 SSL 证书，您可以编写一个调用 OpenSSL 的脚本，或者如果您想要一些现成的东西，您可以试试这个：

[SSL 证书发现和监控工具](http://www.redkestrel.co.uk/cgi/certchecker.cgi)

它会在您的网络上查找和编目证书，并在证书即将到期时发送电子邮件警报。结果可以导入一个名为 Cert Centre 的基于网络的工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-22T10:15:23.527

尝试使用[epazote](https://epazote.io)基本上您可以在 yaml 文件上创建站点（服务）列表，并在证书到期之前收到电子邮件/警报/hipchat 通知，例如：

```
services:
    google:
        url: https://www.google.com
        seconds: 60
        expect:
            status: 302
            ssl:
                hours: 72 
```

在这种情况下，可以在证书到期前 72 小时发送电子邮件。

更多详细信息：[https ://epazote.io/post/how-to-use-it/](https://epazote.io/post/how-to-use-it/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-30T17:53:09.227

You can use a service like [https://IsItWorking.info](https://IsItWorking.info) to track domain registration, and SSL certificate expiry.

You can set when you want to get notifications (e.g. 60 days before expiry) and it can notify you by email, slack or pushover.

(full disclosure: I wrote it!)

# perl - 如何从 Tomcat 下的 cgi 目录提供图像？

> ID：361688
> 
> 赞同：0
> 
> 时间：2008-12-12T02:03:11.280
> 
> 标签：perl, tomcat, cgi

我已将 Tomcat 6 配置为提供 Perl CGI 脚本。那部分有[据可查](http://tomcat.apache.org/tomcat-6.0-doc/cgi-howto.html) ，对我来说工作正常。

但是，当浏览器从这个 CGI 目录请求图像时，T​​omcat 的 CGI servlet 拒绝提供图像，而只显示图像的 url。我相信这是一个安全功能，可以防止用户看到这些文件的一般内容。

如何配置 tomcat、tomcat CGI servlet 和/或 tomcat 默认 servlet，以实际提供恰好位于我的 CGI 目录中的图像文件？那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T02:10:47.630

为什么要将图像放在 CGI 目录中？他们不应该在正常的文档根目录下吗？

如果您在脚本的输出中构建相对路径，请将 BASE 标记添加到 HTML 头部，或使链接成为绝对 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T04:15:47.923

由于[Bugzilla 指南](http://www.bugzilla.org/docs/tip/en/html)仅包含Apache 和 MS IIS 的[配置指南](http://www.bugzilla.org/docs/tip/en/html/configuration.html)，并且 google 没有出现任何讨论成功部署的帖子，因此您最好的选择可能是坚持使用有文档且受支持的配置 Apache 或 IIS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:19:59.470

解决方案：我放弃了我的“单一服务器”（即现有的 Tomcat 服务器）方法并安装了 Apache。自然，Bugzilla 在 Apache 下工作起来更容易。那里没有真正的惊喜。

我的结论是：

1.  Apache 从 cgi-bin 目录下提供图像文件没有问题。

2.  Bugzilla 开发人员似乎并不认为将图像文件目录与应用程序脚本放在一起是不好的。

3.  Tomcat 对 cgi-bin 的支持不如 Apache 丰富/广泛。

4.  我最初的问题的答案是：不能在 Tomcat 6 中完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-10T15:42:50.897

好的，我已经写了一个关于在 Apache Tomcat 6（在 Ubuntu 10.04 + MysSQL 上）上安装 Bugzilla 的简短方法。

我在玩 BZ 实例，它似乎运行正常。

[http://blog.inmite.eu/2010/08/installing-bugzilla-on-the-apache-tomcat-6/](http://blog.inmite.eu/2010/08/installing-bugzilla-on-the-apache-tomcat-6/)

祝你好运！

petr@inmite[dot]eu

# wcf - StackOverflowException 序列化 .netTiers 实体

> ID：361701
> 
> 赞同：1
> 
> 时间：2008-12-12T02:16:18.257
> 
> 标签：wcf, stack-overflow, .nettiers

我有一个简单的 WCF 服务：

```
public Order[] GetOrdersByStatus(int statusid)
{
    OrderService os = new OrderService();
    TList<Order> orders = os.GetByOrderStateID(statusid);

    return orders.ToArray();
} 
```

当它返回时，它会在 mscorlib 中引发 StackOverflowException。知道是什么原因造成的吗？

OrderService 是 NetTiers 生成的服务，而 Order 是 NetTiers 实体对象。当我返回时，数据已经从数据库中提取并准备好了。在我从操作返回后，除了 WCF 中的错误之外，还有什么可能导致 StackOverflowException？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T02:27:00.903

如果“订单”类型的序列化实现不好，可能就是这样。

# asp.net-mvc - ASP.NET、Ninject 和 MVC：性能负载问题

> ID：361705
> 
> 赞同：1
> 
> 时间：2008-12-12T02:22:01.303
> 
> 标签：asp.net-mvc, nhibernate, fluent-nhibernate, ninject

问题描述：该模型一次只适用于一个用户。一旦我一次获得多个用户，我就会遇到与未关闭 SqlDataReader 有关的严重错误。当我像这样关闭延迟加载时：

persistenceModel.Conventions.OneToManyConvention = (prop => prop.SetAttribute("lazy", "false"));

很好，但性能很慢。这使用 MVC Beta 1

有什么想法吗？

下面是我的全局 ASAX 的片段以及我的 SessionFactory 初始化代码。

*********** 这是我的 GLOBAL.ASAX ********

```
public class MvcApplication : NinjectHttpApplication
{
    public static IKernel Kernel { get; set; }

    protected override void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
        //routes.IgnoreRoute("WebServices/*.asmx");

        routes.MapRoute("CreateCategoryJson", "Admin/CreateCategoryJson/{categoryName}");
        routes.MapRoute("User", "Admin/User/{username}", new { controller="Admin", action="user" });

        routes.MapRoute(
            "Default",                                              // Route name
            "{controller}/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        );

    }

    protected void Session_Start(object sender, EventArgs e)
    {
        if (Session["rSkillsContext"] == null)
        {
            string logonName = this.User.Identity.Name.Replace("NUSOFTCORP\\", string.Empty);
            rSkillsContext context = new rSkillsContext(logonName);
            Session.Add("rSkillsContext", context);
        }
    }

    protected override IKernel CreateKernel()
    {
        log4net.Config.XmlConfigurator.Configure();
        Kernel = new StandardKernel(new RepositoryModule(), new AutoControllerModule(Assembly.GetExecutingAssembly()), new Log4netModule());
        return Kernel;
    }
} 
```

***** 这是我的 NHibernateHelper.cs ******

```
 private ISessionFactory CreateSessionFactory()
    {
        var configuration = MsSqlConfiguration
                                .MsSql2005
                                .ConnectionString.FromConnectionStringWithKey("ConnectionString")
                                .ShowSql()
                                .Raw("current_session_context_class", "web")
                                .ConfigureProperties(new Configuration());

        var persistenceModel = new PersistenceModel();

        persistenceModel.Conventions.GetForeignKeyName = (prop => prop.Name + "ID");
        persistenceModel.Conventions.GetForeignKeyNameOfParent = (prop => prop.Name + "ID");
        // HACK: changed lazy loading
        persistenceModel.Conventions.OneToManyConvention = (prop => prop.SetAttribute("lazy", "false"));

        persistenceModel.addMappingsFromAssembly(Assembly.Load(Assembly.GetExecutingAssembly().FullName));
        persistenceModel.Configure(configuration);

        return configuration.BuildSessionFactory();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T10:26:39.013

看起来你没有正确处理你的会话（一个月前我在 Ninject 和 NHibernate 上遇到了同样的错误）。它应该在请求开始时开始，并应在结束时处理。您能否提供开始和处理您的休眠会话的代码片段？

# asp.net - ASP.NET 的垃圾邮件过滤器？

> ID：361707
> 
> 赞同：4
> 
> 时间：2008-12-12T02:24:01.910
> 
> 标签：asp.net

我正在寻找可以集成到我的 ASP.NET 应用程序中的垃圾邮件过滤器。我不想要任何委托服务（例如 Akismet），因为我正在为一个高流量的网站做这件事，有什么建议吗？

编辑：我的意思是垃圾邮件过滤器，它是一个基于论坛的网站。

编辑：感谢您的回答，但我不是在寻找验证码，我在寻找垃圾邮件过滤器，验证码不是用于防止自动垃圾邮件的垃圾邮件过滤器，但它本身不是垃圾邮件过滤器，垃圾邮件过滤器是一款扫描帖子并将其标记为垃圾邮件的软件。实际上，我的应用程序中已经有一个验证码，用于防止自动垃圾邮件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T15:04:21.777

您可以查看[nBayes ，这是](http://codecube.net/2009/05/bayesian-filtering-with-c/)[Paul Graham 的垃圾邮件计划](http://www.paulgraham.com/spam.html)的 C# 实现

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T03:03:18.600

如果您不想使用 CAPTCHA，因为它们会惹恼人们，并且您的网站已经启动并运行，您可以编写自己的解析器来过滤垃圾邮件。您看到的大多数垃圾邮件都是极其明目张胆的。在帖子中发布数百个链接。主题、正文和海报名称都完全相同。其他类似的东西。您可以编写一些简单的过滤器，就像我为我的博客所做的那样，基本上可以删除 99% 的垃圾邮件，而您的用户甚至没有意识到您甚至在使用过滤器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T04:36:58.880

我使用[Akismet](http://akismet.com/)进行垃圾邮件过滤。CodePlex 上有一个可用的 .NET 接口[。](http://www.codeplex.com/AkismetApi)

它工作得很好，而且 Api 非常简单。Akismet 是免费供个人使用的（每月不到 500 美元），所以如果你在网站上赚了一些大钱，我不确定定价。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T04:26:04.580

虽然没有被广泛使用，但由于评论/论坛帖子通常存储在数据库中，插入触发器的效果非常好，它在评论中查找某些单词并自动触发删除。同样，这不是一个理想的解决方案，但它对我有用。有可能删除合法帖子，但话又说回来，有时几乎不可能正确破译验证码......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T05:48:08.720

我不能推荐这个，因为我从来没有使用过它，但我知道一家小公司在Jason Kester[的 A Naive Bayesian Spam Filter for C#上运气不错。](http://www.codeproject.com/KB/recipes/BayesianCS.aspx)

不过，我个人建议使用像 Akismet 这样的第 3 方。垃圾邮件过滤是一项艰巨的任务，最好将其委托给能够并且将随着时间的推移跟上垃圾邮件发送者技术的人。

# jquery - 在jQuery中选择当前元素

> ID：361717
> 
> 赞同：42
> 
> 时间：2008-12-12T02:33:18.147
> 
> 标签：jquery

我有这样的 HTML 代码：

```
<div>
       <a>Link A1</a>
       <a>Link A2</a>
       <a>Link A3</a>
</div>

<div>
       <a>Link B1</a>
       <a>Link B2</a>
       <a>Link B3</a>
</div> 
```

当用户单击 HTML 上方的链接时，我想获取相应`<a>`元素的 jQuery 对象，然后操作其兄弟。`<a>`除了为每个元素创建一个 ID 并将该 ID 传递给 onclick 事件处理程序之外，我想不出任何方法。我真的不想使用ID。

有什么建议么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-12-12T02:39:02.970

幸运的是，jQuery 选择器让你有更多的自由：

```
$("div a").click( function(event)
{
   var clicked = $(this); // jQuery wrapper for clicked element
   // ... click-specific code goes here ...
}); 
```

...将指定的回调附加`<a>`到`<div>`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-12T02:42:12.607

当 jQuery click 事件调用您的事件处理程序时，它会将“this”设置为被点击的对象。要将其转换为 jQuery 对象，只需将其传递给 "$" 函数：`$(this)`. 因此，例如，要获取下一个同级元素，您可以在 click 处理程序中执行此操作：

```
var nextSibling = $(this).next(); 
```

**编辑：**阅读凯文的评论后，我意识到我可能弄错了你想要的东西。如果你想按照他的要求做，即在另一个div中选择相应的链接，你可以用它`$(this).index()`来获取点击链接的位置。然后，您将通过其位置选择另一个 div 中的链接，例如使用“eq”方法。

```
var $clicked = $(this);
var linkIndex = $clicked.index();
$clicked.parent().next().children().eq(linkIndex); 
```

如果您希望能够双向使用，您将需要某种方式来确定您所在的 div，以便您知道在“parent()”之后是否需要“next()”或“prev()”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-17T11:39:42.367

您会发现[兄弟姐妹()](http://docs.jquery.com/Traversing/siblings)和[parent()](http://docs.jquery.com/Traversing/parent)方法在这里很有用。

```
// assuming A1 is clicked
$('div a').click(function(e) {
    $(this); // A1
    $(this).parent(); // the div containing A1
    $(this).siblings(); // A2 and A3
}); 
```

将这些方法与[andSelf()](http://docs.jquery.com/Traversing/andSelf)结合起来可以让您操作您想要的这些元素的任意组合。

编辑：马克留下的关于 Shog9 答案的事件委托的评论非常好。在 jQuery 中完成此任务的最简单方法是使用[live()](http://docs.jquery.com/Events/live)方法。

```
// assuming A1 is clicked
$('div a').live('click', function(e) {
    $(this); // A1
    $(this).parent(); // the div containing A1
    $(this).siblings(); // A2 and A3
}); 
```

我认为它实际上将事件绑定到根元素，但效果是一样的。它不仅更灵活，而且在很多情况下也提高了性能。请务必阅读文档以避免任何陷阱。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-16T08:03:31.790

我认为通过将**.children()**与**$(this)**结合将仅返回所选项目的子项

考虑以下：

```
$("div li").click(function() {
$(this).children().css('background','red');
}); 
```

这将仅更改单击的 li 的背景

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T16:26:55.037

要选择兄弟姐妹，您需要以下内容：

```
$(this).next(); 
```

所以，Shog9 的评论是不正确的。首先，您需要在 div click 函数之外将变量命名为“clicked”，否则在单击发生后它会丢失。

```
var clicked;

$("div a").click(function(){
   clicked = $(this).next();
   // Do what you need to do to the newly defined click here
});

// But you can also access the "clicked" element here 
```

# java - ArrayLists 和读取文件的问题

> ID：361723
> 
> 赞同：0
> 
> 时间：2008-12-12T02:38:24.517
> 
> 标签：java, arraylist

我对以下方法有困难。我不知道我的问题是否存在，但我已将其范围缩小到不从文件中填充数组列表。任何帮助是极大的赞赏。

```
private void searchButtonActionPerformed(java.awt.event.ActionEvent evt) {

//create arraylists
ArrayList<String> model = new ArrayList<String>();
ArrayList<String> length = new ArrayList<String>();
ArrayList<String> width = new ArrayList<String>();
ArrayList<String> radius = new ArrayList<String>();
ArrayList<String> depth = new ArrayList<String>();
ArrayList<String> volume = new ArrayList<String>();
ArrayList<String> shape = new ArrayList<String>();

//fill arraylists from file
try {
    String outputline = "";

    BufferedReader fin = new BufferedReader(new FileReader("stock.dat"));
    while((outputline = fin.readLine()) != null)    {
       // for(int i = 0; i < outputline.length(); i++)    {
       int i = 0;

            //model
            boolean flag = false;
            String pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',')
                    pass.concat(Character.toString(outputline.charAt(i)));

                else
                    flag = true;
                i++;
            }
            model.add(pass);

            //length
            flag = false;
            pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',') 
                    pass.concat(Character.toString(outputline.charAt(i)));
                else
                    flag = true;
            }
            length.add(pass);

            //width
            flag = false;
            pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',') 
                    pass.concat(Character.toString(outputline.charAt(i)));
                else
                    flag = true;
            }
            width.add(pass);

            //radius
            flag = false;
            pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',') 
                    pass.concat(Character.toString(outputline.charAt(i)));
                else
                    flag = true;
            }
            radius.add(pass);

            //depth
            flag = false;
            pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',') 
                    pass.concat(Character.toString(outputline.charAt(i)));
                else
                    flag = true;
            }
            depth.add(pass);

            //volume
            flag = false;
            pass = "";
            while(flag = false) {
                if(outputline.charAt(i) != ',') 
                    pass.concat(Character.toString(outputline.charAt(i)));
                else
                    flag = true;
            }
            volume.add(pass);

            //shape
            pass = "";
            for(int j = i; j < outputline.length(); j++)
                pass.concat(Character.toString(outputline.charAt(i)));
            shape.add(pass);
        }
    fin.close();
    }
catch(IOException e)    {
    System.err.print("Unable to read from file");
    System.exit(-1);

}

int at = -1;
for(int i = 0; i < model.size(); i++)   {
    if(model.get(i).equals(searchIn.getText())) {
        at = i;
        i = model.size();
    }
}
    Component frame = null;

if(at != -1)    {
    searchDepthOut.setText(depth.get(at));
    searchLengthOut.setText(length.get(at));
    searchRadiusOut.setText(radius.get(at));
    searchVolumeOut.setText(volume.get(at));
    searchWidthOut.setText(width.get(at));

}
else
    JOptionPane.showMessageDialog(null, "Your search did not return any results", "ERORR", JOptionPane.ERROR_MESSAGE); 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T03:10:23.267

用逗号分隔 readline 并完成它。我还将为模型、长度、宽度等创建一个对象......然后拥有该对象的 1 个数组列表。

```
while((outputline = fin.readLine()) != null)    {

    String[] tokens = outputline.split(",");
    if(tokens.length == 7){
        SObj o = new SObj; //Some Object

        o.model = tokens[0];
        o.length = tokens[1];
        //and so on

        oList.add(o);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T03:06:02.573

除了人们列出的所有其他问题......

```
String pass = "";
while(flag = false) {
if(outputline.charAt(i) != ',')
   pass.concat(Character.toString(outputline.charAt(i))); 
```

pass 是一个字符串。字符串是不可变的。你要

```
 pass = pass.concat(.....) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T03:10:36.590

`while(flag = false)`永远不会运行 - 它总是评估为`false`. 尝试`while (!flag)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T03:15:13.770

我建议你重构代码。问题不仅在于存在某种解析器错误，而且很难判断发生了什么 - 代码显然对输入行的结构做出了假设，但您必须通读并跟踪在你的脑海中重构它的方法。

就像是

```
/** Expect a line of the form model, length, ...,
  return a list of ... 
*/
private String[] parse (String inputLine)
{
  //check input line charachteristics-not null, length, ...
  String out=  inputLine.split(",");
  if (out.length()!= ... 
  //whatever sanity checking...

}

private List<String[]> extract(BufferedReader fin)
{
  while((outputline = fin.readLine()) != null) 
 {
    //do something with parse(outputline);
  }
} 
```

有用的是将文件读取和行解析分开，这样您就可以看到发生了什么问题，而不是按顺序进行所有操作，这很可能是对隐藏在代码中的行结构的假设。它需要 4 个逗号分隔的整数吗？5? 如果他们用空格填充呢？以空行为前缀？

# c++ - VS2008 二进制比 VS2005 慢 3 倍？

> ID：361730
> 
> 赞同：7
> 
> 时间：2008-12-12T02:45:24.300
> 
> 标签：c++, visual-studio-2008, performance, optimization, visual-studio-2005

我刚刚将一个本地 C++ 项目从 VS2005-SP1 升级到 VS2008-SP1
我测试的第一件事是对应用程序进行非常基本的功能测试，我注意到的第一件事是主要的数字运算算法在VS2008 二进制文件。
我再次测试了 VS2005 二进制文件以确保没有任何其他差异并且它仍然像以前一样执行。
有没有人偶然发现这个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T03:18:47.163

最奇怪的。事物。曾经。

似乎 vs2008 的项目升级向导根本没有复制 ' `Optimization="2"`' 属性，因此新项目在发布时没有进行任何优化。

修复方法是转到属性对话框，将优化更改为 1，然后再改回 2。再次编译，一切正常。

我在 MSDN 论坛中找不到任何官方参考资料，只有[这个晦涩的参考资料。](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/fb32033b-7bad-439b-a94c-943a17f0cbb2/)

# c# - 在 asp.net 中带有 URL 的魔术 - 3.5

> ID：361731
> 
> 赞同：1
> 
> 时间：2008-12-12T02:45:58.790
> 
> 标签：c#, asp.net, image, response.redirect

这是我的困境：

我的网站在 asp.net 3.5 中完成。我有按钮，如果用户点击应该显示图像。图像位于第三方，可通过 Web url 访问。所以我的应用程序必须登录到这个第三方应用程序，他们会返回一个 url 给我，然后我应该在我的网站上做一个 response.redirect 并显示用户图像

将其视为拥有自己的网页。你想从雅虎显示图像，你需要登录到雅虎，你所拥有的只是一个网址，并且知道它需要用户名/密码作为表单元素，或者你可以做 yahoo.com?username=blah&pwd=doe

这通常会将您带到您的 yahoo 主页，并且登录调用还会返回您在 asp.net 应用程序中使用的随机文件路径并执行魔术，以便您的网页现在重定向到 yahoo.com/username/ randomfilepath，它基本上是图像的缩略图页面。

我尝试过执行此 webrequest，然后在收到响应后执行 response.redirect，但那是一个阻碍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T03:35:52.183

您可能想考虑在 IFrame 内执行此操作。我做了一些 facebook 工作，需要用户登录到他们的 facebook 帐户。然后 facebook 在我指定的 url 返回到我的页面。

我所做的是创建一个 IFrame，然后使用 JQuery Dialog 插件显示 iframe，将该 iframe 回发到 FinishedLoggingIn.aspx 页面，然后从该页面调用 window.top.someJavascriptToDisplayImages(someJsonWithImages);

# dll - 替代 DLL 作为对象（动态可替换对象）

> ID：361735
> 
> 赞同：0
> 
> 时间：2008-12-12T02:54:13.547
> 
> 标签：dll, dynamic, object

我有一个应用程序，它使用许多不同的 .NET 托管 DLL 作为对象（每个 DLL 实现一个公共接口）。每个 DLL 在文件名中也有一个版本号。

假设我创建了对象“Shape~01.dll”。应用程序将使用该 DLL，但在应用程序运行时无法替换它。因此，如果我想“升级”形状 dll，我必须创建“Shape~02.dll”，并且应用程序必须在每次创建形状时动态搜索并加载最新的 dll 和/或用户必须重新启动应用。更糟糕的是，每个 dll 都依赖于主 .exe，因此必须使用主 .exe 重新构建。

有没有更简单的方法来动态“替换”对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T02:57:10.423

好吧，这不是最好的解决方案（仍在考虑中），但是您可以卸载 dll 文件，这将允许它们被替换。在你想出一个更好的主意之前，这可能是一个快速的权宜之计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T03:12:15.150

您没有提及您尝试使用哪种语言/平台来完成此操作，因此我将回答 .NET Framework。

如果您想以艰难的方式执行此操作，请查看 Shadow Assemblies，这是 ASP.NET 用来保持站点可更新的方法，尽管它正在使用文件。

对于更简单的方法，请查看新的[System.Addin](http://msdn.microsoft.com/en-us/library/system.addin.aspx)命名空间，它在后台使用 Shadow Assemblies，并且应该做你想做的事。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-12T03:13:00.763

与其在创建对象时轮询，不如在文件系统发生变化时向系统请求通知？

该类是.NET 中的[System.IO.FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)。

对于本机代码，有几种方法可以查看文件夹，但 IANAND（我不是本机开发人员；）。

尽管说了这些话，但您可能想重新考虑需要如此频繁地更改对象的原因，因为要使其正常工作可能需要大量工作。

您使用了动态标签，所以也许您应该尝试使用动态语言？:)

# mysql - 获取最后一个 MySQL 二进制日志条目

> ID：361740
> 
> 赞同：3
> 
> 时间：2008-12-12T02:56:55.523
> 
> 标签：mysql

我正在使用 MySQL 复制，我希望在从站上运行一个状态脚本来报告复制到从站的最后一条语句。

我可以使用“SHOW SLAVE STATUS”来获取当前的读取和执行位置。但是我如何使用 mysqlbinlog 的信息来读取最后一个条目？假设从服务器赶上了主服务器，下面的语句没有返回任何有用的信息：

```
mysqlbinlog.exe -R --start-position=<READ_MASTER_LOG_POS> <MASTER_LOG_FILE> -h <MASTER_HOST> 
```

我似乎无法从日志位置减去一个来获得前一个语句，而且我看不到任何方法可以给出负偏移量​​的含义，以便以相反的顺序从末尾读取。有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-28T10:17:35.217

您是在发送到从站的最后一条语句之后，还是在从站上执行的最后一条语句之后？您提到您假设从站赶上了主站，在这种情况下，您只需阅读中继日志中的最后一条语句，并在 SHOW SLAVE STATUS 中提供信息：

```
mysqlbinlog.exe --start-position=<RELAY_LOG_POS> <RELAY_LOG_FILE> 
```

# c# - 这对多态性来说是一个很好的例子吗

> ID：361742
> 
> 赞同：0
> 
> 时间：2008-12-12T02:57:06.333
> 
> 标签：c#, .net, polymorphism

抱歉，如果这是一个非常基本的问题，但我正在努力解决我应该如何解决这个问题。我正在尝试为 OLE 对象包装一些命令，基本规范如下所示：

```
Set Window window_id
    //Units is part of the position setter.
    [ Position ( x, y ) [ Units paper_units ] ] 
    [ Width win_width [ Units paper_units ] ] 
    [ Height win_height [ Units paper_units ] ]
    ..... this goes on for about 20+ commands, all optional. 
```

[] 之间的任何内容都是可选的。

所以我需要创建一个类，让我们称之为“ **CommandBuilder** ”，它可以为所有这些可选的设置器设置方法，我可以处理它，我遇到的主要问题是需要输出一个字符串的 ToCommandString 方法看起来像：

```
Set Window 1 Position (x,y) Units "m" Height 100 Units "m" + what ever else the user added 
```

当设置的变量并不复杂或只有几个变量但存在大量变量和/或嵌套值也是可选的时，只需根据设置的变量执行一些 if 并加入字符串即可，如果有任何变化，它会使 ToString 方法变得非常长和复杂 + 难以维护。

我想知道是否可以通过使用多态性来解决这个问题。

```
interface ICommand
{
    string ToCommandString();
}

class PositionCommand : ICommand
{
    double X;
    double Y;
    string Units;

    public PositionCommand(double x, double y)
    {
        this.X = x;
        this.Y = y;
    }

    public PositionCommand(double x,double y, string units)
    {
        this.X = x;
        this.Y = y;
        this.Units = units;
    }

    public string ToCommandString()
    {
        //Add more stuff here to handle empty units.
        return String.Format(" Postion ({0},{1})", X.ToString(), Y.ToString());
    }
}
....more command classes. 
```

然后我在“ **CommandBuilder** ”中设置的所有方法都可以创建正确的命令类型并将其添加到列表中，然后“ **CommandBuilder** ”方法中的主ToString可以循环遍历所有已设置并调用ToCommandString，无需担心做任何 if 语句或空检查。

这是解决这个问题的正确方法吗？

PS如果您需要更多信息，我很乐意补充，只是不想让它先走太久。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T03:07:59.323

这对我来说听起来很合理。我肯定会将 ICommand 实例的构造保留在 CommandBuilder 内部：

```
class CommandBuilder
{
  private List<ICommand> _commands = new List<ICommand>();

  public CommandBuilder Position(double x, double y)
  {
    _commands.Add(new PositionCommand(x,y))
    return this;
  }

  ...
} 
```

而不仅仅是

```
class CommandBuilder
{
  public void AddCommand(ICommand cmd)
  { ... }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T03:04:10.830

是的。我认为你把它覆盖得很好。

# sql - SQL 中的“@”符号有什么作用？

> ID：361747
> 
> 赞同：86
> 
> 时间：2008-12-12T03:02:55.370
> 
> 标签：sql

我浏览了这些问题并注意到了这一点：

```
SELECT prodid, issue
FROM Sales 
WHERE custid = @custid 
AND datesold = SELECT MAX(datesold) 
             FROM Sales s 
             WHERE s.prodid = Sales.prodid
                  AND s.issue = Sales.issue
                  AND s.custid = @custid 
```

我想知道 custID 前面的“@”是做什么的？它只是从被选择的表中引用 custID 的一种方式吗？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-12-12T03:05:13.963

@CustID 表示它是您稍后将在代码中提供值的参数。这是防止 SQL 注入的最佳方法。使用参数创建查询，而不是连接字符串和变量。数据库引擎将参数值放到占位符所在的位置，SQL注入的几率为零。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-12-12T03:04:14.167

@ 用作表示存储过程和函数参数名称以及变量名称的前缀

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T03:07:35.363

你可能习惯了 MySQL 的语法：Microsoft SQL`@`和 MySQL 的一样`?`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T03:05:23.730

它是您需要定义的参数。为了防止 SQL 注入，您应该将所有变量作为参数传递。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T05:24:25.570

您正在谈论的是编写参数化查询的方式。'@' 只是表示它是一个参数。您可以在执行过程中添加该参数的值

```
eg:
sqlcommand cmd = new sqlcommand(query,connection);
cmd.parameters.add("@custid","1");
sqldatareader dr = cmd.executequery(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-30T19:34:52.517

```
publish data where stoloc = 'AB143' 
|
[select prtnum where stoloc = @stoloc] 
```

这就是`@`工作原理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-26T06:28:37.943

`@`后跟一个数字是参数在函数中列出的顺序。

# jquery - Drupal 6 : CCK : Views2 : 你会用什么方法用图像代替视野

> ID：361750
> 
> 赞同：2
> 
> 时间：2008-12-12T03:04:11.593
> 
> 标签：jquery, drupal, drupal-views, cck

**背景：**客户 X 有一个基于 CCK 的内容类型 (vendorxxentry)，并且正在使用 Views2 在一个简单的表中生成所有 vendorxxentry 节点的列表。

vendorxxentry 中的一个字段称为“vendorxxattitude”，它显示为以下枚举的可能值之一：

*   快乐的
*   困
*   傻逼
*   脾气暴躁

客户 X 有四个与这些枚举值相对应的定制 16x16 图像。他想让它们显示在生成的视图中，因此用户不会在生成的视图中看到“快乐”，而是会在其位置看到图像 happy.png。客户 X 希望在不破坏对单个列进行排序的能力的情况下完成此操作，这可以在表输出模式下使用 Views2 完成。

**问题：**您会使用什么方法来用相关图像替换文本？假设应该只在一个或多个特定视图（例如，vendorxxsummary、vendorxxbyxxdate、vendorxxbyxxindustry）中替换图像，而不是在各个节点视图本身中替换图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T15:15:52.407

您可以将“心情”从简单的数据字段更改为分类词汇表，每种心情都是词汇表中的一个术语。然后使用[分类图像](http://drupal.org/project/taxonomy_image)模块以您喜欢的任何方式为每种情绪替换图像。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T10:32:09.523

我会使用很酷的新 Views 2 主题，而不是安装一个全新的模块来处理一个功能。只需确定要为哪个字段设置主题并创建一个具有适当名称的主题文件，然后从 Views 2 中包含的主题信息帮助程序中插入默认代码。然后，使用 switch 语句对输出进行适当的主题化。

如果他们决定添加一个字段，这对客户没有帮助，但是，您必须更新您的代码，但它的运行速度会比一个全新的模块快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T08:27:40.327

我想我会从编写某种 jquery 开始，它会找到所有带有这些单词的单元格并交换 Css 以移动/隐藏文本并将图像添加为背景图像。就像人们用来在标题中获取花哨字体的图像替换技术一样。如果你可以在不改变底层标记的情况下做到这一点，它不应该影响排序机制吗？

# perl - 如何将命令行参数传递给 Perl 程序？

> ID：361752
> 
> 赞同：140
> 
> 时间：2008-12-12T03:05:06.163
> 
> 标签：perl, command-line

我正在编写 Perl 脚本。如何将命令行参数传递给它？

例子：

```
script.pl "string1" "string2" 
```

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-12-12T03:15:02.460

取决于你想做什么。如果你想使用这两个参数作为输入文件，你可以把它们传入，然后用它`<>`来读取它们的内容。

如果它们具有不同的含义，您可以轻松地使用`GetOpt::Std`和`GetOpt::Long`处理它们。`GetOpt::Std`仅支持单字符开关并且`GetOpt::Long`更加灵活。来自[`GetOpt::Long`](http://perldoc.perl.org/Getopt/Long.html)：

```
use Getopt::Long;
my $data   = "file.dat";
my $length = 24;
my $verbose;
$result = GetOptions ("length=i" => \$length,    # numeric
                    "file=s"   => \$data,      # string
                    "verbose"  => \$verbose);  # flag 
```

或者，`@ARGV`是一个包含所有命令行参数的特殊变量。`$ARGV[0]`是第一个（即`"string1"`在您的情况下）并且`$ARGV[1]`是第二个参数。您不需要特殊的模块来访问`@ARGV`.

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-12-12T03:07:34.253

您可以按照自己的想法传递它们，然后在脚本中从数组中获取它们`@ARGV`。像这样：

```
my $numArgs = $#ARGV + 1;
print "thanks, you gave me $numArgs command-line arguments.\n";

foreach my $argnum (0 .. $#ARGV) {

   print "$ARGV[$argnum]\n";

} 
```

从[这里](http://www.devdaily.com/perl/edu/qanda/plqa00001.shtml)。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-12-12T03:14:42.757

```
foreach my $arg (@ARGV) {
    print $arg, "\n";
} 
```

将打印每个参数。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-04-02T21:32:28.013

或者，一种更性感的堕落方式......

`my ($src, $dest) = @ARGV;`

“假设”传递了两个值。额外的代码可以验证假设是安全的。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2012-04-17T12:03:55.583

另一个选择是使用 perl -s，例如：

```
#!/usr/bin/perl -s

print "value of -x: $x\n";
print "value of -name: $name\n"; 
```

然后这样称呼它：

```
% ./myprog -x -name=Jeff
value of -x: 1
value of -name: Jeff 
```

或查看[原文](http://www.perlmonks.org/?node_id=33287)了解更多详情：

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2013-06-18T12:22:13.333

您可以通过将特殊变量分配给变量列表来直接访问它们`@ARGV`。因此，例如：

```
( $st, $prod, $ar, $file, $chart, $e, $max, $flag ,$id) = @ARGV; 
```

perl tmp.pl 1 2 3 4 5

[![在此处输入图像描述](https://i.stack.imgur.com/cskEL.jpg)](https://i.stack.imgur.com/cskEL.jpg)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-12-12T06:18:01.937

如果参数是要从中读取的文件名，请使用菱形 (<>) 运算符获取其内容：

```
while (my $line = <>) {
  process_line($line);
} 
```

如果参数是选项/开关，请使用 GetOpt::Std 或 GetOpt::Long，如 slavy13.myopenid.com 所示。

如果它们是其他东西，您可以通过显式浏览 @ARGV 或使用以下`shift`命令来访问它们：

```
while (my $arg = shift) {
  print "Found argument $arg\n";
} 
```

`shift`（请注意，仅当您在所有`sub`s之外时，这样做才有效。在 a 内`sub`，它将检索传递给的参数列表，`sub`而不是传递给程序的参数列表。）

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-02-20T08:00:28.493

```
my $output_file;

if((scalar (@ARGV) == 2) && ($ARGV[0] eq "-i"))

{

$output_file= chomp($ARGV[1]) ;

} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-12T13:37:23.957

如果您只需要一些值，则可以使用 @ARGV 数组。但是，如果您正在寻找更强大的东西来进行一些命令行选项处理，您应该使用[Getopt::Long](http://perldoc.perl.org/Getopt/Long.html)。

# java - 紧循环不好吗？

> ID：361756
> 
> 赞同：6
> 
> 时间：2008-12-12T03:06:55.783
> 
> 标签：java

程序中的紧密循环不好吗？

我有一个应用程序，它有两个线程用于游戏物理模拟器。一个 updateGame 线程和一个渲染线程。渲染线程通过使线程休眠几毫秒（以实现我想要的帧速率）而受到限制，而 updateGame 线程（根据一些物理方程更新我在游戏中的对象位置）之前被 10 毫秒的睡眠限制.

然而，我最近取消了 updateGame 线程的限制，并且我的对象移动模拟似乎更加真实，因为我已经取消了 10 毫秒的睡眠。热循环是坏的还是有一个紧密的循环？

```
private class UpdateTask implements Runnable
{
    private long previousTime = System.currentTimeMillis();
    private long currentTime = previousTime;
    private long elapsedTime;

    public void run()
    {
        while(true)
        {
        currentTime = System.currentTimeMillis();
        elapsedTime = (currentTime - previousTime); // elapsed time in seconds

        updateGame(elapsedTime / 1000f);

            try {
                Thread.currentThread().sleep(1);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        previousTime = currentTime;
        }
    }
} 
```

在这个例子中，我只是睡了 1 毫秒（根据我对毫秒精度和睡眠功能如何工作的理解，这可能更像是 5-10 毫秒。如果我睡的时间超过这个时间，它就会开始影响我的碰撞检测和物理模型。

使用紧密的循环或 1ms 的循环睡眠是一种不好的做法吗？我还应该做些什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T03:26:57.913

我读了一篇关于有效执行物理计算循环的非常棒的文章：[修复你的时间步长！](http://gafferongames.com/game-physics/fix-your-timestep/)

当游戏运行时，这通常是用户关心的主要应用程序，因此紧密循环并不是什么大不了的事。尽管安排更新，您真正应该做的事情。您应该知道您的帧必须执行多长时间（以您的目标帧速率）。你应该测量你的帧所用的时间，并且只在你的帧所用的时间减去已知的帧时间后睡觉。这样，您的系统将锁定帧速率，并且不会随着帧渲染所需的时间而变化。

另一件事是我不相信 Thread.sleep 有很好的分辨率，远远超过 5 毫秒，您可能想寻找更准确的 Java 计时器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T03:11:59.567

只有当它对系统中的其他东西产生不利影响时，它才是“坏的”。与其休眠 1 毫秒，不如在需要更新的条件下阻塞，至少 1 毫秒。这样一来，您将始终至少睡 1 毫秒，如果无事可做，则可以睡更长的时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T03:22:55.923

正如亚当在他的回答中指出的那样，可能会对系统的性能产生不利影响。

我也尝试过以非常相似的方式制作游戏（在单独的线程上进行渲染和运动计算），我发现没有这种`Thread.sleep`方式会导致 Java 应用程序占用大量 CPU 时间。

要考虑的另一件事是系统计时器本身。正如您所提到的，虽然该`Thread.sleep`方法需要毫秒数来休眠，但该精度取决于（如 API 规范中所述）操作系统提供的计时器。对于基于 Windows NT 的操作系统，[计时器分辨率为 10 毫秒](http://technet.microsoft.com/en-us/sysinternals/bb897569.aspx)。（另见：[System.currentTimeMillis 与 System.nanoTime](https://stackoverflow.com/questions/351565/systemcurrenttimemillis-vs-systemnanotime)）

是的，确实`Thread.sleep`有可能会降低应用程序的性能，但如果不这样做可能会导致应用程序的系统利用率飙升。

我猜这个决定归结为应用程序是否应该占用系统利用率的很大一部分，或者表现得很好并与系统上运行的其他应用程序共享 CPU 时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T04:08:11.130

还要考虑笔记本电脑用户，连续运行一个紧密的循环会使 CPU 运行困难，这会消耗他们的电池（许多 Flash 游戏都犯了这个罪）。在决定是否限制循环时需要考虑的事项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T05:21:44.380

joshperry 的答案几乎是您想要的，但也有几种方法。如果您使用多个线程，则还必须处理锁定等问题。根据您的游戏架构，这可能/可能不是什么大问题。例如，你是否做了很多锁定，线程之间是否有很多消息传递等等。如果你是一个传统游戏，你通常有一个主循环 - 我有一个 CMD 对象队列（如果你愿意，可以运行，但可以也更像是本质上的事件总线）连续执行直到队列为空。然后线程一直等待，直到收到新的 cmd 在队列中的信号。对于大多数游戏来说，这通常就足够了。因此，问题就变成了如何/何时添加 cmd。我使用计时器/调度程序（还请注意有关 java 时间分辨率的注释）以所需的帧速率将 cmd 添加到主循环。这还具有对笔记本电脑等友好的优点。在启动时，您还可以对系统进行基准测试以查看它的运行速度，然后设置适当的帧速率（即从支持的基础开始，然后工作到最大值）。然后，每种类型的 cmd 都可以使用基准测试或使用用户指定的性能提示（即渲染细节的数量）（即，渲染场景 cmd / 事件查看性能设置的细节等）。（注意 - cmds 不必是可运行的，它们可以更像是带有在主线程上调用的侦听器的事件总线）。在启动时，您还可以对系统进行基准测试以查看它的运行速度，然后设置适当的帧速率（即从支持的基础开始，然后工作到最大值）。然后，每种类型的 cmd 都可以使用基准测试或使用用户指定的性能提示（即渲染细节的数量）（即，渲染场景 cmd / 事件查看性能设置的细节等）。（注意 - cmds 不必是可运行的，它们可以更像是带有在主线程上调用的侦听器的事件总线）。在启动时，您还可以对系统进行基准测试以查看它的运行速度，然后设置适当的帧速率（即从支持的基础开始，然后工作到最大值）。然后，每种类型的 cmd 都可以使用基准测试或使用用户指定的性能提示（即渲染细节的数量）（即，渲染场景 cmd / 事件查看性能设置的细节等）。（注意 - cmds 不必是可运行的，它们可以更像是带有在主线程上调用的侦听器的事件总线）。

此外，如果一个任务想要然后使用多线程/核心的 cmd 处理程序（如果它是一个事件类型模型 - 我个人喜欢事件模型 - 它更容易访问共享状态信息而不需要全局单例）然后可以产生多个任务（比如使用现有的线程池 - 因此新线程的成本不会影响每个 cmd），然后使用屏障类型类等待所有任务完成。这种方法通常使锁定更容易，因为每个 cmd（或系统）通常有不同的锁定要求。因此，您可以只为该系统实现锁定，而不必担心子系统之间的锁定 - 即。对于物理，您可以锁定游戏区域中的对象包，然后线程池中的每个分叉线程只关心它的对象，即。thread1 处理对象 1 到 20，

重要的是看看你如何以及为什么使用线程和锁定等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T03:30:07.203

对于游戏来说，可能不是。只要确保您的游戏在切换任务时暂停即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T04:05:52.017

在这种情况下，您实际上想使用[Thread.yield() 。](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#yield())一个线程可能会连续运行，而不允许任何其他线程有时间执行。在每次迭代结束时放置一个 yield 调用给调度程序一个提示，即是时候允许其他线程也运行了。

# css - IE6 底部的额外填充

> ID：361775
> 
> 赞同：5
> 
> 时间：2008-12-12T03:16:44.203
> 
> 标签：css, internet-explorer-6

我有一个通过 CSS 设置样式的 div 标签。我将填充设置为 10 像素（填充：10 像素），它在 Firefox 和 IE7 中就像我想要的那样工作，但在 IE6 中它在底部添加了额外的填充（我认为大约 2-3 像素）。有人知道这里发生了什么吗？

[更新]

我刚刚注意到这一点，我正在谈论的 div 标签有一个背景图像。当我删除背景图像时，底部的额外填充消失了。有任何想法吗？

[另一个更新，代码示例]

这是应用于我的 div 标签的 CSS：

```
.user-info{
    margin-top: 20px;
    margin-right: 20px;
    padding: 10px;
    background-image: url("../img/user_panel_bg.png");
    float:right;
    border: 1px #AAAAAA solid;
    font-size:12px;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T03:44:58.190

你的div里有图片吗？如果有图像，则 IE 6 中存在一个错误，该错误可能导致 div 内的空白区域在底部创建额外的填充

额外的填充显示为

```
<div>
<img src="myimage.jpg">
</div> 
```

当您将 HTML 更改为

```
<div><img src="myimage.jpg"></div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T03:37:16.737

我强烈建议您查看[positioniseverything.net](http://www.positioniseverything.net/explorer.html)站点及其对 IE 问题和解决方法的报道。看看 holly hack 部分——我相信你会在那里找到答案。

[编辑 - 添加] 在[这里](http://www.positioniseverything.net/explorer/threepxtest.html)查看 3px 问题、解释和修复

对于框设置和浏览器差异，[站点点框模型文章](http://reference.sitepoint.com/css/ie5boxmodel "盒子模型")也提供了一些很好的见解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T03:40:52.517

你试过隐藏你的`DIV`溢出吗？ `overflow:hidden;`

`display: inline;`编辑：如果您在谈论水平推动，您也可以尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T16:52:47.580

确保字体大小不会造成问题。即使容器元素内没有文本（例如可拉伸容器上的底盖），IE6 仍会将框的高度设置为不小于字体大小（即使设置了明确的高度）。

因此，例如，如果您有 HTML：

```
<div class="box">  
  <h1>Heading</h1>  
  <p>This is the main content.</p>  
  <div class="bottom"></div>  
</div> 
```

...你将需要这个 CSS：

```
<style type="text/css">
  .box {
    background: url(bg-middle.jpg) repeat-y;
  }
  .box h1 {
    background: url(bg-top.jpg) no-repeat;
  }
  .box .bottom {
    background: url(bg-image.jpg) no-repeat;  /* bottom cap image */
    height: 10px;                             /* height of your bg image */
    font-size: 1px;                           /* for IE6 */
  }
</style> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T03:44:46.207

潜在的“边距”或“边界”属性？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T04:07:58.517

您还可以查看[CSS 重置样式表](http://meyerweb.com/eric/tools/css/reset/)之类的内容，它可以让您设置默认值，这些默认值应该在浏览器中保持合理一致。

# jquery - 命名那个 JQuery：你知道用于创建这个小部件的确切的特定 jquery 插件吗？

> ID：361784
> 
> 赞同：-1
> 
> 时间：2008-12-12T03:22:38.437
> 
> 标签：jquery, widget

如果您查看以下链接：[New Hope 的新功能](http://www.enewhope.org/index2.php)

查看页面上标题为“New Hope 的新功能”的小部件，其中包含与 MARQUEE（我猜你会这么称呼它）相当的 Web2.0，并带有褪色的图像和“阅读更多”链接。

**问题：**您能确定用于生成此特定小部件的确切特定 JQuery 插件吗？页面上的其他内容不相关。我有一个时代的狗来辨别哪些插件是用来创建它的，它是单独的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T03:29:17.707

为什么不只看代码？[http://www.enewhope.org/assets/js/turnstile.js](http://www.enewhope.org/assets/js/turnstile.js)

它似乎主要是标准的 jQuery 效果动画调用。

[http://docs.jquery.com/Effects/animate](http://docs.jquery.com/Effects/animate)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-04T15:07:41.657

你可以在这里和这里找到它们：

*   [http://www.enewhope.org/assets/js/HomepageJSMinified.js](http://www.enewhope.org/assets/js/HomepageJSMinified.js)
*   [http://www.enewhope.org/assets/css/homepagejs.css](http://www.enewhope.org/assets/css/homepagejs.css)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T03:26:51.610

[JQuery Cycle Plugin](http://malsup.com/jquery/cycle/)可以做图像部分，我不知道文本的东西。

# .net - 笔记本电脑进入挂起模式时的.NET事件？

> ID：361798
> 
> 赞同：2
> 
> 时间：2008-12-12T03:31:59.087
> 
> 标签：.net

无论如何，有没有办法处理笔记本电脑何时进入挂起模式并在它实际进入挂起模式之前做一些事情？

我认为这并不容易/不可能，因为不建议电源管理尊重任何试图阻止其进入挂起模式的软件。

具体用途是让托盘应用程序在我合上笔记本电脑盖时通知fogbugz停止工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T03:35:32.577

[http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx)

# iphone - 无法打开项目...无法打开，因为无法解析项目文件

> ID：361799
> 
> 赞同：103
> 
> 时间：2008-12-12T03:32:35.157
> 
> 标签：iphone, xcode

我一直在努力创建一个 iPhone 应用程序。今天我的电池电量不足，我正在工作并不断保存我的源文件然后电源就坏了......

现在，当我重新插入我的计算机并且它的电源很好时，我尝试打开我的项目文件，但出现错误：

> 无法打开项目
> 
> Project ... 无法打开，因为无法解析项目文件。

有没有办法让人们知道我可以从中恢复？我尝试使用较旧的项目文件并重新插入它然后编译。它给了我一个时髦的错误，这可能是因为它没有找到它想要的所有文件......

如果可能的话，我真的不想从头开始重建我的项目。

* * *

### 编辑

好的，我在这个和一个稍微旧的项目文件之间做了一个比较，发现文件中有一些损坏。合并它们（好的和最新的部分）后，它现在可以工作了。

关于 SVN 的要点。我有一个，但是尝试将 XCode 与它同步时有些奇怪。我现在肯定会花更多时间在它上面...... ;-)

![在此处输入图像描述](https://i.stack.imgur.com/Up53v.png)

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2012-08-16T18:04:48.253

我遇到了这个问题，我的前辈告诉我一个解决方案，即：

右键单击您的`projectname.xcodeproj`文件，这里`projectname`将是您的项目的名称。现在右键单击后选择*Show Packages Contents*。之后`projectname.pbxproj`在文本编辑器中打开您的文件。现在搜索包含`<<<<<<< .mine`,`=======`和的行`>>>>>>> .r`。例如，在我的情况下，它看起来像这样

```
<<<<<<< .mine
    9ADAAC6A15DCEF6A0019ACA8 .... in Resources */,
=======
    52FD7F3D15DCEAEF009E9322 ... in Resources */,
>>>>>>> .r269 
```

现在删除那些`<<<<<<< .mine`,`=======`和`>>>>>>> .r`线，所以它看起来像这样

```
 9ADAAC6A15DCEF6A0019ACA8 /* BuyPriceBtn.png in Resources */,

    52FD7F3D15DCEAEF009E9322 /* discussionForm.zip in Resources */, 
```

现在保存并打开您的 Xcode 项目并构建它。一切都会好起来的。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2015-03-27T00:03:36.427

穆罕默德的回答非常有帮助（并帮助我解决了问题）。但是，在保留两个分支的更改时，仅删除 >>>>>>> ======= <<<<<<< 不足以解决 project.pbxproj 中的解析问题（对我而言）合并后。

我在 project.pbxproj 文件的 PBXGroup 部分（其开头由这样的块注释指示：/* Begin PBXGroup section */）发生了合并冲突。但是，我遇到的问题也可能出现在 project.pbxproj 文件的其他地方。

下面是我遇到的合并冲突的简化：

```
 <<<<<<< HEAD
          id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
    =======
          id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
    >>>>>>> branch name
            sourceTree = "<group>";
          }; 
```

当我删除合并冲突标记时，这就是我留下的：

```
 id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
          id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
            sourceTree = "<group>";
          }; 
```

通常，删除合并冲突标记将修复 project.pbxproj 文件中的解析问题并恢复工作空间的完整性。这次没有。

以下是我为解决该问题所做的工作：

```
 id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
            sourceTree = "<group>";
          };

          id = {
            isa = PBXGroup;
            children = (
                 id
            );
            name = "Your Group Name";
            sourceTree = "<group>";
          }; 
```

实际上，我必须在第一个 PBXGroup 的末尾添加 2 行。

您可以看到，如果我选择放弃来自 Head 或合并分支的更改，就不会有解析问题！但是，就我而言，我想保留从每个分支添加的两个组，仅删除合并标记是不够的；为了保持正确的格式，我不得不在 project.pbxproj 文件中添加额外的行。

因此，如果在您认为已解决所有合并冲突后遇到解析问题，您可能需要仔细查看 .pbxproj 并确保没有任何格式问题！

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-06-06T13:48:24.173

我得到了这个完全相同的错误，因为 Cordova 将允许您创建一个包含空格的项目，而 Xcode 不知道如何处理。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-02-25T12:30:28.567

我有类似的问题。

[![截图 1](https://i.stack.imgur.com/KN83B.png)](https://i.stack.imgur.com/KN83B.png)

以下是解决它的步骤：

1.  导航到您的`projectName.xcodeproj`.

    [![截图 2](https://i.stack.imgur.com/YPflF.png)](https://i.stack.imgur.com/YPflF.png)

2.  右键单击并选择“ `Show Package Contents`”。您将能够看到带有`.pbxproj`扩展名的文件列表。

    [![截图 3](https://i.stack.imgur.com/BQDz5.png)](https://i.stack.imgur.com/BQDz5.png)

3.  选择`project.pbxproj`。右键单击并使用“ `Text Edit`”打开此文件。

    [![截图 4](https://i.stack.imgur.com/MOgT1.png)](https://i.stack.imgur.com/MOgT1.png)

4.  您将能够看到`<<<<<< .mine`和。这些通常是从 SVN 获取更新时出现的冲突。删除这些并保存文件。`============``>>>>>>>>>> .r123`

    [![截图 5](https://i.stack.imgur.com/Nmgcg.png)](https://i.stack.imgur.com/Nmgcg.png)

    [![截图 6](https://i.stack.imgur.com/r1Hd5.png)](https://i.stack.imgur.com/r1Hd5.png)

5.  现在，您将能够*打开项目而不会出现任何错误消息*。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2014-02-07T12:59:12.740

Xcode项目文件的可视化分析并没有帮助我在合并后定位错误。在 Xcode 尝试解析文件时查看 syslog 后发现这样的行：

```
2/7/14 12:39:12.792 PM Xcode[9949]: CFPropertyListCreateFromXMLData(): Old-style plist parser: missing semicolon in dictionary on line 4426\. Parsing will be abandoned. Break on _CFPropertyListMissingSemicolon to debug. 
```

修复该项目后可以正常打开。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-06-01T14:56:34.473

分析项目文件的语法。在终端的项目中检查它：

`plutil -lint project.pbxproj`

这将显示来自解析器的错误。

**可能的问题**：一些项目为项目文件设置了git合并策略`union`。这在大多数情况下都有效，但如果失败，它将默默地杀死您的项目文件。此策略`.gitattributes`在您的存储库中的文件中定义。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-10-11T16:12:33.760

要遵循的步骤：- 1.导航到您的 projectName.xcodeproj 2.右键单击并选择“显示包内容”的文件夹。您将能够看到扩展名为 .pbxproj 的文件列表。3.选择project.pbxproj。右键单击并使用“文本编辑”打开此文件。4.您将能够看到<<<<<<, ============ 和>>>>>>>>>>。这些通常是从 Sourcetree/SVN/GITLAB 获取更新时出现的冲突。删除这些并保存文件。5.现在，您将能够打开项目而不会出现任何错误消息。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-03-22T13:12:01.167

我最近在尝试将我的分支与远程分支合并时遇到了同样的问题。但是，上述解决方案似乎都不适合我的问题。

我的分支或远程分支中的 project.pbxproj 文件之间没有合并冲突。但是，我的 projectName.xcodeproj 文件将拒绝打开，原因与问题中所示的相同。

我的解决方案是使用文本编辑器查看 project.pbxproj 并查找文件语法中是否存在任何异常（例如，额外的大括号）。与合并文件相比，我通过关注在旧文件中插入或删除的行来加快这个过程。经过仔细检查，我发现我的问题的原因是重复以下行：

```
xxxxxxxxxxxxx /* [CP] Check Pods Manifest.lock */ = { 
```

在我的合并文件中。这导致了一个未闭合的大括号和随之而来的无效 pbxproj 语法。删除上面的行解决了我的问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-01-23T13:28:39.940

我刚刚遇到了同样的问题。我一如既往地删除了 git 生成的字符串，但 Xcode 仍然拒绝打开 .xcodeproj 文件。但是一切都是正确的，没有丢失括号等。最后我尝试**退出 Xcode并在****Xcode 关闭**时打开项目..然后它工作了。我希望这可以帮助别人。

编辑：

要解决 .xcodeproj 文件中的冲突，您可以使用这个方便的脚本：

1.  在您的项目目录中创建空的 .sh 文件（例如 resolve_conflicts.sh ）
2.  这是脚本：

    projectfile= `find -d . -name 'project.pbxproj'` projectdir= `echo *.xcodeproj` projectfile="${projectdir}/project.pbxproj" tempfile="${projectdir}/project.pbxproj.out" savefile="${projectdir}/project.pbxproj.mergesave"

    猫$项目文件| grep -v "<<<<<<< 头" | grep -v "=======" | grep -v "^>>>>>>> " > $tempfile mv $tempfile $projectfile

3.  使用 sh 命令从终端运行它：sh resolve_conflicts.sh

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-24T18:25:52.340

Revert the project.pbxproj

svn revert --filename--

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-26T10:58:16.193

Goto PhoneGapTest>>platform 然后删除文件夹 ios 之后去终端然后输入： sudo phonegap build ios 之后你可以运行项目

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T04:01:46.733

听起来您将不得不在 Xcode 中创建一个新项目，进入旧目录，然后将所有源文件、nib 和资源拖到新项目的 Xcode 文件侧边栏中。花费的时间不会超过几分钟，除非您真的对自定义构建设置或目标做了很多工作。要么这样，要么恢复到源代码管理中的最后一次签入并手动添加从现在到那时更改的任何代码文件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T04:37:13.590

一旦你让事情恢复正常，你应该考虑使用 subversion 或 mercurial 之类的东西来进行备份和修订控制。请记住，电子并不总是去他们应该去的地方，尽早并经常备份！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-01T13:32:30.800

尝试在行之间找到 HEAD 和 _HEAD 并删除 project.pbxproj 中的这些词。在执行此操作之前备份此文件..

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-04-26T13:21:46.450

将您当前的项目文件夹名称和结帐模块更改为同一个项目。然后添加当前文件更改。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-07-03T18:08:12.283

只需检查 project.pbproject 文件并对项目文件的工作版本进行比较。

当您与此处发布的版本控制系统发生冲突时，通常会发生这种情况：[无法在 MAC iphone SDK 的 subversion 中解析用户文件](https://stackoverflow.com/questions/1496182/user-file-cannot-be-parsed-in-subversion-in-mac-iphone-sdk)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-24T07:42:40.317

根据我的经验，我需要为此采取多种策略：

一个-

1-从命令行使用 git merge 找出需要解析的文件

2-对这些文件适当使用 git add 或 git rm

3-使用git commit完成合并

B- 1-对于 .pbxproj 我删除了 <<<< ， >>>> 和 =====

2- 使用[https://github.com/Serchinastico/Kin](https://github.com/Serchinastico/Kin)查找合并错误，并使用 SnoopyProtocol 的回答我解决了这些问题

注意：在某一时刻，Kin 显示的唯一错误是：`ERROR: line 1197:40 mismatched input '1' expecting NON_QUOTED_STRING` 不需要修复 Xcode 项目即可打开

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-08-27T22:22:54.243

如果您曾经合并并且仍然遇到不知道它们是什么的问题，我的意思不是明显的差异标记

```
<<<<<
....
======
>>>>>> 
```

然后您可以使用[https://github.com/Karumi/Kin](https://github.com/Karumi/Kin)分析您的项目文件，安装并使用它

```
kin project.pbxproj 
```

它使不允许打开项目的额外错误更容易理解和解决（散列、组等）。

* * *

顺便说一句，这也可能会有所帮助，我以为我没有使用它尝试区分你的项目文件的 2 个版本[https://github.com/bloomberg/xcdiff](https://github.com/bloomberg/xcdiff)所以这会给你真正发生的事情。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-06T12:32:18.817

通过还原，您可以撤消拉取的代码。

如果您想撤消该拉取请求，只需将此命令放在项目路径上

-->`git merge --abort`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-08T10:23:17.473

如果您没有在 Text === 或 <<< 或 >>>> 中找到对我来说类似的问题，那么问题真的很简单也很有趣......我在 Xcode 中更改了 App 的名称，但在构建之前没有在 UnityProjectSettings 中更改它——这就是问题所在……

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2009-03-17T23:19:30.943

subversion 几乎每周都会在 svn up 后损坏我的项目文件。我试图弄清楚为什么它现在这样做并遇到了这个问题。

# svn - 如何更改颠覆存储库的结构？

> ID：361801
> 
> 赞同：10
> 
> 时间：2008-12-12T03:34:40.753
> 
> 标签：svn

我是 Subversion 的新手，所以如果这是一个愚蠢的问题，我现在不知道：

我继承了一个具有平面结构的颠覆存储库，没有 /trunk /tags /branches 顶层）。

我想重新构建它，使其遵循

```
/trunk
/tags
/branches 
```

布局。

这可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-12T15:58:00.727

特别是如果您使用的是 Subversion 1.4，请参阅此答案以获取替代方案：

[svn：用分支替换主干](https://stackoverflow.com/questions/331388/svn-replace-trunk-with-branch#331574)。

否则，`move`是最简单的实现重组的方法。正如@JoelFan 所说，`move`将在目录上工作，因此您可以在没有工作副本的情况下执行此操作：

```
svn mkdir --quiet --message "Restructuring" http://svnhost/svnrepos/trunk
svn mkdir --quiet --message "Restructuring" http://svnhost/svnrepos/tags
svn mkdir --quiet --message "Restructuring" http://svnhost/svnrepos/branches 
```

然后，`move`为您的来源提供适当的命令：

```
svn move --message "Restructuring" http://svnhost/svnrepos/dir01 http://svnhost/svnrepos/trunk/dir01 
```

注意：如果现有存储库具有如下结构：

```
/repos
    /projectA
        /branches
        /tags
        /trunk
    /projectB
        /branches
        /tags
        /trunk 
```

我建议以这种方式保留它 - 如果由于某种原因您需要这样做，它将使项目分成单独的存储库非常简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T03:54:37.717

svn move [(1.4)](http://svnbook.red-bean.com/en/1.4/svn.ref.svn.c.move.html) [(1.7)](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.move.html)可以对存储库中的目录进行操作，因此您不需要签出或签入任何内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-11T21:06:20.183

如果你使用 TortoiseSVN：

1.  创建空的所需目录 ( `/trunk /tags /branches`)
2.  提交他们。
3.  在上下文菜单 open`TortoiseSVN > Repo-Browser`中，只需选择所有（除了`/trunk /tags /branches`）并拖放到`/trunk`目录（全部在 Repo-Browser 窗口内）
4.  新闻`Ok > Submit > Ok`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T03:42:59.300

是的。只需制作所需的顶级结构，使用 svn add 添加这些目录。进行签入（svn ci），然后使用 svn move 将内容移动到所需的位置。中间的签到可能甚至没有必要，但我就是这样做的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T03:42:59.783

是的。只需使用 svn move 命令！

# diff - 什么工具可以对同一文件中的两个部分进行视觉比较？

> ID：361809
> 
> 赞同：8
> 
> 时间：2008-12-12T03:37:16.223
> 
> 标签：diff, file-comparison

好的文件比较工具已经被讨论过了，但我的问题更奇特。是否有任何可视化文本比较工具（如 WinMerge）可以让我轻松地对同一文件中的两个部分进行可视化比较？

我在 vcproj 文件中有多个配置，需要维护它们。手动执行此操作很痛苦——拆分窗口，逐个字符滚动。最重要的是，xml 非常冗长，并且占用了大量的屏幕空间。我不敢相信没有工具可以进行自动文件部分比较，因为这听起来是一个非常常见的问题。

请不要让我使用属性页，我不想要更复杂，我想要更少。手动拆分成文件然后比较它们也太中世纪了（反正我现在正在这样做）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T03:48:37.790

我使用[Beyond Compare](http://www.scootersoftware.com/)（不是免费的，但我认为有一个共享软件版本可用）。您可以为左右两侧选择相同的文件，然后右键单击每侧部分的开头并选择“手动对齐”。这将允许您比较容易地比较同一文件的两个部分。

总的来说，我强烈推荐该产品。我没有尝试过版本 3，这是他们目前在其网站上提供的版本，但版本 2 是一个很棒的工具。一个+

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-21T08:05:47.567

Emacs[埃迪夫](http://www.gnu.org/software/emacs/manual/html_mono/ediff.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T03:39:17.030

我的大部分文本编辑都使用 UltraEdit，他们有一个名为[UltraCompare](http://www.ultraedit.com/products/ultracompare.html)的产品，可以进行视觉比较。

* * *

**Mofi 更新**

UltraCompare Professional 除了支持整个文件之外，还支持比较文本片段。

启动 UltraCompare 后，如果尚未选择，请在菜单**模式中选择****文本比较。**在文本编辑器中选择要比较的第一个文本块，按 Ctrl+C，切换回 UC 并使用 Ctrl+V 将该块粘贴到左侧文本区域窗格中。再次切换到文本编辑器，选择同一文件中的另一个块，按 Ctrl+C，切换回 UC，单击右窗格并使用 Ctrl+V 粘贴该块。立即比较两个块并显示差异。

 **也可以直接从 UltraEdit 中开始对同一文件中的两个块进行此类文本片段比较。选择文件中的第一个块，按 Ctrl+C、Ctrl+N、Ctrl+V 和 Ctrl+A 复制、粘贴并在新文件中重新选择该块。选择文件中的第二个块。从UltraEdit 中的菜单**文件**执行命令**比较，并自动启用***比较选定文本*选项，然后单击按钮**比较**。UC Professional 仅使用 2 个选定的块进行比较。

 ****** * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-18T18:54:21.723

您可以使用 Meld 来执行此操作

1.  在不指定文件名的情况下打开融合
2.  提示您想要哪种类型的比较。选择文件比较
3.  Meld 将显示图标以选择文件名。在此之下，它将提示进行空白比较。选择那个。
    4.  在文件比较窗口中，粘贴要比较的文件部分。

# asp.net - 页面返回浏览器后触发的代码在哪里放置

> ID：361816
> 
> 赞同：1
> 
> 时间：2008-12-12T03:39:22.943
> 
> 标签：asp.net

我想在页面返回浏览器后发送一封电子邮件。我在哪里放置此发送电子邮件代码，以便它不会延迟返回到浏览器的页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T03:55:46.340

ASP.NET 页面有一个在内容返回到浏览器后触发的[卸载事件。](http://msdn.microsoft.com/en-us/library/ms178472.aspx)应该正是您正在寻找的。

# web-optimization - 在网页上混合安全和非安全内容——这是个好主意吗？

> ID：361829
> 
> 赞同：9
> 
> 时间：2008-12-12T03:46:48.513
> 
> 标签：web-optimization

我正在尝试想办法加快我的安全网站。因为有很多 CSS 图像需要加载，它会降低网站速度，因为浏览器不会将安全资源缓存到磁盘上，并且必须比实际需要更频繁地检索。

我正在考虑的一件事可能是将基于样式的图像和 javascript 库移动到非安全子域，以便浏览器可以缓存这些不构成安全风险的资源（渐变不是完全敏感的材料）。

我想看看其他人对做这样的事情有什么想法。这是一个可行的想法还是我应该以其他方式优化我的网站，比如使用 CSS sprite-maps 等来减少请求和带宽？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T03:51:47.643

浏览器（尤其是 IE）对此感到不安，并提醒用户页面上有混合内容。我们试过了，有几个用户打电话来质疑我们网站的安全性。我不会推荐它。让用户在使用您的网站时失去安全感是不值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T04:40:12.010

不要混合内容，没有什么比点击对话框上的“是”按钮更烦人的了。我希望 IE 能让我始终选择显示混合内容网站。正如克里斯所说，不要这样做。

如果您想优化您的网站，有很多方法，如果 SSL 是唯一剩下的方法，请购买硬件加速器....嗯，如果您使用 http 加载图像，如果使用 https 加载图像，它会被缓存吗？只是一个我需要去找出的附带问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T03:52:05.897

请注意，在 IE 7 中，在同一页面上混合安全和非安全项目存在问题，因此这可能会导致某些用户无法正确查看页面的所有内容。并不是说我支持 IE 7，但最近我不得不研究这个问题，而且处理起来很痛苦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-13T16:13:40.250

这是不可取的。浏览器在安全页面上给您带来不安全内容的麻烦的原因是它暴露了有关当前会话的信息并使您容易受到中间人攻击。如果唯一不安全的内容是图像，我承认第 3 方可能无法嗅探古老的信息，但 CSS 可以通过行为文件 (IE) 包含对 javascript/vbscript 的引用。如果您的 javascript 服务不安全，则无法采取任何措施来防止 rouge 脚本在不合时宜的时间抓取您的网页。

充其量，您可能能够通过 iframe 安全内容获得一种方法来保持外观和感觉。作为消费者，我真的不喜欢它，但作为 Web 开发人员，由于没有其他务实的选择，我以前不得不这样做。但是，坦率地说，*这**也*有很多***缺陷***.

从安全的角度来看，这不是一个好主意。

# php - 我可以为子类指定非严格的方法要求吗？

> ID：361832
> 
> 赞同：1
> 
> 时间：2008-12-12T03:47:59.150
> 
> 标签：php, oop, abstract-class

我有一个基类，我想在其中指定子类必须具有的方法，但不自己实现它们。但是，子类中的方法可能与基类中的定义具有不同数量的参数。

用抽象方法尝试过这个，php 不允许这样做。是否可以？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T10:27:48.843

子类的函数可以向签名添加额外的可选参数，而不会导致错误：

```
abstract class Foo {
  abstract function bar($a);
}

class NewFoo extends Foo {

  function bar($a, $b = null) {
    //do something
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T04:42:43.143

没有指定不带参数的抽象方法并要求子类方法通过 func_get_args 访问 args，我不明白这怎么可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T06:37:15.860

我想说这是 PHP 面向对象的弱点之一，它不是为处理这种用例而设计的。它只是不意味着允许其重载方法

确实有可能以上面提到的两种方式来做你所说的作为一种黑客行为：

```
func_get_args() 
```

或者，只是（就像提到的评论者一样）传入一个参数数组。或者，您可以传入一个将您的参数作为数据成员的对象。然后你可以为你的子方法扩展参数/参数对象。

关键是 PHP 是一种**以宽容而不是限制**为基础的语言。抽象类在 PHP 中有一个非常基本的实现。如果你需要很多这样的结构，那么 PHP 可能真的不是最好的语言选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T10:11:17.177

我不认为这是您想要在生产中使用的答案，因为它会相当慢，但只是为了它，我尝试使用 Reflection 编写一些东西，这似乎有效。你仍然会得到一个 E_STRICT 因为子类中的方法声明显然应该匹配。

```
class a {
    protected $requiredMethodsInSubclass = array( 'method1', 'method2', 'method3' );

    public function __construct() {
        $reflObject = new ReflectionObject($this);

        $className = $reflObject->getName();

        if ($className == __CLASS__) {
            //this class is being instanciated directly , so don't worry about any subclasses
            return;
        }

        foreach ($this->requiredMethodsInSubclass as $methodName) {
            try {
                $reflMethod = $reflObject->getMethod($methodName);
            } catch (ReflectionException $e) { //method not anywhere
                trigger_error("Method $methodName is not declared in class " . __CLASS__ . " or subclass $className", E_USER_ERROR);
                continue;
            }

            $declaringClass =  $reflMethod->getDeclaringClass();

            if ($declaringClass->getName() == __CLASS__) {
                //method is declared in this class, not subclass
               trigger_error("Method $methodName is not declared in subclass $className", E_USER_ERROR);
            }
        }
    }

    public function method1() {

    }

    public function method2($a) {

    }
 }

class b extends a {
    public function __construct() {
        parent::__construct();

        //some stuff
    }

    public function method2($a, $b, $c) {

    }

}

$b = new b(); 
```

# language-agnostic - 虚拟地址大小计算

> ID：361835
> 
> 赞同：0
> 
> 时间：2008-12-12T03:50:07.787
> 
> 标签：language-agnostic, hardware, paging

我被困在这个问题上，我正在为明天的考试而学习。（我了解虚拟地址与物理地址、页框、地址总线等的概念。）

> 如果您使用 4K 页面、128K RAM 和 32 位地址总线，那么虚拟地址可以有多大？您可以拥有多少个常规页框？

编辑：我相信答案是 2^32 和 2^20。我只是不知道如何计算这个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T04:09:50.167

你的答案完全正确。

使用 32 位地址总线，您可以访问 2^32 个唯一地址的虚拟空间。

每个 4K 页面使用 2^12 个（物理）地址，因此您可以将 (2^32) / (2^12) = 2^20 个页面放入空间中。

祝你考试顺利！

* * *

*编辑以解决评论中的问题：*

**你怎么知道你不能访问超过 2^32 个地址？**

32 位地址总线意味着有 32 根线连接到 RAM 上的地址引脚——每根线由一个位表示。根据相应位是 1 还是 0，每条线保持在高电压或低电压，并且由 32 位值（例如 0xFFFF0000）表示的 1 和 0 的每个特定组合选择相应的存储位置。使用 32 根线，地址引脚上有 2^32 种独特的电压组合，这意味着您可以访问 2^32 个位置。

**那么 4K 页面大小呢？**

如果系统的页面大小为 4K，则意味着每个页面中的 RAM 芯片有 12 个地址位（因为 2^12 = 4K）。如果您的假设系统有 128K 的 RAM，那么您需要 128K/4K = 32 页，或 RAM 芯片组。因此，您可以使用 12 位来选择每个芯片上的*物理*地址，方法是将相同的 12 根线路由到每个 RAM 芯片上的 12 个地址引脚。然后再用 5 根线来选择32 页中的*哪一*页包含您想要的地址。我们使用了 12 + 5 = 17 个地址位来访问 2^17 = 128K 的 RAM。

让我们进行最后一步，想象 128K 的 RAM 驻留在存储卡上。但是对于 32 位地址总线，您仍然有 32-17 = 15 个地址位！您可以使用*这些*位选择 2^15 = 32768 个内存卡中的一个，从而为您提供 2^32 = 4G RAM 的总虚拟地址空间。

**这在 RAM 和存储卡之外有用吗？**

通常的做法是将大量位（例如​​地址中的位）划分为更小的子组，以使它们更易于管理。有时它们会因为物理原因被分割，例如地址引脚和存储卡；其他时候是出于逻辑原因，例如 IP 地址和子网。美妙之处在于实现细节与最终用户无关。如果您访问地址为 0x48C7D3AB 的内存，那么您不必关心它位于哪个 RAM 芯片中，或者内存的排列方式，只要存在内存单元即可。当您浏览到 67.199.15.132 时，只要它接受您的支持，您就不会关心计算机是否在 C 类子网上。:-)

# user-interface - 有哪些很好的例子表明“我不是用户”？

> ID：361838
> 
> 赞同：16
> 
> 时间：2008-12-12T03:50:23.840
> 
> 标签：user-interface, usability, hci, ucd

我是一名具有可用性工程背景的软件开发人员。当我在研究生院学习可用性工程时，其中一位教授有一句口头禅：“你不是用户”。这个想法是，我们需要将 UI 设计基于实际的用户研究，而不是我们自己关于 UI 应该如何工作的想法。

从那时起，我看到了一些似乎证明我不是用户的好例子。

*   用户尝试使用电子邮件模板创作工具，但在尝试输入竖线 (|) 字符时遇到问题。问题原来是键盘上的管道中间有一个空间。
*   在 Web 应用程序中，用户看不到首屏下方的内容。常见的。我们告诉她向下滚动。她不知道我们在说什么，也不熟悉滚动拇指。
*   我正在接听技术支持电话。代表告诉用户关闭浏览器。在后台我听到 Windows 关机叮当声。

还有哪些其他好的例子？

编辑：为了澄清，我正在寻找开发人员做出假设的例子，这些假设对于用户将知道、理解的内容等结果是非常错误的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-12T05:15:28.287

我认为最大的例子之一是专家用户倾向于**使用应用程序**。

他们说，“好吧，我有这个工具，我能用它做什么？”

您的普通用户将操作系统、文件系统或应用程序的生态系统视为一个可怕的地方，他们很可能会迷失方向并且永远不会回来。

对他们来说，**他们想在计算机上做的一切都是基于任务的**。

*   “如何刻录 DVD？”
*   “我如何将相机中的照片上传到这个网站。”
*   “我怎么给妈妈发一首歌？”

他们想要一个起点，一个可重复的工作流程，并且他们希望在每次必须执行任务时都这样做。他们不关心简化流程或找到最好的方法，他们只想要一种可重复的方法来做到这一点。

在构建 Web 应用程序时，我早就学会了将应用程序的起始页与菜单分开，并使用基于任务的链接以非常大的字体指向应用程序所做的主要操作。对于普通用户来说，这极大地提高了可用性。

所以记住这一点：**用户不想“使用你的应用程序”，他们想完成一些特定的事情**。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-28T22:19:11.860

在我看来，“开发人员不是用户”最明显的例子是常见的**Confirmation Dialog**。

在大多数基于文档的应用程序中，从最复杂的（MS Word、Excel、Visual Studio）到最简单的（记事本、Crimson 编辑器、UltraEdit），当您关闭未保存更改的应用程序时，您会看到如下对话框：

> 无标题文件中的文本已更改。
> 是否要保存更改？
> [是] [否] [取消]

**假设**：用户将阅读对话
**现实**：平均阅读速度为每秒 2 个单词，这将需要 9 秒。许多用户根本不会阅读该对话框。
**观察**：许多开发人员的阅读速度比普通用户快得多

**假设**：可用的选项都是同样可能的。
**现实**：大多数 (>99%) 用户希望保存他们的更改。

**假设**：用户在点击选择之前会考虑后果
**现实**：选择的真正影响将在用户按下按钮后的瞬间发生。

**假设**：用户会关心正在显示的消息。
**现实**：用户专注于他们需要完成的下一个任务，而不是他们计算机的“照顾和喂养”。

**假设**：用户将理解对话框包含他们需要知道的关键信息。 **现实**：用户将对话框视为阻碍他们前进的障碍，只想以最快的方式摆脱它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-28T21:18:07.223

我绝对同意 Daniel 回复中粗体字的评论——大多数*真实*用户经常有一个他们想要达到的目标，并且只想尽可能轻松快速地达到这个目标。从经验来看，这不仅适用于计算机新手或非技术人员，也适用于可能不精通您的特定领域或技术堆栈的相当精通技术的用户。

我经常看到客户面临着一组丰富的技术、工具、实用程序、API 等，但没有明显的方法来完成他们的高级任务。有时这可以通过更好的文档（考虑全面的演练）来解决，有时可以通过一些基于命令行脚本/工具的高级向导来解决，有时只需对软件项目进行基本的重新优先级排序。

* * *

话虽如此......再举一个具体的例子，有Windows开始菜单（摘自[The Old New Thing博客上的一篇文章](http://blogs.msdn.com/oldnewthing/archive/2003/07/22/54559.aspx)）：

> 早在早期，任务栏没有开始按钮。
> 
> ...
> 
> 但是可用性测试不断引发一件事：人们启动计算机后只是坐在那里，不知道下一步该做什么。
> 
> 那时我们决定将系统按钮标记为“开始”。
> 
> 它说，“你这个笨蛋。点击这里。” 它让我们的可用性数字飙升，因为突然之间，人们知道当他们想做某事时该点击什么。

正如其他人在这里提到的那样，我们这些技术人员习惯于在环境中玩耍，点击可以点击的所有内容，在所有可用菜单中四处寻找等等。然而，我的家人害怕他们的电脑，更害怕他们点击会“擦除”他们的数据的东西，所以他们更愿意得到关于点击位置的明确指示。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T04:08:58.687

许多年前，在 CMS 中，我愚蠢地假设没有人会尝试创建一个名称中带有前导空格的目录....有人这样做了，并且让系统的许多其他部分非常非常难过。

另一方面，试图向我母亲解释单击“开始”按钮关闭计算机只是一个痛苦的世界。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T03:55:10.400

关于“杯架”（CD/ROM）损坏的用户的伪造技术支持电话怎么样？

实际上，让我印象深刻的是剪切/粘贴——我现在总是修剪我的文本输入，因为我的一些用户从电子邮件等中剪切/粘贴文本，最终选择了额外的空白。我的测试从未考虑过人们会“输入”额外的字符。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-28T21:22:31.367

今天的 GUI 在隐藏底层操作系统方面做得很好。但异质性仍然表现出来。

为什么 Mac 不允许我创建一个名为“照片：圣诞节 08”的文件夹？

为什么我必须“弹出”已安装的磁盘映像？

我不能仅通过更改文件扩展名将 JPEG 转换为 TIFF 吗？

（最后一个实际上在几年前发生在我身上。我花了很*长时间*才弄明白为什么 TIFF 没有正确加载！正是在那一刻，我明白了为什么 Apple 过去使用嵌入式文件类型（作为元数据）并且对此那天我不明白他们为什么愚蠢地回到文件扩展名。哦，对；因为 Unix 是一个优越的操作系统。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-28T22:33:27.057

我已经看过很多次了，这似乎总是会出现。我似乎是那种可以接受这些假设的人（在某些情况下），但我已经被用户多次做的事情所震撼。

正如我所说，这是我非常熟悉的东西。我开发的一些软件是为公众使用的（而不是经过专门培训的人），所以我们必须为这种事情做好准备。然而我看到它没有被考虑在内。

一个很好的例子是需要完成的网络表单。我们需要填写此表格，这对流程很重要。如果用户不填写表格，他们对我们没有好处，但我们从他们那里获得的信息越多越好。显然，这是两个相互矛盾的要求。如果只是向用户展示 150 个字段（随机大数字）的屏幕，他们会吓得跑掉。

为了改进这些表单已经多次修改，但没有询问用户他们想要什么。决策是根据不同人的假设或感受做出的，但没有考虑这些感受与实际客户的接近程度。

我还将提到 Bevan 的“用户将阅读对话”假设的推论。摆脱“用户什么都不读”的假设更有意义。然而，那些争辩说用户没有阅读任何内容的人通常会建议放置一些冗长的解释性文本，以帮助那些对一些随机糟糕的设计决策感到困惑的用户（比如使用复选框来表示应该是单选按钮的东西，因为你只能选择一）。

工作任何类型的技术支持都可以**非常有**用地了解用户如何（或不）思考。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T03:55:00.743

Linux 中几乎所有 O/S 级别的东西都是一个很好的例子，从名称的选择（“grep”对用户来说显然意味着“搜索”！）到语法的选择（“rm *”对你有好处！ )

[我不讨厌 linux，它只是塞满了 unix-legacy un-usability 示例]

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T04:01:03.460

桌面和壁纸的隐喻怎么样？它正在变得更好，但 5 到 10 年前是许多远程技术支持电话的祸根。

还有反斜杠与斜杠的问题，各种键盘符号的无数名称，以及过时的打印屏幕按钮。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T04:20:27.697

现代操作系统非常棒，因为它们都支持多个用户配置文件，因此在同一工作站上使用我的应用程序的每个人都可以拥有自己的设置和用户数据。只是，我收到的支持请求中有很大一部分是询问如何在同一个用户帐户下拥有多个数据文件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-12T04:36:15.183

回到我的大学时代，我曾经培训人们如何使用电脑和互联网。我会去他们家，设置他们的互联网服务，向他们展示电子邮件和一切。好吧，有这对老夫妇（60 年代末）。我花了大约三个小时向他们展示如何使用他们的电脑，确保他们可以连接到互联网和一切。我离开时感到非常高兴。

那个周末我接到一个疯狂的电话，说他们无法查看他们的电子邮件。现在我正在享受我的周末，但决定帮助他们，并走过所有的事情，30 分钟后，我问他们是否有两条电话线......“当然我们只有一条”不用说他们忘记了他们需要先连接到互联网（是的，这是在调制解调器时代）。

我想我应该有设置快捷方式，比如 DUN -> Check Email Step 1, Eduora - Check Email Step 2....

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-16T19:03:06.403

用户不知道的，他们会编造。他们经常使用关于应用程序如何工作的错误理论。

特别是对于数据输入，用户的输入速度往往比开发人员快得多，如果程序反应缓慢，这可能会导致问题。

故事：曾几何时，在个人电脑出现之前，有分时。一家分时度假公司的客户代表告诉我，有一次他给两三个漂亮的老年女性上“如何做”课时，他告诉她们如何停止正在运行的程序（以防启动错误或耗时过长） .) 他让其中一名学生输入^K，分时终端回应“Killed！”。这位女士差点心脏病发作。

我们公司的一个问题是员工不信任计算机。如果您将他们在纸上执行的功能计算机化，他们将继续在纸上执行此操作，同时将结果输入计算机。

# php - 管理员使用 php 管理会员

> ID：361839
> 
> 赞同：-1
> 
> 时间：2008-12-12T03:50:45.010
> 
> 标签：php, admin

很抱歉上次问了我的功能问题类型问题。我是 Stackoverflow.com 的新手，也是 php 的新手，这就是为什么。

我想问的是：

我已经创建了一个管理员帐户。会员有注册页面，因此会员将注册。当用户在数据库表中注册时，我将有一个字段初始化 0 值，这意味着他没有被批准。在管理员帐户中，我有获取成员列表的代码。代码如下：

```
<h2><?php echo "User list"; ?></h2>

        <table border="0" cellpadding="0" cellspacing="0">
                <tr bgcolor="#f87820">
                        <td><img src="img/blank.gif" alt="" width="10" height="25"></td>
                        <td class="tabhead"><img src="img/blank.gif" alt="" width="150" height="6"><br><b><?php echo "first name"; ?></b></td>
                        <td class="tabhead"><img src="img/blank.gif" alt="" width="150" height="6"><br><b><?php echo "lastname name"; ?></b></td>
                        <td class="tabhead"><img src="img/blank.gif" alt="" width="150" height="6"><br><b><?php echo "member id"; ?></b></td>
                        <td class="tabhead"><img src="img/blank.gif" alt="" width="50" height="6"><br><b><?php echo "delete"; ?></b></td>
                        <td><img src="img/blank.gif" alt="" width="10" height="25"></td>
                </tr>

                <?php

                                                }

                        $result=mysql_query("SELECT member_id,firstname,lastname,login FROM members ORDER BY firstname");
                        $i = 0;
                        while($row = mysql_fetch_array($result)) {
                                if ($i > 0) {
                                        echo "<tr valign='bottom'>";
                                        echo "<td bgcolor='#ffffff' height='1' style='background-image:url(img/strichel.gif)' colspan='6'></td>";
                                        echo "</tr>";
                                }
                                echo "<tr valign='middle'>";
                                echo "<td class='tabval'><img src='img/blank.gif' alt='' width='10' height='20'></td>";
                                echo "<td class='tabval'><b>".$row['lastname']."</b></td>";
                                echo "<td class='tabval'>".$row['firstname']." </td>";
                                echo "<td class='tabval'>".$row['member_id']." </td>";

                                echo "<td class='tabval'><a onclick=\"return </span></a></td>";
                                echo "<td class='tabval'></td>";
                                echo "</tr>";
                                $i++;
                        }

                ?>

        </table>

in this i wanna add tho more things in the table 1 to delete a member and 2 to have approved or denied option for that i made two functiom

below code is to delete

if($_REQUEST['action']=="del")
{
$memberId = mysql_real_Escape_string($_REQUEST['member_id']);
mysql_query("DELETE FROM members WHERE member_id=$memberId");
} 
```

以下为批准成员

但我的问题是我不知道如何在表中包含一个按钮或单选按钮，可以将值删除或批准传递给这些函数。

请告诉我添加此按钮的语法如何，以便批准我可以将我在数据库中提供的值 0 更改为 1 以便成员获得批准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T04:11:21.847

尝试这个：

```
echo '<td><a href="http://yourwebsite/yourscriptname.php?action=del&amp;member_id='
   . htmlspecialchars($row['member_id']) . '">Delete</a>';
if ($row['approved'] == 0) {
    echo '&nbsp;<a href="http://yourwebsite/yourscriptname.php?action=approve&amp;member_id='
       . htmlspecialchars($row['member_id']) . '">Approve</a>';
}
echo '</td>'; 
```

并确保所有数据库值都在 htmlspecialchars() 中发送到浏览器。

另一方面，

```
$member_id = 0;
if (isset($_GET['member_id'])) $member_id = intval($_GET['member_id']);
$action = '';
if (isset($_GET['action'])) $action = $_GET['action'];

$sql = '';
switch($action) {
case 'approve':
    $sql = "UPDATE members SET approval = 1 WHERE member_id = $member_id";
    break;
case 'delete':
    $sql = "DELETE FROM member WHERE member_id = $member_id";
    break;
}
if (!empty($sql) && !empty($member_id)) {
    // execute the sql.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T04:01:41.430

我要做的是在表格内设置一个表格。

`?> <form name="deleteUser" id="deleteUser" method="post" action=""> <input type="hidden" name="member_id" id="member_id" value="<?php echo $row['member_id'] ?> <input type="submit" name="action" id="action" value="del" /> </form><?php`

我会在你的`<td>`标签之间插入它。

`<td class='tabval'>INSERT HERE</td>";`

# svn - 从不幸的“svn 副本”中恢复

> ID：361840
> 
> 赞同：1
> 
> 时间：2008-12-12T03:51:05.320
> 
> 标签：svn, recovery

今天下午，在注意到构建损坏以及一些文件看起来非常旧的版本（大约 2 周前）的事实后，我检查了 svn 日志。显然就在今天下午，其中一位开发人员将一个目录从旧版本复制到同一目录。因此，该目录中所有文件的最新版本“ie head”似乎确实很旧，并且所有历史记录“ie log”甚至更旧。

但是，我认为我可以通过使用另一个“svn 副本”来恢复（即疾病就是治愈）。我正在考虑做的是找到完成坏“svn副本”的修订版（比如rev 1234），减去1（1233）并做：

```
svn copy -r 1233 file://path/to/messed/up/dir file://path/to/messed/up/dir 
```

那*应该*恢复最新版本，并取回我的所有历史记录。我是对的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T08:25:38.607

根据[SVN 书](http://svnbook.red-bean.com/)，

```
svn merge -c -1234 
```

应该做的伎俩。

书中有一整[节](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)关于这方面的内容。

详细的解释： `-c -1234`翻译成`-r 1234:1233`，这会恢复从修订版 1234 的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T05:24:24.277

此复制命令不起作用有两个原因：

1.  由于目标目录已经存在，svn将复制请求视为复制到目标目录；你不能用cp覆盖。所以这将创建 up/dir/dir。当创建 dir 的 HEAD 版本时，也必须首先进行删除操作。
2.  请求将 HEAD 对象的版本 1233 复制到 up/dir。但是，HEAD 中的 dir 对象没有修订版 1233；具有相同路径且具有此类修订的对象已被删除。

要解决此问题，您需要

1.  删除当前目录对象：

    ```
    svn rm file:///path/to/messed/up/dir 
    ```

2.  使用“挂钩修订”复制

    ```
    svn cp file:///path/to/messed/up/dir@1233 file:///path/to/messed/up 
    ```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-12T04:53:00.423

可能，但先备份。

实际上，我想知道为什么您没有可以从已经恢复的每日备份...您的 SVN 存储库肯定足够重要吗？

# cocoa-touch - UINavigationController 推送视图

> ID：361852
> 
> 赞同：0
> 
> 时间：2008-12-12T03:57:32.343
> 
> 标签：cocoa-touch

抱歉 - 这可能是一个简单的问题，我是 iPhone 开发的新手，并且仍然围绕着 Views 和 ViewControllers。

我有一个 NavigationViewController，我可以在连接到 Bar Button Item 的 RootViewController 中使用以下方法推送视图：

```
- (IBAction)switch:(id)sender {
        NSLog(@"Swith...");
        LibraryViewController *varLibraryViewController = [[LibraryViewController alloc] initWithNibName:@"LibraryViewController" bundle:nil];
        [[self navigationController] pushViewController:varLibraryViewController animated:YES];
    } 
```

我想从当前加载的同一视图上的按钮调用相同的方法。基本上我想让顶部的 Bar Button 调用与视图上的按钮相同的方法。我想知道如何从从 viewController 加载的视图中调用 ViewController 中的方法。希望这是有道理的。

我需要创建 RootViewController 的实例吗？我认为那已经被实例化了。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T23:19:11.177

顺便说一句，您粘贴在那里的代码正在泄漏您的 LibraryViewController。您需要在推送后显式释放它，或者在创建时自动释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T04:43:29.537

您需要在头文件中将您的方法声明为 IBAction：

```
`- (IBAction) myMethod: (id) sender;` 
```

`保存标题，然后切换到 Interface Builder。右键单击 Bar Button，然后从`selector`标签拖动到您的视图控制器对象（可能是文件所有者）。当你发布时，你应该得到一个可用操作的弹出菜单，并且`myMethod`应该是可选择的。`

 `如果您没有看到此弹出窗口，您可能需要确保您的文件所有者类设置正确：在文件窗口中选择文件所有者，然后从菜单中选择“工具”>“身份检查器”。在检查器中，在 Class 字段中键入视图控制器的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T23:21:11.577

您的 RootViewController 应该有自己的 xib 文件。在这个 xib 中，RootViewController 由名为“File's Owner”的对象表示。您可以将视图上的按钮链接到文件的所有者，就像您可以将事物链接到 MainMenu.xib 中的 RootViewController 一样。

# c++ - 如何在存在 2 个网卡的情况下为 UDP 多播设置套接字？

> ID：361854
> 
> 赞同：13
> 
> 时间：2008-12-12T03:59:28.330
> 
> 标签：c++, linux, udp, multicast

我正在尝试使用套接字和 c++ (c) 获取 udp 多播数据。我有一个带有 2 个网卡的服务器，所以我需要将套接字绑定到特定的接口。目前我正在另一台只有一个网卡的服务器上进行测试。

当我使用 INADDR_ANY 时，我可以看到 udp 数据，当我绑定到特定接口时，我看不到任何数据。函数 inet_addr 没有失败（我现在删除了对返回值的检查）。

代码如下。在有一个网卡的服务器上，我的 IP 地址是 10.81.128.44。我运行时收到数据：./client 225.0.0.37 12346

这没有给我任何数据：./client 225.0.0.37 12346 10.81.128.44

有什么建议么？（希望代码编译，我删除了评论......）

```
 #include <stdlib.h>
    #include <sys/types.h>
    #include <sys/socket.h>
    #include <netinet/in.h>
    #include <arpa/inet.h>
    #include <time.h>
    #include <string.h>
    #include <stdio.h>

    #include <iostream>
    #include <string>

    using namespace std;

    #define HELLO_PORT 12345
    #define HELLO_GROUP "225.0.0.37"
    #define MSGBUFSIZE 256

    int main(int argc, char *argv[])
    {
        string source_iface;
        string group(HELLO_GROUP);
        int port(HELLO_PORT);

        if (!(argc < 2)) group = argv[1];
        if (!(argc < 3)) port = atoi(argv[2]);
        if (!(argc < 4)) source_iface = argv[3];

        cout << "group: " << group << " port: " << port << " source_iface: " << source_iface << endl;

        int fd;
        if ((fd = socket(AF_INET, SOCK_DGRAM, 0)) < 0)
        {
            perror("socket");
            exit(1);
        }

        u_int yes = 1;
        if (setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(yes)) < 0)
        {
            perror("Reusing ADDR failed");
            exit(1);
        }

        struct sockaddr_in addr;
        memset(&addr, 0, sizeof(addr));
        addr.sin_family = AF_INET;
        addr.sin_port = htons(port);
        addr.sin_addr.s_addr = (source_iface.empty() ? htonl(INADDR_ANY) : inet_addr(source_iface.c_str()));

   if (bind(fd,(struct sockaddr *)&addr, sizeof(addr)) < 0)
   {
        perror("bind");
        exit(1);
   }

   struct ip_mreq mreq;
   mreq.imr_multiaddr.s_addr = inet_addr(group.c_str());
   mreq.imr_interface.s_addr = (source_iface.empty() ? htonl(INADDR_ANY) : inet_addr(source_iface.c_str()));

    if (setsockopt(fd, IPPROTO_IP, IP_ADD_MEMBERSHIP, &mreq, sizeof(mreq)) < 0)
    {
        perror("setsockopt");
        exit(1);
    }

    socklen_t addrlen;
    int nbytes;
    char msgbuf[MSGBUFSIZE];

   while (1)
    {
        memset(&msgbuf, 0, MSGBUFSIZE);

        addrlen = sizeof(addr);
        if ((nbytes = recvfrom(fd, msgbuf, MSGBUFSIZE, 0, (struct sockaddr *)&addr, &addrlen)) < 0)
        {
            perror("recvfrom");
            exit(1);
        }
       cout.write(msgbuf, nbytes);
        cout.flush();
    }

    return 0;
} 
```

提前致谢 ...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T10:05:14.630

经过一些搜索和测试后，我发现[在](http://www.kohala.com/start/mcast.api.txt)**绑定**udp 多播套接字时，我们指定端口并将地址留空，例如指定`INADDR_ANY`。

所以以下

```
addr.sin_family = AF_INET;
addr.sin_port = htons(port);
addr.sin_addr.s_addr = (source_iface.empty() ?
                        htonl(INADDR_ANY) : 
                        inet_addr(source_iface.c_str())); 
```

应该是这样的：

> **评论**：如果我理解您的代码，您应该绑定到您的多播地址而不是通配符地址。如果您绑定到通配符地址，您将能够在您的多播端口上接收单播数据包。绑定到您的多播地址将防止这种情况发生，并确保您仅在该端口上获得多播数据包。
> 
> **编辑**：修复了基于上述注释的代码，绑定到多播地址，存储在“组”中，而不是 INADDR_ANY 仅接收发送到多播地址的多播数据包。

```
addr.sin_family = AF_INET;
addr.sin_port = htons(port);
addr.sin_addr.s_addr = (group.empty() ?
                        htonl(INADDR_ANY) :
                        inet_addr(group.c_str())); 
```

这解决了问题。添加`IP_MULTICAST_IF`将无济于事，因为那是为了选择发送 udp 数据的特定接口，上面的问题出在接收端。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T11:11:21.017

我认为您需要添加 IP_MULTICAST_IF

```
 struct  ip_mreq         multi;

   multi.imr_multiaddr.s_addr = inet_addr(group.c_str());
   multi.imr_interface.s_addr = (source_iface.empty() ?
         htonl(INADDR_ANY): inet_addr(source_iface.c_str()));

    status = setsockopt(me->ns_fd, IPPROTO_IP, IP_MULTICAST_IF,
        (char *)&multi.imr_interface.s_addr,
        sizeof(multi.imr_interface.s_addr)); 
```

我希望这会有所帮助。

# django - 如何优雅地重启 django 在 nginx 后面运行 fcgi？

> ID：361855
> 
> 赞同：25
> 
> 时间：2008-12-12T03:59:32.950
> 
> 标签：django, nginx, deployment, fastcgi

我在使用 fcgi 连接的 nginx 后面运行一个 django 实例（通过使用 manage.py runfcgi 命令）。由于代码已加载到内存中，我无法在不杀死并重新启动 django fcgi 进程的情况下重新加载新代码，从而中断实时网站。重新启动本身非常快。但是通过首先杀死 fcgi 进程，一些用户的操作会被打断，这是不好的。我想知道如何重新加载新代码而不会造成任何中断。建议将不胜感激！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T07:44:37.283

我会在新端口上启动一个新的 fcgi 进程，更改 nginx 配置以使用新端口，让 nginx 重新加载配置（这本身很优雅），然后最终停止旧进程（您可以使用 netstat 找出何时与旧端口的最后一个连接已关闭）。

或者，您可以更改 fcgi 实现以分叉一个新进程，关闭子进程中除 fcgi 服务器套接字之外的所有套接字，关闭父进程中的 fcgi 服务器套接字，在子进程中执行一个新的 django 进程（使其使用 fcgi 服务器socket)，并在所有 fcgi 连接关闭后终止父进程。IOW，为 runfcgi 实现优雅重启。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-05T17:16:19.377

所以我继续执行了马丁的建议。这是我想出的 bash 脚本。

```
pid_file=/path/to/pidfile
port_file=/path/to/port_file
old_pid=`cat $pid_file`

if [[ -f $port_file ]]; then
    last_port=`cat $port_file`
    port_to_use=$(($last_port + 1))
else
    port_to_use=8000
fi

# Reset so me don't go up forever
if [[ $port_to_use -gt 8999 ]]; then
    port_to_use=8000
fi

sed -i "s/$old_port/$port_to_use/g" /path/to/nginx.conf

python manage.py runfcgi host=127.0.0.1 port=$port_to_use maxchildren=5 maxspare=5 minspare=2 method=prefork pidfile=$pid_file

echo $port_to_use > $port_file

kill -HUP `cat /var/run/nginx.pid`

echo "Sleeping for 5 seconds"
sleep 5s

echo "Killing old processes on $last_port, pid $old_pid"
kill $old_pid 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-07-21T21:59:37.283

我在寻找此问题的解决方案时遇到了此页面。其他一切都失败了，所以我查看了源代码:)

解决方案似乎要简单得多。Django fcgi 服务器使用 Flup，它以正确的方式处理 HUP 信号：它优雅地关闭。所以你所要做的就是：

1.  将 HUP 信号发送到 fcgi 服务器（runserver 的 pidfile= 参数会派上用场）

2.  稍等（flup 允许孩子处理 10 秒，所以再等几秒；15 看起来不错）

3.  将 KILL 信号发送到 fcgi 服务器，以防万一有什么东西阻止了它

4.  再次启动服务器

就是这样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T10:15:26.403

您可以使用生成而不是 FastCGI

[http://www.eflorenzano.com/blog/post/spawning-django/](http://www.eflorenzano.com/blog/post/spawning-django/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-14T10:55:29.750

我们终于找到了正确的解决方案！

[http://rambleon.usebox.net/post/3279121000/how-to-gracefully-restart-django-running-fastcgi](http://rambleon.usebox.net/post/3279121000/how-to-gracefully-restart-django-running-fastcgi)

首先向flup发送一个HUP信号来表示重启。然后 Flup 将对它的所有子节点执行此操作：

1.  关闭将停止非活动孩子的套接字
2.  发送一个 INT 信号
3.  等待 10 秒
4.  发送 KILL 信号

当所有的孩子都走了，它会开始新的孩子。

这几乎在所有时间都有效，除了如果在flup执行 step 时孩子正在处理请求，`2`那么您的服务器将死机`KeyboardInterrupt`，给用户一个 500 错误。

解决方案是安装 SIGINT 处理程序 - 有关详细信息，请参阅上面的页面。即使只是忽略 SIGINT 也会让您的进程有 10 秒的时间退出，这对于大多数请求来说已经足够了。

# jquery - 通过jquery为Select html元素着色

> ID：361856
> 
> 赞同：2
> 
> 时间：2008-12-12T04:00:45.113
> 
> 标签：jquery, html-select

我再次需要一些关于 jQuery 脚本的帮助 :-) 只是想玩 jQuery..我使用下面的脚本为选择元素的着色选项。它在纯 html 中工作，但在我的 asp.net 2.0（主 + 内容页面）中没有。脚本放置在 Head 部分。

```
function pageLoad(){
   var allOddSelectOption  = "select option:odd";
   var evenStyle = "background-color:'#f4f4f4';color:'#555'";

   $(allOddSelectOption).attr('style',evenStyle);
} 
```

我也尝试过使用`$(document).ready(function(){`，但也没有用。

任何想法，最欢迎提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T04:04:39.943

检查[css(properties)](http://docs.jquery.com/CSS/css#properties)，你可以很容易地应用样式。

```
$(document).ready(function(){
  $("select option:odd").css({'background-color' : 'yellow', 'font-weight' : 'bolder'});
}); 
```

编辑：对于 ASP .NET 2.0`$(document).ready()`将起作用，因为您可以[多次](http://www.learningjquery.com/2006/09/multiple-document-ready)调用它，即使它不在 head 部分中也不会有问题。

* * *

对于 ASP .NET 3.5

您可以在 MasterPage 中添加一个头部占位符，如下所示：

```
<asp:ContentPlaceHolder id="head" runat="server">
</asp:ContentPlaceHolder> 
```

然后在您的子页面中，您可以通过 Content 标签将 html 放入其中：

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
  <script language="JavaScript>
    //Scripts here!
  </script>
</asp:Content> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T09:05:44.033

我会说在每种情况下都使用 .addClass 而不是添加内联 css 属性。这些在 javascript 中很难维护。

```
e.g $('#someDiv').addClass('odd'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T04:07:43.727

当您使用母版页时，ASP.Net 会修饰您的元素 ID。它会在前面放很多东西，但最后留下你的原始 ID。因此，您可以在 ASP.Net 服务器控件渲染中使用这样的选择器。

```
$("[id$=originalIdFromAspxPage]").attr... 
```

该`$=`部分意味着这将匹配任何具有以您提供的 ID 结尾的 ID 的元素。

它不如直接 ID 选择器那么有效，但它在 ASP.Net 页面上就像一个魅力。

# php - PHP - 函数/变量命名

> ID：361869
> 
> 赞同：7
> 
> 时间：2008-12-12T04:09:21.650
> 
> 标签：php, naming-conventions

我已经阅读了很多流行的开源 PHP 项目标准手册。

很多对变量空间强制使用下划线，并且很多强制使用驼峰式。

全局函数和变量的命名是否应该与类方法/属性不同？

我知道最重要的是一致性，但我想听听对此的一些想法。

你会推荐什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-12T04:36:16.150

我发现 camelCase 打字更舒服一些，因为我觉得下划线打字有点尴尬。

不要使用全局变量。

我避免在 PHP 中进行程序编码，我发现 OOP 更容易让事情井井有条。此外，PHP 的全局命名空间中还没有足够的东西吗？

通常我会尝试坚持：

*   类是 StudlyCaps 的单数或复数名词，视情况而定：`Item`, `Row`, `DB`, `Items`.
*   变量是小写名词、单数或复数，具体取决于它们的含义：`$column`,`$name`
*   常量是单数大写名词：`DEBUG`, `TYPE_FOO`.
*   方法是驼峰式，以单数动词 ( `get`, `perform`, `do`) 开头，后跟一个名词（单数或复数）描述其操作或返回的内容 ( `getThing()`, `getThings()`)

这绝对取决于您要编码的内容。如果我正在编写 PHP 或 PEAR，我使用 camelCase。如果我在做 Python/Django，我会使用 under_scores。如果我正在编写 ELisp，我会使用虚线分隔符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T05:28:08.853

在 PHP 本身中，几乎每个原生函数都用下划线分隔。文档中的大部分 PHP 代码示例都用下划线分隔。

在大多数语言中，我认为 Camel 或 Pascal Casing 更合适，但我认为在 PHP 中使用下划线分隔有明确的历史。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:21:13.440

[Zend Frameworks 命名约定](http://framework.zend.com/manual/en/coding-standard.naming-conventions.html)（基于 PEAR）可能是您在 PHP 世界中最接近标准的。就个人而言，我更喜欢使用 lowercase_underscore 作为变量名，但除此之外我主要遵循 ZF 的约定。

**10周年更新：**

如今，有一个标准，在社区中被广泛接受。你应该坚持这一点：

[https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T04:27:41.440

是的，最重要的是一致性。如果您是唯一的开发人员，请坚持使用一种方法。如果您正在与团队合作，请与其他团队成员交谈。区分全局变量、函数/方法和类将使阅读代码更容易。对于某些人来说，camelCase 比 using_underlines 更容易，因此您的团队需要讨论选项并选择一种样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T04:35:17.620

**注意：**我的 MySQL table_names 使用下划线，MySQL 字段名称使用 UpperCamelCase：

通常我将 $lowerCamelCase 用于变量名称和类属性，但如果它包含来自字段的值，我使用 $UpperCamelCase 字段名称，或者如果它是来自表的数据数组，我将使用 $table_name。这样我可以很容易地`grep`找到`SomeField`或`some_table`找到所有引用它的东西。

您不必使用这个精确的系统，但是能够搜索对字段或表的所有引用是一个巨大的好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T13:31:40.740

我以前更喜欢使用 camelCase，但为了在更大的应用程序中保持一致性，我采用了 CodeIgniter 的样式指南。

即使您不使用他们的框架，您也可以欣赏为定义清晰而全面的样式所做的工作：http: [//codeigniter.com/user_guide/general/styleguide.html](http://codeigniter.com/user_guide/general/styleguide.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T17:40:24.390

我的目标——无论名称的具体格式如何——是添加更多信息。名称是否提高了对代码的理解和/或表达了一些重要的东西？

如果确实如此，那太好了，那么你已经成功了。

如果名称没有添加任何内容，您为什么还要麻烦命名它？

本周早些时候，我在这篇文章中写道：

[http://caseysoftware.com/blog/useful-naming-conventions](http://caseysoftware.com/blog/useful-naming-conventions)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T17:47:44.063

我建议阅读[PEAR 编码标准](http://pear.php.net/manual/en/standards.php)。由于 PEAR 是官方的 PHP Extension and Application Repository，它可以被认为是该语言的官方编码标准。

# debugging - 处理神物

> ID：361873
> 
> 赞同：12
> 
> 时间：2008-12-12T04:10:47.513
> 
> 标签：debugging, language-agnostic, god-object

我在一个中等规模的团队中工作，并且经常遇到这些令人痛苦的大类文件。我的第一个倾向是用刀去攻击他们，但这通常只会让事情变得更糟，让我陷入糟糕的心态。

例如，假设您刚刚获得了一个 Windows 服务来处理。现在这个服务有一个错误，你需要弄清楚这个服务做了什么，然后才能有任何修复它的希望。你打开服务，发现有人决定只使用一个文件来处理所有事情。开始方法在那里，停止方法，定时器，所有的处理和功能。我说的是数千行代码。一百行代码以下的方法很少见。

现在假设你不能重写整个类并且这些神类只是不断弹出，处理它们的最好方法是什么？你从哪里开始？你首先尝试完成什么？你如何处理这种事情而不是只想得到所有的刺伤。

如果你有一些策略来控制你的脾气，那也是受欢迎的。

到目前为止的提示：

1.  建立测试覆盖率
2.  代码折叠
3.  重组现有方法
4.  记录发现的行为
5.  以渐进式改进为目标

编辑：

Charles Conway 推荐了一个非常有帮助的播客。[关联](http://www.dotnetrocks.com/default.aspx?showNum=397)

Michael Feathers（播客中的那个人）从一个前提开始，他们不敢简单地将项目从源代码控制中取出，直接使用它，然后丢弃更改。我可以说我对此感到内疚。

他基本上是说拿走你想了解更多的项目，然后开始把它拆开。发现它的依赖关系，然后打破它们。跟随它走过它所到之处。

**很棒的提示** 使用在别处使用的大类并让它实现一个空接口。然后使用该类获取代码并让它实例化接口。这将为您提供代码中该大型类的所有依赖项的完整列表。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T04:21:42.140

哎哟! 听起来像我以前工作的地方。

查看[有效地使用遗留代码工作](https://rads.stackoverflow.com/amzn/click/com/0131177052)。它有一些关于如何处理残暴代码的宝石。

DotNetRocks 最近做了一个关于使用遗留代码的[节目。](http://www.dotnetrocks.com/default.aspx?showNum=397)没有什么神奇的药丸可以让它起作用。

我听到的最好的建议是开始在测试中逐步包装代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T04:18:09.290

这让我想起了我现在的工作以及我第一次加入的时候。他们不让我重写任何东西，因为我有同样的论点，“这些类太大而​​且写得不好！没人能理解它们，更不用说给它们添加新功能了。”

所以我要做的第一件事是确保在你想要改变的领域背后有全面的测试。至少那时您将有机会更改代码并且没有（太多）参数（希望如此）。通过测试，我的意思是通过集成或验收测试对组件进行功能测试，并确保它被 100% 覆盖。如果测试很好，那么您应该能够通过将大类拆分为较小的类、消除重复等来自信地更改代码

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T04:19:34.267

即使您无法重构文件，也要尝试重新组织它。移动方法/函数，以便它们至少在文件中进行逻辑组织。然后放入大量评论来解释每个部分。不，您还没有重写程序，但至少现在您可以正确阅读它，并且下次您必须处理该文件时，您会收到很多评论，由您编写（希望这意味着您将能够理解它们）这将帮助您处理程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T04:18:59.977

代码折叠可以提供帮助。如果您可以在巨型类中移动东西并以某种合乎逻辑的方式组织它，那么您可以在各种块周围放置折叠。

隐藏一切，你又回到了 C 范式，除了折叠而不是单独的文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T04:38:30.000

我也遇到过这种情况。

我个人先打印出（是的，可能是很多页）代码。然后我在不属于任何“主循环”或只是辅助函数的代码部分周围画了一个框，并确保我首先理解这些内容。原因是他们可能在课堂主体中被多次提及，很高兴知道他们在做什么

其次，我确定主要算法并使用数字和字母交替的编号系统将它们分解成各个部分（这很丑但对我来说效果很好）。例如，您可能正在查看深度为 4 个“级别”的算法的一部分，编号将是 1.b.3.e 或其他一些可怕的东西。请注意，当我说级别时，我不一定直接指控制块或范围，而是我已经确定了算法的步骤和子步骤。

然后就是阅读和重新阅读算法的问题。当你开始时，这听起来像是很多时间，但我发现这样做会培养一种自然的能力，可以同时理解大量逻辑。此外，如果您发现归因于此代码的错误，提前在纸上进行可视化分解有助于您稍后“导航”代码，因为您的脑海中已经有了它的某种地图。

如果您的老板认为您在使用某种形式的 UML 描述某事之前不理解某事，那么如果您假设子步骤级别是水平表示的不同“类”，那么 UML 序列图可能会有所帮助，并且从开始到结束是从上到下垂直表示。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-12T05:48:39.030

我感觉到你的痛苦。我曾经为一个涉及在我的计算机上处​​理数字电视数据的爱好项目解决了类似的问题。硬件论坛上的一位同事编写了一个很棒的工具，用于录制节目、查看正在播放的所有内容等等。此外，他在解决实际广播信号中违反标准的错误方面做了非常重要的工作。他在线程调度方面做了惊人的工作，以确保无论如何，你都不会丢失那些实时数据包：在旧的 Pentium 上，他可以在玩 Doom 的同时同时录制四个流，并且永远不会丢失一个包。简而言之，这段代码包含了大量的知识。我希望采取一些措施并将它们合并到我自己的项目中。

I got the source code. **One file, 22,000 lines of C, no abstraction**. I spent hours reading it; there was all this great work, but it was all done badly. I was not able to reuse a single line or even a single idea.

I'm not sure what the moral of the story is, but if I had been forced to use this stuff at work, I would have begged permission to **chip pieces off it one at a time, build unit tests for each piece, and eventually grow a new, sensible thing out of the pieces.** This approach is a bit different than trying to refactor and maintain a large brick in place, but I would rather have left the legacy code untouched and tried to bring up a new system in parallel.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T04:19:55.637

我要做的第一件事是编写一些单元测试来装箱当前的行为，假设还没有。然后，我将从需要进行更改的区域开始，并尝试清理该方法——即在引入更改之前重构工作代码。使用常见的重构技术从现有的长方法中提取和重用方法，使其更易于理解。当你提取一个方法时，寻找代码中存在类似代码的其他地方，将那个区域框起来，然后重用你刚刚提取的方法。

寻找可以分解成自己的类的“挂在一起”的方法组。为这些类应该如何工作编写一些测试，如果需要，使用现有代码作为模板构建类，然后将新类替换为现有代码，删除它们替换的方法。同样，使用您的测试来确保您没有破坏任何东西。

对现有代码进行足够的改进，以便您觉得可以以干净的方式实现新功能/修复。然后为新功能/修复编写测试并实施以通过测试。不要觉得你必须第一次解决所有问题。旨在逐步改进，但总是让代码比你发现的更好。

# python - 用于几何形状的 Python Canvas 库

> ID：361889
> 
> 赞同：4
> 
> 时间：2008-12-12T04:24:00.077
> 
> 标签：python, algorithm, canvas, drawing

我正在寻找一个 Python 库来创建用于操作几何形状的画布。具体来说，我需要能够创建任意多边形并将它们放置在画布上，多边形需要能够透明/具有 alpha 通道，我需要能够编辑当前在画布上的多边形，我需要能够获得给定像素的实际颜色（所有透明部分的集合）。

基本上我正在尝试这样做：[http](http://alteredqualia.com/visualization/evolve/) ://alteredqualia.com/visualization/evolve/ in python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T05:56:50.950

我认为[开罗](http://cairographics.org/)会做很多你想做的事。他们也有[python 绑定](http://www.cairographics.org/pycairo/)。

对您没有帮助的一个要求是修改以前绘制的多边形，但我不知道有任何画布可以为您做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T08:02:21.150

听起来像是[OpenGL](http://pyopengl.sourceforge.net/)的工作。

我的建议是，无论您选择哪个库，都要为多边形创建一个适合您算法的数据结构，以便它们更简单和可读，而不是尝试让这些算法直接操作画布。然后，您可以编写将它们与主逻辑分开（即独立）的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T09:00:34.790

[这个关于 Stackoverflow 的讨论对](https://stackoverflow.com/questions/326300/python-best-library-for-drawing#326568)Python 的各种 GUI 工具包进行了一些比较和代码片段。我很确定[QT](http://www.troll.no)上的[QGraphicsView](http://doc.trolltech.com/4.2/qgraphicsview.html)会做到透明。诺基亚 (nee Troll) 为 QT 制作了一个演示套件，可以让您了解它的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T15:34:09.963

> 我相信 HTML 画布可以让您修改元素

它不是。您可以查看我的[HTML 画布教程](http://billmill.org/static/canvastutorial/)，了解如何绘制移动球；你擦拭屏幕并在你想要的位置画一个新的圆圈。

您可以在所有 pyglet、pygame、QT、Tkinter、wxPython 和 cairo 中将简单的形状绘制到画布上。

通常，您将拥有称为“精灵”或“形状”的对象，它们代表绘制到屏幕上的对象，并且您会将它们全部存储在一个容器中。然后库或框架将在每一帧将它们全部渲染到画布上。因此，在用户（您）看来，您可以修改屏幕上的对象；您设置一个球的 x 和 y 坐标，并在下一帧中渲染它。然而，在低级别，一切都被擦除并重新绘制。

对于计算密集型动画，将采用一种称为[双缓冲](http://en.wikipedia.org/wiki/Double_buffering)的技术，其中将修改内存中的位图而不是屏幕上的位图，然后绘制过程将简单地将该位图复制到屏幕上。

> 更改列表中的项目，然后创建一个新的画布，这似乎会产生很大的开销。

上面提到的所有框架都会给你一个很好的抽象对象列表来绘制，这样你就不需要手动维护它，你可以像你绘制的精灵/形状可以直接移动一样编程在屏幕上，即使他们真的不在低水平。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T04:36:56.930

[Pygame](http://pygame.org/)应该能够为您做到这一点。

见 pygame.draw.polygon

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T09:23:21.750

尝试[pyglet](http://pyglet.org/)。它是带有 OpenGL 的 Python 图形库。如果你以前做过 OpenGL 编程，那肯定是得到你想要的最简单的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T06:42:06.490

I believe the HTML canvas lets you modify elements, which makes me believe there might be another canvas that can as well. However, if there is not that would basically require me to keep a separate list of all the polygons and when I wanted to make a change, alter the item in the list and then create a new canvas, which seems like it would have a significant overhead.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T08:28:07.383

Both Qt and wxWidgets have some canvas drawing abilities (Qt calls it GraphicsView). Quick Google searches will get you a lot of examples so you can see if it fits your requirements.

# cocoa - 核心动画中是否可以进行关键帧过渡？

> ID：361890
> 
> 赞同：0
> 
> 时间：2008-12-12T04:25:20.103
> 
> 标签：cocoa, core-animation

我知道通过在实例上设置`path`属性可以在核心动画中实现关键帧转换。`CAAnimation`不过，`CATransition`好像没有这个功能。除了设置计时功能外，有谁知道控制过渡的其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-13T10:17:00.570

答案似乎是否定的。如果你想做这种事情，你必须自己添加 CAAnimation 而不是依赖于过渡。过渡可能取决于 CoreAnimation 的一些深层工作，因为它们的工作方式与普通动画不同（它们不会移动相关对象，它们控制对象的新内容如何替换旧内容）。

# php - PHP 在函数的输出上生成一个数字“1”。我以前从未见过它这样做

> ID：361904
> 
> 赞同：1
> 
> 时间：2008-12-12T04:37:11.797
> 
> 标签：php

```
function holiday_hitlist($tablename, $hit_user){

    global $host, $user, $pass, $dbname;

    $link = mysql_connect($host, $user, $pass, $dbname);

    print "<div class=\"hit_list\">
            <h3>My Holiday Hitlist</h3>
            <p>Five things I want the most, based on my desirability ratings.<br/>You can't go wrong with this stuff!</p>
            <ol>";

    $sql = "SELECT title, URL, price FROM $dbname.$tablename WHERE user='$hit_user' AND rank >= 3 ORDER BY date DESC LIMIT 5";
    $result = mysql_query($sql) or die ("Couldn't retrieve holiday hit list for this user. " . mysql_error());
    while($row = mysql_fetch_array($result)) {
        $title = $row['title'];
        $url = $row['URL'];
        $price = "$" . $row['price'];
        $output = print "<li><a href=\"$url\" target=\"_blank\">$title</a> $price</li>";
    }
    print "</ol></div>";
    return $output;
} 
```

在 HTML 页面上，它会将“1”紧跟在结束`div`标记之后。为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T04:43:53.357

看线

```
$output = print "<li><a href=\"$url\" target=\"_blank\">$title</a> $price</li>"; 
```

您可能应该在 $output = 之后删除打印

或者，也许您只需要删除 $output =

我不太确定你的意图。

解释一下， $output 正在获取 print "..." 的返回值

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T04:49:21.460

来自 php.net 参考：

“返回值

总是返回 1。”

[http://ca.php.net/manual/en/function.print.php](http://ca.php.net/manual/en/function.print.php)

您应该将 $output 指定为您想要的输出，然后使用 print 显示该输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T06:05:29.933

从您所写的内容来看，我认为您正在做类似的事情：

```
function holiday_hitlist($tablename, $hit_user){
  /* connections etc

  */

  while($row = mysql_fetch_array($result)) {
    $title = $row['title'];
    $url = $row['URL'];
    $price = "$" . $row['price'];
    $output = print "<li><a href=\"$url\" target=\"_blank\">$title</a>$price</li>";
  }
  print "</ol></div>";
  return $output;
}

print holiday_hitlist("mytab","myuser"); 
```

或许

```
$somevar = holiday_hitlist("mytab","myuser");
print $somevar; 
```

您正在“打印”返回值这一事实确实是一个问题。在您上面的示例中，为什么要返回任何内容？你可以；

a) 将函数设置为只做某事但不返回任何内容的例程。（即：只需删除**return $output**和**print holiday_hitlist()**中的打印）

或者

b）创建一个返回所需数据的函数，然后对其进行处理。

b) 的一个例子是；

```
function holiday_hitlist($tablename, $hit_user){
  /* connections etc

  */

  while($row = mysql_fetch_array($result)) {
    $title = $row['title'];
    $url = $row['URL'];
    $price = "$" . $row['price'];
    $output .= "<li><a href=\"$url\" target=\"_blank\">$title</a>$price</li>";
  }
  return $output;
}

$somevar = holiday_hitlist("mytab","myuser");

print "<div class=\'hit_list\'>
<h3>My Holiday Hitlist</h3>
<p>Five things I want the most, based on my desirability ratings.<br/>You can't go wrong with this stuff!</p>
<ol>
$somevar
</ol></div>"; 
```

上面的函数有助于将演示文稿（即：HTML）与您的数据分开。虽然在这个示例中并不完美，但您将能够在一个块中查看所有 html 并更轻松地对其进行调试。

# asp.net - ASP.NET 中是否有任何本地方式来执行“成功消息”？

> ID：361910
> 
> 赞同：9
> 
> 时间：2008-12-12T04:40:42.710
> 
> 标签：asp.net, c#-3.0, asp.net-2.0

假设您有类似 ASP.NET ASP:DetailsView 的东西来显示和编辑数据库中的单个记录。

记录错误情况很简单……您添加验证和验证摘要。当您的更新表单验证失败时，它自然会产生噪音：它显示验证消息和/或验证摘要。不需要后面的单个代码。

但是，您通过了验证，它使您的更新完全静默。没有任何意义发生了任何事情，而且似乎没有任何默认设置可以在没有代码隐藏的情况下发出成功消息。

但是，即使是代码隐藏也令人困惑。什么事件应该显示成功消息？onItemUpdate，对吧？很好，但是假设您进行了另一项更改并收到验证错误？您的成功信息将保留。如果出现验证错误，我无法找到能够可靠地关闭现有成功消息的事件。

这应该是 Web 开发 101！为什么这么难？

**编辑：**

有人建议使用 ItemCommand 事件......我尝试了这个和许多其他事件，但成功消息不会消失。这是一些代码。

我在 ASP.NET 中的消息

```
<label id="successMessage" class="successMessage" runat="server"></label> 
```

还有我的 DataView 标签（简化）：

```
 <asp:DetailsView 
        Id="EditClient"
        DataKeyNames="LicenseID" 
    DataSourceID="MySource"
    runat="server" 
        OnItemUpdated="SuccessfulClientUpdate"
        OnItemCommand="ClearMessages"> 
```

而且，我的代码隐藏：

```
protected void SuccessfulClientUpdate(object sender, DetailsViewUpdatedEventArgs e)
{
    successMessage.InnerText = string.Format("Your changes were saved.");
    successMessage.Visible = true;
}

protected void ClearMessages(object sender, DetailsViewCommandEventArgs e)
{
    successMessage.InnerText = string.Empty;
    successMessage.Visible = false;
} 
```

但是，一旦我成功更新，似乎没有什么能让该消息消失，甚至没有验证失败。

**第二次编辑：**

只是想明确一点，我确实尝试将 ClearMessages 代码放在 Page_Load 中。但是，当我第二次点击更新并出现验证错误时，似乎没有什么能让 successMessage 标签消失。任何人都可以建议任何其他故障排除技巧吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T07:48:25.047

据我所知，没有本地方法可以做到这一点。你可能会抱怨它，也许微软会听到它:)。

在 Page_Load 或代码隐藏中的任何位置重置“成功消息”将不起作用。这是因为 ASP.NET 验证通常在客户端和服务器端完成。这意味着对于您放置在页面上的每个验证控件，ASP.NET 都会生成一些客户端 Javascript，这些 Javascript 会执行验证并在客户端上呈现错误，**而无需**返回服务器。因此，您同时遇到了成功消息和错误消息。

你可以做些什么：

*   在您的页面上放置一个`<div>`控件，这将显示成功消息（正如上面其他人已经建议的那样）。每当您更新某些内容（在服务器端代码中）时，显示控件并设置一个有意义的“成功！” 消息文本。
*   `<div>`注册一个自定义 Javascript 函数，该函数将在每个提交页面时查找并隐藏它。请注意，需要在执行验证的自动生成的客户端脚本之前调用该函数。

如果您查看 ASP.NET 页面的客户端源代码（上面带有验证器），您可以找到以下内容：

`<form name="aspnetForm" method="post" action="MyPage.aspx" onsubmit="javascript:return WebForm_OnSubmit();id="aspnetForm">`

WebForm_OnSubmit 由 ASP.NET 生成并调用执行验证的 javascript。样本：

```
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false)
    return false;
return true;
} 
```

要注册隐藏成功消息的自定义代码，您应该按照以下方式放置（在您的代码隐藏中）：

```
if (!Page.ClientScript.IsOnSubmitStatementRegistered("ClearMessage"))
{
    string script = @"document.getElementById('" + 
        yourDivControl.ClientID + "').style.display='none'";
    Page.ClientScript.RegisterOnSubmitStatement(Page.GetType(), "ClearMessage", script);
} 
```

这会将您页面的自动生成 WebForm_OnSubmit 变成以下内容：

```
function WebForm_OnSubmit() {
    document.getElementById('ctl00_yourDivControl').style.display='none';
    if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false)
        return false;
    return true;
} 
```

效果：在每次回发时（例如，当 ItemCommand 被触发时，或当某些 Save 按钮被单击时，或其他任何事情时），您将显示带有“成功”消息的 div 控件。在下一次回发时，就在将页面提交到服务器之前，此消息被清除。当然，如果这个回发也触发了“成功”，那么服务器上的代码隐藏会再次显示该消息。等等等等。

我希望以上内容有所帮助。这不是完整的解决方案，但它提供了足够的提示来为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T04:48:55.157

使用 ItemCommand 事件并为给定的每个命令执行重置以清除状态。然后如果更新时验证失败，将显示验证错误。如果成功，它将显示成功消息。随后，单击按钮将调用 ItemCommand 事件，您可以再次重置以重新开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T12:18:34.767

丹尼尔，我需要类似的东西，所以我从标签派生并将其直接绑定到由各种 DataSourceControl 衍生产品（LinqDataSource、ObjectDataSource、SqlDataSource）引发的事件。我还使用客户端 JavaScript 在验证和/或表单提交期间隐藏标签（如 Dan.C 的回答）。

该控件为成功的 Deleted、Inserted 和 Updated 事件公开单独的消息文本属性。

我已经在[http://codehq.net/files/UpdateSuccessMessage.zip上发布了解决方案的注释源](http://codehq.net/files/UpdateSuccessMessage.zip)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T05:15:07.383

为什么不在 Page_Load 中关闭验证消息。我假设如果发生回发，您会想要删除该消息，因此请确保它始终处于关闭状态。或者通过在标记（aspx 页面）中设置 EnableViewState="False" 来禁用控件的视图状态。

所以：

```
protected void ClearMessages(object sender, DetailsViewCommandEventArgs e)
{
    successMessage.InnerText = string.Empty;    
    successMessage.Visible = false;
} 
```

变成：

```
protected void Page_Load(object sender, EventArgs e)
{
    successMessage.InnerText = string.Empty;    
    successMessage.Visible = false;

} 
```

另外，如果您构建 .net 站点，您需要对代码背后的代码感到满意，恕我直言：-)

# naivebayes - 朴素贝叶斯垃圾邮件过滤效果

> ID：361917
> 
> 赞同：7
> 
> 时间：2008-12-12T04:44:08.663
> 
> 标签：naivebayes, spam-prevention

朴素贝叶斯过滤过滤垃圾邮件的效果如何？

我听说垃圾邮件发送者很容易通过填充额外的非垃圾邮件相关词来绕过它们。贝叶斯过滤器可以使用哪些编程技术来防止这种情况发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T06:06:16.173

早在 2002 年 8 月， Paul Graham 就在他的原始文章[*A Plan for Spam*](http://www.paulgraham.com/spam.html)中真正将使用贝叶斯垃圾邮件过滤的想法引入了整个网络。然后，大约一年后[他的后续行动](http://www.paulgraham.com/better.html)介绍了许多问题很快就出现了。这些仍然是该主题的出色作品。

在第二篇文章中，Graham 提到了使用[CRM114](http://crm114.sourceforge.net/)，它适用于比空格分隔的单词更广泛的模式集。CRM114 很酷，但对垃圾邮件过滤系统没有太多实施帮助。

有用于贝叶斯垃圾邮件过滤的开源工具，如[Death2Spam](http://www.death2spam.com/)和[SpamProbe](http://spamprobe.sourceforge.net/server.html)。

我发现没有什么比通过 Gmail 帐户过滤邮件更有效的了。狩猎愉快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T06:06:19.637

我认为要击败您提到的那种垃圾邮件攻击，重要的不是学习方法，而是您训练的功能。我使用 Fidelis Assis 的[OSBF-Lua](http://osbf-lua.luaforge.net/)，它是一个非常成功的过滤器：它不断赢得垃圾邮件过滤器的竞赛。它使用贝叶斯学习，但我认为它成功的真正原因是三个原则：

*   它训练的不是单个单词，而是*稀疏的二元组*：一对由 0 到 4 个“无关”单词分隔的单词。垃圾邮件发送者必须将他们的信息放在*某个地方*，而稀疏的二元组非常擅长将它们排除在外。它甚至可以找到附件垃圾邮件！

*   它对邮件标头进行了额外的培训，因为垃圾邮件发送者很难掩饰这些标头。示例：源自您的网络且从不通过网络外中继主机的消息可能不是垃圾邮件。

*   如果垃圾邮件过滤器对其分类的置信度较低，它会请求人工输入。（实际上，它会添加一个标头字段，上面写着“请在此消息上对我进行培训”；人类可以忽略该请求。）这意味着随着垃圾邮件发送者发展新技术，您的过滤器也会发展以匹配。

这种技术组合非常有效。

免责声明：我与 Fidelis 合作重构了一些软件，以便将其用于其他目的，例如将普通邮件分类为组，或者可能有一天尝试检测博客评论和其他地方的垃圾邮件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T17:38:08.037

我使用[Popfile](http://getpopfile.org/)不仅可以分类垃圾邮件，还可以将我的电子邮件分类，我发现它非常有效。它使用朴素贝叶斯过滤器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T06:27:12.900

你是对的，朴素贝叶斯过滤器容易受到[贝叶斯中毒](http://en.wikipedia.org/wiki/Bayesian_poisoning)。

# .net - .NET 桌面应用程序的最佳崩溃报告框架？

> ID：361918
> 
> 赞同：7
> 
> 时间：2008-12-12T04:45:47.473
> 
> 标签：.net, winforms, exception

我有几个简单的 Windows 窗体应用程序，我想向其中添加崩溃报告。可以为我提供有关用户机器（当然是我的应用程序）上发生的崩溃的信息，包括堆栈跟踪、日志和屏幕截图，以及用于询问用户是否要上传它的 UI 组件等。我的应用程序是免费的，所以我更喜欢免费的组件，并且包含在线聚合器的东西（例如[http://www.hoptoadapp.com/](http://www.hoptoadapp.com/)用于 Rails）将是完美的。但是，我四处搜索并没有看到任何类似的.NET。你们有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-01T04:47:21.647

有一个名为[{smartassembly}](http://www.smartassembly.com/product/index.aspx)的商业替代品可以进行错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-05T04:21:52.120

Wumpus（又名 Jeff Atwood）几年前发布了一些很酷的异常处理东西（它甚至可能是 .net 1.1 天），但它非常好且易于使用（并且将成功转换为新版本的 .net。）我是将它与我正在编写的应用程序一起使用......并且由于您获得了完整的源代码，因此您可以轻松地对其进行扩展。

这是一个链接...

[http://www.codeproject.com/KB/exception/ExceptionHandling.aspx](http://www.codeproject.com/KB/exception/ExceptionHandling.aspx)

哦，是的...下面的链接是与上面相同的库，转换为 c# 并扩展了一点...所以选择你的风格。

[http://www.codeproject.com/KB/exception/ErrorLoggingLibrary.aspx](http://www.codeproject.com/KB/exception/ErrorLoggingLibrary.aspx)

赛斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T05:45:12.953

看看[Elmah](http://code.google.com/p/elmah/)（错误记录模块和处理程序）——一个完全可插拔的应用程序范围的错误记录工具。它可以动态添加到正在运行的 ASP.NET Web 应用程序，甚至是一台机器上的所有 ASP.NET Web 应用程序，无需重新编译或重新部署。

虽然面向 ASP.NET，但它可能会给你一些关于 Winforms 实现类似的想法。

# c# - 使用 Linq 在 C# 中进行列表操作

> ID：361921
> 
> 赞同：28
> 
> 时间：2008-12-12T04:47:30.590
> 
> 标签：c#, linq

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using System.Text;

namespace ConsoleApplication1
{

    public class Class1  
    {
       static void Main(string[] args)
       {
           List<Car> mylist = new List<Car>();
           Car car1;
           Car car2;
           Car car3;

           car1 = new Car()
           {
               make = "Honda",
               id = 1
           };
           car2 = new Car()
           {
               make = "toyota",
               id = 2
           };

           car3 = new Car()
           {
              make = "Honda",
              id = 3,
              color = "red"
           };

           mylist.Add(car1);
           mylist.Add(car2);
           **////mylist.Where(p => p.id == 1).SingleOrDefault() = car3;**
        }        
    }

    public class Car
    {
        public int id { get; set; }
        public string make { get; set; }
        public string color { get; set; }

    }
} 
```

如何以最佳方式将 ID 1 的本田汽车替换为 ID 为 3 的本田汽车来更新列表。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-12-12T04:56:46.407

leppie 所说的一切 - 加上：

```
int index = mylist.FindIndex(p => p.id == 1);
if(index<0) {
    mylist.Add(car3);
} else {
    mylist[index] = car3;
} 
```

这只是使用现有的 FindIndex 来定位 id 为 1 的汽车，然后替换或添加它。没有 LINQ；没有 SQL - 只是一个 lambda 和`List<T>`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-12T05:14:24.140

如果您想对多个元素进行更新...

```
foreach (var f in mylist.FindAll(x => x.id == 1))  
{    
    f.id = car3.id;  
    f.color = car3.color;  
    f.make = car3.make;  
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-12T04:51:45.260

这不是 LINQ2SQL。

此外，LINQ 不用于更新，仅用于查询对象。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T05:18:43.040

您可以使用这种方式：

```
(from car in mylist
where car.id == 1
select car).Update(
car => car.id = 3); 
```

我的参考是[这个网站](http://community.bartdesmet.net/blogs/bart/archive/2008/11/22/dude-where-s-my-linq-dml.aspx)。或以下是更新方法的代码

```
public static void Update<T>(this IEnumerable<T> source, params Action<T>[] updates)
{
    if (source == null)
        throw new ArgumentNullException("source");

    if (updates == null)
        throw new ArgumentNullException("updates");

    foreach (T item in source)
    {
        foreach (Action<T> update in updates)
        {
            update(item);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T05:45:49.380

正如 Leppie 所说，LINQ 用于查询而不是更新。但是，这可用于构建新列表：

```
mylist = new List<Car>(from car in mylist select car.id == 1? car3 : car) 
```

也就是说，如果您想使用 LINQ。当然，它的代码又好又短，但效率不如 Marc Gravell 的建议，因为它有效地创建了一个新列表，而不是更新旧列表。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-22T09:03:47.857

```
//Item class
Class Item
{
   public string Name { get; set; }
}

List < Item > myList = new List< Item >()

//Add item to list
Item item = new Item();
item.Name = "Name";

myList.Add(Item);

//Find the item with the name prop

Item item2 = myList.Find(x => x.Name == "Name");

if(item2 != null)
   item.Name = "Changed"; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-20T15:59:22.093

只是一个问题，为什么我必须为列表看起来如此基本的东西编写更新函数？列表应该有标准方法，如 Add()、Delete()、Edit()、Insert()、Replace() ....Find()

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-24T12:11:50.973

```
List<AvailabilityIssue> ai = new List<AvailabilityIssue>();

ai.AddRange(
    (from a in db.CrewLicences
        where
            a.ValidationDate <= ((UniversalTime)todayDate.AddDays(30)).Time &&
            a.ValidationDate >= ((UniversalTime)todayDate.AddDays(15)).Time
        select new AvailabilityIssue()
        {
            crewMemberId = a.CrewMemberId,
            expirationDays = 30,
            Name = a.LicenceType.Name,
            expirationDate = new UniversalTime(a.ValidationDate).ToString("yyyy-MM-dd"),
            documentType = Controllers.rpmdataController.DocumentType.Licence
        }).ToList()); 
```

# javascript - 1 父 2 子下拉

> ID：361922
> 
> 赞同：2
> 
> 时间：2008-12-12T04:47:38.047
> 
> 标签：javascript, drop-down-menu, parent-child

我正在尝试使用 JAVASCRIPT 创建 1 个父下拉列表，其中包含 2 个依赖子下拉列表。

我的 html 页面位于 - [http://www.larkgrove.com/entryform/entryform.html](http://www.larkgrove.com/entryform/entryform.html)

我正在使用动态选项列表/从属选择： [http ://www.javascripttoolbox.com/lib/dynamicoptionlist/examples.php](http://www.javascripttoolbox.com/lib/dynamicoptionlist/examples.php)

如果您查看我的网站，您会发现我可以让子列表在没有任何内容和“NULL”之间进行更改，但这就是我所能做的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T05:57:39.153

我知道您正在使用动态选项脚本，但我认为我会提出一个从头开始的快速解决方案。代码有点冗长，但我希望更容易看到这种方式发生了什么。最后的工作页面在这里：[http ://ryanscook.com/Files/DropDownListTest.htm](http://ryanscook.com/Files/DropDownListTest.htm)

让我们先假设你有这个 html：

```
<select id="parentList" onchange="parentList_OnChange(this)">
    <option>Choose an option</option>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
    <option value="D">D</option>
</select>

<select id="childList1"></select>
<select id="childList2"></select> 
```

你会注意到我们有一个 onchange 处理程序，这里是 java 脚本：

```
// Data for child list 1, this is a of the parent value to one or more options
var childList1Data = {
    "A": ["ChildList1 - A1", "ChildList1 - A2", "ChildList1 - A3"],
    "B": ["ChildList1 - B1"],
    "C": ["ChildList1 - C1", "ChildList1 - C2"],
    "D": ["ChildList1 - D1", "ChildList1 - D2"]
};

// Data for child list 2, this is a of the parent value to one or more options
var childList2Data = {
    "A": ["ChildList2 - A1", "ChildList2 - A2"],
    "B": ["ChildList2 - B1", "ChildList2 - B2", "ChildList2 - B3"],
    "C": ["ChildList2 - C1", "ChildList2 - C2"],
    "D": ["ChildList2 - D1"]
};

// onchange is called when the parent value is changed
function parentList_OnChange(objParentList) {
    var child1 = document.getElementById("childList1");
    var child2 = document.getElementById("childList2");

    // Remove all options from both child lists
    removeOptions(child1);
    removeOptions(child2);

    // Lookup and get the array of values for child list 1, using the parents selected value
    var child1Data = childList1Data[objParentList.options[objParentList.selectedIndex].value];

    // Add the options to child list 1
    if (child1Data) {
        for (var i = 0; i < child1Data.length; i++) {
            child1.options[i] = new Option(child1Data[i], child1Data[i]);
        }
    }

    // Do the same for the second list
    var child2Data = childList2Data[objParentList.options[objParentList.selectedIndex].value];

    if (child2Data) {
        for (var i = 0; i < child2Data.length; i++) {
            child2.options[i] = new Option(child2Data[i], child2Data[i]);
        }
    }
}

function removeOptions(objSelect) {
    while (objSelect.options.length > 0)
        objSelect.options[0] = null;
} 
```

我希望这会有所帮助，并且离您的问题不远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T05:41:39.543

好吧，首先，让我们看一下您的代码：

```
<script type="text/javascript">
var TESTLIST = new DynamicOptionList("PARENT1","CHILD1","CHILD2");
TESTLIST.forValue("A").forValue("A").forValue("A").addOptionsTextValue("C","C","D","D");
</script>
<select name="PARENT1">
    <option value="A">A</option>
    <option value="B">B</option>
</select>
<br /><br />
<select name="CHILD1"><script type="text/javascript">TESTLIST.printOptions("CHILD1")</script></select>
<br /><br />
<select name="CHILD2"><script type="text/javascript">TESTLIST.printOptions("CHILD2")</script></select> 
```

我不认为那是在做你打算做的事情，尤其是这个：

```
TESTLIST.forValue("A").forValue("A").forValue("A").addOptionsTextValue("C","C","D","D"); 
```

看看你如何多次调用 .forvalue("A") ？如果您查看代码示例，您会看到：

```
regionState.forValue("west").addOptions("California","Washington","Oregon"); 
```

我会尝试更像这样的东西：

```
TESTLIST.forValue("A").addOptionsTextValue("C","D");
TESTLIST.forValue("B").addOptionsTextValue("E","F"); 
```

# api - Hubspot 之类的网站如何跟踪入站链接？

> ID：361930
> 
> 赞同：9
> 
> 时间：2008-12-12T04:50:16.730
> 
> 标签：api, seo, screen-scraping

所有这些类型的网站都只是非法抓取谷歌或其他搜索引擎吗？
据我所知，没有“合法”的方式可以为商业网站获取这些数据。雅虎！api ( [http://developer.yahoo.com/search/siteexplorer/V1/inlinkData.html](http://developer.yahoo.com/search/siteexplorer/V1/inlinkData.html) ) 仅用于非商业用途，Yahoo! 老板不允许自动查询等。有
什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T05:58:09.517

例如，如果您想查找所有指向 Google 主页的链接，请搜索

```
link:http://www.google.com 
```

因此，如果您想查找所有入站链接，您可以简单地遍历您网站的树，并为它找到的每个项目构建一个 URL。然后向谷歌查询：

```
link:URL 
```

您将获得 Google 从其他网站到您网站的所有链接的集合。

至于这种收获的合法性，我敢肯定从中获利并不完全合法，但这从来没有阻止过任何人，不是吗？

（所以我不会想知道他们是否这样做了。假设他们这样做了。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-14T09:29:49.377

我不知道 hubspot 做什么，但是，如果您想找出哪些网站链接到您的网站，并且您没有硬件来抓取网络，您可以做的一件事是监控访问者的 HTTP_REFERER地点。例如，这就是谷歌分析（据我所知）如何告诉您访问者来自哪里。这不是 100% 可靠的，因为并非所有浏览器都设置了它，尤其是在“隐私模式”下，但每个链接只需要一个访问者就可以知道它的存在！

这通常通过将脚本嵌入到您的每个网页中来实现（通常在公共页眉或页脚中）。例如，如果您检查当前正在阅读的页面的来源，您会发现（正下方）一个脚本，该脚本向 Google 报告您的访问信息。

现在，这不会告诉您是否有没有人用来访问您的站点的链接，但是让我们面对现实吧，它们远没有人们实际使用的链接那么有趣。

# vb.net - 如何在 VB.NET 中实例化 ObjectFrame

> ID：361938
> 
> 赞同：0
> 
> 时间：2008-12-12T05:00:26.443
> 
> 标签：vb.net, office-interop

我正在尝试通过 vb.net 访问 ObjectFrame 的方法和属性。但是当我宣布这是

```
Dim objOLEObject As ObjectFrame 
```

然后尝试将其实例化为

```
ObjOLEObject = New ObjectFrame 
```

它显示如下错误：

“ **429：检索具有 CLSID {3806e95d-e47c-11-cd-8701-00aa003f0f7} 的组件的 COM 类工厂失败，原因是以下错误：80040154** ”

为了解决这个问题，我们重新安装了 MS-Office 2003 和 VS-2005，但无法得到解决方案。

谁能建议我如何在 vb.net 中声明和使用它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T05:24:46.833

确保 dll 已使用 regsvr32 注册。通过在注册表中查找 CLSID 进行验证。

确保所有相关的 dll 都可用。

我相信这是一个未注册的类错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T07:18:07.913

除了 Josh 所说的，您是否检查过所有依赖文件是否存在？

这个线程可能会有所帮助。
[http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/88a6ea68-f476-4231-822f-27fabe59f458/](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/88a6ea68-f476-4231-822f-27fabe59f458/)

# networking - 为什么 RTP 使用 UDP 而不是 TCP？

> ID：361943
> 
> 赞同：35
> 
> 时间：2008-12-12T05:07:50.440
> 
> 标签：networking, udp, protocols, voip, rtp

我想知道为什么在 RTP 中使用 UDP 而不是 TCP？主要的 VoIP 工具仅使用 UDP，因为我入侵了一些 VoIP OSS。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-12-12T05:58:56.843

正如 DJ 所指出的，TCP 是为了获得可靠的数据流，并会减慢传输速度，并重新传输损坏的数据包，以实现这一目标。

UDP不关心通信的可靠性，不会减慢或重传数据。

如果您的应用程序需要可靠的数据流，例如，从网络服务器检索文件，您可以选择 TCP。

如果您的应用程序不关心损坏或丢失的数据包，并且您不需要产生额外的开销来提供额外的可靠性，那么您可以选择 UDP。

可靠的数据包传输并没有显着改善 VOIP，事实上，在某些情况下，TCP 中的重传和指数退避等事情实际上会损害 VOIP 的质量。因此，UDP 是一个更好的选择。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-13T01:42:18.533

已经给出了很多好的答案，但我想明确指出一件事：

基本上，一个完整的数据流对于实时音频/视频来说是一件好事，但它并不是绝对必要的（正如其他人指出的那样）：

重要的事实是，一些来得太晚的数据毫无价值。应该在一秒钟前显示的帧的缺失数据有什么用？

如果您要使用 TCP（这也保证所有数据的正确顺序），那么在正确传输旧数据之前，您将无法获得更新的数据。这是双重糟糕的：您必须等待旧数据的重新传输，*而*新数据（现在已延迟）可能同样一文不值。

因此，RTP 会进行某种尽力传输，因为它会尝试及时传输所有可用数据，但不会尝试重新传输在传输期间丢失/损坏的数据 (*)。它只是继续生活，并希望更重要的当前数据正确到达那里。

(*) 实际上我不知道 RTP 的细节。也许它确实会尝试重新传输，但如果确实如此，那么它就不会像 TCP 那样激进（它永远不会接受任何丢失的数据）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-19T00:42:24.423

其他的都是正确的，但是并没有真正告诉你真正的原因。Saua 有点暗示，但这里有一个更完整的答案。

音频和视频是实时的。如果您正在听收音机或看电视，并且信号被中断，它不会从您中断的地方继续......您只是在“观察”信号流时，如果您无法观察它在任何给定的时间，你失去它。

原因，很简单。延迟。VOIP 非常努力地尽量减少从某人说话到一端的延迟量，然后你得到它，然后你的回应。否则，随着错误的发生，从人说话到接收到信号之间的延迟量会不断增加，直到它变得无用。

请记住，重传的每个延迟都必须重放，这会导致进一步的数据延迟，然后另一个错误会导致更大的延迟。唯一可行的解​​决方案是简单地删除任何无法实时显示的数据。

重传延迟 1 秒意味着从我说某事到你听到它现在是 1 秒。1 秒延迟现在意味着从我说某事到你听到它的时间为 2 秒。这是累积的，因为数据以与说话时相同的速率播放，依此类推……

RTP 可能是面向连接的，但是无论如何它都必须丢弃（或跳过）数据以跟上重传错误，那么为什么还要为额外的开销而烦恼呢？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-03-20T03:46:38.730

从技术上讲，RTP 数据包可以通过 TCP 连接交错。这里有很多很好的答案。两个额外的小点：

RFC 4588 描述了如何将重传与 RTP 数据一起使用。大多数接收 RTP 流的客户端使用缓冲区来解决网络中的抖动，该抖动通常为 1-5 秒长，这意味着有时间可用于重新传输以接收所需数据。

RTP 流量可以通过 TCP 连接交错。实际上，当这样做时，Interleaved RTP（即通过 TCP）和通过 UDP 发送的 RTP 之间的区别在于这两者在用户可用带宽不足的有损网络上如何执行。交错的 TCP 流最终会变得不稳定，因为播放器不断地在缓冲状态等待数据包到达。根据玩家的不同，它可能会向前跳跃追赶。通过 RTP 连接，您将在视频中看到伪影（拖尾/撕裂）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-12T05:14:14.437

UDP 通常用于不需要严格排序的各种类型的实时流量。这是因为 TCP 在将数据传递给应用程序之前强制执行排序（默认情况下，您可以通过设置 URG 指针来解决此问题，但似乎没有人这样做），并且在您需要的环境中，这可能是非常不可取的而不是可靠地获取旧数据，而不是获取当前的实时数据。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T05:16:22.043

RTP 对丢包相当不敏感，因此它不需要 TCP 的可靠性。

UDP 的头部开销较少，因此一个数据包可以携带更多数据，因此可以更有效地利用网络带宽。

UDP 也提供快速的数据传输。

因此，在这种情况下，UDP 是显而易见的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T13:27:30.870

除了所有其他不错且正确的答案外[，本文](http://gafferongames.wordpress.com/networking-for-game-programmers/udp-vs-tcp/)还很好地理解了 TCP 和 UDP 之间的区别。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-23T13:24:55.497

实时传输协议是一种网络协议，用于通过 Internet 传输流式音频和视频媒体，从而启用 Internet 协议语音 (VoIP)。

RTP 通常与信令协议（例如 SIP）一起使用，该协议在网络上建立连接。RTP 应用程序可以使用传输控制协议 (TCP)，但大多数使用用户数据报协议 (UDP)，因为 UDP 允许更快地传输数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T06:10:31.607

UDP 用于发送数据的任何地方，不需要在目标上准确接收的地方，或者不需要稳定连接的地方。

如果需要准确地接收数据，则使用 TCP，逐位，不丢失位。

对于视频和声音流媒体，在途中丢​​失的一些比特不会以某种方式影响结果，也就是说，流的图片中的一些像素失败，不会影响用户，在 DVD 上丢失的比特率是更高。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-11T12:52:20.113

只是一个注释：在 RTP 流中发送的每个数据包都被赋予比其前任高一号的数字。这允许目标确定是否有任何数据包丢失。如果一个数据包丢失，目的地采取的最佳行动是通过插值来近似丢失的值。重传不是一个实用的选项，因为重传的数据包太迟而无法使用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-12-15T22:22:58.233

我想快速补充一下马特 H 在回应斯托博尔的回答时所说的话。Matt H 提到 RTP over UDP 数据包可以进行校验和，因此如果它们被损坏，它们将被重新发送。这实际上是大多数 PBX 的可选功能。例如，在 Asterisk 中，您可以使用以下行在 rtp.conf 配置文件中启用/禁用 RTP over UDP 流量的校验和：

```
rtpchecksums=yes ; or no if you prefer 
```

干杯!

# python - 不同模式之间的数据比较技术

> ID：361945
> 
> 赞同：0
> 
> 时间：2008-12-12T05:09:04.133
> 
> 标签：python, sql, database

是否有技术可以比较存储在不同模式中的相同数据？情况是这样的。如果我有一个带有模式 A 的数据库，并且它将某个功能的数据存储在 5 个表中。Schema A -> Schema B 在升级过程中完成。在升级过程中，应用了一些转换逻辑，数据存储在模式 B 中的 7 个表中。我所追求的是某种验证数据完整性的方法，基本上我必须在考虑转换逻辑时比较不同的模式。缺少编写一些自定义 t-sql 存储过程来比较数据，是否有替代方法？我倾向于使用 python 来自动执行此操作，是否有任何 python 模块可以帮助我？为了更好地说明我的问题，下图是我需要比较的众多数据集之一的粗略图片，

```
Table1Src                             Table1Dest
  |                                       |
  --ID(Primary Key)                       --ID(Primary Key)
  --Property1                             --Property1
  --Property2                             --Property5
  --Property3                             --Property6

Table2Src                             Table2Dest
  |                                       |
  --ID(Foreign Key->Table1Src)            --ID(Foreign Key->Table1Dest)
  --Property4                             --Property2
                                          --Property3

                                      Table3Dest
                                          |
                                          --ID(Foreign Key->Table1Dest)
                                          --Property4
                                          --Property7 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T06:56:48.830

Make "views" on both the schemas that translate to the same buisness representation of data. Export these views to flat files and then you can use any plain vanilla file diff utility to compare and point out differences.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T05:43:31.507

基本上，您应该为两个模式版本创建对象表示，然后比较对象。如果它们都同时适合内存，则最好这样做；如果不是，您需要遍历一种表示中的所有对象，获取另一种表示中的相应对象，比较它们，然后反之亦然。

困难的部分可能是获得对象表示；您可以查看[SQLAlchemy](http://www.sqlalchemy.org/)是否可以方便地用于您的表。SQLAlchemy 原则上能够将现有的模式定义映射到对象上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T06:52:54.330

我已经成功地使用 SQLAlchemy 在一个模式和另一个模式之间迁移 - 这是一个类似的过程（如 Martin v. Löwis 所示）作为比较。特别是如果您使用 .equals(other) 方法。

# flash - flash player 在本地加载电影，就像远程上的死鱼一样

> ID：361951
> 
> 赞同：1
> 
> 时间：2008-12-12T05:14:28.040
> 
> 标签：flash

我正在尝试将 Flash 播放器加载到 html 页面上。该页面位于我的根文件夹中。flv 和 swf 都位于名为“videos”的文件夹中。

位于创建 Flash 组件的网站上的用户论坛提供了这个...确保路径指向该文件夹。对，我明白了。但我不确定在哪里可以找到路径。下面是我的html页面中播放器的代码。

我没有看到这里的路径吗？我应该直接查看 fla 文件吗？我如何编辑fla。在正确的文件夹中查找？

```
<script type="text/javascript">
AC_FL_RunContent( 'codebase','http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0','name','flvPlayer','width','890','height','480','align','top','id','flvPlayer','src','videos/flvPlayer','quality','high','pluginspage','http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash','bgcolor','#000000','scale','exactfit','movie','videos/flvPlayer' ); //end AC code
</script><noscript><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" name="flvPlayer" width="890" height="480" align="top" id="flvPlayer">
    <param name="movie" value="videos/flvPlayer.swf">
    <param name="quality" value="high"><param name="BGCOLOR" value="#000000"><param name="SCALE" value="exactfit">
    <embed src="videos/flvPlayer.swf" width="890" height="480" align="top" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" bgcolor="#000000" scale="exactfit" name="flvPlayer"></embed>
  </object></noscript> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T05:40:22.603

您的 Flash 嵌入代码看起来不错 - 您应该在两个地方都有“videos/flvPlayer.swf”。我希望此时您的 Flash 主机文件正在正确加载，但您尝试加载的视频无法正常工作。要解决此问题，您需要直接编辑 .FLA 文件以查找闪存尝试加载的路径和文件名，或者加载一个名为 Fiddler 的出色工具并在 IE 中运行该页面...您将能够查看浏览器和服务器之间来回的 Web 请求 - 您应该在 Flash 电影加载时收到 404 响应，这将显示它试图从哪里加载视频。

您可能希望有人增强 flvPlayer.swf 文件以将电影路径/名称作为 PARAM，以便可以轻松地在 HTML 中进行配置。

[提琴手网站](http://www.fiddlertool.com)

# c# - MSBuild maxcpucount > 1 导致构建错误

> ID：361955
> 
> 赞同：6
> 
> 时间：2008-12-12T05:16:01.763
> 
> 标签：c#, optimization, msbuild, multicore, multi-targeting

我正在尝试构建大约 600 个项目，有些是 .net 2.0，有些是 3.5。我正在使用带有所有最新 Windows 更新的 Windows 2003 Enterprise Edition 32 位。

当 maxcpucount 为 1 时构建良好。如果我将其提高以尝试提高性能，则会出现参考错误。当我查看发生错误的项目引用时，它们似乎应该按顺序构建。

下面我提供了一个导致构建被破坏的错误示例。不要挂断项目名称或相对路径，因为我已经更改了它，所以我不会与我的雇主发生麻烦。

这就像当一个以上的核心正在构建解决方案时，无法正确解决相关项目引用。

```
"C:\SVN\MyLibrary\MyLibrary.csproj" (default target) (15) ->
   "C:\SVN\FileProcessor\FileProcessor.csproj" (default target) (17) ->
   (ResolveProjectReferences target) ->
     C:\WINDOWS\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets : warning : The referenced project '..\..\Manager\Manager.csproj' does not exist.

   "C:\SVN\MyLibrary\MyLibrary.csproj" (default target) (15) ->
   "C:\SVN\FileProcessor\FileProcessor.csproj" (default target) (17) ->
   (CoreCompile target) ->
     FileProcessor.cs(18,39): error CS0234: The type or namespace name 'Manager' does not exist in the namespace 'TheNamespace' (are you missing an assembly reference?) 
```

我没有在解决方案文件上使用 msbuild。我使用通配符选择所有 csproj 文件，然后将它们提供给 msbuild。对于开发，我们有多种解决方案用于系统的不同组件。95% 是项目参考，唯一的二进制参考是核心实用程序库

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T17:57:56.047

为了让 MSBuild 在多核/CPU 上运行，它需要能够事先确定所有依赖项是什么。通常，这意味着您要么需要将所有项目放在一个*巨大的*解决方案中，并将所有引用设置为项目引用，要么设置多个解决方案并将它们设置为以正确的顺序构建。

听起来您现在正在运行单一解决方案版本，因此您需要确保对其他项目的所有引用都正确设置为项目引用，而不是文件路径引用。

我还没有找到使用 GUI 进行检查的好方法，因此您可能必须卸载并编辑一个未在 multicpu 中构建的项目文件才能查看 xml。

项目参考应如下所示：

```
 <ProjectReference Include="..\..\Manager\Manager.csproj">
      <Project>{C0F60D74-3EF9-4B49-9563-66E70D0DDF43}</Project>
      <Name>Manager</Name>
</ProjectReference> 
```

文件路径参考如下所示：

```
 <Reference Include="Manager.dll, Version=2.0.0.0, Culture=neutral, PublicKeyToken=e79aa50eb4f67b0c, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>....\Manager\Manager.dll</HintPath>
</Reference> 
```

看起来您至少正确设置了一些参考，因为您收到的错误消息至少有一个调用另一个项目，所以您不需要更新所有内容，只需检查给您的夫妇问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-29T17:10:01.570

我可能会很晚，你可能已经解决了这个问题。但是我遇到了同样的错误，发现这是由于我的一个项目的路径长度太大。请看[这里](http://hamidshahid.blogspot.com/2010/04/missing-reference-name-while-building.html)

# algorithm - 多边形中的孔

> ID：361966
> 
> 赞同：4
> 
> 时间：2008-12-12T05:25:56.097
> 
> 标签：algorithm, graphics, 3d, geometry

我需要创建一个立方体的 3D 模型，在一个面的中心打一个圆孔，完全穿过立方体到另一侧。我能够为面和孔生成顶点。

其中四个面（未受孔影响）可以建模为单个三角形条带。孔的内部也可以建模为单个三角形条带。

如何为有孔的面生成索引缓冲区？是否有标准算法来做到这一点？

我正在使用 Direct3D，但欢迎来自其他地方的想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T07:40:41.130

要生成所需的索引缓冲区，您可以这样做。在 2D 中思考，所讨论的脸是一个顶点为 (±1, ±1) 的正方形，而洞是中间的一个圆。

1.  你沿着圆圈的边缘走，把它分成一些段。
2.  对于每个顶点，您将其投影到周围的正方形上`(x/M,y/M)`，其中`M`是`max(abs(x),abs(y))`。`M`是最大坐标的绝对值，所以这将缩放`(x,y)`，使最大坐标为±1。
3.  这条线你也分成一些段。
4.  您成对连接的两条连续线的线段作为面。

这是一个示例，将圆细分为 64 段，每条射线分为 8 段。您可以选择符合您要求的数字。

[替代文字 http://pici.se/pictures/AVhcssRRz.gif](http://pici.se/pictures/AVhcssRRz.gif)

下面是一些演示这一点的 Python 代码：

```
from math import sin, cos, pi
from itertools import izip

def pairs(iterable):
    """Yields the previous and the current item on each iteration.
    """
    last = None
    for item in iterable:
        if last is not None:
            yield last, item
        last = item

def circle(radius, subdiv):
    """Yields coordinates of a circle.
    """
    for angle in xrange(0,subdiv+1):
        x = radius * cos(angle * 2 * pi / subdiv)
        y = radius * sin(angle * 2 * pi / subdiv)
        yield x, y

def line(x0,y0,x1,y1,subdiv):
    """Yields coordinates of a line.
    """
    for t in xrange(subdiv+1):
        x = (subdiv - t)*x0 + t*x1
        y = (subdiv - t)*y0 + t*y1
        yield x/subdiv, y/subdiv

def tesselate_square_with_hole((x,y),(w,h), radius=0.5, subdiv_circle=64, subdiv_ray=8):
    """Yields quads of a tesselated square with a circluar hole.
    """
    for (x0,y0),(x1,y1) in pairs(circle(radius,subdiv_circle)):
        M0 = max(abs(x0),abs(y0))
        xM0, yM0 = x0/M0, y0/M0

        M1 = max(abs(x1),abs(y1))
        xM1, yM1 = x1/M1, y1/M1

        L1 = line(x0,y0,xM0,yM0,subdiv_ray)
        L2 = line(x1,y1,xM1,yM1,subdiv_ray)
        for ((xa,ya),(xb,yb)),((xc,yc),(xd,yd)) in pairs(izip(L1,L2)):
            yield ((x+xa*w/2,y+ya*h/2),
                   (x+xb*w/2,y+yb*h/2),
                   (x+xc*w/2,y+yc*h/2),
                   (x+xd*w/2,y+yd*h/2))

import pygame
def main():
    """Simple pygame program that displays the tesselated figure.
    """
    print('Calculating faces...')
    faces = list(tesselate_square_with_hole((150,150),(200,200),0.5,64,8))
    print('done')

    pygame.init()
    pygame.display.set_mode((300,300))
    surf = pygame.display.get_surface()
    running = True

    while running:
        need_repaint = False
        for event in pygame.event.get() or [pygame.event.wait()]:
            if event.type == pygame.QUIT:
                running = False
            elif event.type in (pygame.VIDEOEXPOSE, pygame.VIDEORESIZE):
                need_repaint = True
        if need_repaint:
            print('Repaint')
            surf.fill((255,255,255))
            for pa,pb,pc,pd in faces:
                # draw a single quad with corners (pa,pb,pd,pc)
                pygame.draw.aalines(surf,(0,0,0),True,(pa,pb,pd,pc),1)
            pygame.display.flip()

try:
    main()
finally:
    pygame.quit() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T16:51:38.637

您想查找 Tessellation，这是处理 MizardX 所显示内容的数学领域。 3D Graphcs 中的人们必须一直处理这个问题，并且有多种 tessellation 算法来获取带孔的面部并计算渲染它所需的三角形。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T05:34:09.777

现代硬件通常无法正确渲染凹多边形。
具体来说，通常甚至没有办法定义带孔的多边形。
您需要以某种方式在孔周围找到平面的三角剖分。最好的方法可能是创建从孔的顶点到矩形面最近顶点的三角形。这可能会创建一些非常薄的三角形。如果这不是问题，那么你就完成了。如果是，那么您将需要一些网格整流罩/优化算法来创建漂亮的三角形。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T05:44:22.113

阿尔法混合是不可能的吗？如果没有，只需使用中间具有透明度的纹理对带有孔的侧面进行纹理处理。你必须做更多的多边形渲染，因为你不能利用从前到后绘制和忽略覆盖面的优势，但它可能比拥有很多小三角形更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T17:15:34.220

我想象有 4 个三角形风扇从广场的 4 个角落飞来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T07:14:58.970

只是一个想法 -

如果你喜欢作弊（就像在游戏中多次做的那样），你总是可以构造一个普通的立方体，但是你想要的两个面的纹理有一个洞（alpha = 0），然后你可以在着色器中剪辑它，或混合它（在这种情况下，您需要使用 Z 排序进行渲染）。您可以通过构造一个朝内且没有盖子的内圆柱体来获得内孔。

当然，这仅在几何对您不重要时才有效。

# powershell - 如何创建一个cmdlet？

> ID：361973
> 
> 赞同：4
> 
> 时间：2008-12-12T05:28:36.590
> 
> 标签：powershell, cmdlet, pssnapin

我已经用 c# .net 编写了我的程序。我想将其转换为 powershell cmdlet。我被指示使用 pssnapin 和 getproc 程序。任何人都可以帮助我..

问候阿伦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-05T00:01:29.540

要创建 PowerShell cmdlet，我建议您阅读Bart De Smet (B#) 撰写的[Easy Windows PowerShell cmdlet development and debugging](http://community.bartdesmet.net/blogs/bart/archive/2008/02/03/easy-windows-powershell-cmdlet-development-and-debugging.aspx)，这是创建和调试 cmdlet 的绝佳指南（正如它在锡上所说的那样！）

此外，我还发现 Professional Windows PowerShell Programming、ISBN 978-0470173930、(ISBN-10) 0470173939 非常适合创建 cmdlet 和提供程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T08:11:37.730

So, here's the PSCmdlet-Class[from medata], that you can inherit from.

```
namespace System.Management.Automation
{
    public abstract class PSCmdlet : Cmdlet
    {
        protected PSCmdlet();

        public PSHost Host { get; }
        public CommandInvocationIntrinsics InvokeCommand { get; }
        public ProviderIntrinsics InvokeProvider { get; }
        public InvocationInfo MyInvocation { get; }
        public string ParameterSetName { get; }
        public SessionState SessionState { get; }

        public PathInfo CurrentProviderLocation(string providerId);
        public Collection<string> GetResolvedProviderPathFromPSPath(string path, out ProviderInfo provider);
        public string GetUnresolvedProviderPathFromPSPath(string path);
        public object GetVariableValue(string name);
        public object GetVariableValue(string name, object defaultValue);
    }
} 
```

In order to get your cmdlets loaded, you need to sign them additionally, because Powershell does not execute not signed code.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T13:10:37.583

看看这篇文章，[在 VB 2005 中创建 PowerShell Cmdlet](http://www.codeguru.com/vb/controls/vb_shell/article.php/c13743/)。它使用 VB 2005，但过程与 C# 相同。

完全披露，我写了这篇文章，但你看它并没有得到报酬。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T06:38:25.890

安装 windows powershell 模板，您将获得 pssnapin 程序，使用它可以将您的 .cs 文件转换为 dll。然后在msdn中搜索getproc程序。我不记得确切，但会有一个方法首先执行。你用那个方法调用你的 dll 文件。我不记得代码，但这是要做的程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T13:10:51.247

PowerTime 项目 ( [http://code.google.com/p/powertime/](http://code.google.com/p/powertime/) ) 是开源的，它实现了许多 cmdlet。很好的演示让你继续前进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T13:23:59.883

还要检查[http://blogs.msdn.com/daiken/](http://blogs.msdn.com/daiken/)。特别是从 2007 年 2 月到 2007 年 6 月的所有月份。您将找到 Visual Studio 模板链接（适用于 2005 年，也适用于 Express）和几个示例/实验室。

# java - 设置默认 Java 字符编码

> ID：361975
> 
> 赞同：391
> 
> 时间：2008-12-12T05:31:21.763
> 
> 标签：java, utf-8, character-encoding

如何以编程方式正确设置 JVM (1.5.x) 使用的默认字符编码？

我读过这`-Dfile.encoding=whatever`曾经是旧 JVM 的方式。由于我不会进入的原因，我没有那种奢侈。

我试过了：

```
System.setProperty("file.encoding", "UTF-8"); 
```

并且该属性已设置，但似乎不会导致`getBytes`下面的最终调用使用 UTF8：

```
System.setProperty("file.encoding", "UTF-8");

byte inbytes[] = new byte[1024];

FileInputStream fis = new FileInputStream("response.txt");
fis.read(inbytes);
FileOutputStream fos = new FileOutputStream("response-2.txt");
String in = new String(inbytes, "UTF8");
fos.write(in.getBytes()); 
```

* * *

## 回答 #1

> 赞同：346
> 
> 时间：2008-12-12T05:56:25.507

不幸的是，`file.encoding`必须在 JVM 启动时指定该属性。当你输入 main 方法时，使用的字符编码和`String.getBytes()`默认构造函数已经被永久缓存了。`InputStreamReader``OutputStreamWriter`

正如[Edward Grech 所指出的，](https://stackoverflow.com/a/623036/3474)在这种特殊情况下，环境变量`JAVA_TOOL_OPTIONS` *可*用于指定此属性，但通常是这样完成的：

```
java -Dfile.encoding=UTF-8 … com.x.Main 
```

`Charset.defaultCharset()`会反映`file.encoding`属性的变化，但核心 Java 库中需要确定默认字符编码的大部分代码都没有使用这种机制。

在编码或解码时，可以查询`file.encoding`属性或`Charset.defaultCharset()`找到当前的默认编码，并使用适当的方法或构造函数重载来指定它。

* * *

## 回答 #2

> 赞同：181
> 
> 时间：2009-03-08T04:31:50.240

来自[JVM™ 工具接口](http://java.sun.com/javase/6/docs/platform/jvmti/jvmti.html#tooloptions)文档……</p>

> 由于不能始终访问或修改命令行，例如在嵌入式 VM 中或仅在脚本深处启动的 VM 中，`JAVA_TOOL_OPTIONS`因此提供了一个变量，以便在这些情况下可以启动代理。

通过将 (Windows) 环境变量设置`JAVA_TOOL_OPTIONS`为，每次启动 JVM 时都会自动设置`-Dfile.encoding=UTF8`(Java)属性。`System`您将知道该参数已被拾取，因为以下消息将发布到`System.err`：

> `Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8`

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2013-02-20T19:09:04.880

我有一个绝对有效的hacky方式！

```
System.setProperty("file.encoding","UTF-8");
Field charset = Charset.class.getDeclaredField("defaultCharset");
charset.setAccessible(true);
charset.set(null,null); 
```

这样，您将欺骗 JVM，它会认为未设置字符集并使其在运行时再次将其设置为 UTF-8！

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-12-12T05:39:49.533

我认为比设置平台的默认字符集更好的方法是调用更安全的`String.getBytes("charsetName")`. 这样，您的应用程序就不会依赖于超出其控制范围的事物。

我个人认为`String.getBytes()`应该弃用它，因为它在我见过的许多情况下造成了严重的问题，开发人员没有考虑到默认字符集可能会发生变化。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-12-12T05:36:04.237

我无法回答您最初的问题，但我想给您一些建议——不要依赖 JVM 的默认编码。最好在代码中明确指定所需的编码（即“UTF-8”）。这样，您就知道它甚至可以跨不同的系统和 JVM 配置工作。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-01-20T18:09:42.110

试试这个 ：

```
 new OutputStreamWriter( new FileOutputStream("Your_file_fullpath" ),Charset.forName("UTF8")) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-07-03T09:33:04.770

我尝试了很多东西，但这里的示例代码完美无缺。 [关联](http://fabioangelini.wordpress.com/2011/08/04/converting-java-string-fromto-utf-8/)

代码的关键是：

```
String s = "एक गाव में एक किसान";
String out = new String(s.getBytes("UTF-8"), "ISO-8859-1"); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-01-09T00:46:28.320

我们遇到了同样的问题。我们有条不紊地尝试了这篇文章（和其他文章）中的一些建议，但无济于事。我们还尝试添加`-Dfile.encoding=UTF8`，但似乎没有任何效果。

对于遇到此问题的人，以下文章最终帮助我们追踪描述了语言环境设置如何`unicode/UTF-8`闯入`Java/Tomcat`

[http://www.jvmhost.com/articles/locale-breaks-unicode-utf-8-java-tomcat](http://www.jvmhost.com/articles/locale-breaks-unicode-utf-8-java-tomcat)

在文件中正确设置语言环境`~/.bashrc`对我们有用。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-02-23T17:01:53.860

如果您使用 Spring Boot 并希望`file.encoding`在 JVM 中传递参数，则必须像这样运行它：

```
mvn spring-boot:run -Drun.jvmArguments="-Dfile.encoding=UTF-8" 
```

这对我们来说是必需的，因为我们使用的是`JTwig`模板，而操作系统有`ANSI_X3.4-1968`我们通过它发现的`System.out.println(System.getProperty("file.encoding"));`

希望这对某人有帮助！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-07-03T12:58:14.470

我的团队在装有 Windows 的机器上遇到了同样的问题。然后设法通过两种方式解决它：

a) 设置环境变量（即使在 Windows 系统偏好设置中）

JAVA_TOOL_OPTIONS
-Dfile.encoding=UTF8

b) 将以下代码段引入您的 pom.xml：

```
 -Dfile.encoding=UTF-8 
```

之内

```
 <jvmArguments>
 -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8001
 -Dfile.encoding=UTF-8
 </jvmArguments> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-04-24T08:59:03.217

我正在使用 Amazon (AWS) Elastic Beanstalk 并成功将其更改为 UTF-8。

在 Elastic Beanstalk 中，转到配置 > 软件，“环境属性”。添加（名称）JAVA_TOOL_OPTIONS 和（值）-Dfile.encoding=UTF8

保存后，环境将以 UTF-8 编码重新启动。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-08-07T13:52:10.217

在我的项目中解决这个问题。希望它可以帮助某人。

我使用 LIBGDX java 框架，并且在我的 android studio 项目中也遇到了这个问题。在 Mac OS 中编码是正确的，但在 Windows 10 中，特殊字符和符号以及俄语字符显示为以下问题：????? 和其他不正确的符号。

1.  更改 android studio 项目设置： `File->Settings...->Editor-> File Encodings`在所有三个字段（全局编码、项目编码和下面的默认值）中都改为 UTF-8。

2.  在任何 java 文件集中：

    `System.setProperty("file.encoding","UTF-8");`

3.  对于测试打印调试日志：

    `System.out.println("My project encoding is : "+ Charset.defaultCharset());`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-16T03:59:32.963

目前尚不清楚您在做什么，也无法控制。如果您可以在目标文件上插入不同的 OutputStream 类，则可以使用 OutputStream 的子类型，它将字符串转换为您定义的字符集下的字节，默认为 UTF-8。如果修改后的 UTF-8 足以满足您的需要，您可以使用`DataOutputStream.writeUTF(String)`：

```
byte inbytes[] = new byte[1024];
FileInputStream fis = new FileInputStream("response.txt");
fis.read(inbytes);
String in = new String(inbytes, "UTF8");
DataOutputStream out = new DataOutputStream(new FileOutputStream("response-2.txt"));
out.writeUTF(in); // no getBytes() here 
```

如果这种方法不可行，那么如果您在这里明确说明在数据流和执行环境方面您可以控制和不能控制的内容可能会有所帮助（尽管我知道有时说起来容易做起来难）。祝你好运。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-06T08:28:28.420

```
mvn clean install -Dfile.encoding=UTF-8 -Dmaven.repo.local=/path-to-m2 
```

命令与 exec-maven-plugin 一起解决了配置 jenkins 任务时出现的以下错误。

```
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512m; support was removed in 8.0
Error occurred during initialization of VM
java.nio.charset.IllegalCharsetNameException: "UTF-8"
    at java.nio.charset.Charset.checkName(Charset.java:315)
    at java.nio.charset.Charset.lookup2(Charset.java:484)
    at java.nio.charset.Charset.lookup(Charset.java:464)
    at java.nio.charset.Charset.defaultCharset(Charset.java:609)
    at sun.nio.cs.StreamEncoder.forOutputStreamWriter(StreamEncoder.java:56)
    at java.io.OutputStreamWriter.<init>(OutputStreamWriter.java:111)
    at java.io.PrintStream.<init>(PrintStream.java:104)
    at java.io.PrintStream.<init>(PrintStream.java:151)
    at java.lang.System.newPrintStream(System.java:1148)
    at java.lang.System.initializeSystemClass(System.java:1192) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-01-19T19:23:40.870

我们一起设置了两个系统属性，它使系统将所有内容都转换为 utf8

```
file.encoding=UTF8
client.encoding.override＝UTF-8 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-05T15:40:32.643

在@Caspar 对接受的答案发表评论后，根据 Sun 解决此问题的首选方法是：

“在启动 Java 程序之前更改底层平台的语言环境。”

[http://bugs.java.com/view_bug.do?bug_id=4163515](http://bugs.java.com/view_bug.do?bug_id=4163515)

对于码头工人，请参阅：

[http://jaredmarkell.com/docker-and-locales/](http://jaredmarkell.com/docker-and-locales/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-14T17:14:47.817

最近我碰到了一家本地公司的 Notes 6.5 系统，发现 webmail 在非中文本地化的 Windows 安装上会显示无法识别的字符。在网上挖了几个星期，几分钟前才弄清楚：

在 Java 属性中，将以下字符串添加到运行时参数

```
-Dfile.encoding=MS950 -Duser.language=zh -Duser.country=TW -Dsun.jnu.encoding=MS950 
```

UTF-8 设置在这种情况下不起作用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-11-05T06:36:49.317

在启动应用程序时设置 jvm 参数帮助我解决了这个问题。`java -Dfile.encoding=UTF-8 -Dsun.jnu.encoding=UTF-8`.

`file.encoding=UTF-8`- 这有助于在文件中包含 Unicode 字符。

`sun.jnu.encoding=UTF-8`- 这有助于将 Unicode 字符作为文件系统中的文件名。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2021-12-07T19:45:26.057

如果您使用的是 AZURE，请在 webapp-component.yml 中使用以下设置

```
systemProperties:
   file.encoding: "UTF8"
   client.encoding.override: "UTF-8" 
```

注意：如果您遇到编码问题，您的请求被替换为“？” 这是你的解决方案。

# algorithm - 快速排序与插入排序的平均时间复杂度

> ID：361998
> 
> 赞同：-1
> 
> 时间：2008-12-12T05:50:35.173
> 
> 标签：algorithm, sorting

我相信快速排序应该比中等大小的无序 int 数组上的插入排序更快。我已经在 java 中实现了这两种算法，我注意到快速排序比插入排序慢得多。

我有一个理论：quiksort 速度较慢，因为它是递归的，并且它对自己的方法签名的调用在 JVM 中非常慢，这就是为什么我的计时器给出的读数比我预期的要高，而插入不是递归的我们的工作是在一种方法中完成的，所以他们的 JVM 不必做任何额外的繁重工作？亚里特？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T06:00:36.683

您可能对这些[排序算法动画](http://www.sorting-algorithms.com/)感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T06:02:15.900

可能不会，除非您的递归方法进行任何大分配。您的代码中更有可能存在怪癖，或者您的数据集很小。

JVM 对递归调用应该没有任何问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T06:09:41.530

除非你遇到了快速排序的一种病态情况（通常是一个已经排序的列表），否则快速排序应该是 O(n log n)——随着 n 的增加，它比插入排序的 O(n^2) 快得多。

您可能想改用归并排序或堆排序；他们没有病理病例。它们都是 O(n log n)。

（当我很久以前在 C++ 中做这些时，快速排序比具有相当小的*n* s 的插入排序更快。Radix 在中等大小的*n* s 下也明显更快。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T06:09:25.447

理论上，对于中到大的随机数据，快速排序应该比插入排序更快。

我想差异应该在于 QS 的实现方式：

给定数据的枢轴选择？（3-median 是更好的方法）

对 QS 和插入排序使用相同的交换机制？

是输入随机 enuf，即 .，如果您有有序数据集群，性能将
受到影响。

我用 C 语言做了这个练习，结果符合理论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-27T13:04:21.503

实际上对于 n 的小值，插入排序比快速排序要好。至于 n 的小值而不是 n^2 或 nlogn 时间更多地取决于常数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T06:58:55.363

我记得在学校里，当我们用 Java 进行排序时，我们实际上会混合使用两者。所以对于像快速排序和归并排序这样的递归算法，我们实际上会对非常小的段进行插入排序，比如 10 条左右的记录。

递归很慢，所以要小心使用。如前所述，如果您能找到一种方法以迭代方式实现相同的算法，那么就这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T08:00:02.057

这里需要考虑三件事。首先，如果数据集已经排序或接近排序，则插入排序（ *O(n)* vs *O(n log n)* ）比快速排序快得多；第二，如果数据集很小，“启动时间”设置快速排序，找到一个支点等，支配其余部分；第三，快速排序有点微妙，你可能想重新阅读一夜睡眠后的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T06:08:39.833

快速排序的最快实现使用循环而不是递归。递归通常不是很快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T06:46:31.490

You have to be careful how you make the recursive calls, and because it's Java, you can't rely on tail calls being optimized, so you should probably manage your own stack for the recursion.

Everything that is available to be known about quicksort vs insertion sort can be found in Bob Sedgewick's doctoral dissertation. The boiled-down version can be found in his algorithms textbooks.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-11T14:46:32.113

您如何在 Quicksort 中选择您的支点？这个简单的事实是您问题的关键，也可能是 Quicksort 运行速度较慢的原因。在这种情况下，如果您正在寻找一些真正的帮助，最好**至少发布代码的重要部分。**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-15T04:54:34.497

实际上，对于 n 插入类型来说，插入类型比快速类型更健康。至于 n 而不是 n^2 或 nlogn 的价值很小，时间很大程度上取决于常数。 [网络开发印第安纳波利斯](http://indianapolis.fortune-softtech.com/)`**********