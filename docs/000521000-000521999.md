# StackOverflow 问答 000521000-000521999

# c# - 创建安装程序，错误文件夹路径“。” 包含无效字符

> ID：521008
> 
> 赞同：4
> 
> 时间：2009-02-06T16:32:41.010
> 
> 标签：c#, .net-3.5, installation

我正在尝试为我没有编写的项目制作安装程序，并使用向导创建设置。Program Files 文件夹包含一个 favicon.ico、一个自定义 dll 和项​​目的主要输出。

每当我构建安装程序并尝试运行它时，我都会得到一个“文件夹路径”。包含无效字符。” 并且安装程序中止。我怎样才能解决这个问题？到底是怎么回事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T17:26:59.590

找到了解决方案。在工作中，当我们安装某些东西并询问公司名称和用户名时，我们总是输入“.”，那么 Visual Studio 将公司名称用于安装项目作为 [制造商]。IE 它试图安装到 C:\Program Folder(x86).\ProjectName。为了修复它，我从 ApplicationFolder 的文件夹路径中删除了 [Manufacturer]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-30T15:58:55.447

我很不幸不得不追查这个错误。原来VS2010(SP1)在installer.vdproj的product部分把\r\n放在了“Manufacturer”前面。在“属性”部分输入的名称没有任何前导 \r\n 字符。VS2010 自己完成了这一切 :-(( 例如 "Product" { "Name" = "8:Microsoft Visual Studio" .... "Manufacturer" = "8:\r\nMyManufacturerName" ..... "ARPCONTACT " = "8:\r\nMyManufacturerName" ... } 一旦我通过在记事本中打开它取出 \r\n，一切正常。这需要很长时间才能找到。但是我已经开始期待这种微软的劣质产品（我什至不是在谈论 WPF）。

# javascript - jQuery：从回调中选择父属性

> ID：521017
> 
> 赞同：1
> 
> 时间：2009-02-06T16:36:00.940
> 
> 标签：javascript, jquery, dom

鉴于此 html 代码：

```
<td><img class='del' id='4' src='images/delete.gif'></td> 
```

我无法理解如何完成以下代码：

```
$(document).ready(
    function(){ 
        setup();                            
    }
);

function setup(){
    $("#deleteForm").hide();
    $("img.del").bind('click', formDisplay);
}   

function formDisplay(){
   $("#deleteForm").show();
} 
```

在这里，我需要将`id`图像元素的属性值传递给回调，但是我在理解jQuery 中的工作方式`this`或工作方式方面存在一些问题`$('this')`

更好的是，我想以这种方式使用 html 代码：

```
<tr id='4'>
   <td>...</td><td>...</td><td><img class='del' src='images/delete.gif'></td>
</tr> 
```

能够从回调中获取由其 id 标识的元素的每个子*元素*的`<tr>`值。

 *有人有什么建议吗？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T16:43:24.683

只需重新格式化本德威的答案：

```
jQuery(function($) {
    $("#deleteForm").hide(); 
    $("img.del").click(function() { 
        $("#deleteForm").show();
        $(this).attr('id');  // this is the image Id
    })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T16:40:12.087

```
$(document).ready( function(){ 
    setup(); 
});

function setup() { 
    $("#deleteForm").hide(); 
    $("img.del").bind('click', formDisplay); 
} 

function formDisplay() { 
    $("#deleteForm").show();
    $(this).attr('id');  // this is the image Id
    $(this).closest('tr').attr('id');  // this is the tr Id
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T14:42:03.913

这是一个小例子。此方法适用于任何父标签。

如果三个按钮都一一点击，输出应该是（注意console.log()是Firebug函数，如果没有安装Firebug可以用alert代替）：

*   时间
*   div
*   身体

请注意最后的结果。在这种情况下，没有表的 TD 不被视为父级。

这是代码：

```
<body class="body">

<script type="text/javascript">

    $(document).ready(function(){
        setup();
    });

    function setup() {
        $("#deleteForm").hide();
        $("img.del").click(formDisplay);
    }

    function formDisplay() {
        $("#deleteForm").show();
        var p = $(this).parent(); // parent tag
        p.attr('id');  // this is the image id -- what you need
        console.log(p.attr("class")); // show parent element class to show difference
    }

</script>

<table class="table">
<tr class="tr">
<td class="td"><img class='del' id='4' src='images/delete.gif'></td>
</tr>
</table>

<div class="div"><img class='del' id='5' src='images/delete.gif'></div>

<td class="td"><img class='del' id='6' src='images/delete.gif'></td>

<div id="deleteForm">text</div>

</body> 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T16:44:05.027

像这样的东西（为了清楚起见，删除了方法结构）：

```
$(document).ready(function(){
    $("deleteForm").hide();

    $("img.del").click(function(){
        $("#deleteForm").show();
        $(this).id; // I can't remember if this is cross-platform or not, but you get the idea...
    }
}); 
```

# .htaccess - .htaccess 重定向到子目录中的脚本

> ID：521019
> 
> 赞同：0
> 
> 时间：2009-02-06T16:36:07.727
> 
> 标签：.htaccess, redirect, subdirectory

我需要将 .htaccess 重写规则重定向到子目录根目录中的脚本，但仅适用于该子目录中的任何文件/目录...

```
/
/subdir/
   /index.php
   /somedir/
   /anotherdir/ 
```

对于上面的结构，我希望任何浏览到 /subdir 的人都去 /subdir/index.php，任何人去 /subdir/somedir/ 到 /subdir/index.php 等等...

但是，如果它们转到根目录。他们应该留在那里......我已经尝试将一个 .htaccess 文件放在 /subdir 中，并尝试了一堆重写规则，但到目前为止没有任何工作。

**更新：**我的意思不仅仅是*/somedir/*需要重定向 ot index.php，而是*/subdir/*的任何子目录都需要重定向......脚本也是如此，但显然不是*/subdir/index.php*

抱歉我之前没有说清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T21:51:27.980

如果我理解你的问题，唯一需要发生的实际重定向是如果有人去 /subdir/somedir （将他们重定向回 index.php

如果是这种情况，这应该可以工作，放入/.htaccess：

```
redirect /subdir/somedir/ /subdir/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:01:42.357

如果你只想要一个内部重定向，试试这个[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)例子：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !^/subdir/somedir/index\.php
RewriteRule ^subdir/somedir/ subdir/index.php [L] 
```

对于外部重定向，只需添加`R`标志（带有可选的重定向状态代码：`R=`*`xxx`*；默认值：302）：

```
RewriteRule … [L,R=xxx] 
```

# silverlight - Silverlight 根标记应该是 UserControl 还是 Canvas？

> ID：521021
> 
> 赞同：5
> 
> 时间：2009-02-06T16:36:39.877
> 
> 标签：silverlight

我正在阅读 2008 年 10 月发布的 Silverlight 2 Unleashed，其中包含带有根画布标签的示例：

```
<Canvas xmlns="http://schemas.microsoft.com/client/2007"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Background="Red"
    Width="500"
    Height="300">
        <Ellipse Width="400"... 
```

然而，当我在 VS2008 中创建一个新的 Silverlight 应用程序时，我得到一个 UserControl 根标签：

```
<UserControl x:Class="TestFirst.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White"... 
```

当然，我可以通过用 Canvas 替换根标记来更改这一点，但是我还必须更改后面的代码以从 Canvas 而不是 UserControl 继承，并且必须取出 InitializeComponent 方法。

*   是使用 Canvas 标签作为根标准，还是这本书正在讨论创建 Silverlight 应用程序的另一种方法？
*   使用 Canvas 而不是 UserControl 作为根元素有什么好处？
*   为什么本书的第一个示例会以与 Visual Studio 中默认提供的方式不同的方式创建 silverlight 应用程序？
*   有没有办法在 Visual Studio 中默认生成一个画布标签作为根标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T07:20:43.260

断章取意，在 XAML 文档中使用 Canvas 作为根可能看起来很奇怪。但是，在本书中，当我们在名为 SilverlightPad 的在线工具中演示第一个 XAML 示例时使用了它。在这种情况下，没有代码隐藏，只有 XAML，因此您不需要更改类文件中的任何内容（因为没有）。

关键是，任何 XAML 元素都可以用作 XAML 文档的根。Visual Studio 通过创建 UserControl XAML 根并将其链接到 Code-Behind 中的 UserControl 类实际上是更通用方案的一个特例。我同意这是读者大部分时间都会遇到的问题，但我也相信展示事情可以有所不同的价值。此外，重要的是要表明有时没有代码隐藏，即使没有代码隐藏类的“帮助”，XAML 也是一种具有多种功能的语言。

Silverlight 2 Unleashed 使用几乎从零开始的进度，并且具有（相当陡峭的）学习曲线。如果你继续阅读，你会看到我们在本书稍后部分开始使用 Visual Studio，事情会变得更加熟悉。但是，您会看到可以使用其他元素作为根，并且我认为这具有教育价值。

如果您有任何其他问题，请随时在此处发布或给我发送电子邮件。

干杯，劳伦特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:12:30.043

我认为这本书可能做错了什么。实际上，书籍往往会这样做。

通常，您的用户控件应将 UserControl 作为其根。如果您碰巧需要一个 Canvas 来为整个控件绘制坐标位置，请将 Canvas 作为 UserControl 的第一个子项。[编辑：] 在您的第二个示例中，将 Grid 替换为 Canvas - 但同样，仅当您真的需要 Canvas 时！

Canvas 是一个范围很窄的面板；它明确用于坐标位置绘图，不应用于除此之外的**任何内容**。如果您正在执行任何类型的输入控件，请使用 Grids、DockPanels 和/或 StackPanels 的组合。甚至可能在您的 TextBoxes 附近用于漂亮的小动画的画布。:)

关键是你应该缩小你的范围。如果您从 Canvas 开始做任何事情，当您尝试处理控件的所有复杂定位时，您最终会感到痛苦。

# statistics - 使用 Awstats 生成 Liferay 门户的使用统计信息

> ID：521025
> 
> 赞同：2
> 
> 时间：2009-02-06T16:36:51.890
> 
> 标签：statistics, liferay, portal, awstats

有没有人尝试使用[Awstats](http://awstats.sourceforge.net/)为[Liferay](http://www.liferay.com)门户生成使用统计信息？

你能分享你的经验吗？

除了 Awstats 和 Google Analytics 之外，还有其他方法可以为 Liferay 门户生成统计信息吗？（我不能使用 Google Analystics，因为它是一个受限的内部门户）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T18:12:58.037

您最好的选择是使用 Awstats 来解析 Web 服务器日志（Apache、IIS 或任何运行它的平台）。如果 Liferay 创建它自己的日志，您可以配置 Awstats 来解析自定义日志格式。有关阅读自定义日志的提示，请参见此处：

[http://awstats.sourceforge.net/docs/awstats_faq.html](http://awstats.sourceforge.net/docs/awstats_faq.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:28:28.620

我从未使用过 Liferay 门户，但设置 AWstats 非常简单。假设您在 Debian 上运行 Apache，只需`apt-get install awstats`将默认配置文件复制`/etc/awstats/`到虚拟主机的新文件中即可。您只需要编辑 LogFile、SiteDomain、HostAliases 和 DirData 文件夹。显然，您需要启用 mod_perl。

我最近在自己的网站上设置了它，发现[Sami Dalouche](http://www.dalouche.com/wordpress/2006/11/22/howto-apache2-awstats-setup-on-debianubuntu-edgy-eft/)的这篇文章非常有帮助。[我还写了一篇关于如何为 Nginx 日志设置它的](http://blog.aczid.nl/2009/01/22/setting-up-awstats-to-parse-nginx-log-files-served-from-apache)博客。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T14:36:32.463

附带说明一下，在内部使用 Google Analytics 应该不会有很多问题（如果我正确理解您的情况）。如果用户在访问您的内部网页时可以访问互联网，Google Analytics（分析）代码仍应触发并记录统计信息。（由于代码在客户端上运行 - 只有他们需要访问互联网）。我们使用这个设置来监控我们的 Intranet 的用户统计数据就好了。

关于AWStats。我在解析 Apache 日志文件方面取得了相当大的成功。GA 中的额外信息非常有用，但有时可以帮助您掌握用户 PC 的人口统计和平均设置。

# rss - 如何以编程方式确定 RSS 提要是完整提要还是部分提要

> ID：521033
> 
> 赞同：10
> 
> 时间：2009-02-06T16:38:51.293
> 
> 标签：rss

我需要以编程方式确定 RSS 提要是公开其文章的全部内容还是仅公开它们的摘录。你会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T16:43:51.890

在末尾查找“更多”、“继续”、“全文”、“...”或类似内容的链接。除非您想关注页面上的每个链接，并从提要中查找文本，否则可能还会额外添加。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T16:47:04.240

我认为没有一种非常干净的方法可以做到这一点，但这里有两个“hacky”方法：

我会解析 RSS 的文本，并寻找其中的任何链接。当然，那里可能有多个链接（一些链接到其他博客文章），但如果你专注于最后一个，并尝试为链接标题想出一些启发式的词（即“更多”、“阅读全文“等），你应该能够得到很多。为了更有信心，您只能查看指向原始博客的链接。

更严格的方法是让您跟踪所有链接并尝试比较 RSS 片段是否是返回页面的子集，或者是否存在大量重叠。每当网站使用真实的摘要而不是完整帖子的片段时，这可能无济于事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T16:47:31.760

为什么不跟随 rss-feed 中的 url 并检查此页面上的文本是否比 rss-feed 中的更多？您需要使用 html-parser 并输入一些一般规则。

# c# - 如何设置与单击一次应用程序的文件关联？

> ID：521038
> 
> 赞同：11
> 
> 时间：2009-02-06T16:39:29.280
> 
> 标签：c#, clickonce, file-association

我有一个点击一次的应用程序。

我有一个关联文件，用于存储应用程序的数据。

当用户单击其中一个文件时，我希望它打开 click-once 应用程序并加载文件。

我可以在发布中设置文件关联，图标和名称设置正确。单击文件打开应用程序，但应用程序似乎没有传递文件的路径 - 命令参数为空。

如何获取它以便将文件的路径传递给应用程序？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-06T17:04:28.293

使用 Click Once 时，参数不会在命令行中传入，而是通过 Click Once 部署系统传入：

```
AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData 
```

例如，在您的 Program.cs 文件中：

```
foreach (string commandLineFile in AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData)
{
    MessageBox.Show( string.Format("Command Line File: {0}", commandLineFile) );
} 
```

希望这可以帮助。

# browser - 小书签拖动到工具栏时如何设置图标/图标？

> ID：521040
> 
> 赞同：113
> 
> 时间：2009-02-06T16:39:51.477
> 
> 标签：browser, icons, bookmarklet, favicon

我给自己做了一个小书签，它的功能很好，但是当添加到 Opera 或 Firefox 的工具栏时，它只是采用浏览器的默认书签图标（分别为地球和星形）。我的站点有一个图标，窗口、选项卡甚至 [站点] 书签都使用我指定的图标。只是不是我的书签。

如何对我的网站或书签进行编码，以便书签也可以获取网站图标？

我知道用户可以在事后使用各种手动黑客技术来设置网站图标，但这些都是不受欢迎的解决方案。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2016-11-05T14:59:57.160

您可以这样做：

1.  将您的小书签拖到书签栏。
2.  在它旁边创建一个站点的书签，您想将其用于您的书签。
3.  打开书签管理器，单击组织下拉菜单，然后选择导出，将书签保存为 html 文件。
4.  在文本编辑器中打开该 html 文件。
5.  找到您刚刚创建的**书签**，比如说它的 Gmail 书签，您应该有一个 html 代码，如下所示：

`<DT><A HREF="http://mail.google.com/mail/u/0/#inbox" ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABV0lEQVQ4jdWQzUoCYRiFnxl/0plso0IKX7mqXWCLIlq0qEW4d19Qi6BLCELwEgpvQbyAVrroCrSNUJFGAyrkEEEMNs5PCxtRHGsZneX7nedwzgd/LQngObfnykIQOj9Disd/BFxdZ3hVwtE0Mje3kuw9OJqGWSji1BtzYafeGHk0jTdzCIA8aXANA/O6hFWuzMBWuYJ5XcI1DF6MAY8fxmxAYHdnZK7WMAtFXF3H1XXMQhGrWsN2XR5WM/QGn2MmOBkQOj5CFoJhuTKe5DUzbJvW1jbWZhbqd/4BAIGDfSQhGH7XBehLMlruEGlFzEyTZy6AvL5G+PICWQja6iJaPu8L+zbw9B4MYpyeEB4MkF7782z+AZ1OD0WNkk4vA7AUi/HUav8eYNsOnW6XZCJBJLIwvieTcVQ1SrN5j2XbUwFTf9DpdkmnUlOwJ0VRyGY3UBVl7px/qi+cdYQvZvKCUwAAAABJRU5ErkJggg==">Gmail</A>`

6.  复制整个 ICON 标签
7.  在同一个文件中找到您创建的书签，并将您复制的 ICON 标签插入到您的**书签**标签中：

`<DT><A HREF="javascript:(function(){... bookmarklet JS code...})();" ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABV0lEQVQ4jdWQzUoCYRiFnxl/0plso0IKX7mqXWCLIlq0qEW4d19Qi6BLCELwEgpvQbyAVrroCrSNUJFGAyrkEEEMNs5PCxtRHGsZneX7nedwzgd/LQngObfnykIQOj9Disd/BFxdZ3hVwtE0Mje3kuw9OJqGWSji1BtzYafeGHk0jTdzCIA8aXANA/O6hFWuzMBWuYJ5XcI1DF6MAY8fxmxAYHdnZK7WMAtFXF3H1XXMQhGrWsN2XR5WM/QGn2MmOBkQOj5CFoJhuTKe5DUzbJvW1jbWZhbqd/4BAIGDfSQhGH7XBehLMlruEGlFzEyTZy6AvL5G+PICWQja6iJaPu8L+zbw9B4MYpyeEB4MkF7782z+AZ1OD0WNkk4vA7AUi/HUav8eYNsOnW6XZCJBJLIwvieTcVQ1SrN5j2XbUwFTf9DpdkmnUlOwJ0VRyGY3UBVl7px/qi+cdYQvZvKCUwAAAABJRU5ErkJggg==">MyBookmarklet</A>`

8.  保存此文件
9.  返回 Chrom Bookmarks Manager，再次单击 Organize，然后选择 Import
10.  导入您刚刚编辑的 HTML 文件，**您的书签现在有一个 favicon**。

基本上，该过程是获取书签标签的 ICON 属性**并将**其插入到**书签**标签中

[![在此处输入图像描述](https://i.stack.imgur.com/ppZOP.png)](https://i.stack.imgur.com/ppZOP.png)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-27T00:34:30.587

小书签使用`javascript://`模式，因此没有可以从中加载网站图标的域。

因此，目前您无法为书签提供 favicon。可以这样想：记住整个 Javascript 沙箱——Javascript 可能无法访问其运行的网页域之外的任何内容？一个小书签需要绑定到您正在观看的当前页面的任何域，不能也绑定到您自己网站上的网站图标。

更新：根据 Hans Schmucker 的回答，有可能创建一个书签，当浏览器将其加载到书签菜单中时，它将生成一个带有 favicon 的 HTML 文档。推理似乎可行，但我还没有看到这样的事情在起作用，而且我的测试结果为阴性。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-06-17T13:19:36.320

That's not quite right: A bookmarklet has no domain, but it has a location (which is the bookmarklet itself) and you can assign an icon to that. After that it's a matter of how the browser saves icons (Firefox saves a bookmark's icon permanently, you may not be so lucky with other browsers).

P.S. Security doesn't even play into it, icons can come from anywhere. There is no restriction.

See [http://www.tapper-ware.net/blog/?p=97](http://www.tapper-ware.net/blog/?p=97)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-03-25T19:08:47.950

在阅读了 tapper[ware] 和 Restafarian 网站后，这是我能想到的最简单的解决方案：

```
<a href="javascript:

var title = window.location.href;

if (title.indexOf('http://yourwebsite/bookmarklet/') == 0) {
    '<head><link rel=\'shortcut icon\' href=\'favicon.ico\'></head>Bookmarklet';
} else {
    (function(){document.body.appendChild(document.createElement('script')).src='http://yourwebsite/bookmarklet.js';})();
}">Click Me!</a> 
```

在 Chrome 和 FF 中运行良好，但 FF4 是唯一可以将图标保存在书签栏中的浏览器。这是它的样子：[http ://cl.ly/5WNR](http://cl.ly/5WNR)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-09-20T04:12:22.403

根据[Wizek 的建议](https://stackoverflow.com/questions/521040/how-to-have-favicon-icon-set-when-bookmarklet-dragged-to-toolbar#40839402)，您可以将代码放入数据 uri。

```
data:text/html;charset=utf-8,
<html>
<link rel="shortcut icon" href="https://stackoverflow.com/favicon.ico">
<script type="text/javascript">
    alert('It works!')
</script></html> 
```

并将所有这些保存为书签。（**试试看！**将代码拖到标签栏中）

不幸的是，它只适用于某些情况（更多下文）。

**这个怎么运作：**

（至少在 Chrome 中）它类似于使用`javascript: "<html>...your html code here, including a javascript tag that will run when loaded...</html>"`其他解决方案建议的格式的书签。在这种情况下，您所在页面的 html*将被*书签中的 html 替换，但*位置保持不变*，并且书签本身仍然没有位置，因此 Chrome 无法为其保存网站图标。

相反，使用 data-uri 书签*，我们可以转到另一个页面*，它有自己的位置，浏览器可以为它保存一个 favicon。将其视为“在浏览器中托管网站”，如果您同步书签，您就可以在其他计算机上访问它。如果您想将所有内容都保留在本地，您还可以为网站图标使用 base64 图像而不是 url。

它有局限性。

*   当您单击它时，它会离开当前页面并在*data*中加载该页面。因此，您将无法将它用于与当前页面交互的 bookmarlets，只能用于您可以在不同页面中执行的代码。

*   不要使用 // 进行评论。由于它们都将保存在一行中，因此将它们包装在 /**/ 中，并且不要忘记您的分号

*   在 FF 中，它保存了 favicon，但如果我想使用 window.open()，我无法将其设置为始终打开弹出窗口，因为它不允许我保存数据 url 的默认行为

* * *

**举个例子：**

使用这种技术，我创建了一个带有图标生成器的小书签。您可以将此代码拖到您的 URL 栏中（或将其保存为书签）以使用它。这是一个简单的页面，有一个代码输入区域和一个图标，然后生成一个带有图标的书签

```
data:text/html;charset=utf-8,<html><head>
    <title>Bookmarklet With Icon Generator</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" ></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" >
    <link rel="shortcut icon" href="https://www.freefavicon.com/freefavicons/objects/plain-thumbs-up-152-237293.png">
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h2>Write your javascript  and specify a favicon, then drag the button to your bookmarks bar</div>
                </h2>
        <a id="bookmarkbutton" href='' ondragend='this.click()' draggable="true" class="btn btn-primary btn-lg" role="button"> 
            Drag me to your bookmarks bar! </a><br /><br />
        <div> 
            <label for="fav_href">Favicon:</label>
            <input id="fav_href" value='https://stackoverflow.com/favicon.ico' style='width:100%'></input> </div><br />
        <div>
            <label for='ta'>Write your JavaScript below</label>
            <textarea id="ta" style="width:100%;height:50%">
setTimeout(()=>{            &%2313
    alert('hello world');   /*Use this format for comments, use %2523 instead of hash (number sign)*/ &%2313
    window.history.back();  &%2313
},200);
            </textarea></div>
  </div>
    <script type = "text/javascript">
        fav_href.onchange = ta.onchange = function(){
            bookmarkbutton.href = 'data:text/html;charset=utf-8,<html><head>'+
                '<link rel="shortcut icon" href="'+ fav_href.value +'">'+
                '<script type="text/javascript"> '+ ta.value +'<\/script>';
            };
        ta.onchange();
    </script>
</body> 
```

**另一个示例：**在自己的小窗口中打开 Facebook Messenger 的书签（如果您的浏览器默认阻止弹出窗口，可能无法正常工作）

```
data:text/html;charset=utf-8,
<html>
    <link rel="shortcut icon" href="https://facebook.com/images/messengerdotcom/favicon/favicon.ico">
    <script type="text/javascript">
        url = 'https://www.messenger.com/';
        w = 740; h = 700;
        x = parseInt( screen.availWidth/2 - w/2 );
        y = parseInt( screen.availHeight/2 - h/2 );
        nw = window.open(url,'', 'width='+ w +',height='+ h +',top='+ y +',left='+ x);
        nw.focus();
        setTimeout(()=>{ 
          window.history.back();
          window.close();  
        },200);
    </script> 
```

* * *

**获取书签图标的其他 Chrome 解决方法：**

*   导出书签栏，对其进行编辑并再次导入，如本答案中所述[https://superuser.com/questions/212722/how-can-i-add-a-favicon-to-a-bookmarklet-in-谷歌浏览器](https://superuser.com/questions/212722/how-can-i-add-a-favicon-to-a-bookmarklet-in-google-chrome)

*   将小书签变成扩展。它不再是一个小书签，但它具有相同的功能。这是一个简单的网站，可以为您完成[http://sandbox.self.li/bookmarklet-to-extension/](http://sandbox.self.li/bookmarklet-to-extension/)然后只需将图标文件更改为您想要的。这样做的缺点是扩展会用完 ram（简单的大约 10mb？），如果你有很多和很少的 ram，它可能不是你的解决方案。此外，您不会有书签中的文本，只有图标。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-08-13T12:59:52.927

这是一种很好的技术，几乎可以满足您的需求。

在我的 Mac 上运行良好✅，但我无法让它在 Windows 7⃣ 上运行。❌</p>

使用“表情符号”。它们是 Unicode 字符，恰好也看起来像彩色图标。您只能从预定义的图像列表中进行选择，但实际上，如果您想要做的只是给用户一些可以查看的内容以提醒他们小书签的作用，那么这还不错。

例如，我正在制作一些“安全密钥”书签。所以我在我的书签名称中使用！

所以基本上你会在书签栏中看到图像

使用此站点可帮助您找到适用于您的书签的表情符号：http: [//emojipedia.org/symbols/](http://emojipedia.org/symbols/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-11T15:36:12.713

可以使用 javascript 和 canvas 分配和修改 favicon（请参阅令人惊叹的 favicon 游戏[Defender of the Favicon](http://www.p01.org/releases/DEFENDER_of_the_favicon/)）。游戏的源代码将帮助您做到这一点（它基本上依赖于在画布上使用 toDataUrl() 函数，如源代码的第 554 行所示）。

```
// set favicon
if( !stupidBrowser && useIcon )
{
     var    icon=$('favicon');
     (newIcon = icon.cloneNode(true)).setAttribute('href',ctx.canvas.toDataURL());
     icon.parentNode.replaceChild(newIcon,icon);
} 
```

当以这种方式设置网站图标的书签被单击或保存时会发生什么？我不知道，但试一试可能会很好。浏览器可以保存吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-02T00:40:59.763

我认为一种可能的方法是在书签锚中使用 unicode char，例如您的图标：

[http://unicode-table.com/en/#cyrillic](http://unicode-table.com/en/#cyrillic)

筛选所有可能的符号，您可能会发现与您想要的图标更相似的字符

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-28T07:49:52.677

因此，这还不是一个完整的解决方案，但可能是朝着工作方向迈出的一步。

`data:``data:`令我惊讶的是，在 -uri 编码的 html中对图标进行编码可以正常工作。

```
data:text/html;charset=utf-8, <title>Separator Tab</title><link rel="shortcut icon" href="data:image/png;base64,AAABAAEAEBAAAAEAIAAoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/5aWlv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP+Wlpb/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/lpaW/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/5aWlv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP+Wlpb/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/lpaW/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/5aWlv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP+Wlpb/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/lpaW/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/5aWlv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP+Wlpb/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/lpaW/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/5aWlv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACWlpb/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" /> Separator Tab 
```

既然是这样`<html>`，我们也可以`<script type="javascript">`在那里运行。

对于某些小书签来说，这可能已经绰绰有余了。对于其他想要修改当前页面或至少在打开新标签之前从中获取一些信息的人来说，运气不好。如果我找到办法，我会更新这个答案。

# sql - 在 SQL 中，使用 DISTINCT 如何影响性能？

> ID：521055
> 
> 赞同：7
> 
> 时间：2009-02-06T16:42:34.310
> 
> 标签：sql, ms-access, performance

我正在尝试选择一个不同的列表，其中在多个字段上创建重复项。例如，

```
SELECT tablename.field1Date, 
       tablename.field2Number, 
       tablename.field3Text 
FROM tablename; 
```

将分别选择日期、数字和文本字段上的重复记录。

现在，当我选择不同的记录来提供我正在寻找的内容时，性能似乎急剧下降。

```
SELECT DISTINCT tablename.field1Date,
                tablename.field2Number, 
                tablename.field3Text 
FROM tablename; 
```

这有什么已知的原因吗？我必须承认我使用的是 MS Access 2003，这可能是问题所在。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T16:44:44.510

是的，基本上它必须对结果进行排序，然后重新处理以消除重复项。这种剔除也可以在排序过程中完成，但我们只能推测代码在后台是如何工作的。您可以尝试通过创建由所有三 (3) 个字段组成的索引来提高性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T16:57:35.593

此页面包含有关提高查询性能的提示以及有关使用性能分析器的一些信息。它会告诉您是否需要任何索引。

[http://support.microsoft.com/kb/209126](http://support.microsoft.com/kb/209126)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T16:47:21.260

是的，应用程序需要将每条记录与“不同的”记录缓存进行比较。您可以通过使用索引来提高性能，尤其是在数字和日期字段上。

# interpreter - 持续传递风格与积极削减调用堆栈？

> ID：521057
> 
> 赞同：3
> 
> 时间：2009-02-06T16:42:39.210
> 
> 标签：interpreter, continuations, trampolines

我正在考虑将 CPS 之类的东西用于基于演员的语言的解释器中。

函数参数在变量数组中传递，延续在同一个数组中返回，所以一个简单的函数

```
def add (x,y) => x + y 
```

所以来自 read/eval/loop 的调用将是

```
print( add(7, 5) ) 
```

入境时会是

```
[&add, x, y, &print, _, &repl, ...] 
```

其中 _ 是写入函数返回值的空槽。

在执行的下一步，参数变为

```
[&print, 12, &repl, ...] 
```

然后

```
[repl, ...] 
```

等等。C中的实现基本上是

```
for (;;)
   args = (args[0].function_pointer)(args); 
```

检查是否超出 args 数组的末尾并分配更多空间。

参数是连续的，作为对象的“延续”只是参数的一个子集。

如果我要实现一流的延续，他们将需要克隆参数数组；您也不会免费获得关闭。主要目标是与简单的机器代码生成配合得很好，并让您暂停和恢复执行。

虽然这个方案的灵感来自于对 CPS 的思考，但它并不完全是 CPS，并且非常类似于经过积极修剪的 C 堆栈可能看起来的样子——只是活动变量和每个函数的返回点。

这种风格有名字吗，特别是参数数组？这是一种蹦床+一个堆栈，尽管我习惯于调用“堆栈”更多的是历史而不是执行的未来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-03T22:36:57.543

这几乎是Forth。拥有一流的堆栈就像拥有延续一样。

# ruby-on-rails - 在 Rails 中创建关联对象时出错

> ID：521062
> 
> 赞同：1
> 
> 时间：2009-02-06T16:43:48.070
> 
> 标签：ruby-on-rails, associations

我有一个创建操作，它试图一次性创建评级和程序：

```
 def create
    @rating = current_user.ratings.create(params[:rating])
    @rating.create_programme(params[:programme])
    redirect_to ratings_path
  end 
```

在此代码中，评分属于用户和程序以及用户

```
 has_many :ratings
  has_many :programmes, :through => :ratings 
```

和一个程序

```
 has_many :users, :through => :ratings
  has_many :ratings 
```

当我在 RatingsController 中调用上面的创建操作时，由于某种原因，程序没有被保存为由 @rating 拥有。所以，如果我打电话给例如：

```
rating.programme.channel 
```

在视图中的评级上，它告诉我该程序是一个 nil 对象。但是，该程序已保存完好 - 只是尚未保存的关联。我敢肯定这是一个非常基本的东西，但我无法弄清楚。有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T19:48:13.483

回答您的问题以帮助使代码更清洁：

```
def create
  @rating = Rating.new(params[:rating])
  @rating.user      = curent_user
  @rating.programme = Programme.find_or_create_by_title(params[:programme])
  @rating.save

  redirect_to ratings_path
end 
```

首先，您为标题调用 find_or_create 然后保存它，但记录将在那里创建，因此保存根本不做任何事情。其次，虽然关联代理在轻松创建相关对象方面很酷，但在像您这里这样更复杂的关系中它们可能会变得非常多毛，并使代码更难阅读。

因此，与其使用关联代理来创建记录，不如直接分配更好。它更容易一目了然地知道发生了什么以及信息来自哪里，并且不需要在那里进行丑陋的合并调用。它有点长，但我认为它更容易一目了然。

最后，您可能不需要`@programme`作为独立的实例变量，因为您可以从`@rating.programme`视图中轻松访问该对象。在大多数情况下，最好传递尽可能少的实例变量，尤其是当对象具有易于访问的直接关系时。在这种情况下尤其如此，因为您根本没有渲染模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T17:05:19.303

您的代码看起来正确。试试这个。在点击此创建操作后立即进入您的脚本/控制台并查看发生了什么。类型：

```
Rating.last 
```

它应该返回刚刚创建的评级。在输出中查找`user_id`和`programme_id`查看它们是否已设置。如果是，那么您在其他地方就有错误。也许您没有查看您认为自己的评级或其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:27:14.753

好吧，您正在尝试从孩子创建父母（评级属于程序，对吗？）。我认为这行不通。

Programme.ratings.create 会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T14:57:08.533

我的创建操作可以正常使用以下内容。如果有人能让我知道是否有更优雅的方法可以让它工作，将不胜感激:)

```
 def create
    @programme = Programme.find_or_create_by_title(params[:programme])
    @programme.save
    @rating = current_user.ratings.create!(params[:rating].merge(:programme_id => @programme.id))
    redirect_to ratings_path
  end 
```

安迪

# silverlight - 如何从 Silverlight 2.0 应用程序中的 silverlight 控件打开 CD 中的 zip 文件？

> ID：521064
> 
> 赞同：0
> 
> 时间：2009-02-06T16:44:03.857
> 
> 标签：silverlight, cd

我们有一个 silverlight 应用程序，我们试图从中打开一个放在 CD 中的 zip 文件。任何人都可以告诉如何从 SilverLight 控件的 CD 的本地路径打开 .zip 文件。

谢谢和问候，Sheetal

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T17:30:47.490

为了在没有用户干预的情况下访问文件，您需要使用[隔离存储](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage(VS.95).aspx)。

要访问独立存储之外的文件，您需要使用[打开文件对话框](http://www.silverlightexamples.net/post/Open-File-Dialog-in-Silverlight.aspx)。

# sharepoint - SPListItem.Properties DateTime 字段采用奇怪的十六进制格式

> ID：521078
> 
> 赞同：3
> 
> 时间：2009-02-06T16:47:37.967
> 
> 标签：sharepoint

有谁知道如何将这些字符串十六进制值转换回 DateTime 值？

属性 my_DateProperty (System.String) = 0x01c9874e|0x98f28800

```
//l_item is SPListItem          
Hashtable l_properties = l_item.Properties;
if (l_properties != null)
{
    object l_value = null;
    foreach (string l_key in l_properties.Keys)
    {
        l_value = l_properties[l_key];
        Splogger.log("Property " + l_key + " (" + l_value.GetType().ToString() + ") = " + l_value.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T16:43:05.667

我最近发现这似乎只发生在 Office 2007 文档上（对于其他文件类型，该值是日期的标准字符串格式）。答案是十六进制值表示自 1600 年 1 月 1 日以来的刻度数。这是对我有用的转换：

Dim dateVal as DateTime = New DateTime(Long.Parse(dateText.Replace("0x", "").Replace("|", ""), System.Globalization.NumberStyles.HexNumber)).AddYears(1600)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T20:50:39.670

可能是您将日期时间转换为 ToString 的“不变”日期。[看到这个](http://weblogs.asp.net/gunnarpeipman/archive/2008/05/14/sharepoint-assigning-values-to-datetime-fields.aspx)。

# .net - .net ToString() 格式文档

> ID：521079
> 
> 赞同：11
> 
> 时间：2009-02-06T16:47:56.047
> 
> 标签：.net, vb.net

前几天我看到了一个将布尔值转换为相应的“是”/“否”值的代码片段：

```
CDbl(True).ToString("Yes;Yes;No") 
```

该代码工作正常，但我很好奇它是如何工作的，我无法在[ToString() 的 MSDN 文档中](http://msdn.microsoft.com/en-us/library/1fd69cbc.aspx)找到答案。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T16:55:20.777

看看[这里](http://msdn.microsoft.com/en-us/library/system.iformattable.aspx)和[这里](http://msdn.microsoft.com/en-us/library/26etazsy.aspx)，以获取官方文档。还有这张来自 Jhon Sheehan 博客的很棒的[备忘单！](http://john-sheehan.com/blog/wp-content/uploads/msnet-formatting-strings.pdf)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-06T16:59:09.083

它将其视为[自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)。具体来说，请参阅链接页面中有关部分分隔符的部分：

> 这 ';' 字符用于分隔格式字符串中正数、负数和零数的部分。如果自定义格式字符串中有两个部分，最左边的部分定义正数和零数的格式，而最右边的部分定义负数的格式。*如果有三个部分，最左边的部分定义正数的格式，中间的部分定义负数的格式，最右边的部分定义零数的格式。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T16:58:38.163

它使用自定义数字格式字符串中的文字格式字符串。您可以提供一个映射到正数、负数或零数的数字的文字。第一个“是”映射为正，第二个映射为负，“否”映射为零。因此，任何非零都是肯定的，只有零是否定的。这相当于对数值的标准真/假语义解释。

[查看自定义数字格式](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)字符串页面的“部分分隔符” 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T17:10:18.937

正如@Joel Coehoorn 和@tvanfosson 所说，它使用的是自定义数字格式字符串。它起作用的原因是布尔值可以使用以下（基本上）转换为双精度：

```
public static double ToDouble(bool value)
{
    return (value ? ((double) 1) : ((double) 0));
} 
```

因此，如果 value 为 true，则返回 1；如果 value 为 false，则返回 0。此时，应用部分映射规则，如 @tvanfosson（以及随后的 @Joel Coehoorn）所述。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T17:12:35.547

Steve-X 有迄今为止我见过的最好的 String.Format 文档：[Steve-X ToString(](http://blog.stevex.net/index.php/string-formatting-in-csharp/) )

我知道您要求“ToString”，但 ToString 取决于您正在调用的实现（即 DateTime.ToString()、decimal.ToString...等）。

如果您真的对它的工作原理感兴趣，请打开[反射器](http://www.red-gate.com/products/reflector/)并仔细阅读代码。

# javascript - 使用回车键清除警报框时如何停止触发 onkeyup 事件

> ID：521080
> 
> 赞同：0
> 
> 时间：2009-02-06T16:48:18.950
> 
> 标签：javascript, javascript-events

这是我的问题...

我有一个文本字段，它使用 javascript onkeyup 事件来做一些“安静”的验证，如果值是有效的，打勾或打叉。

当按下回车键时，它会执行相同的验证，但会出现一个警告框，告知任何问题。如果使用回车键清除警告框，则按回车键会重新触发 onkeyup 事件，从而重新启动验证和警告框。

一旦我在警报框中单击确定，这自然会停止。

有什么方法可以检测到输入压力来自警报框吗？

这肯定发生在歌剧、野生动物园和火狐中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T17:04:18.450

`keypress`在触发回车键的行为时使用该事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T16:58:43.640

您可以忽略 onkeyup 事件处理程序中的回车键吗？

```
textbox.onkeyup = function( e ) {
    if( e.keyCode == 13 ) {
        return;
    }
    /* your validation here */
} 
```

# sql-server-2005 - t sql 在级联表中复制行

> ID：521082
> 
> 赞同：0
> 
> 时间：2009-02-06T16:48:29.463
> 
> 标签：sql-server-2005, tsql

我有几个相关/级联表的情况。假设所有的一对多关系级联 table1、table2、table3、table4 等。我拥有的是表中的默认行。它们从 table1 中的 1 条记录开始，并在其他表中具有 1 条或更多条相关记录。

我正在寻找的是一种复制行并为每个行创建/维护新主键的简单方法。通过维护，我的意思是 table1.ID1 被复制，所以现在有一个 table1.ID2，所有其他列都相同，只有 ID 发生了变化。

最重要的是，所有其他表中的所有相关行都被复制，并且外键/主键都指向新的。

因此，table2 的外键为 table1.ID2，主键为 table2.ID#，并且 table2 行中的其余列与 table2 中复制的行相同。

我很懒惰，试图摆脱管理 ID 并创建一个很长的存储过程。

我不认为这是可以做到的，但我希望我错了。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:18:52.833

我们最近不得不为我们的一个项目中的某些功能这样做。

我们最终使用递归存储过程来完成它。每次调用都需要两条信息：

*   正在复制记录的表的名称
*   被复制表的父表的主键

因此，如果您有两个表 A 和 B，其中 A.aid 是 A 的主键，而 B.aid 引用它，则需要在伪代码中执行以下操作：

```
Function deep_copy (table, parent)
  For each record in table whose parent is parent
    Create a new PK and copy this record
    For each subtable of table
      Call self with parameters (subtable, newPK) 
```

您将调用`deep_copy`要复制的 A 的每条记录。然后`deep_copy`会在 B 中需要复制的记录以及 B 的任何其他同级表上调用自身。问题是您需要元信息才能知道 B 是 A 的孩子。我们碰巧已经存储了该元信息，所以我们不需要做任何特别的事情来获得它。

这最终不是一个非常大的存储过程。如果您的 PK 都是身份列，那么它会变得容易得多。不过，它的分支很多。不完全是一种有效的算法。但话又说回来，这是一个固有的复杂问题，关系数据模型并不是为了优雅地处理而设计的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T07:12:28.330

触发器正是为此而创建的。然而，好的触发器很难编写并且维护起来很痛苦。但如果你把它们做对了，就很容易实现你描述的场景。

# c++ - 如何告诉编译器不要创建临时对象？

> ID：521083
> 
> 赞同：7
> 
> 时间：2009-02-06T16:48:38.060
> 
> 标签：c++, oop

我正在更改过去采用整数参数的旧例程，以便它现在采用对对象的 const 引用。我希望编译器会告诉我从哪里调用函数（因为参数类型错误），但是该对象有一个接受整数的构造函数，所以编译器不会失败，而是创建一个临时对象，并将其传递给整数，并将对它的引用传递给例程。示例代码：

```
class thing {
  public:
    thing( int x ) {
        printf( "Creating a thing(%d)\n", x );
    }
};

class X {
  public:
    X( const thing &t ) {
        printf( "Creating an X from a thing\n" );
    }
};

int main( int, char ** ) {
    thing a_thing( 5 );
    X an_x( 6 );
    return 1;
} 
```

我希望该`X an_x( 6 )`行**不编译**，因为没有`X`构造函数采用`int`. 但它确实编译，输出如下所示：

```
Creating a thing(5)
Creating a thing(6)
Creating an X from a thing 
```

如何保留`thing( int )`构造函数，但不允许临时对象？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T16:50:19.367

`explicit`在事物构造函数中使用关键字。

```
class thing {
public:
    explicit thing( int x ) {
        printf( "Creating a thing(%d)\n", x );
    }
}; 
```

这将防止编译器在找到整数时隐式调用事物构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:51:39.633

该`explicit`关键字在我的示例中完美运行，但后来我意识到我*的真​​实世界*代码在重载方法上失败，而不是构造函数。（我提出的问题与我的实际问题相似但不一样是我的错。）正如 Mark Ransom 在对已接受答案的评论中指出的那样，`explicit`仅适用于构造函数。我想出了一个解决我的问题的解决方法，所以我想我会把它贴在这里。新的示例代码：

```
class thing {
  public:
    thing( int x ) {
        printf( "Creating a thing(%d)\n", x );
    }
};

class X {
  public:
    void do_something( const thing &t ) {
        printf( "Creating an X from a thing\n" );
    }
};

int main( int, char ** ) {
    thing a_thing( 5 );
    X an_x;
    an_x.do_something( 6 );
    return 1;
} 
```

此代码显示与原始代码相同的输出，但我无法`explicit`修复它。相反，我添加了一个私有方法，该方法采用`int`：

```
 private:
    void do_something( int x ); 
```

现在，编译器没有创建临时对象，它给出了一个错误，因为我试图从类外部调用一个私有方法。

# c# - ENTER 按键上的 DropDownList 回发未触发服务器端事件

> ID：521089
> 
> 赞同：1
> 
> 时间：2009-02-06T16:49:52.160
> 
> 标签：c#, asp.net, postback

问候！

我有一个简单的导航菜单，由一个 asp:DropDownList 和一个 asp:Button 组成。用户从下拉列表中选择一个项目，然后单击按钮转到新 URL。我希望能够支持当用户在选择下拉列表项时按下 ENTER 键，以便它复制行为，就好像他们点击了按钮一样。

到目前为止，这是我所拥有的：

```
<asp:DropDownList ID="ddlMenu"
                  runat="server"
                  onkeypress="if ((event.which && event.which == 13) || (event.keyCode && event.keyCode == 13)) {__doPostBack('GoButton',''); return false;}" />

<asp:Button ID="btnGoButton" runat="server" onclick="GoButton_Click"/> 
```

按钮的点击代码为：

```
protected void GoButton_Click(object sender, EventArgs e)
{
    string l_url = ddlMenu.SelectedItem.Value;
    Response.Redirect(l_url);
} 
```

但是，每次我按 ENTER 键时，页面都会返回，但按钮的客户端事件处理程序不会触发。我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T16:52:40.813

您是否尝试过使用默认按钮将控件包装在面板中？我知道它适用于文本框

```
<asp:Panel runat="server" id="searchPanel" DefaultButton="btnGoButton">
    <asp:DropDownList ID="ddlMenu" runat="server" />
    <asp:Button ID="btnGoButton" runat="server" onclick="GoButton_Click"/>
</asp:Panel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:15:15.160

好吧，您使用了错误的按钮 ID。

__doPostBack 方法中的 ID 必须是触发器控件的 UniqueID。您说触发器是“GoButton”，但它的 ID 为“btnGoButton”。

服务器无法知道您的“GoButton”实际上是 btnGoButton。

还要记住，名称修改（一种确保控件名称唯一的方法）可能会使 UniqueID 更加混乱。

尝试这样写： __doPostBack('<%# btnGoButton.UniqueID %>', '');

或将其附加到代码隐藏中..

ddlMenu.Attributes.Add("onkeypress", string.Format("__doPostBack('{0}', '');", btnGoButton.UniqueID);

# c# - 为什么我的应用程序在注销/关闭时没有关闭（c#/.net winforms）？

> ID：521099
> 
> 赞同：2
> 
> 时间：2009-02-06T16:51:38.473
> 
> 标签：c#, .net, winforms, com, shutdown

当我注销/关闭时，我的 winforms 应用程序没有很好地关闭。我有一个主窗体，它的 Closing 事件被正确触发，但必须有其他东西保持我的应用程序。如果我检查 Application.OpenForms，那只有我的一个主要表单。

棘手的一点，问题可能出在哪里，是我的应用程序使用 ShellWindows 连接到 Internet Explorer，并且偶尔会在 IE 事件触发时打开表单。在打开和关闭这些表单中的一个或多个之后，我的应用程序在关机时停止关闭。

我想我正在清理所有表单对象等并适当地调用 FinalReleaseComObject()，但我想在某处有一些引用使我的进程保持打开状态。有什么方法可以弄清楚是什么阻止了我的应用程序正常关闭？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T17:07:34.183

如果有未设置为后台的线程正在运行，应用程序也将保持打开状态。如果您正在创建任何自己的线程，请确保它们正确终止。

如果线程完成并不重要，请将[IsBackground](http://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx)设置为 true。您还可以在线程上调用 Abort 以（某种程度上）强制杀死它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:22:39.533

最可能的原因是当您的应用程序的主窗口关闭时，您有一个未关闭的后台线程。根据您的设置和框架版本，后台线程可以在主线程终止时使应用程序保持活动状态。

在关闭期间，窗口通常通过向进程的主窗口发送 WM_QUIT 来要求每个正在运行的应用程序终止。WinForms 将愉快地使用此消息来关闭主窗口，但如果留下任何后台线程，则实际进程可以继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T01:36:38.103

这是一种非常丑陋的方法，但是如果您只想杀死任何挂起的线程，您可以使用 System.Diagnostics.Process.GetCurrentProcess.Threads 让所有线程在您的应用程序中运行，然后通过枚举并在它们上调用 Thread.Join() 或 Thread.Abort()。

只需确保不要在您正在使用的主 (UI) 线程（接收 Closing 事件的线程）上调用 .Abort() 。因此，请务必检查您当前的线程 (System.Threading.Thread) 是否不是您要中止的线程。

# java - SHA1 和 RSA 与 java.security.Signature 对比 MessageDigest 和 Cipher

> ID：521101
> 
> 赞同：70
> 
> 时间：2009-02-06T16:51:55.727
> 
> 标签：java, encryption, cryptography, rsa, digital-signature

我试图了解 Java *java.security.Signature*类的作用。如果我计算一个 SHA1 消息摘要，然后使用 RSA 对该摘要进行加密，我会得到与要求*Signature*类签署相同内容不同的结果：

```
// Generate new key
KeyPair keyPair = KeyPairGenerator.getInstance("RSA").generateKeyPair();
PrivateKey privateKey = keyPair.getPrivate();
String plaintext = "This is the message being signed";

// Compute signature
Signature instance = Signature.getInstance("SHA1withRSA");
instance.initSign(privateKey);
instance.update((plaintext).getBytes());
byte[] signature = instance.sign();

// Compute digest
MessageDigest sha1 = MessageDigest.getInstance("SHA1");
byte[] digest = sha1.digest((plaintext).getBytes());

// Encrypt digest
Cipher cipher = Cipher.getInstance("RSA");
cipher.init(Cipher.ENCRYPT_MODE, privateKey);
byte[] cipherText = cipher.doFinal(digest);

// Display results
System.out.println("Input data: " + plaintext);
System.out.println("Digest: " + bytes2String(digest));
System.out.println("Cipher text: " + bytes2String(cipherText));
System.out.println("Signature: " + bytes2String(signature)); 
```

结果（例如）：

> 输入数据：这是正在签名的消息
> 摘要：62b0a9ef15461c82766fb5bdaae9edbe4ac2e067
> 密文：057dc0d2f7f54acc95d3cf5cba9f944619394711003bdd12...
> 签名：7177c74bbbb871cc0af922e30d2808ebae1...25

我必须对*Signature*正在做什么有一个根本的误解——我已经通过它进行了跟踪，它似乎正在调用*MessageDigest*对象的更新，算法设置为 SHA1，正如我所期望的那样，然后获取摘要，然后执行加密。是什么导致结果不同？

**编辑：**

Leonidas 让我检查签名方案是否应该按照我的想法去做。[RFC](http://www.apps.ietf.org/rfc/rfc3447.html)中定义了两种类型的签名：

*   [RSASSA-PKCS1-v1_5](http://www.apps.ietf.org/rfc/rfc3447.html#sec-9.2)
*   [RSASSA-PSS](http://www.apps.ietf.org/rfc/rfc3447.html#sec-9.1)

其中[第一个](http://www.apps.ietf.org/rfc/rfc3447.html#sec-9.2)（PKCS1）是我上面描述的那个。它使用散列函数创建摘要，然后使用私钥对结果进行加密。

第二种[算法](http://www.apps.ietf.org/rfc/rfc3447.html#sec-9.1)使用随机盐值，更安全但不确定。如果重复使用相同的密钥，上面代码产生的签名不会改变，所以我认为它不可能是 PSS。

**编辑：**

这是`bytes2string`我使用的方法：

```
private static String bytes2String(byte[] bytes) {
    StringBuilder string = new StringBuilder();
    for (byte b : bytes) {
        String hexString = Integer.toHexString(0x00FF & b);
        string.append(hexString.length() == 1 ? "0" + hexString : hexString);
    }
    return string.toString();
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-06T18:02:25.103

好的，我已经弄清楚发生了什么。Leonidas 是对的，它不仅仅是被加密的散列（在 Cipher 类方法的情况下），它是与摘要连接的散列算法的 ID：

```
 DigestInfo ::= SEQUENCE {
      digestAlgorithm AlgorithmIdentifier,
      digest OCTET STRING
  } 
```

这就是密码和签名的加密不同的原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-01-26T15:53:23.323

要产生相同的结果：

```
MessageDigest sha1 = MessageDigest.getInstance("SHA1", BOUNCY_CASTLE_PROVIDER);
byte[] digest = sha1.digest(content);
DERObjectIdentifier sha1oid_ = new DERObjectIdentifier("1.3.14.3.2.26");

AlgorithmIdentifier sha1aid_ = new AlgorithmIdentifier(sha1oid_, null);
DigestInfo di = new DigestInfo(sha1aid_, digest);

byte[] plainSig = di.getDEREncoded();
Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding", BOUNCY_CASTLE_PROVIDER);
cipher.init(Cipher.ENCRYPT_MODE, privateKey);
byte[] signature = cipher.doFinal(plainSig); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-12T09:19:55.573

bytes2String 方法的一个稍微高效的版本是

```
private static final char[] hex = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'};
private static String byteArray2Hex(byte[] bytes) {
    StringBuilder sb = new StringBuilder(bytes.length * 2);
    for (final byte b : bytes) {
        sb.append(hex[(b & 0xF0) >> 4]);
        sb.append(hex[b & 0x0F]);
    }
    return sb.toString();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T16:56:03.100

呃，在理解你的问题之后：你确定签名方法只创建一个 SHA1 并加密它吗？GPG 等人提供对数据进行压缩/清除签名。也许这个 java-signature-alg 也创建了一个可拆卸/可附加的签名。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-14T16:23:46.150

以@Mike Houston 的回答为指针，这里有一个完整的示例代码，它执行签名和哈希以及加密。

```
/**
 * @param args
 */
public static void main(String[] args)
{
    try
    {
        boolean useBouncyCastleProvider = false;

        Provider provider = null;
        if (useBouncyCastleProvider)
        {
            provider = new BouncyCastleProvider();
            Security.addProvider(provider);
        }

        String plainText = "This is a plain text!!";

        // KeyPair
        KeyPairGenerator keyPairGenerator = null;
        if (null != provider)
            keyPairGenerator = KeyPairGenerator.getInstance("RSA", provider);
        else
            keyPairGenerator = KeyPairGenerator.getInstance("RSA");
        keyPairGenerator.initialize(2048);

        KeyPair keyPair = keyPairGenerator.generateKeyPair();

        // Signature
        Signature signatureProvider = null;
        if (null != provider)
            signatureProvider = Signature.getInstance("SHA256WithRSA", provider);
        else
            signatureProvider = Signature.getInstance("SHA256WithRSA");
        signatureProvider.initSign(keyPair.getPrivate());

        signatureProvider.update(plainText.getBytes());
        byte[] signature = signatureProvider.sign();

        System.out.println("Signature Output : ");
        System.out.println("\t" + new String(Base64.encode(signature)));

        // Message Digest
        String hashingAlgorithm = "SHA-256";
        MessageDigest messageDigestProvider = null;
        if (null != provider)
            messageDigestProvider = MessageDigest.getInstance(hashingAlgorithm, provider);
        else
            messageDigestProvider = MessageDigest.getInstance(hashingAlgorithm);
        messageDigestProvider.update(plainText.getBytes());

        byte[] hash = messageDigestProvider.digest();

        DigestAlgorithmIdentifierFinder hashAlgorithmFinder = new DefaultDigestAlgorithmIdentifierFinder();
        AlgorithmIdentifier hashingAlgorithmIdentifier = hashAlgorithmFinder.find(hashingAlgorithm);

        DigestInfo digestInfo = new DigestInfo(hashingAlgorithmIdentifier, hash);
        byte[] hashToEncrypt = digestInfo.getEncoded();

        // Crypto
        // You could also use "RSA/ECB/PKCS1Padding" for both the BC and SUN Providers.
        Cipher encCipher = null;
        if (null != provider)
            encCipher = Cipher.getInstance("RSA/NONE/PKCS1Padding", provider);
        else
            encCipher = Cipher.getInstance("RSA");
        encCipher.init(Cipher.ENCRYPT_MODE, keyPair.getPrivate());

        byte[] encrypted = encCipher.doFinal(hashToEncrypt);

        System.out.println("Hash and Encryption Output : ");
        System.out.println("\t" + new String(Base64.encode(encrypted)));
    }
    catch (Throwable e)
    {
        e.printStackTrace();
    }
} 
```

您可以使用 BouncyCastle 提供程序或默认的 Sun 提供程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-06T04:58:32.790

我有一个类似的问题，我测试了添加代码并发现了一些有趣的结果。通过我添加的这段代码，我可以推断出根据要使用的“提供者”，公司可能会有所不同？（因为加密中包含的数据在所有提供者中并不总是相同的）。

## 我的测试结果。

结论.- Signature Decipher= ???(trash) + DigestInfo （如果我们知道“trash”的值，则数字签名将相等）

## IDE Eclipse 输出...

输入数据：这是正在签名的消息

摘要：62b0a9ef15461c82766fb5bdaae9edbe4ac2e067

摘要信息：3021300906052b0e03021a0500041462b0a9ef15461c82766fb5bdaae9edbe4ac2e067

签名破译：1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003021300906052b0e03021a0500041462b0a9ef15461c82766fb5bdaae9edbe4ac2e067

## 代码

```
import java.security.InvalidKeyException;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Signature;
import java.security.SignatureException;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import org.bouncycastle.asn1.x509.DigestInfo;
import org.bouncycastle.asn1.DERObjectIdentifier;
import org.bouncycastle.asn1.x509.AlgorithmIdentifier;
public class prueba {
/**
* @param args
* @throws NoSuchProviderException 
* @throws NoSuchAlgorithmException 
* @throws InvalidKeyException 
* @throws SignatureException 
* @throws NoSuchPaddingException 
* @throws BadPaddingException 
* @throws IllegalBlockSizeException 
*///
public static void main(String[] args) throws NoSuchAlgorithmException, NoSuchProviderException, InvalidKeyException, SignatureException, NoSuchPaddingException, IllegalBlockSizeException, BadPaddingException {
// TODO Auto-generated method stub
KeyPair keyPair = KeyPairGenerator.getInstance("RSA","BC").generateKeyPair();
PrivateKey privateKey = keyPair.getPrivate();
PublicKey puKey = keyPair.getPublic();
String plaintext = "This is the message being signed";
// Hacer la firma
Signature instance = Signature.getInstance("SHA1withRSA","BC");
instance.initSign(privateKey);
instance.update((plaintext).getBytes());
byte[] signature = instance.sign();
// En dos partes primero hago un Hash
MessageDigest digest = MessageDigest.getInstance("SHA1", "BC");
byte[] hash = digest.digest((plaintext).getBytes());
// El digest es identico a  openssl dgst -sha1 texto.txt
//MessageDigest sha1 = MessageDigest.getInstance("SHA1","BC");
//byte[] digest = sha1.digest((plaintext).getBytes());
AlgorithmIdentifier digestAlgorithm = new AlgorithmIdentifier(new
DERObjectIdentifier("1.3.14.3.2.26"), null);
// create the digest info
DigestInfo di = new DigestInfo(digestAlgorithm, hash);
byte[] digestInfo = di.getDEREncoded();
//Luego cifro el hash
Cipher cipher = Cipher.getInstance("RSA","BC");
cipher.init(Cipher.ENCRYPT_MODE, privateKey);
byte[] cipherText = cipher.doFinal(digestInfo);
//byte[] cipherText = cipher.doFinal(digest2);
Cipher cipher2 = Cipher.getInstance("RSA","BC");
cipher2.init(Cipher.DECRYPT_MODE, puKey);
byte[] cipherText2 = cipher2.doFinal(signature);
System.out.println("Input data: " + plaintext);
System.out.println("Digest: " + bytes2String(hash));
System.out.println("Signature: " + bytes2String(signature));
System.out.println("Signature2: " + bytes2String(cipherText));
System.out.println("DigestInfo: " + bytes2String(digestInfo));
System.out.println("Signature Decipher: " + bytes2String(cipherText2));
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-28T09:46:24.217

下面的代码（取自我的博客文章 - [http://todayguesswhat.blogspot.com/2021/01/manually-verifying-rsa-sha-signature-in.html](http://todayguesswhat.blogspot.com/2021/01/manually-verifying-rsa-sha-signature-in.html)）希望有助于理解标准 SHA 中存在的内容RSA 签名。这应该在标准 Oracle JDK 中工作，并且不需要 Bouncy Castle 库。它使用 sun.security 类来处理解密的签名内容——您可以轻松地手动解析。

在下面的示例中，消息摘要算法是 SHA-512，它产生一个 64 字节（512 位）的校验和。

SHA-1 会非常相似——但会产生一个 20 字节（160 位）的校验和。

```
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.MessageDigest;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Signature;

import java.util.Arrays;

import javax.crypto.Cipher;

import sun.security.util.DerInputStream;
import sun.security.util.DerValue;

public class RSASignatureVerification
{
    public static void main(String[] args) throws Exception
    {
        KeyPairGenerator generator = KeyPairGenerator.getInstance("RSA");
        generator.initialize(2048);

        KeyPair keyPair = generator.generateKeyPair();
        PrivateKey privateKey = keyPair.getPrivate();
        PublicKey publicKey = keyPair.getPublic();

        String data = "hello oracle";
        byte[] dataBytes = data.getBytes("UTF8");

        Signature signer = Signature.getInstance("SHA512withRSA");
        signer.initSign(privateKey);

        signer.update(dataBytes);

        byte[] signature = signer.sign(); // signature bytes of the signing operation's result.

        Signature verifier = Signature.getInstance("SHA512withRSA");
        verifier.initVerify(publicKey);
        verifier.update(dataBytes);

        boolean verified = verifier.verify(signature);
        if (verified)
        {
            System.out.println("Signature verified!");
        }

/*
    The statement that describes signing to be equivalent to RSA encrypting the
    hash of the message using the private key is a greatly simplified view
    The decrypted signatures bytes likely convey a structure (ASN.1) encoded
    using DER with the hash just one component of the structure.
*/

        // lets try decrypt signature and see what is in it ...
        Cipher cipher = Cipher.getInstance("RSA");
        cipher.init(Cipher.DECRYPT_MODE, publicKey);

        byte[] decryptedSignatureBytes = cipher.doFinal(signature);

/*
    sample value of decrypted signature which was 83 bytes long

    30 51 30 0D 06 09 60 86 48 01 65 03 04 02 03 05
    00 04 40 51 00 41 75 CA 3B 2B 6B C0 0A 3F 99 E3
    6B 7A 01 DC F2 9B 36 E6 0D D4 31 89 53 A3 D9 80
    6D AE DD 45 7E 55 45 01 FC C8 73 D2 DD 8D E5 B9
    E0 71 57 13 41 D0 CD FF CA 58 01 03 A3 DD 95 A1
    C1 EE C8

    Taking above sample bytes ...
    0x30 means A SEQUENCE - which contains an ordered field of one or more types.
    It is encoded into a TLV triplet that begins with a Tag byte of 0x30.
    DER uses T,L,V (tag bytes, length bytes, value bytes) format

    0x51 is the length = 81 decimal (13 bytes)

    the 0x30 (48 decimal) that follows begins a second sequence

    https://tools.ietf.org/html/rfc3447#page-43
    the DER encoding T of the DigestInfo value is equal to the following for SHA-512
    0D 06 09 60 86 48 01 65 03 04 02 03 05 00 04 40 || H
    where || is concatenation and H is the hash value.

    0x0D is the length = 13 decimal (13 bytes)

    0x06 means an OBJECT_ID tag
    0x09 means the object id is 9 bytes ...

    https://docs.microsoft.com/en-au/windows/win32/seccertenroll/about-object-identifier?redirectedfrom=MSDN

    taking 2.16.840.1.101.3.4.2.3 (object id for SHA512 Hash Algorithm)

    The first two nodes of the OID are encoded onto a single byte.
    The first node is multiplied by the decimal 40 and the result is added to the value of the second node
    2 * 40 + 16 = 96 decimal = 60 hex
    Node values less than or equal to 127 are encoded on one byte.
    1 101 3 4 2 3 corresponds to in hex 01 65 03 04 02 03
    Node values greater than or equal to 128 are encoded on multiple bytes.
    Bit 7 of the leftmost byte is set to one. Bits 0 through 6 of each byte contains the encoded value.
    840 decimal = 348 hex
    -> 0000 0011 0100 1000
    set bit 7 of the left most byte to 1, ignore bit 7 of the right most byte,
    shifting right nibble of leftmost byte to the left by 1 bit
    -> 1000 0110 X100 1000 in hex 86 48

    05 00          ; NULL (0 Bytes)

    04 40          ; OCTET STRING (0x40 Bytes = 64 bytes
    SHA512 produces a 512-bit (64-byte) hash value

    51 00 41 ... C1 EE C8 is the 64 byte hash value
*/

        // parse DER encoded data
        DerInputStream derReader = new DerInputStream(decryptedSignatureBytes);

        byte[] hashValueFromSignature = null;

        // obtain sequence of entities
        DerValue[] seq = derReader.getSequence(0);
        for (DerValue v : seq)
        {
            if (v.getTag() == 4)
            {
                hashValueFromSignature = v.getOctetString(); // SHA-512 checksum extracted from decrypted signature bytes
            }
        }

        MessageDigest md = MessageDigest.getInstance("SHA-512");
        md.update(dataBytes);

        byte[] hashValueCalculated = md.digest();

        boolean manuallyVerified = Arrays.equals(hashValueFromSignature, hashValueCalculated);
        if (manuallyVerified)
        {
            System.out.println("Signature manually verified!");
        }
        else
        {
            System.out.println("Signature could NOT be manually verified!");
        }
    }
} 
```

# c - Objective-C Singleton 实例作为静态？

> ID：521102
> 
> 赞同：2
> 
> 时间：2009-02-06T16:51:57.990
> 
> 标签：c, objective-c, design-patterns, singleton

在 Apple 的 Singleton 示例文档中，我确实知道给猫剥皮的方法不止一种——但他们为什么要费心确保实例注册为静态？

取自：http: [//developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/chapter_3_section_10.html](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/chapter_3_section_10.html)

我指的是：

静态 MyGizmoClass *sharedGizmoManager = nil;

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T16:57:23.843

我相信这是因为无法从定义它的文件外部访问该变量。否则它将是全局可访问的。

这强制客户端**必须**使用 -(id)sharedObject 来访问单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T04:52:35.540

上面的答案是正确的。将单例的变量声明为静态意味着它只存在于包含它的文件的本地范围内，这正是您想要的。部分原因是这个单例模型依赖延迟加载在第一次使用时创建单例，部分原因是您不希望外部访问指针，这可能会丢失内存中的单例，或者允许另一个实例被创建，从而使整个事情首先变得毫无意义。

# information-hiding - 什么是嵌套函数？它们是干什么用的？

> ID：521103
> 
> 赞同：2
> 
> 时间：2009-02-06T16:52:22.903
> 
> 标签：information-hiding, nested-function

我从未使用过嵌套函数，但在几种语言中看到过对它们的引用（以及嵌套类，我认为它们是相关的）。

*   什么是嵌套函数？
*   为什么？！？
*   您可以用其他任何方式都无法做到的嵌套函数做什么？
*   如果没有嵌套函数，这很难或不优雅，你能用嵌套函数做什么？

我假设嵌套函数只是将所有内容视为对象的工件，如果对象可以包含其他对象，那么它就会遵循。

嵌套函数是否具有范围（通常，我认为语言对此有所不同）就像函数内的变量具有范围一样？

如果您不确定您的答案是否与语言无关，请添加您所引用的语言。

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T17:00:27.210

嵌套函数的一种流行用法是[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))。在具有一流函数的[词法范围语言中，可以使用函数来存储数据。](http://en.wikipedia.org/wiki/Scope_(programming)#Static_scoping_.28also_known_as_lexical_scoping.29)Scheme 中的一个简单示例是计数器：

```
(define (make-counter)
  (let ((count 0))                ; used to store the count
    (define (counter)             ; this is the counter we're creating
      (set! count (+ count 1))    ; increment the count
      count)                      ; return the new count
    counter))                     ; return the new counter function

(define mycounter (make-counter)) ; create a counter called mycounter

(mycounter)                       ; returns 1

(mycounter)                       ; returns 2 
```

在这个例子中，我们将函数 counter 嵌套在函数 make-counter 中，并且通过返回这个内部函数，我们能够访问在定义 counter 时可用的数据。此信息对于这个 mycounter 实例是私有的——如果我们要创建另一个计数器，它将使用不同的位置来存储内部计数。继续上一个示例：

```
(define mycounter2 (make-counter))

(mycounter2)                      ; returns 1

(mycounter)                       ; returns 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:00:57.893

当只有一种方法可以调用它时，它对递归很有用

```
string[] GetFiles(string path)
{
  void NestedGetFiles(string path, List<string> result)
  {
    result.AddRange( files in the current path);
    foreach(string subPath in FoldersInTheCurrentPath)
      NestedGetFiles(subPath, result);
  }

   List<string> result = new List<string>();
   NestedGetFiles(path, result);
   return result.ToArray();
} 
```

上面的代码是完全组成的，但是基于 C# 来表达我的意思。唯一可以调用 NestedGetFiles 的方法是 GetFiles 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T17:05:52.533

嵌套函数只是另一个函数中的一个函数。

是的，这是一切都是对象的结果。由于您可以拥有仅在函数范围内可见的变量，并且变量可以指向函数，因此您可以拥有一个由局部变量引用的函数。

我不认为你可以用一个你绝对不能没有的嵌套函数做任何事情。不过，很多时候它是有道理的。即，只要一个功能是某个其他功能的“子功能”。

对我来说，一个常见的用例是当一个函数执行许多复杂的逻辑但函数计算/返回的内容很容易抽象为逻辑规定的所有情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T17:00:08.957

(C#) ：我用它来简化对象浏览器视图，并更好地构建我的类。作为类 Wheel 嵌套在 Truck 类中。

不要忘记这个细节：“嵌套类型可以访问包含类型的私有和受保护成员，包括任何继承的私有或受保护成员。”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T17:03:09.527

嵌套函数允许您封装仅与该函数中的一个函数的内部工作相关的代码，同时仍允许您将该代码分离出来以提高可读性或泛化性。在一些实现中，它们还允许访问外部范围。在 D 中：

```
int doStuff() {
    int result;
    void cleanUpReturn() {
        myResource1.release();
        myResource2.release();
        return result * 2 + 1;
    }

    auto myResource1 = getSomeResource();
    auto myResource2 = getSomeOtherResource();
    if(someCondition) {
        return cleanUpReturn();
    } else {
        doSomeOtherStuff();
        return cleanUpReturn();
    }
} 
```

当然，在这种情况下，这也可以使用 RAII 来处理，但这只是一个简单的示例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T17:06:47.493

如果您需要将一个函数作为参数传递给另一个函数，它们也很有用。它们还可以用于为工厂函数制作工厂函数（在 Python 中）：

```
>>> def GetIntMaker(x):
...   def GetInt():
...     return x
...   return GetInt
... 
>>> GetInt = GetIntMaker(1)
>>> GetInt()
1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T17:11:12.803

嵌套函数只是在另一个函数的主体中定义的函数。为什么？我能想到的唯一原因是辅助函数或实用函数。

这是一个人为的例子，但请耐心等待。假设您有一个函数，它必须对两个查询的结果进行操作，并用其中一个查询的值填充一个对象。您可以执行以下操作。

```
function process(qryResult q1, qryResult q2) {

   object o;
   if (q1.someprop == "useme") {
       o.prop1 = q1.prop1;
       o.prop2 = q1.prop2;
       o.prop3 = q1.prop3;
   } else if (q2.someprop == "useme") {
       o.prop1 = q2.prop1;
       o.prop2 = q2.prop2;
       o.prop3 = q2.prop3;
   }

   return o;

} 
```

如果您有 20 个属性，那么您就是在重复代码以一遍又一遍地设置对象，从而导致一个巨大的函数。您可以添加一个简单的嵌套函数来将属性从查询复制到对象。像这样：

```
function process(qryResult q1, qryResult q2) {

   object o;
   if (q1.someprop == "useme") {
       fillObject(o,q1);
   } else if (q2.someprop == "useme") {
       fillObject(o,q2);
   }

   return o;

   function fillObject(object o, qryResult q) {
       o.prop1 = q.prop1;
       o.prop2 = q.prop2;
       o.prop3 = q.prop3;
   }

} 
```

它让事情变得更干净一些。它必须是嵌套函数吗？不，但是如果进程功能是唯一必须执行此副本的功能，您可能希望这样做。

# asp.net-mvc - 如何对 ASP.NET MVC 控制器的 HandleUnknownAction() 进行单元测试？

> ID：521107
> 
> 赞同：3
> 
> 时间：2009-02-06T16:55:00.917
> 
> 标签：asp.net-mvc, tdd

我在基本控制器类上设置了以下 HandleUnknownAction：

```
protected override void HandleUnknownAction(string action)
{
    Response.Redirect("/");
} 
```

我该如何对其进行单元测试？还有一点，这种处理未知动作的方式是否正确？似乎调用 RedirectToAction() 会更正确，但 HandleUnknownAction 没有返回值。

我可以测试的范围是：

```
[Test]
public void TestHandleUnknownAction()
{
    ctroler.ActionInvoker.InvokeAction(ctroler.ControllerContext, "unknown");
} 
```

我坚持下去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:00:50.060

我认为没有必要测试当控制器缺少操作时是否调用了 HandleUnknownAction。我们相信框架可以处理这个问题。[因此，我们可以通过使用模拟框架Moq](http://code.google.com/p/moq/)直接调用 HandleUnknownAction 来测试实现。[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)也应该可以。

```
public void TestHandleUnknownAction()
{
    Mock<ControllerContext> cc = new Mock<ControllerContext>
                                           (MockBehavior.Strict);
    cc.Expect(c => c.HttpContext.Response.Redirect("/"));

    TestHelperController controller = new TestHelperController();
    controller.ControllerContext = cc.Object;

    controller.InvokeUnknownAction("test");
} 
```

TestHelperController 使 HandleUnknownAction 可访问的地方：

```
public class TestHelperController : RealController
{
    public void InvokeUnknownAction(string action)
    {
        this.HandleUnknownAction(action);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T00:52:51.843

这对于一个简单的 Response.Redirect 来说很好，但是如果你想做一些更复杂的事情，比如渲染一个错误视图，那么单元测试代码将不起作用：

```
// TODO - Put some stuff into ViewData or a model
View("Error").ExecuteResult(Me.ControllerContext) 
```

# java - 优秀的 Java 桌面应用程序示例

> ID：521110
> 
> 赞同：31
> 
> 时间：2009-02-06T16:55:52.053
> 
> 标签：java, desktop-application

更多 wiki 列表/集合，我正在寻找一个好的 Java 桌面应用程序列表。我在下面添加了几个开始。如果知道，请列出正在使用的框架/小部件工具包。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-06T17:13:10.163

[IntelliJ IDEA](http://www.jetbrains.com/idea/index.html)（摇摆）

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-06T16:57:15.653

日食（SWT）

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-06T16:58:12.907

Netbeans（摇摆）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-06T17:06:47.383

[**Azureus**](http://azureus.sourceforge.net/)（SWT；感谢 Peter）（当然，严格用于法律目的）

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-02-06T16:56:51.553

jEdit（摇摆？）

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-02-08T15:59:30.683

磁盘报告

[http://www.jgoodies.com/freeware/jdiskreport/](http://www.jgoodies.com/freeware/jdiskreport/)

我遇到的最好的磁盘空间浏览器。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2010-04-22T15:06:05.820

**甜蜜之家 3D：**

[http://www.sweethome3d.eu/index.jsp](http://www.sweethome3d.eu/index.jsp)

[![替代文字](https://i.stack.imgur.com/85Ahj.png)](https://i.stack.imgur.com/85Ahj.png)
[（来源：[sweethome3d.eu](http://www.sweethome3d.eu/images/SweetHome3DSolaris.png)）]

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2009-08-20T22:28:40.693

## [指挥官](http://www.mucommander.com/)

[![截图应该在这里](https://i.stack.imgur.com/Qyq5d.png)](http://www.mucommander.com/screenshots.php)
[（来源：[mucommander.com](http://www.mucommander.com/screenshots/1.png)）]

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-02-06T16:56:37.373

SoapUI - [http://www.soapui.org](http://www.soapui.org)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-02-06T17:03:21.477

[松鼠 SQL](http://www.squirrelsql.org/ "松鼠 SQL")

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-02-06T18:56:19.737

[在游戏方面，三环在Puzzle Pirates](http://www.puzzlepirates.com/)方面做得非常出色。纯 Java 并且运行良好。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-02-08T09:50:51.257

这可以很好地展示这一点。

[在太阳摆动目击](http://java.sun.com/products/jfc/tsc/sightings)

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2009-02-06T16:57:51.083

SQL 开发人员

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2010-04-22T15:40:18.270

[Visual VM](https://visualvm.dev.java.net/) - 监控和性能分析工具。

[![视觉虚拟机屏幕截图](https://i.stack.imgur.com/Z6njU.jpg)](https://i.stack.imgur.com/Z6njU.jpg)
[（来源：[java.net](https://java.net/projects/visualvm/content/images/monitor.jpg)）]

我喜欢它产生的图表

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-02-06T17:08:53.230

[Vuze](http://www.vuze.com/app?service=home)（以前的 Azereus）很好，但我遇到的最重要的建议是[YourSQL](http://yoursql.ludit.it/)。这是一个非常棒的 OS X 小 MySQL 客户端，在我发现它是 Java 之前，我使用了超过 1.5 年。它做得很好。许多人与 Java 应用程序相关联的那些经典的“缓慢的未集成垃圾”都没有。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-02-06T18:37:22.940

[自由思维](http://freemind.sourceforge.net/)（摇摆）

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2009-02-06T20:44:53.450

有点晦涩，但[Go Grinder](http://gogrinder.sourceforge.net/)符合描述。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-02-07T01:14:32.640

[数据库可视化器](http://www.minq.se/products/dbvis/)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-02-09T12:29:32.440

[XMind](http://www.xmind.net/)，基于 Ecipe RCP 的精美思维导图软件。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-02-06T17:01:30.140

柯达数字电影系统（我不只是这么说，因为我写了大约 1/3 的内容，包括大部分的 gui。）

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-02-08T09:43:28.930

[Runescape](http://runescape.com)游戏是我使用的唯一一个不是 IDE/Editor/Profiler 的 Java 应用程序（它在 Windows 中有一个桌面客户端）。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-02-08T09:45:09.987

SmartSVN、SmartCVS

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-02-09T22:25:04.083

[FreeCol](http://freecol.sf.net/)，经典 Sid Meier 游戏 Colonization 的开源克隆。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-08-20T22:31:24.150

[火花信使](http://www.igniterealtime.org/projects/spark/index.jsp)

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2011-08-30T23:21:38.113

[JOSM](http://josm.openstreetmap.de/)是最流行的[OpenStreetMap](http://wiki.openstreetmap.org/wiki/Main_Page)编辑器，是用 Swing 编写的。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-02-08T10:20:19.527

枫木（秋千）

上周不得不和 Maple 一起工作很多。它是如此的好用和强大的工具，我一开始不敢相信它是用 Swing 和 Java 开发的 :)

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2010-04-22T15:27:10.810

**贾布姆**

[http://jalbum.net/](http://jalbum.net/)

![替代文字](https://jalbum.net/res/help/slide/workflow03a.jpg)

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-02-08T09:55:41.527

[Aerith](https://aerith.dev.java.net/) (Swing + OpenGL) 虽然它是一种实验性的。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2010-04-22T14:51:46.113

RSSOwl 新闻提要阅读器 - [http://www.rssowl.org/](http://www.rssowl.org/)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2010-04-22T15:45:06.510

**Genj**（家谱）

[http://genj.sourceforge.net/](http://genj.sourceforge.net/)

[![替代文字](https://i.stack.imgur.com/Fydlj.png)](https://i.stack.imgur.com/Fydlj.png)
[（来源：[sourceforge.net](http://genj.sourceforge.net/forum/download/file.php?id=54)）]

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2010-12-29T08:46:05.407

eclipse的[GWT设计器（Java UI）设计器](http://code.google.com/webtoolkit/tools/gwtdesigner/index.html)

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2011-01-12T22:54:28.017

[Violet UM](http://alexdp.free.fr/violetumleditor/page.php) L 看起来像一个出色的图表工具。

![替代文字](https://i.stack.imgur.com/MO7aZ.jpg)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-02-06T17:04:35.920

[把事情完成](http://en.wikipedia.org/wiki/Getting_Things_Done)实施[ThinkingRock](http://www.trgtd.com.au)

# python - 未定义方法输出的进一步处理（Python）

> ID：521111
> 
> 赞同：2
> 
> 时间：2009-02-06T16:55:56.500
> 
> 标签：python

如何编写一个 Python 类来处理对未定义方法的调用，首先从给定模块获取同名函数的输出，然后对该输出进行进一步处理？

例如，给定 add(x, y)，doublerInstance.add(1, 1) 应该返回 4。

我知道 _ _ getattr _ _() 拦截对未定义方法的调用，而 getattr() 可以检索函数对象。但是我不知道如何将传递给由_ _ getattr _ _（）捕获的未定义调用的参数传递给由getattr（）检索的函数。

```
EXAMPLE
Module functions.py:
def add(x, y):
    return x + 

Module doubler.py:
class Doubler:
  def __init__(self, source):
    self.source = source

  def __getattr__(self, attrname):
    fnc = getattr(self.source, attrname)
    return fnc() * 2

Session:
>import functions as f
>import doubler as d
>doublerInstance = d.Doubler(f)
>doublerInstance.add(1, 2)
<snip> TypeError: add() takes exactly 2 arguments, (0 given) 
END 
```

我确实理解错误——getattr() 返回一个要运行的函数，并且调用 fnc() 没有将任何参数传递给该函数——这里是 add()。但是如何获取传递给调用 dblr.add(1, 2) 的参数并将它们传递给 getattr() 调用返回的函数？

我正在寻找正确的方法来做到这一点，而不是使用 _ _ getattr _ _。我意识到使用 @ 的装饰器函数在这里可能是一个更好的工具，但我还不太了解它们是否可以在这里应用。

另外——我应该查看什么资源来为自己解决这个问题？我在 Lutz 的书籍、Cookbook 或 Python Library Reference 中都没有找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T17:14:28.037

`__getattr__`必须返回函数 - 而不是调用它的结果：

```
class Doubler:
  def __init__(self, source):
    self.source = source

  def __getattr__(self, attrname):
    fnc = getattr(self.source, attrname)
    return lambda x,y : fnc(x,y) * 2 
```

这使用了一个 lambda 表达式；它返回一个新函数，使 fnc 上的输出加倍

也许这个测试代码会让它更清楚：

```
import functions as f
import doubler as d
doublerInstance = d.Doubler(f)
print doublerInstance.add(1, 2)

doubleadd = doublerInstance.add

print doubleadd(1,2)
print doubleadd(2,3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:15:11.687

当您调用 时`doublerInstance.add(1, 2)`，您会`add`从中获取一个属性，然后您正在*调用*它。但是在您的 getattr 中，您正在返回一个值。你必须返回一个函数。

无论如何，要使这种特殊情况起作用，您需要：

```
def __getattr__(self, attrname) :
    fnc = getattr(self.source, attrname)
    def doubled(*args, **kwargs) :
        return 2 * fnc(*args, **kwargs)
    return doubled 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:17:45.643

试试这个：

```
class Doubler:
def __init__(self, source):
    self.source = source

def __getattr__(self, attrname):
    def tmp_func(*args):
        fnc = getattr(self.source, attrname)
        return fnc(*args) * 2
    return tmp_func 
```

提示： **getattr**必须返回一个函数，而不是函数调用的结果。

# java - 您在复杂的构建过程中使用什么？

> ID：521117
> 
> 赞同：11
> 
> 时间：2009-02-06T16:57:18.010
> 
> 标签：java, ant, build-process

我正在尝试改进我们的构建过程，它目前是一个巨大的 Ant build.xml，它调用其他 ant 构建文件并执行几个 Java 类来执行更复杂的逻辑，这在 Ant 中是不可能/可怕的尝试。

背景：

*   有 Java 和 Ant 经验，一些 Groovy
*   视窗平台

目标：

*   作为命令行 cron 和 servlet 发布到的组合运行
*   尽可能简化，最少的语言和技术之间的跳跃

我需要像 Java 这样的语言提供的更高级别的逻辑能力，Ant 非常简单，我们使用过滤来覆盖不同客户端的默认属性文件。大多数情况下，我想知道人们是否使用除 Ant/Java 之外的其他东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T17:10:14.350

除了你提到的Ant和scarry make/autotools之外，主流的工具有：

*   [缺点](http://www.scons.org)
*   [果酱](http://www.perforce.com/jam/jam.html)
*   [制作](http://www.cmake.org)
*   [马文](http://maven.apache.org/)

我使用 SCons，因为它是基于 python 的，资金充足且优雅。果酱似乎是最务实的一种。我对 CMake 了解不多。Maven 可能是您的选择，因为它以 Java 为中心并且比 Ant 更高级。

您可以在 wikipedia 上找到更多信息：[内置工具列表](http://en.wikipedia.org/wiki/List_of_build_automation_software)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T19:24:00.507

如果你追求 Maven，那么你将遇到两个问题：复杂的构建和学习 Maven 的 f@*#ing “魔法”。Maven 只会让问题变得更糟，因为它是迟钝且过于复杂的。

我继承了财富 500 强公司的遗留 Maven 1.x 版本。近年来，我在许多其他项目中选择使用 Maven 2.x。我评估了 Maestro，希望它可以使 Maven 易于处理。我的结论是，和许多其他人一样”（查看“网络”），Maven 是朝着错误方向迈出的一大步。这绝对不是对 Ant 的改进。

我已经使用 Ant 很多年了，包括编写一个大型的 Ant 辅助脚本开源库。我还广泛使用了它的 .NET 表亲 nAnt。但是，Ant 有两个主要缺点。一，XML 根本不适合执行构建任务。第二，Ant 和 XML 不能很好地扩展到大型、复杂的构建。事实上，我在 SO 上写了很多关于我在那个领域（以及与 Maven 的经历）的经历。

行业领导者已经得出结论，构建只是另一个应用程序，应该使用通用应用程序工具进行处理。但是，由于它涉及系统级和跨平台功能，因此大多数开发语言/平台并不适合（包括 Java，因此包括 Ant 和 Maven）。这也不包括 .NET。

我花了两年时间寻找替代方案，我找到了它：Python。它具有系统级访问、跨平台可移植性、简单性、可读性、功能、稳健性和成熟度的正确组合。SCons、buildbot、setuptools/easyinstall 和基础 Python 是我当前构建过程的目标平台。必要时，与 Ant、Maven 和任何其他此类工具的集成很容易。同时，我可以将这些工具用于任何平台上任何源语言的任何构建的核心。不再有障碍，不再有疯狂的复杂性，不再有所谓的有用的“声明性”脚本，不再有黑盒 f@*#ing “魔法”。

如果您不能切换到 Python，请尝试 Ant + Ivy（位于 apache.org）。它为您提供了 Maven 很酷的存储库，而没有 Maven 的大部分弊端。这也是我正在做的，在必要和合适的地方。

最良好的祝愿。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T17:25:11.403

也看看

*   [甘特](http://gant.codehaus.org/)
*   [摇篮](http://www.gradle.org/)

虽然像 SCons 这样更通用的构建系统非常强大，但与专门为构建 Java 项目而定制的系统相比，Java 支持有些有限。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T17:02:03.990

我喜欢使用[Rake](http://rake.rubyforge.org/)，因为您可以在需要时依靠整个[Ruby](http://www.ruby-lang.org/en/)语言的强大功能和它的框架库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T17:06:50.800

我使用 Ant，利用它的[宏特性](http://ant.apache.org/manual/Tasks/macrodef.html)。如果你以一致的方式布局你的项目，你可以通过编写宏来消除很多重复。

我一直在构建一个[Antlib](http://ant.apache.org/manual/Types/antlib.html)，其中包含我在多个项目中重复使用的宏和自定义任务。

或者，有些人对 Maven 发誓。其他人只是对Maven发誓。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T17:55:16.630

我使用 Maven，不只是用于构建，我还使用他们的 release/dist 插件。

在一对命令中，我可以将源代码控制中的代码用于构建、打包和发布。

发布插件处理更新版本号，dist 处理如何将所有内容放在一起并压缩。

与 Maven 相比，Ant 看起来很难。当然，使用 Maven 有一个学习曲线，但是阅读 pom.xml 比阅读 build.xml 容易得多。

Maven 需要不那么冗长。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T18:33:19.503

我喜欢 Ant，但前提是您花时间编写自己的 Java 插件来封装复杂的操作。这并不难，但不幸的是，大多数人都试图用 ant-contrib 的东西用 XML 编写他们的逻辑。我认为这是一个巨大的错误。

我听说过关于 rake 和 groovy 工具的好消息（在另一条评论中提到），但我没有使用它们的经验。

如果您尝试将生命周期中的多个步骤编写在一起，则最好使用基于流程自动化的构建服务器，例如 AnthillPro（Cruise、BuildForge 和 Electric-Commander 是该领域中的其他）。

提出此类问题的另一个地方是[CITCON 邮件列表](http://tech.groups.yahoo.com/group/citcon/)。[CITCON](http://www.citconf.com/)是一个关于持续集成和测试的会议，相关的邮件列表已经变成了一个围绕这些主题的非常棒的社区。

（我是 CITCON 的组织者，但我是热爱劳动而不是盈利者。它确实有一个非常有用的邮件列表。如果我为了钱而拉皮条，那将是[CI Guys](http://the.ci-guys.com/)。;-)）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T19:43:10.297

坚持使用 Ant，因为您正在构建 Java。我为一些 JNI 工作混合了 Ant/SCons，但总的来说，我会继续使用 Ant，尤其是因为您在 Ant 中已经有了一个现有的构建设置。移植到 Maven 就像将方形钉穿过没有孔的墙壁。

拥抱您的自定义 Java 逻辑，并考虑编写适当的 Ant 任务，而不是执行外部 Java 代码。我通过简单地扩展 Ant 来完全满足我的需要，解决了我们构建过程中一些非常复杂的部分，例如。管理大型 gui 项目的图标资源或直接注入 subversion 信息 info jar manifests（感谢 SVNKit）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-13T17:07:24.460

一周中的任何一天我都会和 Ant 一起去。

它并不完美；XML 非常冗长，几乎不可能实现任何逻辑，但即使是团队中最初级的工程师也至少可以在一天之内了解 ant 文件在做什么。

如果您愿意，可以使用 java 重构复杂的逻辑并将其集成到 ant 中。Ant 为您提供了 java 的所有功能:)

无论您使用什么系统，依赖关系解析都很困难。对于 ant，最好的解决方案似乎是存储所有 jar 的 lib 目录，或者是在构建时从中复制库的内部 Web 服务器。

我也有一些使用 Maven 1 和 Maven 2 的经验。这种经验让我觉得 Maven 非常适合业余项目，但随着时间的推移，你需要维护的软件可能会变得复杂。

我看到了 Maven 的两个重要问题：

*   您使用 Maven 导入的任何依赖项都可能在您不知情的情况下随时间而改变，从而导致奇怪的问题。
*   您不仅导入使用 Maven 直接导入的软件的许可证，还导入间接导入的库使用的许可证

简而言之，我不喜欢构建取决于启动时间的事实。在生产版本发布一年后生成错误修复版本时，这可能是一个真正的问题。

当然可以管理这些问题（可能使用 nexus 代理），但您需要在重建构建系统之前考虑它们。在我的公司，我们决定将 Ant 用于所有新项目，并尝试将 maven 1 和 2 移植到 ant，只要时机成熟。让它继续工作太难了。

我的建议是，如果您和您的团队知道如何处理 ant，请尝试重构您的 ant 文件，不要使用其他构建工具。只是要花太多时间才能把它做好。你可以花时间赚钱和作为一家公司生存:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-06T19:35:53.680

我们使用 luntbuild。这是一个非常易于使用的网络应用程序。它将从 CVS/SVN 中检出，自动增加版本/内部版本号，在 ant 脚本中执行构建任务并用新版本标记您的存储库。可以安排自动构建，通过电子邮件向您发送电子邮件或通过 IM 与您联系，还具有安全性和构建依赖项。

我们仍在使用 1.2.3 版本，但我看到它已达到 1.6.0。它只是工作。

[http://luntbuild.javaforge.com/](http://luntbuild.javaforge.com/)

编辑：重新阅读您的问题，我现在看到您正在寻找替代 Ant 的东西。在我们的例子中，Ant 并不是真正的问题。我们在 Netbeans 中设置了项目，它使用 Ant 进行构建，我们只需在 Netbeans 提供的现有脚本中实现一些挂钩，这很容易做到。

编辑：看起来你可以从 Groovy 调用 Ant。那会很好，因为这样您就可以重用 Ant 已经存在的所有任务。

[http://groovy.codehaus.org/Using+Ant+from+Groovy](http://groovy.codehaus.org/Using+Ant+from+Groovy)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T19:42:01.687

我尽可能使用 Rake。在需要构建 java 代码的地方，您可以将它与 jruby 一起使用，或者查看类似的内容：[buildr](http://buildr.apache.org)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-13T15:44:38.967

试试[FinalBuilder](http://www.finalbuilder.com)

它为您的构建过程提供了一个 GUI 界面，并为几乎所有内容提供了原生操作，以及一个您可以创建自己的操作工作室。

稍加规划就可以非常精简。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-18T04:36:47.150

我必须添加一个我发现我不能没有的解决方案......它叫做[Hudson](http://hudson-ci.org/)。设置只需几秒钟，您通常可以摆脱现有 ANT 文件已经在执行的大部分操作。

此外，Hudson 提供了一种很好的方式来“cron”构建、执行测试用例以及以任何人都可以下载的方式生成“工件”（例如构建产品）。

很难捕捉到它可以为你做的所有事情......所以试试吧......你不会失望的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-18T08:56:07.897

Maven 确实是进行大型构建的好选择……在大多数情况下，它不起作用非常简单。人们误解了 Maven 的概念。如果您正在使用“maven way”，您最终会得到更小的模块，从而为您的软件提供更好的架构。另一方面，像 Hudson 这样的东西将支持您通过使用 Maven 减少构建时间，因为 Hudson 支持仅构建任何其他构建工具都不支持的已更改模块。Maven 的问题在于学习和理解 Maven 的概念，例如项目的结构（文件夹等）或单个工件等。构建周期将在不同领域为您提供支持：编译、打包、部署和发布其他工具不支持（仅当您手动实现它时...我'

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2017-02-14T10:21:32.420

我主要使用 Ant，但 Maven 也是一个很好的工具。有了蚂蚁，你可以做任何你想做的事。

在我们公司，我们创建了一个通用的 ant 构建器，它可以做很多事情：构建、压缩图像、缩小、生成文档、打包文件。它是开源的，我们愿意改进。你可以在这里得到它：

[https://github.com/edertone/TurboBuilder](https://github.com/edertone/TurboBuilder)

# sql - RoR 可以将 char(1) 字段作为“布尔”字段处理吗？

> ID：521118
> 
> 赞同：0
> 
> 时间：2009-02-06T16:57:18.963
> 
> 标签：sql, ruby-on-rails, types

我正在考虑将 Ruby on Rails 用于必须利用现有数据的店面，但如果需要，我可以创建自己的数据库模式。我相信，现有数据中的许多字段都是 char(1) 模拟布尔字段（即 Y/N），以实现跨平台可移植性。由于数据容易发生变化，我不想更改现有结构并将这些字段转换为位/布尔字段。

如果我确实使用 Rails，我真的很想使用 Ruby 漂亮的布尔语法并说类似的东西`<%= image_tag 'recycled.jpg' if product.recycled? %>`，但是 Rails 会将 char(1) 识别为布尔值，还是我必须自己在模型中定义这些方法，例如：

```
class Product < ActiveRecord::Base
  # ... other stuff here
  def recycled?
    self.recycled == 'Y'
  end
end 
```

我想我必须自己重新定义它们，这没什么大不了的，我只是想确保因为使用 char(1) 作为是/否值不是我过去使用过的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:15:41.687

我可能会在模型级别对其进行攻击 - 当您将一行加载到模型实例中时，根据 char 计算一个布尔属性。为返回此值的虚拟属性添加一个 getter，以及一个更新布尔值和底层字符的 setter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:38:08.770

据我所知，您所描述的内容是`ActiveRecord`开箱即用的。

但是，如果你有很多这样的列，你可以考虑做一些元编程来提供一种声明性的方式来添加相关的访问器逻辑。就像是 ：-

```
class Product < ActiveRecord::Base

  yes_no_accessor :recycled

end 
```

另一种可能性是猴子补丁`ActiveRecord`。我认为相关的方法是`ActiveRecord::ConnectionAdapters::Column.value_to_boolean(value)`. 您可以尝试覆盖`ActiveRecord::ConnectionAdapters::Column::TRUE_VALUES`常量以包含`'Y'`. 这个我真的没试过！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-06T17:03:52.757

难道你不能用视图或存储过程将它包装在你的数据库引擎中，以便为你的应用程序生成一个一致的接口吗？

# php - 有没有从 PHP 脚本调用 CGI 脚本的好方法？

> ID：521120
> 
> 赞同：2
> 
> 时间：2009-02-06T16:57:35.077
> 
> 标签：php, apache, scripting, include, cgi

我看到 PHP 中有一个**virtual()**函数会调用 CGI 脚本，但这是最好的方法吗？我也可以将任何参数传递给该脚本吗？

我看到了一些使用**`file_get_contents()`**or **include()**并传入 CGI 脚本的 URL 的示例，但这感觉就像是 hack。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T17:32:40.763

如果可以在本地调用它，请使用**exec() 。**如果它需要作为 CGI 调用（因为脚本被设计为仅在 CGI 环境中工作），那么您需要通过**include()**或**file_get_contents()**调用它。**virtual()**将刷新您的缓冲区并附加子请求的输出。

您可以通过**include()**、**file_get_contents()**和**virtual()**将参数作为 GET 参数传递：

```
http://localhost/cgi-bin/foo?param1=val1&param2=val2 
```

如果可能，请走**exec()**路线。使用其他方法可能需要更改配置。

使用[exec](http://ca3.php.net/manual/en/function.exec.php) () 时，您需要像传递任何 CLI 程序一样传递参数。

```
foo val1 val2
foo param1=val1 param2=val2 
```

您如何传递参数将取决于您稍后在其他程序/脚本中如何解析它们。它们会出现在被调用的程序中，就像你从命令行调用它一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-07T08:52:12.113

我也无法从我的 php 页面调用 CGI 脚本。后来我意识到问题在于我的页面文件具有 .html 后缀，而不是 .php 后缀。修复该问题使我的脚本可以为我工作。这可能不是你的问题，但我想我会提到它以防万一。

# asp.net - 表单身份验证中的 cookieless=AutoDetect 是否损坏？

> ID：521132
> 
> 赞同：0
> 
> 时间：2009-02-06T16:59:55.073
> 
> 标签：asp.net

我通过在浏览器中禁用 cookie 并为表单元素和 sessionState 元素设置 cookieless="AutoDetect" 来尝试此操作。但是这不起作用（我的意思是如果启用了cookie，则url不变，但是如果禁用了cookie，则根据msdn docs将sessionid添加到查询字符串中）。我可以让它工作的唯一方法是，如果我将它设置为 UseUri，它将把 sessionid 添加到 url 路径，而不管 cookie 是否启用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T17:05:16.980

它没有损坏，但浏览器不会向浏览器报告它已禁用 cookie。

浏览器会报告它是什么浏览器，并且 ASP.NET 会保存一个浏览器列表和浏览器功能。此信息用于确定在使用 AutoDetect 时是否使用 cookieless

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:05:56.853

从[MSDN 中的 sessionState 页面](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)：

> 如果浏览器或设备支持 cookie，但当前禁用 cookie，请求功能仍会使用 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:28:58.603

如果您在开发机器上进行测试，您是否尝试过从浏览器中清除 cookie？在您禁用 cookie 之前，您的浏览器中可能已经有一个 cookie。

# c++ - “#define new DEBUG_NEW”和“#undef THIS_FILE”等真的有必要吗？

> ID：521133
> 
> 赞同：10
> 
> 时间：2009-02-06T16:59:56.740
> 
> 标签：c++, mfc, c-preprocessor

当您创建新的 MFC 应用程序时，向导会在几乎每个 CPP 文件中创建以下代码块：

```
#ifdef _DEBUG
#define new DEBUG_NEW
#endif 
```

有时它还会添加以下内容：

```
#undef THIS_FILE
static char THIS_FILE[] = __FILE__; 
```

如果它是多余的，我想从我的 CPP 文件中删除此代码。我在 VS2008 上使用带有 C++/CLI 的 MFC 应用程序。

从 CPP 中删除此代码后，我尝试在 Debug 中运行，它似乎工作正常。“新”变量工作正常，没有泄漏，并且 ASSERT 对话框显示正确的文件名并跳转到有问题的行。

谁能告诉我它的作用以及删除它是否安全？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T17:13:17.197

删除它是完全安全的。这是一个调试辅助工具；将其保留将在程序退出时的任何内存泄漏的输出窗口的警告中生成更好的详细信息。如果您删除它，您仍然会收到内存泄漏报告，但只是没有任何有关它们发生在源代码中的位置的详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-18T14:28:30.397

在 Microsoft Visual C++ 2010 上，我可以删除整个代码并在标题中只放一个#define NEW DEBUG_NEW，我仍然得到正确的内存泄漏报告，例如

```
Detected memory leaks!
Dumping objects ->
f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\strcore.cpp(156) : {7508} normal block at 0x029B9598, 54 bytes long.
 Data: <                > E4 B8 C9 00 12 00 00 00 12 00 00 00 01 00 00 00 
f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\strcore.cpp(156) : {7501} normal block at 0x029B94A8, 28 bytes long.
 Data: <                > E4 B8 C9 00 05 00 00 00 05 00 00 00 01 00 00 00 
f:\source\agent\agent\deviceid.cpp(21) : {7500} normal block at 0x029CDFC0, 8 bytes long.
 Data: <        > A8 95 9B 02 B8 94 9B 02 
f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\strcore.cpp(156) : {6786} normal block at 0x029C0D88, 160 bytes long.
 Data: <        G       > E4 B8 C9 00 19 00 00 00 47 00 00 00 01 00 00 00 
f:\source\agent\sysinfo\sysinfo.cpp(27) : {6733} normal block at 0x029B84D8, 92 bytes long.
 Data: <                > 00 00 00 00 00 10 00 00 00 00 01 00 FF FF FE 7F 
Object dump complete. 
```

# php - 如何在 Zend Framework 中从数据库创建动态链接？

> ID：521136
> 
> 赞同：0
> 
> 时间：2009-02-06T17:00:30.017
> 
> 标签：php, mysql, zend-framework

基本上我有点卡住了，

我一直在关注 Zend 网站上的[快速](http://framework.zend.com/docs/quickstart)入门，并希望对框架进行动态导航，我有 layout.phtml，其中`$this->render('navigation.phtml);`包含静态链接，但我希望让它们从数据库表中提取简单的英语不是 geekcaneeze 解释这样做的正确方法，IE 一页一页地通过简单的分步指南说明每个页面在做什么，因为我不是 PHP FREAK 或 Zend 框架大师，而是一个想要进步的网页设计师对于框架开发的世界，我理解它的使用价值的概念。

我相信它会治愈很多新手的很多头痛。换句话说，在阅读了 zend 框架工作参考之后，我仍然不知道他们在做什么。

尽管 Xampp 和文件结构代表相同，但我已经完成了所有工作

```
application/ 
config/
controllers/
layout/script/
models/
views/script/index/
views/script/error/
library/ 
public/ 
```

问候

马尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T16:45:23.573

假设您为您的数据库表设置了一个类（[ZF - 创建模型和数据库表](http://framework.zend.com/docs/quickstart/create-a-model-and-database-table)），您应该能够在您的 navigation.phtml 文件中执行以下操作：

```
<?php
$table = new Links_Table();
$links = $table->fetchAll();
?>

<? foreach ($links as $link) { ?>
   <a href="<?= $link->url ?>"><?= $link->title ?></a>
<? ?> 
```

如果您正在创建内部站点链接，那么您还可以设置一些路由器重写规则（[ZF - 标准路由器](http://framework.zend.com/manual/en/zend.controller.router.html)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:59:14.733

将它们拉到控制器中，将它们（例如作为数组）传递给视图：

```
$this->view->yourListOfLinks = getListOfLinksFromDB(); 
```

在视图（.phtml）示例中使用 foreach 输出它们：

```
foreach($this->yourListOfLinks as $link) {
   echo "<a href=\"$link\">$link</a>";
  } 
```

# javascript - 如何在 jQuery 中制作多语言键盘？

> ID：521137
> 
> 赞同：3
> 
> 时间：2009-02-06T17:00:32.747
> 
> 标签：javascript, jquery, api, plugins, keyboard

我正在寻找可以嵌入到我的网络应用程序中的多语言键盘 API 或插件。如果 jquery 中的插件更好，因为我已经在使用 jQuery 库。

我想要的键盘与 www.shabdkosh.com 的键盘一样（或更好）。在 shabdkosh.com 主页上，有一个带有搜索按钮的链接“key”，单击该链接，然后从“Key”链接旁边的组合框中选择“Romanized Hindi”。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-01T21:18:44.743

我有同样的问题，我问了我的老朋友谷歌。经过一番冒险，我得出如下结论：
[http://debugger.ru/demo/projects/virtualkeyboard/](http://debugger.ru/demo/projects/virtualkeyboard/) [准备就绪]
[http://mottie.github.com/Keyboard/](http://mottie.github.com/Keyboard/) [需要小修改]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-11T15:43:52.230

谷歌有一个[虚拟键盘](http://www.google.com/webelements/#show-virtualkeyboard)小部件。

编辑：看起来这个已经停产了。

# c# - C#拆分字符串但保留拆分字符/分隔符

> ID：521146
> 
> 赞同：102
> 
> 时间：2009-02-06T17:02:07.470
> 
> 标签：c#, string

我将字符串拆分为三个不同的字符，但我希望输出包含我拆分的字符。有什么简单的方法可以做到这一点？

# c++ - 窗口未最大化时缺少 WM_NCLBUTTONUP 消息的奇怪问题

> ID：521147
> 
> 赞同：6
> 
> 时间：2009-02-06T17:02:42.070
> 
> 标签：c++, winapi, mfc

我有一个处理 WM_NCLBUTTONUP 消息的窗口，以便处理对标题栏中自定义按钮的点击。当窗口最大化时这很有效，但当它不是时，WM_NCLBUTTONUP 消息永远不会到达！我确实收到了 WM_NCLBUTTONDOWN 消息。奇怪的是，如果我单击菜单栏的右侧，WM_NCLBUTTONUP 确实会到达，但是沿着标题栏/窗口框架的任何地方，消息永远不会到达。

经过一段时间的调试发现如果我在CMainFrame::OnNcLButtonDown()上设置断点，点击标题栏，但一直按住鼠标键，让调试器在函数中中断，按F5继续调试，然后释放鼠标按钮 - 神奇地发送了 WM_NCLBUTTONUP ！

我的问题有两个方面，（1）到底发生了什么？（2）我该如何解决这个“问题”。

我还注意到互联网上还有其他几个人有同样的问题（快速谷歌显示很多其他人有同样的问题，但没有解决方案）。

**编辑**
感谢前两个回复，我尝试在NCLButtonDown中调用ReleaseCapture，但没有效果（实际上它返回NULL，表示捕获不到位）。我只能假设基类（def window proc）功能可以设置捕获。我周一去调查...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T20:00:39.123

我有同样的问题。问题确实是左键单击窗口标题会开始拖动，因此鼠标捕获会阻止 WM_NCLBUTTONUP 到达。

解决方案是覆盖 WM_NCHITTEST：

```
LRESULT CALLBACK WndProc(HWND hWnd, UINT nMsg, WPARAM wParam, LPARAM lParam)
{
    switch (nMsg)
    {
        ...
        case WM_NCHITTEST:
            Point p(GET_X_LPARAM(lParam), GET_Y_LPARAM(lParam);
            ScreenToClient(p);
            if (myButtonRect.Contains(p))
            {
                return HTBORDER;
            }
            break;
    }
    return DefWindowProc(hWnd, nMsg, wParam, lParam);
} 
```

因此，基本上您通知 Windows 您的按钮占用的区域不是窗口标题的一部分，而是非客户区 (HTBORDER) 的非特定部分。

脚注：如果您在期望 WM_NCLBUTTONDOWN 消息进入时调用了 SetCapture() 并且尚未调用 ReleaseCapture()，则即使进行上述更改，它也不会到达。这可能很烦人，因为在与此类自定义按钮交互期间捕获鼠标是正常的，因此如果鼠标离开窗口，您可以取消单击/突出显示。但是，作为使用捕获的替代方法，您可以考虑使用较短（例如 100 毫秒）间隔的 SetTimer()/KillTimer()，这不会导致 WM_NCLBUTTONUP 消息消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:19:28.590

一个疯狂的猜测 - 一些代码正在捕获鼠标，可能是为了在你抓住标题时促进窗口移动。这也可以解释为什么在调试器中中断会导致消息出现 - 调试器交互正在清除鼠标捕获。

我建议您在该窗口上运行 Spy++，它是子窗口，并尝试找出谁收到了按钮向上消息。

至于如何修复它 - 如果不查看实际代码就无法帮助您。您必须找出罪魁祸首并查看他们的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T17:30:16.087

为了添加到[Franci Penov 的答案](https://stackoverflow.com/questions/521147/the-curious-problem-of-the-missing-wmnclbuttonup-message-when-a-window-isnt-max/521218#521218)，单击标题栏被解释为开始拖动以重新定位窗口。该窗口正在捕获鼠标，因此它可以执行拖动。由于无法拖动最大化的窗口，因此会跳过捕获并正常发送消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-18T08:00:02.413

在 WM_NCLBUTTONDOWN {代码块}中包含 ReleaseCapture()

# java - 值对的 Java 集合？（元组？）

> ID：521171
> 
> 赞同：398
> 
> 时间：2009-02-06T17:07:53.980
> 
> 标签：java

我喜欢 Java 有一个 Map，您可以在其中定义映射中每个条目的类型，例如`<String, Integer>`.

我正在寻找的是一种集合，其中集合中的每个元素都是一对值。对中的每个值都可以有自己的类型（如上面的字符串和整数示例），它是在声明时定义的。

集合将保持其给定的顺序，并且不会将其中一个值视为唯一键（如在地图中）。

本质上，我希望能够定义类型的 ARRAY`<String,Integer>`或任何其他 2 种类型。

我意识到我可以创建一个只包含 2 个变量的类，但这似乎过于冗长。

我也意识到我可以使用 2D 数组，但由于我需要使用不同的类型，我必须将它们设为 OBJECT 数组，然后我必须一直进行转换。

我只需要在集合中存储对，因此每个条目只需要两个值。如果不走课程路线，这样的事情是否存在？谢谢！

* * *

## 回答 #1

> 赞同：327
> 
> 时间：2012-06-28T22:17:35.803

## [AbstractMap.SimpleEntry](https://docs.oracle.com/javase/7/docs/api/java/util/AbstractMap.SimpleEntry.html)

很容易你正在寻找这个：

```
java.util.List<java.util.Map.Entry<String,Integer>> pairList= new java.util.ArrayList<>(); 
```

你怎么能填呢？

```
java.util.Map.Entry<String,Integer> pair1=new java.util.AbstractMap.SimpleEntry<>("Not Unique key1",1);
java.util.Map.Entry<String,Integer> pair2=new java.util.AbstractMap.SimpleEntry<>("Not Unique key2",2);
pairList.add(pair1);
pairList.add(pair2); 
```

这简化为：

```
Entry<String,Integer> pair1=new SimpleEntry<>("Not Unique key1",1);
Entry<String,Integer> pair2=new SimpleEntry<>("Not Unique key2",2);
pairList.add(pair1);
pairList.add(pair2); 
```

并且，在`createEntry`方法的帮助下，可以进一步减少冗长：

```
pairList.add(createEntry("Not Unique key1", 1));
pairList.add(createEntry("Not Unique key2", 2)); 
```

由于`ArrayList`不是最终的，它可以被子类化以公开一个`of`方法（和前面提到的`createEntry`方法），从而在语法上很简洁：

```
TupleList<java.util.Map.Entry<String,Integer>> pair = new TupleList<>();
pair.of("Not Unique key1", 1);
pair.of("Not Unique key2", 2); 
```

* * *

## 回答 #2

> 赞同：274
> 
> 时间：2009-02-06T17:24:26.863

Pair 类是那些很容易自己编写的“给我”泛型示例之一。例如，在我的脑海中：

```
public class Pair<L,R> {

  private final L left;
  private final R right;

  public Pair(L left, R right) {
    assert left != null;
    assert right != null;

    this.left = left;
    this.right = right;
  }

  public L getLeft() { return left; }
  public R getRight() { return right; }

  @Override
  public int hashCode() { return left.hashCode() ^ right.hashCode(); }

  @Override
  public boolean equals(Object o) {
    if (!(o instanceof Pair)) return false;
    Pair pairo = (Pair) o;
    return this.left.equals(pairo.getLeft()) &&
           this.right.equals(pairo.getRight());
  }

} 
```

是的，这存在于网络上的多个地方，具有不同程度的完整性和功能。（我上面的例子是不可变的。）

* * *

## 回答 #3

> 赞同：214
> 
> 时间：2014-09-02T02:42:58.153

# Java 9+

在 Java 9 中，您可以简单地编写：[`Map.entry(key, value)`](https://docs.oracle.com/javase/9/docs/api/java/util/Map.html#entry-K-V-) 创建一个不可变对。

**注意：**此方法不允许键或值为空。例如，如果您想允许空值，您需要将其更改为：`Map.entry(key, Optional.ofNullable(value))`。

* * *

# Java 8+

在 Java 8 中，您可以使用更通用的[`javafx.util.Pair`](https://docs.oracle.com/javase/8/javafx/api/javafx/util/Pair.html)方法来创建不可变的、可序列化的对。此类*确实*允许空键和空值。（在 Java 9 中，该类包含在`javafx.base`模块中）。**编辑：从 Java 11 开始，JavaFX 已与 JDK 分离，因此您需要额外的 maven 工件 org.openjfx:javafx-base。**

* * *

# Java 6+

[`AbstractMap.SimpleImmutableEntry`](https://docs.oracle.com/javase/7/docs/api/java/util/AbstractMap.SimpleImmutableEntry.html)在 Java 6 及更高版本中，您可以对不可变对或[`AbstractMap.SimpleEntry`](https://docs.oracle.com/javase/7/docs/api/java/util/AbstractMap.SimpleEntry.html)值可以更改的对使用更详细的方法。这些类还允许空键和空值，并且是可序列化的。

* * *

# 安卓

如果您正在为 Android 编写代码，只需使用[`Pair.create(key, value)`](https://developer.android.com/reference/android/util/Pair.html#create(A,%20B))创建一个不可变对。

* * *

# 阿帕奇公地

[`Apache Commons Lang`](https://commons.apache.org/proper/commons-lang/)有助于[`Pair.of(key, value)`](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/tuple/Pair.html#of-L-R-)创建一个不可变的、可比较的、可序列化的对。

* * *

# 日食系列

如果您使用包含原语的对，[Eclipse Collections](https://www.eclipse.org/collections/)提供了一些非常有效的原语对类，可以避免所有低效的自动装箱和自动拆箱。

例如，您可以使用[`PrimitiveTuples.pair(int, int)`](https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/impl/tuple/primitive/PrimitiveTuples.html#pair-int-int-)创建一个[`IntIntPair`](https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/tuple/primitive/IntIntPair.html)，或[`PrimitiveTuples.pair(float, long)`](https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/impl/tuple/primitive/PrimitiveTuples.html#pair-float-long-)创建一个[`FloatLongPair`](https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/tuple/primitive/FloatLongPair.html).

* * *

# 龙目岛计划

使用[Project Lombok](https://projectlombok.org/)，您只需编写以下代码即可创建不可变对类：

```
@Value
public class Pair<K, V> {
    K key;
    V value;
} 
```

Lombok 将在生成的字节码中自动为您填写构造函数、getter、、、`equals()`和`hashCode()`方法`toString()`。如果您想要一个静态工厂方法而不是构造函数，例如 a `Pair.of(k, v)`，只需将注释更改为：`@Value(staticConstructor = "of")`。

* * *

# 除此以外

如果上述解决方案都没有浮出水面，您可以简单地复制并粘贴以下代码（与接受的答案中列出的类不同，它可以防止 NullPointerExceptions）：

```
import java.util.Objects;

public class Pair<K, V> {

    public final K key;
    public final V value;

    public Pair(K key, V value) {
        this.key = key;
        this.value = value;
    }

    public boolean equals(Object o) {
        return o instanceof Pair && Objects.equals(key, ((Pair<?,?>)o).key) && Objects.equals(value, ((Pair<?,?>)o).value);
    }

    public int hashCode() {
        return 31 * Objects.hashCode(key) + Objects.hashCode(value);
    }

    public String toString() {
        return key + "=" + value;
    }
} 
```

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2009-02-06T17:28:14.423

# `Map.Entry`

这些内置类也是一种选择。两者都实现了[`Map.Entry`](https://docs.oracle.com/javase/10/docs/api/java/util/Map.Entry.html)接口。

*   [`AbstractMap.SimpleEntry`](https://docs.oracle.com/javase/10/docs/api/java/util/AbstractMap.SimpleEntry.html)
*   [`AbstractMap.SimpleImmutableEntry`](https://docs.oracle.com/javase/10/docs/api/java/util/AbstractMap.SimpleImmutableEntry.html)

[![带有一对实现类的 Map.Entry 接口的 UML 图](https://i.stack.imgur.com/r72Q0.png)](https://i.stack.imgur.com/r72Q0.png)

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2012-12-11T23:56:06.893

Apache common lang3 有 Pair 类和这个线程中提到的几个其他库[Java 中的 C++ Pair<L,R> 等价物是什么？](https://stackoverflow.com/questions/156275/what-is-the-equivalent-of-the-c-pairl-r-in-java/156685#156685)

符合原始问题要求的示例：

```
List<Pair<String, Integer>> myPairs = new ArrayList<Pair<String, Integer>>();
myPairs.add(Pair.of("val1", 11));
myPairs.add(Pair.of("val2", 17));

//...

for(Pair<String, Integer> pair : myPairs) {
  //following two lines are equivalent... whichever is easier for you...
  System.out.println(pair.getLeft() + ": " + pair.getRight());
  System.out.println(pair.getKey() + ": " + pair.getValue());
} 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2014-05-15T06:09:35.403

对于为 Android 开发的任何人，您都可以使用[android.util.Pair](http://developer.android.com/reference/android/util/Pair.html)。:)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-11-14T19:34:19.270

“Apache Commons Lang 3”`Pair`类和相关子类呢？

```
 import org.apache.commons.lang3.tuple.ImmutablePair;
    import org.apache.commons.lang3.tuple.Pair;
    ...
    @SuppressWarnings("unchecked")
    Pair<String, Integer>[] arr = new ImmutablePair[]{
            ImmutablePair.of("A", 1),
            ImmutablePair.of("B", 2)};

    // both access the 'left' part
    String key = arr[0].getKey();
    String left = arr[0].getLeft();

    // both access the 'right' part
    Integer value = arr[0].getValue();
    Integer right = arr[0].getRight(); 
```

`ImmutablePair`是一个特定的子类，它不允许修改对中的值，但是还有其他具有不同语义的实现。如果需要，这些是 Maven 坐标。

```
 <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>3.4</version>
        </dependency> 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-02-06T17:16:17.473

您可以编写一个通用的 Pair<A, B> 类并在数组或列表中使用它。是的，你必须写一个类，但是你可以为所有类型重用同一个类，所以你只需要写一次。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-02-27T23:15:12.580

扩展其他答案，一个通用的不可变 Pair 应该有一个静态方法，以避免在调用构造函数时使代码混乱：

```
class Pair<L,R> {
      final L left;
      final R right;

      public Pair(L left, R right) {
        this.left = left;
        this.right = right;
      }

      static <L,R> Pair<L,R> of(L left, R right){
          return new Pair<L,R>(left, right);
      }
} 
```

如果您将静态方法命名为“of”或“pairOf”，则代码会变得流畅，因为您可以编写以下任一代码：

```
 list.add(Pair.of(x,y)); // my preference
    list.add(pairOf(x,y)); // use with import static x.y.Pair.pairOf 
```

真可惜，核心 Java 库在这些事情上如此稀疏，以至于你必须使用 commons-lang 或其他 3rd 方来做这些基本的事情。升级到 scala 的另一个原因...

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-02-06T17:51:51.397

正如您所描述的，首选的解决方案是一对列表（即列表）。

为此，您将创建一个 Pair 类以在您的集合中使用。这是一个有用的实用程序类，可以添加到您的代码库中。

Sun JDK 中提供类似于典型 Pair 类的功能的最接近的类是 AbstractMap.SimpleEntry。你可以使用这个类而不是创建你自己的 Pair 类，尽管你将不得不忍受一些尴尬的限制，而且我认为大多数人会对此不以为然，因为这并不是 SimpleEntry 的预期角色。例如，SimpleEntry 没有“setKey()”方法，也没有默认构造函数，因此您可能会发现它过于局限。

请记住，集合旨在包含单一类型的元素。Map 等相关实用程序接口实际上并不是Collection（即Map 没有实现Collection 接口）。Pair 也不会实现 Collection 接口，但显然是构建更大数据结构的有用类。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-06T17:19:23.130

我想问你是否不想只使用 a `List<Pair<T, U>>`？但是，当然，JDK 没有 Pair<> 类。但谷歌很快在[Wikipedia](http://en.wikipedia.org/wiki/Generics_in_Java#Generic_class_definitions)和[forums.sun.com](http://forums.sun.com/thread.jspa?threadID=5132045)上找到了一个。干杯

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-06-19T20:45:34.023

这是基于 JavaHelp4u 的代码。

不那么冗长，并展示了如何在一行中完成以及如何循环。

```
//======>  Imports
import java.util.AbstractMap.SimpleEntry;
import java.util.ArrayList;
import java.util.List;
import java.util.Map.Entry;

//======>  Single Entry
SimpleEntry<String, String> myEntry = new SimpleEntry<String, String>("ID", "Text");
System.out.println("key: " + myEntry.getKey() + "    value:" + myEntry.getValue());
System.out.println();

//======>  List of Entries
List<Entry<String,String>> pairList = new ArrayList<>();

//-- Specify manually
Entry<String,String> firstButton = new SimpleEntry<String, String>("Red ", "Way out");
pairList.add(firstButton);

//-- one liner:
pairList.add(new SimpleEntry<String,String>("Gray", "Alternate route"));  //Ananomous add.

//-- Iterate over Entry array:
for (Entry<String, String> entr : pairList) {
    System.out.println("Button: " + entr.getKey() + "    Label: " + entr.getValue());
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2019-08-19T17:46:46.843

Spring[`Pair<S,T>`](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/util/Pair.html)在 Data Utils 包中有一个类型[`org.springframework.data.util`](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/util/package-summary.html)

```
Pair<String,Integer> pair = Pair.of("Test", 123);
System.out.println(pair.getFirst());
System.out.println(pair.getSecond()); 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2021-07-29T15:43:56.530

**Java 14+ 版本**

您可以创建一个`record`实现`equals`、`hashCode`和`toString`开箱即用的方法。`Comparable`如果需要，也可以实现类似的接口。

```
record Pair<A, B>(A first, B second) {} 
```

记录是不可变的。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-07-22T22:15:05.000

**Apache Crunch**还有一个`Pair`类： [http ://crunch.apache.org/apidocs/0.5.0/org/apache/crunch/Pair.html](http://crunch.apache.org/apidocs/0.5.0/org/apache/crunch/Pair.html)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-11-01T15:42:45.860

只需创建一个类

```
class Tuples 
{ 
    int x;
    int y;
} 
```

然后创建这个元组对象的列表

```
List<Tuples> list = new ArrayList<>(); 
```

所以你也可以用同样的方式实现其他新的数据结构。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-09-05T11:16:07.143

我的意思是，即使`Pair`Java 中没有类，也有一些非常相似的东西：`Map.Entry`

[Map.Entry 文档](https://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html)

这是（相当简单的）什么`HashMap`，或者实际上是任何`Map`商店。

您可以创建一个`Map`将值存储在其中的实例并获取条目集。你最终会得到一个`Set<Map.Entry<K,V>>`你想要的。

所以：

```
public static void main(String []args)
{    
    HashMap<String, Integer> values = new HashMap<String,Integer>();
    values.put("A", 235);//your custom data, the types may be different
    //more data insertions....
    Set<Map.Entry<String,Integer>> list = values.entrySet();//your list 
    //do as you may with it
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-06-19T06:22:57.470

com.sun.tools.javac.util.Pair 呢？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-08-14T06:19:43.917

在谈论键/值对时，我首先想到的是[属性类](https://docs.oracle.com/javase/7/docs/api/java/util/Properties.html)，您可以在其中将项目保存和加载到流/文件中。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-02-27T15:14:55.450

在项目 Reactor (io.projectreactor:reactor-core) 中有对 n-Tuples 的高级支持：

```
Tuple2<String, Integer> t = Tuples.of("string", 1) 
```

在那里你可以得到`t.getT1(), t.getT2(), ...`特别是使用 Stream 或 Flux 你甚至可以映射元组元素：

```
Stream<Tuple2<String, Integer>> s;
s.map(t -> t.mapT2(i -> i + 2)); 
```

# sql - 我需要在一个像样的网页或 word doc 上显示 excel 数据？

> ID：521185
> 
> 赞同：0
> 
> 时间：2009-02-06T17:11:57.327
> 
> 标签：sql, xml, excel, xhtml, formatting

我有以 excel 格式格式化的调查结果。然后，我需要在可呈现的 word doc 或 web 页面上单独显示这些结果吗？有什么办法可以做到这一点。

例如：

第一栏 - 第二栏

结果 1 - 结果 1

结果 2 - 结果 2

至

第1栏

结果一

第 2 栏

结果一

第 1 列

结果 2

第 2 栏

结果 2

对不起，如果这没有意义。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T19:03:55.010

听起来您需要在 word 中使用“邮件合并”，然后将 Excel 电子表格作为数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T20:21:33.357

您的问题中没有太多信息可供参考，但您似乎可以使用宏来转换数据。我编写了一个快速宏，它以您提供的格式获取数据并按照您指定的格式输出。

我将使用下面的宏在 Excel 中创建一个新的工作表，然后根据需要对其进行操作或将其粘贴到 Word 中。没有更多信息，没有更多可说的。

```
**Input**
Column A      Column B
Result A1     Result B1
Result A2     Result B2
**Output**
Column A
Result A1
Column B
Result B1
Column A
Result A2
Column B
Result B2 
```

这是宏：

```
' Transforms the current sheet
' This method takes columns and rows and outputs a
' single This is not a transpose method, but similar.
Public Sub TransformSheet()
    Dim SourceSheet As Worksheet
    Dim ResultSheet As Worksheet
    Dim iSourceColumn As Long, iSourceRow As Long
    Dim iResultColumn As Long, iResultRow As Long
    Dim iHeaderRow As Long
    Dim UseCopyPaste As Boolean
    ' Change source and result sheets as necessary
    Set SourceSheet = ActiveSheet
    Set ResultSheet = ActiveWorkbook.Sheets("Sheet2")
    ' Options
    UseCopyPaste = True
    iHeaderRow = 1
    iResultColumn = 1
    iResultRow = 1
    ' Main Loop
    For iSourceRow = 2 To SourceSheet.UsedRange.Rows.Count
        For iSourceColumn = 1 To SourceSheet.UsedRange.Columns.Count
            If UseCopyPaste Then
                ' Header Column
                SourceSheet.Cells(iHeaderRow, iSourceColumn).Copy
                ResultSheet.Cells(iResultRow, iResultColumn).PasteSpecial xlPasteAll
                iResultRow = iResultRow + 1
                ' Result  Column
                SourceSheet.Cells(iSourceRow, iSourceColumn).Copy
                ResultSheet.Cells(iResultRow, iResultColumn).PasteSpecial xlPasteAll
                iResultRow = iResultRow + 1
            Else
                ' Header Column
                ResultSheet.Cells(iResultRow, iResultColumn) = _
                    SourceSheet.Cells(iHeaderRow, iSourceColumn).Value
                iResultRow = iResultRow + 1
                ' Result Column
                ResultSheet.Cells(iResultRow, iResultColumn) = _
                    SourceSheet.Cells(iSourceRow, iSourceColumn).Value
                iResultRow = iResultRow + 1
            End If
        Next iSourceColumn
    Next iSourceRow
End Sub 
```

# telnet - 从 AS400 telnet 到端口 25

> ID：521186
> 
> 赞同：1
> 
> 时间：2009-02-06T17:12:11.257
> 
> 标签：telnet, ibm-midrange

我想通过 SMTP 连接从 VM 中的 AS400 到端口 25 上的邮件服务器

as400 上的本机 telnet 命令似乎不支持端口规范。

任何想法如何从 as400 远程登录到我的邮件服务器上的端口 25？

我可以从 as400 ping 邮件服务器

我可以从其他盒子远程登录（非 as400）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T17:18:09.637

我刚刚在 i5/OS V5R4 上试过这个：

```
TELNET RMTSYS(hostname) ASCOPRMOD(*VT100) PORT(25) 
```

我还在[V5R2 中找到了有关 telnet 支持的 IBM 手册，该手册](http://publib.boulder.ibm.com/iseries/v5r2/ic2924/info/rzaiw/rzaiw.pdf)建议您也可以在旧版本中指定端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T11:32:58.987

在命令行键入“TELNET”，按F4，填写远程系统名称，按F10，向下翻页，向下翻页，找到“端口”字段。将其从“*DFT”更改为“25”。按 Enter。

完成后，按 F9 获取相应的命令行调用。

# asp.net - GridView 分页发生变化。在回发时捕获

> ID：521189
> 
> 赞同：1
> 
> 时间：2009-02-06T17:12:51.130
> 
> 标签：asp.net, page-index-changed

在 page_load() 上，

有没有办法捕获分页值已更改？（例如从第 1 页到第 2 页）

这与 Gridview 控件有关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T17:21:35.543

约翰 - 你为什么要在 page_load 中寻找这个？您最好在 gridview 上处理 PageIndexChanged 或 PageIndexChanging 事件。

如果您需要知道在 page_load 期间导致回发的控件 - 请查看[此帖子](https://stackoverflow.com/questions/49302/how-to-identify-postback-event-in-pageload)以获取解决方案。在该解决方案中，他们建议您查询 Request["__EVENTTARGET"] 变量。另一个类似的解决方案是[here](http://forums.asp.net/p/1380847/2919431.aspx#2919431)。

# c# - 如何从上次修改日期起一天后刷新 xml 缓存？

> ID：521193
> 
> 赞同：1
> 
> 时间：2009-02-06T17:14:08.070
> 
> 标签：c#, asp.net, datetime, dataset

我正在使用 ASP.NET 2.0 (C#) 开发一个 Web 应用程序，在主页上我显示最近添加的记录。添加记录的频率约为每天 1-5 条记录，因此我决定不通过每次从数据库服务器获取最近的记录来在 sql 服务器上增加太多开销。

因此，为了缓存数据，我使用了 XML 文件，我从数据集（.NET 中的 ds.WriteXML 函数）生成了 XML 文件，现在让我们说今天（2008 年 1 月 10 日 12:30:00）我创建了一个文件recent-cache.xml 被创建。因此，最近的缓存文件有效期为一天。

然后，如果当前日期和上次修改日期之间的差异大于或等于 1 天，则必须使用来自 db 服务器的新数据再次生成缓存 xml 文件。

所以，我想要代码，我可以使用它来获取 xml 文件的最后修改日期，然后找到（当前和文件最后修改日期）日期之间的差异。

还请告诉我我认为更好的解决方案，或者我们可以做其他任何事情，其他一些简单而快速的技术。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:36:01.380

您可能会考虑使用 ASP.NET Cache API，它的存在是为了完成您所描述的那种工作。您可以将任何对象（如 XmlDocument 或 DataSet）添加到 Cache 集合并指定您希望它在其中的时间，如下所示：

```
Cache.Insert("MyCacheKey", myObjectToCache, null, DateTime.Now.AddDays(1), null); 
```

然后您可以使用如下函数获取缓存数据：

```
const string CACHE_KEY = "MyCacheKey";

private DataSet RecentlyAdded()
{
    if(Cache[CACHE_KEY] == null)
        Cache.Insert(CACHE_KEY, GetRecentlyAddedFromDatabase(), null, DateTime.Now.AddDays(1), null);
    return Cache[CACHE_KEY];
} 
```

缓存 API 有许多其他的整洁功能，但这将完成您想要的，而无需推出您自己的基于文件的解决方案。

请注意，如果您的应用程序在一天结束之前关闭，缓存将随之关闭，并且“最近添加”的数据库查询将不得不在下次请求数据时再次运行。

编辑：将缓存键更改为字符串常量，因此只需指定一次。

# java - 资源文件中的 Java 菜单助记符

> ID：521199
> 
> 赞同：9
> 
> 时间：2009-02-06T17:15:36.243
> 
> 标签：java, internationalization

我想为`JMenu`使用资源包（或`ResourceMap`）分配助记符。因此，例如，没有资源文件的代码将是......

```
JMenu fileMenu = new JMenu();
fileMenu.setText("File");   // this would be read from a resource file
fileMenu.setMnemonic('F');  // but the docs say this is obsolete
fileMenu.setMnemonic(KeyEvent.VK_F); 
```

那么如何将 KeyEvent.VK_F 放在资源文件中呢？

对于一个`JMenuItem`我可以通过行动来做到这一点，但这是`JMenu`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T20:36:42.497

Java 的[javax.swing.KeyStroke](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/KeyStroke.html)类弥补了这一差距：

```
JMenu fileMenu = new JMenu();
String mnemonic = // string from localization
fileMenu.setMnemonic(KeyStroke.getKeyStroke(mnemonic).getKeyCode());
```

s不支持加速器`JMenu`，只支持`JMenuItem`s （这是有道理的，因为它们调用一个动作而不使用菜单）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:44:14.757

在资源文件中使用加速器

add.Action.accelerator = 控制 A

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:03:52.450

您可以以类似的方式进行操作，并将“FileMenu”视为（假）操作吗？

# xml - 为什么 XDocument.Descendants() 在 PowerShell ISE 中返回 IEnumerator？

> ID：521204
> 
> 赞同：1
> 
> 时间：2009-02-06T17:16:13.650
> 
> 标签：xml, powershell, linq-to-xml, powershell-2.0, powershell-ise

我正在编写一个 PowerShell 脚本来操作一些 Windows Installer XML (WiX)。我正在使用 .NET 3.5 中的新 XML API 来执行此操作，因为我发现它比 DOM 更易于使用。以下脚本片段断然拒绝工作：

```
[System.Reflection.Assembly]::LoadWithPartialName("System.Xml.Linq") | Out-Null

# Basic idea: Iterate through en.wxl's l10ns, get string for each l10n, search all wxs files for that value.

pushd "C:\temp\installer_l10n"
$wxlFileName = "${pwd}\en.wxl"
$wxl = [System.Xml.Linq.XDocument]::Load($wxlFileName)
$strings = $wxl.Descendants("String")
$strings
$strings | foreach {
    $_
}
popd 
```

该脚本*应*在单独的行上输出每个 <String> 标记。一旦这个错误被解决，我将让它做一些更有趣的事情;-)

XML 文档是一个标准的 WiX 本地化文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<WixLocalization Culture="en-US" xmlns="http://schemas.microsoft.com/wix/2006/localization">
   <String Id="0">Advertising published resource</String>
   <String Id="1">Allocating registry space</String>
   ...
</WixLocalization> 
```

$strings 不是 $null（我已经明确测试过），如果我写主机 $wxl，我可以看到文档已经加载。将 $strings 导入 Get-Member 会返回一个错误，指出“没有为 get-member 指定对象”并且 write-host $strings 什么也不做。我也试过 $wxl.Descendants("WixLocalization") 得到相同的结果。$wxl.Root 和 $wxl.Nodes 之类的东西按预期工作。使用 PowerShell ISE 进行调试，我看到 $strings 已设置为 IEnumerator，而不是预期的 IEnumerable<XElement>。使用单个 MoveNext 和 Current 测试 IEnumerator 指示“Current =”，大概是 $null。

奇怪的是，相同的技术在以前的脚本中也有效。完全相同的代码，但具有不同的变量名和字符串文字。并且刚刚尝试调试该脚本（以验证行为），它现在似乎也显示相同的行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T07:06:05.277

这个问题引起了我的兴趣，所以我做了一些搜索。在 PowerShell 中搞砸了很多东西并在网上搜索后，我找到了您的解决方案。

实际代码归功于 Jamie Thomson。 [http://dougfinke.com/blog/index.php/2007/08/07/using-xmllinq-in-powershell/](http://dougfinke.com/blog/index.php/2007/08/07/using-xmllinq-in-powershell/)

缺少的部分是处理 XML 文件中的命名空间。这是应该为您工作的代码：

```
[System.Reflection.Assembly]::LoadWithPartialName("System.Xml.Linq") | Out-Null
# Basic idea: Iterate through en.wxl's l10ns, get string for each l10n, search all wxs files for that value.

$wxlFileName = "${pwd}\en.wxl"
$wxl = [System.Xml.Linq.XDocument]::Load($wxlFileName)
$ns = [System.Xml.Linq.XNamespace]”http://schemas.microsoft.com/wix/2006/localization”
$strings = $wxl.Descendants($ns + "String")
foreach ($string in $strings) {
    $string
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:52:07.857

我知道你说过你不喜欢使用 DOM，但是有什么理由不适合你吗？

```
[xml]$test = gc .\test.wml                                                                                        
$test                                                                                                             
$test.WixLocalization                                                                                             
$test.WixLocalization.String 
```

这输出：

PS> $test.WixLocalization.String

Id #text
-- -----
0 广告发布资源
1 分配注册表空间

在那一点上，解决这个问题应该不会太困难。

# sas - 在 SAS 中，在数据步骤之外，用空白替换宏变量中的字符的最佳方法是什么？

> ID：521207
> 
> 赞同：1
> 
> 时间：2009-02-06T17:17:28.017
> 
> 标签：sas, sas-macro

在 SAS 中，在数据步骤之外，用空白替换宏变量中的字符的最佳方法是什么？

这似乎`TRANSLATE`是一个很好的功能。但是，当`%SYSFUNC`与此函数一起使用时，参数不会用引号括起来。您如何表示应使用空白作为替换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T17:20:23.813

%str( )（括号之间有一个空格）可用于指示此参数的空格。还要小心翻译...第二个参数是替换字符...但是在 TRANWRD 中它是相反的。

```
 %macro test ;
     %let original= translate_this_var ;
     %let replaceWithThis= %str( ) ;
     %let findThis= _ ;
     %let translated= %sysfunc(translate(&original, &replaceWithThis, &findThis)) ;
     %put Original: &original ***** TRANSLATEd: &translated ;
    %mend ;
    %test;

    %macro test2 ;
     %let original= translate_this_var ;
     %let replaceWithThis= %str( ) ;
     %let findThis= _ ;
     %let tranwrded= %sysfunc(tranwrd(&original, &findThis, &replaceWithThis)) ;
     %put Original: &original ***** TRANWRDed: &tranwrded ;
    %mend ;
    %test2 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T09:29:48.260

宏语言中没有引号。唯一使用的引号字符是`&`等`%`，表示文本应被解释为宏“操作符”。`%str( )`如上Carolina的帖子中所示，空白表示为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-22T04:39:50.477

您可以改用 perl reg ex，例如：

```
%put ***%sysfunc(prxchange(s/x/ /, -1, abxcdxxf))***;
/* on log
***ab cd  f***
*/ 
```

# c# - 使用 CryptDecrypt 解密 RijndaelManaged 加密字符串

> ID：521220
> 
> 赞同：0
> 
> 时间：2009-02-06T17:20:17.027
> 
> 标签：c#, c++, aes, rijndaelmanaged, rijndael

好的，我正在尝试使用 C++ 中的 Win32 Crypto API 来解密使用 RijndaelManaged 类在 C# (.NET 2) 中加密的字符串。但是我一点运气都没有，我得到了乱码或错误的数据 Win32 错误代码。我所有的钥匙，IV 和盐匹配，我已经在手表中查看了两个测试应用程序。我已经花了很多时间在看它，但我被官方卡住了。

无论如何，这里是 C#

```
 Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(GetPassPhrase(), salt, 1000);
        RijndaelManaged rijndael = new RijndaelManaged();
        rijndael.BlockSize = 128;
        rijndael.KeySize = 256;
        rijndael.Mode = CipherMode.CBC;

        rijndael.Key = pdb.GetBytes(m_KeySize);
        rijndael.IV = GetIV(iv);

        ICryptoTransform encryptor = rijndael.CreateEncryptor(); 
        MemoryStream msEncrypt = new MemoryStream();
        CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write);
        Byte[] encryptedBytes = null;
        Byte[] toBeEncrypted = UnicodeEncoding.Unicode.GetBytes(value);

        csEncrypt.Write(toBeEncrypted, 0, toBeEncrypted.Length);
        csEncrypt.FlushFinalBlock();
        encryptedBytes = msEncrypt.ToArray(); 
```

解密它的 C++ 是：

```
 keyBlob.hdr.bType = PLAINTEXTKEYBLOB;
                keyBlob.hdr.bVersion = CUR_BLOB_VERSION;
                keyBlob.hdr.reserved = 0;
                keyBlob.hdr.aiKeyAlg = CALG_AES_256;
                keyBlob.cbKeySize = KEY_SIZE;
                keyBlob.rgbKeyData = &byKey[0];

                if ( CryptImportKey( hProv, (const LPBYTE) &keyBlob, sizeof(BLOBHEADER) + sizeof(DWORD) + KEY_SIZE, 0, CRYPT_EXPORTABLE, &hKey ) )
                {

                    if ( CryptSetKeyParam( hKey, KP_IV, (const BYTE *) &byIV, 0))
                    {
                        DWORD dwLen = iDestLen;
                        if ( CryptDecrypt( hKey, 0, TRUE, 0, pbyData, &dwLen))
                        {

                            if ( dwLen < (DWORD) *plOutSize)
                            {
                                memcpy_s(pbyOutput, *plOutSize, pbyData, dwLen);

                                *plOutSize = dwLen;

                                bRet = TRUE; 
                            }
                        }
                        else
                        {
                            // Log
                            DWORD dwErr = ::GetLastError();
                            int y =0;
                        }
                    }
                } 
```

我成功调用 CryptAcquireContext 并且我的 C++ 执行良好。谁能以我的方式发现错误。它开始让我沮丧知道:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:32:28.047

好吧，我的错，我没有在 C++ 中包含 keyblob 的 Struct def，结果你需要一个带有标题的键的连续数据块，但我使用的是 MSDN 示例，它有一个指向键数据的指针. 这是错的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T17:24:54.133

我看到您正在使用 CBC 链接模式来加密纯文本。

您确定您使用相同的链接模式来解密密码文本吗？

（对不起。我无法从代码中理解）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T01:47:10.407

您应该检查一些事情，因为缺少一些代码（声明等）：

*   块大小 - 这通常应该与密钥大小相同，我认为它甚至可能是默认值，因为您没有在 C++ 端指定它。在 C# 端将其设置为 256，我想你最好在 C++ 中明确指定它。
*   填充 - 托管类将 PKCS7 作为其默认填充，我*认为*它也是 cryptoAPI 函数的默认值，但我不确定。
*   我假设 GetPassPhrase、GetIV 等为您提供了与您在 C++ 端使用的相同的密钥？
*   不清楚程序之间如何传递加密数据，是否可能存在某种翻译错误？例如 base64、URL 编码等。

# linux - 在 shell 脚本中将脚本目录更改为用户的主目录

> ID：521226
> 
> 赞同：5
> 
> 时间：2009-02-06T17:20:53.877
> 
> 标签：linux, bash, shell

在我的 bash 脚本中，我需要将当前目录更改为用户的主目录。

如果我想从命令行更改为用户的*foo主目录，我可以这样做：*

```
cd ~foo 
```

效果很好，但是当我从*脚本*中执行相同操作时，它告诉我：

```
./bar.sh: line 4: cd: ~foo: No such file or directory 
```

像这样的接缝将是一件微不足道的事情，但它不起作用。这里有什么问题？我是否需要转义“~”或可能缺少引号或其他内容？

**编辑**

当我说*用户*时，我指的不是运行脚本的*当前*用户，而是系统上的任何*其他*用户

**编辑**

这是脚本：

```
#!/bin/bash

user="foo"
cd ~$user 
```

如果用户名是硬编码的

```
cd ~foo 
```

它有效，但如果它在*用户*变量中，那么它不会。我在这里想念什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-06T17:43:40.943

关于什么

```
cd $(getent passwd foo | cut -d: -f6) 
```

和

```
USER=foo
eval cd ~$USER 
```

也可以（foo 是用户名）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T17:22:46.383

将其更改为：

```
cd $HOME 
```

实际上，我不确定为什么`cd ~whatever`行不通。我刚刚用一个小脚本进行了测试，它运行良好：

```
#!/bin/bash

cd ~sbright 
```

实际上，当系统上不存在指定用户时，我会收到相同的错误消息。您确定（是的，我知道这是其中一个是插件问题）用户存在并且指定了有效的主目录吗？

**编辑：**

现在我看到了您实际上在做什么...波浪号扩展发生在变量插值之前，这就是您收到此错误的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T01:19:18.573

脚本将由用户运行吗？如果是，你可以这样做： `cd ~`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T17:28:34.173

有什么理由你不能这样做：

```
#!/bin/bash

cd /home/$USER 
```

当然，并非所有 *nix 上的目录都在 /home 中，但假设您知道您的脚本的目标操作系统/发行版，您应该能够想出一些运行良好的东西。

# .net - 我应该如何存储公共设置？（。网）

> ID：521229
> 
> 赞同：2
> 
> 时间：2009-02-06T17:22:21.690
> 
> 标签：.net, settings, app-config, configuration-files

我正在使用应用程序范围的设置来存储在运行时无法更改的设置。我正在使用用户范围的设置来让个人用户配置他们的偏好。但是，我应该如何存储/控制在运行时可由应用程序范围内的管理员级用户修改的设置（即，它们会影响所有 PC 用户）？我想管理员可以手动修改应用程序范围的设置，但这并不可取。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:35:32.707

如果您打算将这些设置存储在计算机本身上，请考虑[使用通用 appdata](https://stackoverflow.com/questions/81686/is-there-a-folder-in-both-winxp-and-winvista-to-which-all-users-have-writing-perm)文件夹来存储跨用户设置。所有用户均可访问此文件夹。您需要自己存储/读取这些设置，正如其他人提到的，您可以为此使用 xml 序列化程序。

不幸的是，在这种情况下，您可以将其设置为仅限管理员访问 - 任何用户都可以写入此文件夹（这正是这里的目的 - 用于可以更改的常用设置）。如果“管理设置”只是按照惯例，或者设置位置的模糊性就足够了，这可能就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T17:31:35.740

我的建议是将这些可修改的设置存储在数据库中的表中，当应用程序启动时获取该表，以便轻松修改各种值而无需接触代码文件。这类似于用户配置数据，应该存储在可以轻松访问并处理更改而不会破坏事物或触发重新编译的地方。但是，这确实假设应用程序具有某种形式的 DB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:33:28.623

您可能必须自己处理这个问题。创建一个序列化为 XML 或保存在注册表中的设置类（或您存储设置的首选方法）和一个选项窗口。适当时保存并加载设置。

需要注意的是用户范围的设置仅适用于登录用户。据我所知，至少没有一些花哨的东西，您将无法轻松编辑其他用户的设置。

# build-process - SCons 是否有任何库/框架？

> ID：521230
> 
> 赞同：11
> 
> 时间：2009-02-06T17:22:30.643
> 
> 标签：build-process, scons

每个使用 SCons 的项目似乎都在重新发明轮子。我很乐意采用某人的目录布局和/或变体构建（调试/发布）的解决方案，和/或测试框架，和/或最佳实践。

即使是几个不太简单的例子也会有所帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-08T14:07:31.417

您可能对 2009 年 2 月开源的 Google软件[构建](http://google-opensource.blogspot.com/2009/02/software-construction-toolkit-released.html)[工具包](http://code.google.com/p/swtoolkit/)感兴趣。它在 SCons 之上添加了新功能，例如改进的 Visual Studio 项目文件生成、单元测试功能以及使用 distcc 或 incredibuild 的分布式构建。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-09T19:20:53.653

wiki 中的[SCons 食谱](http://scons.org/wiki/SconsRecipes)是一个很好的起点。另外看看使用 SCons 的其他项目，例如[Ardor 构建系统](http://viewcvs.ardour.org/index.cgi/ardour2/ardour2/branches/3.0/SConstruct?view=markup)。如果这不能解决问题，您可能需要查看一些第三方**SCons 扩展：**

*   [部分](http://parts.tigris.org/)
*   [水螅](http://code.google.com/p/aqualid/wiki/Introduction)

据我所知，没有商定的SCons*最佳实践。*SCons 社区似乎更喜欢适应性而不是“规范化”。不过，从头开始设计一个体面的基于 SCons 的构建系统并不难。（一旦你了解了 VariantDir 的工作原理，至少。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:26:29.797

如果您使用 Eclipse 进行 C++ 开发，您可能需要查看这个 SCons 构建器插件 ( [http://nic-nac-project.org/~lothar/eclipse/update/SConsBuilderPlugin.html](http://nic-nac-project.org/~lothar/eclipse/update/SConsBuilderPlugin.html) )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-26T09:49:00.573

另一个使用 SCons 的好例子是为 MIT 许可的 Godot 游戏引擎构建系统：

*   [https://github.com/okamstudio/godot/wiki/compiling_intro](https://github.com/okamstudio/godot/wiki/compiling_intro)

# regex - 需要一个正则表达式来匹配不能全为零的可变长度数字字符串

> ID：521242
> 
> 赞同：10
> 
> 时间：2009-02-06T17:26:27.437
> 
> 标签：regex, validation, pcre, lookahead, negative-lookahead

我需要验证表单上的输入。我希望输入是 1 到 19 位之间的数字。输入也可以从零开始。但是，我想验证它们并非全为零。我有一个正则表达式，可以确保输入是数字并且介于 1 到 19 个数字之间。

```
^\d[1,19]$ 
```

但我不知道如何检查整个字符串是否全为零。我试过这个

```
^(![0]{1,19})(\d[1,19])$ 
```

但它在 00000000000000000001 上失败，因为它允许可变数量的零。

如何检查整个字符串不为零？

谢谢。

我正在尝试在 ASP.NET RegularExpressionValidator 中执行此操作，因此我希望使用单个表达式。我还有其他选择，所以如果不能做到这一点，我也不会不走运。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-06T17:29:53.280

`^(?!0+$)\d{1,19}$`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:35:52.550

只需做一个负面的前瞻：

```
(?!^0+$)(^\d{1,19}) 
```

这在 Perl 中运行良好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T17:41:05.300

(?!0+$) 是一个前瞻指令。这 ？！是在字符串末尾搜索 1 个或多个 0 的负前瞻命令。如果匹配，则使用字符，留下 \d{1,19} 的常规数字搜索。

[Boost Perl Regexp](http://www.boost.org/doc/libs/1_37_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html)对 Boost 认可的 perl regexp 进行了很好的讨论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T17:38:42.310

你不需要 RegEx

```
 ulong test;
        string number = "1234567890123456789";
        if (ulong.TryParse(number, out test) && (test < 9999999999999999999ul) && (test > 0))
            Console.WriteLine(test); 
```

# cocoa-touch - iPhone SDK上的NSUserDefaults不返回零

> ID：521254
> 
> 赞同：0
> 
> 时间：2009-02-06T17:29:16.963
> 
> 标签：cocoa-touch

我将 NSUserDefaults 用于设置应用程序。这是一个原始副本，我根本没有为这个特定设置向文件系统添加任何内容。我希望它为零，但相反..

如果我执行以下操作：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
if ( [defaults valueForKey:kIdentifierKey] == nil ) {
    return YES;
}
else {
    NSLog(@"we have a value. return NO. Value is: %@", [defaults objectForKey:kIdentifierKey]);
    return NO;
} 
```

然而在 NSLog 中，没有任何东西显示你期望的价值。else 块确实被执行了。有什么理由为什么这不是零？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T17:46:48.223

valueForKey: 在它搜索的所有地方都是一种复杂的方法。我发现在处理默认值时将 getter 用于特定数据类型更可靠。

```
if ([defaults boolForKey:kIdentifierKey]) [self doSomething]; 
```

或者你可以使用 objectForKey: 它应该返回 nil 如你所愿。实际上，您在创建 NSLog 语句时就这样做了。并且 nil 的字符串描述是 @"" 所以你的输出是你所期望的。

此外，您正在这里测试和记录不同的密钥：

```
[defaults valueForKey:kIdentifierKey];
[defaults objectForKey:kGroupIdentifierKey]; 
```

确保您正在测试和记录您认为自己是什么。

* * *

从一个新的 iPhone 项目进行测试：

```
if (![[NSUserDefaults standardUserDefaults] valueForKey:@"foobar"])         NSLog(@"is not yet defined");
if (![[NSUserDefaults standardUserDefaults] objectForKey:@"foobar"])        NSLog(@"is not yet defined");
if ([[NSUserDefaults standardUserDefaults] valueForKey:@"foobar"] == nil)   NSLog(@"valueForKey is nil");
if ([[NSUserDefaults standardUserDefaults] objectForKey:@"foobar"] == nil)  NSLog(@"objectForKey is nil"); 
```

它输出：

```
is not yet defined
is not yet defined
valueForKey is nil
objectForKey is nil 
```

我想你这里还有其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:35:33.693

基于文档....

> “默认值必须是属性列表，即（或集合的实例组合）的一个实例：NSData、NSString、NSNumber、NSDate、NSArray 或 NSDictionary。如果要存储任何其他类型的对象，您通常应该将其归档以创建 NSData 的实例。有关更多详细信息，请参阅 Cocoa 的用户默认编程主题。

此外，根据文档，[defaults valueForKey:] 不是实例方法，因此结果很可能是未定义的。如果您使用 [defaults objectForKey:] 如果未找到与 kIdentifierKey 关联的对象，它将返回 nil。

# iphone - UIImagePickerController 不提供地理标签数据

> ID：521258
> 
> 赞同：3
> 
> 时间：2009-02-06T17:30:07.523
> 
> 标签：iphone, photo, exif, geo

当我使用 UIImagePickerController 从相机胶卷或照片库中选择照片时，在方法中返回给我的图像

'didFinishPickingImage'

不包含经纬度的 exif 数据。我知道标题在那里，因为它们在导入 iPhoto 时会显示，如果我从相机胶卷上传图像，它们还包含位置的 exif 标题。有没有办法让 UIImagePickerController 也提供该信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-15T09:14:19.377

您可以对从 接收到的图像进行地理标记`UIImagePickerController`，请在此处查看我的答案： [UIImagePickerController and extracting EXIF data from existing photos](https://stackoverflow.com/questions/1238838/uiimagepickercontroller-and-extracting-exif-data-from-existing-photos/1967111#1967111)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T00:33:02.460

好像没有。UIImagePickerController 错误地剥离了位置标签，但它们存在于文件中（由于它位于沙箱之外，因此您无法访问）。

在此处查看有关 Apple 的讨论：[链接文本](http://discussions.apple.com/message.jspa?messageID=7668654#7668654)

以及对 Flicker 的评论：[link text](http://www.flickr.com/help/forum/74126/?search=exif)

# c# - 在 C# 中使用正则表达式删除括号

> ID：521261
> 
> 赞同：4
> 
> 时间：2009-02-06T17:30:23.403
> 
> 标签：c#, regex, string, replace

我想从 SQL 字符串中删除方括号，但仅限于其中没有空格的地方。

例如，“SELECT [intId], [The Description]”应该返回“SELECT intId, [The Description]”。

我可以使用正则表达式得到没有空格的方括号：

```
\[[^\s]*\] 
```

如何从这些匹配项中删除原始字符串中的方括号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T17:33:37.203

```
sql = Regex.Replace(sql, "\\[([^\\s]*)\\]", "$1"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T17:37:43.250

正则表达式是不够的，除了在您的上述特定字符串上一次性使用。如果您在许多 SQL 行上以自动方式执行此操作，则可能会在删除所需的括号时遇到一堆麻烦。

在这种情况下，您需要更多的 SQL 词法分析器/解析器，它可以帮助您只关注列名，而排除表名、字符串、触发器或函数中的参数等......

# scripting - Windows - VBScript - 确定网络上计算机的 IP 地址

> ID：521262
> 
> 赞同：1
> 
> 时间：2009-02-06T17:30:32.453
> 
> 标签：scripting, vbscript, windows-xp, ip-address

我编写了一些 VBScripts 来自动化我通过网络在计算机上执行的任务。这些对于大多数任务都非常有用，但是在我们的网络中，我们遇到了 DNS 中的 IP 地址始终正确的问题。这主要发生在笔记本电脑上，我们对无线和有线网络上的机器有不同的 IP 范围。

例如，一台机器可能在早上以有线方式启动并获得一个 IP 地址：10.10.10.1

当它切换到无线时，它将获得不同子网中的地址：10.11.10.1

当您尝试连接到该计算机时，即使计算机现在有一个新 IP 地址，它仍会返回旧 IP 地址 (10.10.10.1)。

我发现我仍然可以通过 \computer name\c$ 连接到该计算机的 C$ 共享，即使机器没有 ping。显然还有其他类型的地址解析正在进行，我的问题是如何利用它来允许我的 VBScripts 连接到 WMI？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T14:45:13.397

如果 DNS 没有正确的地址，那么它可能会被 NetBios 解析。您需要做的是使用 WINS 服务器或通过网络广播来解析计算机名称。根据您的网络环境，您可以使用其中一个或两个选项。

Microsoft 有一个名为[NBLookup](http://support.microsoft.com/kb/830578)的工具，它至少应该能够从 WINS 中查找名称。

您可以调用 NBLookup 并解析结果。我不记得在 VBScript 中本地解析 NetBios 的另一种方法，但我最近看起来并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:34:01.923

您的问题是名称解析。Windows 使用 2 种类型的名称解析：DNS 和 NetBIOS。

DNS 将解析 .comcast.net 或 www.google.com 之类的名称 NetBIOS 解析 15 个字符或更少的名称，就像您的计算机名称一样。

当您的计算机查找一个它不知道如何转换为 IP 地址的名称时，它会转到 DNS 服务器和/或使用 NetBIOS 名称解析。一旦它查找到一个名称，它会在再次查找之前将其保存在缓存中一段时间​​（通常大约一个小时）。

您可以通过以下方式使用命令行查看计算机为每种名称解析类型缓存的名称列表：

DNS
  ipconfig -displaydns
NetBIOS
  nbtstat -c

这些命令中的每一个还允许您清除该缓存，这将迫使您的系统重新发现名称指向的 IP 地址。以下是这些命令：

DNS
  ipconfig -flushdns
NetBIOS
  nbtstat -R

在这些命令之间，您应该能够确定哪种类型的名称解析是罪魁祸首，并通过刷新该缓存来解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:53:54.627

根据我自己的经验，我发现[Microsoft TechNet ScriptCenter](http://www.microsoft.com/technet/scriptcenter/default.mspx)几乎可以提供任何与 VBScript 相关的内容。当我想深入研究一个我以前没有探索过的 VBScript 新领域时，我通常会从那里开始。

Microsoft TechNet 网站上的[WMI 常见问题解答](http://www.microsoft.com/technet/scriptcenter/resources/wmifaq.mspx#EAE "WMI 常见问题")包含到 ScripCenter 的链接以及许多其他有用站点的链接，用于学习如何编写 WMI 脚本。我建议您找到一个已经完成您想要的脚本，因为肯定有人已经编写了您需要的内容。

文章[在客户端上自动化 TCP/IP 网络](http://www.microsoft.com/technet/scriptcenter/topics/networking/05_atnc_dns.mspx)可能包含您开始解决此问题所需的内容。

# .net - Web 服务客户端（.NET 2008），异常处理？

> ID：521264
> 
> 赞同：0
> 
> 时间：2009-02-06T17:30:54.370
> 
> 标签：.net, service, client

我在.net 2008 中有一个标准（？）Web 服务客户端解决方案 = 从我正在使用的 Web 服务下载 wsdl 文件后由 wsdl.exe 工具创建的类。然后我只调用这个自动创建的继承 System.Web.Services.Protocols.SoapHttpClientProtocol 的类的方法及其调用方法。我在测试环境中测试了很多。“问题”是它总是有效的。我的意思是，我不认为我可以假设它总是在生产环境中工作，但应该添加某种错误/异常处理，但问题是：怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:27:50.067

将对您的网络服务的调用包装在

```
try {

} 
catch {

} 
```

堵塞。

您可以捕获 Web 服务中止特定异常，然后检查内部异常以找出实际发生的情况。

# string - VBA 字符串环卫

> ID：521269
> 
> 赞同：3
> 
> 时间：2009-02-06T17:31:40.640
> 
> 标签：string, vba, excel

我从 Oracle 数据库中导入数据，并使用 Excel 从中创建一些报告。最近，我们的一位数据输入人员开始以“+”开始她的输入。Excel 对其进行评估并添加 = 然后显示可怕的 ?name# 错误。错误是错误 2029。

我尝试使用

```
If IsError(C.Value) Then
    C.Value = Replace(C.Value, "=+", "", 1, -1, vbTextCompare)
End If 
```

但这并没有让我到任何地方。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T17:45:37.150

Excel有它自己的替换功能：

```
ActiveSheet.Cells.Replace What:="=+", Replacement:="", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T01:56:08.423

如果您在文本/CSV 文件中有数据，那么您可以尝试：`Data > Import External Data > Import Data`这会启动一个向导，让您将特定列指定为文本，并导致 Excel 不解析 +、- 等符号

在 VBA 中，这可以通过`Worksheet("foo").QueryTables.Add`方法来完成。有很多选项，但该`TextFileColumnDataTypes`属性允许您指定将哪些列视为文本。通过记录正在使用的向导的宏然后对其进行编辑以适合

如果您更直接地读取数据（例如通过 ADO 或 DAO），那么只需在添加数据之前确保目标单元格为文本格式

`Worksheet("foo").Cells(r, c).NumberFormat = "@"`

* * *

注意在您的原始解决方案中，您几乎肯定想查看`C.Formula`而不是`C.Value`如果单元格 C 的公式为`=123+456`then`C.Value`将是 579 而`C.Formula`将是`=123+456`

+1 在这种情况下使用内置`Replace`方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:02:42.000

还有一件事，它应该是：

```
If IsError(C.Value) Then
    C.Value = Replace(C.Formula, "=+", "", 1, -1, vbTextCompare)
End If 
```

这是因为 =+ 存储在公式属性中，而不是值...如果您不想在 VBA 中自己进行清理，可以将 replace(...) 分配给 C.Value 或 C.Formula

# sql - 使用全文搜索实现存储过程的最佳方法

> ID：521270
> 
> 赞同：1
> 
> 时间：2009-02-06T17:31:44.900
> 
> 标签：sql, sql-server, stored-procedures, full-text-search, dynamic-sql

我想在给定以下用户输入的情况下使用 MSSQL 全文引擎运行搜索：“好莱坞广场”

我希望结果中同时包含好莱坞和正方形。

我可以在 Web 服务器（C#、ASP.NET）上创建一个方法来动态生成这样的 sql 语句：

```
SELECT TITLE
FROM MOVIES
WHERE CONTAINS(TITLE,'"hollywood*"')
AND CONTAINS(TITLE, '"square*"') 
```

很容易。但是，我希望在存储过程中这样做，以增加速度优势和添加参数的安全性。

我可以把我的蛋糕也吃掉吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T08:38:20.537

上次我不得不这样做（使用 MSSQL Server 2005）时，我最终将整个搜索功能转移到了 Lucene（Java 版本，尽管我相信现在存在 Lucene.Net）。我对全文搜索寄予厚望，但这个具体问题让我非常恼火，我放弃了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T05:36:45.077

您是否尝试过在字符串中使用 AND 逻辑运算符？我将一个原始字符串传递给我的 sproc，并在单词之间填充“AND”。

[http://msdn.microsoft.com/en-us/library/ms187787.aspx](http://msdn.microsoft.com/en-us/library/ms187787.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T19:44:07.923

我同意上述观点，请查看 AND 子句

```
SELECT TITLE
FROM MOVIES
WHERE CONTAINS(TITLE,'"hollywood*" AND "square*"') 
```

但是，您不必拆分输入句子，您可以使用变量

```
SELECT TITLE
FROM MOVIES
WHERE CONTAINS(TITLE,@parameter) 
```

顺便搜索确切的术语（包含） 搜索短语中的任何术语（自由文本）

# java - 使用 jxl api / Apache POI 编辑现有的 excel 文件

> ID：521274
> 
> 赞同：25
> 
> 时间：2009-02-06T17:32:55.567
> 
> 标签：java, excel

我有兴趣并想了解更多关于 java 的信息，如何写入现有的 excel 表/操作现有数据。我想知道您是否可以给我一个关于如何编辑现有 excel 文件并使用 jxl api / Apache POI 保存它的想法，或者给我一个关于如何编辑现有 excel 文件中的某些数据然后保存的示例程序提前致谢 ！！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-06T17:53:43.450

[这里](http://poi.apache.org/spreadsheet/quick-guide.html)的教程很有帮助，而且写得很好。他们使用由 Apache POI 项目开发的外部 JAR。这是编辑一个单元格的简单示例：

```
 InputStream inp = new FileInputStream("wb.xls");
    Workbook wb = WorkbookFactory.create(inp);
    Sheet sheet = wb.getSheetAt([sheet index]);
    Row row = sheet.getRow([row index]);
    Cell cell = row.getCell([cell index]);
    String cellContents = cell.getStringCellValue(); 
    //Modify the cellContents here
    // Write the output to a file
    cell.setCellValue(cellContents); 
    FileOutputStream fileOut = new FileOutputStream("wb.xls");
    wb.write(fileOut);
    fileOut.close(); 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-12T06:07:33.063

一个非常重要的技巧，我很难学到。**仅**在完成对 Excel 工作簿的写入后打开 OutputStream 。Zabbala 的例子是正确的并正确地显示了这一点。如果您更早地打开 OutputStream，您的更改将不会在程序退出后写入文件，您会像我一样摸不着头脑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-08T23:12:12.810

为此，我使用另一个选项卡刷新公式我使用下一句

```
HSSFSheet worksheetse = workbook.getSheetAt(0);
worksheetse.setForceFormulaRecalculation(true); 
```

但有必要对所有具有公式的选项卡应用 setForceFormulaRecalculation 方法。

对不起我的英语不好

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-08T16:08:56.050

您好，我有与 neXGen 相同的问题。但奇怪的是，如果我用 openoffice 打开文件，它可以工作！

编辑：也许我找到了一个解决方案，在更改值后放这个：

```
HSSFFormulaEvaluator.evaluateAllFormulaCells(workbook); 
```

# http-headers - 如何转义 HTTP 标头中的换行文字？

> ID：521275
> 
> 赞同：17
> 
> 时间：2009-02-06T17:33:22.570
> 
> 标签：http-headers

在 HTTP 标头中，换行符是标头中分隔字段的标记。

但是，如果我不想在自定义字段中发送换行符文字，我应该如何逃避它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T17:48:25.490

如果您正在设计自己的自定义扩展字段，您可以使用 BASE64 或quoted-printable 来转义（和取消转义）该值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-05T16:28:00.340

这个问题的实际答案是没有编码换行符的标准。

您可以使用任何[二进制到文本的编码](https://en.wikipedia.org/wiki/Binary-to-text_encoding#Encoding_standards)，例如 URL-Encoding 或 Base64，但显然只有在发送者和接收者都实现相同的方法时才会起作用。

* * *

[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616#page-16)确实允许在多行上“折叠”（即换行）标题值，但换行符被视为单个空格字符，而不是解析字段值的一部分。

但是，该规范已被禁止折叠的[RFC 7230废弃：](https://www.rfc-editor.org/rfc/rfc7230#section-3.2.4)

> 从历史上看，HTTP 标头字段值可以通过在每一额外行之前至少一个空格或水平制表符*(obs-fold)*来扩展到多行。除了在媒体类型*（**[第 8.3.1 节](https://www.rfc-editor.org/rfc/rfc7230#section-8.3.1)**）内，*
> **本规范不赞成这种行折叠**。**发件人*****不得*****生成包含行折叠的消息**`message/http`

 *HTTP Header 字段值中的换行标准尚未建立，也从未建立。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-06T17:49:01.463

根据[RFC2616 4.2 消息头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html)：

> 通过在每个额外行之前至少使用一个 SP 或 HT，可以将标题字段扩展到多行。

其中 SP 表示空格字符 (0x20)，HT 表示水平制表符 (0x09)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-28T01:45:22.790

这个想法是，HTTP 是**唯一**`ASCII`的，并且**不允许**换行等。如果发送者和接收者都可以解释你的编码，那么你可以编码任何你想要的，但是你想要的。这就是使用标头处理 DNS 国际名称的方式（称为 PUNYCODE）。****`Host`****

 ****简短的回答是：你不需要，除非你同时控制发送者和接收者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T17:48:27.063

如果它是一个自定义字段，您如何转义它完全取决于目标应用程序将如何解析它。如果这是您创建的一些附加内容，您可以坚持使用 URL 编码，因为它经过验证且真实，并且许多语言都内置了编码/解码方法，因此您的 Web 应用程序将对它和您的插件进行编码（或您正在处理的任何内容） ) 将对其进行解码。

# java - 将一组列从一个表复制到另一个表

> ID：521278
> 
> 赞同：0
> 
> 时间：2009-02-06T17:34:03.210
> 
> 标签：java, sql, oracle, jdbc

我的要求是从表中读取一组列。源表有很多 - 大约 20-30 个数字列，我想从源表中只读取一组这些列，并继续将这些列的值附加到目标表中。我的数据库在 Oracle 上，编程语言是 JDBC/Java。

源表是非常动态的——它上面经常发生插入和删除。而在目标表中，我想将数据保留至少 30 天。我的设置如下所述 - 数据库是 Oracle。源表中的行数 = 2000 万行，30 列目标表中的行数 = 3 亿行，2-3 列

这些列都是数字的。

我正在考虑不做一个普通的 JDBC 连接打开并传输数据，这可能会很慢查看表的大小。我正在尝试使用一些 sql 来转储源表的选定列 -

```
SQL> spool on
SQL> select c1,c5,c6 from SRC_Table;
SQL> spool off 
```

稍后使用 SQLLoader 将数据加载到目标数据库中。

源表存储时间序列数据，数据在 2 天内从源表中清除/删除。它是 OLTP 环境的一部分。目标表的保留期较长——可以在这里存储 30 天的数据，它是 OLAP 环境的一部分。因此，视图仅从源表中选择一组列的源表视图在此环境中不起作用。欢迎对此方法提出任何建议或评论。

**编辑** 我的表是分区的。复制数据最简单的方法是交换分区网表

```
*ALTER TABLE <table_name>
EXCHANGE PARTITION <partition_name>
WITH TABLE <new_table_name>
<including | excluding> INDEXES
<with | without> VALIDATION
EXCEPTIONS INTO <schema.table_name>;* 
```

但由于我的源表和目标表有不同的列，所以我认为交换分区不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:52:34.077

这个问题似乎有点模糊，坦率地说有点奇怪。一个表中有数百个列，并且您在数据库中复制数据，这一事实表明了一种软管式数据库设计。

与其手动操作，不如说是触发器的工作。在源表上创建一个插入触发器，以便在插入列后将它们复制到目标表。

另一种可能性是，由于您似乎只需要原始表中的数据切片，而不是复制它，这是数据库设计的主要罪过，因此创建一个仅包含您想要的列和范围的视图。然后像访问任何其他表一样访问该视图。

我愿意猜测问题的根源是在源表中访问您想要的信息太慢了。这表明您可以通过更好的索引来解决这个问题。此外，您的源表可能太宽了。

由于我不是 Oracle 人员，因此我将其语法留给读者作为练习，但这个概念应该是合理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:39:48.260

Shamik，好的，您正在使用 OLTP 数据加载 OLAP 数据库。

可接受的延迟是多少？您的 OLAP 在人们明天早上来办公室之前是否需要今天的数据，或者它是否更接近实时。

说插入是“频繁的”并不意味着什么。我们中的一些人已经习惯了数千个 txns/sec - 对其他人来说 1/sec 已经很多了。

你说有很多数据。同样的想法。我读过人们的帖子，他们有包含几百万条记录的巨大表格。我有数千亿条记录的表。再次如此。实数非常有用。

不要使用 Schwern 建议的触发器。如果您认为您的插入量很大，则意味着您可能在该区域遇到了问题。触发器只会使情况变得更糟。

Oracle 为从 OLTP 获取数据到 OLAP 提供了许多不同的选择。与其重新发明轮子，不如使用已经写好的东西。Oracle Streams 就是**为**完成这项工作而生的。您可以使用 Oracle AQ 滚动您自己的流。您可以使用数据库更改通知或更改数据捕获来捕获插入的行而无需触发器。

这是一个非常常见的问题，这就是为什么我列出了 4 种旨在解决它的技术。

高级排队流更改数据捕获数据库更改通知

开始用谷歌搜索这些术语，然后带着问题回来。你会比从头开始构建自己的或使用触发器更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T18:21:34.813

顺便说一句，您可能想在[此处](http://www.oracle.com/solutions/business_intelligence/partitioning.html)和[此处](http://www.devarticles.com/c/a/Oracle/Partitioning-in-Oracle/)查看 Oracle 的分区。

> 分区使表和索引能够拆分为更小、更易于管理的组件，并且是任何具有高性能和高可用性要求的大型数据库的关键要求。除了订单日期（范围）和区域（列表）或区域（列表）和客户类型（列表）两种方法的复合分区之外，Oracle 数据库 11g 还提供最广泛的分区方法选择，包括间隔、引用、列表和范围.
> 
> *   更快的性能——将查询时间从几分钟缩短到几秒钟
> *   提高可用性——24 x 7 访问关键信息
> *   提高可管理性——管理更小的数据“块”
> *   支持信息生命周期管理——经济高效地使用存储

将表划分为每日分区将使归档更容易，如此[处所述](http://www.oracle.com/technologies/information-lifecycle-management/index.html)

# c# - 我应该重构这段代码吗？

> ID：521281
> 
> 赞同：0
> 
> 时间：2009-02-06T17:34:29.340
> 
> 标签：c#, asp.net, refactoring

我正在修改现有站点上的控件。该站点的所有控件都继承自一个基类。我需要在母版页上隐藏几个链接，所以我在我的控件上编写了这个方法：

```
private void HideCartLink (bool visible)
{
  Control control1 = Page.Master.FindControl( "link1" );
  control1.Visible = visible;

  Control control2 = Page.Master.FindControl( "link2" );
  control2.Visible = visible;
} 
```

然后我转到另一个控件，我必须做同样的事情。所以我重构了我的代码并修改了我的基类：

```
public void HideMasterPageControl (string controlName, bool visible)
{
    Control control = Page.Master.FindControl( controlName );
    control.Visible = visible;
} 
```

并在我的控件上添加了这个方法：

```
void CartLinkVisible(bool visible)
{
    ////hide cart link
    HideMasterPageControl("link1", visible);
    HideMasterPageControl("link2", visible);
} 
```

现在我转向第三个控件并意识到我必须做同样的事情。

我是否应该再次重构我的代码，以便我的基类有一个方法可以明确知道要隐藏哪些链接？或者我应该让我的基类通用并让我的控件决定隐藏什么？

我不确定这里的规则是什么......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T17:37:44.903

老实说，我更倾向于把它颠倒过来。根据页面的标准，我会根据需要*添加按钮/链接。*然后，这将为您提供更像工具栏的东西，实际上您可以使其可配置（或基于用户权限）哪些按钮/链接出现在每个页面上。

这使您摆脱了尴尬的境地，即在什么基础上隐藏可能存在或什至不存在的东西。

当然，假设你不能做到这一点，老实说，你可能正在尽一份糟糕的工作。不要太担心最终的实现。只需几个控件就可以了，并且过度复杂化会使情况变得更糟。

不过，您可能需要考虑[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。这意味着您实现了一个类，该类“访问”给定控件上的**所有**链接并进入配置以查找它们是否应该隐藏。这将节省您对链接的控件名称进行硬编码，并允许该方法位于不知道实际控件有哪些的基类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:41:41.977

我有一个通用的基本方法，它会调用一个虚拟方法来获取一个链接列表以隐藏和循环它们。第二种方法的基本实现将包含最常见的隐藏链接列表。每个控件我都会覆盖添加或修改该列表的方法。

不过，我必须同意 Neil 的观点，如果你翻转逻辑并决定哪些链接需要被包含，哪些链接需要被排除，这似乎更好。

# jquery - jQuery向左滑动并显示

> ID：521291
> 
> 赞同：111
> 
> 时间：2009-02-06T17:36:41.270
> 
> 标签：jquery, effects

我扩展了`jQuery`调用的效果`slideRightShow()`，并`slideLeftHide()`使用了几个功能与下面类似的功能，`slideUp()`如下`slideDown()`所示。但是，我也想实现`slideLeftShow()`and `slideRightHide()`。

我知道有大量的库可以提供这种类型的东西（我想避免添加另一组大`javascript`文件），但是任何人都可以提供一个简单的例子来说明如何实现`slideLeftShow()`或`slideRightHide()`吗？

```
jQuery.fn.extend({
  slideRightShow: function() {
    return this.each(function() {
      jQuery(this).animate({width: 'show'});
    });
  },
  slideLeftHide: function() {
    return this.each(function() {
      jQuery(this).animate({width: 'hide'});
    });
  },
  slideRightHide: function() {
    return this.each(function() {
      ???
    });
  },
  slideLeftShow: function() {
    return this.each(function() {
      ???
    });
  }
}); 
```

上述`slideRightShow`函数从左侧开始显示图像，然后向右侧进行。 ***我正在寻找一些方法来做同样的事情，但从右侧开始，向左前进***。谢谢！

编辑

jQuery 界面有我需要的东西（我基本上需要它们的“向右滑动”和“向左滑动”功能），但我无法让它与 jQuery 1.3 一起使用：http: [//interface.eyecon.ro/demos /ifx.html](http://interface.eyecon.ro/demos/ifx.html)。此外，他们的演示似乎坏了，而且它只会在抛出一百万个错误之前做一次幻灯片。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2009-02-06T18:10:43.010

此功能包含在 jquery ui [http://docs.jquery.com/UI/Effects/Slide](http://docs.jquery.com/UI/Effects/Slide)中，如果您想使用自己的名称扩展它，您可以使用它。

```
jQuery.fn.extend({
  slideRightShow: function() {
    return this.each(function() {
        $(this).show('slide', {direction: 'right'}, 1000);
    });
  },
  slideLeftHide: function() {
    return this.each(function() {
      $(this).hide('slide', {direction: 'left'}, 1000);
    });
  },
  slideRightHide: function() {
    return this.each(function() {
      $(this).hide('slide', {direction: 'right'}, 1000);
    });
  },
  slideLeftShow: function() {
    return this.each(function() {
      $(this).show('slide', {direction: 'left'}, 1000);
    });
  }
}); 
```

您将需要以下参考资料

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.core.js"></script>
<script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.slide.js"></script> 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-09-29T13:50:03.047

不要忘记填充和边距......

```
jQuery.fn.slideLeftHide = function(speed, callback) { 
  this.animate({ 
    width: "hide", 
    paddingLeft: "hide", 
    paddingRight: "hide", 
    marginLeft: "hide", 
    marginRight: "hide" 
  }, speed, callback);
}

jQuery.fn.slideLeftShow = function(speed, callback) { 
  this.animate({ 
    width: "show", 
    paddingLeft: "show", 
    paddingRight: "show", 
    marginLeft: "show", 
    marginRight: "show" 
  }, speed, callback);
} 
```

添加了速度/回调参数后，它完全替代了`slideUp()`and `slideDown()`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-10T07:27:12.123

您可以通过在您自己的脚本文件中添加这些行来将新功能添加到您的 jQuery 库中，并且您可以轻松地使用`fadeSlideRight()`和`fadeSlideLeft()`.

注意：您可以根据需要更改动画的宽度，例如 750px。

```
$.fn.fadeSlideRight = function(speed,fn) {
    return $(this).animate({
        'opacity' : 1,
        'width' : '750px'
    },speed || 400, function() {
        $.isFunction(fn) && fn.call(this);
    });
}

$.fn.fadeSlideLeft = function(speed,fn) {
    return $(this).animate({
        'opacity' : 0,
        'width' : '0px'
    },speed || 400,function() {
        $.isFunction(fn) && fn.call(this);
    });
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-31T00:18:45.430

如果你想改变速度并包含回调，只需像这样添加它们：

```
 jQuery.fn.extend({
            slideRightShow: function(speed,callback) {
                return this.each(function() {
                    $(this).show('slide', {direction: 'right'}, speed, callback);
                });
            },
            slideLeftHide: function(speed,callback) {
                return this.each(function() {
                    $(this).hide('slide', {direction: 'left'}, speed, callback);
                });
            },
            slideRightHide: function(speed,callback) {
                return this.each(function() {  
                    $(this).hide('slide', {direction: 'right'}, speed, callback);
                });
            },
            slideLeftShow: function(speed,callback) {
                return this.each(function() {
                    $(this).show('slide', {direction: 'left'}, speed, callback);
                });
            }
        }); 
```

# javascript - JavaScript 中的“kill”是做什么的？

> ID：521294
> 
> 赞同：0
> 
> 时间：2009-02-06T17:37:34.263
> 
> 标签：javascript, dom, iframe, kill

这个 JavaScript 到底做了什么？

```
parent.kill = 1; 
```

这用于我正在处理的项目中进行某种会话到期，但我以前从未见过它。它已加载，`iframe`因此我假设它的目标是 DOM `document.window`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T17:57:20.057

`kill`子 iframe在`parent` `window`的全局范围内设置变量。`parent`不能仅从那行 javascript 确定该变量的作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:06:21.083

为了背负@crescentfresh 的答案，[这里](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Reserved_Words)是保留关键字的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:41:44.410

我不认为这是语言的一部分——也许是图书馆的一部分？

# javascript - 在 Javascript 中播种随机数生成器

> ID：521295
> 
> 赞同：485
> 
> 时间：2009-02-06T17:37:39.833
> 
> 标签：javascript, random, random-seed, seeding

[`Math.random`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math/random)是否可以在 JavaScript中播种随机数生成器（ ）？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2017-12-01T12:21:32.437

不，不可能播种`Math.random()`。

我已经用纯 JavaScript 实现了许多好的、简短和快速的**伪随机数生成器**(PRNG) 函数。所有这些都可以播种并提供高质量的数字。

**首先，注意正确初始化您的 PRNG。**为简单起见，下面的生成器没有内置种子生成过程，但接受一个或多个 32 位值作为 PRNG 的初始*种子状态*。相似或稀疏的种子（例如 1 和 2 的简单种子）具有低熵，并且可能导致相关性或其他随机性质量问题，有时会导致输出具有相似的属性（例如随机生成的级别相似）。为避免这种情况，最佳实践是使用分布良好的高熵种子初始化 PRNG。

有很多方法可以做到这一点，但这里有两种方法。首先，[哈希函数](https://en.wikipedia.org/wiki/Hash_function)非常擅长从短字符串生成种子。即使两个字符串相似，一个好的哈希函数也会产生非常不同的结果，因此您不必对字符串花太多心思。这是一个基于 MurmurHash3 的混合函数的示例种子生成器：

```
function xmur3(str) {
    for(var i = 0, h = 1779033703 ^ str.length; i < str.length; i++) {
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = h << 13 | h >>> 19;
    } return function() {
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        return (h ^= h >>> 16) >>> 0;
    }
} 
```

*对返回函数*的每次后续调用都会`xmur3`生成一个新的 32 位哈希值，用作 PRNG 中的种子。以下是您可以如何使用它：

```
// Create xmur3 state:
var seed = xmur3("apples");
// Output four 32-bit hashes to provide the seed for sfc32.
var rand = sfc32(seed(), seed(), seed(), seed());

// Output one 32-bit hash to provide the seed for mulberry32.
var rand = mulberry32(seed());

// Obtain sequential random numbers like so:
rand();
rand(); 
```

或者，只需选择一些虚拟数据来填充种子，并预先将生成器推进几次（12-20 次迭代）以彻底混合初始状态。这具有更简单的好处，并且经常用于 PRNG 的参考实现，但它确实限制了初始状态的数量：

```
var seed = 1337 ^ 0xDEADBEEF; // 32-bit seed with optional XOR value
// Pad seed with Phi, Pi and E.
// https://en.wikipedia.org/wiki/Nothing-up-my-sleeve_number
var rand = sfc32(0x9E3779B9, 0x243F6A88, 0xB7E15162, seed);
for (var i = 0; i < 15; i++) rand(); 
```

注意：这些 PRNG 函数的输出会产生一个正的 32 位数字（0 到 2 ^(32) -1），然后将其转换为 0-1（包括 0，不包括 1）之间的浮点数`Math.random()`，如果你想特定范围的随机数，请阅读[MDN 上的这篇文章](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random)。如果您只想要原始位，只需删除最后的除法操作。

JavaScript 数字只能表示分辨率高达 53 位的整数。而当使用按位运算时，这会减少到 32。其他语言中的现代 PRNG 通常使用 64 位运算，这在移植到 JS 时需要 shims，这会*大大*降低性能。这里的算法只使用 32 位操作，因为它直接兼容 JS。

> 现在，继续生成器。*[（我在此处](https://github.com/bryc/code/blob/master/jshash/PRNGs.md)**维护包含参考和许可证信息的完整列表）*

* * *

### sfc32（简单快速计数器）

**sfc32**是[PractRand](http://pracrand.sourceforge.net/)随机数测试套件的一部分（它当然通过了）。sfc32 具有 128 位状态，在 JS 中速度非常快。

```
function sfc32(a, b, c, d) {
    return function() {
      a >>>= 0; b >>>= 0; c >>>= 0; d >>>= 0; 
      var t = (a + b) | 0;
      a = b ^ b >>> 9;
      b = c + (c << 3) | 0;
      c = (c << 21 | c >>> 11);
      d = d + 1 | 0;
      t = t + d | 0;
      c = c + t | 0;
      return (t >>> 0) / 4294967296;
    }
} 
```

你可能想知道`| 0`and`>>>= 0`是干什么用的。这些本质上是 32 位整数转换，用于性能优化。`Number`在 JS 中基本上是浮点数，但在按位运算期间，它们会切换到 32 位整数模式。这种模式被 JS 解释器处理得更快，但是任何乘法或加法都会导致它切换回浮点数，从而导致性能下降。

### 桑树32

Mulberry32 是一个具有 32 位状态的简单生成器，但速度极快且具有良好的随机性（作者声称它通过了[gjrand](http://gjrand.sourceforge.net/)测试套件的所有测试，并且有完整的 2 ^(32)周期，但我尚未验证）。

```
function mulberry32(a) {
    return function() {
      var t = a += 0x6D2B79F5;
      t = Math.imul(t ^ t >>> 15, t | 1);
      t ^= t + Math.imul(t ^ t >>> 7, t | 61);
      return ((t ^ t >>> 14) >>> 0) / 4294967296;
    }
} 
```

如果您只需要一个简单但*体面的*PRNG 并且不需要数十亿个随机数，我会推荐这个（请参阅[生日问题](https://en.wikipedia.org/wiki/Birthday_problem)）。

### xoshiro128**

截至 2018 年 5 月，**xoshiro128**是 Vigna 和 Blackman 的**[Xorshift 家族](https://en.wikipedia.org/wiki/Xorshift)的新成员（Vigna 教授还负责为大多数底层实现提供支持的 Xorshift128+ 算法`Math.random`）。它是提供 128 位状态的最快生成器。

```
function xoshiro128ss(a, b, c, d) {
    return function() {
        var t = b << 9, r = a * 5; r = (r << 7 | r >>> 25) * 9;
        c ^= a; d ^= b;
        b ^= c; a ^= d; c ^= t;
        d = d << 11 | d >>> 21;
        return (r >>> 0) / 4294967296;
    }
} 
```

作者声称它很好地通过了随机性测试（[尽管有一些警告](http://prng.di.unimi.it/)）。其他研究人员指出，它未能通过 TestU01 中的一些测试（尤其是 LinearComp 和 BinaryRank）。在实践中，使用浮点数（例如这些实现）时不应该引起问题，但如果依赖原始最低位可能会引起问题。

### JSF（詹金斯的小快）

这是 Bob Jenkins (2007) 的 JSF 或“smallprng”，他还制作了[ISAAC](https://en.wikipedia.org/wiki/ISAAC_(cipher))和[SpookyHash](https://en.wikipedia.org/wiki/Jenkins_hash_function#SpookyHash)。它[通过](http://www.pcg-random.org/posts/bob-jenkins-small-prng-passes-practrand.html)了 PractRand 测试，应该相当快，虽然不如 sfc32 快。

```
function jsf32(a, b, c, d) {
    return function() {
        a |= 0; b |= 0; c |= 0; d |= 0;
        var t = a - (b << 27 | b >>> 5) | 0;
        a = b ^ (c << 17 | c >>> 15);
        b = c + d | 0;
        c = d + t | 0;
        d = a + t | 0;
        return (d >>> 0) / 4294967296;
    }
} 
```

* * *

## 回答 #2

> 赞同：232
> 
> 时间：2009-02-06T17:42:35.143

不，不可能播种`Math.random()`，但是编写自己的生成器相当容易，或者更好的是，使用现有的生成器。

退房：[这个相关的问题](https://stackoverflow.com/questions/424292/how-to-create-my-own-javascript-random-number-generator-that-i-can-also-set-the-s)。

[此外，有关播种](http://davidbau.com/archives/2010/01/30/random_seeds_coded_hints_and_quintillions.html#more)的更多信息，请参阅 David Bau 的博客。

* * *

## 回答 #3

> 赞同：187
> 
> 时间：2013-10-10T18:42:59.607

注意：尽管（或者更确切地说，因为）简洁和明显的优雅，这个算法在随机性方面绝不是一个高质量的算法。寻找例如[此答案](https://stackoverflow.com/questions/521295/seeding-the-random-number-generator-in-javascript/47593316#47593316)中列出的那些以获得更好的结果。

（最初改编自对另一个答案的评论中提出的一个聪明的想法。）

```
var seed = 1;
function random() {
    var x = Math.sin(seed++) * 10000;
    return x - Math.floor(x);
} 
```

您可以设置`seed`为任意数字，只需避免零（或 Math.PI 的任意倍数）。

在我看来，这个解决方案的优雅之处在于缺少任何“神奇”数字（除了 10000，它表示您必须丢弃以避免奇怪模式的最少数字数量 - 请参阅值为[10](https://i.stack.imgur.com/nIHGJ.png)、[100](https://i.stack.imgur.com/lkqhu.png)、[1000](https://i.stack.imgur.com/KV3K5.png)的结果）。简洁也不错。

它比 Math.random() 慢一点（2 或 3 倍），但我相信它与任何其他用 JavaScript 编写的解决方案一样快。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2013-10-10T16:29:45.507

不，但这是一个简单的伪随机生成器，它是我改编自[Wikipedia的](http://en.wikipedia.org/wiki/Random_number_generation)[Multiply-with-carry](https://en.wikipedia.org/wiki/Multiply-with-carry_pseudorandom_number_generator)的实现（此后已被删除）：

```
var m_w = 123456789;
var m_z = 987654321;
var mask = 0xffffffff;

// Takes any integer
function seed(i) {
    m_w = (123456789 + i) & mask;
    m_z = (987654321 - i) & mask;
}

// Returns number between 0 (inclusive) and 1.0 (exclusive),
// just like Math.random().
function random()
{
    m_z = (36969 * (m_z & 65535) + (m_z >> 16)) & mask;
    m_w = (18000 * (m_w & 65535) + (m_w >> 16)) & mask;
    var result = ((m_z << 16) + (m_w & 65535)) >>> 0;
    result /= 4294967296;
    return result;
} 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2014-04-25T22:34:46.097

Antti Sykäri 的算法既好又短。`Math.random`我最初做了一个变体，在你调用时替换了 JavaScript `Math.seed(s)`，但后来 Jason 评论说返回函数会更好：

```
Math.seed = function(s) {
    return function() {
        s = Math.sin(s) * 10000; return s - Math.floor(s);
    };
};

// usage:
var random1 = Math.seed(42);
var random2 = Math.seed(random1());
Math.random = Math.seed(random2()); 
```

这为您提供了 JavaScript 没有的另一个功能：多个独立的随机生成器。如果您想同时运行多个可重复的模拟，这一点尤其重要。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-03-04T18:56:59.267

请参阅 Pierre L'Ecuyer 可追溯到 1980 年代末和 1990 年代初的作品。还有其他的。如果您不是专家，那么您自己创建一个（伪）随机数生成器是非常危险的，因为结果很可能不是统计上随机的，或者周期很短。Pierre（和其他人）已经组合了一些易于实现的好（伪）随机数生成器。我使用他的一台 LFSR 发生器。

[https://www.iro.umontreal.ca/~lecuyer/myftp/papers/handstat.pdf](https://www.iro.umontreal.ca/~lecuyer/myftp/papers/handstat.pdf)

菲尔·特洛伊

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-04-04T19:32:14.333

结合之前的一些答案，这是您正在寻找的可种子随机函数：

```
Math.seed = function(s) {
    var mask = 0xffffffff;
    var m_w  = (123456789 + s) & mask;
    var m_z  = (987654321 - s) & mask;

    return function() {
      m_z = (36969 * (m_z & 65535) + (m_z >>> 16)) & mask;
      m_w = (18000 * (m_w & 65535) + (m_w >>> 16)) & mask;

      var result = ((m_z << 16) + (m_w & 65535)) >>> 0;
      result /= 4294967296;
      return result;
    }
}

var myRandomFunction = Math.seed(1234);
var randomNumber = myRandomFunction(); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-02-26T00:33:09.587

编写自己的伪随机生成器非常简单。

Dave Scotese 的建议很有用，但正如其他人所指出的，它的分布并不十分均匀。

然而，这不是因为 sin 的整数参数。这只是因为罪的范围，恰好是一个圆的一维投影。如果你取圆的角度，它会是均匀的。

所以代替 sin(x) 使用 arg(exp(i * x)) / (2 * PI)。

如果您不喜欢线性顺序，请将其与 xor 混合一下。实际因素也没有那么重要。

要生成 n 个伪随机数，可以使用以下代码：

```
function psora(k, n) {
  var r = Math.PI * (k ^ n)
  return r - Math.floor(r)
}
n = 42; for(k = 0; k < n; k++) console.log(psora(k, n)) 
```

另请注意，当需要真实熵时，您不能使用伪随机序列。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-12-07T15:52:34.840

如今，许多需要 Javascript 中可播种的随机数生成器的人都在使用[David Bau 的 seedrandom 模块](https://github.com/davidbau/seedrandom)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-01-30T10:23:54.010

这里的大多数答案都会产生有偏见的结果。所以这是一个基于[来自 github 的 seedrandom 库](https://github.com/davidbau/seedrandom)的测试函数：

```
!function(f,a,c){var s,l=256,p="random",d=c.pow(l,6),g=c.pow(2,52),y=2*g,h=l-1;function n(n,t,r){function e(){for(var n=u.g(6),t=d,r=0;n<g;)n=(n+r)*l,t*=l,r=u.g(1);for(;y<=n;)n/=2,t/=2,r>>>=1;return(n+r)/t}var o=[],i=j(function n(t,r){var e,o=[],i=typeof t;if(r&&"object"==i)for(e in t)try{o.push(n(t[e],r-1))}catch(n){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[n,S(a)]:null==n?function(){try{var n;return s&&(n=s.randomBytes)?n=n(l):(n=new Uint8Array(l),(f.crypto||f.msCrypto).getRandomValues(n)),S(n)}catch(n){var t=f.navigator,r=t&&t.plugins;return[+new Date,f,r,f.screen,S(a)]}}():n,3),o),u=new m(o);return e.int32=function(){return 0|u.g(4)},e.quick=function(){return u.g(4)/4294967296},e.double=e,j(S(u.S),a),(t.pass||r||function(n,t,r,e){return e&&(e.S&&v(e,u),n.state=function(){return v(u,{})}),r?(c[p]=n,t):n})(e,i,"global"in t?t.global:this==c,t.state)}function m(n){var t,r=n.length,u=this,e=0,o=u.i=u.j=0,i=u.S=[];for(r||(n=[r++]);e<l;)i[e]=e++;for(e=0;e<l;e++)i[e]=i[o=h&o+n[e%r]+(t=i[e])],i[o]=t;(u.g=function(n){for(var t,r=0,e=u.i,o=u.j,i=u.S;n--;)t=i[e=h&e+1],r=r*l+i[h&(i[e]=i[o=h&o+t])+(i[o]=t)];return u.i=e,u.j=o,r})(l)}function v(n,t){return t.i=n.i,t.j=n.j,t.S=n.S.slice(),t}function j(n,t){for(var r,e=n+"",o=0;o<e.length;)t[h&o]=h&(r^=19*t[h&o])+e.charCodeAt(o++);return S(t)}function S(n){return String.fromCharCode.apply(0,n)}if(j(c.random(),a),"object"==typeof module&&module.exports){module.exports=n;try{s=require("crypto")}catch(n){}}else"function"==typeof define&&define.amd?define(function(){return n}):c["seed"+p]=n}("undefined"!=typeof self?self:this,[],Math);

function randIntWithSeed(seed, max=1) {
  /* returns a random number between [0,max] including zero and max
  seed can be either string or integer */
  return Math.round(new Math.seedrandom('seed' + seed)()) * max
} 
```

测试此代码的真正随机性：[https ://es6console.com/kkjkgur2/](https://es6console.com/kkjkgur2/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-10T08:16:03.787

`Math.random`不，但是[*运行*库](https://synesenom.github.io/ran/)解决了这个问题。它几乎具有您可以想象的所有分布，并支持种子随机数生成。例子：

```
ran.core.seed(0)
myDist = new ran.Dist.Uniform(0, 1)
samples = myDist.sample(1000) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-01-19T14:22:22.297

[这是采用的 Jenkins 哈希版本，从这里](https://gist.github.com/mathiasbynens/5670917)借用

```
export function createDeterministicRandom(): () => number {
  let seed = 0x2F6E2B1;
  return function() {
    // Robert Jenkins’ 32 bit integer hash function
    seed = ((seed + 0x7ED55D16) + (seed << 12))  & 0xFFFFFFFF;
    seed = ((seed ^ 0xC761C23C) ^ (seed >>> 19)) & 0xFFFFFFFF;
    seed = ((seed + 0x165667B1) + (seed << 5))   & 0xFFFFFFFF;
    seed = ((seed + 0xD3A2646C) ^ (seed << 9))   & 0xFFFFFFFF;
    seed = ((seed + 0xFD7046C5) + (seed << 3))   & 0xFFFFFFFF;
    seed = ((seed ^ 0xB55A4F09) ^ (seed >>> 16)) & 0xFFFFFFFF;
    return (seed & 0xFFFFFFF) / 0x10000000;
  };
} 
```

你可以像这样使用它：

```
const deterministicRandom = createDeterministicRandom()
deterministicRandom()
// => 0.9872818551957607

deterministicRandom()
// => 0.34880331158638 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2018-04-13T15:45:44.290

我编写了一个返回种子随机数的函数，它使用 Math.sin 来获得一个长随机数，并使用种子从中挑选数字。

采用 ：

```
seedRandom("k9]:2@", 15) 
```

它将返回您的种子编号，第一个参数是任何字符串值；你的种子。第二个参数是返回多少位数。

```
 function seedRandom(inputSeed, lengthOfNumber){

           var output = "";
           var seed = inputSeed.toString();
           var newSeed = 0;
           var characterArray = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','y','x','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','U','R','S','T','U','V','W','X','Y','Z','!','@','#','$','%','^','&','*','(',')',' ','[','{',']','}','|',';',':',"'",',','<','.','>','/','?','`','~','-','_','=','+'];
           var longNum = "";
           var counter = 0;
           var accumulator = 0;

           for(var i = 0; i < seed.length; i++){
                var a = seed.length - (i+1);
                for(var x = 0; x < characterArray.length; x++){
                     var tempX = x.toString();
                     var lastDigit = tempX.charAt(tempX.length-1);
                     var xOutput = parseInt(lastDigit);
                     addToSeed(characterArray[x], xOutput, a, i); 
                }                  
           }

                function addToSeed(character, value, a, i){
                     if(seed.charAt(i) === character){newSeed = newSeed + value * Math.pow(10, a)}
                }
                newSeed = newSeed.toString();

                var copy = newSeed;
           for(var i=0; i<lengthOfNumber*9; i++){
                newSeed = newSeed + copy;
                var x = Math.sin(20982+(i)) * 10000;
                var y = Math.floor((x - Math.floor(x))*10);
                longNum = longNum + y.toString()
           }

           for(var i=0; i<lengthOfNumber; i++){
                output = output + longNum.charAt(accumulator);
                counter++;
                accumulator = accumulator + parseInt(newSeed.charAt(counter));
           }
           return(output)
      } 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-04-30T02:24:18.880

固定种子的简单方法：

```
function fixedrandom(p){
    const seed = 43758.5453123;
    return (Math.abs(Math.sin(p)) * seed)%1;
} 
```

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2021-01-29T10:13:18.837

在 PHP 中，有一个函数`srand(seed)`可以为特定的种子生成固定的随机值。但是，在 JS 中，没有这样的内置函数。

但是，我们可以编写简单而简短的函数。

*第**1***步：选择一些**种子**（固定编号）。
`var seed = 100;`
数字应为正整数且大于 1，*步骤 2*中进一步说明。

*第**2*****步：在Seed**上执行**Math.sin()**函数，它将给出该数字的*sin 值*。将此值存储在*变量 x*中。

 ****```
var x; 
x = Math.sin(seed); // Will Return Fractional Value between -1 & 1 (ex. 0.4059..) 
```

**sin()**方法返回一个介于 -1 和 1 之间的分数。
我们不需要负值，因此，在第一步中选择大于 1 的数字。

*第**3***步：返回值是介于 -1 和 1 之间的小数值。
因此，将此值乘以 10 使其大于 1。

```
x = x * 10; // 10 for Single Digit Number 
```

*第**4***步：将值乘以 10 以获得更多位数

```
x = x * 10; // Will Give value between 10 and 99 OR
x = x * 100; // Will Give value between 100 and 999 
```

根据位数的要求相乘。

结果将是十进制的。

*第**5***步：通过 Math's Round ( **Math.round()** ) 方法删除小数点后的值。

```
x = Math.round(x); // This will give Integer Value. 
```

*第**6*****步：通过Math.abs**方法将负值转换为正值（如果有）

```
x = Math.abs(x); // Convert Negative Values into Positive(if any) 
```

*解释结束。*

**最终代码**

```
var seed = 111; // Any Number greater than 1
var digit = 10 // 1 => single digit, 10 => 2 Digits, 100 => 3 Digits and so. (Multiple of 10) 

var x; // Initialize the Value to store the result
x = Math.sin(seed); // Perform Mathematical Sin Method on Seed.
x = x * 10; // Convert that number into integer
x = x * digit; // Number of Digits to be included
x = Math.round(x); // Remove Decimals
x = Math.abs(x); // Convert Negative Number into Positive 
```

**干净和优化的功能代码**

```
function random_seed(seed, digit = 1) {
    var x = Math.abs(Math.round(Math.sin(seed++) * 10 * digit));
    return x;
} 
```

 *`random_seed(any_number, number_of_digits)`
**然后使用any_number***调用此函数*是必须的并且应该大于 1。
**number_of_digits**是可选参数，如果没有传递，则返回 1 Digit。*

 *```
random_seed(555); // 1 Digit
random_seed(234, 1); // 1 Digit
random_seed(7895656, 1000); // 4 Digit 
```

* * *

## 回答 #16

> 赞同：-10
> 
> 时间：2018-04-10T15:47:34.980

对于 0 到 100 之间的数字。

```
Number.parseInt(Math.floor(Math.random() * 100)) 
```

# c# - 什么时候应该在 C# 中使用结构而不是类？

> ID：521298
> 
> 赞同：1539
> 
> 时间：2009-02-06T17:37:55.573
> 
> 标签：c#, struct

什么时候应该在 C# 中使用 struct 而不是 class？我的概念模型是当项目*仅仅是值类型的集合*时使用结构。一种在逻辑上将它们组合成一个有凝聚力的整体的方法。

[我在这里](https://web.archive.org/web/20110829190107/http://www.johnnycantcode.com/Post/C_Classes_vs._Structs "从原始站点存档：www.johnnycantcode.com/Post/C_Classes_vs._Structs")遇到了这些规则：

*   一个结构应该代表一个单一的值。
*   结构的内存占用应小于 16 字节。
*   创建后不应更改结构。

这些规则有效吗？结构在语义上意味着什么？

* * *

## 回答 #1

> 赞同：648
> 
> 时间：2011-08-07T13:44:41.570

OP 引用的来源具有一定的可信度……但是 Microsoft 呢？对 struct 使用的立场是什么？[我向Microsoft](http://msdn.microsoft.com/en-us/library/ms229017.aspx)寻求了一些额外的学习，这就是我发现的：

> **如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。**
> 
> **除非类型具有以下所有特征，否则不要定义结构：**
> 
> 1.  它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> 2.  它的实例大小小于 16 字节。
> 3.  它是不可变的。
> 4.  它不必经常装箱。

## 微软一贯违反这些规则

好吧，无论如何#2和#3。我们心爱的字典有 2 个内部结构：

```
[StructLayout(LayoutKind.Sequential)]  // default for structs
private struct Entry  //<Tkey, TValue>
{
    //  View code at *Reference Source
}

[Serializable, StructLayout(LayoutKind.Sequential)]
public struct Enumerator : 
    IEnumerator<KeyValuePair<TKey, TValue>>, IDisposable, 
    IDictionaryEnumerator, IEnumerator
{
    //  View code at *Reference Source
} 
```

*[参考来源](http://referencesource.microsoft.com/#mscorlib/system/collections/generic/dictionary.cs,d3599058f8d79be0)

'JonnyCantCode.com' 来源获得了 4 分中的 3 分——这是可以原谅的，因为 #4 可能不会成为问题。如果您发现自己在装箱结构，请重新考虑您的架构。

让我们看看微软为什么会使用这些结构：

1.  每个 struct`Entry`和`Enumerator`代表单个值。
2.  速度
3.  `Entry`永远不会作为 Dictionary 类之外的参数传递。进一步的调查表明，为了满足 IEnumerable 的实现，Dictionary 使用`Enumerator`它在每次请求枚举器时复制的结构......这是有道理的。
4.  Dictionary 类的内部。`Enumerator`是公共的，因为 Dictionary 是可枚举的，并且必须对 IEnumerator 接口实现具有相同的可访问性 - 例如 IEnumerator getter。

**更新**- 此外，请意识到当结构实现接口时 - 就像 Enumerator 所做的那样 - 并被强制转换为该实现的类型，该结构成为引用类型并被移动到堆中。在 Dictionary 类的内部，Enumerator*仍然*是一个值类型。但是，只要方法调用`GetEnumerator()`，就会返回引用类型`IEnumerator`。

我们在这里没有看到任何保持结构不可变或保持实例大小仅为 16 字节或更少的尝试或要求证明：

1.  上面的结构中没有任何东西被声明`readonly`——**不是**不可变的
2.  这些结构的大小可能远远超过 16 个字节
3.  `Entry`具有未确定的生命周期（从`Add()`、到`Remove()`、`Clear()`或垃圾回收）；

并且... 4\. 两个结构都存储 TKey 和 TValue，我们都知道它们非常有能力成为引用类型（添加了奖励信息）

尽管有散列键，但字典速度很快，部分原因是实例化结构比引用类型更快。在这里，我有一个`Dictionary<int, int>`存储 300,000 个具有顺序递增键的随机整数。

> 容量：312874
> MemSize：2660827 字节
> 完成调整大小：5ms
> 总填充时间：889ms

**容量**：必须调整内部数组大小之前可用的元素数。

**MemSize**：通过将字典序列化为 MemoryStream 并获取字节长度来确定（对于我们的目的来说足够准确）。

**Completed Resize**：将内部数组的大小从 150862 个元素调整为 312874 个元素所需的时间。当您发现每个元素都通过 顺序复制时`Array.CopyTo()`，这并不太破旧。

**总填充时间**`OnResize`：由于日志记录和我添加到源的事件，诚然存在偏差；但是，在操作期间调整 15 次大小时填充 300k 整数仍然令人印象深刻。只是出于好奇，如果我已经知道容量，那么填充的总时间是多少？**13ms**

那么，现在，如果`Entry`是一堂课呢？这些时间或指标真的会有那么大的不同吗？

> 容量：312874内存大小
> ：2660827 字节
> 完成调整大小： 26 毫秒
> 总填充时间：964 毫秒

显然，最大的区别在于调整大小。如果 Dictionary 是用容量初始化的，有什么区别吗？不够关心... **12ms**。

发生的情况是，因为`Entry`它是一个结构，它不需要像引用类型那样初始化。这既是价值类型的美，也是祸根。为了`Entry`用作引用类型，我必须插入以下代码：

```
/*
 *  Added to satisfy initialization of entry elements --
 *  this is where the extra time is spent resizing the Entry array
 * **/
for (int i = 0 ; i < prime ; i++)
{
    destinationArray[i] = new Entry( );
}
/*  *********************************************** */ 
```

我必须将每个数组元素初始化`Entry`为引用类型的原因可以在[MSDN: Structure Design](http://msdn.microsoft.com/en-us/library/ms229031.aspx)中找到。简而言之：

> **不要为结构提供默认构造函数。**
> 
> 如果结构定义了默认构造函数，则在创建结构的数组时，公共语言运行库会自动对每个数组元素执行默认构造函数。
> 
> 某些编译器（例如 C# 编译器）不允许结构具有默认构造函数。

这实际上很简单，我们将借鉴[阿西莫夫的*机器人三定律*](http://en.wikipedia.org/wiki/Three_Laws_of_Robotics)：

1.  该结构必须可以安全使用
2.  结构必须有效地执行其功能，除非这会违反规则 #1
3.  结构在使用过程中必须保持完整，除非它的销毁需要满足规则#1

...*我们从中得到什么*：简而言之，负责使用值类型。它们快速高效，但如果维护不当（即无意复制），可能会导致许多意外行为。

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-02-06T17:40:45.147

每当您：

1.  不需要多态性，
2.  想要值语义，并且
3.  希望避免堆分配和相关的垃圾收集开销。

然而，需要注意的是，结构（任意大）比类引用（通常是一个机器字）更昂贵，因此在实践中类最终可能会更快。

* * *

## 回答 #3

> 赞同：162
> 
> 时间：2009-02-28T16:33:23.393

我不同意原帖中给出的规则。这是我的规则：

1.  当存储在数组中时，您可以使用结构来提高性能。（另见[什么时候结构是答案？](https://stackoverflow.com/questions/597259/when-are-structs-the-answer/598182#598182)）

2.  您在将结构化数据传入/传出 C/C++ 的代码中需要它们

3.  不要使用结构，除非你需要它们：

    *   它们在赋值和作为参数传递时的行为与“普通对象”（*引用类型*）不同，这可能导致意外行为；如果查看代码的人不知道他们正在处理一个结构，这尤其危险。
    *   它们不能被继承。
    *   将结构作为参数传递比类更昂贵。

* * *

## 回答 #4

> 赞同：93
> 
> 时间：2009-02-06T17:40:26.567

当您需要值语义而不是引用语义时，请使用结构。

# 编辑

不知道为什么人们不赞成这一点，但这是一个有效的观点，并且是[在](https://stackoverflow.com/revisions/521298/1)操作人员澄清他的问题之前提出的，这是结构的最基本原因。

如果您需要引用语义，则需要一个类而不是结构。

* * *

## 回答 #5

> 赞同：65
> 
> 时间：2011-10-22T12:14:22.590

除了“它是一个值”的答案之外，使用结构的一个特定场景是当您***知道***您有一组导致垃圾收集问题的数据并且您有很多对象时。例如，大量的 Person 实例列表/数组。这里的自然比喻是一个类，但如果你有大量长寿命的 Person 实例，它们最终可能会阻塞 GEN-2 并导致 GC 停顿。**如果情况允许，这里一种可能的方法是使用 Person结构**的数组（而不是列表），即`Person[]`. 现在，不是在 GEN-2 中拥有数百万个对象，而是在 LOH 上有一个块（我假设这里没有字符串等 - 即没有任何引用的纯值）。这对 GC 影响很小。

处理这些数据很尴尬，因为数据对于结构来说可能过大，而且您不想一直复制胖值。但是，直接在数组中访问它不会复制结构 - 它是就地的（与复制的列表索引器形成对比）。这意味着大量的索引工作：

```
int index = ...
int id = peopleArray[index].Id; 
```

请注意，保持值本身不可变将对此有所帮助。对于更复杂的逻辑，使用带有 by-ref 参数的方法：

```
void Foo(ref Person person) {...}
...
Foo(ref peopleArray[index]); 
```

同样，这是就地的——我们没有复制该值。

在非常具体的场景中，这种策略可以非常成功；但是，这是一个相当高级的场景，只有在您知道自己在做什么以及为什么做的情况下才应该尝试。这里的默认值是一个类。

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2012-09-17T15:42:08.143

来自[C# 语言规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)：

> **1.7 结构**
> 
> 与类一样，结构是可以包含数据成员和函数成员的数据结构，但与类不同的是，结构是值类型，不需要堆分配。结构类型的变量直接存储结构的数据，而类类型的变量存储对动态分配对象的引用。结构类型不支持用户指定的继承，所有结构类型都隐式继承自类型对象。
> 
> 结构对于具有值语义的小型数据结构特别有用。复数、坐标系中的点或字典中的键值对都是结构的好例子。对小型数据结构使用结构而不是类可以对应用程序执行的内存分配数量产生很大影响。例如，以下程序创建并初始化一个包含 100 个点的数组。将 Point 实现为一个类，实例化了 101 个单独的对象——一个用于数组，一个用于 100 个元素。

```
class Point
{
   public int x, y;

   public Point(int x, int y) {
      this.x = x;
      this.y = y;
   }
}

class Test
{
   static void Main() {
      Point[] points = new Point[100];
      for (int i = 0; i < 100; i++) points[i] = new Point(i, i);
   }
} 
```

另一种方法是使 Point 成为一个结构。

```
struct Point
{
   public int x, y;

   public Point(int x, int y) {
      this.x = x;
      this.y = y;
   }
} 
```

现在，只实例化了一个对象——用于数组的对象——并且 Point 实例以内联方式存储在数组中。

使用 new 运算符调用结构构造函数，但这并不意味着正在分配内存。结构构造函数不是动态分配对象并返回对它的引用，而是简单地返回结构值本身（通常在堆栈上的临时位置），然后根据需要复制该值。

对于类，两个变量可能引用同一个对象，因此对一个变量的操作可能会影响另一个变量引用的对象。对于结构，每个变量都有自己的数据副本，并且对一个变量的操作不可能影响另一个变量。例如，以下代码片段产生的输出取决于 Point 是类还是结构。

```
Point a = new Point(10, 10);
Point b = a;
a.x = 20;
Console.WriteLine(b.x); 
```

如果 Point 是一个类，则输出为 20，因为 a 和 b 引用同一个对象。如果 Point 是一个结构体，则输出为 10，因为将 a 赋值给 b 会创建一个值的副本，并且该副本不受后续赋值给 ax 的影响

前面的示例突出了结构的两个限制。首先，复制整个结构通常比复制对象引用效率低，因此结构的赋值和值参数传递可能比引用类型更昂贵。其次，除了 ref 和 out 参数，不能创建对结构的引用，这排除了它们在许多情况下的使用。

* * *

## 回答 #7

> 赞同：35
> 
> 时间：2009-02-06T17:58:07.310

结构适用于数据的原子表示，其中所述数据可以通过代码多次复制。克隆对象通常比复制结构更昂贵，因为它涉及分配内存、运行构造函数以及在完成后解除分配/垃圾收集。

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2014-01-22T10:17:43.193

这是一个基本规则。

*   如果所有成员字段都是值类型，则创建一个**struct**。

*   如果任何一个成员字段是引用类型，则创建一个**类**。这是因为无论如何引用类型字段都需要堆分配。

**示例**

```
public struct MyPoint 
{
    public int X; // Value Type
    public int Y; // Value Type
}

public class MyPointWithName 
{
    public int X; // Value Type
    public int Y; // Value Type
    public string Name; // Reference Type
} 
```

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2009-02-06T18:12:58.153

第一：互操作场景或需要指定内存布局时

第二：当数据的大小与引用指针几乎相同时。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2009-02-06T18:09:02.577

[在要使用StructLayoutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)显式指定内存布局的情况下，您需要使用“结构” - 通常用于 PInvoke。

编辑：评论指出您可以将类或结构与 StructLayoutAttribute 一起使用，这当然是正确的。在实践中，您通常会使用结构 - 它分配在堆栈上而不是堆上，如果您只是将参数传递给非托管方法调用，这很有意义。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2009-02-06T18:25:49.813

我使用结构来打包或解包任何类型的二进制通信格式。这包括读取或写入磁盘、DirectX 顶点列表、网络协议或处理加密/压缩数据。

在这种情况下，您列出的三个准则对我没有用。当我需要按特定顺序写出 400 字节的内容时，我将定义一个 400 字节的结构，并用它应该具有的任何不相关的值填充它，然后我会去以当时最有意义的方式进行设置。（好吧，四百字节会很奇怪——但是当我以编写 Excel 文件为生时，我正在处理多达大约四十字节的结构，因为这就是一些 BIFF 记录的大小。）

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2009-02-06T18:15:06.840

除了运行时直接使用的值类型和其他各种用于 PInvoke 目的的值类型外，您应该只在 2 个场景中使用值类型。

1.  当您需要复制语义时。
2.  当您需要自动初始化时，通常在这些类型的数组中。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2017-07-24T09:16:37.260

我用[BenchmarkDotNet](https://github.com/dotnet/BenchmarkDotNet)做了一个小基准测试，以更好地理解“结构”在数字上的好处。我正在测试遍历结构（或类）的数组（或列表）。创建这些数组或列表超出了基准测试的范围 - 很明显，“类”更重将占用更多内存，并涉及 GC。

所以结论是：小心 LINQ 和隐藏结构的装箱/拆箱，以及使用结构进行微优化严格使用数组。

PS关于通过调用堆栈传递结构/类的另一个基准是[https://stackoverflow.com/a/47864451/506147](https://stackoverflow.com/a/47864451/506147)

```
BenchmarkDotNet=v0.10.8, OS=Windows 10 Redstone 2 (10.0.15063)
Processor=Intel Core i5-2500K CPU 3.30GHz (Sandy Bridge), ProcessorCount=4
Frequency=3233542 Hz, Resolution=309.2584 ns, Timer=TSC
  [Host] : Clr 4.0.30319.42000, 64bit RyuJIT-v4.7.2101.1
  Clr    : Clr 4.0.30319.42000, 64bit RyuJIT-v4.7.2101.1
  Core   : .NET Core 4.6.25211.01, 64bit RyuJIT

          Method |  Job | Runtime |      Mean |     Error |    StdDev |       Min |       Max |    Median | Rank |  Gen 0 | Allocated |
---------------- |----- |-------- |----------:|----------:|----------:|----------:|----------:|----------:|-----:|-------:|----------:|
   TestListClass |  Clr |     Clr |  5.599 us | 0.0408 us | 0.0382 us |  5.561 us |  5.689 us |  5.583 us |    3 |      - |       0 B |
  TestArrayClass |  Clr |     Clr |  2.024 us | 0.0102 us | 0.0096 us |  2.011 us |  2.043 us |  2.022 us |    2 |      - |       0 B |
  TestListStruct |  Clr |     Clr |  8.427 us | 0.1983 us | 0.2204 us |  8.101 us |  9.007 us |  8.374 us |    5 |      - |       0 B |
 TestArrayStruct |  Clr |     Clr |  1.539 us | 0.0295 us | 0.0276 us |  1.502 us |  1.577 us |  1.537 us |    1 |      - |       0 B |
   TestLinqClass |  Clr |     Clr | 13.117 us | 0.1007 us | 0.0892 us | 13.007 us | 13.301 us | 13.089 us |    7 | 0.0153 |      80 B |
  TestLinqStruct |  Clr |     Clr | 28.676 us | 0.1837 us | 0.1534 us | 28.441 us | 28.957 us | 28.660 us |    9 |      - |      96 B |
   TestListClass | Core |    Core |  5.747 us | 0.1147 us | 0.1275 us |  5.567 us |  5.945 us |  5.756 us |    4 |      - |       0 B |
  TestArrayClass | Core |    Core |  2.023 us | 0.0299 us | 0.0279 us |  1.990 us |  2.069 us |  2.013 us |    2 |      - |       0 B |
  TestListStruct | Core |    Core |  8.753 us | 0.1659 us | 0.1910 us |  8.498 us |  9.110 us |  8.670 us |    6 |      - |       0 B |
 TestArrayStruct | Core |    Core |  1.552 us | 0.0307 us | 0.0377 us |  1.496 us |  1.618 us |  1.552 us |    1 |      - |       0 B |
   TestLinqClass | Core |    Core | 14.286 us | 0.2430 us | 0.2273 us | 13.956 us | 14.678 us | 14.313 us |    8 | 0.0153 |      72 B |
  TestLinqStruct | Core |    Core | 30.121 us | 0.5941 us | 0.5835 us | 28.928 us | 30.909 us | 30.153 us |   10 |      - |      88 B | 
```

代码：

```
[RankColumn, MinColumn, MaxColumn, StdDevColumn, MedianColumn]
    [ClrJob, CoreJob]
    [HtmlExporter, MarkdownExporter]
    [MemoryDiagnoser]
    public class BenchmarkRef
    {
        public class C1
        {
            public string Text1;
            public string Text2;
            public string Text3;
        }

        public struct S1
        {
            public string Text1;
            public string Text2;
            public string Text3;
        }

        List<C1> testListClass = new List<C1>();
        List<S1> testListStruct = new List<S1>();
        C1[] testArrayClass;
        S1[] testArrayStruct;
        public BenchmarkRef()
        {
            for(int i=0;i<1000;i++)
            {
                testListClass.Add(new C1  { Text1= i.ToString(), Text2=null, Text3= i.ToString() });
                testListStruct.Add(new S1 { Text1 = i.ToString(), Text2 = null, Text3 = i.ToString() });
            }
            testArrayClass = testListClass.ToArray();
            testArrayStruct = testListStruct.ToArray();
        }

        [Benchmark]
        public int TestListClass()
        {
            var x = 0;
            foreach(var i in testListClass)
            {
                x += i.Text1.Length + i.Text3.Length;
            }
            return x;
        }

        [Benchmark]
        public int TestArrayClass()
        {
            var x = 0;
            foreach (var i in testArrayClass)
            {
                x += i.Text1.Length + i.Text3.Length;
            }
            return x;
        }

        [Benchmark]
        public int TestListStruct()
        {
            var x = 0;
            foreach (var i in testListStruct)
            {
                x += i.Text1.Length + i.Text3.Length;
            }
            return x;
        }

        [Benchmark]
        public int TestArrayStruct()
        {
            var x = 0;
            foreach (var i in testArrayStruct)
            {
                x += i.Text1.Length + i.Text3.Length;
            }
            return x;
        }

        [Benchmark]
        public int TestLinqClass()
        {
            var x = testListClass.Select(i=> i.Text1.Length + i.Text3.Length).Sum();
            return x;
        }

        [Benchmark]
        public int TestLinqStruct()
        {
            var x = testListStruct.Select(i => i.Text1.Length + i.Text3.Length).Sum();
            return x;
        }
    } 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2012-09-17T11:21:43.923

.NET supports `value types` and `reference types` (in Java, you can define only reference types). Instances of `reference types` get allocated in the managed heap and are garbage collected when there are no outstanding references to them. Instances of `value types`, on the other hand, are allocated in the `stack`, and hence allocated memory is reclaimed as soon as their scope ends. And of course, `value types` get passed by value, and `reference types` by reference. All C# primitive data types, except for System.String, are value types.

**When to use struct over class,**

In C#, `structs` are `value types`, classes are `reference types`. You can create value types, in C#, using the `enum` keyword and the `struct` keyword. Using a `value type` instead of a `reference type` will result in fewer objects on the managed heap, which results in lesser load on the garbage collector (GC), less frequent GC cycles, and consequently better performance. However, `value types` have their downsides too. Passing around a big `struct` is definitely costlier than passing a reference, that's one obvious problem. The other problem is the overhead associated with `boxing/unboxing`. In case you're wondering what `boxing/unboxing` mean, follow these links for a good explanation on `boxing` and `unboxing`. Apart from performance, there are times when you simply need types to have value semantics, which would be very difficult (or ugly) to implement if `reference types` are all you have. You should use `value types` only, When you need copy semantics or need automatic initialization, normally in `arrays` of these types.

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2017-07-20T18:36:18.090

**结构**是一种值类型。如果将结构分配给新变量，则新变量将包含原始变量的副本。

```
public struct IntStruct {
    public int Value {get; set;}
} 
```

执行以下结果会导致**5 个结构实例**存储在内存中：

```
var struct1 = new IntStruct() { Value = 0 }; // original
var struct2 = struct1;  // A copy is made
var struct3 = struct2;  // A copy is made
var struct4 = struct3;  // A copy is made
var struct5 = struct4;  // A copy is made

// NOTE: A "copy" will occur when you pass a struct into a method parameter.
// To avoid the "copy", use the ref keyword.

// Although structs are designed to use less system resources
// than classes.  If used incorrectly, they could use significantly more. 
```

类是引用类型**。**当您将一个类分配给一个新变量时，该变量包含对原始类对象的引用。

```
public class IntClass {
    public int Value {get; set;}
} 
```

执行以下操作会导致内存中**只有一个**类对象实例。

```
var class1 = new IntClass() { Value = 0 };
var class2 = class1;  // A reference is made to class1
var class3 = class2;  // A reference is made to class1
var class4 = class3;  // A reference is made to class1
var class5 = class4;  // A reference is made to class1 
```

**Struct** s 可能会增加代码错误的可能性。如果将值对象视为可变引用对象，则当所做的更改意外丢失时，开发人员可能会感到惊讶。

```
var struct1 = new IntStruct() { Value = 0 };
var struct2 = struct1;
struct2.Value = 1;
// At this point, a developer may be surprised when 
// struct1.Value is 0 and not 1 
```

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2012-07-24T22:07:44.887

C# 或其他 .net 语言中的结构类型通常用于保存应该表现得像固定大小的值组的东西。结构类型的一个有用方面是结构类型实例的字段可以通过修改它所在的存储位置来修改，而没有其他方式。可以以这样一种方式对结构进行编码，即改变任何字段的唯一方法是构造一个全新的实例，然后使用结构赋值来改变目标的所有字段，方法是用新实例中的值覆盖它们，但是除非结构没有提供创建其字段具有非默认值的实例的方法，否则如果结构本身存储在可变位置，则其所有字段都将是可变的。

请注意，如果结构包含私有类类型字段，并且将其自己的成员重定向到包装的类对象的成员，则可以设计一个结构类型，使其本质上表现得像一个类类型。例如， a`PersonCollection`可能提供属性`SortedByName`and `SortedById`，它们都持有对 a 的“不可变”引用`PersonCollection`（在它们的构造函数中设置）并`GetEnumerator`通过调用`creator.GetNameSortedEnumerator`or来实现`creator.GetIdSortedEnumerator`。此类结构的行为很像对 a 的引用`PersonCollection`，只是它们的`GetEnumerator`方法将绑定到`PersonCollection`. 也可以有一个结构包裹数组的一部分（例如，可以定义一个`ArrayRange<T>`结构，该结构将包含一个`T[]`被调用`Arr`的、一个 int`Offset`和一个 int`Length`，具有索引属性，对于`idx`0 到 范围内的索引`Length-1`，将访问`Arr[idx+Offset]`)。不幸的是，如果`foo`是这种结构的只读实例，当前的编译器版本将不允许这样的操作，`foo[3]+=4;`因为它们无法确定此类操作是否会尝试写入`foo`.

也可以设计一个结构，使其表现得像一个值类型，它包含一个可变大小的集合（只要结构存在，它就会被复制），但完成这项工作的唯一方法是确保没有对象struct 持有一个引用将永远暴露给任何可能改变它的东西。例如，可以有一个类似数组的结构，该结构包含一个私有数组，其索引“put”方法创建一个新数组，其内容与原始数组相同，只是有一个更改的元素。不幸的是，要使这样的结构有效地执行可能有些困难。虽然有时结构语义很方便（例如，能够将类似数组的集合传递给例程，但调用者和被调用者都知道外部代码不会修改集合，

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2019-02-27T16:39:27.580

**误区一：结构是轻量级的类**

这个神话有多种形式。有些人认为值类型不能或不应该有方法或其他重要行为——它们应该用作简单的数据传输类型，只有公共字段或简单属性。DateTime 类型是一个很好的反例：它是一个值类型是有意义的，因为它是一个像数字或字符这样的基本单位，而且它能够基于它执行计算也是有意义的它的价值。从另一个方向来看，数据传输类型通常应该是引用类型——决定应该基于所需的值或引用类型语义，而不是类型的简单性。其他人认为值类型在性能方面比引用类型“更轻”。事实是，在某些情况下，值类型的性能更高——例如，它们不需要垃圾收集，除非它们被装箱，没有类型识别开销，并且不需要取消引用。但在其他方面，引用类型的性能更高——参数传递、为变量赋值、返回值和类似操作只需要复制 4 或 8 个字节（取决于您运行的是 32 位还是 64 位 CLR ) 而不是复制所有数据。想象一下，如果 ArrayList 是某种“纯”值类型，并且将 ArrayList 表达式传递给涉及复制其所有数据的方法！几乎在所有情况下，性能都不是由这种决定决定的。瓶颈几乎永远不会出现在您认为会出现的地方，在您根据性能做出设计决策之前，您应该衡量不同的选项。值得注意的是，这两种信念的结合也不起作用。一个类型有多少方法（无论是类还是结构）并不重要——每个实例占用的内存不受影响。（就代码本身占用的内存而言，这是有代价的，但这是一次而不是每个实例。）

**误区二：引用类型在堆上；价值类型存在于堆栈中**

这通常是由于重复它的人的懒惰造成的。第一部分是正确的——总是在堆上创建一个引用类型的实例。这是导致问题的第二部分。正如我已经指出的，一个变量的值存在于它被声明的任何地方，所以如果你有一个具有 int 类型实例变量的类，那么任何给定对象的该变量的值将始终是该对象的其余数据所在的位置——在堆上。只有局部变量（在方法中声明的变量）和方法参数存在于堆栈中。在 C# 2 及更高版本中，甚至一些局部变量并不真正存在于堆栈中，正如我们在第 5 章中查看匿名方法时所看到的那样。这些概念现在是否相关？有争议的是，如果您正在编写托管代码，您应该让运行时担心如何最好地使用内存。的确，语言规范不保证什么生活在哪里；如果未来的运行时知道它可以摆脱它，那么它可能能够在堆栈上创建一些对象，或者 C# 编译器可以生成几乎不使用堆栈的代码。下一个神话通常只是一个术语问题。

**误区 #3：对象在 C# 中默认通过引用传递**

这大概是流传最广的神话了。同样，经常（尽管并非总是）提出这种说法的人知道 C# 的实际行为方式，但他们不知道“通过引用传递”的真正含义。不幸的是，这让知道这意味着什么的人感到困惑。引用传递的正式定义比较复杂，涉及左值和类似的计算机科学术语，但重要的是，如果你通过引用传递一个变量，你调用的方法可以改变调用者变量的值通过更改其参数值。现在，请记住引用类型变量的值是引用，而不是对象本身。您可以更改参数引用的对象的内容，而无需通过引用传递参数本身。例如，

```
void AppendHello(StringBuilder builder)
{
    builder.Append("hello");
} 
```

调用此方法时，参数值（对 StringBuilder 的引用）按值传递。如果您要在方法中更改 builder 变量的值——例如，使用语句 builder = null;——调用者不会看到该更改，这与神话相反。有趣的是，不仅神话中的“通过引用”位不准确，“对象被传递”位也是如此。对象本身永远不会通过引用或值传递。当涉及引用类型时，要么变量通过引用传递，要么参数（引用）的值通过值传递。除此之外，这回答了当 null 用作按值参数时会发生什么的问题——如果对象被传递，那会导致问题，因为没有对象可以传递！反而，空引用以与任何其他引用相同的方式按值传递。如果这个快速的解释让你感到困惑，你可能想看看我的文章“C#中的参数传递”（[http://mng.bz/otVt](http://mng.bz/otVt)），其中更详细。这些神话并不是唯一的。装箱和拆箱是因为它们存在相当大的误解，接下来我将尝试澄清。

**参考：** C# in Depth 3rd Edition by Jon Skeet

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2009-02-06T19:17:59.973

不——我不完全同意这些规则。它们是考虑性能和标准化的好指南，但不是考虑到可能性。

正如您在回复中看到的那样，有很多创造性的方式可以使用它们。因此，为了性能和效率，这些指导方针必须如此。

在这种情况下，我使用类来以更大的形式表示现实世界的对象，我使用结构来表示具有更精确用途的较小对象。就像你说的那样，“一个更有凝聚力的整体”。关键字具有凝聚力。这些类将是更多面向对象的元素，而结构可以具有其中一些特征，尽管规模较小。国际海事组织。

我在 Treeview 和 Listview 标签中经常使用它们，可以非常快速地访问常见的静态属性。我一直在努力以另一种方式获取这些信息。例如，在我的数据库应用程序中，我使用 Treeview，其中包含表、SP、函数或任何其他对象。我创建并填充我的结构，将其放入标签中，将其拉出，获取选择的数据等等。我不会在课堂上这样做！

我确实尝试让它们保持小，在单一实例情况下使用它们，并防止它们改变。谨慎注意内存、分配和性能。测试是如此必要。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2013-08-30T08:22:20.080

我的规则是

1、始终使用类；

2，如果有任何性能问题，我尝试根据@IAbstract 提到的规则将一些类更改为struct，然后进行测试，看看这些更改是否可以提高性能。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2014-05-23T09:52:52.953

类是引用类型。当创建类的对象时，分配给该对象的变量只保存对该内存的引用。当对象引用分配给新变量时，新变量引用原始对象。通过一个变量所做的更改会反映在另一个变量中，因为它们都引用相同的数据。结构是一种值类型。创建结构时，分配给结构的变量保存结构的实际数据。当结构被分配给一个新变量时，它被复制。因此，新变量和原始变量包含相同数据的两个单独副本。对一个副本所做的更改不会影响另一个副本。通常，类用于建模更复杂的行为，或在创建类对象后要修改的数据。

[类和结构（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173109.aspx)

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2016-03-27T22:16:35.113

我只是在处理 Windows Communication Foundation [WCF] Named Pipe，我确实注意到使用 Structs 来确保数据交换是**value type**而不是**reference type**确实有意义。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2016-05-26T14:31:11.493

简而言之，在以下情况下使用 struct：

1.  您的对象属性/字段不需要更改。我的意思是你只想给它们一个初始值，然后读取它们。

2.  对象中的属性和字段是值类型，它们不是那么大。

如果是这种情况，您可以利用结构来获得更好的性能和优化的内存分配，因为它们只使用堆栈而不是堆栈和堆（在类中）

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2017-10-24T13:15:22.553

C# 结构是类的轻量级替代方案。它可以做的几乎与类相同，但使用结构而不是类更“昂贵”。这样做的原因有点技术性，但总而言之，一个类的新实例放在堆上，新实例化的结构放在堆栈上。此外，您不是像处理类那样处理对结构的引用，而是直接使用结构实例。这也意味着当您将结构传递给函数时，它是按值传递的，而不是作为引用。在关于函数参数的章节中有更多关于这一点的内容。

因此，当您希望表示更简单的数据结构时，您应该使用结构，尤其是当您知道您将实例化大量它们时。.NET 框架中有很多示例，其中 Microsoft 使用结构而不是类，例如 Point、Rectangle 和 Color 结构。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-02-06T17:44:34.093

我认为一个好的第一个近似值是“从不”。

我认为一个好的第二个近似值是“从不”。

如果您迫切需要性能，请考虑它们，但要始终衡量。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2013-07-03T14:20:39.040

结构可用于提高垃圾收集性能。虽然您通常不必担心 GC 性能，但在某些情况下它可能会成为杀手。就像低延迟应用程序中的大型缓存一样。有关示例，请参见此帖子：

[http://00sharp.wordpress.com/2013/07/03/a-case-for-the-struct/](http://00sharp.wordpress.com/2013/07/03/a-case-for-the-struct/)

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2020-10-15T14:24:47.670

以下是 Microsoft 网站上定义的规则：

✔️ 如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。

❌ 避免定义结构，除非该类型具有以下所有特征：

它在逻辑上表示单个值，类似于原始类型（int、double 等）。

它的实例大小小于 16 个字节。

它是不可变的。

它不必经常装箱。

供进一步[阅读](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/choosing-between-class-and-struct?redirectedfrom=MSDN)

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2021-05-02T17:18:46.217

除了通常提到的性能差异之外，让我添加另一个方面，那就是揭示默认值使用的意图。

> 如果结构的字段的默认值不代表建模概念的合理默认值，则不要使用结构。

例如。

*   即使所有字段都设置为默认值，颜色或点也是有意义的。RGB 0,0,0 是一种非常好的颜色， (0,0) 作为 2D 中的点也是如此。
*   但是 Address 或 PersonName 没有合理的默认值。我的意思是你能理解 FirstName=null 和 LastName=null 的 PersonName 吗？

如果你用一个类实现一个概念，那么你可以强制执行某些不变量，例如。一个人必须有名字和姓氏。但是对于结构，总是可以创建一个实例，并将其所有字段设置为默认值。

因此，在对没有合理默认值的概念进行建模时，更喜欢使用类。您的类的用户将理解 null 意味着未指定 PersonName，但如果您将其所有属性都设置为 null 的 PersonName 结构实例交给他们，他们会感到困惑。

（通常的免责声明：性能考虑可能会覆盖此建议。如果您有性能问题，请始终在决定解决方案之前进行测量。试试[BenchmarkDotNet](https://benchmarkdotnet.org/articles/overview.html)，这太棒了！）

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-02-06T19:21:34.663

我很少使用结构来做事情。但这只是我。这取决于我是否需要对象可以为空。

如其他答案所述，我将类用于真实世界的对象。我也有结构用于存储少量数据的心态。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-04-12T20:50:19.660

✔️ 考虑结构用法

1.  创建对象或不需要创建对象（可以直接赋值，创建对象）
2.  需要速度或性能改进
3.  不需要构造函数和析构函数（提供静态承包商）
4.  不需要类继承，但接口是可以接受的
5.  小工作量对象工作，如果它变高，就会引发内存问题
6.  您不能为变量设置默认值。
7.  struct 还有可用的方法、事件、静态构造函数、变量等
8.  减少 GC 的工作量
9.  不需要引用类型，只需要值类型（每次创建新对象时）
10.  没有不可变对象（字符串是不可变对象，因为任何操作都不会每次返回任何新字符串而不更改原始字符串）

* * *

## 回答 #30

> 赞同：-12
> 
> 时间：2014-11-20T20:02:07.380

结构在大多数方面类似于类/对象。结构可以包含函数、成员并且可以被继承。但是结构在 C# 中仅用于**数据保存**。结构确实比类**占用更少的 RAM ，并且****更容易被垃圾收集器收集**。但是当您在结构中使用函数时，编译器实际上将该结构与类/对象非常相似，因此如果您想要带有**函数的东西，请使用类/对象**。

# c# - 我为什么要学习 C#？

> ID：521305
> 
> 赞同：7
> 
> 时间：2009-02-06T17:39:28.597
> 
> 标签：c#, java

我想知道为什么我应该学习 C#？

C# 有哪些 Java 没有的特性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T17:45:06.587

C# 是一种面向对象的高级语言，可用于开发应用程序。

它支持 getter/setter 构造、委托和真正的泛型，而 Java 不支持。C# 在 Windows 上通常感觉更“原生”，因为 Windows.Forms 和 WPF 比 Swing 更接近原生代码。然而，Java 比 C# 更具跨平台性（尽管项目“Mono”正在改变这一点）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T17:43:59.460

有很多不同之处：[http ://en.wikipedia.org/wiki/Comparison_of_C_Sharp_and_Java](http://en.wikipedia.org/wiki/Comparison_of_C_Sharp_and_Java)

是否应该使用其中一个取决于您的优先级。你想在里面写什么？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T17:46:50.530

C#（和其他 CLR 语言）具有函数式编程的某些方面（例如委托和闭包），这使得某些类型的开发和设计模式更容易。有关更多信息，请参阅[Steve Yegge](http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html)的这篇文章。代表可以使代码更具表现力和简洁性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T17:46:41.217

您应该同时学习这两种方法，并酌情使用它们中的每一种。我不觉得这是一个“我应该学习哪个？” 一种问题。（或者“我知道 Java，我为什么要学习 C#？”的问题。） Welbog 发布的比较将帮助您决定*何时*使用其中一个而不是另一个。但是，我自己，我喜欢在我的工具包中同时拥有这两者。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T18:04:45.037

语法：它们都是合理的语言——它们支持几乎相同的高级结构和设计（OO，封装，......）并且在你进入代码级别之前是相当平等的（总体来说并没有那么大一笔交易。我猜 C# 在功能上胜过 java，Java 在简单性上胜过 C#）。

便携性：我最大的因素是最近我为频谱分析仪和即将推出的有线电视系统开发了应用程序。两者都不会在 C# 中远程编程（您完全依赖微软将运行时移植到您感兴趣的平台。Java 是开源的（可能还有一两个小部分不是，但他们真诚地致力于这样就足够了，您可以移植它并在任何地方使用它。

如果您只对 Windows 感兴趣，并且想利用与 Windows 的紧密、简单的集成，那么 C# 就是适合您的平台。

VM 这两种语言都包含一个“运行时”，它可以支持其他语言——而那些其他语言通常可以访问每个环境中提供的（非常丰富的）库。

微软可以在它的虚拟机上运行几种（十几种）语言，没有一个比 C# 更令人印象深刻（尽管 Ruby 和 Python 可能很好——它们是否完全可用）？

JVM 有数百种语言，包括一些尖端的实验语言，这些语言通常运行得与原生语言一样好或更好。有些被认为是编程的下一代，与 Java/C# 和 C 不同。我研究了 Scala，但我一定是老了，这让我很头疼，但我承认有一些非常先进的概念在那里。时髦的岩石。

系统集成/工具：C# 胜出，因为 Java 不能提交到任何一个平台。C# 与数据库和其他外部依赖项的集成也非常好，Java 的集成越来越好，但工具有点不匹配。C# 整个工具集往往是非常集成的，因为它们都往往来自单一供应商。

使用它的平台数量（潜在客户数量）：上次我听说，Java 胜出。下降。每次都想弄清楚有多少电话、微波炉、电视和烤面包机可能在运行 Java？据我所知，这个数字使所有其他语言相形见绌......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T17:51:01.693

**你应该**这样做的唯一原因是因为你想

C# 是一个

> 多范式编程语言，包括函数式、命令式、通用、面向对象（基于类）和面向组件的编程学科

所以你可以从不同的范式中学习很多技巧，所有这些都用一种语言

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T17:51:23.893

人们已经就这个话题[提出](https://stackoverflow.com/questions/327332/what-should-a-non-cs-grad-learn-to-be-good-with-programming-languages-like-c)了很多[问题](https://stackoverflow.com/questions/386027/why-would-i-want-to-learn-to-use-c-instead-of-c-c)[。](https://stackoverflow.com/questions/325046/java-or-net)阅读，他们那里有很好的信息。:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T17:50:57.527

最大的原因，恕我直言，这是因为（至少对于 Windows 桌面应用程序）Java UI 非常丑陋。丑得要命。恶心至极。丑得就像你让你姐姐怀孕生下的孩子一样。

如果您需要在任何操作系统上运行，Java 是您的最佳选择（但 Mono 正在迎头赶上！）。但是，如果您正在为 Windows 环境进行编程，那么 C# 是您的梦想，并且看起来就像任何其他本机应用程序一样。

除此之外，我会说Linq。并且能够在异常上快速失败，而不必在任何地方处理异常（就像我们实际上知道如何处理每个异常一样）。哦，又是 Linq。Linq 太美了……对我来说……你看不出来吗？

废话，忘了lambda。该死的，我喜欢 lambdas 和它们所有的封闭性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T19:55:46.123

简单的答案——C# 是目前开发 Micorosft 应用程序的主要语言。学习它为开发基于 Microsoft 的应用程序打开了一个潜在机会的新世界。

而且，学习起来也不是那么难。只是比 VB 难一点，但有很多面向对象的能力。

有人会说 C# 是 Microsoft 的 Java——实际上它们看起来几乎相同，只是略有不同，但类库不同。如果您已经了解 Java，那么学习 C# 应该不会太难。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T21:23:59.453

我不敢相信还没有人发过这个。。

因为，它是一种*有趣*的语言。我个人认为 Java 是一种相当讨厌的语言（仍然可以很有趣），但不如 C# 有趣。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-07T02:16:10.830

你需要学习C#吗？

你的工作状况会好转吗？
你想学点新东西吗？

C#中的开发环境更好吗，工具更好吗？
你认为你可以用 C# 做一些你不能用 Java 做的事情吗？

也许是桌面、Web 和移动设备的通用语言——但 Java 也有。

你可以用几个问题来决定。

我自己是 C#，当我被介绍编程时，我开始使用 Java。我认为 Java 在理解编程方面为我做了出色的工作，主要是因为没有神奇的 IntelliSense 或 Windows 应用程序的表单设计器——我们必须自己编写整个该死的东西。这很好，当你学习的时候。但我认为 C# 和整个 .NET/Visual Studio 生态系统可以让您提高工作效率。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T17:45:02.547

比语言特性更重要的是运行时环境和库。

C# 和 Java 有一组不同的库、框架、操作系统交互等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-06T17:53:57.273

基于这个问题，您似乎对学习它不感兴趣，以便更多地了解编程并明确寻找实际原因。

这就是为什么我不认为你应该费心去学习它，因为它只是在你的工具箱中完成同样事情的另一个工具。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-06T19:50:51.437

我喜欢 Welbog 写的东西。我要补充一点，这还取决于你的专业水平、兴趣和工作前景/兴趣。

如果您刚刚开始学习 Java，那么学习一点 C# 可能有助于拓宽您的编程视野。这些语言是相似的（粗略地说），但当然至少在一种与另一种编程中存在细微差别。如果您已经使用 Java 编程了一段时间，那么您最好还是扩展您的 J2EE 专业领域，或者寻找其他支持领域和/或语言。

在工作前景方面，您可能会发现您所在地区的公司雇用的 .NET 开发人员比 Java 多，反之亦然。您可能还想查看您想为之工作的公司，并确保您的技能匹配。例如，如果您梦想在一家使用 JSP 的特定公司工作，例如，那么坚持使用 Java 会更好。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-06T19:57:33.077

您应该学习的不是 C#，而是 .NET Framework 和相关技术。想想 J2EE 与 .NET。为什么要学习 .NET？由您决定。与 Java 一样，它是少数主要的开发平台之一。它功能强大，非常积极地开发并得到庞大的社区知识库的支持。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-06T22:33:15.057

对我来说，选择很简单，因为我需要使用 .NET 库，所以我将使用 C#，或者我需要使用 Java 库，所以我将使用 Java。如果我在 Windows 客户端上工作，我将使用 C#，如果我正在处理需要针对 P6 集成 API 运行的东西，我将使用 Java。

您不应该觉得自己缺少某些东西，或者应该使用其中一种。看看你必须做什么，然后选择最好的工具来做这件事。

很难在此处列出 .NET Framework 的所有功能，就像很难列出 Java SDK 库中包含的所有功能一样。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-06T23:33:18.350

学习 C#，因为它可能有也可能没有 Java 没有的特性，这似乎是一个非常奇怪的理由（它确实有许多特性，Java 没有，但 F#、LISP、Haskel、Ruby、Lua甚至 COBOL）。

你应该学习 C# 因为

*   你需要（为了保住或找到工作，留在学校，无论如何）
*   你想要
*   扩展视野很有趣
*   以上任何一项或全部

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-07T02:00:00.317

.NET 中有一些语法糖优势，例如 LINQ 或 Properties。（是的，在 Java 中你没有属性——更不用说自动属性了）。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2017-01-31T17:41:25.717

从战略上讲，它有助于了解几种语言，正如一些研究所证明的那样。目前，PHP、Java 和 ASP.NET (C#) 是使用最广泛的服务器端编程技术（参见[https://w3techs.com/technologies/overview/programming_language/all](https://w3techs.com/technologies/overview/programming_language/all)）。因此，了解这三个方面可以增强您的后端工程潜力。

# php - ColdFusion/PHP 兼容性

> ID：521308
> 
> 赞同：5
> 
> 时间：2009-02-06T17:40:16.253
> 
> 标签：php, coldfusion

嘿，我有一个关于 ColdFusion 和 PHP 兼容性的问题。

我们建立了一个基于 ColdFusion 的社区网站。是否完全可以用 PHP 向我们的网站添加诸如博客和其他社区功能之类的功能？

我的意思是将 PHP 和 ColdFusion 结合在一起。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T18:09:23.497

如果您使用的是 ColdFusion 8，我认为可以做到。我知道 Sean [Corfield 在 RIAForge 上有一个项目正在](http://scripting.riaforge.org/)做这种事情，他的博客上有一系列帖子，从这个开始：

[http://corfield.org/blog/index.cfm/do/blog.entry/entry/ColdFusion_8_running_PHP](http://corfield.org/blog/index.cfm/do/blog.entry/entry/ColdFusion_8_running_PHP)

综上所述，集成来自相同核心语言的产品会更容易。ColdFusion 中有数百个用于不同事物的开源选项。[RIAForge.org](http://riagforge.org/)是一个很好的起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T16:22:34.460

Your question wasn't really focused enough to give a single direct correct answer.

> We built a community website which is based on ColdFusion. Is it altogether possible to add features such as blogs, and other community features to our website in PHP?
> 
> I mean to combine both PHP and ColdFusion together.

When you say you want to "combine" them, what exactly do you mean? They can both co-exist on a web server and both have access to the same database; so if you want both PHP and ColdFusion applications to have access to the same data, that is not a problem at all. There would be some concerns about locking and race conditions, but from an "is this possible?" standpoint, the answer is undoubtedly **YES**.

Sharing session, client, or other special scopes/variables from CF to PHP should be possible with some clever programming, but would be tricky. It would depend entirely on your needs and your implementation.

If you're looking for applications to add to your community, I would recommend that you try to find something in CFML that suits your needs before you go the route of attempting to mix CFML and PHP. There are tons of free open source applications including blogs and wikis written in CFML available on [RIAForge](http://www.riaforge.org/), and other websites. [Canvas Wiki](http://canvas.riaforge.org/), and [Codex Wiki](http://codexwiki.riaforge.org/) are solutions that focus strictly on Wiki functionality, and there are others that include Wiki functionality as part of a larger package. Searching for "blog" in the ColdFusion category on RIAForge shows no less than 6 blogging applications like [BlogCFC](http://blogcfc.riaforge.org/) and others, and that doesn't even include my personal favorite, [Mango Blog](http://www.mangoblog.org/).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T19:46:25.907

是的，这是可能的。您可能必须将 PHP 应用程序的会话管理集成到您的 Coldfusion 应用程序的会话管理中。

我最近在 Coldfusion 中使用 PHP 购物车做到了这一点，因为我没有时间或资源来在 Coldfusion 中获得相同的结果——通常 CF 中出色且精美的部分可能会花费一些钱，而使用 PHP 是一场赌博或者一个时间坑，让它随心所欲地跳舞。

其次，在 Coldfusion 中可能已经有适合您需求的博客、论坛等。去看一下。您可能会更倾向于一个平台。您可能需要一个 PHP 解决方案，因为它有插件或其他您不想编程的东西。

我喜欢你最好的方法，Coldfusion 总体上比开源有更多的商业开发，当涉及到功能令人难以置信的大型软件包时。

祝你好运，一定要分享你最终做了什么。

* * *

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T18:21:04.130

我认为 Corfield 的方式不是（非常）适合博客和论坛等独立应用程序。但它可以帮助共享会话。

另一方面，这些类型的软件在 CF 世界中并不是那么好。

我最好建议使用网络服务器设置。关于 IIS 不能说太多，但在 Apache 中，您通常对 .cfm 和 .php 文件使用不同的处理程序。这里可能的问题是索引文件，可以是 index.cfm 或 index.php。在这种情况下 .htaccess 规则应该会有所帮助。

因此，调整网络服务器允许在 CF 应用程序的子目录中使用 PHP 应用程序。

其他可能性是使用子域，这更容易设置，可以满足您的需求。比如说 blog.website.com 和 forum.website.com

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T21:50:19.247

向楼主提问：抱歉这么奇怪的回复，我还不能在这里发表评论。也为小型机顶感到抱歉。

致 Ray Camden：是的，我是说CF 的*开源*论坛/博客不如 PHP 好。我很高兴知道 Galleon 和 BlogCFC。但如果谈论特性——它们是 2006 年的 PHP 类似物，尤其是 Galleon。BlogCFC 快速成长并变得更好。

无论如何，我怀疑许多 BlogCFC 用户使用它，因为它是*用 CFML 编写的*。我也是，部分。

问题不在于这两个应用程序，它们可以满足某人的需求。问题是没有其他选择。或者也许我在这里错了，还有很多这些类型的其他很酷的应用程序？

是的。也许还有其他*令人惊叹的专有*博客/论坛，但我们现在不是在谈论它们，对吧？

# c# - 在 ASP.NET 中重写 URL？

> ID：521310
> 
> 赞同：12
> 
> 时间：2009-02-06T17:40:40.870
> 
> 标签：c#, asp.net, url-rewriting, web-config

我正在使用 ASP.NET C#。

如何实现类似于 StackOverflow.com 的 URL 重写过程？

```
http://stackoverflow.com/questions/358630/how-to-search-date-in-sql 
```

另外，URL中的“358630”等值是什么意思？这是问题 ID（他们用来从表中获取数据的基础）吗？不管是什么，在我的应用程序中，我使用“ID”字段来识别记录。此字段是 SQL 表中的标识列。现在，我的网址如下：

```
http://myweb.com/showdetails.aspx?id=9872 
```

但我希望它们看起来像：

```
http://myweb.com/showdetails/9872/my_question_title 
```

或者：

```
http://myweb.com/9872/my_question_title 
```

或者任何最好的方法，这对搜索机器人来说会很好吃。

我的应用程序托管在[Go Daddy](http://en.wikipedia.org/wiki/Go_Daddy)的共享托管服务上，我觉得他们的服务器上没有自定义的 ASP.NET“HTTP 模块”或用于 URL 重写的自定义 DLL。我尝试了很多样品，但还没有运气！

我发现 Stack Overflow 托管在 Go Daddy（共享托管？）上。也许 Stack Overflow 的方法对我有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T17:44:46.340

所以正在使用[ASP.NET MVC](http://asp.net/mvc)。您确实需要详细阅读 MVC URL 重写的工作原理，但要点是 URL 中的“问题”部分是控制器类的名称（大致对应于 URL 中的“显示详细信息”）和number 是该控制器上默认操作的 ID 参数（与 URL 中的参数“id”相同）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T18:30:47.603

由于 MVC 不是一个选项，您可以尝试重定向 404。这将适用于 ASP.NET **1.1**及更高版本：使用 IIS 配置或 web.config 将 404 和 405 重定向到您自己的处理程序，解析处理程序中的请求并重定向到适当的资源。

```
<configuration>
   <system.web>
    <customErrors mode="On" defaultRedirect="error.html">
        <error statusCode="404" redirect="newHandler.aspx"/>
    </customErrors>       
   </system.web>
</configuration>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T17:45:25.120

在 System.Web.Routing 出现之前，常见的做法是使用[UrlRewriter.NET](http://urlrewriter.net/)。工作得很好，但在配置 IIS 时可能会咬你。我不确定是否有任何简单的方法可以在 ASP.NET 中使用新的路由类（即，将其放入并使用重构代码）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T18:53:38.523

> 请解释URL中“358630”等值的含义

那是（大概）数据库中问题的 ID。在 MVC 模型中

```
 myurl.com/questions/358630 
```

类似于

```
myurl.com/questions.aspx?id=358630 
```

URL 末尾的问题标题实际上被应用程序忽略了。它通常被“附加”用于搜索引擎优化和人类可读性目的。实际上，您可以在 URL 中更改此问题的标题，并注意页面仍然可以正常加载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T22:46:29.350

新的 System.Web.Routing dll 是 ASP.NET 3.5 SP1 的一部分，[可在 ASP.NET 3.5 上进行二进制部署](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)，因此您可以在[经典的 ASP.NET WebForms 站点](http://msdn.microsoft.com/en-us/library/cc668202.aspx)上使用它的特性。

您可能需要注意 Phil Haack 在他[关于在 IIS 6 上使用 MVC 的帖子中](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)的评论，因为您可能需要在路由 url 中包含 .aspx 扩展名

```
http://www.mysite.com/controler.aspx/action/id 
```

您可能还想查看[标记为 SEO 的问题](https://stackoverflow.com/questions/tagged/seo)。

url 末尾被忽略的问题名称通常称为“Slug”，用于 SEO 目的以在 url 中包含页面标题。

# java - 您何时以及为什么会使用 Apache commons-digester？

> ID：521312
> 
> 赞同：12
> 
> 时间：2009-02-06T17:40:46.613
> 
> 标签：java, apache-commons-digester

在使用 java 输入和输出 xml 的所有库中，在哪些情况下 commons-digester 是首选工具？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T19:13:50.777

来自[消化器维基](http://wiki.apache.org/commons/Digester/WhyUseDigester)

> 为什么要使用消化器？
> 
> Digester 是 SAX xml 解析器 API 之上的一个层，可以更轻松地处理 xml 输入。特别是，digester 使得基于 xml 输入文件创建和初始化对象树变得容易。
> 
> Digester 最常见的用途是处理 xml 格式的配置文件，根据该信息构建对象树。
> 
> 请注意，digester 可以创建和初始化真实对象，即与应用程序的业务目标相关并具有真实行为的事物。许多其他工具有不同的目标：在输入 XML 文档中构建数据模型，就像 W3C DOM 所做的那样，但更友好一些。

和

> 与生成类的工具不同，您可以先编写应用程序的类，然后再决定使用 Digester 从 xml 输入文件构建它们。结果是您的类是具有真实行为的真实类，恰好是从 xml 文件初始化的，而不是仅保存数据的简单“结构”。

作为它不用于的示例：

> 但是，如果您正在寻找输入 xml 文档的直接表示，作为数据而不是真实对象，那么 digester 不适合您；DOM、jDOM 或其他更直接的绑定工具会更合适。

因此，digester 会将 XML 直接映射到 java 对象中。在某些情况下，这比通读树并提取选项更有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T06:21:57.737

我的第一个想法是“从不”……但也许它有它的位置。我同意 eljenso 的观点，即它已被竞争超越。

因此，对于高效且简单的对象绑定/映射，[JAXB或](http://jaxb.dev.java.net)[XStream](http://xstream.codehaus.org)更好。更方便，甚至更快。

编辑 2019：还有，[Jackson XML](https://github.com/FasterXML/jackson-dataformat-xml)，在方法上类似于 JAXB，但使用 Jackson 注释

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T19:20:37.020

如果您想从 XML 创建和初始化“真正的”对象，请使用一个像样的 bean 容器，例如 Spring 提供的容器。

此外，使用 XPath 或使用 Java/XML 绑定工具（如 Castor）读取 XML 并自行处理它是很好的并且可能是更标准的替代方案。

在使用 Struts 时，我曾使用过 Digester，但它的可能用途似乎已被其他工具和框架超越。

# python - 具有多个列表的 Python 循环？

> ID：521321
> 
> 赞同：15
> 
> 时间：2009-02-06T17:42:27.093
> 
> 标签：python, arrays, loops, list

**<edit>** 感谢到目前为止所有回答的人。zip 和 os.path.join 真的很有帮助。关于在前面列出计数器的方法的任何建议，而不做这样的事情：

```
zip(range(len(files)), files, directories) 
```

**</编辑>**

你好，

我正在学习 Python，但我来自以下伪代码的典型背景：

```
directories = ['directory_0', 'directory_1', 'directory_2']
files = ['file_a', 'file_b', 'file_c']

for(i = 0; i < directories.length; i++) {
    print (i + 1) + '. ' + directories[i] + '/' + files[i] + '\n'
}

# Output:
# 1\. directory_0/file_a
# 2\. directory_1/file_b
# 3\. directory_2/file_c 
```

在 Python 中，我现在写上面的方式是这样的：

```
directories = ['directory_0', 'directory_1', 'directory_2']
files = ['file_a', 'file_b', 'file_c']

for i in range(len(directories)):
    print '%s. %s/%s' % ((i + 1), directories[i], files[i]

# Output:
# 1\. directory_0/file_a
# 2\. directory_1/file_b
# 3\. directory_2/file_c 
```

在阅读 Dive into Python 时，Mark Pilgrim 说将 for 循环用于计数器是“Visual Basic 风格的思维”（[简单计数器](http://diveintopython.net/file_handling/for_loops.html#fileinfo.for.counter)）。他继续展示如何在字典中使用循环，但从未真正解决关于如何在其他语言中通常使用 for 循环计数器的 python 解决方案。

我希望有人能告诉我如何用 Python 正确地编写上述场景。有可能以不同的方式来做吗？

如果我取出递增的行数，是否可以使用某种列表理解将两个列表匹配在一起？

例如，如果我从输出中想要的只是这个（没有计数器，列表理解是否可能）：

```
# Output:
# directory_0/file_a
# directory_1/file_b
# directory_2/file_c 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-06T17:49:07.547

```
import os.path
for dir, file in zip(directories, files):
    print(os.path.join(dir, file))                      # for directories, files 
```

您也可以将其作为列表理解，然后创建带有打印的字符串列表]

带计数器：

```
for i, (dir, file) in enumerate(zip(directories, files)):
    print(i, os.path.join(dir, file)) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-06T17:46:38.380

试试这个：

```
directories = ['directory_0', 'directory_1', 'directory_2']
files = ['file_a', 'file_b', 'file_c']

for file, dir in zip(files, directories):
    print dir + '/' + file 
```

解释一下，该`zip()`函数将列表作为输入并返回“压缩”元组的列表。所以`zip([1,2,3,4,5],[a,b,c,d,e])`会回来`[(1,a),(2,b)`等等。

`for <var> in <list>`然后，您可以使用 python语法将元组的成员分配给变量。

有一百万种不同的方法来做你所要求的，但上面使用了一些更多的“pythonic”结构来使代码更具可读性（恕我直言，无论如何）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-26T17:37:45.207

如果要在 Python 中的任何 for 循环中添加计数器，可以使用 enumerate() 函数：

```
listA = ["A", "B", "C", "D", "E"]
listB = ["a", "b", "c", "d", "e"]
for i, (a, b) in enumerate(zip(listA, listB)):
    print "%d) %s, %s" % (i, a, b) 
```

给出输出：

```
0) A, a
1) B, b
2) C, c
3) D, d
4) E, e 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T17:51:54.500

基于 Ryan 的回答，您可以执行以下操作：

```
for fileDir in [dir + '/' + file for dir in directories for file in files]:
    print(fileDir) 
```

# python - How does one parse simple inline markup (i.e. *bold*), in Python?

> ID：521326
> 
> 赞同：4
> 
> 时间：2009-02-06T17:43:21.100
> 
> 标签：python, parsing, wikitext, creole

How does one implement a parser (in Python) for a subset of wikitext that modifies text, namely:

```
*bold*, /italics/, _underline_ 
```

I'm converting it to LaTeX, so the conversion is from:

```
Hello, *world*! Let's /go/. 
```

to:

```
Hello \textbf{world}! Let's \textit{go}. 
```

Though there's nothing specific about it being a conversion to LaTeX (notably except nested cases like "*bold /italics* whatami/" => "textbf{bold \textit{italics} whatami}").

I've looked at [existing markup libraries](https://stackoverflow.com/questions/154592), but they're (a) not quite the wiki language I'd like, and (b) seemingly overpowered for this problem.

I've considered reverse engineering [Creoleparser](http://creoleparser.googlecode.com/svn/docs/index.html), but I'd like to know what suggestions others have before I undertake that effort.

Thanks!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T17:50:33.613

如果你的语言很小，正则表达式可能是最不痛苦的解决方案：

```
>>> import re
>>> str = "Hello, *world*! Let's /go/."
>>> str = re.sub(r"\*([^\*]*)\*", r"\textbf{\1}", str)
>>> str = re.sub(r"/([^/]*)/",   r"\textit{\1}", str)
>>> str
"Hello, \textbf{world}! Let's \textit{go}." 
```

# ruby - 运行命令后页面显示为真：'webby'

> ID：521330
> 
> 赞同：0
> 
> 时间：2009-02-06T17:44:21.957
> 
> 标签：ruby, ubuntu, ubuntu-8.10, webby

我正在运行[webby 教程](http://webby.rubyforge.org/tutorial/)，我将进入第一次运行**webby**命令以在 /output 目录中生成网站的部分。

我这样做了，然后我被告知打开 output/index.html。我这样做了，唯一显示的是：

```
true 
```

我查看源代码...显示的只是

```
true 
```

这不是几年前的百威广告！这是韦比！

[我在这里](http://leeand00.tiddlyspot.com/#[[Installing%20Webby]])写下了我用来安装 webby 的命令，但它似乎仍然不起作用。

根据**webby -v**命令...我做对了。我做错什么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:59:14.483

只是为了确认-您是否在浏览器中打开了 output/index.html ？而你描述的“真实”就是你在浏览器中看到的......？

在运行`webby`命令之前，您是否编辑了任何文件，尤其是`content/index.txt`？你能粘贴这里的内容`content/index.txt`吗...？

您是否安装`RedCloth`以及是否`Webby`作为依赖项自动安装？如果运行以下命令，可以查看是否`RedCloth`已安装。

```
gem list RedCloth 
```

# asp.net - 数据绑定下拉列表 - 初始值

> ID：521334
> 
> 赞同：28
> 
> 时间：2009-02-06T17:44:46.510
> 
> 标签：asp.net, vb.net, drop-down-menu

如何在 ASP.NET 中设置数据绑定下拉列表的初始值？

例如，我想要这些值，但要显示的第一个值应该是 -- Select One ---，具有空值。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-06T19:01:18.790

我想你想要做的是：

```
<asp:DropDownList ID="DropDownList1" runat="server" AppendDataBoundItems="true">
    <asp:ListItem Text="--Select One--" Value="" />   
</asp:DropDownList> 
```

确保“AppendDataBoundItems”设置为*true*，否则在绑定数据时将清除“--Select One--”列表项。

如果您将下拉列表的“AutoPostBack”属性设置为*true*，您还必须将“CausesValidation”属性设置为*true* ，然后使用“RequiredFieldValidator”确保“--Select One--”选项不存在'不会导致回发。

```
<asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ControlToValidate="DropDownList1"></asp:RequiredFieldValidator> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-08-13T18:20:40.790

我知道这是旧的，但这些想法的组合导致了一个非常优雅的解决方案：

保留 DropDownList 的所有默认属性设置（AppendDataBoundItems=false，Items 为空）。然后像这样处理 DataBound 事件：

```
protected void dropdown_DataBound(object sender, EventArgs e)
{
    DropDownList list = sender as DropDownList;
    if (list != null)
        list.Items.Insert(0, "--Select One--");
} 
```

锦上添花的是，这个处理程序可以由任意数量的 DropDownList 对象共享，甚至可以放入所有项目的通用实用程序库中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T19:17:33.453

我所做的是在我数据绑定之后设置下拉列表的文本属性。像这样的东西：

```
 protected void LoadPersonComboBox()
    {
        var p = new PeopleBLL();

        rcmbboxEditPerson.DataSource = p.GetPeople();
        rcmbboxEditPerson.DataBind();
        rcmbboxEditPerson.Text = "Please select an existing person to edit...";
    } 
```

这使得该下拉列表的初始可见值显示出来，但实际上不是下拉列表的一部分，也不是可选的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T15:38:11.480

我知道这已经有一个选择的答案 - 但我想投入我的两分钱。我有一个数据绑定下拉列表：

```
<asp:DropDownList 
  id="country" 
  runat="server" 
  CssClass="selectOne" 
  DataSourceID="country_code" 
  DataTextField="Name" 
  DataValueField="CountryCode_PK"
></asp:DropDownList>
<asp:SqlDataSource 
  id="country_code" 
  runat="server" 
  ConnectionString="<%$ ConnectionStrings:DBConnectionString %>"
  SelectCommand="SELECT CountryCode_PK, CountryCode_PK + ' - ' + Name AS N'Name' FROM TBL_Country ORDER BY CountryCode_PK"
></asp:SqlDataSource> 
```

在代码隐藏中，我有这个 - （默认选择美国）：

```
if (this.IsPostBack)
{
  //handle posted data
}
else 
{
  country.SelectedValue = "US";
} 
```

该页面最初基于“US”值加载，而不是试图担心 selectedIndex（如果将另一个项目添加到数据表中 - 我不想重新编码）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-05T12:58:26.427

要从下拉列表中选择一个值，请使用如下索引：

如果我们有

```
<asp:DropDownList ID="DropDownList1" runat="server" AppendDataBoundItems="true"></asp:DropDownList> 
```

你会使用：

```
DropDownList1.Items[DropDownList1.SelectedIndex].Value 
```

这将返回所选索引的值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-31T04:50:29.620

嗨，朋友，在这种情况下，您可以使用

```
AppendDataBound="true" 
```

然后使用列表项。例如：

```
<asp:DropDownList ID="DropDownList1" runat="server" AppendDataBoundItems="true">
    <asp:ListItem Text="--Select One--" Value="" />   
</asp:DropDownList> 
```

但问题是在第二次选择数据附加旧数据之后。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T17:48:49.733

添加一个项目并将其“Selected”属性设置为true，您可能还希望将“appenddatabounditems”属性设置为true，以便在数据绑定时不会删除您的初始值。

如果您正在谈论设置数据绑定项目中的初始值，然后挂钩您的 ondatabound 事件并设置您想要选择的索引=true，您将希望将其包装在“如果不是 page.isPostBack 则 ....”尽管

```
Protected Sub DepartmentDropDownList_DataBound(ByVal sender As Object, ByVal e As    System.EventArgs) Handles DepartmentDropDownList.DataBound
    If Not Page.IsPostBack Then
        DepartmentDropDownList.SelectedValue = "somevalue"
    End If
End Sub 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-08-05T05:11:33.870

```
dropdownlist.Items.Insert(0, new Listitem("--Select One--", "0"); 
```

# c++ - 使用英语的 Windows XP 中的 DirectX 应用程序出现无法解释的崩溃

> ID：521338
> 
> 赞同：2
> 
> 时间：2009-02-06T17:45:24.840
> 
> 标签：c++, windows-xp, directx

该应用程序运行良好，但几周后，当新版本开始测试时，它崩溃了。在五个工作站上尝试过，它只在其中两个上崩溃。我能找到的关于它们的唯一共同点是，它们两个都安装了带有英语的 Windows。

它是一个 DirectX 8.1 应用程序，使用 Visual Studio 2005 用 C++ 编写。SP2 安装在所有机器上。

我不知道是什么原因造成的。当然，该语言不会导致 DX 应用程序崩溃？我将寻找更常见的元素，但我只想问是否有人以前见过这个？如果语言真的是问题。以及如何解决。

**编辑**：实际的错误信息是

```
This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix the problem. 
```

起初我们认为它是 Visual Studio Redistributable，但没有运气。有些东西不见了，我需要弄清楚是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:54:26.290

确保在检查错误时不比较字符串消息。我在套接字错误消息中搜索“拒绝”的代码中看到了这样的错误，在非英语机器上失败了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T09:33:44.470

问题解决了。作为对其他有同样问题的人的说明，我在这个[问题](https://stackoverflow.com/questions/265481/application-has-failed-to-start-application-configuration-is-incorrect-vc)中找到了答案。我们安装了 VS2005 CRT 没问题，但没有安装 SP1。

**编辑**：虽然，我仍然不知道为什么这只影响了英语工作站。也许这毕竟是一个巧合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:21:47.510

也许“英文版”工作站会自动更新，并更新到比其他计算机上的更新版本的 DirectX。

尝试使用该`dxdiag`程序比较每台计算机上的 DirectX 版本。

每个工作站之间还有什么不同？他们都有相同的硬件吗？视频驱动程序呢？它们都一样吗？

# cocoa - NSNumberFormatter：plusSign 与 positivePrefix

> ID：521340
> 
> 赞同：2
> 
> 时间：2009-02-06T17:45:36.523
> 
> 标签：cocoa

NSNumberFormatter 类有`plusSign`和`minusSign`属性，但也有`positivePrefix`和`negativePrefix`。

这两者有什么区别？如果我同时指定两者，哪个先出现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T23:15:20.353

plusSign 和 minusSign 用于数学加法和减法运算符。positivePrefix and suffix 和negativePrefix and suffix 用于描述使用什么字符/字符串来显示某个数值是正数还是负数。

为了说明它们为何不同：大多数情况下，当在任何地方显示正数值时，您只会看到数字，没有前缀或后缀。负数值在其前面或后面有一个减号，或者，在某些会计风格中，它们只是用括号括起来。无论哪种方式，我们仍然需要一个 + 和一个 - 来表达数学运算。

# .net - 多个同时保存导致 WCF/NHibernate “行被另一个事务更新”

> ID：521342
> 
> 赞同：3
> 
> 时间：2009-02-06T17:45:41.283
> 
> 标签：.net, wcf, nhibernate

我正在开发一个使用大量数据管理复杂“事件”的大型应用程序。

该应用程序分为一个客户端（主要是 C#，主要是 .NET 2.0），一个基于 WCF 的服务器，用于在 IIS 上运行（这一层的 Web 服务），以及一个基于 NHibernate 和 MS SQL Server 数据库后端的数据后端。

我们遇到了以下情况的错误：

多个用户（本例中为 6 个，在我们的测试中）同时在客户端上保存一个持久对象（例如事件）。（这是通过口头倒计时完成的，所以我们说的是由于反应时间的差异）

当他们在客户端上保存对象时，客户端调用服务器来保存该对象。服务器执行任何所需的业务逻辑，然后通过 NHibernate 提交更改。

在这种情况下（通过服务调用多次保存）一些客户端会返回一个未处理的异常：

“行已被另一个事务更新或删除”

这是一个 NHibernate 例外。

在我的研究中，我发现了这个错误的一些实例，但它始终是连续的。我们的应用程序按顺序运行良好，这只发生在同时保存的情况下。

多个同时发生的 NHibernate 事务应该如何相互保护？

（这将是一个大容量的应用程序，所以需要最少的锁定是好的。我们一般不能锁定所有保存。）

是否有 NHibernate 设置可以做到这一点？我们是否需要事先弄清楚一些服务器代码端锁定？数据库可以使用不同的事务保护设置来处理这个问题吗？

就像大多数线程问题一样，这是一个需要测试的熊，因此是研究/理论方法。这样的架构是什么体验？

编辑：更多信息和理论。

似乎更改直接在表中作为主要实体的值不会导致此问题，而更改通过连接访问的元素会导致此问题。（在这种情况下是一组属性）。

我们似乎适合这种情况的工作理论如下：

同一事件有多个保存。每个人都会获得现有事件的副本（以进行修改）。第一个保存是可以的。然而，后面的那些有更新，例如添加或删除属性（这是一个连接表），并发现需要完成的添加或删除已经完成，并且因为另一个事务编辑了事件而退出。

我们应该如何使这些事件保持同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:56:11.683

我对多线程的单用户应用程序有同样的问题。关键是用 [ThreadSafe] 装饰我的会话变量。奇怪的是，我看过的各种会话管理器似乎都没有这样做，而且他们认为它们是自动线程安全的……根据我的经验，情况并非如此。

[Asp 会话管理器](http://www.cnblogs.com/lijiehua/articles/594144.html)

[多数据库会话](http://www.codeproject.com/KB/aspnet/NHibernateMultipleDBs.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T19:26:01.180

我接受了上述答案，因为它或多或少是我们所走的路线。我想进一步阐述。我们的应用程序打算大量使用，因此完全锁定“更新主要实体”过程是一个坏主意。

我们最终做的是使用 C# 互斥锁，它需要“独特的东西”来锁定，在本例中是事件 ID。这意味着对同一复杂实体的任何操作都将被锁定，并在这个意义上成为“原子”。这解决了我们的问题。我们或多或少地将每个“破坏性”服务操作包装在互斥体中（通过现有的实用程序类）。

# programming-languages - 作为区分大小写的编程语言有什么优势吗？

> ID：521349
> 
> 赞同：0
> 
> 时间：2009-02-06T17:46:52.123
> 
> 标签：programming-languages, case-sensitive

我个人不喜欢区分大小写的编程语言。

（我知道区分大小写的缺点现在由好的 IDE 补充）

我仍然想知道如果编程语言区分大小写，它是否有任何优势。许多流行语言的设计者选择区分大小写是否有任何理由？

编辑：[为什么许多语言区分大小写？](https://stackoverflow.com/questions/503218/why-are-many-languages-case-sensitive)

编辑：（我不敢相信我几年前问过这个问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T17:51:22.130

这是一种偏好。我更喜欢区分大小写，我发现以这种方式阅读代码更容易。例如，变量名称“myVariable”与“MyVariable”、“MYVARIABLE”和“myvariable”具有不同的字形。这使得区分这两个标识符一目了然。当然，您不应该或*很少*创建仅区分大小写的标识符。这更多是关于一致性，而不是增加可能的标识符数量的明显“好处”。有些人认为这是一个缺点。我想不出任何时候区分大小写会给我带来任何问题。但同样，这是一种偏好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T17:50:30.557

区分大小写本质上更快地解析（尽管只是稍微），因为它可以直接比较字符序列，而不必弄清楚哪些字符彼此等价。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T17:49:46.047

它允许类/库的实现者控制在代码中如何使用大小写。大小写也可以用来表达意思。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T17:50:27.747

代码看起来更相似。在 BASIC 时代，这些是等价的：

```
PRINT MYVAR
Print MyVar
print myvar 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T17:50:39.290

通过类型检查，区分大小写可以防止您出现拼写错误和无法识别的变量。我修复了不区分大小写、非类型化语言 (FORTRAN77) 的代码中的错误，其中零 (0) 和大写字母 O 在编辑器中看起来相同。该语言创建了一个新对象，因此输出存在缺陷。使用区分大小写的类型语言，就不会发生这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T17:51:41.130

在编译器或解释器中，不区分大小写的语言将不得不将所有内容设置为大写或小写以测试匹配，或者使用不区分大小写的匹配工具，但这只是编译器的少量额外工作。

加上区分大小写的代码允许某些声明模式，例如

MyClassName myClassName = new MyClassName()

以及其他区分大小写的情况。

# bash - 根据用户输入将文件复制到目录并使用 * 列出文件

> ID：521366
> 
> 赞同：1
> 
> 时间：2009-02-06T17:50:31.040
> 
> 标签：bash, shell

我想创建一个非常简单的 bash 脚本，`my_copy.sh`它读取任意数量的输入文件、一个目标目录，最后询问您是否要复制文件。

示例用法：`./my_copy.sh`

```
 Type in the file names to copy:
 file1 file2 Anna Kurt Arne
 Type in the directory to copy to:
 dir_3
 Are you sure you want to copy the files:
 Anna
 Kurt
 Arne
 to the directory dir_3 (y/n)? 
```

如果目标目录不存在，则应由脚本创建。

* * *

我的下一个问题：

我希望 * 字符执行一个简单的`ls`命令。因此，如果我键入`./my_copy *`，它应该在命令行中列出我目录中的所有文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T22:40:44.800

您可以使用“cp -i”，使其在覆盖之前具有交互性和提示性。您还可以将其作为别名添加到 .bash_profile，因此它始终会提示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T18:02:50.827

除非在调用脚本时 * 被转义或引用，否则 shell 将在脚本获取它之前扩展它。

> ./my_copy '*'

或者

> ./my_copy \*

看起来您正在尝试在“cp”周围添加一个简单的确认包装器。或者你是否试图让它以交互方式提示用户？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T17:57:59.293

你的第二个问题很难。shell 将尝试解释 * 并将其替换为当前目录中的所有项目。shell 给你一个 * 作为参数列表中唯一条目的唯一方法是，如果目录中的所有文件的名称都以点开头。因此，您的示例命令实际上会使用 $0 = my_copy 和 $1 = my_copy 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-12T17:17:04.647

您不能将 * 作为参数，但您可以将其替换为例如字母“e”并执行以下操作：

```
if [ "$1" = "e" ]
then
    ls
else
    return 0
fi 
```

# .net - Linq to SQL 捕获 OnChanged “事件”以进行实体关联更改

> ID：521381
> 
> 赞同：0
> 
> 时间：2009-02-06T17:52:08.150
> 
> 标签：.net, linq-to-sql

假设我有几个 Linq to SQL 类，Person 和 Department。Person 具有与 Department 的实体关联。

我可以在部分类中使用 OnNameChanging 和 OnNameChanged 捕获对 Person.Name 的更改，但设计器生成的代码似乎没有调用 OnDepartmentChanging 或 OnDepartmentChanged。我怎样才能捕捉到这些变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T22:33:47.877

是否可以将属性设为私有（在 dbml 中选择 Code 属性并在“属性”窗口中设置访问属性）并创建一个新的公共属性，您可以对其进行更多控制？该属性可以调用私有属性并引发事件。

我个人已经编写了一个生成器，可以为我生成必要的文件（如 sqlmetal），让我可以完全控制代码。如果您不喜欢生成的 dbml，也许这也是您的一个选择。

顺便说一句，这与我对这个问题的回答几乎完全相同：[你能阻止 LinqDataSource 设置属性吗？](https://stackoverflow.com/questions/522172/can-you-prevent-linqdatasource-from-setting-a-property/522478#522478)

我希望它有所帮助。

# windows - 在Windows中递归删除具有指定名称的文件夹的命令行工具？

> ID：521382
> 
> 赞同：78
> 
> 时间：2009-02-06T17:52:18.353
> 
> 标签：windows, file, utilities, administration

我想删除每个文件夹和子文件夹中的每个“_svn”...

例如

```
C：\
  项目1
   _svn
   图片
     _svn
     横幅
       _svn
     纽扣
       _svn

```

然后我运行类似的东西

```
rm-recurse c:\proyect1 _svn 
```

我应该得到：

```
C：\
  项目1
   图片
     横幅
     纽扣

```

理想的东西是一个小的独立 EXE 或类似的东西。

-- 谢谢格兰特，我一发布问题，就看到了关于 SVN 导出命令的[SVN](http://en.wikipedia.org/wiki/Subversion_%28software%29)文档，但我也想删除 Visual Studio 创建的 _vti_* 文件夹，所以我也会探索`for`解决方案。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-02-06T18:05:03.333

类似于 BlackTigerX 的“for”，我打算建议

`for /d /r . %d in (_svn) do @if exist "%d" rd /s/q "%d"`

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-11-13T07:23:34.043

是时候学习一些[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)了；o)

```
Get-ChildItem -path c:\projet -Include '_svn' -Recurse -force | Remove-Item -force -Recurse 
```

第一部分递归地找到每个 _svn 文件夹。强制用于查找隐藏文件夹。第二部分用于删除这些文件夹及其内容。Remove commandlet 带有一个方便的“whatif”参数，允许预览将要执行的操作。

PowerShell 可用于 Windows XP 和 Windows Vista。默认情况下，它存在于 Windows 7 和 Windows Server 2008 R2 上。

这是一款 MS 产品，它是免费的，而且非常棒！

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2011-07-29T05:44:09.963

对于从 BATCH 文件中包含/调用，请使用（例如删除 Debug 和 Release 文件夹）：

```
for /d /r . %%d in (Debug Release) do @if exist "%%d" echo "%%d" && rd /s/q "%%d" 
```

批处理文件中需要double`%`才能用作转义字符。否则它会报告语法错误。

谢谢。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-06T17:55:04.180

```
for /f "usebackq" %d in (`"dir _svn /ad/b/s"`) do rd /s/q "%d" 
```

[http://ebersys.blogspot.com/2008/07/recursively-delete-svn-folders-easy-way.html](http://ebersys.blogspot.com/2008/07/recursively-delete-svn-folders-easy-way.html)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-06T17:55:39.220

在 Windows 中？如果您使用的是 tortoiseSVN，您可以使用 export 命令导出项目的副本，而不需要 .svn/_svn 文件夹。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-11-13T06:53:58.863

```
import os
import shutil

curdir = os.path.abspath(os.path.dirname(__file__))

def removedir(dirname, name = ".svn"):
    if os.path.isdir(dirname):
        for file in os.listdir(dirname):
            if os.path.isdir(os.path.join(dirname, file)) and file == name:
                thedir = os.path.join(dirname, name)
                shutil.rmtree(thedir)
                print ".",
            else:
                removedir(os.path.join(dirname, file)) 
```

我想你可以试试这个 Python 脚本，如果你安装了 Python，它可以在任何操作系统下运行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-13T16:23:27.713

在这里... 使用 FreeCommander 或 TotalCommander

[http://www.broobles.com/blog/posts/36](http://www.broobles.com/blog/posts/36)

索森达尼

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-10-25T20:21:18.040

[SVN 论坛](http://www.svnforum.org/threads/31535-TortoiseSVN-export-by-command-line)的另一个选项：将 XCopy 与包含要排除的文件/目录列表的文件一起使用（在这种情况下为 .svn 或 _svn）

```
XCopy C:\VersionedFolder C:\UnVersionedFolder /EXCLUDE:C:\No.SVN.txt /E /C /I /F /R /Y 
```

# c# - C# 我应该提出什么样的异常？

> ID：521401
> 
> 赞同：11
> 
> 时间：2009-02-06T17:58:38.260
> 
> 标签：c#

我目前正在尝试查找属性是否已正确设置为应该像这样的布尔值...

```
public void RunBusinessRule(MyCustomType customType)
{
    try
    {
       if (customType.CustomBoolProperty == true)
       {
            DoSomething(); 
       }
       else
       {
            throw new Exception("This is obviously false or possibly null lets throw up an error.");
       }
    }
    catch(Exception)
    {
        throw;
    }
} 
```

现在为我抛出这个错误的处理是我正在使用微软的源分析，它给了我一个错误，指出“CA2201：Microsoft.Usage：Object.RunBusinessRule（MyCustomType）创建了一个'Exception'类型的异常，一个异常类型不够具体，不应由用户代码引发。如果可能抛出此异常实例，请使用不同的异常类型。

Soooo 我应该抛出什么异常，这对于微软来说已经足够具体了......，对于抛出关于我自己的应用程序逻辑处理的错误以及我想要“抛出”的情况。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T18:02:32.590

```
ArgumentException
InvalidOperationException
FormatException 
```

传入的参数并不好。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-06T18:03:05.553

你应该抛出一个异常吗？

具有错误的布尔值并不是一种特殊情况。

**编辑**

我的原始答案有点简洁，所以我会详细说明......

从您的示例中，不清楚实际的对象、属性和方法代表什么。没有这些信息，很难说哪种类型的异常（如果有的话）是合适的。

例如，我认为以下是对异常的完全有效使用（您的真实代码可能看起来像这样，但我们无法从您的示例中看出）：

```
public void UpdateMyCustomType(MyCustomType customType)
{
    if (!customType.IsUpdateable)
        throw new InvalidOperationException("Object is not updateable.");

    // customType is updateable, so let's update it
} 
```

但在一般情况下，在不了解您的域模型的情况下，我会说这样的事情（一个错误的布尔值）并不是真正的例外。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-06T18:04:03.693

创建您自己的异常扩展`Exception`. 例如：`RuleViolationException`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T18:02:43.307

[`ArgumentException`](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)也许？

也可以为[`InvalidOperationException`](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception.aspx).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T18:13:07.967

这里的答案是你不应该抛出任何异常。为什么要抛出异常只是为了在一秒钟内再次捕获它并重新抛出它？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T18:03:48.937

稍微撇开一点，但你可以稍微简化你的代码......

```
public void RunBusinessRule(MyCustomType customType)
{
    if (customType.CustomBoolProperty == false)
    {
        throw new Exception("This is obviously false or possibly null lets throw up an error.");
    }

    DoSomething(); 
} 
```

至于抛出的异常类型，可以考虑`ApplicationException`or `InvalidOperationException`，也可以自己定义异常类型。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T18:04:42.523

我知道一个问题是关于抛出异常，但我认为在这里做一个断言会更合适：

```
// Precondition: customType.CustomBoolProperty == true
System.Diagnostics.Debug.Assert(customType.CustomBoolProperty)
DoSomething(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T18:05:35.890

InvalidArgument 异常很好，但更好的是 ApplicationException。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-26T14:41:20.613

其他答案可以快速解决，但理想情况下，如果您在编译时知道不应该使用某些参数调用某个方法，您可以通过继承您的自定义类型来防止这种情况发生，仅当该自定义 bool 是是的，现在你的方法看起来像。

```
public void RunBusinessRule(MyInheritedType inheritedObject)
{
    //No need for checks, this is always the right type.
    //As a matter of fact, RunBusinessRule might even belong to MyInheritedType.
} 
```

这是[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)中的I。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-28T10:06:28.897

我认为您应该避免代码逻辑异常。

我建议修改您的方法以将方法的结果作为`bool`类型返回，然后您可以决定在调用该方法时向用户显示错误消息的适当方式：

```
public bool RunBusinessRule(MyCustomType customType)
{
  try
    {
       if (customType.CustomBoolProperty == true)
       {
            DoSomething(); 
            return true;
       }

       return false;
    }
    catch(Exception)
    {
        throw;
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T18:04:18.670

通过扩展 System.Exception 并抛出它来制作您自己的自定义异常。如果你愿意，你可以变得更疯狂，拥有一整棵异常类型树。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T18:04:29.200

您可以创建一个`ValidationException`仅用于您的业务逻辑验证的自定义。或者，您可以为每种类型的验证错误创建一个单独的验证异常，尽管这可能会超载。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-06T20:14:31.763

不是你真正要求的，但有很多人已经给出了我同意的答案，但你也应该避免只使用 catch(Exception ex)。

最好先尝试捕获可能的特定异常，如果需要，捕获通用异常。例如：

```
try{
   MyMethod(obj);
}catch (NullReferenceException ne){
   //do something
}
catch(UnauthorizedAccessException uae){
   //do something else
}
catch(System.IO.IOException ioe){
   //do something else
}
catch(Exception){
   //do something else
} 
```

# sql-server-2000 - 您如何模拟频繁的数据库活动以进行实际测试？

> ID：521402
> 
> 赞同：3
> 
> 时间：2009-02-06T17:59:00.850
> 
> 标签：sql-server-2000, asp.net-2.0, ui-testing, test-environments

我正在针对同时有少量记录（大约 5000 条）处于活动状态的数据库构建一个 Web 应用程序。每个活动的工作记录可能会在 4 小时内经历 30 位用户的 50-300 次更改……这就是每分钟数千次更改。

因为我们的测试环境是静态的，所以测试是不现实的，有些问题直到我们打到生产数据库才出现。

我的想法是运行 Profiler，收集 DML 语句，然后在调试应用程序时在测试服务器上重放它们……假设我可以在运行原始文件的相同时间间隔内重放它们。但即使这样也不是一个有效的测试，因为测试人员的更改可能会破坏未来重放的 DML 语句。

有人知道如何模拟实时数据库更改以进行实际测试吗？

谢谢。

BTW-我们的问题不是并发问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:10:31.780

也许这个基于 Selenium 的服务就是你需要的：[browsermob](http://browsermob.com/load-testing)

很少有人推荐它。

是的，这不是广告 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-02T07:59:56.873

或许可以使用类似于 mysqlslap 负载模拟器之类的数据库压力测试工具。[这](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/howdoi/?p=133)是一个解释用例和具体示例的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-13T02:21:56.953

有一些商业软件包可以做到这一点。我为 Quest Software 工作，这是其中一个软件包的制造商，但我将列出三个，因为在我来 Quest 工作之前，我已经与所有这些人一起工作过：

*   [Microsoft Visual Studio 测试版](http://msdn.microsoft.com/en-us/teamsystem/dd408381.aspx)- 它添加了负载测试工具。它允许您在 Visual Studio 中设计测试，例如模拟浏览器访问您的 Web 应用程序。录制最初的宏有点痛苦，但是当你完成后，重播就很容易了。它还具有代理，您可以在多个桌面上部署这些代理以增加负载。例如，我们将它安装在几个开发人员的桌面上，当我们需要在下班后进行负载测试时，我们可以在服务器上投入大量的计算能力。缺点是设置和持续维护有点痛苦。
*   [HP Quality Center](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-127-24%5E1131_4000_100__)（以前是 Mercury Test Director 和其他一些软件）——也有负载测试工具，但它是为测试人员设计的。如果您的测试人员没有 Visual Studio 经验，这是一个更简单的选择。
*   [Quest Benchmark Factory](http://www.quest.com/benchmark-factory/) - 此工具专门针对数据库服务器，而不是 Web 和应用程序服务器。它捕获您的生产服务器上的负载，然后可以在您的开发/测试服务器上重放它，或者它也可以生成合成事务。您可以使用[免费软件版本](http://www.quest.com/benchmark-factory/freeware.aspx)开始使用。

如果您了解并喜欢 Visual Studio，并且想要测试您的 Web 服务器和应用服务器，那么请使用 Visual Studio 测试版。如果您只想专注于数据库，请使用 Benchmark Factory。

# c# - 对象是类，就像枚举是类...？

> ID：521407
> 
> 赞同：5
> 
> 时间：2009-02-06T17:59:57.277
> 
> 标签：c#, java, enums

## **对象是类，就像枚举是类...？**

我正在使用 C#，但我也想要 Java 的答案，如果有的话。

谢谢你，一如既往。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T18:25:58.580

不管我们是在讨论 C# 还是 Java，这句话都不能按照你期望的方式完成，因为它存在以下基本缺陷： enum 和 class 都是*types*，而*object*是一种。

在 C# 中，枚举是一种值类型，它通过为基础类型定义可接受的值和（可选）这些值的组合来限制基础数值类型。给定以下示例：

```
enum Days { Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday }; 
```

我们说**Days**是一个*枚举*，而**Monday**是它的一个*值*。

在 Java 中，枚举是一个使用特殊语法定义的*类，它定义了它的唯一、可区分、可公开访问的实例。*枚举是最终的，即它不能被扩展。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T18:06:04.753

“枚举是值类型”

枚举是强类型常量

在 C# 传统中，它们是强类型的，这意味着即使其成员的基础值相同，一种类型的枚举也可能不会隐式分配给另一种类型的枚举。

枚举是值类型，这意味着它们包含自己的值，不能继承或被继承，并且赋值会将一个枚举的值复制到另一个。

枚举使用和引用小写枚举和大写枚举。两者的关系是 C# 类型 enum 继承了 Base Class Library (BCL) 类型 Enum。使用 C# 类型 enum 来定义新的枚举，并使用 BCL 类型 Enum 来实现静态枚举方法。

来源：[http ://www.csharp-station.com/Tutorials/Lesson17.aspx](http://www.csharp-station.com/Tutorials/Lesson17.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T18:01:18.927

在 Java 中，Enum 现在是一种类，因此您可以拥有一个枚举对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T18:36:09.510

对象要分类，就像枚举要设置一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T21:39:57.643

对象是类的一个实例。enum 是关键字的示例。

# c# - 为什么这个没有特殊字符的正则表达式匹配更长的字符串？

> ID：521408
> 
> 赞同：2
> 
> 时间：2009-02-06T18:00:17.743
> 
> 标签：c#, regex

我正在使用此方法尝试查找匹配项，例如：

```
Regex.Match("A2-TS-OIL", "TS-OIL", RegexOptions.IgnoreCase).Success; 
```

我得到了一个真实的结果。我很困惑。我认为这应该返回 false，因为模式中没有特殊字符。如果我使用`".+TS-OIL"`，则应返回 true （`.`对于任何且`+`超过 1）。我该怎么做才能得到我需要的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T18:06:29.760

正则表达式匹配不必从输入的开头开始。你可能想要：

```
^TS-OIL 
```

如果您只想在开始时匹配。或者：

```
^TS-OIL$ 
```

以防止它与 TS-OIL-123 匹配。

`^`匹配输入的开头，$ 匹配结尾。

我相信有些地方会自动添加`^`and `$`（例如 Web 验证控件），但它们是例外。

顺便说一句，你可以使用：

```
Regex.IsMatch(...) 
```

在这种情况下可以节省一些击键。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T18:07:29.990

如果您只想在测试字符串以您的正则表达式开头时进行匹配，那么您需要这样指示：

```
Regex.Match("A2-TS-OIL", "^TS-OIL", RegexOptions.IgnoreCase).Success; 
```

表示匹配必须从字符串的`^`开头开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T18:07:09.413

表达式字符串的开头和结尾有一个隐含的 .*。您需要使用 ^ 和 $ 代表字符串的开始和结束来覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T18:10:07.350

TS-OIL 是 A2-TS-OIL 中的子字符串。所以，它会产生一个匹配。你有最简单的匹配可能 - 文字子字符串。如果您希望 TS-OIL 不匹配，您也可以尝试 (?!^A2-)(TS-OIL)，假设您不希望它以 A2- 开头，但可能需要其他的东西。

# php - 使用 CURL (php) 读取 SSL 页面

> ID：521418
> 
> 赞同：35
> 
> 时间：2009-02-06T18:03:03.417
> 
> 标签：php, ssl, curl

我正在尝试使用 php 和 curl 库下载安全（使用 https）网页的内容。

但是，读取失败，我收到错误 60：“SSL 证书问题，验证 CA 证书是否正常。”

还有“详细信息：SSL3_GET_SERVER_CERTIFICATE：证书验证失败”

所以......非常自我解释的错误消息。

我的问题是：如何发送 SSL 证书（正确的？）并获取此页面以验证它并让我进入？

另外，如果您想知道，这是我的选项数组：

```
 $options = array(
        CURLOPT_RETURNTRANSFER => true,     // return web page
        CURLOPT_HEADER         => false,    // don't return headers
        CURLOPT_FOLLOWLOCATION => true,     // follow redirects
        CURLOPT_ENCODING       => "",       // handle all encodings
        CURLOPT_USERAGENT      => "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:x.x.x) Gecko/20041107 Firefox/x.x", // who am i
        CURLOPT_AUTOREFERER    => true,     // set referer on redirect
        CURLOPT_CONNECTTIMEOUT => 120,      // timeout on connect
        CURLOPT_TIMEOUT        => 120,      // timeout on response
        CURLOPT_MAXREDIRS      => 10,       // stop after 10 redirects
        CURLOPT_SSL_VERIFYHOST => 1,
    ); 
```

任何建议都会很棒，安德鲁

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-06T18:09:23.090

听起来您可能误解了该错误。在我看来，您连接的网站是自签名的或其他一些常见问题。就像通常的浏览器警告一样，您最简单的解决方法是禁用检查。

您需要设置`CURLOPT_SSL_VERIFYPEER`和`CURLOPT_SSL_VERIFYHOST`to `FALSE`。这应该禁用两个主要检查。它们可能都不是必需的，但这至少应该让你继续前进。

**需要明确的是，这会禁用旨在保护您的功能。仅当您通过其他方式验证了证书和服务器时才执行此操作。**

有关 PHP 站点的更多信息：[curl_setopt()](http://ca.php.net/manual/en/function.curl-setopt.php)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-11-26T12:22:47.687

如果您想使用 SSL 对等验证（关闭它并不总是好主意），您可以在 Windows 上为所有应用程序全局使用下一个解决方案：

1.  从这里下载带有根证书的文件：http: [//curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)
2.  添加到 php.ini：

`curl.cainfo=C:/path/to/cacert.pem`

这很神奇，CURL 现在可以验证证书。

*（据我所知，Linux 上没有这样的问题，至少在 Ubuntu 上是这样）*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-18T16:39:31.277

即使在遵循关于 SO. 的建议之后。您可能仍然会遇到以下错误的问题：

```
error:14077438:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert internal error 
```

问题出在 SSL 版本上。将以下内容用于版本 3

```
curl_setopt($ch, CURLOPT_SSLVERSION,3) 
```

我假设您也启用了对等和主机的验证，并指向一个实际的证书文件。例如。

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true); 
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2); 
curl_setopt($ch, CURLOPT_CAINFO, getcwd() . "/cacert.pem"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-10T11:51:24.073

这是 openssl 和 VeriSign 的“问题”。

我遇到了类似的问题，我的 openssl 缺少 VeriSign 用于签署服务器证书的中间 ssl 证书。

[https://knowledge.verisign.com/support/ssl-certificates-support/index?page=content&id=AR657](https://knowledge.verisign.com/support/ssl-certificates-support/index?page=content&id=AR657)

我必须将这些中间证书从 VeriSign 主页或 Firefox cert-database-export 导入到我的本地 ca-certificates 列表中，在此步骤之后，我能够使用 wget/curl 来使用受保护的连接而不会出现任何错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T14:52:49.950

如果它是开发人员机器 - 您也可以在您的系统中添加此证书。像这样的东西 - [https://www.globalsign.com/support/intermediate/intermediate_windows.php](https://www.globalsign.com/support/intermediate/intermediate_windows.php) 它适用于 WinXP，但它也适用于其他版本的 Windows。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-06T18:11:01.670

您没有发送 SSL 证书。SSL 证书似乎存在问题，因为它安装在您正在联系的主机上。使用选项 -k 或 --insecure 来解决投诉。

啊。见瑞安格雷厄姆的回答

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-04-28T11:38:26.133

这显然是在 openssl 错误上。通过限制可用密码列表，可以在 /etc/tomcat7/server.xml 中配置 Tomcat 以解决此问题：

```
<Connector protocol="HTTP/1.1" SSLEnabled="true" ... ciphers="SSL_RSA_WITH_RC4_128_SHA"/> 
```

# java - 有没有很好的 Java 库可以帮助构建交互式 shell 风格的应用程序？

> ID：521422
> 
> 赞同：7
> 
> 时间：2009-02-06T18:03:28.453
> 
> 标签：java

我需要用 Java 编写一个简单的 shell 样式的应用程序。使用一个负责解析命令并处理标志和可选/强制参数之类的库会很好......

具有内置 TAB 完成功能的东西会特别棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T18:10:33.683

您可以使用[JLine](http://jline.sourceforge.net/)进行编辑，使用[Apache Commons CLI](http://commons.apache.org/cli/usage.html)进行命令行解析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T18:05:13.833

[豆壳](http://www.beanshell.org/)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T19:23:46.357

我更喜欢[JewelCLI](http://jewelcli.sourceforge.net/)或[args4j](https://args4j.dev.java.net/)而不是 Apache Commons CLI。

[这里](http://javathink.blogspot.com/2008/04/why-does-parsing-arguments-in-java-suck.html)有几个 java CLI 选项解析器的一个很好的，如果有点煽动性的综述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-15T10:29:13.027

看看 JBoss Forge (https://docs.jboss.org/author/display/FORGE/Home)。

它是一个基于 Java CDI 插件的构建外壳，并且可以通过自定义插件进行扩展。我的情况是，我编写了一个基于 Forge 的 GWT 插件（https://github.com/xandrox/forge-gwtplugin）。

```
public class ExamplePlugin implements Plugin {

    @Inject private ShellPrompt prompt;

    @Command("run")
    public void run(PipeOut out, @Option(name="value") final String arg){
        out.println("Executed command with value: " + arg);
    }
} 
```

# css - 有人有一个例子说明 clear 属性在 css 中是如何工作的吗？

> ID：521424
> 
> 赞同：2
> 
> 时间：2009-02-06T18:03:57.470
> 
> 标签：css

由于我不是设计师，但被赋予了职责，我很好奇 clear 属性是如何工作的。如果有人有一个例子会有所帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T18:09:06.227

要理解清楚，就必须理解浮动。[Floatutorial](http://css.maxdesign.com.au/floatutorial/)是学习两者的绝佳资源，其中包括[有关 clear 的这一部分](http://css.maxdesign.com.au/floatutorial/clear.htm)。总结一下：

*   **clear: left** : 元素被移动到任何较早的左浮动框的底部外边缘下方 -[示例](http://css.maxdesign.com.au/floatutorial/introduction20.htm)

*   **clear: right** : 元素被移动到任何早期右浮动框的底部外边缘下方 -[示例](http://css.maxdesign.com.au/floatutorial/introduction21.htm)

*   **clear: both** : 元素移动到早期元素的所有浮动框下方 -[示例](http://css.maxdesign.com.au/floatutorial/introduction22.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:08:17.430

假设你有三个元素。第一个浮动到左边，包含相当多的文本。第二个和第三个相对较短（两者的总长度比第一个短）。在正常情况下，它们都将沿浮动显示。但是，如果您在第三个上设置 clear:left ，它将显示*在*第一个之后，而不是在它旁边。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T18:08:23.513

这与您使用图像时类似，`align="left"`并且您希望页面后面的某些内容位于图像下方，而不是旁边。你会用`<br clear=all />`

`DIV`在使用`float:`属性时，这基本上对 s 做同样的事情。它强制布局结束浮动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T18:09:40.017

我希望我有一个很好的例子……尽管我可以尝试用简单的术语来解释它。

`clear: left;`基本上说“将此元素放在它上面的所有元素之后，并带有`float: left;`属性”

`clear: right;`是一样的，但在`float: right;`元素之后。

`clear: both;`是同一件事，但在两者`float: left;`和`float: right;`元素之后。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T18:11:15.973

有时，当您将诸如“div”之类的元素放在另一个[浮动元素下（使用“float”属性）时，您希望禁止该浮动元素在已](http://webdesign.about.com/od/advancedcss/a/aa010107.htm)[清除元素](http://www.w3schools.com/Css/pr_class_clear.asp)的一侧或另一侧这样做。

```
<div style="float:right;">
 // some text
</div>

<div style="clear:both;">
 // some text
</div> 
```

当然你最好把css放到一个单独的文件中。如上所述，[本教程](http://css.maxdesign.com.au/floatutorial/)很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T18:13:39.120

clear 属性用于在使用 float 属性时控制 HTML 页面中的元素流。可以指定清除左侧、右侧、两者或不清除。

*   none - 浮动元素*可以* 放置在元素的两侧
*   left - 浮动元素*不能*放在元素的左侧
*   right - 浮动元素*不能*放在元素的右侧
*   both - 浮动元素*不能*放在元素的左右两侧

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T18:14:14.843

[clearfix](http://www.webtoolkit.info/css-clearfix.html)是一个很好的工具，可以帮助您不必处理它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T18:27:39.077

这就是它的工作方式......当在页面上放置元素时，浏览器会将元素一个在另一个之上，垂直，自上而下。现在假设您是否希望元素一个接一个地排列，水平，从左到右（不堆叠）；你漂浮他们。但是，如果您想浮动元素并将一个项目保留在自己的行上，堆叠在第一组和第二组之间，请使用 .clear 属性。下面的每个数字代表一个 html 标签元素（如 div 或 img）

正常垂直元素堆叠；nofloat 并不清楚...

```
1
2
3
4
5 
```

水平元素布局；飘浮不定

```
1 2 3 4 5 
```

横向布局，先竖一叠，再继续横向布局；float 已放置在第三个元素上

```
1 2 (float, no clear)
 3  (float, clear)
4 5 (florat, no clear) 
```

快乐的漂浮...

# eclipse - 如何在 Eclipse 中终止已调试的进程后改回透视图？

> ID：521442
> 
> 赞同：66
> 
> 时间：2009-02-06T18:06:10.447
> 
> 标签：eclipse

默认情况下，当您遇到断点时，Eclipse 会自动切换到 Debug 透视图。

但是，让我很恼火的是，在终止进程时它不会自动切换回之前的视角（比如 Java）。

它只是停留在调试视角，即使没有任何东西可以调试，因为没有任何东西在运行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-07T02:06:35.390

为了完成标记的回答，该选项告诉 Eclipse 在程序暂停时何时切换到关联的透视图——这意味着当断点被命中时，它将切换到调试透视图。

**完成调试后切换回另一个视角必须是：**

*   **手动（鼠标点击）**
*   **手册（“切换视角”快捷方式`CTRL` `F8`）**
*   **自动**：[调试透视自动](https://marketplace.eclipse.org/content/debug-perspective-auto-closer)关闭器，它补充[了错误 46336](https://bugs.eclipse.org/bugs/show_bug.cgi?id=46336)。（最初由[zim](https://stackoverflow.com/users/11067386/zim)报道）

> ## 调试透视自动关闭器
> 
> 调试结束时自动打开先前的透视图。
> 
> 行为：（可配置`Preferences -> Debug Perspective Auto Closer`：）
> 
> 1.  [默认] 当所有调试启动都终止时，在第一次启动时更改为激活的透视图
> 2.  当任何调试启动终止时，在该启动上更改为激活的透视图

![Java 视角](https://i.stack.imgur.com/CZWnn.jpg)

如果你想避免它首先切换到调试，你可以选择“从不”作为选项（当时在 Eclipse 3.2 中引入）。

（您可以在 中找到给定的`Preferences`页面`Run/Debug > Perspective`）

![替代文字](https://i.stack.imgur.com/pZLhC.png)

如果您想在被调试程序正常终止的情况下切换回来（而不是当*您*想自己停止调试时），您可能希望 Eclipse 确定您的程序正常终止并在那时切换到“默认”透视图。 ..

但是，没有“默认”透视图的概念，那么 Eclipse 怎么知道要切换到哪一个呢？（“Preferences/Perspectives/Make default”仅适用于“Open Perspective”对话框，但这可能与调试后您实际想要切换回的视角不同）

![开放视角](https://i.stack.imgur.com/l6mCj.gif)

此外，Eclipse 应该关闭 Debug 透视图还是只是更改为不同的透视图？
如果有多个程序正在运行怎么办——当一个程序终止时，您可能仍然对调试另一个程序感兴趣，或者可能不感兴趣。

关键是，关于*何时*改变视角（以及改变视角*）*的决定对于机器来说是不合理的——它需要一个人知道他接下来想做什么。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-02-24T15:01:45.590

`Ctrl + F8`，更改视图的默认快捷方式，减少了一点痛苦。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-10-16T21:21:20.567

我为此提交了一个错误：

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=327983](https://bugs.eclipse.org/bugs/show_bug.cgi?id=327983)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-06-21T14:28:33.653

我认为 eclipse 不可能自动切换回来，但您可以通过单击窗口右上角的按钮来完成

[![在此处输入图像描述](https://i.stack.imgur.com/wcchU.png)](https://i.stack.imgur.com/wcchU.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T18:44:53.083

你需要编写eclipse插件

[在这里](http://dev.eclipse.org/newslists/news.eclipse.platform/msg32299.html)我找到了如何在插件切换透视图中的示例

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-28T12:58:01.543

截至 2015 年，Eclipse 没有解决这个非常基本的 UI 问题：分配了[官方错误报告](https://bugs.eclipse.org/bugs/show_bug.cgi?id=46336)（但未修复）。

幸运的是，[Sven Ramuschkat 和 Dirk Eismann](http://www.richinternet.de/blog/index9d72.html?entry=04B294D2-0413-3D17-6BA9F4FDF805B401)为此编写了一个插件：[用于 Eclipse / Flash Builder 的 Perspective Switcher 插件](http://www.richinternet.de/blog/indexa36f.html?entry=1758AACF-910C-DE52-368E1421BEFDA19B)

> 现在，一旦 Debug 会话终止，插件就会自动从 Debug 透视图切换回之前的非 Debug 透视图

它适用于 Eclipse Luna（及更高版本）

## 安装

下载[zip 文件](http://www.richinternet.de/blog/download/de.richinternet.plugins.perspectiveswitcher_0.1.1.zip)，解压缩并将 jar 文件复制到您的`eclipse/plugins`文件夹中。

完成后，您将看到一个新`Preference`窗格。

![首选项](https://i.stack.imgur.com/gEoPK.png)

如果您在调试会话结束时打开了一个或文件，则一切都配置为 Eclipse 切换回`Java`透视图。`java``properties`

# xml - 你应该如何构建你的 xml 文件？

> ID：521454
> 
> 赞同：9
> 
> 时间：2009-02-06T18:08:20.987
> 
> 标签：xml

在创建新的 xml 文件时，如何正确或以最佳方式构建文件。通过结构，在这种情况下可能不是最好的词，我的意思是如何在使某物成为元素或元素的属性之间进行选择。例如，如果我创建一个包含 Persons 列表的 Person.xml 文件，最好执行以下操作：

```
<Person>
    <FirstName>John</FirstName>
    <LastName>Doe</LastName>
    <Age>23</Age>
</Person> 
```

还是做这样的事情更好，或者它甚至重要吗？

```
<Person FirstName="John" LastName="Doe" Age="23"></Person> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T18:15:03.533

真的没关系，但我决定的方式是：如果某物可以单独被认为是一个实体（在这个例子中，Person，我将它设为一个元素。如果它是修改实体的东西（或实体的属性） )，我把它作为一个属性。

例子：

```
<Person FirstName="John" LastName="Doe" Age="23">
    <Clothing wet="No">
        <Shirt colour="Red" />
    </Clothing>
</Person> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T18:14:19.867

XML 文件应该（不是为了发动一场圣战）的结构如下：

如果是数据，或者可以改变的东西，那么它应该是这样的：

```
<Person>
  <FirstName>John</FirstName>
  <LastName>Smith</LastName>
  <Age>23</Age>
</Person> 
```

如果它是事物的属性，`Person`那么它应该是这样的：

```
<Person Type="Human">
  <FirstName>John</FirstName>
  <LastName>Smith</LastName>
  <Age>23</Age>
</Person> 
```

这种做法有多种原因，其中最重要的一点是，只要您更改检索人员数据的方法，就可以轻松地修复 XSLT 转换。

这才是真正重要的部分：属性定义了有关数据的信息（人员类型），而数据就是用来填补这些漏洞的东西。如果您决定如何更改填充这些漏洞的方式，那么当您稍后想要转换 XML 时，如果您将它们设为“属性”而不是“数据”，这将变得更加困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T18:13:53.723

这几乎是一个主观的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T18:15:51.190

这是一篇关于 XML 设计原则的[非常好的文章：](http://www.ibm.com/developerworks/xml/library/x-eleatt.html)

*   [XML 设计原则：何时使用元素与属性](http://www.ibm.com/developerworks/xml/library/x-eleatt.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T18:15:21.457

在我看来，这类似于雪佛兰 vs 福特，或者 Windows vs MacOS。在所有情况下都没有明确的赢家，仅仅一个问题可能会与合适的参与者产生高度不稳定的“讨论”。;)

简短的回答是，根据情况，两者都可能是合适的。有时，决定因素甚至是您选择哪个库来读取或更新 XML 中的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T18:15:52.470

首先是冗长的做事方式：一切都是元素。这是人们这样做的一种常见方式，仅仅是因为它很容易查看和解析。

然而，属性的引入正是出于这个原因：它们是关于元素的一些信息。所以，你的第二个例子是完全可以接受的。事实上，你甚至可以缩短它：

```
<Person FirstName="John" LastName="Doe" Age="23" /> 
```

我可能会做后者。

唯一不希望出现这种情况的情况是，如果您需要在内部包含更多 xml 数据或长格式部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T18:17:03.683

通常，您希望元素代表您正在建模的“真实”信息，并为“元”信息保留属性 - 限定内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-07T08:48:09.667

不管个人喜好如何，这里是基本问题：

当排序不重要时，使用属性将值映射到唯一名称。否则，使用元素。

*   值：数字、字符串、日期等，但不是多属性对象。
*   唯一名称：元素上的每个属性名称必须是唯一的。如果一个元素表示的事物可以有多个 Foo 与之关联，则 Foo 不应该是一个属性。
*   排序不重要：应用程序不能依赖于以特定顺序呈现给进程的值。

一个例子：如果你想在（比如）ADO.NET 和 XML 之间来回传输数据，你应该将列值存储在属性还是元素中？（暂时不要介意 ADO.NET 会为您执行此操作。）好吧，列名唯一地映射到值，并且列值是易于序列化的数据类型。那么肯定，为什么不这样做呢？

```
<Person FirstName="John" MiddleName="Q." LastName="Smith"/> 
```

但实际上这是一种破坏信息的转变。列出现在 ADO.NET 记录中的顺序很重要。如果转换之前第 2 列中有内容，则之后应该在第 2 列中。将它们转换为属性将丢失此信息。（例如，我知道一种 DOM 实现，它按名称的字母顺序检索属性。）

这就是为什么 ADO.NET 表示这样的行，虽然它很冗长：

```
<Person>
   <FirstName>John</FirstName>
   <MiddleName>Q.</MiddleName>
   <LastName>Smith</LastName>
</Person> 
```

至于元素用于信息，属性用于元信息的常识：这通常是非常好的建议。也常常只是迷信将你带入坏境。

一方面，元信息可能需要包含与同名相关的多个值。比如说，你可能想用一个将使用它的页面列表来标记一个元素：

```
<Person Pages="B1,B2,B3,B4">
    <FirstName>John... 
```

曾经尝试过编写解析逗号分隔列表的 XSLT 模板吗？通过这样做你会学到很多东西，但这可能不是你想知道的。

另一方面，不知道自己要面对什么的 XML 设计人员让这个建议引导他们将真正应该在元素标记名称中的属性放入属性中。例如：

```
<Person Type="Employee">
    <SSN>123-45-6789</SSN>
    <Extension>123</Extension>
</Person>
<Person Type="Customer">
    <PhoneNumber>123-456-7890</PhoneNumber>
    <BillingAddress>... 
```

等等。猜猜当您尝试编写一个`Person`基于`Type`属性对元素强制执行不同规则的模式时会发生什么？失败。模式绑定到元素名称。所有`Person`元素必须具有相同的架构。在这种情况下，元素应该命名为`Employee`and `Customer`。

# python - 为什么 True/False 在 Python 中大写？

> ID：521476
> 
> 赞同：82
> 
> 时间：2009-02-06T18:13:04.893
> 
> 标签：python, camelcasing

所有成员都是骆驼案，对吧？为什么是真/假而不是真/假，哪个更轻松？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-02-06T18:20:10.277

来自[Pep 285](http://www.python.org/dev/peps/pep-0285/)：

> 常量应该被称为“真”和“假”（类似于无）还是“真”和“假”（如在 C++、Java 和 C99 中）？
> 
> => 真假。
> 
> 大多数评论者都同意 Python 内部的一致性比与其他语言的一致性更重要。

正如安德鲁指出的那样，这可能是因为[所有（大多数）？内置常量大写](http://docs.python.org/library/constants.html)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-06T18:21:40.460

所有 python 的[内置常量](http://docs.python.org/library/constants.html)都大写或 [大写] CamelCase：

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T18:20:14.100

这是一个[可能的解释](http://mail.python.org/pipermail/python-list/2007-May/440165.html)：

> > 我看到命名约定是这样的，类通常被命名为 CamelCase。那么为什么内置类型都命名为小写（如 list、dict、set、bool 等）？
> 
> 因为它们中的大多数最初是类型和工厂函数，而不是
> 类——并且命名约定并不是进行向后不兼容更改的有力理由。一个不同的例子：新的内置类型`set`基于（虽然不完全等于）来自 sets 模块的 Set 类

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-10-23T00:23:50.693

在 python 中，只有 3 个关键字 True 、False 和 None 以大写字母开头。我认为这是为了将这三个关键字与其他关键字区分开来。这 3 个关键字可以用作文字或值，而其他关键字则不能。例如

a=True 是正确的，但 a=for 是错误的

# iphone - 将PNG复制到更大的空白/代码生成纹理的最佳方法？(OpenGL ES 1.1/iPhone)

> ID：521483
> 
> 赞同：1
> 
> 时间：2009-02-06T18:14:45.500
> 
> 标签：iphone, opengl-es, textures

我有一个 320x480 PNG，我想在 iPhone 上进行纹理贴图/操作，但这些尺寸显然不是 2 的幂。我已经在 512x512 PNG 上测试了我的纹理贴图操作算法，它是黑色背景，叠加了 320x480 图像它以原点（左下角 (0,0)）为中心，其中 320x480 区域在 iPhone 屏幕上正确定向/居中/缩放。

我现在想做的是进展到可以拍摄 320x480 源图像并将它们应用到代码中生成的空白/黑色背景 512x512 纹理的程度，以便将两者组合为一个纹理，以便我可以应用顶点和我在 512x512 测试中使用的纹理坐标。这最终将用于相机捕获和相机胶卷来源的图像等。

有什么想法吗？（必须适用于 OpenGL ES 1.1，不使用 GL util 工具包等）。

谢谢，阿里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T19:14:02.073

我发现一种可行的方法是将两个图像简单地绘制到当前上下文中，然后提取生成的组合图像。还有另一种更适合OpenGL的方法可能更有效吗？

```
// CGImageRef for background image
// CGImageRef for foreground image

// CGSize for current context

// Define CGContextRef for current context

// UIGraphicsBeginImageContext using CGSize

// Get value for current context with UIGraphicsGetCurrentContext()

// Define 2 rectangles, one for the background and one for the foreground images

// CGContextDrawImage(currentContext, backgroundRect, backgroundImage);
// CGContextDrawImage(currentContext, foregroundRect, foregroundImage);

// UIImage *finalImage = UIGraphicsGetImageFromCurrentImageContext();

// spriteImage = finalImage.CGImage();

// UIGraphicsEndImageContext(); 
```

At this point you can proceed to use spriteImage as the image source for the texture and it will be a combination of a blank 512x512 PNG with a 320x480 PNG for example.

I'll replace the 512x512 blank PNG with an image generated in code but this does work.

# java - 如何通过 Java 代码加载第三方库（如 X11 库）？

> ID：521487
> 
> 赞同：0
> 
> 时间：2009-02-06T18:15:07.510
> 
> 标签：java

每当 JVM 启动时，即运行 java 命令时；它在 /java/jre/lib 文件夹中查找其他库。这些库与第三方库（如 X11 库）一起由系统的动态加载器（如 HP Unix 中的 dld.so）加载到内存中。

那么是否可以从java中的代码加载第三方库？如果是，可能有什么副作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T18:26:29.687

您正在寻找的是 Java 本机接口 ( [JNI](http://java.sun.com/javase/6/docs/technotes/guides/jni/index.html) )。使用外部本机库将使您的代码的可移植性降低。这将使您的代码不太稳定，因为没有任何 Java 语言保证会成立。可能存在安全管理器影响，因为您的应用程序需要加载库的权限。以我的经验，编写好的 JNI 代码有很多困难；特别是释放和调试。

[使用SWIG](http://www.swig.org/)可能会自动生成必要的 JNI 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:36:15.657

本机库加载了`System/Runtime.loadLibrary`. 然后，您将需要一些代码在库本地调用和 JNI（Java 本地接口）之间进行转换。然后，您将需要一些 Java 代码，其中定义了用于调用翻译代码的本机方法。

# oracle - 如何测试列是否等于 Oracle 中的 empty_clob()？

> ID：521490
> 
> 赞同：20
> 
> 时间：2009-02-06T18:15:50.333
> 
> 标签：oracle, clob

天真的`FOO = empty_clob()`抱怨不兼容的类型。我尝试了谷歌搜索，但（再一次）在 Oracle 的帮助下几乎没有成功。谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-06T18:43:29.917

您是否只想检查没有任何长度的 CLOB？虽然不完全是你的要求，但它基本上是一样的？

```
select *
  from bar
 where dbms_lob.getlength(foo) = 0; 
```

这是完整的测试：

```
SQL> create table bar (foo clob);

Table created.

SQL> insert into bar values (empty_clob());

1 row created.

SQL> select *
  2    from bar
  3  where dbms_lob.getlength(foo) = 0;

FOO
-------------------------------------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-06T20:37:58.127

如果您尝试在 PL/SQL 中进行比较，您可以像 Igor 的解决方案一样测试相等性

```
SQL> ed
Wrote file afiedt.buf

  1  DECLARE
  2     dummy  clob;
  3  BEGIN
  4       dummy := empty_clob();
  5        IF dummy = empty_clob() THEN
  6           dbms_output.put_line( 'Dummy is empty' );
  7        ELSE
  8           dbms_output.put_line( 'Dummy is not empty' );
  9        END IF;
 10* END;
SQL> /
Dummy is empty

PL/SQL procedure successfully completed. 
```

如果您尝试在 SQL 中执行此操作，那么您需要使用 DBMS_LOB.COMPARE 函数。表中的 LOB 列实际上是 LOB 定位器（即指针），所以您真正关心的是 LOB 指向的值与 EMPTY_CLOB() 函数返回的 LOB 定位器所指向的值相当。

```
SQL> desc bar
 Name                                      Null?    Type
 ----------------------------------------- -------- ------------------------

 FOO                                                CLOB

SQL> insert into bar values ('123');

1 row created.

SQL> insert into bar values( empty_clob() );

1 row created.

SQL> insert into bar values( empty_clob() );

1 row created.

SQL> ed
Wrote file afiedt.buf

  1  select count(*)
  2    from bar
  3*  where dbms_lob.compare( foo, empty_clob() ) = 0
SQL> /

  COUNT(*)
----------
         2

SQL> ed
Wrote file afiedt.buf

  1  select count(*)
  2    from bar
  3*  where dbms_lob.compare( foo, empty_clob() ) != 0
SQL> /

  COUNT(*)
----------
         1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T18:31:50.253

像这样的东西应该适用于初始化：

```
DECLARE
   dummy  clob;
   dummy2 clob;
BEGIN
     dummy := empty_clob();
      IF dummy = empty_clob() THEN
         dummy2 := dummy;
      END IF;
END; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-19T14:00:07.523

在 SQLplus 中测试空 clob 的一种简单方法是在执行测试之前将所有 CLOBS 转换为 varchar2（使用 TO_CHAR 函数）：

```
SELECT *
  FROM table1
  WHERE TO_CHAR(table1.column1) IS NULL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-17T06:56:31.547

```
DECLARE
    dummy    CLOB := 'fxsgf';
    dummy1   CLOB;
BEGIN
    IF dummy1 = EMPTY_CLOB ()
    THEN
        DBMS_OUTPUT.put_line ('Dummy1 is empty');
    ELSE
        DBMS_OUTPUT.put_line ('Dummy1 is not empty');
    END IF;

    IF dummy = EMPTY_CLOB ()
    THEN
        DBMS_OUTPUT.put_line ('Dummy is empty');
    ELSE
        DBMS_OUTPUT.put_line ('Dummy is not empty');
    END IF;
END; 
```

# c++ - 在二维数组中创建线性渐变

> ID：521493
> 
> 赞同：5
> 
> 时间：2009-02-06T18:15:57.557
> 
> 标签：c++, algorithm, graphics

我有一个类似于 2D 位图的数组，比如说 500*500 值。我正在尝试在数组上创建线性渐变，因此生成的位图看起来像这样（灰度）：（ [来源：][[showandtell-graphics.com](http://showandtell-graphics.com/images/gradient/gradient_12.jpg)][）][![示例渐变](https://i.stack.imgur.com/Zdn9Q.jpg)](https://i.stack.imgur.com/Zdn9Q.jpg)

输入将是要填充的数组、两个点（如 Photoshop/GIMP 中渐变工具的起点和终点）以及将使用的值范围。

我目前最好的结果是：

[替代文字 http://img222.imageshack.us/img222/1733/gradientfe3.png](http://img222.imageshack.us/img222/1733/gradientfe3.png)

...这与我想要实现的目标相去甚远。它看起来更像是径向渐变。

创建这种渐变的最简单方法是什么？我将在 C++ 中实现它，但我想要一些通用算法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T18:26:42.557

这确实是一个数学问题，因此它是否真的“属于” Stack Overflow 可能存在争议，但无论如何：您需要将图像中每个点的坐标投影到渐变轴上并使用该坐标来确定颜色。

在数学上，我的意思是：

1.  假设您的起点是 (x1, y1)，终点是 (x2, y2)
2.  计算`A = (x2 - x1)`和`B = (y2 - y1)`
3.  计算`C1 = A * x1 + B * y1`起点和`C2 = A * x2 + B * y2`终点（`C2`应该大于`C1`）
4.  对于图像中的每个点，计算`C = A * x + B * y`
5.  如果`C <= C1`，使用起始颜色；如果`C >= C2`，使用结束颜色；否则，使用加权平均值：

    `(start_color * (C2 - C) + end_color * (C - C1))/(C2 - C1)`

我做了一些快速测试来检查这是否基本有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T18:41:48.253

在您的示例图像中，看起来您有一个径向渐变。这是我对您需要的步骤的即兴数学解释。抱歉，其他答案在实施方面更好。

1.  定义一个线性函数（如 y = x + 1），其域（即 x）从您想要开始的颜色到您想要结束的颜色。您可以根据 Ox0 到 OxFFFFFF（对于 24 位颜色）的范围来考虑这一点。如果你想处理亮度之类的事情，你必须对范围（即y值）做一些技巧。
2.  接下来，您需要在您拥有的矩阵上映射一个向量，因为这定义了颜色将更改的方向。此外，线性函数定义的颜色值将分配在向量的每个点上。向量的起点和终点还定义了 1 中域的最小值和最大值。您可以将向量视为渐变的一条线。
3.  对于矩阵中的每个单元格，可以从向量中为颜色分配一个值，其中单元格的垂线与向量相交。请参见下图，其中 c 是单元格的位置， 。是交点。如果你假装那个颜色在。是红色，那么这就是您将分配给单元格的内容。

```
             |
             C
             |
             |
    向量：____.______________
             |
             |

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T12:44:21.797

我只会发布我的解决方案。

```
int ColourAt( int x, int y )
{
  float imageX = (float)x / (float)BUFFER_WIDTH;
  float imageY = (float)y / (float)BUFFER_WIDTH;

  float xS = xStart / (float)BUFFER_WIDTH;
  float yS = yStart / (float)BUFFER_WIDTH;
  float xE = xEnd / (float)BUFFER_WIDTH;
  float yE = yEnd / (float)BUFFER_WIDTH;
  float xD = xE - xS;
  float yD = yE - yS;

  float mod = 1.0f / ( xD * xD + yD * yD );

  float gradPos = ( ( imageX - xS ) * xD + ( imageY - yS ) * yD ) * mod;

  float mag = gradPos > 0 ? gradPos < 1.0f ? gradPos : 1.0f : 0.0f;

  int colour = (int)( 255 * mag );
  colour |= ( colour << 16 ) + ( colour << 8 );
  return colour;
} 
```

为了加快速度，缓存派生的“方向”值（提示：预乘以 mag）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-22T22:31:34.687

这个问题有两个部分。

1.  给定两种颜色 A 和 B 以及某个百分比 p，确定从 A 到 B 的“百分比”是什么颜色。

2.  给定平面上的一个点，找到该点在给定直线上的正交投影。

第 2 部分中的给定线是您的渐变线。给定任意点 P，将其投影到渐变线上。假设它的投影是 R。然后计算出 R 距离渐变段的起点有多远，作为渐变段长度的百分比。在上面第 1 部分的函数中使用这个百分比。这就是 P 应该的颜色。

请注意，与其他人所说的相反，从第 1 部分开始，您不能只将颜色视为函数中的常规数字。这几乎肯定不会达到您想要的效果。您所做的取决于您使用的色彩空间。如果您想要 RGB 渐变，则必须分别查看红色、绿色和蓝色分量。

例如，如果您想要一种颜色“介于”纯红色和蓝色之间，那么您正在处理的是十六进制表示法

ff 00 00

和

00 00 小时

可能你想要的颜色是这样的

80 00 80

这是一种很好的紫色。您必须分别平均每个颜色分量。如果您尝试直接对十六进制数 0xff0000 和 0x0000ff 进行平均，则会得到 0x7F807F，它是中等灰色。我猜这至少解释了您上面图片的部分问题。

或者，如果您在 HSV 颜色空间中，您可能只想调整色调分量，而让其他分量保持原样。

# python - 如何将具体的类名作为字符串获取？

> ID：521502
> 
> 赞同：160
> 
> 时间：2009-02-06T18:18:09.877
> 
> 标签：python

我想避免调用很多`isinstance()`函数，所以我正在寻找一种方法来获取实例变量的具体类名作为字符串。

有任何想法吗？

* * *

## 回答 #1

> 赞同：279
> 
> 时间：2009-02-06T18:20:24.630

```
 instance.__class__.__name__ 
```

例子：

```
>>> class A():
    pass
>>> a = A()
>>> a.__class__.__name__
'A' 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-06T18:23:43.950

```
<object>.__class__.__name__ 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-06T19:15:23.833

您还可以创建一个以类本身为键的字典，不一定是类名

```
typefunc={
    int:lambda x: x*2,
    str:lambda s:'(*(%s)*)'%s
}

def transform (param):
    print typefunc[type(param)](param)

transform (1)
>>> 2
transform ("hi")
>>> (*(hi)*) 
```

这`typefunc`是一个为每种类型映射一个函数的字典。`transform`获取该函数并将其应用于参数。

当然，使用“真正的”OOP 会好得多

# python - Python 中使用 Lambda 的比较函数

> ID：521505
> 
> 赞同：1
> 
> 时间：2009-02-06T18:19:26.550
> 
> 标签：python, sorting, lambda

我试图理解 lambdas 并且我明白了，但是如何为 Point2 [x,y] 比较定义多个条件，例如：

```
if x1 < x2: -1
if x1 == x2: 0
if x1 > x2: 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T18:25:40.377

上面的代码等价于：

```
cmp(x1,x2) 
```

或在（丑陋的）lambda 表达式中：

```
lambda x1,x2: 1 if x1>x2 else (0 if x1==x2 else -1) 
```

（仅适用于 Python 2.6 及更高版本）。

通常你应该只对像这样的函数使用 lambda 表达式

```
def fun(...):
    return ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T18:22:11.287

编辑：根据[PEP308](http://www.python.org/dev/peps/pep-0308/)更新为真正的 Python :) 请注意，根据您使用的 Python 版本，PEP 有关于如何用括号括起来的有趣信息。我不会尝试在这里复制它 - 只需阅读 PEP！

怎么样：

```
-1 if x1 < x2 else (0 if x1 == x2 else 1) 
```

（这在没有任何 Python lambda 表达式的知识的情况下，但这是在单个表达式中表达此逻辑的一种相当常见的方式，我猜这就是您所追求的。）

编辑：其他人建议使用`cmp`- 我一直假设提问者实际上想要更复杂的逻辑，例如提供他们自己的比较，但想要“从单个表达式中的几个条件中选择”的一般形式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T18:27:04.117

```
my_compare = lambda x1,x2 : cmp(x1, x2)
my_compare( -100, 100 ) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T18:27:22.120

在这种情况下，lambda 表达式通常不是最好的选择。正如 Jon Skeet 所提到的，您将以多个 if-else 表达式结束：

```
lambda x1, x2: -1 if x1 < x2 else (0 if x1 == x2 else -1) 
```

对于您的具体问题：

```
lambda x1, x2: cmp(x1, x2) 
```

是要走的路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-06T15:21:16.733

只需一行代码即可返回两个值中的最大值：

```
greater = lambda x,y : x if (x>y) else y   
print(greater(3,5)) 
```

# zend-framework - Zend 框架：headTitle()->append() 问题

> ID：521513
> 
> 赞同：8
> 
> 时间：2009-02-06T18:21:21.507
> 
> 标签：zend-framework

有没有人遇到过这个问题...

在我的 layout.phtml 中，我有：

```
<head>
    <?= $this->headTitle('Control Application - ') ?>
</head> 
```

然后在 index.phtml 我有：

```
<? $this->headTitle()->append('Client List'); ?> 
```

我希望，当我进行索引操作时，标题应该是“控制应用程序 - 客户端列表”，但我有“客户端 ListControl 应用程序 - ”

到底是怎么回事？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-06T18:32:31.047

headTitle() 的默认行为是附加到堆栈。在 layout.phtml 中调用 headTitle() 之前，您的堆栈是：

> 客户名单

然后，您使用第一个参数调用 headTitle 并且没有第二个参数（[这使其默认为 APPEND](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.headtitle)），从而产生以下堆栈：

> ClientListControl 应用程序 -

**解决方案，在 layout.phtml 中：**

```
<?php 
    $this->headTitle()->prepend('Control Application -');
    echo $this->headTitle();
?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T20:45:47.673

此外，您可以在布局中使用 setPrefix 方法，如下所示：

```
<head>
    <?= $this->headTitle()->setPrefix('Control Application') ?>
</head> 
```

在你的控制器/动作/等中使用标准的附加/前置：

```
<?php
$this->headTitle()->setSeparator(' - ');
$this->headTitle()->append('Client List');
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T18:29:18.730

我实际上并没有使用 headTitle，但确实使用了 ZF，并且我快速查看了邮件列表，这可能会解决问题：

```
<head>
    <?= $this->headTitle('Control Application') ?>
</head> 
```

然后：

```
<?php
$this->headTitle()->setSeparator(' - ');
$this->headTitle()->prepend('Client List');
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T13:51:23.013

发生这种情况是因为布局是要执行的最后一个脚本。所以你实际上在标题集之前进行了附加，这样就没有什么要附加的了。在控制器中设置主标题（控制应用程序）。例如，我总是在 initPlugin 的 predispatch 操作中执行此操作，以便它在任何其他控制器操作之前执行，并且我可以随意附加或前置。

要使用这样的插件，只需定义一个扩展*Zend_Controller_Plugin_Abstract*的新类并定义一个函数 preDispatch( *Zend_Controller_Request_Abstract* $request) ，您可以在其中放置所有通用到整个站点的代码，并注册插件只需将其放入 controllerFront你的引导程序： $controller->registerPlugin(new InitPlugin());

# c++ - Visual Studio C++ 调试器：没有十六进制转储？

> ID：521518
> 
> 赞同：7
> 
> 时间：2009-02-06T18:22:11.303
> 
> 标签：c++, visual-studio, debugging

为什么集成的 vs 调试器如此......几乎没有功能？我看不到内存中对象的内容。例如，我正在使用位图，我想在内存中看到它们。我需要一个更好的调试器吗？如果是这样，我对建议感兴趣。没有什么比反汇编器更强大了，只是调试器。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-06T18:38:26.450

我从来没有发现它“几乎没有功能”。VS 在找不到源时默认为您提供反汇编，并且很容易进入内存视图。调试-> 窗口-> 内存。在地址：框中键入“this”以获取当前对象的内存。查看特定成员类型“&this->member_name”。它会直接跳到第一个字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T18:55:56.663

调试 | 窗户 | 记忆 | 记忆1-4。将要查看的内存块的地址放在地址中。这可能是您尝试用鼠标执行的最困难的菜单选项（您会看到...）。

在旧版本的 VS 中，如果要查看变量的内容，则需要确定变量的地址，我通常使用监视窗口。

但是，在较新的版本中，您通常可以只输入变量的名称作为地址，就像在监视窗口中一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T18:26:03.150

VS2005 有一个“内存”选项卡，可以提供内存字节。我不知道如何说服它突出显示十六进制块，以便告诉你哪些变量是哪些变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T18:26:28.050

调试 | 窗户 | 内存可让您查看所需的任何内存区域（受进程/访问限制）。这是在VS2005中。其他版本的菜单结构可能略有不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T04:20:19.550

我不知道这是否有任何好处，但是在 Google 上快速搜索“调试器显示内存作为位图”出现了[Bitmap Memory Debugger](http://www.theycamefromhollywood.com/bmd/index.html)，它旨在与另一个调试器（如 Visual Studio 或 WinDbg）一起使用。

# yui - YUI CustomEvent 没有报错

> ID：521521
> 
> 赞同：1
> 
> 时间：2009-02-06T18:23:40.223
> 
> 标签：yui, error-reporting

有谁知道如何获取以下内容以报告 javascript 错误？（任何浏览器）

* * *

```
<head>
    <title></title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.6.0/build/yahoo-dom-event/yahoo-dom-event.js">
    </script>
    <script type="text/javascript">

        ObjWithEvent = {
            testEvent: new YAHOO.util.CustomEvent("testEvent")
        };

        ObjSubscriber = {
            handleTestEvent: function(){
                alert('the next line will not show up in the error console');
                not_a_valid_function_bro();
            }
        };

        ObjWithEvent.testEvent.subscribe(ObjSubscriber.handleTestEvent);
        ObjWithEvent.testEvent.fire();
    </script>
</head>
<body>
</body> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T18:33:45.633

可能是有史以来选择最差的默认设置之一..... YAHOO.util.Event.throwErrors 默认设置为 false，因此如果您想查看错误：

YAHOO.util.Event.throwErrors = true;

# c# - 如何计算最小二分顶点覆盖？

> ID：521525
> 
> 赞同：3
> 
> 时间：2009-02-06T18:24:21.237
> 
> 标签：c#, graph-theory

如何计算 C# 中的最小**二分**顶点覆盖？有这样做的代码片段吗？

编辑：虽然问题对于**一般图来说***是 NP 完全*的，但对于二部图来说，它**可以在多项式时间内解决。**我知道它在某种程度上与**二分**图中的最大匹配有关（通过 Konig 定理），但我无法正确理解该定理以便能够将最大二分匹配的结果转换为顶点覆盖。

 ******* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T20:59:36.930

我可以弄清楚：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

class VertexCover
{
    static void Main(string[] args)
    {
        var v = new VertexCover();
        v.ParseInput();
        v.FindVertexCover();
        v.PrintResults();
    }

    private void PrintResults()
    {
        Console.WriteLine(String.Join(" ", VertexCoverResult.Select(x => x.ToString()).ToArray()));
    }

    private void FindVertexCover()
    {
        FindBipartiteMatching();

        var TreeSet = new HashSet<int>();
        foreach (var v in LeftVertices)
            if (Matching[v] < 0)
                DepthFirstSearch(TreeSet, v, false);

        VertexCoverResult = new HashSet<int>(LeftVertices.Except(TreeSet).Union(RightVertices.Intersect(TreeSet)));
    }

    private void DepthFirstSearch(HashSet<int> TreeSet, int v, bool left)
    {
        if (TreeSet.Contains(v))
            return;
        TreeSet.Add(v);
        if (left) {
            foreach (var u in Edges[v])
                if (u != Matching[v])
                    DepthFirstSearch(TreeSet, u, true);
        } else if (Matching[v] >= 0)
            DepthFirstSearch(TreeSet, Matching[v], false);

    }

    private void FindBipartiteMatching()
    {
        Bicolorate();
        Matching = Enumerable.Repeat(-1, VertexCount).ToArray();
        var cnt = 0;
        foreach (var i in LeftVertices) {
            var seen = new bool[VertexCount];
            if (BipartiteMatchingInternal(seen, i)) cnt++;
        }
    }

    private bool BipartiteMatchingInternal(bool[] seen, int u)
    {
        foreach (var v in Edges[u]) {
            if (seen[v]) continue;
            seen[v] = true;
            if (Matching[v] < 0 || BipartiteMatchingInternal(seen, Matching[v])) {
                Matching[u] = v;
                Matching[v] = u;
                return true;
            }
        }
        return false;
    }

    private void Bicolorate()
    {
        LeftVertices = new HashSet<int>();
        RightVertices = new HashSet<int>();

        var colors = new int[VertexCount];
        for (int i = 0; i < VertexCount; ++i)
            if (colors[i] == 0 && !BicolorateInternal(colors, i, 1))
                throw new InvalidOperationException("Graph is NOT bipartite.");
    }

    private bool BicolorateInternal(int[] colors, int i, int color)
    {
        if (colors[i] == 0) {
            if (color == 1) LeftVertices.Add(i);
            else RightVertices.Add(i);
            colors[i] = color;
        } else if (colors[i] != color)
            return false;
        else
            return true;
        foreach (var j in Edges[i])
            if (!BicolorateInternal(colors, j, 3 - color))
                return false;
        return true;
    }

    private int VertexCount;
    private HashSet<int>[] Edges;
    private HashSet<int> LeftVertices;
    private HashSet<int> RightVertices;
    private HashSet<int> VertexCoverResult;
    private int[] Matching;

    private void ReadIntegerPair(out int x, out int y)
    {
        var input = Console.ReadLine();
        var splitted = input.Split(new char[] { ' ' }, 2);
        x = int.Parse(splitted[0]);
        y = int.Parse(splitted[1]);
    }

    private void ParseInput()
    {
        int EdgeCount;
        ReadIntegerPair(out VertexCount, out EdgeCount);
        Edges = new HashSet<int>[VertexCount];
        for (int i = 0; i < Edges.Length; ++i)
            Edges[i] = new HashSet<int>();

        for (int i = 0; i < EdgeCount; i++) {
            int x, y;
            ReadIntegerPair(out x, out y);
            Edges[x].Add(y);
            Edges[y].Add(x);
        }
    }
} 
```

如您所见，这段代码在多项式时间内解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:08:19.930

最好只是继续随机选择一个节点。对于每个节点，要么它进入顶点覆盖，要么它的所有邻居都这样做（因为你需要包括那个边）。整个事情的最终结果将是一组顶点覆盖，你选择最小的一个。不过，我不会坐在这里编写代码，因为如果我没记错的话，它的 NP 是完整的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-20T06:36:47.803

```
 private void DepthFirstSearch(HashSet TreeSet, int v, bool left)
    {
        if (TreeSet.Contains(v))
            return;
        TreeSet.Add(v);
        if (left) {
            foreach (var u in Edges[v])
                if (u != Matching[v])
                    DepthFirstSearch(TreeSet, u, true);
        } else if (Matching[v] >= 0)
            DepthFirstSearch(TreeSet, Matching[v], false);

    } 

```

当**if(left)**将执行时，我认为它的值始终为**false**。

# asp.net - Response.Redirect 和 Server.Transfer

> ID：521527
> 
> 赞同：30
> 
> 时间：2009-02-06T18:25:07.617
> 
> 标签：asp.net, redirect, server.transfer

> **可能重复：**
> [Server.Transfer Vs。响应.重定向](https://stackoverflow.com/questions/224569/server-transfer-vs-response-redirect)

ASP.NET 中的 Response.Redirect 和 Server.Transfer 有什么区别？

在什么情况下会想要使用其中一种而不是另一种？

# plugins - 如何使我的应用程序支持插件？

> ID：521528
> 
> 赞同：1
> 
> 时间：2009-02-06T18:25:30.983
> 
> 标签：plugins

我在一个需要能够支持插件的应用程序中工作，但我不知道它是如何工作的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T18:36:07.873

请参阅[设计模式以在您的应用程序中实现插件？](https://stackoverflow.com/questions/177140/design-pattern-for-implementing-plugins-in-your-application)
答案往往非常特定于平台。它还取决于插件必须对核心应用数据和逻辑的控制程度。

C++ QT4 书很好地描述了在其架构中添加文件类型插件，还有一堆建模应用程序（openscenegraph、blender、povray），它们的插件架构有很好的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:31:34.717

您需要以可以创建插件的方式设计应用程序的 API，并且您需要添加必要的插件管理接口和支持代码来调用插件。管理插件没有万能的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T18:41:20.593

看看名为**Rawr** (c#) 的开源应用程序。每个插件都是一个单独的 .dll，主应用程序使用反射来访问代码。做得很好。

[www.codeplex.com/Rawr](http://www.codeplex.com/Rawr)

# python - 如何让 python 的 pprint 返回一个字符串而不是打印？

> ID：521532
> 
> 赞同：224
> 
> 时间：2009-02-06T18:25:53.277
> 
> 标签：python, pretty-print, pprint

换句话说，什么是 sprintf 等价于 pprint？

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2009-02-06T18:28:30.260

pprint模块有一个名为 pformat 的命令[，](http://docs.python.org/library/pprint.html)[就是](http://docs.python.org/library/pprint.html#pprint.pformat)为了这个目的。

从文档中：

> 以字符串形式返回对象的格式化表示。缩进、宽度和深度将作为格式化参数传递给 PrettyPrinter 构造函数。

例子：

```
>>> import pprint
>>> people = [
...     {"first": "Brian", "last": "Kernighan"}, 
...     {"first": "Dennis", "last": "Richie"},
... ]
>>> pprint.pformat(people, indent=4)
"[   {   'first': 'Brian', 'last': 'Kernighan'},\n    {   'first': 'Dennis', 'last': 'Richie'}]" 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-06T18:29:47.903

假设您确实是`pprint`从[pretty-print library](http://docs.python.org/library/pprint.html)中获得的，那么您需要该`pprint.pformat`方法。

如果你只是说 `print`，那么你想要`str()`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-06-24T19:30:38.823

```
>>> import pprint
>>> pprint.pformat({'key1':'val1', 'key2':[1,2]})
"{'key1': 'val1', 'key2': [1, 2]}"
>>> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-06T18:29:14.173

你在找`pprint.pformat`吗？

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-06T18:30:04.377

像这样的东西：

```
import pprint, StringIO

s = StringIO.StringIO()
pprint.pprint(some_object, s)
print s.getvalue() # displays the string 
```

# asp.net - asp.net 中的 Active Directory 安全组和角色

> ID：521544
> 
> 赞同：0
> 
> 时间：2009-02-06T18:28:01.167
> 
> 标签：asp.net, active-directory, role

我在 AD 中有一个安全组。我想将管理员角色分配给该安全组的成员。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:32:00.080

尝试使用这个：

```
if (User.IsInRole("AdminSecurityGroup"))
{
    //Give user admin authority
} 
```

# asp.net - 无法让 ASP.Net UpdateProgress 显示

> ID：521554
> 
> 赞同：7
> 
> 时间：2009-02-06T18:30:12.037
> 
> 标签：asp.net, ajax, updatepanel, loader

每当我的更新面板执行 Ajax 操作时，我都会尝试显示更新进度加载图像。我查看了教程，看起来很简单，但我没有运气。这几乎是我所拥有的......

```
<div id="panelWrapper">
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <asp:UpdateProgress ID="TaskUpdateProgress" runat="server" DynamicLayout="False" AssociatedUpdatePanelID="UpdatePanel1" DisplayAfter="0">
            <ProgressTemplate>
                <asp:Image ImageUrl="~/Images/ajax-loader.gif" Width="16px" Height="16px" runat="server" ID="TaskLoadingImage"/>
            </ProgressTemplate>
        </asp:UpdateProgress>

        <div id="UrlDiv" class="URLNotification">
            <asp:Label ID="UrlLabel" runat="server" Text="URL:" AssociatedControlID="Url" />
            <asp:HyperLink ID="Url" runat="server" Text="Click &quotGenerate" to create the URL." />
        </div>

        <br />

        <asp:CheckBoxList runat="server" ID="IncludeItems" TextAlign="Right">
            <asp:ListItem Selected="True">Include 1</asp:ListItem>
            <asp:ListItem Selected="True">Include 2</asp:ListItem>
        </asp:CheckBoxList>

        <br />

        <div id="buttons" style="display:inline;">
            <asp:Button ID="Generate" runat="server" OnClicked="Generate_Clicked" Text="Generate" />
            <asp:Button ID="Add" runat="server" OnClientClick="add();" Text="Add"/>  
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

我在样式表中也有一些绝对定位样式。我已经尝试了您在此处看到的各种变体，但没有找到很多关于可能是什么问题的好信息。有任何想法吗？如果您还需要什么，请告诉我。

**编辑：**我发现的唯一新信息是......

“在以下情况下，UpdateProgress 控件将不会自动显示：

UpdateProgress 控件与特定更新面板相关联，但异步回发来自不在该更新面板内的控件。

UpdateProgress 控件不与任何 UpdatePanel 控件关联，并且异步回发不是由不在 UpdatePanel 内且不是触发器的控件产生的。例如，更新是在代码中执行的。”

我非常有信心这些都不适合我的情况。所发生的只是单击按钮（位于更新面板内）调用一些代码，在该代码后面设置要为更新面板重新加载的 URL 文本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T14:32:37.420

UpdateProgressPanel 也有同样的问题。我发现当您放置 UpdateProgressPanel 并将其关联到 UpdatePanel 时，来自该 UpdatePanel 的任何回发都会导致 UpdateProgressPanel 显示。

另一个技巧是，如果页面上有一个 UpdatePanel，则删除 AssociatedUpdatePanel 参数，这将导致 UpdateProgressPanel 显示发生的每个 Async PostBack。

UpdateProgressPanel 可以放在代码中的任何位置，除了那些上面有预定义标签的区域。它可以放置在 UpdatePanel 内部或外部，它会显示您是否正确放置了它的 CSS、将其关联到 UpdatePanel 或只是将其放置在那里，如果发生异步回发结果，它将显示出来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T18:32:35.620

不要将更新进度控件放在更新面板控件中

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-21T16:41:14.890

确保 UpdateProgress 'DisplayAfter' 设置为 1000（1 秒）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T20:11:06.810

我想我知道发生了什么。问题不在于我在 UpdateProgress 或 Panel 上做错了什么。是我在后台加载了其他东西，显然阻碍了 UpdatePanel 的 Ajaxyness。

所以基本上发生的事情是加载图标不会出现在初始页面加载中。我意识到这一点是因为我实际上是等到页面上的所有内容都完全加载后才触发按钮。果然，装载机出现了。

我假设至少会在听到单击事件的那一刻请求更新面板刷新，因此加载器图标会在其他内容加载期间立即显示。不过好像不是这样的……

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-08T00:37:36.373

将我的项目从 VS2008 转换为 VS2010 后，我真的很难过。UpdateProgress 突然停止工作，这在 VS2008 中很好。花了一个下午的时间寻找答案并试验了这个那个，最后我从[Scott Gu 的帖子](http://weblogs.asp.net/scottgu/archive/2006/12/10/gotcha-don-t-use-xhtmlconformance-mode-legacy-with-asp-net-ajax.aspx)中发现了问题所在。

这是一个自动生成的 web.config 条目**'xhtmlConformance mode="Legacy"** '。

禁用此功能后，它再次开始工作。对你来说可能不是这样，而只是对于那些在同样问题上苦苦挣扎的人。

快乐编码

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-01-08T11:56:17.490

我也遇到了 UpdateProgress 没有显示的问题。原来回发到服务器实际上是如此之快，它从来没有时间显示。添加 Thread.Sleep(10000) 有助于显示问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-15T07:24:28.733

创建一个新的支持 ASP.NET Ajax 的网站，然后将这些代码粘贴到 ascs 和 aspx 文件中。运行它，您可以看到更新进度。您也可以使用动画 gif 文件来显示进度...

ascx 页面：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>UpdateProgress control</title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server" />
        <asp:UpdateProgress runat="server" id="PageUpdateProgress" AssociatedUpdatePanelID="Panel">
            <ProgressTemplate>
                Loading...
            </ProgressTemplate>
        </asp:UpdateProgress>
        <asp:UpdatePanel runat="server" id="Panel">
            <ContentTemplate>
                <asp:Button runat="server" ID="UpdateButton" OnClick="UpdateButton_Click" Text="Update" />
            </ContentTemplate>
                <Triggers>
                    <asp:AsyncPostBackTrigger ControlID="UpdateButton" EventName="Click"  />
                </Triggers>            
        </asp:UpdatePanel>
    </form>
</body>
</html> 
```

页面：

```
 protected void UpdateButton_Click(object sender, EventArgs e)
    {
        System.Threading.Thread.Sleep(5000);
    } 
```

# php - flash to php 发送和接收变量

> ID：521556
> 
> 赞同：-1
> 
> 时间：2009-02-06T18:30:30.927
> 
> 标签：php, flash, variables

我为存储到数据库中的每条记录生成了一个唯一 id 我想将该 id 传递给 PHP 并针对它运行一个 select 语句并从数据库中取回一个值并将其传递回 flash，什么是最好的怎么做？

PS：我用的是AS3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T09:20:46.940

您必须调用建立 sql 连接并获取值的 php 脚本。

这里： http: [//livedocs.adobe.com/flex/2/langref/flash/net/URLLoader.html#includeExamplesSummary](http://livedocs.adobe.com/flex/2/langref/flash/net/URLLoader.html#includeExamplesSummary)

重要的部分在这里：

```
public function URLLoaderExample() {
        var loader:URLLoader = new URLLoader();
        configureListeners(loader);

        var request:URLRequest = new URLRequest("urlLoaderExample.txt");
        try {
            loader.load(request);
        } catch (error:Error) {
            trace("Unable to load requested document.");
        }
    } 
```

和这里：

```
private function completeHandler(event:Event):void {
        var loader:URLLoader = URLLoader(event.target);
        trace("completeHandler: " + loader.data);

        var vars:URLVariables = new URLVariables(loader.data);
        trace("The answer is " + vars.answer);
    } 
```

在您的 php 脚本中，最后只有一个打印：

```
<?php
   $value = Select Statement to get that damn value out of the damn database
   print $value;
?> 
```

您将能够从 loader.data 中读取 $value。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:28:24.767

我真的没有看到你的问题。是什么让这与调用服务器端 PHP 的客户端 javascript 真正不同？我的意思是，只需`URLLoader`使用适当的`URLRequest`对象（也可以是 POST 请求）创建一个，为 COMPLETE 事件添加一个事件处理程序，然后解析返回的文档。我推荐 XML，因为它很容易从 AS3 中解析，但 JSON 和纯文本也应该可以工作。

# c# - 在 LINQ 中查询子集合

> ID：521557
> 
> 赞同：12
> 
> 时间：2009-02-06T18:30:37.900
> 
> 标签：c#, .net, linq

我有一个名为`Gigs`.

每个`Gig`人都有一个`Acts`收藏。

使用 Linq，我想查询我的演出集合，以获取所有演出，例如，id 为 7 的行为。

```
act.id = 7; 
```

于是我开始写...

```
return from gig in qry
       where gig.Acts //not sure how to do this bit
       select gig; 
```

但我不确定您如何在称为行为的子集合上设置条件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T18:39:07.820

本质上与 Mike_G 相同，只是语法更冗长并使用相等。

```
var myCollection = from gig in qry
                   where gig.Acts.Any(act => act.ID == 7)
                   select gig; 
```

只需进行编辑即可对答案发表评论：

实际上，查询是针对 Act 对象上的成员（艺术家）的 ID，该 ID 可以为空。

新查询：

```
var myCollection = from gig in qry
                   where gig.Acts.Any(act => (null != act.Artist) && (act.Artist.ID == 7))
                   select gig; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T18:33:29.173

```
var x = gigs.Where(g=>g.Acts.Select(a=>a.ID).Contains(7)); 
```

这两个查询也返回相同的结果：

```
var x = gigs.Where(g=>g.Acts.Count(a=>a.ID == 7) > 0);

var x = gigs.Where(g=>g.Acts.FirstOrDefault(a=>a.ID == 7) != null); 
```

# javascript - 设置高度 div javascript

> ID：521563
> 
> 赞同：1
> 
> 时间：2009-02-06T18:31:37.260
> 
> 标签：javascript

我正在调整盒子的高度没有问题，现在我想调整盒子的高度抓住顶部把手并调整高度但向上。这样做的好方法是什么？谢谢

（当前向下代码）

```
var mY = event.clientY; 
var originalHeight = parseInt(document.getElementById('somediv').style.height);

if(click == 1){ // down
            var sY = event.clientY; 
            var finalHeight = originalHeight +sY-mY;
            document.getElementById('somediv').style.height=finalHeight + 'px';
}else{ // up
    resize upwards instead of downwards....
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T18:37:32.630

一个元素的位置由它的左上角定义——你必须在从底部延伸它的同时向上移动它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:41:11.233

“向上”调整 DIV 的大小并不像“向下”调整它那么容易。原因是当您指定 HEIGHT 时，DIV 将“向下”扩展为其正常流动。DIV 的左上角将保持静止。

允许将 DIV 调整为“向上”的大小会给您带来很多问题。为此，您需要设置 HEIGHT，然后将 DIV 的 POSITION 设置为 currentHeight - previousHeight。你会注意到这样做时它会抖动很多。

此外，您的 DIV 上方的任何内容都需要相应地显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T18:42:41.620

您应该查看[jQuery](http://jquery.com)和 jQuery [Dimensions 插件](http://plugins.jquery.com/project/dimensions)。

# php - 将 TIMESTAMP SQL 转换为 12 小时时间

> ID：521581
> 
> 赞同：1
> 
> 时间：2009-02-06T18:35:00.247
> 
> 标签：php, javascript, jquery, html

我正在编写一个应用程序，允许人们在特定时间安排事情，然后显示它们。事件的时间作为 SQL TIME 存储在数据库中，因为我在数据库中做的一些事情需要这种结构。

但是，在输出页面上，我希望时间为 12:00 am/pm 格式，但我不想每次通过数据库输出循环时都运行转换脚本。我不想要这个：

```
while (database loop){
convert to clean time
output event info, with clean time
} 
```

因为我认为这太紧张和不必要了。除了将时间存储在数据库中两次（一次在 24 小时内，一次在 12 小时内）之外，有没有办法更好地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:40:34.993

您没有说明哪个 DBMS 和哪个平台，但大多数现代的 DBMS 将具有某种您可以使用的 CONVERT 或 CAST 函数，无论是在 DB 级别，还是在处理您的输出时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:44:51.553

对于 sql server 使用带有样式 100 的转换

```
select convert(varchar(30),getdate(),100) 
```

2009 年 2 月 6 日下午 1:44

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T18:40:47.380

在数据库中转换时间和日期占用的资源非常少，而且比在 PHP 或 JavaScript 中进行转换要快得多。我会使用您的数据库提供的日期和时间函数，例如`DATE_FORMAT(date,format)`在 mySql 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:14:36.127

输出页面是您的表示层。不要将表示问题混入数据库层。特别是不要仅仅为了演示而强制进行非规范化。

> 我不想每次通过数据库输出循环时都运行转换脚本

为什么不呢？根据您使用的语言，它不应该比通过 strftime() 操作发送时间更多的工作，然后再将它放到页面上。它不会很慢。

# wpf - 在 RichTextBox WPF 中设置文化/语言

> ID：521591
> 
> 赞同：1
> 
> 时间：2009-02-06T18:37:24.063
> 
> 标签：wpf, wpf-controls, richtextbox, culture

嗨，可以在 RichTextBox 中设置默认语言或设置新语言，我想在“es-PE”中设置它以供拼写检查器使用

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T18:51:42.477

似乎可以在下面的代码中设置[xml:lang ：](http://msdn.microsoft.com/en-us/library/ms788718.aspx)

```
 <StackPanel>
    <RichTextBox SpellCheck.IsEnabled="True"/>
    <RichTextBox SpellCheck.IsEnabled="True" xml:lang="es-PE"/>
</StackPanel> 
```

第一个框检查默认文化，第二个框检查指定文化（“es-PE”）。

该文档还建议您可以将此属性添加到父控件（例如面板）中，并且它将由子控件继承。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:40:53.900

您是否尝试将当前线程的文化设置为您想要的文化？.NET 中的大多数东西都从线程中获取文化。

```
Thread.CurrentThread.CurrentCulture = new Culture( "es-PE" );
Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture; 
```

# c# - 即使网格视图没有聚焦，我也可以处理按键事件吗？

> ID：521594
> 
> 赞同：0
> 
> 时间：2009-02-06T18:37:43.207
> 
> 标签：c#, .net-3.5, event-handling

我在应用程序的某个区域中显示的控件内有一个数据网格视图。

我希望在按下 F5 时刷新此活动网格。

当 Activity Grid View 是屏幕上当前聚焦的元素时，通过处理 Key Up 事件很容易做到这一点，但是当另一个元素（例如菜单栏）是最后一个被点击的东西时，这显然不起作用.

在这种情况下有没有办法跟踪按键？我无权访问我的数据网格视图/控件之外的代码。

这个问题的答案可能是一个明确的否定，但我想确保我在完成这项工作时没有遗漏一些明显的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T18:42:06.800

不。

如果您无权访问当时可能具有焦点的其他控件，则无法将按键向上消息从它们传递给您的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:50:22.837

您可以在控件所在的表单上进行一些全局键盘事件处理。

如果将此添加到表单中，则可以在将全局键事件发送到控件之前获取它们。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    switch (keyData)
    {
        case Keys.F5:
            // Send Refesh Event To Grid
            return true; // Mark Key As Handled

            // Add Any Extra Command Keys Here
    }

    return base.ProcessCmdKey(ref msg, keyData); // Resend To Base Function
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T18:50:45.550

您是否尝试过捕获表单本身的事件，然后调用数据网格的事件处理程序？您必须将 KeyPreview 设置为 true 才能使表单获得键盘事件通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T18:51:08.297

处理这个问题的最好方法是让主应用程序表单来处理所有按键。为此，请将主窗体属性“KeyPreview”设置为 True。

然后，处理主窗体上的所有 KeyUp 事件。关于 KeyPreview 的更多信息：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)

# sql-server-2005 - SQL 2005 中表的主键和聚集索引的智能选择，以提高选择单记录或多记录的性能

> ID：521596
> 
> 赞同：1
> 
> 时间：2009-02-06T18:37:52.863
> 
> 标签：sql-server-2005, performance, primary-key, clustered-index

**编辑：**我添加了“Slug”列来解决特定记录选择的性能问题。

我的表格中有以下列。

```
Id Int - Primary key (identity, clustered by default)
Slug varchar(100)
...
EntryDate DateTime 
```

大多数时候，我按 EntryDate 订购 select 语句，如下所示。

```
Select T.Id, T.Slug, ..., T.EntryDate
From (
    Select Id, Slug, ..., EntryDate,  
        Row_Number() Over (Order By EntryDate Desc, Id Desc) AS RowNum
    From TableName
    Where ...
) As T
Where T.RowNum Between ... And ... 
```

如果有重复的EntryDates，我将按EntryDate 和Id 对其进行排序。

当我选择 A 记录时，我执行以下操作。

```
Select Id, Slug, ..., EntryDate
From TableName
Where Slug = @slug And Year(EntryDate) = @entryYear 
    And Month(EntryDate) = @entryMonth 
```

我有一个独特的 Slug & EntryDate 键。

在我的情况下，什么是键和索引的明智选择？我面临性能问题可能是因为我按未聚集索引的列排序。

我应该将 Id 设置为非聚集主键并将 EntryDate 设置为聚集索引吗？

我感谢您的所有帮助。谢谢。

**编辑：**

我没有尝试在 EntryDate 上添加非聚集索引。从后端插入的数据，因此插入的性能对我来说没什么大不了的。此外，EntryDate 并不总是插入日期。它可以是过去的日期。后端用户选择日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T22:01:39.910

根据当前的表布局，您需要一些这样的索引。

```
CREATE INDEX IX_YourTable_1 ON dbo.YourTable
(EntryDate, Id)
INCLUDE (SLug)
WITH (FILLFACTOR=90)

CREATE INDEX IX_YourTable_2 ON dbo.YourTable
(EntryDate, Slug)
INCLUDE (Id)
WITH (FILLFACTOR=80) 
```

将您要返回的任何其他列添加到 INCLUDE 行。

将您的第二个查询更改为类似的内容。

```
Select Id, Slug, ..., EntryDate
From TableName
Where Slug = @slug 
    AND EntryDate BETWEEN CAST(CAST(@EntryYear AS VARCHAR(4) + CAST(@EntryMonth AS VARCHAR(2)) + '01' AS DATE) AND DATEADD(mm, 1, CAST(CAST(@EntryYear AS VARCHAR(4) + CAST(@EntryMonth AS VARCHAR(2)) + '01' AS DATE)) 
```

当前编写第二个查询的方式永远不会使用索引。如果您可以将 Slug 列更改为相关表，它将提高您的性能并降低您的存储需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:41:53.463

您是否尝试过在 entrydate 上简单地添加一个非聚集索引来查看您获得了什么样的性能提升？

此外，多久添加一次新数据？添加的新数据是否总是>=最后一个EntryDate？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T18:47:52.217

您希望将 ID 保留为聚集索引，因为您很可能会从您的 id 加入表，而不是进入日期。

一个只有日期字段的简单非聚集索引可以加快速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T18:49:41.090

集群有点像“索引分页”，索引是“分块”的，而不是简单的长列表。当您拥有大量数据时，这很有帮助。数据库可以在集群范围内搜索，然后找到单个记录。它使索引更小，因此搜索速度更快，但不太具体。一旦在集群中找到正确的位置，它就需要在集群中进行搜索。

大量数据时速度更快，但数据集较小时速度较慢。

如果您不使用主键进行大量搜索，则对日期进行聚类并将主键保留为非聚类。这实际上取决于您的查询与加入其他表的复杂程度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T22:15:10.177

如果您要返回一堆记录，并且您返回的某些字段不是索引的一部分，则聚集索引只会产生任何影响。否则没有任何好处。

您需要首先找出查询计划告诉您当前查询速度慢的原因。没有它，它主要是无用的推测（这在优化查询时通常会适得其反。）

如果没有可靠的查询计划可以比较，我不会尝试任何事情（由我或其他人建议），至少要知道你是在做善事还是在做坏事。

# mysql - 自动删除MySQL中过期记录的方法？

> ID：521624
> 
> 赞同：3
> 
> 时间：2009-02-06T18:44:06.873
> 
> 标签：mysql

我用谷歌搜索并搜索了令人作呕的 MYSQL 文档，但找不到一种简洁的方法来自动删除超过给定时间范围的记录。我已经能够在 5.1 中获得一个查询，以在 DIFF 函数中将 TIMESTAMP 的值转换为 DATETIME，并查看当前时间是否符合过期标准。我已经读到 5.1 现在具有运行计划任务的能力，但配置它的方式并不多。我没有为此使用触发器。

在 MySQL 5.1 的文档中，它指的是创建一个事件：

```
'CREATE 
[DEFINER = { user | CURRENT_USER }]
EVENT 
[IF NOT EXISTS]
event_name    
ON SCHEDULE schedule
[ON COMPLETION [NOT] PRESERVE]
[ENABLE | DISABLE | DISABLE ON SLAVE]
[COMMENT 'comment']
DO sql_statement;

schedule:
AT timestamp [+ INTERVAL interval] ...
| EVERY interval 
[STARTS timestamp [+ INTERVAL interval] ...] 
[ENDS timestamp [+ INTERVAL interval] ...]

interval: 
```

我目前使用 Toad（这是天赐之物）。我的查询有效地删除了任何超过 30 分钟的记录。我只需要找到如何调用此事件...

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T21:53:20.690

您正在谈论使用[MySQL Scheduler](http://dev.mysql.com/doc/refman/5.1/en/events.html)。一旦您创建了该事件，MySQL 将在您配置的任何时间间隔自动调用它。如果您在设置时遇到问题，请发布您遇到的查询和错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:46:59.957

编写一个查询并让它每隔一段时间在一项工作中运行。比如说，每 30 分钟左右检查一次过期的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T21:07:35.883

如果不必精确，而您只是做家务，您可以将流程与另一个流程联系起来。如果你能负担得起时间。

如果您有旧发票文件，请在月末运行时将其清除（可能有很多记录，但无论如何这是一个批处理）。添加新物品时清除旧的库存物品（频率较低，但可能记录较少）。保留访问日志表？当其中最近的记录与今天不同时清除它。（对于低流量日志文件）等等。

# c# - Retrieve file properties

> ID：521630
> 
> 赞同：1
> 
> 时间：2009-02-06T18:45:35.763
> 
> 标签：c#, .net, windows

When in Windows XP, if I open the properties window for the file and click the second tab, I will find a window where to add attributes or remove them.

While developing things, I noticed there was actually something I wanted to know about the file. How to retrieve this data? It's a string with name 'DESCRIPTION'.

The actual tab is saying 'Custom'. I think it's called metadata what it shows.

I noticed that only the files I'm looking at have that tab. It seems to be specific only for the SLDLFP -file.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:56:14.603

Not on an XP machine, but I think this might work

```
FileVersionInfo myFileVersionInfo = FileVersionInfo.GetVersionInfo("path.txt");
string desc = myFileVersionInfo.FileDescription; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:51:14.147

I think this applies to all microsoft office based documents (and not all the other files). You might need to automate word/excel/powerpoint to get that info.

OR you might need some kind of a binary file reader for MSOffice based files to read the attributes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:00:01.647

I think the custom tab is only available for Office documents, and display custom properties (In Word, File -> Properties, Custom tab).

The best way to get the information would be by using MS Office hooks. Last time I did anything like this, it was using OLE Automation, so good luck!

**Edit:**
Since you added a mention of SLDLFP, I'm guessing that you are working with SolidWorks files.

There *may* be some standard APIs for this, but none that I have heard of. Using SolidWorks via Automation is probably going to be your best bet.

I found a link describing how to read these kind of values with a Word 2003 and VB.Net, I would expect that it is similar to how to do this with SolidWorks.

[Reading and Writing Custom Document Properties in Microsoft Office Word 2003 with Microsoft Visual Basic .NET](http://msdn.microsoft.com/en-us/library/aa537163.aspx)

# c# - 运行安装程序或检查是否安装了程序

> ID：521631
> 
> 赞同：0
> 
> 时间：2009-02-06T18:45:56.310
> 
> 标签：c#, visual-studio-2008, .net-3.5, installation

我有一个我想用作自动运行的程序。我希望它能够做三件事。它需要检查是否安装了特定程序，如果没有，则向用户提供安装它的选项。其次，如果程序已安装，则向用户提供运行和卸载程序的选项，第三，向用户提供查看自述文件的选项。

如何让一个程序检查是否已经安装了另一个程序？如何从另一个程序启动安装程序/卸载程序？

谢谢。

PS我可以修改安装程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T05:38:42.903

假设它是您的程序并且您正在构建安装，我只需让您的安装程序写入注册表项，然后在您的自动运行程序中检查该键。

要从您的自动运行程序启动安装程序，只需运行 setup.exe，或使用 MSIEXEC 获取 MSI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T18:59:40.400

假设您的安装是基于 Windows Installer 的，那么您需要的一切都[在这里](http://msdn.microsoft.com/en-us/library/aa369426(VS.85).aspx)。

# .net - 将 PowerShell 与 .NET 3.5 运行时/库一起使用

> ID：521632
> 
> 赞同：7
> 
> 时间：2009-02-06T18:46:18.320
> 
> 标签：.net, .net-3.5, powershell, powershell-2.0, powershell-1.0

是否可以运行由 3.5 运行时而不是 2.0 支持的 PowerShell 1.0（或 2.0 CTP）？

我们正在构建一个 .NET 3.5 解决方案，我仍然想使用 PowerShell 作为我们的脚本引擎来执行计划任务等。

我不需要 LINQ 语法或任何东西，只需要 3.5 库和运行时。

跟进：感谢您关于动态加载程序集的回复。但是让我澄清一下我的问题：有什么方法可以运行 PowerShell 以便默认运行 3.5 库？因此，`New-Object System.Xml.XmlDocument`例如，如果我输入，我实际上默认获得的是 3.5 版本？

半相关的问题：如果我*必须*动态加载，比如说，`System.Xml`3.5 的库，它会*覆盖*现有的符号定义，以便*下次*我键入`New-Object System.Xml.XmlDocument`时，它*会*加载 3.5 版本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-22T15:53:59.903

如果您的系统上安装了 3.5，那么这就是您在运行 PowerShell 时将得到的。

PowerShell 只是“需要”2.0，但 3.0 和 3.5 是兼容的，并且在安装时会自动转发。在 PowerShell V2 中，我们实际上会查看您拥有的版本并“点亮”某些功能（例如 PowerShell_ISE 和 Out-GridView 在您拥有 3.51 时可用）。

实验！享受！从事！

Jeffrey Snover [MSFT] Windows 管理合作伙伴架构师

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T18:55:33.450

只要您获得正确的完全限定名称，我不明白为什么这不起作用：

```
[System.Reflection.Assembly]::Load("System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089") 
```

我只使用了 Linq，因为这是第一个想到的。此时，ddl 已加载，您可以从中创建/使用对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T19:26:13.983

PowerShell 是针对 2.0 构建的，因此您别无选择，只能至少拥有 2.0。但正如 James 所说，您可以通过加载适当的程序集来加载 3.0 和 3.5 功能。LINQ 是 3.5 的一个很好的例子，但您也可以从 PowerShell 执行 WPF (3.0)。但请注意 WPF 的 STA 和 MTA，因为只有 PowerShell v2 完全支持 WPF（完全支持线程关联）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T03:14:35.613

3.5 实际上是 2.0 的附加组件。也就是说，3.5中没有被取代的类；它不是替代品。CLR（公共语言运行时）仍然是 v2.0。

# asp.net - 编译 ASP.NET 网站时出现 MSBuild 错误

> ID：521637
> 
> 赞同：23
> 
> 时间：2009-02-06T18:47:35.463
> 
> 标签：asp.net

当我尝试使用自定义构建脚本编译 asp.net 站点时出现以下错误。

```
error ASPCONFIG: It is an error to use a section registered as allowDefinition='MachineToApplication' beyond application level.  This error can be caused by a virtual directory not being configured as an application in IIS. 
```

虽然描述很详细，但我不明白它的确切含义。我还没有配置 IIS 来托管这个网站，而且我认为我不能这样做，因为我正在运行 Vista Home Basic 版本。所以网站不能使用自定义脚本构建？请回复，因为我想测试这个功能。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2010-01-20T03:27:41.683

我遇到了同样的问题，最后发现一个流氓 Web.config 被放置在我的 obj 文件夹中……帮自己一个忙，在所有子目录中搜索 web.config 文件。我删除了它，一切恢复正常。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-01-14T14:26:15.750

obj 文件夹中的 rogue web.config 文件最有可能是在您发布网站时引起的。因此，只需在完成发布后对其进行清理。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-01T18:43:02.203

如果在创建虚拟目录之后发生这种情况，请执行以下操作：

*   右键单击 web.config
    *   特性
        *   构建操作：内容
        *   复制到输出目录：不要复制
*   如果转换（适用于所有配置）
    *   特性
        *   构建操作：无
        *   复制到输出目录：不要复制

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T18:57:59.157

您的 web.config 文件很可能放置在不是应用程序根目录的目录中。在大多数版本的 IIS 上，您可以将网站上的任何文件夹转换为应用程序根目录：

1.  打开 IIS 并导航到相应的文件夹
2.  右键单击文件夹，选择属性
3.  在应用程序设置下的应用程序名称旁边，单击**创建**
4.  申请并关闭

如果这不能解决您的问题，则可能是 IIS 或您的应用程序存在另一个配置错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T19:00:43.113

在 IIS 中，转到应用程序运行所在的文件夹，右键单击它，转到属性。在目录选项卡上，查找“应用程序设置”。单击创建按钮。

# asp.net - 以编程方式将 Javascript 文件添加到 .net 中的用户控件

> ID：521639
> 
> 赞同：17
> 
> 时间：2009-02-06T18:48:05.323
> 
> 标签：asp.net, javascript, user-controls

如何以编程方式将 Javascript 文件添加到用户控件？

我希望用户控件是一个完整的包 - 即我不想在使用它的页面上添加与用户控件相关的 javascript，而我可以在控件本身内部进行操作。

既然用户控件中没有 Page 对象，你会怎么做呢？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-11T00:07:38.503

在 control.ascx.cs 文件的 Page_Load 方法中：

```
LiteralControl jsResource = new LiteralControl();
jsResource.Text = "<script type=\"text/javascript\" src=\"js/mini-template-control.js\"></script>";
Page.Header.Controls.Add(jsResource);

HtmlLink stylesLink = new HtmlLink();
stylesLink.Attributes["rel"] = "stylesheet";
stylesLink.Attributes["type"] = "text/css";
stylesLink.Href = "css/mini-template-control.css";
Page.Header.Controls.Add(stylesLink); 
```

这会将 css 和 Javascript 加载到主页的 head 标签中，只需确保 head 具有 runat="server"。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-06T18:54:35.107

您可以使用 ClientScriptManager 注册客户端脚本。页面可通过 Control.Page 属性访问。

```
Page.ClientScript.RegisterClientScriptInclude (
  typeof ( MyControl ), "includeme.js", "js/includeme.js"  ); 
```

编辑：对不起，对于一个完整的“完整包”，它可以使用脚本作为嵌入式资源，并通过 WebResource.axd 处理程序获取动态 URL。如果这不被认为是完全完整的，那么我想它可以放在 App_LocalResources 中，但它永远不会只是一个文件，除非代码和脚本是内联的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-25T12:10:38.780

与 gnomixa 的响应相同，只是更干净一点：

```
HtmlGenericControl js = new HtmlGenericControl("script");
js.Attributes["type"] = "text/javascript";
js.Attributes["src"] = "jscript/formfunctions.js";
Page.Header.Controls.Add(js); 
```

来自[http://www.aspdotnetfaq.com/Faq/How-to-Programmatically-add-JavaScript-File-to-Asp-Net-page.aspx](http://www.aspdotnetfaq.com/Faq/How-to-Programmatically-add-JavaScript-File-to-Asp-Net-page.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-18T20:37:45.093

在我的站点中，我将所有需要的脚本和样式放置到 placeHolder

```
<asp:placeHolder runat="Server" ID="phHead">
    <script src="/header/widget/script.js" type="text/javascript"></script>
    <link href="/header/widget/style.css" rel="stylesheet" type="text/css" />
</asp:placeHolder> 
```

和

```
Private Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Page.Header.Controls.Add(phHead)
End Sub 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T03:39:02.410

好问题！

UserControl 应该是一个单独的包，不依赖于 JavaScript 或 CSS 文件。您需要将 JS 和 CSS 文件作为嵌入式资源。右键单击属性并将构建操作设置为嵌入式资源。然后您需要将 JavaScript 和 CSS 文件作为 WebResources 注入。

这是我昨天写的一篇文章，其中谈到了相同的场景：

[http://highoncoding.com/Articles/502_Creating_RadioButton_Validation_Using_Custom_Validator.aspx](http://highoncoding.com/Articles/502_Creating_RadioButton_Validation_Using_Custom_Validator.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T18:52:10.180

我通常在呈现控件的 HTML 时这样做，并且取决于它是库注入还是实例注入，我使用 Items 集合来指定在当前请求期间我是否已经为这种类型的控件生成代码唯一标识符。

大意是：

```
 protected override void Render(HtmlTextWriter writer)
    {
        base.Render(writer);

        //Check if the Object Script has already been rendered during this request.
        if (!Context.Items.Contains("xxx"))
        {
            //Specify that the Object Script has been rendered during this request.
            Context.Items.Add("xxx", string.Empty);
            //Write the script to the page via the control
            writer.Write([libraryinjection]);
        }
        //Write the script that instantiates a new instance for this control
        writer.Write([instanceinjection]);
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T18:59:57.200

如果您的 .CS 文件中有实际 javascript 的文本，则可以调用 Page.ClientScript.RegisterClientScriptBlock。

以下假设“GetScript()”返回您想要添加到呈现控件的*实际javascript。*

```
Page.ClientScript.RegisterClientScriptBlock(GetType(), "controlScriptName", GetScript()); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-18T14:09:25.840

我发现这是一种更优雅的方式来修复您的 javascript 的链接。
在您的 .ascx 中，通过以下方式链接到您的脚本文件：

```
<script src='<%= ResolveClientUrl("~/Scripts/jquery-1.7.1.min.js") %>' type="text/javascript"></script>
<script src='<%= ResolveClientUrl("~/Scripts/jquery.maskedinput-1.3.min.js") %>' type="text/javascript"></script> 
```

这样，无论您将用户控件添加到哪个子文件夹/页面，脚本的链接都将始终正确解析。

# language-agnostic - 使用域模型和 POCO 类时，查询在哪里？

> ID：521640
> 
> 赞同：7
> 
> 时间：2009-02-06T18:48:10.300
> 
> 标签：language-agnostic, domain-driven-design, ddd-repositories

我是域模型、POCO 和 DDD 的新手，所以我仍在努力思考一些想法。

我还没有弄清楚的一件事是如何保持我的域模型简单且与存储无关，但仍然能够以丰富的方式对其数据执行一些查询。

例如，假设我有一个包含 OrdemItems 集合的实体 Order。无论出于何种原因，我都想获得最便宜的订单商品，或者可能是目前没有库存的订单商品清单。我不想做的是从存储中检索所有订单项目并稍后过滤（太昂贵），所以我想最终以某种方式获得“SELECT .. WHERE ITEM.INSTOCK = FALSE”类型的数据库查询。我不想在我的实体中使用该 SQL 查询，或者任何变体是否会将我绑定到特定平台，例如 Linq2SQL 上的 NHibernate 查询。在这种情况下，常见的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T01:37:27.383

实体是域的“单元”。存储库和服务引用*它们*，反之亦然。这样想：你把车管所放在口袋里吗？

`OrderItem`不是聚合根；它不应该通过存储库访问。它的身份对于 a 来说是本地的`Order`，这意味着在谈论s`Order`时，an 总是在范围内。`OrderItem`

为查询找到家的困难使我想到了服务。在这种情况下，它们将代表*关于*an本身`Order`很难`Order`知道的东西。

在域项目中声明意图：

```
public interface ICheapestItemService
{
    OrderItem GetCheapestItem(Order order);
}

public interface IInventoryService
{
    IEnumerable<OrderItem> GetOutOfStockItems(Order order);
} 
```

在数据项目中声明实现：

```
public class CheapestItemService : ICheapestItemService
{
    private IQueryable<OrderItem> _orderItems;

    public CheapestItemService(IQueryable<OrderItem> orderItems)
    {
        _orderItems = orderItems;
    }

    public OrderItem GetCheapestItem(Order order)
    {
        var itemsByPrice =
            from item in _orderItems
            where item.Order == order
            orderby item.Price
            select item;

        return itemsByPrice.FirstOrDefault();
    }
}

public class InventoryService : IInventoryService
{
    private IQueryable<OrderItem> _orderItems;

    public InventoryService(IQueryable<OrderItem> orderItems)
    {
        _orderItems = orderItems;
    }

    public IEnumerable<OrderItem> GetOutOfStockItems(Order order)
    {
        return _orderItems.Where(item => item.Order == order && !item.InStock);
    }
} 
```

此示例适用于任何 LINQ 提供程序。或者，数据项目可以使用 NHibernate 的`ISession`和`ICriteria`做脏活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T19:04:13.510

域对象应该独立于存储，您应该使用存储库模式或 DAO 来持久化对象。这样你就强制分离关注点，对象本身不应该知道它是如何存储的。

理想情况下，将查询构造放在存储库中是个好主意，尽管我会在其中使用 ORM。

这是 Martin Fowler 对[存储库模式的定义。](http://martinfowler.com/eaaCatalog/repository.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T18:58:50.853

据我了解这种设计风格，您可以将查询封装在 OrderItemRepository（或者更合适的 OrderRepository）对象的方法中，该对象的职责是在一侧与 DB 通信，并在另一侧返回 OrderItem 对象。存储库对 OrderItem 实例的消费者隐藏数据库的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T02:17:59.453

我认为谈论“仅包含没有库存的 OrderItems 的订单”是没有意义的。“订单”（我想）代表客户订购的任何东西的完整列表；如果您正在过滤该列表，则您不再处理 Order 本身，您正在处理的是经过过滤的 OrderItems 列表。

我认为问题在于您是否真的想将 Orders 视为[Aggregate Root](http://domaindrivendesign.org/discussion/messageboardarchive/Aggregates.html)，或者您是否也希望能够从数据访问层中提取任意 OrderItems 列表。

您说过在从数据库返回后过滤项目太昂贵了，但是除非您为每个订单平均数百或数千个 OrderItems（或者还有其他特别密集的处理大量 OrderItems 的事情），否则您可能试图过早地优化并使事情变得比他们需要的更困难。我认为，如果您可以将 Order 作为聚合根并在域逻辑中进行过滤，那么您的模型将更易于使用。

如果确实*不是*这种情况并且您需要在数据库中进行过滤，那么您可能需要考虑拥有一个单独的 OrderItem 存储库，该存储库将提供诸如“给我此订单的所有无库存的 OrderItems”之类的查询。然后，您会将它们作为`IList<OrderItem>`（或`IEnumerable<OrderItem>`）返回，因为它们*不是*完整的 Order，而是一些经过过滤的 OrderItems 集合。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-11T01:51:07.100

在服务层。

# tinymce - 创建 TinyMCE 插件时如何不加载主题 css？

> ID：521642
> 
> 赞同：3
> 
> 时间：2009-02-06T18:48:45.897
> 
> 标签：tinymce

我正在创建我的第一个 TinyMCE 插件。我在 html 中包含“tiny_mce_popup.js”，默认情况下它正在加载“advanced/skins/default/dialog.css”。

我不需要 TinyMCE 来加载这个 css，到目前为止我发现的唯一解决方案记录在这里[http://www.mattephraim.com/blog/tag/tinymce/](http://www.mattephraim.com/blog/tag/tinymce/)；正如作者所建议的那样，这不是最优雅的解决方案。如果您知道处理此问题的正确方法，请提供帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T21:51:38.993

我通过在“tiny_mce_popup.js”代码中挖掘 1mm找到了[官方文档。](http://wiki.moxiecode.com/index.php/TinyMCE:API/tinymce.WindowManager/open)基本上你要做的就是在 editor_plugin.js 的 init() 中，添加 popup_css 作为选项并将其设置为 false：

```
ed.windowManager.open({
  ...
  file : url + '/dialog.htm',
  width : 640 + parseInt(ed.getLang('attachment_fu.delta_width', 0)),
  height : 485 + parseInt(ed.getLang('attachment_fu.delta_height', 0)),
  popup_css : false,
  ...
}) 
```

# c# - 控制在数据绑定 WPF ComboBox 的文本框部分显示哪个字段

> ID：521668
> 
> 赞同：0
> 
> 时间：2009-02-06T18:56:55.197
> 
> 标签：c#, .net, wpf, combobox

我在 WPF 中有一个 ComboBox，它是数据绑定的，并且有一个数据模板来控制每个项目的显示方式。我已经做到了，每个项目都显示有两位文本（用于名称和路径属性）和一个图像（用于图标属性）。

当我从 ComboBox 中选择一个项目时，ComboBox 的文本框位只是更改为“TestWPF.Result”，这是我填充 ComboBox 的类的名称。

我对两件事中的一件（或两件）感兴趣：

1.  如何更改它以显示其中一个字段的值（例如，它显示名称字段的值而不是类的名称）？

2.  是否有可能让它在项目列表中使用相同的 DataTemplate，这样一旦我选择了一个项目，它就会以与项目列表中相同的方式显示在关闭的 ComboBox 中。基本上我有一个名为 ShowResults 的 DataTemplate 和一个使用该模板的 ComboBox。我还添加了一个单独的 ContentControl，我必须在 ComboBox 中显示所选项目的详细信息，但我想用它来替换 ComboBox 中的文本框。

**更新：**

感谢您的第一个答案。正如您所描述的，我尝试使用单独的 ContentControl，它工作正常。现在的问题是如何用这个 ContentControl 替换 ComboBox 的文本框部分。对此的任何提示都将受到欢迎。

此外，是否可以用 ContentControl 和文本框的混合替换 ComboBox 控件的文本框位，这样我仍然可以在文本框中键入以帮助从 ComboBox 中选择项目，但是当我关闭下拉列表时，其余的ContentControl 位将填充其余的文本和图标。希望这是有道理的 - 如果没有，请提出问题！

**代码：**

我被要求发布我的代码 - 所以就在这里。我试图删除我知道绝对不相关的东西，但我不确定到底什么是相关的，所以当有疑问时，我会把东西留在里面。

```
<Window x:Class="TestWPF.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:custom="clr-namespace:TestWPF"
Title="Window1" Height="300" Width="843" Loaded="Window_Loaded">
<Window.Resources>
    <DataTemplate x:Key="ShowResult" DataType="TestWPF.Result">
        <StackPanel Margin="5" Orientation="Horizontal">
            <Image Width="32" Height="32"  Source="{Binding Path=Image}"/>
            <StackPanel Margin="5">
                <TextBlock FontWeight="Bold" Text="{Binding Path=Name}"/>                    
                <TextBlock Text="{Binding Path=Path}"/>
            </StackPanel>
        </StackPanel>
    </DataTemplate>
</Window.Resources>

<Grid Width="786">
    <Button Height="23" HorizontalAlignment="Right" Margin="0,24,166,0" Name="btnTest" VerticalAlignment="Top" Width="75" Click="btnTest_Click">Add</Button>
    <ComboBox StaysOpenOnEdit="True"  DropDownClosed="comboBox1_DropDownClosed" PreviewTextInput="comboBox1_PreviewTextInput" SelectionChanged="comboBox1_SelectionChanged" ItemTemplate="{StaticResource ShowResult}"  Margin="259,109,22,89" Name="comboBox1" IsEditable="True" />
    <ContentControl Height="50" Margin="268,0,22,21" Name="contentControl1" VerticalAlignment="Bottom" Content="{Binding ElementName=comboBox1,Path=SelectedValue}" ContentTemplate="{StaticResource ShowResult}"/>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T23:35:13.557

您得到了正确的绑定部分 - 绑定到数据并使用 DataTemplate 以您想要的方式显示源。

至于您的第二个问题，一种方法是使用带有 IsEditable="True" 的 ComboBox，并使用 TextChanged 事件处理程序检查 comboBox.Items 是否包含新值，如果不检查则使用 Linq搜索匹配：

```
if (comboBox.Items.Contains(e.NewValue))
    返回;

var 匹配 =
与 comboBox.Items
选择物品
其中 item.BeginsWith(e.NewValue);

if (matches.Count > 0)
    comboBox.SelectedItem = 匹配.First();

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T19:13:05.177

只需将属性绑定表达式放置到文本框，您不需要应用模板。

另一种获取精确数据模板的方法，将 ContentControl 放置在 textBox 的位置并分配相同的 DataTemplate（比如 x:Name="robinTemplate"）

```
<ContentControl Content="{Binding ElementName=cmbBox,Path=SelectedValue}" ContentTemplate="{StaticResource robinTemplate}"/> 
```

为了使选定的内容以相同的方式显示：创建组合框控件模板的副本，您将在那里找到一个 ContentPresenter。用 ContentControl 替换它。虽然这不是正确的解决方案。

# java - 使用 JDBC 3.0 实现对嵌套事务的支持

> ID：521669
> 
> 赞同：2
> 
> 时间：2009-02-06T18:57:19.483
> 
> 标签：java, jdbc, transactions

我们的旧应用程序使用 JDBC 3.0。它通过实现自己的事务管理器来支持事务，该事务管理器能够为每个线程返回相同的 JDBC 连接。我最近发现的问题是它不支持嵌套事务：如果一个事务在另一个事务中启动，那么在内部事务的上下文中运行的每个 SQL 都将使用相同的数据库连接执行，并且当它被提交或回滚它将自动提交或回滚从外部事务开始的所有更改。

据我了解，我可以使用 JDBC 3.0 保存点实现对嵌套事务的支持：每当启动嵌套事务时，我都可以为当前连接设置一个新的保存点。之后，如果嵌套事务回滚，我将回滚到这个保存点。另一方面，如果它被承诺，我将什么也不做。只有最外层事务的提交才会将更改保存到数据库。

这个对吗？这种方法有什么缺陷吗？如果是，我的可能性是什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T20:51:51.733

代码中可能存在期望完成而不是延迟提交的依赖项（例如，如果隔离级别设置为 TRANSACTION_READ_COMMITTED）。

考虑修复您的事务管理器以在单独的连接上执行嵌套事务。

更新：看起来[Spring 框架](http://www.jroller.com/dancruz/entry/spring_nested_transactions)使用 SavePoints 来提供嵌套事务。我的猜测是他们只是忽略了隔离模式的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:12:35.897

事务有点棘手，不能真正从 JDBC 层查看，而是从底层数据库本身查看。我将从这里开始谈论 Oracle，因为它是我最有经验的。在 Oracle 中，如果您启动事务，则可以回滚到事务中的保存点，但不能使用保存点提交。假设我启动了一个事务并拥有三个保存点 A、B 和 C。我可以愉快地前进和回滚到 A、B 或 C，但是一旦你提交，你就开始了一个新事务，现在是 A、B , 和 C 不再有效。我希望这能很好地回答你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:44:26.890

您可以尝试[Atomikos TransactionsEssentials](http://www.atomikos.com/Main/TransactionsEssentials)中的嵌套事务支持。

但是，DBMS 中的嵌套事务通常受到以下方式的限制：

-您的嵌套事务共享相同的数据库事务，这允许以回滚粒度为代价共享数据访问（您回滚整个事物）

- 或者您的嵌套事务（由 Atomikos）映射到不同的底层数据库事务，代价是不允许共享数据访问热点数据

这种不匹配是由于数据库事务的 ACID 特性造成的。最终，您所有的 DBMS 访问都必然发生在这样的数据库事务中。

如果您想自己包装一些东西，您提到的保存点方法听起来很有希望 - 但您可能需要确保对其进行广泛测试。

最好的家伙

# c# - C# TreeView 设计 - 显示树结构的最佳方式？

> ID：521671
> 
> 赞同：4
> 
> 时间：2009-02-06T18:58:02.260
> 
> 标签：c#, oop, treeview

我正在尝试使用 TreeView 来显示对象的树结构。我有四种类型的对象树，公司（根节点）、城市、商店和员工。

该界面旨在添加/删除 Cities/Stores/Employees，因此 TreeView 必须更新以反映任何更改。

我想知道让 TreeView 显示树结构并在更改时接收更新的正确方法。

我在想 Company 对象应该有事件，例如 company.CityAdded 和 company.CityRemoved，然后我在 TreeView 周围放置的任何包装器都会响应这些事件？当 TreeView 建立后，每个城市/商店/员工都会有一个节点。然后每个节点可以响应它在树中表示的节点的事件。

这是正确的想法吗？或者有没有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T15:23:03.270

我只是想补充一点，如果 WPF 是一个选项，那么使用分层数据绑定和 observablecollections 将变得非常简单。它基本上为您处理所有事件，并让您只与业务对象进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:02:57.897

你在监听事件的概念上是正确的（这是一个标准的发布者/订阅者模式）。

对于树视图的实际更新，我倾向于有两种方法：`AddOrUpdateTreeItem`和`RemoveTreeItem`. add 或 update 方法执行它所说的，查找树项（基于路径）并更新它或添加它。当然，如果模型是在创建表单的线程之外的线程上更新的，则需要使用`Control.BeginInvoke()`.

如果您在 form_load 或其他地方填充完整的树，这种方法可能会有点慢，因此您可能对初始填充有不同的方法，并使用我在此处描述的概念进行后续更新。

我对列表视图做同样的事情，这是一个典型的例子。添加树项的主要区别在于，您可能需要添加父节点才能添加所请求的节点，这使得它有点递归。试试看。

```
private void AddOrUpdateListItem(DomainModelObject item)
{
    ListViewItem li = lvwListView.Items[GetKey(item)];

    if (li == null)
    {
        li = new ListViewItem
                 {
                     Name = GetKey(item), 
                     Tag = item
                 };
        li.SubItems.Add(new ListViewItem.ListViewSubItem());
        li.SubItems.Add(new ListViewItem.ListViewSubItem());
        li.SubItems.Add(new ListViewItem.ListViewSubItem());
        li.ImageIndex = 0;
        lvwListView.Items.Add(li);
    }

    li.Text = [Itemtext];
    li.SubItems[1].Text = [Itemtext];
    li.SubItems[2].Text = [Itemtext];
    li.SubItems[3].Text = [Itemtext];
} 
```

`BeginInvoke()`这是一个如何实现的示例：

```
public class MyForm : Form
{
    ...

    void data_Changed(object sender, DataChangedEventArgs e)
    {
        if (this.InvokeRequired)
        {
            this.BeginInvoke(new EventHandler<DataChangedEventArgs>(data_Changed), sender, e);
            return;
        }

        AddOrUpdateListItem(e.DataItem);
    }

    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T19:09:27.930

听起来你是在正确的道路上。我不得不做类似的事情，我想分享一些建议：

1.  将对象引用存储在 TreeNode 标记属性中。

2.  给每个 Treenode 一个唯一的名称，可以很容易地识别一个对象，例如：对象哈希码、公司 ID 等。

这样，您可以在对象状态更改时轻松查找和更新 TreeNode。当用户选择一个节点时，您可以从 Tag 属性中获取它所代表的对象。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:14:49.170

代替 ...

*   业务对象订阅 UI 事件
*   命令更新 UI
*   更新 UI 时更新业务对象

...您也可以反过来做（即命令更新业务对象树，从而导致对 UI 的相应更新）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T09:20:07.730

更新的发布/订阅模式的部分关键是如何包装事件触发时要做什么的信息。

当代表“Store X”的对象更新了一个新名称，并触发了一个事件来宣布这已经发生时，哪个对象使用该事件？

同样，当添加城市 Y 时，应该通知哪个对象创建？

一种常见的方法是使用某种大型 uber-manager 类来处理整个过程——它订阅所有事件并完成所有事情。

另一种方法，我用过的效果很好，是创建更简单的包装器/协调器对象，只处理拼图的一部分。通常，我在这些类的名称后面加上“ `Editor`”。

因此，您可以拥有一个`CityEditor`类，其构造函数既接受一个`City`对象，又接受`TreeNode`代表该对象的 。将`CityEditor`订阅`City`object 和 上的事件`TreeNode`，并负责用标题填充`TreeNode`并选择图标。

当 City 对象更新时，`CityEditor`通过更新`TreeNode`. 当 City 对象被移除时，`CityEditor`确保节点从`Treeview`.

当一个新的 Store 对象被添加到 中`City`时，`CityEditor`可以负责创建一个`StoreEditor`来协调该级别的更新。类似地，当将 an`Employee`添加到 a时，处理 的更新的`Store`实例。`EmployeeEditor``Treeview`

# python - 在 Python 中将列表初始化为已知数量的元素

> ID：521674
> 
> 赞同：278
> 
> 时间：2009-02-06T18:58:53.443
> 
> 标签：python, arrays, list

现在我正在使用一个列表，并期待类似的东西：

```
verts = list (1000) 
```

我应该改用数组吗？

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2009-02-06T19:02:00.083

我首先想到的是：

```
verts = [None]*1000 
```

但是你真的需要预初始化它吗？

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-12-03T03:46:47.383

不太清楚为什么每个人都让你很难做到这一点 - 有几种情况你想要一个固定大小的初始化列表。而且您已经正确推断出数组在这些情况下是明智的。

```
import array
verts=array.array('i',(0,)*1000) 
```

对于非 pythonistas，该`(0,)*1000`术语是创建一个包含 1000 个零的元组。逗号强制 python 识别`(0)`为元组，否则它将被评估为 0。

我使用元组而不是列表，因为它们通常具有较低的开销。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2011-10-28T22:41:50.847

一种明显且可能无效的方法是

```
verts = [0 for x in range(1000)] 
```

请注意，这可以很容易地扩展到二维。例如，要获得一个 10x100 的“数组”，您可以这样做

```
verts = [[0 for x in range(100)] for y in range(10)] 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2013-03-09T20:09:35.447

想要初始化一个固定大小的数组在任何编程语言中都是完全可以接受的。这不像程序员想要在 while(true) 循环中放置一个 break 语句。相信我，特别是如果元素只是要被覆盖而不仅仅是添加/减去，就像许多动态编程算法的情况一样，你不想弄乱附加语句并检查元素是否没有被尚未在运行中初始化（这是很多代码绅士）。

`object = [0 for x in range(1000)]`

这将适用于程序员试图实现的目标。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2015-01-02T23:57:20.670

@Steve 已经很好地回答了您的问题：

```
verts = [None] * 1000 
```

**警告：**正如@Joachim Wuttke 指出的那样，列表必须使用不可变元素进行初始化。`[[]] * 1000`无法按预期工作，因为您将获得 1000 个相同列表的列表（类似于 C 中相同列表的 1000 个点的列表）。像 int、str 或 tuple 这样的不可变对象就可以了。

## 备择方案

调整列表大小很慢。以下结果并不令人惊讶：

```
>>> N = 10**6

>>> %timeit a = [None] * N
100 loops, best of 3: 7.41 ms per loop

>>> %timeit a = [None for x in xrange(N)]
10 loops, best of 3: 30 ms per loop

>>> %timeit a = [None for x in range(N)]
10 loops, best of 3: 67.7 ms per loop

>>> a = []
>>> %timeit for x in xrange(N): a.append(None)
10 loops, best of 3: 85.6 ms per loop 
```

但是，如果您没有非常大的列表，则调整大小并不是很慢。您应该考虑使用列表推导并直接用正确的值填充列表，而不是使用单个元素（例如`None`）和固定长度来初始化列表以避免调整列表大小。例如：

```
>>> %timeit a = [x**2 for x in xrange(N)]
10 loops, best of 3: 109 ms per loop

>>> def fill_list1():
    """Not too bad, but complicated code"""
    a = [None] * N
    for x in xrange(N):
        a[x] = x**2
>>> %timeit fill_list1()
10 loops, best of 3: 126 ms per loop

>>> def fill_list2():
    """This is slow, use only for small lists"""
    a = []
    for x in xrange(N):
        a.append(x**2)
>>> %timeit fill_list2()
10 loops, best of 3: 177 ms per loop 
```

## 与 numpy 的比较

对于庞大的数据集，numpy 或其他优化的库要快得多：

```
from numpy import ndarray, zeros
%timeit empty((N,))
1000000 loops, best of 3: 788 ns per loop

%timeit zeros((N,))
100 loops, best of 3: 3.56 ms per loop 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-07T18:51:02.197

你可以这样做：

```
verts = list(xrange(1000))
```

这将为您提供一个大小为 1000 个元素的列表，并且恰好使用 0-999 的值进行初始化。与第`list`一个`__len__`确定新列表的大小一样，它应该是相当有效的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T18:20:25.517

您应该考虑使用`dict`类型而不是预初始化列表。字典查找的成本很小，与访问任意列表元素的成本相当。

当使用映射时，您可以编写：

```
aDict = {}
aDict[100] = fetchElement()
putElement(fetchElement(), fetchPosition(), aDict) 
```

该`putElement`功能可以将项目存储在任何给定位置。如果您需要检查您的集合是否包含给定索引处的元素，则编写更加 Pythonic：

```
if anIndex in aDict:
    print "cool!" 
```

比：

```
if not myList[anIndex] is None:
    print "cool!" 
```

由于后者假定您的集合中没有*真正的*元素可以是`None`. 如果发生这种情况 - 你的代码行为不端。

如果您迫切需要性能，这就是您尝试预初始化变量并编写尽可能快的代码的原因 - 更改您的语言。最快的代码不能用 Python 编写。您应该改用 C 并实现包装器以从 Python 调用您的预初始化和预编译代码。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-06T21:05:38.413

如果不了解问题域的更多信息，就很难回答您的问题。除非您确定需要做更多的事情，否则初始化列表的 Pythonic 方法是：

```
顶点 = []

```

你真的看到了性能问题吗？如果是这样，性能瓶颈是什么？不要试图解决你没有的问题。将数组动态填充到 1000 个元素的性能成本可能与您真正尝试编写的程序*完全无关。*

如果列表中的事物总是特定的原始固定长度类型（例如 char、int、float），则数组类很有用。但是，它也不需要预初始化。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2016-03-11T08:02:48.653

这：

```
 lst = [8 for i in range(9)] 
```

创建一个列表，元素被初始化 8

但是这个：

```
lst = [0] * 7 
```

将创建 7 个列表，其中包含一个元素

# unicode - 将代码源从代码页转换为 UTF-8 的工具？

> ID：521681
> 
> 赞同：5
> 
> 时间：2009-02-06T19:00:14.410
> 
> 标签：unicode, utf-8, codepages

我正在开发一个开源项目。原始项目包含俄语注释并使用代码页 1251。我正在使用代码页 1252 并且俄语注释在 Visual Studio Express 2008 中无法正确显示，不好但无论如何我看不懂俄语。有人使用代码页 950（繁体中文）试图编译项目但无法编译，因为代码页！现在真的很烦。

我认为使用[unicode（更确切地说是带签名的 UTF-8）作为代码源的文件格式是可行](https://stackoverflow.com/questions/383681/globalizing-source-code)的方法。

问题：如何轻松转换整个源代码？

我已经知道了：

*   让 Visual Studio 将源代码保存为 UTF-8。但是：我的计算机正在使用代码页 1252，我发现无法告诉 VS 原始代码源正在使用代码页 1251，因此转换将不正确。

    **编辑：**正如“LicenseQ”所指出的，有一种方法可以在 VS 中使用另一种编码打开单个文件：单击打开对话框中打开按钮附近的箭头，选择“打开方式”，然后选择“代码编辑器（带编码）”。

*   当然，我可以在转换时更改计算机的代码页。但这是 Windows 中的全局设置，您需要重新启动计算机，以便我寻找更友好的解决方案。

*   我找到了一个名为[CodePageConverter](http://www.codeproject.com/KB/files/CodePage_File_Converter.aspx)的工具，它完全可以满足我的需要，但不能作为批处理作业。

有谁知道另一种工具（命令行工具将是完美的）从代码页转换为 UTF-8？

**编辑：**正如 tkotitan 所建议的那样，[iconv](http://www.gnu.org/software/libiconv/)似乎是我正在寻找的解决方案。有一个[windows 版本的 iconv](http://gnuwin32.sourceforge.net/packages/libiconv.htm)。现在我知道了这个工具的名称，我可以[在 stackoverflow 上](https://stackoverflow.com/questions/64860/best-way-to-convert-text-files-between-character-sets)找到处理类似问题的帖子。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T19:02:03.203

在 unix 世界中，该实用程序称为 iconv。

不确定是否有等效的Windows。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T19:23:59.383

您可以要求 VS 2008 使用编码打开文件（单击打开对话框中打开按钮附近的箭头）

或者您可以更改区域设置以默认添加俄罗斯区域；）

# c# - XSD 如何

> ID：521683
> 
> 赞同：1
> 
> 时间：2009-02-06T19:00:40.227
> 
> 标签：c#, .net, xsd

**背景：**

我们有一个第三方公司已经使用了一年多的应用程序，看起来我们将从现在开始在内部维护它。在大多数情况下，我非常有能力，我可以处理 99% 的任何问题。

在这个项目中，有一个 XSD 文件充当 SQL Server 2005 机器上的一堆存储过程的传递。

**问题：**

*   可以从数据库生成 XSD 文件，如果可以，如何完成？
*   如果数据库上的存储过程发生更改，这些文件是否难以维护？需要生成新的 XSD 文件还是可以手动更新？
*   处理这些文件的最佳实践？

我知道这是一个大问题，但我想在下周二开始这个项目之前完全理解这一点。我不确定我是否会从原始开发人员那里获得很多关于此的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T19:12:46.800

它们被称为**强类型数据集**。

> 可以从数据库生成 XSD 文件，如果可以，如何完成？

是的，打开它或将新数据集添加到您的项目中，从 Visual Studio 打开服务器资源管理器并连接到您的数据库。拖放您的 SP 或表格。

> 如果数据库上的存储过程发生更改，这些文件是否难以维护？需要生成新的 XSD 文件还是可以手动更新？

是的，它需要在源更改时生成。您可以通过从xsd中删除相关表或sp，然后重新添加来完成。

一些关于强类型数据集的可视化教程：

[http://weblogs.asp.net/scottgu/archive/2006/01/15/435498.aspx](http://weblogs.asp.net/scottgu/archive/2006/01/15/435498.aspx)

[http://aspnet.4guysfromrolla.com/articles/020806-1.aspx](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)

# perl - 如何在 Perl 脚本中将 FTP 转换为 SFTP？

> ID：521685
> 
> 赞同：2
> 
> 时间：2009-02-06T19:01:08.073
> 
> 标签：perl, ftp, sftp

我有一个现有的 Perl 脚本，它使用 FTP 对象将几个文件发送到 AIX 机器。我刚刚发现我们的 Linux 机器不支持 FTP。它确实支持 SFTP。我应该通过哪些步骤将我的脚本转换为使用 SFTP？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T19:07:32.740

您当前的脚本可能正在使用[Net::FTP](http://search.cpan.org/perldoc?Net::FTP)模块。您将需要[Net::SFTP](http://search.cpan.org/perldoc?Net::SFTP)模块及其来自 CPAN 的依赖项。您甚至可以使用现有脚本作为指南来启动一个新脚本。不过，逻辑是一样的。连接、发送和断开连接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T20:33:43.660

我实际上做过类似的事情。但它是准备任何当前的 FTP 脚本，以便在需要时通过 SFTP 运行。

我制作了一个包装器对象，[`Net::SFTP`](http://search.cpan.org/perldoc?Net::SFTP)它看起来和行为都像一个[`Net::FTP`](http://search.cpan.org/perldoc?Net::FTP)对象。因此，所有调用都可以留在具有不同实现的地方。

我从这个出发：

```
my $client = Net::FTP->new( Host => 'ftp.somehost.com', ... ); 
```

到

```
my $client = FTPClient->new( Host => 'ftp.somehost.com', ...
                           , secureFTP => 1 
                           ); 
```

并且刚刚实现了我[`Net::FTP`](http://search.cpan.org/perldoc?Net::FTP)在新课程中使用的所有方法。[`Net::SFTP`](http://search.cpan.org/perldoc?Net::SFTP)回馈一些不同的回报，因此您必须实际包装函数，而不仅仅是使用[`Class::Delegator`](http://search.cpan.org/perldoc?Class::Delegator).

# c# - 带索引的 foreach

> ID：521687
> 
> 赞同：169
> 
> 时间：2009-02-06T19:01:31.660
> 
> 标签：c#, foreach

是否有与 Python`enumerate()`和 Ruby等效的 C# `each_with_index`？

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2009-02-06T19:49:39.877

为此，我保留了此扩展方法：

```
public static void Each<T>(this IEnumerable<T> ie, Action<T, int> action)
{
    var i = 0;
    foreach (var e in ie) action(e, i++);
} 
```

并像这样使用它：

```
var strings = new List<string>();
strings.Each((str, n) =>
{
    // hooray
}); 
```

或者允许`break`类似的行为：

```
public static bool Each<T>(this IEnumerable<T> ie, Func<T, int, bool> action)
{
    int i = 0;
    foreach (T e in ie) if (!action(e, i++)) return false;
    return true;
}

var strings = new List<string>() { "a", "b", "c" };

bool iteratedAll = strings.Each ((str, n)) =>
{
    if (str == "b") return false;
    return true;
}); 
```

* * *

## 回答 #2

> 赞同：233
> 
> 时间：2009-02-06T19:04:28.130

您可以执行以下操作

```
foreach (var it in someCollection.Select((x, i) => new { Value = x, Index = i }) )
{
   if (it.Index > SomeNumber) //      
} 
```

这将为集合中的每个条目创建一个匿名类型值。它将有两个属性

*   `Value`：与集合中的原始值
*   `Index`: 带有集合内的索引

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-02-06T19:04:05.883

C# foreach 没有内置索引。您需要在 foreach 循环之外添加一个整数并每次递增。

```
int i = -1;
foreach (Widget w in widgets)
{
   i++;
   // do something
} 
```

或者，您可以使用标准 for 循环，如下所示：

```
for (int i = 0; i < widgets.Length; i++)
{
   w = widgets[i];
   // do something
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-08-10T08:30:06.260

我喜欢能够使用foreach，所以我做了一个扩展方法和一个结构：

```
public struct EnumeratedInstance<T>
{
    public long cnt;
    public T item;
}

public static IEnumerable<EnumeratedInstance<T>> Enumerate<T>(this IEnumerable<T> collection)
{
    long counter = 0;
    foreach (var item in collection)
    {
        yield return new EnumeratedInstance<T>
        {
            cnt = counter,
            item = item
        };
        counter++;
    }
} 
```

和一个例子使用：

```
foreach (var ii in new string[] { "a", "b", "c" }.Enumerate())
{
    Console.WriteLine(ii.item + ii.cnt);
} 
```

一件好事是，如果您习惯了 Python 语法，您仍然可以使用它：

```
foreach (var ii in Enumerate(new string[] { "a", "b", "c" })) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-02-06T19:07:08.077

除了已经给出的 LINQ 答案之外，我还有一个[“SmartEnumerable”](https://jonskeet.uk/csharp/miscutil/usage/smartenumerable.html)类，它允许您获取索引和“第一个/最后一个”-ness。它在语法方面有点难看，但您可能会发现它很有用。

我们可能可以在非泛型类型中使用静态方法来改进类型推断，隐式类型也会有所帮助。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-06T19:12:05.087

我的解决方案涉及我为通用实用程序创建的一个简单的 Pair 类，它在操作上与框架类 KeyValuePair 基本相同。然后我为 IEnumerable 创建了几个扩展函数，称为 Ordinate（来自集合论术语“ [ordinal](http://en.wikipedia.org/wiki/Ordinal_number) ”）。

这些函数将为每个项目返回一个包含索引的 Pair 对象和项目本身。

```
public static IEnumerable<Pair<Int32, X>> Ordinate<X>(this IEnumerable<X> lhs)
{
    return lhs.Ordinate(0);
}

public static IEnumerable<Pair<Int32, X>> Ordinate<X>(this IEnumerable<X> lhs, Int32 initial)
{
    Int32 index = initial - 1;

    return lhs.Select(x => new Pair<Int32, X>(++index, x));
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-06T19:13:47.453

不，那里没有。

正如其他人所展示的，有一些方法可以模拟 Ruby 的行为。但是可能有一个类型实现了不公开索引的[IEnumerable 。](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable(VS.71).aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-21T11:10:23.880

我刚刚想出了有趣的解决方案：

```
public class DepthAware<T> : IEnumerable<T>
{
    private readonly IEnumerable<T> source;

    public DepthAware(IEnumerable<T> source)
    {
        this.source = source;
        this.Depth = 0;
    }

    public int Depth { get; private set; }

    private IEnumerable<T> GetItems()
    {
        foreach (var item in source)
        {
            yield return item;
            ++this.Depth;
        }
    }

    public IEnumerator<T> GetEnumerator()
    {
        return GetItems().GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
}

// Generic type leverage and extension invoking
public static class DepthAware
{
    public static DepthAware<T> AsDepthAware<T>(this IEnumerable<T> source)
    {
        return new DepthAware<T>(source);
    }

    public static DepthAware<T> New<T>(IEnumerable<T> source)
    {
        return new DepthAware<T>(source);
    }
} 
```

用法：

```
var chars = new[] {'a', 'b', 'c', 'd', 'e', 'f', 'g'}.AsDepthAware();

foreach (var item in chars)
{
    Console.WriteLine("Char: {0}, depth: {1}", item, chars.Depth);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-05-04T06:27:40.950

这是你的收藏

```
var values = new[] {6, 2, 8, 45, 9, 3, 0}; 
```

为此集合创建一系列索引

```
var indexes = Enumerable.Range(0, values.Length).ToList(); 
```

使用范围迭代索引

```
indexes.ForEach(i => values[i] += i);
indexes.ForEach(i => Console.Write("[{0}] = {1}", i, values[i])); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-06T19:04:22.403

这取决于您使用的课​​程。

Dictionary<(Of <(TKey, TValue>)>) 类例子支持这个

Dictionary<(Of <(TKey, TValue>)>) 泛型类提供从一组键到一组值的映射。

出于枚举的目的，字典中的每个项目都被视为表示值及其键的 KeyValuePair<(Of <(TKey, TValue>)>) 结构。返回项目的顺序未定义。

foreach（myDictionary 中的 KeyValuePair kvp）{...}

# java - XML 代码运行正常，但 junit 因 NoClassDefFound 而失败

> ID：521692
> 
> 赞同：0
> 
> 时间：2009-02-06T19:02:38.960
> 
> 标签：java, junit, eclipse-3.4, xsltc

我正在将我的环境从 eclipse 3.3.1 和 java 1.4 升级到 eclipse 3.4.1 和 java 1.5。我的单元测试在 jUnit 3 中。

日食 java 版本 1.5.0__17

独立的环境版本 1.5.0__12 或 1.5.0-17 都可以工作。

我有一个将 XML 文件写入磁盘的类的方法。它调用 TransformerFactory tf = [javax.xml.transform.]TransformerFactory.newInstance(); 当我在 Eclipse 之外运行代码时，它运行良好。当我在 Eclipse 中运行 jUnit 中的代码时，我得到下面的堆栈跟踪。缺少的类在 java 1.4 的 rt.jar 中，而不是在 java 5 中，但不应该从我这里抽象出来吗？

我怎样才能使测试通过？

当我从应用程序运行 eclipse 中的代码时，我得到了同样的错误。

```
java.lang.NoClassDefFoundError: org/apache/xalan/processor/TransformerFactoryImpl
 在 weblogic.xml.jaxp.RegistryTransformerFactory.(RegistryTransformerFactory.java:62)
 在 weblogic.xml.jaxp.RegistrySAXTransformerFactory.(RegistrySAXTransformerFactory.java:12)
 在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
 在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
 在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
 在 java.lang.reflect.Constructor.newInstance(Constructor.java:494)
 在 java.lang.Class.newInstance0(Class.java:350)
 在 java.lang.Class.newInstance(Class.java:303)
 在 javax.xml.transform.FactoryFinder.newInstance(FactoryFinder.java:100)
 在 javax.xml.transform.FactoryFinder.findJarServiceProvider(FactoryFinder.java:278)
 在 javax.xml.transform.FactoryFinder.find(FactoryFinder.java:185)
 在 javax.xml.transform.TransformerFactory.newInstance(TransformerFactory.java:103)
 在 com.bellsouth.snt.cnmp.sso.netcool.NetcoolAccessThread.writeXmlFile(NetcoolAccessThread.java:278)
 在 com.bellsouth.snt.cnmp.sso.netcool.NetcoolAccessThreadTest.testWriteXmlFile(NetcoolAccessThreadTest.java:83)
 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
 在 java.lang.reflect.Method.invoke(Method.java:585)
 在 junit.framework.TestCase.runTest(TestCase.java:164)
 在 junit.framework.TestCase.runBare(TestCase.java:130)
 在 junit.framework.TestResult$1.protect(TestResult.java:106)
 在 junit.framework.TestResult.runProtected(TestResult.java:124)
 在 junit.framework.TestResult.run(TestResult.java:109)
 在 junit.framework.TestCase.run(TestCase.java:120)
 在 junit.framework.TestSuite.runTest(TestSuite.java:230)
 在 junit.framework.TestSuite.run(TestSuite.java:225)
 在 org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)
 在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)
 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)
 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)
 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)

```

**更新** 我在堆栈跟踪的内部做了更多的研究。工作版本（在 Eclipse 之外）正在返回一个 com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl 的实例，它是 javax.xml.transform.TransformerFactory.newInstance() 中的后备 impl 类名

```
    公共静态 TransformerFactory newInstance()
        抛出 TransformerFactoryConfigurationError {
        尝试 {
            返回 (TransformerFactory) FactoryFinder.find(
            /* 根据 JAXP 规范的默认属性名称 */
            "javax.xml.transform.TransformerFactory",
            /* 回退实现类名，XSLTC */
            “com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl”）；
        } 捕捉（FactoryFinder.ConfigurationError e）{
            抛出新的 TransformerFactoryConfigurationError(
                e.getException(),
                e.getMessage());
        }
    }

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T19:00:25.793

我在单元测试的设置中添加了以下行

```
 System.setProperty("javax.xml.transform.TransformerFactory", "com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl"); 
```

我想出了如何处理一些 RTFM。 [http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/TransformerFactory.html#newInstance()](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/TransformerFactory.html#newInstance())

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:11:41.267

您可以检查在 Eclipse 中运行时是否使用与在其外部运行时相同的 Java 版本（在 Eclipse 中：运行方式 -> 运行配置... -> JRE 选项卡）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:05:43.023

将 Xalan JAR 添加到类路径中。

如果您使用的是 WebLogic，请参见[此处。](http://bugs.gridsphere.org/browse/GPF-307)您必须将 JAR 放在 shared/lib 中。

# .net - 在手持设备上禁用 Windows CE 控制台

> ID：521702
> 
> 赞同：0
> 
> 时间：2009-02-06T19:04:19.017
> 
> 标签：.net, compact-framework, windows-ce

有谁知道如何在 Windows Mobile v5.0 手持设备上禁用 Windows CE 控制台？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T19:14:04.757

编辑设备上的注册表。PHM Regedit 是一个免费工具，可让您执行此操作。

将以下键更改为 0xFFFFFFFF：

```
HKEY_LOCAL_MACHINE\Drivers\Console\OutputTo 
```

更多信息：[https ://meeting.uni.lu/andre.stemper/startcmd.html](https://meeting.uni.lu/andre.stemper/startcmd.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T19:16:28.853

使用远程注册表编辑器并将此项的值设置为非零值（例如 0xFFFFFFFF）

```
HKEY_LOCAL_MACHINE\Drivers\Console\OutputTo 
```

# iphone - 使用半透明 UINavigationBars

> ID：521707
> 
> 赞同：2
> 
> 时间：2009-02-06T19:05:28.517
> 
> 标签：iphone

我正在使用 InterfaceBuilder 来设置我的应用程序。我有几个由 UINavigationController 控制的视图。在 IB 中，我使用模拟指标设置视图以将元素定位在导航栏下方。

我有一个背景纹理放置在 Main.nib 的窗口对象中，以便在整个应用程序中共享。我希望该纹理在半透明导航栏后面可见。

如果实际 navigationBar 的样式是 BlackOpaque，则在运行应用程序时，各种视图的元素将正确定位在 navBar 下方。

如果我将 NavigationBar 设置为半透明，则视图元素会在应用程序运行时重新定位到状态栏的底部，以便它们在 navigationBar 后面可见，即使它们在各种 nib 文件中正确定位。

我如何打败这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T19:20:14.570

我想出了答案...

如果您不希望将对象向上滑动以定位在半透明 NavigationBar 的后面，请在 IB 中将 navBar 的模拟指标设置为 none，并根据需要定位视图元素。

# php - 使用 CURL 获取内容后将表单序列化为 POST

> ID：521709
> 
> 赞同：-1
> 
> 时间：2009-02-06T19:06:28.233
> 
> 标签：php, forms, curl, serialization, http-post

我想使用 CURL 和 php 发布一个 URL。

网页上有一个大表单，我不想手动复制所有变量并将其放入我的 POST 请求中。

我猜必须有一种方法可以自动序列化表单（使用 DOM 或其他东西），然后只需更改我需要的任何值。

我无法通过谷歌搜索我的出路，所以我想知道是否有人愿意提供帮助。

那么，有没有办法自动序列化一个隐藏在我刚刚从 URL 中提取的一堆 html 内容中的表单？

感谢您的帮助，安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T18:59:50.980

```
$http = new HttpQueryString();
$http->set($_POST);

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,$http->get()); 
```

需要 PECL pecl_http >= 0.22.0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T20:16:00.247

如果您询问如何将浏览器中的表单发送到服务器或如何将发布的表单放入 curl 请求中，我不清楚。从 php 开始，假设表单已经发布，它会很简单：

curl_setopt($handle, CURLOPT_POSTFIELDS, $_POST);

尽管没有以这种方式验证数据。

从 web 端看，不知道为什么要使用 DOM/Javascript 序列化表单，而不是仅仅通过普通帖子提交？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:24:00.247

我不明白这个问题。听起来您想对表单进行屏幕抓取，填写，然后将其发布回您从中获取的页面。是对的吗？

编辑以回应评论：我建议使用 Simple HTML DOM 之类的工具来抓取 CURL 的 HTML（这就是我使用 PHP 抓取的工具）。您选择的库的文档将帮助您弄清楚如何识别表单字段。之后，您需要卷曲表单的操作页面，并将 CURL_POST_FIELDS 属性设置为您要传递给表单的值`urlencode()`，当然是 'd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T20:34:18.523

不确定问题到底是什么，但你要么想做这样的事情：

```
$fields_string = http_build_query($data_to_send);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,$fields_string); 
```

或者你需要调查一下：

```
$html = file_get_html('http://www.thesite.com/thepage.html');
foreach($html->find('input') as $element) 
echo $element->name . '<br>'; 
```

# python - 我怎样才能只得到类变量？

> ID：521710
> 
> 赞同：4
> 
> 时间：2009-02-06T19:06:37.920
> 
> 标签：python

我有这个类定义：

```
class cols:
    name = 'name'
    size = 'size'
    date = 'date'
    @classmethod
    def foo(cls):
        print "This is a class method" 
```

使用 __dict__ 我可以获得所有类属性（成员和变量）。还有“内部属性”（如 __main__）。如何仅获取类变量而不实例化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T19:20:51.793

我不知道一个直接的方法，特别是因为从解释器的 POV 来看，类的方法和任何其他变量之间没有太大的区别（方法有描述符，但就是这样......）。

因此，当您只想要不可调用的类成员时，您必须稍微摆弄一下：

```
>>> class cols:
...     name = "name"
...     @classmethod
...     def foo(cls): pass

>>> import inspect
>>> def get_vars(cls):
...     return [name for name, obj in cls.__dict__.iteritems()
                if not name.startswith("__") and not inspect.isroutine(obj)]
>>> get_vars(cols)
['name'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:11:10.033

```
import inspect
inspect.getmembers(cols) 
```

如果您可以使用检查模块做很多事情：http: [//lfw.org/python/inspect.html](http://lfw.org/python/inspect.html)

# .net - 使用 asp.net MVC 有什么缺点？

> ID：521714
> 
> 赞同：7
> 
> 时间：2009-02-06T19:07:28.467
> 
> 标签：.net, asp.net-mvc

当您使用 asp.net MVC 时，您有什么缺点吗？

**编辑**
如果是的话，你能列出其中的一些缺点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T19:12:19.423

使用 WebForms，您可以拥有大量预先构建的 UI 控件，例如网格、图形工具等……RAD 控件是一个完整的行业。

不幸的是，对于 ASP.NET MVC，很多这样的东西还没有完全存在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T20:17:57.543

最大的缺点是您可能会被迫使用 JavaScript/AJAX 来实现更复杂的表单。例如，如果您有一大堆不直接属于当前视图的小部件（例如，数据网格、附加边表单等），那么管理状态是一件很痛苦的事情。

在 ASP.NET WebForms 中，视图状态会自动处理此问题，因此您可以拥有多个独立的控件回发和触发事件，而不会弄乱页面上的任何其他内容。

在 ASP.NET MVC 中，您需要自己处理所有这些，最简单的方法是将内容移动到浏览器端。

从好的方面来说，在你全部调试好之后，它可以带来更好的整体用户体验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T20:07:43.337

更多信息：[我应该迁移到 ASP.NET MVC 吗？](https://stackoverflow.com/questions/30067/should-i-migrate-to-asp-net-mvc)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T20:51:47.257

这实际上取决于项目的类型。有些人喜欢 MVC，因为 SEO 从干净的 url 中受益，并允许用户通过智能的 url 猜测来智能地“破解”url。MVC 的代价是您将丢失 Web 控件，因此没有 ASP.NET AJAX 和 UI 库中的拖放网格。

概括地说，一个公开可用的网站可能是 MVC 的更好候选者，因为它具有 SEO 优势，而内部或商业应用程序可能会更好地将时间用于开发其他领域。再说一次，如果你想要的只是干净的 URL，你可以通过 URL 重写的方式在没有 MVC 的情况下实现相同的东西，

[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx) [http://msdn.microsoft.com/en-us/library /ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

因此，就使用 MVC 的“缺点”而言，它可能更像是个人的缺点，

*   你想经历做 MVC 的学习曲线吗？
*   你依赖控制吗？你能通过老式的 HTML、CSS 编写同样的代码吗？
*   当您的项目的更好部分将从编码时间中受益时，您可能会在做 MVC 时“浪费时间”吗？
*   如果您只关注 SEO，那么 URL 重写是否是满足您需求的更好方法？

我想说缺点确实与开发人员和项目有关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T20:05:54.870

学习曲线和缺乏预建控件，这将影响 WebForms 开发人员的工作效率。

但是我可以给你一个很好的优势：如果你还没有这样做，你最终将学习 HTML/CSS 和 HTTP 的基础知识，这是进行任何严肃的 Web 开发所需的，而不仅仅是拖放的东西在编辑器中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T19:10:57.053

与网络表单相比，控制状态（输入字段中的文本）之类的东西需要手动处理。假设您“正确”使用它。

总而言之，您必须自己做更多的实际演示工作，这在我看来是一件好事，但在表单密集型应用程序（例如管理）中，它会减慢您的速度。

（我的意思是你可以在 mvc 应用程序中运行大多数普通的 asp.net 东西，但是如果你广泛地这样做，你可能应该只运行 webforms。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T20:00:26.830

ASP.NET 需要 IIS7 路由（即 Windows Server 2008 或 Vista）。您可以在 Server 2003 下的 IIS6 上运行它，但您将失去无扩展路由的酷炫。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-02T17:53:58.587

*   使用这种模式开发应用程序的复杂性很高。
*   不适用于对应用程序的性能和设计有不利影响的小型应用程序。
*   就 servlet 和 JSP 而言，两者通常都包含业务逻辑和表示层。
*   UI作者、业务逻辑作者和控制器作者的孤立开发过程可能会导致各自模块开发的延迟。
*   即使模型解耦，开发者也不能完全忽略模型的视图。如果模型经常发生变化，视图可能会被更新请求淹没。像图形显示这样的视图可能需要一些时间来渲染。因此，视图可能落后于更新请求。参考： http: [//www.careerride.com/MVC-disadvantages.aspx](http://www.careerride.com/MVC-disadvantages.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-08T15:06:14.520

1.  ASP.NET MVC 站点平均需要比传统 ASP.NET 站点多 10 倍的开发时间。
2.  它没有使用强大的 asp.net 控件。

3.  代码不可读。如果您被迫在其他人开发的网站上添加一些增强功能，您会发疯的。

# unit-testing - 将成员函数添加到测试夹具是否表明测试不佳？

> ID：521715
> 
> 赞同：1
> 
> 时间：2009-02-06T19:07:29.573
> 
> 标签：unit-testing

我的测试夹具通常具有无法在构造夹具期间调用的“设置”成员函数，因为它们的参数会根据将要运行的测试而改变。编写它们是为了避免代码重复。

这些功能是否会因为依赖于复杂的非生产方式设置而创建无效测试？它们的存在是否表明我的班级设计不佳且难以构建？这些方法应该由我自己测试的类提供给我的测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T19:16:26.497

这可能只是意味着您需要使用不同的参数对构造进行参数化以测试不同的排列，在这种情况下，我认为它是 100% 合法的。DRY 在测试中的应用与在代码中的应用一样多。

不同的测试构建场景*可能*表明您的班级没有遵循单一职责原则。您*可以*有几种不同的构造方法，因为您需要在几种不同的状态下构造类。显着不同的构造可能意味着测试对象的混合责任。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T19:18:05.637

每个测试都应该针对某个功能测试某种功能。所以如果设置不是生产标准也没关系，只要测试的目的是生产使用。

因此，如果您正在创建一个 Add(int a, int b) 测试，那么 int a 和 int b 的生成方式是否与您在生产环境中完全一样，只要 Add 给出正确的回复。

您还应该为“int a”和“int b”的生成创建一个测试，以便您知道它们何时被创建，它们将成为预期的对象。

我希望这很清楚。如果没有，我会编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:16:57.343

如果您对每个测试都有不同的设置，那么您可能需要在所需的测试中运行设置。在您的设置中包含大量代码可能表明您正在使用集成测试而不是单元测试。使用模拟对象可以大大减少您的测试设置逻辑。

单元测试应该有单一的责任，并且易于理解和维护，我认为参数化设置可能会损害这个原因。

# excel - 从 SSRS 导出到没有标题的 Excel

> ID：521719
> 
> 赞同：13
> 
> 时间：2009-02-06T19:07:54.767
> 
> 标签：excel, reporting-services, reportingservices-2005

有没有办法从 SSRS 报告导出到 excel，以便仅在 excel 导出中省略报告第一页上显示的标题？目前，它在工作表的顶部添加了一个冻结的框架。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T10:35:04.287

**更新**

[另请参阅我关于如何添加去除标题的新 Excel 呈现选项的](https://stackoverflow.com/questions/3048363/ssrs-2005-set-simplepageheaders-on-the-report-instead-of-the-server/3058576#3058576)答案

原答案如下：

如果您可以获得 Excel 输出的 URL（某些版本的 SSRS 让浏览器显示它），您可以在末尾附加一些代码：

```
&rc:SimplePageHeaders=True 
```

这将删除标题。这是一个派上用场的手动 hack，或者您可以将其添加到 rsreportserver.config 文件中

```
<Render>
    <Extension Name="EXCEL" Type="Microsoft.ReportingServices.Rendering.ExcelRenderer.ExcelRenderer,Microsoft.ReportingServices.ExcelRendering">
        <Configuration>
            <DeviceInfo>
                <SimplePageHeaders>True</SimplePageHeaders>
            </DeviceInfo>
        </Configuration>
    </Extension>
</Render> 
```

如果没有[Aspose.Cells](http://www.aspose.com/categories/ssrs-rendering-extensions/aspose.cells-for-reporting-services/default.aspx)或[OfficeWriter](http://officewriter.softartisans.com/OfficeWriter-252.aspx) - 我没有使用过这两种产品，我只知道它们的存在。

或者对于真正勇敢的人，您可以[创建自己的自定义渲染器](http://msdn.microsoft.com/en-us/magazine/cc163840.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T19:45:13.257

不幸的是，Reporting Services 2000、2005 和 2008 无法根据用户选择的呈现方法更改报表的结果。这意味着您唯一的选择是为报表提供一个隐藏或显示标题的参数。

如果用户通过报表管理器访问报表，那么这通常不是一个合理的解决方案，也没有很好的解决方案。如果您正在运行将报表呈现到 Excel 并通过电子邮件、文件共享或 SharePoint 传递报表的订阅，则此方法足以解决问题。

如果有人为此编写了解决方案，我愿意为自定义渲染方法扩展支付少量费用。但是到目前为止，我还没有看到一套代码可以达到这个目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T10:33:02.743

关于我在克里斯的回答中应用配置模式的经验的几点说明：

1.  如果您的报告是由报告向导生成的，请注意向导将报告的“标题”文本放在正文中，而不是标题中。因此，请确保您的标题实际上位于标题部分中。

2.  我发现使用 VS 2008 报告预览不会显示导出更改。但是，当我返回浏览我的网页（其中包含一个 ReportViewer 控件）时，我按了 Ctrl+F5，然后它按预期导出。

3.  不要忘记重新部署您的报告。

# javascript - 反射式 Web 应用程序 (WebIDE)

> ID：521723
> 
> 赞同：3
> 
> 时间：2009-02-06T19:08:39.697
> 
> 标签：javascript, reflection

## 前言

所以，这个问题已经回答了，但由于这是我对这个项目的第一个问题，我将继续在我为这个项目提出的其他问题中引用它。

对于来自另一个问题的任何人，这里是基本想法：创建一个可以更轻松地创建其他 Web 应用程序或网站的 Web 应用程序。为此，您基本上会创建一个带有“小部件”的模块化站点，然后将它们组合到最终的显示页面中。如果您使用 Prototype 或 .prototype.fn ，则每个小部件可能都有自己的一组函数组合在一个类中。

### 目前

我正在努力了解基础知识：编辑 CSS、创建用户 JavaScript 函数并动态查找它们的名称/输入，以及项目的其他关键技术方面。很快，我将为我希望创建的功能创建一个粗略的时间表。在我这样做之后不久，我打算创建一个博客，让每个人都了解项目的状态。

* * *

### 原始问题

大家好，我目前正在尝试将我对个人项目的想法正式化（以后可能会变成专业项目）。该概念是一个反射式 Web 应用程序。换句话说，一个可以构建其他 Web 应用程序并被积极用于构建和改进自身的 Web 应用程序。将其视为一种用于创建 webapps 的 webapp IDE。

因此，在我开始进一步解释之前，我要向大家提出的问题是：**您认为在此过程中最困难的挑战是什么？从哪里开始最好？**

现在让我试着在这里简要解释一下这个概念的一些方面。我希望这个应用程序尽可能接近所见即所得，因为您有一个显示区域，可以显示网站的全部或部分内容。您应该可以自由浏览它以到达您想要处理的区域并使用 JavaScript 调试器/控制台来询问“如果......会发生什么？” 问题。

我打算通过组件构建 webapps。换句话说，结果将是一个非常模块化的 web 应用程序，这样您就可以轻松地对小规模或大规模的东西进行调整（通常它应该比在`<insert editor of choice>`.

网站/webapp 完成后，该 webapp 应该能够生成安装和运行创建的网站/webapp 所需的所有代码（因此数据库的 CSS、JavaScript、PHP 和 PHP 安装程序）。

以下是我迄今为止提出的几个主要挑战：

*   动态更改 CSS
*   在 JavaScript 中实现反射
*   准确简洁的 DOM 树查看器
*   允许用户选择 JavaScript 库（即[Prototype](http://www.prototypejs.org/)、[jQuery](http://www.jquery.com/)、[Dojo](http://www.dojotoolkit.org/)、[extJS](http://www.extjs.com/)等）

也欢迎任何其他意见和建议。

**编辑 1：**我真的很喜欢 AppJet 的想法，我会在本周末有时间的时候详细检查一下。然而，我唯一担心的是这应该创建可以进入其他网络服务器的代码，所以虽然 AppJet 可能是我更快地开发这个应用程序的好方法，但我仍然认为我必须为我的用户生成 PHP 代码放在他们的服务器上。

另外，当我觉得它已经准备好供 beta 测试者使用时，我肯定会在本网站上免费发布给所有人。但我在想，在测试结束后，我应该遵循类似于 git 的方案：开源应用程序免费，私有/专有应用程序需要花钱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T19:27:38.223

**从概念上讲，您将构建小部件、小部件工厂和工厂制造工厂。**

因此，您必须找到在制作小部件、小部件之间、工厂内以及多个小部件制造工厂之间可能发生的所有不同类型的交互，以获得一个想法。

一些东西要保持在抽象的距离上有多远？

**我认为您需要能够为应用程序空间本身完全抽象几层。然后你必须为这一切构建一些管理工具。**

**- 演示、工作流程和数据层。**

**演示文稿：您要么收到反馈，要么投入投入。** 通常是单击或输入内容的结果。一个简单的示例是在数据库中制作动态 Web 表单。您必须在数据库中存储关于它来自/来自哪里的信息？这可能构成表示层。这可能是最好的练习，以了解您可能需要做什么。

**工作流：构建一个简单的工作流引擎是明智的。** 我以 e 为模型构建了我在 2 天内启动并运行的*Windows 工作流。*它可以设置应该运行的初始事件等。从设计师的角度来看，我会想象一个 visio 类型的程序来链接这些事件。然后，工作流中的事件将驱动表示层。

**数据：** 您必须与应用程序中的数据一样多地存储有关应用程序的数据。因此，表单、事件、数据结构可以通过存储 xml 文档来完成，具体取决于您是否需要处理表单中的任何数据。应用程序的数据也可以存储在您填写的空 xml 模板或实际表中。此时，您必须创建一个表创建例程，该例程将为应用程序维护一个表以符合规范。 *谷歌在他们的谷歌数据库在线上有类似的东西。*

希望有帮助。分享你最终的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T19:14:33.960

为什么使用 PHP？

[Appjet](http://appjet.com/)在客户端和服务器端使用 100% Javascript 和 rhino 做了非常相似的[事情](http://www.mozilla.org/rhino/)。

这使程序员更容易使用你的服务，也更容易部署。事实上，甚至他们的数据存储技术也使用了 Javascript（简单的本地对象），这是一个非常强大的想法。

# apache-flex - 自动化 Flex 应用程序的 QA

> ID：521729
> 
> 赞同：22
> 
> 时间：2009-02-06T19:11:35.417
> 
> 标签：apache-flex, automated-tests, qa, qtp, flexunit

我有一个需要测试的 Flex 应用程序，我们的 QA 部门非常支持使用某种形式的自动测试工具，例如 HP 的 QuickTest Pro (QTP)。但是，如果您希望自动化一些自制组件，QTP 要求您编写一些自定义代码......不幸的是，我们有一些我们没有源代码的 3rd-party 组件，所以我们不能没有真正的自定义代码拥有第三方组件的源代码。

是否有任何现有的框架和/或工具可以让我自动化测试而无需编写非程序员可以使用的自定义代码（即不知道指针是什么的 QA 人员）

我快速浏览了一下 Flex-Monkey（一个免费的开源软件），它似乎是一个很有前途的项目，但它仍处于起步阶段，我很快就需要一些东西（即昨天）

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T00:48:18.077

我刚刚发布了 SeleniumFlex API 的新版本，将其升级到 0.2.5。

这修复了许多重大问题，并可能使 API 成为 Flex 测试自动化的最佳免费替代品。您可以在 sourceforge 上获得它：[Selenium-Flex API](https://sourceforge.net/projects/seleniumflexapi/)

编辑更新：

该项目已移至 Google 代码：[http ://code.google.com/p/sfapi/](http://code.google.com/p/sfapi/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T21:16:18.510

不幸的是，Flex/Flash 自动化目前还不是很强大。QTP 垄断了唯一的“官方”解决方案。Adobe 需要在这里做更多的事情:(

然而，一个自动化工具非常有趣，并且完全回避了传统的 API 自动化模式。查看[Eggplant](http://www.testplant.com/)，它使用图形位图来确定单击视觉元素的方式/位置/时间。这意味着您的“脚本”现在是文本 + 位图，但这也意味着它几乎可以测试任何东西。

为了充分披露，我是 Selenium Remote Control 的创始人之一，过去在 Selenium 和 Flash 自动化方面做了很多工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:13:06.053

AFAIK 以下工具目前支持 Flex GUI 自动化（按字母顺序）：

1.  快速测试专业版
2.  Ranorex
3.  Rational 功能测试器
4.  RIATest
5.  硒
6.  SilkTest
7.  测试完成

以上任何一项都需要您“检测”自定义组件以支持完全自动化。但是，根据您的组件的“自定义”程度，您可能会发现您可能不需要做任何事情，它们只会由它们的基类表示。所有内置的 Flex 组件都已经“仪表化”了。

披露：我是 RIATest 团队成员，如果您需要仅 Flex 的自动化，我自然倾向于相信这是最好的工具。它是唯一专注于为 Flex 提供最佳自动化的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T15:04:48.350

（在游戏中来得很晚）

现在的另一个选择是 Borland 的[SilkTest](http://www.borland.com/us/products/silk/silktest/index.html)。他们最近添加了对 Flex 的支持，而且看起来效果很好。

我的公司尝试了其他几个选项，包括[RIATest](http://www.riatest.com/)；但最终使用 SilkTest，因为我们的 QA 部门。已经接受过培训。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T21:01:30.280

*   查看[Flex 示例：自动化 API 示例应用程序](http://www.adobe.com/devnet/flex/samples/custom_automated/)
*   [Selenium](http://seleniumhq.org/)有一个 Flex 插件
*   [RIATest](http://www.riatest.com/)看起来也很有希望

没有亲自尝试过任何一个。只是一些谷歌搜索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-28T04:19:33.797

我知道这篇文章在游戏中有点晚了（差不多一个月），但如果你还没有这样做，请查看[FlexMonkey](http://code.google.com/p/flexmonkey/)。我目前正在研究工作中的 Flex 自动化，这是我遇到的最有前途的 Flex 测试套件。

注意：[Selenium Flex](http://sourceforge.net/projects/seleniumflexapi/)仅与在 FireFox 2.x 上运行的 Selenium 兼容。它与在 FF 3 上运行的最新测试版不兼容。因此，我发现它不是一个不充分的解决方案。

# frameworks - 是否有非程序员表单创建的系统或框架？

> ID：521732
> 
> 赞同：4
> 
> 时间：2009-02-06T19:11:53.323
> 
> 标签：frameworks

有人知道非程序员表单创建的系统或框架吗？不是一个完整的实现，而是处理设计器方面的东西和处理填充显示的东西。我们将要做的所有逻辑。也许只是一对小部件。

我们有一个客户端-服务器应用程序，普通用户可以在其中输入和修改胖客户端中的数据，我们希望允许客户使用另一个胖客户端应用程序更新和创建表单，而不是每次需要更改字母时都打电话给我们. 我们希望在实现系统使用的各种钩子和函数时做一些显示位。

我们是一家 java 商店，但我们希望我们愿意用另一种语言编写这些客户端，如果这样会更容易的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-30T18:13:11.193

可能带有 XForm 模式的 Xopus 可以工作。

[http://xopus.com/](http://xopus.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:16:59.460

尝试搜索 XForms 库和工具。XForms 是一种用于定义表单的新标准格式，并且有一些可用的库和工具。这些我自己都没有尝试过。

编辑：这看起来很有趣：[http ://www.orbeon.com/forms/builder](http://www.orbeon.com/forms/builder)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T20:42:11.927

好吧，您是一家 Java 商店，所以这可能不是最适合您的工具，但从您的描述来看，您看起来像是 Infopath 的经典案例：

[http://office.microsoft.com/en-us/infopath/default.aspx](http://office.microsoft.com/en-us/infopath/default.aspx)

# .net - 存储过程和 LINQ，Dmbl 文件无法解释结果集

> ID：521736
> 
> 赞同：4
> 
> 时间：2009-02-06T19:12:21.200
> 
> 标签：.net, linq, stored-procedures

我有几个存储过程，当添加到我的 dbml 时，似乎在幕后 LINQ 无法解释结果集，只会将结果映射为 int。然后我必须自己创建结果类，这很痛苦，但每次我添加到我的 dbml 时我都必须去更改设计器文件，因为它会重新加载它并将结果映射回每个这些的 int存储过程。

这是我的存储过程的问题，LINQ 无法解释然后为我创建结果类。或者这是 LINQ 的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T19:18:48.613

您在存储过程中使用临时表吗？这会导致问题（问题实际上是 SQL）。这是一篇关于它的[博客文章](http://svenmaes.blogspot.com/2008/08/linq-to-sql-stored-procedure-returns.html)，解决方案是在将 sproc 添加到 DBML 的同时临时替换 sproc。

不幸的是，我认为没有更好的解决方案......

编辑：[这](https://stackoverflow.com/questions/496195/how-do-i-get-linq-to-sql-to-recognize-the-result-set-of-a-dynamic-stored-procedur)是其他人遇到同样的问题，解决方案略有不同。

再次编辑：[这](http://blog.csdn.net/lchstudy/archive/2008/11/04/3215979.aspx)是一个更好的解释和一个解决方案，它不涉及在完成后更换存储过程；它确实在存储过程中包含额外的代码，用于检测何时设置了 FMTONLY 并暂时禁用它。好主意，我以后可能会尝试。

# c++ - 何时在 C++ 中使用朋友类

> ID：521754
> 
> 赞同：38
> 
> 时间：2009-02-06T19:16:44.670
> 
> 标签：c++, keyword, friend

> **可能重复：**
> [什么时候应该在 C++ 中使用“朋友”？](https://stackoverflow.com/questions/17434/when-should-you-use-friend-in-c)

我在复习我的 C++（我是一名 Java 开发人员）时遇到了`friend class`一个我已经忘记了一段时间的关键字。这是只是厨房水槽一部分的功能之一，还是有充分的理由这样做，而不仅仅是香草吸气剂？我理解不同之处在于它限制了谁可以访问数据，但我想不出有必要这样做的场景。

注意：我见过一个类似的问题，但我特别想问的是，这只是一个高级功能，除了让人们在看你的代码之前感到困惑，直到他们意识到你在做什么之外，并没有增加任何真正的价值？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-06T19:45:15.893

我同意这样的评论，即如果使用得当，friend 关键字可以提高封装性。我只想补充一点，朋友课程最常见的（合法的！）用途可能是测试。您可能希望测试程序类比其他客户端类具有更大程度的访问权限。测试人员类可能有充分的理由查看故意对其他类隐藏的内部细节。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-06T19:20:27.380

根据我的经验，与打破封装的频率相比，真正增强数据封装的朋友（或可变的，有点相似）的情况很少见。

它对我来说很少有用，但是当我使用它时，我不得不将一个以前是单个类的类拆分为两个需要访问一些常见数据/功能的单独类。

编辑以回应 Outlaw Programmer 的评论：我们完全同意这一点。除了在拆分类后加好友之外，另一种选择是制作公共访问器，这有时会破坏封装！我认为有些人认为友好的类以某种方式破坏了封装，因为他们经常看到它使用不当，而且很多人可能永远不会看到正确使用它的代码，因为它很少见。不过，我喜欢你的陈述方式——友好是一个很好的中间立场，介于不允许你分开班级和让公众可以接触到所有东西之间。

编辑以回应 David Thornley：我同意 C++ 允许您执行此类操作的灵活性是 C++ 设计决策的结果。我认为这使得理解在灵活的语言中通常是好还是坏的风格变得更加重要。Java 的观点是，您永远不应该有友元类，因此不提供这些类，但作为 C++ 程序员，我们作为社区有责任定义这些非常灵活但有时被误用的语言结构的适当使用。

编辑以回应 Tom：Mutable 并不一定会破坏封装，但我在现实生活中看到的许多 mutable 关键字的使用都会破坏封装，因为看到人们用 mutable 破坏封装比 to 更常见实际上首先要找到并理解 mutable 的正确用法。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-06T20:27:54.090

当您希望一个类（工厂）负责创建另一个类（类型）的实例时。您可以将 Type 的构造函数设为私有，从而确保只有 Factory 可以创建 Type 对象。当您希望将检查委托给可以用作验证器的其他类时，它很有用。只是一种使用场景。

PS真的缺少C#中的“朋友”关键字......

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-06T20:24:18.577

具体实例将是一个类工厂，您希望一个类仅通过另一个工厂类创建，因此您将构造函数设为私有，并且工厂类成为生产类的朋友。

它有点像一个 2" 12 点 3/4" 驱动器插座 - 不是很常见，但当你需要它时，你会非常高兴拥有它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-06T19:24:57.697

帮助[Memento 设计模式](http://sourcemaking.com/design_patterns/memento/c++/1)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T20:26:57.353

关于朋友的常见问题解答部分：[这里](http://www.parashift.com/c++-faq-lite/friends.html)

FQA关于朋友的部分：[这里](http://yosefk.com/c++fqa/fqa.html#fqa-friend)

关于朋友的两种不同观点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T19:23:22.303

我将`friend`构造视为应该在极少数情况下使用的语言特性之一，但这并不意味着它毫无用处。有几种模式需要制作`friend`课程，其中许多已经在该站点右侧的“相关”栏中。====>

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T20:15:39.780

当您有多个类和/或函数一起工作以提供相同的抽象或接口时，使用友谊。经典的例子是实现某种数值类，并且所有非成员运算符函数（*、-、+、<< 等）都被赋予友谊，以便它们可以处理数值类的私有数据。

这样的用例有些少见，但确实存在，friend 很有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-15T18:15:58.090

这是几个例子中的一个，我敢肯定，朋友类可以在不考虑封装原因的情况下合法使用。

MyClass 继承自 GeneralClass。MyClass 变大了，所以你创建了 HelperClass 来封装 MyClass 的一些功能。但是，HelperClass 需要访问 GeneralClass 中的一些受保护函数才能正确执行其功能，因此您将 HelperClass 设为 MyClass 的朋友。

这比公开受保护的函数要好，因为它们不需要对每个人都可用，但它有助于保持您的代码以 OOP 方式组织，以防止 MyClass 变得过于复杂。这是有道理的，因为尽管 HelperClass 与 MyClass 没有通过继承具体相关，但它确实与它有某种逻辑联系，体现在代码和设计中，作为“朋友”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T16:18:50.187

我总是（并且只）使用朋友对私有方法进行单元测试。我能想到的唯一另一种方法是使用大量测试方法加载公共接口，这太混乱了，所以我更喜欢将测试方法隐藏在单独的测试类中。

像这样的东西：

```
class cMyClassTest;

class cMyClass
{
public:
.....

private:
friend cMyClassTest;
int calc();     // tricky algorithm, test carefully

};

class cMyClassTest
{
public:
int test_calc()
{
    cMyClass test;
    ....
    int result = test.calc();

    if( result == 42 )
        return 1;
    return 0;
}
}; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-27T13:33:37.010

朋友类的意思是我们都知道它是从其他类访问变量的值，所以它主要用于使用这些值，所以我们不需要将其他类的值返回给主函数，然后将主函数返回到所需的类成员函数，但它具有一个班级的问题是其他班级的朋友，那么朋友班级应该在该班级的下方

# python - 有没有办法在 pywin32 中解码数字 COM 错误代码

> ID：521759
> 
> 赞同：29
> 
> 时间：2009-02-06T19:18:01.503
> 
> 标签：python, windows, excel, com, pywin32

这是最近运行的一个用 Python 编写的不可靠应用程序的堆栈跟踪的一部分，该应用程序控制着另一个用 Excel 编写的应用程序：

```
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146788248), None) 
```

显然出了点问题……但是什么？[1] 这些 COM 错误代码似乎过于神秘。

如何解码此错误消息？是否有表格可以让我将此数字错误代码转换为更有意义的内容？

[1] 我实际上知道在这种情况下出了什么问题，它试图访问没有 Name 属性的 Range 对象上的 Name 属性...并非所有错误都这么容易找到！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-10T05:01:04.257

你没有做错任何事。堆栈跟踪中的第一项（数字）是 COM 对象返回的错误代码。第二项是与错误代码相关的描述，在这种情况下是“发生异常”。pywintypes.com_error 已经为您调用了相当于 win32api.FormatMessage(errCode) 的内容。我们将在一分钟内查看第二个数字。

*顺便说一句，您可以使用 Visual Studio 中的“错误查找”实用程序 (C:\Program Files\Microsoft Visual Studio 9.0\Common7\Tools\ErrLook.exe) 作为快速启动板来检查 COM 错误代码。该实用程序还为您调用 FormatMessage 并显示结果。并非所有错误代码都适用于这种机制，但很多都可以。这通常是我的第一站。*

COM 中的错误处理和报告有点混乱。我会试着给你一些背景。

所有 COM 方法调用都将返回一个称为 HRESULT 的数字代码，它可以指示成功或失败。COM 中所有形式的错误报告都建立在此之上。

这些代码通常以十六进制表示，尽管有时您会看到它们是大的 32 位数字，就像在您的堆栈跟踪中一样。对于常见的结果和问题，有各种预定义的返回码，或者对象可以针对特殊情况返回自定义的数字码。例如，值 0（称为 S_OK）通常表示“无错误”，而 0x80000002 是 E_OUTOFMEMORY。有时 HRESULT 代码由对象返回，有时由 COM 基础结构返回。

COM 对象还可以选择通过实现称为 IErrorInfo 的接口来提供更丰富的错误信息。当一个对象实现 IErrorInfo 时，它可以提供有关所发生事情的各种详细信息，例如详细的自定义错误消息，甚至是描述问题的帮助文件的名称。在 VB6 和 VBA 中。该`Err`对象允许您访问所有这些信息（`Err.Description`等）。

更复杂的是，后期绑定的 COM 对象（使用称为 COM 自动化或 IDispatch 的机制）添加了一些需要剥离以获取信息的层。Excel 通常通过后期绑定进行操作。

现在让我们再看看你的情况。作为第一个数字，您得到的是一个相当通用的错误代码：DISP_E_EXCEPTION。*注意：您通常可以通过谷歌搜索数字来找出 HRESULT 的正式名称，尽管有时您必须使用十六进制版本才能找到任何有用的信息。*

以 DISP_ 开头的错误是 IDISPATCH 错误代码。该错误大致意味着“对象抛出了一个 COM 异常”，更多信息打包在其他地方（尽管我不太清楚在哪里；我必须查一下）。

根据我对 pywintypes.com_error 的了解，消息中的最后一个数字是异常期间对象返回的实际错误代码。这是您从 VBA 中获得的实际数字代码`Err.Number`。

不幸的是，第二个代码 -2146788248 (0x800A9C68) 在为自定义应用程序定义的错误消息保留的范围内（在 VBA 中：）`VbObjectError + someCustomErrorNumber`，因此没有集中的含义。对于不同的程序，相同的数字可能意味着完全不同的东西。

在这种情况下，我们走到了死胡同：

> 错误代码是“自定义”，应用程序需要记录它是什么，除了 Excel 没有。此外，Excel（或错误的实际来源）似乎没有通过 IErrorInfo 提供更多信息。

Excel 因来自自动化的神秘错误代码和导致它们的晦涩情况而臭名昭著（至少对我而言）。对于可以考虑“设计时错误”（“您应该比调用对象中不存在的方法”）的错误尤其如此。而不是一个很好的“无法读取名称属性”，而是“***运行时错误'1004'：应用程序定义或对象定义错误***”（我只是通过尝试从 VBA 访问范围上的名称属性得到的在 Excel 中）。这不是很有帮助。

问题不是在 Python 上路由，也不是在 Excel 的接口上。Excel 本身并没有解释发生了什么，甚至对 VBA 也是如此。

但是，上述一般程序仍然有效。如果将来您从 Excel 中收到错误，您可能会收到一条更好的错误消息，您可以以相同的方式跟踪。

祝你好运！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-03-16T14:49:34.277

像这样做：

```
try:
    [whatever code]
except pythoncom.com_error as error:
    print(win32api.FormatMessage(error.excepinfo[5])) 
```

有关在此处消化 pythoncom.com_error 对象的更多信息：[https ://web.archive.org/web/20170831073447/http://docs.activestate.com/activepython/3.2/pywin32/com_error.html](https://web.archive.org/web/20170831073447/http://docs.activestate.com/activepython/3.2/pywin32/com_error.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T19:31:24.393

是的，试试 win32api 模块：

```
import win32api
e_msg = win32api.FormatMessage(-2147352567) 
```

您可以获取从异常返回的任何代码并将它们传递给 FormatMessage。您的示例有 2 个错误代码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-17T18:15:44.177

特别是对于 pythoncom，产生的错误代码不仅仅是神秘的。这是因为当正确的表示是 32 位无符号整数时，pythoncom 在内部将它们表示为 32 位有*符号*整数。因此，您最终在堆栈跟踪中看到的转换是不正确的。

特别是，根据pythoncom，您的例外是-2147352567，而您的（因为没有更好的词）Err.Number 是-2146788248。

但是，这在查看特定错误时会导致一些问题，如下所示：

```
DISP_E_EXCEPTION = 0x80020009
#...
#except pywintypes.com_error as e:
#    print repr(e)
#    #pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146788248), None)
#    hr = e.hresult

hr = -2147352567
if hr == DISP_E_EXCEPTION:
    pass #This never occurs
else:
    raise 
```

要了解为什么会出现问题，让我们看看这些错误代码：

```
>>> DISP_E_EXCEPTION = 0x80020009
>>> DISP_E_EXCEPTION
2147614729L
>>> my_hr = -2147352567
>>> my_hr == DISP_E_EXCEPTION
False 
```

同样，这是因为 python 看到声明为正数的常量，而 pythoncom 的错误声明将其解释为负数。当然，最明显的解决方案失败了：

```
>>> hex(my_hr)
'-0x7ffdfff7' 
```

解决方案是正确解释数字。幸运的是，pythoncom 的表示是可逆的。我们需要将负数解释为 32 位有符号整数，然后将其解释*为*无符号整数：

```
def fix_com_hresult(hr):
    import struct
    return struct.unpack("L", struct.pack("l", hr))[0]

>>> DISP_E_EXCEPTION = 0x80020009
>>> my_hr = -2147352567
>>> my_hr == DISP_E_EXCEPTION
False
>>> fixed_hr = fix_com_hresult(my_hr)
>>> fixed_hr
2147614729L
>>> fixed_hr == DISP_E_EXCEPTION
True 
```

因此，将它们放在一起，您需要对来自 pythoncom 的结果运行 fix_com_hresult()，基本上是一直运行。

因为通常在检查异常时需要这样做，所以我创建了这些函数：

```
def fix_com_exception(e):
    e.hresult = fix_com_hresult(e.hresult)
    e.args = [e.hresult] + list(e.args[1:])
    return e

def fix_com_hresult(hr):
    import struct
    return struct.unpack("L", struct.pack("l", hr))[0] 
```

然后可以按照您的期望使用它：

```
DISP_E_EXCEPTION = 0x80020009
try:
    #failing call
except pywintypes.com_error as e:
    print repr(e)
    #pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146788248), None)
    fix_com_exception(e)
    print repr(e)
    #pywintypes.com_error: (2147614729L, 'Exception occurred.', (0, None, None, None, 0, -2146788248), None)
    if e.hresult == DISP_E_EXCEPTION:
        print "Got expected failure"
    else:
        raise 
```

我找不到列出所有 HRESULT 的 MSDN 文档，但我发现了这个：[http ://www.megos.ch/support/doserrors_e.txt](http://www.megos.ch/support/doserrors_e.txt)

此外，既然你有它， fix_com_hresult() 也应该在你的扩展错误代码（-2146788248）上运行，但正如 Euro Micelli 所说，它在这个特定情况下对你没有帮助:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-17T14:09:05.487

还没有人提到[Exception](http://timgolden.me.uk/pywin32-docs/com_error.html)`strerror`的属性。这将返回错误代码的结果。所以不要像这样自己做[`pywintypes.com_error`](http://timgolden.me.uk/pywin32-docs/com_error.html)`FormatMessage`

```
try:
    [whatever code]
except pythoncom.com_error as error:
    print(win32api.FormatMessage(error.excepinfo[5])) 
```

你可以这样做：

```
try:
    [whatever code]
except pythoncom.com_error as error:
    print(error.strerror) 
```

`None`请注意，如果您有非标准的，它将返回`HRESULT`:(

# mysql - Web 应用程序后端的版本化（大型）文本存储将用于什么？

> ID：521761
> 
> 赞同：0
> 
> 时间：2009-02-06T19:18:38.320
> 
> 标签：mysql, git, version-control, clob

和我的一个朋友争论——我提倡 git/hg，他提倡 CLOBs MySQL。你的偏好是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T19:23:08.060

我相信这完全完全取决于您的要求。如果我的主要要求是简单地保留一个版本控制的副本，那么总是有一个备份，那么你可以使用 GIT、CVS 或 Subversion，无论你喜欢什么。但是，如果我要为业务用户存储大型文档，这些文档经常被访问并且需要被搜索，那么存储在数据库中可能是最好的方法。我对 MySQL 不太熟悉，但在我的 Oracle 经验中，当我将大型业务文档存储在 BLOB 列中时，猜测要少得多。结合事实，Oracle 可以为我搜索那些 BLOB 的文本索引，使其成为我为我的营业场所编写的应用程序的一个有吸引力的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T19:32:40.583

您应该遵循黄金法则，根据您要进行的预期查询来组织数据存储。因此，它可以只是 NAS、git 或 mercurial 后端、数据库或自定义解决方案上的普通文件。这取决于您查询/更新它们的方式/频率。

因此，鉴于您缺乏上下文，没有办法选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T19:25:23.780

根据大小以及您将拥有的数量，我认为您将希望避免将它们存储在任何数据库中。版本控制和文件系统非常擅长存储大型数字对象。关系数据库不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:40:25.577

通常，数据库比工具更容易交互。您可能想考虑使用像 CouchDB 或 Apache Jackrabbit 这样的文档版本控制工具。

# php - PHP：如何检查 var 是否已被初始化？当 var 设置为 NULL 时，isset 返回 false

> ID：521768
> 
> 赞同：2
> 
> 时间：2009-02-06T19:20:15.163
> 
> 标签：php

```
<?php
    $var = NULL;

    var_dump(isset($var)); // bool(false)
    var_dump(isset($unset_var)); // bool(false)
?> 
```

isset($var) 应该返回 TRUE，因为它已被设置为 NULL。

有没有办法检查这个？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T20:05:59.737

使用 get_defined_vars() 获取当前范围内定义的变量数组，然后使用 array_key_exists() 对其进行测试；

编辑：

如果你想要一个函数来测试存在，你可以像这样创建一个：

```
function varDefined($name,$scope) {
  return array_key_exists($name, $scope);
} 
```

并在任何给定范围内使用：

```
$exists = varDefined('foo',get_defined_vars()); 
```

应该适用于任何范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:24:17.027

不是很漂亮，但是...

```
array_key_exists('var', $GLOBALS); 
```

（您不能使用`@is_null($var)`，因为无论哪种方式它的计算结果都是 true [并且使用 @ 运算符抑制错误并不是一个很好的做法...]）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:25:04.920

如果它在全局范围内，您可以尝试检查该键是否存在于 $GLOBALS 超全局中（使用 array_key_exists()）。

但如果你需要知道这一点，你可能做错了什么:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:26:41.140

如果它是全球性的，你可以这样做：

```
if(array_key_exists('var', $GLOBALS)) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-06T19:24:48.773

任何未设置的 var 都将评估为 null：

```
php > $a = null;
php > var_dump($a === null);
bool(true)
php > var_dump($a === $b);
bool(true) 
```

（使用交互式控制台 - php -a ）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-06T19:26:14.747

默认情况下变量不是初始化为NULL吗？因此，未初始化的和已设置为 NULL 的之间并没有真正的区别。

# c# - 如何将 void * C API 导入 C#？

> ID：521774
> 
> 赞同：10
> 
> 时间：2009-02-06T19:21:20.777
> 
> 标签：c#, pinvoke, dllimport

鉴于此 C API 声明，如何将其导入 C#？

```
int _stdcall z4ctyget(CITY_REC *, void *); 
```

我已经能够做到这一点：

```
 [DllImport(@"zip4_w32.dll",
        CallingConvention = CallingConvention.StdCall,
        EntryPoint = "z4ctygetSTD",
        ExactSpelling = false)]
    private extern static int z4ctygetSTD(ref CITY_REC args, void * ptr); 
```

自然在 C# 中“void *”不会编译。

一些谷歌搜索表明它应该被翻译为“对象”。这似乎应该工作。但其他人指出“Void * 在 C/C++ 术语中称为函数指针，在 C# 术语中是委托”。这在这里没有多大意义，因为它将委托给什么？通过谷歌搜索找到的对其他 API 的一些类似调用使用相应 API 中的其他函数。但是在这个 API 中，没有其他调用是有意义的。

调用的文档显示了一个示例：

```
z4ctyget(&city, “00000”); 
```

这似乎表明即使是静态值也可以传递。

它将用对象代替 void * 进行编译。我不知道这是否正确，我也没有机会对其进行测试（许可问题）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T19:26:49.660

对于 void* 参数，您可以只使用 IntPtr

```
 [DllImport(@"zip4_w32.dll",
        CallingConvention = CallingConvention.StdCall,
        EntryPoint = "z4ctygetSTD",
        ExactSpelling = false)]
    private extern static int z4ctygetSTD(ref CITY_REC args, IntPtr ptr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:31:43.270

如果您将班级标记为不安全，您也可以使用 void*。

这实际上取决于 API 在该参数中查找的内容。

您可以添加 IntPtr 或 Object* 以通过编译器，但在调用它时仍需要将正确的数据传递给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T13:37:42.327

据我所知，z4ctyget 的 C 声明是：

```
int z4ctyget(CITY_REC *cityrec, char *zipcode); 
```

第二个参数是一个 5 个字符的 ANSI 字符串，表示您要开始搜索的邮政编码，或者从文件开头开始的“00000”。所以你的声明应该是：

```
[DllImport(@"zip4_w32.dll", CharSet = CharSet.Ansi)]
private extern static int z4ctygetSTD(ref CITY_REC args, string zipcode); 
```

# c# - 我应该使用带参数的方法还是函数？

> ID：521785
> 
> 赞同：0
> 
> 时间：2009-02-06T19:24:24.407
> 
> 标签：c#, methods

我有一个哲学编程问题。假设我有一个名为Employees 的类。员工拥有从数据表中设置的业务成员。为了填补这一点，我使用了一个方法，该方法接受一个员工类的实例，遍历一个 dataTable，并设置传递给它的实例的成员。例如：

```
public void GetEmployees(objEmployee)
{
  //the function I am calling returns a dataTable of all the employees in the db.
  dim dt as DataTable = dbEmployees.GetEmployees(); 

   foreach(DataRow drow in dt.rows) 
     {
        objEmployee.Name = drow["Name"].ToString();
        objEmployee.ID = drow["ID"].ToString();
     }
} 
```

然后我会在我的 UI 逻辑中调用这样的代码：

```
public void GetEmployees()
{
   Employees employee = new Employees();

   employee.GetEmployees(employee);
} 
```

我的问题是，将我的类实例传递给一个方法并像我正在做的那样更改属性是否可以接受，或者通过这样的函数来实现它是否更面向对象：

```
 public Employees GetEmployees()
  {
     Employees objEmployee = new Employees();

  //the function I am calling returns a dataTable of all the employees in the db.
  dim dt as DataTable = dbEmployees.GetEmployees(); 

   foreach(DataRow drow in dt.rows) 
     {
        objEmployee.Name = drow["Name"].ToString();
        objEmployee.ID = drow["ID"].ToString();
     }

  return objEmployee

} 
```

然后我会这样称呼它：

```
private void GetEmployees()
{

Employees employee;

employee = employee.GetEmployees();
} 
```

使用函数而不是方法有什么优势吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T19:27:32.903

在我看来，您应该使 GetEmployees() 成为 Employee 的静态方法。您不必实例化员工来获取他们的列表。

此外，您的第一个示例只会将您的 objEmployee 设置为数据中最后出现的任何内容。当它遍历所有员工时，它会在到达最后一个员工时停止循环，这是您将获得的数据。

此外，“员工”类是指一名员工还是多名员工？相应地命名它。如果“Employees”代表一个“Employee”，那么也许您应该将其重命名为“Employee”并从 GetEmployees 方法返回一个 List，正如我上面所说，它应该是静态的，因此您可以简单地调用类似“Employee.获取雇员（）”。

话虽如此，我从不太喜欢为业务对象提供数据访问功能的架构。它倾向于将数据访问层和业务对象层耦合得太紧。

您可能需要考虑创建一个数据访问接口，该接口接受用于搜索员工的参数并返回实际的 Employee 对象作为结果。一旦你这样做了，你会想要创建这个数据访问层的实现，然后你将使用它来生成实际的实例。这样做的好处是您可以快速更改数据访问层的实现，而无需更改业务对象。然后，您将在接口之外对业务对象进行编程，并且您可能能够使用动态程序集加载或其他一些方法来动态确定数据访问的实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T19:30:53.020

两者都是方法（也称为函数）。不同之处在于第一个“通过引用返回”，而第二个“返回引用”。

在 C# 中通过引用返回没有任何优势，因为在更简单、自然的情况下，您只返回一个引用，不会进行复制（与 C++ 不同）。

因此，返回引用总是首选，因为它是最简单的，并且它允许在调用站点具有很大的语法灵活性（例如嵌套表达式： manager.Fire(GetEmployee()) 而无需单独的语句）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:45:57.187

```
public void GetEmployees(objEmployee)
{
  //the function I am calling returns a dataTable of all the employees in the db.
  dim dt as DataTable = dbEmployees.GetEmployees(); 

   foreach(DataRow drow in dt.rows) 
     {
        objEmployee.Name = drow["Name"].ToString();
        objEmployee.ID = drow["ID"].ToString();
     }
} 
```

在您的第一种方法中，如果没有员工，您会怎么做？您创建了 Employe 对象并传递了填充它的方法，然后您想检查是否有员工。但是当你想检查时，永远不会有空值，因为你发送了创建的对象。我认为第二个更好，更容易理解。

```
Employees employee = new Employees();

 employee.GetEmployees(employee);

 if(employee==null)//but employee is not null??
     DoSomething(); 
```

# c# - C#：从程序安全地发送错误报告

> ID：521792
> 
> 赞同：7
> 
> 时间：2009-02-06T19:26:09.147
> 
> 标签：c#, email, bug-tracking

我希望我的程序在失败时通过电子邮件向我发送错误报告。有没有办法安全地做到这一点？我发现我可以使用 System.Net.Mail MailMessage 和 SmtpClient 等，但当然，我必须为其提供用户名和密码（除非有人知道不需要它的人？）。并将其放入代码中，我发现了一点……我不知道。从技术上讲，这意味着任何人都可以查看源代码或编译的 IL 代码（或它的名称）并找到该用户名和密码，并将其用于垃圾邮件或其他不太好的活动。这不是很好！

有任何想法吗？有没有更好和/或不同的方法来解决这个问题？不一定要通过电子邮件。但我想要的是一种让程序在发生我应该修复的事情时通知的方式。并使该通知对用户来说尽可能少麻烦。甚至可能是不可见的（尽管 YesNo 消息框可能是礼貌的）。

任何人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T19:51:46.223

您可以设置一个接收报告的 Web 服务，而不是发送邮件。如果您想保护数据，Web 服务可以通过 https 运行。

我曾经为客户做过一次，效果很好。

唯一的问题是程序是否在没有互联网访问的地方运行。

编辑：

不要告诉任何人，但我们甚至截取了程序崩溃时的屏幕截图，并将其与我们可以收集的有关错误的所有信息一起发布。它非常有用！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T19:28:59.360

您无需提供密码即可向自己发送电子邮件，因为您无需其他人的密码即可向他们发送电子邮件。

如果您通过第三方`SMTP`服务器转发电子邮件，则只需要密码。

如果您的`SMTP`客户端直接连接到`example.com`端口`25`并向 发送电子邮件`test@example.com`，则不需要密码。

`example.com`以上是`MX`记录，不是`A`记录。这是一种特殊类型的记录，其中包含所有电子邮件`example.com`应发送到的服务器的名称。没有简单的方法可以从 中查找它`.NET`，但是如果您不打算更改`SMTP`服务器的地址，您可以将其硬编码到`SmtpClient.Host`属性中。

要找出您的邮件服务器的地址，`nslookup -q=MX example.com`请在命令提示符下键入。

`SMTP`但是，这并不是报告错误的最佳方式。家庭提供商通常会阻止除其以外的所有服务器的端口`25`上的流量，以防止垃圾邮件等。

[`System.Net.WebClient`](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)您最好制作一个 Web 服务器，在您的程序中创建一个实例并通过`HTTP`. 它更可靠，您可以轻松使用客户端的代理设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T19:30:12.443

您可以将用户名和密码放在 web.config/app.config 文件中。您还可以加密 .config 文件的内容（请参见[此处](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:32:00.337

我做同样的事情，当我们的邮件服务器移动到需要经过身份验证的 SMTP 时，我们计划为来自某些地址的邮件添加例外，这样我们的自动化流程就不需要提供凭据。如果您坚持使用经过身份验证的 SMTP，则需要与您的邮件服务提供商合作以设置相同类型的异常或提供您的凭据。

# c# - 如何以不区分大小写的方式对 DataView 进行排序？

> ID：521795
> 
> 赞同：2
> 
> 时间：2009-02-06T19:26:20.923
> 
> 标签：c#, sorting, datatable, dataview

我有一个数据表。我想按列名“城市”对其默认视图进行排序。我希望排序不区分大小写。

这是我的代码：

```
DataTable dt = GetDataFromSource();
dt.DefaultView.Sort = "city asc";

MyReport.DataSource = dt.DefaultView; 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T19:39:24.440

没关系。它在文档中。

```
DataTable dt = GetDataFromSource();
dt.CaseSensitive = false;
dt.DefaultView.Sort = "city asc"; 
```

# c# - 如何使用“www” URL 重定向到没有“www” URL，反之亦然？

> ID：521804
> 
> 赞同：15
> 
> 时间：2009-02-06T19:28:58.000
> 
> 标签：c#, asp.net, redirect, canonical-name

我正在使用 ASP.NET 2.0 C#。我想将带有“www”的网络应用程序的所有请求重定向到不带“www”的

www.example.com 到 example.com

或者

example.com 到 www.example.com

Stackoverflow.com 已经在这样做了，我知道 PHP (.htaccess) 文件中有一个预制机制。但是如何在 asp.net 中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-06T19:30:46.453

有一篇关于此的 Stackoverflow 博客文章。

[https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/](https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/)

引用杰夫的话：

> 这是从所有传入 URL 中删除 WWW 前缀的 IIS7 规则。将此 XML 片段剪切并粘贴到您的 web.config 文件中
> 
> ```
> <system.webServer> / <rewrite> / <rules>
> 
> <rule name="Remove WWW prefix" >
> <match url="(.*)" ignoreCase="true" />
> <conditions>
> <add input="{HTTP_HOST}" pattern="^www\.domain\.com" />
> </conditions>
> <action type="Redirect" url="http://domain.com/{R:1}"
>     redirectType="Permanent" />
> </rule> 
> ```
> 
> 或者，如果您更喜欢使用 www 前缀，您也可以这样做：
> 
> ```
> <rule name="Add WWW prefix" >
> <match url="(.*)" ignoreCase="true" />
> <conditions>
> <add input="{HTTP_HOST}" pattern="^domain\.com" />
> </conditions>
> <action type="Redirect" url="http://www.domain.com/{R:1}"
>     redirectType="Permanent" />
> </rule> 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T21:25:29.047

过去，当我无法修改 IIS 设置时，我使用了以下解决方案。

在 HTTPModule（可能是最干净的）或 Application_BeginRequest 中的 global.asax.cs 或某些 BasePage 类型事件（例如 OnInit）中，我使用我希望使用的已知字符串对请求的 url 执行检查：

```
public class SeoUrls : IHttpModule
{
  #region IHttpModule Members

  public void Init(HttpApplication context)
  {
      context.PreRequestHandlerExecute += OnPreRequestHandlerExecute;
  }

  public void Dispose()
  {
  }

  #endregion

  private void OnPreRequestHandlerExecute(object sender, EventArgs e)
  {
    HttpContext ctx = ((HttpApplication) sender).Context;
    IHttpHandler handler = ctx.Handler;

    // Only worry about redirecting pages at this point
    // static files might be coming from a different domain
    if (handler is Page)
    {
      if (Ctx.Request.Url.Host != WebConfigurationManager.AppSettings["FullHost"])
      {
        UriBuilder uri = new UriBuilder(ctx.Request.Url);

        uri.Host = WebConfigurationManager.AppSettings["FullHost"];

        // Perform a permanent redirect - I've generally implemented this as an 
        // extension method so I can use Response.PermanentRedirect(uri)
        // but expanded here for obviousness:
        response.AddHeader("Location", uri);
        response.StatusCode = 301;
        response.StatusDescription = "Moved Permanently";
        response.End();
      }
    }
  }
} 
```

然后在您的 web.config 中注册该类：

```
<httpModules>
  [...]
  <add type="[Namespace.]SeoUrls, [AssemblyName], [Version=x.x.x.x, Culture=neutral, PublicKeyToken=933d439bb833333a]" name="SeoUrls"/>
</httpModules> 
```

这种方法对我们来说效果很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-09T20:59:26.417

接受的答案适用于单个 URL 或仅几个，但我的应用程序提供数百个域名（手动输入的 URL 太多）。

这是我的 IIS7 URL 重写模块规则（这里的操作类型实际上是 301 重定向，而不是“重写”）。效果很好：

```
<rule name="Add WWW prefix" >
  <match url="(.*)" ignoreCase="true" />
  <conditions>
   <add input="{HTTP_HOST}" negate="true" pattern="^www\.(.+)$" />
  </conditions>
  <action type="Redirect" url="http://www.{HTTP_HOST}/{R:1}" 
       appendQueryString="true" redirectType="Permanent" />
</rule> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-22T14:18:02.787

为了回答这个问题，我们首先要回忆一下WWW的定义：

万维网：n。缩写。万维网

*   位于所有使用 HTTP 协议的 Internet 服务器上的完整文档集，用户可以通过简单的点击系统访问。
*   n ：通过超文本传输​​协议提供文本和图形以及声音和动画资源的互联网站点的集合。默认情况下，所有流行的 Web 浏览器都采用 HTTP 协议。这样做时，软件会在请求的 URL 前添加“http://”，并自动连接到端口 80 上的 HTTP 服务器。为什么许多服务器要求他们的网站通过 www 子域进行通信？邮件服务器不要求您将电子邮件发送到收件人@mail.domain.com。同样，除非需要特定的子域，否则 Web 服务器应允许通过主域访问其页面。

简而言之，使用 www 子域是多余的，而且沟通起来很耗时。没有它，互联网、媒体和社会都会变得更好。

使用页面顶部的链接，您可以查看最近验证的域以及提交域以进行实时验证。

**阿帕奇网络服务器：**

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

**Windows Server/IIS：** ~~没办法。~~

您可以使用[来自 Code Plex 的 Url Rewriter](http://urlrewriter.codeplex.com)。使用相同的语法。

```
RewriteCond %{HTTP_HOST} !^(www).*$ [NC]
RewriteRule ^(.*)$ http://www.%1$1 [R=301] 
```

[来源](http://no-www.org/index.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T19:35:25.803

这通常由您的 Web 服务器直接在配置中处理。正如您所提到的，.htaccess 文件为 Apache Web 服务器执行此操作——它与 PHP 无关。由于您使用的是 ASP，因此几乎可以肯定您的服务器是 IIS。我知道有一种方法可以直接使用 IIS 进行设置，但我不知道它是什么。知道您应该在谷歌上搜索与“IIS 重定向”相关的内容，而不是“ASP 重定向”，这可能有助于您进行搜索。

也就是说，您可以在 PHP 中执行此操作，而且几乎可以肯定是 ASP，但是您必须在错误的域中访问任何 URL 调用执行重定向操作的 ASP 脚本（使用适当的 API 调用或通过直接设置标头）。这将需要在服务器方面进行一些 URL 重写或类似操作，以便错误主机上的所有 URL 都由您的脚本处理......首先直接在服务器上执行 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T19:42:04.900

我们在 IIS 6 上非常简单地做到了这一点。我们基本上创建了第二个虚拟服务器，它上面除了自定义 404 页面 .aspx 页面之外什么都没有。该页面捕获了对 WHATEVERSERVER.com/whateverpage.aspx 的任何请求，并通过将 URL 更改为 www.whateverserver.com/whateverpage.aspx 重定向到真实服务器。

设置非常简单，并且它的优点是它可以与进入它的任何域一起使用（例如，如果您有多个域），而无需为每个域设置额外的规则。因此，对 www.myoldserver.com/xxx 的任何请求也将被重定向到 www.whateverserver.com/xxx

在 IIS 7 中，所有这些都可以通过 URL 编写组件来完成，但我们更愿意在这个虚拟服务器上保持重定向关闭。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-27T12:43:32.077

如果您使用的是 IIS 7，只需导航到 URL 重写并添加规范域名规则。

PS 确保您从 domain.com 重定向到 www.domain.com

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-08T23:39:03.597

该版本将：

1.  维护传入请求的http/https。
2.  如果您需要，支持各种主机（例如，按域区分租户的多租户应用程序）。

* * *

```
<rule name="Redirect to www" stopProcessing="true">
  <match url="(.*)" />
  <conditions trackAllCaptures="true">
    <add input="{CACHE_URL}" pattern="^(.+)://" />
    <add input="{HTTP_HOST}" negate="true" pattern="^www\.(.+)$" />
  </conditions>
  <action type="Redirect" url="{C:1}://www.{HTTP_HOST}/{R:1}" />
</rule> 
```

# c++ - 创建 C++ 类图

> ID：521809
> 
> 赞同：5
> 
> 时间：2009-02-06T19:30:37.013
> 
> 标签：c++, class-diagram

在 Visual Studio .NET 项目中，您可以将“类图”添加到项目中，以呈现所有命名空间、类、方法和属性的可视化表示。有没有办法为 Win32（不是 .NET）C++ 项目做到这一点？通过 Visual Studio 本身还是使用第 3 方工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T19:46:03.693

大多数 UML 工具应该能够做到这一点。我知道 Sparx Systems [Enterprise Architect](http://www.sparxsystems.com.au/products/mdg/int/vs/index.htm)确实如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T17:25:02.553

如果您有一个由多个 C++ 项目组成的 Visual Studio 2008 解决方案，则每个项目只能生成一个类图。

例如，如果您有一个应用程序项目链接到 10 个库项目，则必须生成 11 个单独的类图。

有两种方法可以解决这个问题，但都不是令人愉快的：

1.  将所有源代码塞进一个项目中。
2.  为一个项目（可能是应用程序）创建一个类图，然后将所有其他项目的文件拖到类图中。

[Visual C++ 类设计器](http://www.developer.com/net/cplus/article.php/3702821)中对 Visual Studio 类设计器的功能进行了更彻底的探索。

鉴于 Visual Studio 中对 C++ 类图的支持不佳，如果您想要的不仅仅是您拥有的类的简单列表，您最好使用商业工具。 [Excel Software 的WinTranslator](http://www.excelsoftware.com/wintranslator.html)可能值得一看，我的同事使用[Source Insight](http://sourceinsight.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T22:16:58.257

我有 VS2008 SP1 Professional 和类图在 C++ WIN32 和 Makefile 项目中运行良好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T22:18:42.557

如果您使用的是 Visual Studio，则 C++ 的类图直到 Visual Studio 2008 才正确实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T15:10:09.880

类设计器不适用于 C++，即使在 VS 2008 中也是如此。使用一些更专业的工具会更好。它适用于不大量使用模板的简单项目。另外，从 codeplex 获得建模电动玩具。

尝试做部分专业化，看看它是如何把所有东西都塞进一个单一的形状中的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T04:37:17.520

一种便宜的方法是使用[Doxygen](http://www.doxygen.org/)记录您的源代码，并让这个工具为您创建类图。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-27T15:53:11.203

如果您的项目是基于 c++ 的项目，那么您必须先绘制 c++ 的类图，如果您的项目包含“n”个子项目，那么您必须绘制“n+1”个类图。

基本上一个类图包含

1.  类变量。
2.  类函数。
3.  类之间的关系。

您应该将类​​所需的所有属性放在类图中。它看起来像一个具有 3 行类型框的表格（图形结构）。

第 1 行. 类名（如果它是对象图，它应该而且必须下划线）。
第 2 行。变量列表（一行中的一个变量）。
第 3 行. 函数列表（一行一个函数）

您必须在一个班级与另一个班级之间建立关系。

# theory - 软件工程理论

> ID：521810
> 
> 赞同：12
> 
> 时间：2009-02-06T19:30:41.307
> 
> 标签：theory

在我的职业生涯中，我遇到了两大类理论：物理理论和教育/管理理论：

根据物理世界的判断，物理理论要么正确（在适当的条件下）要么不正确。

教育/管理理论看起来像物理理论，但它们缺乏严格的测试。充其量，它们提供了思考问题的新方法。多种理论很有用，因为其中一种可能会以正确的方式与您交谈。

作为一名软件工程爱好者，似乎有很多软件工程理论（如敏捷编程、测试驱动设计、模式、极限编程）。我应该认为这些理论是类似于物理的还是类似于教育/管理的？

还是我误解了软件工程并发现自己处于“甚至没有错”的位置？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-06T19:34:58.410

软件工程最终是关于心理学的，即人类如何管理复杂性。因此，软件工程原理更像是教育和管理理论，而不是物理原理。

一些软件工程背后有扎实的数学：O(n log n) 排序比 O(n^2) 排序快，等等。但大多数软件工程是关于人类如何看待软件的。如何组织事物以使维护者不会发疯，预测哪些可能会发生变化，哪些不会，防止和检测人为错误等。它是心理学或社会学的一个分支。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T19:37:44.160

我认为适当的理论分裂是那些“更难”的科学（可以有证据的地方）和具有定性答案的较软的主题，如果有的话，证据很少。

对我来说，软件主要是关于语言和交流的，这是一个主要是定性和主观的话题。我们时不时地触及算法和其他“困难”领域，其中存在证明和严格的形式主义。所以，是的，两者都请。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T19:35:45.147

甚至没有错。

所有的软件工程“理论”似乎都只是对特定事物的建议，试图看看它们是否能让你和你的团队更有效率。即使可以将它们设置为像科学理论一样可证伪，也没有什么意义。这并不是说不值得了解它们——相反，您应该尽可能多地熟悉它们，并尝试弄清楚它们在什么样的团队和环境中可能会更好地工作。但要小心：避免教条和认为有灵丹妙药。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T19:36:45.490

我不会将敏捷编程、测试驱动设计、模式、极限编程等称为“理论”，它们是方法论或工作方式。他们不做任何断言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-13T00:04:55.890

一般来说，信息学领域分为 4 个区域（需要找到源的链接，SWEBOK？），虽然相关且相互关联，但它们是截然不同的：

*   计算机科学
*   软件工程
*   计算机工程
*   信息系统

Steve McConnel 的“专业软件开发”中对工程与科学进行了很好的分析。查看他的[软件工程，而不是计算机科学](http://www.stevemcconnell.com/psd/04-senotcs.htm)。

软件开发更多的是关于工程——为实际问题寻找实用的解决方案——而不是其他任何事情。没错，软件工程依赖于计算机科学、数学、复杂性理论、系统学、心理学等学科，但不能等同于其中任何一个，也不是一批。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T19:35:23.307

它们就像食谱：它们是指导方针，其成功取决于：

*   部分原因在于配方的质量
*   部分是关于成分的质量
*   部分取决于从业者的技能（和可用时间）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T19:46:33.410

除了理论，还有框架、模型和经验法则。想法，当然，但基于不太严格的基础，大致属于您的教育/管理类别。

计算机科学有一些强大的基础理论（根据您的定义是物理理论），但这些理论主要包括将较小的元素联系在一起。

另一方面，软件工程是一门相对较新的学科，涉及利用计算机和偶尔的计算机科学来构建软件系统。该领域的大多数实践完全基于非严格的实验和轶事证据。由于即使是最简单的问题也没有陪审团，所以大多数通过实践的东西可以最好地描述为纯粹的猜测和非理性的偏好。这是其中一个你真的必须知道很多才能意识到有多少是建立在一个非常不稳定的牌屋上的学科之一。

保罗。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T19:47:01.757

由于是无形的，编程是一项很难与另一个人，甚至是其他程序员联系起来的活动。软件工程试图在没有结构的地方添加结构，但这种结构并非植根于现实的必然性。因此，在试图安抚他们的技术神（或恶魔）时，所有这些方法都变得像宗教一样。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T20:08:10.793

所有这些理论和最佳实践仍未使我们能够可靠且可预测地生产软件系统。[这些调查](http://www.it-cortex.com/Stat_Failure_Rate.htm)中最新的一次是 2001 年；[杰夫 2006 年的专栏](http://www.codinghorror.com/blog/archives/000588.html)仍然感叹高故障率。

看看是否有人在进行更新的调查会很有趣。

航空电子设备和运行我汽车的软件似乎并没有在接近企业软件报价的情况下出现故障。为什么企业开发人员不更密切地遵循他们的实践？也许我们都应该写艾达……[开玩笑]

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T20:55:07.890

对我来说，这是我自己的理论，并以许多其他理论为基础。我不知道有人使用单一的特定理论。这不是一个逃避的答案。

正如有不同的语言一样，理论/实践/方法将在不同的情况下使用。结构、规则和定义都是人们理解事情如何完成的方式，但要完成什么是主观的。

适应，了解客户、项目、程序员、时间的敏捷、极端或其他方法，尤其是什么让你成功/快乐。成为一个团队并调整/适应您的团队为更大的利益所做的事情；只要记住有一些你已经在自己的脑海中定义的东西，否则它不仅仅是混乱。

[SOAPBOX] 我开始在雅达利 400 上编程，它带有转换后的平面键盘和 64K 升级。当我开始上大学时，我看到我的经济学老师使用 VB 1.0 来构建一个教学工具，以帮助人们使用图表和视觉输入来了解更多关于经济学的知识。那太酷了！我知道我能做到。

同一位经济学老师，后来也成为了一名 IT 老师（他很好），问我是否会教一堂调试课。他说：“我还没有遇到像你一样理解概念并具有天生调试能力的人，你能教我们你知道什么以及你是怎么做的吗？” 当然，这对我的自我来说是一种提升，但它是为了教导、指导和帮助他人。

每一个例子都满足了我帮助他人的愿望。对我来说，我想要一台电脑来做我想做的事，帮助商业和家庭生活中的其他人提高他们的生活质量，学习更多，完成更多工作。

有一次有人对我说，“你只有你的工具”。学习、实践和成长。

如果你已经定义了一些东西，它正在工作，有秩序，它延伸了你和界限，你就没有错。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-05-31T19:28:49.350

**有没有像“软件工程”这样的想法？**

**还是软件开发是“工程”？**

**事实：**

*   对于许多其他“工程”而言，我们的行业非常年轻。
*   我们仍然没有“坚实的”实践和“理论”。
*   所以说实话，如果我们从其他成熟的工程实践的角度来看，很难将我们所做的称为“工程”
*   我们在失败方面的名声很差[我们的失败率在许多工程部门是不能接受的]

**现实还是幻想？**选一个 ：-）

*   有些人说我们没有“坚实的”实践和“理论”，因为我们是一个年轻的“工程”分支，到时候我们会有的。**那些家伙说我们需要研究更多的“理论”或基础。**

*   有些人说软件开发是“实验性的社会活动”，因为我们问题领域的性质。我们将有实践理论方法论过程，但它们总是具有二阶效应。独特的人、他们的感受品质以及他们与其他人的互动更有影响力。**那些人将软件开发视为复杂的自适应系统**

**还有另一个现实**

%80 的软件开发活动真的不需要很聪明的头脑。任何“普通”人都可以做到。

但是剩下的 %20 部分是非常艰巨和多学科的任务。

**甚至还有另一个新的视角**我的一个:-)

这种观点说软件开发**不是“工程”的一个分支**。它是“自然科学与社会科学”的分支。所以我们需要软件人类学和人类学家。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-29T18:32:56.030

理论：我认为理论是描述自然系统“如何”工作的任何东西，并且为了证明它，基于先前的知识进行逻辑推论，并通过使用实验进行的逻辑归纳来证实。

你把这些理论和实验的整体称为科学。

软件：软件是一个人造系统。一个工程系统。工程应用科学来创建新系统。在这方面，纯软件工程应用离散数学系统的科学。

但是商业软件工程有一个不同的动机，叫做经济学。在这方面，它必须考虑影响经济学的所有因素，其中最主要的是人。因此，心理学起着很大的作用。但是，由于心理学本身只是一种基于模式识别的人类思维“如何”工作的理论，没有任何基于人类生物学的逻辑推论，因此它存在许多缺陷，例如相关性暗示因果关系。

所以，是的，我认为从上面的答案中，您可以更好地理解商业软件工程是什么。

# c - 构建项目有哪些替代环境？

> ID：521815
> 
> 赞同：1
> 
> 时间：2009-02-06T19:31:40.507
> 
> 标签：c, operating-system, compilation

前段时间我在看 Linux From Scratch 项目，有点失望你需要在你的机器上安装一个现有的 Linux 副本来构建它。我知道 Linux 很容易获得、安装等，但我希望在现代操作系统（Unix/Linux/OS-X/Windows/Etc.）之外以及在 DOS 中构建 LFS 项目。

我的问题是，我如何构建一个项目，无论它是 C、C++ 还是使用 C 编译器的其他语言，而不在另一个操作系统中构建该项目。我所说的操作系统是指 Unix、Linux、OS-X、Windows 和所有其他支持 GUI 的“现代”操作系统。

所以特别是我正在寻找像DOS一样工作的东西。如果仅此而已，我不会使用 DOS，但是我正在考虑能够使用所有可用内存、处理能力等的东西。我想启动我的计算机并受到来自“提示”的欢迎我可以构建或执行程序（如另一个操作系统）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T19:41:22.517

我认为你最接近的安装是 Gentoo Linux [Stage 1](http://en.wikipedia.org/wiki/Gentoo_Linux#Stages)。它基本上会给你一个提示，然后你从这个最小的起点编译一切，包括内核。它与您在不手动键入引导加载程序的二进制文件的情况下所获得的一样接近；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:45:59.323

为了构建程序，您需要：执行其他程序（编译器、链接器），访问文件系统以读取代码和写出编译文件，等等。您需要一个“真正的”操作系统，如果您想“使用所有可用内存”和处理能力就更是如此。如果您不喜欢支持 GUI 的操作系统的“高级外观”，只需尝试众多精简的 linux 发行版之一：例如，[“该死的小型 linux”](http://www.damnsmalllinux.org/)会浮现在脑海中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:02:16.577

我的猜测是，这将是很多工作，但这个 DOS 编译器可能对[DJGPP](http://www.delorie.com/djgpp/)有所帮助。 [Minix](http://www.minix3.org/)也可能是一种选择，但它确实有 X Windows。除此之外，您将很难找到任何东西。

# language-agnostic - 从商业到游戏编程的转变

> ID：521819
> 
> 赞同：9
> 
> 时间：2009-02-06T19:32:33.547
> 
> 标签：language-agnostic

有谁知道如何从商业过渡到游戏编程？任何人将如何开始游戏编程？它似乎更令人兴奋和有益（也有更好的报酬？）。但似乎大多数校外工作都是商业编程。关于如何做到这一点或是否可以做到的任何建议或见解？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-08T18:06:25.810

这不是对您的问题“我如何过渡？”的*直接回答。*但相反，我想建议你不要走那条路，或者至少对它是什么样的保持现实。为了支持这一点，我将引用 2004 年 igda 游戏开发者生活质量调查中的一些统计数据：

*   34.3% 的开发者预计在 5 年内离开这个行业，51.2% 在 10 年内离开这个行业。
*   只有 3.4% 的人表示他们的同事平均拥有 10 年或以上的工作经验。
*   关键时间无处不在，在此期间，受访者每周工作 65 至 80 小时（35.2%）。平均每周加班工作超过 80 小时 (13%)。加班通常是无偿的（46.8%）。
*   44% 的开发人员声称他们可以在项目中使用更多的人或特殊技能。
*   配偶可能会回答“你工作太多……”（61.5%）；“你总是压力山大。” (43.5%)；“你挣的钱不够。” (35.6%)。
*   与预期相反，更多的人表示游戏只是他们的众多职业选择之一（34%），而不是游戏是他们唯一的选择（32%）。

许多年前，我自己创建了几个游戏开发网站，然后是 GameDev.net 的创始人之一。我这样做的原因之一是建立联系并专业地从​​事游戏开发。它确实奏效了，一些联合创始人已经继续在该行业工作，我相信我也可以这样做，但我对这个行业的了解教会了我以下几点：

*   相信游戏开发会非常酷的开发者源源不断。为该行业招聘的人知道这一点，并且不会支付给你几乎一样多的薪水，因为他们依赖于这个基本上用之不竭的人才库。
*   业内的许多开发人员可能擅长 3D 或声音或许多其他主题，但他们通常对您或我认为必不可少的基本软件实践缺乏经验。在那个类别中，我会将诸如源代码控制、测试优先设计、设计模式等内容放在一起。即使他们知道得更清楚，把东西拿出来的时间紧迫往往会让他们为了节省时间而愚蠢地放弃良好的软件实践。
*   在一个游戏上工作两年很快就会变得与在任何其他程序上工作两年没有什么不同。也就是说，当你不得不日复一日地挖掘程序的内部并处理它的错误时，只有那一款游戏看起来就不再那么有趣了。实际上，您可能会发现自己玩其他游戏只是为了暂时摆脱它。
*   是什么说明你将从事半条命 X 或每年推出的几十款酷游戏之一？请记住，有人正在为下一部威尔·法瑞尔的电影制作游戏，而且很可能就是你。环顾一下大部分出来的渣滓。那东西不会自己发展。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-06T20:03:17.870

真是一个过渡！思维方式的最大差异是从商业世界对抽象的依赖转变为您更多地关注您所针对的特定硬件并让事情在严格的时间和内存预算内运行。游戏编程更像是嵌入式编程，而不是 Web 编程——你必须考虑所有事物的确切内存占用，而 CPU 时间非常宝贵。

对于 MMO 服务器程序员来说也是如此，因为**a)**服务器必须在 80 毫秒内响应每个客户端命令才能感觉到响应，并且**b)**服务器上的游戏占用空间越大，您需要的硬件就越多买，那要花真钱。

首先，如果你还没有学习 C++，你应该学习 C++。如今，几乎所有游戏都是用 C 或 C++ 编写的。游戏机有严格的内存限制，如果你分配超过 512mb 的一个字节，它不会变慢，它会崩溃；同时，通过主应用程序循环的每次行程必须在 33 毫秒或更短的时间内完成，因此我们不能依赖垃圾收集和智能指针。游戏开发世界是那些你真正需要进行[所有优化](http://assemblyrequired.crashworks.org/2009/01/04/fcmp-conditional-moves-for-branchless-math/)的特殊应用程序之一，这里的人说你再也不需要做这些优化了。

另外，加强你的数学。游戏是由线性代数和运动学构建的——不仅仅是图形，还有世界的状态以及每个角色和对象的行为。我喜欢[Eric Lengyel 的](https://rads.stackoverflow.com/amzn/click/com/1584502770)游戏数学书；多年来，它一直是我的圣经（尽管还有许多其他好的圣经）。

您也可以尝试学习一些[图形数学和编程](https://rads.stackoverflow.com/amzn/click/com/1568814240)，但现在这是一个子专业，通常游戏团队中只有几个人真正在 DirectX 调用级别上工作。我怀疑您对不那么专业的游戏逻辑和服务器后端更感兴趣。

制作游戏。有许多框架可以帮助您入门。[XNA](http://msdn.microsoft.com/en-us/xna/default.aspx)具有作为实际游戏附带的真实产品的优势，这与 PyGame 或 SDL 不同，它们可以快速启动和运行但几乎没有商业支持。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-06T20:33:35.483

人们过渡到游戏行业的一个常见途径是从游戏开发团队的[工具开发人员](http://en.wikipedia.org/wiki/Game_programmer#Game_tools_programmer)开始。

这些工具通常用 C# 等高级语言编写，用于帮助开发游戏。例如，您可以帮助维护或修改团队内部的地图级别编辑器，或者帮助开发将一种媒体文件格式转换为其专有文件格式的工具。

在您作为工具开发人员花了一些时间之后，您可以开始学习领域知识并自然地过渡到多种[类型的游戏程序员](http://en.wikipedia.org/wiki/Game_programmer)中的一种：

*   游戏物理程序员
*   人工智能程序员
*   图形程序员
*   声音程序员
*   游戏程序员
*   编剧
*   界面程序员
*   输入编程器
*   网络程序员
*   游戏工具程序员
*   移植程序员
*   技术程序员
*   首席游戏程序员

现代游戏通常是由庞大且高度分散的团队在角色方面制作的。因此，选择上述专业之一并在您尝试踏入大门时立即开始学习可能是值得的。毫无疑问，您应该精通 C++ 和主要图形库之一（OpenGL、DirectX 等）。不要强调两个都学，随便挑一个学就行了。通常，如果需要，非常了解其中一个的人可以过渡到另一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T19:40:02.520

如果你是一个优秀的程序员，你可以做到，游戏编程需要更好地理解你用来开发游戏的平台和工具。

我认为进入游戏编程行业比进入常规行业要困难得多。

最好的选择是创建自己的游戏，获得曝光，如果你足够好，你会找到自己的方式。

虽然有很多非常好的竞争对手，只要查看许多提供免费 Flash 游戏的网站，您就可以开始将您的作品发布到这些网站。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T19:39:18.043

一般的故事是，进入游戏编程的方法就是开始做。没有任何你想让他们付钱给你做的演示，即使出现在游戏公司的门口也是没有意义的。

如果你是从商业编程中出来的，那将对你不利，而且还会造成文化冲击。游戏行业以 20 多岁的单身男性为基础，他们可以被教导每周工作 120 小时就是做事的方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T20:12:50.173

我建议你暂时保留目前的工作，并寻找一个可以使用帮助的模组团队或开源游戏。尝试找到一个看起来可能会创建可玩游戏而不是消失的游戏，我猜我会说它在你的简历上看起来会比一些测试演示更好，因为你可能会做一些比你更先进的事情家，这表明您可以在游戏团队中工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T19:38:31.133

我想知道同样的事情！

我注意到 Barnes & Nobles 有许多不错的游戏编程书籍，可能不是一个糟糕的起点。

不过总的来说，我会开始看书，也许编写一些原型，然后开始研究你所在地区的公司，他们使用什么工具，你如何才能让自己对他们有价值！

顺便说一句，有没有人知道是否有类似于 WOW / Guild Wars 用于 MMORPG 游戏开发的特定引擎（我的主要兴趣）？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T19:44:25.973

我认为这不是一个容易的转变。游戏编程不是一夜之间就能学会的东西。如果你想要的不仅仅是毕业生的薪水，我怀疑入门水平会相当高。

很久以前，我在一家从事在线赌博领域的公司工作。然后我决定我想从事更严肃的活动。

你真的需要回答一个问题——你想要什么是因为你喜欢它，还是仅仅因为它现在看起来很有价值。在后一种情况下，您需要了解您将赶上进度，并且没有人可以保证在您获得高技能时薪水会像您希望的那样高。

也许考虑一些认证/培训，这样你就可以提高你目前在商业编程方面的职业地位？

但是，如果这是您真正想要的，那么请跟随您的心。表现出你的兴趣和承诺，潜在的雇主会注意到这一点，并希望你比一个仅仅因为薪水看起来有吸引力而申请的人更喜欢你。

另一方面，业务开发人员/顾问（例如在 SAP 世界中）获得了相当丰厚的赎金。

# c# - 使 Reporting Services 更快的通用方法是什么

> ID：521822
> 
> 赞同：0
> 
> 时间：2009-02-06T19:33:08.790
> 
> 标签：c#, optimization, reporting-services

虽然我理解这个问题相当模糊，因为我没有给你提供尽可能多的细节，但我希望可以对我的生成代码或报告本身进行一些一般性改进，以加快它们的速度. 我已经要求更多的硬件，但被拒绝了。

```
public Stream GenerateReport(string reportName, string format)
{
    if (reportName == null)
        throw new ArgumentNullException("reportName");

    reportExecutionService.LoadReport(reportName, null);

    string extension;
    string encoding;
    string mimeType;
    ReportExecution2005.Warning[] warnings;
    string[] streamIDs;

    byte[] results = reportExecutionService.Render(format, null, out extension, 
        out encoding, out mimeType, out warnings, out streamIDs);

    return new MemoryStream(results);
} 
```

每个报告本身需要 6-10 秒。我已将瓶颈缩小到 Reporting Services 本身。我应该从哪里开始寻找消除潜在的速度瓶颈。注意：一些代码已被删除以保护无辜者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T19:40:49.397

尽管与您发布的代码没有直接关系，但在 Reporting Services 中编写报告时，您应该始终考虑以下几个通用增强功能：

1.  预加载报告表，以便它们已经聚合了本应在报告中聚合的所有数据。例如，如果报表数据源汇总了数千行数据并需要将多个表连接在一起，那么您应该创建一个预聚合表，将所有数据连接在一起，并且已经按照报表所需的粒度汇总了数据。

2.  如果您将参数传递到数据源，那么聚合基础表应该有一个聚集索引，该索引与搜索表的方式相对应。例如，如果报告仅显示单个客户和给定交易日期范围的数据，则应按客户和交易日期对聚集索引进行排序。

3.  过滤数据应该发生在数据源查询中，而不是报告本身中。这意味着，如果您对报表进行参数化以过滤数据，则应将参数传递给数据库，以便它返回较小的数据集。不要返回大量数据然后过滤数据。使用多值参数时很容易犯此错误，因为使用多值参数的现成指令是在数据返回到 Reporting Services 之后过滤数据。

我希望您已经在执行上述操作，并且这不是相关的帖子。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:09:03.197

如果您仅根据您的客户端代码将其范围缩小到 Reporting Services，我将查看检索您的数据的查询/SP。在我的日子里，我遇到了一些看起来相当无辜的非常讨厌的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T02:42:41.963

我刚刚做了几个非常讨厌的报告！我不得不加入多个表的可疑标准，每个表包含几百万行。

最终创建了一个控制台应用程序，用于前一天每晚进行收集。所有的逻辑都太繁重了，所以生成报告的时间太长了。现在速度不再是问题了。

这取决于报告的类型。这三份报告只需要昨天的数据。但正如奥斯汀所说，查询或其他通常是瓶颈。

要记住的另一件事是报告会在一段时间后“过期”（这是默认设置）。因此，如果您有一段时间没有使用该报告，则生成报告需要更长的时间。如果你在下一个更快之后再做一次。解决方法是转到 Internet Explorer 中的报告并单击属性并查看执行和历史记录（可以调整它们以改善报告的呈现），但如果数据很关键，您可能会得到旧数据。 .

# c++ - 未收到所述事件通知

> ID：521824
> 
> 赞同：0
> 
> 时间：2009-02-06T19:34:16.773
> 
> 标签：c++, visual-studio-2008, com, notifications, connection-points

**问题：**

*   **未收到接收器（类）实现中列出的**事件通知（来自 COM 对象 - 服务器）。****

***   ****接收到****一个事件通知**( Event_one )，**但未**相应接收其他事件通知**

    ***   如果**更改****顺序**-在IDispatch::Invoke 中，即：

     ***   if`Event_one`被交换到`Event_two`then`Event_two`收到通知，但`Event_one`其他人相应地被忽略****** 

 ********问题：**

*   更好的实现方式，IDispatch::Invoke 还是 QI？
*   使用错误的逻辑或方法？

**注意**：

*   没有 MFC
*   无 ATL
*   纯 C++
*   使用消息循环：[GetMessage()](http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx)
*   **STA**模型（ Coinitialize() ）
*   调用 IDispatch::Advise**成功（来自调用****S_OK**的 HRESULT ）
*   在上面之后，COM对象方法调用正常（带有接口指针）
*   单次致电 Advise
*   [MIDL 编译器](http://msdn.microsoft.com/en-us/library/aa367300(VS.85).aspx)生成的类型库

**例如（示例）：**

**IDispatch::Invoke**的插图- 取自**Sink 类**：

```
HRESULT STDMETHODCALLTYPE Invoke(
{
//omitted parameters

// The riid parameter is always supposed to be IID_NULL
        if (riid != IID_NULL)
            return DISP_E_UNKNOWNINTERFACE;

if (pDispParams) //DISPID dispIdMember
    {
        switch (dispIdMember) { 
        case 1:
            return Event_one();
        case 2:
            return Event_two();
        case 3:
            return Event_three();
        default:
            return E_NOTIMPL;
        }
    }
    return E_NOTIMPL;
} 
```

* * *

查询接口说明**：**

```
STDMETHOD (QueryInterface)(
//omitted parameters
{
    if (iid == IID_IUnknown || iid == __uuidof(IEvents))
    {
        *ppvObject = (IEvents *)this;
    } else {
        *ppvObject = NULL;
        return E_NOINTERFACE;
    }
    m_dwRefCount++;
    return S_OK;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T06:21:56.420

由于您收到接收器接口的第一个方法的通知，我怀疑，事件不会从服务器的其他方法上发送。如果您有服务器代码，只需检查引发通知的连接点类。

您还可以在客户端应用程序的 Invoke 方法中放置一个断点，以检查它正在接收的所有事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T23:48:48.773

## 解决了：

在查看了相应的**IDL**文件（由 MIDL 编译器生成）之后，很明显**IEvent**接口中包含的每个**方法都有一个****唯一的 ID**。例如，ID 为**2**。例如：****`Event_one`****

 ******```
methods:
    [id(0x00000002)]
    HRESULT Event_one(); 
```

因此，在 IDispatch::invoke 实现中进行如下更改（如上述问题所示）：

```
//omitted

if (pDispParams) //DISPID dispIdMember
        {
            switch (dispIdMember) { 
            case 2:
                    return Event_one();

//omitted 
```

**现在，当相应地调用时，现在**执行所需/正确的**方法**。

 **# unlock - Vista64的“解锁器”等效项？

> ID：521827
> 
> 赞同：4
> 
> 时间：2009-02-06T19:35:00.453
> 
> 标签：unlock, vista64

Cedrick Collomb 的[Unlocker](http://www.emptyloop.com/unlocker/)是我遇到过的最有用的实用程序之一 - 当我在编译时遇到某个文件被锁定的问题时，我可以右键单击该文件，单击“Unlocker”，它会告诉我什么有文件（类似于谁锁定我？），我可以删除句柄，终止进程，等等。这太好了。

但是它在 Vista64 中不起作用。我不确定它是否适用于 Vista32，但我目前正在家里运行 Vista64，很快也会在工作中使用它。

有谁知道在 Vista64 中工作的类似实用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T19:41:11.050

我知道 Windows 7 将直接内置此功能。同时，查看[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。它可以识别具有文件挂钩的进程以及删除挂钩。它有很多其他用途，但我主要用于此目的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T02:53:18.793

找到一个 - [LockHunter](http://lockhunter.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T19:42:04.567

[解锁 64 位](http://www.emptyloop.com/unlocker/#download)已经有一段时间了...

# css - 跨浏览器的一致字体大小（Web 开发）

> ID：521832
> 
> 赞同：21
> 
> 时间：2009-02-06T19:36:20.607
> 
> 标签：css, fonts, font-size

在创建网页时，我们如何在浏览器中实现一致的字体大小。我`"font-size: 11pt; font-family: Helvetica,'Lucida Grande'"`在我的 CSS 中使用了类似的东西，但是文本在 Firefox、IE、Google Chrome 和 Safari 中看起来不同（甚至在不同的平台上也没有）。基本上在同一台机器上，即运行 Windows Vista，我在不同的浏览器下得到不同的外观和感觉。

如何解决此问题，以使文本的大小在所有不同的浏览器上显示相同。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-06T19:40:34.030

您将需要使用 CSS 重置来尝试在所有浏览器中获得一致的行为。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

[http://developer.yahoo.com/yui/reset/](http://developer.yahoo.com/yui/reset/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T19:40:31.940

使用 px（像素）而不是 pt（点）作为字体大小单位。然后你将处理像素大小。

但是请注意，这取决于您的网站的使用方式。（在美国）因“硬编码”字体大小而导致网站上的可访问性问题存在诉讼。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T19:42:07.803

> 创建网页时，我们如何在浏览器中实现一致的字体大小

对于正文，您不需要。有些人想要更大的文本，以便他们可以更轻松地阅读；妨碍他们，后果自负。使用以“em”或“%”为单位的相对字体大小。

对于需要文本大小以匹配像素大小的屏幕元素的少量演示文本，请使用“px”单位。不要使用 'pt' - 这仅对打印有意义，在屏幕上查看时它会或多或少地随机调整大小。

您仍然无法获得完全相同大小的文本，因为不同平台的字体不同——当然，Lucida Grande 和 Helvetica 看起来也大不相同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-02T12:50:13.227

通过这两个设置，您可以获得完全相同的字体外观：

```
font-size: 70%; // better than px

line-height: 110%; // required to make line heights the same 
```

测试：IE9、火狐、谷歌浏览器

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T19:41:03.593

这是一个非答案，因为有办法实现你所需要的，但我不太精通它们。[从蓝图](http://code.google.com/p/blueprintcss/)等框架通常提供的“重置”开始，然后从那里开始。

让设计足够灵活通常更容易和更聪明，这样浏览器之间的微小差异就不会发挥太大的作用。

# asp.net-mvc - ASP.Net MVC - 使用外部 URL 形成身份验证

> ID：521837
> 
> 赞同：3
> 
> 时间：2009-02-06T19:37:21.463
> 
> 标签：asp.net-mvc, forms-authentication

我们的组织有一个用于表单身份验证的中央解决方案。我正在尝试实现一个使用此外部 URL 的 ASP.Net MVC 应用程序 - 它一直工作到 RC！被释放了……

这是正在发生的事情

在 ActionAttribute 扩展中

如果未找到，我检查 s session var 检查是否找到请求数据卡盘，如果未找到则设置 session var - 如果找到则重定向到外部 URL 继续。

问题是，直到我更新到 RC1，这才有效。从那时起，有太多请求被发送到外部 URL，以至于它检测到 DoS 攻击并将我拒之门外！

我删除了重定向代码并将其替换为 Forms Auth 的 web.config 更改 - 同样的事情发生了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T19:41:16.993

为什么不使用[Microsoft Geneva](http://msdn.microsoft.com/en-us/security/aa570351.aspx)而不是尝试推出您自己的身份验证提供程序？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T16:44:29.193

代码：

```
public class MyAuthenticate : ActionFilterAttribute
    {        
        public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            if (filterContext.HttpContext.Session["user"] == null)
            {
                using (Authenticator dp = new Authenticator())
                {
                    MyUser mu;
                    string data = string.Empty;
                    try
                    {
                        data = filterContext.HttpContext.Request["Data"];
                    }
                    catch { };

                    if (!string.IsNullOrEmpty(data))
                    {
                        mu = dp.Redeem(data);
                        if (mu.authenticated)
                        {                            
                            filterContext.HttpContext.Session.Clear();
                            AuthenticatedUser user = new AuthenticatedUser(mu);
                            filterContext.HttpContext.Session.Add("user", user);
                            FormsAuthentication.SetAuthCookie(user.UserId, false);
                        }
                        else
                        {
                            filterContext.HttpContext.Response.Redirect("MY EXTERNAL URL GOES HERE!!");

                        }
                    }
                    else
                    {
                        filterContext.HttpContext.Response.Redirect("MY EXTERNAL URL GOES HERE!!");
                    }
                }
            }
            base.OnActionExecuting(filterContext);
        } 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:21:29.563

我通过创建请求 IP 的静态字典并删除来自同一 IP 的重复请求来解决此问题。不是一个很好的解决方案 - 所以如果有人找到更好的解决方案 - 请告诉我。

# c# - 如何使用 .NET 更新系统的日期和/或时间

> ID：521868
> 
> 赞同：9
> 
> 时间：2009-02-06T19:43:14.010
> 
> 标签：c#, .net, vb.net

我正在尝试使用以下内容更新我的系统时间：

```
[StructLayout(LayoutKind.Sequential)] 
private struct SYSTEMTIME
{
    public ushort wYear;
    public ushort wMonth;
    public ushort wDayOfWeek;
    public ushort wDay;
    public ushort wHour;
    public ushort wMinute;
    public ushort wSecond;
    public ushort wMilliseconds;
}

[DllImport("kernel32.dll", EntryPoint = "GetSystemTime", SetLastError = true)]
private extern static void Win32GetSystemTime(ref SYSTEMTIME lpSystemTime);

[DllImport("kernel32.dll", EntryPoint = "SetSystemTime", SetLastError = true)]
private extern static bool Win32SetSystemTime(ref SYSTEMTIME lpSystemTime);

public void SetTime()
{
    TimeSystem correctTime = new TimeSystem();
    DateTime sysTime = correctTime.GetSystemTime();
    // Call the native GetSystemTime method
    // with the defined structure.
    SYSTEMTIME systime = new SYSTEMTIME();
    Win32GetSystemTime(ref systime);

    // Set the system clock ahead one hour. 
    systime.wYear = (ushort)sysTime.Year;
    systime.wMonth = (ushort)sysTime.Month;
    systime.wDayOfWeek = (ushort)sysTime.DayOfWeek;
    systime.wDay = (ushort)sysTime.Day;
    systime.wHour = (ushort)sysTime.Hour;
    systime.wMinute = (ushort)sysTime.Minute;
    systime.wSecond = (ushort)sysTime.Second;
    systime.wMilliseconds = (ushort)sysTime.Millisecond;

    Win32SetSystemTime(ref systime);
} 
```

当我调试时，一切看起来都很好并且所有值都是正确的，但是当它调用 Win32SetSystemTime(ref systime) 时，系统的实际时间（显示时间）不会改变并且保持不变。奇怪的是，当我调用 Win32GetSystemTime(ref systime) 时，它会给我新的更新时间。有人可以给我一些帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T19:46:40.227

您的部分问题是您有几个不正确的 PInvoke 签名。最值得注意的 SetSystemTime 应该有一个非 void 返回值。这是正确的签名

```
 /// Return Type: BOOL->int
    ///lpSystemTime: SYSTEMTIME*
    [System.Runtime.InteropServices.DllImportAttribute("kernel32.dll", EntryPoint="SetSystemTime")]
    [return: System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.Bool)]
public static extern  bool SetSystemTime([InAttribute()] ref SYSTEMTIME lpSystemTime) ; 
```

我的怀疑是返回值的锁定弄乱了堆栈，并且 SetSystemTime 函数基本上以错误的数据结束。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T19:46:20.180

根据您那里的代码，您不会增加小时数。看起来您将系统时间设置为与调用 Win32GetSystemTime 时完全相同的时间。

尝试：

```
systime.wHour = (ushort)(sysTime.Hour + 1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-11T02:42:47.330

不需要 P/Invoke - Microsoft.VisualBasic 程序集提供了一种更简单的方法（但不是众所周知的）。如果您使用 C#，请记住添加对它的引用。

您可以使用`Microsoft.VisualBasic.DateAndTime`该类来获取和更改日期或时间。属性`Today`和`TimeOfDay`设置器将对日期或时间进行更改。

您仍然需要相关权限 - 请参阅下面的 MSDN 文档链接。

这是更改时间的任意示例：

```
public static void SetTimeToPast()
{
    Microsoft.VisualBasic.DateAndTime.TimeOfDay = DateTime.Now.AddMinutes( -2 );
} 
```

MSDN 上的参考：http: [//msdn.microsoft.com/en-us/library/microsoft.visualbasic.dateandtime (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.dateandtime(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-07T07:21:36.950

```
 TimeSpan diffLocalTime = DateTime.Now - DateTime.UtcNow; 
SystemTime systemTime = new SystemTime(); 
systemTime.Second = ... 
systemTime.Minute =.... 
systemTime.Hour -= (ushort)(diffLocalTime.Hours + 1); // 00:59:59 I rounded as 1 hour 
bool result = SetSystemTime(ref systemTime); 

```

这使用它在本地时区正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-28T04:43:13.343

问题是关于UTC时间和当地时间。请参阅此链接： [http ://www.codeproject.com/Messages/2998246/problem-with-SetSystemTime-fucntion-of-Kernel32-dl​​.aspx](http://www.codeproject.com/Messages/2998246/problem-with-SetSystemTime-fucntion-of-Kernel32-dl.aspx)

希望这可能对您有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-11T20:28:49.983

```
 [DllImport("Kernel32.dll")]
 public static extern bool SetLocalTime(ref StractData.Datetime.SYSTEMTIME Time); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-28T05:26:29.107

您只有一个权限问题，当我在没有权限的情况下运行该程序时，它不会更改日期，但是如果我右键单击该程序，然后单击以管理员身份运行，它就可以了！

# javascript - html 4中的可编辑div内容

> ID：521873
> 
> 赞同：0
> 
> 时间：2009-02-06T19:44:50.560
> 
> 标签：javascript, html, css

想知道是否有任何不太难的方法来编辑 html 4 中的非表单文本。我知道可以在 html 5 中设置 contentEditable 属性，但我想要比这给我更好的浏览器支持。似乎 gmail 在他们的聊天状态指示器中做了类似的事情。这在 IE6 上正常工作（我不相信它支持 html 5）。有人见过这样做吗？谢谢，-摩根

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:14:39.300

HTML5 的 contentEditable 是根据 IE 的现有属性建模的，（至少）Firefox 和 Safari 也支持该属性，因此您不必等待 HTML5 被“支持”。

这是一个非常丑陋的设计，但它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:17:26.207

您是否考虑过使用 CSS 来使`<textarea>`外观看起来像别的东西？仅仅因为某些东西是表单控件，并不意味着它必须看起来像一次。您可以更改背景、阴影、边框等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:49:12.530

您可以在 javascript 中为大多数 dom 元素（包括 div 和表格）设置 innerText 或 innerHTML 属性。

# windows - 你能摆脱“Microsoft Office Excel 遇到问题”对话框吗？

> ID：521881
> 
> 赞同：2
> 
> 时间：2009-02-06T19:46:16.063
> 
> 标签：windows, excel, crash, ms-office

你知道我的意思是：

![Excel 崩溃了……又来了！](https://farm4.static.flickr.com/3429/3258031261_1149df469c_o.jpg)

有没有办法禁用它？

我正在编写一个应用程序来自动测试在关键环境中使用的大量 Excel 电子表格。其中许多工作表都会做一些让 Excel 崩溃的疯狂事情。当 Excel 崩溃时，我希望它尽快终止且无需用户干预。

*   我绝对不想重新启动excel。
*   我不希望 excel.exe 进程等待有人点击“不发送”
*   而且我**永远**不想向微软报告我崩溃的细节！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T20:01:04.333

它是一个系统服务，您可以轻松关闭

[在 Microsoft Windows XP Professional 中关闭错误报告](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5276398.html)

如果这不起作用，请转到控制面板/管理工具/服务并停止并禁用“错误报告服务”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T19:59:09.063

你能以某种方式检测到 Excel 崩溃了吗？之后您可以使用`TerminateProcess`函数，这将永久删除该过程。Raymond Chen 的博客上有[一篇](http://blogs.msdn.com/oldnewthing/archive/2004/07/22/191123.aspx)关于它的文章。

# javascript - 如何防止函数在 Javascript 中的另一个函数之外被调用？

> ID：521882
> 
> 赞同：1
> 
> 时间：2009-02-06T19:46:17.217
> 
> 标签：javascript

我有一个javascript函数（function1），它在调用另一个（旧）函数（function2）之前检查一些全局变量（用户可以连接，服务是否可用等），该函数实际上会弹出一个窗口并将用户连接到我们的服务。我想防止 function2 除了从 function1 之外的任何地方被调用。这可能吗？

作为一个便宜的解决方案，我想我可以从 function1 发出一个变量，并在执行之前在 function2 中检查它。还有其他方法吗？有没有办法在 javascript 函数中找出调用元素/方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T19:50:09.440

在这里阅读：[Crockford 的方法](http://www.crockford.com/javascript/private.html)。在第一个函数中声明函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T19:50:31.267

你应该检查这个：

*   [如何在 JavaScript 中找出调用者函数？](https://stackoverflow.com/questions/280389/javascript-how-do-you-find-the-caller-function)

还有这个：

*   [https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/caller](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/caller)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T19:49:48.863

为什么不直接删除函数 2，将其全部内容移到函数 1 中？

然后，您可以将旧功能 1 替换为指示错误的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T19:56:10.443

您可以将函数 2 移动到函数 1 中，这样它就是函数 1 的“私有”。查看[“模块模式”](http://yuiblog.com/blog/2007/06/12/module-pattern/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T20:02:46.030

```
var function1 = function() {
    var function2 = function() { alert('hi'); };

    function2();
};

function1(); // alerts "hi";

function2(); // error function2 is undefined 
```

# sql - 在事务中包装插入对 Sql Server 的性能有多大帮助？

> ID：521887
> 
> 赞同：13
> 
> 时间：2009-02-06T19:46:42.753
> 
> 标签：sql, sql-server, database, performance, transactions

好吧，假设我有 100 行要插入，每行大约有 150 列（我知道这听起来像很多列，但我需要将这些数据存储在一个表中）。插入将随机发生（即，每当一组用户决定上传包含数据的文件时），大约每月 20 次。然而，数据库将在持续负载下处理大型企业应用程序的其他功能。这些列是 varchars、ints 以及各种其他类型。

将这些插入包装在事务中（而不是一次运行一个）的性能增益是巨大的、最小的还是介于两者之间？

为什么？

编辑：这是针对 Sql Server 2005 的，但如果有不同的说法，我会对 2000/2008 感兴趣。另外我应该提一下，我理解交易主要是为了数据一致性，但我想关注性能影响。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-06T19:50:58.253

实际上可能会产生影响。事务的重点不在于您做了多少，而在于保持数据更新的一致性。如果您有需要一起插入并且相互依赖的行，那么这些记录就是您包装在事务中的记录。

事务是关于保持您的数据一致。这应该是您在使用事务时首先考虑的事情。例如，如果您从支票账户中借记（提款），您希望确保贷记（存款）也已完成。如果其中任何一个不成功，则应回滚整个“事务”。因此，两个动作都必须包装在一个事务中。

在进行批量插入时，将它们分解为 3000 或 5000 条记录，然后在集合中循环。3000-5000 对我来说是一个很好的插入数字范围；除非您已经测试过服务器可以处理它，否则不要超过它。此外，我将在大约每 3000 或 5000 条插入记录时将 GO 放入批处理中。更新和删除 我将 GO 设置为 1000 左右，因为它们需要更多资源来提交。

如果您从 C# 代码执行此操作，那么在我看来，您应该构建一个批量导入例程，而不是通过编码一次进行数百万次插入。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-25T13:52:06.910

虽然事务是一种保持数据一致性的机制，但如果使用不当或过度使用，它们实际上会对性能产生巨大影响。我刚刚完成了一篇关于显式指定事务而不是让它们自然发生对性能的影响的[博客文章。](http://blog.staticvoid.co.nz/2012/04/making-dapper-faster-with-transactions.html)

如果您要插入多行并且每个插入都发生在自己的事务中，那么锁定和解锁数据会产生很多开销。通过将所有插入封装在单个事务中，您可以显着提高性能。

相反，如果您对数据库运行许多查询并且还发生大型事务，它们可能会相互阻塞并导致性能问题。

交易与业绩明确相关，无论其潜在意图如何。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T19:50:26.163

这取决于您所说的巨大，但它会有所帮助（这实际上取决于您正在执行的插入总数）。它将强制 SQL Server 在每次插入后不进行提交，这会及时加起来。对于 100 次插入，您可能不会注意到增加太多，具体取决于数据库发生的频率和其他情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T20:38:02.013

正如其他人所说，事务与性能无关，而是与数据的完整性有关。

话虽如此，当您只谈论每月插入大约 20 次 100 行数据（意味着每月 2000 条记录）时，以一种或另一种方式担心性能是愚蠢的。过早的优化是浪费时间；除非您反复测试了这些插入的性能影响（尽可能小，并且不频繁）并发现它们是一个主要问题，否则不要担心性能。与您提到的其他服务器负载相比，它可以忽略不计。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-06T19:51:38.300

事务不是为了性能，而是为了数据完整性。根据实施情况，只有 100 行的性能不会真正获得/损失（它们只会被额外记录，因此它们都可以回滚）。

关于性能问题需要考虑的事项：

*   TA 将与其他查询交互
    *   写 TA 将锁定元组/页面/文件
*   提交可能是（取决于锁定协议）时间戳的更新
*   可能会为 TA 写入更多日志（应该能够回滚 TA，但数据库可能已经广泛记录，顺序记录很便宜）
*   隔离程度（我知道可以在某些数据库中切换此级别 - 几乎没有人使用级别 3）

总而言之：使用 TA 来确保完整性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-03T09:15:18.760

实际上 - 非常。大插入，100++（前提是您将 mysql 配置为增加查询大小和事务大小以支持巨大的查询/事务，抱歉不记得确切的变量名称） - 插入时间通常可以快 10 倍甚至更多更多的

# language-agnostic - 不可变集合上的非变异“添加”方法的最佳名称是什么？

> ID：521893
> 
> 赞同：234
> 
> 时间：2009-02-06T19:49:29.987
> 
> 标签：language-agnostic, naming-conventions, list, immutability

很抱歉标题有点啰嗦——如果我能想出一个简洁的标题，我就不必问这个问题了。

假设我有一个不可变的列表类型。它有一个操作，该操作`Foo(x)`返回一个新的不可变列表，其中指定的参数作为末尾的额外元素。因此，要建立一个值为“Hello”、“immutable”、“world”的字符串列表，您可以编写：

```
var empty = new ImmutableList<string>();
var list1 = empty.Foo("Hello");
var list2 = list1.Foo("immutable");
var list3 = list2.Foo("word"); 
```

（这是 C# 代码，如果您觉得语言很重要，我对 C# 建议最感兴趣。从根本上说，这不是语言问题，但语言的习语可能很重要。）

重要的是现有列表*不会*被更改`Foo`- 所以`empty.Count`仍然会返回 0。

获得最终结果的另一种（更惯用的）方法是：

```
var list = new ImmutableList<string>().Foo("Hello")
                                      .Foo("immutable")
                                      .Foo("word"); 
```

我的问题是：**Foo 最好的名字是什么？**

**编辑 3**：正如我稍后透露的那样，类型的名称实际上可能不是`ImmutableList<T>`，这使位置清楚。相反，想象一下它是`TestSuite`并且它是不可变的，因为它所属的整个框架都是不可变的......

（编辑 3 结束）

到目前为止我提出的选项：

*   `Add`：在 .NET 中很常见，但意味着原始列表的突变
*   `Cons`: 我相信这是函数式语言中的正常名称，但对于那些没有使用此类语言经验的人来说毫无意义
*   `Plus`*: 到目前为止我最喜欢的，这对我来说*并不意味着突变。显然这也在[Haskell 中使用，](http://en.wikibooks.org/wiki/Haskell/MonadPlus)但期望略有不同（Haskell 程序员可能希望它将两个列表添加在一起，而不是向另一个列表添加单个值）。
*   `With`：与其他一些不可变的约定一致，但在 IMO 中没有完全相同的“附加性”。
*   `And`: 不是很详细。
*   + 的运算符重载：我真的不喜欢这个；我一般认为运算符应该只应用于较低级别的类型。不过我愿意被说服！

我用来选择的标准是：

*   给出方法调用结果的正确印象（即它是带有额外元素的原始列表）
*   尽可能清楚地表明它不会改变现有列表
*   像上面的第二个例子一样，当链接在一起时听起来很合理

如果我不够清楚，请询问更多详细信息...

**编辑 1：**`Plus`这是我更喜欢`Add`. 考虑这两行代码：

```
list.Add(foo);
list.Plus(foo); 
```

在我看来（这*是*个人的事情），后者显然是有问题的——就像写“x + 5;”一样。作为自己的声明。第一行看起来没问题，直到您记住它是不可变的。`Plus`事实上，加号运算符本身不会改变其操作数的方式是我最喜欢的另一个原因。如果没有运算符重载的轻微恶心，它仍然给出相同的含义，其中包括（对我而言）不改变操作数（或在这种情况下的方法目标）。

**编辑2：**不喜欢添加的原因。

各种答案都是有效的：“使用 Add。这就是`DateTime`它的作用，并且`String`具有`Replace`不会使不变性明显的方法等。” 我同意 - 这里有优先级。但是，我看到很多人打电话`DateTime.Add`or`String.Replace`并*期待 mutation*。有很多新闻组问题（如果我仔细研究的话，可能还有一些问题），这些问题的答案是“你忽略了 ; 的返回值`String.Replace`；字符串是不可变的，会返回一个新字符串。”

现在，我应该揭示这个问题的一个微妙之处——该类型实际上可能*不是*一个不可变列表，而是一个不同的不可变类型。特别是，我正在开发一个基准测试框架，您可以在其中向套件添加测试，并创建一个新套件。可能很明显：

```
var list = new ImmutableList<string>();
list.Add("foo"); 
```

不会完成任何事情，但是*当*您将其更改为：

```
var suite = new TestSuite<string, int>();
suite.Add(x => x.Length); 
```

看起来应该没问题。而对我来说，这使错误更清楚：

```
var suite = new TestSuite<string, int>();
suite.Plus(x => x.Length); 
```

那只是乞求：

```
var suite = new TestSuite<string, int>().Plus(x => x.Length); 
```

理想情况下，我希望我的用户不必被告知测试套件是不可变的。我要他们掉进成功的坑里。这*可能*是不可能的，但我想试试。

对于通过仅谈论不可变列表类型来过度简化原始问题，我深表歉意。`ImmutableList<T>`并非所有收藏都像:)那样具有自我描述性

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-02-06T21:22:32.657

在这种情况下，我通常选择`Concat`. 这通常对我来说意味着正在创建一个新对象。

```
var p = listA.Concat(listB);
var k = listA.Concat(item); 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2009-02-06T21:03:37.403

我会选择 Cons，原因很简单：这正是你想要的。

1.  我非常喜欢准确地说出我的意思，尤其是在源代码中。新手只需查找一次 Cons 的定义，然后阅读并使用一千次。我发现，从长远来看，使用使常见情况变得更容易的系统会更好，即使前期成本会更高一些。

2.  对于没有 FP 经验的人来说，它“毫无意义”这一事实实际上是一个很大的优势。正如您所指出的，您发现的所有其他词都已经具有某种含义，并且该含义略有不同或模棱两可。一个新概念*应该*有一个新词（或者在这种情况下，一个旧词）。我宁愿有人必须查找 Cons 的定义，而不是错误地假设他知道 Add 做什么。

3.  从函数式语言中借用的其他操作通常保留其原始名称，没有明显的灾难。我没有看到任何推动提出非 FPers 听起来更熟悉的“map”和“reduce”同义词，我也没有看到这样做有什么好处。

（完全披露：我是一名 Lisp 程序员，所以我已经知道 Cons 的含义。）

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2009-02-06T20:12:41.750

其实我喜欢`And`，尤其是惯用的方式。如果你有一个空列表的静态只读属性，我会特别喜欢它，并且可能将构造函数设为私有，这样你总是必须从空列表构建。

```
var list = ImmutableList<string>.Empty.And("Hello")
                                      .And("Immutable")
                                      .And("Word"); 
```

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2009-02-06T20:57:56.013

每当我陷入命名法的困境时，我都会上网。

[thesaurus.com](http://www.thesaurus.com)为“添加”返回这个：

> **定义：**邻接，增加；进一步发表评论
> 
> **同义词：**词缀、附件、前注、附加、增加、加强、提升、建立、充电、继续、提示、图进来、充实、加热、远足、远足、搭便车、挂钩、挂钩与，包括，自升，爵士乐，加入，垫，parlay，背驮式，插入，倒上，回复，跑起来，说得更远，拍打，滚雪球，加汤，加速，穗，加紧，补充、增甜、粘贴、标记

我喜欢声音`Adjoin`，或者更简单`Join`。这就是你正在做的，对吧？该方法也适用于加入其他`ImmutableList<>`的。

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2009-02-06T21:02:38.483

就个人而言，我喜欢 .With()。如果我正在使用该对象，在阅读文档或代码注释后，它会清楚它的作用，并且它在源代码中读取正常。

```
object.With("My new item as well"); 
```

或者，您添加“沿”它.. :)

```
object.AlongWith("this new item"); 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2009-02-06T19:54:03.007

我最终为[BclExtras](http://code.msdn.microsoft.com/BclExtras)中的所有不可变集合添加了 Add 。原因是它是一个容易预测的名字。我不太担心人们会将 Add 与变异 add 混淆，因为类型的名称以 Immutable 为前缀。

有一段时间，我考虑了 Cons 和其他功能样式名称。最终我打折了它们，因为它们几乎没有那么出名。当然函数式程序员会理解，但他们不是大多数用户。

其他名称：您提到：

*   另外：我希望/洗这个。对我来说，这并不比 Add 区分它是一个非变异操作
*   With：会导致 VB 出现问题（双关语）
*   运算符重载：可发现性将是一个问题

我考虑的选项：

*   Concat：字符串是不可变的并使用它。不幸的是，它只适合添加到结尾
*   CopyAdd：复制什么？来源，清单？
*   AddToNewList：对于 List 来说可能是一个不错的选择。但是集合、堆栈、队列等呢？

不幸的是，似乎并没有一个词是

1.  绝对是不可变的操作
2.  为广大用户所理解
3.  用少于 4 个字表示

当您考虑 List 以外的集合时，它会变得更加奇怪。以堆栈为例。即使是一年级的程序员也可以告诉你 Stacks 有一对 Push/Pop 方法。如果您创建一个 ImmutableStack 并给它一个完全不同的名称，我们称之为 Foo/Fop，您只是为他们添加了更多工作以使用您的集合。

**编辑：**对加编辑的回应

我知道您将与 Plus 一起去哪里。我认为一个更强有力的案例实际上是减去删除。如果我看到以下内容，我肯定会想知道程序员到底在想什么

```
list.Minus(obj); 
```

我对 Plus/Minus 或新配对的最大问题是感觉有点矫枉过正。集合本身已经有一个区别名称，即不可变前缀。为什么要进一步添加词汇表，其目的是添加与不可变前缀相同的区别。

我可以看到调用站点参数。从单个表达式的角度来看，它更清楚。但在整个函数的上下文中，这似乎是不必要的。

**编辑 2**

同意人们肯定对 String.Concat 和 DateTime.Add 感到困惑。我见过几个非常聪明的程序员遇到了这个问题。

但是我认为 ImmutableList 是一个不同的论点。没有任何关于 String 或 DateTime 将其确定为对程序员不可变的内容。您必须简单地*知道*它通过其他来源是不可变的。所以混乱并不意外。

ImmutableList 没有这个问题，因为名称定义了它的行为。你可能会争辩说人们不知道什么是 Immutable，我认为这也是有效的。我当然直到大学二年级才知道。但是，无论您选择什么名称而不是 Add，您都会遇到同样的问题。

**编辑 3：**像 TestSuite 这样不可变但不包含单词的类型呢？

我认为这使您不应该发明新方法名称的想法成为现实。即因为显然存在使类型不可变以促进并行操作的驱动力。如果您专注于更改集合的方法名称，下一步将是您使用的每种不可变类型上的变异方法名称。

我认为将重点放在使类型可识别为不可变将是一项更有价值的工作。这样您就可以解决问题，而无需重新考虑那里的每个变异方法模式。

现在，您如何将 TestSuite 识别为不可变的？在今天的环境下，我认为有几种方法

1.  不可变前缀：ImmutableTestSuite
2.  添加一个描述 Immutablitiy 级别的属性。这肯定不太容易被发现
3.  别的不多。

我的猜测/希望是开发工具将通过简单地通过视觉识别不可变类型（不同的颜色、更强的字体等）来帮助解决这个问题。但我认为这就是答案，尽管改变了所有的方法名称。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-02-06T21:27:51.023

我认为这可能是可以接受运算符超载的罕见情况之一`+`。在数学术语中，我们知道`+`不会将某些内容附加到其他内容的末尾。它总是将两个值组合在一起并返回一个新的结果值。

例如，直觉上很明显，当你说

```
x = 2 + 2; 
```

x 的结果值为 4，而不是 22。

相似地，

```
var empty = new ImmutableList<string>();
var list1 = empty + "Hello";
var list2 = list1 + "immutable";
var list3 = list2 + "word"; 
```

应该清楚每个变量将持有什么。应该清楚的`list2`是，最后一行没有*更改*，而是`list3`分配了将“word”附加到的结果`list2`。

否则，我只会将函数命名为 Plus()。

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2009-02-06T19:55:03.860

为了尽可能清楚，您可能想要使用 wordier`CopyAndAdd`或类似的东西。

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2009-02-06T20:01:37.857

如果您觉得非常冗长，我会称它为**Extend()**或**ExtendWith() 。**

扩展意味着将某些内容添加到其他内容而不更改它。我认为这是 C# 中非常相关的术语，因为这类似于扩展方法的概念——它们“添加”一个新方法到一个类而不“接触”类本身。

否则，如果您真的想强调根本不修改原始对象，那么使用 Get- 之类的前缀对我来说似乎是不可避免的。

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2009-02-06T21:34:15.207

添加（），附加（）

我喜欢使用过去时对不可变对象进行操作。它传达了您没有更改原始对象的想法，并且在您看到它时很容易识别。

此外，由于可变方法名称通常是现在时动词，因此它适用于您遇到的大多数需要不可变方法名称的情况。例如，不可变堆栈具有“推送”和“弹出”方法。

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2009-02-06T20:03:12.800

我喜欢 mmyers 的**CopyAndAdd**建议。为了与“突变”主题保持一致，也许您可​​以选择**Bud**（无性繁殖）、**Grow**、**Replicate**或**Evolve**？=)

**编辑：继续我的遗传主题， Procreate**怎么样，这意味着一个新对象是基于前一个对象制作的，但添加了一些新的东西。

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2009-02-06T22:48:28.737

这可能是一个延伸，但在 Ruby 中，有一个常用的表示法来区分：`add`不变异；`add!`变异。如果这是您项目中普遍存在的问题，您也可以这样做（不一定使用非字母字符，但始终使用符号来指示变异/非变异方法）。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2009-02-06T22:42:17.330

`Join`似乎合适。

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2010-02-07T05:31:24.743

也许混淆源于您想要两个操作合二为一的事实。为什么不把它们分开？DSL风格：

```
var list = new ImmutableList<string>("Hello");
var list2 = list.Copy().With("World!"); 
```

`Copy`将返回一个中间对象，它是原始列表的可变副本。`With`将返回一个新的不可变列表。

**更新：**

但是，拥有一个中间的、可变的集合并不是一个好方法。中间对象应包含在`Copy`操作中：

```
var list1 = new ImmutableList<string>("Hello");
var list2 = list1.Copy(list => list.Add("World!")); 
```

现在，该`Copy`操作接受一个委托，该委托接收一个可变列表，以便它可以控制复制结果。它可以做的不仅仅是附加一个元素，比如删除元素或对列表进行排序。它也可以在`ImmutableList`构造函数中用于组装初始列表，而无需中间的不可变列表。

```
public ImmutableList<T> Copy(Action<IList<T>> mutate) {
  if (mutate == null) return this;
  var list = new List<T>(this);
  mutate(list);
  return new ImmutableList<T>(list);
} 
```

现在已经没有被用户误解的可能，**自然会落入成功的坑里**。

**另一个更新：**

如果您仍然不喜欢提到可变列表，即使现在它已包含在内，您也可以设计一个规范对象，该对象将*指定*或*脚本*，复制操作将如何转换其列表。用法将是相同的：

```
var list1 = new ImmutableList<string>("Hello");
// rules is a specification object, that takes commands to run in the copied collection
var list2 = list1.Copy(rules => rules.Append("World!")); 
```

现在您可以对规则名称进行创新，并且您只能公开您想要`Copy`支持的功能，而不是`IList`.

对于链式使用，您可以创建一个合理的构造函数（当然不会使用链式）：

```
public ImmutableList(params T[] elements) ...

...

var list = new ImmutableList<string>("Hello", "immutable", "World"); 
```

或者在另一个构造函数中使用相同的委托：

```
var list = new ImmutableList<string>(rules => 
  rules
    .Append("Hello")
    .Append("immutable")
    .Append("World")
); 
```

这假定该`rules.Append`方法返回`this`.

这是您最新示例的样子：

```
var suite = new TestSuite<string, int>(x => x.Length);
var otherSuite = suite.Copy(rules => 
  rules
    .Append(x => Int32.Parse(x))
    .Append(x => x.GetHashCode())
); 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2009-02-06T19:56:44.420

一些随意的想法：

*   不可变添加（）
*   附加（）
*   ImmutableList<T>(ImmutableList<T> originalList, T newItem) 构造函数

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2009-02-06T19:55:32.083

C# 中的 DateTime 使用 Add。那么为什么不使用相同的名称呢？只要你的类的用户理解类是不可变的。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2009-02-06T21:30:17.647

首先，一个有趣的起点： [http://en.wikipedia.org/wiki/Naming_conventions_(programming)](http://en.wikipedia.org/wiki/Naming_conventions_(programming)) ...特别是，检查底部的“另见”链接。

我赞成 Plus 或 And，实际上同样有效。

Plus 和 And 都是基于数学的词源。因此，两者都意味着数学运算。两者都产生一个表达式，该表达式自然地读作可以解析为一个值的表达式，该值与具有返回值的方法相匹配。 `And`带有额外的逻辑内涵，但这两个词都直观地适用于列表。 `Add`表示对对象执行的操作，这与方法的不可变语义相冲突。

两者都很短，考虑到操作的原始性，这一点尤其重要。简单、频繁执行的操作应该使用更短的名称。

表达不可变语义是我更喜欢通过上下文来做的事情。也就是说，我宁愿简单地暗示整个代码块都具有功能性。假设一切都是不可变的。然而，那可能只是我。我更喜欢不变性作为规则；如果它完成了，它在同一个地方做了很多；*可变性*是个例外。

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2009-02-06T20:36:08.707

我认为英语不会让您在使用与“添加”含义相同的动词时以明确无误的方式暗示不变性。“加号”几乎做到了，但人们仍然会犯错误。

防止用户将对象误认为是可变对象的唯一方法是通过对象本身的名称或方法的名称（如“GetCopyWith”或“复制并添加”）。

因此，请选择您最喜欢的“Plus”。

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2009-02-06T20:07:11.903

我认为你试图表达的关键是非排列，所以可能是包含生成词的东西，比如 CopyWith() 或 InstancePlus()。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2009-02-06T21:48:32.680

Chain() 或 Attach() 怎么样？

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2009-02-07T00:18:56.963

我更喜欢加号（和减号）。它们很容易理解并直接映射到涉及众所周知的不可变类型（数字）的操作。2+2 不会改变 2 的值，它返回一个同样不可变的新值。

其他一些可能性：

拼接（）

接枝（）

混凝土（）

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2009-02-06T22:24:15.667

对于那些遵守的人来说，**mate**、**mateWith**或**coitus**怎么样。在繁殖方面，哺乳动物通常被认为是不可变的。

也要把**联盟**扔出去。从 SQL 借来的。

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2010-02-09T14:11:48.773

Apparently I'm the first Obj-C/Cocoa person to answer this question.

```
NNString *empty = [[NSString alloc] init];
NSString *list1 = [empty stringByAppendingString:@"Hello"];
NSString *list2 = [list1 stringByAppendingString:@"immutable"];
NSString *list3 = [list2 stringByAppendingString:@"word"]; 
```

Not going to win any code golf games with this.

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2009-02-06T21:11:29.573

也许有些词更能让我记住制作副本并向其中添加内容而不是改变实例（例如“连接”）。但我认为对于其他行动的这些词有一些对称性也很好。我不知道“删除”的类似词，我认为与“连接”相同。“加号”对我来说听起来有点奇怪。我不希望它在非数字环境中使用。但这也可能来自我的非英语背景。

也许我会使用这个方案

```
AddToCopy
RemoveFromCopy
InsertIntoCopy 
```

但是，当我想到它时，这些都有自己的问题。人们可能会认为他们删除了某些东西或在给定的论点中添加了一些东西。完全不确定。我认为，这些词在链接方面也不好。写得太啰嗦了。

也许我也会使用简单的“添加”和朋友。我喜欢它在数学中的使用方式

```
Add 1 to 2 and you get 3 
```

好吧，当然，2 仍然是 2，你得到一个新数字。这是关于两个数字而不是关于一个列表和一个元素，但我认为它有一些类比。在我看来，`add`并不一定意味着你改变了一些东西。我当然明白你的观点，即有一个只包含一个`add`而不使用返回的新对象的孤独语句看起来并没有问题。但我现在也考虑过使用“add”以外的其他名称的想法，但我就是想不出另一个名称，而不让我想到“嗯，我需要查看文档才能知道什么它是关于”，因为它的名称与我期望的“添加”不同。只是来自 litb 的一些奇怪的想法，不确定它是否有意义:)

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2009-02-07T14:58:06.707

查看[http://thesaurus.reference.com/browse/add](http://thesaurus.reference.com/browse/add)和[http://thesaurus.reference.com/browse/plus](http://thesaurus.reference.com/browse/plus)我发现了**增益**和**词缀**，但我不确定它们在多大程度上暗示了非突变。

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2009-06-11T22:25:29.977

我认为`Plus()`and `Minus()`or, 或者，`Including()`在*暗示*不可变行为`Excluding()`方面是合理的。

 *但是，任何命名选择都不会让每个人都非常清楚，所以我个人认为，一个好的 xml 文档注释在这里会有很长的路要走。当您在 IDE 中编写代码时，VS 会将这些直接扔到您面前——它们很难被忽视。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2009-02-06T19:57:15.200

我认为“添加”或“加号”听起来不错。列表本身的名称应该足以传达列表的不变性。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2009-02-06T20:02:37.620

`Append`- 因为，请注意`System.String`方法的名称表明它们会改变实例，但它们不会。

或者我很喜欢`AfterAppending`：

```
void test()
{
  Bar bar = new Bar();
  List list = bar.AfterAppending("foo");
} 
```

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2009-02-28T16:01:40.320

`list.CopyWith(element)`

和 Smalltalk 一样 :)

这也`list.copyWithout(element)`删除了所有出现的元素，这在用于`list.copyWithout(null)`删除未设置的元素时最有用。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2009-04-17T18:39:15.590

I would go for Add, because I can see the benefit of a better name, but the problem would be to find different names for every other immutable operation which might make the class quite unfamiliar if that makes sense.

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2010-06-04T19:43:01.017

也许静态方法或运算符（这是静态的）是最好的。它将从实例中移走责任，并且用户将立即知道该操作不属于任何实例。特别重要的是不要使用扩展方法，因为它们在使用时与实例方法的相似性违背了目的。

可以调用静态方法`Join`：

```
public static class ListOperations {
  public static ImmutableList<T> Join<T>(ImmutableList<T> list, T tail) {
    // ...
  }
  public static ImmutableList<T> Join<T>(T head, ImmutableList<T> list) {
    // ...
  }
  public static ImmutableList<T> Join<T>(ImmutableList<T> list1, ImmutableList<T> list2) {
    // ...
  }
  // substitutes chaining:
  public static ImmutableList<T> Join<T>(ImmutableList<T> list, params T[] tail) {
    // ...
  }
}

// ....

var list = new ImmutableList<string>("Hello");
var list2 = ListOperations.Join(list, "immutable"); // inferred type parameter
var list3 = ListOperations.Join(list2, "world!"); 
```

但我更喜欢 C# 在这里有无[类函数](http://codecrafter.blogspot.com/2009/09/c-static-classes-are-not-real-classes.html)。或者至少类似于 Java 的静态导入工具。

操作员可以是`+`：

```
var list = new ImmutableList<string>("Hello");
var list2 = list + "immutable";
var list3 = list2 + "world!"; 
```

但我宁愿能够使用其他的东西，比如`<<`,`::`或`.`，这在 C# 中是不可能的。

此外，静态成员看起来更实用，我认为更适合这种不可变视图。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2010-09-30T13:14:36.597

我个人喜欢`unite()`，因为当你将物体结合在一起时，你仍然保留了它们的个性，但它们的结合是一个单独的新实体。`Union`与建议的相似，但已经在集合论中得到了很好的定义，并且`unite`更加冗长，并告诉我遵循该方法我有一个新的实体。我知道它迟到了，但他们在列表中找不到建议。加上这个词让我想起了过去和团结人们去打仗的日子。呵呵

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2009-02-06T22:18:45.367

2条建议：

“免费”功能：

```
Foo f = new Foo(whatever);
Foo fPlusSomething = Foo.Concat(f, something); 
```

构造函数重载（在某种程度上是“自由函数”主题的变体）：

```
Foo f = new Foo(whatever);
Foo fPlusSomething = new Foo(f, something); 
```

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2011-05-17T16:42:23.617

怎么样`cloneWith`？

**原因：**
1\. 对于建议的单个单词名称，在我查看文档之前我无法确定它们的作用。
2\. 到目前为止建议的复合名称，我`cloneWith`更喜欢。我会确切地知道我用这个方法名称得到了什么，它相对简洁，易于记忆，而且“感觉”正确:)
3\. 在大多数编程工具中使用现代代码完成，更长的名称更容易工作比以往任何时候。

虽然很多时候简洁会增加清晰度，但如果您必须选择简洁，请考虑简洁...

**在行动：**

```
var empty = new ImmutableList<string>();
var list1 = empty.cloneWith("Hello");
var list2 = list1.cloneWith("immutable");
var list3 = list2.cloneWith("word"); 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2011-05-20T22:54:34.643

WithAdded 这个名字读起来很好，恕我直言，比可以读作形容词的 Added 更好。

```
var list2 = list1.WithAdded("immutable"); 
```

或者更详细的版本：

```
var list2 = list1.WithAddedElement("immutable"); 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2011-09-21T19:22:29.803

我会去，`list.NewList("word")`因为它描述了你在做什么（创建一个新列表）。

我必须同意这并不意味着该论点被添加到列表的末尾，但我个人属于*简洁的可能阵营*，所以我赞成`list.NewList("word")`。`list.NewListAfterAppend("word")`

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2011-06-22T20:34:03.380

我参加聚会有点晚了，但我没有看到一个建议根本不这样做的答案！让它保持不变。当他们将其放入循环中时，您放置的任何方法都会被滥用，这〜最终会发生。相反，我建议改用构建器。

```
MyImmutableBuilder builder = new MyImmutableBuilder(someImmutable);
MyImmutable modifiedImmultable = builder.add(element1).add(element2).build(); 
```

现在，在 ImmutableList 的情况下，您的构建器很可能实际上只是一个 List。

我想这一切都归结为......你真的想要一种简单的方法来将一个元素添加到你的不可变集合中吗？如果这很常见，您可能不想使用不可变对象（您可以随时调用`build()`您想要发送对象当前状态的快照......）如果这不是常见的情况，那么有一个建设者作为这样做的要求不会是一个重大的障碍，特别是如果有文件证明这就是你想要构建它们的方式。

@supercat - 考虑您描述的以下场景：

```
Stack a = someImmutableStackOfSize(10);
Stack b = a.popAndCopy(); // size 9
Stack c = a.popAndCopy(); // also size 9
// a b and c have the same backing list
Stack d = b.pushAndCopy("node1");
Stack e = c.pushAndCopy("node2");
// because d and e had the same backing list, how will it 
// know that d's last element is node1, but e's last
// element is node2? 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2009-04-04T07:01:35.453

任何暗示将返回相同类型的对象的名称都应该可以使用。Plus 是一个好名字，就好像你加上两个你期望返回结果的对象一样。

不过，Plus 听起来不像在这种情况下使用的正确名称，因为您正在将测试“加”到测试套件中。

GetWith() 对我来说听起来像是一个选择。或者永远 GetTypeWith() 其中 type 显然是您使用的类型。例如：

```
var list = new ImmutableList<String>();
var list2 = list.GetWith("First");
var list3 = list2.GetWith("Second");

// OR

var list2 = list.GetListWith("First"); 
```

Get 表示您正在获取已包含的列表，而 With 表示您需要另一个对象。CopyWith() 也将满足此标准。

我在 GetWith 中看到的直接问题是它不容易猜到。开发人员想要添加套件，而不是获取当前套件。我会立即输入 .Add 并希望智能显示的内容非常接近我的预期。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2011-02-03T22:22:50.257

我会亲自去`AddVoid`或相反`VoidAdd`

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2011-05-20T07:02:30.937

如果你是一个函数式程序员，这有几个名字：

```
(++) 
```

读作“追加”。或者它可能是`concat`，取决于您的类型：

```
-- join two things into one thing:
append :: a -> a -> a    

-- join many things into one thing
concat :: [a] -> a 
```

或者您可能的意思是`(:)`，AKA `cons`：

```
(:) :: a -> [a] -> [a] 
```

如果您将事情加入列表的前面，`snoc`如果它在最后。

至少在过去的 20 年里，我们一直在称将事物附加到 Haskell-land 的列表中。

* * *

请注意，这不是算术`(+)`，因为它是幺半群，而不是环。

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2010-02-25T19:35:42.080

作为 C++ 程序员和 STL 的粉丝，我提出了`add_copy`. （这也建议`remove_copy`，`replace_copy`等等）

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2011-08-26T08:47:20.417

**1）问题的问题分析** 摘要可以是：
从一个不可变的......得到一个新的不可变但与原来的不同..
在这个当前的问题上下文中：
从一个不可变的列表得到一个新的不可变列表，有一个新的不同元素加到底。

你能给出一个有效的“动词”（编程语言中的“方法”），以简洁的方式表达动作，而不使用简单的“添加”动词。

**2) 建议分析**
**第一个概念**：Immutable 给出一个类似的不可变，
**>>“copy”** *动词*在“content”中表达保守但较少为它定义约束（immutable）
**>>“clone”** *动词*在“content”中表达保守但也为其定义的约束。
**>>“twin”** *动词*与clone类似，但在软件中不常见，但短小精悍。

**第二个概念**：结果给出了与原始对象不同的东西
**>>“添加”**表示一个**动作**，以区分原始对象和新对象，但根据定义，我们不执行（变异）不可变对象。
**>**表达动词结果将在不干扰原始宾语的情况下增加的事实......“副词”方法更“不可变”友好
**>>“with”**表达了“动词”会做更多事情但可能模棱两可的事实它将做更多的事情。也可以表示“动词参数”是“动词”的“更多”

**3）答案**
与动词“clone”
**>> augmentClone**
**>> growClone**
**>> extendClone**
with “with”
**>> cloneWith**
**>> augmentCloneWith**
**>> growCloneWith**
**>> extendCloneWith**

带有动词“twin”
**>> augmentTwin**
**>>**
 ********>> growTwinWith**
**>> extendTwinWith******** 

 ***** * *

## 回答 #43

> 赞同：1
> 
> 时间：2011-07-01T09:35:07.663

这似乎归结为找到一个表示对象未修改的词。此外，它被克隆并且作为参数传递的元素被添加到克隆列表的末尾。标准名称喜欢`add`并且`clone`永远不会涵盖它。也许`clone_and_append`这也很模棱两可，因为该`append`部分可能暗示参数已附加到原始列表中。所以它可能应该是类似`clone_and_append_to_clone`或更好的东西`append_to_clone`，尽管这并不意味着克隆将由这个方法返回，而是克隆已经作为原始列表的一部分存在。

因此，更多地考虑寻找一个不暗示对原始列表进行修改并且还建议创建一个新列表的名称，请考虑以下事项：

1.  **分支**——`var list1 = list.Offshoot("tail")`在最严格的意义上，*分支*在这里指的是新元素，而不是整个新列表。另一个明显的缺点是它不是一个动作，更正确的名称是`list.CreateOffshoot`. 但是，我发现它清楚地表明了新列表将包含原始列表并且新元素将出现在列表末尾的事实。
2.  **Spawn——**与`var list1 = list.Spawn("tail")`前面类似。优点是它是一个动作，但新列表将包含原始列表的含义较弱。
3.  **BranchOff** -- `var list1 = list.BranchOff("tail")`建议将克隆原始列表的操作。一个潜在的歧义是参数元素将如何使用不是很清楚。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2011-08-03T00:56:15.213

`copyWithSuffix:`将是与 Objective-C 不可变字符串复制方法类似的自定义方法名称`stringByAppendingString:`。

```
var suite = new TestSuite<string>();
suite = suite.CopyWithSuffix("Str1")
             .CopyWithSuffix("Str2")
             .CopyWithSuffix("Str3"); 
```

`Suffix`传达了它的附加性并`Copy`明确了不变性。随意`Suffix`用更合乎逻辑的东西替换它实际上是那种测试套件（也许你没有将这些后缀添加到一个大的内部字符串，你可以提供我所知道的测试用例名称/参数）。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2015-08-28T18:16:27.547

虽然正确命名方法可以减少误用的机会，但如果有某种语言结构告诉编译器：“这个方法只返回一个新对象，应该使用它，否则方法调用毫无意义”，然后编译器可以每当有人在错误的设置中使用该方法时，都会抱怨错误/警告。

如果您同意，我已经填写了一个[功能请求](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/9531666-be-able-to-define-a-method-such-that-its-return-va)，请随时投票。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-04-15T21:24:40.860

比赛很晚了，但是怎么样`Freeze`。WPF 中有优先使用`Freeze`和`IsFrozen`测试对象是否可变的优先级。诚然，这稍微歪曲了含义，因为它通常`Freeze()`是一种使当前对象不可变的方法，但如果它有一个参数，你可以看到你得到的东西是不可变的。

```
var list = new ImmutableList<string>().Freeze("Hello")
                                      .Freeze("Fridgid")
                                      .Freeze("World"); 
```

基本上：

1.  这是一个词
2.  内涵围绕着不变性。
3.  WPF 中“相似”语法的优先级。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2010-05-24T10:07:45.130

就我个人而言，我会调用该方法`Clone`并调用参数`AdditionalValue`，因为这本质上就是它*看起来*正在做的事情，并且很容易理解，例如

```
var empty = new ImmutableList<string>(); 
var list1 = empty.Clone("Hello"); 
var list2 = list1.Clone("immutable"); 
var list3 = list2.Clone("word"); 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2010-11-23T17:02:58.930

我会选择“CreateNewListWithAdditionalItems”

我不介意长名字，但这一个告诉你它实际上会做什么。如果您使用 Add 或任何其他更改方法，我也会抛出异常。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2009-03-11T15:00:57.813

我会称之为 ToInclude

```
var empty = new ImmutableList<string>();
var list1 = empty.ToInclude("Hello");
var list2 = list1.ToInclude("immutable");
var list3 = list2.ToInclude("word"); 
```

惯用语（？）

```
var list = new ImmutableList<string>().ToInclude("Hello");
                                      .ToInclude("immutable");
                                      .ToInclude("word"); 
```

也适用于您提到的情况。

```
var list = new ImmutableList<string>();list.ToInclude("foo");

var suite = new TestSuite<string, int>();suite.ToInclude(x => x.Length); 
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2009-02-08T14:38:03.873

How about "Stick" or "StickTo", it sticks an element on the end.

Or "Attach" or "AttachTo".

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2010-04-24T22:59:22.650

如前所述，您尝试一次做两件事并为此目的进行微优化。如果复制发生在原始集合定义之外，“Add”、“Append”之类的名称只会造成混淆。

“ **CloneAppend** ”是我在这种情况下可能使用的。有些东西告诉我，我不会处于这种境地。我相信很快你就会发现自己需要其他类型的类似操作，比如“ **CloneFirstN** ”或“ **CloneRemoveLast** ”。很快你就会意识到最好链接克隆/复制方法，附加/删除你需要的任何东西，然后将集合转换回不可变的，即使它需要额外的代码行。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2009-02-06T21:09:57.050

.Trail 表示非常强的理解列表没有改变，这个对象在列表的后面，它没有被添加到它。

```
var list = new ImmutableList<string>().Trail("Hello");
                                      .Trail("immutable");
                                      .Trail("word"); 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2009-02-06T21:14:48.537

“添加（）”

它返回一个新列表的事实无关紧要，这是签名所揭示的实现细节。该方法完成的主要操作是将新元素“添加”到列表中。它处理或返回的方式或内容不应成为方法名称的一部分。如果一个方法是同步的，那会影响方法名称 -“synchronizedAdd()” ??? - 当然不是。

像 String 这样的遵循 will-be-mutator 模式的类仍然有非常简单的方法名——没有一个是复合词。

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2009-02-06T23:44:49.623

所以我猜一个名为“ImmutableAdd()”的方法太简单了？

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2010-02-07T18:29:01.527

我会选择运算符重载`+`。原因是这就是它在 Python 中的工作方式——`.append()`在一个列表上改变列表，而在`+`另一个列表上创建一个新列表。`+`也绝对不意味着突变。我认为这就是你`.Plus()`如此喜欢的原因，所以如果你不想运算符重载，那么你可以使用`.Plus()`.

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2009-02-08T15:16:11.520

我会使用构造函数。

```
Foo f1 = new Foo("one");
Foo f2 = new Foo(f1, "two");
Foo f3 = new Foo(f2, "three"); 
```

f1 包含“一”。f2 包含“一”、“二”。f3 包含“一”、“二”、“三”。

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2009-10-08T04:58:29.097

由于这个问题现在基本上是一个词库：How about `.Bring()`. 如，给我这个清单并带上这个元素？

```
Foo = List.Bring('short');
          .Bring('longer');
          .Bring('woah'); 
```

它不会从舌头上滚下来，但它对我来说*意味着*它。

实际上，`AndBring()`可能会更好。

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2012-01-10T18:48:22.320

I know this is beating a seemingly dead horse, but I think you may be approaching this in an odd way (hence the naming difficulty). When I have an immutable object, I don't often expect that the object will have functions that imply mutability (like Add or AddAll). I know that String & DateTime do this, but even I have fallen victim to forgetting to use the results from DateTime / String functions so I would avoid those pitfalls if possible.

If I were you, I would follow the Builder pattern similar to what Guava uses. See [immutable collections in Guava](http://code.google.com/p/guava-libraries/wiki/ImmutableCollectionsExplained). Basically the concept is that you construct the immutable object with everything it is ever going to contain. If you want to make a new immutable object, you need to use a new builder.

```
var suite = new TestSuite.Builder<string, int>().add(newTest).build(); 
```

You can expand upon the builder to allow a variety of modifications to the test suite (using standard list naming conventions like add / remove if you wish) before the user calls build.

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2009-02-06T20:34:50.363

由于类型名称是 ImmutableList ，因此指定它实际上是不可变的，我认为 .Add() 很好。但是，如果您真的坚持其他事情，我可能会使用 .AddEx() 之类的东西，其中 Ex 表示扩展，并暗示用户应该在使用前确定 Ex 是什么（通过阅读文档）。我也喜欢 Plus() 和 GetCopyWith() 的建议

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2011-11-16T22:04:51.093

就我个人而言，如果您追求流畅的风格，我可能会选择 Pad(..)，也可以使用 AndWith(..) 的扩展方法

```
var list = new ImmutableList<string>().Pad("Hello")
                                      .AndWith("immutable")
                                      .AndWith("word"); 
```

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2011-01-07T18:55:31.043

借用C，怎么样`Concat`

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2010-03-03T18:25:28.803

list.copyAndAppend(elt)

听上去怎么样？）

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2009-02-06T20:00:40.807

“代替”？它不会添加到列表中，而是用新列表替换列表。

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2009-02-06T20:02:26.077

我会选择简单的 Add()。如果您想表达这确实是一个收集操作，另一种选择是 Append()。

除了显式方法，我仍然建议实现 obverloaded + 操作符。这是一个众所周知的操作。每个人都知道 String 是不可变的，但每个人都使用“+”来构建它的新实例。

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2009-02-06T20:05:53.700

“增强”怎么样？

这是一个与 Add 不同的词，但它是一个接近的同义词。

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2009-04-16T02:22:40.690

扩展方法怎么样？`Join`在这种情况下，您可以调用它。作为一种扩展方法，用户应该知道它是一个静态方法，因此可能会让他们稍作停顿，并鼓励他们查看返回值。同时，您可以使用“实例”方法。

```
public static ImmutableList<T> Join(this ImmutableList<T> body, T tail)
{
    // add robust error checking in case either is null...
    return new ImmutableList<T>(body, tail);
} 
```

然后后来...

```
var list = new ImmutableList<string>().Join("Hello")
                                      .Join("Extensible")
                                      .Join("World"); 
```

我不太了解发布多个答案的公认行为，但这是一个有趣的问题，因为我认为命名法是设计中的关键一步，我的大脑一直在思考这个问题。

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2009-03-06T10:36:13.780

我来晚了，NewWith 怎么样？

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2009-02-06T19:55:06.997

**我喜欢 And()**。我认为它最不可能产生歧义。我能想到的唯一冲突是逻辑而且，我不认为这是 C# 开发人员的问题，甚至对于 VB，我认为上下文不太可能导致问题，任何问题都会在编译时间。它在英语“Do something to These And That”或“Put These And That in the box”中也很有效。

我认为**.With() 是可以的**。我担心它可能看起来有点像 linq Where<> 方法，特别是如果有一个 lambda 作为参数。我脑子里的英语也不太清楚，尤其是“用那个对这些做点什么”。

**我不喜欢 .Plus()**。我无法将它作为 Add 的同义词：plus = plus sign = + = add。

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2014-10-08T16:31:32.537

一个很晚的答案，但我想补充两分：我认为这里的重点可能是动词时态而不是动词本身：

```
var output= myList.joinedWith("Element"); //or AddedTo, ConcatenatedTo... 
```

在我看来，分词改变了含义：我们没有向 myList 添加任何内容，而是返回操作的结果。

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2009-06-26T12:43:40.747

C#-ish 伪代码如下：

```
interface Foo
{
    // Constructors
    Foo();
    Foo(params Foo[] foos);

    // Instance method
    Foo Join(params Foo[] foos);

    // Class method
    static Foo Join(params Foo[] foos);
} 
```

所以你可以这样称呼：

```
var f0 = new Foo();
var f1 = new Foo(new Foo(), new Foo(), new Foo());
var f2 = Foo.Join(new Foo(), new Foo(), new Foo());
var f3 = f0.Join(new Foo(), new Foo(), new Foo());
var f4 = new Foo(new Foo(new Foo()), new Foo(), new Foo(new Foo())); 
```

ETC....

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2009-08-03T11:49:18.133

`Augment`用（或`AugmentWith`）方法创建一个包装类怎么样？

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2011-03-03T14:45:21.583

类似方法的问题`String.Replace`在于，用户可能会错误地认为发生了突变，因为他可以忽略返回值。所以使用一个`out`参数作为“返回”值。用户不能忽略*这一点*：

```
public class ImmutableList<T> {
  public ImmutableList(params T[] items) { 
    // ...
  }
  /// <summary>
  /// Creates a new list with the items in this list plus the supplied items.
  /// </summary>
  /// <param name="newList">
  /// The new list created for the operation.
  /// This is also the return value of this method.
  /// </param>
  /// <param name="items">Items to add to the new list.</param>
  /// <returns>The new list.</returns>
  public ImmutableList<T> Add(out ImmutableList<T> newList, params T[] items) {
    // ...
  }
} 
```

用法：

```
var list = new ImmutableList<string>("Hello", "Immutable");
ImmutableList<string> newList;
list.Add(out newList, "World"); 
```

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2010-11-22T12:52:35.617

对于这种功能，我通常使用第二种形式的动词，`Added`在这种情况下。

这个约定被 Qt 使用，例如[`QVector2D::normalized`](http://doc.qt.nokia.com/4.7/qvector2d.html#normalized)返回一个规范化的向量，同时`QVector2D::normalize`规范化一个向量。

以同样的方式`Added`将返回带有新添加项目的对象。

* * *

## 回答 #74

> 赞同：0
> 
> 时间：2021-01-30T01:33:18.803

相反/除了名称之外，不可变容器集合是运算符重载的经典案例（int/string/etc 已经是这种情况）。这里有两个优点：

*   简洁性：`l1 = l + o1 + o2`而不是`l1 = l.Add(o1).Add(o2)`

*   使用赋值运算符：`l += o`而不是`l = l.Add(o)`

使用运算符还可以使代码更不容易出错，从可变类型切换到不可变类型时忘记赋值并只写 ie `l.Add(o);`（具有灾难性影响）是很常见的，但是只写`l+o;`而不使用结果真的很突出。

[您可以在作为F](https://github.com/kofifus/F/wiki)包一部分的集合中看到这一点。

* * *

## 回答 #75

> 赞同：0
> 
> 时间：2016-01-25T18:21:49.557

另一个赞成的观点`Plus`是新的几乎不可变的[Java 时间 API](http://www.oracle.com/technetwork/articles/java/jf14-date-time-2125367.html)，[`plus()`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html#plus-long-java.time.temporal.TemporalUnit-)例如用于添加到`Instant`s.

# html - IE7 div边框打印问题

> ID：521897
> 
> 赞同：1
> 
> 时间：2009-02-06T19:50:16.133
> 
> 标签：html, css, internet-explorer, firefox, printing

我有一个在 IE7、Firefox 和 Safari 中呈现相同的网页 - 打印时除外。IE7 在打印时似乎为边框分配了太多空间。

在下面的示例中，框高度加上边框应在 2 列中加起来相同的高度。我设置`borders`为`10px`夸大问题。

我讨厌 CSS hack，到目前为止，我已经能够在没有它们的情况下创建我的页面。有什么建议么？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Untitled Page</title>

    <style type="text/css">
    .container 
    {
    height:     120px;  
    width:      240px;
    margin:     0;
    padding:    0;
    border:     solid 1px red;
    }
    .box1 
    {
    height:     10px;   
    width:      100px;
    margin:     0;
    padding:    0;
    border:     solid 10px black;
    float:      left;
    clear:      left;
    }
    .box2 
    {
    height:     100px;  
    width:      100px;
    margin:     0;
    padding:    0;
    border:     solid 10px black;
    float:      right;
    }
    </style>

</head>
<body>

    <div class="container">
    <div class="box1">&nbsp;</div>
    <div class="box2">&nbsp;</div>
    <div class="box1">&nbsp;</div>
    <div class="box1">&nbsp;</div>
    <div class="box1">&nbsp;</div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T20:03:40.660

尝试将 .box1 的 line-height 属性设置为 1%：

```
 .box1 
    {
    line-height:         1%;   
    } 
```

另外，考虑使用 css 重置。

编辑：另外，尝试将 box2 div 放在 box1 div 之前。

使用 line-height 执行此操作可以修复它：

```
 <div class="container">
        <div class="box2"> </div>
        <div class="box1"> </div>

        <div class="box1"> </div>
        <div class="box1"> </div>
        <div class="box1"> </div>
        </div> 
```

# svn - 从颠覆标签自动构建

> ID：521905
> 
> 赞同：12
> 
> 时间：2009-02-06T19:51:45.397
> 
> 标签：svn, build-process, build-automation, build-management

我正在尝试自动化工程组的构建过程。作为自动化的一部分，我试图达到一个点，即应用符合模式的特定标签的行为将启动一个自动化过程，该过程将执行以下操作：

*   查看源代码
*   从模板创建构建脚本
*   构建项目

我很确定我可以用 subversion 中的 post-hook 来做到这一点，但我正试图找出一种方法来用 subversion hook 以外的东西来做到这一点。

*   监视 subversion 存储库中的 tags 目录以启动我的工作流程是否有意义？
*   是否有任何体面的工具可以帮助解决这个问题（如果可能的话，.NET 会很棒）。
*   我最好写一个引擎来做到这一点吗？

我的偏好：

*   完成全部或部分操作的现有产品
*   如果需要进行开发工作，最好使用 .NET
*   适用于 Windows（我们有一个基于 Linux 的存储库，但构建都发生在 Windows 上）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-05-07T20:26:04.837

我已经使用 Hudson 做到了这一点。在常规的颠覆结帐槽中，我有一个主干结帐：

[http://dryad.googlecode.com/svn/trunk/dryad](http://dryad.googlecode.com/svn/trunk/dryad)

然后作为第一个构建操作，我有一个“执行 shell”，并在该 shell 中使用 svn 开关更改为存储库中的最新标记：

svn switch [http://dryad.googlecode.com/svn/tags/](http://dryad.googlecode.com/svn/tags/) 'svn ls [http://dryad.googlecode.com/svn/tags](http://dryad.googlecode.com/svn/tags) | tail -n 1' 树妖

下一个构建步骤是一个 maven 'clean install' 命令，它使用标记版本中的代码启动构建。

我还没有想出如何让 Hudson 开始使用最新的标记版本，而不必进行切换，但是切换工作。然后，您可以在更新标记目录时触发。

它是自动化的......有点杂乱无章，但它有效......

开关应该包含第二个 svn 命令的反引号，但必须使用 ' 因为反引号没有出现在这里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-07T20:42:46.153

我喜欢[hudson](http://hudson-ci.org/) - 易于设置和使用 SVN 开箱即用。

您可以将其配置为在每次提交时构建。

我下载了它并在一天内开始使用它进行构建。它经历了很多调整，但我会推荐给任何人。

我也使用过巡航控制，但对此并不满意。除了跨平台问题之外，我没有任何具体原因。

编辑

我最近在我的 hudson 构建服务器上添加了一个工作，用于监听 google/gmail jabber 聊天。我可以使用这种机制将“常规”构建“提升”为发布构建。我刚刚建立了一个新工作，它执行将私有构建提升/发布到发布候选者所需的步骤。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T08:49:01.020

听起来您正在使用诸如 CruiseControl 或 Hudson 之类的持续集成构建引擎（hudson 是用 Java 编写的，但在 Windows 中非常易于使用）。

现在，您可以为这些工具修改构建脚本以查看标签目录，但这有点不合时宜，因为它们旨在查看特定位置并在该位置构建项目。如果您查看整个标签目录，您很容易最终会在构建机器上签出所有标签，并且您需要一个顶级脚本来决定要构建哪个标签。

对于您想要的，构建引擎可以监视特定位置（例如“/branches/release”）。如果您随后合并到该分支，Hudson 将自动构建项目、归档工件并在一切成功时为您创建一个标签（请参阅 Subversion 标记插件）。

我不喜欢在提交后挂钩中做这种事情，因为它会使提交阶段花费太长时间。然而，TeamCity 是一个源代码控制系统，它有一个功能可以完全做到这一点，而不会在提交时阻止你。

我会为此推荐[哈德森。](http://hudson-ci.org/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T14:08:58.210

[CruiseControl.Net](http://ccnet.thoughtworks.com/)可以轻松地自动从颠覆存储库自动构建。

它可以监控存储库（Svn 和其他几种类型）并使用各种工具启动自动构建。（NAnt、MSBuild 等）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T19:55:04.423

正是出于这个目的，在本网站上发布了一个商业产品！

[http://www.finalbuilder.com/Default.aspx?tabid=314](http://www.finalbuilder.com/Default.aspx?tabid=314)

您可能需要向 SVN 添加一个 post-hook 以触发构建开始，除非您希望它按时间安排运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-03T19:40:46.560

我也会为此推荐哈德森。我想做类似的事情，创建一个标签并开始构建。相反，我选择将此插件用于 hudson：

[http://wiki.hudson-ci.org/display/HUDSON/Release+Plugin](http://wiki.hudson-ci.org/display/HUDSON/Release+Plugin)

并使用它来驱动标签的创建和显式发布构建。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T20:04:15.903

我正在使用[NAnt](http://nant.sourceforge.net/)（和[NAntContrib](http://nantcontrib.sourceforge.net/)）进行自动构建。它会自动检查 subversion 存储库的更改并（如果有）获取最新的源代码版本并开始构建。

我不确定现有任务是否允许完全按照您的意愿行事，但也许您可以将其用作开始，如果需要，可以使用满足您特殊需求的任务对其进行扩展（它是使用 .NET 开发的）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-06T21:18:47.600

就像其他人说的那样，您需要一个持续集成服务器（CruiseControl、CruiseControl.Net、Hudson 等）。虽然您可以处理构建脚本并提交挂钩来执行您描述的功能，但最终您会发现您重新发明了轮子（持续集成服务器）。没必要，有免费可用的解决方案就是为了这个目的。

该过程将与您上面描述的有所不同。构建服务器将：

1.  检测新的提交
2.  签出你的源代码
3.  运行你的构建脚本
4.  成功构建的标签

提交触发进程并创建标签，而不是标签触发进程。服务器这样做是为了监视 svn 存储库而不是提交挂钩。

查看 CruiseControl.Net 关于此主题的文档，特别是选项 tagOnSuccess 和 tagBaseUrl。Hudson 和 CruiseControl 应该有类似的选项。

[http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block](http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block)

# .net - 在 RSACryptoServiceProvider 上找不到文件，服务帐户权限？

> ID：521912
> 
> 赞同：2
> 
> 时间：2009-02-06T19:54:15.533
> 
> 标签：.net, cryptography, certificate

我们的 Web 服务包装了包含以下代码的第三方库。

我们在 IIS 6 应用程序池中使用 Active Directory 服务帐户（没有交互式登录功能）。我们的服务因错误“系统找不到指定的文件”而失败。我们已将错误追溯到`RSACryptoServiceProvider provider = new RSACryptoServiceProvider();`. 第三方程序集的加密过程依赖于基于 x509 文件的证书，并且服务帐户具有对密钥文件夹的读/写访问权限。此外，服务帐户还具有以下权限：

> “C:\Documents and Settings\All Users\Application Data\Microsoft\Crypto\RSA\MachineKeys”。

代码：

```
StringBuilder builder = new StringBuilder(publicKeyData);
builder.Replace("-----BEGIN CERTIFICATE-----", "");
builder.Replace("-----END CERTIFICATE-----", "");
X509Certificate2 certificate = new X509Certificate2( Convert.FromBase64String(builder.ToString()));

string xmlString = certificate.PublicKey.Key.ToXmlString(false);

RSACryptoServiceProvider provider = new RSACryptoServiceProvider(); //BOOM
CspKeyContainerInfo containerInfo = provider.CspKeyContainerInfo;

provider.PersistKeyInCsp = false;
provider.FromXmlString(xmlString);
loadedKeys.Add(key, provider);
provider2 = provider; 
```

我们打开 FileMon 并注意到该 AppPool 有一个 FILE NOT FOUND ，然后是*同一个文件*的另一个 SUCCESS 。

我在这里没有我的元素，有人知道我们为什么会看到这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T20:23:55.003

我不知道是什么导致了错误，但是您可以这样做：

```
StringBuilder builder = new StringBuilder(publicKeyData);
builder.Replace("-----BEGIN CERTIFICATE-----", "");
builder.Replace("-----END CERTIFICATE-----", "");
X509Certificate2 certificate = new X509Certificate2( Convert.FromBase64String(builder.ToString()));

RSACryptoServiceProvider provider = 
  (RSACryptoServiceProvider) certificate.PublicKey.Key;

loadedKeys.Add(key, provider);
provider2 = provider; 
```

如果你很幸运，那可以解决这个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-19T02:51:47.473

您看到这个的原因是因为 RSACryptoService 提供程序在机器密钥存储上打开了一个排他锁。如果您正在阅读证书并不重要，使用该对象会导致锁定

解决方法有两种：

1.  使用非 Microsoft RSA 堆栈。
2.  访问对象时使用 lock()。

我遇到了同样的事情并最终编写了我自己的 RSA 函数集。

您还可以在 ASP.NET 池中设置用户配置文件关联；这样，将使用用户配置文件密钥库

# optimization - 我的索引页是否太大？

> ID：521921
> 
> 赞同：0
> 
> 时间：2009-02-06T19:56:15.887
> 
> 标签：optimization, bandwidth, filesize

我现在正在开发一个我已经工作了一年多的网站。今天，距离发布还有一周左右的时间，所以我开始复习去年没有复习的事情——包括加载时间。我没有注意到任何加载问题，但我仍然想看看。

以下代表我的索引页面：

```
文件（1 个文件）22 KB
图片（53 个文件）96 KB
对象（0 个文件）   
脚本（9 个文件）90 KB - 包括 jQuery.min.js
样式表（6 个文件）23 KB
-------------------------------------------
                总计 230 KB

```

我们不再生活在 56k 和 28.8 的世界中，但我想知道现在应该认为什么太大了。我还应该提到，Analytics 报告 3.28% 的访问者有拨号。这些用户当前浏览的索引页面大小为 158kb。

其他有趣的索引页面大小：

*   谷歌：20kb
*   亚马逊：525kb
*   堆栈溢出：121kb
*   挖掘：58kb
*   修订版 3：936kb

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T20:00:52.930

不是直接回答，而是[Yahoo! Exceptional Performance](http://developer.yahoo.com/performance/)网站包含有关前端工程问题的文章和技巧，例如这些可能会影响用户对网站加载时间的感知。

特别是，我建议可以减少发出的 HTTP 请求的数量——例如，6 个样式表和 59 个图像——也许其中一些图像可以通过[精灵](http://developer.yahoo.com/performance/rules.html#opt_sprites)来减少这个数字？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T20:00:08.967

这是相当大的，但我不会认为这是一个问题，直到/除非它**成为**一个问题。*在任何*情况下都要警惕过早的优化。

# c++ - InternetReadFile 问题（错误 87 - 参数不正确）

> ID：521922
> 
> 赞同：0
> 
> 时间：2009-02-06T19:56:16.527
> 
> 标签：c++, winapi, wininet

我的 InternetReadFile 有问题，如果我在没有代理的计算机上运行应用程序，应用程序运行正常，但如果我尝试在使用代理的计算机上使用，我收到错误 87（参数不正确）。

那是我的代码：

```
conHandle = InternetOpen("Test", INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0); 
... 
hFile = InternetOpenUrl(conHandle, url.c_str(), NULL, 0, INTERNET_FLAG_RELOAD, 0);  
... 

if (!InternetReadFile(hFile, buffer, maxBufferSize, &size)) 
{ 
    // error 
} 
```

而且我还尝试使用：

```
InternetOpen("Test", INTERNET_OPEN_TYPE_PROXY, "proxystr", NULL, 0); 
```

但也没有成功。

任何人都知道我做错了什么？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-17T10:18:38.937

您需要在循环中不断调用 InternetReadFile，直到它返回 TRUE 并且读取的字节数为 0。这通常意味着至少 2 次 InternetReadFile 调用。

```
while ( InternetReadFile( hFile, buffer, maxBufferSize, &size ) == FALSE || size > 0 )
{
   // process buffer contents.
   // for ex: write the contents of buffer to a temp file for example.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-01T10:17:43.323

它应该是：

```
while (InternetReadFile(hFile, buffer, maxBufferSize, &size) == TRUE || size > 0)
{
   // process buffer contents.
   // for ex: write the contents of buffer to a temp file for example.
} 
```

# exception - 如何在速度模板中打印异常的堆栈跟踪

> ID：521923
> 
> 赞同：2
> 
> 时间：2009-02-06T19:56:32.190
> 
> 标签：exception, stack-trace, velocity

如何使用速度模板打印异常的完整堆栈跟踪

我现在的模板有 $exception 作为模板变量，其中包含异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T23:10:05.633

在速度上，这就是我解决这个问题的方法。

```
#foreach ($i in [1..3])     
   #if（$异常。原因）
           #set($exception = $exception.Cause)
           #foreach($stack in $exception.getStackTrace())
               $stack.toString()
           ＃结尾     
    ＃结尾
＃结尾

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T20:58:33.123

如果您想在输出中显示跟踪，您可以将评估方法包装在 try-catch-finally 块中。在 catch 中将堆栈跟踪或仅将异常消息写入编写器。在最后部分，只需刷新作者即可。

如果我没记错的话是这样的：

```
StringWriter w = new StringWriter();
try {
    Velocity.evaluate( context, w, "mystring", s );
} catch (Exceptions... e)
    w.write(e.getMessage());
} finally {
    w.flush();
} 
```

# javascript - IE 警告解决方法？带有安全和不安全项目的页面

> ID：521925
> 
> 赞同：5
> 
> 时间：2009-02-06T19:56:54.137
> 
> 标签：javascript, php, internet-explorer, https

我有一个在 URL 中使用“https”保护的页面，该页面还包含用于播放来自 youtube 的视频的 youtube url。由于 youtube URL 包含没有 's' 的“http”，IE 会给出“此页面包含安全和非安全项目”的警告对话框。

有没有办法在Javascript中解决这个问题？也许在页面加载后生成带有函数的 youtube 播放器 HTML？网址仍必须以“http://”开头

编辑：感谢大家到目前为止的投入！我知道这听起来不可能。如果有一些条件注释或其他内容，我会很高兴，这样我就可以告诉 IE 禁止显示此对话框。它让我们的客户感到困惑，因为世界上大部分地区都在 IE 中，FF 的行为要好得多，因为它会告诉您是否单击了损坏的锁，而不是烦人的弹出窗口。这就像一个新版本的“你的程序执行了非法操作”。（用户向警方隐藏）我将 youtube 视频嵌入到 src 来自 youtube 的页面上。我正在使用他们的播放器，因为它是由他们托管的。在我看来，这是没有办法的。

我想我的解决方法是仅将 HTTPS 应用于非常敏感的页面（密码更改、登录）并在所有其他页面中退出，因此 youtube 视频不会出现此弹出窗口。我在 PHP 中，我担心如果我这样做，SESSION 会被破坏，但我想这是唯一的方法，我会等待周一解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T21:15:52.467

我为解决这个问题所做的一件事是在我的 SSL 站点上创建一个页面，该页面代理第 3 方资源。这样客户端只能看到 SSL URL。

例如，您的 Flash 播放器可以指向 URL“ [https://YourSite.com/proxy.aspx?URL=http://www.youtube.com/video.swf](https://YourSite.com/proxy.aspx?URL=http://www.youtube.com/video.swf) ”。当调用“proxy.aspx”时，它会向查询字符串中的 URL 发出一个新的 Web 请求，并将数据返回给客户端。

如果您这样做，您需要验证代理 URL 或使用某种 ID 以使 URL 无法更改，因为您要让浏览器相信此内容是可信的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T23:51:22.383

我已经使用以下方法在所有浏览器上解决了这个问题：

1) 在快照上使用“播放图像”标签创建视频开头的缩略图图像，并将图像托管在您自己的 https 服务器上。将缩略图嵌入您希望视频所在的位置。

2) 当用户单击图像时，调用 Javascript onclick 处理程序以使用 http 嵌入式 youtube 视频的 href 创建一个新窗口。

```
function onImgClickHandler() {
  //Link to embedded Viddler or Youtube video
  var win = window.open("http://www.viddler.com/player/###/", "My Video",
    'height=500,width=800,resizable=yes,scrollbars=yes');
  win.focus();
} 
```

3) 视频现在将出现在主页的弹出窗口中。

我通常将视频用作我网站的教程，因此将视频放在弹出式浏览器窗口中效果很好，因为它可以与主要内容一起查看，并让用户跟随网站。浏览器甚至不会给出您正在从 https 站点调用 http 弹出窗口的重定向警告，因此您的用户不会在任何浏览器上看到任何“可怕的”非安全项目警告。

希望这会有所帮助，我在我的网站的登录页面上有一个上述示例：[https ://drchrono.com/](https://drchrono.com/)

更新：我通过拍摄播放视频的屏幕截图来进行图像预览。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-31T23:18:23.310

根据[最近的 YouTube API 博客文章](http://apiblog.youtube.com/2011/02/https-support-for-youtube-embeds.html)，嵌入的 YouTube 视频已经支持通过 HTTPS 访问。如果是这种情况，（我还没有测试过，但同样我没有理由不相信他们），那么你应该能够将“s”粘贴到你的嵌入 URL 中，它会工作得很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T20:58:27.760

如果有办法解决它，那将是 IE 中的一个安全漏洞，微软会修补它，所以我认为你不会在没有警告的情况下摆脱混合内容。

唯一的选择是自己托管 FLV。有许多不错的基于 SWF 的 FLV 播放器可用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T21:58:59.960

在安全网页上有不安全的链接是一个几乎没有解决方法的问题。一种选择是在用户通过 https 连接时排除页面上的特定内容。这样，非安全页面加载将显示内容，而安全页面加载将不显示内容：

```
<% if (!Request.IsSecureConnection){ %>
    <div>You can't see this if the page is secure<div>
<%} %> 
```

我已经成功地使用了这种方法......希望这会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-08T12:12:45.983

Apache httpd 服务器的*mod_rewrite*模块可用于在 SSL 安全页面上嵌入 YouTube 视频而不会出现任何错误，如[Adam Mershon 的博客](http://www.adammershon.com/how-to-embed-a-youtube-video-on-a-secure-page/)中所述。

它涉及设置重写规则以将 SSL 域中的路径重定向到非 SSL YouTube：

### .htaccess

```
RewriteEngine on
RewriteBase /
RewriteRule ^youtube/(.*)$ http://www.youtube.com/$1 [L] 
```

这样您就可以在 HTML 中嵌入看似来自您自己域的 YouTube 链接 URL，例如：

```
<embed src="https://www.yourdomain.com/youtube/v/mydjFYoD4WS&hl=en_US&fs=1&rel=0&autoplay=1&"
       type="application/x-shockwave-flash"
       allowscriptaccess="always"
       allowfullscreen="true"
       width="560"
       height="340">
</embed> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-10T00:35:16.560

我遇到了同样的问题并找到了解决方案。

它无需打开 SSL 认证即可工作。

[分步指南修复谷歌浏览器](http://molometer.hubpages.com/hub/This-Site-Has-Insecure-Content-Google-Chrome-And-How-To-Fix-It)

您可以查看下面列出的固定页面。它有指向 YouTube、Flickr 和许多其他网站的链接。它是安全的，现在已经有几个月了。希望对你也有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T19:20:52.027

使用 Javascript 替换 URL 不起作用。IE7 拦截内容，然后是警告。

我尝试使用 (jQuery) $(function() { }); 它**有点**工作。您可以在对话框中单击是/否，仍然会加载内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-31T22:03:49.477

这在我的世界里是一个严重的问题。它从用户那里赢得了我的工作评论，例如“它不方便用户”、“它坏了”或“它杀死了我的小猫”。

**代理解决方案可能是唯一会推出的伪修复。只是它显然也不是一个完美的解决方案。**

我尝试通过在 https 上运行尽可能多的网站来更好地导航这一点。显然，youtube 案例并没有因此而得到解决。

IE，多么愚蠢的 FUD 推动憎恶软件。我希望 IE9 真的像看起来那样好得多。只是，不支持 XP 意味着，它有点像它从未发布过。作为 n00biest 用户，会在不知不觉中对现状进行写保护，直到 XP 驱动的 2247 的中国天网最终为我们提供了红色药丸......

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-02-06T21:19:01.057

您的问题发生在使用 Https 获取主页，而使用 http 获取一个或多个包含文件（图像、javascript、css 等）时。将 http url 修复为 https。

# c# - Firefox 插件：没有发现像 C# 中的消息显示那样的更新

> ID：521926
> 
> 赞同：0
> 
> 时间：2009-02-06T19:56:59.660
> 
> 标签：c#

在 firefox 插件更新对话框中，将显示一个可以关闭的消息提示。我在 C# 中寻找类似的东西：http: [//www.codeproject.com/KB/static/CtrlMessageBar.aspx](http://www.codeproject.com/KB/static/CtrlMessageBar.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:01:25.567

开箱即用的东西没有这样的东西。您可以自己开发类似的东西，只需使用一个包含其他内容的面板，然后在显示错误面板时移动该内容（当然会导致调整大小），或者您可以将其作为您下拉的控件在任何控件上，并且仅在您希望它显示时才使其可见。

# c# - 将位图保存到 MemoryStream 的 GDI+ 异常

> ID：521927
> 
> 赞同：3
> 
> 时间：2009-02-06T19:57:08.740
> 
> 标签：c#, .net, winforms, gdi+

我在 Windows 窗体应用程序中遇到问题，当我保存到 MemoryStream 时，Bitmap.Save 失败。该问题似乎仅在一台机器上间歇性发生（到目前为止），而坏消息是在客户站点上。我无法在机器上调试，但我得到了一个堆栈跟踪，将问题缩小到一行代码。

这是我的代码的精简版本：

```
byte[] ConvertPixelsToBytes()
{
    // imagine a picture class that creates a 24 bbp image, and has
    // a method to get an unmanaged pixel buffer.
    // imagine it also has methods for getting the width,
    // height, pitch 

    // I suppose this line could return a bad address, but 
    // I would have expected that the Bitmap constructor would have 
    // failed if it was
    System.IntPtr pPixels = picture.GetPixelData();

    System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(
            picture.width(),
            picture.height(),
            picture.pitch(),
            System.Drawing.Imaging.PixelFormat.Format24bppRgb,
            pPixels );

    // This line doesn't actually free the memory, but it could be freed in a 
    // background thread
    // (2)
    picture.releasePixelData(pPixels);

    System.IO.MemoryStream memStream = new System.IO.MemoryStream();
    try
    {
        // I don't see how this line could fail, but it does
        // (3)
        bmp.Save(memStream, System.Drawing.Imaging.ImageFormat.Bmp);
        return memStream.ToArray();
    }
   catch(System.Runtime.InteropServices.ExternalException e)
   {
       // e.Message is the very helpful " A generic error occurred in GDI+."
   }
   finally
   {
       memStream.Dispose();
   }
   return new byte[0];
} 
```

知道会发生什么吗？我很确定我的像素缓冲区是正确的，它始终可以在我们的开发/测试机器和其他客户站点上运行。

我对失败的可能原因的看法是

一种。位图构造函数不会复制像素数据，而是保留对它的引用，由于内存被释放，保存失败。我没有发现 MSDN 文档在这一点上很清楚，但我假设 Bitmap 复制像素数据而不是假设它被锁定。

湾。像素数据无效，导致 Save 方法失败。我对此表示怀疑，因为我的像素数据是每像素 24 位，所以据我所知它不应该是无效的。

C。.NET 框架存在问题。

如果您对其他可能的失败原因有任何想法，我将不胜感激，这样我就可以在我的应用程序中添加额外的检查和日志记录信息，这样我就可以将一些东西发送到现场。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T23:17:38.710

该 Bitmap 构造函数的 MSDN 文档毫无疑问：

> **备注** 调用者负责分配和释放由scan0 参数指定的内存块，但是，*在释放相关Bitmap 之前不应释放内存。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T20:11:04.763

你试过搬家吗

```
 picture.releasePixelData(pPixels); 
```

到

```
 finally
   {
       memStream.Dispose();
       picture.releasePixelData(pPixels);
   } 
```

这听起来绝对像是一个线程问题（特别是因为您声明 releasePixelData 可能发生在后台线程上）。线程问题总是只发生在一台机器上，而且总是在客户端机器上（可能是因为他们只有 256Megs 的内存或者一些荒谬的东西，垃圾收集器很早就开始了，或者机器有四核并且您的开发人员机器是双核或其他东西）。

# javascript - javascript 编码是否适用于任何特定的服务器语言？

> ID：521934
> 
> 赞同：0
> 
> 时间：2009-02-06T19:57:50.157
> 
> 标签：javascript

javascript 编码是否适用于任何特定的服务器语言？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-06T19:59:09.673

不会。客户端 JavaScript 不受用于编码服务器端处理的语言的影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T20:11:16.950

如果您打算做任何类型的 XML/“AJAX”的东西，请确保您在服务器端选择的语言具有强大的 XML 和 JSON 库。如果你不以这种方式使用它，它不应该有任何区别。拥有适当的库将在以后为您省去很多麻烦，因为您不会被迫构建自己的库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T20:17:37.340

最简洁的答案是不。

长答案是，不，但您仍然应该简化服务器端代码和 JavaScript 之间的接口：

1.  使用标准化的数据序列化格式（XML 或 JSON 是最流行的形式）。确保你的序列化器和解析器是对称的；即你可以在两边自由读取和生成数据。不要假设您将始终在客户端读取并在服务器上写入。

2.  将在服务器端手动制作 JavaScript 限制在最低限度。尽量不要使用内联脚本块转储 JavaScript 函数。尝试使用 JavaScript 将事件侦听器附加到元素，而不是使用`onclick`or `href="javascript:"`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T20:06:09.347

不，但在某些情况下有更好的集成，服务器端代码会自动生成 JavaScript，例如 .NET 框架和 Google Web Toolkit。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T20:07:57.487

假设您的意思是客户端 JavaScript，不。当 JavaScript 执行时，它处于服务器端代码不可见的环境中。事实上，对于 JavaScript 来说，甚至要确定是哪个服务器大小的环境创建了它正在操作的文档，这都是很棘手的。它所看到的只是输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T20:12:27.367

客户端 javascript 绑定到浏览器，而不是任何特定语言。这一切都基于您的服务器到客户端浏览器的实际输出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T21:08:16.193

也许问题应该是 - 服务器语言如何或为什么会有所作为。最后，无论语言/平台如何，都会吐出文本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T02:37:40.100

如果您在服务器端有 javascript，您可以共享代码 - 例如通过进行客户端表单验证，并在将其提交到数据库之前在服务器上使用相同的验证代码。

# asp.net - 按钮点击事件

> ID：521936
> 
> 赞同：1
> 
> 时间：2009-02-06T19:58:35.303
> 
> 标签：asp.net

我在一个页面上有几个用户控件实例。它们也相互嵌套。由于这些控件是动态创建的，因此我无法维护它们的状态。我决定手动将状态保存到持久媒体（可能是 Session）。

在主机页面上的按钮上的单击事件上，我想编写功能以在回发发生之前保存控件的状态（一旦有回发，控件就会重新创建并且我会丢失状态）。

如果我把这个逻辑放在按钮事件处理程序中，因为这是在回发之后执行的，所以我不再有信息了。

我应该覆盖哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T20:10:53.517

尝试在页面初始化中而不是在加载时创建按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T23:02:48.147

Actually you want to be loading your dynamic controls in the LoadViewState method override. Don't try to maintain state yourself; it is a waste of time. You just have to put your code in the right place.

See [My previous comments on this](https://stackoverflow.com/questions/45176/what-do-you-do-when-you-cant-use-viewstate/46227#46227)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:03:43.283

没有真正回答你的问题，但我很好奇为什么你的按钮布局会被重置。你在通过 javascript 做某事吗？

你是如何创建你的按钮的。在 page_load 中？你在检查它的回发时间吗？

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!Page.IsPostBack)
    {
        // load all buttons
        LoadButtons();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T20:05:38.160

听起来您正在重新创建回发控件，因此它们失去了状态。您应该使用 Page.IsPostBack 来防止这种情况。还要检查页面是否允许 Viewstate。

# wpf - ListBox 中的所有 ComboBox 在其中任何一个更改时都会更改

> ID：521941
> 
> 赞同：4
> 
> 时间：2009-02-06T20:00:38.313
> 
> 标签：wpf, data-binding, combobox, listbox

我有一个`ListBox`绑定到`ObservableCollection`自定义类型的表单。在每个项目中都有`ComboBox`一个枚举类型的绑定。窗口加载时，所有`ComboBox`es 都默认为某个值。当我`SelectedItem`为任何一个（从 UI，而不是代码）更改 es 时，所有其他`ComboBox`es 都更改为相同的`SelectedItem`.

我不确定我做错了什么，这是我当前正在处理的 XAML。

```
<Window.Resources>
    <ObjectDataProvider x:Key="SyncOperationValues"
                        MethodName="GetNames"
                        ObjectType="{x:Type sys:Enum}">
        <ObjectDataProvider.MethodParameters>
            <x:Type TypeName="local:SyncOperationEnum" />
        </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>
...
    <DataTemplate x:Key="SyncListTemplate">
        <Grid Grid.Column="1" Grid.RowSpan="2" Margin="0,0,20,0" x:Name="olDetails"
            DataContext="{Binding Path=OlContact}">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
                <RowDefinition />
                <RowDefinition />
                <RowDefinition />
                <RowDefinition />
            <RowDefinition />
            </Grid.RowDefinitions>
...
            <ComboBox x:Name="SyncOp" 
                Width="120" Height="19"
                Margin="4,0,10,0" 
                IsSynchronizedWithCurrentItem="True" 
                ItemsSource="{Binding Source={StaticResource SyncOperationValues}}"
                             SelectedItem="{Binding Operation}"
                             VerticalAlignment="Center" />

... 
```

和`ListBox`：

```
 <ListBox x:Name="SyncList"
     ScrollViewer.HorizontalScrollBarVisibility="Hidden"
     ItemContainerStyle="{StaticResource StretchedContainerStyle}"
     ItemTemplate="{StaticResource SyncListTemplate}">
 ListBox> 
```

我尝试了一些不同的选项，例如绑定到 a `CollectionView`; 但是似乎没有任何效果。谁能指出我的错误？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T21:31:11.703

我遇到了与此类似的情况，并将 ComboBox 上的 IsSynchronizedWithCurrentItem 属性设置为“False”修复了它。我理解它的方式，将值设置为“True”意味着 ComboBox 值将是 ListBox 的当前项的同步值。基本上，所有 ComboBoxes 都绑定到相同的值。听起来这就是你正在经历的。尝试：

```
IsSynchronizedWithCurrentItem="False" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T16:36:02.177

我终于找到了解决办法。我最终为枚举类型编写了一个 ValueConverter。我一直认为这不是必需的，但由于某种原因，至少如果 ComboBox 在另一个列表（在我的情况下为 ListBox）中的话。

我确实需要按照 John M 的建议将 IsSynchronizedWithCurrentItem 属性设置为 false，因此感谢 John！这是转换器代码，以防其他人需要做这样的事情。

```
[ValueConversion( typeof( SyncOperationEnum ), typeof( String ) )]
public class SyncOperationConverter : IValueConverter {
    #region IValueConverter Members

    public object Convert( object value, Type targetType, object parameter, System.Globalization.CultureInfo culture ) {
        if( value != null && value.GetType() == typeof( SyncOperationEnum ) )
            return Enum.GetName( typeof( SyncOperationEnum ), value );

        return null;
    }

    public object ConvertBack( object value, Type targetType, object parameter, System.Globalization.CultureInfo culture ) {
        if( value != null && targetType == typeof( SyncOperationEnum ) )
            foreach( object enumValue in Enum.GetValues( targetType ) )
                if( value.Equals( Enum.GetName( targetType, enumValue ) ) )
                    return enumValue;

        return null;
    }

    #endregion 
```

我的 XAML 现在看起来像这样：

```
<Window.Resources>
    <local:SyncOperationConverter x:Key="SyncConverter" />

    <ObjectDataProvider x:Key="SyncOperationValues"
                    MethodName="GetNames"
                    ObjectType="{x:Type sys:Enum}">
        <ObjectDataProvider.MethodParameters>
            <x:Type TypeName="local:SyncOperationEnum" />
        </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>
...
<DataTemplate x:Key="SyncListTemplate">
    <Grid Grid.Column="1" Grid.RowSpan="2" Margin="0,0,20,0" x:Name="olDetails"
        DataContext="{Binding Path=OlContact}">
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
        <RowDefinition />
        </Grid.RowDefinitions>
...
        <ComboBox x:Name="SyncOp" 
            Width="120" Height="19"
            Margin="4,0,10,0" 
            IsSynchronizedWithCurrentItem="False" 
            ItemsSource="{Binding Source={StaticResource SyncOperationValues}}"
            SelectedValue="{Binding Path=Operation,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource SyncConverter}}"
            VerticalAlignment="Center" /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-06T20:53:45.507

看起来您的“操作”属性应该是静态属性。由于它在您更改它时绑定到每个 ComboBox，所以其他一切都在您的 XAML 中，只需使属性如下所示

```
 static SyncOperationEnum _operation;

    public static SyncOperationEnum Operation
    {
        get { return _operation; }
        set { _operation = value;}
    } 
```

# c++ - 如何在不离开 X.11 环境的情况下开发 DirectFB 应用程序

> ID：521957
> 
> 赞同：12
> 
> 时间：2009-02-06T20:03:54.203
> 
> 标签：c++, linux, user-interface, framebuffer, directfb

我正在尝试为嵌入式平台开发一个 GUI 应用程序，没有任何窗口，我正在使用 DirectFB 来做这件事，它非常适合我的需求。

由于我开发的嵌入式没有那么强大，我真的很想尝试在自己的 Ubuntu 桌面上进行开发。问题是 Framebuffer 与 X.org 冲突导致我离开整个桌面，并关闭 X.org 只是为了查看我的更改结果。

有适合我需要的好的帧缓冲模拟器吗？Qt 有一个，叫做 QVFb，但它只适用于开发 Qt 应用程序，并且 DirectFB 的 VNC 后端总是崩溃。

那么，有什么想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-07T02:29:53.050

DirectFB 有一个 X11 后端。

```
$ sudo apt-get install libdirectfb-extra # 对于 Debian 和 Ubuntu，无论如何
$ 猫 ~/.directfbrc
系统=x11
强制窗口
```

此外，DirectFB 有一个 SDL 后端，而 SDL 有一个 X11 后端。此外，SDL 有一个 GGI 后端，而 GGI 有一个 X 后端。这有点迂回，但它应该工作:)

我用它测试过

```
$ SDL_VIDEODRIVER=directfb ffplay some_movie.avi
```

并获得了一个不错的 640x480 窗口，带有媒体播放和 DirectFB 处理分层和输入，所以我确信这可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-31T23:01:00.263

前面三个答案都是很好的建议。我建议尝试 ehemient 的答案，因为它是最简单的。有关设置 .directfbrc 文件的更多详细信息，请查看“man directfbrc”。

另一种可能性是从 X 切换到另一个虚拟终端（使用 CTRL+ALT+F1），运行您的 directfb 程序，然后切换回 X（使用 CTRL+ALT+F7）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-26T03:25:55.177

我开始使用 ehemient 的解决方案在 chroot 环境（目标文件系统由[buildroot](http://buildroot.uclibc.org)提供）中运行 DirectFB 应用程序，此外还有 Xnest，这是一个在当前 X 的窗口中运行的单独 X 环境。

```
$ Xnest -ac :1 &
$ cd $TARGET_DIR # into the target file system root
$ DISPLAY=:1 sudo chroot . usr/bin/df_neo 
```

这样，您不仅可以确保您的 directfb 安装正确，而且所有必需的依赖项都安装在 chroot 文件系统中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T21:30:01.407

您可以使用[Moblin Image Creator](http://v1.moblin.org/projects/projects_image-creator.php)创建 Moblin 的磁盘映像，然后您可以在[QEMU](http://bellard.org/qemu/)之类的 VM 中运行该映像。然后，您可以在虚拟机中测试您的 DirectFB 应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T04:07:32.917

您可以在 Ubuntu 桌面上开发（即编辑和编译）您的应用程序，并在打算运行的嵌入式平台上测试您的应用程序。

如果嵌入式平台支持网络，您可以通过直接从 NFS 共享运行应用程序来减少编辑-编译-测试循环的长度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-17T14:56:42.907

这是 qemu 和 directFB 的一个很好的例子：

*   [http://free-electrons.com/community/demos/qemu-arm-directfb/](http://free-electrons.com/community/demos/qemu-arm-directfb/)

# c++ - 为什么运行时库是编译器选项而不是链接器选项？

> ID：521972
> 
> 赞同：13
> 
> 时间：2009-02-06T20:07:27.517
> 
> 标签：c++, c, visual-studio, linker

我正在尝试使用 Visual Studio 2005 构建一个 C/C++ 静态库。由于运行时库的选择是一个编译选项，我不得不构建我的库的四个变体，一个用于运行时库的每个变体：

*   /MT - 静态运行时库
*   /MD - DLL 运行时库
*   /MTd - 调试静态运行时库
*   /MDd - 调试 DLL 运行时库

这些是*编译器*选项，而不是链接器选项。来自 Linux 背景，这似乎很奇怪。不同的运行时库有不同的调用约定吗？为什么不能在链接时解析不同的运行时库，即当我链接使用我的静态库的应用程序时？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T22:04:49.917

这些选项可以添加在运行时库头文件中使用的定义（例如 __DLL 和 __DEBUG）。一件常见的事情是在动态链接时将 __declspec(dllimport) 添加到函数声明中。

编译器似乎也使用这些来帮助链接器链接到正确的库。这在[MSDN](http://msdn.microsoft.com/en-us/library/2kzt1wy3(VS.80).aspx)中有说明。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T03:53:41.383

C 预处理器定义的一个副作用就像`_DLL`zdan`_DEBUG`提到的那样：

某些数据结构（例如 STL 容器和迭代器）在调试运行时可能会具有不同的大小，这可能是由于`_HAS_ITERATOR_DEBUGGING`和`_SECURE_SCL`. 您必须使用[与您链接到的库二进制兼容的结构定义来](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=352680)编译代码。

如果您混合和匹配针对不同运行时库编译的目标文件，您将收到如下链接器警告：

```
warning LNK4098: defaultlib 'LIBCMT' conflicts with use of other libs 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T00:59:48.753

编译器需要知道您是在生成单线程代码还是多线程代码。默认情况下，编译器生成线程安全代码（多线程）。如果您需要单线程代码，您必须告诉它。如果您更改默认值，编译器会更改默认运行时库（您始终可以在链接器命令选项中覆盖它，只需确保您选择的库具有相同的代码结构作为您的目标文件：单线程静态、多线程静态或多线程 DLL）。请注意，没有单线程 DLL 选项（根据定义，运行时库 DLL 将被构建为线程安全的，因为它由多个应用程序共享）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T21:35:54.297

如果您忽略静态运行时，那么您将获得与 Linux 相同的选项。

我知道静态运行时可能很有用，但我从来没有真正需要它。它还导致处理内存分配/解除分配的潜在问题，因此我发现仅使用 DLL 运行时更容易。

发布/调试版本与 Linux/Unix 相同。
尽管出于效率考虑，我也构建了单线程和多线程版本的库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T20:11:37.260

我相信这背后的原因是 SEH（结构化异常处理程序）代码的生成方式会有所不同，具体取决于您链接的运行时库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-30T04:16:27.353

为 DLL 和静态库生成了不同的机器代码。

在 Linux 上你必须这样做，如果你想构建一个共享库，编译器标志称为 -fPIC。否则在 AMD64 和 SPARC（可能还有其他）上它会崩溃。在 i386 架构上，链接器足够聪明，并且不会在内存中共享库，因此不会崩溃。

# c# - 是否可以使用 HttpWebRequest 更改标头顺序？

> ID：521977
> 
> 赞同：5
> 
> 时间：2009-02-06T20:08:48.653
> 
> 标签：c#, sockets, httpwebrequest, http-headers

我需要更改标题的顺序，我正在使用这个：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);
request.Method = context.Request.HttpMethod;
request.UserAgent = context.Request.UserAgent; 
```

输出是：

```
GET /* HTTP/1.1
User-Agent: My Server
Host: 127.0.0.1:1080 
```

但应该是

```
GET /* HTTP/1.1
Host: 127.0.0.1:1080
User-Agent: My Server 
```

有任何想法吗？

谢谢你的时间。

编辑：也许有一种使用其他对象的方法......这也是一种选择

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T21:22:13.077

有一个突出的抱怨是 .NET 不久前不允许您修改`Host`标头。可能还没有解决。如果它*真的*那么重要，您总是可以编写套接字级代码来发送准备好的请求（因为它只是文本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-01T12:19:31.403

我今天遇到了这个问题，但我创建了这个 hack：

```
 /// <summary>
        /// We aren't kids microsoft, we shouldn't need this
        /// </summary>
        public static void UnlockHeaders()
        {
            var tHashtable = typeof(WebHeaderCollection).Assembly.GetType("System.Net.HeaderInfoTable")
                            .GetFields(BindingFlags.NonPublic | BindingFlags.Static)
                            .Where(x => x.FieldType.Name == "Hashtable").Single();

            var Table = (Hashtable)tHashtable.GetValue(null);
            foreach (var Key in Table.Keys.Cast<string>().ToArray())
            {
                var HeaderInfo = Table[Key];
                HeaderInfo.GetType().GetField("IsRequestRestricted", BindingFlags.NonPublic | BindingFlags.Instance).SetValue(HeaderInfo, false);
                HeaderInfo.GetType().GetField("IsResponseRestricted", BindingFlags.NonPublic | BindingFlags.Instance).SetValue(HeaderInfo, false);
                Table[Key] = HeaderInfo;
            }

            tHashtable.SetValue(null, Table);
        } 
```

那么你只需要`UnlockHeaders`在程序启动时调用该函数一次，调用HttpWebRequest类中的Header Collection之后，就会接受任何需要手动添加的header。

然后在向请求添加任何标头之前，请执行以下操作：
`myHttpWebRequest.Headers["Host"] = "www.example.com";`

在第一个标头之后将是主机，因为看起来在某些 .net 版本中标头字段具有更高的优先级。

# excel - 是否可以通过 COM 将图像插入到 excel 单元格中？

> ID：521979
> 
> 赞同：1
> 
> 时间：2009-02-06T20:09:18.403
> 
> 标签：excel, com, image, automation

我已经使用自动化将值插入单元格，但是我从未见过任何文档，例如，演示插入除文本和/或公式之外的任何内容。

有没有人能够从外部应用程序插入图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T20:18:08.200

```
Dim FileName as string
FileName="c:\text.jpg"
Set NewPic = ActiveSheet.Pictures.Insert(FileName)
NewPic.top=100
NewPic.left=100 
```

如果要将图片定位到特定单元格，则选择该单元格作为范围并使用该范围顶部/左侧/与来定位图片。

示例：[http ://exceltip.com/st/Insert_pictures_using_VBA_in_Microsoft_Excel/486.html](http://exceltip.com/st/Insert_pictures_using_VBA_in_Microsoft_Excel/486.html)

**注意**：在 Excel 单元格中不能包含图片。图片位于漂浮在单元格周围的不可见绘图层上。它们可以根据细胞坐标定位，这使得它们感觉就像它们生活在细胞中一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T04:17:56.493

我看到它已经得到了回答，但请参阅我的帖子[here](https://stackoverflow.com/questions/688485/how-can-i-find-out-about-undocumented-net-com-library-functions)。

基本上不要使用 Worksheet.Pictures.Insert 方法（MSDN 建议您不要直接使用它，它会返回一个原始 COM 对象），而是尝试使用 Worksheet.Shapes.AddPicture 方法。

```
Dim range As Microsoft.Office.Interop.Excel.Range
Dim pic as Microsoft.Office.Interop.Excel.Shape
Dim filePath as String

range = ...
filePath = ...
pic = range.Worksheet.Shapes.AddPicture(filePath, Microsoft.Office.Core.MsoTriState.msoFalse, Microsoft.Office.Core.MsoTriState.msoCTrue, range.Left, range.Top, 300, 300) 
```

它不是那么简单，因为您必须指定确切的位置和尺寸，但除此之外，非常酷！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T20:20:52.827

当然，以下代码是使用 Microsoft 互操作库的一个很好的示例：

```
 string excelfilename = @"C:\excelfile.xlsx";
   string picturename = @"C:\image.jpg";

    object missing = Type.Missing;
    Microsoft.Office.Interop.Excel.Application app = new ApplicationClass();
    Workbook book =  app.Workbooks.Add(missing);
    Worksheet sheet = (Worksheet)book.ActiveSheet;
    Pictures pics = (Pictures)sheet.Pictures(missing);
    pics.Insert(picturename, missing);
    book.SaveAs(excelfilename, missing, missing, missing, missing, missing, XlSaveAsAccessMode.xlNoChange,
        missing, missing, missing, missing, missing);
    app.Quit();
    app = null; 
```

# regex - 如何使用 Perl 正则表达式在已知标记之前和之后提取文本？

> ID：521996
> 
> 赞同：2
> 
> 时间：2009-02-06T20:14:22.013
> 
> 标签：regex, perl

谁能告诉我如何识别中间部分`interestedInThis`并反向引用 prefix:`fontsize=12`和 postfix: `fontstyle=bold`as `${1}`and `${2}`？

我正在处理这个字符串：

```
<fontsize=12 interestedInThis fontstyle=bold> 
```

附录：对不起，我不够准确，以下是具体内容：

*   前缀和后缀可能不存在
*   prefix 和 postfix 可以是任何字符串，不一定是 fontsize，resp。字体样式
*   我肯定知道我在寻找什么，即`interestedInThis`它将通过空格分隔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T20:18:32.487

```
<([^>]*)interestedInThis([^>]*)> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T20:20:26.663

对于您的示例，这可能有效

```
(<fontsize=\d+) (\w+) (fontstyle=bold>) 
```

不幸的是，Perl 似乎不支持命名反向引用，所以我认为你被困住了`<fontsize=12 in $1, ImInterestedInThis in $2 & fontstyle=bold> in $3.`

问候，利文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:21:21.420

基本上

```
(<fontsize=12) (\S*) (fontstyle=bold>) 
```

但是，属性值会改变吗？而且，您是否必须考虑变量空白？如果是这样，上面的内容会变成：

```
(<fontsize=\d+)\s+(\S*)\s+(fontstyle=.*>) 
```

此外，在上面，通过使用 \S，interestedInThis 可以包含任何不是空白的内容。如果那里也有空格，例如 InterestInThis 实际上类似于`class="x" id="y"`，那么也许：

```
(<fontsize=\d+)(.*)(fontstyle=.*>) 
```

请注意，$2 isinterestedInThis，$1/$3 实际上是你的最终部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T21:20:31.940

试试这个：

```
my $result = m/(.*)(InterestedInThis)(.*)/; 
```

现在：

*   `$result`如果找到与格式匹配的内容，则为真。
*   InterestedInThis 在 中`$2`，尽管您已经知道它是什么。
*   前缀（“InterestedInThis”之前的所有内容）在`$1`.
*   后缀（“InterestedInThis”之后的所有内容）在`$3`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T21:54:30.983

我认为这就是你想要的；

```
<(.* )?InterestedInThis( .*)?> 
```

如果它们存在，它将返回前修复和后修复，但如果只有一个或都不存在，它将仍然匹配。

空格将包含在标记的表达式中确实有一个小问题，但是在匹配后应该很容易删除。

或者，您可以使用lookahead / lookbehind 尝试将空格过滤掉作为匹配的一部分：

```
<(.*(?= ))? ?InterestedInThis ?((?<= ).*)?> 
```************************************