# StackOverflow 问答 12475000-12475999

# python - 处理 SQLAlchemy 断开连接

> ID：12475001
> 
> 赞同：2
> 
> 时间：2012-09-18T10:19:25.290
> 
> 标签：python, mysql, sqlalchemy

我在我的 Flask 应用程序中使用 SQLAlchemy，我刚刚遇到了一些与我的 MySQL 数据库关闭连接的问题。

我在我的`__init__.py`

```
engine = create_engine('mysql://user:pass@localhost/db', pool_recycle=3600)
db = SQLAlchemy(app) 
```

（我使用两种方式来查询我的数据库）

我刚刚添加了 pool_recycle 设置，但我想确保可以重新启动丢失的连接。

阅读以下部分： [http ://docs.sqlalchemy.org/en/latest/core/pooling.html#disconnect-handling-pessimistic](http://docs.sqlalchemy.org/en/latest/core/pooling.html#disconnect-handling-pessimistic)

我不确定如何实际使用此代码，我不想每次在代码中使用它时都检查连接，而是如果连接关闭则重新启动连接。是否可以添加一个通用事件来处理数据库断开连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-06T20:55:10.967

最好在高流量的项目上使用带有 poolclass=NullPoll（非持久连接）的 sqlalchemy，因为并发的连接太多

对于我的经验，我总是使用带有此功能的 slqalchemy

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T11:25:32.330

我认为这里的问题是应用程序本身仅在尝试使用它时才知道连接是否断开。就好像您登录了一个网站，但刷新后您的会话已死，因此要求再次登录。直到您刷新 - 您已登录。薛定谔的猫？

我刚刚遇到了同样的问题。到目前为止，似乎使用 pool_recycle 是可行的方法，如果发生错误，则情人回收时间或编辑 mySQL 的配置。

正如文档所暗示的那样 - 您定期检查以太，或者期望出现错误（如在 Java 中，只需尝试：除了：类方法中的所有内容并使用它们）或者只是不时刷新以希望连接正常。在这种情况下，悲观的方法确实会在您使用数据库之前定期进行检查。这是最安全的方式，但正如你所提到的 - 很脏。

作为 Django 的另一种选择 - 根本没有持久连接。当然它要慢得多，但如果项目较小 - 它应该可以完成这项工作。关于它：[http ://docs.sqlalchemy.org/en/latest/core/pooling.html#sqlalchemy.pool.NullPool](http://docs.sqlalchemy.org/en/latest/core/pooling.html#sqlalchemy.pool.NullPool)

# mysql - Wordpress 错过了直接 mysql 数据库更新的计划 Cronjob

> ID：12475002
> 
> 赞同：1
> 
> 时间：2012-09-18T10:19:25.473
> 
> 标签：mysql, cron

我找不到如何在原始插件[http://wordpress.org/extend/plugins/missed-schedule-wordpress-plugin-fix/](http://wordpress.org/extend/plugins/missed-schedule-wordpress-plugin-fix/)或[http://wordpress.org的 cronjob 中实现这些行的方法/extend/plugins/wp-missed-schedule/](http://wordpress.org/extend/plugins/wp-missed-schedule/)没关系=)

```
function fix_missed_shedule() {
global $table_prefix;   
    $now_time = strftime("%Y-%m-%d %H:%M:%S", _NOW_TIME);
    $sql = "SELECT `ID` FROM `".$table_prefix."posts` WHERE `post_date_gmt` <= '".$now_time."' AND `post_status` LIKE 'future' LIMIT 0 , 35";
    $result = mysql_query($sql);
    while ($row = mysql_fetch_assoc($result)) {
wp_publish_post($row['ID']);
    }
} 
```

**摘要：**
- 35 的限制不是必需
的 - 与数据库的连接就像这里描述的一样`http://www.werockyourweb.com/cron-job-mysql`，每个博客都有他的数据库、用户、IP/HOST、表

自 3 天以来，我一直在寻找这个问题的答案，哈哈

**简而言之，我需要实现什么才能在 CRONJOB 中运行：**如果日期早于当前时间，则将
帖子的状态从“post_date” **“future”中的“wp_posts”表更改为“publish”**

更新！！！！！！！！！！！！我自己找到了答案，它：好的，有人告诉我答案，给你：

```
update database_name.wp_posts set wp_posts.post_status='publish'  where post_date<=now() and post_date_gmt<=now() 
```

# asp.net-mvc - 需要嵌套表单时避免在 ASP.NET MVC 中使用 IFrame

> ID：12475005
> 
> 赞同：0
> 
> 时间：2012-09-18T10:19:31.277
> 
> 标签：asp.net-mvc, asp.net-mvc-3, iframe, razor

我有一个产品编辑表单，在这个表单内我有一个带有另一个表单的区域，假设允许您输入客户列表以发送该产品的新闻通讯。

客户与产品完全无关，也与产品没有数据库关系。它们是合规地与产品分开的实体。

在这种情况下，我创建了一个带有客户添加表单和提交按钮的 IFrame，该按钮在 IFrame 中提交表单。

我没有找到比使用 IFrame 更好的方法来实现所描述的场景。是的，我要求将两个表单放在同一页面上，并且通讯表单应该放在产品编辑表单中。老板决定的业务需求。

我使用 ASP.NET MVC 3 / 4，我不能使用 jQuery Ajax 表单，因为需要原生 ASP.NET MVC 绑定和验证。

我还尝试对产品编辑输入和客户输入使用一个表单，有 2 个按钮提交相同的操作，并检查按下了哪个按钮 - 我遇到了模型验证问题。因为每页有一个 ViewModel，而且我不能只验证模型的一部分（客户记录）而不验证整个 ProductEdit 模型（而且我不需要在提交客户记录时验证产品编辑模型）

有没有更好的方法来避免在这种情况下使用 IFrame？

# xml - (XML) 文档中根元素之后的标记必须格式正确。开始位置：6:2

> ID：12475012
> 
> 赞同：26
> 
> 时间：2012-09-18T10:19:45.803
> 
> 标签：xml

刚从我的 XML 课程开始，在找到解决我的错误的方法时遇到了一些麻烦。我收到此错误：“根元素之后的文档中的标记必须格式正确。起始位置：6:2”。

任何形式的提示或帮助都会很棒。

```
 <?xml version="1.0" encoding="UTF-8"?>
 <heading>
 The Twelve Days of Christmas
 </heading>

<song> //OxyGen highlights "<song>" as the error, but i'm not sure I understand.
    <Day ="One"> 
        <verse>
    On the first day of Christmas, my true love sent to me, a partridge in a pear tree.
        </verse>
    </Day>

    <Day="Two">
        <verse>
     On the second day of Christmas, my true love sent to me 
     Two turtle doves 
     and a partridge in a pear tree. 
        </verse>
    </Day>

     <Day="Three"> 
         <verse>
     On the third day of Christmas, my true love sent to me 
     Three French hens, 
     two turtle doves 
     And a partridge in a pear tree.
         </verse>
     </Day>

     <Day="Four">
         <verse>
     On the fourth day of Christmas, my true love sent to me 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Fifth">
         <verse>
     On the fifth day of Christmas, my true love sent to me 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree.
         </verse>
     </Day>

     <Day="Sixth">
         <verse>
     On the sixth day of Christmas, my true love gave to me 
     Six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Seventh">
         <verse>
     On the seventh day of Christmas, my true love gave to me 
     Seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Eighth">
         <verse>
     On the eighth day of Christmas, my true love gave to me 
     Eight maids a-milking, 
     seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Ninth">
         <verse>
     On the ninth day of Christmas, my true love gave to me 
     Nine ladies dancing, 
     eight maids a-milking, 
     seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Tenth">
         <verse>
     On the tenth day of Christmas, my true love gave to me 
     Ten lords a-leaping, 
     nine ladies dancing, 
     eight maids a-milking, 
     seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Eleventh">
         <verse>
     On the eleventh day of Christmas, my true love gave to me 
     Eleven pipers piping, 
     ten lords a-leaping, 
     nine ladies dancing, 
     eight maids a-milking, 
     seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

     <Day="Twelfth">
         <verse>
     On the twelfth day of Christmas, my true love gave to me 
     Twelve drummers drumming, 
     eleven pipers piping, 
     ten lords a-leaping, 
     nine ladies dancing, 
     eight maids a-milking, 
     seven swans a-swimming, 
     six geese a-laying, 
     Five golden rings. 
     Four calling birds, 
     three French hens, 
     two turtle doves 
     And a partridge in a pear tree. 
         </verse>
     </Day>

 </song> 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-09-18T10:23:45.923

在 XML 中只能**有一个**根元素——你有两个——`heading`和`song`.

如果您重组为：

```
<?xml version="1.0" encoding="UTF-8"?>
<song> 
 <heading>
 The Twelve Days of Christmas
 </heading>
 ....
</song> 
```

关于根级别格式正确的 XML 的错误应该会消失（尽管可能存在其他问题）。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2014-03-03T06:32:37.600

确保字符串“strOutput”具有正确的 XML 结构后，您可以执行以下操作：

```
Matcher junkMatcher = (Pattern.compile("^([\\W]+)<")).matcher(strOutput);
strOutput = junkMatcher.replaceFirst("<"); 
```

# iphone - 必须在 iPhone 应用程序中使用视网膜图像吗？

> ID：12475013
> 
> 赞同：1
> 
> 时间：2012-09-18T10:19:47.453
> 
> 标签：iphone, retina-display, ui-design

我开发了一个非视网膜图像的应用程序。在 iTunes connect 中提交图标和屏幕截图时，我们必须提供视网膜 (2x) 图像。是否必须为应用程序中的所有图像包含 2x 图像，或者它可以是可选的。请指导我。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:22:41.727

虽然并非所有图像都必须提供，但您应该提供视网膜图像。因为您需要从 Retina 设备上传所有屏幕截图。现在出售的 iPhone 都是视网膜设备（iPhone 4/4S 和 iPhone 5），为旧设备和 iPad 2/Mini 提供非视网膜图像通常是个好主意。如果您的应用程序不包含视网膜版本的应用程序 UI 图像，Apple 可能会拒绝您的应用程序，他们会说您确实完全支持最新的设备。我在不支持视网膜的 iPad 应用程序中遇到过这种情况，并且一些带有文本的图像变得非常模糊。

如果你不使用任何视网膜图像，屏幕截图看起来不会很清晰，甚至可能看起来很模糊。应用程序图标应支持大多数尺寸，即使是 iPhone 应用程序，也应支持 iPad 和 iPad Retina。

但是，例如，您从 Internet 或其他外部来源下载的图像不必是 Retina。但如果可能的话，他们应该再次这样做，因为这将增加用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:34:14.610

Apple 并不要求您的应用程序中的所有图像都是 Retina，只是屏幕截图必须是 2 倍。所以，不用担心：如果您尝试提交应用程序，您只需要将屏幕截图设为 2 倍，该应用程序不会因为没有视网膜图像而被拒绝。

# java - 应用程序运行时消息包存储在哪里（内存或磁盘）？

> ID：12475014
> 
> 赞同：1
> 
> 时间：2012-09-18T10:19:58.130
> 
> 标签：java, struts2, struts

我正在使用 JAVA Struts2。我正在使用 ActionSupport 的 getText() （由 struts2 提供）读取属性文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:37:04.550

它们作为实例存储在 XWork 核心库 `java.util.ResourceBundle`中的静态`ConcurrentMap`中。`LocalizedTextUtil`

默认情况下，ResourceBundles 缓存在内存中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T19:16:31.720

默认情况下，它存储在内存中。但是，如果您想让框架为每次查找检查您的属性文件，您可以这样做。这对发展来说是一件好事。

您可以在`struts.properties`文件中配置此类内容。以下来自`struts-default.properties`，作为此类配置的注释样板。

```
### when set to true, Struts will act much more friendly for developers. This
### includes:
### - struts.i18n.reload = true
### - struts.configuration.xml.reload = true
### - raising various debug or ignorable problems to errors
###   For example: normally a request to foo.action?someUnknownField=true should
###                be ignored (given that any value can come from the web and it
###                should not be trusted). However, during development, it may be
###                useful to know when these errors are happening and be told of
###                them right away.
struts.devMode = false

### when set to true, resource bundles will be reloaded on _every_ request.
### this is good during development, but should never be used in production
struts.i18n.reload=false 
```

`true`在您的文件中设置这两个属性中的任何一个`WEB-INF/classes/struts.properties`都会使框架从物理属性文件中加载以进行每次查找。

# html - 如何将博客标题移动到 Squarespace 上的图片下方？

> ID：12475024
> 
> 赞同：0
> 
> 时间：2012-09-18T10:20:47.343
> 
> 标签：html, css, squarespace

我正在尝试将标题移动到图像下方。

这是我的[网站](http://www.thisisartdirection.com)

这是我想要实现的一个[例子。](http://www.thisiscollate.com)

我知道我可以用 h1 标签包装帖子的第一行，但我想知道是否有更优雅的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:02:54.270

是的，您可以交换标题和正文条目内容 div 类。您可以通过交换两者的 css 属性而不是更改总内容来以另一种方式做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:54:44.430

你可以移动`header Section`下面的，`body entry-content`但如果你只是想用 CSS 来做（这不是一个好主意），但它可以这样做：

**只改变这些风格**

```
.collection-type-blog article header
{
     width: 100%;
     text-align: center;
     position: absolute;
     bottom: 37px;
}

.collection-type-blog article .post 
{
     top: -63px;
     position: relative;
}

.collection-type-blog article .article-meta 
{
     top: 63px;
     position: relative;

 } 
```

# hibernate - 在休眠条件中创建内部查询

> ID：12475025
> 
> 赞同：1
> 
> 时间：2012-09-18T10:20:57.573
> 
> 标签：hibernate

我必须在休眠的条件查询中创建这种类型的查询

```
SELECT *
        FROM
        ${hibernate.default_schema}.VW_GEMS_CUST_TRNG_RPT CUSTOMER,
        (SELECT * FROM ${hibernate.default_schema}.VW_GEMS_VENUE WHERE ORG_NAME =?)
        VENUE
        WHERE
        CUSTOMER.PRIMARY_VENUE_ROW_ID = VENUE.VENUE_ROW_ID(+)
        AND CUSTOMER.ORG_NAME =?
        AND CUSTOMER.CONTACT_ID =?
        ORDER BY CUSTOMER.EVNT_START_DT DESC 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T17:01:49.367

ROM 子句中的子选择不能与条件 API 一起使用。
但是您可以在没有子选择的情况下重写查询。

```
SELECT *
FROM
    ${hibernate.default_schema}.VW_GEMS_CUST_TRNG_RPT CUSTOMER
inner join ${hibernate.default_schema}.VW_GEMS_VENUE VENUE
        on (CUSTOMER.PRIMARY_VENUE_ROW_ID = VENUE.VENUE_ROW_ID(+) 
       and venue.ORG_NAME =?)
WHERE
      CUSTOMER.ORG_NAME =?
      AND CUSTOMER.CONTACT_ID =?
ORDER BY CUSTOMER.EVNT_START_DT DESC 
```

# sencha-touch-2 - 图例未显示在煎茶中

> ID：12475026
> 
> 赞同：0
> 
> 时间：2012-09-18T10:20:58.940
> 
> 标签：sencha-touch-2, sencha-charts

我在图表配置中启用了图例

```
config: {
       legends: {
                  position: 'right'
                }
} 
```

此外，我已将 showInLegend 配置启用为 true，但未显示图例...我错过了什么？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T04:35:29.410

传奇从 Sencha 2.1 GA 开始可用

# linux - _SC_CLK_TCK 没有定义

> ID：12475028
> 
> 赞同：3
> 
> 时间：2012-09-18T10:21:10.547
> 
> 标签：linux

我正在使用嵌入式 Linux 2.6.36

我需要那个序列：

```
ticksPerSecond=sysconf(_SC_CLK_TCK); // ticks per sec 
```

但我得到了这个错误

```
semLib.c:96: error: '_SC_CLK_TCK' undeclared (first use in this function)
semLib.c:96: error: (Each undeclared identifier is reported only once
semLib.c:96: error: for each function it appears in.) 
```

我没有找到定义

> _SC_CLK_TCK

我发现它应该在 linux/time.h 中。但事实并非如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T10:39:50.717

试试`#include <unistd.h>`。它包括带有此定义和其他定义的标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-10T13:43:24.890

在我的 debian 6 上，同样的问题

```
xxx.c:47: error: '_SC_CLK_TCK' undeclared (first use in this function) 
```

我找到了这个 ：

```
/usr/include/bits/time.h:41:#   define CLK_TCK ((__clock_t) __sysconf (2))      /* 2 is _SC_CLK_TCK */ 
```

这表示您可以改用 (2) :) 对我来说，它每秒返回 100 个滴答声（仅！）

# javascript - 如何使用 javascript 从 tinyMCE 获取我的格式化内容？

> ID：12475029
> 
> 赞同：0
> 
> 时间：2012-09-18T10:21:18.387
> 
> 标签：javascript, jquery, tinymce

我已经安装了 TinyMCE，当我的表单以传统方式发布（到某些 php 页面）时，这不是问题，因为我可以通过变量 stripslashes() 函数或类似的东西传递。

不幸的是，我的一种形式是通过 jquery $.ajax 模块传递的——并且不可能进行任何 PHP 操作。有没有办法通过javascript传递完整格式的tinyMCE输出，因为现在它看不到我所做的任何格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:24:42.010

根据这个答案：[https](https://stackoverflow.com/a/6541822/349012) ://stackoverflow.com/a/6541822/349012有可能：

```
// Get the HTML contents of the currently active editor
tinyMCE.activeEditor.getContent();

// Get the raw contents of the currently active editor
tinyMCE.activeEditor.getContent({format : 'raw'});

// Get content of a specific editor:
tinyMCE.get('content id').getContent() 
```

另一个参考：[https ://stackoverflow.com/a/11112221/349012](https://stackoverflow.com/a/11112221/349012)

# ruby-on-rails - Ruby on Rails - 嵌套表单

> ID：12475032
> 
> 赞同：1
> 
> 时间：2012-09-18T10:21:34.903
> 
> 标签：ruby-on-rails

我的应用程序有投注比赛的用户。单次投注称为“tipp”。

我有以下（工作）表格，用户可以在其中编辑他们的赌注：

```
<%= form_for @user, :url => { :action => "update_tipps" }  do |user_form| %>

    <%= user_form.fields_for :tipps do |tipp_form, index| %>
        <%= tipp_form.text_field :tipp1 %><br/>
        <%= tipp_form.text_field :tipp2 %><br/>         
    <% end %>

    <%= submit_or_cancel(user_form) %> 
<% end %> 
```

使用此表格，用户可以一次编辑他的所有投注/提示。

我的问题：

如何指定用户可以编辑的提示？我不希望用户得到他所有投注的列表，而只是他投注的一个子集。

例如像这样：

```
<%= user_form.fields_for :tipps.where("match_id = ?", 5) do |tipp_form, index| %>
    <%= tipp_form.text_field :tipp1 %><br/>
    <%= tipp_form.text_field :tipp2 %><br/>         
<% end %> 
```

这会将赌注减少到对 ID 为 5 的比赛的赌注。但是，此代码不起作用。

解决这个问题的正确方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:28:41.257

我现在还没有测试它，但你应该能够将对象传递给`fields_for`, bo 这样的东西应该可以工作：

```
<% user_form.object.tipps.where("match_id = ?", 5).each do |tipp| %>
  <%= user_form.fields_for :tipps, tipp do |tipp_form, index| %>
    <%= tipp_form.text_field :tipp1 %><br/>
    <%= tipp_form.text_field :tipp2 %><br/>         
  <% end %>
<% end %> 
```

当然你应该重构它，因为在视图中像这样的过滤（低级搜索方法）是难闻的，但最后你有一些东西可以开始玩了。

它在[http://api.rubyonrails.org](http://api.rubyonrails.org)中有描述，在嵌套属性示例中搜索`fields_for`方法`ActionView::Helpers::FormHelper`和描述一对多关系。

# sql - BigQuery JOIN 在两个表上

> ID：12475033
> 
> 赞同：10
> 
> 时间：2012-09-18T10:21:38.740
> 
> 标签：sql, google-bigquery

我正在尝试运行以下查询，但继续遇到相同的错误

> 查询失败错误：在第 6 行第 33 列遇到“”。期待以下之一：

查询是：

> 从 [Dataset1.1_0_MEMBER_GROUP] 中选择 1_0_MEMBER_GROUP.User_Group、
> 1_0_MEMBER_GROUP.Member_ID、
> 1_4_MEMBER_TRAN_YEAR.MEMBER_UID 在 1_0_MEMBER_GROUP.Member_ID = 1_4_MEMBER_TRAN_YEAR.MEMBER_UID 上加入 [Dataset1.1_4_MEMBER_TRAN_YEAR]

我无法弄清楚为什么它不会运行，并且必须过度寻找一些非常简单的东西。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-18T14:55:36.153

您应该使用表别名。尝试

```
SELECT member_group.User_Group, 
member_group.Member_ID, 
member_tran_year.MEMBER_UID 
FROM [Dataset1.1_0_MEMBER_GROUP] as member_group
JOIN [Dataset1.1_4_MEMBER_TRAN_YEAR] as member_tran_year
ON member_group.Member_ID = member_tran_year.MEMBER_UID 
```

# ios - 如何停止和恢复 iPhone 应用程序的背景音频？

> ID：12475034
> 
> 赞同：2
> 
> 时间：2012-09-18T10:21:40.350
> 
> 标签：ios, objective-c, audio, avaudioplayer, resume

我在基于消息的 iPhone 应用程序中工作。我添加了哔声以接收来自其他人的消息。我正在使用`AVAudioPlayer`. 我的问题是当用户在后台听到来自其他应用程序的歌曲时，如果他们从我的应用程序收到消息，则会播放哔声并且背景歌曲/音频停止不恢复。

我想通过暂停背景歌曲/音频来播放我的哔声，我必须再次从我的应用程序中恢复该音频/歌曲。在iOS开发中可能吗？谁能帮帮我吗？

**编辑：**

这是我的示例代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.title = @"Music";
    self.navigationController.navigationBar.barStyle = UIBarStyleBlack;

    NSString *urlString = [[NSBundle mainBundle] pathForResource:@"basicsound" ofType:@"wav"];
    NSURL *audioURL = [[NSURL alloc] initWithString:urlString];
    NSError *error;
    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:audioURL error:&error];
    [audioPlayer setDelegate:self];
    [audioPlayer prepareToPlay];

    audioSession = [AVAudioSession sharedInstance];
    [audioSession setActive:YES error:&error];
    [audioSession setCategory:AVAudioSessionCategoryPlayback error:&error];
    [audioPlayer play];    
}

-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    if (flag == YES) 
    {
        NSLog(@"Audio Played successfully");
        NSError *error;
        [audioSession setActive:NO error:&error];
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T21:35:54.200

派对有点晚了，但对于那些在播放声音后寻找暂停和取消暂停背景（即 ipod 音乐）问题的解决方案的人，您应该在停用音频会话时使用以下内容。

```
[[AVAudioSession sharedInstance] setActive:NO withFlags:AVAudioSessionSetActiveOptionNotifyOthersOnDeactivation error:&error]; 
```

//未弃用的新方法：

```
[[AVAudioSession sharedInstance] setActive:NO withOptions:AVAudioSessionSetActiveOptionNotifyOthersOnDeactivation error:&error]; 
```

每当您不需要应用程序中的音频会话时（即当您不输出任何声音时），您应该停用它。在有意义的情况下，您应该使用此方法，以便通知任何背景音频并可以恢复（收到此通知的应用程序不一定必须恢复）。

此外，您必须使用适当的音频类别才能让您的声音在需要时专门播放。这可以使用除 之外的任何类别来完成`AVAudioSessionCategoryAmbient`。当您的音频会话激活时，这将自动为您暂停背景音频。但是，它不会重新激活任何背景音频，这是通过使用上述代码完成的。在这种情况下，如前所述，背景音频会决定如何处理通知。

旁注，另一个要研究的选项是音频“闪避”。如果您的声音不是必须单独播放，例如简单的警报声音，请尝试使用闪避，这将降低背景音频的音量来播放您的声音，完成后将在您的声音结束时将背景音频恢复正常玩。有关这些概念的更多详细信息，请参阅[配置您的音频会话](http://developer.apple.com/library/ios/#documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Configuration/Configuration.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-25T11:01:23.900

您不能对所有应用程序都这样做。对于在其应用程序中使用 iPod 播放器的应用程序：

假设您的应用程序在前台。你可以这样做：

```
MPMusicPlayerController *mp = [MPMusicPlayerController iPodMusicPlayer];        
[mp stop]; // or [mp pause] 
```

这需要`MediaPlayer.framework`and also `#import <MediaPlayer/MediaPlayer.h>`。

[在MPMusicPlayerController 参考](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMusicPlayerController_ClassReference/Reference/Reference.html)中阅读更多内容。

* * *

要通过音频播放器会话执行此操作，您可以使用该属性`kAudioSessionCategory_SoloAmbientSound`。[参考这里](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/doc/uid/TP40007915)。

这类似于在[AVAudioSession 类](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html#//apple_ref/c/data/AVAudioSessionCategorySoloAmbient)`AVAudioSessionCategorySoloAmbient`中定义的。

从文档中引用：

> 当您使用此类别时，来自其他应用程序的音频会被静音。

# java - 如何使字段成为 BLOB 而不是 TINYBLOB？

> ID：12475035
> 
> 赞同：3
> 
> 时间：2012-09-18T10:21:44.607
> 
> 标签：java, image, hibernate, orm, blob

如何使字段成为 BLOB 而不是 TINYBLOB？

我的映射如下：

```
private byte[] ImageBytes;

public BufferedImage getImage() {
    InputStream in = new ByteArrayInputStream(ImageBytes);
    try {
        return ImageIO.read(in);
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
}

public void setImage(BufferedImage image) {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    try {
        ImageIO.write(image, "PNG" /* for instance */, out);
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
    ImageBytes = out.toByteArray();
} 
```

它会导致 Hibernate 在 MySQL 中创建不适合图像的 TINYBLOB 字段。

如何让它使用 BLOB？

下面的回答

```
@Lob(type = LobType.BLOB) 
```

不起作用，因为`@Lob`注释在我的库中没有参数。

此外，我不想使用特定于 ORM 或特定于 DBMS 的注释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:21:05.097

你可以这样试试；

```
@Lob
@Column(name="IMAGE", nullable=false, columnDefinition="blob")
private byte[] imageBytes; 
```

并确保您的图像数据类型是`BLOB`.

# c# - 为什么我的 DropDownList 显示的是数据项类型 (System.Web.Mvc.SelectListItem) 而不是数据的值？

> ID：12475036
> 
> 赞同：1
> 
> 时间：2012-09-18T10:21:45.353
> 
> 标签：c#, .net, asp.net-mvc-3, razor

我有一个下拉列表，其中填充了一个`SelectList`填充`SelectListItem`对象，但它呈现的是类名而不是正确的值。谁能看到我哪里出错了？

![不稳定的名单](../Images/6184e5e60d301d996b08e6071b6385f7.png)

这是我呈现列表的代码：

```
@Html.DropDownListFor(m => m.SelectedValue, @Model.RangeValues.SelectList) 
```

该模型是类型`DataParameterValuesModel`...

```
public class DataParameterValuesModel
{
    public string Description { get; set;}
    public DataRangesModel RangeValues { get; set; }
}

public class DataRangesModel
{
    public int? SelectedIdx { get; set; }
    public SelectList SelectList { get; set; }
} 
```

并且`SelectList`填充了`SelectListItem`这样的对象：

```
List<SelectListItem> items = new List<SelectListItem>();

[...]

items.Add(new SelectListItem()
{
    Text = "whatever",
    Value = "whatever2"
});

[...]

parms.RangeValues = new DataRangesModel()
{
    SelectList = new SelectList(items),
    SelectedIdx = null
} 
```

![不稳定的调试](../Images/65286b4a12bbe16860a597f674d9096c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:25:50.990

尝试使用第三个构造函数`SelectList`并指定数据值字段和数据文本字段。

```
parms.RangeValues = new DataRangesModel()
{
    SelectList = new SelectList(items,"Value","Text"),
    SelectedIdx = null
} 
```

[这里](http://msdn.microsoft.com/en-us/library/system.web.mvc.selectlist%28v=vs.108%29.aspx)是 MSDN 参考

# php - 提高在 varchar 字段中的搜索性能

> ID：12475037
> 
> 赞同：0
> 
> 时间：2012-09-18T10:21:53.450
> 
> 标签：php, mysql, performance

对于来自搜索引擎的每次新访问，我都会保存访问者在搜索引擎中搜索的关键字（例如“php 性能”）。

要计算关键字每天使用的频率，我需要检查其他人在特定日期是否已经搜索过该术语。

几个月后，表变得非常大，mysql 检查当天关键字是否存在的时间越来越长。所以我切换到一个额外的表，我只保存关键字并为每个关键字指定一个特定的 ID，以便只进行一次检查过程，而不是每个新的一天。这个特定的 ID 与我在表格中插入的关键字相关，并且每天都多样化。

这已经更好了，但这张桌子也变得越来越大......

有人对此有更好的解决方案来提高性能吗？

最好的，

弗雷迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:27:20.343

在性能方面，可以采取一些*“技巧”*来提高：

1.  建立缓存机制。这就是您已经通过制作第二张桌子所做的事情。您可以更进一步，将缓存表保存在内存或 memcached 中。
2.  优化您的查询，并确保搜索字段上有**索引**。如果你这样做了，不舒尔。
3.  尝试**（去）规范化**你的数据库。有时，从设计角度来看，不同的数据库结构并不是最佳的，而是针对速度进行了优化。不确定你是否这样做。
4.  看看不同的搜索解决方案，也许看看[Lucene](http://www.lucenetutorial.com/techniques/lucene-php.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:27:11.320

不要将用户输入的所有关键字都保存到数据库中。制作一个包含列的表格：关键字，计数器

每次访问者输入关键字时，您在数据库中搜索关键字并增加计数器，如果关键字不存在则创建一个计数器=1的新关键字。

还要在关键字列上使用索引，不要使用全文搜索，使用直接比较：

```
SELECT counter FROM keyword_table WHERE keyword="exact keyword" LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T16:50:51.150

我个人不会使用 MySQL 作为这些数据的主要后备存储，我会寻找更快、更高可用性的 NoSQL 解决方案，也许使用 MySQL 作为备份存储......

使用 APC 有内置的互斥锁，我认为您的号码不会损坏，如果您启动并运行 apc 并且对它的计数不满意，您需要直接访问互斥锁，以便没有服务进程可以写入同时，在我的 pthreads 项目中提供了互斥锁，可以在[https://github.com/krakjoe/pthreads](https://github.com/krakjoe/pthreads)找到，需要更多帮助随时问...

# java - Eclipse为链接资源添加标记

> ID：12475038
> 
> 赞同：3
> 
> 时间：2012-09-18T10:21:56.523
> 
> 标签：java, eclipse, resources, eclipse-rcp, marker

我知道只能为 IResource 添加标记，可以为链接资源添加标记吗？
我从 .project 获得了链接的资源名称，使用`org.eclipse.core.internal.Project.internalGetDescription()`and `getLinks()`。但似乎缺少了一些东西，Eclipse 正在抱怨资源不存在的事实。
我正在使用创建资源`Workspace.newResource([PATH])`，其中 PATH 是`IPath`使用 .project 中的链接资源名称和文件名的其余路径正确构建的。

也许有人以前用过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T17:15:11.000

不要直接调用，使用路径和或`Workspace.newResource([PATH])`从 IProject 或 IWorkspaceRoot 获取资源。如果你做得对，它是一个链接资源应该没关系。如果您仍然遇到问题，请准确告诉我们它的投诉内容。`#getFile()``#getFolder()`

# jquery - 如何为不同的弹出窗口重用相同的 jQuery ui 对话框代码

> ID：12475043
> 
> 赞同：0
> 
> 时间：2012-09-18T10:22:12.977
> 
> 标签：jquery, jquery-ui

我想使用下面的 jQuery 对话框来打开不同的弹出框

```
<head runat="server">
    <title></title>
    <link href="css/ui-lightness/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui-1.7.2.custom.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#pop101").dialog({
                autoOpen: false,
                draggable: true,
                title: "Add New Person",
                open: function (type, data) {
                     $(this).parent().appendTo("form");
                }
            });
        });
        function showDialog(id) {
            $('#' + id).dialog("open");
        }
        function closeDialog(id) {
            $('#' + id).dialog("close");
        }
    </script>
</head>
<body>
    <input type="button" onclick="showDialog('pop101');" value="Popup1" />
    <input type="button" onclick="showDialog('pop102');" value="Popup2" />
    <input type="button" onclick="showDialog('pop103');" value="Popup3" />
    <input type="button" onclick="showpopup('pop104');" value="Popup4" />
    <div style="background: green" id='pop101'>
    </div>
    <div style="background: orange" id='pop102'>
    </div>
    <div style="background: blue" id='pop103'>
    </div>
    <div style="background: skyblue" id='dialog1'>
    </div>
</body> 
```

有 4 个按钮 popup1,2,3,4 ，当我点击它们时，弹出窗口应该使用上面的代码显示，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:30:11.670

尝试使用一个类来初始化弹出窗口：

尚未尝试但应该可以：

```
<head runat="server">
    <title></title>
    <link href="css/ui-lightness/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui-1.7.2.custom.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".popup").dialog({
                autoOpen: false,
                draggable: true,
                title: "Add New Person",
                open: function (type, data) {
                    $(this).parent().appendTo("form");
                }
            });
        });
        function showDialog(id) {
            $('#' + id).dialog("open");
        }
        function closeDialog(id) {
            $('#' + id).dialog("close");
        }
    </script>
</head>
<body>
    <input type="button" onclick="showDialog('pop101');" value="Popup1" />
    <input type="button" onclick="showDialog('pop102');" value="Popup2" />
    <input type="button" onclick="showDialog('pop103');" value="Popup3" />
    <input type="button" onclick="showpopup('pop104');" value="Popup4" />
    <div style="background: green" id='pop101' class="popup">
    </div>
    <div style="background: orange" id='pop102' class="popup">
    </div>
    <div style="background: blue" id='pop103' class="popup">
    </div>
    <div style="background: skyblue" id='dialog1' class="popup">
    </div>
</body> 
```

[这是小提琴；有效！！](http://jsfiddle.net/KDQab/1/)

# java - 为什么允许`T extends String`但给出警告？

> ID：12475050
> 
> 赞同：6
> 
> 时间：2012-09-18T10:22:38.810
> 
> 标签：java, generics

> **可能重复：**
> [@SuppressWarnings for “extends String”](https://stackoverflow.com/questions/3957121/suppresswarnings-for-extends-string)

为什么`T extends String`允许但给出警告？

> 类型参数 T 不应受最终类型 String 的限制。最终类型无法进一步扩展

```
public class Car<T extends String> 
```

**`T can be String`我知道什么是最终的我知道它是有效的，因为我想知道警告的唯一可能值。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T10:28:40.757

如果实际问题是“为什么允许”，那么想象一下将`final`关键字添加到现有类的情况。我认为您不希望此更改破坏使用此类作为通用绑定的其他现有代码，因为它仍然是完全合法的。这就是编译器在这种情况下不会发出错误的原因。

另一方面，如果您不小心将`final`类用作泛型绑定，您希望得到通知，因为这样的构造没有意义。这就是编译器发出警告的原因。

实际上，用警告标记合法但无意义的结构是一种常见的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T10:26:16.830

因为`String`在java 中是最终的，即你不能扩展那个类。所以你有警告，因为不存在扩展 String 的类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T10:28:30.960

基本上，它是说只有一种可能的类型`T`，那就是`String`它本身。所以基本上你的泛型`Car`类只是名称上的泛型。您也可以`T`将类中的所有实例替换为`String`.

也许你的意思是`public class Car<T extends CharSequence>`...

* * *

该构造是允许的，因为该类是有意义的，甚至可能有用。给出警告是因为（在编译器作者看来）您可能犯了一个错误。原因与某些编译器会为您提供以下警告的原因相同：

```
String NULL = null;
System.err.println(NULL.toString()); 
```

这是有意义的，但这是一个错误……除非您**打算**抛出异常。

* * *

我可以想到两种`public class Car<T extends SomeFinalClass>`不会出错的情况：

*   `SomeFinalClass`原本没有的情况`final`。
*   自动生成代码的情况`Car`，为类生成特殊情况代码会很尴尬`final`。

# codeigniter - 如何有选择地更改安全类中的 CSRF 名称

> ID：12475053
> 
> 赞同：0
> 
> 时间：2012-09-18T10:22:44.523
> 
> 标签：codeigniter, csrf

我有来自外部 cURL POST 的发布数据。我无法将任何自定义字段添加到回发中，但我可以将 CSFR 令牌填充到另一个空输入中，以便回发到我的应用程序。这样做是否可行，然后在未找到预期的 csfr_token 时修改安全类以在 _POST 数据中查找唯一输入名称？

如果此解决方案有意义，那么任何有关如何实施的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:23:54.177

这可以使用配置文件来完成：`application/config/config.php`. 只需进行搜索`csrf`，您就会找到它。

如果您需要“一次性使用”令牌名称，您可以使用`$this->config->set_item('item','value')`方法将 设置`csrf_token_name`为该特定请求所需的内容。

不建议修改核心类，因为如果您需要，这将阻止以后轻松的 CI 升级。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-18T10:27:11.390

**您可以在/system/core/Security.php**中设置 CFRF 令牌的名称。
它是第 32 行的受保护属性。

```
protected $_csrf_token_name = 'ci_csrf_token'; 
```

为了让纯粹主义者高兴，您可以（或应该）编写自己的扩展安全类，而不是编辑核心文件

# ruby-on-rails - 使用 Ruby on Rails 连接网络服务器的问题

> ID：12475055
> 
> 赞同：1
> 
> 时间：2012-09-18T10:22:46.690
> 
> 标签：ruby-on-rails, ruby, windows

我已经安装了 Ruby on Rails 并且没有编程经验。我想连接到网络服务器，因为我想运行一个演示应用程序。

我做了：

```
$ rails server 
```

但是在那之后我的命令提示符停止工作，这意味着我不能继续（例如我不能输入命令）。

谁能给我建议下一步该怎么做？

![显示 <code>rails s</code> 输出的控制台屏幕截图](../Images/27ea258434465cad1eb151248edbee52.png)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:25:50.610

我是正常的。您有两个选择，或者使用标志从控制台分离服务器，`-d`或者启动另一个控制台并在那里工作。我更喜欢第二种方式，因为在终端上输出日志时更容易重新启动服务器和检查日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:03:03.847

启动您的浏览器`http://localhost:3000/`并按照您的屏幕截图进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:12:25.730

另一种选择是 goto

```
 http://127.0.0.1:3000/ 
```

试试这个...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T10:10:19.770

是的。当您启动 rails 服务器时，它会接管您用来打印日志的终端。在您执行以下任一操作之前，您将无法输入新命令：

1.  杀死服务器
2.  在后台运行服务器（按 CTRL+Z 并键入“bg”）

您还可以使用以下命令以后台模式启动服务器：`rails script/server &`

但是 - 我建议为命令打开第二个终端屏幕，因为查看日志对于调试目的非常有用。

# c++ - CMake如何选择gcc和g++进行编译？

> ID：12475056
> 
> 赞同：39
> 
> 时间：2012-09-18T10:22:51.147
> 
> 标签：c++, cmake

我是 CMake 的新手，我想知道 LINUX 环境中的 C++/C 项目如何 CMake 可以在 gcc 和 g++ 之间选择编译器。更具体地说，我的问题如下：

1.  如果一个项目由 .c 和 .cpp 文件组成，那么 .c 文件将由 gcc 编译而 .cpp 文件将由 g++ 编译是真的吗？
2.  如果一个项目只有c文件或cpp文件，CMake默认的编译操作是什么？有可能改变它吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-18T11:15:22.657

很快，两者都是。

你几乎可以处理所有事情。有标志和变量将扩展绑定到语言；然后是定义工具集和构建目标的编译器选项/可执行文件的语言。

检查以下文档链接。这些是一些令人愉快的简短读物。

1.  [更改编译器/工具集](https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/Useful-Variables#system-compiler-information)
2.  [每种语言的扩展](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#variable:CMAKE_LANG_SOURCE_FILE_EXTENSIONS)
3.  [语言变量](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#prop_sf%3aLANGUAGE)

注意：该 wiki 可能已经过时，但它应该在重要和教育问题的情况下保留。

PS。有很多相关的选项。如需更长的阅读时间，您可以查看以下文档部分：[源文件属性](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#section_PropertiesonSourceFiles)和[语言变量](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#section_VariablesforLanguages)。2\. 和 3\. 来自这些部分。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-18T10:27:38.253

据我所知，CMake 只查看文件扩展名。因此，如果您将 .c 文件重命名为 .cpp，据我所知，它将使用 g++ 进行编译。

改变这种行为很容易。CMake 使用环境变量来查看要使用的编译器。如果您想将编译器更改为例如 clang 和 clang++，您可以这样做

出口 CC=clang 出口 CXX=clang++

在运行 cmake 之前。

# jquery - jQuery 不会读取隐藏内的输入值

> ID：12475057
> 
> 赞同：1
> 
> 时间：2012-09-18T10:22:58.330
> 
> 标签：jquery, hidden

我有一个输入 -

`<input id="post_name" type="text" value="123" name="post_name">`

此输入包含在`<div>`页面加载时隐藏的 a 中，jQuery 不会检索输入的值 -

`var current_name = $('input[name="post_name"]').val();`

我可以阅读该对象的其余部分，并获得诸如 and 之类的属性，`name`但我无法理解它`id`的价值。这是一个 jQuery 错误，还是我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:34:11.023

你为什么不使用'id'来获取值而不是名称......我认为应该工作试试这个......

```
//execute this function whn document is ready
$(document).ready(function() {
//get the val from id
var current_name =$('#post_name').val();
alert(current_name); //alert and see if u getting the value.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:40:50.233

这里的答案非常简单——我不小心复制了我之前在代码中用于输入的 ID 和名称，所以它是被 jQuery 拾取的。

我学到的教训——不要做甜甜圈！并检查您的代码以确保选择器 ID 和输入名称不重复。

# ruby - 如何离开加入 Arel？

> ID：12475058
> 
> 赞同：7
> 
> 时间：2012-09-18T10:22:58.447
> 
> 标签：ruby, join, arel

Arel 3.0.2 提供了两个类来指定连接类型：`Arel::Nodes::InnerJoin`和`Arel::Nodes::OuterJoin`并`InnerJoin`用作默认值。

```
foo = Arel::Table.new('foo')
bar = Arel::Table.new('bar')

foo.join(bar, Arel::Nodes::InnerJoin) # inner
foo.join(bar, Arel::Nodes::OuterJoin) # outer

foo.join(bar, ???) # left 
```

如果要产生左连接，如何连接两个表？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-20T13:53:58.307

您可以使用

```
foo.join(bar, Arel::Nodes::OuterJoin) # outer 
```

因为左连接 = 左外连接。外部是一种选择。看[这里](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=53046)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-23T06:16:21.537

这是任何想看的人的完整示例，其中包含 Rails 模型。

我花了几个小时才弄清楚，所以我想我会与世界分享

这假设您有一个模型被调用`RssFeed`，另一个被调用`RssFeedUser`，它是一个 has_many 的连接模型：通过一个模型调用`User`

```
RssFeed.find_by_sql(
  RssFeed
    .arel_table
    .join(RssFeedUser.arel_table, Arel::Nodes::OuterJoin)
    .on(RssFeed.arel_table[:id].eq(RssFeedUser.arel_table[:rss_feed_id]))
    .where(RssFeedUser.arel_table[:user_id].eq(nil))
    .project('rss_feeds.*')
) 
```

# jquery-mobile - JQM Datebox 中的 onMonthChanged 事件

> ID：12475061
> 
> 赞同：0
> 
> 时间：2012-09-18T10:23:08.187
> 
> 标签：jquery-mobile, datebox

我在 jqm Datebox 上找不到“onMonthChanged”事件。当用户按下箭头按钮更改控件中的月份时，是否会触发任何事件？

捕捉此用户操作的任何替代解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:33:06.810

看起来像 {'method'} === offset 这样做。只是我不理解[API 文档](http://dev.jtsage.com/jQM-DateBox/demos/api/events.html)的问题。

```
$('#mydate').bind('datebox', function (e, p) {
    if (p.method === 'offset') {
        alert(p.amount);
    }
}); 
```

# unit-testing - 将单元测试的输出复制到工件

> ID：12475062
> 
> 赞同：2
> 
> 时间：2012-09-18T10:23:08.237
> 
> 标签：unit-testing, teamcity, artifacts

我的一些单元测试会产生输出文件。问题是：是否可以将这些文件复制到工件中？

我已经尝试找到生成的文件，并在 TeamCity Buildagent Temp 文件夹中找到它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:18:22.693

应该更多地研究参数的使用。使用参数 %system.teamcity.build.tempDir% 就可以了。我所做的只是将以下行添加到 artifcats 框中：

```
%system.teamcity.build.tempDir%\**\Out\*.sql => Sql-scripts 
```

# c - 在 C 中复制字符串和指针问题

> ID：12475068
> 
> 赞同：0
> 
> 时间：2012-09-18T10:23:29.490
> 
> 标签：c, string, pointers

在这个 exrecie 我得到一个输入和输出文件。输入文件包含一个数字，然后是一个长度不超过 10 的字符串，我需要对它们进行排序并将它们输出到输出文件中。我定义了一个`char** arrStr`包含所有大小最多为 10 的字符串。

我试图了解以下代码是否可以工作（由于某种原因我无法在 Eclipse 上运行它）我主要关心的是正确复制字符串而不丢失信息。我写了一张纸条“这样可以吗？” 在我最关心的声明旁边，如果有任何其他更正，我将不胜感激。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <assert.h>

int comp(const void* p1, const void* p2) {
    return strcmp((char*)p1, (char*) p2);
} 

int main(int argc, char** argv) {
    FILE* fin;
    FILE* fout;
    int N;
    char** arrStr;
    char str[11];
    int i;

    if (argc!=3) {
        printf("Please enter the program's name and two paths");
        assert(0);
    }

    fin=fopen(argv[1], "r");
    if (fin==NULL) {
        printf("path 1 is not valid");
        assert(0);
    }

    fout=fopen(argv[2], "w");
    if (fout==NULL) {
        printf("path for file 2 is not valid");
        fclose(fin);
        assert(0);
    }

    fscanf(fin, "%d", &N); 
    arrStr=(char**)calloc(N, sizeof(char)*11);
    for (i=0; i<N; i++) { 
        fscanf(fin, "%s", str);
        strcpy(arrStr[i], str);  /*is it ok?*/
    }

    qsort(arrStr, N, sizeof(char)*11, comp);
    for (i=0; i<N; i++) {
        if (i==N-1)
            fprintf(fout, "%s", arrStr[i]);
        else
            fprintf(fout, "%s,", arrStr[i]);

    }
    fclose(fin);
    free(arrStr);
    fclose(fout);
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:34:48.930

线

```
strcpy(arrStr[i], str);  /*is it ok?*/ 
```

*不行*。_ 你复制到一个`NULL`指针。

对于这种情况，请使用 eg`strdup`而不是`strcpy`：

```
arrStr[i] = strdup(str); 
```

不要忘记稍后释放这个字符串。

您还错误地分配了数组：

```
arrStr=(char**)calloc(N, sizeof(char)*11); 
```

这不会分配字符串数组，而是分配`N * 11`字节。改成：

```
arrStr = calloc(N, sizeof(char *)); 
```

# sql - 从同一列但不同的条件计数

> ID：12475069
> 
> 赞同：3
> 
> 时间：2012-09-18T10:23:29.880
> 
> 标签：sql, sql-server, sql-server-2008

我在以下查询中得到三个不同的结果，它们都有相同的连接和列来计算只是一个条件来计算是不同的，有什么办法可以让我得到 Questions, Correct, Attempted & IeslTopics.Name 列在一起一个查询？

```
SELECT     COUNT(TestResults2.QuestionID) AS Questions, Topics.Name
FROM         TestResults 
INNER JOIN   TestResults2 ON TestResults.ID = TestResults2.TestResultID 
INNER JOIN   QuestionBank ON TestResults2.QuestionID = QuestionBank.ID 
INNER JOIN   Topics ON QuestionBank.TopicID = Topics.ID
WHERE        (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY   Topics.Name
//All topic

SELECT     COUNT(TestResults2.QuestionID) AS Correct, Topics.Name
FROM         TestResults 
INNER JOIN   TestResults2 ON TestResults.ID = TestResults2.TestResultID 
INNER JOIN   QuestionBank ON TestResults2.QuestionID = QuestionBank.ID AND 
                             TestResults2.Answer = QuestionBank.Answer 
INNER JOIN   Topics ON QuestionBank.TopicID = Topics.ID
WHERE        (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY   Topics.Name
//Correct topic

SELECT     COUNT(TestResults2.QuestionID) AS Attempted, Topics.Name
FROM         TestResults 
INNER JOIN   TestResults2 ON TestResults.ID = TestResults2.TestResultID 
INNER JOIN   QuestionBank ON TestResults2.QuestionID = QuestionBank.ID AND 
                             TestResults2.Answer <> '\0' 
INNER JOIN   Topics ON QuestionBank.TopicID = Topics.ID
WHERE        (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY   Topics.Name
//Attempted topic 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:27:09.247

加入 3 个查询，并将其加入一个查询，您可以在其中选择所有主题名称。

//编辑这样的东西：

```
Select t.Name, a.Questions, b.Correct,c.Attempted from Topics t Left Join (
SELECT     COUNT(TestResults2.QuestionID) AS Questions, Topics.Name
FROM         TestResults INNER JOIN
                      TestResults2 ON TestResults.ID = TestResults2.TestResultID INNER JOIN
                      QuestionBank ON TestResults2.QuestionID = QuestionBank.ID INNER JOIN
                      Topics ON QuestionBank.TopicID = Topics.ID
WHERE     (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY Topics.Name) a On t.Name=a.Name
Inner Join(
SELECT     COUNT(TestResults2.QuestionID) AS Correct, Topics.Name
FROM         TestResults INNER JOIN
                      TestResults2 ON TestResults.ID = TestResults2.TestResultID INNER JOIN
                      QuestionBank ON TestResults2.QuestionID = QuestionBank.ID AND 
                      TestResults2.Answer = QuestionBank.Answer INNER JOIN
                      Topics ON QuestionBank.TopicID = Topics.ID
WHERE     (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY Topics.Name) b On t.Name=b.Name
Inner Join(
SELECT     COUNT(TestResults2.QuestionID) AS Attempted, Topics.Name
FROM         TestResults INNER JOIN
                      TestResults2 ON TestResults.ID = TestResults2.TestResultID INNER JOIN
                      QuestionBank ON TestResults2.QuestionID = QuestionBank.ID AND 
                      TestResults2.Answer <> '\0' INNER JOIN
                      Topics ON QuestionBank.TopicID = Topics.ID
WHERE     (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY Topics.Name) c on c.Name=t.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:31:22.300

您可以在 a 中使用条件`SUM`为您要查找的项目提供条件，为其他项目提供零，如下所示：

```
SELECT
    COUNT(TestResults2.QuestionID) AS Questions
,   SUM(CASE WHEN TestResults2.Answer = QuestionBank.Answer THEN 1 ELSE 0 END) AS Correct
,   SUM(CASE WHEN TestResults2.Answer <> '\0' THEN 1 ELSE 0 END) AS Attempted
,   Topics.Name
FROM         TestResults INNER JOIN
                  TestResults2 ON TestResults.ID = TestResults2.TestResultID INNER JOIN
                  QuestionBank ON TestResults2.QuestionID = QuestionBank.ID INNER JOIN
                  Topics ON QuestionBank.TopicID = Topics.ID
WHERE     (TestResults.StudentID = 1) AND (TestResults.ID = 46)
GROUP BY Topics.Name 
```

# umbraco - Umbraco：如何找到未发布的节点

> ID：12475070
> 
> 赞同：1
> 
> 时间：2012-09-18T10:23:34.620
> 
> 标签：umbraco

我创建了一个 Umbraco 包，安装后，我需要向用户询问我需要放置在已安装内容节点之一中的信息。

有一件事阻止我完成这个项目。与我的包一起安装的有问题的内容节点是`unpublished`. 如何找到节点？

我想过重新发布整个网站，但网站所有者可能有他不想发布的内容。

在写这个问题时，我也想过自己创建节点。

如何实现这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T13:15:09.270

类 Document 将让您看到取消发布的内容。该行为与 Node 类相同，但具有已发布和未发布的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T17:08:50.993

我最终以编程方式创建了节点，而不是仅仅将它们添加为内容，然后知道 id，可以立即发布它们。

# excel - SCALA POI API。无法访问继承的字段

> ID：12475076
> 
> 赞同：0
> 
> 时间：2012-09-18T10:23:49.823
> 
> 标签：excel, scala, apache-poi

我正在编写一些代码来读取一个excel文件。此时我正在尝试确定单元格的类型。

```
 val wb:HSSFWorkbook= new HSSFWorkbook(fileInput)
    val sheet:HSSFSheet = wb.getSheetAt(0);
    val rows    = sheet.rowIterator()

    while(rows.hasNext()){
     var    row = rows.next()
    val cells = row.cellIterator()
    while(cells.hasNext()){
   val cell = cells.next()
   println(cell.getCellType()== org.apache.poi.hssf.usermodel.HSSFCell.CELL_TYPE_NUMERIC)}} 
```

它说

```
 value CELL_TYPE_NUMERIC is not a member of object org.apache.poi.hssf.usermodel.HSSFCell 
```

我不明白为什么我无法访问该字段。你能帮忙吗？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:53:48.500

Scala 对待静态字段有点不同。scala中没有静态字段，所以scala`object`为java类中的静态字段构建了virtual。由于`CELL_TYPE_NUMERIC`is not defined on `org.apache.poi.hssf.usermodel.HSSFCell`but on `org.apache.poi.ss.usermodel.Cell`，您不能从那里访问它，因为静态成员不考虑继承。您可以直接访问该字段：

```
scala> org.apache.poi.ss.usermodel.Cell.CELL_TYPE_NUMERIC
res1: Int = 0 
```

如果考虑到继承，这将导致与 scala`object`的工作方式不一致。在 Scala 中，伴生对象不会从类超类的伴生对象继承任何东西。

# javascript - Twitter 分享按钮不适用于 Jquery Mobile

> ID：12475079
> 
> 赞同：1
> 
> 时间：2012-09-18T10:23:55.520
> 
> 标签：javascript, jquery, twitter, share

我使用 Jquery-Mobile & Phonegap 开发移动应用程序。我想使用 twitter 分享脚本分享动态数据：

当我在外部页面中使用此代码时“不使用 jquery-mobile 或任何其他脚本，它工作正常。

html:

```
<a href="http://twitter.com/share" 
data-url="http://your.url.com/yourdynamicpage" 
class="twitter-share-button" 
data-text="What should I share?" 
data-count="horizontal">Tweet</a> 
```

但是，当我将其添加到 javascript 文件中以动态添加信息“Data-text”和“Data-Url”时，twitter 会在其中没有这些数据的情况下打开。

html:

Javascript：

```
$('#TwitterShare').append('<a href="http://twitter.com/share" rel="external" 
data-url="http://your.url.com/yourdynamicpage" 
class="twitter-share-button" 
data-text="Dynamic Data will be inserted here" 
data-count="horizontal">Tweet</a>'); 
```

当我静态添加行时，发送的链接是：

```
https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Flocalhost%3A3025%2FShareTrial.html&source=tweetbutton&text=What%20should%20I%20share%3F&url=http%3A%2F%2Fyour.url.com%2Fyourdynamicpage 
```

但是当它被动态添加时，链接上不会发送任何数据：

```
https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Flocalhost%3A3025%2FViewPost.html&url=http%3A%2F%2Flocalhost%3A3025%2FViewPost.html 
```

我想知道为什么会发生这种情况以及我该如何解决？

谢谢。

# c# - 更新绑定到它的 ObservableCollection 后 DataGrid 没有更新

> ID：12475080
> 
> 赞同：2
> 
> 时间：2012-09-18T10:23:56.823
> 
> 标签：c#, wpf, xaml, wpfdatagrid

这几天我有一个非常严重的问题，我无法解决。

我有一个带有数据网格的 XAML 窗口，该窗口`ItemsSource`绑定到包含`ObservableCollection`另一个自定义类型的自定义类型的静态属性。

XAML：

```
<Window x:Class="TheFaceBook.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TheProject"
    Title="MainWindow" MinHeight="253" MinWidth="882" xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit" mc:Ignorable="d" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" d:DesignHeight="632" d:DesignWidth="933" SizeToContent="WidthAndHeight">
<Window.Resources>
    <local:MainWindow x:Key="mainWindow"/>
</Window.Resources>
<Grid>
    <Button Content="Start" Height="33" Margin="0,28,12,0" VerticalAlignment="Top" Click="BtnStart_Click" HorizontalAlignment="Right" Width="97" />
    <DataGrid Margin="12,110,12,42" AutoGenerateColumns="False" ItemsSource="{Binding CurrentUser.TaggedImages}"  >
        <DataGrid.Columns>
            <DataGridTemplateColumn Width="50" IsReadOnly="True">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Image Source="{Binding AbsoluteURL}" />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTextColumn Binding="{Binding FacebookURL}"/>
        </DataGrid.Columns>
    </DataGrid>
</Grid> 
```

属性背后的代码：

```
private static User m_CurrentUser;
public static User CurrentUser
{
    get { return MainWindow.m_CurrentUser; }
    set
    {
        MainWindow.m_CurrentUser = value;
    }
} 
```

用户类：

```
private ObservableCollection <Picture> m_TaggedImages;

#endregion
#region Properties

public ObservableCollection<Picture> TaggedImages
{
    get { return m_TaggedImages; }
    set 
    { 
        m_TaggedImages = value;
    }
} 
```

图片类：

```
public class Picture : INotifyPropertyChanged
{

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
    private string m_URL;
    private string m_AbsoluteURL;
    private List<User> m_TaggedUsers;

    public List<User> TaggedUsers
    {
        get { return m_TaggedUsers; }
        set 
        {
            m_TaggedUsers = value;
            OnPropertyChanged("TaggedUsers");
        }
    }

    public string AbsoluteURL
    {
        get { return m_AbsoluteURL; }
        set
        {
            m_AbsoluteURL = value;
            OnPropertyChanged("AbsoluteURL");
        }
    }

    public string URL
    {
        get { return m_URL; }
        set
        {
            m_URL = value;
            OnPropertyChanged("URL");
        }
    }
} 
```

将图片添加到 TaggedImagse 的代码：

在 bgwDoWork 内部：

bgwPictureFinder.ReportProgress(0, pic);

bgwProgressChanged：

```
static void bgwPictureFinder_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    if (e.ProgressPercentage == 0)
    {
        Picture pic = (Picture)e.UserState;
        MainWindow.CurrentUser.TaggedImages.Add(pic);
    }
} 
```

当我`MainWindow.CurrentUser.TaggedImages`从其他人手动添加到`backgroundworker`它时它工作得很好，但是当从`bgwPictureFinder_ProgressChanged`它添加时将图片添加到`MainWindow.CurrentUser.TaggedImages observableCollection`但不更新 UI 以显示图像。

我只是无法弄清楚是什么导致了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:31:46.607

我不确定 WPF upto (v 4.0) 是否支持数据绑定到静态属性。此功能是在 .NET 4.5 中添加的。[检查这个。](http://msdn.microsoft.com/en-us/library/bb613588.aspx#static_properties)

**引用 WPF 4.5 版中的新增功能：**

> **绑定到静态属性**
> 
> 您可以使用静态属性作为数据绑定的来源。如果引发静态事件，数据绑定引擎会识别属性值何时更改。例如，如果类 SomeClass 定义了一个名为 MyProperty 的静态属性，那么 SomeClass 可以定义一个静态事件，该事件在 MyProperty 的值更改时引发。静态事件可以使用以下任一签名。

```
public static event EventHandler MyPropertyChanged;
public static event EventHandler<PropertyChangedEventArgs> StaticPropertyChanged; 
```

> 请注意，在第一种情况下，该类公开了一个名为 PropertyNameChanged 的​​静态事件，该事件将 EventArgs 传递给事件处理程序。在第二种情况下，该类公开了一个名为 StaticPropertyChanged 的​​静态事件，该事件将 PropertyChangedEventArgs 传递给事件处理程序。实现静态属性的类可以选择使用任一方法引发属性更改通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:03:20.237

我怀疑它必须与您初始化新对象的顺序有关。例如 TaggedImages List 和实际的 CurrentUser 属性。检查真的很简单。查看“调试绑定”，看看会发生什么。

我也会添加 OnPropertyChanged("TaggedImages") 。是的，observableCollection 的添加/删除已经实现，但我认为 WPF 无法在没有 OnPropertyChanged 的​​情况下判断实际集合引用何时发生变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:23:42.110

我认为您在代码示例中错过了这一点：

```
protected void OnPropertyChanged(string propertyName)
{
   var handlers = PropertyChanged;
   if (handlers != null)
   {
      handlers(this, new PropertyChangedEventArgs(propertyName));
   }
} 
```

对于您的绑定，我使用双向模式：

```
{Binding..., Mode=TwoWay} 
```

# php - 具有相同 id 的多个输入字段

> ID：12475085
> 
> 赞同：-4
> 
> 时间：2012-09-18T10:24:14.063
> 
> 标签：php, jquery

我正在使用输入字段从 php 代码呈现数据，但是当我从数据库中检索数据时，输入字段被复制，并且我已经为其分配了一个 id 和一个类值，现在我面临的问题是，如果我使用 id，它只会显示第一个仅值。如果我使用类它开始迭代它并完成直到每个字段并在输入字段为空的地方显示为空

Jquery 代码是这个

```
$('.submit-button').on('click',function(){
    $('.datecontrol').each(function(){
        alert($(this).val());
}); 
```

[这里](http://pastie.org/4746295)提供了我的整个 html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:35:08.650

首先，根据标题，使用具有相同 id 的多个字段不是一个好主意。它将产生问题的是 CSS、脚本等。

接下来，如果只选择特定数量的字段是您的问题，则为字段分配不同的类以表示特定组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:46:15.757

your code has some syntax errors, so if you want to show only fields with values

```
 $('.submit-button').on('click',function(){
       $('.datecontrol').each(function(){
        if($(this).val()!='') // check if field is empty
           alert($(this).val());
       }); //-->missing closing brackets
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:10:26.020

首先，你不能对多个元素使用相同的id，如果你想让jquery代码找到元素，它只会找到最后一个。

更好的是，您使用类，或者您可以使用标题标签来使用多个元素`.each()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:44:16.907

我不太了解您的问题，但我认为您正在寻找的答案 - 或者您应该考虑的内容如下：

在 JQuery 中，您可以选择带有类示例的 ID，例如。

```
$("#yourid.yourclass"); 
```

这意味着您可以保留唯一的 ID（这对工作流程很重要），您仍然可以为组分配类！

所以一个示例元素看起来像这样

```
<div id="mynumber" class="red"></div>
<script>
$("#mynumber.red").on("click", function()
{
alert('I was clicked');
});</script> 
```

对于查找空项目，您可以使用 .length()

作为附加信息：要在使用相同 id 时验证您的文档，请不要使用 html 标签 id="" 而是使用 data-id="" 作为数据元素无论如何都是有效的。

# javascript - 如果元素包含子元素运行函数

> ID：12475086
> 
> 赞同：0
> 
> 时间：2012-09-18T10:24:19.233
> 
> 标签：javascript, jquery

我的网站上有一个轮播，如果没有元素，我的 jquery 似乎会崩溃。

我没有元素的 HTML 输出是......

```
<section class="gallery-viewport-twobedroomapartment viewer">
     <ul>
     </ul>
     <a id="simplePrevious"><img alt="Left Arrow" src="_includes/images/larr.png"></a>
     <a id="simpleNext"><img alt="Right Arrow" src="_includes/images/rarr.png"></a>
</section> 
```

我的 jQuery 是...

```
$('.gallery-viewport-twobedroomapartment').carousel('#simplePrevious', '#simpleNext'); 
```

是否可以说如果 UL 包含 LI 然后运行该功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:26:08.857

```
if($('.gallery-viewport-twobedroomapartment ul > li').length > 0) {
   $('.gallery-viewport-twobedroomapartment').carousel('#simplePrevious', '#simpleNext');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:33:38.060

要知道 jQuery 集合中是否有任何元素，请使用`length`.

```
if ($(elements).length) {
  // there are elements
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:25:57.800

```
var liCount = $('ul li').length;

if (liCount > 0) {
  $('.gallery-viewport-twobedroomapartment').carousel('#simplePrevious', '#simpleNext');
} 
```

繁荣！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:26:39.137

您可以使用`.children()`和`length`：

```
if ($(".gallery-viewport-twobedroomapartment").children("ul").children("li").length > 1)
    $('.gallery-viewport-twobedroomapartment').carousel('#simplePrevious', '#simpleNext'); 
```

# html - Perl 使用 XSLT 将 XML 转换为 HTML

> ID：12475091
> 
> 赞同：2
> 
> 时间：2012-09-18T10:24:38.013
> 
> 标签：html, xml, perl, xslt

我是 perl 的菜鸟，我想知道是否有人可以帮助我完成我需要完成的任务。

我有一个 XML 文件和一个 XSLT 文件，我需要使用 perl 来了解如何使用这两个文件创建一个 html 文件。有人对我可以从哪里开始，或者我可以查看哪些 perl 模块来帮助我有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:51:04.273

正如@StuartLC 建议的那样，[XML::LibXSLT](http://search.cpan.org/~shlomif/XML-LibXSLT-1.80/LibXSLT.pm)是一个很好的起点。我编写了一个系统，在大型网站的生产中使用它。手册中的第一件事是一个小示例，可以帮助您启动并运行。

# android - ListItem 中的垂直滚动文本？

> ID：12475101
> 
> 赞同：0
> 
> 时间：2012-09-18T10:25:30.610
> 
> 标签：android, android-listview, scroll, listitem, vertical-scrolling

我已经为我的 ListView 实现了一个自定义 ListItem。ListItem 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rlOfferRoot"
    android:layout_width="fill_parent"
    android:layout_height="60dp"
    android:padding="5dp"
    android:background="@color/white">

      <RelativeLayout
        android:id="@+id/rlOfferDetails"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#000000">

        <LinearLayout
          android:id="@+id/llOfferRoot"
          android:layout_width="fill_parent"
          android:layout_height="200dp"
          android:orientation="vertical"
          android:background="@color/orange">
            <ImageView
              android:id="@+id/imgOfferImage"
              android:layout_width="fill_parent"
              android:layout_height="match_parent"/>
        </LinearLayout>
        <LinearLayout
          android:id="@+id/menuDrawerLayer"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:gravity="bottom"
          android:layout_gravity="bottom">

        <SlidingDrawer
          android:id="@+id/sdOfferDetails"
          android:layout_width="fill_parent"
          android:layout_height="200dp"
          android:layout_alignBottom="@id/imgOfferImage"
          android:content="@+id/drawerButtons"
          android:handle="@+id/slideHandleButton"
          android:topOffset="-50dp">

            <Button
               android:id="@+id/slideHandleButton"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:background="@drawable/arrowup"/>

            <RelativeLayout
              android:id="@+id/drawerButtons"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              android:background="#80000000">
              <ScrollView
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:scrollbars="vertical"
                android:padding="10dp"
                android:focusable="true">
                <TextView
                  android:id="@+id/txtOfferDetails"
                  android:layout_width="fill_parent"
                  android:layout_height="fill_parent"
                  android:textColor="@color/white"
                  android:text="This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end
                           This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text This is some text end"/>
              </ScrollView>
        </RelativeLayout>
      </SlidingDrawer>
    </LinearLayout>

  </RelativeLayout>
  </RelativeLayout> 
```

这看起来很棒并且按预期执行，除非我打开我的 SlidingDrawer 并尝试滚动浏览 TextView 中包含的文本。

当我看到 TextView 的滚动条出现片刻时，TextView 看起来获得了焦点，但随后 ListView 似乎抓住了焦点，整个列表开始滚动。

我是否需要实现一个自定义 ListView 来对此进行排序，或者他们是一个快速修复？我尝试了与上面相同的方法，但使用了一个确实有效的 Horizo​​ntalScrollScrollView，但这可能是因为 ListView 对水平滚动事件没有任何作用。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:34:25.640

在 ScrollView 上设置触摸监听器

```
 OnTouchListener childScroll = new View.OnTouchListener() {

           @Override
           public boolean onTouch(View v, MotionEvent event) {
                 v.getParent().requestDisallowInterceptTouchEvent( true);
                  return false ;
          }
   }; 
```

# css - 在我的页面中集成视频全屏的最佳解决方案

> ID：12475112
> 
> 赞同：0
> 
> 时间：2012-09-18T10:26:18.540
> 
> 标签：css, html, video, html5-video

我需要将视频作为完整背景放在我的[页面](http://tommywebdesigner.com/Vision%20General.html)中。视频必须准确地放置在图像所在的位置。

图像在我的 div 内：

```
<div class="main">
    <img src="img/lapedrera1.jpg" alt="architecture" class="homeimg">
</div><!-- /main -->

.main  {
z-index:1;
position:fixed;
} 
```

我需要在那里放一个视频，替换img。

我想从右脚开始，你建议我怎么做？哪个是最好的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T01:51:15.387

前几天我只是在测试这个。这是我用来让我的视频全屏顶部/左侧/右侧/底部的内容，我只是将其强制放置到边缘，但下面的 def 有效。

```
#vid{
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  z-index: -1000;
  width:100%;
  height:100%;

} 
```

我还使用 CSS 重置，因此所有浏览器上的所有值都相同。因此，如果您添加重置，您可以删除（或保留）顶部/左侧/右侧/底部值等。

但这应该让你继续前进。显然，只需更改您父 div 的#vid。Z-index 是它移动到我在页面上的任何内容之后，因此您可以随意使用它。

# html - 如何使用 POST 方法发送大数据？

> ID：12475116
> 
> 赞同：7
> 
> 时间：2012-09-18T10:26:36.167
> 
> 标签：html

如何使用 POST 方法发送大量数据？

我听说 post 方法默认是 8M 现在如果你超过这个大小怎么办？您将如何向服务器发送纯文本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T10:37:21.107

**大卫**的一个很好的回答：

> 请求的 url 部分（GET 和 POST）可以受到浏览器和服务器的限制 - 通常安全大小为 2KB，因为几乎没有浏览器或服务器使用较小的限制。
> 
> 请求的正文（POST）通常*由服务器以字节大小为基础*，以防止某种类型的 DoS 攻击（请注意，这意味着字符转义会增加正文的字节大小）。最常见的服务器设置是 10MB，尽管所有流行的服务器都允许通过设置文件或面板来增加或减少此设置。
> 
> *旧手机或其他小型设备浏览器存在一些例外情况 - 在这些情况下，它更多的是设备上为此目的保留的堆空间的功能，而不是其他任何东西。

[发帖请求的大小限制是多少？](https://stackoverflow.com/questions/2364840/what-is-the-size-limit-of-a-post-request)

**注意**：URL 的 2MB 数据意味着一个请求中有 2097152 个字符。

此外，如果您想发送更多数据，您可以使用**multipal ajax 请求**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:38:37.600

上传文件，因为如果出现中断，您可能会超时。

您要发送到 PHP 脚本吗？如果是这样，您可能需要在 php.ini 中增加上传大小

搜索`upload_max_filesize`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-10T07:56:43.707

如果您有权访问 ini.php 更改值

```
post_max_size 
```

至

```
20M 
```

* * *

从8M你将能够实现你想要的

# java - 如何在提交时检查 LOC 的增加？

> ID：12475118
> 
> 赞同：1
> 
> 时间：2012-09-18T10:26:40.380
> 
> 标签：java, svn, project, pmd, line-count

当有人尝试通过 SVN 提交时，每当我们项目中某些文件的 LOC/文件大小增加时，我的任务就是找到一种报告方式。

IE。如果一个文件有 26 个 LOC 并且开发人员增加了这个，他们应该在编译或提交时得到警告。

我们已经使用了 PMD，所以我希望我可以使用 PMD 规则来实现这一点，但经过研究，我不确定 PMD 是否可行。

任何意见或建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:10:26.607

我建议你看看[JavaNCSS](http://www.kclee.de/clemens/java/javancss/)。它看起来对一行代码是什么有一个合理的概念……而且它似乎是基于语法的。您可能需要修改/扩展/后期处理以比较行数随时间的变化。

**更新**

看起来它最多只支持 Java 5/6 语言语法。

* * *

话虽如此，如果您只想对“某些文件”（即少量）执行此操作，我觉得这是过度工程。而且，如果您想为大量文件执行此操作，则必须怀疑某人（也许是您的经理）是否患有指标痴迷症的临床案例。（这是一种妄想症，人们认为软件指标是项目进度的有效衡量标准......）

# ios - UIWebView loadHTMLString:baseURL: 离线缓存清单问题

> ID：12475120
> 
> 赞同：2
> 
> 时间：2012-09-18T10:26:47.403
> 
> 标签：ios, caching, uiwebview, manifest, offline

我对 UIWebView 和离线缓存有疑问。我不知道这是否是 Webkit 错误。让我解释一下问题是什么。

对于我的示例，我正在使用此处提供的 Apple 的 Checkers 演示：[https](https://developer.apple.com/safaridemos/Checkers/) ://developer.apple.com/safaridemos/Checkers/ （我确信清单有效）。

所以我正在创建一个 UWebView 并像这样加载请求：

```
NSURL *url = [NSURL URLWithString:@"https://developer.apple.com/safaridemos/Checkers/"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[self.webView loadRequest:request]; 
```

为了验证设备是否缓存了包含在 .manifest 文件中的文件，我将在应用程序文件夹中检查它。

APP_FOLDER/Library/Caches/xxxx.manifest/ApplicationCache.db

在 ApplicationCache.db 中：

```
SELECT * FROM CacheResources; 
```

给了我清单中包含的所有缓存资源（很好用！！）。

现在我退出应用程序，关闭网络连接并再次启动应用程序。游戏加载正常，没有网络连接。

现在，这是我的问题。

我不想使用 NSURLRequest 加载我的 webView，而是使用 HTML 字符串（因为我的第三个 API 通过 json 向我发送 html 文本）

UIWebView 将像这样加载：

```
NSURL *url = [NSURL URLWithString:@"https://developer.apple.com/safaridemos/Checkers/"];

NSString *html = @"<html manifest=\"OfflineCheckers.manifest\"><head><title>Checkers</title><script>window.applicationCache.onupdateready = function() { console.log(\"Swapping in new applicationCache\"); applicationCache.swapCache(); }</script><meta name=\"viewport\" content=\"width=640,user-scalable=no\" /><meta name=\"apple-mobile-web-app-capable\" content=\"yes\" /><meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" /><link rel=\"icon\" href=\"favicon.ico\" /><link rel=\"apple-touch-icon-precomposed\" href=\"resources/apple-touch-icon-precomposed.png\"/><link rel=\"apple-touch-startup-image\" href=\"resources/startup.png\"/><link href=\"resources/Checkers.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"resources/Achievements.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"resources/HighScores.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"resources/EndGame.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"resources/GameManager.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"resources/Utilities.css\" rel=\"stylesheet\" type=\"text/css\" /></head><body onload=\"initializeScreen();\"><script src=\"resources/Achievements.js\"></script><script src=\"resources/AIOpponent.js\"></script><script src=\"resources/Checkers.js\"></script><script src=\"resources/EndGame.js\"></script><script src=\"resources/GameManager.js\"></script><script src=\"resources/HighScores.js\"></script><script src=\"resources/Utilities.js\"></script><div id=\"GameParent\"></div><script>document.body.board = new CheckerBoard(document.getElementById(\"GameParent\"));</script></body></html>";
[self.webView loadHTMLString:html baseURL:url]; 
```

我首先删除应用程序以删除所有以前缓存的资源。然后设置网络连接并启动应用程序。同样的事情发生，webview被加载，资源被缓存......

现在如果我关闭网络连接，webView 将不再加载。这就像调用 loadHTMLString:baseURL: 不要使用应用程序缓存。

我知道有一个解决方案包括下载应用程序文档文件夹中的所有离线资源并将 baseURL 设置为该文件夹，但 HTML 5 离线缓存清单可以处理它，所以我想使用它。有什么办法可以解决我的问题吗？欢迎任何帮助。

多谢你们。

# java - 使用asmack for android在XMPP数据包的消息标签中添加自定义属性？

> ID：12475122
> 
> 赞同：3
> 
> 时间：2012-09-18T10:26:53.817
> 
> 标签：java, android, xmpp, smack, xmppframework

我想收到的消息包。

```
 <message to="39@domainname.com/smack" chat_id="73392" 
           custom_packet="true" user_id="44" manager_id="39" time_stamp="0" website_id="0" 
           visitor_name="John" end_time="False" xml:lang="en-us" type="groupchat" 
           from="room73392@conference.domainname.com/39">
           <body>Hello</body> 
           <x xmlns="http://jabber.org/protocol/muc#user"> 
           <status xmlns="" code="0"/>   
           </x></message> 
```

我正在接收的消息包。

```
<message to="44@domainname.com/Smack" 
    from="room73407@conference.domainname.com/Visitor1171" type="groupchat">
    <body>Hello</body>
    <delay xmlns="urn:xmpp:delay"></delay>
    <x xmlns="jabber:x:delay" stamp="20120917T05:57:19" 
    from="4732abb5@domainname.com/4732abb5">
    </x></message> 
```

我有一个 smack 的源代码，这是数据包类。谁能帮我制作我的自定义数据包。任何帮助修改源代码表示赞赏。

**代码 ：**

```
public abstract class Packet {

protected static final String DEFAULT_LANGUAGE =
        java.util.Locale.getDefault().getLanguage().toLowerCase();

private static String DEFAULT_XML_NS = null;

/**
 * Constant used as packetID to indicate that a packet has no id. To indicate that a packet
 * has no id set this constant as the packet's id. When the packet is asked for its id the
 * answer will be <tt>null</tt>.
 */
public static final String ID_NOT_AVAILABLE = "ID_NOT_AVAILABLE";

/**
 * Date format as defined in XEP-0082 - XMPP Date and Time Profiles.
 * The time zone is set to UTC.
 * <p>
 * Date formats are not synchronized. Since multiple threads access the format concurrently,
 * it must be synchronized externally. 
 */
public static final DateFormat XEP_0082_UTC_FORMAT = new SimpleDateFormat(
                "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
static {
    XEP_0082_UTC_FORMAT.setTimeZone(TimeZone.getTimeZone("UTC"));
}

/**
 * A prefix helps to make sure that ID's are unique across mutliple instances.
 */
private static String prefix = StringUtils.randomString(5) + "-";

/**
 * Keeps track of the current increment, which is appended to the prefix to
 * forum a unique ID.
 */
private static long id = 0;

private String xmlns = DEFAULT_XML_NS;

/**
 * Returns the next unique id. Each id made up of a short alphanumeric
 * prefix along with a unique numeric value.
 *
 * @return the next id.
 */
public static synchronized String nextID() {
    return prefix + Long.toString(id++);
}

public static void setDefaultXmlns(String defaultXmlns) {
    DEFAULT_XML_NS = defaultXmlns;
}

private String packetID = null;
private String to = null;
private String from = null;
private final List<PacketExtension> packetExtensions
        = new CopyOnWriteArrayList<PacketExtension>();

private final Map<String,Object> properties = new HashMap<String, Object>();
private XMPPError error = null;

/**
 * Returns the unique ID of the packet. The returned value could be <tt>null</tt> when
 * ID_NOT_AVAILABLE was set as the packet's id.
 *
 * @return the packet's unique ID or <tt>null</tt> if the packet's id is not available.
 */
public String getPacketID() {
    if (ID_NOT_AVAILABLE.equals(packetID)) {
        return null;
    }

    if (packetID == null) {
        packetID = nextID();
    }
    return packetID;
}

/**
 * Sets the unique ID of the packet. To indicate that a packet has no id
 * pass the constant ID_NOT_AVAILABLE as the packet's id value.
 *
 * @param packetID the unique ID for the packet.
 */
public void setPacketID(String packetID) {
    this.packetID = packetID;
}

/**
 * Returns who the packet is being sent "to", or <tt>null</tt> if
 * the value is not set. The XMPP protocol often makes the "to"
 * attribute optional, so it does not always need to be set.<p>
 *
 * The StringUtils class provides several useful methods for dealing with
 * XMPP addresses such as parsing the
 * {@link StringUtils#parseBareAddress(String) bare address},
 * {@link StringUtils#parseName(String) user name},
 * {@link StringUtils#parseServer(String) server}, and
 * {@link StringUtils#parseResource(String) resource}.  
 *
 * @return who the packet is being sent to, or <tt>null</tt> if the
 *      value has not been set.
 */
public String getTo() {
    return to;
}

/**
 * Sets who the packet is being sent "to". The XMPP protocol often makes
 * the "to" attribute optional, so it does not always need to be set.
 *
 * @param to who the packet is being sent to.
 */
public void setTo(String to) {
    this.to = to;
}

/**
 * Returns who the packet is being sent "from" or <tt>null</tt> if
 * the value is not set. The XMPP protocol often makes the "from"
 * attribute optional, so it does not always need to be set.<p>
 *
 * The StringUtils class provides several useful methods for dealing with
 * XMPP addresses such as parsing the
 * {@link StringUtils#parseBareAddress(String) bare address},
 * {@link StringUtils#parseName(String) user name},
 * {@link StringUtils#parseServer(String) server}, and
 * {@link StringUtils#parseResource(String) resource}.  
 *
 * @return who the packet is being sent from, or <tt>null</tt> if the
 *      value has not been set.
 */
public String getFrom() {
    return from;
}

/**
 * Sets who the packet is being sent "from". The XMPP protocol often
 * makes the "from" attribute optional, so it does not always need to
 * be set.
 *
 * @param from who the packet is being sent to.
 */
public void setFrom(String from) {
    this.from = from;
}

/**
 * Returns the error associated with this packet, or <tt>null</tt> if there are
 * no errors.
 *
 * @return the error sub-packet or <tt>null</tt> if there isn't an error.
 */
public XMPPError getError() {
    return error;
}

/**
 * Sets the error for this packet.
 *
 * @param error the error to associate with this packet.
 */
public void setError(XMPPError error) {
    this.error = error;
}

/**
 * Returns an unmodifiable collection of the packet extensions attached to the packet.
 *
 * @return the packet extensions.
 */
public synchronized Collection<PacketExtension> getExtensions() {
    if (packetExtensions == null) {
        return Collections.emptyList();
    }
    return Collections.unmodifiableList(new ArrayList<PacketExtension>(packetExtensions));
}

/**
 * Returns the first extension of this packet that has the given namespace.
 *
 * @param namespace the namespace of the extension that is desired.
 * @return the packet extension with the given namespace.
 */
public PacketExtension getExtension(String namespace) {
    return getExtension(null, namespace);
}

/**
 * Returns the first packet extension that matches the specified element name and
 * namespace, or <tt>null</tt> if it doesn't exist. If the provided elementName is null
 * than only the provided namespace is attempted to be matched. Packet extensions are
 * are arbitrary XML sub-documents in standard XMPP packets. By default, a 
 * DefaultPacketExtension instance will be returned for each extension. However, 
 * PacketExtensionProvider instances can be registered with the 
 * {@link org.jivesoftware.smack.provider.ProviderManager ProviderManager}
 * class to handle custom parsing. In that case, the type of the Object
 * will be determined by the provider.
 *
 * @param elementName the XML element name of the packet extension. (May be null)
 * @param namespace the XML element namespace of the packet extension.
 * @return the extension, or <tt>null</tt> if it doesn't exist.
 */
public PacketExtension getExtension(String elementName, String namespace) {
    if (namespace == null) {
        return null;
    }
    for (PacketExtension ext : packetExtensions) {
        if ((elementName == null || elementName.equals(ext.getElementName()))
                && namespace.equals(ext.getNamespace()))
        {
            return ext;
        }
    }
    return null;
}

/**
 * Adds a packet extension to the packet.
 *
 * @param extension a packet extension.
 */
public void addExtension(PacketExtension extension) {
    packetExtensions.add(extension);
}

/**
 * Removes a packet extension from the packet.
 *
 * @param extension the packet extension to remove.
 */
public void removeExtension(PacketExtension extension)  {
    packetExtensions.remove(extension);
}

/**
 * Returns the packet property with the specified name or <tt>null</tt> if the
 * property doesn't exist. Property values that were orginally primitives will
 * be returned as their object equivalent. For example, an int property will be
 * returned as an Integer, a double as a Double, etc.
 *
 * @param name the name of the property.
 * @return the property, or <tt>null</tt> if the property doesn't exist.
 */
public synchronized Object getProperty(String name) {
    if (properties == null) {
        return null;
    }
    return properties.get(name);
}

/**
 * Sets a property with an Object as the value. The value must be Serializable
 * or an IllegalArgumentException will be thrown.
 *
 * @param name the name of the property.
 * @param value the value of the property.
 */
public synchronized void setProperty(String name, Object value) {
    if (!(value instanceof Serializable)) {
        throw new IllegalArgumentException("Value must be serialiazble");
    }
    properties.put(name, value);
}

/**
 * Deletes a property.
 *
 * @param name the name of the property to delete.
 */
public synchronized void deleteProperty(String name) {
    if (properties == null) {
        return;
    }
    properties.remove(name);
}

/**
 * Returns an unmodifiable collection of all the property names that are set.
 *
 * @return all property names.
 */
public synchronized Collection<String> getPropertyNames() {
    if (properties == null) {
        return Collections.emptySet();
    }
    return Collections.unmodifiableSet(new HashSet<String>(properties.keySet()));
}

/**
 * Returns the packet as XML. Every concrete extension of Packet must implement
 * this method. In addition to writing out packet-specific data, every sub-class
 * should also write out the error and the extensions data if they are defined.
 *
 * @return the XML format of the packet as a String.
 */
public abstract String toXML();

/**
 * Returns the extension sub-packets (including properties data) as an XML
 * String, or the Empty String if there are no packet extensions.
 *
 * @return the extension sub-packets as XML or the Empty String if there
 * are no packet extensions.
 */
protected synchronized String getExtensionsXML() {
    StringBuilder buf = new StringBuilder();
    // Add in all standard extension sub-packets.
    for (PacketExtension extension : getExtensions()) {
        buf.append(extension.toXML());
    }
    // Add in packet properties.
    if (properties != null && !properties.isEmpty()) {
        buf.append("<properties xmlns=\"http://www.jivesoftware.com/xmlns/xmpp/properties\">");
        // Loop through all properties and write them out.
        for (String name : getPropertyNames()) {
            Object value = getProperty(name);
            buf.append("<property>");
            buf.append("<name>").append(StringUtils.escapeForXML(name)).append("</name>");
            buf.append("<value type=\"");
            if (value instanceof Integer) {
                buf.append("integer\">").append(value).append("</value>");
            }
            else if (value instanceof Long) {
                buf.append("long\">").append(value).append("</value>");
            }
            else if (value instanceof Float) {
                buf.append("float\">").append(value).append("</value>");
            }
            else if (value instanceof Double) {
                buf.append("double\">").append(value).append("</value>");
            }
            else if (value instanceof Boolean) {
                buf.append("boolean\">").append(value).append("</value>");
            }
            else if (value instanceof String) {
                buf.append("string\">");
                buf.append(StringUtils.escapeForXML((String)value));
                buf.append("</value>");
            }
            // Otherwise, it's a generic Serializable object. Serialized objects are in
            // a binary format, which won't work well inside of XML. Therefore, we base-64
            // encode the binary data before adding it.
            else {
                ByteArrayOutputStream byteStream = null;
                ObjectOutputStream out = null;
                try {
                    byteStream = new ByteArrayOutputStream();
                    out = new ObjectOutputStream(byteStream);
                    out.writeObject(value);
                    buf.append("java-object\">");
                    String encodedVal = StringUtils.encodeBase64(byteStream.toByteArray());
                    buf.append(encodedVal).append("</value>");
                }
                catch (Exception e) {
                    e.printStackTrace();
                }
                finally {
                    if (out != null) {
                        try {
                            out.close();
                        }
                        catch (Exception e) {
                            // Ignore.
                        }
                    }
                    if (byteStream != null) {
                        try {
                            byteStream.close();
                        }
                        catch (Exception e) {
                            // Ignore.
                        }
                    }
                }
            }
            buf.append("</property>");
        }
        buf.append("</properties>");
    }
    return buf.toString();
}

public String getXmlns() {
    return this.xmlns;
}

public static String getDefaultLanguage() {
    return DEFAULT_LANGUAGE;
}

@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;

    Packet packet = (Packet) o;

    if (error != null ? !error.equals(packet.error) : packet.error != null) { return false; }
    if (from != null ? !from.equals(packet.from) : packet.from != null) { return false; }
    if (!packetExtensions.equals(packet.packetExtensions)) { return false; }
    if (packetID != null ? !packetID.equals(packet.packetID) : packet.packetID != null) {
        return false;
    }
    if (properties != null ? !properties.equals(packet.properties)
            : packet.properties != null) {
        return false;
    }
    if (to != null ? !to.equals(packet.to) : packet.to != null)  { return false; }
    return !(xmlns != null ? !xmlns.equals(packet.xmlns) : packet.xmlns != null);
}

@Override
public int hashCode() {
    int result;
    result = (xmlns != null ? xmlns.hashCode() : 0);
    result = 31 * result + (packetID != null ? packetID.hashCode() : 0);
    result = 31 * result + (to != null ? to.hashCode() : 0);
    result = 31 * result + (from != null ? from.hashCode() : 0);
    result = 31 * result + packetExtensions.hashCode();
    result = 31 * result + properties.hashCode();
    result = 31 * result + (error != null ? error.hashCode() : 0);
    return result;
}
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T13:43:36.817

尽管我认为这是错误的方法，正如我在您的另一个问题中所说的那样。这些是您尝试做的一些指导方针。

您不需要修改 Packet，只需扩展 Message 以放入您自己的自定义属性。这将完成发送所需的内容。对于接收，您必须修改[PacketParserUtil.parseMessage()](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/util/PacketParserUtils.html#parseMessage%28org.xmlpull.v1.XmlPullParser%29)以便能够确定您的自定义消息还是标准消息正在发送，并根据需要构建和填充。我不知道您使用的服务器是否存在问题，因为它是非标准的，但它可能会工作。

另一个更简单的选择是通过[Packet.setProperty()](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/packet/Packet.html#setProperty%28java.lang.String,%20java.lang.Object%29)将您的属性作为属性简单地添加到标准消息中，当然也可以通过 getProperty() 读取。这将创建和扩展数据包，但不需要自定义工作，因为 Smack 已经读/写了扩展。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T04:05:18.537

我在数据包类中添加了新字段，并在那里写了 Getter 和 Setter。

```
private String chat_id = null;
private String custom_packet = null;
private String user_id=null;
private String manager_id=null;
private String time_stamp=null;
private String website_id=null;
private String visitor_name=null;
private String end_time=null;

public String getChat_id() {
    return chat_id;
}

public void setChat_id(String chat_id) {
    this.chat_id = chat_id;
}

public String getCustom_packet() {
    return custom_packet;
}

public void setCustom_packet(String custom_packet) {
    this.custom_packet = custom_packet;
}

public String getUser_id() {
    return user_id;
}

public void setUser_id(String user_id) {
    this.user_id = user_id;
}

public String getManager_id() {
    return manager_id;
}

public void setManager_id(String manager_id) {
    this.manager_id = manager_id;
}

public String getTime_stamp() {
    return time_stamp;
}

public void setTime_stamp(String time_stamp) {
    this.time_stamp = time_stamp;
}

public String getWebsite_id() {
    return website_id;
}

public void setWebsite_id(String website_id) {
    this.website_id = website_id;
}

public String getVisitor_name() {
    return visitor_name;
}

public void setVisitor_name(String visitor_name) {
    this.visitor_name = visitor_name;
}

public String getEnd_time() {
    return end_time;
}

public void setEnd_time(String end_time) {
    this.end_time = end_time;
} 
```

然后我将它添加到 PacketParserUtils 类的 parseMessage() 方法中。

```
 // ------------------------------CUSTOM ATTRIBUTES-----------------------------
    message.setChat_id(parser.getAttributeValue("", "chat_id"));
    message.setCustom_packet(parser.getAttributeValue("", "custom_packet"));
    message.setUser_id(parser.getAttributeValue("", "user_id"));
    message.setManager_id(parser.getAttributeValue("", "manager_id"));
    message.setTime_stamp(parser.getAttributeValue("", "time_stamp"));
    message.setWebsite_id(parser.getAttributeValue("", "website_id"));
    message.setVisitor_name(parser.getAttributeValue("", "visitor_name"));
    message.setEnd_time(parser.getAttributeValue("", "end_time"));

    // ----------------------------------------------------------------------------- 
```

然后我将消息类 toXML() 方法更新为此。

```
// ------------------------------CUSTOM TAGS-----------------------------

    if(getChat_id()!=null)
    {
        buf.append(" chat_id=\"").append(StringUtils.escapeForXML(getChat_id())).append("\"");

    }
    if(getCustom_packet()!=null)
    {
        buf.append(" custom_packet=\"").append(StringUtils.escapeForXML(getCustom_packet())).append("\"");

    }
    if(getUser_id()!=null)
    {
        buf.append(" user_id=\"").append(StringUtils.escapeForXML(getUser_id())).append("\"");

    }

    if(getManager_id()!=null)
    {
        buf.append(" manager_id=\"").append(StringUtils.escapeForXML(getManager_id())).append("\"");

    }
    if(getTime_stamp()!=null)
    {
        buf.append(" time_stamp=\"").append(StringUtils.escapeForXML(getTime_stamp())).append("\"");

    }
    if(getWebsite_id()!=null)
    {
        buf.append(" website_id=\"").append(StringUtils.escapeForXML(getWebsite_id())).append("\"");

    }
    if(getVisitor_name()!=null)
    {
        buf.append(" visitor_name=\"").append(StringUtils.escapeForXML(getVisitor_name())).append("\"");

    }
    if(getEnd_time()!=null)
    {
        buf.append(" end_time=\"").append(StringUtils.escapeForXML(getEnd_time())).append("\"");

    }

    //------------------------------------------------------------------------------------ 
```

这就是我能够在 MESSAGE TAG 中接收自定义属性的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-05T03:50:39.580

如果您可以添加使用 smack 中描述的自定义数据包扩展名，那么就这样做。如果您希望与不支持此类扩展的服务器或非 smack 客户端兼容，例如服务器不存储它，请使用

```
message.addBody("varName","varValue);

<message id='8dbda9a2-1f98-478f-9a65-635f181a6ddc' 
to='oGghwFpcrR@example.com/oGghwFpcrR' type='chat'><body>abcd</body>
<body xml:lang='varName'>varValue</body><thread>8b5342dcc</thread>        
</message>

message.getBody("varName"); 
```

不是一个理想的解决方案，但是谁使用多个语言来获取相同的消息呢？Smack*应该*允许您做的是注册您自己的消息解析以替换默认值，或者至少在默认值之外

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-08T04:53:56.237

我们遇到了同样的问题。这是一个通用的标签值解决方案：

在数据包类中，添加：

```
public static ArrayList<String> parseTags = new ArrayList<String>();
public HashMap<String, String> mTags ; 
```

构造函数：mTags = new HashMap(); 复制构造函数：mTags = p.mTags;

在 PacketParserUtils.ParseMessage() 中，添加

```
 if (message.mTags != null) {
        for (int i=0; i<Packet.parseTags.size(); i++) {
            String tag = Packet.parseTags.get(i);
            String value = parser.getAttributeValue("", tag);
            message.mTags.put(tag, value);
        }               
    } 
```

在 Message.toXML 中，在附加“>”之前，添加：

```
 if (mTags != null) {
        Iterator<Entry<String, String>> it = mTags.entrySet().iterator();
        while (it.hasNext()) {
            Entry pairs = (Map.Entry)it.next();
            String tag = (String) pairs.getKey();
            String value = (String) pairs.getValue(); 
            buf.append(" ").append(tag).append("=\"").append(value).append("\"");
        }               
    } 
```

* * *

然后，在应用程序中，在设置数据包处理程序之前，添加所有自定义标签，例如：

```
 Packet.parseTags.add(ROOMTYPE);
     Packet.parseTags.add(ROOMNAME);
     Packet.parseTags.add(CHATTYPE); 
```

同样在发送消息之前，添加以下内容：

```
 message.mTags.put(ROOMTYPE, "Private");
     message.mTags.put(ROOMNAME, UHInterface.liveSessionID);
     message.mTags.put(MSGTYPE, "Photo"); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2016-03-16T21:23:26.367

使用`Message.setProperty()`因为消息类扩展了 Packet。

在 Message 类中使用`method String toXML(), sb.append("<tag_x>").append(String.valueOf(super.getProperty("tag"))).append("</tag_x>");`

在项目调用中

```
Message.getProperty 
```

# php - 将多维数组从mysql层次结构表填充到php

> ID：12475123
> 
> 赞同：1
> 
> 时间：2012-09-18T10:27:03.550
> 
> 标签：php, mysql

我直接回答这个问题。

我有一张桌子，有 3 列：“id”、“name”和“parent”。每个 id 代表类别，而 parent 是引用子类别的 id。

我需要构建一个菜单，因此，一个无序列表和嵌套的无序列表。我得出的结论是，我必须将其转换为数组，是否有另一种仅使用 mysql 的方法？如果没有，你能告诉我在 php 中构建多维数组的技术吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T13:02:48.143

我想出了另一个不使用递归的代码：

```
<?php
//Let's say the DB returns:
$categories = array(
    array( 'id' => 1, 'name' => 'Category 1', 'parent' => null ),
    array( 'id' => 2, 'name' => 'Category 2', 'parent' => null ),
    array( 'id' => 3, 'name' => 'Category 3', 'parent' => 1 ),
    array( 'id' => 4, 'name' => 'Category 4', 'parent' => 3)
    );

$sortedCategories = assignChildren( $categories );

function assignChildren( &$categories )
{
    $sortedCategories = array();
    foreach( $categories as &$category )
    {
        if ( !isset( $category['children'] ) )
        {
            // set the children
            $category['children'] = array();
            foreach( $categories as &$subcategory )
            {
                if( $category['id'] == $subcategory['parent'] )
                {
                    $category['children'][] = &$subcategory;
                }
            }
        }

        if ( is_null( $category['parent'] ) )
        {
            $sortedCategories[] = &$category;
        }

    }

    return $sortedCategories;
}

var_dump( $sortedCategories ); 
```

输出：

```
array(2) {
  [0]=>
  &array(4) {
    ["id"]=>
    int(1)
    ["name"]=>
    string(10) "Category 1"
    ["parent"]=>
    NULL
    ["children"]=>
    array(1) {
      [0]=>
      &array(4) {
        ["id"]=>
        int(3)
        ["name"]=>
        string(10) "Category 3"
        ["parent"]=>
        int(1)
        ["children"]=>
        array(1) {
          [0]=>
          &array(4) {
            ["id"]=>
            int(4)
            ["name"]=>
            string(10) "Category 4"
            ["parent"]=>
            int(3)
            ["children"]=>
            array(0) {
            }
          }
        }
      }
    }
  }
  [1]=>
  &array(4) {
    ["id"]=>
    int(2)
    ["name"]=>
    string(10) "Category 2"
    ["parent"]=>
    NULL
    ["children"]=>
    array(0) {
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:33:53.533

一种方法是准备您的多维数组，如下所示......它可能不是完美的，但它对我来说效果很好......

```
$result_category = mysql_query('select all records query here ...');
    $categoryData = array(
    'items' => array(),
    'parents' => array()
);

while ($categoryItem = mysql_fetch_assoc($result_category))
{
    $categoryData['items'][$categoryItem['category_id']] = $categoryItem;
    $categoryData['parents'][$categoryItem['parent_id']][] = $categoryItem['category_id'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:34:30.723

您必须进行数据库调用以获取所有类别的列表。

然后，您必须使用递归函数为每个类别分配其子类别，并一次又一次地为每个子类别分配其子类别（感谢递归，这很“容易”）......

# javascript - 在 Google 地图上叠加 HTML

> ID：12475128
> 
> 赞同：6
> 
> 时间：2012-09-18T10:27:16.750
> 
> 标签：javascript, google-maps, google-maps-api-3

有没有办法使用 Google Maps API 在 Google Map 的顶部添加 HTML 内容？我想在其中添加一个`div`带有其他 HTML 内容的内容。

PS 不想操纵 Google 信息窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:31:01.660

你可以使用这个不错的库。

[http://blog.mridey.com/2011/05/label-overlay-example-for-google-maps.html](http://blog.mridey.com/2011/05/label-overlay-example-for-google-maps.html)

通过一些调整，它可以用来添加你想要的任何内容。

这就是您将其添加为覆盖而不是 InfoWindow 的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T14:54:25.800

我认为最简单快捷的方法是使用 InfoBox 库，它是 google-maps-utility-library-v3 的一部分

您可以在以下位置找到文档：

[http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/docs/](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/docs/)

以及以下示例：

[http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/examples/](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/examples/)

InfoBox 扩展了 Google Maps JavaScript API V3 OverlayView 类，允许您根据需要调整图层，而不必担心 InfoWindows 的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:31:26.367

是的，使用 infowindows 是可能的。

示例：[https ://developers.google.com/maps/documentation/javascript/overlays?hl=es#InfoWindows](https://developers.google.com/maps/documentation/javascript/overlays?hl=es#InfoWindows)

# jquery - jQuery Timepicker 重置

> ID：12475130
> 
> 赞同：2
> 
> 时间：2012-09-18T10:27:27.293
> 
> 标签：jquery, jquery-ui, time, datepicker

有人知道如何重置 jQuery Timepicker [http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)吗？在打开它之前，我需要将小时和分钟设置为 0。

我试图这样做，但它不起作用：

```
$('#timepicker').timepicker({
    hour:0, minute: 0}); 
```

我将绑定文本框的值设置为空，但如果我显示时间选择器，它仍然具有先前设置的值。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:33:40.483

通常日期选择器与文本框元素相关联。尝试修改该元素的值以使日期（通常是今天的日期）为 00:00。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:37:30.733

我认为您需要设置`alwaysSetTime`为false：

> alwaysSetTime - 默认值：true - 始终在内部设置时间，即使在用户选择之前也是如此。

来自：[http ://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-07T10:07:31.023

试试这个。

解决方案不够好（使用一些内部变量）。

虽然对我有用。

```
[tong@localhost javascripts]$ cat jquery-ui-timepicker-clear-button.js
(function($){
    var old_fn = $.datepicker._updateDatepicker;

    $.datepicker._updateDatepicker = function(inst) {
        old_fn.call(this, inst);

        var buttonPane = $(this).datepicker("widget").find(".ui-datepicker-buttonpane");

        $("<button type='button' class='ui-datepicker-clean ui-state-default ui-priority-primary ui-corner-all'>Clear</button>").appendTo(buttonPane).click(function(ev) {
            inst.input.val('');
            $(inst.settings.altField).val('');
        });
    }
})(jQuery); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-08T15:58:22.280

尝试设置`defaultValue`为`"00:00"`.

它对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-17T14:39:57.653

找到这个 $.datepicker._updateDatepicker = function(inst) addon.js 文件并添加这个代码来清除输入。

```
 var buttonPane = $(this).datepicker("widget").find(".ui-datepicker-buttonpane");

  $("<button type='button' class='ui-datepicker-clean ui-state-default ui-priority-primary ui-corner-all'>Clear</button>").appendTo(buttonPane).click(function(ev) {
                    inst.input.val('');
    }); 
```

# c++ - 无法创建窗口

> ID：12475131
> 
> 赞同：1
> 
> 时间：2012-09-18T10:27:33.777
> 
> 标签：c++, winapi

```
#include <Windows.h>
#include <stdlib.h>
#include <tchar.h>

#pragma comment(linker,"\"/manifestdependency:type='win32'name='Microsoft.Windows.Common-Controls'\
                version='6.0.0.0' processorArchitecture='*'\
                publicKeyToken='6595b64144ccf1df' language='*'\"")

LRESULT WINAPI WndProc(HWND hWnd,UINT msg,WPARAM lParam,LPARAM wParam)
{
    return DefWindowProc(hWnd,msg,wParam,lParam);
}

int WinMain(HINSTANCE hInst,HINSTANCE hpInst,LPSTR cmdLine,int cmdshow)
{
    static TCHAR classname[]=_T("SCONF");
    static TCHAR wTitle[]=_T("Server Configurator");

    WNDCLASSEX wClass;
    wClass.cbClsExtra=NULL;
    wClass.cbSize=sizeof(WNDCLASSEX);
    wClass.cbWndExtra=NULL;
    wClass.hbrBackground=(HBRUSH)(CTLCOLOR_SCROLLBAR);
    wClass.hCursor=LoadCursor(NULL,IDC_ARROW);
    wClass.hIcon=LoadIcon(hInst,IDI_APPLICATION);
    wClass.hIconSm=LoadIcon(hInst,IDI_APPLICATION);
    wClass.hInstance=hInst;
    wClass.lpfnWndProc=WndProc;
    wClass.lpszClassName=classname;
    wClass.lpszMenuName=NULL;
    wClass.style=CS_HREDRAW|CS_VREDRAW;
    if(!RegisterClassEx(&wClass))
    {
        MessageBox(NULL,L"Could not register class!", L"ERROR",MB_ICONERROR|MB_OK);
    }
    RECT wr={0,0,200,250};
    AdjustWindowRect(&wr,WS_CAPTION,false);

    HWND hWnd=CreateWindow(
        classname,
        wTitle,
        WS_CAPTION,
        GetSystemMetrics(SM_CXSCREEN)/2-100,
        GetSystemMetrics(SM_CYSCREEN)/2-125,
        wr.right-wr.left,//width
        wr.bottom-wr.top,//height
        NULL,
        NULL,
        hInst,
        NULL);

    if(!hWnd)
    {
        MessageBox(NULL,_T("Could not create window!"),_T("ERROR!"),MB_ICONERROR);
        return 1;
    }
    ShowWindow(hWnd,cmdshow);
    MSG msg;
    while(GetMessage(&msg,0,0,0))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
    return (int)msg.wParam;
} 
```

这是完整的代码，当我尝试编译时，hWnd 总是返回 false...我什至尝试从工作程序中复制代码但它没有工作...这是怎么回事？之前一直有效...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:32:11.570

你在 WndProc 函数中扭曲/交叉你的 wParam 和 lParam -

```
LRESULT WINAPI WndProc(HWND hWnd,UINT msg,WPARAM lParam,LPARAM wParam) 
{
    return DefWindowProc(hWnd,msg,wParam,lParam);
}

LRESULT WINAPI WndProc(HWND hWnd,UINT msg,WPARAM lParam,LPARAM wParam) {
    return DefWindowProc(hWnd,msg,wParam,lParam);
} 
```

我认为这没有帮助。

```
LRESULT WINAPI WndProc(HWND hWnd,UINT msg,WPARAM lParam,LPARAM wParam) //check your parameter names!!!!!!!!!!!!!!!!!!!!!!!
{
    return DefWindowProc(hWnd,msg,wParam,lParam);
} 
```

# c++ - 有没有办法获取使用 Qt 的进程的所有打开文件的列表？

> ID：12475132
> 
> 赞同：2
> 
> 时间：2012-09-18T10:27:36.827
> 
> 标签：c++, qt

我们的应用程序是跨平台的，因此是用 Qt 编写的。目标平台是 Windows 和 Mac。在我们的项目中，我们需要确定一个单独进程的所有打开文件的列表。现在我们使用 WinAPI 和相应的 Mac OsX API 以依赖于平台的方式来完成它。只要我们需要维护两个不相关的程序版本，这种做法就已经造成了很多问题。

如果有任何帮助，我们需要为 Traktor 和 Serato（Dj Intro 和 Scratch Live）等程序确定打开的音频文件列表。而我们使用的Qt版本是4.8.0。

那么，问题是，是否有任何独立于平台的方法来获取打开的文件列表？或者至少是使用某些第三方库或实用程序的某种解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:24:52.847

甚至 Qt 也不是独立于平台的 ;) 它只是将平台细节（如 WIN32 API 与 X11 API）封装在一个通用 API 下。在您的情况下，我也会这样做：设计一个（基于 Qt 的）类，它提供您在应用程序中需要的 API，然后使用您已经存在的（特定于平台的）代码来提供您需要的功能。在您的应用程序中，您将只使用基于 Qt 的 API，您无需担心应用程序代码中的平台细节。此外，您可以针对您的 API 编写任意数量的单元测试，以确保其行为正确。

示例（不是 100% 完整的代码！）：

在你的头文件中：

```
class QMySpecificAPI : public QObject {
    Q_OBJECT    // only required when you need signals/slots

public:
    QList<QString> getOpenFiles();
} 
```

在您的 cpp 文件中：

```
#include "QMySpecificAPI.h"

#ifdef Q_WS_WIN
QList<QString> QMySpecificAPI::getOpenFiles() {
   // Use WIN32 API to retrieve the file list
}
#endif

#ifdef Q_WS_MAC
QList<QString> QMySpecificAPI::getOpenFiles() {
    // Use MACOSX API to retrieve the file list
}
#endif 
```

特别是你说你现有的代码已经有很多问题了，我强烈建议你实现单元测试用例并让它们定期运行以自动检查你的代码，比如

```
...
QMySpecificAPI api;
QList<QString> fileList = api.getOpenFiles();
ASSERT(fileList.count() == 5);   // or whatever you expect
... 
```

# c# - 使用 C# 在 Visual Studio 中开发 Android 应用程序

> ID：12475136
> 
> 赞同：0
> 
> 时间：2012-09-18T10:27:58.003
> 
> 标签：c#, android, visual-studio

> **可能重复：**
> [如何使用 MS Visual Studio 进行 Android 开发？](https://stackoverflow.com/questions/1371939/how-can-i-use-ms-visual-studio-for-android-development)

可以使用 C# 在 Visual Studio 中开始开发 Android 应用程序。

如果是，任何人都可以建议我可以开始开发的良好链接。

如果否，应该是什么替代解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:33:38.043

我猜带有 Eclipse 的 Android sdk 可能是一个更好的组合。C# 和 Visual Studio 更适合 Windows 手机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:33:56.363

像这样：[http](http://www.brutaldev.com/post/2011/01/15/Android-applications-in-C-using-Visual-Studio.aspx) ://www.brutaldev.com/post/2011/01/15/Android-applications-in-C-using-Visual-Studio.aspx 有帮助吗？

Android 开发倾向于使用 Java（这与 C# 并不完全不同）使用 Android SDK，许多人使用 Eclipse 作为带有 ADT 插件的 IDE。我看不出有什么理由不使用该链接所说的 C#，但我想一个直接的、本机的 Java 版本会更可取吗？

[http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)

# c# - 动态 GroupBy Linq to SQL

> ID：12475137
> 
> 赞同：0
> 
> 时间：2012-09-18T10:28:06.163
> 
> 标签：c#, asp.net, linq-to-sql, telerik

我通过按列名对数据库中的数据进行分组来填充大约 10 个组合框。所以组合框可以用来过滤内容。

这是我的功能

```
private void SetFilterDataSource(RadComboBox comboBox, string columnName)
{
    var query = (from p in productContext.Products
                       where p.ProductRange != ""
                        group p by p.ProductRange into pGroup
                       select new
                       {
                           ProductRange = pGroup.Key
                       });

    comboBox.DataSource = query;
    comboBox.DataBind();
} 
```

目前，这将对每个组合框重复 10 次。所以我想知道是否有一种方法可以根据传递给它的字符串进行动态处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:42:17.207

您可以编写扩展并创建静态方法，该方法通过使用 lambda 表达式对列名和值的许多查询来创建动态组。

请参阅以下链接

[http://blogs.msdn.com/b/mitsu/archive/2008/02/07/linq-groupbymany-dynamically.aspx](http://blogs.msdn.com/b/mitsu/archive/2008/02/07/linq-groupbymany-dynamically.aspx)

# cakephp - 用于订单和分页的 cakephp 路由

> ID：12475138
> 
> 赞同：1
> 
> 时间：2012-09-18T10:28:07.153
> 
> 标签：cakephp, sorting, routing

我正在尝试在 CakePHP 中为我的控制器进行路由。

我的控制器叫做 UserGames。默认 CakePHP 排序代码：

```
<?php echo $this->Paginator->sort('price'); ?> 
```

默认情况下，排序链接如下所示：`userGames/index/sort:name/direction:asc`

我添加了以下路由规则：

```
Router::connect('/games', array('controller' => 'UserGames', 'action' => 'index'));
Router::connect('/games/:sort/:direction', array('controller' => 'UserGames')); 
```

使用这些排序链接会生成如下 URL：`games/name/asc`

以这种方式排序不起作用，并且 $this->PassedArgs 为空。我的错误可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T18:49:50.933

如果您希望命名参数可用作passedArgs 中的传递参数，您需要为您的第二个Router::connect 调用提供第三个参数。

```
Router::connect('/games/:sort/:direction',
    array('controller' => 'UserGames'),
    array('pass' => array('sort', 'direction'))); 
```

在这种情况下，`$this->passedArgs[0]`将是排序值和`$this->passedArgs[1]`方向值。

有关更多信息，请参阅[CakePHP 文档](http://book.cakephp.org/2.0/en/development/routing.html#Router%3a%3aconnect)。

# c# - “类”不包含“方法”的定义

> ID：12475142
> 
> 赞同：19
> 
> 时间：2012-09-18T10:28:23.030
> 
> 标签：c#, asp.net, methods

在课堂`Employee`上，我有一些方法，效果很好。现在我想添加新方法，例如

```
public void ExampleMethod()
{         
} 
```

然后我叫它

```
Employee employee = new Employee();
employee.ExampleMethod(); 
```

ExampleMethod 出现在点后显示的 IntelliSense 中，当我按 F12 时，它也会将我重定向到该方法，但是在启动项目时出现错误：'Employee' does not contain a definition for 'ExampleMethod' and no extension method'ExampleMethod ' 可以找到接受“Employee”类型的第一个参数（您是否缺少 using 指令或程序集引用？）

我不知道为什么会导致此错误，因为所有其他早期方法都可以正常工作。有什么问题？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-18T10:31:25.693

有三种可能：

1）如果您指的是旧的DLL，那么它就不能使用。所以你有参考新的DLL

2）如果您在不同的命名空间中使用它并尝试使用其他命名空间的 dll，那么它不会引用此方法。

3）您可能需要重建项目

我认为第三种选择可能是你的原因。请发布更多信息以了解您的确切问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-18T10:31:58.533

使用命名空间名称创建类可能会解决您的问题

```
namespace.Employee employee = new namespace.Employee(); 
employee.ExampleMethod(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-21T12:47:07.093

我有同样的问题。原来我引用的项目没有得到构建。当我去 Visual Studio 中的构建配置管理器并启用参考项目时，问题得到了解决。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-25T10:09:47.937

如果您正在使用来自另一个项目的类，则该项目需要重新构建并重新创建 dll。确保在**Visual Studio的****Build -> Configuration Manager**上检查了该项目的“构建” 。因此参考项目将重新构建和更新 dll。

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-04T16:48:19.077

我有同样的问题。`AssemblyInfo.cs`我在属性文件夹中更改了程序集的版本。但是，我不知道为什么会出现这个问题。可能编译器不明白这`dll`是较新的，只是更改了Assembly的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-15T18:13:19.027

我刚刚遇到了这个问题；这个问题似乎与此处发布的其他答案不同，所以我会提到它以防它对某人有所帮助。

就我而言，我在一个程序集（“A”）中定义了一个内部基类，在第二个程序集（“B”）中定义了一个内部派生类，以及一个测试程序集（“TEST”）。我使用 将程序集“B”中定义的内部组件暴露给“TEST” `InternalsVisibleToAttribute`，但忽略了对程序集“A”这样做。这产生了上面提到的错误，没有进一步说明问题；使用`InternalsVisibleToAttribute`将程序集“A”暴露给“TEST”解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-27T10:08:25.003

在使用共享代码的多个项目的解决方案中工作时，我遇到了同样的问题。原来我忘了更新第二个项目文件夹中的DLL。

我的建议是仔细查看错误列表窗口中的“项目”列，并确保该项目也使用正确的 DLL。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-07T20:41:17.563

今天我遇到了与您描述的完全相同的症状的问题。我关闭了所有文件并重新启动了 VS，却发现某些文件从解决方案资源管理器中*消失*了。

以下解决了我的问题：通过在解决方案资源管理器中选择当前项目，`Show all files`顶部栏上会出现一个小图标。右键单击文件并选择`Include In Project`即可。

[信用](https://social.msdn.microsoft.com/Forums/en-US/82d5ef6e-c64c-445b-9f46-f648ff3ce6aa/file-missing-from-solution-explorer?forum=tfsversioncontrol)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-09-25T08:54:07.443

我遇到了同样的问题，“重建解决方案”然后“清洁解决方案”不起作用。我通过检查我的 DLL 引用解决了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-16T10:39:46.500

当我遇到同样的错误时，

```
dotnet restore 
```

解决了。从[文档](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-restore)：

> `dotnet restore`- 恢复项目的依赖关系和工具。**

# php - PHP：包含在单独的全局范围内

> ID：12475144
> 
> 赞同：0
> 
> 时间：2012-09-18T10:28:31.627
> 
> 标签：php, scope, global

我想合并两个 php 项目。这两个项目都使用全局变量，所以我希望有单独的全局范围。

例子：

文件 project1.php：

```
$var1 = 'var1';

function print1() {
  global $var1;
  echo $var1;
}

print1(); 
```

文件 project2.php：

```
function load1() {
  include('project1.php');
}

$var2 = 'var2';

function print2() {
  global $var2;
  echo $var2;
}

print2();
load1(); 
```

这将按预期执行 project2，但 project1 会失败，因为 $var1 不在全局范围内，而是在 load1() 的范围内。

一种可能的解决方法是调用`global $var1`load1() ，但这会混合两个全局范围（混乱）并且会很复杂，因为 reallive project2 有许多全局变量，我必须检查每次更新是否有任何新变量。

因此，如果我可以为 project1 创建一个单独的全局范围，那将是最好的。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:47:45.833

如果您真的必须将您的包含包装在一个函数中，请查看[PHP Namespaces](http://php.net/manual/en/language.namespaces.php)。

项目2.php：

```
namespace project2 {
    $var2 = 'var2';

    function print2() {
        global $var2;
        echo $var2;
    }

    print2();
}

namespace project1 {
    function load1() {
        global $var1;
        include('project1.php');
    }
    load1();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:50:04.647

不可能有单独的 GLOBAL 上下文。全局上下文的全局的唯一目的是无论发生什么都是“全局的”。

为了解决这个问题，您应该“上下文化”您的代码，将全局变量重构为函数参数：

```
function print2() {
  global $var2;
  echo $var2;
} 
```

变成：

```
function print2($var2) {
  echo $var2;
} 
```

# java - 在模块化 Spring 应用程序中支持 i18n 的最佳解决方案是什么？

> ID：12475145
> 
> 赞同：2
> 
> 时间：2012-09-18T10:28:33.393
> 
> 标签：java, spring, internationalization, intellij-idea

我正在开发模块化 Spring 应用程序。它有几个模块。其中之一有两个子模块：`web`和`jar`. 这些模块具有分离的消息属性基本名称。

第一个声明了带有 id 的 bean `messageSource`。我知道在应用程序中只能存在一个带有 messageSource id 的 bean。第二个有另一个名称的bean（类似于`messageSource`）并声明了自己的扩展类`ReloadableResourceBundleMessageSource`。

我在这里读过：http: [//blog.synyx.de/2010/04/modular-web-applications-based-on-spring/](http://blog.synyx.de/2010/04/modular-web-applications-based-on-spring/)关于一种解决方案。这里[https://github.com/synyx/messagesource](https://github.com/synyx/messagesource)是在数据库中存储消息的解决方案。

我想知道：在模块化 Spring 应用程序中支持 i18n 的最佳解决方案是什么？我想要一个包含消息属性文件的目录。不是每个模块的单独目录。我可以配置 Spring 以通过模块访问消息吗？

我正在使用 IntelliJ IDEA 来处理应用程序模块。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-18T12:00:04.700

根据我的说法，您的应用程序中不需要两个单独的属性文件。您可以为属性文件创建一个目录，并且可以在所有模块中使用该目录。只需将所有属性文件放在资源文件夹或 i18n 下的 web 中，无论您想要什么。然后在你的 xml 中为 messageSource 创建一个 bean。

现在，您可以使用 @Component 注释在 jar 模块中定义您的类，并且在那里您可以拥有一个 ReloadableResourceBundleMessageSource 类型的 @Autowired 字段。

我认为这将解决您的查询。干杯。

# javascript - NodeJS Socket.IO 不会将数组传递给客户端

> ID：12475149
> 
> 赞同：3
> 
> 时间：2012-09-18T10:28:51.297
> 
> 标签：javascript, jquery, node.js, socket.io

我遇到了 socket.emit 不会发送数组的问题。

当客户收到它时，它只是完全空的。

服务器端：

```
var connectedUserNames = new Array() ;
socket.on('USER_ONLINE', function(data){
    connectedUserNames[socket.id] = data ;
    console.log(data+' has connected.') ;
})
io.sockets.emit('CONNECTED_USERS', connectedUserNames); 
```

客户端：

```
socket.on('CONNECTED_USERS', function(data){alert(data);
    $('#connectedusers').attr('title', data) ;
}) 
```

这是 NodeJS 的错误吗？如果是这样，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T10:33:38.057

你的订单似乎很不合适。`CONNECTED_USERS`您在事件之外的某个地方发出`USER_ONLINE`，所以它很可能没有填充数据。顺便说一句，您声明了 an`Array`但您像访问普通对象一样访问它。如果你不需要索引数组，你应该只创建一个普通的`Object`

```
var connectedUserNames = {}; 
```

或 use `Array.prototype.push`，那里更方便

```
connectedUserNames.push( data ); 
```

试着拉这条线

```
io.sockets.emit('CONNECTED_USERS', connectedUserNames); 
```

进入您的`USER_ONLINE`事件，然后确保您的客户端实际上在某个时候触发了该事件，以便您的服务器可以对此做出反应。

# javascript - 我正在尝试编写 JavaScript 代码以在 LoadRunner 上进行测试。我想在日历弹出窗口中选择特定日期

> ID：12475151
> 
> 赞同：0
> 
> 时间：2012-09-18T10:29:01.750
> 
> 标签：javascript

我正在尝试为 loadRunner 编写 JavaScript 代码来测试包含日期文本框字段的应用程序。

我想知道一个 JavaScript，用户可以在其中单击日历弹出窗口中的特定日期，例如 25。

默认情况下，文本框是空的，用户需要点击文本框/日历图标，显示日历弹出。在应用程序中，日历弹出窗口是一个标签，日历中`table`的`id`每一行都包含在一个`td`标签中，根据 HTML 代码。文本框不接受任何字符，唯一的选项是从日历中选择。

我可以使用代码查看表格

```
var table=document.getElementById("tableid"); 
```

在这之后写什么到如何选择一个特定的网格单元。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:58:38.037

对我来说，使用 jQuery 进行 DOM 操作要方便得多，但如果你坚持纯 JS，你可以这样做：

```
document.getElementById('tableid').getElementsByTagName('td')[4].click() 
```

`.getElementsByTagName('td')`返回表中所有 td 的 HTML 集合（数组），因此您可以通过方括号表示法访问它们中的每一个，指定相关 td 的索引（在我的示例中为 4）。然后你只需`click`在它上面触发事件

# php - PHP 中 PEAR 的用途

> ID：12475152
> 
> 赞同：2
> 
> 时间：2012-09-18T10:29:10.023
> 
> 标签：php

自上周以来，我才刚刚开始进行 PHP 开发。我已经在我的电脑上安装了 XAMPP。我只想知道几个问题：

1.  PHP 文件夹内的 PEAR 文件夹的用途是什么？
2.  如何在 PHP 中实现多态性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:32:35.033

> PEAR 包作为 gzip 压缩的 tar 文件分发。每个档案都包含用 PHP 编写的源代码，通常采用面向对象的风格。通过 PHP 中的简单包含语句，开发人员可以轻松地将许多 PEAR 包用作普通的第三方代码。更优雅的是，可以使用 PHP 默认自带的 PEAR 包管理器来安装 PEAR 包，这样包提供的额外功能就会作为 PHP 安装的一个集成部分出现。与 PEAR 将其作为模型的综合 Perl 归档网络 (CPAN) 归档不同，PEAR 包没有隐式依赖关系，因此包在 PEAR 包树中的位置与代码依赖关系无关。相反，PEAR 包必须显式声明对其他 PEAR 包的所有依赖项。
> 
> PEAR 基类包含用于模拟面向对象的析构函数和一致的错误处理的代码。存在许多基本 PHP 功能的包，包括身份验证、缓存、数据库访问、加密、配置、HTML、Web 服务和 XML。

[http://en.wikipedia.org/wiki/PEAR](http://en.wikipedia.org/wiki/PEAR)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:45:02.903

要在 PHP 中实现多态，可以使用接口和抽象类。

```
interface Shape{
   public function getArea();
}

class Circle implements Shape{
 ... 
}

abstract class Polygon implements Shape{
   ...
}

class Square extends Polygon{
  ...
} 
```

事实上，PHP 中的类型检查并不严格。而且你不需要为你的变量声明一个类型。然后可以在任何对象上调用任何函数（尽管很容易出错且不优雅）。在前面的示例中，您可以在任何“Square”或“Circle”实例上调用“getArea”，即使这些类没有实现 Shape 接口。

编辑：从 PHP 5.4 开始，您还可以将[特征](http://www.php.net/manual/en/language.oop5.traits.php)用于多态性。

# html - 使文本适合 div。Django 模板

> ID：12475155
> 
> 赞同：0
> 
> 时间：2012-09-18T10:29:20.023
> 
> 标签：html, css, django, templates

我需要将文本放入模板中的 div 中。

我现在有：

```
<td>
<div id="beruf" style="width:490px">
    {{profil.beruf|safe}}
</div>
</td> 
```

但是文本显示“到最后”而不考虑 div 的宽度。

有任何想法吗？

谢谢 ;）

- - 更多信息。这就是我得到的：

![在此处输入图像描述](../Images/41fa1732c1333d4bd36bea4de7048258.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:40:46.360

也许某些 CSS 打破了自动换行？检查这个： [http ://www.w3schools.com/cssref/pr_text_white-space.asp](http://www.w3schools.com/cssref/pr_text_white-space.asp)

# tridion - 如何使用核心服务检查字段是否允许多个值

> ID：12475156
> 
> 赞同：1
> 
> 时间：2012-09-18T10:29:20.430
> 
> 标签：tridion, tridion-2011

使用核心服务我们如何检查一个字段是否允许多个值，下面是我用来获取字段类型的代码：-

```
SchemaFieldsData fields = client.ReadSchemaFields(schemaTCMURI, true, new ReadOptions());

                foreach (var field in fields.MetadataFields)
                {
                    if (field is SingleLineTextFieldDefinitionData)
                    {
                        // some code
                    }
                    else if (field is MultiLineTextFieldDefinitionData)
                    {
                // this will check only if field is multiline not multi valued                        } 
```

}

请建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:18:15.490

您需要检查`MinOccurs`和`MaxOccurs`属性。如果`MinOccurs`为 0，则该字段是可选的，否则它是强制性的。如果`MaxOccurs`为 1，则该字段为单值。否则它是多值的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T11:17:37.070

根据核心服务文档，您可以检查字段。最大发生次数

*   MaxOccurs == 1 表示单值字段

*   MaxOccurs == - 1 表示值字段

# git - git 相当于 svnversion

> ID：12475157
> 
> 赞同：7
> 
> 时间：2012-09-18T10:29:22.877
> 
> 标签：git, svn, version-control

> **可能重复：**
> [版本号的 git 等效项是什么？](https://stackoverflow.com/questions/4120001/what-is-the-git-equivalent-for-revision-number)

我现在一直在使用颠覆，并想切换到 git。阅读手册后，我只有一个保留，我使用 svnversion 获得一个参考编号，即：唯一的、短的、相对于时间单调的（总是增加）。

*   它必须是唯一的，所以我可以用它来复制文章。
*   它必须简短，以便可读，可用于文件名、页脚、版本号显示。
*   它只能增加（相对于时间单调），因此任何人都可以比较两篇文章的年龄，而无需知道年龄（日期）。

约束：如果我们可以得到一个分支 ID，则只需要满足同一分支上的文章的上述要求。（分支 ID 可以是任何可以比较身份的东西，“这是发布分支吗？”。

[文章一词在此用于表示计算机程序、文档或从修订控制系统的内容生成的其他内容。]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T10:40:16.597

正如 fork0 所说，非线性历史没有这样的等价物，您无论如何都可以执行此操作以获取当前分支的提交数：

```
git log --oneline | wc -l 
```

这是我的一个队友用来生成要在构建脚本中使用的构建号的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T10:34:24.593

不，非线性历史没有这样的东西。但是您可能会看到`git describe`，它的输出将至少满足前两个标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T11:36:52.190

内部版本号的重点是简化获取给定版本的源代码的过程。您可以使用`git show -s --pretty=format:%h`获取唯一标识版本的 sha1 编号，以便任何开发人员都可以在他的存储库中签出它。

但是，sha1 不是增量数字，在大多数情况下，即使使用其他 VCS 也是不可能的。如果您希望拥有它，那么最好引入一个持续集成系统（例如 Jenkins），它将增量编号并为这些编号创建标签。在这种情况下，它会增长得更温和，因为 CI 通常不会构建每个提交。

此外，提到`git describe`的在生成良好的版本名称方面做得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T23:08:55.427

[Smudge|clean 过滤器](https://softwareengineering.stackexchange.com/a/142001/36934)将允许您构建**任何**ID，YYYYMMDD-N（其中 N 是*该日期的提交计数器*）可能是不错的选择

# php - Ajax 和 PHP 请求页面并动态显示

> ID：12475158
> 
> 赞同：1
> 
> 时间：2012-09-18T10:29:35.880
> 
> 标签：php, javascript, ajax

我有一个 Ajax 文件，我正试图与一个 PHP 文件进行通信，该文件将提供 Google 主页，并将其放入我在同一页面的某些 HTML 中的 DIV 中。

我已经彻底检查了代码和 PHP 文件，没有发现任何错误，但我不明白为什么什么都没发生。有人可以帮帮我吗？。提前致谢。

这是我的ajax

```
<html>
  <head>
    <title>Ajax page</title>
  </head>
    <body> 

<h1>AJAX page</h1>
  <div id="info">
    This content will be changed by default....
  </div>

<script type="text/javascript">

params = "url=google.com";
request = new ajaxRequest();
request.open("POST", "ajaxLab.php", true);

request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
request.setRequestHeader("Content-length", params.length);
request.setRequestHeader("Connection", "close");

request.onreadystatechange = function(){
  if(this.readystate==4){
    if(this.status==200){
      if(this.responseText != null) document.getElementById("info").innerHTML=this.responseText;
      else alert("Ajax error: No data received ");
    }
    else alert("Ajax error: " + this.statusText);
  }
}
request.send(params);

function ajaxRequest()
{
  try
  {
  var request = new XMLHttpRequest();
  }
  catch(e1)
  {
    try
    {
    request = new ActiveXObject("Msxml2.XMLHTTP");
    }
    catch(e2)
    {
      try
      {
      request = new ActiveXObject("Microsoft.XMLHTTP");
      }
      catch(e3)
      {
      request=false;
      }
    }
  }
return request; 
} 

</script>

  </body>
</html> 
```

这是我的简单php文件..

```
<?php

if(isset($_POST['url'])){
echo file_get_contents("http://".sanitiseVar($_POST['url']));
}

function sanitiseVar($var){
    $var = htmlentities($var);
    $var = stripslashes($var);
    return strip_tags($var);
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:55:04.353

好的，readyState 属性没有颠簸。在我纠正之后工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:42:39.717

用这个：

```
$(document).ready(function(){
    $.post("ajaxLab.php",
           {
                url:"google.com",
                // another_param : "its value"
           },
           function(result){ // Callback function, on success
             if(result != null)
                 $('#info').html(result);
             else
                alert("Ajax error: No data received ");
          }
    );    
}); 
```

请记住在标题中包含 jQuery 库：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:37:58.973

以这种方式更改整个文件：

```
<html>
    <head>
        <title>Ajax page</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                $("#info").load("ajaxLab.php", {'url': 'google.com'});
            });
        </script>
    </head>
    <body> 
        <h1>AJAX page</h1>
        <div id="info">
            This content will be changed by default....
        </div>
    </body>
</html> 
```

# cordova - 仅使用 phonegap 推送通知，不使用任何 .java 文件

> ID：12475159
> 
> 赞同：1
> 
> 时间：2012-09-18T10:29:44.720
> 
> 标签：cordova, push-notification

我正在使用 phonegap 应用程序并尝试发送推送通知。我在网上找到了很多示例，但问题是我只使用 phonegap 意味着只有 .html 、 .js 、 .css 文件所以任何人都可以告诉我该怎么做那？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:30:01.043

您可以使用 Pushwoosh 轻松地将推送通知集成到您的 PhoneGap 应用程序中。查看集成指南：

[http://www.pushwoosh.com/programming-push-notification/push-notification-sdk-integration-for-phonegap/](http://www.pushwoosh.com/programming-push-notification/push-notification-sdk-integration-for-phonegap/)

插件本身在 GitHub 上，集成非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T19:00:41.287

此示例讨论如何在 Android 上使用 pushwoosh 实现推送：[http](http://www.pushwoosh.com/programming-push-notification/android-gcm-push-notifications-guide/) ://www.pushwoosh.com/programming-push-notification/android-gcm-push-notifications-guide/ 如果您没有 AndroidManifest.xml 文件，您没有开发 Phonegap Android 应用程序。

# php - 如何从一个表中选择数据，其中该表中的列值与另一表的连接列值匹配？

> ID：12475161
> 
> 赞同：2
> 
> 时间：2012-09-18T10:29:57.370
> 
> 标签：php, mysql, sql, database-design

表客户

```
id     fName        lName      pNumber
 1     Adeline      Brown      55512300
 2     May          Green      55512094 
```

表会计

```
id     customerName       datePaid        amount
1      Brown, Adeline     2012-08-09      210
2      Green, May         2012-09-09      430 
```

我的问题是如何`pNumber`根据`datePaid`对应的来选择`customerName`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T10:32:54.030

您应该`customerName`从 Accounting 表中删除 ，并将其替换为`CustomerId`。但是，就目前而言，您可以`JOIN`使用任何谓词作为`JOIN`条件的两个表，如下所示：

```
SELECT c.pNumber
FROM Customers c
INNER JOIN accounting ac ON c.fName + ', ' + p.lName = ac.customerName 
```

您的表`Accouting`结构的问题在于，它*没有被* [**规范化**](http://en.wikipedia.org/wiki/Database_normalization)，尤其是不符合第三范式***3NF***，即：

> **3NF：**消除不依赖于键的列

表中的列不依赖于该`customerName`表的记帐。因此，您的表格应如下所示：`Accounting``id`

**客户**表：

*   `id`, `fName`, `lName`, `pNumber`.

**会计**表：

*   `id`,`customerId`外键引用`Customers(Id)`, `datePaid`, `amount`.

然后您可以`JOIN`直接使用这两个表，`ON customerId`这将大大提高性能：

```
SELECT c.pNumber
FROM Customers c
INNER JOIN accounting ac ON c.Id = ac.CustomerId 
```

**编辑：**您的查询没有错。可能是您没有任何符合此条件的行。您可以尝试以下查询，它与您编写的内容相同，但更有条理：

```
SELECT c.pNumber 
FROM customers c 
INNER JOIN
(
    SELECT DISTINCT id, customerName, datePaid, amount
        TO_DAYS(DATE(datePaid)) - TO_DAYS(CURDATE()) AS DaysFromPayment
    FROM Accounting 
) ac ON c.last_name + ', ' + c.first_name = ac.customerName 
WHERE ac.DaysFromPayment = 30 
```

# android - 以特定格式显示记录

> ID：12475163
> 
> 赞同：0
> 
> 时间：2012-09-18T10:30:07.500
> 
> 标签：android

朋友我有一个列表视图。我需要以这种特殊方式显示。![在此处输入图像描述](../Images/39a151fb6734abc808caad58a082cb0f.png)

```
14 May 2012 15:34   Arrival     X
16 May 2012 20:00   Departure   X
24 Aug 2012 20:00   Arrival     X 
```

请建议我更改相同的代码。还可以在此处找到附加的 xml 代码。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_toLeftOf="@+id/imageView1"
        android:orientation="vertical"
        android:paddingLeft="10dp" >

        <TextView
            android:id="@+id/title"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Title"
            android:textColor="#000000"
            android:textSize="16sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/detail"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Detail"
            android:textColor="#000000" />

        <TextView
            android:id="@+id/data"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Data"
            android:textColor="#000000" />
    </LinearLayout>

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="70dp"
        android:layout_height="70dp"
        android:layout_alignParentRight="true"
        android:background="@drawable/error"
        android:scaleType="centerCrop" />

</RelativeLayout> 
```

我尝试在特定的 textview 上设置它，但对齐方式各不相同，当我在设备之间检查它时，应用程序看起来很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:49:17.563

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_toLeftOf="@+id/imageView1"
    android:paddingLeft="10dp" android:orientation="horizontal">

    <TextView
        android:id="@+id/title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Title"
        android:textSize="16sp"
        android:textStyle="bold" android:textColor="#ffffffff" android:layout_weight="1"/>

    <TextView
        android:id="@+id/detail"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Detail" android:textColor="#ffffffff" android:layout_weight="1" />

    <TextView
        android:id="@+id/data"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Data" android:textColor="#ffffffff" android:layout_weight="1" />
</LinearLayout>

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="70dp"
    android:layout_height="70dp"
    android:layout_alignParentRight="true"
    android:background="@drawable/icon"
    android:scaleType="centerCrop" />

</RelativeLayout> 
```

# ios - 当前位置雷达类型动画 - xcode

> ID：12475165
> 
> 赞同：4
> 
> 时间：2012-09-18T10:30:16.783
> 
> 标签：ios, xcode, animation, location

如何在 xcode 中围绕用户当前位置制作雷达类型动画？我需要制作在用户周围循环的那条线，留下痕迹。先感谢您

# android - Android 库项目中的资源 ID

> ID：12475166
> 
> 赞同：5
> 
> 时间：2012-09-18T10:30:19.510
> 
> 标签：android, open-source, shared-libraries

我想在我的中包含一个开源项目。但是在检查“is library”选项后，无法编译诸如“case R.id.menu_search:”之类的东西。我应该用它的常量值替换它们，还是如何包含它？

```
 case R.id.menu_search: // ! case expressions must be constant expressions
        onSearchRequested();
        return true; ... 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T12:06:39.887

正如其他人所指出的，您需要将您的`switch()`语句更改为`if()`//语句`else if()`。不是常数 ( )，不能在语句中使用。那是因为它来自您的 Android 库项目。*是*一个常数，因为它是操作系统的一部分并且不会改变。`else``R.id.menu_search``static final``case``R.id.menu_search``android.R.id.home`

# c - 生成具有重复的集合元素的k组合的算法？

> ID：12475167
> 
> 赞同：4
> 
> 时间：2012-09-18T10:30:20.583
> 
> 标签：c, algorithm, combinations

我正在寻找一种算法，该算法将一组两个元素作为输入`T = {0, 1}`，`k`并生成如下`k`的所有组合：`T`

```
000
001
010
011
100
101
110
111 
```

像上面的例子一样，当`k`很小时迭代实现很简单。`k=3`任何想法如何设计递归算法以使算法独立于`k`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T10:38:04.003

您可以递归地执行此操作。假设这是一个学习练习，我会给你伪代码而不是 C 程序：

```
generate (int pos, int element[T], int current[N])
    if pos == N
        print (current)
        return

    for i : 0..T
        current[pos] = element[i]
        generate(pos+1, element, current)

end 
```

前三行是基本情况。`pos`从零开始，并指示`current`数组中需要由递归调用的当前级别填充的位置。一旦`pos`达到`N`，我们打印当前组合并返回到之前的级别。

下面三行是一个循环，类似于问题 when 的解决方案中的嵌套循环`k=3`。“嵌套”通过递归动态发生：您可以将递归调用的下一级视为另一级“循环嵌套”。本质上，递归解决方案允许您构建`N`嵌套循环，其中`N`只有在运行时才知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:59:26.203

如果您在设计时知道 k，则很容易使用 k 循环生成所有 k 组合，即如果您想要所有 4 组合，则可以使用 4 循环来完成：

```
for c1=0 to 1
  for c2=0 to 1
    for c3=0 to 1
      for c4=0 to 1
        print c1,c2,c3,c4 
```

如果您在设计时不知道 k，您将需要一种模拟 k 循环的方法。这很简单，创建一个大小为 k 的数组并在索引 i 处存储 ci 的当前值（循环编号 i 索引）。

```
c : array[1..k]
fill(c,0) // initialize all the cells with 0
do 
  for i=1 to k
    print c[i]
while increment(c) // get next values 
```

`increment`如果所有值都已使用，则获取下一个值并返回 false，否则返回 true。

```
increment(c : array[1..k])
begin
  i=k
  do
    c[i]=c[i]+1;
    if c[i]=2 // i.e. MAX+1
      c[i]=0
      i=i-1 // incerment previous position
    else
      return true // increment done
    end if
  while (i>1)

  // here we need to increment the first position
  c[i]=c[i]+1
  if c[i]=2 // we looped thru all the values
    c[i]=0
    return false
  end if
  return true
end 
```

这种方法可以推广到任何*基数*的任何循环（=每个循环的不同最大值）或具有不同的起始值、步骤等......这个方法也可以推广到生成具有重复等的字典组合...... google for里程表或查看 TAOCP Knuth 第 3 卷分册 2 和 3。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T10:43:21.113

您不需要递归算法。如果您查看您的列表，您应该会看到“模式”。

那是从 0 到 2^k-1 的二进制数。因此，简单的解决方案就是数数。

```
for (i = 0; i < (1<<k); i++) {
    // generate the binary representation of i
    for (c = k-1 ; c >= 0; c--) {
       r = i >> c;
       printf((r & 1) ? "1" : "0");
    }
    printf("\n");
} 
```

**编辑：**如果你需要一个递归方法，你可以通过在长度上递归来轻松地做到这一点，我给出了一些伪代码（因为在我看来，递归只有在它是一些作业/作业时才有意义，然后你应该自己做一些事情） ：

```
print_all_combos(int k, char* prefix) {
   if (k == 0) {
      printf("%s\n", prefix);
      return;
   }
   append(prefix, "0");
   print_all_combos(k - 1 , prefix);
   remove_last_char(prefix);
   append(prefix, "1");
   remove_last_char(k - 1, prefix);
} 
```

并用 k 和一个空字符串作为参数调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-02T19:07:44.217

根据您提供的示例，我相信您指的是 k 排列，而不是组合。引用自维基百科：

> 组合是从更大的组中选择多个事物的一种方式，其中（与排列不同）顺序无关紧要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-20T15:52:38.170

```
#include<stdio.h>
#include<conio.h>
void calAns(int idx, int f[3]);
int main()
{
    int f[3];
    calAns(0,f);
    getch();
    return 0;
}

void calAns(int idx, int f[3])
{
    if(idx == 3)
    {
        int i;
        for(i = 0; i<3; i++)
            printf("%d",f[i]);
        printf("\n");
        return;
    }

    f[idx] = 0;
    calAns(idx+1, f);
    f[idx] = 1;
    calAns(idx+1, f);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-17T22:00:44.170

感谢@Sergey Kalinichenko，我制作了一个小递归应用程序。尽管这是 Java 代码，但我希望它会对某人有所帮助。

关键方法是`generateCombinationsRecursively`。

测试类：

```
public class CombinationOKTest {

    CombinationOK combinationOK;

    @BeforeEach
    void setUp() {
        combinationOK = new CombinationOK();
    }

    @Test
    void allCombinationsWithTwoElementsAndLengthThreeBinary() {
        List<Integer> elementList = List.of(0, 1);
        int combinationLength = 3;

        List<List<Integer>> combinationList =
                combinationOK.getAllCombinations(elementList, combinationLength);

        assertEquals(8, combinationList.size());
        assertEquals(List.of(
                        List.of(0, 0, 0),
                        List.of(0, 0, 1),
                        List.of(0, 1, 0),
                        List.of(0, 1, 1),
                        List.of(1, 0, 0),
                        List.of(1, 0, 1),
                        List.of(1, 1, 0),
                        List.of(1, 1, 1)),
                combinationList);
    }
} 
```

实现类：

```
public class CombinationOK {
    public List<List<Integer>> getAllCombinations(List<Integer> elementList,
                                                  int combinationLength) {
        List<List<Integer>> combinationList = new ArrayList<>();
        Integer[] combination = new Integer[combinationLength];

        generateCombinationsRecursively(elementList, combinationList, combination, 0);

        System.out.println();
        System.out.println(combinationList);
        return combinationList;
    }

public class CombinationOK {
    public List<List<Integer>> getAllCombinations(List<Integer> elementList,
                                                  int combinationLength) {
        List<List<Integer>> combinationList = new ArrayList<>();
        Integer[] combination = new Integer[combinationLength];

        generateCombinationsRecursively(elementList, combinationList, combination, 0);

        System.out.println();
        System.out.println(combinationList);
        return combinationList;
    }

/**
 *
 * Magic is done in this recursive method <code>generateCombinationsRecursively</code>.
 *
 * @param elementList elements that combinations are made of (T)
 * @param combinationList is resulting list of combinations as a result of recursive method
 * @param combination is array of elements, single combination with variable length (k)
 * @param position of one element from the list <code>elementList</code> in the <code>combination</code> array
 *
 */
private void generateCombinationsRecursively(List<Integer> elementList,
                                             List<List<Integer>> combinationList,
                                             Integer[] combination,
                                             int position) {
    if (position == combination.length) {
        System.out.println(Arrays.asList(combination));
        combinationList.add(new ArrayList<>(Arrays.asList(combination)));
        return;
    }

    for (int i = 0; i < elementList.size(); i++) {
        combination[position] = elementList.get(i);
        generateCombinationsRecursively(
                elementList, combinationList, combination, position + 1);
    }
} 
```

}

概括：

主要功能在这种递归方法`generateCombinationsRecursively`中。

参数`position`是可变的，取决于递归函数的深度。`position`参数的最大值是`combination`列表大小 (k)。如果达到最大值 (k)（方法的第一个块`generateCombinationsRecursively`），则将 new`combination`添加到结果`combinationList`列表中并完成递归。

该方法的第二个块`generateCombinationsRecursively`是`for`循环遍历列表中的所有元素`elementList`。根据`position`值，`combination`列表由`elementList`(T) 中的元素填充。接下来，调用递归方法`generateCombinationsRecursively` 并在参数上加上重音，该`position`参数递增，因此它指向 中的下一个位置`combination`，该递归方法将填充下一个元素（来自 T）。

输出组合：

```
[0, 0, 0]
[0, 0, 1]
[0, 1, 0]
[0, 1, 1]
[1, 0, 0]
[1, 0, 1]
[1, 1, 0]
[1, 1, 1] 
```

输出结果`combinationList`列表：

```
[[0, 0, 0], [0, 0, 1], [0, 1, 0], [0, 1, 1], [1, 0, 0], [1, 0, 1], [1, 1, 0], [1, 1, 1]] 
```

# java - OSGi/Equinox Classloader 使用了意外的 Bundle 版本

> ID：12475168
> 
> 赞同：4
> 
> 时间：2012-09-18T10:30:20.823
> 
> 标签：java, osgi, classloader, equinox

我有一个带有捆绑包的 OSGI 应用程序，需要 2 个版本的 IBM MQSeries：6.0.2 和 7.0.1。我们安装了以下 IBM MQ 捆绑包（仅提及主要捆绑包）

*   `com.ibm.mq.osgi.client_6.0.2.5.jar`
*   `com.ibm.msg.client.osgi.wmq_7.0.1.5.jar`

我们将 2 个 Bundle 定义为 Require-Bundle 如下（是的，我知道，我们应该使用 import-package ;-)） Bundle A`Require-Bundle: com.ibm.msg.client.osgi.wmq;bundle-version="7.0.1"`

捆绑 B`Require-Bundle: com.ibm.mq.osgi.client;bundle-version="[6.0.2,7.0.0)"`

我们另外定义`org.osgi.framework.bootdelegation=javax.*`。没有伙伴类加载，没有动态类加载。

现在，当 Bundle A 加载`com.ibm.mq.jms.MQQueueConnectionFactory`using

```
final MQQueueConnectionFactory connectionFactory = new MQQueueConnectionFactory(); 
```

我希望 Equinox 从 Bundle 加载类`com.ibm.msg.client.osgi.wmq_7.0.1.5`。不是这种情况 ！？！？？MQQueueConnectionFactory 是从 Bundle 加载的`com.ibm.mq.osgi.client_6.0.2.5`！

因此，Bundle A 使用的是 MQ 6.0.2.5..

设置一些 Equinox 调试选项，我可以看到以下内容：

```
Bundle id 56 == com.ibm.mq.osgi.client_6.0.2.5
Bundle id 53 == com.ibm.msg.client.osgi.jms.prereq_7.0.1.5

[...]
BundleLoader[A_1.1.3].loadBundleClass(com.ibm.mq.jms.MQQueueConnectionFactory)
BundleLoader[com.ibm.mq.osgi.client_6.0.2.5].findLocalClass(com.ibm.mq.jms.MQQueueConnectionFactory)
BundleClassLoader[PATH/org.eclipse.osgi/bundles/56/1/.cp/com.ibm.mq.jar].findClassImpl(com.ibm.mq.jms.MQQueueConnectionFactory)
BundleClassLoader[PATH/org.eclipse.osgi/bundles/56/1/.cp/com.ibm.mqjms.jar].findClassImpl(com.ibm.mq.jms.MQQueueConnectionFactory)
  about to read 11659 bytes from com/ibm/mq/jms/MQQueueConnectionFactory.class
  read 11659 bytes from PATH/org.eclipse.osgi/bundles/56/1/.cp/com.ibm.mqjms.jar/com/ibm/mq/jms/MQQueueConnectionFactory.class
  defining class com.ibm.mq.jms.MQQueueConnectionFactory
[...] 
```

“有趣”的部分是 javax.jms.* 类是从中加载的 `com.ibm.msg.client.osgi.jms.prereq_7.0.1.5`

```
BundleClassLoader[com.ibm.mq.osgi.client_6.0.2.5].loadClass(javax.jms.QueueConnectionFactory)
BundleLoader[com.ibm.mq.osgi.client_6.0.2.5].loadBundleClass(javax.jms.QueueConnectionFactory)
BundleLoader[com.ibm.msg.client.osgi.jms.prereq_7.0.1.5].findLocalClass(javax.jms.QueueConnectionFactory)
BundleClassLoader[PATH/org.eclipse.osgi/bundles/53/1/.cp/jms.jar].findClassImpl(javax.jms.QueueConnectionFactory)
  about to read 371 bytes from javax/jms/QueueConnectionFactory.class
  read 371 bytes from /opt/fxportal/FXMB/application/configuration/org.eclipse.osgi/bundles/53/1/.cp/jms.jar/javax/jms/QueueConnectionFactory.class
  defining class javax.jms.QueueConnectionFactory
BundleLoader[com.ibm.msg.client.osgi.jms.prereq_7.0.1.5] found local class javax.jms.QueueConnectionFactory 
```

恕我直言，这与`org.osgi.framework.bootdelegation`设置有关，并且 7.0.1.5 JMS 先决条件发生在 6.0.2.5 之前。

**有人可以解释捆绑类加载器的行为吗？为什么 Equinox 以这种方式连接束 A？我怎样才能达到预期的行为？**

Bundle B 正在按预期工作......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:22:26.083

如果这是一个有效的答案，请不要尝试在 BUndle A version="[7.0.1,7.0.1]" 中定义依赖项时使用此格式，这表示严格的版本范围。更糟糕的情况是，如果您仍然遇到问题，您可以通过执行 Platform.getBundle("com.ibm.msg.client.osgi.wmq").loadClass("com.myclass") 直接从 Bundle 加载类?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T04:23:40.933

当我在 IDE 中使用 OSGi 相关编码时，我遇到了类似的情况。由您的 IDE 完成的这种接线是错误的。当您期望它连接`com.ibm.mq.osgi.client_6.0.2.5`同一类的`com.ibm.msg.client.osgi.wmq_7.0.1.5`. 在您谈到的第二个问题中，同样的问题正在发生。您可以通过查找`com.ibm.mq.jms.MQQueueConnectionFactory`IDE 使用它的类来检查这一点。（您可以使用 Ctrl + 鼠标单击查看已连接的版本）。

# sql-server - 如何提高包含 IsNull(NullIf(...)) 的语句的 t-sql 性能

> ID：12475172
> 
> 赞同：0
> 
> 时间：2012-09-18T10:30:35.343
> 
> 标签：sql-server, performance, tsql

我继承了以下声明：

```
SELECT ISNULL((SELECT (-1)*SUM(CAST(ISNULL(NULLIF(TOTALMTDLCY,''),0) AS DECIMAL(20,5))) 
FROM TI),0) 
```

虽然我知道它要做什么（防止空值并返回 0），但我觉得必须有一种更高效的方法来做到这一点？

原因是我有一个存储过程，它使用此语句 12 次从不同的表中获取值，用于 40,000 个客户 (480,000)，然后为每个 (1.5M) 插入三个记录。

这需要大约 13 分钟才能完成 - 通过收集有关该过程的一些简单统计数据并将它们汇总，它表明虽然 12 条语句的实际时间是 00:00.015，但总时间因此约为 10 分钟。

所以，我的想法是，如果我可以加快这个过程，那么我可以加快我的存储过程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:27:07.607

您不应该使用 varchar 来存储数值，它只会让您感到悲伤。将所有值从 varchar 转换为 decimal 成本很高。

改变你的桌子喜欢

```
update TI set TOTALMTDLCY = null where TOTALMTDLCY = ''
alter table TI alter column TOTALMTDLCY DECIMAL(20,5) null 
```

现在您可以毫无问题地选择

```
select isnull(-sum(TOTALMTDLCY), 0) from TI 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:24:32.440

你可以试试这个如果它有效..

```
SELECT (-1) * SUM(ISNULL(CAST(TOTALMTDLCY AS DECIMAL(20,5)),0)) FROM TI WHERE TOTALMTDLCY <> '' 
```

PS：我目前无法访问 SQL Sever，所以还没有验证它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:26:05.643

```
SELECT 
ISNULL(
  -(SELECT SUM(CAST(TOTALMTDLCY as DECIMAL(20,5))) 
     FROM TI where TOTALMTDLCY<>'')
  ,0) 
```

# jpa - JPA 2 标准 API 与 @ElementCollection 等

> ID：12475173
> 
> 赞同：2
> 
> 时间：2012-09-18T10:30:38.003
> 
> 标签：jpa, jpa-2.0, criteria-api

我有以下实体

```
class A {
  @Id
  Integer id;

  String name;

  @ElementCollection
  @JoinTable(name = "othername", joinColumns = @JoinColumn(name = "id_a"))
  @Column(name = "name")
  List<String> othernames;
} 
```

我正在尝试使用标准 API 来查找 A 的实例，使用中缀搜索名称或其他名称。基本上像这样的 SQL 查询：

```
SELECT * FROM A
    WHERE name like '%something%'
    OR id IN (SELECT id_a FROM othername WHERE name LIKE '%something%'); 
```

以下代码旨在做正确的事情：

```
String search = "%something%";
Subquery<Integer> subquery = c.subquery(Integer.class);
Root<A> subqueryFrom = subquery.from(A.class);
subquery.select(subqueryFrom.get(A_.id));
subquery.where(builder.like(subqueryFrom.get(A_.othernames), search));

query.where(builder.or(
    builder.like(from.get(A_.name), search),
    from.get(A_.id).in(subquery)
)); 
```

*我在这里使用子查询，所以我不会得到重复的结果（例如，有人搜索“a”并且对象的名称包含“a”，而其他名称也包含“a”）。*

现在这段代码不起作用，因为 subqueryFrom.get(A.othernames) 返回一个 Expression<List<String>> 而 builder.like 只接受 Expression<String>。

我实际上认为我的方法是完全错误的，但目前我想不出任何其他解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:36:42.523

您需要使用 join 来加入集合关系。使用 join()，而不是 get()。

此外，您不需要使用子查询，只需将连接放在根查询中，并使用 distinct。

见， [http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#Join](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#Join)

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#CriteriaQuery](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#CriteriaQuery)

# javascript - 尝试使用独立滚动条创建模式窗口

> ID：12475176
> 
> 赞同：0
> 
> 时间：2012-09-18T10:30:45.657
> 
> 标签：javascript, jquery, html, css

我正在尝试创建一个带有自己的滚动条的模式窗口。滚动条通常控制主页而不是.I 中的内容。我`modalwindow`添加了一个来显示我用它到达的位置。`jsfiddle`里面的内容`div "test"`应该是决定模态窗口高度的内容。但是`scrollbar`我的代码不能正常工作。

[**小提琴**](http://jsfiddle.net/WzA4y/24/)

像 pinterest.com 或 twitter 模态窗口..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:51:32.857

你可以使用这个 jQuery 插件：http: [//jscrollpane.kelvinluck.com/](http://jscrollpane.kelvinluck.com/)。

您应该为模态弹出窗口使用 div 容器并为 div 调用 jscrollpane 插件。

# eclipse - Eclipse 双击断点的行号

> ID：12475178
> 
> 赞同：6
> 
> 时间：2012-09-18T10:30:52.090
> 
> 标签：eclipse, breakpoints

这可能是您在 StackOverflow 上发现的更愚蠢的问题之一，但我确实在这里找不到问题。

我运行 Eclipse 3.7.2 (I20110613-1736)（Ubuntu 12.04 LTS 版本）。在最近的更新之后，我的`org.eclipse.wst.jsdt.core.jsNature`项目**在双击**行号时不再切换断点。相反，它会创建一个书签并要求我输入一个书签名称。

虽然断点工作得很好，我可以使用添加它们`Ctrl+Shift+B`，但是经过多年的习惯，我一直在做书签，因为我想双击。

- `General`>`Keys`首选项对话框没有分配鼠标点击 (AFAIK) 的选项，因此看起来这些设置没有更改。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-02T15:30:37.410

我遇到了同样的问题，在这里找到了答案： [Can't set breakpoints in Eclipse](https://stackoverflow.com/questions/664851/cant-set-breakpoints-in-eclipse)

出于某种原因，我的文件是用 eclipse 的纯文本编辑器打开的。我关闭了我的文件，在 Package Explorer --> Open With --> Java Editor 中右键单击它，断点再次正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-11T10:07:37.567

只需编辑文件中的某些内容（添加一个空格，删除该空格，然后保存文件）。切换断点将再次起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:44:55.773

我有时也看到这种情况发生在我身上，但我还没有弄清楚在什么情况下。您只需右键单击行号并在打开的上下文菜单中选择 Toggle Breakpoint。

# c# - 从也使用其中一些包的项目中引用使用 NuGet 包的程序集

> ID：12475179
> 
> 赞同：8
> 
> 时间：2012-09-18T10:30:53.830
> 
> 标签：c#, .net, assemblies, nuget, .net-assembly

我有一个复杂的库`A`，其中包含多个生成以下程序集的 c# 项目：

*   核心
*   A.缓存
*   A.记录
*   A.MongoDb

这个库是我写的，我可以完全访问它的源代码。它取决于几个 NuGet 包，假设它们是：

*   mongocsharpdriver
*   EnterpriseLibrary.缓存
*   EnterpriseLibrary.Logging

*这些库（MongoDb 驱动程序和 EntLib）未安装在 GAC 中。*

我还有一个 Web 项目`B`，我想将`A`其中的库用作对 DLL 的引用（不包括解决方案中的项目`B`）。Web 项目依赖于几个 NuGet 包，其中包括：

*   mongocsharpdriver
*   EnterpriseLibrary.Logging

*这些软件包在解决方案中的版本`A`不`B`匹配，因为它们不是同步开发的。图书馆`A`是在一年前开发的，从那时起就按原样使用。*

**问题：**分发库的正确方法是什么，`A`以便：

1.  即使`A`未引用 lib 依赖项，任何解决方案都可以使用它。
2.  如果一个解决方案有自己的 lib`A`依赖版本，它们不会冲突。

**我目前的做法：**

1.  从我的解决方案中，我引用了四个 dll `A.Core, A.Caching, A.Logging, A.MongoDb`：.
2.  然后，如果它们不存在，我将其所有 NuGet 依赖项添加到解决方案中。
3.  它有时会中断，因为解决方案`B`使用 mongocsharpdriver 1.5 版，而 lib`A`使用 1.1 版（版本不兼容）。

那么，我该怎么办？处理“引用与引用的引用”冲突的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T12:32:38.003

管理共享引用的最佳方法是为库 A[创建自己的 NuGet 包](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package)，其中定义了库 A 所依赖的任何依赖项（包括版本）。如果您不想将库 A 发布到公共 NuGet 提要，您可以[托管自己的提要](http://docs.nuget.org/docs/creating-packages/hosting-your-own-nuget-feeds)。

NuGet 具有一些[复杂的依赖项解析规则](http://nuget.codeplex.com/wikipage?title=Dependency%20Resolution)，它们将尝试找到与您的项目及其依赖项兼容的依赖项版本。不幸的是，这仍然不能解决上面第 3 点中的问题，您的解决方案及其依赖库使用相同外部依赖项的相互不兼容的版本。在这种情况下，您只需要重新处理您的解决方案 B 或库 A，以便它们使用相同版本的 mongocsharpdriver。

# bots - Bing Azure Web Search Api：如何避免来自恶意机器人的查询垃圾邮件？

> ID：12475183
> 
> 赞同：0
> 
> 时间：2012-09-18T10:31:08.150
> 
> 标签：bots, spam, bing-api

我正在使用 Bing Azure Web Search Api 在元搜索网站上工作。从 2 天开始（一个月没有问题后），我面临避免接收来自恶意机器人的垃圾邮件搜索的问题。他们没有淹没网站，他们以慢速模式查询（1 或 2 次查询/秒）。IP 都是不同的，它们不在任何公共黑名单中，显然我不能将 captha 用于搜索界面！

如何避免这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:54:10.370

一个常见的技巧是设置`robots.txt`一个禁区，然后在这个机器人陷阱中加入一些不可见的链接。人类访客不会发现它在那里，行为良好的机器人不会去那里。也许你想给偶尔的访问者带来怀疑的好处，但屡犯者可以在 TCP 级别上被列入黑名单并被拒绝（或者更好的是，将他们提交给[http://projecthoneypot.org/](http://projecthoneypot.org/)）

# vba - 如何在隐藏 WorkSheet 时删除 Excel 中的第 n + 行（行数）

> ID：12475184
> 
> 赞同：0
> 
> 时间：2012-09-18T10:31:13.597
> 
> 标签：vba, excel

我想从隐藏的工作表中删除记录，并且不想取消隐藏它。

如果它是可见的，我会：

```
Sheets("vwReportA").Select
Rows("15:15").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.Clear 
```

在隐藏工作表的情况下如何实现这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T10:40:16.313

像这样使用`Select`是不必要的。有关避免 Select 的想法，请参阅[此答案](https://stackoverflow.com/a/10717999/445425)

试试这个

```
Dim sh as WorkSheet
Dim rng as Range
Set sh = Sheets("vwReportA")
Set rng = sh.[A15]
sh.Range(rng, rng.End(xlDown)).EntireRow.Clear 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:45:30.203

试试这个：

```
Dim r As Range
Set r = Sheets("vwReportA").Rows("15:15")
Range(r, r.End(xlDown)).Clear 
```

# javascript - 按传奇项目过滤谷歌图表

> ID：12475185
> 
> 赞同：1
> 
> 时间：2012-09-18T10:31:15.810
> 
> 标签：javascript, google-api, google-visualization

我用 Google Charts 制作了一个图表，我想应用一些过滤器。我发现了如何按行（图表下方表格中的主题）过滤图表，而不是按图例中显示的列（pete、john、carl、andrea）过滤图表。

在 jsFiddle [http://jsfiddle.net/fcqeA/上查看我的图表](http://jsfiddle.net/fcqeA/)

```
//Filtering subjects:
var compPicker = new google.visualization.ControlWrapper({
  'controlType': 'CategoryFilter',
  'containerId': 'control2',
  'options': {
    'filterColumnLabel': 'Subject',
    'ui': {
      'labelStacking': 'vertical',
      'allowTyping': false,
      'allowMultiple': true
    }
  }
}); 
```

但是现在通过传奇项目......我想我忽略了一些东西，但我真的找不到它......我希望我的问题很清楚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:59:36.850

终于找到了一种方法，以为会有更简单的方法，但可能没有

```
// Place graph
var drawChart = new google.visualization.Dashboard(document.getElementById('dashboard')).bind([compPicker], [chart, table]);;
drawChart.draw(data);

// Filter respondents
document.getElementById('names').onchange = function(evt) {
if (evt.target.selectedIndex == 0) {
  // Expectancy
  chart.setView({'columns': [0,1,2,3,4]});
  chart.setOption('colors', ["#FFC000","#00b0f0","#ff0000","#92d050"]);
} else if (evt.target.selectedIndex == 1) {
  chart.setView({'columns':  [0,1]});
  chart.setOption('colors', ["#FFC000"]);
} else if (evt.target.selectedIndex == 2) {
  chart.setView({'columns':  [0,2]});
  chart.setOption('colors', ["#00b0f0"]);
} else if (evt.target.selectedIndex == 3) {
  chart.setView({'columns':  [0,3]});
  chart.setOption('colors', ["#ff0000"]);
} else if (evt.target.selectedIndex == 4) {
  chart.setView({'columns':  [0,4]});
  chart.setOption('colors', ["#92d050"]);
} else {
   chart.setView({'columns': [0,1,2,3,4]});
  chart.setOption('colors', ["#FFC000","#00b0f0","#ff0000","#92d050"]);     
}
drawChart.draw(data);
};

<select id="names">
  <option value="all">all</option>
  <option value="pete">pete</option>
  <option value="john">john</option>
  <option value="carl">carl</option>
  <option value="andrea">andrea</option>
</select> 
```

完整代码和示例[http://jsfiddle.net/fcqeA/1/](http://jsfiddle.net/fcqeA/1/)

# php - pdepend，没有可用的版本

> ID：12475187
> 
> 赞同：1
> 
> 时间：2012-09-18T10:31:22.310
> 
> 标签：php, jenkins, centos, pear, pdepend

我正在尝试在我的 Centos 6.3 服务器上安装[PDepend 。](http://pdepend.org/)出于某种原因，我经常收到一个错误，即没有可用的软件包/版本。

我已经执行的事情：

*   梨升级
*   梨清除缓存
*   梨频道发现 pear.pdepend.org
*   梨安装 pdepend
*   梨安装 pdepend/PHP_Depend-beta
*   梨远程列表-c pdepend

他们都没有给我指明任何方向。除了没有可用于包“pear.pdepend.org/PHP_Depend”的版本外，没有发生错误

最奇怪的是，我成功地在我的 Ubuntu 服务器上安装了 pdepend。在这种情况下，前 3 个步骤是安装 pdepend 所需的唯一步骤。

有人建议我如何安装 pdepend 吗？

# java - 使用匿名 SSL 连接到 WebSphere MQ

> ID：12475192
> 
> 赞同：1
> 
> 时间：2012-09-18T10:31:26.757
> 
> 标签：java, ssl, ibm-mq, pcf

`"com.ibm.mq.MQException: MQJE001: Completion Code '2', Reason '2393'"`我在下面的代码中遇到异常。我的要求是使用 SSL 服务器连接通道连接 QM。**不需要客户端身份验证**。

```
import com.ibm.mq.*;
public class MQSeriesDataCollector implements CustomDCInf
{
public static void main (String [] args)
{
    String qName="apm_qm";
    MQEnvironment.hostname=args [0]; 
    MQEnvironment.channel=args [1]; 
    MQEnvironment.port=Integer.parseInt(args [2]);
    MQEnvironment.sslFipsRequired=true;
    MQEnvironment.sslCipherSuite = "SSL_RSA_WITH_RC4_128_MD5";//RC4_MD5_US
    MQQueueManager qMgr=null;
    try{
        qMgr = new MQQueueManager("apm_qm");
    }catch (MQException mqe){
        mqe.printStackTrace();
}
PCFMessageAgent agent=null;
StringBuffer output = new StringBuffer();
MQSeriesDataCollector mqTest=new MQSeriesDataCollector();
        try{
            agent = mqTest.getMQConnection(qMgr);
            output.append(mqTest.getQueueStats(agent));
        }
        catch(MQException mqe){
            System.out.println("Error:" + mqe.reasonCode + " Description:"+PCFConstants.lookupReasonCode (mqe.reasonCode));
            mqe.printStackTrace();
        }
        catch(NoClassDefFoundError ex){
            ex.printStackTrace();
        }
        catch (Exception e){            
             e.printStackTrace();           
        }
        finally{
            try{
                if(agent!=null){
                    agent.disconnect();
                }
            }            
            catch(Exception ex){                
                ex.printStackTrace();
            }
        }

        System.out.println(output.toString());
    } 
```

```
例外：
com.ibm.mq.MQException：MQJE001：完成代码“2”，原因“2393”。
        在 com.ibm.mq.MQManagedConnectionJ11.(MQManagedConnectionJ11.java:235)
        在 com.ibm.mq.MQClientManagedConnectionFactoryJ11._createManagedConnection(MQClientManagedConnectionFactoryJ11.java:505)
        在 com.ibm.mq.MQClientManagedConnectionFactoryJ11.createManagedConnection(MQClientManagedConnectionFactoryJ11.java:547)

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T13:14:22.507

为了满足您不验证客户端的要求，通道必须设置为`SSLCAUTH(OPTIONAL)`。队列管理器必须有一个证书，而客户端必须有一个 trsuststore，其中包含 QMgr 证书的签名者链（如果 CA 签名）或 QMgr 证书的公钥（如果自签名）。请记住，使用 SSL/TLS，服务器端*总是*经过身份验证，这需要服务器上的个人证书以及客户端验证它的方法。此外，客户端和 QMgr 必须就使用的协议达成一致，如果需要 FIPS，他们必须使用 FIPS 认证的算法之一。

上面发布的代码中有一件事肯定是错误的，还有几件事是导致问题的次要原因。一旦你解决了我将在下面描述的配置，你可能会遇到次要问题之一。要确定哪些适用，有必要知道 WMQ 客户端和服务器的版本、通道定义、JSSE 的 SSL 设置和/或命令行调用等。

所以在这种情况下，2393 表示客户端无法初始化 SSL/TLS 会话。明显的问题是，根据信息中心页面*SSL CipherSpecs 和 CipherSuites*，这两个设置是无效的组合：

```
MQEnvironment.sslFipsRequired=true;
MQEnvironment.sslCipherSuite = "SSL_RSA_WITH_RC4_128_MD5";//RC4_MD5_US 
```

您没有提到您使用的是哪个版本的 WMQ 客户端和服务器，所以这里有一个指向[V7.0](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/topic/com.ibm.mq.csqzaw.doc/jm34740_.htm)、[V7.1](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/topic/com.ibm.mq.doc/jm34740_.htm)和[V7.5](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/topic/com.ibm.mq.doc/jm34740_.htm)的该页面的链接。请注意，列出 FIPS 合规性的列不包括任何 MD5 密码套件。（MD5 已损坏，不应用于签署证书、SSL、TLS 或其他任何东西。就此而言，SSL 已损坏，以后只能使用 TLS 密码，但这是另一个问题的讨论。）要得到这个工作时，您需要设置`MQEnvironment.sslFipsRequired=false`或选择经过认证并列在最右侧列中的密码套件之一。

不知道您正在使用的版本，我建议将 FIPS 设置为`false`并`NULL_SHA`在频道和`SSL_RSA_WITH_NULL_SHA`应用程序上使用，直到您确定所有其他配置都正常工作。此密码套件可在所有平台上的所有 WMQ 版本中使用。使用它来测试将确保所有其他设置都是正确的。一旦你让它工作，然后选择一个更强大的基于 TLS 和 SHA 的密码套件，它在服务器和客户端都可用。

也就是说，这里是您可能遇到的其他一些可能的问题。

当应用程序在代表服务器端的信任库中找不到其信任库或证书或签名者链时，您可以获得 2393。您可以在命令行中传递这些：

```
java -Djavax.net.ssl.trustStore=key2.jks \
     -Djavax.net.ssl.trustStorePassword=passw0rd \
     -cp "%CLASSPATH%"  \
     com.ibm.examples.JMSDemo -pub -topic JMSDEMOPubTopic 
```

密钥库和信任库操作由 JSSE 提供程序处理，而不是由 WMQ 本身处理。因此，您通常用于配置 JSSE 提供程序的任何方法都应该有效。例如，除了上面显示的命令行之外，它还可能包括 Java EE 服务器中的容器管理设置。

如果连接到达提供其证书的服务器并且信任库具有错误或不完整的签名者链，您也可能会收到错误（我不记得它是否为 2393）。

2393 的其他可能原因包括文件权限、路径或文件名拼写错误等。

# php - Symfony 2.1 - 会话事件（垃圾收集器）

> ID：12475195
> 
> 赞同：1
> 
> 时间：2012-09-18T10:31:50.273
> 
> 标签：php, symfony, symfony-2.1

在我的应用程序中，我存储了一些与会话相关的数据——我们称之为购物车机制。

购物车具有关联的会话 ID，并且产品与某些购物车相关。很基本。

我想听听 Symfony 的会话销毁事件，所以我可以从数据库中删除未使用的产品。有什么想法可以实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:42:25.147

我认为不可能产生这样的事件。**您可以更新 db 中的最后一个会话使用情况（在 kernel.request 事件侦听器中），并在session.storage.options.lifetime**秒过后在 cron 任务中将其删除。

# java - 在普通类中获取 startActivityForResult() 的结果

> ID：12475200
> 
> 赞同：3
> 
> 时间：2012-09-18T10:32:05.867
> 
> 标签：java, android, sd-card, filechooser

我正在从互联网上保存 PDF。我正在使用的下载 pdf 的类是普通类“FileChooser.java”，而不是活动类。现在，我想打开一个 Activity 来浏览 SDCard 并将选定的文件夹路径返回给“FileChooser”类

我计划使用以下代码

```
private void getFolder() {
    Intent intent = new Intent(Intent.ACTION_GET_CONTENT); 
    intent.setType("*/*"); 
    intent.addCategory(Intent.CATEGORY_OPENABLE);

    try {
        startActivityForResult(
                Intent.createChooser(intent, "Please select the folder"),0);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

但我希望结果在“FileChooser”（普通 Java）类中

我应该怎么做才能在“FileChooser”类中得到结果？

请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:51:57.410

您可以使用 setresult() 传递数据并使用 onactivity result() 获取结果。

[这里](http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_31.html)的教程可以帮助你。

# php - 在 CodeIgniter 中处理动态内容（最佳实践）

> ID：12475203
> 
> 赞同：1
> 
> 时间：2012-09-18T10:32:10.967
> 
> 标签：php, codeigniter

我正在使用 CodeIgniter 创建一个网站，并且对最佳实践有疑问。

我通常将我的网页分成模块化的块。页眉，内容，页脚（以及其他一些根据需要洒在中间的东西。

“页眉”和“页脚”块通常是静态的，而中间的内容可能会根据一些变量而改变（例如实际页面 - 主页、关于、联系方式等）

下面是页面的控制器。header_view、navigation_view 和 footer_view（很可能）永远不会改变。home_main_view 将。

```
public function index()
{
    $this->load->view('header_view');
    $this->load->view('navigation_view');
    $this->load->view('home_main_view');
    $this->load->view('footer_view');

} 
```

例如，如果用户导航到 about 页面，视图可能如下所示：

```
public function index()
{
    $this->load->view('header_view');
    $this->load->view('navigation_view');
    $this->load->view('about_view');
    $this->load->view('footer_view');

} 
```

我将如何处理 CI 中的这种变化？最好将 home_main_view 设为变量并将其传递给 index() 函数吗？我以前做过这个（用户单击一个链接，该链接触发控制器中的一个函数，该函数设置调用 index($var) 的 $var 调用 view($var)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:43:36.390

我最喜欢的方法是使用我用来加载其他组件的布局（它只是一个视图）。显然，您拥有的每种页面类型都需要一个布局，但是使用布局可以使以后的更改变得容易。

我更进一步，在我的自定义控制器`MY_Controller`中创建了一个用于加载布局的方法：

```
<?php
class MY_Controller extends CI_Controller{
    /**
     * Global $data variable holder
     * @var stdClass
     */
    protected $data;
    /**
     * The templates path, used by the 'render' method to determine the template to load
     * This is the 'root' of the templates folder for a specific section
     * Must NOT contain a trailing slash!
     * @var string
     */
    protected $templates_path = 'site';
    /**
     * The layout used by the 'render' method to load the specified view
     * @var string
     */
    protected $layout = 'default';
    /**
     * Class initialisation
     */
    function __construct() {
        parent::__construct();
        /*init the $data variable*/
        $this->data = new stdClass();
        /*the base url shortcut - to be used where needed*/
        $this->data->base_url = $this->config->item('base_url');
        /*page encoding header*/
        $this->output->set_header('Content-Type: text/html; charset=utf-8');
    }
    /**
     * Helper method that will load a view using the layout configured
     * @param type $view
     */
    protected function render($view = FALSE){
        $this->data->page_template = $this->templates_path.'/'.$view;
        $this->data->templates_path = $this->templates_path;
        $this->load->view($this->templates_path.'/layouts/'.$this->layout, $this->data);
    }
} 
```

然后，在我的布局中，我将`$page_template`变量中指示的视图加载到适当的位置

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); ?>
<!DOCTYPE html>
<html>
    <head>
        <?$this->load->view($templates_path.'/sections/head')?>
    </head>
    <body class="<?=$page_class?>">
        <?$this->load->view($templates_path.'/sections/header')?>
        <?if(isset($hpslider) && $hpslider)
            $this->load->view($templates_path.'/sections/hp_slider')?>
        <div class="pcontent">
            <div class="page">
                <?=$this->load->view($page_template);?>
            </div>
        </div>
        <?$this->load->view($templates_path.'/sections/footer')?>
    </body>
</html> 
```

希望这可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:08:09.783

我不使用 CI，但您可以使用 $_post 、 $_get 或段来让操作知道您要加载哪个页面。

段示例：当您转到**example.com/index.php/controller/index/home**时 ，它​​将加载“home”视图。

```
public function index(){
$page=$this->uri->segment(3);
$this->load->view('header_view');
$this->load->view('navigation_view');
$this->load->view($page);
$this->load->view('footer_view');
} 
```

[http://codeigniter.com/user_guide/libraries/uri.html](http://codeigniter.com/user_guide/libraries/uri.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:31:46.577

请在题为[CodeIgniter 中的页眉和页脚](https://stackoverflow.com/questions/9540576/header-and-footer-in-codeigniter/9540985#9540985)的 SO 线程中查看我的答案。这就是我处理所有观点的方式。这是一种相当模块化的方法 - 希望它有所帮助！

## 评论后更新

例如，主页可能会像这样加载：

```
class Home extends CI_Controller{
    function index(){
        $d['v'] = 'home';

        //do database interaction here and 
        //ultimately assign results to some key in $d too.

        $this->load->view('init', $d);
    }
} 
```

# php - Zend 框架：如何在 router.xml 中使用验证器

> ID：12475204
> 
> 赞同：0
> 
> 时间：2012-09-18T10:32:10.083
> 
> 标签：php, xml, validation, zend-framework, routes

我已经创建了验证器*SportNameValidator*，我想用它来检查 url 中的变量。如何将验证器放入**routes.xml**？

这是文件的一部分：

```
<rss_top_news_by_sportname>
<type>Zend_Controller_Router_Route_Regex</type>
<route>export/rss/top/news/([a-z]+).xml</route>
<defaults>
    <controller>export</controller>
    <action>rssTopNewsBySportName</action>
</defaults>
<map>
    <sportname>1</sportname>
</map> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:40:26.917

验证器用于验证表单中的用户输入，而不是路由。但是您可以在控制器中使用此验证机制来验证 url。

```
$validator = new SportNameValidator();
$valid = $validator->isValid($url_or_part_of_url_you_want_to_validate); 
```

# git - git浅克隆连同分支

> ID：12475210
> 
> 赞同：1
> 
> 时间：2012-09-18T10:32:27.310
> 
> 标签：git, branch, clone, shallow-copy, shallow-clone

我必须处理一个包含一些二进制文件的 git repo。

如果有人能向我解释这一点，我将不胜感激

```
>git clone --depth 1 -- ssh://git/foo/bar.git test_d
Cloning into 'test_d'...
remote: Counting objects: 289, done.
remote: Compressing objects: 100% (268/268), done.
remote: Total 289 (delta 111), reused 120 (delta 19)
Receiving objects: 100% (289/289), 1.95 MiB | 519 KiB/s, done.
Resolving deltas: 100% (111/111), done.

>git clone --depth 1 -b master -- ssh://git/foo/bar.git test_db
Cloning into 'test_db'...
remote: Counting objects: 5980, done.
remote: Compressing objects: 100% (1777/1777), done.
remote: Total 5980 (delta 3868), reused 5657 (delta 3660)
Receiving objects: 100% (5980/5980), 36.50 MiB | 1.10 MiB/s, done.
Resolving deltas: 100% (3868/3868), done.

>git clone -b master -- ssh://git/foo/bar.git test_b
Cloning into 'test_b'...
remote: Counting objects: 6953, done.
remote: Compressing objects: 100% (1779/1779), done.
remote: Total 6953 (delta 4419), reused 6946 (delta 4417)
Receiving objects: 100% (6953/6953), 57.25 MiB | 1.15 MiB/s, done.
Resolving deltas: 100% (4419/4419), done. 
```

也就是说，为什么在传递**-b**时似乎正在改变**--depth**的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:47:49.437

hmm, I think I found solution, in related question: [Partial clone with Git and Mercurial](https://stackoverflow.com/questions/2586824/partial-clone-with-git-and-mercurial)

```
> md test_foo
> cd test_foo
> git init
> git remote add origin ssh://git/foo/bar.git
> git config --local remote.origin.fetch +refs/heads/master:refs/remotes/origin/master
> git pull --depth 1
remote: Counting objects: 289, done.
remote: Compressing objects: 100% (268/268), done.
remote: Total 289 (delta 111), reused 120 (delta 19)
Receiving objects: 100% (289/289), 1.95 MiB | 496 KiB/s, done.
Resolving deltas: 100% (111/111), done.
From ssh://git/foo/bar.git
 * [new branch]      master     -> origin/master 
```

but that doesn't seem like a **solution** ;/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-08T01:39:44.833

而不仅仅是`git clone <url>`

利用`git clone -b <branch> <url> --depth=1`

请参阅此处：[快速克隆-a-large-git-repo](https://coderwall.com/p/wwpk2g/quickly-clone-a-large-git-repo)这是我的参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-22T14:45:32.570

1.  存储库的浅克隆

    git clone --depth [number_of_commits] [url_of_remote]

2.  克隆一个分支

    git clone [url_of_remote] --branch [branch_name] --single-branch

[http://www.sitepoint.com/managing-huge-repositories-with-git/](http://www.sitepoint.com/managing-huge-repositories-with-git/)

# java - 使用 jsoup 替换 HTML 标签

> ID：12475213
> 
> 赞同：11
> 
> 时间：2012-09-18T10:32:31.437
> 
> 标签：java, jsoup

这是我的代码

```
String html = "<font>fsdfs<font>dfsdf</font>dasdasd</font>";
Document doc = Jsoup.parse(html);
Elements elements = doc.select("font");
for(Element element : elements)
{
element.replaceWith(new Element(Tag.valueOf("span"),"").html(element.html()));
}

System.out.println(doc.html()); 
```

我想替换字体标签并放置跨度标签。在这它将替换第一个字体标签但不是第二个标签

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-18T11:18:31.333

您也可以像这样替换标签：

```
String html = "<font>fsdfs<font>dfsdf</font>dasdasd</font>";
Document doc = Jsoup.parse(html);
Elements elements = doc.select("font");

// rename all 'font'-tags to 'span'-tags, will also keep attributs etc.
elements.tagName("span");

System.out.println(doc.html()); 
```

# maven - 版本插件不更新子模块，只更新父模块

> ID：12475220
> 
> 赞同：4
> 
> 时间：2012-09-18T10:32:52.053
> 
> 标签：maven, versioning, m2eclipse, project-structure, versions-maven-plugin

我的父 pom 的模块定义如下：

## 父 pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

    <modelVersion>4.0.0</modelVersion>
    <groupId>parent</groupId>
    <artifactId>parent</artifactId>
    <version>1.0.2-SNAPSHOT</version>
    <packaging>pom</packaging>
    <modules>
        <module>../proj1</module>
        <module>../proj2</module>
    </modules>

</project> 
```

以下是子模块 pom 文件：

## proj2 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0     http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>parent</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.2-SNAPSHOT</version>
        <relativePath>../parent/pom.xml</relativePath>
    </parent>

    <groupId>proj2</groupId>
    <artifactId>proj2</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
</project> 
```

## proj1 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmln:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
     http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>parent</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.2-SNAPSHOT</version>
        <relativePath>../parent/pom.xml</relativePath>
    </parent>

    <groupId>proj1</groupId>
    <artifactId>proj1</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
</project> 
```

但是当我使用版本插件时，它只设置父版本号而不是它的模块。这是我正在使用的命令：

```
versions:set -DnewVersion=1.0.2-SNAPSHOT 
```

这是输出：

```
[INFO] proj1 ...................................... SKIPPED
[INFO] proj2 ...................................... SKIPPED
[INFO] parent ......................................SUCCESS 
```

正在跳过子模块。我怎样才能使子模块也被更新而不仅仅是父模块？

更新：我尝试从子模块中删除版本标签，所以子模块现在是：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>parent</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.2-SNAPSHOT</version>
        <relativePath>../parent/pom.xml</relativePath>
    </parent>

  <groupId>proj2</groupId>
  <artifactId>proj2</artifactId>
  <packaging>war</packaging>
</project>    

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
        <groupId>parent</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.2-SNAPSHOT</version>
        <relativePath>../parent/pom.xml</relativePath>
    </parent>

  <groupId>proj1</groupId>
  <artifactId>proj1</artifactId>
    <packaging>war</packaging>
</project> 
```

但是子 pom 文件中没有更新版本号。

更新：这是我认为这个过程的工作方式，请随时提出修改建议：

理论上（我没有测试过）在嵌套文件结构中，当目标运行时，Maven 将更新每个子模块的单独版本号：'ons:set -DnewVersion=1.0.2-SNAPSHOT'。

但是，在平面文件结构中，如果父模块具有相同的版本，则不需要在子模块中指定版本号。这是因为如果不设置子版本号将使用父版本号。因此，要更新父模块的所有子模块，只需更新父模块的版本号，如果所有子模块都没有设置版本号，那么它们将具有与父模块相同的版本号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:35:34.200

这可能对您没有帮助，但听起来像这个错误：[JIRA MRELEASE-261：release:prepare 应该支持平面目录多模块项目](http://jira.codehaus.org/browse/MRELEASE-261)

不推荐扁平结构。这是（Eclipse ？）开发人员的“老习惯”。我用了很长时间，然后才发现 Maven 方法的好处。

旧方式：

```
parent
`-- pom.xml
submodule 1
`-- pom.xml
submodule 2
`-- pom.xml 
```

Maven方式：

```
parent
|-- submodule 1
|   `-- pom.xml
|-- submodule 2
|   `-- pom.xml
`-- pom.xml 
```

您可以在这里找到更多信息：

*   [在 Maven 项目中，嵌套或平面目录布局的原因是什么？](https://stackoverflow.com/questions/2882711/in-a-maven-project-what-are-reasons-for-either-a-nested-or-a-flat-directory-lay)
*   [孩子在平面结构的多模块 maven 构建中找不到父 pom](https://stackoverflow.com/questions/1681453/child-not-finding-parent-pom-in-flat-structured-multi-module-maven-build)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:28:41.960

好的，现在如果您的子模块正在引用父 pom，您可以从子模块 pom 中删除版本标签，这样它们的版本将从父 pom 继承。

由于版本是从 pom 继承的，所以当您使用版本插件时，所有模块都将具有相同的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T09:26:38.087

从 运行命令`parent/`。

# ios - UIImage 返回 NULL / 图像文件初始化问题

> ID：12475225
> 
> 赞同：2
> 
> 时间：2012-09-18T10:33:04.180
> 
> 标签：ios, uiimage, png

我正在尝试将图像 (.png) 加载到 UITableViewCell 的 backgroundView 中。但是，图像不显示。根据返回 NULL 的图像的日志输出，这似乎是初始化图像的问题。

我尝试过/检查过的事情：

1.  文件名拼写和大写正确。

2.  该文件已被适当地添加到 Xcode 并且在 Copy Bundle Resources 中可见

3.  在文件检查器中选中文件的目标成员资格框

4.  我更新了文件，所以可以肯定的是，我从模拟器中删除了应用程序以及 DerivedData 文件夹的内容。

5.  我重新启动了 XCode。

6.  我尝试通过以下方式加载图像：

    ```
    [UIImage imageNamed:@"cell-bg.png"] 
    ```

    也

    ```
    [UIImage imageNamed:@"cell-bg"] 
    ```

7.  我还尝试从捆绑包中加载：

    ```
    NSBundle *mainBundle = [NSBundle mainBundle];
    NSString *imagePath = [mainBundle pathForResource:@"cell-bg" ofType:@"png"];
    NSLog(@"path: %@", imagePath);
    UIImage *image = [UIImage imageWithContentsOfFile:imagePath]; 
    ```

对于最后一个， NSLog 在输出中生成完整路径，但是当我执行另一个 NSLog 时，`image`它会返回`NULL`.

Apple 的 UIImage 类参考在该`-imageWithContentsOfFile:`方法下声明：

> 返回值 指定文件的新图像对象，如果方法无法从指定文件初始化图像，则返回 nil。

那么，文件可能有问题吗？我如何诊断和纠正问题？

# matlab - 与 R 中的类似方法相比，Matlab 中的 textscan 使用过多的 RAM

> ID：12475226
> 
> 赞同：6
> 
> 时间：2012-09-18T10:33:07.543
> 
> 标签：matlab, memory, csv, textscan

我在具有 16 GB RAM 的 Linux Mint v12 上运行 Matlab R2011b 和 R 版本 2.13.1。

我有一个 csv 文件。前 5 行（和标题）是：

```
#RIC,Date[G],Time[G],GMT Offset,Type,Price,Volume
DAEG.OQ,07-JUL-2011,15:10:03.424,-4,Trade,1.68,1008
DAEG.OQ,07-JUL-2011,15:10:03.424,-4,Trade,1.68,1008
DAEG.OQ,07-JUL-2011,15:10:03.424,-4,Trade,1.66,300
DAEG.OQ,07-JUL-2011,15:10:03.424,-4,Trade,1.65,1000
DAEG.OQ,07-JUL-2011,15:10:03.464,-4,Trade,1.65,3180 
```

该文件很大（大约 900MB）。给定字符和数字数据的组合，可以将这个文件读入 matlab，如下所示：

```
fid1 = fopen('/home/MyUserName/Temp/X.csv');
D = textscan(fid1, '%s%s%s%f%s%f%f', 'Delimiter', ',', 'HeaderLines', 1);
fclose(fid1); 
```

虽然文件是 900MB，但在运行上述代码时，系统监视器显示我的 RAM 使用量从大约 2GB 跃升至 10GB。更糟糕的是，如果我使用稍大的 csv 文件（约 1.2 GB）尝试相同的过程，我的 RAM 最大为 16 GB，而 Matlab 永远无法完成数据的读取（它只是停留在“忙碌”模式）。

如果我想将同一个文件读入 R，我可能会使用：

```
D <- read.csv("/home/MyUserName/Temp/X.csv", stringsAsFactors=FALSE) 
```

这比 Matlab 需要更长的时间，但系统监视器显示我的 RAM 使用量仅从 2GB 跳到 3.3GB（考虑到原始文件大小更合理）。

我的问题有两个部分：

1）为什么`textscan`在这种情况下会占用大量内存？

2）我可以使用另一种方法将这种类型的 1.2GB csv 文件放入我系统上的 Matlab 中，而不会耗尽 RAM？

**编辑：**澄清一下，我很好奇是否存在仅 matlab 的解决方案，即我对涉及使用不同语言将 csv 文件分解成更小的块的解决方案不感兴趣（因为这就是我已经在做）。抱歉 Trav1s，我应该从一开始就说清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T07:56:18.150

问题可能是那些“%s”字符串被读入 Matlab cellstrs，这是低基数字符串的内存效率低下的数据结构。对于像这样的大表格数据，Cellstrs 很糟糕。每个字符串最终都存储在一个单独的原始`char`数组中，每个数组都有大约 400 字节的开销和碎片问题。对于 900MB 的文件，这看起来像 1800 万行；每行 4 个字符串，大约需要 10-20 GB 的 cellstrs 来保存这些字符串。啊。

您想要的是在这些字符串进入时将它们转换为紧凑的原始数据类型，而不是一次将所有 1800 万行全部放入庞大的单元格字符串中。日期和时间戳作为 datenums 或您正在使用的任何数字表示形式，以及那些低基数字符串作为二维`char`数组或一些等价的分类变量。（鉴于您的数据集大小，您可能希望将这些字符串表示为带有查找表的简单数字标识符，而不是字符。）

一旦你决定了你的紧凑数据结构，有几种方法可以加载它。你可以在纯 Matlab 中将读取分解为块：使用`textscan()`循环中的调用一次读取 1000 行，解析和转换该块中的 cellstrs 以它们的紧凑形式，缓冲所有结果，并`cat`在读取结束时将它们放在一起。这将使峰值内存需求降低。

如果您要做很​​多这样的工作，并且性能很重要，您可能希望使用 Java 并编写自己的解析器，该解析器可以在输入字符串和日期时对其进行转换，然后再将它们返回给 Matlab更紧凑的数据类型。这并不难，而且可以从 Matlab 中直接调用 Java 方法，所以这可能只算使用单独的语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:10:09.463

对于 2) 你可以尝试使用 csvread 命令。我不知道性能比较如何，但至少它是一种替代方案。

另一种选择是使用更快的语言（如 C 或 awk）读取文件，然后将其分解为更小的文件。顺序读取许多小文件将比一个大文件占用更少的内存。

# php - 如何确定 PHP 是否从控制台运行？

> ID：12475227
> 
> 赞同：-1
> 
> 时间：2012-09-18T10:33:12.350
> 
> 标签：php, console, terminal

```
php -f script.php param1 param2 
```

目前，我只是在检查是否`isset($argv)`. 这是最好的方法吗？

PS我还想知道所有输入参数是否总是存储在`$argv`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:36:03.717

正如您可以在此处阅读[的那样，有什么方法可以知道 php 脚本是否在 cli 模式下运行？](https://stackoverflow.com/questions/607373/is-there-any-way-to-know-if-a-php-script-is-running-in-cli-mode)你可以使用这个功能：

```
function is_cli()
{
    return php_sapi_name() === 'cli';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:36:49.883

检查是否`REQUEST_METHOD`设置了 a：

```
/**
 * Check if the site is being visited (in a browser) or run as a program from the 
 * commandline.
 * @return boolean true if the request appears to come from the WWW, false if not.
 */
function is_web_request () {
    return isset($_SERVER['REQUEST_METHOD']);
} 
```

# linux - 创建虚拟接口 Linux

> ID：12475228
> 
> 赞同：0
> 
> 时间：2012-09-18T10:33:15.960
> 
> 标签：linux, bash, network-programming, debian

我的目标是仅使用一个物理接口来模拟多个 IP 接口，为此我尝试使用此别名

```
Ifconfing ethX:1 <IP> 
```

但是当我尝试通过该接口发送数据包时，我看到 IP 源与原始的真实以太网接口相同。然后我尝试使用 TAP 接口，但我无法将它们与我的物理接口“链接”，我注意到它们可以相互通信但无法 ping（`ping -I tap0 <ip real IF>` ) 原始接口。如果我与所有这些人建立一座桥梁，它仍然有效。

我想避免根据需要安装许多 Virtual Box，但我想要的正是它的作用：构建一个新的虚拟接口并将其与真实接口桥接，以便在一个物理接口上附加更多 IP 接口。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:47:57.500

你可能想试试 macvlan。它允许您创建具有唯一 MAC 地址的虚拟接口，并且您可以专门为该虚拟接口分配 IP 地址。

见：http: [//jim.studt.net/depository/index.php/notes-on-linux-s-macvlan-module](http://jim.studt.net/depository/index.php/notes-on-linux-s-macvlan-module)

# c - 与 pthread 链接的 C_icap 错误

> ID：12475230
> 
> 赞同：0
> 
> 时间：2012-09-18T10:33:21.340
> 
> 标签：c, ubuntu, linker, pthreads, glibc

我想在 Ubuntu 11 上安装 c_icap 并收到以下错误。

```
make[2]: Entering directory `/home/madmin/milkyway/sol/server/3rdparty/c_icap-0.1.7/tests'
/bin/bash ../libtool --tag=CC   --mode=link gcc -I../include/ -D_REENTRANT -g -O2 -Wall -rdynamic -rpath /usr/local/c_icap/lib   -o test_cache test_cache.o  **-lpthread** ../libicapapi.la  -ldl
libtool: link: gcc -I../include/ -D_REENTRANT -g -O2 -Wall -rdynamic -o .libs/test_cache test_cache.o  **-lpthread** ../.libs/libicapapi.so -ldl -Wl,-rpath -Wl,/usr/local/c_icap/lib
../.libs/libicapapi.so: undefined reference to `pthread_rwlock_rdlock'
../.libs/libicapapi.so: undefined reference to `pthread_rwlock_wrlock'
../.libs/libicapapi.so: undefined reference to `pthread_rwlock_unlock'
collect2: ld returned 1 exit status 
```

不知道问题是什么，因为我看到了**libicap.so**的 objdump并得到了这个

```
0000000000000000         *UND*  0000000000000000              pthread_rwlock_rdlock
0000000000000000       F *UND*  0000000000000000    pthread_mutex_destroy@@GLIBC_2.2.5
0000000000000000         *UND*  0000000000000000              pthread_rwlock_wrlock
0000000000000000       F *UND*  0000000000000000   pthread_mutex_unlock@@GLIBC_2.2.5
0000000000000000         *UND*  0000000000000000              pthread_rwlock_unlock 
```

这表明 pthread lib 没有丢失，因为 pthread_mutex 符号在 objdump 中被正确解析。还存在 -lpthread 标志。

在 Makefile 我有

```
THREADS_LDADD = -lpthread
c_icap_LDADD = -lpthread libicapapi.la  -ldl 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:26:58.433

改为编译`-pthread`。

这将包括所有需要的东西。

# javascript - 收到 JQUERY“语法错误，无法识别的表达式”

> ID：12475233
> 
> 赞同：2
> 
> 时间：2012-09-18T10:33:32.433
> 
> 标签：javascript, jquery, exception, chars

以下错误出现在 firebug 中：

```
 Error: Syntax error, unrecognized expression: >

    jquery line 3 
```

我不明白这是什么，我尝试在我的代码中搜索该字符，但我找不到任何东西。我刚刚发现了一些函数调用：`$('#element').html('<strong>hello</strong>');`

没有别的了，有人知道更多吗？

在页面代码中：

```
 <script type="text/javascript">
    window.fbAsyncInit = function(){
       FB.init({ 
        appId: '307355336003233',
         status: true,
          cookie: true,
           xfbml: true 
         });
    };
    (function() {
       var e = document.createElement('script');
       e.type = 'text/javascript';
       e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
       e.async = true;
       document.getElementById("fb-root").appendChild(e);
    }());

    </script>
<script type="text/javascript">
$(document).ready(function(){
  $('.modal').hide();
  $(".nav li a i").tooltip({
        placement: "bottom"
      });
  $("body").tooltip({
    selector: "*[rel=tooltipRIGHT]",
    placement: "right"
  });

  $("*").tooltip({
    selector: "*[rel=tooltipTOP]",
    placement: "top"
  });
  $("* >").tooltip({
    selector: "*[rel=tooltipBOTTOM]",
    placement: "bottom"
  });
      $('.top-link i').on('click',function(){
         $('.top-link i').removeClass('active');
         $(this).addClass('active');
      });
$('.popover-init').popover({
    selector:'*[rel=popoverTOP]',
    placement:'top'
   });
});
</script> 
```

文件 functons.js

```
<!-- FB LOGIN -->

  function FBlogin(){
    FB.getLoginStatus(function(r){
      FB.login(function(response) {
        if(response.authResponse) {
          $.ajax({
            type:'GET',
            url: _config_base_url+'/login/ajax_login',
            dataType:'json',
            data:{'at':response.authResponse.accessToken},
            beforeSend:function(){
              $('.ajax-loading').show();
            },
            error:function(_response){
              //openError(_response.responseText);
              $('.ajax-loading').hide();

            },
            success:function(json){
              $('.ajax-loading').hide();
              _document_location = window.location.href;
              /*_json = JSON.parse(json);
              $("#top-logged-out").fadeOut(0,function(){
               $("#top-logged-in").text(_json.first_name);
               $('#top-user').fadeIn();
              });*/
          window.location.reload()
            }
          });
        } else {}
      },{scope:'email,user_birthday'});
    });
  }
  function RemoveAccount(){
$.ajax({
  type:'POST',
  url:_config_base_url+'/account/remove',
  data:{},
  dataType:'json',
  error:function(){
    $('.ajax-loading').hide();
  },
  beforeSend:function(){
    $('.ajax-loading').show();
  },
  success:function(json){
    $('.ajax-loading').hide();
    $('#remove-account-close').trigger('click');
    window.location.href= _config_base_url+'/logout';

  }
});
}
function deleteasd(_id_asd){
$.ajax({
  type:'POST',
  url:_config_base_url+'/asds/delete',
  data:{'id':_id_asd},
  dataType:'json',
  error:function(){
    $('.ajax-loading').hide();
  },
  beforeSend:function(){
    $('.ajax-loading').show();
  },
  success:function(json){
    $('.ajax-loading').hide();
    $('#'+_id_asd+'-asd-content').fadeOut(400,function(){
      $(this).remove();
    });

  }
});
}
function createasd(){

_title = $('input#title').val();
_description = $('textarea#description').val();
_keywords = $('input#tags').val();

$.ajax({
  type:'POST',
  url:_config_base_url+'/asds/create',
  dataType:'json',
  data:{'title':_title,'description':_description,'keywords':_keywords},
  error:function(){
  $('.ajax-loading').hide();
  $('#save-asd').removeAttr('disabled');
  $('#create-asd-errors').text('somenthing was wrong, please try later.').fadeIn(0);
  },
  beforeSend:function(){
  $('.ajax-loading').show();
  $('#save-asd').attr('disabled','disabled');

  },
  success:function(json){
   $('#save-asd').removeAttr('disabled');
  _json = json;
  $('.ajax-loading').hide();

   if(_json.error == 1){

  $('#create-asd-errors').html('<h5>Errors</h5>'+_json.title+'<br>'+_json.description+'<br>'+_json.keywords).fadeIn(0);
   }else{
  $('.modal-body').html('<div class="alert alert-success"><h5>asd successfully created.</h5></div>');
  setTimeout(function(){
    window.location.href= _config_base_url+'/profile/51';
  },260);

   }

  }
});
}
function vote_init(_element){
  _id_asd = _element.attr('name');
  _id_user = _element.attr('id');
 if(_element.hasClass('active')){

   vote_less(_id_asd,_id_user);
 }else{
  vote_plus(_id_asd,_id_user);
 }

}

function vote_plus(_id_asd,_id_user){
  $.ajax({
    type:'POST',
    url:_config_base_url+'/votes/vote_plus',
    dataType:'json',
    data:{'id_user':_id_user,'id_asd':_id_asd},
    error:function(){
   $('.ajax-loading').hide();
    },
    beforeSend:function(){
    $('.ajax-loading').show();
    },
    success:function(json){
    $('.ajax-loading').hide();

    }
  });
}
function vote_less(_id_asd,_id_user){
  $.ajax({
    type:'POST',
    url:_config_base_url+'/votes/vote_less',
    dataType:'json',
    data:{'id_user':_id_user,'id_asd':_id_asd},
    error:function(){
   $('.ajax-loading').hide();
    },
    beforeSend:function(){
    $('.ajax-loading').show();
    },
    success:function(json){
    $('.ajax-loading').hide();

    }
  });
}
function init_favourite(_element){
_id_asd = $(_element).attr('id');
_id_user = $(_element).attr('name');

 if(_element.hasClass('active')){
  $(_element).removeClass('active');
   remove_favourite(_id_asd,_id_user);
 }else{
  $(_element).addClass('active');
  add_favourite(_id_asd,_id_user);

 }
}

function add_favourite(_id_asd,_id_user){
$.ajax({
  type:'POST',
  url:_config_base_url+'/favourites/add',
  data:{'id_asd':_id_asd,'id_user':_id_user},
  dataType:'json',
  error:function(){
   $('.ajax-loading').hide();
    },
    beforeSend:function(){
    $('.ajax-loading').show();
    },
    success:function(json){
    $('.ajax-loading').hide();

    }

});
}
function remove_favourite(_id_asd,_id_user){
$.ajax({
  type:'POST',
  url:_config_base_url+'/favourites/remove',
  data:{'id_asd':_id_asd,'id_user':_id_user},
  dataType:'json',
  error:function(){
   $('.ajax-loading').hide();
    },
    beforeSend:function(){
    $('.ajax-loading').show();
    },
    success:function(json){
    $('.ajax-loading').hide();

    }

});
}

     /* $('#nav-search').css('color','#fff');
      $('#nav-search').on('focusin',function(){
         $(this).css({'box-shadow':'0px 0px 10px 0px #000','border':'1px solid trasparent','color':'#000','background':'#fff','opacity':'3'});

      });
      $('#nav-search').keydown(function(e){
       var _keywords = $(this).val();
       /* ONLY WHEN ENTER KEY*/
       /*if(e.which === 13){
        if(_keywords.length > 0 ){
       SiteSearch(_keywords,_page=1);
       }
     }
       });*/

/*
function SiteSearch(_keywords,_page){
$.ajax({
 type:'POST',
 url:_config_base_url+'/search/ajax_search',
 data:{'keywords':_keywords,'page':_page},
 dataType:'json',
 error:function(){},
 beforeSend:function(){},
 success:function(json){
    if($('#home-decore').is(':visible')){
    $('#home-decore').fadeOut(300,function(){
     $('#wrapper').hide().html(json.view).fadeIn(300);
    });
 }else{
     $('#wrapper').hide().html(json.view).fadeIn(300);
 }

 }
});

}*/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:59:30.450

`$("* >");`在控制台中运行。你会得到以下错误

```
"Syntax error, unrecognized expression: >" 
```

你想用表达式得到 `$("* >")`什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:48:07.020

我发现了问题，它在行中：

```
 $("* >").tooltip({ 
```

它需要

```
 $("*").tooltip({ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-04T10:11:50.433

为什么不为需要工具提示的每个元素分配一个类？

```
$('.needs_tooltip').tooltip({.... 
```

# wcf - WCF REST 4.0 WebClient 默认端点设置超时

> ID：12475240
> 
> 赞同：1
> 
> 时间：2012-09-18T10:33:42.760
> 
> 标签：wcf, rest, webclient

我正在使用 WCF REST 4.0 默认端点配置，在客户端上我使用的是 WebClient。无论如何要为 WebClient 配置新的超时值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:42:17.760

我已经使用了一个在[这里](http://w3ka.blogspot.fr/2009/12/how-to-fix-webclient-timeout-issue.html)找到的自定义类。

```
public class MyWebClient: WebClient
{
   //time in milliseconds
    private int timeout;
   public int Timeout
   {
           get {
               return timeout;
           }
           set {
               timeout = value;
           }
    }

    public MyWebClient()
    {
           this.timeout = 60000;
    }

     public MyWebClient(int timeout)
    {
           this.timeout = timeout;
    }

    protected override WebRequest GetWebRequest(Uri address)
     {
           var result = base.GetWebRequest(address);
           result.Timeout = this.timeout;
           return result;
    }
} 
```

大体思路是覆盖内部WebRequest的超时时间。伟大的 ！

# java - 从时间间隔中排除 2 月 29 日

> ID：12475248
> 
> 赞同：5
> 
> 时间：2012-09-18T10:34:09.203
> 
> 标签：java, date, jodatime

我想从计算两个日期之间的完整天数中排除 2 月 29 日。不包括区间的角值。

测试场景：

```
1 March 2012 - 28th February 2012  = should give 0 days.
1 March 2012 - 26th February 2012  = should give 2 days.
1 March 2013 - 28th February 2012  = should give 365 days and not 366 days.
1 March 2017 - 28th February 2012  = should give 365*5 =1825 days and not 1827 days. 
```

目前我解析年份并检查日期之间是否有闰年，然后检查间隔是否为 2 月 29 日。有没有办法计算任何特定的时间间隔是否有特定的日期和发生次数，如果时间间隔跨越多年。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-27T10:27:54.330

以下 Java 风格的伪代码应该可以工作。如果您愿意，它还允许您添加其他过滤器：

```
int daysExcludingLeapYearDay(Date start, Date end)
{
    if(end.isBefore(start))
    {
        return filterOutLeapYearDays(daysBetween(end, start)).size();
    }

    return filterOutLeapYearDays(daysBetween(start, end)).size();
}

List<Date> filterOutLeapYearDays(List<Date> days)
{
    List<Date> daysExcludingLeapYearDays = 
             days
             .filter(d -> !isFeb29(d))
             .toList());

    return daysExcludingLeapYearDays;
}

List<Date> daysBetween(Date start, Date end) 
{
    List<Date> days = new List();

    for (Date day = start; day.isBefore(end); day = day.plusOneDay()) 
    {
        days.add(day);
    }

    return days
}

boolean isFeb29(Date date) 
{
    return date.month == FEBRUARY && date.day == 29;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:18:40.827

但它不是由 2 月 29 日引起的，它是正确的。

如果您比较 2012 年 3 月 1 日和 2012 年 2 月 28 日将返回 1 天，而 29th 将返回 2 天。这两个日期之间的差异是一天。

要返回 0 天，您应该比较两个相同的日期，例如 2012 年 3 月 1 日和 2012 年 3 月 1 日。

我想你误会了^^。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T13:28:23.480

我听说过 360 天年，但这是我第一次遇到 365 天年。

最好的办法是以天为单位计算日期之间的差异，并减去您遇到的所有 2 月 29 日。

这意味着您需要一个例程来遍历您的日期范围并返回您遇到的 2 月 29 日的数量。

我不知道如何在 JodaTime 中做到这一点，但基本算法是

*   将开始日期转换为自 1970 年 1 月 1 日以来的天数。
*   将结束日期转换为自 1970 年 1 月 1 日以来的天数。
*   一次从开始日循环到结束日。
*   将循环日转换回日期。
*   如果日期是 2 月 29 日，计数器加 1
*   完成循环后，返回计数器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-28T22:32:17.210

使用 javascript，您可以按如下方式实现它，其中`startDate`和`endDate`是 javascript`Date`对象。

```
function calculateDays(startDate,endDate){
    var oneDay = 86400000; //ms per day
    var difference = Math.ceil((endDate.getTime() - startDate.getTime()) / oneDay); 
    var totFeb29s = findTotalFeb29s(startDate,endDate);
    return  parseInt(difference)+parseInt(1)-parseInt(totFeb29s);    
}    
function findTotalFeb29s(startDate,endDate){
    var totalFeb29s = 0;
    var startYear = startDate.getFullYear();
    var endYear = endDate.getFullYear();
    for(var year=startYear;year<=endYear;year++){
        var dt = new Date(year, 1, 29);
        var isLeap = dt.getMonth() == 1;
        if(isLeap==true && startDate<=dt && dt<=endDate){
           totalFeb29s = parseInt(totalFeb29s)+parseInt(1);
        }
    }
    return totalFeb29s;
} 
```

# delphi - 如何创建无模式对话框并在用户单击确定时将其关闭？

> ID：12475252
> 
> 赞同：1
> 
> 时间：2012-09-18T10:34:16.303
> 
> 标签：delphi

用户坚持为应用程序中的每个“重要事件”提供一个弹出框。在备忘录或列表框中添加一行是不可接受的。

我不能使用标准模式框，因为 PC 经常无人看管，我的应用程序将等待用户单击“确定”，然后再继续。

我可以动态地创建一个带有备忘录组件和 OK 按钮的表单并传递一些文本以显示在备忘录中吗？

我试过了，当点击确定时我遇到了访问冲突。

问题：

*   是否需要启动线程来显示表单，因为它是无模式显示的？
*   我应该传递什么作为构造函数参数（prent）？无，因为形式会自我毁灭？
*   当用户单击确定时，我应该怎么称呼？关闭（）或免费（）？单击“确定”后，其中任何一个都会在大约 1/2 秒后出现访问冲突，但如果我在函数中什么都不做，代码运行良好（当然，内存泄漏）

谷歌并没有那么有用，因为表单应该自我毁灭，而示例却让其创建者破坏它。

* * *

主要形式：

```
 theDialogForm := TDialogFormForm.Create(Nil);
     theDialogForm.ShowTheForm('Database error '+#13+#10+''+#13+#10+
                E.ClassName+#13+#10+
                E.Message); 
```

和对话框形式...

```
unit fDialogForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TDialogFormForm = class(TForm)
    Memo1: TMemo;
    OkButton: TButton;
    procedure OkButtonClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
      procedure ShowTheForm(const theMessage : String);
  end;

implementation

{$R *.dfm}

// +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
procedure TDialogFormForm.FormCreate(Sender: TObject);
begin
   Visible := False;
end;

// +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
procedure TDialogFormForm.OkButtonClick(Sender: TObject);
begin
//   Close();
   Free();
end;

// +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
procedure TDialogFormForm.ShowTheForm(const theMessage : String);
begin
   Memo1.Text := theMessage;
   Show();
end;

end. 
```

* * *

调用栈

```
main thread ($630):
005164e3 +013 StoreRoom.exe Vcl.Controls          TControl.WMLButtonUp
00515b30 +2d4 StoreRoom.exe Vcl.Controls          TControl.WndProc
0051a47b +5b3 StoreRoom.exe Vcl.Controls          TWinControl.WndProc
00537bf0 +06c StoreRoom.exe Vcl.StdCtrls          TButtonControl.WndProc
00519ad0 +02c StoreRoom.exe Vcl.Controls          TWinControl.MainWndProc
0048dea4 +014 StoreRoom.exe System.Classes        StdWndProc
76677885 +00a USER32.dll                          DispatchMessageW
005b7c63 +0f3 StoreRoom.exe Vcl.Forms             TApplication.ProcessMessage
005b7ca6 +00a StoreRoom.exe Vcl.Forms             TApplication.HandleMessage
005b7fd9 +0c9 StoreRoom.exe Vcl.Forms             TApplication.Run
00823616 +17a StoreRoom.exe StoreRoom      56 +24 initialization
75c43398 +010 kernel32.dll                        BaseThreadInitThunk 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T10:45:06.667

要关闭表单，您可以

*   通过在 OnClose 事件中调用`Close`并设置操作来关闭它`caFree`
*   call `Release`，这是 Free 的一种特殊风格，尤其适用于表单。

调用`Free`, 的问题是表单被立即释放，而您仍在处理关闭按钮上的单击事件。在该过程中，表单和按钮被释放，导致访问冲突。`Release`在内部向表单发送一条消息，导致它在处理点击*后*关闭。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T10:48:26.707

1.  您不需要线程来显示表单。但是，由于表单应该保持可见，我建议您将其设置`FormStyle`为`fsStayOnTop`
2.  由于您正在销毁表单，因此您可以传递`nil`给`Create()`
3.  要销毁您的表单，请调用`Close`和 在您的表单`OnClose`事件中，设置`Action`为`caFree`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T12:17:40.103

为什么不让自己轻松一点，制作一个看起来像对话框的不可见面板，当重要事件发生时变得可见，而当用户单击确定时不可见？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T12:04:02.553

> 是否需要启动线程来显示表单，因为它是无模式显示的？

VCL 不是多线程的。您应该始终在主线程中运行表单。你*也许*可以在额外的线程中调用 Win32 API ShowMessageBox，不知道，但只针对单个消息。无法将事件累积到 TMemo 或网格中。

> 我应该传递什么作为构造函数参数（prent）？

我会通过应用程序，但这没什么大不了的。

> 当用户单击确定时，我应该怎么称呼？关闭（）或免费（）？

两者都没有，没有必要创建/删除表单。只有当您可以拥有同一类的多种形式时，它才有意义。这一次，只需让 Delphi 在程序启动/结束时自动创建和自动处理它。

您只应该显示或隐藏它。手动创建和处理没有意义。

* * *

现在，关于线程 - 为什么要完全阻止您的应用程序？使该窗口 AlwaysOnTop，然后使用[TApplication.OnActivate](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/tapplication.onactivate.html)事件来检查用户何时切换到它并将该窗口带到屏幕/主窗体的前面和中心。这样用户就会看到它。

*或者，您可以尝试使用 Snarl 等带有消息永不过期选项的 3rd 方通知工具。*

# css - Heroku 上的 twitter-bootstrap-rails：Glyphicons 显示为正方形

> ID：12475253
> 
> 赞同：4
> 
> 时间：2012-09-18T10:34:19.173
> 
> 标签：css, ruby-on-rails, heroku, twitter-bootstrap, twitter-bootstrap-rails

我已经在 Heroku 上部署了一个 rails 应用程序，并且我正在使用 twitter-bootstrap-rails gem 来包含 twitter 引导程序。一切都在本地（和开发环境中）完美运行，但在 Heroku（和生产环境中）一切正常，除了 glyphicons，它们都显示为小方块。

起初我认为这是图标精灵未预编译的问题，因此在我的 gemfile 中，我将“gem twitter-bootstrap-rails”行移出资产组，并且我确定在上传之前预编译了所有资产到赫罗库。

然而，这并没有解决问题。检查页面后，图标似乎可用，但链接到它们的 CSS 属性被另一个将 background-image 设置为 none 的 CSS 规则覆盖。它似乎发生在作为 twitter bootstrap 一部分的样式表中，所以我不太确定为什么会发生这种情况。

有没有其他人有这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T07:20:29.553

修复。导致问题的 CSS：

```
[class^="icon-"], [class*=" icon-"] {
display: inline;
width: auto;
height: auto;
line-height: inherit;
vertical-align: baseline;
background-image: none;
background-position: 0% 0%;
background-repeat: repeat; 
```

是 Fontawesome 的一部分，它默认包含在 twitter-bootstrap-rails 中。问题是 Fontawesome 图标文件没有被预编译，因为它们是不寻常的文件类型。我进入 production.rb 环境文件，并在 config.assets.precompile 列表中添加了“ *.woff”、“.* *eot* ”、“.svg”、“. ttf” 。然后我重新编译了我的资产，图标出现了！繁荣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-30T11:17:17.773

我通过添加解决了这个问题`config/environments/production.rb`：

```
config.assets.precompile += %w( '.woff', '.eot', '.svg', '.ttf' ) 
```

我也有下一个字符串`Gemfile`，**没有 github 路径**：

```
gem 'twitter-bootstrap-rails' 
```

使用这种配置，Glyphicons 在 Heroku 上显示得很好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-19T19:40:03.753

在 bootstrap.css 文件中进行这些更改：

第 1174 行附近的某处：

```
-  background-image: url("../img/glyphicons-halflings.png");
+  background-image: image-url("glyphicons-halflings.png"); 
```

在第 1183 行附近的某个地方：

```
-  background-image: url("../img/glyphicons-halflings-white.png");
+  background-image: image-url("glyphicons-halflings-white.png"); 
```

我认为这会奏效。

# java - 多次使用输入流

> ID：12475259
> 
> 赞同：0
> 
> 时间：2012-09-18T10:34:41.677
> 
> 标签：java

```
for (File fileEntry : dir.listFiles()) {
    String strXMLFilename = null;
    strXMLFilename = fileEntry.getName();
    InputStream input = new FileInputStream(strXMLFilename);
    PostMethod post = new PostMethod();
    post.setRequestBody(input);
    .....
    .....
    .....
} 
```

当我的 for 循环运行时，`InputStream input = new FileInputStream(strXMLFilename);`这条线工作正常。但是，当它第二次进入 for 块时，这条线出现了问题。我希望输入流没有正确读取文件。我尝试关闭输入流，即使它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:36:11.090

如果您想多次阅读它，您应该在阅读 BufferedInputStream 后使用 reset 方法或使用我认为更合适的 byte[] ..

# mysql - 在输入字符串中用“/”替换 MySql 方法

> ID：12475265
> 
> 赞同：3
> 
> 时间：2012-09-18T10:35:01.557
> 
> 标签：mysql, sql

我有一个存储过程，它接受像这样的输入

```
myProcedure("Fashion,Sports", "Shirts, Pants", null, null , "0,100")

myProc( productType, Item, ProductID, costprice, minMaxQuantity); 
```

现在对于第一个参数，`myProcedure`创建一个类似的 mysql 查询

```
Select * from myTable where ProductType in ('Fashion,'Sports')
and Item in ('Shirts','Pants'); 
```

为了创建“in”语句部分，我使用 mysql 的“Repalce”方法

```
SET whrClause = REPLACE(productType, "," ," ',' "); 
```

这样我就可以做出正确的查询，甚至得到想要的结果。

但问题是，有时我在输入中得到

```
myProcedure("Adm/Husleie/Royalty,Fashion,Sports", "Shirts, Pants", null, null , "0,100"); 
```

现在对于第一个参数的第一部分（即`Adm/Husleie/Royalty`） Replace 方法无法正常工作。我没有得到结果`ProductType = Adm/Husleie/Royalty`，但对于时尚和体育，我得到了结果。有人能帮我吗。如何使用绝对字符串，也可以使用替换方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:37:04.443

试试这个：

将您的替换语句更改为

```
SET whrClause =REPLACE(REPLACE(productType, "," ," ',' "),"/" ," ',' "); 
```

# php - preg_split() 首字母姓氏的正则表达式

> ID：12475267
> 
> 赞同：0
> 
> 时间：2012-09-18T10:35:06.163
> 
> 标签：php, regex, preg-split

我有一个看起来像这样的名称模式：

FOO Bar
F. Oobar
FO Obar

我目前正在尝试开发一个正则表达式，它可以让我根据其中一个拆分名字，也许是首字母和姓氏。

```
foreach($authors as $author) {
    $arr = preg_split("/([a-zA-Z]. )+/", $author, -1, PREG_SPLIT_DELIM_CAPTURE);
    //Do stuff with $arr
} 
```

但是，这也会分裂`Foo. Bar`（或者准确地说`o.`）。问题是我不能只将它限制为小写，因为我收到的数据非常不一致，所以我不能依赖这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:38:06.603

`.`必须逃脱。

```
$arr = preg_split("/([a-zA-Z]\. )+/", $author, PREG_SPLIT_DELIM_CAPTURE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:37:16.937

你的意思是你只想在点之前允许一个字母？使用单词边界来确保这一点：

```
$arr = preg_split("/\b([a-zA-Z]\. )+/", $author, PREG_SPLIT_DELIM_CAPTURE); 
```

此外，正如错误正确指出的那样，点需要转义。

# javascript - 变量不会从 AJAX 函数返回

> ID：12475269
> 
> 赞同：10
> 
> 时间：2012-09-18T10:35:22.050
> 
> 标签：javascript, jquery, ajax

随着我的框架的增长，我决定将其拆分为文件，而不是将其留在主设计文件中。但是，通过这样做，函数的返回不会返回任何值。

数据不为空 - 如果我提醒 js 文件中的值，它们就在那里！

功能：

.js 文件中的第一个函数（在执行之前包含）

```
 var lock_get = 0;
             function get_data(data, destination) 
             {

                if (lock_get == 0)
                {
                    lock_get = 1;
                    $.ajax({
                        type: "POST",
                        url: destination,
                        async: true,
                        data: data,
                        success: function(data) 
                        {
                            lock_get = 0;
                            if (data)
                            {
                                return data;
                            }
                        }
                    });
                }
             }; 
```

所以这里是执行部分：

```
 var test = get_data(data, destination);
    notice(test); 
```

并且测试是空的...我已经尝试了不同的写作方式，但我想我误解了 js 的可能性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T10:36:16.637

你不能这样做：由于调用是异步的，get_data 函数不能返回 ajax 调用的结果。

您应该做的是为 get_data 函数提供回调并在回调中处理结果。

```
function get_data(data, destination, callback) 
         {

            if (lock_get == 0)
            {
                lock_get = 1;
                $.ajax({
                    type: "POST",
                    url: destination,
                    async: true,
                    data: data,
                    success: function(data) 
                    {
                        lock_get = 0;
                        if (data && callback)
                        {
                            callback(data);
                        }
                    }
                });
            }
         }; 
```

并这样称呼它：

```
get_data(data, destination, function(test){
   notice(test);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-02T15:14:15.173

或者，您可以从同步 AJAX 调用返回，使用同步调用通常是个坏主意，但有时它可能很有用：

[http://pratyush-chandra.blogspot.com/2012/04/store-ajax-json-response-into.html](http://pratyush-chandra.blogspot.com/2012/04/store-ajax-json-response-into.html)

# mysql - 如何使用 OR、AND 子句改进查询？

> ID：12475275
> 
> 赞同：0
> 
> 时间：2012-09-18T10:35:44.543
> 
> 标签：mysql

如何使用 OR、AND 子句改进查询？

```
explain 
       select fileds 
       from table_name 
       where (fldlp>='2012-09-15 13:00:34' and fldlp<='2012-09-16 06:00:02') 
    or (flexp>='2012-09-15 13:00:34' and flexp<='2012-09-16 06:00:02');

+----+-------------+------------+------+---------------+------+---------+------+---------+-------------+
| id | select_type | table      | type | possible_keys | key  | key_len | ref  | rows    | Extra       |
+----+-------------+------------+------+---------------+------+---------+------+---------+-------------+
|  1 | SIMPLE      | table_name | ALL  | NULL          | NULL | NULL    | NULL | 2928790 | Using where | 
+----+-------------+------------+------+---------------+------+---------+------+---------+-------------+ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T10:37:57.367

您可以使用[`BETWEEN`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between)子句。

```
WHERE (fldlp BETWEEN '2012-09-15 13:00:34' AND '2012-09-16 06:00:02') 
   OR (flexp BETWEEN '2012-09-15 13:00:34' AND '2012-09-16 06:00:02'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T10:41:45.490

改进的技巧

*   `fldlp`在和上创建索引`flexp`

*   上述列的数据类型应为**dateTime**

# html - 图像上的 onclick 属性以更改图像并调用函数

> ID：12475278
> 
> 赞同：0
> 
> 时间：2012-09-18T10:35:57.407
> 
> 标签：html, events

```
<script type = "text/javascript">
function functionCall(){
...
}
</script> 
```

* * *

```
<input type="image" src="uri1.png" onclick="this.src='uri2.png'"/> 
```

**这适用于更改 onclick 事件的图像**

```
<input type="image" src="uri1.png" onclick="functionCall"/> 
```

**这适用于调用函数**

> 我如何使函数调用和图像更改同时发生在同一个 onclick 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:55:31.073

您可以通过用 ; 分隔来添加多个操作

`onclick="this.src='uri2.png'; functionCall()"`

# c++ - 在 Windows XP 中获取执行进程的完整路径

> ID：12475284
> 
> 赞同：0
> 
> 时间：2012-09-18T10:36:15.917
> 
> 标签：c++, windows-xp

所以我需要获取在计算机上运行的进程列表，然后获取每个进程的完整路径。（我正在寻找每个进程运行的文件夹）。我正在使用 QueryFullProcessImageName - [http://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx)但是我刚刚发现这段代码需要在 Windows XP 上运行并且功能最低的客户端是Vista。

那么有人知道这样做的另一种方法吗？

我试图使用 GetModuleFileNameEx 但它不起作用。我会传入进程句柄，然后我会在输出中返回“íííííííííííííííííííííííííííííííííííííííí”。

编辑：这是我尝试使用 GetModuleFileNameEx：

```
HANDLE hProcessSnap;
PROCESSENTRY32 pe32;
string name = procName;

// Take a snapshot of all processes in the system.
hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
if (hProcessSnap == INVALID_HANDLE_VALUE)
{
    REPORT_ERROR("CreateToolhelp32Snapshot (of processes): err=%d\n", ::GetLastError());
    return false;
}

// Set the size of the structure before using it.
pe32.dwSize = sizeof(pe32);

// Retrieve information about the first process,
// and exit if unsuccessful
if( !Process32First(hProcessSnap, &pe32))
{
    REPORT_ERROR("Process32First: err=%d\n", ::GetLastError());  // Show cause of failure
    CloseHandle(hProcessSnap);     // Must clean up the snapshot object!
    return false;
}
char pName[MAX_PATH];

//iterate through all processes
do {
    //Find start of files name
    char *szProcessFilename = strchr(pe32.szExeFile, '\\');
    if (szProcessFilename == NULL)
        szProcessFilename = pe32.szExeFile;
    else
        szProcessFilename++;    //Skip over last slash

    if (_stricmp(procName, szProcessFilename) == 0)
    {
        HANDLE hProcess = OpenProcess( PROCESS_QUERY_INFORMATION, false, pe32.th32ProcessID );
        char procLocationChar[MAX_PATH];
        DWORD exe_path_size = MAX_PATH;
        DWORD s = GetModuleFileNameEx(hProcess, NULL, pName, exe_path_size); 
```

在此之后我做了更多的事情来获取路径，但是 pName 的值只是“ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:49:38.063

要获取进程列表，您可以使用PSAPI 中的[EnumProcesses](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682629%28v=vs.85%29.aspx)函数。依次在生成的 PID 上使用[OpenProcess并在其句柄上使用](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684320%28v=vs.85%29.aspx)[GetModuleFileNameEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683198%28v=vs.85%29.aspx)来检索可执行文件名称。像这样的东西：

```
const size_t maxPids = 1024;

std::set<std::wstring> processes;

DWORD pids[maxPids] = {};
DWORD bytesReturned = 0;

if (::EnumProcesses(pids, sizeof pids, &bytesReturned))
{
    DWORD cProcesses = bytesReturned / sizeof *pids;

    // set SeDebug privilege

    for (DWORD i = 0; i < cProcesses; i++)
    {
        DWORD pid = pids[i];

        if (HANDLE hProcess = ::OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, pid))
        {
            WCHAR filename[MAX_PATH] = {};

            if (::GetModuleFileNameEx(hProcess, NULL, filename, MAX_PATH))
            {
                processes.insert(filename);
            }
            else
            {
                // handle error
            }

            ::CloseHandle(hProcess);
        }
        else
        {
            // handle error
        }
    }

    // disable SeDebug privilege
}
else
{
    // handle error
} 
```

请注意，有些进程无法打开（系统、空闲等）。您可能想先过滤它们或忽略错误。此外，根据系统环境，您可能需要特殊权限才能打开不是您创建的进程 (SeDebugPrivilege)，请参阅 OpenProcess 函数的文档。

# php - php-excel-reader 获取单元格注释

> ID：12475291
> 
> 赞同：0
> 
> 时间：2012-09-18T10:36:56.910
> 
> 标签：php, excel

我正在使用：

[http://code.google.com/p/php-excel-reader/](http://code.google.com/p/php-excel-reader/)

我想知道是否有可能获得单元格评论？文档似乎相当有限。有谁知道它是否已实现，或者如何修改类来实现它？

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:50:42.090

php-excel-reader 不读取单元格注释...注释存储在 SPREADSHEET_EXCEL_READER_TYPE_NOTE 块中，但读者只是跳过这些块。

如果您想修改 php-excel-reader 以读取单元格注释（例如注释），则需要创建一个 reader 块来处理工作表子流的 switch 块中的该选项。看看[PHPExcel](http://www.phpexcel.net)是如何读取单元格注释的，看看逻辑应该是什么（代码在/Classes/PHPExcel/Reader/Excel5.php文件中的_readNote()方法中），或者换个Excel库，其实可以无论如何都要阅读单元格注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T08:17:47.863

看这些帖子[无法阅读单元格评论](https://stackoverflow.com/questions/5276348/not-be-able-to-read-cell-comment)

它基本上说你可以很容易地得到你的评论。使用 getComment() 获取全部或 getComment('A1') 获取单个。

```
$objReader = PHPExcel_IOFactory::createReader('Excel2007');
$objPHPExcel = $objReader->load("first.xlsx");
$objWorksheet = $objPHPExcel->setActiveSheetIndex(0);
objWorksheet->getComment('A2');
objWorksheet->getComments(); 
```

# ldap - LDAP 用户存储 WSO2 ESB - 管理员用户名

> ID：12475295
> 
> 赞同：1
> 
> 时间：2012-09-18T10:37:08.810
> 
> 标签：ldap, wso2, wso2esb, esb, wso2carbon

您好，我需要一些帮助来为 WSO2 ESB 设置 LDAP 用户存储：我有我的 ldap 主机：`ldap://my.domain.ac.uk:389` basedn`dc=my,dc=domain,dc=ac,dc=uk` 用户名密码：`Name Surname` `mypassword`

我不知道如何成功配置`user-mgt.xml`WSO2 ESB 的文件，我得到“

```
LDAPUserStoreManager Carbon cannot function without an Admin Username 
```

`DefaultRealm Cannot create org.wso2.carbon.user.core.ldap.LDAPUserStoreManager . Error is : null`"

我对 ldap 的配置是：

```
<UserStoreManager class="org.wso2.carbon.user.core.ldap.LDAPUserStoreManager">
            <Property name="ReadOnly">true</Property>
            <Property name="MaxUserNameListLength">100</Property>
            <Property name="ConnectionURL">ldap://my.domain.ac.uk:389</Property>
            <Property name="ConnectionName">cn=Name Surname,ou=Users,dc=my,dc=domain,dc=ac,dc=uk</Property>
            <Property name="ConnectionPassword">mypassword</Property>
            <Property name="UserSearchBase">ou=Users,dc=my,dc=domain,dc=ac,dc=uk</Property>
            <Property name="UserNameListFilter">(objectClass=sAMAccountName)</Property>
            <Property name="UserNameAttribute">uid</Property>
            <Property name="ReadLDAPGroups">false</Property>
            <Property name="GroupSearchBase">ou=Users,dc=my,dc=domain,dc=ac,dc=uk</Property>
            <Property name="GroupNameListFilter">(objectClass=groupOfNames)</Property>
            <Property name="GroupNameAttribute">uid</Property>
            <Property name="MembershipAttribute">member</Property>
            <Property name="UserRolesCacheEnabled">true</Property>
        <Property name="ReplaceEscapeCharactersAtUserLogin">true</Property>
        </UserStoreManager> 
```

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T04:43:58.827

在 user-mgt.xml 中有以下配置元素，

```
<AdminUser>
    <UserName>admin</UserName>
    <Password>admin</Password>
</AdminUser> 
```

确保您的 LDAP 中有一个名为 admin 的用户。或者提供 LDAP 中存在的用户名。HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T04:45:43.677

您的广告中有 uid 属性吗？我之前看到过这个问题，它发生是因为具有此配置的 ESB 无法找到您在以下位置指定的用户：

```
<AdminUser>
    <UserName>admin</UserName>
    <Password>admin</Password>
</AdminUser> 
```

您的连接名称使用 cn = ..... 并且您尝试使用 uid 进行搜索！这是正确的配置？也许您可以发布 ldap 架构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T02:46:02.593

您必须包括以下内容：

```
<UserManager>
    <Realm>
    <Configuration>
            <AdminRole>LDAP_ADMIN_GROUP</AdminRole>
            <AdminUser>
                 <UserName>LDAP_USER</UserName>
                 <Password></Password>
            </AdminUser>
        <EveryOneRoleName></EveryOneRoleName> <!-- By default users in this role sees the registry root -->
        <Property name="dataSource">jdbc/WSO2CarbonDB</Property>
        <Property name="MultiTenantRealmConfigBuilder">org.wso2.carbon.user.core.config.multitenancy.SimpleRealmConfigBuilder</Property>
    </Configuration> 
```

其中 LDAP_ADMIN_GROUP 必须是 LDAP 服务器中存在的组，并且将在 WSO2 服务器中分配管理员权限。

LDAP_USER 必须属于前面提到的 LDAP_ADMIN_GROUP。您不需要提供密码，可以留空。

还要确保您配置的 Filter 和 SearchBase 正确，并且用户和组在该范围内。

您可以在此处找到更多详细信息：

[http://docs.wso2.org/wiki/display/ESB450/Configuring+External+User+Stores](http://docs.wso2.org/wiki/display/ESB450/Configuring+External+User+Stores)

# ruby-on-rails - 将 link_to 更改为 button_to 时出现“没有路线匹配 [POST]”

> ID：12475299
> 
> 赞同：17
> 
> 时间：2012-09-18T10:37:20.027
> 
> 标签：ruby-on-rails, button, hyperlink

我有这段代码：

```
<%= link_to "New User", new_user_path, :class => "button"  %><br /> 
```

效果很好，但是当我将其更改为

```
<%= button_to "New User", new_user_path, :class => "button"  %><br /> 
```

我收到这个错误

> 没有路线匹配 [POST] "/users/new"

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-18T10:48:23.120

Jesus Rodriguez 对 POST 和 GET 的看法是正确的，但如果您真的需要按钮，您可以简单地覆盖默认方法：

```
<%= button_to "New User", new_user_path, :class => "button", :method => :get  %> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-18T10:43:14.230

“link_to”正在寻找*/users/new*使用**GET**。

“button_to”正在使用**POST**寻找*/users/new*

 **如果您使用以下方法为控制器创建路由：

```
resources :user 
```

默认情况下，*/users/new*是**GET**而不是**POST**，因此第二行找不到任何路由。

如果您正在考虑将该操作更改为**POST**，我认为您应该忘记它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T10:47:13.963

button_to 默认为 POST，link_to 默认为 GET，这就是 links_to 起作用的原因。您可以强制 button_to 使用 GET：

```
<%= button_to "New User", new_user_path, :class => "button", :method => :get %> 
```

您可以在此处获取有关 button_to 选项的更多信息：http: [//api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-25T05:25:42.037

除了强制 button_to 使用非默认方法，您还可以向 link_to 发送一个类。

```
<%= link_to "New User", new_user_path, :class => "button" %> 
```**

# jquery - jquery ajax 请求导致 IllegalStateException: getOutputStream()

> ID：12475306
> 
> 赞同：2
> 
> 时间：2012-09-18T10:37:39.393
> 
> 标签：jquery, ajax, spring, jackson

我有一个 spring portlet mvc 应用程序。我有一个 jsp，它使用 Ajax 请求向资源 URL 发出 GET 请求，然后使用 Spring Jackson 映射器（MappingJacksonJsonView）类返回 json。GET 请求非常慢，可能需要几秒钟才能执行。我注意到一个用例；

1.  我在我的应用程序中单击 AJAX 提交链接
2.  我在请求完成之前刷新页面
3.  我重复上面的步骤
4.  我的服务器日志开始抛出非法状态异常

    原因：java.lang.IllegalStateException: getOutputStream() 已经在 org.apache.catalina.connector.Response.getWriter(Response.java:611) at org.apache.catalina.connector.ResponseFacade.getWriter (ResponseFacade.java:198) 在 javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:112)

因为 Spring 负责创建和删除输出读取器和写入器，所以我无法捕获非法异常，所以我发现很难隔离确切问题发生的位置。

任何建议或帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:56:24.010

答案 - 发生了以下情况。我想我可以把它归结为一个低影响的问题。

当浏览器打开一个 Socket 并发出 Ajax 请求时会发生这种情况，但是它会在接收到来自服务器的响应之前终止打开的 Socket（通过关闭浏览器或移动到另一个页面）。与此同时，服务器正在处理请求并尝试将输出写回浏览器，但是浏览器已经关闭了 Socket 并继续前进。

# c# - MVC3 应用程序中的只读用户权限，更改最少

> ID：12475308
> 
> 赞同：5
> 
> 时间：2012-09-18T10:37:42.710
> 
> 标签：c#, asp.net-mvc-3, architecture, filter, readonly

我的任务是为我们的 ASP.Net MVC3 应用程序创建一个只读用户。即他们可以登录，查看所有数据，但不能更新任何数据。

我已经阅读了很多身份验证文章/框架，例如：[实现安全的 ASP.NET MVC 应用程序](http://www.codeproject.com/Articles/288631/Secure-ASP-NET-MVC3-applications)，或[流畅的安全配置](http://www.marius-schulz.net/blog/securing-an-aspnet-mvc-application-using-fluentsecurity)，或[在 ASP.Net MVC 中创建操作过滤器](http://www.codeguru.com/csharp/article.php/c18959/Creating-Custom-Action-Filters-in-ASPNET-MVC.htm)（以及其他一些，我已经失去了链接） .

大多数方法的问题是它们需要对域/应用程序进行重大更改。而且我只有**一天时间**来实现这个功能。

我们有大约 100 个控制器，每个控制器平均有 4 个操作（主要是 CRUD 操作），并且遍历每个控制器是不可能的。此外，很容易忘记在新代码上添加属性 - 引入错误。

到目前为止，我已经提出了全局过滤器，它拒绝所有基于 POST 的操作和为只读用户称为“创建”的控制器操作：

```
public class ReadOnlyFilter : IActionFilter 
{

    public void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var currentUser = HttpContext.Current.User;
        if (currentUser == null || !currentUser.Identity.IsAuthenticated)
            return; // user is not logged in yet

        if (!currentUser.IsInRole("Readonly")) 
            return; // user is not read-only. Nothing to see here, move on!

        // Presume User is read-only from now on.

        // if action is of type post - deny
        if (filterContext.HttpContext.Request.HttpMethod.ToUpper() == "POST")
        {
            filterContext.HttpContext.Response.Redirect("~/ReadOnlyAccess");
        }

        // if action is "Create" - deny access
        if (filterContext.ActionDescriptor.ActionName == "Create")
        {
            filterContext.HttpContext.Response.Redirect("~/ReadOnlyAccess");
        }

        // if action is edit - check if Details action exits -> redirect to it.
        //TODO get this done ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

        return;
    }

    public void OnActionExecuted(ActionExecutedContext filterContext)
    {
        // blah! have to have this here for IActionFilter
    }
} 
```

接下来我计划为发布操作创建属性 [AllowReadOnlyUser]，例如更改密码/电子邮件，并在过滤器中允许该操作通过。

我想知道是否有更好的方法来做这种事情？

*更新*：该应用程序不供公众使用。它在企业界用于跟踪人员、资产和其他无聊的数据。

**更新 2**：我似乎已经完成了这项任务。开始时作为控制器完成。[您可以在我的博客中看到](http://tech.trailmax.info/2012/09/read-only-user-in-mvc3-with-minimal-changes/)完整的代码和一些解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:56:15.760

您可以将 System.Web.Mvc.AuthorizeAttribute 用于您的目的。创建一个派生自 AuthorizeAttribute 的类并重写 AuthorizeCore 和 HandleUnauthorizedRequest 方法。在 AuthorizeCore 中，您确定是否允许用户执行操作，在 HandleUnauthorizedRequest 中，您确定在不允许他时显示什么（例如，显示“NotAllowed”-View）。

创建自定义授权属性后，您必须将该属性添加到应受自定义授权保护的所有控制器操作。例如，所有 POST 方法。但是，如果所有用户都应该允许使用 POST 方法，那么您只需不将该属性添加到该控制器操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T12:44:20.363

你必须稍微调整一下，在有人告诉我之前，我 100% 意识到这是一个可怕的 hack。但它也非常有效并且实施得非常迅速，这是当时最重要的问题。当然，您需要通过一个 obsficator 来运行它。

如果需要，那里还有一些更新面板的东西必须被删除，或者更改为 jQuery ajax 响应结束挂钩或类似的东西。

哦，还有这个可以控制只为只读用户运行它：

```
if (isReadonly && !Page.ClientScript.IsClientScriptBlockRegistered("ReadonlyScriptController"))
{
this.Page.ClientScript.RegisterStartupScript(this.GetType(), 
  "ReadonlyScriptController", "<script>RunReadonlyScript();</script>");
} 
```

脚本：

```
<script type="text/javascript" src="<%# Page.ResolveUrl("~/ClientScripts/jquery-1.4.2.min.js") %>"></script>
<script type="text/javascript">
    function RunReadonlyScript() {
        //Extend jquery selections to add some new functionality
        //namely, the ability to select elements based on the
        //text of the element.
        $.expr[':'].textEquals = function (a, i, m) {
            var match = $(a).text().match("^" + m[3] + "$");
            return match && match.length > 0;
        };
        //this function does all the readonly work
        var disableStuff = function () {

            //select all controls that accept input, save changes, open a popup, or change form state
            // ** customize this with your own elements **
            $('button, input:not(:hidden), textarea, select,
              a:textEquals("Clear Selection"), 
              a:textEquals("Add Message"), 
              a:textEquals("CCC EVAL"),
              a[id$="availLink"], 
              a[id$="lbtnDelete"], 
              a[id$="lbtnEdit"]')
                //disable input controls
                .attr('disabled', 'disabled')
                //remove onclick javascript
                .removeAttr('onclick')
                //remove all bound click events
                .unbind("click")
                //add a new click event that does nothing
                //this stops <a> links from working
                .click(function (e) {
                    e.preventDefault(); 
                    return false;
                });

            //zap some images with click events that we don't want enabled
            $('img[id$="imgCalendar1"], img[id$="imgDelete"]').hide();
        }
        //if we are loading the home page, don't disable things
        //or the user won't be able to use the search controls
        var urlParts = document.URL.split('/');
        var last2 = urlParts[urlParts.length - 2] + '/' + urlParts[urlParts.length - 1];
        if (last2 !== 'home/view') {
            //disable everything initially
            disableStuff();
            //setup a timer to re-disable everything once per second
            //some tab panels need this to stay disabled
            setInterval(disableStuff, 1000);
            //some pages re-enable controls after update panels complete
            //make sure to keep them disabled!
            Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(disableStuff);
            Sys.WebForms.PageRequestManager.getInstance().add_endRequest(disableStuff);
        }
    }
</script> 
```

# jquery - 我可以使用 jQuery 来包围一个元素吗 ?

> ID：12475321
> 
> 赞同：1
> 
> 时间：2012-09-18T10:38:17.263
> 
> 标签：jquery

我有以下 HTML：

```
<div id="modal" ><div class="modal-window">
<ul class="action-tabs right">
<li><a href="#" title="Close window">
<img src="/Content/images/icons/fugue/cross-circle.png" width="16" height="16"></a></li>
</ul>
<div class="block-content"><h1>xx</h1>
<div class="modal-content>
...
</div>
</div>
</div> 
```

我无法改变这种编码方式，但我需要有一个表单元素，从 h1 标题开始，到类“modal-content”的结束 div 结束。请注意，只有一个“块内容”和“模态内容”。

有没有一种使用 jQuery 的方法，我可以在表单标签中插入如下：

```
<div id="modal" ><div class="modal-window">
<ul class="action-tabs right">
<li><a href="#" title="Close window">
<img src="/Content/images/icons/fugue/cross-circle.png" width="16" height="16"></a></li>
</ul>
<div class="block-content"><h1>xx</h1>
<form id="xx">
<div class="modal-content>
...
</div>
</form>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T10:40:31.970

试试这个 ..

```
$(".modal-content").wrap("<form id='xx'>") 
```

有关更多选项，请参阅[http://api.jquery.com/wrap/](http://api.jquery.com/wrap/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:40:44.013

```
$('.modal-content').wrap('<form id="xx"></form>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:40:45.053

是的，使用包装功能之一：[http ://api.jquery.com/?s=wrap](http://api.jquery.com/?s=wrap)

```
$( '.modal-content' ).wrapAll( '<form />' ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T10:41:02.013

一个简单的例子

```
$(".modal-content").wrap('<form id="xx"></form>'); 
```

见[http://api.jquery.com/wrap/](http://api.jquery.com/wrap/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T10:41:53.993

是的，很容易：

```
$('.modal-content').wrap('<form id="xxx" />'); 
```

`.wrap()`在这里阅读更多：http: [//api.jquery.com/wrap/](http://api.jquery.com/wrap/)

# loops - Why does this IF statement not require an End IF

> ID：12475323
> 
> 赞同：3
> 
> 时间：2012-09-18T10:38:21.767
> 
> 标签：loops, if-statement, excel, vba

I am using the following snapshot of code to loop through files in a folder, it has a simple `If` to check if there are files in the folder then exits if there aren't. I've realised it does not require an `End If` at the end to compile correctly. However, I want to add a `msgbox` explaining why it has exited and to do so I need to introduce an `End If` to my code.

Why is that?

**Original Code**

```
If Len(strfilename) = 0 Then Exit Sub
    Do Until strfilename = ""
       'Do some stuff
    strfilename = Dir()
Loop 
```

**With MsgBox**

```
If Len(strfilename) = 0 Then
    MsgBox ("No Files Found")
    Exit Sub
Else
    Do Until strfilename = ""
        'Do some stuff
    strfilename = Dir()
    Loop
End If 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T10:44:46.990

There is a single line form of `if`:

```
if (expr) then X 
```

where `X` must be on the same *line*, which is nice for single expressions:

```
if 1=1 then exit sub 
```

or the odd but legal (using `:` continuation character)

```
if 1 = 1 Then MsgBox ("No Files Found"): Exit Sub 
```

which is better written using the more readable block form that requires an `end if` to tell the compiler when the `if` block ends:

```
if 1 = 1 Then 
   MsgBox ("No Files Found")
   Exit Sub
end if 
```

# ruby - 当字符串包含字母时 find() 不起作用（在本地主机上工作，而不是在服务器上

> ID：12475325
> 
> 赞同：0
> 
> 时间：2012-09-18T10:38:34.330
> 
> 标签：ruby, ruby-on-rails-3, activerecord

我目前有一个模型`Books`，它存储包括书的`isbn`.

我使用这种方法搜索书籍（实际上只使用他们的 ISBN）

```
def self.search(search)
 search_condition = "%" + search.downcase + "%"
 find(:all, :conditions => ['(isbn LIKE ? OR lower(title) LIKE ? OR lower(author) LIKE ? OR lower(edition) LIKE ? OR lower(publisher) LIKE ?) AND removed_on IS NULL', search_condition, search_condition, search_condition, search_condition, search_condition])
end 
```

困扰我的是，在我的本地机器上，如果我搜索“076374591X”，我会得到所有带有该 ISBN 的书籍，但在我在 Heroku 上的应用程序上它不会返回任何内容。我尝试删除“X”，只搜索“076374591”，这对两者都有效。就好像 ISBN 中的“X”打破了它（但仅在服务器上）。

注意`isbn`是一个`:string`。

什么可能导致此问题，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:13:57.853

您按 ISBN 区分大小写，但首先按小写搜索词进行搜索。所以你应该找到“076374591x”，而不是“076374591X”。

也尝试降低 isbn：

```
find(:all, :conditions => ['(lower(isbn) LIKE ? OR lower(title) ... 
```

# list - 如何每 10 秒刷新一次 Magento 产品列表

> ID：12475330
> 
> 赞同：0
> 
> 时间：2012-09-18T10:38:45.867
> 
> 标签：list, magento, product

我正在尝试在 magento 中每 10 秒刷新一次产品列表。

```
<script>
function AutoRefresh(){
    var xmlHttp;
    try{
      xmlHttp=new XMLHttpRequest();// Firefox, Opera 8.0+, Safari
    }
    catch (e){
      try{
        xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
      }
      catch (e){
        try{
          xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch (e){
          alert("No AJAX");
          return false;
        }
      }
    }

    xmlHttp.onreadystatechange=function(){

      if(xmlHttp.readyState==4){
        document.getElementById('products-grid').innerHTML=xmlHttp.responseText;
        setTimeout('AutoRefresh()',10000); // JavaScript function calls AutoRefresh() every 3 seconds
      }
    }
    xmlHttp.open("GET","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB)?>list-response.php",true);
    xmlHttp.send(null);
  }

  AutoRefresh();

</script> 
```

但是如何将值发布到特定页面我的意思是我正在发送到这个页面

```
xmlHttp.open("GET","<?php echo Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB)?>list-response.php",true); 
```

但这是不正确的。有人告诉我如何使用 magento 每 10 秒刷新一次产品列表页面。

谢谢

# java - Java日期到excel日期表示

> ID：12475331
> 
> 赞同：1
> 
> 时间：2012-09-18T10:38:52.903
> 
> 标签：java, excel, date, jodatime

我正在开发一个查询外部系统更新的工具，该查询基于更新时间值，该更新时间值表示为 Excel 内部日期表示，至少以秒为单位。

例如：

```
18-September-2012 00:00:01.000  41170.0000115741
18-September-2012 01:00:00.000  41170.0416666667 
```

我需要将 java 日期（目前我正在使用 JodaTime，但这没什么大的区别）转换为这个内部 Excel 日期表示。我花了很多时间尝试使用我在 Google 上搜索的许多资源来理解 Excel 内部日期表示。它完美地适用于天，但是当我试图分别计算分形到秒时，它变得难以理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:53:10.203

Excel 时间只是一天的一小部分。所以 1 hr = `1/24`, 1 sec =`1/86400`等等。任何不精确都是由于浮点数学的限制。

# android - 片段中的Android空指针异常

> ID：12475334
> 
> 赞同：-2
> 
> 时间：2012-09-18T10:39:27.007
> 
> 标签：android

我正在使用`ViewPager`带有片段。当屏幕方向更改为横向时，我得到一个**空指针异常。横向使用了不同的布局**

例外是：

```
android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871) 
```

任何帮助将非常感激

堆栈跟踪：-

```
09-18 20:31:02.770: E/AndroidRuntime(32205): FATAL EXCEPTION: main
09-18 20:31:02.770: E/AndroidRuntime(32205): java.lang.RuntimeException: Unable to start activity ComponentInfo{inc.mine.Customtracker/inc.mine.Customtracker.TabsActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{inc.mine.Customtracker/inc.mine.Customtracker.ChartActivity}: java.lang.NullPointerException
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2202)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2237)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3806)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.access$700(ActivityThread.java:139)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1266)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.os.Looper.loop(Looper.java:156)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.main(ActivityThread.java:5005)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at java.lang.reflect.Method.invokeNative(Native Method)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at java.lang.reflect.Method.invoke(Method.java:511)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at dalvik.system.NativeStart.main(Native Method)
09-18 20:31:02.770: E/AndroidRuntime(32205): Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{inc.mine.Customtracker/inc.mine.Customtracker.ChartActivity}: java.lang.NullPointerException
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2202)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1992)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:135)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:347)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:706)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.widget.TabHost.setCurrentTab(TabHost.java:350)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.widget.TabHost.addTab(TabHost.java:240)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at inc.mine.Customtracker.TabsActivity.addTab(TabsActivity.java:59)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at inc.mine.Customtracker.TabsActivity.setTabs(TabsActivity.java:36)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at inc.mine.Customtracker.TabsActivity.onCreate(TabsActivity.java:30)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.Activity.performCreate(Activity.java:4543)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2158)
09-18 20:31:02.770: E/AndroidRuntime(32205):    ... 12 more
09-18 20:31:02.770: E/AndroidRuntime(32205): Caused by: java.lang.NullPointerException
09-18 20:31:02.770: E/AndroidRuntime(32205):    at inc.mine.Customtracker.ChartFragment.onCreateView(ChartFragment.java:64)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1065)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.support.v4.app.FragmentManagerImpl.dispatchActivityCreated(FragmentManager.java:1844)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:519)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1195)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.Activity.performStart(Activity.java:4553)
09-18 20:31:02.770: E/AndroidRuntime(32205):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2175)
09-18 20:31:02.770: E/AndroidRuntime(32205):    ... 24 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T08:35:08.683

这很可能是由于错误的初始化。当你改变方向时，`Activity`会重新启动。您应该保存活动状态并恢复它。

# algorithm - 解决此问题所需的算法

> ID：12475335
> 
> 赞同：-3
> 
> 时间：2012-09-18T10:39:32.547
> 
> 标签：algorithm, shell, unix

假设我有一些分支代码，如下所示。

```
if condition 1
    code_line 1
    code_line 2
    more lines...
    if condition 2
        code_line 3
        code_line 4
        if condition 7   
            code_line 13
            code_line 14
        end if
        more lines...
    end if

    if condition 5
        code_line 6
        code_line 10
        more lines...
    end if
else
    code_line 7
    more lines...
end if 
```

我想要一种可以读取此代码并告诉我给定行的所有先决条件的方法。

例子：

1.  **code_line 4**在**条件 2**内，即在**条件 1**内。
2.  **code_line 7**在**条件 1**内。
3.  **code_line 14**在**条件 7**内部，在**条件 2**内部，在**条件 1**内部。

if-else 块可以无限次嵌套。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:40:49.807

首先，为您的语言构建或查找解析器。然后，解析您的语言，创建一个[抽象语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)。对于您的示例，它可能如下所示：

![在此处输入图像描述](../Images/545987997d705249f4ae718b6b90f429.png)

在树中，找到您要调查的代码。从那个节点开始，沿着树向上走，直到到达根节点。每次传递一个 IF 节点时，获取该节点的条件并打印它。

例如，您为**code_line 14**行走的路径如下所示：

![在此处输入图像描述](../Images/ef825b1785c50cd6fbc2bbc93b44caf7.png)

在行走时，您会遇到条件 7、2 和 1。

# iphone - 在核心图中配置轴

> ID：12475336
> 
> 赞同：2
> 
> 时间：2012-09-18T10:39:32.387
> 
> 标签：iphone, ios, core-plot

这是图形的屏幕截图...在此图中，y 轴的最小值为 0（原点），最大值为 700。我想将最小值设置为 500，最大值设置为 700。 ![这是图表](../Images/3b8ef192266ff2eafc8a8a56fcfb8b95.png)

如何实现？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:14:37.697

如果您正在使用核心情节，请尝试使用它

```
 CPXYPlotSpace *plotSpace = (CPXYPlotSpace *)graph.defaultPlotSpace;
 plotSpace.yRange = [CPPlotRange plotRangeWithLocation: 500 length:200   ]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T11:16:41.467

有2个步骤要做，

```
1\. Setting the orthogonalCoordinateDecimal, this is the point where your graph starts

   CPTXYAxis *y = axisSet.yAxis;
   y.orthogonalCoordinateDecimal = CPTDecimalFromFloat(500.0);

2\. Setting the plotRange, this is to determine where should the graph start and its range

   CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;   
   plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:500 length:200]; 
```

# php - foreach 数组在循环外不起作用

> ID：12475348
> 
> 赞同：-1
> 
> 时间：2012-09-18T10:40:18.387
> 
> 标签：php, mysql, arrays, loops, foreach

我试图在 foreach 循环之外获取数组的值，但它只给了我一个值而不是全部三个值；代码是这样的：

```
$user_id_worker = array();
    foreach ($query_result_worker as $row){
    $user_id_worker= $row['user_id'];
    var_dump($user_id_worker);
}

    var_dump($user_id_worker); 
```

第一个 var 转储给了我：

```
string '12747' (length=5)
string '12596' (length=5)
string '12759' (length=5) 
```

第二个（循环外）给了我：

```
string '12759' (length=5) 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:41:56.413

您正在替换它的值，而不是向您创建的数组添加值。

所以 $user_id_worker 变量只保存一个值。在循环之外，它是您放入的最后一个（循环的最后一次迭代）。

如果要将项目添加到循环内的数组中，请执行以下操作：

```
$user_id_worker[]= $row['user_id']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:44:08.863

你没有把它当作一个数组，你只有一个要更新的变量。

问题是这一行在`$user_id_worker = $row['user_id'];` 这里您**将值设置**为`$user_id_worker`行，然后在下一个循环中再次将其设置为不同的值。您没有将变量视为数组。

要添加到**数组**而不是替换旧值，您必须使用数组速记或数组推送，见下文。

使用数组速记的示例：

```
$user_id_worker = array();
    foreach ($query_result_worker as $row){
    $user_id_worker[] = $row['user_id'];
}

var_dump($user_id_worker); 
```

或使用[数组推送](http://php.net/manual/en/function.array-push.php "数组推送")：

```
foreach ($query_result_worker as $row){
    array_push($user_id_worker, $row['user_id']);
}

var_dump($user_id_worker); 
```

* * *

吉米的附加问题

> 快速提问，如果我在这个数组之后有一个函数并且我想在其中使用数组，show_assigned_tasks_workers($user_id_worker[]); 这只是行不通，我该怎么做？谢谢！– 吉米 17 分钟前
> 
> 它只是行不通，该函数也进行了选择，并且不知道该函数中的数组将如何，我认为只有当数据如下时它才会起作用：字符串'12747'（长度= 5） string '12596' (length=5) string '12759' (length=5) like strings ... – Jimmy 14 分钟前

您可能需要围绕您正在调用的函数执行一个 for each 循环（每个工作人员一个）。

执行以下操作：

```
foreach ($user_id_worker as &$workerId) {
  show_assigned_tasks_workers($workerId);
} 
```

它为每个用户运行一次该功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:42:47.027

您应该添加如下值：`$user_id_worker[] = "something"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T10:42:56.100

您正在为`$user_id_worker`每个循环传递分配一个新值。

如果要将所有值作为数组，则必须将值添加到该数组：

```
$user_id_worker[] = $row['user_id'];
// or:
array_push( $user_id_worker, $row['user_id'] ); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T10:43:09.237

以这种方式更改您的程序：

```
$user_id_worker = array();
    foreach ($query_result_worker as $row){
    $user_id_worker[] = $row['user_id'];
    var_dump($user_id_worker);
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-18T10:42:08.333

更正您的代码

```
$user_id_worker = array();
    foreach ($query_result_worker as $row){
    $user_id_worker[]=$row['user_id']; //Should give [] as ur appending to array
    var_dump($user_id_worker);
}

    var_dump($user_id_worker); 
```

# javascript - 用于 JavaScript 客户端代码的 npm

> ID：12475349
> 
> 赞同：6
> 
> 时间：2012-09-18T10:40:18.507
> 
> 标签：javascript, node.js, npm

我正在阅读有关[npm Developer Guide](https://npmjs.org/doc/developers.html)的文档。
我想知道是否可以使用 npm 使用 javascript/css/html 编写 Web 客户端应用程序？
如果是，github上有一些例子吗？

例如，我的客户端 Web 应用程序依赖于`requirejs, jquery, underscore and backbone`.
我可以使用`npm`自动下载供应商目录中的最新版本`requirejs, jquery, underscore and backbone`吗？
如果没有，是否有其他工具/方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T10:55:15.193

[Yeoman](http://yeoman.io/)使用名为[Bower](https://github.com/twitter/bower)的包管理器来管理依赖项 - Bower Github 页面提供了一个为项目下载 jQuery 的示例，因此这可能对您的项目有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:58:36.833

好的，现在你的问题变得清晰了。是的，你可以使用 NPM 来帮助你为前端开发 JavaScript。有很多工具可以让您的工作流程更加顺畅。我已经提到[了 jshint](https://github.com/jshint/node-jshint)和[uglifyjs](https://github.com/mishoo/UglifyJS)，但是你不得不[做](https://github.com/cowboy/grunt)一堆有用的任务，less 和 sass 编译器，而且不胜枚举。要在 CommonJS 中管理依赖项，您通常会使用[package.json](http://wiki.commonjs.org/wiki/Packages/1.0)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:06:48.873

一个例子是我的[Pretty Diff](http://prettydiff.com/)工具。它在客户端同样运行良好，我通过 NPM 分发它。无论环境如何，一个编写良好的 JavaScript 应用程序都可以在任何有 JavaScript 解释器的地方运行。实现这一点的方法是将应用程序代码与任何 API 分开。对于我的应用程序，我使用以下 API：

*   DOM——网络浏览器
*   WSH - Windows 命令行
*   Node.js - Node.js

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-18T10:47:54.590

**长版：**

npm 是 nodejs 使用的包的管理器，它是一个在服务器端运行 javascript 的程序。

你可以为nodejs开发自己的包并上传到npm，或者用它来安装别人发布的包，但这些只是nodejs的包，它是服务器端的，不是客户端的。所以不，你不能用 npm 来做你想要的。

**真正懒人的版本：**

不，因为 npm 是用于 nodejs 的，它是服务器端的，因此它与客户端应用程序无关。

我希望这回答了你的问题。

# jquery - jquery 验证远程错误 (async=false)

> ID：12475350
> 
> 赞同：3
> 
> 时间：2012-09-18T10:40:23.487
> 
> 标签：jquery, jquery-validate

我想我在 jquery 验证（bassistance）的远程规则功能中发现了一个错误。我用 jquery.validation 1.9.0 和 1.10.0 对其进行了测试。这是我的 HTML 和 JS：

```
<!DOCTYPE html>
<html lang="nl">
    <head>
        <meta charset="utf-8">
        <script src="jquery-1.7.1.min.js"></script>
        <script src="jquery.validate.js"></script>
    </head>
    <body>
        <script>
            $(document).ready(function() {
                window.validater = $("#SignUpForm").validate({
                    rules: {
                        "initials": {
                            required: true
                        },
                        "lastname": {
                            required: true
                        },

                        "phonenumber": {
                            required: true,
                            remote: { url: "/checkPhoneNumber.php", async:false }
                        }
                    },
                    messages: {
                        "initials": {
                            required: "U heeft uw voorletters niet ingevuld"
                        },
                        "lastname": {
                            required: "U heeft uw achternaam niet ingevuld"
                        },
                        "phonenumber": {
                            required: "U heeft uw telefoonnummer niet ingevuld",
                            remote: "U heeft geen geldig telefoonnummer ingevuld (formaat: +311230123456).",
                        }
                    }
                });
            });
        </script>
        <form enctype="" name="SignUpForm" method="POST" action="" class="fbForm " id="SignUpForm" novalidate="novalidate">
            <div class="fbElement fbTextfield ">
                <label for="initials">Voorletters <span class="require">*</span> </label>
                <input type="text" name="initials" value="" style="" title="" class="activePlaceholder" id="initials">
                <label class="error" generated="true" for="initials" style="display: none;"></label>
            </div>

            <div class="fbElement fbTextfield ">
                <label for="prefix">Tussenvoegsel </label>
                <input type="text" name="prefix" value="" style="" title="" class="activePlaceholder" id="prefix">
                <label class="error" generated="true" for="prefix" style="display: none;"></label>
            </div>

            <div class="fbElement fbTextfield ">
                <label for="lastname">Achternaam <span class="require">*</span> </label>
                <input type="text" name="lastname" value="" style="" title="" class="activePlaceholder" id="lastname">
                <label class="error" generated="true" for="lastname" style="display: none;"></label>
            </div>    

            <div class="fbElement fbTextfield ">
                <label for="phonenumber">Telefoonnummer <span class="require">*</span> </label>
                <input type="text" name="phonenumber" style="" value="+311230123456" class="activePlaceholder" id="phonenumber">
                <label class="error" generated="true" for="phonenumber" style="display: none;"></label>
            </div>

            <div style="" class="fbContainer  " id="navContainer">
                <button data-loading-text="Laden..." onclick="" value="Verder" name="SignupFB_NextFB_next" class="submit " type="Submit" id="SignupFB_NextFB_next">Verder</button>
            </div>
        </form>
    </body>
</html> 
```

您可能会注意到：我在电话号码字段上有一个远程规则。remoterule 本身工作正常。出于测试目的，我的 checkPhoneNumber.php 包含：

```
<?php
$valid = 'false';
echo $valid; 
```

我真的需要异步：假。否则，当我不先手动单击电话号码字段以触发 ajax 请求时，我将无法提交表单。这是 stackoverflow 上的一个已知问题。但是，当我添加 async:false 时，上面的字段中不会出现验证消息。phonenumber 字段下方的字段不存在此问题。当我将电话号码字段移到首字母字段上方时，验证消息没有问题。

有谁知道如何解决这个问题，或者知道如何解决？

提前致谢，

威廉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T10:26:17.520

我在 jquery.validate.js (v1.10.0 - 9/7/2012) 中发现，在验证所有规则时调用 showErrors 函数，并在远程规则完成时再次单独调用。

当远程规则完成并且调用 showErrors 函数时 this.errorList 将被重置。但此时 this.errorList 变量将包含先前的验证消息。

评论 this.errorList = []; 将解决上述问题。我不知道它是否会破坏其他任何东西。

**编辑：** 在提供的测试用例中它不会失败。

```
showErrors: function(errors) {
        if(errors) {
            // add items to error list and map
            $.extend( this.errorMap, errors );
            //this.errorList = [];
            for ( var name in errors ) {
                this.errorList.push({
                    message: errors[name],
                    element: this.findByName(name)[0]
                });
            }
            // remove items from success list
            this.successList = $.grep( this.successList, function(element) {
                return !(element.name in errors);
            });
        }
        if (this.settings.showErrors) {
            this.settings.showErrors.call( this, this.errorMap, this.errorList );
        } else {
            this.defaultShowErrors();
        }
    } 
```

# python - 使用Python通过串口发送文件

> ID：12475353
> 
> 赞同：1
> 
> 时间：2012-09-18T10:40:39.080
> 
> 标签：python, serial-port, pyserial

我已经制作了一个程序，用于通过串行端口与 pyserial 通信两个设备。我想通过串行链接发送和接收几个文件。我已经看到这可能与 xmodem 或 kermit 有关。没有 kermit/xmodem 直接使用 python 有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:58:50.793

您是否尝试过[xmodem](http://packages.python.org/xmodem/xmodem.html)软件包？

否则你应该自己实现一个（更简单的）校验和协议。

我的观点是，使用某些标准可以让您更好地与其他（外部）软件集成，有朝一日......

# iphone - iPhone 上的后台在线广播

> ID：12475358
> 
> 赞同：2
> 
> 时间：2012-09-18T10:40:45.710
> 
> 标签：iphone, objective-c, ios, uikit, background-process

我正在开发 ALARM 应用程序并希望在警报时播放在线广播（例如下午 5:00）（确定应用程序处于后台模式时）。我该怎么做 ？

我知道一个应用程序 - TuneIn 收音机 - 在这个应用程序中运行良好！但他们显示有趣的警报“请不要禁用 GPS 定位”。我尝试在背景中定位位置 - 它“吃”了很多电池。是否可以使用其他方式？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T05:27:36.317

您可以在本地推送通知的帮助下做到这一点

[http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html)

# c++ - boost::program_options 和 ini 文件中的多个部分

> ID：12475359
> 
> 赞同：6
> 
> 时间：2012-09-18T10:40:46.240
> 
> 标签：c++, boost-program-options

我正在尝试让 boost::program_options 读取具有多个部分的ini文件：

```
[slave]
address=localhost
port=1111

[slave]
address=192.168.0.1
port=2222 
```

有什么解决办法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-20T13:09:19.040

这个问题有几个解决方案。虽然最初看起来这应该是一项容易的任务，但它通常相当复杂。这是因为节大致相当于命名空间；部分不等同于对象。

```
[奴隶]
地址=本地主机
端口=1111

[奴隶]
地址=192.168.0.1
端口=2222
```

上面的配置有一个`slave`命名空间，其中包含两个`address`值和两个`port`值。没有两个`slave`对象都有一个`address`和`port`。由于这种区别，关联值或配对必须在应用程序代码中完成。这提出了以下选项：

*   使用配置文件的布局来暗示配对。
*   通过将多个值合并为单个字段值来执行显式配对。

* * *

### 隐含配对

使用这种方法，配置文件可以保持原样。这种方法的简单性取决于：

*   一些 Boost.ProgramOption 组件的行为。
*   每个对象表示为一个没有可选字段和少量字段的部分。

```
[奴隶]
地址=本地主机#slave.address[0]
端口=1111 #slave.port[0]

[奴隶]
地址=192.168.0.1 #slave.address[1]
端口=2222 #slave.port[1]
```

不修改配置，代码如下：

```
#include <algorithm>
#include <fstream>
#include <iostream>
#include <iterator>
#include <string>
#include <vector>

#include <boost/program_options.hpp>

/// @brief Convenience function for when a 'store_to' value is being provided
///        to typed_value.
///
/// @param store_to The variable that will hold the parsed value upon notify.
///
/// @return Pointer to a type_value.
template < typename T >
boost::program_options::typed_value< T >* make_value( T* store_to )
{
  return boost::program_options::value< T >( store_to );
}

/// @brief Slave type that contains an address and port.
struct slave
{
  std::string    address;
  unsigned short port;

  /// @brief Constructor.
  slave( std::string address, 
         unsigned short port )
    : address( address ),
      port( port )
  {}
};

/// @brief Stream insertion operator for slave.
///
/// @param stream The stream into which slave is being inserted.
/// @param s The slave object.
///
/// @return Reference to the ostream.
std::ostream& operator<<( std::ostream& stream, 
                          const slave& slave )
{
  return stream << "Slave address: " << slave.address 
                << ", port: "        << slave.port;
}

/// @brief Makes a slave given an address and port.
slave make_slave( const std::string& address,
                  unsigned short port )
{
  return slave( address, port );
}

int main()
{
  // Variables that will store parsed values.
  std::vector< std::string >    addresses;
  std::vector< unsigned short > ports;

  // Setup options.
  namespace po = boost::program_options;
  po::options_description desc( "Options" );
  desc.add_options()
    ( "slave.address", make_value( &addresses ),
                       "slave's hostname or ip address" )
    ( "slave.port"   , make_value( &ports ),
                       "plugin id" );

  // Load setting file.
  po::variables_map vm;
  std::ifstream settings_file( "config.ini", std::ifstream::in );
  po::store( po::parse_config_file( settings_file , desc ), vm );
  settings_file.close();
  po::notify( vm );

  // Transform each address and port pair into a slave via make_slave,
  // inserting each object into the slaves vector.
  std::vector< slave > slaves;
  std::transform( addresses.begin(), addresses.end(),
                  ports.begin(),
                  std::back_inserter( slaves ),
                  make_slave );

  // Print slaves.
  std::copy( slaves.begin(), slaves.end(), 
             std::ostream_iterator< slave >( std::cout, "\n" ) );
} 
```

产生这个输出：

```
从机地址：localhost，端口：1111
从机地址：192.168.0.1，端口：2222
```

* * *

### 基本显式配对

多个值有时可以以有意义的方式在单个字段中表示。`address`和的一种常见表示形式`port`是`address:port`。通过这种配对，生成的配置文件将如下所示：

```
[奴隶]
从机=本地主机：1111
从机=192.168.0.1:2222
```

这种方法的简单性取决于：

*   能够在没有键说明符的情况下将多个值表示为单个有意义的值。
*   每个对象都没有可选值。

更新后的代码：

```
#include <algorithm>
#include <fstream>
#include <iostream>
#include <iterator>
#include <string>
#include <vector>

#include <boost/algorithm/string/classification.hpp>
#include <boost/algorithm/string/split.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/program_options.hpp>

/// @brief Convenience function for when a 'store_to' value is being provided
///        to typed_value.
///
/// @param store_to The variable that will hold the parsed value upon notify.
///
/// @return Pointer to a type_value.
template < typename T >
boost::program_options::typed_value< T >* make_value( T* store_to )
{
  return boost::program_options::value< T >( store_to );
}

/// @brief Slave type that contains an address and port.
struct slave
{
  std::string    address;
  unsigned short port;

  /// @brief Constructor.
  slave( std::string address, 
         unsigned short port )
    : address( address ),
      port( port )
  {}
};

/// @brief Stream insertion operator for slave.
///
/// @param stream The stream into which slave is being inserted.
/// @param s The slave object.
///
/// @return Reference to the ostream.
std::ostream& operator<<( std::ostream& stream, 
                          const slave& slave )
{
  return stream << "Slave address: " << slave.address 
                << ", port: "        << slave.port;
}

/// @brief Makes a slave given an address and port.
slave make_slave( const std::string& address_and_port )
{
  // Tokenize the string on the ":" delimiter. 
  std::vector< std::string > tokens;
  boost::split( tokens, address_and_port, boost::is_any_of( ":" ) );

  // If the split did not result in exactly 2 tokens, then the value
  // is formatted wrong.
  if ( 2 != tokens.size() )
  {
     using boost::program_options::validation_error;
     throw validation_error( validation_error::invalid_option_value,
                             "slaves.slave",
                             address_and_port );
  }

  // Create a slave from the token values.
  return slave( tokens[0],
                boost::lexical_cast< unsigned short >( tokens[1] ) );
}

int main()
{
  // Variables that will store parsed values.
  std::vector< std::string > slave_configs;

  // Setup options.
  namespace po = boost::program_options;
  po::options_description desc( "Options" );
  desc.add_options()
    ( "slaves.slave", make_value( &slave_configs ),
                      "slave's address@port" );

  // Load setting file.
  po::variables_map vm;
  std::ifstream settings_file( "config.ini", std::ifstream::in );
  po::store( po::parse_config_file( settings_file , desc ), vm );
  settings_file.close();
  po::notify( vm );

  // Transform each config into a slave via make_slave, inserting each 
  // object into the slaves vector.
  std::vector< slave > slaves;
  std::transform( slave_configs.begin(), slave_configs.end(),
                  std::back_inserter( slaves ),
                  make_slave );

  // Print slaves.
  std::copy( slaves.begin(), slaves.end(), 
             std::ostream_iterator< slave >( std::cout, "\n" ) );
} 
```

产生相同的输出：

```
从机地址：localhost，端口：1111
从机地址：192.168.0.1，端口：2222
```

值得注意的代码修改如下：

*   的需要作为一个`options_description`阅读。`options``slaves.slave``std::vector< std::string >`
*   `make_slave`将采用一个`std::string`参数，从中提取`address`and `port`。
*   更新`std::transform`调用以仅迭代一个范围。

* * *

### 高级显式配对

通常，多个字段不能有意义地表示为单个无键值，或者一个对象具有可选字段。对于这些情况，需要进行额外级别的语法和解析。虽然应用程序可以引入自己的语法和解析器，但我建议利用 Boost.ProgramOption 的命令行语法（`--key value`和`--key=value`）和解析器。生成的配置文件可能如下所示：

```
[奴隶]
从机= --address localhost --port 1111
从机=--地址=192.168.0.1--端口=2222
```

更新后的代码：

```
#include <algorithm>
#include <fstream>
#include <iostream>
#include <iterator>
#include <string>
#include <vector>

#include <boost/bind.hpp>
#include <boost/program_options.hpp>
#include <boost/tokenizer.hpp>

// copy_if was accidently left out of the C++03 standard, so mimic the
// C++11 behavior to support all predicate types.  The alternative is to
// use remove_copy_if, but it only works for adaptable functors.
template < typename InputIterator,
           typename OutputIterator, 
           typename Predicate >
OutputIterator 
copy_if( InputIterator first,
         InputIterator last,
         OutputIterator result,
         Predicate pred )
{
  while( first != last )
  {
    if( pred( *first ) )
      *result++ = *first;
    ++first;
  }
  return result;
}

/// @brief Tokenize a string.  The tokens will be separated by each non-quoted
///        character in @c separator_characters.  Empty tokens are removed.
///
/// @param input The string to tokenize.
/// @param separator_characters The characters on which to delimit.
///
/// @return Vector of tokens.
std::vector< std::string > tokenize( const std::string& input,
                                     const std::string& separator_characters )
{
   typedef boost::escaped_list_separator< char > separator_type;
   separator_type separator( "\\", // The escape characters.
                             separator_characters,
                             "\"\'" ); // The quote characters.

   // Tokenize the intput.
   boost::tokenizer< separator_type > tokens( input, separator );

   // Copy non-empty tokens from the tokenizer into the result.
   std::vector< std::string > result;
   copy_if( tokens.begin(), tokens.end(), std::back_inserter( result ), 
            !boost::bind( &std::string::empty, _1 ) );
   return result;
}

/// @brief option_builder provides a unary operator that can be used within
///        stl::algorithms.
template < typename ResultType,
           typename Builder >
class option_builder
{
public:

  typedef ResultType result_type;

public:

  /// @brief Constructor
  option_builder( const boost::program_options::options_description& options,
                  Builder builder )
    : options_( options ),
      builder_( builder )
  {}

  /// @brief Unary operator that will parse @c value, then delegate the
  ///        construction of @c result_type to the builder.
  template < typename T >
  result_type operator()( const T& value )
  {
    // Tokenize the value so that the command line parser can be used.
    std::vector< std::string > tokens = tokenize( value, "= " );

    // Parse the tokens.
    namespace po = boost::program_options;
    po::variables_map vm;
    po::store( po::command_line_parser( tokens ).options( options_ ).run(),
               vm );
    po::notify( vm );

    // Delegate object construction to the builder.
    return builder_( vm );
  }

private:

  const boost::program_options::options_description& options_;
  Builder builder_;

};

/// @brief  Convenience function used to create option_builder types.
template < typename T,
           typename Builder >
option_builder< T, Builder > make_option_builder(
  const boost::program_options::options_description& options,
  Builder builder )
{
  return option_builder< T, Builder >( options, builder );
}

/// @brief Convenience function for when a 'store_to' value is being provided
///        to typed_value.
///
/// @param store_to The variable that will hold the parsed value upon notify.
///
/// @return Pointer to a type_value.
template < typename T >
boost::program_options::typed_value< T >* make_value( T* store_to )
{
  return boost::program_options::value< T >( store_to );
}

/// @brief Slave type that contains an address and port.
struct slave
{
  std::string    address;
  unsigned short port;

  /// @brief Constructor.
  slave( std::string address, 
         unsigned short port )
    : address( address ),
      port( port )
  {}
};

/// @brief Stream insertion operator for slave.
///
/// @param stream The stream into which slave is being inserted.
/// @param s The slave object.
///
/// @return Reference to the ostream.
std::ostream& operator<<( std::ostream& stream, 
                          const slave& slave )
{
  return stream << "Slave address: " << slave.address 
                << ", port: "        << slave.port;
}

/// @brief Makes a slave given an address and port.
slave make_slave( const boost::program_options::variables_map& vm )
{
  // Create a slave from the variable map.
  return slave( vm["address"].as< std::string >(),
                vm["port"].as< unsigned short >() );
}

int main()
{
  // Variables that will store parsed values.
  std::vector< std::string > slave_configs;

  // Setup options.
  namespace po = boost::program_options;
  po::options_description desc( "Options" );
  desc.add_options()
    ( "slaves.slave", make_value( &slave_configs ),
                      "slave's --address ip/hostname --port num" );

  // Load setting file.
  po::variables_map vm;
  std::ifstream settings_file( "config.ini", std::ifstream::in );
  po::store( po::parse_config_file( settings_file , desc ), vm );
  settings_file.close();
  po::notify( vm );

  // Create options for slaves.slave.
  po::options_description slave_desc( "Slave Options" );
  slave_desc.add_options()
    ( "address", po::value< std::string >(),
                 "slave's hostname or ip address" )
    ( "port"   , po::value< unsigned short >(),
                 "slave's port" );

  // Transform each config into a slave via creating an option_builder that
  // will use the slave_desc and make_slave to create slave objects.  These
  // objects will be inserted into the slaves vector.
  std::vector< slave > slaves;
  std::transform( slave_configs.begin(), slave_configs.end(),
                  std::back_inserter( slaves ),
                  make_option_builder< slave >( slave_desc, make_slave ) );

  // Print slaves.
  std::copy( slaves.begin(), slaves.end(), 
             std::ostream_iterator< slave >( std::cout, "\n" ) ); 
} 
```

产生与以前的方法相同的输出：

```
从机地址：localhost，端口：1111
从机地址：192.168.0.1，端口：2222
```

值得注意的代码修改如下：

*   `copy_if`因为它是 C++03 中被忽视的算法而创建的。
*   使用 Boost.Tokenizer 而不是 Boost.StringAlgo，因为 Boost.Tokenizer 更容易处理带引号的转义。
*   创建了一个`option_builder`一元仿函数，以帮助为应用转换提供惯用的重用。
*   `make_slave`现在需要 a `boost::program_options::variables_map`，它将从中构造一个`slave`对象。

这种方法也可以很容易地扩展以支持以下变体：

*   支持单个值的多个命令行。例如，一个配置可以支持两个从站，其中一个从站具有辅助配置，以防第一个配置失败。`,`这需要对分隔符执行初始标记化。

    ```
    [奴隶]
    从机 = --address localhost --port 1111, --address 127.0.0.1 --port 1112
    从机 = --address 192.168.0.1 --port 2222
    ```

*   用提供给参数的变量`slave_desc`声明选项。然后可以将这些相同的变量绑定到工厂函数。虽然这与Boost.ProgramOptions 类型分离，但对于具有许多字段的类型可能会变得难以维护。`typed_value``store_to``boost::ref``boost::bind``make_slave``make_slave`

* * *

### 替代方法

替代方法仍然需要通过将多个值放入单个值来完成显式配对。但是，在解析阶段可以通过从`boost::program_options::typed_value`或继承来进行转换`boost::program_options::untyped_value`。

*   从 继承时`typed_value`，覆盖该`parse`函数。使用的一个后果`typed_value`是模板参数必须满足`typed_value`. 例如，如果`typed_value< slave >`使用了，则需要将其设为默认可`slave`构造`istream`，`>>`并为.`ostream``<<``slave`
*   继承自 时`untyped_value`，同时覆盖`parse`和`notify`函数。这种方法不会像 那样强加类型要求`typed_value`，但它确实要求派生类维护自己的`store_to`变量。

* * *

### 建议

*   当绝对确定永远不会有可选字段并且字段数量最少（2~）时，请使用隐含配对方法。
*   如果有最少数量的字段 (2~) 并且可以在没有字段名称标识符的情况下以有意义的方式表示值，则使用基本的显式配对。可以支持可选字段，但它增加了语法和解析器的复杂性。
*   对于所有其他情况，或存在任何不确定性时，请使用高级显式配对。虽然它可能需要更多的工作，但它提供了更大的可重用性。例如，如果从属配置变得如此复杂以至于每个从属都有自己的配置文件，那么代码更改很少，因为只需要更改解析器类型和调用。

# java - 查询 MongoDB 以获取有序的不同值

> ID：12475361
> 
> 赞同：8
> 
> 时间：2012-09-18T10:40:59.657
> 
> 标签：java, mongodb, morphia, database, nosql

我正在使用 Morphia Java 驱动程序来查询包含以下形式的集合的 MongoDB：

```
MyCollection {
   TypeA
   TypeB
} 
```

我想使用以下代码检索 TypeB 的所有不同值：

```
DBCollection myCol = getDatastore().getCollection(MyCollection.class);
List typeBs = myCol.distinct("TypeB"); 
```

上面的代码按预期工作，但不同值的列表当然没有排序。

我已经尝试过以下代码：

```
DBCollection myCol = getDatastore().getCollection(MyCollection.class);
DBObject orderBy = new BasicDBObject("$orderby", new BasicDBObject("TypeB", 1);
List typeBs = myCol.distinct("TypeB", orderBy); 
```

但在这种情况下，列表是空的，我的假设哪里错了？

更新

通过使用 CLI，我发现以下查询返回了预期的结果：

```
> db.mycollection.find({$query : {}, $orderby : { TypeB : 1 }}) 
```

所以我相应地调整了我的代码：

```
DBCollection myCol = getDatastore().getCollection(MyCollection.class);

BasicDBObject ascending = new BasicDBObject("TypeB", 1);
BasicDBObject filter = new BasicDBObject();
filter.put("$query", new BasicDBObject());
filter.put("$orderby", ascending);

List typeBs = myCol.distinct("TypeB", filter); 
```

结果仍然包含 0 个条目！

真正让我感到困惑的是，如果我使用 .find 而不是 .distinct，同样的查询也会起作用：

```
DBCollection myCol = getDatastore().getCollection(MyCollection.class);

BasicDBObject ascending = new BasicDBObject("TypeB", 1);
BasicDBObject filter = new BasicDBObject();
filter.put("$query", new BasicDBObject());
filter.put("$orderby", ascending);

myCol.find(filter).hasNext();  <-- Evaluates to TRUE 
```

*为什么使用distinct*方法调用时过滤器不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T17:02:02.737

DBCollection.distinct() 的第二个 DBObject 参数是一个查询对象，用于定义匹配条件。要对列表进行排序，您可以使用：

```
List typeBs = myCol.distinct("TypeB");
java.util.Collections.sort(typeBs); 
```

# memory - 加速 Haskell 并发

> ID：12475363
> 
> 赞同：8
> 
> 时间：2012-09-18T10:41:02.907
> 
> 标签：memory, haskell, concurrency, lazy-evaluation

MVar, TVar, IORef, ...我无法加速一个 thunk 问题（我认为）。

（我原来的问题是一个线程代码，我做了“forkIO”n次调用“addMany”；但我认为我的问题是在“shW”函数上）

让下一个代码：

```
{-# LANGUAGE BangPatterns #-}
import Control.Concurrent
import Control.Monad
import System.Environment(getArgs)
import Data.Int
import Data.IORef

-- "i" times, add "n" for each IORef (in "a")
addMany :: [IORef Int64] -> Int64 -> Int64 -> IO ()
addMany !a !n !i =
  forM_ [1..i] (\_ ->
    forM_ a (shW n))

-- MVar, TVar, IORef, ... read/write (x' = x + k)
shR = readIORef
shW !k !r = atomicModifyIORef r (\ !x' -> (x' + k, ()))

main = do
  (n':i':_) <- getArgs
  let (n, i) = (read n', read i')
  v <- forM [1..n] (\_ -> newIORef 0)
  addMany v 1 i
  mapM shR v >>= (putStrLn.show.sum) 
```

然后，配置文件结果显示：

```
MUT     time    3.12s  (  3.12s elapsed)
GC      time    6.96s  (  6.96s elapsed)
...

COST CENTRE  MODULE                  no.     entries  %time %alloc   %time %alloc

MAIN         MAIN                     47           0    0.0    0.0   100.0  100.0
 main        Main                     95           0    0.0    0.0   100.0  100.0
  main.i     Main                    100           1    0.0    0.0     0.0    0.0
  addMany    Main                     99           1    0.4    0.5   100.0  100.0
   addMany.\ Main                    101       15000    6.6    0.0    99.6   99.5
    shW      Main                    102     2250000   92.7   99.5    93.0   99.5
     shW.\   Main                    104     2250000    0.3    0.0     0.3    0.0 
```

我无法删除“shW”调用上的 thunk（并且内存使用量很大）。怎么了？

类似的 C# 代码运行得更快（很多）：

```
class Node { 
    private object m; 
    private int n; 

    public Node() {n = 0; m = new object();} 
    public void Inc() {lock(m) n++;} 
    public int Read() {return n;} 
} 

class MainClass { 

    public static void Main(string[] args) { 

        var nitems = 1000; 
        var nthreads = 6; 
        var niters = 100000; 

        var g = Enumerable.Range(0, nitems).Select(i => new Node()).ToArray(); 
        Task.WaitAll(Enumerable.Range(0, nthreads).Select(q => Task.Factory.StartNew(() => { 
            var z = niters; 
            while(z-- > 0) 
                foreach(var i in g) 
                    i.Inc(); 
        })).ToArray()); 

        Console.WriteLine("Sum node values: {0}", g.Sum(i => i.Read())); 

    } 
} 
```

非常感谢！

**更新**

解决了原始问题：[https ://gist.github.com/3742897](https://gist.github.com/3742897)

非常感**谢唐斯图尔特**！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-18T12:12:17.230

当您查看堆和 GC 时间时，很明显存在泄漏：

```
USDGHTVVH1$ time ./A 1000 10000 +RTS -s
10000000
   1,208,298,840 bytes allocated in the heap
   1,352,861,868 bytes copied during GC
     280,181,684 bytes maximum residency (9 sample(s))
       4,688,680 bytes maximum slop
             545 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1677 colls,     0 par    2.27s    2.22s     0.0013s    0.0063s
  Gen  1         9 colls,     0 par    1.66s    1.77s     0.1969s    1.0273s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.70s  (  0.77s elapsed)
  GC      time    3.92s  (  4.00s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    4.62s  (  4.77s elapsed)

  %GC     time      84.8%  (83.8% elapsed)

  Alloc rate    1,718,469,461 bytes per MUT second

  Productivity  15.2% of total user, 14.7% of total elapsed

  real    0m4.752s
  user    0m0.015s
  sys     0m0.046s 
```

2.8 亿居民和 89% 的 GC。大量的 thunk 被分配和丢弃。

堆配置文件使这一点显而易见。

![在此处输入图像描述](../Images/b7de6ca510fdc51e83b3f7d1a8a0c2e7.png)

线索是这些是“stg_app*”的东西（即STG机器应用thunk）。

***modify*系列函数的一个微妙但显着的问题是这里的问题——当你有一个惰性 atomicModify 时，根本没有办法严格更新字段，而不要求值。**

所以你所有的谨慎使用`atomicModifyIORef r (\ !x' -> (x' + k, ()))`都是建立一个`(+)`函数的应用链，这样链的结果（即单元格中的值）被观察到，每个加法都将在其参数中是严格的。不是你想要的！*您对 modifyIORef参数*的严格性注释都不会对单元格本身产生任何影响。现在，通常你想要一个惰性修改——它只是一个指针交换，所以你可以有非常短的原子部分。

但有时这不是你想要的。

*（有关此问题的背景，请参见 GHC 票证[#5926](http://hackage.haskell.org/trac/ghc/ticket/5926)，但是，该问题至少在 2007 年就已为人所知，当时我编写了[严格](http://hackage.haskell.org/package/strict-concurrency-0.1)并发包以避免 MVars 出现此问题。它[在 2009 年进行了讨论](http://www.haskell.org/pipermail/haskell-cafe/2009-June/063137.html)，现在我们有了严格的2012 年的版本）。*

通过首先要求价值，您可以消除问题。例如

```
shW !k !r = --atomicModifyIORef r (\x -> (x + k, ()))
    do x <- shR r
       writeIORef r $! (x+1) 
```

请注意，此问题现已[记录在库](http://www.haskell.org/ghc//dist/current/docs/html/libraries/base-4.6.0.0/Data-IORef.html#v:atomicModifyIORef-39-)中，您可以使用`atomicModifyIORef'`它来避免它。

我们得到：

```
USDGHTVVH1$ time ./A 1000 10000 +RTS -s
10000000
     120,738,836 bytes allocated in the heap
       3,758,476 bytes copied during GC
          73,020 bytes maximum residency (1 sample(s))
          16,348 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0       230 colls,     0 par    0.00s    0.01s     0.0000s    0.0001s
  Gen  1         1 colls,     0 par    0.00s    0.00s     0.0002s    0.0002s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.17s  (  0.17s elapsed)
  GC      time    0.00s  (  0.01s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    0.19s  (  0.17s elapsed)

  %GC     time       0.0%  (3.9% elapsed)

  Alloc rate    643,940,458 bytes per MUT second

  Productivity 100.0% of total user, 108.3% of total elapsed

real    0m0.218s
user    0m0.000s
sys     0m0.015s 
```

也就是说，加速了 22 倍，并且内存使用变得恒定。为了笑，这是新的堆配置文件：

![在此处输入图像描述](../Images/d5fe30653338b9e6518e70c7d4597d10.png)

# c - 具有零长度数组的结构的大小是多少？

> ID：12475364
> 
> 赞同：1
> 
> 时间：2012-09-18T10:41:08.907
> 
> 标签：c, arrays, gcc

我在下面测试一个程序：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct _node_t {
    int id;
    int contents[0];
}node_t;

int
main(int argc, char* argv[])
{
    printf("sizeof node_t is: %d\n", sizeof (struct _node_t)); // output: 4

    node_t *node = (node_t*)malloc(sizeof(node_t) + sizeof(int) * 3);

    printf("sizeof node is: %d\n", sizeof (node)); // output: 8

    return 0;
} 
```

节点瞬间的大小是8。但是，在`malloc`函数中，我在结构中添加了额外的3个整数`node`。为什么节点大小的输出仍然是8？

PS：gcc（GCC）4.6.3 20120306（红帽4.6.3-2）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T10:42:58.687

因为 sizeof() 是一个编译时“运算符”，它返回类型的大小。它不知道甚至不关心你 malloc() 的内容。

编辑：此外，您在第二次尝试中使用了指针的大小:-) 您可能打算在那里使用“sizeof(*node)”之类的东西，这会再次给您“4”。

编辑 2：这也是您可以执行 sizeof(*Pointer) 或 sizeof(Pointer->Element) 之类的操作的原因，即使 'Pointer' 从未被初始化或以其他方式无效。sizeof() 不关心任何内容，它只查看表达式的结果类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T11:07:33.217

第一：[不要转换`malloc()`in C](https://stackoverflow.com/a/605858/28169)的返回值。

第二：最好*不要*重复类型名称，而是使用您分配`malloc()`:ed 指针的左侧指针，因为它已经具有类型。因此：

```
node_t *node = malloc(sizeof *node + 3 * sizeof(int)); 
```

在此代码中，`sizeof`运算符表达式的计算是在编译时完成的，因此在执行代码时没有可用的信息。

从 C99 开始，可以获得 的部分运行时评估`sizeof`，请参阅[此 Wikipedia text](http://en.wikipedia.org/wiki/Sizeof#Using_sizeof_with_arrays)。给出的最基本的例子是：

```
size_t flexsize(int n)
{
   char b[n+3];      /* Variable length array */
   return sizeof b;  /* Execution time sizeof */
} 
```

以上需要 的运行时评估`sizeof`，因为 的确切值`n`不是恒定的，并且在编译时未知。以上内容无法在 C99 之前的版本中编译。

# php - 将标记输出与地理编码地址相结合

> ID：12475366
> 
> 赞同：0
> 
> 时间：2012-09-18T10:41:28.147
> 
> 标签：php, javascript, mysql, google-maps

因为我不与 Google Maps Api 中的商店查找器相处（请参阅我的其他未回答的问题）我试图以另一种方式应对它：通过 php-mysql-query 和 xml-file 将所有位置放入地图和通过文本输入搜索我自己的位置。每项工作单独工作都很好，但是在组合时，我没有得到我所在位置的标记，即地理编码器似乎无法正常工作。但是：当我输入一个废话地址时，我得到一个正确的错误信息。所以在我看来，地理编码的标记无法显示，但我不知道为什么。有人可以帮忙吗？这是示例（http://umwelt-und-information.com/maps/ASPE_Adressen_zeigen.php），代码如下：

```
<?php
//error_reporting(E_ALL);    
require("dbpass.php");
if (PHP_VERSION>='5')
require_once('domxml-php4-to-php5.php');
// Opens a connection to a mySQL server
$connection=mysql_connect ($dbhost, $username, $password);
if (!$connection) {
die('Not connected : ' . mysql_error());
}
// Set the active mySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
die ('Can\'t use db : ' . mysql_error());
}
// Start XML file, create parent node
$doc = domxml_new_doc("1.0");
$node = $doc->create_element("markers");
$parnode = $doc->append_child($node);
// Select all the rows in the ASPE table
$query = "SELECT DISTINCT Nachname, lng, lat, Strasse, Telefon_P, Telefon_D, Telefon_M FROM ASPE";
$result = mysql_query($query) or die ("Error in query: $query " . mysql_error());
// Iterate through the rows, adding XML nodes for each
while ($row = @mysql_fetch_assoc($result)){
// ADD TO XML DOCUMENT NODE
$node = $doc->create_element("marker");
$newnode = $parnode->append_child($node);
$newnode->set_attribute("Nachname", $row['Nachname']);
$newnode->set_attribute("Strasse ", $row['Strasse']);
$newnode->set_attribute("Telefon_P", $row['Telefon_P']);
$newnode->set_attribute("Telefon_D", $row['Telefon_D']);
$newnode->set_attribute("Telefon_M", $row['Telefon_M']);
$newnode->set_attribute("lat", $row['lat']);
$newnode->set_attribute("lng", $row['lng']);
}
$xmlfile = $doc->dump_file("ASPE.xml");
mysql_close($connection);
//header("Location: http://umwelt-und-information.com/maps/kartenansicht_Art.php"); 
?>

<script src="http://maps.google.com/maps/api/js?sensor=false" 
   type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
var map;
var geocoder;
var markers = [];
var infoWindow;
var iconimage = 'ok.png';

// Geocoder
geocoder = new google.maps.Geocoder();
function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);
    // map.setZoom(15);
    var iconimage2 = 'correct.png';
    var marker = new google.maps.Marker({
        map: map,
        icon: iconimage2,
        position: results[0].geometry.location
    });
  } else {
    alert("Zu Ihren Angaben konnte kein Fundort gefunden werden: " + status);
  }
});
}

function load() {
    var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(52.6145, 8.3418),
    zoom: 13,
    mapTypeId: 'roadmap',
    mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU}
  });
  infoWindow = new google.maps.InfoWindow();

    downloadUrl("ASPE.xml?ienocache="+new Date().getMilliseconds(), function(data){ 
       var xml = data.responseXML; 
      var markers = xml.documentElement.getElementsByTagName("marker");
      var bounds = new google.maps.LatLngBounds();
      for (var i = 0; i < markers.length; i++) {
        var Nachname = markers[i].getAttribute("Nachname");
        var Strasse = markers[i].getAttribute("Strasse");
        var Telefon_P = markers[i].getAttribute("Telefon_P");
        var Telefon_D = markers[i].getAttribute("Telefon_D");
        var Telefon_M = markers[i].getAttribute("Telefon_M");
        var latlng = new google.maps.LatLng(
            parseFloat(markers[i].getAttribute("lat")),
            parseFloat(markers[i].getAttribute("lng")));

       var html = "<b>" + "Nachname: "  + "</b>" + Nachname +  " <br/>" +
         "<b>" + "Strasse: " +  "</b>" + Strasse + "<br/>" + 
         "<b>" + "Telefon (p): " + "</b>" + Telefon_P + "<br/>" +
         "<b>" + "Telefon (d):" +  "</b>" + Telefon_D + "<br/>" +
         "<b>" + "Telefon (m):" +  "</b>" + Telefon_M + "<br/>";
        var marker = new google.maps.Marker({
        map: map,
        position: latlng,
        icon: iconimage         
        });     

   bounds.extend(latlng);
   map.fitBounds(bounds);
   var listener = google.maps.event.addListener(map, "idle", function() { 
    if (map.getZoom() > 15) map.setZoom(15); 
    google.maps.event.removeListener(listener); 
    });

 bindInfoWindow(marker, map, infoWindow, html);
 }
 });
 }           

function bindInfoWindow(marker, map, infoWindow, html) {
google.maps.event.addListener(marker, 'click', function() {
infoWindow.setContent(html);
infoWindow.open (map, marker);
});
markers.push(marker);
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {}

//]]>

</script>

</head>

<body onload="load()">
<div> Geben Sie hier eine Adresse zum leichteren Auffinden des Fundortes ein: <br> 
<input id="address" type="textbox" value="" size="80">
<input type="button" value="Fundort finden" onclick="codeAddress()"> <br></br></div>

<div id="map" style="width: 600px; height: 500px"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:50:29.903

第 18 行：

```
 var map = new google.maps.Map(document.getElementById("map"), { 
```

尝试在您的 load() 函数之外声明它，否则 Firebug 在第 103 行会出错（未定义映射）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T19:41:17.830

现在，一切正常（地理编码中的自动完成除外，但这并不重要）:-) 我可以显示 mysql 数据库中的位置，并通过输入地址（地理编码）以及单击新位置来添加标记. 请参阅[http://umwelt-und-information.com/maps/ASPE_Adressen_zeigen.php](http://umwelt-und-information.com/maps/ASPE_Adressen_zeigen.php)。我发现，为什么以前不起作用：我相应地使用了“函数加载（）......”和“，但是当我现在使用“函数初始化（）”和“它工作！也许任何人都可以偶然评论这两个选项之间的区别...... ;-) 无论如何，这是代码（如果有人也需要的话）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-    transitional.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /></head>
<?php
//error_reporting(E_ALL);    

require("dbpass.php");
if (PHP_VERSION>='5')
require_once('domxml-php4-to-php5.php');

// Opens a connection to a mySQL server

$connection=mysql_connect ($dbhost, $username, $password);
if (!$connection) {
die('Not connected : ' . mysql_error());
}

 // Set the active mySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
die ('Can\'t use db : ' . mysql_error());
}
// Start XML file, create parent node
$doc = domxml_new_doc("1.0");
$node = $doc->create_element("markers");
$parnode = $doc->append_child($node);

// Select all the rows in the ASPE table
$query = "SELECT DISTINCT Nachname, Vorname, lng, lat, Strasse, Telefon_P, Telefon_D, Telefon_M FROM ASPE";
$result = mysql_query($query) or die ("Error in query: $query " . mysql_error());
$num_results = mysql_num_rows($result);
echo "<b> $num_results </b> Ergebnis(se) passt/passen zu Ihrer Abfrage</br>"; 

// Iterate through the rows, adding XML nodes for each
while ($row = @mysql_fetch_assoc($result)){
// ADD TO XML DOCUMENT NODE
$node = $doc->create_element("marker");
$newnode = $parnode->append_child($node);
$newnode->set_attribute("Vorname", utf8_encode ($row['Vorname']));
$newnode->set_attribute("Nachname", utf8_encode ($row['Nachname']));
$newnode->set_attribute("Strasse ", utf8_encode ($row['Strasse']));
$newnode->set_attribute("Telefon_P", utf8_encode ($row['Telefon_P']));
$newnode->set_attribute("Telefon_D", utf8_encode ($row['Telefon_D']));
$newnode->set_attribute("Telefon_M", utf8_encode ($row['Telefon_M']));
$newnode->set_attribute("lat", $row['lat']);
$newnode->set_attribute("lng", $row['lng']);
}
$xmlfile = $doc->dump_file("ASPE.xml");
mysql_close($connection);
//header("Location: http://umwelt-und-information.com/maps/kartenansicht_Art.php"); 

?>
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript">/script>
<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>

<script type="text/javascript">

//<![CDATA[
var map;
var geocoder;
var markers = [];
var infoWindow;

  // Geocoder

var input = document.getElementById('searchTextField');
//var options = {
types: ['(geocode)']
//componentRestrictions: {country: 'de'}
//};

autocomplete = new google.maps.places.Autocomplete(input, options);

function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);
    map.setZoom(15);
    var marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location
    });
  } else {
    alert("Zu Ihren Angaben konnte kein Fundort gefunden werden: " + status);
  }
});
}

function initialize() {
var latlng = new google.maps.LatLng(51.5, 7.5);
var myOptions = {
zoom: 8,
center: latlng,
mapTypeId: google.maps.MapTypeId.ROADMAP
};
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions); 

geocoder = new google.maps.Geocoder();  
infoWindow = new google.maps.InfoWindow();

var marker;
function placeMarker(location) {
if ( marker ) {
marker.setPosition(location);
} else {
marker = new google.maps.Marker({
  position: location,
  map: map
});
}
}

google.maps.event.addListener(map, 'click', function(event) {
placeMarker(event.latLng);
});             

    downloadUrl("ASPE.xml?ienocache="+new Date().getMilliseconds(), function(data){ 
       var xml = data.responseXML; 
      var markers = xml.documentElement.getElementsByTagName("marker");
      var bounds = new google.maps.LatLngBounds();
      for (var i = 0; i < markers.length; i++) {
        var Vorname = markers[i].getAttribute("Vorname");
        var Nachname = markers[i].getAttribute("Nachname");
        var Strasse = markers[i].getAttribute("Strasse");
        var Telefon_P = markers[i].getAttribute("Telefon_P");
        var Telefon_D = markers[i].getAttribute("Telefon_D");
        var Telefon_M = markers[i].getAttribute("Telefon_M");
        var latlng = new google.maps.LatLng(
            parseFloat(markers[i].getAttribute("lat")),
            parseFloat(markers[i].getAttribute("lng")));

       var html = 
       "<b>" + "Vorname: "  + "</b>" + Vorname +  " <br/>" +
       "<b>" + "Nachname: "  + "</b>" + Nachname +  " <br/>" +
         "<b>" + "Strasse: " +  "</b>" + Strasse + "<br/>" + 
         "<b>" + "Telefon (p): " + "</b>" + Telefon_P + "<br/>" +
         "<b>" + "Telefon (d):" +  "</b>" + Telefon_D + "<br/>" +
         "<b>" + "Telefon (m):" +  "</b>" + Telefon_M + "<br/>";
        var iconimage2 = 'correct.png';
        var marker = new google.maps.Marker({
        map: map,
        position: latlng,
        icon: iconimage2         
        });     

  bounds.extend(latlng);
  map.fitBounds(bounds);
  var listener = google.maps.event.addListener(map, "idle", function() { 
  if (map.getZoom() > 15) map.setZoom(15); 
  google.maps.event.removeListener(listener); 
  });

bindInfoWindow(marker, map, infoWindow, html);
}
});
}           

function bindInfoWindow(marker, map, infoWindow, html) {
google.maps.event.addListener(marker, 'click', function() {
infoWindow.setContent(html);
infoWindow.open (map, marker);
});
markers.push(marker);
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
  }

 function doNothing() {}

 //]]>

  </script>

</head>

<div> Geben Sie hier die Adresse des Fundortes ein: <br> <input id="address" type="textbox" value="" size="80">
<input type="button" value="Fundort finden" onclick="codeAddress()"> <br></br></div>
<body onload="initialize()">

<div id="map_canvas" style="width: 800px; height: 600px"></div>

</body>
</html> 
```

# c++ - glColorMask 是否影响 glClear

> ID：12475369
> 
> 赞同：5
> 
> 时间：2012-09-18T10:41:38.503
> 
> 标签：c++, c, opengl-es, opengl-es-2.0

假设在下面的代码之前绘制了一些东西，下面的代码应该做什么？

```
glColorMask(GL_FALSE, GL_FALSE, GL_FALSE, GL_TRUE);
glClearColor(0.0, 0.0, 0.0, 1.0);
glClear(GL_COLOR_BUFFER_BIT);
glColorMask(GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE); 
```

这段代码应该只是将 alpha 设置为 1 还是会清除颜色缓冲区？

或者换句话说，是否`glColorMask`会影响`glClear`或仅适用于正常绘制操作的内容？

我特别询问有关 OpenGL ES 2.0 的问题，因此对规范的任何参考将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T10:51:54.803

它只会清除 Alpha 通道。

> 像素所有权测试、剪刀测试、抖动和*缓冲区写入掩码*会影响 glClear 的[操作](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glClear.xml)

# swing - 用抗锯齿画线

> ID：12475380
> 
> 赞同：-3
> 
> 时间：2012-09-18T10:42:07.450
> 
> 标签：swing, clojure

我是Clojure新手，想在屏幕上画线和圆，而且应该是抗锯齿的，怎么做？如果有人可以将一些示例代码粘贴给我？

另一个问题，我定义了一个地图：

```
(def {:a 1, :b 2, :c 3}, i try to change it to be {:a 1, :b 99, :c 3}, 
```

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T04:20:47.567

看看奎尔。 [https://github.com/quil/quil](https://github.com/quil/quil)

它基于 Processing [http://processing.org](http://processing.org)并且很容易上手。

我认为这可以满足您的需求...改编自示例：

```
(ns foo
  (:use quil.core))

(defn setup []
  (smooth)                          ;;Turn on anti-aliasing
  (frame-rate 10)                    ;;Set framerate to 10 FPS
  (background 200))                 ;;Set the background colour to
                                    ;;  a nice shade of grey.
(defn draw []
  (stroke 0)              ;;Set the stroke colour to a black
  (stroke-weight 3)       ;;Set the stroke thickness to 3
  (line 10 10 50 50)
  (line 20 20 100 50))

(defsketch example                  ;;Define a new sketch named example
  :title "foo"  ;;Set the title of the sketch
  :setup setup                      ;;Specify the setup fn
  :draw draw                        ;;Specify the draw fn
  :size [323 200]) 
```

# html - z-index 不适用于浮动 div

> ID：12475385
> 
> 赞同：3
> 
> 时间：2012-09-18T10:42:23.013
> 
> 标签：html, css, z-index

我有这样的结构：

```
<div class='row'>
    <div class='cell'>aaaa</div>
    <div class='cell'>bbbb</div>
    <div class='cell'>cccc</div>
</div>
<div class='row'>
    <div class='cell'>dddd</div>
    <div class='cell'>eeee</div>
    <div class='cell'>ffff</div>
</div> 
```

与相关的样式表：

```
.cell {
    z-index: 1;
    position: relative;
    float: left;
    width: 82px;
}

.cell:hover {
    z-index: 10;
    position: relative;
    width: 100px;
}

row {
    clear: left;
    position: relative;
    z-index: 1;
} 
```

我只想将光标上方的 div 调整大小，保持固定 div 其余部分的结构。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:47:46.707

您需要将类用于`row`.

如果您将 css 中的课程从更改`row`为`.row`：

***[现场演示](http://tinkerbin.com/DKWuZx8r)***

类**必须**以`.`eg开头`.anyname`

类（在 HTML 中）在 css`<div class="james"></div>`中访问`.james`

ID（在 html 中）在 CSS`<div id="james"></div>`中访问`#james`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:48:26.757

尝试在悬停的单元格（100-82=18）上设置 -18px 的负右边距：

```
.cell:hover {
    z-index: 10;
    position: relative;
    width: 100px;
    margin-right: -18px;
} 
```

[工作示例](http://jsfiddle.net/DNsmb/)

# tridion - 如何从出版物中找出已发布组件的列表

> ID：12475389
> 
> 赞同：2
> 
> 时间：2012-09-18T10:42:49.253
> 
> 标签：tridion

有什么方法可以找出那些已经发布的组件的列表吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T10:58:58.420

您可以为此使用标准搜索功能。

在高级搜索中，您可以选择要检查的出版物/文件夹

选择“类型”：组件 选择“发布状态”：已发布

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T11:39:20.927

您可以参考下面的屏幕截图 ![在此处输入图像描述](../Images/6f3748858932ca58fde3deda7cc4762d.png)

# asp.net - 如何使用href在另一个页面上传递值？

> ID：12475394
> 
> 赞同：0
> 
> 时间：2012-09-18T10:43:03.953
> 
> 标签：asp.net

我有使用 href 导航到下一页的图像：

```
<a class="ajaxcolorbox" href="User.aspx"> 
```

现在我还想传递一些值，以便我可以根据用户单击的图像显示一些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:45:30.280

使用查询字符串。

```
<a class="ajaxcolorbox" href="User.aspx?id=<YOUR_ID>"> 
```

这是传递数据的最简单方法。

您可以在 User.aspx 上读取它，如下所示：

```
var id = Request.QueryString["id"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:46:24.590

Use QueryString as Id

User.aspx?imageId=value

and read it from the next page

# multithreading - 德尔福线程

> ID：12475395
> 
> 赞同：1
> 
> 时间：2012-09-18T10:43:05.437
> 
> 标签：multithreading, delphi, delphi-2009

我需要在 Delphi 中启动一个线程并为此使用以下代码：

```
function ThreadFunc(tp: PThreadParams): Integer;
var
    I: Integer;
begin
    OutputDebugString(PChar('ThreadFunc, 1'));
    for I := 0 to 10000 do
    begin
        if (I MOD 100) = 0 then
        begin
                OutputDebugString(PChar('Sample Delphi DLL ' + IntToStr(I)));
        end;

    end;

    Dispose(tp);
end;

procedure RunThread;
var
tp : PThreadParams;
Thread : THandle;
ThreadID : Cardinal;
ExitCode : Cardinal;
begin
    New(tp);

    OutputDebugString(PChar('RunThread, 1'));

    Thread := BeginThread(nil, 0, @ThreadFunc, tp, 0, ThreadID);

    OutputDebugString(PChar('RunThread, 2\. ThreadID: ' + IntToStr(ThreadID)));

    WaitForSingleObject(Thread, INFINITE);

    GetExitCodeThread(Thread, ExitCode);

    CloseHandle(Thread);
end; 
```

当我运行 RunThread 时，日志文件包含条目

> 运行线程，1
> 
> 运行线程，2。线程 ID：...

但没有来自`ThreadFunc`.

我应该如何更改此代码才能执行实际的线程函数（`ThreadFunc`）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:59:14.387

为什么不使用 TThread？使实现线程变得非常容易。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-10T15:45:00.653

## 在输出调试字符串上

您的问题可能与 OutputDebugString 以及 Delphi IDE 如何处理它有关。你的线程没有问题。它运行正常。它的唯一缺点是 ThreadFunc 必须返回一个值，而在您的情况下它不会。请参阅[https://msdn.microsoft.com/en-us/library/windows/desktop/ms686736](https://msdn.microsoft.com/en-us/library/windows/desktop/ms686736(v=vs.85).aspx) (v=vs.85).aspx（仅返回零 - 最简单的情况）。

要检查 Delphi 是否正确处理 OutputDebugString，请使用替代应用程序来显示调试消息。

[退出 Delphi，在https://technet.microsoft.com/en-us/sysinternals/debugview.aspx](https://technet.microsoft.com/en-us/sysinternals/debugview.aspx)从 Windows Sysinternals 获取 DebugView ，运行它，并在运行时运行您的应用程序（只要确保 Delphi 不是跑步）。

在 DebugView 日志中，您将看到类似的内容：

```
[8484] RunThread, 1
[8484] RunThread, 2\. ThreadID: 8388
[8484] ThreadFunc, 1
[8484] Sample Delphi DLL 0
[8484] Sample Delphi DLL 100
[8484] Sample Delphi DLL 200
<<< 96 lines skipped >>>
[8484] Sample Delphi DLL 9900
[8484] Sample Delphi DLL 10000 
```

OutputDebugString 太晦涩难懂，无法依赖它。只是更简单的方法来确保您的线程正在运行，例如创建文件或调用哔声。所以，这个想法是，如果 DebugView 没有帮助，只需从您的线程中输出调试字符串并使用其他方法确保线程正在运行。例如，将以下字符串添加到 ThreadFunc 的开头：

```
MessageBox(0, 'Thread Text', 'Thread Caption', MB_OK); 
```

运行您的应用程序。如果您将看到消息对话框，那么您的线程运行正常。

## 关于召唤约定

调用约定（stdcall vs register）在这里不是问题。从这个意义上说，您的代码是正确的。在 System.pas 中查找 BeginThread 函数的实现（以及 TThreadFunc 的定义，如果它存在）。

您没有提及您使用的是什么版本的 Delphi，或者您可能正在使用其他兼容的编译器 - 这可能会影响类型，但这种可能性极低。Delphi 10.2 使用 ThreadWrapper 函数将其传递给 Windows API CreateThread()。这个 ThreadWrapper 是使用“stdcall”调用约定定义的，这是 Win32 规范所要求的，因为它直接传递给运行的 CreateThread()。ThreadWrapper 又调用您具有注册调用约定的 TThreadFunc。TThreadFunc 的定义方式如下（简单明了）：

```
TThreadFunc = function(Parameter: Pointer): Integer; 
```

因此，正如上面的代码所示，您的 ThreadFunc 必须与 TThreadFunc 的声明完全匹配。它不必像某些人在评论中所说的那样是“stdcall”。如果您的 Delphi 版本在 System.pas 中没有 TThreadFunc，请查找 BeginThread 的第三个参数所需的类型，以确保一切正确。

如果您将编译器选项“Typed @ operator”打开（默认情况下为关闭），并且如果问题出在调用约定不匹配，则编译器会给出错误。我建议始终选中“Typed @ operator”选项。或者，在您的 CreateThread 调用之前添加 {$T+} （或者在文件开头更好）。因此，您将确保没有不匹配。

正如我所解释的，事情表明调用约定在这里不是问题，并且您的代码中的一切都是正确的。如果调用约定不合适，则 ThreadFunc 将一直运行到最后，因为在退出 (Dispose(tp)) 之前不需要任何参数，因此在执行所有 OutputDebugString 调用后会出现访问冲突错误– 在 Dispose(tp) 或从 ThreadFunc 退出时。您会在调试器中看到输出，然后出现访问冲突。由于没有访问冲突 - 调用约定一切正常。

# xml - XML Schema Oxygen 验证问题

> ID：12475400
> 
> 赞同：1
> 
> 时间：2012-09-18T10:43:30.483
> 
> 标签：xml, xsd, oxygenxml

我在为 XML 文档生成 XML Schema 时遇到了一些问题。XML 文档应如下所示：

```
<HEADER>
    <ID>64639</ID>
    ....
    <INCIDENT>
        <HEADER>64639</HEADER>
    </INCIDENT>
    <INCIDENT>
        <HEADER>64639</HEADER>
    </INCIDENT>
    ....
</HEADER> 
```

到目前为止，我实现了以下结构：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
        elementFormDefault="qualified">

<xsd:element name="HEADER">
    <xsd:complexType>
        <xsd:all>
            <xsd:element minOccurs="1" name="ID" nillable="false" type="xsd:integer"/>
        </xsd:all>
    </xsd:complexType>
    <xsd:key name="SYS_C0032500">
        <xsd:selector xpath="."/>
        <xsd:field xpath="ID"/>
    </xsd:key>
    <xsd:keyref name="SYS_C0032500_HEADER.ID_INCIDENT.HEADER_" refer="SYS_C0032500">
        <xsd:selector xpath="INCIDENT"/>
        <xsd:field xpath="HEADER"/>
    </xsd:keyref>
</xsd:element>

<xsd:element name="INCIDENT">
    <xsd:complexType>
        <xsd:all>
            <xsd:element minOccurs="1" name="HEADER" nillable="false" type="xsd:integer"/>
        </xsd:all>
    </xsd:complexType>
    <xsd:key name="IDK">
        <xsd:selector xpath="."/>
        <xsd:field xpath="HEADER"/>
    </xsd:key>
</xsd:element>

</xsd:schema> 
```

此任务的标准使用 和 元素来模拟数据库约束。目前我收到一条错误消息，上面写着：

> 引擎名称：Xerces 严重性：错误描述：cvc-complex-type.2.4.d：发现以元素“INCIDENT”开头的无效内容。此时不需要子元素。开始位置：3:6 结束位置：3:14 URL：[http ://www.w3.org/TR/xmlschema-1/#cvc-complex-type](http://www.w3.org/TR/xmlschema-1/#cvc-complex-type)

我的另一个问题来自更多的事件部分。当没有 maxOccurs 属性时，如何添加更多 INCIDENT 元素？

感谢您的每一个帮助！

问候，乔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:41:34.427

在您的示例实例文档中，HEADER 的内容模型似乎是“一个 ID 后跟一个或多个事件”。在 XSD 中是：

```
<xsd:element name="HEADER">
    <xsd:complexType>
        <xsd:sequence>
            <xsd:element name="ID" nillable="false" type="xsd:integer"/>
            <xsd:element name="INCIDENT" minOccurs="1" maxOccurs="unbounded" type="..."/>
        </xsd:all>
    </xsd:complexType>
    ... 
```

# java - 如何实现等待 GPS？

> ID：12475401
> 
> 赞同：0
> 
> 时间：2012-09-18T10:43:29.933
> 
> 标签：java, android, gps

我正在尝试实现如下所示的“等待 GPS”方法，只要没有 GPS，它就会显示出来，例如当 GPS 锁丢失或只是初始化 GPS 锁时......

![等待gps](../Images/385d52a70980276e16cc43a2b6f4f308.png)

我已经实现了一个简单的 LocationListener 并且它工作正常，但我想要一些更用户友好的东西。

我怎样才能做到这一点？提前致谢！

# android - xml解析获取元素值null

> ID：12475406
> 
> 赞同：0
> 
> 时间：2012-09-18T10:43:45.960
> 
> 标签：android, xml, web-services, null, xml-parsing

我创建了一个 Web 服务，如下所示：

```
 <?xml version="1.0" encoding="UTF-8" standalone="yes" ?> 
- <todoLists>
- <todoList>
  <productId>smthig</productId> 
  <siteCode>smthing</siteCode> 
  <subDeptId>smthing</subDeptId> 
  </todoList>
  </todoLists> 
```

我正在尝试使用下面的代码使用 DOM 解析器来解析它，我得到 nodeList.getLength() = 20 但没有得到元素的值。它显示为 null 我也尝试了 SAX 解析器，但这也给出了 null . 网络服务有什么问题吗？请建议。

```
public class XMLParsingDOMExample extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /** Create a new layout to display the view */
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(1);

        /** Create a new textview array to display the results */

        TextView category[];

        try {

            URL url = new URL(
            "http://xxxxxx:8080/webservicedemo/rest/todo");
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse(new InputSource(url.openStream()));
            doc.getDocumentElement().normalize();

            NodeList nodeList = doc.getElementsByTagName("todoList");
            System.out.println("null 1");
            /** Assign textview array lenght by arraylist size */

            category = new TextView[nodeList.getLength()];
            System.out.println("null 122 nodeList.getLength()" +nodeList.getLength());
            for (int i = 0; i < nodeList.getLength(); i++) {

                Node node = nodeList.item(i);
                category[i] = new TextView(this);
                Element fstElmnt = (Element) node;
                category[i].setText("Name = "
                        + fstElmnt.getAttribute("siteCode"));

                layout.addView(category[i]);
                System.out.println("null 551");

            }
        } catch (Exception e) {
            System.out.println("XML Pasing Excpetion = " + e);
        }

        /** Set the layout view to display */
        setContentView(layout);

    }

    public class RSSAdapter extends BaseAdapter {
        Element rootElement;

        public RSSAdapter(Element rootElement) {
            this.rootElement = rootElement;
        }

        public int getCount() {
            // get the count of children of the root element
            return 0;
        }

        public Object getItem(int position) {
            // get the child identified by the position, 
            // this is the important part where you    
            // want to get the right child representing the RSS data that you want to get
            return null;
        }

        public long getItemId(int position) {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            // implement your view here....
            return null;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:49:34.147

在你的情况下`siteCode`不是属性`Node of todoList`

**解决方案**

```
 NodeList nlList = eElement.getElementsByTagName("siteCode").item(0).getChildNodes();
    Node nValue = (Node) nlList.item(0);
    category[i].setText(nValue.getNodeValue()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:06:11.640

将您的 for 循环更改为此

```
for (int i = 0; i < nodeList.getLength(); i++) {

                NodeList nodes = nodeList.item(i).getChildNodes();
                category[i] = new TextView(this);
                Element fstElmnt = (Element) node;
                // this will return node value of 2nd node  
                category[i].setText("Name = "
                        + fstElmnt.item(1).getNodeValue());

                layout.addView(category[i]);
                System.out.println("null 551");

            } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T11:33:06.907

迭代 nodelist 并获取每个孩子的值。

```
 NodeList nodeList = doc.getElementsByTagName("todoList");
    int length=nodeList.getLength();
    category = new TextView[length];

    for(int index=0;index<length;index++){
      Element element=(Element) nodeList.item(1ndex);
      NodeList childList=element.getElementsByTagName("siteCode");
      Element e=(Element) childList.item(0);
      Node n=e.getFirstChild();
      CharacterData data=(CharacterData)n;
      category[index].setText(data.getData());
     }//end for loop 
```

# python - Python中电子阅读器应用程序中的下一个和上一个逻辑？

> ID：12475408
> 
> 赞同：0
> 
> 时间：2012-09-18T10:43:51.727
> 
> 标签：python, logic

有文件名为：page1.txt、page2.txt、page3.txt、page4.txt。这些都是页面。询问用户输入，如果用户按 1，则显示第 1 页。当用户按下页码时，我能够显示结果：

```
def read(argu):
    argu = open(argu)
    y = [x for x in argu]
    print y

inp = raw_input('Say: ')

if inp=='1':
    read('page1.txt')

if inp=='2':
    read('page2.txt')

if inp=='3':
    read('page3.txt') 
```

我被困在下一个和上一个。如果用户在第 2 页并且如果他按下一步，我需要显示第 3 页，依此类推。我怎么做？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:56:26.927

为了从一个页面移动到另一个页面，您需要使用一个变量来显示用户当前正在阅读的页面。然后，上一个和下一个将更新页码并显示相应的页面：

```
file = ['page1.txt', 'page2.txt', 'page3.txt', 'page4.txt']
pagecount = len(file)
page = 1                    # initialize to a default page

if inp == '1':
    page = 1
    read(file[page-1])      # pages are 1-4, subscripts are 0-3

# ... pages 2-4 go here 

elif inp == '+':              # whatever key you use for Next
    page = min(page+1, pagecount)    # don't go beyond last page
    read(file[page-1])

elif inp == '-':              # switch statements use "if .. elif .. elif .. else"
    page = max(page-1, 1)
    read(file[page-1]) 
```

在您使该版本正常工作后，您可以通过从页码构造文件名而不是将文件名存储在列表中来概括它以允许任意数量的页面。而且您的输入循环只需要一次“读取”——因为每个键都读取一个页面，您可以将其从每个单独的键中分解出来。

# php - PHP中将数组转换为HTML表的函数的奇怪单字符输出

> ID：12475410
> 
> 赞同：0
> 
> 时间：2012-09-18T10:44:03.203
> 
> 标签：php, html, arrays

我已经打了几次，只是想知道是否有人可能知道为什么会发生这种情况。

我传递的数组来自 WHM/cPanel API，格式为 (var_dump()ed)：

```
array (size=14)
  '_diskquota' => string '262144000' (length=9)
  '_diskused' => string '31459' (length=5)
  'diskquota' => string '250' (length=3)
  'diskused' => string '0.03' (length=4)
  'diskusedpercent' => string '0' (length=1)
  'diskusedpercent20' => string '0' (length=1)
  'domain' => string 'xxxxxxx.co.uk' (length=20)
  'email' => string 'info@xxxxxxx.co.uk' (length=25)
  'humandiskquota' => string '250Â MB' (length=7)
  'humandiskused' => string '30.72Â KB' (length=9)
  'login' => string 'info@xxxxxxx.co.uk' (length=25)
  'mtime' => string '1347964089' (length=10)
  'txtdiskquota' => string '250' (length=3)
  'user' => string 'info' (length=4) 
```

我正在将其转换为具有以下功能的 HTML 表格：

```
public function formatEmailAccountsArrayToTable( $email_accounts )  {
    $returnHTML = '';
    $topentag   =   '<table class="email_accounts_table">';
    $theader    =   '<thead><tr>
                        <th>Email</th><th>User</th><th>Domain</th><th>Disk Quota</th><th>Disk Used</th>
                        </tr></thead><tbody>';
    $tclosetag  =   '</tbody></table>';

    $returnHTML .= $topentag . $theader;

    foreach( $email_accounts as $v ) {
        $returnHTML .= '
            <tr>
                <td>' . $v['email'] . '</td>
                <td>' . $v['user'] . '</td>
                <td>' . $v['domain'] . '</td>
                <td>' . $v['diskquota'] . '</td>
                <td>' . $v['diskused'] . '</td>
            </tr>';
    }
    $returnHTML .= $tclosetag;

    return $returnHTML;
} 
```

输出如下：

```
Email   User    Domain  Disk Quota  Disk Used
2   2   2   2   2
3   3   3   3   3
2   2   2   2   2
0   0   0   0   0
0   0   0   0   0
0   0   0   0   0
b   b   b   b   b
i   i   i   i   i
2   2   2   2   2
3   3   3   3   3
i   i   i   i   i
1   1   1   1   1
2   2   2   2   2
i   i   i   i   i 
```

我看不出为什么任何值会被截断/转换为表中输出的值。

有谁知道为什么会发生这种情况，因为流程应该非常简单，但行为却很奇怪？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:48:41.950

Your `$email_accounts` array is a two-dimensional array, which you're iterating over in a `foreach` loop, at which point `$v` represents a single property of that array.

Ideally you need to restructure your array in order for the function to work correctly, a quickfix would be to do something like:

```
$email_accounts = array($email_accounts); 
```

Which would give you:

```
array
  0 => 
    array
      '_diskquota' => string '262144000' (length=9)
      '_diskused' => string '31459' (length=5)
      'diskquota' => string '250' (length=3) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T10:50:55.710

你的`$email_accounts`数组结构是这样的：

```
array(
    'x1' => 'y', 
    'x2' => 'y'
) 
```

在您的代码中应该是这样的：

```
array(
    0 => array(
        'x1' => 'y', 
        'x2' => 'y'
    ), 
    1 => array(
        'x1' => 'y', 
        'x2' => 'y'
    )
) 
```

# .net - 适用于 Windows 应用商店应用的 .NET API 中的 DateTimeFormatInfo 中缺少 DateSeparator 和 TimeSeparator

> ID：12475413
> 
> 赞同：3
> 
> 时间：2012-09-18T10:44:13.900
> 
> 标签：.net, microsoft-metro, windows-runtime

在 Windows 应用商店应用程序的 .NET API 中，DateTimeFormatInfo 不包括属性 DateSeparator 和 TimeSeparator。原因可能是两者都允许在完整 API 中进行设置。但是如果我需要获取当前的日期或时间分隔符（我确实这样做了），我可以使用什么来代替？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T17:09:04.503

您可以使用[DateTime 格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)来获取信息。

```
var dateSep = DateTime.Now.ToString("%/", dateTimeFormatInfo);
var timeSep = DateTime.Now.ToString("%:", dateTimeFormatInfo); 
```

# javascript - Javascript 关闭 createElement('iframe')

> ID：12475415
> 
> 赞同：0
> 
> 时间：2012-09-18T10:44:21.017
> 
> 标签：javascript, dom

我正在从书签创建一个 iframe，然后在里面附加 HTML 以显示页面内容。

我无法关闭 iframe。

用户在查看其他网页时单击小书签。

我可以使用 target="_parent" 发布到 iframe 已打开的原始 URL，但这有问题，因为某些网站不允许发布 URL，而且这意味着用户的双后退按钮操作可以到达他们所在的位置在他们点击书签之前。

这是书签代码：（它适用于测试）

```
javascript:(function(d){
  var%20modal=document.createElement('iframe');
  modal.setAttribute('src','http://9ammusic.com/test/bm2.html?url='+encodeURIComponent(window.location.href)+
  '&page_title='+document.title);
  modal.setAttribute('scrolling','no');
  modal.setAttribute('name','my_modal');
  modal.className='modal';
  document.body.appendChild(modal);

  var%20c=document.createElement('link');
  c.type='text/css';
  c.rel='stylesheet';
  c.href='//9ammusic.com/css/iframe.css';
  document.body.appendChild(c);
}(document)); 
```

目前我正在使用我得到的 URL 关闭框架，`window.location.href`如下所示：

```
<form method=post action=<?=$_GET['url']?> target="_parent"> 
```

但这根本不理想 - 有没有办法直接关闭 iframe 而完全不影响父窗口？

# android - 如何查看单个安卓应用的系统资源信息？

> ID：12475416
> 
> 赞同：0
> 
> 时间：2012-09-18T10:44:27.033
> 
> 标签：android, resources

如标题所述，我正在尝试制作一个可以检查其他应用程序的 android 应用程序

系统资源使用信息...例如，手机音量、网络访问能力...等

有没有任何 android sdk 库可以帮助我完成这样的工作？我知道这样的应用程序

[http://www.guidingtech.com/11501/monitor-app-activities-resource-usage-android/](http://www.guidingtech.com/11501/monitor-app-activities-resource-usage-android/)

是我想做的……请给我一些指导，谢谢你的耐心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:51:04.633

可能，[PackageManager](http://developer.android.com/reference/android/content/pm/PackageManager.html)提供了您需要的一些信息。检查它的`getInstalledPackages`方法和[PackageInfo](http://developer.android.com/reference/android/content/pm/PackageInfo.html)

# c# - 不要使用 Type.GetMethods() 返回 ToString、Equals、GetHashCode、GetType

> ID：12475417
> 
> 赞同：9
> 
> 时间：2012-09-18T10:44:29.253
> 
> 标签：c#, reflection, methods

给定一些这样的类：

```
public class MyBaseClass()
{
    public void MyMethodOne()
    {
    }

    public virtual void MyVirtualMethodOne()
    {
    }
}

public class MyMainClass : MyBaseClass()
{
    public void MyMainClassMethod()
    {
    }

    public override void MyVirtualMethodOne()
    {
    }
} 
```

如果我运行以下命令：

```
var myMethods= new MyMainClass().GetType().GetMethods(); 
```

我回来了：

*   我的方法一
*   我的虚拟方法一
*   我的主类方法
*   字符串
*   等于
*   获取哈希码
*   获取类型

如何避免返回最后 4 种方法`myMethods`

*   字符串
*   等于
*   获取哈希码
*   获取类型

**编辑**

到目前为止，这个黑客正在工作，但想知道是否有更清洁的方法：

```
 var exceptonList = new[] { "ToString", "Equals", "GetHashCode", "GetType" };
        var methods = myInstanceOfMyType.GetType().GetMethods()
            .Select(x => x.Name)
            .Except(exceptonList); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-18T10:56:22.897

如果你使用

```
var myMethods = new MyMainClass().GetType().GetMethods()
    .Where(m => m.DeclaringType != typeof(object)); 
```

您将丢弃那些底部的四种方法，除非它们在您的层次结构中的某个地方被覆盖。

（我自己也想要这种行为，但如果你想让这四个排除*任何东西*，那么 Cuong 的回答会这样做。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-18T10:56:27.827

你也可以做到这一点：

```
var methods = typeof(MyMainClass)
                    .GetMethods()
                    .Where(m => !typeof(object)
                                     .GetMethods()
                                     .Select(me => me.Name)
                                     .Contains(m.Name)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-18T10:49:48.050

尝试这个。

```
GetMethods().Where((mi)=> mi.DeclaringType != typeof(object)); 
```

使用一点 LINQ，您可以消除`object`类中声明的所有方法。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-06-08T13:19:48.707

我们也可以明确排除它们：

```
public static IEnumerable<MethodInfo> GetMethodsWithoutStandard(this Type t)
        {
            var std = new List<string>() {  nameof(ToString),
                                            nameof(Equals),
                                            nameof(GetHashCode),
                                            nameof(GetType)};
            return t.GetMethods().Where(x => !std.Contains(x.Name));
        } 
```

这种方法不怕覆盖这些方法

# android - 如何在android中进行UI自动化？

> ID：12475418
> 
> 赞同：6
> 
> 时间：2012-09-18T10:44:34.850
> 
> 标签：android, automation, monkeyrunner

是否有任何指南可以遵循 UI 自动化，例如在 Android 中选择项目、编写文本、按下按钮。请列出集成上述其中一项 UI 自动化的步骤。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T10:52:38.003

你应该像`python`脚本一样使用它。例子：

```
import sys
import os
import time
import shlex
import subprocess

from com.android.monkeyrunner import MonkeyRunner, MonkeyDevice
device = MonkeyRunner.waitForConnection(99, ANDROID_SERIAL_NUMBER)

def Click(device, left, top, duration = 0):
    if duration == 0:
        device.touch(left, top, MonkeyDevice.DOWN_AND_UP)
    else:
        device.touch(left, top, MonkeyDevice.DOWN)
        time.sleep(duration)
        device.touch(left, top, MonkeyDevice.UP)

def Drag_example():
    device.drag((100, 200), (1500, 150), 1, 10) 

def Settings_menu():
    package='com.android.settings'
    activity='.Settings'
    component_name=package + "/" + activity
    device.startActivity(component=component_name)
Settings_menu(); 
```

对于运行脚本使用： `monkeyrunner script_name`

这里是： `Click`在x和y位置点击屏幕的功能；
`Drag_example`简单的拖拽
`Settings_menu`示例 简单的运行Activity示例

不要忘记更改`ANDROID_SERIAL_NUMBER`您的序列号。您可以通过命令
获取它。`adb devices`

有关更多信息，您可以阅读[google 文档](http://developer.android.com/tools/help/monkeyrunner_concepts.html)。

要在 Java 中使用，[请阅读这篇文章](https://stackoverflow.com/questions/6686085/how-can-i-make-a-java-app-using-the-monkeyrunner-api)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T11:06:21.817

一些有用的链接，

1.  [Android：演示 Monkeyrunner 的示例代码](http://crazyrai.blogspot.in/2011/12/monkeyrunner-sample-code-to-demonstrate.html)

2.  [Android 指南：monkeyrunner 概述](http://developer.android.com/tools/help/monkeyrunner_concepts.html)

3.  [Android 指南：MonkeyDevice](http://developer.android.com/tools/help/MonkeyDevice.html)

4.  [Android 指南：MonkeyRunner](http://developer.android.com/tools/help/MonkeyRunner.html)

5.  [Monkeyrunner：与 Views](http://dtmilano.blogspot.in/2012/02/monkeyrunner-interacting-with-views.html) Last 链接交互，但最好...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-21T09:31:28.140

Automate 是一款可以完成您提到的所有工作以及更多工作的应用程序。您不需要笔记本电脑或 ADB 连接。此外，由于编程采用块的形式并且大部分是同步的，因此不需要编码。

[Play 商店链接](https://play.google.com/store/apps/details?id=com.llamalab.automate)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-23T11:29:26.427

这是我开发的用于自动化 Ebay 应用程序的示例项目，其中实现了上述所有要求的 UI 操作。

[https://github.com/Sivateja0804/EbayAutomationUsingEclipse](https://github.com/Sivateja0804/EbayAutomationUsingEclipse)

通过代码存储库的链接

# web-services - 带有证书的 Spring-WS 客户端

> ID：12475426
> 
> 赞同：1
> 
> 时间：2012-09-18T10:45:01.517
> 
> 标签：web-services, spring, ssl, client, certificate

我是 Web 服务的新手，我需要编写简单的 spring-ws 客户端，它将通过 SSL 与服务器通信。情况是：

*   我的客户端在我的 Glassfish 上的 localhost ws 服务器上与 http 配合良好（问题是远程服务器和 https）
*   远程服务器正常工作。我将只使用它发送给我的数据
*   我有服务器的 https 地址
*   我有来自服务器提供商的客户端证书

我认为为此类任务找到一个简单的教程会很容易，但我很难找到类似的东西。这真的很不寻常还是我有问题？你知道一些很好的教程/书来创建这个吗？这可能是一些简单的快速步骤，我真的只需要连接到该服务器并从中获取数据。

我在用：

*   STS 3.0.0.M3
*   JDK 1.7
*   客户端作为 Java 应用程序（以后可能作为动态 Web 应用程序）
*   从服务器的 wsdl (JAXB) 生成的类
*   我按照本教程创建我的客户端[http://justcompiled.blogspot.sk/2010/11/web-service-client-with-spring-ws.html](http://justcompiled.blogspot.sk/2010/11/web-service-client-with-spring-ws.html)

**编辑：**有关该主题的更多详细信息

我将客户端从我提到的教程更改为使用我在本地主机上创建的 Web 服务（无 SSL）。它运作良好，请求和响应是正确的。然后我将其更改为与远程服务器一起使用。我生成了新类并在 ApplicationContext 中设置了服务器的新地址。第一个错误是缺少公共日志库。我添加了它。然后出现了新错误（该错误的简短版本）：

```
org.springframework.ws.client.WebServiceIOException: I/O error: java.security.cert.CertificateException: No name matching certificatename found; nested exception is javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No name matching certificatename found 
```

我使用 keytool 将我的证书添加到我的 jdk 中的 cacerts 中。它没有帮助。我发现了有关该错误的一些信息，并尝试在此处添加上一篇文章中的代码：

[http://www.coderanch.com/t/557677/sockets/java/CertificateException-No-name-matching-hostname](http://www.coderanch.com/t/557677/sockets/java/CertificateException-No-name-matching-hostname)

它不应该很安全，但我试过了。新的错误是：

```
Exception in thread "main" org.springframework.ws.client.WebServiceTransportException: Internal Server Error [500]
at org.springframework.ws.client.core.WebServiceTemplate.handleError(WebServiceTemplate.java:663)
at org.springframework.ws.client.core.WebServiceTemplate.doSendAndReceive(WebServiceTemplate.java:587)
at org.springframework.ws.client.core.WebServiceTemplate.sendAndReceive(WebServiceTemplate.java:537)
at org.springframework.ws.client.core.WebServiceTemplate.marshalSendAndReceive(WebServiceTemplate.java:384)
at org.springframework.ws.client.core.WebServiceTemplate.marshalSendAndReceive(WebServiceTemplate.java:378)
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:59:16.100

我解决了这个问题。我终于可以访问我们的 WS 服务器，这样我就可以检查日志了。它表明证书根本没有问题。消息正确到达服务器。当服务器尝试解析我的消息时，问题就开始了，这失败了，然后服务器返回错误 500 并在日志中显示错误：

> 无法从给定来源创建信封

我和我的同事发现服务器在 Java 6 上运行，但我们的应用程序在 Java 7 上，我们尝试将应用程序移动到 Java 7 私有服务器上，一切正常。经过一番搜索，我们发现解析器 xalan.jar 和 xerces.jar 可能是问题所在，更新它们也可以解决这个问题。无论如何，使用相同版本的 Java 应该是解决方案。

可悲的是，我不能降到 Java 6，服务器不能升到 Java 7（细节不重要）。所以我使用 Axis 创建了全新的客户端，老实说，我很高兴我做出了这个决定。它从一开始就有效，而且使用起来更容易。如果有人感兴趣，这是我遵循的教程（还有我需要的最后如何使用生成的代码）

[http://px.pats.no/px/Eclipse_tutorial.html](http://px.pats.no/px/Eclipse_tutorial.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-12T08:51:54.940

此问题与您的证书中未包含的 dns 名称有关，要解决此问题，请尝试重新制作您的证书：

```
keytool ... san=ip:10.1.1.1 
```

或者只是尝试添加一个静态方法，告诉 java 不要验证域：

```
 static{
javax.net.ssl.HttpsURLConnection.setDefaultHostnameVerifier(
new javax.net.ssl.HostnameVerifier(){

    public boolean verify(String dns,
            javax.net.ssl.SSLSession sslSession) {
        return true;
    }
}); 
```

}

# iphone - 如何在iphone中排序后更改标签的位置

> ID：12475433
> 
> 赞同：0
> 
> 时间：2012-09-18T10:45:19.843
> 
> 标签：iphone, imageview

嗨，在一个应用程序中，我有一组图像视图都是以编程方式创建的。对于这些图像视图，我正在从一个数组中获取图像，直到这个很好。

我的问题是我必须实现对数组数据的排序，这也是使用 NSSortDescriptor 完成的。但是现在我必须根据排序的数据更改这些图像视图在视图上的位置。到目前为止，我所做的是我正在从视图中删除现有的图像视图并根据数组中可用的数据创建新的图像视图，但是如果我在数组中有 100 个元素，则需要花费很多时间。所以我想改变图像视图的位置，而不是删除并重新创建。

我对此一无所知，任何人都可以在这个问题上帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:55:39.420

不要删除现有的图像视图。一种方法是....当您第一次将图像从数组添加到图像视图时，分配 imageView.tag=index_of_the_image_in_the_array 然后创建一个方法来重新加载图像视图并在您完成数组排序时调用它。在该方法中，使用循环将 imageview 中的图像替换为数组中相应索引处的图像。

# wcf - wcf .net4 字典包含字典

> ID：12475436
> 
> 赞同：1
> 
> 时间：2012-09-18T10:45:25.117
> 
> 标签：wcf, .net-4.0, dictionary, known-types

我试图返回一个数组，`dictionary <string, object>`其中对象可能包含基本类型，如 int、bool 等，或者它可能包含另一个数组`dictionary<string, object>`

虽然我可以让它很好地序列化，但如果字典中有字典，它就不会反序列化。

我收到以下错误：

```
Error in line 1 position 543\. Element 'http://schemas.microsoft.com/2003/10/Serialization/Arrays:Value' contains data from a type that maps to the name 'http://schemas.microsoft.com/2003/10/Serialization/Arrays:ArrayOfArrayOfKeyValueOfstringanyType'. The deserializer has no knowledge of any type that maps to this name. Consider using a DataContractResolver or add the type corresponding to 'ArrayOfArrayOfKeyValueOfstringanyType' to the list of known types - for example, by using the KnownTypeAttribute attribute or by adding it to the list of known types passed to DataContractSerializer. 
```

班上：

```
[DataContract(Namespace = "CISICPD")]
[KnownType(typeof(Dictionary<string,object>))]
public class TestResponse
{
    [DataMember]
    public Dictionary<string,object>[] Results;
} 
```

功能：

```
public TestResponse test(string test1, string test2)
    {
        TestResponse r = new TestResponse();
        r.Results = new Dictionary<string, object>[1];
        r.Results[0] = new Dictionary<string, object>();
        r.Results[0].Add("field1", 26);
        Dictionary<string, object>[] d = new Dictionary<string, object>[1];
        d[0] = new Dictionary<string, object>();
        d[0].Add("inner", 28);
        r.Results[0].Add("dictionary", d);
        return r;
    } 
```

运行它会给出错误消息，但我认为我得到了正确的 knowntype？

```
CISICPD.CPDClient t = new CISICPD.CPDClient();
CISICPD.TestResponse response = t.test("dgdf", "dfsdfd"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T15:44:57.363

您只需将以下属性添加到您的数据合同类。

```
[DataMember]
public object UsedForKnownTypeSerializationObject; 
```

所以现在生成的代理包含您在数据合同上设置的 Knowtypes。我有同样的问题，这是我想出的唯一解决方案。如果您的 DataContract 类没有 Object 类型的属性，则生成的代理不包含声明的 knowtypes

例如：

```
[DataContract]
[KnownType(typeof(List<String>))]
public class Foo
{
    [DataMember]
    public String FooName { get; set; }

    [DataMember]
    public IDictionary<String, Object> Inputs { get; set; }

    [DataMember]
    private Object UsedForKnownTypeSerializationObject{ get; set; }

} 
```

它不那么漂亮，因为你最终得到了一个没有任何功能实现的虚拟属性。但话又说回来，我没有其他解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:13:13.820

将此添加到 TestResponse 上的已知类型：

```
[KnownType(typeof(Dictionary<string, object>[]))] 
```

因为“d”是测试方法中的字典对象数组，并且您将其作为值存储在结果中，所以需要将类型添加到已知类型中。

查看此链接的“集合和已知类型”部分了解更多详细信息：http: [//msdn.microsoft.com/en-us/library/aa347850.aspx](http://msdn.microsoft.com/en-us/library/aa347850.aspx)

基本上，您将作为对象存储在结果中的任何类型都需要添加 KnownType。

# message - Content Script 和 Main 插件脚本之间的同步通信 - FireFox addon sdk

> ID：12475437
> 
> 赞同：4
> 
> 时间：2012-09-18T10:45:26.363
> 
> 标签：message, firefox-addon-sdk, synchronous, content-script

有没有办法在内容脚本和主插件脚本之间进行同步通信？

如果我为此创建一个这样的方法，那么该方法会立即返回。那么有什么方法可以等待主脚本响应然后处理结果呢？

## main.js

```
 worker.port.on("GetValue"),function(key)
 {
     worker.port.emit('GetValue',ss.storage[key]);
 } 
```

## 内容脚本

```
//get value from local storage

function GetValueFromLocalStorage(key) 
{
    self.port.emit("GetValue", key);

    self.port.on("GetValue", function (value) 
        { 
                return value;

        }); 
} 
```

如果这是可能的，那将是有益的，因为异步代码不干净和有条理，而且写起来是一场噩梦，尤其是当我必须多次访问此方法时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:42:35.233

不，附加 SDK 被设计为仅允许异步通信。最初的想法是最终基于 SDK 的扩展将在单独的进程中运行，而内容脚本必须在网页的进程中运行。不确定这个计划是否仍在实施，但这可能是异步 API 的主要原因 - 否则在不破坏所有扩展的情况下更改为多进程是不可能的。

显然，您可以使用低级 API 尤其是[chrome 权限](https://addons.mozilla.org/en-US/developers/docs/sdk/1.9/dev-guide/tutorials/chrome.html)直接同步访问网页。但是，如果代码可读性是您研究此问题的唯一原因，那么您将离开记录良好且受支持的领域，这可能不是最好的主意。

# java - 在 JBoss 中添加依赖 jar

> ID：12475440
> 
> 赞同：0
> 
> 时间：2012-09-18T10:45:34.760
> 
> 标签：java, jboss7.x

我在 JBoss 7 中部署了一个 .jar 文件。现在我在 JBoss 中部署的 .jar 文件依赖于其他一些 3rd 方 jars.so 我如何在 JBoss 中添加这些第三方 jars？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:03:15.400

创建一个 JBoss 模块并将其作为依赖项添加到您的 .jar 中。这是[JBoss 模块 API](https://docs.jboss.org/author/display/MODULES/Home)。这是示例[JBoss 模块部署](https://docs.jboss.org/author/display/AS7/Class+Loading+in+AS7)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T20:52:53.610

您可以将您的应用程序打包为 .war 或 .ear 并在其中包含您的依赖项。我发现这比将代码添加为模块更容易部署和管理（使用 Maven）。

也就是说，如果您需要在多个应用程序中重用您的依赖库，您可以选择按照@Sai Ye Yan Naing Aye 的建议将其安装为一个模块。数据库连接器/驱动程序就是一个很好的例子。

我最近发现的另一种迫使您将库安装为模块的情况是当另一个模块需要访问该库时。例如，Hibernate Validator 是 JBoss AS7 内置的——但为了使用它的@SafeHTML 标签，您需要添加 JSoup 库。您不能简单地将它包含在您的应用程序中，因为模块似乎无法访问您战争中的库 - 因此您必须将其添加为模块。

# caching - 如何在 hazelcast 控制台中查看特定地图？

> ID：12475442
> 
> 赞同：1
> 
> 时间：2012-09-18T10:45:45.473
> 
> 标签：caching, hazelcast

当我们从控制台使用 Hazelcast 时，它有一个名为 m 的默认地图。我们可以做 - m.put 、 m.get 等。但假设我想创建一个命名地图，或者我想查看某个应用程序已经创建的地图。hazelcast 控制台有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T05:05:05.140

您可以使用命令 ns [the_map_name] //切换命名空间以使用分布式队列/map/set/list（默认为“default”）

m 不是地图的名称，它是命令的一部分。

例如，您有一张名为“students”的地图，并希望在该地图中添加一条新记录。你应该：

```
> ns students  
> m.put(key, value) 
```

# entity-framework - An item with the same key has already been added in Entity Framework

> ID：12475443
> 
> 赞同：0
> 
> 时间：2012-09-18T10:45:50.680
> 
> 标签：entity-framework

I have table with 2 foreign keys. when I am trying to insert duplicate value (for foreign keys) it gives erroe says "An item with the same key has already been added"

below is my code

```
CheckListTrack CheckListtrack = new CheckListTrack();
trackId = entityCollection.WorkItemTrack.Max(p => p.TrackID) ;
foreach (int ListID in tracklist)
{
    CheckListtrack.WorkItemTrackReference.EntityKey = new EntityKey("SEIESSEntities.WorkItemTrack", "TrackID", trackId);   // foreign key

    CheckListtrack.CheckListReference.EntityKey = new EntityKey("SEIESSEntities.CheckList", "CheckListID", ListID);     // foreign key

    entityCollection.AddToCheckListTrack(CheckListtrack); // error comes after second time control passes here

    }
    curentScope.Complete();
    success = true; 
```

Please help me

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:54:31.260

错误是您将同一实体多次放入实体集合。您必须在 foreach 循环中创建新的 CheckListTrack() 实体。我猜 CheckListTrack 有它自己的主键自动增量？

# jquery - How to disable drop for all elements of page except 2 div

> ID：12475446
> 
> 赞同：0
> 
> 时间：2012-09-18T10:46:03.483
> 
> 标签：jquery, drag-and-drop

I have a page (created not by me) with two divs. This divs contains some span elements, they can be drag&dropped between this divs. This functionality implemented using jQuery draggable and droppable function. But user is able to drop span element not only at div, but at any place of page. Question is: how can I prevent this? I need to disable dropping span at any place except this divs. Dragged span should return to place where it was taken.

Can I make it with JQuery?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:00:57.863

将[`revert`](http://jqueryui.com/demos/draggable/#option-revert)可拖动对象的选项设置为，`invalid`以便它们在未放置在兼容的可放置对象上时返回到其原始位置。

droppables 还应该具有[`accept`](http://jqueryui.com/demos/droppable/#option-accept)适当设置的选项以接受draggables。

# python - Python 3: Unroll arguments from tuple

> ID：12475448
> 
> 赞同：10
> 
> 时间：2012-09-18T10:46:14.300
> 
> 标签：python, arguments, tuples

Given a Python tuple `t = v1, v2, v3` is there a utility to unpack these so that given:

```
def foo(v1,v2,v3): pass 
```

Instead of this:

```
foo(t[0],t[1],t[2]) 
```

You can do this:

```
foo(unpack(t)) 
```

I'd like to know of any such utility available for tuples and/or lists.

Sincere thanks.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-18T10:49:05.193

是的。您可以使用拆包运算符 ( `'*'`)

```
foo(*t) 
```

请注意，如果 t 是 a `list`，`tuple`，甚至是生成器，则此方法有效

* * *

有一种类似的方法可以使用`**`映射对象（通常是字典）上的运算符将参数传递给带有关键字的函数：

```
def foo(key=None,foo=None):
    pass #...

foo(**{key:1,foo:2}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:49:11.403

[解压](http://docs.python.org/tutorial/controlflow.html#tut-unpacking-arguments)参数列表：

```
foo(*(v1, v2, v3)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:48:56.987

使用`*args`参数传递：

```
foo(*t) 
```

演示：

```
>>> def foo(v1, v2, v3):
...     print(v1, v2, v3)
...
>>> t = 1, 2, 3
>>> foo(*t)
1 2 3 
```

# ios - Prevent dispatch_after() background task from being executed

> ID：12475450
> 
> 赞同：12
> 
> 时间：2012-09-18T10:46:18.890
> 
> 标签：ios, cocoa-touch, grand-central-dispatch

This is my issue. When my application enters background I want it to perform a function after certain period of time. This is what I do:

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    isRunningInBackground = YES;

    taskIdentifier = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:nil];

    int64_t delayInSeconds = 30;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(void)
    {
        [self doSomething];
    });
}

- (void)doSomething
{
   NSLog(@"HELLO");
} 
```

`taskIdentifier` variable is declared in myAppDelegate.h file like this:

```
UIBackgroundTaskIdentifier taskIdentifier; 
```

Everything works as it supposed to, I see that console prints HELLO just right after 30 seconds are gone. But I don't want `doSomething` to be executed if the app enters foreground until 30 seconds are over. So I need to cancel it. This is how i do that:

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{    
    isRunningInBackground = NO;
    [self stopBackgroundExecution];
}

- (void)stopBackgroundExecution
{
    [[UIApplication sharedApplication] endBackgroundTask:taskIdentifier];
    taskIdentifier = UIBackgroundTaskInvalid;
} 
```

But unfortunately it doesn't cancel `doSomething`, it is still performed. What am I doing wrong? How do I cancel that function?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-18T11:36:50.807

为什么还要使用 GCD？当您的应用程序返回到前台时，您可以只使用`NSTimer`并使其无效。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-02-04T14:17:54.680

**有点不同的方法** 好吧，所以，收集了所有答案和可能的解决方案，对于这种情况（保持简单性）来说，最好的方法似乎是在需要时调用`performSelector:withObject:afterDelay:`并取消它`cancelPreviousPerformRequestsWithTarget:`。就我而言 - 就在安排下一次延迟通话之前：

```
[NSObject cancelPreviousPerformRequestsWithTarget: self selector:@selector(myDelayedMethod) object: self];

[self performSelector:@selector(myDelayedMethod) withObject: self afterDelay: desiredDelay]; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-15T08:41:44.290

`dispatch_after` [我在这里](https://stackoverflow.com/a/37829673/5315714)回答了关于取消的问题。但是当我谷歌寻找解决方案时，它也会让我回到这个线程，所以......

iOS 8 和 OS X Yosemite 引入`dispatch_block_cancel`了允许您在开始执行之前取消块。[您可以在此处](https://stackoverflow.com/a/37829673/5315714)查看有关该答案的详细信息

使用`dispatch_after`您在该函数中创建的变量可以获得好处，并且看起来无缝。如果您使用`NSTimer`，那么您必须创建一个`Selector`并发送您需要`userInfo`的变量或将该变量转换为全局变量。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-05-14T23:27:25.853

这个答案必须在这里发布：[取消 dispatch_after() 方法？](https://stackoverflow.com/questions/28088014/cancel-dispatch-after-method)，但这是作为重复关闭的（实际上不是）。无论如何，这是谷歌为“dispatch_after cancel”返回的地方，所以......

这个问题非常基础，我敢肯定有些人想要一个真正通用的解决方案，而无需求助于各种平台特定的东西，如运行循环计时器、包含实例的布尔值和/或重块魔法。GCD 可以用作常规的 C 库，并且可能根本没有计时器之类的东西。

幸运的是，有一种方法可以取消任何生命周期方案中的任何调度块。

1.  我们必须为传递给 dispatch_after（或 dispatch_async，并不重要）的每个块附加一个动态句柄。
2.  此句柄*必须*存在，直到块被实际触发。
3.  这个句柄的内存管理并不那么明显——如果块释放了句柄，那么我们可以稍后取消对悬空指针的引用，但如果我们释放它，块可能会在以后这样做。
4.  因此，我们必须按需传递所有权。
5.  有 2 个块 - 一个是无论如何都会触发的*控制块*，第二个是可以取消的*有效载荷。*

* * *

```
struct async_handle {
    char didFire;       // control block did fire
    char shouldCall;    // control block should call payload
    char shouldFree;    // control block is owner of this handle
};

static struct async_handle *
dispatch_after_h(dispatch_time_t when,
                 dispatch_queue_t queue,
                 dispatch_block_t payload)
{
    struct async_handle *handle = malloc(sizeof(*handle));

    handle->didFire = 0;
    handle->shouldCall = 1; // initially, payload should be called
    handle->shouldFree = 0; // and handles belong to owner

    payload = Block_copy(payload);

    dispatch_after(when, queue, ^{
        // this is a control block

        printf("[%p] (control block) call=%d, free=%d\n",
            handle, handle->shouldCall, handle->shouldFree);

        handle->didFire = 1;
        if (handle->shouldCall) payload();
        if (handle->shouldFree) free(handle);
        Block_release(payload);
    });

    return handle; // to owner
}

void
dispatch_cancel_h(struct async_handle *handle)
{
    if (handle->didFire) {
        printf("[%p] (owner) too late, freeing myself\n", handle);
        free(handle);
    }
    else {
        printf("[%p] (owner) set call=0, free=1\n", handle);
        handle->shouldCall = 0;
        handle->shouldFree = 1; // control block is owner now
    }
} 
```

* * *

而已。

要点是“所有者”应该收集句柄，直到它不再需要它们为止。dispatch_cancel_h() 用作句柄的[可能延迟的]析构函数。

C 所有者示例：

```
size_t n = 100;
struct after_handle *handles[n];

for (size_t i = 0; i < n; i++)
    handles[i] = dispatch_after_h(when, queue, ^{
        printf("working\n");
        sleep(1);
    });

...

// cancel blocks when lifetime is over!

for (size_t i = 0; i < n; i++) {
    dispatch_cancel_h(handles[i]);
    handles[i] = NULL; // not our responsibility now
} 
```

Objective-C ARC 示例：

```
- (id)init
{
    self = [super init];
    if (self) {
        queue = dispatch_queue_create("...", DISPATCH_QUEUE_SERIAL);
        handles = [[NSMutableArray alloc] init];
    }
    return self;
}

- (void)submitBlocks
{
    for (int i = 0; i < 100; i++) {
        dispatch_time_t when = dispatch_time(DISPATCH_TIME_NOW, (random() % 10) * NSEC_PER_SEC);

        __unsafe_unretained id this = self; // prevent retain cycles

        struct async_handle *handle = dispatch_after_h(when, queue, ^{
            printf("working (%d)\n", [this someIntValue]);
            sleep(1);
        });
        [handles addObject:[NSValue valueWithPointer:handle]];
    }
}

- (void)cancelAnyBlock
{
    NSUInteger i = random() % [handles count];
    dispatch_cancel_h([handles[i] pointerValue]);
    [handles removeObjectAtIndex:i];
}

- (void)dealloc
{
    for (NSValue *value in handles) {
        struct async_handle *handle = [value pointerValue];
        dispatch_cancel_h(handle);
    }
    // now control blocks will never call payload that
    // dereferences now-dangling self/this.
} 
```

笔记：

*   dispatch_after() 本来是保留队列的，所以会一直存在，直到所有控制块都执行完。
*   如果有效负载被取消（或所有者的生命周期结束）并且控制块被执行，则 async_handles 被释放。
*   与 dispatch_after() 和 dispatch_queue_t 的内部结构相比，async_handle 的动态内存开销绝对很小，后者保留了要提交的实际块数组并在适当时将它们出列。
*   你可能注意到 shouldCall 和 shouldFree 实际上是同一个倒置标志。但是如果这些不依赖于“自我”或其他与所有者相关的数据，您的所有者实例可能会传递所有权甚至 -[dealloc] 本身而不实际取消有效负载块。这可以通过 dispatch_cancel_h() 的附加 shouldCallAnyway 参数来实现。
*   *警告说明*：此解决方案还缺少 didXYZ 标志的同步，并可能导致控制块和取消例程之间的竞争。使用 OSAtomicOr32Barrier() & co 进行同步。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-10-23T18:35:14.493

由于**iOS 10**和**Swift 3** GCD`DispatchWorkItem`是可以取消的。只需为工作项保留一个实例并检查它是否尚未取消，然后将其取消：

```
// Create a work item
let work = DispatchWorkItem {
    print("Work to be done or cancelled")
}

// Dispatch the work item for executing after 2 seconds
DispatchQueue.main.asyncAfter(deadline: .now() + .seconds(2), execute: work)

// Later cancel the work item
if !work.isCancelled {
    work.cancel()
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-18T11:25:24.547

`endBackgroundTask`不取消后台任务。它告诉系统您的后台任务已完成。所以你应该在“做某事”之后调用它。`doSomething`如果您的应用程序再次处于前台，为了防止被执行，您可以使用您的`isRunningInBackground`标志：

```
dispatch_after(popTime, dispatch_get_global_queue(...), ^(void) {
    if (isRunningInBackground) {
        [self doSomething];
    }
    [[UIApplication sharedApplication] endBackgroundTask:taskIdentifier];
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-18T11:27:27.140

我认为你不能取消它，但你可以在执行 doSomething 之前检查任务状态

```
dispatch_after(popTime, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(void)
  {

    if(taskIdentifier != UIBackgroundTaskInvalid) {
        [self doSomething];
    }

  }); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-28T13:13:18.473

[https://developer.apple.com/documentation/dispatch/1431058-dispatch_block_cancel](https://developer.apple.com/documentation/dispatch/1431058-dispatch_block_cancel)

**dispatch_block_cancel** *异步取消指定的调度块。*

```
void dispatch_block_cancel(dispatch_block_t block); 
```

*（iOS 8.0+、macOS 10.10+、tvOS 9.0+、watchOS 2.0+）*

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-19T23:44:16.550

这是一个更通用的回答，尽管我认为它仍然可以很好地回答您的问题。而不是“isRunningInBackground”，而是保持你上次后台/前台的时间；使用您在后台运行的时间作为 dispatch_after 的局部变量。在调用 doSomething 之前检查你的 dispatch_after。下面是我更具体的问题....

我正在制作一长串需要在不同时间启动的动画，如果我使用 setBeginTime 同时确保模型层在正确的时间更新到表示层等，它们会相互踩踏……所以我开始了使用 dispatch_after，除了不能“取消”它们（这对我来说很重要，尤其是当我想重新启动一系列动画时）。

我`CFTimeInterval startCalled;`在我的 UIView 实例上保留一个，然后在我的内部`-(void) start`有：

```
startCalled = CACurrentMediaTime();
CFTimeInterval thisStartCalled = startCalled; 
```

在每个`dispatch_after`块的开头，我有：

```
if (thisStartCalled != startCalled) return; 
```

这让我可以一次性设置好所有东西，但我的模型层只在他们应该开始的时候*在他们的 CATransaction 块内更新。*

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-05-06T23:49:53.463

您绝对可以用标志取消它。我写了一个小函数来做，基本上我们传递一个 BOOL 指针来控制块是否被取消。

```
void dispatch_with_cancellation(void (^block)(), BOOL* cancellation) {
    dispatch_time_t time = dispatch_time(DISPATCH_TIME_NOW, 3 * NSEC_PER_SEC);
    dispatch_after(time, dispatch_get_main_queue(), ^{
        if (!*cancellation) {
            block();
        }
    });
}

int main(int argc, char *argv[]) {
    @autoreleasepool {
        void (^block)() = ^{
            NSLog(@"%@", @"inside block");
        };
        BOOL cancellation;
        dispatch_with_cancellation(block, &cancellation);
        // cancel the block by setting the BOOL to YES.
        *&cancellation = YES;
        [[NSRunLoop currentRunLoop] run];
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-06T11:12:22.457

我使用以下方法在不阻塞主线程的情况下消除搜索抖动。

创建一个全局变量来存储块

```
dispatch_block_t searchBlock; 
```

检查它是否存在并取消它（仅当它尚未发送时）

```
 if (searchBlock) {
        dispatch_block_cancel(searchBlock);
    } 
```

定义块

```
 searchBlock = dispatch_block_create(DISPATCH_BLOCK_INHERIT_QOS_CLASS, ^{
        //Do Something
    }); 
```

执行它

```
 dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), serialQueue, searchBlock); 
```

##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]

| ##NAME## [##LINK##](#) |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |

.....提前致谢 我认为以下将是第 1 步。  <title>Title</title>##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]##NAME## [##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##第 2 步是使用 CSS 创建布局。您可以在此网站上访问一些 CSS 布局教程：http: //www.maxdesign.com.au/articles/css-layouts/ androidemailhtml 4 3 回答 3 This answer is useful 1 对于您需要编写的每个元素：Your text然后制作 style.css 文件。您可以在记事本中制作并写入： #text1 { padding-left 8px; color:#000000; width:90px; } @text2 { ... } 您可以在以下位置查看 CSS 属性的完整列表：http: //www.w3schools.com/cssref/default.asp 于 2012-09-18T11:29:30.040 回答 This answer is useful 1 以下是完整的 HTML5 代码。它与您的模型完全一样显示（实际上只有三行，而不是五行）：  <title>Title</title>  ##HEADER##   [##TEXT1##](#), [##TEXT2##](#), [##TEXT3##](#)##NAME##[##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##......希望能帮助到你。 于 2012-09-18T12:11:12.830 回答 This answer is useful 0 我认为以下将是第 1 步。  <title>Title</title>##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]##NAME## [##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##第 2 步是使用 CSS 创建布局。您可以在此网站上访问一些 CSS 布局教程：http: //www.maxdesign.com.au/articles/css-layouts/ 于 2012-09-18T11:13:36.697 回答 Related 2 verilog - 我了解verilog的基础知识，但测试台没有意义 1 java - Android SeekBar 值未正确传递给计算方法 0 javascript - 包括对 $.getJSON 的身份验证 1 c# - 在 C# 中，如何使日期时间选择器的值依赖于另一个日期时间选择器 1 javascript - Magento - 放大类别页面/产品视图以外的其他页面？ 1 php - 更新多行mysql 1 android - 将日期格式化为mysql格式 1 sql-server - SQL Server 2008 Varbinary(Max) 列 - 创建 3.2Gb 数据库的 28Mb 图像 1 apache-pig - 通过在猪拉丁语中取出匹配的正则表达式来过滤结果 2 iphone - 在 removeFromSuperview 之后调用 addSubview Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641 <link href="../Styles/Style.css" type="text/css" rel="stylesheet">

# android - 如何使用 代替 如何在这个 html 中使用标签而不是标签？我使用这个 html 从我的 android 应用程序发送电子邮件。Html.fromHtml()不支持标签。因此

，我想替换

标签。但我想要表格格式的内容。我该怎么做？ 问问题 问问题 2012-09-18T10:46:25.790 2500 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 如何在这个 html 中使用标签而不是

标签？我使用这个 html 从我的 android 应用程序发送电子邮件。Html.fromHtml()不支持标签。因此

，我想替换

标签。但我想要表格格式的内容。我该怎么做？ <title>Title</title>##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]

| ##NAME## [##LINK##](#) |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |
| ##TITLE## | ##VALUE## |

.....提前致谢 我认为以下将是第 1 步。  <title>Title</title>##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]##NAME## [##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##第 2 步是使用 CSS 创建布局。您可以在此网站上访问一些 CSS 布局教程：http: //www.maxdesign.com.au/articles/css-layouts/ androidemailhtml 4 3 回答 3 This answer is useful 1 对于您需要编写的每个元素：Your text然后制作 style.css 文件。您可以在记事本中制作并写入： #text1 { padding-left 8px; color:#000000; width:90px; } @text2 { ... } 您可以在以下位置查看 CSS 属性的完整列表：http: //www.w3schools.com/cssref/default.asp 于 2012-09-18T11:29:30.040 回答 This answer is useful 1 以下是完整的 HTML5 代码。它与您的模型完全一样显示（实际上只有三行，而不是五行）：  <title>Title</title>  ##HEADER##   [##TEXT1##](#), [##TEXT2##](#), [##TEXT3##](#)##NAME##[##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##......希望能帮助到你。 于 2012-09-18T12:11:12.830 回答 This answer is useful 0 我认为以下将是第 1 步。  <title>Title</title>##HEADER##   [##TEXT1##](#), [>##TEXT2##](#), [>##TEXT3##](#) ]##NAME## [##LINK##](#)##TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE####TITLE####VALUE##第 2 步是使用 CSS 创建布局。您可以在此网站上访问一些 CSS 布局教程：http: //www.maxdesign.com.au/articles/css-layouts/ 于 2012-09-18T11:13:36.697 回答 Related 2 verilog - 我了解verilog的基础知识，但测试台没有意义 1 java - Android SeekBar 值未正确传递给计算方法 0 javascript - 包括对 $.getJSON 的身份验证 1 c# - 在 C# 中，如何使日期时间选择器的值依赖于另一个日期时间选择器 1 javascript - Magento - 放大类别页面/产品视图以外的其他页面？ 1 php - 更新多行mysql 1 android - 将日期格式化为mysql格式 1 sql-server - SQL Server 2008 Varbinary(Max) 列 - 创建 3.2Gb 数据库的 28Mb 图像 1 apache-pig - 通过在猪拉丁语中取出匹配的正则表达式来过滤结果 2 iphone - 在 removeFromSuperview 之后调用 addSubview Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：12475452
> 
> 赞同：0
> 
> 时间：
> 
> 标签：android, email, html

如何在这个 html 中使用`<div>`标签而不是`<table>`标签？我使用这个 html 从我的 android 应用程序发送电子邮件。`Html.fromHtml()`不支持标签。因此`<table>`，我想替换`<table>`标签。但我想要表格格式的内容。我该怎么做？

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Title</title>
</head>
<body style="background: #FFFFFF; margin: auto; font-family: Helvetica; color: #808080; ">
<div style="width:537px; margin:auto; ">
    <div style="float:left; width: 537px; color:#000000; margin-bottom:15px; margin-bottom:10px;">
    ##HEADER## &nbsp; <a href="#" style="color:#3A41A1;">##TEXT1##</a>, <a href="#" style="color:#3A41A1;">>##TEXT2##</a>, <a href="#" style="color:#3A41A1;">>##TEXT3##</a> ]
    </div>

    <table style="width:537px; background:#DAFFF5; float:left; margin-top:10px; border-collapse:collapse; font-size:14px;">
    <tr>
        <td colspan="2" style="padding:8px;  border: 1px solid black;"><span style="color:#FF6A00; font-weight:bold; text-transform:capitalize; text-align:left;">##NAME##</span> <a href="#" style="color:#006BF2; float:right;">##LINK##</a></td>

    </tr>

     <tr>
        <td style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</td>
        <td style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</td>
     </tr>
     <tr>
        <td style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</td>
        <td style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</td>
     </tr>
     <tr>
        <td style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</td>
        <td style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</td>
     </tr>
     <tr>
        <td style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</td>
        <td style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</td>
     </tr>

     <tr>
        <td style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</td>
        <td style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</td>
     </tr>
    </table>
   .....

</div>
</body>
</html> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:29:30.040

对于您需要编写的每个元素：

```
<div id="text1">Your text</div> 
```

然后制作 style.css 文件。您可以在记事本中制作并写入：

```
#text1 {
padding-left 8px;
color:#000000;
width:90px;
}

@text2 {
...
} 
```

您可以在以下位置查看 CSS 属性的完整列表：http: [//www.w3schools.com/cssref/default.asp](http://www.w3schools.com/cssref/default.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T12:11:12.830

以下是完整的 HTML5 代码。它与您的模型完全一样显示（实际上只有三行，而不是五行）：

```
<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Title</title>
<style>
body {
    background: #FFFFFF;
    margin: auto;
    font-family: Helvetica;
    color: #808080;
}
a {
    color: #3A41A1;
}
#wrapper {
    width: 537px;
    margin: auto;
}
#header {
    width: 100%;
    color: #000000;
    margin-bottom: 15px;
}
#content {
    width: 100%;
    background: #DAFFF5;
    margin-top: 10px;
    border-collapse: collapse;
    font-size: 14px;
    display: table;
}
.row {
    display: table-row;
    padding: 8px;
    border: 1px solid black;
}
.cell-header {
    padding: 8px;
    display: table-cell;
}
.cell-left {
    display: table-cell;
    padding: 8px;
    border: 1px solid black;
    color: #006BF2;
    width: 90px;
}
.cell-right {
    display: table-cell;
    padding: 8px;
    border: 1px solid black;
    color: #000000;
    text-align: left;
}
</style>
</head>
<body>
    <div id="wrapper">
        <div id="header">
            ##HEADER## &nbsp; <a href="#">##TEXT1##</a>, <a href="#">##TEXT2##</a>, <a href="#">##TEXT3##</a>
        </div>

        <div id="content">
            <div class="row">
                <div class="cell-header" style="color:#FF6A00; font-weight:bold; text-transform:capitalize; text-align: left;">##NAME##</div>
                <div class="cell-header" style="text-align: right;"><a href="#" style="color:#006BF2;">##LINK##</a></div>
            </div>
            <div class="row">
               <div class="cell-left">
                   ##TITLE##
               </div>
               <div class="cell-right">
                   ##VALUE##
               </div>
            </div>
            <div class="row">
               <div class="cell-left">
                   ##TITLE##
               </div>
               <div class="cell-right">
                   ##VALUE##
               </div>
            </div>
            <div class="row">
               <div class="cell-left">
                   ##TITLE##
               </div>
               <div class="cell-right">
                   ##VALUE##
               </div>
            </div>
        </div>
        ......
    </div></body></html> 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:13:36.697

我认为以下将是第 1 步。

```
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Title</title>
</head>
<body style="background: #FFFFFF; margin: auto; font-family: Helvetica; color: #808080; ">
<div style="width:537px; margin:auto; ">
  <div style="float:left; width: 537px; color:#000000; margin-bottom:15px; margin-bottom:10px;">
##HEADER## &nbsp; <a href="#" style="color:#3A41A1;">##TEXT1##</a>, 
  <a href="#" style="color:#3A41A1;">>##TEXT2##</a>, 
  <a href="#" style="color:#3A41A1;">>##TEXT3##</a> ]
</div>

<div style="width:537px; background:#DAFFF5; float:left; margin-top:10px; border-collapse:collapse; font-size:14px;">
<div>
    <div style="padding:8px;  border: 1px solid black;">
    <span style="color:#FF6A00; font-weight:bold; text-transform:capitalize; text-align:left;">##NAME##</span> 
        <a href="#" style="color:#006BF2; float:right;">##LINK##</a>
    </div>
</div>

 <div>
    <div style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</div>
       <div style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</div>
 </div>
 <div>
    <div style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</div>
    <div style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</div>
 </div>
 <div>
    <div style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</div>
    <div style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</div>
 </div>
 <div>
    <div style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</div>
    <div style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</div>
 </div>

 <div>
    <div style="padding:8px; border: 1px solid black; color:#006BF2; width: 90px;">##TITLE##</div>
    <div style="padding:8px; border: 1px solid black; color:#000000; text-align:left; ">##VALUE##</div>
 </div>
</div>

</div>
</body>
</html> 
```

第 2 步是使用 CSS 创建布局。您可以在此网站上访问一些 CSS 布局教程：http: [//www.maxdesign.com.au/articles/css-layouts/](http://www.maxdesign.com.au/articles/css-layouts/)

# c# - C#中的命令行

> ID：12475455
> 
> 赞同：0
> 
> 时间：2012-09-18T10:46:56.940
> 
> 标签：c#, command-line, console

我有一个要从命令提示符运行的工具。

代码如下

```
 static void Main(string[] args)
    {

        string User;            
        if (args[0].Length  != 0)
        {
             User = args[0];
        }
        else
        {
        Console.Write("Please Enter the Username");
        User = Console.ReadLine();
        } 
```

如果我在命令提示符下没有在我的“tool.exe”之后给出用户名或第一个参数，它会抛出一个异常，如“索引超出数组范围”

我想要输出，如果我没有给出论点 - 它应该提示我给出用户名。请帮帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:48:59.687

`args`是一个数组，是你应该检查的长度。当您检查时，`args[0].Length`您实际上假设数组中已经至少有一个元素，因此您正在检查`Length`第一项。

尝试

```
if (args.Length != 0) 
```

相反，它检查命令行参数数组的长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:48:33.157

您不想调用`Length`该项目。

```
 \/ Change here
     if (args.Length  != 0)
    {
         User = args[0];
    }
    else
    {
    Console.Write("Please Enter the Username");
    User = Console.ReadLine();
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:49:27.633

您需要将 if 更改为：

```
static void Main(string[] args)
{

    string User;            
    if (args.Length  != 0) // Change from args[0] to args
    {
         User = args[0];
    }
    else
    {
    Console.Write("Please Enter the Username");
    User = Console.ReadLine();
    }
} 
```

在这个电话之后，确保你在 `string.IsNullOrEmpty(User)` 使用它之前做了一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T10:50:47.067

做这个

```
static void Main(string[] args)
{

string User;            
if (args.Length > 0)
{
     User = args[0];
}
else
{
Console.Write("Please Enter the Username");
User = Console.ReadLine();
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T10:50:31.747

您必须检查参数数组的长度，即参数的数量。目前您正在检查 args[0] 的大小。

```
if (args.Length  != 0)
{
  // command have some params
}
else
{
 // command have no params
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T10:54:37.800

只需替换以下行：

> if (args[0].Length != 0)

使用以下代码：

```
if(arg.Length !=0) <br> 
```

在您的代码中，您在 args 数组中引用了项目 0，然后检查其长度。
由于要检查数组长度，请使用数组本身的 Length 属性

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-18T10:59:07.917

通过这样做，您正在查看集合 string[] 中的第一个元素。

```
if (args[0].Length  != 0) 
```

如果没有任何参数，这将给出一个例外。如果要检查是否有任何参数，正确的语句如下。

```
if (args.Length  != 0)
//Or this
if (args.Any()) 
```

注意 Any() 是命名空间 System.Linq 的一部分。

# mediawiki - mediawiki markup: not to break numbering in multilevel lists

> ID：12475460
> 
> 赞同：0
> 
> 时间：2012-09-18T10:47:29.467
> 
> 标签：mediawiki, wiki

Is there a way not to break numbering in multilevel lists?

our management people want this

```
 # item 1
 # item 2
 ## subitem 2.1
 ## subitem 2.2
 # item 3 
```

to be displayed as

```
1\. item 1
2\. item 2
   2.1 item 2.1
   2.2 item 2.2
3\. item 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:59:16.257

这不是 mediawiki 问题：MW 不输出数字，而只是输出有序列表标签 (html: `<ol>`)。`ol`根据元素的 CSS 规则在浏览器中进行编号。

使用计数器和内容插入可能会通过一些棘手的 CSS 来改变这种行为。

# php - perserve user search options in php

> ID：12475461
> 
> 赞同：-1
> 
> 时间：2012-09-18T10:47:37.877
> 
> 标签：php

I am working on PHP application.i have a search from in which user can select many options to refine his search like month,year,group,departement etc.

Now user submits the forms and gets the results based on his search options.User navigates to other forms in the application.When user comes back to search page i need top present him the old search options.

Please share your thoughts on it

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:51:12.343

执行此操作的常用方法是使用`$_SESSION`.

对于他进行的每次搜索，都会在会话中保存他的所有选项，然后将他选择的内容应用到您的表单中。

例如：

```
foreach($department as $key => $val){
    $selected = '';
    if($key == $_SESSION['department']){
        $selected = ' selected="selected"';
    }
    echo '<option value="'.$key.'">'.$val.'</option>';
} 
```

在他提交表单后，您设置了该会话：

```
$_SESSION['department'] = $_POST['department']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T10:51:17.520

在这种情况下，您可以使用`session`来存储搜索查询。

每当您更改搜索条件时，都会更改`session`.

但这不是一个好的做法，根据您的要求，这是最好的解决方案。

另一件事是您可以将搜索条件附加到 URL，这是最好的和首选的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T10:55:56.047

您可以使用会话或 cookie 来执行此操作。当您提交表单时，只需将数据存储在会话或 cookie 中，当表单正在构建时，只需检查会话值是否存在。如果存在，只需将元素的值放入相应的表单元素（文本框、文本区域等）中。

```
<input type="text" value="<?php if((isset($_SESSION['location'])) && ($_SESSION['location'] != '')) echo $_SESSION['location']; ?>" name="location" /> 
```

因此，当用户在搜索后重新导航时，将能够看到他/她的搜索值，因为它们将出现在表单字段中。

# javascript - HTML5 websockets: max number of open connections?

> ID：12475462
> 
> 赞同：53
> 
> 时间：2012-09-18T10:47:39.560
> 
> 标签：javascript, html, web-applications, websocket

HTML5 websockets are (and [have been for some time](https://stackoverflow.com/questions/6224771/disadvantages-of-websockets)) a hot topic as they elegantly enable *real-time* [server-side push](http://en.wikipedia.org/wiki/Push_technology#HTTP_server_push).

I currently have a working application with websockets powered by Tomcat 7.0.30 which includes [websocket support](http://www.tomcatexpert.com/blog/2012/05/01/how-apache-tomcat-implemented-websocket). But moving this to a production environment raises questions.

Mainly I would like to know the possible maximum number of connections that can operate (be *open*) concurrently per *browsing session*; a *browsing session* implies a single browser tab or window.

Do open websocket connections add up to the maximum number of connections that can be processed simultaneously by the Web server? E.g. [`MaxClients`](http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxclients) in Apache.

Conversely, is the maximum number of websockets for a single *browsing session* limited by the browser itself? As this [blog post](http://blog.dennis-boldt.de/?p=177) shows, up to April 2012, different browsers support varying amounts of *open* websocket connections. (I personally would aim for 1 open websocket per *browsing session*; but this info would still be good to know).

**TL/DR:**

1.  What limits the amount of possible websockets *per browsing session*? Is it the client? The server? Or a combination of both?
2.  Does the same limitation(s) apply to both `ws:` and `wss:` connections?

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-02-10T03:34:31.890

*浏览器的最大连接*默认值没有标准规范。它取决于实现 [0]。*此外，对于同一个应用程序，每个浏览会话*使用多个 web-socket似乎有点过头了，因为您可以使用 pub/sub 通道。

连接的瓶颈通常在服务器端。Web-socket 是对 HTTP 的升级，因此连接“只是”升级了 HTTP(TCP) 连接 [1]。HTTPS 和 WSS 只是为正常连接添加了一个安全层。它们不是不同的连接 [2]。在您的情况下，请检查*maxConnections*（和*maxThreads*）[3] 和您的操作系统最大值 [4][5]。如果您的并发连接数达到数万，也许您应该开始考虑负载平衡或集群 [6]。

[0] [https://code.google.com/p/chromium/issues/detail?id=85323](https://code.google.com/p/chromium/issues/detail?id=85323)

[1] [http://en.wikipedia.org/wiki/WebSocket](http://en.wikipedia.org/wiki/WebSocket)

[2] [http://en.wikipedia.org/wiki/HTTP_Secure](http://en.wikipedia.org/wiki/HTTP_Secure)

[3] [http://tomcat.apache.org/tomcat-7.0-doc/config/http.html](http://tomcat.apache.org/tomcat-7.0-doc/config/http.html)

[4] [https://serverfault.com/questions/10852/what-limits-the-maximum-number-of-connections-on-a-linux-server](https://serverfault.com/questions/10852/what-limits-the-maximum-number-of-connections-on-a-linux-server)

[5] [https://superuser.com/questions/251596/is-there-a-hard-limit-of-65536-open-tcp-connections-per-ip-address-on-linux](https://superuser.com/questions/251596/is-there-a-hard-limit-of-65536-open-tcp-connections-per-ip-address-on-linux)

[6] [http://tomcat.apache.org/tomcat-7.0-doc/config/cluster.html](http://tomcat.apache.org/tomcat-7.0-doc/config/cluster.html)

更多关于高并发：[http ://www.kegel.com/c10k.html](http://www.kegel.com/c10k.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-18T11:02:00.703

在 Gecko 7 中，他们引入了`network.websocket.max-connections`可以设置的参数`about:config`。它根据以下内容“一次”设置最大 websocket 连接数： [https ://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)

我不知道您是否可以从代码中确定此数字，以及是否有任何方法可以确定其他会话中打开了多少（所以您还剩下多少）。

# c++ - Trace/BPT trap in C++ program in AIX Box

> ID：12475473
> 
> 赞同：0
> 
> 时间：2012-09-18T10:48:11.060
> 
> 标签：c++, aix

I get the Trace/BPT trap core dump, when I try to run my exe. Please let me know your suggestions.

```
 time /backup/SStore/CODE/Smain.exe 00257947
SROMain running with trace level. 0

 InitEstimateServer
About to SetUpStockBuildMonitorSet up StockBuildMonitorProcessed 2 records

Trace/BPT trap(coredump)
real    0m14.17s
user    0m9.88s
sys     0m0.08s 
```

and after trying to debug it through dbx(core file) below is the output:

```
/usr/bin/dbx32 /backup/SStore/CODE/Smain.exe core
Type 'help' for help.
[using memory image in core]
reading symbolic information ...
Trace/BPT trap in SalcDayList::GetNumberOfDeliveries() at line 92 in file "/backup/SStore/CODE/salclist.C" ($t1)
 92             return m_numberOfDels; 
```

Please suggest a remedy....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:56:11.963

您可能在编译阶段打开了数组边界检查（或类似的东西）。这会产生一个产生该消息的陷阱。

修复您的数组绑定错误 - 我想它可能之前已经上线了。

# ruby-on-rails-3 - stack level too deep with `puts response` in rspec

> ID：12475478
> 
> 赞同：4
> 
> 时间：2012-09-18T10:48:28.300
> 
> 标签：ruby-on-rails-3, rspec, rspec-rails

Having a strange problem with rspec and rails in controller tests. Whenever we add `puts response` inside a spec, it outputs lots of these

```
200
{"Content-Type"=>"text/html; charset=utf-8"}
200
{"Content-Type"=>"text/html; charset=utf-8"}
200
{"Content-Type"=>"text/html; charset=utf-8"}
200
{"Content-Type"=>"text/html; charset=utf-8"} 
```

and then fails with `SystemStackError: stack level too deep`. Inspecting the response via pry works great, printing other stuff also works fine.

Upgrading to latest rspec (2.11) does not make a difference. We noticed that the puts calls `to_a` on the response, which returns an array of `[@status, @header, self]`, so somehow it causes this strange recursion?

**update**: here's a [gist](https://gist.github.com/3742800) with the code + spec

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T16:20:27.987

我相信您在机架中遇到了错误。 `[rack_response].flatten`进入无限循环。有关更多信息，请参阅这些问题：

*   [https://github.com/rspec/rspec-rails/issues/601](https://github.com/rspec/rspec-rails/issues/601)
*   [https://github.com/rspec/rspec-expectations/issues/166](https://github.com/rspec/rspec-expectations/issues/166)
*   [https://github.com/rack/rack/issues/419](https://github.com/rack/rack/issues/419)

解决方案是不对响应对象本身设置任何期望，而是分别对状态、标头或正文设置期望，例如：

```
last_response.status.should eq(200)
last_response.body.should include("some text")
last_response.headers.should include("Content-Type" => "text/plain") 
```

# c# - Htmlagilitypack 显示节点 #text 而不是 span

> ID：12475480
> 
> 赞同：3
> 
> 时间：2012-09-18T10:48:34.807
> 
> 标签：c#, html-agility-pack

我有以下 html 标记：

```
 <div>
            <span id="391d0e73-d491-4e55-9ccb-b74c6923e070">This is a text
                element</span>
        </div> 
```

现在，如果我将此 div 节点保存在一个`HtmlNode`对象中，然后当我访问节点时，`FirstChild`而不是给出它，则给出标记中不存在`span node as FirstChild`的节点。`NAME: "#text"`有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:57:27.533

在[XML](http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/level-one-core.html#ID-1950641247)中，节点包括元素、文本、注释等，例如在您的文档中，`div`可以有 2`text`个子节点：

```
<div>
    text(1) Some text could be here
    <span id="391d0e73-d491-4e55-9ccb-b74c6923e070">This is a text
        element</span>
    text(2) More text could be here
</div> 
```

您需要指定您想要的`span`子元素`HtmlNode`，例如

```
divNode.SelectSingleNode("span") 
```

# actionscript-3 - 从 as3 中的另一个文件调用函数

> ID：12475491
> 
> 赞同：1
> 
> 时间：2012-09-18T10:49:00.643
> 
> 标签：actionscript-3

我想从另一个文件中调用函数 handleText 。

```
package
{   
    import flash.display.MovieClip;

    public function handleText(mc:MovieClip):void
    {
        mc.text="aaaaaa";
    }
} 
```

但是，当我从另一个文件（与上面代码的文件位于同一目录中，顶部也带有“package {”）调用函数 handleText 时，我收到未定义函数的错误。怎么了？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:56:04.213

我想您正在谈论诸如 Objective-C 中的类别之类的东西，开发人员可以在单独的文件中向类添加功能而无需修改原始类代码？如果是这样，那么没有。由于 AS3 中的类及其结构与文件结构密切相关，因此无法在单独文件中扩展已定义类的功能。

但是，您可以使用继承添加/修改类的功能。这样，您可以在单独的 .as 文件中添加例如方法和变量，但新类将被视为具有自己名称的单独类。

# c# - 从短期线程调度任务

> ID：12475492
> 
> 赞同：0
> 
> 时间：2012-09-18T10:49:03.807
> 
> 标签：c#, task-parallel-library

我是 C# 的新手，来自 C++，想问一下这是否是使用任务并行库的正确方法。

我有一个 Web 服务，它对长时间运行的操作进行排队。我不想使用异步网络调用，所以我的想法是使用 TPL，在调用网络操作时创建一个任务。我想知道如果我从 Web 操作完成后立即终止的线程安排任务，是否存在任何类型的资源泄漏。假设我不会保留对任务的引用，因为我不需要检查它的状态或结果。谢谢。

**编辑：** 对不起，在第一次拍摄时没有清楚地表达自己。我的问题与网络服务有关，与客户无关。客户端调用需要很长时间的 Web 服务操作。Web 服务调用返回说操作已在后台成功排队/执行。在Web服务操作中，我想使用TPL，而不是存储StartNew返回的任务对象。想知道，如果我不读取任务对象的状态并因此泄漏，是否会永远保留任务对象。也许只是我的 C++ 思想阻碍了我，我不应该关心泄漏，因为它是托管代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T16:51:52.633

忘记任务不会导致 TPL 出现任何问题，请参阅 stackoverflow.com/questions/3734280/... 了解更多详细信息。但是，你想在该任务中完成的工作很重要——如果你“忘记它”，你怎么知道它已经完成、正确完成并且不需要重新开始？这都是特定于应用程序的。

线程池的“完全忙碌”意味着已经创建并正在执行 1023 个线程池线程（这可能非常糟糕）。否则，线程池开始时每个 CPU/核心至少有一个线程，只要没有非运行线程的数量，就会通过每秒启动一个新线程来保持该最小值。所以，它真的不会“排队”任何东西。例如，您可以启动 12 个任务，然后它“排队”了 4 个任务，在另一个点它运行了所有 12 个任务......

# java - 如何更改图像的大小？

> ID：12475503
> 
> 赞同：4
> 
> 时间：2012-09-18T10:00:30.293
> 
> 标签：java

我正在创建一个太空侵略者游戏，我希望所有图像都与屏幕分辨率成比例。这意味着它可以在所有屏幕尺寸上使用，并且所有图像都会缩小或变大以适应屏幕。游戏是全屏的。最简单的技术是什么？这也是设置所有内容大小的最佳方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T10:54:02.180

你有没有看过[Image#getScaledInstance()](http://docs.oracle.com/javase/7/docs/api/java/awt/Image.html#getScaledInstance%28int,%20int,%20int%29)虽然它有它[的缺点（ Image.getScaledInstance() 的危险](http://today.java.net/pub/a/today/2007/04/03/perils-of-image-getscaledinstance.html)）简而言之，问题是：

> Image.getScaledInstance() 不返回完成的缩放图像。当使用图像像素时，它会将大部分缩放工作留给以后使用。

由于这些问题，您可能需要一种不同的方式来调整图像大小，您可以尝试以下方法：

```
import javax.swing.ImageIcon;
import java.awt.image.BufferedImage;
import java.awt.Image;
import java.awt.Color;
import java.awt.Graphics2D;
import java.io.File;
import javax.imageio.ImageIO;
import java.awt.RenderingHints;

public class ImgUtils {

public BufferedImage scaleImage(int WIDTH, int HEIGHT, String filename) {
    BufferedImage bi = null;
    try {
        ImageIcon ii = new ImageIcon(filename);//path to image
        bi = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB);
        Graphics2D g2d = (Graphics2D) bi.createGraphics();
        g2d.addRenderingHints(new RenderingHints(RenderingHints.KEY_RENDERING,RenderingHints.VALUE_RENDER_QUALITY));
        g2d.drawImage(ii.getImage(), 0, 0, WIDTH, HEIGHT, null);
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
    return bi;
}

 } 
```

你会像这样使用它：

```
BufferedImage img=new ImgUtils().scaleImage(50,50,"c:/test.jpg");
//now you have a scaled image in img 
```

参考：

*   [调整图像大小 java getScaledInstance](https://stackoverflow.com/questions/7252983/resizing-image-java-getscaledinstance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:53:30.733

假设 g 是您的 Graphics2D 对象实例，theImage 是您要绘制的图像，xFactor 和 yFactor 是 x 和 y 的缩放因子，请尝试：

```
AffineTransformation scaleTransformation = AffineTransformation.getScaleInstance(xFactor, yFactor);
g.draw(theImage, scaleTransformation, null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-27T17:54:32.257

```
Image getScaledImage(Image Img, int wt, int ht) {
    BufferedImage resizedImg = new BufferedImage(wt, ht, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2 = resizedImg.createGraphics();

    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g2.drawImage(Img, 0, 0, wt, ht, null);
    g2.dispose();

    return resizedImg;
} 
```

# open-source - 检查所有线段指定距离内的所有点

> ID：12475504
> 
> 赞同：2
> 
> 时间：2012-09-18T10:49:45.473
> 
> 标签：open-source, computational-geometry

给定一组点 P 和一组线段 S，有没有办法有效地找到任何线段指定距离 d 内的所有点？没有蛮力比较顺序`O(|P||S|)`？

Bentley-Ottman 搜索一组线段之间的所有交点在 中运行`O(n log n)`，并且由于这个问题具有相似的味道，我想知道是否有可能实现相似的性能。

在 C++ 中允许的开源实现的奖励积分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T07:44:52.003

在这些点上构建一个[Voronoi 图](http://en.wikipedia.org/wiki/Voronoi_diagram)网络。让每个单元保持指向其所有邻居的指针。比一切皆有可能。

1.  给定一个点，找到它所在的单元格。简单，从网络的左下角画一条线到该点，然后从那个角单元格开始，接近该点，从而找到它所在的单元格。

2.  给定一条线，找到它穿过的所有单元格。琐碎的。

3.  给定一条线和一个偏移距离，找到走廊内的所有单元。从 2 开始。

4.  等等

Voronoi 网络用作空间导航和查询的支持结构。所有的操作都是局部的，所以线性复杂。图建好*后。*:)

# selenium - 如何使用 selenium.addCustomRequestHeader

> ID：12475507
> 
> 赞同：2
> 
> 时间：2012-09-18T10:49:55.133
> 
> 标签：selenium, junit, selenium-webdriver

我想将标头添加到我的 HTTP 请求中，以对特定的测试用例 Selenium 进行身份验证。我使用表单 selenium.addCustomRequestHeader(key, value) 但没有预期的结果。在我的控制台中有警告消息：“警告：getString(addCustomRequestHeader) 看到了不好的结果”。代码：

```
 @Before
public void setUp() throws Exception {
    seleniumServer = new SeleniumServer();
    seleniumServer.start();
    selenium = new DefaultSelenium("localhost", 4444, "*iexplore",
            TARGET_URL);
    selenium.start("addCustomRequestHeader=true");

    @Test
public void testValidCookieSessionIDGamen() throws Exception {
            selenium.addCustomRequestHeader(key,value);
            selenium.open(TARGET_URL);
    selenium.waitForPageToLoad("30000");
    assertTrue(selenium.isTextPresent("a"));
} 
```

知道我该怎么做吗？谢谢你的时间

# iphone - 初始化后 UITableViewController 中的 tableView 为零

> ID：12475508
> 
> 赞同：2
> 
> 时间：2012-09-18T10:49:56.677
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我在 UITableViewController 的子类中有以下代码。在 iOS 5.1 下它工作正常，但在 iOS 6 下，self.tableView 为零（在模拟器和真实设备上）。我做错了吗？为什么在初始化后没有立即设置视图？

```
- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];

    if (self) 
    {
        UIView * bck = [[UIView alloc] init];
        [bck setBackgroundColor:[UIColor whiteColor]];
        self.tableView.backgroundView = bck;
        [bck release];
    }

    return self;
} 
```

编辑：

我已经确定了问题：

我有课

```
AccountsListViewController_iPad 
```

这是的子类

```
AccountsListViewController : UITableViewController 
```

AccountsListViewController 在初始化后加载了它的 tableView 和视图（如我所料）。另一方面，AccountsListViewController_iPad 的 view 和 tableView 等于 nil。我已经从 AccountsListViewController_iPad 中删除了所有内容，所以现在看起来如下：

```
.h
#import <UIKit/UIKit.h>
#import "AccountsListViewController.h"
@interface AccountsListViewController_iPad : AccountsListViewController
@end

.m
#import "AccountsListViewController_iPad.h"
@implementation AccountsListViewController_iPad
@end 
```

它的观点仍然为零。在我看来，它的行为应该与其超类完全相同，但事实并非如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:01:12.563

我怀疑这是因为在加载视图之前不会加载表格视图。您应该将视图设置移动到`viewDidLoad`.

`init`您应该在方法中设置的唯一“视图”属性是`.navigationItem`（尽管我认为`UINavigationItem`最好将其视为控制器的一部分而不是视图）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T11:44:36.517

好的，我已经解决了：

有 AccountsListViewController_iPad 类和关联的 AccountsListViewController_iPad.xib 文件。Xib，尽管没有在代码中的任何地方加载，并且 xib 中的文件所有者不是 AccountsListViewController_iPad，但仍在加载。由于某种原因，xib 中的表视图在文件所有者（不存在）中设置为属性“表”，因此视图和表视图为零。

我仍然不知道为什么加载 xib 或为什么在 iOS 5.x 下存在问题

# sql - Oracle 命令的 SQL

> ID：12475509
> 
> 赞同：-4
> 
> 时间：2012-09-18T10:49:57.703
> 
> 标签：sql, oracle

MYSQL：

```
SELECT * FROM book ORDER BY $sidx $sord LIMIT $start , $limit; 
```

我如何把它变成甲骨文？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:52:32.840

您必须使用`rownum`属性，但您必须将其应用于已经排序的结果集，并且您需要从内部查询中传递它（感谢 Bob Jarvis 和 Daniel Hilgarth：请查看他们的解释和评论中给出的链接）。它应该是这样的：

```
SELECT * FROM
(SELECT b.*, rownum as row_num FROM book b ORDER by $sidx $sord)
WHERE row_num BETWEEN $start AND $start + $limit; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:53:07.313

我不熟悉 oracle 语法，但您可以使用该`ROW_NUMBER()`函数对行进行排名，然后选择具有以下内容的行`rank BETWEEN @start and @limit`：

```
 SELECT *
   FROM 
   (
       select *,
           ROW_NUMBER() OVER (ORDER BY ID DESC) AS rank
       FROM book
   )
   WHERE rank BETWEEN @start AND @end
   /* OR
   WHERE BETWEEN ((@PageNum - 1) * @PageSize + 1)
     AND (@PageNum * @PageSize)
   /* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:57:03.397

```
select * from(
select rownum as row_num, id from t
  )
where row_num between :start and :start+:limit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:53:02.887

**10g 起**

```
WITH CTE AS(SELECT  b.*, Row_Number() OVER(ORDER BY SIDX,SORD) AS Rn FROM BOOK b)
SELECT *
FROM CTE
WHERE Rn BETWEEN STARTLIMIT AND ENDLIMIT 
```

# .htaccess - .htaccess 可以进行完整性检查吗？

> ID：12475513
> 
> 赞同：0
> 
> 时间：2012-09-18T10:50:18.380
> 
> 标签：.htaccess

我需要快速查看我更新的 .htaccess 文件：

```
RewriteEngine On
# Redirects errors to 404 page
ErrorDocument 404 /404.php

# Redirect index.php to site root
RewriteCond %{HTTP_HOST} ^mysite.com [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301,NC]
RewriteRule ^index.php$ http://www.mysite.com/ [R=301,L]

# Unless directory remove slash
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/$ http://www.mysite.com/$1 [R=301,L]

# Remove .php
RewriteCond %{THE_REQUEST} ^(.+)\.php([#?][^\ ]*)?\ HTTP/
RewriteRule ^(.+)\.php$ http://www.mysite.com/$1 [R=301,L]

# Resolve .php file for extensionless php urls
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/.]+)$ $1.php [L] 
```

这是相当直接的。

> 第一个是 404 重定向。
> 第二个重定向 www.mysite.com/index.php 到 www.mysite.com
> 第三个删除斜杠。第四个删除 .php 扩展名。第五个解析php。

有人可以看看这个，请给我的代码一个快速的健全性检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:54:08.717

当您重定向用户时，下面的顶部可能更有意义，他们将再次浏览所有 .htaccess 文件。

您实际上在这里所做的是，如果`true`您告诉浏览器从不同的 url "" 再次加载网站`[R=301]`。

```
# Redirect index.php to site root
RewriteCond %{HTTP_HOST} ^mysite.com [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301]
RewriteRule ^index.php$ http://www.mysite.com/ [R=301,L] 
```

您的其他重定向按合理的顺序排列，如果不是目录，则删除斜杠，如果 php 删除 .php，则在没有斜杠的情况下解析任何内容。

`mysite.com/cake.php/`请注意，如果用户在某些网址（例如，不存在）访问您的网站，这将导致相当多的重定向

`mysite.com/cake.php/`=> `mysite.com/cake.php`
`mysite.com/cake.php`=> `mysite.com/cake`
`mysite.com/cake`=>`http://www.mysite.com/cake`
`http://www.mysite.com/cake`解析为`http://www.mysite.com/cake.php`- 不存在
`404`=> `http://www.mysite.com/404.php`
`http://www.mysite.com/404.php`=>`http://www.mysite.com/404`

虽然总而言之，它可以满足您的需求！

# java - 在服务器响应之前如何显示进度指示器？

> ID：12475514
> 
> 赞同：0
> 
> 时间：2012-09-18T10:50:27.457
> 
> 标签：java, javascript, jquery, jsp, tomcat

我有一个应用程序，其中一个页面大约需要 1 分钟才能加载。这是一个包含大量计算和其他内容的大页面。

我想显示一个进度指示器，直到服务器给我回复。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:12:26.253

您需要显示加载器，ajax 加载内容，当 Ajax 请求完成时隐藏加载器并显示内容或简单地用新数据替换加载器。

一个简单的实现可能看起来像这样，并将 #content 的内容替换为 url /newcontent 返回的任何内容。

```
<div id="content">
 <img src="/path/to/loader.gif" />
</div>

<script>
 $("#content").load("/newcontent");
</script> 
```

或者在您看起来实际上想要替换整个页面的情况下，将整个正文内容替换为：

```
$('body').load('newpage.html'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:55:11.213

如果在服务器上创建页面的 HTML 需要很长时间，则无法显示带有加载消息/进度指示器的页面，然后显示内容。

我能想到的唯一方法是仅使用加载消息/进度指示器加载页面，然后进行 AJAX 调用以实际获取内容（这需要很长时间才能生成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:16:04.080

在您的页面中添加一个 div 作为毯子，最初它将显示并阻止整个页面。并将 div 隐藏在 的 onload 处理程序中。这是一个普通的，可能不是一个好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:58:04.300

您可以在上传时显示此代码。

```
$(document).ready(function() { 
    $.blockUI();
    //load your editor here
    setTimeout(function(){
        $.unblockUI();
    }, 10000);
}); ​ 
```

# c# - Protobuf-Net 错误消息：没有为类型定义序列化程序：System.Type

> ID：12475521
> 
> 赞同：12
> 
> 时间：2012-09-18T10:50:39.903
> 
> 标签：c#, protocol-buffers, protobuf-net, system.type

尝试序列化时收到以下错误消息`List<Tuple<string, Type, object>>`：No Serializer defined for type: System.Type

我都试过了，只是序列化上面的集合或序列化一个与protoMember定义相同的集合的类。两者都会导致相同的错误消息。

这是不受支持的类型吗？我认为它是受支持的，但我忽略了其他一些东西，但也许我不正确？

感谢您提供任何可能有助于解决此问题的指示...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-18T11:10:08.953

编辑：

`Type`r580 中包含对序列化的支持

* * *

protobuf-net 旨在序列化您的*数据*，而不是您的实现；`Type`是一个实现细节。严格来说，添加起来并不难（一些特定于实现的细节已经基本上最终`Type`通过程序集限定名称存储信息），但是：这不是一个关键场景，而且在很多方面不是*我*鼓励你序列化的东西——协议缓冲区的全部意义在于你可以在任何平台上加载数据，版本容错是一个关键特性。存储`Type`信息违反了这两点。

还应该注意的是，大多数*其他*序列化程序（除了可能`BinaryFormatter`已经违反了平台/版本容错的所有规则的可能）***也***将拒绝序列化`Type`; `XmlSerializer`, `DataContractSerializer`,`JavaScriptSerializer`等都为这种情况抛出异常（我刚刚检查过它们）***。***

此外：`object`更*难以*支持，除非您使用该`DynamicType`功能。

* * *

以下是如何通过代理 on 完成的`Type`：

```
using ProtoBuf;
using ProtoBuf.Meta;
using System;
using System.Runtime.Serialization;

static class Program
{
    public static void Main(string[] args)
    {
        // register a surrogate for Type
        RuntimeTypeModel.Default.Add(typeof(Type), false)
                                .SetSurrogate(typeof(TypeSurrogate));
        // test it
        var clone = Serializer.DeepClone(new Foo { Type = typeof(string) });
    }
}

[ProtoContract]
class TypeSurrogate
{
    [ProtoMember(1)]
    public string AssemblyQualifiedName { get; set; }
    // protobuf-net wants an implicit or explicit operator between the types
    public static implicit operator Type(TypeSurrogate value)
    {
        return value==null ? null : Type.GetType(value.AssemblyQualifiedName);
    }
    public static implicit operator TypeSurrogate(Type value)
    {
        return value == null ? null : new TypeSurrogate {
            AssemblyQualifiedName  = value.AssemblyQualifiedName };
    }
}

[DataContract]
public class Foo
{
    [DataMember(Order=1)]
    public Type Type { get; set; }
} 
```

# c - 无法从服务器读取数据

> ID：12475531
> 
> 赞同：2
> 
> 时间：2012-09-18T10:51:45.867
> 
> 标签：c, sockets

我目前无法从服务器读取多个值。这是一个客户端/服务器程序。用户应该在客户端键入国家名称，然后服务器将返回该国家的首都及其货币。我成功键入第一个输入示例中国，服务器返回正确的数据。但是，当我将后续值键入为新加坡时。他们什么也没回。希望你们能告诉我代码有什么问题。服务器应该返回键入的国家的资本和货币。

以下是我的服务器和客户端代码。抱歉，它们有点长，但我想我给你们完整的图片更好

服务器.c

```
#include <stdlib.h>
#include <stdio.h>
#include <signal.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <sys/un.h>       /* for sockaddr_un struct */
#include <string.h>
#include "country.h"
#define DEFAULT_PROTOCOL   0

/* POSIX renames "Unix domain" as "local IPC."
    Not all systems define AF_LOCAL and PF_LOCAL (yet). */
#ifndef AF_LOCAL
#define AF_LOCAL    AF_UNIX
#endif
#ifndef PF_LOCAL
#define PF_LOCAL    PF_UNIX
#endif

/****************************************************************/
 int main  ()
  {

    int serverFd, clientFd, serverLen, clientLen;
    struct sockaddr_un serverAddress;/* Server address */
    struct sockaddr_un clientAddress; /* Client address */
    struct sockaddr* serverSockAddrPtr; /* Ptr to server address */
    struct sockaddr* clientSockAddrPtr; /* Ptr to client address */

    /* Ignore death-of-child signals to prevent zombies */
    signal (SIGCHLD, SIG_IGN);

    serverSockAddrPtr = (struct sockaddr*) &serverAddress;
    serverLen = sizeof (serverAddress);

    clientSockAddrPtr = (struct sockaddr*) &clientAddress;
    clientLen = sizeof (clientAddress);

    /* Create a socket, bidirectional, default protocol */
    serverFd = socket (AF_LOCAL, SOCK_STREAM, DEFAULT_PROTOCOL);
    serverAddress.sun_family = AF_LOCAL; /* Set domain type */
    strcpy (serverAddress.sun_path, "country"); /* Set name */

    unlink ("country"); /* Remove file if it already exists */

    bind (serverFd, serverSockAddrPtr, serverLen); /* Create file */ 
    listen (serverFd, 5); /* Maximum pending connection length */

    printf ("%s \n", "Starting Country Server");
    printf ("%s \n", " ");

    while (1) /* Loop forever */
      {
        /* Accept a client connection */
        clientFd = accept (serverFd, clientSockAddrPtr, &clientLen);

        if (fork () == 0) /* Create child to send recipe */
          {
            //writeCountryData (clientFd); /* Send the recipe */
       while(1)
       {
        readCountry (clientFd);
            close (clientFd); /* Close the socket */

            exit (/* EXIT_SUCCESS */ 0); /* Terminate */
          }
        else
          close (clientFd); /* Close the client descriptor */
      }

    return 0;
   }

   /****************************************************************/

 readCountry (int fd)
 {

    readData();
    char capital[100]="", currencyCode[100]="", *p;
        char userInput[200];

        read(fd, userInput, 200);

    if ((p = strchr(userInput, '\n')) != NULL) /* to remove the [enter] from userinput */
        *p = '\0';

    strcat(capital,userInput) ;
    strcat(capital," Capital       : ") ;
    strcat(capital,getCapital (userInput));

    write (fd, capital, strlen (capital) + 1);
    strcat(currencyCode,userInput) ;
    strcat(currencyCode," Currency Code       : ") ;
    strcat(currencyCode,getCurrencyCode (userInput));
    write (fd, currencyCode, strlen (currencyCode) + 1);

 }

readLine (int fd, char* str)
 {
   int n;
   do /* Read characters until NULL or end-of-input */
     {
     // ssize_t read (int fd, void *buf, size_t count);
     // if successful, read will:
     // a) stores data read into 'buf', and
     // b) returns the no. of bytes read
     // read returns zero if it reaches end-of-input
       n = read (fd, str, 1); /* Read one character */
     }
   while (n > 0 && *str++ != 0);
   return (n > 0); /* Return false if end-of-input */
 }

} 
```

客户端.c

```
#include <stdlib.h>
#include <stdio.h>
#include <signal.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <sys/un.h>            /* for sockaddr_un struct*/

#define DEFAULT_PROTOCOL    0

/* POSIX renames "Unix domain" as "local IPC."
    Not all systems define AF_LOCAL and PF_LOCAL (yet). */
#ifndef AF_LOCAL
#define AF_LOCAL    AF_UNIX
#endif
#ifndef PF_LOCAL
#define PF_LOCAL    PF_UNIX
#endif

/****************************************************************/
 main  ()
 {
   int clientFd, serverLen, result;
   struct sockaddr_un serverAddress;
   struct sockaddr* serverSockAddrPtr;
   serverSockAddrPtr = (struct sockaddr*) &serverAddress;
   serverLen = sizeof (serverAddress);

   /* Create a socket, bidirectional, default protocol */
   clientFd = socket (AF_LOCAL, SOCK_STREAM, DEFAULT_PROTOCOL);
   serverAddress.sun_family = AF_LOCAL; /* Server domain */
   strcpy (serverAddress.sun_path, "country"); /* Server name */
   do /* Loop until a connection is made with the server */
     {
       result = connect (clientFd, serverSockAddrPtr, serverLen);
       if (result == -1) sleep (1); /* Wait and then try again */
     }
   while (result == -1);

    while (1)
    {
    char country[300];
    printf("To end program, type 'end' \n");
    printf("Please enter country name >");
    fgets(country,sizeof(country),stdin);
    if (strcmp(country,"end\n") == 0)
    {
        printf("Thank you for using country services\n");
        break;

    }
    else 
    write(clientFd,country,strlen(country));
    readCountry(clientFd);
    close(clientFd);

    }

    /* Read the recipe */

    /* Close the socket */
   exit (/* EXIT_SUCCESS */ 0); /* Done */

 }
 /**************************************************************/

 readCountry(int fd)
 {
   char str[300];

   while (readLine (fd, str)) /* Read lines until end-of-input */
     printf ("%s\n", str); /* Echo line from socket */
 }

 /**************************************************************/

 /* Read a single NULL-terminated line */
 readLine (int fd, char* str)
 {
   int n;
   do /* Read characters until NULL or end-of-input */
     {
     // ssize_t read (int fd, void *buf, size_t count);
     // if successful, read will:
     // a) stores data read into 'buf', and
     // b) returns the no. of bytes read
     // read returns zero if it reaches end-of-input
       n = read (fd, str, 1); /* Read one character */
     }
   while (n > 0 && *str++ != 0);
   return (n > 0); /* Return false if end-of-input */
 }

  writeUserInput(int fd)
  {

   char text[20];
   printf("To end program, type 'end' \n\n\n");
   printf("Please enter Country > ");
   fgets (text, sizeof(text), stdin);

   write (fd, text, strlen (text) + 1);

  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:55:32.883

服务器注释 每次都需要设置套接字大小。

```
 /* Accept a client connection */
   clientLen = sizeof (clientAddress);    // this line was missing
   lientFd = accept (serverFd, clientSockAddrPtr, &clientLen); 
```

事实上，如果你在使用变量的地方声明变量，那么 RAII 就消除了这类问题。

我刚刚注意到这是 C 而不是 C++，所以忘记 RAII 注释，但确实需要设置大小。

您应该在以下位置使用 sizeof：

```
 char userInput[200];

  read(fd, userInput, 200); 
```

strncat 应该用于：

```
 char capital[100]="", currencyCode[100]="", *p;
    //...
strcat(capital,userInput) ;
strcat(capital," Capital       : ") ; 
```

货币代码也是如此。

您实际上并不需要 fork()，它都可以在一个线程/进程中完成。

```
Client Comments 
```

代码是：

```
 connect to server

  while (true)
   get input
   send request
   read reply
   close connection to server 
```

# java - 番石榴前置条件检查，空列表

> ID：12475532
> 
> 赞同：6
> 
> 时间：2012-09-18T10:51:50.263
> 
> 标签：java, guava

我想知道在我需要从中选择第一项的列表上进行前置条件检查的最佳模式是什么。

换句话说，我认为列表不应该是`null`，它的大小应该> 1。

我发现 Guava 的 checkPositionIndex 在这方面没有帮助。相反，我发现它违反直觉，请参阅下面的示例，因为我使用 checkPositionIndex 而不是 checkArgument，如未触发的守卫*之后所述，该示例在空列表上进行了轰炸。*

即使我从中获取 .get(0) ，检查位置 0 似乎也不足以验证参数？

```
import static com.google.common.base.Preconditions.checkArgument;
import static com.google.common.base.Preconditions.checkNotNull;
import static com.google.common.base.Preconditions.checkPositionIndex;
import java.util.List;
import com.google.common.collect.Lists;
public class HowShouldIUseCheckPositionIndex {
  private static class ThingAMajig {
    private String description;
    private ThingAMajig(String description) {
      this.description = description;
    }
    @Override
    public String toString() {
      return description;
    }
  }
  private static void goByFirstItemOfTheseAMajigs(List<ThingAMajig> things) {
    checkNotNull(things);
    // Check whether getting the first item is fine
    checkPositionIndex(0, things.size()); // Looks intuitive but...
    System.out.println(things.get(0)); // Finally, help the economy!
    checkArgument(things.size() > 0); // This would have worked :(
  }
  public static void main(String[] args) {
    List<ThingAMajig> fullList =
        Lists.newArrayList(new ThingAMajig(
            "that thingy for the furnace I have been holding off buying"));
    List<ThingAMajig> emptyList = Lists.newLinkedList();
    goByFirstItemOfTheseAMajigs(fullList);
    // goByFirstItemOfTheseAMajigs(emptyList); // This *bombs*
  }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T11:00:44.433

你应该`checkElementIndex()`改用。

`checkPositionIndex()`确保给定位置是插入新元素的有效位置（即您可以`add(0, obj)`在空列表上执行），而不是从中获取元素的有效索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:59:46.160

事实上，您根本不需要进行检查。

`list.get(0)`调用*本身*已经抛出基本完全相同的错误消息。

但是，如果您*确实*想明确地进行检查，是的，使用`checkElementIndex`or `checkArgument(!list.isEmpty())`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:03:26.367

使用[checkElementIndex](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkElementIndex%28int,%20int%29)

它指出：

`Ensures that index specifies a valid element in an array, list or string of size size. An element index may range from zero, inclusive, to size, exclusive`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T11:10:17.220

您可以使用[checkNotBlank](https://github.com/twitter/commons/blob/master/src/java/com/twitter/common/base/MorePreconditions.java)方法的[twitter-commons](https://github.com/twitter/commons)实现。它验证 Iterable 不为 null 且不为空。这是实现：

```
/**
* Checks that an Iterable is both non-null and non-empty. This method does not check individual
* elements in the Iterable, it just checks that the Iterable has at least one element.
*
* @param argument the argument to validate
* @param message the message template for validation exception messages where %s serves as the
* sole argument placeholder
* @param args any arguments needed by the message template
* @return the argument if it is valid
* @throws NullPointerException if the argument is null
* @throws IllegalArgumentException if the argument has no iterable elements
*/
public static <S, T extends Iterable<S>> T checkNotBlank(T argument, String message,
      Object... args) {
  Preconditions.checkNotNull(argument, message, args);
  Preconditions.checkArgument(!Iterables.isEmpty(argument), message, args);
  return argument;
} 
```

非常简单，适用于所有可迭代对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-30T23:55:08.010

您可以将 valid4j 与 hamcrest-matchers 一起使用（在 Maven Central 上以 org.valid4j:valid4j 的形式找到）

对于前置条件和后置条件（基本上是断言 -> 抛出 AssertionError）：

```
import static org.valid4j.Assertive.*;

require(list, hasSize(greaterThan(0))); 
```

或用于输入验证（抛出您的自定义可恢复异常）：

```
import static org.valid4j.Validation.*;

validate(list, hasSize(greaterThan(0)), otherwiseThrowing(EmptyListException.class)); 
```

链接：

*   [http://www.valid4j.org/](http://www.valid4j.org/)
*   [https://github.com/helsing/valid4j](https://github.com/helsing/valid4j)

# objective-c - 异常信号停止

> ID：12475544
> 
> 赞同：0
> 
> 时间：2012-09-18T10:53:03.803
> 
> 标签：objective-c, exception, avaudioplayer

我是 XCode 和 Objective-C 的新手。当我让应用程序在模拟器中运行时，我弹出了这个异常。在 iPad 上它工作正常。当分配 AVaudioPlayer 时，我会停止并发出警告 SIGSTOP。

有人有什么建议吗？这是一个严重的例外吗？提前致谢！

我不知道在哪里可以找到“堆栈跟踪”，所以我将 RUN 调试器放到 gdb：来自此的信息：Pending breakpoint 1 - ""soundScape.m":112" resolved
rndmitem
amount
url

SIGSTOP 之前的行是：

libc++abi.dylib`__cxa_throw:
0x46e4a44: pushl %ebp
0x46e4a45: movl %esp, %ebp

当前语言：自动；目前objective-c
0x1 似乎没有指向一个有效的对象。
0x2 似乎没有指向有效对象。
file://localhost/Users/myName/Library/Application%20Support/iPhone%20Simulator/5.1/Applications/E92E5F03-0B07-4AF0-BFB4-E1F7009A4E78/babyschets.app/02Seawash.mp3
[切换到进程81163线程0x1720b]
[ Switching to process 81163 thread 0x15803]

under Exception State Registers:
trapno = (unsigned int) 0x000003
err = (unsigned int) 0x000000
faultvaddr = (unsigned int) 0x087df732

例如，当值如下时会发生这种情况：

**randomItem** :
(NSUInteger) $0 = 1 [没有可用的 Objective-C 描述]
**amountOfAudioFiles** :
(int) $1 = 2 [没有可用的 Objective-C 描述]
**url** :
(NSURL *) $2 = 0x07485860
file://localhost/Users/myName /Library/Application%20Support/iPhone%20Simulator/5.1/Applications/E92E5F03-0B07-4AF0-BFB4-E1F7009A4E78/babyschets.app/02Seawash.mp3

**audioFiles1** :
(NSArray *) $4 = 0x0747d720 <__NSArrayI 0x747d720>(
01Seawash.mp3,
02Seawash.mp3
)

```
int amountOfAudioFiles = [audioFiles1 count];
NSUInteger randomItem = arc4random()%(int)amountOfAudioFiles;

NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:[NSString stringWithString:[audioFiles1 objectAtIndex:randomItem]]
                                     ofType:nil]];

NSError *error;

audioPlayer1 = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error]; 
```

好的，我已经清理了这段代码，这是我的解决方案。现在它像魅力一样运行：

在 .h 文件中：@property (nonatomic, retain) AVAudioPlayer *audioPlayer1;

在 .m 文件中：

```
int amountOfAudioFiles = [audioFiles1 count];
int randomItem = (int)(arc4random()%amountOfAudioFiles);
if (randomItem < 0) randomItem = 0;

NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:[NSString stringWithFormat:@"%@", [audioFiles1 objectAtIndex:randomItem]]
                                     ofType:nil]];

if (audioPlayer1) {
    if (audioPlayer1.isPlaying) {
        [audioPlayer1 stop];
        audioPlayer1 = nil;
    }

} else {
    audioPlayer1 = [AVAudioPlayer alloc];
}

NSError *error;
audioPlayer1 = [audioPlayer1 initWithContentsOfURL:url error:NULL]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:33:39.997

这意味着对象（在框架中）不存在于 iOS 版本中。也许您需要更新您测试/运行应用程序的 iOS 设备的 iOS。

# php - 上传图片时出错（php/codeigniter）

> ID：12475550
> 
> 赞同：-1
> 
> 时间：2012-09-18T10:53:18.720
> 
> 标签：php, codeigniter, frameworks, upload

我的问题是关于在 linux 中创建目录。我的网站有一个后端，我可以在其中上传网站的图片，它会根据上传图片的年份和月份自动创建文件夹。

但是从将 web 主机平台 windows 更改为 linux 时出现错误，我能够成功上传图像，但在上传时看不到它。

如果我从我的后端（管理面板）上传带有名称的图像，`pdf.png`那么它什么也不显示，我看到图像是以`2012\09\pdf.png`我的网站上传文件夹的形式上传的。但我希望这个上传的文件在我的`/2012/09/`文件夹中。该文件夹是根据年份和月份自动创建的。

请找到我的php程序[的错误截图和源代码（ZIP）](http://www.mediafire.com/?bpnh18a7pbzn83h)，如果发现有问题请帮我解决，谢谢！

```
 function upload()
    {
    $a = $this->_make_dir();       
    if(move_uploaded_file($a["tmpname"], $a["target"]))
    {
        echo 'success';
        $this->art_media->create(array("media_filename"=>$a["file"],
            "media_date"=>time(),
            "media_title"=>$a["file"],
            "media_description"=>"",
            "media_filelink"=>date("Y")."/".date("m")."/",
            "media_isimage"=>false,
            "media_type"=>$a["filetype"]
            ));

    } 
    else
    {
        echo 'failed';
    }
}
function _make_dir()
{
    $target1 = FCPATH.$this->config->item("articles_media").date("Y");
    $target = $target1."\\".date("m");

    $uploadfile = $_FILES["Filedata"]["name"];
    $type = $_FILES["Filedata"]["type"];
    if(!is_dir($target1))
    {
        mkdir($target1);
        mkdir($target);
    }
    else
    {
        if(!is_dir($target))
        {
            mkdir($target);
        }
    }        
    if(is_file($target."\\".$uploadfile)==true)
    {
        echo 'duplicate';
        exit();
         //$uploadfile = $uploadfile."_".$n;
    }
    return array("filetype"=>$type,"file"=>$uploadfile,"targetpath"=>$target."\\","target"=>$target."\\".$uploadfile,"tmpname"=>$_FILES['Filedata']['tmp_name']);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:23:42.767

Windows 和 Linux 遍历目录的工作方式不同：Windows 使用反斜杠，而 Linux 使用正斜杠。

您应该用正斜杠替换所有转义的反斜杠。例如，这个：

```
$target = $target1."\\".date("m"); 
```

应该变成：

```
$target = $target1."/".date("m"); 
```

# objective-c - 如何调试“警告：尝试使用不在框架中的块创建 USE_BLOCK_IN_FRAME 变量”？

> ID：12475552
> 
> 赞同：0
> 
> 时间：2012-09-18T10:53:29.653
> 
> 标签：objective-c, ios

关于此警告消息有很多问题，但它通常表示错误。我想知道一般应该如何调试这个警告？这是什么意思？

我有一个案例，我已经知道如何解决它：

```
NSDictionary *lastUpdatedAt = [NSDictionary dictionaryWithObjectsAndKeys:
                               @"es", [NSDate distantPast], 
                               @"it", [NSDate distantPast], nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:
 [NSDictionary dictionaryWithObjectsAndKeys:
  @"es", @"lang", 
  [NSNumber numberWithInt:0], @"groupedBy",
  [NSNumber numberWithBool:FALSE], @"hideKnownWords", 
  lastUpdatedAt, @"lastUpdatedAt",
  nil]]; 
```

错误是在初始化 lastUpdatedAt 时，我错误地将键放在应该有值的地方。解决方法是：

```
NSDictionary *lastUpdatedAt = [NSDictionary dictionaryWithObjectsAndKeys:
                               [NSDate distantPast], @"es", 
                               [NSDate distantPast], @"it",nil]; 
```

但是，在有这个 bug 的代码中，如果你在调用 registerDefaults 的行放置一个断点，每次你尝试前进断点时都会产生警告，但它永远不会返回。该错误实际上不在该行中。我很幸运，马车线很​​近，所以我立即注意到了。但总的来说，应该如何跟踪这种错误？

# objective-c - 如何在基于页面视图的应用程序中加载 pdf 文件

> ID：12475554
> 
> 赞同：0
> 
> 时间：2012-09-18T10:53:33.307
> 
> 标签：objective-c, ios, xcode, ipad, uipageviewcontroller

我想在基于页面视图的应用程序中加载一个 pdf 文件，并像使用卷曲过渡的书一样查看它，因为基于页面视图的应用程序提供页面卷曲过渡。

那么我该如何实现它，任何人都可以通过我应该在基于页面视图的应用程序中使用的示例代码给我打电话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:20:30.277

你有很多选择来实现这种项目，最好的方法是使用开源项目，那里有很多开源项目，这里是我之前找到的项目列表：

*   [纸叠](https://github.com/lomanf/PaperStack)
*   [PageCurlDemo](https://github.com/steventroughtonsmith/PageCurlDemo)
*   [树叶](https://github.com/brow/leaves)

# c# - RX，重试并允许处理异常

> ID：12475556
> 
> 赞同：4
> 
> 时间：2012-09-18T10:53:39.063
> 
> 标签：c#, .net, system.reactive, observable

我正试图把头绕在 RX 周围，但我的大脑在某个地方爆炸了 :)

我想要做的是通过 RX 以异步方式调用 WCF 方法。这里没什么特别的，但是当 WCF 方法抛出错误时，我想重新创建通道并再试一次（最多 3 次）。

到目前为止，我所拥有的是：

```
var _sc = new Service.Service1Client();
var _observableFunc = Observable.FromAsyncPattern<int, string>(_sc.BeginGetData, _sc.EndGetData);
var _observable = _observableFunc(666);

var _defered = Observable.Defer(() => _observable);

// Here something should be done, but don't know what...

using (_retryable.Subscribe(x => Console.WriteLine("Async ==> '{0}'", x),
                            ex => Console.WriteLine("Oops ==> {0}", ex.Message)))
{
    Console.ReadLine();
} 
```

我玩弄了`Catch<TSource, TException>`，这让我可以捕获异常并继续使用相同的 observable，从而给了我想要的东西。唯一的问题是它永远运行，这意味着如果我继续抛出异常，事情就永远不会停止！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T00:31:23.420

Try doing this:

```
var retryable = Observable.Defer(() => _observableFunc(666).Retry(3)); 
```

The `Retry` extension method "Repeats the source observable sequence the specified number of times or until it successfully terminates."

Also, don't do this:

```
var _observable = _observableFunc(666);
var _defered = Observable.Defer(() => _observable); 
```

There's no point deferring the observable after you've kicked it off.

You should do this instead:

```
var _defered = Observable.Defer(() => _observableFunc(666)); 
```

Then you're only one step away from my suggested solution at the top.

# c# - 如何计算可用内存的最大列表大小？

> ID：12475557
> 
> 赞同：-1
> 
> 时间：2012-09-18T10:53:45.580
> 
> 标签：c#, list, tree, out-of-memory

我想创建`List<MyClass>`一个

```
class MyClass
{
    public string Name;
    public List<MyClass> Children;
} 
```

用户决定应该创建多少对象。根据树的深度（列表中的所有对象具有相同数量的子对象），我会因列表中的对象数量不同而出现内存不足异常。是否有可能近似最大对象数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:13:31.890

> 是否有可能近似最大对象数

不，不存在这种可能性。

如果您可以计算`sizeof`托管对象之类的事件并获得可用内存量，则不能依赖此数字，因为托管代码对其托管堆中的当前内存碎片一无所知，它无法停止系统中的其他进程（和当前进程中的其他线程）从系统查询新的内存分配。

# xslt - XPath 输出 .07 * 100 * 100 为 700.00000000000011 为什么？

> ID：12475564
> 
> 赞同：7
> 
> 时间：2012-09-18T10:54:17.483
> 
> 标签：xslt, xpath, precision

我注意到一些我无法理解的奇怪的精确行为，我有一些 XML：

```
<CLD>
    <UCRV>
        <UCR1>.07</UCR1>
    </UCRV>
</CLD> 
```

在 XSLT 文件中，我将值选择为便士（或看起来是 100 便士，我不知道为什么，但这是客户想要的！）为：

```
<xsl:value-of select="./s0:CLD/s0:UCRV/s0:UCR1/text() * 100 * 100"/> 
```

但这输出为 700.00000000000011 数据类型为 xsd:Decimal。这里有一些默认的精度吗？我可以简单地对数字进行四舍五入，但我只是想更好地理解它。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:00:44.047

浮点数不能精确地表示一切。由于数字是以二进制形式存储的，因此看起来很容易用十进制写的数字实际上有时只能用二进制来处理。0.07 就是这种情况，它在内部存储为 0.070000000000000011，就像您的情况一样。根据经验，您永远不应该信任浮点值，以便直接比较它们而不进行四舍五入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T12:13:20.380

**正如人们已经解释的那样，XPath 中使用的唯一数字类型是 xs:double**。

该**[`number()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-number)**函数将值转换为双精度值。因此，在 XPath 1.0 中对数字的操作可能而且有时确实会导致精度损失。

**存在不同的解决方案**：

1.  使用该**[`round()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-round)**功能。也可以使用**[`floor()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-floor)**或**[`ceiling()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-ceiling)**功能。

2.  使用 XSLT **[`format-number()`](http://www.w3.org/TR/xslt#function-format-number)**function() 或**[`<xsl:number>`](http://www.w3.org/TR/xslt#number)**指令。

**请注意，XPath 2.0 支持所有 XSD 数字类型**，包括`xs:decimal`. 不会导致精度损失的 XPath 2.0 表达式是：

```
xs:decimal(0.07)*100*100 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T11:05:34.493

这是标准的浮点数学。在这种情况下，有一个最大数量的位数来拟合该数字，并且该数字以二进制的科学形式保存。这里 0.07 不能精确表示，它被保存为 0.070000000000000011。

[有关更多信息，请参阅使用标记浮点](/questions/tagged/floating-point "显示标记为“浮点”的问题")、[维基百科](http://en.wikipedia.org/wiki/Floating_point)和[每个计算机科学家应该了解的关于浮点算法](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)的 SO（尽管是其他语言）的许多问题

# c# - 在 C# 中使用 REST 更新 SharePoint 列表项的查找字段

> ID：12475567
> 
> 赞同：1
> 
> 时间：2012-09-18T10:54:25.910
> 
> 标签：c#, sharepoint, rest, lookup

我正在使用对 listdata.svc 的服务引用来操作 SharePoint 列表。我有一份公司名单和一份人员名单。

我可以像这样操作数据：

```
HomeDataContext proxy = new HomeDataContext(new Uri(url + "/_vti_bin/listdata.svc"));
proxy.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;
PeopleItem person = proxy.People.Where(p => p.Name.Equals(myName)).First();
PeopleItem boss = proxy.People.Where(p => p.Name.Equals(bossName)).First();
CompaniesItem company= proxy.Companies.Where(c => c.ID.Equals(companyName)).First();
company.Employees.Add(person);
company.Boss = boss;
company.Name = "New Name";
proxy.UpdateObject(company);
proxy.SaveChanges(); 
```

使用这种方法，我可以编辑列表项的基本属性（如名称）。但是，我不能使用它来更新查找字段（例如 Boss 或多个查找员工）。在对象模型中，一切似乎都正常工作并且没有引发异常，但是在更新和保存之后，这些字段在 SharePoint 中只是空白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T14:07:45.603

上面的例子是行不通的。对于单个值查找字段，您需要设置 id 属性。

公司要见老板，你得去

company.BossId = 老板.Id;

上面的示例不会将更改写入共享点列表，您需要设置 Id 属性的查找字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T03:28:37.967

如果人员项目已存在于 sharepoint 中，而您只想将其添加到公司中，则可以使用：

```
HomeDataContext proxy = new HomeDataContext(new Uri(url + "/_vti_bin/listdata.svc"));
proxy.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;
PeopleItem person = proxy.People.Where(p => p.Name.Equals(myName)).First();
PeopleItem boss = proxy.People.Where(p => p.Name.Equals(bossName)).First();
CompaniesItem company= proxy.Companies.Where(c => c.ID.Equals(companyName)).First();
//company.Employees.Add(person);
company.Boss = boss;
company.Name = "New Name";
proxy.UpdateObject(company);
proxy.SaveChanges();
//To remove employee from company
proxy.DeleteLink(company, "Employee", person);
proxy.SaveChanges();
//To Add person as employee
proxy.AddLink(company,"Employee",person);
proxy.SaveChanges(); 
```

您还可以查看 proxy.AddRelatedObject() 方法来同时创建新人和链接。有关这些方法的更多信息：http: [//msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.aspx](http://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.aspx)

# xcode - Appstore 作为 iOS6 中的模态视图

> ID：12475568
> 
> 赞同：22
> 
> 时间：2012-09-18T10:54:26.690
> 
> 标签：xcode, app-store, ios6

我注意到当用户**在 iOS6 邮件应用程序中点击应用程序商店链接时**，邮件会**打开一个表示应用程序商店的模式视图，**而不是像以前的版本那样切换到应用程序商店应用程序。

Apple 是否提供对此功能的访问权限，或者它是其集成程序独有的？

* * *

**注意：**如果您有 iOS 6 并想对其进行测试，只需打开应用商店并通过电子邮件将应用发送给自己。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-01T23:47:34.570

我将此方法作为一个类别添加到 UIViewController，但您可以根据自己的需要重新调整它的用途。应用商店 ID 是应用商店 URL 中的大数字。确保导入 StoreKit 框架和头文件！

```
@import StoreKit;

- (void)presentAppStoreForID:(NSNumber *)appStoreID withDelegate:(id<SKStoreProductViewControllerDelegate>)delegate
{
    if(NSClassFromString(@"SKStoreProductViewController")) { // Checks for iOS 6 feature.

        SKStoreProductViewController *storeController = [[SKStoreProductViewController alloc] init];
        storeController.delegate = delegate; // productViewControllerDidFinish

        // Example App Store ID (e.g. for Words With Friends)
        // @322852954

        [storeController loadProductWithParameters:@{ SKStoreProductParameterITunesItemIdentifier: appStoreID }
                                   completionBlock:^(BOOL result, NSError *error) {
            if (result) {
                [self presentViewController:storeController animated:YES completion:nil];
            } else {
                [[[UIAlertView alloc] initWithTitle:@"Uh oh!" message:@"There was a problem opening the app store" delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles: nil] show];
            }
        }];

    } else { // Before iOS 6, we can only open the App Store URL
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://itunes.apple.com/app/id%@",appStoreID]]];
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T21:34:58.833

看起来这是在 IOS 6 中作为 StoreKit 引入的，特别是[SKITunesProductViewController](https://developer.apple.com/library/prerelease/ios/documentation/StoreKit/Reference/SKITunesProductViewController_Ref/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011852)，它允许您在应用程序中呈现 iTunes 内容（应用程序、音乐、书籍等）供用户直接购买。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T19:15:58.177

这里有一个处理附属链接的插件： [https ://github.com/aven/AEProductController](https://github.com/adeven/AEProductController)

或者，您可以按照 Apple Technical Q&A QA1629 首先打开应用程序内的附属链接（就像直接打开 iTunes Store 应用程序之前一样）来推出自己的产品：

[https://developer.apple.com/library/ios/#qa/qa2008/qa1629.html](https://developer.apple.com/library/ios/#qa/qa2008/qa1629.html)

然后按照上面提到的 MaxGabriel 打开 SKStoreProductViewController 。

[编辑] 我在我的应用程序（音乐应用程序）中完成了这个，但无论我有一个活动的 AVAudioSession 还是我完全禁用所有播放（用于测试），模态 iTunes Store 中的歌曲样本播放但没有声音。如果您没有此问题或找到解决方案，请告诉我。这可能是一个应该报告给[https://bugreport.apple.com/](https://bugreport.apple.com/)的错误。

# android - 如何在 Android 4.1 中使用 ACTION_VOICE_SEARCH_HANDS_FREE？

> ID：12475570
> 
> 赞同：8
> 
> 时间：2012-09-18T10:54:32.337
> 
> 标签：android, speech-recognition, android-4.2-jelly-bean

我正在尝试`ACTION_VOICE_SEARCH_HANDS_FREE`在**Android 4.1**中使用。

我用这种方式：

```
Intent intent = new Intent(RecognizerIntent.ACTION_VOICE_SEARCH_HANDS_FREE);
intent.putExtra(RecognizerIntent.EXTRA_SECURE, true);
startActivityForResult(intent, RECORD_CODE); 
```

它适用于`ACTION_RECOGNIZE_SPEECH`但`ACTION_VOICE_SEARCH_HANDS_FREE`我有这个：

```
android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.speech.action.VOICE_SEARCH_HANDS_FREE (has extras) } 
```

我该如何使用`ACTION_VOICE_SEARCH_HANDS_FREE`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-19T18:54:29.187

@Kaarel 回答正确，但要提供更多信息：

一个活动需要在清单中注册以下内容：

```
 <intent-filter >
        <action android:name="android.speech.action.VOICE_SEARCH_HANDS_FREE" />

        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter> 
```

谷歌搜索已注册此意图，但它只会在屏幕打开且未锁定时对其做出反应：见下文取自[AudioService](https://github.com/android/platform_frameworks_base/blob/master/media/java/android/media/AudioService.java)

```
private void startVoiceBasedInteractions(boolean needWakeLock) {
        Intent voiceIntent = null;
        // select which type of search to launch:
        // - screen on and device unlocked: action is ACTION_WEB_SEARCH
        // - device locked or screen off: action is ACTION_VOICE_SEARCH_HANDS_FREE
        //    with EXTRA_SECURE set to true if the device is securely locked
        PowerManager pm = (PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
        boolean isLocked = mKeyguardManager != null && mKeyguardManager.isKeyguardLocked();
        if (!isLocked && pm.isScreenOn()) {
            voiceIntent = new Intent(android.speech.RecognizerIntent.ACTION_WEB_SEARCH);
        } else {
            voiceIntent = new Intent(RecognizerIntent.ACTION_VOICE_SEARCH_HANDS_FREE);
            voiceIntent.putExtra(RecognizerIntent.EXTRA_SECURE,
                    isLocked && mKeyguardManager.isKeyguardSecure());
        }
        // start the search activity
        if (needWakeLock) {
            mMediaEventWakeLock.acquire();
        }
        try {
            if (voiceIntent != null) {
                voiceIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK
                        | Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
                mContext.startActivity(voiceIntent);
            }
        } catch (ActivityNotFoundException e) {
            Log.w(TAG, "No activity for search: " + e);
        } finally {
            if (needWakeLock) {
                mMediaEventWakeLock.release();
            }
        } 
```

[由于此链接错误](https://code.google.com/p/android/issues/detail?id=36668)，此功能目前非常多余，系统应用程序会覆盖优先级，从而阻止用户选择已安装的替代方案。

当您创建了这样一个应用程序并且用户无法使用它时，真的很烦人............确实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T00:28:07.737

您需要在您的设备上安装一个包含响应`ACTION_VOICE_SEARCH_HANDS_FREE`意图的活动的应用程序。所以问题就变成了：哪些应用程序支持这种意图？我知道的唯一答案是微不足道的，“自己实现这样的应用程序”，所以我也对这个问题感兴趣，但我不确定它是否符合 Stackoverflow 格式。

# facebook - 有什么 API 可以列出用户 Facebook 好友的电子邮件 ID？

> ID：12475573
> 
> 赞同：-4
> 
> 时间：2012-09-18T10:54:45.863
> 
> 标签：facebook, email

是否有列出用户的电子邮件地址、Facebook 朋友的姓名？有可用的 API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:30:22.397

Facebook 只会让您访问已对您的应用进行身份验证的用户的电子邮件地址。因此，您无法访问用户朋友的电子邮件地址。

您可以通过处理从以下 URL 返回的数据来检索 Facebook 用户的朋友列表：

[https://graph.facebook.com/USER_ID/friends?access_token=YOUR_ACCESS_TOKEN](https://graph.facebook.com/USER_ID/friends?access_token=YOUR_ACCESS_TOKEN)

在哪里：

*   USER_ID 是该用户的 Facebook ID
*   ACCESS_TOKEN 是 Facebook 在用户授权后授予您的应用程序的令牌。[Facebook 身份验证文件](https://developers.facebook.com/docs/authentication/)

有关更多详细信息，请参阅 Graph API 文档： [https ://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

# sql-server - 在 sys.servers 中找不到服务器“+@servername +”

> ID：12475574
> 
> 赞同：0
> 
> 时间：2012-09-18T10:54:54.350
> 
> 标签：sql-server

当我作为参数传递给 sp_execute 时，我找不到服务器名称（我已将服务器添加为链接服务器）。当我传递一个硬编码的服务器名称时，它会被执行。

```
SET @PARMDEFINITION =N'@SOURCE_SERVER_NAME_IN VARCHAR(100), @SOURCE_DB_NAME_IN VARCHAR(100) ,@DESTI_SERVER_NAME_IN VARCHAR(100), @DESTI_DB_NAME_IN VARCHAR(100),
                       @DESTI_STUDENT_COUNT_OUT INT OUTPUT,@SOURCE_STUDENT_COUNT_OUT INT OUTPUT';

SET @SQLSTRING='SELECT @SOURCE_STUDENT_COUNT_OUT=COUNT(*) FROM [@SOURCE_SERVER_NAME_IN].[@SOURCE_DB_NAME_IN].DBO.STUDENT_MST WHERE CONVERT(FLOAT, RANK) <> 0 AND PAID2 =''S'''                 

EXECUTE SP_EXECUTESQL @SQLSTRING,@PARMDEFINITION,@SOURCE_SERVER_NAME_IN=@SOURCE_SERVER_NAME,@DESTI_SERVER_NAME_IN=@DESTI_SERVER_NAME,
@SOURCE_DB_NAME_IN=@SOURCE_DB_NAME,@DESTI_DB_NAME_IN=@DESTI_DB_NAME ,
@SOURCE_STUDENT_COUNT_OUT=@SOURCE_STUDENT_COUNT OUTPUT,@DESTI_STUDENT_COUNT_OUT=@DESTI_STUDENT_COUNT OUTPUT; 
```

> *在 sys.servers 中找不到服务器“+@servername +”*

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:24:14.853

您不能将服务器或表名作为参数传递给`sp_executesql`

你必须这样做

```
SET @SQLSTRING='SELECT @SOURCE_STUDENT_COUNT_OUT=COUNT(*) FROM '
    + quotename(@SOURCE_SERVER_NAME_IN) + '.'
    + quotename(@SOURCE_DB_NAME_IN) 
    + '.DBO.STUDENT_MST WHERE CONVERT(FLOAT, RANK) <> 0 AND PAID2 =''S''' 
```

# javascript - 通过比较两个xml数据获取xml的属性

> ID：12475575
> 
> 赞同：0
> 
> 时间：2012-09-18T10:54:57.083
> 
> 标签：javascript

我试图通过将其与**另一个 xml**进行比较来获取 xml 的属性值，如下所示：

**xmlData1**变量具有类似 xml 的 --->

```
<Root>
  <RNA A="100" x="table1" y="car11"/>
  <RNA A="101" x="table2" y="car12"/>
  <RNA A="102" x="table3" y="car13"/>
  <RNA A="103" x="table4" y="car14"/>
  <RNA A="104" x="table5" y="car15"/>
  <RNA A="105" x="table6" y="car16"/>
  <RNA A="106" x="table7" y="car17"/>
  <RNA A="107" x="table8" y="car18"/>
  <RNA A="108" x="table9" y="car19"/>
</Root> 
```

**xmlData2**变量具有 xml 之类的 --->

```
<Ina>
  <RNA B="100" x="table1" y="car11"/>
  <RNA B="101" x="table2" y="car12"/>
  <RNA B="102" x="table3" y="car13"/>
</Ina> 
```

在这里我要比较喜欢

```
if(xmlData1.getAttribute(x)==xmlData2.getAttribute(x) then
//code goes 
```

如何实现这个？？？请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:00:39.493

您可以使用 jQuery 来解析 XML：

```
var result1 = $(xmlData1)
var result2 = $(xmlData2) 
```

然后您可以使用 jQuery 在您的 XML 中搜索/比较：

```
if (result1.find('RNA[A=100]').attr ('x') == result2.find('RNA[B=100]').attr('x'))
{
   //do stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:34:47.107

要查找 XML 中的差异，请尝试使用[Pretty Diff](http://prettydiff.com/)。即使属性是不同的顺序并且空白完全不一致，它也会为您完成所有这些。

以下是在没有花哨的工具的情况下如何做到这一点的方法。

```
var comparexml = function (x, y) {
        var a = (typeof DOMParser === "function") ? true : false,
            b = [],
            c = [],
            d = 0,
            e = 0,
            f = 0,
            g = function () {},
            h = {},
            i = {};
        if (a) {
            g = new DOMParser();
            b = g.parseFromString(x, "application/xml").getElementsByTagName("RNA");
            c = g.parseFromString(y, "application/xml").getElementsByTagName("RNA");
        } else {
            g = new ActiveXObject("Microsoft.XMLDOM");
            g.async = false;
            h = g.loadXML(x);
            i = g.loadXML(y);
            b = h.getElementsByTagName("RNA");
            c = i.getElementsByTagName("RNA");
        }
        d = Math.min(b.length, c.length);
        for (e = 0; e < d; e += 1) {
            for (f = 0; f < d; f += 1) {
                if (b[e].getAttribute("a") === c[f].getAttribute("b")) {
                    if (b[e].getAttribute("x") === c[f].getAttribute("x")) {
                        //your special logic goes in here
                    }
                    break;
                }
            }
        }
    }; 
```

该代码示例可能无法跨浏览器运行，因此我再次推荐一个花哨的工具，例如 Pretty Diff。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-18T11:06:05.477

合理简单。首先，您解析 xml。实际上，我已经整合了一个 X 浏览器功能，可以很好地满足您的需求。你可以[在这里找到它](http://jsfiddle.net/d6cgf/1/)
取消注释这一行：

```
keep.push(parsed);//last element of array is the full DOM 
```

就这样称呼它：

```
var data1 = parseXML(xml1,'RNA','x');//xml1 is the first xml string
var data2 = parseXML(xml2,'RNA','x');//xml2 === second xml string
var xml1Parsed = data1.splice(-1);//assign document to variable
var xml2Parsed = data2.splice(-1);
//get the nodes of intrest
var RNA1 = xml1Parsed.getElementsByTagName('RNA');
var RNA2 = xml2Parsed.getElementsByTagName('RNA'); 
```

两者`data1`和`data2`现在都是数组，只需遍历它们：

```
for (var i=0;i<data1.length;i++)
{
    if (data1[i] === data2[i])//attribute x is the same
    {//check whatever you need
        if (RNA1[i].getAttribute('y') === RNA2[i].getAttribute('y'))
        {
            console.log('node ' + i + ' is alike');//do stuff
        }
    }
} 
```

* * *

只是为了完整和清晰，这是本示例中使用的函数：

```
var parseXML = (function(w,undefined)
{
    'use strict';
    var parser,i,ie,parsed;
    ie = false;
    switch (true)
    {
        case w.DOMParser !== undefined:
            parser = new w.DOMParser();
        break;
        case new w.ActiveXObject("Microsoft.XMLDOM") !== undefined:
            parser = new w.ActiveXObject("Microsoft.XMLDOM");
            parser.async = false;
            ie = true;
        break;
        default :
            throw new Error('No parser found');
    }
    return function(xmlString,getTags,getAttr)
    {
        var tags,keep = [];
        if (ie === true)
        {
            parser.loadXML(xmlString);
            parsed = parser;
        }
        else
        {
            parsed = parser.parseFromString(xmlString,'text/xml');
        }
        tags = parsed.getElementsByTagName(getTags);
        for(i=0;i<tags.length;i++)
        {
            if (!getAttr || getAttr === 'textContent')
            {
                keep.push(tags[i].textContent);
                continue;
            }
            if (getAttr && tags[i].getAttribute(getAttr))
            {
                keep.push(tags[i].getAttribute(getAttr));
            }
        }
        keep.push(parsed);//last element of array is the full DOM
        return keep;
    }
})(this);//assuming global declaration, if not: replace with window 
```

# visual-studio-2010 - 项目参考不适用于团队构建

> ID：12475577
> 
> 赞同：0
> 
> 时间：2012-09-18T10:55:05.363
> 
> 标签：visual-studio-2010, tfs, biztalk

我有一个 VS2010 BizTalk 解决方案。这包含引用另一个模式项目的模式项目。

我能够从 VS2010 构建解决方案没问题。但是，当夜间团队构建运行时，我收到错误*架构参考“x.int.common.schemas.canonical.types 不是有效参考或当前项目中不存在*

我已经从 nightly build 文件夹中打开了解决方案。我可以看到项目参考确实存在并且一切看起来都很好。

我已经检查了 GAC 并且可以确认没有任何我的程序集的迹象。

我已经对手动构建版本和夜间构建版本的父项目文件进行了文本比较 - 它们是相同的。

我检查了 nightly build 的文件夹，在 \sources\parent 项目的 \bin 下，我可以看到它已经成功复制了子程序集。

关于为什么自动化团队构建无法解决项目参考，我已经没有想法了。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:02:42.440

我能够解决这个问题的唯一方法是重新启动构建服务器

# c++ - 为什么每帧 4 像素的 80 fps 对我来说会滞后？

> ID：12475578
> 
> 赞同：0
> 
> 时间：2012-09-18T10:55:08.890
> 
> 标签：c++, frame-rate

所以我正在开发打砖块，而运动对我来说滞后。
我不知道它为什么滞后，因为我听说 60 fps 是眼罩。
关于我应该做什么的任何建议，因为我不想以 100 fps 编程游戏，
因为如果我可以以 60 fps 编程它们，我有更少的时间来处理我的计算？
这是我的封顶框架代码。

```
//Cap the frame rate                
if( fps.get_ticks() < 1000 / FRAMES_PER_SECOND )   
{   
    SDL_Delay( ( 1000 / FRAMES_PER_SECOND ) - fps.get_ticks() );   
} 
```

如果您好奇，这是我的全部代码

```
/*This source code copyrighted by Lazy Foo' Productions (2004-2012)
and may not be redistributed without written permission.*/

//The headers
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include <string>

//The screen attributes
const int SCREEN_WIDTH = 640;
const int SCREEN_HEIGHT = 480;
const int SCREEN_BPP = 32;

//The frame rate
const int FRAMES_PER_SECOND = 40;

//The dimensions of the dot
const int DOT_WIDTH = 20;
const int DOT_HEIGHT = 20;

//The surfaces
SDL_Surface *dot = NULL;
SDL_Surface *screen = NULL;

//The event structure
SDL_Event event;

//The dot that will move around on the screen
class Dot
{
    private:
    //The X and Y offsets of the dot
    int x, y;

    //The velocity of the dot
    int xVel, yVel;

    public:
    //Initializes the variables
    Dot();

    //Takes key presses and adjusts the dot's velocity
    void handle_input();

    //Moves the dot
    void move();

    //Shows the dot on the screen
    void show();
};

//The timer
class Timer
{
    private:
    //The clock time when the timer started
    int startTicks;

    //The ticks stored when the timer was paused
    int pausedTicks;

    //The timer status
    bool paused;
    bool started;

    public:
    //Initializes variables
    Timer();

    //The various clock actions
    void start();
    void stop();
    void pause();
    void unpause();

    //Gets the timer's time
    int get_ticks();

    //Checks the status of the timer
    bool is_started();
    bool is_paused();
};

SDL_Surface *load_image( std::string filename )
{
    //The image that's loaded
    SDL_Surface* loadedImage = NULL;

    //The optimized surface that will be used
    SDL_Surface* optimizedImage = NULL;

    //Load the image
    loadedImage = IMG_Load( filename.c_str() );

    //If the image loaded
    if( loadedImage != NULL )
    {
        //Create an optimized surface
        optimizedImage = SDL_DisplayFormat( loadedImage );

        //Free the old surface
        SDL_FreeSurface( loadedImage );

        //If the surface was optimized
        if( optimizedImage != NULL )
        {
            //Color key surface
            SDL_SetColorKey( optimizedImage, SDL_SRCCOLORKEY, SDL_MapRGB(     optimizedImage->format, 0, 0xFF, 0xFF ) );
        }
    }

    //Return the optimized surface
    return optimizedImage;
}

void apply_surface( int x, int y, SDL_Surface* source, SDL_Surface* destination,                 SDL_Rect* clip = NULL )
{
    //Holds offsets
    SDL_Rect offset;

    //Get offsets
    offset.x = x;
    offset.y = y;

    //Blit
    SDL_BlitSurface( source, clip, destination, &offset );
}

bool init()
{
    //Initialize all SDL subsystems
    if( SDL_Init( SDL_INIT_EVERYTHING ) == -1 )
    {
        return false;
    }

    //Set up the screen
    screen = SDL_SetVideoMode( SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP, SDL_SWSURFACE         );

    //If there was an error in setting up the screen
    if( screen == NULL )
    {
        return false;
    }

    //Set the window caption
    SDL_WM_SetCaption( "Move the Dot", NULL );

    //If everything initialized fine
    return true;
}

bool load_files()
{
    //Load the dot image
    dot = load_image( "dot.bmp" );

    //If there was a problem in loading the dot
    if( dot == NULL )
    {
       return false;
    }

    //If everything loaded fine
    return true;
}

void clean_up()
{
    //Free the surface
    SDL_FreeSurface( dot );

    //Quit SDL
    SDL_Quit();
}

Dot::Dot()
{
    //Initialize the offsets
    x = 0;
    y = 0;

    //Initialize the velocity
    xVel = 0;
    yVel = 0;
}

void Dot::handle_input()
{
    //If a key was pressed
    if( event.type == SDL_KEYDOWN )
    {
        //Adjust the velocity
        switch( event.key.keysym.sym )
        {
            case SDLK_UP: yVel -= DOT_HEIGHT / 2; break;
            case SDLK_DOWN: yVel += DOT_HEIGHT / 2; break;
            case SDLK_LEFT: xVel -= DOT_WIDTH / 2; break;
            case SDLK_RIGHT: xVel += DOT_WIDTH / 2; break;
        }
    }
    //If a key was released
    else if( event.type == SDL_KEYUP )
    {
        //Adjust the velocity
        switch( event.key.keysym.sym )
        {
            case SDLK_UP: yVel += DOT_HEIGHT / 2; break;
           case SDLK_DOWN: yVel -= DOT_HEIGHT / 2; break;
            case SDLK_LEFT: xVel += DOT_WIDTH / 2; break;
            case SDLK_RIGHT: xVel -= DOT_WIDTH / 2; break;
        }
    }
}

void Dot::move()
{
    //Move the dot left or right
    x += xVel;

    //If the dot went too far to the left or right
    if( ( x < 0 ) || ( x + DOT_WIDTH > SCREEN_WIDTH ) )
    {
        //move back
        x -= xVel;
    }

    //Move the dot up or down
    y += yVel;

    //If the dot went too far up or down
    if( ( y < 0 ) || ( y + DOT_HEIGHT > SCREEN_HEIGHT ) )
    {
        //move back
        y -= yVel;
    }
}

void Dot::show()
{
    //Show the dot
    apply_surface( x, y, dot, screen );
}

Timer::Timer()
{
    //Initialize the variables
    startTicks = 0;
    pausedTicks = 0;
    paused = false;
    started = false;
}

void Timer::start()
{
    //Start the timer
    started = true;

    //Unpause the timer
    paused = false;

    //Get the current clock time
    startTicks = SDL_GetTicks();
}

void Timer::stop()
{
    //Stop the timer
    started = false;

    //Unpause the timer
    paused = false;
}

void Timer::pause()
{
    //If the timer is running and isn't already paused
    if( ( started == true ) && ( paused == false ) )
    {
        //Pause the timer
        paused = true;

        //Calculate the paused ticks
        pausedTicks = SDL_GetTicks() - startTicks;
    }
}

void Timer::unpause()
{
    //If the timer is paused
    if( paused == true )
    {
        //Unpause the timer
        paused = false;

        //Reset the starting ticks
        startTicks = SDL_GetTicks() - pausedTicks;

        //Reset the paused ticks
        pausedTicks = 0;
    }
}

int Timer::get_ticks()
{
    //If the timer is running
    if( started == true )
    {
        //If the timer is paused
        if( paused == true )
        {
            //Return the number of ticks when the timer was paused
            return pausedTicks;
        }
        else
        {
            //Return the current time minus the start time
            return SDL_GetTicks() - startTicks;
        }
    }

   //If the timer isn't running
    return 0;
}

bool Timer::is_started()
{
    return started;
}

bool Timer::is_paused()
{
    return paused;
}

int main( int argc, char* args[] )
{
    //Quit flag
   bool quit = false;

    //The dot that will be used
    Dot myDot;

    //The frame rate regulator
    Timer fps;

    //Initialize
    if( init() == false )
    {
        return 1;
    }    

    //Load the files
    if( load_files() == false )
    {
        return 1;
    }

    //While the user hasn't quit
    while( quit == false )
    {
        //Start the frame timer
       fps.start();

       //While there's events to handle
        while( SDL_PollEvent( &event ) )
        {
            //Handle events for the dot
            myDot.handle_input();

            //If the user has Xed out the window
            if( event.type == SDL_QUIT )
            {
                //Quit the program
                quit = true;
            }
        }

        //Move the dot
        myDot.move();

        //Fill the screen white
        SDL_FillRect( screen, &screen->clip_rect, SDL_MapRGB( screen->format, 0xFF, 0xFF, 0xFF ) );

        //Show the dot on the screen
        myDot.show();

        //Update the screen
        if( SDL_Flip( screen ) == -1 )
        {
           return 1;
        }

        //Cap the frame rate
        if( fps.get_ticks() < 1000 / FRAMES_PER_SECOND )
        {
            SDL_Delay( ( 1000 / FRAMES_PER_SECOND ) - fps.get_ticks() );
        }
    }

    //Clean up
    clean_up();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:06:19.913

由于舍入，您正在失去微秒（可能是毫秒），这会导致奇怪的行为。IE。您的逻辑不会以恒定的速度运行。

您可以做的类似于以下内容（考虑它是伪代码，因为我对 SDL 有点过时了）：

```
unsigned int lag = 0;

while (running) { // main loop
    // do event handling here
    lag += passed_time;
    reset_timer();

    // This loop is a bit more complicated:
    // - Do up to 'max_runs' logic steps
    // - Do this while the remaining time that passed since last frame is bigger than the time for one frame ('frame_time')
    // - Every loop, increase the number of runs done by 1 and sub the time for one frame
    // - For a 100 Hz simulation (100 logic steps per second), 'frame_time' would be 10.
    // - For a 60 Hz simulation (60 logic steps per second), 'frame_time' would be 17.
    for (int runs = 0; runs < max_runs && lag > frame_time; ++runs, lag -= frame_time) {
        // do game logic here
    }
    // Drop additional logic steps we couldn't process
    lag = lag % frame_time;

    // do render stuff here

    sleep(1); // Sleep for 1 millisecond to avoid having a 'passed_time' of 0 on very fast systems (depends on your timer resolution)
} 
```

您的计时器分辨率越高，您的游戏运行就越流畅。尽管这种逻辑应该将“滞后”保持在最低限度。通过这种方式使用计时，您还可以节省“等待”以获得特定帧速率。您仍然可以限制它，但您也可以只启用 VSync，这将是更好的方法。

编辑：这段代码实际上做的很简单：

*   首先，它将自上次迭代以来经过的时间与我们在上次迭代中忽略的时间相加。
*   这为您提供了自上一个逻辑步骤以来的时间窗口（逻辑步骤可以是与游戏逻辑相关的任何内容，例如移动玩家、移动子弹、添加或移除对象等）。
*   在此时间范围内每（例如）10 毫秒，运行一次逻辑步骤。如果 50 毫秒过去了，您运行游戏逻辑 5 次以赶上。如果不到 10 毫秒，你什么都不做。
*   为了避免锁定无法赶上的较慢计算机（无法处理每秒给定的迭代次数），有一个最大迭代次数要赶上。几行之后的模运算符 (%) 删除了被丢弃的开销。
*   为了避免计算机太快什么都不做（由于四舍五入从来没有时间相加），整个循环等待 1 毫秒，所以总是至少有 1 毫秒要添加。

* * *

要获得经过的时间（以毫秒为单位）：

```
unsigned int timestamp = SDL_GetTicks(); // on startup or right before entering your main loop

// when you need the time passed:
unsigned int time_now = SDL_GetTicks(); // get current time
unsigned int time_passed = time_now - timestamp; // get time difference/time passed
timestamp = time_now; // essentially reset the timer 
```

这样你可能仍然会损失一些微秒，但你应该没问题（比等待更好）。

编辑：我还没有看过新的 SDL，所以你可能不得不使用一些方法而不是 C 风格的函数。只需查看文档即可。

* * *

这是一个不需要任何其他库的示例（仅适用于 Windows，不确定您正在使用哪个系统）。请记住，这只是我整理的一些快速代码（也可以使用 MinGW、MSVC 编译良好）。

```
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
#include <cstdio>

__int64 frequency = 0;
__int64 last_time = 0;

double lag = 0;
double stat_lag = 0;

unsigned int render_steps = 0;
unsigned int logic_steps = 0;

const unsigned char target_updates_per_second = 100;
const unsigned char target_frames_per_second = 60;

// reset or initialize the timer
void reset_timer(__int64 *timer) {
    QueryPerformanceFrequency((PLARGE_INTEGER)&frequency);
    QueryPerformanceCounter((PLARGE_INTEGER)timer);
}

// get the time since last query and reset the timer for next iteration
double get_delta(__int64 *timer) {
    __int64 temp; // stores the new timestamp
    __int64 delta; // stores the difference
    QueryPerformanceCounter((PLARGE_INTEGER)&temp);
    delta = temp - *timer;
    *timer = temp;
    return (double)delta / frequency;
}

int main(int argc, char *argv[]) {
    reset_timer(&last_time);

    const unsigned int logic_frame_time = 1000 / target_updates_per_second;
    const unsigned int render_frame_time = 1000 / target_frames_per_second;

    while (1) {
        double delta = 1000 * get_delta(&last_time); // get the time that passed since last iteration (multiplied with 1000 for milliseconds)

        lag += delta; // here we add the time passed to the lag counter/timer
        stat_lag += delta; // here we do the same for the fps/ups counter

        for (char runs = 0; runs < 10 && lag > logic_frame_time; ++runs, lag -= logic_frame_time) {
            ++logic_steps; // here game logic would happen

            Sleep(0); // increase this number to simulate more load during logic steps
        }

        // lag = lag % logic_frame_time;
        // i made it the manual way to keep the double value, which is more precise here
        while (lag > logic_frame_time)
            lag -= logic_frame_time;

        if (stat_lag > 1000) { // if more than 1 second passed
            printf("updates per second: %u\nframes per second: %u\n\n", logic_steps, render_steps);

            // reset the stats
            logic_steps = 0;
            render_steps = 0;

            // stat_lag = stat_lag % 1000;
            // as above, doing it the manual way for double
            while (stat_lag > 1000)
                stat_lag -= 1000;
        }

        ++render_steps; // here rendering would happen

        // here, vsync would slow down processing, lowering the number of frames per second!
        //Sleep(...);

        Sleep(1); // avoid 0 milliseconds passing; this also causes rendering to be limited to 1000 fps!
    }
} 
```

# excel - 如何从命名范围中查找单元格的值

> ID：12475585
> 
> 赞同：2
> 
> 时间：2012-09-18T10:55:36.927
> 
> 标签：excel, excel-formula

在EXCEL中是一些形式，可以找到一个单元格的值。类似于 INDEX，但不是索引列，而是命名范围。

我想在这个命名范围中找到单元格并且我知道行的索引

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:06:43.607

只需`INDEX`像往常一样使用，并指定名称而不是范围，例如，如果`YourNamedRange`命名范围，`A1:A100`则

```
=INDEX(YourNamedRange, IndexNumber) 
```

和

```
=INDEX(A1:A100, IndexNumber) 
```

是等价的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-13T20:41:59.990

for vba range("YourNamedRange").cells(1,1) 将为您获取范围内第一个单元格的值

# tridion - Tridion 2011 SP1 中的 Razor 中介实现

> ID：12475586
> 
> 赞同：-8
> 
> 时间：2012-09-18T10:55:37.890
> 
> 标签：tridion, tridion-2011, razor-mediator

我正在尝试在 SDL Tridion 2011 Sp1 中实现 Razor 调解器。

任何人都可以提出一些有用的链接。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T11:08:38.523

*   在 Alexander Klock 的博客（扩展的创建者）中，您可以在 mediator 标签下找到一些有用的帖子：

[http://codedweapon.com/tag/mediator/](http://codedweapon.com/tag/mediator/)

*   谷歌代码项目页面：

[http://code.google.com/p/razor-mediator-4-tridion/](http://code.google.com/p/razor-mediator-4-tridion/)

*   Tridion 世界入口：

[http://www.sdltridionworld.com/community/2011_extensions/razormediator.aspx](http://www.sdltridionworld.com/community/2011_extensions/razormediator.aspx)

*   其他博文：

[http://www.curlette.com/?p=672](http://www.curlette.com/?p=672)

[http://blog.building-blocks.com/razor-templating-sdl-tridion-2011](http://blog.building-blocks.com/razor-templating-sdl-tridion-2011)

但我很确定你可以通过快速的谷歌搜索找到所有这些；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T10:59:01.120

您可以在下面的链接中找到许多详细信息

[http://code.google.com/p/razor-mediator-4-tridion/](http://code.google.com/p/razor-mediator-4-tridion/)

# sql-server - 如何在 IF 条件内创建触发器？

> ID：12475588
> 
> 赞同：3
> 
> 时间：2012-09-18T10:55:41.527
> 
> 标签：sql-server, sql-server-2008, triggers

我正在尝试在表上创建触发器。我的要求是仅在表存在时创建触发器。

例如

```
if(table exists)
        begin
             create trigger on the table 
        end 
```

谷歌搜索后，我发现这`create trigger`应该是批处理中的第一个命令。这意味着我不能`if`在当前批次中使用 the 或任何其他东西。

请帮帮我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:03:19.337

您可以使用

```
IF(OBJECT_ID('YourTable','U') IS NOT NULL)
    EXEC('CREATE TRIGGER ....') 
```

您需要通过加倍来转义触发器正文中的任何单引号。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T10:57:55.440

只需使用它自己的创建触发器语句。

如果没有表，它不会对数据库做任何事情，只是给出一个错误信息。不会有什么不好的事情发生。

# wpf - 将复选框绑定到字符串

> ID：12475589
> 
> 赞同：0
> 
> 时间：2012-09-18T10:55:43.413
> 
> 标签：wpf, string, binding, checkbox

我有一个关于复选框绑定的问题。是否可以将 WPF 复选框绑定到带有“true”或“false”的字符串。我不想在绑定中使用布尔变量

```
<CheckBox x:Name="myCheckBox" IsChecked="{Binding someBooleanVariable}"/> 
```

我想做类似的事情

```
<CheckBox x:Name="myCheckBox" IsChecked="{Binding someStringVariable}"/> 
```

我需要它，因为我想将我的 UI 的一部分绑定到包含字符串的 Hashmap。但 UI 由文本框、复选框和单选按钮组成。我想将我的 UI 元素绑定到一个带有哈希图键参数的函数。并且该函数应将给定键的值作为字符串返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:04:55.010

您可以创建和使用自定义值转换器，将字符串值转换为布尔值。[这段代码](http://www.codeproject.com/Articles/33216/Using-the-ConditionalValueConverter-to-evaluate-co)看起来像这样做（以及更多）；[这个要点](https://gist.github.com/907348)更基本，但代码也少得多。

# javascript - 为什么诸如 :not() 和 :has() 之类的函数伪函数允许引用参数？

> ID：12475595
> 
> 赞同：32
> 
> 时间：2012-09-18T10:56:12.290
> 
> 标签：javascript, jquery, jquery-selectors, sizzle

显然，正如我在评论[另一个答案](https://stackoverflow.com/questions/12472110/jquery-get-the-last-tr-with-a-th/12472203#12472203)时发现的那样，jQuery（而不是它的底层选择器引擎[Sizzle](http://sizzlejs.com)）允许您将参数引用到`:not()`选择器以及`:has()`选择器。[也就是说](http://jsfiddle.net/BoltClock/bRE9u)：

```
$('div:not("span")')
$('span:has("span")') 
```

在[Selectors 标准](http://www.w3.org/TR/selectors)中，引号始终代表字符串，而不是选择器或关键字，因此引用参数`:not()`始终无效。[这在选择器 4 中不会改变。](http://www.w3.org/TR/selectors4/#negation)

[您还可以通过添加不受支持的 CSS 选择器](https://stackoverflow.com/questions/11745274/what-css3-selectors-does-jquery-really-support-e-g-nth-last-child)（例如`:nth-last-child(1)` [导致选择器完全失败](http://jsfiddle.net/BoltClock/bRE9u/1)）来查看它的非标准语法：

```
$('div:not("span"):nth-last-child(1)')
$('span:has("span"):nth-last-child(1)') 
```

是否有任何充分的理由（技术或其他方面）允许在此处引用？唯一想到的可能性是：

*   与 which 的一致性`:contains()`允许引用和未引用的参数，如[旧的 Selectors 规范](http://www.w3.org/TR/2001/CR-css3-selectors-20011113/#content-selectors)中所示。除了`:contains()`接受字符串/关键字，不接受选择器......

*   与 using 的自定义伪实现保持一致`$.expr[':']`，它始终允许带引号和不带引号的参数。

*   移植到其方法对应项的一致性和易用性`.not()`以及`.has()`（只需删除或拆分外部引号并将冒号更改为句点？）。

但我找不到任何支持或反对他们的消息来源。事实上，引用选择器参数本身的能力也没有记录在任何地方，引用和不引用参数之间似乎也没有任何区别：

```
$('div:not(span)')
$('span:has(span)') 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-19T22:47:15.920

这不是特定于`:not(...)`和`:has(...)`选择器的——实际上，Sizzle 中的所有伪都允许引用参数。伪参数的模式定义为：

```
pseudos = ":(" + characterEncoding + ")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:" + attributes + ")|[^:]|\\\\.)*|.*))\\)|)" 
```

可以在[`91`截至`sizzle.js`的线上找到`831c9c48...`](https://github.com/jquery/sizzle/blob/831c9c489ef90134436449b5c732f93f0a0b29bb/sizzle.js#L91)

让我们为其添加一些缩进，使其更具可读性。不幸的是，这仍然是一个正则表达式，因此“更具可读性”仍然有很多不足之处：

```
pseudos = (
    ":(" + characterEncoding + ")" +
    "(?:" +
    "\\(" + // literal open-paren
        "(?:" +

                "(['\"])" + // literal open-quote
                    "((?:\\\\.|[^\\\\])*?)" + // handle backslash escaping
                "\\2" + // close-quote

            "|" + // - OR -

                "(" +
                    "[^()[\\]]*" +
                    "|" +
                    "(?:" +
                        "(?:" + attributes + ")" +
                        "|" +
                        "[^:]" +
                        "|" +
                        "\\\\." +
                    ")*" +
                    "|" +
                    ".*" +
                ")" +

        ")" +
    "\\)" + // literal close-paren
    "|" + // ie, 'or nothing'
")"
); 
```

主要的收获是：可以在伪属性中的参数周围使用单引号或双引号。反斜杠转义得到了正确处理，因此任何任意字符串都可以作为参数传入。请注意，“字符串”部分与上述正则表达式中的“选择器”部分在相同的匹配索引中结束；所以，简而言之，这就是它们被平等对待的原因：因为`pseudos`模式没有区分两者。**编辑：**从 jQuery 1.8.2 开始，带引号和不带引号的参数更明确地等效。我似乎无法在 jQuery git 存储库中找到此代码 [帮助将不胜感激]，但[由 google 托管的 1.8.2 版本具有 a0f48b6ad5322b35383ffcb6e2fa779b8a5fcffc 的 sha1sum](http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js)，具有 `"PSEUDO":`在线功能`4206`，它确实明确地检测到“引用”和“未引用”参数之间的差异，并确保它们都在同一个地方结束。此逻辑不**区分**参数所针对的伪类型（“位置”与否）。

由于 Sizzle 使用 Javascript 字符串来启动选择过程，因此在将参数传递给函数时，“字符串”和“选择器”之间没有区别。进行这种区分是可能的，但据我所知，实际想要的总是很容易从最基本的上下文中确定（即：使用哪种类型的伪），所以没有真正的理由做出区分。*（如果有任何我不知道的模棱两可的情况，请在评论中更正 - 我想知道！）*。

那么，如果字符串和选择器之间缺乏区别仅仅是实现细节，为什么诸如`:eq(...)`明确拒绝此类选择之类的伪类呢？

答案很简单：它没有，真的。至少，不是 jQuery 1.8.1。[**编辑：**从 jQuery 1.8.2 开始，它根本没有。“位置”伪参数的参数可以像其他任何东西一样被引用。以下关于 1.8.1 实现细节的注释留作历史好奇]

诸如这样的功能`:eq(...)`被实现为：

```
"eq": function( elements, argument, not ) {
    var elem = elements.splice( +argument, 1 );
    return not ? elements : elem;
} 
```

在`:eq(...)`接收参数时，它仍然是一个裸参数的形式（引号和所有）。与 不同`:not(...)`的是，这个论点没有经过一个`compile(...)`阶段。无效参数的“拒绝”实际上是由于快捷方式转换 via `+argument`，这将导致`NaN`任何带引号的字符串（反过来，它永远不会匹配任何内容）。这是另一个实现细节，尽管在这种情况下是“正确”的行为*（再次，据我所知。是否存在此类函数的非数字参数实际上应该匹配的情况？）*

**编辑：**从 jQuery 1.8.2 开始，事物已经进行了一些重构，并且“位置”伪类不再接收“原始”参数。结果，引用的参数现在被接受`:eq(...)`等。此更改似乎是另一个错误修复的副作用，因为在[af8206ff..](https://github.com/runphp/sizzle/commit/af8206ff677909e61aec0158443ff74263e6265b)的更改日志中没有提及对引用参数的支持，该更改旨在修复[处理中的错误，`:first`以及`:last`jQuery 错误 #12303](http://bugs.jquery.com/ticket/12303)。这个提交是使用一个相对简单`git bisect`的[phantomjs 脚本](https://gist.github.com/3780200)找到的。值得注意的是，在[e89d06c4..](https://github.com/runphp/sizzle/commit/e89d06c4134ec439e52382acd0e569e97fed7ebc)中的 Sizzle 重写之后，Sizzle 不仅会因为选择器而静默失败，例如`:eq("3")`，它实际上会抛出一个异常。这应该被视为`:eq("3")`支持不是预期行为的更多证据。

确实有关于自定义过滤器的基本原理，其参数在某些情况下可以被认为是字符串，有时可以被认为是选择器，无论它们表面上看起来像什么，这取决于它们被评估的方法......但是很多都在接近迂腐的。可以说，在调用函数时，至少没有区别会使事情变得更简单，无论它们代表什么，都期望字符串表示。

简而言之，整个情况可以被认为是一个实现细节，其根源在于选择器首先是作为字符串传递的（否则你如何将它们放入 Sizzle 中？）。

# javascript - 如何从后面的代码访问 IFRAME 标签内的图像？

> ID：12475596
> 
> 赞同：1
> 
> 时间：2012-09-18T10:56:13.270
> 
> 标签：javascript, asp.net, image, iframe, file-upload

我在这个页面中有一个 Frm_MngAddGoodsGrp.aspx 页面有一个 iframe 标记，它引用一个页面“OpenDialog.aspx”

这个页面在我的项目中，我创建它来打开一个对话框文件并向用户预览图像我使用名为 httphandler 的文件“ImageRequestHandler.ashx”通过将图像控件“ImgPrv”的src属性更改为“ImageRequestHandler.ashx”来预览图像这工作正常用户可以在提交保存按钮之前打开文件并预览它
我还提到我使用会话来存储字节数组中的图像文件数据并将此字节数组保存到数据库这些都是关于用户想要将新数据插入数据库的时间。

但我的问题是用户想要查看之前存储在 db 中的数据的时间
我在 Frm_MngAddGoodsGrp.aspx 中有一个 radgrid，我希望当用户单击一行 radgrid 时，IFRAME 中的图像从 db 更改为适当的图像，

我可以从 Db 读取图像的字节数组，但我不知道如何设置它到图像我也可以设置我的 httphandler 使用的会话变量，但我不知道如何在 Iframe 标记内设置图像的 imageUrl。

我也用页面中的简单图像控件完成了它，但我想在 iframe 中更改图像是否可能>如果可能我该怎么做.....

在我的 aspx 文件 Frm_MngAddGoodsGrp.aspx

```
<iframe id ="OpenDialogControl" runat="server"
 src = "OpenDialog.aspx" frameborder="0"  name="Iframe1"  
 scrolling="no" height="110px" width="100px"></iframe> 
```

在 Frm_MngAddGoodsGrp.aspx 后面的代码中

```
 byte[] SelectedImage;
 SelectedImage = (byte[])(ImageArray.Rows[selectedReceiptIndex][8]); //Image Array ->Grid Data table
 Session["SessionImage"] = SelectedImage;
 Random random = new Random();
 ShowImage0.ImageUrl = Page.ResolveClientUrl("~/ImageRequestHandler.ashx?randomno="+ random.Next(0,1000).ToString());

        //I have tried following codes to access ImagePrv Element in Iframe1 but i couldn't
        //var image = OpenDialogControl.FindControl("ImagePrv") as Image; 
```

在我的 aspx 文件中打开对话框

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script type="text/javascript" >
        function getRandomNumber() {
            var randomnumber = Math.random(10000);
            return randomnumber;
        }

        function OnClientAsyncFileUploadComplete(sender, args) {
            var handlerPage = '<%= Page.ResolveClientUrl("~/ImageRequestHandler.ashx")%>';
            var queryString = '?randomno=' + getRandomNumber();
            var src = handlerPage + queryString;
            var clientId = 'ImagePrv';
            document.getElementById(clientId).setAttribute("src", src);
        }
        function showName(object) {

            document.write(object.id);
        }
    </script>

</head>
<body style= "margin-top:0px; margin-left:0px; padding-left:0px; padding-top:0px; ">
    <form id="form1" runat="server" style= "margin-top:0px; margin-left:0px; padding-left:0px; padding-top:0px; ">
    <div style= "margin-top:0px; margin-left:0px; padding-left:0px; padding-top:0px; ">
        <img alt="" src="" id ="ImagePrv" runat="server"
            style= "margin-top:0px; margin-left:0px; padding-left:0px; padding-top:0px; height: 120px; width: 110px;"/> </div>
            <br /><br /><br />
    <div style= "visibility:visible">
        <cc1:AsyncFileUpload ID="AsyncFileUpload1" runat="server" 
            onuploadedcomplete="AsyncFileUpload1_UploadedComplete" ThrobberID="tid1" 
            onclientuploadcomplete="OnClientAsyncFileUploadComplete" />
    </div>
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    </form>
</body>
</html> 
```

在打开的对话框代码后面

```
 public partial class OpenDialog : System.Web.UI.Page
    {

    protected void Page_Load(object sender, EventArgs e)
    {

    }
    public static readonly string STORED_IMAGE = "SessionImage";
    protected void AsyncFileUpload1_UploadedComplete(object sender, AjaxControlToolkit.AsyncFileUploadEventArgs e)
    {
        if (AsyncFileUpload1.PostedFile != null)
        {
            HttpPostedFile file = AsyncFileUpload1.PostedFile;

            byte[] data = ReadFile(file);
            Session[STORED_IMAGE] = data;
        }
    }
    private byte[] ReadFile(HttpPostedFile file)
    {
        byte[] data = new Byte[file.ContentLength];
        file.InputStream.Read(data, 0, file.ContentLength);
        return data;

    }

} 
```

我有一个名为 ImageRequestHandler.ashx 的 httphandler

ImageRequestHandler.ashx 后面​​的代码

```
public class ImageRequestHandler : IHttpHandler, IRequiresSessionState
    {
        public void ProcessRequest(HttpContext context)
        {
            context.Response.Clear();

           if (context.Request.QueryString.Count != 0)
            //if (context.Request.Cookies.Count != 0)
            {
                var storedImage = context.Session[OpenDialog.STORED_IMAGE] as byte[];
                if (storedImage != null)
                {
                    Image image = GetImage(storedImage);
                    if (image != null)
                    {
                        context.Response.ContentType = "image/jpeg";
                        image.Save(context.Response.OutputStream, ImageFormat.Jpeg);
                    }
                }
            }
        }

        private Image GetImage(byte[] storedImage)
        {
            var stream = new MemoryStream(storedImage);
            return Image.FromStream(stream);
        }

        public bool IsReusable
        {
            get { return false; }
        }
    } 
```

我希望如果有任何使用 javascript 的解决方案，我已经尝试过 document.geteleme .... 但它不起作用！
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:23:27.487

即使您的 iframe 嵌入在 Frm_MngAddGoodsGrp.aspx 中，您也需要将 Frm_MngAddGoodsGrp.aspx 和 OpenDialog.aspx 视为单独的页面（它们是）。您不能直接从另一个页面的代码隐藏更改显示在一个页面中的内容。

也就是说，托管 iframe 的页面可以通过多种方式与托管在 iframe 中的页面进行通信：

1.  如果页面来自同一个应用程序，它们可以共享会话状态。您可以在父页面的会话中放置一些东西（例如图像ID）并让子页面访问它。
2.  因为 iframe 的`src`属性可以在父页面中设置，所以可以将查询字符串中的值传递给子页面。
3.  您可以强制 iframe 重新加载，从而强制子页面经历其生命周期。如果您在会话状态或子页面查询字符串中更改了值，则可以再次访问它们。

假设您的父页面知道新图像的 id 是什么，我会将 iFrame 的 src 属性设置为`OpenDialog.aspx?imageId=12345`并让 OpenDialog.aspx 从其查询字符串中检索值并使用它来设置`ImageUrl`图像控件的属性。

# c# - C# 将对象添加到列表

> ID：12475597
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:16.987
> 
> 标签：c#, asp.net-mvc-3, list

我创建了一个新的用户类型的空列表**（**用户**是**我的 EDM 中的实体）

```
List<User> AvailableLocums = new List<User>();
AvailableLocums = null; 
```

我还有另一个**用户**类型的列表，其中填充了查询结果

```
List<User> Locums = _shiftDateService.GetAvailableLocums(id, shiftDate.shiftDateID).ToList(); 
```

然后我希望循环**Locums** List，做一些逻辑，然后将用户添加到我的**AvailableLocums** List

```
foreach (var locum in Locums)
{
   //Do some logic

   AvailableLocums.Add(locum);

} 
```

但是，当我尝试这样做时，出现以下错误

> 你调用的对象是空的。

然后我尝试修改我的代码并执行以下操作

```
foreach (var locum in Locums)
{
       //Do some logic

       User locumUser = new User();
       locumUser = locum;

       AvailableLocums.Add(locumUser);     
} 
```

但我又得到了同样的错误

> 你调用的对象是空的。

有人可以帮我吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:01:24.800

你告诉你的变量“AvailableLocums”不再指向内存中的任何东西。

删除：AvailableLocums = null;

怎么样：

```
List<User> AvailableLocums;
List<User> Locums;

// get id for shift date service
// int id = ...

// get locums from shift date service 
Locums = _shiftDateService.GetAvailableLocums(id, shiftDate.shiftDateID).ToList();

// time to add to AvailableLocums
if(AvailableLocums == null)
    AvailableLocums = new List<User>();

foreach (var locum in Locums)
{
   //Do some logic

   AvailableLocums.Add(locum);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T10:57:16.813

您正在取消该列表

```
List<User> AvailableLocums = new List<User>();
AvailableLocums = null; // HERE 
```

因此，例外。您不需要此行来创建一个空列表：

```
AvailableLocums = null; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:58:17.623

走出这条线：

```
AvailableLocums = null; 
```

一切都会好的...您声明新对象并在下一行将其设置为null？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:59:46.720

尝试

```
List<User> Locums = new List<User>(); 
```

在 _shiftDateService.GetAvailableLocums 之前...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T11:46:13.040

试试这个代码。

```
List<User> AvailableLocums = null; 
List<User> Locums = _shiftDateService.GetAvailableLocums(id, shiftDate.shiftDateID).ToList();  
AvailableLocums = Locums.Where(newUserRecord => newUserRecord != null).ToList(); 
```

***您可以使用任何名称而不是“newUserRecord”。

# dreamweaver - 在 Dreamweaver CS 5.5 中设置 codeigniter

> ID：12475598
> 
> 赞同：1
> 
> 时间：2012-09-18T10:56:18.077
> 
> 标签：dreamweaver, codeigniter-2, code-hinting

我正在寻找有关如何在 Dreamweaver CS 5.5 中使用代码提示设置代码点火器项目的信息，就像 Zend 框架一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T14:21:09.887

I have managed to set code igniter up in Dreamweaver CS5.5 by downloading the latest version of code igniter and placing in a folder called php_librarys on the root of my C: drive. I then followed the instructions for site specific code hinting here: [How to set up site specific code hinting](http://tv.adobe.com/watch/learn-dreamweaver-cs5/sitespecific-code-hinting-in-dreamweaver-cs5/). The folder you need to point Dreamweaver to is the libraries folder in the system directory of Code igniter. Just make sure you select recursive and .php as the extension as per the screenshot below:

![Site specific hints for codeigniter in dreamweaver](../Images/7cded4c38c2fc354ca76f3e204a01299.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-26T20:52:09.023

```
 very simple in dreamwaver to autocomplete any functions in wordpress - codeigniter or even your custom library of code
 steps are as follows:
 1- in dreamwaver open site -> Site Specific Code Hints -> (You can select wordpress-joomla-...) or even any folder like (CI folder) that you mentioned.
 2- do not forget to select (scan this folder,recursive)
 3- it will ask you for custom name just write any one you like "like mynewCI"
 it will create a config file in your selected folder => do not remove it.
 that is all
 the process in detail in this video
 http://tv.adobe.com/watch/learn-dreamweaver-cs5/using-php-code-hinting-in-dreamweaver-cs5/
 now press ctrl+space and enjoy.
 if this answer was helpful, please vote me up!
 thanks 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-24T14:48:18.543

我跟着这个，但第一次没有运气。在玩了一段时间后进入 DW 让它工作，暂停了一段时间 - 重新启动 DW 后它工作。

我使用了最后一个 CI：CodeIgniter-3.0.4.zip

它是如何制作的：

1./下载CI - 并将其解压缩到XAMPP htdocs文件夹中的文件夹code1（您可以自由选择的名称） - 在我的情况下也是：d:\WWW\xampp5615\htdocs\code1\。

2./ 在 DW 中配置站点和服务器以使实时视图成为可能（玩它，有时我会在一段时间后忘记如何操作... :-) ）

3./ 在 DW 中配置特定于站点的代码提示 - 在我的情况下，我将站点代码 1 的根添加到此菜单中 - 参见 printscreen - 不要忘记定义 .php 扩展名 + 递归 + 扫描

4./如果不工作重新启动 DW - 它现在应该工作...... index.php 完全呈现为实时视图:-) 我很幸运。可以学习使用 CI PHP 框架做一些事情... :-)

希望能帮助到你...

Printscreen：[CodeIgniter-3.0.4 和 Dreamweaver CC 2015](http://i.stack.imgur.com/aNXky.jpg)

# sql-server - 添加查询超时

> ID：12475600
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:26.627
> 
> 标签：sql-server, ssrs-2008

我在 SSRS 中创建了一份报告。由使用存储过程的数据集的结果生成的报告。但是存储过程需要 20 分钟的运行时间。如何为此报告添加查询超时。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:47:29.733

您通常可以使用 SQL Server Management Studio R2 为报表执行指定超时。打开 SSMS，选择 Reporting Service 作为连接类型。使用管理用户登录。在对象资源管理器的根目录下，右键单击选择的属性。转到执行选项卡并选择限制以秒为单位（默认值：1800 = 30 分钟）。

另一种方法是限制单一报告的执行。在设计器中打开报表并选择您的数据集。右键单击数据集并选择数据集属性。在 Query 窗口中，您将在下面找到 Timeout 属性（默认为 0 = 无限）。以秒为单位将其设置为适当的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-08T08:57:30.403

对我来说简单的解决方法。只需将您的 SP 限制为选择前 1 并暂时删除需要键入的任何参数，刷新数据集，然后在 SP 中添加回参数并在 rdl 中手动添加参数。完成此操作后，从 SELECT 语句中删除 TOP 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T14:24:47.150

您实际上可以在部署的报告中管理超时。

转到您的 SSRS 网址。点击报告。点击管理。单击处理选项。在那里你有三个选项来管理超时。

这样做意味着您可以在生产环境和开发环境之间设置不同的超时设置。

# c++ - 无法将 .tlb 导入我的 DLL

> ID：12475602
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:32.073
> 
> 标签：c++, visual-studio-2008, dll, sdk, mfc

我在 Visual Studio 2008 中创建基于第三方 SDK 的 C++ MFC DLL。SDK 提供 TLB 文件夹、Lib 文件夹（仅限 .lib）、Include 文件夹（仅限.h 和 .hpp）和 Bin 文件夹（一些 exes、DLL 和 .ax 文件）。我尝试通过以下方式将 SDK 库链接到我的 DLL：

*   C/C++ -> General -> Additional Include Directories - Bin、Include 和 TLB 文件夹（以防万一）；
*   链接器 -> 常规 -> 附加库目录 - Lib 和 Bin；
*   链接器 -> 输入 -> 附加依赖项 - Lib 文件夹中的 .lib

这样做我会因为链接问题（未声明的标识符等）而编译错误，所以我为 TLB 添加了一个导入行：

```
#import "C:\Path\To\Tlb.tlb" raw_interfaces_only, raw_native_types, no_namespace, named_guids 
```

这会弹出另一个关于类型重新定义的编译错误：

```
error C2011: '_SYSTEMTIME' : 'struct' type redefinition 
```

我错过了什么？我对 Windows 编程很陌生。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:08:00.427

我不知道为什么 _SYSTEMTIME 在它被定义`<Windows.h>`或由它带来的东西时被重新定义。

无论如何，请尝试从 #import 指令中删除 no_namespaces。命名空间的存在是为了避免像这样的名称冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:02:45.073

您尝试导入暴露已定义对象的类型库。

你从哪里得到这个图书馆的？

你可以删除

> no_namespace

但只有在类型库中的对象是在其他命名空间中定义时才可能有帮助，然后是全局的。

您也可以只尝试导入指令的一个属性

> raw_interfaces_only

这取决于您想从 TLB 实现/导入什么。

MSDN[文档](http://msdn.microsoft.com/en-us/library/8etzzkb6%28v=vs.100%29.aspx)

# django - 使用多对多关系时将数据表输入表的问题

> ID：12475603
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:31.747
> 
> 标签：django, django-models, django-views

我正在开发一个具有两个模型的应用程序，因为我指定了多对多关系，因此 django 自己创建第三个表来定义两个模型之间的关系，但我无法将数据（两个表的 ID）输入到第三个表。所以任何人都可以告诉我我该怎么做

模型.py：

```
from django.db import models
from django.contrib.auth.models import User

class Customer(models.Model):
    user        =models.OneToOneField(User)
    birthday    =models.DateField()
    website     =models.CharField(max_length=50)
    store       =models.CharField(max_length=50)
    welcomemail =models.CharField(max_length=50)

    def __unicode__(self):
             return self.user

class Customer_check_attributes(models.Model):
    user        =models.ManyToManyField(User)
    billing_add =models.CharField(max_length=100, blank=True , null=True)
    shipping_add    =models.CharField(max_length=100, blank=True , null=True)
    payment_method  =models.CharField(max_length=100, blank=True , null=True)
    shipping_method =models.CharField(max_length=200, blank=True , null=True)
    reward_points   =models.CharField(max_length=100, blank=True , null=True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:00:34.063

为什么需要访问中间表？如果您只是使用自动创建的并且没有在关系上添加任何额外字段，则没有理由这样做。

只需按照通常的方式将项目添加到您的多对多：

```
item1 = Model1.objects.create(foo='bar')
item2 = Model2.objects.create(spam='eggs')
item1.item2s.add(item2) 
```

# vb.net - 导入电子表格 + 数据操作并保存到数据库

> ID：12475604
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:33.290
> 
> 标签：vb.net, jquery-datatables

您好我需要导入电子表格 - 验证数据并保存到数据库。

电子表格数据来自两个来源。一个可以直接导入（这个我没问题）。在将数据保存到数据库之前，必须对来自第二个来源的电子表格中的数据进行处理。

我创建了一个网页，它上传 xls 文件，然后导入数据表。然后数据表是网格视图的数据源。然后我进行验证并保存到数据库。

此代码适用于标准电子表格。我现在需要修改代码，以便它可以处理任何一种类型的源电子表格。

示例数据标准源

```
Unique ID   Ref       PartName           New_SH Year  ProductType   Location  Qty  TopSeller
39564       SD9PP/SS  Micra Water Pump   N      2012  Cooling       CD19       12  Y 
```

需要操纵的来源

```
Unique ID   Ref                   PartName          New_SH  Year  ProductType   Location    Qty  TopSeller
IS-4564     XM3M_ZZ_001_001_1982  180 wiper motor   S             Wiper Motor   CD19          3  N 
```

在上面的示例中，需要对 Ref 进行操作，以便将最后 4 位数字传输到 YEAR 列，并且修剪 Ref 的第一部分直到第二个下划线，并将下划线替换为 / 例如 XM3M/ZZ。引用可以是从 4+2suffix 到 6+2suffix 的任何内容，但后面总是跟着 _XXX_XXX_YYYY，其中 X 和 Y 是数字 X 不是必需的，YYYY 是年份。

我的计划是将电子表格导入临时数据表，然后逐行逐个单元格地浏览该表，并在进行任何必要的更改后复制到另一个数据表。然后将第二个表用作 gridview 的数据源。

这是我的代码...

```
Protected Sub ReadExcelFile(filename As String, worksheet As String)

Try
' Fetch Data from Excel data is based on the following
'Unique ID  Ref         PartName        New_SH  Year    ProductType Location    Qty TopSeller
'IS-4564    XM3M_ZZ_001_001_1982    180 wiper motor     S       Wiper Motor CD19            3   N
'35667      SD9PP/SS        Micra water pump    N   2012    Cooling     CA4     14  Y

Dim MyConnection As New OleDbConnection("provider=Microsoft.Jet.OLEDB.4.0; data source='" & filename & "'; Extended Properties='Excel 8.0; HDR=Yes; IMEX=1'")
Dim MyCommand As New OleDbDataAdapter("select * from [" & worksheet & "]", MyConnection)
Dim dtPreview As New DataTable()
Dim dtTemp As New DataTable()

    'Place data in temp datatable
    MyCommand.Fill(dtTemp)

    'Go through tem[ datatable and transfer cell values to dtPreview
    If dtTemp.Columns.Count < 9 Then
    'We do not have enough columns
    lb_Error.Text = "Spreadsheet does not contain enough columns
    Exit Sub

    Else
    'We have at least 9 columns - we are only interested in the first 9
    If dtTemp.Rows.Count > 0 Then
        'we have at least one row

        'Add Column Headers
        For c = 0 To dtTemp.Columns.Count - 1
        dtPreview.Columns.Add(dtTemp.Columns(c).ColumnName, dtTemp.Columns(c).DataType)
        Next

        'Add Row Data
        Dim l As Integer = 0
        For Each drTempRow As DataRow In dtTemp.Rows

        Dim newRow As DataRow = dtPreview.NewRow()

        'Unique ID
        If Left(dtTemp.Rows(0).ToString, 3) = "IS-" Then
            newRow(0) = Mid(dtTemp.Columns(0).ToString.ToUpper.Trim, 4, 8)
        Else
            newRow(0) = dtTemp.Columns(0).ToString.ToUpper.Trim
        End If

        'Ref
        If Left(dtTemp.Rows(0).ToString, 3) = "IS-" Then
            l = Len(dtTemp.Columns(1).ToString.Trim)
            newRow(1) = Left(dtTemp.Columns(1).ToString.Replace("_", "/").ToUpper.Trim, l - 13)
        Else
            newRow(1) = dtTemp.Columns(1).ToString.ToUpper.Trim
        End If

        'Part Name
        newRow(2) = dtTemp.Columns(2).ToString.ToUpper.Trim

        'New / Secondhand
        newRow(3) = dtTemp.Columns(3).ToString.ToUpper.Trim

        'Year
        If Left(dtTemp.Columns(0).ToString, 3) = "IS-" Then
            newRow(4) = Right(dtTemp.Columns(0).ToString, 4)
        Else
            newRow(4) = dtTemp.Columns(4).ToString
        End If

        'Product Type
        newRow(5) = dtTemp.Columns(5).ToString.ToUpper.Trim

        'Location
        newRow(6) = dtTemp.Columns(6).ToString.ToUpper.Trim

        'Quantity in Stock
        newRow(7) = dtTemp.Columns(7).ToString

        'Top Seller
        newRow(8) = dtTemp.Columns(8).ToString.ToUpper.Trim

        dtPreview.Rows.Add(newRow)

        newRow = Nothing
        Next

    End If

    'Add additional columns
    dtPreview.Columns.Add("RecdBy", GetType(System.Int16), Session("UserNo").ToString())

    If ddl_FileSource.SelectedValue.ToString() = "1" Then
        dtPreview.Columns.Add("IntExt", GetType(System.Int16), "1")
    Else
        dtPreview.Columns.Add("IntExt", GetType(System.Int16), "0")
    End If

    dtTemp = Nothing

End If

'Bind DataTable to Gridview
Session("dtgv") = dtPreview
gv_StockData.DataSource = dtPreview
gv_StockData.DataBind()
MyConnection.Close()

Catch msg As Exception
lb_Error.Text = msg.Message

End Try 
```

结束子

问题是我遇到了错误......我是否从正确的角度接近这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T12:33:34.957

排序...循环遍历数据表中每个单元格的代码有缺陷...将在今天晚些时候发布工作版本。

# asp.net-mvc - 如果设置了 Range 并禁用了 Javascript，ASP.NET MVC 无法绑定和验证 DropDownListFor

> ID：12475605
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:36.423
> 
> 标签：asp.net-mvc, html.dropdownlistfor, server-side-validation

我的模型中有以下属性：

```
 [Required]
    [Range(1, int.MaxValue, ErrorMessage = "Bad number")]
    public virtual int Number { get; set; } 
```

我在控制器中填写它：

```
List<SelectListItem> items = new List<SelectListItem>();
// numbers is just a list with entities with an integer field Number
items.AddRange(numbers.
                Select(n => new SelectListItem() { Text = n.Number.ToString(), Value = n.Number.ToString() })
                .ToArray());

ViewBag.Numbers = items; 
```

在我看来，我有以下几点：

```
 @Html.DropDownListFor(m => m.Number, ViewBag.Numbers as IEnumerable<SelectListItem>, "Select a number")
            @Html.ValidationMessageFor(m => m.Number) 
```

如果启用了 Javascript，它似乎工作正常 - 当我选择第一项（它是空的“选择一个数字”）时，必需的验证器会启动并且不允许发布。

但是，当我禁用 Javascript 时，我在该 DropDownListFor 方法调用上的视图中出现异常：

```
The ViewData item that has the key 'Number' is of type 'System.Int32' but must be of type 'IEnumerable<SelectListItem>'. 
```

当我注释掉 [Range] 时，没有这样的异常，但似乎Required 不起作用-我可以发布空的“选择一个数字”选项（它具有 value=""）并且我的模型通过了验证，但它不应该 - 空字符串不是有效的整数！为什么它在启用 Javascript 的情况下工作正常，但在服务器端失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:59:09.127

在您的 POST 操作中，不要忘记重新填充`ViewBag.Numbers`属性，就像您在返回视图之前在 GET 操作中所做的一样：

```
[HttpPost]
public ActionResult SomeAction(MyViewModel model)
{
    // some processing ...

    // now repopulate the ViewBag if you intend to return the same view
    ViewBag.Numbers = numbers
        .Select(n => new SelectListItem { 
            Text = n.Number.ToString(), 
            Value = n.Number.ToString() 
        })
        .ToList();

    return View(model);
} 
```

# java - 无法导入csv包

> ID：12475607
> 
> 赞同：0
> 
> 时间：2012-09-18T10:56:43.240
> 
> 标签：java, android, csv

[我从这个网站](http://flatpack.sourceforge.net/)下载了用于读取 csv 文件的库， 正如我尝试使用导入命令 au.com.bytecode.opencsv.CSVReader 导入包时提到的那样；日食用红色勾勒它。我的问题是：谁能告诉我如何正确导入这个包？

注意：我通过构建路径将包导入到我的项目中，配置构建路径-库-添加外部jar。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:22:31.873

该库是基于 Java SE 编写的。它可能与 Android SDK 不兼容的原因有很多。

# iphone - 我们如何在 Toolbar 中重复添加图像？

> ID：12475609
> 
> 赞同：-2
> 
> 时间：2012-09-18T10:56:46.863
> 
> 标签：iphone, objective-c, ios, uitoolbar, ipad

请任何人都可以给出在X轴上重复添加图像的想法。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:09:16.027

嗨，这是按类别将图像添加到 UIToolBar 的代码....

**.h 文件：**

```
#import <UIKit/UIKit.h>

@interface UIToolbar (AddtitionalFuntionality)

+(void)setToolbarBack:(NSString*)bgFilename toolbar:(UIToolbar*)toolbar;

@end 
```

**.m 文件：**

```
#import "UIToolbar+AddtitionalFuntionality.h"

@implementation UIToolbar (AddtitionalFuntionality)

+(void)setToolbarBack:(NSString*)bgFilename toolbar:(UIToolbar*)bottombar {  
    // Add Custom Toolbar
    UIImageView *iv = [[UIImageView alloc] initWithImage:[UIImage imageNamed:bgFilename]];
    iv.frame = CGRectMake(0, 0, bottombar.frame.size.width, bottombar.frame.size.height);
    iv.autoresizingMask = UIViewAutoresizingFlexibleWidth;
    // Add the tab bar controller's view to the window and display.
    if([[[UIDevice currentDevice] systemVersion] intValue] >= 5)
        [bottombar insertSubview:iv atIndex:1]; // iOS5 atIndex:1
    else
        [bottombar insertSubview:iv atIndex:0]; // iOS4 atIndex:0
    bottombar.backgroundColor = [UIColor clearColor];
}

@end 
```

**呼叫声明将是....**

```
[UIToolbar setToolbarBack:@"tool-bar.png" toolbar:toolBarTop]; 
```

类的源代码在[这里](https://www.dropbox.com/sh/9bcgh3lan9luies/pDLkgZo-vG?m)

博客链接：[网站](http://arunios.blogspot.in/2012/09/uitoolbar-categories.html)

# html - CSS元素是如何组合的

> ID：12475613
> 
> 赞同：2
> 
> 时间：2012-09-18T10:57:13.410
> 
> 标签：html, css, css-selectors

我有几个要分组的 CSS 元素。

目前我正在使用：

```
.elementA {
    padding: 3px;
}

.elementB {
    padding: 3px;
} 
```

我想将它们组合成一个规则，以避免一遍又一遍地重复内容。例如

```
.elementA and .elementB {
    padding: 3px;
} 
```

你怎么做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T10:59:49.573

```
.elementA, .elementB {
    padding: 3px;
} 
```

通过逗号分隔符`,`，您可以组合

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T10:58:16.577

```
.elementA, .elementB { padding: 3px; } 
```

逗号是组合符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T10:58:45.580

尝试这个

```
.elementA,.elementB {
    padding: 3px;
} 
```

参考[http://www.smileycat.com/miaow/archives/000152.php](http://www.smileycat.com/miaow/archives/000152.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T10:58:30.057

习惯了这个

```
.elementA, .elementB{
    padding: 3px;
} 
```

使用`(,)`逗号

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T10:58:44.113

只需用逗号分隔您的课程

```
.elementA, .elementB {
    padding: 3px;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-18T10:58:49.293

使用逗号 ( `,`)

```
.elementA, .elementB {
    padding: 3px;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-18T10:58:07.233

```
.elementA, .elementB {
    padding: 3px;
} 
```

# java - 编码 InternetAddress Personal 的正确方法

> ID：12475615
> 
> 赞同：1
> 
> 时间：2012-09-18T10:57:17.250
> 
> 标签：java, jakarta-mail

我需要通过 java 发送邮件，其中 InternetAddress 的 Personal（发件人姓名）可以是任意 UTF8 字符串。由于我的电子邮件地址字符串可能包含或不包含个人信息，因此我仅使用 InternetAddress( String ) 构造函数来构建适当的 InternetAddress：

```
InternetAddress sender = new InternetAddress( "s\u00E8nder <from@example.org>" );
sender.setPersonal( sender.getPersonal(), Charsets.UTF_8.name() ); 
```

根据我的理解（因为测试似乎支持这一点），基本的 InternetAddress 构造函数不执行任何个人编码，所以我在一个额外的步骤中执行此操作，该步骤对符合 MIME 的个人进行编码。

我的问题是如果这个过程在某些情况下可能会失败，javadoc 说如果解码失败，.getPersonal() 可能会返回原始数据。但这真的会发生吗？如果它失败会导致任何麻烦，因为 javadoc 告诉 setPersonal 仅当它包含非 ASCII 时才进行编码，但 rawdata 不会这样做，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T18:13:51.450

您使用的构造函数假定地址字符串已经正确编码，就像您从电子邮件标题中读取它一样。您应该分别维护电子邮件地址和个人姓名字段，并使用将它们作为单独参数的构造函数。如果您没有个人姓名，则可以传递 null。

您可以使用 toUnicodeString 方法取回您正在使用的格式的字符串，但无法解析这样的字符串。

# actionscript-3 - Flash AS3 - 在移动时找到补间对象的 Y 位置

> ID：12475618
> 
> 赞同：0
> 
> 时间：2012-09-18T10:57:34.397
> 
> 标签：actionscript-3, flash, transition, tween

我的 Flash AS3 脚本如下，我的问题是如何在移动时找到（跟踪）补间对象的 Y 位置...

我想知道这样的位置：objectA = -50, 0, 25, 50 ... 150, 170, 180, 200, 210 ..., 750, 800。

```
var objTween = new Tween(objectA, "y", Strong.easeOut, -100, 800, 15, true);
objTween.start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:43:37.487

另外，如果您只想打印出值，则可以直接运行补间函数，我认为这很酷

```
for (var i:int=0; i< 15*60; i++) {
    trace (Strong.easeOut(i, -100, 800, 15*60));
} 
```

[（文档）](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/transitions/easing/Strong.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:22:18.073

您可以监听`TweenEvent.MOTION_CHANGE`每次修改补间对象时触发的事件。

（[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/transitions/Tween.html#event%3amotionChange)）

*示例（未经测试）：*

```
var objTween:Tween = new Tween(objectA, "y", Strong.easeOut, -100, 800, 15, true);
objTween.addEventListener(TweenEvent.MOTION_CHANGE, onTweenChange);
objTween.start(); 
```

*[...]*

```
function onTweenChange(e:TweenEvent):void {
    trace(objectA.y);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T12:24:47.397

```
import fl.transitions.Tween;
import fl.transitions.easing.*;
import fl.transitions.TweenEvent;

var objTween = new Tween(objectA,"y",Strong.easeOut,-100,800,15,true);
objTween.addEventListener(TweenEvent.MOTION_CHANGE, tweenEvents);
objTween.start();

function tweenEvents(e)
{
    switch (objectA.y)
    {
        case -100 :
            trace("objectA is at -100");
            break;
        case 800 :
            trace("objectA is at 800");
            break;

        default :
            trace(objectA.y);
    }
} 
```

我是 switch case 语句的忠实粉丝，仅仅是因为它们感觉比一系列 if else 语句更干净......你可以做类似的事情`if (objectA.y ==50){trace("at 50")};`

希望有帮助:)

# c# - 如何使用函数 max 进行自动编号？

> ID：12475619
> 
> 赞同：0
> 
> 时间：2012-09-18T10:57:45.017
> 
> 标签：c#, windows, winforms, linq, c#-4.0

我需要使用函数 max 运行自动编号，否则它可以工作。

我正在使用将文件 excel 导入到 datagridview 并生成字段'refId' 以防止重复。

**代码：**

```
int count = 1;

sb = new StringBuilder();
sb.Append("SELECT COUNT(*) FROM tableAset");

string sql = sb.ToString();
cmd.CommandText = sql;
cmd.CommandType = CommandType.Text;
cmd.Connection = Conn;

count = (int)cmd.ExecuteScalar();
int newCount = count;

for (int i = 0; i < dataGridView1.Rows.Count; i++)
{
    newCount = newCount + 1;
    dataGridView1.Rows[i].Cells[0].Value = cbType.Text + "000" + newCount;
    dataGridView1.Rows[i].Cells[8].Value = cbType.Text;
    dataGridView1.Rows[i].Cells[9].Value = "000" + newCount;
}

cmd.ExecuteNonQuery(); 
```

**现在的结果。**

refId | 类型标识 | 自动编号

M0005 | 中号 | 5

M0006 | 中号 | 5

T0001 | T | 1

T0002 | T | 2

Y0003 | 是 | 3

Y0004 | 是 | 4

**但我需要结果：**

前任。

*   第一次导入。

refId | 类型标识 | 自动编号

M0001 | 中号 | 1

M0002 | 中号 | 2

T0001 | T | 1

T0002 | T | 2

Y0001 | 是 | 1

Y0002 | 是 | 2

*   第二次导入。

refId | 类型标识 | 自动编号

M0003 | 中号 | 3

M0004 | 中号 | 4

T0003 | T | 3

T0004 | T | 4

Y0003 | 是 | 3

Y0004 | 是 | 4

**这是在数据库中总结的。**

refId | 类型标识 | 自动编号

M0001 | 中号 | 1

M0002 | 中号 | 2

M0003 | 中号 | 3

M0004 | 中号 | 4

T0001 | T | 1

T0002 | T | 2

T0003 | T | 3

T0004 | T | 4

Y0001 | 是 | 1

Y0002 | 是 | 2

Y0003 | 是 | 3

Y0004 | 是 | 4

我很抱歉经常提问。

非常感谢你的时间。:))

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:48:18.940

```
public int Autogenerate()
{
    con = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Directory.GetCurrentDirectory() + "/CleaningTroopers.mdb");
    con.Open();
    string str4 = "select iif(isnull(max(uom_code)),1000,max(uom_code)+1) from uom_master ";
    cmd = new OleDbCommand(str4, con);
    OleDbDataAdapter da = new OleDbDataAdapter(cmd);
    DataTable dt = new DataTable();
    da.Fill(dt);
    return Convert.ToInt32(dt.Rows[0][0]);
    con.Close();
} 
```

# php - 如何从 php 中的函数内部获取值？

> ID：12475620
> 
> 赞同：0
> 
> 时间：2012-09-18T10:57:45.880
> 
> 标签：php, function

我想从函数内部获取一些值，然后在外部使用它们进行计算？可能吗？我是 PHP 新手。

假设我有代码：

```
function snltc($ema)
{ 
    $uemail = $ema;

    $snlc = mysql_query("SELECT * FROM usertree WHERE slot1='$uemail' || slot2='$uemail' || slot3='$uemail' || slot4='$uemail' || slot5='$uemail'");
    $dsnl = mysql_fetch_array($snlc);

    echo $dsnl['supemail'];
    echo "</br>";
    echo $dsnl['snlt'];
    $sup1 = $dsnl['supemail'];
    $snltu = $dsnl['snlt'] + 1;
    echo "</br>";
    echo $snltu;
    mysql_query("UPDATE usertree SET snlt='$snltu' WHERE supemail='$sup1'");
    $newsnl = mysql_fetch_array($snlc);
    echo "</br>";
    $snlval = $newsnl['snlt'];
    echo "</br>";
    return $snlval;
}

echo "</br>";
echo snltc('gami@gmail.com'); 
```

现在，我想从这段代码中使用`$snlval`函数`$sup1`外部和函数外部。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:01:06.370

您可以将其作为数组返回：

```
function snltc($ema){ 
    $uemail = $ema;
    $snlc = mysql_query("SELECT * FROM usertree WHERE slot1='$uemail' || slot2='$uemail' || slot3='$uemail' || slot4='$uemail' || slot5='$uemail'");
    $dsnl = mysql_fetch_array($snlc);
    $sup1 = $dsnl['supemail'];
    $snltu = $dsnl['snlt'] + 1;
    mysql_query("UPDATE usertree SET snlt='$snltu' WHERE supemail='$sup1'");
    $return = array();
    $return['snlval'] = $snltu;
    $return['sup1'] = $sup1;
    return $return;
} 
```

那么你可以使用

```
$return = snltc('gami@gmail.com');
echo $return['snlval'];
echo $return['sup1']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:01:04.503

在您的功能中：

```
return array($snival, $sup1); 
```

调用函数：

```
$values = snltc($x);
echo $values[0] . $values[1]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:01:39.430

返回数组中的两个值：

```
function snltc($ema)
{
  // ...
  return array($sup1, $snlval);
}

list($sup1, $snlval) = snltc('gami@gmail.com'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T11:02:13.090

> 现在我想从这段代码中使用 $snlval outsideof 函数和 $sup1 outside of the function 我怎么能做到这一点？

假设您要返回 2 个变量..您会将它们放入一个数组并返回该数组，因此您的 return 语句变为

```
return array('snlval' => $snlval, 'sup1' => $sup1 ); 
```

所以当你调用这个函数时......

```
$result = snltc('gami@gmail.com');
$snlval = $result['snlval'];
$sup1 = $result['sup1']; 
```

# vb.net - 我可以将什么用作 List 的泛型，以便我可以在 vb.net 中更改列表中的类型

> ID：12475621
> 
> 赞同：0
> 
> 时间：2012-09-18T10:57:49.280
> 
> 标签：vb.net

所以我目前有

```
class general
private list as List(Of string) 

public overridable function getprivateList as <not sure what to put>
    return list
end function
end class

class specific inherits general
private list as List(Of listofstrings)

end class 
```

但我无法弄清楚将什么用作界面。因此 getprivateList 方法能够返回列表的两种变体，具体取决于实现的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:01:26.330

您可以返回`IEnumerable`,`ICollection`或`IList`. `IEnumerable`功能最少，功能`IList`最多。

```
Class General
    Private list As List(Of String) 

    Public Overridable Function GetPrivateList() As IList
        Return list
    End Function
End Class

Class Specific 
    Inherits General
    Private list As List(Of Integer)
End Class 
```

或者，您可以将基类定义为采用列表项类型的泛型类：

```
Class General(Of T)
    Private list As List(Of T) 

    Public Overridable Function GetPrivateList() As List(Of T)
        Return list
    End Function
End Class

Class Specific 
    Inherits General(Of Integer)
End Class 
```

# python - 根据进程启动时间戳在 Plone 中生成缓存破坏键

> ID：12475627
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:08.463
> 
> 标签：python, plone

我正在导出在 Web 服务器进程启动期间读取和生成的数据。此数据的生命周期是 Web 服务器进程运行的持续时间（或者：您需要重新启动 Web 服务器才能离线输入任何新数据）。

我想在指向数据下载视图的 HTML 链接中添加一个缓存破坏参数。实际上，它应该是一个唯一的随机数，具体取决于进程启动时间戳或类似的进程唯一参数。

通常在 Plone 或 Python 进程中获取进程启动时间戳或类似唯一标识符的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:56:49.207

为什么不在你的 python 产品中生成一个新的 ID？在模块级别，在模块加载时定义一个新的随机常数：

```
import random

RANDOMID = random.randit(0, 1<<32) 
```

并使用它。

# html - 如果客户端不支持 html 时事通讯中的符号，有没有办法显示 alt 符号

> ID：12475628
> 
> 赞同：2
> 
> 时间：2012-09-18T10:58:12.117
> 
> 标签：html, user-interface, outlook, symbols, newsletter

我是 UI 和 HTML 时事通讯的新手

我遇到了一个问题。我必须在 HTML 时事通讯 ( `&#8377;`) 中显示一个卢比符号。但并非所有邮件客户端，尤其是 Outlook 2007 都支持 unicode 标准 6.0。`&#8360;`如果不支持，有没有办法显示 Rs ( ) 而不是以前的。（简而言之，一种查找符号是否（支持）显示的方法。如果没有，则显示一个 alt 符号）

我无法使用图片

提前致谢

编辑：

我刚刚找到了在[网站上显示印度货币符号](https://stackoverflow.com/questions/3598085/displaying-the-indian-currency-symbol-on-a-website)的快速解决方法。利用~~र~~而不是₹虽然不准确，但它有效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:24:39.463

仅使用 HTML，您无法检测用户代理/操作系统并选择要显示的内容。您将需要 JavaScript。

`navigator`使用对象检测客户端浏览器的示例

```
<script type="text/javascript">
if (/A_Specific_Agent_Name[\/\s](\d+\.\d+)/.test(navigator.userAgent))
    document.write("Your browser/mail client can display &#8377;")
else
    document.write(Your browser/mail client can display Rs")
</script> 
```

更多细节[在这里](http://www.w3schools.com/jsref/obj_navigator.asp)和[这里](http://www.w3schools.com/js/js_browser.asp)。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:24:50.757

它（卢比符号）不是出现在 UTF 中吗？还是你的客户不支持UTF？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:41:49.503

不知道 Outlook 2007 是否支持[webfonts](http://en.wikipedia.org/wiki/Web_typography#Web_fonts)，但如果支持，我建议您使用自己的字体来显示该符号。这样您就不会更改编码，只需使用带有字形的字体 for `&#8377;`。

Google 提供的一些在线免费字体：[http ://www.google.com/webfonts](http://www.google.com/webfonts)

如果您需要将所有 HTML 资源包含到邮件中，您可能知道可以为附件分配 Context-ID（它是您分配给正文部分的标头）并使用 Context-ID URL，如下所示：`<img src="cid:what_you_put_in_the_header">`

# iphone - 节点层次结构和坐标让我抓狂

> ID：12475629
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:13.300
> 
> 标签：iphone, objective-c, cocos2d-iphone

我有一个游戏层和一个名为 TestNode 的子节点 (CCNode)。我向 TestNode 添加了一个精灵表，并在这个精灵表中添加了几个“导弹”。现在我的问题是那些导弹与游戏层中的物体的碰撞检测，因为坐标似乎是错误的。

我在导弹实施中有以下几点：

```
//first I get the Game layer
GameLayer *gL = (GameLayer *)self.parent.parent.parent; 
//parent = spritesheet, spritesheet's parent = TestNode, TestNode's parent = Game layer

//Now I convert the coordinates of missile to Game Layer's node space
CGPoint realPos = [gL convertToNodeSpace:self.position]; 
```

这大致就是我在我的代码中所做的......它似乎不起作用！我对 TestNode 进行了几乎相同的碰撞检测，它似乎工作得很好。是因为精灵表吗？我现在已经挣扎了几天，但我根本无法让它工作。更改几乎没有给我任何提示我做错了什么。所以你几乎是我最后的希望......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:32:03.817

您想将导弹位置转换为世界空间：

```
CGPoint realPos = [self convertToWorldSpace:position]; 
```

如果仍然不正确，也许您更改了锚点？在这种情况下，视觉部分（纹理）将简单地从位置偏移，并且仅通过查看它可能看起来不正确。

至于 self.parent.parent.parent 等等……你应该[阅读这个答案的后半部分](https://stackoverflow.com/a/12473832/201863)。这不是一个好的做法，因为它是一个脆弱的结构，当您更改节点层次结构时很容易破坏。

# c# - 数据绑定到 C#.NET 中的文本框性能

> ID：12475630
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:14.007
> 
> 标签：c#, winforms, performance, data-binding

我在一个非常高性能的 WinForms 应用程序中工作，我从服务器获取一些数据并将这些结果显示在我的 GUI 上的文本框中。在性能方面，将这些文本框绑定到我的代码中的某些变量会更好，还是只在我的代码中包含类似 textbox1.text = data 的内容？或者是一样的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:26:40.777

当您用数据填充某些视图时，性能不是您的主要问题（通常）。

从开发和进一步维护的角度来看，绑定很方便。它们不允许您在用户编辑值后忘记将值放回数据源。此外，它们与数据验证紧密结合。事实上，高级绑定引擎（如 WPF 的引擎）使数据绑定成为在 GUI 中处理数据的唯一轻松方式。

WinForms 中的绑定引擎比 WPF 中的更简单（从它所具有的功能来看），但它仍然比`textbox1.text = data`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:24:38.993

这并不重要。重要的是您获取数据的方式。如果您有一些缓慢的操作，例如数据库查询，您可以在后台线程中执行它们，可能使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)以避免在此操作运行时冻结主 UI 线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:47:11.843

我不确定您输出的是什么，但这可能有助于考虑性能：

迭代地将数据/文本附加到文本框或字符串之类的东西（例如，在使用 textBox.Text += "message" 之类的东西记录错误消息的情况下）是一个**O(n ² )**操作，这意味着*输出越大，你会看到更戏剧性的减速*。

此外，在我迭代添加文本以输出的实验中，

```
textBox.Text += "message"; 
```

比直接附加到字符串然后执行（在迭代结束时）慢大约 3200 倍

```
textBox.Text = theString; 
```

使用

```
textBox.AppendText("message"); 
```

甚至更慢（大约 9600 次）。

# c# - 如何为此添加字符串？

> ID：12475634
> 
> 赞同：-4
> 
> 时间：2012-09-18T10:58:17.890
> 
> 标签：c#

如何在其中添加字符串：

```
public void Form1_Load(object s, EventArgs e)
{
    using (System.IO.StreamWriter sw = new System.IO.StreamWriter(System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), "maincode.txt"))) {
        sw.WriteLine("00000012{0:yyyyMMdd}{1}{0:HHmmss}", DateAndTime.Now, (new Random()).Next(0, 2) == 0 ? "0010" : "0054");
    }
} 
```

我想通过使用字符串来指定位置。有谁知道我如何添加字符串路径而不是`System.IO.Path.Combine`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:09:12.907

你的问题有点模糊，但是让我们读一读你的想法......

您尚未指定*要*添加的字符串或添加方式，但这里有一些选项，它们都围绕您的代码的这一部分：

```
 System.IO.Path.Combine(
      Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), 
      "maincode.txt") 
```

此调用`Path.Combine`将返回一个字符串，该字符串表示特殊文件夹“ApplicationData”内名为“maincode.txt”的文件的路径。

**选项 1：您希望在子目录中创建相同的文件**

由于该`Path.Combine`方法可以采用任意数量的参数，因此您只需附加子目录的名称即可：

```
System.IO.Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), 
    "SomeSubDirectory",
    "maincode.txt") 
```

**选项 2：您想`GetSpecialFolder`用硬编码路径替换零件：**

```
System.IO.Path.Combine(
    "C:\SomeHardCodedRootDir",
    "maincode.txt") 
```

**选项 3：您想用硬编码路径替换整个路径：**

现在没有理由使用`Path.Combine`

```
"C:\SomeHardCodedRootDi\maincode.txt" 
```

**选项n：我没有想到的东西**

如果以上都没有回答您的问题，您可以提供有关您要达到的目标的更多详细信息（作为副作用，这将阻止这个问题获得否决和关闭请求！！）我会尽力回答通过更新此答案来解决问题。

# php - PHP 电子邮件脚本。可能不发送电子邮件？

> ID：12475635
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:28.543
> 
> 标签：php, forms, email, validation

我的网站上有一个 PHP 电子邮件脚本，潜在客户可以用来联系我。从 Stack 得到它并稍微调整了一下（有一个蜜罐）。

**PHP代码**

```
<?php 

$robotest = $_POST['robotest']; //just testin' for robots

$recipient = "info@agoodman.com.au"; //recipient 
$email = ($_POST['email']); //senders e-mail adress 

if((filter_var($email, FILTER_VALIDATE_EMAIL)) && ($robotest == "")) { 

$Name = ($_POST['name']); //senders name 
$mail_body = ($_POST['comments']); //mail body 
$subject = "Image Consulting Inquiry"; //subject 

$header = "From: ". $Name . " <" . $email . ">\r\n"; //optional headerfields 

mail($recipient, $subject, $mail_body, $header); //mail command :) 

} else {
    print "You've entered an invalid email address!";
}
?> 
```

**表单 HTML 代码：**

```
<form name="contactform" id="contactform" method="post" action="/contact/" _lpchecked="1">
    <ul class="form-block">

      <!-- HONEYPOT -->
      <li class="on-no-robots" style="height:0px; text-indent:-9999px; font-size:0px; overflow:hidden;">
        <label>Humans Don't Submit This!! If you can see this, you don't have CSS, and you scare me. This is just here to filter out automated comments!</label>
        <input name="robotest" id="robotest" type="text" />
      </li>
      <!-- HONEYPOT -->

      <li class="third">
        <label for="name">Name</label>
        <input type="text" name="name" id="name" value="" class="required" />
      </li>
      <li class="third">
        <label for="email">Email Address</label>
        <input type="email" name="email" id="email" value="" class="required email" />
      </li>
      <li class="third">
        <label for="phone">Phone Number</label>
        <input type="text" name="phone" id="phone" value="" />
      </li>
    </ul>
    <h3>How can we help you?</h3>
    <ul class="form-block">
      <li class="full">
        <textarea name="comments" id="comments" class="required"></textarea>
      </li>
      <li>
        <input id="submitButton" type="submit" value="Talk to us" onclick="_gaq.push(['_trackEvent', 'Conversions', 'Contact', 'Contact Form']);" />
      </li>
    </ul>
</form> 
```

我也一直在表单的“提交”按钮上使用 Google Analytics 的事件跟踪，如下：

```
<input id="submitButton" type="submit" value="Talk to us" onclick="_gaq.push(['_trackEvent', 'Conversions', 'Contact', 'Contact Form']);" /> 
```

我可以测试一封电子邮件，它工作正常。然而，看看我的分析，有几天人们点击了“发送”按钮（触发分析事件）但我没有收到电子邮件。这可能是因为他们没有正确填写表格，但我不确定。我的 Gmail 垃圾邮件过滤器中没有任何内容。

有什么方法可以 (a) 与我的主机检查是否有任何未正确发送的“被困”电子邮件，以及 (b) 调整代码以使这些误报（如果它们是误报）不会t 发生？

显然，最简单的原因是人们只是为了好玩而单击“提交”按钮而没有输入任何内容，从而触发了分析事件。这些转换中的每一个都价值约 1500 美元，所以我想尽可能确定它们不是没有通过电子邮件发送给我的真正转换！

干杯，伙计们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:16:22.220

要查看任何尚未发送的“被困”电子邮件，您可能必须检查您的邮件服务器（进入您的主机）。

至于确保您的邮件功能正常工作，您总是可以在它失败时创建自己的捕获，例如：

```
if (!mail($recipient, $subject, $mail_body, $header)) 
{
   /*For when mailing fails*/
   /*Log contents somewhere*/
} 
```

也许当它失败时将日志存储在数据库中以供将来查看？您可以随时查看错误日志以获取更多线索。也许邮件服务器在那个特定时间不稳定/关闭

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:16:47.660

像这样修改你的脚本。测试一下，看看打印了什么。

```
$header = "From: ". $Name . " <" . $email . ">\r\n"; //optional headerfields 

$ret = mail($recipient, $subject, $mail_body, $header); //mail command :) 

var_dump($ret); 
```

如果您得到 0 / false 等，则您的服务器上未启用 mail()。如果您看到 true / 1 等，您的邮件很可能是垃圾邮件。如果您没有在页面上打印任何内容（或者更确切地说“您输入了无效的电子邮件地址！”打印...忽略了抱歉），这意味着它只是没有进入这个循环

```
if((filter_var($email, FILTER_VALIDATE_EMAIL)) && ($robotest == "")) { 
```

告诉我你看到了什么？

# excel - excel中的周细分数据

> ID：12475637
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:30.727
> 
> 标签：excel

我在 Excel 工作表中有一些数据，例如产品、价格和时间间隔（三个日期：产品激活、产品停用、优惠有效期）。

我必须根据周数细分数据以进行价格分析。

例如：

```
Prod1 | Prices1 | 2012/08/01 | 2012/09/08
Prod2 | Prices2 | 2012/08/14 | 2012/10/16 
```

在：

```
week 2012/07/30-2012/08/05 | Prod1 | Prices1
week 2012/08/06-2012/08/12 | Prod1 | Prices1
week 2012/08/13-2012/08/19 | Prod1 | Prices1
week 2012/08/13-2012/08/19 | Prod2 | Prices2
week 2012/08/20-2012/08/26 | Prod1 | Prices1
week 2012/08/20-2012/08/26 | Prod2 | Prices2
week 2012/08/27-2012/09/02 | Prod1 | Prices1
week 2012/08/27-2012/09/02 | Prod2 | Prices2
week 2012/09/03-2012/09/09 | Prod1 | Prices1
week 2012/09/03-2012/09/09 | Prod2 | Prices2
week 2012/09/10-2012/09/16 | Prod2 | Prices2 
```

我该如何继续？

**编辑**

我在想也许最好不要以周为基础进行推理，而是以日为基础，因为我可能会有一个重叠的日期。然后我可以在新数据上创建一个数据透视表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:56:22.060

我认为最直观的方法就是使用 VBA。

如果您像这样组织数据： ![数据图片1](../Images/9276c81561c973550b0d0c5f3b640847.png)

然后你可以运行这个宏，它会拆分出周数：

```
Sub QuestionMacro()

Dim wbk As Workbook
Set wbk = ThisWorkbook

Dim ws As Worksheet
Set ws = wbk.Sheets(1)

Dim cell As Range
Dim DataRange As Range

Dim RowIndex As Range

Set DataRange = ws.Range("A1:D10000")

    For Each RowIndex In DataRange.Rows

        If RowIndex.Cells(1, 5).Value < RowIndex.Cells(1, 6).Value Then
            RowIndex.EntireRow.Copy
            RowIndex.EntireRow.Insert
            RowIndex.Cells(1, 5).Value = RowIndex.Cells(1, 5).Value + 1
        End If

    Next RowIndex

End Sub 
```

你应该得到这样的东西： ![宏结果之后](../Images/37e06eae7f75f2b64b0471bc6007a4d8.png)

然后您可以使用拆分出来的周数、vlookup 和这样的表格来检索适当的实际日期：

![日期VlookupTable](../Images/10cbd89205756139b22a95348da0de44.png)

Jook 的回复中提到的周数公式是：

```
=WEEKNUM(C2,2) 
```

等等

这是带有标题的开始数据（您必须删除它才能使宏正常工作： ![以标题开始数据](../Images/02bb9e7aed7c8535d0d13b7bd15a411a.png)

这可能是解决您的问题的一种过于复杂和混乱的方法，但它会解决您的问题。

你应该可以很容易地得到这样的东西： ![最后结果](../Images/d44082fa014fddd74722e03f9b6db11a.png)

如果您需要有关如何使用 VLookup 的更多信息，请告诉我。祝你好运。

**编辑：**

如果您想每天获取价格和产品（我个人更喜欢），您可以像这样调整上述宏（假设您的日期是实际数字）：

```
Sub QuestionMacroPerDayBasis()

Dim wbk As Workbook
Set wbk = ThisWorkbook

Dim ws As Worksheet
Set ws = wbk.Sheets(1)

Dim cell As Range
Dim DataRange As Range

Dim RowIndex As Range

Set DataRange = ws.Range("A1:D10000")

For Each RowIndex In DataRange.Rows

    If RowIndex.Cells(1, 3).Value < RowIndex.Cells(1, 4).Value Then
        RowIndex.EntireRow.Copy
        RowIndex.EntireRow.Insert
        RowIndex.Cells(1, 3).Value = RowIndex.Cells(1, 3).Value + 1
    End If

Next RowIndex

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:49:12.880

为您的数据添加一个新列：

```
WEEKNUM(A1,2) 
```

或德语：

```
KALENDERWOCHE(A1;2) 
```

A1 是日期，2 是从星期一开始的一周

现在您可以使用 VLOOKUP 或过滤器来选择您的数据。

这也被问到这里：

[如何将日期转换为周数](https://stackoverflow.com/questions/5002152/how-to-convert-date-to-week-number)

*编辑：*

有一点误解 - 我正在努力改进......

好的，再看看这个，它有点复杂，因为你想从你的小数据集派生到一个更大的数据集。您最终会得到一个产品的多行，以及一周的多行。

我仍然认为 WEEKNUM 在这里会有所帮助......如果我发现更多，我会重新编辑。

*编辑*

有了这个，您可以粘贴从特定日期开始的周范围。

```
C21=Date

G21=C$21+(ROW($G21)-ROW(G$21))*14

H21=G21+7 
```

这应该完成其余的工作，但是您必须找出标准部分的正确格式 - 可以使用 ">=D1" 或类似的东西 - 就像在条件格式中一样。

```
F21=SUMIFS(B:B,C:C,G21) 
```

此处价格将在列 B 中，日期开始将在 C 中，并将与 G21 中的给定日期进行比较。我最初的想法是：

```
F21=SUMIFS(B:B,C:C,">=G21",D:D,"<=H21",A:A,"="Product1"") 
```

但正如我所说，标准中有一些错误。希望你明白你的想法。

# c# - 用于 C# 的 Dictionary.KeyCollection 的数据结构

> ID：12475639
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:40.837
> 
> 标签：c#, performance, data-structures, dictionary, hashset

我想保存一个在搜索特定元素时表现良好的字符串列表。如以下备忘单中所述，Dictionary 最适合此类操作：[http](http://courses.essex.ac.uk/ce/ce318/www/documents/references/cSharpDataStructuresCheatSheet.pdf) ://courses.essex.ac.uk/ce/ce318/www/documents/references/cSharpDataStructuresCheatSheet.pdf 但是，我不需要字典，因为我只存储字符串，而不是键值对（即我只对键感兴趣）。有谁知道字典用于其键的数据结构？KeyCollection 似乎只对 Dictionary 可用。我的猜测是它使用了某种散列算法，但想知道是否有人对此有任何见解？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:00:14.937

你可以使用一个`HashSet<string>`.

# java - 如何通过ajax jquery设置di v标签的属性值

> ID：12475643
> 
> 赞同：0
> 
> 时间：2012-09-18T10:58:48.173
> 
> 标签：java, ajax, jquery

我想设置属性“数据评级”的值。它将使用 Ajax。

```
<div id="fixed_<s:property value="messageId"/>" **data-rating=**"<%=averageScore%>"></div> from ajax function though jquery that is as below :

`

$.ajax({
type : "POST",
cache:false,
url : '<s:url action="ratingStatus"/>',
dataType: "text",
data : 'score=' +score+'&messageId='+<s:property value="messageId"/>+'&categoryId='+<s:property value="categoryId"/>+'&threadId='+<s:property value="threadId"/>,
success : function(data) {
alert("inside Success...");

//here i want to set div attribute(data-rating) value from action class response that i have made...

//location.reload();

}
});` 
```

如果有人可以请帮助我....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T11:21:35.580

```
$("#fieldId").attr("data-rating","value want to set"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:02:38.897

```
$('#objectID').attr('data-rating', 'your value') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T11:03:46.150

在你的成功函数内部

```
success : function(data) {

 $('#yourdivid').attr('data-rating','value from the response');
} 
```

# excel - 本地化 excel 服务器报告

> ID：12475647
> 
> 赞同：0
> 
> 时间：2012-09-18T10:59:07.453
> 
> 标签：excel, localization

有没有办法生成可以针对不同语言进行本地化的 excel 服务报告。我发现这在 SSRS 中是可能的（[请参阅此处](http://www.codeproject.com/Articles/294636/Localizing-SQL-Server-Reporting-Services-Reports)），但找不到任何关于 excel 或 exel 服务的真正确认。

我发现了关于 excel 报告模板的奇怪评论（[请参阅此处](http://technet.microsoft.com/en-us/library/ee513084.aspx)），但找不到任何有关如何实施的指南。

我的基本要求是有一个我在 excel 中为 excel 服务创建的报告，并且能够使我使用的任何标签本地化为用户区域设置的语言

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T14:31:52.820

我认为这个问题的答案是无法完成，您需要为每种语言提供重复的报告。

# ios - RestKit - 找不到 keyPath 的对象映射：''

> ID：12475650
> 
> 赞同：3
> 
> 时间：2012-09-18T10:59:18.387
> 
> 标签：ios, restkit

以下代码会产生此错误。

```
- (void)viewDidLoad
{
  RKObjectManager * manager = [RKObjectManager objectManagerWithBaseURLString:@"http://localhost:3000"];
  RKObjectMapping *contactMapping = [RKObjectMapping mappingForClass:[Contact class]];
  [contactMapping mapKeyPathsToAttributes:
      @"nom", @"nom",
      @"prenom", @"prenom",
      @"telephone", @"telephone",
      @"commentaires", @"description",
      nil];
  [manager.mappingProvider setMapping:contactMapping forKeyPath:@"/contacts.json"];
  [manager loadObjectsAtResourcePath:@"/contacts.json" delegate:self];
} 
```

我不知道如何将资源路径与映射匹配。任何的想法 ？

日志是：

```
2012-09-18 11:07:30.811 MyApp[28507:fb03] I restkit:RKLog.m:33 RestKit initialized...
2012-09-18 11:07:30.816 MyApp[28507:fb03] mapping : <RKObjectMappingProvider: 0x6c1c860>
2012-09-18 11:07:30.837 MyApp[28507:fb03] I restkit.network.reachability:RKReachabilityObserver.m:391 Network availability has been determined for reachability observer <RKReachabilityObserver: 0x6c51e60 host=localhost isReachabilityDetermined=YES isMonitoringLocalWiFi=NO reachabilityFlags=-R -----l->
2012-09-18 11:07:30.886 MyApp[28507:fb03] I restkit.network:RKRequest.m:680 Updating cache date for request <RKObjectLoader: 0x6c54ec0> to 2012-09-18 11:07:30 +0000
2012-09-18 11:07:30.892 MyApp[28507:11503] W restkit.object_mapping:RKObjectMapper.m:87 Adding mapping error: Could not find an object mapping for keyPath: ''
2012-09-18 11:07:30.893 MyApp[28507:11503] E restkit.network:RKObjectLoader.m:231 Encountered errors during mapping: Could not find an object mapping for keyPath: ''
2012-09-18 11:07:30.914 MyApp[28507:fb03] Error : [didFailWithError] 
```

json 响应如下（它来自 Ruby on Rails Rest API）：

```
[
  {"commentaires":"bla bla",
   "created_at":"2012-09-17T21:15:55Z","id":1,
   "nom":"name 1",
   "prenom":"surname A",
   "telephone":"+33687330913",
   "updated_at":"2012-09-17T21:22:34Z"},

  {"commentaires":"bla bla",
   "created_at":"2012-09-17T21:22:20Z","id":2,
   "nom":"name 2",
   "prenom":"surname 2",
   "telephone":"",
   "updated_at":"2012-09-17T21:22:20Z"}
] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:08:20.617

KeyPath 不是你的 json 文件的名字，而是 RestKit 的起点：

```
{
    "contact": {
        "nom": "whatever nom is",
        "prenom": "same for prenom",
        // ...
    }
    // ...
} 
```

在这种情况下，“联系人”将是您的 keyPath： `[manager.mappingProvider setMapping:contactMapping forKeyPath:@"contact"];`

# linux - git push 可以使用空的 repo 路径吗？

> ID：12475655
> 
> 赞同：0
> 
> 时间：2012-09-18T10:59:42.217
> 
> 标签：linux, git

我创建了一个用户名 git。这是密码文件：

```
git:x:1001:1001:git:/home/git/test.git:/bin/bash 
```

然后创建了一个名为“test.git”的裸仓库。完整路径是“/home/git/test.git”。

如果我像下面那样添加遥控器，它将起作用：

```
git add remote origin git@abc.com:./ 
```

但我想知道下面是否可行？我需要在 git 中添加一些设置吗？

```
git add remote origin git@abc.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:13:29.007

目前尚不清楚您为什么要按照您的建议设置服务器 - 这当然不正常。

## git 作为 bash 用户是不安全的

如果您将 git 配置保留在问题中，那么您仅依靠信任，任何以 git 身份访问的人都不会执行以下操作：

```
ssh git@abc.com
cd ..
ls -la // have a look
rm -rf test.git // delete git repo
cd / // go have a hack around
etc. 
```

## 以正常方式进行

设置一个 git 服务器[很容易](http://git-scm.com/book/en/Git-on-the-Server-Setting-Up-the-Server)——几乎是微不足道的。

如果你更新你的`passwd`文件，它看起来像这样：

```
git:x:1001:1001::/home/git:/usr/bin/git-shell 
```

那么用户 git 除了执行 git 命令外，什么也做不了。

因此，你会这样做：

```
git add remote origin git@abc.com:test.git
git pull // etc 
```

## git shell 是安全的

对于将 git-shell 作为登录 shell 的用户，这些都不起作用：

```
ssh git@abc.com

git remote add another git@abc.com:another.git
git push another // attempting to create a new repo

etc. 
```

它让您做的唯一一件事就是有效地拉动并推送到遥控器。

# java - 绑定不匹配泛型

> ID：12475656
> 
> 赞同：1
> 
> 时间：2012-09-18T10:59:43.113
> 
> 标签：java, generics

我有以下类层次结构。

**头等舱**

```
class First<T> {
} 
```

**二等舱**

```
class Second<T> extends First<T> {

} 
```

**三等舱**

```
class Third<T extends First<T>> {
} 
```

**错误行：**

```
Third<Second<String>> name = new Third<Second<String>>();//Compilation error 
```

`Bound mismatch: The type Second<String> is not a valid substitute for the bounded parameter <T extends First<T>> of the type Third<T>`

我真的对上述错误感到困惑。你能解释一下为什么会出现这个编译错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:07:13.267

`T extends First<T>`与 不同`Second<String>`，因为 T 既绑定到扩展的对象，也绑定到`String`扩展的对象`First<T>`。

我感觉你想在第三个中使用不同的参数，做类似的事情

```
class Third<T extends First<?>> {
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:54:12.590

Augusto 走在正确的轨道上，但为了避免使用通配符`?`，您可以向您的类添加另一个类型参数`Third`：

```
class Third<U, T extends First<U>> {
    // ...
}

Third<String, Second<String>> name = new Third<>(); 
```

缺点是您必须`String`在类型参数中提及两次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:42:06.767

您的作业中的混淆是`T`in `Second`is`String`但`T`in `Third`is `Second<String>`。因此，为了使分配有效，`Second<String>`应该扩展`First<Second<String>>`. 但情况并非如此`Second<String>`extends `First<String>`。以下代码按预期编译：

```
public class Test {

   static class First<T> {
   }

   static class Second<T> extends First<Second<T>> {
   }

   static class Third<T extends First<T>> {
   }

   public static void main(String... args) {
      Third<Second<String>> name = new Third<Second<String>>();
   }
} 
```

# c# - 从主函数回调

> ID：12475660
> 
> 赞同：3
> 
> 时间：2012-09-18T10:59:49.183
> 
> 标签：c#

下面是我在 c# 中的代码...

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

class Program
{
    static void Main(string[] args)
    {
        TestPointer test = new TestPointer();
        test.function1(function2);   // Error here: The name 'function2' does not exist in     current context
    }
}

class TestPointer
{
    private delegate void fPointer(); // point to every functions that it has void as return value and with no input parameter 
    public void function1(fPointer ftr)
    {
        fPointer point = new fPointer(ftr);
        point();
    }

    public void function2()
    {
        Console.WriteLine("Bla");
    }
} 
```

如何通过在主函数中传递函数引用来调用回调函数？...我是 C# 新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:02:15.623

`test.function1(test.function2)`应该这样做。

你还需要

```
public delegate void fPointer(); 
```

代替

```
private delegate void fPointer(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:04:32.467

你可以用一个动作来做到这一点：

```
class Program
    {
        static void Main(string[] args)
        {
            TestPointer test = new TestPointer();
            test.function1(() => test.function2());   // Error here: The name 'function2' does not exist in     current context

            Console.ReadLine();
        }
    }

    class TestPointer
    {
        private delegate void fPointer(); // point to every functions that it has void as return value and with no input parameter 
        public void function1(Action ftr)
        {
            ftr();
        }

        public void function2()
        {
            Console.WriteLine("Bla");
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T11:16:56.147

您的代码有两个问题：

```
 TestPointer test = new TestPointer();
    test.function1(function2); 
```

在这里，范围内没有调用变量`function2`。你想要做的是这样称呼它：

```
 test.function1(test.function2); 
```

`test.function2`实际上是一个[方法组](https://stackoverflow.com/questions/886822/what-is-a-method-group-in-c)，在这种情况下，编译器会将其转换为委托。进入下一个问题：

```
private delegate void fPointer(); 
public void function1(fPointer ftr) 
```

您将委托声明为私有。它应该是公开的。委托是一种[特殊的类型](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.110%29.aspx)，但它仍然是一种类型（您可以声明 'em 的变量，这正是您在声明参数时所做的`function1`）。当声明为私有时，该类型在类外部不可见`TestPointer`，因此不能用作公共方法的参数。

最后，这并不是真正的错误，但可以简化调用委托的方式：

```
 ftr(); 
```

所以这里是你更正的代码：

```
using System;

class Program
{
    static void Main(string[] args)
    {
        TestPointer test = new TestPointer();
        test.function1(test.function2);   
    }
}

class TestPointer
{
    public delegate void fPointer(); 
    public void function1(fPointer ftr)
    {
        ftr();
    }

    public void function2()
    {
        Console.WriteLine("Bla");
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T11:02:49.520

你需要做`function2` `static`或通过`text.function2`。

# cakephp - 我如何在cakephp的下拉菜单中设置选择

> ID：12475661
> 
> 赞同：0
> 
> 时间：2012-09-18T10:59:51.637
> 
> 标签：cakephp, dropdownbox

这是我使用的下拉代码：

```
$task_id = 2;
    $inr = 0;
                        $arr = array();
                        foreach ($options as $option){
                            $inr = $option['Employee']['employee_id'];
                            $arr[$inr] = $option['Employee']['first_name'].' '.$option['Employee']['last_name'];
                        }
                        echo $this->Form->input('assigned_to',      array(  'options' => array( $arr), 
                                                                    'empty' => '(choose one)',
                                                                    'div'=>'formfield',
                                                                    'label' => 'Assigned To',
                                                                    'error' => array(   'wrap' => 'div',
                                                                                        'class' => 'formerror'
                                                                                    )
                                                            )); 
```

它以正确的值显示在`$options`.

但我需要使用 cakephp 代码选择一个选项值。

我怎样才能做到这一点？

那就是我有一个值为：

`$task_id = 2;`

那么我怎样才能选择这个选项值呢？

如果有可能 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:17:10.353

你的意思是默认值？要么`default`在表单输入元素的属性中使用键，要么使用控制器的更简洁的方法：

```
/* inside add/edit actions */
if (!empty($this->request->data)) {
    $this->Country->create();
    if ($this->Country->save($this->data)) {
        ...
    } else {
        ...
    }
} else {
    /* Now here you can put your default values */
    $this->request->data['Country']['active'] = 1;
    $this->request->data['Country']['lat'] = 0.0;
    ...
} 
```

@[参见 http://www.dereuromark.de/2010/06/23/working-with-forms/](http://www.dereuromark.de/2010/06/23/working-with-forms/)

# perl - 将字符串附加到从第二个开始的每一行

> ID：12475665
> 
> 赞同：0
> 
> 时间：2012-09-18T11:00:15.453
> 
> 标签：perl, append, lines

我有一个如图所示的文件

```
 ford
    speed ....
    hyundai
    speed ...
    ferrari
    speed ....
    BMW
    Merc
    lambo
    speed ... 
```

我想在从第 2 行开始的每一行中搜索“速度”，如果没有找到，我想附加“速度\n”。即我希望我的输出是

```
 ford
        speed ....
        hyundai
        speed ...
        ferrari
        speed ....
        BMW
        speed
        Merc
        speed
        lambo
        speed ... 
```

是否有任何可用于上述问题的oneliner，例如用于附加到每一行的oneliner，例如

```
perl -ple 's/^/speed/' filename 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:52:54.793

```
perl -plne 'if($.%2==0){unless(/speed/) {print "speed";$.++;}}' your_file 
```

测试：

```
> cat temp
ford
speed ....
hyundai
speed ...
ferrari
speed ....
BMW
Merc
lambo
speed ...
> perl -plne 'if($.%2==0){unless(/speed/) {print "speed";$.++;}}' temp
ford
speed ....
hyundai
speed ...
ferrari
speed ....
BMW
speed
Merc
speed
lambo
speed ...
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T12:44:10.897

在这种情况下我会坚持`perl -pe`，但是当两者都需要输出额外的“速度”行时：

*   已打印奇数行
*   当前一个不是/speed/

所以... ($odd = (到目前为止**打印的行数) % 2)**

```
perl -pe 'next if ($odd ^= 1 or /^\s*speed/); print "speed\n"; $odd ^= 1; ' 
```

**更新：**由于 -n/-p 的工作方式，文件中的最后一行未正确处理。所以我为此添加了一个 END 块。“如果我们停在奇数行，请追加速度”。

```
perl -ple 'chomp; next if ($odd ^= 1 or /^speed/); print "speed"; $odd ^= 1; END { print "speed" if $odd }' 
```

虽然它现在是一个半线而不是一个线=）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T13:50:49.427

这是另一个想法：

```
perl -ne 'print "speed\n" if ( $v = !m/^\s*speed\b/ and $no_speed ); print; $no_speed = $v' 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-18T11:14:19.107

行号在`$.`

因此，如果您需要在一行中的每一行执行一些操作，您可以执行以下操作：

```
perl -ple 's/^/speed/ if $. % 2 == 0' filename 
```

将 % 运算符直接的结果解释为布尔值，这可以简化为：

```
perl -ple 's/^/speed// if !($. % 2)' filename 
```

阅读[perlvar 手册页](http://perldoc.perl.org/perlvar.html#Variables-related-to-filehandles)以获取关于`$.`

# java-ee-6 - resteasy 中@pathparam 和@QueryParam 的区别

> ID：12475677
> 
> 赞同：0
> 
> 时间：2012-09-18T11:00:50.273
> 
> 标签：java-ee-6

我是开发 Resteasy 的新人。我不知道@pathparam 和@Queryparam 之间的区别。哪个最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T15:06:14.010

@PathParam 注释将路径段的值绑定到资源方法参数。如果你 @Path("login/{zip}"), HTTP GET like `http://server:port/login/12345`, @PathParam("zip") 是 12345

@QueryParam 注释将路径段的值绑定到资源方法参数。如果你 @Path("login"), HTTP GET like `http://server:port/login?id=12345`, @QueryParam("id") 是 12345

# python - 如何按名称导入自定义python包

> ID：12475678
> 
> 赞同：3
> 
> 时间：2012-09-18T11:00:49.493
> 
> 标签：python, module, python-3.x, python-module

我创建了一个名为“custom_module”的文件夹，并且该文件夹中有 __init__.py，其中包含：

```
__all__ = [
        'Submodule1',
        'Submodule2'
] 
```

从我阅读的文档中，我应该能够调用`import custom_module`并访问该包，但是这并没有发生。如何让 python 识别我的包？我正在使用 python 3.2

**更新：** 包不在 python 文件夹中。python环境如何找到它，所以我可以通过名称成功导入它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T11:06:36.537

您会混淆两个不同的概念：*包*和*模块*。

一个*模块*就是你所想的那样：一个包含类、变量等的 Python 脚本。您可以通过其文件名导入它，然后可以访问其命名空间中的变量。

*包*是在文件夹中组合在一起的模块的集合。如果文件夹包含一个名为 的文件`__init__.py`，Python 将允许您导入整个文件夹，就好像它是一个模块一样。这将运行 中的代码`__init__`，但不一定会导入文件夹中的所有模块。（这是一个深思熟虑的设计选择：包通常非常大，导入所有模块可能需要很长时间。）

默认情况下，唯一被导出（as `package.thing`）的是里面定义的变量`__init__`。如果你想`submodule`作为可用的`package.submodule`，你需要在里面导入它`__init__`。

`__all__`是一个相关的概念。简而言之，它定义了当你这样做时要导入`from package import *`的内容，因为 Python 不容易弄清楚应该是什么。你一般不需要它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-18T11:44:28.787

`sys.path`保存 Python 搜索路径。在尝试使用`import`您的模块和包之前，请将其设置为包含您的路径：

```
import sys
sys.path.insert(0, 'your_path_here')
import custom_module 
```

[Python 文档](http://docs.python.org/library/sys.html#sys.path)和此[问题](https://stackoverflow.com/questions/10955024/how-is-the-python-module-search-path-determined-on-mac-os-x)中的更多详细信息

# android - 媒体播放器中的错 误（1，-4）

> ID：12475679
> 
> 赞同：0
> 
> 时间：2012-09-18T11:00:54.953
> 
> 标签：android, android-intent

我想使用 Intent 播放视频和音频文件。媒体文件放置在包位置（file:///data/data/....）。

播放视频：

```
Intent i = new Intent(Intent.ACTION_VIEW);
i.setDataAndType(Uri.parse(url), "video/*");        
this.startActivity(i); 
```

播放音频：

```
Intent i = new Intent(Intent.ACTION_VIEW);
i.setDataAndType(Uri.parse(url), "audio/mp3");
this.startActivity(i); 
```

但是将错误显示为“ **Error(1,-4)** ”。如何清除这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:28:54.393

确保您的视频文件具有`MODE_WORLD_READABLE`权限，以便媒体播放器可以访问它

> [http://developer.android.com/reference/android/content/Context.html#MODE_WORLD_READABLE](http://developer.android.com/reference/android/content/Context.html#MODE_WORLD_READABLE)

您可以尝试使用以下意图播放视频和音频：

```
File videoFile2Play = new File("pathtofile");
Intent i = new Intent(Intent.ACTION_VIEW);
i.setDataAndType(Uri.fromFile(videoFile2Play), "video/*");
startActivity(i); 
```

# jpa - 为当前日期创建查询匹配

> ID：12475680
> 
> 赞同：13
> 
> 时间：2012-09-18T11:00:55.157
> 
> 标签：jpa, spring-data, spring-data-jpa

> **可能重复：**
> [在 JPA 查询中使用 CURRENT_DATE 的示例](https://stackoverflow.com/questions/1637323/example-of-using-current-date-in-jpa-query)

我正在尝试向我的存储库添加一个查询，以将存储在数据库中的日期与当前日期进行比较。

我的查询是这样的：

```
@Query("Select c from Customer c where c.terminated != 1 or c.terminationDate > <currentDate>")
public List<Customer> getTerminatedCustomers(); 
```

我可以插入`<currentDate>`什么？

如果一切都失败了，我可以向该方法添加一个参数并将当前日期传递给这样的查询。但如果可能的话，我更喜欢更优雅的解决方案。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-19T12:10:28.337

这个问题实际上是这个问题的[副本](https://stackoverflow.com/questions/1637323/example-of-using-current-date-in-jpa-query)。根据 Java Persistence API 规范第 4.6.17.2.3 节，有预定义的函数`CURRENT_DATE`和. 所以查询必须定义为`CURRENT_TIME``CURRENT_TIMESTAMP`

```
 select c from Customer c where c.terminated != 1 or c.terminationDate > CURRENT_DATE 
```

# c# - 无法将用户控件动态添加到面板

> ID：12475683
> 
> 赞同：1
> 
> 时间：2012-09-18T11:00:58.427
> 
> 标签：c#, winforms, user-controls, panel, dynamically-generated

我有以下用于桌面应用程序的 c# 代码。`Panel1`它通过获取数据库函数返回的值来动态添加控件。

```
private void loadData()
        {
            string[] names = dops.get_lstMed(textBox2.Text); //fetching values from database
            MediRow[] mr = new MediRow[names.Length]; //User control array
            panel1.Controls.Clear();
            for (int i = 0; i < names.Length; i++)
            {
                mr[i] = new MediRow();
                mr[i].MedName = names[i];
                mr[i].AvailQty = dops.get_Med_qty(names[i]).ToString();
                mr[i].Quantity = "0";
                panel1.Controls.Add(mr[i]);
            }

        } 
```

当我调试它时，数据库函数返回的值`dops.get_lstMed()`是正确的，甚至循环也在正常工作。但问题是即使数据库有多行，面板中也只添加了一个控件。请告诉我代码有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:12:07.337

@ChrisSinclair 可能是对的：尝试设置`mr[i].Dock = DockStyle.Top;`填充控件属性的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:07:49.493

也许这段代码正在工作，但似乎不起作用，因为您在同一位置创建它们，并且您必须更改要添加的控件的**Location属性。**

至少乍一看是我能看到的解决方案。

# mysql - 按条件编号行

> ID：12475684
> 
> 赞同：-1
> 
> 时间：2012-09-18T11:01:01.943
> 
> 标签：mysql

我需要从表中选择行，对行进行编号：前 3 行编号为：

```
1  
2  
3

```

之后（从第四行开始），再次开始编号，第二次编号继续到所有记录的末尾，即结果必须是这样的：

```
1  
2  
3  
1  
2  
3  
4  
5  
……  
……  
777

```

我写了这个查询，但这会返回通常的编号，从 1 到最后一条记录。

请有人告诉我，我的查询在哪里逻辑错误？在我看来，这将返回麻木，正如我上面所写

```
mysql-> SET @n = 0
mysql-> SET @start_again = 'true'

SELECT 

        CASE 
            WHEN  @n = 3 AND @start_again = 'true' THEN  @n := 1
            ELSE @n := @n + 1
        END,

        CASE 
            WHEN  @n = 3 AND @start_again = 'true' THEN  @start_again := 'false'
        END

FROM mytable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:07:16.753

你的任务过于复杂了。

```
SET @n = 0
SELECT if((@n := @n + 1) > 3, @n - 3, @n) AS n ... 
```

# haskell - 集合可以在函数签名声明中“打开”吗？

> ID：12475690
> 
> 赞同：2
> 
> 时间：2012-09-18T11:01:17.883
> 
> 标签：haskell, types, functional-programming, language-comparisons

`T`可以用 Haskell 或其他函数式语言正式定义以下类型吗？

类型`T`包含函数，给定来自 的对象*集合*（即一组） ，为该*集合中的每个对象*`X`分配一个数字。

 *例如，假设我们有一个函数`t`from `T`。它的参数`arg`必须是来自 的对象的集合（集合）`X`，例如字符串列表 ['abc', 'def', 'xyz']。它的返回值必须是一个`r`只接受三个可能参数的函数：`'abc'`、`'def'`或`'xyz'`，并返回一个数字。在这种情况下，我特别不想`r`接受任何字符串作为参数。

一个例子可能是“等级函数”，它给定一组对象，以某种方式为每个对象分配一个等级。它不只返回一组数字；相反，它返回一个函数，该函数采用原始集合的任何成员，并返回该成员的等级。

当然，如果我稍微改变一下我的要求，事情就会变得超级简单。我可以要求该函数`t`只接受一组对象并返回一组数字。这差不多，但不完全相同。这样的定义需要一些额外的工作：我必须将输入集合中的对象与输出集合中的对象进行匹配。而且它也不会那么精确：返回的数字集合可能与输入对象不匹配（例如，一个数字可能太多）。

如果我所描述的约束不能表达为类型约束，我不会感到惊讶，并且应该以不同的方式强制执行。

编辑：我最初还要求定义一个类型，该类型`U`包含将函数从`X`数字转换为数字的函数，并返回 type 的函数`T`。但我没有很好地解释这一点，它只会给我的问题增加困惑。所以最好忽略我问题的这一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:13:09.183

编辑：*鉴于问题的更新，我已经完全重写了这个答案。*

暂时忽略对类型的强调并采取实用的方法，让我们开始在 Haskell 中构建此功能。首先，这是一个函数，给定一个函数、一个对象列表和一个对象，如果该对象在列表中，则将该函数应用于该对象。

```
u f list x = assert (x `elem` list) $ f x 
```

（assert 函数来自`Control.Exception`）这也可以通过一个守卫来实现：

```
u f list x | (x `elem` list) = f x --similar but gives a slightly different error msg 
```

在 ghci 中运行一些示例会得到以下结果：

```
*Main> u (+1) [1,2,3] 1
2
*Main> u (+1) [1,2,3] 2
3
*Main> u (+1) [1,2,3] 3
4
*Main> u (+1) [1,2,3] 4
*** Exception: test.hs:3:14-19: Assertion failed 
```

但是，这不是非常安全的代码，因为没有静态保证不会以这种方式调用函数而导致崩溃。

另一种方法是使用`Maybe`类型。

```
u' f list x = if elem x list then Just (f x) else Nothing 
```

它具有以下行为：

```
*Main> u' (+1) [1,2,3] 2
Just 3
*Main> u' (+1) [1,2,3] 3
Just 4
*Main> u' (+1) [1,2,3] 4
Nothing 
```

这仍然不能静态地保证不会以不正确的方式调用函数，但它确实静态地保证基于返回值的任何结果必须同时处理`Just result`和`Nothing`。这也带来`Maybe`了 monad 的优势，可以将其视为可能失败的计算。所以你可以像这样轻松地链接调用

```
*Main> let func = u' (+1) [1,2,3]
*Main> func 1
Just 2
*Main> func 1 >>= func
Just 3
*Main> func 1 >>= func >>= func
Just 4
*Main> func 1 >>= func >>= func >>= func
Nothing 
```

这似乎是在 Haskell 中解决此类问题的最佳实用方法。但是，问题询问是否有一种*类型*专门确定这样的功能。让我们看看这些函数的类型：

```
u  :: Eq x => (x -> a) -> [x] -> x -> a
u' :: Eq x => (x -> a) -> [x] -> x -> Maybe a 
```

这两种类型都不要求列表的成员资格使它们工作与否。我能想到的将其作为一种类型工作的唯一方法是将集合本身​​视为一种类型。调用那个类型`col`，然后我们可以做

```
u :: (col -> x) -> col -> x 
```

但这不仅没有什么实用价值，而且也没有精确地确定这些功能。基于对的方法也没有。根据我的经验，尝试构建高度限制性的类型（例如仅包含 in 值的类型`['abc', 'def', 'xyz']`）并不是很实用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:55:01.047

## T - 标记

好的，我想重命名您的类型以帮助理解它们。`T`将数字分配给值，并且由于我不确定容器的结构是什么（并且希望保持灵活），因此我将在 pair 中弹出值和数字`(x,n)`。让我们称之为标记，所以 rename `T` `Tagger`，所以假设我知道你的集合类型是s`Coll`的集合，所以我需要`X``Coll X`

```
type CollTaggerXInt = Coll X -> Coll (X,Int) 
```

这使您想要的功能成为类型同义词。

但是，如果`Int`太小而您想使用`Integer`，或`Double`其他数字类型怎么办？

```
data Num n => CollTaggerX n = CollTaggerX (Coll X -> Coll (X,n)) 
```

这意味着您可以`X`使用任何固定类型的数值数据来标记值。（`Num n =>`是断言 n 必须是数字类型的数据类型约束。）右侧的 CollTaggerX 通过将标记函数包装在轻量级构造函数中来确保类型安全。我们需要使用`data`，而不是`type`因为我已经参数化了`n`.

我倾向于用类型参数（如某些语言中的泛型，例如 Java）替换固定类型`X`和集合类型`Coll`，以提高代码重用：

```
data (Functor coll,Num n) => Tagger coll x n = Tgr (coll x -> coll (x,n)) 
```

因此，现在我们坚持认为`coll`ction 类型是 Functor，因此我们可以使用`fmap`将函数逐点应用于集合（在您的情况下至关重要，任何集合类型都将是 Functor 的实例）。

我对`Tagger`for your 的定义最满意`T`，但`CollTaggerXInt`如果您只有一种可能性，您可以使用`coll`,`x`和`n`。

## U - 制作标签

您的`U`类型是将元素标记器转换为集合标记器。我想称之为`Lift`ing，而不是`U`. 如果您正在使用`CollTaggerXInt`，则可以再次使用类型同义词：

```
type LiftXIntToTagger = (X -> Int) -> Coll X -> Coll (X,Int) 
```

或者如果您使用更灵活的`Tagger`定义，您可以编写

```
data (Functor coll,Num n) => Lifter coll x n = Lifter ((x -> n) -> coll x -> coll (x,n)) 
```

但这一切都让人觉得为此创建一个类型很疯狂，因为如果你有一个逐点函数，你可以使用它来提升它无论如何`fmap`都适用于你的类型：`coll`

```
fmap :: Functor f => (a -> b) -> f a -> f b 
```

所以我们可以将它与`coll`as `f`、`x`as`a`和`(x,n)`as b 一起使用，并定义

```
liftT :: (Functor coll,Num n) => (x -> n) -> coll x -> coll (x,n)
liftT f = fmap tag   where 
      tag x = (x,f x) 
```

如果你想定义你的类型，好的，但我认为`liftT`这可能是你的 type 中唯一合理的函数`U`。

## 排名 - U+上下文

现在我认为您的排名示例很有用，因此让我们对此进行调查。rankfunction 需要检查集合的*所有*元素，所以让我们给它整个集合作为它的第一个参数，所以`rankfunction :: coll x -> x -> n`（在 ​​context 中`(Functor coll,Num n)`）。

```
liftInContext :: (Functor coll,Num n) => (coll x -> x -> n) -> coll x -> coll (x,n)
liftInContext rankfunction mycoll = liftT (rankfunction mycoll) mycoll 
```

在这里，该函数`(rankfunction mycoll)`将其第一个参数——整个集合——传递给 rankfunction，然后使用 liftT 将其应用于每个元素。这称为部分评估，对于这类事情非常方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T19:31:00.513

如果你想要一个接受一个值并返回一个类型（除其他外）的函数，你将需要依赖类型。您可以在 Haskell 中[模拟依赖类型](http://www.cis.upenn.edu/~eir/papers/2012/singletons/paper.pdf)，但它并不漂亮。*

# ruby-on-rails - ajax向数据库添加信息

> ID：12475697
> 
> 赞同：0
> 
> 时间：2012-09-18T11:01:45.870
> 
> 标签：ruby-on-rails, jquery, activerecord

我对整个 ruby​​ on rails 的东西还是很陌生，虽然我读过你可以轻松地执行 ajax 请求。我想要做的是在数据库表中添加一个新行，并从中传递一些变量。

我目前拥有的是

```
%li= link_to image_tag('trans.gif', :border => 0, :size => '16x16', :class => 'i-16-tick'), availabilities_path(:team_id => schedule.team_id, :user_id => current_user, :schedule_id => schedule.id), :remote => true, :method => :post, :title => 'Accept', :rel => 'tooltip-html' 
```

控制器代码

`# POST /availabilities # POST /availabilities.json def create @availability = Availability.new(params[:availability])

```
respond_to do |format|
  if @availability.save
    format.html { redirect_to @availability, :notice => 'Availability was successfully created.' }
    format.json { render :json => @availability, :status => :created, :location => @availability }
  else
    format.html { render :action => "new" }
    format.json { render :json => @availability.errors, :status => :unprocessable_entity }
  end
end 
```

结束`

虽然它如何知道要传递给数据库的变量？

这就是目前正在发生的事情

`Processing by AvailabilitiesController#create as HTML Parameters: {"schedule_id"=>"18", "team_id"=>"1", "user_id"=>"38"} User Load (1.6ms) SELECT "users".* FROM "users" WHERE "users"."id" = 38 LIMIT 1 (0.4ms) BEGIN SQL (20.1ms) INSERT INTO "availabilities" ("available", "created_at", "schedule_id", "team_id", "updated_at", "user_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id" [["available", nil], ["created_at", Tue, 18 Sep 2012 23:07:26 EST +10:00], ["schedule_id", nil], ["team_id", nil], ["updated_at", Tue, 18 Sep 2012 23:07:26 EST +10:00], ["user_id", nil]] (10.5ms) COMMIT`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:50:26.077

如果您想向服务器传递多个变量，请将它们包含在 http 请求中。对于 AJAX 请求和常规请求都是如此。例如：

```
<%= link_to 'Send data', accept_availabilty( player, :my_variable => value1, :my_variable => value2), :remote => true %> 
```

通常，虽然提交更复杂，但您会希望使用远程表单，而不仅仅是一个简单的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:55:49.617

如果您想将信息传递给您的 Rails 应用程序，您需要将

```
:remote => true 
```

到 form_for 标签上，然后您的控制器将能够将这些参数传递给您的模型。

# drupal - 如何以编程方式将类名添加到drupal中的视图字段？

> ID：12475699
> 
> 赞同：1
> 
> 时间：2012-09-18T11:02:07.953
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-views

我正在开发一个 drupal 网站，我正在使用视图模块来创建一个块。我将视图显示为字段。在我的自定义模块中，如果另一个字段的值为 0，我想将类名添加到一个视图的字段中。

这个怎么做？

**编辑***

我找到了解决我的问题的方法。请看下面我的回答。我没有将其标记为已接受，因为它实际上没有回答我最初的问题如何以*编程方式添加类名。*我仍然有兴趣知道如何以编程方式进行操作，所以如果有人对我有好的答案，我会将其标记为已接受。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T06:08:28.020

我找到了解决我的问题的方法。该解决方案不需要编码或自定义模块，只能通过视图设置来完成。

首先，我从显示中排除了我想要类名的字段。然后我覆盖的另一个字段是这样的：`<div id="field1">[field1]</div><div id="field2">[field2]</div>`.

我还在 field2 为空时覆盖了它，并检查了 0 也将被视为空的设置。在覆盖中，我添加了类名：`<div id="field1" class="something">[field1]</div><div id="field2">[field2]</div>`

现在当 field2 为 0 时，它将被覆盖，并显示带有类名的 field1。

# android - 滑动时更改列表视图行背景颜色

> ID：12475703
> 
> 赞同：1
> 
> 时间：2012-09-18T11:02:15.663
> 
> 标签：android, listview, swipe, swipe-gesture, motionevent

我需要实现这样的功能。用户向左滑动列表视图的项目并打开另一个活动。当用户开始向左滑动时，listview 项目的背景颜色应该是绿色，当他完成滑动时，新的 Activity 应该打开并且项目的背景颜色应该变成白色。

我有 SwipeDetector 类来检测我的滑动事件：

```
public class SwipeDetector implements View.OnTouchListener {

    public static enum Action {
        LR, // Left to Right
        RL, // Right to Left
        TB, // Top to bottom
        BT, // Bottom to Top
        Start,
        Stop,
        None // when no action was detected
    }

    private static final String logTag = "SwipeDetector";
    private static final int MIN_DISTANCE = 100;
    private static final float HORIZONTAL_MIN_DISTANCE = 5;
    private static final float VERTICAL_MIN_DISTANCE = 100;
    private float downX, downY, upX, upY ,  stopX, stopY;
    private Action mSwipeDetected = Action.None;

    public boolean swipeDetected() {
        return mSwipeDetected != Action.None;
    }

    public Action getAction() {
        return mSwipeDetected;
    }

    public boolean onTouch(View v, MotionEvent event) {
        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN: {
            downX = event.getX();
            downY = event.getY();
            mSwipeDetected = Action.Start;
            return false; // allow other events like Click to be processed
        }
        case MotionEvent.ACTION_MOVE: {
            upX = event.getX();
            upY = event.getY();

            float deltaX = downX - upX;
            float deltaY = downY - upY;

            // horizontal swipe detection
                    if (Math.abs(deltaX) > HORIZONTAL_MIN_DISTANCE) {
                        // left or right
                        if (deltaX <= 0) {
                            Log.i(logTag, "Swipe Left to Right");
                            mSwipeDetected = Action.LR;
                            return true;
                        }
                        if (deltaX > 0) { 
                            Log.i(logTag, "Swipe Right to Left");
                            mSwipeDetected = Action.RL;
                            return true;
                        }
                    } else 

                    // vertical swipe detection
                    if (Math.abs(deltaY) > VERTICAL_MIN_DISTANCE) 
                    {
                        // top or down
                        if (deltaY < 0) {
                            Log.i(logTag, "Swipe Top to Bottom");
                            mSwipeDetected = Action.TB;
                            return false;
                        }
                        if (deltaY > 0) 
                        {
                            Log.i(logTag, "Swipe Bottom to Top");
                            mSwipeDetected = Action.BT;
                            return false;
                        }
                    } 
                    Log.i("delta X", Float.toString(deltaX));
                    return true;
        }
        case MotionEvent.ACTION_UP:
        {

             stopX = event.getX();
             stopY = event.getY();
             float stopValue = upX-stopX;

             Log.i("StopX value",Float.toString(stopValue));
                 Log.i("StopX value",Float.toString(stopX));
                 Log.i("DownX value",Float.toString(downX));
                 Log.i("UpX value",Float.toString(upX));
               //
                 mSwipeDetected = Action.None;
             return false;
        }

        }
        return false;
    }
} 
```

以及我如何在我的活动中使用它：

```
listView1.setOnItemClickListener(new OnItemClickListener() {
          public void onItemClick(AdapterView<?> parent, View view, int position, long id)
          {
                  if (swipeDetector.getAction()== swipeDetector.getAction().LR)
                  {
                      Log.i("start value", "it might be started");
                      view.setBackgroundColor(Color.GREEN);
                     Log.i("Swipe Action", getAction().toString());
                     Object listItem = listView1.getItemAtPosition(position);
                     Intent i = new Intent(getApplicationContext(),
                             InteractionsActivity.class);
                     startActivity(i);

                  } 
                  else if(!swipeDetector.swipeDetected())
                  {
                      Log.i("stop value", "it was stoped");
                        view.setBackgroundColor(Color.WHITE);
                  }
          }
      }); 
```

但是当`mSwipeDetected = Action.None;`在我的 SwipeDetector `case MotionEvent.ACTION_UP:`语句中注释该行时，Activity 可以正常打开，但是当我返回 Activity 时，listview 项的背景颜色仍然是绿色，并且 `Log.i("stop value", "it was stoped");:`在我的 Activity`else if`语句中无法调用。当我取消注释时， `Log.i("stop value", "it was stoped");`可以调用它，但是列表视图项的背景颜色仍然是白色，并且新的 Activity 没有打开。我应该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:05:28.090

当您打开活动时，不要使用 ，`startActivity`而是使用`startActivityForResult`。这意味着您将能够检测到其他活动何时完成以及用户何时返回此活动。然后您可以将颜色设置回白色。

看看这里是如何工作的：[http ://www.vogella.com/articles/AndroidIntent/article.html#usingintents_sub](http://www.vogella.com/articles/AndroidIntent/article.html#usingintents_sub)

# css - 切换填充会导致不寻常的布局更改

> ID：12475705
> 
> 赞同：1
> 
> 时间：2012-09-18T11:02:24.050
> 
> 标签：css

我目前正在网站[http://www.lovepotatoes.ovh3.microserveltd.co.uk/](http://www.lovepotatoes.ovh3.microserveltd.co.uk/)上工作，这个问题与具有下拉菜单和 3 个文本字段的食谱搜索块有关。

在 Firefox 中它显示得很好，而在其他浏览器中，第二个文本输入的位置很奇怪。我注意到在 Firebug 中，如果我在文本标签中打开和关闭填充，那么 Firefox 也会表现出这种行为。

我需要做些什么来解决这个问题并获得 2 行的流畅布局？任何解释为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:15:09.690

如果您将其添加到`style="clear:left;"`成分**2**输入中，它应该可以工作。 `div`

 **```
<div class="form-item form-type-textfield form-item-field-ingredients-value-1"
style="clear:left;">
 <input type="text" class="form-text" maxlength="128" size="60" value=""
name="field_ingredients_value_1" id="edit-field-ingredients-value-1"
title="Ingredients 2" style="color: rgb(170, 170, 170);">
</div> 
```**

# java - 如何读取 file.properties

> ID：12475707
> 
> 赞同：-2
> 
> 时间：2012-09-18T11:02:34.720
> 
> 标签：java, properties

我有一个项目组织了这个：

```
-LIBRERIA CLIENT/
   -SRC/
     -CONNECTION/
      CONNECTIONdB.JAVA
      CONFIG.PROPERTIES 
```

在`CONNECETIONDB`我有这个代码来读取`CONFIG.PROPERTIES`文件：

```
public static void connect() throws RemoteException
{
        //read file config.properties:
        String dbHost="",dbUser="",dbPassword="";
        Properties prop=new Properties();
        try
        {
            //load il file:
            prop.load(new FileInputStream("src/Connectionconfig.properties"));
            //read the property of file
            dbHost=prop.getProperty("host");
            dbUser=prop.getProperty("user");
            dbPassword=prop.getProperty("password");
        }catch(FileNotFoundException fe){
            System.out.println("File not found");
        }catch(IOException ex){
            System.out.println("Error reading configuration file");
        } 
```

但我有这个错误：

```
 FILE NOT FOUND 
```

有人能告诉我我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:08:38.517

这很简单：您的代码在 project_root 的不同文件夹中执行。此外：`src/Connectionconfig.properties`不存在：应该是`SRC/CONNECTION/CONFIG.PROPERTIES`，如果您从 project_root 执行项目。
还要查看这个以获取当前工作目录：[Getting the Current Working Directory in Java](https://stackoverflow.com/questions/4871051/getting-the-current-working-directory-in-java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:30:28.457

您的代码读取`Connectionconfig.properties`文件下`src`但根据您的项目结构仅存`CONFIG.PROPERTIES`在于`SRC/CONNECTION`. 改成

```
 prop.load(new FileInputStream("SRC/CONNECTION/CONFIG.PROPERTIES")); 
```

代替

```
 prop.load(new FileInputStream("src/Connectionconfig.properties")); 
```

# php - 如何在网页的一部分中创建可搜索的数据库？

> ID：12475710
> 
> 赞同：0
> 
> 时间：2012-09-18T11:02:45.970
> 
> 标签：php, database

我正在尝试创建一个目录，站点用户可以搜索该目录以查找产品和商店。但是，我希望目录可以通过网页的一部分浏览，而无需每次都重新加载或更改页面，因为有导航栏和其他内容我想保留在页面上，并且因为重新加载太慢且不合时宜。

必要的组件： 1\. 我希望目录可以通过搜索栏或通过单击目录“框架”内显示的预定义类别进行浏览。2\. 我希望能够通过目录外部但在同一页面上的窗格将过滤器应用于结果。

所以假设我有类别：

健康之家金融等

显示在“框架”中。

我怎样才能做到这一点，以便用户可以单击其中一个类别，并且该类别的数据库搜索结果将填充在该空间中，这些结果将被过滤到也可以单击的其他子类别中？

所以基本上我想要在网页的一部分内进行数据库导航。

我怎么能不使用 iframe 做到这一点？阿贾克斯什么的？

我觉得有一个非常简单的方法，但我对 Web 开发还不够熟悉，还不知道......

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:17:31.270

您所描述的是使 ajax 像今天一样流行的经典问题之一。您可以处理此问题的一种方法是制作一个 php 脚本，该脚本在调用时会生成网站的一部分，您只需将其放置在您想要的任何位置。另一种方法是返回数据（JSON 是事实上的标准）并在浏览器中使用 javascript 呈现它。如果您想要更具体的内容，您需要向我们提供正在发生的事情的代码示例。

继续阅读：[W3](http://www.w3schools.com/ajax/ajax_intro.asp "W3学校") , [tutsplus - ajax](http://net.tutsplus.com/tag/ajax "tutsplus")

您可能想在[DataTables](http://datatables.net "数据表 jQuery 插件")源代码中四处寻找，因为此脚本包含您之前提到的所有内容：php、js、ajax、db

附带说明：ajax 以比 (i)frames 更漂亮的方式处理内容更改，我总是建议远离它们。

# javascript - 减少包含多个 javascripts 的成本

> ID：12475712
> 
> 赞同：1
> 
> 时间：2012-09-18T11:02:53.207
> 
> 标签：javascript, backbone.js, http-get

我使用backbone.js 开发了一个应用程序，所以我创建了多个模型和多个视图。最初我在一个文件中创建它们，但经过进一步阅读，我知道最好将模型分开，视图分开，所有路由器分开。我只是想知道，如果我们这样做，我们将增加 HTTP Get 请求的数量（每个 javascript 文件一个）所以这种做法会导致一些额外的成本。

问：我们怎样才能降低这个成本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:06:36.910

看看require.js

[http://requirejs.org/](http://requirejs.org/)

和本教程

[http://backbonetutorials.com/organizing-backbone-using-modules/](http://backbonetutorials.com/organizing-backbone-using-modules/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T05:45:45.327

我刚刚在网上冲浪时遇到了这个问题，发现这是我自己的问题。如果我现在回答这个问题，那就是：

将模型、视图、路由器等保存在单独的文件中，但始终合并它们，然后在 HTML 代码中包含合并文件的链接。

你可以使用一些`runtime JS minifier`就像在这个博客[Minify JS runtime in PHP中提到的一样](http://verens.com/2008/05/20/efficient-js-minification-using-php/)

还有其他可用的在线工具。

# logging - 像 Enterprise library 5 Logging TraceManager 这样的 redgate ant profiler 工具

> ID：12475714
> 
> 赞同：0
> 
> 时间：2012-09-18T11:02:54.610
> 
> 标签：logging, instrumentation, enterprise-library-5, red-gate-ants

是否可以使用像企业库日志记录/仪器这样的 Ants 分析器仪器组件 API？我想在最终用户的机器上检测我的应用程序的某些部分。我还希望它是可配置的，这样它就不会一直启动。

简而言之，我不想使用 antsprofiler，而是想在我的应用程序中使用 ants-profiler 库。因为无法在最终用户的机器上部署和使用 ant profiler。然后我可以从最终用户机器收集转储并解释以了解漏洞。

如果您做过类似的事情，请分享您的经验。

Redgate 站点参考 - [http://www.red-gate.com/supportcenter/content/knowledgebase/ANTS_Performance_Profiler/KB200708000092](http://www.red-gate.com/supportcenter/content/knowledgebase/ANTS_Performance_Profiler/KB200708000092)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:52:39.733

ANTS Performance Profiler 不具有用于本地部署或作为另一个程序集的一部分的受支持 API，因此恐怕您将无法以上述方式使用其库。

出于好奇，您想以这种方式分析的应用程序类型是什么？桌面、网络、服务？

# cocos2d-iphone - 我的游戏的声音（英语语音）资产

> ID：12475717
> 
> 赞同：0
> 
> 时间：2012-09-18T11:03:05.543
> 
> 标签：cocos2d-iphone, 2d-games

我正在为孩子们开发一个相当简单的游戏，但它需要有适当的英语配音。有谁知道我在哪里可以得到一个？我想应该有公司可以收费制作这样的录音，但我没有用谷歌搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:15:35.867

我的游戏声音设计总是来自 Canners Mediaproductions。那是一家荷兰公司，位于阿姆斯特丹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:08:00.067

尝试用谷歌搜索“声音设计”工作室。这些公司提供与声音、语音和音乐相关的广泛服务。

祝你好运

# google-apps-script - 按下按钮时，我需要获取复选框的输入值（真/假）

> ID：12475718
> 
> 赞同：0
> 
> 时间：2012-09-18T11:03:05.203
> 
> 标签：google-apps-script

我想用.setName（chk_id）获取复选框的输入值（真/假），当id是我在flexTable单元格中引入的行的id时。但我总是得到 "e.parameter_"undefined"" 因为 e.parameter.chk_i 是**"undefined"**

```
var flexTableReg = app.createFlexTable().setId("flexTableReg").setBorderWidth(1);
var check = new Array(lastRow);

for(var r = 0; r < lastRow; r++){
  for(var c = 0; c < lastCol; c++){
    var text = rowsToConfirm[r][c].toString();//HERE IS THE CELL
    flexTableReg.setText(r+1, c, text);

  }
  var id = rowsToConfirm[r][0];
  check[r] = app.createCheckBox().setName("chk_"+id).setId("chk_"+id);
  flexTableReg.setWidget(r+1, lastCol, check[r]);
}//end fors
}//end if

 var botMod = app.createButton().setText("Activar").setId("botStatus");
 var botHandle =  app.createServerHandler("changeStatus").addCallbackElement(verticalPanelAdmin);
 botMod.addClickHandler(botHandle);

mainPanelAdmin.add(flexTableReg);
mainPanelAdmin.add(botMod);
verticalPanelAdmin.add(mainPanelAdmin);
absolutePanelAdmin.add(verticalPanelAdmin);
app.add(absolutePanelAdmin);

return app;
}

function changeStatus(e){
  var ss = SpreadsheetApp.openById(LOGS_SHEET_ID);
  var app = UiApp.getActiveApplication();
  var datarray = getDataArray();
  var lastRow = ss.getLastRow();

  for(var i =0; i<=lastRow;i++ ){
    try{
      var par =  e.parameter["chk_"+i];

      if(true){
        stop_if_true
        var row = getRowByID(0,lastRow,i);
         ss.getRange("E"+i).setValue("1");
      }//end if     
    }catch(e){e.parameter_"undefined"  //if e.parameter "undefined"
          return app;}
}//end for
 return app;
 }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T18:52:59.780

我不知道`var id = rowsToConfirm[r][0];`返回的是什么，但这就是您在设置 .setName() 和 .setId() 属性时用作原始 id 参数的内容。

当您尝试获取回调函数中的值时，您使用数字`i`参数，这样可能会发生冲突。

其次，复选框的返回值始终是一个字符串，因此请检查`'true'`or`'false'`而不是`true`or `false`。

希望这可以帮助，

问候。

# google-analytics - 可以使用 Google Analytics 跟踪使用 UiService 的 Google Apps Script Web App 吗？

> ID：12475719
> 
> 赞同：2
> 
> 时间：2012-09-18T11:03:06.803
> 
> 标签：google-analytics, google-apps-script

是否有可能使用 UiApp 作为用户界面将有效的 Google Analytics 跟踪器插入到 Web 应用程序中？

这将为应用程序所有者提供深入的使用统计信息。

我能想到的唯一可能的替代方法是将对 Web 应用程序的每次访问（包括用户 ID）存储在 ScriptDb 中，从数据隐私角度来看是有问题的，并且不提供有关用户的基本信息，例如位置、语言或设备。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T02:33:49.693

是的，这是完全可行的，我为此有一个内部库。这个概念是你从谷歌分析服务器 Urlfetch 一个 gif 并通过查询字符串传递数据。这是工作代码和测试。Google Analytics 文档参考是内联的：

编辑：我已将以下内容打包为名为 GASAnalytics 的库，并将项目密钥“MvzvykyEXRZJoG1Gjj2h1JnHAGDwXQ1CH”添加到此处的更多 Google Apps 脚本库列表中：[https ://docs.google.com/spreadsheet/ccc?key=0AhDqyd_bUCmvdGxjNUpGZkFKcmxsekE3VHNWMEh4amc#gid= 0](https://docs.google.com/spreadsheet/ccc?key=0AhDqyd_bUCmvdGxjNUpGZkFKcmxsekE3VHNWMEh4amc#gid=0)

```
/**
* hits Google Analytics with a "path" you want to track as a pageview 
* e.g. track("UA-ABC123-4", "/track/my/event")
*/
function track(propertyId, path) {
  //ref https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting#gifParameters
  //https://developers.google.com/analytics/devguides/collection/other/mobileWebsites

   var utmGifLocation = "http://www.google-analytics.com/__utm.gif";

    // Construct the gif hit url.
    var utmUrl = utmGifLocation + "?" +
    "utmwv=4.4sa" +
    //"&utmcn=1"+ //added - extra - not required
    "&utmn=" +  (new Date().getTime())+ //unique - cache buster
    "&utmhn=" + 'example.com' +
    "&utmr=" + '-' +
    "&utmp=" + encodeURIComponent(path) + 
    "&utmac=" + propertyId +
    "&utmcc=__utma%3D999.999.999.999.999.1%3B" +
    "&utmvid=" + Math.random() +
    "&utmip=" + '-';

  Logger.log("Fetching " + utmUrl);
  var test = UrlFetchApp.fetch(utmUrl);
  return;
}

function testTrack() {
  // confirm in GA > Realtime (immediate) or Standard Reports > Content > Content drilldown (after 2 hours)
  track("UA-heyuseyourown:/!", "/track1/my1/test1"); 
} 
```

让我们知道你的进展。

# windows-phone-7 - WP7 创建类似于市场的截图库

> ID：12475720
> 
> 赞同：0
> 
> 时间：2012-09-18T11:03:14.573
> 
> 标签：windows-phone-7, xaml

我正在尝试创建一个类似于市场上的屏幕截图库的图片库。我尝试使用枢轴来执行此操作，但存在三个问题：

1.  你真的必须弄乱边距才能让每个图像全屏
2.  枢轴循环，我希望它停在最后一张图片上
3.  图像没有“缝合”在一起以及图像之间，页面背景显示

如果您不确定我想要什么，请在市场中查找和应用。

干杯!

# c++ - Haskell FFI：与简单的 C++ 接口？

> ID：12475726
> 
> 赞同：7
> 
> 时间：2012-09-18T11:03:32.233
> 
> 标签：c++, haskell, ffi

从我目前所读到的内容来看，将 FFI 与 C++ 一起使用是非常困难的。最大的原因之一似乎是将 C++ 对象转换为 Haskell。我现在的问题是我对 C 没有任何经验，但是有几年的 C++ 经验，而且我更喜欢 OOP。因此，我自然希望从 C++ 中受益。

那么我可以编写设计用于 Haskell FFI 的 C++ 程序来解决这些问题吗？C++ 可以在后台做任何事情，但 API 将类似于 C，即我没有交换对象，没有重载的顶级函数等等。有什么陷阱需要注意吗？

（将我的项目与您可能熟悉的项目进行比较：考虑使用 SciPy 的 Weave 来加速 Python 代码。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-18T12:34:37.300

是的，如果您在 C++ 代码之上公开 C API，则可以通过 FFI 使用 C++ 代码。

一种常见的模式是将一个类的所有“方法”简单地包装为 C 过程，这样该类的对象可以被视为可以应用这些函数的不透明指针。

例如，给定代码 ( `foo.h`)：

```
class foo
{
public:
  foo(int a) : _a(a) {}
  ~foo() { _a = 0; } // Not really necessary, just an example

  int get_a() { return _a; }
  void set_a(int a) { _a = a; }

private:
  int _a;
} 
```

...您可以轻松创建所有这些方法的 C 版本 ( `foo_c.h`)：

```
#ifdef __cplusplus
typedef foo *foo_ptr;
extern "C"
{
#else
typedef void *foo_ptr;
#endif

foo_ptr foo_ctor(int a);
void foo_dtor(foo_ptr self);

int foo_get_a(foo_ptr self);
void foo_set_a(foo_ptr self, int a);
#ifdef __cplusplus
} /* extern "C" */
#endif 
```

那么，肯定有一些通过C++接口（`foo_c.cpp`）实现C接口的适配器代码：

```
#include "foo.h"
#include "foo_c.h"

foo_ptr foo_ctor(int a) { return new foo(a); }
void foo_dtor(foo_ptr self) { delete self; }

int foo_get_a(foo_ptr self) { return self->get_a(); }
void foo_set_a(foo_ptr self, int a) { self->set_a(a); } 
```

`foo_c.h`现在可以将标头包含在 Haskell FFI 定义中。

# html - 动态复选框未正确更新

> ID：12475728
> 
> 赞同：0
> 
> 时间：2012-09-18T11:03:38.880
> 
> 标签：html, coldfusion, coldfusion-9

我有这样生成的动态复选框

```
 <cfset counter = 0>
     <form name="setPermissions" class="setPermissions" action="" method="post">
     <cfoutput>
          <cfloop query="getUserAccess">
              <input name="Meetings_#Counter#" type="checkbox" />
              <cfset counter = counter + 1>
          </cfloop>
      </cfoutput>
      </form> 
```

`getUserAccess`查询有 6 行，这意味着将输出其中的 6 个复选框。

要分别阅读这些并更新表，我正在运行以下查询

```
<cfloop from="0" to="#getUserAccess.RecordCount#" index="i">
   <cfquery datasource="#Request.dsn#">
        UPDATE table SET 
            <cfif structKeyExists(FORM, 'Meetings_#i#')>
            Meetings = <cfif FORM['Meetings_#i#'] EQ "on">1,<cfelse>0,</cfif>
            </cfif>
        WHERE ID = '#an_ID_that_is_specified#'
   </cfquery>
</cfloop> 
```

抱歉，如果这段代码不正确，当我在我的页面上运行它时它可以工作，但是生成了大约 20 个这样的复选框，所以我剪掉了我的代码，所以你只能看到一个。

现在，这段代码工作得很好，当我选中一个框并提交表单时，这段代码将更新数据库以将值设置为 1。

唯一的问题是，当我取消选中该框时，它不会将值更改为 0。这就是我卡住的地方。当没有`on`指定为表单值时，为什么不将值更改为 0？

我已经做了一个`<cfdump>`看看是否还有任何东西通过，但没有。

勾选所有框后，我得到了这个转储

```
MEETINGS_0   on
MEETINGS_1   on
MEETINGS_2   on
MEETINGS_3   on
MEETINGS_4   on
MEETINGS_5   on 
```

有一些打勾，我没有打勾的没有出现。

但是，该值仍未从 1 更新为 0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:15:30.237

复选框在未选中时根本不会提交任何值（这就是它的工作原理）。所以你的查询应该更接近这个：

```
UPDATE table SET 
    Meetings = <cfif structKeyExists(FORM, 'Meetings_#i#')>1,<cfelse>0,</cfif>
WHERE ID = '#an_ID_that_is_specified#' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T17:05:09.903

Sergii 已经回答了最初的问题。但只是为了抛出另一种方法......

您也可以使用列表。假设您的 id 是数字，则为所有复选框指定相同的名称并将原始 id 存储在隐藏字段中。

```
 <cfoutput query="getUserAccess">
        #meetingID# 
        <input name="SelectedMeetings" type="checkbox" value="#meetingID#" />
    </cfoutput>
    <cfoutput>
        <input name="OriginalMeetings" type="hidden" value="#valueList(getUserAccess.meetingID)#" />
    </cfoutput> 
```

在操作页面`FORM.SelectedMeetings`上将包含所有已选择 ID 的列表。只需将两个列表的差异找出“取消选择”的 ID。

```
 <cfparam name="FORM.SelectedMeetings" default="" / >
    <cfset FORM.DeSelectedMeetings = replaceList( FORM.OriginalMeetings
                                                 , FORM.SelectedMeetings
                                                 , "") /> 
```

然后你只需要两个查询来更新数据库而不是六个（或者你有多少复选框）。显然，无论您选择哪种方法，您都应该将所有查询包装在一个事务中，以确保它们一起成功或失败。

```
<cfif listLen(trim(FORM.selectedMeetings))>
   <cfquery datasource="#Request.dsn#">
        UPDATE table 
        SET    Meetings  = 1
        WHERE  ID IN ( 
             <cfqueryparam value="#FORM.selectedMeetings#" list="true" cfsqltype="cf_sql_integer"> 
        )
   </cfquery>
</cfif>

<cfif listLen(trim(FORM.DeSelectedMeetings))>
   <cfquery datasource="#Request.dsn#">
        UPDATE table 
        SET    Meetings  = 0
        WHERE  ID IN ( 
             <cfqueryparam value="#FORM.DeSelectedMeetings#" list="true" cfsqltype="cf_sql_integer"> 
        )
   </cfquery>
</cfif> 
```

# javascript - 如何在 Metro 风格应用中实现滑动页面过渡

> ID：12475730
> 
> 赞同：5
> 
> 时间：2012-09-18T11:03:43.063
> 
> 标签：javascript, html, windows-8, microsoft-metro

[我想在Metro Style App](http://msdn.microsoft.com/en-US/windows/apps/)中实现带有幻灯片样式的页面转换。

效果看起来

```
 state 1                     state 2                   state 3
 ____________              _______________             ____________  
|            |            |       |       |           |            |
|   page A   |    ====>   |page A |page B |   ====>   |   page B   |
|            |            |partial|partial|           |            |
|____________|            |_______|_______|           |____________| 
```

它将通过从右向左滑动的平移手势触发（没有触发系统工具栏，我不知道如何隔离它们）。

我玩过[exitPage/enterPage](http://msdn.microsoft.com/en-us/library/windows/apps/br229780.aspx)但没有运气：似乎页面 A 在页面 B 进入之前就消失了。
我还阅读了[单页导航](http://msdn.microsoft.com/en-us/library/windows/apps/hh452768.aspx)、[片段加载的](http://code.msdn.microsoft.com/windowsapps/Fragments-91f66b07#content)代码[示例和滚动/平移的代码示例](http://code.msdn.microsoft.com/windowsapps/Scrolling-panning-and-47d70d4c)并考虑一下将当前页面和新页面放入 div 包装器中，并将它们滑动到 div 中，无需调用`navigate()`。但这可能会破坏CSS位置，我不知道什么时候可以安全地调用新页面的JS......

*更新 1*也许[FlipView](http://msdn.microsoft.com/en-US/library/windows/apps/br211711.aspx)可以做到这一点？

*更新 2*以找到将本地页面加载到的方式`FlipView`，找到了有用的链接，但仍然感到困惑......

*   [`innerHTML`带内部`Template`用于外部 RSS 提要的FlipView](http://blogs.microsoft.co.il/blogs/shair/archive/2012/04/08/windows-8-javascript-flipview-control.aspx)
*   [绑定 iframe w/`ListView`](http://social.msdn.microsoft.com/Forums/ta/winappswithhtml5/thread/4948f9be-c87a-4650-8023-c2a26a2382a2)
*   [带有 HTMLControl 内容的 ListView](https://stackoverflow.com/questions/12239619/data-bind-failing-for-custom-htmlcontrol-inside-itemtemplate-of-listview)

*更新 3*通过完全定义页面并渲染其中一个FlipView.itemTemplate制定了一个原始版本的`FlipView`用法，这合适吗？`PageControl``PageControl`

那么，有什么合适的解决方案或好主意吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:49:30.157

您绝对可以为此使用 FlipView，但老实说，我不知道这在 HTML 端是如何工作的。在 Xaml 方面，您可以将“页面”实现为用户控件而不是实际页面，然后将它们托管在 FlipView 中。如果您有很多“页面”以及与这些“页面”关联的数据，这可能会占用大量资源。

在 Xaml 端，每个真实页面（从 Page 继承）都显示在 Frame 中。Frame 一次只能显示一页。这就是为什么您会在动画完成之前看到第一页消失的原因。

如果您不希望用户能够在多个虚拟页面之间滑动，或者如果资源变得过于密集，您可能不想使用 FlipView。相反，您可以使用两个 ContentPresenter 并拥有一个动画。ContentPresenterA 和 ContentPresenterB 是并排的。动画滑动，最后将 ContentPresenterA 设置为 ContentPresenterB 的内容，然后快速回到动画的开头。它应该发生得如此之快，以至于用户不会注意到跳跃。

我将请我的同事和朋友 Ryan Joy 来这里看看他是否可以谈论如何在 HTML 方面做这些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T14:11:49.947

我用过`FlipView`这个。`WinJS.UI`里面的代码`base.js`解释了有关效果的所有内容（正如 Dominic Hopton 所提到的）。这`FlipView`对于我目前的使用来说已经足够了（尽管将来可能需要定制额外的翻转行为）。

在`FlipView`开始时一次加载所有页面，以减少过载，我

1.  延迟加载简单的占位符，`div`而不是`PageControl`首先加载/`PageControl`卸载`onpagecompleted/onpagechangedvisibility`. `FlipView`这带来了一个副作用，`PageControl.ready/unload`当页面在视口内（或隐藏）可见时触发，非常方便。
2.  通过增量加载额外的页面`itemDataSource`（也许也动态卸载？）

另外，额外`FlipView`的 s 可以在被`PageControl`包裹的内部使用`FlipView`，MSDN 没有提到这一点。

# nlp - 如何从查询中提取有意义的关键字？

> ID：12475733
> 
> 赞同：1
> 
> 时间：2012-09-18T11:03:51.017
> 
> 标签：nlp, information-retrieval

我正在做一个关于网络智能的项目，在这个项目中我必须构建一个接受用户查询并提取有意义的关键字的系统。比如说用户输入一个查询“ `How to do socket programming in Java`”，那么我必须忽略`"how", "to", "do", "in"`并采取`"socket", "programming", "java"`进一步的处理和聚类，例如套接字和编程是两个不同的有意义的关键字，但可以一起用作产生不同含义的关键字。我正在寻找一些算法`TF-IDF`来解决这个问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:25:46.080

好吧，您正在研究文本分析解决方案。

我仅将 R 用于此目的，但查看它的一种方法是您需要一个您认为没有意义的关键字的单词列表，这通常称为“停用词”。您可以找到几乎所有流行语言的停用词在线列表。完成此操作后，您可能想要获得几百个输入并计算那里每个关键字的频率（已经删除了停用词，以及标点符号并将所有文本都设为小写）并尝试识别您认为的其他关键字不相关并将它们添加到您要删除的单词列表中。

在此之后，您可以探索大量选项；一个例子是词干提取，它获取每个单词的核心术语，以便将“pages”和“page”视为相同的关键字。（随着你的深入，你会在网上找到大量的东西来微调你的方法）

希望这可以帮助。

# internet-explorer-8 - 在 IE8 开发人员工具中检查 IFRAME 中的元素有效，但具有不希望的偏移效果

> ID：12475737
> 
> 赞同：1
> 
> 时间：2012-09-18T11:04:19.300
> 
> 标签：internet-explorer-8, ie-developer-tools

假设您`iframe`的页面中有元素并且您尝试检查其内容。当您在内容文档中选择特定元素时`iframe`，IE 开发人员工具会在其周围绘制蓝​​色边框，但每次嵌套`iframe`都会增加 2 个像素的偏移量。

您可以在下图中看到一个示例，其中我手动添加了背景`html`和`body`元素，使它们在 JSFiddle 中可见。然后我在 中选择`body`了元素`iframe`，如您所见，指示器向右和向下偏移 2 个像素。

![IE8 开发工具偏移](../Images/ba1ee0fd810adf44d436cdcc4b057168.png)

如果`iframe`在这个里面有一个额外的，额外的 2 个像素将被添加到 4 个像素等。

### 是否可以在 Internet Explorer 开发人员工具中避免此选定元素指示符偏移？

> ***注意**：每次我必须使用 Internet Explorer 时，我都会在里面死去。如果我必须将它与开发人员工具一起使用，那么我生活中的大部分时间都会变成香蕉。*

# jquery - 有没有一种方法可以捆绑一组 jQuery DOM 更改以由浏览器一次性呈现？

> ID：12475748
> 
> 赞同：1
> 
> 时间：2012-09-18T11:05:28.010
> 
> 标签：jquery, browser

我正在编写一个网站并使用 jQuery。我有一个问题，我想对 DOM 做两个不同的更改。基本上，我调用`$.toggle()`了几个 div，其中一个是隐藏的，另一个是可见的。

```
<div>
    <button onclick='javascript:$(".panel").toggle()'>Toggle!</button>
    <div class="panel">Content1</div>
    <div class="panel hide">Content2</div>
</div> 
```

我遇到的问题是浏览器在每次调用`toggle()`. 这个开关是肉眼看不见的，但会导致一些奇怪的行为。

最终发生的`.panel`是找到了第一个 div，并将其切换为隐藏。然后切换第二个`.panel`div，并显示出来。在这些调用之间，浏览器检测到 DOM 更改并重新渲染页面，同时隐藏两个 div。

如果这些 div 位于页面底部，则页面会在短时间内变短，因此页面滚动位置会在第二个 div 变得可见之前向上跳跃。

以另一种方式翻转可见性不会产生相同的效果，因为现在浏览器会在隐藏第二个 div 之前短暂呈现两个 div 可见的页面。那么就没有滚动问题了。

是否有可能以某种方式对这两个操作设置某种保持或锁定，以指示浏览器在释放保持/锁定之前不要重排、滚动或以其他方式呈现页面？在这种情况下，浏览器将使用单个 .js 渲染页面`.panel`，javascript 将运行，然后浏览器将被指示重新渲染更改的 DOM。

**编辑**

我在[http://jsfiddle.net/3Kvqh/1/](http://jsfiddle.net/3Kvqh/1/)上添加了一个 JSFiddle，我的意思是简单地浏览到页面底部并点击“切换”，然后看滚动很奇怪。

进一步的测试表明，这只发生在 Chrome 中。情节变厚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:57:28.017

在更好地查看了我的另一个答案之后，我认为它第一次会起作用，但是当你第二次执行它时会失败。所以我在这里采取了不同的方法，这段代码总是可以正常工作：

```
<button onclick='javascript:hd=$(".panel:hidden");vi=$(".panel:visible");hd.toggle();vi.toggle();'>Toggle!</button> 
```

我正在利用[jquery 可见性过滤器](http://api.jquery.com/category/selectors/visibility-filter-selectors/)来始终首先切换隐藏的 div，然后再切换可见的 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:14:55.523

在切换之前尝试反转您的“.panel”组，如下所示：

```
$($(".panel").get().reverse()).toggle(); 
```

**更新**：
此解决方案仅第一次有效，但第二次失败，因此无效，请查看我的其他答案。

# android - Android 上的 Microsoft Bing 翻译 API

> ID：12475755
> 
> 赞同：1
> 
> 时间：2012-09-18T11:05:43.543
> 
> 标签：android, api, translation, bing

我正在为 android 编写翻译应用程序。因此，我获得了一个带有客户端 ID 的 Bing 帐户。我在 java 上尝试了翻译 API，它起作用了。

```
import com.memetix.mst.language.Language;
import com.memetix.mst.translate.Translate;

public class trans1 {   

  public static void main(String[] args) throws Exception {
    Translate.setClientId("hidden");
    Translate.setClientSecret("hidden");
    String translatedText = Translate.execute("spiel", Language.GERMAN, Language.FRENCH);
    System.out.println(translatedText);
  }

} 
```

现在我尝试在 Android 中像这样使用它：

```
package de.androidnewcomer;

import com.memetix.mst.language.Language;
import com.memetix.mst.translate.Translate;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;

public class SagHalloActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    Translate.setClientId("hidden");
    Translate.setClientSecret("hidden");
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    try {
        String translatedText = Translate.execute("welt", Language.GERMAN, Language.FRENCH);
        Log.i("LOG", translatedText);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
} 
```

但我得到这个错误：

```
09-18 12:53:34.001: E/AndroidRuntime(29488): FATAL EXCEPTION: main
09-18 12:53:34.001: E/AndroidRuntime(29488): java.lang.NoClassDefFoundError: com.memetix.mst.translate.Translate
09-18 12:53:34.001: E/AndroidRuntime(29488):    at de.androidnewcomer.SagHalloActivity.onCreate(SagHalloActivity.java:14)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.os.Looper.loop(Looper.java:130)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at android.app.ActivityThread.main(ActivityThread.java:3691)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at java.lang.reflect.Method.invokeNative(Native Method)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at java.lang.reflect.Method.invoke(Method.java:507)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
09-18 12:53:34.001: E/AndroidRuntime(29488):    at dalvik.system.NativeStart.main(Native Method) 
```

有谁能够帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:26:20.887

您可能需要在您的**library/lib**文件夹下包含包含包的**Jar 文件**，这应该可以解决此问题。`com.memetix.mst.language`

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T08:01:52.100

你必须将你的代码移动到一个线程

```
new Thread() {
public void run() {
    try {
            String translatedText = Translate.execute("welt", Language.GERMAN, Language.FRENCH);
            Log.i("LOG", translatedText);`enter code here`
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}.start(); 
```**

# php - 动态添加表单域并填充

> ID：12475756
> 
> 赞同：-4
> 
> 时间：2012-09-18T11:05:47.997
> 
> 标签：php, javascript, jquery, dynamic, field

我正在创建一个表单，用户可以在其中输入他们的地址历史记录，当他们登陆页面时，他们将能够输入他们的邮政编码，这将在任何地方搜索邮政编码并从结果中选择他们的地址，然后将填充以下`hidden`字段 - house_name ，address1，镇和县。

然后，他们将能够添加任意数量的其他地址，直到他们完成 5 年的地址历史记录。

是为字段提供名称数组的最佳方法，例如 postcode[]、house_name[]、address1[]、town[] 和 County[]，附加地址相同，或者给它们所有唯一名称，例如 postcode_1、house_name_1等然后是下一个地址 postcode_2、house_name_2 等？

另外，我如何从每个地方获取邮政编码值，以便在任何地方查找邮政编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:26:04.490

如果我明白你的意思，最好将它存储在二维数组中：

例如：

```
item["1056BK"]["house_name"]
item["1056BK"]["town"]
item["1056BK"]["address"]
item["1056BK"]["country"]

item["3021BX"]["house_name"]
item["3021BX"]["town"]
item["3021BX"]["address"]
item["3021BX"]["country"] 
```

这样您就可以轻松地遍历每个项目并将其放入数据库中。

PS，这将是首选：

```
item["0"]["postcode"]
item["0"]["house_name"]
item["0"]["town"]
item["0"]["address"]
item["0"]["country"]

item["1"]["postcode"]
item["1"]["house_name"]
item["1"]["town"]
item["1"]["address"]
item["1"]["country"] 
```

# javascript - XDomainRequest 在状态为 200 时未给出响应

> ID：12475764
> 
> 赞同：0
> 
> 时间：2012-09-18T11:06:31.190
> 
> 标签：javascript, ajax, request, response, xdomainrequest

XDomainRequest 在状态为 200 时未给出响应

```
var httpRequest = new XDomainRequest();
httpRequest.open('POST', url, true);
httpRequest.send(xmlDocument);
alert(httpRequest.responseText);
return httpRequest; 
```

它给出的响应文本为空。请指导我在哪里失踪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:22:06.610

尝试做：

```
var httpRequest = new XDomainRequest();
httpRequest.onload=function() {
    alert(httpRequest.responseText);
}
httpRequest.open('POST', url, true);
httpRequest.send(xmlDocument); 
```

# javascript - 使脚本随机选择单词

> ID：12475765
> 
> 赞同：0
> 
> 时间：2012-09-18T11:06:33.153
> 
> 标签：javascript, jquery

在我的拼写游戏中，我有一个从 HTML 中提取的单词列表。我可以选择每次运行程序时要拉出多少来填充网格，但问题是如果我选择从列表中取出 6 个单词，它会拉出前 6 个，而不是随机的 6 个。有人可以告诉我为什么会这样？

这是包含单词的...

```
<ul style="display:none;" id="wordlist">

    <li data-word="mum" data-audio="http://www.wav-sounds.com/cartoon/porkypig2.wav" data-pic="http://www.clker.com/cliparts/5/e/7/f/1195445022768793934Gerald_G_Lady_Face_Cartoon_1.svg.med.png"></li>

    <li data-word="cat" data-audio="http://www.wav-sounds.com/cartoon/bugsbunny2.wav" data-pic="http://www.clker.com/cliparts/c/9/9/5/119543969236915703Gerald_G_Cartoon_Cat_Face.svg.med.png"></li>

    <li data-word="dog" data-audio="http://www.wav-sounds.com/cartoon/daffyduck1.wav" data-pic="http://www.clker.com/cliparts/a/2/c/0/1195440948271207911zeimusu_spotty_dog.svg.med.png"></li>

    <li data-word="bug" data-audio="http://www.wav-sounds.com/cartoon/daffyduck2.wav" data-pic="http://www.clker.com/cliparts/4/b/4/2/1216180545881311858laurent_scarabe.svg.med.png"></li>

    <li data-word="rat" data-audio="http://www.wav-sounds.com/cartoon/bugsbunny1.wav" data-pic="http://www.clker.com/cliparts/C/j/X/e/k/D/mouse-md.png"></li>

    <li data-word="dad" data-audio="http://www.wav-sounds.com/cartoon/porkypig1.wav" data-pic="http://www.clker.com/cliparts/3/a/6/6/119544474191128182Gerald_G_Man_Face_6_-_World_Label.svg.med.png"></li>

    <li data-word="mouse" data-audio="http://www.wav-sounds.com/cartoon/bugsbunny1.wav" data-pic="http://www.clker.com/cliparts/C/j/X/e/k/D/mouse-md.png"></li>

    <li data-word="dad" data-audio="http://www.wav-sounds.com/cartoon/porkypig1.wav" data-pic="http://www.clker.com/cliparts/3/a/6/6/119544474191128182Gerald_G_Man_Face_6_-_World_Label.svg.med.png"></li>

</ul> 
```

该脚本相当长，所以这里是一个小提琴[http://jsfiddle.net/smilburn/ZAfVZ/](http://jsfiddle.net/smilburn/ZAfVZ/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T12:37:48.227

[从此](https://stackoverflow.com/questions/1764160/jquery-select-random-elements)答案为您修改了代码

```
randomElements = jQuery("#wordlist li").get().sort(function(){ 
  return Math.round(Math.random())-0.5
}).slice(0,6) 
```

# jquery - 使用多个 jHtmlArea 或 CLE 编辑器时 Textarea POST 数据丢失

> ID：12475768
> 
> 赞同：0
> 
> 时间：2012-09-18T11:06:36.457
> 
> 标签：jquery, html, forms, post, jhtmlarea

我有一个包含多个文本输入和 4 个文本区域的表单，名为：`features, description, description2, description3`

当我提交表格和 print_r($_POST); 所有值都按您的预期打印，但是当我将 jHtmlArea 或 CLE 编辑器附加到 4 个文本区域时，最后 2 个文本区域丢失了发布的数据。

```
<form method="post" action="index.php" enctype="multipart/form-data">
    <legend>Page 1</legend>
    <label>Photo</label>
    <input type="file" name="image[]" multiple id="file" style="margin-bottom:15px;"/>
    <label>Title (Property Type & Area)</label>
    <input type="text" name="page_1_area_type" class="span8"/>
    <label>Reference</label>
    <input type="text" name="reference" class="span8"/>
    <label>Bedrooms</label>
    <input type="text" name="bedrooms" class="span8"/>
    <label>Bathrooms</label>
    <input type="text" name="bathrooms" class="span8"/>
    <label>Plot Size</label>
    <input type="text" name="plot_size" class="span8"/>
    <label>Constructed Area</label>
    <input type="text" name="constructed_area" class="span8"/>
    <label>Terrace</label>
    <input type="text" name="terrace" class="span8"/>
    <label>Parking</label>
    <input type="text" name="parking" class="span8"/>
    <label>Price</label>
    <input type="text" name="price" class="span8"/>
    <label>Features</label>
    <textarea id="editor1" name="features">435</textarea>
    <label>Description</label>
    <textarea id="editor2" name="description">34534</textarea>
    <button type="button" class="btn" id="btn-step1">Page 2<i class="icon-arrow-right"></i></button>
    </div>
    <!-- END STEP 1 --> 
    <!-- STEP 2 FORM -->
    <div class="step hide" id="step2">
      <legend>Page 2</legend>
      <label>Photo</label>
      <input type="file" name="image[]" multiple id="file" style="margin-bottom:15px;"/>
      <label>Property Details</label>
      <textarea id="editor3" name="description2">4354354</textarea>
      <div style="clear:both;"></div>
      <button type="button" class="btn" id="btn-step2">Next <i class="icon-arrow-right"></i></button>
    </div>
    <!-- END STEP 2 --> 

    <!-- STEP 3 FORM -->
    <div class="step hide" id="step3">
    <legend>Page 3</legend>
    <label>Photo</label>
    <input type="file" name="image[]" multiple id="file" style="margin-bottom:15px;"/>
    <label>About Title</label>
    <input type="text" class="span8" value="About South West Mallorca" name="page_3_title"/>
    <label>About Content</label>
    <textarea id="editor4" name="description3">43534534</textarea>
    <div style="clear:both;"></div>
    <button type="submit" name="download" class="btn">Download PDF <i class="icon-arrow-right"></i></button>
  </form> 
```

Javascript

```
 $(function(){
 $("textarea").htmlarea();
 }); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:25:04.013

您将获得 2 个第一个字段值。他们的名字属性不同。

而另外两个是相同的，唯一的区别是数字

我建议使用 description[] 或完全更改字段名称。

在DP上也回答了你。

让我知道它是否有效。

# android - 覆盖 View.layout(...) 中的 VirtualMachineError

> ID：12475770
> 
> 赞同：3
> 
> 时间：2012-09-18T11:06:38.880
> 
> 标签：android, android-view, dalvik, android-2.3-gingerbread, android-inflate

Android抛出致命错误然后我膨胀了具有覆盖方法的类：

```
Class MyButton extends Button {
    ....
    @Override
    public void layout(int l, int t, int r, int b) {
        super.layout(l, t, r, b);
    }
} 
```

我是否评论我的代码都没关系。应用程序仅适用于我删除此覆盖的功能。

错误：

```
09-18 13:45:43.809: E/AndroidRuntime(13363): FATAL EXCEPTION: main
09-18 13:45:43.809: E/AndroidRuntime(13363): java.lang.VirtualMachineError
09-18 13:45:43.809: E/AndroidRuntime(13363):    at dalvik.system.DexFile.defineClass(Native Method)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at dalvik.system.DexFile.loadClassBinaryName(DexFile.java:207)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:200)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.LayoutInflater.createView(LayoutInflater.java:471)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:570)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.LayoutInflater.inflate(LayoutInflater.java:386)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.view.View.inflate(View.java:8807)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.eee.android.activities.Screen1.addSubject(Screen1.java:372)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.xxx.android.activities.Screen1.parseData(Screen1.java:348)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.xxx.android.activities.Screen1.initalizeData(Screen1.java:178)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.xxx.android.activities.Screen1.onResume(Screen1.java:139)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1150)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.Activity.performResume(Activity.java:3832)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2114)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1672)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.os.Looper.loop(Looper.java:123)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at android.app.ActivityThread.main(ActivityThread.java:3687)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at java.lang.reflect.Method.invokeNative(Native Method)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at java.lang.reflect.Method.invoke(Method.java:507)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
09-18 13:45:43.809: E/AndroidRuntime(13363):    at dalvik.system.NativeStart.main(Native Method) 
```

有任何想法吗？

**编辑：我以其他方式解决了我的问题。只是将可绘制生成代码移至其他事件。但我很有趣，如果我尝试覆盖这个方法，为什么我仍然会得到 VirtualMachineError。**

更新：如果我`MyButton`从 扩展`View`，我得到同样的错误。

更新：

我发现了其他消息：

```
09-19 09:24:43.789: W/dalvikvm(17401): Method Lcom/videoclasse/android/widgets/SubjectButton;.layout overrides final Landroid/view/View;.layout
09-19 09:24:43.789: W/dalvikvm(17401): failed creating vtable
09-19 09:24:43.789: W/dalvikvm(17401): Link of class 'Lcom/videoclasse/android/widgets/SubjectButton;' failed 
```

最后我在android 2.3.3中找到了。View.layout 被定义：

```
public final void layout(int l, int t, int r, int b) {
    boolean changed = setFrame(l, t, r, b);
    if (changed || (mPrivateFlags & LAYOUT_REQUIRED) == LAYOUT_REQUIRED) {
        if (ViewDebug.TRACE_HIERARCHY) {
            ViewDebug.trace(this, ViewDebug.HierarchyTraceType.ON_LAYOUT);
        }

        onLayout(changed, l, t, r, b);
        mPrivateFlags &= ~LAYOUT_REQUIRED;
    }
    mPrivateFlags &= ~FORCE_LAYOUT;
} 
```

对不起愚蠢的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T06:44:55.060

在安卓 2.3.3 中。`View.layout`被定义为最终的。但在 android 4.0 中，这个函数不再是最终的。我收到此错误的原因是因为我使用的是 4.0.0 构建器。

感谢@WarrenFaith 在代码中发现的错误输入，非常感谢@JesusFreke 提供了搜索更多信息的方向。

# python-2.7 - Pypy错误：RuntimeWarning：没有声明参数的C函数调用，usinc ctypes

> ID：12475774
> 
> 赞同：0
> 
> 时间：2012-09-18T11:06:44.293
> 
> 标签：python-2.7, pypy

我正在尝试使用`Pypy`，但是一旦我执行我的代码`Pypy`失败，但`cPython`可以使用。

我发现了几个关于 ctypes 和 pypy 的问题，但我无法在我的代码中找到错误：

```
libc = CDLL("libc.so.6")
ptr = c_void_p(None)
result = libc.getifaddrs(pointer(ptr))
if result:
    return None
ifa = ifaddrs.from_address(ptr.value)
result = {} 
```

代码在调用失败`libc.getifaddrs(pointer(ptr))`，返回：

`102: RuntimeWarning: C function without declared arguments called result = libc.getifaddrs(pointer(ptr))`

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T06:47:31.583

只需设置函数的参数类型，警告就会消失

无论如何都不去照顾他们被认为是不好的做法

# iphone - 使用 UIActionSheet 在 IOS 中显示通知

> ID：12475777
> 
> 赞同：0
> 
> 时间：2012-09-18T11:06:57.630
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uiactionsheet

我正在开发基于会议的应用程序。我想向用户显示来电窗口，我正在使用 UIActionSheet 来显示该通知。现在，这里的问题是呼叫可能随时来自服务器，此时我们可能在我们的应用程序中的任何视图中，如何使用 UIActionSheet 显示来电通知？我必须设置什么代表？

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] 
                              initWithTitle:msg_string
                              delegate:(id)??????????????????
                              cancelButtonTitle:@"ACCEPT" 
                              destructiveButtonTitle:@"DECLINE" 
                              otherButtonTitles: nil]; 
```

非常感谢任何建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:55:52.920

保证活着的物体；例如应用程序的委托。此外，在典型的 iOS 应用程序结构中，它具有对视图层次结构顶层的引用。-艾伦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T13:51:12.393

你应该像下面这样设置。

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] 
                              initWithTitle:msg_string
                              delegate:self
                              cancelButtonTitle:@"ACCEPT" 
                              destructiveButtonTitle:@"DECLINE" 
                              otherButtonTitles: nil]; 
```

委托是实现 UIActionSheetDelegate 方法的类。

像例如

```
@implementation ViewController

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
  {   // you code         }
@end 
```

所以 clickedButtonAtIndex 是 viewController 类中的 actionSheet 委托方法，而你的 alertView 也显示在 ViewController 类中，那么你必须设置`self`。或者如果从其他类显示的 alertView 和在 ViewController 类中编写的委托方法体，那么作为委托，您需要设置 ViewController 类的对象。

# android - 是否可以持有多个唤醒锁？

> ID：12475779
> 
> 赞同：7
> 
> 时间：2012-09-18T11:07:01.493
> 
> 标签：android, service, wakelock

我正在开发一个小型实用程序，它可以扫描二维条码，然后将每个条码提交给执行更长任务的 IntentService。

当显示活动时，它应该阻止设备休眠，直到在服务中处理条形码。如果服务完成处理，它会自行停止，但活动应该仍然可见。

我想在活动生命周期中持有一个 SCREEN_DIM_WAKE_LOCK WakeLock，但由于这种类型不会阻止 CPU 睡眠，我还需要在扫描新的二维码时在活动中获取一个 PARTIAL_WAKE_LOCK，然后释放它处理后在意图服务中。

SCREEN_DIM_WAKE_LOCK 的目的是避免用户每隔几秒钟按下电源按钮以唤醒设备并能够读取新条形码的不便。用户将不得不一个接一个地阅读大量代码，即使在没有用户交互的短时间间隔内，活动也应该存在。

我知道在 Android 中，由于我的应用程序无法控制的几种情况，无法 100% 保证应用程序处于顶部、未关闭或前台，但我想尽我所能。

那么可以持有多个WakeLocks吗？可以在哪里声明它们可以被活动和服务访问？（单例，扩展应用程序？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T11:17:05.157

可以持有多个 WakeLock。实际上，当屏幕关闭时多个应用程序同时同步时，它一直都在完成。（想象一下，当屏幕锁定时，您的 GMail 和 Facebook 应用程序同时同步。他们不知道彼此会有不同的 WakeLocks。可能是也可能不是不同类型的 WakeLocks）

Android 将确保满足每个人的期望（换句话说，最大限度地消耗电池电量。）

在我看来，我认为您过度考虑了您需要 SCREEN_DIM_WAKE_LOCK 的事实，因为这可能会意外耗尽大量电池，但根据您的用例，我可能是错误的。

所以简短的回答是肯定的。您可以持有多个 WakeLock，Android 将（应该）按预期运行。唯一要记住的是你正确地释放了两个唤醒锁。

在进入屏幕顶部的问题上，我认为你应该在你的活动进入暂停状态时释放它的唤醒锁（当另一个活动在顶部时，或者故意按下电源按钮）。因为此时用户正在与另一个应用程序交互，你应该尊重它并让它控制自己的行为。在完成之前，您不必放弃服务的部分唤醒锁定。

希望这可以帮助。

# ruby-on-rails - 双向关联

> ID：12475782
> 
> 赞同：0
> 
> 时间：2012-09-18T11:07:13.703
> 
> 标签：ruby-on-rails, activerecord

我有两个具有简单关联的模型

```
class Door 
  belongs_to :main_room, class_name: 'Room', inverse_of: :door
end 

####

class Room
  has_one :door, foreing_key: :main_room_id
end 
```

你能告诉我为什么吗

```
door.build_main_room.door 
```

返回零？

升级版：

```
door.build_main_room 
# =>  #<Room id: nil> 
```

**UPD2：** 哦，伙计们，这完全是我的错。关联是正确的，但是在 Room 类`door`中定义了方法并且它返回 nil。没有它一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:23:12.273

你的代码

```
door.build_main_room.door 
```

将返回 nil，因为您尚未保存构建的对象。要保存它，您需要使用

```
door.save 
```

如果保存成功，那么只有您可以访问

```
door.main_room.door 
```

# c# - 从 Tabcontrol 关闭选项卡，但最后保持一个选项卡处于活动状态

> ID：12475793
> 
> 赞同：1
> 
> 时间：2012-09-18T11:07:59.393
> 
> 标签：c#, wpf, tabcontrol

我正在处理 WPF 中的选项卡控件。我在选项卡控件中添加了一组选项卡，还实现了关闭按钮方法，效果很好。

```
private void CloseTab(object source, RoutedEventArgs args)
    {            
        TabItem tabItem = args.Source as TabItem; 

        if (tabItem != null)
        {
            TabControl tabControl = tabItem.Parent as TabControl;
            if (tabControl != null)
                tabControl.Items.Remove(tabItem);             

        }            
    } 
```

XAML：

```
<TabControl Name="ConnectTab" Style="{DynamicResource styleBackground}">
                        <tablocal:CloseableTabItem Header="Connect" > 
                        </tablocal:CloseableTabItem>
                        <tablocal:CloseableTabItem Header="I2C" />
                        <tablocal:CloseableTabItem Header="Voltage" />
                        <tablocal:CloseableTabItem Header="Clock" /> 
```

我面临的问题是在关闭所有选项卡后保持一个选项卡处于活动状态（不应该关闭）。基本上，即使用户单击选项卡上的 X 按钮，tabcontrol 中的最后一个选项卡也不会关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:18:44.813

将条件更改为 -

```
if (tabControl != null && tabControl.Items.Count > 1)
    tabControl.Items.Remove(tabItem); 
```

# php - PHP遍历多维（数组）对象

> ID：12475797
> 
> 赞同：0
> 
> 时间：2012-09-18T11:08:17.660
> 
> 标签：php, multidimensional-array, foreach

我有一个需要返回的对象，但是在返回它之前我需要执行一些预返回操作。

该对象具有以下格式：

```
object(PaginationHelper)[3]
    public 'current_page' => int 1
    public 'items_per_page' => int 10
    public 'dataset' => 
        array (size=10)
            0 => 
                object(AdvertSet)[4]
                    public 'Keywords' => string '' (length=0)
                    protected 'Adverts' => 
                        array (size=3) // SIZE = 3 SO REMOVE THIS FROM 'dataset' ARRAY
                        ...
                    public 'LiveStatus' => boolean false
            1 => 
                object(AdvertSet)[5]
                    public 'Keywords' => string '' (length=0)
                    protected 'Adverts' => 
                        array (size=1) // SIZE = 1 SO KEEP THIS IN 'dataset' ARRAY
                        ...
                    public 'LiveStatus' => boolean false

      etc etc ....
[End Object] 
```

**我需要做什么：**

删除“数据集”数组中“广告”计数不为 1 的所有部分，从而*仅*保留“广告”数组大小为 1 的数据集。保留它是要返回的对象这一事实.

我已经尝试过多维递归函数来解决这个问题，但是它是一个对象而不是数组这一事实正在取得进展，我不确定我是否能够从一个对象转换为一个数组并返回再次没有弄乱对象的内部结构。

有人能帮忙吗？这是我到目前为止通过 foreach 得到的结果......

```
foreach($results as $key => $value) {
    if($key == 'dataset') {
    // value is right array to check count
    foreach($value as $k => $v) {
        echo $v;
    }
}
} 
```

它不起作用，但这是我目前正在研究的方法。

我也尝试过类似的东西：

```
if(count($results->dataset->(Array)AdvertSet->Adverts == 1) { } 
```

但我不能将 AdvertSet 转换为 Array.. 任何帮助将不胜感激！

只是一个简短的说明：它不必从数组中删除，我最终只需要相同的对象，而不需要那些广告计数为 3 的对象。所以这可能涉及复制到没有广告计数的新数组<> 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:18:37.940

我的第一个想法是：

```
foreach($PaginationHelper->dataset as &$data) {
  if(count($data) !== 1)
     unset($data);
} 
```

但是在第三次阅读您的问题后，我看到您只想删除广告计数不等于 1 的那些元素。

查看您的结构， Adverts 数组是**protected**，因此现在可以在不*继承 Advertset object*的情况下访问它。

所以，我的最终答案一定是：用这种结构是**不可能**移除它们的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:17:10.027

您的数据结构*并不是*真正的递归，您不需要递归遍历。

您只需要遍历`$object->dataset`数组并删除广告计数不为 1 的项目。由于您试图通过受保护的属性过滤项目，因此一种方法是实现一种`AdvertSet::count()`方法，该方法将返回包含广告的数量：`$object->dataset[$i]->Adverts->count() != 1`。我建议不要仅仅为了过滤而强迫您访问受保护的属性。

# unicode - 为 X11 创建字体

> ID：12475798
> 
> 赞同：0
> 
> 时间：2012-09-18T11:08:19.797
> 
> 标签：unicode, fonts, x11

如何为 X windows 系统的 Unicode 字符创建字体？谁能给我一些教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T19:43:01.443

X11 可以识别 TrueType、OpenType 和 Type 1 (PostScript) 字体。如果您想创建一种新字体，您可能应该使用其中一种格式。

还有传统的位图格式，但不推荐使用它，因为这些字体不可缩放且不支持抗锯齿。

有许多用于创建 TrueType 和其他可缩放字体的工具，[FontForge](http://fontforge.org)是著名的开源工具。

# php - PDO 给出了奇怪的结果

> ID：12475799
> 
> 赞同：2
> 
> 时间：2012-09-18T11:08:19.910
> 
> 标签：php, mysql, pdo

我从 PDO 得到一个奇怪的错误，这没有意义。我正在尝试以下代码，但即使我更改了代码，我也会得到完全相同的错误，它不反映任何更改。

```
 $stmt = $db->prepare("SELECT database, gpsthr from ccprefs where fleetnumber=?");
    $stmt->bindValue(1, (int) $smpfleet, PDO::PARAM_INT);
    $stmt->execute(); 
```

这是错误消息：

**“SQLSTATE [42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在 'gpsthr from ccprefs wherefleetnumber= ?' 附近使用 在第 1 行"**

如果我将代码更改为此，我仍然会收到相同的错误。

```
 $stmt = $db->prepare("SELECT database, gpsthr from ccprefs where fleetnumber= :fleet");
    $stmt->bindValue(':fleet', (int) $smpfleet, PDO::PARAM_INT);
    $stmt->execute(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:11:14.457

`DATABASE`是[保留关键字](http://dev.mysql.com/doc/refman/5.6/en/reserved-words.html)，因此您必须[引用](http://dev.mysql.com/doc/refman/5.6/en/identifiers.html)它。

# c# - 将字符串转换为 c# 可执行代码

> ID：12475804
> 
> 赞同：3
> 
> 时间：2012-09-18T11:08:38.553
> 
> 标签：c#, asp.net, json.net, dynamic-compilation, dynamic-code

我有一个小解决方案，我对此主题进行了研究，但找不到我正在寻找的确切内容，示例是在字符串中编译整个方法或完整表达式。我想要说我有这段代码，我试图使用 Newtonsoft.json 从 json 中提取数据，

```
 JObject o = JObject.Parse(data);
        string getFristRow = Convert.ToString(o["Body"][0]["RowId"]); 
```

我想要的是通过这个部分，

```
 o["Body"][0]["RowId"] 
```

作为字符串并转换为 c# 代码，这样我就可以使该值动态地作为 json 文件格式彼此非常不同。

编辑：

以下是我正在使用的 json 字符串，

```
 { "Head": { "Status": 0, "Message": "", "Count": 1905 }, "Body": [ { "RowId": { "SensorIdValue": "Sensor-029-cert.org.cn", "DataTimeValue": "20120911100002", "DataInValue": "eth0", "DataOutValue": "", "DataMacSourceValue": "3c:e5:a6:55:2b:1a", "DataMacDestinationValue": "00:0c:29:80:1d:fc", "DataMacTypeValue": "08:00", "DataUidValue": "0", "ProtocolValue": "Tcp", "IpPrecedenceValue": "0x00", "IpTypeOfServiceValue": "0x00", "IpTotalLengthValue": "48", "IpIdentificationValue": "35856", "IpFragmentOffsetValue": "0", "IpMoreFragmentValue": "0", "IpTruncatedValue": "0", "IpCongestionExperiencedValue": "0", "IpTimeToLiveValue": "116", "IpFragValue": "0", "IpOptionValue": "", "IpSourceAddressValue": "61.157.198.130", "IpDestinationAddressValue": "202.108.212.84", "SourceRegionValue": "CN", "DestinationRegionValue": "CN", "SourcePortValue": "1729", "DestinationPortValue": "5900", "SequenceNumberValue": "0", "AcknowledgmentNumberValue": "0", "WindowValue": "65535", "ReservedValue": "0x00", "UrgentPointerValue": "0 ", "CrwValue": "0", "EceValue": "0", "UrgValue": "0", "AckValue": "0", "PshValue": "0", "RstValue": "0", "SynValue": "1", "FinValue": "0", "TruValue": "0", "OptionsValue": " ", "LengthValue": "", "TypeValue": "", "CodeValue": "", "IdentificationValue": "", "ParameterValue": "", "GatewayValue": "", "MaximumTransmissionUnitValue": "", "IncompleteValue": "", "SpiValue": "", "InfoValue": "" } }, { "RowId": { "SensorIdValue": "Sensor-029-cert.org.cn", "DataTimeValue": "20120911100003", "DataInValue": "eth0", "DataOutValue": "", "DataMacSourceValue": "3c:e5:a6:55:2b:1a", "DataMacDestinationValue": "00:0c:29:80:1d:fc", "DataMacTypeValue": "08:00", "DataUidValue": "0", "ProtocolValue": "Tcp", "IpPrecedenceValue": "0x00", "IpTypeOfServiceValue": "0x00", "IpTotalLengthValue": "44", "IpIdentificationValue": "13483", "IpFragmentOffsetValue": "1", "IpMoreFragmentValue": "0", "IpTruncatedValue": "0", "IpCongestionExperiencedValue": "0", "IpTimeToLiveValue": "116", "IpFragValue": "0", "IpOptionValue": "", "IpSourceAddressValue": "183.61.185.3", "IpDestinationAddressValue": "202.108.212.84", "SourceRegionValue": "CN", "DestinationRegionValue": "CN", "SourcePortValue": "80", "DestinationPortValue": "41084", "SequenceNumberValue": "0", "AcknowledgmentNumberValue": "0", "WindowValue": "8760", "ReservedValue": "0x00", "UrgentPointerValue": "0 ", "CrwValue": "0", "EceValue": "0", "UrgValue": "0", "AckValue": "1", "PshValue": "0", "RstValue": "0", "SynValue": "1", "FinValue": "0", "TruValue": "0", "OptionsValue": " ", "LengthValue": "", "TypeValue": "", "CodeValue": "", "IdentificationValue": "", "ParameterValue": "", "GatewayValue": "", "MaximumTransmissionUnitValue": "", "IncompleteValue": "", "SpiValue": "", "InfoValue": "" } }]} 
```

知道如何或什至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:27:37.470

您能否展示一下您的 JSON 数据是什么样的？举例：

```
{
  "1": {
    "id"  : 1,
    "name": Eni,
    "type": "Girl"
  },
  "2": {
    "id"  : 2,
    "name": Maarten,
    "type": "Men"
  }
} 
```

现在您可以遍历元素：

```
var jFoo = JObject.Parse(data);
foreach (JToken child in jFoo.Children())
{
    foreach (JToken grandChild in child)
    {
        foreach (JToken grandGrandChild in grandChild)
        {
            var property = grandGrandChild as JProperty;
            if (property != null)
            {
                Console.WriteLine(property.Name + ":" + property.Value);
            }
        }
    }
} 
```

给出这个输出：

```
id:1
name:Eni
type:Girl
id:2
name:Maarten
type:Men 
```

这是你需要的吗？

# ruby-on-rails - 我可以用密码保护 Sinatra 应用程序免受路由的影响吗？

> ID：12475808
> 
> 赞同：3
> 
> 时间：2012-09-18T11:08:43.610
> 
> 标签：ruby-on-rails, routing, sinatra

我正在我的路线中安装一个 Sinatra 应用程序。我想为其提供http基本身份验证。我可以从路线文件中做到这一点吗？

```
mount My::App, :at => "/mysin" 
```

我知道我可以检查对 auth 标头的请求，但我不知道如何向用户提供 auth 对话框。通常，从控制器，我会这样做`authenticate_or_request_with_http_basic`，但由于我不在控制器的上下文中，所以这不起作用。任何解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:43:27.337

这似乎有效：

```
My::App.use(Rack::Auth::Basic) do |username, password|
  username == 'some_user' && password == 'some_password'
end 
mount My::App, :at => "/path" 
```

# c++ - 使用 C++ 在标准输入上创建 Thrift 服务器

> ID：12475810
> 
> 赞同：2
> 
> 时间：2012-09-18T11:08:53.917
> 
> 标签：c++, thrift

我想知道是否有可能创建一个 Thrift 服务器来监听标准输入并将答案写入标准输出。我在 Thrift 中找到了 TFDTransport。

```
int fd = fgetc( stdin );
shared_ptr<TFDTransport> innerTransport(new TFDTransport(fd));
shared_ptr<TBufferedTransport> transport(new TBufferedTransport(innerTransport)); 
```

我不确定如何创建一个 Thrift 服务器来监听标准输入并将答案写入标准输出。这是初始化新服务器的标准方法：

```
shared_ptr<TJSONProtocol> protocol(new TJSONProtocol(transport));
TSimpleServer server(processor,
                   serverTransport,
                   transportFactory,
                   protocolFactory); 
```

但在这一点上，我不确定如何进步。甚至可以使用 Thrift 在 stdin/stdout 上创建服务器，如果可以，如何创建这样的服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:38:12.873

那么您可能需要创建自己的 STDIN/OUT 客户端和服务器传输。如果服务器是父进程而客户端是子进程，这将很容易，但反过来更有趣。它本质上将允许各种多语言插件框架。

对于同机IPC，我实际上也对此非常感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:19:59.550

If you environment is Windows: There is an implementations for Anon Pipes available in C++, which does exactly that. See [https://issues.apache.org/jira/browse/THRIFT-1558](https://issues.apache.org/jira/browse/THRIFT-1558)

# matlab - Matlab中的关闭/暂停过程

> ID：12475813
> 
> 赞同：0
> 
> 时间：2012-09-18T11:09:03.687
> 
> 标签：matlab, plot, keyboard

我有一个包含很多情节的代码。问题（请原谅我的无知，因为我不知道是否可能）是，例如，当我从一开始执行时，我直接看到最后一个情节，而不是一个接一个。因此，例如，我已经尝试过，但它根本不起作用：

```
pause(2); %After two seconds it starts and open the plot but I directly see the last plot, not this    
plot (x, y);
title ('Average values')
close; % The command close it works but only if I press 'evaluate function'

pause(2);
plot (out1,out2);
close; 
```

另外，我尝试使用键盘命令尝试是否可以用一个键关闭绘图，然后用另一个键打开另一个，但我做不到。

如果有人知道我该怎么做，我会很感激，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T10:09:46.437

Matlab 通常在同一过程中进行绘图和计算。所以通常你不会得到任何显示，直到有一些空闲时间在你的程序中绘图。

要强制 matlab 重绘窗口，您可以使用该`drawnow`命令。但它只在此刻准确绘制 - 因此，如果您的图形窗口将被隐藏或隐藏在其他窗口之后，则在下一次之前不会重新绘制前景。

在您的情况下，您还可以在暂停之前关闭绘图（可以显示的地方）。因此，如果您交换这两个命令，您应该会看到它。暂停的明显缺点是 - 它会暂时停止您的程序。

* * *

根据我的经验，我建议您将绘图保存为图形文件并使用一些外部程序来查看它们。此外，我发现弹出的新窗口很烦人并打断了我的工作流程 - 所以我会重复使用图形窗口，只需使用`clf`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T11:44:13.000

我可能会误解您要做什么，但是当我尝试创建您所描述的内容时，它会按预期对我有用。这是我的例子：

请注意，您需要关闭所有打开的图形窗口以确保它弹出而不是让它留在后台。

```
pause(2); % Wait 2 seconds before starting
plot(1:10); % Plot an upward line
title('up'); % Give it a title

pause(2); % Wait 2 seconds before showing the next plot
plot(10:-1:1); % Plot an downward line
title('down'); % Give it a title 
```

根据您希望如何使用它们，保存绘图可能是一个更好的解决方案。

# asp.net-mvc - 使用 HttpWebRequest、WebClient 等将对象发布到 MVC 控制器

> ID：12475819
> 
> 赞同：1
> 
> 时间：2012-09-18T11:09:25.420
> 
> 标签：asp.net-mvc, httpwebrequest

我有这个将对象“ContentList”作为参数的 api 控制器操作。

```
 [HttpPost]
    public List<string> SendList(string param, ContentList list)
    {
        List<string> testReturn = new List<string> { "test1", "test2", "test3", "test4" };

        return testReturn ;

    } 
```

到目前为止，我尝试过的是调用这样的控制器操作：

```
 Uri _uri = new Uri("http://localhost:xxxxx/api/FakeTest/SendList?param=test");

        var serializer = new JavaScriptSerializer();
        string requestData = serializer.Serialize(new
        {
            list = ContentList,
        });

        using (var client = new WebClient())
        {
            client.Headers[HttpRequestHeader.ContentType] = "application/json";

            var result = client.UploadData(_uri, Encoding.UTF8.GetBytes(requestData));

            var tempString = Encoding.UTF8.GetString(result);
        } 
```

在此示例中， tempString = ["test1","test2","test3","test4"] 由控制器操作重新运行。

在控制器动作中，我可以访问传入的 ContentList 的属性，并返回它们的值（当然相应地更改动作返回值）。

但是，在控制器操作中，我需要发送 ContentList 对象以进行进一步处理，这似乎失败了。我收到 500 内部服务器错误，我无法在控制器中放置断点来跟踪传入的值。调试器永远不会命中它......

我希望这与将 json 发送到控制器操作有关。

无论如何，似乎 ContentList 被从控制器操作发送到的代码拒绝了，所以我想我需要进行某种反序列化，对吧？

底线，问题是，从代码中调用控制器操作、传入 C# 对象并使其可从控制器操作中使用的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:16:44.407

如果您使用的是 MVC 3，您的控制器应该能够以直接的方式接收和解析 json 数据。如果您使用的是 MVC 2，则需要在应用程序上注册一个新工厂，以处理控制器上的 json 解析

```
protected void Application_Start() 
{
  RegisterRoutes(RouteTable.Routes);
  ValueProviderFactories.Factories.Add(new JsonValueProviderFactory());
} 
```

有关此主题的更多信息：http: [//haacked.com/archive/2010/04/15/sending-json-to-an-asp-net-mvc-action-method-argument.aspx](http://haacked.com/archive/2010/04/15/sending-json-to-an-asp-net-mvc-action-method-argument.aspx)

# git - 我可以在子模块更新之前忽略子模块内的目录吗？

> ID：12475820
> 
> 赞同：3
> 
> 时间：2012-09-18T11:09:26.083
> 
> 标签：git, git-submodules

我的项目中有一个子模块，其中包含 docs/ 和 demo/ 目录中的大量媒体文件。当我 'git submodule update --init' 下载整个 repo 时，我可以添加一个忽略文件。

在我更新/初始化子模块之前是否可以忽略这些目录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T11:37:31.177

你想做的事情出现在 Git 1.7.0 中，被称为“稀疏检出”。您可以在以下 Stack Overflow 线程中找到很好的示例：

*   [Git 1.7.0 中的稀疏结帐？](https://stackoverflow.com/questions/2336580/sparse-checkout-in-git-1-7-0)
*   [如何仅克隆 Git 存储库的子目录？](https://stackoverflow.com/questions/600079/is-there-any-way-to-clone-a-git-repositorys-sub-directory-only)

它也应该适用于子模块，因为它们只不过是普通的存储库，但正如您在指出的线程中看到的那样，该功能仍然需要一些改进。

# vim - Vim '=' 不起作用 (CentOS 6)

> ID：12475824
> 
> 赞同：2
> 
> 时间：2012-09-18T11:10:05.890
> 
> 标签：vim, centos, vi, indentation

当我尝试**gg=G**或类似的东西时，我得到错误：

```
:.,$!indent
shell returned 127
4 lines filtered
Press ENTER or type command to continue 
```

在我的 Fedora destop 上它工作正常。怎么了？

配置：

```
set autoindent
set tabstop=4
set shiftwidth=4
set number
set smartindent 
set showmatch 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:42:38.273

您可以取消设置`equalprg`选项：

```
set ep= 
```

为空时`ep`，vim 将使用内部格式化功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:12:07.147

您没有安装[缩进](http://www.gnu.org/software/indent/)工具。

```
yum install indent 
```

# mysql - 在两个特定时间之间每 5 分钟减去一次数据

> ID：12475830
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:28.427
> 
> 标签：mysql

我对 MYSQL 有一些问题，我需要每 5 分钟减去两个特定时间之间的数据，然后平均 5 分钟的数据。我现在正在做的是：

```
select (avg(columnname)),convert((min(datetime) div 500)*500, datetime) + INTERVAL 5 minute as endOfInterval 
from Databasename.Tablename 
where datetime BETWEEN '2012-09-12 10:50:00' AND '2012-09-12 14:50:00' 
group by datetime div 500; 
```

它是累积平均值。假设我在 11 点得到 500，在 11.05 得到 700，我需要的平均值是 (700-500)/5 = 40。但现在我得到 (500+700)/5 = 240。我不需要累积平均值. 请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:42:23.247

对于您正在谈论的那种平均值，您不想使用子句*聚合多行。*相反，您希望使用同一个表中的*两个不同行*`GROUP BY`来计算结果。这需要自加入：

 *```
SELECT (b.columnname - a.columnname)/5, a.datetime, b.datetime
FROM Database.Tablename a, Database.Tablename b
WHERE b.datetime = a.datetime + INTERVAL 5 MINUTE
  AND a.datetime BETWEEN '2012-09-12 10:50:00' AND '2012-09-12 14:45:00' 
```

`a`并`b`引用同一张表的两个不同行。该`WHERE`子句确保它们之间正好相隔 5 分钟。

如果没有与该时间距离匹配的第二列，则查询结果中不会包含任何结果行。如果您的表格不是每五分钟就有一次数据点，但您必须寻找合适的合作伙伴，那么事情就会变得更加困难。[这个答案](https://stackoverflow.com/a/12275621/1468366)可能会针对该用例进行调整。或者您可以在应用程序级别而不是在数据库服务器上实现这一点。*

# ruby-on-rails - Michael Hartls 教程第 6 章 -User_spec.rb- 大规模测试失败

> ID：12475832
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:32.533
> 
> 标签：ruby-on-rails, ruby

我正在研究 michael hartl rails 教程。目前在第 6 章。编辑 user_spec.rb 文件后，我尝试运行测试，但我遇到了巨大的失败：

```
C:\rails_project\sample_app>bundle exec rspec spec/
←[32m.←[0m←[32m.←[0m←[33m*←[0m←[31mF←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[31mF←[0m←[32m.←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[32m.←[0m←[31mF←[0m
←[31mF←[0m←[31mF←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[33m*←[0m

Pending:
←[33m  UsersHelper add some examples to (or delete) C:/rails_project/sample_app/
spec/helpers/users_helper_spec.rb←[0m
←[36m    # No reason given←[0m
←[36m    # ./spec/helpers/users_helper_spec.rb:14←[0m
←[33m  users/new.html.erb add some examples to (or delete) C:/rails_project/samp
le_app/spec/views/users/new.html.erb_spec.rb←[0m
←[36m    # No reason given←[0m
←[36m    # ./spec/views/users/new.html.erb_spec.rb:4←[0m

Failures:

  1) User
     ←[31mFailure/Error:←[0m ←[31mit { should be_valid }←[0m
        ←[31mexpected valid? to return true, got false←[0m
←[36m     # ./spec/models/user_spec.rb:31:in `block (2 levels) in <top (required
)>'←[0m

  2) User when email format is valid should be valid
    ←[31mFailure/Error:←[0m ←[31m@user.should be_valid←[0m
      ←[31mexpected valid? to return true, got false←[0m
←[36m     # ./spec/models/user_spec.rb:64:in `block (4 levels) in <top (required
)>'←[0m
←[36m     # ./spec/models/user_spec.rb:62:in `each'←[0m
←[36m     # ./spec/models/user_spec.rb:62:in `block (3 levels) in <top (required
)>'←[0m

 3) User with a password that's too short
     ←[31mFailure/Error:←[0m ←[31mit { should be_valid }←[0m
        ←[31mexpected valid? to return true, got false←[0m
←[36m     # ./spec/models/user_spec.rb:112:in `block (3 levels) in <top (require
d)>'←[0m

4) User return value of authenticate method with valid password
 ←[31mFailure/Error:←[0m ←[31mit { should == found_user.authenticate(@user.p
assword) }←[0m
 ←[31mNoMethodError:←[0m
   ←[31mundefined method `authenticate' for nil:NilClass←[0m
 ←[36m     # ./spec/models/user_spec.rb:99:in `block (4 levels) in <top (required
)>'←[0m

5) User return value of authenticate method with invalid password
 ←[31mFailure/Error:←[0m ←[31mlet(:user_for_invalid_password) { found_user.a
uthenticate("invalid") }←[0m
 ←[31mNoMethodError:←[0m
   ←[31mundefined method `authenticate' for nil:NilClass←[0m
 ←[36m     # ./spec/models/user_spec.rb:103:in `block (4 levels) in <top (require
 d)>'←[0m
 ←[36m     # ./spec/models/user_spec.rb:105:in `block (4 levels) in <top (require
 d)>'←[0m

   6) User return value of authenticate method with invalid password
 ←[31mFailure/Error:←[0m ←[31mlet(:user_for_invalid_password) { found_user.a
 uthenticate("invalid") }←[0m
 ←[31mNoMethodError:←[0m
   ←[31mundefined method `authenticate' for nil:NilClass←[0m
 ←[36m     # ./spec/models/user_spec.rb:103:in `block (4 levels) in <top (require
 d)>'←[0m
 ←[36m     # ./spec/models/user_spec.rb:106:in `block (4 levels) in <top (require
 d)>'←[0m

   7) User return value of authenticate method with valid password
      ←[31mFailure/Error:←[0m ←[31mit { should == found_user.authenticate(@user.e
 mail) }←[0m
      ←[31mNoMethodError:←[0m
        ←[31mundefined method `authenticate' for nil:NilClass←[0m
   ←[36m     # ./spec/models/user_spec.rb:120:in `block (4 levels) in <top (require
   d)>'←[0m

   8) User return value of authenticate method with invalid password
      ←[31mFailure/Error:←[0m ←[31mlet(:user_for_invalid_password) { found_user.a
  uthenticate("invalid") }←[0m
      ←[31mNoMethodError:←[0m
        ←[31mundefined method `authenticate' for nil:NilClass←[0m
  ←[36m     # ./spec/models/user_spec.rb:124:in `block (4 levels) in <top (require
  d)>'←[0m
  ←[36m     # ./spec/models/user_spec.rb:126:in `block (4 levels) in <top (require
  d)>'←[0m

   9) User return value of authenticate method with invalid password
 ←[31mFailure/Error:←[0m ←[31mlet(:user_for_invalid_password) { found_user.a
 uthenticate("invalid") }←[0m
 ←[31mNoMethodError:←[0m
   ←[31mundefined method `authenticate' for nil:NilClass←[0m
 ←[36m     # ./spec/models/user_spec.rb:124:in `block (4 levels) in <top (require
 d)>'←[0m
 ←[36m     # ./spec/models/user_spec.rb:127:in `block (4 levels) in <top (require
 d)>'←[0m

 Finished in 10.71 seconds
 ←[31m37 examples, 9 failures, 2 pending←[0m

 Failed examples:

 ←[31mrspec ./spec/models/user_spec.rb:31←[0m ←[36m# User ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:60←[0m ←[36m# User when email format is va
 lid should be valid←[0m
 ←[31mrspec ./spec/models/user_spec.rb:112←[0m ←[36m# User with a password that's
 too short ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:99←[0m ←[36m# User return value of authent
 icate method with valid password ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:105←[0m ←[36m# User return value of authen
 ticate method with invalid password ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:106←[0m ←[36m# User return value of authen
 ticate method with invalid password ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:120←[0m ←[36m# User return value of authen
 ticate method with valid password ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:126←[0m ←[36m# User return value of authen
 ticate method with invalid password ←[0m
 ←[31mrspec ./spec/models/user_spec.rb:127←[0m ←[36m# User return value of authen
 ticate method with invalid password ←[0m 
```

这是我的 User_spec.rb 文件：

```
 require 'spec_helper'

 describe User do

before  do
    @user = User.new(name: "Example User", email: "user@example.com",
                     password: "foobar",  
    passsword_confirmation: "foobar") 
end

subject { @user }

it { should respond_to(:name) }
it { should respond_to(:email) }
it { should respond_to(:password_digest) }
it { should respond_to(:password) }
it { should respond_to(:password_confirmation) }
it { should respond_to(:authenticate) }

it { should be_valid }

describe "When name is not present" do
    before { @user.name = " " }
    it { should_not be_valid }
end

describe "when email is not present" do
    before { @user.email = " " }
    it { should_not be_valid}
end

describe "when name is too long" do
    before { @user.name = "a" * 51 }
    it { should_not be_valid }
end

describe "when email format is invalid" do
    it "should be invalid" do
        addresses = %w[user@foo,com user_at_foo.org example.user@foo.   
                        foo@bar_baz.com foo@bar+baz.com]
        addresses.each do |invalid_address|
            @user.email = invalid_address
            @user.should_not be_valid
        end
    end
end

describe "when email format is valid" do
    it "should be valid" do
        addresses  = %w[user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp 
  a+b@baz.cn]
        addresses.each do |valid_address|
            @user.email = valid_address
            @user.should be_valid
        end
    end
end

describe "when email addresses is already taken" do
    before do
        user_with_same_email = @user.dup
        user_with_same_email.email = @user.email.upcase
        user_with_same_email.save
    end

    it { should_not  be_valid }
end

describe "when password is not present" do
    before { @user.password = @user.password_confirmation = " "}
    it  { should_not be_valid }
end

describe "when password doesn't match confirmation" do
    before { @user.password_confirmation = "mismatch" }
    it { should_not be_valid }
end

describe "when password confirmation is nil" do 
    before { @user.password_confirmation = nil }
    it { should_not be_valid }
end

describe "return value of authenticate method" do
    before { @user.save } 
    let(:found_user) { User.find_by_email(@user.email) }

    describe "with valid password" do
        it { should == found_user.authenticate(@user.password) }
    end

    describe "with invalid password" do
        let(:user_for_invalid_password) {   
 found_user.authenticate("invalid") }

        it { should_not == user_for_invalid_password }
        specify { user_for_invalid_password.should be_false }
    end
end

describe "with a password that's too short" do
    before { @user.password = @user.password_confirmation = "a" * 5 }
    it { should be_valid }
end

describe "return value of authenticate method" do
    before { @user.save }
    let(:found_user) { User.find_by_email(@user.email) }    

    describe "with valid password" do
        it { should == found_user.authenticate(@user.email) }
    end

    describe "with invalid password" do
        let(:user_for_invalid_password) { 
found_user.authenticate("invalid") }

        it { should_not == user_for_invalid_password }
        specify { user_for_invalid_password.should be_false }
    end
end
end 
```

这是我的问题：

首先也是最明显的：

我应该怎么做才能通过这个测试？错误消息没有给我任何线索。

第二

当我这样创建新用户时：

```
irb(main):002:0> user = User.create(name: "Example user", email: "User@example>
  ←[1m←[36m (0.0ms)←[0m  ←[1mbegin transaction←[0m
  ←[1m←[35mUser Exists (0.0ms)←[0m  SELECT 1 AS one FROM "users" WHERE LOWER("us
 ers"."email") = LOWER('User@example.com') LIMIT 1
  ←[1m←[36m (0.0ms)←[0m  ←[1mrollback transaction←[0m
=> #<User id: nil, name: "Example user", email: "User@example.com", created_at:
nil, updated_at: nil, password_digest: nil> 
```

然后我尝试保存这个用户，我得到“错误”的响应：

```
irb(main):004:0> user.save
  ←[1m←[35m (0.0ms)←[0m  begin transaction
  ←[1m←[36mUser Exists (1.0ms)←[0m  ←[1mSELECT 1 AS one FROM "users" WHERE LOWER
  ("users"."email") = LOWER('User@example.com') LIMIT 1←[0m
  ←[1m←[35m (0.0ms)←[0m  rollback transaction
  => false 
```

这个问题与开头提到的测试失败有关吗？

最后一个问题：什么意思？

```
←[32m.←[0m←[32m.←[0m←[33m*←[0m←[31mF←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[31mF←[0m←[32m.←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[32m.←[0m←[31mF←[0m
←[31mF←[0m←[31mF←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[33m*←[0m 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T07:57:42.883

BUDDY：注意下面的代码（这是你的代码）。它来自 user_spec.rb。您连续两次复制/粘贴“无效密码”。其他一切都很好，您只是在规范文件中打错了字。

```
 describe "with invalid password" do
        let(:user_for_invalid_password) {   
 found_user.authenticate("invalid") }

        it { should_not == user_for_invalid_password }
        specify { user_for_invalid_password.should be_false }
    end
end

describe "with a password that's too short" do
    before { @user.password = @user.password_confirmation = "a" * 5 }
    it { should be_valid }
end

describe "return value of authenticate method" do
    before { @user.save }
    let(:found_user) { User.find_by_email(@user.email) }    

    describe "with valid password" do
        it { should == found_user.authenticate(@user.email) }
    end

    describe "with invalid password" do
        let(:user_for_invalid_password) { 
found_user.authenticate("invalid") }

        it { should_not == user_for_invalid_password }
        specify { user_for_invalid_password.should be_false }
    end
end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:36:32.773

你的意思是user.rb？

```
 class User < ActiveRecord::Base
   attr_accessible :email, :name, :password, :password_confirmation
   has_secure_password

    before_save { |user| user.email = email.downcase }

    validates :name,  presence: true, length: { maximum: 50 }
    VALID_EMAIL_REGEX = /\A[w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
    validates :email, presence: true, format: { with: VALID_EMAIL_REGEX },
               uniqueness: { case_sensitive: false }
    validates :password, presence: true, length: { minimum: 6 }
    validates :password_confirmation, presence: true

 end 
```

# oracle - ORACLE 中带有子查询的条件更新

> ID：12475833
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:33.080
> 
> 标签：oracle, subquery, dml

我有一个代表项目分组的表（ table1 ）和另一个代表项目本身的表（ table2 ）。
table1.id 是 table2 的外键，在 table1 的每条记录中，我还收集诸如 table2 中与该特定记录关联的记录总数以及各个字段的总和等信息，以便我可以显示分组和内容摘要无需查询table2。
通常 table2 中的项目一次添加/删除一个，所以我更新 table1 以反映 table2 中的更改。

出现了一个新要求，必须将组中的选定项目移动到新组中。我认为它是一个 3 步操作：

1.  在 table1 中创建一个新组
2.  更新 table2 中选择的记录以指向 table1 中新创建的记录

第三步是从组中减去记录数/我需要显示的其他字段的总和，并将它们添加到新组中，我可以在 table2 中找到与新组关联的项目的数据。

我想出了以下有效的陈述。

```
update table1 t1 set 
countitems = ( 
    case t1.id 
      when 1 then t1.countitems - ( select count( t2.id ) from table2 t2 where t2.id = 2 )
      when 2 then ( select count( t2.id ) from table2 t2 where t2.id = 2 )
    end
), 
sumitems = (
    case t1.id
      when 1 then t1.sumitems - ( select sum( t2.num ) from table2 t2 where t2.id = 2 )
      when 2 then ( select sum( t2.num ) from table2 t2 where t2.id = 2 )
    end
)
where t1.id in( 1, 2 ); 
```

有没有办法重写语句而不必每次都重复子查询？

谢谢
皮耶罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:32:02.803

您可以在 rowid 上使用游标和批量收集更新语句。这样，您可以简单地编写具有所需结果的连接查询并使用这些值更新表。我总是使用这个功能，每次都会做些细微的调整。

```
declare
    cursor cur_cur
    IS
    select ti.rowid     row_id
    ,      count(t2.id) countitems
    ,      sum(t2.num)  numitems
    from   table t1
    join   table t2 on t1.id = t2.t1_id
    order by row_id
    ;

    type type_rowid_array is table of rowid index by binary_integer;
    type type_countitems_array is table of table1.countitems%type;
    type type_numitems_array is table of table1.numitems%type;

    arr_rowid type_rowid_array;
    arr_countitems type_countitems_array;
    arr_numitems type_numitems_array;

    v_commit_size number := 10000;

begin
    open cur_cur;

    loop
        fetch cur_cur bulk collect into arr_rowid, arr_countitems, arr_numitems limit v_commit_size;

        forall i in arr_rowid.first .. arr_rowid.last
            update table1 tab
            SET    tab.countitems = arr_countitems(i)
            ,      tab.numitems = arr_numitems(i)
            where  tab.rowid = arr_rowid(i)
            ;

        commit;
        exit when cur_cur%notfound;

    end loop;

    close cur_cur;
    commit;

exception
  when others
    then rollback;
         raise_application_error(-20000, 'ERROR updating table1(countitems,numitems) - '||sqlerrm);

end; 
```

# asp.net - 在 asp.net 中，客户端连接到生产服务器时 Web 服务端点不正确

> ID：12475834
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:34.000
> 
> 标签：asp.net, service, ip-address, endpoint

我已经在网上搜索了将近两天，并且一定遗漏了一些东西（可能是基本的）。

在测试（本地）Web 服务器上，我设置了一个简单的服务，并使用客户端，我发现了该服务并毫无问题地运行它。

使用相同的客户端，我发现相同的服务，但在生产服务器上使用[https://MyNewStuff.com/WebServices/MyService.asmx](https://MyNewStuff.com/WebServices/MyService.asmx)（服务的真实互联网地址）没有问题，但是当我尝试运行它时失败并出现 EndPointNotFound 异常。经过调查，我发现客户端的 app.config 不正确，如下所示；

```
 <endpoint address="https://ProductionWeb.Ourdomain.com/WebServices/MyService.asmx"
            binding="basicHttpBinding" bindingConfiguration="MyServiceSoap"
            contract="MOX24.MyServiceSoap" name="MyServiceSoap" /> 
```

即，未正确设置，因为它反映[https://ProductionWeb.Ourdomain.com](https://ProductionWeb.Ourdomain.com) ... 而不是[https://MyNewStuff.com/WebServices](https://MyNewStuff.com/WebServices)，表明服务（发现）正在向客户端发送错误信息（它正在发送服务器的名称和域，而不是“网络”名称）。

对此的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:12:26.907

如果您的客户端是 Web 应用程序，请将[https://MyNewStuff.com/WebServices/MyService.asmx](https://MyNewStuff.com/WebServices/MyService.asmx)放在 Web.Release.config 中。

# java - 使用正则表达式在指定的查询字符串中获取 paramName 的 paramValue

> ID：12475835
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:35.980
> 
> 标签：java, regex

我喜欢编写一个 java 实用方法，它在指定的查询字符串中返回 paramName 的 paramValue

```
Pattern p = Pattern.compile("\\&?(\\w+)\\=  (I don't know what to put here) ");

public String getParamValue(String entireQueryString, String paramName)
{
    Matcher m = p.matcher(entireQueryString);
    while(m.find()) {
        if(m.group(1).equals(paramName)) {
            return m.group(2);
        }
    }
    return null;
} 
```

我将从我的 servlet 调用此方法，

```
 String qs = request.getQueryString(); //action=initASDF&requestId=9078-32&redirect=http://www.mydomain.com?actionId=4343
    System.out.println(getParamValue(qs, "requestId")); 
```

输出应该是 9078-32

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:13:11.483

您可以使用正则表达式否定组。请参阅另一个 SO 问题：[Regular Expressions and negating a whole character group](https://stackoverflow.com/questions/977251/regular-expressions-and-negating-a-whole-character-group)

您需要获取除`&`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:34:02.007

使用适当的[API](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameter%28java.lang.String%29)来执行此操作：`request.getParameter("requestId")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:19:53.593

您能否根据与符号 (&) 拆分字符串，然后在结果数组中搜索键（查找等号）。

这是 String.split() 的链接：http: [//docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)

这是我正在谈论的事情的类型：

```
private static final String KEY_VALUE_SEPARATOR = "=";
private static final String QUERY_STRING_SEPARATOR = "&";

public String getParamValue(String entireQueryString, String paramName) {
    String[] fragments = entireQueryString.split(QUERY_STRING_SEPARATOR);
    for (String fragment : fragments){
        if (fragment.substring(0, fragment.indexOf(KEY_VALUE_SEPARATOR)).equalsIgnoreCase(paramName)){
            return fragment.substring(fragment.indexOf(KEY_VALUE_SEPARATOR)+1);
        }
    }
    throw new RuntimeException("can't find value");
} 
```

最后的例外是一个非常垃圾的想法，但这并不是其中的重要部分。

# php - PHP：base64 编码的 IMAP 正文的解码

> ID：12475838
> 
> 赞同：0
> 
> 时间：2012-09-18T11:10:49.910
> 
> 标签：php, imap, decoding

PHP -IMAP 我已将所有 imap 邮件保存到数据库并从数据库中显示它们。我的问题是一封邮件显示“内容传输编码：base64”。如果我对其进行 base64 解码，那么其他邮件也会受到影响。到目前为止，我还无法将其更改为人类可读的格式。任何帮助将不胜感激。我尝试了很多解决方案，但我目前使用的代码是，

```
mb_convert_encoding($body, "ISO-8859-1", "UTF-8"); 
```

这封邮件的输出是

```
------=_NextPart_001_0606_012497BF.12408D60
Content-Type: text/plain;
charset="utf-8"
Content-Transfer-Encoding: base64

 OTA5MTU5Mzg3DQoNCuS7juaKgOacr+i1sOWQkeeuoeeQhueahOWbm+S4quaguOW/gw0KMjAxMi05
 LTE1ICAxNjowMjoxNw==

 ------=_NextPart_001_0606_012497BF.12408D60
 Content-Type: text/html;
charset="utf-8"
 Content-Transfer-Encoding: base64

 PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMCBUcmFuc2l0aW9uYWwv
 L0VOIj4NCjxIVE1MPjxIRUFEPg0KPE1FVEEgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0
 Zi04IiBodHRwLWVxdWl2PUNvbnRlbnQtVHlwZT4NCjxNRVRBIG5hbWU9R0VORVJBVE9SIGNvbnRl
 bnQ9Ik1TSFRNTCA4LjAwLjYwMDEuMTg5OTkiPjwvSEVBRD4NCjxCT0RZPg0KPFA+PEZPTlQgc2l6
 ZT0yPjkwOTE1OTM4NzxCUj48QlI+5LuO5oqA5pyv6LWw5ZCR566h55CG55qE5Zub5Liq5qC45b+D
 PC9GT05UPjwvUD4NCjxQPjxGT05UIHNpemU9Mj4yMDEyLTktMTUmbmJzcDsgMTY6MDI6MTc8L0ZP
 TlQ+PC9QPjwvQk9EWT48L0hUTUw+DQo=

 ------=_NextPart_001_0606_012497BF.12408D60-- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:17:57.693

它是 base64，你必须像这样在 body 部分使用 base64_decode：

```
base64_decode('OTA5MTU5Mzg3DQoNCuS7juaKgOacr+i1sOWQkeeuoeeQhueahOWbm+S4quaguOW/gw0KMjAxMi05LTE1ICAxNjowMjoxNw=='); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-18T14:07:44.820

只是手动检查有几个在线服务，如 [http://www.motobit.com/util/base64-decoder-encoder.asp](http://www.motobit.com/util/base64-decoder-encoder.asp)

只需复制并粘贴 base64 源并选择“解码”。你会得到一个“人类可用的格式”。

# android - 如何在 android 的本机扩展中启动活动并在 onCreate 函数上设置内容视图？

> ID：12475845
> 
> 赞同：0
> 
> 时间：2012-09-18T11:11:28.600
> 
> 标签：android, apache-flex, air, air-native-extension

我正在编写一个扩展，显示按钮单击的其他视图。我成功启动了该活动，但在 onCreate 活动上我正在设置内容视图，但出现此错误。我已将该活动包含在本机清单文件以及 flex 的 android 清单文件中

```
09-18 15:35:11.040: E/AndroidRuntime(7712): FATAL EXCEPTION: main
09-18 15:35:11.040: E/AndroidRuntime(7712): java.lang.RuntimeException: Unable to start activity ComponentInfo{air.TestAndroid.debug/com.aneexample.androiddialog.Second}: java.lang.NullPointerException
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.os.Looper.loop(Looper.java:123)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread.main(ActivityThread.java:3691)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at java.lang.reflect.Method.invokeNative(Native Method)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at java.lang.reflect.Method.invoke(Method.java:507)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at dalvik.system.NativeStart.main(Native Method)
09-18 15:35:11.040: E/AndroidRuntime(7712): Caused by: java.lang.NullPointerException
09-18 15:35:11.040: E/AndroidRuntime(7712):     at com.aneexample.androiddialog.Second.onCreate(Second.java:19)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-18 15:35:11.040: E/AndroidRuntime(7712):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

这就是我在 onCreate 方法上设置内容视图的方式。

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        Log.d(TAG, "create Second activity");
        super.onCreate(savedInstanceState);
        FREContext freContext = AndroidDialogExtension.context;
        setContentView(freContext.getResourceId("layout.second"));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:15:10.463

您需要从 FREFunction 传入 FREContext 或将其设置为某处的静态变量。

我会这样做（您应该尽可能避免使用静态变量，尽管我发现它们在我创建的两个 ANE 中非常方便）：

```
public FREContext freContext;
public Boolean created = false;

@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        Log.d(TAG, "create Second activity");
        super.onCreate(savedInstanceState);
        if ( freContext != null ) {
            setContentView(freContext.getResourceId("layout.second"));
        }
        created = true;
    }

public void setFREContext(FREContext context){
    freContext = context;
    //this ensures that the contentView is only set the one time. If you didn't do it this way, it could potentially run twice which is redundant and would quickly flash the screen black.
    if ( created ) { 
        setContentView(freContext.getResourceId("layout.second"));
    }
} 
```

（这是对 FREContext 为空评论的回应，它只是不适合那个小评论空间）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-06T20:54:34.810

为了从活动中访问 FREContext，请在活动中创建一个像这样的公共属性：

```
public static FREContext context=null; 
```

然后，在从 FREObject 或 FREFunction 开始活动之前，不要忘记像这样设置它：

```
@Override
public FREObject call(FREContext context, FREObject[] arg1) {
...
MyActivity.context = context; 
```

# bash - Bash 的函数会调用带有引用参数的命令吗？

> ID：12475846
> 
> 赞同：0
> 
> 时间：2012-09-18T11:11:30.543
> 
> 标签：bash, bash-function

假设我在 Bash 中有一个函数：

```
function ll {
    command ls -l $*
} 
```

所以它是使`ll`作品像`ls -l`。大多数情况下，它会起作用，但是

```
ls -l "ha ha" 
```

可以使用 name 的文件`ha ha`，但是

```
ll "ha ha" 
```

会失败，因为它被认为是

```
ls -l ha ha 
```

有没有办法使这项工作？我想我们可以做到的

```
function ll {
    command ls -l "$@"
} 
```

（注意`"$@"`不同于`"$*"`,`"$@"`表示单独引用，而`"$*"`表示全部引用在一个字符串中）

但是，`ll -t "ha ha"`会变成`ls -l "-t" "ha ha"`，它确实有效，但有点奇怪，我不确定它是否会在某些情况下崩溃。

有没有另一种方法让它工作，另一件事是，我认为在功能上，`command ls -l "$@"`是`ls -l "$@"`一样的吗？（`command`只是直接运行程序而不调用任何可能的bash函数来防止递归发生吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T11:57:32.337

由于 shell 在执行之前执行了*引号删除*`ls`，所以没有问题。您可以放心使用

```
function ll {
    command ls -l "$@"
} 
```

并将其称为`ll -t "ha ha"`. 请参阅您的 shell 手册页并搜索“引号删除”。

# django - Django admin - 禁用用户删除

> ID：12475847
> 
> 赞同：10
> 
> 时间：2012-09-18T11:11:35.420
> 
> 标签：django, django-admin

我有一个 django 应用程序，我想在管理员中禁用用户删除。我试图禁用操作并将删除权限设置为 false。但他们都没有工作。

```
from django.contrib.auth.models import User

class UserProfileAdmin(UserAdmin):
    actions = None 
```

**或者**

```
 def has_delete_permission(self, request):
        return False 
```

**或者**

```
 def get_actions(self, request):
        actions = super(UserProfileAdmin, self).get_actions(request)
        if 'delete_selected' in actions:
            del actions['delete_selected']
        return actions

admin.site.unregister(User)
admin.site.register(User, UserProfileAdmin) 
```

但是当我使用 UserAdmin 向用户信息添加内联时，它工作正常。所以请建议我一种在 django admin 中禁用用户删除的方法。提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-18T15:31:05.323

覆盖`ModelAdmin.has_delete_permission`应该可以解决问题，您的调用签名不正确，它缺少`obj`参数

```
class UserProfileAdmin(UserAdmin):
    def has_delete_permission(self, request, obj=None): # note the obj=None
        return False 
```

Furthermore, simply `return False` prevents all staffs including administrator from deleting items in the Django Admin, you may want to just tweak `User/Group` permissions to prevent those staff you don't want them to delete an `User()`, by removing their `delete_userprofile` and `delete_user` permissions.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-18T14:40:44.793

如果您的目标是永久删除所有管理员更改表单底部的“删除”按钮，您可以通过修改文件来实现`.../django/contrib/admin/templatetags/admin_modify.py`。

特别是，替换以下行：

```
 'show_delete_link': (not is_popup and context['has_delete_permission']
                          and (change or context['show_delete'])), 
```

和：

```
 'show_delete_link': False, 
```

并且没有管理员更改表单应该在左下角显示删除按钮。

# mysql - SQL查询从多个表返回数据

> ID：12475850
> 
> 赞同：459
> 
> 时间：2012-09-18T11:11:39.310
> 
> 标签：mysql, sql, select

我想知道以下内容：

*   如何从我的数据库中的多个表中获取数据？
*   有哪些方法可以做到这一点？
*   什么是联接和联合，它们之间有何不同？
*   与其他相比，我应该什么时候使用每一个？

我打算在我的（例如 - PHP）应用程序中使用它，但不想对数据库运行多个查询，我有哪些选项可以在单个查询中从多个表中获取数据？

注意：我写这篇文章是因为我希望能够链接到关于我在 PHP 队列中经常遇到的众多问题的编写良好的指南，所以当我发布答案时，我可以链接到这个以获得更多详细信息。

答案涵盖以下内容：

1.  [第 1 部分 - 连接和联合](https://stackoverflow.com/questions/12475850/how-can-an-sql-query-return-data-from-multiple-tables/12475851#12475851)
2.  [第 2 部分 - 子查询](https://stackoverflow.com/questions/12475850/how-can-an-sql-query-return-data-from-multiple-tables/12492267#12492267)
3.  [第 3 部分 - 技巧和高效代码](https://stackoverflow.com/questions/12475850/how-can-an-sql-query-return-data-from-multiple-tables/12508381#12508381)
4.  [第 4 部分 - From 子句中的子查询](https://stackoverflow.com/a/12542115/1450077)
5.  [第 5 部分 - 混合的约翰的把戏](https://stackoverflow.com/a/12586263/1450077)

* * *

## 回答 #1

> 赞同：500
> 
> 时间：2012-09-18T11:11:39.310

# 第 1 部分 - 连接和联合

这个答案包括：

1.  第1部分
    *   使用内部连接连接两个或多个表（有关更多信息，请参阅[维基百科条目](http://en.wikipedia.org/wiki/Join_%28SQL%29)）
    *   如何使用联合查询
    *   左外连接和右外连接（这个[stackOverflow 答案](https://stackoverflow.com/a/4715847/1450077)非常适合描述连接类型）
    *   相交查询（以及如果您的数据库不支持它们如何重现它们） - 这是 SQL-Server 的一个功能（[请参阅 info](https://stackoverflow.com/questions/148795/what-is-the-standard-sql-query-to-retrieve-the-intersection-of-tables)），[也是我首先编写整个内容的部分原因](https://stackoverflow.com/questions/12443904/creating-query-that-returns-id-if-condition-is-matched-in-rows-from-two-tables/12455505#12455505)。
2.  第2部分
    *   子查询——它们是什么，它们可以在哪里使用以及需要注意什么
    *   笛卡尔加入 AKA - 哦，痛苦！

有多种方法可以从数据库中的多个表中检索数据。在这个答案中，我将使用 ANSI-92 连接语法。这可能与其他许多使用较旧的 ANSI-89 语法的教程不同（如果您习惯于 89，可能看起来不那么直观 - 但我只能说尝试一下），因为它*更*容易了解查询何时开始变得更加复杂。为什么要使用它？有性能提升吗？[简短](https://stackoverflow.com/questions/334201/why-isnt-sql-ansi-92-standard-better-adopted-over-ansi-89)的回答是否定的，但是一旦你习惯了它*就会更容易阅读。*使用这种语法更容易阅读其他人编写的查询。

我还将使用小型车场的概念，它有一个数据库来跟踪它有哪些可用的汽车。所有者已聘请您作为他的 IT 计算机人员，并希望您能够立即将他要求的数据交给他。

我已经制作了一些查找表，最终表将使用它们。这将为我们提供一个合理的工作模型。首先，我将对具有以下结构的示例数据库运行查询。我会尝试思考刚开始时常犯的错误，并解释它们出了什么问题——当然还会展示如何纠正它们。

第一个表只是一个颜色列表，以便我们知道我们在车场有什么颜色。

```
mysql> create table colors(id int(3) not null auto_increment primary key, 
    -> color varchar(15), paint varchar(10));
Query OK, 0 rows affected (0.01 sec)

mysql> show columns from colors;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(3)      | NO   | PRI | NULL    | auto_increment |
| color | varchar(15) | YES  |     | NULL    |                |
| paint | varchar(10) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> insert into colors (color, paint) values ('Red', 'Metallic'), 
    -> ('Green', 'Gloss'), ('Blue', 'Metallic'), 
    -> ('White' 'Gloss'), ('Black' 'Gloss');
Query OK, 5 rows affected (0.00 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select * from colors;
+----+-------+----------+
| id | color | paint    |
+----+-------+----------+
|  1 | Red   | Metallic |
|  2 | Green | Gloss    |
|  3 | Blue  | Metallic |
|  4 | White | Gloss    |
|  5 | Black | Gloss    |
+----+-------+----------+
5 rows in set (0.00 sec) 
```

品牌表确定了车床可能销售的不同品牌的汽车。

```
mysql> create table brands (id int(3) not null auto_increment primary key, 
    -> brand varchar(15));
Query OK, 0 rows affected (0.01 sec)

mysql> show columns from brands;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(3)      | NO   | PRI | NULL    | auto_increment |
| brand | varchar(15) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.01 sec)

mysql> insert into brands (brand) values ('Ford'), ('Toyota'), 
    -> ('Nissan'), ('Smart'), ('BMW');
Query OK, 5 rows affected (0.00 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select * from brands;
+----+--------+
| id | brand  |
+----+--------+
|  1 | Ford   |
|  2 | Toyota |
|  3 | Nissan |
|  4 | Smart  |
|  5 | BMW    |
+----+--------+
5 rows in set (0.00 sec) 
```

模型表将涵盖不同类型的汽车，使用不同的汽车类型而不是实际的汽车模型会更简单。

```
mysql> create table models (id int(3) not null auto_increment primary key, 
    -> model varchar(15));
Query OK, 0 rows affected (0.01 sec)

mysql> show columns from models;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(3)      | NO   | PRI | NULL    | auto_increment |
| model | varchar(15) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)

mysql> insert into models (model) values ('Sports'), ('Sedan'), ('4WD'), ('Luxury');
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> select * from models;
+----+--------+
| id | model  |
+----+--------+
|  1 | Sports |
|  2 | Sedan  |
|  3 | 4WD    |
|  4 | Luxury |
+----+--------+
4 rows in set (0.00 sec) 
```

最后，将所有这些其他表格捆绑在一起，这张表格将所有内容联系在一起。ID 字段实际上是用于识别汽车的唯一批号。

```
mysql> create table cars (id int(3) not null auto_increment primary key, 
    -> color int(3), brand int(3), model int(3));
Query OK, 0 rows affected (0.01 sec)

mysql> show columns from cars;
+-------+--------+------+-----+---------+----------------+
| Field | Type   | Null | Key | Default | Extra          |
+-------+--------+------+-----+---------+----------------+
| id    | int(3) | NO   | PRI | NULL    | auto_increment |
| color | int(3) | YES  |     | NULL    |                |
| brand | int(3) | YES  |     | NULL    |                |
| model | int(3) | YES  |     | NULL    |                |
+-------+--------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> insert into cars (color, brand, model) values (1,2,1), (3,1,2), (5,3,1), 
    -> (4,4,2), (2,2,3), (3,5,4), (4,1,3), (2,2,1), (5,2,3), (4,5,1);
Query OK, 10 rows affected (0.00 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> select * from cars;
+----+-------+-------+-------+
| id | color | brand | model |
+----+-------+-------+-------+
|  1 |     1 |     2 |     1 |
|  2 |     3 |     1 |     2 |
|  3 |     5 |     3 |     1 |
|  4 |     4 |     4 |     2 |
|  5 |     2 |     2 |     3 |
|  6 |     3 |     5 |     4 |
|  7 |     4 |     1 |     3 |
|  8 |     2 |     2 |     1 |
|  9 |     5 |     2 |     3 |
| 10 |     4 |     5 |     1 |
+----+-------+-------+-------+
10 rows in set (0.00 sec) 
```

这将为我们提供足够的数据（我希望）来涵盖下面不同类型连接的示例，并提供足够的数据以使它们有价值。

因此，老板想知道*他拥有的所有跑车的 ID*。

这是一个简单的两表连接。我们有一个标识模型的表和一个包含可用库存的表。如您所见，表格列中的数据与`model`我们拥有的表格列相关。现在，我们知道模型表的 ID 为for，所以让我们编写连接。`cars``models``cars``1``Sports`

```
select
    ID,
    model
from
    cars
        join models
            on model=ID 
```

所以这个查询看起来不错吧？我们已经确定了这两个表并包含了我们需要的信息，并使用了正确识别要连接的列的连接。

```
ERROR 1052 (23000): Column 'ID' in field list is ambiguous 
```

哦不！我们的第一个查询出错了！是的，而且是李子。你看，查询确实得到了正确的列，但其中一些列存在于两个表中，所以数据库对我们所指的实际列和位置感到困惑。有两种解决方案可以解决这个问题。第一个很好也很简单，我们可以用`tableName.columnName`它来准确地告诉数据库我们的意思，像这样：

```
select
    cars.ID,
    models.model
from
    cars
        join models
            on cars.model=models.ID

+----+--------+
| ID | model  |
+----+--------+
|  1 | Sports |
|  3 | Sports |
|  8 | Sports |
| 10 | Sports |
|  2 | Sedan  |
|  4 | Sedan  |
|  5 | 4WD    |
|  7 | 4WD    |
|  9 | 4WD    |
|  6 | Luxury |
+----+--------+
10 rows in set (0.00 sec) 
```

另一个可能更常用，称为表别名。此示例中的表具有漂亮而简短的简单名称，但输入类似`KPI_DAILY_SALES_BY_DEPARTMENT`的内容可能很快就会过时，因此一种简单的方法是给表起这样的昵称：

```
select
    a.ID,
    b.model
from
    cars a
        join models b
            on a.model=b.ID 
```

现在，回到请求。正如你所看到的，我们有我们需要的信息，但我们也有没有被要求的信息，所以我们需要在语句中包含一个 where 子句，以便只按照要求获得跑车。因为我更喜欢表别名方法而不是一遍又一遍地使用表名，所以我会从现在开始坚持使用它。

显然，我们需要在查询中添加 where 子句。`ID=1`我们可以通过或来识别跑车`model='Sports'`。由于 ID 已编入索引且主键（而且它的键入次数较少），让我们在查询中使用它。

```
select
    a.ID,
    b.model
from
    cars a
        join models b
            on a.model=b.ID
where
    b.ID=1

+----+--------+
| ID | model  |
+----+--------+
|  1 | Sports |
|  3 | Sports |
|  8 | Sports |
| 10 | Sports |
+----+--------+
4 rows in set (0.00 sec) 
```

答对了！老板很高兴。当然，作为老板，对他的要求从不满意，他看了看信息，然后说*我也想要颜色*。

好的，所以我们已经编写了查询的大部分内容，但是我们需要使用第三个表，它是颜色。现在，我们的主信息表`cars`存储了汽车颜色 ID，并链接回颜色 ID 列。因此，以与原始类似的方式，我们可以加入第三个表：

```
select
    a.ID,
    b.model
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
where
    b.ID=1

+----+--------+
| ID | model  |
+----+--------+
|  1 | Sports |
|  3 | Sports |
|  8 | Sports |
| 10 | Sports |
+----+--------+
4 rows in set (0.00 sec) 
```

该死的，尽管表已正确连接并且相关列已链接，但我们忘记从刚刚链接的新表中提取实际*信息。*

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
where
    b.ID=1

+----+--------+-------+
| ID | model  | color |
+----+--------+-------+
|  1 | Sports | Red   |
|  8 | Sports | Green |
| 10 | Sports | White |
|  3 | Sports | Black |
+----+--------+-------+
4 rows in set (0.00 sec) 
```

对，那是我们暂时离开的老板。现在，更详细地解释其中的一些内容。如您所见，`from`我们语句中的子句链接了我们的主表（我经常使用包含信息的表而不是查找表或维度表。查询在所有表都被切换时也可以正常工作，但是当我们会在几个月后回到这个查询来阅读它，所以通常最好尝试编写一个很好且易于理解的查询 - 直观地布置它，使用良好的缩进，以便一切都像可以。如果您继续教其他人，请尝试在他们的查询中灌输这些特征 - 特别是如果您要对他们进行故障排除。

以这种方式保持链接越来越多的表是完全可能的。

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=1 
```

虽然我忘记包含一个表，我们可能希望在语句中加入多个列，但`join`这里有一个示例。如果该`models`表具有特定品牌的模型，因此也有一个名为`brand`which 的列链接回`brands`该字段上的表`ID`，则可以这样做：

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
            and b.brand=d.ID
where
    b.ID=1 
```

可以看到，上面的查询不仅将连接的表链接到主`cars`表，还指定了已经连接的表之间的连接。如果不这样做，则结果称为笛卡尔连接 - 这是 dba 的坏话。笛卡尔连接是一种返回行的连接，因为信息没有告诉数据库如何限制结果，因此查询返回符合条件的*所有行。*

因此，举一个笛卡尔连接的例子，让我们运行以下查询：

```
select
    a.ID,
    b.model
from
    cars a
        join models b

+----+--------+
| ID | model  |
+----+--------+
|  1 | Sports |
|  1 | Sedan  |
|  1 | 4WD    |
|  1 | Luxury |
|  2 | Sports |
|  2 | Sedan  |
|  2 | 4WD    |
|  2 | Luxury |
|  3 | Sports |
|  3 | Sedan  |
|  3 | 4WD    |
|  3 | Luxury |
|  4 | Sports |
|  4 | Sedan  |
|  4 | 4WD    |
|  4 | Luxury |
|  5 | Sports |
|  5 | Sedan  |
|  5 | 4WD    |
|  5 | Luxury |
|  6 | Sports |
|  6 | Sedan  |
|  6 | 4WD    |
|  6 | Luxury |
|  7 | Sports |
|  7 | Sedan  |
|  7 | 4WD    |
|  7 | Luxury |
|  8 | Sports |
|  8 | Sedan  |
|  8 | 4WD    |
|  8 | Luxury |
|  9 | Sports |
|  9 | Sedan  |
|  9 | 4WD    |
|  9 | Luxury |
| 10 | Sports |
| 10 | Sedan  |
| 10 | 4WD    |
| 10 | Luxury |
+----+--------+
40 rows in set (0.00 sec) 
```

天哪，太丑了 但是，就数据库而言，这*正是*所要求的。在查询中，我们要求提供`ID`from`cars`和`model`from `models`。但是，因为我们没有指定*如何*连接这些表，所以数据库已经将第一个表中的*每一*行与第二个表中的*每一行进行了匹配。*

 *好的，所以老板回来了，他又想了解更多信息。*我想要相同的列表，但也包括 4WD*。

然而，这给了我们一个很好的借口来研究两种不同的方法来实现这一点。我们可以像这样在 where 子句中添加另一个条件：

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=1
    or b.ID=3 
```

虽然上面的内容可以很好地工作，但让我们以不同的方式看待它，这是展示`union`查询如何工作的一个很好的借口。

我们知道以下将返回所有跑车：

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=1 
```

以下将返回所有 4WD：

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=3 
```

因此，通过`union all`在它们之间添加一个子句，第二个查询的结果将附加到第一个查询的结果中。

```
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=1
union all
select
    a.ID,
    b.model,
    c.color
from
    cars a
        join models b
            on a.model=b.ID
        join colors c
            on a.color=c.ID
        join brands d
            on a.brand=d.ID
where
    b.ID=3

+----+--------+-------+
| ID | model  | color |
+----+--------+-------+
|  1 | Sports | Red   |
|  8 | Sports | Green |
| 10 | Sports | White |
|  3 | Sports | Black |
|  5 | 4WD    | Green |
|  7 | 4WD    | White |
|  9 | 4WD    | Black |
+----+--------+-------+
7 rows in set (0.00 sec) 
```

如您所见，首先返回第一个查询的结果，然后是第二个查询的结果。

在这个例子中，简单地使用第一个查询当然要容易得多，但`union`查询对于特定情况可能很好。它们是从不容易连接在一起的表中返回特定结果的好方法 - 或者就此而言*完全*不相关的表。然而，有一些规则需要遵循。

*   第一个查询的列类型必须与下面每个其他查询的列类型匹配。
*   第一个查询中的列名称将用于标识整个结果集。
*   每个查询中的列数必须相同。

现在，您可能[想知道](https://stackoverflow.com/questions/49925/what-is-the-difference-between-union-and-union-all)`union`使用和之间有什么区别`union all`。查询将`union`删除重复项，而`union all`不会。这确实意味着使用`union`over时性能会受到很小的影响，`union all`但结果可能是值得的——不过我不会推测这种事情。

在此说明中，可能值得注意的是此处的一些附加说明。

*   如果我们想对结果进行排序，我们可以使用 an`order by`但您不能再使用别名。在上面的查询中，附加 an`order by a.ID`将导致错误 - 就结果而言，调用列`ID`而不是`a.ID`- 即使在两个查询中都使用了相同的别名。
*   我们只能有一个`order by`语句，并且必须作为最后一个语句。

对于接下来的示例，我将在我们的表中添加一些额外的行。

我已添加`Holden`到品牌表中。我还在其中添加了一行`cars`，其`color`值为`12`- 在颜色表中没有引用。

好的，老板又回来了，大喊大叫——*我想要计算我们经营的每个品牌以及其中的汽车数量！`——典型的，我们刚刚进入讨论的有趣部分，老板想要更多的工作.

Rightyo，所以我们需要做的第一件事是获取可能品牌的完整列表。

```
select
    a.brand
from
    brands a

+--------+
| brand  |
+--------+
| Ford   |
| Toyota |
| Nissan |
| Smart  |
| BMW    |
| Holden |
+--------+
6 rows in set (0.00 sec) 
```

现在，当我们将它加入到我们的汽车表中时，我们得到以下结果：

```
select
    a.brand
from
    brands a
        join cars b
            on a.ID=b.brand
group by
    a.brand

+--------+
| brand  |
+--------+
| BMW    |
| Ford   |
| Nissan |
| Smart  |
| Toyota |
+--------+
5 rows in set (0.00 sec) 
```

这当然是一个问题——我们没有看到`Holden`我添加的可爱品牌的任何提及。

*这是因为连接会在两个*表中查找匹配的行。由于汽车类型中没有数据，`Holden`因此不会返回。这是我们可以使用`outer`连接的地方。这将返回一个表中的*所有*结果，无论它们是否在另一个表中匹配：

```
select
    a.brand
from
    brands a
        left outer join cars b
            on a.ID=b.brand
group by
    a.brand

+--------+
| brand  |
+--------+
| BMW    |
| Ford   |
| Holden |
| Nissan |
| Smart  |
| Toyota |
+--------+
6 rows in set (0.00 sec) 
```

现在我们有了这个，我们可以添加一个可爱的聚合函数来计算并让老板暂时离开我们的背。

```
select
    a.brand,
    count(b.id) as countOfBrand
from
    brands a
        left outer join cars b
            on a.ID=b.brand
group by
    a.brand

+--------+--------------+
| brand  | countOfBrand |
+--------+--------------+
| BMW    |            2 |
| Ford   |            2 |
| Holden |            0 |
| Nissan |            1 |
| Smart  |            1 |
| Toyota |            5 |
+--------+--------------+
6 rows in set (0.00 sec) 
```

就这样，老板偷偷溜走了。

现在，为了更详细地解释这一点，外连接可以是`left`or`right`类型。Left 或 Right 定义了*完全*包含哪个表。A`left outer join`将包含左侧表格中的所有行，而（您猜对了）a`right outer join`将右侧表格中的所有结果带入结果中。

一些数据库将允许从*两个*`full outer join`表中返回结果（无论是否匹配），但并非所有数据库都支持。

 *现在，我可能想在这个时间点，您想知道是否可以在查询中合并连接类型 - 答案是肯定的，您绝对可以。

```
select
    b.brand,
    c.color,
    count(a.id) as countOfBrand
from
    cars a
        right outer join brands b
            on b.ID=a.brand
        join colors c
            on a.color=c.ID
group by
    a.brand,
    c.color

+--------+-------+--------------+
| brand  | color | countOfBrand |
+--------+-------+--------------+
| Ford   | Blue  |            1 |
| Ford   | White |            1 |
| Toyota | Black |            1 |
| Toyota | Green |            2 |
| Toyota | Red   |            1 |
| Nissan | Black |            1 |
| Smart  | White |            1 |
| BMW    | Blue  |            1 |
| BMW    | White |            1 |
+--------+-------+--------------+
9 rows in set (0.00 sec) 
```

那么，为什么不是预期的结果呢？这是因为虽然我们选择了从汽车到品牌的外连接，但在颜色连接中没有指定它 - 因此特定连接只会返回两个表中匹配的结果。

这是可以得到我们预期结果的查询：

```
select
    a.brand,
    c.color,
    count(b.id) as countOfBrand
from
    brands a
        left outer join cars b
            on a.ID=b.brand
        left outer join colors c
            on b.color=c.ID
group by
    a.brand,
    c.color

+--------+-------+--------------+
| brand  | color | countOfBrand |
+--------+-------+--------------+
| BMW    | Blue  |            1 |
| BMW    | White |            1 |
| Ford   | Blue  |            1 |
| Ford   | White |            1 |
| Holden | NULL  |            0 |
| Nissan | Black |            1 |
| Smart  | White |            1 |
| Toyota | NULL  |            1 |
| Toyota | Black |            1 |
| Toyota | Green |            2 |
| Toyota | Red   |            1 |
+--------+-------+--------------+
11 rows in set (0.00 sec) 
```

正如我们所看到的，我们在查询中有两个外连接，结果按预期通过。

现在，你问的那些其他类型的连接怎么样？十字路口呢？

好吧，并非所有数据库都支持，`intersection`但几乎所有数据库都允许您通过连接（或至少结构良好的 where 语句）创建交集。

Intersection 是一种类似于`union`上述的连接类型 - 但不同之处在于*它只*返回由联合连接的各个查询之间相同（我的意思是相同）的数据行。只有在各个方面都相同的行才会被返回。

一个简单的例子是这样的：

```
select
    *
from
    colors
where
    ID>2
intersect
select
    *
from
    colors
where
    id<4 
```

虽然普通`union`查询将返回表中的所有行（第一个查询返回任何超过`ID>2`，第二个查询返回任何有`ID<4`），这将导致一个完整的集合，但相交查询只会返回`id=3`满足这两个条件的行匹配。

现在，如果您的数据库不支持`intersect`查询，则可以通过以下查询轻松完成上述操作：

```
select
    a.ID,
    a.color,
    a.paint
from
    colors a
        join colors b
            on a.ID=b.ID
where
    a.ID>2
    and b.ID<4

+----+-------+----------+
| ID | color | paint    |
+----+-------+----------+
|  3 | Blue  | Metallic |
+----+-------+----------+
1 row in set (0.00 sec) 
```

如果您希望使用本质上不支持交集查询的数据库在两个不同的表之间执行交集，则需要在表的*每一列*上创建连接。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2012-09-25T15:31:09.573

好的，我发现这篇文章很有趣，我想分享一些关于创建查询的知识。感谢这个**[Fluffeh](https://stackoverflow.com/users/1450077/fluffeh)**。其他可能读过这篇文章并可能觉得我错了的人可以 101% 自由地编辑和批评我的答案。（*老实说，我非常感谢纠正我的错误。*）

`MySQL`我将在标签中发布一些常见问题。

* * *

# **技巧 1（*匹配多个条件的行*）**

鉴于此架构

```
CREATE TABLE MovieList
(
    ID INT,
    MovieName VARCHAR(25),
    CONSTRAINT ml_pk PRIMARY KEY (ID),
    CONSTRAINT ml_uq UNIQUE (MovieName)
);

INSERT INTO MovieList VALUES (1, 'American Pie');
INSERT INTO MovieList VALUES (2, 'The Notebook');
INSERT INTO MovieList VALUES (3, 'Discovery Channel: Africa');
INSERT INTO MovieList VALUES (4, 'Mr. Bean');
INSERT INTO MovieList VALUES (5, 'Expendables 2');

CREATE TABLE CategoryList
(
    MovieID INT,
    CategoryName VARCHAR(25),
    CONSTRAINT cl_uq UNIQUE(MovieID, CategoryName),
    CONSTRAINT cl_fk FOREIGN KEY (MovieID) REFERENCES MovieList(ID)
);

INSERT INTO CategoryList VALUES (1, 'Comedy');
INSERT INTO CategoryList VALUES (1, 'Romance');
INSERT INTO CategoryList VALUES (2, 'Romance');
INSERT INTO CategoryList VALUES (2, 'Drama');
INSERT INTO CategoryList VALUES (3, 'Documentary');
INSERT INTO CategoryList VALUES (4, 'Comedy');
INSERT INTO CategoryList VALUES (5, 'Comedy');
INSERT INTO CategoryList VALUES (5, 'Action'); 
```

**问题**

查找至少属于*和*类别的*所有电影。* *`Comedy``Romance`*

 ***解决方案**

这个问题有时可能非常棘手。看起来像这样的查询将是答案：-

```
SELECT  DISTINCT a.MovieName
FROM    MovieList a
        INNER JOIN CategoryList b
            ON a.ID = b.MovieID
WHERE   b.CategoryName = 'Comedy' AND
        b.CategoryName = 'Romance' 
```

## [SQLFiddle 演示](http://sqlfiddle.com/#!2/b60cb/4)

这绝对是非常错误的，因为它不会产生*任何结果*。`CategoryName`对此的解释是，*每一行*只有一个有效值。例如，第一个条件返回*true*，第二个条件始终为 false。因此，通过使用`AND`运算符，两个条件都应该为真；否则，它将是错误的。另一个查询是这样的，

```
SELECT  DISTINCT a.MovieName
FROM    MovieList a
        INNER JOIN CategoryList b
            ON a.ID = b.MovieID
WHERE   b.CategoryName IN ('Comedy','Romance') 
```

## [SQLFiddle 演示](http://sqlfiddle.com/#!2/b60cb/2)

结果仍然不正确，因为它匹配到在 .*上至少有*一个匹配项的记录`categoryName`。**真正的解决方案** 是*计算每部电影的记录实例数*。实例数应与条件中提供的值的总数相匹配。

```
SELECT  a.MovieName
FROM    MovieList a
        INNER JOIN CategoryList b
            ON a.ID = b.MovieID
WHERE   b.CategoryName IN ('Comedy','Romance')
GROUP BY a.MovieName
HAVING COUNT(*) = 2 
```

## [SQLFiddle 演示（答案）](http://sqlfiddle.com/#!2/b60cb/3)

*   [关系划分的SQL](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)

* * *

# **Trick No. 2（*每项最大记录*）**

给定架构，

```
CREATE TABLE Software
(
    ID INT,
    SoftwareName VARCHAR(25),
    Descriptions VARCHAR(150),
    CONSTRAINT sw_pk PRIMARY KEY (ID),
    CONSTRAINT sw_uq UNIQUE (SoftwareName)  
);

INSERT INTO Software VALUES (1,'PaintMe','used for photo editing');
INSERT INTO Software VALUES (2,'World Map','contains map of different places of the world');
INSERT INTO Software VALUES (3,'Dictionary','contains description, synonym, antonym of the words');

CREATE TABLE VersionList
(
    SoftwareID INT,
    VersionNo INT,
    DateReleased DATE,
    CONSTRAINT sw_uq UNIQUE (SoftwareID, VersionNo),
    CONSTRAINT sw_fk FOREIGN KEY (SOftwareID) REFERENCES Software(ID)
);

INSERT INTO VersionList VALUES (3, 2, '2009-12-01');
INSERT INTO VersionList VALUES (3, 1, '2009-11-01');
INSERT INTO VersionList VALUES (3, 3, '2010-01-01');
INSERT INTO VersionList VALUES (2, 2, '2010-12-01');
INSERT INTO VersionList VALUES (2, 1, '2009-12-01');
INSERT INTO VersionList VALUES (1, 3, '2011-12-01');
INSERT INTO VersionList VALUES (1, 2, '2010-12-01');
INSERT INTO VersionList VALUES (1, 1, '2009-12-01');
INSERT INTO VersionList VALUES (1, 4, '2012-12-01'); 
```

**问题**

查找每个软件的最新版本。显示以下列：`SoftwareName`, `Descriptions`, `LatestVersion`（*来自 VersionNo 列*），`DateReleased`

**解决方案**

一些 SQL 开发人员错误地使用`MAX()`聚合函数。他们倾向于这样创作，

```
SELECT  a.SoftwareName, a.Descriptions,
        MAX(b.VersionNo) AS LatestVersion, b.DateReleased
FROM    Software a
        INNER JOIN VersionList b
            ON a.ID = b.SoftwareID
GROUP BY a.ID
ORDER BY a.ID 
```

## [SQLFiddle 演示](http://sqlfiddle.com/#!2/89929/2)

（由于没有在*子句**中指定一些非聚合列，大多数 RDBMS 会因此产生语法错误`group by`*）结果在每个软件上都产生了正确的结果，`LatestVersion`但显然`DateReleased`是不正确的。`MySQL`不支持`Window Functions`，`Common Table Expression`但正如一些 RDBMS 已经支持的那样。解决此问题的方法是创建一个在每个软件上`subquery`获得单个最大值`versionNo`，然后在其他表上连接的方法。

```
SELECT  a.SoftwareName, a.Descriptions,
        b.LatestVersion, c.DateReleased
FROM    Software a
        INNER JOIN
        (
            SELECT  SoftwareID, MAX(VersionNO) LatestVersion
            FROM    VersionList
            GROUP BY SoftwareID
        ) b ON a.ID = b.SoftwareID
        INNER JOIN VersionList c
            ON  c.SoftwareID = b.SoftwareID AND
                c.VersionNO = b.LatestVersion
GROUP BY a.ID
ORDER BY a.ID 
```

## [SQLFiddle 演示（答案）](http://sqlfiddle.com/#!2/89929/3)

* * *

就是这样。当我想起标签上的任何其他*常见问题解答*时，我会尽快发布另一个。`MySQL`感谢您阅读这篇小文章。我希望你至少能从中得到一点点知识。

**更新 1**

* * *

# **Trick No. 3（*查找两个ID之间的最新记录*）**

给定模式

```
CREATE TABLE userList
(
    ID INT,
    NAME VARCHAR(20),
    CONSTRAINT us_pk PRIMARY KEY (ID),
    CONSTRAINT us_uq UNIQUE (NAME)  
);

INSERT INTO userList VALUES (1, 'Fluffeh');
INSERT INTO userList VALUES (2, 'John Woo');
INSERT INTO userList VALUES (3, 'hims056');

CREATE TABLE CONVERSATION
(
    ID INT,
    FROM_ID INT,
    TO_ID INT,
    MESSAGE VARCHAR(250),
    DeliveryDate DATE
);

INSERT INTO CONVERSATION VALUES (1, 1, 2, 'hi john', '2012-01-01');
INSERT INTO CONVERSATION VALUES (2, 2, 1, 'hello fluff', '2012-01-02');
INSERT INTO CONVERSATION VALUES (3, 1, 3, 'hey hims', '2012-01-03');
INSERT INTO CONVERSATION VALUES (4, 1, 3, 'please reply', '2012-01-04');
INSERT INTO CONVERSATION VALUES (5, 3, 1, 'how are you?', '2012-01-05');
INSERT INTO CONVERSATION VALUES (6, 3, 2, 'sample message!', '2012-01-05'); 
```

**问题**

查找两个用户之间的最新对话。

**解决方案**

```
SELECT    b.Name SenderName,
          c.Name RecipientName,
          a.Message,
          a.DeliveryDate
FROM      Conversation a
          INNER JOIN userList b
            ON a.From_ID = b.ID
          INNER JOIN userList c
            ON a.To_ID = c.ID
WHERE     (LEAST(a.FROM_ID, a.TO_ID), GREATEST(a.FROM_ID, a.TO_ID), DeliveryDate)
IN
(
    SELECT  LEAST(FROM_ID, TO_ID) minFROM,
            GREATEST(FROM_ID, TO_ID) maxTo,
            MAX(DeliveryDate) maxDate
    FROM    Conversation
    GROUP BY minFROM, maxTo
) 
```

## [SQLFiddle 演示](http://sqlfiddle.com/#!2/b7bd1/1)

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2012-09-19T09:47:16.180

# 第 2 部分 - 子查询

好的，现在老板又闯进来了——*我想要一份我们所有带有该品牌的汽车的清单，以及我们拥有多少辆该品牌的汽车！*

这是一个很好的机会来使用我们的 SQL 好东西包中的下一个技巧 - 子查询。如果您不熟悉该术语，则子查询是在另一个查询中运行的查询。有许多不同的方式来使用它们。

对于我们的请求，让我们首先将一个简单的查询放在一起，列出每辆车和品牌：

```
select
    a.ID,
    b.brand
from
    cars a
        join brands b
            on a.brand=b.ID 
```

现在，如果我们想简单地获得按品牌分类的汽车数量，我们当然可以这样写：

```
select
    b.brand,
    count(a.ID) as countCars
from
    cars a
        join brands b
            on a.brand=b.ID
group by
    b.brand

+--------+-----------+
| brand  | countCars |
+--------+-----------+
| BMW    |         2 |
| Ford   |         2 |
| Nissan |         1 |
| Smart  |         1 |
| Toyota |         5 |
+--------+-----------+ 
```

那么，我们应该能够简单地将 count 函数添加到我们的原始查询中，对吧？

```
select
    a.ID,
    b.brand,
    count(a.ID) as countCars
from
    cars a
        join brands b
            on a.brand=b.ID
group by
    a.ID,
    b.brand

+----+--------+-----------+
| ID | brand  | countCars |
+----+--------+-----------+
|  1 | Toyota |         1 |
|  2 | Ford   |         1 |
|  3 | Nissan |         1 |
|  4 | Smart  |         1 |
|  5 | Toyota |         1 |
|  6 | BMW    |         1 |
|  7 | Ford   |         1 |
|  8 | Toyota |         1 |
|  9 | Toyota |         1 |
| 10 | BMW    |         1 |
| 11 | Toyota |         1 |
+----+--------+-----------+
11 rows in set (0.00 sec) 
```

可悲的是，不，我们不能那样做。原因是当我们添加汽车 ID（a.ID 列）时，我们必须将其添加到组中 - 所以现在，当 count 功能起作用时，每个 ID 只匹配一个 ID。

然而，这是我们可以使用子查询的地方——事实上，我们可以执行两种完全不同类型的子查询，它们将返回我们需要的相同结果。第一种是简单地将子查询放在`select`子句中。这意味着每次我们获取一行数据时，子查询都会运行，获取一列数据，然后将其弹出到我们的数据行中。

```
select
    a.ID,
    b.brand,
    (
    select
        count(c.ID)
    from
        cars c
    where
        a.brand=c.brand
    ) as countCars
from
    cars a
        join brands b
            on a.brand=b.ID

+----+--------+-----------+
| ID | brand  | countCars |
+----+--------+-----------+
|  2 | Ford   |         2 |
|  7 | Ford   |         2 |
|  1 | Toyota |         5 |
|  5 | Toyota |         5 |
|  8 | Toyota |         5 |
|  9 | Toyota |         5 |
| 11 | Toyota |         5 |
|  3 | Nissan |         1 |
|  4 | Smart  |         1 |
|  6 | BMW    |         2 |
| 10 | BMW    |         2 |
+----+--------+-----------+
11 rows in set (0.00 sec) 
```

和 Bam!，这对我们有用。如果你注意到了，这个子查询必须针对我们返回的每一行数据运行。即使在这个小例子中，我们也只有 5 个不同品牌的汽车，但子查询运行了 11 次，因为我们返回了 11 行数据。因此，在这种情况下，这似乎不是编写代码的最有效方式。

对于不同的方法，让我们运行一个子查询并假装它是一个表：

```
select
    a.ID,
    b.brand,
    d.countCars
from
    cars a
        join brands b
            on a.brand=b.ID
        join
            (
            select
                c.brand,
                count(c.ID) as countCars
            from
                cars c
            group by
                c.brand
            ) d
            on a.brand=d.brand

+----+--------+-----------+
| ID | brand  | countCars |
+----+--------+-----------+
|  1 | Toyota |         5 |
|  2 | Ford   |         2 |
|  3 | Nissan |         1 |
|  4 | Smart  |         1 |
|  5 | Toyota |         5 |
|  6 | BMW    |         2 |
|  7 | Ford   |         2 |
|  8 | Toyota |         5 |
|  9 | Toyota |         5 |
| 10 | BMW    |         2 |
| 11 | Toyota |         5 |
+----+--------+-----------+
11 rows in set (0.00 sec) 
```

好的，所以我们有相同的结果（排序略有不同 - 似乎数据库想要返回我们这次选择的第一列排序的结果） - 但正确的数字相同。

那么，两者之间有什么区别——我们什么时候应该使用每种类型的子查询呢？首先，让我们确保我们了解第二个查询是如何工作的。我们在查询的子句中选择了两个表`from`，然后编写了一个查询并告诉数据库它实际上是一个表——数据库对此非常满意。*使用此方法可能*有一些好处（以及一些限制）。最重要的是这个子查询运行了*一次*。如果我们的数据库包含大量数据，那么很可能比第一种方法有很大的改进。但是，当我们将其用作表格时，我们必须引入额外的数据行 - 以便它们实际上可以连接回我们的数据行。我们还必须确保有*足够的*如果我们要像上面的查询那样使用简单的连接，则可以使用数据行。如果您还记得，联接只会拉回联接两侧具有匹配数据*的*行。如果我们不小心，如果此子查询中没有匹配的行，这可能会导致无法从汽车表中返回有效数据。

现在，回顾第一个子查询，也有一些限制。因为我们将数据拉回单行，所以我们*只能拉回*一行数据。查询子句中使用的子查询通常仅使用聚合函数，`select`例如`sum`、或其他类似的聚合函数。他们不必这样做*，*但这通常是他们的写作方式。`count``max`

 *所以，在我们继续之前，让我们快速看一下我们可以在哪里使用子查询。我们可以在`where`子句中使用它 - 现在，这个例子有点做作，因为在我们的数据库中，有更好的方法来获取以下数据，但它只是一个例子，让我们看看：

```
select
    ID,
    brand
from
    brands
where
    brand like '%o%'

+----+--------+
| ID | brand  |
+----+--------+
|  1 | Ford   |
|  2 | Toyota |
|  6 | Holden |
+----+--------+
3 rows in set (0.00 sec) 
```

这将为我们返回包含名称中字母的品牌 ID 和品牌名称列表（第二列仅用于向我们显示品牌）`o`。

现在，我们可以在 where 子句中使用这个查询的结果：

```
select
    a.ID,
    b.brand
from
    cars a
        join brands b
            on a.brand=b.ID
where
    a.brand in
        (
        select
            ID
        from
            brands
        where
            brand like '%o%'
        )

+----+--------+
| ID | brand  |
+----+--------+
|  2 | Ford   |
|  7 | Ford   |
|  1 | Toyota |
|  5 | Toyota |
|  8 | Toyota |
|  9 | Toyota |
| 11 | Toyota |
+----+--------+
7 rows in set (0.00 sec) 
```

如您所见，即使子查询返回三个品牌 ID，我们的汽车表也只有其中两个的条目。

在这种情况下，为了进一步了解细节，子查询就像我们编写了以下代码一样工作：

```
select
    a.ID,
    b.brand
from
    cars a
        join brands b
            on a.brand=b.ID
where
    a.brand in (1,2,6)

+----+--------+
| ID | brand  |
+----+--------+
|  1 | Toyota |
|  2 | Ford   |
|  5 | Toyota |
|  7 | Ford   |
|  8 | Toyota |
|  9 | Toyota |
| 11 | Toyota |
+----+--------+
7 rows in set (0.00 sec) 
```

同样，您可以看到从数据库返回时子查询与手动输入是如何改变行的顺序的。

当我们讨论子查询时，让我们看看我们还能用子查询做什么：

*   您可以将子查询放在另一个子查询中，依此类推。有一个限制取决于您的数据库，但缺少一些疯狂和疯狂的程序员的递归函数，大多数人永远不会达到这个限制。
*   您可以将多个子查询放入单个查询中，在子句中放置一些子查询，在`select`子句中放置一些子查询，在子句中放置`from`更多子查询`where`- 请记住，您放入的每个子查询都会使查询更加复杂，并且可能需要更长的时间执行。

如果您需要编写一些高效的代码，可以通过多种方式编写查询并查看（通过计时或使用解释计划）哪个是获得结果的最佳查询。第一种可行的方法可能并不总是最好的方法。

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2012-09-20T08:01:53.630

# 第 3 部分 - 技巧和高效代码

# MySQL in() 效率

我想我会添加一些额外的内容，以获取出现的提示和技巧。

我看到的一个问题是我*如何从两个表中获取不匹配的行*，我看到最普遍接受的答案如下（基于我们的汽车和品牌表 -*霍顿*列为品牌，但未出现在汽车表中）：

```
select
    a.ID,
    a.brand
from
    brands a
where
    a.ID not in(select brand from cars) 
```

*是*的，它会起作用。

```
+----+--------+
| ID | brand  |
+----+--------+
|  6 | Holden |
+----+--------+
1 row in set (0.00 sec) 
```

但是它在某些数据库中效率*不高。*这是一个[指向 Stack Overflow 问题的链接，](https://stackoverflow.com/questions/1179231/sql-efficiency-where-in-subquery-vs-join-then-group)如果您想深入了解它，这里是一篇[极好的深度文章。](http://explainextended.com/2009/06/16/in-vs-join-vs-exists/)

简短的回答是，如果优化器不能有效地处理它，最好使用如下查询来获取不匹配的行：

```
select
    a.brand
from
    brands a
        left join cars b
            on a.id=b.brand
where
    b.brand is null

+--------+
| brand  |
+--------+
| Holden |
+--------+
1 row in set (0.00 sec) 
```

# 用子查询中的同一张表更新表

啊，另一个老歌但好歌 - 老*你不能在 FROM 子句中指定目标表“品牌”进行更新*。

MySQL 不允许您`update...`在同一个表上运行带有子选择的查询。现在，你可能会想，为什么不直接把它加到 where 子句中呢？但是，如果您只想在`max()`一堆其他行中更新带有日期的行怎么办？您不能在 where 子句中完全做到这一点。

```
update 
    brands 
set 
    brand='Holden' 
where 
    id=
        (select 
            id 
        from 
            brands 
        where 
            id=6);
ERROR 1093 (HY000): You can't specify target table 'brands' 
for update in FROM clause 
```

所以，我们不能这样做是吗？嗯，不完全是。有一个令人惊讶的大量用户不知道的偷偷摸摸的解决方法 - 尽管它确实包含一些您需要注意的黑客行为。

您可以将子查询粘贴在另一个子查询中，这会在两个查询之间留出足够的间隙，以便它可以工作。但是，请注意，将查询粘贴在事务中可能是最安全的 - 这将防止在查询运行时对表进行任何其他更改。

```
update 
    brands 
set 
    brand='Holden' 
where id=
    (select 
        id 
    from 
        (select 
            id 
        from 
            brands 
        where 
            id=6
        ) 
    as updateTable);

Query OK, 0 rows affected (0.02 sec)
Rows matched: 1  Changed: 0  Warnings: 0 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-09-22T08:23:09.400

您可以在 FROM 关键字中使用多个查询的概念。让我给你看一个例子：

```
SELECT DISTINCT e.id,e.name,d.name,lap.lappy LAPTOP_MAKE,c_loc.cnty COUNTY    
FROM  (
          SELECT c.id cnty,l.name
          FROM   county c, location l
          WHERE  c.id=l.county_id AND l.end_Date IS NOT NULL
      ) c_loc, emp e 
      INNER JOIN dept d ON e.deptno =d.id
      LEFT JOIN 
      ( 
         SELECT l.id lappy, c.name cmpy
         FROM   laptop l, company c
         WHERE l.make = c.name
      ) lap ON e.cmpy_id=lap.cmpy 
```

您可以使用任意数量的表格。在必要的地方使用外部连接和联合，即使在表子查询中也是如此。

这是涉及尽可能多的表和字段的一种非常简单的方法。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-02-19T18:46:47.453

希望这使它在您阅读内容时找到表格：

**[jsfiddle](http://jsfiddle.net/1wzr8b05/)**

```
mysql> show columns from colors;                                                         
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+           
| id    | int(3)      | NO   | PRI | NULL    | auto_increment |
| color | varchar(15) | YES  |     | NULL    |                |
| paint | varchar(10) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+ 
```****

# css - 使用 PIE 在较少的 css 中为多个渐变添加 @argument

> ID：12475852
> 
> 赞同：0
> 
> 时间：2012-09-18T11:11:48.370
> 
> 标签：css, less, gradient

我有几个可以出现在按钮、框和页面中的网站所需的渐变。我想我会尝试 LESS CSS 以尽量减少样式表中的重复。

到目前为止，我有：

```
.gradient (@origin: bottom, @start: #000, @end: #333){
background: @start;
background: -webkit-gradient(linear, 0 0, 0 bottom, from(@end), to(@start));
background: -webkit-linear-gradient(@origin, @start, @end);
background: -moz-linear-gradient(@origin, @start, @end);
background: -ms-linear-gradient(@origin, @start, @end);
background: -o-linear-gradient(@origin, @start, @end);
background: linear-gradient(@origin, @start, @end);
-pie-background: linear-gradient(@origin, @start, @end);
behavior: url(/PIE.htc);
} 
```

我想使用类似于这个例子的@argument，所以我可以调用不同的颜色：

```
.box-shadow (@x: 0, @y: 0, @blur: 1px, @color: #000) {
box-shadow: @arguments;
-moz-box-shadow: @arguments;
-webkit-box-shadow: @arguments;
}
.box-shadow(2px, 5px); 
```

这可以用十六进制或 RGB (@color: 0 ??) 来完成，还是我在这里有错误的逻辑来解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T15:47:07.407

您不能这样做，因为正如您在代码中看到的那样，某些浏览器对 css 渐变使用不同的语法，并且使用 @arguments 变量会为某些浏览器创建无效的 css。

您可以做的是“分组”使用相同语法的属性并稍微缩短您的代码：

```
.gradient (@origin: bottom, @start: #000, @end: #333){
    background: @start;
    background: -webkit-gradient(linear, 0 0, 0 bottom, from(@end), to(@start));
    background: -webkit-linear-gradient(@arguments);
    background: -moz-linear-gradient(@arguments);
    background: -ms-linear-gradient(@arguments);
    background: -o-linear-gradient(@arguments);
    background: linear-gradient(@arguments);
    -pie-background: linear-gradient(@arguments);
    behavior: url(/PIE.htc);
} 
```

# java - 按 csv 字符串值对地图进行排序

> ID：12475853
> 
> 赞同：0
> 
> 时间：2012-09-18T11:11:55.797
> 
> 标签：java

下面的地图包含字符串键和字符串值。这些值是逗号分隔的字符串。Map 如何按此 String 的第四个元素排序？

所以这张地图：

```
key1    a,b,c,1
key2    a,b,c,4
key3    a,b,c,3
key4    a,b,c,2 
```

变成：

```
key2    a,b,c,4
key3    a,b,c,3
key4    a,b,c,2
key1    a,b,c,1 
```

这可以使用 Map 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:10:59.793

您可以按如下方式实现 Comparator ：

小心“TRICK”标签，我在这里解释了“trick”

```
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

public class SortedMap{

public static void main(String[] args) {

    Map<String,String> inputMap = new HashMap<String,String>();
    inputMap.put("key1", "a,b,c,1");
    inputMap.put("key2", "a,b,c,4");
    inputMap.put("key3", "a,b,c,3");
    inputMap.put("key4", "a,b,c,2");

    // raw input
    System.out.println("Input");
    for (Map.Entry entry : inputMap.entrySet()) {
        System.out.println("Key: "+entry.getKey()+", value: "+entry.getValue());
    }

    Map<String,String> sortedMap = mySort(inputMap);

    System.out.println("Output");
    for (Map.Entry entry : sortedMap.entrySet()) {
        System.out.println("Key: "+entry.getKey()+", value: "+entry.getValue());
    }
}

private static Map mySort(Map inputMap) {
    // to list
    List list = new LinkedList(inputMap.entrySet());

    Collections.sort(list, new Comparator() {
            public int compare(Object o1, Object o2) {
            String v1 = (String)((Map.Entry) (o1)).getValue();
            // split by ,
            String[] v1Split = v1.split(",");
            // get last value
            String v1Value = v1Split[v1Split.length-1];

            // compact syntax
            String v2Value = (((String)((Map.Entry) (o2)).getValue()).split(","))[3];

            // TRICK: -1 for reverse
            return v1Value.compareTo(v2Value) * -1;
            }
            });

    // TRICK: to LinkedMap
    Map sortedMap = new LinkedHashMap();
    for (Iterator it = list.iterator(); it.hasNext();) {
        Map.Entry entry = (Map.Entry)it.next();
        sortedMap.put(entry.getKey(), entry.getValue());
    }
    return sortedMap;
}   
} 
```

运行后，我得到了这个输出：

```
Input
Key: key4, value: a,b,c,2
Key: key3, value: a,b,c,3
Key: key2, value: a,b,c,4
Key: key1, value: a,b,c,1
Output
Key: key2, value: a,b,c,4
Key: key3, value: a,b,c,3
Key: key4, value: a,b,c,2
Key: key1, value: a,b,c,1 
```

# c# - 两个 WCF 方法之间的全局变量

> ID：12475855
> 
> 赞同：6
> 
> 时间：2012-09-18T11:12:01.687
> 
> 标签：c#, wcf

我在 WCF 服务中有两个方法说

```
Method1()
{
 _currentValue = 10;
}

Method2()
{
return _currentValue;
} 
```

我有一种情况，我需要在 Method1() 中设置一个值并在 Method2() 中读取它。

我尝试使用`static`类似的变量`public static int _currentValue`，我可以在 Method2() 中读取 Method1() 中设置的值。

但问题是，我希望这个变量像每个请求的单独实例变量一样做出反应。即，现在下面是问题

**浏览器 1：**

```
 - Method1() is called
    => sets _currentValue = 10;
 - Method2() is called
    => returns _currentValue = 10; 
```

**浏览器 2：**

```
 - Method2() is called
    => returns _currentValue = 10; 
```

实际上设置的值是浏览器 1 是静态的，所以在浏览器 2 中检索到相同的值。

我想要实现的是变量应该像每个请求的新实例一样（从每个浏览器调用时）。在这种情况下我应该使用什么？一个会议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T16:46:05.807

听起来您可能需要为 WCF 服务使用每个会话实例上下文模式。这将允许您在每个会话的基础上维护状态，因此服务实例中的成员变量将在来自同一代理实例的方法调用之间保持不变。因为每个用户都有自己的会话，所以服务实例的状态会因用户而异。

查看这篇文章了解更多信息：http: [//msdn.microsoft.com/en-us/magazine/cc163590.aspx#S2](http://msdn.microsoft.com/en-us/magazine/cc163590.aspx#S2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T11:24:20.780

您将需要一些相关机制，因为您有两个完全不同的会话调用不同的方法。所以我建议使用两个调用者都知道的私钥。

我有点不可能知道那个键是什么，因为我无法从你的问题中真正收集到任何东西，所以只有你知道，但简单的事实是你需要相关性。现在，一旦你确定他们可以使用什么，你就可以做这样的事情。

```
public class SessionState
{
    private Dictionary<string, int> Cache { get; set; }

    public SessionState()
    {
        this.Cache = new Dictionary<string, int>();
    }

    public void SetCachedValue(string key, int val)
    {
        if (!this.Cache.ContainsKey(key))
        {
            this.Cache.Add(key, val);
        }
        else
        {
            this.Cache[key] = val;
        }
    }

    public int GetCachedValue(string key)
    {
        if (!this.Cache.ContainsKey(key))
        {
            return -1;
        }

        return this.Cache[key];
    }
}

public class Service1
{
    private static sessionState = new SessionState();

    public void Method1(string privateKey)
    {
        sessionState.SetCachedValue(privateKey, {some integer value});
    }

    public int Method2(string privateKey)
    {
        return sessionState.GetCachedValue(privateKey);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T11:18:18.417

您已经创建了变量`static`，这就是导致问题的原因。 `static`意味着您的类的每个实例都共享该变量，但您真正需要的是在您的方法之外声明的变量，如下所示：

```
private int _currentValue;

Method1() 
{ 
    _currentValue = 10; 
} 

Method2() 
{ 
    return _currentValue; 
} 
```

该变量将针对您的类的每个实例分别进行评估 - 在给定用户的请求之间保留此值是一个单独的问题。（会话是一种可能的解决方案。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T08:16:44.577

看起来像一个旧线程，但如果有人仍然感兴趣，这可以通过要求 WCF 运行您的服务的单个实例来实现。将以下行（装饰器）添加到您的类 [ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)] 的定义中

如果您只希望同一会话的行为而不是跨客户端的行为，那么您可以通过以下服务行为将其标记为每个会话 [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession)]

另一个选项是每次调用，这是默认选项。[服务行为（InstanceContextMode = InstanceContextMode.PerCall）]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T07:55:07.380

WCF 提供了三种控制 WCF 服务实例的方法：

*   每次通话
*   会话
*   单实例

阅读本文，您将找到最佳解决方案

[WCF实例管理的三种方式](http://www.codeproject.com/Articles/86007/3-ways-to-do-WCF-instance-management-Per-call-Per?msg=4517179#xx4517179xx)

# r - 改变厚度中线 geom_boxplot()

> ID：12475865
> 
> 赞同：11
> 
> 时间：2012-09-18T11:12:32.313
> 
> 标签：r, ggplot2, boxplot

我想对 geom_boxplot() 做一些修改。因为我的箱线图有时真的很“小”（请参见[此处](https://www.dropbox.com/s/tnki63b7bofvz8b/boxplot.png)图形中的黄色和绿色分支），我想更加突出中位数。那么可以调整中线的粗细吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-18T11:42:43.057

这个解决方案在文档中并不明显，但幸运的是不需要我们编辑`ggplot2`. 挖了源码后`ggplot2`发现，中线的粗细是由`fatten`参数控制的。默认情况下`fatten`，值为 2：

```
require(reshape)
require(ggplot2)
cars_melt = melt(cars)

ggplot(aes(x = variable, y = value), data = cars_melt) + 
  geom_boxplot(fatten = 2) 
```

![在此处输入图像描述](../Images/4b64e21bc1d4ef1de490beb452795c29.png)

但是如果我们将值增加到例如 4，中线会变得更粗。

```
ggplot(aes(x = variable, y = value), data = cars_melt) + 
  geom_boxplot(fatten = 4) 
```

![在此处输入图像描述](../Images/f8ea9c3e9377b92005705c7bca9ee8c5.png)

# html - 创建静态水平滚动

> ID：12475866
> 
> 赞同：0
> 
> 时间：2012-09-18T11:12:33.920
> 
> 标签：html, css, mobile-browser

我正在尝试为登录页面开发水平滚动。我正在尝试我在[这里](http://codigofuente.org/scroll-horizontal-jquery-tutorial-jquery/)找到的信息。但我想做一些类似的东西，但不完全是……

在那个网页中，我们有两个元素： ![在此处输入图像描述](../Images/1587d21643a81a0cfa9ebf9135a62214.png) 我们可以看到我们有一个菜单和一个水平的框列表。此列表按预期工作：如果您按菜单上的链接，它会跳转到正确的框。如果您使用移动浏览器，它会用手左右滚动。

但是，当您使用移动浏览器向右滚动时，顶部的菜单会停留在图层的左侧，从 Web 的可见部分消失。如果您使用计算机浏览器执行此操作，则菜单始终位于左上角。

我希望菜单始终保持在顶部，即使我使用的是移动浏览器，所以我可以滚动，比如说，一些图像，而不会隐藏我网页的内容。

我该怎么做？

我希望我正确地解释了自己。如果您还认为有一种更简单的方法可以使滚动水平滚动，我愿意接受建议。

PS：我想要这样的结果： ![在此处输入图像描述](../Images/682a8b10fa5039644f6d70933a5c4dd2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:36:41.313

移动浏览器存在固定定位问题 - 请参阅[**这篇文章**](http://bradfrostweb.com/blog/mobile/fixed-position/)，该文章还提供了 JavaScript 解决方案列表。

# ios - iOS：如何检测音乐是否在任何背景音乐应用程序中播放？

> ID：12475867
> 
> 赞同：18
> 
> 时间：2012-09-18T11:12:33.397
> 
> 标签：ios, audio, background

目前，我的游戏可以正确处理在内置 iPod 应用程序中播放音乐时禁用其自己的 BGM，但它没有检测到诸如 Pandora 之类的应用程序何时播放音乐。

目前，在我的`applicationDidBecomeActive`方法中，我检查`[[MPMusicPlayerController iPodMusicPlayer] playbackState]`以确定是否正在播放音乐。什么相当于检查像 Pandora 这样的应用程序是否在后台播放音频？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-09-29T03:35:30.803

`AudioSessionGetProperty`（如 jake_hetfield 的回答中所述）自 iOS 7 起已弃用。

相反，试试这个使用[isOtherAudioPlaying](https://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html#//apple_ref/occ/instp/AVAudioSession/otherAudioPlaying)的单线：

```
BOOL isOtherAudioPlaying = [[AVAudioSession sharedInstance] isOtherAudioPlaying]; 
```

适用于 iOS 6+。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-18T11:22:36.080

看看[这个问题](https://stackoverflow.com/questions/9101190/ios-audio-recording-how-to-check-if-mic-playback-is-busy-before-taking-mic)

似乎您可以通过检查属性 kAudioSessionProperty_OtherAudioIsPlaying 来查看是否正在播放另一个音频，如下所示：

```
UInt32 propertySize, audioIsAlreadyPlaying=0;
propertySize = sizeof(UInt32);
AudioSessionGetProperty(kAudioSessionProperty_OtherAudioIsPlaying, &propertySize, &audioIsAlreadyPlaying); 
```

对此的补充可以是询问用户他/她是否想要游戏音乐或已经播放的声音/音乐。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-10T23:25:54.873

从 iOS 8 开始，应该使用 secondaryAudioShouldBeSilencedHint 属性：

```
/* Will be true when another application with a non-mixable audio session is playing audio.  Applications may use
this property as a hint to silence audio that is secondary to the functionality of the application. For example, a game app
using AVAudioSessionCategoryAmbient may use this property to decide to mute its soundtrack while leaving its sound effects unmuted.
Note: This property is closely related to AVAudioSessionSilenceSecondaryAudioHintNotification.
*/
@property(readonly) BOOL secondaryAudioShouldBeSilencedHint  NS_AVAILABLE_IOS(8_0); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-03-13T11:55:37.180

你可能想做这样的事情......

1.  创建一个类来处理您的音频设置说...“AudioManager”

2.  轮询布尔“isOtherAudioPlaying”......也许将其分配给您自己的布尔值。

```
import Foundation
import AVFoundation

class AudioManager {
    static let successBingSoundID: SystemSoundID = <Your System Sound ID in Int>
    static func playSystemSoundIfBackgroundSoundIsOff() {
        guard !AVAudioSession.sharedInstance().isOtherAudioPlaying else {return}
        AudioServicesPlaySystemSoundWithCompletion(successBingSoundID, nil)
    }
} 
```

用法：

```
AudioManager.playSystemSoundIfBackgroundSoundIsOff() 
```

# c# - 您可以在 linq 中评估或等效吗？

> ID：12475870
> 
> 赞同：1
> 
> 时间：2012-09-18T11:12:41.790
> 
> 标签：c#, linq, eval

如果我有问题编号列表

```
var questions =  new List<int> { 2, 4, 8 }; 
```

是否有可能在 linq 中进行类似操作的查询？

```
var results = new List<Answer>();

foreach (var qNum in questions)
{
   results.AddRange(Answers.Where(x => eval(x.Question+qNum) == "Yes"));
} 
```

所以这将查找 x.Question2、x.Question4 和 x.Question8 的答案。

## 附录

目前我正在这样做：

```
 var questionAnswers = new List<Answer>();
var Q2 = Questions.Where (x => x.MainQ2.ToUpper() == "NO")
    .Select(x => new Answer { QuestionNumber = 2, AnswerText = x.MainTextQ2, User_Id = x.User_Id });

var Q4 = Questions.Where (x => x.MainQ4.ToUpper() == "NO")
    .Select(x => new Answer { QuestionNumber = 4, AnswerText = x.MainTextQ4, User_Id = x.User_Id });

var Q8 = Questions.Where (x => x.MainQ8.ToUpper() == "NO")
    .Select(x => new Answer { QuestionNumber = 8, AnswerText = x.MainTextQ8, User_Id = x.User_Id });

questionAnswers.AddRange(Q2);
questionAnswers.AddRange(Q4);
questionAnswers.AddRange(Q8);

questionAnswers.GroupBy (a => a.QuestionNumber).Dump();

public class Answer
{
    public int QuestionNumber {get;set;}
    public string AnswerText {get;set;}
    public string User_Id {get;set;}
} 
```

非常感谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:19:53.127

您*可以*使用 in 的方法手动构建一个访问必要属性的表达式[`Expression`](http://msdn.microsoft.com/en-us/library/bb356138.aspx)并将其传递给`Where`（如果 results 确实是 an `IEnumerable`而不是 an ，则可能首先编译它`IQueryable`）。

**[看到它在行动](http://ideone.com/8sJpx)**。

但你*为什么*要这样做？将要访问的值放在集合中比将它们放在单独的属性中要好得多。也许您应该改进模型，以便根本不需要解决这个问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T12:38:05.113

您可以使用 Dynamic.cs AKA DynamicQuery AKA [Dynamic Expression API](http://nuget.org/packages/DynamicQuery)

使用它，您可以输入一个字符串来代替 where 表达式：

```
Answers.Where("Question"+qNum+"=\"Yes\"") 
```

在后台，它将创建类似于 Jon 的答案的东西，即动态创建的表达式，它应该适合大多数 LINQ 提供程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:15:38.787

是的，但不是直接！

`x.Question`应该评估为一个字符串数组，（或者也许`IDictionary<int,string>`）然后你就可以做到：

```
var results = new List<Answers>();

foreach (var qNum in questions)
{
   results.AddRange(Answers.Where(x => x.Question[qNum] == "Yes"));
} 
```

# android - 安卓倒计时时间

> ID：12475873
> 
> 赞同：7
> 
> 时间：2012-09-18T11:12:47.000
> 
> 标签：android, timer, countdowntimer

我一直在使用 android 倒计时计时器示例来创建某个日期的倒计时。

```
Time TimerSet = new Time();
        TimerSet.set(20, 8, 2012); //day month year
        TimerSet.normalize(true);
        long millis = TimerSet.toMillis(true);

        Time TimeNow = new Time();
        TimeNow.setToNow(); // set the date to Current Time
        TimeNow.normalize(true);
        long millis2 = TimeNow.toMillis(true);

        long millisset = millis - millis2; //subtract current from future to set the time remaining

        final int smillis = (int) (millis); //convert long to integer to display conversion results
        final int smillis2 = (int) (millis2);

        new CountDownTimer(millisset, 1000) {
            public void onTick(long millisUntilFinished) {

                // decompose difference into days, hours, minutes and seconds 
                int weeks = (int) ((millisUntilFinished / 1000) /
                        604800);
                int days = (int) ((millisUntilFinished / 1000) / 86400);
                int hours = (int) (((millisUntilFinished / 1000) - (days
                        * 86400)) / 3600);
                int minutes = (int) (((millisUntilFinished / 1000) - ((days
                        * 86400) + (hours * 3600))) / 60);
                int seconds = (int) ((millisUntilFinished / 1000) % 60);
                int millicn = (int) (millisUntilFinished / 1000);

                w.setText(" " +weeks);
                d.setText(" " +days);
                h.setText(" " +hours);
                m.setText(" " +minutes);
                s.setText(" " +seconds);
                mTextField.setText(smillis + " " + smillis2 + " " +
                        millicn + "Time remaining: " +weeks +"weeks " +days + " days " + hours
                        + " hours: " + minutes+ " minutes: "
                        + seconds + " seconds: " );

            }

            public void onFinish() {
                mTextField.setText("done!");
            }
        }.start(); 
```

我想知道如何设置时间和日期？目前它正持续到午夜。我希望是 15:00

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T11:52:26.570

这是你的问题：

```
timerSet.set(20, 8, 2012); //day month year 
```

这会设置未来的日期，但不会设置未来的时间（相反，它将布尔值设置`allDay`为 true），因此默认为 00:00。

从[安卓 API](http://developer.android.com/reference/android/text/format/Time.html#set%28int,%20int,%20int,%20int,%20int,%20int%29)：

```
set(int second, int minute, int hour, int monthDay, int month, int year) 
```

所以试试

```
timerSet.set(0,0,15,20,8,2012) 
```

2012 年 8 月 20 日 15:00。

# hibernate - 如何清除 JPQL 中的集合关联？

> ID：12475875
> 
> 赞同：2
> 
> 时间：2012-09-18T11:12:53.683
> 
> 标签：hibernate, jpa-2.0

考虑以下 JPQL 查询：

```
UPATE FOO f SET f.bars = NULL 
```

运行此语句将产生异常：

```
java.lang.IllegalArgumentException: org.hibernate.QueryException: collections not assignable in update statements [UPATE FOO f SET f.bars = NULL ] 
```

我想要做的是在*一个*声明中切断FOO 和 BAR 之间的*所有关联。*而不是遍历每个 FOO 以将条集合设置为空。那要快得多。

不幸的是，该关联是单向的——因此 Bar 实体中没有*foo*属性。因此 JPQL 可以清除关联的另一端。

调用 NEW 也不起作用：

```
UPATE FOO f SET f.bars = NEW java.util.ArrayList() 
```

这会导致不同的异常：

```
java.lang.IllegalArgumentException: node to traverse cannot be null! 
```

很明显，JPA/Hibernate 不允许将集合关联设置为 null。但也许这里有人知道解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:05:22.970

对集合运行 clear 假设删除所有关系。您不能在 HQL 中执行此操作，但使用 session.get 将有助于提高性能。看到这个[帖子](https://stackoverflow.com/questions/1201690/is-it-possible-to-bulk-delete-from-a-many-many-association-with-hql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:51:36.837

JPQL 更新和删除查询仅适用于单个实体类的实体，因此您尝试实现的目标是不可能的。但是，正如 user1495181 建议的那样，您可以在收集时调用 clear。当实体管理器在事务结束时被刷新时，所有链接更新（这里链接被删除）语句将被添加到准备好的语句批处理中并发送到数据库。

# java - 用什么？以 XQuery/Saxon 作为平台集成前端 Web 应用程序？

> ID：12475876
> 
> 赞同：1
> 
> 时间：2012-09-18T11:13:00.573
> 
> 标签：java, php, gwt, xquery, saxon

作为 XQuery 和 Saxon 的新手，我继承了数百个 XQuery 模块来分析自动回归测试结果文件。`.txt`每个测试用例有一个测试结果文件。`.XQ`每个回归测试用例还有一个 XQuery模块。

基本上，每个 XQuery 模块`.XQ`都将一组以 XML 格式编码的原始测试数据作为输入，运行分析并生成一个 HTML 表，显示 PASS/FAIL 类型的结果。

目前对该套件的控制是通过一组 DOS`.BAT`文件，每个测试用例一个。在每个内部`.BAT`，外部解析器`.exe`将原始测试结果文件从`.txt`格式编码为`.xml`格式，然后使用`Saxon.jar`处理器运行测试用例的特定 XQuery 模块。'.bat' 文件通过启动资源管理器实例来完成，以显示包含结果表的最终 HTML 文件。

本质上，上述过程非常手动，需要使用 .BAT 文件单独运行每个案例。我需要一个改进的体系结构，以便使用我目前拥有的一组 XQuery 模块来控制和呈现对这些测试结果文件的分析。执行分析的过程将涉及

*   `.txt`以格式加载/存储一组原始测试结果文件
*   使用外部解析器将原始测试结果文件转换为 XML`.exe`
*   使用 Saxon 启动 XQuery 模块套件以分析`.xml`结果文件
*   产生显示列表结果

所以我的问题是为了实现上述过程的集成，假设我替换了`.bat`文件，我应该考虑哪些理想的工具可以连接到底层的 XQuery/Saxon 引擎？

例如 - 我的主要想法是运行一个带有 UI 的本地 Apache 实例来控制一切？我需要快速构建它，那么什么样的技术可以构建一个与 Saxon 配合得很好的 Web 应用 PHP/Java/Ruby/GWT？其他人都做什么？

我知道一个高级别的问题，所以可能会有不止一个答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:31:16.493

从 .bat 文件为每个测试运行一个新的 Saxon 实例肯定是非常低效的——它会导致初始化 Java VM 的大量开销。

我们使用 Java 编写的测试驱动程序（我们实际分发）执行相同的过程，该驱动程序包含您在 bat 文件中拥有的控制逻辑，通过 s9api API 调用 Saxon（尽管如果您想使其更便携，您可以使用 XQJ ）。我们以 XML 而不是 HTML 生成结果，因为它更易于分析，并且我们总是可以在必要时呈现结果以供浏览器查看 - 尽管通常我们只查看 XML。还有一个与 Swing UI 一起运行的版本，但我很少使用那个版本。

如果我从今天开始，我可能会考虑使用 XProc 编写这样的测试驱动程序。

# java - 避免 ”。” 和 FTP 中的“..”目录

> ID：12475882
> 
> 赞同：0
> 
> 时间：2012-09-18T11:13:17.507
> 
> 标签：java

当我使用 Apache commons API 检索 FTP 文件时，我得到“。” 和“..”所有目录中的目录，包括子目录。我怎样才能避免这两个目录？有人可以建议我吗？

我的代码是：

```
client.changeWorkingDirectory("/");
String[] names = client.listNames();
for (String name : names) {
System.out.println("File Name = " + name);
}
FTPFile[] ftpFiles = client.listFiles(); // Want to eliminate "." and ".." files 

output: 
File Name = .
File Name = ..
File Name = .ftpquota
File Name = file1
File Name = file2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:16:21.470

您只需将它们过滤掉（它们分别代表*当前*目录和*父*目录，FTP 会自动向您报告）。

也许使用 Apache Commons Collections[过滤](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html#filter%28java.util.Collection,%20org.apache.commons.collections.Predicate%29)机制？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:24:42.817

您可以使用[`FTPFileFilter`](http://commons.apache.org/net/api-3.1/org/apache/commons/net/ftp/FTPFileFilter.html)api
`listFiles(String pathname, FTPFileFilter filter)`
在您的`FTPFileFilter`类中检查是否`FTPFile.isDirectory()`并检查名称。

# svn - 为什么svn不允许带有子目录的标签？

> ID：12475884
> 
> 赞同：1
> 
> 时间：2012-09-18T11:13:20.127
> 
> 标签：svn, tags, subdirectory

在**svn 1.6**中，当我尝试基于特定修订号创建标签时，由于路径故障，乌龟失败。

eg:`${svn_url}/tags/`为空，没有创建先前的标签。

我想创建一个这样的：`${svn_url}/tags/MyProject/R1.0`

svn 返回错误信息：`Error: '.../tags/MyProject/R1.0' path not found`

现在，如果我首先在`MyProject`级别创建一个标签，然后在该标签上创建另一个标签`MyProject/R1.0`。但是当我使用`MyProject`.

这是一个已知的不受支持的命令还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:27:35.520

在 Subversion 中，标签通常放置在`tags`项目存储库根目录正下方的目录中。因此，您需要创建标签路径的所有元素。假设`${svn_url}/tags`存在于您的存储库中：

```
svn mkdir ${svn_url}/tags/MyProject -m "MyProject directory"
svn copy ${svn_url}/trunk/MyProject ${svn_url}/tags/MyProject/R1.0 -m"R1.0 branch" 
```

# symfony - Symfony2 设置

> ID：12475890
> 
> 赞同：5
> 
> 时间：2012-09-18T11:13:41.160
> 
> 标签：symfony, php, suhosin, phar

我正在尝试设置示例 Symfony2 项目，如下所示 [http://symfony.com/doc/current/quick_tour/the_big_picture.html](http://symfony.com/doc/current/quick_tour/the_big_picture.html)

访问 config.php 后我有这个：

```
Major problems have been detected and must be fixed before continuing:
Add "phar" to suhosin.executor.include.whitelist in php.ini*. 
```

我添加了这个：

```
suhosin.executor.include.whitelist="phar" 
```

进入 php.ini，但 config.php 仍然显示相同的消息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T16:16:15.680

1) 检查您是否编辑了正确的 php.ini，通常一个 PHP 安装有多个 php.ini（一个用于 CGI，一个用于 CLI，一个用于 APACHE2）。看看`/etc/php5`例如。

2) 检查 phpinfo() 是否考虑了该参数。

3) 参考这篇博文： [[已解决] symfony 2 主要问题 已检测到主要问题，必须修复才能继续：将“phar”添加到 php.ini* 中的 suhosin.executor.include.whitelist 中。](http://www.nitesh.com.np/php/solved-symfony-2-major-problems-major-problems-have-been-detected-and-must-be-fixed-before-continuing-add-phar-to-suhosin-executor-include-whitelist-in-php-ini/)

该帖子建议确保安装 suhosin

```
sudo apt-get install php5-suhosin 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-20T11:41:04.653

我有同样的问题。

你所做的是对的，正如 skonsoft 所说，你应该检查你是否安装了 suhosin，然后在你的 php.ini 或 conf.d/suhosin.ini 中添加“phar”

我也这样做了，问题仍然存在

我在[这里](http://forum.symfony-project.org/viewtopic.php?f=32&t=44936)找到了解决方案，这是我的 libxml2 库的问题

> 我现在已经解决了这个问题。
> 
> 追踪到 libxml2 不兼容。
> 
> 似乎 /vendor/symfony/src/Symfony/Component/DependencyInjection/Loader/XmlFileLoader.php 不喜欢 libxml2-2.6.22。升级到 2.8.0 已修复它 - 需要重新编译 PHP 以获取新的 libxml2。
> 
> 希望这对某人有帮助！

我正在使用 Debian 6

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T10:27:02.953

我遇到了这个问题，不得不重新启动以下：

/etc/init.d/php-fcgi-vhost-name 重启

让 ini 行更改可见

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-27T15:59:35.167

为 php 安装 suhosin 包后，

```
sudo apt-get install php5-suhosin 
```

对于 cli，在 debian 中添加**suhosin.ini**而不是 php.ini，位于：/etc/php5/cli/conf.d/suhosin.ini

```
suhosin.executor.include.whitelist="phar" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-23T20:58:37.973

我在 cPanel 服务器中遇到过这个问题。我所做的是：

*   使用 cPanel 脚本 /scripts/phpextensionmgr 重新安装 suhosin 卸载 PHPSuHosin；/scripts/phpextensionmgr 安装 PHPSuHosin

*   如果安装正确，那么您将得到类似

```
寻找 。-name \*.gcno -o -name \*.gcda | xargs rm -f
寻找 。-name \*.lo -o -name \*.o | xargs rm -f
寻找 。-name \*.la -o -name \*.a | xargs rm -f
寻找 。-名称\*.so | xargs rm -f
寻找 。-name .libs -a -type d|xargs rm -rf
寻找 。-名称\*.1 | xargs rm -f
rm -f libphp.la 模块/* 库/*
SuHosin 扩展，版本 suhosin-0.9.36，为 php 版本 5.4 激活

```

*   然后加

    ```
    suhosin.executor.include.whitelist="phar"
    ```

    进入 /usr/local/lib/php.ini 文件
*   重启阿帕奇

应该修好了..!!!

# android - Android Media Player 无法播放多个音频文件

> ID：12475891
> 
> 赞同：2
> 
> 时间：2012-09-18T11:13:43.857
> 
> 标签：android, listview, android-listview, android-mediaplayer, custom-adapter

我创建了一个列表视图，其中包含由 ImageView 标记定义的图像列表。当用户单击列表视图中的每个图像时，我想播放与该图像关联的音频。当我点击第一张图片时，使用下面的代码，媒体播放器被初始化并播放音频。但是，当我第二次单击同一图像以再次播放音频时，应用程序崩溃并出现 IllegalStateException，其日志如日志文件中所示。所以我认为我的媒体播放器状态有问题，但不确定。

如果我从列表视图图像转到另一个活动并在该活动中播放音频然后返回到列表视图并单击另一个图像播放音频，我有这段代码工作，但我不想这样做，因为创建一个每次选择图像时的 mediaPlayer 对象可能不利于记忆，我认为我想要做的应该是可能的。

我有一些使用媒体控制器控制媒体播放器的基本方法，如果我在触摸屏幕时将其置于不同的活动中，但 ontouch 事件也不再响应，则通常会出现这种情况。理想情况下，而不是单击图像来停止媒体播放器，我想调出媒体控制器来控制音频。

如果音频已经在播放并且我再次单击图像，我添加了一些代码来检查音频是否正在播放，然后释放并停止媒体播放器，但这并没有解决任何问题。我已经把它留在了日志中，其中包含这段代码。

我正在使用的手机的 sdk 为 4.0.4。我正在 Eclipse 中开发。

提前致谢。

下面是我的活动文件，它在收到 onclick 事件时播放音频。

```
package com.example.android.htc.test;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import android.app.ListActivity;
import android.content.res.AssetFileDescriptor;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnPreparedListener;
import android.os.Bundle;
import android.os.Handler;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.widget.AdapterView;
import android.widget.MediaController;

public class AudioPlayer extends ListActivity implements OnPreparedListener, MediaController.MediaPlayerControl {
  private static final String TAG = "AudioPlayer";

  public static final String AUDIO_FILE_NAME = "audioFileName";

  private MediaPlayer mediaPlayer;
  private MediaController mediaController;
  private String audioFile;
  private qAyatAdapter m_adapter;

  private Handler handler = new Handler();

  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_q_sur);

    m_adapter = new qAyatAdapter(this, R.layout.row, getAyats());
    setListAdapter(m_adapter);

    mediaPlayer = new MediaPlayer();
      mediaPlayer.setOnPreparedListener(this);

      mediaController = new MediaController(this);

  getListView().setOnItemClickListener(new AdapterView.OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position,
                long id) {

            switch(position) {
                case 0:
                    try {
                          //mediaPlayer.setDataSource(audioFile);
                        if(isPlaying()) {
                            mediaPlayer.stop();
                            mediaPlayer.release();
//I have tried with this line commented out too but still get the exception the log     files for both are included below
                            mediaPlayer.reset();
                        }

                            AssetFileDescriptor afd = getResources().openRawResourceFd(R.raw.ikhlas);                           
                            mediaPlayer.setDataSource(afd.getFileDescriptor(),afd.getStartOffset(),afd.getDeclaredLength());      
                            mediaPlayer.prepareAsync();                     

                        } catch (IOException e) {
                          Log.e(TAG, "Could not open file " + audioFile + " for playback.", e);
                        }

                case 1:

                default:
                    break;
            }

        }

});

//  audioFile = this.getIntent().getStringExtra(AUDIO_FILE_NAME);
//  ((TextView)findViewById(R.id.now_playing_text)).setText(audioFile);

  }

  @Override
  protected void onStop() {
    super.onStop();
    mediaController.hide();
    mediaPlayer.stop();
    mediaPlayer.release();
  }

  @Override
  public boolean onTouchEvent(MotionEvent event) {
    //the MediaController will hide after 3 seconds - tap the screen to make it appear again
    mediaController.show();
    return false;
  }

  //--MediaPlayerControl methods----------------------------------------------------
  public void start() {
    mediaPlayer.start();
  }

  public void pause() {
    mediaPlayer.pause();
  }

  public int getDuration() {
    return mediaPlayer.getDuration();
  }

  public int getCurrentPosition() {
    return mediaPlayer.getCurrentPosition();
  }

  public void seekTo(int i) {
    mediaPlayer.seekTo(i);
  }

  public boolean isPlaying() {
    return mediaPlayer.isPlaying();
  }

  public int getBufferPercentage() {
    return 0;
  }

  public boolean canPause() {
    return true;
  }

  public boolean canSeekBackward() {
    return true;
  }

  public boolean canSeekForward() {
    return true;
  }
  //--------------------------------------------------------------------------------

  public void onPrepared(MediaPlayer mediaPlayer) {
        Log.d(TAG, "onPrepared");
        mediaController.setMediaPlayer(this);
        mediaController.setAnchorView(findViewById(R.id.main_q_audio_view));
        mediaPlayer.start();
        handler.post(new Runnable() {
          public void run() {
            mediaController.setEnabled(true);
            mediaController.show();
          }
        });
      }

  private List<qAyat> getAyats() {
      List<qAyat> ayats = new ArrayList<qAyat>();
      ayats.add(new qAyat("1.2", "hello"));
      ayats.add(new qAyat("1.3", "Goodbye"));
      return ayats;
  }
} 
```

列表视图的父布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main_q_audio_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
    android:id="@+id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"/>

</LinearLayout> 
```

这是我的 row.xml 布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:padding="6dip">
        <ImageView
            android:id="@+id/q_ayat"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:gravity="center_vertical"
            />
        <TextView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_weight="1" 
            android:id="@+id/translation"
            android:singleLine="true"
            android:ellipsize="marquee"
        />
</LinearLayout> 
```

我已经包含了两个日志文件。第一个是使用 mediaplayer.reset() 方法

```
09-18 11:58:21.045: D/AudioSystem(32211): AudioSystem::get_audio_flinger() in at 53
09-18 11:58:21.045: D/AudioSystem(32211): gLock get at 55
09-18 11:58:21.045: D/AudioSystem(32211): before defaultServiceManager() at 57
09-18 11:58:21.045: D/AudioSystem(32211): after defaultServiceManager() at 59
09-18 11:58:21.045: D/AudioSystem(32211): service got at 63
09-18 11:58:21.055: D/AudioSystem(32211): leave AudioSystem::get_audio_flinger() at 81
09-18 11:58:21.055: D/AudioSystem(32211): AudioSystem::get_audio_flinger() in at 53
09-18 11:58:21.055: D/AudioSystem(32211): gLock get at 55
09-18 11:58:21.055: D/AudioSystem(32211): leave AudioSystem::get_audio_flinger() at 81
09-18 11:58:21.165: I/Adreno200-EGLSUB(32211): <ConfigWindowMatch:2078>: Format RGBA_8888.
09-18 11:58:21.395: D/OpenGLRenderer(32211): Flushing caches (mode 0)
09-18 11:58:21.395: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x53893000 size:13619200 offset:12083200
09-18 11:58:21.395: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x54590000 size:15155200 offset:13619200
09-18 11:58:21.405: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x52641000 size:5488640 offset:3952640
09-18 11:58:29.313: W/MediaPlayer(32211): info/warning (1, 902)
09-18 11:58:29.323: I/MediaPlayer(32211): Info (1,902)
09-18 11:58:29.323: D/AudioPlayer(32211): onPrepared
09-18 11:58:29.463: D/MediaPlayer(32211): start() in
09-18 11:58:29.734: D/MediaPlayer(32211): start() out
09-18 11:58:29.874: I/Adreno200-EGLSUB(32211): <ConfigWindowMatch:2078>: Format RGBA_8888.
09-18 11:58:32.887: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x53803000 size:5918720 offset:5611520
09-18 11:58:32.887: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x53da8000 size:1843200 offset:1536000
09-18 11:58:32.887: D/memalloc(32211): /dev/pmem: Unmapping buffer base:0x53f6a000 size:2150400 offset:1843200
09-18 11:58:36.190: D/MediaPlayer(32211): stop() in
09-18 11:58:36.190: D/MediaPlayer(32211): stop() out
09-18 11:58:36.190: D/MediaPlayer(32211): release() in
09-18 11:58:36.220: D/AudioSystem(32211): AudioSystem::get_audio_flinger() in at 53
09-18 11:58:36.220: D/AudioSystem(32211): gLock get at 55
09-18 11:58:36.220: D/AudioSystem(32211): leave AudioSystem::get_audio_flinger() at 81
09-18 11:58:36.230: D/MediaPlayer(32211): release() out
09-18 11:58:36.230: D/MediaPlayer(32211): reset() in
09-18 11:58:45.509: D/AndroidRuntime(32211): Shutting down VM
09-18 11:58:45.509: W/dalvikvm(32211): threadid=1: thread exiting with uncaught exception (group=0x40ab7228)
09-18 11:58:45.589: E/AndroidRuntime(32211): FATAL EXCEPTION: main
09-18 11:58:45.589: E/AndroidRuntime(32211): java.lang.IllegalStateException
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.media.MediaPlayer._reset(Native Method)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.media.MediaPlayer.reset(MediaPlayer.java:1378)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at com.example.android.htc.test.AudioPlayer$1.onItemClick(AudioPlayer.java:55)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.widget.AdapterView.performItemClick(AdapterView.java:292)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.widget.AbsListView.performItemClick(AbsListView.java:1077)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.widget.AbsListView$PerformClick.run(AbsListView.java:2533)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.widget.AbsListView$1.run(AbsListView.java:3198)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.os.Handler.handleCallback(Handler.java:605)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.os.Handler.dispatchMessage(Handler.java:92)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.os.Looper.loop(Looper.java:154)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at android.app.ActivityThread.main(ActivityThread.java:4945)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at java.lang.reflect.Method.invokeNative(Native Method)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at java.lang.reflect.Method.invoke(Method.java:511)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-18 11:58:45.589: E/AndroidRuntime(32211):    at dalvik.system.NativeStart.main(Native Method)
09-18 11:58:48.552: D/Process(32211): killProcess, pid=32211
09-18 11:58:48.562: D/Process(32211): dalvik.system.VMStack.getThreadStackTrace(Native Method)
09-18 11:58:48.562: D/Process(32211): java.lang.Thread.getStackTrace(Thread.java:599)
09-18 11:58:48.562: D/Process(32211): android.os.Process.killProcess(Process.java:788)
09-18 11:58:48.562: D/Process(32211): com.android.internal.os.RuntimeInit$UncaughtHandler.uncaughtException(RuntimeInit.java:104)
09-18 11:58:48.562: D/Process(32211): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
09-18 11:58:48.572: D/Process(32211): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
09-18 11:58:48.572: D/Process(32211): dalvik.system.NativeStart.main(Native Method)
09-18 11:58:48.982: D/libEGL(32271): loaded /system/lib/egl/libGLES_android.so
09-18 11:58:48.992: D/libEGL(32271): loaded /system/lib/egl/libEGL_adreno200.so
09-18 11:58:48.992: D/libEGL(32271): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
09-18 11:58:49.002: D/libEGL(32271): loaded /system/lib/egl/libGLESv2_adreno200.so
09-18 11:58:49.012: I/Adreno200-EGLSUB(32271): <ConfigWindowMatch:2078>: Format RGBA_8888.
09-18 11:58:49.022: D/OpenGLRenderer(32271): Enabling debug mode 0 
```

而这个是用 mediaPlayer.reset 方法注释掉的。

```
09-18 12:01:49.358: W/MediaPlayer(523): info/warning (1, 902)
09-18 12:01:49.358: I/MediaPlayer(523): Info (1,902)
09-18 12:01:49.358: D/AudioPlayer(523): onPrepared
09-18 12:01:49.499: D/MediaPlayer(523): start() in
09-18 12:01:49.509: D/MediaPlayer(523): start() out
09-18 12:01:49.619: I/Adreno200-EGLSUB(523): <ConfigWindowMatch:2078>: Format RGBA_8888.
09-18 12:01:52.612: D/memalloc(523): /dev/pmem: Unmapping buffer base:0x53ac4000 size:5918720 offset:5611520
09-18 12:01:52.612: D/memalloc(523): /dev/pmem: Unmapping buffer base:0x5228f000 size:1843200 offset:1536000
09-18 12:01:52.612: D/memalloc(523): /dev/pmem: Unmapping buffer base:0x54069000 size:2150400 offset:1843200
09-18 12:01:57.236: D/MediaPlayer(523): stop() in
09-18 12:01:57.236: D/MediaPlayer(523): stop() out
09-18 12:01:57.236: D/MediaPlayer(523): release() in
09-18 12:01:57.266: D/AudioSystem(523): AudioSystem::get_audio_flinger() in at 53
09-18 12:01:57.266: D/AudioSystem(523): gLock get at 55
09-18 12:01:57.266: D/AudioSystem(523): leave AudioSystem::get_audio_flinger() at 81
09-18 12:01:57.266: D/MediaPlayer(523): release() out
09-18 12:02:05.434: D/AndroidRuntime(523): Shutting down VM
09-18 12:02:05.434: W/dalvikvm(523): threadid=1: thread exiting with uncaught exception (group=0x40ab7228)
09-18 12:02:05.504: E/AndroidRuntime(523): FATAL EXCEPTION: main
09-18 12:02:05.504: E/AndroidRuntime(523): java.lang.IllegalStateException
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.media.MediaPlayer.setDataSource(Native Method)
09-18 12:02:05.504: E/AndroidRuntime(523):  at com.example.android.htc.test.AudioPlayer$1.onItemClick(AudioPlayer.java:59)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.widget.AdapterView.performItemClick(AdapterView.java:292)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.widget.AbsListView.performItemClick(AbsListView.java:1077)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:2533)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.widget.AbsListView$1.run(AbsListView.java:3198)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.os.Handler.handleCallback(Handler.java:605)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.os.Handler.dispatchMessage(Handler.java:92)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.os.Looper.loop(Looper.java:154)
09-18 12:02:05.504: E/AndroidRuntime(523):  at android.app.ActivityThread.main(ActivityThread.java:4945)
09-18 12:02:05.504: E/AndroidRuntime(523):  at java.lang.reflect.Method.invokeNative(Native Method)
09-18 12:02:05.504: E/AndroidRuntime(523):  at java.lang.reflect.Method.invoke(Method.java:511)
09-18 12:02:05.504: E/AndroidRuntime(523):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-18 12:02:05.504: E/AndroidRuntime(523):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-18 12:02:05.504: E/AndroidRuntime(523):  at dalvik.system.NativeStart.main(Native Method)
09-18 12:02:36.665: D/Process(523): killProcess, pid=523
09-18 12:02:36.665: D/Process(523): dalvik.system.VMStack.getThreadStackTrace(Native Method)
09-18 12:02:36.665: D/Process(523): java.lang.Thread.getStackTrace(Thread.java:599)
09-18 12:02:36.665: D/Process(523): android.os.Process.killProcess(Process.java:788)
09-18 12:02:36.665: D/Process(523): com.android.internal.os.RuntimeInit$UncaughtHandler.uncaughtException(RuntimeInit.java:104)
09-18 12:02:36.665: D/Process(523): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
09-18 12:02:36.665: D/Process(523): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
09-18 12:02:36.665: D/Process(523): dalvik.system.NativeStart.main(Native Method)
09-18 12:02:36.665: I/Process(523): Sending signal. PID: 523 SIG: 9
09-18 12:02:37.035: D/libEGL(676): loaded /system/lib/egl/libGLES_android.so
09-18 12:02:37.045: D/libEGL(676): loaded /system/lib/egl/libEGL_adreno200.so
09-18 12:02:37.045: D/libEGL(676): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
09-18 12:02:37.045: D/libEGL(676): loaded /system/lib/egl/libGLESv2_adreno200.so
09-18 12:02:37.065: I/Adreno200-EGLSUB(676): <ConfigWindowMatch:2078>: Format RGBA_8888.
09-18 12:02:37.075: D/OpenGLRenderer(676): Enabling debug mode 0
09-18 12:02:37.115: D/OpenGLRenderer(676): has fontRender patch
09-18 12:02:37.135: D/OpenGLRenderer(676): has fontRender patch 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:25:40.547

如果您正在为您的活动使用单个媒体播放器实例并计划重新使用它，请不要释放它。如果你释放它，你必须先获得另一个实例才能使用它。但是，您可以在准备之前重置媒体播放器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:25:00.140

```
java.lang.IllegalStateException 
```

它说您的媒体播放器没有正确初始化，无论如何它对他来说处于错误状态。

检查

```
om.example.android.htc.test.AudioPlayer$1.onItemClick(AudioPlayer.java:59) 
```

线看看有什么。它不喜欢这种`setDataSource`方法。

中的多个语句：

```
mediaPlayer.setDataSource(afd.getFileDescriptor(),afd.getStartOffset(),afd.getDeclaredLength()); 
```

请分成1条语句/行

# php - 具有唯一输入 ID 的 jQuery 提交表单

> ID：12475893
> 
> 赞同：1
> 
> 时间：2012-09-18T11:13:50.417
> 
> 标签：php, jquery, foreach, submit

我有一个 foreach 循环，它输出一个表单，其中包含每个数组条目的内容，如下所示。

```
$cartOutput .= '<td><form action="cart.php" method="post">
        <input name="quantity" type="text" value="' . $each_item['quantity'] . '" size="1" maxlength="2" id="quantity" />
        <input name="adjustBtn' . $item_id . '" type="submit" value="change" id="adjustBtn" hidden="true" />
        <input name="item_to_adjust" type="hidden" value="' . $item_id . '" />
        </form></td>'; 
```

正如您所看到的，提交按钮具有一个唯一的分配名称，具体取决于项目。

在我的 jquery 文件中，我有以下内容。

```
$('#quantity').change(function(){
$("[name^=adjustBtn]").closest("form").submit(); 
```

});

这适用于页面上的第一个表单，但任何其他表单都不会在更改时自动提交，我相信 name^=adjustBtn 条目正在抓取所有不同的按钮，但我只是不确定如何告诉它提交哪个按钮等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:15:53.853

你似乎需要

```
$('[name="quantity"]').change(function(){
   $(this).closest("form").submit();
}); 
```

你的身份证似乎不需要。并且请注意，给定 id 的元素不能超过一个（代码中的“数量”和“adjustBtn”有问题）。

# java - 运行时与 JRuby 从 Java 执行 Ruby 脚本

> ID：12475895
> 
> 赞同：0
> 
> 时间：2012-09-18T11:13:57.570
> 
> 标签：java, ruby, jruby

我想知道使用 Runtime 从 Java 类执行 Ruby 脚本而不是使用 ruby​​-java 桥 JRuby 的优缺点是什么？

运行时示例

```
Process process = Runtime.getRuntime().exec("ruby start.rb blue_button_example_data.txt");
    try {
        process.waitFor();
    } catch (InterruptedException e) {
        e.printStackTrace();
        return;
    } 
```

jRuby 示例[http://dior.ics.muni.cz/~makub/ruby/](http://dior.ics.muni.cz/~makub/ruby/)

我之所以问，是因为我有一个遗留的 Java 系统，我们正在与一个具有 ruby​​ 脚本的系统进行集成，我们正在尝试重用它们而不是用 java 重写它们。我们想知道哪种方法最好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:10:21.113

正如人们所提到的，[JRuby](http://www.jruby.org/download)可能会更快，但更重要的是，它可以让您与 Java 进行更紧密的集成：您可以从 JRuby 调用 Java 代码，反之亦然。这也可以让 Java 和 Ruby 之间的过渡更加顺畅，因为基础设施可以保持不变（您可以在 Java EE 应用程序服务器中部署 Rails 应用程序），并且开发人员可以在两者之间逐步切换。

有关集成的更多详细信息，请参阅[JRuby wiki](https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby)。

JRuby 唯一的缺点是不能使用一些 MRI gem，因为它们使用的是本地代码——尽管这不是我最近被阻止的东西。

# iphone - 编程苹果 iphone/ipad 应用程序以通过蓝牙（或 WIFI）与自定义电子设备通信

> ID：12475897
> 
> 赞同：4
> 
> 时间：2012-09-18T11:14:06.260
> 
> 标签：iphone, ipad, mfi

我正在努力确认以下内容（或认为这很困难），并想知道其他人是否已经走上了这条路。

我想开发一个使用蓝牙的 iPhone/iPad 应用程序，该应用程序使用以下蓝牙模块与自定义硬件设备通信： [http ://www.rovingnetworks.com/products/RN_42_RN42_I_RM](http://www.rovingnetworks.com/products/RN_42_RN42_I_RM)

我已经阅读了有关 iAP 的信息，但它们似乎是为正在开发的开发人员准备的：录音机、遥控器和耳机。使用 iAP 似乎还需要使用安全协处理器，因此我需要将该 IC 集成到我的硬件上并加入 MFI 开发成本/注册。 [http://mfi.apple.com/faqs](http://mfi.apple.com/faqs)

但是，我只想从上述设备发送和接收数据，因此我应该能够使用本机协议：RFCOMM、SPP 甚至只是没有身份验证 IC 的 L2CAP（？）从阅读此处的帖子，它们已打开并且唯一可用的协议是 iAP。*苹果肯定没有禁用所有原生蓝牙协议吗？还是在身份验证 IC 成功时启用了自定义 iAP 协议？*

如果 iPhone/iPad 上的所有蓝牙活动都需要使用安全协处理器和 iAP，*我的另一个选择是 WIFI，我只需要一个开发人员许可证（99 美元），我可以在没有 MFI 的情况下向我的硬件发送和接收数据？*即没有基于苹果的障碍、攻击课程或其他此类进步障碍？

所以假设我现在有了我的应用程序并且我想分发它。 [没有 AppStore 的 iPhone 应用程序](https://stackoverflow.com/questions/982476/iphone-app-without-appstore)

*我认为 App Store 的问题是在任何情况下，Apple 都希望看到一个 MFI，即使是 WIFI 应用程序，因为它可以与自定义硬件通信？*作为分发应用程序的开发人员，我仅限于 100 个客户端。

我读到的另一个选择是使用游戏界面，但大概这会引起 Apple 众神的愤怒，他们不会让它进入 App Store，而且我将再次被困在每个开发者许可证 100 个用户。 [http://www.devx.com/wireless/Article/43502](http://www.devx.com/wireless/Article/43502)

他们并不容易。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-10T16:04:30.343

可能为时已晚，您可能已经得到答案....基本上Apple 将允许没有协处理器的“正常”耳机/麦克风连接。但是，对于传输数据，您需要它。但是，我知道，对于 BLE（即来自 4S 及更高版本），您可能不需要它，因为该应用程序基本上包含您的个人资料。仍有待确认

# matlab - 在视频上叠加数据

> ID：12475900
> 
> 赞同：0
> 
> 时间：2012-09-18T11:14:24.200
> 
> 标签：matlab, video

我在 Matlab 中收集了大约 30 秒的数据以及相关的时间戳。

同时，我记录了三十秒的网络摄像头数据。

我想将数据叠加到视频上，以便每个视频帧都显示当前和前五秒的数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:14:35.827

未经测试，但类似的东西应该可以工作：

```
fps_video = 30; % in Hz
fps_data = 8000; % in Hz
duration_video = 30; % in s
number_of_video_frames = fps_video * duration_video;
window_duration = 5; % in s
number_of_datapoints = window_duration * fps_data; % data samples in window_duration seconds

for n = 1:number_of_video_frames 
    subplot(1,2,1);
    imshow(video(n,:,:));
    subplot(1,2,2);
    data_1 = zeros(number_of_datapoints);
    if (n >= (window_duration * fps_video))
        fps_data_1 = (1, (n * fps_data/fps_video) - number_of_datapoints: n * fps_data/fps_video)
        fps_data_2 = ...
    end
    plot(data_1, data_2) % don't know what data_with_timestamps looks like (what is x and y, set data_1 and data_2 accordingly...)
    pause(1/fps_video);
end 
```

# asp.net-mvc-3 - 具有特定类值的过滤器列表

> ID：12475910
> 
> 赞同：0
> 
> 时间：2012-09-18T11:15:40.790
> 
> 标签：asp.net-mvc-3, class, c#-4.0

我有一个责任类，其中包含一些子类下面是该类：-

```
public class Responsibility
{
    private Frequency _FrequencyInfo = new Frequency();
    private ResponsibilityCategory _CategoryInfo = new ResponsibilityCategory();
    private Status _StatusInfo = new Status();

    public int ResponsibilityId { get; set; }
    public string ResponsibilityName { get; set; }
    public string Description { get; set; }
    public Frequency FrequencyInfo
    {
        get { return _FrequencyInfo; }
        set { _FrequencyInfo = value; }
    }
    public ResponsibilityCategory CategoryInfo
    {
        get { return _CategoryInfo; }
        set { _CategoryInfo = value; }
    }
    public Status StatusInfo
    {
        get { return _StatusInfo; }
        set { _StatusInfo = value; }
    }
} 
```

下面是我用来绑定列表的代码。但我得到了类的所有元素。我只想要类中的两个元素。

```
Responsibility newResponsibilty = new Responsibility();
        newResponsibilty.ResponsibilityId = ResponsibilityId;
        new iNGRID_Data.Ops.DataMethods().dbrGetResponsibilityDetailsInSpecifiedResponsibilty(ref newResponsibilty, ResponsibilityId, ref err);
        List<Responsibility> listResponsibilty = new List<Responsibility>();
        listResponsibilty.Add(newResponsibilty);

        JavaScriptSerializer jsonserialize = new JavaScriptSerializer();
        string result = jsonserialize.Serialize(listResponsibilty);
        return Content(result); 
```

我想用 2 个对象 ResponsibiltyName 和 Description 序列化这个列表。请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:17:52.050

不要手动 JSON 序列化它们。通过返回 Json 结果将其留给框架。你也不需要清单。您可以返回一个包含您感兴趣的属性的匿名对象：

```
public ActionResult SomeAction()
{
    Responsibility newResponsibilty = new Responsibility();
    newResponsibilty.ResponsibilityId = ResponsibilityId;
    new iNGRID_Data.Ops.DataMethods().dbrGetResponsibilityDetailsInSpecifiedResponsibilty(ref newResponsibilty, ResponsibilityId, ref err);
    var result = new
    {
        name = newResponsibilty.ResponsibiltyName, 
        description = newResponsibilty.Description
    };
    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

在您的 AJAX 成功回调中，您可以读取这些属性：

```
success: function(result) {
    // you could use result.name and result.description here
} 
```

# javascript - @RequestBody 通过 Spring MVC JSON Jackson 处理器发送

> ID：12475911
> 
> 赞同：8
> 
> 时间：2012-09-18T11:15:47.070
> 
> 标签：javascript, jquery, json, jsp, spring-mvc

我已经阅读了许多类似的问题，包括：[JQuery、Spring MVC @RequestBody 和 JSON - 使其](https://stackoverflow.com/questions/5908466/jquery-spring-mvc-requestbody-and-json-making-it-work-together) [与 JSON 请求与 JQuery/Ajax 和 Spring一起工作](https://stackoverflow.com/questions/10253209/json-request-with-jquery-ajax-with-spring)

要求是服务器只接受 application/json 类型。我正在使用 Spring MVC 控制器。代码通过@ResponseBody 将响应以 JSON 形式发回。我想通过我的 Spring MVC 控制器中的 @RequestBody 获取信息。我正在使用 JSP 将 JSON 发送到 Spring MVC 控制器。我的代码和 Spring MVC 如下所示：

我是 JSON 和 Javascript 的新手。

JSP - index.jsp

```
<%@page language="java" contentType="text/html"%> 
<html> 
<head> 
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>   
<script type="text/javascript"> 
$('#myForm').on('submit', function(e) {  
var frm = $("#myForm"); 
var dat = JSON.stringify(frm.serializeArray());  

 $.ajax({  
 type: 'POST',  
 url: $('#myForm').attr('action'),  
 data: dat, 
 contentType: 'application/json', 
 dataType: 'json', 
 error: function() { 
    alert('failure'); 
 } 
 success: function(hxr) {  
     alert("Success: " + xhr);  
 } 
  });  
);  
   };  
</script>  
</head> 
<body> 
<h2>Application</h2> 
<form id="myForm" action="/application/save" method="POST" accept="application/json" onclick="i()"> 
<input type="text" name="userId" value="User"> 
<input type="submit" value="Submit"> 
</form> 
</body> 
</html> 
```

运行此程序时，我没有得到任何输出。在 Chrome 中我得到 404 Not found 错误，在 Tomcat 中我得到以下错误：

```
org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver                        handleNoSuchRequestHandlingMethod 
WARNING: No matching handler method found for servlet request: path '/application/sa 
 ve', method 'POST', parameters map['userId' -> array<String>['User']] 
```

JSP 部分有问题吗？

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>  
<web-app xmlns="http://java.sun.com/xml/ns/j2ee" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd" 
 version="2.5"> 

 <display-name>WebApp</display-name> 

 <context-param> 
    <!-- Specifies the list of Spring Configuration files in comma separated format.--> 
    <param-name>contextConfigLocation</param-name> 
    <param-value>/WEB-INF/spring/service.xml</param-value> 
 </context-param> 

 <listener> 
    <!-- Loads your Configuration Files--> 
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class> 
 </listener> 

 <servlet> 
    <servlet-name>application</servlet-name> 
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class> 
    <load-on-startup>1</load-on-startup> 
 </servlet> 

 <servlet-mapping> 
    <servlet-name>application</servlet-name> 
    <url-pattern>/</url-pattern> 
 </servlet-mapping> 

 <welcome-file-list> 
    <welcome-file>index.jsp</welcome-file> 
 </welcome-file-list>     
</web-app> 
```

服务.xml

```
<?xml version="1.0" encoding="UTF-8"?> 
<beans xmlns="http://www.springframework.org/schema/beans" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:context="http://www.springframework.org/schema/context" 
xmlns:util="http://www.springframework.org/schema/util" 
xmlns:mvc="http://www.springframework.org/schema/mvc" 
xsi:schemaLocation="http://www.springframework.org/schema/beans     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
http://www.springframework.org/schema/context     http://www.springframework.org/schema/context/spring-context-3.0.xsd 
http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd 
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd"> 

<context:component-scan base-package="com.web"/> 

<mvc:annotation-driven/> 

<context:annotation-config/> 

<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/> 

<bean id="jacksonMessageChanger" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"> 
    <property name="supportedMediaTypes" value="application/json"/> 
</bean> 

<!-- <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"> 
    <property name="messageConverters"> 
        <list> 
            <ref bean="jacksonMessageChanger"/> 
        </list> 
    </property> 
</bean>--> 

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"> 
    <property name="messageConverters"> 
        <util:list id="beanList"> 
            <ref bean="jacksonMessageChanger"/> 
        </util:list> 
    </property> 
</bean> 

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver"> 
    <property name="prefix" value="/WEB-INF/jsp/"/> 
    <property name="suffix" value=".jsp"/> 
</bean> 

<!-- <bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver"> 
    <property name="mediaTypes"> 
        <map> 
            <entry key="json" value="application/json"/> 
        </map> 
    </property> 
</bean>--> 
```

控制器

```
package com.web; 

import org.springframework.stereotype.Controller; 
import org.springframework.web.bind.annotation.RequestMapping; 
import org.springframework.web.bind.annotation.RequestMethod; 
import org.springframework.web.bind.annotation.ResponseBody; 
import org.springframework.web.bind.annotation.RequestBody; 
import com.webchannel.domain.User; 
import com.webchannel.domain.UserResponse; 

@Controller 
@RequestMapping("/application/*") 
public class SaveController { 

 @RequestMapping(value = "save", method = RequestMethod.POST, headers = {"content-type=application/json"}) 
 public @ResponseBody UserResponse save(@RequestBody User user) throws Exception { 
  UserResponse userResponse = new UserResponse(); 
 System.out.println("UserId :" + " " + user.getUserId()); 
 return userResponse; 
} 

@RequestMapping(value = "delete", method = RequestMethod.GET) 
public @ResponseBody UserResponse delete() { 
   System.out.println("Delete"); 
   UserResponse userResponse = new UserResponse(); 
   userResponse.setSuccess(true); 
   userResponse.setVersionNumber("1.0"); 
   return userResponse; 
```

} }

调用 /application/delete 时，我会返回 JSON。所以我知道我的 JacksonProcessor 配置正确。问题出在@RequestBody 中。

我哪里错了？

如果我删除下面代码中的标题，我会收到 415 错误。

```
@RequestMapping(value = "save", method = RequestMethod.POST) 
 public @ResponseBody UserResponse save(@RequestBody User user) throws Exception { 
  UserResponse userResponse = new UserResponse(); 
 System.out.println("UserId :" + " " + user.getUserId()); 
 return userResponse; 
} 
```

我几乎接近了，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-18T13:56:00.623

我试图用你的代码多玩一点，但是无法得到与你得到的相同的错误。我已经修改了 HTML：

```
<html>
<head>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>

<script type="text/javascript"> 

    $(function() { 
        $('#myForm').submit(function() {
            var form = $( this ),
                url = form.attr('action'),
                userId = form.find('input[name="userId"]').val(),
                dat = JSON.stringify({ "userId" : userId });

            $.ajax({
                url : url,
                type : "POST",
                traditional : true,
                contentType : "application/json",
                dataType : "json",
                data : dat,
                success : function (response) {
                    alert('success ' + response);
                },
                error : function (response) {
                    alert('error ' + response);
                },
            });

            return false;
        });
    });

</script>
</head>
<body>
    <h2>Application</h2>
    <form id="myForm" action="application/save">
        <input type="text" name="userId" value="User">
        <input type="submit" value="Submit">
    </form>
</body>
</html> 
```

我有一个与您类似的非常简单的方法：

```
@RequestMapping(value = "save", method = RequestMethod.POST, headers = {"content-type=application/json"})
public @ResponseBody String save (@RequestBody User user) throws Exception
{
    return "save-test";
} 
```

我的用户类如下所示：

```
public class User
{
    private String userId;

    public User()
    {
    }

    public String getUserId ()
    {
        return userId;
    }

    public void setUserId (String userId)
    {
        this.userId = userId;
    }
} 
```

我的 spring 配置被精简为包含：

```
<context:component-scan base-package="com.web"/> 
<mvc:annotation-driven/> 
<context:annotation-config/> 
```

我正在使用 spring 版本 3.1.1 和 jquery 1.8.1（我相信是最新的）。我没有遇到与您相同的错误，因此也许您可以尝试我所做的一些事情，看看是否有帮助。

# asp.net - nhibernate：通过分页获取不同的子类

> ID：12475914
> 
> 赞同：0
> 
> 时间：2012-09-18T11:16:01.657
> 
> 标签：asp.net, nhibernate, union, subclass

我有以下实体

```
class BaseClass
{
  public int Id{get; set;}
}

class SubClassOne : BaseClass
{
  public string MyPropertyOne{get; set;}
}

class SubClassTwo : BaseClass
{
  public string MyPropertyTwo{get; set;}
} 
```

现在我需要在一个网格中显示所有现有实体（SubClassOne 和 SubClassTwo 类型），包括分页。

问题是每个子类都有自己的属性，用户可以在这些属性上进行搜索，因此在查询中需要这些属性。

所以，据我所知，Future() 是没有选择的，因为分页不起作用。在纯 sql 中，我会用 UNION 构造一个大查询。据我所知，nhibernate 不直接与 UNION 一起使用。是否可以使用直接 sql 然后将结果转换为实体 SubClassOne 和 SubClassTwo？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T12:36:15.280

更新：

它应该与多态查询一起使用

```
var results = session.Query<BaseClass>()
    .Where(bc => ((SubClassOne)bc).MyPropertyOne == "Foo")
    .ToList();

// or
var results = session.QueryOver<BaseClass>()
    .Where(bc => ((SubClassOne)bc).MyPropertyOne == "Foo")
    .List(); 
```

注意：您最好按 id 排序以获得一致的页面

# c++ - 将流指针倒回到后面的行

> ID：12475915
> 
> 赞同：3
> 
> 时间：2012-09-18T11:16:04.170
> 
> 标签：c++

我有一个输入文件流和一个声明为的字符串：

```
std::ifstream finput;
std::string tmp_string; 
```

我反复阅读行`std::getline(finput, tmp_string);`

问题是：如何倒带流指针，以便倒带之后的第二次调用`std::getline(finput, tmp_string);`将返回相同的结果（与前一步一样）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:43:14.720

一旦你读了这条线，就为时已晚。你不能回到你没有记住的位置。如果你需要这个，唯一的解决方案是在`finput.gtell()`之前调用`getline`，然后寻找它返回的内容。

# javascript - 网站作者可以看到我注入的 JavaScript 吗？

> ID：12475916
> 
> 赞同：-2
> 
> 时间：2012-09-18T11:16:07.227
> 
> 标签：javascript, security, opera-extension

假设我想弄乱特定的站点并在那里注入一些功能来与页面交互。然后网站管理员可以通过检查窗口对象来检查是否只有他定义的功能，如果有差异通过 ajax 回传到他的服务器，那么实际上我的代码可以以这种方式被窃取/查看吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:19:28.580

如果您在网站的全局上下文中注入代码，该网站可以使用 JavaScript 来检测这一点，并通过`.toString()`在您的函数上使用，获取注入函数的源代码。

但是，这不太可能，您始终可以将大部分代码放入匿名自执行函数中，该函数仅在注册事件等时使用代理函数，然后调用您的实际逻辑 - 这些函数在匿名闭包之外无法访问。

```
(function() {
    function doCrazyStuff() { /* OMG THIS IS TOP SEKRET! */ }
    function crazyStuffProxy() { doCrazyStuff(); }
    window.onload = crazyStuffProxy;
}); 
```

现在有权访问的`window`人可以获得 的代码，`crazyStuffProxy`但无法访问`doCrazyStuff`.

当然，这只适用于不使用`<script>`标签注入所有代码的情况。但是，由于您标记了您的问题[opera-extension](/questions/tagged/opera-extension "显示标记为“歌剧扩展”的问题")您的代码可能在不同的上下文中运行，除了您实际添加到窗口或 DOM 元素的代码，所以这不应该是一个问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:17:42.263

这取决于。我可以写一些非常贪婪的东西并检测到正在发生的事情并将其发送出去。这需要大量工作才能检测到所有这些。

它不太可能。

# node.js - 将子目录文件部署到 nodejitsu

> ID：12475917
> 
> 赞同：3
> 
> 时间：2012-09-18T11:16:10.633
> 
> 标签：node.js, nodejitsu

我是 node 和 nodejitsu 的新手，我正在尝试部署一个非常简单的应用程序，它使用 node-static 来提供存储在文件夹“./Scripts”中的文件

这在本地工作正常，但是当我尝试从 jit.su 访问文件时，找不到该文件。

我希望这是我的 package.json 文件的问题，你能指出我正确的方向吗？我应该如何将“./Scripts”文件夹及其内容部署到 nodejitsu？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T15:11:36.800

在您的应用程序中执行`npm pack`并确保生成的包包含该文件。

Nodejitsu 在部署您的应用程序时使用相同的命令。

如果它不包含在包中，您应该查看您的`.gitignore`和/或`.npmignore`文件以确保该文件夹或包含的文件不会被忽略。

请注意，任何以“.”开头的文件/文件夹 like`.DS_Store`默认情况下会被忽略，一些特殊的 like`.git`不能被忽略，因为 npm 会阻止这种情况。

要显式地取消忽略文件，请使用`!filename`or`.gitignore`或`.npmignore`.

# cordova - 应用未获批准使用以下参数进行此类支付

> ID：12475924
> 
> 赞同：2
> 
> 时间：2012-09-18T11:16:39.503
> 
> 标签：cordova, paypal, phonegap-plugins, paypal-sandbox

我已经下载了 paypal mpl 并使用 phonegap 默认示例来测试沙箱。

我只是从示例中更改这些行

```
obj.paymentAmount = document.getElementById('pmt_subtotal').value;
obj.paymentCurrency = document.getElementById('pmt_currency').value;
obj.recipient = document.getElementById('pmt_recipient').value;
obj.merchantName = document.getElementById('pmt_merchant').value;
obj.itemDesc = document.getElementById('pmt_description').value;
obj.memo = document.getElementById('pmt_memo').value;
obj.tax = document.getElementById('pmt_tax').value;
obj.shipping = document.getElementById('pmt_shipping').value; 
```

用这个静态值

```
var obj = {
        server : 'ENV_SANDBOX',
        appId : 'APP-80W284485P519543T'
    };
obj.paymentAmount = 10.0;
obj.paymentCurrency = 'USD';
obj.recipient = 'moin_k_1347963077_biz@yahoo.com';
obj.merchantName = 'Test Test';
obj.itemDesc = 'something';
obj.memo = 'something';
obj.tax = 0;
obj.shipping = 0; 
```

当我点击 paypal pay 按钮时，它会引发错误

`"The application is not approved to use the following parameters with this type of payment".`

这是完整的 Eclipse 项目[http://marinefreshbd.com/paypal/Paypal.zip](http://marinefreshbd.com/paypal/Paypal.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:21:47.430

对我来说，解决方案是更新了 mpl.java 文件，就像这个链接中所说的那样

[https://groups.google.com/forum/#!msg/eclipse-plugin-for-phonegap/UnHBZ_u_TDM/Z8W432aGG4UJ](https://groups.google.com/forum/#!msg/eclipse-plugin-for-phonegap/UnHBZ_u_TDM/Z8W432aGG4UJ)

希望它可以帮助你。祝你好运。

奥雷里奥

# android - 绑定到 Android 中的 AccessibilityService？

> ID：12475929
> 
> 赞同：10
> 
> 时间：2012-09-18T11:16:48.180
> 
> 标签：android, binding, service, accessibility

我创建了一个 android `Service`，它扩展了一个`AccessibilityService`. 从我的`Activity`，我想绑定到那个`Service`。因为我需要从 to 发送`Service`信息`Activity`。我需要示例代码。我已经搜索了谷歌并没有找到任何类似的东西，请有人可以提供一个示例的链接。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-24T01:07:54.867

虽然可以从 Activity 绑定 AccessibilityService，但您只能将 AccessibilityEvents 传递到服务中。这是因为 AccessibilityService.onBind() 被声明为 final，这意味着您将无法向活页夹添加任何新方法。

但是，有几种替代解决方案。

如果您的活动和服务在同一个进程中运行（如果它们在同一个 APK 中通常是这样），那么您可以与无障碍服务的静态实例进行通信。这是一个如何工作的示例：

**MyAccessibilityService.java：**

```
private static MyAccessibilityService sSharedInstance;

protected void onServiceConnected() {
    . . .
    sSharedInstance = this;
}

public boolean onUnbind(Intent intent) {
    sSharedInstance = null;
    . . .
}

public static MyAccessibilityService getSharedInstance() {
    return sSharedInstance;
} 
```

**我的活动.java**

```
protected void onCreate() {
    . . .
    mAccessibilityService = MyAccessibilityService.getSharedInstance();
    if (mAccessibilityService != null) {
        // The service is running and connected.
        mAccessibilityService.doSomething();
    }
} 
```

如果您的服务和活动在不同的进程中（例如单独的 APK），那么您仍然有几个选择：

*   通过将活动中的[Intent](http://developer.android.com/reference/android/content/Intent.html)[广播](http://developer.android.com/reference/android/content/BroadcastReceiver.html)到服务中的 BroadcastReceiver 进行通信
*   将您的活动绑定到与静态实例通信的 AccessibilityService 进程中的“代理”服务（如上）

如果您需要详细说明其中任何一个，请发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-08T05:25:48.773

也许还有另一种相互交流的方式：

1.  在`AccessibilityService`儿童班：

    > 处理目标 Activity 的：
    > PackageName AND
    > ActivityName AND
    > **specific EventType** (eg: `AccessibilityEvent.TYPE_VIEW_CLICKED`)

    ```
    @Override
    public void onAccessibilityEvent(final AccessibilityEvent event)
    {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N)
            if (event.getEventType() == AccessibilityEvent.TYPE_VIEW_CLICKED)
                if (AccessibilityUtils.findNodeInfoByViewTypeAndText(event.getSource(), "android.widget.ToggleButton", TextUtils.getString(R.string.lable_disabled)) != null)
                    getAccessibilityService().disableSelf();
    } 
    ```

2.  在`target Activity`:just 调用**特定的 EventType**

    > 用户调用或
    > 代码调用

    ```
    btnEnableService.setOnClickListener(new View.OnClickListener()
            {
                @Override
                public void onClick(final View v)
                {
                    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N && !btnEnableService.isChecked())
                    {
                        btnEnableService.setChecked(false);
                        txvEnabledState.setText(btnEnableService.isChecked() ? R.string.lable_service_status_enabled : R.string.lable_service_status_closed);
                        AppState.instance().setIsEnable(btnEnableService.isChecked());
                    }
                    else
                    {
                        openAccessibilitySettings();

                        btnEnableService.setChecked(!btnEnableService.isChecked());
                    }
                }
            }); 
    ```

## 示例代码：

*   [AppEventHandler_disableSelf.java — Bitbucket](https://bitbucket.org/AsionTang/89.yezukz2autoinstallapp/src/2c65f4e3a4e2f266698b2026904cf57daf911365/App/src/main/java/cn/asiontang/zuk_z2_auto_install/AppEventHandler_disableSelf.java?fileviewer=file-view-default#AppEventHandler_disableSelf.java-24)
*   [SettingActivity.java — Bitbucket](https://bitbucket.org/AsionTang/89.yezukz2autoinstallapp/src/2c65f4e3a4e2f266698b2026904cf57daf911365/App/src/main/java/cn/asiontang/zuk_z2_auto_install/SettingActivity.java?fileviewer=file-view-default#SettingActivity.java-57)

# php - 我怎样才能发送这样的数据

> ID：12475931
> 
> 赞同：0
> 
> 时间：2012-09-18T11:16:54.370
> 
> 标签：php, javascript, json

我正在使用 ajax 将数据从 php 文件发送到 javascript。我想得到这样的javascript变量。

```
var members = [
    {memberId : 1, parentId:null, amount:200, otherInfo:"blah"},
    {memberId : 2, parentId:1, amount:300, otherInfo:"blah1"},
    {memberId : 3, parentId:1, amount:400, otherInfo:"blah2"},
    {memberId : 4, parentId:3, amount:500, otherInfo:"blah3"},
    {memberId : 6, parentId:1, amount:600, otherInfo:"blah4"},
    {memberId : 9, parentId:4, amount:700, otherInfo:"blah5"},
    {memberId : 12, parentId:2, amount:800, otherInfo:"blah6"},
    {memberId : 5, parentId:2, amount:900, otherInfo:"blah7"},
    {memberId : 13, parentId:2, amount:0, otherInfo:"blah8"},
    {memberId : 14, parentId:2, amount:800, otherInfo:"blah9"},
    {memberId : 55, parentId:2, amount:250, otherInfo:"blah10"},
    {memberId : 56, parentId:3, amount:10, otherInfo:"blah11"},
    {memberId : 57, parentId:3, amount:990, otherInfo:"blah12"},
    {memberId : 58, parentId:3, amount:400, otherInfo:"blah13"},
    {memberId : 59, parentId:6, amount:123, otherInfo:"blah14"},
    {memberId : 54, parentId:6, amount:321, otherInfo:"blah15"},
    {memberId : 53, parentId:56, amount:10000, otherInfo:"blah7"},
    {memberId : 52, parentId:2, amount:47, otherInfo:"blah17"},
    {memberId : 51, parentId:6, amount:534, otherInfo:"blah18"},
    {memberId : 50, parentId:9, amount:55943, otherInfo:"blah19"},
    {memberId : 22, parentId:9, amount:2, otherInfo:"blah27"},
    {memberId : 33, parentId:12, amount:-10, otherInfo:"blah677"}

]; 
```

不像json

```
[{"memberId":"4","parentId":"1","amount":"10","otherInfo":"sds"},{"memberId":"5","parentId":"1","amount":"100","otherInfo":"dsf"},{"memberId":"6","parentId":"4","amount":"1000","otherInfo":"sadsa"}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:27:09.653

像这样：

```
<script>
var members = <?php echo json_encode ($members); ?>;
</script> 
```

或这个：

```
<script src="source.php"></script> 
```

或这个：

```
<script>
    jQuery.getJSON ( 'source.php' );
</script> 
```

源代码：

```
var members = <? echo json_encode ( $members ); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:33:32.723

尝试读取 json，然后从中提取数组，在此之前，您必须使用所需字段创建一个对象，以便创建它的一个实例并添加到数组

```
var items = new Array();
var jsonData = JSON.parse(jsoneString);
for (var i in jsonData) {
    var item = jsonData[i];
    var prop1 = item.memberId;
    //and other items goes here

} 
```

我认为这对你来说是一个合适的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T10:15:41.093

我已经编写了这样的代码并使其正常工作，谢谢大家

```
response = [{"memberId":"4","parentId":"1","amount":"10","otherInfo":"sds"},{"memberId":"5","parentId":"1","amount":"100","otherInfo":"dsf"},{"memberId":"6","parentId":"4","amount":"1000","otherInfo":"sadsa"}];

response = jQuery.parseJSON(response);
var members = [
       {memberId : current_id , parentId:null, name:current_name}
    ];
for(var i=0; i<response.length;i++){
   user = {memberId: parseInt(response[i]['memberId']), parentId: parseInt(response[i]['parentId']), name: response[i]['name']};
members.push(user);
} 
```

# android - 跨平台推送 API

> ID：12475942
> 
> 赞同：1
> 
> 时间：2012-09-18T11:17:23.887
> 
> 标签：android, ios, cross-platform, push-notification, windows-phone

是否有适用于 Android、iOS 和 Windows Phone 的推送通知 API？

Parse 在 Android 和 iOS 上效果很好，我可以在 WP 上访问数据，但没有 WP 推送功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:26:27.130

Windows Azure Toolkit 支持所有 4 个平台。

[安卓](https://github.com/WindowsAzure-Toolkits/wa-toolkit-android)

[视窗电话](http://watwp.codeplex.com/)

[iOS](https://github.com/WindowsAzure-Toolkits/wa-toolkit-ios)

[视窗 8](http://watwindows8.codeplex.com/)

不确定这对您的用例有多实用。

看看[这篇博文](http://www.wadewegner.com/2011/05/windows-azure-toolkit-for-ios/)。它链接到可能对您有帮助的其他教程和截屏视频。**请注意，该帖子来自 2011 年，现在可能有点过时了。**

# c# - 为什么我的 toast 通知代码不起作用？

> ID：12475943
> 
> 赞同：0
> 
> 时间：2012-09-18T11:17:29.410
> 
> 标签：c#, windows-8, microsoft-metro

我想在下载完成时显示 toast 通知。但是它不起作用。为什么不起作用？

```
if (download.Progress.Status == BackgroundTransferStatus.Completed)
        {
            XmlDocument toastXml = ToastNotificationManager.GetTemplateContent(ToastTemplateType.ToastImageAndText04);

            XmlNodeList stringElements = toastXml.GetElementsByTagName("text");
            stringElements[0].AppendChild(toastXml.CreateTextNode("Hello toast"));

            ToastNotification toast = new ToastNotification(toastXml);

            ToastNotificationManager.CreateToastNotifier(CoreApplication.Id).Show(toast);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:33:02.023

您是否确保您的应用在应用清单中支持 toast？

# java - 类似 Query on a collection

> ID：12475946
> 
> 赞同：-1
> 
> 时间：2012-09-18T11:17:31.227
> 
> 标签：java, collections, filter, guava

我有一个具有属性的对象列表，这些对象在我的项目中被翻译为列。这些属性是化合物名称、批号和存储。我有一个下拉列表，允许用户选择 1 到 5 之间的任何值。此下拉列表的目的是它应该为您提供（如果您选择 2） - 每批次和每种使用类型 2 个化合物。

我一直在看番石榴图书馆，但它似乎不适合。任何人都有任何想法如何做到这一点。这需要在代码本身内完成，所以是的，数据库是不可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:12:20.070

如果您想在 Java 中查询集合，您可以查看多种选择：

*   [夸尔](http://quaere.codehaus.org/)

    > Quaere 是一个开源、可扩展的框架，它向 Java 应用程序添加了类似于 SQL 的查询语法。Quaere 允许您使用通用的、富有表现力的语法过滤、枚举和创建对多个集合和其他可查询资源的投影。

*   [JXPath](http://commons.apache.org/jxpath/)

    > org.apache.commons.jxpath 包定义了一个名为 XPath 的表达式语言的简单解释器。JXPath 将 XPath 表达式应用于各种对象的图形：JavaBeans、Maps、Servlet 上下文、DOM 等，包括它们的混合。

Google Guava 当然可以做你想做的事，还有 Op4J，Apache Common Collections with Filters/predicates 但你必须编写你的自定义过滤器/方法。

# javascript - Google Maps API Javascript V3 响应式

> ID：12475947
> 
> 赞同：1
> 
> 时间：2012-09-18T11:17:33.657
> 
> 标签：javascript, google-maps, responsive-design

通常我会在我的谷歌地图网页中包含一个静态图像，这样我可以使图像响应，但对于这个项目，我想要地图的交互、缩放、拖动等。

所以我使用了谷歌地图 api (javascript V3)。我在这里遇到的唯一问题是拉入的图像没有响应。我想让它的行为与静态图像相同，这可能吗？

我已按照说明进行操作，甚至将 map_canvas 包装在具有特定高度和宽度的 div 中，尽管我怀疑这是我的问题所在。但是在没有实际将内容（地图）声明为 img 的情况下，我不确定在这里做什么。有没有人解决过这个问题？

编辑

只是为了澄清我所说的响应的意思，我希望地图的行为方式与 img 的行为方式相同，如果您设置 img{max-width:100%}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:45:04.710

您可以试一试[Google Maps Image API](https://developers.google.com/maps/documentation/imageapis/)。

# javascript - 请帮助将水平 css 下拉菜单更改为垂直下拉菜单

> ID：12475953
> 
> 赞同：0
> 
> 时间：2012-09-18T11:17:53.747
> 
> 标签：javascript, html, css, drop-down-menu, menu

我这里有一个横向的 CSS 下拉菜单，从网上得到的。我已经搜索了一整天关于如何将此水平菜单转换为垂直下拉菜单的方法。以及如何制作子菜单。所以如果可能的话，请大家帮帮我。

这是CSS `styles.css`：

```
#cssmenu ul,
#cssmenu li,
#cssmenu span,
#cssmenu a {
  margin: 0;
  padding: 0;
  position: relative;
}
#cssmenu:after,
#cssmenu ul:after {
  content: '';
  display: block;
  clear: both;
}
#cssmenu a {
  color: #333333;
  display: inline-block;
  font-family: 'Lucida Grande', 'Lucida Sans Unicode', Helvetica, Arial, Verdana, sans-serif;
  font-size: 12px;
  min-width: 35px;
  text-align: center;
  text-decoration: none;
  text-shadow: 0 -1px 0 #eeeeee;
}
#cssmenu ul {
  list-style: none;
}
#cssmenu > ul > li {
  float: left;
}
#cssmenu > ul > li.active a {
  background: #d9d9d9 url(images/grad_light.png) repeat-x left bottom;
  background: -moz-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #d9d9d9), color-stop(100%, #bfbfbf));
  background: -webkit-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -o-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -ms-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: linear-gradient(to bottom, #d9d9d9 0%, #bfbfbf 100%);
  filter: progid:dximagetransform.microsoft.gradient(startColorstr='#d9d9d9', endColorstr='#bfbfbf', GradientType=0);
  box-shadow: inset 0 0 10px #979797, inset 0 10px 10px #979797;
  -moz-box-shadow: inset 0 0 10px #979797, inset 0 10px 10px #979797;
  -webkit-box-shadow: inset 0 0 10px #979797, inset 0 10px 10px #979797;
  filter: none;
}
#cssmenu > ul > li.active a:hover {
  background: -moz-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #d9d9d9), color-stop(100%, #bfbfbf));
  background: -webkit-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -o-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: -ms-linear-gradient(top, #d9d9d9 0%, #bfbfbf 100%);
  background: linear-gradient(to bottom, #d9d9d9 0%, #bfbfbf 100%);
  filter: progid:dximagetransform.microsoft.gradient(startColorstr='#d9d9d9', endColorstr='#bfbfbf', GradientType=0);
  filter: none;
}
#cssmenu > ul > li a {
  box-shadow: inset 0 0 0 1px #ffffff;
  -moz-box-shadow: inset 0 0 0 1px #ffffff;
  -webkit-box-shadow: inset 0 0 0 1px #ffffff;
  background: #bfbfbf url(images/grad_light.png) repeat-x left top;
  background: -moz-linear-gradient(top, #ffffff 0%, #e5e5e5 50%, #d7d7d7 51%, #ededed 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #ffffff), color-stop(50%, #e5e5e5), color-stop(51%, #d7d7d7), color-stop(100%, #ededed));
  background: -webkit-linear-gradient(top, #ffffff 0%, #e5e5e5 50%, #d7d7d7 51%, #ededed 100%);
  background: -o-linear-gradient(top, #ffffff 0%, #e5e5e5 50%, #d7d7d7 51%, #ededed 100%);
  background: -ms-linear-gradient(top, #ffffff 0%, #e5e5e5 50%, #d7d7d7 51%, #ededed 100%);
  background: linear-gradient(to bottom, #ffffff 0%, #e5e5e5 50%, #d7d7d7 51%, #ededed 100%);
  filter: progid:dximagetransform.microsoft.gradient(startColorstr='#ffffff', endColorstr='#ededed', GradientType=0);
  border-bottom: 1px solid #d2d2d2;
  border-top: 1px solid #d2d2d2;
  border-right: 1px solid #d2d2d2;
  line-height: 34px;
  padding: 0 35px;
  filter: none;
}
#cssmenu > ul > li a:hover {
  background: #ffffff url(images/grad_light.png) repeat-x left bottom;
  background: -moz-linear-gradient(top, #d9d9d9 0%, #bfbfbf 50%, #b0b0b0 51%, #c7c7c7 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #d9d9d9), color-stop(50%, #bfbfbf), color-stop(51%, #b0b0b0), color-stop(100%, #c7c7c7));
  background: -webkit-linear-gradient(top, #d9d9d9 0%, #bfbfbf 50%, #b0b0b0 51%, #c7c7c7 100%);
  background: -o-linear-gradient(top, #d9d9d9 0%, #bfbfbf 50%, #b0b0b0 51%, #c7c7c7 100%);
  background: -ms-linear-gradient(top, #d9d9d9 0%, #bfbfbf 50%, #b0b0b0 51%, #c7c7c7 100%);
  background: linear-gradient(to bottom, #d9d9d9 0%, #bfbfbf 50%, #b0b0b0 51%, #c7c7c7 100%);
  filter: progid:dximagetransform.microsoft.gradient(startColorstr='#ffffff', endColorstr='#ededed', GradientType=0);
  filter: none;
}
#cssmenu > ul > li:first-child a {
  border-radius: 5px 0 0 5px;
  -moz-border-radius: 5px 0 0 5px;
  -webkit-border-radius: 5px 0 0 5px;
  border-left: 1px solid #d2d2d2;
}
#cssmenu > ul > li:last-child a {
  border-radius: 0 5px 5px 0;
  -moz-border-radius: 0 5px 5px 0;
  -webkit-border-radius: 0 5px 5px 0;
}
#cssmenu .has-sub:hover ul {
  display: block;
}
#cssmenu .has-sub ul {
  display: none;
  position: absolute;
  top: 36px;
  left: -1px;
  min-width: 100%;
  text-align: center;
  *width: 100%;
}
#cssmenu .has-sub ul li {
  text-align: center;
}
#cssmenu .has-sub ul li a {
  border-top: 0 none;
  border-left: 1px solid #d2d2d2;
  display: block;
  line-height: 120%;
  padding: 9px 5px;
  text-align: center;
} 
```

这是`HTML`

```
<head>
<link href="styles.css" rel="stylesheet" type="text/css">
</head>

<body>
<div id='cssmenu'>
<ul>
   <li class='active '><a href='index.html'><span>Home</span></a></li>
   <li class='has-sub '><a href='#'><span>Products</span></a>
      <ul>
         <li><a href='#'><span>Product 1</span></a></li>
         <li><a href='#'><span>Product 2</span></a></li>
      </ul>
   </li>
   <li><a href='#'><span>About</span></a></li>
   <li><a href='#'><span>Contact</span></a></li>
</ul>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T11:51:53.500

Normally you have to show some work that you tried. But I'm guessing you have no clue on what is with that css.

You only need to modify your css, add this after your css:

```
#cssmenu ul {
  width:200px;
}

#cssmenu > ul > li {
  float: none;
}
#cssmenu .has-sub ul {
  top: -1px;
  left: 200px;
}
#cssmenu a {
  display: block;
}

#cssmenu .has-sub ul li a {
  border-top: 1px solid #d2d2d2;
} 
```

[JSFiddle Example](http://jsfiddle.net/DRACa/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:16:07.573

请记住，HTML 只包含内容，而不包含样式。这意味着您可以删除 CSS 并只留下一个无序列表，这对于任何类型的菜单都是很好的语义标记。从那里开始，使用新的 CSS 将其构建成垂直菜单，或者其他任何东西。如果你愿意，你可以按照 CSS 教程来制作你想要的菜单类型，因为任何教程都应该以与你的相似的 HTML 开头。

（虽然我们在讨论语义，但我应该指出，所有的`span`s 和包装器`div`都是不必要的，没有它们也可以创建一个工作菜单。）

# iphone - 代码签名错误：org.apache.cordova.cordovalibapptests.CordovaLibApp' Xcode4.3 中的错误

> ID：12475959
> 
> 赞同：1
> 
> 时间：2012-09-18T11:18:06.647
> 
> 标签：iphone, ios, cordova, xcode4.3

我是phonegap的新手。现在我在 Xcode4.3 中的 phonegap2.0 中工作。我已经在我的狮子 Mac 中安装了 phonegap2.0。现在我按照以下链接进行操作：

```
"http://docs.phonegap.com/en/2.0.0/cordova_camera_camera.md.html#Camera" 
```

用于在 phonegap（Phonegap API'S）中创建相机。现在 Phonegap Api 正在 Simulatore5 中工作。但是当通过 Ipod 设备运行编码时。它显示以下错误：

```
"Code Sign error: A valid provisioning profile matching the application's Identifier 'org.apache.cordova.cordovalibapptests.CordovaLibApp' could not be found" 
```

有人可以帮我解决这个问题吗？ ![在此处输入图像描述](../Images/56f0cdd8c3fcf9c08f18c0a56c814c43.png) 我已附上错误页面的屏幕截图。

# validation - 验证 textField 中的第一个字符是否为大写字母和字母 - Zend Framework 2

> ID：12475967
> 
> 赞同：0
> 
> 时间：2012-09-18T11:18:36.720
> 
> 标签：validation, zend-framework2

是否有任何标准验证类来检查文本字段中的第一个字符是否是大写字母和字母，或者应该为此编写自己的验证器，我已经阅读了关于[Alnum 和 Alpha](http://framework.zend.com/manual/1.12/en/zend.validate.set.html)的标准验证文档，但由于我的要求是具体来说，我想得到 Zend 程序员的意见

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:23:10.753

您可以使用`RegexValidator`或编写自己的。

为这个特殊目的创建自己的验证器的好处是：您的代码变得更具可读性（使用`FirstCharIsUppercaseLetter`验证器与读取 a 的正则表达式`RegexValidator`）和 b。您可以预先定义默认的验证错误消息。

我可能会使用 来创建这样的验证器`AlphaValidator`来验证第一个字符是一个字母，然后检查应用于第一个字符的[mb_strtoupper](http://de.php.net/mb_strtoupper)是否等于原始的第一个字符。

// 编辑：为了获得最佳可用性，根据您要执行的操作，过滤器也可以完成这项工作（以确保第一个字母是大写的）。有一个`StrToUpper`过滤器，您可以轻松扩展它以仅更改第一个字符。因此，如果用户忘记大写他的输入，它会自动完成，而无需查看它。

# c# - 在一个简单的 C# Metro 应用程序中崩溃，错误代码为 0x5d039293

> ID：12475970
> 
> 赞同：2
> 
> 时间：2012-09-18T11:18:41.797
> 
> 标签：c#, microsoft-metro

我的项目是在 C# Grid 模板项目上创建的。只有布局和数据不同。在项目详情页面中，有 5 张图片和 1 篇文章。通过执行以下操作：进入一项详细信息页面，然后返回，然后重新输入，然后返回，经过几个步骤（如果速度快，则为 10 步），应用程序崩溃。

**注意：**在桌面上是可以的，但在显示器上会发生，设备（pad）也会发生。最后一个是app无法通过windows store认证的原因。

以下是在 VS 2012 中使用 win 8 RTM 报告的错误：

> 致命的执行引擎错误
> 
> **消息：**运行时遇到致命错误。错误地址位于线程 0x1a84 上的 0x5d039293。错误代码为 0x80131544。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。

有人可以帮忙吗？

PS：这是一个非常非常简单的项目，我什至通过模板创建了一个，只是更改了项目详细信息页面的布局并添加了要加载的图像和文本。所以当然它没有使用一些错误/疯狂/荒谬的代码，甚至没有访问网络。在 loadState/saveState 方法中，可以引用 C# Grid 模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:32:29.500

This sounds like what I ran into last night, actually. It is well known from recent release previews and is still persistent. There is no known solution, and you can't catch and handle the error, nor can you debug it. It's a total explosion.

The issue can sometimes be worked around by adding an element, such as a border, around images in your application.

It has something to do with navigating between separate pages and image load/animation events. For my project, I simply reduced my navigation and had all of my substantial effort take place on one page, programatically adding and removing elements as necessary, to avoid frame.navigate

See the following:

[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/0dcffd79-3848-4cc3-839d-ab7d3544f80a](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/0dcffd79-3848-4cc3-839d-ab7d3544f80a)

# android - 覆盖项目未显示

> ID：12475972
> 
> 赞同：2
> 
> 时间：2012-09-18T11:18:44.477
> 
> 标签：android, google-places-api, itemizedoverlay

我在数组列表中获得了附近地点的所有搜索结果，但我无法在地图上显示它们。

当我调试我的应用程序时，在`SitesOverlay()`构造函数中添加断点时，这些位置*会被*填充，但如果我作为 android 应用程序运行则不会。

我的代码如下：

```
public class Map1 extends MapActivity {
private MapView map = null;
private MyLocationOverlay me = null;
double source_lat;
double source_lng;
double destination_lat = 12.899915;
double destination_lng = 80.243969;
Boolean isLocationFound = false;
List<Place> arlPlaces = new ArrayList<Place>();

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    new Thread(new Runnable() {

        public void run() {
            System.out.println("@#@#@#@# main() @#@#@#@#");
            String strRequestUrl = "";
            try {

                URL url = new URL(strRequestUrl);
                URLConnection yc = url.openConnection();
                BufferedReader in = new BufferedReader(
                        new InputStreamReader(yc.getInputStream()));
                String inputLine;
                Place place = null;

                while ((inputLine = in.readLine()) != null) {

                    if (inputLine.contains("name")) {
                        place = new Place();
                        place.setStrName(inputLine.substring(
                                inputLine.indexOf(">") + 1,
                                inputLine.lastIndexOf("<")));
                    }
                    if (inputLine.contains("vicinity")) {
                        place.setStrAddress(inputLine.substring(
                                inputLine.indexOf(">") + 1,
                                inputLine.lastIndexOf("<")));
                    }
                    if (inputLine.contains("lat")) {
                        place.setDblLatitude(Double.valueOf(inputLine
                                .substring(inputLine.indexOf(">") + 1,
                                        inputLine.lastIndexOf("<"))));
                    }
                    if (inputLine.contains("lng")) {
                        place.setDblLongitude(Double.valueOf(inputLine
                                .substring(inputLine.indexOf(">") + 1,
                                        inputLine.lastIndexOf("<"))));
                        arlPlaces.add(place);
                    }
                }
                in.close();

            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }).start();

    map = (MapView) findViewById(R.id.map);

    map.getController().setCenter(getPoint(12.899915, 80.243969));
    map.setStreetView(true);
    map.setSatellite(false);
    map.getController().setZoom(15);
    map.setBuiltInZoomControls(true);

    Drawable marker = getResources().getDrawable(R.drawable.marker);

    marker.setBounds(0, 0, marker.getIntrinsicWidth(),
            marker.getIntrinsicHeight());

    map.getOverlays().add(new SitesOverlay(marker));

    me = new MyLocationOverlay(this, map);
    map.getOverlays().add(me);
    Button b1 = (Button) findViewById(R.id.button1);
    Button b2 = (Button) findViewById(R.id.button2);
    Button btnNearby = (Button) findViewById(R.id.button3);

    btnNearby.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

        }
    });

    b2.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            switch (v.getId()) {
            case R.id.button2:
                if (map.isSatellite() == false) {

                    map.setSatellite(true);

                }

                break;

            }
        }
    });

    b1.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            switch (v.getId()) {
            case R.id.button1:
                if (map.isSatellite() == true) {

                    map.setSatellite(false);

                }
                break;
            }
        }
    });
}

@Override
protected boolean isRouteDisplayed() {
    return (false);
}

private GeoPoint getPoint(double lat, double lon) {
    return (new GeoPoint((int) (lat * 1000000.0), (int) (lon * 1000000.0)));
}

private class SitesOverlay extends ItemizedOverlay<OverlayItem> {
    private List<OverlayItem> items = new ArrayList<OverlayItem>();

    public SitesOverlay(Drawable marker) {
        super(marker);

        boundCenterBottom(marker);
        items.add(new OverlayItem(getPoint(12.899915, 80.243969), "",
                "Mantri Signature Villas" + "\n" + "ECR Link Road, Chennai"));

        Iterator<Place> iterator = arlPlaces.iterator();

        while (iterator.hasNext()) {
            Place place = (Place) iterator.next();
            System.out.println("@#@$#@#$@#!#@$@$#@ iterator");
            items.add(new OverlayItem(getPoint(place.getDblLatitude(),
                    place.getDblLongitude()),place.getStrName(), place.getStrAddress()));

        }

        populate();
    }

    @Override
    protected OverlayItem createItem(int i) {
        return (items.get(i));
    }

    @Override
    protected boolean onTap(final int i) {
        // Toast.makeText(A.this,
        // items.get(i).getSnippet(),
        // Toast.LENGTH_SHORT).show();

        AlertDialog.Builder alert = new AlertDialog.Builder(Map1.this);

        if (items
                .get(i)
                .getSnippet()
                .equalsIgnoreCase(
                        "Mantri Signature Villas\nECR Link Road, Chennai")) {
            alert.setTitle(items.get(i).getSnippet());
            alert.setMessage("Would you like to find the Route?");
            // alert.setIcon(R.drawable.mnlo);
            alert.setPositiveButton("Yes",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {

                            LocationManager locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
                            Location myLocation1 = locationManager
                                    .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                            Location myLocation = locationManager
                                    .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

                            if (myLocation != null) {
                                String uri = "http://maps.google.com/maps?saddr="
                                        + (myLocation.getLatitude())
                                        + ","
                                        + (myLocation.getLongitude())
                                        + "&daddr="
                                        + destination_lat
                                        + ","
                                        + destination_lng;
                                Intent intent = new Intent(
                                        android.content.Intent.ACTION_VIEW,
                                        Uri.parse(uri));
                                intent.setClassName(
                                        "com.google.android.apps.maps",
                                        "com.google.android.maps.MapsActivity");
                                startActivity(intent);
                            } else if (myLocation1 != null) {
                                String uri = "http://maps.google.com/maps?saddr="
                                        + (myLocation1.getLatitude())
                                        + ","
                                        + (myLocation1.getLongitude())
                                        + "&daddr="
                                        + destination_lat
                                        + ","
                                        + destination_lng;
                                Intent intent = new Intent(
                                        android.content.Intent.ACTION_VIEW,
                                        Uri.parse(uri));
                                intent.setClassName(
                                        "com.google.android.apps.maps",
                                        "com.google.android.maps.MapsActivity");
                                startActivity(intent);
                            } else {
                                Intent intent = new Intent(
                                        getBaseContext(), Map1.class);
                                startActivity(intent);

                            }

                        }
                    });
            alert.setNegativeButton("No",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                        }
                    });

            alert.show();
        } else {
            alert.setTitle(items.get(i).getSnippet());
            alert.setMessage("Would you like to find the Route?");
            alert.setPositiveButton("Yes",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {

                            String uri = "http://maps.google.com/maps?saddr="
                                    + items.get(i).getPoint()
                                    + "&daddr="
                                    + destination_lat
                                    + ","
                                    + destination_lng;
                            Intent intent = new Intent(
                                    android.content.Intent.ACTION_VIEW, Uri
                                            .parse(uri));
                            intent.setClassName(
                                    "com.google.android.apps.maps",
                                    "com.google.android.maps.MapsActivity");
                            startActivity(intent);

                        }
                    });
            alert.setNegativeButton("No",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                        }
                    });

            alert.show();
        }

        return (true);
    }

    public int size() {
        return (items.size());
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:28:42.007

您应该在线程完成后填充地图。您的代码不会等到它在 start() 方法之后完成。

我建议您尝试在线程末尾使用 Hanlder，或者使用 AsyncTask。我赞成后者。

它可能在调试期间工作，因为您的线程在您将标记添加到地图之前已完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T09:03:56.473

下面是用于在地图视图上显示道路的代码，这可能无法 100% 为您工作，因为您可能需要调整自己的代码，但请随时提出问题。

在您的活动中：

```
public class NavigationTask extends AsyncTask<Void, Void, Void> {
    Road mRoad;
    String startname = "", destname ="";
    @Override
    protected Void doInBackground(Void... params) {
        String url = getUrl(Double.parseDouble(driveobj.get("startLocationLat")), Double.parseDouble(driveobj.get("startLocationLon")), Double.parseDouble(driveobj.get("endLocationLat")), Double.parseDouble(driveobj.get("endLocationLon")));
        String json = Internet.request(url, null);
        mRoad = RoadProvider.getRoute(json);

        return null;
    }

    @Override
    protected void onPostExecute(Void result) {
        //from.setText(startname);
        //to.setText(destname);

        MapOverlay mapOverlay = new MapOverlay(mRoad, mapview);
        List<Overlay> listOfOverlays = mapview.getOverlays();
        listOfOverlays.add(mapOverlay);
        mapview.invalidate();
        super.onPostExecute(result);
    }

}

public String getUrl(double fromLat, double fromLon, double toLat, double toLon) {
    StringBuffer urlString = new StringBuffer();
    urlString.append("http://maps.googleapis.com/maps/api/directions/json?origin=");
    urlString.append(Double.toString(fromLat));
    urlString.append(",");
    urlString.append(Double.toString(fromLon));
    urlString.append("&destination=");// to
    urlString.append(Double.toString(toLat));
    urlString.append(",");
    urlString.append(Double.toString(toLon));
    urlString.append("&sensor=true");
    return urlString.toString();
} 
```

MapOverlay 类

```
class MapOverlay extends com.google.android.maps.Overlay {
    Road mRoad;
    ArrayList<GeoPoint> mPoints = new ArrayList<GeoPoint>();;

    public MapOverlay(Road road, MapView mv) {
        mRoad = road;
        if (road.points.size() > 0) {
            mPoints.addAll(road.points);
            showMarkers(mPoints);
            int moveToLat = (mPoints.get(0).getLatitudeE6() + (mPoints.get(mPoints.size() - 1).getLatitudeE6() - mPoints.get(0).getLatitudeE6()) / 2);
            int moveToLong = (mPoints.get(0).getLongitudeE6() + (mPoints.get(mPoints.size() - 1).getLongitudeE6() - mPoints.get(0).getLongitudeE6()) / 2);
            GeoPoint moveTo = new GeoPoint(moveToLat, moveToLong);

            int minLatitude = Integer.MAX_VALUE;
            int maxLatitude = Integer.MIN_VALUE;
            int minLongitude = Integer.MAX_VALUE;
            int maxLongitude = Integer.MIN_VALUE;
            for (GeoPoint p : mPoints) {
                int lati = p.getLatitudeE6();
                int lon = p.getLongitudeE6();

                maxLatitude = Math.max(lati, maxLatitude);
                minLatitude = Math.min(lati, minLatitude);
                maxLongitude = Math.max(lon, maxLongitude);
                minLongitude = Math.min(lon, minLongitude);
            }

            MapController mapController = mv.getController();
            mapController.zoomToSpan(Math.abs(maxLatitude - minLatitude), Math.abs(maxLongitude - minLongitude));
        }
    }

    @Override
    public boolean draw(Canvas canvas, MapView mv, boolean shadow, long when) {
        super.draw(canvas, mv, shadow);
        drawPath(mv, canvas);
        return true;
    }

    public void drawPath(MapView mv, Canvas canvas) {
        int x1 = -1, y1 = -1, x2 = -1, y2 = -1;
        Paint paint = new Paint();
        paint.setColor(LO.titleBackgroundColor+0xDE000000);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeWidth(3);
        for (int i = 0; i < mPoints.size(); i++) {
            Point point = new Point();
            mv.getProjection().toPixels(mPoints.get(i), point);
            x2 = point.x;
            y2 = point.y;
            if (i > 0) {
                canvas.drawLine(x1, y1, x2, y2, paint);
            }
            x1 = x2;
            y1 = y2;
        }
    }
} 
```

MarkerOverLay 类：

```
class MarkerOverlay extends ItemizedOverlay<OverlayItem> {
    private ArrayList<OverlayItem> overlays = new ArrayList<OverlayItem>();

    public MarkerOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));
    }

    public void addOverlay(OverlayItem overlay) {
        overlays.add(overlay);
        populate();
    }

    @Override
    protected OverlayItem createItem(int i) {
        return overlays.get(i);
    }

    @Override
    public int size() {
        return overlays.size();
    }

} 
```

RoadProvider 类：

```
public class RoadProvider {

public static Road getRoute(String json) {
    Road road = new Road();
    try {
        JSONObject route = new JSONObject(json);
        JSONArray routes = route.getJSONArray("routes");
        JSONArray legs = routes.getJSONObject(0).getJSONArray("legs");
        JSONArray steps = legs.getJSONObject(0).getJSONArray("steps");
        for(int i = 0, len = steps.length(); i < len; i++) {
            JSONObject step = steps.getJSONObject(i);
            if(i == 0) {
                if(step.has("start_location")) {
                    JSONObject start = step.getJSONObject("start_location");
                    double lon = Double.parseDouble(start.getString("lng"));
                    double lat = Double.parseDouble(start.getString("lat"));
                    GeoPoint point = new GeoPoint((int)(lat * 1E6), (int)(lon * 1E6));
                    road.add(point);
                }
            }
            if(step.has("end_location")) {
                JSONObject start = step.getJSONObject("end_location");
                double lon = Double.parseDouble(start.getString("lng"));
                double lat = Double.parseDouble(start.getString("lat"));
                GeoPoint point = new GeoPoint((int)(lat * 1E6), (int)(lon * 1E6));
                road.add(point);
            }

        }
    } catch (Exception e) {
        e.fillInStackTrace();
        return null;
    }
    return road;
}
} 
```

# delphi - 查找用户可见的所有控件

> ID：12475974
> 
> 赞同：8
> 
> 时间：2012-09-18T11:18:54.797
> 
> 标签：delphi, delphi-xe2

如何找到用户当前可见的表单上的所有控件？即列出所有可以通过选项卡添加到视图中且不隐藏的控件（例如，在不可见的选项卡表上）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T11:28:26.970

由于您写的是要列出可以使用选项卡的控件，因此我假设您正在谈论窗口控件。

然后你可以简单地做

```
procedure TForm1.Button1Click(Sender: TObject);
var
  i: integer;
begin
  for i := 0 to ComponentCount - 1 do
    if Components[i] is TWinControl then
      if TWinControl(Components[i]).CanFocus then
        Memo1.Lines.Add(Components[i].Name)
end; 
```

如果您知道表单拥有它的所有子控件并且没有其他控件。否则，你必须这样做

```
procedure AddVisibleChildren(Parent: TWinControl; Memo: TMemo);
var
  i: Integer;
begin
  for i := 0 to Parent.ControlCount - 1 do
    if Parent.Controls[i] is TWinControl then
      if TWinControl(Parent.Controls[i]).CanFocus then
      begin
        Memo.Lines.Add(Parent.Controls[i].Name);
        AddVisibleChildren(TWinControl(Parent.Controls[i]), Memo);
      end;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  AddVisibleChildren(Self, Memo1);
end; 
```

# javascript - 从内部函数访问外部函数变量

> ID：12475987
> 
> 赞同：4
> 
> 时间：2012-09-18T11:19:58.610
> 
> 标签：javascript

如何`x`从函数 B() 更改函数 A() 中的值

```
function A() {
    var x = 10; // Value to be changed
    function B() {
        var x = 20;
        // From here i want to change the value of x (i.e. x=10 to x=40)
    }
    B();
}

A(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T11:28:18.247

`var`打算覆盖变量时不要使用。使用`var`创建一个新变量，在声明它的范围内是本地的。这就是为什么`x`在外面没有改变。

```
function A() {
    var x = 10;
    function B() {
        x = 20; // change x from 10 to 20
    }

    B(); // x is now changed
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T11:29:44.113

如果我理解您的问题，以下代码是一个解决方案：

```
function A() {
    var x = 10; // Value to be changed
    function B() {
        var x = 20;
        // From here i want to change the value of x (i.e. x=10 to x=40)
        changeX(40);
    }
    function changeX(y) {
        x = y;
    }
    B();
    alert(x);
}

A(); 
```

但是还有更优雅的方法，但这取决于您的应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T11:27:02.863

也许：

```
function A() {
    var x = 10; // Value to be changed
    function B() {
        var x = 20;
        return x; // Return new value of x
    }
    x = B(); // Set x to result returned by B(), i.e. the new value
}

A(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T11:53:38.050

该`var`语句将创建新的局部变量。所以在你的例子中：

```
function A() {
    var x = 10; // You can think of it as A.x
    function B() {
        var x = 20; // And this as A.B.x
    }
} 
```

这两个变量属于不同的范围，如果您想从内部范围内访问外部范围的变量，只需访问它，而无需重新声明它。

您可能想查看[http://www.planetpdf.com/codecuts/pdfs/tutorial/jsspec.pdf](http://www.planetpdf.com/codecuts/pdfs/tutorial/jsspec.pdf)上提供的“JavaScript 语言规范”文档，以了解 JavaScript 中的作用域、语句和其他基础知识如何工作。

# php - 将图片发布到具有隐私权的相册，以便每个人都可以看到即图表

> ID：12475988
> 
> 赞同：1
> 
> 时间：2012-09-18T11:20:09.643
> 
> 标签：php, facebook-graph-api, facebook-javascript-sdk, privacy

这是我的代码。我需要设置隐私让每个人都可以看到图片，但它似乎不起作用，只有朋友可以看到图片而不是每个人。

```
<script> 
    var token="<?php echo $_SESSION['access_token'];?>";
            $.post("https://graph.facebook.com/<?php echo $sqlr['regidfriendsid']; ?>/feed", { 
        access_token: token, 
        picture: "https://mysite/_n.jpg" ,
        link: "https://www.mysite.com/login.php?ref=owall",
        caption: "Check ur Intelligence ",
        privacy: '{value: "EVERYONE"}',
        message: " Click to know your intelligence level? "
    });

    </script> 

` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:33:45.237

您可以设置隐私查看：

NETWORKS_FRIENDS

看看这个网址：

[http://developers.facebook.com/docs/reference/rest/photos.createAlbum/](http://developers.facebook.com/docs/reference/rest/photos.createAlbum/)

```
<script> 
var token="<?php echo $_SESSION['access_token'];?>";
        $.post("https://graph.facebook.com/<?php echo $sqlr['regidfriendsid']; ?>/feed", { 
    access_token: token, 
    picture: "https://mysite/_n.jpg" ,
    link: "https://www.mysite.com/login.php?ref=owall",
    caption: "Check ur Intelligence ",
    privacy: '{value: "EVERYONE"}',
    message: " Click to know your intelligence level? "
});

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:44:48.287

试试这个，然后让我知道——

```
privacy: {value: "EVERYONE"}, 
```

代替 -

```
privacy: '{value: "EVERYONE"}', 
```

# html - 从网页中提取文本信息

> ID：12475989
> 
> 赞同：-1
> 
> 时间：2012-09-18T11:20:09.607
> 
> 标签：html, text

我正在尝试创建一个网页来复制它从其他网页获得的一些文本，但我不知道该怎么做。

举个例子：http站点A上面有一个数字，即用户加载页面时特定位置的风速。我确切地知道它在页面上的位置，就像它始终是页面上的第三个数字，或者它会以`wind speed:`或其他东西开头；我有一个常规的表达或我知道会从页面给我想要的东西的东西，并且我有网页所有者的许可使用他们的信息或其他东西。我希望能够从页面中获取此号码，并将其放在我自己的网页上。

有没有办法只使用 HTML 来做到这一点？还是我需要使用其他东西来获取信息，比如 javascript？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:33:26.327

通常，向其他站点提供信息的页面使用 Web 服务来提供信息。

这样，这样的页面将在选定的 url 上有一个方法，您可以访问该方法以获取信息。

根据它的实现方式，您可以直接在 HTML 页面中加载 Web 服务的响应。但是，建议使用 AJAX 调用 Web 服务并操纵响应。

当然，如果没有可用的 Web 服务，并且您将从纯 html 文本中删除信息，那么您肯定需要 javascript 来为您完成任务，那么仅通过 HTML 就无法做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:12:53.907

正如 Bardo 所说，您有 2 个选择。首先是Web服务，其次是通过JavaScript解析页面或者，很简单，只需尝试找到您要提取的信息的位置，您可以在页面中搜索特定模式并提取信息。

# algorithm - 无需额外空间或就地合并排序

> ID：12475991
> 
> 赞同：1
> 
> 时间：2012-09-18T11:20:22.150
> 
> 标签：algorithm, sorting, language-agnostic

> **可能重复：**
> [如何使用归并排序算法就地排序？](https://stackoverflow.com/questions/2571049/how-to-sort-in-place-using-the-merge-sort-algorithm)

通常我们需要一个额外的数组来使用归并排序对其进行排序，是否可以在不使用额外空间的情况下做到这一点？

如果这是可能的，那么合并排序会比快速排序更好吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:36:43.923

是的，可以执行[就地合并排序](https://stackoverflow.com/q/2571049/166749)。~~这并不意味着它不需要任何额外的内存，因为递归仍然需要 O(lg *n* ) 堆栈空间（就像快速排序一样）。~~

**编辑**：我已经很久没有阅读 Katajainen 的论文了，而且我从来没有关注过空间复杂度的说法；显然，合并排序*可以*在 O(1) 额外空间中完成。

但是，不，这并不意味着一种算法比另一种*更好*，除非您指定该词的含义。随机快速排序虽然可以进行二次排序，但无论输入如何，它仍然执行较少的预期操作。哪一个对您的数据“效果更好”取决于从数据统计到程序运行的硬件等因素。

# objective-c - Obj-c中方法声明的规则是什么？我可以直接使用没有声明的方法吗？

> ID：12475992
> 
> 赞同：6
> 
> 时间：2012-09-18T11:20:23.137
> 
> 标签：objective-c, xcode4.4

在 Xcode4.4 中，我发现我可以直接使用 .m 文件中定义的方法，而无需在 .h 头文件或 .m 文件中声明。

Obj-c中方法声明的规则是什么？我可以在头文件中使用没有声明的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T11:21:52.183

如果您在头文件中声明了一个方法，那么其他类将能够访问该方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:24:44.180

每当您想使用标头中声明的方法时，您都可以导入标头。

因此，如果您创建了一个名为`ObjectA`then 的类，以便能够使用您在其中声明的方法，则`ObjectA.h`需要导入它`#import "ObjectA.h"`。

您通常只需要在实现`.m`文件中进行导入。如果您在头文件中需要它，可以使用如下`@class`注释：

```
@class ObjectA
...
@property (nonatomic, strong) ObjectA *objectA; 
```

# c# - 连接事件时如何转换 EventArgs？

> ID：12475998
> 
> 赞同：7
> 
> 时间：2012-09-18T11:20:42.073
> 
> 标签：c#, .net, events

在 .NET 应用程序中，事件通常以这种方式连接：

```
 public event EventHandler<ChangeEventArgs> OnChange
    {
        add { _dependency.OnChange += value; }
        remove { _dependency.OnChange -= value; }
    } 
```

但是，这仅在被连接的事件具有相同的事件处理程序时才有效。在我目前的情况下，原始事件 args 是库专有的，我不想将其公开给客户端代码。所以我有某种适配器（ChangeEventArgs）。如何使用上面的代码转换事件参数？我想像下面的东西（但下面的代码不起作用）

```
 public event EventHandler<ChangeEventArgs> OnChange
    {
        add { _dependency.OnChange += Convert(value); }
        remove { _dependency.OnChange -= Convert(value); }
    } 
```

或者

```
 public event EventHandler<ChangeEventArgs> OnChange
    {
        add { _dependency.OnChange += value(this, Convert(args)); }
        remove { _dependency.OnChange -= value(this, Convert(args)); }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T11:37:01.503

试试这个：

```
public class SomeClassAdapter
{
    private readonly SomeClass obj;

    public SomeClassAdapter(SomeClass obj)
    {
        this.obj = obj;
        this.obj.SomeEvent += HandleSomeClassSomeEvent;
    }

    private void HandleSomeClassSomeEvent(object sender, SomeEventArgs args)
    {
        OnSomeEvent(ConvertEventArgs(args));
    }

    private MyEventArgs ConvertEventArgs(SomeEventArgs args)
    {
        // the magic goes here...
    }

    protected virtual void OnSomeEvent(MyEventArgs args)
    {
        var handler = SomeEvent;
        if (handler != null)
        {
            handler(this, args);
        }
    }

    public event EventHandler<MyEventArgs> SomeEvent;
} 
```

**更新。**
此代码使用的适配器模式版本比您的代码更复杂。`SomeClassAdapter`是一个适配器`SomeClass`（它`SomeClass`在其私有字段中有实例`obj`）。

客户端代码订阅*我的* `SomeClassAdapter.SomeEvent`. 反过来，我的代码订阅了`SomeClass.SomeEvent`. 当`SomeClass.SomeEvent`被触发时，我的事件处理程序 ( `HandleSomeClassSomeEvent`) 被调用。此事件处理程序转换`SomeEventArgs`为`MyEventArgs`并引发`SomeClassAdapter.SomeEvent`.

所以，我们有链：`SomeClass.SomeEvent`-> `HandleSomeClassSomeEvent`-> `SomeClassAdapter.SomeEvent`。看起来像“事件代理”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:22:59.440

您需要在这里做几件事，我会假设您的`Convert()`方法的返回类型将被调用`SupportedChangeEventArgs`

正常的模式将是：

```
public event EventHandler<SupportedChangeEventArgs> Changed; // per http://msdn.microsoft.com/en-us/library/h0eyck3s%28v=vs.71%29.aspx 
```

添加有一个引发事件的虚拟成员

```
public virtual void OnChanged(ChangeEventArgs e)
{
    if( Changed != null )
    {
        Changed(this, Convert(e));
    }
} 
```

# jquery - 我可以为多个元素组合 jQuery 选择器吗？

> ID：12475999
> 
> 赞同：0
> 
> 时间：2012-09-18T11:20:47.307
> 
> 标签：jquery

我有以下起始 HTML：

```
<div id="modal" ><div class="modal-window">
<ul class="action-tabs right">
<li><a href="#" title="Close window">
<img src="/Content/images/icons/fugue/cross-circle.png" width="16" height="16"></a></li>
</ul>
<div class="block-content"><h1>xx</h1>
<div class="modal-content>
...
</div>
</div>
</div> 
```

从这里的建议中，我有以下 jQuery 代码：

```
$modal
    .find('.modal-content')
    .wrap("<form id='modal-form'>")
$modal
    .find('#modal-form')
    .find("button")
    .filter(function () {
        return $(this).text().toLowerCase().indexOf('submit') != -1;
    })
    .prop('type', 'submit'); 
```

我需要做的是找到类.modal-content 的第一次出现（实际上有一个）。然后我需要将它包装在`<form id="xxx"></form>"`.

接下来我需要查看表单，找到所有带有文本提交的按钮并将它们更改为“提交”类型。

我认为上面的代码可以做到这一点，但我想知道我是否可以让它更简单。我也有一些不同的方法来做 .wrap 的建议。这些建议是：

```
$('.modal-content').wrap('<form id="xxx" />');
$(".modal-content").wrap('<form id="xx"></form>');
$( '.modal-content' ).wrapAll( '<form />' ); 
```

它们都可以正确使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:37:38.617

我认为它不能变得**那么**简单，但也许可以尝试：

```
$modal
    .find('.modal-content:first')
    .wrap('<form id="modal-form" />')
    .find("button")
    .filter(function () {
        return $(this).text().toLowerCase().indexOf('submit') != -1;
    })
    .prop('type', 'submit'); 
```

我认为`wrap()`返回原始元素`.modal-content`，因此您应该能够在其中找到按钮，而无需`find()`在`form`元素上执行另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:53:46.677

您可以像这样定义不区分大小写`:contains`：

```
$.extend($.expr[':'], {
  "contains-ci": function(elem, i, match) {
    return jQuery.fn.text.apply(elem).toLowerCase().indexOf(match[3].toLowerCase()) > -1;
  }
}); 
```

进而：

```
$modal
.find('.modal-content')
.wrap('<form id="modal-form">')
.find('button:contains-ci("submit")')
.prop('type', 'submit'); 
```

此解决方案假定按钮一直都在那里，您只需在它们周围包裹一个表单。