# StackOverflow 问答 10610000-10610999

# python - 一些python日期操作

> ID：10610007
> 
> 赞同：-4
> 
> 时间：2012-05-15T23:04:26.230
> 
> 标签：python

我对 Python 有点陌生。我需要两个功能。第一个应该获取当前日期，然后返回该月的开始和结束日期，例如，如果当前日期是 02/12/2012，它应该返回 02/01/2012 和 02/29/2012。第二个函数执行类似的操作，但返回上个月的开始和结束日期。请问我怎么能在Python中做到这一点？感谢期待

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:21:47.633

好吧——我很无聊。

首先，除非您来自火星或其他地方，否则我们在地球上每个月都以`1`. 安全假设。

唯一具有挑战性的部分是该月的天数。你可以从[calendar.monthrange()](http://docs.python.org/library/calendar.html#calendar.monthrange)

```
>>> import calendar
>>> calendar.monthrange(2012,2)
(2, 29) 
```

第二个数字是当年那个月的结束日。所以你可以这样做：

```
import calendar
import datetime

def mSandE(yy,mm):
    lastDay=calendar.monthrange(yy,mm)[1]
    dt1=datetime.date(yy, mm, 1)
    dt2=datetime.date(yy, mm, lastDay)
    return (dt1, dt2)

def prevmSandE(yy,mm):
    dt=mSandE(yy,mm)[0]
    dt=dt-datetime.timedelta(days=1)
    lastDay=calendar.monthrange(dt.year,dt.month)[1]
    return (dt.replace(day=1),datetime.date(dt.year,dt.month,lastDay))

print mSandE(2012,2)        
print prevmSandE(2012,2)
print prevmSandE(2012,1) 
```

印刷：

```
(datetime.date(2012, 2, 1), datetime.date(2012, 2, 29))
(datetime.date(2012, 1, 1), datetime.date(2012, 1, 31))
(datetime.date(2011, 12, 1), datetime.date(2011, 12, 31)) 
```

# ios - superimpose UIActivityInidicator on UISwitch

> ID：10610011
> 
> 赞同：0
> 
> 时间：2012-05-15T23:04:35.230
> 
> 标签：ios

i have a uiswitch in each tableViewCell that initiates a network action. I want to superimpose a uiActivityInidicator over the switch until the server answers. I have seen this done with a uibarbutton.

I have added code to this previously working method that has a subclassed UISwitch, but no spinner is displayed.

any ideas?

```
- (IBAction)changeState:(id)sender {
    Plug *plug = [self.fetchedResultsController objectAtIndexPath:       ((NamedUISwitch*)sender).indexPath];
    if(((NamedUISwitch*)sender).on){
        plug.state = @"1";
    } else {
        plug.state = @"0";
    }

    NamedUISwitch *theSwitch=(NamedUISwitch*)sender;
    UIActivityIndicatorView *spinner=[[UIActivityIndicatorView    alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [spinner startAnimating];
    [theSwitch addSubview:spinner];
    // send message to server
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:21:20.890

As of iOS 5.x, UIActivityIndicator conforms to UIAppearance, and so it now has a [color property](https://developer.apple.com/library/ios/documentation/uikit/reference/UIActivityIndicatorView_Class/Reference/UIActivityIndicatorView.html#//apple_ref/occ/instp/UIActivityIndicatorView/color) which changes the color of the spinner.

# ios - ios在运行时更改故事板默认视图控制器

> ID：10610012
> 
> 赞同：5
> 
> 时间：2012-05-15T23:04:38.873
> 
> 标签：ios, uiviewcontroller, storyboard

是否可以从情节提要中覆盖默认视图控制器以显示不同的控制器？当然，这一切都会发生在 AppDelegate 中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T13:46:34.683

@Martol1ni 我想使用你的答案，但我也想远离不必要的故事板混乱，所以我稍微调整了你的代码。但是，我确实为您的鼓舞人心的答案给了您+1。

我将以下所有内容放在默认控制器上。

```
- (void)gotoScreen:(NSString *)theScreen
{
    AppDelegate *app = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    UIViewController *screen = [self.storyboard instantiateViewControllerWithIdentifier:theScreen];
    [app.window setRootViewController:screen];
} 
```

然后在逻辑发生的地方，我会根据需要调用以下代码。

```
if(myBool == YES) {
    [self gotoScreen:@"theIdentifier"];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T00:30:51.913

我肯定会在 UINavigationController 中嵌入一个 rootView，所以你没有两个，而是三个视图。一个永远不会启动，只是控制所有其他的。然后像这样实现其中的方法：

```
- (void) decideViewController  {
    NSString * result;
    if (myBool) {
        result = @"yourIdentifier";
    }
    else {
        result = @"yourOtherIdentifier";
    }
    self.navigationController.navigationBarHidden = YES; // Assuming you don't want a navigationbar
    UIViewController *screen = [self.storyboard instantiateViewControllerWithIdentifier:@"view1ident"];
    [self.navigationController pushViewController:screen animated:NO]; // so it looks like it's the first view to get loaded
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self decideViewController];
} 
```

它永远不会看起来像第一个视图已加载。如果您使用的是 NIBS，您可以从 AppDelegate 执行所有操作...

# c# - 授权如何在本地网络上运行的应用程序中工作？

> ID：10610013
> 
> 赞同：0
> 
> 时间：2012-05-15T23:04:40.580
> 
> 标签：c#, .net, entity-framework

在 Web 应用程序中，为了获取数据，我们可以先请求用户进行身份验证。身份验证也在 Web 服务器端完成。

本地网络应用程序呢，不涉及服务，应用程序直接连接到数据库（数据库位于服务器 PC 上）。我该怎么做：这张表只能由经过身份验证的用户读取，这张表只能由所有用户读取，等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:13:37.233

未经身份验证，您无法连接到数据库（mySQl、Oracle、SQLServer）。

通常您会将连接信息存储在配置文件中，但您也可以不这样做并要求您的用户提供他们自己的凭据。

大多数 SGBD 将允许您为每个用户配置读/写权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:20:10.073

如果我正确理解您的问题如果网络上的所有用户都属于域使用 Windows 身份验证，那么您的连接字符串将类似于：

```
Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI; 
```

否则您将不得不使用用户身份验证：

```
 Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword; 
```

这些都是为 sql server 完成的：

其他人检查[一下](http://www.connectionstrings.com/)。
希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:15:02.970

您需要以与 Web 应用程序相同的方式为数据库本身配置权限。通常，如果是桌面客户端，您将授予用户 Web 应用程序在足够的权限下运行以在数据库中执行所有操作 - 向各个用户授予适当的权限。

请注意，这种设计比通常可以接受的更多的数据库访问权限。

# javascript - Javascript style.left 是空字符串

> ID：10610015
> 
> 赞同：2
> 
> 时间：2012-05-15T23:04:43.213
> 
> 标签：javascript

```
next.onclick = function() { 
    move('left', li_items[0]);
};

var move = function(direction, el) {
    pos = el.style[direction].split('px')[0];
    pos = parseInt(pos, 10) + 10; 
    el.style[direction] = pos + 'px';
}; 
```

我正在使用上面的简单代码来尝试移动元素。现在，当我对此断点时，值为`el.style[direction]`：`" "`。因此，当我尝试对它做任何事情时，它就会中断。为什么会这样？不`style.left`应该返回一个整数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T23:07:14.103

> 为什么会这样？

大概是因为它没有被设置为任何东西。

> style.left 不应该返回一个整数吗？

不，它应该返回一个字符串，其中包含直接在元素上设置的 CSS left 属性的值（通过设置 JS 属性本身或使用样式属性）。它不会从级联中获取值，并且如果值为 0，它应该只是一个整数（因为所有其他长度都需要单位）。

如果您想获取属性的计算值而不是我在上一段中描述的值，请参阅[如何获取 HTMLElement 的计算样式。](https://stackoverflow.com/questions/3953353/how-to-get-computed-style-of-a-htmlelement)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:07:23.603

`style`提供从 CSS 计算出来的原始样式，而不是更新的可能是动态的样式。你可能想要`currentStyle`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:16:39.323

只是一个评论。

在您的代码中：

```
> pos = el.style[direction].split('px')[0];
> pos = parseInt(pos, 10) + 10; 
```

第一行中的拆分是多余的，第二行中的拆分`parseInt`将（比方说）转换为与您所拥有`10px`的数字`10`一样有效（并且更有效）的数字。

```
pos = parseInt(el.style[direction], 10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T23:21:39.520

```
next.onclick = function() { 
    move('left', li_items[0]);
};

var move = function(direction, el) {
    var lft = document.defaultView.getComputedStyle(el)[direction];
    pos = parseFloat(lft);
    pos = parseInt(pos, 10) + 10; 
    el.style[direction] = pos + 'px';
}; 
```

***注意：**就像 Elliot 说的，你必须得到 currentStyle/computedStyle。这是[一种](http://blog.stchur.com/2006/06/21/css-computed-style/)使其跨浏览器的方法，但是当通过 JS 应用样式时，这是一个很好的案例，其中某种框架（例如 Prototype [Scriptaculous]、jQuery）会很有用。*

# google-drive-api - 谷歌驱动器信用令牌错误

> ID：10610016
> 
> 赞同：1
> 
> 时间：2012-05-15T23:04:59.217
> 
> 标签：google-drive-api

我截断了用户表，现在我无法运行该应用程序，日志中总是出现此错误：

> [2012 年 5 月 15 日 22:56:58] 验证和授权用户时出错：获取 OAuth2 访问令牌时出错，消息：'invalid_grant'
> 
> [2012 年 5 月 15 日 22:56:59] 验证和授权用户时出错：获取 OAuth2 访问令牌时出错，消息：'invalid_grant'
> 
> [2012 年 5 月 15 日 22:56:59] 验证和授权用户时出错：获取 OAuth2 访问令牌时出错，消息：'invalid_grant'
> 
> [2012 年 5 月 15 日 22:57:00] 从数据库检索用户或更新刷新令牌时出错：SQLSTATE[23000]：违反完整性约束：1048 列“刷新令牌”不能为空
> 
> [2012 年 5 月 15 日 22:57:00] PHP 致命错误：未捕获的异常 'PDOException' 带有消息 'SQLSTATE[23000]：完整性约束违规：1048 列 'refresh_token' 不能为 null' 在 /var/www/drivecrypt/ www/auth_handler.php:214
> 
> 堆栈跟踪：
> 
> #0 /var/www/drivecrypt/www/auth_handler.php(214): PDOStatement->execute()
> 
> #1 /var/www/drivecrypt/www/auth_handler.php(244): AuthHandler->CreateUserInDb(Object(Userinfo), NULL)
> 
> #2 /var/www/drivecrypt/www/auth_handler.php(293): AuthHandler->GetUser(Object(Userinfo), NULL)
> 
> #3 /var/www/drivecrypt/www/index.php(48): AuthHandler->VerifyAuth() #4 {main}
> 
> 在第 214 行抛出 /var/www/drivecrypt/www/auth_handler.php

你能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:10:36.313

列“refresh_token”不能为空

# asp.net - UpdatePanel 内的 DropDownList.SelectedIndexChanged 导致调用 UpdatePanel 外部的 ObjectDataSource.SelectMethod

> ID：10610020
> 
> 赞同：1
> 
> 时间：2012-05-15T23:05:42.653
> 
> 标签：asp.net, updatepanel, objectdatasource

我有一个 asp.net 页面：

*   更新面板
*   对象数据源
*   一个网格视图

更新面板如下所示：

```
<asp:UpdatePanel ID="MyUpdatePanel" runat="server">
    <ContentTemplate>

         <asp:DropDownList ID="MyDropDownList" runat="server"
                           AutoPostBack="True">
             ...
         </asp:DropDownList>

         <asp:TextBox ID="MyTextBox" runat="server" />

         <asp:Button ID="MySubmitButton" runat="server" text="Submit" />

    </ContentTemplate>
</asp:UpdatePanel> 
```

当用户在下拉列表中选择一个选项时，文本框会发生某些事情，它可能被启用或禁用，或者它可能被填充或清空（取决于所选选项）。此更改不应影响页面的其余部分（这就是我将其放在 UpdatePanel 中的原因）。

现在，在更新面板之外，我有了页面的其余部分。像这样：

```
<asp:ObjectDataSource ID="MyObjectDataSource" runat="server"
                          SelectMethod="MySelect" 
                          TypeName="MyType">
    <SelectParameters>
        <asp:ControlParameter Name="Parameter1" Type="String" ControlID="MyDropDownList" PropertyName="SelectedValue" />
        <asp:ControlParameter Name="Parameter2" Type="String" ControlID="MyTextBox" PropertyName="Text" />
    </SelectParameters>
</asp:ObjectDataSource>

<asp:GridView ID="MyGridView" runat="server" 
                  AutoGenerateColumns="False" 
                  DataKeyNames="MY_ID"
                  DataSourceID="MyObjectDataSource">
        <Columns>
            ....
        </Columns>
</asp:GridView> 
```

同样，ObjectDataSource 和 GridView 位于 UpdatePanel 之外。

但是每当我在下拉列表中选择一个选项时，就会调用 MyObjectDataSource 的 SelectMethod！

我做错了什么？

在此先感谢您的帮助。

更新：

我尝试将 MyObjectDataSource 和 MyGridView 放置在单独的更新面板中，但页面窗台具有相同的行为:-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T23:39:26.020

我找到了解决方案。

1.  将 asp:ControlParameters 替换为 asp:Parameters。
2.  在 MySubmitButton.Click() 事件中添加了对 MyGridView.DataBind 的调用。
3.  为 MyObjectDataSource.Selecting() 事件中的参数赋值。

现在 MyObjectDataSource 的 SelectedMethod 仅在用户单击 MySubmitButton 时才被调用。

:-)

# ruby-on-rails - 将数据摄取到 MongoDB 会导致“堆栈级别太深”

> ID：10610025
> 
> 赞同：2
> 
> 时间：2012-05-15T23:06:23.050
> 
> 标签：ruby-on-rails, mongodb, mongomapper

我有一堆记录存储在 mongodb 集合（StudentRecord）中。这些需要分解为具有嵌入式文档 StudentGrade 的 Student 类型的集合。出于某种原因，我用来执行此摄取的 rake 任务不断达到“堆栈级别太深”。我无法检测到任何递归调用，我正在使用 bundle exec 来执行它（ruby 1.9.2-p320）。

```
任务：parse_student_records =>：环境做
  StudentRecord.all.each{|student_record|
    学生 = Student.create({:name => student_record.name})
    student.grades « Grade.create({:score => student_record.grade_score)
    学生。保存！
  }
结尾

班级学生
  包括 MongoMapper::Document
  许多：等级
  键：名称，字符串
结尾

班级成绩
  包括 MongoMapper::EmbeddedDocument
  键：grade_score，字符串
结尾

```

将文档作为独立文档而不是嵌入文档来修复它..由于某种原因，嵌入会导致问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T14:01:03.383

那是[第 265](https://github.com/jnunemaker/mongomapper/pull/265)期，是我知道的为数不多的数字之一。

为了让回调以正确的顺序触发嵌入文档，MongoMapper 必须构建一个巨大的堆栈，该堆栈随着嵌入文档的数量线性增长。在大约 600-800 个文档时，堆栈溢出。

`ActiveSupport::Callbacks`是一个巨大的混乱，需要重写才能干净地避开问题（它在 Rails 头上不那么混乱，但仍然需要重写）。

问题 265 中的当前提案是禁用回调。

```
# in Gemfile
gem 'mongo_mapper', :git => 'git://github.com/jnunemaker/mongomapper.git', :ref => 'fefec91027f2dd8eb1ab9caa5a4b0acd000f4da7' 
```

进而：

```
class Student
  include MongoMapper::Document
  embedded_callbacks_off
  # ...
end 
```

# android - 如何在 android 中使用 flex 读取短信？

> ID：10610026
> 
> 赞同：0
> 
> 时间：2012-05-15T23:06:23.160
> 
> 标签：android, actionscript-3, apache-flex, air, sms

我正在使用 flex 为 android 开发应用程序。该应用程序应该从 android 读取短信并对其进行分析。我如何阅读短信？我在整个互联网上搜索过，找不到任何有用的文章。

有没有办法做到这一点而不是使用本机扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:50:01.387

> "Is there any way to do that instead of using native extention?"

Send sms - yes, but only by calling the device's native SMS client.

Receive/read incoming sms - no.

The Air mobile API includes features that allows you to *send* SMS messages by invoking the device's native SMS client. There are tutorials available online how to do this, for example [this](http://shaileshmakwana.blogspot.com/2010/12/adobe-air-2.html) one.

The Air mobile API does not includes methods that allow you to *read* incoming SMS messages. To implement this on an Android device you would have to write your own Native Extension.[This](https://stackoverflow.com/questions/4117701/android-sms-broadcast-receiver) answer on SO explains how to set up a BroadcastReceiver using the Native Android SDK to listen for incoming SMS messages. If you need help on how to implement your own Native Extensions, the [Adobe Developer pages](http://www.adobe.com/devnet/air/native-extensions-for-air.html) on the subject is a good start.

# caching - jQuery .get 缓存工作得太好了？

> ID：10610034
> 
> 赞同：4
> 
> 时间：2012-05-15T23:07:22.237
> 
> 标签：caching, jquery

我正在使用 jQuery .get() 函数加载模板文件，然后通过定位特定的 DOM 元素将加载的 HTML 显示到页面的一部分中。它运作良好，但我最近意识到它正在缓存我的模板文件并掩盖我所做的更改，这让我感到困惑。

不要误会我的意思……我和下一个人一样喜欢缓存。当客户端的缓存和服务器上的文件之间没有时间戳差异时，我希望它缓存。然而，事实并非如此。更奇怪的是……使用相同的函数来加载模板……一些模板文件正在加载更新，而另一些则没有（更喜欢缓存版本而不是最近的更改）。

下面是我使用的加载功能。

```
function LoadTemplateFile ( DOMlocation , templateFile , addEventsFlag ) {
    $.get( templateFile , function (data) {
        $( DOMlocation ).html(data);
    });
} 
```

任何帮助将不胜感激。

新细节：我一直在做一些调试，现在看到返回成功函数的“数据”变量确实具有更新的信息，但由于我尚不清楚插入 DOM 的原因是旧版本. 这到底是怎么发生的，现在成了我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T23:12:50.077

您可以在`jQuery.get()`通话中将缓存设置为关闭。有关该选项的详细信息，请参阅[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)文档。`cache: false`缓存如何工作的细节是特定于浏览器的，因此我认为您无法控制它的工作方式，无论它是打开还是关闭任何给定的调用。

仅供参考，当您关闭缓存时，jQuery 通过在 URL 的末尾附加一个唯一的时间戳参数来绕过浏览器缓存，这使得它不匹配任何先前的 URL，因此没有缓存命中。

您可能还可以控制服务器上的缓存寿命和其他几个缓存参数，这些参数将设置各种 HTTP 标头，指示浏览器允许哪些类型的缓存。在开发应用程序时，您可能希望完全关闭缓存。对于部署，我建议您打开它，然后在您修改应用程序时，处理缓存的最安全方法是稍微更改您的 URL，以便您的 URL 的新版本有所不同。这样，您始终可以获得最大缓存，而且用户也可以立即获得新版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:15:37.870

$get 默认会一直缓存，尤其是在 IE 上。您将需要手动附加一个查询字符串，[或使用 ajaxSetup 方法](https://stackoverflow.com/questions/367786/prevent-caching-of-ajax-call/735101#735101)来破坏缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T20:47:19.087

作为替代方案，我在 jQuery 文档中发现您可以覆盖默认缓存。对我来说，我不必将所有的 $.get 转换为 $.ajax 调用。请注意，这也会覆盖所有其他类型调用的默认行为，例如 $.getScript，它具有与缓存相反的默认行为：$.get 中的 false。

[https://api.jquery.com/jquery.getscript/](https://api.jquery.com/jquery.getscript/)

```
 $.ajaxSetup({
    cache: false
  }); 
```

# ruby - 将前导空格转换为 ruby 中的制表符

> ID：10610036
> 
> 赞同：4
> 
> 时间：2012-05-15T23:07:29.090
> 
> 标签：ruby, regex

给定以下缩进文本：

```
 two spaces
    four
      six
non-leading    spaces 
```

我想将每 2 个前导空格转换为一个制表符，本质上是从软制表符转换为硬制表符。我正在寻找以下结果（使用“x”而不是“\t”）：

```
xtwo spaces
xxfour
xxxsix
non-leading  spaces 
```

在 ruby​​ 中执行此操作的最有效或最有说服力的方法是什么？

到目前为止，我似乎正在工作，但感觉不对。

```
input.gsub!(/^ {2}/,"x")
res = []
input.split(/\n/).each do |line|
  while line =~ /^x+ {2}/
    line.gsub!(/^(x+) {2}/,"\\1x")
  end
  res << line
end
puts res.join("\n") 
```

我注意到使用 sed 和 \G的[答案：](https://stackoverflow.com/questions/1854152/convert-spaces-to-tabs-in-regex)

```
perl -pe '1 while s/\G {2}/\t/gc' input.txt >output.txt 
```

但我不知道如何模仿 Ruby 中的模式。据我所知：

```
rep = 1
while input =~ /^x* {2}/ && rep < 10
  input.gsub!(/\G {2}/,"x")
  rep += 1
end
puts input 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:51:29.873

`(?:^ {2})|\G {2}`在多线模式下 使用有什么问题？

第一个匹配总是在该行的开头，
然后 \G 将在其旁边连续匹配，否则匹配
将失败。下一场比赛将永远是该行的开头......重复。

在 Perl 中，它的`$str =~ s/(?:^ {2})|\G {2}/x/mg;`或`$str =~ s/(?:^ {2})|\G {2}/\t/mg;`

红宝石[http://ideone.com/oZ4Os](http://ideone.com/oZ4Os)

```
input.gsub!(/(?:^ {2})|\G {2}/m,"x") 
```

*编辑：* 当然可以将锚点分解并替换
[http://ideone.com/1oDOJ](http://ideone.com/1oDOJ)

```
input.gsub!(/(?:^|\G) {2}/m,"x") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:32:36.930

您可以为此使用单个 gsub：

```
str.gsub(/^( {2})+/) { |spaces| "\t" * (spaces.length / 2) } 
```

# java - 提交问题时带有图像的按钮标签

> ID：10610038
> 
> 赞同：0
> 
> 时间：2012-05-15T23:07:46.227
> 
> 标签：java, jsp

我正在使用一个

```
<button name="btn" value="Save"><img src="/image/save.png"/>Save</button>; 
```

在我的 JSP 页面中。当用户登陆页面时，用户看到的是保存文本左侧的按钮和图像。但是当表单提交时，在 request.getParameterValues() 中，它显示了按钮名称的值： `(name=value as btn = img src="/image/save.png"/ Save)`

出于安全考虑，我正在限制特殊字符，如`<`标志。所以我期待 btn 的 request.getParameterValues 应该返回“保存”而不是完整的`<img`标签。

有人遇到过这个问题吗？我不想使用 css 添加图像。

提前致谢。

尼莱什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:27:24.080

I'm not sure what you're asking but I'm guessing you're trying to display an image as a button?

Maybe try this:

```
<input type="image" src="/image/save.png" alt="Save" name="save" value="save"/> 
```

then in your JSP or Servlet:

```
String save = request.getParameter("save"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:22:43.007

如果您使用的是 IE，那么至少当我在 IE8 上对其进行测试时，这是预期的结果，它会将按钮标记之间的文本（去除了 HTML 标记）作为值发送到服务器。FF 和 Chrome 都返回设置为 value 属性的正确值。去[这里](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_button_name)测试。

# solr - Solr 搜索所有

> ID：10610045
> 
> 赞同：0
> 
> 时间：2012-05-15T23:08:43.477
> 
> 标签：solr

我添加到 solr 索引： "bull", "bulgarie", "bulltin", "bullhead" 。当我按“bul”搜索时，它只给了我带有“bul”的文章

应如何配置 schema.xml 以使用“bull*”示例获取所有结果：“bull”、“bulgarie”、“bulltin”、“bullhead”？

这是**schema.xml中的当前配置**

```
<fieldType name="text" class="solr.TextField" positionIncrementGap="100">
    <analyzer type="index">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="1" splitOnCaseChange="1"/>
        <filter class="solr.ASCIIFoldingFilterFactory" />
        <filter class="solr.SnowballPorterFilterFactory" language="French"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
    </analyzer>
    <analyzer type="query">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="0" generateNumberParts="0" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="0"/>
        <filter class="solr.ASCIIFoldingFilterFactory" />
        <filter class="solr.SnowballPorterFilterFactory" language="French"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
    </analyzer>
</fieldType> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T14:12:37.253

Solr 支持通配符查询。这也是范围查询的工作方式。通过以这种方式使用它，您的问题应该得到解决。

字段名：bul*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:31:34.400

您是否尝试过搜索“bul*”？有关 Lucene 中的通配符支持，请参阅[http://wiki.apache.org/lucene-java/LuceneFAQ#What_wildcard_search_support_is_available_from_Lucene.3F](http://wiki.apache.org/lucene-java/LuceneFAQ#What_wildcard_search_support_is_available_from_Lucene.3F)，我猜这与 Solr 非常相似。

# ruby-on-rails - 在活动记录中按“名称”获取列

> ID：10610047
> 
> 赞同：0
> 
> 时间：2012-05-15T23:08:46.750
> 
> 标签：ruby-on-rails, activerecord, select

我有一个返回表中的字段的选择语句。

```
records = Product.select("DISTINCT #{iFieldName}").where("id in (0, #{iInClaws})" ) 
```

我想将数据库中的数据转换为一个数组以供以后使用.. 比如说另一个 inClaws。

```
records.each{|record| fieldArray << record.?????} 
```

我有两个问题。

1.  有一个更好的方法吗？
2.  如果没有，那么我如何从现场获取数据。

* * *

谢谢大家。。大家过来帮忙后我的最终方法是这样的。

```
def self.getFieldArray(iFieldName, iIDsInClaws, iIdFieldName = 'id')
    records = self.select("DISTINCT #{iFieldName}").where("#{iIdFieldName} in (#{iIDsInClaws})" )
    return records.map{|record| record.send(iFieldName)};
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:14:12.183

```
records.each{|record| fieldArray << record.send(iFieldName)} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:28:36.697

```
fieldArray = records.map(&:iFieldName) 
```

或者

```
res = records.map{|r| r.send(iFieldName)} 
```

# android - 如何从android中的HashMap获取图像？

> ID：10610048
> 
> 赞同：0
> 
> 时间：2012-05-15T23:09:05.993
> 
> 标签：android, hashmap

```
 map = new HashMap<String, String>();
        map.put("titre", "Orange TN");
        map.put("WebSite","http://www.orange.tn/");
        map.put("mail","entreprises@orangetunisie.tn" );
        map.put("number","31 11 11 51");
        map.put("description", "Telecommunication - téléphonie fixe - téléphonie mobile - GSM - Internet - réseau - GPS - Andoid_iphone");
        map.put("lat","35.67233");
        map.put("longi","10.101422");
        map.put("img", String.valueOf(R.drawable.orange));
        listItem.add(map); 
```

问题是当我执行 map.get("img") 时我想这样做，这返回一个 String 并且我想要一个可绘制类型，然后我可以把它放在一个 Imageview 类型中。和thxxx这么多的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:30:22.077

```
 map = new HashMap<String, Object>();
    map.put("titre", "Orange TN");
    map.put("WebSite","http://www.orange.tn/");
    map.put("mail","entreprises@orangetunisie.tn" );
    map.put("number","31 11 11 51");
    map.put("description", "Telecommunication - téléphonie fixe - téléphonie mobile - GSM - Internet - réseau - GPS - Andoid_iphone");
    map.put("lat","35.67233");
    map.put("longi","10.101422");
    map.put("img", R.drawable.orange);
    listItem.add(map); 
```

After that you can use

`image1.setImageDrawable( getResources().getDrawable( map.get("img") );`

# objective-c - 如何使用objective-c中的标签访问标签

> ID：10610049
> 
> 赞同：2
> 
> 时间：2012-05-15T23:09:09.910
> 
> 标签：objective-c, uitableview

我正在实现一个 iphone 应用程序。它是一个 UItableview。它有两个部分。三个标签添加到第二部分中的所有单元格中，在添加到单元格时为这 3 个标签提供了标签 1、2、3。现在我想要从第一节的所有单元格中获取标签3的值，我想添加所有浮点值并在第二节的另一个标签中显示总数。我读到我应该为不同单元格的标签3提供不同的标签（带有标签 3 的标签）。怎么可能请指导我。我在标签 3 中有浮点值。我想添加所有值并在第二部分中显示结果。请帮助我提供一些参考。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
NSString* curItem = [self.finalItems objectAtIndex:indexPath.row];
NSString* curQuantity = [self.finalPrices objectAtIndex:indexPath.row];
NSString* priceStr = [self fetchDishRecordswithpredicate:curItem];
NSMutableString* priceValStr = [NSMutableString stringWithString:priceStr];
[priceValStr replaceCharactersInRange:NSMakeRange(0, 1) withString:@""];
float totalPrice = [curQuantity floatValue]*[priceValStr floatValue];
UILabel *lblTemp1 = (UILabel *)[cell viewWithTag:1];
UILabel *lblTemp2 = (UILabel *)[cell viewWithTag:2];
UILabel *lblTemp3 = (UILabel *)[cell viewWithTag:3];
switch (indexPath.section) {
    case 0: {
    lblTemp1.text = curItem;
    lblTemp2.text = curQuantity;
    lblTemp3.text = [NSString stringWithFormat:@"$ %0.2f", price];
    } break;
    case 1: {
        lblTemp1.text = @"Your Total:";
        lblTemp3.text = @"How can I get Total here";
    } break;
 }
return cell;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:17:02.460

永远不需要获取标签的值，无论它是表格单元格的一部分还是其他类型的视图。用户不能修改标签——它们仅用于显示。这意味着标签可以获得给定值的唯一方法是让您的程序设置该值，这反过来意味着您已经在某个地方获得了所需的数据。除了用于从用户获取输入的控件之外，这适用于任何类型的视图。

您希望从标签中获取值的事实可能意味着您正在使用视图来存储数据，这不是一个好习惯。视图显示数据，但该数据应存储在程序的其他位置，通常存储在数据模型中（假设您遵循 MVC 范例）。

综上所述，您可以使用它的`-cellForRowAtIndexPath:`方法从表格中获取给定行的单元格。从那里，您可以使用通常的`-viewWithTag:`方法访问单元格子视图。您绝对不需要为每个单元格设置一组唯一的标签 - 您只需要获取您感兴趣的行的单元格。但是，请记住，表格通常只保留周围可见的单元格; 如果您向它询问不可见行的单元格，它可能必须创建该单元格，这反过来将涉及向表格的委托（您自己的代码！）询问该单元格。这是一种非常昂贵的方式来询问自己已有的数据！;-)

# iphone - 如何在后台线程上定期从服务器轮询数据？

> ID：10610050
> 
> 赞同：0
> 
> 时间：2012-05-15T23:09:28.333
> 
> 标签：iphone, ios, multithreading, ipad, polling

我有一个类似应用程序的聊天，为了接收定期聊天，我想定期轮询服务器，比如 5 分钟......并检查是否有任何新消息。

作为初学者，我尝试过简单的 NSURLConnection 并发送和接收数据，但在轮询时卡住了。什么是正确的投票方式？我应该使用 NSTimer 定期轮询吗？有没有可以帮助我的示例代码？

我有一个在主线程上运行的计时器，它每 5 秒调用一次后台线程并向服务器发送请求。现在发生的事情是，没有调用 NSURLConnection 的代表。可以做什么？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:54:00.270

您可以在后台线程上启动 NSTimer 并定期调用主线程，这就是我的做法：

```
[self performSelectorOnMainThread:@selector(LaunchTimer) withObject:nil waitUntilDone:NO]; 
```

只需创建一个“LaunchTimer”函数，它会在某个时间间隔调用更新函数，该函数会调用 NSURLConnection，当您收到新消息时，通过调用主线程来更新聊天窗口，如下所示：

```
[self performSelectorOnMainThread:@selector(update:) withObject:newMessages waitUntilDone:NO]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T04:10:19.243

继续帕特里克的回答：-如果您可以在没有委托的情况下尝试 NSURLConnection，

```
 -(void)update:(id)objmessage
{
    NSString *post =[NSString stringWithFormat:@"timestamp=%@&user_id=%@",DatetimeString,UID];

    NSData *postData = [post dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];

    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:@"Your server URL"]];
    [request setHTTPMethod:@"POST"];
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];

    NSError *error;
    NSURLResponse *response;
    NSData *returnData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

    returnString=[[NSString alloc]initWithData:returnData encoding:NSUTF8StringEncoding];
    if(!returnString)
    {
        UIAlertView *erroralert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"There is an error getting response" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
        [erroralert show];
        [erroralert release];
    }
    else 
    {
        NSLog(@"%@",returnString);
    }
    SBJSON *json = [[SBJSON new] autorelease];
    NSMutableDictionary *dic = [[NSMutableDictionary alloc] initWithDictionary:[json objectWithString:returnString error:nil]];
    //NSLog(@"%@",dic);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T23:55:31.340

用以下方法解决了这个问题：

```
[self performSelectorOnMainThread:@selector(performPollinginBackground) withObject:nil   waitUntilDone:NO];

-(void)performPollinginBackground{

//call server task here

} 
```

# html - Tumblr 文字帖子上的图片说明

> ID：10610053
> 
> 赞同：2
> 
> 时间：2012-05-15T23:09:55.640
> 
> 标签：html, css, image, tumblr, caption

在 Tumblr 帖子上，如果它们是图片帖子，则标题放在图片下方。

我找不到如何在文本帖子上执行此操作，因此我们被迫在图像下方放置一个斜体段落。

即 [http://news.gain.org/post/23115584298/adaptation-is-essential-global-decision-makers](http://news.gain.org/post/23115584298/adaptation-is-essential-global-decision-makers)

有任何想法吗？

我的印象是我必须编辑主题的 HTML，但我找不到在哪里。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T16:54:22.097

转到[http://www.tumblr.com/customize](http://www.tumblr.com/customize)并按“编辑 HTML”</p>

[这](http://www.tumblr.com/docs/en/custom_themes#photo-posts)是用于照片帖子的 tumblr wiki

PS Tumblr 没有机会为文本帖子中的图像添加特殊标题。为了更灵活的样式，您可以添加带有自定义类（例如）的段落并使用如下代码`.photo-caption`控制它：`css`

```
.photo-caption {
    font-style: italic;
    /* or some other decoration, 
       which will be applied for all image-caption
       in all your posts */
} 
```

并将其粘贴到同一[自定义页面上的“自定义 CSS”字段中](http://www.tumblr.com/customize)

# python - 为什么 input() 的结果与我期望得到的不匹配？

> ID：10610056
> 
> 赞同：-6
> 
> 时间：2012-05-15T23:10:45.070
> 
> 标签：python, python-3.x

代码运行。但是由于某种原因，当我被提示输入 Sam 时，我得到了“你的名字不是 Sam”。

```
name = ["Sam"]
print ("What is your name?")
name_choice = input("Type Here: ")

if name == "Sam":
   print ("Your name is Sam")
else:
   print ("Your name isn't Sam") 
```

我正在使用 Python 3.2。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:13:10.747

用户输入位于 variable 中`name_choice`，但您将`name`其与“Sam”进行比较（因此**从不**使用用户输入）。

而且您还将字符串与列表进行比较，这将始终是`False`

```
In [32]: name = ['Sam']

In [33]: 'Sam' == name
Out[33]: False 
```

导致程序始终显示“你的名字不是 Sam”，无论用户输入什么。

```
if name_choice == 'Sam':
   print ("Your name is Sam")
else:
   print ("Your name isn't Sam") 
```

可能是你想做的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:13:45.413

好的，我会咬一口，这是一个稍微好一点的问题。您在这里有两个主要问题。

*   为什么要为 name 分配一个仅包含 的列表`"Sam"`？这是为了达到什么目的？
*   然后，您将用户输入分配给变量`name_choice`，该变量永远不会被使用。

我不太确定你的思维过程是什么——我认为这表明非常明显缺乏该语言的基本知识，我建议阅读[教程](https://www.google.com/search?btnG=1&pws=0&q=python+tutorial)。

还值得注意的是，打印用户提示，然后将实际提示用于`"Type Here:"`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:14:06.190

这是因为`name == ["Sam"]`（您将其设置为与第一行中的相同）并且`"Sam" != ["Sam"]`. 您正在尝试将列表与字符串进行比较。

另外，您可能想要做`if name_choice == "Sam"`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T23:15:20.323

我认为你应该在`name_choice`这里使用而不是`name`

```
if name == "Sam":
    print ("Your name is Sam") 
```

无论如何，变量的含义是什么`name`？

当发生这种情况时，一个很好的提示是在`if`

例如

```
print ("name ==", name)
if name == "Sam":
    print ("Your name is Sam") 
```

这将表明您正在将列表与字符串进行比较

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T23:15:30.167

首先，不确定这是否是故意的），`name = ["Sam"]`创建一个包含一个字符串元素的列表`"Sam"`，这与字符串不同`"Sam"`

然后将此列表与单个字符串进行比较，而不是将输入的值与字符串（或者可能是列表的元素）进行比较

# java - 如何在 JBoss 中使用替代的 JDBC 池实现

> ID：10610064
> 
> 赞同：4
> 
> 时间：2012-05-15T23:12:06.653
> 
> 标签：java, jdbc, connection-pooling, jboss6.x

我们在 JBoss 6.1 的 JDBC 池中发现了一个非常严重的泄漏。

这是由于代码依赖于`close`连接上的方法来关闭底层语句。

尽管**WrappedConnection**确实关闭了它们，但代码如下[所示](http://grepcode.com/file/repo1.maven.org/maven2/org.jboss.jbossas/jboss-as-connector/6.1.0.Final/org/jboss/resource/adapter/jdbc/WrappedConnection.java#133)：

```
if (statements != null) {
  for (Iterator
       <Map.Entry<WrappedStatement, Throwable>> i=statements.entrySet().iterator(); 
       i.hasNext(); )
  {
     Map.Entry<WrappedStatement, Throwable> entry = i.next(); 
     WrappedStatement ws= entry.getKey();
     if (trackStatements==BaseWrapperManagedConnectionFactory.TRACK_STATEMENTS_TRUE_INT)
     {
       Throwable stackTrace = entry.getValue();
       log.warn("Closing a statement you left open, please do your own housekeeping",
                 stackTrace);
     }
     try
     {
       ws.internalClose();
     }
     catch (Throwable t)
     {
       log.warn("Exception trying to close statement:", t);
     }
   }
 } 
```

statements 对象永远不会从其映射中删除语句，并且映射不断增长，并且这些语句保存结果集等（至少在我正在使用的 JDBC 驱动程序中）。

我想知道是否有人曾经用比这更强大的替代实现替换了 JBoss 中的 jdbc 池？

* * *

作为对此的一个小补充，代码和行为与结果集相同（基本上是复制和粘贴），尽管如果您不坚持任何时间长度的语句，内存泄漏可能并不严重（不像连接，按设计存在于池中）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:18:11.130

未能关闭底层语句不是 JBOSS 池泄漏。我相信责任在于您的数据库供应商的 JDBC 驱动程序实现。如果我没记错的话，众所周知，当连接关闭时，Oracle 的驱动程序并没有关闭底层资源（至少在 2006 年是这样）。不知道有没有改正。

[http://www.theserverside.com/discussions/thread.tss?thread_id=41036](http://www.theserverside.com/discussions/thread.tss?thread_id=41036)

责任*永远*是你的。

建议您关闭 finally 块中的所有 ResultSet 和 Statement 实例，分别包装在 try/catch 块中，以与创建相反的顺序。

如果这是正确的，并且您同意，那么更改池实施是不够的。您必须检查您的代码并自己完成。如果您很聪明并且设计在一个干净的持久层中，那么它应该相对容易。

很抱歉没有早点阅读您的代码。我不知道你为什么要`Statement`输入一个`Map`，尤其是一个不是`WeakHashMap`. `Statement`我的建议是将所有`ResultSet`实例紧密绑定在持久层内。在方法范围内创建和关闭它们；没有缓存。

如果你要分析代码，我想你会发现这里没有任何节省。这些类都不是线程安全的，所以挂在它们上面可能会导致一些相当讨厌的错误。您的应用程序也将更具可扩展性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T14:48:22.190

JBoss 将其用于数据源的连接池部署为资源适配器 RAR。默认情况下，有两个可用`jboss-local-jdbc.rar`和`jboss-xa-jdbc.rar`in`deploy`文件夹。要使用的连接工厂和包装器在`META-INF/ra.xml`

因此，选择是根据您声明的数据源替换这些资源适配器中的一个或两个。但是实现必须支持资源征募到与 JTS 的事务以及安全检查。

不是那么容易的工作，你可能会是第一个这样做的人。

# r - 在启动 R 会话时安装包

> ID：10610067
> 
> 赞同：2
> 
> 时间：2012-05-15T23:12:46.927
> 
> 标签：r, customization

我对 R 编程相当陌生。我正在尝试自定义我的 R 设置，以便在启动 R 会话时在开始时安装一些包。我知道我可以在 Rprofile.site 文件中编写一个 .First() 函数。但是，在 .First() 函数中添加我的安装包代码后，该包不会被安装。

此外，它似乎进入了一个尝试创建包的循环，它在 R 的库文件夹中创建了一个锁定文件。这导致我的计算机真的变慢（几乎到了它被冻结的程度），因为它一直在尝试安装该软件包。

这是我添加到 Rprofile.site 文件末尾的代码。

```
.First <- function() {
  install.packages("customPackage.tar.gz", repos=NULL, type="source")
  cat("\nWelcome to R on ", date(), "\n") 
} 
```

我什至尝试在文件中单独添加 install.packages 行（没有 .First() 函数）无济于事。

customPackage.tar.gz 是指我使用我编写的现有代码构建的包。由于这是一个自定义包，因此 repos 为 NULL。如果我没有在我的 .First() 函数中包含这一行，而只是在启动 R 会话后运行该命令，则该包会很好地安装在 R/R-2.15.0/library 文件夹中。

在 R 会话开始时，我需要安装几个自定义包，这就是为什么在 Rprofile.site 文件中添加所有这些安装代码行很重要的原因。关于如何做到这一点的任何想法？我在网上看到的关于自定义 Rprofile.site 文件的所有地方都显示了仅使用已经存在的库的示例（例如，库（R2HTML）），但没有安装新库。谢谢您的帮助！

编辑：感谢您的帮助！实际上，我确实需要为每个用户在多台机器上安装这些包，而不是让他们手动安装包一次，我认为在站点文件中这样做会很好。我尝试了贾斯汀的建议，先检查包裹，结果奏效了！再次感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T23:19:56.883

除非你从一台电脑切换到另一台电脑，否则你的库中应该已经有这个包（也就是说，一旦你安装了一个包，它就应该一直在那里）。使用`installed.packages() [,1]`或`library()`查看库中的所有包。如果你在那里看到它，那么使用这个：

```
.First <- function() {
  require(customPackage)
  cat("\nWelcome to R on ", date(), "\n") 
} 
```

# audio - a-law/原始音频数据

> ID：10610070
> 
> 赞同：0
> 
> 时间：2012-05-15T23:13:10.480
> 
> 标签：audio, hex, alsa

我整个晚上都在处理内置 ALSA 工具 aplay 和 arecord 的原始 A-law 音频输入/输出，并将它们通过我编写的离线移动平均滤波器。

我的问题是：音频似乎是使用 0x2A 和 0xAA 之间的值编码的 - 范围为 128。我一直在阅读[本](http://www.eetasia.com/ARTICLES/2001MAY/2001MAY21_NTEK_DSP_AN.PDF)指南，该指南提供了丰富的信息，但并没有真正解释为什么选择了 42 (0x2A) 的偏移量。我用来检查的文件是从 Audacity 导出为无符号 8 位 8kHz 音频并在十六进制编辑器中检查的方波。

任何人都可以阐明A-law是如何在文件中编码的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-15T18:55:33.813

这可能会有所帮助；

**/dev/dsp**

*每秒 8000 帧，每帧 8 位（1 字节）；*

```
# Max volume = \xff (or \x00).
# No volume = \x80 (the middle). 
```

# python - 将正则表达式匹配附加到字典

> ID：10610074
> 
> 赞同：1
> 
> 时间：2012-05-15T23:13:37.953
> 
> 标签：python, regex, match

我有一个文件，其中包含以下信息：

```
dogs_3351.txt:34.13559322033898
cats_1875.txt:23.25581395348837
cats_2231.txt:22.087912087912088
elephants_3535.txt:37.092592592592595
fish_1407.txt:24.132530120481928
fish_2078.txt:23.470588235294116
fish_2041.txt:23.564705882352943
fish_666.txt:23.17241379310345
fish_840.txt:21.77173913043478 
```

我正在寻找一种方法来匹配冒号并将之后出现的任何内容（数字）附加到字典中，字典的键是每行开头的动物名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:21:42.333

实际上，只要您的数据格式正确且没有意外，正则表达式是不必要的。

假设这`data`是一个包含您上面列出的字符串的变量：

```
dict(item.split(":") for item in data.split()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:23:09.993

没有正则表达式并使用[defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict

data = """dogs_3351.txt:34.13559322033898
cats_1875.txt:23.25581395348837
cats_2231.txt:22.087912087912088
elephants_3535.txt:37.092592592592595
fish_1407.txt:24.132530120481928
fish_2078.txt:23.470588235294116
fish_2041.txt:23.564705882352943
fish_666.txt:23.17241379310345
fish_840.txt:21.77173913043478"""

dictionary = defaultdict(list)
for l in data.splitlines():
    animal = l.split('_')[0]
    number = l.split(':')[-1]
    dictionary[animal] = dictionary[animal] + [number] 
```

只需确保您的数据格式正确

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:17:19.367

```
t = """
dogs_3351.txt:34.13559322033898
cats_1875.txt:23.25581395348837
cats_2231.txt:22.087912087912088
elephants_3535.txt:37.092592592592595
fish_1407.txt:24.132530120481928
fish_2078.txt:23.470588235294116
fish_2041.txt:23.564705882352943
fish_666.txt:23.17241379310345
fish_840.txt:21.77173913043478
"""

import re

d = {}
for p, q in re.findall(r'^(.+?)_.+?:(.+)', t, re.M):
    d.setdefault(p, []).append(q)

print d 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T23:17:24.833

为什么不使用 python`find`方法来定位可用于分割字符串的冒号索引。

```
>>> x='dogs_3351.txt:34.13559322033898'
>>> key_index = x.find(':')
>>> key = x[:key_index]
>>> key
'dogs_3351.txt'
>>> value = x[key_index+1:]
>>> value
'34.13559322033898'
>>> 
```

将文件的每一行作为文本读入，并按上述方式单独处理这些行。

# c++ - 获取位置内存指针指向的字符串的大小

> ID：10610079
> 
> 赞同：-1
> 
> 时间：2012-05-15T23:13:59.293
> 
> 标签：c++

我想获取本地 C++ 中位置内存指针指向的字符串的字符：

对于 C# 中的等效实现，它将是：

```
int positionMemory = getPosition();

long size = 10;

string result = Marshal.PtrToStringAnsi(new IntPtr(positionMemory), size); 
```

如何在 C++ 中生成结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:35:47.470

我有一种感觉，这将导致问题在路上......

以下内容应该或多或少等同于您提供的 C# 片段，但结果字符串（存储在 中`result`）仍将是 'ANSI' - 它不会像 C# 片段中那样扩展为 UNICODE。

```
int positionMemory = getPosition();
long size = 10;

std::string result( reinterpret_cast<const char *>(positionMemory), size); 
```

请注意，`size`字符将被放置在`result`- 包括`'/0'`字符中，因此如果您尝试将字符串传递给期望使用 C 样式的字符串，`c_str()`您可能会得到一些意想不到的结果。

此外，关于使用 an`int`作为指针的常见警告（特别是如果您希望它希望在 64 位系统上工作）适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:24:06.797

假设“字符串”是一个`char`s 序列，它位于内存`positionMemory`中以空结尾表示的位置，您可以通过以下方式获得长度`strlen`

```
const char* str = static_cast<const char*>(positionMemory);
int length = strlen(str); 
```

但是，从创建字符串的演示代码来看，这可能是您想要的，并且是更好的代码：

```
std::string result = static_cast<const char*>(positionMemory);
int length = result.length(); 
```

# iphone - 在 Objective-C 中处理数组的更好方法？

> ID：10610080
> 
> 赞同：2
> 
> 时间：2012-05-15T23:14:05.523
> 
> 标签：iphone, objective-c, arrays, nsmutablestring

请让我以道歉的方式开始这个问题。我对 Objective C 很陌生。不幸的是，我的工作项目时间很紧，需要尽快跟上进度。

下面的代码有效。我只是想知道是否有更好的方法来处理这个......也许更可可的东西。该函数的全部目的是获取字符串中具有特定值的位置的有序列表。

出于舒适的原因，我回到了标准阵列。我最初声明的 NSMutableString 仅用于测试目的。作为这门语言的一个完整的菜鸟，并且仍然围绕着 Objective C（和我猜的 C++）处理变量和指针的方式，任何和所有的提示、提示、指针都将不胜感激。

```
NSMutableString *mut = [[NSMutableString alloc] initWithString:@"This is a test of the emergency broadcast system.  This is only a test."];

NSMutableArray *tList = [NSMutableArray arrayWithArray:[mut componentsSeparatedByString:@" "]];

int dump[(tList.count-1)];
int dpCount=0;
NSUInteger length = [mut length];
NSRange myRange = NSMakeRange(0, length);

while (myRange.location != NSNotFound) {

    myRange = [mut rangeOfString:@" " options: 0 range:myRange];

    if (myRange.location != NSNotFound) {
        dump[dpCount]=myRange.location;
        ++dpCount;
        myRange = NSMakeRange((myRange.location+myRange.length), (length - (myRange.location+myRange.length)));
    }
}

for (int i=0; i < dpCount; ++i) {
    //Going to do something with these values in the future... they MUST be in order.
    NSLog(@"Dumping positions in order: %i",dump[i]);
}
text2.text = mut;
[mut release]; 
```

再次感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:31:20.460

没有很好的方法来做你想做的事情。这是一种方法：

```
// locations will be an NSArray of NSNumbers -- 
// each NSNumber containing one location of the substring):
NSMutableArray *locations = [NSMutableArray new];
NSRange searchRange = NSMakeRange(0,string.length);
NSRange foundRange;
while (searchRange.location < string.length) {
    searchRange.length = string.length-searchRange.location;
    foundRange = [string rangeOfString:substring options:nil range:searchRange];
    if(foundRange.location == NSNotFound) break;
    [locations addObject:[NSNumber numberWithInt:searchRange.location]];
    searchRange.location = foundRange.location+foundRange.length;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:20:41.690

这可能会更精简（如果重要的话，执行时间也会更快）：

```
const char *p = "This is a test of the emergency broadcast system.  This is only a test.";
NSMutableArray *positions = [NSMutableArray array];

for (int i = 0; *p; p++, i++)
{
    if (*p == ' ') {
        [positions addObject:[NSNumber numberWithInt:i]];
    }
}

for (int j = 0; j < [positions count]; j++) {
    NSLog(@"position %d: %@", j + 1, [positions objectAtIndex:j]);
} 
```

# hibernate - JPA/Hibernate 选择元素不在集合中

> ID：10610091
> 
> 赞同：0
> 
> 时间：2012-05-15T23:15:41.507
> 
> 标签：hibernate, jpa, jpql

如果我有两个实体类，`Group`and ， and`Person`之间是一对多的关系（即一个人最多可以属于一个组，一个组可以有很多人），我可以查询什么jpql/hql用于选择所有不在s中的s？`Group``Person``Person``Group`

有点像`select p from Group g inner join g.people p`...的反面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T13:16:08.840

如果你想让所有不在给定组g中的人，它应该像

```
from Person p where p.group.id != :gid; 
```

并将 gid 设置为给定组的 id。

如果您想拥有所有根本不属于任何组的人

```
from Person p where p.group.id is null; 
```

如果您想让所有人都不在任何组中，但 Person 中的外键可能有一个不为空但不属于现有组的组 id（例如，如果组被删除而不删除其中的人，而不是将他们移动到不同的组）

```
from Person p where not exist (select 1 from Group g where g.id = p.group.id); 
```

PS 我的陈述是针对 HQL 的，但对于 JPQL 它应该或多或少相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T14:55:40.963

这有效：

```
select p from Person p where p not in (select pg from Group g inner join g.persons pg) 
```

也许：

```
select p from Person p where not exists (select 1 from Group g where p member of g.persons) 
```

更有效率？

无论如何......欢迎评论哪个更有效，但由于这两个“工作”，将问题标记为已回答。

# objective-c - Objective-c 解析 JSON 响应

> ID：10610097
> 
> 赞同：-2
> 
> 时间：2012-05-15T23:16:48.997
> 
> 标签：objective-c, ios, json, uitableview, nsdictionary

我一直在做很多阅读，但我找不到任何接近我想要做的事情。我得到一个 JSON 响应并`UITableView`用结果填充 a。当用户选择`UITableView`我想要获取与显示的名称相关联的相应“id”值的行时。示例 JSON 响应：

```
{"active":true,"created_at":"2012-05-12T03:04:21Z","description":"Test 1",
"id":11,"name":"This Is A Test","updated_at":"2012-05-12T03:04:21Z"} 
```

因此，我设置`UITableView`了名称为 This Is A Test 的行，当用户选择我想要返回数字 11 时，我将其选中。在`didSelectRowAtIndexPath`功能中，我可以拉

```
UITableViewCell *selectedCell = [self.tableView cellForRowAtIndexPath:indexPath];

NSString *cellText = selectedCell.textLabel.text;

sc.selectedCategory = cellText; 
```

这会给我对象的名称，但我怎样才能再次调用字典并获取名称与所选单元格匹配的“id”值？我对objective-c 很陌生，但多年来一直在做java。任何例子都会很棒。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:41:57.477

你有一本字典。您需要将 Array `objectAtIndex`（tableview 索引路径）转换为`NSDictionary`对象，然后使用`valueForKey`.

类似以下内容`didSelectRowAtIndexPath`：

```
NSDictionary *selRow = (NSDictionary *)[myArray objectAtIndex:indexPath.row];
NSInteger myID = [[selRow valueForKey@"id"] intValue]; 
```

# c# - 在 C# 中的 try 块中抛出异常 - 通过将 nunit 附加到 VSS 调试器进行调试

> ID：10610101
> 
> 赞同：0
> 
> 时间：2012-05-15T23:17:18.763
> 
> 标签：c#

我正在使用 NUNIT 运行此测试用例，并将 NUNIT 附加到 Visual Studio 调试器（调试 ---> 附加到进程 ---> 选择 nunit.exe）。

我期待语句“抛出新异常（“发生异常1！”）；“将控件移动到catch块中，但控件不会跳转到“catch”，而是跳转到method2（）。

当我只运行 nunit 测试用例而不将 nunit.exe 附加到 Visual Studio 调试器时，代码运行正常。

```
public void test()
{
try
            {
                method1();
                if (condition1)
                {
                    throw new Exception("Exception 1 occured!");
                }

                method2();  
                if (condition2)
                {
                    throw new Exception("Exception 2 occured!");
                }

                method3();
                if (condition3)
                {
                    throw new Exception("Exception 3 occured!");
                }

            }
            catch (Exception Ex)  <---- Exceptions thrown above are caught here
            {
                logMessage(E.Message);
                throw;                  
            }                   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:24:25.577

Visual Studio 可能设置为中断所有异常，而不仅仅是未捕获的异常。因此，当它检测到您抛出异常时它会停止。在某些情况下，Visual Studio 不会出现在引发异常的行上中断，而是突出显示即将运行的下一行代码。

如果您继续单步执行代码，您应该会看到它进入`catch`下一个块。

# javascript - 具有默认“观察”操作的 FB Open Graph 脚本不起作用

> ID：10610106
> 
> 赞同：0
> 
> 时间：2012-05-15T23:17:55.783
> 
> 标签：javascript, facebook, facebook-opengraph

//更新：在帮助下，我设法捕获了一些修复令牌问题的错误。我已经更新了代码以反映这一点。不过，代码仍然不会在时间线上产生事件，所以我把问题留了下来。

原始问题：

我正在尝试使用 Open Graph API 构建一个简单的脚本，一旦访问者点击该页面，它将向 Facebook 推送指向已访问页面（包含电影）的链接。

我没有使用自定义操作和对象，而是使用标准 Watch 操作 (https://developers.facebook.com/docs/opengraph/video/) 和 Video.movi​​e 对象。

我根据FB的示例代码提出了这个：

```
<!-- first login-button with scope publish_actions: -->
<fb:login-button show-faces="false" width="200" max-rows="1" scope="publish_actions"    ></fb:login-button>

<!-- Then script that should push update to timeline: -->
<script type="text/javascript">
    function fbPublish(){
        FB.api(
        '/me/video.watches',
        'post',
        { 'video.movie': '<?php the_permalink(); ?>',
        'access_token': 'blablabla'  },
        function(response) {
           if (!response || response.error) {
              alert('Nope.');
           } else {
              alert('Yes.'); // any stuff
           }
        });
    } 
```

这会触发警报“不”。

我已经通过 curl 添加了 Watch 动作。关于可能发生什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:26:51.710

You still need to [FB.login](https://developers.facebook.com/docs/reference/javascript/FB.login/) before you can automatically post to the user's timeline.

```
FB.login(function(response) {
      // Post the action
 }, {scope: 'publish_actions'}); 
```

While I didn't check the validity of your actual code to post the action, you problem is that before you can do this, you'll need the user's permission. The `publish_actions` permission is the one you'll need but I think its already included in new Auth Dialogs. Just leave it there to be sure.

Do the FB.login code first, you'll get a popup "Allow" dialog, after that, is the time you can freely post in the user's wall. It's a part of the security, Facebook users wouldnt want you posting on their timeline without them knowing.

# php - 无需重定向页面的 PHP 表单验证警报

> ID：10610112
> 
> 赞同：0
> 
> 时间：2012-05-15T23:18:24.693
> 
> 标签：php, javascript, popup, alert

基本上发生的事情是我有一个 php 表单来发送电子邮件。一路上有几个不同的验证步骤，它们都很好用。如果在提交表单时出现验证错误，我想做的是弹出一个 javascript 警报。我有这个使用以下php：

```
// Validate email
if(!filter_var($EmailFrom, FILTER_VALIDATE_EMAIL))
{
  echo "<script language=javascript>alert('Please Use a Valid Email Address')</script>";
  exit;
} 
```

警报弹出，但页面重定向到 domain.com/sendemail.php，这给用户留下了空白页面。我真的很想在不重新加载页面的情况下弹出警报。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:49:43.510

您可以使用 ajax 来完成此操作。但是，如果您不想使用 ajax，而是在出错时退出，您可以使用查询字符串参数重定向回表单页面。

```
header("Location: http://www.example.com/form.php?error=1"); 
```

如果在您的表单页面上，您可以使用 php 放置脚本。就像是

```
<?php if(isset($_GET['error']) && $_GET['error']==1): ?>
<script>
....
</script>
<?php endif; ?> 
```

这将实现您正在寻找的东西。事实上，您可以执行多项检查并根据您的检查设置错误。但我仍然建议 Ajax 将提供更好的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:30:57.410

这是我在创建的某些表单中使用的脚本，用于快速验证它们。非常简单有效，希望对你有帮助。

```
<script type="text/javascript">
function validate(){ 
    emailfilter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    condition = 1;
    mensaje = "Complete: ";
    //Validate 1st input (Check if empty)
    if (document.formname.forminput1.value.length==0){ 
         condition = 0;
         msg = msg + "-Input 1 is empty "
    }
        //Validate 1nd input (Check email)
    if (!emailfilter.test(document.formname.forminput1.value)) {
         condition = 0;
         msg = msg + "-Input 1 has a invalid email adresss "
    }

    if (condition == 0){ 
         alert(msg) 
         document.formname.forminput1.focus() 
         return 0; 
    }

    //send
    alert("Form sended."); 
    document.formname.submit(); 
} 
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:36:55.413

**编辑：** 超级简单的解决方案，使用 jQuery 表单插件：http: [//jquery.malsup.com/form/](http://jquery.malsup.com/form/)

我在我的一些网络应用程序中做了类似的事情，你可能会发现它很有用。

我在服务器端进行验证，如果遇到错误，我会这样做：

```
json_die(array(
  'status' => 'error',
  'message'=> 'Your error message'
)); 
```

并为了成功：

```
json_die(array(
  'status' => 'success',
  'message'=> 'Your success message'
)); 
```

json_die 的功能是：

```
function json_die($array) {
        header("content-type: application/json");
        die(json_encode($array, true));
} 
```

然后在前端我做这样的事情：

```
 $.post('/your_url', {
                        'your': vars

                    }, function (r) {

                      if(r.status == 'success') {

                           alert(r.message);

                        } else if (r.status == 'error') {

                            alert(r.message);
                             //handle error

                        } else {
                           alert('server exploded / no connection');
                         }

                    },'json'); 
```

# html - 将超链接分配给 在 HTML 中

> ID：10610113
> 
> 赞同：0
> 
> 时间：2012-05-15T23:18:26.083
> 
> 标签：html

我想为`<p>Click here</p>`格式分配一个超链接，但是当我这样做时

```
<p href="http://www.ironspider.ca/format_text/hyperlinks.htm">
  Creating Hyperlinks
</p> 
```

超链接不显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:29:25.307

是的

```
 <p href="http://www.ironspider.ca/format_text/hyperlinks.htm">Creating Hyperlinks</p> 
```

改成

```
 <a href="http://www.ironspider.ca/format_text/hyperlinks.htm">Creating Hyperlinks</a> 
```

这个问题让我微笑，必须从某个地方开始！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:19:44.263

该`<p>`元素没有`href`属性。如果你想要一个链接，添加一个额外的`<a>`标签。

# c++ - 将字节数复制到内存中的某个位置

> ID：10610116
> 
> 赞同：-2
> 
> 时间：2012-05-15T23:18:41.650
> 
> 标签：c++

如果我不正确，以下代码用于将字节数组复制到 C# 中的内存位置：

```
byte[] byteName = Encoding.ASCII.GetBytes("Hello There");

int positionMemory = getPosition();

Marshal.Copy(byteName, 0, new IntPtr(positionMemory), byteName.length); 
```

如何在本机 C++ 中实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:20:49.807

使用指针和 memcpy：

```
void * memcpy ( void * destination, const void * source, size_t num ); 
```

假设您要将长度为 n 的数组 A 复制到数组 B

```
memcpy (B, A, n * sizeof(char)); 
```

这比 C++ 更像 C，字符串类具有您可以使用的复制功能。

```
 size_t length;
  char buffer[20];
  string str ("Test string...");
  length=str.copy(buffer,6,5);
  buffer[length]='\0'; 
```

这是一个带有完整代码的更具体的示例：

```
#include <stdio.h>
#include <string>
#include <string.h>
#include <iostream>

using namespace std;
int main()
{

    string s("Hello World");
    char buffer [255];
    void * p = buffer; // Or void * p = getPosition()
    memcpy(p,s.c_str(),s.length()+1);
    cout << s << endl;
    cout << buffer << endl;
    return 0;
} 
```

如果您需要更多详细信息，请告诉我

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:46:56.040

`memcpy()`, `memmove()`, `CopyMemory()`, 和`MoveMemory()`都可以用作`Marshal.Copy()`. 至于位置处理，所有 .NET 代码都将整数转换为指针，您也可以在 C++ 中执行此操作。您显示的 .NET 代码等同于以下内容：

```
std::string byteName = "Hello There"; 
int positionMemory = getPosition(); 
memcpy(reinterpret_cast<void*>(positionMemory), byteName.c_str(), byteName.length()); 
```

# c++ - Qt：如何在每次迭代中创建等待用户输入的循环？

> ID：10610119
> 
> 赞同：0
> 
> 时间：2012-05-15T23:19:21.800
> 
> 标签：c++, qt, qlineedit

我不确定如何让循环等待并使用不同的输入进行迭代。

例如：

```
DO
{
// DO STUFF

}WHILE (Whatever is in lineEdit widget is not 'N') // User picks between Y and N 
```

但是，我似乎无法实现任何方式在`do`部分结束时等待，以便用户可以编辑`lineEdit`文本内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:36:16.960

在 Qt 中，你什么也不做。让 QApplication 事件循环来做它的事。只需将处理槽连接到 QLineEdit 的`textEdited(const QString & text )`信号。

```
class MyObject : public QObject
{
Q_OBJECT
public:
   MyObject();
   ~MyObject();

private slots:
   void handleUserInput(const QString& text);

private:
   QLineEdit* lineEdit_;
};

MyObject::MyObject()
   : lineEdit_(new QLineEdit)
{
   connect(lineEdit_, SIGNAL(textEdited(const QString&)), 
           this, SLOT(handleUserInput(const QString&)));
}

MyObject::~MyObject()
{
   delete lineEdit_;
}

void MyObject::handleUserInput(const QString& text)
{
   if(text != "desiredText") 
      return;

   // do stuff here when it matches
} 
```

# mongodb - 检查字段是否包含字符串

> ID：10610131
> 
> 赞同：594
> 
> 时间：2012-05-15T23:20:23.520
> 
> 标签：mongodb

我正在寻找一个运算符，它允许我检查字段的值是否包含某个字符串。

就像是：

```
db.users.findOne({$contains:{"username":"son"}}) 
```

那可能吗？

* * *

## 回答 #1

> 赞同：929
> 
> 时间：2012-05-16T10:36:05.377

您可以使用以下代码来完成。

```
db.users.findOne({"username" : {$regex : "son"}}); 
```

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2012-05-16T00:06:56.143

由于 Mongo shell 支持正则表达式，这是完全可能的。

```
db.users.findOne({"username" : /.*son.*/}); 
```

如果我们希望查询不区分大小写，我们可以使用“i”选项，如下所示：

```
db.users.findOne({"username" : /.*son.*/i}); 
```

见：[http ://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions)

* * *

## 回答 #3

> 赞同：195
> 
> 时间：2012-05-16T03:00:31.100

[https://docs.mongodb.com/manual/reference/sql-comparison/](https://docs.mongodb.com/manual/reference/sql-comparison/)

[http://php.net/manual/en/mongo.sqltomongo.php](http://php.net/manual/en/mongo.sqltomongo.php)

MySQL

```
SELECT * FROM users WHERE username LIKE "%Son%" 
```

MongoDB

```
db.users.find({username:/Son/}) 
```

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2015-06-24T15:34:51.683

从 2.4 版开始，您可以在字段上创建[文本索引](http://docs.mongodb.org/manual/core/index-text/)以进行搜索并使用[$text](http://docs.mongodb.org/manual/reference/operator/query/text/)运算符进行查询。

首先，创建索引：

`db.users.createIndex( { "username": "text" } )`

然后，搜索：

`db.users.find( { $text: { $search: "son" } } )`

基准（约 150K 文档）：

*   正则表达式（其他答案）=> 5.6-6.9 秒
*   文本搜索 => .164-.201 秒

笔记：

*   一个集合只能有一个文本索引。如果要搜索*任何*字符串字段，可以使用通配符文本索引，例如：`db.collection.createIndex( { "$**": "text" } )`.
*   文本索引可能很大。它为插入的每个文档的每个索引字段中的每个唯一后置词包含一个索引条目。
*   与普通索引相比，构建文本索引需要更长的时间。
*   文本索引不存储有关文档中单词接近度的短语或信息。因此，当整个集合适合 RAM 时，短语查询将更有效地运行。

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2016-12-15T06:10:14.567

由于这是搜索引擎中的第一个热门搜索引擎，而且上述方法似乎都不适用于 MongoDB 3.x，因此这里有一个可以正常工作的正则表达式搜索：

```
db.users.find( { 'name' : { '$regex' : yourvalue, '$options' : 'i' } } ) 
```

无需创建和额外的索引等。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2013-11-15T06:30:27.400

如果您通过 Python 连接 MongoDB，请执行以下操作

```
db.users.find({"username": {'$regex' : '.*' + 'Son' + '.*'}}) 
```

您也可以使用变量名而不是 'Son' 并因此使用字符串连接。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2017-08-29T10:24:00.733

完成此任务的最简单方法

如果您希望查询**区分大小写**

```
db.getCollection("users").find({'username':/Son/}) 
```

如果您希望查询**不区分大小写**

```
db.getCollection("users").find({'username':/Son/i}) 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-02-12T05:37:06.447

这应该做的工作

```
db.users.find({ username: { $in: [ /son/i ] } }); 
```

`i`只是为了防止匹配单个字母大小写的限制。

您可以查看`$regex`MongoDB 文档上的文档。这是一个链接：[https ://docs.mongodb.com/manual/reference/operator/query/regex/](https://docs.mongodb.com/manual/reference/operator/query/regex/)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-06-19T05:45:15.583

理想答案它的使用索引 **i**选项用于**不区分大小写**

```
db.users.findOne({"username" : new RegExp(search_value, 'i') }); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2021-04-07T22:44:39.480

如果您需要搜索多个属性，您可以使用 $or。例如

```
Symbol.find(
  {
    $or: [
      { 'symbol': { '$regex': input, '$options': 'i' } },
      { 'name': { '$regex': input, '$options': 'i' } }
    ]
  }
).then((data) => {
  console.log(data)
}).catch((err) => {
  console.log(err)
}) 
```

在这里，您的搜索基于输入是否包含在符号属性或名称属性中。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-01-27T15:54:26.840

如果您的正则表达式包含变量，请确保对其进行[转义](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping)。

```
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
} 
```

可以这样使用

```
new RegExp(escapeRegExp(searchString), 'i') 
```

或者在这样的 mongoDb 查询中

```
{ '$regex': escapeRegExp(searchString) } 
```

[在这里](https://stackoverflow.com/questions/26699885/how-can-i-use-a-regex-variable-in-a-query-for-mongodb/65922817#65922817)发表了相同的评论

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-07-19T06:06:24.233

如果正则表达式在您的聚合解决方案中不起作用并且您有嵌套对象。试试这个**聚合管道**：（如果您的对象结构很简单，只需从下面的查询中删除其他条件）：

```
db.user.aggregate({$match: 
     {$and:[
   {"UserObject.Personal.Status":"ACTV"},
   {"UserObject.Personal.Address.Home.Type":"HME"},
   {"UserObject.Personal.Address.Home.Value": /.*son.*/ }
   ]}}
   ) 
```

另一种方法是像这样直接查询：

```
db.user.findOne({"UserObject.Personal.Address.Home.Value": /.*son.*/ }); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2021-10-08T03:51:38.323

我使用此代码，它适用于搜索子字符串

```
db.users.find({key: { $regex: new RegExp(value, 'i')}}) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-02-10T14:06:13.373

## 对于聚合框架

* * *

**现场搜索**

（`'$options': 'i'`用于不区分大小写的搜索）

```
db.users.aggregate([
    {
        $match: {
            'email': { '$regex': '@gmail.com', '$options': 'i' }
        }
    }
]); 
```

* * *

**完整文档搜索**

[（仅适用于使用文本索引索引](https://docs.mongodb.com/manual/core/index-text/)的字段

```
db.articles.aggregate([
    {
        $match: { $text: { $search: 'brave new world' } }
    }
]) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-05-26T03:56:14.577

如何在 RegExp 匹配中忽略 HTML 标签：

```
var text = '<p>The <b>tiger</b> (<i>Panthera tigris</i>) is the largest <a href="/wiki/Felidae" title="Felidae">cat</a> <a href="/wiki/Species" title="Species">species</a>, most recognizable for its pattern of dark vertical stripes on reddish-orange fur with a lighter underside. The species is classified in the genus <i><a href="/wiki/Panthera" title="Panthera">Panthera</a></i> with the <a href="/wiki/Lion" title="Lion">lion</a>, <a href="/wiki/Leopard" title="Leopard">leopard</a>, <a href="/wiki/Jaguar" title="Jaguar">jaguar</a>, and <a href="/wiki/Snow_leopard" title="Snow leopard">snow leopard</a>. It is an <a href="/wiki/Apex_predator" title="Apex predator">apex predator</a>, primarily preying on <a href="/wiki/Ungulate" title="Ungulate">ungulates</a> such as <a href="/wiki/Deer" title="Deer">deer</a> and <a href="/wiki/Bovid" class="mw-redirect" title="Bovid">bovids</a>.</p>';
var searchString = 'largest cat species';

var rx = '';
searchString.split(' ').forEach(e => {
  rx += '('+e+')((?:\\s*(?:<\/?\\w[^<>]*>)?\\s*)*)';
});

rx = new RegExp(rx, 'igm');

console.log(text.match(rx)); 
```

这可能很容易变成 MongoDB 聚合过滤器。

# java - 根据百分比调用不同的任务

> ID：10610132
> 
> 赞同：2
> 
> 时间：2012-05-15T23:20:24.397
> 
> 标签：java, random

```
Task1, X% 
Task2, Y%
Task3, Z%
----
TaskN, N%

And X + Y + Z + . . .  + N = 100% 
```

***问题：-***上面的配置文件对不同的任务有某种类型的权重（执行 Task1 X% 的时间并在 Line1 上打印任何内容，执行 Task2 Y% 的时间并在 Line2 上打印任何内容并执行 Task3 Z% 的时间和在 Line3 等上打印任何内容。总重量加起来应为 100%。

***我写的代码： -***我写了一个程序，我在其中逐行读取文件并将所有行存储在字符串的 ArrayList 中，然后我生成了一些介于 1 和 100 之间的随机数。例如，有三个任务-

```
Task1 75%
Task2 15%
Task3 10% 
```

获取 1-100 之间的随机数。如果数字是 1-75 do Task1 意味着在 line1 上打印任何东西，76-90 do Task2 意味着在 Line2 上打印任何东西，91-100 do Task3 意味着在 line3 上打印任何东西。但是我如何为任何具有 N 个任务且具有任何百分比数的配置文件扩展它。我被困在这部分。

```
 private static Random r = new Random();
                private final static int Low = 1;
                private final static int High = 100;
                String sCurrentLine;
                ArrayList<Integer> percentageCalls = new ArrayList<Integer>();

                br = new BufferedReader(new FileReader("S:\\config.txt"));

                int R = r.nextInt(High-Low) + Low;

                ArrayList<List<String>> allLines = new ArrayList<List<String>>();
                while ((sCurrentLine = br.readLine()) != null) {
                    allLines.add(Arrays.asList(sCurrentLine.split("\\s+")));
                    Collections.shuffle(allLines);
                }

                for (List<String> s1 : allLines) {
                    percentageCalls.add(Integer.parseInt(s1.get(0)));
                }
                Collections.sort(percentageCalls, Collections.reverseOrder()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:10:21.283

我最近为一个你应该能够适应的项目写了一些东西来做这件事。此类允许将任意数量的选择添加到“可能性”列表中。机会量可以是任何整数...总数不需要加起来为 100。因此，如果您希望选择 A 在 302 次中发生 5 次，而选择 B 在其他 297 次中发生，那么您可以添加 A有 5 的机会，B 有 297 的机会。这段代码有点粗糙，可能需要一些改进，但这个想法应该可以帮助您扩展到 N 个选项。您只需要编写一些循环遍历文件并将每种可能性添加到 ResultGenerator 的内容。

样品用途：

```
ResultGenerator<String> rgen = new ResultGenerator<String>();

rgen.AddPossibility("Red", 25);
rgen.AddPossibility("Blue", 20);
rgen.AddPossibility("Green", 30);
rgen.AddPossibility("Black", 5);
rgen.AddPossibility("White", 15);

String result = rgen.GetRandomResult(); 
```

班级：

```
public class ResultGenerator<T> {

     class Possibility
     {
         Possibility(T choice, int chance)
         {
             this.Choice = choice;
             this.Chance = chance;
         }

         public T Choice;
         public int Chance;
         public int RangeMax;
         public int RangeMin;

     }

     private Random r;

     public ResultGenerator(Random r)
     {
         this.r = r;
     }

     public ResultGenerator()
     {
         this.r = new Random();
     }

     private List<Possibility> possibilities = new ArrayList<Possibility>();

     public void AddPossibility(T choice, int chance) {
         possibilities.add(new Possibility(choice, chance));
     }

     public T GetRandomResult() {

         if (possibilities.size() == 0)
             return null;

         //Calculate ranges for possibilities
         int totalChances = 0;
         for (Possibility p : possibilities) {
             p.RangeMin = totalChances;
             p.RangeMax = totalChances + p.Chance;
             totalChances += p.Chance;
         }

         int randomNumber = 1 + r.nextInt(totalChances + 1);

         for(Possibility possibility : possibilities)
         {
             if (randomNumber <= possibility.RangeMax && randomNumber > possibility.RangeMin)
             {
                 return possibility.Choice;
             }
         }

         return null;
     }

} 
```

# javascript - 如何在 vb.net 中将对象转换为数组

> ID：10610134
> 
> 赞同：-1
> 
> 时间：2012-05-15T23:20:52.397
> 
> 标签：javascript, vb.net

我有一个返回数组的 javascript

```
var docArray = new Array(page, stamprect[0], stamprect[3], stamprect[2], stamprect[1],     srot);
return docArray; 
```

我正在尝试让 VB.Net 将其读入数组

```
Dim stampInfo() As Integer
stampInfo = javaScriptObj.getAllGhostStamps(CInt(pages.Item(i)) - 1) 
```

我收到错误：

```
Unable to cast object of type 'System.Object[]' to type 'System.Int32[]'. 
```

我不知道如何将其类型转换为数组。任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:16:48.863

您需要将数组中的每个项目转换为整数。例如：

```
Dim raw() As Object = javaScriptObj.getAllGhostStamps(CInt(pages.Item(i)) - 1)
Dim stampInfo(raw.Length) As Integer
For i As Integer = 0 to raw.Length - 1
    stampInfo(i) = CType(raw(i), Integer)
Next 
```

# box-api - 我可以自动登录到 box.net 小部件吗？

> ID：10610136
> 
> 赞同：0
> 
> 时间：2012-05-15T23:21:00.183
> 
> 标签：box-api

允许上传/下载和查看文件的 box.net 小部件运行良好。

但是我需要自动化登录过程，以便我允许访问我网站的其他人不需要知道用于我的帐户的用户名和密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:35:17.960

您可能希望使用此处概述的嵌入小部件：https: [//support.box.com/entries/20361321-how-to-use-the-file-embed-widget-to-give-access-to -my-box-files-from-my-website](https://support.box.com/entries/20361321-how-to-use-the-file-embed-widget-to-give-access-to-my-box-files-from-my-website)

用户需要登录自己的 Box 帐户，但仍可以上传到文件夹。

# javascript - 带有“.”的 Jquery 选择器 “_”不工作

> ID：10610139
> 
> 赞同：2
> 
> 时间：2012-05-15T23:21:14.607
> 
> 标签：javascript, jquery, jquery-selectors

我有这个输入：

```
<input type="text" name="Latitude" id="Latitude" /> 
```

并使用该 jquery 设置值 ok：

```
$('#Latitude').val(latitude); 
```

但现在我需要将输入的 id 更改为 RegisterModel_Latitude 或 RegisterModel.Latitude，所以：

```
<input type="text" id="RegisterModel_Latitude" /> 
```

或者

```
<input type="text" id="RegisterModel.Latitude" /> 
```

但我无法用 jquery 设置值......我试过了：

```
$("#RegisterModel_Latitude").val(latitude);
$("#RegisterModel.Latitude").val(latitude);
$("#RegisterModel\\.Latitude").val(latitude);
$('input[id="RegisterModel_Latitude"]').val(latitude);
$('input[id="RegisterModel.Latitude"]').val(latitude);
$('input[id="RegisterModel\\.Latitude"]').val(latitude); 
```

但是这些都不起作用，所以我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:27:06.770

这`_`是 id 的有效字符（有关示例，请参见@VisioN 的[jsfiddle](http://jsfiddle.net/Q7tbD)）。

`.`表示一个类。`$("#RegisterModel.Latitude")`寻找具有 id`RegisterModel`和 class的元素也是如此`Latitude`。有关示例，请参见我的 @VisioN 的[jsfiddle](http://jsfiddle.net/XFsj5/)的分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:26:32.487

检查变量纬度（var latitude）可能缺失

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:29:48.353

Wait. If I got it, you want to change the ID, but you're using val instead of attr. Why not:

```
$('#Latitude').attr('id','RegisterModel_Latitude'); 
```

or

```
$('input[name=Latitude]').attr('id','RegisterModel_Latitude'); 
```

The val changes the value, but not ID. =)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T10:00:06.643

我找到了解决方案，改变：

```
@Html.TextBoxFor(m => m.RegisterModel.Address, new { onblur = "codeAddress(RegisterModel_Address.value);" }) 
```

至：

```
<input type="text" id="RegisterModel_Address" onblur="codeAddress(RegisterModel_Address.value)" /> 
```

现在正在工作，谢谢大家。

# ios - iOS 动画 1+2 = 3\. 3-2 != 1

> ID：10610141
> 
> 赞同：0
> 
> 时间：2012-05-15T23:21:18.807
> 
> 标签：ios, ios5

iPad - iOS 5.1 - Xcode 4.3.2

当键盘弹出时，我将 UIImageView 的 y 原点动画设置为“x”当键盘关闭时，我将其动画返回相同的“x”

所以键盘弹出，图像上升X，键盘下降，图像下降x，**但它不会在同一个地方结束！**你上升 60，下降 60，你不在同一个地方！再往下，好像坐标系在键盘出现和消失之间发生了变化。它绝对让我发疯。我不明白为什么会这样。

```
//add gesture recognizer when keyboard appears
-(void)keyboardWillShow:(NSNotification *) note {

    [self.view addGestureRecognizer:tapRecognizer];

    // Setup the animation
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3f];
    [UIView setAnimationCurve:UIViewAnimationOptionCurveEaseInOut];
    [UIView setAnimationBeginsFromCurrentState:YES];

    // The transform matrix: Logo Image

    CGAffineTransform moveLogo = CGAffineTransformMakeTranslation(0, -60);
    self.logoImageView.transform = moveLogo;

    // Commit the changes
    [UIView commitAnimations];  
}

//add gesture recognizer when keyboard appears
-(void)keyboardWillHide:(NSNotification *) note {

    [self.view removeGestureRecognizer:tapRecognizer];

    // Setup the animation
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3f];
    [UIView setAnimationCurve:UIViewAnimationOptionCurveEaseInOut];
    [UIView setAnimationBeginsFromCurrentState:YES];

    // The transform matrix: Logo Image

    CGAffineTransform moveLogo = CGAffineTransformMakeTranslation(0, 60);
    self.logoImageView.transform = moveLogo;

    // Commit the changes
    [UIView commitAnimations];  
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:29:31.363

那是因为你没有翻译它，当你使用 CGAffineTransformMakeTranslation 你说*给我这些坐标*而不是*给我这个偏移量*。换句话说，make translation 为您提供了*单位*矩阵的翻译。您想要的功能是 CGAffineTransformTranslate。这会将翻译应用于当前变换（作为第一个参数传递）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:36:47.100

变换属性不是累积的。你没有做你认为你正在做的事情。您正在根据您的身份计算新的转换，而不是从当前的转换。

代替：

```
 CGAffineTransform moveLogo = CGAffineTransformMakeTranslation(0, 60);
    self.logoImageView.transform = moveLogo; 
```

尝试：

```
self.logoImageView.transform = CGAffineTransformIdentity; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-15T23:33:58.363

您可能想要为简单的视图属性设置动画，而不是使用 Core Graphics，例如框架或大小。例如：

```
[self.logoImageView.center = CGPointMake(self.logoImageView.center.x,
self.logoImageView.center.y + 60); 
```

`beginAnimations`在和之间执行此操作`commitAnimations`

# excel - 我正在尝试将所有 excel 电子表格合并到一个主电子表格中

> ID：10610146
> 
> 赞同：0
> 
> 时间：2012-05-15T23:21:50.200
> 
> 标签：excel, excel-2007, vba

我正在尝试编写一个 Excel 宏，它将遍历目录中的所有文件夹，并将多个 Excel 电子表格合并为一个。所有的 excel 电子表格都有相同的格式。

我能够遍历目录中的所有文件夹，但是当我尝试将 Excel 电子表格合并在一起时，我不断收到错误消息。

这是我收到的错误消息：

> 运行时错误“1004”：
> 
> Excel 无法将工作表插入到目标工作簿中，因为它包含的行和列少于源工作簿。要将数据移动或复制到目标工作簿，您可以选择数据，然后使用“复制”和“粘贴”命令将其插入到另一个工作簿的工作表中。

这是我到目前为止所做的：

```
Option Explicit
Sub FileListingAllFolder()

Dim pPath As String
Dim FlNm As Variant
Dim ListFNm As New Collection ' create a collection of filenames

Dim OWb As Workbook
Dim ShtCnt As Integer
Dim Sht As Integer

Dim MWb As Workbook
Dim MWs As Worksheet
Dim i As Integer

' Open folder selection
With Application.FileDialog(msoFileDialogFolderPicker)
    .Title = "Select a Folder"
    .AllowMultiSelect = False
    If .Show <> -1 Then GoTo NextCode
    pPath = .SelectedItems(1)
End With

Application.WindowState = xlMinimized
Application.ScreenUpdating = False

' Create master workbook with single sheets
Set MWb = Workbooks.Add(1)
MWb.Sheets(1).Name = "Result"
Set MWs = MWb.Sheets("Result")

' Filling a collection of filenames (search Excel files including subdirectories)
Call FlSrch(ListFNm, pPath, "*Issues.xls*", True)

' Print list to immediate debug window and as a message window
For Each FlNm In ListFNm ' cycle for list(collection) processing

    'Start Processing here
    Set OWb = Workbooks.Open(FlNm)
    ShtCnt = ActiveWorkbook.Sheets.Count
    For Sht = 1 To ShtCnt
        Sheets(Sht).Copy After:=ThisWorkbook.Sheets(1)
    Next Sht
    OWb.Close False
Next FlNm

' Print to immediate debug window and message if no file was found
If ListFNm.Count = 0 Then
    Debug.Print "No file was found !"
    MsgBox "No file was found !"
    MWb.Close False
    End
End If

MWb.Activate
MWs.Activate
Cells.Select
Selection.EntireColumn.AutoFit
Range("A1").Select
Application.ScreenUpdating = True
Application.WindowState = xlMaximized

End

NextCode:
MsgBox "You Click Cancel, and no folder selected!"

End Sub

Private Sub FlSrch(pFnd As Collection, pPath As String, pMask As String, pSbDir As Boolean)

Dim flDir As String
Dim CldItm As Variant
Dim sCldItm As New Collection

' Add backslash at the end of path if not present
pPath = Trim(pPath)

If Right(pPath, 1) <> "\" Then pPath = pPath & "\"

' Searching files accordant with mask
flDir = Dir(pPath & pMask)
    Do While flDir <> ""
        pFnd.Add pPath & flDir 'add file name to list(collection)
        flDir = Dir ' next file
    Loop

' Procedure exiting if searching in subdirectories isn't enabled
If Not pSbDir Then Exit Sub

' Searching for subdirectories in path
flDir = Dir(pPath & "*", vbDirectory)
    Do While flDir <> ""
    ' Do not search Scheduling folder
        If flDir <> "Scheduling" Then
            ' Add subdirectory to local list(collection) of subdirectories in path
            If flDir <> "." And flDir <> ".." Then If ((GetAttr(pPath & flDir) And _
            vbDirectory) = 16) Then sCldItm.Add pPath & flDir
        End If
        flDir = Dir 'next file
    Loop

' Subdirectories list(collection) processing
For Each CldItm In sCldItm
    Call FlSrch(pFnd, CStr(CldItm), pMask, pSbDir) ' Recursive procedure call
Next

End Sub 
```

我认为这是导致问题的部分。

```
For Each FlNm In ListFNm ' cycle for list(collection) processing

        'Start Processing here
        Set OWb = Workbooks.Open(FlNm)
        ShtCnt = ActiveWorkbook.Sheets.Count
        For Sht = 1 To ShtCnt
            Sheets(Sht).Copy After:=ThisWorkbook.Sheets(1)
        Next Sht
        OWb.Close False
    Next FlNm 
```

两天来我一直试图弄乱这段代码。我不太确定我在哪里做错了。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T16:06:19.467

如果您可以访问 vb.net，我会敦促您将其与 Excel-Interop 结合使用。我已经尝试过与您所知道的相同的事情 - 基本上，它从未对纯 VBA 100% 满意。Vb.net 和互操作的结合就像一个魅力。

# memory - WDK 驱动程序中的 PHYSICAL_ADDRESS 值究竟意味着什么？

> ID：10610147
> 
> 赞同：0
> 
> 时间：2012-05-15T23:22:02.430
> 
> 标签：memory, memory-address, drivers, wdk

我在理解 WDK 中的 PHYSICAL_ADDRESS 结构时遇到了一些问题。我认为它是物理内存中的真实物理地址。现在我已经尝试过了——我的驱动程序中有 512 MB RAM 和代码的虚拟 PC

```
PHYSICAL_ADDRESS pa;
pa.QuadPart = 9223372036854775805; //max LONGLONG - 1
mr = MmMapIoSpace(pa , 100, 0);
DbgPrint("%i ", MmGetPhysicalAddress(mr)); 
```

...并且它没有问题地工作。512 MB RAM 这怎么可能？最大物理地址不是 512 MB = cca 512 000 000 吗？什么真正意味着 PHYSICAL_ADDRESS 值？

PS：请不要问我为什么要这样做。我只是想知道这怎么可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T18:17:34.983

代码正常工作意味着您成功地将（可能是伪造的）物理地址映射到您的代码可以读写的虚拟地址。这只是页表中的一个条目。显然系统不验证物理地址范围。尝试取消对获得的虚拟地址的引用： DbgPrint("%x\n", *((PULONG)mr));

# ruby-on-rails - 为什么邮件没有进入 ActionMailer::Base.deliveries 表？

> ID：10610150
> 
> 赞同：4
> 
> 时间：2012-05-15T23:22:19.480
> 
> 标签：ruby-on-rails

目前在我的开发环境中，使用后我没有在`ActionMailer::Base.deliveries`表中看到任何内容`mail`。有没有我缺少的设置？

配置/环境/development.rb
`config.action_mailer.delivery_method = :test`：。

应用程序/邮件程序/notifier.rb

```
def send_email(user)
  mail(:to => user.email, :subject => "Welcome to our website!")
end 
```

这些是我正在运行的测试：

```
When /^I signup$/ do
  visit signup_path
  @user = FactoryGirl.build(:user)
  fill_in "user_email", :with => @user.email
  fill_in "user_password", :with => @user.password
  click_button "Join now"
end

Then /^I should receive a confirmation email$/ do
  email = ActionMailer::Base.deliveries.last
  email.subject.should == "Welcome to our website!"
end 
```

现在我收到以下错误`I should receive a confirmation email`： `undefined method subject for nil:NilClass (NoMethodError)`

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T12:25:17.047

另一种可能性可能是在 config/environments/test.rb 你有

```
config.action_mailer.delivery_method = :test 
```

但你已经设置

```
config.action_mailer.perform_deliveries = false 
```

所以改变为

```
config.action_mailer.perform_deliveries = true 
```

在我的情况下让它再次工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-10T01:01:29.370

老问题，我知道，但我想到了几件事：

*   您谈论了您的开发环境的配置 ( `config/environments/development.rb`)，但您的测试不起作用。检查`config/environments/test.rb`，也许`config\application.rb`。

*   我实际上想在我的开发环境中查看电子邮件数组，但它总是在控制台中返回 nil。我终于意识到，因为数组只是一个内存对象，不在数据库中，所以控制台（`rails c`）看不到服务器（`rails s`）中发生了什么。当我添加`<%= ActionMailer::Base.deliveries.count %>`到视图中时，我可以立即看到该数组在开发中被填充。

*   如果您使用单独的线程或任务来发送电子邮件，则会出现另一种“我无法从控制台看到该进程”的情况。使用`delayed_job`，我发现[这个答案](https://stackoverflow.com/a/15252375/550712)建议您可以使用 来查看作业（而不是实际的电子邮件）`Delayed::Job.last.handler`，它*确实*查看了数据库，因此可以跨进程工作。然而，这仅在作业仍在数据库中时有效，即在工作人员处理它之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T04:37:57.387

您收到的错误表明电子邮件为零。换句话说，deliveries.last 方法返回 nil，因为其中没有电子邮件。

可能有很多原因......我假设您使用黄瓜作为测试机制？

**1.验证'click_button'提交**

您可以尝试放置 puts 或 log 语句。确保当您运行 cucumber 功能时，它会实际打印。有时这些事情不起作用，因为前端逻辑不起作用并且测试正确失败。换句话说，您期望触发的控制器端点没有被触发。

**2\. 验证 'send_email' 是否正确 - 使用单元测试**

接下来，验证您是否确实在发送电子邮件。编写一个单元测试来验证它是否有效。这应该快速且容易上手。那里有很多文章。

最后，不是真的相关，但您可能希望使用[email-spec](https://github.com/bmabey/email-spec)，它应该提供一些不错的测试方法，这样您就不必重新发明轮子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-15T07:32:13.707

在进行@Dominik Steiner 回答的更改后，如果它仍然不起作用，

另一种可能性可能是在 config/initializers/mailer.rb 中，您应该有：

```
ActionMailer::Base.delivery_method = :test 
```

以上在我的情况下丢失了，它现在可以工作了。

# extjs - extjs 网格列文本环绕

> ID：10610156
> 
> 赞同：1
> 
> 时间：2012-05-15T23:23:04.627
> 
> 标签：extjs, datagrid

我正在尝试使用 ExtJS 创建一个属性网格。我遇到的问题是该列的文本太宽。反正有没有强制文本环绕并创建一个更高的行？这是我到目前为止所拥有的：http: [//jsfiddle.net/lordzardeck/pLYt3/1/](http://jsfiddle.net/lordzardeck/pLYt3/1/)

基本上我想扩展标题行来阅读这个：

```
A Reason for Spelling (Level B):  
Teacher's Guidebook 
```

这可能吗？如果是这样，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T07:42:20.483

只需添加这个 CSS：

```
.x-property-grid .x-grid-row .x-grid-property-name .x-grid-cell-inner {
    white-space: normal;
}

.x-property-grid .x-grid-row .x-grid-property-name .x-grid-cell-inner,
.x-property-grid .x-grid-row-over .x-grid-property-name .x-grid-cell-inner {
    background-image: none;
}

.x-property-grid .x-grid-row .x-grid-property-name,
.x-property-grid .x-grid-row-over .x-grid-property-name
{
    background-position: -16px 1px;
    background-image: url("http://dev.sencha.com/deploy/ext-4.1.0-gpl/resources/themes/images/default/grid/property-cell-bg.gif");
    background-repeat: repeat-y;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:43:33.007

使用网格的[customEditors](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.grid.property.Grid-cfg-customEditors)属性。

请参阅您[更新的示例](http://jsfiddle.net/o_nix/pLYt3/2/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-18T15:21:42.767

`white-space: normal;`使用 ExtJS 6 在滚动时设置会导致渲染问题

`cellWrap: true`正如该线程所指出的，您应该在列上进行设置：

[https://www.sencha.com/forum/showthread.php?205554-extjs-grid-column-text-wrap-around-auto-expand](https://www.sencha.com/forum/showthread.php?205554-extjs-grid-column-text-wrap-around-auto-expand)

# python - 如何将字符串字符转换为列表？

> ID：10610158
> 
> 赞同：25
> 
> 时间：2012-05-15T23:23:33.023
> 
> 标签：python, string, list

> **可能重复：**
> [如何使用字符串的字符创建列表？](https://stackoverflow.com/questions/5501641/how-to-create-a-list-with-the-characters-of-a-string)

例子：

```
'abc' 
```

变成

```
['a', 'b', 'c'] 
```

它是拆分和切片的组合吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-05-15T23:25:11.277

```
>>> x = 'abc'
>>> list(x)
['a', 'b', 'c'] 
```

不确定您要做什么，但您可以从字符串本身访问单个字符：

```
>>> x = 'abc'
>>> x[1]
'b' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-15T23:41:35.110

如果您需要遍历字符串，甚至不需要将其转换为列表：

```
>>> n = 'abc'
>>> for i in n:
...     print i
... 
a
b
c 
```

或者

```
>>> n[1]
'b' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:26:57.753

```
yourstring = 'abc'
[char for char in yourstring] 
```

# facebook - 检测 Facebook OAuth 令牌过期

> ID：10610160
> 
> 赞同：2
> 
> 时间：2012-05-15T23:23:36.577
> 
> 标签：facebook, oauth

我有一个 Facebook 应用程序，可以在粉丝页面上定期发布帖子。

为此，应用程序获取一个 OAuth 令牌以用于在页面上发布。要获取此令牌，用户需要访问该应用程序。然而，有时 Facebook 会使这些令牌失效，至少在用户更改他们的 FB 密码时，并且在其他一些与安全相关的情况下似乎也是如此。

发生这种情况时，应用程序将无法发布预定的帖子，并且用户不满意。我应该如何解决这个问题？我可以在用户的​​令牌过期时向他们发送电子邮件，但我将如何检测过期？鉴于我有 100,000 多个用户，经常轮询代币会很昂贵。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:13:40.747

好吧，直接回答你的问题，给你：[Facebook Debugger](https://developers.facebook.com/tools/debug)

在此处输入 Access_token 以检查其有效性和其他信息。但我知道这通常不能解决你的问题。我可以帮助你朝着正确的方向前进。

* * *

您会看到令牌有效性受您向用户请求的权限的影响。此`offline_access`权限为您提供不会超时的访问令牌，而不是常规的一小时令牌。而且我相信您知道这一点，因为您已经能够安排用户帖子。

不幸的是，`offline_access`现在[已被 Facebook 弃用（请参阅此链接）](https://developers.facebook.com/roadmap/offline-access-removal/)。从现在开始，Facebook 会默认给我们 2 个月的 access_token，即使没有得到许可。从那时起，我们需要“刷新”或扩展访问令牌。在该链接上阅读更多信息。

关于您在使用更改密码、注销等方面的问题，Facebook 也有自己的[专门博客文章，请参见此处](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)。

* * *

如果您想自己检查令牌有效性，您可以设置一个每小时或每天运行的 CRON（取决于您），并为每个令牌 (/me) 进行快速 API 调用。如果失败或产生错误，则令牌已过期。

如果您每分钟执行一次会更好：要检查 10 到 20 个令牌，因此在一次执行中执行 100,000 多个调用不会对您的服务器造成沉重负担。

# wordpress - WordPress 页面子项

> ID：10610163
> 
> 赞同：0
> 
> 时间：2012-05-15T23:23:53.767
> 
> 标签：wordpress

我想根据页面 ID 显示图像。

我遇到的问题是子页面。我想有一种方法来识别当前页面是否是特定页面的子页面，无论有多少层深。

例子。

主页 -> 节目 -> 棒球

如果 Programs 或 Baseball 或低于棒球的任何内容，则显示图像 X

别的

图像 Y

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:41:28.160

查看 Wordpress Codex 中可用的父/子函数，例如：[http ://codex.wordpress.org/Function_Reference/get_post_ancestors](http://codex.wordpress.org/Function_Reference/get_post_ancestors)

get_post_ancestors 似乎是您最好的选择，从那里您可以在脚本中提供您可能需要选择的任何逻辑和（dis）质量结果。

法典中还有其他选择工具可能会做得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:46:04.960

```
<?php
if ($post->post_parent == '100') { // if current page is child of page with page ID 100
   // show image X 
} else {
   // show image y
}
?> 
```

或者：

```
<?php 
$anc = get_post_ancestors( $post->ID );
   if (in_array("100", $anc )) {
      // show image X 
   } else {
      // show image y
   }
?> 
```

# c++ - std::ostringstream 运算符重载搜索顺序？

> ID：10610167
> 
> 赞同：5
> 
> 时间：2012-05-15T23:24:22.307
> 
> 标签：c++, stl, overload-resolution

我有以下课程：

```
namespace {
class MimeLogger : public std::ostringstream
{
public:
    MimeLogger()
    {}

    ~MimeLogger()
    {
        LOGEVENT( logModuleWSE, logEventDebug, logMsgWSETrace1, str() );
    }
};
} 
```

当我这样做时：

```
MimeLogger() << "Hello " << "World"; 
```

第一个`"Hello "`字符串被视为`void*`. 如果我调试代码，则作为指针值而不是字符串`"Hello "`传入并打印。`std::basic_ostream::operator<< (void const*)`第二个字符串`"World"`被正确地传递到全局重载 << 运算符中，该运算符采用`char const*`.

我希望 << 运算符的两种用法都能解决相同的重载，但这不会发生。有人可以解释一下，也许可以提出解决办法吗？

提前致谢。

## 更新

我没有提到我坚持使用 C++03，但我很高兴有些人同时涵盖了 C++03 和 C++11 的情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T01:07:29.233

C++03：对于表达式`MimeLogger() << "Hello "`，模板函数

```
template <typename charT, class traits>
std::basic_ostream<charT, traits>& std::operator<< (
    std::basic_ostream<charT, traits>& os,
    const char* cstr); 
```

在重载决议期间不考虑，因为临时`MimeLogger()`可能未绑定到非常量引用。成员函数重载没有这个问题，因为隐式参数的规则确实允许绑定到临时参数。

如果您可以使用支持 C++11 右值引用的编译器，这应该可以按您的预期工作，因为 C++11 库提供了额外的重载

```
template <typename charT, class traits, typename T>
std::basic_ostream<charT, traits>& std::operator<< (
    std::basic_ostream<charT, traits>&& os,
    const T& x ); // { os << x; return os; } 
```

这允许使用临时流，`<<`就好像它们不是临时的一样。

（我确实尝试了一个带有 g++ 的测试程序，并且在没有和使用 -std=c++0x 的情况下得到了不同的结果。）

如果您不能使用 C++11 友好的编译器，将其添加到的公共部分`class MimeLogger`是一种解决方法，可以满足您对 C++03 的要求：

```
template<typename T>
MimeLogger& operator<<(const T& x)
{
    static_cast<std::ostringstream&>(*this) << x;
    return *this;
}

using std::ostringstream::operator<<; 
```

using 声明确保标准库中的成员重载也可以从`MimeLogger`. 特别是，如果没有它，操纵器`std::endl`就不能与模板运算符一起工作，因为`std::endl`它本身就是一个函数模板，而从 C++ 中期望的模板类型推导太多了。但只要我们确定不隐藏`ostream`使函数操纵器工作的成员（27.7.3.6.3），一切都很好：

```
namespace std {
    template <typename charT, class traits>
    class basic_ostream : /*...*/ {
    public:
        basic_ostream<charT, traits>& operator<<(
            basic_ostream<charT,traits>& (*pf)(basic_ostream<charT,traits>&));
    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:20:41.043

如何使用遏制`std::ostringstream` ？

```
class MimeLogger
{
private:
    std::ostringstream oss_m;

public:
    MimeLogger()
    {
    }

    ~MimeLogger()
    {
        std::cout << __FILE__ << "(" << __LINE__ << "):" << oss_m.str() << "\n";
    }

    template<typename Type>
    MimeLogger& operator<<(const Type& t)
    {
        oss_m << t;
        return *this;
    }
};

void LogDemo()
{       
   MimeLogger logger;
   logger << "Hello " << "World!!\n";
   MimeLogger() << "Hello " << "StackOverflow!!\n";
} 
```

# c# - WPF 绑定到数据网格的 SelectedItem

> ID：10610173
> 
> 赞同：1
> 
> 时间：2012-05-15T23:24:56.447
> 
> 标签：c#, wpf, binding, datagrid

我有一个绑定到 的数据网格`ObservableCollection<MyClass>`，并且我有另一个数据网格，它有两个 DataGridTextColumns - 名称和值。Name 列预先填充了其值应显示在 Value 列中的属性的名称。MyClass 实现`INotifyPropertyChanged`，因此`MyClass`对象属性的任何更改都会更新第一个数据网格。现在，我想在第二个数据网格的“值”列中显示第一个数据网格的当前选定对象 (SelectedItem) 的属性，并在它们发生时查看属性更改，就像在第一个数据网格中一样。我怎样才能做到这一点？

如果您想知道原因，原始数据网格中只显示了一些属性，所以另一个应该显示几乎所有属性。datagrid 甚至是在 2 列中显示属性的好选择，还是我应该考虑其他一些控件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:03:20.143

这听起来像是对一个相当普遍的问题的一种方便的解决方案。

使用两个数据网格执行此操作的最简单方法是使用一些代码隐藏和反射。首先定义一个类型来显示每个属性的名称和值：

```
class PropertyModel {
    private readonly string _name = "";
    private readonly object _value = null;

    public PropertyModel(string name, object value) {
       _name = name ?? "";
       _value = _value;
    }

    public string Name {
        get { return _name; }
    }

    public object Value {
        get { return _value; }
    }
} 
```

然后在您的代码隐藏中添加一个事件处理程序来处理您的第一个数据网格上的选择更改：

```
private void _onDataGrid1SelectionChanged(object sender, SelectedCellsChangedEventArgs e) {
   if (e.AddedCells.Count > 0) {
        var props = new Collection<PropertyModel>();
        var obj = _dataGrid1.SelectedItem;
        foreach(var prop in obj.GetType().GetProperties()) {
            props.Add(new PropertyModel(prop.Name, prop.GetValue(obj, null)));
        }

        _dataGrid2.ItemsSource = props;
   }

} 
```

请注意，上面的代码非常粗略，只有在 DataGrid1 将 SelectionMode 设置为 Single 时才有效。但是，如果您愿意快速而肮脏地（使用事件处理程序），那么这是一个很好的起点。

另一个很好的解决方案是使用行详细信息。 [这是一个关于使用行详细信息的很好的介绍教程](http://www.wpftutorial.net/datagrid.html#rowDetails)。当然，您还应该阅读[有关该主题的 msdn 文章](http://msdn.microsoft.com/en-us/library/cc903938%28v=vs.95%29.aspx)。

# php - 如何加载仅包含文本内容的 iFrame？

> ID：10610174
> 
> 赞同：0
> 
> 时间：2012-05-15T23:24:59.157
> 
> 标签：php, javascript, iframe

我在下面找到了用于创建 iframe 的片段：

我只想加载文本内容`http://www.host.com`并使 iframe 不可见`display:none`

背景：

我需要一种有效的方法来解析网站图标的位置。并非所有站点都有默认位置。例如`<link rel="SHORTCUT ICON" href="../images/logo_small.ico" />`.

因此，我需要的只是文本内容。PHP 有一个执行此操作的函数（`file_get_contents`），但我想在客户端执行此操作。

这是[iframe 上的 mdn 文档](https://developer.mozilla.org/en/HTML/Element/iframe)

对于服务器端 PHP，使用[file_get_contents。](http://php.net/manual/en/function.file-get-contents.php)

```
function makeFrame() {
   ifrm = document.createElement("IFRAME");
   ifrm.setAttribute("src", "http://www.host.com");
   ifrm.style.width = 640+"px";
   ifrm.style.height = 480+"px";
   document.body.appendChild(ifrm);
} 
```

美味书签的例子：

```
javascript:(function()
{
    f='http://www.delicious.com/save?url='+encodeURIComponent(window.location.href)+
    '&title='+encodeURIComponent(document.title)+'&notes='+
    encodeURIComponent(''+
    (window.getSelection?window.getSelection():document.getSelection?
    document.getSelection():document.selection.createRange().text))+'&v=6&';
    a=function()
    {
        if(!window.open(f+'noui=1&jump=doclose','deliciousuiv6','location=1,links=0,scrollbars=0,to
        olbar=0,width=710,height=660'))
        {
            location.href=f+'jump=yes'
        }
    };
    if(/Firefox/.test(navigator.userAgent))
    {
        setTimeout(a,0);
    }
    else
    {
        a();
    }
})() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:35:59.997

只有当您的页面和框架页面都在同一个域中时，您才能访问 iframe 中的链接元素。引用[您找到的文档](https://developer.mozilla.org/en/HTML/Element/iframe)：

> 试图访问框架内容的脚本受[同源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)的约束，并且如果它是从不同的域加载的，则无法访问其他窗口对象中的大部分属性。

因此，需要使用 PHP 解决方案。加载给定的域，使用 tagsoup 解析器并查询 dom 的`link[rel="SHORTCUT ICON"]`.

您可以使用该解决方案创建一个 JSON API，该解决方案可以从您的应用程序的客户端 js 代码通过 Ajax 使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:34:22.650

我认为如果页面位于不同的服务器上，由于 浏览器中的[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)限制，您将难以获取信息客户端。

如果您想查看所有本地内容：

```
XMLHttpRequest(); 
```

和

```
getResponseText(); 
```

我认为您可能最好使用 PHP 方法。

编辑：

我认为这是一个类似的问题：

[XMLHttpRequest 从远程主机获取 HTTP 响应](https://stackoverflow.com/questions/2060551/xmlhttprequest-to-get-http-response-from-remote-host)

那里的回应可能会提供进一步的帮助。

# ajax - jQuery 不会发送 HTTP_X_REQUESTED_WITH 标头？

> ID：10610175
> 
> 赞同：0
> 
> 时间：2012-05-15T23:25:03.253
> 
> 标签：ajax, django, jquery

我有以下页面，并检查请求，我找不到 HTTP_X_REQUESTED_WITH 标头？我什至尝试了各种技巧，例如手动添加标题（这里的另一个问题），但无济于事。有人有想法么？

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
        $(function() {
            $("#form").bind("submit", function(e) {
                e.preventDefault()
                $.post("/members/login/", $("#form").serialize(),
                        function(data){
                            alert(data);
                            });
                });
            }); 
    });
</script>

<form id="form" action="" method="post">
    <ul>
       <li><label for="id_email">Email:</label> <input type="text" name="email" value="" id="id_email" /></li>
       <li><label for="id_password">Password:</label> <input type="password" name="password" id="id_password" /></li>
    </ul>
    <input type="hidden" name="next" value="" />
    <input id="submit" type="submit" value="" />
</form> 
```

这应该没关系，但我使用 django 并检查`request.is_ajax()`. 我确认标头不在请求中。这部署在本地主机上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:45:08.880

您的代码中似乎有太多的关闭，试试这个：

```
<script type="text/javascript">
    $(function() {
        $("#form").on("submit", function(e) {
            e.preventDefault()
            $.post("/members/login/", $("#form").serialize(), function(data){
                console.log(data);
            });
         });
    }); 
</script> 
```

# c++ - 如何在 C++ 中偏移对象指示的内存位置

> ID：10610176
> 
> 赞同：-1
> 
> 时间：2012-05-15T23:25:05.927
> 
> 标签：c++

我在 C# 中有这个实现。

如果我没记错的话，它用于：通过 size 字节数偏移由allocatedObject指示的内存位置并将内存指针转换为Int64

```
short size = getSize();

IntPtr allocatedObject;

long posInMemory = allocatedObject.Offset(size).ToInt64(); 
```

如何在 C++ 中实现这一点：IntPtr ( `void *allocatedObject;`) 在内存中的位置并将内存指针转换为 Int64。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:31:04.607

假设您有一个`int64_t`表示 64 位整数的类型，您首先将指针转换为指向的指针`char`（根据定义具有`sizeof = 1`），然后将其偏移大小，然后再次将其转换为指向的指针`int64_t`。

```
static_cast< int64_t* >( static_cast< char* >( allocatedObject ) + size ) 
```

那是因为你不能用`void`指针做指针算术，因为它没有大小。或者，您可以`reinterpret_cast`将指向 a 的指针`std::intptr_t`（一个大到足以包含任何指针的整数），将其增加大小，然后强制转换为指向 `int64_t`.

# c++ - 尝试创建类的实例会在 XCode 中引发 vtable 错误

> ID：10610181
> 
> 赞同：0
> 
> 时间：2012-05-15T23:25:32.660
> 
> 标签：c++, xcode, class, linker-errors

我正在尝试创建以下类的实例：

```
#ifndef Sik_GameEntity_h
#define Sik_GameEntity_h

class GameEntity {
    public:

        ~GameEntity(){};
        void setup();
        void update();
        void draw();
        void clear();

    protected:

    private:  
};

#endif 
```

这些方法中的每一个（减去解构器）都在我的 .cpp 文件中得到了充实。

```
for ( int i = 0; i < nEntities; i++ )
{
    GameEntity ent;
    ent.setup();
    entities.push_back(ent);
} 
```

我正在创建一个实例并将其插入到游戏实体对象的向量中。当我创建一个实例时，我从 XCode 收到以下错误：]

```
Undefined symbols for architecture i386:
  "GameEntity::GameEntity()", referenced from:
      appCore::setup() in appCore.o
  "GameEntity::~GameEntity()", referenced from:
      appCore::setup() in appCore.o
      std::vector<GameEntity, std::allocator<GameEntity> >::_M_insert_aux(__gnu_cxx::__normal_iterator<GameEntity*, std::vector<GameEntity, std::allocator<GameEntity> > >, GameEntity const&) in appCore.o
      void std::_Destroy<GameEntity>(GameEntity*) in appCore.o
  "vtable for GameEntity", referenced from:
      GameEntity::GameEntity(GameEntity const&) in appCore.o
  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
ld: symbol(s) not found for architecture i386 
```

我试过添加一个构造函数，但没有任何区别，我仍然收到同样的错误。我在课堂上做错了什么很明显吗？

编辑：我忘了提，我清理了我的构建。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:28:27.627

以下注意和错误意味着您试图在您的 cpp 文件而不是头文件中内联构造函数或设置方法。删除 cpp 文件中的所有内联关键字

```
 NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
 ld: symbol(s) not found for architecture i386 
```

# hibernate - Hibernate：在没有连接表的情况下映射多对多

> ID：10610182
> 
> 赞同：0
> 
> 时间：2012-05-15T23:25:44.940
> 
> 标签：hibernate

考虑我的数据库中的以下 2 个表：

```
FUNCTION_TABLE

FUNC_CD     |   INPUT_ATTR_ID   |   OUTPUT_ATTR_ID
multiply    |   1               |   3
multiply    |   2               |   3
multiply    |   4               |   6 
multiply    |   5               |   6

ATTRIBUTE_TABLE

ATTR_ID     |   ATTR_NAME
1           |   AttributeOne
2           |   AttributeTwo
etc 
```

我的 Function 类应包含以下内容：

```
public class Function {
    private String functionCode;
    private Set<Attribute> inputAttributes;
    private Attribute outputAttribute;
} 
```

然后，我的 Function DAO 将包含一个方法，该方法返回指定 outputAttribute 的 Function 对象

我如何映射这个？我看到的任何示例都需要集合的连接表。

到目前为止，我的映射包含以下内容：

```
<class name="my.Function" table="FUNCTION_TABLE">
    <id name="functionCode" column="FUNC_CD" type="java.lang.String" />
    <many-to-one name="outputAttribute" class="my.Attribute" column="OUTPUT_ATTR_ID"/>
</class> 
```

但是，我不知道如何根据需要映射另一个表的输入属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T12:17:38.863

因为这是在数据库中表示它的非标准方式，所以休眠不支持这个 ootb。

## 选项1：

```
// Function as wrapper around parts

Function getFunction(String code, Attribute outattr)
{
    List<FunctionPart> parts = session.createCriteria(FunctionPart.class)
        .add(Expression.eq("functionCode", code))
        .add(Expression.eq("outputAttribute", outattr))
        .list()

    return new Function(code, outattr, parts);
} 
```

pro：简单 con：每个查询一个函数，附加类，不查询 inattributes

## 选项 2：

使函数成为假实体并依赖于属性

```
<class name="my.Function" table="FUNCTION_TABLE" schemaction="none" where="todo INPUT_ATTR_ID = (min INPUT_ATTR_ID of same id)">
    <id name="functionCode" column="FUNC_CD" type="java.lang.String" />
    <many-to-one name="outputAttribute" class="my.Attribute" column="OUTPUT_ATTR_ID"/>

    <sqlinsert>INSERT into TEMPTABLE</sqlinsert>
    <sqlupdate>INSERT into TEMPTABLE</sqlupdate>

    <set name="inputAttributes" class="my.Attribute" table="FUNCTION_TABLE" cascade="all">
      <key>
        <column name="FUNC_CD" />
        <column name="OUTPUT_ATTR_ID" />
      </key>
      <many-to-many class="Attribute" column="INPUT_ATTR_ID">
    </set>
</class> 
```

亲：根据您的要求 缺点：hackish，不需要的连接，如果不存在则必须创建临时表

# avfoundation - 使用 AVFoundation 创建 MPEG-2 传输流

> ID：10610184
> 
> 赞同：4
> 
> 时间：2012-05-15T23:26:00.240
> 
> 标签：avfoundation, http-live-streaming, avcapturemoviefileoutput

我正在尝试创建一个格式正确的视频文件以用于 Apple 的 HTTP Live Streaming。这是创建文件的代码：

```
// Init the device inputs
AVCaptureDeviceInput *newVideoInput = [[AVCaptureDeviceInput alloc] initWithDevice:[self backFacingCamera] error:nil];
AVCaptureDeviceInput *newAudioInput = [[AVCaptureDeviceInput alloc] initWithDevice:[self audioDevice] error:nil];

// Create session
AVCaptureSession *newCaptureSession = [[AVCaptureSession alloc] init];
newCaptureSession.sessionPreset = AVCaptureSessionPresetMedium;
self.session = newCaptureSession;

// Add inputs and output to the capture session
if ([newCaptureSession canAddInput:newVideoInput]) {
    [newCaptureSession addInput:newVideoInput];
}
if ([newCaptureSession canAddInput:newAudioInput]) {
    [newCaptureSession addInput:newAudioInput];
}

// Setup the output
AVCaptureMovieFileOutput *aMovieFileOutput = [[AVCaptureMovieFileOutput alloc] init];
if ([self.session canAddOutput:aMovieFileOutput])
    [self.session addOutput:aMovieFileOutput];

aMovieFileOutput.maxRecordedDuration = CMTimeMakeWithSeconds(10.f, 1);

// Begin recording
AVCaptureConnection *videoConnection = [self.captureOutput connectionWithMediaType:AVMediaTypeVideo];
if ([videoConnection isVideoOrientationSupported])
    [videoConnection setVideoOrientation:[self calculateVideoOrientation]];

[aMovieFileOutput startRecordingToOutputFileURL:[self nextOutputURL] recordingDelegate:self]; 
```

`[self nextOutputURL]`返回一个有效的`NSURL`，文件已成功保存到磁盘，我可以在 VLC 和 QuickTime 中打开和查看文件。在 VLC 中查看的视频格式是 'avc1' 我收集[到的与 H.264 相同](http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Overview)。在 QuickTime 中查看的视频格式是 H.264。文件的扩展名当然是 .ts。

看来我做的一切都是正确的，但是当我尝试使用 验证我的 HTTP Live 流时`mediastreamvalidator`，我收到以下错误：

```
http://imac.local.:2020/fileSequence000.ts:
ERROR: (-12971) failed to parse segment as either an MPEG-2 TS or an ES 
```

任何人都知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T23:21:12.387

给定的代码不会生成 MPEG-2 传输流，而是生成标准的 MPEG-4 文件，但扩展名为 .ts。VLC 和 QuickTime 都将识别该文件并能够播放它，但 mediastreamvalidator 正确地指出它不是 MPEG-2 TS。检查生成的文件是否为 MPEG-2 TS 的一种快速方法是查看第一个字节。如果它不是 0x47，那么它就不是 MPEG-2 TS。

# java - java命令行包括.jar

> ID：10610185
> 
> 赞同：0
> 
> 时间：2012-05-15T23:26:12.230
> 
> 标签：java, command-line, jar

我可以使用：

```
C:\Program Files (x86)\Java>javac -classpath mail.jar myFile.java 
```

编译，但是当我尝试运行它时：

```
C:\Program Files (x86)\Java>java -cp mail.jar myFile
Exception in thread "main" java.lang.NoClassDefFoundError: myFile
Caused by: java.lang.ClassNotFoundException: myFile
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: myFile.  Program will exit. 
```

我尝试使用“。”来使用各种组合。和“-classpath”表示类路径，因为其他帖子已经建议但无法弄清楚。我已经在同一个文件夹中编译并成功运行了一个基本的 helloworld.java。以管理员身份运行。使用 java 运行时 1.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:28:06.447

将当前目录也放入类路径：

```
java -cp .;mail.jar myFile 
```

如果这不起作用，请发布，`myFile.java`以便我们了解可能发生的情况。例如，是`myFile`在默认包中还是有`package`声明？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:29:28.160

您需要执行以下操作之一：

*   首先打包jar（使用`jar`命令）并使用`java -jar`

*   不指定类路径，只运行你的类文件（独立应用程序）

*   （如果 jarfile 是一个库）你需要在你的类路径中包含当前目录

# java - 递归方法不起作用 - ArrayList

> ID：10610192
> 
> 赞同：1
> 
> 时间：2012-05-15T23:27:00.817
> 
> 标签：java, xml, algorithm, recursion, xml-parsing

我有一个递归方法的问题，它将 XML 文件的所有元素放在 ArrayList 中

```
<?xml version="1.0"  encoding="iso-8859-1"?>
<country>
  <name> France </name>
  <city> Paris </city>
  <region>
     <name> Nord-Pas De Calais </name>
     <population> 3996 </population>
     <city> Lille </city>
  </region>
  <region>
     <name> Valle du Rhone </name>
     <city> Lyon </city>
     <city> Valence </city>
  </region>
 </country> 
```

但我的功能并没有全面完成（获取所有元素）：结果是 [国家、名称、城市、地区、地区] 但我想获取所有元素 [国家、名称、城市、地区、名称、人口、地区,name,city,city]，我认为递归调用不在正确的位置，这是我的代码

```
public static ArrayList<String> TreeToArray (Node node)
{
    ArrayList<String> ArrayNoeud = new ArrayList<String> ();

   ArrayNoeud.add(node.getNodeName());

    NodeList nl = node.getChildNodes();
    for (int i = 0; i < nl.getLength(); i++) {
      Node n = nl.item(i);

      if (n instanceof Element)
      {
           ArrayNoeud.add(n.getNodeName());

      }

    TreeToArray(n);
    }

    return ArrayNoeud;  

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T23:31:48.040

您正在递归，但是您没有将返回值分配给任何东西。

代替

```
 TreeToArray(n); 
```

试试这个：

```
 ArrayNoeud.addAll( TreeToArray(n) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:33:11.517

您正在抛出递归结果而不使用它。你应该添加这样的东西：

```
ArrayNoeud.addAll(TreeToArray(n)); // Didn't notice it was java :) AddRange is C# 
```

此外，您的变量名称应以小写字母开头。

看到一个英语法语复合词总是很奇怪（不是抱怨）:)

# python - 从变量而不是文件创建集合

> ID：10610193
> 
> 赞同：0
> 
> 时间：2012-05-15T23:27:01.207
> 
> 标签：python

我有一段代码可以读取两个文件，将它们转换为集合，然后从另一个中减去一个集合。我想将字符串变量（installedPackages）用于“a”而不是文件。我还想为“c”写一个变量。

```
a = open("/home/user/packages1.txt")
b = open("/home/user/packages.txt")
c = open("/home/user/unique.txt", "w")

for line in set(a) - set(b):
    c.write(line)

a.close()
b.close()
c.close() 
```

我尝试了以下方法，但它不起作用：

```
for line in set(installedPackages) - set(b): 
```

我曾尝试使用 StringIO，但我认为我使用不当。

最后，这是我创建的方式`installedPackages`：

```
stdout, stderr = p.communicate()
installedPackages = re.sub('\n$', '', re.sub('install$', '', re.sub('\t', '', stdout), 0,re.MULTILINE)) 
```

packages.txt 示例：

```
humanity-icon-theme
hunspell-en-us
hwdata
hyphen-en-us
ibus
ibus-gtk
ibus-gtk3
ibus-pinyin
ibus-pinyin-db-android
ibus-table 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:29:50.783

如果要写入字符串缓冲区文件，请使用[`StringIO`](http://docs.python.org/library/stringio.html)

```
>>> from StringIO import StringIO
>>> installed_packages = StringIO()
>>> installed_packages.write('test')
>>> installed_packages.getvalue()
'test' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:31:05.757

set 数据类型以可迭代对象作为参数，因此如果 installedPackages 包含多个项目的字符串，则需要用分隔符将其拆分。例如，以下代码将用所有逗号分割字符串：

```
for line in set(installedPackages.split(',')) - set(b):
    c.write(line) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T00:05:28.000

像下面这样的东西？

**编辑：**经过几次迭代：

```
from subprocess import Popen, PIPE

DEBUG = True
if DEBUG:
    def log(msg, data):
        print(msg)
        print(repr(data))
else:
    def log(msg, data):
        pass

def setFromFile(fname):
    with open(fname) as inf:
        return set(ln.strip() for ln in inf)

def setFromString(s):
    return set(ln.strip() for ln in s.split("\n"))

def main():
    # get list of installed packages
    p = Popen(['dpkg', '--get-selections'], stdout=PIPE, stderr=PIPE)
    stdout, stderr = p.communicate()
    installed_packages = setFromString(stdout)

    # get list of expected packages
    known_packages = setFromFile('/home/john/packages.txt')

    # calculate the difference
    unknown_packages = installed_packages - known_packages
    unknown_packages_string = "\n".join(unknown_packages)

    log("Installed packages:", installed_packages)
    log("Known packages:", known_packages)
    log("Unknown packages:", unknown_packages)

if __name__=="__main__":
    main() 
```

# sip - SIP 协议中的 Call-ID 和 Branch 标签

> ID：10610194
> 
> 赞同：6
> 
> 时间：2012-05-15T23:27:03.313
> 
> 标签：sip

我正在开发一个 SIP 客户端。我了解 SIP 请求和 SIP 响应，但是在 SIP 消息中，呼叫 ID 和分支标签是如何生成的？[RFC3261](http://www.ietf.org/rfc/rfc3261.txt)没有指定这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-16T00:05:18.080

Call-ID 标头值可以是您想要的任何值，但必须是唯一的，以避免请求被归类为重复。

Via 标头上的分支参数需要以 z9hG4bK 的魔法 cookie 值开头，并且还必须是唯一的，以避免请求被归类为重复请求。对于 SIP 代理想要进行环路检测，RFC 中第 16.6 节第 8 点中的指南也详细说明了构建分支参数值时要采取的因素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:54:19.163

你的措辞很难理解。我假设您想知道UAC 应该*如何*`Call-ID`生成参数，或者UAC 或代理服务器应该*如何*生成`branch`参数。

唯一的要求`Call-ID`是它应该是唯一的。它通常采用唯一令牌 + "@" + 主机名（如 email's ）的形式`Message-ID`，但并非必须如此。它可以只是一个独特的令牌。唯一令牌可以是任何可以合理确定是唯一的东西。为了避免泄露私人信息，您可以将其设为伪随机或私人唯一信息（时间、进程 ID 等）的加密哈希

同样，`branch`参数只是一个唯一的标记，但请注意它必须以`z9hG4bK`RFC 中指定的开头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-13T22:48:39.113

为什么要重新发明轮子？

有开源 SIP 项目，它们的实施可能会激发您的灵感。你没有提到你使用什么编程语言。所以我假设你可以阅读 C 代码。

获取[kamailio 服务器](http://www.kamailio.org/w/)的源代码。Call-ID 的实现在 kamailio-4.0.x/modules/tm/callid.c 中。我相信你很聪明，可以自己找出分支标签 :o)

# c# - 包含 .net 运行时安装程序的 c# SmartDevice Cab 安装程序

> ID：10610199
> 
> 赞同：0
> 
> 时间：2012-05-15T23:27:47.083
> 
> 标签：c#, .net, cab, smart-device

我需要能够在 vs2008 中创建一个安装程序，它将安装我的应用程序并在智能设备上设置 .net cf，因为我的应用程序需要它。

这可能吗。如果是这样，它是如何实现的。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:59:48.197

2005 的说明，应该几乎相同。
[http://msdn.microsoft.com/en-us/library/aa446504.aspx](http://msdn.microsoft.com/en-us/library/aa446504.aspx)

# javascript - 我的 javascript 占用了 100% 的 CPU

> ID：10610202
> 
> 赞同：-3
> 
> 时间：2012-05-15T23:28:32.537
> 
> 标签：javascript, debugging

所以我真的不知道为什么我的代码效率非常低，并且会消耗它可以消耗的每一个空闲的 CPU 滴答声。我真的不知道该怎么办。我假设有一些用于解决这类问题的基本工具和技术，它们比注释掉代码块然后检查系统监视器更强大。

我尝试搜索，但所有其他线程我都能找到真正具体的地方。我希望对“该死的我的 javascript 正在消耗 100% CPU，......为什么？”的一般情况得到一些答案。

-提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:32:25.273

您可以使用火虫。从他们的网站：

[http://getfirebug.com/javascript](http://getfirebug.com/javascript)

要使用分析器，只需转到控制台选项卡并单击“配置文件”按钮。然后使用您的应用程序或重新加载页面，然后再次单击“个人资料”按钮。然后，您将看到一份详细的报告，其中显示了调用了哪些函数以及每个函数花费了多少时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:33:05.053

您可能正在运行一个无限循环

编辑，是的，您可以在 jfiddle 中运行它，并锁定窗口，因为它将永远在循环内运行。

转到[http://jsfiddle.net/](http://jsfiddle.net/)并运行

```
i = 0;
while(true) { i++; } 
```

# java - 在 Hibernate 的 XML 配置文件中指定默认值

> ID：10610211
> 
> 赞同：9
> 
> 时间：2012-05-15T23:30:14.570
> 
> 标签：java, hibernate, hibernate-mapping

我正在通过映射配置文件配置 Hibernate。

```
<class name="Person" table="person">
    <id name="id" column="id" type="long"/>
    <property name="name" column="name" type="string"/>
    <property name="age" column="age" type="integer"/>
</class> 
```

如何设置`age`为可空并默认为空？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-18T11:56:55.940

```
<property name="age" type="integer">
  <column name="age" not-null="false" default="null" />
</property> 
```

# c# - 你将如何用 List 填充 asp:GridView > 在 C# 中？

> ID：10610214
> 
> 赞同：0
> 
> 时间：2012-05-15T23:30:58.617
> 
> 标签：c#, asp.net, gridview

我尝试在 Google 中搜索它，但我似乎不断遇到像这样的二维数组解决方案：[http](http://forums.asp.net/t/1318173.aspx/1) ://forums.asp.net/t/1318173.aspx/1 我是否必须将我`List<List<string>>`的 in 转换为两个 -维数组列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:36:11.263

如果您希望所有内容都被展平（即，每个列表一个接一个地显示），您可以这样做：

```
var orig = new List<List<string>>();
var flat = orig.SelectMany(inner => inner).ToList(); 
```

现在您可以使用`flat`绑定到`GridView`，它将包含一个列表，该列表是每个内部列表的展平。

但是，如果您希望每个外部列表元素是一行，并且每个内部列表元素是一列，那么如果内部列表的大小不同（或者如果它们可以），那么您固有地会遇到问题。您需要描述您在这种情况下的期望。

* * *

或者，如果您认为提供的链接可以为您提供答案，只需将您的列表转换为数组：

```
string[][] test = orig.Select(inner => inner.ToArray()).ToArray(); 
```

# macos - 将 NSPersistentDocument 与备用保存格式一起使用是不是很糟糕？

> ID：10610217
> 
> 赞同：3
> 
> 时间：2012-05-15T23:31:14.200
> 
> 标签：macos, cocoa, core-data, nspersistentdocument

我正在考虑制作一个基于核心数据的以文档为中心的应用程序，但我希望保存的文件格式是我自己的 XML、图像和其他东西的专有包。

我的计划是使用 NSPersistentDocument 的子类，当接收到 -writeToURL、-readFromURL 等调用时，它会在我的文件格式和核心数据之间来回序列化。

这是反模式吗？我已经开始尝试它，它似乎可以工作，但我没有看到太多关于这种方法的文档/讨论，这让我停下来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T02:08:26.223

使用[自定义原子存储类型](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/AtomicStore_Concepts/Articles/asRegistration.html)。您只需要成为处理 Core 要求的有效商店类型，其他一切都应该“正常工作”。然后，您的自定义商店类型可以充当 Core Data 和您自己的格式之间的转换层。

# ruby-on-rails - 在rails中找到不同的计数

> ID：10610219
> 
> 赞同：1
> 
> 时间：2012-05-15T23:31:23.030
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我的 PRODUCTS 表中有一个名为类别的列。用户可以为每条记录添加多个类别，每个类别以逗号分隔。我需要在 PRODUCTS 表中查找不同的类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:37:58.000

我同意@Mitch，你应该有一张`ProductCategory`桌子。但只是为了回答你的问题尝试这样的事情：

```
Product.find(:all, :select => "distinct(categories)").map { |c| c.category }.uniq 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:43:33.870

我同意每个产品类别的表格会提供更简单的解决方案。但是，这是我对你的问题的理解，

```
Product.where("categories is like :pattern", :pattern => "%#{category_name}%") 
```

# c - Linux C stat（）八进制权限掩码，连接发送到函数？

> ID：10610225
> 
> 赞同：1
> 
> 时间：2012-05-15T23:32:16.680
> 
> 标签：c, mkdir, stat

刚开始学习一些基本的 C 语言并在 Linux 上使用 stat() 系统调用。

所以`st_mode`在 stat() 的结构中返回的是一个位域。而且我可以简单地获得八进制权限，`printf("octal %o", st.st_mode)`但我只对位域中的某些标志感兴趣，即将`S_IRWXU, S_IRWXG and S_IRWXO`该值发送到另一个函数，例如：mkdir。

这是我的示例程序。
忽略这样一个事实，即这是一个带有硬编码目录的垃圾程序，没有作为参数传递给`create_dir()`函数，也没有错误检查。

```
#include <stdio.h>
#include <sys/stat.h>

static int create_dir(mode_t mode) {
  mkdir("/home/user/blahnew", mode);
}

main() {
  struct stat st;
  int res;
  res = stat("/home/user/blah", &st);

  printf("user %o\n", st.st_mode & S_IRWXU);
  printf("group %o\n", st.st_mode & S_IRWXG);
  printf("other %o\n", st.st_mode & S_IRWXO);

  create_dir(mode);

  return 0;
}
```

如何仅在 st.st_mode 中获取上述标志并将其作为八进制传递`create_dir()`以供`mkdir()`函数使用？

如果我只是这样做了`create_dir(st.st_mode)`，那不会也传递所有其他`mkdir()`不需要的标志...... uid、gid、sticky bit 等？

干杯，B

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:41:30.773

您已经在代码中完成了 99% 的工作。当你说

```
st.st_mode & S_IRWXU 
```

仅保留位掩码`st.st_mode`中存在的位。`S_IRWXU`所以你想要的是一个不同的位掩码，它结合了其他三个：

```
st.st_mode & (S_IRWXU | S_IRWXG | S_IRWXO) 
```

# asp.net-mvc-3 - 为 DI 示例 NTier 空解决方案堆栈寻找 MVC 3 + IoC

> ID：10610229
> 
> 赞同：0
> 
> 时间：2012-05-15T23:32:55.023
> 
> 标签：asp.net-mvc-3, visual-studio-2010, c#-4.0, dependency-injection, inversion-of-control

是否有人为 .NET (C#) 创建了一个空的解决方案堆栈，其中包含使用多个项目的 DI 的 IoC 框架？几个月来，我一直在努力创建一个良好的可重用堆栈，它具有：

1.  MVC UI 网页应用
2.  空 BLL 项目（稍后将添加真实实体）
3.  空 DAL 项目（稍后将添加真正的 daab 类）
4.  参考/搜索数据层
5.  包括一个 IoC 框架
6.  在 Home 控制器中使用 DI 的示例可以通过实体层一直到达 DAL 或通过接口到达所有引用/搜索层
7.  不得在 UI 层设置任何具体类的硬引用

我已经尝试了几次，但我总是在#6 上挂断，而且我缺少堆栈结构中的一些基本内容。有没有人设法做到这一点并有一个示例解决方案来展示它的结构？我可以整天创建堆栈并添加一个 IoC 框架，但完全无法使其结构化，因此没有向 UI 层添加具体引用。对象的接口/具体解析还能如何进行？

当然，你们中的一些学者已经将其扼杀在萌芽状态，请与我分享一些启示:-)

ps - 我不止一次读过 Mark Seeman 的书。我理解组合根的概念......但从未见过在 NTier 解决方案中使用它，并且无法成功实施该理论

我正在寻找的是一个充实的多个项目的解决方案堆栈，可以用作开始的基础。一种成功实现组合根的方法，可用于通过做而不是告诉来教授 SOLID 原则。一个将这一切变为现实的解决方案。请参阅此[问题](https://stackoverflow.com/questions/9501604/ioc-di-why-do-i-have-to-reference-all-layers-assemblies-in-entry-application)以供参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T04:18:48.427

我的 Shuttle Wiki FOSS 包含您所追求的一些元素：

[http://shuttlewiki.codeplex.com/](http://shuttlewiki.codeplex.com/)

*尽管并非每个问题都在其自己的项目/程序集中，但我发现除非您真的*要在其他地方使用相关程序集，否则将它们分开是不值得的。话虽如此，仍然很容易将它们分开，因为已经注意保持关注点脱钩。

浏览了一些评论。我的观点是，不应使用任何项目结构或技术来试图阻止或保护其他开发人员使用某些类。初级开发人员*必须*在某个阶段学习绳索，一些快速的代码演练会发现与您想要实现的目标不一致的编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-18T13:24:46.367

看看我的：使用存储库模式，ninject，实体框架 6，...

[https://github.com/mesuttalebi/NTierCSharpExample](https://github.com/mesuttalebi/NTierCSharpExample)

# javascript - 如果在一个单词中找到相同的字符串，则停止 .replace()

> ID：10610232
> 
> 赞同：0
> 
> 时间：2012-05-15T23:33:07.927
> 
> 标签：javascript, jquery, regex, replace

例如：有一个页面列出了一些带有颜色的项目。有些被列为导航，有些被列为海军。

```
$('.ProductDetails a').each(function() {
    var text = $(this).text();
    $(this).text(text.replace("Nav", "Navy")); 
}); 
```

将导致所有“导航”更改为海军 - 太棒了！

但这也将导致“海军”更改为海军。（即，它将海军中的“导航”替换为海军，并在“导航”被替换后留下“y”）

有没有办法使用上面的技术来阻止这种情况，或者我是否必须更改脚本来解决这些双重问题。

我目前的解决方案是在 Nav 之后添加一个空格 `$(this).text(text.replace("Nav ", "Navy"));`

但这并不理想，因为某些项目可能在它们之后有 / 并且没有空格。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:35:19.327

```
$('.ProductDetails a').each(function() {
    var text = $(this).text();
    $(this).text(text.replace(/^Nav$/g, "Navy")); 
}); 
```

或者：

```
 $(this).text(text.replace(/\sNav\s/g, "Navy")); 
```

或者：

```
 $(this).text(text.replace(/\bNav\b/g, "Navy")); 
```

*还有很多其他的方法...*

**请注意，您可以使用此`text`重载：**

```
$('.ProductDetails a').text(function(index, old) {
    return old.replace(/\sNav\s/g, "Navy");
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:36:16.953

您可以像这样使用正则表达式替换：

```
$(this).text(text.replace(/\snav[\s/]/g,"navy"); 
```

方法：

```
replace [whitespace]nav[whitespace or "/"] to "navy" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:37:02.587

你想使用一个知道单词边界的正则表达式：

```
text.replace(/\bnav\b/, 'Navy') 
```

# visual-studio-2008 - 将 OpenCV 2.0 与 Visual c++ 项目集成的问题

> ID：10610235
> 
> 赞同：0
> 
> 时间：2012-05-15T23:33:38.307
> 
> 标签：visual-studio-2008, visual-c++, opencv

我已经按照[步骤](http://opencv.willowgarage.com/wiki/VisualC++_VS2008)在 Visual Studio 2008 中安装 OpenCV，然后我制作了一个 Windows 窗体应用程序，例如 File->new->project->Visual C++->CLR->Windows Forms Application，之后我将其命名为“ImageProcessing”我将这些文件包含在文件 ImageProcessing.cpp 中：

```
#include <cv.h>
#include <cxcore.h>
#include <math.h>
#include <cv.h>
#include <highgui.h> 
```

接下来，我在现成的表单中拖动了一个按钮，并在其操作中输入了以下语句：

```
IplImage *loadedImage=cvLoadImage("C:\\Documents and Settings\\Owner\\Desktop\\aya.jpg"); 
```

但是当我尝试构建项目时，这些错误出现在我身上：

```
error C2065: 'IplImage' : undeclared identifier
error C2065: 'loadedImage' : undeclared identifier
error C2065: 'CV_LOAD_IMAGE_COLOR' : undeclared identifier
error C3861: 'cvLoadImage': identifier not found 
```

我确定 OpenCV 安装步骤是正确的，因为我对另一个项目尝试了相同的步骤，但它使用不同的模板，就像 File->new->project->Visual C++->Win32->Win32 项目，我不确定这两个模板是否有差异导致发生上述错误，如果有人能够解决这个问题，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:28:51.803

**这些错误的主要原因是：**

1.  我已经包含`#include "stdafx.h"`了最后一个错误的头文件，因为编译器之前忽略了任何头文件`"stdafx.h"`，所以我把它放在前面。

# ipad - 架构 armv7 的未定义符号 - route-me 库，仅限临时

> ID：10610238
> 
> 赞同：0
> 
> 时间：2012-05-15T23:33:59.423
> 
> 标签：ipad, xcode4.3, adhoc, ios5.1, route-me

我已阅读与此主题相关的所有其他问题，但找不到我的答案。我的项目正在使用 route-me。它适用于模拟器和连接的 iPad。临时存档将不会建立。在实施 route-me 之前，我已经成功地制作了一个临时存档 - 并安装了它。我的错误是：

> 架构 armv7 的未定义符号：
> 
> “_ApplicationVersion”，引用自：
> -[RMWebTileImage startLoading:] in libMapView.a(RMWebTileImage.o)
> “_ApplicationNameFromBundle”，引用自：
> -[RMWebTileImage startLoading:] in libMapView.a(RMWebTileImage.o)
> ld: symbol(s)未找到架构 armv7

我的库已正确链接 - 它为模拟器和 iPad 构建，没有错误。我有

> [RMMapView 类]；

在显示地图的视图控制器中。在使用该行之前，如果使用 iTunes 从存档安装我的应用程序会崩溃 - 尽管如果从 Xcode 安装它不会崩溃。现在档案根本不会建立。（但我仍然相信上面的路线让我走上了正确的道路）。

我已经尝试了我在这里找到的所有可能适用的解决方案。如果我删除对 RMWebTileImage.h 和 RMWebTileImage.m 的引用 - 我会得到相同的错误，但这是有道理的。但是当我重新添加引用时，我仍然得到错误，好像文件甚至没有被引用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T14:10:45.197

看起来 route-me 的静态库没有 armv7 符号。检查库的构建设置并确保体系结构构建设置设置为针对 armv6 和 armv7 构建。

您还可以随时使用`lipo -info`静态库来查看所有包含的架构。

如果您正在链接调试配置，这主要设置为仅为活动架构构建。确保项目构建设置与 route-me 项目设置相同。

# c++ - Visual C++ 编译器是否优化了未定义的宏块？

> ID：10610242
> 
> 赞同：0
> 
> 时间：2012-05-15T23:34:34.693
> 
> 标签：c++, optimization, compiler-construction, macros

以这段代码为例：

```
#ifdef THIS_IS_NOT_DEFINED
//lots of code here...
#endif 
```

假设“大量代码”可能会在生成的可执行文件中增加一兆字节。如果 THIS_IS_NOT_DEFINED 确实没有定义，那么编译器是否仍会将所有包含的代码写入 .exe，或者不？大多数编译器是否遵循类似的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:38:13.660

C 预处理器处理#ifdef。如果没有定义，那么编译器本身甚至看不到代码，所以它没有办法进入.exe。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:38:32.230

C++ 编译工作在许多阶段。首先，通过展开`#include`s，`#define`s等对代码进行预处理。这在文本层面起作用，相当于实际修改源代码。

在这种情况下，编译器将从预处理器`#ifdef`块中优化出代码，因为当预处理器运行时，它会将代码从源文件中拼接出来。换句话说，编译器中实际进行编译和代码生成的部分根本看不到那部分代码。就好像它不存在一样。

希望这可以帮助！

# android - MapActivity 中的 ClassNotFoundException？

> ID：10610244
> 
> 赞同：1
> 
> 时间：2012-05-15T23:34:41.593
> 
> 标签：android, exception, android-mapview, classnotfoundexception

创建 MapActivity 时出现此错误

```
05-15 23:31:37.231: E/AndroidRuntime(760): FATAL EXCEPTION: main
05-15 23:31:37.231: E/AndroidRuntime(760): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{pit.opensource.mapapp/pit.opensource.mapapp.M1MapAppActivity}: java.lang.ClassNotFoundException: pit.opensource.mapapp.M1MapAppActivity in loader dalvik.system.PathClassLoader[/data/app/pit.opensource.mapapp-2.apk]
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.os.Looper.loop(Looper.java:130)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-15 23:31:37.231: E/AndroidRuntime(760):  at java.lang.reflect.Method.invokeNative(Native Method)
05-15 23:31:37.231: E/AndroidRuntime(760):  at java.lang.reflect.Method.invoke(Method.java:507)
05-15 23:31:37.231: E/AndroidRuntime(760):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-15 23:31:37.231: E/AndroidRuntime(760):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-15 23:31:37.231: E/AndroidRuntime(760):  at dalvik.system.NativeStart.main(Native Method)
05-15 23:31:37.231: E/AndroidRuntime(760): Caused by: java.lang.ClassNotFoundException: pit.opensource.mapapp.M1MapAppActivity in loader dalvik.system.PathClassLoader[/data/app/pit.opensource.mapapp-2.apk]
05-15 23:31:37.231: E/AndroidRuntime(760):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
05-15 23:31:37.231: E/AndroidRuntime(760):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
05-15 23:31:37.231: E/AndroidRuntime(760):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
05-15 23:31:37.231: E/AndroidRuntime(760):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561) 
```

AndroidManifest.xml 文件在哪里：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="pit.opensource.mapapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".M1MapAppActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

问题是什么 ？？？

更新

MapActivity 类的代码：

```
package pit.opensource.mapapp;

import android.content.Context;
import android.graphics.drawable.Drawable;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.OverlayItem;

public class M1MapAppActivity extends MapActivity {

    private MapController mapController;
    private MapView mapView;
    private LocationManager locationManager;
    private MyOverlays itemizedoverlay;
    private MyLocationOverlay myLocationOverlay;

    @Override
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.main); // bind the layout to the activity

        // Configure the Map
        mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
        mapView.setSatellite(true);
        mapController = mapView.getController();
        mapController.setZoom(14); // Zoon 1 is world view
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
                0, new GeoUpdateHandler());

        myLocationOverlay = new MyLocationOverlay(this, mapView);
        mapView.getOverlays().add(myLocationOverlay);

        myLocationOverlay.runOnFirstFix(new Runnable() {
            public void run() {
                mapView.getController().animateTo(
                        myLocationOverlay.getMyLocation());
            }
        });

        Drawable drawable = this.getResources().getDrawable(R.drawable.point);
        itemizedoverlay = new MyOverlays(this, drawable);
        createMarker();
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

    public class GeoUpdateHandler implements LocationListener {

        @Override
        public void onLocationChanged(Location location) {
            int lat = (int) (location.getLatitude() * 1E6);
            int lng = (int) (location.getLongitude() * 1E6);
            GeoPoint point = new GeoPoint(lat, lng);
            createMarker();
            mapController.animateTo(point); // mapController.setCenter(point);

        }

        @Override
        public void onProviderDisabled(String provider) {
        }

        @Override
        public void onProviderEnabled(String provider) {
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
        }
    }

    private void createMarker() {
        GeoPoint p = mapView.getMapCenter();
        OverlayItem overlayitem = new OverlayItem(p, "", "");
        itemizedoverlay.addOverlay(overlayitem);
        if (itemizedoverlay.size() > 0) {
            mapView.getOverlays().add(itemizedoverlay);
        }
    }

    @Override
    protected void onResume() {
        super.onResume();
        myLocationOverlay.enableMyLocation();
        myLocationOverlay.enableCompass();
    }

    @Override
    protected void onPause() {
        super.onResume();
        myLocationOverlay.disableMyLocation();
        myLocationOverlay.disableCompass();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:02:46.910

在您的清单 `<uses-library android:name="com.google.android.maps" />` 中添加`<application> </application> Tag`

这将解决您的班级未找到异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T05:52:17.417

如果您的项目包含多个包，请尝试在您的 android 清单文件中插入包名称；

```
 <activity
        android:name="com.PackageName.M1MapAppActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

# c++ - 用 c++ 命名的文件名

> ID：10610245
> 
> 赞同：0
> 
> 时间：2012-05-15T23:34:42.233
> 
> 标签：c++, filenames, printf

在 C++ 中，为了编辑许多文件，我使用一些类似于

```
#include<iostream>
#include<fstream>
#include<stdio.h>
using namespace std;

int main(){
    char nombre[10];
    int i;
    ofstream salida;

    for (i = 10; i < 20; i++) {
        sprintf(nombre,"archivo%d.txt",i);
        cout << nombre<<endl;
        salida.open(nombre);
        salida << 1000*i << endl;
        salida.close();
    }
    return 0;
} 
```

存在更好的 C++ 方式吗？没用的`char[10]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:37:02.903

您可以使用 C++`std::ostringstream`类型：

```
for (int i = 10; i < 20; i++) {
    std::ostringstream filename;
    filename << "archivo" << i << ".txt";
    salida.open(filename.str().c_str());
       /* ... */
    salida.close();
} 
```

的大部分用途`sprintf`可以替换为`std::ostringstream`. 不过，您需要包含`<sstream>`头文件才能使其正常工作。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:39:38.450

我认为您只是在寻找 c++ 字符串类。

它可以在`std::string`.

[这是一个很好的参考](http://www.cplusplus.com/reference/string/string/)。

在这里，您将使用字符串：

```
#include <sstream>

...{ 
    std::string fileName = "archivo";
    std::string extension = ".txt";

    ...

    salida.open((fileName + NumberToString(i) + extension).c_str()); 

    ...
}

template <typename T>
string NumberToString ( T Number )
{
    stringstream ss;
    ss << Number;
    return ss.str();
} 
```

以上是[这里](http://www.cplusplus.com/forum/articles/9645/)推荐的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:36:30.457

[boost::format](http://www.boost.org/doc/libs/1_49_0/libs/format/)将非常方便地替换 sprintf。如果这是您正在寻找的。

# javascript - 完全防止复选框打勾/选中

> ID：10610249
> 
> 赞同：48
> 
> 时间：2012-05-15T23:35:13.590
> 
> 标签：javascript, checkbox

我被要求禁用复选框的“勾选”。我没有被要求*禁用*复选框，而是简单地禁用“滴答”。

换句话说，用户会*认为*复选框是可勾选的，但事实并非如此。相反，单击复选框将导致出现模式对话框，为用户提供更多选项来打开或关闭复选框所代表的功能。如果在对话框中选择的选项导致该功能被打开，则该复选框将被勾选。

现在，真正的问题是，在*一瞬间*，您仍然可以看到复选框被选中。

我尝试过这样的方法：

```
<input type='checkbox' onclick='return false' onkeydown='return false' />

$('input[type="checkbox"]').click(function(event) {
    event.preventDefault();
    alert('Break');
}); 
```

如果您运行此程序，将出现警报，显示刻度是可见的（警报只是在那里证明它仍然被打勾，在生产中，警报不存在）。在一些机器速度较慢的用户和/或渲染器/javascript 速度较慢的浏览器中，用户可以看到非常微弱的闪烁（闪烁有时会持续半秒，这一点很明显）。

我团队中的一名测试人员将此标记为缺陷，我应该修复它。我不确定还有什么方法可以防止复选框中的勾闪烁！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-15T23:38:37.227

尝试

```
event.stopPropagation(); 
```

[http://jsfiddle.net/DrKfE/3/](http://jsfiddle.net/DrKfE/3/)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-04-10T16:19:12.777

我想出的最佳解决方案：

```
$('input[type="checkbox"]').click(function(event) {
    var $checkbox = $(this);

    // Ensures this code runs AFTER the browser handles click however it wants.
    setTimeout(function() {
      $checkbox.removeAttr('checked');
    }, 0);

    event.preventDefault();
    event.stopPropagation();
}); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-10-16T12:34:43.743

从我的角度来看，它很简单：

```
$(this).prop('checked', !$(this).prop('checked')); 
```

适用于选中和未选中的框

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-05-16T00:20:17.107

这个效果恐怕无法抑制。一旦你点击复选框，状态（和渲染）就会改变。然后将调用事件处理程序。如果您执行 a ，则在执行所有处理程序*后*`event.preventDefault()`，该复选框将被重置。如果您的处理程序有很长的执行时间（很容易使用 modal 进行测试）和/或渲染引擎在重置之前重新绘制，则该框将闪烁。*`alert()`*

 *```
$('input[type="checkbox"]').click(function(event) {
    this.checked = false; // reset first
    event.preventDefault();
    // event.stopPropagation() like in Zoltan's answer would also spare some
    // handler execution time, but is no more needed here

    // then do the heavy processing:
    alert('Break');
}); 
```

该解决方案将闪烁减少到最低限度，但不能真正阻碍它。有关如何模拟复选框，请参阅 Thr4wn 和 RobG 的答案。我更喜欢以下内容：

```
<button id="settings" title="open extended settings">
    <img src="default_checkbox.png" />
</button> 
```

```
document.getElementById("settings").addEventListener("click", function(e) {
    var img = this.getElementsByTagName("img")[0]);
    openExtendedSettingsDialog(function callbackTick() {
        img.src = "checked_checkbox.png";
    }, function callbackUntick() {
        img.src = "unchecked_checkbox.png";
    });
}, false); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-04-10T12:56:18.160

最后使用非常重要`return false`。

像这样的东西：

```
$("#checkbox").click((e) => {
  e.stopPropagation();
  return false;
}); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-04-10T11:41:01.160

不是更简单吗？：

```
<input type="checkbox" onchange="this.checked = !this.checked"> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-04-20T22:10:07.277

### TL：博士；

HTML api 在 JavaScript 之前执行。因此，您必须使用 JavaScript 来撤消 HTML 的更改。

```
event.target.checked = false 
```

### 问题是什么？

严格来说：我们不能“阻止”复选框被勾选。为什么不？因为“被打勾”正好意味着 DOM 的 HTML`<input>`元素的`checked`属性值为`true`or ，它是由*HTML api*`false`立即分配的

 *```
console.log(event.target.checked) // will be opposite of the previous value 
```

所以值得一提的是这个 HTML api 在脚本之前被调用。这是直观的并且应该是有意义的，因为所有 JavaScript 文件本身都是`<script>`元素属性的分配`src`，并且 DOM 树中的祖先关系，在你`<input>`的问题和`<script>`运行你的 JavaScript 的元素之间，是*非常重要*的考虑。

### 如何获得我们的解决方案

在我们有机会拦截控制流（通过像 jQuery 之类的 JS 文件）之前，尚未绘制 HTML 分配的值，因此我们只需将`checked`属性重新分配给我们想要的布尔值：（`false`在您的情况下）。

因此，总而言之，我们实际上可以“停止”复选框被选中，只需确保该`checked`属性`false`在下一次渲染中，因此不会看到任何更改。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-15T23:38:57.063

使用 CSS，您可以更改复选框的图像。请参阅[http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)以及[CSS 样式复选框](https://stackoverflow.com/questions/1986608/css-styling-checkboxes)。

我会禁用该复选框，但将其替换为工作复选框的图像。这样复选框看起来不会被禁用，但不会被点击。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-07-31T16:28:26.010

用另一个以某种方式阻止指针事件（可能通过 CSS）的元素包装复选框。然后，直接处理*wrapper*的点击事件而不是复选框。这可以通过多种方式完成，但这里有一个相对简单的示例实现：

```
$('input[type="checkbox"').parent('.disabled').click( function() {

    // Add in whatever functionality you need here

    alert('Break');

});
```

```
/* Insert an invisible element that covers the checkbox */
.disabled {
    position: relative;
}
.disabled::after {
    content: "";
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    bottom: 0px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<!-- Only wrapped checkboxes are "disabled" -->
<input type="checkbox" />
<span class="disabled"><input type="checkbox" /></span>
<input type="checkbox" />
<span class="disabled"><input type="checkbox" /></span>
<span class="disabled"><input type="checkbox" /></span>
<input type="checkbox" />
```

注意：如果您愿意，也可以通过编程方式添加包装器元素。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-02-04T17:10:43.473

为什么不简单地在你的 CSS 中添加一个设置类`pointer-events: none;`？

就像是：

```
<style>
    input.lockedCbx { pointer-events: none; }
</style>
...
<input type="checkbox" class="lockedCbx" tabindex=-1 />
... 
```

您需要`tabindex=-1`阻止用户在复选框中切换并按空格键进行切换。

现在理论上你可以避免类并使用`tabindex=-1`来控制禁用，如下所示：

```
<script>
    input[type="checkbox"][tabindex="-1"] { pointer-events: none; }
</script> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-05-16T00:20:43.770

在我看来，您使用了错误的界面元素，更合适的应该是默认禁用的按钮，但在该选项可用时启用。显示的图像可以是任何你想要的。

```
<button disabled onclick="doSomething();">Some option</button> 
```

当用户选择了该功能时，启用该按钮。按钮上的图像可以通过 CSS 来修改，具体取决于它是否启用，或者通过启用/禁用功能。

例如

```
<script type="text/javascript">

function setOption(el) {
  var idMap = {option1:'b0', option2: 'b1'};
  document.getElementById(idMap[el.value]).disabled = !el.checked; 
}

</script>

<div><p>Select options</p>
  <input type="checkbox" onclick="setOption(this);" value="option1"> Option 1
  <br>
  <input type="checkbox" onclick="setOption(this);" value="option2"> Option 2
  <br>
</div>
<div>
  <button id="b0" onclick="alert('Select…');" disabled>Option 1 settings</button>
  <button id="b1" onclick="alert('Select…');" disabled>Option 2 settings</button>
</div> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-08-23T15:16:41.847

只需将值还原回来

```
$('input[type="checkbox"]').on('change', function(e) {
    if (new Date().getDate() === 13) {
        $(this).prop('checked', !$(this).prop('checked'));
        e.preventDefault();
        return false;
     }
     // some code here
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-24T04:53:50.170

该`Event.preventDefault`方法*应该*适用于`change`、`keydown`和`mousedown`事件，但不适用于我的测试。

我在 Mozilla Firefox 53.0 扩展中解决这个问题的方法是切换一个 HTML 类，该类启用/禁用`pointer-events: none`应用于复选框的 CSS 声明。这解决了基于光标的情况，而不是基于键的情况。请参阅[https://www.w3.org/TR/SVG2/interact.html#PointerEventsProp](https://www.w3.org/TR/SVG2/interact.html#PointerEventsProp)。

我通过添加/删除 HTML`tabindex="-1"`属性来解决基于键的情况。请参阅[https://html.spec.whatwg.org/multipage/interaction.html#attr-tabindex](https://html.spec.whatwg.org/multipage/interaction.html#attr-tabindex)。

请注意，禁用`pointer-events`将禁用您在悬停时触发 CSS 光标的能力（例如，`cursor: not-allowed`）。我的复选框已经包含在一个`span`元素中，因此我向该元素添加了一个 HTML 类，`span`然后我将我的 CSS`cursor`声明重新定位到该元素上。

另请注意，添加`tabindex="-1"`属性*不会*`HTMLElement.blur()`从复选框中移除焦点，因此如果复选框在属性出现时是活动元素，则需要使用该方法或通过聚焦另一个元素来显式散焦它以防止基于键的输入添加。复选框是否是焦点元素可以用`my_checkbox.isEqualNode(document.activeElement)`.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-09-21T08:50:00.953

将此添加到 js 文件中的单击事件

```
event.stopPropagation(); 
```**

# unit-testing - 如何在 JUnit 中触发 AfterBeanDiscovery

> ID：10610253
> 
> 赞同：1
> 
> 时间：2012-05-15T23:35:23.760
> 
> 标签：unit-testing, cdi

我有以下四个类：DataConsumer、DataProducer、SomeQualifier、一个 META-INF/beans.xml 和一个测试。类文件编码如下：

```
public class DataConsumer {

private boolean loaded = false;

@Inject
@SomeQualifier
private String someString;

public void afterBeanDiscovery(
        @Observes final AfterBeanDiscovery afterBeanDiscovery,
        final BeanManager manager) {
    loaded = true;
}

public boolean getLoaded() {
    return loaded;
}

public String sayHello() {
    return someString;
}

}

public class DataProducer {

@Produces
@SomeQualifier
private final String sample = "sample";
}

public @interface SomeQualifier {

} 
```

单元测试看起来像这样。

```
public class WeldTest {
@Test
public void testHelloWorld() {
    final WeldContainer weld = new Weld().initialize();
    final DataConsumer consumer = weld.instance()
            .select(DataConsumer.class).get();
    Assert.assertEquals("sample", consumer.sayHello());
    Assert.assertTrue(consumer.getLoaded());
}
} 
```

但是，它使用 getLoaded() 在 assertTrue 上失败，似乎 @Observes 没有被解雇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:03:38.413

我发现了一个回答了我的问题的类似问题

[CDI - 观察容器事件](https://stackoverflow.com/questions/3540137/cdi-observing-container-events)

虽然我无法将 DataConsumer 用作扩展和 CDI 托管 bean。所以它需要一个第三类才能成为扩展。但是，由于 Extension 无法访问托管 bean，因为它们尚未创建，因此我得出结论，使用 @Observes AfterBeanDiscovery 修改 bean 数据是不可能的解决方案。即使是传入的 BeanManager 也找不到任何 bean。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T02:54:57.067

看看 arquillian：www.arquillian.org。它会为你处理这一切。

# ruby - 无法通过 rvm 安装指南针

> ID：10610254
> 
> 赞同：8
> 
> 时间：2012-05-15T23:35:24.933
> 
> 标签：ruby, rvm, compass-sass

在 Ubuntu 11.10 中，我是一个快乐且无忧无虑的指南针用户。我升级到 12.04 并遇到了这个问题：[Compass (ruby) encoding error](https://stackoverflow.com/questions/10495908/compass-ruby-encoding-error)

我设法通过 rvm 在我的一台计算机上安装 ruby​​ 解决了这个问题，但现在我在另一台计算机上遇到了不同的错误（它有相同的初始问题）。我安装了 ruby​​ 和 compass 并默认使用全局 gemset：

```
 gem list

*** LOCAL GEMS ***

bundler (1.1.3)
chunky_png (1.2.5)
compass (0.12.1)
fssm (0.2.9)
rake (0.9.2.2)
rubygems-bundler (1.0.0)
rvm (1.11.3.3)
sass (3.1.18) 
```

但是当我尝试用指南针做任何事情时，我得到了这个错误：

```
 compass
/home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler/shared_helpers.rb:22:in `default_gemfile': Could not locate Gemfile (Bundler::GemfileNotFound)
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler.rb:213:in `default_gemfile'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler.rb:164:in `root'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler.rb:123:in `load'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler.rb:114:in `setup'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.3/lib/bundler.rb:119:in `require'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/gems/compass-0.12.1/bin/compass:25:in `<top (required)>'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/bin/compass:19:in `load'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/bin/compass:19:in `<main>'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/bin/ruby_noexec_wrapper:14:in `eval'
    from /home/mrpotato/.rvm/gems/ruby-1.9.3-p194@global/bin/ruby_noexec_wrapper:14:in `<main>' 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-16T00:01:19.193

刚发布的新版 ruby​​gems-bundler 似乎有问题。安装以前的版本 ( `gem install -v 0.9.2 rubygems-bundler`) 为我修复了它。

编辑：我也跑了`rubygems-bundler-uninstaller`，这可能是修复的真正来源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T22:06:25.757

我今天在使用 Mountain Lion 的 Mac 上安装 Compass/SASS/RVM 时遇到了这个问题。

我无法让 ruby​​gems-bundler-uninstaller 运行/卸载，所以我必须执行以下操作：

1.  切换到 rvm 全局 gemset 并卸载 ruby​​gems-bundler rvm ruby​​-1.9.3-p194@global 然后 gem uninstall ruby​​gems-bundler

2.  然后切换回我的另一个 gemset - rvm ruby​​-1.9.3-p194 现在运行 compass 或 sass 或任何 gem 工作

不确定这是否是正确的做事方式，但它对我有用。希望对某人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T22:52:15.720

如果您正在使用 yeoman 构建一个基于节点的应用程序，而该应用程序恰好想要使用 compass，则可以禁用这些类型的应用程序的 Gemfile 要求。

只需将此行添加到您的`~/.bash_profile`：

```
export NOEXEC_EXCLUDE="compass" 
```

运行`source ~/.bash_profile`并再试一次。`grunt server`在 yeoman 生成的 Angular 项目（不需要 Gemfile）上运行时，我遇到了这个问题。

[https://github.com/mpapis/rubygems-bundler#disabling-executables](https://github.com/mpapis/rubygems-bundler#disabling-executables)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T02:45:56.057

**这是指南针**中的一个错误，它假定调用了`Bundler`手段`Bundler.setup`的存在。

以下是打破它的行[https://github.com/chriseppstein/compass/blob/stable/bin/compass#L24-L26](https://github.com/chriseppstein/compass/blob/stable/bin/compass#L24-L26)：

```
24 if defined?(Bundler)
25   Bundler.require :assets
26 end 
```

# php - PHP - 在某个点停止所有 curl_multi 请求

> ID：10610259
> 
> 赞同：1
> 
> 时间：2012-05-15T23:35:59.077
> 
> 标签：php, curl, curl-multi

我有一个使用 curl_multi 同时发出多个请求的 php 脚本。

它访问我的几个站点以搜索定义的值。

现在我遇到的问题是，如果 curl 请求在其中一个站点上找到我正在搜索的值，它应该停止。

假设我为单词 stackoverflow 解析了 1000 页。该脚本一次使用 curl_multi 和 10 个请求访问这些页面。假设脚本在第 589 页找到了单词 stackoverflow，它现在应该停止所有进一步的请求。

这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:50:37.353

在您的代码中的某处，您有一个处理单个 curl 句柄的循环。在该循环中，您插入以下逻辑。

```
if(shouldStop()) {
    break;
} 
```

# ruby-on-rails - 使用 RSpec 测试 page_caching

> ID：10610266
> 
> 赞同：1
> 
> 时间：2012-05-15T23:36:34.137
> 
> 标签：ruby-on-rails, ruby, rspec

有谁知道如何使用 RSpec 在 Rails 中测试 page_caching 而无需检查是否已为每个请求创建缓存文件？更像 Controller.performs_page_caching(:action).should be_true？

我试过在网上查看，但我没有找到任何有效的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:52:40.737

我想出了一个解决方案。您覆盖 ApplicationController 类的 caches_page 类方法并设置一个后过滤器，它将标头“x-page-cached”设置为 true。然后在您的测试脚本中包含一个 page_cached 的宏？这将检查 response.headers['x-page-cached'] 是否为真。仅对测试和开发环境执行此操作。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-27T21:43:51.843

好像是集成测试。例如，您可以尝试编写请求规范并以某种方式计算数据库查询的数量。

# plone - Products.Five.viewlet.metaconfigure.DublinCoreViewlet 上的 LocationError 用于元标记

> ID：10610268
> 
> 赞同：0
> 
> 时间：2012-05-15T23:36:51.250
> 
> 标签：plone

我没有改变任何东西。我只是重新运行 ./bin/buildout -N 和 ./bin/instance fg。然后发生了错误。它发生在我所有的 plone buidlout 项目中。我上网查了一下，没找到解决办法。有人遇到过这个错误吗？

```
 http://localhost:8080/Plone/front-page/document_view
Traceback (innermost last):
  Module ZPublisher.Publish, line 126, in publish
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Shared.DC.Scripts.Bindings, line 322, in __call__
  Module Shared.DC.Scripts.Bindings, line 359, in _bindAndExec
  Module Products.CMFCore.FSPageTemplate, line 240, in _exec
  Module Products.CMFCore.FSPageTemplate, line 180, in pt_render
  Module Products.PageTemplates.PageTemplate, line 79, in pt_render
  Module zope.pagetemplate.pagetemplate, line 132, in pt_render
  Module zope.pagetemplate.pagetemplate, line 240, in __call__
  Module zope.tal.talinterpreter, line 271, in __call__
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 888, in do_useMacro
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 533, in do_optTag_tal
  Module zope.tal.talinterpreter, line 518, in do_optTag
  Module zope.tal.talinterpreter, line 513, in no_tag
  Module zope.tal.talinterpreter, line 343, in interpret    
  Module zope.tal.talinterpreter, line 852, in do_condition
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 533, in do_optTag_tal
  Module zope.tal.talinterpreter, line 518, in do_optTag
  Module zope.tal.talinterpreter, line 513, in no_tag
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 531, in do_optTag_tal
  Module zope.tal.talinterpreter, line 513, in no_tag
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 742, in do_insertStructure_tal
  Module Products.PageTemplates.Expressions, line 218, in evaluateStructure
  Module zope.tales.tales, line 696, in evaluate
   - URL: file:/home/ivan/var/buildout-cache/eggs/Products.CMFPlone-4.1.3-py2.6.egg/Products/CMFPlone/skins/plone_templates/main_template.pt
   - Line 50, Column 8
   - Expression: <StringExpr u'plone.htmlhead'>
   - Names:
      {'container': <ATDocument at /Plone/front-page>,
       'context': <ATDocument at /Plone/front-page>,
       'default': <object object at 0x7fab678dfb10>,
       'here': <ATDocument at /Plone/front-page>,
       'loop': {},
       'nothing': None,
       'options': {'args': ()},
       'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0xa9a0628>,
       'request': <HTTPRequest, URL=http://localhost:8080/Plone/front-page/document_view>,
       'root': <Application at >,
       'template': <FSPageTemplate at /Plone/front-page/document_view>,
       'traverse_subpath': [],
       'user': <PropertiedUser 'admin'>}
  Module zope.contentprovider.tales, line 80, in __call__
  Module plone.app.viewletmanager.manager, line 85, in render
  Module plone.app.layout.viewlets.common, line 48, in render
  Module Products.Five.browser.pagetemplatefile, line 125, in __call__
  Module Products.Five.browser.pagetemplatefile, line 59, in __call__
  Module zope.pagetemplate.pagetemplate, line 132, in pt_render
  Module zope.pagetemplate.pagetemplate, line 240, in __call__
  Module zope.tal.talinterpreter, line 271, in __call__
  Module zope.tal.talinterpreter, line 343, in interpret
  Module zope.tal.talinterpreter, line 819, in do_loop_tal
  Module zope.tales.tales, line 682, in setRepeat
  Module zope.tales.tales, line 696, in evaluate
   - URL: /home/ivan/var/buildout-cache/eggs/plone.app.layout-2.1.12-py2.6.egg/plone/app/layout/viewlets/dublin_core.pt
   - Line 1, Column 0
   - Expression: <PathExpr standard:u'view/metatags'>
   - Names:
      {'args': (),
       'container': <ATDocument at /Plone/front-page>,
       'context': <ATDocument at /Plone/front-page>,
       'default': <object object at 0x7fab678dfb10>,
       'here': <ATDocument at /Plone/front-page>,
       'loop': {},
       'nothing': None,
       'options': {},
       'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0xa227e10>,
       'request': <HTTPRequest, URL=http://localhost:8080/Plone/front-page/document_view>,
       'root': <Application at >,
       'template': <Products.Five.browser.pagetemplatefile.ViewPageTemplateFile object at 0x9c04090>,
       'traverse_subpath': [],
       'user': <PropertiedUser 'admin'>,
       'view': <Products.Five.viewlet.metaconfigure.DublinCoreViewlet object at 0xb12e850>,
       'views': <Products.Five.browser.pagetemplatefile.ViewMapper object at 0x8c6a310>}
  Module zope.tales.expressions, line 217, in __call__
  Module Products.PageTemplates.Expressions, line 147, in _eval
  Module zope.tales.expressions, line 124, in _eval
  Module Products.PageTemplates.Expressions, line 97, in trustedBoboAwareZopeTraverse
  Module zope.traversing.adapters, line 136, in traversePathElement
   - __traceback_info__: (<Products.Five.viewlet.metaconfigure.DublinCoreViewlet object at 0xb12e850>, 'metatags')
  Module zope.traversing.adapters, line 50, in traverse
   - __traceback_info__: (<Products.Five.viewlet.metaconfigure.DublinCoreViewlet object at 0xb12e850>, 'metatags', [])
LocationError: (<Products.Five.viewlet.metaconfigure.DublinCoreViewlet object at 0xb12e850>, 'metatags') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T04:22:57.393

我们发现了错误的原因。我确实改变了一些东西。行动！我不小心编辑了 zope.viewlet 包中的代码。

# php - 如何在这个 php 脚本中删除数据库行

> ID：10610272
> 
> 赞同：0
> 
> 时间：2012-05-15T23:37:51.947
> 
> 标签：php, javascript, jquery

我的 php 代码有问题。我目前正在做的是使用 iframe 将 javascript 消息与 phe 脚本链接。在 javascript 函数 stopImageUpload 中，我已声明如果成功 = 2，则显示文件上传的取消消息。

因此，我在 php 脚本中尝试但未能执行的操作是尝试声明如果 $result = 2（换句话说，如果成功 = 2 消息出现在 javascript 中），则删除数据库行。如何才能做到这一点？

下面是表单代码：

```
var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
  "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
  "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" +     
  "</p><p class='imagef1_cancel' align='center'><label>" + 
  "<input type='button' name='imageCancel' class='imageCancel' value='Cancel' /></label>" +
  "<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form>"); 
```

下面是 startImageUpload() 函数，它开始上传文件并存储取消按钮函数：

```
 function startImageUpload(imageuploadform, imagefilename){
    $('.imagef1_cancel').eq(window.lastUploadImageIndex).find(".imageCancel").on("click", function(event) {
      return stopImageUpload(2);
      });     
    return true;
  } 
```

下面是 stopImageUpload() 函数，它使用成功和结果显示取消消息：

```
function stopImageUpload(success, imagefilename){
  var result = '';
  if (success == 2){
    result = '<span class="imagecemsg"> The file upload was canceled!</span><br/><br/>';
  } else {
    result = '<span class="imageemsg">There was an error during file upload!</span><br/><br/>';
  }         
  return true;   
} 
```

最后下面是使用 iframe 链接到 QandATable.php（包含上述代码的脚本）的 imageupload.php 脚本，这是假设要插入和删除数据库行的位置：

```
 <?php
      session_start();
      ...//connected to DB
      $result = 0;

if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) {
    $result = 1;

    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";

    mysql_query($imagesql);

}
    else
      {

      $result = 1;

        $imagesql = "INSERT INTO Image (ImageFile) 
        VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";

mysql_query($imagesql);

      }

      if ($result == 2) {
        $imagecancelsql = "DELETE FROM Image 
                           WHERE ImageFile = 'ImageFiles/".
                           mysql_real_escape_string($_FILES['fileImage']['name'])."'";
        mysql_query($imagecancelsql);
      }
      mysql_close();
    ?>
    <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result ? 'true' : 'false'; ?>, '<?php echo $_FILES['fileImage']['name'] ?>');</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:21:38.727

您的代码存在严重问题需要解决：

**1)**

这一行：

```
return stopImageUpload(2); 
```

正在调用函数：

```
function stopImageUpload(success, imagefilename){...} 
```

但是该`stopImageUpload`函数需要两个参数，`success`并且`imagefilename`

* * *

**2)**

此函数返回 true，但应返回`result`.

```
function stopImageUpload(success, imagefilename){
  ...
  return true;   
} 
```

* * *

**3)**

在这里你设置`$result`了 value `0`，并与 value 比较`2`？！？

```
$result = 0;

if ($result == 2) { 
```

* * *

**4)**

这个函数接受两个参数，但是没有一个在内部使用？！？

```
function startImageUpload(imageuploadform, imagefilename){...} 
```

此外，它正在返回

```
return stopImageUpload(2); 
```

或者

```
return true; 
```

你控制住了这种局面！

**注意：**您在哪里使用此功能？！？

* * *

**5)**

此验证可能会失败，因为`file_exists`检查文件或目录是否存在。因此，如果文件不存在，则目录肯定存在，并且它将继续执行。

```
if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) { 
```

您应该使用[is_file](http://php.net/manual/en/function.is-file.php)来告诉您该文件是否为常规文件。

* * *

**6)**

您不应该再使用`mysql_query`了，请阅读[MySQL 开发人员的 PDO 教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

~~`mysql_query($imagesql)`~~

* * *

## 请阅读此主题：^(了解您为何未能实现目标)

[PHP 变量](http://www.php.net/manual/en/language.variables.basics.php)

[JavaScript 变量](http://www.w3schools.com/js/js_variables.asp)

[JavaScript 函数](http://www.quirksmode.org/js/function.html)

[PHP 文件上传 eg 1](http://www.w3schools.com/php/php_file_upload.asp) | [PHP 文件上传 eg 2](http://www.quackit.com/php/tutorial/php_upload_file.cfm) | [PHP文件上传例如3](http://www.tizag.com/phpT/fileupload.php)

* * *

我希望这可以帮助您走上正确的轨道并解决您当前代码的一些问题。

*祝你好运！*

# php - 使用 WordPress 后端从表单显示 POST 数据的最简单方法？

> ID：10610277
> 
> 赞同：4
> 
> 时间：2012-05-15T23:38:18.497
> 
> 标签：php, forms, wordpress

我在 WordPress 帖子上有一个标准的 HTML 表单，访问者将填写该表单。它主要由复选框组成。我想要的是，在提交表单后，会向用户显示一个页面，显示他们检查的内容。例如，如果访问者勾选了复选框 A、B 和 E（而不是 C 和 D），那么在提交时他们会看到以下内容：

```
You submitted:
Checkbox Value A
Checkbox Value B
Checkbox Value E 
```

显然我可以只用 PHP 做到这一点，但我的客户希望能够修改表单选项。因此，我需要一个易于使用的后端。

是否有可以创建它的插件或用户友好的方式？还是我最好自己开始构建它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-15T23:40:43.567

最简单的方法是：

```
<pre>
<?php var_dump($_POST);?>
</pre> 
```

但你可以像这样设计它：

```
<?php
    foreach($_POST as $key=>$post_data){
        echo "You posted:" . $key . " = " . $post_data . "<br>";
    }
?> 
```

**请注意**`$post_data`，如果类型不能显示为字符串，例如 POST 数据中的数组，这可能会出错。这可以扩展到：

```
<?php
    foreach($_POST as $key=>$post_data){
        if(is_array($post_data)){
            echo "You posted:" . $key . " = " . print_r($post_data, true) . "<br>";
        } else {
            echo "You posted:" . $key . " = " . $post_data . "<br>";
        }
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:50:55.137

你可以在 jQuery 中做一些事情。

```
$.post(
    "post.php",
    {checkbox : 1, checkbox2 : 0, checkbox3 : 0}, // this is the body of the post request
    function(data) {
       alert('page content: ' + data); // look up values in checkboxes and display them
    }
); 
```

我不确定 wordpress 需要什么样的数据，如果您需要用户登录，它可能还需要发送一些会话 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-22T16:59:04.297

如果你想显示一个 json 编码的`POST`数组列表很简单

```
<?php echo json_encode($_POST);?> 
```

# css - Meteor 如何为不同的媒体类型提供多个 CSS？

> ID：10610279
> 
> 赞同：4
> 
> 时间：2012-05-15T23:38:28.163
> 
> 标签：css, meteor

我想让我的 Meteor 应用程序为各种媒体类型提供多个 css 页面。例如：

```
<link rel="stylesheet" type="text/css" media="screen" href="screen.css" />
<link rel="stylesheet" type="text/css" media="print" href="print.css" />
<link rel="stylesheet" type="text/css" media="handheld" href="handheld.css" /> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T12:07:51.280

```
/packages/meteor/package.js 
```

定义`.css`应该捆绑文件。

但是，仔细查看[docs.meteor.com](http://docs.meteor.com)，我们可以找到以下信息：

> CSS 文件的工作方式相同：客户端将获得包含树中所有 CSS 的捆绑包（不包括服务器和公共子目录）。

最后一部分是有趣的部分，如果您将 CSS 文件放入其中，`/public`它们将不会捆绑在一起。而是`app/lib/bundler.js`在第 517 行周围执行以下操作：

```
files.cp_r(path.join(project_dir, 'public'),
           path.join(build_path, 'static'), {ignore: ignore_files}); 
```

而服务器端，任何未解析的文件也会被检入`build/static`，这意味着当您放入时`screen.css`，`/public`您可以继续`screen.css`在客户端使用。

# javascript - AngularJS - 使用 ng-model 时忽略输入文本框上的值属性？

> ID：10610282
> 
> 赞同：222
> 
> 时间：2012-05-15T23:38:39.403
> 
> 标签：javascript, html, angularjs

如果我将简单的输入文本框值设置为下面的“bob”，则使用 AngularJS。`ng-model`如果添加了属性，则不会显示该值。

```
 <input type="text"
           id="rootFolder"
           ng-model="rootFolders"
           disabled="disabled"
           value="Bob"
           size="40"/> 
```

任何人都知道一个简单的解决方法，可以将此输入默认为某些东西并保留`ng-model`? 我尝试将 a`ng-bind`与默认值一起使用，但这似乎也不起作用。

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2012-05-16T05:17:25.620

这是期望的行为，您应该在控制器中定义模型，而不是在视图中。

```
<div ng-controller="Main">
  <input type="text" ng-model="rootFolders">
</div>

function Main($scope) {
  $scope.rootFolders = 'bob';
} 
```

* * *

## 回答 #2

> 赞同：189
> 
> 时间：2012-09-30T00:11:03.873

Vojta 描述了“Angular 方式”，但如果你真的需要完成这项工作，@urbanek 最近发布了一个使用 ng-init 的解决方法：

```
<input type="text" ng-model="rootFolders" ng-init="rootFolders='Bob'" value="Bob"> 
```

[https://groups.google.com/d/msg/angular/Hn3eztNHFXw/wk3HyOl9fhcJ](https://groups.google.com/d/msg/angular/Hn3eztNHFXw/wk3HyOl9fhcJ)

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2013-12-11T15:21:46.433

覆盖输入指令似乎确实可以完成这项工作。[我对Dan Hunsaker](https://stackoverflow.com/users/1973492/dan-hunsaker)的代码做了一些小改动：

*   `$parse().assign()`在尝试在没有 ngModel 属性的字段上使用之前添加了对 ngModel 的检查。
*   更正了`assign()`函数参数顺序。

```
app.directive('input', function ($parse) {
  return {
    restrict: 'E',
    require: '?ngModel',
    link: function (scope, element, attrs) {
      if (attrs.ngModel && attrs.value) {
        $parse(attrs.ngModel).assign(scope, attrs.value);
      }
    }
  };
}); 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-05-09T13:46:16.670

## 角度方式

正确的 Angular 方法是在表单模板中编写单页应用程序 AJAX，然后从模型中动态填充它。默认情况下，模型不会从表单中填充，因为模型是唯一的事实来源。相反，Angular 会采取另一种方式，并尝试从模型中填充表单。

## 但是，如果您没有时间从头开始

如果您编写了一个应用程序，这可能涉及一些相当大的架构更改。如果您尝试使用 Angular 来增强现有表单，而不是从头开始构建整个单页应用程序，您可以从表单中提取值并在链接时使用指令将其存储在范围中。然后，Angular 会将范围内的值绑定回表单并保持同步。

## 使用指令

您可以使用相对简单的指令从表单中提取值并将其加载到当前范围。在这里，我定义了一个 initFromForm 指令。

```
var myApp = angular.module("myApp", ['initFromForm']);

angular.module('initFromForm', [])
  .directive("initFromForm", function ($parse) {
    return {
      link: function (scope, element, attrs) {
        var attr = attrs.initFromForm || attrs.ngModel || element.attrs('name'),
        val = attrs.value;
        if (attrs.type === "number") {val = parseInt(val)}
        $parse(attr).assign(scope, val);
      }
    };
  }); 
```

你可以看到我已经定义了几个后备来获取模型名称。您可以将此指令与 ngModel 指令结合使用，或者如果您愿意，可以绑定到 $scope 以外的其他东西。

像这样使用它：

```
<input name="test" ng-model="toaster.test" value="hello" init-from-form />
{{toaster.test}} 
```

请注意，这也适用于 textareas，并选择下拉菜单。

```
<textarea name="test" ng-model="toaster.test" init-from-form>hello</textarea>
{{toaster.test}} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-06-21T23:13:53.490

**更新：**我最初的回答涉及让控制器包含可识别 DOM 的代码，这打破了 Angular 的约定以支持 HTML。@dmackerman 在对我的回答的评论中提到了指令，直到现在我才完全错过了这一点。使用该输入，这是在不破坏 Angular**或**HTML 约定的情况下执行此操作的*正确方法：*

 *** * *

还有一种方法可以同时获得两者 - 获取元素的值并使用它来更新指令中的模型：

```
<div ng-controller="Main">
    <input type="text" id="rootFolder" ng-model="rootFolders" disabled="disabled" value="Bob" size="40" />
</div> 
```

接着：

```
app.directive('input', ['$parse', function ($parse) {
    return {
        restrict: 'E',
        require: '?ngModel',
        link: function (scope, element, attrs) {
            if(attrs.value) {
                $parse(attrs.ngModel).assign(scope, attrs.value);
            }
        }
    };
}]); 
```

`value`您当然可以在将模型设置为其值之前修改上述指令以对属性执行更多操作，包括`$parse(attrs.value, scope)`将`value`属性视为 Angular 表达式（尽管我个人可能会为此使用不同的 [custom] 属性，因此标准的 HTML 属性始终被视为常量）。

此外，在[使数据模板化可用于 ng-model](https://stackoverflow.com/questions/14489547)中也有一个类似的问题，这可能也很有趣。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-07-24T22:02:08.707

如果您使用 AngularJs ngModel 指令，请记住`value`属性的值**不会绑定在 ngModel 字段上**。您必须自己初始化它，最好的方法是

```
<input type="text"
       id="rootFolder"
       ng-init="rootFolders = 'Bob'"
       ng-model="rootFolders"
       disabled="disabled"
       value="Bob"
       size="40"/> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-10-28T04:26:00.697

这是对早期答案的轻微修改......

不需要 $parse

```
angular.directive('input', [function () {
  'use strict';

  var directiveDefinitionObject = {
    restrict: 'E',
    require: '?ngModel',
    link: function postLink(scope, iElement, iAttrs, ngModelController) {
      if (iAttrs.value && ngModelController) {
        ngModelController.$setViewValue(iAttrs.value);
      }
    }
  };

  return directiveDefinitionObject;
}]); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-05T06:26:52.920

嗨，您可以尝试以下方法初始化模型。

在这里你可以用两种方式初始化文本框的 ng-model

**- 使用 ng-init**

**- 在 js 中使用 $scope**

```
<!doctype html>
 <html >
 <head>
        <title>Angular js initalize with ng-init and scope</title>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
</head>
<body ng-app="app" >
    <h3>Initialize value with ng-init</h3>
    <!-- Initlialize model values with ng-init -->
    <div ng-init="user={fullname:'Bhaskar Bhatt',email:'bhatt.bhaskar88@gmail.com',address:'Ahmedabad'};">
        Name : <input type="text" ng-model="user.fullname" /><br/>
        Email : <input type="text" ng-model="user.email" /><br/>
        Address:<input type="text" ng-model="user.address" /><br/>

    </div>  
    <!-- initialize with js controller scope -->
    <h3>Initialize with js controller</h3>

    <div  ng-controller="alpha">
        Age:<input type="text" name="age" ng-model="user.age" /><br/>
        Experience : <input type="text" name="experience" ng-model="user.exp" /><br/>
        Skills : <input type="text" name="skills" ng-model="user.skills" /><br/>
    </div>  

</body> 
<script type="text/javascript">
        angular.module("app",[])
        .controller("alpha",function($scope){
            $scope.user={};
            $scope.user.age=27;
            $scope.user.exp="4+ years";
            $scope.user.skills="Php,javascript,Jquery,Ajax,Mysql";
        });

     </script>
 </html> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-31T14:05:37.720

我有类似的问题。我无法`value="something"`用于显示和编辑。我必须在`<input>`声明的模型中使用以下命令。

```
[(ngModel)]=userDataToPass.pinCode 
```

我有对象中的数据列表`userDataToPass`，我需要显示和编辑的项目是`pinCode`.

同样，我参考了[这个 YouTube 视频](https://www.youtube.com/watch?v=6T1TF7lgVSA)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-31T20:22:11.947

问题是您必须将 ng-model 设置为要设置 ng-value/value 的父元素。正如 Angular 所说：

> 主要用在 input[radio] 和 option 元素上，这样当元素被选中时，该元素（或其选择的父元素）的 ngModel 被设置为绑定值。

例如：这是一个执行的代码：

```
<div class="col-xs-12 select-checkbox" >
<label style="width: 18em;" ng-model="vm.settingsObj.MarketPeers">
  <input name="radioClick" type="radio"  ng-click="vm.setPeerGrp('market');" 
         ng-value="vm.settingsObj.MarketPeers" 
         style="position:absolute;margin-left: 9px;">
  <div style="margin-left: 35px;color: #717171e8;border-bottom: 0.5px solid #e2e2e2;padding-bottom: 2%;">Hello World</div>
</label>
</div> 
```

注意：在上述情况下，我已经收到了对 ng-model 和值的 JSON 响应，我只是将另一个属性添加到 JS 对象作为“MarketPeers”。所以模型和价值可能取决于需要，但我认为这个过程会有所帮助，同时拥有 ng-model 和 value 但不在同一个元素上。**

# c++ - 更改 Nvidia 显卡上的显示输出 (NVCPL.DLL)

> ID：10610286
> 
> 赞同：2
> 
> 时间：2012-05-15T23:39:11.313
> 
> 标签：c++, dll, graphics, nvidia

我正在尝试以编程方式更改我的显卡设置。我有 nvidia 570 GTX 显卡连接到两台电脑显示器和一台液晶电视。问题是我的 570 GTX 一次只能输出两个显示器，所以我经常从控制面板中在显示器和电视之间切换。我想制作一个自动化这个过程的程序。
我打算使用 Nvidia 的 api 来更改显卡设置：

[http://developer.download.nvidia.com/SDK/9.5/Samples/DEMOS/common/src/NvCpl/docs/NVControlPanel_API.pdf](http://developer.download.nvidia.com/SDK/9.5/Samples/DEMOS/common/src/NvCpl/docs/NVControlPanel_API.pdf)

问题是我不知道如何在 C++ 中做到这一点；如何导入和实现 dll 调用，使用哪个函数等。

有人想帮我快速破解一下吗？任何帮助将非常感激。

# c# - 对 DataTable/DataView 执行操作

> ID：10610290
> 
> 赞同：3
> 
> 时间：2012-05-15T23:39:53.807
> 
> 标签：c#, datatable, dataset, system.data.sqlite, amcharts

`System.Data.SQLite`我有一个由（使用）填充的类型化数据集`SQLiteDataAdapter`。
我正在尝试使用其中一张表作为 WPF 系列 amCharts 折线图的来源。
我需要将其中的两列 (`[Year]`和`CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName([Month])`) 组合起来用作`SeriesItem`名称。
我一直在阅读 MSDN 上的文档几个小时，但没有成功。建议？

# android - 如何使用 OnItemClickListener 根据单击的项目启动新意图？

> ID：10610291
> 
> 赞同：3
> 
> 时间：2012-05-15T23:39:54.637
> 
> 标签：android, string, listview, listviewitem, onitemclicklistener

我希望能够使用 Intent 类开始一个新活动。我知道如何使用这些代码行开始活动：

```
Intent myIntent = new Intent(v.getContext(), bylocationactivity.class);

startActivityForResult(myIntent, 0); 
```

但是我如何指定单击了哪个项目？所以当我点击“按位置”时，我可以启动 bylocationactivity.class 等等？

```
public class bonesactivity extends Activity 
{
    public void onCreate(Bundle savedInstanceState) 
    {
        ListView boneslist;
        String categorieslist[]={"Alphabetically","By Location","Specialty Tests"};
        super.onCreate(savedInstanceState);
        setContentView(R.layout.boneslayout);
        boneslist=(ListView)findViewById(R.id.boneslayout);
        boneslist.setAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1 , categorieslist));
        boneslist.setOnItemClickListener(new OnItemClickListener() 
        {
            public void onItemClick(AdapterView<?> parent, View view,int position, long id)
            {

            }
        });
    }      
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:57:59.517

```
@Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    Intent intent = null;
    switch(position) {
    case 1:
            intent = new Intent(getApplicationContext(), Activity2.class);
            startActivity(intent);
    break;
    case 2:
           intent = new Intent(getApplicationContext(), Activity3.class);
           startActivity(intent);
           break;
    default:
    }
    } 
```

});

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T05:49:07.247

演示多个按钮的单个 OnItemClick 列表器的代码

您可以将其用于您所说的物品！

// 所有 6 个按钮的 On Click Listener

```
@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    //int clickedButtonIs;

    if (v == button1)
    {
        // call intent 1;
    }
    else if (v == button2)
    {
        // call intent 2;
    }
    else if (v == button3)
    {
        // call intent 3;
    }
    else if (v == button4)
    {
        // call intent 4;
    }
    else if (v == button5)
    {
        // call intent 5;
    }
    else if (v == button6)
    {
        // call intent 6;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:52:01.043

您可以使用`position`参数 in`onItemClick`从 categoriesList 数组中获取所需的字符串。所以：

```
 String category = categoriesList.get(position); 
```

不过，可能必须使 categoriesList 成为成员变量。

# linux - 决定设备打开的模式

> ID：10610294
> 
> 赞同：0
> 
> 时间：2012-05-15T23:40:23.587
> 
> 标签：linux, device-driver

这是我的设备驱动程序中 open 方法的原型：

```
static int myd_open(struct inode *inode, struct file *filp) 
```

在我的示例代码中，设备使用参数“rw”打开，如下所示：

```
FILE* fd = fopen("/dev/dene","rw"); 
```

所以，在`open`方法上，我想决定开场白。换句话说，我想在“w”、“r”和“rw”模式上做不同的事情。

# javascript - 在本地存储中查找元素列表

> ID：10610296
> 
> 赞同：0
> 
> 时间：2012-05-15T23:40:44.963
> 
> 标签：javascript, local-storage

我在本地存储中存储表示对象的 json 字符串。我写这样的东西：

```
window.localStorage.setItem('ItemID' + TheItemID, TheItemInJson); 
```

现在我需要知道仓库中有哪些物品。有什么好方法可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:46:54.803

您想使用此代码：

```
for(var i=0, len=localStorage.length; i<len; i++) {
    var key = localStorage.key(i);
    var value = localStorage[key];
    console.log(key + " => " + value);
} 
```

# svg - 如何将 SVG 元素包装到 svg 元素中？

> ID：10610297
> 
> 赞同：2
> 
> 时间：2012-05-15T23:41:07.950
> 
> 标签：svg

我的 SVG 图形超出了窗口，并且没有滚动条。

那是因为 svg 元素是窗口的大小，而不是实际 svg 内容的大小。

是否可以在 svg 元素上设置一些属性以便包装内容（如 ag 元素）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T09:00:06.887

您可以在根 svg 元素上设置[“viewBox”属性](http://www.w3.org/TR/SVG11/coords.html#ViewBoxAttribute)，以便它完全包含您的 svg，例如：

```
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10020 30">
    <line x1="10" x2="10000" y1="10" y2="10" stroke-linecap="round" stroke="#1c94c4" stroke-width="3" />
</svg> 
```

但也许你想要滚动条？在这种情况下，您可以将 CSS 宽度（或高度）设置为合适的值，例如：

```
<svg xmlns="http://www.w3.org/2000/svg" style="width:10020px; height: 32px">
    <line x1="10" x2="10000" y1="10" y2="10" stroke-linecap="round" stroke="#1c94c4" stroke-width="3" />
</svg> 
```

# javascript - 为字符串中的匹配添加前缀

> ID：10610298
> 
> 赞同：2
> 
> 时间：2012-05-15T23:41:08.970
> 
> 标签：javascript, regex

我让我们说这个字符串：

**“A = Beta * C / Delta + 2”；**

现在我想用相同的名称替换所有变量（A、Beta、C、Delta），但前面有一个前缀，比如“x”。所以它会变成：

**“xA = xBeta * xC / xDelta + 2”；**

也许我的头只是累了，但我想不出解决办法。

要查找匹配项，很容易，只需针对**/[a-zA-Z]+/**正则表达式进行测试，但是我应该如何在 javascript 中获取我找到的内容并轻松替换它而不使用多个函数调用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:45:29.660

试试这个：

```
var str = "A = Beta * C / Delta + 2";
var prefixed = str.replace(/([a-zA-Z]+)/g, 'x$1'); 
```

结果是：

```
xA = xBeta * xC / xDelta + 2 
```

# database - 使用 get_or_create 的 Django 配置文件 ID 可能不为空，它与数据库有什么关系？

> ID：10610306
> 
> 赞同：0
> 
> 时间：2012-05-15T23:41:43.993
> 
> 标签：database, django, sqlite, profile

我遵循了[Django 用户配置文件中的一些步骤 - 简单而强大](http://www.turnkeylinux.org/blog/django-profile)。

不完全一样，因为我正在开发这个想法。从这个站点我特别使用了这一行：

> User.profile = property(lambda u: UserProfile.objects.get_or_create(user=u)[0])

我在创建对象时总是收到一条错误消息，通常“XX”可能不为空。我通过使用模型和（在我目前的情况下）sqliteman 解决了部分问题。直到我在 id 上收到相同的消息：“xxx.id 可能不为空”。

在网上，我找到了一个可能的解决方案的描述，其中涉及重置数据库，我不太乐意这样做。特别是因为对于不同的解决方案，它可能涉及应用程序数据库的重置。

但是因为 UserProfile 模型有点新而且到目前为止是空的，所以我直接在 DB 上使用它并手工制作了表并要求 syncdb 重建它。（有点冒险的想法）。

现在这是 sqlite 转储的差异：

```
294,298c290,294
< CREATE TABLE "myt_userdata" (
<     "id" integer NOT NULL PRIMARY KEY,
<     "user_id" integer NOT NULL UNIQUE REFERENCES "auth_user" ("id"),
<     "url" varchar(200),
<     "birthday" datetime
---
> CREATE TABLE myt_userdata (
>     "id" INTEGER NOT NULL,
>     "user_id" INTEGER NOT NULL,
>     "url" VARCHAR(200),
>     "birthday" DATETIME 
```

请注意，这两个版本都是由 django 生成的。">" 版本是用一个简单的模型定义生成的，它确实通过以下方式与用户表连接：

```
user = models.ForeignKey(User, unique=True) 
```

新的“<”版本包含更多信息并且正在运行。

我的问题：

为什么 Django 抱怨 myt_userdata.id 可能不为空？

附属问题：

Django 是否尝试与下划线数据库结构相关联，如何？（例如 not NULL 消息来自模型还是来自数据库？）

附加问题：

我一直不太愿意使用南：太复杂，额外的模块，我可能需要在开发和生产之间关心，如果我想切换数据库引擎，可能不是那么容易（我只在开发阶段使用 sqlite，我计划移动到mysql）。

在这种情况下，南方可能会奏效。它会起作用吗？你会建议使用它吗？

编辑 FIY：

这是我的最后一个模型（工作模型）：

```
class UserData(models.Model):

    user = models.ForeignKey(User, unique=True)

    url = models.URLField("Website", blank=True, null=True)

    birthday = models.DateTimeField('Birthday', blank=True, null=True)

    def __unicode__(self):
        return self.user.username

User.profile = property(lambda u: UserData.objects.get_or_create(user=u,defaults={'birthday': '1970-01-01 00:00:00'})[0]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:03:38.427

> 为什么 Django 抱怨 myt_userdata.id 可能不为空？

因为`id`不是主键，但不会自动填充。此外，您没有在模型创建时提供它，因此 DB 不知道该怎么做。

> Django 是否尝试与下划线数据库结构相关联，如何？（例如 not NULL 消息来自模型还是来自数据库？）

这是来自 DB 的错误，而不是来自 Django。

您可以使用[sql 命令](https://docs.djangoproject.com/en/1.4/ref/django-admin/#sql-appname-appname)来了解在 syncdb 上究竟执行了什么。上面的变体似乎是由正确的 Django 模型制成的正确的表定义，我不知道你是如何得到下面的变体的。写一个正确清晰的模型，你就会得到正确的工作表方案`syncdb`

# c++ - 我是在用这个简单的方法调用转发类重新发明轮子吗？

> ID：10610307
> 
> 赞同：5
> 
> 时间：2012-05-15T23:41:47.920
> 
> 标签：c++, templates, stl, functor, boost-bind

我刚刚发现自己正在创建一个类

```
template <typename T> struct invoker {
  void operator()(T& it) const {it();}
}; 
```

所以我可以将 an 传递`invoker<foo>`给想要`invoker<foo>::operator()(foo&)`用不同`foo`实例重复调用它的东西（它不在我的控制之下），以让它将这些调用转发给`foo`'s`foo::operator()()`方法。

我知道它只有几行，但这似乎是 STL 的函数或`boost::bind`某种方式可能已经提供的那种东西。除了我看不到诀窍，如果有的话。（我敢肯定我不是第一个使用这种东西的人；它有名字吗？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:53:02.983

好吧，您也可以使用`std::bind`来`boost::bind`实现相同的行为：

```
#include <string>
#include <iostream>
#include <functional>

struct foo {
    void operator()() {
        std::cout << "Hallo, im at addr: " << std::hex << this << std::endl;
    }
};

int main() {
    std::function<void(foo*)> fun = std::bind(&foo::operator(), std::placeholders::_1);
    foo f1, f2;
    fun(&f1);
    fun(&f2);
} 
```

输出：

```
Hallo, im at addr: 0xbffc396a
Hallo, im at addr: 0xbffc3969 
```

如果您对参数类型使用模板类，则无需重新发明轮子即可拥有相同的行为。

**编辑**：正如 Crazy Eddie 指出的那样，您可以使用`boost::mem_fn`or `std::mem_fn`：

```
std::function<void(foo*)> fun = std::mem_fn(&foo::operator()); 
```

而不是`bind`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T00:19:25.967

是的，你在重新发明轮子。std::mem_fun_ref 做你想做的事。

```
std::vector<foo> foos;

...

std::for_each(foos.begin(), foos.end(), std::mem_fun_ref(&foo::operator())); 
```

或者：

```
std::vector<foo*> foos;

...

std::for_each(foos.begin(), foos.end(), std::mem_fun(&foo::operator())); 
```

boost::mem_fn 的一大好处是不必纠结你的参数是否是 ptr。

任何比这更复杂的东西，你开始在使用 C++03 绑定器时遇到麻烦，需要像 boost.bind 这样更有表现力的东西。

# algorithm - 棘手的加密算法设计

> ID：10610310
> 
> 赞同：5
> 
> 时间：2012-05-15T23:42:14.330
> 
> 标签：algorithm, math, encryption, binary, logic

> Bob 和 Alice 各有一个他们想要保密的字符串。他们每个人都想知道他们的两个位串的逻辑与是什么而不告诉对方或其他任何人他们的实际位串......他们怎么能这样做？请记住，即使他们都持有两个位字符串的 AND，他们仍然不能准确计算对方的字符串（当然，除非他们的一个字符串全为 1）。

我知道我以前在某种关键系统/投票系统中看到过类似的东西，但我不记得细节了。它必须像制作一个私人随机密钥，异或它并以某种方式使用它......但我无法弄清楚细节。那里有聪明的加密人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:48:03.507

我认为您正在寻找**[同态加密](http://en.wikipedia.org/wiki/Homomorphic_encryption)**系统，其中可以对加密值进行计算，而无需暴露这些加密值是什么。这包含了一组比简单地计算按位与更普遍的问题。

希望这可以帮助！

# ssh - 在“同一”时间使用 2 个公钥/私钥对

> ID：10610313
> 
> 赞同：0
> 
> 时间：2012-05-15T23:43:00.273
> 
> 标签：ssh, rsa, public-key-encryption

所以我有 2 个公钥/私钥对（id_rsa 和 id_rsa.pub - 其中一个位于我当前创建的“key_backup”文件夹中），一个用于 GitHub，一个用于无密码 SSH 进入集群。我环顾谷歌，只能找到有关如何同时使用两个公钥的指南。私钥也一样吗？

如何使用 GitHub 维护身份验证，同时还能够使用我的集群维护无密码登录？

谢谢！-kstruct

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:45:20.853

您可以同时使用多个私钥，方法是确保您的 ssh 密钥代理知道这两个密钥：`ssh-add id_rsa1 id_rsa2`在 Mac OS 或 Linux 上，或`Pageant`在 Windows 上添加两者。

另一种选择是创建单独`Host`的条目，[`~/.ssh/config`](http://linux.die.net/man/5/ssh_config)将您的两个键中的每一个指向它们的预期用途。

# javascript - Javascript getter 是如何工作的？

> ID：10610320
> 
> 赞同：1
> 
> 时间：2012-05-15T23:44:28.833
> 
> 标签：javascript, oop

我在我的应用程序中使用 javascript getter 很长时间了，并且一直认为

他们像这样工作：

```
myobject.prototype.__defineGetter__('something', function () {
   return DoSomeHeavyComputation() // this will be executed only once and will be saved
})

new myobject()
myobject.something // the computation will be done here
myobject.something // no computation will be done here. 
```

我刚刚发现每次都完成了计算...

是否有资源或其他东西可以显示它们实际上是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:58:11.563

如果您在对象的属性上定义 getter，则每次尝试访问该属性时都会调用它。

```
obj.prop; 
```

如果要缓存结果，则应手动进行。

同样，如果您在对象的属性上定义 setter，每次设置属性时都会调用它。

```
obj.prop = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:48:39.983

这篇文章很棒，真正深入到原型设计和对象实例化的本质：http: [//dmitrysoshnikov.com/ecmascript/chapter-7-2-oop-ecmascript-implementation/](http://dmitrysoshnikov.com/ecmascript/chapter-7-2-oop-ecmascript-implementation/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T23:37:48.183

我认为您正在寻找类似记忆的东西。

[http://documentcloud.github.com/underscore/#memoize](http://documentcloud.github.com/underscore/#memoize)

# c# - 将多个项目保存到独立存储时遇到问题

> ID：10610321
> 
> 赞同：0
> 
> 时间：2012-05-15T23:44:48.957
> 
> 标签：c#, windows-phone-7

我有一个noteapp，两页：

1.  MainPage.xaml — 创建笔记；
2.  NoteList.xaml — 笔记列表。

笔记通过IsolatedStorage保存，出现在NoteList.xaml(listbox)中，但没有保存同名笔记，如何解决？我需要能够添加具有相同名称（但内容不同）的注释。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T03:27:16.727

您是否使用注释名称作为文件名？如果是这样...不要那样做。用唯一的名称保存每个文件。有无数种方法可以做到这一点。您可以使用 GUID 或时间戳，也可以将时间戳附加到文件名的末尾。如果您愿意，您可以将所有笔记存储在一个单一格式的文件中——也许是 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T05:17:35.700

我需要给IsolatedStorage 写笔记。我所做的就是将他们归档。`IsolatedStorageFile`我写下笔记的日期，然后记下。从列表框中，我将它们存储到两个数组中。然后在退出应用程序之前，将它们写入文件。

```
 try
            {
                using (IsolatedStorageFile storagefile = IsolatedStorageFile.GetUserStoreForApplication())
                {
                    if (storagefile.FileExists("NotesFile"))
                    {
                        using (IsolatedStorageFileStream fileStream = storagefile.OpenFile("NotesFile", FileMode.Open, FileAccess.ReadWrite))
                        {
                            StreamWriter writer = new StreamWriter(fileStream);

                            for (int i = 0; i < m_noteCount; i++)
                            {
                                //writer.Write(m_arrNoteDate[i].ToShortDateString());
                                writer.Write(m_arrNoteDate[i].ToString("d", CultureInfo.InvariantCulture));
                                writer.Write(" ");
                                writer.Write(m_arrNoteString[i]);
                                writer.WriteLine("~`");
                            }
                            writer.Close();
                        }
                    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T04:48:52.610

您需要的是一种无需使用即可唯一识别每个音符的方法：

一个。笔记的名称

湾。笔记的内容

虽然现在使用时间戳可能对您的应用程序有意义（因为用户可能无法同时创建两个不同的笔记），但如果您想实现说......服务器，使用时间戳来识别每个笔记可能会导致问题应用程序的侧组件。如果在您的应用程序的第 23 版（前几个月显然销售数百万）中，您决定允许用户在便笺上进行协作，并且在您的应用程序的两个实例之间共享一个便笺，它们恰好是在 EXACT 中创建的同时？你会有问题。

为应用程序中的每个 Note 找到唯一标识符的合理解决方案是使用该[`Guid.NewGuid`](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)方法。当用户决定“保存”笔记时（或者如果您的应用程序在创建笔记时保存笔记，或者在某个设定的时间间隔以允许即时“草稿”），您应该这样做。

既然我们已经充分确定了一种唯一标识您的应用程序将允许用户创建的每个 Note 的方法，我们需要考虑应该如何存储这些数据。

一个很好的方法是通过使用[`XmlSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer%28v=vs.95%29.aspx)，或者更好的是使用第三方库[Json.Net](http://json.codeplex.com/)。但为了简单起见，我建议做一些更简单的事情。

一个更简单的方法（使用好的 ole' 纯文本）如下：

1：`{Note.Name}`
2：`{Guid.ToString()}`
3：`{Note.Contents}`
4：`{Some delimiter}`

当您从 IsolatedStorage 读取文件时，您将逐行读取文件，将文件开头和文件末尾之间的每一行“块”视为`{Some delimiter}`一个“注释”的数据。

请记住，这种格式有一些限制。主要是，您必须防止用户让他们的笔记内容的最后一部分等于`{Some delimiter}`（您可以随意定义 btw）。为此，使用用户不太可能输入的字符串可能会有所帮助，例如“##&&ENDOFNOTE&&##”无论用户输入的可能性有多大，您都需要检查以使在保存到 IsolatedStorage 之前，请确保 Note 的末尾不包含此字符串，因为它会破坏您的文件格式。

如果您想要一个有效的*简单*解决方案，请使用上述方法。如果您想要一个可扩展的*良好*解决方案，请使用 JSON 或 XML 并找出对您有意义的文件格式。我强烈建议您研究 JSON，它的价值远远超出这种孤立的场景。

# ruby-on-rails - Rails 指南 - 第 11 步 - 多模型表单 - MassAssignmentSecurity 错误

> ID：10610323
> 
> 赞同：4
> 
> 时间：2012-05-15T23:45:10.043
> 
> 标签：ruby-on-rails, multi-model-forms

我非常仔细地遵循 RailsGuide，它运行良好，直到第 11 步。通过 MultiModel 表单添加标签。添加代码后，我收到此错误：

ActiveModel::MassAssignmentSecurity::PostsController#update 中的错误无法批量分配受保护的属性：tags_attributes

应用程序跟踪：app/controllers/posts_controller.rb:65:in `block in update' app/controllers/posts_controller.rb:64:in`update'

我已经备份并重新开始了几次，以确保这不是用户错误。有人可以帮我完成这一步。我快完成了！然后我可以继续阅读 Hartl 的教程。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:04:11.057

这不是你的错！

Rails 3.2.3 默认的已部署入门指南尚未更新

```
# in config/application.rb:

config.active_record.whitelist_attributes = true 
```

解决方法是将其添加到您的 Post 模型中：

```
# in app/models/post.rb

class Post < ActiveRecord::Base
  attr_accessible :tags_attributes
  ... 
```

顺便说一句，这整个部分已从指南的源代码中删除，您可以在[https://github.com/rails/rails/blob/master/guides/source/getting_started.textile](https://github.com/rails/rails/blob/master/guides/source/getting_started.textile)找到它。

# git - 删除所有本地 git 分支

> ID：10610327
> 
> 赞同：503
> 
> 时间：2012-05-15T23:45:47.783
> 
> 标签：git, bash, ubuntu, version-control, grep

我遵循一个开发过程，为每个新功能或故事卡创建一个新的本地分支。完成后，我将分支合并到 master 然后推送。

由于懒惰或健忘，随着时间的推移往往会发生的情况是，我最终得到了大量本地分支，其中一些（例如尖峰）可能尚未合并。

我知道如何列出所有本地分支，也知道如何删除单个分支，但我想知道是否有 git 命令允许我删除所有本地分支？

下面是`git branch --merged`命令的输出。

```
user@machine:~/projects/application[master]$ git branch --merged
  STORY-123-Short-Description
  STORY-456-Another-Description
  STORY-789-Blah-Blah
* master 
```

所有尝试删除列出的分支`grep -v \*`（根据下面的答案）都会导致错误：

```
error: branch 'STORY-123-Short-Description' not found.
error: branch 'STORY-456-Another-Description' not found.
error: branch 'STORY-789-Blah-Blah' not found. 
```

我正在使用：
git 1.7.4.1
ubuntu 10.04
GNU bash，版本 4.1.5(1)-release
GNU grep 2.5.4

* * *

## 回答 #1

> 赞同：605
> 
> 时间：2012-05-16T00:43:24.020

'git branch -d' 子命令可以删除多个分支。因此，简化@sblom 的答案，但添加一个关键的 xargs：

```
git branch -D `git branch --merged | grep -v \* | xargs` 
```

或者，进一步简化为：

```
git branch --merged | grep -v \* | xargs git branch -D 
```

重要的是，正如@AndrewC 所指出的，`git branch`不鼓励使用 for scripting。为了避免它使用类似的东西：

```
git for-each-ref --format '%(refname:short)' refs/heads | grep -v "master\|main" | xargs git branch -D 
```

删除需谨慎！

```
$ mkdir br
$ cd br; git init
Initialized empty Git repository in /Users/ebg/test/br/.git/
$ touch README; git add README; git commit -m 'First commit'
[master (root-commit) 1d738b5] First commit
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 README
$ git branch Story-123-a
$ git branch Story-123-b
$ git branch Story-123-c
$ git branch --merged
  Story-123-a
  Story-123-b
  Story-123-c
* master
$ git branch --merged | grep -v \* | xargs
Story-123-a Story-123-b Story-123-c
$ git branch --merged | grep -v \* | xargs git branch -D
Deleted branch Story-123-a (was 1d738b5).
Deleted branch Story-123-b (was 1d738b5).
Deleted branch Story-123-c (was 1d738b5). 
```

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2013-09-02T10:55:13.687

[我在 github 上对此问题的评论中](https://github.com/arc90/git-sweep/issues/5)找到了更好的方法：

```
git branch --merged master --no-color | grep -v "master\|stable\|main" | xargs git branch -d 
```

**编辑**：添加了无颜色选项并排除了稳定分支（根据需要添加其他分支）

* * *

## 回答 #3

> 赞同：179
> 
> 时间：2014-10-01T23:20:19.773

删除所有分支但保留“develop”和“master”等其他分支的更简单方法如下：

```
git branch | grep -v "develop" | grep -v "master" | xargs git branch -D 
```

很有用 ！

* * *

## 回答 #4

> 赞同：155
> 
> 时间：2014-10-02T00:01:31.843

`git branch`不建议解析 的输出，对于 Stack Overflow 上的未来读者来说，这也不是一个好的答案。

1.  `git branch`就是所谓的瓷器命令。Porcelain 命令不是为机器解析而设计的，输出可能会在不同版本的 Git 之间发生变化。
2.  有一些用户配置选项会以`git branch`难以解析的方式更改输出（例如，着色）。如果用户已设置，那么您将在输出中获得控制代码，如果您尝试将其通过管道传递到另一个命令`color.branch`中，这将导致。`error: branch 'foo' not found.`您可以使用`--no-color`标志绕过它 to `git branch`，但谁知道其他用户配置可能会破坏事情。
3.  `git branch`可能会做其他令人讨厌的解析操作，例如在当前签出的分支旁边放一个星号

git的维护者对围绕输出编写脚本[有这样的看法](http://git-blame.blogspot.com/2013/06/checking-current-branch-programatically.html)`git branch`

> 为了找出当前分支是什么，随意/粗心的用户可能已经围绕 git 分支编写了脚本，这是错误的。我们强烈反对在脚本中使用任何 Porcelain 命令，包括 git 分支，因为命令的输出可能会更改以帮助人类消费用例。

建议手动编辑目录中的`.git`文件（如 .git/refs/heads）的答案同样有问题（参考可能在 .git/packed-refs 中，或者 Git 将来可能会更改其内部布局）。

Git 提供了`for-each-ref`检索分支列表的命令。

Git 2.7.X 将引入该`--merged`选项，因此您可以执行以下操作来查找和删除合并到的所有分支`HEAD`

```
for mergedBranch in $(git for-each-ref --format '%(refname:short)' --merged HEAD refs/heads/)
do
    git branch -d ${mergedBranch}
done 
```

Git 2.6.X 及更早版本，您将需要列出所有本地分支，然后单独测试它们以查看它们是否已合并（这将明显变慢并且稍微复杂一些）。

```
for branch in $(git for-each-ref --format '%(refname:short)' refs/heads/)
do
    git merge-base --is-ancestor ${branch} HEAD && git branch -d ${branch}
done 
```

* * *

## 回答 #5

> 赞同：90
> 
> 时间：2019-09-27T17:52:34.363

尝试以下 shell 命令：

```
git branch | grep -v "master" | xargs git branch -D 
```

解释：

*   `git branch | grep -v "master"`通过命令获取所有分支（master除外）
*   `xargs`使用命令选择每个分支
*   删除分支`xargs git branch -D`

* * *

## 回答 #6

> 赞同：67
> 
> 时间：2012-05-15T23:50:03.457

要删除除您当前已签出的分支之外的每个分支：

```
for b in `git branch --merged | grep -v \*`; do git branch -D $b; done 
```

我建议更改`git branch -D $b`为`echo $b`前几次以确保它删除您想要的分支。

* * *

## 回答 #7

> 赞同：66
> 
> 时间：2018-08-24T14:08:20.540

以下命令将删除除 master 分支之外的所有本地分支。

```
git branch | grep -v "master" | xargs git branch -D 
```

上面的命令

1.  列出所有分支
2.  从列表中忽略主分支并获取其余分支
3.  删除分支

* * *

## 回答 #8

> 赞同：42
> 
> 时间：2012-05-16T02:04:55.130

请注意，我会升级到 git 1.7.10。您可能会在这里得到不适用于您的版本的答案。我的猜测是您必须在分支名称前加上`refs/heads/`.

**注意，仅当您制作了工作文件夹和 .git 目录的副本时，才继续执行以下操作。**

有时我只是继续删除我不想直接从中删除的分支`.git/refs/heads`。所有这些分支都是文本文件，其中包含它们指向的提交的 40 个字符的 sha-1。`.git/config`如果您为其中任何一个设置了特定的跟踪，那么您将拥有无关的信息。您也可以手动删除这些条目。

* * *

## 回答 #9

> 赞同：40
> 
> 时间：2019-04-05T07:54:30.540

删除**linux 中**的所有本地分支，除了你所在的分支

```
// hard delete

git branch -D $(git branch) 
```

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2013-08-01T22:09:39.117

我发现只使用文本编辑器和 shell 更容易。

1.  键入`git checkout <TAB>`外壳。将显示所有本地分支机构。
2.  将它们复制到文本编辑器，删除您需要保留的那些。
3.  用空格替换换行符。（在 SublimeText 中非常简单。）
4.  打开外壳，输入`git branch -D <PASTE THE BRANCHES NAMES HERE>`.

而已。

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2020-12-16T16:19:27.967

如果要删除所有本地分支，请使用以下简单命令：

```
git branch -D `git branch` 
```

注意：这将删除除当前签出分支之外的所有分支

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2019-02-08T01:06:52.037

在 Windows 命令行中，使用以下命令删除除当前签出分支之外的所有内容：

```
for /f "tokens=*" %f in ('git branch ^| find /v "*"') do git branch -D %f 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2013-07-12T07:23:03.187

我有类似的情况，最近发现以下命令很有用。

```
git branch -D `git branch | awk '{ if ($0 !~ /<Branch_You_Want_to_Keep>/) printf "%s", $0 }'` 
```

如果你想保留多个分支，那么

```
git branch -D `git branch | awk '{ if ($0 !~ /<Branch_You_Want_to_Keep1>|<Branch_You_Want_to_Keep2>/) printf "%s", $0 }'` 
```

希望这可以帮助某人。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2021-02-25T22:24:34.347

这是适用于在 Windows 机器上运行的任何人的 Powershell 解决方案

```
git checkout master # by being on the master branch, you won't be able to delete it
foreach($branch in (git branch))
{
    git branch -D $branch.Trim()
} 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2021-02-10T06:36:04.080

如果你使用 NodeJS，我写了[这个命令](https://github.com/rudyhuynh/git-clear-branch)：

```
npx git-clear-branch 
```

该命令清除除 master 和 current 分支之外的所有本地分支。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2012-05-16T02:34:55.997

如果您不需要通过 Git 本身，您也可以手动或以编程方式删除**.git/refs/heads下的头。**以下内容应在 Bash 下进行最少的调整：

```
shopt -s extglob
rm -rf .git/refs/heads/!(master) 
```

这将删除除您的主分支之外的每个本地分支。由于您的上游分支存储在**.git/refs/remotes**下，它们将保持不变。

如果您不使用 Bash，或者想一次递归大量 Git 存储库，您可以使用 GNU find 执行类似的操作：

```
find . \
    -path remotes -path logs -prune -o \
    -wholename \*.git/refs/heads/\* \! -name master -print0 |
xargs -0 rm -rf 
```

find 解决方案可能更便携，但修剪路径和文件名很棘手，并且可能更容易出错。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2014-12-29T10:23:27.623

没有一个答案完全满足我的需求，所以我们开始吧：

```
git branch --merged | grep -E "(feature|bugfix|hotfix)/" | xargs git branch -D && git remote prune origin 
```

这将删除所有合并并以`feature/`,`bugfix/`或开头的本地分支`hotfix/`。之后上游遥控器`origin`被修剪（您可能必须输入密码）。

适用于 Git 1.9.5。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2018-08-08T19:41:45.140

尽管这不是命令行解决方案，但我很惊讶尚未建议使用[Git GUI 。](https://git-scm.com/downloads/guis/)

我 99% 的时间都使用命令行，但在这种情况下，它要么很慢（因此是原始问题），要么在使用一些冗长但巧妙的 shell 操作时，您不知道要删除什么。

UI 解决了这个问题，因为您可以快速检查要删除的分支，并提醒您要保留的分支，而无需为每个分支键入命令。

从 UI 转到**Branch --> Delete**并 **Ctrl+单击**要删除的分支，以便突出显示它们。如果您想确保将它们合并到一个分支中（例如`dev`），请在**“仅在合并到时删除”下将****“本地分支**”设置为`dev`。否则，将其设置为**Always**以忽略此检查。

[![GitUI：删除本地分支](../Images/d7abf03c69246c218c55d56abb760041.png)](https://i.stack.imgur.com/18HfP.png)

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2019-03-27T06:34:35.777

基于此处的多个答案的组合-如果您想**保留远程上存在的所有分支但删除其余分支**，则以下 oneliner 可以解决问题：

```
git for-each-ref --format '%(refname:short)' refs/heads | grep -Ev `git ls-remote --quiet --heads origin | awk '{print substr($2, 12)}'| paste -sd "|" -` | xargs git branch -D 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2020-12-09T06:13:06.173

如果您想保留 master、develop 和所有远程分支。删除 Github 上不再存在的所有本地分支。

```
$ git fetch --prune

$ git branch | grep -v "origin" | grep -v "develop" | grep -v "master" | xargs git branch -D 
```

1] 它将删除远程存储库中不再使用的远程引用。

2] 这将获得所有分支的列表。从列表中删除包含 master、develop 或 origin（远程分支）的分支。删除列表中的所有分支。

警告 - 这也会删除您自己的本地分支。因此，当您合并分支并在合并、删除后进行清理时，请执行此操作。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-09-05T14:41:59.077

`git branch -d [branch name]`用于本地删除

`git branch -D [branch name]`也用于本地删除，但强制删除

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2021-09-08T05:18:25.520

```
git branch -l |grep -v master | xargs git branch -D 
```

但是在乎删除分支；如果它是一个小存储库，只需删除工作区并重新克隆它！

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2021-02-23T02:47:57.823

我建议一个更温和的答案。这里的许多答案都使用`-D`强制删除，无论更改是否已合并。这是一个单一的衬里，它使具有未合并更改的分支保持不变。

```
git branch --merged | egrep -v "(^\*|master|dev)" | xargs git branch -d 
```

或者您可以尝试列出的其他示例，但只需`-D`将`-d`. 我知道 OP 询问如何删除，但在大多数用例中，它使用起来更安全`-d`。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-08-01T17:29:21.010

对于 powershell，这将起作用：

```
git branch --format '%(refname:lstrip=2)' --merged `
    | Where-Object { $_ -ne 'master' } `
    | ForEach-Object { git branch -d $_ } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-04-08T19:05:18.350

我的盒子上没有 grep 或其他 unix，但这在 VSCode 的终端上有效：

`git branch -d $(git branch).trim()`

我使用小写的 d 所以它不会删除未合并的分支。

当我这样做时我也在主人身上，所以`* master`不存在所以它没有尝试删除主人。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-05-12T00:51:45.600

## **一次删除多个本地分支**

```
# delete all local unmerged branches
git branch --no-merged | egrep -v "(^\*|master|dev)" | xargs git branch -D
# delete all local branches (merged and unmerged).
git branch | egrep -v "(^\*|master|dev)" | xargs git branch -D 
```

## **删除远程分支**

```
# Deleting non-existent tracking branches
git remote prune <remote> --dry-run
# Deleting a single remote branch
git push <remote> --delete <branch>
# Deleting many remote branches at once
git branch -r --merged | egrep -v "(^\*|master|dev)" | sed 's/origin\///' | xargs -n 1 git push origin --delete 
```

[资源](https://nickymeuleman.netlify.app/blog/delete-git-branches)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-11-07T01:02:38.610

*以下脚本删除分支。使用它并自行承担修改等风险。*

基于这个问题的其他答案，我最终为自己编写了一个快速的 bash 脚本。我称它为“gitbd”（git branch -D），但如果你使用它，你可以将它重命名为你想要的任何名称。

```
gitbd() {
if [ $# -le 1 ]
  then
    local branches_to_delete=`git for-each-ref --format '%(refname:short)' refs/heads/ | grep "$1"`
    printf "Matching branches:\n\n$branches_to_delete\n\nDelete? [Y/n] "
    read -n 1 -r # Immediately continue after getting 1 keypress
    echo # Move to a new line
    if [[ ! $REPLY == 'N' && ! $REPLY == 'n' ]]
      then
        echo $branches_to_delete | xargs git branch -D
    fi
else
  echo "This command takes one arg (match pattern) or no args (match all)"
fi
} 
```

它将提供删除与模式参数匹配的任何分支（如果传入），或者在不带参数调用时删除所有本地分支。它还会为您提供确认步骤，因为您知道，我们正在删除内容，这很好。

这有点愚蠢——如果没有与模式匹配的分支，它就不会意识到这一点。

示例输出运行：

```
$ gitbd test
Matching branches:

dummy+test1
dummy+test2
dummy+test3

Delete? [Y/n] 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-07-12T04:04:44.793

我写了一个shell脚本来删除所有本地分支，除了`develop`

```
branches=$(git branch | tr -d " *")
output=""
for branch in $branches 
do
  if [[ $branch != "develop" ]]; then
    output="$output $branch"
  fi
done
git branch -d $output 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-09-28T06:57:33.820

以上答案工作正常。这是另一种方法，当我们在本地仓库中有很多分支并且我们必须删除许多分支，除了少数位于本地机器中的分支。

首先`git branch`将列出所有本地分支机构。

通过运行 unix 命令将分支名称列转换为文件中的单行
`git branch > sample.txt`
这会将其保存在**sample.txt**文件中。
`awk 'BEGIN { ORS = " " } { print }' sample.txt`
并在 shell 中运行 命令。这会将列转换为行并将分支名称列表复制到单行中。

然后运行
`git branch -D branch_name(s)`。
这将删除本地存在的所有列出的分支

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-09-12T17:03:46.913

为此，您可以使用[git-extras](https://github.com/tj/git-extras/blob/master/Commands.md#git-delete-merged-branches)

```
$ git delete-merged-branches
Deleted feature/themes (was c029ab3).
Deleted feature/live_preview (was a81b002).
Deleted feature/dashboard (was 923befa). 
```

# firefox - 阻止 Safari/Firefox 缓存我的页面

> ID：10610332
> 
> 赞同：0
> 
> 时间：2012-05-15T23:46:34.117
> 
> 标签：firefox, caching, safari, webkit, page-refresh

我正在使用 PHP(header) 将用户发送回网站的主页（由于 cookie 看起来不同，然后当用户第一次到达时）。

在 Google Chrome 中一切正常，但在 Safari 和 FireFox 中显示的是 index.php 的缓存版本，而不是网页的更新版本。

如果我点击刷新，事情看起来应该是这样，但我需要一种方法来告诉浏览器重新加载页面，而无需用户点击刷新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:51:30.120

试试这个... [http://smartcoding.wordpress.com/2009/01/28/php-force-no-cache-page-load/](http://smartcoding.wordpress.com/2009/01/28/php-force-no-cache-page-load/)

# javascript - Javascript cookie 不起作用

> ID：10610333
> 
> 赞同：0
> 
> 时间：2012-05-15T23:46:39.263
> 
> 标签：javascript, cookies, session-cookies

所以，伙计们，我试着让这个工作。当我单击页面上的按钮时，它必须将数组传输到另一个页面才能显示它。我的函数 addProduct、showProduct、addItem 和 button 工作。但是我来自数组的数据不会传递到其他页面。因此，当我单击页面 A 中的按钮时，会向该数组添加一个值。但在 B 页上，它显示数组为空

```
var products = new Array();

    window.addEventListener("load", loadPage, false);
    window.addEventListener("load", addButton, false);
    window.addEventListener("load", showProducts, false);

    function addButton() {
        var button = document.getElementById("sell");
        button.addEventListener("click", addItem, false);
    }

    function loadPage(){
        getCookie();
    }

    function getCookie(){
        var elements = document.cookie.split('=');
        var products_cookie = elements[1].split('%');
        for(var i=0;i < products_cookie.length-1;i++) {
            var tmp = products_cookie[i].split('$');
            addProduct(tmp[0], tmp[1], tmp[2]);
        }
    }

    function setCookie(){

        var date = new Date();
        date.setTime(date.getTime()+(2592000)); //expire time = 30 dagen nadat cookie aangemaakt is
        var expires = "; expires="+date.toGMTString()
        var text = "";
        for (var i = 0; i < products.length; i++){
            text+= products[i][0] + "$" + products[i][1] + "$" + products[i][2] +"%";  // slaat naam $ aantal $ prijs op
        }
        document.cookie = "tradepoint"+text+expires;
    }

    function addProduct(pName, pAmount, pPrice){
            var product = new Array(pName, parseInt(pAmount), pPrice);
            products[products.length] = product;   
        setCookie();
    }

    function addItem(){
        addProduct("andrej", 2, 1);
        alert(products + " " + products.length);
    }

    function showProducts(){
        if (products.length != 0){
            document.getElementById("shopList").innerHTML = "<ul><li>Full</li></ul>";
        }
        else{
            document.getElementById("shopList").innerHTML = "<ul><li>Empty</li></ul>";
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:59:19.563

您是否正在针对 localhost 进行测试？Cookie 不会“粘”在 TLD 上。您至少需要 xyz - 在您的主机文件中使用 127.0.0.1 的别名来测试与 cookie 相关的代码。

（stackoverflow 不允许我将 url 发布到 localhost - 我认为是反拖钓技术！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:58:29.850

Cookies 以`name=value`成对的形式表示，您的`setCookie`函数没有这样做，您应该`document.cookie = "tradepoint="+text+expires;`注意到 = 符号。
此外`getCookie`，如果设置了其他 cookie，您的功能可能无法正常工作。

# grails - 带有关联的 Grails“max”子查询，仅获取最新的 hasMany

> ID：10610338
> 
> 赞同：2
> 
> 时间：2012-05-15T23:47:10.397
> 
> 标签：grails, grails-orm

简化的域模型：'Txn'（如在 Transaction 中）有许多 'TxnStatus'。TxnStatus 有一个日期时间

这是一个遗留映射，所以我不能更改数据库，Txn 上的映射：

```
 static mapping = { 
    txnStatus column: 'MessageID', ignoreNotFound: true, fetch: 'join'
  } 
```

我需要根据一些动态构建的条件来获取 Txns，目前使用 GORM 的“where”查询，效果很好；但我也只需要获取**最新**的txnStatus。

试过：

```
def query = Txn.where {
   txnStatus { dateTime == max(dateTime) }    
} 
```

给出： `java.lang.ClassCastException: org.hibernate.criterion.DetachedCriteria cannot be cast to java.util.Date`

也试过：

```
 def query = Txn.where {
       txnStatus.dateTime == max(txnStatus.dateTime)    
    } 
```

这使：

```
Compilation Error: ... 
            Cannot use aggregate function max on expressions "txnStatus.dateTime" 
```

在这个阶段，我正在考虑更改为 HQL ......任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:08:49.210

前几天有个问题跟这个很像。似乎使用带有“max”子查询的 where 查询不适用于 ==

OP 能够让它与 < 一起工作，并以这种方式解决它。查看关于 where 查询的文档并没有帮助我弄清楚这一点。

这是一个非常疯狂的猜测 -

```
 Txn.where {
        txnStatus  {
          dateTime == property(dateTime).of { max(dateTime) }
        }
    } 
```

# c# - 如何在http下添加自定义soap标头或使用用户名auth？

> ID：10610340
> 
> 赞同：1
> 
> 时间：2012-05-15T23:47:18.083
> 
> 标签：c#, wcf, visual-studio-2008, wcf-security, ws-security

我正在尝试在这样的`BeforeSendRequest`方法中修改自定义标头并将其添加到肥皂消息中：

```
 public object BeforeSendRequest(ref System.ServiceModel.Channels.Message request, IClientChannel channel)
    {
        MessageHeader header = MessageHeader.CreateHeader("name", "http://myname", "Oscar");
        request.Headers.Add(header);

        return null;
    } 
```

此时一切正常，标题添加到soap标题中，如下所示：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Header>
<ActivityId CorrelationId="51efbfdb-2187-45b9-81fc-6a38815d5bed" xmlns="http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics">d1351a78-a53a-4d32-ad35-fca6d4262adf</ActivityId>
<name xmlns="http://myname">Oscar</name>
</s:Header> 
```

问题是我想在标题中添加更大的东西，最终结果必须是这样的：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Header>
<ActivityId CorrelationId="51efbfdb-2187-45b9-81fc-6a38815d5bed" xmlns="http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics">d1351a78-a53a-4d32-ad35-fca6d4262adf</ActivityId>
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
    <wsse:UsernameToken xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <wsse:Username xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">username</wsse:Username>
      <wsse:Password xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">password</wsse:Password>
    </wsse:UsernameToken>
</wsse:Security>
</s:Header> 
```

有没有办法做到这一点？

PS。请大家:-)不要批评我，我处于以下情况：

添加此用户名和密码身份验证时，您需要结束`https`，问题是我尝试通信的这个基于 Java 的 Web 服务处于下`http`，我认为它不符合要求，因为根据第三个链接**“这被认为是不好的做法通过不安全的连接传递凭据”**，但他们解决了它在配置文件中添加标题（我没有成功）。

我也阅读了这些链接并尝试了它们。同样，当从链接 1 和 2 执行操作时，我在 Visual Studio 中遇到了一种异常，上面写着**“应该是 https 而不是 http”**，这就是我尝试`MessageInspectors`使用`BeforeSendRequest`方法的原因。

1.  [使用通过 https 的用户名为 WS-Security 配置 WCF](https://stackoverflow.com/questions/4543915/configure-wcf-for-ws-security-with-username-over-https)

2.  [http://www.west-wind.com/weblog/posts/2007/Dec/09/Tracing-WCF-Messages](http://www.west-wind.com/weblog/posts/2007/Dec/09/Tracing-WCF-Messages)

3.  [http://www.fransson.net/blog/credentials-over-plain-http-with-wcf/](http://www.fransson.net/blog/credentials-over-plain-http-with-wcf/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:30:59.067

[ClearUsernameBinding](http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html)是解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T02:33:56.137

CreateHeader 的第三个参数是一个对象。默认情况下，此对象使用 DataContractSerializer 进行序列化，因此如果您创建一个对标头结构建模的数据协定，您可以将实例作为第三个参数传递，它将创建您想要的标头

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T06:37:19.823

我有同样的问题，虽然我的服务是 https。这应该是一个配置问题，您不需要手动处理。

无论如何，您不必通过 BeforeSendRequest 使用 MessageInspectors。您应该尝试更改配置生成的代码，添加一些安全配置。然后，WCF 将创建您需要的标头。然后在代码中添加凭据，你应该没问题。

我想生成的代理正在为您创建 customBinding 或 basicHttpBinding。basicHttpBinding 虽然不支持 WS-Security 规范，但您应该将其更改为自定义或 wsHttpBinding。您可以使用并找到正确的配置以获得所需的结果。

我添加的是“示例配置语法”：

```
<customBinding>
        <binding name="MessageServerBinding">
          <security defaultAlgorithmSuite="Default" authenticationMode="UserNameOverTransport"
            requireDerivedKeys="true" includeTimestamp="true" messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
            <secureConversationBootstrap />
          </security>
........
</binding>
</customBinding> 
```

这是一个示例配置，例如，您可能不需要包含时间戳，或者您可能需要一个 Nonce，如果我没记错的话需要更多的努力，但不多。

检查此讨论：[WCF：将 Nonce 添加到 UsernameToken](https://stackoverflow.com/questions/896901/wcf-adding-nonce-to-usernametoken/4070818#4070818)

希望这可以帮助。

# asp.net - ASP.NET MVC Razor 不接受我的有效标记

> ID：10610344
> 
> 赞同：14
> 
> 时间：2012-05-15T23:47:57.760
> 
> 标签：asp.net, asp.net-mvc, razor

我非常喜欢 Razor 语法，但它肯定不够完美。例如，我有以下标记块。

```
@if (Model.FeaturedDestinations != null && Model.FeaturedDestinations.Count() > 0)
{
    int column = 0;

    foreach (var d in Model.FeaturedDestinations)
    {
        column++;
        if (column > 4)
        {
            </div>
            @{ column = 1; }
        }
        if (column == 1)
        {
            @:<div class="row-fluid">
        }
        <div class="span3">
            @RenderDestination(d)
        </div>
    }
    </div>
} 
```

所以，编辑器给了我波浪线，表明我在开始`<div>`标签之前有一个结束标签。我可以忍受这一点。但是当我运行应用程序时，我实际上得到了以下运行时错误：

> 遇到没有匹配开始标签的结束标签“div”。您的开始/结束标签是否正确平衡？

显然，我不能忍受！那么处理这个案子有什么诀窍吗？就我想要的标记而言，我知道我在做什么。但 Razor 不这么认为，它正在接管。

为什么 MVC 会浪费循环检查平衡标签？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-16T00:13:32.663

由于我不明白的原因，以下更正了该问题：

```
@if (Model.FeaturedDestinations != null && Model.FeaturedDestinations.Count() > 0)
{
    int column = 0;

    foreach (var d in Model.FeaturedDestinations)
    {
        column++;

        if (column > 4)
        {
            @:</div>
            column = 1;
        }

        if (column == 1)
        {
            @:<div class="row-fluid">
        }
        <div class="span3">
            @RenderDestination(d)
        </div>
    }
    @:</div>
} 
```

注意`@:`前几个标签的添加。我不知道为什么这些是必要的——Razor 突出显示它识别出这些是标签而不是代码。

另外，为什么这会使错误消失？导致运行时错误的东西没有改变。也许有人可以为我填补空白。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-25T14:29:39.477

您需要在标记前添加@:（如标记答案中所标识）。此博客条目解释了其原因：

[http://weblogs.asp.net/scottgu/archive/2010/12/15/asp-net-mvc-3-razor-s-and-lt-text-gt-syntax.aspx](http://weblogs.asp.net/scottgu/archive/2010/12/15/asp-net-mvc-3-razor-s-and-lt-text-gt-syntax.aspx)

来自博客：

> Razor 用于隐式识别代码块何时结束的技术之一是查找标记/元素内容以表示内容区域的开始。

和

> 但是，并非所有内容容器块都以标记元素标记开头，并且存在 Razor 解析器无法隐式检测内容块的情况。
> 
> Razor 通过使您能够使用代码块中的 @: 字符序列显式指示内容行的开头来解决此问题。@: 序列表示后面的内容行应被视为内容块：

# php - 随机错误：无法重新声明 Zend_Loader 类

> ID：10610351
> 
> 赞同：1
> 
> 时间：2012-05-15T23:49:21.487
> 
> 标签：php, zend-framework, backbone.js

我在几个虚拟主机上有多个 Zend 应用程序。EG intranet.site.com 和 api.site.com。我*有时*在访问 api.site.com 时遇到一些问题。我还有多个backbone.js 模型，它们向API 发出请求以填充模型。

当我加载一个 Intranet 页面时，它会在 3 次中至少 1 次成功地对 API 执行 XHR。其他时候，我收到此错误：

> 致命错误：无法在第 31 行的 C:\xampp\htdocs\Zend\Loader.php 中重新声明 Zend_Loader 类

现在，它偶尔会发生。当它只是一个普通的 GET 请求（即不是 XMLHTTPRequest）时，我有时会得到它，但是当我在单个页面加载上执行多个 API 请求时，我大多会得到它。

好像它没有将其他 API 调用视为单独的请求？我不确定是什么原因造成的，因为它偶尔会起作用。

如果这很重要，我正在使用 XAMPP 的 Windows 7 环境中。在 linux 环境下似乎问题较少，但我无法在 linux 环境下开发系统...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:59:04.470

我认为你可以：

*   正在使用 Superluminal 插件并尝试 require_once Loader.php
*   有某种类缓存，可以一次加载更多文件 - 然后对任何包含的类的任何 require_once 调用都会失败
*   APC/ZendOptimizer/等有问题。缓存类

# excel - 比较 Excel 中的多个数据列表以查找相关数据

> ID：10610354
> 
> 赞同：0
> 
> 时间：2012-05-15T23:49:55.407
> 
> 标签：excel, compare

我以为我知道从哪里开始，但遗憾的是我已经足够长了，我需要一些帮助。首先，我使用的是四个产品数据列表，我需要将它们与我自己的产品数据进行比较。

例如，每个产品列表都包含以下数据：

```
Product Category
Product Name
Inventory
Product Price 
```

每个列表至少有一千条记录。

我需要的是第五个清单，它告诉我哪些竞争对手的产品没有在我的清单上。

最后但并非最不重要的一点是清单包含重复记录。

当我花时间研究这个问题时，我什至很难构建这个问题。

不过，我想要的是一份由我的产品列表中没有的所有竞争对手共享的产品列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:55:31.103

如果您熟悉数据透视表，也许可以使用多合并范围选项来满足您的需求...

1.  通过访问数据透视表向导对话框（快捷方式：Alt+D+P）选择多合并范围选项，然后在类似于下面的对话框中输入设置。数据显示在同一张纸上，但同样可以存储在不同的纸上，甚至是封闭的工作簿中。

2.  如图所示，重新排列列并将产品名称分组为“匹配”和“不匹配”。有几种方法可以自动分组，最简单的可能是在数据透视表旁边添加一个计数列并过滤有 4 个项目的行，然后您可以通过按 Alt+ 选择行字段中的可见项目；并选择组选项。将此组重命名为“Matched”，然后在计数列中过滤少于 4 个项目并将该组重命名为“Unmatched”

3.  现在，您可以使用简单的 vlookup 或其他方式将所有匹配的产品名称与您自己的列表进行比较。

![在此处输入图像描述](../Images/f6ec4c0d8621bbe035fb2ebdab485bbd.png)

![在此处输入图像描述](../Images/a1ece19f010872b2208db6b1214e0445.png)

# java - Batik - 计算三次样条的边界

> ID：10610355
> 
> 赞同：4
> 
> 时间：2012-05-15T23:50:02.663
> 
> 标签：java, svg, batik

我正在使用 Batik 处理 SVG 图像。具体来说，我有一个具有多种形状的场景，我需要能够将每个形状转换为单独的 BufferedImage。为此，我使用以下代码：

```
SVGDocument document = null;

// Load the document
String parser = XMLResourceDescriptor.getXMLParserClassName();
SAXSVGDocumentFactory f = new SAXSVGDocumentFactory(parser);

File file = new File(inPath);
try {
    document = (SVGDocument) f.createDocument(file.toURL().toString());
} catch (MalformedURLException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
}

// Build the tree and get the document dimensions
UserAgentAdapter userAgentAdapter = new UserAgentAdapter();
BridgeContext bridgeContext = new BridgeContext(userAgentAdapter);

GVTBuilder builder = new GVTBuilder();

GraphicsNode graphicsNode = builder.build(bridgeContext, document);
CanvasGraphicsNode canvasGraphicsNode = (CanvasGraphicsNode)
        graphicsNode.getRoot().getChildren().get(0);

if(canvasGraphicsNode.getChildren().get(i) instanceof ShapeNode) {
   currentNode = (ShapeNode) canvasGraphicsNode.getChildren().get(i);
    convertNodeToImage (currentNode);
} 
```

这是相当标准的。我启动 Batik 并让它解析 SVG 文件。这是将节点转换为图像功能：

```
Rectangle2D bounds;
BufferedImage bufferedImage;
Graphics2D g2d;

// This is supposed to get the bounds of the svg node. i.e. the rectangle which would
// fit perfectly around the shape   
bounds = sn.getSensitiveBounds();

// Transform the shape so it's in the top left hand corner based on the bounds
sn.setTransform(AffineTransform.getTranslateInstance(-bounds.getX(), -bounds.getY()));

// Create a buffered image of the same size as the svg node         
bufferedImage = new BufferedImage((int) bounds.getWidth(), (int) bounds.getHeight(),
                BufferedImage.TYPE_INT_ARGB);

// Paint the node to the buffered image and convert the buffered image to an input       
// stream           
g2d = (Graphics2D) bufferedImage.getGraphics();
sn.paint(g2d);

ByteArrayOutputStream os = new ByteArrayOutputStream();
ImageIO.write(bufferedImage, "png", os);
InputStream is = new ByteArrayInputStream(os.toByteArray());
return is; 
```

这适用于矩形和直线形状，但不适用于样条曲线。对于样条线，边界大于渲染的样条线。我认为这是因为 getBounds 函数在边界计算中包含了控制点。我需要找到样条线的边界，即如果样条线被抚摸，我想找到该笔划的边界。我已经尝试了所有的 getBounds() 函数（getSensativeBounds、getGeometryBounds ...），它们都给了我相同的结果。所以我想知道我是否错过了什么？这是蜡染中的一个错误？或者如果有解决方法？

我想到的一种解决方法是获取形状的顶点列表并手动计算边界。但是，我一直无法找到如何获取轮廓顶点列表。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T12:21:13.627

对于遇到此问题的任何人，我都找到了解决方案。从文档中它说 get bounds 不能保证提供最小的边界，只是一些完全包含形状的矩形。这意味着有必要手动计算边界。样条是形状的数学定义，即分段连续函数。这意味着我们必须将样条曲线计算到一定的精度。这是通过使用具有双精度的路径迭代器来实现的。此路径迭代器仅返回 LINE_TO 命令，这意味着它可用于计算形状的实际边界：

```
BufferedImage bufferedImage;
Graphics2D g2d;

// Manually calculate the bounds
double [] vals = new double[7];

double minX = Double.MAX_VALUE;
double maxX = 0;

double minY = Double.MAX_VALUE;
double maxY = 0;

// Get a path iterator iterating to a certain level of accuracy
PathIterator pi = sn.getOutline().getPathIterator(null, 0.01);

while(!pi.isDone()) {
    pi.currentSegment(vals);

    if(vals[0] < minX ) {
        minX = vals[0];
    }
    if(vals[0] > maxX ) {
        maxX = vals[0];
    }
    if(vals[1] < minY ) {
        minY = vals[1];
    }
    if(vals[1] > maxY ) {
        maxY = vals[1];
    }

    pi.next();
}

sn.setTransform(AffineTransform.getTranslateInstance(-minX, -minY));

bufferedImage = new BufferedImage((int) (maxX - minX), (int) (maxY - minY),
                BufferedImage.TYPE_INT_ARGB);

g2d = (Graphics2D) bufferedImage.getGraphics();

sn.paint(g2d);

ByteArrayOutputStream os = new ByteArrayOutputStream();
ImageIO.write(bufferedImage, "png", os);
InputStream is = new ByteArrayInputStream(os.toByteArray()); 
```

# android - 不同设备的Android方向传感器不同？

> ID：10610362
> 
> 赞同：3
> 
> 时间：2012-05-15T23:50:42.830
> 
> 标签：android, sensors

我正在开发一个 Android 游戏，它使用方向传感器来获取设备的旋转（滚动球）。我有两台设备用于测试应用程序，一台是三星 Infuse（手机），另一台是华硕 Eee Pad Transformer TF101（平板电脑）。

该应用程序在两台设备上都以横向方式运行。问题在于，在 Eee Pad 上，无论我做什么，设备都是在横向（横向模式）测量方向，而 Infuse 以竖直（纵向）测量。这使得当我向左倾斜 Infuse 时球会向左移动，但是当我向左倾斜 Eee Pad 时，球会向上或向下移动。

我可以切换方向角度，所以它们会以另一种方式移动球，但它一次只能用于一个或另一个。有什么想法可以解决这个问题吗？

是的，我使用的是已弃用的 TYPE_ORIENTATION，而不是 getOrientation() 方法。我尝试设置它，但我从来没有让它正常工作，而且它总是吐出非常奇怪的值，所以我坚持使用已弃用的值。切换会解决这个问题吗？如果是这样，有人可以将我链接到资源来实现这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:20:16.583

谷歌的文档清楚地表明[传感器坐标系](http://developer.android.com/guide/topics/sensors/sensors_overview.html#sensors-coords)是相对于设备的*默认*方向的。该描述提到了`getRotation()`和`remapCoordinateSystem()`调用，您可以使用它们进行适当调整。

# wordpress - 将 Supersized 集成到自定义 Wordpress 主题中

> ID：10610366
> 
> 赞同：0
> 
> 时间：2012-05-15T23:50:55.890
> 
> 标签：wordpress

我想知道如何将超大的 jQuery 插件集成到自定义 wordpress 主题中。我包含了所有的脚本和样式表，但它不起作用。

有什么想法吗？

[http://buildinternet.com/project/supersized/](http://buildinternet.com/project/supersized/)

谢谢！

杰西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T04:07:27.187

你试过这个插件安装[WP Supersized](http://wordpress.org/extend/plugins/wp-supersized/)

您也可以点击这些教程链接，我希望这是您需要的并让我知道。

1.  [WordPress + Supersized，正确的方式](http://garvinmedia.com/2011/04/wordpress-supersized-the-right-way/)
2.  [如何在 wordpress 中集成 Supersized](http://www.worldinmyeyes.be/1534/)

# c++ - 数组上的函数内存泄漏

> ID：10610367
> 
> 赞同：-1
> 
> 时间：2012-05-15T23:51:14.987
> 
> 标签：c++, memory-leaks

您好，我需要以下代码和内存泄漏方面的帮助。

该程序的错误日志显示我在我的程序中遇到以下泄漏：

```
Dr. Memory version 1.4.6 build 2 built on Mar  7 2012 10:14:04
Application cmdline: ""D:\c++\Begin\L_6-8\Debug\L_6-8.exe""
Recorded 62 suppression(s) from default C:\Program Files (x86)\Dr. Memory/bin/suppress-default.txt

Error #1: UNADDRESSABLE ACCESS: reading 0x0077f5a0-0x0077f5a4 4 byte(s)
# 0 Assignment::getID()                              [..//Assignment.h:26]
# 1 AssignmentRepository::searchById()               [D:\c++\Begin\L_6-8\Debug/../AssignmentRepository.cpp:10]
# 2 AssignmentRepository::delByID()                  [D:\c++\Begin\L_6-8\Debug/../AssignmentRepository.cpp:30]
# 3 Catalog::removeAssignment()                      [D:\c++\Begin\L_6-8\Debug/../Catalog.cpp:38]
# 4 _fu63___ZSt4cout                                 [D:\c++\Begin\L_6-8\Debug/../UIconsole.cpp:148]
# 5 UIconsole::runUI()                               [D:\c++\Begin\L_6-8\Debug/../UIconsole.cpp:24]
# 6 Application::run()                               [D:\c++\Begin\L_6-8\Debug/../App.cpp:48]
# 7 main                                             [D:\c++\Begin\L_6-8\Debug/../App.cpp:25]
Note: @0:00:21.491 in thread 6388
Note: refers to 1 byte(s) beyond last valid byte in prior malloc
Note: prev lower malloc:  0x0077f590-0x0077f5a0
Note: instruction: mov    (%eax) -> %eax

Error #2: POSSIBLE LEAK 100 direct bytes 0x0077f5c8-0x0077f62c + 0 indirect bytes
# 0 libstdc++-6.dll!_cxa_allocate_exception
# 1 AssignmentRepository::delByID()               [D:\c++\Begin\L_6-8\Debug/../AssignmentRepository.cpp:36]
# 2 Catalog::removeAssignment()                   [D:\c++\Begin\L_6-8\Debug/../Catalog.cpp:38]
# 3 _fu63___ZSt4cout                              [D:\c++\Begin\L_6-8\Debug/../UIconsole.cpp:148]
# 4 UIconsole::runUI()                            [D:\c++\Begin\L_6-8\Debug/../UIconsole.cpp:24]
# 5 Application::run()                            [D:\c++\Begin\L_6-8\Debug/../App.cpp:48]
# 6 main                                          [D:\c++\Begin\L_6-8\Debug/../App.cpp:25]

DUPLICATE ERROR COUNTS:

SUPPRESSIONS USED:

ERRORS FOUND:
      1 unique,     1 total unaddressable access(es)
      0 unique,     0 total uninitialized access(es)
      0 unique,     0 total invalid heap argument(s)
      0 unique,     0 total warning(s)
      0 unique,     0 total,      0 byte(s) of leak(s)
      1 unique,     1 total,    100 byte(s) of possible leak(s)
ERRORS IGNORED:
     89 still-reachable allocation(s)
         (re-run with "-show_reachable" for details)
Details: C:\Users\Warzaru\AppData\Roaming/Dr. Memory/DrMemory-L_6-8.exe.9752.000/results.txt 
```

考虑到我的函数和存储库类是我做错了什么......

类标题（完整）：

```
#ifndef ASSIGNMENTREPOSITORY_H_
#define ASSIGNMENTREPOSITORY_H_

#include "Assignment.h"
#include <vector>

class AssignmentRepository{
private:
    vector <Assignment> assignments;
public:
    vector <Assignment> getAll();
    void save(Assignment);
    void delByID(int);
    void editAssignment(Assignment);
    int searchById(int);
    void printAllAssignments();
    Assignment *getAssignment(int i);

    ~AssignmentRepository();
};

#endif /* ASSIGNMENTREPOSITORY_H_ 
```

类 cpp（部分）：

```
int AssignmentRepository::searchById(int a){
for(unsigned i=0; i<assignments.size(); i++){
    if(a == assignments[i].getID()){
        return i;
    }
}
return 0;
}

void AssignmentRepository::delByID(int i){
int check;
check = searchById(i);

if(check != 0){
    assignments.erase(assignments.begin()+check);
}
else{
    throw RepoException("ID does not exist in the database!");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:01:37.817

此函数 delByID() 或此 removeAssignment() 存在一些异常

# ios - 如何防止我的 UIGestureRecognizers 崩溃？

> ID：10610377
> 
> 赞同：2
> 
> 时间：2012-05-15T23:52:46.857
> 
> 标签：ios, automatic-ref-counting, uigesturerecognizer

我对 UIGestureRecognizers 有一个非常令人沮丧的问题。它们可以很好地添加，但是每当触发它时，它就会与 message 一起崩溃`EXC_BAD_ACCESS (code=1, address=0xf0000008)`。我使用以下代码将其添加到视图控制器中：

```
- (void)handleDrag:(UIGestureRecognizer *)sender {
    NSLog(@"%@", sender);
}

- (void)viewDidLoad {
    [super viewDidLoad];

    UIPanGestureRecognizer *panGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handleDrag:)];
    [self.windowBar addGestureRecognizer:panGesture];
} 
```

`self.windowBar`是一个 UIImageView。我已经在所述 UIImageView 上启用了用户交互。但是每当我开始实际拖动它时，它就会崩溃。

我不确定这是否与它有关，但我正在使用新的 ARC 功能。

我还缺少什么？:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:38:58.007

尝试使用 Zombies Instrument 运行以准确检测引用了哪个僵尸（已发布）对象。它将指向系统认为应该向其发送消息但已被释放的确切对象（保留计数设置为 0，并且内存已重新分配）。

# javascript - 将随机添加到 css3 动画循环

> ID：10610381
> 
> 赞同：5
> 
> 时间：2012-05-15T23:53:03.297
> 
> 标签：javascript, jquery, css, animation

每次 css3 动画循环时，我都想更改样式中的变量。

例如下面的 css 从屏幕的顶部到底部放置一组降落伞：

```
@-webkit-keyframes fall {
  0% { top: -300px; opacity: 100; }
  50% { opacity: 100; }
  100% { top: 760px; opacity: 0; }
}

#parachute_wrap {
  -webkit-animation-name: fall;
  -webkit-animation-iteration-count: infinite; 
  -webkit-animation-duration: 70s;
  -webkit-animation-timing-function: linear;
} 
```

然而，理想情况下，在每个循环结束时，我想放入一个随机的 X 位置。

该组的默认样式为：

```
#parachute_wrap {
  position: absolute;
  top: -300px;
  left: 50%;
  margin-left: 140px;
} 
```

所以 70 秒后，我想在 -200px 和 200px 之间的任意位置更改 margin-left 或 left 属性。

我知道我可以用 jquery 和 everytime() 做这样的事情：

```
$('#parachute_wrap').everyTime ( 70000, function (){
    $("#parachute_wrap").css({left: Math.floor(Math.random() * 51) + 5 + '%'},0);
}); 
```

但是有没有办法将 css 循环绑定到 js 来做到这一点？即是否有任何类型的 js 可以收听以与动画完美同步的返回调用？我担心如果我在 70 年代的计时器上使用 JS，会发生什么情况是时间不会正确同步，并且在 css 动画的中途，js 会进行定时循环，降落伞会在一半的地方跳跃通过动画的方式。

你会如何处理这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-16T00:56:53.250

CSS3 动画`animationEnd`在动画完成时会触发一个事件。

您可以将该事件添加到您的动画元素，从而在每个动画结束时`bind`触发该更改：`left`

```
$('#parachute_wrap').on('webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationEnd', function(e) {
    $(this).css({left: Math.floor(Math.random() * 51) + 5 + '%'},0);
}); 
```

这样，您就可以准确地知道动画何时结束以及`left`正确应用更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-05T12:51:15.130

`animationiteration`在每次新动画迭代开始时也会触发一个事件，即除了第一次之外的每次迭代。

```
$('#parachute_wrap').on('animationiteration webkitAnimationIteration oanimationiteration MSAnimationIteration', function(e) {
    $(this).css({left: Math.floor(Math.random() * 51) + 5 + '%'},0);
}); 
```

[http://www.w3.org/TR/css3-animations/#animationiteration](http://www.w3.org/TR/css3-animations/#animationiteration)

# android - 如何使用测试帐户进入 Android 中的 Paypal 沙箱？

> ID：10610383
> 
> 赞同：0
> 
> 时间：2012-05-15T23:53:46.823
> 
> 标签：android, api, paypal

嗨，我正在开发一个购物应用程序，其支付系统为 Android 中的 Pappal。

但是我在使用沙箱时遇到了问题。因为我无法控制或使用沙箱进入，所以我正在使用本教程[**Paypal Android 教程**](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_MPL_Developer_Guide_and_Reference_Android.pdf)，但我不能。

Paypal 应用程序 ID = "APP-80W284485P519543T" 是我使用的。但我不知道如何与用户一起输入。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:00:52.287

对于沙盒环境，您不需要有效的 PayPal 应用程序 ID。您可以为此字段使用任何字符串。

```
// The PayPal server to be used - ENV_SANDBOX, ENV_NONE or ENV_LIVE
int PAYPAL_SERVER = PayPal.ENV_SANDBOX; 
```

请仔细阅读本文档。您需要了解有关此库的所有信息。

```
PayPal ppObj = PayPal.initWithAppID(this.getBaseContext(), "APP-
80W284485P519543T", PayPal.ENV_SANDBOX); 
```

如果您需要用户 - 您应该在 developer.paypal.com 注册并创建多个测试用户。

# php - 如果地址是通过获取，Jquery 将无法在包含的 php 文件中工作

> ID：10610384
> 
> 赞同：0
> 
> 时间：2012-05-15T23:53:52.567
> 
> 标签：php, jquery, get, include

我的脚本有问题..

```
if (!isset($opt)) {

        input type="button" value="Add Item" class="add_item"
        input type="button" value="Delete Item(s)" class="del_item"

} else if ($opt == 'add') {    
    inculde("items_add.php");
} else if ($opt == 'edt') {
    //page for edit
} else if ($opt == 'del') {
    //page for delete
} 
```

这是 items_add.php 中的代码

```
input type="button" value="Cancel" class="cancel_add" 
```

而这个在包含所有jquery的外部js文件上，

```
$('.add_item').click(function() {
    window.location = location.pathname+'?opt=add';
});

$('.cancel_add').click(function() {
    alert('asd');
}); 
```

我的问题是， .add_item 点击工作正常，但是在我导航到它的链接后， .cancel_add 的 jquery 将不再工作。如果将 jquery 与它绑定，items_add.php 中的所有元素都将不起作用。

*   我没有任何语法错误我不能在这里插入标签，也许是逻辑错误？？

*   仅当 get opt 等于 add 但其中的所有 jquery 都不起作用时，才会包含 items_add.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:40:33.563

检查 isset 的代码应该如下所示

```
$opt = $_GET['opt'];
if (!isset($_GET['opt'])) {

        input type="button" value="Add Item" class="add_item"
        input type="button" value="Delete Item(s)" class="del_item"

} else if ($opt == 'add') {    
    inculde("items_add.php");
} else if ($opt == 'edt') {
    //page for edit
} else if ($opt == 'del') {
    //page for delete
} 
```

# regex - 正则表达式用于验证没有 http/https 的 URL

> ID：10610390
> 
> 赞同：0
> 
> 时间：2012-05-15T23:55:24.310
> 
> 标签：regex, validation, url

全部，

我是 REGEX 世界的新手...

我知道有很多正则表达式可用于验证带有*http*的公共 URL 。

但我正在寻找一个正则表达式来验证以下格式的 URL（没有 HTTP/HTTPS）：

*   www.example.com/user/login
*   www.example.com
*   www.example.co.xx
*   www.example.com/user?id=234&name=fname

如果 URL 仅包含，

*   **www.example（没有域 - .com 或 .co.xx）**
*   **example.com（没有“www”）**

我应该向用户抛出一个错误。

任何帮助将不胜感激...

谢谢拉吉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:05:27.070

此正则表达式将通过您的第一组，但不匹配第二组：

```
^www\.example\.(com|co.xx)(/.*)?$ 
```

在英语中，这个正则表达式需要：

*   以。。开始`www.example.`
*   其次是`com`或`co.xx`
*   可选地，`/`然后是任何东西

`(/.*)`您可以通过替换为`(/(user|buy|sell)\?.*)`etc来更规范地说明可选斜杠后面的内容

# python - Python Beginner - 如何将回归线等同于点击并以图形方式显示？

> ID：10610391
> 
> 赞同：7
> 
> 时间：2012-05-15T23:56:38.810
> 
> 标签：python, zelle-graphics

我正在阅读 John Zelle 的 Python Programming，我被困在下图中显示的一个练习中。

您可以在下面查看我的代码。我知道代码非常难看。（任何提示表示赞赏）

![回归练习的图片](../Images/6c3ea26d0c2c601f52d5cded993a2d33.png)

到目前为止，这是我的代码：

```
from graphics import *

def regression():

# creating the window for the regression line
        win = GraphWin("Regression Line - Start Clicking!", 500, 500)
        win.setCoords(0.0, 0.0, 10.0, 10.0)

        rect = Rectangle(Point(0.5, 0.1), Point(2.5, 2.1))
        rect.setFill("red")
        rect.draw(win)
        Text(rect.getCenter(), "Done").draw(win)

        message = Text(Point(5, 0.5), "Click in this screen")
        message.draw(win)

        points = [] # list of points
        n = 0 # count variable
        sumX = 0
        sumY = 0

        while True:
                p = win.getMouse()
                p.draw(win)

# if user clicks in a red square it exits the loop and calculates the regression line
                if (p.getX() >= 0.5 and p.getX() <= 2.5) and (p.getY() >= 0.1 and p.getY() <= 2.1):
                        break

                n += 1 # count of the points

# get the sum of the X and Y points
                sumX = sumX + p.getX()
                sumY = sumY + p.getY()

# tuple of the X and Y points
                dot = (p.getX(), p.getY())
                points.append(dot)

        avgX = sumX / n
        avgY = sumY / n

        top = 0
        bottom = 0

# my ugly attempt at the regression equation shown in the book

        for i in points:
                gp = 0
                numer = points[gp][0] * points[gp][1]
                top = top + numer

                denom = points[gp][0] ** 2
                bottom = bottom + denom
                gp += 1

        m = (top - sumX * sumY) / (bottom - sumX ** 2)

        y1 = avgY + m * (0.0 - avgX)
        y2 = avgY + m * (10.0 - avgX)

        regressionline = Line(Point(0, y1), Point(10.0, y2))
        regressionline.draw(win)

        raw_input("Press <Enter> to quit.")
        win.close()

regression() 
```

当我运行程序时，回归线似乎永远不是最适合的真正线。我相信我在代码中错误地解释了回归方程。需要改变什么以获得正确的回归线？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T02:19:40.980

问题：

*   `from my_library import *`应该避免; 最好准确地指定您想要的内容。这有助于保持您的命名空间整洁。

*   你有一大段代码；最好将其拆分为单独的功能。这使得思考和调试变得更加容易，并且可以帮助您以后重用代码。当然，这是一个玩具问题，你不会重复使用它——但是练习的重点是养成良好的习惯，以这种方式分解你的代码绝对是一个好习惯！一般的经验法则——如果一个函数包含十多行代码，你应该考虑进一步拆分它。

*   该练习要求您在获取输入点时跟踪 x、y、xx 和 xy 运行总和。我认为这是一个坏主意——或者至少比 Python 更 C 语言——因为它迫使你同时执行两项不同的任务（获得积分并对其进行数学计算）。我的建议是：如果你得到积分，就得到积分；如果你在做数学，那就做数学；不要尝试同时做这两个。

*   同样，我不喜欢你让回归计算担心窗口边在哪里的方式。为什么它应该知道或关心windows？我希望你喜欢我的解决方案；-)

这是我重构的代码版本：

```
from graphics import GraphWin, Point, Line, Rectangle, Text

def draw_window()
    # create canvas
    win = GraphWin("Regression Line - Start Clicking!", 500, 500)
    win.setCoords(0., 0., 10., 10.)
    # exit button
    rect = Rectangle(Point(0.5, 0.1), Point(2.5, 2.1))
    rect.setFill("red")
    rect.draw(win)
    Text(rect.getCenter(), "Done").draw(win)
    # instructions
    Text(Point(5., 0.5), "Click in this screen").draw(win)
    return win

def get_points(win):
    points = []
    while True:
        p = win.getMouse()
        p.draw(win)
        # clicked the exit button?
        px, py = p.getX(), p.getY()
        if 0.5 <= px <= 2.5 and 0.1 <= py <= 2.1:
            break
        else:
            points.append((px,py))
    return points

def do_regression(points):
    num = len(points)
    x_sum, y_sum, xx_sum, xy_sum = 0., 0., 0., 0.
    for x,y in points:
        x_sum += x
        y_sum += y
        xx_sum += x*x
        xy_sum += x*y
    x_mean, y_mean = x_sum/num, y_sum/num
    m = (xy_sum - num*x_mean*y_mean) / (xx_sum - num*x_mean*x_mean)
    def lineFn(xval):
        return y_mean + m*(xval - x_mean)
    return lineFn

def main():
    # set up
    win = draw_window()
    points = get_points(win)
    # show regression line
    lineFn = do_regression(points)
    Line(
        Point(0.,  lineFn(0\. )),
        Point(10., lineFn(10.))
    ).draw(win)
    # wait to close
    Text(Point(5., 5.), "Click to exit").draw(win)
    win.getMouse()
    win.close()

if __name__=="__main__":
    main() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T00:24:23.753

the `for` loop is all messed up! you have an `i` that changes in the loop, but then use `gp` which is always 0.

you want something more like:

```
for (X, Y) in points:
    numer += X * Y
    denom += X * X 
```

...or move `gp = 0` to before the for loop.

...or drop that part completely and add a `sumXY` and a `sumXX` to the `sumX` and `sumY`.

either way, once you fix that it should be ok (well, or maybe some other bug....).

# c# - 如何模拟 HttpRequest[] 索引器属性

> ID：10610393
> 
> 赞同：4
> 
> 时间：2012-05-15T23:56:42.330
> 
> 标签：c#, moq, httprequest, xunit

我正在向用 C#/ASP.NET/webforms 编写的大型遗留代码库添加单元测试。我们正在使用 MOQ 和 XUnit。我们已经能够使用如下语法模拟查询字符串值：

```
Mock<HttpRequestBase> request = new Mock<HttpRequestBase>();
NameValueCollection queryStringParams = new NameValueCollection();
queryStringParams.Add("name", "Fred Jones");
request.Setup(x => x.QueryString).Returns(queryStringParams); 
```

这允许此代码正常工作：

```
string name = _mockRequest.QueryString["name"]; 
```

问题在于，在整个代码库中散布着许多调用，以获取查询字符串变量或表单变量，其形式为：

```
string name = HttpContext.Current.Request["name"]; 
```

索引器显然会查看所有各种集合：查询字符串、表单值、cookie 和服务器变量。我不想通过重构生产代码来使用这些集合中的一个来引入很多潜在的副作用。

有谁知道在 HttpRequest 上模拟该索引器的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T02:57:39.900

我想出了这个，它比我做的要简单。

```
//
// Set a variable in the indexer collction
//
Mock<HttpRequestBase> request = new Mock<HttpRequestBase>();
request.SetupGet(r => r["name"]).Returns("Fred Jones"); 
```

# python - 你如何在python中重载插入符号（^）运算符

> ID：10610395
> 
> 赞同：4
> 
> 时间：2012-05-15T23:56:56.897
> 
> 标签：python, operator-overloading, caret

我需要覆盖类中的插入符号行为，但我不确定哪个运算符重载适用于它。例如：

```
class A: 
    def __init__(self, f):
        self.f = f
    def __caret__(self, other):
        return self.f^other.f

print A(1)^A(2) 
```

此代码错误：

```
TypeError: unsupported operand type(s) for ^: 'instance' and 'instance' 
```

如何构建类以便我可以控制行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-15T23:57:51.930

定义`A.__xor__()`或`A.__rxor__()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T00:03:39.813

^ 是一个异或运算符。`__xor__`您可以使用该方法重载它。

例如

```
>>> class One:
...     def __xor__(self, other):
...             return 1 ^ other
... 
>>> o = One()
>>> o ^ 1
0
>>> o ^ 0
1 
```

# javascript - JavaScript - 替换字符串中的所有逗号

> ID：10610402
> 
> 赞同：418
> 
> 时间：2012-05-15T23:57:53.677
> 
> 标签：javascript, string, replace, substitution

我有一个带有多个逗号的字符串，字符串替换方法只会更改第一个：

```
var mystring = "this,is,a,test"
mystring.replace(",","newchar", -1) 
```

**结果**：`"thisnewcharis,a,test"`

文档中表示默认全部替换，“-1”也表示全部替换，但是不成功。有什么想法吗？

* * *

## 回答 #1

> 赞同：873
> 
> 时间：2012-05-15T23:58:44.670

函数的第三个参数[`String.prototype.replace()`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/replace)从未被定义为标准，因此大多数浏览器根本不实现它。

### 最好的方法是使用带有( [*global*](https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Regular_Expressions#Advanced_searching_with_flags_2) ) 标志的[正则表达式。](https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Regular_Expressions)`g`[](https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Regular_Expressions#Advanced_searching_with_flags_2)

 *```
var myStr = 'this,is,a,test';
var newStr = myStr.replace(/,/g, '-');

console.log( newStr );  // "this-is-a-test"
```

## 还有问题吗？

需要注意的是，正则表达式使用[需要转义的特殊字符](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/RegExp#Special_characters_meaning_in_regular_expressions)。例如，如果您需要转义点 ( `.`) 字符，则应使用`/\./`文字，因为在正则表达式语法中，点匹配任何单个字符（行终止符除外）。

```
var myStr = 'this.is.a.test';
var newStr = myStr.replace(/\./g, '-');

console.log( newStr );  // "this-is-a-test"
```

如果您需要将变量作为替换字符串传递，而不是使用正则表达式文字，您可以创建`RegExp`对象并将[字符串作为构造函数的第一个参数传递](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/RegExp#Description)。正常的字符串转义规则（包含在字符串中时的特殊字符之前`\`）将是必需的。

```
var myStr = 'this.is.a.test';
var reStr = '\\.';
var newStr = myStr.replace(new RegExp(reStr, 'g'), '-');

console.log( newStr );  // "this-is-a-test"
```

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2012-05-16T00:06:01.063

只是为了好玩：

```
var mystring = "this,is,a,test"  
var newchar = '|'
mystring = mystring.split(',').join(newchar); 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-05-15T23:59:03.853

```
var mystring = "this,is,a,test"
mystring.replace(/,/g, "newchar"); 
```

使用 global( `g`) 标志

[**简单的演示**](http://jsfiddle.net/gdoron/hunAx/)*

# c++ - 我可以将每个 C++ 库转换为仅标头库吗？

> ID：10610405
> 
> 赞同：3
> 
> 时间：2012-05-15T23:58:23.270
> 
> 标签：c++, header-files

在 C++ 中，该库可以仅以标头格式分发。我想知道是否可以将每个库转换为仅标头库？或相反亦然？应该使用什么标准来决定我是否应该在仅标题下分发库？除了必须重新编译仅标头库之外，还有其他可能影响决定的考虑因素吗？“内联”如何在仅标头库中发挥重要作用？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:26:16.640

通常，标题中的任何内容都被视为内联。这对某些库可能是有利的，但通常应慎重使用。在标头中放置过多的逻辑可能会导致一些不良后果：客户端代码的相互依赖、如果逻辑发生更改则编译时间长、由于过度使用内联导致代码膨胀等。其中一些问题可以通过良好的优化编译器来缓解。一般来说，我建议不要将复杂的逻辑放在内联函数中，因此放在头文件中，因为它是导致大多数这些问题的原因。

至于反过来，是的，大多数作为标头分发的库都可以转换为更传统的库。严重依赖模板代码的库除外，因为这通常在编译时进行解释。

关于标准，我会说如果代码被大量模板化和/或主要由简单的函数组成，那么头库将是一个可以接受的选择。否则，普通库几乎绝对是更好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:04:58.377

简而言之，如果您对发布所有源代码感到满意，是的。

但是还有很多其他的事情。例如，如果分发了对库的更新，则动态链接库将使用最新版本，但只需重新编译标头即可。此外，另一个很大的区别是代码优化。当编译器可以访问源代码时，它可以针对特定情况生成更好的程序集。

最后但并非最不重要的一点是，使用动态链接，您必须将其安装在库目录中，但只有头文件才能使您的程序独立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T02:27:52.500

这取决于库是否可以将其转换为仅标题。相反，任何库都可以从仅标头转换为传统的标头+源。您真的想问自己为什么只需要标题？你希望获得或实现什么？

仅将库作为标头分发可能会在库更改时引起问题。可以说有一个不会修改界面的小改动。而不是重新编译库，每个使用它的应用程序都必须重新编译。使用静态库，用户应用程序只需重新链接即可。使用共享库，它们不必重新编译或重新链接。

您还可能会遇到问题，即使用您的库的每个组件都必须使用相同的编译器和链接器版本并以类似方式构建（即相同的 CRT 链接、优化等），以便在彼此之间与库对象进行通信。但这在很大程度上可以通过某些设计选择来解决。

关于“内联”，所有内容本质上都与仅标题库内联。

# c - 如何在 C 中将 48 位字节数组转换为 64 位整数？

> ID：10610409
> 
> 赞同：4
> 
> 时间：2012-05-15T23:58:50.710
> 
> 标签：c, endianness, unix-timestamp, type-conversion

我有一个大小为 6 的无符号字符数组。字节数组的内容是一个整数（4096 * 自 Unix 时间以来的秒数）。我知道字节数组是大端的。

C 中是否有一个库函数可用于将此字节数组转换为 int_64 还是必须手动执行？

谢谢！

PS：以防万一您需要更多信息，是的，我正在尝试解析 Unix 时间戳。[这](http://www.ccnx.org/releases/latest/doc/technical/Timestamp.html)是我处理的时间戳的格式规范。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T00:21:16.970

C99 实现可能会提供`uint64_t`（如果没有正好是 64 位的本机固定宽度整数，则不必提供），在这种情况下，您可以使用：

```
#include <stdint.h>

unsigned char data[6] = { /* bytes from somewhere */ };
uint64_t result = ((uint64_t)data[0] << 40) |
                  ((uint64_t)data[1] << 32) |
                  ((uint64_t)data[2] << 24) |
                  ((uint64_t)data[3] << 16) |
                  ((uint64_t)data[4] << 8)  |
                  ((uint64_t)data[5] << 0); 
```

如果您的 C99 实现不提供`uint64_t`，您仍然可以使用`unsigned long long` or (我认为) `uint_least64_t`。无论主机的本机字节顺序如何，这都将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:18:02.070

你试过这个：

```
unsigned char a [] = {0xaa,0xbb,0xcc,0xdd,0xee,0xff};
unsigned long long b = 0;
memcpy(&b,a,sizeof(a)*sizeof(char));
cout << hex << b << endl; 
```

或者您可以手动完成，这将避免一些特定于架构的问题。

我建议使用正常的整数运算（求和和移位），而不是尝试模拟内存块排序，这在兼容性方面并不比上述解决方案好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-15T21:58:53.103

我认为最好的方法是使用工会。

```
union time_u{
    uint8_t data[6];
    uint64_t timestamp;
} 
```

然后，您可以通过引用将该内存空间用作字节数组或 uint64_t

```
union time_u var_name;
var_name.data[i]
var_name.timestamp 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-08T10:22:49.510

这是一种将其转换为 64 位的方法：

```
uint64_t
convert_48_to_64(uint8_t *val_ptr){
  uint64_t ret = 0;
  uint8_t *ret_ptr = (uint8_t *)&ret;

  for (int i = 0; i < 6; i++) {
      ret_ptr[5-i] = val_ptr[i];
  }
  return ret;
 }

 convert_48_to_64((uint8_t)&temp);  //temp is in 48 bit 
```

例如：num_in_48_bit = 77340723707904；这个数字在48位二进制为：0100 0110 0101 0111 0100 1010 0101 1101 0000 0000 0000 0000转换的64位二进制会后：0000 0000 0000 0000 0000 0000 0000 0000 0101 1101 0100 1010 0101 0111 0100 0110比方说val_ptr店num_in_48_bit 的基地址。由于指针类型转换为 uint8_t，递增 val_ptr 将为您提供下一个字节。循环并逐字节复制值。请注意，我也在按字节顺序处理网络。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-08-02T08:21:37.173

您可以使用打包选项

```
#pragma pack(1) 
```

或者

```
__attribute__((packed)) 
```

取决于编译器

```
typedef struct __attribute__((packed))
{
    uint64_t u48: 48;
} uint48_t;

uint48_t data;

memcpy(six_byte_array, &data, 6);
uint64_t result = data.u48; 
```

看

*   [_int64 位字段](https://stackoverflow.com/q/9578988/995714)
*   [如何为位掩码创建 48 位 uint](https://stackoverflow.com/q/26197928/995714)
*   [如果 32 位整数溢出，我们可以使用 40 位结构而不是 64 位长的结构吗？](https://stackoverflow.com/q/27705409/995714)
*   [哪种 C 数据类型可以表示 40 位二进制数？](https://stackoverflow.com/q/9595225/995714)

# eclipse - Eclipse 与 Netbeans 基准测试

> ID：10610410
> 
> 赞同：5
> 
> 时间：2012-05-15T23:58:54.347
> 
> 标签：eclipse, performance, netbeans, ide

是否有任何基准或研究比较这两个 IDE

-- 稳定性 -- 开发者生产力 -- 特性 -- 性能 -- 等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T21:29:23.977

我是 Eclipse 用户（不是自愿的）。不确定稳定性，但在性能方面，NetBeans 至少在我工作的最新版本中要好得多；就个人而言，我认为 NetBeans 有足够的特性使其成为一个良好的开发环境，但我不能肯定地告诉你，这取决于你的任务范围。总的来说，eclipse 是一个不错的 IDE，但 NetBeans 稍微好一点……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-28T16:51:50.363

除非您有很多硬件可以使用，否则请使用 Netbeans。

我有一个运行 CentOS 7 的 VM。此时，我只能为 VM 分配 2G ram，并且在其上运行 Eclipse Oxygen for PHP**非常缓慢**。Netbeans 在此配置中运行良好。

我敢肯定，一些 Eclipse 爱好者会建议给 VM 更多的内存，这可能会解决这个问题，但不幸的是，目前还不可能。

应该提到的另一件事是 Eclipse 在其 UI 方面相当独特。例如，地球上几乎每个编辑器都使用 Ctrl-F 来**“**查找”，然后使用功能键**F3**来“查找下一个”。Ctrl-G 是“**转到**行号”。Netbeans 遵循此约定。然而，Eclipse 使用 Ctrl-K 来“查找下一个”，使用 Ctrl-L 来表示“行**号**”。

如果您只使用 Eclipse 而不是其他的，这不会是一个问题，但是如果您喜欢更典型的开发人员，您可以在适当的时候使用 Eclipse 以及在适当的时候使用其他一些工具。有时您**会**感到困惑并使用错误的快捷方式。这会产生不可预知的问题，特别是如果您不确定错误的快捷方式刚刚对您的文件做了什么。

根据应用程序，这不是“性能”问题，但它**会减慢开发人员的速度**。对我来说，这同样糟糕。

同样，一些 Eclipse 爱好者可能会建议 Eclipse 快捷方式可以按照您喜欢的方式进行配置，这是真的，但*真的*，有人有这样的时间吗？Eclipse 带有*数以千计*的配置选项，它是一个互联网搜索来找出如何更改几乎任何东西。

Netbeans 没有数以千计的配置选项，尽管您可以调整一些东西。它只是有点像你期望的开箱即用的方式。

总而言之，在不是最强大的硬件上的实际缓慢可能是对 Eclipse 最大的影响。我不知道代码试图做什么，但 Netbeans 以某种方式能够用更少的硬件做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-16T20:16:03.707

现在主要使用eclipse。

我只能说M2E是一种痛苦。无意冒犯 m2e 的开发人员……这简直是 maven 绝对最糟糕的插件。它很慢，使用起来很痛苦。对于具有 70 多个模块组件的大型 maven 项目，您可以忘记拥有一个快速的 eclipse 环境。

如果您使用 mvn eclipse:eclipse，这是一个已弃用的配置 eclipse 的插件，我相信您使用 eclipse 比使用 netbeans 更快。尤其是在重构方面。

相反，如果您使用官方的 m2e 插件...我的天哪！

由于等待日食的纯粹剪切痛苦，我正在回答这个问题。“调用 CDI 构建器”，因为 @Inject 协作者在课堂上四处走动，引发了巨大的构建等待时间延迟……天哪！

蚀！嗯... Eclipse 是一个很好的入门 IDE，适用于小型项目，但随着项目进入企业级，如果您使用 m2e...哦！你会哭的！并且想知道......它怎么会这么糟糕。

网豆！也许最后没有更好。上次我使用 Netbeans 时，我有两个主要的抱怨，那就是彻底破坏交易： (a) Netbeans 在处理大规模类重构时简直是糟糕透了。您更改了子模块 A 上的类名，这会影响模块 B、C 和 D。在您重命名类之前，移动包完成，您可以去喝杯咖啡，然后叫辆出租车。

(b) netbeans 在解析接口时有一个错误，即有某种正则表达式需要最长时间才能运行。因此，如果您可以使用旧的已弃用的 mvn eclipse:eclipse，您最终会变得更好。

照这样说。与 eclipse 调试器相比，Netbeans 调试器要好很多光年。我更喜欢 netbeans 的图形，我更喜欢 netbeans 的简单性。只需尝试使用自动完成不起作用的“表达式”，您必须转到“显示”以使自动完成工作并将其复制到表达式中！Eclipse 是一个补丁工作，数十万开发人员制作了数百个不同的 IDE 组件，导致产品的整体结果完全不一致。

Eclipse 是一组永无止境的设置，只需打开首选项并...

Netbeans，UI 总是设计最简单。

当我等待我的 m2e 完成基于 Eclipse 开始新构建的任何突发奇想的项目时，我开始再次考虑是否应该重新访问 Netbeans 并安装 Eclipse 格式化程序......

Eclipse 真的很糟糕，在我看来。eclipse 的性能必须提高 100 倍，尤其是 eclipse + m2e 必须变得更好。Intelli J - 我从未尝试过。

到目前为止，最好的 IDE 毫无疑问是用于 Javascript 和 TypeScript 的 Microsfot Visual Code。

您使用 Microsoft Visual Code，只是想知道为什么 eclipse 不是那样的。如果您正在使用 Angular Js/Typecipt，只需忘记那里的任何其他 IDE。Microsoft Visual Code 是最好的东西，使用起来非常棒且令人愉悦。
在您想要的每个平台上快速、轻巧且美观。

但是对于 java + maven，echo 系统有点缺乏好的选择。这个人不应该等待机器。一个人总是应该比机器慢......这不是eclipse m2e的情况，我可以告诉你。烦恼！！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-28T10:43:11.223

Eclipse 和 Netbeans 都是很好的 IDE（集成开发环境）程序。如果您只是 Java、C++、C 或 Fortran 程序员，您可以使用其中任何一种。如果您是 WEB 基础开发人员（例如：JSF、Serverlet、Applet），在这种情况下，NetBeans 比 Eclipse 强大得多。另一方面，如果您是 Android 操作系统的移动开发人员，在这种情况下，Eclipse 比 Netbeans 强大得多。所以这取决于你的编程联盟:)))

# sql-server - CASE（包含）而不是相等声明

> ID：10610412
> 
> 赞同：22
> 
> 时间：2012-05-15T23:59:11.100
> 
> 标签：sql-server, sql-server-2008

在case语句中是否有使用包含而不是相等的方法？

例如，我正在检查一个数据库表是否有一个条目

```
lactulose, Lasix (furosemide), oxazepam, propranolol, rabeprazole, sertraline, 
```

我可以用吗

```
CASE When dbo.Table.Column = 'lactulose' Then 'BP Medication' ELSE '' END AS 'BP Medication' 
```

这没有用。

提前致谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-16T00:05:34.537

```
CASE WHEN ', ' + dbo.Table.Column +',' LIKE '%, lactulose,%' 
  THEN 'BP Medication' ELSE '' END AS [BP Medication] 
```

添加了前导`', '`和尾随`','`，以便您可以处理匹配，而不管它在字符串中的什么位置（第一个条目、最后一个条目或介于两者之间的任何位置）。

也就是说，为什么要将要搜索的数据存储为逗号分隔的字符串？这违反了各种形式和最佳实践。您应该考虑规范化您的架构。

另外：不要`'single quotes'`用作标识符分隔符；此语法已弃用。使用`[square brackets]`（首选）或`"double quotes"`如果必须。请参阅此处的“字符串文字作为列别名”：http: [//msdn.microsoft.com/en-us/library/bb510662%28SQL.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb510662%28SQL.100%29.aspx)

**编辑**如果你有多个值，你可以这样做（你不能用其他`CASE`语法变体或使用类似的东西来简写它`IN()`）：

```
CASE 
  WHEN ', ' + dbo.Table.Column +',' LIKE '%, lactulose,%' 
  WHEN ', ' + dbo.Table.Column +',' LIKE '%, amlodipine,%' 
  THEN 'BP Medication' ELSE '' END AS [BP Medication] 
```

如果您有更多值，则可能值得使用拆分功能，例如

```
USE tempdb;
GO

CREATE FUNCTION dbo.SplitStrings(@List NVARCHAR(MAX))
RETURNS TABLE
AS
   RETURN ( SELECT DISTINCT Item FROM
       ( SELECT Item = x.i.value('(./text())[1]', 'nvarchar(max)')
         FROM ( SELECT [XML] = CONVERT(XML, '<i>'
         + REPLACE(@List,',', '</i><i>') + '</i>').query('.')
           ) AS a CROSS APPLY [XML].nodes('i') AS x(i) ) AS y
       WHERE Item IS NOT NULL
   );
GO

CREATE TABLE dbo.[Table](ID INT, [Column] VARCHAR(255));
GO

INSERT dbo.[Table] VALUES
(1,'lactulose, Lasix (furosemide), oxazepam, propranolol, rabeprazole, sertraline,'),
(2,'lactulite, Lasix (furosemide), lactulose, propranolol, rabeprazole, sertraline,'),
(3,'lactulite, Lasix (furosemide), oxazepam, propranolol, rabeprazole, sertraline,'),
(4,'lactulite, Lasix (furosemide), lactulose, amlodipine, rabeprazole, sertraline,');

SELECT t.ID
  FROM dbo.[Table] AS t
  INNER JOIN dbo.SplitStrings('lactulose,amlodipine') AS s
  ON ', ' + t.[Column] + ',' LIKE '%, ' + s.Item + ',%'
  GROUP BY t.ID;
GO 
```

结果：

```
ID
----
1
2
4 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-16T00:19:05.623

伪代码，例如：

```
CASE
  When CHARINDEX('lactulose', dbo.Table.Column) > 0 Then 'BP Medication'
ELSE ''
END AS 'Medication Type' 
```

这不关心关键字在列表中的位置，并避免依赖于空格和逗号的格式。

# php - php中的树搜索（来自数据库的数据）

> ID：10610417
> 
> 赞同：-3
> 
> 时间：2012-05-16T00:00:22.037
> 
> 标签：php

我目前正在处理一个要求成员在另一个成员下注册的应用程序。一个成员下最多可以有5个成员，每个成员下也可以有成员。请问我如何实现某种搜索以使用 php 获取特定成员下的所有成员？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:16:38.063

我建议您尝试实现嵌套集模型。在这里解释有点复杂，但只需几行代码，但这里有一些链接可以帮助您入门：

[http://en.wikipedia.org/wiki/Nested_set_model](http://en.wikipedia.org/wiki/Nested_set_model)

[http://threebit.net/tutorials/nestedset/tutorial1.html](http://threebit.net/tutorials/nestedset/tutorial1.html)

# c++ - CLR C++ 中的 GMFBridge 设置

> ID：10610422
> 
> 赞同：0
> 
> 时间：2012-05-16T00:01:05.263
> 
> 标签：c++, clr, directshow

我正在尝试使用 CLR 创建一个用于网络摄像头捕获的 C++ 表单。我想在其上使用 Directshow 和 GMFBridge，以便我可以捕获和预览视频，但我不确定如何让 GMFBridge 以 C++ CLR 形式工作。我会在 GMFBridge 的所有内容上调用 [DllImport] 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T21:26:35.410

或者我可以在 CLR 项目“Common Solutions”中添加对 dll 的引用。因为这完全没有出现在谷歌搜索中，也不知道添加参考选项被移到了那里。>_>

# asp.net - 使用 Nginx + FastCGI-Mono-Server4 从 ASP.Net 3.5 迁移到 4.0 后出错

> ID：10610423
> 
> 赞同：1
> 
> 时间：2012-05-16T00:01:12.137
> 
> 标签：asp.net, .net-4.0, nginx, fastcgi-mono-server

我正在使用 Nginx + FastCGI-Mono-Server 来托管一个小型的 asp.net Web 服务。使用 FastCGI-Mono-Server2（即 .Net 2.0 版本）运行良好。我现在需要将 asp.net 应用程序升级到 .net 4.0。这意味着我需要升级到 FastCGI-Mono-Server4。我把所有正确的文件都放好了。有用！但是，它总是因一个神秘的错误而崩溃。

这是错误：

异常：System.Runtime.FatalException

消息：对象引用未设置为对象的实例。

StackTrace：在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher .ImmutableDispatchRuntime.ProcessMessage2(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)在 System.ServiceModel.Dispatcher.ChannelHandler.DispatchAndReleasePump（RequestContext 请求，布尔型 cleanThread，OperationContext currentOperationContext) 在 System.ServiceModel.Dispatcher.ChannelHandler.OnAsyncReceiveComplete(IAsyncResult result) 在 System.ServiceModel.Dispatcher.ChannelHandler.AsyncMessagePump(IAsyncResult result) 在 System.ServiceModel.Dispatcher.ChannelHandler.HandleRequest(RequestContext request, OperationContext currentOperationContext) 在 System .Runtime.Fx.AsyncThunk.UnhandledExceptionFrame(IAsyncResult 结果) 在 System.Runtime.AsyncResult.Complete(Boolean completedSynchronously) 在 System.ServiceModel.Channels.FramingDuplexSessionChannel.TryReceiveAsyncResult.OnReceive(IAsyncResult 结果) 在 System.Runtime.Fx.AsyncThunk.UnhandledExceptionFrame （IAsyncResult 结果）在 System.ServiceModel.Channels.SynchronizedMessageSource 的 System.Runtime.AsyncResult.Complete（Boolean completedSynchronously）。System.ServiceModel.Channels.SocketConnection.FinishRead() 的 System.ServiceModel.Channels.SessionConnectionReader.OnAsyncReadComplete(Object state) 的 System.ServiceModel.Channels.SocketConnection.AsyncReadCallback 的 ReceiveAsyncResult.OnReceiveComplete(Object state) (Boolean haveResult, Int32 错误, Int32 bytesRead）在 System.ServiceModel.Channels.OverlappedContext.CompleteCallback（UInt32 错误，UInt32 numBytes，NativeOverlapped* nativeOverlapped）在 System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame（UInt32 错误，UInt32 bytesRead，NativeOverlapped* nativeOverlapped）在 System.Threading。 _IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)OnAsyncReadComplete(Object state) at System.ServiceModel.Channels.SocketConnection.FinishRead() at System.ServiceModel.Channels.SocketConnection.AsyncReadCallback(Boolean haveResult, Int32 error, Int32 bytesRead) at System.ServiceModel.Channels.OverlappedContext.CompleteCallback(UInt32 error , UInt32 numBytes, NativeOverlapped* nativeOverlapped) 在 System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 错误, UInt32 bytesRead, NativeOverlapped* nativeOverlapped) 在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)OnAsyncReadComplete(Object state) at System.ServiceModel.Channels.SocketConnection.FinishRead() at System.ServiceModel.Channels.SocketConnection.AsyncReadCallback(Boolean haveResult, Int32 error, Int32 bytesRead) at System.ServiceModel.Channels.OverlappedContext.CompleteCallback(UInt32 error , UInt32 numBytes, NativeOverlapped* nativeOverlapped) 在 System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 错误, UInt32 bytesRead, NativeOverlapped* nativeOverlapped) 在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)OverlappedContext.CompleteCallback(UInt32 error, UInt32 numBytes, NativeOverlapped* nativeOverlapped) at System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 error, UInt32 bytesRead, NativeOverlapped* nativeOverlapped) at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes,本机重叠* pOVERLAP)OverlappedContext.CompleteCallback(UInt32 error, UInt32 numBytes, NativeOverlapped* nativeOverlapped) at System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 error, UInt32 bytesRead, NativeOverlapped* nativeOverlapped) at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes,本机重叠* pOVERLAP)

内部异常：System.NullReferenceException

消息：对象引用未设置为对象的实例。

StackTrace：在 System.Web.HttpApplication.OnThreadEnterPrivate(Boolean setImpersonationContext) 在 System.Web.HttpApplication.ThreadContext.Enter(Boolean setImpersonationContext) 在 System.Web.AspNetSynchronizationContext.CallCallbackPossiblyUnderLock(SendOrPostCallback 回调，对象状态) 在 System.Web.AspNetSynchronizationContext。 CallCallback(SendOrPostCallback callback, Object state) at System.Web.AspNetSynchronizationContext.Post(SendOrPostCallback callback, Object state) at System.ServiceModel.Dispatcher.ThreadBehavior.BindCore(MessageRpc& rpc, Boolean startOperation) at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4 (MessageRpc&rpc)

我在项目中有一个 IHttpAsyncHandler 。我想知道它是否与此有关。当我搜索我的错误时，我发现有人（例如：[更新到 .net 4.0 后的 wcf 回调异常](https://stackoverflow.com/questions/2959704/wcf-callback-exception-after-updating-to-net-4-0)）推荐此属性：

[回调行为（UseSynchronizationContext=false）]

据我所知，这是 WCF 的事情，与我的 asp.net Web 服务器无关。任何想法，将不胜感激！

电动汽车

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T08:37:13.920

跑

```
ln -s /opt/mono-3.2/lib/mono/4.0/fastcgi-mono-server4.exe /opt/mono-3.2/lib/mono/4.5/fastcgi-mono-server4.exe 
```

和

从 4.5 目录使用 fastcgi 服务器

```
/opt/mono-3.2/lib/mono/4.5/fastcgi-mono-server4.exe 
```

如果 Mono 安装在其他地方，请替换`/opt/mono-3.2`为您的单声道前缀

# ruby-on-rails - RailsDevTweaks：跳过此请求的 ActionDispatch::Reloader 挂钩

> ID：10610426
> 
> 赞同：2
> 
> 时间：2012-05-16T00:01:41.997
> 
> 标签：ruby-on-rails

在我的控制器中更改并保存了一些代码后，RailsDevTweaks 似乎忽略了这一事实并且不会重新加载代码。在日志中它说：

```
RailsDevTweaks: Skipping ActionDispatch::Reloader hooks for this request. 
```

除了不使用 RailsDevTweaks 之外，如何在更改后重新加载它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:04:11.043

事实证明，这只发生在 AJAX 请求上。查看配置选项后，将其添加到我的应用程序配置中可以修复它：

```
config.dev_tweaks.autoload_rules do
  keep :xhr  # Disables caching all ajax requests
end 
```

# asp.net-mvc - reCAPTCHA MVC3 问题

> ID：10610437
> 
> 赞同：1
> 
> 时间：2012-05-16T00:03:50.053
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, recaptcha

我几乎尝试了所有方法，但无法使其正常工作。

我可以在我的控制器中使用 dll，但无法在视图中呈现。

```
 [RecaptchaControlMvc.CaptchaValidator]
    public ActionResult LogOn(LogOnModel model, string returnUrl) 
```

我的 Razor 视图中没有 @ReCaptcha.GetHtml(theme: "red") 选项，只有[http://prntscr.com/9agkf](http://prntscr.com/9agkf)

我的 Razor 视图中有此代码

```
 @Html.GenerateCaptcha() 
```

任何终于看起来我得到了什么[截图](http://prntscr.com/9agl2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:58:35.923

在此处查看我的答案 [如何在 MVC3 应用程序中实现 Google reCaptcha？](https://stackoverflow.com/questions/9740402/how-to-have-captcha-functionality-like-stackoverflow-in-my-mvc3-application/9740583#9740583)

它详细说明了在 MVC 3 中正确生成 reCaptcha 的需求

# c# - filestream 文件共享访问由2个进程同时读写

> ID：10610443
> 
> 赞同：1
> 
> 时间：2012-05-16T00:05:03.373
> 
> 标签：c#, asp.net

我有一个原始网站，其中 aspx webform 和套接字服务器访问存储数据的平面文件。套接字服务器将访问要写入的完全相同的文件，这些文件由 aspx c# 代码访问以进行读取。我认为锁定文件可能存在问题。我认为服务器快速写入文件并释放文件上的任何锁定是更高的优先级。网络表单应该能够在不中断服务器写入过程的情况下进行读取。做这个的最好方式是什么？是使用streamwriter吗？

服务器使用此调用，仅在写入文件时共享文件以供读取。

```
 if (!File.Exists(filepath))
                    {
                        using (FileStream fileStream = new FileStream(filepath, FileMode.CreateNew, FileAccess.Write, FileShare.Read))
                        {
                            using (TextWriter writer = new StreamWriter(fileStream))
                            {
                                writer.WriteLine(data);
                                m_clientSocket.Send(BitConverter.GetBytes(data.Length));
                            }
                        }
                    }
                    else
                    {
                        using (FileStream fileStream = new FileStream(filepath, FileMode.Append, FileAccess.Write, FileShare.Read))
                        {
                            using (TextWriter writer = new StreamWriter(fileStream))
                            {
                                writer.WriteLine(data);
                                m_clientSocket.Send(BitConverter.GetBytes(data.Length));
                            }
                        }
                    } 
```

使用以下命令读取的网络表单

```
 using (FileStream stream = new FileStream(filepath, FileMode.Open, FileAccess.Read, FileShare.Read))
        {
            using (TextReader reader = new StreamReader(stream))
            {
                //string fileContents = tr.ReadToEnd();
                while ((line = reader.ReadLine()) != null)
                {
                    if (!string.IsNullOrEmpty(line))
                    {
                        lines.Add(line);
                    }
                }
            }
        } 
```

我希望这可以工作，而不必锁定文件和管理访问，我不知道该怎么做。我希望能够让服务器随时锁定文件以进行写入，但也允许 aspx 网页 c# 代码读取相同的文件。

任何帮助表示赞赏。

# python - Python列表转置和填充

> ID：10610445
> 
> 赞同：10
> 
> 时间：2012-05-16T00:05:16.400
> 
> 标签：python, list, fill, transpose

我有一个列表列表，每个内部列表的长度为 1 或 n（假设 n > 1）。

```
>>> uneven = [[1], [47, 17, 2, 3], [3], [12, 5, 75, 33]] 
```

我想转置列表，但不是截断较长的列表（如`zip`）或用 填充较短的列表`None`，我想用它们自己的奇异值填充较短的列表。换句话说，我想得到：

```
>>> [(1, 47, 3, 12), (1, 17, 3, 5), (1, 2, 3, 75), (1, 3, 3, 33)] 
```

我可以通过几次迭代来做到这一点：

```
>>> maxlist = len(max(*uneven, key=len))
>>> maxlist
4
>>> from itertools import repeat
>>> uneven2 = [x if len(x) == maxlist else repeat(x[0], maxlist) for x in uneven]
>>> uneven2
[[1, 1, 1, 1], [47, 17, 2, 3], [3, 3, 3, 3], [12, 5, 75, 33]]
>>> zip(*uneven2)
[(1, 47, 3, 12), (1, 17, 3, 5), (1, 2, 3, 75), (1, 3, 3, 33)] 
```

但是有更好的方法吗？我真的需要`maxlist`提前知道才能做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T00:29:08.230

You can repeat one element list forever:

```
uneven = [[1], [47, 17, 2, 3], [3], [12, 5, 75, 33]]

from itertools import repeat

print zip(*(repeat(*x) if len(x)==1 else x for x in uneven)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T00:30:14.927

You could use [`itertools.cycle()`](http://docs.python.org/library/itertools.html#itertools.cycle) instead:

```
>>> from itertools import cycle
>>> uneven3 = [x if len(x) != 1 else cycle(x) for x in uneven]
>>> zip(*uneven3)
[(1, 47, 3, 12), (1, 17, 3, 5), (1, 2, 3, 75), (1, 3, 3, 33)] 
```

That means you don't need to know `maxlist` ahead of time.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T12:29:52.273

我真的很喜欢@chris-morgan 的模拟想法`itertools.izip_longest`，所以当我终于有了灵感时，我写了一个`izip_cycle`函数。

```
def izip_cycle(*iterables, **kwargs):
    """Make an iterator that aggregates elements from each of the iterables.
    If the iterables are of uneven length, missing values are filled-in by cycling the shorter iterables.
    If an iterable is empty, missing values are fillvalue or None if not specified.
    Iteration continues until the longest iterable is exhausted.
    """
    fillvalue = kwargs.get('fillvalue')
    counter = [len(iterables)]
    def cyclemost(iterable):
        """Cycle the given iterable like itertools.cycle, unless the counter has run out."""
        itb = iter(iterable)
        saved = []
        try:
            while True:
                element = itb.next()
                yield element
                saved.append(element)
        except StopIteration:
            counter[0] -= 1
            if counter[0] > 0:
                saved = saved or [fillvalue]
                while saved:
                    for element in saved:
                        yield element
    iterators = [cyclemost(iterable) for iterable in iterables]
    while iterators:
        yield tuple([next(iterator) for iterator in iterators])

print list(izip_cycle([], range(3), range(6), fillvalue='@')) 
```

# iphone - 何时设置 rootViewController 或添加子视图到主窗口

> ID：10610446
> 
> 赞同：1
> 
> 时间：2012-05-16T00:05:16.597
> 
> 标签：iphone, objective-c, ipad

我知道在 中 `AppDelegate.m`，您必须为应用程序设置根控制器。否则，您将在您的应用程序中看不到任何内容并收到警告。

我发现一些材料使用：

```
[window addSubview:anyViewController.view]; 
```

或使用：

```
window.rootViewController = anyViewController; 
```

这两种方法都可以使 App 正确启动。我不明白为什么第一种方法没有为用户设置 rootviewController，但它仍然运行良好。为什么是这样？它们之间有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T00:18:33.587

`rootViewController`是随 iOS4 添加的，是较新且推荐的方法。

# jquery - Jquery向表单添加“其他” - 将正确的变量传递到数据库

> ID：10610449
> 
> 赞同：0
> 
> 时间：2012-05-16T00:05:25.830
> 
> 标签：jquery

我在表单中使用 Select 并具有显示“其他”文本输入框的“其他”选项。但是，我只想将实际值保存在表的同一列中，因此我需要确保将“其他”文本输入的“值”传递给 MySQL 表，而不是选定的内容，这显然是“其他” "

```
<div>
  <select class="element select small" id="prop_title" name="prop_title">
    <option value="Mr" >Mr</option>
    <option value="Mrs" >Mrs</option>
    <option value="Sir" >Sir</option>
    <option value="Lord" >Lord</option>
    <option value="Other">Other</option>
  </select>
  <div id="prop_title_other" style="display: none; margin-top:15px;">
    <label class="description" for="prop_title">Proprietor Title (Other)</label>
    <input type="text" id="prop_title" class="element text small" value=""/>
  </div>
</div> 
```

```
$('#prop_title').change(function() 
{
  $('#prop_title_other').css('display', ($(this).val() == 'Other') ? 'block' : 'none');
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:09:15.627

你`$(this)`成为文本框的对象。那就是你有这个问题。更改`$(this)`为局部变量

```
$('#prop_title').change(function() 
{
  var item=$(this);
   $('#prop_title_other').css('display', (item.val() == 'Other') ? 'block' : 'none');
}); 
```

工作样本：http: [//jsfiddle.net/GbGbU/](http://jsfiddle.net/GbGbU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:10:15.840

```
$('#prop_title').change(function() 
{
  var display;

  if ($(this).val() == 'Other') {
       display = "none";      
  }  else { display = "block"};

  $('#prop_title_other').css('display', display);

}); 
```

# php - PHP：从 php 文件中获取变量？

> ID：10610452
> 
> 赞同：1
> 
> 时间：2012-05-16T00:05:31.243
> 
> 标签：php

我正在创建一个允许用户安装不同主题的 php 应用程序。每个主题目录都必须放在“主题”目录中。每个主题必须有一个名为的文件，该文件`theme_profile.php`具有主题规范，例如主题名称等...

所以这个 theme_profile.php 有一堆变量包装在一个名为 $theme 的数组中，`($theme["title"]="My theme"`等等......）

现在我希望我的应用程序索引文件在不简单地“包含”文件的情况下获取这些变量（如果将恶意代码放置在此文件中，这是有风险的）。

有没有什么之类的`get_variables_from_file("file.php")`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:11:14.880

没有必要为此目的使用 php 文件。只需创建 XML 或任何其他数据文件类型并在 PHP 代码中解析它们。这要安全得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:25:27.400

Having a look at this answer on another question may send you in the right direction : [https://stackoverflow.com/a/1858294/303657](https://stackoverflow.com/a/1858294/303657)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-04T16:39:23.677

如其他答案所述，在这种情况下不需要使用 PHP。实际上最好使用数据文件。（如 XML、JSON 等）

这是一个示例 JSON 编码文件：

```
// first create the $theme array
$theme['title'] = '...';
$theme['...'] = '...';

// then json encode it
$themeJson = json_encode($theme);

// put it in a file
file_put_contents('theme_profile.json', $themeJson); 
```

出于加载目的，只需使用[json_decode 函数](http://php.net/manual/en/function.json-decode.php)。

您也可以以相同的方式使用[PHP 序列化。](http://php.net/manual/en/function.serialize.php)

# c# - 嵌套通用语法歧义>>

> ID：10610459
> 
> 赞同：12
> 
> 时间：2012-05-16T00:06:40.397
> 
> 标签：c#, lexer, nested-generics

显然，C# 和[C++](https://stackoverflow.com/questions/5771131/nested-templates-vs-shift-operator)一样容易受到“>>”词法分析器困境的影响。

这段 C# 代码非常有效，它编译并运行得很好：

```
var List = new Dummy("List");
var Nullable = new Dummy("Nullable");
var Guid = new Dummy("Guid");

var x = List<Nullable<Guid>> 10;
var y =  List<Nullable<Guid>> .Equals(10,20); 
```

您必须为上面的 Dummy 类重载 '<' 和 '>>' 运算符。

但是编译器设法猜测在“x”情况下的含义是使用 List、Nullable 和 Guid 局部变量。在“y”的情况下，它突然决定将它们视为知名类型的名称。

这是另一个示例的更详细描述：http: [//mihailik.blogspot.co.uk/2012/05/nested-generics-c-can-be-stinky.html](http://mihailik.blogspot.co.uk/2012/05/nested-generics-c-can-be-stinky.html)

问题是：C# 编译器如何将 'a<b<c>>' 解析为算术表达式或泛型类型/方法？

在成功之前，它肯定不会尝试对程序的文本进行多次“遍历”，或者是吗？这将需要无限的前瞻，而且也非常复杂。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T19:12:59.187

我已被定向到 C# 语言规范中的第 7.6.4.2 段：

[http://download.microsoft.com/download/0/B/D/0BDA894F-2CCD-4C2C-B5A7-4EB1171962E5/CSharp%20Language%20Specification.htm](http://download.microsoft.com/download/0/B/D/0BDA894F-2CCD-4C2C-B5A7-4EB1171962E5/CSharp%20Language%20Specification.htm)

> 简单名称（第 7.6.2 节）和成员访问（第 7.6.4 节）的产生式可能会导致表达式语法中的歧义。

...

> 如果可以（在上下文中）将标记序列解析为以类型结尾的简单名称（第 7.6.2 节）、成员访问（第 7.6.4 节）或指针成员访问（第 18.5.2 节） -argument-list（第 4.4.1 节），检查紧跟在关闭 > 标记之后的标记。如果它是其中之一
> 
> ( ) ] } : ; , . ? == != | ^
> 
> 然后类型参数列表被保留为简单名称、成员访问或指针成员访问的一部分，并且丢弃标记序列的任何其他可能的解析。否则，类型参数列表不被认为是简单名称、成员访问或指针成员访问的一部分，即使没有其他可能的标记序列解析。请注意，在解析命名空间或类型名称（第 3.8 节）中的类型参数列表时，不会应用这些规则。

因此，当涉及到 type-argument-list 时，确实可能会出现模棱两可的情况，并且他们有一种廉价的方法来解决它，方法是提前查看一个标记。

这仍然是一个无限制的展望，因为在“>>”和后面的标记之间可能有 1 兆字节的评论，但至少规则或多或少是清楚的。最重要的是，不需要推测性的深度解析。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-16T01:20:17.147

**编辑：我坚持没有歧义：** 在你的例子中根本没有歧义。这永远不能被评估为`List<Guid?>`. 上下文（额外的 10 个）显示编译器如何解释它。

```
var x = List<Nullable<Guid>> 10; 
```

编译器会编译这个吗？：

```
var x = List<Guid?> 10; 
```

很明显它不会。所以我仍在寻找歧义。

OTOH，第二个表达式：

```
var y =  List<Nullable<Guid>> .Equals(10,20); 
```

必须评估为 a `List<Guid?>`，因为您正在调用该`.Equals`方法。同样，这可以用任何其他方式解释。

根本没有悖论。编译器完美解析它。我仍然想知道哪个是悖论。

你犯了一个大错误。编译器解释整个表达式，并使用语言语法来理解它们。它不会像您正在做的那样查看代码片段，而不考虑表达式的其余部分。

这些表达式根据[C# 语法](http://msdn.microsoft.com/en-us/library/aa664812%28v=vs.71%29.aspx)进行解析。并且语法足够清晰，可以正确解释代码。即在

```
var x = List<Nullable<Guid>> 10; 
```

很明显，10 是一个字面量。如果你跟进语法，你会发现： 10 是一个 * *literal*，所以它是 * *primary-no-array-creation-expression*，这是一个 * *primary-expression*，这是一个 * *unary-expression*，这是一个**乘法表达式*，这是一个 **加法表达式*。*如果您在 * >>*的右侧寻找加法表达式，您会发现它必须是 * *shift-expression ，因此 ** *>>*的左侧必须被解释为 **加法表达式*，依此类推。

如果您能够找到使用语法的不同方式并为相同的表达式获得不同的结果，那么，我将不得不同意您的观点，但让我不同意！

最后：

*   对人类来说非常混乱
*   对编译器来说绝对清晰明确

因为：

*   我们人类识别模式，提取我们熟悉的整个文本的片段，`List<Nullable<Guid>>`像我们想要的那样喜欢和解释它们
*   编译器不会像我们一样解释代码，而是采用熟悉的片段，例如`List<Nullable<Guid>>`. 他们获取整个表达式并将其与语言语法相匹配。

# mysql - MySQL 中这个 CREATE TRIGGER 语句的语法有什么问题？

> ID：10610460
> 
> 赞同：-1
> 
> 时间：2012-05-16T00:06:44.180
> 
> 标签：mysql, triggers

```
CREATE TRIGGER `lastedited` AFTER UPDATE ON `eng-jap`
FOR EACH ROW
BEGIN
UPDATE `mrhowtos_main`.`eng` 
SET `lastmodified` = CURRENT_TIMESTAMP WHERE `eng`.`english` = old.eng;
UPDATE `mrhowtos_main`.`jap` 
SET `lastmodified` = CURRENT_TIMESTAMP WHERE `jap`.`japanese` = old.jap;
END; 
```

MySQL返回的错误是：MySQL说：文档

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds
to your MySQL server version for the right syntax to use near '' at line 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:35:36.790

```
#START TRIGGER
    delimiter $$
    CREATE TRIGGER `lastedited` AFTER UPDATE ON `eng-jap`
    FOR EACH ROW
    BEGIN
    UPDATE `mrhowtos_main`.`eng` 
    SET `lastmodified` = CURRENT_TIMESTAMP WHERE `eng`.`english` = old.eng;
    UPDATE `mrhowtos_main`.`jap` 
    SET `lastmodified` = CURRENT_TIMESTAMP WHERE `jap`.`japanese` = old.jap;
    END;
    $$ 
```

如果仍然无法正常工作，请尝试将 old.eng 和 old.jap 替换为静态值，例如“roma”

# sql - 为什么创建表时指定主键不为空？

> ID：10610462
> 
> 赞同：-1
> 
> 时间：2012-05-16T00:06:56.190
> 
> 标签：sql, sql-server, create-table

sql server中的一段sql

```
CREATE TABLE Persons
(
P_Id int NOT NULL PRIMARY KEY,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255)
) 
```

主键本质上是不为空的，为什么我们这里还要指定不为空呢？我想念什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:10:11.603

是的，根据定义，“主键”是“非空”。

问：您反对多输入八个字符吗？

问：您是否尝试过*省略*“not null”？怎么了？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:10:03.583

你不必使用它，它是多余的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T01:22:25.820

因为`Primary key`不会包含`NULL`值。该键是记录的标识符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T01:03:53.573

因为它是来自自动生成的脚本的复制粘贴，而 Not Null 来自列设置，而主键来自约束定义？

# php - 如何检查数组中的哪些值在 MySQL 中？

> ID：10610464
> 
> 赞同：0
> 
> 时间：2012-05-16T00:08:02.857
> 
> 标签：php, mysql, sql

我有一个值数组，我想检查它是否已经在数据库中。这个数组可以增长到 100 个元素。检查它的最佳方法是什么？我应该提取所有表数据然后检查它吗？应该/我可以在 1 个 SQL 语句中执行此操作吗？如果是这样，怎么做？我正在使用 PHP。

编辑：

我应该补充一点，我正在检查数据库中有哪些，然后我可以添加那些不在数据库中的。也许有比我想的更好的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:10:29.487

我假设 PHP

```
$sql = "SELECT name FROM tablename WHERE name IN ('".implode("','", $array_of_names)."')"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:11:20.030

像这样动态创建一个语句：

```
select *
from table
where value in (3, 5, 8, 12, 17, (etc)) 
```

以您使用的任何语言从数组中生成值列表。

# sql-server - 枢轴和过滤器

> ID：10610466
> 
> 赞同：0
> 
> 时间：2012-05-16T00:08:26.723
> 
> 标签：sql-server, tsql, sql-server-2005, pivot

我正在尝试创建一个动态 Pivot，但似乎无法使其正常工作。

桌子：

```
SELECT [CaseID], [ClientID]
from [RegData] 
```

目前退货：

```
CaseID--|ClientID| RecID
------------------------
7845107 |115172  |410
7845107 |164570  |1197
7845107 |115655  |416
7845107 |154244  |425
7856846 |116684  |151
7856846 |112354  |445
7455444 |115172  |492
7455444 |164570  |518
7455444 |115655  |1297
7455444 |154244  |681 
```

我需要它像这样返回：

```
CaseID--|Val1----|Val2----|Val3----|Val4----|
7845107 |115172  |164570  |115655  |154244  |
7856846 |116684  |112354  |        |        |
7455444 |115172  |164570  |115655  |154244  | 
```

然后，我需要找到 CaseID 不同但 VAL1、VAL2、VAL3 等相同的实例。

```
CaseID--|Val1----|Val2----|Val3----|Val4----|
7845107 |115172  |164570  |115655  |154244  |
7455444 |115172  |164570  |115655  |154244  | 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:53:17.157

这里有很多免责声明。依靠您只关心所有 4 个值都很重要的情况。我没有测试如果其中一个案例的第 5 个客户不匹配，或者如果有两个以上的案例具有相同的一组客户，会发生什么。它适用于您提供的示例数据，除了您希望在每个 Value1 / Value2 列等中看到的值以与示例输出不同的顺序显示。

```
DECLARE @x TABLE(CaseID INT, ClientID INT);

INSERT @x SELECT 7845107,115172 UNION ALL SELECT 7845107,164570
UNION ALL SELECT 7845107,115655 UNION ALL SELECT 7845107,154244
UNION ALL SELECT 7856846,116684 UNION ALL SELECT 7856846,112354
UNION ALL SELECT 7455444,115172 UNION ALL SELECT 7455444,164570
UNION ALL SELECT 7455444,115655 UNION ALL SELECT 7455444,154244;

;WITH x AS
(
  SELECT CaseID, ClientID, rn = ROW_NUMBER() OVER 
  (PARTITION BY CaseID ORDER BY ClientID) 
  FROM @x
),
y AS 
(
    SELECT x.CaseID, x.ClientID, x.rn
    FROM x INNER JOIN x AS x2
    ON x.CaseID <> x2.CaseID
    AND x.ClientID = x2.ClientID
    AND x.rn = x2.rn
)
SELECT CaseID, 
    Value1 = MAX(CASE WHEN rn = 1 THEN ClientID END),
    Value2 = MAX(CASE WHEN rn = 2 THEN ClientID END),
    Value3 = MAX(CASE WHEN rn = 3 THEN ClientID END),
    Value4 = MAX(CASE WHEN rn = 4 THEN ClientID END)
FROM y
GROUP BY CaseID; 
```

结果：

```
CaseID   Value1  Value2  Value3  Value4
-------  ------  ------  ------  ------
7455444  115172  115655  154244  164570
7845107  115172  115655  154244  164570 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T04:14:21.753

这就是我想出的。效率不是很高，但它确实有效......

我创建了一个表。我碰巧知道他们在系列中不超过 9 个相同的案例，因此是 Val9。

```
DECLARE 
    @totalRecords int,
    @counter int,
    @QueryCaseID int,
    @QueryClientID int,
    @queryVal1 int,
    @queryVal2 int,
    @queryVal3 int,
    @queryVal4 int,
    @queryVal5 int,
    @queryVal6 int,
    @queryVal7 int,
    @queryVal8 int,
    @queryVal9 int

Set @totalRecords = (Select count(*) from RegData) +1 
Set @counter = 1

-- Get the rows in the table and put them into the 'RegData_reformat' table
While @counter < @totalRecords
    Begin

        -- get the CASEID to cross query to reformatted table
        SET @QueryCaseID = (Select CaseID from RegData where RecID = @counter)

        -- get the ClientId to cross query to reformatted table
        SET @QueryClientID = (Select ClientID from RegData where RecID = @counter)

        -- assign the columns to variables
        SET @queryVal1 = (Select Val1 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal2 = (Select Val2 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal3 = (Select Val3 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal4 = (Select Val4 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal5 = (Select Val5 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal6 = (Select Val6 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal7 = (Select Val7 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal8 = (Select Val8 from RegData_reformat where CaseID = @QueryCaseID)
        SET @queryVal9 = (Select Val9 from RegData_reformat where CaseID = @QueryCaseID)

        --determine which column to insert the data into

--  Insert the data into the formatted table

        IF @queryVal1 IS NULL
            BEGIN
                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val1] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 2 test
        else IF @queryVal2 IS NULL
            BEGIN
                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val2] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 3 test
        else IF @queryVal3 IS NULL
            BEGIN
                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val3] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 4 test
        else IF @queryVal4 IS NULL
            BEGIN
                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val4] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 5 test            
        else IF @queryVal5 IS NULL
            BEGIN

                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val5] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 6 test
        else IF @queryVal6 IS NULL
            BEGIN

                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val6] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 7 test
        else IF @queryVal7 IS NULL
            BEGIN

                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val7] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 8 test
        else IF @queryVal8 IS NULL
            BEGIN

                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val8] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

    -- Column 9 test
        else IF @queryVal9 IS NULL
            BEGIN

                UPDATE [4DISCSReporting].[dbo].[RegData_reformat]
                SET [Val9] = @QueryClientID
                WHERE CaseID = @QueryCaseID
            END

        ELSE
            BEGIN
                print 'Ran out of columns to enter data into'
                Select 'FATAL ERROR: ran out of columns to enter data into' as Error
            END

    set @counter = @counter +1  

    END 
```

# jquery - jquery .each 迭代

> ID：10610468
> 
> 赞同：0
> 
> 时间：2012-05-16T00:08:46.500
> 
> 标签：jquery, asp.net, css, checkboxlist

我是学习 jquery 的新手，所以如果这是一个相对简单的问题，我深表歉意。我有一个 ID 为 ChartstoDisplay 的 asp.net 复选框列表。我正在尝试创建 jquery 来根据是否选中单个列表项复选框来回切换样式。我的代码在下面，样式“选定”应该更改为选中的粗体绿色文本的复选框，但没有任何反应。

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#ChartstoDisplay').click(function () {
            $('input').each(function () {
                if ($(this).is(':checked'))
                    $(this).toggleClass("selected");
            });
        });

    });
</script> 
```

我的理解是，'input'.each 正在遍历复选框列表中的项目以查找输入标签，然后下一行使用 this 变量检查复选框是否被选中，如果是，它应该会改变这是风格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:18:16.270

有用。不过，它可能不会做你想做的事。首先，你能告诉我们你附加了什么 CSS`.selected`吗？

它的作用是切换所有当前选中的框。假设你有盒子 A、B 和 C。

*   单击 A。选中框 A。框 A 被切换。选择的只有A。
*   单击 B。选中框 A 和 B。两者都被切换。选择的只有B。
*   单击 C。选中框 A、B 和 C。所有这些都被切换。现在选择了 A 和 C。
*   单击B，取消选中它。A 和 C 被选中，它们被切换（但不是 B）。没有任何选择。

如果这是您想要的，那太好了，但我想不出需要这种奇怪行为的单个应用程序。

我想你想要的是这样的：

```
$(document).ready(function () {
    $('#ChartstoDisplay').on("click", "input:checkbox", function() {
        $(this).toggleClass("selected");
    });
});​ 
```

**编辑：**鉴于小提琴中提供的代码 OP，这里是更新的答案（[小提琴](http://jsfiddle.net/77Mub/1/)）

```
$(document).ready(function() {
    $('#ChartstoDisplay').on("click", "input:checkbox", function() {
        $(this).next().toggleClass("selected");
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:17:44.033

必须有其他东西，因为您的代码似乎是有效的，只有几个最佳实践：

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#ChartstoDisplay').click(function () {
            $('input[type="checkbox"]:checked', this).toggleClass("selected");
        });
     });
</script> 
```

*   不要选择所有`input`s，只选择复选框。
*   仅选择单击列表下的复选框。
*   使用`:checked`选择器删除过滤检查。

[**演示**](http://jsfiddle.net/gdoron/zBB6g/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:20:45.193

`$('input').each(...)`正在遍历页面上的*所有*输入，而不仅仅是复选框，而不仅仅是属于“#ChartstoDisplay”的那些。对于每一个被检查的，它应该成功地切换类 - 我在你的代码中看不到任何会停止工作的东西，所以也许你可以显示你的 html？

您可以将代码简化为：

```
$('input:checked').toggleClass('selected'); 
```

这将切换所有匹配元素的类 - 无需使用`.each()`.

或者只是在“#ChartstoDisplay”中进行输入，这更接近您真正想要做的事情：

```
$('input:checked', this).toggleClass('selected'); 
```

将第二个参数传递给`$()`函数仅选择第二个参数上下文中的元素 - 我正在传递`this`，因为此时`this`将是“#ChartstoDisplay”，因为该代码行位于“#ChartstoDisplay”单击事件处理程序中。

# plsql - PLS-00103：遇到符号“，”时预期以下之一.... [PL/SQL]

> ID：10610470
> 
> 赞同：1
> 
> 时间：2012-05-16T00:09:36.240
> 
> 标签：plsql, oracle11g

我创建的功能：

```
SQL> create or replace function sum(first number,second number) return number is result number:= 0; begin  result:=first+second; return result; end sum;
2 /

Function created. 
```

这是我编译它的方法：

```
set serveroutput on;
begin
dbms_output.put_line(sum(1,1));
end;
/ 
```

编译后出现如下错误：

```
ERROR at line 2:
ORA-06550: line 2, column 27:
PLS-00103: Encountered the symbol "," when expecting one of the following:
) * & - + / at mod remainder rem <an exponent (**)> ||
multiset 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:57:42.687

我的猜测是，这与`SUM`PL/SQL 中的现有函数有关。尝试将您的函数名称更改为`MYSUM`或其他内容，看看是否可以修复它。

# php - 带有垂直数组和 PHP 数组的 Html 表

> ID：10610477
> 
> 赞同：2
> 
> 时间：2012-05-16T00:11:05.923
> 
> 标签：php, css, html-table

我有一个 PHP 数组，我想通过它递增并在表中输出信息。唯一的问题是 HTML 表格的组织方式。我想垂直输出数据。

例如 - 第一行显示一周中的每一天，然后在每一天的下方垂直显示某家餐厅供应的食物。它会从一周中的每一天直接显示 5 道菜。

由于表格被分成`<tr>`（水平），然后`<td>`只给你水平输出。所以我能想到答案的唯一方法是 PHP 答案或 CSS/html 答案。

```
Example:
TR - TD - TD - TD 
TR - TD - TD - TD 
TR - TD - TD - TD 
```

有没有办法`<tr>`垂直显示然后`<td>`水平分隔？

```
Example like this:
TR TR TR
|   |  |
TD TD  TD
|   |  |
TD TD  TD 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:30:44.043

弄清楚了。如果您添加`display: block`到`<td>`元素，那么它们就会开始堆叠在一起。也许我只是筋疲力尽并且想了很多答案...谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:14:33.950

像下面这样的东西会起作用。我猜到了您拥有的数据类型，但基本上您只需找到项目最多的`th`一天，为每一天创建一个`tr`，为最大一天中的尽可能多的项目创建一个，最后`td`为每一天创建一个打印对应于 for 循环计数器的项目。

```
<?php

$mon_arr = array("mon 1", "mon 2", "mon 3");
$tue_arr = array("tue 1", "tue 2", "tue 3", "tue 4");
$wed_arr = array("wed 1", "wed 2", "wed 3", "wed 4");
$thu_arr = array("thu 1", "thu 2");
$fri_arr = array("fri 1", "fri 2", "fri 3", "fri 4", "fri 5");
$sat_arr = array("sat 1");
$sun_arr = array("sun 1");

$week = array(
    "Monday"    => $mon_arr,
    "Tuesday"   => $tue_arr,
    "Wednesday" => $wed_arr,
    "Thursday"  => $thu_arr,
    "Friday"    => $fri_arr,
    "Saturday"  => $sat_arr,
    "Sunday"    => $sun_arr
);

$max_day = 0;

foreach($week as $day => $data){

    $current = count($data);

    if($current > $max_day){
        $max_day = $current;
    }
}

?>

<table>
    <thead>
        <tr>
            <?php
                foreach( $week as $day => $data ){
                    echo "<th>$day</th>";
                }
            ?>
        </tr>
    </thead>
    <tbody>

        <?php for( $i = 0; $i < $max_day; $i++ ){ ?>
        <tr>

            <?php
                foreach( $week as $day => $data ){

                    if( $data[$i] ){
                        echo "<td>$data[$i]</td>";
                    } else {
                        echo "<td>&nbsp;</td>";
                    }

                }
            ?>

        </tr>
        <?php } ?>

    </tbody>
</table> 
```

# jquery - jQuery 的 CDN 和 Far-Future 过期标头

> ID：10610486
> 
> 赞同：6
> 
> 时间：2012-05-16T00:12:27.610
> 
> 标签：jquery, jquery-mobile

# 问题

为什么从 jQuery 的 CDN 提供的内容缺少远期过期标头？（或者，“我在这里做错了什么？”）

## 背景

我在一个 Web 项目中使用 jQuery 和 jQuery Mobile。为了提供这些脚本，我[根据他们的指导](http://jquerymobile.com/blog/2012/04/13/announcing-jquery-mobile-1-1-0/#download)使用 jQuery 的 CDN 。但是，我注意到这些资源在没有远期过期标头的情况下提供，这会阻止浏览器智能地缓存它们。

尽管 jQuery 服务器会以 响应`304 Not Modified`，但这与完全否定该请求的过期标头不同。我意识到这里的简单答案是“因为他们没有”但是，我想知道他们为什么不这样做，如果有某种方式我可以提供这些内容，最好是来自 CDN，带有遥远的未来过期标头。

谢谢你的时间。

## 例子

### jQuery CDN

[http://code.jquery.com/jquery-1.6.4.min.js](http://code.jquery.com/jquery-1.6.4.min.js)

回复：

```
HTTP/1.1 304 Not Modified
Date: Wed, 16 May 2012 00:05:27 GMT
ETag: "9e68e84-16615-6ad9bfc0+gzip"
Last-Modified: Mon, 12 Sep 2011 22:55:03 GMT
Server: ECS (dca/532A)
Vary: Accept-Encoding
X-Cache: HIT 
```

### 谷歌 CDN

[https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js)

回复：

```
HTTP/1.1 200 OK
age:134505
cache-control:public, max-age=31536000
content-encoding:gzip
content-length:32103
content-type:text/javascript; charset=UTF-8
date:Mon, 14 May 2012 10:45:15 GMT
expires:Tue, 14 May 2013 10:45:15 GMT
last-modified:Mon, 02 Apr 2012 18:24:28 GMT
server:sffe
status:200 OK
vary:Accept-Encoding
version:HTTP/1.1
x-content-type-options:nosniff
x-xss-protection:1; mode=block 
```

请注意遥远的未来到期日期`expires:Tue, 14 May 2013 10:45:15 GMT`

## 解决方案

我正在使用 Microsoft 的 CDN 托管版本，它的有效期为 1 年：

[http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.0/jquery.mobile-1.1.0.min.js](http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.0/jquery.mobile-1.1.0.min.js)

[CDN 托管文件的完整列表](http://www.asp.net/ajaxLibrary/CDNjQueryMobile110.ashx)。

@zuul 在下面解释了为什么某些 CDN 托管项目的过期标头比其他项目长。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-16T00:31:11.057

整个缓存问题取决于您使用的链接。我观察到人们经常没有链接到 jQuery 的确切版本号。

**例如，您可以从 code.jquery.com 引用此文件...**

[http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js)

...而且您将始终获得最新的 jQuery 副本。

**或者你可以从谷歌做类似的事情......**

[http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js)

假设它以“1”开头，来自 Google 的那个将获得最新版本。问题是，当您使用这些引用时，您不会在缓存控制标头中设置一个遥远的到期日期。因此，用户的浏览器会过于频繁地检查更新，从而减慢您网站的加载时间。

**事实上，这里有几个选项及其到期设置的细分......**

[http://code.jquery.com/jquery-latest.min.js](http://code.jquery.com/jquery-latest.min.js) （无缓存）

[http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js（1](http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js) 小时）

[http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js（1](http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js) 小时）

[http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js（1](http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js) 年）

通过明确说明您希望 Google 发送回 1 年的 max-age 标头的确切版本的 jQuery。因此，您大大增加了客户端仅使用缓存副本的机会。如果新版本的 jQuery 带有错误修复或您真正想要的功能，那么只需更新您的链接。

* * *

这个解释来源于[BucketSoft 博客](http://blog.bucketsoft.com/2012/03/maximize-your-chances-of-caching-your.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-03T15:21:19.670

微软也有一个 CDN 托管 jquery 移动的东西：

[http://www.asp.net/ajaxLibrary/CDNjQueryMobile110.ashx](http://www.asp.net/ajaxLibrary/CDNjQueryMobile110.ashx)

**Expire-Date 是未来 1 年左右！**

# amazon-s3 - 通过 HTTP 标头在 Amazon S3 中为 .NET 开发工具包签名请求

> ID：10610488
> 
> 赞同：2
> 
> 时间：2012-05-16T00:13:22.887
> 
> 标签：amazon-s3

我正在尝试从 ASP.NET 应用程序访问 Amazon S3 内容。我正在使用适用于 .NET 的 AWS 开发工具包。目前，我正在使用 GetpreSignedURL() 函数对我的请求进行签名，然后将我的 IFrame src 设置为 URL。

```
s3Placeholder.Text = ListingObjects();

GetPreSignedUrlRequest request = new GetPreSignedUrlRequest()
    .WithBucketName(bucketName)
    .WithKey("notebook.htm");

request.WithExpires(DateTime.Now.Add(new TimeSpan(7, 0, 0, 0)));

string url = S3.GetPreSignedURL(request);    
this.Iframe2.Attributes.Add("src", url); 
```

问题是，如果您查看 IFrame 的来源，您可以看到完整的字符串，包括访问密钥和签名。我想知道是否有更好的方法通过 HTTP 标头执行此操作，以便登录安全信息不会通过查询字符串传递。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T09:03:39.153

您不能使用 http 标头对请求进行身份验证，因此唯一的其他潜在选择是通过您的 Web 服务器代理任何请求，但这会变得复杂并消除 S3 的许多好处。

但是，您所做的并不是不安全的。预签名的 url**不会**公开您的密钥。它只显示您的密钥（不需要保密）和使用密钥生成的签名（哈希）。

**您无法从 url 返回获取密钥。**

[您可以通过使用Amazons IAM](http://aws.amazon.com/iam/)创建一个仅对单个存储桶具有只读访问权限的用户并使用这些凭证来创建您的 url，从而使事情变得更加安全。这样，即使攻击者以某种方式设法从 url 对您的密钥进行逆向工程，他们所拥有的只是对单个存储桶的只读访问。

# linux - 在 FTP 客户端中放置选项

> ID：10610489
> 
> 赞同：2
> 
> 时间：2012-05-16T00:13:31.837
> 
> 标签：linux, command-line, ftp

FTP中的put命令“put local-file [remote-file]”是否有某种方法可以检查远程机器上的指定目录中是否已经存在同名文件，因此它不会存储本地-文件到远程机器？如果没有，如何做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:20:13.417

您可能需要查看[ftp 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?ftp)，尤其是 `sunique`or`runique`命令选项。我自己没有使用这些选项，但它们可能会帮助您完成您所询问的内容。

# android - 在 Sqlite/Android 中构建表并希望提供一个池列表

> ID：10610492
> 
> 赞同：0
> 
> 时间：2012-05-16T00:14:21.870
> 
> 标签：android, sqlite, listactivity

所以我开始构建一个应用程序，我现在的问题是我想要两件事：

首先，我建立了一个包含_ID、类别、标题、正文和时间的表格。

现在我只想显示一个类别列表，但只有 1 次，所以如果将一行插入到表中，它会显示多次。我正在使用列表...我不知道，希望你们知道方法。

```
enter code here  private RemindersDbAdapter mDbHelper;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.reminder_list);
    mDbHelper = new RemindersDbAdapter(this);
    mDbHelper.open();
    fillData();
    registerForContextMenu(getListView());

}

private void fillData() {
    Cursor remindersCursor = mDbHelper.fetchAllReminders();
    startManagingCursor(remindersCursor);

    // Create an array to specify the fields we want to display in the list (only TITLE)
    String[] from = new String[]{RemindersDbAdapter.KEY_CAT};

    // and an array of the fields we want to bind those fields to (in this case just text1)
    int[] to = new int[]{R.id.text1};

    // Now create a simple cursor adapter and set it to display
    SimpleCursorAdapter reminders = 
            new SimpleCursorAdapter(this, R.layout.reminder_row, remindersCursor, from, to);
    setListAdapter(reminders);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    MenuInflater mi = getMenuInflater();
    mi.inflate(R.menu.list_menu, menu); 
    return true;
}

@Override
public boolean onMenuItemSelected(int featureId, MenuItem item) {
    switch(item.getItemId()) {
    case R.id.menu_insert: 
        createReminder();
        return true; 
    case R.id.menu_settings: 
        Intent i = new Intent(this, TaskPreferences.class); 
        startActivity(i); 
        return true;
    }

    return super.onMenuItemSelected(featureId, item);
}

@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater mi = getMenuInflater(); 
    mi.inflate(R.menu.list_menu_item_longpress, menu); 
}

@Override
public boolean onContextItemSelected(MenuItem item) {
    switch(item.getItemId()) {
    case R.id.menu_delete:
        AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
        mDbHelper.deleteReminder(info.id);
        fillData();
        return true;
    }
    return super.onContextItemSelected(item);
}

private void createReminder() {
    Intent i = new Intent(this, ReminderEditActivity.class);
    startActivityForResult(i, ACTIVITY_CREATE);
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    Intent i = new Intent(this, ReminderEditActivity.class);
    i.putExtra(RemindersDbAdapter.KEY_ROWID, id);
    startActivityForResult(i, ACTIVITY_EDIT); 
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);
    fillData();
}<i/> 
```

和我的 DbAdapter

```
private static final String DATABASE_NAME = "data";
private static final String DATABASE_TABLE = "reminders";
private static final int DATABASE_VERSION = 4;

public static final String KEY_CAT = "category";
public static final String KEY_TITLE = "title";
public static final String KEY_BODY = "body";
public static final String KEY_DATE_TIME = "reminder_date_time"; 
public static final String KEY_ROWID = "_id";

private static final String TAG = "ReminderDbAdapter";
private DatabaseHelper mDbHelper;
private SQLiteDatabase mDb;

/**
 * Database creation SQL statement
 */
private static final String DATABASE_CREATE =
        "create table " + DATABASE_TABLE + " ("
                + KEY_ROWID + " integer primary key autoincrement, "
                + KEY_CAT + " text not null, "
                + KEY_TITLE + " text not null, " 
                + KEY_BODY + " text not null, " 
                + KEY_DATE_TIME + " text not null);"; 

private final Context mCtx;

private static class DatabaseHelper extends SQLiteOpenHelper {

    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL(DATABASE_CREATE);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        onCreate(db);
    }
}

/**
 * Constructor - takes the context to allow the database to be
 * opened/created
 * 
 * @param ctx the Context within which to work
 */
public RemindersDbAdapter(Context ctx) {
    this.mCtx = ctx;
} 
```

谢谢你能给我的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T03:52:33.160

看起来你有你的数据库。要返回类别列表，您需要在数据库助手类中创建一个新方法：

```
public Cursor fetchCategoryList() {
String query = "SELECT DISTINCT " + KEY_CAT + " AS _id FROM " + DATABASE_TABLE;
return mDb.rawQuery(query, null);
} 
```

`DISTINCT`关键字意味着它只会拉每个类别一次。如果你想在列表中使用它，你需要将它作为 _id 列拉出来，这就是它的`AS _id`一部分。 `_id`如果您打算使用光标填充列表，则需要它，但它不必是整数（尽管它确实应该是）。

然后将其用于列表，就像创建其他列表一样：

```
Cursor categoryCursor = mDbHelper.fetchCategoryList();
startManagingCursor(categoryCursor);

String[] from = new String[]{"_id"};
int[] to = new int[]{R.id.text1};
SimpleCursorAdapter categories = 
        new SimpleCursorAdapter(this, R.layout.reminder_row, categoryCursor, from, to);
setListAdapter(categories); 
```

# jquery-mobile - 如何使用 jquery mobile 从 secondpage.html 调用的函数中更新 index.html

> ID：10610493
> 
> 赞同：1
> 
> 时间：2012-05-16T00:14:37.983
> 
> 标签：jquery-mobile, cordova

我正在使用新的 cordova.js、jquery mobile 和我自己的 custom.js 构建一个 phonegap 应用程序

在主页上 index.html 是一个最初为空白的值列表

当您单击 index.html 页面上的设置链接时，您将进入 secondpage.html，您可以在其中输入一些值。当您单击 secondpage.html 上的提交按钮时，我会在 custom.js 中调用一个名为 updatevalues() 的函数，用于更新 index.html 上列表中的值。这不会发生。帮我理解为什么？这是 index.html、secondpage.html 和 custom.js 文件

---------------- index.html

```
<!DOCTYPE HTML>
<html>
<head>
<title>PhoneGap</title>
<script type="text/javascript" charset="utf-8" src="cordova-1.7.0.js"></script>
<link rel="stylesheet" type="text/css" href="jquery/jquery.mobile-1.1.0.css" />
<script type="text/javascript" src="jquery/custom.js"></script> 
<script type="text/javascript" src="jquery/jquery_1_7_2.js"></script> 
<script type="text/javascript" src="jquery/jquery.mobile-1.1.0.js"></script> 

</head>
<body>
<div data-role="page" id="mainpage"> 
          <div data-role="header" id="hdrMain"> 
               <h1>mainpage</h1>
          </div>

          <div data-role="content" id="contentMain"> 
               <p> Main Menu</p>
               <ul data-role="listview" data-inset="true" data-theme="b" >
                    <li><a href="secondpage.html">Setup</a></li>
                </ul>
          </div>

          <div data-role="content" id="contentInfo"> 
               <p>
          <ul data-role="listview" data-theme="g" id="contentlist">
               <li></li>
               <li></li>
          </ul>
     <p>
          </div>

         <script type="text/javascript" >  
          $( document ).delegate("#mainpage", "pageinit", function() {
              alert('A page with an ID of "mainpage" is about to be created by jQuery Mobile!');
              updatevalues();
            });
    </script>  
     </div>
</body>
</html> 
```

---------------------- secondpage.html

```
<!DOCTYPE HTML>
<html>
<head>
<title>Setup</title>
<script type="text/javascript" charset="utf-8" src="cordova-1.7.0.js"></script>

<link rel="stylesheet" type="text/css"
    href="jquery/jquery.mobile-1.1.0.css" />
<script type="text/javascript" src="jquery/jquery-1.7.1.min.js"></script>
         <script type="text/javascript" src="jquery/custom.js"></script> 
<script type="text/javascript" src="jquery/jquery.mobile-1.1.0.js"></script>
</head>

<body>
<div data-role="page">
<div data-role="header" id="hdrMain" name="hdrMain" data-nobackbtn="true">
        <h1> Setup</h1>
    </div>
    <div class="maindivs"  data-role="content" id="contentMain" name="contentMain"> 
    <form id="main" name="main">
<p>Your Starting Profile</p>
<p>* = REQUIRED</p>

<div class="maindivs"  id="ageDiv" data-role="fieldcontain">
<label for="yourage">Enter Your Age *</label> 
<input id="yourage" name="yourage" type="number" />
</div>

<div class="maindivs"  id="weighttDiv" data-role="fieldcontain">
<label for="startingweight">Weight in lbs *</label> 
<input id="startingweight" name="startingweight" type="number" />
</div>

<div class="maindivs"  id="submitDiv" data-role="fieldcontain">   
<a href="#" data-role="button" onClick=profilebuttonformbutton()> Submit </a> 
    </div>
   </form>
</div> 

<div class="requireddivs"  id="requiredDiv" data-role="fieldcontain">
Please fill in all required fields
<a href="#" data-role="button" onClick=showmainpagebutton()> OK </a> 
</div>

<div class="updateddivs"  id="updateDiv" data-role="fieldcontain">
Your values have been set.<br></br>
<a href="#" data-role="button" onClick=showindexpagebutton()> OK </a> 
</div>

<script>
    $(document).ready(function() {
    // Assign global variables
      //hdrMainVar = $('#hdrMain');
        $('.maindivs').show();
        $('.requireddivs').hide();
        $('.updateddivs').hide();
    }); 
    </script>

</div>
</body>
</html> 
```

----------------------------------------- custom.js

```
function updatevalues() 
{
    alert("checkvalues");
    var yourageVar = window.localStorage.getItem("yourageLocal");
    var weightVar = window.localStorage.getItem("weightLocal");
    alert("yourageVar = " + yourageVar);
    alert("weightVar = " + weightVar);

    if (!yourageVar || !weightVar)
    {
        $("#contentlist").empty(); //empty the list elements we've placed in the html
        //repopulate the list with data from phonegap's device api
        $("#contentlist").append("<li>Your age: 0</li>");
        $("#contentlist").append("<li>Your weight: 0</li>");
        $("#contentlist").listview('refresh'); //must be called if you want the new list elements properly styled
    }
    else
    {
        alert("main");
        alert("your age = " + yourageVar);
        alert("your weight = " + weightVar);
        $("#contentlist").empty(); //empty the list elements we've placed in the html

        //repopulate the list with data from phonegap's device api
        $("#contentlist").append("<li>Your Age: " + yourageVar + "</li>");
        $("#contentlist").append("<li>Your Weight: " + weightVar + "</li>");
        $("#contentlist").listview('refresh'); //must be called if you want the new list elements properly styled
    }
    $("#contentlist").listview('refresh'); //must be called if you want the new list elements properly styled
}

function showmainpagebutton( event ) 
{
    $('.maindivs').show();
    $('.requireddivs').hide();
    $('.updateddivs').hide();
}

function showindexpagebutton( event ) 
{
    $.mobile.changePage( "index.html", { transition: "slideup"} );  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:32:29.893

尝试这个：

```
//empty the list elements we've placed in the html
$("#contentlist li").remove();

//repopulate the list with data from phonegap's device api
$("#contentlist").append($("<li>Your Age: " + yourageVar + "</li>"));
$("#contentlist").append($("<li>Your Weight: " + weightVar + "</li>"));
$("#contentlist").trigger('create');
$("#contentlist").listview('refresh'); 
```

# qt - 拖放到 QTreeView 中的 QStandardItemModel 不起作用

> ID：10610494
> 
> 赞同：3
> 
> 时间：2012-05-16T00:14:44.223
> 
> 标签：qt, drag-and-drop

我有一个带有 QStandardItemModel 的 QTreeView。我正在尝试启用从外部资源拖放。我已经完成了文档中提到的拖放以及使用项目视图拖放的所有内容，但事情并不正常。当我尝试将文件拖到树视图上时，图标上总是有一个 X 表示 drop 不可用。（我使用 OS X，我不知道它的图标会是什么样子）。我希望能够放弃某些项目，但在我掌握基础知识之前，我无法编写该功能。

这是我的子类树视图源代码：

```
MyTreeView::MyTreeView(QWidget *parent) :
    QTreeView(parent)
{
    setContextMenuPolicy(Qt::CustomContextMenu);
    setAcceptDrops(true);
    setDropIndicatorShown(true);
}

void MyTreeView::dragEnterEvent(QDragEnterEvent *event)
{
    event->acceptProposedAction();
}

void MyTreeView::dropEvent(QDropEvent *event)
{
    qDebug("I am here");
    event->acceptProposedAction();
} 
```

这是子类标准项目模型的来源：

```
MyStandardItemModel::MyStandardItemModel(QObject *parent) :
    QStandardItemModel(parent)
{
}

Qt::DropActions MyStandardItemModel::supportedDropActions() const
{
    return Qt::CopyAction;
}

Qt::ItemFlags MyStandardItemModel::flags(const QModelIndex &index) const
{
    Qt::ItemFlags defaultFlags = QStandardItemModel::flags(index);

    if (index.isValid())
        return Qt::ItemIsDropEnabled | defaultFlags;
    else
        return defaultFlags;
}

bool MyStandardItemModel::dropMimeData(const QMimeData *data, Qt::DropAction action, int row, int column, const QModelIndex &parent)
{
    qDebug("I am in the model");
} 
```

正如我所说，该图标告诉我 drop 不可用，但是如果我无论如何都将其删除，树视图中的文本“我在这里”会被打印出来。但是模型视图中的文本“我在模型中”永远不会被打印出来。我不确定我需要做什么才能让模型识别出可用的水滴并更改图标，或者让 dropMimeData 函数调用。感谢您提供任何帮助，因为我一遍又一遍地阅读了文档，但我显然遗漏了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T11:44:41.613

我认为这是因为您还需要重新实现该`dragMoveEvent(QDragMoveEvent*)`方法。否则，每件商品都会独立地声明他们不能接受掉落。

# r - R 谷歌地图，添加更长的路径

> ID：10610499
> 
> 赞同：2
> 
> 时间：2012-05-16T00:16:02.257
> 
> 标签：r, google-maps-api-3, png, ggmap, rgooglemaps

我刚开始玩 RgoogleMaps [http://cran.r-project.org/web/packages/RgoogleMaps/RgoogleMaps.pdf](http://cran.r-project.org/web/packages/RgoogleMaps/RgoogleMaps.pdf)看起来真的很酷，但 GetMaps() 路径选项似乎有限制。看起来（我可能错了）一个 url 被发送到谷歌静态地图 api 并下载了一个 png 文件（或其他东西），所以 url 限制限制了你可以在“map.png”中拥有的路径的大小”。但我想知道在创建之后或在中间处理步骤中编辑 png 是否很容易以获得长路径？有人知道如何在 r 中执行此操作吗？该包似乎提供了一个将 XY 坐标映射到 png 栅格的函数。如果您还没有注意到我远不是 png 文件方面的专家，所以如果我缺少一些简单的东西，请保持温和。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T04:09:21.457

**不推荐使用更新** `opts`；改为使用`theme`。

如果您准备在 中工作`ggplot2`，该`ggmap`软件包可以轻松地将图层添加到地图中。下面的`get_map()`函数获取巴布亚新几内亚莫尔兹比港国家研究所的卫星谷歌地图。该`ggmap()`函数绘制地图，然后添加文本注释、线段注释和标题。但是可以像添加到常规 ggplot 图中一样添加其他几何图形。该函数的工作方式与基图 `gglocator()`中类似。和是地图中心的坐标，但位置向量可以给出地图的边界。我玩过以获得正确的分辨率。`locator()``lon``lat``zoom`

```
library(ggplot2)
library(ggmap)
library(grid)

nri = get_map(location = c(lon = 147.165, lat = -9.410), zoom = 18, maptype = 'satellite')

(NRImap = ggmap(nri, extent = "device") + 
  annotate('segment', x = 147.1656, xend = 147.1649, y = -9.41025, yend = -9.4096,
    colour = 'white', arrow = arrow(length = unit(0.25,"cm")), size = 1) +
  annotate('text', x = 147.1656, y = -9.41031, label = 'Conference Centre',
    colour = 'white', size = 6) +
  theme(plot.margin = unit(c(1.5, 0, 0, 0), "lines")) + 
  ggtitle                       ("National Research Institute") +
  theme(plot.title = element_text(colour = "Blue", vjust = 2, size = 20)))

# gglocator() 
```

![在此处输入图像描述](../Images/0cbfa02c7910d86f9fe9238d8420664d.png)

# ssh - 禁用本地地址的开瓶器

> ID：10610503
> 
> 赞同：3
> 
> 时间：2012-05-16T00:17:20.173
> 
> 标签：ssh, local, http-proxy

我有一个关于 Corkscrew 的问题，我用它来让 SSH 通过 HTTP 代理工作。SSH 对外部主机运行良好，但不适用于本地主机。如何禁用 SSH 以通过 HTTP 代理连接到本地服务器？我想这就是我得到的问题：

```
root@V01-XXXX:~# ssh root@172.XX.XX.8
Proxy could not open connnection to 172.XX.XX.8:  Forbidden
ssh_exchange_identification: Connection closed by remote host 
```

我的 /etc/ssh/ssh_config 文件包含：

```
Host *
ProxyCommand /usr/bin/corkscrew proxy.ezorg.nl 8080 %h %p 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T00:23:58.053

首先，您可以考虑将配置放入`~/.ssh/config`而不是 /etc/ssh/ssh_config。

要仅对某些特定主机使用开瓶器，请不要使用星号，而是列出特定主机，例如：

```
Host external.com example.com
ProxyCommand /usr/bin/corkscrew proxy.ezorg.nl 8080 %h %p 
```

如果您连接到特定主机，您还可以取消模式以仅设置代理命令。

```
Host * !192.168.0.? !*.local 
ProxyCommand /usr/bin/corkscrew proxy.ezorg.nl 8080 %h %p 
```

将匹配除 192.168.0.0/24 中的主机和 .local TLD 中的主机之外的所有主机

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:22:57.177

您可以添加行来`ssh_config`禁用某些主机的代理。就像是：

```
Host *.local host1 host2 host3
    ProxyCommand none 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-10T13:15:59.483

谢谢大家的帮助。在 wheezy 上它没有解决`localhost`（我找不到原因），但可以完美地与：

```
Host 127.0.0.1
ProxyCommand none

Host *
ProxyCommand /usr/bin/corkscrew <proxy> <proxyport> %h %p 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-12T13:48:29.197

扩展@Michael Slade的答案，您的`.ssh/config`作品中包含以下内容：

```
Host localhost
ProxyCommand none

Host *
ProxyCommand corkscrew proxy.com .... 
```

仅读取第一次出现的参数`ssh`。

# java - Java小程序打开网络套接字？

> ID：10610508
> 
> 赞同：0
> 
> 时间：2012-05-16T00:18:03.153
> 
> 标签：java, sockets, applet, japplet

所以我做了这个简单的 JApplet 并试图打开一个套接字并写入它，但我得到一个异常说我没有权限？？？

然后我看了这个：http: [//java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)

我已经在罐子上签名了，就是这样。以后不知道怎么办？？？

在html文件中，什么

```
<param name=file value="/etc/inet/hosts"> 
```

做？

有没有更简单的方法来签署 japplets？

让我简单地问一下。我如何让我的小程序在 google.com 的端口 80 上打开一个套接字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:53:04.187

```
<param name=file value="/etc/inet/hosts"> 
```

这意味着`/etc/inet/hosts`当小程序查询时，名称“文件”将具有该值。例如

```
// in the init() method ..
String fileValue = getParameter("file");
// fileValue now has the value '/etc/inet/hosts' 
```

# vb.net - 这段代码有什么问题？（它不识别 kernel32 及更高版本）

> ID：10610514
> 
> 赞同：-1
> 
> 时间：2012-05-16T00:18:53.507
> 
> 标签：vb.net, structure

我是这个行业的新手

代码：

```
 Dim info As StructLib.MEMORY_BASIC_INFORMATION
    Dim size = CUInt(Marshal.SizeOf(GetType(StructLib.MEMORY_BASIC_INFORMATION)))
    Dim address = IntPtr.Zero
    Dim handle = Api.kernel32.OpenProcess(EnumLib.ProcessAccessFlags.All, False, Helper.EnumProcess.Process().First(Function(res) res.szExeFile = "chrome.exe").th32ProcessID)
    Dim lookFor As Object = "google.co.il", replaceWith As Object = "boogle.co.il"
    Dim done As UInteger
    Dim lookData As Byte() = Nothing
    If TypeOf lookFor Is String Then
        lookData = Encoding.Unicode.GetBytes(DirectCast(lookFor, String))
    ElseIf TypeOf lookFor Is Byte Then
        lookData = New Byte(0) {}
        lookData(0) = CByte(lookFor)
    ElseIf TypeOf lookFor Is Short Then
        lookData = BitConverter.GetBytes(CShort(lookFor))
    ElseIf TypeOf lookFor Is Integer Then
        lookData = BitConverter.GetBytes(CInt(lookFor))
    ElseIf TypeOf lookFor Is Long Then
        lookData = BitConverter.GetBytes(CLng(lookFor))
    End If
    While Api.kernel32.VirtualQueryEx(handle, address, info, size) > 0
        If info.Valid Then
            Dim data = info.getData(handle)
            For i As var = 0 To data.Length - 1
                Dim index = -1
                While System.Threading.Interlocked.Increment(index) < lookData.Length
                    Try
                        If data(i + index) = lookData(index) Then
                            If index = lookData.Length - 1 Then
                                If TypeOf replaceWith Is String Then
                                    Api.kernel32.WriteProcessMemory(handle, address + i, Marshal.StringToHGlobalUni(DirectCast(replaceWith, String)), Convert.ToUInt32(DirectCast(replaceWith, String).Length * 2), done)
                                    i += (index + DirectCast(replaceWith, String).Length)
                                Else
                                    Dim replace As Byte() = Nothing
                                    If TypeOf replaceWith Is Long Then
                                        replace = BitConverter.GetBytes(CLng(replaceWith))
                                    ElseIf TypeOf replaceWith Is Integer Then
                                        replace = BitConverter.GetBytes(CInt(replaceWith))
                                    ElseIf TypeOf replaceWith Is Short Then
                                        replace = BitConverter.GetBytes(CShort(replaceWith))
                                    ElseIf TypeOf replaceWith Is Byte Then
                                        replace = New Byte() {CByte(replaceWith)}
                                    End If
                                    If True Then
                                        Dim gc = GCHandle.Alloc(replace, GCHandleType.Pinned)
                                        Api.kernel32.WriteProcessMemory(handle, address + i, gc.AddrOfPinnedObject(), 1, done)
                                        gc.Free()
                                    End If
                                    If TypeOf replaceWith Is Long Then
                                        i += (index + 8)
                                    ElseIf TypeOf replaceWith Is Integer Then
                                        i += (index + 4)
                                    ElseIf TypeOf replaceWith Is Short Then
                                        i += (index + 2)
                                    ElseIf TypeOf replaceWith Is Byte Then
                                        i += (index + 1)
                                    End If
                                End If
                                Exit Try
                            End If
                        Else
                            i += index
                            Exit Try
                        End If
                    Catch
                        i += index
                        Exit Try
                    End Try
                End While
            Next
        End If
        If CLng(address) <= &H7FFFFFFF Then
            If info.[Next] = address Then
                Exit While
            End If
            address = info.[Next]
        Else
            Exit While
        End If
    End While 
```

**它不承认：**

```
Api.kernel32
   For i As var
      StructLib.MEMORY_BASIC_INFORMATION
      Dim size = CUInt(Marshal.SizeOf(GetType(**StructLib.MEMORY_BASIC_INFORMATION**)))

      EnumLib.ProcessAccessFlags.All
      helper.EnumProcess.Process().First(Function(res) res.szExeFile = "chrome.exe" 
```

*   什么是结构？
*   什么是库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:37:56.870

从事情的外观来看，`Api`是一个有人写的类。据我所知，没有名为 .Net 的类型`Api`。您将需要该对象的任何库并引用它。您从中复制代码的类/模块是否具有：

`Imports xxx.Api`

...或者有任何您不认识的进口商品？

代码在编译时会失败吗？还是运行时？如果在运行时，在哪里？我猜想，如果在运行时，您应该在第一行或第四行抛出异常：

```
Dim info As StructLib.MEMORY_BASIC_INFORMATION
Dim size = CUInt(Marshal.SizeOf(GetType(StructLib.MEMORY_BASIC_INFORMATION)))
Dim address = IntPtr.Zero
Dim handle = Api.kernel32.OpenProcess(EnumLib.ProcessAccessFlags.All, False, Helper.EnumProcess.Process().First(Function(res) res.szExeFile = "chrome.exe").th32ProcessID) 
```

我猜你可能甚至没有编译。

# azure - 发布命令一直失败到 Windows azure

> ID：10610515
> 
> 赞同：0
> 
> 时间：2012-05-16T00:19:04.557
> 
> 标签：azure

我对 Windows Azure 的发布命令一直失败。在 Visual Studio 中，我收到以下错误消息：

> 下午 4 点 48 分 58 秒 - 准备部署，订阅 ID：< mysubscriptionid >
> 下午 4 点 48 分 58 秒 - 正在连接...下午 4 点 48 分
> 59 秒 - 验证存储帐户“pwcstorageend”...
> 下午 4 点 49 分 01 秒- 上传包...
> 4:50:39 PM - 创建...
> 4:51:43 PM - HTTP 请求被客户端身份验证方案“匿名”禁止。
> 下午 4:51:43 - 停止 mvc3appsample
> 下午 4:51:45 - 客户端身份验证方案“匿名”禁止 HTTP 请求。
> 下午 4:51:45 - 部署失败

注意：发布命令之前工作过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T04:56:00.893

当您遇到这样的问题时，事情曾经正常工作一段时间后，更新环境总是好的，这样您就知道如果发生变化就会恢复正常。

此问题与您的开发机器证书配置非常相关，并且由于证书不匹配，可以建立 SSL 连接。实际上，我可以通过在管理门户中删除完全相同的证书来重现此问题，该证书用于从 Visual Studio 进行部署。

要解决此问题，您可以从 Windows Azure 管理门户下载最新的发布设置，如下所述，并将其与 Visual Studio 一起使用：http: [//blogs.msdn.com/b/avkashchauhan/archive/2012/05/10/downloading-windows -azure-publish-settings-subscription-configuration-file.aspx](http://blogs.msdn.com/b/avkashchauhan/archive/2012/05/10/downloading-windows-azure-publish-settings-subscription-configuration-file.aspx)

一旦您在开发机器和 Windows Azure 管理门户之间进行了适当的证书设置，就可以建立 SSL 连接并且发布将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T02:51:21.593

我的猜测是安装在您计算机上的管理证书在您的 Azure 订阅上不再有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-06T23:02:26.423

在我们的案例中，这是因为我们的一个 Azure 订阅在进入（禁用）模式时会随机出现，需要与 Microsoft 一起升级支持票证。我怀疑触发了其他人在这个问题上报告的管理证书错误。

# ruby - 我可以在内部调用路由吗？

> ID：10610519
> 
> 赞同：0
> 
> 时间：2012-05-16T00:19:33.320
> 
> 标签：ruby, cron, sinatra

我只将一个文件用于 sinatra 应用程序 ( *sinatra.rb* )，其中我有一条路线：

```
get '/ajax2?' do
  my_function()
end 
```

我可以`my_function()`从*另一个 ruby​​ 脚本*（cron.rb）调用并*传递所有参数*吗？那么，如果我从浏览器访问它，这条路线中的任何代码都会以相同的方式执行吗？

我需要从 cron 工作中调用它。

*   ruby 1.8.7 (2010-08-16 补丁级别 302) [i386-mingw32]
*   西纳特拉 (1.3.2)
*   sinatra 高级路由 (0.5.1)
*   sinatra-reloader (0.5.0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:06:44.057

**更新**：

很确定你只需要一个模块，就像这样，在**my_module.rb**：

```
module MyModule
  def my_function
  end
end 
```

然后在你的**app.rb**中：

```
require './my_module.rb'
helpers MyModule 
```

您可以在 cron.rb 中要求并包含该模块

* * *

如果我正确地遵循了您的问题（不确定我是否这样做），请将您的代码拉出到扩展中，因此您的目录结构如下所示：

```
myapp/
|-lib/
  |-my_extension.rb
|-app.rb 
```

然后在**my_extension.rb**：

```
module Sinatra
  module MyExtension
    def self.registered(app)
      app.get '/ajax2?' do
        "hallo"
      end
    end
  end
  register MyExtension
end 
```

在**app.rb**中，您只需要：

```
require './lib/my_extension.rb' 
```

这是第一步，然后将扩展的内容移动到 gem 中，您可以在任何 sinatra 应用程序的 Gemfile 中要求 gem。

# mysql - Mysql join 并根据其值计算外键

> ID：10610520
> 
> 赞同：1
> 
> 时间：2012-05-16T00:19:35.093
> 
> 标签：mysql, join, count

我正在尝试制作一个简单的预订系统。

我有两个表作为`room_types`, 和`rooms`。在`rooms`中，我有一个布尔字段，显示该房间是否可用。我想列出房间类型，至少有一个房间可供该类型使用。我知道我需要使用连接和计数，但我无法将整个查询放在一起。任何帮助表示赞赏。

我的架构（修剪了不必要的字段）：

```
room_types [id, name(varchar), size(int), price(float) ...]
rooms [no (int), type (int) (foreign key room_types(id)), available (bool), ...] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:23:39.250

```
select room_types.id from room_types
    inner join rooms on rooms.room_type = room_types.id and rooms.available = 1
group by room_types.id 
```

这个概念在那里，但我不能准确地编写查询，因为我不知道你的架构。我确实希望你能从中学到你需要的东西并将它应用到你自己的模式中。

```
select room_types.id, COUNT(rooms.id) from room_types
    left outer join rooms on rooms.room_type = room_types.id and rooms.available = 1
group by room_types.id
order by COUNT(rooms.id) desc 
```

计数（包括可能有可用房间的房间类型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:07:42.073

试试这个：

```
SELECT  a.id, 
        a.Name,
        COUNT(b.id) AvailableRooms
FROM    room_types a LEFT JOIN rooms b 
            ON b.room_type = a.id
WHERE   b.available = 1
GROUP BY a.id
ORDER BY AvailableRooms DESC 
```

# c# - 使用设计时架构 .NET 重置对数据集的运行时更改

> ID：10610521
> 
> 赞同：0
> 
> 时间：2012-05-16T00:19:55.550
> 
> 标签：c#, .net, vb.net, dataset

我有一个小型数据集，它的大部分架构是在设计时定义的，但我在运行时向其中一个表中添加了几列。我的问题是如何重置这些更改？

数据集未链接到任何数据源。它只有自己的表格，我“手动”填充。静态列已在设计时添加到数据表中。但是，我根据类别列表添加了一些列作为运行时。像这样：

```
For Each aCategory In theCategories
    theDataTable.Columns.Add(aCategory.CategoryName, System.Type.GetType("System.Boolean"))
Next 
```

该数据集用于在我的应用程序中弹出的一个小对话框中。我在使用 Load 事件打开对话框时添加动态列。第一次一切都很好。但是，如果您关闭对话框并重新打开它，就会出现问题。我的启动例程尝试再次添加动态列，但抛出一个错误，指出该列已存在。我已经尝试了很多事情并做了一些阅读，但我无法找到在对话框关闭时重置数据集的方法。唯一的解决方案是关闭整个应用程序并重新打开它。我在对话框表单的 Leave 事件中尝试了以下操作：

```
theDataSet.Reset()
theDataSet.Dispose()
theDataSet.RejectChanges() 
```

这些似乎都没有影响，错误仍在继续。除了数据集之外，我还尝试将相同的方法应用于表。如：

```
theDataSet.Tables(0).Reset()
etc. 
```

关于在表单关闭时如何完全消除数据集的任何想法？我在 VB 中给出了我的示例，但我可以用 VB 或 C# 来消化答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:32:25.827

也许我没有完全理解您的实现，但是“设计时”数据集是常规类，我假设您显示的代码中的“theDataSet”和您调用的方法是所述类的实例。

如果您想通过对数据集（实例）所做的任何更改完全消除数据集（实例），您只需创建另一个实例即可。

```
theDataset = new DatasetClassCreatedByTheDesigner(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:03:05.690

有几种可能的方法可以解决您的问题。IE：

*   如果您的动态列已创建，请将其删除
*   在添加它们之前检查您的动态列是否已创建。如果它们已创建，请重复使用它们，而不是添加新列

对于这两个选项，您需要向 DataSet 添加额外信息。您可以使用[DataSet.ExtendedProperties 属性](http://msdn.microsoft.com/en-us/library/system.data.dataset.extendedproperties.aspx)来做到这一点。

顺便说一句，您的代码使用的是 DataTable，而不是 DataSet。DataSets 没有列。相反，它们具有 DataTables，而那些具有列。它们还具有 ExtendedProperties 属性，因此您可以使用此解决方案。

在第一个解决方案中，您可以添加具有原始列数的扩展属性。这样您就可以轻松地创建一个循环来删除最后一列，直到列数等于原始列数（您的代码在列集合的末尾添加新列）。您可以使用`RemoveAt(dataTable.Columns.Count -1)`.

在第二个解决方案中，您可以使用一个简单的扩展属性，该属性包含一个布尔值，用于通知您是否已添加动态列。

您可以在接收 DataTable 作为参数的方法中实现此解决方案，以便轻松重用代码。如果您愿意，您甚至可以创建扩展方法。

第二种解决方案的实现：

```
public static void RemoveExtraColumns(DataTable dt)
{
  // get original column count from extended property
  while(dt.Columns.Count > originalColumnCount)
    dt.Columns.RemoveAt(dt.Columns.Count -1);
} 
```

如果要将其用作扩展方法，请在静态类中实现它，并将其签名更改为：

```
public static void RemoveExtraColumns(this DataTable dt) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T14:38:49.883

我已经回答了我自己的问题。事实证明，我的问题实际上与数据集或数据表无关，而是与对话框有关。

我正在调用使用数据集的表单，如下所示：

```
ActionsSettingsForm.ShowDialog() 
```

阅读这篇文章后：http: [//msdn.microsoft.com/en-us/library/aw58wzka.aspx](http://msdn.microsoft.com/en-us/library/aw58wzka.aspx)我意识到只有在使用 .show 而不是 .showdialog 时才会自动调用 dispose 方法。所以我将调用表单的代码更改为：

```
ActionsSettingsForm.ShowDialog()
ActionsSettingsForm.Dispose() 
```

它解决了这个问题。现在，当表单关闭时，与表单关联的所有对象都已正确处理。这意味着数据集将重置为其设计时默认值，或者在再次打开表单时创建一个新数据集。

# apex-code - apex 中的 sql 查询？

> ID：10610526
> 
> 赞同：0
> 
> 时间：2012-05-16T00:20:21.590
> 
> 标签：apex-code, soql

我是新手，很抱歉这个q。

我在 MDR 中有 2 个对象：Child_ *c 和联系人。*我有一个包含contact_id*的子_c 记录列表。*从联系人对象中，我需要获取 firstName、lastName、Id（其中 = 是 child 中的 contact_id）。我的查询是错误的。有人可以帮我吗？？？

谢谢！

列表 peopleInEventContactInfo = new List ();

for (Contact c: [ select firstname, lastname, Id, ytd__c from Contact where id in ContactIds ]){ peopleInEventContactInfo.add(c); }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:04:50.970

假设`ContactIds`是一个联系人 ID 的列表或集合，那么您只需要在它前面加一个冒号：

```
for (Contact c : [select firstname, lastname, Id, ytd__c
                  from   Contact
                  where  id in : ContactIds])
{
    peopleInEventContactInfo.add(c);
} 
```

但是你也不需要循环：

```
list<Contact> peopleInEventContactInfo = [select FirstName, LastName, Id, YTD__c
                                          from   Contact
                                          where  Id in : ContactIds]; 
```

# java - getCountry 方法错误

> ID：10610531
> 
> 赞同：3
> 
> 时间：2012-05-16T00:21:14.787
> 
> 标签：java, arrays

有人可以提供一些关于为什么代码不起作用的见解吗？问题出在部分国家`[numCountries]=newCountry;`

我不确定为什么它一直说类型不匹配无法转换`Country[]`为 Country，但我认为我`countries[numCountries]`的 is`Country[]`类型，因为我已经在第二行代码中将它称为该类型？

```
public class World{

private Country[] countries;
private int numCountries=0;

public boolean addCountry(Country[] newCountry){
    if(!(newCountry==null)){
        countries[numCountries]=newCountry;     //the newcountry part doesnt work, red zigzag line underlining it here im not sure why
        numCountries++;
        return true;
    }
    else
        return false;

       }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:23:41.637

***您的***方法说您要添加Country，而不是添加 Country 数组，因此您的方法参数可能应该丢失数组括号`[]`。这样，该方法就更有意义了，因为它传入了您所说的应该传入的内容——单个 Country 对象。在尝试将另一个国家/地区添加到数组之前，您还需要检查您的方法是否没有超出国家/地区数组的大小。这可以通过一个简单的 if 语句来完成。

如果你想添加一个 Country 数组，那么你可能希望创建另一个方法，比如`addCountries(Country[] newCountries)`. 但我不认为你真的想这样做，所以坚持使用更正的当前方法。

如果其中任何一个没有意义，请询问 - 只需在此答案下方写下评论即可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T00:30:56.247

Country 后面的方括号表示您的 addCountry 方法正在添加一系列国家/地区，但您很可能一次只想添加一个国家/地区。

因此，将其更改为：

```
public boolean addCountry(Country newCountry){
    ....
} 
```

# xpath - Xpath 选择第 n 个节点

> ID：10610537
> 
> 赞同：7
> 
> 时间：2012-05-16T00:22:25.600
> 
> 标签：xpath

我有一个这样的 XML

```
<div class="yay">
 <div class="foo"></div> 
 <div class="foo"></div>
 <div class="bar"></div>
 <div class="foo"></div>
 <div class="bar"></div>
 <div class="foo"></div>
</div> 
```

有没有办法选择类为“foo”的第 n 个 div？

我会选择所有的 foos`//div[@class="yay"/div[@class="foo"]`

如果我想选择 foo #3 我该怎么做？就像是：

`//div[@class="yay"/div[@class="foo"][3]`?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-16T03:18:31.207

**这是 XPath 中最常见的问题之一**。

**使用**：

```
(//div[@class="yay"]/div[@class="foo"])[3] 
```

**说明**：

XPath 伪运算符`//`的优先级（优先级）低于`[]`运算符。

**因此**

```
//div[@class="yay"]/div[@class="foo"][3] 
```

**意思是**：

*选择每个`div`其`class`属性具有值`"foo"`且 (the `div`) 是其 parent 的第三个这样`div`的孩子*。

如果有多个父`div`元素具有三个或更多这样的子元素，则选择*所有*第三个子元素。

**与许多表达式语言一样，覆盖内置优先级的方法是使用括号**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:46:57.077

这对我有用，所以您是正确的，`//div/div[@class="foo"][2]`或者您是否想选择“yay”下的元素编号 3 并查看它是否为“foo”？

# php - 安全且比普通登录更好，并检查用户是否是登录脚本。PHP/MYSQL代码，网页开发

> ID：10610539
> 
> 赞同：1
> 
> 时间：2012-05-16T00:22:55.133
> 
> 标签：php, mysql, security, session, login

```
form submit { email|password }

php filter/check { mysql_real_escape_string etc... }

php set/login.php {

   $hash_logged = sha1(rand(100000,999999).$_SERVER["REMOTE_ADDR"].time());
   $_SESSION["hl"] = $hash_logged;
   mysql_query("UPDATE `users` SET `hash_logged`='".$hash_logged."' WHERE 
             `email`='".$emailLogin."'")or die(mysql_error());
   setcookie("hlc", sha1($emailLogin."longstringtoguess"), time() + 600);
} 
```

所有 files.php 顶部的 php 脚本以验证用户是否已登录：

```
if(isset($_SESSION["hl"], $_COOKIE["hlc"]))
{
    $ext_hl =$_SESSION["hl"];
    $ext_cookie = $_COOKIE["hlc"];
    if(empty($ext_hl))  { header("location: logout.php"); exit(); }
    if(empty($ext_cookie))  { header("location: logout.php"); exit(); }

    $mysqlQ = mysql_query("SELECT `id`, `username`, `email`, `password` FROM `users`
                           WHERE `hash_logged`='".$ext_hl."'")or die(mysql_error());
    if(mysql_num_rows($mysqlQ) == 1)
    {
        $row = mysql_fetch_array($mysqlQ);
        if(sha1($row["email"]."longstringtoguess") == $ext_cookie)
        {
             $logged = "yes";
        }
        else {
            header("location: logout.php");
            exit();
        }
    }
    else { header("location: logout.php"); exit(); }
} 
```

注销.php

会话销毁/取消设置标头位置：index.php

这种方法足够安全吗？你有什么办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:32:49.040

这样做的一个问题是用户想要从两台设备（之前是两个不同的 IP 地址）或那些在 IP 地址可能会更改的连接（例如移动/拨号）上连接的用户。理想情况下，您将有一个记录 hash_id 和 user_id 的“会话”表，然后用户连接到“会话”，并且您知道从该表连接的用户。

鼓励对 DB 条目使用 PDO。[http://php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php) 起初很吓人，但很有意义，很快就变成了第二天性（“容易”）。

如果需要，您还可以确保您的会话“过期”。

您的代码受制于可能窃取 cookie 并欺骗 REMOTE_ADDR 的人，或者如果有人知道电子邮件地址并可以破解密钥 - 但在大多数情况下，这就足够了。您可以添加额外的投影，例如针对会话存储 user_agent（再次可欺骗）或向哈希添加更多内容（旋转密钥）等，以使其难以破解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-29T04:33:57.827

> 这种方法足够安全吗？你有什么办法做到这一点？

1.  我不允许通过`$emailLogin`in进行 SQL 注入`set/login.php`。[我更喜欢通过EasyDB](https://github.com/paragonie/easydb)使用准备好的语句。
2.  我没有将用户与会话关联（一对一），而是将当前会话与用户帐户关联（多对一）。这允许用户从多个设备安全且独立地进行身份验证。
3.  我只是使用`session_start()`而不是试图建立一个看似安全的随机值。如果我需要直接创建随机性，我使用`random_bytes()`.
4.  我从不`==`用于比较字符串。
    *   我`hash_equals()`改用。
    *   违规线路：`if(sha1($row["email"]."longstringtoguess") == $ext_cookie)`

# git - git add/rm (提交)

> ID：10610541
> 
> 赞同：7
> 
> 时间：2012-05-16T00:23:04.523
> 
> 标签：git

所以我接管了一个网站，其中一些已经受到 git 版本控制（其中一个开发人员使用它，另一个没有）。所以我要承诺到目前为止的一切，并从那里开始工作。

但是，有一些文件的 git 状态我不太明白。它们被标记为：

```
# Changed but not updated:
#   (use "git add/rm <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory) 
```

因此，如果我只是运行 git commit，对这些文件所做的更改会以它们的方式进入存储库吗？只是我不明白你为什么要做 add/rm- 似乎是一举一动地添加然后删除所有内容。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T01:57:24.213

通常，如果你想把它们放在工作文件夹中，你会

```
git add -A 
```

这将分阶段进行所有更改，包括删除文件和跟踪尚未跟踪的文件的行为。

在执行此操作之前检查您的`.gitignore`文件是明智的，这样您就不会提交不需要的工件，这些工件可能会使您的存储库膨胀并污染差异和补丁的输出。

完成此操作后，您可以

```
git commit 
```

记录历史的变化。那么你也能

```
git push origin your_branch_name 
```

与您设置的遥控器共享此新历史记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:26:34.567

These files are staged but not committed. Yes, if you simply run git commit, they will be committed. More to the point, do you want to commit these files? They may or may not be the same as your working files. [http://gitready.com/beginner/2009/01/18/the-staging-area.html](http://gitready.com/beginner/2009/01/18/the-staging-area.html) is a decent introduction to the staging area.

# c++ - 时间不匹配

> ID：10610542
> 
> 赞同：1
> 
> 时间：2012-05-16T00:23:07.797
> 
> 标签：c++, timing, strftime, timeval

```
struct timeval start, end, duration;
gettimeofday(&start, NULL);

res = curl_easy_perform(curl);

gettimeofday(&end, NULL);
timersub(&end, &start, &duration);

tm* startTime = localtime(&start.tv_sec);
tm* endTime = localtime(&end.tv_sec);
char buf[64];
strftime(buf, sizeof(buf), "%Y-%m-%d %H:%M:%S", startTime);
char buf2[64];
strftime(buf2, sizeof(buf2), "%Y-%m-%d %H:%M:%S", endTime);

ofstream timeFile;
timeFile.open ("timingSheet.txt");
timeFile << fixed << showpoint;
timeFile << setprecision(6);
timeFile << "Duration: " << duration.tv_sec << "." << duration.tv_usec << " seconds \n";
timeFile << "Start time: " <<  buf <<"." << start.tv_usec << "\n";
timeFile << "End time: " <<  buf2 <<"." << end.tv_usec << "\n";
timeFile.close(); 
```

当我运行此代码时，我得到以下输出：

```
Duration: 3.462243 seconds 
Start time: 2012-05-15 17:14:07.432613
End time: 2012-05-15 17:14:07.894856 
```

令我困惑的是，持续时间值与开始和结束时间不匹配。这两个日期仅相差微秒。是否有一个原因？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:30:57.863

localtime 返回一个静态分配的缓冲区，你调用它两次，所以 StartTime 和 EndTime 是相同的。您需要在每次调用后直接将其复制到另一个缓冲区中。

```
tm* startTime = localtime(&start.tv_sec); 
char buf[64]; 
strftime(buf, sizeof(buf), "%Y-%m-%d %H:%M:%S", startTime); 

tm* endTime = localtime(&end.tv_sec); 
char buf2[64]; 
strftime(buf2, sizeof(buf2), "%Y-%m-%d %H:%M:%S", endTime); 
```

编辑：你也可以这样写：

```
tm* pTimeBuf = localtime(&start.tv_sec); 
char buf[64]; 
strftime(buf, sizeof(buf), "%Y-%m-%d %H:%M:%S", pTimeBuf); 

localtime(&end.tv_sec); // NB. I don't store th return value (since I have it already)
char buf2[64]; 
strftime(buf2, sizeof(buf2), "%Y-%m-%d %H:%M:%S", pTimeBuf); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T01:12:44.623

我同意 Edwin 的观点，只是稍作修改，最好使用线程安全版本[localtime_r](http://pubs.opengroup.org/onlinepubs/000095399/functions/localtime.html)而不是 localtime

```
struct tm startTime,endTime;
memset(&startTime,0,sizeof(struct tm)); //Advisable but not necessary
memset(&endTime,0,sizeof(struct tm)); //Advisable but not necessary
localtime_r(&start.tv_sec, &startTime);
localtime_r(&end.tv_sec, &endTime); 
```

# java - 如何从 ActionBean 访问父目录？

> ID：10610544
> 
> 赞同：0
> 
> 时间：2012-05-16T00:23:22.600
> 
> 标签：java, java-io, stripes

我想在 webapp 目录（我的 ActionBean 使用的带有 jsp 文件的目录）中的图像目录中获取所有图像文件名。

我的 ActionBean 当然在我的 webapp 目录旁边的 src 目录中。

我的 ActionBean 能够通过使用我需要访问“/images”的路径“/WEB-INF/jsps”来引用 jsps。

我试着做：

```
File imageDir = new File("/images");
boolean real = imageDir.exists(); 
```

但我是假的。我对 java.io 真的很陌生。有人能帮我吗？如何访问该目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:02:36.067

由于您在`new File("/images")`java 应用程序内部调用，java 会认为您需要文件系统根目录下的文件（绝对路径）。由于那里没有 /images 文件夹，因此存在返回 false。

相对路径在这里也很棘手，因为它们取决于 tomcat 的安装/运行位置。当我以前这样做时，我通常只是拼出从顶层到图像文件夹 ala 的整个路径，`"/home/myself/Public/tomcat/webapps/the-app/images/"`或者你的结构看起来如何。

# xml - 用于在 Java 中托管 XML 的简单服务器

> ID：10610548
> 
> 赞同：0
> 
> 时间：2012-05-16T00:23:45.517
> 
> 标签：xml, jax-ws, java

我有一些简单的动态 XML，我想在使用 Java 的端点上通过 http 出售（例如：） `http://localhost:8888/getUpdatedInfo`。

我真的很想避免使用框架或第三方库。我知道对于 WSDL 端点，使用普通 JDK 托管服务器非常简单（在[http://docs.oracle.com/javaee/6/api/index.html?javax/xml/ws中使用 endpoint.publish() /端点.html](http://docs.oracle.com/javaee/6/api/index.html?javax/xml/ws/Endpoint.html) )

任意 HTML/XML 有类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:44:51.420

如[com.sun.net.httpserver 的文档中](http://docs.oracle.com/javase/6/docs/jre/api/net/httpserver/spec/com/sun/net/httpserver/package-summary.html)所示：

```
import com.sun.net.httpserver.HttpExchange;
import com.sun.net.httpserver.HttpHandler;
import com.sun.net.httpserver.HttpServer;

import java.io.IOException;
import java.io.OutputStream;
import java.net.InetSocketAddress;

public class SimpleHttpServer {
    public static void main(String[] args) throws IOException {
        HttpServer server = HttpServer.create(new InetSocketAddress(8888), 0);
        server.createContext("/foo", new HttpHandler() {
            public void handle(HttpExchange t) throws IOException {
                t.sendResponseHeaders(200, 0);
                OutputStream out = t.getResponseBody();
                out.write("hello world".getBytes());
                out.close();
            }
        });
        server.start();
    }
} 
```

# ios5 - In IOS 5, calls to [webView shouldStartLoadWithRequest:] are changed to lowercase

> ID：10610550
> 
> 赞同：0
> 
> 时间：2012-05-16T00:24:00.947
> 
> 标签：ios5

I use [webView shouldStartLoadWithRequest: navigationType:] to control the user navigation in a UIWebView. I was comparing the string with "isEqualToString" method like:

```
NSString *requestString = [[request URL] absoluteString];
if ([requestString isEqualToString:@"http://www.myComapnyWeb.com"])  return YES;
else return NO; 
```

When the device was in IOS 4.3 this was working fine. Once the device got upgraded to IOS 5, (5.1.1 exactly), the above logic failed. With some NSLog, I noticed that the URL is returned all in lower case, (mycompanyweb instead of myCompanyWeb) and hence the above string comparison fails.

I can fix it by changing the comparison with lowercaseString method. Want to find out if anyone else experienced this. Any other solution? And in future, do we need to expect such changes?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T21:12:03.350

尝试：

```
NSString *requestString = [request.URL absoluteString]; 
```

那应该给你正确的情况。

我在 Xcode 4.5 版中测试过

至于“期待这样的变化”，他们总是有可能做出改变。有时是为了更好，有时....... =）

# jquery - Make border-image overlap main image

> ID：10610554
> 
> 赞同：0
> 
> 时间：2012-05-16T00:24:48.283
> 
> 标签：jquery, image-scaling, css

I'm using the CSS3 border-image property to images that will be of various sizes. I'm using in-line css for the time being.

I want to make it so that the border-image has priority over the main image, so that if the image is slightly bigger than anticipated, the frame appears in front of the image.

Below is my code:

```
<img alt="Thumb_img_0129" src="/thumb_IMG_0129.jpg" 
style='border-width:15px; padding:10px 10px; 
-moz-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
-webkit-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
-o-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
border-image:url("/images/fancy-frame.jpg") 30 30 stretch;' /> 
```

I know it's a bit clunky being in-line css...but have it this way for the time being...

Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T15:12:12.320

尝试将边框放在 wrapping 周围`DIV`。例如：

```
<div style="background-image: url('/thumb_IMG_0129.jpg'); background-repeat: no-repeat;">
     <div style='border-width:15px; padding:10px 10px; 
          -moz-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
          -webkit-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
          -o-border-image:url("/images/fancy-frame.jpg") 30 30 stretch; 
          border-image:url("/images/fancy-frame.jpg") 30 30 stretch;'>

          <img src='/thumb_IMG_0129.jpg' style='opacity: 0;'/>

      </div>
</div> 
```

说明：第一次包装`DIV`将图像作为背景。在此之上，第二个`DIV`绘制边界。最后但并非最不重要的一点是，它们内部的图像，但不可见，可以自动将`DIV`s 缩放到图像的大小。

# c++ - 如果我得到任何字符退出程序

> ID：10610555
> 
> 赞同：2
> 
> 时间：2012-05-16T00:25:06.750
> 
> 标签：c++, terminal, getchar

我正在创建一个程序，如果我按下任何键，我想退出程序。到目前为止，我只能在按下返回时这样做，因为 getch 需要按下返回。

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <pthread.h>
static void * breakonret(void *instance);
int main(){
  pthread_t mthread;
  pthread_create(&mthread, NULL, breakonret, NULL);
  while(1){
    printf("Data on screen\n");
    sleep(1);
  }
}
static void * breakonret(void *instance){
  getchar();
  exit(0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:32:11.907

（我重新标记了这个问题`getch`，`getchar`因为它们是两个不同的东西）。

正如您所注意到的，`getchar`在返回之前等待按下返回。如果您希望它在按下任何键后立即返回，则需要使用不同的功能。在 Windows 上，有一个名为的内置函数`getch()`可以执行此操作，定义在`<conio.h>`. 在 POSIX 平台（例如 Linux、OS X）上，没有 builtin `getch()`，但您可以像这样编写自己的版本（来自[http://cboard.cprogramming.com/faq-board/27714-faq-there-getch-conio -等效-linux-unix.html](http://cboard.cprogramming.com/faq-board/27714-faq-there-getch-conio-equivalent-linux-unix.html)）：

```
#include <termios.h>

int getch( ) 
{
  struct termios oldt,
                 newt;
  int            ch;
  tcgetattr( STDIN_FILENO, &oldt );
  newt = oldt;
  newt.c_lflag &= ~( ICANON | ECHO );
  tcsetattr( STDIN_FILENO, TCSANOW, &newt );
  ch = getchar();
  tcsetattr( STDIN_FILENO, TCSANOW, &oldt );
  return ch;
} 
```

# c# - What does this mean? int i = (i = 20);

> ID：10610561
> 
> 赞同：29
> 
> 时间：2012-05-16T00:26:57.623
> 
> 标签：c#

I stumbled across this while starting to learn about vars here:

[http://msdn.microsoft.com/en-us/library/bb384061.aspx](http://msdn.microsoft.com/en-us/library/bb384061.aspx)

However, I have no idea how that is a legal expression (it is). I thought you couldn't assign to something using an a = (b=c) because (b=c) does not produce a value to assign?

Thanks for any clarification on the matter.

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-16T00:33:21.220

这是合法的。从[= 运算符 C# 参考页](http://msdn.microsoft.com/en-us/library/sbkb459w.aspx)：

> 赋值运算符 (=) 将其右侧操作数的值存储在由其左侧操作数表示的存储位置、属性或索引器中，**并将该值作为结果返回。**

（强调我的）

示例中的代码是人为设计的（并且毫无意义），但它可以在其他情况下以更简洁的方式完成有用的事情。例如：

```
BinaryTree tree;
TreeNode node;
if((node = tree.FindNodeForKey(10)) != null)
{
    // do useful things with returned node
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-16T00:35:37.933

来自 MSDN 的整个报价是：

> 使用 var 声明的变量不能在初始化表达式中使用。换句话说，这个表达式是合法的： int i = (i = 20); 但是这个表达式会产生编译时错误： var i = (i = 20);

关键是你不能在初始化表达式中使用由 var 声明的变量。换句话说，如果你使用 var 来声明 i，那么你不能在 = 符号的另一边使用 i。

正如其他人所指出的，您实际上不会编写此代码。这是一个人为的例子。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-16T00:33:10.253

我一直用那种东西。

```
public class Parameters
{
    public readonly bool ContainsSquareBrackets;

    public Parameters(string paras)
    {
        if(ContainsSquareBrackets = paras.Contains(']') || paras.Contains('['))
        {
             // do something ...
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-16T00:32:18.047

这个特定的代码是没有意义的。赋值表达式返回刚刚赋值的值。因此，结果：

```
i = 20 
```

是，当然，`20`。因此：

```
i = (i = 20); 
```

是相同的：

```
i = 20; 
```

有时，赋值返回某些东西的事实可能很有用，例如在 for 循环中：

```
for (string line; (line = reader.ReadLine()) != null;) { ... } 
```

（对于它的价值，我不会在这种特殊情况下使用这个成语）

或者将相同的值分配给多个变量：

```
int x, y;
x = y = 5; 
```

现在，两者都`x`具有`y`价值`5`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-16T00:49:12.683

It is legal in C# because [the order of evaluation for operators is left to right](http://blogs.msdn.com/b/oldnewthing/archive/2007/08/14/4374222.aspx) by default,unlike C/C++ languages that don't define a limit in [sequence point.](http://en.wikipedia.org/wiki/Sequence_point). The `=` operator assign the value to 20 and returns the value as result. It's parsed as:

```
int i; //<- i is declared. 
i = 20; // assign 20 to i variable and returns.
i = i; // assign i as i value of. 
```

It's an [ambiguous expression](http://msdn.microsoft.com/en-us/library/7hz1ky25.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-16T00:31:41.740

该代码是非线程安全的方式来将字面值 20 分配给局部变量 i。

该表达式`i = 20`具有将 20 分配给 的副作用`i`，并且在分配之后具有 的值`i`。表达式`i = (i = 20)`为 i 分配 的值`(i = 20)`，这几乎总是`i`外部分配时的值。如果线程被中断，表达式 (i = 20) 仍将具有值 20，尽管 i 在外部赋值发生时可能具有不同的值。

在任何情况下，您都不想编写这个确切的代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-16T03:05:51.400

虽然它的含义与 相同`i = 20`，但在某些情况下它可能具有有用的目的。

如果其他人将维护您的代码，并看到如下内容：

```
if ( i = some_function() ) 
```

他们可能认为这是一个错误并`=`与`==`. 为了表明这是您打算做的，您可以使用

```
if ( i = (i = some_function()) ) 
```

不过，我个人觉得`if ( i = /* = */ some_function() )`还是`i = some_function(); if (i)`为了更干净。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-22T08:32:47.763

赋值运算符返回分配的值。

因此，

```
i = 20 
```

返回 20

它被分配给 i。

所以，

```
i = (i = 20); 
```

一样好

```
i = 20; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-16T01:57:25.190

关于如何声明变量，您可以采用相同的方法。它只是您阅读的那个使阅读变得复杂。

它的存在是因为它可以用来混淆代码，在我看来它的存在与安全性有很深的联系。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-16T00:54:15.443

甚至以下在 C++ 和 C# 中也是有效的：

整数 i = i = i = 20;

上面的语句是赋值运算符从右到左操作数分配阀门的简单用法。

# java - Android with maven? Apk unknown

> ID：10610564
> 
> 赞同：12
> 
> 时间：2012-05-16T00:27:53.747
> 
> 标签：java, android, maven

Cannot get Android to work with maven. What could be the problem (generated from maven quickstart archetype):

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>asd</groupId>
    <artifactId>asd</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>apk</packaging>
    <name>asd</name>

    <properties>
        <platform.version>4.0.3</platform.version>
    </properties>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>${platform.version}</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.2.0</version>
                <configuration>
                    <androidManifestFile>${project.basedir}/AndroidManifest.xml</androidManifestFile>
                    <assetsDirectory>${project.basedir}/assets</assetsDirectory>
                    <resourceDirectory>${project.basedir}/res</resourceDirectory>
                    <nativeLibrariesDirectory>${project.basedir}/src/main/native</nativeLibrariesDirectory>
                    <sdk>
                        <platform>15</platform>
                    </sdk>
                    <emulator>
                        <avd>Android4</avd>
                    </emulator>
                    <undeployBeforeDeploy>true</undeployBeforeDeploy>
                </configuration>
                <extensions>true</extensions>
            </plugin>

            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

Leads to:

```
Project build error: Unknown packaging: apk 
```

+

```
Project build error: Unresolveable build extension: Plugin 
com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.2.0 or one of its 
dependencies could not be resolved: Failed to collect dependencies for 
com.jayway.maven.plugins.android.generation2:android-maven-plugin:jar:3.2.0 () 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-10-09T10:19:53.110

我有同样的问题，因为我在配置部分添加了 android 插件`<build><pluginManagement>`。

移动它来`<build><plugins>`解决我的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-17T12:44:12.613

为您的配置添加`extensions`选项。`android-maven-plugin`

> **扩展**
> 
> 是否从此插件加载 Maven 扩展（例如打包和类型处理程序）。

示例配置：

```
<plugin>
    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
    <artifactId>android-maven-plugin</artifactId>
    <version>3.9.0-rc.2</version>
    <extensions>true</extensions>
    <configuration>
        <sdk>
            <platform>${android.platform}</platform>
        </sdk>
    </configuration>
</plugin> 
```

这解决了带有**apk**未知包装的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-06T07:32:00.773

替换为 `<version>3.2.0</version>`然后 `<version>3.6.0</version>`清理然后安装包。3.6.0 是 android-maven-plugin 的最新版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-16T02:01:41.450

我目前正在为我的项目使用 android-maven-plugin 3.1.1 并尝试使用 3.2.0，看起来 Maven 从 Maven 中央存储库下载[所需的依赖](http://maven-android-plugin-m2site.googlecode.com/svn/dependencies.html) `emma-2.1.5320.jar`项之一时遇到了一些麻烦，但是，我已经厌倦`mvn clean install`了好几次最后下载 emma-2.1.5320.jar。

尝试运行`mvn clean install`几次，如果仍然无法正常工作，请手动下载并安装，emma-2.1.5320.jar 和 javadoc 在[Maven Central Repository](http://search.maven.org/#browse%7C1823407290)上提供：

```
mvn install:install-file -Dfile=emma-2.1.5320.jar \
                     -Dsources=emma-2.1.5320-sources.jar \
                     -Djavadoc=emma-2.1.5320-javadoc.jar \
                     -DgroupId=emma \
                     -DartifactId=emma \
                     -Dversion=2.1.5320 \
                     -Dpackaging=jar 
```

您现在应该可以使用 android-maven-plugin 3.2.0，希望对您有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-16T01:13:47.470

您已经安装了适用于 Java 项目（和 .jar 文件）的“普通”Maven 插件。对于 Android，您需要 Maven Android 插件

看看这个

[导入到 Eclipse 后，Maven 项目中的 pom 文件出错](https://stackoverflow.com/questions/6452754/error-in-pom-file-in-maven-project-after-importing-into-eclipse)

# c - Convert binary to ASCII and from ASCII to Letter in C function?

> ID：10610565
> 
> 赞同：0
> 
> 时间：2012-05-16T00:28:35.337
> 
> 标签：c, function

I've a homework that I have to do, but I'm wondering if in C we have some function that will actually convert the `8 bit` binary like for example `01010111` which is `87` and in letter is `W`

I'm going to be given a big set and I just have to store binary number in one array and convert after that I will combine all of them and return to the `main()`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:30:42.567

是的，该[`strtol`](http://pubs.opengroup.org/onlinepubs/000095399/functions/strtol.html)函数可用于解析二进制字符串的文本表示，方法是提供`2`最后一个参数（指示字符串表示以 2 为底的数字）。

# android - Video thumbnails in PhoneGap?

> ID：10610566
> 
> 赞同：2
> 
> 时间：2012-05-16T00:28:38.923
> 
> 标签：android, cordova, video-thumbnails

I want to display thumbnails for a list of video files stored on external storage in my PhoneGap/Cordova application. Here's what I have so far:

*   PhoneGap does not have an API for this at present (May '12, PhoneGap 1.6.1). Correct?
*   I can get a video thumbnail from the local file path on Android 2.2+ (which I am already targeting) with ThumbnailUtils.createVideoTHumbnail()
*   I can temporarily save that thumbnail to internal storage (preferable in my mind) with a combination of Bitmap.compress() and Context.openFileOutput()

Simple enough, but then how do I access that file with PhoneGap? I can't seem to find where in the API docs it explains accessing the internal storage system for your app's data. Furthermore, is there a better way to do this entirely in memory without writing to the file system? I wouldn't mind discarding the thumbnail after I'm finished with it. I don't expect them to be accessed often.

Any help would be appreciated. Thanks!

**Update:**

Apparently Android generates thumbnail files for the gallery already, but the file names are just IDs. I keep seeing references to a "thumbnail database" that links these IDs to the respective file, but I can't find information on how to access it. Can someone please help me with an example or some documentation?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T01:41:31.943

如果有人正在寻找类似问题的答案，我最终所做的是：

```
function pickFile(callback) {
    var options = {
        quality: 100,
        destinationType: navigator.camera.DestinationType.FILE_URI,
        sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY,
        mediaType: navigator.camera.MediaType.VIDEO
    }
    function fail(error) {
        alert(error);
    }
    navigator.camera.getPicture(callback, fail, options);
} 
```

这个选项显然是在 PhoneGap 1.1.0 中添加的，它允许您以独立于平台的方式从用户的图库中请求文件。在文档中查找不是很直观，并且您无法指定有关用户界面的任何内容，但总比没有好！我希望这可以帮助从谷歌来到这里的人。

干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T11:48:05.437

如果有人觉得这有帮助，我在 Andriod 上为 Phonegap 编写了一个小插件，用于创建捕获的图像和视频的缩略图： [https ://github.com/maxbasmanov/phonegap_thumbnailer](https://github.com/maxbasmanov/phonegap_thumbnailer)

# javascript - Clearinterval name isn't defined after JS while loop

> ID：10610567
> 
> 赞同：0
> 
> 时间：2012-05-16T00:28:45.360
> 
> 标签：javascript

I'm using this code:

```
var s_wrap = document.getElementById('slider');
var s_list = document.getElementById('slider-list');
var li_items = s_list.getElementsByTagName("li");
var next = document.getElementById('next');
var pos, item_w, refreshIntervalId;

next.onclick = function() { 
    item_w = window.getComputedStyle(li_items[0],null).getPropertyValue("width").split('px')[0]; 
    move('left', li_items[0], 10, item_w);
};

var move = function(direction, el, increment, amount) {
    while(pos <= amount){
        keep_moving = setInterval(function(){
            pos = el.style[direction].split('px')[0];
            if(pos == '') pos = 0;
            pos = parseInt(pos) + increment;
            el.style[direction] = pos + 'px';
        }, 100);
    }
    clearInterval(keep_moving); 

}; 
```

So basic gist of the code is, click a div, move a div left by 10 pixels at a time until it reaches 600px.

Now am I going about this the wrong way?

At the moment I get a

```
Uncaught ReferenceError: keep_moving is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:45:57.183

You are going about it the wrong way to answer you.

You are spawning so many intervals and will quickly kill your web page. You should try logic like so:

```
var move = function(direction, el, increment, amount) {
    pos = el.style[direction].split('px')[0];
    if(pos == '') pos = 0;
    pos = parseInt(pos) + increment;
    if(pos > amount) { return; }
    el.style[direction] = pos + 'px';
    window.setTimeout(function() { move(direction, el, increment, amount); },100);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:32:52.577

```
var move = function(direction, el, increment, amount) {
    var keep_moving; // <=============

    while(pos <= amount){
        keep_moving = setInterval(function(){
            pos = el.style[direction].split('px')[0];
            if(pos == '') pos = 0;
            pos = parseInt(pos) + increment;
            el.style[direction] = pos + 'px';
        }, 100);
    }
    clearInterval(keep_moving); 

}; 
```

虽然我必须说代码对我来说没有太大意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T00:42:07.167

SetInterval 重复执行一项任务。正确的做法是

```
function move(direction, el, increment, amount) {
    var pos = parseFloat(el.style[direction]) || 0;
    var repeated = function(){
        el.style[direction] = pos + "px";
        pos += increment;
        if(pos < amount) setTimeout(repeated, 100);
    }
    repeated();
} 
```

顺便说一句，`left`样式属性将它向右移动（它是元素应该离左边多远）

# python - Dramatic memory leak in wxpython application

> ID：10610570
> 
> 赞同：1
> 
> 时间：2012-05-16T00:29:11.973
> 
> 标签：python, memory-leaks, wxwidgets

I'm some way into building a fairly complex wxPython app using ode for physical modelling, openGL for rendering, and wx for UI. Everything was going swimmingly until the application started to crash. After a few days of making no progress I finally noticed that my application was leaking memory. I was able to distill into a smallish example script something that leaks at a quite extraordinary rate:

```
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------

import wx
import wx.propgrid as wxpg
import random

class CoordProperty(wxpg.PyProperty):
    def __init__(self, label, name, value=(0,0,0)):
        wxpg.PyProperty.__init__(self, label, name)
        self.SetValue(value)

    def GetClassName(self):
        return "CoordProperty"

    def GetEditor(self):
        return "TextCtrl"

    def ValueToString(self, value, flags):
        x,y,z = value
        return "%f,%f,%f"%(x,y,z)

app = wx.App(False)
frame = wx.Frame(None, -1, "Test")
pg = wxpg.PropertyGridManager(frame)
props = {}

for i in range(1000):
    prop_name = "prop_%d"%i
    prop = CoordProperty("Coord", prop_name)
    pg.Append(prop)
    props[prop_name] = prop

def OnTimer(event):
    global props
    for key in props:
        props[key].SetValue((random.random(), random.random(), random.random()))

timer = wx.Timer(frame, 1)
frame.Bind(wx.EVT_TIMER, OnTimer)
timer.Start(10) # 100Hz

frame.Show()

app.MainLoop()
timer.Stop() 
```

The example creates a frame, and places a wxPropertyGrid into it. It derives a property that display a 3d co-ordinate value, creates a thousand of them, and then from a timer running at 100Hz it updates each to a random value. This leaks somewhere close to 10Mb/sec, and eventually crashes. It usually crashes at shutdown too.

I'm using python 2.7 & wx 2.9.3.1 msw (classic) on Windows 7.

If I replace my derived CoordProperty with a built-in property, such as wxpg.FloatProperty, and modify the code accordingly, the leak goes away.

Any ideas? Or should I submit a wx bug? I can even remove the definition of the function ValueToString in the derived property class and the app still leaks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T02:45:59.757

我使用以下代码来计算对象：

```
def output_memory():
    d = defaultdict(int) 
    for o in gc.get_objects():
        name = type(o).__name__  
        d[name] += 1

    items = d.items()
    items.sort(key=lambda x:x[1])
    for key, value in items:
        print key, value 
```

发现你的程序每次事件都会增加 1000 个元组。所以当你调用`props[key].SetValue()`prev值时，gc还没有收集到。这可能是 wxpg 的一个 bug，我们可以通过使用`([x],[y],[z])`保存值来绕过这个 bug，这样你就可以在不调用 SetValue() 的情况下更新值：

```
for name, prop in props.iteritems():
    value = prop.GetValue()
    value[0][0] = random()
    value[1][0] = random()
    value[2][0] = random()
pg.Refresh() 
```

这是完整的代码：

```
import wx
import wx.propgrid as wxpg
from random import random
import gc

from collections import defaultdict

def output_memory():
    d = defaultdict(int) 
    for o in gc.get_objects():
        name = type(o).__name__  
        d[name] += 1

    items = d.items()
    items.sort(key=lambda x:x[1])
    for key, value in items:
        print key, value

class CoordProperty(wxpg.PyProperty):
    def __init__(self, label, name):
        wxpg.PyProperty.__init__(self, label, name)
        self.SetValue(([0],[0],[0]))

    def GetClassName(self):
        return "CoordProperty"

    def GetEditor(self):
        return "TextCtrl"

    def GetValueAsString(self, flags):
        x,y,z = self.GetValue()   
        return "%f,%f,%f"%(x[0],y[0],z[0])   

app = wx.App(False)
frame = wx.Frame(None, -1, "Test")
pg = wxpg.PropertyGridManager(frame)
props = {}

for i in range(1000):
    prop_name = "prop_%d"%i
    prop = CoordProperty("Coord", prop_name)
    pg.Append(prop)
    props[prop_name] = prop

def OnTimer(event):
    for name, prop in props.iteritems():
        value = prop.GetValue()
        value[0][0] = random()
        value[1][0] = random()
        value[2][0] = random()
    pg.Refresh()
    #output_memory()

timer = wx.Timer(frame, 1)
frame.Bind(wx.EVT_TIMER, OnTimer)
timer.Start(10) 

frame.Show()

app.MainLoop()
timer.Stop() 
```

# python - Cookie is not being saved when logging in with the Reddit API

> ID：10610573
> 
> 赞同：0
> 
> 时间：2012-05-16T00:30:07.787
> 
> 标签：python, django, cookies, reddit

I would like to add the [login](https://github.com/reddit/reddit/wiki/API%3A-login) feature of the reddit API, but the cookie is not being saved. The following code is being called in a custom Authentication Backend, which is installed higher in the stack than Django's own ModelBackend.

```
response = requests.post(REDDIT_LOGIN_URL, data={'user' : username, 
                                                 'passwd' : password})
cookie = SimpleCookie()
cookie.load(response.headers.get('set-cookie')) 
```

printing cookie['reddit_session'] returns a Morsel (obfuscated)

```
<Morsel: reddit_session='5356323%2C2012-05-15T17%3A15%3A08%xxxxxxxxxxxx7a4f25351b003a2484'> 
```

This Cookie, however, is nowhere found in my browser. When the page is reloaded, my reddit session is gone, and I can not use other reddit API calls unless I create this session again. When I use the Chrome developer tools to look at my cookies, I see an entry under Resources > Cookies called "blank". When I click this, all I get is a white page with "This site has no cookies"

I am doing this in django-1.4, with

```
SESSION_ENGINE = "django.contrib.sessions.backends.signed_cookies" 
```

enabled in settings.py. I tried it without with the same results.

Am I missing something here? I've tried using [narwa](http://narwal.readthedocs.org/en/latest/index.html) as well, and the cookie is not being saved either. My cookies are definitely enabled in my browser as the same Django session is saving the django_language and session_id cookies.

Any pointers or answers are appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:12:40.660

我不太确定，但是当我在使用 API 时，我只需要存储它`modhash`并将其与我的请求一起发送。此外，如果您正在使用该`requests`模块，请改用会话实例，它将跨调用存储 cookie。不过，我不确定这对 Django 有什么影响。这是我为登录而编写的代码：

```
def login(username, password):
    """logs into reddit, saves cookie"""

    print 'begin log in'
    #username and password
    UP = {'user': username, 'passwd': password, 'api_type': 'json',}
    headers = {'user-agent': '/u/STACKOVERFLOW\'s API python bot', }
    #POST with user/pwd
    client = requests.session()

    r = client.post('http://www.reddit.com/api/login', data=UP)

    #print r.text
    #print r.cookies

    #gets and saves the modhash
    j = json.loads(r.text) #I believe r.json == j at this point

    client.modhash = j['json']['data']['modhash']
    print '{USER}\'s modhash is: {mh}'.format(USER=username, mh=client.modhash)

    #pp2(j)

    return client 
```

# puppet - Puppet 服务器/客户端连接失败

> ID：10610589
> 
> 赞同：3
> 
> 时间：2012-05-16T00:31:09.950
> 
> 标签：puppet

我的 Mac 上有几个并行 Vms，我试图在它们之间建立一个简单的连接，作为 puppet master 和 puppet client。

1.  Puppet Master（在 CentOs 6.2 上）
2.  Puppet 客户端（在 Ubuntu 12.1 服务器上）

尝试使用以下命令连接客户端时。

```
puppet agent --server 192.168.1.103 --waitforcert 60 --test --verbose 
```

它尝试连接以下输出

```
warning: peer certificate won't be verified in this SSL session
info: Caching certificate for ca
warning: peer certificate won't be verified in this SSL session
warning: peer certificate won't be verified in this SSL session
info: Creating a new SSL certificate request for puppet1.localdomain
info: Certificate Request fingerprint (md5) : 2E:C6:D2:C2:........
warning: peer certificate won't be verified in this SSL session
warning: peer certificate won't be verified in this SSL session
warning: peer certificate won't be verified in this SSL session
warning: peer certificate won't be verified in this SSL session
notice: Did not receive certificate 
```

在服务器端，我让调试 puppet master 监听以下输出：

```
notice: Starting Puppet master version 2.7.14
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: access[^/catalog/([^/]+)$]: allowing 'method' find
info: access[^/catalog/([^/]+)$]: allowing $1 access
info: access[^/node/([^/]+)$]: allowing 'method' find
info: access[^/node/([^/]+)$]: allowing $1 access
info: access[/certificate_revocation_list/ca]: allowing 'method' find
info: access[/certificate_revocation_list/ca]: allowing * access
info: access[/report]: allowing 'method' save
info: access[/report]: allowing * access
info: access[/file]: allowing * access
info: access[/certificate/ca]: adding authentication any
info: access[/certificate/ca]: allowing 'method' find
info: access[/certificate/ca]: allowing * access
info: access[/certificate/]: adding authentication any
info: access[/certificate/]: allowing 'method' find
info: access[/certificate/]: allowing * access
info: access[/certificate_request]: adding authentication any
info: access[/certificate_request]: allowing 'method' find
info: access[/certificate_request]: allowing 'method' save
info: access[/certificate_request]: allowing * access
info: access[/]: adding authentication any
info: Inserting default '/status' (auth true) ACL because none were found in '/etc/puppet/auth.conf'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate for 'puppet1.localdomain'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate_request for 'puppet1.localdomain'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
notice: puppet1.localdomain has a waiting certificate request
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate for 'puppet1.localdomain'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate for 'puppet1.localdomain'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate for 'puppet1.localdomain'
err: Could not resolve 192.168.1.101: no name for 192.168.1.101
info: Could not find certificate for 'puppet1.localdomain' 
```

是否可以在不使用主机解析和简单 IP 地址的情况下设置简单的 puppet 配置？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T02:27:23.623

我解决了这个问题，只是在 /etc/hosts 文件中添加了两个 VM 的 ip。然后木偶为我工作得很好。

# python - 使用 argparse 选项指定类型和模式

> ID：10610592
> 
> 赞同：0
> 
> 时间：2012-05-16T00:31:18.897
> 
> 标签：python, argparse

我有几个不同的输入文件，用案例编号“.1”、“.2”等保存以区分它们。我正在构建一个对这些文件进行操作的脚本，并且我想使用 argparse 来允许用户指定要操作的特定案例编号，或者使用“_”来指定最后保存的案例（即带有最大案件数）。就像是;

```
> ls 
   file.1, file.2, file.3
> my_script.py 2
   (operates on file.2)
> my_script.py _
   (operate on file.3) 
```

有没有一种方法可以将“任何整数”指定为一种选择，将“_”指定为第二种选择？就像是;

```
parser = argparse.ArgumentParser()
parser.add_argument('case', choices=[anyint, '_']) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T01:07:41.587

您可以使用该[`type`](http://docs.python.org/dev/library/argparse.html#type)参数来`add_argument(...)`代替。例如：

```
import os
import argparse

def intOrUnderscore(s):
    if s != '_':
        return int(s)
    cases = (n for n in os.listdir(".") if n.startswith("file."))
    return max(int(c[c.rindex(".")+1:]) for c in cases)

parser = argparse.ArgumentParser()
parser.add_argument('case', type=intOrUnderscore)

args = parser.parse_args()
print args.case 
```

当我运行它时，我得到：

```
$ ls
file.1  file.2  file.3  s.py
$ python s.py 2
2
$ python s.py _
3 
```

或者，您可以在代码中构建选择列表：

```
import os
import argparse

cases = [n[n.rindex(".")+1:] for n in os.listdir(".") if n.startswith("file.")]
cases.append("_")
parser = argparse.ArgumentParser()
parser.add_argument('case', choices = cases)

args = parser.parse_args()
print args.case 
```

# android - 如何开始安卓游戏开发？

> ID：10610593
> 
> 赞同：0
> 
> 时间：2012-05-16T00:31:23.177
> 
> 标签：android, actionscript-3, air, adobe

首先是一点背景知识：我之前用 C、C++、Java 和 Actionscript 2.0 编写过一些代码。我最熟悉 C 编程，因为我在其中学习过实际课程。

我可能有兴趣学习如何使用 Adob​​e AIR/Flash CS6 来做这件事，但最好是开始使用 Java 进行开发并使用 Android SDK 吗？或者我可以在 SDK 中使用 C 吗？

我只是有点迷失从哪里开始，因为无论我走哪条路，都会有很多我一无所知的事情。我想我只是想知道我应该先开始熟悉什么。

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:36:12.017

如果你只是想做游戏开发，这仍然是一个陡峭的山坡，但我认为像[Unity3D](http://unity3d.com/)这样的通用游戏引擎将是你最好的选择。还有很多东西要学，但都是针对你实际在做什么，而不是你需要学习大量的东西来掌握 ActionScript 3 和 Flash 和/或原生 Java Android 代码。

最终，您要问的问题是“为什么选择 Android”？有一堆跨平台开发工具（你自己命名的）可以编译到 Android 上。你的目标是什么？如果是写游戏和卖游戏，那么你最好的就是不要把自己局限在安卓上，而是建立在一个可以轻松移植到很多地方的环境中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:22:50.627

我同意[Dr.Dredel](https://stackoverflow.com/users/59947/dr-dredel)提到的[Unity3D](http://unity3d.com/)等跨平台开发工具。但是，在 Native 中，您拥有的能力比其他工具多。从 Canvas 开始进行 2D 游戏开发是一种很好的做法。要获得更多经验，请潜入 OpenGL ES 池。我就是这样开始的。[Apress](http://www.apress.com/)有很多有用的书籍，您可以参考它们。

[适用于 Android 的 Pro OpenGL ES](http://www.apress.com/mobile/android/9781430240020)， [高级 Android 4 游戏](http://www.apress.com/mobile/android/9781430240594)（这可能对您有好处，因为您说您有 C 开发经验）， [Pro Android 应用程序性能优化](http://www.apress.com/mobile/android/9781430239994)， [实用 Android 4 游戏开发](http://www.apress.com/mobile/android/9781430240297)， [开始 Android 4 游戏开发](http://www.apress.com/mobile/android/9781430239871)， [Pro Android 网页游戏应用](http://www.apress.com/mobile/android/9781430238195)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:37:54.390

Java 是应用于开发 Android 应用程序的首选语言。您可能还必须使用 Eclipse，但还有其他一些。就个人而言，当我决定要制作一个 Android 应用程序时，我没有编程语言或任何基本的计算机科学知识。YouTube 视频、源代码和 developer.android.com 帮助中的开发页面。了解Java非常有用。只是练习和学习android源代码。你有背景，现在你可以专注于你想要的产品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T01:23:18.307

如果你想为 Android 开发，你最好使用 Java。暂时忘掉 C/C++ 和本地库吧。

1.  拿一本书。任何最近的书都可以，只需翻阅页面并确保它们不会专注于单一主题，例如“将十年前的 PC 游戏移植到 Android”，而是提供广泛的解释，最好包括 2D 和 3D 开发细节。就在我的脑海中，“实用的 Android 4 游戏开发 2011”当我上次看到它时看起来不错，但我相信还有很多其他不错的书。

2.  获取工具。使用一个不错的 Linux 机器，下载和安装 SDK 和 Eclipse 大约需要 1 小时。Android 基于 Linux，因此虽然在 Windows 上编码可能很有趣，但我建议不要这样做。

3.  浏览本书和 SDK 示例。将代码复制/粘贴到 Eclipse 中并使其工作。你不需要一个实际的设备，模拟器对于基本教程和示例就足够了。

4.  完成 pp.1-3 后，您应该已经掌握了 Android 编程并准备好参与某种项目。不要单独开始，让您的朋友参与或加入现有的开发。与技术熟练的人一起工作是最简单的学习方式。

5.  玩得开心！=)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T01:49:14.413

同时学习 OpenGL*和*Android SDK 可能是一项非常艰巨的任务。除非您已经熟悉 OpenGL，否则我建议您使用[AndEngine](http://www.andengine.org/)游戏库。它将 OpenGL 抽象为对于开始使用 Android 游戏编程的人来说可能更易于使用的 API。

对于更雄心勃勃的游戏，我会避免使用 Adob​​e Air，因为它不允许多线程。

# android - 退出android中的活动时后退按钮挂起/功能延迟

> ID：10610594
> 
> 赞同：0
> 
> 时间：2012-05-16T00:31:25.870
> 
> 标签：android

1.我有一个 android 客户端应用程序，我在其中从相机抓取帧并将它们写入套接字。

2.在发送每一帧之前，服务器和客户端之间有一些通信，所以我必须使用像inbuffer.readLine()这样的函数。

3.当这个活动开始时，我在 onResume() 中创建一个单独的线程来发送帧。

4.问题是在发送帧时，如果我按下后退按钮，大约需要 5-6 秒（预览继续运行并且帧仍在发送）才能返回到以前的活动，或者甚至可能不听触手可及！

如果有人能指导我如何克服这个问题，我将不胜感激。谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:52:06.130

也许[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)可以帮助解决您的问题。

# php - 基于Javascript读取的Cookie读取和格式化页面使延迟可见

> ID：10610597
> 
> 赞同：0
> 
> 时间：2012-05-16T00:31:46.923
> 
> 标签：php, javascript, cookies

我有一个使用 Javascript 制作的侧边栏/内容列布局切换器。在具有主要内容列和侧边栏列的博客上。

```
==========Content Column========  ==Sidebar==    
================================  ===========  
================================  ===========  
================================  ===========  
================================  ===========  
================================  ===========  
================================  ===========  
================================  =========== 

==Sidebar==  ==========Content Column========  
===========  ================================  
===========  ================================  
===========  ================================  
===========  ================================  
===========  ================================  
===========  ================================  
===========  ================================ 
```

**工作原理**：
用户可以选择一个按钮，该按钮![在此处输入图像描述](../Images/67e107f10cb8817ef5aed2bcdf759dd4.png)将切换布局以在页面左侧或右侧显示侧边栏。一旦他们点击切换器按钮，我就会使用 Javascript 将值保存到浏览器 Cookie 中，并使用 CSS 进行切换。这很好用，因此页面不需要重新加载或类似的东西。

现在有问题的部分，一旦页面被重新加载或网站上的另一个页面被加载，如果我使用 Javascript 读取 Cookie 值，那么页面必须加载然后进行切换，所以切换布局会有延迟对用户可见，这很俗气。我知道简单的解决方案是使用 PHP 读取 Cookie 并为正在加载的页面的列 priotr 设置适当的 CSS。

不过我的问题是，是否可以读取 Cookie 并使用 Javascript 切换布局位置但没有任何可见的延迟？还是我必须坚持在服务器端构建它以避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T03:11:07.117

您可以在正文开始呈现页面之前读取 cookie 并编写样式表。

# sql - 小型文档/记录、不变数据、大量写入、快速读取的最佳（NoSQL？）数据库？

> ID：10610598
> 
> 赞同：8
> 
> 时间：2012-05-16T00:31:50.380
> 
> 标签：sql, nosql

我发现了一些与此相同的问题，但它们没有包含有关所存储数据的性质、查询方式等方面的太多细节……所以我认为这值得发布。

我的数据非常简单，三个字段： - 一个“日期时间戳”值（日期/时间） - 两个字符串，“A”和“B”，均 < 20 个字符

我的应用程序的写入量很大（每秒数百次）。所有写入都是新记录；一旦插入，数据就永远不会被修改。

定期读取每隔几秒钟发生一次，用于填充一些近乎实时的仪表板。我查询日期/时间值和字符串值之一。例如，获取日期时间戳在特定范围内且字段“B”等于特定搜索值的所有记录。这些查询通常每个返回几千条记录。

最后，我的数据库不需要无限增长；我将通过手动删除它们或使用缓存到期技术（如果数据库支持）来清除 10 天以上的记录。

我最初在 MongoDB 中实现了这一点，没有意识到它处理锁定的方式（写入块读取）。随着我的扩展，我的查询花费的时间越来越长（现在 30 多秒，即使有正确的索引）。现在，根据我所学到的，我相信大量的写入正在耗尽我的阅读量。

我已经阅读了[kkovacs.eu](http://kkovacs.eu/cassandra-vs-mongodb-vs-couchdb-vs-redis)比较各种 NoSQL 选项的帖子，虽然我学到了很多东西，但我不知道我的用例是否有明显的赢家。我将非常感谢熟悉这些选项的人的推荐。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T06:36:45.633

我以前在记录过程控制测量的系统中遇到过这样的问题。这是使用 5 MHz IBM PC 完成的，因此绝对有可能。用例更加多样化——按分钟、小时、八小时班次、日、周、月或年进行汇总——因此系统记录了所有原始数据，但也针对最常见的查询动态汇总（这是五分钟的平均值）。就您的仪表板而言，五分钟聚合似乎也是一个主要目标。

也许这可以通过为每个输入流编写一对文本文件来解决：一个包含所有原始数据；另一个与多分钟聚合。仪表板将忽略原始数据。当然，可以使用数据库来做同样的事情。但是简化应用程序可能意味着不需要 RDB。更易于设计和维护，更易于安装在微控制器、嵌入式系统等上，或者是共享主机上更友好的邻居。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T06:07:47.567

决定一款合适的 NoSQL 产品并非易事。我建议你在做出选择之前了解更多关于 NoSQL 的知识，如果你真的想确保你最终不会相信别人的建议或收藏。

有一本很好的书，它提供了关于 NoSQL 的非常好的背景，任何开始使用 NoSQL 的人都应该阅读这本书。

[http://www.amazon.com/Professional-NoSQL-Wrox-Programmer/dp/047094224X](https://rads.stackoverflow.com/amzn/click/com/047094224X)

我希望阅读本书中的一些章节能对你有所帮助。有比较和解释什么对什么工作有好处等等。

祝你好运。

# ember.js - 在 EmberJS 中，模板完成渲染后执行 jQuery 插件调用的函数是什么？

> ID：10610606
> 
> 赞同：2
> 
> 时间：2012-05-16T00:33:02.233
> 
> 标签：ember.js

我试过“didInsertElement”，但这似乎不起作用，标记不存在，然后 jQuery 插件代码执行速度太快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T02:48:31.883

你会提供你的问题的 jsFiddle 吗？另外，尝试做：

```
didInsertElement: function() {
  Ember.run.next(optionalContext, function() {
    // Your code here
  });
} 
```

这将在当前运行循环结束时运行您的代码，这应该保证所有渲染和绑定都已执行。

但请提供一个 jsFiddle，以便给出更准确的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-17T21:04:02.787

确保您在视图上使用了内置的 jQuery 选择器 - this.$() - 即使尚未插入元素，它也能正常工作。

```
didInsertElement: function() {
  this.$().jQueryPlugin();
} 
```

# sql - 特定类别/值对的 SQL 算法

> ID：10610610
> 
> 赞同：3
> 
> 时间：2012-05-16T00:33:33.573
> 
> 标签：sql

我有一个有两列的表。第一列中的项目代表四个类别之一，第二列中的项目代表其类别对应项引用的数据：

```
CategoryA : 2
CategoryC : 1
CategoryB : 4
CategoryB : -1
CategoryD : 2
CategoryC : 1 
```

等等

我需要构建一个 SQL 查询，该查询将返回每个类别的 Sum，例如

```
CategoryA : 2
CategoryB : 3
CategoryC : 2
CategoryD : 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:36:18.870

您可以通过将相关行组合在一起，并对每个行的值求和来做到这一点：

```
select col1, sum(col2)
  from table_name
group by col1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:39:38.600

```
SELECT column1, SUM(column2) FROM table GROUP BY column1 
```

# jquery - 网站加载计时器工具演示有效性

> ID：10610613
> 
> 赞同：0
> 
> 时间：2012-05-16T00:34:04.673
> 
> 标签：jquery, ajax, performance, page-load-time

我正在构建一个通过提供 ajax 前端和 cdn 后端来加速站点搜索的工具。

我想在演示中直观地演示使用我的 ajax 前端和普通 html 重新加载模型之间的区别。我需要一个工具，例如浏览器扩展或其他工具，可以显示**从站点上的一个页面到另一个页面**的转换。有很多工具可以显示页面加载时间。那不是我所追求的。我想展示从一个 ajax 状态到另一个 ajax 状态的转换。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:40:11.597

正如安迪所提到的，您可以使用[WebPagetest](http://www.webpagetest.org/)来做到这一点。不要对“脚本”感到厌烦，有相当数量的示例，我也很乐意为特定案例提供帮助。

你可以用它做的一件很酷的事情是将序列记录为视频并让它创建一个并排的视频，这样你就可以展示实际的用户体验（它总是比指标卖得更好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T16:12:25.357

WebPageTest 可以做到这一点，但您需要学习如何编写脚本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:37:53.107

> 我需要一个工具，例如浏览器扩展程序或其他工具，可以显示从站点上的一个页面到另一个页面的转换。

我认为解决方案是制作两个单独的页面并并排比较它们，打开萤火虫（或类似工具）

或者您可以进行实际演示并自己执行过渡。我不知道有什么工具只提供两个站点及其基准的并排比较，除非您将 powerpoint 演示文稿或白皮书视为“工具”

此外，您可以使用 JSPerf (http://jsperf.com/) 对实际 javascript 代码性能进行可视化基准测试

# parsing - 解析：cURL HTTP Post

> ID：10610617
> 
> 赞同：1
> 
> 时间：2012-05-16T00:34:55.307
> 
> 标签：parsing, ssl, curl, certificate

我正在使用 cURL 发布到 Parse (www.parse.com)。他们有一个 REST，允许我通过 POST 和 GETS 管理某些事情。

但是，我收到以下回复：

```
{"error":"unauthorized"} 
```

我正在使用 JSONLint.com 验证的 JSON。我的应用程序 ID 和休息密钥是正确的 - 我相信这与我提供给 cURL 的证书不足有关。我已经阅读了一些关于在 Windows 上使用 cURL 的主题：

[http://richardwarrender.com/2007/05/the-secret-to-curl-in-php-on-windows/](http://richardwarrender.com/2007/05/the-secret-to-curl-in-php-on-windows/)

[http://curl.haxx.se/docs/sslcerts.html](http://curl.haxx.se/docs/sslcerts.html)

所以我下载了他们建议的 .pem 文件，并在我的请求中使用了 --cacert 以达到同样的效果。

我应该从 www.parse.com 获得证书吗？谢谢！

# html - 在我的下面有一个完整的空块和元标记

> ID：10610618
> 
> 赞同：0
> 
> 时间：2012-05-16T00:35:28.240
> 
> 标签：html, utf-8

我的 html 文件如下所示，网站是越南语，所以我使用 utf-8 进行编码。
但是当我在Chrome中查看文件时，在body标签下，有一个巨大的空块“”，所有的元标签也在body中。
我不明白为什么我将所有元标签都写在 head 标签中，但它们出现在 body 标签中......

与 utf-8 编码有什么关系。什么是巨大的块？有人可以帮助我吗？谢谢！！！

 `````
<head>  
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />        
    <meta name="description" content="something ...." />
    <meta name="keywords" content="something... />

    <link href="tablestyle.css" type="text/css" rel="stylesheet" />
    <link href="hinhanh.css" type="text/css" rel="stylesheet" />
    <link href="index.css" type="text/css" rel="stylesheet" />

    <title>mypage.com</title>
</head>

<body>
         Content here

    </body> 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:39:07.383

这是因为您的代码文件的编码。使用记事本++将文件的编码设置为“UTF-8 without BOM”...``

# apache - htaccess 干净的 url 不起作用

> ID：10610622
> 
> 赞同：0
> 
> 时间：2012-05-16T00:36:03.843
> 
> 标签：apache, .htaccess, mod-rewrite

我在使用 .htaccess 时遇到了很多麻烦，无法真正完成任何事情。

该网站的网址如下所示：

```
site.com/index.php?page=22 
```

我希望它看起来像

```
site.com/pages/22 
```

或任何东西。重要的是，如果有人遵循

```
site.com/pages/22 
```

他们将看到通常由非 clean-url 显示的内容。我有几十条这样的规则要写，我很乐意自己做那部分，但在我在网上阅读的教程和规则中，我做了任何事情——完全没有！

非常感谢您的起点，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:05:18.613

这应该可以完成工作：

重写规则 ^pages/([^/]*)$ /index.php?page=$1 [L]

# javascript - DIV 未在加载时显示

> ID：10610626
> 
> 赞同：0
> 
> 时间：2012-05-16T00:36:29.473
> 
> 标签：javascript, slideshow

首次访问该页面时，不会加载 Project-1 描述。当您滚动到第二张图片时，它会缓和下来。我希望立即加载第一个项目的描述。functions.js 不是我写的，我在里面找不到我需要的代码。我是个黑客，试图通过戳戳和刺激来学习。

我已经在脚本中“找到”了“project-1”的所有实例，并一次删除它们以查看效果。没运气。

我还希望向上箭头像 OnMouseOver 向下箭头一样改变透明度，但它在所有 Project-1 图像上都被禁用

帮助？谢谢！

[http://boellingsmith.com/design.html](http://boellingsmith.com/design.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:39:47.503

试试这个（在下面添加代码）：

```
<script>
  $(document).ready(function() {
    $("span.project-1").addClass('active');
  });
</script> 
```

# algorithm - 查找给定开始和结束时间的并发事件数

> ID：10610627
> 
> 赞同：8
> 
> 时间：2012-05-16T00:36:43.260
> 
> 标签：algorithm, data-structures, language-agnostic, computational-geometry

我有大量（~10 ⁹）事件集，以开始和结束时间为特征。给定一个时间，我想知道当时有多少这些事件正在进行。

在这种情况下，什么样的数据结构会有所帮助？我需要快速的操作是：

1.  插入新事件，例如`{start: 100000 milliseconds, end: 100010 milliseconds}`.
2.  查询给定时间的并发事件数。

* * *

更新：有人在这上面放了一个计算几何标志，所以我想我应该用计算几何来改写它。我有一组一维区间，我想计算这些区间中有多少与给定点相交。新间隔的插入必须很快。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T01:05:05.810

您正在寻找[区间树](http://en.wikipedia.org/wiki/Interval_tree)。

*   构造：`O(n log n)`，其中`n`是区间数
*   Query: `O(m+log n)`，其中`m`为查询结果`n`数，为区间数
*   空间：`O(n)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T03:43:22.987

只是为了添加其他答案，根据时间长度和所需的粒度，您可以简单地拥有一个计数器数组。例如，如果时间长度为 24 小时，所需的粒度为 1 毫秒，则数组中将有 86,400,000 个单元格。每个单元有一个 4 字节 int（足以容纳 10^9），这将小于 700 MB 的 RAM，而基于树的解决方案至少需要 (8+8+4+4)*10^ 9 = 24 GB RAM 用于两个指针加上每个树节点两个整数（由于 32 位可寻址内存不足，每个指针需要 64 位）。您可以使用交换，但这会大大减慢一些查询。

如果您只关心最近 24 小时的数据，也可以使用此解决方案，例如，将数组用作循环缓冲区。除了时间和粒度的限制之外，另一个缺点是间隔的插入时间与间隔的长度成正比，所以如果间隔长度是无限的，你可能会遇到麻烦。另一方面，查询是单个数组查找。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T16:37:00.373

（由 tskuzzy 和 Snowball 扩展答案）

平衡的二叉搜索树是有意义的，只是内存需求对于您的数据集来说会过多。除非您可以使用库，否则B [-tree](http://en.wikipedia.org/wiki/B-tree)的内存效率会更高，尽管会更复杂。

保留两棵树，一棵开始时间，一棵结束时间。要插入事件，请将开始时间添加到开始时间树，将结束时间添加到结束时间树。要查询时间 T 的活动事件数，请搜索开始时间树以找出有多少开始时间小于 T，并搜索结束时间树以找出有多少结束时间小于 T。结束时间与开始时间的数量，这就是活动事件的数量。

插入和查询都应该花费 O(log N) 时间。

几点评论：

*   您表达问题的方式，您只关心活动事件的*数量*，而不关心*哪些*活动是活动的。这意味着您无需跟踪哪个开始时间与哪个结束时间！这也使得避免先前答案引用的查询中的“+M”术语变得更容易。

*   请注意查询的确切语义。特别是，如果一个事件在时间 T 开始，那么它在时间 T 是否算作活动的？如果它在时间 T 结束？这些问题的答案会影响您在某些地方是否使用 < 或 <=。

*   不要**使用**“集合”数据结构，因为您几乎肯定希望允许和计算重复项。也就是说，不止一个事件可能同时开始和/或结束。一组通常会忽略重复项。相反，您正在寻找的是“多集”（有时称为“包”）。

*   许多二叉搜索树不支持开箱即用的“元素数 < T”查询。但是很容易通过在每个节点上存储一个大小来添加这个功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T03:17:34.663

假设我们有一个带有*N*个元素的有序集合（例如，[平衡二叉搜索树](http://en.wikipedia.org/wiki/Balanced_binary_search_tree)或[跳过列表](http://en.wikipedia.org/wiki/Skip_list)）数据结构。此外，假设排序集具有*O(log N)*搜索时间、*O(log N)*插入时间和*O(N)*空间使用（这些是合理的假设，例如，参见[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)）。

 ***一种可能性是有两个排序集，`bystart`和`byend`，分别按事件的开始时间和结束时间排序。

要查找在 time 正在进行的事件数`t`，请询问`byend`结束时间大于 的第一个时间间隔`t`：*O(log N)*搜索操作。调用这个间隔的开始时间`left`。现在，询问`bystart`开始时间大于或等于`left`且小于的间隔数`t`。这是*O(log N + M)*，其中*M*是此类间隔的数量。因此，搜索的总时间是*O(log N + M)*。

对于排序集，插入是*O(log N)*，我们必须对每个排序集执行一次。这使得插入操作的总时间为*O(log N)*。

从头开始构建这个结构只包含*N*次插入操作，因此构建的总时间是*O(N log N)*。

每个排序集的空间使用量为 O(N *)*，因此总空间使用量为*O(N)*。

概括：

*   插入：*O(log N)*，其中*N*是间隔数
*   构造：*O(N log N)*
*   查询：*O(log N + M)*，其中*M*是结果数
*   空间：*O(N)****

# browser - iPhone 和 iPad 的 Safari 浏览器标签

> ID：10610629
> 
> 赞同：0
> 
> 时间：2012-05-16T00:37:07.543
> 
> 标签：browser, safari

有没有办法确定访问网站的 Safari 浏览器是否在 iPhone 和 iPad 上运行？我不想在 iPad 上加载移动网站

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:58:01.813

我没有尝试过，但这似乎是正确的：

```
if(strstr($_SERVER['HTTP_USER_AGENT'],'iPhone') || strstr($_SERVER['HTTP_USER_AGENT'],'iPod'))
{
    header('Location: http://yoursite.com/iphone');
    exit();
} 
```

该站点也有一个 javascript 示例： [http ://davidwalsh.name/detect-iphone](http://davidwalsh.name/detect-iphone)

要获得更长的解释，您可能会发现此博客很有趣：

[http://www.bionicworks.com/php/detect-ipads-safari-browser-and-redirect-to-html5-page](http://www.bionicworks.com/php/detect-ipads-safari-browser-and-redirect-to-html5-page)

# dns - 使用 ASP 或 ASP.net 查找域名服务器

> ID：10610630
> 
> 赞同：0
> 
> 时间：2012-05-16T00:37:25.897
> 
> 标签：dns, nameservers

我正在尝试找到一个函数，我将向她发送一个域名，并显示将返回该域名的名称服务器（NS1，NS2）。

有人知道我在哪里可以找到那个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:07:41.857

您可以将此作为参考，如果您使用的是 c#，则在 asp.net 上使用它没有任何问题

[http://www.c-sharpcorner.com/UploadFile/DougBell/NSLookUpDB00112052005013753AM/NSLookUpDB001.aspx](http://www.c-sharpcorner.com/UploadFile/DougBell/NSLookUpDB00112052005013753AM/NSLookUpDB001.aspx)

编辑：也参考这个堆栈问题： [如何执行“nslookup 主机服务器”](https://stackoverflow.com/questions/5468348/how-to-perform-nslookup-host-server)

祝你好运！

# ruby - 如何将地图与 to_s 结合起来？

> ID：10610634
> 
> 赞同：3
> 
> 时间：2012-05-16T00:38:03.247
> 
> 标签：ruby

我正在使用 Mongoid 并检索一堆`BSON::ObjectId`实例。理想情况下，我想在检索时将它们转换为字符串。什么是正确的语法？可以像这样分两行完成：

```
foo = Bar.where(:some_id => N).map(&:another_id)
ids_as_strings = foo.map(&:to_s) 
```

`to_s`在上面的地图调用之后，正确的 Ruby 链接方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T01:46:48.427

这工作正常，但不要这样做！

```
ids_as_string = Bar.where(:some_id => N).map(&:another_id).map(&:to_s) 
```

它看起来确实很酷，但想想看，你正在做两张地图。映射用于循环数组或其他内容，并将在每个位置进行操作，检索新数组或其他内容以及结果。

那么，如果要进行两次操作，为什么要进行两次循环呢？

```
ids_as_string = Bar.where(:some_id => N).map {|v| v.another_id.to_s} 
```

这应该是在这种情况下要走的路，实际上看起来更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:53:53.553

您可以直接链接它：

```
ids_as_string = Bar.where(:some_id => N).map(&:another_id).map(&:to_s) 
```

我用一个模型尝试了这个，我得到了你所期望的，比如：

```
["1", "2", ...] 
```

# jquery - 如何使用 jQuery 获取相同兄弟元素中嵌套元素的 DOM 位置？

> ID：10610635
> 
> 赞同：1
> 
> 时间：2012-05-16T00:38:28.927
> 
> 标签：jquery, dom

在下面的示例中，如何获得相对于文档的第三个列表项的确切 DOM 路径？

```
<body>
    <ul>
        <li>Content</li>
        <li>Content</li>
        <li>Content</li>
        <li>Content</li>
        <li>Content</li>
    </ul>
</body> 
```

除了它在其他列表项中的位置（第三个）之外，如果所讨论的列表项中或有关列表项没有任何独特的东西可以将其与其他项区分开来，如何做到这一点。此外，这需要在点击事件上动态获取，因此它可能是第二个列表项，或者第四个，等等。

我有哪些选择？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:42:07.023

你可以使用`eq()`：

```
 var $elem = $('ul:eq(0)').find('li:eq(2)'); 
```

* * *

你可以使用`index()`方法：

```
 $elem.click(function(){
      var ind = $(this).index();
   }); 
```

[http://jsfiddle.net/s5XH2/](http://jsfiddle.net/s5XH2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:42:23.333

此 jquery 检索第三个 LI：

```
$('ul li:nth-child(3)') 
```

在这里查看：http: [//jsfiddle.net/VnRjq/](http://jsfiddle.net/VnRjq/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T00:57:58.990

您可以使用`.index()`来检索单击的元素的索引。

查看一个工作示例 - [http://jsfiddle.net/Hxwkp/](http://jsfiddle.net/Hxwkp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T00:42:44.490

```
$("body ul li:eq(2)").bind("click",function(){
    //
}); 
```

# sql - SQL Server 2008 中的 CUME_DIST() 等价物是什么？

> ID：10610640
> 
> 赞同：1
> 
> 时间：2012-05-16T00:39:20.113
> 
> 标签：sql, sql-server, sql-server-2008, tsql, analytics

SQL Server 2012 似乎引入了[CUME_DIST()](http://msdn.microsoft.com/en-us/library/hh231078.aspx)和[PERCENT_RANK](http://msdn.microsoft.com/en-us/library/hh213573.aspx)用于计算列的累积分布。SQL Server 2008 中是否有等效的功能来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T02:14:12.183

永远不要说永远，在 SQL 中。

该声明：

```
select percent_rank() over (partition by <x> order by <y>) 
```

本质上等同于：

```
select row_number() over (partition by <x> order by <y>) / count(*) over (partition by <x>) 
```

本质上意味着它在数据中没有重复项时有效。即使有重复，它也应该足够接近。

“真正”的答案是它相当于：

```
select row_number() over (partition by <x> order by <y>) / count(distinct <y>) over (partition by <x>) 
```

但是，我们没有 count(distinct) 作为函数。而且，除非你真的需要，否则在 2008 年表达是一种痛苦。

函数 cume_dist() 更难，因为它需要一个累积和，你需要一个自连接。假设没有重复的近似值：

```
with t as (select <x>, <y>,
                  row_number() over (partition by <x> order by <y>) as seqnum
           from <table>
          )
select t.*, sumy*1.0 / sum(sumy) over (partition by <x>)
from (select t.*, sum(tprev.y) as sumy
      from t left outer join
           t tprev
           on t.x = tprev.x and t.seqnum >= tprev.seqnum
     ) t 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T02:42:10.803

2012 年之前不存在等效函数，但一种可能的解决方法涉及递归 CTE，至少对于 < 32767 行的数据集。在这里，一对骰子被掷了 30 次：

```
SET NOCOUNT ON;

DECLARE @t TABLE(i INT);
DECLARE @i INT=0;

WHILE @i<30 BEGIN
INSERT INTO @t VALUES (CAST(RAND()*6 AS INT)+1 + CAST(RAND()*6 AS INT)+1);
    SET @i+=1;
END

DECLARE @tc INT; SELECT @tc=COUNT(*) FROM @t;

WITH a AS (
    SELECT *
    , d=CAST(COUNT(1)OVER(PARTITION BY i ORDER BY i) AS DECIMAL(5,2)) / @tc
    , r=ROW_NUMBER()OVER(ORDER BY i)
    , pr=CAST((RANK()OVER(ORDER BY i)-1)AS DECIMAL(5,2)) / (@tc - 1)
    FROM @t
)
, rcte (i, d, r, cd, pr) AS (
    SELECT i, d, r, d, pr
    FROM a
    WHERE r=1

    UNION ALL

    SELECT a.i, a.d, a.r
    , CASE WHEN rcte.i<>a.i THEN CAST(rcte.cd+a.d AS DECIMAL(5,2)) ELSE rcte.cd END
    , a.pr
    FROM a
    INNER JOIN rcte ON rcte.r + 1 = a.r
)
SELECT i,cd,pr FROM rcte
OPTION (MAXRECURSION 32767) 
```

结果：

```
i           cd                                      pr
----------- --------------------------------------- ---------------------------------------
2           0.0333333333333                         0.0000000000000
3           0.0700000000000                         0.0344827586206
4           0.2400000000000                         0.0689655172413
4           0.2400000000000                         0.0689655172413
4           0.2400000000000                         0.0689655172413
4           0.2400000000000                         0.0689655172413
4           0.2400000000000                         0.0689655172413
5           0.3100000000000                         0.2413793103448
5           0.3100000000000                         0.2413793103448
6           0.3800000000000                         0.3103448275862
6           0.3800000000000                         0.3103448275862
7           0.5100000000000                         0.3793103448275
7           0.5100000000000                         0.3793103448275
7           0.5100000000000                         0.3793103448275
7           0.5100000000000                         0.3793103448275
8           0.6100000000000                         0.5172413793103
8           0.6100000000000                         0.5172413793103
8           0.6100000000000                         0.5172413793103
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
9           0.8400000000000                         0.6206896551724
10          0.8700000000000                         0.8620689655172
11          0.9700000000000                         0.8965517241379
11          0.9700000000000                         0.8965517241379
11          0.9700000000000                         0.8965517241379
12          1.0000000000000                         1.0000000000000 
```

下面是与上述 CTE 等效的 SQL 2012：

```
SELECT *
, cd=CUME_DIST()OVER(ORDER BY i)
, pr=PERCENT_RANK()OVER(ORDER BY i)
FROM @t; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T02:15:56.457

这非常接近。首先是一些示例数据：

```
USE tempdb;
GO

CREATE TABLE dbo.DartScores
(
    TournamentID INT,
    PlayerID INT,
    Score INT
);

INSERT dbo.DartScores VALUES
(1, 1, 320),
(1, 2, 340),
(1, 3, 310),
(1, 4, 370),
(2, 1, 310),
(2, 2, 280),
(2, 3, 370),
(2, 4, 370); 
```

现在，查询的 2012 版本：

```
SELECT TournamentID, PlayerID, Score, 
  pr = PERCENT_RANK() OVER (PARTITION BY TournamentID ORDER BY Score),
  cd = CUME_DIST()    OVER (PARTITION BY TournamentID ORDER BY Score)
FROM dbo.DartScores
ORDER BY TournamentID, pr; 
```

产生这个结果：

```
TournamentID PlayerID Score pr                  cd
1            3        310   0                   0.25
1            1        320   0.333333333333333   0.5
1            2        340   0.666666666666667   0.75
1            4        370   1                   1
2            2        280   0                   0.25
2            1        310   0.333333333333333   0.5
2            3        370   0.666666666666667   1
2            4        370   0.666666666666667   1 
```

2005 年的等价物非常接近，但它不能很好地处理关系。抱歉，我今晚没油了，否则我会帮忙找出原因。[我从Itzik 的新高性能窗口函数手册中学](http://blogs.msdn.com/b/microsoft_press/archive/2012/04/26/new-book-microsoft-sql-server-2012-high-performance-t-sql-using-window-functions.aspx)到的知识与我所了解的一样多。

```
;WITH cte AS
(
    SELECT TournamentID, PlayerID, Score,
     rk = RANK()   OVER (PARTITION BY TournamentID ORDER BY Score),
     rn = COUNT(*) OVER (PARTITION BY TournamentID)
    FROM dbo.DartScores
)
SELECT TournamentID, PlayerID, Score,
  pr = 1e0*(rk-1)/(rn-1),
  cd = 1e0*(SELECT COALESCE(MIN(cte2.rk)-1, cte.rn)
    FROM cte AS cte2 WHERE cte2.rk > cte.rk) / rn
FROM cte; 
```

产生这个结果（注意 cume_dist 值是如何为关系发生轻微变化的）：

```
TournamentID PlayerID Score pr                  cd
1            3        310   0                   0.25
1            1        320   0.333333333333333   0.5
1            2        340   0.666666666666667   0.75
1            4        370   1                   1
2            2        280   0                   0.25
2            1        310   0.333333333333333   0.5
2            3        370   0.666666666666667   0.75
2            4        370   0.666666666666667   0.75 
```

不要忘记清理：

```
DROP TABLE dbo.DartScores; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-30T15:27:34.810

是的，有一个简单的解决方案，至少对于 percent_rank() 部分。您可以使用

```
(rank() over (partition by <x> order by <y>)-1)/(count(*) over (partition by <x>)-1) 
```

这会给你完全相同的结果

```
percent_rank() over (partition by <x> order by <y>) 
```

rank() 函数是 SQL Server 2008 中已经存在的少数分析函数之一。

# html - 在 tinymce 编辑器中设置 html

> ID：10610643
> 
> 赞同：1
> 
> 时间：2012-05-16T00:39:36.447
> 
> 标签：html, tinymce

我正在尝试使用 jquery 在 tinymce 中设置 HTML 数据。但我有一些问题。

我的 html 数据如下：

```
 var data = "<div><img src='http://localhost/images/test.png' /><div>Image Title</div></div> html";
    tinyMCE.activeEditor.setContent(data , {format : 'raw'} ); 
```

它可以正确渲染 div 和图像。但我得到了额外的

带有 html 的标签如果我删除 html 单词，则数据未在编辑器中正确呈现

我也尝试了以下各种组合，但没有帮助：

```
tinyMCE.activeEditor.dom.setHTML(tinyMCE.activeEditor.id, str);
tinyMCE.activeEditor.setContent(data ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T08:20:38.827

Tinymce 和浏览器负责输入的 html 的有效性。你能在输入数据后显示编辑器内容吗？

```
tinyMCE.activeEditor.setContent(content); 
```

是用内容变量保存的文本替换当前编辑器内容的通常正确方法。

# php - 在 wordpress 插件中确定 PHP 中的当前页面

> ID：10610646
> 
> 赞同：0
> 
> 时间：2012-05-16T00:39:59.130
> 
> 标签：php, mobile, wordpress, parse-url

这个问题一直把我逼到墙角。

我一直在为使用 wordpress 的朋友开发一个移动网站。我正在尝试修改一个为移动用户“重新主题化”每个页面的 wordpress 插件。如果用户在博客页面上，我希望插件做正常的事情（“retheme”页面），否则（如果用户访问不同的页面，他将被重定向到不同的地址（移动网站的地址）。

为了做到这一点，当插件中的功能运行时，我必须能够检测我是在博客页面上，还是在不同的页面上。

我尝试了 is_home、is_page(id) 等条件，但它们都不起作用。我也尝试解析 url 并尝试以这种方式确定页面，但我不能。

我刚刚开始接触 PHP，所以我真的不确定接下来要尝试什么。

重申我的问题：**如何确定我是否在 wordpress 插件功能中的某个页面上？**

该插件记录在案，是“Wordpress PDA & iPhoned”（http://imthi.com/wp-pda/）

以下是相关代码：

```
function PDAPlugin() {
        if(true) {
        header("Location: http://adavidcreation.com/mobile");
        exit;
        }
...
} 
```

这可行，但我想将 if 语句更改为仅在它不是博客时才为真。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:00:47.367

尝试使用它，它应该检索页面 id：`$id = get_option('page_for_posts');`

如果这不起作用-> [https://wordpress.stackexchange.com/](https://wordpress.stackexchange.com/)

# node.js - node.js - 从对象发出事件

> ID：10610647
> 
> 赞同：2
> 
> 时间：2012-05-16T00:40:01.267
> 
> 标签：node.js, asynchronous, module, eventemitter

我在 node.js 中有以下模块：

```
var obj = {};
obj.prop1 = "value1";
obj.prop2 = "value2";

asyncFunction(function(data) {
     obj.prop3 = data;
     // I would like to do: obj.emit("completed");
});

module.exports = obj; 
```

所以我可以像这样导入它：

```
var imp = require('./obj');

imp.on("completed", function() {
     console.log("Hello!");
}); 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:49:44.770

您将需要制作`obj`一个`EventEmitter`. 这可以很简单地完成 - 只需更改以下内容：

```
var obj = {}; 
```

对此：

```
var EventEmitter = require('events').EventEmitter;
var obj = new EventEmitter(); 
```

# dll - 是否可以有一个没有 DLLMain 函数的 DLL？

> ID：10610649
> 
> 赞同：1
> 
> 时间：2012-05-16T00:40:13.290
> 
> 标签：dll

是否可以有一个没有 DLLMain 函数的 DLL？这会产生什么影响，或者它会使 DLL 无法使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:46:35.153

当然，可以有一个没有 DLLMain 的 DLL。但它与普通的 DLL 不同。

例如，资源 DLL 不需要有代码。

在 Visual Studio 中，您可以使用 /NOENTRY 选项，这样链接器就不会抱怨缺少引用。

从所有规范的角度来看，该文件是一个完整的 DLL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T13:36:13.800

是的，您可以仅加载带有资源的 DLL 库，为此，请使用带有 LOAD_LIBRARY_AS_IMAGE_RESOURCE 的 LoadLibraryEx()。

# css - css3 flex-box Internet Explorer 没有正确对齐

> ID：10610650
> 
> 赞同：0
> 
> 时间：2012-05-16T00:40:18.960
> 
> 标签：css, html, internet-explorer

我一直在关注这个[教程视频，](http://www.youtube.com/watch?v=F1uzS6PAjuc)它清楚地展示了关于 css3 中灵活框的所有内容。我在 Mozilla 或 chrome 上没有任何问题。但是框位于 Internet Explorer 中部分框的正下方。可以在[此处](http://www.mreo.net/html5/index.html)找到演示（如果您在 Mozilla 上查看，即可以看到差异）。这是我一直在玩的html代码：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title> First html5 </title>
<link rel="stylesheet" href="mainnew.css" />
</head>

<body> 
<div id="big_wrapper">
<header id="top_header">
<h1> Welcome to html5 </h1>
</header>

<nav id="top_menu">
<ul>
<li>Home</li>
<li>Tutorials</li>
<li>Podcast</li>
</ul>
</nav>

<div id="new_div">
<section id="main_section">
<article>
<header>
<hgroup>
<h1>Title of article</h1>
<h2>Subtitle for article!</h2>
</hgroup>
</header>
<p>This is the best article eva!</p>
<footer>
<p>- writtern by Emre Caglar </p>
</footer>
</article>

<article>
<header>
<hgroup>
<h1>Title of article2</h1>
<h2>Subtitle for article2!</h2>
</hgroup>
</header>
<p>This is the best article eva!</p>
<footer>
<p>- writtern by Emre Caglar </p>
</footer>
</article>
</section>

<aside id="side_news">
<h4>News</h4>
Emre has a new dog
</aside>

</div>

<footer id="the_footer">
Copyright mreonet 2012
</footer>

</div>
</body>
</html> 
```

和CSS代码

```
body{
        width:100%;
        display:-webkit-box;
        display: -moz-box;
        display: box;
        -webkit-box-pack:center;
        -moz-box-pack:center;
        box-pack:center;
    }
    #big_wrapper {
        max-width: 1000px;
        margin:20px 0px;
        display:-webkit-box;
        display: -moz-box;
        display: box;
        -moz-box-orient: vertical;
        -webkit-box-orient: vertical;
        box-orient: vertical;
        -moz-box-flex: 1.0; 
        -webkit-box-flex: 1;
        box-flex: 1;

    }
    #top_header {
        background:yellow;
        border: 3px solid black;
        padding:20px;
    }
    #top_menu { 
        border:red;
        background:blue;
        color:white;
    }
    #top_menu li {
        display:inline-block;
    }
    #new_div { 
        display:-webkit-box;
        display: -moz-box;
        display: box;
        -webkit-box-orient:horizantal;
        -moz-box-orient: horizontal;
        box-orient: horizontal;

    }
    #main_section {
        border:1px solid blue;
        margin:20px;
        padding: 20px;
        -moz-box-flex: 1.0; 
        -webkit-box-flex: 1;
        box-flex: 1;

    }
    #side_news {
        border:1px solid red;
        width:220px;
        margin:20px 0px;
        padding:30px;
        background:#66cccc; 
```

我还注意到，当我在 ie8 上查看此页面时，它没有采用 css 样式。我对 html5 真的很陌生，可能会犯一些愚蠢的错误..

谁可以帮我这个事。顺便说一句，这是我的第一个问题，如果我错过任何事情，请告诉我并为此感到遗憾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T09:54:02.713

IE 尚不支持 Flexible Box 模型。

[http://www.w3schools.com/cssref/css3_pr_box-flex.asp](http://www.w3schools.com/cssref/css3_pr_box-flex.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:30:01.110

IE10 支持弹性盒子模型。

[http://msdn.microsoft.com/en-us/library/ie/hh673531(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh673531(v=vs.85).aspx)

事实上，我这周一直在玩浏览器前缀。

[http://leaverou.github.com/prefixfree/#test-drive](http://leaverou.github.com/prefixfree/#test-drive)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T21:53:44.493

IE 支持弹性框。但是 IE 1o 是基于 2012 年 3 月 22 日版本的 Flexbox 工作草案。使用 ms-flex-direction 来实现方向。行表示水平，列表示垂直。有关如何使用它的详细信息，请参见此处。

[http://msdn.microsoft.com/en-us/library/ie/hh673531(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh673531(v=vs.85).aspx)

例如

```
body
{   
  display: -ms-flexbox;
  -ms-flex-direction: row;
  -ms-flex-align: stretch;
  -ms-flex-pack: center;
  border: blue; 
  width: 100%;
  height:500px
}

#box1 {
    width: 500px;
    display: block;
    background: black;
    border: black;
    border: 1px solid black
}

#box2 {
    width: 500px;
    display: block;
    background: red;
    border: red;
    border: 1px solid black
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:39:50.587

正如@Ravi 提到的，IE[本身并不支持`flex-box`](http://caniuse.com/flexbox). 这是一个可用于在 IE 中启用它的 polyfill [。](http://flexiejs.com/)

# php - PHP error_log 函数能否在缓冲区内生成致命错误？

> ID：10610651
> 
> 赞同：1
> 
> 时间：2012-05-16T00:40:21.453
> 
> 标签：php, logging, error-handling, buffer, ob-start

嗯......这是我的情况：我正在开发一个框架，我目前正在开发错误处理功能。我也想处理错误处理错误！好吧......更好地解释：如果我有一个错误，无论是否致命，都会引发异常（在非致命错误的情况下）并伪造 Exception 用于致命错误。异常由“记录器”处理，它可以处理错误在控制台（浏览器）上回显或将其存储在文件中。问题是当记录器内发生第二个致命错误时。为了捕捉它，我使用了 PHP 缓冲区 (ob_start())。在这个函数内部不应该发生错误，任何人......换句话说......这是错误跟踪的最后一级。我可以只回显错误，但我想使用 PHP 错误日志系统注册它们（如果没有达到最后一级则禁用）。这可以使用 error_log 函数来实现。

“成功时返回 TRUE，失败时返回 FALSE。”

嗯……这就是我需要的。但我很害怕，因为我不知道这个函数是否会产生致命错误（内部实现）或者只是返回 TRUE/FALSE。我在 localhost SMTP 中使用邮件选项 (1) 进行了测试，但失败了（正如预期的那样！），生成了一条警告消息。然后缓冲区崩溃在浏览器上显示空白页面（这是我不希望发生的）。这个问题可以通过使用 fsockopen 检查 smtp 连接并将返回值归因于类变量来解决。在缓冲函数内部，这个变量值被验证。如果为 TRUE，则调用带有电子邮件选项的 error_log。但是对于带有选项 0（php 文件日志）和 3（其他文件）的 error_log？

这是我的日志记录类的相关部分：

```
 public function error_buffer($buffer) {

        $error = error_get_last ();

        if ($error && ($error ['type'] & E_FATAL && $this->_errhe)) {

            $this->error_handler_error ( $error ['type'], $error ['message'], $error ['file'], $error ['line'] );

            if (ENV === 'production') {
                return 'error 500';
            }

            return ob_get_contents ();

        }

        return $buffer;

    }

    public function error_handler_error($errno, $errmsg, $errfile, $errline) {

            var_dump ( $errfile );

            /* GENERATES WARNING MESSAGE... AND BLANK PAGE! 
             *  Here is possible to do: if($this->_email) { error_log() }...
            */
            @error_log ( $errmsg, 1, 'lucas@lucas.com' );

            // error_log($errmsg, 0);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:34:00.783

@ 不会阻止错误的发生，它只会阻止它被显示。因此，如果 mail() 失败，则 error_log 到电子邮件（选项 1）也将失败 - 出现错误。

因此，可能发生的事情是 error_log() 调用会导致调用错误处理函数的错误，调用 error_log() 会导致调用错误处理函数的错误，调用 error_log() 会导致调用错误的错误错误处理函数，它调用 error_log() 导致错误......你明白了要点。

如果是这样的话，我能很快想到的解决方案是：

1 - 在 error_buffer 中包含一个静态变量来表示“我当前正在处理一个错误，不要再处理了（或者只是在屏幕上显示消息 - 但尊重 ini 设置“display_errors”）。

2 - 在你的错误函数中关闭你的错误处理以默认 PHP 函数处理它。

为什么不调用“error_log ($errmsg, 1, 'lucas@lucas.com');” 在错误函数之外（我们没有@），看看你的错误处理程序是否被调用？

# mercurial - 水银一头，两偏

> ID：10610655
> 
> 赞同：0
> 
> 时间：2012-05-16T00:41:17.493
> 
> 标签：mercurial, merge, branch

我遇到了一个有趣的情况，我不知道如何描述。所以我在这里是它的截图（请注意，这里有两个程序员正在使用一个都与之同步的中央存储库）：

左边的图像更新到其他程序员的核心（现在是头部），右边的图像在合并到开发之前更新到我的核心。

![http://d.pr/i/aorX](../Images/66864e604b0fcc3bc92eb853f2656a0f.png) ![http://d.pr/i/7d7q](../Images/a143d90d570cecaba824d813e90927c1.png)

如您所见，我有一个`Core`分支`#372`合并到`Dev`. 另一个程序员忘记与我的更改合并`#372`（在从 375 及以后更改之前，我已经将其推送到中央存储库）并继续。

所以现在我有一个核心分支合并到 dev 中，并且有点无头。另一个程序员的核心现在将是我要开始的那个。那不是问题。一个问题是看到两个核心和杂乱无章的分支树。

我该怎么做才能最终只有一个核心分支？或者这样可以*吗*？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T06:39:46.320

> 如您所见，我有一个 Core 分支 #372 并入 Dev。另一个程序员忘记合并我在 #372 的更改（在从 375 及以后的更改之前，我已经将其推送到中央存储库）并继续。

这不是我看到的。#372 是双方#373 的父母。如果删除#381+ 和#372+，这两个图是相同的。它们的绘制方式不同，只是因为当前工作副本的父级不同。

当然，它看起来有点奇怪，但这里没有问题。在 #372+ 提交后，它需要在某个时候与 #381（或任何当前的核心头）合并，但这并没有什么特别的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T01:38:32.813

现在，`Core`实际上有 0个*拓扑头，*因为变更集 381 和 372 都与`dev`. 在您的图表上，您会看到从变更集 372 延伸出来的长线，因为您的工作目录现在位于该变更集上。该行表明您所做的任何提交都将是 372 的子级。另一个程序员的工作目录位于变更集 381 上，这就是他的图表看起来不同的原因。更新到 381 后，您的图表将与另一张图表相同。

因此，要回答您的问题，这将不是问题，因为`Core`' 的*分支负责人*已全部合并到 dev 中。此外，如果您最终使用了多个拓扑头`Core`，当您拉入新头时，mercurial 会警告您。

# javascript - 调用对象中定义的函数

> ID：10610657
> 
> 赞同：1
> 
> 时间：2012-05-16T00:41:46.907
> 
> 标签：javascript

我有一个对象，它定义了要在页面元素的单击事件中调用的函数的名称和参数。

```
object_array = [
    {
       id: "id1",
       onclick: "load_file(filename.php);",
    },

    {
       id: "id2",
       onclick: "open_url('http://url.com');",
    }
]; 
```

必须动态检索该信息。我想在 click 事件中为数组中的给定对象调用 onclick 函数。

```
$('element').click(function() {
      // call object.onclick
}); 
```

似乎 eval() 不是一个好的选择。调用该函数有不同的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:56:09.740

这是一个有效的 jsfiddle：http: [//jsfiddle.net/Zh6Fv/1/](http://jsfiddle.net/Zh6Fv/1/)

像这样：

```
 object_array = [
        {
           id: "id1",
           // Encapsulate in an anonymous function
           onclick: function(){ load_file('filename.php'); },
        },
        {
           id: "id2",
           // Encapsulate in an anonymous function
           onclick: function(){ open_url('http://url.com'); },
        }
    ]; 
```

然后像这样实际绑定它::

```
$('element').click(obj.onclick); 
```

大概你会像这样使用它::

```
object_array.forEach(function(obj){
     // Note there is no need to wrap the obj.onclick
     // into another anonymous function anymore!
     $("#" + obj.id).click(obj.onclick);
}); 
```

这是一个有效的 jsfiddle：http: [//jsfiddle.net/Zh6Fv/1/](http://jsfiddle.net/Zh6Fv/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:58:02.673

您应该将其重构`object_array`为：

```
[{
    id: "id1",
    action: "load_file",
    url: "filename.php"
}, {
   id: "id2",
   action: "open_url",
   url: 'http://url.com'
}]; 
```

然后你可以调用它：

```
var actions = {
    load_file: function(url) {
        ...
    },
    open_url: function(url) {
        ...
    },
    ...
};
object_array.forEach(function(ob) {
    $("#"+ob.id).click(function() {
        actions[ob.action](ob.url);
    });
}); 
```

如果您有更复杂的参数，您还可以提供一个参数数组，而不是在函数上`url`使用[`apply()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)。

* * *

或者，如果您只想要一个函数查找表，请使用：

```
var object = {
    "id1": function() {
        load_file('filename.php');
    },
    "id2": function() {
        open_url('http://url.com');
    }
};
$('element').click(function() {
    object[this.id]();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:45:28.253

you can declare a function like

```
onclick : function()
{
   action(arguments);
} 
```

# php - 如何使用 PHP 设置 WebSocket 安全连接？

> ID：10610661
> 
> 赞同：11
> 
> 时间：2012-05-16T00:42:17.087
> 
> 标签：php, html, websocket

我找不到有关在 PHP 中设置 wss 连接的任何信息。我连接throw ws没问题。顺便说一句，我正在使用这个非常棒的库来做到这一点：[https ://github.com/albeva/php-websocket](https://github.com/albeva/php-websocket)

但是我的网站使用 https 并且我需要一个 WebSocket 安全连接来避免 Firefox 抱怨连接不安全的事实。

在此先感谢您的帮助。

* * *

**编辑**

这是该库用于启动套接字连接的代码：

```
$master = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
if (!is_resource($master)) {
    $this->throwSocketError();
}

// set options
if (!socket_set_option($master, SOL_SOCKET, SO_REUSEADDR, 1)) {
    $this->throwSocketError();
}

// bind
if (!socket_bind($master, $this->host, $this->port)) {
    $this->throwSocketError();
}

// listen for connections
if (!socket_listen($master, SOMAXCONN)) {
    $this->throwSocketError();
} 
```

我相信我需要更改此代码，但我找不到如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T09:05:48.493

你试过[stream_socket_server](http://php.net/stream_socket_server)吗？

```
<?php
$socket = stream_socket_server("ssl://0.0.0.0:".$port, $errno, $errstr);
if (!$socket) {
  echo "$errstr ($errno)<br />\n";
} else {
  while ($conn = stream_socket_accept($socket)) {
    fwrite($conn, 'some data...\n');
    fclose($conn);
  }
  fclose($socket);
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T20:07:08.077

这是一个示例（和链接），稍作修改，并从另一个 SO 帖子中找到。 [链接到其他帖子](https://stackoverflow.com/questions/4051232/cant-connect-to-ssl-web-service-with-ws-security-using-php-soap-extension-cer)

这里是 stream_context_create php 函数定义的链接。 [函数定义](http://www.php.net/manual/en/function.stream-context-create.php)

```
try 
{ 
    $localCertificateFilespec = $connection['localCertificateFilespec']; 
    $localCertificatePassphrase = $connection['localCertificatePassphrase']; 

    $sslOptions = array( 
        'ssl' => array( 
            'local_cert' => $localCertificateFilespec, 
            'passphrase' => $localCertificatePassphrase, 
            'allow_self_signed' => true, 
            'verify_peer' => false 
        ) 
    ); 
    $sslContext = stream_context_create($sslOptions); 

    $clientArguments = array( 
        'stream_context' => $sslContext, 
        'local_cert' => $localCertificateFilespec, 
        'passphrase' => $localCertificatePassphrase, 
        'trace' => true, 
        'exceptions' => true, 
        'encoding' => 'UTF-8', 
        'soap_version' => SOAP_1_1 
    ); 

    $oClient = new WSSoapClient($connection['wsdlFilespec'], $clientArguments); 
    $oClient->__setUsernameToken($connection['username'], $connection['password']); 

    return $oClient->__soapCall($operation, $request); 
} 
```

**但是**，在链接的 SO 帖子的最底部，您会从“Sam”中找到答案。我需要在接下来的几周内做同样的事情，所以我计划使用 Sams 方法......因为我更喜欢 PHP 中的 CURL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T14:22:13.867

您目前最好的 PHP 方法是使用[Ratchet](http://socketo.me/)。设置 wss 连接的最佳方法是将您的 websocket 服务器放在 Nginx 或 HAProxy 后面，这将为您处理所有 SSL 内容。[此处](http://socketo.me/docs/deploy)使用 HAProxy对此进行了解释。请注意，您可以对 Nginx 执行相同操作，因为它现在也支持 WebSocket。

# oop - 柯里化和重载一样吗？

> ID：10610665
> 
> 赞同：12
> 
> 时间：2012-05-16T00:42:46.127
> 
> 标签：oop, functional-programming, overloading, currying

函数式编程的柯里化与面向对象编程的重载相同吗？如果不是，为什么？（如有可能，请提供示例）

Tks

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-16T07:01:20.130

柯里化不是函数式编程特有的，重载也不是面向对象编程特有的。

“柯里化”是使用函数，您可以向其传递比获取剩余参数的函数所需的参数更少的参数。即，如果我们有一个函数`plus`，它接受两个整数参数并返回它们的总和，那么我们可以将*单个*参数传递`1`给`plus`，结果是一个对事物加 1 的函数。

在 Haskellish 语法中（通过邻接函数应用）：

```
plusOne = plusCurried 1
three = plusOne 2
four = plusCurried 2 2
five = plusUncurried 2 3 
```

在模糊的 Cish 语法中（用括号括起来的函数应用程序）：

```
plusOne = plusCurried(1)
three = plusOne(2)
four = plusCurried(2)(2)
five = plusUncurried(2, 3) 
```

您可以在这两个示例中看到`plusCurried`仅在一个参数上调用，结果是可以绑定到变量然后在另一个参数上调用的结果。您将柯里化视为函数式编程概念的原因是，它在语法通过邻接应用的函数式语言中使用最多，因为在这种语法中柯里化变得非常自然。的应用`plusCurried`和`plusUncurried`定义`four`和`five`在 Haskellish 语法中合并变得完全无法区分，因此您可以始终让所有函数完全柯里化（即，让每个函数都是一个参数的函数，只有其中一些会返回其他函数，然后可以将其应用于更多参数）。而在 Cish 语法中，通过括号参数列表应用，`four`和的定义`five`看起来完全不同，因此您需要区分`plusCurried`和`plusUncurried`。此外，导致今天的面向对象语言的命令式语言从来没有能力将函数绑定到变量或将它们传递给其他函数（这被称为具有一流的函数），没有这种能力，你实际上什么也做不**了**除了在所有参数上调用它之外，还有一个 curried 函数，因此没有任何意义。今天的一些面向对象语言还没有一流的功能，或者是最近才获得的。

currying 一词也指将具有多个参数的函数转换为接受单个参数并返回另一个函数（接受单个参数，并且可能返回另一个函数......）的过程，“uncurrying”可以指到做反向转换的过程。

* * *

重载是一个完全不相关的概念。重载一个名称意味着给出具有不同特征（参数类型、参数数量、返回类型等）的多个定义，并让编译器通过它出现的上下文来解析哪个定义是由名称的给定外观表示的。

一个相当明显的例子是，我们可以定义`plus`添加整数，但也可以使用相同的名称`plus`添加浮点数，我们可以潜在地使用它来连接字符串、数组、列表等，或者添加向量或矩阵。所有这些都有非常不同的实现，就语言实现而言彼此无关，但我们只是碰巧给它们取了相同的名称。然后编译器负责确定`plus stringA stringB`应该调用字符串`plus`（并返回一个字符串），而`plus intX intY`应该调用整数`plus`（并返回一个整数）。

同样，这个概念是“OO 概念”而不是函数式编程概念并没有内在的原因。碰巧它很自然地适合已开发的静态类型的面向对象语言。如果您已经在解决调用该方法的对象要调用哪个方法，那么允许更一般的重载只是一个小范围。完全即席重载（您只需多次定义相同的名称并相信编译器会弄清楚）在具有一流函数的语言中不太适合，因为当您将重载名称作为功能本身你不'*重载的定义）。Haskell 开发类型类作为使用重载的更原则性方式；这些实际上*确实*允许您一次传递所有重载定义，并且还允许类型系统表达类型有点像“定义了函数`f`和`g`定义的任何类型”。*

 ** * *

总之：

*   柯里化和重载完全不相关
*   currying 是关于将函数应用于比它们需要的更少的参数，以便获得剩余参数的函数
*   重载是为同一名称提供多个定义，并让编译器在每次使用该名称时选择使用哪个定义
*   柯里化和重载都不是函数式编程或面向对象编程所特有的；由于语言的发展方式，它们都恰好在一种或另一种历史语言中更普遍，导致它们在一种语言中更有用或更明显

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-16T00:44:11.250

No, they are entirely unrelated and dissimilar.

[Overloading](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29) is a technique for allowing the same code to be used at different types -- often known in functional programming as *polymorphism* (of various forms).

A polymorphic function:

```
 map :: (a -> b) -> [a] -> [b]
 map f []     = []
 map f (x:xs) = f x : map f xs 
```

Here, `map` is a function that operates on any list. It is polymorphic -- it works just as well with a list of `Int` as a list of trees of hashtables. It also is *higher-order*, in that it is a function that takes a function as an argument.

[Currying](http://en.wikipedia.org/wiki/Currying) is the transformation of a function that takes a structure of *n* arguments, into a chain of functions each taking one argument.

In curried languages, you can apply any function to some of its arguments, yielding a function that takes the rest of the arguments. The partially-applied function is a closure.

And you can transform a curried function into an uncurried one (and vice-versa) by applying the transformation invented by [Curry](http://en.wikipedia.org/wiki/Haskell_Curry) and [Schonfinkel](http://en.wikipedia.org/wiki/Moses_Sch%C3%B6nfinkel#Work).

```
curry :: ((a, b) -> c) -> a -> b -> c 
   -- curry converts an uncurried function to a curried function.

uncurry :: (a -> b -> c) -> (a, b) -> c
   -- uncurry converts a curried function to a function on pairs. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T00:51:33.613

重载是具有多个具有相同名称的函数，具有不同的参数。

柯里化是您可以获取多个参数并有选择地设置一些参数的地方，例如，您可能只有一个变量。

所以，如果你有一个 3 维的绘图函数，你可能有： `justgraphit(double[] x, double[] y, double[] z)`，并且你想要绘制它。

通过柯里化，您可以： `var fx = justgraphit(xlist)(y)(z)`您现在设置 fx 的位置，以便它现在有两个变量。

然后，稍后，用户选择另一个轴（日期）并设置 y，所以现在您有： `var fy = fx(ylist)(z)`

然后，稍后您仅通过循环一些数据来绘制信息，唯一的可变性是`z`参数。

这使复杂的函数变得更简单，因为您不必继续传递大部分设置的变量，因此可读性增加。*

# php - Preg Replace text to links with domains filter

> ID：10610670
> 
> 赞同：0
> 
> 时间：2012-05-16T00:43:52.017
> 
> 标签：php, regex

Hello everyone i have a problem I have a text

```
$text = " some and text http://www.somelink2.com/html5.jpg and some text http://www.somelink.net/test/testjava/html5.html#fbid=QTb-X6fv5p1 some http://www.somelink4.org test and http://www.somelink3.org/link.html text and some text "; 
```

i need to transform all text links http/s exept domains somelink3.org,somelink2.com they must be plain text

Something like this but with domains filter and not extention images:

```
function livelinked ($text){
        preg_match_all("#((http|https|ftp)://(\S*?\.\S*?))(\s|\;|\)|\]|\[|\{|\}|,|\"|'|:|\<|$|\.\s)|^(jpg)^#ie", $text, $ccs);
        foreach ($ccs[3] as $cc) {
           if (strpos($cc,"jpg")==false  && strpos($cc,"gif")==false && strpos($cc,"png")==false ) {
              $old[] = "http://".$cc;
              $new[] = '<a href="http://'.$cc.'" target="_blank">'.$cc.'</a>';
           }
        }
        return str_replace($old,$new,$text);
} 
```

edit: this helped me :

```
$text =  preg_replace("~((?:http|https|ftp)://(?!site.com|site2.com|site3.com)(?:\S*?\.\S*?))(?=\s|\;|\)|\]|\[|\{|\}|,|\"|'|:|\<|$|\.\s)~i",'<a href="$1" target="_blank">$1</a>',$text); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:07:59.787

对于这种情况，您可以使用[`(?!...)`否定的前瞻断言。](http://www.regular-expressions.info/lookaround.html)只需`(?!somelink3.org|somelink2.com)`在协议占位符之后立即添加`://`。

```
 #((http|https|ftp)://(?!domain1|domain2)(\S*?\.\S*?)).... 
```

另外，您不应该将笨拙的方法与第二步`preg_match_all`结合使用。`str_replace`而是利用[`preg_replace_callback`](http://php.net/preg_replace_callback)并将所有逻辑放在一个函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:45:14.357

您可能可以将其浓缩并使用 preg replace all

原始正则表达式

```
(?:http|https|ftp)://
(\S*?\.(?:(?!(?<=\.)(?:jpg|png|gif)|\s).)*?)
(?= [\s;)\]\[{},"':<] | $ | \.\s ) 
```

原始替换

```
<a href="http://$1" target="_blank">$1</a> 
```

修饰符 //xsg

*编辑：* - 所以我没有发现你需要过滤域。上面的正则表达式过滤了 jpg/png/gif 文件，虽然它是相当复杂的。但是使用 url 解析器或回调中的另一个正则表达式可能会更好地处理添加过滤器。

# ruby-on-rails - Trouble with the speed of using in_time_zone

> ID：10610672
> 
> 赞同：0
> 
> 时间：2012-05-16T00:44:17.210
> 
> 标签：ruby-on-rails, ruby, timezone

I am using Ruby 1.8.7 and Rails 3.0.3\. Even though currently all of my users are in the same time zone as my server, I thought that in preparation for world domination I'd get rid of all of my `RubyTimeObjIGotOutOfMyDb.getlocal` calls and replace them with `RubyTimeObjIGotOutOfMyDb.in_time_zone(user_timezone)` where the user's timezone is a column in my user's table. What happened is now my page takes maybe 5 or 6 times as long to load. Is this the wrong strategy? Is there a better way I should be preparing for users in different timezones from my server?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:26:38.607

看这个[railscast](http://railscasts.com/episodes/106-time-zones-in-rails-2-1?autoplay=true)

我想你只需要做

控制器/应用程序.rb

```
before_filter :set_user_time_zone

private

def set_user_time_zone
  Time.zone = current_user.time_zone if logged_in?
end 
```

从 db 获取时，所有时间都将被转换

如果时间不在当前时区，请在视图中尝试（或在控制台中进行测试）

```
Time.now.in_time_zone 
```

**更新**：如果您`in_time_zone(zone)`多次调用该调用，我认为它会多次获取相应的时差，就像截屏视频所说的那样，它只会获取一次并在每次转换中使用它。

# php - 具有多个查询的 php/mysql

> ID：10610675
> 
> 赞同：7
> 
> 时间：2012-05-16T00:44:49.303
> 
> 标签：php, mysql, string, while-loop, concatenation

```
<?php

$query1 = "CREATE VIEW current_rankings AS SELECT * FROM main_table WHERE date = X";

$query2 = "CREATE VIEW previous_rankings AS SELECT rank FROM main_table WHERE date = date_sub('X', INTERVAL 1 MONTH)";

$query3 = "CREATE VIEW final_output AS SELECT current_rankings.player, current_rankings.rank as current_rank LEFT JOIN previous_rankings.rank as prev_rank
             ON (current_rankings.player = previous_rankings.player)";

$query4 = "SELECT *, @rank_change = prev_rank - current_rank as rank_change from final_output";

$result = mysql_query($query4) or die(mysql_error()); 

while($row = mysql_fetch_array($result)) {
echo $row['player']. $row['current_rank']. $row['prev_rank']. $row['rank_change'];
}

?> 
```

所有查询都独立工作，但我真的很难将所有部分放在一个结果中，所以我可以将它与 mysql_fetch_array 一起使用。

我尝试创建视图和临时表，但每次它要么说表不存在，要么返回一个空的 fetch 数组循环......逻辑在那里但语法混乱我认为这是我第一次不得不这样做处理我需要合并在一起的多个查询。期待一些支持。非常感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-19T10:16:06.323

感谢 php.net，我想出了一个解决方案：您必须使用它`(mysqli_multi_query($link, $query))`来运行多个连接查询。

```
 /* create sql connection*/
$link = mysqli_connect("server", "user", "password", "database");

$query = "SQL STATEMENTS;"; /*  first query : Notice the 2 semicolons at the end ! */
$query .= "SQL STATEMENTS;"; /* Notice the dot before = and the 2 semicolons at the end ! */
$query .= "SQL STATEMENTS;"; /* Notice the dot before = and the 2 semicolons at the end ! */
$query .= "SQL STATEMENTS"; /* last query : Notice the dot before = at the end ! */

/* Execute queries */

if (mysqli_multi_query($link, $query)) {
do {
    /* store first result set */
    if ($result = mysqli_store_result($link)) {
        while ($row = mysqli_fetch_array($result)) 

/* print your results */    
{
echo $row['column1'];
echo $row['column2'];
}
mysqli_free_result($result);
}   
} while (mysqli_next_result($link));
} 
```

编辑 - 如果您真的想做一个大查询，上述解决方案可以工作，但也可以执行任意数量的查询并单独执行它们。

```
$query1 = "Create temporary table A select c1 from t1"; 
$result1 = mysqli_query($link, $query1) or die(mysqli_error());

$query2 = "select c1 from A"; 
$result2 = mysqli_query($link, $query2) or die(mysqli_error());

while($row = mysqli_fetch_array($result2)) {

echo $row['c1'];
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:49:20.247

看来您没有执行 $query1 - $query3。您刚刚跳到 $query4 如果其他人没有先执行，它将无法工作。

还

```
$query4 = "SELECT *, @rank_change = prev_rank - current_rank as rank_change from final_output"; 
```

应该是

```
$query4 = "SELECT *, @rank_change := prev_rank - current_rank as rank_change from final_output"; 
```

否则 rank_change 的值将只是一个布尔值，如果 @rank_change 等于 (prev_rank - current_rank) 则为 true，否则为 false。但是你需要@rank_change 吗？您会在后续查询中使用它吗？也许你可以完全删除它。

更好的是，您可以像这样将所有查询组合成一个：

```
SELECT 
    curr.player,
    curr.rank AS current_rank,
    @rank_change := prev.rank - curr.rank AS rank_change
FROM
    main_table AS curr
    LEFT JOIN main_table AS prev
        ON curr.player = prev.player    
WHERE 
    curr.date = X
    AND prev.date = date_sub('X', INTERVAL 1 MONTH) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T00:56:33.643

你应该连接它们：

```
<?php

$query = "CREATE VIEW current_rankings AS SELECT * FROM main_table WHERE date = X";

$query .= " CREATE VIEW previous_rankings AS SELECT rank FROM main_table WHERE date =     date_sub('X', INTERVAL 1 MONTH)";

$query .= " CREATE VIEW final_output AS SELECT current_rankings.player,     current_rankings.rank as current_rank LEFT JOIN previous_rankings.rank as prev_rank
         ON (current_rankings.player = previous_rankings.player)";

$query .= " SELECT *, @rank_change = prev_rank - current_rank as rank_change from final_output";

$result = mysql_query($query) or die(mysql_error()); 

while($row = mysql_fetch_array($result)) {
echo $row['player']. $row['current_rank']. $row['prev_rank']. $row['rank_change'];
}

?> 
```

# jdbc - Is no sql database a good solution for a small application?

> ID：10610679
> 
> 赞同：2
> 
> 时间：2012-05-16T00:45:34.293
> 
> 标签：jdbc, nosql, rdbms

I am developing an internal web application that needs a back end. The data stored is not really RDBMS type. Currently it is in XML document fashion that the application parses (XQuery) to display html tables and other type of fields. It is likely that I will have a few more different types of XML documents and CSV(comma separated values) coming up. Given the scenario, I can always back the data up with a mySQL database, breaking the process that generates XML or CSV to insert straight in to database.

Is no-sql database a good choice in this scenario? or mySQL is still better? I do not see any need for clustering/high availability/distributed processing scenarios.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:50:32.053

Define "better".

I think the choice should be made based on how relational (MySQL) or document-based (NoSQL) your data is.

A good way to know is to analyze typical use cases. Better yet, write two prototypes and measure.

# java - AdapterView Anonymous Object

> ID：10610681
> 
> 赞同：0
> 
> 时间：2012-05-16T00:46:14.640
> 
> 标签：java, android, android-adapterview

I'm new to java and android. i don't understand this code

```
 gridview.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
            Toast.makeText(HelloGridView.this, "" + position, Toast.LENGTH_SHORT).show();
        }
    }); 
```

this's my guess : OnItemClickListener is an interface. we create an anonymous object from the class AdapterView. i got information that AdapterView.OnItemClickListener is an interface from [AdapterView.OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html "AdapterView.OnItemClickListener")

is it right ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:51:47.793

是的，从本质上讲，这种机制为您提供了一种方法来指定在事件发生时将运行的代码块。在这种情况下，事件是 GridView 的 onItemClick()。这种模式在 Android 上比较常用。你重写接口方法来做任何你想做的事情，系统会在动作发生时调用它们。

我鼓励您在 Android API 中探索这种模式的一些更常见的示例。查看几个 View 小部件的 javadocs，特别是`public void setOn{ACTION}Listener()`有许多可能的操作，单击和触摸是两个常见的操作。

查看文档中的[android.wiget](http://developer.android.com/reference/android/widget/package-summary.html)。顶部附近有一大堆接口。其中有几个是与此类似的 Listener 接口。

# c++ - Using built in general midi on OS X using RtMidi?

> ID：10610690
> 
> 赞同：1
> 
> 时间：2012-05-16T00:47:42.050
> 
> 标签：c++, macos, midi

I'm trying to write a C++ app which plays midi sounds, but I'm having some difficulty. I got the examples that come with RtMidi to compile out of the box, but running the midiout example, I don't hear anything. Running the midiprobe example I get:

```
There are 1 MIDI input sources available.
  Input Port #1: AudioFire4 (2357) Plug 1

There are 1 MIDI output ports available.
  Output Port #1: AudioFire4 (2357) Plug 1 
```

But that's just an audio interface that I use for using multiple speakers. I don't use any of the midi functionality on it.

Does anyone know how to get RtMidi to use the built in system general midi sound bank so that I can actually hear something?

Thanks, Gabe

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:39:20.247

如果其他人对此感到好奇，我最终安装了 FluidSynth 并下载了 FluidR3 soundfont。这似乎工作得很好。只需运行它，它就会将自己呈现为一个 MIDI 设备。

# performance - Data Densification Oracle query not efficient and slowly

> ID：10610691
> 
> 赞同：0
> 
> 时间：2012-05-16T00:47:44.517
> 
> 标签：performance, oracle, sparse-matrix

I'm trying to cope with data densification for reporting purposes. I created two dimension tables (time & skills) and one data table (calls). Now since during certain time there are no calls in the data table, I will not get a time series including all the days. I now have studied many samples in the Internet how to cope with data densification and came up the the solution below.

Query works as intended, just it takes quite long and I have the feeling it is quite inefficient. Could you please advice me how to speed up query execution time?

Thank you and best regards, Alex

```
SELECT DISTINCT
  DAY_ID,
  DAY_SHORT,
  WEEK_ID,
  MONTH_ID,
  QUARTER_ID,
  YEAR_ID,
  AREA,
  FIRMA,
  PRODUCT,
  PRODUCT_FAMILY,
  PRODUCT_WFM,
  LANGUAGE,
  NVL(NCO,0) NCO,
  NVL(NCH,0) NCH,
  NVL(NCH60,0) NCH60,
  NVL(LOST,0) LOST
FROM (
  SELECT
    DS.AREA,
    DS.FIRMA,
    DS.PRODUCT,
    DS.PRODUCT_FAMILY,
    DS.PRODUCT_WFM,
    DS.LANGUAGE,
    SUM(NVL(CH.HANDLED,0)+NVL(CH.LOST,0)) AS NCO,
    SUM(CH.HANDLED) AS NCH,
    SUM(CH.HANDLED_IN_SL) AS NCH60,
    SUM(CH.LOST) AS LOST,
    CH.DELIVER_DATE,
    CH.SKILL_NAME
  FROM
    WFM.WFM_TBL_DIMENSION_SKILL DS
  LEFT JOIN
    OPS.VW_CALL_HISTORY CH
  ON
    DS.SPLIT_NAME=CH.SKILL_NAME
  GROUP BY
    DS.AREA,
    DS.FIRMA,
    DS.PRODUCT,
    DS.PRODUCT_FAMILY,
    DS.PRODUCT_WFM,
    DS.LANGUAGE,
    CH.DELIVER_DATE,
    CH.SKILL_NAME
) temp_values
PARTITION BY
(
  temp_values.AREA,
  temp_values.FIRMA,
  temp_values.PRODUCT,
  temp_values.PRODUCT_FAMILY,
  temp_values.PRODUCT_WFM,
  temp_values.LANGUAGE,
  temp_values.DELIVER_DATE,
  temp_values.SKILL_NAME
)
RIGHT OUTER JOIN (
  SELECT
    DAY_ID,
    DAY_SHORT,
    WEEK_ID,
    MONTH_ID,
    QUARTER_ID,
    YEAR_ID
  FROM
    WFM.WFM_TBL_DIMENSION_TIME
  WHERE
    DAY_ID BETWEEN(SELECT MIN(DELIVER_DATE) FROM OPS.VW_CALL_HISTORY) and TRUNC(sysdate-1)
) temp_time
ON
  temp_values.DELIVER_DATE=temp_time.DAY_ID 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:51:21.557

我将参数简化`PARTITION BY ()` 为单个主键 (temp_values.SKILL_NAME)，并将技能维度中缺少的信息与`LEFT OUTER JOIN`上述查询末尾的 a 连接起来。这样就不会产生更多相等的重复，这导致我 reduce `SELECT DISTINCT to SELECT`。

此外，我添加了外键和主键，并让查询以并行模式运行。

它帮助我将执行时间减少了 80% 以上，这已经足够了。多谢你们！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T02:26:33.057

查看执行计划并检查哪些步骤需要很长时间。用来`EXPLAIN PLAN`获取。寻找全表扫描，看看索引是否有帮助。确保您在表格上有最新的统计数据。
由于您在谈论维度表，因此假定此代码来自数据仓库数据库。如果是，您是否使用分区？并行 DML？你用的是EE吗？

# javascript - geolocation yahoo maps api

> ID：10610696
> 
> 赞同：0
> 
> 时间：2012-05-16T00:49:27.217
> 
> 标签：javascript, html, geolocation, yahoo-api, yahoo-maps

i'm trying to get coordinates from geolocation for use in my yahoo map.i had run it in firefox, chrome and internet explorer version 12.0, 18.0.1025.168 m and 9.0.8112.16421\. In firefox it asks for permission to share my location(i accept), internet explorer it doesn't support geolocation and chrome supports its but not find the location. here is my code

```
<div id="map" align="right" height="50%" width="50%"> </div>
<script type="text/javascript" src="http://api.maps.yahoo.com/ajaxymap?v=3.8&appid=xoo5uJLV34FTpTmoqrs.mIQOX_DTcBhPowcz17ClEeb.jCIZ1Z6_Aa9FO8brGg--"></script>
<script type="text/javascript">

alert("ok ws dame");
if(navigator.geolocation) {
    alert("Great..Geolocation API is supported.");
    var map = new YMap(document.getElementById('map')); 
    map.addTypeControl(); 
    map.setMapType(YAHOO_MAP_REG);

    navigator.geolocation.getCurrentPosition(foundlocation,nolocation);

    function foundlocation(position){
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    alert(latitude+","+longitude);
    var coords = new YGeoPoint(latitude,Longitude);
    map.drawZoomAndCenter(coords,3);
    map.addMarker(coords);
    }
    function nolocation(error){
var map = new YMap(document.getElementById('map')); 
map.addTypeControl(); 
map.setMapType(YAHOO_MAP_REG);
    alert("Location not found.");
    // Display the map centered on a geocoded location
    map.drawZoomAndCenter("Patras", 3);
    var Lat = 38.2444444;
    var Lon = 21.7344444;
    var myPoint = new YGeoPoint(Lat,Lon);
    map.addMarker(myPoint);     
    }
}
else {
var map = new YMap(document.getElementById('map')); 
map.addTypeControl(); 
map.setMapType(YAHOO_MAP_REG);
    alert("Geolocation API is not supported in your browser.");
    // Display the map centered on a geocoded location
    map.drawZoomAndCenter("Patras", 3);
    var Lat = 38.2444444;
    var Lon = 21.7344444;
    var myPoint = new YGeoPoint(Lat,Lon);
    map.addMarker(myPoint);
}
</script> 
```

in case of (navigator.geolocation) returns false then it shows corectly the deafault position on the map.This works the same in function(nolocation). My problem is when i get the current location.I had put alert messages under navigator.geolocation.getCurrentPosition(foundlocation,nolocation); and inside function(foundlocation) it never shows the message. any help appreciate..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T02:30:25.330

你的错误：var coords = new YGeoPoint(latitude,Longitude);

经度不是带大写“L”的经度

那么工作正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T14:50:45.787

它工作正常。基本上有时它有效，而另一些则无效。我不知道为什么，但代码工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-24T05:14:16.347

我使用“new Y.Map()”而不是“new YMap()”。也许效果相同。

# javascript - 如何覆盖谷歌地图中的 KML 颜色？

> ID：10610697
> 
> 赞同：9
> 
> 时间：2012-05-16T00:49:28.513
> 
> 标签：javascript, google-maps, google-maps-api-3, kml

我正在通过 Google Map 的 V3 API 加载 KML 文件。正在使用 KML 文件中的颜色，但我想用我自己的颜色覆盖它。我实际上想为整个轨迹使用纯色。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T02:10:28.987

KML 颜色基于直接在 KML 中定义或使用对外部 KML 样式文件（类似于 CSS）的引用定义的`Style`[^(api-doc标签。)](https://developers.google.com/kml/documentation/kmlreference#style)我们使用外部样式文件，以便可以将样式应用于多个 KML 文件。

这意味着在我们的 KML*数据*文件中，您会找到如下条目：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
<Document>
    <name>Country Borders</name>
    <open>1</open>
    <Placemark>
        <name>Russian Federation</name>
        <styleUrl>kml-styles.kml#red</styleUrl>
--- etc. --- 
```

上面的`styleUrl`标签本质上是说：去查看文件：`kml-styles.kml`并找到名为：的样式`red`。

在我们的 KML*样式*文件中，您会找到如下条目：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
<Document>
    <name>KML Styles</name>
    <open>1</open>
    <Style id="red">
        <LineStyle>
            <color>7da00000</color>
            <width>1</width>
        </LineStyle>
        <PolyStyle>
            <color>7f0000ff</color>
        </PolyStyle>
    </Style>
    <Style id="green">
        <LineStyle>
            <color>FFFF00</color>
            <width>1</width>
        </LineStyle>
        <PolyStyle>
            <color>7f00aa00</color>
        </PolyStyle>
    </Style>
    --- etc. --- 
```

需要注意的是，**KML 颜色**[^(api-doc)](https://developers.google.com/kml/documentation/kmlreference#color)定义在其定义中包含**八个**十六进制数字；由于前两个十六进制数字定义了颜色不透明度 (alpha)，因此比其他颜色定义的惯常数字多两个数字。

KML `Style`[^(api-doc)](https://developers.google.com/kml/documentation/kmlreference#style)中的示例（与顶部的链接相同）还显示了如何在包含数据的 KML 文件中直接定义样式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T19:20:36.017

KML 颜色的工作原理是这样的，

```
<color>AABBGGRR</color>
AA = alpha opacity
BB = blue
GG = gren
RR = red

The range is from 00 -> ff

RGB for white = 255, 255, 255, hex -> #ffffff

RGB for yellow is 255,255,0, hex -> #ffff00 
```

十六进制也可以看作

```
#RRGGBB 
```

您可以轻松移动颜色以适用于 KML

所以 KML 中的黄色会是

```
<color>ff00FFFF</color>
<color>AABBGGRR</color> 
```

这一直对我有用。

此外，对于边框使用下面。

```
<outline>1</outline> 
```

[https://developers.google.com/kml/documentation/kmlreference](https://developers.google.com/kml/documentation/kmlreference)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T01:28:52.803

KML 是 XML，因此您可以使用 XSL（是的，我都不是）或 PHP 或（取决于具体情况）JavaScript 来解析/转换/重新序列化回 KML。

# c# - From database to datetime picker

> ID：10610698
> 
> 赞同：1
> 
> 时间：2012-05-16T00:49:39.960
> 
> 标签：c#, datetime

I have a form with few datetime pickers, to be exact two pairs of dates and times.

![enter image description here](../Images/1eb4ef1c8ed34d617f7be5ee3d7de51a.png)

Data from those pickers is combined and saved to database as DateTime in format

```
 16/05/2012 11:28:00 a.m. 
```

Now, what I want to do is get value from database and put it into datetime pickers.

I've tried something like

```
string plannedDate =(dbFunctions.SQLReadColumn("task", "PlannedDate", TaskID));
        DateTime pDate = new DateTime(plannedDate.Substring(0,9);
        dtpDatePicker.Value=pDate; 
```

where plannedDate contains string data in format as mentioned above, but I can't convert it to DateTime (second line incorrect). Is there an easy way to do it or do I have to cut the string into pieces for year, month etc?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T01:13:34.417

这样做

```
dtpDatePicker.Value = Convert.ToDateTime(plannedDate.Substring(0, 10)); 
```

同样的时间

```
mytimepicker.Value = Convert.ToDateTime(plannedDate.Substring(10, 6)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T01:24:24.237

我个人喜欢[DateTime.TryParse 方法](http://msdn.microsoft.com/en-us/library/ch92fbc1)，在您可能收到无效字符串作为输入但不希望抛出异常的情况下：

```
DateTime dateValue;
if (DateTime.TryParse(dateString, out dateValue))
{
    // Conversion succedded
}
else
{
    // Conversion failed
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-20T18:47:04.540

尝试

```
dateTimePicker1.Value = Convert.ToDateTime( gridView1.GetRowCellValue(rowHandle, "CDATE").ToString()); 
```

# iphone - iOS 在 Photos 中创建自定义相册（iOS 5 下 addAssetsGroupAlbumWithName？）

> ID：10610708
> 
> 赞同：4
> 
> 时间：2012-05-16T00:51:06.923
> 
> 标签：iphone, ios, uiimagepickercontroller, alassetslibrary

我想知道是否有可能在 iDevice 的照片库中创建自己的相册？

我知道 ALAsset 的[addAssetsGroupAlbumWithName:resultBlock:failureBlock:](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAssetsLibrary/addAssetsGroupAlbumWithName%3aresultBlock%3afailureBlock%3a)，但它只适用于 iOS >= 5.0 。有没有至少可以支持 4.3 的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:37:36.570

创建自定义相册只能在ios 5下创建。在ios 4下是不可能的。即使是官方的苹果照片应用程序也没有在ios 4下在设备本身中创建相册的功能。在ios 4下创建相册的唯一方法是通过iTunes 照片同步。

干杯，

亨德里克

# c++ - OpenGL：多个重叠视口闪烁

> ID：10610712
> 
> 赞同：2
> 
> 时间：2012-05-16T00:51:25.067
> 
> 标签：c++, opengl, viewport

我正在尝试在我的窗口中创建两个视口：一个主全屏视图和一个位于左上角的较小视图。我已经查看了问题并查看了解决方案：我正在使用 glScissor() 和 glViewport()，清除我的深度缓冲区位，启用我的深度缓冲区位，并且只渲染一次（在 for 循环之后）。但很明显，我错过了一些东西。这是我的代码。先感谢您。

编辑：截图链接：http://imgur[dot]com/a/sdoUy 基本上，左上角的迷你视口闪烁，消失和重新出现很快。

```
void viewports() {
float width = wWidth;
float height = wHeight; 

for (int i = 0; i < 2; i++) {
    glClearColor(.392,.584,.929,0.0f);

    if (i == 0) {
        //main view
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 
        glViewport(0,0,(GLsizei)width,(GLsizei)height);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(60,(GLfloat)width/(GLfloat)height,1.0,100.0);
        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        keyOp();
        camera();
    } else if (i == 1) {
        glScissor(0,height - height/3,(GLsizei)height/3,(GLsizei)height/3);
        glEnable(GL_SCISSOR_TEST);
        glClear(GL_DEPTH_BUFFER_BIT);
        glViewport(0,height - height/3,(GLsizei)height/3,(GLsizei)height/3);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(60,1,1.0,100.0);
        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        gluLookAt(0,40,-15,0,-1,-15,1,0,0);
        glDisable(GL_SCISSOR_TEST);
    }
    renderScene();
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T02:29:10.450

Don't call glutSwapBuffers in renderscene. You call renderscene twice per frame (for i==0 and i==1), so you're drawing main screen, swap, draw minimap, swap, repeat.

You need to draw both main and minimap, and then swap.

Also don't bother calling glClearColor so many times, you only need to call it once at init.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:59:53.457

不确定它是否有助于解决您的闪烁问题，但我注意到您写过：

```
glClearColor(.392,.584,929,0.0f); 
```

第三个参数是 929 而不是我假设你想要的 .929

# javascript - JQuery 灯箱插件：缩放非常大的图像以适应屏幕

> ID：10610714
> 
> 赞同：4
> 
> 时间：2012-05-16T00:51:34.110
> 
> 标签：javascript, jquery, lightbox

我正在使用 jQuery [“灯箱”](http://lokeshdhakar.com/projects/lightbox2/)插件，虽然我不知道这是否是有关手头问题的必要信息。

我通过幻灯片放映的图像非常大。它们中的每一个都比屏幕大得多（我不在我的服务器上托管图像，所以我无法调整它们的大小）。我需要缩放它们以适应屏幕的范围（可能还有一些边距）。是否有一些 JQuery 或其他 Javascript 片段可以解决这个问题？

## 编辑

现在我使用“zoombox”，它肯定解决了缩放问题。但是，现在所有漂亮的幻灯片功能都丢失了！即，我不能使用箭头键或循环浏览图片库！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T00:56:16.823

以下是三个功能丰富且使用广泛的插件，它们应该可以轻松完成工作：

[http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)

[http://fancybox.net/](http://fancybox.net/)

[http://www.grafikart.fr/zoobox](http://www.grafikart.fr/zoombox)

**编辑：**几乎每个灯箱解决方案都在以下位置列出和比较：[http ://planetozh.com/projects/lightbox-clones/](http://planetozh.com/projects/lightbox-clones/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T15:27:40.663

在测试了十几个这样的库后，我选择了[Floatbox 。](http://floatboxjs.com/ "浮箱")默认设置使图像大小适合屏幕并允许使用箭头键进行导航。单击图像会将其放大到 100%。它在颜色、窗户装饰等方面很容易配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-27T07:24:07.813

我分叉了 Lightbox2 以包括自动缩放。

现在，如果图像大于窗口，它将自动调整为 80%。

你可以在[这里](https://github.com/jmeit/lightbox2)找到它，在我的新仓库中。

# javascript - jquery tooltip 很跳

> ID：10610721
> 
> 赞同：1
> 
> 时间：2012-05-16T00:53:28.873
> 
> 标签：javascript, jquery, tooltip, jquery-tooltip

我正在尝试使用 jquery 工具提示插件来扩展一些图像缩略图，并在有人将鼠标悬停在缩略图上时显示完整大小的图像。然而，这是非常跳跃的，即使鼠标保持静止，工具提示也会在固定在一个地方之前跳跃大约 2-3 次。

这是为什么？有没有办法解决它？

html代码：

```
<ul class="gallery" id="gallery">
    <li>
            <img src="<?=site_url('images/Balloon Fest..jpg');?>" class="galleryImg" />
    </li>
</ul> 
```

Javascript：

```
$(".galleryImg").tooltip({
            delay: 0,
            showURL: false,
            bodyHandler: function() {
                return $("<img/>").attr("src", this.src)
                    .attr('width', 300).attr('height', 300);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T23:40:07.580

我在 jquery 论坛上找到了解决方案。只需像这样删除显示和隐藏效果：

```
jQuery('#myelement').tooltip({
    show: false,
    hide: false
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T02:52:40.390

我使用过相同的 jQuery 插件，但它给我带来了一些问题，即同一页面上的大量元素。在测试了一些之后，我选择了这个：

**你可以在这里看到一个工作** [演示！](http://cssglobe.com/lab/tooltip/02/)

**和网页链接** [在这里！](http://cssglobe.com/post/1695/easiest-tooltip-and-image-preview-using-jquery)

* * *

# 已编辑

根据评论的要求，这里有一个基于上述插件的 jQuery 扩展：

**查询**

```
(function($) {
  $.fn.tooltipImg = function(options) {

    // options    
    var opts = $.extend({}, $.fn.tooltipImg.defaults, options);

    // when the mouse gets over the element
    $(this).hover(function(e){

      this.t = this.alt;

      var c   = (this.t != "") ? "<br/>" + this.t : "",
          src = ($(this).data("src")!='') ? $(this).data("src") : this.src,
          res = '<p class="'+opts.wrapper+'"><img src="'+src+'" alt="Image preview" />'+c+'<p>';

      $("body").append(res);

      $("."+opts.wrapper)
        .css({
          "top"  : (e.pageY - opts.xOffset) + "px",
          "left" : (e.pageX + opts.yOffset) + "px"
        })
        .fadeIn("fast");                      
      },
      function(){
        $("."+opts.wrapper).remove();
      });

      // when the mouse moves while over the element
      $(this).mousemove(function(e){
        $("."+opts.wrapper)
          .css({
            "top"  : (e.pageY - opts.xOffset) + "px",
            "left" : (e.pageX + opts.yOffset) + "px"
          });
      });

  }

  // options defaults
  $.fn.tooltipImg.defaults = {
    xOffset : 10,
    yOffset : 30,
    wrapper : 'myTooltipImgWindow'
  }

})(jQuery); 
```

**用法**

```
$(document).ready(function(){
  $('.tooltipMe').tooltipImg();

  // with options
  $('.tooltipMe').tooltipImg({
    xOffset : 20,
    yOffset : 40,
    wrapper : 'myToolTipContainerClass'
  });
}); 
```

你可以看到这个[工作的小提琴！](http://jsfiddle.net/zuul/7DLnM/)

这个小提琴说明了来自跨域的图像，具有相对路径和来自`img` `src`.

请注意，*Fiddle 下的相对路径是错误*的，有时您会看到它，有时您不会，但它工作得很好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T11:31:26.023

我以前看到过这种情况——这就是为什么我搜索了一个更灵活、易于使用且易于集成的工具提示。我通过 Listly 找到了一个很棒的工具 - 查看 WalkMe.com。我想你会发现结果非常令人满意。让我知道图像是如何工作的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T14:04:58.803

在编写自己的简单工具提示时，我发现当我将工具提示附加到**非正文**元素时。在 IE7、IE8 和 IE9 中隐藏/显示工具提示之间会出现跳动或紧张。

例如，我有`$('li').append(toolTip html..)`导致工具提示的紧张或跳跃隐藏/显示。在 firefox、Chrome 和 Safari 中不紧张或紧张。在 IE7、IE8 和 IE9 中不好。

当我切换到 时`$('body').append(toolTip html..)`，它会按预期在 IE 7、IE8 和 IE9 中显示，并且在 Firefox、Chrome 和 Safari 中仍然可以正常工作。

# objective-c - NSDateFormatter 崩溃。怎么会？

> ID：10610724
> 
> 赞同：3
> 
> 时间：2012-05-16T00:54:37.667
> 
> 标签：objective-c, ios, cocoa, nsdateformatter, date-formatting

```
 NSDateFormatter *timeFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [timeFormatter setDateFormat:@"h:mm a"];
    NSString *fullTime = [timeFormatter stringFromDate:someDateHere];
    NSArray *timeParts = [fullTime componentsSeparatedByString:@" "];
    timeLabel.text = [timeParts objectAtIndex:0];
    ampmLabel.text = [timeParts objectAtIndex:1]; 
```

最后一行崩溃

```
 NSRangeException*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0] 
```

这怎么可能？在此代码之前返回的日期有一个 nil 检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T01:06:24.793

从数据格式指南文档（日期格式化程序>使用格式字符串指定自定义格式>固定格式部分）：

> 尽管原则上格式字符串指定了固定格式，但默认情况下 NSDateFormater 仍会考虑用户的偏好（包括区域设置）。... 在 iOS 中，用户可以覆盖默认的 AM/PM 与 24 小时时间设置。这可能会导致 NSDateFormatter 重写您设置的格式字符串。

换句话说，在设置为 24 小时时间设置的 iOS 设备上，即使您指定了“h:mm a”，您也不会得到“6:02 PM”，而是会得到“18:02”。因此，当您用空格分隔时，您会返回一个值“18:02”，而不是两个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:13:21.780

[NSDateFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)的文档中有一个警告说：

> 请注意，虽然设置格式[字符串](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DataFormatting/DataFormatting.html#//apple_ref/doc/uid/10000029i)`setDateFormat:`（

这是否适用于您的情况以生成没有任何空格的字符串？（当被空格分割时，这将导致长度为 1 的数组，在您看到它的地方给出您看到的异常。）通过记录格式化日期或附加调试器来检查这一点。

请注意，[日期格式页面](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW1)`strftime_l`的末尾确实建议在处理未本地化的日期/时间时使用普通旧的。那可能更适合你。（此外，您希望在绑定到计算机的数据中使用 AM/PM 指示器？说真的？24 小时制通常更容易使用……）

# asp.net-mvc - ASP.NET MVC 4 + EF5 beta2 + DbGeography 类型 + MiniProfiler 抛出错误

> ID：10610729
> 
> 赞同：3
> 
> 时间：2012-05-16T00:55:33.957
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first

我有一个使用 EF 5 Code First 的 MVC 4 项目。我试图安装 MiniProfile 无济于事。

我从 NuGet 中提取了**MiniProfiler 2.0.1**和**MiniProfiler.EF 2.0.2**，在 Global.asax.cs 上添加了以下内容：

```
protected void Application_Start()
{
    MiniProfilerEF.Initialize(); 
} 
```

运行后，我立即收到此错误：

## *提供者未返回 DbSpatialServices 实例。*

```
Line 58:   if (user != null)
Line 59:   {
Line 60:>>>    if (user.Places != null)
Line 61:       {
Line 62:            var place= user.Places .OrderByDescending(x => x.CreationTime).FirstOrDefault();

[ProviderIncompatibleException: The provider did not return a DbSpatialServices instance.]
   System.Data.Common.DbProviderServices.GetDbSpatialDataReader(DbDataReader fromReader, String manifestToken) +62
   System.Data.Common.DbProviderServices.GetSpatialDataReader(DbDataReader fromReader, String manifestToken) +101
   System.Data.Spatial.SpatialHelpers.CreateSpatialDataReader(MetadataWorkspace workspace, DbDataReader reader) +70
   System.Data.Common.Internal.Materialization.Shaper.CreateSpatialDataReader() +12
   System.Data.Common.Utils.Singleton`1.get_Value() +25
   System.Data.Common.Internal.Materialization.Shaper.<GetSpatialPropertyValueWithErrorHandling>b__d(DbDataReader reader, Int32 column) +12
   System.Data.Common.Internal.Materialization.ErrorHandlingValueReader`1.GetValue(DbDataReader reader, Int32 ordinal) +149
   System.Data.Common.Internal.Materialization.Shaper.GetSpatialPropertyValueWithErrorHandling(Int32 ordinal, String propertyName, String typeName, PrimitiveTypeKind spatialTypeKind) +269
   lambda_method(Closure , Shaper ) +942
   System.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly(Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet) +239
   lambda_method(Closure , Shaper ) +221
   System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper) +163
   System.Data.Common.Internal.Materialization.SimpleEnumerator.MoveNext() +88
   System.Data.Objects.DataClasses.RelatedEnd.Merge(IEnumerable`1 collection, MergeOption mergeOption, Boolean setIsLoaded) +222
   System.Data.Objects.DataClasses.EntityCollection`1.Load(List`1 collection, MergeOption mergeOption) +218
   System.Data.Objects.DataClasses.EntityCollection`1.Load(MergeOption mergeOption) +25
   System.Data.Objects.DataClasses.RelatedEnd.Load() +37
   System.Data.Objects.DataClasses.RelatedEnd.DeferredLoad() +300
   System.Data.Objects.Internal.LazyLoadBehavior.LoadProperty(TItem propertyValue, String relationshipName, String targetRoleName, Boolean mustBeNull, Object wrapperObject) +85
   System.Data.Objects.Internal.<>c__DisplayClass7`2.<GetInterceptorDelegate>b__1(TProxy proxy, TItem item) +105
   System.Data.Entity.DynamicProxies.User_C006B0EF9498157C70250EEE038C6BEADB719A2D5BDC4AA1FB567FB579AECEB5.get_Places() +55
   Project.Web.Controllers.PlaceController.Ribbon() in c:\Project\Project.Web\Controllers\PlaceController.cs:60
   lambda_method(Closure , ControllerBase , Object[] ) +62
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +14
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +204
   System.Web.Mvc.Async.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41() +30
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +10
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult) +45
   System.Web.Mvc.Async.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33() +58
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +225
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +225
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +225
   System.Web.Mvc.Async.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult) +10
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +47
   System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +24
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +102
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +42
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +14
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +23
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +54
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +23
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +44
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +9
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__4(IAsyncResult asyncResult) +25
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +23
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +47
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +23
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +59
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.Mvc.<>c__DisplayClassa.<EndProcessRequest>b__9() +22
   System.Web.Mvc.<>c__DisplayClass4.<Wrap>b__3() +10
   System.Web.Mvc.ServerExecuteHttpHandlerWrapper.Wrap(Func`1 func) +27
   System.Web.Mvc.ServerExecuteHttpHandlerWrapper.Wrap(Action action) +64
   System.Web.Mvc.ServerExecuteHttpHandlerAsyncWrapper.EndProcessRequest(IAsyncResult result) +71
   System.Web.HttpServerUtility.ExecuteInternal(IHttpHandler handler, TextWriter writer, Boolean preserveForm, Boolean setPreviousPage, VirtualPath path, VirtualPath filePath, String physPath, Exception error, String queryStringOverride) +1121 
```

我的 Places POCO 中有几个 DbGeography 类型。

```
public class Places 
{
    public Guid PlacesId { get; set; }
    ...
    public DbGeography Location { get; set; }
    public DbGeography Area { get; set; }
    ...
} 
```

我已经尝试搜索该错误，但它没有出现在任何地方的谷歌中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:29:42.083

这看起来像是 MiniProfiler 中的一个错误，应该报告在：http: [//community.miniprofiler.com](http://community.miniprofiler.com)

特别是分析 EF 非常棘手，很多工作都是通过包装它使用的每个“提供程序”来完成的。似乎 EFProfiledDbProviderFactory 需要一些特殊的逻辑来定位、拦截和包装空间服务。

# iphone - iOS SDK 5.0 iPhone 应用程序故障

> ID：10610735
> 
> 赞同：0
> 
> 时间：2012-05-16T00:56:53.113
> 
> 标签：iphone, ios, xcode, storyboard

我正在开发我的第一个 iPhone 应用程序，并在我的代码中偶然发现了一个未知错误。代码工作得很好，但问题在于当我点击我制作的自定义 UIButton 并加载下一个视图时。我有一个期望的 buttonPressed IBAction 被调用来处理下一个视图控制器上加载的信息，但是函数调用的顺序是错误的。我有 5 个不同的 buttonPressed 功能，5 个中有 3 个工作正常。请注意，我通过 Storyboard 以完全相同的方式实现了它们，甚至尝试重新制作不工作的那些。我会发布代码，但代码是基本的 if/else 语句。我只是不确定为什么 5 种方法中有 3 种会起作用，而另外 2 种不会。任何帮助将不胜感激。

**这是工作 3 所需的顺序：

viewDidLoad -> 加载主屏幕（初始视图控制器 AKA ROOT，在主屏幕上，您有 5 个 UIButtons 来选择一个类别，点击一个按钮以加载到新的视图控制器）

categoryButtonPressed -> 设置计数器（新视图控制器的序列）

viewDidLoad -> 加载屏幕以缩小搜索范围

（现在您有 10 多个自定义按钮可以点击，每个按钮都将通过 buttonPressed IBAction 函数进行处理，一旦点击按钮并调用函数，就会加载一个新视图）

buttonPressed -> 设置计数器（新视图控制器的序列）

viewDidLoad -> 加载正确的信息

这是非工作 2 的顺序：

viewDidLoad -> 加载主屏幕（初始视图控制器 AKA ROOT）（在主屏幕上，您有 5 个 UIButtons 来选择一个类别，点击一个按钮以加载到新的视图控制器）

categoryButtonPressed -> 设置计数器（新视图控制器的序列）

viewDidLoad -> 加载屏幕以缩小搜索范围（现在您有 10 多个自定义按钮可以点击，每个按钮都将通过 buttonPressed IBAction 函数进行处理，一旦点击按钮并调用函数，就会加载一个新视图）

viewDidLoad -> 加载空白信息（空白屏幕）

buttonPressed -> 设置计数器，但由于视图已经加载为空白而迟到

想法？**

这是 categoryButtonPressed 的示例：

-(IBAction)categoryButtonPressed:(id)sender

{

```
if([sender tag] == 1)

    counter = 1;

else if([sender tag] == 2)

    counter = 2;

.

.

. 
```

}

注意：我为要加载的特定项目标记了每个自定义按钮。此函数只是设置一个计数器，以便另一个函数可以加载特定文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:05:07.063

使用转场。

在您的主视图控制器上，通过在按下特定转场时在视图控制器上加载所需的信息来设置转场。

如果您使用故事板，您可以按照本指南进行操作

[http://www.scott-sherwood.com/?p=219](http://www.scott-sherwood.com/?p=219)

**寻找“prepareForSegue”方法，当使用故事板时，模态呈现的视图应该以这种方式预先配置。**

附带说明一下，“viewDidLoad”通常不用于加载另一个视图，它应该用于在加载后配置该视图。

# javascript - Android 浏览器的 screen.width, screen.height & window.innerWidth & window.innerHeight 不可靠

> ID：10610743
> 
> 赞同：33
> 
> 时间：2012-05-16T00:58:04.130
> 
> 标签：javascript, android, html, dom

我正在开发一个针对台式机、平板电脑和智能手机上的浏览器的网络应用程序。

Web 应用程序有一个使用[Colorbox](http://www.jacklmoore.com/colorbox)和`iframe`. 当浏览器窗口调整大小或平板电脑/手机改变方向时，Javascript 代码会查询窗口尺寸，以便调整灯箱的某些元素的大小。

我遇到的问题是，在桌面（Windows：IE、Firefox、Chrome、Mac：Safari）、iPad 和 iPhone 上一切正常，但在 Android 智能手机 (HTC) 和 Android 模拟器上却不行。

当从窗口的 resize 事件中查询它们时，Android 总是返回不同的值`screen.width`，该事件会触发多次。`screen.height``window.innerWidth``window.innerHeight`

**为什么 Android 浏览器返回的值差异如此之大，我如何可靠地检测浏览器窗口的宽度和高度？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-21T04:43:12.167

在 Android 上，window.outerWidth 和 window.outerHeight 是可靠的屏幕尺寸。根据您的 Android 版本，innerWidth/Height 通常不正确。

[这是一篇](http://tripleodeon.com/2011/12/first-understand-your-screen/)关于这种情况的非常好的文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-02T09:29:18.587

以下是基于运行 Android 4.1 的三星 Tab 读数的差异

*   screen.height - 给出实际设备高度，包括任务栏和标题栏

*   window.innerHeight - 给出不包括任务栏、标题栏和地址栏的高度（如果可见）

*   window.outerHeight - 给出不包括任务栏和标题栏高度的高度，（无论地址栏是可见还是隐藏，outerHeight 包括地址栏高度。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T10:01:33.770

我花了几个小时才找到解决方法。

`window.innerHeight`,`window.outerheight`等中唯一的常数是`screen.height`.

这段代码给了我outerheight：

```
screen.height / window.devicePixelRatio - window.screenTop 
```

此外，为了支持旧版本的 android，请将您的代码放在`setTimeout`

我希望这会有所帮助 =)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-06T08:43:01.633

我正在使用它来使其在 ios 和 android 之间工作。

```
var screenHeight = (ionic.Platform.isIOS()) ? window.screen.height : window.innerHeight * window.devicePixelRatio; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-19T12:36:42.333

试试这个，检查你的手机阅读

```
<script>
var total_height=screen.height*window.devicePixelRatio;
alert(total_height);
</script> 
```

它应该与您手机规格的屏幕尺寸（高度）相匹配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-31T10:04:55.580

```
 var throttle = (function () {
        var timer;

        return function (fn, delay) {
            clearTimeout(timer);
            timer = setTimeout(fn, delay);
      };
    })(),

    var callback = function (w, h) {
        alert(w + ' ' + h);
    }

    window.onresize = throttle(function () {
        width = Math.min(window.innerWidth, window.outerWidth);
        height = Math.min(window.innerHeight, window.outerHeight);

        callback(width, height);
    }, 60); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-13T17:32:26.393

丹的回答解决了android浏览器之间的不一致问题。所以我发布了我如何检测/更改移动视口并在旋转时对其进行调整（不知道是否适用于任何人...

```
var lastorg=0; //set the begining of script
thisorg=parseInt(window.innerWidth)/parseInt(window.innerHeight); //for ratio to detact orietation
if(((lastorg<1 && thisorg>1) ||(lastorg>1 && thisorg<1) ||lastorg==0 )){ //is start or change
$("#viewport").attr('content', 'width=device-width, initial-scale=1,minimum-scale=1, maximum-scale=1'); // reset viewport to device
mywidth = Math.min(window.innerWidth, window.outerWidth); //Dan's way to fix the inconsistancy
myheight = Math.min(window.innerHeight, window.outerHeight);
lastorg=thisorg;    //update the lastorg
wr=parseInt(mywidth)/1280;  // the minimum desire width
hr=parseInt(myheight)/630;  // the minimum desire height
if(hr<wr){
vscale=hr;
if(hr<1){ // if it if small screen, so desktop pc wouldn't change
windowHeight=630;
windowwidth=mywidth/hr;
}
}else{
 vscale=wr;
 if(wr<1){
  windowwidth=1280;
  windowHeight=myheight/wr;
 }
}
$("#viewport").attr('content', 'width=device-width, initial-scale='+vscale+',minimum-scale='+vscale+', maximum-scale='+vscale); //reset viewport toresize window
 if(thisorg>1){
  $("#pro").fadeOut(500);
 }else{
$("body").prepend("<div id=pro style='position:absolute;width:800px;height:30px;padding:30px;left:"+(windowwidth/2)+"px;top:"+(windowHeight/2)+"px;margin-left:-430px;margin-top:-45px;;border:1px solid #555;background:#ddeeff;text-align:center;z-index:99999;color:#334455;font-size:40px;' class=shadowme>Please rotate your phone/tablet</div>");//tell user to rotate
}
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-18T01:46:30.947

就我而言， setTimeout 钩子没有用。

经过一番挖掘，我发现不同的 Android 版本（和设备）具有不同的 devicePixelRatio 值。

如果 devicePixelRatio 等于或大于 1，则屏幕中的实际像素数（从 html 页面的角度来看）由 window.screen.width（或 ...height）给出。

但是，如果 window.screen.width 小于 1（在一些旧的 Android 设备中会发生），实际的像素数变为：window.screen.width/devicePixelRatio。

所以，你只需要应付这个。

```
w = window.screen.width;
h = window.screen.height;

if(window.devicePixelRatio < 1){
  w = window.screen.width/window.devicePixelRatio;
  h = window.screen.height/window.devicePixelRatio;
} 
```

# javascript - Javascript：在类中添加一个类

> ID：10610745
> 
> 赞同：0
> 
> 时间：2012-05-16T00:58:53.720
> 
> 标签：javascript, jquery

我正在使用js，我需要删除一个类并添加另一个类，在这种情况下可见和不可见（我认为是自我解释的css）到所有具有“编辑”类的元素。是否可以使用类作为添加类的选择器？

我试过了：

```
$(function){
    $('#hide').click(function(){
        $('.edit').addClass('visible');
    });
}; 
```

这不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T01:00:46.960

你缺少一个左括号。

```
$(function){ 
```

应该

```
$(function() { 
```

此外，`};`最后应该是`});`. （谢谢，jmar777！）

# python - 如何从控制台中导入的文件中访问变量的内容？

> ID：10610751
> 
> 赞同：1
> 
> 时间：2012-05-16T01:00:43.037
> 
> 标签：python

我有一个要调试的文件 light.py。在 python 控制台中，我输入“import light”并运行程序。但我想通过输入变量来检查一些变量的内容。我怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T01:02:33.183

`test`您的文件中有一个名为的变量`light.py`

```
import light
print light.test 
```

如果要在程序运行期间进行测试，则需要使用[pdb](http://docs.python.org/library/pdb.html)来调试执行

# maven - 配置 Maven 或 Nexus 以在静态 URL 链接主干工件

> ID：10610754
> 
> 赞同：2
> 
> 时间：2012-05-16T01:00:49.503
> 
> 标签：maven, nexus

我当前的 Jenkins 部署作业从 Nexus 存储库中检索从 maven 构建过程生成的战争文件。部署是这样完成的，因为我不能在我的环境中使用热部署。目前我使用 Jenkins 的参数化构建，所以我可以手动输入我的工件的版本号。有没有办法配置 Maven 或 Nexus，以便可以从静态 URL 访问从最新的主干构建生成的工件？例如：

```
http://mynexus:8081/nexus/content/repository/snapshots/com/somepackage/my-app/trunk/my-app-trunk.war 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:37:06.897

我不知道如何在 Nexus 中做到这一点。但是您可以从 Jenkins 访问最新的成功构建，其 URL 如下所示：`http://localhost:8080/jenkins/job/jobname/lastSuccessfulBuild/my-app-trunk.war`

您必须为您的战争文件启用工件存档，然后您才能访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T05:44:49.860

同样的问题在这里，我们发现：

[https://wiki.jenkins-ci.org/display/JENKINS/Maven+Deployment+Linker](https://wiki.jenkins-ci.org/display/JENKINS/Maven+Deployment+Linker)

哪个工作。

希望有帮助。

# android - 想做一个类似于Chive应用的UI

> ID：10610757
> 
> 赞同：-3
> 
> 时间：2012-05-16T01:02:02.107
> 
> 标签：android

我想制作一个 UI 类似于 theChive's Gallery 的 UI 的 Android 应用程序。一直在玩Android 10 分钟。我一直在搜索各种教程，但似乎没有什么是我所追求的。
我想学习如何制作滚动列表。列表中的每个项目左侧都有一张图片，右侧有一些文字。每个项目都应该能够被“点击”并将它们带到另一个屏幕上，并提供更多详细信息。我不知道这个“项目”是否应该是一个按钮、文本视图、小部件、画廊等......如果我能找到这样做的最佳实践，我想我可以从那里找出其余的。谁能指出我文章/博客/教程的正确方向？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:54:27.077

您需要更多地使用 android 和 google。

[教程1](http://blog.sptechnolab.com/2011/02/01/android/android-custom-listview-items-and-adapters/)

[教程2](http://w2davids.wordpress.com/android-listview-with-iconsimages-and-sharks-with-lasers/)

# excel - 如何在 VBA 中的用户表单中嵌入表单

> ID：10610762
> 
> 赞同：0
> 
> 时间：2012-05-16T01:03:25.133
> 
> 标签：excel, vba

有没有办法在 MS Excel VBA 的用户表单中嵌入表单？我需要在 VBA 中创建一个具有最小化、最大化和关闭窗口功能的嵌入式表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T08:30:40.383

您想要的实际上称为 MDI（多文档界面），它有一个父表单和一个子表单。VBA 只允许您创建 SDI（单文档界面）。虽然我不确定 Microsoft Visio。不过剩下的绝对是SDI

所以答案是“不”。您不能在 VBA 中创建 MDI 应用程序。

# facebook - 如何将“转到应用程序”按钮添加到现有页面

> ID：10610766
> 
> 赞同：7
> 
> 时间：2012-05-16T01:04:08.653
> 
> 标签：facebook, admin

我有一个 Facebook 页面，我想将它与一个新应用程序关联，这样我就可以在此页面上拥有“转到应用程序”按钮。似乎没有任何方法可以将新应用程序与现有页面相关联。在应用程序高级设置中，只有创建页面的选项 - 但我不想创建新页面，因为我在现有页面上已经有非常多的追随者（喜欢的数量）。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T15:43:51.053

恐怕没有工作。当 Facebook 首次为应用程序引入“创建页面”功能时，他们允许您创建类型为“应用程序”的页面并将其添加到应用程序中。看起来此功能已被删除，因为您必须创建一个新页面。

但是，您可以使用该`Migrate Pages`功能将两个页面合二为一，但是当您将旧页面移动到新页面时，您会丢失旧页面上的内容。

# c - Crenshaw 的“让我们构建一个编译器”：转录为 C 和 x86 汇编器？

> ID：10610772
> 
> 赞同：7
> 
> 时间：2012-05-16T01:05:17.940
> 
> 标签：c, assembly, compiler-construction, x86, pascal

我正在努力学习 Jack Crenshaw 出色的编译器编程教程“让我们构建一个编译器”，但遇到了两个障碍。首先，代码是用 Pascal 编写的，这是一种很棒的语言，我在 1980 年代中期短暂接触过它，对此我既尊重又喜爱，但从那以后我就再也没有接触过它。我目前主要用 C 编程。

另一个障碍是生成的汇编程序适用于摩托罗拉 68000 系列处理器。虽然我可以为它找到一个翻译器，但如果我能生成 Intel x86 汇编器（Intel 或 AT&T 风格）会更好。

我可以在 Linux、Mac OsX 或 Windows 7 上处理代码，如果它使任何事情变得更容易的话。我可以访问所有指定的操作系统。

我觉得自己不完全有资格进行转录。有没有人已经解决了这个问题，或者您有其他建议吗？

欢迎任何想法、反馈或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:13:01.387

以 JVM 而不是本机处理器为目标可能更容易。至于将 Pascal 翻译成 C ......这不应该*是*一个真正的障碍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T09:47:42.833

[您可以在68K 模拟器](http://en.wikipedia.org/wiki/Category:68k_emulators)上运行生成的代码——该页面上的一些条目是开源的。

# php - 如何使用 php 访问 php 页面上的 DOM 元素？

> ID：10610774
> 
> 赞同：0
> 
> 时间：2012-05-16T01:05:53.520
> 
> 标签：php, dom

我想在我的 header.php 文件中运行这段代码

```
<?php 
$doc = new DOMDocument();
$doc->load('wp-content/themes/foo/header.php');
$header_li_elements = $doc->getElementsByTagName('li');
foreach($header_li_elements as $value){
echo $value->nodeValue;
}
?> 
```

这可能吗？

我希望能够运行一个 php 函数来检查我当前所在的页面，然后更改特定 nav 元素的 id 属性，以便我可以动态更改我所在页面的 nav 元素的外观.

目前我只是试图访问我所在页面上的“li”元素，然后回显它们，我可以从那里开始工作。有什么想法吗？

对不起，如果它令人困惑。我很难描述我在想什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T01:07:53.047

由于该页面是动态的（例如 HTML 是由 PHP 生成的），因此这将不起作用，因为您希望解析的 HTML 尚不存在。它直到运行时才创建。您必须找到另一种方法来执行此操作，例如检查当前 URL 并使用它来确定导航栏的外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:13:26.217

为此，您的 php 将不得不像解析 XML 一样解析您的 HTML。并非不可能，但更适合单行 jQuery 的工作。

如果您出于某种原因坚持在服务器端执行此操作，最好在生成列表项时捕获它们，而不是等到它们作为一个巨大的字符串返回然后尝试将它们全部转换回到标签，这样你就可以操纵它们，只是为了把它们重新变成一个巨大的字符串。

看起来像 Wordpress，我很确定 Wordpress 有可用的 API 来帮助您完成此任务，但我们需要确切了解 header.php 中发生了什么。

# arrays - 为什么`x[0]`返回一个零长度向量？

> ID：10610775
> 
> 赞同：13
> 
> 时间：2012-05-16T01:06:16.260
> 
> 标签：arrays, r

假设我有一个向量，例如 ，`x <- 1:10`然后在此处`x[0]`返回与 相同类的零长度向量。`x``integer(0)`

我想知道该选择背后是否有原因，而不是抛出错误或`NA`按原样返回`x[11]`？另外，如果您能想到`x[0]`退货`integer(0)`很有用的情况，感谢您将其包含在您的答案中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T02:22:05.930

如所见`?"["`

> NA 和零值是允许的：索引矩阵中包含零的行被忽略，而包含 NA 的行在结果中产生 NA。

所以 0 的索引会被忽略。我们可以在下面看到这一点

```
x <- 1:10
x[c(1, 3, 0, 5, 0)]
#[1] 1 3 5 
```

因此，如果我们给它的唯一索引是 0，那么适当的响应是返回一个空向量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T02:06:24.667

因为我不是程序员，所以我对此很感兴趣，当然也不会为 R 源代码做出贡献。我认为这可能是因为您需要某种占位符来说明此处发生了某些事情，但没有返回任何内容。`tables`这对于和之类的东西变得更加明显`split`。例如，当您制作一个值表并说该单元格为零时，您需要保持由向量中的字符串组成的该单元格没有值。拥有它是不合适的，`x[0]==0`因为它不是零的数值，而是没有任何值。

因此，在下面的拆分中，我们需要一个占位符并`integer(0)`保存不返回值的位置，它与 0 不同。注意它返回的第二个`numeric(0)`仍然是一个占位符，说明它是数字占位符。

```
with(mtcars, split(as.integer(gear), list(cyl, am, carb)))
with(mtcars, split(gear, list(cyl, am, carb))) 
```

所以在某种程度上，我的`x[FALSE]`反驳是正确的，因为它在向量中占据了不存在的零点的位置。

好吧，我刚刚吐出的这个巴隆加是真的，直到有人对此提出异议并将其撕毁。

PS 本指南（[链接](http://cran.r-project.org/doc/contrib/Genolini-S4tutorialV0-5en.pdf)）的第 19 页指出`integer() and integer(0) are empty integer.`

**相关的 SO 帖子：** [如何捕获整数（0）？](https://stackoverflow.com/questions/6451152/how-to-catch-integer0)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T02:20:19.187

由于数组索引是从 1 开始的，因此索引 0 没有任何意义。该值作为向量索引被忽略。

# javascript - 选择加入/选择退出复选框

> ID：10610777
> 
> 赞同：1
> 
> 时间：2012-05-16T01:07:17.243
> 
> 标签：javascript, jquery, checkbox

我正在尝试创建一种简单的方法来强制单个复选框在未选中或单击关闭的情况下在表单提交中显示“否”。我尝试了多种方法，这是我能得到的最接近的方法，但它仍然无法正常工作。

任何帮助深表感谢。马特

```
$(function opt() {
        if ($("#optIn").is(":checked")) {
            $("#optIn").value="Yes"
            $("#optIn").click(function() { this.value="No" })
        } else {
            $("#optIn").value="No"
            $("#optIn").click(function() { this.value="Yes" })
        }
    return false
});

opt(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T01:14:04.473

未选中的复选框不是一个[成功的控件](http://www.w3.org/TR/html4/interact/forms.html#h-17.13.2)，因此不会与其余的表单数据一起发布。

最简单的解决方案是创建一个与复选框同名的隐藏输入，其中包含“未选中”值：

```
<input type="hidden" name="myCheckbox" value="No" />
<input type="checkbox" name="myCheckbox" value="Yes" /> 
```

`myCheckbox=No`如果未选中该复选框，这将导致表单 POST 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T01:13:33.143

所以坦率地说，我不确定你以前在哪里看到过这种功能设置。您的代码按原样可以简化为：

```
$(function() { // on DOM ready (when the DOM is finished loading)
    $('#optIn').click(function() { // when the checkbox is clicked
        var checked = $('#optIn').is(':checked'); // check the state
        $('#optIn').val(checked ? "Yes" : "No"); // set the value
    });
    $('#optIn').triggerHandler("click"); // initialize the value
}); 
```

但是`value`，复选框的 永远不会显示在屏幕上。您可能需要使用值“是”或“否”更新单独的字段，例如：

```
<input type="checkbox" id="optIn" />
<span id="optInLabel"/>No</span> 
```

和脚本：

```
$(function() { // on DOM ready (when the DOM is finished loading)
    $('#optIn').click(function() {
        optIn(this);
    });
    optIn($('#optIn')[0]);
});

function optIn(el) {
    var checked = $(el).is(':checked'); // check the state
    $('#optInLabel').html(checked ? "Yes" : "No"); // set the value
} 
```

**编辑：[工作 jsFiddle](http://jsfiddle.net/d9mqm/)**

如果您需要检查是否在服务器端提交表单后选中该框，那么您还可以使用值“是”或“否”更新隐藏的输入字段并忽略提交的复选框元素值（`jaredhoyt`如前所述在他的回答中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T02:18:20.550

使用单选按钮：

```
<span>Opt in?</span>
<br>
<input type="radio" name="optIn" value="no" checked>No&nbsp;
<input type="radio" name="optIn" value="yes">Yes 
```

不需要 javascript，适用于所有浏览器，没有垫片，没有库，什么都没有。

# dotnetnuke-module - 你能以编程方式修改 DotNetNuke Breadcrumb 皮肤对象吗？

> ID：10610791
> 
> 赞同：1
> 
> 时间：2012-05-16T01:09:34.750
> 
> 标签：dotnetnuke-module

在开发除了标准 View.ascx 和 Edit.ascx 控件之外还有其他页面的自定义模块时，我希望能够从我的模块以编程方式将项目添加到面包屑皮肤对象。这在 DNN 6.2+ 中可行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T19:27:16.183

是的。您必须编写自己的面包屑皮肤对象。然后，您将提供某种允许您添加到路径的钩子。我们必须在菜单中做类似的事情，所以编写了我们自己的菜单提供程序。面包屑皮肤对象有点不同但想法相同。

# c++ - QFtp hasPendingCommands() 返回真，但从不发出 commandStarted(int) 信号

> ID：10610793
> 
> 赞同：0
> 
> 时间：2012-05-16T01:09:43.970
> 
> 标签：c++, qt

我正在尝试编写一段代码以使用带有 Qt 的 c++ 连接到 FTP 服务器，但我看到了一些奇怪的结果。代码如下

```
void eos::WeatherRadar::connectToServer()
{
    m_bomServer = new QFtp;
    connect( m_bomServer, SIGNAL( commandStarted( int ) ), this, SLOT( serverConnectStarted() ) );
    connect( m_bomServer, SIGNAL( commandFinished( int, bool ) ), this, SLOT( serverConnectFinished() ) );

    m_bomServer->connectToHost("ftp.bom.gov.au");
    m_bomServer->connectToHost("ftp.bom.gov.au");

    if ( m_bomServer->hasPendingCommands() )
        std::cout << "I have commands to execute..." << std::endl;
    else
        std::cout << "I have no commands even though you just gave me one... WTF!!!" << std::endl;
} 
```

现在让奇怪的开始......注意我已经重复了这`connectToHost`行。出于某种原因，如果我只在它说“即使你给了我一个命令我也没有命令...... WTF !!!”时才打那个电话 只有当我两次调用时才会`hasPendingCommands()`返回`true`。此外，无论我拨打一次还是两次，`commandStarted(int)`都不会发出信号。

有谁知道为什么会发生这种情况或如何解决？在此先感谢大家:-)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T11:47:35.890

QFtp::hasPendingCommands的[文档](http://qt-project.org/doc/qt-4.8/qftp.html#hasPendingCommands)说

> 正在执行的命令不被视为计划命令。

因此，在调用 to 后立即为 false 是正常的`connectToHost()`。

对于连接到`commandStarted()`从未调用过的槽的问题，从代码中很难说，但一个典型的原因是你的代码没有返回到Qt的主事件循环。QFtp 是异步的，所以如果 Qt 事件循环没有运行，什么也不会发生。

# android - 动态 ViewPager 页面流

> ID：10610794
> 
> 赞同：1
> 
> 时间：2012-05-16T01:09:46.633
> 
> 标签：android, android-viewpager

我使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)让用户左右翻转以在给定活动的页面之间导航。

是否可以以编程方式控制 ViewPager 的页面流？

例如：如果用户没有在当前页面上填写给定的 EditText，我不希望他能够导航到下一个。

另一种情况：如果用户当前在第 1 页，并且如果 hi 用特定值填充给定的 EditText 并且用户从右向左翻转，我希望他直接进入第 5 页而不是第 2 页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T03:04:05.770

“翻转”是指用手指拖动还是仅使用 ViewPager 进行动画？

如果是前者，则必须动态编辑 ViewPager 的子项以获得所需的效果。您可以覆盖`onInterceptTouchEvent()`以阻止触摸事件，直到页面完成。

但是，我建议在 ViewPager 中禁用手指拖动（可能使用`onInterceptTouchEvent()`），然后使用`setCurrentItem(4, true)`来显示动画并导航到特定页面。您需要的逻辑可以使用将调用的按钮来实现`setCurrentItem(4, true)`。例如，您可以有一个灰色的“下一步->”按钮，除非表格完全完成。无论如何，这将比第一个选项更直观。

编辑： 4 就是您要切换到的任何子索引。

# ruby-on-rails - jruby, rake db:migrate 失败。堆栈级别太深

> ID：10610795
> 
> 赞同：1
> 
> 时间：2012-05-16T01:10:00.527
> 
> 标签：ruby-on-rails, rake, jruby

使用 rails 3.2 应用程序，我一直在尝试在 jruby 中运行数据库迁移。我使用命令：

```
jruby --1.9 -S rake db:migrate --trace 
```

这是输出：

```
jruby --1.9 -S rake db:migrate --trace
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:2 warning: already initialized constant VERSION
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:5 warning: already initialized constant MAJOR
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:5 warning: already initialized constant MINOR
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:5 warning: already initialized constant BUILD
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:5 warning: already initialized constant PATCH
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/version.rb:6 warning: already initialized constant NUMBERS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake.rb:27 warning: already initialized constant RAKEVERSION
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/early_time.rb:17 warning: already initialized constant EARLY
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/alt_system.rb:32 warning: already initialized constant WINDOWS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:31 warning: already initialized constant DEFAULT_RAKEFILES
WARNING: Possible conflict with Rake extension: String#ext already exists
WARNING: Possible conflict with Rake extension: String#pathmap already exists
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task_arguments.rb:77 warning: already initialized constant EMPTY_TASK_ARGS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/invocation_chain.rb:49 warning: already initialized constant EMPTY
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:9 warning: already initialized constant RUBY
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:86 warning: already initialized constant LN_SUPPORTED
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:16 warning: already initialized constant DEFAULT
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/dsl_definition.rb:150 warning: already initialized constant DeprecatedCommands
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:44 warning: already initialized constant ARRAY_METHODS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:47 warning: already initialized constant MUST_DEFINE
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:51 warning: already initialized constant MUST_NOT_DEFINE
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:55 warning: already initialized constant SPECIAL_RETURN
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:61 warning: already initialized constant DELEGATING_METHODS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:364 warning: already initialized constant DEFAULT_IGNORE_PATTERNS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/file_list.rb:370 warning: already initialized constant DEFAULT_IGNORE_PROCS
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake.rb:68 warning: already initialized constant FileList
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake.rb:69 warning: already initialized constant RakeFileUtils
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
stack level too deep
org/jruby/RubyProc.java:258:in `call'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/lazy_load_hooks.rb:34:in `execute_hook'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/lazy_load_hooks.rb:43:in `run_load_hooks'
org/jruby/RubyArray.java:1615:in `each'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/application/finisher.rb:60:in `Finisher'
org/jruby/RubyBasicObject.java:1757:in `instance_exec'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/initializable.rb:30:in `run'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/initializable.rb:55:in `run_initializers'
org/jruby/RubyArray.java:1615:in `each'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/initializable.rb:54:in `run_initializers'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/application.rb:136:in `initialize!'
org/jruby/RubyBasicObject.java:1698:in `__send__'
org/jruby/RubyKernel.java:2097:in `send'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'
/Users/aaronmcleod/Documents/rails/rails3inaction/ticketee/config/environment.rb:5:in `(root)'
org/jruby/RubyKernel.java:1042:in `require'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'
/Users/aaronmcleod/Documents/rails/rails3inaction/ticketee/config/environment.rb:103:in `require_environment!'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/railties-3.2.0/lib/rails/application.rb:292:in `initialize_tasks'
org/jruby/RubyProc.java:258:in `call'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
org/jruby/RubyArray.java:1615:in `each'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
/Users/aaronmcleod/.rvm/rubies/jruby-1.6.7/lib/ruby/1.9/monitor.rb:201:in `mon_synchronize'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `invoke_prerequisites'
org/jruby/RubyArray.java:1615:in `each'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `invoke_with_call_chain'
/Users/aaronmcleod/.rvm/rubies/jruby-1.6.7/lib/ruby/1.9/monitor.rb:201:in `mon_synchronize'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
org/jruby/RubyArray.java:1615:in `each'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/aaronmcleod/.rvm/gems/jruby-1.6.7/gems/rake-0.9.2.2/bin/rake:33:in `(root)'
org/jruby/RubyKernel.java:1068:in `load'
/Users/aaronmcleod/.rvm/rubies/jruby-1.6.7/bin/rake:19:in `(root)'
Tasks: TOP => db:migrate => environment 
```

我能跑得`jruby --1.9 -S rake db:create`很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T12:53:49.997

跑

```
bundle exec rake db:migrate 
```

代替

```
rake db:migrate 
```

# histogram - 如何设置弹性搜索直方图中的间隔数

> ID：10610797
> 
> 赞同：4
> 
> 时间：2012-05-16T01:11:00.690
> 
> 标签：histogram, elasticsearch, faceted-search, facet

使用弹性搜索，我想在我的模型中获得价格字段的直方图方面。在事先不知道最低和最高价格的情况下，我想要的是让直方图覆盖整个价格范围，间隔一定数量，比如 10。我可以从文档中看到

[http://www.elasticsearch.org/guide/reference/api/search/facets/histogram-facet.html](http://www.elasticsearch.org/guide/reference/api/search/facets/histogram-facet.html)

我可以为每个间隔指定价格范围，但这会给我一些未指定数量的间隔。我希望有一些特定数量的间隔，它们均匀地覆盖价格字段的整个值范围。有没有办法做到这一点？

我知道一种解决方案可能是查询我的数据库的最小值和最大值，然后找出适当的间隔大小，但这违背了使用弹性搜索的要点之一，即不必为搜索相关查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:19:14.443

[您可以使用Statistical Facet](http://www.elasticsearch.org/guide/reference/api/search/facets/statistical-facet.html)查询 elasticsearch 的最小值和最大值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-28T20:42:53.133

`auto_histogram`您可以在[https://github.com/elastic/elasticsearch/issues/31828](https://github.com/elastic/elasticsearch/issues/31828)跟踪此功能的实施进度，称为

# codeigniter - CodeIgniter：URI 段中的 urlencoded URL 不起作用

> ID：10610799
> 
> 赞同：1
> 
> 时间：2012-05-16T01:11:22.693
> 
> 标签：codeigniter, codeigniter-2

我正在尝试将 URL 作为 CI 中我的一个 URI 段的值。我的控制器方法被定义为接受这样的参数。但是，当我转到 URL 时，我收到 404 错误。例如：

www.domain.com/foo/urlencoded-url/

有什么想法有什么问题吗？我应该通过 GET 来代替吗？

**更新：**

// 生成 404 的 URL `http://localhost/myapp/profile_manager/confirm_profile_parent_delete/ugpp_533333338/http%3A%2F%2Flocalhost%2Fmyapp%2Fdashboard%2F`

// 这是在我的`profile_manager`控制器中 public function confirm_profile_parent_delete($encrypted_user_group_profile_parent_id = '', $url_current = '')

如果我删除第二个 URI 段，我不会得到 404：`http://localhost/myapp/profile_manager/confirm_profile_parent_delete/ugpp_533333338/`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T05:11:15.167

似乎 %2F 破坏了 apache。

可能的解决方案：

1.  preg_replace /'s 到 -'s （或其他东西），然后再发送 url 然后将其切换回另一端。
2.  将 apache 设置为 AllowEncodedSlashes On
3.  有点 hack，但您甚至可以将 url 保存到会话变量或其他东西，而不是通过 url *shrug * 发送
4.  发送前双 url 编码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-16T14:42:05.847

在段中传递 urlendode() 的 URL，然后使用自己的 (MY_*) 类对其进行解码：

应用程序/核心/MY_URI.php：

```
class MY_URI extends CI_URI {

    function _filter_uri($str)
    {
        return rawurldecode(parent::_filter_uri($str));
    }
}

// EOF 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T06:05:20.717

您可能需要更改 config/route.php 中的规则以接受 URL 中的编码字符。您还可以从以下文章中查看一些解决方案：

*   [http://codeigniter.com/forums/viewthread/81365/](http://codeigniter.com/forums/viewthread/81365/)
*   [http://sholsinger.com/archive/2009/04/passing-email-addresses-in-urls-with-codeigniter/](http://sholsinger.com/archive/2009/04/passing-email-addresses-in-urls-with-codeigniter/)
*   [在 Codeigniter URL 段中传递 URL](https://stackoverflow.com/questions/9848794/passing-url-in-codeigniter-url-segment)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T01:46:30.627

我实际上不得不做 urlencode(urlencode(urlencode(

和 urldecode(urldecode(urldecode(

3次！！它终于奏效了，两次没有削减它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-06T17:35:06.137

尝试

```
function __autoload($class){
 if(!empty($_SERVER['REQUEST_URI'])){
  $_SERVER['REQUEST_URI'] = $_SERVER['REDIRECT_QUERY_STRING'] = $_SERVER['QUERY_STRING'] = $_SERVER['REDIRECT_URL'] = $_SERVER['argv'][0]  = urldecode($_SERVER['REQUEST_URI']); 
}
} 
```

在 config.php 这个方法对我有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-18T05:17:32.113

这已经很老了，但我想我会分享我的解决方案。

不要接受参数作为 url 路径，而是接受它作为 get 变量：

```
http://localhost/myapp/profile_manager/confirm_profile_parent_delete/ugpp_533333338?url_current=http%3A%2F%2Flocalhost%2Fmyapp%2Fdashboard%2F 
```

在代码中：

```
function confirm_profile_parent_delete($encrypted_user_group_profile_parent_id = '') {
    $url_current = $this->input->get('url_current');
    ... 
```

这似乎有效。

# jquery - 隐藏所有列表项时隐藏整个列表

> ID：10610800
> 
> 赞同：2
> 
> 时间：2012-05-16T01:11:23.060
> 
> 标签：jquery, list, hide

我有一个带导航的照片库。当您在导航中选择“照片”时，它会隐藏视频。当您单击“视频”时，它会隐藏照片。

在某些情况下，没有视频，我希望自动隐藏那些空行。

唯一的问题是，我不确定如何*仅*针对空行。

**这是我的 HTML，其中一行没有视频：**

```
<div id="right">
    <ul>
        <li id="gallery-all">All</li>
        <li id="gallery-photos">Photos</li>
        <li id="gallery-videos">Videos</li>
        <div class="clear"></div>
    </ul>
</div>
<div class="gallery-content" id="2012_national">
    <ul class="row">
        <li class="gallery-photo">
            <a class="group" title="" rel="" href="images/IMG_0672.jpg"><img src="files/photo.jpg" alt="" /></a>
            <p>Caption goes here</p>
        </li>
        <li class="gallery-photo">
            <a class="group" title="" rel="" href="images/IMG_1474.jpg"><img src="files/video.jpg" alt="" /></a>
            <p>Caption goes here</p>
        </li>
        <li class="gallery-photo">
            <a class="group" title="" rel="" href="images/IMG_1724.jpg"><img src="files/photo.jpg" alt="" /></a>
            <p>Caption goes here</p>
        </li>
        <li class="gallery-photo">
            <a class="group" title="" rel="" href="images/IMG_1725.jpg"><img src="files/video.jpg" alt="" /></a>
            <p>Caption goes here</p>
        </li>
        <div class="clear"></div>
    </ul>
</div> 
```

**到目前为止，这是我的 jQuery：**

```
//Hide empty rows
if($('.row').children(':visible').length == 0) {
    $('.row').hide();
}; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:45:13.493

`.row`您可以通过简单地在用于设置列表本身显示的匿名函数中检查其可见子列表项的长度来隐藏/显示所有列表：

```
$(".row").css("display", function(){
  return $("li:visible", this).length ? "block" : "none" ;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:21:53.883

```
// iterate over each child of row
$('.row').children().each( function()
{
    // checks the text of each li
    if ( $(this).text() == "" )
    {
        // hides the li
        $(this).hide();
    }
});
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T01:38:14.017

用于隐藏行：

```
jQuery('.gallery-content .row').each(function(i, row) {
    if(jQuery('li', row).length == 0) {
        jQuery(row).hide();
    }
}); 
```

如果你想从导航中隐藏它，你可以在下面的代码之后使用以下内容：

```
if(jQuery('.gallery-content .row:visible').length == 0) {
    jQuery('#right li#gallery-videos').hide();
} else {
    jQuery('#right li#gallery-videos').show();
} 
```

# python - PySide + SQLAlchemy 中 QTableView 的“模型”设计

> ID：10610804
> 
> 赞同：7
> 
> 时间：2012-05-16T01:11:53.377
> 
> 标签：python, sql, sqlalchemy, pyside

我的问题实际上是如何设置可以从 PySide 的 QTableView 类访问的 SQLAlchemy 声明性模型。

[我只是想从本质上实现对象关系教程](https://docs.sqlalchemy.org/en/latest/orm/tutorial.html)的前端

不幸的是，我有几点困惑。我会试着解释我在哪里。

我遵循了 SQLAlchemy 教程，直到我有两个相关的表，并且可以毫无问题地操作/查询这些表。尝试建立[QTableView 类](http://www.pyside.org/docs/pyside/PySide/QtGui/QTableView.html)显然需要使用我自己的模型的[setData() 方法](http://www.pyside.org/docs/pyside/PySide/QtCore/QAbstractItemModel.html#PySide.QtCore.PySide.QtCore.QAbstractItemModel.setData)，或者使用默认模型需要[setItem() 方法](http://www.pyside.org/docs/pyside/PySide/QtGui/QTableWidgetItem.html#PySide.QtGui.QTableWidgetItem)。

所以问题是如何设计模型。我认为这意味着定义这两种方法之一来查询/修改数据库。我不知道这样做的正确方法。

该模型应该像 User firstname 和 lastname 在几行上重复，直到显示所有地址，然后转到下一个 User。我可以使用嵌套的 for 循环来执行此操作，以便在提示符下打印此内容，但我不认为制作一个大列表是要走的路，因为这似乎违背了首先拥有数据库的意义......

我也不知道当数据库增长时会发生什么，整个表会被实例化并保存在内存中，还是 Qt 在用户滚动时加载行和列以查看它们？

很多文字在这里很抱歉，但试图清楚。如果有任何其他我可以添加的内容，请告诉我。或者，如果我完全走错了路......

```
from PySide import QtCore, QtGui
from sqlalchemy import Column, Integer, String, Text, Sequence, ForeignKey, Date, Boolean, create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker, relationship, backref, aliased
import datetime

engine = create_engine('sqlite:///reminder.db')

Base = declarative_base()

class User(Base):
    __tablename__ = 'users_db'
    id = Column(Integer, Sequence('user_id_seq'), primary_key=True)
    lastname = Column(String)
    firstname = Column(String)
    contact = Column(String)
    history = Column(Text)
    notes = Column(Text)

    addresses = relationship('Address', order_by='Address.id', 
                               backref='user', cascade='all, delete, delete-orphan')

    def __init__(self, firstname, lastname, contact):
        self.firstname = firstname
        self.lastname = lastname
        self.contact = contact

    def __repr__(self):
        return "<User('{0}', '{1}', '{2}')>".format(self.firstname, self.lastname, self.contact)

class Address(Base):
    __tablename__ = 'addresses_db'
    id = Column(Integer, primary_key=True)
    address = Column(String(150))
    date = Column(Date)
    check1 = Column(Boolean)
    check2 = Column(Boolean)

    user_id = Column(Integer, ForeignKey('users_db.id'))

    def __init__(self, address, date):
        self.address = address
        self.date = date
        self.check1 = False
        self.check2 = False

    def __repr__(self):
        return "<Address('{0}', '{1}')>".format(self.address, self.date)

if __name__ == '__main__':
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)
    session = Session()
    header = [User.firstname, User.lastname, nextaddressfromUser]

>>> for user in session.query(User).all():
...     for addr in user.addresses:
...         print user.firstname, user.lastname, addr.address 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T09:24:01.703

首先，让我们忘记查询，并使用您正在使用的循环。您在 UI 中寻找的是基本的东西。我从缺乏文档中发现，对于基本的事情，最好使用比 QWhateverView 更好的[QTableWidget](http://www.pyside.org/docs/pyside/PySide/QtGui/QTableWidget.html)（或任何东西）。`QWhateverWidget`您不需要为简单的事情定义自己的模型。因此，我将向您展示如何使用 QTableWidget 来做到这一点。您需要为（行，列）的每个单元格创建一个 QTableWidgetItem。我遇到的一个问题是在添加它们之前必须设置行数。无论如何，这里：

```
import sys
from PySide import QtGui, QtCore

class Test(QtGui.QWidget):

    def __init__(self, rows):
        super(Test, self).__init__()

        self.table = QtGui.QTableWidget()
        self.table.setColumnCount(3)
        # Optional, set the labels that show on top
        self.table.setHorizontalHeaderLabels(("First Name", "Last Name", "Address"))

        self.table.setRowCount(len(rows))
        for row, cols in enumerate(rows):
            for col, text in enumerate(cols):
                table_item = QtGui.QTableWidgetItem(text)
                # Optional, but very useful.
                table_item.setData(QtCore.Qt.UserRole+1, user)
                self.table.setItem(row, col, table_item)

        # Also optional. Will fit the cells to its contents.
        self.table.resizeColumnsToContents()

        # Just display the table here.
        layout = QtGui.QHBoxLayout()
        layout.addWidget(self.table)
        self.setLayout(layout)

if __name__ == "__main__":
    # ...
    rows = []
    # Here I have to fill it in an array, because you need to know the number of rows before adding... There might be a better solution though.
    for user in session.query(User).all():
        for addr in user.addresses:
            # These are the columns on each row (firstname, lastname, address)
            rows.append((user.firstname, user.lastname, addr.address))

    app = QtGui.QApplication(sys.argv)
    test = Test(rows)
    test.show()
    app.exec_() 
```

您可能会考虑使用的另一件事是[QTreeWidget](http://www.pyside.org/docs/pyside/PySide/QtGui/QTreeWidget.html)，它支持多列，您可以让它看起来像一个表格，但默认情况下没有可编辑的单元格，它可能更适合您的数据。

现在对于查询，您可能希望将其设为一个查询，以避免循环遍历结果并且必须为每个用户进行一个额外的查询。就像是：

```
query = session.query(User.firstname, User.lastname, Address.address).filter(Address.user_id == User.id)
    for row in query.all():
        # firstname, lastname, address = row
        rows.append(row) 
```

对于很多行，我认为有一个解决方案，但是您需要定义自己的模型并`LIMIT`在查询中使用 s 。由于缺乏文档和教程，这并不容易......

附带说明一下，您不需要`__init__`在 Address 和 User 类上定义方法，因为您没有做任何特别的事情，SQLAlchemy 可以自动为您完成。您可以直接在 Column 定义中定义默认值。

**更新**：对于使用[QTableWidgetItem.setData](http://www.pyside.org/docs/pyside/PySide/QtGui/QTableWidgetItem.html#PySide.QtGui.PySide.QtGui.QTableWidgetItem.setData)的示例，假设我们要在双击时删除用户。我们将使用[itemDoubleClicked](http://www.pyside.org/docs/pyside/PySide/QtGui/QTableWidget.html#PySide.QtGui.PySide.QtGui.QTableWidget.itemDoubleClicked)信号。

```
# in the __init__ function
self.table.itemDoubleClicked.connect(self.onItemDoubleClick)

# in onItemDoubleClicked function
def onItemDoubleClicked(self, item):
    # Every data has a role, you can specify your own (it's an integer) as long as it's greater than UserRole. Others are used internally, like DisplayRole and some others you can find in the QtCore package.
    # You can use data with other widgets also, not just TableWidgets.
    user = item.data(QtCore.Qt.UserRole+1)
    # you get a session however you want, then delete the user. This object is the same as the one you passed earlier when creating the item, it can be whatever you like.
    session.delete(user)
    session.commit() 
```

# gmail - 如何让 gmail 小工具更改消息标签？

> ID：10610805
> 
> 赞同：0
> 
> 时间：2012-05-16T01:11:57.137
> 
> 标签：gmail, google-apps-script, interaction, google-gadget

我经常使用两个gmail标签`label1`和`label2`，并且根据我个人的邮件管理规则，我经常将邮件类别从 更改`label1`为`label2`。
因为我经常这样做，我想我应该尝试通过添加自定义 gmail 命令来自动化这个过程。
以下是我的迷你功能的规格：

1）当在 gmail 中选择了一个带有标签的消息（根据 gmail api，一个[“线程”](https://developers.google.com/apps-script/class_gmailthread)`label1` ）时，我的 gmail 界面中应该会显示一个按钮“CHANGE LABEL1 TO LABEL2”
2）当我点击这个按钮时，`label1`应该删除选定的消息, 同时`label2`会添加一个标签

这就是功能。
从技术上讲，这是我认为需要的：

a) 获取和设置附加到给定消息线程的标签（由 id 标识）
的方法 b) 有条件地显示按钮
的方法 c) 单击按钮时触发脚本的
方法 d) 检测的方法所选消息线程 的[id](https://developers.google.com/apps-script/class_gmailthread#getId)

以下是我认为可用于每个部分的技术解决方案：

a) ...可以通过[Google Apps Script](https://developers.google.com/apps-script/)使用[GmailThread::addLabel](https://developers.google.com/apps-script/class_gmailthread#addLabel)和[GmailThread::removeLabel](https://developers.google.com/apps-script/class_gmailthread#removeLabel)
b) ...似乎可以通过[上下文小工具](https://developers.google.com/google-apps/gmail/contextual_gadgets#what_is_a_gmail_contextual_gadget)
c) ...是我的第一个问题，因为单击按钮b) 应该从 a) 启动脚本此外，对 a) 脚本的调用应该将消息线程 ID 作为参数传递。
d) ...是我的第二个问题，也许它也可以通过[上下文小工具](https://developers.google.com/google-apps/gmail/contextual_gadgets#what_is_a_gmail_contextual_gadget)，因为它们可以解析消息的内容？

考虑到谷歌为脚本提供的实际技术，是否有可能实现这个迷你功能？
更准确地说，是否可以让 Gmail 小工具和[Gmail 应用脚本](https://developers.google.com/apps-script/service_gmail)交互？
还是有一些替代方案来实现它？

附加信息：我试图调查谷歌提供的其他技术来定制其产品，但似乎[Gmail Labs API 不向公众开放](https://stackoverflow.com/questions/9985378/is-gmail-lab-api-open)。另外，我认为我不能使用[Gmail 侧边栏小工具](https://developers.google.com/google-apps/gmail/sidebar_gadgets)，因为他们似乎无法知道当前在 gmail 界面中选择了哪条消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T06:54:29.327

我不知道您是否可以通过这种方式使用上下文小工具，但您可以编写一个简单的脚本（时间触发），搜索带有您使用的第三个标签（或其中一个星号）的线程，作为您的意愿指标切换标签...

该脚本搜索您标记的线程并切换标签（而不是删除标记）......非常简单......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:50:49.807

我现在使用上下文小工具做类似的事情。我知道更改标签的唯一方法是通过 IMAP。我的小工具将电子邮件的详细信息传递到我的服务器，该服务器使用 IMAP 连接到电子邮件并更改其标签。尽管这似乎是一种冗长的方式，但我认为这是您唯一的选择。

# actionscript-3 - Flash builder Mobile AS3 项目：屏幕 DPI、应用程序 DPI、图像 DPI、中心图像

> ID：10610807
> 
> 赞同：1
> 
> 时间：2012-05-16T01:12:38.713
> 
> 标签：actionscript-3, mobile, air, screen, resolution

我在 AS3 中编写了一个 Flash Builder 项目。它使用一些图像来告诉用户它正忙于某事。

首先，我想对这些图像使用 SVG 文件格式，以使其尽可能清晰。但它不起作用，形状错误或位置不正确。

所以我决定使用PNG格式。它运行良好，除了一件事：由编译器完成的 DPI 翻译。我无法将图像居中，因为 DPI 大小会重新计算为屏幕 DPI 的大小，并且在设备上可能会有所不同。这对我来说非常复杂，因为我只想使图像居中。

图像有 96DPI，Capabilities 对象返回的 screenDPI 为 165。因为当 DPI 改变时宽度和高度不会改变（对象返回相同的宽度和高度），我看不到图像的实际大小（以像素为单位）用户看到）。

在此示例中，位图的视觉尺寸增加并且不适合屏幕。这使得在项目中使用图像变得非常复杂。

Adobe 网站上的文档通知有关位图 DPI。并且屏幕DPI可能会被操作系统报告错误。唯一的解决方案是为每个具有不同 DPI 的设备添加与屏幕 dpi 匹配的图像。哇，这是非常复杂的东西，你可以在这里阅读：http: [//help.adobe.com/en_US/flex/mobileapps/WS19f279b149e7481c682e5a9412cf5976c17-8000.html](http://help.adobe.com/en_US/flex/mobileapps/WS19f279b149e7481c682e5a9412cf5976c17-8000.html)

在 flex 中，您可以设置目标 DPI（应用程序 DPI），但我如何在 AS3 项目中执行此操作？您不能在运行时更改它，所以我该怎么做？在 XML 文件中，我没有找到关于应用程序的选项，它是初始 DPI。

图像是 96 DPI，所以当我将应用程序的 DPI 设置为 96 时，我认为它会显示正常吗？但是我该怎么做呢？

其他解决方案也非常受欢迎。

感谢您的宝贵时间，如果您有任何问题，请告诉我。

# css - 字体在mac上不工作，但在pc上工作正常

> ID：10610815
> 
> 赞同：0
> 
> 时间：2012-05-16T01:13:52.487
> 
> 标签：css, fonts, font-face

出于某种原因，一种特定字体在 mac 上不起作用：/

```
@font-face {
    font-family: 'Kipling Light';
    src: url('fonts/KiplingLight-Regular.eot');
   src: local("☺"),
         url('fonts/KiplingLight-Regular.ttf') format('truetype'),
         url('fonts/KiplingLight-Regular.woff') format('woff'),
         url('fonts/KiplingLight-Regular.otf') format('opentype');

}
@font-face {
font-family: 'HelveticaNeue';
src: url('fonts/HelveticaNeueCE-Roman.eot');
src: local("☺"),
    url('fonts/helvetica_neue_ce_55_roman-webfont.ttf') format('truetype'),
     url('fonts/HelveticaNeueCE-Roman.woff') format('woff'),
     url('fonts/HelveticaNeueCE-Roman.otf') format('opentype');

} 
```

那是我的css代码，我像这样插入我的数据：

```
.contenidored{
    font-family: 'HelveticaNeue';
    font-size:14px;
    color:#8C8B8C;
} 
```

Helvetica 是一个不工作的，你有什么想法吗？ [http://remedia-solutions.com/clientes/0039_kiplingmexico/demo2/](http://remedia-solutions.com/clientes/0039_kiplingmexico/demo2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:53:56.883

这会很奇怪，但我只是改变了排版并且它起作用了。也许存档有问题。

# java - PKI - 读卡器更换

> ID：10610818
> 
> 赞同：0
> 
> 时间：2012-05-16T01:14:08.193
> 
> 标签：java, ssl, pki

我们正在开发一个新的安全项目。我们希望同时启用服务器端和客户端身份验证。为了允许客户端身份验证，我们希望创建可以放入“读卡器”并使用指纹解锁的卡片。

现在，目前我们有几个 A 公司的读卡器，为了让我们的客户端（java - 不是浏览器，而是我们自己的一个小软件）使用该卡上的证书，java 程序使用对dll 允许我们连接到它。

我正在寻找一种方法来使这种与读卡器的连接通用，以防我们将读卡器更改为 B 公司。

**我的问题是：**

1.  有没有更好的方法来访问证书的读卡器？例如，使用纯 java 代码（或纯 JDK 代码）并仍然以某种方式检索证书和所需的所有其他操作。

2.  鉴于没有纯 Java 方法可以做到这一点，是否有一种通用方法可以帮助我不依赖特定的 .dll？

3.  你认为这有多安全？也许，在没有读卡器的情况下进行客户端身份验证是否有同样安全的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:42:58.163

Oracle JRE 附带[Sun PKCS#11 提供程序](http://docs.oracle.com/javase/7/docs/technotes/guides/security/p11guide.html)，它允许您插入实现 PKCS#11 API 的 DLL。

就 Java 而言，这绝对是“标准”方式。您的智能卡可以作为`KeyStore`实例加载。如果您的密钥无法从智能卡中提取，`PrivateKey`则仍将创建 a 对象以在您的应用程序签名/解密中使用，但您将无法提取私有指数（假设此处为 RSA）：它将操作委托给卡，按设计。

（我过去曾在 Linux 机器上使用 OpenSC/OpenCT 成功尝试过。我相信 PKCS#11 在 Windows 中更为罕见，但一些智能卡提供商可能仍会为其提供接口。）

这有多安全取决于您使用的 PKCS#11 实现。调整您自己的 DLL 以使其适合 PKCS#11 肯定需要一些努力和审查，然后才能称其为“安全”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T17:18:57.040

一种选择是位于读卡器设备驱动程序和 Java 应用程序之间的中间件。这样，您的应用程序仅与中间件库交互，您无需关心直接访问 DLL 或您正在使用的硬件类型，甚至是 sun PKCS11 提供程序。如果安装了新的读卡器，中间件将与驱动器交互。您可以访问您的证书，但如果生物特征数据（指纹）存储在智能卡上（而不是在您的服务器上），中间件可以帮助访问它。制造这种中间件的公司之一是 Active Identity。

# android - 从 Android 中的另一个 Integer[] 数组创建一个随机的 Integer[] 图像数组

> ID：10610819
> 
> 赞同：1
> 
> 时间：2012-05-16T01:14:09.233
> 
> 标签：android, arrays, random, integer, items

我正在创建一个在 GridView 中显示 9 个图像的活动。我希望从包含 26 个图像的 Integer[] 数组中随机选择这些图像。所以我最好的方法是固定 26 个图像，然后创建一个新数组并使用这个简单的方法填充：

> ```
>  public Integer [] allLetters = {
>              R.drawable.a, R.drawable.b,
>              R.drawable.c, R.drawable.d,
>              R.drawable.e, R.drawable.f,
>              R.drawable.g, R.drawable.h,
>              R.drawable.i, R.drawable.j,
>              R.drawable.k, R.drawable.l,
>              R.drawable.m, R.drawable.m,
>              R.drawable.o, R.drawable.p,
>              R.drawable.q, R.drawable.r,
>              R.drawable.s, R.drawable.t,
>              R.drawable.u, R.drawable.v,
>              R.drawable.w, R.drawable.x,
>              R.drawable.y, R.drawable.z
>     };
>     private Integer[] randomLetters=null;
>     public int index=0;
>     public Random r= new Random();
>     public void creaArray() {
>         for (int i = 0; i < 9; i++){
>             index=r.nextInt(26);
>             randomLetters[i]=allLetters[index];
>         }
>     } 
> ```

我认为这会用来自 allLetters 的 9 个随机值填充 randomLetters，但应用程序是“强制关闭”我 :( 有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:21:20.400

它崩溃是因为您尚未初始化整数数组。你必须这样做：

```
private Integer[] randomLetters = new Integer[9]; 
```

请记住，您当前的算法可能会重复某些字母，这有时是一种不良行为。

另外，准备好如何使用`adb logcat`以检测此类问题。您将为您和我们节省很多时间。

# web-services - Apache camel 聚合多个 REST 服务响应

> ID：10610820
> 
> 赞同：8
> 
> 时间：2012-05-16T01:14:10.157
> 
> 标签：web-services, rest, apache-camel, esb, aggregation

我是 Camel 的新手，想知道如何使用 Camel 实现下面提到的用例，

我们有一个 REST Web 服务，假设它有两个服务操作 callA 和 callB。现在我们在前面有 ESB 层，它在访问这个实际的 Web 服务 URL 之前拦截客户端请求。

现在我正在尝试做这样的事情 - 在 ESB 中公开一个客户端将实际调用的 URL。在 ESB 中，我们使用 Camel 的 Jetty 组件，它只是代理此服务调用。所以假设这个 URL 是 /my-service/scan/

现在在收到此请求@ESB 时，我想调用这两个 REST 端点（callA 和 callB）-> 获取它们的响应 - resA 和 resB -> 将其聚合到单个响应对象 resScan -> 返回到客户端。

我现在只有——

```
<route id="MyServiceScanRoute">
<from uri="jetty:http://{host}.{port}./my-service/scan/?matchOnUriPrefix=true&amp;bridgeEndpoint=true"/>
<!-- Set service specific headers, monitoring etc. -->  
<!-- Call performScan -->
<to uri="direct:performScan"/>
</route>

<route id="SubRoute_performScan">
<from uri="direct:performScan"/>
<!--  HOW DO I??
Make callA, callB service calls. 
Get their responses resA, resB.
Aggregate these responses to resScan
 -->
</route> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T12:56:42.383

我认为您不必要地使解决方案复杂化了一点。:) 在我看来，调用两个**独立**的远程 Web 服务并连接结果的最佳方法是：

*   使用[多播](http://camel.apache.org/multicast.html)**并行**调用服务
*   使用[GroupedExchangeAggregationStrategy聚合结果](http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/processor/aggregate/GroupedExchangeAggregationStrategy.html)

上述解决方案的路由可能如下所示：

```
from("direct:serviceFacade")
  .multicast(new GroupedExchangeAggregationStrategy()).parallelProcessing()
    .enrich("http://google.com?q=Foo").enrich("http://google.com?q=Bar")
  .end(); 
```

传递给的 Exchange`direct:serviceFacadeResponse`将包含`Exchange.GROUPED_EXCHANGE`设置为调用您的服务的结果列表的属性（在我的示例中为 Google 搜索）。

这就是你如何连接`direct:serviceFacade`到 Jetty 端点：

```
from("jetty:http://0.0.0.0:8080/myapp/myComplexService").enrich("direct:serviceFacade").setBody(property(Exchange.GROUPED_EXCHANGE)); 
```

现在，您在 ESB 上使用 Jetty 组件公开的对服务 URL 的所有 HTTP 请求都将生成从对子服务的两个调用连接起来的响应。

**关于消息和端点的动态部分的进一步考虑**

在许多情况下，在端点中使用静态 URL 不足以满足您的需求。您可能还需要准备有效负载，然后再将其传递给每个 Web 服务。

一般来说 - 用于实现动态端点或有效负载参数的路由类型高度依赖于您用于使用 Web 服务的组件（[HTTP](http://camel.apache.org/http.html)、[CXFRS](http://camel.apache.org/cxfrs.html)、[Restlet](http://camel.apache.org/restlet.html)、RSS 等）。每个组件的程度和您可以动态配置它的方式各不相同。

如果您的端点/有效负载应该受到动态影响，您还可以考虑以下选项：

**使用`onPrepareRef`多播端点的选项对**传递给每个端点的交换副本进行预处理。**您可以使用它来引用自定义处理器，该处理器将在将有效负载传递到多播端点之前对其进行修改。这可能是使用 HTTP 组件的 Exchange.HTTP_URI 标头组合 onPrepareRef 的好方法。**

 ****使用[收件人列表](http://camel.apache.org/recipient-list.html)**（也`parallelProcessing`像多播一样提供）来动态创建 REST 端点 URL。

**使用拆分[器](http://camel.apache.org/splitter.html)模式**（`parallelProcessing`启用）将请求拆分为专用于每个服务的较小消息。再次，此选项可以很好地与`Exchange.HTTP_URI`HTTP 组件的标头一起使用。仅当可以使用相同的端点类型定义两个子服务时，这才有效。

如您所见，Camel 非常灵活，可让您以多种方式实现目标。考虑您的问题的背景并选择最适合您的解决方案。

如果您向我展示您希望在对聚合服务的每个请求上调用的 REST URL 的更具体示例，我可以建议您选择哪种解决方案以及如何实现它。特别重要的是要知道请求的哪一部分是动态的。我还需要知道您要使用哪个服务使用者（这取决于您将从服务接收到的数据类型）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T09:09:09.397

这看起来是一个很好的例子，应该使用 Content Enricher 模式。[在这里描述](http://camel.apache.org/content-enricher.html)

```
<from uri="direct:performScan"/>
   <enrich uri="ServiceA_Uri_Here" strategyRef="aggregateRequestAndA"/>
   <enrich uri="ServiceA_Uri_Here" strategyRef="aggregateAandB"/>
</route> 
```

聚合策略必须用 Java 编写（或者可能是某种脚本语言，Scala/groovy？ - 但我没有尝试过）。

聚合策略只需要一个实现 org.apache.camel.processor.aggregate.AggregationStrategy 的 bean，这反过来又需要您实现一个方法：

```
Exchange aggregate(Exchange oldExchange, Exchange newExchange); 
```

因此，现在由您将请求与来自丰富服务调用的响应合并。你必须做两次，因为你有 callA 和 callB。有两种预定义的聚合策略可能有用也可能没用，UseLatestAggregationStrategy 和 UseOriginalAggregationStrategy。这些名称是非常自我解释的。

祝你好运**

# javascript - 用于翻转和转出的 SVG 功能

> ID：10610823
> 
> 赞同：1
> 
> 时间：2012-05-16T01:14:35.650
> 
> 标签：javascript, svg

我正在玩 SVG 和翻转功能，我动态地创建了一个 SVG 文本和一个网站链接。当鼠标悬停在“Hello World”上时，文本变为“单击以转到 SVGOpen”并带有链接。然后当鼠标离开文本时调用 rollOut 函数。“Click to go to SVGOpen”改回“Hello World”。问题是，当我翻车时，“Hello World”并没有消失，“点击转到 SVGOpen”与它重叠。然后，当我推出时，“单击以转到 SVGOpen”并没有消失。我错过了什么？这是我的示例代码

```
<?xml version="1.0" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.1" baseProfile="full" width="100%" height="100%" onload="init();">

 <script type="text/javascript">
 <![CDATA[
    var xlinkns = "http://www.w3.org/1999/xlink";
    var svgns="http://www.w3.org/2000/svg";

        function init(){
            var image=document.createElementNS(svgns, 'image');
            image.setAttributeNS(null, 'x', '75px');
            image.setAttributeNS(null, 'y', '125px');
            image.setAttributeNS(null, 'height', '200px');
            image.setAttributeNS(null, 'width', '850px');
            image.setAttributeNS(xlinkns, 'xlink:href', 'svgOpen.png');

            document.getElementsByTagName('svg')[0].appendChild(image);
        }

        /* 
        All in this part must happen/be assigned when the document is loaded:
        create an image element that has
            -a x value of 75px
            -a y value of 125px
            -a height of 200px
            -a width of 850px
            -shows the svgOpen.png

        Alter the title text you created in part 1 below so that:
            -is embedded inside of an 'a' tag (dynamically created <a> of course!)
            -when the title text is clicked, the <a> takes you to http://www.w3.org/Graphics/SVG/ 
                    (using the <a> tag - do NOT try to go to the other page via JavaScript)
            -when the title is moused over the text changes to "Click to go to SVGOpen"
            -when the title is moused out the text changes back to "Your Names Practice"

    */

        function rollOver(){

            link=document.createElementNS(svgns, 'a');
            link.setAttributeNS(null,'target','_blank');
            link.setAttributeNS(xlinkns, 'xlink:href', 'http://www.w3.org/Graphics/SVG/');

            var tEle=document.createElementNS(svgns,'text');
            tEle.setAttributeNS(null,'id','clicky');
            tEle.setAttributeNS(null,'x','150px');
            tEle.setAttributeNS(null,'y','75px');
            tEle.setAttributeNS(null,'fill','#999966');
            tEle.setAttributeNS(null,'font-size','48px');

            link.appendChild(document.createTextNode('Click to go to SVGOpen'));
            tEle.appendChild(link);

            document.getElementsByTagName('svg')[0].appendChild(tEle);

        }
        function rollOut()
        {

            var tEle=document.createElementNS(svgns,'rollOver()');

            link.appendChild(document.createTextNode('this.parentNode.parentNode.removeChild(this.parentNode)'));
            tEle.appendChild(link);
            document.getElementsByTagName('svg')[0].appendChild(tEle);
        }   
    /*
        Extra Fun:  (be sure you are done with all else before you try this!)
            When I click on the dynamically created image above, dynamically create an ellipse
            that animates...
            ellipse: cx random value between 0 and 100%
                     cy random value between 0 and 100%
                     rx random value between 50 and 140
                     ry random value between 30 and 40
                     stroke width random value between 1 and 8
                     fill #ccffff
                     stroke #663399
            animate: 1 to 0 opacity
                     duration random value between 1 and 6
                     when 0 is reached, remove the ellipse
                     animate begins on the creation

    */
    /*
        function imageClick()
        {
            var ellipse = document.createElementNS(svgns, "ellipse");
            ellipse.setAttributeNS(null,"cx","Math.floor(Math.random() * 100)";
            ellipse.setAttributeNS(null,"cy","Math.floor(Math.random() * 100)";
            ellipse.setAttributeNS(null,"rx","Math.floor(Math.random() * 91) + 50";
            ellipse.setAttributeNS(null,"ry","Math.floor(Math.random() * 11) + 30";
            ellipse.setAttributeNS(null,"fill","#ccffff");
            ellipse.setAttributeNS(null,"stroke","#663399");

            a.appendChild(ellipse);
            document.documentElement.appendChild(a);

        }
    */
    ]]>
 </script>

    <!-- 1) Everything below here is to be created as tags, NOT dynamically created...
    create a background that covers the WHOLE page (no matter how big) that is 
    #333366 -->
    <g>
            <rect width="100%" height="100%" style="fill: #333366; stroke: none;" />>       
    </g>

    <!-- create a title with your name's practical! - like (B's Practice!)
    at x of 150px, y of 75px, the color (#999966) and font size (48px)--> 

    <a>
        <text x="150px" y="75px" fill="#999966" font-size="48px" onmouseover="rollOver();" onmouseout="rollOut();">
            Hello World
        </text>
    </a>

    <!-- create a rect that has:
        x of 50px, y of 100px, width of 0, height of 0, fill of #ffffcc
        and rounded corners of 25px!

        Now, animate it so that the rect's
        -width grows to 80% over 2 seconds
        -height grows to 80% over 3 seconds
        -rotation rotates once around 1 second AFTER the height animate is done (MUST watch the 
        height's id to see when it is done, NOT by time).  It should take the rotation 1.5 seconds
        to complete

    -->
  <rect x="50px" y="100px" width="0px" height="0px" rx="25px" ry="25px" style="fill: #ffffcc; stroke: none;">
        <animateTransform attributeName="width" to="80%" dur="2s" fill="freeze"/>
        <animateTransform attributeName="height" to="80%" dur="3s" fill="freeze"/>
        <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="1.5s" begin="6s"/>
    </rect>

</svg> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:19:56.737

在您的`onmouseover`和`onmouseout`事件处理程序中，您只是将一个元素附加到您的文档 ( `appendChild`)。所以你所描述的并不奇怪，你没有做任何事情来删除前一个元素，所以它仍然显示。您还会继续添加，因此您的文档会随着鼠标移入和移出而不断增长。

`removeChild`您可以通过删除每个事件处理程序中的另一个元素（获取元素并调用方法）来解决此问题。

但或者，不是在鼠标事件发生时添加/删除元素，一种更简单的方法是将两个版本都包含在文档中，并使用 CSS 样式根据悬停状态显示/隐藏它们。

# python - Python：编写接受参数的装饰器的快捷方式？

> ID：10610824
> 
> 赞同：9
> 
> 时间：2012-05-16T01:14:37.600
> 
> 标签：python, decorator

Python 标准库是否有编写接受参数的装饰器的快捷方式？

例如，如果我想编写一个装饰器，例如`with_timeout(timeout)`：

```
@with_timeout(10.0)
def cook_eggs(eggs):
    while not eggs.are_done():
        eggs.cook() 
```

我必须写一些类似的东西：

```
def with_timeout(timeout):
    _func = [None]
    def with_timeout_helper(*args, **kwargs):
        with Timeout(timeout):
            return _func[0](*args, **kwargs)
    def with_timeout_return(f):
        return functools.wraps(f)(with_timeout_helper)
    return with_timeout_return 
```

但这非常冗长。是否有一种捷径可以让接受参数的装饰器更容易编写？

**注意**：我意识到也可以使用三个嵌套函数来实现带参数的装饰器……但这也有点不太理想。

例如，可能类似于`@decorator_with_arguments`函数：

```
@decorator_with_arguments
def timeout(f, timeout):
    @functools.wraps(f)
    def timeout_helper(*args, **kwargs):
        with Timeout(timeout):
            return f(*args, **kwargs)
    return timeout_helper 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T01:17:20.130

老实说，我倾向于把我的装饰器写成类

```
class TestWithArgs(object):
    def __init__(self, *deco_args, **deco_kwargs):
        self.deco_args = deco_args
        self.deco_kwargs = deco_kwargs
    def __call__(self, func):
        def _wrap(self, *args, **kwargs):
            print "Blah blah blah"
            return func(*args, **kwargs)
        return _wrap 
```

如果不是稍微清楚一点，它什么都没有

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T02:12:33.137

我知道你说它感觉不太理想，但我仍然觉得使用三个嵌套模型是最干净的解决方案。内部的两个函数只是为接受参数的函数定义装饰器的“正常”方式（参见python 文档中的@wraps 示例）[。](http://docs.python.org/library/functools.html#functools.wraps)外层实际上只是一个接受和参数并返回装饰器的函数。

```
def with_timeout(timeout):
    def decorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            with Timeout(timeout):
                return f(*args, **kwargs)
        return wrapper
    return decorator 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-16T03:34:44.520

根据 Jakob 的建议，我实现了一个`Decorator`小班，我觉得它做得相当不错：

```
class Decorator(object):
    def __call__(self, f):
        self.f = f
        return functools.wraps(f)(lambda *a, **kw: self.wrap(*a, **kw))

    def wrap(self, *args, **kwrags):
        raise NotImplemented("Subclasses of Decorator must implement 'wrap'")

class with_timeout(Decorator):
    def __init__(self, timeout):
        self.timeout = timeout

    def wrap(self, *args, **kwargs):
        with Timeout(timeout):
            return self.f(*args, **kwargs) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T15:51:45.410

另一种方法，不使用 lambda：

```
def decorator_with_arguments(f):
    @functools.wraps(f)
    def with_arguments_helper(*args, **kwargs):
        def decorator(g):
            return f(g, *args, **kwargs)
        return decorator
    return with_arguments_helper 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T03:43:06.540

首先，我们可以定义一个小的元装饰器：

```
def decorator_with_arguments(wrapper):
    return lambda *args, **kwargs: lambda func: wrapper(func, *args, **kwargs) 
```

这允许我们创建接受如下参数的装饰器：

```
@decorator_with_arguments
def my_wrapper(func, *decorator_args, **decorator_kwargs):
    def wrapped(*call_args, **call_kwargs):
        print "from decorator:", decorator_args, decorator_kwargs
        func(*call_args, **call_kwargs)
    return wrapped 
```

然后可以正常使用：

```
@my_wrapper(1, 2, 3)
def test(*args, **kwargs):
    print "passed directly:", args, kwargs

test(4, 5, 6) 
```

添加`functools.wraps`装饰留作练习:)

# javascript - 可以将数字数组转换为函数数组吗？

> ID：10610825
> 
> 赞同：0
> 
> 时间：2012-05-16T01:15:01.670
> 
> 标签：javascript

新手求助：我有一个数字数组需要转换为返回原始数字的函数数组，所以`a[3]`我需要调用 call 而不是 call`a[3]()`

例如：

```
[1,2,3] -> [
    function () {return 1;}, 
    function () {return 2;}, 
    function () {return 3;}
] 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:18:47.937

```
var arr = [1,2,3];

for (var i = 0; i < arr.length; i++)
    arr[i] = (function(i) { return function() { return i; } })(i); 
```

## [演示](http://jsfiddle.net/bqhHK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:19:08.147

```
function convert( arr ) {
    for ( var i = 0; i < arr.length; i++ ) {
        arr[i] = (function( a ) { return function() { return a; }; })( arr[i] );
    }
    return arr;
}​

var arr = convert( [1, 2, 3] ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T01:24:50.710

```
[1, 2, 3].map(function(num) {
    return function(){ return num; }
}); 
```

应该做的任务

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T01:26:38.370

```
function transform(a) {
    var result = [];

    for (var i = 0; i < a.length; i++)
        result.push(function(value) {
            return function() {
                return value;
            }
        }(a[i]));

    return result;
}

var myArray = [1, 2, 3];
var transformed = transform(myArray); 
```

# android - 语音识别 - 支持所有语言 - Android

> ID：10610826
> 
> 赞同：3
> 
> 时间：2012-05-16T01:15:20.147
> 
> 标签：android, broadcastreceiver, speech-recognition

我很难让这个工作。我只是想找出语音识别支持的所有可用语言，以及使用它的代码。

有

```
RecognizerIntent.EXTRA_SUPPORTED_LANGUAGES 
```

它应该将 G 的语音识别服务器上的所有可用语言作为一个数组报告回来。不幸的是，我什至无法让它吐出一个。我认为我主要只是对 BroadcastReceiver 有问题。

```
package com.thatll.ddo;

import java.util.ArrayList;
import java.util.logging.Logger;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.speech.RecognizerIntent;
import android.util.Log;
import android.widget.Toast;

public class RecogtestActivity extends Activity {
    private static final int VOICE_RECOGNITION_REQUEST_CODE = 1234;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Log.i("Log", "startVoiceRecognitionActivity");
    Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "speech recognition demo");

    startActivityForResult(intent, VOICE_RECOGNITION_REQUEST_CODE);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
  if (requestCode == VOICE_RECOGNITION_REQUEST_CODE && resultCode == RESULT_OK) {

     Intent intent = new Intent(RecognizerIntent.ACTION_GET_LANGUAGE_DETAILS);
     LangBroadcastReceiver myBroadcastReceiver = new LangBroadcastReceiver(this, data.getStringArrayListExtra(RecognizerIntent.EXTRA_SUPPORTED_LANGUAGES));
     sendOrderedBroadcast(intent, null, myBroadcastReceiver, null, Activity.RESULT_OK, null, null);

  } else {
     Toast.makeText(getApplicationContext(), "Voice recognition failed.", Toast.LENGTH_LONG).show();
  }
  super.onActivityResult(requestCode, resultCode, data);
}

/**
 * After a voice recognition is performed, need to sent a broadcast to
 * request the language used. This BroadcastReceiver gets the response and
 * then processes the original recognisedText from the
 * ACTION_RECOGNIZE_SPEECH Intent.
 * 
 */
public class LangBroadcastReceiver extends BroadcastReceiver {
  ArrayList<String> recognisedText;
  Activity parentActivity;

  /**
   * Store these for later use...
   * @param activity
   * @param arrayList
   */
  LangBroadcastReceiver(Activity activity, ArrayList<String> arrayList) {
     recognisedText = arrayList;
     parentActivity = activity;
  }

  @Override
  public void onReceive(Context context, Intent intent) {
     Bundle results = getResultExtras(true);
     String lang = results.getString(RecognizerIntent.EXTRA_SUPPORTED_LANGUAGES);
     Log.d("log", "MyBroadcastReceiver: Got 'EXTRA_LANGUAGE_PREFERENCE' = " + lang);
     // now handle the recognisedText with the known language.

     ArrayList<CharSequence> hints = getResultExtras(true)
             .getCharSequenceArrayList(
                     RecognizerIntent.EXTRA_SUPPORTED_LANGUAGES);

     Log.d("log", "MyBroadcastReceiver: Got 'EXTRA_LANGUAGE_PREFERENCE' =   " + hints);

  }

}} 
```

我想知道为什么这不起作用，但在这一点上，如果我得到当前支持的语言的完整列表，我会很高兴。尝试了各种不同的方法，现在它开始让我烦恼。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T08:47:07.473

请在此处查看我的答案，我描述了如何`RecognizerIntent.ACTION_GET_LANGUAGE_DETAILS`正确执行：

[如何在android上设置语音识别中的语言？](https://stackoverflow.com/questions/10538791/how-to-set-the-language-in-speech-recognition-on-android/10548680#10548680)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-05T21:40:05.993

你可能对这个小库感兴趣：[https ://github.com/Kaljurand/speechutils](https://github.com/Kaljurand/speechutils)

特别是，类[RecognitionServiceManager](https://github.com/Kaljurand/speechutils/blob/master/app/src/main/java/ee/ioc/phon/android/speechutils/RecognitionServiceManager.java)查询所有已安装的语音识别服务，以获取它们支持的所有语言。

# java - addCountry 空指针错误

> ID：10610827
> 
> 赞同：0
> 
> 时间：2012-05-16T01:15:28.023
> 
> 标签：java, arrays, nullpointerexception

有人可以提供一些关于为什么代码不起作用的见解吗？

[编辑：固定代码和新错误]

根据我的输出，我在线程“main”中收到错误异常，`java.lang.NullPointerException` 在`World.addCountry()`（第 8 行）代码中出现错误，在`addWorldplaces()`（第 5 行）代码中出现错误。

我觉得这与不实例化`world`类有关吗？有可能吗？

```
public class World{

private Country[] countries;
private int numCountries=0;

public boolean addCountry(Country newCountry){
    if(!(newCountry==null)){
        countries[numCountries]=newCountry;

        numCountries++;
        return true;
    }
    else
        return false;
       }
}

public static void addWorldplaces(World pWorld){
         Country usa=new Country("USA", 1);
        pWorld.addCountry(usa);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:22:08.167

数组实际上是 Java 中的对象。您需要先分配`Countries`数组，然后才能使用它。您通常会在构造函数中执行此操作：

```
public class World
{
  private Country[] countries;
  private int numCountries;

  public World()
  {
    this.countries = new Country[16];       // allocate the array
    this.numCountries = 0;
  }

  ...
} 
```

您需要适当地调整数组的大小。或者，您可以查看一个[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)，如果需要，它会自动增大大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T01:29:08.810

有2种可能：

1.  没有实例化`World`对象（我没有看到`pWorld`第一次实例化的地方）
2.  你的数组`Country`没有实例化。你必须这样做`private Country[] countries = new Country[10]`。

*注意：请发布异常的堆栈跟踪。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T02:00:32.073

Greg Kopff 是对的，您必须先初始化一个 Array，然后再将其放入其中。

在您的情况下，数组的大小不确定，[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)更好。所以你不需要自己处理扩展数组或国家号码。

```
public class World {

  private ArrayList<Country> countries = new ArrayList<Country>();

  public boolean addCountry(Country country) {
      if (country != null) {
          countries.add(country);
          return true;
      } else {
          return false;
      }
  }

  public int getCountryNumber() {
      return countries.size();
  }
  ...
} 
```

# c# - 如何在 Excel 中移动 NamedRange - VSTO 而不是 VBA

> ID：10610828
> 
> 赞同：3
> 
> 时间：2012-05-16T01:17:00.493
> 
> 标签：c#, excel, vsto, named-ranges

我搜索了网络，根据文档，似乎没有移动 NamedRange 的方法：http: [//msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.namedrange_methods (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.namedrange_methods(v=vs.80).aspx)

我有以下代码将单元格数据复制到几行：

```
activeSheet.Range[leftColumn + startRow, rightColumn + endRow].Copy();
//activeSheet.Range[leftColumn + startRow, rightColumn + endRow].Delete();
Range newRange = activeSheet.get_Range(leftColumn + (startRow + RowsToMoveDown.Count), rightColumn + (endRow + RowsToMoveDown.Count));
newRange.PasteSpecial(XlPasteType.xlPasteAll, XlPasteSpecialOperation.xlPasteSpecialOperationNone, Missing.Value, Missing.Value); 
```

NamedRange 是我正在复制和粘贴的单元格，它确实将单元格值向下移动了几行，但因为它是复制，所以它会将数据留在上述单元格中，并且 Delete 方法会导致异常。然而，真正的问题是在我将单元格移动到我创建的 NamedRange 之后：

```
rnArea = activeSheet.Range[leftColumn + startRow , rightColumn + (MyData.Values.Length + startRow)];
Name name = activeBook.Names.Add(uniqueName, rnArea); 
```

仍然指的是原始单元格范围（我将单元格向下移动之前的位置）。

**如何以编程方式在 C# VSTO 4.0 中移动 NamedRange？**

*理想情况下，我不必在将单元格放入 Range 之前移动它们，但如果这是唯一的解决方案，那么我将不得不采用它。*

**编辑：**

在阅读了 Doug Glancy 关于在 VSTO C# 中尝试类似 VBA 的语法的评论后，我想到了以下内容：

```
for (int i = 0; i < activeWorkbook.Names.Count; i++)
{
name = activeWorkbook.Names.Item(i + 1);
Debug.Write(name.Name.ToString());

System.Diagnostics.Debug.Write(name.RefersTo.ToString() + Environment.NewLine);
//prints out "Sheet1!$A$1:$A$25"
name.RefersTo = "Sheet1!$A$2:$A$26";
System.Diagnostics.Debug.Write(name.RefersTo.ToString());
//prints out "Sheet1!$A$2:$A$26"
} 
```

但是，当我运行此代码并更改 NamedRange RefersTo 值时，结果是 Excel NamedRange DropDownList 中缺少 NamedRange ？！？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T01:45:50.560

您可以通过使用不同的地址再次添加命名范围来“移动”命名范围。例如，在 VBA 中：

```
Sub MoveNamedRange()
ActiveSheet.Names.Add Name:="test", RefersTo:="=$A$1"
Debug.Print ActiveSheet.Range("test").Address
ActiveSheet.Names.Add Name:="test", RefersTo:="=$A$2"
Debug.Print ActiveSheet.Range("test").Address
End Sub 
```

这将编译并运行并在即时窗口中产生以下内容：

```
$A$1
$A$2 
```

编辑 - C 很难！但我设法在 VS 2010 C# 中拼凑起来。它来自一个工作簿项目，但我相信它也可以在插件中工作。我认为我不需要 VS 2010 中的所有 Type.Missing，但我很确定我已经阅读过早期版本中需要它们：

```
private void Sheet1_Startup(object sender, System.EventArgs e)
        {
            Globals.Sheet1.Names.Add("test", Globals.Sheet1.Range["A1"], System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing);
            MessageBox.Show(Globals.Sheet1.Range["test"].Address);
            Globals.Sheet1.Names.Add("test", Globals.Sheet1.Range["A2"], System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing);
            MessageBox.Show(Globals.Sheet1.Range["test"].Address);
        } 
```

# javascript - 在 Node.js 上使用 Faye 进行服务器身份验证

> ID：10610836
> 
> 赞同：1
> 
> 时间：2012-05-16T01:18:34.783
> 
> 标签：javascript, node.js, faye

所以我对 node.js 和 faye 非常陌生 - 所以我认为这是非常基本的，但我不确定我应该问什么。

我为我的 faye 服务器设置了这个设置，在节点 jitsu 上运行：

```
var http = require('http'),
    faye = require('faye');

var bayeux = new faye.NodeAdapter({mount: '/faye', timeout: 45});

// Handle non-Bayeux requests
var server = http.createServer(function(request, response) {
  response.writeHead(200, {'Content-Type': 'text/plain'});
  response.write('Hello, non-Bayeux request');
  response.end();
});
bayeux.attach(server);
server.listen(8000);

var fayeToken = "myToken";

var serverAuth = {
  incoming: function(message, callback) {
    // Add an error if the tokens don't match
    if (fayeToken !== message.ext.auth_token)
        message.error = 'Invalid auth token';

      // Call the server back now we're done
      callback(message);
  }
};

bayeux.addExtension(serverAuth); 
```

然后我有一个连接到它的 rails 应用程序。

在我添加 serverAuth 的东西之前，它工作正常。

当我像这样卷曲时：

```
curl http://myapp.jit.su/faye -d 'message={"channel":"/alerts", "data":"hello", "ext":{"auth_token":"myToken"}}' 
```

我收到一条成功消息。

在 Rails 应用程序上的 JS 文件中，我有：

```
$(function() {
    //FAYE CLIENT
    var faye = new Faye.Client('http://myapp.jit.su/faye');
    faye.setHeader('ext.auth_token', 'myToken');
    faye.subscribe("/alerts", function(data) {
        alert(data);
    });
}); 
```

现在，当为 faye 脚本加载 rails 应用程序时，我收到一个错误的请求 400 错误。

发送的参数具体是：

```
[{"channel":"/meta/handshake","version":"1.0","supportedConnectionTypes":["callback-polling"],"id":"1"}] 
```

因此，我设置的标头参数似乎没有在 faye 所做的“元”握手中发送。

在我进行此服务器身份验证之前，它工作得很好，我可以将消息卷曲到应用程序中。现在没有骰子。

有什么想法我哪里出错了吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T02:11:19.143

备查：

我必须确保它没有进行元调用：

```
var serverAuth = {
  incoming: function(message, callback) {
    // Let non-subscribe messages through
        if (message.channel.indexOf("/meta/") !== 0){
            if (fayeToken !== message.ext.auth_token){
                message.error = 'Invalid auth token';
            }
        }   
      callback(message);
  }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T09:37:02.387

我可以在这里看到两个问题。首先，如果消息没有`ext`字段，您的扩展程序将失败。您应该在检查之前检查它`message.ext.auth_token`：

```
var serverAuth = {
    incoming: function(message, callback) {
    // Let non-subscribe messages through
        if (message.channel.indexOf("/meta/") !== 0){
            if (!message.ext || fayeToken !== message.ext.auth_token){
                message.error = 'Invalid auth token';
            }
        }   
        callback(message);
    }
}; 
```

我也不确定您要验证什么。`if (message.channel.indexOf("/meta/") !== 0)`将匹配任何非元消息，即所有发送的消息`publish()`（元消息用于握手、轮询、（取消）订阅和断开连接）。这意味着任何人都可以发布消息，但只有服务器可以订阅任何频道。

其次，`ext`是消息本身的一部分，而`setHeader()`用于设置 HTTP 标头，即它是传输层的一部分。您应该使用扩展来添加`ext`消息：

```
client.addExtension({
    outgoing: function(message, callback) {
        message.ext = message.ext || {};
        message.ext.auth_token = THE_TOKEN;
        callback(message);
    }
}); 
```

# ruby-on-rails - 无法让 Rails 3 Active Scaffold 嵌套表单/记录正常工作

> ID：10610837
> 
> 赞同：0
> 
> 时间：2012-05-16T01:18:42.000
> 
> 标签：ruby-on-rails, activerecord, nested, scaffold

比较详细说明我自己的记录集，很简单但是有很多字段和子记录，我只是希望能够让github上给出的示例能够工作，即[https://github.com/activescaffold/ active_scaffold/wiki/API%3A-嵌套](https://github.com/activescaffold/active_scaffold/wiki/API%3A-Nested)

```
# app/models/company.rb
class Company < ActiveRecord::Base
   has_many :contacts
end

# app/models/contact.rb
class Contact < ActiveRecord::Base
  belongs_to :company
end

# app/controllers/contacts_controller.rb
class ContactsController < ApplicationController
  active_scaffold :contacts do | config |
  end
end

# app/controllers/companies_controller.rb
class CompaniesController < ApplicationController
  active_scaffold :companies do |config|
    config.nested.add_link("Company's contacts", [:contacts])
  end
end 
```

显然，contacts 表有一个 company_id 列（即外键）。

“按原样”，似乎在公司控制器中，“公司”需要是“公司”。因此，在更改之后， config.nested... 行会导致以下错误：-

nil:NilClass 的路由错误未定义方法“add_link”

在尝试（但失败）解决此问题后，我只是将其注释掉并且效果很好，但是我需要一对一（或没有）关系，因此进行了更改（联系人必须更改为联系人，否则为 Rails 对象）： -

```
# app/models/company.rb
class Company < ActiveRecord::Base
   has_one:contact
end 
```

它似乎可以工作，但是当更新联系人时，它会使表单变得一团糟，在表单顶部显示更新的联系人，就在实际属于下面记录的字段标签下方，即公司记录。它还允许在创建公司记录时创建多个联系人，但这可能会受到另一种方法的限制，或者如果 config.nested.add_link 有效，则可能会被修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:03:29.037

我有同样的问题，只需使用这个（它在你发布的同一个链接中）：

```
config.nested.add_link(:contacts, :label => "Company's contacts", :page => true) 
```

# android - EditText 不会换行它的文本

> ID：10610842
> 
> 赞同：7
> 
> 时间：2012-05-16T01:19:26.457
> 
> 标签：android, view, android-edittext

我知道 Stackoverflow 中有很多相关的问题，但我试图做任何写在其中的所有问题，但到目前为止我无法让它工作。

我的问题很简单。我有一个 android 应用程序，我有一个框，用户将在其中输入文本。但是，我不希望这个文本是多行的（它不应该有“\n”），但如果行的大小大于视口，我希望它换行。所以基本上，我想要的是与 Gmail 主题字段上的 textBox 相同的行为。

这是我的整体观点：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent"
          android:layout_height="match_parent"
          android:orientation="vertical">

<TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/question"
        android:textAppearance="@style/titleFont"/>

<EditText
    android:id="@+id/edit_question_value"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.3"
    android:gravity="top"
    android:inputType="textImeMultiLine|textEmailSubject"
    android:maxLength="70"
        >

</EditText>

<TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/answer"
        android:textAppearance="@style/titleFont"/>

<EditText
        android:id="@+id/edit_question_answer"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:gravity="top"
        android:layout_weight="0.7"
        android:inputType="textMultiLine"/>

<LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal">

    <Button
            android:id="@+id/save_question"
            android:layout_width="120dp"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_weight="0.5"
            android:text="@string/save"/>

    <Button
            android:id="@+id/cancel_edit_question"
            android:layout_width="120dp"
            android:layout_height="wrap_content"
            android:layout_weight="0.5"
            android:text="@string/cancel"/>
</LinearLayout> 
```

我想要这种行为的文本是 id 等于 @+id/edit_question_value 的文本。到目前为止，我已经能够使其真正成为多行（因此用户可以根据需要键入 enter）或单行并且文本不会换行。也许文本周围的一些元素受到了一些干扰，这就是我包含整个视图的原因。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T01:56:25.890

这是以前困扰很多人的事情，当我需要它时我找不到答案。在纯 XML 中，就是这样。如果我们可以使用编程而不仅仅是标记，如果可以的话，我们可以通过一些小*技巧*来做到这一点。基本上，我们声明一个 multiLine 编辑文本，然后捕获返回键以避免换行。

首先是**xml**中的声明：

```
<EditText
    android:id="@+id/noReturnEditText"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:imeOptions="actionDone"
    android:inputType="textMultiLine|textCapSentences"
    android:text="lorem ipsum \n dolor site amet helping stackoverflow" /> 
```

是的，我知道你在想什么“但是，嘿，*胡安*，这是一个多线程`EditText`，我想要一个像 gmail 主题区域那样的单线程”。我知道，我知道，但我们现在要处理它，通过删除我们不想要的多行部分的行为，同时保持我们想要的文本换**行**。

现在剩下的**代码**：

```
EditText noReturnEditText = (EditText) findViewById(R.id.noReturnEditText);
         noReturnEditText.setOnKeyListener(new OnKeyListener(){
            @Override
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                if (keyCode == KeyEvent.KEYCODE_ENTER) return true;
                return false;
            }
        }); 
```

您可能可以很容易地阅读代码，但如果有人需要解释，我们将设置`OnKeyListener`为`EditText`我们想要的“单线多线”，如果用户按下返回键 (KEYCODE_ENTER)，我们会告诉事件不要传播通过在这种情况下返回`true`which 意味着我们已经处理了事件。

**结果：**

![在此处输入图像描述](../Images/14d09d04780ef84d4eef213af70a5e7f.png)

**注意事项**

按回车键不是输入新行的唯一方法。用户可以复制/粘贴一些文本并最终在单行 EditText 上添加多行条目。不用担心！我们可以在存储之前剥离值或将其与类似的东西一起使用

`myData = rawText.replace(System.getProperty("line.separator"), " ");`

**如果我有很多`EditText`视图怎么办？**

好吧，你基本上有两个选择。一个一个地做，把你的眼睛拉出来**或者**做这样的事情，它列出视图并循环每个视图。

```
//Declare the reusable listener
  OnKeyListener myListener = new OnKeyListener(){
        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            if (keyCode == KeyEvent.KEYCODE_ENTER) return true;
            return false;
        }
    }  
//Loop through the views
    int viewIds[] = {R.id.edittext1,R.id.edittext2,R.id.edittext3,R.id.edittext4};
    for(int id : viewIds) ((EditText)findViewById).setOnKeyListener(myListener); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-07-01T11:31:26.037

```
<EditText
            android:layout_width="200dp"
            android:layout_height="match_parent"
            android:layout_gravity="center"
            android:background="@color/color_red"
            android:focusable="true"
            android:focusableInTouchMode="true"
            android:gravity="top|left"
            android:inputType="textMultiLine|textCapSentences"
            android:lines="10"
            android:maxWidth="200dp"
            android:maxLength="200"
            android:maxLines="10"
            android:singleLine="false"
            android:textColor="@android:color/white"
            android:textSize="26sp" /> 
```

试试这个。当我将重力改为左上角时为我工作

# animation - Unity 3D 旋转游戏对象

> ID：10610843
> 
> 赞同：0
> 
> 时间：2012-05-16T01:19:26.940
> 
> 标签：animation, unity3d, unityscript

我正在尝试统一旋转 3D Gameobject。它实际上是一个圆柱体，上面只有一个扑克筹码的纹理。一旦它与光线投射相撞，我想将它旋转 360 度。它在 Unity 仿真器中工作得很好，但是，在设备本身上，芯片在其旋转后停止，然后继续在无限循环中旋转。这是有问题的代码片段。感谢您提前提供任何帮助。

```
 // Spin the chip
if (Animate) {
    if (Speed > 0 && Chip.tag.Contains("Chip")) {
        Chip.transform.Rotate(0, Speed*Time.deltaTime, 0);
        Speed -= 3;
        Debug.Log(Speed);
    }
    else {
        // Reset
        Animate = false;
        Speed = 360;
        Chip.transform.localRotation = Quaternion.Euler(0.0,0.0,0.0);
    }   
} 
```

为了总结这一点，我可以最好地分配游戏对象芯片，当它在光线投射上发生碰撞时

```
// Set the chip
    Chip = hit.transform; 
```

一切都在更新功能中完成。一旦光线投射命中，它就会调用一个投注函数，然后在计算投注后，它将布尔动画更改为 true，从而导致芯片旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:19:18.327

在其他代码中设置`Animate = true`了一些东西，很难在没有看到其余部分的情况下说出发生了什么。

在 Animate 设置为 true 的每个位置旁边放置一些调试，您应该会看到其他设置它，只有可能解释它为什么继续旋转。

另一种选择是使用动画工具，而不是旋转，您只需播放为您执行旋转的动画。

编辑：触摸代码很可能是它，因为当您在编辑器中调试时使用击键。我经历过几次的陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T09:48:28.890

在您的更新功能中。Bool 变量 Animate 可能变为 true 。这可能是您的气缸继续旋转的原因。

其他解决方案是：您可以创建一个圆柱体的动画，然后拿一个秒表。这样一来，您就可以使用秒表的时间来停止动画

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-19T04:37:39.467

James Gramosli 是正确的，因为其他一些代码再次触发了动画，并且很可能是您的触摸代码。在编辑器和触控设备之间移动时，这是一个常见问题。您可以通过使用 UnityRemote 验证代码的控制流来确定是否属于这种情况。

也就是说，我会将您的代码更改为以下代码，从而从运行每一帧的更新循环中删除自旋代码。这是一个小的优化，但主要是它清理了架构，使其更加模块化和更整洁。

从您的代码片段中不清楚，但我假设您使用的是 UnityScript。

在您单击芯片时处理触摸代码的脚本中，插入以下行：

```
hit.transform.SendMessage("Spin", hit.transform, SendMessageOptions.DontRequireReceiver); 
```

将此代码放在名为“SpinChip”的单独脚本中，然后将该脚本添加到您的芯片对象中。

```
var StartSpeed = 360.0;
var Deceleration = 3.0;

function Spin()
{
    if (Animating)
    {
        print("Chip is already spinning, not starting another animation");
        return;
    }

/*
    This code isn't necessary if this exists in a separate script and is only ever attached to the clickable chip
    if (!gameObject.tag.Contains("Chip"))
    {
        print("That wasn't a chip you clicked");
        return;
    }
*/

    print("Chip has been told to spin");
    StartCoroutine(SpinningAnimation);
}

function SpinningAnimation()
{
    print("Chip spin start");
    transform.localRotation = Quaternion.identity;
    Speed = StartSpeed;
    Animating = true;
    while (Speed > 0)
    {
        transform.Rotate(0, Speed*Time.deltaTime, 0);
        Speed -= Deceleration;
        yield; // wait one frame
    }

    print("Chip has completed the spin");
    Animating = false;
} 
```

这段代码的作用是创建一个协同程序，在激活时每个更新循环运行一次，它将为您旋转芯片，并且独立于您的实际按钮单击代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-09T08:11:37.443

```
var rotSpeed: float = 60; // degrees per second

function Update(){
  transform.Rotate(0, rotSpeed * Time.deltaTime, 0, Space.World);
} 
```

这是一个旋转游戏对象的代码，您可以将它与向量 3 一起使用：`transform.Rotate(x, y, z);`或者使用 Space`transform.Rotate(x, y, z, Space.World);` `rotSpeed`是旋转速度。

# timestamp - 从晦涩的十六进制编码方案中确定日期和时间

> ID：10610846
> 
> 赞同：3
> 
> 时间：2012-05-16T01:19:42.090
> 
> 标签：timestamp, hex, bit-manipulation, reverse-engineering, file-format

感谢 ndkrempel，十六进制的日期部分已被破译。时间还有待解码。但是，通过 ndkrempel 在该主题上的工作，我意识到整个时间戳包括额外的 7 个字节，我之前忽略了这些字节，因为我的文件通常包含零分钟或秒的时间戳。以下是一些“完整”的十六进制序列，希望包含准确转换所需的剩余时间数据：

```
C00AE440555555555555D53F555555555555D53FABAAAAAAAAAAEA3F0CF712000000 = 17.05.1208.00.001024
C00AE440ABAAAAAAAAAAE23F555555555555D53FABAAAAAAAAAAEA3F0CF71200E0C4 = 17.05.1214.00.001024
C00AE440610BB6600BB6E23F555555555555D53FABAAAAAAAAAAEA3F0CF7120058C5 = 17.05.1214.02.001024
C00AE440176CC1166CC1E23F555555555555D53FABAAAAAAAAAAEA3F0CF71200D0C5 = 17.05.1214.04.001024
C00AE440CDCCCCCCCCCCE23F555555555555D53FABAAAAAAAAAAEA3F0CF7120048C6 = 17.05.1214.06.001024 
```

* * *

不同时间的附加十六进制代码

```
C00AE440721CC7711CC7E93F555555555555D53FABAAAAAAAAAAEA3F0CF71200E00F01 = 17.05.1219.20.001024
C00AE440CDCCCCCCCCCCE93F555555555555D53FABAAAAAAAAAAEA3F0CF712001C1001 = 17.05.1219.21.001024
C00AE440287DD2277DD2E93F555555555555D53FABAAAAAAAAAAEA3F0CF71200581001 = 17.05.1219.22.001024
C00AE440DEDDDDDDDDDDE93F555555555555D53FABAAAAAAAAAAEA3F0CF71200D01001 = 17.05.1219.24.001024
C00AE440398EE3388EE3E93F555555555555D53FABAAAAAAAAAAEA3F0CF712000C1101 = 17.05.1219.25.001024
C00AE440943EE9933EE9E93F555555555555D53FABAAAAAAAAAAEA3F0CF71200481101 = 17.05.1219.26.001024
C00AE440EFEEEEEEEEEEE93F555555555555D53FABAAAAAAAAAAEA3F0CF71200841101 = 17.05.1219.27.001024
C00AE4404A9FF4499FF4E93F555555555555D53FABAAAAAAAAAAEA3F0CF71200C01101 = 17.05.1219.28.001024
C00AE440A54FFAA44FFAE93F555555555555D53FABAAAAAAAAAAEA3F0CF71200FC1101 = 17.05.1219.29.001024
C00AE440000000000000EA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200381201 = 17.05.1219.30.001024

E00AE4404A9FF4499FF4EA3F555555555555D53FABAAAAAAAAAAEA3F0CF712004C1C01 = 18.05.1220.13.001024
E00AE440D8822DD8822DEB3F555555555555D53FABAAAAAAAAAAEA3F0CF71200A41E01 = 18.05.1220.23.001024
E00AE440666666666666EB3F555555555555D53FABAAAAAAAAAAEA3F0CF71200FC2001 = 18.05.1220.33.001024
E00AE440F5499FF4499FEB3F555555555555D53FABAAAAAAAAAAEA3F0CF71200542301 = 18.05.1220.43.001024
E00AE440832DD8822DD8EB3F555555555555D53FABAAAAAAAAAAEA3F0CF71200AC2501 = 18.05.1220.53.001024
E00AE440111111111111EC3F555555555555D53FABAAAAAAAAAAEA3F0CF71200042801 = 18.05.1221.03.001024
E00AE4409FF4499FF449EC3F555555555555D53FABAAAAAAAAAAEA3F0CF712005C2A01 = 18.05.1221.13.001024
E00AE4402ED8822DD882EC3F555555555555D53FABAAAAAAAAAAEA3F0CF71200B42C01 = 18.05.1221.23.001024
E00AE440BCBBBBBBBBBBEC3F555555555555D53FABAAAAAAAAAAEA3F0CF712000C2F01 = 18.05.1221.33.001024
E00AE440176CC1166CC1EC3F555555555555D53FABAAAAAAAAAAEA3F0CF71200482F01 = 18.05.1221.34.001024

E00AE440E42DCDC10BABDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200A28C00 = 18.05.1210.00.021024
E00AE4401DB1EFD86CABDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200A48C00 = 18.05.1210.00.041024
E00AE440563412F0CDABDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200A68C00 = 18.05.1210.00.061024
E00AE44090B734072FACDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200A88C00 = 18.05.1210.00.081024
E00AE440C93A571E90ACDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200AA8C00 = 18.05.1210.00.101024
E00AE44002BE7935F1ACDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200AC8C00 = 18.05.1210.00.121024
E00AE4403C419C4C52ADDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200AE8C00 = 18.05.1210.00.141024
E00AE44075C4BE63B3ADDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200B08C00 = 18.05.1210.00.161024
E00AE440AE47E17A14AEDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200B28C00 = 18.05.1210.00.181024
E00AE440E7CA039275AEDA3F555555555555D53FABAAAAAAAAAAEA3F0CF71200B48C00 = 18.05.1210.00.201024 
```

* * *

**前言：我尽我所能检查了我正在处理的十六进制似乎不符合“标准”十六进制日期/时间格式（time_t、time_64、DATE、DOS 日期/时间，由 Hex Workshop 计算）以及作为[DCode](http://www.digital-detective.co.uk/freetools/decode.asp)时间解码器应用程序检查的所有格式）。**

我正在尝试编写一个批处理对话实用程序来处理由内部未记录的软件生成的适当文件格式。我有能力使用一个被遗忘已久且文档记录也很差的实用程序来转换文件，但这是一个耗时且乏味的过程，我希望将其自动化。

只需使用十六进制编辑器，我就可以找到我需要的一切，除了原始文件中的日期和时间是如何编码的。我确信我已经确定了代表我所追求的数据的 27 字节十六进制序列，因为我可以对其进行编辑以更改日期并将其插入另一个文件以传输日期。但是，我想了解它是如何实际生成的，以便我可以隐藏日期未知的文件。

下面是十六进制序列的示例（左）和它们在转换后的文件中产生的时间戳（右为格式：DD.MM.YYHH.MM.SS）。有些是直接从软件生成的文件中获取的，有些是我手动编辑的序列，以查看日期是如何更改的。任何一年 > 12 的东西都是我修改十六进制的结果。有没有人有什么建议？我不是一个程序员，在这里我很头疼。

```
80D8E340ABAAAAAAAAAAEE3F555555555555DD3FABAAAAAAAAAAEE = 11.04.1123.00.001024

E008E440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 02.05.1208.00.001024

E001E440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 07.03.1208.00.001024

600AE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 14.05.1209.00.001024

610AE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 14.05.1209.00.001024

6001E440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 03.03.1209.00.001024

0101E440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 29.02.1208.00.001024

01010140555555555555D53F555555555555D53FABAAAAAAAAAAEA = 01.01.0008.00.001024

01010101555555555555D53F555555555555D53FABAAAAAAAAAAEA = 30.12.9908.00.001024

600AE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 14.05.1209.00.001024

60FFE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 25.09.1709.00.001024

60FFE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEA = 25.09.1709.00.001024

60FFE440000000000000D83FABAAAAAAAAAADA3FABFFFFFFFFFFEA = 25.09.1709.00.001024

60FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 25.09.1709.00.001024

01FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 22.09.1709.00.001024

02FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 22.09.1709.00.001024

10FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 22.09.1709.00.001024

20FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 23.09.1709.00.001024

30FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 23.09.1709.00.001024

40FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 24.09.1709.00.001024

50FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 24.09.1709.00.001024

60FFE440000000000000D83FAB0000000000DA3FAB0000000000EA = 25.09.1709.00.001024

600AE440000000000000D83FAB0000000000DA3FAB0000000000EA = 14.05.1209.00.001024

60FAE440000000000000D83FAB0000000000DA3FAB0000000000EA = 16.08.1709.00.001024

60FAE540000000000000D83FAB0000000000DA3FAB0000000000EA = 26.03.2309.00.001024

60FFE440FFFFFFFFFFFFD83FAB0000000000DA3FAB0000000000EA = 25.09.1709.22.301024

60FFE440010101010101D83FAB0000000000DA3FAB0000000000EA = 25.09.1709.00.051024

40DEE340ABAAAAAAAAAAE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 27.05.1117.00.001024

60DEE340ABAAAAAAAAAAE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 28.05.1117.00.001024

800AE440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 15.05.1208.00.001024 
```

另外，我应该提到最后 14 个字节似乎并不是特别重要（尽管它们在原始文件中确实发生了变化）。例如，以下序列在转换后会产生相同的输出。我不知道这些值是在转换过程中被四舍五入还是被简单地剔除。无论如何，如果我能确定月、日、年、小时、分钟和秒，那部分并不重要。

```
E008E440555555555555D53F555555555555FFFFFFFFFFFFFFFFFF = 02.05.1208.00.001024

E008E440555555555555D53FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF = 02.05.1208.00.001024

E008E440555555555555D53F000000000000000000000000000000 = 02.05.1208.00.001024 
```

以下内容仅由源软件生成，未经手动修改。

```
40DEE340ABAAAAAAAAAAE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 27.05.1117.00.001024

60DEE340ABAAAAAAAAAAE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 28.05.1117.00.001024

80D8E340ABAAAAAAAAAAEE3F555555555555DD3FABAAAAAAAAAAEE = 11.04.1123.00.001024

E008E440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 02.05.1208.00.001024

600AE440000000000000D83FABAAAAAAAAAADA3FABAAAAAAAAAAEE = 14.05.1209.00.001024

800AE440555555555555D53F555555555555D53FABAAAAAAAAAAEA = 15.05.1209.00.001024 
```

以下是来自不同时间文件的未经修改的十六进制序列：

```
A0B7E340ABAAAAAAAAAAE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 22.07.1016.00.001024

C0B7E340777777777777E73FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 23.07.1017.36.001024

A0EFE340CDCCCCCCCCCCE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 13.10.1117.06.001024

80EFE340BCBBBBBBBBBBE63FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 12.10.1117.03.001024

C0EEE340ABAAAAAAAAAAE13FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 06.10.1113.15.001024

60D5E340ABAAAAAAAAAACA3FABAAAAAAAAAACA3FABAAAAAAAAAAE6 = 17.03.1105.00.001024 
```

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T03:48:37.517

我在解码日期/时间格式方面取得了一些进展。具体来说，我可以读取日期，但我还没有尝试读取时间。

我相信该格式包含许多无关的，可能是垃圾数据；并且只有少数字节有意义。

日期仅以字节 0、1 和 2（前 3 个字节）编码。

将前 4 个字节解释为 little-endian 双字（4 字节）数量 x 是最容易解释的。然后，作为 1989-09-17 的偏移量的天数由下式给出

d = (x & 0x000FFFFF) >> 5

即，您只查看 20 个低位，而忽略其中的 5 个最低位。您可以通过说天数以 5-19 位（包括 5-19 位）编码来总结这一点（特别是，它是一个 15 位的数量）。

可能时间在数据的不同位置被类似地编码，但不同时间的例子并不多，我也需要睡觉！

* * *

好的，您提供的许多预先存在的数据（不是您手动生成的数据）似乎都被篡改了时间值（可能是其中一个相关程序转换本地时区的结果）。但只要继续你生成的那些，时间似乎编码如下：

取字节 9 和 10（我指的是第 10 和第 11 字节），并将它们视为小端字 x。屏蔽掉前 2 位，留下 14 位数量：

t = x & 0x3FFF

这代表一天中的时间。它的单位使得 0 对应于 00:00:00，并且（过去）最大值 16384 对应于 24:00:00。这使它的分辨率约为 5.3 秒。

换句话说，

s = t / 16384\. * 24\. * 60\. * 60.

以午夜过后的秒数给出时间.

* * *

好的，看看您现在提供的额外字节，字节 32 和 33（最后 2 个字节）似乎是替代时间戳。再次将其视为 little-endian 单词 x，它直接编码从午夜开始的秒数。当它为 0 时，似乎使用了上面描述的时间戳。似乎它只能描述溢出前最多 18:22 的时间，所以它也可能使用之前字节中的额外位？没有足够的数据可以再说了。

* * *

字节 34 是上述内容的延续。即，将字节 32、33 和 34 作为 little-endian 3 字节数量，然后，至少当它不为零时，它会给出从午夜开始的秒数，如上所述。

# sql-server - 如何从 umbraco CMS 导出数据？

> ID：10610857
> 
> 赞同：11
> 
> 时间：2012-05-16T01:21:55.623
> 
> 标签：sql-server, umbraco

我有一个使用 umbraco cms 的项目，即。MSSQL（现在我们正在用 WordPress 重建网站）。我无法理解这些关系。在 Umbraco 很难。所以我想直接从 Umbraco CMS 下载/导出内容。但是在 cms 中我找不到任何导出批量数据的选项。有没有其他方法可以做到这一点？或者如果你能帮我找到任何免费工具。或者任何可以简单地对 MySQL 执行 MSSQL 的免费工具？

提前致谢 / Rajeev

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-03-31T08:41:53.527

您可以通过创建一个包来做到这一点。在 Umbraco 的 Developer 部分，展开 Packages 节点并右键单击“Created packages”并单击“Create”。单击包，然后在编辑器的“包内容”选项卡中，您可以选择一个内容节点，其中包含包含其所有子节点的选项。

![Umbraco 内容包装](../Images/e5eed6cd3a4f4dab5ea19a61c8f433f2.png)

填写“包属性”选项卡中的必填字段。按下“保存并发布”后，您将可以选择下载包。

![下载 Umbraco 包](../Images/7e37b3b7a15cf5ee78c5d7978e6a50d8.png)

您现在可以下载此包中的内容，并使用“安装本地包”选项将其安装到 Umbraco 的另一个实例上。

[此处](http://www.uquickstart.com/umbraco-tips-and-tools/package-up-your-umbraco-website)提供了有关此方法的更详细说明。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T23:20:55.600

您可能想使用 Umbraco 的 Courier 插件进行探索：

[http://umbraco.com/products/more-add-ons/courier-2.aspx](http://umbraco.com/products/more-add-ons/courier-2.aspx)

它不是免费的，但它似乎是市场上此类工作的唯一工具。

# ruby-on-rails - 这个 ActiveRecord 'where' 子句是如何工作的？

> ID：10610863
> 
> 赞同：1
> 
> 时间：2012-05-16T01:22:36.580
> 
> 标签：ruby-on-rails, activerecord, rails-activerecord

我有这样的声明：

```
myuser.orders.exists?(['(orderstatus = ?) ', statusid]) 
```

它返回 true，因为有一个与 statusid 匹配的 orderstatus。

接下来我有：

```
myuser.orders.where('id not in (?)', nil).exists?(['(orderstatus = ?) ', statusid]) 
```

这在我认为它可能返回 true 的地方返回 false，因为没有 id 为 nil。

然后我有：

```
myuser.orders.where(nil).exists?(['(orderstatus = ?) ', statusid]) 
```

这返回真。

我的问题是为什么中间语句返回错误？它不会抱怨或抛出任何错误。我想我使用 nil 错误，但有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T01:33:14.563

您遇到了 SQL 的 NULL 问题。`where`中间那个：

```
where('id not in (?)', nil) 
```

变成这个 SQL：

```
id not in (null) 
```

这相当于：

```
id != null 
```

但结果`id != null`既非真非假，结果为 NULL 且布尔上下文中的 NULL 为假；事实上，`x = null`并`x != null`导致所有人都为 NULL `x`（即使`x`它本身为 NULL）；例如，在 PostgreSQL 中：

```
=> select coalesce((11 = null)::text, '-NULL-');
 coalesce 
----------
 -NULL-
(1 row)

=> select coalesce((11 != null)::text, '-NULL-');
 coalesce 
----------
 -NULL-
(1 row)

=> select coalesce((null = null)::text, '-NULL-');
 coalesce 
----------
 -NULL-
(1 row)

=> select coalesce((null != null)::text, '-NULL-');
 coalesce 
----------
 -NULL-
(1 row) 
```

MySQL 和所有其他合理兼容的数据库将做同样的事情（可能有不同的转换要求以使 NULL 显而易见）。

结果是`where(id not in (?)', nil)`总是产生一个空集，并且你的存在检查总是会在空集上失败。

如果你想说“所有`id`不为 NULL 的行”，那么你想说：

```
where('id is not null') 
```

如果你`id`是主键（几乎可以肯定是），那么`id`永远不会是 NULL，你可以`where`完全忽略它。

* * *

当你只手`where`一个`nil`：

```
where(nil) 
```

`where`的参数解析逻辑将`nil`完全忽略 并且`where(nil)`将与查询相同`where()`并且`where()`根本不执行任何操作。结果是就数据库而言，第一个和第三个查询是相同的。

# magento - 如何不在magento面包屑中显示类别名称？

> ID：10610866
> 
> 赞同：0
> 
> 时间：2012-05-16T01:23:25.510
> 
> 标签：magento, magento-1.6

我正在使用一个magento网站。我使用了一个特色类别来显示主页滑块产品。因此，当我单击产品时，它会在面包屑中显示为一个类别。

是否可以不在面包屑中显示特色？我想要其余类别的面包屑中的类别名称。

谢谢抗体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T09:41:49.963

为什么没有比这更简单的呢？

尝试使用 CSS。您的类别将有一个自动和特定的类。例如：

```
<li class="category4">
<strong>ARCHERY HUNTING</strong>
</li> 
```

在这段代码中，我创建了一个类别，称为“射箭狩猎”。代码自动创建了**class="category4"**，所以，只写在你的 CSS 上：

```
.category4 strong { display: none; } 
```

它只会隐藏该类别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T11:36:07.527

实际上没有得到你的问题，但你可以从这里得到一些想法：

在 page/html/breadcrumb.phtml 文件中第 34-36 行附近的更改中，将 $_crumbInfo['label'] 更改为 $_crumbInfo['title']

```
 <?php elseif($_crumbInfo['last']): ?>
          <strong><?php echo $this->htmlEscape($_crumbInfo['title']) ?></strong> 
```

然后在 catalog/block/breadcrumb.php 之后添加 2 行

```
 $path  = Mage::helper('catalog')->getBreadcrumbPath();
        $currentCategory = Mage::registry('current_category');
        $metaname = $currentCategory['name']; 
```

并更改 foreach 循环，例如

```
 foreach ($path as $name => $breadcrumb) {
        $breadcrumb['title'] = $metaname;
            $breadcrumbsBlock->addCrumb($name, $breadcrumb);

            $title[] = $breadcrumb['label'];
        } 
```

并检查它，希望你有所了解..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T12:11:51.997

而不是使用

```
$_product->getProductUrl() 
```

要获取 URL，请使用：

```
$_product->unsRequestPath()->getUrlInStore(array('_ignore_category' => true)) 
```

然后，您需要在特色块的末尾取消设置上次访问的类别 ID：

```
Mage::getSingleton('catalog/session')->setLastVisitedCategoryId(''); 
```

这都是因为形成面包屑的关键部分是以下代码：

```
 $categoryId = $params->getCategoryId();
    if (!$categoryId && ($categoryId !== false)) {
        $lastId = Mage::getSingleton('catalog/session')->getLastVisitedCategoryId();
        if ($product->canBeShowInCategory($lastId)) {
            $categoryId = $lastId;
        }
    } 
```

基本上，当前类别由 URL 参数（因此修改后的 URL 调用）或会话对象（因此删除最后访问的类别 id）确定

因此，概括一下，在您的 Featured 块中，而不是常规 productUrl 调用，使用我提供的那个，并在您的特色产品块列表的末尾，使用我给您的代码删除 lastVisitedCategoryId

# php - PHP if/else 语句问题

> ID：10610869
> 
> 赞同：0
> 
> 时间：2012-05-16T01:23:59.983
> 
> 标签：php, if-statement

我对这个声明有一些问题，

```
<?php 
    $cert_mess = $vehicle['make'];
    if ($vehicle["make"] == "Honda" && $vehicle["Certified"] == "0")  {
        $cert_mess = "DFWCertAutos";
    }
    elseif ($vehicle["make"] == "Cadillac" && $vehicle["Certified"] == "0") {
        $cert_mess = "DFWCertAutos";
    }
    elseif (!in_array($vehicle['make'], array('Cadillac','Honda') )) {
        $cert_mess = "DFWCertAutos";
    }
?>
<div style="font-size:10px; padding:10px; padding-top: 0px;">*This car is <?php 
echo $cert_mess ?> certified.</div> 
```

有什么建议么？目前它只显示`$cert_mess`为“make”并忽略 if / else if 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:48:36.603

更简单的代码如下：

```
$cert_mess = $vehicle['make'];
if (($vehicle["make"] == "Honda" && $vehicle["Certified"] == "0")
    || ($vehicle["make"] == "Cadillac" && $vehicle["Certified"] == "0")
    || !in_array($vehicle['make'], array('Cadillac','Honda'))
) {
    $cert_mess = "DFWCertAutos";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:53:39.833

更简单：

```
$cert_mess = $vehicle['make'];
if (!in_array($vehicle['make'], array('Cadillac', 'Honda')) || $vehicle['certified'] == '0')
{
    $cert_mess = 'DFWCertAutos';
} 
```

# jquery - 使用 jquery click 事件创建动态 iframe

> ID：10610871
> 
> 赞同：1
> 
> 时间：2012-05-16T01:24:15.350
> 
> 标签：jquery, events, iframe, dynamic, click

当我像这样动态创建 iframe

```
$( '<iframe/>' )
    .attr('id', 'aaoifr0')
    .attr('src', aPageName)
    .appendTo(_public.content); 
```

`body`并向iframe中的元素添加点击事件

```
$('#aaoifr0')
    .contents().find('body').click(function(){ alert(0) }); 
```

这没用。

但是，如果我在显示 iframe 后通过 firebug 手动添加事件，如下所示：

```
$('#aaoifr0').contents().find('body').click(function(){ alert(0) }); 
```

它工作正常！

我尝试了几种方法来检查 iframe 内容的加载同步/异步，但找不到有用的答案。任何想法如何使这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:16:11.437

好的，解决了。。

解决方法是使用`.load()`JQuery 创建框架对象的方法。

**注意：**不要使用`.ready()`，它会引用父文档。您可以通过以下方式对其进行测试：

```
$('<iframe/>')
  .attr('id', 'someId')
  .attr('src', 'aPageSrc')
  .appendTo(_public.content)
  .load(function() {
    $(this).contents().find('body').click(function() {
      alert('Loaded!');
    });
  })
  .ready(function() {
    $(this).contents().find('body').click(function() {
      alert('Ready!');
    });
  }); 
```

这很难想象，我希望接下来的很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:33:42.957

你可以试试

```
$('<iframe id="aaoifr0" src="' + aPageName  + '"></iframe>') 
```

同样，当您附加 jquery 对象时，您需要附加到另一个 jquery 对象，而不是对象的内容，_public.content 可能是一个问题，这取决于它是什么对象。尝试更安全

```
$('<iframe id="aaoifr0" src="' + aPageName  + '"></iframe>').appendto( $('document.body') ); 
```

我认为使用 iframe 我有一个问题添加

```
<iframe /> 
```

你需要

```
<iframe></iframe> 
```

如果 iframe src 来自同一个域，jquery 也只能访问 iframe 内容。但由于萤火虫的作品，它不应该是一个问题

不知道这是否有帮助，让我知道是否还有其他问题。

# javascript - 无法让 jasmine.any(Function) 工作

> ID：10610874
> 
> 赞同：23
> 
> 时间：2012-05-16T01:25:03.573
> 
> 标签：javascript, jasmine

我创建了一个完整的简化示例来复制我遇到的问题。

```
function TestObj() {
    var self = this;
    self.getStuff = function(aString, callback) {
        // TODO
    }
}

describe("server communications", function() {
    it("it calls the server", function() {
        var obj = new TestObj();
        obj.getStuff = jasmine.createSpy();
        // swap the above line for this and it makes no difference
        // spyOn(obj, "getStuff");

        var functionVar = function() {
        };

        obj.getStuff("hello", functionVar);

        expect(obj.getStuff).toHaveBeenCalledWith(
                [ "hello", jasmine.any(Function) ]);
    });
}); 
```

我没有通过单元测试，而是得到以下输出：

> 预期 spy 被调用为： [ [ 'hello',<jasmine.any(function Function() { [native code] })> ] ] 但被调用为： [ [ 'hello', Function ] ]

为什么不承认我传入的函数 (function (){}) 实际上是函数？它所期望的本机代码是什么？jasmine.any(Function) 还有其他人有这个问题吗？谢谢！

**已编辑**

我尝试使用 spyOn 而不是 jasmine.createSpy() 并没有什么区别。我只尝试了一个参数并且它有效。引入第一个字符串参数会破坏 jasmine.any(Function) - 有什么想法吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-17T00:50:34.833

啊，我以为你必须将 的论点括`expect().toHaveBeenCalledWith`在一个`Array[]`. 傻我。这是一个工作版本：

```
function TestObj() {
    var self = this;
    self.getStuff = function(aString, callback) {
        // TODO
    }
}

describe("server communications", function() {
    it("it calls the server", function() {
        var obj = new TestObj();
        obj.getStuff = jasmine.createSpy();
        // swap the above line for this and it makes no difference
        // spyOn(obj, "getStuff");

        var functionVar = function() {
        };

        obj.getStuff("hello", functionVar);

        expect(obj.getStuff).toHaveBeenCalledWith("hello", jasmine.any(Function));
    });
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-16T08:46:29.093

问题是您创建间谍的方式，使用`spyOn`似乎按预期工作：

```
describe("test", function() {
  return it("is function", function() {
    var a = {b: function(){}};
    spyOn(a, 'b');
    a.b(function(){});
    expect(a.b).toHaveBeenCalledWith(jasmine.any(Function));
  });
}); 
```

您还可以[编写自己的 Matcher](https://github.com/pivotal/jasmine/wiki/Matchers)来测试传递的值是否是函数：

```
describe('test',function(){
  it('is function',function(){

    this.addMatchers({
      isFunction: function() {
        return typeof this.actual  === 'function';
      }
    });
    expect(function(){}).isFunction();
  });
}); 
```

**已编辑：**编纂了第一个代码块

# mysql - MySQL pid 结束（无法启动 mysql）

> ID：10610875
> 
> 赞同：32
> 
> 时间：2012-05-16T01:25:31.913
> 
> 标签：mysql, database, macos, mysql-error-1064

我有一个全新安装的 MySQL (mysql-5.5.24-osx10.6-x86_64)。我在使用 Mac Pro 四核的 Lion (OS 10.7.4)。我安装了 MySQL GUI 安装程序，还安装了 pref 窗格和启动项。

但是，当我运行时：

```
sudo ./bin/mysqld_safe 
```

我收到这条消息：

```
120515 17:58:19 mysqld_safe Logging to '/usr/local/mysql-5.5.24-osx10.6-x86_64/data/Dannys-Mac-Pro.local.err'.
120515 17:58:19 mysqld_safe Starting mysqld daemon with databases from /usr/local/mysql-5.5.24-osx10.6-x86_64/data
120515 17:58:20 mysqld_safe mysqld from pid file /usr/local/mysql-5.5.24-osx10.6-x86_64/data/Dannys-Mac-Pro.local.pid ended 
```

我也无法从首选项窗格启动 MySQL。

根据今天的谷歌搜索和研究时间，这是我迄今为止所尝试的：

**权限问题？**

[这个：](https://stackoverflow.com/a/9643282/819276)

```
cd /usr/local
sudo chown mysql mysql
sudo chown mysql mysql-5.5.24-osx10.6-x86_64
sudo chown _mysql mysql
sudo chown _mysql mysql-5.5.24-osx10.6-x86_64 
```

和

```
sudo chown -R /usr/local/mysql-5.5.24-osx10.6-x86_64/
sudo chown -R /usr/local/mysql 
```

[这个：](https://stackoverflow.com/a/5124022/819276)

```
sudo chown -R root:wheel /Library/StartupItems/MySQLCOM 
```

**链接问题？**

[这个：](https://stackoverflow.com/a/4755143/819276)

在 /usr/local/mysql/support-files/mysql.server - 我做了：

```
basedir="/usr/local/mysql"
datadir="/usr/local/mysql/data" 
```

> 在文件 /etc/rc.common 的末尾添加以下行：/usr/local/mysql/bin/mysqld_safe --user=mysql &

[这个：](https://stackoverflow.com/a/3263280/819276)

```
sudo ln -s /usr/local/mysql-5.5.24-osx10.6-x86_64 /usr/local/mysql 
```

我也尝试了[这里的删除过程](https://stackoverflow.com/a/2685337/819276)并重新安装，但这似乎没有什么不同。我还在 OS X 中启动了 Activity Monitor，以查看是否有任何其他 mySQL 进程偶然运行，但实际上没有。

以上没有任何效果，所以我有点不知所措。这是来自 .err 文件的日志，位于：

```
/usr/local/mysql-5.5.24-osx10.6-x86_64/data/Dannys-Mac-Pro.local.err

120515 18:07:43 mysqld_safe mysqld from pid file /usr/local/mysql-5.5.24-osx10.6-x86_64/data/Dannys-Mac-Pro.local.pid ended
120515 18:13:01 mysqld_safe Starting mysqld daemon with databases from /usr/local/mysql-5.5.24-osx10.6-x86_64/data
120515 18:13:01 [Warning] Setting lower_case_table_names=2 because file system for /usr/local/mysql-5.5.24-osx10.6-x86_64/data/ is case insensitive
120515 18:13:01 [Note] Plugin 'FEDERATED' is disabled.
/usr/local/mysql-5.5.24-osx10.6-x86_64/bin/mysqld: Table 'mysql.plugin' doesn't exist
120515 18:13:01 [ERROR] Can't open the mysql.plugin table. Please run mysql_upgrade to create it.
120515 18:13:01 InnoDB: The InnoDB memory heap is disabled
120515 18:13:01 InnoDB: Mutexes and rw_locks use GCC atomic builtins
120515 18:13:01 InnoDB: Compressed tables use zlib 1.2.3
120515 18:13:01 InnoDB: Initializing buffer pool, size = 128.0M
120515 18:13:01 InnoDB: Completed initialization of buffer pool
120515 18:13:01 InnoDB: highest supported file format is Barracuda.
120515 18:13:01  InnoDB: Waiting for the background threads to start
120515 18:13:02 InnoDB: 1.1.8 started; log sequence number 1595675
120515 18:13:02 [ERROR] /usr/local/mysql-5.5.24-osx10.6-x86_64/bin/mysqld: unknown option '--skip-locking'
120515 18:13:02 [ERROR] Aborting

120515 18:13:02  InnoDB: Starting shutdown...
120515 18:13:03  InnoDB: Shutdown completed; log sequence number 1595675
120515 18:13:03 [Note] /usr/local/mysql-5.5.24-osx10.6-x86_64/bin/mysqld: Shutdown complete

120515 18:13:03 mysqld_safe mysqld from pid file /usr/local/mysql-5.5.24-osx10.6-x86_64/data/Dannys-Mac-Pro.local.pid ended 
```

**更新：**我将同一台机器从 Snow Leopard 升级到 Mountain Lion 10.8.1 并且 MySQL 现在在升级后工作得非常好，我不需要做任何额外的事情。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T08:16:35.447

在为我的 MAC OS 10.7.5 安装 mysql 最新版本 mysql-5.6.10-osx10.7-x86.dmg 时，我遇到了同样的问题。以下是我的解决方案。一、删除安装的mysql

```
sudo rm /usr/local/mysql
sudo rm -rf /usr/local/mysql*
sudo rm -rf /Library/StartupItems/MySQLCOM
sudo rm -rf /Library/PreferencePanes/My*
sudo rm -rf ~/Library/PreferencePanes/My*
sudo rm -rf /Library/Receipts/mysql*
sudo rm -rf /Library/Receipts/MySQL*
sudo rm -rf /var/db/receipts/com.mysql.* 
```

然后，获取[mysql-5.1.68-osx10.6-x86.dmg](http://dev.mysql.com/downloads/mysql/5.1.html)，安装这个旧版本，大功告成！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-30T13:07:44.773

正如@AndPy 所说，与我一样，如果您可以看到该文件`ls -l`属于或某些此类...。在这种情况下，只需删除该文件并将创建您的用户拥有的新文件并正确启动时间 ：）`/usr/local/var/mysql``COMPUTER-NAME.local.err``_mysql``mysql.server start`

如果该文件已由您的用户拥有，这将无济于事，您必须谷歌更多:(

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-13T15:37:34.490

更新到 OS X Mavericks 后我遇到了同样的问题。

> 启动 MySQL 。错误！服务器退出但不更新 PID 文件

就像[Redrick](https://stackoverflow.com/users/980430/redrick)和[AndPy](https://stackoverflow.com/users/1298277/andpy)提到的那样，我还必须重命名（实际上我删除了文件）位于`$ cd /usr/local/var/mysql`. 我的错误文件被称为`localhost.err`. 删除文件后，`$ rm localhost.err`我终于可以使用`$ mysql.server start`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-19T15:45:14.273

我在 redmine bitnami 堆栈上发现了这个错误，因为目录数据中的文件所有者不正确。

检查目录/mysql/data/的所有者必须是'mysql'用户

希望这有帮助。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-17T11:08:57.370

我有同样的问题。

在 /usr/local/var/mysql 中，我找到了 COMPUTER-NAME.local.err 形式的文件。只需更改该文件名即可解决问题。我现在可以启动mysql服务器了

> mysql.server 启动

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-06-24T18:01:24.607

我的回答与其他人非常相似，但略有不同，这主要适用于 bitnami mamp 堆栈。我的解决方法是：

`sudo chown -R mysql mysql/`

该`mysql/`目录位于`Applications/<mampstack-version>/`

上面将mysql设置为mysql目录的所有者，递归到其他目录。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-24T20:01:05.053

如果你想让这件事完全正常工作，请执行以下操作：

您需要先卸载 mysql，但在执行此操作之前，请确保您备份了所有数据库。

`brew remove mysql`

然后您需要确保某些文件已卸载，制作以下命令的批处理脚本并运行它：

```
sudo rm /usr/local/mysql
sudo rm -rf /usr/local/var/mysql
sudo rm -rf /usr/local/mysql*
sudo rm ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
sudo rm -rf /Library/StartupItems/MySQLCOM
sudo rm -rf /Library/PreferencePanes/My*
launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
rm -rf ~/Library/PreferencePanes/My*
sudo rm -rf /Library/Receipts/mysql*
sudo rm -rf /Library/Receipts/MySQL*
sudo rm -rf /private/var/db/receipts/*mysql* 
```

转到`/etc/hostconfig`使用您喜欢的编辑程序并删除该行`MYSQLCOM=-YES-`

然后运行`brew cleanup`然后使用安装mysql`brew install mysql`

完成此操作后，您可能会再次遇到相同的错误。前往文件夹`cd /usr/local/var/mysql/`。里面应该有一个文件叫做`localhost.local.err`

运行`cat ./localhost.local.err`并查看文件。您应该会看到类似于以下内容的内容：

`2018-03-24 15:41:49 140735679804288 [ERROR] Can't start server: Bind on TCP/IP port. Got error: 48: Address already in use`

`2018-03-24 15:41:49 140735679804288 [ERROR] Do you already have another mysqld server running on port: 3306 ?`

如果你这样做了，运行命令`sudo lsof -i :3306`，你可能会得到这样的结果：

`COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME mysqld 74 _mysql 20u IPv6 0xXXXXXXXXXXXXX 0t0 TCP *:mysql (LISTEN)`

这意味着 mysql 已经在 3306 端口上运行和监听，你需要杀死它。用于`top`杀死程序或仅使用活动监视器将其杀死。无论哪种方式，一旦完成，请返回`cd /usr/local/var/mysql/`并删除文件夹`localhost.local.err`。

完成后运行 mysql.server start ，您应该得到以下信息：

`180324 15:46:18 mysqld_safe Starting mysqld daemon with databases from /usr/local/var/mysql SUCCESS!`

恭喜。我一直在尝试解决这个问题一个星期，这是一个很容易解决的问题，我只是想通了。我恨我自己。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-19T17:22:07.347

120515 18:13:01 [错误] 无法打开 mysql.plugin 表。请运行 mysql_upgrade 来创建它。

*   关于这个错误，我假设你在 my.cnf 中指定了一个 datadir。如果您使用 MySQL 的非默认数据目录，则需要将文件夹 mysql 和 performance_schema（以存在者为准）移动到 my.cnf 中指定的数据目录。您可以在 mysql 目录中找到这些文件夹。

在 MySQL 5.5+ 中删除了 --skip-locking 选项。请改用 --skip-external-locking。请参阅 MySQL 文档 --> [http://dev.mysql.com/doc/refman/5.5/en/mysql-nutshell.html](http://dev.mysql.com/doc/refman/5.5/en/mysql-nutshell.html) 引用：“--enable-locking 和 --skip-locking 服务器选项（使用 - -external-locking 和 --skip-external-locking）。”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-25T03:45:08.590

试一试。。

1.  导航到问题的父目录`cd YOURPATH/usr/local/mysql`
2.  `rm -rf *.local.err`（删除文件）
3.  `touch YOURUSERNAME.local.pid`（生成新的 *.local.pid 文件引发的错误抱怨）
4.  cd 回到你的项目并使用重启 mysql`mysql.server start`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-25T07:56:21.213

仅删除/usr/local/var/mysql/ 中的**mysql-bin.index文件对我有帮助。**

# javascript - HTML5 Canvas 替代 Spritely？

> ID：10610876
> 
> 赞同：1
> 
> 时间：2012-05-16T01:26:08.577
> 
> 标签：javascript, html

我使用了一个名为[http://spritely.net/](http://spritely.net/)的 JQuery 库来创建图像动画，但在移动设备上的性能似乎让 JQuery 看起来是个糟糕的选择。我很想知道是否有人可以使用 HTML5/JS 来实现相同的效果，但可能对移动设备更友好一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T06:23:11.740

虽然我个人没有在任何移动应用程序中使用过，但 Createjs 是一个不错的选择。 [http://createjs.com/#!/CreateJS](http://createjs.com/#!/CreateJS)。这实际上是一个非常容易使用的框架。

这里有一个使用这个框架的好例子。

[http://www.mikechambers.com/blog/2011/02/02/pixelflow-easeljs-canvas-dynamic-graphics-example/](http://www.mikechambers.com/blog/2011/02/02/pixelflow-easeljs-canvas-dynamic-graphics-example/)

# asp.net - asp.net 正则表达式验证器难题

> ID：10610877
> 
> 赞同：0
> 
> 时间：2012-05-16T01:26:25.423
> 
> 标签：asp.net, regex, validation

输入'12'，点击按钮，a为假，b为真...注意EnableClientScript设置为假。

* * *

```
<asp:TextBox ID="TextBox1" runat="server"
     Width="20px" MaxLength="3"></asp:TextBox>
<asp:RegularExpressionValidator ID="RegularExpressionValidator1"
     runat="server" EnableClientScript="false" ControlToValidate="TextBox1"
     ErrorMessage="RegularExpressionValidator"
     ValidationExpression="([1-9]|[1-9][0-9]|[1-9][0-9][0-9])"
     ForeColor="Red"><sup>invalid</sup></asp:RegularExpressionValidator>
<asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="Button" /> 
```

* * *

```
protected void Button1_Click(object sender, EventArgs e)
{
  Page.Validate();
  bool a = RegularExpressionValidator1.IsValid;
  bool b = System.Text.RegularExpressions.Regex.IsMatch(TextBox1.Text,
             RegularExpressionValidator1.ValidationExpression);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T07:54:50.067

替换`ValidationExpression`为：

```
ValidationExpression="^([1-9]|[1-9][0-9]|[1-9][0-9][0-9])$" 
```

# css - .clearfix 类与 :after

> ID：10610878
> 
> 赞同：1
> 
> 时间：2012-05-16T01:26:37.653
> 
> 标签：css

向左浮动元素时哪个更好？

使用通用 .clearfix 类：

```
.clearfix:after{
  content:".";
  display:block;
  clear:both;
  visibility:hidden;
  line-height:0;
  height:0;
} 
```

您可以重复使用并将其应用于容器元素：

```
 <div class="some-section clearfix">
     <div class="align-left"> left </div>
     <div class="align-right"> right </div>
   </div>

   <div class="some-other-section clearfix">
     <div class="align-right"> right </div>
   </div> 
```

或特定的清算规则，例如：

```
.some-section:after, some-other-section:after{
  content:".";
  display:block;
  clear:both;
  visibility:hidden;
  line-height:0;
  height:0;
} 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:35:33.360

我个人更喜欢 .clearfix，因为它拥有最多的浏览器支持——IE6&7 不支持 :after 选择器。此外，您可以在一处定义清算属性，并将类添加到您需要使用它们的任何地方。如果您继续在每个元素的基础上使用 :after，您将以大量重复的 CSS 结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:35:40.983

也没有，真的。Internet Explorer 7 和更早的版本不支持伪元素，所以我使用的是：

```
.clearfix {
    clear: both;
} 
```

和

```
<br class="clearfix" /> 
```

它几乎是语义化的，即使在 IE 6 中也可以工作，而且非常干净整洁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T01:45:03.037

使用`:after`，必须考虑跨浏览器问题。如果我们要为所有浏览器提供支持，包括旧的，伪元素可能不是方式：

[CSS 选择器和伪选择器浏览器兼容性](http://kimblim.dk/css-tests/selectors/)

* * *

与**通用类** *与* **特定类相关**

**根据定义：**

通用**类**可以应用于标记中的任何元素，最适合与所有元素都支持的通用格式化指令一起使用，或者用于需要在多种类型的元素上使用的格式化指令。

**特定类**通过仅应用于标记中的特定元素来达到其目的，最适合格式化仅特定于一种类型元素的指令。

**^(使用泛型类而)**不是特定类的目标是：****

 **1.  更清洁的标记
2.  再利用
3.  较小的文件（浏览器内容下载性能）
4.  易于维护或更新**

# java - Jsoup连接501错误

> ID：10610881
> 
> 赞同：0
> 
> 时间：2012-05-16T01:27:22.970
> 
> 标签：java, android, jsoup

如何与 Jsoup 建立连接以填写和发送表格？

该网站看起来与此类似：

```
 <form action="the.form" method="post"
                enctype="application/x-www-form-urlencoded"
                name="start_form"
                autocomplete="off">
             <input type="hidden" value="8F5EB4CD93CAB4E093EF7C1C733791FC" name="session" />
             <input type="text" value="" name="number" />
             <div class="right">
                <input type="submit" name="submit" value="Submit" />
             </div>
          </form> 
```

我尝试了什么：

```
 Document doc = Jsoup.connect(DUMMY_URL).data("number", "123456789", "session", 
"6F80A198EC4B46B4848897A33ACAC3E8").header("Content-Type","application/x-www-form-urlencoded").userAgent("Mozilla").post(); 
```

结果：

```
Exception in thread "main" java.io.IOException: 501 error loading URL https://www.theurl.com
    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:414)
    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:391)
    at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:157)
    at org.jsoup.helper.HttpConnection.post(HttpConnection.java:152)
    at Test.main(Test.java:17) 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:18:35.937

我已经在[这个线程](https://stackoverflow.com/questions/7139178/jsoup-cookies-for-https-scraping/10533366#10533366)上回答了这个问题。

如果您还有任何疑问，请询问。

# jquery - HTML5 Textarea Max-Length 提前结束

> ID：10610882
> 
> 赞同：0
> 
> 时间：2012-05-16T01:28:05.253
> 
> 标签：jquery, html, mobile, textarea, maxlength

我正在尝试在带有 jQ​​uery Mobile 的 textarea 中使用 max-length，但我遇到了一个奇怪的问题 - 问题是无论是否在 javascript 中使用 return false，textarea 都会阻止我输入 15 到 60 之间的文本人物太早了。。

maxLength 属性设置为 1150，我可以输入 1090 到 1115 个字符。我不知道它是否是使用复制和粘贴的功能，因为这是我测试过的唯一方法，但看起来很奇怪。

这是代码：

```
$(document).delegate('#main','pageinit',function() {
    $('#title,#description').keypress,function(e){

        var cur=$(this).val().length,
        max=$(this).prop('maxLength'), rem=max-cur,
        ch=$(this).parents('.ui-bar').find('.char-rem'),
        red=$(this).parents('.ui-bar').find('.char-rem.red'),           
        green=$(this).parents('.ui-bar').find('.char-rem.green');

        ch.children('span').html(rem);

        if(rem <= 10)
        {
            green.removeClass('green')
            ch.addClass('red');
        } else {    
            red.removeClass('red')
            ch.addClass('green')
        }
        if(rem == 0)
        {
            if(e.which!= 8)
            {
                return false;
            }
        }

    })
}) 
```

每次都会发生的情况是，我只剩下少量的字符——但多于零——我不能再打字了。如果我删除以下内容，也会发生同样的事情：

```
if(rem == 0)
{
    if(e.which!= 8)
    {
        return false;
    }
} 
```

我也尝试过使用 keydown 和 keyup 以及在 pageinit 内部或外部进行此操作，并进行了各种其他调整，并且我已经使用 textarea textLength 属性验证了 textarea 中的字符数，并且每次结果都是相同的。

现在，我正在使用 Chromium 来测试这个，我还没有在其他地方测试过，但我想看看是否有我遗漏的东西。

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T13:45:48.147

My previous note about the line breaks wasn't the answer. The answer was that each time the function got called, it was reading the maxLength property newly. For some reason, in reading the maxLength property, the count was getting messed up.

When I switched the variable for the maxLength value to a number (1150) instead of a making it read the property, it worked perfectly.

**EDIT WITH REAL ANSWER:**

Actually, the real answer was that I had unclosed html tags, so who knows what it was doing. When I fixed the tags, all was well

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T10:20:15.527

这是一个替代解决方案。有了这个 maxlength 也可以用于 textareas。

```
/*****************************/
// SET MAX NUMBER OF CHARACTERS FOR ALL TEXTAREAS TROUGH ATTRIBUTE maxlength="*"
jQuery('textarea[maxlength]').keyup(function(){  
  //get the limit from maxlength attribute  
  var limit = parseInt($(this).attr('maxlength'));  
  //get the current text inside the textarea  
  var text = $(this).val();  
  //count the number of characters in the text  
  var chars = text.length;  
  //Create counter, once
  if (!jQuery(this).prev("span").length) {
    jQuery(this).before('(Tecken <span class="charsleft"></span> av max ' + limit + ')');
  }
  //Update counter
  jQuery(this).prev('.charsleft').html(chars); 
  //check if there are more characters then allowed  
  if(chars > limit){  
  //and if there are use substr to get the text before the limit  
  var new_text = text.substr(0, limit);  
  //and change the current text with the new text  
  jQuery(this).val(new_text);  
  }  
});  
/*****************************/ 
```

# ruby-on-rails - 通过引用更新属性

> ID：10610883
> 
> 赞同：1
> 
> 时间：2012-05-16T01:28:10.743
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想知道是否可以引用对象的属性。

对象 User 有属性`first_name`，所以通常如果我们想更新名字属性，我们会这样做：

```
user0 = User.new()
user0.update_attribute(:first_name, "joe") 
```

现在我的问题是我可以`:first_name`像这样通过另一个变量/符号更新属性：

```
user0.update_attribute(:fname_ref, "jack")
user0.first_name  #=> has the value jack 
```

我一直在寻找像 Perl 中的变量引用，但在 Ruby 中一无所获。

- - - - - 编辑

我正在做 lynda ruby​​ on rails 教程，并且正在创建一个模块来调整表格中项目的位置。不幸的是，当我第一次开始时，我以不同的方式命名了我的表格列 `pages.page_position, subjects.subject_position, sections.section_position`

现在模块 PositionMover 将用于三个模型，所以现在我遇到了一个问题，因为每个模型的属性名称都不同

所以我想不用担心我会为每个模型创建一个指针/引用

`:position = :pages_position , :position = :subjects_position , :position = :section_position`

因此问题是，如果它甚至可能做到这一点。

如果不可能，任何建议我应该怎么做，所以该模块可以用于三个不同的模型，具有不同的属性名称。

对不起，我是新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:54:23.727

符号不像变量，它们实际上是一种对象类型，例如 String 或 Fixnum，因此您可以拥有一个符号类型的变量。

我认为这就是你要找的：

```
attribute = :first_name
user0.update_attribute(attribute, "jack")
user0.first_name  #=> has the value jack 
```

**更新：**如果你有一个字符串并且需要转换为一个符号，（我不确定你是否需要这个`update_attribute`）

```
foo = "string"
foo.to_sym #=> :string 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T05:52:30.907

使用**alias_attribute**。定义到每个模型中，如：

**页面模型**

别名属性：位置，：页面位置

**主题模型**

别名属性 :position , :subjects_position

**剖面模型**

别名属性 :position , :section_position

并将 (Model.position = values) 与每个模型一起使用。希望它可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T04:19:34.240

[请参阅github](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/persistence.rb#L161)`update_attribute`上`ActiveRecord::Persistence`模块中的定义：

```
def update_attribute(name, value)
  name = name.to_s
  verify_readonly_attribute(name)
  send("#{name}=", value)
  save(:validate => false)
end 
```

这使我相信您可以将以下内容添加到您的模型中以实现该行为：

```
alias_method :fname_ref= :first_name= 
```

我很想知道您为什么要按照@Andrew Marshall 的要求这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T02:10:16.107

您还可以使用`send` [文档](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)并使用符号或字符串来引用属性的方法。`send`可能非常有用，因为它使您能够选择将在运行时调用的方法。

例如

```
user.first_name = "Jack" # set first_name to Jack
                         # Note: method "first_name=" (a settor) is being used    

attribute = "first_name"
user.send attribute + "=", "Jack" # set first_name to Jack
                                  # The string "first_name=" is coerced into
                                  # a symbol

attribute = :first_name
val = user.send attribute # => returns "Jack" 
```

# android - AndEngine：是否有任何文件或在线阅读网站可以详细描述 AndEngine？

> ID：10610889
> 
> 赞同：0
> 
> 时间：2012-05-16T01:29:15.293
> 
> 标签：android, andengine

是否有任何文件或在线阅读网站可以详细描述 AndEngine？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T12:15:13.193

不，我们都主要通过反复试验、堆栈溢出和谷歌搜索来学习。你可以在官方论坛上找到一些答案，但我在那里提问时运气不佳。另请参阅此[非官方 wiki](http://andengine.wikidot.com/)和[官方](http://wiki.andengine.org/)wiki 。还有很多教程散落在各个博客上。

如果您打算使用物理，有许多适用于 AndEngine 的物理扩展的 Box2D 引擎资源，除了编程不是用 C++ 而是用 Java 完成的。请参阅[Box2D 手册](http://www.box2d.org/manual.html)。

# c# - 在 DataGridView 中更改列的有效方法

> ID：10610892
> 
> 赞同：1
> 
> 时间：2012-05-16T01:30:26.327
> 
> 标签：c#, datagridview

您好，我有一个空的 DatagridView，它在我开始向其中添加行之前被禁用。我有一个组合框，它有两个可选选项，用于控制要加载到其中的信息并改变其中的列。现在在组合框的 SelectionChanged 事件中，我有类似的内容：

```
if (defaultComboBox.SelectedIndex == 0)
   {
   if (extractionDataGrid.Columns.Contains(companyIDColumn))
      {
         extractionDataGrid.Columns.Remove(companyIDColumn);
         extractionDataGrid.Columns.Remove(companyNameColumn);
         extractionDataGrid.Columns.Remove(maintenanceColumn);
         extractionDataGrid.Columns.Remove(simColumn);
      }

      extractionDataGrid.Columns.Add(userNameColumn);
      extractionDataGrid.Columns.Add(departmentColumn);
      extractionDataGrid.Columns.Add(officePhoneColumn);
      extractionDataGrid.Columns.Add(officePhontExtColumn);
      extractionDataGrid.Columns.Add(otherPhoneColumn);
. [18 columns]
.
.
. 
```

而对于选定的索引 1 则相反。这里有很多列，并试图想办法避免使用大量代码来初始化新的 datagridview 列、调整标题文本、调整自动大小模式和各种其他参数。此外，当我在所选索引之间来回切换时，这实际上每次都会以不同的顺序添加列。它们应该按照我在这里设置的顺序添加？？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:20:05.670

1.  将所有 0 索引列添加到列表
2.  将所有 1 个索引列添加到另一个列表
3.  将列列表传递给您创建的新方法，该方法迭代列表以根据需要添加或删除。
4.  在您的添加/删除方法上放置一个同步锁。这可能是导致出现不同订单的原因

    extractDataGrid.Columns.Remove(companyIDColumn);

即在网格完全更新之前满足条件。或者更改条件，使其独立于列顺序，并检查仅在添加和或删除所有列之后设置的变量。

IE

```
switch (gridMode){
  case GridMode.Company:
   this.AddColumns(userColumnList);
   gridMode = GridMode.User;
   break;
  case GridMode.User:
   this.AddColumns(userColumnList);
   gridMode = GridMode.Company;
   break;
}

protected void AddColumns(List<Column> adds){
  extractDataGrid.Layout.Suspend();
  extractionDataGrid.Columns.Clear();
  foreach(Column c in adds){
   extractionDataGrid.Columns.Add(c); 
  }
extractDataGrid.Layout.Resume();
} 
```

或者，如果可以的话，不要删除列，而是关闭可见性。

# wpf - wpf中observablecollection的数据绑定并以特殊顺序填充gui

> ID：10610893
> 
> 赞同：1
> 
> 时间：2012-05-16T01:30:27.560
> 
> 标签：wpf, xaml, data-binding, collections, itemscontrol

我正在尝试尽可能多地使用数据绑定来创建我的 gui。在那里，我收集了一些频道，这些频道也有步骤列表。我所知道的是将这些集合绑定到 xaml 元素并按以下顺序显示它们：

```
Channel1 step1 step2 step3 step4
Channel2 step1 step2 step3 step4 
```

我用这样的嵌套 ItemsControls 尝试了它：

```
<ItemsControl ItemsSource="{Binding Path=channels}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <ItemsControl ItemsSource="{Binding Path=steps}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                             <GUI:stepAnalog></GUI:stepAnalog>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

但我所取得的只是对元素进行排序，例如：

```
channel1 step1 step2 step3 channel2 step1 step2 step3 
```

或者

```
channel1
step1
step2
step3
channel2
step1
step2
step3 
```

wpf 中是否有仅使用数据绑定的解决方案，或者我是否必须通过迭代元素并放置它们以编程方式进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:05:51.853

总有解决办法的，只要找到合适的就行了！

我建议您像这样玩 ItemsControls 的 ItemsPanel：

```
<ItemsControl ItemsSource="{Binding Path=channels}"> 
        <!-- This specifies that the items in the top level items control should be stacked vertically-->
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Vertical"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
<ItemsControl.ItemTemplate> 
    <DataTemplate> 
            <ItemsControl ItemsSource="{Binding Path=steps}"> 
                <!-- This specifies that the items in the second level items control should be stacked horizontally-->
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>               
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate> 
                     <DataTemplate> 
                         <GUI:stepAnalog></GUI:stepAnalog> 
                    </DataTemplate> 
                </ItemsControl.ItemTemplate> 
            </ItemsControl> 
    </DataTemplate> 
</ItemsControl.ItemTemplate> 
```

这允许您指定项目控件中的项目的布局方式，并且您仍然可以使用 DataTemplate 来定义它们的显示方式

# macos - 在双显示器上使用 applescript 定位窗口

> ID：10610894
> 
> 赞同：0
> 
> 时间：2012-05-16T01:30:34.953
> 
> 标签：macos, applescript

我有 2 个我写的空中应用程序。他们在 10 秒后自动全屏显示。在此之前，需要将它们发送到适当的显示器。“app_1”需要在显示器 1 上运行，“app_2”需要在显示器 2 上运行。

本质上，我有这个代码：

```
do shell script "cd /Applications/app_1.app/Contents/MacOS/ ; open app_1;" 
```

这对我来说完美无缺。这两个应用程序都是以这种方式启动的，并且有一些代码可以确保这些应用程序尚未打开，并在它们打开时关闭它们。

我尝试在启动后添加脚本来定位应用程序：

```
do shell script "cd /Applications/app_1.app/Contents/MacOS/ ; open app_1;"
tell first window of application "app_1" to set bounds to {0,0,1920,1080} 
```

这给了我一个错误：

```
app_1 got an error: Can't set bounds of window 1 to {0,0,1920,1080} 
```

我尝试在启动之前添加几秒钟的延迟`set bounds`，以防应用程序在启动时尚未启动`set bounds`，但这并没有改变任何东西。

我还尝试将边界设置为`{100,100,200,200}`仅查看屏幕坐标是否错误之类的东西，但仍然是完全相同的错误，只是使用了`{100,100,200,200}`1920x1080 坐标而不是原始的 1920x1080 坐标。

有人对此有任何见解吗？几个小时以来，我一直在尝试在谷歌上找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:25:07.893

听起来您的应用程序没有公开标准的“窗口”类。我不知道 AIR 应用程序是否应该自动处理这个问题并且它不起作用——如果是这样，你会想要调试它。

但另一种选择是使用 UI 脚本在外部控制其窗口。而不是这个：

```
tell first window of application "app_1" to set bounds to {0,0,1920,1080} 
```

做这个：

```
tell application "System Events"
  set position of first window of application process "app_1" to {0, 0}
  set size of first window of application process "app_1" to {1920,1080}
end tell 
```

但是，这只有在您进入“系统偏好设置”的“通用访问”面板并选中“启用辅助设备访问”（或通过 API、“sudo touch /var/db/.AccessibilityAPIEnabled”等）完成时才有效。 ）。

# web-services - 通过 createObject 或 CFINVOKE 将参数传递给 Web 服务

> ID：10610897
> 
> 赞同：0
> 
> 时间：2012-05-16T01:31:21.583
> 
> 标签：web-services, coldfusion, coldfusion-9

我通常使用 CFHTTP 使用 SOAP Web 服务并将 XML 作为 HTTP 参数发布。但是，这一次我尝试使用 使用 webservice `createObject`，但是当我将 XML 作为参数传递给 webservice`ws.someMethod(args);`时，它​​失败了。我尝试使用结构来保存参数值，但这也不起作用。因此，如何传递参数？部分 WSDL 如下

```
 <xs:element name="ORDER">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="Header" type="schemaOne:HeaderType"/>
                    <xs:element maxOccurs="unbounded" name="Detail" type="schemaOne:DetailType"/>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
        <xs:complexType name="DetailType">
            <xs:sequence>
                <xs:element ref="schemaOne:DTORDN"/>
                <xs:element ref="schemaOne:DTRCID"/>
                <xs:element ref="schemaOne:DTPRT"/>
                <xs:element ref="schemaOne:DTQTY"/>
                <xs:element ref="schemaOne:DTNTU"/>
            </xs:sequence>
        </xs:complexType>
        <xs:complexType name="HeaderType">
            <xs:sequence>
                <xs:element ref="schemaOne:DSORDN"/>
                <xs:element ref="schemaOne:DSRCID"/>
                <xs:element ref="schemaOne:DSBFNM"/>
                <xs:element ref="schemaOne:DSBLNM"/>
                <xs:element minOccurs="0" ref="schemaOne:DSBENT"/>
                <xs:element ref="schemaOne:DSBAD1"/>
                <xs:element minOccurs="0" ref="schemaOne:DSBAD2"/>
                <xs:element minOccurs="0" ref="schemaOne:DSBAD3"/>
                <xs:element ref="schemaOne:DSBAD4"/>
                <xs:element ref="schemaOne:DSBSTT"/>
                <xs:element ref="schemaOne:DSBZIP"/>
                <xs:element ref="schemaOne:DSBCNT"/>
             </xs:sequence>
       </xs:complexType> 
```

这是我构建的结构。

```
<cfscript>
  ORDER = {};
  ORDER.Header = {};
  ORDER.Detail = {};
  ORDER.Header.DSORDN = '251716';
  ORDER.Header.DSRCID = 'H';
  ORDER.Header.DSBFNM = 'Joe';
  ORDER.Header.DSBLNM = 'Smith';
  ORDER.Header.DSBAD1 = '4997 County Road';
  ORDER.Header.DSBAD4 = 'Springfield';
  ORDER.Header.DSBSTT = 'MO';
  ORDER.Header.DSBZIP = '49657';
  ORDER.Header.DSBCNT = 'USA';
  ORDER.Detail.DTORDN = '251716';
  ORDER.Detail.DTRCID = 'D';
  ORDER.Detail.DTPRT = '0300604';
  ORDER.Detail.DTQTY = '0000000000001';
  ORDER.Detail.DTNTU = '00000009.9900';
</cfscript> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:15:37.913

我目前正在处理单元测试，并尝试将 xml 文件传递​​给我的 Web 服务。我刚刚将我需要的 xml 文件保存在外部文件中，并在 cfscript 中使用“FileRead”读取它们。我就是这样做的

```
<cfscript>

    input = FileRead("http.....");

    mycomponent = createObject("component", "component.beginning.from.root");
    mycomponent.methodName(input);

</cfscript> 
```

但我不得不更改我的代码，因为在我将 HttpRequest 的内容解析为 xml 以及在哪里寻找预期元素之前。现在我使用传入的文件并立即查找我想要的元素而不是解析，因为它已经是 xml

```
<cfset var body = xmlsearch(arguments.input, "//soapenv:body")[1] /> 
```

如果您对我的网络服务的代码感兴趣，请看[这里](https://stackoverflow.com/questions/10533001/get-all-elements-of-xml-body-and-add-to-struct)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:40:04.247

您必须使用需要复杂数据类型的 SOAP Web 服务，而 CFC 反映了预期的结构，而不是传递 XML。看到[这个](https://web.archive.org/web/20170901104212/http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-78b2.html)

# javascript - 禁用浏览器窗口调整大小

> ID：10610899
> 
> 赞同：13
> 
> 时间：2012-05-16T01:31:52.157
> 
> 标签：javascript, jquery, browser, window-resize

对于初学者......我没有让用户接受弹出窗口或类似内容的险恶意图。我只是想阻止用户调整他们已经导航到的网页的浏览器窗口的大小（这意味着我无权访问/不想使用 window.open();）。我已经研究了很长时间，似乎无法找到一个简单的答案。

我觉得我正走在以下方面的轨道上：

```
 $(window).resize(function() {
     var wWidth = window.width,
     wHeight = window.height;
     window.resizeBy(wWidth, wHeight);
 }); 
```

……无济于事。我不得不想象这是可能的。是吗？如果是这样，我肯定会感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-16T01:37:56.193

你可以先确定一个确定的大小。

```
var size = [window.width,window.height];  //public variable 
```

然后这样做：

```
$(window).resize(function(){
    window.resizeTo(size[0],size[1]);
}); 
```

演示：http: [//jsfiddle.net/DerekL/xeway917/](http://jsfiddle.net/DerekL/xeway917/)

* * *

**问：这不会导致无限循环调整大小吗？- 用户1147171**

好问题。这不会导致调整大小的无限循环。[W3C 规范](http://www.w3.org/TR/DOM-Level-3-Events/#event-type-resize)规定，只有`resize`在调整文档视图大小时才必须调度事件。当该`resizeTo`函数第二次尝试执行时，窗口的尺寸将与刚刚设置的尺寸完全相同，因此浏览器不会触发 resize 事件，因为尺寸尚未更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-18T18:57:20.307

我今天需要这样做（对于由 chrome 扩展打开的面板），但我需要允许用户更改窗口高度，但阻止他们更改窗口宽度

@Derek 的解决方案让我几乎到了那里，但我不得不对其进行调整以允许高度变化，正因为如此，一个无休止的调整大小循环是可能的，所以我也需要防止这种情况发生。这是我对 Dereck 的回答的版本，对我来说效果很好：

```
var couponWindow = {
  width: $(window).width(),
  height: $(window).height(),
  resizing: false
};
var $w=$(window);
$w.resize(function() {
  if ($w.width() != couponWindow.width && !couponWindow.resizing) {
    couponWindow.resizing = true;
    window.resizeTo(couponWindow.width, $w.height());
  }
  couponWindow.resizing = false;
}); 
```

# java - 用java中的递归进行澄清

> ID：10610901
> 
> 赞同：2
> 
> 时间：2012-05-16T01:32:06.963
> 
> 标签：java, recursion

所以一直以来我都认为我的递归问题是理解案例。事实证明，我的问题是理解递归案例的价值。例如，向后打印数组的一部分。

原创尝试

```
 public static void printBackwards(int i, int j, char[] A){
        if(i == j){
            System.out.println(A[i]); 
        }
        else{
            printBackwards(i+1,j,A);
        }

    } 
```

工作尝试

```
 public static boolean printBackwards(int i, int j, char[] A){
    if(i == j){
            System.out.println(A[i]);
            return true;
    }
    else{
            if(printBackwards(i+1,j,A) == true){
                System.out.println(A[i]);
                return true;
            }
            else{
                printBackwards(i+1,j,A);
            }
    }
    return false;
    } 
```

但是，这甚至是有效的递归吗？还是有更好的方法通过它？这是我从写出来看它时唯一能弄清楚的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T02:05:02.053

在我看来，解决这个问题不需要使用递归。你可以用简单的循环来做到这一点。

```
public class PrintBackwards {

    public static void main(String[] args) {
        char[] a = new char[] {'A', 'B', 'C', 'D'};

        for(int i = a.length - 1; i >= 0; i--) {
            System.out.println(a[i]);
        }
    }
} 
```

这背后有什么理由为什么你使用递归？如果没有，像上面的例子那样做起来会更快。

如果你想使用递归，我希望这个例子能让你比你的更容易理解。

```
public class PrintBackwards {

    private static char[] a = new char[]{'A', 'B', 'C', 'D'};

    public static void main(String[] args) {
        printBackwards(0);
    }

    public static void printBackwards(int i) {
        if (i < a.length) {
            printBackwards(++i);
            System.out.println(a[i - 1]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:51:36.360

首先问“我什么时候可以立即解决问题（没有递归调用）？”。在这种情况下，这将是当该区域只有一个元素时——这是你的基本情况。

如果这不是真的，您需要将问题分解为制作一个较小的版本（可以通过调用 printBackwards 来解决）以及完成问题所需的任何内容。您已经有一个将打印 A[i+1..j] 的调用（对于 i 的原始值）。因此，剩下的就是打印 A[i]。弄清楚它是否应该在数组的其余部分之前或之后打印，你就准备好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T02:41:08.060

这是以相反顺序打印数组的 Java 代码：

```
public class TestProgram {

    private int[] a = {4, 2, 7, 1, 9, 5, 8};

    public static void main(String[] args) {
        TestProgram p = new TestProgram();
        p.print(a.length - 1);
    }

    public void print(int i) {
        // the anchor of the recursive method
        // it indicates that we are done printing array
        if (i < 0) 
            return;

        // print the current value
        System.out.printf("%d ", a[i]);

        // recursively call print() method
        print(i - 1);
    }
} 
```

# java - 数组列表和平面文件数据库

> ID：10610904
> 
> 赞同：0
> 
> 时间：2012-05-16T01:32:26.500
> 
> 标签：java

我正在尝试制作一个程序，将字符串列表保存到文件中，然后将它们读入arraylist。这是我当前的代码。

```
ObjectInputStream input = null;

    try {
        input = new ObjectInputStream(new FileInputStream("friends.txt"));
    } catch (FileNotFoundException e) {
        File f = new File("friends.txt");
        try {
            f.createNewFile();
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    String obj;

    try {
        while ((obj = (String)input.readObject()) != null) {
            friendly.add(obj);
        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

这将返回一个空指针异常。我不太确定这里出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:36:00.443

好吧，一方面，如果文件不存在，“输入”将为空。

我不太确定以您的方式处理文件不存在的情况的基本原理是什么 - 为什么不只是通过 File.exists() 测试存在，并且只在存在时执行打开和读取?

除此之外，正如另一位评论员所说，提供一个堆栈跟踪作为开始。

# coffeescript - 咖啡脚本实例变量未定义

> ID：10610906
> 
> 赞同：0
> 
> 时间：2012-05-16T01:32:30.117
> 
> 标签：coffeescript, instance-variables

在我的类的构造函数中，我`PostsPager`将默认值设置`@page`为 0，然后调用 render。但是，当我输入渲染时，@page 现在是未定义的。为什么会这样？

```
class PostsPager
  contructor: (@page=0)->
    render()
    $(window).scroll(@check)

  check: =>
    if @nearBottom()
      @render

  render: =>
    alert @page  # @page = undefined 
```

笏

编辑

编译好的 JS

```
PostsPager = (function() {

    function PostsPager() {
      this.renderPosts = __bind(this.renderPosts, this);

      this.nearBottom = __bind(this.nearBottom, this);

      this.render = __bind(this.render, this);

      this.check = __bind(this.check, this);

    }

    PostsPager.prototype.contructor = function(page) {
      this.page = page != null ? page : 0;
      this.render();
      return $(window).scroll(this.check);
    };

    PostsPager.prototype.check = function() {
      if (this.nearBottom()) {
        return this.render;
      }
    };

    PostsPager.prototype.render = function() {
      alert(this.page);
      this.page++;
      $(window).unbind('scroll', this.check);
      return $.getJSON($('#feed').data('json-url'), {
        page: this.page
      }, this.renderPosts);
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:48:34.227

你拼写不好，`constructor`是构造方法，`contructor`只是拼写不好的方法。您还需要说`@render()`调用`render`作为方法 on `this`。你要：

```
class PostsPager
  constructor: (@page=0)->
    @render()
    #... 
```

演示：http: [//jsfiddle.net/ambiguous/eaQdv/](http://jsfiddle.net/ambiguous/eaQdv/)

这个拼写错误意味着你`contructor`从来没有被调用过，这就是为什么你从来没有看到一个关于“未知渲染变量”的错误，这是由于缺少`@`.

# asp.net - Global.asax 列表自行重置

> ID：10610908
> 
> 赞同：0
> 
> 时间：2012-05-16T01:32:39.590
> 
> 标签：asp.net, global-asax

所以我只是添加了一个将我的网站列入白名单的系统。这是我的 Global.asax。我评论了麻烦的地方

```
#region Application Methods

    private List<string> _approvedIps = new List<string>();

    protected void Application_BeginRequest()
    {
       //This is obviously called afterwards
       //But when I examine the list at a breakpoint the count is 0\. WHY?!?!?
        Debug.WriteLine("User from ip: {0}", Request.UserHostAddress);
        if (!_approvedIps.Contains(Request.UserHostAddress))
        {
            Debug.WriteLine("Unauthorized user. Access Denied");
            Response.Clear();
            Response.StatusCode = (int) HttpStatusCode.Unauthorized;
            Response.End();
        }
    }

    protected void Application_Start()
    {
        string path = Path.Combine(Server.MapPath("~"), "whitelist.txt");
        using (var reader = new StreamReader(path))
        {
            while (reader.Peek() > 0)
            {
                string l = reader.ReadLine(); //Reader here works fine and at a breakpoint
                _approvedIps.Add(l);          //I can see the count of 2
            }
        }
        Database.SetInitializer(new IYCDataDBInit(50));
        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);

        BundleTable.Bundles.RegisterTemplateBundles();
    }

    #endregion 
```

我只是不明白为什么我会遇到这个问题。据我了解，在调用 Application_start 之后，列表应该被填满，然后 _BeginRequest 方法可以访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T02:29:37.037

好的，所以我想通了。我必须使列表静态。我假设每次发出新请求时都会实例化一个新的 Global 类。谁能向我解释为什么 MVC 会这样做？

# ruby-on-rails - 设计：新错误（可加密）

> ID：10610919
> 
> 赞同：12
> 
> 时间：2012-05-16T01:34:55.197
> 
> 标签：ruby-on-rails, devise

我已经有一周没有碰过我的代码了，但是当我捆绑，然后尝试运行我的网络服务器时，我现在得到了以下错误，这让我陷入了困境。包括错误输出中建议的可设计加密 gem 并不能解决问题，并且仍然会导致相同的错误。任何帮助是极大的赞赏。

```
[DEVISE] Devise.apply_schema is deprecated and has no effect. Please remove it.

[DEVISE] To select a encryption which isn't bcrypt, you should use devise-encryp
table gem.

[DEVISE] Devise.use_salt_as_remember_token is deprecated and has no effect. Plea
se remove it.

/Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.1/lib/action_d
ispatch/http/mime_type.rb:101: warning: already initialized constant PDF
[DEVISE] You're trying to include :encryptable in your model but it is not bundl
ed with the Devise gem anymore. Please add `devise-encryptable` to your Gemfile 
to proceed.

/Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib/devise/model
s.rb:96:in `const_get': uninitialized constant Devise::Models::Encryptable (Name
Error)
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/models.rb:96:in `block (2 levels) in devise'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/models.rb:91:in `each'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/models.rb:91:in `block in devise'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/models.rb:122:in `devise_modules_hook!'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/models.rb:89:in `devise'
        from /Users/sa/Documents/AptanaWorkspace/sparkv1/app/models/sa
as_admin.rb:4:in `<class:SaasAdmin>'
        from /Users/sa/Documents/AptanaWorkspace/sparkv1/app/models/sa
as_admin.rb:1:in `<top (required)>'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.
2.1/lib/active_support/inflector/methods.rb:229:in `block in constantize'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.
2.1/lib/active_support/inflector/methods.rb:228:in `each'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.
2.1/lib/active_support/inflector/methods.rb:228:in `constantize'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise.rb:252:in `get'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/mapping.rb:77:in `to'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/mapping.rb:72:in `modules'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/mapping.rb:89:in `routes'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/mapping.rb:156:in `default_used_route'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/mapping.rb:66:in `initialize'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise.rb:286:in `new'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise.rb:286:in `add_mapping'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/rails/routes.rb:207:in `block in devise_for'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/rails/routes.rb:206:in `each'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/devise-2.1.0/lib
/devise/rails/routes.rb:206:in `devise_for'
        from /Users/sa/Documents/AptanaWorkspace/sparkv1/config/routes
.rb:8:in `block in <top (required)>'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.1
/lib/action_dispatch/routing/route_set.rb:272:in `instance_exec'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.1
/lib/action_dispatch/routing/route_set.rb:272:in `eval_block'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.1
/lib/action_dispatch/routing/route_set.rb:249:in `draw'
        from /Users/sa/Documents/AptanaWorkspace/sparkv1/config/routes
.rb:7:in `<top (required)>'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:40:in `block in load_paths'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:40:in `each'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:40:in `load_paths'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:16:in `reload!'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:26:in `block in updater'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.
2.1/lib/active_support/file_update_checker.rb:78:in `call'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.
2.1/lib/active_support/file_update_checker.rb:78:in `execute'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:27:in `updater'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application/finisher.rb:66:in `block in <module:Finisher>'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/initializable.rb:30:in `instance_exec'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/initializable.rb:30:in `run'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/initializable.rb:55:in `block in run_initializers'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/initializable.rb:54:in `each'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/initializable.rb:54:in `run_initializers'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application.rb:136:in `initialize!'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/railtie/configurable.rb:30:in `method_missing'
        from /Users/sa/Documents/AptanaWorkspace/sparkv1/config/enviro
nment.rb:5:in `<top (required)>'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/application.rb:103:in `require_environment!'
        from /Users/sa/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/l
ib/rails/commands.rb:25:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-16T08:37:12.890

我只是有同样的问题。

正如设计的 wiki 上所写，您必须在 Gemfile 中添加这一行：

gem '设计加密'

来自维基：

> 如果您在模型上使用 encryptable，则现在必须在 gemfile 中包含 devise-encryptable。

[https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.1](https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.1)

关于警告：

从你的 devise.rb 中删除以下内容：

```
# Automatically apply schema changes in tableless databases
config.apply_schema = false

# If true, uses the password salt as remember token. This should be turned
# to false if you are not using database authenticatable.
config.use_salt_as_remember_token = true 
```

# jquery - Jquery .keyup .keydown .keypress 不检测浏览器自动填充

> ID：10610920
> 
> 赞同：8
> 
> 时间：2012-05-16T01:35:16.517
> 
> 标签：jquery, autofill

我正在使用这些事件来尝试评估表单输入，但如果表单由浏览器自动填充，则不会触发这些事件。我怎样才能让事件在自动填充时触发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-21T15:05:00.253

我知道这是一个很老的问题，但是我在 keyup 函数之后使用 e.preventDefault() 解决了同样的问题。

```
$("#email").keyup(function (e)  {
        e.preventDefault(); 
```

这样，如果您选择输入浏览器自动填充的建议，它会注意到。当您在建议上单击鼠标时，问题仍然存在，但如果您在选择它后按任意键，它就可以正常工作。

**最终解决方案**

我在 stackoverflow 上找到了这篇文章：[https ://stackoverflow.com/a/24746108/3481005](https://stackoverflow.com/a/24746108/3481005)

并使用 .on("input") 就可以了！

```
$("#email").on("input",function (e)  { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T01:46:00.190

不幸的是，无法检测浏览器自动填充。相反，`setInterval`例如，使用 以相当高的频率运行一个函数，以检查原始值（或空值）是否与输入值匹配并以这种方式触发响应。如果您不想这样做，您可能是 SOL，因为浏览器甚至不会触发`.change`，并且任何事件很可能不兼容跨浏览器。

您还可以在表单提交时运行验证事件，这应该同样有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-22T17:07:49.547

[`.click()`](http://api.jquery.com/click/)您可以通过绑定到和/或[`.dblclick()`](http://api.jquery.com/dblclick/)事件来稍微伪造所需的行为。

不能保证，但如果他们决定通过从框中选择自动完成来“批准”自动完成，您可能会额外点击鼠标。

# ruby-on-rails - 如何按月设置时间范围

> ID：10610927
> 
> 赞同：0
> 
> 时间：2012-05-16T01:36:10.100
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我目前可以像这样设置时间范围：

```
time_range = (24.hours.ago..Time.now) 
```

我怎样才能在几个月的开始到结束时做到这一点

例子：

```
time_range = (Feb.start..Feb.end)
time_range = (March.start..March.end)
time_range = (April.start..April.end) 
```

想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:40:00.007

很容易找出月初：

```
start_date = Date.new(2012,2,1) 
```

月底：

```
end_date = start_date.end_of_month 
```

最后

```
time_range = (start_date..end_date) 
```

# java - 如何使选择时区更加用户友好？

> ID：10610934
> 
> 赞同：8
> 
> 时间：2012-05-16T01:38:16.683
> 
> 标签：java, user-interface, coldfusion, timezone, user-experience

[时区列表](http://joda-time.sourceforge.net/timezones.html)相当长，有很多重复，而且对程序员不太友好，更不用说最终用户了。

有没有办法将列表缩短到对 80% 以上的用户更友好且足够的内容？但是，如何决定哪些是*流行*的Tz 呢？

Windows 中的列表看起来相当不错，但我不确定这是否是一个可以模仿的好列表。这很有趣，因为 DST 是可选的，这就是为什么列表可以这么短吗？有人[在这里计算出 tz 等价物](http://www.aviblock.com/blog/2009/03/12/presenting-a-list-of-timezones-to-the-user/)。

我在太平洋夏令时间 (PDT)。JS 的`getTimezoneOffset()`返回 420 ==> 偏移量 -7。如果我使用上面的时区列表，如何判断它是美国/太平洋 (-8)？

此外，时区的流行名称是什么？ `US/Pacific`或者`Canada/Pacific`肯定听起来更友好，`America/Los_Angeles`或者`America/Vancouver`。

最后，上面的 2 个时区有何不同？它们可以安全地组合在一起并仅`America/Los_Angeles`在应用程序中使用吗？如何将一组时区组合在一起？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T03:42:32.380

友好的 TZ 名称是主观的 - 一个人喜欢一个名字，而其他人则被它冒犯。与其试图弄清楚如何缩短 tz 列表，为什么不实施地理定位并为他们预先选择用户的时区？

这不是 100% 准确的，对于旅行的人来说是错误的，但我认为这比让你的用户滚动浏览无穷无尽的列表要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-19T10:25:00.327

看看[这种方法](http://timezonepicker.com/)，它对我来说非常友好，并且有据可查如何做到这一点。

# c# - 优化此 C# 代码的其他方法？

> ID：10610935
> 
> 赞同：-2
> 
> 时间：2012-05-16T01:38:22.877
> 
> 标签：c#, optimization, streaming, file-conversion

我创建了 mdb 记录到 sql 记录的转换，对我来说它工作正常.. 但是当记录更大时速度很慢.. 我认为还有其他方法可以优化记录的解析和提取？

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Data;
using System.Data.OleDb;    

namespace conMDBToSQL
{
    class Program
    {
        static void Main()
        {

            // string sFileName = "C:\\sqlrecords.mdb";
            string sFileName = "C:\\sample.mdb";
            OleDbConnection _con = new OleDbConnection( @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + sFileName + ";Mode=Share Exclusive;User Id=admin;Password=;" );
            try
            {
                _con.Open();

                string sTableName = "users";

                string strSQL = String.Empty;

                strSQL = "SELECT * FROM " + sTableName + " ORDER BY 1";
                OleDbCommand _cmd = new OleDbCommand( strSQL, _con );
                _cmd.CommandType = CommandType.Text;
                OleDbDataReader _dr = _cmd.ExecuteReader( CommandBehavior.SchemaOnly );

                ArrayList _Arr = new ArrayList();

                DataTable dt = _dr.GetSchemaTable();
                foreach ( DataRow drow in dt.Rows )
                {
                    // Console.Write( drow[0].ToString() + "\n" );
                    _Arr.Add( drow[0].ToString() );
                }
                _dr.Close();
                _cmd.Dispose();

                strSQL = "SELECT * FROM " + sTableName + " ORDER BY 1";
                _cmd = new OleDbCommand(strSQL, _con);
                _cmd.CommandType = CommandType.Text;
                _dr = _cmd.ExecuteReader();

                string s_fields = String.Empty;
                string s_values = String.Empty;
                int arr_count = _Arr.Count - 1;
                while (_dr.Read()) 
                {
                    for(int i_a = 0; i_a <= arr_count;i_a++)
                    {
                        if (i_a <= arr_count)
                        {
                            s_fields += _Arr[i_a].ToString() + ",";
                            s_values += "'" + _dr[i_a].ToString() + "',";
                        }
                        else
                        {
                            s_fields += _Arr[i_a].ToString();
                            s_values += "'" + _dr[i_a].ToString() + "'";
                        }
                    }

                    // Build, query
                    strSQL = String.Empty;
                    strSQL = "INSERT INTO " + sTableName + "("+ s_fields +") VALUES ("+ s_values +")";

                    // Write, text file
                    StreamWriter sw = new StreamWriter(sFileName, true, Encoding.UTF8);
                    sw.Write(strSQL);
                    sw.Close();
                    sw = null;
                }

                Console.WriteLine("\n");
                Console.WriteLine("Finished..");
                Console.ReadKey();
            }
            catch ( OleDbException olex )
            {
                throw olex;
            }
            finally 
            {
                _con.Close();
            }

        }
    }
} 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:57:50.417

SqlBulkCopy 类帮助了我一次。[链接在这里](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T02:23:25.057

我认为你的主要罪魁祸首是`new StreamWriter(sFileName, true, Encoding.UTF8)`代码行。对于每个数据行，您正在打开文件、添加单个命令，然后关闭文件。那将是非常低效的。

尝试使用 a`StringBuilder`而不是写入流，然后在读取循环之外，将使用 构建的字符串写入`StringBuilder`文件一次。

我想你会发现这大大加快了速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T02:39:23.050

我看到两个主要问题。首先，您应该`StreamReader`在循环的开头打开 ，并在完成后将其关闭。像这样：

```
using (StreamWriter sw = new StreamWriter(sFilename, false, Encoding.UTF8)
{
    while (dr.Read())
    {
        // convert here
        // Each line is written to the StreamWriter
    }
} 
```

该`using`构造将确保`StreamWriter`正确关闭和处置。

第二个问题是将内容附加到字符串。而不是附加字符串，使用`StringBuilder`：

```
StringBuilder s_fields = new StringBuilder();
StringBuilder s_values = new StringBuilder();
int arr_count = _Arr.Count - 1;
while (_dr.Read()) 
{
    for(int i_a = 0; i_a <= arr_count;i_a++)
    {
        if (i_a <= arr_count)
        {
            s_fields.AppendFormat("{0},", _Arr[i_a].ToString());
            s_values.AppendFormat("'{0}',", _dr[i_a].ToString());
        }
        else
        {
            s_fields.Append(_Arr[i_a].ToString());
            s_values.AppendFormat("'{0}'", _dr[i_a].ToString());
        }
    }
    strSQL = String.Format("INSERT INTO {0} ({1}) VALUES ({2})",
        sTableName, s_fields.ToString(), s_values.ToString());
    sw.WriteLine(strSQL);
} 
```

这应该会大大提高你的表现。

# mongodb - 为什么 MongooseJS 不能正确填充我的字段？

> ID：10610938
> 
> 赞同：0
> 
> 时间：2012-05-16T01:38:57.883
> 
> 标签：mongodb, mongoose, populate

我正在尝试调整此处的示例

[http://mongoosejs.com/docs/populate.html](http://mongoosejs.com/docs/populate.html)

我已删除故事并尝试添加“朋友”字段。我的代码如下

```
var PersonSchema = new Schema({
    name    : String
  , age     : Number
  , friends : [{ type: Schema.ObjectId, ref: 'Person' }]
});

var Person = mongoose.model('Person', PersonSchema);

var aaron = new Person({ name: 'Aaron', age: 100 });
var bill = new Person({ name: 'Bill', age: 97 });

aaron.save(function (err) {
    if (err) throw err;
    bill.save(function(err) {
        if (err) throw err;
        var charlie = new Person({ name: 'Charlie', age: 97, friends: [aaron._id, bill._id] });
        charlie.save(function(err) {
            if (err) throw err;
            Person
            .findOne({name: 'Charlie'})
            .populate('friends')
            .run(function(err, friends) {
                if (err) throw err
                console.log('JSON for friends is: ', friends);
                db.disconnect();

            });            

        });

    });

}); 
```

它打印出以下文本

```
JSON for friends is:  { name: 'Charlie',
  age: 97,
  _id: 4fb302beb7ec1f775e000003,
  stories: [],
  friends:
   [ { name: 'Aaron',
       age: 100,
       _id: 4fb302beb7ec1f775e000001,
       stories: [],
       friends: [] },
     { name: 'Bill',
       age: 97,
       _id: 4fb302beb7ec1f775e000002,
       stories: [],
       friends: [] } ] } 
```

换句话说，它正在打印出 'charlie' 对象。我想要的功能是让 MongooseJS 在朋友字段中使用 ObjectIds 并用匹配的对象（aaron 和 bill）填充数组。换句话说，更像是

```
[ { name: 'Aaron',
       age: 100,
       _id: 4fb302beb7ec1f775e000001,
       stories: [],
       friends: [] },
     { name: 'Bill',
       age: 97,
       _id: 4fb302beb7ec1f775e000002,
       stories: [],
       friends: [] } ] 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:03:18.653

你没有做错任何事。这是设计使然。该查询是针对 Charlie 的，populate 然后执行另一个查询以从集合`findOne`中返回文档。`ref`

您可以获得的最接近的方法是`select`在查询中添加 a 以仅返回朋友：

```
Person
  .findOne({name: 'Charlie'})
  .select('friends')
  .populate('friends')
  .run(function(err, friends) {
    if (err) throw err
    console.log('JSON for friends is: ', friends);
    db.disconnect();
  }); 
```

哪个会返回：

```
JSON for friends is:  
{ 
  _id: 4fb302beb7ec1f775e000003,
  friends:
    [ { name: 'Aaron',
        age: 100,
        _id: 4fb302beb7ec1f775e000001,
        stories: [],
        friends: [] },
      { name: 'Bill',
        age: 97,
        _id: 4fb302beb7ec1f775e000002,
        stories: [],
        friends: [] } ] } 
```

# jquery - 使用 DOM 和 jquery 进行搜索和替换

> ID：10610941
> 
> 赞同：-4
> 
> 时间：2012-05-16T01:39:16.620
> 
> 标签：jquery, html, dom

我正在尝试制作一个网页，允许用户输入 .txt 文件的文件路径，然后搜索和替换 .txt 文件中的字符串。我做了一些搜索，只发现页面说由于安全原因无法完成，我很确定这是垃圾。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T01:42:26.150

这不是垃圾。有`FileReader`，但它仅受某些浏览器支持，并且仅授予您只读访问权限。 [Chrome 显然支持](http://www.html5rocks.com/en/tutorials/file/filesystem/)，`FileWriter`但您只能写入沙盒环境。

您需要将文件上传到服务器，进行修改，然后将修改后的文件发回——注意这不会删除原始文件。

# android - 网格布局 + 滚动视图

> ID：10610943
> 
> 赞同：5
> 
> 时间：2012-05-16T01:39:26.090
> 
> 标签：android, scrollview, grid-layout

我想创建一个布局，如 android 市场的第一页。我正在尝试使用gridlayout，因为我想放置不同大小和位置的imageview，我还需要输入scrollview。

其实我的问题是如何在 android.support.v7.widget.GridLayout 中输入滚动视图？

我试过了：

```
<?xml version="1.0" encoding="utf-8"?>
 <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res/com.astuetz.viewpager.extensions.example"
     android:id="@+id/scrollView1"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content" >

<android.support.v7.widget.GridLayout xmlns:android="http://schemas.android.com/apk/res/android"

    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:columnCount="10" >

    <ImageView
        android:id="@+id/ImageView1"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="1"
        android:src="@drawable/tab_background_focused" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_column="5"
        app:layout_gravity="bottom"
        app:layout_row="1"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <ImageView
        android:id="@+id/ImageView2"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="1"
        app:layout_columnSpan="3"
        app:layout_gravity="left"
        app:layout_row="2"
        android:src="@drawable/tab_background_focused" />

    <ImageView
        android:id="@+id/ImageView3"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="4"
        app:layout_rowSpan="2"
        android:src="@drawable/tab_background_focused" android:adjustViewBounds="true"/>

    <ImageButton
        android:id="@+id/imageButton1"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="7"
        android:src="@drawable/background_dots" />

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="9" android:adjustViewBounds="true" android:src="@drawable/tab_background"/>

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="130dp"
        android:layout_height="match_parent"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="9"
        android:adjustViewBounds="true" />

   <ImageView
        android:id="@+id/imageView6"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="9" android:adjustViewBounds="true"/>

      <ImageView
        android:id="@+id/imageView7"
        android:layout_width="130dp"
        android:layout_height="130dp"
        app:layout_column="2"
        app:layout_gravity="left"
        app:layout_row="2" /> 

    <android.support.v7.widget.Space
        android:id="@+id/space1"
        android:layout_width="145dp"
        android:layout_height="1dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="0" />

    <android.support.v7.widget.Space
        android:layout_width="1dp"
        android:layout_height="21dp"
        app:layout_column="0"
        app:layout_row="0" />

    <android.support.v7.widget.Space
        android:id="@+id/space2"
        android:layout_width="1dp"
        android:layout_height="127dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="1" />

    <android.support.v7.widget.Space
        android:id="@+id/space3"
        android:layout_width="10dp"
        android:layout_height="1dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="0" />

    <android.support.v7.widget.Space
        android:id="@+id/space4"
        android:layout_width="1dp"
        android:layout_height="10dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="1" />

    <android.support.v7.widget.Space
        android:id="@+id/space5"
        android:layout_width="44dp"
        android:layout_height="1dp"
        app:layout_column="3"
        app:layout_gravity="left"
        app:layout_row="0" />

    <android.support.v7.widget.Space
        android:layout_width="1dp"
        android:layout_height="58dp"
        app:layout_column="0"
        app:layout_row="5" />

    <android.support.v7.widget.Space
        android:layout_width="1dp"
        android:layout_height="10dp"
        app:layout_column="0"
        app:layout_row="3" />

    <android.support.v7.widget.Space
        android:id="@+id/space6"
        android:layout_width="1dp"
        android:layout_height="17dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="6" />

    <android.support.v7.widget.Space
        android:id="@+id/space7"
        android:layout_width="238dp"
        android:layout_height="1dp"
        app:layout_column="4"
        app:layout_gravity="left"
        app:layout_row="0" />

    <android.support.v7.widget.Space
        android:id="@+id/space8"
        android:layout_width="1dp"
        android:layout_height="16dp"
        app:layout_column="0"
        app:layout_gravity="left"
        app:layout_row="8" />

    <android.support.v7.widget.Space
        android:layout_width="26dp"
        android:layout_height="1dp"
        app:layout_column="2"
        app:layout_row="0" />

</android.support.v7.widget.GridLayout>
</ScrollView> 
```

在这段代码中，imageview 最终开始相互覆盖。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T22:46:44.573

我解决了这个问题，您需要保持线性布局结构，然后在其中添加 gridlayout 并设置 layout_height="the_value_you_need"。像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" xmlns:app="http://schemas.android.com/apk/res/com.astuetz.viewpager.extensions.example">

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <android.support.v7.widget.GridLayout
            android:layout_width="match_parent"
            android:layout_height="900dp" >

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="130dp"
                android:layout_height="130dp"
                app:layout_column="0"
                app:layout_columnSpan="2"
                app:layout_gravity="left"
                app:layout_row="0"
                app:layout_rowSpan="2"
                android:src="@drawable/tab_background_pressed" />

            <ImageView
                android:id="@+id/imageView2"
                android:layout_width="130dp"
                android:layout_height="130dp"
                app:layout_column="0"
                app:layout_gravity="right"
                app:layout_row="3"
                android:src="@drawable/tab_background_pressed" />

            <ImageView
                android:id="@+id/imageView3"
                android:layout_width="130dp"
                android:layout_height="130dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="5"
                android:src="@drawable/tab_background_pressed" />

            <ImageView
                android:id="@+id/imageView4"
                android:layout_width="130dp"
                android:layout_height="130dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="7"
                android:src="@drawable/tab_background_pressed" />

            <ImageView
                android:id="@+id/imageView5"
                android:layout_width="130dp"
                android:layout_height="130dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="7"
                android:src="@drawable/tab_background_pressed" />

            <android.support.v7.widget.Space
                android:layout_width="32dp"
                android:layout_height="1dp"
                app:layout_column="0"
                app:layout_row="0" />

            <android.support.v7.widget.Space
                android:id="@+id/space1"
                android:layout_width="1dp"
                android:layout_height="16dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="2" />

            <android.support.v7.widget.Space
                android:id="@+id/space2"
                android:layout_width="1dp"
                android:layout_height="16dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="4" />

            <android.support.v7.widget.Space
                android:id="@+id/space3"
                android:layout_width="1dp"
                android:layout_height="16dp"
                app:layout_column="0"
                app:layout_gravity="left"
                app:layout_row="6" />
        </android.support.v7.widget.GridLayout>

    </LinearLayout>

</ScrollView> 
```

要进行水平滚动，只需将 layout_widht 更改为固定值。

# ruby-on-rails - Carrierwave 上传适用于 rails 控制台，但不适用于规范

> ID：10610944
> 
> 赞同：5
> 
> 时间：2012-05-16T01:39:46.990
> 
> 标签：ruby-on-rails, ruby, rspec, factory-bot, carrierwave

我有以下模型：

```
class Face < ActiveRecord::Base
  attr_accessible :face_index, :design, :background
  belongs_to :template
  mount_uploader :background, BackgroundUploader
end 
```

背景上传器：

```
class BackgroundUploader < CarrierWave::Uploader::Base
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end
end 
```

当我启动 rails 控制台时，我可以创建一个 Face 并为其保存背景：

```
f = Face.create(:face_index => 0)
f.background = File.open("/path/to/image.jpg")
f.save! 
```

一切正常，但是当我尝试将其移至 rspec 时，我遇到了失败：

```
Failures:

  1) Face A new face 
     Failure/Error: @face.background = File.open(image_path)
     NoMethodError:
       undefined method `background_will_change!' for #<Face:0x007ff63d9f7410> 
```

规格：

```
describe Face do

  before(:each) do
    image_path = Rails.root.join('spec/support/images', '02.jpg').to_s
    @face = FactoryGirl.create(:face)
    @face.background = File.open(image_path)
    @face.save!
  end

  describe "A new face" do
    it { should belong_to(:template) }
  end

end 
```

工厂：

```
FactoryGirl.define do    
  factory :face do
    face_index 0
  end
end 
```

在数据库中缺少上传器列之前，我已经看到过该错误，但是如果我的迁移对于开发人员来说是正确的，那么它们对于测试来说应该是正确的，不是吗？我是否需要规范中的某些内容才能使其工作？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T16:16:59.373

哦，答案是我的最后一段，我忘了跑

```
rake db:test:load 
```

休息并回到问题的一个很好的例子。

# xcode - Xcode TableView 问题

> ID：10610947
> 
> 赞同：0
> 
> 时间：2012-05-16T01:39:59.557
> 
> 标签：xcode, ios5, uitableview

现在我正在我的应用程序中放置一个表格视图。当我`UITableView`在屏幕上拖动 a 并将其定位时，Xcode 不显示内容类型设置，我需要为此 tableview 更改它。此表视图位于 xib 文件中，与主情节提要文件分开。我将如何更改该设置？

谢谢，维林德博拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T10:53:00.987

您可以通过查看实用程序的属性检查器自己更改/检查内容类型设置。

# java - PreparedStatement setString(...) for all，即使对应的数据类型是整数

> ID：10610950
> 
> 赞同：8
> 
> 时间：2012-05-16T01:40:27.487
> 
> 标签：java, jdbc, prepared-statement

我遇到了以下代码，我觉得它做错了：

（请注意，这是 JDK 1.4.2，因此未键入列表）

```
StringBuffer queryBuffer = new StringBuffer();
ArrayList temp = new ArrayList();

... 
queryBuffer.append("and sb.POSTCODE = ? ");
temp.add(postcode);
...

conn = ConnectionManager.getConnection();       
pstmt = conn.prepareStatement(queryBuffer.toString()); 
```

这就是我所关心的：

```
for(int i=0; i<temp.size(); i++) {
    log.debug("setString("+ (i+1) + "," + (String)temp.get(i) + ")");
    pstmt.setString(i+1, (String)temp.get(i));
} 
```

但是我注意到数据库中一些对应的数据类型（字段）是整数，还有日期，这样可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T02:07:02.570

考虑使用 PreparedStatement [setObject()](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setObject%28int,%20java.lang.Object%29)方法而不是**setString()**。

如果在编译时类型未知， PreparedStatement **setObject()**将尝试为您转换任何**java.lang类型。**

所以使用更新的 for 循环（假设你有 java 5.0）和通用的 null 处理：

```
int i = 0;
for(Object value : temp) {
    if (value == null) {
        // set null parameter if value type is null and type is unknown
        pstmt.setNull(++i, Integer.MIN_VALUE); 
    } else {
        pstmt.setObject(++i, value);
    }
} 
```

注意[setNull()](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)可以接受一个[类型](http://docs.oracle.com/javase/6/docs/api/java/sql/Types.html)作为第二个参数，如果它是已知的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T14:47:31.333

这对我没有帮助。下面是附加绑定变量后构建的查询。从 ACC_TABLE 中选择 ACC_NO，其中 ACC_NAME='java.lang.String';

它正在尝试转换为 java.lang.String 类型并导致以下异常 java.sql.SQLException：无法执行 sql 命令 - 原始消息：null

我的 ACC_NAME 是“user01”。所以实际上查询应该是这样的，select ACC_NO from ACC_TABLE where ACC_NAME='user01';

所以如果我的理解没有错的话，preparedStatement.setObject(index, object) 就是将数据转换成其各自的数据类型并进行设置。

MySQL 中的preparedStatement.setObject(index, object) 运行良好，没有任何问题。唯一的问题是在使用 Oracle 时。我正在使用的 Oracle DB 版本是

Oracle Database 11g Express Edition 版本 11.2.0.2.0 - 生产 PL/SQL 版本 11.2.0.2.0 - 用于 32 位 Windows 的生产“CORE 11.2.0.2.0 生产”TNS：版本 11.2.0.2.0 - 生产 NLSRTL 版本11.2.0.2.0 - 生产

# bash - 用于遍历目录的 Shell 脚本

> ID：10610955
> 
> 赞同：4
> 
> 时间：2012-05-16T01:41:51.410
> 
> 标签：bash

我正在做一个需要批量处理大量图像文件的项目。为了使事情更容易，我编写了一个脚本，该脚本将根据用户输入创建`n`目录并将文件移动到其中。`m`

我的问题是现在通过 shell 脚本了解目录遍历。

我在上述排序脚本的末尾添加了这个片段

```
dirlist=$(find $1 -mindepth 1 -maxdepth 1 -type d)

for dir in $dirlist
do
  cd $dir
  echo $dir
  ls
done 
```

当我在包含两个内部文件夹的 Pano2 文件夹中运行它时，我总是遇到错误

```
./dirTravel: line 9: cd: Pano2/05-15-2012-2: No such file or directory 
```

但是，在那之后，我从指定目录获取文件列表。

警告背后的原因是什么？如果我在获得 Pano2/ 中的文件夹列表`cd ../`后添加，而不是文件本身。`ls`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T02:06:39.933

我建议使用子 shell 来切换目录：

```
dirlist=$(find $1 -mindepth 1 -maxdepth 1 -type d)

for dir in $dirlist
do
  (
  cd $dir
  echo $dir
  ls
  )
done 
```

子外壳中的代码不会影响父外壳，因此它可以在任何地方更改目录，而不会给您任何有关“如何返回”的问题。

这附带一个标准警告，即如果您的目录名称可能包含空格、换行符或其他意外和尴尬的字符，则整个过程会令人担忧。如果您使用可移植文件名字符集 ( `[-_.A-Za-z0-9]`)，您将不会遇到书面问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T01:47:09.720

我的猜测是，您将进入两个级别，但只会返回一个级别。尝试在 ,`cd ../..`之后添加 a`ls`或使用`pushd`and`popd`代替。

例如：

```
for dir in $dirlist
do
  pushd $dir
  echo $dir
  ls
  popd
done 
```

正如@shellter 指出的那样，如果这些目录有空格，那么这样的东西可能会更好：

```
find $1 -mindepth 1 -maxdepth 1 -type d | while read -r dir
do
  pushd "$dir"  # note the quotes, which encapsulate whitespace
  echo $dir
  ls
  popd
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T03:06:03.953

确实没有任何理由 cd 到目录来运行`ls`命令。以下应该有效：

```
find "$1" -mindepth 1 -maxdepth 1 -type d -exec ls {} \; 
```

如果这只是一个示例，并且您确实运行了依赖于工作目录的其他命令，则可以将 bash -c 与 -exec 一起使用：

```
find "$1" -mindepth 1 -maxdepth 1 -type d -exec bash -c 'cd "$1"; echo "$1"; ls' -- {} \; 
```

bash -c 调用会生成一个子shell，因此您无需担心它会更改当前shell 的目录。

# php - HTTPS 子域将页面重定向到主域

> ID：10610956
> 
> 赞同：0
> 
> 时间：2012-05-16T01:42:05.067
> 
> 标签：php, ssl, ssl-certificate

我在构建和维护的客户网站上遇到了一个非常奇怪的问题......

我的主要网站是[http://www.pr-infrared.com](http://www.pr-infrared.com)，测试网站是[http://test.pr-infrared.com](http://test.pr-infrared.com)

它们都是独立的网站。您会看到测试网站中有一个我正在集成的购物车。

我最近为域 pr-infrared.com 安装了 GeoTrust SSL 证书。

我遇到的问题是，当尝试访问测试站点的 HTTPS 版本时（只需在其前面添加一个 HTTPS），您会看到它显示的是实时站点（您可以知道它是实时站点）网站查看源代码和右上角没有购物车、结帐和帐户导航）。我发现它的作用是每当您尝试在测试站点上调出 HTTPS 页面时，它会从 LIVE 网站上调出相同的页面。

我不知道它为什么会这样做，更不用说如何修复它了。任何想法将不胜感激。我正在失去理智试图弄清楚这一点！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T02:18:48.797

1) 我看到证书是发给 www.pr-infrared.com，而不是 pr-infrared.com

2) 如果您正在运行 apache，您是否检查过站点配置（可能是 /etc/apache2/sites-available/default-ssl）以查看 DocumentRoot 的位置？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T03:02:39.920

`pr-infrared.com`,`www.pr-infrared.com`并`test.pr-infrared.com`使用相同的 IP 地址。您的证书仅对`pr-infrared.com`和有效`www.pr-infrared.com`。

原则上，您也可以在开发期间使用此证书`test.pr-infrared.com`（可能通过向浏览器添加例外）。但是，虚拟主机仍然需要适合`ServerName`它。看起来您没有正确配置虚拟主机。

# python - 如何在 SQLAlchemy 中跨多个表进行联合？

> ID：10610960
> 
> 赞同：5
> 
> 时间：2012-05-16T01:43:29.427
> 
> 标签：python, sqlalchemy, union

我有几个不同的通知表，我想对所有通知表进行联合，以向用户显示他们的所有通知。然而，工会并没有按应有的方式工作。

**Python代码**

```
def _get_notifications_query(self, unconfirmed_only=True):
    '''
    Return base query to return this users notifications.

    @param unconfirmed_only
    @return Query object
    '''        
    requests = (
        DBSession.query(FriendshipRequestNotification)
        .outerjoin(UserFriendshipRequestNotification,
                   UserFriendshipRequestNotification.notification_id==FriendshipRequestNotification.id)
        .filter(UserFriendshipRequestNotification.user_id==self.id))
    confirmations = (
        DBSession.query(FriendshipConfirmationNotification)
        .outerjoin(UserFriendshipConfirmationNotification,
                   UserFriendshipConfirmationNotification.notification_id==FriendshipConfirmationNotification.id)
        .filter(UserFriendshipConfirmationNotification.user_id==self.id))
    comments = (
        DBSession.query(CommentNotification)
        .outerjoin(UserCommentNotification,
                   UserCommentNotification.notification_id==CommentNotification.id)
        .filter(UserCommentNotification.user_id==self.id))

    if unconfirmed_only:
        requests.filter(UserFriendshipRequestNotification.is_confirmed==False)
        confirmations.filter(UserFriendshipConfirmationNotification.is_confirmed==False)
        comments.filter(UserCommentNotification.is_confirmed==False)

    return requests.union(confirmations, comments) 
```

使用：user._get_notifications_query(unconfirmed_only=False).all()

**生成的 SQL**

```
SELECT anon_1.friendship_request_notifications_id AS anon_1_friendship_request_notifications_id, anon_1.friendship_request_notifications_created_at AS anon_1_friendship_request_notifications_created_at, anon_1.friendship_request_notifications_requester_id AS anon_1_friendship_request_notifications_requester_id 
FROM (SELECT friendship_request_notifications.id AS friendship_request_notifications_id, friendship_request_notifications.created_at AS friendship_request_notifications_created_at, friendship_request_notifications.requester_id AS friendship_request_notifications_requester_id 
FROM friendship_request_notifications LEFT OUTER JOIN users_friendship_request_notifications ON users_friendship_request_notifications.notification_id = friendship_request_notifications.id 
WHERE users_friendship_request_notifications.user_id = ? UNION SELECT friendship_confirmation_notifications.id AS friendship_confirmation_notifications_id, friendship_confirmation_notifications.created_at AS friendship_confirmation_notifications_created_at, friendship_confirmation_notifications.accepter_id AS friendship_confirmation_notifications_accepter_id 
FROM friendship_confirmation_notifications LEFT OUTER JOIN users_friendship_confirmation_notifications ON users_friendship_confirmation_notifications.notification_id = friendship_confirmation_notifications.id 
WHERE users_friendship_confirmation_notifications.user_id = ? UNION SELECT comment_notifications.id AS comment_notifications_id, comment_notifications.created_at AS comment_notifications_created_at, comment_notifications.comment_id AS comment_notifications_comment_id 
FROM comment_notifications LEFT OUTER JOIN users_comment_notifications ON users_comment_notifications.notification_id = comment_notifications.id 
WHERE users_comment_notifications.user_id = ?) AS anon_1 
```

**我期待这些方面的东西**

```
SELECT * FROM friendship_request_notifications
UNION
SELECT * FROM friendship_confirmation_notifications
UNION 
SELECT * FROM comment_notifications 
```

另外，有没有办法对 SQLAlchemy 中的聚合联合结果进行排序？

**编辑**

我应该提到`sqlalchemy.sql.union()`产生正确的 SQL，但我不知道如何从 ORM 中使用它（返回/计算记录）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-18T14:45:07.383

当然可以使用 sqlalchemy 合并不同的表，您只需指定要从每个表中提取的列，以便它们可以正确组合。假设您有实体`A`并且`B`，请执行以下操作：

```
from sqlalchemy.sql.expression import label
...

a = session.query(label('col1', A.someColumn))
b = session.query(label('col1', B.someOtherColumn))
both = a.union_all(b) 
```

在这种情况下，您必须注意的是，如果`A.someColumn`并且`B.someOtherColumn`不能强制转换为相同类型，您的 dbms 可能会崩溃:)

有关“现实世界”中的示例，请参见第 85、87 和 90 行：

[https://gerrit.wikimedia.org/r/#/c/147312/4/wikimetrics/metrics/rolling_active_editor.py](https://gerrit.wikimedia.org/r/#/c/147312/4/wikimetrics/metrics/rolling_active_editor.py)

这会创建一个合并在一起的两个不同表的子查询。然后该子查询稍后在连接中使用，并且它的列`.c.column`像往常一样通过访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T05:44:04.297

我认为这不能与联合一起使用，即使假设查询是按照您的预期生成的。您正在查询三种不同的对象类型。当 ORM 从数据库中取回行时，我看不到将行映射到正确类的方法。

在这种情况下，UNION 没有多大意义，因为第三列在所有三个表中都有不同的含义。

您应该分别执行这三个查询，除非您的三个通知类型继承自一个公共 ORM 映射类。在这种情况下，SQLAlchemy 支持同时查询这四种类型，尽管不支持 UNION。

# c - 在 C 中使用“realloc”的问题

> ID：10610961
> 
> 赞同：0
> 
> 时间：2012-05-16T01:43:35.920
> 
> 标签：c, memory-management, realloc

我有代码从第一次迭代时崩溃的套接字接收字符串数据：

```
int size_data = 1024*sizeof(char);              
char *data = malloc(size_data);
char *data_aux;
int br_aux=0;
int *nptr;

memset(&data[0], 0, size_data);
int br = recv(sockdata, data, size_data, 0);
data_aux = malloc(br);
while (br>0) {
  br_aux = br_aux + br;
  strcat(data_aux, data);
  br = recv(sockdata,data, size_data, 0);
  if (br > 0) {
    nptr = (int *) realloc(data_aux, br+br_aux);
  }
}
free(data);
printf("%s", data_aux);
free(data_aux); 
```

没什么复杂的，但是我得到一个错误：

> *** 检测到 glibc****./clientFTP: free(): invalid next size (normal): 0x00000000061d6420 ** * ======= 回溯：========= /lib64/libc.so.6[0x366be7247f] /lib64/ libc.so.6(cfree+0x4b)[0x366be728db] ./clientFTP[0x401e39] /lib64/libc.so.6(__libc_start_main+0xf4)[0x366be1d9b4] ./clientFTP[0x400b89] ======= 内存映射: ======== 00400000-00403000 r-xp 00000000 fd:00 5396214 /home/alumno/FTP/clientFTP 00602000-00603000 rw-p 00002000 fd:00 5396214
> /home/alumno/FTP/clientFTP17006d 0601 rw-p 061d6000 00:00 0
> [堆] 366ba00000-366ba1c000 r-xp 00000000 fd:00 1994999
> /lib64/ld-2.5.so 366bc1c000-366bc1d000 r--p 0001c000 fd:06/ ld:
> 069 366bc1d000-366bc1e000 rw-p 0001d000 fd:00 1994999
> /lib64/ld-2.5.so 366be00000-366bf4e000 r-xp 00000000 fd:00 1995001
> /lib64/libc-2.5.so 366bf4e000-366c14e000 ---p 0014e000 fd:00 1995001
> /lib64/libc-2.5.so 366c14e000-366c152000 r--p 0014e000 fd:00 1995001
> /lib64/libc-2.5.so 366c152000-366c153000 rw-p 00152000 fd:00 1995001
> /lib64/libc-2.5.so 366c153000-366c158000 rw-p 366c153000 00:00 0 3672200000-367220d000 r-xp 00000000 fd:00 1995011
> /lib64/libgcc_s-4.1.2-20080825.so.1 367220d000-367240d000 ---p 0000d000 fd:00 1995011
> /lib64/libgcc_s-4.0.2-2007208 20072082 367240e000 rw-p 0000d000 fd:00 1995011
> /lib64/libgcc_s-4.1.2-20080825.so.1 2b5cdf8d9000-2b5cdf8dd000 rw-p 2b5cdf8d9000 00:00 0 2b5cdf8f6000-2b5cdf8f7000 rw-p 2b5cdf8f6000 00:00 0 7fffae47e000-7fffae493000 rw-p 7ffffffe9000 00:00 0
> [stack] 7fffae5fc000-7fffae600000 r-xp 7fffae5fc000 00:00 0
> [vdso] ffffffffff600000-ffffffffffe00000 ---p 00000000 00:00 0
> [vsyscall] 中止*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:59:10.107

有两个不同的问题。

一、线

```
nptr = (int *)realloc(data_aux,(br+br_aux)); 
```

做三件事：

1.  它尝试分配`br + br_aux`字节。
2.  它可以释放`data_aux`指向的内存。
3.  它指向`nptr`新分配的内存地址。

但是代码继续使用`data_aux`，就好像它仍然指向新内存一样。

其次，由于`recv()`返回接收到的字节数，您应该使用该信息将数据附加到缓冲区：

```
while (br > 0) {
  memcpy(data_aux + br_aux, data, br);
  br_aux += br;
  br = recv(sockdata, data, size_data, 0);
  if (br > 0) {
    nptr = (int *) realloc(data_aux, br + br_aux);
    if (nptr == NULL) {
      // ERROR
    }
    data_aux = nptr;
  }
} 
```

`recv()`与任何字符串操作（如 ）结合使用的问题`strcat()`是`recv()`可以返回二进制数据。如果该数据恰好包含零字节，则字符串函数将假定它是数据的结尾，并以您既不期望也不想要的方式运行。

实际上还有第三个问题，即没有检查任何返回值是否有错误。 *总是*检查错误，而不是假设内存是有效的，或者 socked 通信已经成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:55:31.117

代码中有很多问题，但我会解决大问题：

1.  您正在分配内存并假设它已准备好使用：

    ```
    data_aux = malloc(br);
    ...
    strcat(data_aux, data); /* <- who said data_aux isn't garbage? */ 
    ```

2.  您应该考虑[`realloc`移动数据或调用本身失败](http://pubs.opengroup.org/onlinepubs/7908799/xsh/realloc.html)且`data_aux`不够大的情况：

    > 成功完成后，大小不等于 0，`realloc()`返回指向（可能已移动）分配空间的指针。如果 size 为 0，则返回可以成功传递的空指针或唯一指针`free()`。如果没有足够的可用内存，则`realloc()`返回一个空指针并设置`errno`为`ENOMEM`.

    ```
    data_aux = realloc(data_aux, br + br_aux); /* reassign data_aux */ 
    ```

3.  您没有检查任何返回值。一个大的不是`recv()`在分配内存之前检查结果：

    ```
    br = recv(...);
    ...
    data_aux = malloc(br); /* -1 as a size is large in unsigned speak */ 
    ```

4.  您正在对可能不包含`char`s 的数据使用 ASCIIZ 字符串函数。使用`memcpy`代替`strcat`or `strncat`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T02:12:24.547

如果`realloc()`成功，则输入的内存块不再有效，返回的指针指向新的内存块。如果`realloc()`失败，输入内存块仍然有效。您将返回的指针分配给一个`nptr`根本不用于任何事情的变量，并且您永远不会更新该`data_aux`变量以指向重新分配的内存。当您调用`free()`free`data_aux`时，如果`realloc()`事先调用并成功，您将释放错误的指针，这可能会导致您看到的崩溃。

改变这个：

```
nptr = (int *) realloc(data_aux,(br+br_aux)); 
```

为此：

```
nptr = (char*)realloc(data_aux, br_aux + br); 
if (!nptr)
{
    ... error handling ...
    break;
}
data_aux = nptr; 
```

话虽如此，您应该将整个逻辑重写为更像以下内容。循环中无需`recv()`多次调用：

```
int size_data = 1024 * sizeof(char);                
char *data_aux = NULL;
int br_aux = 0;  
char *nptr;  

char *data = malloc(size_data);  
if (data)
{
    int br = recv(sockdata, data, size_data, 0);
    while (br > 0)
    {  
        nptr = (char*) realloc(data_aux, br_aux + br);
        if (!nptr)
            break;

        data_aux = nptr;
        memcpy(&data_aux[br_aux], data, br);  
        br_aux = br_aux + br;  
    }  

    free(data);  
}

printf("%.*s", br_aux, data_aux);  
free(data_aux); 
```

为了进一步简化，将`data`缓冲区放在堆栈上：

```
char* data_aux = NULL;
int br_aux = 0;  

char data[1024];
char *nptr;  

int br = recv(sockdata, data, sizeof(data), 0);
while (br > 0)
{  
    nptr = (char*) realloc(data_aux, br_aux + br);
    if (!nptr)
        break;

    data_aux = nptr;
    memcpy(&data_aux[br_aux], data, br);  
    br_aux = br_aux + br;  
}  

printf("%.*s", br_aux, data_aux);  
free(data_aux); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T01:47:05.473

呃 - 您从套接字收到的字符串是否以空值结尾？

建议：

1.  确保在发送之前在消息中包含空字节

2.  使用 strncat()

3.  如有必要，请自行终止缓冲区

PS：我猜你正在超出“strcat（data_aux）”中的缓冲区，这会无意中破坏“data”和“data_aux”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T02:39:43.030

```
data_aux = malloc(br);   //data_aux may not filled with zero
//data_aux[0] = '\o';

while (br>0)
{
    br_aux = br_aux + br;  
    strcat(data_aux,data); //this may casue overflow, data may not end with '\0'
    br = recv(sockdata,data, size_data,0); 
    if(br>0)
    {
        //need check nptr is NULL? and size is (br + br_aux + 1), '\0' need one byte
        //nptr = (char*)realloc(data_aux,(br + br_aux + 1)); 
        nptr = (int *)realloc(data_aux,(br+br_aux)); 
        // if (nptr != NULL)
        //     data_aux = nptr;
        // else
        //     Error handling
    }
} 
```*

# android - 如何在处理程序/线程中显示 Toast？

> ID：10610962
> 
> 赞同：8
> 
> 时间：2012-05-16T01:43:53.840
> 
> 标签：android, toast

一旦消息被发送到套接字，我想显示一个祝酒词。在这个“Log.d（“ClientActivity”，“C：Sent。”）之后;“

我是否需要创建一个单独的线程来显示 Toast？

```
public class ClientActivity extends Activity {
private Handler handler = new Handler();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.client);
    serverIp = (EditText) findViewById(R.id.EditText01);
    message =(EditText) findViewById(R.id.EditText02);
    connectPhones = (Button) findViewById(R.id.Button01);

}

    public void Click1(View v) {
        if (!connected) {
            serverIpAddress = serverIp.getText().toString();
            if (!serverIpAddress.equals("")) {
                Thread cThread = new Thread(new ClientThread());
                cThread.start();
            }
        }
    }

private class ClientThread implements Runnable {

    public void run() {
        try {
            InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
            Log.d("ClientActivity", "C: Connecting...");
            Socket socket = new Socket(serverAddr, ServerActivity.SERVERPORT);
            connected = true;
            while (connected) {
                try {
                    if(i>5)
                    {

                    } 
                    else
                    {   
                        Log.d("ClientActivity", "C: Sending command.");
                        PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket
                                .getOutputStream())), true);
                        // where you issue the commands
                        message1= message.getText().toString();
                        out.println(message1);
                        i=i+1;
                        Log.d("ClientActivity", "C: Sent.");
                    }    
                } catch (Exception e) {
                    Log.e("ClientActivity", "S: Error", e);
                }
            }
            socket.close();
            Log.d("ClientActivity", "C: Closed.");
        } catch (Exception e) {
            Log.e("ClientActivity", "C: Error", e);
            connected = false;
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-16T01:51:33.557

放

```
 runOnUiThread(new Runnable() {
                 public void run() {

                     Toast.makeText(ClientActivity.this,"asdf",Toast.LENGTH_LONG).show();
                }
            }); 
```

在这条线之后

```
 Log.d("ClientActivity", "C: Connecting..."); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T04:53:35.760

```
Handler handler = new Handler();
handler.postDelayed(new Runnable() {
    @Override
    public void run() {
        System.out.println("I'm in handler");
        Toast.makeText(YourActivity.this, "This is a toast", Toast.LENGTH_SHORT).show(); 
    }
}, 1000); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T09:59:59.613

您不能从线程内部创建 toast。因为这个新线程无权访问`getApplicationContext()`您传递给它的那个。您必须以某种方式建立与 UI 线程（即主线程）的通信。
因此，每当您想敬酒时，请在该`handler.Post(Runnable)`方法中进行。处理程序是`middle man`UI 线程和您正在运行的单独线程之间的。所有 UI 操作都必须在`handler.Post(Runnable)`'`run()`方法中完成。

因此，在您显示敬酒的活动中，请执行以下操作：

```
private class ClientThread implements Runnable {

    public void run() {
        try {
            InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
             .....
             .....
              message1= message.getText().toString();
                        out.println(message1);
                        i=i+1;
                        Log.d("ClientActivity", "C: Sent.");
                        handler.post(new Runnable(){
                          public void run()
                          {
                             Toast.make(....);
                           }
                         }); 
```

不要忘记在主活动中声明和初始化一个处理程序对象（在线程外）

```
handler=new Handler(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T04:20:20.800

先声明一个全局Handler，

```
Handler handler=null; 
```

然后像这样在你的 onCreate() 中创建一个处理程序，

```
Handler handler=new Handler()
{
  public void handleMessage(Message msg)
{
  if(msg.what==0)
{
   Toast.makeText(ClientActivity.this,"Your Toast Mesage Goes here",Toast.LENGTH_LONG).show();
}

}
}; 
```

现在在你的 Runnable 类中添加这一行`"Log.d("ClientActivity", "C: Sent.");"`

```
handler.sendEmptyMessage(0); 
```

您面临的问题是因为您无法从 runnable 更新 UI。处理程序将您连接到您的主 UI。因此，您必须从 Runnable 将消息传递给您的处理程序。

# html - 如何定位表格 HTML？

> ID：10610963
> 
> 赞同：11
> 
> 时间：2012-05-16T01:44:06.153
> 
> 标签：html

我试图让桌子更低，更向右，就像它原来的样子。我怎样才能做到这一点？有哪些属性？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-16T01:54:26.877

你会想使用 CSS 来实现这一点。

假设您有一个属性 id="my_table" 的表

您可能希望在您的 css 文件中写入以下内容

```
#my_table{
    margin-top:10px //moves your table 10pixels down
    margin-left:10px //moves your table 10pixels right
} 
```

如果您没有 CSS 文件，那么您可以`margin-top:10px, margin-left:10px`像这样在表格元素中添加样式属性

```
<table style="margin-top:10px; margin-left:10px;">
    ....
</table> 
```

网上有很多资源详细描述了 CSS 和 HTML

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T02:01:42.130

正如 BalausC 在评论中提到的，您可能正在寻找 CSS（层叠样式表）而不是 HTML 属性。

要定位元素，`<table>`在您的情况下，您希望使用填充或边距。

边距和填充之间的差异可以看作是“盒子模型”：

![盒子模型图像](../Images/e07f52b1a0e29304b20d17705a42a791.png)

图片来自关于边距和填充的 HTML Dog 文章[http://www.htmldog.com/guides/cssbeginner/margins/](http://www.htmldog.com/guides/cssbeginner/margins/)。

如果你需要学习如何使用 CSS，我强烈推荐上面的文章。

要向下和向右移动表格，我会使用如下边距：

```
table{
    margin:25px 0 0 25px;
} 
```

这是简写​​，所以边距如下：

```
margin: top right bottom left; 
```

# javascript - 垃圾收集：对象属性

> ID：10610964
> 
> 赞同：5
> 
> 时间：2012-05-16T01:44:38.133
> 
> 标签：javascript

假设我有一个对象，其中包含另一个对象作为其属性，例如

```
var obj = {
    '1': {...},
    '42': {...}
}; 
```

当`obj`超出范围时 - 所有嵌套对象是否隐式销毁，或者我需要显式地迭代它们`delete`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T01:51:04.797

是的，除非另一个参考仍然存在：

```
var obj = {
    '1': {...},
    '42': {...}
};

var save = obj['1'];

obj = null; 
```

垃圾回收后，假设没有创建其他引用，那么 obj 和 obj['42'] 的空间将被回收，saved 的值当然会被保留。

Mea culpa ：正如我原来的评论中提到的`delete obj`那样无效，因为`obj`被声明为`var`. 曾经`obj`是全局对象，因此是全局对象的属性，`delete`本来可以正常工作的。要有效地删除 var，请使用`obj = null`. 我在测试中学到的一件事是`delete`运算符并返回`true`or `false`。

# opencv - BFMatcher 和 FlannBasedMatcher 的区别

> ID：10610966
> 
> 赞同：25
> 
> 时间：2012-05-16T01:45:04.370
> 
> 标签：opencv

我想知道openCV`BFMatcher`和`FlannBasedMatcher`openCV之间的匹配精度或质量有什么区别。我知道`FlannBasedMatcher`应用于大型数据库时可能会更快，但是无论执行时间如何，两个匹配器最终都会找到相同的匹配项吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-22T06:55:07.160

BFMatcher 将尝试所有可能性（这是“**蛮力**”的意思，因此它会找到最佳匹配。

FLANN，意思是“**近似最近邻居的快速库**”，会快得多，但会找到近似最近的邻居。它会找到一个很好的匹配，但不一定是最好的。您可以使用 FLANN 的参数来提高精度（即匹配的“质量”），但这将以减慢算法为代价。

换句话说：FLANN 比 BFMatcher 快得多，但它只能找到一个近似的最近邻，这是一个很好的匹配，但不一定是最好的。您可以使用 FLANN 的参数来提高其速度或精度。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-06-02T17:31:51.830

为了补充上述答案，[FLANN](http://www.cs.ubc.ca/research/flann/)构建了一个有效的数据结构（KD-Tree），用于搜索近似邻居，而[cv::BFMatcher](http://docs.opencv.org/modules/features2d/doc/common_interfaces_of_descriptor_matchers.html#BFMatcher%20:%20public%20DescriptorMatcher)进行详尽搜索并保证找到最佳邻居。FLANN 的真正好处体现在大型数据集上。根据我的经验，我看到一个*合理*的好处是描述符的数量大于 1K。

# javascript - c5 文件管理器和 TinyMCE

> ID：10610974
> 
> 赞同：0
> 
> 时间：2012-05-16T01:46:07.930
> 
> 标签：javascript, tinymce

**如果有人感兴趣，那就更接近**c5 Filebrowser 如果我能让它全部工作，它看起来很酷！

**通过将以下内容添加到tinymce_jquery_full.cshtml**文件中，我有“浏览”按钮出现在 TimyMCE > 插入/编辑图像弹出窗口中

```
function myFileBrowser (field_name, url, type, win) {

var cmsURL = "../../Filemanager/index.html"

tinyMCE.activeEditor.windowManager.open({
    file : cmsURL,
    title : 'Browser',
    width : 800,  // Your dimensions may differ - toy around with them!
    height : 500,
    resizable : "yes",
    inline : "yes",  // This parameter only has an effect if you use the inlinepopups plugin!
    close_previous : "no"
}, {
    window : win,
    input : field_name
});
return false;
} 
```

和

```
file_browser_callback : 'myFileBrowser', 
```

只需将其全部添加到主目录中

```
<script type="text/javascript"> tag 
```

它工作正常

使用此按钮 c5 Filebrowser 打开，我可以正常使用它。

我可以说的是 c5 文件浏览器设置为与 CKEditor 而不是 TimyMCE 一起使用，所以这是我遇到问题的地方

然后，我在此链接上按照以下说明进行操作：

[http://forum.filemanager.corefive.com/topic/how-do-i-get-a-value-back-from-the-filemanager-for-the-selected-file](http://forum.filemanager.corefive.com/topic/how-do-i-get-a-value-back-from-the-filemanager-for-the-selected-file)

这向我展示了如何在 Filemanager 中显示“选择”按钮以及其他一些对我不起作用的信息。

如果我添加推荐的代码：

```
var selectItem = function (data) {
    var p = data['Path'];
    alert(p);
    $('#field_name', window.opener.document).val(p);
    window.close();
} 
```

对于 filemanager.js，我可以得到**alert(p);** 为了工作，它给了我想要的图像的 URL，但窗口不会关闭，更不用说将“p”的值发回 TinyMCE 弹出窗口字段了。

所以我现在有两个 javascript 弹出窗口在另一个之上打开一个，但是在 Filemanager 中选择图像时，我需要关闭文件管理器并将“p”的值传递回 TimyMCE 的“插入/编辑”的“scr”字段图片”弹出表单。

好难解释！

调用所有 Javascript 向导寻求帮助？

**下面是原帖**

有谁知道有关如何集成 c5 Filemanager (http://forum.filemanager.corefive.com/#home) 和 TinyMCE 的教程，我进行了一些搜索，但找不到太多！我想在 TinyMCE 上的插入/编辑图像弹出窗口中添加一个浏览按钮，然后打开文件管理器并在单击图像 URL 字段时填充图像 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T00:48:28.147

完成，一切都在 TinyMCE 网站上：

[http://www.tinymce.com/wiki.php/How-to_implement_a_custom_file_browser](http://www.tinymce.com/wiki.php/How-to_implement_a_custom_file_browser)

我只是在页面下方看的不够远，我猜是因为我很惊讶 TinyMCE 会在这个问题上提供如此多的帮助。

```
var selectItem = function(data){
    var url = relPath + data['Path'];

    if(window.tinyMCEPopup){
        // use TinyMCE > 3.0 integration method
        var win = tinyMCEPopup.getWindowArg("window");
        win.document.getElementById(tinyMCEPopup.getWindowArg("input")).value = url;
        if (typeof(win.ImageDialog) != "undefined") {
            // Update image dimensions
            if (win.ImageDialog.getImageData)
                win.ImageDialog.getImageData();

            // Preview if necessary
            if (win.ImageDialog.showPreviewImage)
                win.ImageDialog.showPreviewImage(url);
        }
        tinyMCEPopup.close();
        return;
    }
} 
```

该代码已经存在于 filemanager.js 中，您只需删除所有 if(window.opener){ 代码，一切正常！

对于 c5 文件管理器和 TinyMCE 的所有人员，热爱您的工作！

# ruby-on-rails - '警告：通过自制软件安装弹性搜索时，非可执行文件已安装到“bin”'

> ID：10610976
> 
> 赞同：2
> 
> 时间：2012-05-16T01:46:22.280
> 
> 标签：ruby-on-rails, ruby-on-rails-3, elasticsearch, homebrew, railscasts

我正在关注这个[railscast](http://railscasts.com/episodes/306-elasticsearch-part-1)，以便在我的 rails 应用程序中使用 elasticsearch。当我像 railscast 节目一样使用自制软件安装它时，我收到此警告

```
Warning: Non-executables were installed to "bin".
Installing non-executables to "bin" is bad practice.
The offending files are:
/usr/local/Cellar/elasticsearch/0.19.3/bin/elasticsearch.in.sh 
```

当他使用相同的自制命令安装它时，此警告不会出现在 railscast 中。一路上我有没有搞砸什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:22:54.330

railscast 早于这个特定的警告。

它的存在是为了让 Homebrew 开发人员可以找到并清理正在做讨厌事情的包，但它不会影响软件的实际使用。

# mysql - MySQL Summing，每行都有一个代数表达式

> ID：10610978
> 
> 赞同：0
> 
> 时间：2012-05-16T01:46:36.053
> 
> 标签：mysql, select, sum

让我们开始吧。

这将返回正确的结果：

```
SELECT sum(w.weight * w.repetitions)
FROM workout_exercise_logs w
JOIN workout_logs wo ON `w`.`workoutLogID`=`wo`.`workoutLogID`
JOIN workouts wor ON `wo`.`workoutID`=`wor`.`workoutID`
WHERE w.weightType=1 and `wor`.`userID`=34 
```

但是当我添加时`+ w.weight * w.seconds / 3`，我得到了一个`NULL`结果：

```
SELECT sum(w.weight * w.repetitions + w.weight * w.seconds / 3)
FROM workout_exercise_logs w
JOIN workout_logs wo ON `w`.`workoutLogID`=`wo`.`workoutLogID`
JOIN workouts wor ON `wo`.`workoutID`=`wor`.`workoutID`
WHERE w.weightType=1 and `wor`.`userID`=34 
```

表达式有什么问题，我该如何解决？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T02:01:37.283

一个问题，你是否真的需要这个字段可以为空（或任何相关的字段）：秒？

如果这是一个要求，您需要将这些可为空的字段合并为零：

```
SELECT sum(
      w.weight * w.repetitions 
      + w.weight * coalesce(w.seconds,0) / 3)
FROM workout_exercise_logs w
JOIN workout_logs wo ON `w`.`workoutLogID`=`wo`.`workoutLogID`
JOIN workouts wor ON `wo`.`workoutID`=`wor`.`workoutID`
WHERE w.weightType=1 and `wor`.`userID`=34 
```

# javascript - 带单选按钮和文本框的 Javascript 表单计算

> ID：10610980
> 
> 赞同：0
> 
> 时间：2012-05-16T01:46:49.980
> 
> 标签：javascript, jquery, html, forms, javascript-events

jQuery 库未正确导入，单击按钮时表单未在 BAC 字段中显示答案。从这一点来看，答案应该是比较简单的。请检查 BAC 字段的显示代码。

```
 <html>
    <head>
    <meta charset="utf-8" />
    <title>bac2</title>
    </head>
    <body>
    <p></p>
        <form action="" id="bacForm">
        <input type="radio" name="gender" value="male" /> Male<br /><br>
        <input type="radio" name="gender" value="female" /> Female<br><br>
        Weight <input type="text" name="weight" id="weight"/><br><br>
        Hours  <input type="text" name="hours" id="hours" /><br><br>
        Drinks <input type="text" name="drinks" id="drinks"/><br><br>
        <INPUT TYPE="button" value="submit" name="submit"><br><br>
        BAC: <input type="text" name="bac" id="bac"/>

        </form>         

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>           
    <script type="text/javascript">
            $('#submit').click(function(){

        var gender = $('input[name=gender]:checked', '#bacForm').val();
        var weight = parseInt($('#weight').val()) || 0;
        var hours = parseInt($('#hours').val()) || 0;
        var drinks = parseInt($('#drinks').val()) || 0;
        var bac = 0;

        if (gender=="male"){
            bac = ((drinks * .06 * 100 * 1.055) / (weight * .68)) - (0.015 * hours);
        }else if(gender=="female"){
            bac = ((drinks * .06 * 100 * 1.055) / (weight * .55)) - (0.015 * hours);
        }
        $('#bac').val(bac);

    });

    </script>   

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:05:35.000

我敢肯定你只是在学习 JS，但是你已经以一种非常不必要、令人费解和复杂的方式编写了所有这些代码。您可以大大简化该代码，请参见以下示例（注意我使用 jQuery 只是为了更容易获取值）

```
// get values
var bac = 0;
var gender = $('input[name="gender"]:checked').val();
var weight = $('#weight').val();
var hours = $('#hours').val();
var drinks = $('#drinks').val();

// calculate bac
if ( gender == 'male' ) {
    bac = ((drinks * .06 * 100 * 1.055) / (weight * .68)) - (0.015 * hours);
}
else {
    bac = ((drinks * .06 * 100 * 1.055) / (weight * .55)) - (0.015 * hours);
}

// round to 2 decimal places
bac = Math.round(bac * 100) / 100;

$('#bac').val(bac); 
```

[你可以在http://jsfiddle.net/dYhpC/](http://jsfiddle.net/dYhpC/)上看到这个直播

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T02:23:17.273

你说你在寻找简单，所以我拼凑了一个快速的 jQuery fiddle，展示了一个更简单的方法。在这里查看：http: [//jsfiddle.net/brianmat/rQLtE/](http://jsfiddle.net/brianmat/rQLtE/)

主要代码如下

```
$('#submit').click(function(){

    var gender = $('input[name=gender]:checked', '#bacForm').val();
    var weight = parseInt($('#weight').val()) || 0;
    var hours = parseInt($('#hours').val()) || 0;
    var drinks = parseInt($('#drinks').val()) || 0;
    var bac = 0;

    if (gender=="male"){
        bac = ((drinks * .06 * 100 * 1.055) / (weight * .68)) - (0.015 * hours);
    }else if(gender=="female"){
        bac = ((drinks * .06 * 100 * 1.055) / (weight * .55)) - (0.015 * hours);
    }
    $('#answer').val(bac);

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T02:01:28.513

回答您的问题：是的，确实可以使用单选按钮和文本框中的值来执行计算。

对于您的具体情况，您需要提出更具体的问题。尝试在您的代码中放置一些断点，看看它执行时会发生什么......当发布一个问题时，请告诉我们它在哪里做了与您的期望不同的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:26:37.720

这是成品： [http](http://bac.klinetel.com/) ://bac.klinetel.com/ ；我必须说一个体面的大学工具。

# php - SQL 语句不会在字段名称周围没有“`”的情况下运行

> ID：10610987
> 
> 赞同：1
> 
> 时间：2012-05-16T01:48:13.200
> 
> 标签：php, sql, phpmyadmin

我正在运行一个应用程序，并且在我的一个 sql 表上，它不会运行查询，除非“`”字符在字段名称周围，我不知道为什么需要这样做？

例如

```
INSERT INTO doc_elements (doc_pdf_id, element_type, class, id, order, create_timestamp) VALUES ('37', 'p', 'ft2', '0', '3', '1337130927') 
```

不会起作用，但这会起作用：

```
INSERT INTO `doc_elements`(`doc_pdf_id`, `element_type`, `class`, `id`, `order`, `create_timestamp`) VALUES ('37', 'p', 'ft2', '0', '3', '1337130927') 
```

它是数据库中唯一需要将“`”包裹在字段名称周围以便给出正确的 sql 语句的表。

我可以在另一个表中完美运行：

```
INSERT INTO doc_pdfs (act_id, upload_stamp) VALUES ('xxxxx12234', '1337130927') 
```

相关表的表结构：

```
CREATE TABLE IF NOT EXISTS `doc_elements` (
`doc_elements_id` int(15) NOT NULL auto_increment,
`doc_pdf_id` int(11) NOT NULL,
`element_type` varchar(20) NOT NULL,
`class` varchar(100) default NULL,
`id` varchar(100) default NULL,
`order` int(11) NOT NULL,
`parent_element` int(15) default NULL,
`active` tinyint(1) NOT NULL default '1',
`create_timestamp` int(20) NOT NULL,
`sys_stamp` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
PRIMARY KEY  (`doc_elements_id`),
KEY `doc_pdf_id` (`doc_pdf_id`),
KEY `parent_element` (`parent_element`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=10 ; 
```

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T01:49:58.667

`ORDER`是 MySQL 中的[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。

# python - django 和 celery+rabbitmq 的消费者连接错误？

> ID：10610991
> 
> 赞同：11
> 
> 时间：2012-05-16T01:48:38.857
> 
> 标签：python, django, rabbitmq, celery, django-celery

我正在尝试用 django 和 rabbit-mq 设置 celeryd。到目前为止，我已经完成了以下工作：

*   从 pip 安装的芹菜
*   通过其存储库中可用的 deb 安装 rabbitmq
*   通过 rabbitmqctl 向 rabbitmq 添加了用户和虚拟主机，以及该用户的权限
*   启动rabbitmq-server
*   通过 pip 安装 django-celery
*   设置 django-celery，包括它的表
*   在settings.py中配置好各种东西（BROKER_HOST、BROKER_PORT、BROKER_USER、BROKER_PASSWORD、BROKER_VHOST，以及导入djecelery，调用setup函数并添加到INSTALLED APPS）。我已经仔细检查了所有这些值都是正确的（至少，用户、密码和虚拟主机是正确的）。

所以现在，当我运行时`python manage.py celeryd -l info`出现连接错误（见下文）。有人知道为什么吗？

```
$ python manage.py celeryd -l info
/usr/local/lib/python2.7/dist-packages/djcelery/loaders.py:108: UserWarning: Using settings.DEBUG leads to a memory leak, never use this setting in production environments!
  warnings.warn("Using settings.DEBUG leads to a memory leak, never "
[2012-05-15 18:38:04,486: WARNING/MainProcess]  

 -------------- celery@ubuntu v2.5.3
---- **** -----
--- * ***  * -- [Configuration]
-- * - **** ---   . broker:      amqp://celeryuser@localhost:5672/celeryhost
- ** ----------   . loader:      djcelery.loaders.DjangoLoader
- ** ----------   . logfile:     [stderr]@INFO
- ** ----------   . concurrency: 1
- ** ----------   . events:      OFF
- *** --- * ---   . beat:        OFF
-- ******* ----
--- ***** ----- [Queues]
 --------------   . celery:      exchange:celery (direct) binding:celery

[Tasks]

[2012-05-15 18:38:04,562: INFO/PoolWorker-1] child process calling self.run()
[2012-05-15 18:38:04,565: WARNING/MainProcess] celery@ubuntu has started.
[2012-05-15 18:38:07,572: ERROR/MainProcess] Consumer: Connection Error: [Errno 104] Connection reset by peer. Trying again in 2 seconds...
^C[2012-05-15 18:38:08,434: WARNING/MainProcess] celeryd: Hitting Ctrl+C again will terminate all running tasks!
[2012-05-15 18:38:08,435: WARNING/MainProcess] celeryd: Warm shutdown (MainProcess)
[2012-05-15 18:38:09,372: INFO/PoolWorker-1] process shutting down
[2012-05-15 18:38:09,373: INFO/PoolWorker-1] process exiting with exitcode 0
[2012-05-15 18:38:09,376: INFO/MainProcess] process shutting down 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T21:46:13.287

你的问题在`BROKER_URL`.

加上一个额外`VHOST`的 ，正确的配置将是：

```
BROKER_URL='amqp://celeryuser@localhost:5672//'
BROKER_VHOST='/celeryhost' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-27T13:11:49.197

对我来说，以下 URL 结尾有效： ...@localhost:5672/celeryvhost

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-29T11:24:08.347

我对 RabbitMQ 有类似的问题，问题是我的用户无权在 RabbitMQ 中创建消息。

*尝试使用访客*用户在您的 RabbitMQ 服务器上运行以下脚本，如果它创建作业，请使用您的用户尝试：

```
from celery import Celery

app = Celery('tasks', broker='amqp://radek:**@localhost:5672//')

@app.task
def add(x, y):
    return x + y 
```

如果您遇到相同的错误，只需为您的用户设置权限：

```
rabbitmqctl set_permissions -p / radek ".*" ".*" ".*" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T04:30:33.690

你的 rabbitmq 服务器不能正常启动和/或配置。验证它并再试一次 - 或者，更好的是，如果你只是想测试一些东西并且你与队列无关，取出 rabbitmq 并开始使用 redis。它更容易配置。

我刚刚从我的一个项目中剪切并粘贴了这段代码，它工作得很好：

```
import djcelery
from datetime import timedelta

djcelery.setup_loader()

BROKER_BACKEND = "redis"
BROKER_HOST = "localhost"
BROKER_PORT = 6379
BROKER_VHOST = "0"

CELERYD_LOG_LEVEL  = 'DEBUG'
CELERY_RESULT_BACKEND = "redis"
CELERY_TASK_RESULT_EXPIRES = 150000
REDIS_HOST = "localhost"
REDIS_PORT = 6379
REDIS_DB = "0"
CELERYD_CONCURRENCY = 1
CELERYD_MAX_TASKS_PER_CHILD = 4

CELERY_IMPORTS = (
    "apps.app1.tasks",
    "apps.app2.tasks",
) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-10T21:47:39.850

您的 BROKER_URL 在 settings.py 中是什么样的？

默认情况下，RabbitMQ 有一个访客用户，所以如果你可以连接

```
BROKER_URL = "amqp://guest:guest@localhost:5672//" 
```

那么问题是您对 RabbitMQs 用户、密码或虚拟主机的设置。

# android - 图片背景问题android

> ID：10610998
> 
> 赞同：0
> 
> 时间：2012-05-16T01:50:04.660
> 
> 标签：android, image, background, android-gallery

我正在开发应用程序，它从图库中读取图像，并成为布局中的背景，我使用了以下代码，但是一旦我单击图片，它就会给我强制关闭错误，这是代码

```
 Intent intent = new Intent();
     intent.setType("image/*");
     intent.setAction(Intent.ACTION_GET_CONTENT);
     startActivityForResult(Intent.createChooser(intent, "Select Picture"),0); 
```

和

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        {
            super.onActivityResult(requestCode, resultCode, data);

        if(resultCode == Activity.RESULT_OK && requestCode == 0) {
            Uri photo = imageUri;
            ContentResolver resolver = getContentResolver();
            resolver.notifyChange(photo, null);

            try {                   
                Bitmap bitmap = MediaStore.Images.Media.getBitmap(resolver, photo);
                RelativeLayout bg = (RelativeLayout) findViewById(R.id.bg);
                Drawable drawable = new BitmapDrawable(getResources(), bitmap);
                bg.setBackgroundDrawable(drawable);

            //Do something useful with your bitmap
                } catch (FileNotFoundException e) {
                e.printStackTrace();
                } catch (IOException e) {
                e.printStackTrace();
            }
        }
        }
    } 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <RelativeLayout
        android:id="@+id/bg"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.92"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/linearLayout2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="0.88"
            android:orientation="vertical" >

        </LinearLayout>
    </RelativeLayout>

    <Button
        android:id="@+id/button"
        android:layout_width="143dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Save" />

</LinearLayout> 
```

这是我的错误日志

```
05-16 20:20:23.768: W/dalvikvm(288): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
05-16 20:20:24.098: E/AndroidRuntime(288): FATAL EXCEPTION: main
05-16 20:20:24.098: E/AndroidRuntime(288): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=0, result=-1, data=Intent { dat=content://media/external/images/media/1 }} to activity {org.example.touch/org.example.touch.Touch}: java.lang.NullPointerException
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread.deliverResults(ActivityThread.java:3515)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread.handleSendResult(ActivityThread.java:3557)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread.access$2800(ActivityThread.java:125)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2063)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.os.Looper.loop(Looper.java:123)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-16 20:20:24.098: E/AndroidRuntime(288):  at java.lang.reflect.Method.invokeNative(Native Method)
05-16 20:20:24.098: E/AndroidRuntime(288):  at java.lang.reflect.Method.invoke(Method.java:521)
05-16 20:20:24.098: E/AndroidRuntime(288):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-16 20:20:24.098: E/AndroidRuntime(288):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-16 20:20:24.098: E/AndroidRuntime(288):  at dalvik.system.NativeStart.main(Native Method)
05-16 20:20:24.098: E/AndroidRuntime(288): Caused by: java.lang.NullPointerException
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.os.Parcel.readException(Parcel.java:1253)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.os.Parcel.readException(Parcel.java:1235)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.content.IContentService$Stub$Proxy.notifyChange(IContentService.java:458)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.content.ContentResolver.notifyChange(ContentResolver.java:850)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.content.ContentResolver.notifyChange(ContentResolver.java:836)
05-16 20:20:24.098: E/AndroidRuntime(288):  at org.example.touch.Touch.onActivityResult(Touch.java:117)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.Activity.dispatchActivityResult(Activity.java:3890)
05-16 20:20:24.098: E/AndroidRuntime(288):  at android.app.ActivityThread.deliverResults(ActivityThread.java:3511)
05-16 20:20:24.098: E/AndroidRuntime(288):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:16:47.713

它成功加载图像并设置为背景，但是当我尝试加载更大的图像时崩溃，即 8mpx 相机图像等。我设法通过以下代码解决了这个问题：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        {
            super.onActivityResult(requestCode, resultCode, data);

            if (resultCode == Activity.RESULT_OK && requestCode == 0) {
                Uri photo = data.getData();
                ContentResolver resolver = getContentResolver();
                resolver.notifyChange(photo, null);

                Display currentDisplay = getWindowManager().getDefaultDisplay();
                int dw = currentDisplay.getWidth();
                int dh = currentDisplay.getHeight() / 2 - 100;
                try {
                    // Load up the image's dimensions not the image itself
                    BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
                    bmpFactoryOptions.inJustDecodeBounds = true;
                    Bitmap bmp = BitmapFactory.decodeStream(
                            getContentResolver().openInputStream(photo), null,
                            bmpFactoryOptions);
                    int heightRatio = (int) Math
                            .ceil(bmpFactoryOptions.outHeight / (float) dh);
                    int widthRatio = (int) Math.ceil(bmpFactoryOptions.outWidth
                            / (float) dw);
                    if (heightRatio > 1 && widthRatio > 1) {
                        if (heightRatio > widthRatio) {
                            bmpFactoryOptions.inSampleSize = heightRatio;
                        } else {
                            bmpFactoryOptions.inSampleSize = widthRatio;
                        }
                    }
                    bmpFactoryOptions.inJustDecodeBounds = false;
                    FrameLayout bg = (FrameLayout) findViewById(R.id.frame);
                    bmp = BitmapFactory.decodeStream(getContentResolver()
                            .openInputStream(photo), null, bmpFactoryOptions);
                    // bg.setImageBitmap(bmp);
                    Drawable drawable = new BitmapDrawable(getResources(), bmp);
                    bg.setBackgroundDrawable(drawable);
                } catch (FileNotFoundException e) {
                    Log.v("ERROR", e.toString());
                }
            }
        }
    } 
```

这对所有图像都非常有效。希望它会帮助别人！

# html - 相对最大宽度的预期行为是什么

> ID：10610999
> 
> 赞同：0
> 
> 时间：2012-05-16T01:50:05.577
> 
> 标签：html

我有这段代码，我将两个图像的最大宽度设置为最大宽度：50%。起初我期望每张图片都会拉伸到屏幕的 50%，就好像我设置了宽度：50%，但行为是不同的，并且在所有浏览器中实际上是一致的。

这种行为是否有效？

*Ps 这种行为实际上是我试图实现的，所以没有**什么可以修复的***

```
<img id="hplogo-img" src="//www.google.com/logos/2002/w_olympics_02-1.gif"><img id="hplogo-img2" src="//www.google.com/logos/2002/newyear02.gif">

    img
    {
    height:100px;
    max-width:50%
    }​ 
```

滑动框架收缩和展开页面：http: [//jsfiddle.net/fQjXV/](http://jsfiddle.net/fQjXV/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:03:50.027

max-width 就是这样 - 最大宽度。它不要求该项目实际采用该宽度，只是它不超过它。因此，在没有任何其他限制的情况下，图像只会采用它们的自然宽度（在这种情况下，缩放以保持纵横比与 100 像素的高度相同），只要它不超过容器的 50%。当你收缩容器时，最大宽度随之减小，当最大宽度变得小于图像的默认宽度时，图像收缩到容器宽度的 50%。高度不会改变，因为它是明确设置的。