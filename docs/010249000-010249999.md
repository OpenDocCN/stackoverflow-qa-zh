# StackOverflow 问答 10249000-10249999

# asp-classic - 使用经典 ASP 设置 Google 天气预报

> ID：10249008
> 
> 赞同：0
> 
> 时间：2012-04-20T15:23:30.477
> 
> 标签：asp-classic

只是一点背景，我们的营销部门一直在他们的标牌上使用静态天气图像，并询问是否可以提取实时更新的内容。由于我是我们部门中唯一具有任何类型编程经验的人，而且我充其量只是个新手，因此我被要求提出解决方案。过去我曾在其他几个小项目中使用过经典 asp，所以我决定走这条路。除了扩展的预测数据外，我的一切都按照我想要的方式工作。在下面的示例中，我有我想用 For 语句显示的变量，以提取每天的扩展预测 xml 数据。但由于某种原因，它只是拉动了延长预测的最后一天。

```
If (objXMLDOM.parseError.errorCode <> 0) Then
Response.Write("<p>Error parsing XML: " & objXMLDOM.parseError.reason & "</p>")
Else
  For i = 0 to 3  
    Set objFuture = objXMLDOM.getElementsByTagName("forecast_conditions").Item(i) 'pull the XML node for each from one to three
    For Each xmlNode In objFuture.childNodes 'loop through the dom tree
        If (xmlNode.nodeName = "icon") Then
            strIcon1 = "<img src=""http://www.google.com" & xmlNode.Attributes.getNamedItem("data").text & """ border=""0"">" & vbCrLf
         End If
        If (xmlNode.nodeName = "condition") Then
            strCondition1 = xmlNode.Attributes.getNamedItem("data").text & vbCrLf
         End If
        If (xmlNode.nodeName = "low") Then
            strLow = xmlNode.Attributes.getNamedItem("data").text & vbCrLf
         End If 
        If (xmlNode.nodeName = "high") Then
            strHigh = xmlNode.Attributes.getNamedItem("data").text & vbCrLf
         End If     
        If (xmlNode.nodeName = "day_of_week") Then
            strDay = xmlNode.Attributes.getNamedItem("data").text & vbCrLf
         End If     
     Set objFuture = nothing    
    Next    
Next
End if 
```

然后，我使用以下代码将 4 天的预测输出到我的主页中：

```
<%For Each Item in objXMLDOM.getElementsByTagName("forecast_conditions")
  Response.Write ("<td>" & strDay  & "<br>" & strIcon1 & "<br>" & strCondition1   & "<br>" & "Low:&nbsp" & strLow & "&deg;F" & "<br>" & "High:&nbsp" & strHigh & "&deg;F" & "<br>" & "</td>")
 Next %> 
```

我已经断断续续地看了几天了，似乎无法找到我每天缺少的东西，而不是最后一个。如果有人有任何建议，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:51:02.327

您正在使用同一组变量来存储每天的预测数据。因此，在循环的每次迭代中，您`for`都会覆盖前一天的信息。

解决方案是将写入数据的代码移动到第一个循环内的屏幕上`for`，如下所示：

```
If (objXMLDOM.parseError.errorCode <> 0) Then
    Response.Write("<p>Error parsing XML: " & objXMLDOM.parseError.reason & "</p>")
Else
    For i = 0 to 3  
        Set objFuture = objXMLDOM.getElementsByTagName("forecast_conditions").Item(i) 
        For Each xmlNode In objFuture.childNodes

            ...

        Next 

        ' Write to the page here
        Response.Write ("<td>" & strDay  & "<br>" & strIcon1 & "<br>" & strCondition1   & "<br>" & "Low:&nbsp" & strLow & "&deg;F" & "<br>" & "High:&nbsp" & strHigh & "&deg;F" & "<br>" & "</td>")

    Next
End if 
```

# java - 开发 Android 应用时的最佳实践

> ID：10249011
> 
> 赞同：0
> 
> 时间：2012-04-20T15:23:39.203
> 
> 标签：java, android, android-layout, exception-handling, try-catch

你们中的大多数人可能会认为这是一个非常笼统的问题，但我仍然觉得我应该这样做：

**开发 android 应用程序时的最佳实践是什么，以便它可以以不强制关闭的方式处理错误？**

我问这个是因为我是开发android应用程序的新手，而且我在努力关闭很多......我猜这一定是设计APP的一种方式，这样它就可以避免在出现问题时强制关闭（例如：没有互联网）知道我正在使用 try/catch 但它似乎不是一种非常程序化和干净的做事方式，**除了 try/catch 是否还有其他处理异常的选项？**

如果你们可以发送一些关于这个主题的好的文档或一些示例代码的链接，我将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:36:28.160

强制关闭发生在未捕获异常的情况下。您应该能够通过良好的编码实践来避免它们，并且通常在自己之后进行清理。如果您对特定的强制关闭方案有疑问，请发布有关它的问题，我们会看看我们能做些什么。

您的问题的非常具体的答案（在这种情况下可能是一个非常糟糕的主意）是您可以使用[全局默认未捕获异常处理程序](https://stackoverflow.com/questions/2764394/ideal-way-to-set-global-uncaught-exception-handler-in-android)，它将取代 Google“强制关闭”对话框。如果您有一个非常完善的应用程序并且要防止生产中的罕见错误或想要使用除 Google 市场默认设置之外的其他一些日志记录/报告功能，这通常是一个好主意。

请注意，这不会阻止异常；它只会将它们传递给默认 Google 处理程序以外的其他地方。

如果您是 Android 新手，您可能会在 Android[`Activity`](http://developer.android.com/reference/android/app/Activity.html)生命周期中发现一些用于持久化数据或查看线程的用途（这两种情况下，如果您不考虑它，您可以强制关闭它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:29:26.100

实际上，强制关闭只是您的应用程序出现问题的症状。Try/catch 是在 java（和 android）中使用的一种很好的机制，可以使您的应用程序更加健壮并在出现错误时声明一些行为。

我不同意其他评论。构建应用程序并预​​见所有可能发生的异常/错误是相当困难的。所以不要担心没有强制关闭，你应该更好地关注如何阅读它们，了解日志猫跟踪并找出导致强制关闭的错误。

编程容易出错且困难重重，而且它总是被尝试和获取错误并纠正错误的过程所影响。所以不要绝望，你在正确的轨道上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:38:14.207

正如您自己所说，这是一个非常广泛的问题。您应该阅读 android 开发者网站上的“最佳实践”部分。此外，有关响应性，请参阅[此页面](http://developer.android.com/guide/practices/design/responsiveness.html)。

至于其他处理异常而不是 try/catch 的方式，坏消息；空无一人。但是您可以做的是在使用资源之前检查其可用性。在实际使用之前，您可以检查许多事情，包括互联网访问。我不能在这里列出所有这些，但你会随着时间的推移而学习。[这篇文章](https://stackoverflow.com/questions/4238921/android-detect-whether-there-is-an-internet-connection-available)将告诉您如何检查互联网可用性。

希望这可以帮助。

# security - 使用 DirectorySearcher 时转义密码？

> ID：10249017
> 
> 赞同：0
> 
> 时间：2012-04-20T15:24:40.747
> 
> 标签：security, active-directory, ldap

我试图弄清楚我们是否需要转义密码（我们确实转义用户名），如果您正在使用`DirectorySearcher`并通过`DirectoryEntry`用户名和密码集传递它。

这是代码简写：

```
var directoryEntry = new DirectoryEntry(domain);
directoryEntry.Username = escaped(username);
directoryEntry.Password = password;

new DirectorySearcher(directoryEntry)
{
SearchScope = searchScope,
Filter = "(&(objectCategory=person)(objectClass=user)" + escaped(filter) + ")"
}; 
```

不转义密码会使代码容易被注入吗？转义密码会导致验证`DirectoryEntry`失败吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:57:03.200

您无需转义为绑定传入的用户名或密码。

# database - 执行查询时，hive 是否运行 hadoop？

> ID：10249020
> 
> 赞同：2
> 
> 时间：2012-04-20T15:24:47.397
> 
> 标签：database, hadoop, hive

我试图了解 hive 和 hadoop 是如何交互的。从我读过的教程中，我似乎在运行 HIVE 查询之前运行了一个 map/reduce 作业来获取输入数据。这对我来说似乎适得其反，如果我已经运行了 map/reduce 作业并以易于解析的格式获取数据，为什么我不将数据放入传统数据库中。

谢谢你的帮助，内森

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T15:50:57.493

Hive 对存储在 HDFS 上的文件进行操作。除了最简单的查询之外，hive 会生成并运行 mapreduce 作业。对于非常简单的查询 ( `SELECT * FROM MyTable`)，它只会从磁盘流式传输文件。

输入数据不需要来自 MapReduce - 它可以是上传到 HDFS 的简单文本文件。见[http://developer.yahoo.com/hadoop/tutorial/module2.html#commandref](http://developer.yahoo.com/hadoop/tutorial/module2.html#commandref)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:07:06.637

Hive 通过提供海量并行处理数据库的功能填补了开源软件中非常重要的空白。在其他世界 - 它为我们提供了水平可扩展的分析 SQL 引擎。
具体到您的问题，当 Hive 比 RDMS 更好时，我可以看到一些主要场景。
a) 数据已经在 HDFS 中，我们还有一些其他用途（例如 MR 作业）
b) 有太多数据要加载到单服务器 RDMBS 中。
c) 我们只需要查询一次或两次数据。在这种情况下，Hive 的数据加载时间相对较慢，可以胜过 RDMBS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-30T13:53:54.470

是的。Hive 建立在具有分布式计算的 Hadoop 之上。Hive 访问 HDFS 以存储文件。每个表都作为文件存储在 HDFS 上。

# django - Django通过按钮单击添加文本

> ID：10249021
> 
> 赞同：0
> 
> 时间：2012-04-20T15:24:52.137
> 
> 标签：django, textfield

使用 Django，我想存储一个最初为空的文本字段列表，但是当您单击按钮时，它将添加一个文本字段。一个很好的例子是在电子邮件中添加附件，除了我只想添加文本字段而不是添加文件。

然后，一旦我有了这个功能设置，我希望能够将所有文本字段添加到一个文本字段中，以允许用户一次编辑所有文本字段，然后将它们解析回原始文本字段。

这可能吗？

谢谢

库珀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:11:07.530

如果您不需要添加无限数量的输入，我的建议是使用自定义 MultiValueField 和 MultiWidget 的组合，并显示/隐藏您最初可能想要隐藏的字段。

您将能够利用内置的 compress 和 decompress 方法来获取值并将它们拆分回单独的输入（您必须在分隔符上拆分文本），然后获取单独的值并将它们压缩回来合而为一。

如果您需要能够添加无限数量的字段，并将它们解析回一个值，我会使用一个表单集来保存这些值，如果需要，您可以将值连接回另一个字段，或者只是显示在一个循环中，如果您只需要将它们显示为一个字段。

# c - C - 为什么有人应该将 argv 字符串复制到缓冲区？

> ID：10249026
> 
> 赞同：6
> 
> 时间：2012-04-20T15:25:25.393
> 
> 标签：c, buffer-overflow, argv

我今天正在学习缓冲区溢出，并且遇到了许多易受攻击的程序示例。让我好奇的是，如果有任何理由使用这样的程序参数：

```
int main(int argc, char *argv[])
{
    char argument_buffer[100];
    strcpy(argument_buffer, argv[1]);

    if(strcmp(argument_buffer, "testArg") == 0)
    {
        printf("Hello!\n");
    }
    // ...
} 
```

而不是简单地：

```
int main(int argc, char *argv[])
{
    if(strcmp(argv[1], "testArg") == 0)
    {
        printf("Hello!\n");
    }
} 
```

请注意，我知道`strcpy`等的缺点 - 这只是一个例子。我的问题是 -**使用临时缓冲区来存储来自 argv 的参数有什么真正的理由**吗？我假设没有，但因此我很好奇，为什么它出现在溢出示例中，而实际上它从未使用过？也许是因为纯粹的理论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:42:14.067

一个可能的现实示例：重命名`*.foo`为`*.bar`;的程序 您将需要原始文件名和它的副本，其中`.foo`部分更改`.bar`为调用[`rename()`.](http://linux.die.net/man/2/rename)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:53:48.787

一些程序在文件名前面加上默认路径：

```
void OpenLogFile (const char *fileName) {
  char pathName[256];
  sprintf(pathName, "/var/log/%s", fileName);
  logFd = open(pathName, ...);
  ...
}

int main (int argc, char **argv) {
  ...
  OpenLogFile(argv[i]);
  ...
} 
```

如果调用程序的实体传入的名称长于 255-9 左右，`sprintf`则覆盖结束后的`pathName`, 和繁荣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:55:03.387

在过去，IIRC argv 及其内容不能保证在所有平台上都是可写和稳定的。C89 / C90 / ANSI-C 标准化了一些现有的做法。与 envp[] 类似。也可能是复制程序的灵感来自于旧平台（例如 MS-DOS）上缺乏内存保护。通常（并且现在）操作系统和/或 CRT 负责将 args 从调用者的内存复制到进程的私有内存区域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T15:36:17.907

我不是在缓冲区溢出或安全性方面回答这个问题，而是严格回答为什么有人可能想要复制 argv 的内容。

如果您的程序接受很多参数，例如会更改执行路径或处理模式的标志，您可能希望将 argv 的内容直接传输到日志文件，或者将其临时存储在缓冲区中。如果对 argv 的内容做出的所有决定都发生在 main 中，并且您仍想记录 argv 的内容，则可能不需要复制到缓冲区。

如果您依赖已调度的线程、进程，甚至是基于 argv 内容做出决策的子例程，您可能希望将 argv 值放在缓冲区中，以便您可以传递它们。

## 编辑：

如果您担心传递指针，请将 argv 的内容复制到固定大小的缓冲区。

# php - Mongo/PHP - 连接失败打印明文密码

> ID：10249031
> 
> 赞同：0
> 
> 时间：2012-04-20T15:25:39.467
> 
> 标签：php, mongodb

如果我的 mongo 数据库已关闭，我的 php 应用程序将在错误中打印出明文密码。我怎样才能防止这种情况？

```
Fatal error: Uncaught exception 'MongoCursorException' with message 
'couldn't send command' in /ap/db.php:23     Stack trace: 
#0 /ap/db.php(23): MongoDB->authenticate('username', 'actual_password') 
#1 /ap/index.php(6): Worker->__construct() #2 {main} thrown in /ap/db.php 
on line 23 
```

我知道我可以禁用 php 错误，但这不是我想要做的。我想看到一个错误，但我不希望它打印密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:43:22.047

在生产应用程序中，用户***永远不会***看到像“未捕获异常”这样的错误或其他面向开发人员的消息。这会将大量信息暴露给潜在的攻击者，并使您的合法用户感到困惑。记录详细的技术消息并向用户显示友好的错误页面。

要禁用可见错误并改为记录它们，请编辑`php.ini`：

*   设置`error_log`为有效的日志路径
*   设置`display_errors`为**关闭**。

启用友好错误的过程取决于您的 Web 服务器，但思路是一样的：设置一个自定义页面，在遇到 500 错误时显示。例如，在 Apache 中，您设置`ErrorDocument 500 /path/to/custom/500.html`.

**编辑 ：**

OP 表示这是一个开发框——无论哪种方式，您都应该将连接尝试包装在 try/catch 块中（无论如何您都应该这样做），然后您可以显示“已清理”错误消息：

```
try {
  MongoDB->authenticate('username','password');
} catch (MongoCursorException $e) {
  die("Unable to authenticate to database [code: " . $e->getCode() . "]: "
    . $e->getMessage());
} 
```

# git - 如何从标签中永久删除 git 中的文件？

> ID：10249032
> 
> 赞同：2
> 
> 时间：2012-04-20T15:25:42.980
> 
> 标签：git

`git filter-branch -f --index-filter 'git rm -r --cached --ignore-unmatch mysql_db' HEAD`

这就是我正在做的删除`mysql_db`，这很好。但现在我必须从我所有的标签中做到这一点。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T15:31:31.637

您还必须重写标记名（然后它们将指向重写的提交）：

```
git filter-branch -f \
  --index-filter 'git rm -r --cached --ignore-unmatch mysql_db' \
  --tag-name-filter 'cat' -- --all 
```

用于`--all`重写所有提交，而不仅仅是那些可从当前提交访问的`HEAD`提交。

从[git filter-branch 的联机帮助页](http://schacon.github.com/git/git-filter-branch.html)：

> *`--tag-name-filter`*
> 
> […]
> 
> 原有标签不会被删除，但可以被覆盖；使用“--tag-name-filter cat”来简单地更新标签。在这种情况下，请务必小心并确保备份旧标签，以防转换发生冲突。

# css - Wordpress 菜单 UL 高度

> ID：10249036
> 
> 赞同：0
> 
> 时间：2012-04-20T15:26:04.603
> 
> 标签：css, wordpress, list, cufon

我对自己的 UL 编码有一些很好的经验，但我对 wordpress 比较陌生。让我感到困惑，尤其是当我看不到 html 时。无论如何，我正在使用 cufon WP 插件来更改菜单中的字体。但是....使用我想要的字体大小，它会缩小列表项以及 a:hover。我想填充中有一些东西，但我找不到它。你可以在这里看到我的意思[http://www.thedailyminx.com](http://www.thedailyminx.com)

这是菜单的CSS

```
#navbar {
    float: left;
    display: block;
    background: #bfbcc6;
    color: #000000;
    width: 978px;
    height: 30px;
    font-size: 25px;
    font-family: 'jc-hand';
    margin: 15px auto 15px;
    padding: 0px 0px 0px 0px;
    border: 1px solid #DDDDDD;
    position: relative;
    z-index: 9;
    }

/*** ESSENTIAL STYLES ***/
.menu, .menu * {
    margin: 0;
    padding: 0;
    list-style: none;
    }
.menu {
    line-height: 1.0;
    }
.menu ul {
    margin: 0px;
    padding: 0px;
    }
.menu ul ul, ul.menu ul {
    position: absolute;
    top: -9999px;
    width: 160px; /* left offset of submenus need to match (see below) */
    }
.menu ul li ul li, ul.menu ul li {
    width: 100%;
    margin: 0px 0px 0px 0px;
    }
.menu li:hover {
    visibility: inherit; /* fixes IE7 'sticky bug' */
    }
.menu li {
    float: left;
    display: inline-block;
    position: relative;
    }
.menu a {
    display: inline-block;
    position: relative;
    }
.menu li:hover ul,
.menu li.sfHover ul {
    left: 0;
    top: 30px; /* match top ul list item height */
    z-index: 99;
    }
ul.menu li:hover li ul,
ul.menu li.sfHover li ul {
    top: -9999px;
    }
ul.menu li li:hover ul,
ul.menu li li.sfHover ul {
    left: 160px; /* match ul width */
    top: 0;
    }
ul.menu li li:hover li ul,
ul.menu li li.sfHover li ul {
    top: -9999px;
    }
ul.menu li li li:hover ul,
ul.menu li li li.sfHover ul {
    left: 160px; /* match ul width */
    top: 0;
    }

/*** SKIN ***/
.menu .current_page_item a,
.menu .current_page_ancestor a,
.menu .current-menu-item a,
.menu .current-cat a {
    background: #333333;
    color: #FFFFFF;
    border-left: 1px solid #333333;
    border-right: 1px solid #333333;
    }
.menu li .current_page_item a, .menu li .current_page_item a:hover,
.menu li .current-menu-item a, .menu li .current-menu-item a:hover,
.menu li .current-cat a, .menu li .current-cat a:hover {
    background: #333333 !important;
    color: #FFFFFF !important;
    border-left: none;
    border-right: none;
    }
.menu {
    float: left;
    margin-bottom: 0;
    }
.menu a {
    color: #000000;
    background: none;
    margin: 0px 0px 0px 0px;
    padding: 0px 12px 0px 12px;
    text-decoration: none;
    letter-spacing: 0.1px;
    line-height: 30px;
    border-right: 1px solid #DDDDDD;
    border-left: 1px solid #FFFFFF;
    }
.menu li li a {
    display: block;
    background: #F5F5F5 !important;
    color: #000000 !important;
    margin: 0px 0px 0px 0px;
    padding: 0px 10px 0px 10px;
    font-size: 25px;
    line-height: 30px;
    text-decoration: none;
    text-transform: none;
    text-shadow: none;
    letter-spacing: 0px;
    border-right: none !important;
    border-left: none !important;
    }
.menu li, .menu li li, .menu li li li {
    background: none;
    margin: 0px;
    padding: 0px;
    }
.menu li:hover, .menu li.sfHover {
    margin: 0px;
    padding: 0px;
    }
.menu a:focus, .menu a:hover, .menu a:active {
    background: #333333;
    color: #FFFFFF;
    border-right: 1px solid #333333;
    border-left: 1px solid #333333;
    outline: 0;
    }
.menu li li:hover, .menu li li.sfHover {
    margin: 0px;
    padding: 0px;
    }
.menu li li a:focus, .menu li li a:hover, .menu li li a:active {
    background: #EEEEEE !important;
    color: #333333 !important;
    border: none;
    outline: 0;
    } 
```

谁能帮我吗？谢谢格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:32:19.063

放弃内联`height`样式`cufon`并将其设置在您的样式表中`30px`

# c# - Mono：Parallel.For 的问题

> ID：10249037
> 
> 赞同：4
> 
> 时间：2012-04-20T15:26:09.923
> 
> 标签：c#, .net-3.5, mono, task-parallel-library, parallel-extensions

我正在使用**Microsoft Reactive Extensions**`Task.Parallel`中的类（**.NET 3.5 库**，而不是 .NET 4 中的类，因为我的应用程序在 3.5 上运行）。在 .NET 上一切正常，但是当我在 Mono（Linux 上为 2.10.5）中运行它时，调用该方法时会引发异常：****`Parallel.For()`****

 ****```
System.Threading.Tasks.TaskSchedulerException: TaskSchedulerException_ctor_DefaultMessage 
 ---> System.EntryPointNotFoundException: SwitchToThread
 at (wrapper managed-to-native) System.Threading.Platform:SwitchToThread ()
 at System.Threading.Platform.Yield () [0x00000] in <filename unknown>:0
 at System.Threading.ManualResetEventSlim.Wait (Int32 millisecondsTimeout, CancellationToken cancellationToken) [0x00000] in <filename unknown>:0
 at System.Threading.ManualResetEventSlim.Wait () [0x00000] in <filename unknown>:0
 at System.Threading.Tasks.Task.InternalRunSynchronously (System.Threading.Tasks.TaskScheduler scheduler) [0x00000] in <filename unknown>:0
 --- End of inner exception stack trace ---
 at System.Threading.Tasks.Task.InternalRunSynchronously (System.Threading.Tasks.TaskScheduler scheduler) [0x00000] in <filename unknown>:0
 at System.Threading.Tasks.Task.RunSynchronously (System.Threading.Tasks.TaskScheduler scheduler) [0x00000] in <filename unknown>:0
 at System.Threading.Tasks.Parallel.ForWorker[Object] (Int32 fromInclusive, Int32 toExclusive, System.Threading.Tasks.ParallelOptions parallelOptions, System.Action`1 body, System.Action`2 bodyWithState, System.Func`4 bodyWithLocal, System.Func`1 localInit, System.Action`1 localFinally) [0x00000] in <filename unknown>:0 
```

我在网上找不到任何涵盖此异常的资源，所以我有点卡住了。有什么建议么？3.5 的任务并行库是否在 Mono 上运行？****

# perl - Perl 通过 DOM 查找 Web 链接

> ID：10249038
> 
> 赞同：0
> 
> 时间：2012-04-20T15:26:12.370
> 
> 标签：perl, scripting, mechanize

我一直在使用 Mechanize::Firefox 来做一些网页抓取，我目前正处于完全无头的过程中。我一直在使用这段代码：

```
my $link = [$firefox->find_link_dom(text_regex => qr/pdf/i)]->[0]->{href} . "\n"; 
```

这在查找 .pdf 文件方面提供了非常好的结果。无论如何我可以使用不需要显示浏览器的不同模块找到基于 text_regex 的链接厄运吗？

编辑

使用 Mechanize::Firefox 我会从代码中取回一个链接，例如：

```
<div id="rhc" xpathLocation="noDialog">

 <div id="download" class="rhcBox_type1">
<div class="wrap">
  <ul>
    <li class="download icon"><strong>Download:</strong>
      <a href="/article/fetchObjectAttachment.action;jsessionid=CDBD1AACEEB3CF89729EB23808FD1319?uri=info%3Adoi%2F10.1371%2Fjournal.pbio.1001193&amp;representation=PDF" title="Download article PDF">PDF</a> |
      <a href="/article/citationList.action;jsessionid=CDBD1AACEEB3CF89729EB23808FD1319?articleURI=info%3Adoi%2F10.1371%2Fjournal.pbio.1001193" title="Download citations">Citation</a> |
      <a href="/article/fetchObjectAttachment.action;jsessionid=CDBD1AACEEB3CF89729EB23808FD1319?uri=info%3Adoi%2F10.1371%2Fjournal.pbio.1001193&amp;representation=XML" title="Download Article XML">XML</a>
    </li>
    <li class="print icon"><a href="#" onclick="window.print();return false;" title="Print Article"><strong>Print article</strong></a></li>
    <li class="reprint icon"><a href="https://www.odysseypress.com/onlinehost/reprint_order.php?type=A&page=0&journal=1&doi=10.1371/journal.pbio.1001193&volume=&issue=&title=Evolutionarily Conserved Linkage between Enzyme Fold, Flexibility, and Catalysis&author_name=Arvind%20Ramanathan%2C%20Pratul%20K.%20Agarwal&start_page=1&end_page=17" title="Odyssey Press">EzReprint</a> New &amp; improved!</li>
  </ul>
</div> 
```

下载pdf文件。任何想法为什么 HTML::Treebase 不会得到这个链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:38:08.667

*   CSS3 `a[href*="pdf"]`: [Web::Query](http://p3rl.org/Web%3a%3aQuery) , [HTML::Query](http://p3rl.org/HTML%3a%3aQuery) , [Mojo::UserAgent](http://p3rl.org/Mojo%3a%3aUserAgent)

*   XPath `//a[contains(@href, "pdf")]`: [HTML::TreeBuilder::XPath](http://p3rl.org/HTML%3a%3aTreeBuilder%3a%3aXPath) , [XML::LibXML](http://p3rl.org/XML%3a%3aLibXML)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:51:29.803

```
use strict;
use warnings;
use HTML::TreeBuilder::XPath qw(); 

my $dom = HTML::TreeBuilder::XPath->new_from_content(q(...)); # ... your html code
my @nodes = $dom->findnodes('//a[contains(@href, "pdf")]'); 

foreach my $node (@nodes) {
  my $href = $node->findvalue('@href');
  ...
} 
```

# iphone - 如何填充与此图像颜色完全相同的颜色？

> ID：10249043
> 
> 赞同：0
> 
> 时间：2012-04-20T15:26:35.790
> 
> 标签：iphone, ios, uicolor

请看这张图片：

![在此处输入图像描述](../Images/44289be1d16b8a7d5c6652b515c1276b.png)

我需要在一个栏中填充具有相同效果的相同颜色。我试着用

```
[UIColor colorWithPatternImage:[UIImage imageNamed:@"bar.png"]]; 
```

但没有获得成功。它创造了相同的效果，但有图案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:52:25.960

使用 1 像素宽的图像，而不是您拥有的 100 像素宽的图像。图像中的第 20 列和第 21 列与其他垂直列不同，因此是图案。查看下面的放大版本。

![在此处输入图像描述](../Images/5a4f63d817298633107f81775170b163.png)

# magento - Magento：单击类别时显示所有子类别的产品，没有 is_anchor

> ID：10249044
> 
> 赞同：1
> 
> 时间：2012-04-20T15:26:37.560
> 
> 标签：magento

我们有这样的类别结构：
根
-- 类别 1
---- 类别 1 - 1
------- 类别 1 - 1 - 1
------- 类别 1 - 1 - 2
--- - 类别 1 - 2
-- 类别 2
---- 类别 2 - 1
---- 类别 2 - 2

通常，当用户单击根类别时，它会显示为空。类别 1 和 2 也是空的（错误地，可能是 1 或 2 个产品在那里）。

我希望，当单击一个类别时，会显示**所有**子类别（以及子类别的子类别）的产品（+ 属于该类别本身的产品）。

我们**不能**使用 is_anchor，因为这种行为仅适​​用于三个商店视图之一，并且 is_anchor 是*全局*的。

我的想法是重写`Mage_Catalog_Block_Product_List`，因此它在请求类别时返回子类别的产品，但是通过向所有类别集合请求添加过滤器或其他方法是否有更简单的方法？

类似问题的答案不完整或使用 is_anchor。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:23:29.403

我现在自己解决了这个问题。

我创建了一个重写的模块`Mage_Catalog_Model_Category::getProductCollection()`

步骤如下：

1.  当没有子类别时，返回标准`parent::getProductCollection()`
2.  当有子类别时，获取所有子类别的 id 并将它们保存为数组。
3.  将当前类别的 id 添加到数组中。
4.  获取所有这些类别的集合并按`is_active`.
5.  遍历类别集合并加载每个类别。
6.  获取每个类别的产品集合并遍历它，将所有产品 id 保存到一个数组中。加载下一个类别时附加到数组。
7.  建立一个产品集合并添加一个过滤器`->addAttributeToFilter('entity_id', array('in' => array_unique($result)));`
8.  返回集合。它根据需要保存所有子类别的所有产品和当前类别的产品（并且其中没有重复项）。

# javascript - jQuery检测php $_POST isset

> ID：10249046
> 
> 赞同：1
> 
> 时间：2012-04-20T15:26:39.003
> 
> 标签：javascript, php, jquery

我是 jQuery 的新手，只是想知道是否有一种方法可以检测页面加载时是否提交了表单，如果是，则解析一些代码。

我有：

```
<form action="/login/register" method="post"> 
    <input type="text" value="Username" name="regName"/>
    <input type="password" value="Password" name="regPass"/>
    <input type="submit" value="Register"/>
</form> 
```

和：

```
<?php

if (isset($_POST['regName']))
{
//check inputs and add account
}

?> 
```

但我想知道是否可以检查表单是否已通过 jQuery 提交？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T15:27:23.783

如果进行了 POST 提交，只需让 PHP 将 javascript 变量设置为 true。然后 jQuery 只需要检查它的值。

```
<script type="text/Javascript">
    var was_posted = <?php echo ('POST' === $_SERVER['REQUEST_METHOD']) ? 'true' : 'false'; ?>
</script> 
```

# crystal-reports - Crystal Report 计算变量上下文

> ID：10249048
> 
> 赞同：0
> 
> 时间：2012-04-20T15:26:43.840
> 
> 标签：crystal-reports

我在 Crystal 中创建了一个变量来计算两组数据的唯一计数，它给出了一组数据的最大唯一计数

现在，如果我必须在组中使用此变量来获取组唯一计数，那么要添加到变量中以获取组计数而不是总计数

```
 Distinct AB Count = DISTINCTCOUNT({@AE AB Count})- COUNT({@Total of AE}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:42:57.597

Crystal 中任何汇总函数的第二个参数指定您希望汇总处理的组级别。例如，

`numbervar distinctCountForGroup := distinctcount({table.fieldYouAreSummarizing},{table.fieldYouAreGroupingOn});`

# asp.net - 手动将 MVC Web 应用从 3 升级到 4，无法添加 API 控制器

> ID：10249049
> 
> 赞同：5
> 
> 时间：2012-04-20T15:26:45.333
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-web-api

我最近通过在 MVC4 中创建一个新的 Web 应用程序，将所有文件复制过来，最后合并 web.config，将我的 Web 应用程序从 MVC3 升级到 4。一切都适用于现有的网络应用程序，但是我今天刚刚注意到一个非常奇怪的错误 - 如果我尝试使用默认的虚拟实现创建一个新的 API 控制器，然后浏览到该 api（例如 /api/events），我得到一个`Could not load type`错误。奇怪的是，如果我重新构建应用程序并再次点击 URL，它似乎是它抱怨的不同程序集，主要是在这两个之间交替：

```
Could not load type 'System.Web.Razor.Parser.SyntaxTree.CodeSpan' from assembly 'System.Web.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. 
```

和

```
Could not load file or assembly 'Microsoft.Scripting, Version=1.1.0.20, Culture=neutral, PublicKeyToken=7f709c5b713576e1' or one of its dependencies. The system cannot find the file specified. 
```

我的 web.config 包含以下程序集绑定信息：

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <!--<assemblyIdentity name="FluentValidation" publicKeyToken="a82054b837897c66" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-3.2.0.0" newVersion="3.2.0.0" />-->
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.8.0" newVersion="4.0.8.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Razor" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

而且我的 packages.config 看起来它包含所有正确的位：

```
 <package id="AspNetMvc" version="4.0.20126.16343" />
  <package id="AspNetRazor.Core" version="2.0.20126.16343" />
  <package id="AspNetWebApi" version="4.0.20126.16343" />
  <package id="AspNetWebApi.Core" version="4.0.20126.16343" />
  <package id="AspNetWebPages.Core" version="2.0.20126.16343" />
  <package id="Microsoft.Web.Infrastructure" version="1.0.0.0" />
  <package id="Microsoft.Web.Optimization" version="1.0.0-beta" />
  <package id="System.Net.Http" version="2.0.20126.16343" />
  <package id="System.Net.Http.Formatting" version="4.0.20126.16343" />
  <package id="System.Web.Http.Common" version="4.0.20126.16343" />
  <package id="System.Web.Providers" version="1.1" />
  <package id="System.Web.Providers.Core" version="1.0" /> 
```

我什至尝试使用新的 mvc4 Web 应用程序中的“香草”复制我的 web.config，但仍然给我同样的错误（无法加载文件或程序集 Microsoft.Scripting）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T12:55:21.957

尝试从您的 web.config 中删除这些行

```
<dependentAssembly>
  <assemblyIdentity name="System.Web.Razor" publicKeyToken="31bf3856ad364e35" culture="neutral" />
  <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
</dependentAssembly> 
```

# php - 如何知道PHP中结果记录集中所有行中的列是否全部为NULL？

> ID：10249053
> 
> 赞同：0
> 
> 时间：2012-04-20T15:26:55.863
> 
> 标签：php, mysql, sql, database, wordpress

假设我的结果记录集如下：

```
Emp_ID    ID    Ability    Rating
------    --    -------    ------
NULL      DRI   Driving    NULL
NULL      TYP   Typing     NULL
NULL      GRA   Graphics   NULL
NULL      VID   Video      NULL
NULL      GAM   Gaming     NULL 
```

而另一种情况可能是：

```
Emp_ID    ID    Ability    Rating
------    --    -------    ------
15        DRI   Driving    7
15        TYP   Typing     6
15        GRA   Graphics   8
15        VID   Video      7
15        GAM   Gaming     10 
```

或者：

```
Emp_ID    ID    Ability    Rating
------    --    -------    ------
22        DRI   Driving    4
NULL      TYP   Typing     NULL
NULL      GRA   Graphics   NULL
22        VID   Video      8
22        GAM   Gaming     5 
```

我在 PHP 中检查是否都像第一个**最便宜的方法是什么？**`Emp_ID``NULL`

`Emp_ID`在 MySQL 中是`BIGINT(20) UNSIGNED`（并且`Rating`是）。`TINYINT(2) UNSIGNED`记录集由 返回`$wpdb_custom->get_results()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:33:28.413

您可以在 SQL 中执行此操作，这样您甚至不必在 PHP 中处理数据。您可以只使用现有的 SQL 查询，然后使用`AND Emp_ID IS NOT NULL;`. 如果您返回任何行，那么您知道您有一些非空行。如果你没有得到任何回报，那么它们一定都是空的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:41:31.797

php方式是迭代数组

```
$аll_null = TRUE;
foreach($result as $one) $аll_null = $аll_null AND ($one->Emp_ID === NULL);
var_dump($аll_null); 
```

编辑：

我确信该方法`get_results`也使用迭代，因此您可以`$wpdb_custom`使用另一种方法扩展您的类，如下所示：

```
public function get_results_custom($key, $test, &$result)
{
  * * *
  $result = TRUE
  while($row = do_some_iteration())
  {
    $result = $result AND $test($row->$key);
    * * *
  }
} 
```

所以现在你可以这样做：

```
$all_null = TRUE;
$my_data = $wpdb_custom->get_results_custom('Emp_ID', 'is_null', $all_null);
if($all_null) ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T18:55:02.587

```
$all_null = true;
foreach($wpdb->get_results() as $row) {
    if(!is_null($row['Emp_ID'])) {
        $all_null = false;
        break;
    }
} 
```

由于您无法编辑查询，因此您能做的最好的事情就是迭代检查结果是否为空。但重要的是`break`当你找到一个非空行时。此时您知道并非所有行都是空的，所以不要费心迭代剩余的行。

# php - 用什么语言构建安全（防止 IP 盗窃）表单

> ID：10249055
> 
> 赞同：-2
> 
> 时间：2012-04-20T15:26:58.870
> 
> 标签：php, javascript, jquery

我正在建立一个围绕复杂形式的小型企业。到目前为止，我一直在用 Javascript 开发表单。然而，js 是客户端的事实几乎意味着我所有的努力都可能被盗。我研究过混淆技术，但由于存在去混淆器的事实，保护知识产权充其量是冒险的。

有什么方法可以保护我的 js 代码免遭盗窃？对代码进行版权保护或商标注册是一种可行的选择吗？这个项目几乎是一个小众项目，所以如果突然出现使用类似代码的竞争对手，检查起来并不难。但是，如果其他人使用我的代码作为服务器端应用程序的基础，那我就完蛋了。如果 js 不是一种可行的开发语言，是否有一种服务器端语言可以完成这项工作？服务器端的项目有哪些陷阱？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:38:27.037

以下是保护您的知识产权免遭盗窃的方法：**不要在客户端 JavaScript 中编写代码。**

服务器端语言的选择范围有点广泛，但如果您更喜欢 javascript，您可以使用 Node.js 将“秘密/专有”功能实现为 Web 服务，然后从您的实际形式（通过传统形式）调用回发或通过 AJAX）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T15:38:54.973

假设任何 Javascript 代码都可以被人类阅读，无论您进行了多少混淆。如果网络浏览器可以解释它，那么人类就可以。

通常，任何敏感数据都应该存储在服务器端，任何敏感的业务功能/计算都应该存储在服务器端。还是可以通过AJAX调用服务端的敏感函数来实现客户端的流畅和手感。

没有“最安全”的服务器端语言。使用您最熟悉且最适合您的应用的那个。Web 应用程序安全性与开发人员及其知识相关，而不是与实际语言相关。

# c# - SmartCard 安全性，您如何验证证书不是假的？

> ID：10249056
> 
> 赞同：3
> 
> 时间：2012-04-20T15:27:07.783
> 
> 标签：c#, asp.net, ssl, cryptography, smartcard

我正在尝试开发一个读取 clientCertificate 的 ASP.net 站点，以确保使用智能卡访问该网站（试图取消用户名/密码登录）。

我脑海中的流程是：

1.  用户注册一个账户，C#记录用户的clientCertificate（public）。
2.  然后，用户下次可以使用相同的 clientCertificate 登录，如果哈希有效，他们现在是经过身份验证的用户。
3.  **我将使用下面的代码**来确保证书的真实性。浏览器应该处理私钥并确保证书不是伪造的。
4.  基于 Subject+certificate 的组合，C# 为他们分配了他们的角色访问权限。

以下代码可以用于证书的真实性吗？

```
X509Certificate x509Cert = new X509Certificate(Request.ClientCertificate.Certificate);
SHA1 sha = new SHA1CryptoServiceProvider();
byte[] hashvalue = sha.ComputeHash(Request.ClientCertificate.Certificate);
byte[] x509Hash = x509Cert.GetCertHash();
// compare x509Hash WITH hashvalue to ensure they are a match. 
// If not, possibly faked certificate, not a real smartcard??? 
```

这是智能卡身份验证过程应该如何工作？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:33:48.453

看到这个帖子，先生。您无需在代码中明确验证真实性。IIS 将为您完成。

[IIS 是否进行 SSL 证书检查，还是我必须对其进行验证？](https://stackoverflow.com/questions/8309780/does-iis-do-the-ssl-certificate-check-or-do-i-have-to-verify-it)

IIS 甚至会尝试检查吊销列表（但是，如果 CRL 很大，这通常会被禁用）。在 CRL 非常大或检查延迟很高的情况下，应使用 OCSP 响应程序进行验证[http://www.axway.com/products-solutions/email-identity-security/identity-security/va-suite](http://www.axway.com/products-solutions/email-identity-security/identity-security/va-suite) .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T15:38:38.980

如果您只需要使用客户端证书对用户进行身份验证，您应该在 IIS 中执行此操作。您根本不需要向您的应用程序添加任何代码：

[指定是否使用客户端证书 (IIS 7)](http://technet.microsoft.com/en-us/library/cc753983%28v=ws.10%29.aspx)

除非您需要将客户端证书与数据库帐户相关联或执行额外的验证步骤。但是对于客户端证书身份验证，我仍然会坚持使用 IIS 设置。

**更新**：如果您需要操作客户端证书，您可以执行以下操作：

```
X509Certificate2 x509Cert2 = new X509Certificate2(Page.Request.ClientCertificate.Certificate); 
```

然后访问其属性，例如：

```
x509Cert2.Subject 
```

但是，将验证部分留给 IIS。如果客户端提供了错误的证书，您的 asp.net 代码甚至不会执行，因为 IIS 会拒绝它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:30:28.600

客户端证书身份验证在 SSL/TLS 握手期间完成。

它通常使用公钥基础设施来完成，服务器有一个（固定的）受信任的 CA 证书列表，用于验证客户端证书（与服务器的客户端相同）。在此阶段之后将证书提交给您的应用程序后，您将知道：

*   客户端拥有该证书的私钥（由 TLS 握手中的[`Certificate Verify`消息](https://www.rfc-editor.org/rfc/rfc4346#section-7.4.8)保证（SSL/TLS 堆栈将为您验证这一点，无需实现任何东西）；
*   客户端具有证书中描述的身份，因为您将根据受信任的 CA 对其进行验证。

针对可信 CA 的验证要求用户提前向该 CA 注册。如果证书不是由您信任的 CA 颁发的，则您不能只对任何证书进行身份验证。（将证书的主题映射到本地用户 ID 是另一回事：如果需要，您可以在第一次连接时执行此操作：例如，拥有自己的数据库或目录服务以将主题 DN 映射到应用程序中的另一种用户 ID。）

> 用户注册一个账户，C#记录用户的clientCertificate（public）。然后，用户下次可以使用相同的 clientCertificate 登录，如果哈希有效，他们现在是经过身份验证的用户。

听起来您希望允许提供*任何*证书并将其用于初始注册，而不必求助于通常受信任的 CA。

原则上这是可能的，我这样做是为了探索 Java 中 PKI 的替代方案。

为此，就 SSL/TLS 握手而言，您需要让任何证书通过，并稍后验证证书本身。（您*确实*需要使用某种形式的验证。）您仍然可以保证客户端拥有它提供的公钥证书的私钥。

这样做需要两个步骤：

*   您需要能够通过在`Certificate Request`TLS 消息中发送一个空的证书颁发机构列表（TLS 1.1 明确允许）来宣传您将接受任何证书的事实。
*   配置 SSL/TLS 堆栈以信任任何证书（同样，当您这样做时，不要忘记在您的应用程序中实现您自己的验证系统，否则任何事情都会真正通过）。

在 .Net 中，虽然应该可以使用[远程证书验证回调](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx)来解决第二点，但我从来没有找到改变第一点的方法（这个[问题](https://stackoverflow.com/q/53824/372643)中也有人问过）。

在 Java 中，JSSE`X509TrustManager`允许您解决这两个问题。

# javascript - 是否可以捕获通过尝试连接到错误的 url 生成的异常？

> ID：10249057
> 
> 赞同：1
> 
> 时间：2012-04-20T15:27:10.080
> 
> 标签：javascript, node.js, try-catch

使用 node http 包似乎无法捕获由打开错误 URL 引起的异常。这是一个问题，因为它会杀死我的集群，我想保证它会永远存在

这是代码：（使用fibers.promise）

```
function openConnection(dest, port, contentType, method, throwErrorOnBadStatus)
{
  "use strict";
  assert.ok(dest, "generalUtilities.openConnection: dest is null");
  //dest = dest.replace('//','/');
  console.log('opening connection: ' + dest + " contentType: " + contentType);
  var prom = promise(),
    errProm = promise(),
    ar = [],
    urlParts = url.parse(dest),
    httpClient,
    req,
    got,
    res;
  //console.log('urlParts.port: ' + urlParts.port);
  if (port) {
    urlParts.port = port;
  } else if (!urlParts.port) {
    urlParts.port = 80;
  }
  if (contentType) {
    urlParts.accept = contentType;
  } else {
    urlParts.contentType = 'text/html';
  }
  if (!urlParts.method) {
    if (method) {
      urlParts.method = method;
    } else {
      urlParts.method = 'GET';
    }
  }
  try {
    httpClient = http.createClient(urlParts.port, urlParts.hostname);
    req = httpClient.request(urlParts.method, urlParts.path, urlParts);
  //console.log('req: ' + req);
  //if (req.connection) {
  //  req.connection.setTimeout(HTTP_REQUEST_TIMEOUT);
  //}
  //else {
  //  throw new Error ("No Connection Established!");
  //}
      req.end();
    req.on('response', prom);
    req.on('error', errProm);
    got = promise.waitAny(prom, errProm);
    if (got === errProm) {
      //assert.ifError(errProm.get(), HTTP_REQUEST_TIMEOUT_MSG + dest);
      throw new Error(HTTP_REQUEST_TIMEOUT_MSG + dest + ': ' + got.get());
    }
    res = prom.get();
    ar.res = res;
    ar.statusCode = res.statusCode;
    if (ar.statusCode >= 300 && throwErrorOnBadStatus) {
      assert.ifError("page not found!");
    }
    return ar;
  }
  catch (err) {
    console.log(err);
  }
} 
```

这就是我测试它的方法

```
var promise = require('fibers-promise');
var gu = require("../src/utils/generalutilities.js");

var brokenSite = 'http://foo.bar.com:94//foo.js';
promise.start(function () {
  try {
    gu.openConnection(brokenSite, null, null, "GET", true);
  }
  catch (err) {
    console.log('got: ' + err);
  }
}); 
```

当我运行此代码时，我得到：

错误：getaddrinfo ENOENT。它永远不会被 try catch 捕获

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:04:01.020

在为请求提供错误处理程序时，它对我有用：

```
req.on('error', errorHandler); 
```

我看到您也这样做，但是您在发布后设置了它

```
req.end(); 
```

`end()`您可以在附加错误处理程序后尝试发出吗？

作为旁注，我*真的*推荐[request](https://github.com/mikeal/request)，因为它使用合理的默认值来处理此类问题。使用起来真的很轻松。

**编辑：**这是一个简单的示例，显示附加错误处理程序可以让我处理`ENOENT`/`ENOTFOUND`错误：

```
var http = require('http');

var req = http.request({hostname: 'foo.example.com'}, function(err, res) {
    if(err) return console.error(err);
    console.log('got response!');
});

req.on('error', function(err) {
    console.error('error!', err);
}); 
```

另一条有价值的信息：我不确定它如何与纤维相匹配，但一般来说，你不应该*在* `throw`nodejs 异步代码中。它很少按照你想要的方式工作。取而代之的是，使用将任何错误作为第一个参数传递给下一个回调的标准做法，并在有意义的地方处理错误（通常，在调用链的上层，您可以用它做一些明智的事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T15:28:54.820

您可以抓取页面以获取错误代码。

# mysql - 如何在 PHP 中从 Oracle 获取 0 行更新的查询/数据？

> ID：10249058
> 
> 赞同：0
> 
> 时间：2012-04-20T15:27:17.210
> 
> 标签：mysql, oracle, rows, zero

假设我正在触发查询，如果所有值都可用，它将更新数据，否则将在更新 0 行的情况下运行。那么**如何在 PHP 中从 Oracle db 获取那些 0 行更新的查询/数据**？

在我的脚本中，如果 item_flag 为 N，我将更新表，item_name 存储在 $sku 中，因此检查该 & site_code 在 $final_code 中，因此所有这些都处于 where 条件。因此，如果更新查询通过值更新成功运行，那么我将在 $result 中获取执行结果并更新 Mysql 表的状态。

但是发生的情况是，当更新查询中不存在某些数据时说 $sku 然后查询运行时**更新了 0 行**...& 同样它将移动到 if($result) 循环并更新我不想要的状态实际上数据/行没有得到更新......

那么如何在 PHP 中从 Oracle 获取 0 行更新的查询/数据？

```
 --------------some code above--------

            $query_ora_update = "UPDATE ITEM_DETAILS SET ITEM_FLAG= 'Y', LAST_UPDATE_DATE = sysdate WHERE ITEM_NAME = '$sku' AND SITE_CODE = '$final_code' AND ITEM_FLAG = 'N' ";
            $parse_result = oci_parse($conn,$query_ora_update);
            $result = oci_execute($parse_result);                          
            oci_commit($conn);

            if($result)                             
            {

               $query_update_alert = "UPDATE product_creation SET alert_status =1 where 
                    entity_id = $entity_id and sku = '$sku' and alert_status = 0";

$result_query_update_alert = mysql_query($query_update_alert);

             } 
        ------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:40:29.143

使用`oci_num_rows`功能。[文档在这里](http://www.php.net/manual/en/function.oci-num-rows.php)

**编辑：示例代码**

```
$parse_result = oci_parse($conn,$query_ora_update);             
$result = oci_execute($parse_result);   
$row_count = oci_num_rows($parse_result);                                    
oci_commit($conn);              
if($row_count > 0)
  { 
   ------------------- 
```

# c++ - 我们什么时候需要提及/指定数字文字的整数类型？

> ID：10249072
> 
> 赞同：3
> 
> 时间：2012-04-20T15:27:55.430
> 
> 标签：c++, c, types, integer

我遇到了如下代码：

```
#define SOME_VALUE 0xFEDCBA9876543210ULL 
```

这是稍后 `SOME_VALUE`分配给一些人的。`unsigned long long`

**问题**：

1.  在这种情况下是否需要有后缀`ULL`？
2.  什么情况下我们需要指定使用的整数类型？
3.  在这种情况下，C 和 C++ 的行为是否不同？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T15:33:49.093

在 C 中，十六进制文字获取第一种类型`int`, `unsigned int`, `long`, `unsigned long`,`long long`或者`unsigned long long`如果它没有后缀则可以表示其值。如果 C++ 有相同的规则，我不会感到惊讶。

如果您想为文字提供比默认情况下更大的类型，或者如果您想强制其签名，则需要一个后缀，例如考虑

```
1 << 43; 
```

如果没有后缀，那（几乎可以肯定）是未定义的行为，但`1LL << 43;`例如就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T15:34:28.360

1.  我认为不是，但也许那是那个编译器所必需的。
2.  例如，`printf("%ld", SOME_VALUE);`如果`SOME_VALUE`未指定 的整数类型，则可能会导致错误的输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T15:39:22.597

在 C++ 中使用指定后缀的一个很好的例子是重载函数。以以下为例：

```
#include <iostream>

void consumeInt(unsigned int x)
{
    std::cout << "UINT" << std::endl;
}

void consumeInt(int x)
{
    std::cout << "INT" << std::endl;
}

void consumeInt(unsigned long long x)
{
    std::cout << "ULL" << std::endl;
}

int main(int argc, const char * argv[])
{
    consumeInt(5);
    consumeInt(5U);
    consumeInt(5ULL);

    return 0;
} 
```

结果是：

> **INT
> UINT
> ULL**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T15:40:29.597

当您不提及任何后缀时，`int`编译器会推断出整数文字的类型。由于如果将其类型推导出为 ，则某些整数文字可能会溢出`int`，因此您添加后缀以告诉编译器将类型推导出为`int`. 这就是你写作时所做的`0xFEDCBA9876543210ULL`。

写浮点数时也可以使用后缀。`1.2`是一个`double`，`1.2f`而是一个浮点数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T15:42:10.557

*如果您的唯一目的是获得正确的数字值*，则不需要后缀；C 会自动选择适合该值的类型。

如果你想强制表达式的*类型*，后缀很重要，例如为了它如何在表达式中交互。当您要执行会溢出较小类型（例如`1ULL<<n`or `x*10LL`）的算术运算时，可能需要将其设置为 long 或 long long，并且当您希望将表达式作为一个整体具有无符号语义（例如`c-'0'<10U`， 或`n%2U`）。

# glassfish - 是否可以将 WSO2 ESB 部署到 Glassfish 应用程序服务器上

> ID：10249076
> 
> 赞同：1
> 
> 时间：2012-04-20T15:28:20.480
> 
> 标签：glassfish, wso2, wso2esb

是否可以将 WSO2 ESB 部署到 Glassfish 应用程序服务器上？在 WSO2 站点 (http://docs.wso2.org/display/ESB403/ESB+Administration) 上，它列出了 JBoss、Websphere 等，但没有提到 glassfish。

任何帮助，将不胜感激。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T13:07:35.350

WSO2 产品使用嵌入式 Tomcat 作为其独立执行的主要运行时，但也可以在 jboss、glassfish、Websphere 等其他应用程序服务器中运行。

# web-applications - 在开发企业 Web 应用程序时，包含出现在多个页面中的一个元素或一组元素的最佳方式是什么？

> ID：10249077
> 
> 赞同：0
> 
> 时间：2012-04-20T15:28:35.893
> 
> 标签：web-applications, repeat, jspinclude, code-maintainability

例如：如果我有一个导航部分，其中包含许多链接/按钮，并且需要包含在多个页面 (jsps) 中，那么以可维护的方式执行此操作的最佳方法是什么？我会通过 jsp 包含来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:48:13.273

是的，这样做`<jsp:include>`将是一个不错的选择..在几个页面中包含相同的部分将导致您的部分的可重用性..而且这样做很容易..

# iphone - 哪些方法、技术或服务可以简化在移动设备上的捐赠？

> ID：10249079
> 
> 赞同：0
> 
> 时间：2012-04-20T15:28:48.863
> 
> 标签：iphone, mobile, paypal

我们正在制作一个专门针对移动设备的网站，我们需要接受捐款。我们想让这个过程在移动设备上尽可能快速、简单和方便。我们对使用任何支付网关（即 Paypal、Authorize.net、NMI 等）持开放态度。

我的雇主认为让某人从他们的移动设备输入帐单信息太不方便了，但是将我们限制为仅来自 Paypal 会员等的捐款是不明智的。我们正在努力寻找一种方法来最大限度地增加可以捐赠的观众（尽可能接近每个人），同时让体验比将他们的账单信息输入移动设备更简单。

我考虑过存储预先记录的账单信息和 Bump Pay 的应用程序。是否有任何其他有效的中间立场或解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T01:44:44.060

Tanoro - 不确定你问的是什么。如果您想接受最广泛的支付方式，您需要有一个最低分母的解决方案。在这种情况下，这意味着直接接受卡（通过直接允许计费信息）。如果您最终直接接受付款信息，请查看 Braintree 及其 iOS 客户端库：[https ://www.braintreepayments.com/docs/ios](https://www.braintreepayments.com/docs/ios)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:35:00.313

我认为一个简单的中间立场是使用信用卡平台而不是询问账单信息。许多移动应用程序不要求它。Authorize.net 和其他网关可以配置为不需要它。只需询问邮政编码。或者根本不要求提供地址信息。由于您没有运送实际产品（自掏腰包购买商品），因此如果存在欺诈拒付，这并不是什么大问题。而且我无法想象很多信用卡窃贼会烧毁被盗的信用卡来进行慈善捐款。

# javascript - Twitter Widget 在 iF rame 中时在 IE8 中不起作用

> ID：10249087
> 
> 赞同：1
> 
> 时间：2012-04-20T15:29:16.677
> 
> 标签：javascript, twitter, widget

我正在使用 Twitter 小部件，它在 IE8 中运行良好，直到我将它放入 iFrame 中。twitter 小部件 Javascript 文件是从 iFrame 中加载的，正如我所说，它可以独立运行。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:42:27.003

经过大量测试后，似乎是加载 JavaScript 的顺序导致了问题。我的页面上有很多 JavaScript，在将 Twitter 脚本标签移到我的文档头部的所有其他 javascript 或 css 标签之上之后，它就起作用了！

# java - 为什么 CustomFieldSerializer 需要静态方法？

> ID：10249093
> 
> 赞同：1
> 
> 时间：2012-04-20T15:29:37.847
> 
> 标签：java, gwt, serialization, gwt-rpc

您使用 a[`CustomFieldSerializer`](https://developers.google.com/web-toolkit/doc/latest/DevGuideServerCommunication#DevGuideCustomSerialization) 为对象定义自定义序列化和反序列化。

为您的类定义自定义序列化表面上很容易`Xxx`：

*   创建一个名为`Xxx_CustomFieldSerializer`extends的类`CustomFieldSerializer<Xxx>`，
*   实现抽象方法`serializeInstance`和`deserializeInstance`，以及可选`instantiateInstance`的 。

这会产生大量编译错误，归结为以下几点：

```
subtype Custom Field Serializer 'Xxx_CustomFieldSerializer' does not define a deserialize method: 'public static void deserialize(SerializationStreamReader reader,Xxx instance)' (reached via Xxx)' 
```

它希望您创建静态方法，这些方法与实现的方法完全相同。显然，一个委托给另一个，但这意味着您不能为类似的类型提取所有这些样板`Xxx`。

为什么？这是从旧版本的 GWT 遗留下来的还是什么？有没有办法避免写所有额外的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T12:03:42.797

感谢 Thomas Broyer 找到了这个。这只是 GWT 的一个限制。

看：`com.google.gwt.user.rebind.rpc.CustomFieldSerializerValidator`

请参阅：[http ://code.google.com/p/google-web-toolkit/issues/detail?id=7331&thanks=7331&ts=1335182609](http://code.google.com/p/google-web-toolkit/issues/detail?id=7331&thanks=7331&ts=1335182609)

# ruby-on-rails - Rails 3 缓存：独立于 HTTP 请求调用 Sweeper（例如来自后台进程）

> ID：10249094
> 
> 赞同：1
> 
> 时间：2012-04-20T15:29:39.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3, caching

我使用 Nginx + Passenger + Rails 3 设置了页面缓存，效果很好。但是有一个很大的缺陷：我通过不同的进程（通过正常的 HTTP 请求和相应的控制器，通过不涉及任何 HTTP 请求的后台进程以及通过具有不同控制器的 RailsAdmin）更改网站的内容。

有没有办法直接从模型中使页面缓存过期。最好的办法是使用一个经典的观察者，当一个对象被改变等时，它会使缓存过期。

到目前为止我发现的最好的食谱是这样的：

[http://broadcastingadam.com/2011/05/advanced_caching_in_rails](http://broadcastingadam.com/2011/05/advanced_caching_in_rails)

但这对我不起作用。

关于如何解决这个问题的任何想法？

谢谢！

# php - 更新数据库时触发自动电子邮件？

> ID：10249095
> 
> 赞同：0
> 
> 时间：2012-04-20T15:29:40.043
> 
> 标签：php, javascript, email

当我们使用“frames in”更新我们的数据库时，我正在尝试找出向客户发送自动电子邮件的最佳方式，我在想 javascript 和 php，但真的不知道如何实现为 nobo！？

### 我的 HTML 表单显示需要触发电子邮件的复选框（由于长度仅部分显示）

```
<form action="<?php echo $editFormAction; ?>" name="form" method="POST"> 
<input name="frame_in" type="checkbox" id="long_tiny" value="yes" <?php if (!(strcmp($row_Recordset1['frame_in'],"yes"))) {echo "checked=\"checked\"";} ?> />
<input type="hidden" name="MM_update" value="form">
</form> 
```

### php 邮件脚本（不确定是否完全正确）

```
$mailTo = $row_customer['email'];
$subject = 'Your Frames Now in!!';
$cName = $row_Recordset2['cName'];
$jobRef = $row_Recordset2['customer_ref'];
$ourRef = $row_Recordset2['our_ref'];
$jobTotal = $row_recordset2['amount'];
mail($mailTo, $subject,
$cName your job Ref: $jobref is now in
<br>
<h2>Details:</h2>
<p>Our ref: $ourRef<br>
Customer Ref: $jobref<br>
Job total: $jobtotal</p>
); 
```

我真的不知道如何将它们联系在一起我猜需要进行错误处理，因为并非每个客户都有电子邮件（但不需要显示错误）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:52:45.293

```
$mailTo = $row_customer['email'];
$subject = 'Your Frames Now in!!';
$cName = $row_Recordset2['cName'];
$jobRef = $row_Recordset2['customer_ref'];
$ourRef = $row_Recordset2['our_ref'];
$jobTotal = $row_recordset2['amount'];
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$message = "$cName your job Ref: $jobref is now in
<br>
<h2>Details:</h2>
<p>Our ref: $ourRef<br>
Customer Ref: $jobref<br>
Job total: $jobtotal</p>";
if($_POST['frame_in'] == "yes") {
mail($mailTo, $subject,$message, $headers); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:05:06.843

这是一个非常广泛的问题。你需要做的是：

1.  处理表格`$editFormAction`
2.  如果`$_POST['frame_in']`已设置，请执行以下操作：
    *   获取所有客户
    *   向有电子邮件地址的人发送电子邮件
3.  在您的网站上为未注册电子邮件地址的登录用户（或一般...）发布警告。

不需要额外的 javascript。

你到底卡在哪里了？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:10:24.567

您可以尝试发送电子邮件的数据库触发器。数据库本身将发送电子邮件，根本不涉及 php。这也将更具包容性，因为无论是谁/什么更改了该字段，它都会发送一封电子邮件，包括来自 PhpMyAdmin 或其他网页/脚本的更改。

[http://dev.mysql.com/doc/refman/5.0/en/triggers.html](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)

[http://forums.mysql.com/read.php?99,33635,33635#msg-33635](http://forums.mysql.com/read.php?99,33635,33635#msg-33635)

这可能会受到限制，具体取决于您的托管环境。如果您使用共享主机，出于安全原因，您很可能无法使用触发器。

# jquery - 更改链接颜色，当幻灯片图像是最后一张图像时，Jquery

> ID：10249099
> 
> 赞同：0
> 
> 时间：2012-04-20T15:29:54.050
> 
> 标签：jquery, slideshow, css-selectors

我有一个带有几张图片的幻灯片。有一个 NEXT-Link (id: #next) 可以滑过。我想在 NEXT-link 到达最后一张图片后立即更改它的 CSS-color。

我现在有类似的东西：

```
if($('img.next()').is(":last-child")){$('#next').css('color:#666');}
else{$('#next').css('color:#111');} 
```

那有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T19:41:18.580

你的`.css()`语法有点不对劲。如果您只设置一个 CSS 属性值对，就像您在上面的代码中那样，该`.css()`方法需要两个参数。

如果您需要向一个元素添加多个属性值对，`.css()`则它接受单个对象作为参数。

[您可以在jQuery 文档](http://api.jquery.com/css/)中阅读有关它的更多信息。

对于您的具体情况，代码应该看起来更像这样：

```
if($('img.next()').is(":last-child")){$('#next').css('color', '#666');}
else{$('#next').css('color', '#111');} 
```

希望有帮助！

# wpf - 以编程方式覆盖背景样式

> ID：10249100
> 
> 赞同：1
> 
> 时间：2012-04-20T15:29:55.223
> 
> 标签：wpf, wpf-controls

我有一系列应用了样式的 ToggleButtons。我希望能够在选中按钮时更改背景颜色。每个 ToggleButton 都分配给具有以下代码的相同 Checked 事件。

```
Private Sub togAnswer_Checked(ByVal sender as Object, ByVal e as System.Windows.RoutedEventArgs)
    'togAnswer was clicked....
    Dim togC as ToggleButton
    Dim togS as String = TryCast(sender, ToggleButton).Name.ToString()
    'Cycle through all answers and set style
    Dim bc = New BrushConverter()

    For x = 1 to 3
        togC = DirectCast(FindName("togAnswer" & x), ToggleButton) 

        If togS = "togAnswer" & x.ToString Then
            'Set ToggleButton to selected colour
            togC.Background = DirectCast(bc.ConvertFrom("#AAFF8020"), Brush)
        Else    
            'Set other ToggleButtons to unselected colour
            togC.Background = DirectCast(bc.ConvertFrom("#AA000000"), Brush)
        End If
    Next
End Sub 
```

该代码正确识别源 ToggleButton 但不更改颜色。

分配给 ToggleButtons 的样式是：

```
<Style x:Key="GlassToggleButton" TargetType="{x:Type ToggleButton}">
    <Setter Property="FontSize" Value="24" />
    <Setter Property="Foreground" Value="White" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ToggleButton}">
                <Border x:Name="ToggleBorder" 
                    CornerRadius="0 15 0 15" 
                    Background="#AA000000"  
                    BorderBrush="#99FFFFFF"
                    RenderTransformOrigin="0.5,0.5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="1.7*"/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" CornerRadius="0,14,0,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="#02FFFFFF" Offset="0"/>
                                    <GradientStop Color="#55FFFFFF" Offset="0.5"/>
                                    <GradientStop Color="#11FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <ContentPresenter x:Name="ToggleContentPresenter"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Grid.RowSpan="2" />
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="RenderTransform" TargetName="ToggleBorder">
                            <Setter.Value>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="0.95" ScaleY="0.95"/>
                                </TransformGroup>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Background" Value="#AAFF8020" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="True">
                        <Setter Property="Background" Value="#AAFF8020" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="False">
                        <Setter Property="Background" Value="#AA000000" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="{x:Null}">
                        <Setter Property="Background" Value="#AA000000" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:18:20.050

因为您在模板中明确设置边框的背景颜色，所以覆盖的触发器`Background`将不起作用（您的模板将忽略它）。您需要做的是重构您的样式以尊重控件自己的`Background`.

而不是设置`Background="#AA000000"`你的`Border`，设置`Background="{TemplateBinding Background}"`——这种绑定只在一个`ControlTemplate`. 然后，在您的样式中添加另一个设置`Background`为`#AA000000`. 然后你应该发现你的触发器有效果！

# java - 如何为canvas.drawColor生成随机数的随机颜色

> ID：10249103
> 
> 赞同：0
> 
> 时间：2012-04-20T15:30:10.587
> 
> 标签：java, android, android-canvas

我还是 android 开发的新手，到目前为止我一直在处理的所有应用程序都与图形无关。现在我正在制作一个显示图表的应用程序，确切地说是饼图，并且我在没有任何 3rd 方库的情况下制作它。[这](http://tutorials-android.blogspot.co.nz/2011/05/how-create-pie-chart-in-android.html)是我遵循的教程。

现在的问题是我将用于构建图形的数据是动态的，因此要为每个项目分配图形的颜色，我需要为 canvas.drawColor 生成许多随机颜色。颜色的数量当然取决于我在运行时确定的动态数据，并且还需要生成颜色值。如果生成的颜色是鲜艳的颜色，那将是很好的。

我从来没有处理过画布，知道如何做到这一点吗？示例代码将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:37:09.170

在运行时很难获得不同且有用的颜色。最好的办法是不要使用太多的随机性，而是制作一个由 20 种固定颜色组成的数组，并使用 X 的第一个颜色作为您的数据。如果您需要更多，则可以使用随机 RGB 值使用真正的随机颜色：

```
Random r = new Random();
Color c = new Color( r.nextInt(255), r.nextInt(255), r.nextInt(255) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:37:16.923

我不会只使用完全随机的颜色。你会得到完全不同的饱和度和亮度，看起来很丑。

您可以修复饱和度（为鲜艳的颜色选择较高的值）和亮度并选择随机的色调值，但您会冒着获得几乎相同颜色的两个连续饼图的风险。

我将计算一组展开的色调值，如该问题的答案所示：

*   [如何动态计算颜色列表？](https://stackoverflow.com/questions/3403826/how-to-dynamically-compute-a-list-of-colors)

在下面重新发布答案

* * *

```
import java.awt.*;

public class TestComponent extends JPanel {

    int numCols = 6;

    public void paint(Graphics g) {

        float h = 0, dh = (float) getHeight() / numCols;
        Color[] cols = getDifferentColors(numCols);

        for (int i = 0; i < numCols; i++) {
            g.setColor(cols[i]);
            g.fillRect(0, (int) h, getWidth(), (int) (h += dh));
        }
    }

    public static Color[] getDifferentColors(int n) {
        Color[] cols = new Color[n];
        for (int i = 0; i < n; i++)
            cols[i] = Color.getHSBColor((float) i / n, 1, 1);
        return cols;
    }

    public static void main(String s[]) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(new TestComponent());
        f.setSize(400, 400);
        f.setVisible(true);
    }
} 
```

![在此处输入图像描述](../Images/de1d9d51214ffb30a26891137f4fafc6.png)

如果您需要超过 30 种颜色，您当然可以更改亮度，也许还可以更改饱和度，例如，有 10 种深色、10 种中间色调和 10 种亮色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:39:05.487

您应该为每个颜色分量取一个随机浮点数：

```
Random rand = new Random();
float r = rand.nextFloat();
float g = rand.nextFloat();
float b = rand.nextFloat(); 
```

由于您想要鲜艳的色彩，您可以使用该`Color.brighter()`方法。

```
Color c = new Color(r, g, b);
c = c.brighter(); 
```

否则，您可以设置一个阈值，以便颜色值具有最小值（越高越亮）：

```
float minimumBrightness = 0.6; //higher is more vibrant
float r = rand.nextFloat(1-minimumBrightness) + minimumBrightness;  //for each  component 
```

这将确保鲜艳的色彩。

# jquery - 重新访问页面时单选按钮检查值

> ID：10249106
> 
> 赞同：1
> 
> 时间：2012-04-20T15:30:18.907
> 
> 标签：jquery, html

```
<div class="formfield ship">
    <input type="radio" class="ship1" name="1" >1</input>
    <input type="radio" class="ship2" name="1" >2</input>
    <input type="radio" class="ship3" name="1" >3</input>
    <div class="clear"><!-- FLOAT CLEAR --></div>
</div> 
```

我有单选按钮，一个必须具有默认值..当我选择一个并提交然后返回页面时，该值必须保留..

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:19:10.090

这可以满足您的要求-尽管您需要稍微修改 html（我认为`<input></input>`无效）

[http://jsfiddle.net/malet/dvCpj/6/](http://jsfiddle.net/malet/dvCpj/6/)

```
$("input[type=radio]").each(function(){
    $(this).click(function(){     
        createCookie($(this).attr("name"), $($(this).siblings()[0]).html(),1);       
    });
});

$(document).ready(function(){
    $("input[type=radio]").each(function(){
        var selected = readCookie($(this).attr("name"));
        if(selected != null){
            if($($(this).siblings()[0]).html() == selected){
                $(this).attr("checked","checked");
            }                    
        }    
    });
});

function createCookie(name,value,days) {
    if (days) {
            var date = new Date();
            date.setTime(date.getTime()+(days*24*60*60*1000));
            var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:06:16.527

客户端您可能希望使用 cookie 来存储信息。服务器端，可以使用会话变量。

这取决于您的环境，但您基本上是在保存用户提交的内容并在输出表单时检查该值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:24:51.863

基本上有两种方法可以做到这一点。

1.  饼干
2.  服务器端语言，如 php、asp

但无论哪种方式，主要的一点是，必须更改无线电元素的默认值。您可以使用服务器端脚本来提供新的默认值或使用 cookie 来获取新的默认值。

# crystal-reports - Crystal 报表中 SQL 参数字段中的日期转换

> ID：10249108
> 
> 赞同：0
> 
> 时间：2012-04-20T15:30:29.483
> 
> 标签：crystal-reports, crystal-reports-xi

我有一个 Crystal 报表（版本 XI r3），它使用 SQL 命令对象来检索其数据。在命令对象中，我有一个日期参数。我的数据库使用以 YYYYMMDD 格式存储为数值的“日期”字段，因此我将参数指定为数字并添加了提示“以 YYYYMMDD 格式输入日期”。

我的用户不太关心这个。他们希望能够使用日期选择器和/或能够以 MM/DD/YYYY 格式输入日期。

到目前为止，我的调查使我相信，如果我将参数转换为真正的日期数据类型，我将无法在 SQL 命令对象中使用它，因为我无法将它从日期转换为数字在 SQL 语句中，所以我必须在 Crystal Select Wizard 中而不是在我的 SQL 语句中进行日期范围控制，这可能会使我的报告速度降低一到两个数量级（因为我正在打表由该日期字段索引，并且每天有很多记录）。

我错了吗？有没有办法让用户以 MM/DD/YYYY 格式输入日期，并且仍然能够在我的 SQL 命令对象中将其用作数字 YYYYMMDD 参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:49:42.237

恐怕您必须修改原始命令以将数字参数替换为日期参数，并在命令本身内进行从日期到数字的转换。

因此，在命令中：

```
WHERE MyDate = {?MyNumberParam) 
```

会成为：

```
WHERE MyDate = (YEAR({?MyDateParam})*10000) + (MONTH({?MyDateParam})*100) + DAY({?MyDateParam}) 
```

最后一部分将 2012 年 4 月 20 日转换为 (2012*10000 + 4*100 + 20) = 20120420，我相信这就是您想要的。

# javascript - 如何在 Javascript 中检测网络丢失？

> ID：10249109
> 
> 赞同：5
> 
> 时间：2012-04-20T15:30:38.293
> 
> 标签：javascript, dom-events

我的 Web 应用程序可在多个手持设备上运行，例如 iPad、Galaxy 选项卡等。应用程序从服务器请求图像并在客户端上呈现。

现在问题有时会发生，在渲染图像期间网络连接丢失，而不是在设备上显示 html 无图像图标...

**我想优雅地处理这种情况，在网络丢失时，我想捕获它并向用户显示没有网络连接或其他东西的警报......**

我尝试了用户`navigator.onLine`事件..但它不适用于我支持的所有浏览器集，例如 mozilla 上的 5-6 版本等。

**而且我的应用程序将仅在 wifi 本地网络上运行......可能会或可能不会连接到互联网**.. 在该套装中也可以这样`navigator.onLine`工作..？

请为我提供任何其他更好的方法来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:34:18.563

例如，您可以使用

```
<img src="..." onerror="noConnection()"> 
```

因此，如果未加载图像，将调用 noConnection 方法。

更多信息在这里：[jQuery/JavaScript 替换损坏的图像](https://stackoverflow.com/questions/92720/jquery-javascript-to-replace-broken-images)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:12:36.920

您可以向您的服务器发出一点 XHR 请求并检查返回的状态。

如果是`0`，这意味着[连接丢失](http://www.w3.org/TR/XMLHttpRequest/#the-status-attribute)。

所以，像这样的东西可以给你一个小实用功能：

```
function isOnline ( callback ) {
    var xhr = new XMLHttpRequest( )
    xhr.onreadystatechange = function ( ) {
        // Make sure the request is finished
        if ( xhr.readyState === 4 ) {
            // There is the magic
            if ( xhr.status === 0 ) {
                callback( false )
            }
            else {
                callback( true )
            }
        }
    }
    xhr.open( '/some/url' )
    xhr.send( )
}

// Usage example:
isOnline( function ( status ) {
    if ( status ) {
        // You're online
    }
    else {
        // You're not online
    }
} ) 
```

PS：我跳过了对象的 IE 兼容部分`xhr`，但它很容易添加。这更多是为了得到这个想法。

# haskell - 宏在多大程度上“反向发挥作用”？

> ID：10249110
> 
> 赞同：20
> 
> 时间：2012-04-20T15:30:39.077
> 
> 标签：haskell, macros, lisp, scheme

我正在用 Haskell（[GitHub 上的代码](https://github.com/chris-taylor/Haskeme)）编写一个 Lisp，作为了解更多关于这两种语言的一种方式。

我要添加的最新功能是宏。不是卫生的宏或任何花哨的东西——只是普通的代码转换。我的初始实现有一个单独的宏环境，与所有其他值所在的环境不同。在`read`和`eval`函数之间，我穿插了另一个函数`macroExpand`，它遍历代码树并在宏环境中找到关键字时执行适当的转换，在最终表格被传递`eval`以进行评估之前。这样做的一个很好的优点是宏具有与其他函数相同的内部表示，这减少了一些代码重复。

不过，拥有两个环境似乎很笨重，如果我想加载一个文件，`eval`就必须访问宏环境以防文件包含宏定义，这让我很恼火。所以我决定引入一个宏类型，将宏与函数和变量存储在同一环境中，并将宏扩展阶段合并到`eval`. 起初我对如何做到这一点有点茫然，直到我想我可以写这段代码：

```
eval env (List (function : args)) = do
    func <- eval env function
    case func of 
        (Macro {}) -> apply func args >>= eval env
        _          -> mapM (eval env) args >>= apply func 
```

它的工作原理如下：

1.  如果您收到一个包含初始表达式和一堆其他表达式的列表...
2.  评估第一个表达式
3.  如果是宏，则将*其应用于 arguments*并*评估结果*
4.  如果它不是宏，则*评估参数*并将*函数应用于结果*

就好像宏和函数完全一样，只是 eval/apply 的顺序被切换了。

这是对宏的准确描述吗？通过以这种方式实现宏，我是否遗漏了一些重要的东西？如果答案是“是”和“否”，那么为什么我以前从未见过以这种方式解释的宏？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T16:07:36.810

答案是“不”和“是”。

看起来您已经从一个*好的*宏模型开始，其中宏级别和运行时级别位于不同的世界中。[事实上，这也是Racket](http://racket-lang.org/)[宏系统](http://docs.racket-lang.org/guide/macros.html)背后的要点之一。[您可以在 Racket 指南](http://docs.racket-lang.org/guide/stx-phases.html)中阅读一些关于它的简短文本，或者查看描述此功能以及为什么这样做是个好主意的[原始论文。](http://www.cs.utah.edu/plt/publications/macromod.pdf)请注意，Racket 的宏系统是一个非常复杂的系统，而且它很卫生——但不管卫生如何，相分离都是一个好主意。总结主要优点，它可以始终以可靠的方式扩展代码，因此您可以获得单独编译等好处，并且您不依赖于代码加载顺序和此类问题。

然后，你进入了一个单一的环境，它失去了这一点。在大多数 Lisp 世界中（例如，在 CL 和 Elisp 中），事情就是这样完成的——显然，你会遇到上面描述的问题。（“显而易见”，因为相分离是为了避免这些问题而设计的，你只是碰巧以与历史上发生的顺序相反的顺序得到你的发现。）无论如何，为了解决其中一些问题，有一种[`eval-when`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/speope_eval-when.html)特殊的形式，它可以指定在运行时或宏扩展时评估某些代码。在 Elisp 中，您可以通过`eval-when-compile`，但是在 CL 中，你会得到更多的头发，还有一些其他的“*-time”。（CL 也有阅读时间，与其他所有东西共享相同的环境会带来三倍的乐趣。）即使这看起来是个好主意，你也应该四处阅读，看看一些 lispers 是如何[因为这种混乱而脱发的](http://fare.livejournal.com/146698.html)。

在你描述的最后一步中，你甚至更进一步地发现了一些被称为 FEXPRs 的东西。我什至不会为此提供任何指示，您可以找到大量关于它的文本，为什么有些人认为这是一个非常糟糕的主意，为什么有些人认为这是一个非常好的主意。实际上，这两个“一些”分别是“最多”和“少数”——尽管 FEXPR 剩下的几个据点可以是有声的。翻译所有这些：它是爆炸性的东西……提出有关它的问题是引发长期激烈争吵的好方法。（作为最近严肃讨论的一个例子，你可以看到 R7RS 的初始讨论期，FEXPR 出现并导致了这些类型的火焰。）无论你选择坐在哪一边，有一点是显而易见的：具有 FEXPR 的语言与没有它们的语言截然不同。[巧合的是，在 Haskell 中进行实现可能会影响你的观点，因为你有一个地方可以去寻找一个理智的静态代码世界，所以“可爱”的超动态语言的诱惑可能更大......]

最后一点：既然你在做类似的事情，你应该研究一个[在 Haskell 中实施方案](https://github.com/justinethier/husk-scheme)的类似项目——IIUC，它甚至有卫生的宏。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-20T16:03:50.640

不完全的。实际上，您已经非常简洁地描述了“按名称调用”和“按值调用”之间的区别；按值调用语言在替换之前将参数简化为值，按名称调用语言首先执行替换，然后进行归约。

主要区别在于宏允许您打破参照透明性；特别是，宏可以检查代码，因此可以区分 (3 + 4) 和 7，这是普通代码无法做到的。这就是为什么宏更强大也更危险的原因。如果大多数程序员发现 (f 7) 产生了一个结果而 (f (+ 3 4)) 产生了不同的结果，他们会感到不安。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-20T21:45:10.627

**背景杂乱无章**

您所拥有的是非常晚的绑定宏。这是一种可行的方法，但效率低下，因为重复执行相同的代码会重复扩展宏。

从积极的方面来说，这对交互式开发很友好。如果程序员改变了一个宏，然后重新调用了一些使用它的代码，比如之前定义的函数，新的宏会立即生效。这是一种直观的“按我的意思去做”的行为。

在较早扩展宏的宏系统下，当宏发生变化时，程序员必须重新定义所有依赖于宏的函数，否则现有定义将继续基于旧的宏扩展，忽略新版本的宏.

一个合理的方法是让这个后期绑定宏系统用于解释代码，但一个“常规”（因为没有更好的词）宏系统用于编译代码。

扩展宏不需要单独的环境。它不应该，因为本地宏应该与变量在同一个命名空间中。例如，在 Common Lisp 中，如果我们这样做`(let (x) (symbol-macrolet ((x 'foo)) ...))`，内部符号宏会隐藏外部词法变量。宏扩展器必须知道变量绑定形式。反之亦然！`let`如果变量有一个内部`x`，它会影响一个外部`symbol-macrolet`。宏扩展器不能盲目地替换`x`正文中出现的所有事件。所以换句话说，Lisp 宏扩展必须知道宏和其他类型的绑定共存的完整词法环境。当然，在宏扩展期间，您不会以相同的方式实例化环境。当然，如果有`(let ((x (function)) ..)`，`(function)`没有被调用，`x`也没有被赋予一个值。但是宏扩展器知道`x`在这个环境中有一个，所以出现的`x`不是宏。

因此，当我们说一个环境时，我们真正的意思是统一环境有两种不同的表现形式或实例化：扩展时间表现形式和评估时间表现形式。后期绑定宏通过将这两个时间合并为一个来简化实现，就像您所做的那样，但不必如此。

另请注意，Lisp 宏可以接受`&environment`参数。如果宏需要调用`macroexpand`用户提供的某些代码，则需要这样做。这种通过宏递归回到宏扩展器必须传递正确的环境，以便用户的代码可以访问其词法周围的宏并正确扩展。

**具体例子**

假设我们有这样的代码：

```
(symbol-macrolet ((x (+ 2 2)))
   (print x)
   (let ((x 42)
         (y 19))
     (print x)
     (symbol-macrolet ((y (+ 3 3)))
       (print y)))) 
```

这对打印的影响`4`,`42`和`6`。让我们使用 Common Lisp 的 CLISP 实现，并使用 CLISP 的特定于实现的函数来扩展它`system::expand-form`。我们不能使用常规的标准，`macroexpand`因为它不会递归到本地宏中：

```
(system::expand-form   
  '(symbol-macrolet ((x (+ 2 2)))
     (print x)
     (let ((x 42)
           (y 19))
       (print x)
       (symbol-macrolet ((y (+ 3 3)))
         (print y)))))

-->

(LOCALLY    ;; this code was reformatted by hand to fit your screen
  (PRINT (+ 2 2))
  (LET ((X 42) (Y 19))
    (PRINT X)
    (LOCALLY (PRINT (+ 3 3))))) ; 
```

（首先，关于这些`locally`表单。为什么它们在那里？请注意，它们对应于我们有 a 的地方`symbol-macrolet`。这可能是为了声明。如果`symbol-macrolet`表单的主体有声明，它们必须限定在该主体, 并且`locally`会这样做。如果扩展`symbol-macrolet`没有留下这个`locally`包装，那么声明将有错误的范围。）

从这个宏展开你可以看到任务是什么。宏扩展器必须遍历代码并识别所有绑定构造（实际上是所有特殊形式），而不仅仅是与宏系统有关的绑定构造。

注意其中一个实例`(print x)`是如何被单独留下的：在 . 范围内的实例`(let ((x ..)) ...)`。另一个变成`(print (+ 2 2))`了，按照符号宏换`x`。

我们可以从中学到的另一件事是宏扩展只是替换扩展并删除了`symbol-macrolet`形式。所以剩下的环境是原来的环境，**减去**在膨胀过程中被擦掉的所有宏观材料。宏扩展在一个大的“大统一”环境中**尊重**所有词汇绑定，但随后优雅地蒸发，只留下类似的代码`(print (+ 2 2))`和其他痕迹`(locally ...)`，只有非宏绑定构造导致减少版本原来的环境。

因此，现在在评估扩展代码时，只有简化环境的运行时特性开始发挥作用。`let`绑定被实例化并填充初始值等。在扩展期间，这些都没有发生；非宏绑定只是在那里声明它们的范围，并暗示运行时未来的存在。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-20T15:40:59.113

您缺少的是，当您[将分析与评估分开](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-26.html#%_sec_4.1.7)时，这种对称性就会破坏，这是所有实际的 Lisp 实现所做的。宏观扩展将在分析阶段发生，因此`eval`可以保持简单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-20T18:15:31.650

我真的建议随身携带一些 Lisp 书籍。推荐例如*Christian Queinnec*，*Lisp in Small Pieces*。这本书是关于Scheme的实现的。

[http://pagesperso-systeme.lip6.fr/Christian.Queinnec/WWW/LiSP.html](http://pagesperso-systeme.lip6.fr/Christian.Queinnec/WWW/LiSP.html)

第 9 章是关于宏的：http: [//pagesperso-systeme.lip6.fr/Christian.Queinnec/WWW/chap9.html](http://pagesperso-systeme.lip6.fr/Christian.Queinnec/WWW/chap9.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-20T18:39:26.330

对于它的价值，Scheme R ⁵ RS 部分**语法关键字的绑定结构**有这样的说法：

> `Let-syntax`and`letrec-syntax`类似于`let`and `letrec`，但它们将句法关键字绑定到宏转换器，而不是将变量绑定到包含值的位置。

见：[http ://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-ZH-7.html#%_sec_4.3.1](http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_sec_4.3.1)

这似乎意味着应该使用单独的策略，至少对于`syntax-rules`宏观系统而言。

* * *

您可以在为宏使用单独“位置”的方案中编写一些......有趣的代码。在任何“真实”代码中混合同名的宏和变量没有多大意义，但如果您只是想尝试一下，请考虑来自 Chicken Scheme 的这个示例：

```
#;1> let
Error: unbound variable: let
#;1> (define let +)
#;2> (let ((talk "hello!")) (write talk))
"hello!"
#;3> let
#<procedure C_plus>
#;4> (let 1 2)
Error: (let) not a proper list: (let 1 2)

    Call history:

    <syntax>                (let 1 2)       <--
#;4> (define a let)
#;5> (a 1 2)
3 
```

# silverlight - 套接字编程

> ID：10249113
> 
> 赞同：0
> 
> 时间：2012-04-20T15:30:49.157
> 
> 标签：silverlight

我的服务器有 ip 和三个端口，并且有更多的发送者（每个发送者都有 ip）到这个服务器，还有一个接收者（有它的 ip）。如果 sernder A 和 sender B 发送到服务器，如果我希望接收者只接收从发送者 A 发送的数据（如何通过在 silverlight 中使用套接字编程来做到这一点）。我使用（AddressFamily.InterNetwork、SocketType.Stream、ProtocolType.Tcp）。请帮帮我

新套接字（AddressFamily.InterNetwork，SocketType.Stream，ProtocolType.Tcp）；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:45:05.383

由于标点符号、缺少大写字母和拼写问题，您的信息非常混乱。但不管怎么说。

您无法阻止来自特定客户端的套接字级别连接，您必须知道哪个 IP 或在建立连接后进行某种握手以了解它是哪个客户端。

您可以使用防火墙硬件/软件阻止来自特定 IP 的连接。

同时，我相信这只是您尝试做的软件任务。所以你连接后会有某种身份识别。假设服务器已绑定，正在等待连接，一旦它们被接受，您将获得新的客户端套接字，该套接字在通过一些将进行身份验证连接的消息交换之前不会被授权。如果这在一段时间内没有完成，服务器可能会断开连接。

这看起来像是您尝试解决的非常基本的任务和问题，我建议您阅读一些有关套接字编程的基础知识。

# html - 在 IE<9 中更改文本选择的颜色

> ID：10249116
> 
> 赞同：1
> 
> 时间：2012-04-20T15:30:53.923
> 
> 标签：html, css

在 IE<9 中由 css/javascript 选择文本时如何更改文本颜色？据我所知，`::selection`在 IE<9 中不起作用。有人可以帮我解决这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:22:41.137

[Quirksmode](http://www.quirksmode.org/css/selection.html)确认 IE 不支持此功能。我知道 IE 没有其他选择（CSS 或 JS）。

# php - Symfony 模板破坏数据

> ID：10249118
> 
> 赞同：0
> 
> 时间：2012-04-20T15:31:09.290
> 
> 标签：php, mysql, symfony, doctrine

我发现当我将教义实体传递给我们的 PHP 模板时，设计人员可以开始调用 setter 并更改数据。这通常没什么大不了的，除了有执行子请求的页面，因此控制器可以看到这些更改并有可能保存到数据库中（身份映射模式返回对象而不是从存储中刷新）！

有什么方法可以防止模板更改数据？

（我在传递实体之前尝试过分离实体，但这使得原则代理不返回数据。我真的不想失去延迟加载）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:16:35.940

考虑使用延迟显式更改跟踪策略：

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/change-tracking-policies.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/change-tracking-policies.html)

只有您明确保留的实体才会被考虑更新。因此，在模板中完成的附带更新将不会被保存。

我想您也可以尝试通知策略，并通过一些魔术禁用通知发件人以使您的实体基本上是只读的。

# c# - 用 C# 为 asp 创建 FTP 客户端

> ID：10249120
> 
> 赞同：0
> 
> 时间：2012-04-20T15:31:20.973
> 
> 标签：c#, asp.net

我有一个小问题，因为在我的网站上我无法真正为目录设置权限，它只是不起作用。我使用filezilla，当我尝试将它们设置为可公开读写的服务器默认目录的某些子目录时，它不会向我发送错误，但是当我想将文件保存在其中一个子目录中时来自asp页面我得到一个错误，告诉我没有权限这样做，我尝试设置 777，所以它应该可以工作。我使用 C# 创建了一个 FTP 客户端，它允许我编辑那些子目录（那些我无法从 asp 页面编辑的子目录）。我的问题是：我可以创建一个使用 FTP 客户端访问其中一个子目录的 asp 页面吗？？？？？？谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:14:15.583

正如我之前提到的，您可以尝试使用 WCF 并使用 Web 服务将文件流式传输到您的服务器。

WCF 可能相当复杂；但是，网上有很多教程。您可以从这个[简单的教程](http://www.c-sharpcorner.com/uploadfile/hgvyas123/wcf-tutorial/)开始并对其进行调整以完成您的需要。他们甚至提供源代码。

基本上，您需要的是具有一种方法的 Web 服务，例如：

```
void UploadFile(Stream object) 
```

然后，您需要通过提供 WCF Web 服务的地址，从您的客户端（例如 Windows 窗体应用程序）创建一个 Web 引用。这将自动创建执行该方法所需的类。

[这个网站有更多关于流文件的信息：](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T16:01:30.653

为您的网站用于访问任何目录的帐户设置权限。默认情况下，在 IIS 中使用 iis_user 帐户。将您的网站用户帐户更改为 ftp 用户或任何有权访问这些目录的帐户。您可以轻松更改此权限使用 iis7 管理器。

# python - 如何在python中实现可插入函数的“菊花链”？

> ID：10249121
> 
> 赞同：3
> 
> 时间：2012-04-20T15:31:27.853
> 
> 标签：python

这是问题所在：

1）假设我有一些测量数据（比如从我的电子设备中读取的 1Msample），我需要通过处理链处理它们。

2）这个处理链由不同的操作组成，可以交换/省略/具有不同的参数。一个典型的例子是获取这些数据，首先通过查找表传递它们，然后进行指数拟合，然后乘以一些校准因子

3) 现在，由于我不知道哪种算法最好，我想在每个阶段评估最佳可能实现（例如，LUT 可以通过 5 种方式生成，我想看看哪一种是最好的)

4）我想菊花链这些功能，我会构造一个包含顶级算法的“类”并拥有（即指向）子类，包含较低级别的算法。

我正在考虑使用双链表并生成如下序列：

myCaptureClass.addDataTreatment(pmCalibrationFactor(opt, pmExponentialFit (opt, pmLUT (opt))))

其中 myCaptureClass 是负责数据采集的类，它也应该（在采集数据之后）触发顶级数据处理模块 (pm)。该处理将首先深入到底部子级（lut），在那里处理数据，然后是中间（expofit），然后是顶部（califactors）并将数据返回给捕获，捕获将数据返回给请求者。

现在这有几个问题：

1）网上到处都说在python中不应该使用双链表 2）这在我看来效率很低，因为数据向量很大，因此我更喜欢使用生成器函数的解决方案，但我不确定如何提供“插件式”机制。

有人可以给我一个提示如何使用“插件样式”和生成器来解决这个问题，这样我就不需要处理 X 兆字节数据的向量并在使用生成器函数时“按需”处理它们是正确的？

多谢

大卫

问题的补充：

看来我并没有准确地表达自己。因此：数据由插入 VME crate 的外部硬件卡生成。它们在单个块传输中“获取”到存储在 myCaptureClass 中的 python 元组。

要应用的操作集实际上是在一个流数据上，由这个元组表示。甚至指数拟合也是流操作（它是应用于每个样本的一组可变状态过滤器）。

我错误地显示的参数'opt'是为了表达，每个数据处理类都有一些配置数据，并修改用于操作数据的方法的行为。

目标是在 myCaptureClass 中引入一个菊花链类（而不是函数），当用户请求数据时，我们用来将“原始”数据处理成最终形式。

为了“节省”内存资源，我认为使用生成器函数来提供数据可能是个好主意。

从这个角度来看，似乎与我想做的最接近的匹配显示在 bukzor 的代码中。我更喜欢有一个类实现而不是函数，但我想这只是在特定类中实现**调用**运算符的装饰性东西，它实现了数据操作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:24:23.613

这就是我想象你会这样做的方式。我希望这是不完整的，因为我不完全理解您的问题陈述。请让我知道我做错了什么:)

```
class ProcessingPipeline(object):
    def __init__(self, *functions, **kwargs):
        self.functions = functions
        self.data = kwargs.get('data')
    def __call__(self, data):
        return ProcessingPipeline(*self.functions, data=data)
    def __iter__(self):
        data = self.data
        for func in self.functions:
            data = func(data)
        return data

# a few (very simple) operators, of different kinds
class Multiplier(object):
    def __init__(self, by):
        self.by = by
    def __call__(self, data):
        for x in data:
            yield x * self.by

def add(data, y):
    for x in data:
        yield x + y

from functools import partial
by2 = Multiplier(by=2)
sub1 = partial(add, y=-1)
square = lambda data: ( x*x for x in data )

pp = ProcessingPipeline(square, sub1, by2)

print list(pp(range(10)))
print list(pp(range(-3, 4))) 
```

输出：

```
$ python how-to-implement-daisychaining-of-pluggable-function-in-python.py 
[-2, 0, 6, 16, 30, 48, 70, 96, 126, 160]
[16, 6, 0, -2, 0, 6, 16] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T15:35:39.150

`functional`从 pypi获取模块。它有一个组合函数来组合两个可调用对象。这样，您可以将功能链接在一起。

既是那个模块，又`functool`是提供一个`partial`函数，用于部分应用。

您可以像使用其他任何函数一样在生成器表达式中使用组合函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T15:42:01.153

不知道你到底想要什么，我觉得我应该指出你可以把任何你想要的东西放在列表理解中：

```
l = [myCaptureClass.addDataTreatment(
          pmCalibrationFactor(opt, pmExponentialFit (opt, pmLUT (opt))))
     for opt in data] 
```

将创建已通过组合函数传递的新数据列表。

或者您可以创建一个用于循环的生成器表达式，这不会构建一个全新的列表，它只会创建一个迭代器。我认为以这种方式做事与仅处理循环体中的数据相比没有任何优势，但看起来很有趣：

```
d = (myCaptureClass.addDataTreatment(
          pmCalibrationFactor(opt, pmExponentialFit (opt, pmLUT (opt))))
     for opt in data)
for thing in d:
    # do something
    pass 
```

还是`opt`数据？

# javascript - Javascript记录击键时间

> ID：10249132
> 
> 赞同：2
> 
> 时间：2012-04-20T15:32:19.353
> 
> 标签：javascript, jquery, record, timing, keystroke

我想以毫秒为单位记录每次击键之间的时间（只有一个键开始，'A'键）。用户完成他的事情后，他可以提交并检查每次击键之间的时间。像：

1：500 2：300 3：400 4：500 5：100 6：50 7：50 8：25

我相信这可以通过 Javascript 实现，是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:06:19.810

当然：

```
var times = [];

// add an object with keycode and timestamp
$(document).keyup(function(evt) {
    times.push({"timestamp":evt.timeStamp,
                "keycode":evt.which})
});

// call this to get the string
function reportTimes() {
    var reportString = "";
    for(var i = 0; i < times.length - 1; ++i) {
         reportString += (i+1) + ": " + (times[i+1].timestamp - times[i].timestamp) + " ";
    }
    return reportString; // add this somewhere or alert it
} 
```

我添加了密钥代码以防您以后需要它；您的确切问题陈述没有必要。

* * *

**评论讨论的澄清：**

`for`循环只达到（`times.length - 2`因为`i`总是严格小于），所以在数组边界之外`times.length - 1`没有问题。`times[i+1]`例如，如果您按了五次按键，因此有一个`times`包含五个元素的数组（从`0`to索引`4`）：

```
1st pass: times[1].timestamp - times[0].timestamp
2nd pass: times[2].timestamp - times[1].timestamp
3rd pass: times[3].timestamp - times[2].timestamp
4th pass: times[4].timestamp - times[3].timestamp 
```

然后循环终止，因为设置`i`为`4`触发终止条件：

```
= i < times.length - 1
= 4 < 5 - 1
= 4 < 4
= false  [i cannot be set to 4 by this loop] 
```

因此，`times[i+1]`总是一个有效索引的元素，因为`i`最多比最大索引小一。

# wcf - Wcf 服务继承（扩展服务）

> ID：10249137
> 
> 赞同：2
> 
> 时间：2012-04-20T15:32:32.290
> 
> 标签：wcf, inheritance, service, callback, servicecontract

我正在开发的程序使用 wcf 公开回调和服务。基本上，服务所做的只是返回一些变量值。至于回调，他们只是更新那些变量。

我希望能够公开一个只包含服务的类和一个包含服务和回调的类。

例如 ：

```
[ServiceContract]
[ServiceBehavior(InstanceContextMode=InstanceContextMode::Single, ConcurrencyMode=ConcurrencyMode::Multiple)]
public ServiceClass
{
  [OperationContract]
  public int getValue()
  {
    return mValue;
  }

  protected static int mValue;

};

[ServiceContract]
[ServiceBehavior(InstanceContextMode=InstanceContextMode::Single, ConcurrencyMode=ConcurrencyMode::Multiple)]
public ServiceAndCallbackClass : ServiceClass
{
  [OperationContract]
  public bool subscribe()
  {
    // some subscribing stuff
  }

  public void MyCallback()
  {
    ++mValue;

    // Notify every subscriber with the new value
  }

}; 
```

如果我只想要服务，我可以使用基类。但是，如果我想订阅回调并使用服务，我可以使用 ServiceAndCallbackClass。

这可能吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:54:08.623

我发现的一种解决方案：

制作2个接口。第一个仅包含服务，第二个从第一个继承并添加回调。

一个实现类将实现这两​​个接口。

例子 ：

```
[ServiceContract]
[ServiceKnownType(typeof(ICallback))]
public interface IService
{
  [OperationContract]
  int GetData();
}

[ServiceContract]
public interface ICallback : IService
{
  [OperationContract]
  public bool subscribe();
}

[ServiceBehavior(InstanceContextMode=InstanceContextMode::Single, ConcurrencyMode=ConcurrencyMode::Multiple)]
public ServiceClass : IService, ICallback
{
  public int getValue()
  {
    return mValue;
  }

  public bool subscribe()
  {
    // some subscribing stuff
  }

  public void myCallback()
  {
    ++mValue;

    // Notify every subscriber with the new value
  }    

  protected static int;
};

[ServiceBehavior(InstanceContextMode=InstanceContextMode::Single, ConcurrencyMode=ConcurrencyMode::Multiple)]
public ServiceAndCallbackClass : ServiceClass
{
  // Dummy implementation used to create second service
}; 
```

From there, we can create 2 services. One based on the implementation class and one based on the "Dummy" class. Each service would be created from a different interface and thus exposing different methods.

# java - 从子线程访问父实例

> ID：10249138
> 
> 赞同：3
> 
> 时间：2012-04-20T15:32:32.200
> 
> 标签：java, multithreading, sockets, static, parent

我正在编写一个将在 Java 中模拟 Kerberos 协议的代码。我有一个服务器类和一个客户端类。但是有些内容是静态的，而其他内容不是，加上套接字，我至少可以说是混淆了。我认为该协议的细节在这个问题中是任意的。

我有一个 Server 类，它调用一个 ServerThread 类：

```
public class Server{

    public void someMethod(){ /* some code */ }

    public static void main(String args[]){ 
        ServerSocket serverSocket = new ServerSocket(port);
        new ServerThread(serverSocket.accept()).start();
    }
}

public class ServerThread extends Thread{
    /* constructor (takes serverSocket from Server) */

    this.parent.someMethod();
    /* That would call someMethod() from the parent class Server instance
     * that instantiated this.
     */
    } 
```

实例化 ServerThread 的 Server 类的部分给了我，我必须按原样使用它。我自己编写的 someMethod() 方法，这是我想从 ServerThread 中使用的方法。有没有办法调用 this.parent.someMethod(); 的代码行？如果可以的话，有没有办法从一个控制器类访问这两个类，或者静态内容与非静态内容是否会破坏这个想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T15:47:04.930

你能传递对实例的引用`Server`吗`ServerThread`（通过getter/setter或修改构造函数）？如果是这样，请传递引用，然后您可以调用`server.someMethod()`，假设`server`是变量名。

如果没有，您`someMethod()`作为静态方法是否有意义？如果将其设为静态方法是安全的，您可以这样做`Server.someMethod().`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T15:45:43.863

当您分配一个`Server`（大概只有其中一个）时，将其写入`Server`. 然后，您可以从任何地方访问该字段，包括`ServerThread`.

在`Server`：

```
static Server server; // the one true server in this application 
```

在`Server.main`：

```
server = new Server(); 
```

在`ServerThread`：

```
Server.server.someMethod(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T15:43:02.610

```
 class Server extends Thread{

    public void someMethod(){ /* some code */ }

    public static void main(String args[]){ 
      //  ServerSocket serverSocket = new ServerSocket(port);

    }
}

  class ServerThread extends Server{
    /* constructor (takes serverSocket from Server) */
public ServerThread(){
     super.someMethod();

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T15:47:17.953

当您创建一个套接字上下文类实例以传递给您的线程时 - 包含 serverSocket 等的线程 - 也将它与服务器实例“this”一起加载。然后，您可以轻松地从您的 ServerThread 调用它的方法。

# swing - 找不到 Scala Swing 包

> ID：10249139
> 
> 赞同：5
> 
> 时间：2012-04-20T15:32:34.430
> 
> 标签：swing, scala, import

我的问题：

```
error: object swing is not a member of package scala
import scala.swing._
^ 
```

当我尝试使用 Scala 启动任何 GUI 应用程序时。我到现在为止的尝试：直接由 scala 命令调用，并先由 scalac 和 fsc 预编译，没有任何效果。

我的系统：一台 Ubuntu 11.10 机器，安装了 OpenJDK 6、OpenJDK 7、Oracle JDK 6 和 Ubuntu 存储库中的 Scala-Packe，另外我尝试了官方 Scala 主页（scala-lang）中的“新”Scala。.deb-package 无法安装，但 *.tgz 文件中的纯文件到目前为止有效。

我尝试了我已安装的这些软件的所有可能组合，但没有一个可以工作。

笑话：在我的 Windows 7 机器上，相同的代码 (dropbox-sync) 没有任何问题。

有任何想法吗？我是不是忘记了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-07-07T18:52:50.483

自最初的问题以来已经好几个月了，但是因为我刚刚遇到了同样的问题，并且谷歌搜索显示了这个线程：

看起来他们将 scala swing 与核心 swing 库分开了。因此，如果您使用的是 sbt： libraryDependencies += "org.scala-lang" % "scala-swing" % "2.10.2"

（我想以前的答案也暗示了这一点，真的，但是因为我得到了那个错误并且这是修复，我只是将它添加以供其他人参考）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T15:45:15.717

它显然没有`scala-swing.jar`在类路径中找到。我不确定为什么会这样；它适用于我的系统（仍然是 11.04；不喜欢 Unity）。尝试明确添加它： `-cp /wherever/oneiric-ocelot/puts/scala/lib/scala-swing.jar`.

如果该文件不在您的系统上，您可以从[项目网页](https://github.com/scala/scala-swing)下载它。（单击标题下方自述文件中相应的“最新版本”按钮。然后下载 jar。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-26T17:36:44.080

解决此错误的最简单方法是下载 scala.swing 包并将其保存在主项目文件夹中名为 lib 的文件夹中。这样，当您使用 sbt 或任何其他工具编译程序时，编译器将扫描 lib 文件夹并使用新包进行自我更新。另一种方法是通过在其中添加以下行来编辑 build.sbt 文件

“org.scala-lang”%“scala-swing”%“2.10.2”

# android - 带有视频内容的 iPhone/Android 应用程序 - 管理材料的最佳方式是什么？

> ID：10249141
> 
> 赞同：1
> 
> 时间：2012-04-20T15:32:39.887
> 
> 标签：android, iphone, video

虽然我有一些将录制的小片段放入应用程序、存储它们并通过简单的按钮按下来回放它们的经验。

现在我需要用安装时可用的应用程序封装一些视频。在 iPhone/Android 多媒体应用程序中存储较长视频材料的最佳方式是什么？

材料应该可以离线使用。到目前为止，我只有一些基本问题：

1.  哪种目标转换格式和设置最适合 iPhone/Android？（手机/平板电脑/设备分辨率之间是否存在相当大的差异 - 或者实际上都可以使用一种格式提供服务？）
2.  有没有经验可以在这样的应用程序中总共存储多少分钟的“好”（非高清）视频？
3.  您是否知道任何可以用作想法和/或编码的起点的教程/示例应用程序，理想情况下具有某种创新的“性感”功能，例如可触摸区域的覆盖？

非常感谢！

# iphone - iPhone设备态度不断变化

> ID：10249142
> 
> 赞同：0
> 
> 时间：2012-04-20T15:32:42.007
> 
> 标签：iphone, objective-c, ios, rotation, direction

我注意到，如果我调用 CMMotionManager 类的 startDeviceMotionUpdates 方法，然后旋转设备并将其放回桌面，则报告的设备姿态不断变化，每次报告的旋转矩阵都与上次不同。有没有其他人注意到同样的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T04:25:29.570

显然，陀螺参考系的漂移是一个常见问题，这是因为它通过随时间聚合围绕轴的旋转速率来计算当前姿态

# sybase - 在 WHERE 子句中进行条件与运算

> ID：10249149
> 
> 赞同：1
> 
> 时间：2012-04-20T15:33:12.320
> 
> 标签：sybase

我们可以在 WHERE 子句中对过程的参数之一添加空检查并避免代码块重复

```
select aa=t1.aa,bb=t2.bb ,cc=t3.cc
 from t1,t2,t3,t4,t5
where t1.p1=t2.p1
and t2.p2=t3.p2
 IF(procParameter IS NOT NULL)
   and t3.p2=procParameter 
and t4.p2=t5.p2
and t5.p3=t1.p2 
```

看我想要一个 AND 有条件地执行，否则它根本不应该被执行..!!!!

我应该如何进行这种优化？我不想要代码重复

```
IF(procParameter IS NOT NULL)
begin
  select aa=t1.aa,bb=t2.bb ,cc=t3.cc
    from t1,t2,t3,t4,t5
     where t1.p1=t2.p1
    and t2.p2=t3.p2
    and t3.p2=procParameter 
     and t4.p2=t5.p2
    and t5.p3=t1.p2 
end
Else
begin
  select aa=t1.aa,bb=t2.bb ,cc=t3.cc
    from t1,t2,t3,t4,t5
     where t1.p1=t2.p1
    and t2.p2=t3.p2
     and t4.p2=t5.p2
    and t5.p3=t1.p2 
end 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:36:03.410

这是一种方法：

```
AND (procParameter IS NULL OR t3.p2=procParameter) 
```

# iphone - Inmobi 定位 iphone,

> ID：10249151
> 
> 赞同：0
> 
> 时间：2012-04-20T15:33:22.750
> 
> 标签：iphone, ios, objective-c, ipad, inmobi

我有一个很大的问题，我在我的应用程序中集成了 inmobi，它不支持界面方向，但是当我按下广告时，视图加载在顶部并旋转，这还不错，但是当它旋转时，视图变得扭曲，没有覆盖全屏，也许有人遇到过类似的问题？我的代码：

```
- (void)showInMobiBanner
{
    if (_inMobView == nil)
    {
        _inMobView = [[IMAdView alloc] init];
        _inMobView.delegate    = self; //optional
        _inMobView.imAppId     = kInMobiAppId;
        _inMobView.imAdUnit    = IM_UNIT_320x50;
        _inMobView.autoresizingMask = UIViewAutoresizingFlexibleBottomMargin;
    }
    if (self.containerView != nil) 
    {
        _inMobView.rootViewController = self.containerView;
    }
    else
    {
        _inMobView.rootViewController = self.navigationController;
    }
        IMAdRequest *request = [IMAdRequest request];
        request.isLocationEnquiryAllowed = NO;

        _inMobView.frame = CGRectMake(0, 0, 320, 50);
        _inMobView.imAdRequest = request;
        [_inMobView loadIMAdRequest:request];
    [self.view addSubview:_inMobView];
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T06:27:39.170

看来您使用的是旧版本的 InMobi SDK(3.0.2)。

最近推出了一个更新的版本：http: [//developer.inmobi.com/wiki/index.php ?title=IOS_SDK_350](http://developer.inmobi.com/wiki/index.php?title=IOS_SDK_350)

引入了一种新方法：

```
- (BOOL)shouldRotateToInterfaceOrientation:(UIInterfaceOrientation)orientation; 
```

你可以在你的 UIViewController 中使用这个方法，并像这样处理方向变化：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return [imAdView shouldRotateToInterfaceOrientation:interfaceOrientation];
} 
```

希望这可以帮助！

# c# - 将 IsEnabled 属性绑定到 items.count

> ID：10249153
> 
> 赞同：1
> 
> 时间：2012-04-20T15:33:31.133
> 
> 标签：c#, .net, wpf, xaml, isenabled

我有以下树视图模板：

```
<TreeView x:Name="counterTree" ItemsSource="{Binding CounterCheckBoxList}" x:FieldModifier="private">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
            <StackPanel Orientation="Horizontal" Name="counterTreePanel">
                <CheckBox Background="LightBlue" 
                         IsChecked="{Binding IsChecked}" Checked="CounterTreeCheckBoxChecked" Unchecked="CounterTreeCheckBoxUnchecked"
                                                  VerticalAlignment="Center" Tag="{Binding Id}" />

                <Label Content="{Binding Name }" 
                       Tag="{Binding ParentId}"
                       Name="counterLabel" 
                       Padding="1,1,1,1" />
            </StackPanel>
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>

    <TreeView.ItemContainerStyle>
        <Style TargetType="TreeViewItem">
            <Setter Property="IsExpanded" Value="False" />
            <Setter Property="KeyboardNavigation.AcceptsReturn" Value="True" />
        </Style>
   </TreeView.ItemContainerStyle>
</TreeView> 
```

的是。`ItemsSource`_`TreeView``List<CounterCheckBox>`

CounterCheckBox 类的属性为：public List Children。

我的要求是，如果此列表为空，则“CheckBox”不可见，并且有子项，则 Checkbox 应该可见。如何将列表的计数绑定到 Checkbox 的 Visiblity 属性。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-20T11:01:43.300

您必须使用[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter%28v=vs.95%29.aspx)。

# wpf - 将 WPF 自定义控件批量添加到 ListBox 而不冻结 UI

> ID：10249158
> 
> 赞同：0
> 
> 时间：2012-04-20T15:34:03.147
> 
> 标签：wpf, multithreading, listbox, backgroundworker

我制作了一个自定义控件，由一些网格、堆栈面板和文本块组成。我想将其用作 ListBox 项。我正在使用它在列表的每个项目中显示多行信息，就像它在图像中显示的那样。该控件的名称是 ItemDetail。

![列表框的自定义控件](../Images/5453fcb9a4a3892d4e7bfed972f28bbd.png)

为了填写列表，我单击上面的每个按钮，这些按钮会进行 SQL 查询（查询有时可能需要大约 5 秒，并且用户界面已冻结，这一点非常明显）。

为了解决这个问题，我使用 BackgroundWorker 进行 SQL 查询，并在每次返回查询的结果行时报告进度。

```
private void Departamento_Click(object sender, MouseButtonEventArgs e)
    {
        Elementos_Lista.Items.Clear();
        BackgroundWorker _worker = new BackgroundWorker();
        _worker.WorkerReportsProgress = true;
        _worker.ProgressChanged += new ProgressChangedEventHandler(_worker_ProgressChanged);

        _worker.DoWork += delegate(object s, DoWorkEventArgs args)
        {
           //SQL query
           reglas.Consulta("cerrado='0' and grupo='3' order by fecha desc");   

            foreach (DataRow dr in reglas.Entidad.tabla.Rows)
            {
                _worker.ReportProgress(0, dr);
            }

        };
        _worker.RunWorkerAsync();
    } 
```

我正在使用 BackgroundWorker 的 IsProgressChanged 事件将数据添加到 ItemDetail 的实例，然后将其添加到 ListBox。

```
 void _worker_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        ItemDetail item = new ItemDetail((DataRow)e.UserState);
        Elementos_Lista.Items.Add(item);
    } 
```

这样，操作花费的时间少了很多，但它仍然冻结，这是由于在返回查询的每一行后必须进行 UI 刷新。BackgroundWorker 不允许我在单独的线程中将数据添加到 ItemDetail 控件，因为它不是 UI 线程。

有没有一种方法可以加快一次渲染大量控件的过程，或者将它们以较小的批次添加到列表中，这样 UI 在完成填充列表之前似乎不会完全没有响应？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:37:38.900

只需将数据添加到[`ObservableCollection`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)应该绑定到您的列表控件并让它通过[数据模板](http://msdn.microsoft.com/en-us/library/ms742521.aspx)生成控件，如果您有虚拟化，则不会立即创建不必要的控件（滚动出视图的控件），这应该会使操作更快.

# php - php Memcached 连接超时

> ID：10249160
> 
> 赞同：1
> 
> 时间：2012-04-20T15:34:09.173
> 
> 标签：php, amazon-web-services, memcached, amazon-elasticache

k，所以我在以下方面遇到了一些麻烦

```
$this->cacheServers = array(
     array('test.com', 11211)
);

$this->memcache = new \Memcached();
$this->memcache->setOption( \Memcached::OPT_COMPRESSION, TRUE );
$this->memcache->setOption( \Memcached::OPT_LIBKETAMA_COMPATIBLE, TRUE );
$this->memcache->setOption( \Memcached::OPT_CACHE_LOOKUPS, TRUE );
$this->memcache->setOption( \Memcached::OPT_CONNECT_TIMEOUT, 50 );
$this->memcache->setOption( \Memcached::OPT_POLL_TIMEOUT, 50 );
$this->memcache->setOption( \Memcached::OPT_RECV_TIMEOUT, 10000 );
$this->memcache->setOption( \Memcached::OPT_SEND_TIMEOUT, 10000 );

$this->memcache->setOption( \Memcached::OPT_SERVER_FAILURE_LIMIT, 1 );
$this->memcache->setOption( \Memcached::OPT_RETRY_TIMEOUT, 50 );

$this->memcache->setOption( \Memcached::OPT_NO_BLOCK, TRUE );
$this->memcache->setOption( \Memcached::OPT_TCP_NODELAY, true );
$this->_data['connected'] = $this->memcache->addServers($this->cacheServers); 
```

所以，我试图让它超时，但它只是挂起

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T20:48:54.930

实现了我自己的 telnet 测试`fsockopen`和一秒超时。

再次回答我自己的问题

# ruby - ruby 中的布尔逻辑'true and false == true'

> ID：10249164
> 
> 赞同：1
> 
> 时间：2012-04-20T15:34:38.777
> 
> 标签：ruby, boolean-logic

```
> test = false and true
=> false
> test
=> false
> test = true and false #this is the point I don't understand!
=> false
> test
=> true 
```

为什么 ruby​​ 会以这种方式运行，我该如何正确使用它才不会遇到这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T15:37:16.523

优先权。 `test = true and false`这意味着：

```
(test = true) and false 
```

不是这个：

```
test = (true and false) 
```

如果您希望分配排在最后，请使用上述括号，或者`&&`代替：`and`

```
test = true && false 
```

# qml - 保存qml QVariantList的格式是什么 在 qml 文件中，以便在加载文件时可以在 qml 中绑定？

> ID：10249165
> 
> 赞同：2
> 
> 时间：2012-04-20T15:34:39.413
> 
> 标签：qml, qvariant

我正在做一个应用程序，我需要将 QVariantList 列表保存在 qml 文件中，以便每次启动应用程序时都可以将其加载到 qml 中

为了更清楚，我从 qml 读取 qpoints 并将它们存储在 c++ 中的 qvariantlist 中，因此下一步是将其保存在文本文件中，我使用格式（这就是我将其写入 file.qml 的方式）

```
import ARHandbook 1.0;
x:["1 2" , "1 3"] 
```

但它不会在 qml 中加载，那么存储它的正确格式是什么？它使此错误无法使 qvariantlist 无效

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T04:27:45.450

对于 QtQuick 1.x，您应该使用属性变体类型，从 QtQuick 2.0 开始，您可以只使用属性 var 来存储数组类型。

有关详细信息，请参阅 [http://doc-snapshot.qt-project.org/5.0/qml-var.html](http://doc-snapshot.qt-project.org/5.0/qml-var.html)和 [http://qt-project.org/doc/qt-4.8/qml-variant.html](http://qt-project.org/doc/qt-4.8/qml-variant.html)。

# c++ - libcurl 首选的构建方法

> ID：10249167
> 
> 赞同：0
> 
> 时间：2012-04-20T15:34:57.997
> 
> 标签：c++, c, curl, libcurl, winapi

我正在构建 libcurl 以与我正在处理的项目一起使用，在阅读了一些关于如何正确构建它的信息后，我发现了两种方法。

方法一：（
编辑根目录下的Makefile，将“VC=vc6”改为“VC=vc10”）
`C:\dev\curl-7.25.0>set ZLIB_PATH=C:\dev\zlib-1.2.6`
`C:\dev\curl-7.25.0>nmake vc-zlib`

方法 2：（
将 zlib 的必要文件放在 ../deps 并编辑 Makefile 以使 USE_IDN=no 实际工作）
`C:\dev\curl-7.25.0\winbuild>nmake /f Makefile.vc mode=static VC=10 WITH_ZLIB=sta tic DEBUG=no USE_IDN=no WITH_DEVEL=../deps`

两者都可以正常工作。

可怕的是，输出的 libcurl.lib 文件大小不同。那么是否有任何 libcurl 大师可以告诉我这两种构建方法之间的区别，以及推荐使用哪一种？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:19:34.527

因此，到目前为止，我发现方法 1 要求您将应用程序与`Ws2_32.lib`and链接`Wldap32.lib`，而方法 2 则不需要（可能是额外大小的原因）。

方法 1 的输出可执行文件也稍小一些。

我真的很好奇是否还有其他差异。

# iphone - iOS < 5 无法加载推特框架

> ID：10249170
> 
> 赞同：5
> 
> 时间：2012-04-20T15:35:05.003
> 
> 标签：iphone, objective-c, ios, twitter

我正在使用[此处](https://stackoverflow.com/questions/10007218/detect-ios-version-for-twitter)的说明来检测 iOS 5 设备上的 Twitter 框架。问题是旧设备没有 Twitter 库，所以我在 iOS 4 上收到以下错误：

```
dyld: Library not loaded: /System/Library/Frameworks/Twitter.framework/Twitter 
```

如何制作一个可以在 iOS 5 上使用 Twitter 框架并在 iOS 4 及更低版本上使用不同 API 的应用程序？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T15:38:27.723

你需要“弱链接”它。在“Build Phases”->“Link Binary With Libraries”下，为 Twitter 框架选择“Optional”：

[弱链接 Twitter.framework http://www.hypercrypt.net/images/SO10249170.png](http://www.hypercrypt.net/images/SO10249170.png)

# wcf - 需要将消息推送到客户端的 WCF 服务

> ID：10249172
> 
> 赞同：4
> 
> 时间：2012-04-20T15:35:10.920
> 
> 标签：wcf, publish-subscribe

这就是我需要的设计：[我的设计理念](http://s18.postimage.org/5o9bwg13r/Design_Idea.png)。

![在此处输入图像描述](../Images/dd46550ab71382a797c02bfbf4ccc43c.png)

对于服务的“橙色”部分，“订阅者”设计是一个好主意吗？

客户端需要连接到服务来执行“读取”和“写入”操作，并且他们还需要从服务获取通知（以 PUSH 方式）。

一开始我以为提供“读取”和“写入”功能的服务也可以发送通知（通过后台线程），但后来我明白“回调”仅在服务需要调用时使用在客户端上*作为对客户端请求的响应*。含义 - 服务**无法发起对客户端的调用**。那么“订阅者”设计是解决这个问题的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:00:51.033

所以简短的回答是肯定的——使用发布/订阅模式是众所周知的模型。它有助于将消费者与发布者分离。魔鬼在实现细节以及您可以处理多少复杂性以及您愿意在设计中交易什么。

如果您愿意接受它的权衡（必须是 WCF 客户端，您拥有客户端和服务）和限制（客户端直接耦合，网络拓扑限制），您可以从 WCF[双工通道实现开始。](http://msdn.microsoft.com/en-us/library/ms752254.aspx)

如果您不喜欢双工通道的限制，那么您可以考虑使用 MSMQ 或[NServiceBus 之](http://particular.net/nservicebus)类的东西来满足发布/订阅要求。[您可以使用Windows Azure AppFabric 服务总线](http://msdn.microsoft.com/en-us/library/windowsazure/ee732537.aspx)将其提升到一个新的水平。

Duplex 可以独立地向客户端发送消息，而不仅仅是在来自客户端的呼叫到达时。

双工不耐用——当客户端离开或出现任何通信问题时，您必须从通道故障中恢复。保护双工可能很棘手。您必须在双方都有 WCF 客户端/服务。您必须了解您的网络拓扑。

您有 2 个不同的绑定上下文（系统）。一种是让客户端发送命令和查询，另一种是向想要收听这些事件的人发布有趣的事件。

编辑 - 如果某些客户端是 iOS 设备怎么办？使用 DUPLEX 会造成问题吗？你能开发一个通过 DUPLEX 通道与 WCF 服务通信的 iOS 应用程序吗？

答：在 iPhone 上看到这个 SO [WCF 双工连接了吗？](https://stackoverflow.com/questions/3595675/wcf-duplex-connection-on-iphone)以及[在开发可互操作的 WCF Web 服务时我应该知道什么？](https://stackoverflow.com/questions/3525097/what-should-i-know-when-developing-interoperable-wcf-web-service)

# ant - 将 svnant 与 ant 1.6 和 svnclient1.7 集成

> ID：10249173
> 
> 赞同：0
> 
> 时间：2012-04-20T15:35:11.977
> 
> 标签：ant, tortoisesvn, svnant

svnant 1.3 版本是否与我的 svnclient 1.7 版本兼容？

我需要将 svnclient 与我的 ant 脚本集成以获取最新的资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T09:24:46.670

svnant 1.4 现在支持 subversion 1.7，但是需要自己构建。看到[这个答案](https://stackoverflow.com/a/13174056/1303568)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T13:02:19.487

最新的 svnant[版本](http://subclipse.tigris.org/svnant.html)是 1.3.1，适用于 Subversion 1.6。看起来短期内不会有新版本。

您需要更新 svnClientAdapter.jar 和 svnjavahl.jar 以使 svnant 与 1.7 一起使用。

# java - Opengl ES 缩放（缩小）在我的纹理上显示了罕见的方形图块。如何避免？

> ID：10249176
> 
> 赞同：0
> 
> 时间：2012-04-20T15:35:23.040
> 
> 标签：java, android, opengl-es

我正在显示一个带有纹理的 OPENGL ES 1.X 正方形，用户可以放大和缩小正方形。

当用户缩小正方形时（正方形在屏幕上变小），正方形的纹理会出现罕见的半透明正方形，例如来自 googlemaps 的图块。

我认为 OpenGL 的缩放功能现在以更好的方式工作。

我该如何改进它？

这些是我的 OpenGL GLSurfaceView 主要功能：

```
 public void onSurfaceCreated(GL10 gl, EGLConfig config) {
        gl.glDisable(GL10.GL_DITHER);               //dithering OFF
        gl.glEnable(GL10.GL_TEXTURE_2D);            //Texture Mapping ON
        gl.glShadeModel(GL10.GL_SMOOTH);            //Smooth Shading 
        gl.glClearDepthf(1.0f);                     //Depth Buffer Setup
        gl.glEnable(GL10.GL_DEPTH_TEST);            //Depth Testing ON
        gl.glDepthFunc(GL10.GL_LEQUAL);
        gl.glClearColor(0,0,0,0);                   //fondo transparente
        gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_NICEST);         

        //Cargamos la textura del cubo.     
        for (int i=0;i<squares.size();i++){         
            if (squares.get(i)!=null)
                squares.get(i).loadGLTexture(gl, context);
        }
    }

public void onDrawFrame(GL10 gl) {  
        //Limpiamos pantalla y Depth Buffer
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
        gl.glLoadIdentity();

        mg.getCurrentProjection(gl); //volvemos a generar las matrices por que es un bucle
        mg.getCurrentModelView(gl); 
.
.
.
.
        gl.glTranslatef(X, Y, Z); //Move z units into the screen        
        gl.glRotatef(zrot, 0.0f, 0.0f, 1.0f); //Z               
        gl.glScalef(scale, scale, 1.0f);

        for (int i=0;i<squares.size();i++){
            if (squares.get(i)!=null)
                squares.get(i).draw(gl); //Draw the Cube        
        }
    }

public void onSurfaceChanged(GL10 gl, int width, int height) {
        if(height == 0) {                       //Prevent A Divide By Zero By
            height = 1;                         //Making Height Equal One
        }

        gl.glViewport(0, 0, width, height);     //Reset The Current Viewport
        gl.glMatrixMode(GL10.GL_PROJECTION);    //Select The Projection Matrix
        gl.glLoadIdentity();                    //Reset The Projection Matrix

        //Calculate The Aspect Ratio Of The Window
        GLU.gluPerspective(gl, 45.0f, (float)width / (float)height, 0.1f, 100.0f);

        gl.glMatrixMode(GL10.GL_MODELVIEW);     //Select The Modelview Matrix
        gl.glLoadIdentity();                    //Reset The Modelview Matrix        
    } 
```

这些是我的方形多边形类的主要功能：

```
public void draw(GL10 gl) {         
    gl.glFrontFace(GL10.GL_CCW);
    //Bind our only previously generated texture in this case       
    gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);      
    //Point to our vertex buffer
    gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);
    gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, textureBuffer);
    //Enable vertex buffer
    gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    //Draw the vertices as triangle strip
    gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, vertices.length / 3);
    //Disable the client state before leaving
    gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
}

//Carga de texturas
public void loadGLTexture(GL10 gl, Context context) {       
    //Generamos un puntero de texturas
    gl.glDeleteTextures(1, textures, 0); //libero memoria
    gl.glGenTextures(1, textures, 0);       
    //y se lo asignamos a nuestro array
    gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);
    //Creamos filtros de texturas
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);
    //Diferentes parametros de textura posibles GL10.GL_CLAMP_TO_EDGE
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_REPEAT);
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_REPEAT);     

    //Usamos Android GLUtils para espcificar una textura de 2 dimensiones para nuestro bitmap
    GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0); 

    //Checkeamos si el GL context es versión 1.1 y generamos los Mipmaps por Flag. Si no, llamamos a nuestra propia implementación
    if(gl instanceof GL11) {
        gl.glTexParameterf(GL11.GL_TEXTURE_2D, GL11.GL_GENERATE_MIPMAP, GL11.GL_TRUE);
        GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);
    } else {
        buildMipmap(gl, bitmap);
    }   
    //Limpiamos los bitmaps
    bitmap.recycle();       
    bitmap=null;
    System.gc();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T10:18:06.093

解决了：

```
 //Creamos filtros de texturas
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NICEST);
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_NICEST); 
    //Diferentes parametros de textura posibles GL10.GL_CLAMP_TO_EDGE
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_NICEST);
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_NICEST); 
```

# python - 如何分割图像

> ID：10249184
> 
> 赞同：0
> 
> 时间：2012-04-20T15:35:44.283
> 
> 标签：python

我有一个格式如下的图像数据：

`200406011215.goes12ir`

```
print im.format, im.size, im.mode 
```

`MCIDAS (1732, 2600) L`

这些图像由具有相应亮度值的线条和元素组成`( 0 -255)`。我正在尝试制作一个针对具有某些属性的区域的脚本。

**脚本：**

```
import Image
im = Image.open("/home/mcidas/Documents/datos/200404031215.goes12ir")
im.show() 
```

如何定位显示图像的亮度值为 的区域`> 205`？

任何人都知道我如何识别并在符合指定值的图像区域上绘制标记（可能是圆形））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:15:50.227

您可以使用`numpy`' 广播过滤掉高于阈值的像素。如果您事先模糊图像，这会更好。下面给出了一个完整的工作示例（没有模糊），只需适应您的需要：

```
import numpy as np
from pylab import *

# Generate random data with a "bright spot"
N = 100
line = np.linspace(-3,3,N)
X, Y = meshgrid(line,line)
Z  = np.exp(-((X+1)**2+(Y-1)**2)) 
Z += np.random.random(Z.shape)*.5

subplot(121)
imshow(Z,cmap=gray(), origin="lower", extent=[-3,3,-3,3])

Z2 = Z.copy()
# Identify regions that are brighter than threshold on z_scale
threshold = .8
idx = Z2>threshold

Z2[~idx] = None
Z2[idx ] = 1

subplot(122)
imshow(Z2,cmap=gray(), origin="lower", extent=[-3,3,-3,3])

# Place a dot at the "center" of the pixels found
CM = [X[idx].mean(), Y[idx].mean()]
scatter(*CM, s=100,color='red')

show() 
```

![在此处输入图像描述](../Images/a4ab11ea8eba5a53b8a9bb7f42ebcc13.png)

# javascript - 检测 DOM 对象是否可以放置在 SPAN 中

> ID：10249190
> 
> 赞同：4
> 
> 时间：2012-04-20T15:36:01.277
> 
> 标签：javascript, html, dom

我将任意网页的部分（“从字符 X 到字符 Y”）包装在具有以下约束的 SPAN 中：

1.  我不想破坏任何 DOM 标准（例如，我不想将 DIV 包装在 SPAN 中）。
2.  我想尽量减少创建的 SPAN 的数量（所以仅仅转到可能的最低子级别是不够的）。

在修改 DOM 之前，我需要知道给定对象是否可以合法地包含在 SPAN 中。

**例如...**

```
if(child instanceof Text) {
 // Wrap in a SPAN!
}
else {
 // Move along
} 
```

特别是，我需要反映有效 SPAN 内容的 JavaScript 类列表、可能能够提供帮助的方法（jQuery 或 vanilla JS），或者可以实现类似目标的其他解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:39:01.333

`span`唯一允许phrasing [*-content*](http://developers.whatwg.org/content-models.html#phrasing-content)。我建议建立一个包含构成*短语内容*集合的所有元素的小表格并对此进行测试。

这不是一个完美的解决方案，因为一些段落内元素，如`a`标签也可以包含非短语内容。您可能需要递归地评估元素的内容，确保它们在它们自身中不包含任何内容，然后才允许将它们包装在`span`标签中。

# svn - 如何将新代码推送到 *nix Web 服务器？

> ID：10249194
> 
> 赞同：0
> 
> 时间：2012-04-20T15:36:06.393
> 
> 标签：svn, ssh, webserver

我是 Web 服务器的新手，我想知道将新代码从开发机器推送到在云中运行的生产服务器的最佳方法是什么。

我不认为将 zipfile 下载和解压缩到网络主机是更新代码的最佳方式。我认为 SVN 也可以做到这一点，但它是遵循的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:08:19.723

无论目标环境如何，您通常都会尽量减少可能在途中中断的事情的数量，并且基于这种考虑，两个自然的领导者将是：

*   “scp -p tarball.tar.gz /path_to & tar xzf tarball.tar.gz”
*   “rsync -ac /path_from to:/path_to”

两者都带有后续的 md5 检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:09:30.963

我认为这个问题在服务器故障上可能会更好，但无论如何。

1.  网络服务器上的 svn checkout - cron 或触发更新
2.  rsync 从本地结帐复制到网络服务器。
3.  自动化（ssh 密钥等），将 tarfile 复制到网络服务器。

# android - 具有不同大小图像的 ImageView 选择器

> ID：10249203
> 
> 赞同：2
> 
> 时间：2012-04-20T15:36:40.987
> 
> 标签：android, android-widget

我正在尝试解决以下问题：我必须图像，一个用于正常状态，另一个用于“活动”模式，它与正常类似，只是它在边缘上方发光。活动状态图像大于正常图像，因此活动区域保持不变。

那么问题是如何让 ImageView 用选择器调整它的大小呢？目前，它会选择较大图像的尺寸并将另一张图像拉伸到完整尺寸。

谢谢，安东

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T07:16:52.233

为什么不在较小的图像周围添加一个透明边距，使其实际上与另一张相同？

# c# - 按名字和姓氏搜索用户登录 ID

> ID：10249205
> 
> 赞同：10
> 
> 时间：2012-04-20T15:36:43.227
> 
> 标签：c#, c#-4.0

我发现[如何从活动目录中获取用户列表？](https://stackoverflow.com/questions/5162897/how-can-i-get-a-list-of-users-from-active-directory)

当我只有几个用户时很有帮助，但我在 AD 中有这么多用户，所以当我运行查询时

```
if ((String)(entry.Properties["sn"].Value) == "lname"
     && (String)(entry.Properties["givenName"].Value) == "fname")
{
    return entry.Properties["samAccountName"].Value.ToString();
} 
```

完成时间太长了。

如何按名字和姓氏搜索一个特定的用户登录 ID？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T15:53:08.437

由于您使用的是 .NET 4，因此您应该查看`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

基本上，您可以定义域上下文并在 AD 中轻松找到用户和/或组：

```
// set up domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// find a user - by e.g. his "samAccountName", or the Windows user name or something
UserPrincipal user = UserPrincipal.FindByIdentity(ctx, "SomeUserName");

if(user != null)
{
   // do something here....     
   string samAccountName = user.SamAccountName;
} 
```

如果找不到用户名指定的用户，还可以使用新的搜索功能：

```
// define a "query-by-example" principal - here, we search for a UserPrincipal 
// and with the first name (GivenName) and a last name (Surname) 
UserPrincipal qbeUser = new UserPrincipal(ctx);
qbeUser.GivenName = firstName;
qbeUser.Surname = lastName;

// create your principal searcher passing in the QBE principal    
PrincipalSearcher srch = new PrincipalSearcher(qbeUser);

// find all matches
foreach(var found in srch.FindAll())
{
    // do whatever here - "found" is of type "Principal" - it could be user, group, computer.....          
} 
```

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！并且仅仅找到一个用户也应该相对较快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T16:03:04.180

您应该使用 AD 服务器进行过滤。通过提供 LDAP 语法过滤器来做到这一点。此外，使用以下`propertiesToLoad`参数仅指定您需要的属性`FindAll`：

```
 public static SearchResultCollection FindByName(
        string domain, string firstName, string lastName, string[] properties) {
        var rootEntry = new DirectoryEntry("LDAP://" + domain);
        var filter = string.Format("(&(sn={0})(givenName={1}))", lastName, firstName);
        var searcher = new DirectorySearcher(rootEntry, filter, properties);
        return searcher.FindAll();
    }

    // Using the method:
    var result = FindByName("mydomain", "Robert", "Smith", new[] { "samAccountName" })[0];
    string uName = (string)result.Properties["samAccountName"][0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:42:30.860

您需要将[QueryFilter](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.principalsearcher.queryfilter.aspx)属性设置为`searcher`，然后调用`searcher.FindOne()`而不是`searcher.FindAll()`。查询过滤器可以设置为[UserPrincipal](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.userprincipal.aspx)对象，您可以在其中设置要搜索的字段。

[Microsoft 在Query By Example](http://msdn.microsoft.com/en-us/library/bb384378.aspx)页面上有一个很好的例子，尽管他们的例子希望找到几个匹配给定条件的对象。

链接问题对您的要求的特别字面调整将是

```
using (var context = new PrincipalContext(ContextType.Domain, "mydomain.com"))
{
    using (var searcher = new PrincipalSearcher(new UserPrincipal(context) { GivenName = "fname", Surname = "lname" }))
    {
            foreach (var result in searcher.FindAll())
            {
                DirectoryEntry de = result.GetUnderlyingObject() as DirectoryEntry;
                return de.Properties["samAccountName"].Value.ToString();
            }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T15:43:50.977

如果`entry`是`IEnumerable`集合的一部分，您可以执行以下操作：

```
var entries = {do your population of the collection here}

var entry = entries.Where(e=>e.Properties["sn"].Value.ToString() == "lname"
    && e=>.Properties["givenName"].Value.ToString() == "fname")
    .FirstOrDefault(); 
```

# c++ - 使用 RapidXML 解析 Xml 文件时出错

> ID：10249206
> 
> 赞同：0
> 
> 时间：2012-04-20T15:36:52.480
> 
> 标签：c++, rapidxml

当我尝试解析包含特定日文汉字的 xml 文件时出现“parse_error”：

退

如果我将此汉字更改为另一个汉字，则解析效果很好。

任何想法？

PS：我用 rapidXML 解析文件

这是 xml 文件的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<Root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Exam.xsd">
    <Patient>
     <ESUID>CRodrigueTest-20120423-104410</ESUID>
     <Lastname>退</Lastname>
    </Patient>
</Root> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-19T08:32:18.617

这里实际上问题不在于rapidXML 库。问题可能出在 basic_ifstream.basic_ifstream 上，默认情况下仅以 ansi 模式打开文件。所以我们必须将其设置为 utf-8。使用下面的代码片段：

```
 basic_ifstream<wchar_t> fFileStream(fullxmlfilepath, ios::binary);

    std::locale loc(std::locale::classic(), new std::codecvt_utf8<wchar_t>);
    fFileStream.imbue(loc);  

    xmlFile = new rapidxml::file<wchar_t>(fFileStream);
    doc.parse<parse_declaration_node>(xmlFile ->data()); 
```

# android - 为什么我不能在我的程序中读取 logcat 输出？

> ID：10249207
> 
> 赞同：0
> 
> 时间：2012-04-20T15:36:59.997
> 
> 标签：android, logcat, android-logcat

我已经搜索过，我发现以下代码可以让我的程序读取 android 中 logcat 的输出。但是，在我定期调用这个函数之后，什么也没有发生。除了“调用的 logcat”之外，没有任何东西通过 system.out 输出。我真的不知道发生了什么，因为这里的很多帖子都说这会起作用：<

```
public void  Collector_logcat(){

    String stringbuffer="";
    String command="logcat -d";
    String command_c="logcat -c";
     System.out.println("logcat called\n"); 
    try{
        m_logcatprocess=Runtime.getRuntime().exec(command);
        m_logcat_inputreader=new InputStreamReader(m_logcatprocess.getInputStream());
        m_logcat_reader=new BufferedReader(m_logcat_inputreader);
      while((stringbuffer=m_logcat_reader.readLine())!=null){
          System.out.println(stringbuffer+"\n");  
      }

      Runtime.getRuntime().exec(command_c);

    }

        catch(Exception ex){
            System.out.println(ex.getMessage());
            System.out.println("error in Collector_logcat\n");
        }

     return ;

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:09:04.280

试试这个：

**AndroidManifest.xml**

```
<uses-permission android:name="android.permission.READ_LOGS" /> 
```

获取目录：

```
try {  
    ArrayList<String> commandLine = new ArrayList<String>();  
commandLine.add("logcat");  
    commandLine.add( "-d");  
    commandLine.add( "-v");  
    commandLine.add( "time");  
    commandLine.add( "-s");  
    commandLine.add( "tag:W");  
    Process process = Runtime.getRuntime().exec(commandLine.toArray(new String[commandLine.size()]));  
    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream()), 1024);  
    String line;  
    while ((line = bufferedReader.readLine()) != null) {  
        log.append(line);  
        log.append("\n")  
    }  
} catch (IOException e) {  
} 
```

你会得到如下输出：

*09-08 09:44:42.267 带标签（754）：message1
09-08 09:44:42.709 带标签（754）：
message2 09-08 09:44:43.187 带标签（754）：message3
09- 08 09:44:45.295 E/标签（754）：message8*

# java - 使用归并排序算法所需的最小比较次数？

> ID：10249208
> 
> 赞同：1
> 
> 时间：2012-04-20T15:37:04.027
> 
> 标签：java, complexity-theory

对于那些熟悉合并排序的人，我试图找出合并两个大小为 n/2 的子数组所需的最小比较次数，其中 n 是原始未排序数组中的项目数。

我知道算法的平均和最坏情况时间复杂度为 O(nlogn)，但我无法确定所需的确切**最小**比较次数（以 n 为单位）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T15:42:58.257

合并步骤的最小比较次数大约是`n/2`（顺便说一句，仍然是`O(n)`），假设一旦完全遍历了列表之一，就会进行合理的实现。

例如，如果正在合并两个实际上已经排序的列表，则将较大列表的第一个成员`n/2`与较小列表的第一个成员进行多次比较，直到用完为止；然后可以复制较大的列表而无需进一步比较。

```
List 1    List 2    Merged List         Last Comparison
[1, 2, 3] [4, 5, 6] []                  N/A
[2, 3]    [4, 5, 6] [1]                 1 < 4
[3]       [4, 5, 6] [1, 2]              2 < 4
[]        [4, 5, 6] [1, 2, 3]           3 < 4
[]        [5, 6]    [1, 2, 3, 4]        N/A
[]        [6]       [1, 2, 3, 4, 5]     N/A
[]        []        [1, 2, 3, 4, 5, 6]  N/A 
```

请注意，进行了 3 次比较，列表中有 6 个成员。

`O(n)`再次注意，即使在最好的情况下，仍然有效地考虑合并步骤。合并排序算法具有时间复杂度`O(n*lg(n))`，因为合并步骤`O(n)`跨越整个列表，并且划分/合并发生`O(lg(n))`在递归级别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-10T13:37:26.613

This answer gives an exact result, not only the asymptotic behaviour written using some [Landau symbol](http://en.wikipedia.org/wiki/Landau_symbol).

Merging lists of lengths *m* and *n* takes at least min(*m*, *n*) comparisons. The reason is that you can stop comparing elements only when one of the input lists has been completely processed, i.e. you'll need to iterate over at least the smaller of the two lists. Note that this number of comparisons will only be sufficient for *some* inputs, so it is minimal in the sense that it assumes the best case of possible input data. For worst case input, you will find higher numbers, namely [*n ⌈lg n⌉ − 2⌈lg n⌉ + 1*](https://stackoverflow.com/a/12346159/1468366).

Let *n* = 2^(*k*) be a power of two. Let *i* be a merge level, with 0 ≤ *i* < *k*. At level *i* you execute 2^(*k* − *i* − 1) merges, each of which requires 2^(*i*) comparisons. Multiplying these two numbers gives you 2^(*k* − 1) comparisons, which is equal to *n*/2\. Summing over the *k* levels of merges you get *nk*/2 = (*n* lg *n*)/2 comparisons.

Now let *n* be 1 less than a power of two. Let *k* = ⌈lg *n*⌉ still denote the number of merge levels. Compared to the 2^k case, you now have one less comparison at each level. So the total number of merges reduces by *k*, resulting in 2^(*k*)*k*/2 − *k* = (2^(*k*)/2 − 1)*k* comparisons. However, if you remove one more element, leading to *n* = 2^(*k*) − 2, then you won't reduce the number of topmost merges, since the other list already is the shorter one. Which suggests that things might become more difficult around here.

So let's have a little demo program, which we can use both to check our previous result and to compute the number of comparisons for other values:

```
mc = [0, 0]                                 # dynamic programming, cache previous results
k = 1                                       # ceil(lg n) in the loop
for n in range(2, 128):
    a = n // 2                              # split list near center
    b = n - a                               # compute length of other half list
    mc.append(mc[a] + mc[b] + min(a, b))    # need to sort these and then merge
    if (n & (n - 1)) == 0:                  # if n is a power of two
        assert mc[-1] == n*k/2              # check previous result
        k += 1                              # increment k = ceil(lg n)
print(', '.join(str(m) for m in mc))        # print sequence of comparison counts, starting at n = 0 
```

This gives you the following sequence:

```
0, 0, 1, 2, 4, 5, 7, 9, 12, 13, 15, 17, 20, 22, 25, 28, 32, 33, 35,
37, 40, 42, 45, 48, 52, 54, 57, 60, 64, 67, 71, 75, 80, 81, 83, 85,
88, 90, 93, 96, 100, 102, 105, 108, 112, 115, 119, 123, 128, 130, 133,
136, 140, 143, 147, 151, 156, 159, 163, 167, 172, 176, 181, 186, 192,
193, 195, 197, 200, 202, 205, 208, 212, 214, 217, 220, 224, 227, 231,
235, 240, 242, 245, 248, 252, 255, 259, 263, 268, 271, 275, 279, 284,
288, 293, 298, 304, 306, 309, 312, 316, 319, 323, 327, 332, 335, 339,
343, 348, 352, 357, 362, 368, 371, 375, 379, 384, 388, 393, 398, 404,
408, 413, 418, 424, 429, 435, 441 
```

which you can look up in the [On-Line Encyclopedia of Integer Sequences](http://oeis.org/) to find that this sequence describes the [total number of 1's in binary expansions of 0, ..., n](https://oeis.org/A000788). There are some formulas there as well, but either they are inexact (involve some Landau symbol term), or they rely on some other non-trivial sequence, or they are pretty complex. The one I like most expresses just what my program above did:

> a(0) = 0, a(2n) = a(n)+a(n-1)+n, a(2n+1) = 2a(n)+n+1\. - Ralf Stephan, Sep 13 2003

Given these alternatives I guess I'd stick with the above script to compute these numbers. You can remove the assertion and everything related to this, rely on the fact that `a < b`, and drop the output as well if you include this into a larger program. The result should look like this:

```
mc = [0, 0]
for n in range(2, 1024):
    a = n // 2
    mc.append(mc[a] + mc[n - a] + a) 
```

Notice that e.g. for *n* = 3 you get only two comparisons. Clearly this can only work if you compare both extremal elements to the median one, so that you don't have to compare the extremal ones to one another any more. This illustrates why the above computation only works for best case input. Worst case input would have you computing minimal and maximal element with one another at some point, leading to three comparisons as computed by that [*n ⌈lg n⌉ − 2⌈lg n⌉ + 1*](https://stackoverflow.com/a/12346159/1468366) formula.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-20T15:54:06.867

对于每次比较，您从两个列表之一中排出一个元素。所以比较的次数最多是两个列表的长度之和。如图`Platinum`所示，如果您到达一个数组的末尾而另一个数组中仍有项目，则它可能会更少。

所以比较次数在`n/2`和之间`n`。

# jquery - jQuery 日期函数在 IE 中返回 NaN

> ID：10249209
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:05.807
> 
> 标签：jquery, internet-explorer, date, time

我有这个 twitter 功能与发布推文的日期建立链接。它适用于 Firefox、Chrome 和 Safari。IE 虽然在几天前产生了 NaN 或 NaN。进入函数的日期格式如下：Fri Apr 10:19:06 +0000 2012。有人有什么想法吗？

```
 html += '<a target="_blank" href="http://twitter.com/' + username + '#status_' + data[i].id_str + '">' + data[i].text + ' <i>' + Twitter.daysAgo(data[i].created_at) + '</i></a>';

            daysAgo: function (date) {

            var d = new Date(date).getTime();
            var n = new Date().getTime();

            var numDays = Math.round(Math.abs(n - d) / (1000 * 60 * 60 * 24));
            var daysAgo = numDays + ' days ago';

            if (numDays == 0) {
                alert('Works 1');
                daysAgo = 'today';
            } else if (numDays == 1) {
                alert('Works 2');
                daysAgo = numDays + ' day ago';
            }

            return daysAgo; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T09:28:38.517

`data[i].created_at`返回一个 IE 无法解析为日期的字符串。尝试将其格式化为 ISO 8601 日期字符串：

```
>> new Date("2012-01-01T00:00+01:00") 
Sun Jan 1 00:00:00 UTC+0100 2012 
```

[注意： Internet Explorer 8 标准模式和 Quirks 模式不支持](http://msdn.microsoft.com/en-us/library/ie/ff743760%28v=vs.94%29.aspx)ISO 日期格式。

您的字符串似乎缺少日期编号或`:`太多：`Fri Apr 10:19:06 +0000 2012`

# c++ - 无法在 Mac 上构建谷歌协议缓冲区教程

> ID：10249210
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:07.880
> 
> 标签：c++, macos, protocol-buffers

我正在尝试在 Mac 上构建 c++ 教程示例，但到目前为止没有成功。教程在这里。. . .

[https://developers.google.com/protocol-buffers/docs/cpptutorial](https://developers.google.com/protocol-buffers/docs/cpptutorial)

由于没有 pkg​​-confic 命令，我无法使用 makefile 来构建示例。我收到以下错误。.

```
pkg-config --cflags protobuf  # fails if protobuf is not installed
/bin/sh: pkg-config: command not found
make: *** [add_person_cpp] Error 127 
```

我可以使用以下方法构建编译器和库

```
./configure --prefix=/usr
make
make check
make install 
```

我可以使用 protoc 编译教程中包含的 proto 文件，但由于某种原因我无法链接可执行文件。我得到以下内容。. .

```
$ g++ add_person.cc addressbook.pb.cc -L /usr/lib/ -l libprotobuf.a  -o write
ld: library not found for -llibprotobuf.a 
```

...但是该库肯定在 /usr/lib 中。我可能在这里犯了一个非常基本的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:07:41.590

链接标志应该是

```
-lprotobuf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-13T08:50:16.707

@Learvst 像你一样我没有在我的 Mac 上安装 pkg-config 请参阅下面的我的 MAC 版本

```
$sw_vers 
```

```
产品名称：Mac OS X
产品版本
离子：10.9.4
构建版本：13E28

```

所以我做了以下

A.获取protobuf库位置

`abd@harvey-specter$ otool -L $(which protoc)`

```
/usr/local/bin/协议：
    /usr/local/lib/libprotobuf.8.dylib（兼容版本 9.0.0，当前版本 9.0.0）
    /usr/local/lib/libprotoc.8.dylib（兼容版本 9.0.0，当前版本 9.0.0）
    /usr/lib/libz.1.dylib（兼容版本 1.0.0，当前版本 1.2.5）
    /usr/lib/libc++.1.dylib（兼容版本 1.0.0，当前版本 120.0.0）
    /usr/lib/libSystem.B.dylib（兼容版本 1.0.0，当前版本 1197.1.1）

```

这表明 protoc 编译器使用库“libprotobuf.8.dylib”

B. 然后我编译

`abd@harvey-specter$ c++ add_person.cc addressbook.pb.cc -o add_person_cpp -L/usr/local/lib -lprotobuf.8`

C. 瞧，我已经准备好使用我的程序“add_person_cpp”了

`abd@harvey-specter$ c./add_person_cpp`

```
用法：./add_person_cpp ADDRESS_BOOK_FILE
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-06T04:44:01.453

仅供参考，在 Mac OS 上使用 3.5.0。

我在 Makefile 中为 protobuf 3.5.0 更改了行。cpp编译。

首先，让我说我在这台机器上没有 sudo 权限，无法在“通常”的地方进行安装，所以它在 ~/local/lib,bin,include 中。

```
 add_person_cpp: add_person.cc protoc_middleman
         #pkg-config --cflags protobuf  # fails if protobuf is not installed
         c++ add_person.cc addressbook.pb.cc -o add_person_cpp -lprotobuf -L~/local/lib -I~/local/include #`pkg-config --cflags --libs protobuf`

    list_people_cpp: list_people.cc protoc_middleman
         #pkg-config --cflags protobuf  # fails if protobuf is not installed
         c++ list_people.cc addressbook.pb.cc -o list_people_cpp -lprotobuf -L~/local/lib -I~/local/include #`pkg-config --cflags --libs protobuf` 
```

[我把〜（波浪号）放在那里，但在我的实际Makefile中我放了完整路径......只是有点混淆了。]

Java 编译像宣传的那样工作。

我不能做 python，因为获取 pip 或运行 easy_install 需要 sudo。

# apache - 如何将域重定向到不同域托管的子文件夹以读取 .htaccess？

> ID：10249212
> 
> 赞同：1
> 
> 时间：2012-04-20T15:37:10.567
> 
> 标签：apache, .htaccess, dns

这是场景：

我有 DomainA 和 DomainB。DomainA 没有托管，DomainB 有托管。

我想将 DomainA 定向到 .htaccess 文件所在的 DomainB 托管的子文件夹。这个 .htaccess 文件包含一组 DomainA 的 301 重定向规则。

这可能吗？这是否会成功地保持 DomainA 的 301 重定向规则到位？

编辑：DomainA 的重定向规则将 URL 从 DomainA 重定向到 DomainB 上的 url。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:40:34.363

使 DomainB 上的网站响应对 DomainA 的请求。然后

```
RewriteEngine on
RewriteCond %{HTTP_HOST} DomainA
RewriteRule (.*) DomainB/$1 [R=301,L] 
```

我不确定查询字符串是否保留在重定向中，但这可以修复。

# php - 在jquery中传递变量

> ID：10249215
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:17.320
> 
> 标签：php, jquery

我有下面的代码，我有第一个表，我通过 while 循环获取它的数据。我在这个表中有一行是“更多详细信息”，每行按钮都是“详细信息”。我已经尝试过这段 jquery 代码，但它只适用于第一个按钮，假设我在表中有 10 行当然有 10 个按钮，所以只有第一个按钮有效并显示“table2”，但其他按钮不起作用。我认为也许我可以将一个变量传递给 jquery，该变量确定用户单击了哪个按钮以显示与此按钮相关的 table2。我用谷歌搜索了这个，但谷歌让我失望了，没有结果。任何帮助将不胜感激。

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
    <?php 
        $sql3= mysql_query("SELECT * FROM data  ");
        while($row3 =mysql_fetch_array($sql3)){
    ?>
<script>

$(document).ready(function() {
    $('#showr').click(function(){
        $('#Table2').show();
    });
});
</script>

    <table width='100%' border='1' cellspacing='0' cellpadding='0'>
        <th>Weeks</th>
        <th>date</th>
        <th>place</th>
        <th>More Details</th>
        <tr>
<?php 
        echo "<tr ><td style= 'text-align : center ;'>my rows1</td>" ;
        echo "<td style= 'text-align : center ;'>myrows2</td>";
        echo "<td  style= 'text-align : center ;'> myrows3</td>";
        echo "<td style= 'text-align : center ;'><button id='showr'>More Details</button></td></tr>";
}
?>
</tr>
</table><br />

<div id= "Table2" style= "display:none;">
    <table width='100%' border='1' cellspacing='0' cellpadding='0'>
        <th>try</th>
        <th>try2</th>
        <tr>
            <td>try3</td>
            <td>trs</td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:45:29.693

如果您想让每个按钮显示不同的表格，我会使用 ids 在按钮和表格之间创建关系。我假设您在表中使用了自动递增的主键；如果没有，您可以在循环中放置一个计数器并将其用作 id。

下面省略了很多输出有效表格的代码。

```
<?php
while($row3 = mysql_fetch_array($sql3)){
//output your normal table rows

//presuming a numeric primary key to use as id
echo "<td><button id='showr_" . $row3['primaryKey'] . "' class='showr'>Show Details</button></td>";

}
?>

<?php
//reset mysql data set so we can loop through it again to output the second tables
mysql_data_seek($sql3, 0);
while($row3 = mysql_fetch_array($sql3)){
//output hidden table
echo "<table style='display: none' class='table2' id='table2_" . $row3['primaryKey'] . "'>";
//output rest of rows here...
echo "</table>";
?> 
```

Javascript 将看到一个按钮被点击，获取该按钮的 id，并显示相关表格，同时隐藏当前可能显示的任何表格。

```
<script type='text/javascript'>
$(document).ready(function() {
    $('.showr').click(function(){
        //get id by splitting on the underscore within the 'id' attribute
        //$(this) refers to the button that has been clicked
        var id = $(this).attr('id').split('_')[1];

        //hide all table2's and then show the one we want
        $('.table2').hide();
        $('#Table2_' + id).show();
    });
});
</script> 
```

# mysql - 将两个表组合在一起，以便一个表中的所有行都与另一个表中的每一行匹配

> ID：10249217
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:25.207
> 
> 标签：mysql, join

这个问题对我来说有点难以表述，但我想我已经想出了一个可以让这个想法得到理解的例子。

我有三张表bird_brd、state_stt 和bird_in_state_bis

前两个表只是列表，第三个表是一种将其他两个连接在一起的方法，并且有一个计数字段，用于表示在某个州看到鸟的次数。

我不认为表格的结构很重要，但这里是基础知识

```
bird_brd
=====================
| id_brd | name_brd |
=====================
|    1   | Blue Jay |
|    2   |  Robbin  |
=====================

state_stt
=====================
| id_stt | name_stt |
=====================
|   1    |   Utah   |
|   2    |  Arizona |
|   3    |  Wyoming |
=====================

bird_in_state_bis
=======================================
| stt_id_bis | brd_id_bis | count_bis |
=======================================
|     1      |      1     |     5     |
|     2      |      2     |     3     |
======================================= 
```

我想要做的是组合这些表，以便如果在 bird_in_state 表中有一个状态条目，它将显示所有鸟类的计数，无论它们是否在 bird_in_state 表中。

所以当我运行查询时，我希望得到如下结果

```
==================================
| State Name | Bird Name | Count |
==================================
|    Utah    | Blue Jay  |   5   |
|    Utah    |  Robbin   |   0   |
|   Arizona  | Blue Jay  |   0   |
|   Arizona  |  Robbin   |   3   |
================================== 
```

请注意，这是我正在尝试为工作做的事情，上面的表格不是我正在使用的实际表格，但它们是我必须使用的结构的一个很好的例子。

我尝试使用某种左连接或右连接，但我没有得到我想要的东西。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:40:29.677

我想这就是你要找的。

```
SELECT 
  Bird.Name, 
  State.Name, 
  IFNULL(BirdsInState.Count, 0) AS Count 
FROM (SELECT State AS StateID,ID AS BirdID FROM (SELECT DISTINCT(State) AS State FROM BirdsInState) AS UniqStates, Bird) BirdStates 
LEFT JOIN Bird ON BirdStates.BirdID = Bird.ID 
LEFT JOIN State ON BirdStates.StateID = State.ID 
LEFT JOIN BirdsInState ON BirdID = BirdsInState.Bird 
  AND StateID = BirdsInState.State; 
```

它首先在所有使用的州和所有可用的鸟类中进行笛卡尔连接，以获得所有可能的组合。然后它连接回原来的三个表以获取鸟类的名称、状态和计数。在这样的连接中，如果不可用，计数将为空，因此我们使用该`IFNULL`函数将所有空值转换为 0。

我在哪里使用这些表：

```
mysql> SHOW CREATE TABLE State;
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                   |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| State | CREATE TABLE `State` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `Name` varchar(63) DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1 |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SHOW CREATE TABLE Bird;
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                  |
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Bird  | CREATE TABLE `Bird` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `Name` varchar(63) DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 |
+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SHOW CREATE TABLE BirdsInState;
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table        | Create Table                                                                                                                                                                                                                                |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| BirdsInState | CREATE TABLE `BirdsInState` (
  `Bird` int(11) NOT NULL DEFAULT '0',
  `State` int(11) NOT NULL DEFAULT '0',
  `Count` int(11) DEFAULT NULL,
  PRIMARY KEY (`Bird`,`State`),
  KEY `State` (`State`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec) 
```

# jquery - JQuery Plugin - 对两个列表之间的嵌套列表进行排序

> ID：10249218
> 
> 赞同：6
> 
> 时间：2012-04-20T15:37:26.747
> 
> 标签：jquery, drag-and-drop, nested-lists

所以，我需要在两个嵌套列表之间拖放。这是一种组合：http: [//jqueryui.com/demos/sortable/#connect-lists](http://jqueryui.com/demos/sortable/#connect-lists)

这个： http: [//mjsarfatti.com/sandbox/nestedSortable/](http://mjsarfatti.com/sandbox/nestedSortable/)

有什么东西已经这样做了，还是我应该尝试同时使用它们，不知何故？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T14:58:47.017

您可以只`connectWith`在插件上使用 jQuery UI 的选项`nestedSortable`，因为后者只是默认 jQuery UI 可排序的扩展。

演示：http: [//jsfiddle.net/jhogervorst/Ge7eK/9/](http://jsfiddle.net/jhogervorst/Ge7eK/9/)

**JavaScript 代码：**

```
$('ol.sortable').nestedSortable({
    /* … Options for nestedSortable … */
    connectWith: '.sortable'
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:51:52.233

jquery ui 解决方案可以处理嵌套列表：http: [//jsfiddle.net/wyV7f/3/](http://jsfiddle.net/wyV7f/3/)

如果你需要更多的东西，也许你可以破解它？

# php - PHP：从递归函数返回多维数组

> ID：10249219
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:30.097
> 
> 标签：php, arrays, recursion

好的，我不明白为什么这不起作用，也许你们中的一位可以帮助我。

```
$new_upline = RetrieveUpline($root_referral_id, array());
echo ("The upline after return: <BR>");
var_dump ($new_upline);

function RetrieveUpline($root_ref_id, $upline){
    $referrer = mysql_query("SELECT id, username, referral_ID, total_points_earned,   isbanned FROM members WHERE id = ".$root_ref_id);
    $rows = mysql_num_rows($referrer);
    $upline_size = count($upline);

    if ($rows>0){
        while($feed = mysql_fetch_array($referrer, MYSQL_ASSOC)){
            $upline[$upline_size] = $feed;
            RetrieveUpline($upline[$upline_size]['referral_ID'], $upline);
        }
    }else{
        echo ("The upline before return: <BR>");
        var_dump($upline);
        return $upline;
    }
} 
```

函数内部的 var_dump 按预期工作。即使我将其设置为原始文本，返回也不会返回任何内容。我知道这可能很容易，但我现在已经筋疲力尽了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:46:36.910

试试这个版本：

```
<?php

  function RetrieveUpline($root_ref_id, $upline = array()) {

    // Sanitize input
    $root_ref_id = (int) $root_ref_id;

    // Do query
    $query = "
      SELECT id, username, referral_ID, total_points_earned, isbanned
      FROM members
      WHERE id = $root_ref_id
    ";
    $result = mysql_query($query); // What if this query fails? Add error handling here...

    // Loop results
    while ($feed = mysql_fetch_assoc($result)) {
      $upline[] = $feed;
      $upline = RetrieveUpline($feed['referral_ID'], $upline);
    }

    // Free mysql result resource
    mysql_free_result($result);

    // Return new array
    return $upline;

  }

  $new_upline = RetrieveUpline($root_referral_id);
  var_dump($new_upline); 
```

您需要`$upline`通过引用传递参数，或者从任一选项返回结果 - 无论是否有结果。我会选择返回每个结果选项，因为这意味着您不需要在调用函数之前初始化结果数组。这种方法的缺点是它会消耗更多的内存，所以你可以使用这个版本：

```
<?php

  function RetrieveUpline($root_ref_id, &$upline) {

    // Make sure $upline is an array (for first iteration)
    if (!is_array($upline)) $upline = array();

    // Sanitize input
    $root_ref_id = (int) $root_ref_id;

    // Do query
    $query = "
      SELECT id, username, referral_ID, total_points_earned, isbanned
      FROM members
      WHERE id = $root_ref_id
    ";
    $result = mysql_query($query); // What if this query fails? Add error handling here...

    // Loop results
    while ($feed = mysql_fetch_assoc($result)) {
      $upline[] = $feed;
      RetrieveUpline($feed['referral_ID'], $upline);
    }

    // Free mysql result resource
    mysql_free_result($result);

  }

  RetrieveUpline($root_referral_id, $new_upline);
  var_dump($new_upline); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:09:55.537

我知道这不是问题，但也许您应该阅读有关获取“分层数据”并使用它的内容。你现在这样做的方式非常……嗯，让我说，“慢”。

*   [关于它的文章 sitepoint](http://www.sitepoint.com/hierarchical-data-database/)
*   [维基百科上的树遍历](http://en.wikipedia.org/wiki/Tree_traversal)

# ruby-on-rails - 命名 Rails has_many :through :polymorphic 关系

> ID：10249220
> 
> 赞同：8
> 
> 时间：2012-04-20T15:37:32.293
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我在设置 Rails has_many :through :polymorphic 关系时遇到了一些问题。

我知道这个主题在 SO 上有[很好的](https://stackoverflow.com/questions/4641500/rails-polymorphic-has-many-through) [记录](https://stackoverflow.com/questions/1683265/activerecord-has-many-through-and-polymorphic-associations)，但我认为我的问题在于我的模型和 foreign_key 名称而不是语法，即我认为这是一个“我一直在看代码太久”的问题，只需要另一个组的眼睛。

无论如何，我有以下设置：

```
class Milestone < ActiveRecord::Base
  has_many :responsible_items, :as => :responsibility
  has_many :responsible, :through => :responsible_items
end

class ResponsibleItem < ActiveRecord::Base
  belongs_to :responsible, :class_name => "User"
  belongs_to :responsibility, :polymorphic => true
end

class User < ActiveRecord::Base
  has_many :responsible_items, :foreign_key => :responsible_id
  has_many :responsibilities, :through => :responsible_items
end 
```

从里程碑的角度来看，这似乎工作正常，没有错误。例如在终端我可以写：

```
Milestone.first.responsible 
```

......并得到一个空集合，正如我所期望的那样。

但是，从用户方面来说，运行：

```
User.first.responsibilities 
```

…正在返回一个 AR 错误：

```
ActiveRecord::HasManyThroughAssociationPolymorphicSourceError: Cannot have a has_many :through association 'User#responsibilities' on the polymorphic object 'Responsibility#responsibility'. 
```

我假设这个问题与我将用户关系称为：responsible 的事实有关。这是正确的吗？

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T16:21:57.503

多亏了@Abid 的评论，我开始考虑`responsibilities`为用户提供所有服务的后勤工作，这是不可行的。我需要更具体地说明我想要从关系中得到什么，结果定义以下工作：

```
class User < ActiveRecord::Base
  has_many :responsible_items, :foreign_key => :responsible_id
  has_many :milestone_responsibilities, :through => :responsible_items, :source => :responsibility, :source_type => 'Milestone'
end 
```

然后我可以扩展它，因为我在其他模型上添加更多的多态关系，例如：

```
class User < ActiveRecord::Base
  has_many :responsible_items, :foreign_key => :responsible_id
  has_many :milestone_responsibilities, :through => :responsible_items, :source => :responsibility, :source_type => 'Milestone'
  has_many :task_responsibilities, :through => :responsible_items, :source => :responsibility, :source_type => 'Task'
end 
```

# sql-server-2008 - Reporting Services ExecutionLog：在 timestart 和 timeend 之间发生了什么

> ID：10249224
> 
> 赞同：0
> 
> 时间：2012-04-20T15:37:42.100
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008

我一直在调查一份报告服务报告，该报告似乎在一夜之间从相当活泼变成相当缓慢。查看执行日志，并检查开始时间和结束时间之间的差异，我得到如下所示的内容：

*   第 1 天 = 900 毫秒
*   第 2 天 = 900 毫秒
*   第 3 天 = 2000 毫秒
*   第 4 天 = 4500 毫秒
*   第 5 天 = 4500 毫秒

该报告运行了一年多，其表现与几周前的第 1 天相似，现在我们一直处于这个更高的数字。通过我们通常用来获取渲染 PDF 的 web 服务调用以及通过 web UI 运行它，我们具有相同的性能。

在注意到性能变化的这段时间内，报告本身没有更改或重新部署。也没有对所涉及的服务器进行任何硬件更改。

查看日志详细信息，我很困惑这个额外的时间是从哪里来的。

*   TimeDataRetrieval 是稳定的 20 毫秒
*   TimeProcesing 大约为 50 毫秒
*   TimeRendering 稳定在 600 毫秒

所以所有这些应该构成大约 700 毫秒。TimeStart 和 TimeEnd 占什么以及这 3 个值？这似乎是我们的性能问题所在，但我不知道还发生了什么。

如果这可能会有所不同，我们正在 Windows Server 2003 SP 2 机器上使用报告服务 2008。

在此先感谢，韦斯

编辑[2012-04-30]：

我们还调查了我们的其他报告，发现它们同时受到了相同的性能影响，因此这似乎与报告本身无关。

我还让我们的网络管理员创建了一个带有报告服务的新 VM，向其部署了相同的报告，发现我们的时间回到了 900 毫秒以下，报告定义和数据源完全相同。我真的不想将所有指向旧报表服务器的项目迁移到新的，但看起来这至少可以暂时解决问题，直到这再次引起它的丑陋。

任何关于尝试途径的后续想法，即使它们只是猜测，将不胜感激。

再次感谢，韦斯

编辑[2012-05-12]：

我还确保我们的报表服务器和报表服务器临时数据库重建了它们的索引并更新了统计信息，如果我们从进行索引查找到表扫描或类似的东西，它可能会导致速度变慢董事会。这些选项都没有帮助。

我们现在已在新 VM 上重新部署了所有报告，并且运气好得多，尽管在此过程中还升级到了 2008 R2，这可能会提高性能。从用户的角度来看，问题已经解决了，但我仍然不知道减速是从哪里来的。

# haskell - 为什么这个函数组合是非法的

> ID：10249225
> 
> 赞同：2
> 
> 时间：2012-04-20T15:37:57.617
> 
> 标签：haskell, syntax

这有效：

```
c <- fmap lines (readFile "d:\\tmp\\h.txt")  
let h = map (read :: String -> Int) c 
```

而那些没有编译的那两条线的“叠加”

`fmap (read :: String -> Int) $ fmap lines (readFile "d:\\tmp\\h.txt")`

它会产生错误：

```
互动：1:36：
    无法将预期类型“Char”与实际类型“[Char]”匹配
    预期类型：字符串 -> 字符串
      实际类型：字符串 -> [字符串]
    在`fmap'的第一个参数中，即`lines'
    在 `($)' 的第二个参数中，即
      `fmap 行 (readFile "d:\\tmp\\h.txt")

```

为什么它不编译以及如何在一行中执行此操作？我想要的是实现python的简单性

```
[int(i) for i in open("d:\\tmp\\h.txt")] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T15:50:13.547

你离开`map`了你的“叠加”（组合）：

```
h <- fmap (map (read :: String -> Int)) $ fmap lines (readFile "d:\\tmp\\h.txt") 
```

您可以将其简化为

```
h <- fmap (map (read :: String -> Int) . lines) (readFile "d:\\tmp\\h.txt") 
```

如果您`import Control.Applicative`在源文件的顶部放置一行（或者`:m +Control.Applicative`如果您以交互方式使用 ghci，则输入），您可以使用`<$>`运算符而不是`fmap`让它看起来更清晰。（它们的作用完全相同，只是拼写不同。）

```
h <- map (read :: String -> Int) . lines <$> readFile "d:\\tmp\\h.txt" 
```

最后，如果您确实需要类型签名，您可能会发现它在行尾看起来更清晰。

```
h <- map read . lines <$> readFile "d:\\tmp\\h.txt" :: IO [Int] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-20T15:53:04.873

```
[int(i) for i in open("d:\\tmp\\h.txt")] 
```

将计算与动作分开：

```
return . map read . lines =<< readFile "d:\\tmp\\h.txt" 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-20T16:00:37.813

关于。你的第二个问题： using`Applicative`会使它更具可读性：

```
map read . lines <$> readFile "file" 
```

您可能能够避免给出`read`类型签名，具体取决于您的代码的其余部分，这将是可取的

# java - 计算Java项目中的比较次数

> ID：10249227
> 
> 赞同：0
> 
> 时间：2012-04-20T15:38:13.743
> 
> 标签：java, loops, for-loop, counting

关于如何计算我的“插入”“删除”“搜索”和“打印”功能中的比较，我希望得到一些输入。这个程序需要的是它可以将“学生”添加到列表中，从所述列表中删除它们，打印出列表以及其他功能。但是，它需要能够计算在插入、删除、搜索和打印时进行了多少次比较。我知道这需要一个 for 循环，但我不能完全正确。有什么建议吗？

以下是我的代码（请注意，它很大）：

```
import java.io.*;
import java.util.*;

import javax.swing.JOptionPane;

public class Assignment3{
static String students = ""; //Records of matching students
static int matches = 0; //Number of matching students
static Set <Student> names = new HashSet<Student>(); //HashSet to store Students

public static void main(String[] args) throws FileNotFoundException{ 

    int ID = 0;                 
    String lastName;        
    double GPA;             
    boolean run = true;

    while (run == true){
        String menu = JOptionPane.showInputDialog(null, "1) Loading students" +
                "\n2) Adding new student" +
                "\n3) Removing student " +
                "\n4) Searching students" +
                "\n5) Printing students " +
                "\n6) Quit");

        //Loading students from a text file
        if (menu.equals("1")){
            String inputFileName = JOptionPane.showInputDialog(null, "Input file:");
            File inputFile = new File(inputFileName);
            Scanner in = new Scanner(inputFile);

            while (in.hasNext()){ //Loading names from text file to array!
                ID = in.nextInt();
                lastName = in.next();
                GPA = in.nextDouble();
                Student student = new Student(ID,lastName,GPA);
                names.add(student);
            }
            in.close(); //Done loading from file, closing input!
        }

        //Adding more students to your list
        if (menu.equals("2")){
            String idString = JOptionPane.showInputDialog(null, "Please Enter an ID for student");
            ID = Integer.parseInt(idString);
            lastName = JOptionPane.showInputDialog(null, "Please enter a last name for student");
            String gpaString = JOptionPane.showInputDialog(null, "Please enter a GPA for student");
            GPA = Double.parseDouble(gpaString);
            Student student = new Student(ID,lastName,GPA);
            names.add(student);
        }

        //Remove student
        if (menu.equals("3")){
            String idString = JOptionPane.showInputDialog(null, "Please enter an ID for student to remove");
            deleteStudentByID(Integer.parseInt(idString),names);
        }

        //Search
        if (menu.equals("4")){
            String searchMenu = JOptionPane.showInputDialog(null, "1) Search by ID" +
                    "\n2) Search by name" +
                    "\n3) Search by GPA");

            if (searchMenu.equals("1")){

                int count = 0;
                for (int n=1; n<ID; n++)  
                    count++;   // insert a[n] into a[0..(n-1)]

                String idSearch = JOptionPane.showInputDialog(null, "Please enter ID number");
                JOptionPane.showMessageDialog(null, "Found " + (findStudentByID(Integer.parseInt(idSearch),names) +  " Student\n" + students));
                System.out.println("The number of comparisons is " + count );

            }
            if (searchMenu.equals("2")){
                String nameSearch = JOptionPane.showInputDialog(null, "Enter last name");
                JOptionPane.showMessageDialog(null, "Found: " + findStudentByName(nameSearch,names) + "\n" + matches + " student(s) with last name of " + nameSearch);
            }
            if (searchMenu.equals("3")){

                String gpaSearch = JOptionPane.showInputDialog(null, "Enter GPA");
                JOptionPane.showMessageDialog(null, "Found " + (findStudentByGPA(Double.parseDouble(gpaSearch),names) +  " Student(s)\n" + students));
            }
        }

        //Print
        if (menu.equals("5")){
            String printMenu = JOptionPane.showInputDialog(null, "1) Print to console" +
                    "\n2) Print to file");
            //Console
            if (printMenu.equals("1")){
                Iterator <Student> iter = names.iterator();
                while (iter.hasNext()){
                    Student tempStudent = iter.next();
                    System.out.println("ID: " + tempStudent.getID() + " Name: " + tempStudent.getName() + " GPA: " + tempStudent.getGPA() + " Hash Code: " + tempStudent.hashCode());    
                }
                JOptionPane.showMessageDialog(null,"Output to console complete");
            }
            //Text file
            if (printMenu.equals("2")){
                String outputFileName = JOptionPane.showInputDialog(null, "Output file:");
                PrintWriter out = new PrintWriter(outputFileName);
                Iterator <Student> iter = names.iterator();
                while (iter.hasNext()){
                    Student tempStudent = iter.next();
                    out.println("ID: " + tempStudent.getID() + " Name: " + tempStudent.getName() + " GPA: " + tempStudent.getGPA() + " Hash Code: " + tempStudent.hashCode());    
                }
                out.close(); //Done writing to file, close output
                JOptionPane.showMessageDialog(null,"Output saved to " + outputFileName);
            }
        }

        //Quit
        if (menu.equals("6")){
            System.exit(0);
        }
    }
}

//Delete a student
static void deleteStudentByID(int id, Set <Student> list){ 
    matches = 0;
    students = "";
    Iterator<Student> iterator = names.iterator();
    while (iterator.hasNext()) {
        Student student = iterator.next();
        if (student.getIDHash() == Integer.toString(id).hashCode()){
            matches++;
            students = "ID: " + student.getID() + " Name: " + student.getName() + " GPA: " + student.getGPA() + "\n";
            list.remove(student);
            JOptionPane.showMessageDialog(null, "Deleted " + matches +  " Student\n" + students);
            break;
        }   
    }

    if (matches == 0){
        JOptionPane.showMessageDialog(null,"Student not found");
    }
}
//Search by ID
static int findStudentByID(int id,Set <Student> list){
    matches = 0;
    students = "";
    for (Student student : list){
        if (student.getIDHash() == Integer.toString(id).hashCode()){
            matches++;
            students = "ID: " + student.getID() + " Name: " + student.getName() + " GPA: " + student.getGPA() + "\n";
        }
    }
    return matches; 
}
//Search by name
static String findStudentByName(String name,Set <Student> list){
    matches = 0;
    students = "";
    for (Student student : list) {
        if (student.getNameHash() == name.hashCode()){
            matches++;
        }
    }
    if (matches > 0){ 
        return "YES";
    }
    return "NO";
}
//Search by GPA
static double findStudentByGPA(double gpa,Set <Student> list){
    matches = 0;
    students = "";
    for (Student student : list){
        if (student.getGPAHash() == Double.toString(gpa).hashCode()){
            matches++;
            students += "ID: " + student.getID() + " Name: " + student.getName() + " GPA: " + student.getGPA() + "\n";
        }
    }
    return matches; 
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:44:18.777

我建议将[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)模式与[Abstract Method](http://en.wikipedia.org/wiki/Factory_method_pattern)结合使用。

换句话说，您的示例根本不是面向对象的。您在进行函数式编程，这就是为什么这种计数将意味着严重的代码重复（在许多地方您将不得不这样做`count++`）。介绍`Comparison`类和一系列`AbstractComparison`实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T15:39:44.267

只要有一个计数器变量，说：

```
int count; 
```

并在程序每次进行比较时增加它。

# ios5 - iOS Mobile Safari 上的部分背景

> ID：10249229
> 
> 赞同：0
> 
> 时间：2012-04-20T15:38:14.527
> 
> 标签：ios5, css, mobile-safari

看看下面的截图。我的 ID 为 #top 的 div 仅覆盖 iOS 上屏幕的一部分，而在我的计算机上它是全宽的。全宽是预期的行为。

[您可以在https://resipsalaw.com](https://resipsalaw.com)上实时查看源代码

关于为什么会发生这种情况的任何想法？

![部分宽度背景](../Images/8d6114168414a2008091eedae737bd3e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:56:05.177

找到了解决方案：

```
body {
  width:100%;
  min-width: 1060px;
} 
```

# assembly - 内存到内存 MOV - 正确的语法

> ID：10249234
> 
> 赞同：1
> 
> 时间：2012-04-20T15:38:32.397
> 
> 标签：assembly, x86, mov

我正在尝试使用 ASM 完成以下任务：

`mov [00A30020], [ebx+50]`

所以，我想把00A30020`mov`的值`ebx+50`改成 00A30020，但是编译器说这是一个无效的语句。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T16:00:55.903

没有*内存*到*内存*移动这样的东西（使用`mov`，也有移动字符串）。见此[表](http://siyobik.info.gf/main/reference/instruction/MOV#instructionEncodingsTable)。

您可以加载到临时寄存器然后存储它：

```
mov   eax, [ebx+50]
mov   [00A30020], eax 
```

或以低效为代价避免使用任何额外的寄存器：

```
push  dword [ebx+50]
pop   dword [00A30020] 
```

# c - 记下从页面错误陷阱修改的页面

> ID：10249235
> 
> 赞同：2
> 
> 时间：2012-04-20T15:38:36.647
> 
> 标签：c, linux, x86-64

我有一个应用程序，它会定期检查点（每 1 或 2 秒）。检查点是使用`fork`. 出于某种原因，我还需要记下自上次检查点以来已修改的页面。我想到的最有效的方法是，每当由于 fork 中使用的写时复制机制而出现页面错误时，我们都可以记下页面，其中最初（在 fork 之后）相同的物理页面被映射到原始进程和分叉进程，但是当原始进程尝试写入页面时，会为该页面地址映射一个新的物理页面。

我想，我需要在内核中进行修改才能做到这一点，或者这可以通过使用一些信号处理程序在用户空间中完成吗？此时我正在做的是让应用程序使用的所有页面在获取检查点后只读，并在写入页面时使用信号处理程序捕获错误以记下它们的地址。但是，与写时复制时记下页面相比，这是低效的。我怎样才能做到这一点。我需要修改内核的哪一部分？有人可以提供我需要修改的那部分代码的链接吗？如果这可以在用户空间中以相同或几乎相同的效率完成，有人可以建议我吗？

# interop - C++/CLI 菜鸟：System.AccessViolationException

> ID：10249237
> 
> 赞同：2
> 
> 时间：2012-04-20T15:38:41.157
> 
> 标签：interop, c++-cli, native, access-violation

我正在尝试为我女儿的 jr. 的职业日准备一个“很酷的演示”。5 天内很高，所以我正在尝试使用[echoprint 库](https://github.com/echonest/echoprint-codegen)来执行无线 (OTA) 音频识别。我从来没有真正比 C++ 中的“hello world”走得更远，我正在尝试使用 C++/CLI 来包装 echoprint codegen 库，以便我可以从 C# 调用它。这是我的头文件：

```
// echoprint-cli.h

#pragma once

#include "Codegen.h";

using namespace System;

namespace echoprintcli {

    public ref class CodegenCLI
    {
    public:
        String^ getCodeString(array<float>^ buffer, unsigned int samples, int start_offset);
    };
} 
```

这是我的实现：

```
#include "stdafx.h"
#include <msclr\marshal_cppstd.h>
#include "echoprint-cli.h"

using namespace System;
using namespace System::Runtime::InteropServices;
using namespace msclr::interop;

namespace echoprintcli {
    String^ CodegenCLI::getCodeString(array<float>^ buffer, unsigned int samples, int start_offset){
        String^ result = String::Empty;

        if(buffer->Length > 0){
            GCHandle h = GCHandle::Alloc(buffer, System::Runtime::InteropServices::GCHandleType::Pinned);

            try{
                float* pcm = (float*)(void*)h.AddrOfPinnedObject();
                Codegen* codegen = new Codegen(pcm, samples, start_offset); //System.AccessViolationException here
                std::string code;
                try{
                    code = codegen->getCodeString();
                }finally{
                    delete codegen;
                }
                result = marshal_as<String^>(code);
            }
            finally{
                h.Free();
            }
        }
        return result;
    }
} 
```

我正在使用 XNA 麦克风类来录制音频。它返回一个字节 [] 数组，因此我将字节转换为浮点数，然后通过我的包装器将其传递给 Codegen 类，如下所示（C#）：

```
 var mic = Microphone.Default;
        Log(String.Format("Using '{0}' as audio input...", mic.Name));
        var buffer = new byte[mic.GetSampleSizeInBytes(TimeSpan.FromSeconds(22))];

        int bytesRead = 0;
        string fileName = String.Empty;

        try
        {
            mic.Start();
            try
            {
                Log(String.Format("{0:HH:mm:ss} Start recording audio stream...", DateTime.Now));
                while (bytesRead < buffer.Length)
                {
                    Thread.Sleep(1000);
                    var bytes = mic.GetData(buffer, bytesRead, (buffer.Length - bytesRead));
                    Log(String.Format("{0:HH:mm:ss} Saving {1} bytes to stream...", DateTime.Now, bytes));
                    bytesRead += bytes;
                }
                Log(String.Format("{0:HH:mm:ss} Finished recording audio stream...", DateTime.Now));
            }
            finally
            {
                mic.Stop();
            }

            Func<byte, float> convert = (b) => System.Convert.ToSingle(b);
            var converter = new Converter<byte, float>(convert);
            float[] pcm = Array.ConvertAll<byte, float>(buffer, converter);

            Log(String.Format("{0:HH:mm:ss} Generating audio fingerprint...", DateTime.Now));
            var codeg = new CodegenCLI();
            String code = codeg.getCodeString(pcm, (uint)pcm.Length, 0); 
```

但是当我的 C++/CLI 方法 (getCodeString) 调用本机方法时，我得到了 Sysetem.AccessViolationException。

整个源代码在 github 上作为 VS 2010 SP1 或 VS 11 解决方案提供：[https ://github.com/developmentalmadness/echoprint-net/tree/3c48d3783136188bfa213d3e9fd1ebea0f151bed](https://github.com/developmentalmadness/echoprint-net/tree/3c48d3783136188bfa213d3e9fd1ebea0f151bed)

该 URL 应指向当前遇到问题的修订版。

**编辑** 我在这里尝试了这个建议：[AccessViolation，当从 C++/CLI 调用 C++-DLL 时](https://stackoverflow.com/questions/4396589/accessviolation-when-calling-c-dll-from-c-cli)

```
#include "stdafx.h"
#include <msclr\marshal_cppstd.h>
#include "echoprint-cli.h"

using namespace System;
using namespace System::Runtime::InteropServices;
using namespace msclr::interop;

namespace echoprintcli {
    String^ CodegenCLI::getCodeString(array<float>^ buffer, unsigned int samples, int start_offset){
        String^ result = String::Empty;

        IntPtr p = Marshal::AllocHGlobal(buffer->Length * sizeof(float));
        try{
            pin_ptr<float> pcm = static_cast<float*>(p.ToPointer());
            Codegen* codegen = new Codegen(pcm, samples, start_offset); // System.AccessViolationException here
            std::string code;
            try{
                code = codegen->getCodeString();
            }finally{
                delete codegen;
            }
            result = marshal_as<String^>(code);
        }
        finally{
            Marshal::FreeHGlobal(p);
        }
        return result;
    }
} 
```

而且我仍然遇到访问冲突，但是在调试器崩溃后将我放到本机代码中（我不知道自己如何到达那里）。它在ctor内部爆炸。指针 (pcm) 的地址值为 0.0000000，但除了在此处显示源代码之外，我不知道如何自己调试代码：

```
 Codegen::Codegen(const float* pcm, unsigned int numSamples, int start_offset) {
    if (Params::AudioStreamInput::MaxSamples < (uint)numSamples)
        throw std::runtime_error("File was too big\n");

    Whitening *pWhitening = new Whitening(pcm, numSamples); //System.AccessViolationException 
```

由于无法调试，我只能假设遵循堆栈两个步骤：

```
 Whitening::Whitening(const float* pSamples, uint numSamples) :
    _pSamples(pSamples), _NumSamples(numSamples) {
    Init();
} 
```

我想它会在某个地方的 Init() 方法中爆炸：

```
 void Whitening::Init() {
    int i;
    _p = 40;

    _R = (float *)malloc((_p+1)*sizeof(float));
    for (i = 0; i <= _p; ++i)  { _R[i] = 0.0; }
    _R[0] = 0.001;

    _Xo = (float *)malloc((_p+1)*sizeof(float));
    for (i = 0; i < _p; ++i)  { _Xo[i] = 0.0; }

    _ai = (float *)malloc((_p+1)*sizeof(float));
    _whitened = (float*) malloc(sizeof(float)*_NumSamples);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-16T18:59:34.650

正如 EchoNest 论坛上所承诺的，这是我的做法。如果您修改 codegen.dll 并提供合适的导出函数，您可以更轻松地使用 CLI。

在`main.cxx`codegen 中，添加以下方法：

```
extern "C" __declspec(dllexport) void GetCodeStringFromPcm(const float* pcm, uint numSamples, int start_offset, BSTR* sResultString)
{
  // pcm: a buffer of floats, mono, 11025 Hz
  Codegen * pCodegen = new Codegen(pcm, numSamples, start_offset);
  string code = pCodegen->getCodeString();

  // http://stackoverflow.com/questions/2573834/c-convert-string-or-char-to-wstring-or-wchar-t
  std::wstring ws(code.size(), L' '); // Overestimate number of code points.
  ws.resize(mbstowcs(&ws[0], code.c_str(), code.size())); // Shrink to fit.

  *sResultString = SysAllocStringLen(ws.data(), ws.size());
} 
```

现在在 C# 方面，您可以简单地执行以下操作：

```
/// <summary>
/// Generates audio fringerprint for usage with Echonest.
/// </summary>
/// <param name="pcm">const float*, 4 byte per float in C++</param>
[DllImport("codegen.dll")]
private static extern void GetCodeStringFromPcm(float[] pcm, uint numSamples, int start_offset, [MarshalAs(UnmanagedType.BStr)] ref string sResultString); 
```

现在你只需要这个特殊的浮点缓冲区作为第一个参数。您提到已经有一个，但是对于拥有另一种格式的音频数据的每个人来说，以下是一种将几乎任何音频文件转换为正确的浮点缓冲区的方法。要求是[BASS.NET 音频库](http://bass.radio42.com/)：

```
using BassLib = Un4seen.Bass.Bass;
using BassMix = Un4seen.Bass.AddOn.Mix.BassMix;

/// <summary>
/// Creates a fingerprint code for an audio track, using the codegen.dll.
/// </summary>
public string GetCodeStringFromFile(string fileName)
{
    // Read input stream
    int streamIn = BassLib.BASS_StreamCreateFile(fileName, 0, 0, Un4seen.Bass.BASSFlag.BASS_STREAM_DECODE);
    if (streamIn == 0) return null;

    // New mixer stream that allows us to read floating point samples. EchoNest requires mono data.
    int mixerStream = BassMix.BASS_Mixer_StreamCreate(targetSampleRate, 1, Un4seen.Bass.BASSFlag.BASS_STREAM_DECODE | Un4seen.Bass.BASSFlag.BASS_SAMPLE_FLOAT);
    BassMix.BASS_Mixer_StreamAddChannel(mixerStream, streamIn, Un4seen.Bass.BASSFlag.BASS_STREAM_DECODE | Un4seen.Bass.BASSFlag.BASS_MIXER_DOWNMIX);

    long bufferSizeInBytes = BassLib.BASS_ChannelSeconds2Bytes(mixerStream, 0.1f);
    double totalSeconds = BassLib.BASS_ChannelBytes2Seconds(streamIn, BassLib.BASS_ChannelGetLength(streamIn));

    // Use progress data in whatever way you need it.
    int progress = 0;
    List<float> resultData = new List<float>();

    while (true)
    {
        float[] data = new float[bufferSizeInBytes / 4];
        int readBytes = BassLib.BASS_ChannelGetData(mixerStream, data, (int)bufferSizeInBytes);
        if (readBytes <= 0) break;

        for (int i = 0; i < readBytes / 4; i++)
        {
            resultData.Add(data[i]);
        }

        double secondsPos = BassLib.BASS_ChannelBytes2Seconds(mixerStream, BassLib.BASS_ChannelGetPosition(mixerStream));
        progress = (int)(secondsPos / totalSeconds * 100);
    }

    BassLib.BASS_StreamFree(streamIn);
    BassLib.BASS_StreamFree(mixerStream);

    // We need to pass an array of samples to C.
    float[] resultArray = resultData.ToArray();

    // Clear list to prevent occupying too much memory.
    resultData.Clear();

    // Marshaller will pass float[] just fine to C.
    string resultCodegenData = string.Empty;
    GetCodeStringFromPcm(resultArray, (uint)resultArray.Length, 0, ref resultCodegenData);

    return resultCodegenData;
} 
```

# asp.net-mvc - 如何将带有内连接的 sql 查询转换为 linq lambda 表达式？

> ID：10249238
> 
> 赞同：0
> 
> 时间：2012-04-20T15:38:41.070
> 
> 标签：asp.net-mvc, linq

我想从一些表中选择一些字段请帮助将 sql 查询转换为 linq，我需要将这些值显示到 mvc3 webgrid 中。

如何将内部联接转换为 linq？或者有什么办法可以在EF中做到这一点？

```
SELECT
DISTINCT
    SecurityIdentifier_All.SecurityId,
    NAV.CompanyName,
    NAV.SecurityType,
    SecurityIdentifier_All.Identifier,
    SecurityIdentifier_All.SecurityIdentifierTypeId
FROM
    Fireball_Reporting..Reporting_DailyNAV_Pricing NAV
INNER JOIN
    Fireball_Reporting..SecurityIdentifier_All ON  
         SecurityIdentifier_All.SecurityId = NAV.PricingSecurityID
inner join  
    (
    SELECT  SecurityId, MAX(SecurityIdentifierTypeId) SecurityIdentifierTypeId
FROM    Fireball_Reporting..SecurityIdentifier_All
where  SecurityIdentifierTypeId in (1,16)
group by SecurityId
    ) IdentifierType on
    IdentifierType.SecurityId = SecurityIdentifier_All.SecurityId and
    IdentifierType .SecurityIdentifierTypeId = 

SecurityIdentifier_All.SecurityIdentifierTypeId
WHERE
    Date = Fireball_Configuration.dbo.PreviousBusinessDay() 
```

在上面`SecurityIdentifier_All`，`NAV`是一个视图。Fireball_Reporting 数据库名称。在答案中直到第一个内部连接完成。请帮我完成最后一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:57:38.720

我的原始答案满足了您问题的先前版本，其中包括一个只有两个连接的 SQL 查询。

既然您有三个 INNER JOINS，我不会尝试在一个 LINQ 查询中完成所有这些操作。你当然可以，但它的可读性不是很好（很像你的 SQL 版本）。

我会在单独的步骤中执行子查询。像这样的东西：

```
var identifierType = context.SecurityIdentifier_Alls
    .Where(si => si.SecurityIdentifierTypeId == 1 || si.SecurityIdentifierTypeId == 6)
    .GroupBy(si => si.SecurityId)
    .Select(g => new { SecurityId = g.Key, SecurityIdentifierTypeField = g.Max(si => si.SecurityIdentifierTypeId) });

var query = 
    (from nav in context.Reporting_DailyNAV_Pricings
     from si in context.SecurityIdentifier_Alls
     from idt in identifierTypes 
     where si.SecurityId = nav.PricingSecurityID
        && idt.SecurityId == si.SecurityId
     select new { si.SecurityId, nav.CompanyName, nav.SecurityType, si.Identifier, si.SecurityIdentifierTypeId })
     .Distinct(); 
```

我没有在 UDF 工作以获得前一个工作日。此外，这些都没有经过测试（当然），但这可能与您正在寻找的内容*接近。*

我不确定你有什么可用的。如果您使用设置了导航属性的 LINQ-to-Entities，则无需在上述代码的 where 子句中链接表。

# python - 当 sys.stdout.encoding 为 None 时我该怎么办？

> ID：10249240
> 
> 赞同：2
> 
> 时间：2012-04-20T15:38:46.240
> 
> 标签：python, character-encoding

我正在尝试以更用户友好和自动魔术的方式处理 Python 脚本中的不同编码（有 utf8 的 API）。它是一个跨平台的控制台脚本。

对于`stdout`我使用的打印`sys.stdout.encoding`，它似乎在打印到控制台时几乎总是做正确的事情。但是，当标准输出通过**管道传输**时，它变为`None`.

所以在那种情况下，我假设我正在管道到一个文件并使用`locale.getpreferredencoding()`但是：

*   我不确定这是打印到文件的正确编码，但它可以跨平台工作。
*   *管道到程序* 时这不起作用`|`。如果在这种情况下存在编码**的标准或预期行为**，我不知道如何检测到这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:06:54.800

如果它是无，只需将您的数据输出为`utf-8`，并记录它。如果碰巧有其他编码的用例，请通过命令行或其他方式将其作为一个选项。

# python - 如何在 django 框架之外使用 django 模型？

> ID：10249250
> 
> 赞同：0
> 
> 时间：2012-04-20T15:39:23.903
> 
> 标签：python, database, django

> **可能重复：**
> [仅使用 Django 的 DB 部分](https://stackoverflow.com/questions/579511/using-only-the-db-part-of-django)
> [使用 Django ORM 作为独立](https://stackoverflow.com/questions/937742/use-django-orm-as-standalone)

我发现 Django 模型很容易访问数据库，那么我如何在框架之外使用它呢？

# jquery - jQuery：关闭一个按钮，记住缓存中的那个动作

> ID：10249251
> 
> 赞同：2
> 
> 时间：2012-04-20T15:39:24.687
> 
> 标签：jquery

我正在尝试为以下机制找到解决方案：

我有一个底部播放器，它显示在所有页面上，角落有一个“x”关闭按钮。每当我点击“X”时，播放器就会关闭，但如果我刷新页面，它会再次显示，我需要再次点击“X”来隐藏它。

我可以存储该信息（例如，我已经单击“X”）并将其存储在缓存中吗？如何？

播放器的工作 jsFiddle：http: [//jsfiddle.net/Gj2Rx/](http://jsfiddle.net/Gj2Rx/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T15:41:06.637

使用饼干。 [这是一个体面的指南](http://techpatterns.com/downloads/javascript_cookies.php)。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T15:41:26.443

您最好的选择是使用 cookie，然后在显示播放器之前检查 cookie。

# php - Twitpic uplodAndPost

> ID：10249260
> 
> 赞同：1
> 
> 时间：2012-04-20T15:39:48.963
> 
> 标签：php, twitpic

当我尝试使用 php curl 在 twitpic 上上传图片时，图片不会上传，并且响应是最后一个带有手动上传图片数据的 json。

```
$access_token = $twitteroauth->getAccessToken($this->input->get('oauth_verifier'));
$post['consumer_token'] = "my_consumer_token";
$post['consumer_secret'] = "My_consumer_secret";
$post['oauth_token'] = $access_token['oauth_token'];
$post['oauth_secret'] = $access_token['oauth_token_secret'];
$post['key'] = "my_twitpic_api_key";
$post['message'] = "123";
$post['media'] = "@".$_SERVER['DOCUMENT_ROOT']."/upload/sharing/pic_1334141805.PNG";

$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, "http://api.twitpic.com/1/uploadAndPost.json");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FAILONERROR, false);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post);

$result = curl_exec($ch);
if(!$result){
    $result = curl_error($ch);
}
curl_close($ch); 
```

# python - 用 VLC 播放视频文件，然后退出 VLC

> ID：10249261
> 
> 赞同：19
> 
> 时间：2012-04-20T15:40:03.183
> 
> 标签：python, windows, vlc, subprocess

我正在编写一个简单的 Python 脚本，它应该做一些事情，然后播放视频文件，然后做更多的事情。

我被迫在装有**Python 3.2.3**和**VLC的****Windows XP**机器上执行此操作来播放我的视频文件。

 ****我目前正在使用此代码...

```
vlc_path = '\\path\\to\\vlc.exe'
video_path = '\\path\\to\\video\\file'
subprocess.call([vlc_path, video_path]) 
```

... 打开 VLC 并播放视频。它工作得很好。但是，脚本在继续之前等待 VLC 退出。这很好，我想保持这种状态。

我的问题是：**有没有办法在视频文件播放后立即退出 VLC？**

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-20T15:46:28.793

有趣的是，vlc 有一个命令行选项：

```
 --play-and-exit, --no-play-and-exit
                             Play and exit (default disabled) 
```

因此，只需将此选项传递给 vlc。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-15T06:36:00.140

另一种选择是传递虚拟项目`vlc://quit`，例如：

```
vlc audio1.mp3 audio2.mp3 vlc://quit 
```

* * *

来源：[https ://wiki.videolan.org/Transcode/#Completely_non-interactive_transcoding](https://wiki.videolan.org/Transcode/#Completely_non-interactive_transcoding)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T15:43:35.733

如果您知道 Python 中视频的长度，我能想到的最好方法是在视频长度过去后通过单独的线程终止该进程。在其他地方，它取决于 VLC-s 命令行选项。也许你可以在播放完电影后告诉他关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-06T10:41:29.357

如果没有任何效果，请尝试`--ignore-config`在开头使用该选项，然后在`vlc`最后`http://quit`使用该选项****

# java - Java和Spring JDBC：如何模拟数据库中的表不存在用于测试（实际上没有删除或重命名它）

> ID：10249267
> 
> 赞同：2
> 
> 时间：2012-04-20T15:40:29.097
> 
> 标签：java, mysql, spring, jdbc, integration-testing

我有一个使用 Spring JDBC 模板与 MySQL 数据库通信的 Java 应用程序。在我的一个测试中，我想模拟一个在集成测试中不存在的表，但是由于各种原因，我实际上无法在我们的测试数据库中临时删除/重新创建或重命名该表。

我也不想模拟特定的 DAO 方法调用，它会命中抛出错误的表，以防我们继续使用其他方法。我想做一些事情，比如在 sql 进入数据库之前拦截它，并用假名替换表名（如果存在）——或者其他具有相同效果的东西。

以测试驱动开发为赢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:55:14.280

您应该使用 EasyMock 进行此类测试。有多种方法可以让方法抛出您指定的任何异常。如果你不能使用它，你就没有有效地分离你的应用层。

查看：[http](http://www.easymock.org/EasyMock2_2_Documentation.html) ://www.easymock.org/EasyMock2_2_Documentation.html ，在“使用异常”标题下

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:38:38.497

如果拦截是您想要的，那么使用方面可能是一种解决方案。

*   您必须创建一个**切入点**拦截，例如，对特定方法的调用“在它进入数据库之前发送 sql”。

*   然后您可以创建**before/around 建议**，您可以在其中操作数据（“用虚假名称替换表名”），然后再继续调用

请参阅[aspectj](/questions/tagged/aspectj "显示标记为“aspectj”的问题")以及[使用 Spring 的 Aspect Oriented Programming](http://static.springsource.org/spring/docs/2.0.x/reference/aop.html)。

# google-maps - 给定同名的州和城市，如何使用谷歌地图 API 查找城市？

> ID：10249270
> 
> 赞同：1
> 
> 时间：2012-04-20T15:40:31.670
> 
> 标签：google-maps

以魁北克为例。它既是一个省，也是一个城市。使用带有“魁北克”查询字符串的谷歌地图 API 会产生省份作为结果。如果我只想要城市，我应该查询什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:43:34.480

我从未尝试过，但在构建地理编码查询时它可能是 "types":["locality"] 。来自[地理编码 API](https://developers.google.com/maps/documentation/geocoding/#Types)。我通常不是 javascript 编码器，所以我不确定语法会是什么样子，但它可以帮助您将结果缩小到城市。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:24:44.357

您需要尽可能具体。通常，地理编码器会在省份之前找到国家名称，在城市之前找到省份，等等。

对于魁北克，请使用`Quebec City`（不是省）或`Quebec, Quebec`（指定省内的城市）。瓷砖也显示“魁北克市”作为城市名称。

# javascript - 在 Javascript 中，为什么我不能绘制对象的多个实例？

> ID：10249274
> 
> 赞同：1
> 
> 时间：2012-04-20T15:40:50.157
> 
> 标签：javascript, html, class, canvas, multiple-instances

我正在尝试使用 HTML5 和 javascript 中的 canvas 标签创建一个基本的游戏引擎。

但是我无法在下面的代码中创建 Balle 类的两个不同实例，我不明白为什么。

```
<html>
<head>
<title>
</title>
<script>
// Description des Classes

// Classe Point2D
function Point2D (x, y)
{
    this.x = x;
    this.y = y;
}

// Classe Box2D
function Box2D (x, y, width, height)
{
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
}

//Classe CanvasObject
function CanvasObject(context) {
    this.context = context;
    this.fillStyle = "#ffff00";
    this.lineWidth = 1;
    this.strokeStyle = "black";
    this.boundingBox2D = new Box2D (0, 0, 0, 0);
}

// Détection de collision par boîte 2D.
CanvasObject.prototype.collides = function (b) {
    var left = (this.boundingBox2D.x < b.boundingBox2D.x + b.boundingBox2D.width);
    var right = (this.boundingBox2D.x + this.boundingBox2D.width > b.boundingBox2D.x);
    var top = (this.boundingBox2D.y + this.boundingBox2D.height > b.boundingBox2D.y);
    var bottom = (this.boundingBox2D.y < b.boundingBox2D.y + b.boundingBox2D.height);

    return left && right && top && bottom;
};

// Classe Arc
// Paramètres :
//    context <-- Contexte d'animation
function Arc(context)
{
    this.context = context;
    this.center = new Point2D(0, 0);
    this.start = 0;
    this.end = 0;
    this.radius = 0;
    this.counterClockwise = false;
}

// Héritage de CanvasObject
Arc.prototype = new CanvasObject(this.context);

// Fonction mettant à jour la bounding box autour de la balle
// Nécessaire car c'est un cercle...
Arc.prototype.update = function () {
    this.boundingBox2D.x = this.center.x - this.radius;
    this.boundingBox2D.y = this.center.y - this.radius;
    this.boundingBox2D.width = 2 * this.radius;
    this.boundingBox2D.height = 2 * this.radius;
};

// Méthode pour dessiner
Arc.prototype.draw = function () {
    this.context.beginPath();
    this.context.arc (this.center.x, this.center.y, this.radius, this.start, this.end, this.counterClockWise);
    this.context.closePath();
    this.context.fillStyle = this.fillStyle;
    this.context.fill();
    this.context.lineWidth = this.lineWidth;
    this.context.strokeStyle = this.strokeStyle;
    this.context.stroke();    
};

// Classe Balle
function Balle (context) {
    this.context = context;
    this.start = 0;
    this.end = 2 * Math.PI;
}

Balle.prototype = new Arc(this.context);

// FIN DÉCLARATION DE CLASSE

// Fonction permettant d'établir le FPS du browser
window.requestAnimFrame = (function(callback){
    return window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.oRequestAnimationFrame ||
    window.msRequestAnimationFrame ||
    function(callback){
        window.setTimeout(callback, 1000 / 60);
    };
})();

// Declare global variables
var lastTime;

// Objets
var balle;
var testArc;

var canvas;
var context;

var pressedKeys;
var d;
var log;

function initialize()
{
    canvas = document.getElementById("c");
    context = canvas.getContext("2d");

    pressedKeys = [];
    d = document.getElementById("divTest");
    log = document.getElementById("log");

    var date = new Date();
    lastTime = date.getTime();

    // Initialize the global variables
    balle = new Balle (context);
    balle.center.x = canvas.width / 2;
    balle.center.y = canvas.height / 2;
    balle.radius = 10;
    balle.speed = 75;
    balle.pixelPerFrame = 0;
    balle.dX = 1;
    balle.dY = 1;
    balle.nitro = 1;
    balle.fillStyle = "#ff0000";
    balle.lineWidth = 1;

    testArc = new Balle (context);

    testArc.center.x = canvas.width *.75;
    testArc.center.y = canvas.height * .75;
    testArc.radius = 25;
    testArc.lineWidth = 3;
}

// Update position of objects
function update()
{
    var date = new Date();
    var time = date.getTime();
    var timeDiff = time - lastTime;

    var ppfFactor = timeDiff / 1000;

    updateBalle(ppfFactor);

    lastTime = time;
}

// Mise à jour de la balle
// Paramètres :
// ppfFactor : pixelPerFrame factor
function updateBalle(ppfFactor)
{

    balle.pixelPerFrame = balle.speed * ppfFactor;

    if (pressedKeys[17])
        balle.nitro = 5;
    else
        balle.nitro = 1;

    if (pressedKeys[37] || pressedKeys[39])
        if (pressedKeys[39])
            balle.dX = 1;
        else
            balle.dX = -1;
    else
        balle.dX = 0;

//    if (!balle.collides (testArc))
        balle.center.x = balle.center.x + (balle.pixelPerFrame * balle.dX * balle.nitro);

    if (pressedKeys[38] || pressedKeys[40])
        if (pressedKeys[40])
            balle.dY = 1;
        else
            balle.dY = -1;
    else
        balle.dY = 0;

//    if (!balle.collides (testArc))
        balle.center.y = balle.center.y + (balle.pixelPerFrame * balle.dY * balle.nitro);

    balle.update();
    testArc.update();    

}

// draw objects
function draw()
{
    // clear
    context.clearRect(0, 0, canvas.width, canvas.height);

    testArc.draw();
    balle.draw();
}

// Boucle continue d'animation
function animate(){

    // update
    update();

    // draw
    draw();

    // request new frame
    requestAnimFrame(function(){
        animate();
    });
}

window.onload = function(){
    // initialize stage
    initialize();

    animate();
};

window.onkeydown = function (e)
{
    var e = window.event || e;

    if (d)
        d.innerHTML = "Key Code : " + e.keyCode + " Collision : " + balle.collides(testArc);

    pressedKeys[e.keyCode] = true;
}

window.onkeyup = function (e)
{
    var e = window.event || e;

    pressedKeys[e.keyCode] = false;
}

</script>
</head>
<body>
<canvas id="c" width="640" height="480">
</canvas>
<div id="divTest"></div>
<ul id="log">
</ul>
</body>
</html> 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:58:51.543

这是因为您完成继承的方式，特别是这一行：

```
Balle.prototype = new Arc(this.context); 
```

这意味着 Balle 类的所有实例都将共享 Arc 类的相同实例作为它们的原型，因此当您更新一个球的中心时，它们都会更新。

您应该研究一种更好的处理继承的方法，一种流行的方法是 John Resig 的方法[http://ejohn.org/blog/simple-javascript-inheritance/](http://ejohn.org/blog/simple-javascript-inheritance/)。

# c# - 在启动时添加 Button Click="...." 会导致“对象引用未设置为对象的实例”

> ID：10249280
> 
> 赞同：3
> 
> 时间：2012-04-20T15:41:08.877
> 
> 标签：c#, wpf, xaml, button

这是我用来生成窗口的代码：

```
<Grid x:Name="LayoutRoot">
    <TreeView DataContext="{Binding ElementName=UserControl, Mode=OneWay}"
        ....
        ItemsSource="{Binding UrlList}" ItemContainerStyle="{DynamicResource TreeViewItemStyle}" >
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:UrlList}">
                <Grid Margin="-15,0,0,0">                       
                    <Expander>
                        <Expander.Header>
                            ....
                        </Expander.Header>
                        <StackPanel>
                            ....
                            <DataGrid ItemsSource="{Binding List}" Margin="0,10,0,0" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    ....
                                    <DataGridTemplateColumn>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="..."  Click="EditUri_Click"/>
                                            </DataTemplate>                                             
                                        </DataGridTemplateColumn.CellTemplate>                                          
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>       
                    </Expander>
                </Grid>
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</Grid> 
```

使用时`<Button Content="..." />`，应用程序正常启动，使用时出现`<Button Content="..." Click="EditUri_Click"/>`以下异常：

```
 System.NullReferenceException was unhandled
  Message=Object reference not set to an instance of an object.
  Source=MyApp
  StackTrace:
       at UrlListInfoPanel.System.Windows.Markup.IStyleConnector.Connect(Int32 connectionId, Object target) in ...\UrlListInfoPanel.xaml:line 152[this is where the button is]
       at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlReader templateReader, XamlObjectWriter currentWriter)
       at System.Windows.FrameworkTemplate.LoadTemplateXaml(XamlObjectWriter objectWriter)
       at System.Windows.FrameworkTemplate.LoadOptimizedTemplateContent(DependencyObject container, IComponentConnector componentConnector, IStyleConnector styleConnector, List`1 affectedChildren, UncommonField`1 templatedNonFeChildrenField)
       at System.Windows.FrameworkTemplate.LoadContent(DependencyObject container, List`1 affectedChildren)
       at System.Windows.StyleHelper.ApplyTemplateContent(UncommonField`1 dataField, DependencyObject container, FrameworkElementFactory templateRoot, Int32 lastChildIndex, HybridDictionary childIndexFromChildID, FrameworkTemplate frameworkTemplate)
       at System.Windows.FrameworkTemplate.ApplyTemplateContent(UncommonField`1 templateDataField, FrameworkElement container)
       at System.Windows.FrameworkElement.ApplyTemplate()
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Border.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.TreeViewItem.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.StackPanel.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)
       at System.Windows.Controls.ItemsPresenter.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)
       at System.Windows.Controls.ScrollContentPresenter.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.ScrollViewer.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Border.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Control.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)
       at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Border.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Control.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)
       at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Documents.AdornerDecorator.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Border.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Controls.Grid.MeasureOverride(Size constraint)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Window.MeasureOverrideHelper(Size constraint)
       at System.Windows.Window.MeasureOverride(Size availableSize)
       at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
       at System.Windows.UIElement.Measure(Size availableSize)
       at System.Windows.Interop.HwndSource.SetLayoutSize()
       at System.Windows.Interop.HwndSource.set_RootVisualInternal(Visual value)
       at System.Windows.Window.SetRootVisualAndUpdateSTC()
       at System.Windows.Window.SetupInitialState(Double requestedTop, Double requestedLeft, Double requestedWidth, Double requestedHeight)
       at System.Windows.Window.CreateSourceWindow(Boolean duringShow)
       at System.Windows.Window.ShowHelper(Object booleanBox)
       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
       at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)
       at System.Windows.Threading.DispatcherOperation.InvokeImpl()
       at System.Threading.ExecutionContext.runTryCode(Object userData)
       at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Windows.Threading.DispatcherOperation.Invoke()
       at System.Windows.Threading.Dispatcher.ProcessQueue()
       at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
       at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
       at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
       at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)
       at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
       at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
       at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
       at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
       at System.Windows.Application.RunInternal(Window window)
       at System.Windows.Application.Run()
       at BookmarkWizV2.App.Main() in App.g.cs:line 0
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

这是从哪里来的，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T15:49:25.560

我以前遇到过这个问题，WPF 似乎不喜欢向数据模板中的控件添加事件。我通过用完成相同事情的命令替换事件来解决它。

编辑：

也许尝试这样的事情......

```
<DataGrid ItemsSource="{Binding List}" Margin="0,10,0,0" AutoGenerateColumns="False">
    <DataGrid.CommandBindings>
        <CommandBinding Command="commands:Commands.EditURI" CanExecute="CommandBinding_CanExecute" Executed="CommandBinding_Executed"/>
    </DataGrid.CommandBindings>
    <DataGrid.Columns>
        <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <Button Content="..." Command="controls:Commands.EditURI"/>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid> 
```

您可以在某处设置一类命令（在 uri 中引用它，我使用了命令：）

```
public class Commands
{
    public static RoutedCommand EditURI = new RoutedCommand("EditURI", typeof(Commands));
} 
```

然后在您的数据上下文中定义两个被调用的方法......

```
 private void CommandBinding_CanExecute(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = true;
    }

    private void CommandBinding_Executed(object sender, ExecutedRoutedEventArgs e)
    {
         //Your code to execute
    } 
```

您可能需要填补一些漏洞，但这应该是一个关于如何设置它的不错的模板。可能有一种更简单/更清洁的方法，但这就是我之前遇到此问题时构建代码的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-27T13:28:45.643

这里有关于 WPF 嵌套模板的 hoxfix ！[http://support.microsoft.com/kb/2464222](http://support.microsoft.com/kb/2464222)

我面临完全相同的问题，但只能在 x86 中使用。应用此修补程序后，它解决了我的问题。

您还可以从以下 Microsoft 网站下载此修补程序： [http ://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=32826](http://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=32826)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:54:48.103

通过xaml解析器解析数据模板时，它是一种资源，除非您定义带有代码的资源字典，否则资源没有代码隐藏，因此在定义资源时无法与窗口中的方法相关联。正如 KDiTraglia 所说，您只能使用与资源数据上下文或其他资源相关的内容

# c# - 如何学习.NET平台的确切版本？

> ID：10249285
> 
> 赞同：3
> 
> 时间：2012-04-20T15:41:22.127
> 
> 标签：c#, .net

编码：

```
Console.WriteLine(Environment.Version); 
```

[为.NET](http://en.wikipedia.org/wiki/.NET_Framework) Framework 2.0、3.0 和 3.5 SP1返回相同的结果 (2.0.50727.5448) 。如何了解已安装的 .NET 平台的确切版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T15:43:06.413

```
System.Runtime.InteropServices.RuntimeEnvironment.GetSystemVersion() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T15:47:03.900

您需要读取注册表项以检测服务包粒度的版本。[本文](https://support.microsoft.com/en-us/help/318785/how-to-determine-which-versions-and-service-pack-levels-of-the-microso)解释了您需要寻找哪些键/值对。

例如，您可以`3.5`通过`3.5 SP1`查看内部的值来判断

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5 
```

“平原” 3.5 有`Install = 1`，而`SP1`有`SP >=1`。

滚动到文章底部的链接以查看整个表格。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-20T15:59:26.467

2.0、3,0、3,5 和 3.5SPx 都基于同一组核心 2.0 库。基本上所有这些版本都是 2.0 加上附加组件。此答案包含版本列表：[.NET Framework、CLR 和 Visual Studio 版本号如何相互关联？](https://stackoverflow.com/questions/212896/how-do-the-net-framework-clr-and-visual-studio-version-numbers-relate-to-each)及相关信息。

因此，当您询问运行时环境版本是什么时，您会得到 2.0（据我所知，其他变体是 1、1.1 和 4.0）。

如果需要3/3.5/SP区分@dasblinkenlight给了你答案。否则解释你试图做什么以获得更多建议。

# algorithm - 对两个列表列表设置操作

> ID：10249292
> 
> 赞同：0
> 
> 时间：2012-04-20T15:42:06.677
> 
> 标签：algorithm, haskell

我有两个问题；

*   如何**以有效的方式**构造两个列表列表的并集？
*   如何**以有效的方式**区分两个列表列表？

我想要的是 ;

```
input :    first_list  =  ["stack", "foo", "bar" ]
           second_list =  ["foo", "like" ]

           first_list U second_list = ["stack", "foo", "bar", "like" ] 

           first_list - second_list = ["stack", "bar" ] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T18:06:48.183

使用`Set`（[联合](http://hackage.haskell.org/packages/archive/containers/0.4.2.1/doc/html/Data-Set.html#v%3aunion)、[差异](http://hackage.haskell.org/packages/archive/containers/0.4.2.1/doc/html/Data-Set.html#v%3adifference)）、排序列表（[联合](http://hackage.haskell.org/packages/archive/data-ordlist/0.4.5/doc/html/Data-List-Ordered.html#v%3aunion)、[差异](http://hackage.haskell.org/packages/archive/data-ordlist/0.4.5/doc/html/Data-List-Ordered.html#v%3aminus)）或未排序列表（[联合](http://hackage.haskell.org/packages/archive/base/4.5.0.0/doc/html/Data-List.html#v%3aunion)、[差异](http://hackage.haskell.org/packages/archive/base/4.5.0.0/doc/html/Data-List.html#v%3a-92--92-)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T15:46:45.250

您可能想查看支持有效连接的[序列：在 O(log(min(n1,n2))) 时间内。](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Sequence.html)

```
(><) :: Seq a -> Seq a -> Seq a 
```

# asp.net-mvc - 如何让 TeamCity 使用 ASP.NET MVC 3 Web 项目

> ID：10249302
> 
> 赞同：4
> 
> 时间：2012-04-20T15:42:42.627
> 
> 标签：asp.net-mvc, asp.net-mvc-3, continuous-integration, teamcity

我目前正在与 TeamCity 合作，试图让两个构建配置适用于 ASP.NET MVC 3 解决方案。[我的设置与http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_26.html](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_26.html)上的指南几乎相同。当它在第一个“构建和测试”构建配置中构建 .sln 时，一切正常。但是在“打包和部署”配置中，当我让 MSBuild 直接构建 MyWebProject.csproj 文件时，它似乎正在解析核心 .NET 对 .NET 3.5 程序集的引用，而不是 .NET 4.0 程序集。

因此，我遇到了各种 .NET 3.5 编译错误，例如需要主体的“{ get; set; }”属性，因为它们没有被标记为抽象。

此外，是什么让我认为它正在使用 v3.5 程序集，是在 TeamCity CoreCompile - Csc 构建活动期间，它说

> “[Csc] c:\Program Files\TeamCity\buildAgent\work\651adc4c97432014\packages\DataAnnotationsExtensions.1.0.2.0\lib\NETFramework40\DataAnnotationsExtensions.dll 错误 CS1705：程序集'DataAnnotationsExtensions，版本=1.0.2.0，文化=中性， PublicKeyToken=358a5681c50fd84c' 使用 'System.ComponentModel.DataAnnotations, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 它的版本比引用的程序集 'System.ComponentModel.DataAnnotations, Version=3.5.0.0, Culture=neutral , PublicKeyToken=31bf3856ad364e35'"

现在，如果我在 Web 项目的 .csproj 文件中将版本显式设置为“Version=4.0.0.0”，那么它开始在其他核心 .NET 程序集（例如 System.Core.dll）上给我类似的异常；即，它一直试图解析对 v3.5 程序集而不是 v4.0 的引用。有趣的是，我知道它使用的是用于 v4.0 的 MSBuild，因为构建日志指出“使用来自：C:\Windows\Microsoft.NET\Framework\v4.0.30319 的用户定义的 MSBuild”。我的命令行参数，begin 传递给 MSBuild 配置，如下：

```
/P:Configuration=%env.Configuration%
/P:DeployOnBuild=True
/P:DeployTarget=MSDeployPublish
/P:MsDeployServiceUrl=https://%env.TargetServer%/MsDeploy.axd
/P:AllowUntrustedCertificate=True
/P:MSDeployPublishMethod=WMSvc
/P:CreatePackageOnPublish=True
/P:UserName=MyUsername
/P:Password=MyPassword 
```

我在构建服务器上完成了以下操作： * 安装了“Microsoft Windows SDK for Windows 7 and .NET Framework 4” * 安装了 VS 2010（希望避免这种情况） * 安装了 ASP.NET MVC 3 * 添加了 evn.MSBuild设置为 %system.DotNetFramework4.0_x86_Path%。* 添加注册表项 HKLM/SOFTWARE/Microsoft/.NETFramework/SDKInstallRootv2.0 为“C:\Program Files\Microsoft SDKs\Windows\v7.1”。

感谢您的任何帮助，您可以提供！

比利·麦卡弗蒂

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T16:38:32.687

您要做的是确保在构建项目时设置了一些东西......

我通常将其分为两个步骤

1）构建解决方案
在此步骤中，确保 Visual Studio 版本设置为 2010。

![在此处输入图像描述](../Images/9505dde981b7d34dd5476981bd00304f.png)

2) 预构建 Web 在这一步中，我调用命令来构建 Web 项目并生成可部署，设置 msbuild 步骤的框架版本和适当的平台。将目标设置为“ResolveReferences;_CopyWebApplication”构建文件路径应指向 mvc 应用程序的 csproj 文件

![在此处输入图像描述](../Images/33d845c2d04286f780fb4c6a37248381.png)

最后一步是设置一些构建参数。

system.Configuration => 发布
system.OutputPath => C:\inetpub\wwwroot\foo\bin
system.WebProjectOutputDir => C:\inetpub\wwwroot\foo

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:38:44.130

在您的 MSBuild 步骤配置页面中，您肯定将 MSBuild 版本和 MSBuildTools 版本设置为 4.0？

![在此处输入图像描述](../Images/534d6cd37689a40c34b1a3dcf03d5d88.png)

# mysql - 在 MySQL 中使用多个连接和 group_concat()？

> ID：10249305
> 
> 赞同：2
> 
> 时间：2012-04-20T15:42:48.450
> 
> 标签：mysql, join, group-concat, database-table

我需要为一个项目使用 Joins，但我忘记了如何使用它。现在这一切都在弄乱我的头，我无法弄清楚。

我有五个表，我需要加入所有这些表：

```
categories - id, name
movies_categories - movie_id, category_id
movies - id, title, description, release_date, cover_image
users - id, username, password
user_movies - user_id, movie_id, favorite, review, watch_date, rating 
```

如您所见，该项目与电影相关，并且 user_movies 包含用户观看过的所有电影。我需要做的是获取某个用户看过的所有电影。因此，我需要每部电影的所有电影信息、用户名（这几乎是我需要用户提供的所有信息）以及 user_movies 中的一些列（除前两个之外的所有列）。我还需要将每部电影的所有类别组合成一个“变量”。我相信你可以使用 GROUP_CONCAT() 来做到这一点，我以前做过。

这是一项棘手的任务，我真的需要解决这个问题。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T18:44:34.807

如果您提供了表模式（创建表脚本），我可以在 sqlfiddle 上测试查询，所以我无法测试，但我认为这个查询是您需要的。

```
select u.username, u.password
     , um.user_id, um.movie_id, um.favorite
     , um.review, um.watch_date, um.rating 
     , m.movie_title, m.description, m.release_date, m.cover_image
     , mc.category_id
     , group_concat(distinct c.name) as movie_categorynames
from user_movies um
inner join users u on u.id = um.user_id
inner join movies m on m.id = um.movie_id
inner join movies_categories mc on mc.movie_id = um.movie_id
inner join categories c on c.id = mc.category_id
where um.user_id=1
group by um.user_id

USERNAME    PASSWORD    USER_ID MOVIE_ID    FAVORITE    REVIEW  WATCH_DATE  RATING  MOVIE_TITLE DESCRIPTION RELEASE_DATE    COVER_IMAGE CATEGORY_ID MOVIE_CATEGORYNAMES
nike    5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8    1   3   0   This is my movie review!    51351   7   It's Kind of a Funny Story  A clinically depressed teenager gets a new start after he checks himself into an adult psychiatric ward.    2010    8d27232902780886db032afb8d4883a7.jpg    5   Comedy,Drama 
```

# javascript - 使用 javascript 检查是否使用 devise 登录

> ID：10249306
> 
> 赞同：16
> 
> 时间：2012-04-20T15:42:50.623
> 
> 标签：javascript, ruby-on-rails-3, cookies, devise

我有一个使用 devise 进行身份验证的 rails 3 应用程序，并且想使用 javascript 查看用户是否已登录。最好的方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-24T17:49:43.233

由于 Devise 基于 Warden，您可以使用 Warden 的回调设置一个额外的 cookie，该 cookie 将从 js 中可见（与仅服务器会话 cookie 不同），例如在您的 devise.rb 中：

```
 Warden::Manager.after_set_user do |user,auth,opts|
    auth.cookies[:signed_in] = 1
  end

  Warden::Manager.before_logout do |user,auth,opts|
    auth.cookies.delete :signed_in
  end 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-20T16:55:17.917

看起来 Rails 将客户端上的会话存储在[cookie](http://www.quarkruby.com/2007/10/21/sessions-and-cookies-in-ruby-on-rails#sinrails)中。

当您登录 ( `console.log( document.cookies )`) 时，我会检查您的应用程序中的 cookie，并查看您注销时*不*存在的内容。

这样，您将轻松了解如何在客户端上检查您是否已连接。

# module - X-Cart Pro 模块在产品详情页面显示卖家信息

> ID：10249307
> 
> 赞同：0
> 
> 时间：2012-04-20T15:42:56.817
> 
> 标签：module, x-cart

我正在使用 X-Cart Pro 4.4.5。

在用户单击任何产品时显示产品的详细信息时，我还想显示卖方信息，即谁在销售该产品。

请参阅以下链接 X-Cart 如何显示其产品详细信息： http: [//demo.x-cart.com/demo_pro/Three-Stone-Princess-Cut-Diamond-Ring.html](http://demo.x-cart.com/demo_pro/Three-Stone-Princess-Cut-Diamond-Ring.html)

现在请参阅下面的链接以了解应如何包含卖家信息，它将显示供应商名称，例如“ **World Wide Stereo 发货/销售（这是谁？）** ” [http://www.buy.com/prod /mirage-nanosat-5-0-black/215492968.html](http://www.buy.com/prod/mirage-nanosat-5-0-black/215492968.html)

现在的问题是，我们是否有任何模块准备好在产品详细信息页面中显示卖家信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:05:42.013

我们不知道我害怕这样的模组。尝试在[http://marketplace.x-cart.com/addons-modules/找到一些东西](http://marketplace.x-cart.com/addons-modules/)

但在产品描述页面中显示卖家/供应商的名称并不是 X-Cart 的大定制。X-Cart 中的每个产品都带有卖家数据，您只需编辑 product.tpl 模板文件即可在您需要的地方显示“供应商”信息。

# javascript - backbone.sync 获取所有响应错误状态码

> ID：10249310
> 
> 赞同：1
> 
> 时间：2012-04-20T15:42:59.757
> 
> 标签：javascript, backbone.js, http-status-code-302

最后，我想捕获 302 错误并重定向到我的登录页面，但现在 xhr.status 的状态代码为 200。

这是我当前的代码：

```
parentSyncMethod = Backbone.sync
Backbone.sync = (method, model, options) ->
  old_error = options.old_error
  options.error = (xhr, text_status, error_thrown) ->
    if(xhr.status == 302)
      window.location.replace('http://localhost:8080/login')
    else
      old_error?(xhr, text_status, error_thrown)
  parentSyncMethod(method, model, options) 
```

基本上我认为问题在于当前网页抛出 200 错误，但是抛出 302 的网页被包装并且没有传播到 xhr.status。有没有办法从所有已进行的 get、post、put 等调用中获取所有状态代码响应？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:02:52.727

302 响应代码由浏览器自动重定向，因此您将无法捕获该响应。您的处理程序只会在数据从重定向到的 URL 返回时运行。

我想说的是，您可能应该只返回 200 并让响应数据以自己的方式指示重定向，而不是在这里使用 302。

# sql-server-2008 - 多个层次结构（林？）中的成员到单个表中

> ID：10249314
> 
> 赞同：3
> 
> 时间：2012-04-20T15:43:15.523
> 
> 标签：sql-server-2008, tsql, metadata, pivot

如果我有下表：

```
Member_Key  Member_Name             col1    Mem1    col2    Mem2    col3    Mem3    col4    Mem4
-----------------------------------------------------------------------------------------------
31          100.00 - Some Account   9       Rollup1 268     Rollup2 246     Rollup3 238   Rollup4
31          100.00 - Some Account   270     Rollup5 271     Rollup6 NULL    NULL    NULL    NULL
31          100.00 - Some Account   283     Rollup7 NULL    NULL    NULL    NULL    NULL    NULL 
```

所需的输出是：

```
Member_Key    Member_Name    col1  mem1  col2  mem2  col3  mem3 col4 mem4 col5 mem5  col6  mem6  col7  mem7 
```

我一直在尝试使用 1 个帐户完成此操作，以便我可以尝试使其动态化为具有 y 个汇总的 x 个帐户并将它们放入一个可变列结果中，但我似乎无法得到这个通过使用 PIVOT 或 SELECT CASE 工作。任何帮助或链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T08:03:25.770

我希望以下查询是您的答案：

```
SELECT *
From
    (SELECT  A.Member_Key,
            A.Member_Name,
            CASE B.n
                WHEN 1 THEN A.Mem1
                WHEN 2 THEN A.Mem2
                WHEN 3 THEN A.Mem3
                WHEN 4 THEN A.Mem4
            END AS Mem,
            CASE B.n
                WHEN 1 THEN A.Col1
                WHEN 2 THEN A.Col2
                WHEN 3 THEN A.Col3
                WHEN 4 THEN A.Col4
            END AS Col
        FROM MyTable A
        CROSS JOIN (SELECT 1 
            UNION SELECT 2
            UNION SELECT 3
            UNION SELECT 4)B(n)
    )AS p
PIVOT (MIN(Col) FOR Mem IN ([Rollup1], [Rollup2], [Rullup3], [Rollup4], [Rollup5], [Rullup6], [Rullup7])) AS Pvt 
```

# algorithm - 如何查看 Maple 中函数/方法的源代码实现？

> ID：10249317
> 
> 赞同：1
> 
> 时间：2012-04-20T15:43:41.050
> 
> 标签：algorithm, symbolic-math, maple

我尝试了以下方法：

```
interface(verboseproc=2);
readlib(FormalPowerSeries); 
```

但我没有得到源代码，而是得到以下几行：

```
module()
local UpdateCoeff,ComplexApart,RationalAlgorithm,constantRE,PSInt,PS,hypergeomRE,de2re,hypergeomRsolve,printDE,DIRECTION,simpl,FindDE,Limit,Recursion,RecursionSimplify,Pochhammer,simpreal,simppoch,simpfact,tofact,`FPS/Hankel1`,`FPS/Hankel2`,`FPS/JacobiP`,`FPS/Bateman`,`FPS/ExpIntegralE`,`FPS/Abramowitz`,`FPS/Fibonacci`,`FPS/LegendreP`,`FPS/LegendreQ`,`FPS/ChebyshevT`,`FPS/ChebyshevU`,`FPS/LaguerreL`,standardsum,REorder,subsspecfunc,SUBS,mysolve;
export FPS,HolonomicDE,SimpleRE,_pexports,`convert/RESol`;
global `diff/FPS/Hankel1`,`diff/FPS/Hankel2`,`diff/FPS/JacobiP`,`diff/FPS/LegendreP`,`diff/FPS/LegendreQ`,`diff/FPS/ChebyshevT`,`diff/FPS/ChebyshevU`,`diff/FPS/LaguerreL`,`diff/FPS/Bateman`,`diff/FPS/ExpIntegralE`,`diff/FPS/Abramowitz`,`diff/FPS/Fibonacci`,`convert/FormalPowerSeries`,`convert/FPS`;

end module 
```

有没有办法查看源代码实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:19:08.130

```
restart:

interface(verboseproc=3): # verbose printing of procedure bodies

exports(FormalPowerSeries); # those which you can normally print

eval(FormalPowerSeries:-FPS); # printing one of the exports

eval(FormalPowerSeries); # the shell of the module, showing locals

# normally, you cannot print the locals
eval(FormalPowerSeries:-RationalAlgorithm);

kernelopts(opaquemodules=false): # allowing printing of the locals

eval(FormalPowerSeries:-RationalAlgorithm); 
```

# ruby - Ruby on Rails - 使用 authlogic 存储纯文本密码

> ID：10249325
> 
> 赞同：0
> 
> 时间：2012-04-20T15:44:15.263
> 
> 标签：ruby, authlogic

我有一个 ruby​​ 应用程序，我正在使用“Authlogic”进行用户身份验证。用户可以注册和登录没有问题。

现在我有一个 csv 文件，其中有一个用户详细信息列表，我必须将这些详细信息迁移到“用户”表。为此，我编写了一个脚本，该脚本遍历 csv 文件并将数据存储到“用户”表中。

问题是我找不到为以下字段生成值的方法：

crypted_pa​​ssword password_salt persistence_token

authlogic 需要工作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:04:33.253

考虑观看[这个](http://railscasts.com/episodes/250-authentication-from-scratch?view=asciicast)railscast，它展示了如何通过添加盐来生成加密密码。

但是，如果在您的用户表中，密码已经是盐加密的，我想它不可能再次生成加密密码。

在这种情况下，您应该使您的 csv 导入脚本***不会***更新现有用户的密码字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T11:19:11.600

就是这么简单......只需使用用户模型：

user = User.new(:email => email, :login => login, :password => 密码, :password_confirmation => 密码)

以及 authlogic 添加的字段。

# javascript - 为什么 JS for each in function 给太多了？

> ID：10249331
> 
> 赞同：0
> 
> 时间：2012-04-20T15:44:57.900
> 
> 标签：javascript, object, for-loop, for-in-loop

这困扰了我一段时间，请参阅我的 jsfiddle：http: [//jsfiddle.net/DHR8Q/](http://jsfiddle.net/DHR8Q/)，其中包含以下 javascript 代码：

```
var id = "11111;22222;33333";

id = id.split(";");

alert(typeof id);

for (var i in id){
    alert(id[i]);
}​ 
```

当我用字符“;”分割变量时`id`，然后我使用 for 循环，我会假设`i == 0,1,2`因为字符串`id`被分割成 3 部分，但这不是发生的情况。在现实`i == 0,1,2,3,4...`中。为什么 JavaScript 会这样做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T15:48:14.907

因为您链接到的 jsFiddle 包含 Mootools 库；它将自己的方法添加到`Array.prototype`.

当您使用 枚举数组`for in`时，它会遍历*所有*属性；包括那些方法；这就是你所看到的。

您应该改为检查 using `hasOwnProperty()`，或者*最好*使用`for(;;);`

```
for (var i in id){
    if (id.hasOwnProperty(i)) {
        alert(id[i]);
    }
}​ 
```

[(jsFiddle)](http://jsfiddle.net/DHR8Q/1/)

或者

```
for (var i=0;i<id.length;i++) {
    alert(id[i]);
} 
```

[(jsFiddle)](http://jsfiddle.net/DHR8Q/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T15:49:43.503

这是因为`for... in`迭代对象的所有属性（包括来自 的属性`prototype`）。

当您`for... in`遍历数组时，您将获得数组元素、`length`属性以及`Array.prototype`.

您可以使用以下方法解决此问题`hasOwnProperty`：

```
for (var i in id){
    if(id.hasOwnProperty(i){
        alert(id[i]);
    }
}​ 
```

虽然，我建议不要使用`for... in`数组，使用[`forEach`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)：

```
id.forEach(function(v){
    alert(v);
}); 
```

或者一个很好的 for 循环：

```
for(var i=0, len=id.length; i<len; i++){
    alert(id[i]);
} 
```

* * *

**编辑**

该`forEach`功能不能作为后级浏览器的内置功能使用，因此您可以这样做：

```
if (typeof Array.prototype.forEach !== 'function') {
    Array.prototype.forEach = function(fn, thisObj) {
        var scope = thisObj || window,  L = this.length, i;
        for (i=0; i < L; ++i) {
            fn.call(scope, this[i], i, this);
        }
    };
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T15:51:02.113

JS 中的数组是对象。当您对数组执行 for...in 时，您将获得该对象的所有索引以及所有原型成员。在您的情况下，原型成员包括一堆数组函数。

您应该使用常规 for 循环来迭代数字索引。

[emacs 中JSShell](http://marmalade-repo.org/packages/jsshell-bundle)的输出说明：

```
js> 
Multi-line input. Use two consecutive blank lines to eval.

var id = "11111;22222;33333"; 

id = id.split(";"); 

js> function say (x) {WScript.echo(x);}
js> for (var i in id) { say (i); } 
0
1
2
forEach
every
map
filter
remove
removeAt
indexOf
contains
js> for(var i=0;i<id.length;i++) { say (i + ": " + id[i]); } 
0: 11111
1: 22222
2: 33333
js> 
```

另请参阅：[JavaScript 循环：for...in 与 for](https://stackoverflow.com/questions/5263847/javascript-loops-for-in-vs-for)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T16:13:17.803

您不应该将它用于数组，因为首先不能保证顺序，其次这些用于列出对象的所有可枚举属性，这可能不适合数组，因为一些框架将属性添加到数组原型中，这些属性也将被枚举。

# ios - 当存在@2x~ipad 图像时，为非视网膜 iPad 使用@2x 文件

> ID：10249334
> 
> 赞同：1
> 
> 时间：2012-04-20T15:45:08.360
> 
> 标签：ios, xcode, ipad

我有 3 张图片，file.png、file@2x.png 和 file@2x~ipad.png。我想在 Retina iPhone 和 nonRetina iPad 上使用 file@2x.png。

我想**在 interface builder 中设置图像**。iPhone 工作正常，我在 xib 中设置 file.png 并在 Retina iPhone 上加载 file@2x.png。但在非视网膜 iPad 上，即使我指定了 file@2x.png，也会加载 file@2x~ipad.png。

当通过界面生成器/xibs 不存在 ~ipad 版本时，有没有办法将 nonRetina iPad 设置为默认为 @2x 版本？（*我很清楚通过编写自定义加载代码通过代码加载具有不同扩展名的图像*）我可以更改任何设置或列表吗？

**我不想复制**相同的图像只是为了能够以不同的方式命名它们。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:41:34.627

在不添加重复文件的情况下执行此操作的一种方法是命名 iPad 版本`file@2x@2x.png`。然后，您可以使用其中一个设置 iPad 版本，`[UIImage imageNamed:@"file@2x"];`或将图像设置`file@2x.png`为已`file@2x@2x.png`在视网膜 iPad 和`file@2x.png`普通 iPad 上使用。这样就没有重复了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:12:32.837

使用符号链接指向`myImage~iPad.png`. `myImage@2x.png`来源[https://stackoverflow.com/a/10223119/313875](https://stackoverflow.com/a/10223119/313875)

这个答案的摘要（阅读 - 其他人对另一个问题的回答，所以请给他们投票！）：

用于`ln -s myImage@2x.png myImage~ipad.png`每个图像。或者使用脚本：

```
#! /bin/sh

# Script to batch create symlinks that point ~ipad files to @2X files

# To run:
# Copy to the directory where the files are located
# Enter the following at the terminal prompt:
# bash create_ipad_image_links.txt

# For every @2x file we find in this directory we create a symlink

for file in *@2x.png
do
  echo "link: ${file//@2x/~ipad} to: $file" 
  ln -s $file ${file//@2x/~ipad}
done 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-20T16:29:32.937

尝试创建`file~ipad.png`. 非视网膜 iPad 应首先查找该文件。

# java - java excel提取器的问题

> ID：10249340
> 
> 赞同：2
> 
> 时间：2012-04-20T15:45:35.877
> 
> 标签：java, excel, csv

我写了一些代码来从 xls 中提取数据并将它们保存到 csv 中。一切都很好，除了当我有时间价值时，它将它更改为日期。我怎样才能避免这种情况？例如，如果在 xls 文件中它是 119:22:00，它将以 1/4/1900 23:23 格式保存到 csv 文件中，格式类型为日期。如何保持格式为 String 的方式？

这是代码：

```
if (sheet != null)
{
    for (currentRow = 0; currentRow < sheet.getRows(); currentRow++)
    {
        row = new ArrayList<String>();
        Cell[] rowCells = sheet.getRow(currentRow);
        for (Cell cell : rowCells)
        {
            System.out.println(cell.getContents());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:05:51.567

您需要获取 Excel.Cell.Text 而不是 Excel.Cell.Value 才能查看格式化值。显然，您要提取的是价值。根据您的代码，看起来问题将出现在`cell.getContents()`或`sheet.getRow()`- 用于从 excel 中提取数据的任何一个。您也应该发布这些功能的内容。

Excel 中的日期和时间的基础值很难处理，对于新手用户来说，其原始格式毫无意义。您只需打开 Excel 工作表并将格式临时更改为`number`. 您会看到，只要您输入日期或时间，它就会将其转换为该日期或时间的数字表示，这对用户来说毫无意义，因此如果您提取基础值而不是格式化的文本。

![在此处输入图像描述](../Images/a5c3d65b7daade74279643e73e47d2c9.png)

# ios - 使用 MusicPlayer 和 Music Sequence 播放 MIDI 文件

> ID：10249346
> 
> 赞同：5
> 
> 时间：2012-04-20T15:46:06.623
> 
> 标签：ios, objective-c, midi, audio-player, coremidi

我已经成功让 iOS 使用以下代码播放带有 soundfont 示例的 .mid (midi) 文件：

```
-(void) playMusic:(NSString*) name
{
    NSString *presetURLPath = [[NSBundle mainBundle] pathForResource:@"GortsMiniPianoJ1" ofType:@"SF2"];
    NSURL * presetURL = [NSURL fileURLWithPath:presetURLPath]; 
    [self loadFromDLSOrSoundFont: (NSURL *)presetURL withPatch: (int)3];

    NSString *midiFilePath = [[NSBundle mainBundle] pathForResource:name ofType:@"mid"];
    NSURL * midiFileURL = [NSURL fileURLWithPath:midiFilePath];

    NewMusicPlayer(&musicPlayer);

    if (NewMusicSequence(&musicSequence) != noErr) 
    {
        [NSException raise:@"play" format:@"Can't create MusicSequence"];  
    }

    if(MusicSequenceFileLoad(musicSequence, (CFURLRef)midiFileURL, 0, 0 != noErr)) 
    {
        [NSException raise:@"play" format:@"Can't load MusicSequence"];
    }

    MusicPlayerSetSequence(musicPlayer, musicSequence);
    MusicSequenceSetAUGraph(musicSequence, _processingGraph);
    MusicPlayerPreroll(musicPlayer);
    MusicPlayerStart(musicPlayer);
} 
```

但是，当我在第一个文件仍在播放时尝试播放第二个文件时，问题就来了。

我尝试了很多变化。首先，上面的代码将同时播放两个曲目。或者，我试过：

```
DisposeMusicPlayer(musicPlayer);
DisposeMusicSequence(musicSequence); 
```

在 ,之前`NewMusicPlayer(&musicPlayer)`，但这会产生一个奇怪的曲调版本，只播放零星的音符。

我很想简单地调用这个方法，以及要播放的下一首曲目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T10:08:21.667

好的，我找到了有关如何正确处理 a`MusicPlayer`和`MusicSequence`.

```
-(void) stop
{
   OSStatus result = noErr;

   result = MusicPlayerStop(musicPlayer);

   UInt32 trackCount;
   MusicSequenceGetTrackCount(musicSequence, &trackCount);

   MusicTrack track;
   for(int i=0;i<trackCount;i++)
   {
      MusicSequenceGetIndTrack (musicSequence, i, &track);
      result = MusicSequenceDisposeTrack(musicSequence, track);
   }

   result = DisposeMusicPlayer(musicPlayer);
   result = DisposeMusicSequence(musicSequence);
   result = DisposeAUGraph(_processingGraph);
} 
```

# c - 在 AIX 上编译链接到静态库的 ac 应用程序

> ID：10249347
> 
> 赞同：3
> 
> 时间：2012-04-20T15:46:08.167
> 
> 标签：c, gcc, aix, static-linking, .a

我正在尝试编译我的应用程序以链接到静态库（.a 文件）

我用来构建的命令是这样的：

```
gcc -DUNIX -maix32 -o Release/bin/testApp Release/obj/main.o -ltestLib 
```

构建时出现以下错误：

```
ld: 0711-317 ERROR: Undefined symbol: .test
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information. 
```

其中 test 是 libtestLib.a 中的一个方法

另外，如果我尝试使用动态库进行构建，那么它是成功的。

```
gcc -DUNIX -maix32 -o Release/bin/testApp Release/obj/main.o libtestLib.so 
```

你能看出我哪里错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:01:49.803

您可以尝试指定存档文件的路径，而不是`-ltestLib`?

```
gcc -DUNIX -maix32 /path/to/testLib.a -o Release/bin/testApp Release/obj/main.o 
```

# asp.net - ASP 按钮控制触发

> ID：10249348
> 
> 赞同：0
> 
> 时间：2012-04-20T15:46:10.283
> 
> 标签：asp.net, vb.net

我遇到的问题解释起来有点复杂，所以请多多包涵。我有 2 个按钮控件。在页面加载中，我想知道哪个按钮在页面加载时创建了回发。通过研究，我在下面找到了这个片段，它按预期工作。所以这是我点击按钮时发生的事件场景。

```
 1\. Click the button does a postback
   2\. Runs the function below and tell me the id of the button
   3\. Runs the clicked event handlers for that button

     Protected Sub btnCalc_Click(ByVal sender As Object, ByVal e As EventArgs) Handles  btnCalc.Click
          ' Do this
     End Sub 
```

当我单击第二个按钮时，问题就出现了，它执行第 1 步和第 2 步，但从不执行第 3 步。通过测试，我发现它在单击第一个按钮时仅执行 1、2 和 3。我不知道为什么会这样？

```
 Function GetPostBackControlName() As String

      Dim control As Control = Nothing
      Dim ctrlname As String = Page.Request.Params("__EVENTTARGET")

    If ctrlname <> Nothing AndAlso ctrlname <> [String].Empty Then
        control = Page.FindControl(ctrlname)
    Else
        Dim ctrlStr As String = [String].Empty
        Dim c As Control = Nothing

        For Each ctl As String In Page.Request.Form

            c = Page.FindControl(ctl) 

           If TypeOf c Is System.Web.UI.WebControls.Button Then
                control = c
                Exit For
           End If

        Next

    End If

    Try
        Return control.ID.ToString
    Catch
        Return ""
    End Try

    End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:03:33.643

您真的应该考虑将`Click`事件处理程序分配给您的按钮。Asp.net 是故意设计的，这样您就不必像上面那样解析请求对象。

# networking - 如何使用 Wireshark 查看源页面？

> ID：10249360
> 
> 赞同：3
> 
> 时间：2012-04-20T15:46:51.250
> 
> 标签：networking, gzip, wireshark, pcap, chunked-encoding

是否有可能使用 Wireshark 捕获和查看网站的源页面？我不需要标头数据包，我正在寻找的是我在运行 Wireshark 时打开的任何站点的完整源页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:49:10.673

是的 - 在数据包列表中，右键单击并说“Follow TCP Stream”。对于未压缩的内容，就是这样。

如果内容是 gzip 压缩的，您需要将该输出保存到文件中，使用体面的文本编辑器（不会破坏二进制内容）去除标题，然后运行 ​​gunzip 解压缩它。

（如果有人知道让 Wireshark 自己做这一切的方法，我会全力以赴！）

**编辑**：刚刚注意到'chunked-encoding'标签......这让它变得更难了。在文本编辑器中编辑块标题应该是可能的，但如果它们很多，则很乏味。

# matlab - 制作单击 MATLAB 绘图标记绘图子图

> ID：10249361
> 
> 赞同：3
> 
> 时间：2012-04-20T15:46:58.360
> 
> 标签：matlab, plot, interactive, marker, clickable

在 Matlab 2011b 中，我有一个多维矩阵，最初将其呈现为 2 维的二维图。我希望用鼠标左键使标记可点击。单击标记会绘制由单击值切片的其他维度的新图形。

这个问题与[Matlab有关：绘制点并使它们可单击以显示有关它的信息，](https://stackoverflow.com/questions/8442659/matlab-plot-points-and-make-them-clickable-to-display-informations-about-it)但我想运行一个脚本，而不仅仅是弹出有关单击点的数据。

谷歌搜索暗示`ButtonDownFcn`可以使用，但我发现的示例需要手动绘制每个点并附加一个处理程序，如下所示：

```
hp = plot(x(1), y(1), 'o');
set(hp, 'buttondownfcn', 'disp(1)'); 
```

由于主图中有许多标记，是否可以将处理程序附加到整个曲线并调用子图绘图函数并单击标记的索引（首选）或坐标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:26:18.453

这是您需要的想法，如果我了解您的要求，应该可以帮助您入门。

在这种情况下，当您选择一条曲线时，它将在底部子图中绘制它并保留颜色。

```
function main
subplot(211)
h = plot (peaks);

set (h,'buttondownfcn', @hitme)
end

function hitme(gcbo,evendata)
subplot (212)
hold on;

col = get (gcbo,'Color');
h2 =  plot (get (gcbo,'XData'),get (gcbo,'YData'));
set (h2,'Color', col)

pt = get (gca, 'CurrentPoint');
disp (pt);
end 
```

您可以通过简单地编写函数`get(gcbo)`来探索您的 get 选项。`hitme`

# android - 符号的 Android 键码

> ID：10249365
> 
> 赞同：1
> 
> 时间：2012-04-20T15:47:09.743
> 
> 标签：android, methods, input, keycode, ime

我需要一些帮助来开发我的新定制输入法。我正在使用 InputConnection.sendKeyEvent 将新的 KeyEvents 直接发送到应用程序。问题是我似乎找不到符号的键码（例如#$%*）。

我在发送 KeyEvent.KEYCODE_SEMICOLON 之前尝试发送 KeyEvent.KEYCODE_SHIFT_LEFT 以发送冒号并且它有效，但它似乎不适用于数字。

所以我的问题是如何访问所有符号键码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:54:26.453

以下是关键代码::: [LINK](http://developer.android.com/reference/android/view/KeyEvent.html)

# 的 KEYCODE_POUND

KEYCODE_STAR 用于 *

您可以使用 event.getNumber() 获取事件的密钥编号，如下所示。

```
 @Override
    public boolean onKeyDown(int keyCode, KeyEvent event)  {

        Log.d("::"+keyCode,"::"+event.getNumber());
            return super.onKeyDown(keyCode, event);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-08T09:02:28.867

有两个链接：[link1](https://wladimir-tm4pda.github.io/porting/keymaps_keyboard_input.html)和[link2](https://source.android.com/devices/input/keyboard-devices.html)

'！' - keyKode :1, mortification(caps): 1, '#' keyKode :3, mortification(caps): 1, 以此类推。

希望能帮助到你。

# netbeans - Netbeans 主题：调整 HTML 参数值的颜色

> ID：10249368
> 
> 赞同：0
> 
> 时间：2012-04-20T15:47:30.617
> 
> 标签：netbeans

在哪里可以更改 NetBeans 中 HTML 参数值的背景颜色？我不明白为什么它会突出显示。

![http://i.stack.imgur.com/FyVKo.jpg](../Images/5beec6e11344a81d084bf9492a38ba94.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T09:04:55.847

您可以在以下参数中参数语法颜色和突出显示：

> 工具 --> 选项 --> 字体和颜色

在窗格`Syntax`中，选择 HTML，然后选择您想要的类别并对其进行自定义。

对于亮点，请进入窗格`Highlighting`。

# ruby - 如何使用我的 gemspec 移除另一个宝石

> ID：10249369
> 
> 赞同：1
> 
> 时间：2012-04-20T15:47:30.623
> 
> 标签：ruby, rubygems

我们有一个 gem`foo`曾经依赖于我们的另一个 gem `bar`。但现在我们已经将`bar`代码直接拉入`foo`.

`bar`下次我们的用户升级时是否可以删除 gem `foo`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T14:00:22.437

我似乎找到了一个快速而肮脏的解决方案，类似于[添加条件安装时间 deps](https://stackoverflow.com/a/10249133/309514)。不幸的是，我还没有弄清楚如何告诉用户，因为`gem`除非用户指定详细，否则会压缩扩展输出。

在 ext/mkrf_conf.rb 中，我添加了：

```
require 'rubygems'
require 'rubygems/uninstaller.rb'
begin
  gem = Gem::Specification.find_by_name('other_gem');
  Gem::Uninstaller.new('other_gem').uninstall
rescue Gem::LoadError
end 
```

# spring-mvc - spring mvs vs jax-rs 休息

> ID：10249370
> 
> 赞同：5
> 
> 时间：2012-04-20T15:47:34.730
> 
> 标签：spring-mvc, jax-rs

为什么我应该选择 jax-rs (jersey) 而不是 Spring-mvc 来实现其余的任何原因。

除了像 aop 、 security 、 ioc 等那样的 rest 之外，Spring 还带有其他特性。你从春天得到了你所需要的一切。

选择弹簧的任何性能/功能缺点（我怀疑）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:57:50.923

JAX-RS 优点：

1.  JSR 标准
2.  可以在没有 servlet 容器的情况下运行 (grizzly, simple, ...)
3.  生产就绪的实现（jersey、cxf、resteasy、restlet，...）
4.  专为 REST 应用程序设计

Spring MVC 优点：

1.  提供“完整”堆栈，而不仅仅是 REST 设施
2.  依赖注入/AOP/事务
3.  可插入视图模板（JSP、freemarker、velocity，...）

我从来没有注意到一个或另一个的性能瓶颈，除了弹簧应用程序需要更长的时间来部署和预热。

# com - C# COM 互操作返回 null 的对象导致 0x800A01A8 需要对象

> ID：10249373
> 
> 赞同：2
> 
> 时间：2012-04-20T15:47:40.320
> 
> 标签：com, vbscript, null, nothing

我正在编写返回对象的 COM 包装器，如果该对象不存在，则返回 null。从 VBScript 调用时，返回 null 会引发错误“所需对象：'ComObj.Prop2'”代码 800A01A8...

C＃

```
public class testCOM
{
    public object Func(int i)
    {
        if (i == 1) return new object();
        if (i == 2) return DBNull.Value;
        return null;
    }
} 
```

VBScript

```
set ComObj = CreateObject("ClassLibrary1.testCOM")

set TestObj = ComObj.Func(1) 'This Works
set TestObj = ComObj.Func(2) 'Throws "Object required: 'ComObj.Func(...)'" Code 800A01A8
set TestObj = ComObj.Func(3) 'Throws "Object required: 'ComObj.Func(...)'" Code 800A01A8
set TestObj = Nothing        'This is what I want to occur with Func(2) and Func(3) 
```

我尝试返回 DBNull.Value，它应该编组为 VT_NULL，但没有运气......

我真的不想用 .HasValue 和 .Value 编写类似于 Nullabe<> 的包装器对象......我不喜欢的另一个选择是创建一个 Nothing 对象（在没有命名空间内），所以我可以这样做：

```
If TestObj Is Nothing And TestObj = "Nothing" Then
    'TestObj was nothing or "Nothing"
End If 
```

如果我使用 Nothing 对象，那么我的 COM 对象必须重新输入 Object 类型而不是预期的类型化对象，这使得代码更难阅读，尽管在功能上与我的目的相同。

通过 COM 将空对象返回给 VBScript 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T05:50:49.477

添加 MarshalAs 有助于：

```
[return:MarshalAs(UnmanagedType.IDispatch)]
public object Func(int i)
{
    if (i == 1) return new object();
    if (i == 2) return DBNull.Value;
    return null;
} 
```

我不确定为什么。如果你有一个接口，那么这个属性应该应用于接口级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T01:07:34.853

检查界面中的签名并确保它是正确的。如果我执行以下操作：

```
public object test(int i) {
    object retval = null;
    if (i == 1) {
        retval = new Object();
    } else if (i == 2) {
        retval = DBNull.Value;
    }
    return retval;
} 
```

具有以下接口签名：

```
[DispId(1001)]
object test(int i); 
```

然后，在 VBScript 中，执行：

```
' myObject is my instantiated COM class
WScript.Echo TypeName(myObject.test(1))
WScript.Echo TypeName(myObject.test(2))
WScript.Echo TypeName(myObject.test(3)) 
```

我回来了：

```
Object
Null
Empty 
```

# java - Liquibase 自动回滚

> ID：10249374
> 
> 赞同：1
> 
> 时间：2012-04-20T15:47:40.967
> 
> 标签：java, liquibase

我正在处理一个分支，例如需要删除表 X 中的一列，我添加了一个更改并且它对那个特定的分支有好处，然后我切换到另一个仍然需要该列并且需要回滚该更改的分支. 数据库有很多变化，例如从一个分支到另一个分支。

我为每个分支添加一个新的变更日志 xml，并将其包含在主变更日志 xml 中。显然，当我切换到另一个分支时，前一个分支的 changlog xml 不再在工作区中，并且 liquibase 不会将实际的变更集保存在数据库中，只保存它的名称和应用它的时间，因此它将无法回滚更改自动地。

我正在使用 Liquibase Servlet 在我的应用程序启动时应用更改。

Liquibase 专家，是否有一个简单的解决方案已经实现了这个问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T17:09:47.810

跨代码分支共享单个数据库实例很困难。如果您尝试在多个开发人员之间共享数据库，它会导致相同类型的问题。

Liquibase 旨在使用基于文件的变更集作为数据库变更的主记录。特殊表 DATABASECHANGELOG 旨在跟踪哪些变更集已应用于数据库实例。在分支之间切换会以许多不可预知的方式导致混乱，例如：

*   缺少变更集
*   内容已更改的变更集（导致校验和错误）。
*   ...

最好的建议是在分支之间切换时刷新或重新同步数据库：

```
liquibase dropAll
liquibase update 
```

在您的情况下，第二个操作可能是不必要的，因为 liquibase servlet 会在启动时更新数据库。

如果您担心丢失数据，请使用[上下文](http://www.liquibase.org/documentation/contexts.html)来控制测试数据。

# 更新

如果您使用 Maven，则可以从 Maven 调用此“重新同步”操作，如下所示：

```
mvn -Presync compile 
```

此配置文件在您的 POM 中配置如下：

```
 <profile>
        <id>resync</id>
        <build>
            <plugins>
                <plugin>
                    <groupId>org.liquibase</groupId>
                    <artifactId>liquibase-maven-plugin</artifactId>
                    <version>${liquibase.plugin.version}</version>
                    <executions>
                        <execution>
                            <phase>process-resources</phase>
                            <configuration>
                                <url>${liquibase.url}</url>
                                <driver>${liquibase.driver}</driver>
                                <username>${liquibase.username}</username>
                                <password>${liquibase.password}</password>
                                <changeLogFile>${liquibase.changeLogFile}</changeLogFile>
                                <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                            </configuration>
                            <goals>
                                <goal>dropAll</goal>
                                <goal>update</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile> 
```

# ios - 后台线程上的 NSURLConnection 委托方法

> ID：10249377
> 
> 赞同：4
> 
> 时间：2012-04-20T15:47:46.677
> 
> 标签：ios, nsurlconnection, selector, grand-central-dispatch, sudzc

**EDIT2 - 重写了问题**

我想在后台进行一些 Web 服务通信。我使用[Sudzc](http://sudzc.com/)作为 HTTPRequests 的处理程序，它的工作方式如下：

```
SudzcWS *service = [[SudzcWS alloc] init];
[service sendOrders:self withXML:@"my xml here" action:@selector(handleOrderSending:)];
[service release]; 
```

它将一些 XML 发送到 web 服务，并且响应（在这个，一个布尔值）在指定的选择器中处理：

```
- (void)handleOrderSending:(id)value
{ 
//some controls  
    if ([value boolValue] == YES)
    {
        //my stuff
    }
} 
```

当我尝试在我的`sendOrders:withXML:action:`方法上使用 Grand Central Dispatch 时，我注意到选择器没有被调用。我相信这样做的原因是**NSURLConnection 委托消息被发送到创建连接**的线程但是线程并没有活那么久，它在方法完成时结束，杀死任何发送给委托的消息。

问候

**EDIT1** `[request send]`方法：

```
- (void) send {
//dispatch_async(backgroundQueue, ^(void){
    // If we don't have a handler, create a default one
    if(handler == nil) {
        handler = [[SoapHandler alloc] init];
    }

    // Make sure the network is available
    if([SoapReachability connectedToNetwork] == NO) {
        NSError* error = [NSError errorWithDomain:@"SudzC" code:400 userInfo:[NSDictionary dictionaryWithObject:@"The network is not available" forKey:NSLocalizedDescriptionKey]];
        [self handleError: error];
    }

    // Make sure we can reach the host
    if([SoapReachability hostAvailable:url.host] == NO) {
        NSError* error = [NSError errorWithDomain:@"SudzC" code:410 userInfo:[NSDictionary dictionaryWithObject:@"The host is not available" forKey:NSLocalizedDescriptionKey]];
        [self handleError: error];
    }

    // Output the URL if logging is enabled
    if(logging) {
        NSLog(@"Loading: %@", url.absoluteString);
    }

    // Create the request
    NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL: url];
    if(soapAction != nil) {
        [request addValue: soapAction forHTTPHeaderField: @"SOAPAction"];
    }
    if(postData != nil) {
        [request setHTTPMethod: @"POST"];
        [request addValue: @"text/xml; charset=utf-8" forHTTPHeaderField: @"Content-Type"];
        [request setHTTPBody: [postData dataUsingEncoding: NSUTF8StringEncoding]];

        if(self.logging) {
            NSLog(@"%@", postData);
        }
    }

    //dispatch_async(dispatch_get_main_queue(), ^(void){
        // Create the connection
        conn = [[NSURLConnection alloc] initWithRequest: request delegate: self];
        if(conn) {
                                        NSLog(@" POST DATA %@", receivedData);
            receivedData = [[NSMutableData data] retain];
                        NSLog(@" POST DATA %@", receivedData);
        } else {
            // We will want to call the onerror method selector here...
            if(self.handler != nil) {
                NSError* error = [NSError errorWithDomain:@"SoapRequest" code:404 userInfo: [NSDictionary dictionaryWithObjectsAndKeys: @"Could not create connection", NSLocalizedDescriptionKey,nil]];
                [self handleError: error];
            }
        }
    //});

    //finished = NO;

    //    while(!finished) {
    //        
    //        [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];
    //        
    //    }

//});
} 
```

被注释掉的部分是我尝试过的各种东西。最后一部分有效，但我不确定这是否是一个好方法。在`NURLConnection`类的委托方法中，会发生以下情况：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
NSError* error;
if(self.logging == YES) {
    NSString* response = [[NSString alloc] initWithData: self.receivedData     encoding: NSUTF8StringEncoding];
    NSLog(@"%@", response);
    [response release];
}

CXMLDocument* doc = [[CXMLDocument alloc] initWithData: self.receivedData options: 0 error: &error];
if(doc == nil) {
    [self handleError:error];
    return;
}

id output = nil;
SoapFault* fault = [SoapFault faultWithXMLDocument: doc];

if([fault hasFault]) {
    if(self.action == nil) {
        [self handleFault: fault];
    } else {
        if(self.handler != nil && [self.handler respondsToSelector: self.action]) {

                [self.handler performSelector: self.action withObject: fault];

        } else {
            NSLog(@"SOAP Fault: %@", fault);
        }
    }
} else {
    CXMLNode* element = [[Soap getNode: [doc rootElement] withName: @"Body"] childAtIndex:0];
    if(deserializeTo == nil) {
        output = [Soap deserialize:element];
    } else {
        if([deserializeTo respondsToSelector: @selector(initWithNode:)]) {
            element = [element childAtIndex:0];
            output = [deserializeTo initWithNode: element];
        } else {
            NSString* value = [[[element childAtIndex:0] childAtIndex:0] stringValue];
            output = [Soap convert: value toType: deserializeTo];
        }
    }

    if(self.action == nil) { self.action = @selector(onload:); }
    if(self.handler != nil && [self.handler respondsToSelector: self.action]) {

            [self.handler performSelector: self.action withObject: output];

    } else if(self.defaultHandler != nil && [self.defaultHandler respondsToSelector:@selector(onload:)]) {
        [self.defaultHandler onload:output];
    }
}

[self.handler release];
[doc release];
[conn release];
conn = nil;
[self.receivedData release];
} 
```

委托无法发送消息，因为它所在的线程在`-(void)send`完成时会死掉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T11:52:21.527

的方法定义`sendOrders`表明它已经设计为以异步方式执行请求。您应该查看 的实现`sendOrders: withXML: action:`以了解是否是这种情况。

如果没有看到您使用 GCD 或来自 SudzcWS 的代码的实现，很难说出了什么问题。尽管有上述警告，但以下内容可能有用。

看起来你可能会`SudzcWS *service`在它完成之前发布。

以下：

```
SudzcWS *service = [[SudzcWS alloc] init];
dispatch_async(aQueue, ^{
    [sevice sendOrders:self withXML:xml action:@selector(handleOrderSending:)];
}
[service release]; 
```

除非 SudzcWS 保留自己，否则可能会失败。您异步调度您的块，它被放入队列中，然后继续执行该方法。在块执行之前或等待来自网络服务器的响应`service`时被释放并被释放。`service`

除非另有说明，否则调用选择器将在调用它的同一线程上执行该选择器。做类似的事情：

```
SudzcWS *service = [[SudzcWS alloc] init];
dispatch_async(aQueue, ^{
    [sevice sendOrders:self withXML:xml action:@selector(handleOrderSending:)];
}

- (void)handleOrderSending:(id)value
{ 
    //some controls  
    //your stuff
    [service release];
} 
```

应该确保`sendOrders:`方法和方法`handleOrderSending:`都在队列上执行，`aQueue`并且`service`在执行选择器之前不会被释放。

这将要求您保留一个指向`service`以便`handleOrderSending:`可以释放它的指针。您可能还想考虑简单地挂在单个 SudzcWS 实例上，而不是每次要使用它时都创建和释放一个，这应该会使您的内存管理更加容易，并有助于保持您的对象图紧凑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T13:57:21.443

我从这些链接[SO NURLConnection 问题](https://stackoverflow.com/questions/3234054/does-nsurlconnection-block-the-main-ui-thread)和[原始](http://www.wim.me/nsurlconnection-in-its-own-thread/)链接中都得到了帮助。

我的代码似乎没有风险，我将自担风险使用它。谢谢。

当然，仍然欢迎任何建议。

还要感谢 Pingbat 花时间尝试和帮助。

# algorithm - 埃拉托色尼的分段筛？

> ID：10249378
> 
> 赞同：41
> 
> 时间：2012-04-20T15:47:49.447
> 
> 标签：algorithm, primes, sieve-of-eratosthenes, prime-factoring, factors

制作一个简单的筛子很容易：

```
for (int i=2; i<=N; i++){
    if (sieve[i]==0){
        cout << i << " is prime" << endl;
        for (int j = i; j<=N; j+=i){
            sieve[j]=1;
        }
    }
    cout << i << " has " << sieve[i] << " distinct prime factors\n";
} 
```

但是当 N 非常大并且我不能在内存中保存那种数组时呢？我查找了分段筛方法，它们似乎涉及在 sqrt(N) 之前找到素数，但我不明白它是如何工作的。如果 N 非常大（比如 10^18）怎么办？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-20T16:15:54.853

*分段筛的基本思想是选择小于n*的平方根的筛分素数，选择一个相当大但仍适合内存的片段大小，然后依次筛选每个片段，从最小的片段开始。在第一段，计算段内每个筛素的最小倍数，然后以正常方式将筛素的倍数标记为合数；当所有的筛选素数都用完后，该段中剩余的未标记数是素数。然后，对于下一个片段，对于每个筛分素数，您已经知道当前片段中的第一个倍数（它是结束前片段中那个素数的筛分的倍数），所以您在每个筛分素数上进行筛分，依此类推直到你完成。

*n*的大小无关紧要，只是较大的*n比较小的**n*需要更长的筛分时间；重要的是段的大小，它应该尽可能大（例如，机器上主内存缓存的大小）。

[您可以在此处查看](http://programmingpraxis.com/2010/02/05/segmented-sieve-of-eratosthenes/)分段筛的简单实现。请注意，分段筛将比另一个答案中提到的 O'Neill 的优先队列筛快得多；如果你有兴趣，这里有一个[实现](http://programmingpraxis.com/2011/10/14/the-first-n-primes/)。

**编辑：**我写这个是为了不同的目的，但我会在这里展示它，因为它可能有用：

尽管埃拉托色尼筛法非常快，但它需要 O(n) 空间。通过在连续的段中执行筛选，这可以减少到筛选素数的 O(sqrt(n)) 加上位数组的 O(1)。在第一段，计算段内每个筛素的最小倍数，然后以正常方式将筛素的倍数标记为合数；当所有的筛选素数都用完后，该段中剩余的未标记数是素数。然后，对于下一段，每个筛分素数的最小倍数是在前一段中结束筛分的倍数，因此筛分一直持续到完成。

考虑在 20 段中从 100 到 200 筛分的示例。五个筛分素数是 3、5、7、11 和 13。在从 100 到 120 的第一段中，位数组有十个槽，槽 0 对应于 101 ，slot k对应100+2k+1，slot 9对应119。segment中3的最小倍数是105，对应slot 2；槽 2+3=5 和 5+3=8 也是 3 的倍数。槽 2 处 5 的最小倍数是 105，槽 2+5=7 也是 5 的倍数。7 的最小倍数是 105在插槽 2 处，插槽 2+7=9 也是 7 的倍数。以此类推。

函数 primesRange 接受参数 lo、hi 和 delta；lo 和 hi 必须是偶数，lo < hi，并且 lo 必须大于 sqrt(hi)。段大小是 delta 的两倍。Ps 是一个链表，其中包含小于 sqrt(hi) 的筛选素数，由于偶数被忽略，因此删除了 2。Qs 是一个链表，包含在相应筛选素数的当前段中的最小倍数的筛位数组中的offest。在每个段之后，lo 前进两倍 delta，因此筛位数组的索引 i 对应的数字是 lo + 2i + 1。

```
function primesRange(lo, hi, delta)
    function qInit(p)
        return (-1/2 * (lo + p + 1)) % p
    function qReset(p, q)
        return (q - delta) % p
    sieve := makeArray(0..delta-1)
    ps := tail(primes(sqrt(hi)))
    qs := map(qInit, ps)
    while lo < hi
        for i from 0 to delta-1
            sieve[i] := True
        for p,q in ps,qs
            for i from q to delta step p
                sieve[i] := False
        qs := map(qReset, ps, qs)
        for i,t from 0,lo+1 to delta-1,hi step 1,2
            if sieve[i]
                output t
        lo := lo + 2 * delta 
```

当调用 primesRange(100, 200, 10) 时，筛选素数 ps 为 [3, 5, 7, 11, 13]；qs 最初是 [2, 2, 2, 10, 8] 对应于最小的倍数 105, 105, 105, 121 和 117，并且对于第二段重置为 [1, 2, 6, 0, 11] 对应于最小123、125、133、121 和 143 的倍数。

您可以在以下位置查看此程序的运行情况[http://ideone.com/iHYr1f](http://ideone.com/iHYr1f)。除了上面显示的链接之外，如果您对使用素数进行编程感兴趣，我会在我的博客上谦虚地推荐这篇[文章。](http://programmingpraxis.com)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T15:53:22.913

有一个基于优先级队列的 Sieve 版本，可以根据您的要求产生尽可能多的素数，而不是所有素数都达到上限。它在经典论文[“The Genuine Sieve of Eratosthenes”](http://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf)中进行了讨论，谷歌搜索“eratosthenes 优先队列的筛子”在各种编程语言中出现了相当多的实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-28T06:38:54.897

只是我们正在用我们拥有的筛子进行分段。基本思想是假设我们必须找出 85 到 100 之间的素数。我们必须应用传统的筛子，但采用如下所述的方式：

所以我们取第一个素数 2 ，将起始数字除以 2(85/2) 并取整到较小的数字我们得到 p=42，现在再次乘以 2 我们得到 p=84，从这里开始添加 2直到最后一个数字。所以我们所做的是我们已经删除了范围内的所有因素 2(86,88,90,92,94,96,98,100)。

我们取下一个素数 3，将起始数除以 3(85/3)，然后四舍五入到较小的数，得到 p=28，现在再次乘以 3，得到 p=84，从这里开始加 3 直到最后一个数字。所以我们所做的是我们已经删除了范围内的所有因素 3(87,90,93,96,99)。

取下一个素数=5 以此类推......继续做上述步骤。你可以得到素数（2,3,5,7, ...）通过使用传统的筛子达到 sqrt(n)。然后将其用于分段筛子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-30T16:11:40.070

如果有人想看 C++ 实现，这里是我的：

```
void sito_delta( int delta, std::vector<int> &res)
{

std::unique_ptr<int[]> results(new int[delta+1]);
for(int i = 0; i <= delta; ++i)
    results[i] = 1;

int pierw = sqrt(delta);
for (int j = 2; j <= pierw; ++j)
{
    if(results[j])
    {
        for (int k = 2*j; k <= delta; k+=j)
        {
            results[k]=0;
        }
    }
}

for (int m = 2; m <= delta; ++m)
    if (results[m])
    {
        res.push_back(m);
        std::cout<<","<<m;
    }
};
void sito_segment(int n,std::vector<int> &fiPri)
{
int delta = sqrt(n);

if (delta>10)
{
    sito_segment(delta,fiPri);
   // COmpute using fiPri as primes
   // n=n,prime = fiPri;
      std::vector<int> prime=fiPri;
      int offset = delta;
      int low = offset;
      int high = offset * 2;
      while (low < n)
      {
          if (high >=n ) high = n;
          int mark[offset+1];
          for (int s=0;s<=offset;++s)
              mark[s]=1;

          for(int j = 0; j< prime.size(); ++j)
          {
            int lowMinimum = (low/prime[j]) * prime[j];
            if(lowMinimum < low)
                lowMinimum += prime[j];

            for(int k = lowMinimum; k<=high;k+=prime[j])
                mark[k-low]=0;
          }

          for(int i = low; i <= high; i++)
              if(mark[i-low])
              {
                fiPri.push_back(i);
                std::cout<<","<<i;
              }
          low=low+offset;
          high=high+offset;
      }
}
else
{

std::vector<int> prime;
sito_delta(delta, prime);
//
fiPri = prime;
//
int offset = delta;
int low = offset;
int high = offset * 2;
// Process segments one by one 
while (low < n)
{
    if (high >= n) high = n;
    int  mark[offset+1];
    for (int s = 0; s <= offset; ++s)
        mark[s] = 1;

    for (int j = 0; j < prime.size(); ++j)
    {
        // find the minimum number in [low..high] that is
        // multiple of prime[i] (divisible by prime[j])
        int lowMinimum = (low/prime[j]) * prime[j];
        if(lowMinimum < low)
            lowMinimum += prime[j];

        //Mark multiples of prime[i] in [low..high]
        for (int k = lowMinimum; k <= high; k+=prime[j])
            mark[k-low] = 0;
    }

    for (int i = low; i <= high; i++)
        if(mark[i-low])
        {
            fiPri.push_back(i);
            std::cout<<","<<i;
        }
    low = low + offset;
    high = high + offset;
}
}
};

int main()
{
std::vector<int> fiPri;
sito_segment(1013,fiPri);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-11T12:53:40.257

基于 Swapnil Kumar 的回答，我用 C 语言做了以下算法。它是用 mingw32-make.exe 构建的。

```
#include<math.h>
#include<stdio.h>
#include<stdlib.h>

int main()
{
    const int MAX_PRIME_NUMBERS = 5000000;//The number of prime numbers we are looking for
    long long *prime_numbers = malloc(sizeof(long long) * MAX_PRIME_NUMBERS);
    prime_numbers[0] = 2;
    prime_numbers[1] = 3;
    prime_numbers[2] = 5;
    prime_numbers[3] = 7;
    prime_numbers[4] = 11;
    prime_numbers[5] = 13;
    prime_numbers[6] = 17;
    prime_numbers[7] = 19;
    prime_numbers[8] = 23;
    prime_numbers[9] = 29;
    const int BUFFER_POSSIBLE_PRIMES = 29 * 29;//Because the greatest prime number we have is 29 in the 10th position so I started with a block of 841 numbers
    int qt_calculated_primes = 10;//10 because we initialized the array with the ten first primes
    int possible_primes[BUFFER_POSSIBLE_PRIMES];//Will store the booleans to check valid primes
    long long iteration = 0;//Used as multiplier to the range of the buffer possible_primes
    int i;//Simple counter for loops
    while(qt_calculated_primes < MAX_PRIME_NUMBERS)
    {
        for (i = 0; i < BUFFER_POSSIBLE_PRIMES; i++)
            possible_primes[i] = 1;//set the number as prime

        int biggest_possible_prime = sqrt((iteration + 1) * BUFFER_POSSIBLE_PRIMES);

        int k = 0;

        long long prime = prime_numbers[k];//First prime to be used in the check

        while (prime <= biggest_possible_prime)//We don't need to check primes bigger than the square root
        {
            for (i = 0; i < BUFFER_POSSIBLE_PRIMES; i++)
                if ((iteration * BUFFER_POSSIBLE_PRIMES + i) % prime == 0)
                    possible_primes[i] = 0;

            if (++k == qt_calculated_primes)
                break;

            prime = prime_numbers[k];
        }
        for (i = 0; i < BUFFER_POSSIBLE_PRIMES; i++)
            if (possible_primes[i])
            {
                if ((qt_calculated_primes < MAX_PRIME_NUMBERS) && ((iteration * BUFFER_POSSIBLE_PRIMES + i) != 1))
                {
                    prime_numbers[qt_calculated_primes] = iteration * BUFFER_POSSIBLE_PRIMES + i;
                    printf("%d\n", prime_numbers[qt_calculated_primes]);
                    qt_calculated_primes++;
                } else if (!(qt_calculated_primes < MAX_PRIME_NUMBERS))
                    break;
            }

        iteration++;
    }

    return 0;
} 
```

它设置要找到的最大素数，然后用已知的素数（如 2、3、5...29）初始化一个数组。所以我们创建一个缓冲区来存储可能的素数段，这个缓冲区不能大于最大初始素数的幂，在这种情况下是 29。

我确信可以进行大量优化来提高性能，例如并行化段分析过程和跳过 2、3 和 5 的倍数的数字，但它可以作为低内存消耗的示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-17T12:49:23.633

**一个数是素数，如果没有一个较小的素数能整除它。由于我们按顺序遍历素数，我们已经将所有可以被至少一个素数整除的数字标记为可整除。因此，如果我们到达一个单元格并且它没有被标记，那么它就不能被任何更小的素数整除，因此它必须是素数。**

**请记住以下几点：-**

```
// Generating all prime number up to  R

// creating an array of size (R-L-1) set all elements to be true: prime && false: composite

#include<bits/stdc++.h>

using namespace std;

#define MAX 100001

vector<int>* sieve(){
    bool isPrime[MAX];

    for(int i=0;i<MAX;i++){
        isPrime[i]=true;
    }
 for(int i=2;i*i<MAX;i++){
     if(isPrime[i]){
         for(int j=i*i;j<MAX;j+=i){
             isPrime[j]=false;
         }
     }
 }

 vector<int>* primes = new vector<int>();
 primes->push_back(2);
 for(int i=3;i<MAX;i+=2){
     if(isPrime[i]){
     primes->push_back(i);
     }
}

 return primes;
}

void printPrimes(long long l, long long r, vector<int>*&primes){
      bool isprimes[r-l+1];
      for(int i=0;i<=r-l;i++){
          isprimes[i]=true;
      }

      for(int i=0;primes->at(i)*(long long)primes->at(i)<=r;i++){

          int currPrimes=primes->at(i);
          //just smaller or equal value to l
          long long base =(l/(currPrimes))*(currPrimes);

          if(base<l){
              base=base+currPrimes;
          }

    //mark all multiplies within L to R as false

          for(long long j=base;j<=r;j+=currPrimes){
              isprimes[j-l]=false;
          }

   //there may be a case where base is itself a prime number

          if(base==currPrimes){
              isprimes[base-l]= true;
          }
    }

          for(int i=0;i<=r-l;i++){
              if(isprimes[i]==true){
                  cout<<i+l<<endl;
              }

      }
}
int main(){
    vector<int>* primes=sieve();

   int t;
   cin>>t;
   while(t--){
       long long l,r;
       cin>>l>>r;
       printPrimes(l,r,primes);
   }

    return 0;

} 
```

# android - 谷歌地图 NoClassDefFoundError

> ID：10249382
> 
> 赞同：0
> 
> 时间：2012-04-20T15:48:05.357
> 
> 标签：android, google-maps

我正在开发一个 android 项目，其中一项活动包括地图视图。我只是在完成显示简单谷歌地图的代码之后，但我遇到了这个 NoClassDefFoundError。我检查了一些类似的问题并尝试了建议的解决方案，但仍然无法正常工作。我已经在清单文件和应用程序的用户库中激活了 Internet 权限。有没有人对可能是什么问题有任何建议？这是活动代码：

```
package com.mad.mylit;
import android.os.Bundle;

import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

public class LocationsActivity extends MapActivity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.location);
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

这是我的清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.mad.mylit"
    android:versionCode="1"
    android:versionName="1.0" android:installLocation="auto">

    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name" >
        <uses-library android:name="com.google.android.maps"/>
        <activity
            android:name=".MyLitActivity"
            android:label="@string/app_name"
            >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".MapsActivity"></activity>
        <activity android:name=".MyProfileActivity"></activity>
        <activity android:name=".BusActivity"></activity>
        <activity android:name=".EventsActivity"></activity>
        <activity android:name=".LocationsActivity"></activity>
        <activity android:name=".NotesActivity"></activity>
        <activity android:name=".TimetableActivity"></activity>
        <activity android:name=".MondayActivity"></activity>
        <activity android:name=".TuesdayActivity"></activity>
        <activity android:name=".WednesdayActivity"></activity>
        <activity android:name=".ThursdayActivity"></activity>
        <activity android:name=".FridayActivity"></activity>
        <activity android:name=".CaherdavinActivity"></activity>
        <activity android:name=".RaheenActivity"></activity>
        <activity android:name=".UniversityActivity"></activity>
        <activity android:name=".SplashScreen"
              android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application> 
```

所有活动都在同一个包中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T09:01:31.430

您最近更新了 ADT 插件吗？

[这里](https://stackoverflow.com/questions/2247998/noclassdeffounderror-eclipse-and-android)和[这里](https://stackoverflow.com/questions/2456562/approach-for-fixing-noclassdeffounderror)有一些关于相同问题的讨论..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:19:39.267

尝试使用您的个人密钥库获取新的地图 API 密钥。

# ruby-on-rails - Rails 中相同的命名空间但不同的控制器和视图

> ID：10249391
> 
> 赞同：3
> 
> 时间：2012-04-20T15:48:24.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller, rest, routes

我有一个案例需要`localhost:3000/dashboard`根据用户类型指向不同的视图/控制器组合。我的应用程序中的两种主要类型是`Subscriber`和`Publisher`。

当`Publisher`登录并转到`/dashboard`我需要显示发布者仪表板时。

当`Subscriber`登录并转到`/dashboard`我需要显示订阅者仪表板时。

此时发布者的仪表板被调用`Dashboard`，订阅者的仪表板被调用`Profile`。在我看来有点脏。

问题是。调用正确的控制器、加载正确的数据并根据特定用户的类型呈现正确的模板/布局的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:05:22.397

我会考虑类似下面的伪代码来帮助您入门。

控制器：

```
app/controllers/dashboard_controller.rb

class Dashboard < ApplicationController

def index      
  render, :user_type => current_user.user_type
end 
```

查看：（使用助手更改将显示的内容）。

```
views/dashboards/index.html.erb

# display the content 
```

帮手。

```
helpers/dashboard_helper.rb
module DashboardHelper(user_type)
if user_type == 'publisher'
  #set content / variables for publisher
elsif user_type == 'Subscriber'
  #set content / variables for subscriber
else
  set content/variables to default.
end 
```

# java - 编组一个 java.util.Map

> ID：10249398
> 
> 赞同：5
> 
> 时间：2012-04-20T15:49:10.753
> 
> 标签：java, xml, jaxb, cxf, jax-rs

我的宁静 JSON 服务的下一个问题。

```
import java.util.Map;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlRootElement;

/**
 * @author Martin Burchard
 * 
 */
@XmlRootElement(name = "user")
@XmlAccessorType(XmlAccessType.FIELD)
public class User {
    private String id;
    private String nickname;
    private String email;
    private String password;
    private Map<String, String> user_attributes;

} 
```

目前，该服务提供以下 JSON（为了更好地阅读而缩进）：

```
{
    "user" : {
        "id" : "9bdf40ea-6d25-4bc3-94ad-4a3d38d2c3ca",
        "email" : "test.user@test.de",
        "password" : "xXpd9Pl-1pFBFuX9E0hAYGSDTyJQPYkOtXGvRCrEtMM",
        "user_attributes" : {
            "entry" : [{
                    "key" : "num",
                    "value" : 123
                }, {
                    "key" : "type",
                    "value" : "nix"
                }
            ]
        }
    }
} 
```

有趣的是，内部 num 123 是一个 java.lang.String ...

我不明白这里解释了什么[http://cxf.apache.org/docs/jax-rs-data-bindings.html#JAX-RSDataBindings-DealingwithJSONarrayserializationissues](http://cxf.apache.org/docs/jax-rs-data-bindings.html#JAX-RSDataBindings-DealingwithJSONarrayserializationissues)

我喜欢这个 JSON：

```
{
    "user" : {
        "id" : "9bdf40ea-6d25-4bc3-94ad-4a3d38d2c3ca",
        "email" : "test.user@test.de",
        "password" : "xXpd9Pl-1pFBFuX9E0hAYGSDTyJQPYkOtXGvRCrEtMM",
        "user_attributes" : {
            "num" : "123",
            "type" : "nix"
        }
    }
} 
```

我将 JSON 提供程序更改为 Jackson。现在我的 JSON 看起来我喜欢它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T20:01:29.237

我唯一想到的是使用 JAXB XmlAdapter。您可以定义给定对象（在您的情况下为 Map）如何映射到 JSON 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T17:55:13.470

使用适当的 JSON 库，例如[Jackson](http://jackson.codehaus.org/)

# python - 偷看 MSMQ 消息后出现的额外字符

> ID：10249402
> 
> 赞同：0
> 
> 时间：2012-04-20T15:49:20.517
> 
> 标签：python, msmq

我正在升级旧系统，即使用 Biztalk、MSMQs、Java 和 python。

目前我正在尝试升级项目的一个特定部分，完成后将允许我开始就地替换许多 hte Legacy 系统。

因此，到目前为止，我所做的是在较新版本的 Biztalk (2010) 和尚未结束的机器上重新创建 Legacy 系统。

无论如何，我遇到的问题是，有一段 Python 代码从 MSMQ 获取消息并将其放置在另一台服务器上。这段代码自 2004 年以来一直在我们的遗留系统中使用，并且从那时起一直有效，据我所知从未更改过。

现在，当我重建它时，我开始在远程服务器中遇到错误，在检查了一些事情并消除了许多可能的问题之后，我确定错误发生在 Python 代码从 MSMQ 获取的时间附近。

错误示例：仅使用 2 条消息即可创建错误。请注意，我在这里使用示例 XMls，因为实际的 XMls 很长。

留言一：

> ```
> <xml>
> <field1>Text 1</field1>
> <field2>Text 2</field2>
> </xml> 
> ```

留言二：

> ```
> <xml>
> <field1>Text 1</field1>
> </xml> 
> ```

现在，如果我向 MSMQ 提交消息一，然后是消息二，它们都正确显示在队列中。如果我然后调用 Python 脚本消息 1 正确返回，但消息 2 获得额外的字符示例 post python Message2

```
<xml>
<field1>Text 1</field1>
</xml>1>Te 
```

我虽然起初可能在 Python 代码中存在范围界定问题，但我已经尽可能地解决了这个问题，但没有发现任何问题，但是我必须承认，我第一次认真研究 Python 代码是这个项目。

Pyhton 代码首先查看消息，然后接收它。当脚本偷看时，我已经能够看到该消息，并且它具有与接收时相同的错误消息。

此外，此错误仅在将较长消息转换为较短消息时才会出现。

我欢迎任何关于可能错误的事情的建议，或者我可以做些什么来确定问题。

我用谷歌搜索和搜索，有点疯狂。这阻碍了整个项目，因为我们不能开始用这块替换旧系统来充当新的桥梁。

感谢您花时间阅读我的问题

编辑以添加相关 Python 代码 MSMQ.py

```
import sys

import pythoncom
from win32com.client import gencache
msmq = gencache.EnsureModule('{D7D6E071-DCCD-11D0-AA4B-0060970DEBAE}', 0, 1, 0)

def Peek(queue):
    qi = msmq.MSMQQueueInfo()
    qi.PathName = queue

    myq = qi.Open(msmq.constants.MQ_PEEK_ACCESS,0)
    if myq.IsOpen:
        # Don't loose this pythoncom.Empty thing (it took a while)
        tmp = myq.Peek(pythoncom.Empty, pythoncom.Empty, 1)
    myq.Close()     
    return tmp 
```

这段代码由函数调用。直到星期一我才能访问调用它的代码。但电话基本上是

```
msg= MSMQ.peek() 
```

第 2 次编辑。

我附上脚本的前半部分。这基本上是循环的

```
import base64, xmlrpclib, time
import MSMQ, Config, Logger
import XmlRpcExt,os,whrandom

QueueDetails = Config.InQueueDetails
sleeptime = Config.SleepTime
XMLRPCServer = Config.XMLRPCServer
usingBase64 = Config.base64ing
version=Config.version
verbose=Config.verbose

LogO = Logger.Logger()

def MSMQToIAMS():
        # moved svr cons out of daemon loop
        LogO.LogP(version)
    svr = xmlrpclib.Server(XMLRPCServer, XmlRpcExt.getXmlRpcTransport())
    while 1:
            GotOne = 0
            for qd in QueueDetails:
                    queue, agency, messagetype = qd
                    #LogO.LogD('['+version+"] Searching queue %s for messages"%queue)

                    try:
                            msg=MSMQ.Peek(queue)
                    except Exception,e:
                            LogO.LogE("Peeking at \"%s\" : %s"%(queue, e))
                            continue

                    if msg:
                            try:
                              msg = msg.__call__().encode('utf-8')
                            except:
                              LogO.LogE("Could not convert massege on \"%s\" to a string, leaving it on queue"%queue)
                              continue

                            if verbose:
                              print "++++++++++++++++++++++++++++++++++++++++"
                              print msg
                              print "++++++++++++++++++++++++++++++++++++++++"
                            LogO.LogP("Found Message on \"%s\" : \"%s...\""%(queue, msg[:40]))
                            try:

                                    rv = svr.accept(msg, agency, messagetype)
                                    if rv[0] != "OK":
                                            raise Exception, rv[0]
                                    LogO.LogP('Message has been sent successfully to IAMS from %s'%queue)
                                    MSMQ.Receive(queue)
                                    GotOne = 1
                                    StoreMsg(msg)
                            except Exception, e:
                                    LogO.LogE("%s"%e)

            if GotOne == 0:
                    time.sleep(sleeptime)
            else:
                    gotOne = 0 
```

这是调用 MSMQ 的完整代码。创建一个监视 MSMQ 的小程序，当消息到达时将其拾取并将其发送到另一台服务器。

谢谢/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:20:33.103

听起来确实是 Python 特有的（我对此一无所知），而不是 MSMQ 特有的。这不只是一个内存变量被使用两次而没有被清除的情况吗？第二条消息比第一条消息短，因此第一条消息中的字符不会被覆盖。Python 代码的相关部分是什么样的？

[[4 月 21 日]] 代码只是显示您正在使用消息填充 tmp 变量。在访问下一条消息之前 tmp 会发生什么？我假设它没有被清除。

# iphone - 崩溃石英核心 (creittercism)

> ID：10249404
> 
> 赞同：0
> 
> 时间：2012-04-20T15:49:29.010
> 
> 标签：iphone, objective-c, quartz-core

我在我的 crittercism 仪表板中看到了这个崩溃日志

```
 QuartzCore 0x373d37c4 _ZN2CA5Layer16commit_if_neededEPNS_11TransactionEPFvPS0_jjPvES4_ +   39
1    QuartzCore 0x373d3875 _ZN2CA5Layer16commit_if_neededEPNS_11TransactionEPFvPS0_jjPvES4_ + 216
2    QuartzCore 0x373d773b _ZN2CA7Context11commit_rootEPNS_5LayerEPv + 34
3    QuartzCore 0x373d7717 _ZN2CAL16foreach_callbackEPNS_5LayerES1_Pv + 18
4    QuartzCore 0x373d76ed x_hash_table_foreach + 44
5    QuartzCore 0x373d76bd _ZN2CA11Transaction12foreach_rootEPFvPNS_5LayerEPvES3_ + 32
6    QuartzCore 0x373d1455 _ZN2CA7Context18commit_transactionEPNS_11TransactionE + 1052
7    QuartzCore 0x373d0e57 _ZN2CA11Transaction6commitEv + 314
8    QuartzCore 0x373c8d85 _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 56
9    CoreFoundation 0x37da8b4b __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 18
10   CoreFoundation 0x37da6d87 __CFRunLoopDoObservers + 258
11   CoreFoundation 0x37da70e1 __CFRunLoopRun + 760
12   CoreFoundation 0x37d2a4dd CFRunLoopRunSpecific + 300
13   CoreFoundation 0x37d2a3a5 CFRunLoopRunInMode + 104
14   GraphicsServices 0x37b01fcd GSEventRunModal + 156
15   UIKit 0x318aa743 UIApplicationMain + 1090 
```

并且不知道是什么导致了这个错误，任何有同样问题的人（找到解决方案大声笑）？

# powershell - Powershell v2 :: 加载 COM 互操作 DLL

> ID：10249406
> 
> 赞同：3
> 
> 时间：2012-04-20T15:49:31.830
> 
> 标签：powershell, powershell-2.0

我的系统上有这个 DataLink DLL - **Interop.MSDASC.dll**我正在尝试像这样从 Powershell 加载它 -

```
[Reflection.Assembly]::LoadFile("C:\Interop.MSDASC.dll") | out-null 
```

但是，我收到以下错误 -

```
Exception calling "LoadFile" with "1" argument(s): "Could not load file or assembly 'Interop.MSDASC.dll' or one of its dependencies.  is not a 
valid Win32 application. (Exception from HRESULT: 0x800700C1)"
At line:1 char:32
+ [Reflection.Assembly]::LoadFile <<<< ("C:\Interop.MSDASC.dll") | out-null
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException 
```

如何正确加载它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T08:38:18.943

这是一个 32 位 COM 对象，因此您必须从 PowerShell 的 32 位实例加载它。要在 64 位版本的 Windows 上执行此操作，您可以在以下文件夹中执行 powershell.exe 或 powershell_ISE.exe：%SYSTEMROOT%\SysWow64\windowspowershell\v1.0

而且，这是完整的代码：

```
[Reflection.Assembly]::LoadFile("C:\Interop.MSDASC.dll") 
$dataLinkInstance = new-object MSDASC.DataLinksClass
$dataLinkInstance.WriteStringToStorage("C:\\FrmPowershell.udl", "Provider=SQLOLEDB.1;", 2) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:10:26.907

我刚刚从[http://datadictionary.codeplex.com/](http://datadictionary.codeplex.com/)下载了它，并以与您使用相同的方式加载程序集，没有问题出现：

```
 [System.Reflection.Assembly]::LoadFile( "c:\Program Files\DataDictionaryCreator\Interop.MSDASC.dll")

GAC    Version        Location
---    -------        --------
False  v2.0.50727     c:\Program Files\DataDictionaryCreator\Interop.MSDASC.dll 
```

您可能在 x64 操作系统上吗？如果是，请在此处阅读[http://datadictionary.codeplex.com/workitem/28807](http://datadictionary.codeplex.com/workitem/28807)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-03-10T04:45:07.867

```
$comInterOp = "C\Temp\Interop.YourAssembly.dll"
[System.Reflection.Assembly]::LoadFile($comInterOp)
$yourClassObj = new-object YourAssembly.YourClassNameClass
$yourResult = $yourClassObj.YourMethod() 
```

# asp.net - 您如何使用 Web.config 转换？

> ID：10249413
> 
> 赞同：1
> 
> 时间：2012-04-20T15:50:02.887
> 
> 标签：asp.net, visual-studio-2010, web-config, transformation, slowcheetah

当我创建部署包时发生了`web.config`变化，但我不明白这部分：

我有两个`web.config`转换文件，`web.debug.config`和`web.release.config`.

这些转换文件是否仅在我们进行 Web 部署或部署包时可用或工作？`web.config`当项目从 Visual Studio 本地运行时（例如通过 IIS Express），是否不使用转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T15:52:10.157

你是对的。

部署或运行​​部署包时会应用配置转换。

它们不会在编译时转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:21:55.480

如果您在编译过程中需要转换后的配置文件，您可以通过编辑项目文件 (.csproj) 并添加以下代码来获取它。

```
<Target Name="AfterBuild">
    <TransformXml Source="$(SolutionDir)WCFServices\Web.config" 
                  Transform="$(SolutionDir)WCFServices\Web.Release.config" 
                  Destination="$(OutDir)WebRelease.config" 
                  StackTrace="true" />
</Target> 
```

可以添加多个 TransformXml 标签来获取所有需要的配置文件。此外，这可以在构建之前或之后完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T15:52:12.690

您可以使用 MSBuild 和一个名为 SlowCheetah 的扩展来调用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-03T22:29:12.080

还有一个名为[Configuration Transform](https://visualstudiogallery.msdn.microsoft.com/579d3a78-3bdd-497c-bc21-aa6e6abbc859/)的 VS 扩展对此很有用。**如果您不想安装它，但要实现此目的**，只需按照演示解决方案中显示的示例添加不同的构建配置文件并在项目文件中添加一些新的 MSBuild 任务。[演示解决方案的下载链接](https://onedrive.live.com/?authkey=%21AE6qGnmd99lwsdg&id=C235883F28DBC48C%21139&cid=C235883F28DBC48C)可以在扩展的 Visual Studio Gallery 网页上找到。这种方法不需要任何额外的包，因为 MSBuild 使用 XSLT 进行 XML 转换。

下面是从演示解决方案添加到项目文件中的 MSBuild 任务。就我而言，当我关注它进行 VS2015 ASP.NET MVC 项目时，我不必投入`<UsingTask TaskName="TransformXml" AssemblyFile=...`。

```
 <UsingTask TaskName="TransformXml" AssemblyFile="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)\Web\Microsoft.Web.Publishing.Tasks.dll" />
  <Target Name="AfterCompile" Condition="Exists('App.$(Configuration).config')">
    <!--Generate transformed app config in the intermediate directory-->
    <TransformXml Source="App.config" Destination="$(IntermediateOutputPath)$(TargetFileName).config" Transform="App.$(Configuration).config" />
    <!--Force build process to use the transformed configuration file from now on.-->
    <ItemGroup>
      <AppConfigWithTargetPath Remove="App.config" />
      <AppConfigWithTargetPath Include="$(IntermediateOutputPath)$(TargetFileName).config">
        <TargetPath>$(TargetFileName).config</TargetPath>
      </AppConfigWithTargetPath>
    </ItemGroup>
  </Target>
  <!--Override After Publish to support ClickOnce AfterPublish. Target replaces the untransformed config file copied to the deployment directory with the transformed one.-->
  <Target Name="AfterPublish">
    <PropertyGroup>
      <DeployedConfig>$(_DeploymentApplicationDir)$(TargetName)$(TargetExt).config$(_DeploymentFileMappingExtension)</DeployedConfig>
    </PropertyGroup>
    <!--Publish copies the untransformed App.config to deployment directory so overwrite it-->
    <Copy Condition="Exists('$(DeployedConfig)')" SourceFiles="$(IntermediateOutputPath)$(TargetFileName).config" DestinationFiles="$(DeployedConfig)" />
  </Target> 
```

这是我在 .csproj 文件中应用的方式，非常简单：

```
 <Target Name="AfterBuild" Condition="Exists('Web.$(Configuration).config')">
    <Exec Command="attrib -R Web.config" />
    <TransformXml Source="Web.config" Transform="Web.$(Configuration).config" Destination="Web.config" StackTrace="true" />
  </Target> 
```

在这方面也有一个很好[的帖子](https://mitasoft.wordpress.com/2011/09/28/multipleappconfig/)。

**此外**，对于 web.config 转换，[由于 VS2012](https://stackoverflow.com/questions/13920146/using-msbuild-exe-to-publish-a-asp-net-mvc-4-project-with-the-cmd-line/13947667#13947667)我们可以添加一个发布配置文件 - **Publish.pubxml** ( *ProjectFolder* /Properties/PublishProfiles/Publish.pubxml) 来进行文件系统发布，因此 web.config 转换将默认发生。下面是一个示例

```
 <?xml version="1.0" encoding="utf-8"?>
  <Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
      <WebPublishMethod>FileSystem</WebPublishMethod>
      <SiteUrlToLaunchAfterPublish />
      <publishUrl Condition="$(OutDir) != ''">$(OutDir)\_PublishedWebsites\$(ProjectName)</publishUrl> <!-- For MSBuild -->
      <publishUrl Condition="$(OutDir) == ''">$(MSBuildThisFileDirectory)..\..\_PublishedWebsite\</publishUrl> <!-- For Visual Studio...cant use $(ProjectName) -->
      <DeleteExistingFiles>True</DeleteExistingFiles>
    </PropertyGroup>
  </Project> 
```

# html - 由于对具有长参数列表的 html 标记使用“\”，浏览器 url 字段有空格

> ID：10249414
> 
> 赞同：0
> 
> 时间：2012-04-20T15:50:08.047
> 
> 标签：html

我使用反斜杠“\”并在与符号“&”点处断开网址，使很长的 html 行更具可读性。

上下文是——显示带有多个参数的 Facebook 订阅源对话框，其中每个参数前面都有“&”字符。

这是代码：

```
 <a class="fbShareToWall" 
        onClick='window.open("https://www.facebook.com/dialog/feed?app_id=10352809978xxxx \
        &link=http://www.oursite.com \
        &name=Our%20site \
        &caption=For%20business \
        &description=Good%20stuff \
        &redirect_uri=http://www.oursite.com");'>Share on Facebook</a> 
```

浏览器 URL 栏中的 url 如下所示：

```
 https://www.facebook.com/dialog/feed?app_id=10352809978xxxx      &link=http://www.oursite.com                 
           &name=Our site                &caption=For business         &description=Good stuff
           &redirect_uri=http://www.oursite.com 
```

'&' 参数之间有很大的差距。它有效吗？当然。浏览器必须为每个空格用 %20 填充大间隙。浏览器 url 栏中的上述 'gappy' URL 成功显示 Facebook 'Feed' 对话框。

我需要使代码清晰易读，但要消除浏览器 url 栏中 URL 中的大空白。

有没有办法做到这一点，并且仍然用'\'反斜杠将很长的'&'参数列表包装到单独的行中？

或者是否有另一种方法可以将长 html 标签的参数列表包装到单独的行中，并且在浏览器 URL 栏中没有间隙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:54:40.280

另一种包装方式，因为您使用的是 javascript：

```
onClick='window.open("https://www.facebook.com/dialog/feed?app_id=10352809978xxxx" +
    "&link=http://www.oursite.com" +
    "&name=Our%20site" +
    "&caption=For%20business" +
    "&description=Good%20stuff" +
    "&redirect_uri=http://www.oursite.com");'>Share on Facebook</a> 
```

我不确定这些反斜杠在您的代码中是做什么用的，但是如果需要它们，那么您可能可以包含它们：

```
onClick='window.open("https://www.facebook.com/dialog/feed?app_id=10352809978xxxx" + \
    "&link=http://www.oursite.com" + \
    "&name=Our%20site" + \
    ... 
```

# wordpress - 搜索查询不适用于单个帖子页面 - wordpress

> ID：10249416
> 
> 赞同：0
> 
> 时间：2012-04-20T15:50:15.353
> 
> 标签：wordpress, search

从主页和类别页面，我的搜索表单工作得很好。尝试搜索“帖子”。

[http://blog.papermusepress.com](http://blog.papermusepress.com)

它将带来结果。

但是，如果您尝试从单个帖子中进行搜索，则不会进行搜索。

在这里尝试：http: [//blog.papermusepress.com/my-second-post/](http://blog.papermusepress.com/my-second-post/)并搜索帖子，它不会进行实际搜索

有人知道它为什么会这样做吗？

/single.php/

```
<?php get_header(); ?>

        <div id="main">
            <div id="primary">
                <?php if(have_posts()) : while(have_posts()) : the_post(); ?>

                <div class="post-item">
                    <div class="title-tape">
                        <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
                        <p class="meta">Posted by <?php the_author(); ?> on <?php the_date(); ?></p>
                    </div><!-- end title-tape -->
                    <?php the_content(); ?>
                </div><!-- end post-item -->

                <?php endwhile; ?>
                <?php else : ?>
                    <p>We aren't sure what you are looking for..</p>                
                <?php endif; ?>

                <div id="comments_template">
                    <?php comments_template(); ?>
                </div><!-- end comments_template -->

            </div> <!-- end primary -->

            <?php get_sidebar(); ?>
        </div> <!-- end main -->
    </div><!-- end wrap -->
<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T06:21:58.060

我认为问题在于每次只应将搜索查询字符串添加到根 URL 时，它都会被附加到完整 URL。例如，如果您在 [http://blog.papermusepress.com/my-second-post/](http://blog.papermusepress.com/my-second-post/)上，则搜索将添加到该 URL 的末尾（而不仅仅是[http://blog.papermusepress.com/](http://blog.papermusepress.com/)），这仅允许搜索当前页面。这将保留当前模板并绕过搜索结果页面。

检查 searchform.php 文件中的表单操作。开始表单标记应如下所示：

```
<form method="get" id="searchform" action="<?php echo esc_url(home_url('/')); ?>"> 
```

如果您的表单有一个空操作，`action=""`，它将发回给自己。这可能很有用，但绝对不是您想要的 wordpress 搜索。

# javascript - JavaScript 拖放问题

> ID：10249417
> 
> 赞同：0
> 
> 时间：2012-04-20T15:50:16.667
> 
> 标签：javascript, html

好的，我创建了一个 JavaScript 页面，用户可以在其中添加文本，他们可以设置颜色、粗斜体以及大小和字体。通过下拉框选择大小和放置选项。

![在此处输入图像描述](../Images/ccada8940929439cbb23b21c5a1c1a74.png)

它看起来有点凌乱，因为我不担心外观，只担心功能。

当他们添加出现在小部件中的元素时，他们可以将元素拖动到我创建的图像上，该图像显示在屏幕上。每当用户对文本的位置感到满意时，他们单击保存生成坐​​标并更新表格 X 和 Y 坐标字段，此时生成新行，他们可以重复添加新元素的过程。每当他们高兴时，他们点击保存，它将发送到数据库以存储以供以后检索。

我的问题是每次我添加一个新的文本字段时，它都会将元素向下推一定量。

我通过添加一个递减变量来纠正这一点，该变量采用 elementCount（每次添加新标签元素时自动递增）并将其乘以设定的数量以递减

```
decr -= (elementCount* 16); 
```

这适用于中等文本大小，但是当您开始添加不同的文本大小和字体组合时，它会改变元素被下推的程度，因此您添加的每个其他元素都会变得越来越糟。

新元素是这样添加的

```
 elementCount++;

      var Text = textArray[textArray.length-1];
       var Font = fontArray[fontArray.length-1];
       var Color = colorArray[colorArray.length-1];
        var Bold = boldArray[boldArray.length-1];
        var Size = sizeArray[sizeArray.length-1];
        var Italics = italicsArray[italicsArray.length-1];
        var X = xCordArray[xCordArray.length-1];
        var Y = yCordArray[yCordArray.length-1];

         var newdiv = document.createElement('div');
     newdiv.innerHTML = "<span><font color='" + Color + "' size = '" + Size + "' face='" + Font + "'><label class = 'drag2' id = 'text" + firstCount + "'> " + Text + "</label></font></span>";
    document.getElementById(divName).appendChild(newdiv);

        var decr= 32;
        decr-= (elementCount* 16);
        Y = parseInt(Y) + test;
        X = parseInt(X) + 24;

           document.getElementById("text" + elementCount).style.left = X + "px";
           document.getElementById("text" + elementCount).style.top = Y + "px"; 
```

拖放 JavaScript 代码基于本教程

[http://luke.breuer.com/tutorial/javascript-drag-and-drop-tutorial.aspx](http://luke.breuer.com/tutorial/javascript-drag-and-drop-tutorial.aspx)

有什么办法可以做到，所以当你动态添加一个新元素时，它不会自动将你添加的每个新元素在屏幕上向下推一点。在过去的几天里，我尝试了很多不同的选项来解决这个问题，但都没有运气。

提前感谢您的帮助

编辑文本元素的 CSS

```
 .text1{
position: relative;
left: 0px;
top: 0px;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:55:04.510

我更改为绝对定位并将其放置在相对定位的容器中，现在可以正常工作了！！

# android - 使用 osmdroid 离线 zip 文件（图块）

> ID：10249418
> 
> 赞同：1
> 
> 时间：2012-04-20T15:50:31.410
> 
> 标签：android, osmdroid

我正在离线模式下使用 osmdroid 地图查看器。我已经使用 osmdroid zip 格式的 Mobile Atlas creator 下载了磁贴，一切正常。我想知道是否可以有多个 zip 文件？我只想要 2 或 3 个彼此远离的不同位置。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T09:28:27.130

是的，文件夹中可以有多个 zip 文件。我有 3 个文件对应于我设备上的不同区域。他们都在离线时给我一个地图显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:27:11.093

我在想一层总是有一个 zip 文件——比如 mapinik、osmarender 等。

但是...我查看了代码，似乎您可以这样做。查看 zip 文件的内部，如果有类似的结构：mapinik/zoomLevel/x/y - 您应该能够添加另一个具有相同结构的文件，该文件应该可以工作。

我看到代码正在所有存档文件中查找磁贴路径。我只是不确定“所有存档文件”是什么意思，我没有时间调查或测试这个:)

希望能有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T01:52:16.810

OutOfMemory 异常是因为 heapsize 已满。大多数/所有 Android 手机的堆大小都很小（从 16 到 48mb）。还应该有一个解决方法 - 将数据导出到 SQLite 而不是 ZIP，atlas creator 也可以这样做。我已经有一段时间没有看到 OSMdroid 代码了，但我很确定他也可以阅读这种东西，这样你就不会遇到 OutOfMemory 问题。关于 SQLite 的一件事是 2gb 限制，但它仍然不错。

# python - 函数定义上的正则表达式 findall。想要匹配 args 但不是函数

> ID：10249422
> 
> 赞同：1
> 
> 时间：2012-04-20T15:50:51.817
> 
> 标签：python, regex, wildcard, lookahead, findall

我有一个看起来像的字符串列表

```
"funcname(arg, another_arg)*20 + second_func(arg1, arg2)" 
```

我想只提取参数。我尝试了以下方法：

```
re.findall(r'\w[\w\d_]+(?!\()', string) 
```

但是这会返回

```
['funcnam', 'arg', 'another_arg', '20', 'second_fun', 'arg1', 'arg2'] 
```

首先，我对为什么看到 有点困惑`'20'`，因为我指定字符串应该以单词字符开头。其次，我想知道如何改进我的前瞻性以匹配我正在寻找的内容。

我应该注意，有些字符串没有功能，看起来像

```
"value1 + value_two" 
```

所以我不能简单地在括号内搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:08:08.250

这是一个应该更好的正则表达式：

```
(?!\w+\()[^\W\d]\w+ 
```

例如：

```
>>> s = "funcname(arg, another_arg)*20 + second_func(arg1, arg2)"
>>> re.findall(r'(?!\w+\()[^\W\d]\w+', s)
['arg', 'another_arg', 'arg1', 'arg2'] 
```

`[^\W\d]`相当于`[a-zA-Z_]`。

这使用与您的正则表达式相同的逻辑，但通过将前瞻移动到字符串的开头，您可以防止类似`funcnam`from的匹配`funcname(...)`。这是一个类似的替代方案：

```
[^\W\d]\w+(?![\w(]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:15:32.857

这可能是一个糟糕的解决方案，但它对我有用......：

```
R=r"[a-zA-Z_]\w*(?:s*\()?"  #This captures everything, leaving the left parenthesis on functions
values=filter(lambda x: '(' != x[-1], re.findall(R,s))  #now filter off everything containing a left parenthesis
#Or if you prefer list comprehensions...
values=[ x for x in re.findall(R,s) if x[-1]!='(' ] 
```

其他答案可能会比这更好......这样做的一个好处是它可以让您在事后轻松挑选功能 - 它们以'（'结尾

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:28:13.777

```
>>> pattern = '[a-zA-Z_]\w*(?![\(\w])'
>>> re.findall(pattern, "funcname(arg, another_arg)*20 + second_func(arg1, arg2)")
['arg', 'another_arg', 'arg1', 'arg2']
>>> re.findall(pattern, "value1 + value_two")
['value1', 'value_two'] 
```

# php - PHP 的默认 tidy VS 开发者自定义的 tidy

> ID：10249425
> 
> 赞同：1
> 
> 时间：2012-04-20T15:50:59.130
> 
> 标签：php, oop, php-5.3, htmltidy

我知道默认情况下已经有`tidy`php 类，如果我想创建自己的自定义 tidy 类并且我想将该类命名为**tidy**呢？

```
class tidy
{
    public function html()
    {
        return 'local';
    }
}

$tidy = new tidy();
echo $tidy->html(); 
```

错误，

> 致命错误：无法在第 11 行的 C:\wamp\www\test\2012\php\dom_tidy_html_8.php 中重新声明类整洁

我怎样才能不与 PHP 的默认值冲突`tidy`？

是否可以？

**编辑：**

我对其进行了测试`namespace`并且它有效，但我不是这是否是一个好习惯......？我之前没有做过任何事情，`namespace`所以我不确定它是否安全......

```
namespace tidy;

class tidy
{
    public function html()
    {
        return 'local';
    }
}

$tidy = new tidy();
echo $tidy->html(); 
```

如果我想`tidy` **偶尔**使用 PHP 默认值，会不会导致任何问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:52:34.153

只需将其命名为不同的名称：

```
class my_tidy
{
    public function html()
    {
        return 'local';
    }
}

$tidy = new my_tidy();
echo $tidy->html(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T15:54:30.630

如果您想在 tidy 之上构建，那么只需扩展 tidy 类并调用 myTidy。

```
class myTidy extends tidy
{
    public function html()
    {
        return 'local';
    }
}

$tidy = new myTidy();
echo $tidy->html(); 
```

如果您想从头开始创建自己的实现，请尝试删除 tidy 模块，然后创建 tidy 类。

如果您使用的是 PHP >= 5.3.0，您还可以在 Namespace 中创建自己的整洁类：

```
namespace My\Tidy;

class tidy
{
    public function html()
    {
        return 'local';
    }
}

$tidy = new tidy();
echo $tidy->html(); 
```

# java - 使用自定义对象建议创建 GWT SuggestOracle

> ID：10249430
> 
> 赞同：0
> 
> 时间：2012-04-20T15:51:24.420
> 
> 标签：java, gwt, autosuggest, suggestbox

我正在尝试将下拉框小部件转换为 SuggestionBox，因为当前的下拉菜单有 100 多个选项。不过，您似乎只能将字符串建议添加到 SuggestOracle。我需要能够添加一个自定义对象，其中包含描述和与数据库匹配的记录的 ID。我是否必须扩展 SuggestOracle 类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:15:09.460

是的，据我所知，您不能使用一对值，即 Id 和 Value。您必须在建议框中添加字符串，也许您可​​以使用建议框以外的其他解决方案，即创建值列表弹出窗口。并添加任意数量的字段。在带有分页的弹性表格中显示您的数据。使用选择处理程序用选定的行更新您的表单。有关如何使用 FlexTable 和处理事件的参考，请参阅[able Single Row Click Event](http://www.java2s.com/Code/Java/GWT/TableSingleRowClickEvent.htm)

`SuggestOracle`是`MultiWordSuggestOracle`您已经在使用的父类。

```
public class MultiWordSuggestOracle   extends SuggestOracle 
```

见[MultiWordSuggestOracle](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/MultiWordSuggestOracle.html)

# php - 带有块 cms_index_index 的 Magento 布局 cms.xml 文件不显示 cms 页面内容。为什么？

> ID：10249434
> 
> 赞同：0
> 
> 时间：2012-04-20T15:51:34.607
> 
> 标签：php, magento, layout

我创建了一个 Magento 前端包和主题...我创建了一个包含以下内容的 layout/cms.xml 文件。在主页上，现在有页面标题但没有内容？

```
<layout version="0.1.0">
    <default>
        <reference name="footer">
            <block type="cms/block" name="cms_footer_links" before="footer_links">
                <action method="setBlockId"><block_id>footer_links</block_id></action>
            </block>
        </reference>
    </default>

    <cms_page translate="label">
        <label>CMS Pages (All)</label>
        <reference name="content">
            <block type="core/template" name="page_content_heading" template="cms/content_heading.phtml"/>
            <block type="page/html_wrapper" name="cms.wrapper" translate="label">
                <label>CMS Content Wrapper</label>
                <block type="cms/page" name="cms_page"/>
            </block>
        </reference>
    </cms_page>

    <cms_index_index translate="label">
        <label>CMS Home Page</label>
        <reference name="content">
            <block type="core/template" name="cms_index_index" template="cms/index/index.phtml" />
            <block type="cms/page" name="cms_page" />

            <block type="page/html_wrapper" name="cms.wrapper" translate="label">
                <label>CMS Content Wrapper</label>
                <block type="cms/page" name="cms_page"/>
            </block>
        </reference>
    </cms_index_index>

    <cms_index_defaultindex>
        <remove name="right"/>
        <remove name="left"/>

        <reference name="content">
            <block type="core/template" name="default_home_page" template="cms/default/home.phtml"/>
        </reference>
    </cms_index_defaultindex>

    <cms_index_noroute translate="label">
        <label>CMS No-Route Page</label>
    </cms_index_noroute>

    <cms_index_defaultnoroute>
        <remove name="right"/>
        <remove name="left"/>

        <reference name="content">
            <block type="core/template" name="default_no_route" template="cms/default/no-route.phtml"/>
        </reference>
    </cms_index_defaultnoroute>
</layout> 
```

如您所见，其中有`<block type="cms/page" name="cms_page" />`，但前端没有任何内容。为什么？有什么提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T09:23:20.097

```
// get current cms page from Mage:getSingleton
$cms_id = Mage::getSingleton('cms/page')->getIdentifier();
$cms_title = Mage::getSingleton('cms/page')->getTitle();
$cms_content = Mage::getSingleton('cms/page')->getContent(); 
```

感谢[http://developerafroz.blogspot.de/2012/01/get-current-cms-page-magenocms-pages.html](http://developerafroz.blogspot.de/2012/01/get-current-cms-page-magentocms-pages.html)

# windows-phone-7 - 我们如何在 XNA-Silverlight 混合项目上启用抗锯齿功能？

> ID：10249435
> 
> 赞同：0
> 
> 时间：2012-04-20T15:51:38.663
> 
> 标签：windows-phone-7, xna, antialiasing

在 XNA 中我们只需要这样做：GraphicsDevice.PreferMultisampling = true，但在 XNA-Silverlight 混合项目中没有这样的属性。

我们如何在基于 XNA-Silverlight 混合项目模板的 3D 游戏中启用抗锯齿功能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T02:53:28.190

你可以看看[这里](http://forums.create.msdn.com/forums/p/103106/612093.aspx)，也许这就是你要找的。

# javascript - HTML 表格悬停缩放（类似于 jqZoom，但适用于表格）

> ID：10249440
> 
> 赞同：1
> 
> 时间：2012-04-20T15:52:04.243
> 
> 标签：javascript, html, zooming

我正在寻求对典型图像缩放的扭曲。我有一个大网格（HTML 表格），我想展示它的缩略图（它是可读的，但很小）。我想在鼠标光标所在的位置创建一个小的可拖动平移窗口（例如，6x6 表格单元格），然后在附近的缩放视口中，我想显示鼠标可拖动单元格的更大版本平移窗口。

效果将类似于此图像缩放插件：

[jq缩放](http://www.mind-projects.it/projects/jqzoom/demos.php)

我已经看到了大量用于图像缩放的这些东西，但没有用于表格（或基本文本）缩放。

我是第一次发帖，但我已经足够阅读所有“你尝试过什么”和“Stack Overflow 不是推荐引擎”的文章。在这种情况下，我没有尝试过任何事情，因为我希望有一个工具可以为我做到这一点。我就是找不到。

有人知道可以为表格实现这种效果的插件或一些代码吗？

这是一个开始的小提琴，但正如评论中所述，除了创建一个网格和一个目标 div 之外，我没有做太多事情：

[http://jsfiddle.net/UFyPs/2/](http://jsfiddle.net/UFyPs/2/)

# timestamp - 在 NTFS 上的驱动器之间移动文件夹并保留时间戳

> ID：10249444
> 
> 赞同：13
> 
> 时间：2012-04-20T15:52:19.420
> 
> 标签：timestamp, directory, move, ads, ntfs

抱歉，我知道这*听起来*像是一个新手问题。但说真的，我是一位经验丰富的开发人员，我知道 Windows 7 Pro 64 位等会说：“哦，如果你将 NTFS 树从一个驱动器移动到另一个驱动器，当我编写子文件时，这真的意味着我正在修改父文件夹，所以我会更新它的时间戳。” 因此，我最终得到所有目标文件的时间戳与原始文件相同，但所有文件夹都具有相同的刚刚修改的日期/时间。

所以我明白发生了什么。而且我知道我可以编写自己的实用程序（我有）来复制/移动 NTFS 上的文件。但是实用程序是有风险的——如果它们不支持 NTFS，它们可能会忽略其他属性或错过诸如 NTFS 备用数据流 (ADS) 等内容。

那么有没有人知道一个好的、支持 NTFS 的树移动实用程序，它可以简单地移动*整个*树并维护时间戳？我不想冒险失去任何东西。谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-21T05:59:27.510

从 Helge Klein 的回答中得到暗示，我更仔细地研究了[Robocopy](http://technet.microsoft.com/en-us/library/cc733145.aspx)。事实证明，Robocopy（最新版本，例如 Windows 7 附带的版本）实际上可以复制复制文件夹结构的时间戳。还有一个“移动”选项可以在复制后删除源目录，但在微软的无限智慧中，这与“保留目录时间戳”选项不兼容，因此您必须在复制后删除源树。

命令行参数选项令人生畏。我做了一些研究，使用 Robocopy 复制保留目录时间戳的基本命令是：

```
robocopy %1 %2 /e /dcopy:T 
```

...哪里`%1`是源目录，`%2`是目标目录。

如果要确保复制*所有内容*，包括 NTFS 安全性、所有者和审核权限，请指定应复制所有属性并使用备份模式，如下所示：

```
robocopy %1 %2 /b /e /copyall /dcopy:T 
```

但是，使用这些额外选项将需要完整的管理员权限（不仅仅是管理员帐户）。例如，单击**Start**，右键单击**Command Prompt**，然后选择**Run as administrator**。然后输入上面的命令。

PS 我已经验证 Robocopy 也可以传输 NTFS 流。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T18:38:19.873

我打算推荐*robocopy*，但是当我尝试这个场景时，我发现（令我惊讶的是）它会在新的日期留下复制的目录，正如你所描述的那样。

另一方面，[Total Commander也会复制目录的时间戳。](http://ghisler.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-25T20:43:27.270

SynchronizeIt 做到了这一点，就像 Robocopy 一样好，它有一个漂亮的 GUI 和可以轻松查看和选择要复制哪些文件的选项。 [http://www.grigsoft.com/wndsync.htm](http://www.grigsoft.com/wndsync.htm)

（但请注意，在极少数情况下，此工具会以某种方式损坏目标文件 - 我使用下载管理器（特别是 FlashGet 和 Orbit Downloader）下载的文件发生过这种情况，只有前 25kb 被正确复制，其余部分填充零，我不知道解释。我见过 Robocopy 在同样罕见的情况下也失败了——它被相似的文件名混淆了，复制了一个文件而不是另一个文件，因此错过了另一个。所以现在我确保总是验证副本使用 Total Commander 或 WinMerge 是完美的。）

# php - Yii 中的动态布局

> ID：10249446
> 
> 赞同：1
> 
> 时间：2012-04-20T15:52:26.740
> 
> 标签：php, yii, sidebar

我有一个 Yii 应用程序，在布局中我有一个静态侧边栏。我想根据控制器操作或视图更改侧边栏的内容。目前，在`views/layouts/main.php`文件中，我有一个侧边栏定义为：

```
<div class="sidebar">hello!</div> 
```

当控制器是`image`并且动作是`test`时，我想显示这个：

```
<div class="sidebar">Created at <? echo $image->created_at; ?></div> 
```

$image 对象在`image`控制器和`test`动作中定义。

简而言之，我想在控制器是`image`并且动作是时显示一个侧边栏`test`，但是，我不希望完全不同的布局。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T23:03:04.750

这是剪辑的工作。在您的布局中：

```
<div class="sidebar">
    <?php if(!empty($this->clips['sidebar'])) {
        echo $this->clips['sidebar'];
    } else { ?>
        hello
    <?php } ?>
</div> 
```

在您看来的某处：

```
<?php $this->beginClip('sidebar'); ?>
    Created at <? echo $image->created_at; ?>
<?php $this->endClip(); ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:57:10.433

您可以使用 进行简单`if-else`检查，`getController()`如下`getAction()`所示：

```
if(Yii::app()->getController()->getId()=='image' && Yii::app()->getController()->getAction()->getId()=='test'){
    echo '<div class="sidebar">Created at '.$this->image->created_at.'</div>'; 
}
else
    echo '<div class="sidebar">hello!</div>'; 
```

要`$image`在布局中访问，我们需要将其设为`image`控制器本身的公共属性，然后在`test`我们初始化 的操作中`$image`，我们将初始化 public `$image`，例如：

```
 class ImageController extends Controller{
     public $image;
     ...
     public function actionTest(){
         $this->image=Example::model()->findByPk(1);// example
         ...
     }
 } 
```

这将允许我们访问布局中的图像，尽管使用`$this->image->property`.

同样在布局`$this`中指的是当前控制器，因此我们也可以使用`$this->id`而不是`Yii::app()->getController()->getId()`获取控制器ID（名称是此处的*图像*），`$this->action`而不是`Yii::app()->getController()->getAction()->getId()`获取操作ID。

# java - Android - 光标已弃用

> ID：10249450
> 
> 赞同：0
> 
> 时间：2012-04-20T15:52:45.620
> 
> 标签：java, android, xml, eclipse, sqlite

在一个 android 应用程序上工作以发展我的技能我正在尝试删除 sqlite 和 listview 上的所有数据，然后我重新查询光标以反映更改，但我继续得到`c.requery();`Cursor is deprecated

我这样做：

```
 public void onClick(View v) {
        switch(v.getId()){

        case R.id.removeBtn:

            dm.deleteAll();
           c.requery();//<<this is deprecated 

            break;
        } 
```

我需要做什么来代替任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:56:34.123

“新”方法是实例化一个全新的光标。

代替`c.requery();`

你会做的

```
c = query(uri, ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:56:35.867

你可以在这里得到答案：http: [//developer.android.com/reference/android/database/Cursor.html#requery()](http://developer.android.com/reference/android/database/Cursor.html#requery%28%29)

# macos - 使用终端复制文件，Mac

> ID：10249453
> 
> 赞同：4
> 
> 时间：2012-04-20T15:52:57.423
> 
> 标签：macos, terminal

我正在尝试使用终端将文件从一个文件夹复制到另一个文件夹。我有一个包含数千个文件的文件夹，我有一个 txt 列表，其中包含数千个与之匹配的文件名。我只需要将 txt 列表中的文件复制到新位置。

我在网上找到了这个并为我的磁盘修改了它，但它不起作用。今天是我第一次打开终端，所以我不知道我在做什么，如果这甚至接近我需要的。任何意见，将不胜感激。

```
#!/bin/bash

target="/Users/DataSourceSTL/Desktop/Photos"
destination="/Users/DataSourceSTL/Desktop/Test"

fnames=”/Users/DataSourceSTL/Desktop/Untitled.txt”

for info in $fnames; do
  cp ${target}/${info} ${destination}/
  exit 1
  echo "copying $info"
done

echo "done" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T15:55:31.180

尝试这个 ：

```
for info in `cat $fnames`; do 
  cp -v "${target}/${info}" "${destination}/"
done 
echo "done" 
```

# internet-explorer - IE9 中的 IE7/8 模式与实际运行的 IE7/8 相比如何？

> ID：10249454
> 
> 赞同：21
> 
> 时间：2012-04-20T15:52:57.773
> 
> 标签：internet-explorer, testing, cross-browser

我试图确认这一点是出于工作目的，因此我们不需要单独的虚拟机在 IE7 和 IE8 中进行测试。我一直只是使用IE9（F12）中的开发者工具并更改浏览器模式和文档模式来进行IE7和IE8测试。

这与“真正的”IE7 和 IE8 中的实际测试相比如何？有没有人做过比较或看过详细说明的文章？

我假设 IE7 和 IE8 渲染引擎只是包含在 IE9 中，而它只是使用这些引擎。还有什么我应该知道的吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-07-10T16:47:07.807

我总是使用真正的浏览器。我有 IE 9 的 IE 7 模式的三个示例，其行为与真正的 IE 7 不同：

1.  [这](http://jsfiddle.net/nU2Zp/3/)是一个显示淡出和淡入的透明 PNG 的页面。在真正的 IE 7 中，您可以看到图像边缘周围的黑暗。在 IE 9 的 IE 7 模式中情况并非如此。

2.  Base64 图像在真正的 IE 7 中不起作用，但它们在 IE 9 的 IE 7 模式中起作用。[这](http://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html)是一个您可以测试自己查看的页面。

3.  [这](http://jsfiddle.net/H4HkF/)是一个显示`zoom: 1px;`应用了 CSS 的段落的页面。在真正的 IE 7 中，该段落显得非常小。在 IE 9 的 IE 7 模式中情况并非如此。

我有 12 个 IE 9 的 IE 8 模式与真正的 IE 8 表现不同的例子：

1.  [这](http://jsfiddle.net/PjbgV/)是一个显示 256px × 256px 图像缩放到 50px × 50px 的页面。在真正的 IE 8 中，边缘看起来很平滑。在 IE 9 的 IE 8 模式中情况并非如此。

2.  [James Hopkins 的 IE 8 错误列表](http://jhop.me/ie8-bugs)(JHIE8B) 中的CSS 错误 9不会影响 IE 9 的 IE 8 模式（[测试用例](http://www.gtalbot.org/BrowserBugsSection/MSIE8Bugs/bullet-list-marker-MS-Sans-Serif.html)，[备用测试用例](http://jsfiddle.net/mxnfS/)）。该错误的描述是“使用 MS Sans Serif 字体时错误呈现的子弹（填充圆盘）列表标记”。

3.  JHIE8B 中的 CSS 错误 15 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/imga-descenderspace.html)，[备用测试用例](http://jsfiddle.net/sNka4/)）。该错误的描述是“嵌套在 A 元素中的包含 IMG（具有垂直对齐：基线，并且没有包含文本的同级行框）的内联框的下降空间，仅绘制在`:hover`”上。

4.  JHIE8B 中的 CSS 错误 22 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/wp-content/uploads/2008/IE8Bugs/final-release/contentdynamic.html)，[备用测试用例](http://jsfiddle.net/RK8gh/)）。该错误的描述是“`content`当属性被动态插入时，属性不返回属性的值”。

5.  JHIE8B 中的 CSS 错误 31 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/liststyle/importrule-marker-inherit.html)）。该错误的描述是“在使用 @import 导入这些样式规则时，标记框不会从其附加的元素继承样式”。

6.  JHIE8B 中的 CSS 错误 38 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/overflowscroll-float-maxheight.html)）。该错误的描述是“匹配一个元素的规则集，其中包括一个`float`值、一个`max-height`值和一个`overflow`值`scroll`，触发完整的页面空白（强制标准模式）或兼容性视图回退”。

7.  JHIE8B 中的 CSS 错误 56 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/dynamicstackingcontext.html)）。该错误的描述是“当包含块的堆叠级别被重置以反映默认的从后到前的顺序时，不会在上升`:hover`（或）上重新计算相对定位的后代（堆叠级别低于其包含块）的堆叠上下文`:active`在文档树中”。

8.  JHIE8B 中的 CSS 错误 57 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/textdecoration-visibilityhidden.html)）。该错误的描述是“内联元素，`visibility:hidden`其直接位于父项*的*结束标记之前*或*紧接在父项的开始标记之后*并*立即位于父项的结束标记之前，阻止值并应用于行框”。**`text-decoration``underline``overline`**

***   JHIE8B 中的 CSS 错误 60 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/anon-tablecell_textselect.html)，[备用测试用例](http://jsfiddle.net/VWqCW/)）。`table-cell`该错误的描述是“与元素等效的匿名表对象内的文本不可选择”。

    *   JHIE8B 中的 CSS 错误 62 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/overflow_transparency-bleed.html)，[备用测试用例](http://jsfiddle.net/NjQcs/)）。该错误的描述是“一个半透明的元素，`overflow:hidden`当它溢出它的父框时，其内容被剪裁（应用于父级），沿着为溢出提供边界的外边缘经历 1 像素透明度相关的出血”。

    *   JHIE8B 中的 CSS 错误 65 不会影响 IE 9 的 IE 8 模式（[测试用例](http://jhop.me/tests/bugs/ie8/background-image_first-child.html)，[备用测试用例](http://jsfiddle.net/MC23a/)）。该错误的描述是“当 a`background-image`应用于`:first-child`伪元素时，`background-image`不会显示应用于其关联元素的不同”。

    *   JHIE8B 中的 JavaScript 错误 1 ​​不会影响 IE 9 的 IE 8 模式（[测试用例](http://www.domnodes.org/ie8/ie8test.html)，[备用测试用例](http://jsfiddle.net/DmuuB/)）。该错误的描述是“在循环外`querySelectorAll`的语句中使用，会触发完整的程序崩溃。”。`break``for`** 

 **拥有多个虚拟机有点不方便，但[至少它们是免费](http://www.microsoft.com/en-us/download/details.aspx?id=11575)的，而且它们也可以与 VirtualBox 一起使用。

* * *

**编辑 1 (2012-08-21 19:40:46Z)：**添加了 IE 9 的 IE 8 模式的示例，其行为与真正的 IE 8 不同。

**编辑 2 (2012-11-16 08:11:42Z)：**更新了 IE 9 的 IE 7 模式的第一个示例中的链接，其行为与真正的 IE 7 不同，并添加了第三个示例。

**编辑 3 (2012-11-22)：**添加了 IE 9 的 IE 8 模式的 11 个示例，其行为与真正的 IE 8 不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T21:40:13.700

为了补充尼克的答案，这里有两个 IE9 在 IE7 模式下的行为与真正的 IE 7 不同的示例：

1.  localStorage 在 IE9-in-IE7-mode 下工作，但在 IE7 中不工作。
2.  sessionStorage 在 IE9-in-IE7-mode 下工作，但在 IE7 中不工作。

让您想知道在 IE9 中实现的其他多少 Web API 将在 IE9-in-IE7-mode 中工作......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-02T10:58:30.853

在 IE10 中，似乎存在一系列非常相似的问题，使浏览器和文档模式不适合进行可靠测试。

许多在 IE 7 和 IE 8 中工作的过滤器在文档和浏览器模式下不起作用。**

# ruby-on-rails - HAML - 为什么我的haml的文本都显示在顶行，尽管在代码的不同部分呈现

> ID：10249461
> 
> 赞同：1
> 
> 时间：2012-04-20T15:53:29.847
> 
> 标签：ruby-on-rails, ruby, haml

我有这个 HAML 页面：

```
-content_for :primary_content do

  Hmmm
  %strong{:class => "code", :id => "message"} Hello Alex!

  .container-fluid
    .row-fluid
      .span1 Hello 1
      .span4 Hello 4
      .span4 Hello 4 again
      .span3 Hello 3

  %strong{:class => "code"} End of page!

  .container-fluid
    .row-fluid
      .span9 My Disclosures o ye!
      .span3 This will be the side area

      // Ok....what is in home?
      // The two divs....

  -content_for :primary_content do
    -if signed_in?
      // =render "sidebar/common/primary_navigation"
      // If signed in, show the options for
      // 1) Logout | My Profile
      // 2) Create disclosure | show disclosures
      Signed in
    -else
      // =render "devise/sessions/form"
      NOT Signed in 
```

出于某种原因，它呈现`Not signed in Hmmm Hello Alex!`在顶行，然后是它下面的所有其他内容。

我很困惑，因为“未登录”位于页面底部，而“hmm Hello Alex”位于顶部。但由于某种原因，它会一起呈现在屏幕上。知道为什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:14:49.353

首先我想指出你似乎有一个嵌套的 content_for，这可能是一个问题。

其次，我建议分离两个 content_for 块并专门为登录区域创建另一个块。就像是

```
- content_for :login do
  -if signed_in?
    // =render "sidebar/common/primary_navigation"
    // If signed in, show the options for
    // 1) Logout | My Profile
    // 2) Create disclosure | show disclosures
    Signed in
  -else
    // =render "devise/sessions/form"
    NOT Signed in 
```

然后放

```
yield :login 
```

之后某处

```
yield :primary_content 
```

分离关注点并使其没有任何内容踩到其他人的脚趾。

# c# - 使用 Linq 通常展平 XDocument？

> ID：10249462
> 
> 赞同：1
> 
> 时间：2012-04-20T15:53:34.713
> 
> 标签：c#, xml, linq

有一个[问题](https://stackoverflow.com/questions/8900089/can-i-flatten-an-xdocument-with-linq)几乎完全符合我想要做的几乎相同的名称，但是我不知道我的 XML DOM 会提前是什么样子。

我想做这样的事情：

```
private static IEnumerable<XElement> FindAllContainers(XDocument xml)
{
          IEnumerable<XElement> query = from XElement outer in xml.Root.Elements()
                                        from XElement node in outer.Elements()
                                        where true //Enum.IsDefined(typeof(Role), GetContainerRole(node)) 
                                        select node;
                                        return query;
} 
```

基本思想是我想查询任何给定 XML 结构的*所有*XElements 的枚举。上面的代码不返回任何结果。xml 包含一个大型嵌套 XML 结构并且是一个 XDocument。另一个问题手动为元素提供标签名称。我不知道他们提前在方法中静态设置它是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:00:12.847

因此，在我看来，您只想枚举文档中的所有元素。好吧，这里没有什么复杂的，只需调用该[`Descendants()`](http://msdn.microsoft.com/en-us/library/bb360635.aspx)方法（不带参数），它将返回文档中的所有元素。

```
private static IEnumerable<XElement> FindAllContainers(XDocument doc)
{
    return doc.Descendants();
} 
```

# c# - 使用 LINQ to SQL 的数据库中的最佳 Count() 操作

> ID：10249467
> 
> 赞同：4
> 
> 时间：2012-04-20T15:53:56.440
> 
> 标签：c#, performance, tsql, linq-to-sql

DBA 告诉我，在使用 T-SQL 时：

```
select count(id) from tableName 
```

比

```
select count(*) from tablenName 
```

如果 id 是主键。

将其推断到 LINQ-TO-SQL 是否准确？

此 LINQ-to-SQL 语句：

```
int count = dataContext.TableName.Select(primaryKeyId => primaryKeyId).Count(); 
```

比这个更高效：

```
int count = dataContext.TableName.Count(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:10:12.483

`select count`据我了解，您的两个陈述之间没有区别。

使用 LINQPad，我们可以检查不同 LINQ 语句生成的 T-SQL。

对于 Linq to SQL 两者

```
TableName.Select(primaryKeyId => primaryKeyId).Count(); 
```

和

```
TableName.Count(); 
```

生成相同的 SQL

```
SELECT COUNT(*) AS [value] FROM [dbo].[TableName] AS [t0] 
```

对于 Linq to Entites，它们再次生成相同的 SQL，但现在是

```
SELECT 
[GroupBy1].[A1] AS [C1]
FROM ( SELECT 
    COUNT(1) AS [A1]
    FROM [dbo].[TableName] AS [Extent1]
)  AS [GroupBy1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-21T12:05:46.953

我知道这是一个旧的，但要小心 sql server！Count 不计算空值，因此如果您的主键字段可以为空，则这两个语句可能不等价。看

```
create table #a(col int null)

insert into #a values (null)

select COUNT(*) 
from #a;

select COUNT(col)
from #a; 
```

# iphone - iPhone：多次调用 UITableView、didSelectRowAtIndexPath

> ID：10249468
> 
> 赞同：1
> 
> 时间：2012-04-20T15:53:58.663
> 
> 标签：iphone

我有 UITableView ...当用户点击行时，会打开另一个屏幕。问题是，有时我点击一次，但 didSelectRowAtIndexPath 调用了几次。如何预防？

如何重现这种情况的一种情况是（您甚至可以尝试在原生 iPhone 设置上重现这种情况）：

1.  点击一行但不要松开手指
2.  用另一只手以不同的顺序从左到右或从右到左滑动下几行（不仅仅是点击，你应该滑动）下几行
3.  松开手指

你会看到蓝色的选择在几行上，打开的屏幕是随机的

更新：在 didSelectRow 我刚刚启动了新的控制器，在 viewDidLoad 同步开始。如果要逐步重现我的场景，则可以多次启动同步

```
 - (void)tableView:(UITableView *)tableView 
        didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    SecondViewController *secondViewController =
        [SecondViewController alloc] init];
    [self.navigationController 
        pushViewController:secondViewController animated:YES];
    [secondViewController release];
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T07:55:11.537

是的，我发现同样的情况。

1.  点击一行但不要松开手指。
2.  继续按住并轻轻移动手指，直到取消选择该行。
3.  按住第一根手指，然后用另一根手指点击屏幕几次。
4.  松开所有手指。

然后你可以看到 didSelectRowAtIndexPath 方法被调用了几次。

我创建了一个新项目来测试它，并且只使用了以下代码。每次都被转载。

所以我认为这是iOS SDK的一个错误！

```
#import "SPViewController.h"

@interface SPViewController ()
@property (nonatomic, strong) UITableView *tableView;
@end

@implementation SPViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.tableView = [[UITableView alloc] initWithFrame:self.view.bounds style:UITableViewStylePlain];
    self.tableView.delegate = self;
    self.tableView.dataSource = self;
    [self.view addSubview:self.tableView];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - UITableViewDataSource

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return 30;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *cellIdentifier = @"cellIdentifier";
    UITableViewCell *cell = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if(cell == nil){
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    }
    cell.textLabel.text = [NSString stringWithFormat:@"Test Cell %d", indexPath.row];
    return cell;
}

#pragma mark - UITableViewDelegate

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
    return 66;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    NSLog(@"%s %@", __FUNCTION__, indexPath);
}

@end 
```

# opengl - 在空间中移动多个对象（存储在 VBO 中）的最有效方法是什么？我应该使用 glTranslatef 还是着色器？

> ID：10249469
> 
> 赞同：7
> 
> 时间：2012-04-20T15:53:59.600
> 
> 标签：opengl, vbo

我试图在opengl中最有效地掌握移动物体（通常）和线条（特别是）的窍门，因此我正在编写一个应用程序，其中多个线段以恒定的速度从右到左行进。在每个时间点，最左边的点将被删除，整条线将向左移动，并在该线的最右边添加一个新点（这个新数据点是实时流式传输/接收/计算的，每 10 毫秒左右）。为了说明我的意思，请看这张图片：

![显示线条的示例](../Images/c1d59873c2af3e249fece4c338fecb81.png)

因为我想处理许多对象，所以我决定使用顶点缓冲区对象以最大限度地减少`gl*`调用量。我当前的代码如下所示：

A）设置初始顶点：

```
# calculate my_func(x) in range [0, n]
# (could also be random data)
data = my_func(0, n)

# create & bind buffer
vbo_id = GLuint()
glGenBuffers(1, vbo_id);
glBindBuffer(GL_ARRAY_BUFFER, vbo_id)

# allocate memory & transfer data to GPU
glBufferData(GL_ARRAY_BUFFER, sizeof(data), data, GL_DYNAMIC_DRAW) 
```

B）更新顶点：

```
draw():

  # get new data and update offset
  data = my_func(n+dx, n+2*dx)

  # update offset 'n' which is the current absolute value of x.
  n = n + 2*dx

  # upload data 
  glBindBuffer(GL_ARRAY_BUFFER, vbo_id)
  glBufferSubData(GL_ARRAY_BUFFER, n, sizeof(data), data)

  # translate scene so it looks like line strip has moved to the left.
  glTranslatef(-local_shift, 0.0, 0.0)

  # draw all points from offset
  glVertexPointer(2, GL_FLOAT, 0, n)
  glDrawArrays(GL_LINE_STRIP, 0, points_per_vbo) 
```

在哪里`my_func`会做这样的事情：

```
my_func(start_x, end_x):

  # generate the correct x locations.
  x_values = range(start_x, end_x, STEP_SIZE)

  # generate the y values. We could be getting these values from a sensor.
  y_values = []
  for j in x_values:
      y_values.append(random())

  data = []
  for i, j in zip(x_values, y_values):
     data.extend([i, j])

  return data 
```

这工作得很好，但是如果我假设有 20 个跨越整个屏幕的线条，那么事情就会大大减慢。 **因此我的问题：**

1）我应该使用glMapBuffer来绑定GPU上的缓冲区并直接填充数据（而不是使用glBufferSubData）？或者这对性能没有影响？

2）我应该使用着色器来移动对象（这里是线条）而不是调用 glTranslatef 吗？如果是这样，这样的着色器会是什么样子？（我怀疑着色器是错误的方法，因为我的线带不是周期函数，而是包含随机数据）。

3）如果调整窗口大小会发生什么？如何保持纵横比并相应地缩放顶点？glViewport() 仅有助于在 y 方向上缩放，而不是在 x 方向上。如果窗口在 x 方向上重新缩放，那么在我当前的实现中，我将不得不重新计算整个线条的位置（调用`my_func`以获取新的 x 坐标）并将其上传到 GPU。我想这可以更优雅地完成吗？我该怎么做？

4）我注意到，当我使用`glTranslatef`非整数值时，如果线条由数千个点组成，屏幕开始闪烁。这很可能是因为我用来计算线带的精细分辨率与屏幕的像素分辨率不匹配，因此有时一些点出现在前面，有时出现在其他点后面（当你不渲染时，这尤其烦人正弦波，但一些“随机”数据）。我怎样才能防止这种情况发生（除了平移 1 像素的整数倍的明显解决方案）？如果一个窗口的大小从最初的 800x800 像素重新调整为 100x100 像素，并且我仍然想可视化 20 秒的线条，那么在 x 方向上移动必须以某种方式以亚像素精度无闪烁，对吧？

5）如你所见，我总是打电话`glTranslatef(-local_shift, 0.0, 0.0)`- 从来没有做相反的事情。因此，我不断将整个视图向右移动。这就是为什么我需要跟踪绝对 x 位置（以便将新数据放置在正确的位置）。这个问题最终会导致一个伪影，即线条与窗口的边缘重叠。我想一定有更好的方法来做到这一点，对吧？就像保持 x 值固定而只是移动和更新 y 值？

**编辑**我删除了正弦波示例并用更好的示例替换它。我的问题通常是关于如何最有效地在空间中移动线条（同时向它们添加新值）。因此，任何诸如“预先计算 t -> infinity 的值”之类的建议在这里都无济于事（我也可以只绘制在我家门前测量的当前温度）。

**EDIT2** 考虑这个玩具示例，在每个时间步之后，删除第一个点并在末尾添加一个新点：

t = 0

```
 * 
  * *    *
 *   **** *

 1234567890 
```

t = 1

```
 * 
 * *    * *
    **** *

 2345678901 
```

t = 2

```
 *        * 
  *    * *
   **** *

 3456789012 
```

我不认为我可以在这里使用着色器，可以吗？

**编辑 3：**带有两条线带的示例。 ![显示两条线带的示例](../Images/854b81e1db65d9107ce5566ae13bdd32.png)

**编辑4：**根据蒂姆的回答，我现在正在使用以下代码，它运行良好，**但将行分成两部分（因为我有两次调用`glDrawArrays`）**，另请参见以下两个屏幕截图。

![整线](../Images/db9bd0a3dee289a2ce79f74c9cb6e01c.png) ![不完整的线](../Images/1054fe1647a319c8f7426da48615c1a3.png)

```
# calculate the difference 
diff_first = x[1] - x[0]

''' first part of the line '''

# push the matrix
glPushMatrix()

move_to = -(diff_first * c)
print 'going to %d ' % (move_to)
glTranslatef(move_to, 0, 0)

# format of glVertexPointer: nbr points per vertex, data type, stride, byte offset
# calculate the offset into the Vertex
offset_bytes = c * BYTES_PER_POINT
stride = 0
glVertexPointer(2, GL_FLOAT, stride, offset_bytes)  

# format of glDrawArrays:  mode, Specifies the starting index in the enabled arrays, nbr of points
nbr_points_to_render = (nbr_points - c)
starting_point_in_above_selected_Vertex = 0
glDrawArrays(GL_POINTS, starting_point_in_above_selected_Vertex, nbr_points_to_render)  

# pop the matrix
glPopMatrix()

''' second part of the line '''

# push the matrix
glPushMatrix()

move_to = (nbr_points - c) * diff_first
print 'moving to %d ' %(move_to)
glTranslatef(move_to, 0, 0)

# select the vertex
offset_bytes = 0
stride = 0
glVertexPointer(2, GL_FLOAT, stride, offset_bytes)

# draw the line
nbr_points_to_render = c
starting_point_in_above_selected_Vertex = 0
glDrawArrays(GL_POINTS, starting_point_in_above_selected_Vertex, nbr_points_to_render)  

# pop the matrix
glPopMatrix()

# update counter
c += 1
if c == nbr_points:
    c = 0 
```

**EDIT5**生成的解决方案显然必须在屏幕上呈现一行 - 并且没有两行缺少连接。Tim 的循环缓冲解决方案提供了如何移动绘图的解决方案，但我最终得到了两条线，而不是一条。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T20:43:54.783

这是我对修改后的问题的想法：

> 1）我应该使用glMapBuffer来绑定GPU上的缓冲区并直接填充数据（而不是使用glBufferSubData）？或者这对性能没有影响？

我不知道两者之间有什么显着的性能，尽管我可能更喜欢 glBufferSubData。

在您的情况下，我可能会建议创建一个带有 N 个浮点数的 VBO，然后将其用作类似于循环缓冲区。在本地保持一个索引到缓冲区的“结束”所在的位置，然后每次更新都用新值替换“结束”下的值，并增加指针。这样，您只需在每个周期更新一个浮点数。

完成后，您可以使用 2x translates 和 2x glDrawArrays/Elements 绘制此缓冲区：

假设您有一个包含 10 个元素的数组，缓冲区结束指针位于元素 4。您的数组将包含以下 10 个值，其中 x 是一个常数值，f(n- *d* ) 是来自*d*周期前：

```
0: (0, f(n-4) )
1: (1, f(n-3) )
2: (2, f(n-2) )
3: (3, f(n-1) )  
4: (4, f(n)   )  <-- end of buffer 
5: (5, f(n-9) )  <-- start of buffer
6: (6, f(n-8) )
7: (7, f(n-7) )
8: (8, f(n-6) )
9: (9, f(n-5) ) 
```

要绘制这个（伪猜测代码，可能不完全正确）：

```
glTranslatef( -end, 0, 0);
glDrawArrays( LINE_STRIP, end+1, (10-end)); //draw elems 5-9 shifted left by 4
glPopMatrix();
glTranslatef( end+1, 0, 0);
glDrawArrays(LINE_STRIP, 0, end); // draw elems 0-4 shifted right by 5 
```

然后在下一个循环中，用新的随机值替换最旧的值，并将循环缓冲区指针向前移动。

> 2）我应该使用着色器来移动对象（这里是线条）而不是调用 glTranslatef 吗？如果是这样，这样的着色器会是什么样子？（我怀疑着色器是错误的方法，因为我的线带不是周期函数，而是包含随机数据）。

如果您使用我在#1 中描述的方法，可能是可选的。在这里使用一个没有特别的优势。

> 3）如果调整窗口大小会发生什么？如何保持纵横比并相应地缩放顶点？glViewport() 仅有助于在 y 方向上缩放，而不是在 x 方向上。如果窗口在 x 方向上重新缩放，那么在我当前的实现中，我将不得不重新计算整个线带的位置（调用 my_func 以获取新的 x 坐标）并将其上传到 GPU。我想这可以更优雅地完成吗？我该怎么做？

您不必重新计算任何数据。只需在某个对您有意义的固定坐标系中定义所有数据，然后使用投影矩阵将此范围映射到窗口。没有更多细节很难回答。

> 4）我注意到，当我使用具有非整数值的 glTranslatef 时，如果线条由数千个点组成，屏幕就会开始闪烁。这很可能是因为我用来计算线带的精细分辨率与屏幕的像素分辨率不匹配，因此有时一些点出现在前面，有时出现在其他点后面（当你不渲染时，这尤其烦人正弦波，但一些“随机”数据）。我怎样才能防止这种情况发生（除了平移 1 像素的整数倍的明显解决方案）？如果一个窗口的大小从最初的 800x800 像素重新调整为 100x100 像素，并且我仍然想可视化 20 秒的线条，那么在 x 方向上的移动必须以某种方式以亚像素精度无闪烁，对吧？

你的假设似乎是正确的。我认为这里要做的事情要么启用某种抗锯齿（您可以阅读其他帖子以了解如何做到这一点），或者使线条更宽。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-21T06:04:20.750

有很多事情可以在这里发挥作用。

*   glBindBuffer 是最慢的 OpenGL 操作之一（以及对着色器、纹理等的类似调用）
*   glTranslate 调整模型视图矩阵，顶点单元将所有点乘以该矩阵。所以，它只是改变了你乘以的矩阵。如果您要改用顶点着色器，则必须为每个顶点单独翻译它。简而言之：glTranslate 更快。不过，在实践中，这应该无关紧要。
*   如果您每次绘制时都在很多点上重新计算正弦函数，那么您将遇到性能问题（特别是因为通过查看您的源代码，看起来您可能正在使用 Python）。
*   每次绘制 VBO 时都会更新它，因此它并不比顶点数组快。顶点数组比中间模式（glVertex 等）快，但远不及显示列表或静态 VBO。
*   某处可能存在编码错误或冗余调用。

我的判断：

您正在计算 CPU 上的正弦波和偏移量。我强烈怀疑您的大部分开销来自每次绘制时计算和上传不同的数据。这与不必要的 OpenGL 调用和可能不必要的本地调用相结合。

我的建议：

这是 GPU 大放异彩的机会。计算并行数据上的函数值（字面意思）是 GPU 最擅长的。

我建议您制作一个表示您的函数的显示列表，但将所有 y 坐标设置为 0（因此它是沿 y=0 线的一系列点）。然后，为您要绘制的每个正弦波绘制一次完全相同的显示列表。通常，这只会产生一个平面图，但是，您编写一个顶点着色器，将点垂直转换为您的正弦波。着色器对正弦波的偏移量（“sin（x-offset）”）进行统一处理，并仅更改每个顶点的 y。

我估计这将使您的代码至少快十倍。此外，因为顶点的 x 坐标都在整数点上（着色器通过计算“sin(x-offset)”在函数空间中进行“平移”），所以在使用浮点值偏移时不会出现抖动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T23:51:32.900

你在这里有很多东西，所以我会尽我所能。希望这会给你一些研究领域。

> 1）我应该使用glMapBuffer来绑定GPU上的缓冲区并直接填充数据（而不是使用glBufferSubData）？或者这对性能没有影响？

我希望`glBufferSubData`有更好的表现。如果数据存储在 GPU 上，那么映射它要么

*   将数据复制回主机内存，以便您可以修改它，并在取消映射时将其复制回来。
*   或者，给你一个指向 GPU 内存的指针，CPU 将通过 PCI-Express 直接访问它。当我们在 AGP 或 PCI 上访问 GPU 内存时，这并不像以前那样慢，但它仍然比主机内存更慢，而且缓存等方面也没有那么好。

`glSubBufferData`将缓冲区的更新发送到 GPU 并修改缓冲区。没有前后复制。一次突发传输的所有数据。它也应该能够作为缓冲区的异步更新来完成。

一旦你进入“这比那更快吗？” 类型比较你需要开始衡量事情需要多长时间。一个简单的帧计时器通常就足够了（但报告每帧的时间，而不是每秒的帧数 - 它使数字更容易比较）。如果您比这更细粒度，请注意，由于 OpenGL 的异步特性，您经常会看到导致工作的调用消耗的时间。这是因为在你给 GPU 工作负载之后，只有当你必须等待它完成某些事情时，你才会注意到它需要多长时间。这通常仅在您等待前/后缓冲区交换时发生。

> 2）我应该使用着色器来移动对象（这里是线条）而不是调用 glTranslatef 吗？如果是这样，这样的着色器会是什么样子？

没有不同。`glTranslate`修改一个矩阵（通常是模型视图），然后将其应用于所有顶点。如果你有一个着色器，你会为你的所有顶点应用一个平移矩阵。事实上，驱动程序可能已经为您构建了一个小型着色器。

请注意，`glTranslate()`从 OpenGL 3.0 开始，旧 API 之类的 API 已被贬低，而在现代 OpenGL 中，一切都是通过着色器完成的。

> 3）如果调整窗口大小会发生什么？如何保持纵横比并相应地缩放顶点？glViewport() 仅有助于在 y 方向上缩放，而不是在 x 方向上。

`glViewport()`设置渲染到的屏幕区域的大小和形状。经常调用窗口调整大小来将视口设置为窗口的大小和形状。这样做会导致 OpenGL 渲染的任何图像随窗口改变纵横比。为了使事物看起来相同，您还必须控制投影矩阵以抵消更改视口的影响。

类似于以下内容：

```
glViewport(0,0, width, height);
glMatrixMode(GL_PROJECTION_MATRIX);
glLoadIdentity();
glScale2f(1.0f, width / height); // Keeps X scale the same, but scales Y to compensate for aspect ratio 
```

那是凭记忆写的，我的数学可能不正确，但希望你能明白。

> 4）我注意到，当我使用具有非整数值的 glTranslatef 时，如果线条由数千个点组成，屏幕就会开始闪烁。

我认为您看到了一种混叠形式，这是由于线条在像素的采样网格下移动所致。您可以使用各种抗锯齿技术来减少问题。OpenGL 有抗锯齿线（`glEnable(GL_SMOOTH_LINE)`），但很多消费卡不支持它，或者只在软件中支持。你可以试试，但你可能没有效果或运行很慢。

或者，您可以查看多样本抗锯齿 (MSAA)，或您的卡可能通过扩展支持的其他类型。

另一种选择是渲染到高分辨率纹理（通过帧缓冲区对象 - FBO），然后在将其作为纹理四边形渲染到屏幕时对其进行过滤。这也将允许您做一个技巧，每次将渲染的纹理稍微向左移动，并在每一帧的右侧渲染新的条带。

```
1    1
 1  1 1  Frame 1
  11

    1 
1  1 1   Frame 1 is copied left, and a new line segment is added to make frame 2
 11   2

   1
  1 1 3  Frame 2 is copied left, and a new line segment is added to make frame 3
11   2 
```

这不是一个简单的更改，但它可能会帮助您解决问题 (5)。

# sql-server-2008 - 为什么我的 .csv 不保留嵌入式回车/换行符？

> ID：10249473
> 
> 赞同：1
> 
> 时间：2012-04-20T15:54:07.850
> 
> 标签：sql-server-2008, excel, csv, import-from-excel

我有一个 .csv。我有正在上载到 SQL Server 2008 (Express) 中的“ntext(null)”字段类型的列。在此列中可以包含带有嵌入 char(10) 和 char(13) 的自由文本的数据。在 .csv 中，这些单元格受“”保护。我 BULK_INSERT 数据和列不保留回车或换行。真可惜。

上帝知道如何，但不知何故，在 Excel 中只有几个单元格我设法让单元格显示 ascii 换行符（带 ? 的小框）以及实际上在该点明显中断（而不是全部显示在一行上与小盒子）。当我上传这些专栏时，它很好！

关于为什么我的上传不保留换行符和/或如何在 Excel 中为该列获取所有单元格以显示换行符并在该点显示文本中断的任何想法？

# security - 如何限制服务器接收到的 websocket 帧的净长度

> ID：10249478
> 
> 赞同：1
> 
> 时间：2012-04-20T15:54:32.193
> 
> 标签：security, websocket, netty

我正在使用 netty 3.4 实现 WebSocket 服务。

我需要限制帧大小以避免帧非常长的 DoS 攻击。我希望在 32KB 数据后断开连接，即使该帧尚未完成且未传递给我的处理程序。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T03:54:28.973

鉴于目前的[代码](https://github.com/netty/netty/blob/master/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocket08FrameDecoder.java)，目前看起来并不像它。

您必须扩展 WebSocket08FrameDecoder 并更改`toFrameLength()`.

如果有机会，我会为下一个版本提出拉取请求。

# android - 当进程被杀死时，AlarmManager 中的警报会被清除

> ID：10249492
> 
> 赞同：6
> 
> 时间：2012-04-20T15:55:32.640
> 
> 标签：android, process, broadcastreceiver, alarmmanager

我是android的新手，所以请多多包涵。我的主要活动在应该在特定时间触发的警报管理器中创建和警报，我的主要活动还创建广播接收器，它假设接收警报触发的意图，一切正常，直到任务管理器杀死我的应用程序。我检查了 AlarmManager 中的 PendingIntent 列表并验证我的警报是否已从警报管理器中删除，我尝试添加服务并从服务中注册警报，我有红色可能是因为我的广播接收器的 IntentFilter 已定义在代码中而不是在清单中，它在应用程序进程被杀死后被杀死，我在这个问题上停留了两个星期:-(，很困惑，我的设计错了吗？

这是我的需求：

1.  即使应用程序被杀死或即使手机重新启动，警报也会非常可靠。
2.  广播接收器也是如此。

先感谢您，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:00:35.843

如果用户任务杀死或强制停止您的应用程序，您的警报将被取消注册。而且，在 Android 3.1+ 上，在用户手动启动您的一项活动之前，您的任何应用程序都不会再次运行。

对此，您无能为力，只能尽最大努力编写一个用户不需要或不希望强制停止的高质量应用程序。

# android - Android - StackOverflow API

> ID：10249494
> 
> 赞同：1
> 
> 时间：2012-04-20T15:55:41.820
> 
> 标签：android, httprequest, stackexchange-api

我正在尝试从 stackexchange api 中检索一些数据。我做的很简单：

[https://api.stackexchange.com/2.0/questions?order=desc&sort=activity&tagged=android&site=stackoverflow](https://api.stackexchange.com/2.0/questions?order=desc&sort=activity&tagged=android&site=stackoverflow)

我得到这样的东西：

![在此处输入图像描述](../Images/94a85fc7ad7e0cb0096dc0a5c625e1e6.png)

```
public JSONArray latestQuestions(String tagged)
{
    String result = "";
    JSONObject jArray = null;
    JSONArray questions = null;

    String link = api + "questions?order=desc&sort=activity&site=stackoverflow";

    if(tagged != null)
    {           
        link = api + "questions?order=desc&sort=activity&tagged=" + tagged + "&site=stackoverflow";
    }

    DefaultHttpClient client = new DefaultHttpClient();
    try
    {
        Log.i(TAG + " latestQuestions",link);
        HttpGet getQ = new HttpGet(link);
        HttpResponse qResponse = client.execute(getQ);
        HttpEntity entity = qResponse.getEntity();                     
        if (entity != null) 
        {
            result= EntityUtils.toString(entity, HTTP.UTF_8);   
            Log.d("JSON",result);
        }
    }
    catch(Exception e)
    {   
        Log.e(TAG + " latestQuestions","LOADING ERROR");
    }

    try
    {
        jArray = new JSONObject(result);
    }
    catch(JSONException e)
    {
        Log.e(TAG + " latestQuestions","JSON parsing error");
    }

    if(jArray != null)
    {
        try
        {
            questions = jArray.getJSONArray("items");
        }
        catch(JSONException e)
        {
            Log.d("JSON",result.toString());
        }
    }

    return questions;
} 
```

在哪里：

```
String api = "https://api.stackexchange.com/2.0/" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T14:48:41.947

响应应该被压缩...... GZip......查看他们的一些文档。

特别是：[https ://api.stackexchange.com/docs/compression](https://api.stackexchange.com/docs/compression)

要处理解压缩数据，请查看此链接：http: [//developer.android.com/reference/java/util/zip/GZIPInputStream.html](http://developer.android.com/reference/java/util/zip/GZIPInputStream.html)

# matlab - 如何在 MATLAB 中使用颜色条制作完美的正方形图？

> ID：10249496
> 
> 赞同：0
> 
> 时间：2012-04-20T15:55:45.693
> 
> 标签：matlab

出于美学/数据解释的原因，我正在尝试创建一个等高线图（带有颜色条），它的等高线图完全是正方形的。

示例代码：

```
x=-10:10;
y=-10:10;
[X Y] = meshgrid(x,y);
f = figure('Visible','off');
contour(X,Y,X.*Y,'Fill','on');
colorbar
x_size = 10;
y_size = 10;
set(f, 'PaperUnits', 'inches','PaperPosition',[0 0 x_size y_size]);
print(f, '-depsc2','notsquare.eps); 
```

有没有办法控制等高线图区域的尺寸，使其完全是正方形的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:08:15.833

这对我有用（添加`axis equal`）：

```
x=-10:10;
y=-10:10;
[X Y] = meshgrid(x,y);
f = figure('Visible','off');
contour(X,Y,X.*Y,'Fill','on');
colorbar, axis equal
x_size = 10;
y_size = 10;
set(f, 'PaperUnits', 'inches','PaperPosition',[0 0 x_size y_size]);
print(f, '-depsc2','square.eps'); 
```

# php - 使用时区偏移量而不是时区标识符将 GMT 时间转换为本地时间

> ID：10249497
> 
> 赞同：0
> 
> 时间：2012-04-20T15:55:46.540
> 
> 标签：php, datetime, timezone, gmt, timezone-offset

如果您从 PHP 列表中获得时区标识符，那么将给定的 GMT 日期转换为本地时间非常容易：[http ://www.php.net/manual/en/timezones.php](http://www.php.net/manual/en/timezones.php)

例如，您可以这样做（其中 $fromTimeZone 只是 'GMT'，$toTimeZone 只是该列表中的常量之一（即 'America/Chicago'），而 $datetime 是 GMT 日期）：

```
public static function convertToTimezone($datetime, $fromTimeZone, $toTimeZone, $format = 'Y-m-d H:i')
{
    // Construct a new DateTime object from the given time, set in the original timezone
    $convertedDateTime = new DateTime($datetime, timezone_open($fromTimeZone));
    // Convert the published date to the new timezone
    $convertedDateTime->setTimezone(timezone_open($toTimeZone));
    // Return the udpated date in the format given
    return $convertedDateTime->format($format);
} 
```

但是，如果仅给出时区偏移量，我在将相同的 GMT 日期转换为本地时间时遇到问题。例如，我没有给出“美国/芝加哥”，而是给出了 -0500（这是该时区的等效偏移量）。

我已经尝试过以下方法（其中 $datetime 是我的 GMT 日期，$toTimeZone 是偏移量（在本例中为 -0500））：

```
date($format, strtotime($datetime . ' ' . $toTimeZone)) 
```

我知道所有 date() 类型的函数都基于服务器的时区。我似乎无法让它忽略它并使用明确给出的时区偏移量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:20:32.527

您可以将特定偏移量转换为 DateTimeZone：

```
$offset = '-0500';
$isDST = 1; // Daylight Saving 1 - on, 0 - off
$timezoneName = timezone_name_from_abbr('', intval($offset, 10) * 36, $isDST);
$timezone = new DateTimeZone($timezoneName); 
```

然后你可以在 DateTime 构造函数中使用它，例如

```
$datetime = new DateTime('2012-04-21 01:13:30', $timezone); 
```

或使用二传手：

```
$datetime->setTimezone($timezone); 
```

在后一种情况下，如果`$datetime`使用不同的时区构造，则日期/时间将转换为指定的时区。

# mysql - 如果它创建由唯一键定义的重复项，则更新 mysql 中的行并删除该行

> ID：10249498
> 
> 赞同：0
> 
> 时间：2012-04-20T15:55:51.673
> 
> 标签：mysql

我有一个包含很多条目的 MySQL 表。它有一个定义为 (state, source) 的唯一键，因此该列组合没有重复项。但是现在我意识到大部分状态数据都没有一致地输入。例如，在某些行中，它被输入为“CA”，而在其他行中，它可能被拼写为“California”。

我想将所有说“加利福尼亚”的条目更新为“CA”，如果它在唯一键中产生冲突，请删除该行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:17:48.423

您最好转储数据并使用[Google Refine](http://code.google.com/p/google-refine/)等外部工具进行清理。考虑将来使用外键来避免这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:34:52.290

我不认为你可以在一个 SQL 语句中做到这一点。如果你有从其他表到你试图清理的表的外键关系，那么你肯定*不想*一步完成（即使你可以）。

```
CREATE TABLE state_mappings (
    `old` VARCHAR(64) NOT NULL,
    `new` VARCHAR(64) NOT NULL
);

INSERT INTO state_mappings VALUES ('California', 'CA'), ...;

INSERT IGNORE INTO MyTable (state, source)
    SELECT sm.new, s.source from states s JOIN state_mappings sm
        ON s.state = sm.old;

// Update tables with foreign keys here

DELETE FROm MyTable WHERE state IN (SELECT distinct old FROM state_mappings);
DROP TABLE state_mappings; 
```

我不是 SQL 专家，所以这些语句可能可以优化，但你明白了要点。

# javascript - 在另一个函数 jQuery 中使用变量

> ID：10249499
> 
> 赞同：0
> 
> 时间：2012-04-20T15:55:54.800
> 
> 标签：javascript, jquery

我正在尝试使用函数中的变量，但该变量似乎确实有效，因为我试图在函数之外使用它。

我尝试使用的变量称为“viewportwidth”，我也尝试在第一个“orientationchange resize”函数之后使用它。

无论如何在我的函数之外使用这个变量。我在一个名为“sidebarwidth”的新变量中的第一个函数下方尝试了它

请看下面的代码。任何人都可以帮忙吗？

```
$(window).bind("orientationchange resize", function(e) {

    <?php if(strstr($_SERVER['HTTP_USER_AGENT'],'iPhone') || strstr($_SERVER['HTTP_USER_AGENT'],'iPod')) echo "$('#wrapper, #sidebar').addClass('iphone-min-height');" ; ?> 

    var viewportwidth;
    var viewportheight;

    // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight

    if (typeof window.innerWidth != 'undefined')
    {
        viewportwidth = window.innerWidth,
        viewportheight = window.innerHeight
    }

    // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)

    else if (typeof document.documentElement != 'undefined'
        && typeof document.documentElement.clientWidth !=
        'undefined' && document.documentElement.clientWidth != 0)
    {
        viewportwidth = document.documentElement.clientWidth,
        viewportheight = document.documentElement.clientHeight
    }

    // older versions of IE

    else
    {
        viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
        viewportheight = document.getElementsByTagName('body')[0].clientHeight
    }

    $( '#wrapper' ).css( {
       'width'   : viewportwidth + 'px',
       'height'  : viewportheight + 'px'
    });

    var iWebkit;

    if(!iWebkit){
        iWebkit=window.onload=function(){
            function fullscreen(){
                var a=document.getElementsByTagName("a");
                for(var i=0;i<a.length;i++){
                    if(a[i].className.match("noeffect")){}

    else{a[i].onclick=function(){
        window.location=this.getAttribute("href");return false}}}}
            function hideURLbar(){window.scrollTo(0,0.9)}iWebkit.init=function(){
            fullscreen();
            hideURLbar()
        };
    iWebkit.init()}}

}).trigger("resize");

var     $openClose      = $("span.open-menu"),
        buttonwidth     = $openClose.outerWidth(),
        sidebarwidth    = viewportwidth - buttonwidth,
        $wrapper        = $("#wrapper"),
        $sidebar        = $("#sidebar"),
        menuOpen        = false;

$sidebar.css({
    'left' : '-210px',
    'width' : sidebarwidth + 'px'
});

$openClose.on('click', function () {

    if (menuOpen) { // run if button says "Close Menu"

        $sidebar.stop().animate({ left: "-" + sidebarwidth + "px" }, 400);   
        $openClose.html("Menu");
        $(this).addClass('active');
        menuOpen = false;

    } else { // run if button says "Open Menu"

        $sidebar.stop().animate({ left: "0" }, 400);
        $openClose.html("Close");
        $(this).removeClass('active');
        menuOpen = true;

    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:15:00.307

你为什么做这个 ？！

```
<?php 
if( strstr($_SERVER['HTTP_USER_AGENT'],'iPhone') 
    || strstr($_SERVER['HTTP_USER_AGENT'],'iPod'))
{
    echo "$('#wrapper, #sidebar').addClass('iphone-min-height');" ; 
}
?> 
```

这简直是**​​愚蠢**！而不是使用 jQuery 来做这件事，你应该设置`<body class="has-iphone">`. 没有必要使用英国媒体报道。

* * *

这是没有意义的。

```
if (typeof window.innerWidth != 'undefined')
{
    viewportwidth = window.innerWidth,
    viewportheight = window.innerHeight
}

// IE6 in standards compliant mode (i.e. with a valid doctype as 
//the first line in the document)

else if (typeof document.documentElement != 'undefined'
    && typeof document.documentElement.clientWidth !=
    'undefined' && document.documentElement.clientWidth != 0)
{
    viewportwidth = document.documentElement.clientWidth,
    viewportheight = document.documentElement.clientHeight
}

// older versions of IE

else
{
    viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
    viewportheight = document.getElementsByTagName('body')[0].clientHeight
} 
```

没有人支持 IE6 了，哪个是“旧 IE”？你真的期待有IE5.5的人吗？！这只是复制粘贴的一个糟糕案例......

* * *

至于原来的问题，如果你想在两个或多个函数之间共享变量，而不是将其放在全局范围内，那么使用闭包：

```
var handlers = (function () {
        var shared_variable,
            current;
        return {
            click: function (e) {
               // code for click handler
            },
            mouseover: function (e) {
            },
            mouseout: function (e) {
            }
       };

    }()),
    menu = document.getElementById('menu');

$(document).on('click', handler.click);
$(menu).on('mouseover', handler.mouseover);
$(menu).on('mouseout', handler.mouseout); 
```

所有函数都将共享`current`变量，例如，在构建响应式菜单时非常有用。

* * *

**PS**另外，您应该尽量避免在 javascript 中设置 css 值。首先，它违反了[SoC](http://en.wikipedia.org/wiki/Separation_of_concerns)，并且它还会在您设置的每个值上触发浏览器中的[*Reflow*](http://www.bitcurrent.com/browser-rendering-and-web-performance-reflow/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:59:38.860

`orientationchange`在和的处理程序之外声明变量`resize`。我还建议将所有内容包装在一个闭包中以避免污染全局命名空间：

```
(function(){
    var viewportwidth;
    var viewportheight;

    $(window).bind("orientationchange resize", function(e) {
    // Rest of your current code

})(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T15:59:10.953

将变量移到更高的范围；然后它应该对这两个功能都可用。

如果它们是全局变量，那么两个函数都应该能够看到它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T15:59:18.520

`viewportwidth`从函数中取出使其`resize`成为某个全局对象的全局或属性，然后在调整大小时设置该变量，`onclick`从中计算各种值`viewportwidth`并使用它们。

# java - 是否有可行的手写识别库/程序？

> ID：10249501
> 
> 赞同：6
> 
> 时间：2012-04-20T15:56:13.530
> 
> 标签：java, r, machine-learning, ocr

我正在寻找处理一堆扫描的回复明信片，上面有**手写**的联系信息（即姓名、地址、电话、电子邮件等）。

我很好奇是否有一个可行的开源库或软件可以做到这一点（最好是 Java 或 R）。环顾四周，很多信息都是 2009 年或早期的，并不是很令人鼓舞。

语言是英语。

有什么建议么？

编辑：我查看了 OCRopus 页面，但最新版本是 2009 年 5 月。任何人对此有任何经验或是否有更新的版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:01:09.577

您可能想查看[http://code.google.com/p/ocropus/](http://code.google.com/p/ocropus/)，这是一个开源 OCR 系统。

但是，它似乎是用 C++ 和 python 编写的。

**更新：**

由于其中一个研究项目是手写分析仪，我希望它可能会有所帮助。

> OCRopus 引擎基于两个研究项目：90 年代中期开发并由美国人口普查局部署的高性能手写识别器，以及新颖的高性能布局分析方法。

如果您查看[http://code.google.com/p/ocropus/source/browse/](http://code.google.com/p/ocropus/source/browse/)源文件自 10/2011 以来已更新（三个之一来自 3/2012），所以它似乎是目前仍在开发中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:05:53.393

我不知道有任何可用的开源手写识别库，不管我已经在 OCR 领域工作了一段时间。通常手写比 OCR 更难，我会说甚至没有像样的商业解决方案。所有存在的都有自己的问题，只能在非常狭窄的应用程序中工作，比如字典有限、文本写得很好等。如果你仍然感兴趣，我建议你检查法国公司 I2IA 的技术

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T13:22:26.957

首先，据我所知，没有原生的开源 Java OCR SDK。有一些 Java API 封装了对本机接口的调用，即 tesjeract ( [http://code.google.com/p/tesjeract/](http://code.google.com/p/tesjeract/) ) 或 Tess4J ( [http://tess4j.sf.net/](http://tess4j.sf.net/) )。

接下来，您需要指定是查找手写文本还是手写文本。如果您需要手写文本识别 - 由于其他答案中所述的原因，我不相信您将能够解决您的任务。

但是，如果您需要 ICR（代表智能字符识别）用于手写文本（在调查、表格等中使用清晰的字母），则可能有解决方案。虽然我相信 tesseract（尽管被认为是开源引擎中最好的）在这里无法为您完成这项工作，但您可以寻找更准确的 SDK。

也许这个问题会有所帮助：[手写扫描文档到 .txt 文件？](https://stackoverflow.com/questions/8723013/handwritten-scanned-doc-to-txt-file/8800678#8800678)

# jquery - 尝试动画/更改文本颜色的jQuery导航菜单问题

> ID：10249503
> 
> 赞同：0
> 
> 时间：2012-04-20T15:56:28.657
> 
> 标签：jquery, menu, navigation

我有一个导航菜单，它使用 jquery 来提供一些动画效果。

不幸的是，有些事情不太正常。

当您使用 animate_color 函数（被成功调用）悬停时，颜色应该会改变

我已经在 jsfiddle 中设置了它供您查看：

[http://jsfiddle.net/d52Z6/1/](http://jsfiddle.net/d52Z6/1/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:02:58.597

我相信您还需要加载 jQuery UI。请参阅此**[jsFiddle 示例](http://jsfiddle.net/j08691/d52Z6/6/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:05:40.373

试试这个：

```
 .menu-item:hover {color:#fff} 
```

# php - PHP SQL Query比较搜索类别的值和记录集中的值？

> ID：10249508
> 
> 赞同：0
> 
> 时间：2012-04-20T15:56:36.447
> 
> 标签：php, mysql, sql

我正在尝试将我的 SQL 查询更改为使用 BETWEEN 搜索/比较 LIKE 以从特定字段中获取 >= 搜索值的所有值......到目前为止无法使其工作。

```
 $searchcat = "brand";
  if (isset($_POST['searchcat'])) {
  $searchcat = $_POST['searchcat']; 
}
$selectVal = "LIKE %s";
if ($searchcat == 'quantity') {
$selectVal = "BETWEEN %s";
}else{
$selectVal == "LIKE %s";
}
mysql_select_db($database_prp, $prp);
$query_paperlist = sprintf("SELECT * FROM paperlist WHERE $searchcat $selectVal ORDER BY paperid ASC", GetSQLValueString("%" . $colname_paperlist . "%", "text"));
$query_limit_paperlist = sprintf("%s LIMIT %d, %d", $query_paperlist, $startRow_paperlist, $maxRows_paperlist);
$paperlist = mysql_query($query_limit_paperlist, $prp) or die(mysql_error());
$row_paperlist = mysql_fetch_assoc($paperlist); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:16:41.087

基于[Mysql Docs](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_between)，它是`Between ... And`。它更像是`1<x<10`。我认为在你的情况下`Not (Between ... And ...)`更合适的是`not(1<x<10)=x<1 || x>10`. `Not (Between ... And ...)`可用于大于运算符。你只需要确保你的小于永远不会是真的。

# php - Debian Squeeze - PHP5 mysqlnd

> ID：10249509
> 
> 赞同：0
> 
> 时间：2012-04-20T15:56:43.120
> 
> 标签：php, mysqli, debian

我正在尝试在我的新 debian 挤压 LAMP 服务器上获得 mysql 本机驱动程序支持，但在我的一生中，我无法让它工作。php mysqli fetch_all 在我的代码中被大量使用，所以我需要 mysqlnd 支持。我已经通过 apt-get 安装了 php5-mysql 包，根据我读过的所有内容，它支持 mysqli 但我仍然无法让 fetch_all() 工作。一定有一些明显的东西我错过了。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:38:16.457

Use alternative repositories such as:

**DotDeb**

[http://dotdeb.org](http://dotdeb.org)

See "Instructions" page, or download package.

**ONE2TEAM**

[http://deb.one2team.ru](http://deb.one2team.ru)

(mirror of dotdeb's php5, and some other php modules)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T19:07:58.163

我最近也在研究这个。Squeeze 的常规 Debian 软件包中似乎不支持它。通过替代包[php5-mysqlnd](http://packages.debian.org/search?keywords=php5-mysqlnd)将其添加到测试和不稳定。

您可以尝试查找第三方 php 包，或者您始终可以自己构建支持 mysqlnd 的 php。这是[包维护者](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=576412#57)的回复。

```
apt-get install php5-dev
cd /tmp
apt-get source php5
cd  /tmp/php5-5.3.6/ext/mysqlnd
mv config9.m4 config.m4
sed -ie "s{ext/mysqlnd/php_mysqlnd_config.h{config.h{" mysqlnd_portability.h
phpize
./configure
cd /tmp/php5-5.3.6/ext/mysql
phpize
./configure --with-mysql=mysqlnd
make && make install
cd /tmp/php5-5.3.6/ext/mysqli
phpize
./configure --with-mysqli=mysqlnd
make && make install 
```

# objective-c - 可点击的 UISlider

> ID：10249510
> 
> 赞同：2
> 
> 时间：2012-04-20T15:56:44.387
> 
> 标签：objective-c, ios, uislider

我想让我的 UISlider 可点击 - 将点击时的值更改为“空白”，例如它设置为零，我点击滑块的中间，它会“跳”到中间。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:12:11.197

我想提出类似于 jrtc27 的东西，但没有子类化：将 a 添加[`UI(Tap)GestureRecognizer`](https://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizer_Class/Reference/Reference.html)到滑块。

```
UISlider *slider = [[[UISlider alloc] init] autorelease];
//configure slider
UITapGestureRecognizer *tapGestureRecognizer = [[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(sliderTapped:)] autorelease];
[slider addGestureRecognizer:tapGestureRecognizer];

- (void)sliderTapped:(UIGestureRecognizer *)gestureRecognizer {
    UISlider *slider = (UISlider *) gestureRecognizer.view;
    //setValue 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:10:13.520

对其进行子类化，然后更改 -touchesBegan 方法。如果触摸距离足够远，则调用-setValue:，否则调用超级实现（如果您希望它始终跳转，则可以始终调用-setValue:）。

# django - 如何 Django 的 InlineModelAdmin TabularInline 或 StackedInline 显示缩略图

> ID：10249517
> 
> 赞同：1
> 
> 时间：2012-04-20T15:57:25.633
> 
> 标签：django, django-admin, thumbnails

行政

```
class PersonInlines(admin.StackedInline):
    model = Person
    extra = 0

class CompanyAdmin(admin.ModelAdmin):
    inlines = (PersonInlines,)
    fields = ('name', )

admin.site.register(Company, CompanyAdmin)

class PersonAdmin(admin.ModelAdmin):
    def image_thumbnail(self, obj):
        if obj.photo:
            image = FileObject(obj.photo.name)
            if image.filetype == "Image":
                return '<img src="%s" />' % image.version_generate(ADMIN_THUMBNAIL).url
    else:
        return ""

    image_thumbnail.allow_tags = True
    image_thumbnail.short_description = "Thumbnail"

    fields = ('first_name', 'last_name', 'photo')
    list_display = ('first_name', 'last_name', 'photo',)

admin.site.register(Person, PersonAdmin) 
```

* * *

楷模

```
def upload_to(instance, filename):
    filename = time.strftime('%Y%m%d%H%M%S')
    ym = time.strftime('%Y%m')
    return 'uploads/%s/%s.jpg' % (ym,filename)

class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)

    photo = models.ImageField(u"Image (Upload)",upload_to=upload_to)
    company = models.ForeignKey('Company')

    def image(self):
        if self.photo:
            return FileObject(self.photo.name)
        return None

class Company(models.Model):
    name = models.CharField(max_length=30)
    def __unicode__(self):
        return self.name 
```

错误“PersonAdmin.fields”指的是表单中缺少的字段“image_thumbnail”。

如何 Django 的 InlineModelAdmin TabularInline 或 TabularInline 显示缩略图

像这样

[http://i.stack.imgur.com/hz2Ep.jpg](http://i.stack.imgur.com/hz2Ep.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:01:26.303

你必须参考`image_thumbnail`而不是参考`photo`。

```
fields = ('first_name', 'last_name', 'image_thumbnail') 
```

尽管您可能会考虑使用这种[mixin-approach](http://haineault.com/blog/174/)。

# c# - 如何从嵌入式资源中提取图像到临时文件夹然后执行它？

> ID：10249519
> 
> 赞同：1
> 
> 时间：2012-04-20T15:57:34.267
> 
> 标签：c#, .net, resources, embedded-resource

我有一个应用程序，它从源文件编译另一个 winform 应用程序并`.resources`在运行时创建一个文件，然后在编译时将 .resources 文件添加为嵌入式资源。我用于创建新`.resources`文件的代码如下：

```
 // Creating .resources file from a file named Photo.jpg

        string myfile = "photo.jpg";
        using (ResourceWriter rw = new ResourceWriter(@".\photoRes.resources"))
         {
           rw.AddResource("MyPhoto",File.ReadAllBytes(myfile));
         } 
```

然后这个资源文件将作为嵌入式资源添加到编译的程序中。下面的行将完成这项工作

```
 // -- -- -- inside the CompileExecutable() function -- -- --
         CompilerParameters cp = new CompilerParameters();
         ..
         ..
         if (provider.Supports(GeneratorSupport.Resources))
            {
                cp.EmbeddedResources.Add("bindedfile.resources");
            }
         .. 
         .. 
```

到目前为止，一切正常，我们从源文件编译的编译程序将是（程序大小+图片大小）。

图片现在是该文件的嵌入式资源。所以为了访问图片，提取并执行它，需要在该文件的源代码中添加一些代码行，对吗？

我的问题是应该在`source.cs`文件中写入什么来告诉它提取作为它的嵌入式资源的图像，然后从临时文件夹中执行它。

当我将下面的行添加到 source.cs

```
string[] arrayofstrings = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceNames();
        foreach(string s in arrayofstrings) {MessageBox.Show(s);} 
```

它向我显示了一个带有此文本的消息框：`photoRes.resources`

如何读取嵌入资源并将图像提取到临时文件夹然后执行它？哪些行要添加到 source.cs ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:14:18.690

此支持文章[如何使用 Visual C# 嵌入和访问资源](http://support.microsoft.com/kb/319292)。

```
_imageStream = _assembly.GetManifestResourceStream("MyNameSpace.MyImage.bmp"); 
```

# c - 如何从 ml64.exe（MSVC 64 位 X64 汇编程序）访问线程本地存储？

> ID：10249522
> 
> 赞同：1
> 
> 时间：2012-04-20T15:58:02.840
> 
> 标签：c, windows, assembly, thread-local, thread-local-storage

以下 C 函数尝试使用线程本地存储变量以线程安全的方式防止多核代码中的递归。但是，由于有些复杂的原因，我**需要**在 X64 汇编程序（Intel X86 / AMD 64 位）中编写此函数，并使用 VC2010 中的 ml64.exe 进行汇编。如果我使用全局变量，我知道如何执行此操作，但我不确定如何使用具有 __declspec(thread) 的 TLS 变量正确执行此操作。

```
__declspec(thread) int tls_VAR = 0;
void norecurse(  )
{
    if(0==tls_VAR)
    {
        tls_VAR=1;
        DoWork();
        tls_VAR=0;
    }
} 
```

注意：这是 VC2010 为该功能踢出的。但是，MASM (ml64.exe) 不支持代码的一部分`gs:88`或`OFFSET FLAT:`部分。

```
; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

include listing.inc

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC  norecurse
EXTRN   DoWork:PROC
EXTRN   tls_VAR:DWORD
EXTRN   _tls_index:DWORD
pdata   SEGMENT
$pdata$norecurse DD imagerel $LN4
    DD  imagerel $LN4+70
    DD  imagerel $unwind$norecurse
pdata   ENDS
xdata   SEGMENT
$unwind$norecurse DD 040a01H
    DD  06340aH
    DD  07006320aH
; Function compile flags: /Ogtpy
xdata   ENDS
_TEXT   SEGMENT
norecurse PROC
; File p:\hackytests\64bittest2010\64bittest\64bittest.cpp
; Line 19
$LN4:
    mov QWORD PTR [rsp+8], rbx
    push    rdi
    sub rsp, 32                 ; 00000020H
; Line 20
    mov ecx, DWORD PTR _tls_index
    mov rax, QWORD PTR gs:88
    mov edi, OFFSET FLAT:tls_VAR
    mov rbx, QWORD PTR [rax+rcx*8]
    cmp DWORD PTR [rbx+rdi], 0
    jne SHORT $LN1@norecurse
; Line 22
    mov DWORD PTR [rbx+rdi], 1
; Line 23
    call    DoWork
; Line 24
    mov DWORD PTR [rbx+rdi], 0
$LN1@norecurse:
; Line 26
    mov rbx, QWORD PTR [rsp+48]
    add rsp, 32                 ; 00000020H
    pop rdi
    ret 0
norecurse ENDP
_TEXT   ENDS
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-16T19:43:10.337

正如您的回答表明问题归结为在 Microsoft 的 C++ 编译器生成的汇编列表中找到以下两行的 MASM 等效项：

```
mov rax, QWORD PTR gs:88
mov edi, OFFSET FLAT:tls_VAR 
```

第一行很简单。只需替换`gs:88`为`gs:[88]`.

第二行不太明显。`OFFSET FLAT:`运营商是红鲱鱼。这意味着使用相对于“FLAT”段开头的偏移量。对于 32 位版本的 MASM，FLAT 段是包含整个 4G 地址空间的段。这是用于代码和数据段的段，作为 32 位平面内存模型的一部分。MASM 的 64 位版本不支持内存模型，它本质上总是假定平面内存模型的 64 位版本，因此它不支持 FLAT 关键字。结果，普通`OFFSET`运算符的结尾含义相同。（实际上对于 32 位汇编器，plain`OFFSET`通常也意味着同样的事情，因为 PECOFF 只支持平面内存模型。）

但是`OFFSET`在这里使用是行不通的。那是因为它将使用`tls_VAR`内存中地址相对于地址0的偏移量。或者换句话说，它将使用`tls_VAR`内存中的绝对地址。这里需要的是相对于 TLS 数据段开头的偏移量。

所以编译器必须在这里做一些特别的事情。为了找出答案，我在编译您的示例 C 代码时生成的目标文件中转储了重定位：

```
> dumpbin /relocations t215a.obj
...  
RELOCATIONS #4
                                                Symbol    Symbol
 Offset    Type              Applied To         Index     Name
 --------  ----------------  -----------------  --------  ------
 00000008  REL32                      00000000        14  _tls_index
 00000016  SECREL                     00000000         8  tls_VAR
 0000002D  REL32                      00000000         C  DoWork
... 
```

如您所见，它会生成类型的重定位以`SECREL`供引用`tls_VAR`. 这使得重定位相对于该符号出现在生成的可执行文件中的节的基部。在这种情况下，这就是`.tls`节，因此此重定位会生成相对于用于静态 TLS 数据的节的开头的偏移量。

所以现在的问题变成了如何让 MASM 生成编译器发出的相同的 SECREL 重定位。事实证明这也有一个简单的解决方案，只需替换`OFFSET FLAT:`为`SECTIONREL`.

因此，通过这些更改（以及一些优化），您的功能变为：

```
 EXTERN  tls_VAR:DWORD
    EXTERN  _tls_index:DWORD
    EXTERN  DoWork:PROC

    PUBLIC  norecurse
_TEXT SEGMENT
norecurse PROC
    push rbx
    sub rsp, 32
    mov rax, gs:[88]
    mov ecx, _tls_index
    mov rbx, [rax + rcx * 8]
    cmp DWORD PTR [rbx + SECTIONREL tls_VAR], 0
    jne return
    mov DWORD PTR [rbx + SECTIONREL tls_VAR], 1
    call DoWork
    mov DWORD PTR [rbx + SECTIONREL tls_VAR], 0
return:
    add rsp, 32
    pop rbx
    ret
norecurse ENDP
_TEXT ENDS
    END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T16:30:36.623

我能够解决这个问题。我在汇编中的实现比 C 编译器生成的代码效率低，因为我无法弄清楚如何使用以下两种寻址模式：

1.  mov rax, QWORD PTR gs:88
2.  mov edi，偏移平面：tls_VAR

对于 (1)，我必须将 88 加载到 rax 并使用 gs:[rax] 来访问线程的 TLS 基础。

对于 (2)，`OFFSET FLAT`MASM (ml64.exe) 中的缺失意味着我必须更加聪明。`_tls_start`我通过从线程的 TLS 基数中减去可应用于汇编程序中的 TLS 变量以访问其线程本地值的线程来计算偏移量。

```
PUBLIC  norecurse
EXTRN   _tls_index:DWORD
EXTRN   _tls_start:DWORD
EXTRN   tls_VAR:DWORD
EXTRN   DoWork:PROC

_TEXT   SEGMENT

norecurse           PROC
    ; non-volatile
    push            rbx
    sub             rsp,32

    ; The gs segment register refers to the base address of the TEB on x64.
    ; 88 (0×58) is the offset in the TEB for the ThreadLocalStoragePointer member on x64
    mov             rax,88
    mov             edx, DWORD PTR _tls_index
    mov             rax, gs:[rax]
    mov             r11, QWORD PTR [rax+rdx*8]
    lea             r10, _tls_start
    ; r11 will be the the offset-adjusted TLS-Base
    sub             r11, r10

    ; ebx will be the the thread local address of tls_VAR
    lea             rdx, tls_VAR
    lea             rbx,[r11+rdx]

    cmp             DWORD PTR [rbx], 0
    jne             @F

    mov             DWORD PTR [rbx], 1

    call            DoWork

    mov             DWORD PTR [rbx], 0
@@:

    add             rsp,32
    pop             rbx

    ret
norecurse       ENDP

_TEXT   ENDS

    END 
```

我很想看到更有效的方法或指针，说明如何实际使用我无法用 MASM (ml64.exe) 弄清楚的两种寻址模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:30:30.190

查看[TlsGetValue](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686812%28v=vs.85%29.aspx)、 TlsSetvalue 和朋友。

# cygwin - Coverity 设置（Cygwin 警告）？

> ID：10249536
> 
> 赞同：1
> 
> 时间：2012-04-20T15:59:08.830
> 
> 标签：cygwin, installation, coverity-prevent, anthill

我目前正在尝试运行 Coverity Prevent，并且我相信我已经在我的 Windows 7 构建机器上正确设置了所有内容。我已经用 AnthillPro 运行它，当我的代码完成并到达 Coverity 时，它说一切都构建得很好，我得到的唯一错误是：

```
Warning: Cygwin pathname conversion ignored; no applicable
         'bash'/'mount', 'cygpath', or registry keys found. 
```

我什至尝试安装 Cygwin 看看这是否可以解决问题，但我仍然遇到同样的错误。

* * *

我目前正在使用 AnthillPro 3.7 和 Coverity 5.5.3。构建日志说我有警告但没有错误，并且它没有发出任何东西。我试图直接从机器（而不是服务器）本身运行脚本，但我遇到了与在 Anthill 中使用 Coverity Prevent 相同的错误

这是我在构建日志底部获得的唯一信息。

```
Run from AnthillPro:
Build time (cov-build overall): 00:00:17.753597

[WARNING] No files were emitted. This may be due to a problem with your configuration
or because no files were actually compiled by your build command.
Please make sure you have configured the compilers actually used in the compilation.
For more details, please look at: 
  d:\Coverity\Intermediate\AllToolsProjects.sln_pc_vs2010\build-log.txt

Run from Script:
  The cov-build FAILED.

This may be because less than 90 percent of units were successfully compiled
Check for errors here:

  D:\\Coverity\Scripts\build_AllToolsProjects.sln_pc_vs2010.bat
  D:\\Coverity\Intermediate\AllToolsProjects.sln_pc_vs2010\build-log.txt
  D:\\Coverity\Configuration\pc_vs2010 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:23:37.577

听起来您还没有配置编译器 - 那是您告诉您的 Coverity Analysis 安装您正在使用哪个编译器。 `devenv`不是编译器，`cl.exe`是。

运行以下命令：

```
coverity-analysis-dir/bin/cov-configure --msvc 
```

这将表示您正在使用`cl.exe`编译器，并且`msvc`无论它安装在哪里，它都是类型。

然后重新运行 Coverity 构建，看看它是否捕获了更多的编译。

# javascript - 关于为嵌套集合构建模板的建议

> ID：10249540
> 
> 赞同：1
> 
> 时间：2012-04-20T15:59:21.473
> 
> 标签：javascript, meteor

我在 mongo 中有一个树结构，每个节点都有其父节点的 id。像这样的东西：

```
{ "_id" : 1 }
{ "_id" : 2, "parent" : 1 } 
```

整个树是通过使用这些模板递归渲染每个节点来渲染的：

```
<template name="thing">
      <div class="project open {{status}}" data-id="{{_id}}" id="thing_{{_id}}">
          <div class="name">{{name}}</div>
          <div class="children" id="children_{{_id}}">
              {{> childrenThings }}
          </div>
      </div>
</template>

<template id="childrenThings" name="childrenThings">
    {{#each children}}
      {{> thing}}
    {{/each}}
</template> 
```

其中模板“thing”调用模板“childrenThings”，该模板再次调用模板“thing”，依此类推，直到重新渲染所有节点。

现在，当我更改嵌套项目时，我看到所有节点，直到其根父节点都被重新渲染。我应该如何设置模板以便仅重新呈现当前模板而不是其所有父节点直到根节点？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T02:15:23.433

当子模板重新渲染时，它们会触发父模板的渲染回调。所以这并不意味着你的整个父树已经从 DOM 中移除并重新放上去。这只是意味着模板范围内的*某些*DOM 节点已被渲染。这有点令人困惑。如果您注意到闪烁或其他一些奇怪的行为，那就不同了。但是你的代码对我来说看起来不错。

# ruby-on-rails-3 - rails 3 unit test - 定义将在每次测试之前运行的通用设置方法

> ID：10249547
> 
> 赞同：3
> 
> 时间：2012-04-20T15:59:45.577
> 
> 标签：ruby-on-rails-3, unit-testing

我想**`db`**在每次运行测试之前清除我的，我应该把脚本放在哪里来实现这种行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:31:54.890

虽然我无法想象你为什么要这样做，但也许你可以试试这个：[https ://github.com/bmabey/database_cleaner](https://github.com/bmabey/database_cleaner)

在任何情况下，可以在每次测试之前调用的语句都应该放在 setup 调用中：

```
setup do
    # statements executed on start of every test
end 
```

**更新**：解释一下：

您可以做的一件事是在您的`test_helper.rb`文件中：

```
class ActiveSupport::TestCase

  ### Common setup for all tests ###
  setup do
      # write code to clean up your database here
  end

end 
```

然后在你的实际测试文件中，你有从你派生的测试类`ActiveSupport::TestCase`只需要`require 'test_helper'`.

这样，在您运行的每个测试之前，都会执行设置代码。

这是否更能解释我在第一个答案中所写的内容？

# c++ - 转发声明未命名结构的 typedef

> ID：10249548
> 
> 赞同：8
> 
> 时间：2012-04-20T15:59:46.810
> 
> 标签：c++, forward-declaration

> **可能重复：**
> [未命名结构的前向声明](https://stackoverflow.com/questions/7256436/forward-declarations-of-unnamed-struct)

如果我有

```
typedef struct tagPAGERANGE
{
    int iFirstPage;
    int iLastPage;
} PAGERANGE; 
```

我可以这样转发声明

```
struct tagPAGERANGE;
typedef struct tagPAGERANGE PAGERANGE; 
```

但我所拥有的是

```
typedef struct
{
    int iFirstPage;
    int iLastPage;
} PAGERANGE; 
```

我不确定我该怎么做。我只想持有一个指向这个结构的指针。现在我要么包含一个相当大的标题，要么复制结构的定义。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T16:02:09.897

不可能。您只能声明命名结构。

想想是什么标识了一个没有名称的结构，以及如何告诉编译器它就是你想要的那个结构。如果它没有名称，则由其成员标识，因此您需要提供成员——即定义它。因此，您不能*只*声明它——除了定义本身之外，您没有奢侈的标识符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:15:47.310

由于这是在 C++ 代码中使用的，所以完全摆脱 typedef，它们在 C++ 中是不必要的和不好的风格。

真正的解决方案是只使用命名结构：

```
struct foo; // forward declaration

struct foo {
    // … implementation
}; 
```

typedef 没有用。

# c# - 处理自定义对象

> ID：10249549
> 
> 赞同：2
> 
> 时间：2012-04-20T15:59:56.683
> 
> 标签：c#, garbage-collection, idisposable

是否有必要处理自定义对象，即使它们只包含托管对象？例如，我有一个自定义类，其中包含一些 List 对象，以及一些字符串和 xmldocument 类型。我是否应该创建自己的 Dispose 方法（而不是从 IDisposable 继承）并清除它们以确保它们为空？如果我应该，我是否也应该从 IDisposable 继承？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:01:27.300

仅当这些托管对象中的一个或多个从 IDisposable 继承时。

如果您有 IDisposable 对象（也称为托管资源），则实现 IDisposable 但不要*添加*析构函数/终结器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:02:10.293

根据经验，`IDisposable`如果您引用的任何托管对象实例实现了，则您应该实现`IDisposable`。然后，您可以在您的`Dispose`实现中处理它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:06:44.460

你看，`null`在你的对象生命周期结束时设置引用不会改变垃圾收集器的任何东西。如果对包含对象的唯一剩余引用来自您的自定义对象，那么垃圾收集器无论如何都会将它们视为符合垃圾收集条件（因为它只查找来自活对象的引用）。如果有来自其他地方的引用，则无论您是否清理引用，都不会收集包含的对象。

当然，另一个故事是，当您的某些包含的对象需要显式处理时，即 implements`IDisposable`或需要在生命周期结束时关闭（尽管正确的方法是无论如何都可以实现`IDisposable`）等等。这样你也许需要`IDisposable`自己实现，并在你的`Dispose`.

当然，`IDisposable`当您引用*非托管*对象时，您需要以特殊方式实现，但这是[另一回事](http://msdn.microsoft.com/en-us/library/b1yfkh5e.aspx)。

# c# - 如何使用 linq-to-sql 检查 sql server 中的字符串是否至少包含本地列表中的一个字符串？

> ID：10249552
> 
> 赞同：0
> 
> 时间：2012-04-20T16:00:20.740
> 
> 标签：c#, linq-to-sql

在我的数据库字段中，我有一个`Positions`字段，其中包含以空格分隔的位置代码列表。我需要向我的查询添加条件，以检查任何本地指定的位置代码是否与字段中的至少一个位置代码匹配。

例如，我有一个包含`"RB"`and的本地列表`"LB"`。我想要`OL LB`找到一个位置值为 的记录，以及位置值为 的`RB OT`记录，但不是位置值为的记录`OT OL`。

使用 AND 子句，我可以通过

```
foreach (var str in localPositionList)
    query = query.Where(x => x.Position.Contains(str); 
```

但是，我需要将其作为或子句链接在一起。如果我不处理 Linq-to-sql （所有普通集合），我可以这样做

```
query = query.Where(x => x.Positions.Split(' ').Any(y => localPositionList.contains(y))); 
```

但是，这不适用于 Linq-to-sql，因为它无法将拆分转换为 SQL，因此会发生异常。

有没有办法做到这一点？

我试图拒绝将这些数据从该表中拆分到其他表中，因为该表的唯一目的是提供优化的数据“缓存”，需要最少数量的表才能获得搜索结果（最终我们将把这部分移到 Solr，但由于日程安排，目前不可行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:35:49.667

我能够通过使用单独的查询并在结果上运行 a 来获得一个测试版本`Union`。我的代码很粗糙，因为我只是在破解，但在这里......

```
 List<string> db = new List<string>() {
            "RB OL",
            "OT LB",
            "OT OL"
        };

        List<string> tests = new List<string> {
            "RB", "LB", "OT"
        };

        IEnumerable<string> result = db.Where(d => d.Contains("RB"));

        for (int i = 1; i < tests.Count(); i++) {
            string val = tests[i];
            result = result.Union(db.Where(d => d.Contains(val)));
        }

        result.ToList().ForEach(r => Console.WriteLine(r));

        Console.ReadLine(); 
```

# mule - 如何在表达式过滤器中引用流变量？

> ID：10249553
> 
> 赞同：0
> 
> 时间：2012-04-20T16:00:25.757
> 
> 标签：mule

如何在表达式过滤器中引用流变量？

假设这`myVariable`是一个布尔值，我试过：

```
<expression-filter evaluator="variable" expression="myVariable" /> 
```

但这没有用。最终我选择了：

```
<expression-filter evaluator="groovy" expression="message.getInvocationProperty('myVariable')" /> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:40:25.333

*变量*表达式不完整，不能按原样计算为布尔值（而 Groovy 可能可以，因为变量是布尔值）。

请参阅： http: [//www.mulesoft.org/documentation/display/MULE3USER/Using+Expressions#UsingExpressions-UsingExpressionFilters](http://www.mulesoft.org/documentation/display/MULE3USER/Using+Expressions#UsingExpressions-UsingExpressionFilters)

您需要指定预期值：

```
<expression-filter evaluator="variable" expression="myVariable=true" /> 
```

以下也应该起作用：

```
<expression-filter evaluator="header" expression="INVOCATION:myVariable=true" /> 
```

# sql - 从嵌套表的列中选择 SQL

> ID：10249554
> 
> 赞同：4
> 
> 时间：2012-04-20T16:00:31.257
> 
> 标签：sql, oracle, plsql, jdeveloper

我有一个关于如何打印定义类型对象的所有值的问题。我有一个 PROJECTT 类型对象的表 SP。当我在 SP 中查询其对象的一行时，它返回对象的类型 (PROJECTT) 但不返回对象的内容。PROJECTT 类型有 5 个 varchar 列，这是我想要返回的。

下面是我的表和类型的 SQL

```
set echo on
set serveroutput on

drop table ACTIVES;
drop table POBJECT;
drop type ACTIVEST;
drop type POBJECTT;

create type POBJECTT as
   object (p# varchar(5), pname varchar(20), color varchar(10),
           weight number, city varchar(10));

create table POBJECT of POBJECTT;
   insert into POBJECT(p#, pname, color, weight, city) values
    ('P1', 'Nut', 'Red', 12, 'London');
   insert into POBJECT(p#, pname, color, weight, city) values
   ('P2', 'Bolt', 'Green', 17, 'Paris');
   insert into POBJECT(p#, pname, color, weight, city) values
   ('P3', 'Screw', 'Blue', 17, 'Rome');
   insert into POBJECT(p#, pname, color, weight, city) values
   ('P4', 'Screw', 'Red', 14, 'London');
   insert into POBJECT(p#, pname, color, weight, city) values
   ('P5', 'Cam', 'Blue', 12, 'Paris');
   insert into POBJECT(p#, pname, color, weight, city) values
   ('P6', 'Cog', 'Red', 19, 'London');

  create type ACTIVEST as table of ref POBJECTT;
   /

  create table ACTIVES(s# varchar(5), sname varchar(20), status number, 
                     city varchar(10), sp ACTIVEST) 
```

然后使用Java SAX 解析器和XML 文件，我用对POBJECTS 表中行的引用填充ACTIVES 的sp 列。

我正在尝试使用 select 语句打印这些行。我不太确定如何在 SP 中获取对象的值，所以我从以下内容开始：

```
select * from (select sp from actives where S# = 'S1') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T03:46:05.717

```
select
    deref(column_value).p# p#
    ,deref(column_value).pname pname
    ,deref(column_value).color color
    ,deref(column_value).weight weight
    ,deref(column_value).city city
from actives cross join table(sp)
where s# = 'S1';

P#    PNAME                COLOR          WEIGHT CITY
----- -------------------- ---------- ---------- ----------
P1    Nut                  Red                12 London
P2    Bolt                 Green              17 Paris

SQL> 
```

假设您之前运行过这样的插入：

```
insert into actives
select 'S1', 'sname', 0, 'city'
    ,activest(
        (select ref(p) from pobject p where p# = 'P1')
        ,(select ref(p) from pobject p where p# = 'P2')
    )
from dual; 
```

此外，您的 ACTIVES DDL 对我不起作用。我不得不添加`nested table sp store as sp_tab;`到它的末尾。

# javascript - WebSocket：onMessage() 仅在服务器关闭连接时最后触发

> ID：10249557
> 
> 赞同：0
> 
> 时间：2012-04-20T16:00:40.637
> 
> 标签：javascript, windows, websocket

我有一个无法解决的奇怪错误。

我的实现 WebSocket 运行良好。浏览器连接到服务器，交换它们的密钥，连接就完全建立了！服务器开始向客户端发送消息（在网络流量中可见）。

但在我的电脑上，所有浏览器（Chrome、Firefox、便携或非便携），“onMessage（）”都被正确解释了......但只有在我关闭服务器时才结束！换句话说，如果我给每个 onMessage() 加上一个 alert()，那么在交换过程中，我什么也没做。但是一旦我切断服务器，我会立即收到所有警报！

然而，在我的 MacBook 上一切正常。

具有讽刺意味的是，这种行为会影响我 PC 上的所有浏览器。我在 Windows 7 下运行。

先感谢您 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T10:45:40.827

我终于找到了问题！

如果您在使用 Websockets 时遇到问题，只需在 Windows 上**禁用 SSDP 发现服务即可。**

```
net stop SSDPSRV 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-23T18:18:35.510

我最近遇到了类似的问题。Web 服务器运行一个单独的 SSDP 发现过程来查找网络上的 uPnP 设备。当我启用 SSDP 时，我的 websocket 连接总是关闭的。禁用 SSDP 解决了它。但我没有机会调查*原因*。

# php - Javascript 和 PHP (window.open)

> ID：10249560
> 
> 赞同：0
> 
> 时间：2012-04-20T16:00:50.313
> 
> 标签：php, javascript, mysql, window.open

因此，在我的网站中，我有一个新闻系统，可以选择编辑和删除管理员想要的新闻。

好吧，我通过使用以下方法获得了正确的编辑部分：

`href="noticiaEditarForm.php?id_noticia=<?php echo $id ?>">Editar</a>`

然后`$_GET`在另一页上。

但是，这不是我想要的编辑窗口。因此，我一直在探索一种使用 JavaScript 将包含新闻表 (MySQL) 主键的 PHP 变量发送到弹出窗口的方法。但这只是事情，它只会返回从查询中获得的第一个值......（即，如果我单击编辑第 3 篇文章，它会编辑我的第 1 篇文章。总是。）

这是我当前的代码：

```
<div class="noticias">
<?php
    include('conn/conn.php');
    mysql_select_db($bd, $conn);

    $resultado = mysql_query("SELECT * FROM noticia INNER JOIN user ON noticia.id_user=user.id_user ORDER BY id_noticia DESC");

    while ($linha = mysql_fetch_array($resultado)) {
        echo "<h1>" . $linha['titulo'] . "</h1>";
        echo "<i>Posted by " .$linha['username']. " on " . "<y>" . $linha['data'] . "</y>" . "</i>";
        echo "<p>";
        echo $linha['texto'];

        $id = $linha['id_noticia'];

        if (isset($_SESSION['admin'])) {
?>
            <div class="noticiasOpcao">
                <a href="" onClick="open_win_editar()">Editar</a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a onclick="return confirm('Are you sure?')" href="noticiaApagar.php?id_noticia=<?php echo $id ?>">Apagar</a>
            </div>
<?php
        } 
    }
?>

<script language="javascript">
    function open_win_editar() {
        window.open (
            "noticiaEditarForm.php?id_noticia=<?php echo $id; ?>",
            "Editar notícia",
            "location=1, status=1, scrollbars=1, width=800, height=455"
        );
    }
</script>

<?php mysql_close($conn); ?>

</div> 
```

我的意思是然后使用另一个查询来获取文章的标题和文本以显示在所见即所得的编辑器上。

谁能指出我的缺点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:11:29.177

这段代码：

```
<script language="javascript">
    function open_win_editar() {
        window.open ("noticiaEditarForm.php?id_noticia=<?php echo $id; ?>", "Editar notícia", "location=1, status=1, scrollbars=1, width=800, height=455");
     }
</script> 
```

发生在 PHP`while`循环之外，因此 的值`$id`将是`$id`循环中设置的最后一个值。因此 JavaScript 代码将始终打开相同的链接。

如果您需要 PHP 循环中的代码来指定`$id`JavaScript 的值，那么您可以将它作为参数传递给 JavaScript 函数。像这样的东西：

```
<script language="javascript">
    function open_win_editar(targetID) {
        window.open ("noticiaEditarForm.php?id_noticia=" + targetID, "Editar notícia", "location=1, status=1, scrollbars=1, width=800, height=455");
     }
</script> 
```

因此，在循环中呈现锚标记的代码将传递如下参数：

```
<a href="" onClick="open_win_editar(<?php echo $id; ?>)">Editar</a> 
```

然后，呈现的输出将包含`$id`每个`a`标签上的特定于记录的值，以供客户端上的 JavaScript 代码使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:08:53.287

```
<script language="javascript">
            function open_win_editar() {
                window.open ("noticiaEditarForm.php?id_noticia=<?php echo $id; ?>", "Editar notícia", "location=1, status=1, scrollbars=1, width=800, height=455");
            }
        </script> 
```

这仅呈现一次，可能使用最后一个 ID。您需要找出一个结构，以便您可以根据您单击编辑的文章向其传递不同的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:15:19.710

要编辑的片段的 id 仅在 while 循环内更新，永远不会在循环之外更新。

要按照您的意愿使用它，您应该使用 open_with_editar 函数的参数：

```
<script language="javascript">
            function open_win_editar(id) {
                window.open ("noticiaEditarForm.php?id_noticia="+id, "Editar notícia", "location=1, status=1, scrollbars=1, width=800, height=455");
            }
        </script> 
```

现在您只需要更新 onclick 事件并交出各自的 id：

```
<div class="noticiasOpcao">
      <a href="" onClick="open_win_editar(<?php echo $id; ?>)">Editar</a> 
```

那应该行得通。

问候斯特凡

# sql - 带有多个 where 子句的 SQL 插入

> ID：10249563
> 
> 赞同：0
> 
> 时间：2012-04-20T16:01:08.353
> 
> 标签：sql, insert

我怎么能做到这样的事情？

```
DECLARE @TEMP_TABLE TABLE (DATA VARCHAR(MAX), SHADOW_ID INT)
DECLARE @TEMP_TABLE1 TABLE (ENT VARCHAR(MAX), RMR VARCHAR(MAX), DTM VARCHAR(MAX))

INSERT INTO @TEMP_TABLE1 (ENT) SELECT DATA from @TEMP_TABLE WHERE DATA LIKE 'ENT%'
INSERT INTO @TEMP_TABLE1 (RMR) SELECT DATA from @TEMP_TABLE WHERE DATA LIKE 'RMR%'
INSERT INTO @TEMP_TABLE1 (DTM) SELECT DATA from @TEMP_TABLE WHERE DATA LIKE 'DTM%' 
```

没有任何空值，因为每个语句填充 1 列并将空值填充到其他两个中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:22:56.223

您似乎正在尝试创建数据透视表或交叉表查询。

```
insert into @TEMP_TABLE1 (ENT, RMR, DTM)
select a.ENT, a.RMR, a.DTM
from (
    select t.SHADOW_ID
        , (select DATA from @TEMP_TABLE where SHADOW_ID = t.SHADOW_ID and DATA like 'ENT%') as ENT
        , (select DATA from @TEMP_TABLE where SHADOW_ID = t.SHADOW_ID and DATA like 'RMR%') as RMR
        , (select DATA from @TEMP_TABLE where SHADOW_ID = t.SHADOW_ID and DATA like 'DTM%') as DTM
    from @TEMP_TABLE as t
    group by t.SHADOW_ID
) a 
```

这是假设每个 SHADOW_ID 只有一个 ENT、RMR 和 DTM 值。如果不是这种情况，那么我必须同意@JeremyHolovacs。

我建议也将 SHADOW_ID 放入 @TEMP_TABLE1 中，这样您就可以知道数据的来源。

# javascript - 通过传递 DOM 对象从 HTML 中的 iframe 创建 YT.Player 对象

> ID：10249567
> 
> 赞同：4
> 
> 时间：2012-04-20T16:01:26.670
> 
> 标签：javascript, jquery, html, youtube, youtube-api

我的 html 中有一个嵌入式 youtube 视频 iframe，我需要以编程方式停止，但我无法设置 iframe 的 ID。因此，我试图通过将 DOM 元素传递给 YT.Player 构造函数而不是 iframe id 来创建 youtube 对象，如[docs](https://developers.google.com/youtube/iframe_api_reference)中所指定。我还在 iframe src url 的末尾附加了 '?enablejsapi=1'。

我已经使用以下代码在我的 js 文件顶部加载了 youtube js api：

```
var tag = document.createElement('script');
tag.src = "http://www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
function onYouTubePlayerAPIReady(){ console.log('yt api ready'); } 
```

之后我有以下代码：

```
$(function(){
    $('a.close').click(function(){
        var player = new YT.Player($('iframe').get(0));
        player.stopVideo();
    });
}) 
```

我得到输出：

```
yt api ready
Uncaught TypeError: Object [object Object] has no method 'stopVideo' 
```

我假设我以某种方式搞砸了对象实例化，但我不知道如何正确地做到这一点。如何在不向构造函数传递 iframe id 的情况下创建 YT.Player 对象？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T19:43:39.370

我需要将停止视频通话移动到播放器对象的就绪事件中。以下更改为我修复了它

添加了以下功能：

```
function onMyPlayerReady(event) { event.target.stopVideo(); } 
```

并将 yt.player 构造函数更改为：

```
new YT.Player($('iframe').get(0), { events: { 'onReady': onMyPlayerReady } }); 
```

# java - 将远程对象反序列化为最窄的可访问类

> ID：10249569
> 
> 赞同：0
> 
> 时间：2012-04-20T16:01:29.810
> 
> 标签：java, spring, serialization, rmi

在**shared.jar**我有：

```
abstract class MyParent {

}
abstract class MyClass {
   MyParent getFoo();
} 
```

**server.jar**包含

```
abstract class MyChild extends MyParent {

}
abstract class MyClassConcrete {
   MyParent getFoo() {return new MyChild();}
} 
```

**客户端.jar**：

```
MyParent foo = myClass.getFoo(); 
```

如果所有 3 个 jar 都在一个类加载器中，那么一切正常。

但是客户端和服务器在不同的 JVM 中，同时：

*   JVM-1 包含：*server.jar*，*shared.jar*
*   JVM-2 包含：*client.jar*、*shared.jar*

客户端调用服务器。服务器返回*MyConcreteClass*并且 Java 无法对其进行反序列化（*ClassNotFoundException*）。

* * *

我想做的事：

*   服务器序列化类并发送数据和类的祖先集
*   客户端找到它可能反序列化的最窄的祖先。

一切都很好：我们在客户端上有*MyParent*的实例，这就是我们所需要的。

我不敢相信没有这样的引擎。你认识一个吗？我确信远程呼叫应该尽可能类似于本地呼叫。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:50:28.370

实现 java.io.Serializable 接口的对象可以使用 writeReplace() 和 readResolve() 方法将另一个对象替换为正在序列化/反序列化的对象。我可以看到这被用来解决您的问题。但是，我自己没有尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:25:51.543

实际上我找到了解决方案并制作了一个特殊的包来支持它：

*   *MyParent*必须用特殊的*SerializableParent*注释标记。这个注释意味着任何子类都应该在远程引擎可以序列化它并通过网络传输之前“转换”为*MyParent 。*通过设置此注释，您不仅可以告诉系统*MyParent*存在于远程 JVM 上，而且层次结构树不需要多态性：如果子级覆盖父级的方法，它将在远程系统上不可用，因为只能发送数据但可以发送代码。
*   在发送结果引擎之前，应该找到注释为 *SerializableParent的最窄祖先*
*   应该序列化为 XML（例如使用 XStream）并使用父类作为子类别名反序列化的对象。为了防止“未知字段”错误，Xstream 必须通过覆盖*wrapMapper*和*shouldSerializeMember*来破解。
*   你有“可序列化的父母”被转移

# javascript - 任何人都可以从 jCarousel 解释以下 JavaScript 代码吗？

> ID：10249571
> 
> 赞同：0
> 
> 时间：2012-04-20T16:01:41.387
> 
> 标签：javascript, jquery, syntax, logical-operators

我写 JS 已经有一段时间了，我一直在尝试调试 jQuery jCarousel 插件以兼容 IE7。很多变量都被混淆了，这没关系，但我从未见过这样的语法：

```
scroll: function (a, c) {
    !this.locked && !this.animating && (this.pauseAuto(), this.animate(this.pos(a), c))
} 
```

这似乎是某种速记符号，但我从未遇到过这样的事情。
相似地，

```
for (var a = function (a) {
    i.get(a).each(function () {
        h(i, this, a, b, c)
    })
}, k = d; k <= f; k++)  {
    k !== null && !(k >= j && k <= e) && a(k)
} 
```

我从未见过将函数分配为迭代器，并且里面的块语句再次看起来像第一个示例。我知道我们在编写代码时都在努力节省几个字节，但对我来说，这种狂热的尝试是以让其他程序员完全困惑和困惑为代价的。任何人都可以给我一个简单的“速记”替代/彻底解释正在发生的事情吗？我一直想更多地了解这种语言及其工作原理，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:04:58.267

[`&&`运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators)对每个表达式求值，直到找到一个为真的表达式，然后返回。如果没有一个是真的，它会返回最后一个。

[`,`运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comma_Operator)评估它的两个操作数并返回第二个（无论它们返回什么）。

所以在第一个例子中，它基本上是在说：

```
scroll: function (a, c) {
    if (!this.locked && !this.animating) {
        this.pauseAuto();
        this.animate(this.pos(a), c)
    }
} 
```

至于第二个例子，重要的是要注意迭代是在`k`变量上，而不是`a`：

```
var a = function (a) {
    i.get(a).each(function () {
        h(i, this, a, b, c)
    })
};

for (k = d; k <= f; k++)  {
    if (k !== null && !(k >= j && k <= e)) {
        a(k)
    }
} 
```

对于第二个示例，不要忘记可以使用以下语句在一个语句[中定义多个变量](https://developer.mozilla.org/en/JavaScript/Reference/Statements/var)：`var``,`

```
var a = 1,
    b = 2,
    c = 3; 
```

* * *

重要的是要知道*开发人员自己*并没有像这样最小化代码；他在易于阅读的块中编写具有有意义的变量名的[普通源代码。](https://github.com/jsor/jcarousel/blob/master/src/jquery.jcarousel.js)当谈到发布时间时，他将通过一个缩小器（[UglifyJS](https://github.com/mishoo/UglifyJS)、[Closure Compiler](https://developers.google.com/closure/compiler/)等）运行缩小后的版本以获取精简后的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:04:54.597

由于短路评估：

```
a && b && (c, d, e); 
```

基本上相当于：

```
if (a) {
    if (b) {
        c;
        d;
        e;
    }
} 
```

并且表达式的值将是**e**。

在第二个示例中，该函数不是迭代器，他只是使用 for 循环的第一个位置来初始化一个匿名函数，然后将其分配给**a**。

该代码的作者只是过于简洁。仅仅因为你可以，并不意味着你应该。

**更新**：

这是对第二个示例的重写，它在功能上应该是等效的：

```
function a (a) {
    i.get(a).each(function () {
        h(i, this, a, b, c)
    });
}

for (k = d; k <= f; k++)  {
    if ((k !== null) && (!(k >= j && k <= e))) {
        a(k);
    }
} 
```

# extjs4 - 将子节点添加到树 extjs4 中的子节点的问题

> ID：10249573
> 
> 赞同：0
> 
> 时间：2012-04-20T16:01:45.100
> 
> 标签：extjs4

我正在尝试将一个子节点动态添加到子节点。但它没有显示在树中。当我调试时，我可以看到它已添加到 currNode。

```
 currNode = Ext.getCmp('TreePanel').getRootNode().childNodes[indexval];
    currNode.appendChild({
        text: text,
        title: 12,
        leaf: true
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T10:37:57.877

我通过使用扩展方法解决了这个问题

```
currentNode.expand(); 
```

我尝试设置子节点 false、可扩展 true 等属性，但调用显式方法成功了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T16:34:45.807

您必须将子节点添加到作为父节点的节点（即具有子节点）。添加到叶节点将无效。

# grails - 谷歌地图小部件自定义数据

> ID：10249576
> 
> 赞同：0
> 
> 时间：2012-04-20T16:01:56.223
> 
> 标签：grails, maps

在某些电子表格的 Google 文档中，您有世界地图小部件/插件，您可以提供国家代码和频率，它会使用该数据生成世界热图？

任何人都可以建议在 Grails 中使用类似的东西吗？显然，谷歌搜索“谷歌地图”给出了关于实际谷歌地图 API 等的一百万零一件事。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T07:20:44.997

从朋友那里找到的——它被称为“地质图”，

[https://developers.google.com/chart/interactive/docs/gallery/geochart](https://developers.google.com/chart/interactive/docs/gallery/geochart)

# apache-zookeeper - Zookeeper CLI 失败 - IOException 数据包 超出范围

> ID：10249579
> 
> 赞同：6
> 
> 时间：2012-04-20T16:01:59.390
> 
> 标签：apache-zookeeper

运行动物园管理员 3.3.3。我有一个 znode，我只是想通过 CLI 列出，如下所示：

ls /myznode/subznode

这会在第 710 行的 org.apache.ClientCnxn$SendThread.readLength 中因 IOException 而崩溃。

有人见过这个吗？？有人建议可能坏数据在 znode 中。不确定是否或如何...但我也无法删除它，因为它里面有东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-14T23:31:12.937

我可以通过增加列表调用的最大大小来解决这个问题。

我将“-Djute.maxbuffer=50111000”添加到我的 zkCli.sh 脚本中，以便它使用以下行启动客户端：

```
$JAVA "-Dzookeeper.log.dir=${ZOO_LOG_DIR}" "-Dzookeeper.root.logger=${ZOO_LOG4J_PROP}" \
 "-Djute.maxbuffer=49107800" -cp "$CLASSPATH" $CLIENT_JVMFLAGS $JVMFLAGS \
 org.apache.zookeeper.ZooKeeperMain "$@" 
```

然后我能够列出并使用 rmr /big/node

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T14:04:13.527

所以，问题是有问题的 znode 已经被子 znode 淹没了。它有大约500万个。Zookeeper 显然不喜欢这样。更糟糕的是，没有很好的方法来清理它。ZK 应该有一个修剪命令（或其他东西）。感谢您的回答。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-27T14:45:46.043

鉴于您提到的错误行，

```
707         void readLength() throws IOException {
708             int len = incomingBuffer.getInt();
709             if (len < 0 || len >= packetLen) {
710                 throw new IOException("Packet len" + len + " is out of range!");
711             }
712             incomingBuffer = ByteBuffer.allocate(len);
713         } 
```

可能是您的数据包长度大于`jute.maxBuffer`允许的长度。默认值为 4M，这应该足够了，但您可能已经用一个明显较低的值定义了该属性。无论如何，你有**很多**孩子吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-02-01T17:33:14.077

我有相同的数据包超出范围异常，但出于一个非常愚蠢的原因。我指定的端口号用于我的 solr 实例，而不是嵌入式 zookeeper。我将其更新为

bin/solr zk upconfig -z [http://localhost](http://localhost) : **9983** / -n mynewconfig -d /path/to/configset 我的实例在**8983**上运行。

嵌入式 zookeeper 端口默认为 localhost:(hostPort+1000)

希望它可以帮助像我一样开始的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-25T08:10:24.100

在我的情况下，这个错误是由于 SolrCloud (4.8.0) 的“错误”版本，升级到最新的 (4.8.1) 问题就消失了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-20T16:35:45.940

我有一个类似的问题，我可以通过将 zookeeper 端口修复为 2181 来解决它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-24T20:47:36.113

您是否尝试过以编程方式访问它？就像是

```
ZooKeeper zooKeeper = new ZooKeeper(hostPort, 3000, myWatcher);
String path = "/myznode/subznode"
List<String> children = zooKeeper.getChildren(path, false);
for (String child : children) {
    System.out.println(child);
} 
```

# svn - 将属性更改提交到我的 SVN 存储库的主干时出错

> ID：10249583
> 
> 赞同：1
> 
> 时间：2012-04-20T16:02:22.070
> 
> 标签：svn, tortoisesvn, visualsvn-server

我对存储库主干的属性进行了更改。具体来说，我修改了 extern 以指向较新的版本。

当我提交时，我收到以下错误。

```
Commit failed (details follow):
Commit blocked by pre-commit hook (exit code 1) with output:
error: you don't have enough permissions for this transaction:
you can't update properties of trunk/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T08:34:16.923

我已经弄清楚了问题所在。

更改是位于存储库根目录中的 \conf\svnperms.conf 文件。该文件如下所示：

```
[_default_]
trunk/.*          = *(add,remove,update)
branches/[^/]+/.* = *(add,remove,update)
tags/[^/]+/       = *(add,remove)
trunk/            = *(add)
branches/         = *(add)
tags/             = *(add) 
```

我做了如下所示的修改。

```
trunk/            = *(add) 
```

到

```
trunk/            = *(add,update) 
```

# forms - HTML 表单标签如何影响搜索结果

> ID：10249584
> 
> 赞同：0
> 
> 时间：2012-04-20T16:02:29.540
> 
> 标签：forms, html, search-engine, web-crawler

我想知道包装 div 内容的表单标签是否会影响搜索引擎结果（如 Google、bing、yahoo）

```
<form onsubmit="return oQuickModify.bInEditMode ">
     <div class="post">
          <div id="msg_4" class="inner">
               Post contents here ....
               ............
               ............
          </div>
     </div>
</form> 
```

^^ 这是 SMF 板帖子查看格式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:57:46.737

它不会有任何影响。

# java - 用于输出和工作的 SwingWorker，还是各 1 个？

> ID：10249585
> 
> 赞同：3
> 
> 时间：2012-04-20T16:02:34.740
> 
> 标签：java, swing, swingworker, secondaryloop

目前我总是创建一个`SwingWorker`来做我的实际工作，另一个通过`PipedReader`.

我很想将两者结合起来，但在我的情况下，我只是看不到一个简单的方法。

鉴于我：

1.  有一个可以工作的预制对象（`converter`在这种情况下）
2.  想要定期`converter`向 GUI 显示有关 的进度的更新
3.  `converter`完成任务并返回时接收对象。

没有两个 SwingWorker 有没有办法做到这一点？

编辑：请注意，`converter`扩展`SwingWorker`不是一种选择。

编辑2：回应下面的评论。这是一个更大的 GUI 应用程序的一部分，处理大量数据（以 txt 的形式）并通知用户什么是错误的，或者什么已经决定。

示例代码（纯说明性，未使用）：

```
//SwingWorker 1
@Override
protected Void doInBackground() {

   outputWorker.useInStream(new PipedReader(outStream));
   outputWorker.execute();
   converter.usePipedWriter(outStream);
   Output object2=converter.Convert(object1);

}

//SwingWorker 2
@Override
protected Void doInBackground() {

   while(inStream.hasNext()) {
      publish(inStream.next());
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:48:08.447

如果使用一两个`SwingWorker`，则不是您问题的答案，我想让这些事情复杂化...

*   我建议查看[调用 SwingWorker 的 Executor](https://stackoverflow.com/a/6174462/714968)以及具有真实[可视化/输出到 GUI的相同代码](https://stackoverflow.com/a/6186188/714968)

*   `Executor`不关心`SwingWorkers`生命周期，反之亦然

> @user1291492 处理 30 mb 文本文件

*   您必须[从方法中监听异常，特别是`get()`](https://stackoverflow.com/questions/7053865/cant-get-arrayindexoutofboundsexception-from-future-and-swingworker-if-threa)阅读[@trashgod 的答案](https://stackoverflow.com/a/7054627/714968)

*   你必须（`Processing 30 mb text files`）来实现一些`Batch`，例如每 10 个循环你将数据发布到 GUI，然后输出到 GUI 将立即

*   during`Batch`可以通过 S 停止当前线程`wingWorker#cancel();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T17:00:17.683

如果您使用的是 JDK7，则可以考虑使用[SecondaryLoop](http://docs.oracle.com/javase/7/docs/api/java/awt/SecondaryLoop.html)而不是将多个 SwingWorker 实例链接在一起。

SecondaryLoop 本质上允许您等待后台线程（或一系列线程）完成而不阻塞 EDT，类似于 SwingWorker。它可能不适合在任何情况下替代 SwingWorker，但是根据您对问题的描述，这听起来像是您可以使用的东西。

有关此主题的更多讨论，请查看相关问题“ [SecondaryLoop 代替 SwingWorker？](https://stackoverflow.com/questions/10196809/secondaryloop-instead-of-swingworker/10197838#10197838) ”

# php - PHP Timeout 上的 PHP Run 函数

> ID：10249587
> 
> 赞同：0
> 
> 时间：2012-04-20T16:02:50.310
> 
> 标签：php, dll

我正在编写一个服务器发布给我们的脚本，我们发布到服务器，理论上应该从服务器接收响应并回复给发布给我们的服务器。但是有时我发布的服务器没有响应。最大的问题是发布给我们的服务器会假设交易成功完成，除非它听到其他情况。所以基本上我需要一种方法来将响应发送回第一台服务器，如果我从未收到我发布到的服务器的回复。我认为 register_shutdown_function 可以为我工作，但我不知道如何设置它，所以它只会在错误或其他情况下运行。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:12:06.633

`register_shutdown_function()`应该为你工作。只需使用全局变量来确定远程服务器是否响应：

```
<?php

  function on_shutdown () {
    if (!$GLOBALS['complete']) {
      // Handle server not responding here
    }
  }

  // Suppress "FATAL ERROR" message when time limit reached
  error_reporting(0);

  $complete = FALSE;

  register_shutdown_function('on_shutdown');

  // Code which posts to remote server here

  $complete = TRUE; 
```

这意味着`$complete`如果发布到远程服务器的代码没有完成，这仍然是错误的，因此您只需检查`$complete`关闭时触发的函数的真实性。

# jquery - 在制作成 json 对象之前编辑 AJAX 响应

> ID：10249589
> 
> 赞同：0
> 
> 时间：2012-04-20T16:02:52.637
> 
> 标签：jquery, json

是否可以在将 AJAX 跨域请求的响应制成对象之前对其进行编辑？我的响应格式不正确（这不容易改变 - 大型企业结构*翻白眼*），我需要尽快获取数据。

我试过设置前置过滤器和转换器，但无济于事。

```
$.ajax({ 
  url:url,
  dataType: 'jsonp',
  success: function(data, status, jqXHR) {
    console.log(data);
  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.log(jqXHR); console.log(textStatus); console.log(errorThrown);
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:06:36.597

使用 JSONP，您无法拦截和更改收到的数据。将其视为将 JS 对象直接注入您指定的函数的 JS 外部资源，您无法更改传入的结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:24:53.930

制作

```
 dataType: 'text' 
```

然后你会收到简单的数据

```
 success( data ){
    // remark that data str as You wish
  } 
```

# javascript - 取消ajax请求：handler还能被执行吗

> ID：10249591
> 
> 赞同：2
> 
> 时间：2012-04-20T16:02:59.513
> 
> 标签：javascript, jquery, ajax, jquery-deferred, request-cancelling

在[JavaScript 是否保证是单线程的？](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded) 很明显，尽管 javascript 是单线程的，但仍有一些警告。

我想知道以下伪代码是否总是可预测的（我正在“使用”jQuery）

```
var lastReq;
$('#button').click(function()
{
  if (lastReq) lastReq.abort();
  lastReq = $.ajax(...);
}); 
```

这种情况可能是在单击事件和中止之间，来自服务器的数据通过并在 de eventqueue 上放置了一个事件。如果这发生在中止之前，将触发 ajax post 的 succes 事件。我不知道如何真正测试这种可能的竞争条件。

有谁知道这是如何工作的？或者如何用一个准备好的例子来测试这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:25:12.493

编辑：一旦您中止请求，浏览器就不应再监听它了。所以当它到达事件队列中的响应时，我猜它应该把它扔掉。

* * *

但是，如果您遇到问题，可以尝试以下方法：

如果检测到不再需要运行，您能否检查您的成功函数 + url 以取消自身？

例如（我并不是说你应该这样做，我没有尝试将任何东西附加到 jqXHR 请求）：

```
var numReq = 0, lastReq;

$('#button').on('click', function(e) {
    if (lastReq) { lastReq.abort(); }
    numReq ++;
    lastReq = $.ajax({
        success : function(d, s, x) {
            if (x.reqNum < numReq) { return; }
        }
    });
    lastReq.reqNum = numReq;
}); 
```

我的理解是，在完成按钮单击之后，ajax 事件才会被添加到事件队列中，所以你不应该（理论上）担心在 ajax 之后设置 reqNum ...

* * *

我还尝试了以下代码：

```
var numReq = 0, lastReq, timer = 100,
    c = setInterval(function() {
        if (lastReq) { lastReq.abort(); }
        numReq ++;
        lastReq = $.ajax({
            url     : 'index.html',
            cache   : false,
            success : function(d, s, x) {
                if (x.reqNum < numReq) { console.log('it happens'); }
            }
        });
        lastReq.reqNum = numReq;
    }, timer); 
```

改变计时器以尝试匹配（尽可能接近）页面的加载时间。我还没有“它发生”出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:30:18.750

我不知道这种解决方法是否真的有用并且是防弹的（我正在尝试有创意）但是，由于 jQuery 1.5 ajax 方法返回一个延迟对象`lastReq`，因此有`state()`可用的方法

来自[http://api.jquery.com/deferred.state/](http://api.jquery.com/deferred.state/)

> deferred.state() 方法返回一个字符串，表示 Deferred 对象的当前状态。Deferred 对象可以处于以下三种状态之一：
> 
> ...
> 
> **"resolved"**：Deferred 对象处于已解决状态，这意味着该对象已调用 deferred.resolve() 或 deferred.resolveWith() 并且已调用 doneCallbacks **（或正在调用）**。

所以你可以像这样重构你的代码

```
var lastReq;
$('#button').click(function() {
     if (lastReq) {
         if (lastReq.state() === "resolved") {
             return false; /* done() of the previous ajax call is in the process of
                              being called. Do nothing and wait until the state 
                              is resolved */
         }
         else {
             lastReq.abort(); 
         }
     }

     lastReq = $.ajax(url).done(function() {
          /* do something */
          lastReq = null; 
     });
}); 
```

希望这可以帮助给你一个想法，但我怀疑实际上不需要这种解决方法

# c# - C# 中的 SQL Server 2008：连接和命令对象

> ID：10249593
> 
> 赞同：0
> 
> 时间：2012-04-20T16:03:14.983
> 
> 标签：c#, performance, sql-server-2008, reusability

关于这个有很多不详细的问题，所以这里。

使用 SQL Server 2008 在 C# 中进行连接处理的最佳实践是什么？我们有一个调用 SQL Server 的程序集（在我们的例子中由 WCF 服务使用）。一般来说，您似乎需要三个对象来执行此操作：连接对象、命令对象和读取器对象。

我们能够让电话正常工作的唯一可靠方法是执行以下操作：

1.  打开连接。
2.  在 using() { } 块中创建命令
3.  创建 Reader 来处理响应。
4.  处置阅读器。
5.  在 using() 块的末尾隐式处理命令
6.  关闭连接。

我们在多次迭代运行同一个命令时遇到了一个不寻常的问题，它会抱怨已经有一个命令或读取器对象附加到仍然打开的连接上。唯一坚如磐石的解决方案是关闭并重新打开我们所做的每个命令的连接，迭代或只是顺序（不同的命令）。

所以这是个问题，因为我来自数据库连接处理方面的 mysql_pconnect 背景。

1.  为每个命令打开和关闭连接是否会显着影响性能？
2.  如果 1\. 是这样，那么处理串行重复命令的正确解决方法或代码结构是什么？
3.  有没有办法重用连接、命令或阅读器？
4.  如果不是 3.，这是否真的会显着影响性能或内存使用（如，我们的用户会注意到。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:14:27.947

要回答第 1 点，如果您查看[SqlConnection](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection%28v=vs.100%29.aspx)的文档，您会看到它解释了连接池。这意味着 SQL Server 提供程序有一组随时可用的连接，并且每个`SqlConnection`创建的连接都只是获取下一个可用连接。因此，为了获得最佳性能，建议继续创建`SqlConnection`对象并使用它们进行短期操作，然后将其释放，从而返回连接池。

对于第 3 点，我相信你可以重新使用 an`SqlConnection`如果你这样做`SqlCommand.ExecuteNonQuery()`，但如果你使用 an`SqlDataReader`你不能重新使用连接 - 它与 绑定`SqlDataReader`并且必须在完成后关闭/处置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:24:35.900

除了@PeterMonks 回答：

1.  只要您使用相同的连接字符串，提供程序（连接池）就会重新使用 SqlConnection 的“昂贵”、非托管部分。因此，虽然每次创建一个新的托管包装器的开销很小，但它实际上并不是与创建与 SQL 服务器实例的连接的 1:1 关系，因此它并不像您想象的那么昂贵。

2.  要连续重复返回数据读取器的命令，您必须 a) 始终在同一线程上执行命令（命令不是线程安全的）和 b)在创建下一个之前`Close()`或实例。您也可以通过将 DataReaders 放在 using 块中来做到这一点。`Dispose()``DataReader`

以下是将阅读器放入 using 块的方法：

```
using (var dr = myCommand.ExecuteReader(...)) {
    // Previous discussions have indicated that a close in here, 
    // while seemingly redundant, can possibly help with the error 
    // you are seeing.
    dr.Close();
} 
```

正如@DavidStratton 所提到的，另一个有用的技术是启用 MARS，但请注意，保持结果集打开会产生开销——您仍然希望在完成阅读器后立即关闭它们，因为未关闭、未处理的阅读器确实代表服务器和客户端上的大量资源分配。

# php - mySQL 没有获取所有记录

> ID：10249596
> 
> 赞同：1
> 
> 时间：2012-04-20T16:03:29.960
> 
> 标签：php, mysql

我有 5 个表，我希望从所有链接到名为 pubs 的表中获取数据。

special_offers 有 3 条与 pub 相关的记录 events 有 4 条与 pub 相关的记录

但是，我只取回了第一个事件和 special_offers。它似乎没有构造成多级数组。我试过加入和内部加入，我看不出有什么问题。

```
SELECT pubs.*, special_offers.*, `events`.*, vote.* 
  FROM pubs
    Inner Join `events` 
      ON pubs.id = `events`.pubID
    Inner Join special_offers 
      ON pubs.id = special_offers.pubID
    Inner Join vote 
      ON pubs.id = vote.pubID
  WHERE pubs.id = 48 
```

这是 print_r 的输出

```
Array (
 [0] => 48
 [id] => 1 Harveys
 [name] => Harveys
 [sun] => 10am-2.30am
 [31] => 1
 [32] => 4
 [special_dayID] => 4
 [33] => 48
 [pubID] => 48
 [34] => 2.50 Drinks
 [title] => Kodakid
 [35] => All drink 2.50 get them while there hot! or cold!
 [desc] => Kodakid are playing!
 [36] => 1
 [37] => 48
 [38] => 2012-04-30
 [date] => 2012-04-30
 [39] => Kodakid
 [40] => & others
 [subtitle] => & others
 [41] => Kodakid are playing!
 [42] => kodakid.jpg
 [img] => kodakid.jpg
 [43] => 1
 [44] => 48
 [45] => 3
 [price_range] => 3
 [46] => 5
 [atmosphere] => 5
 [47] => 2
 [food] => 2
 [48] => 4
 [service] => 4
 [49] => 3
 [value] => 3
 [50] => Waterford City
 [county] => Waterford City ) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:13:32.740

您如何进行实际查询？MySQL 不支持嵌套数组或行。结果集由零或多行组成，每一行是一个或多个数字、字符串、日期等。

您正在做的是要求一个由所有四个表中的所有列组成的结果集。因为您使用的是 INNER 连接，所以您要求 MySQL 仅返回所有四个表中都存在的行。因此`pubs`，没有关联行的 ID`events`不会包含在结果集中，即使它在其他两个中确实有行。

要执行您的要求，您可以使用单独的查询（一个用于事件，一个用于投票等）。您也可以尝试使用 LEFT JOINs 而不是 INNER JOINs 或子查询和聚合器，如 GROUP_CONCAT，但这实际上取决于您打算如何处理这些信息。

# coding-style - 使用 Accelerate 框架对向量进行编码

> ID：10249597
> 
> 赞同：0
> 
> 时间：2012-04-20T16:03:30.157
> 
> 标签：coding-style, vectorization, accelerate-framework

我第一次使用 Accelerate 框架，目标是在 iOS 应用程序中实现一些矢量化代码。我从来没有尝试过在 Objective C 或 C 中处理向量方面做任何事情。有一些使用 MATLAB 的经验，我想知道使用 Accelerate 是否确实更痛苦。假设我想计算以下内容：

`b = 4*(sin(a/2))^2`其中 a 和 b 是向量。

MATLAB代码：

```
a = 1:4;
b = 4*(sin(a/2)).^2; 
```

但是，正如我在浏览文档后看到的那样，使用 Accelerate 的情况完全不同。

我的 C 实现：

```
float a[4]  = {1,2,3,4};                        //define a
int len     = 4;
float div   = 2;                                //define 2
float a2[len];                                  //define intermediate result 1
vDSP_vsdiv(a, 1, &div, a2, 1, len);             //divide
float sinResult[len];                           //define intermediate result 2
vvsinf(sinResult, a2, &len);                    //take sine
float sqResult[len];                            //square the result
vDSP_vsq(sinResult, 1, sqResult, 1, len);       //take square
float factor = 4;                               //multiply all this by four
float b[len];                                   //define answer vector
vDSP_vsmul(sqResult, 1, &factor, b, 1, len);    //multiply

//unset all variables I didn't actually need 
```

老实说，我不知道这里最糟糕的是什么：跟踪所有中间步骤，试图记住参数是如何在 vDSP 中相对于 VecLib 传递的（完全不同），或者做一些非常琐碎的事情需要花费大量时间。

我真的希望我在这里遗漏了一些东西，并且大多数步骤可以合并或缩短。任何关于编码资源、良好编码习惯（通过艰苦的方式学习或从书本中学习）等方面的建议都将非常受欢迎！你们都是如何处理多行向量计算的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T04:38:16.263

我想你可以这样写，但对我来说似乎非常复杂。我更喜欢这个（特定于英特尔，但可以很容易地抽象为其他架构）：

```
#include <Accelerate/Accelerate.h>
#include <immintrin.h>

const __m128 a = {1,2,3,4};
const __m128 sina2 = vsinf(a*_mm_set1_ps(0.5));
const __m128 b = _mm_set1_ps(4)*sina2*sina2; 
```

另外，为了迂腐，你在这里做的不是*线性*代数。 *线性*代数只涉及线性运算（没有平方，没有超越运算，如`sin`）。

* * *

编辑：正如您所指出的，上述内容在 iOS 上开箱即用并不适用；最大的问题是没有`vsinf`（vMathLib 在 Accelerate on iOS 中不可用）。我没有在我的机器上安装 SDK 进行测试，但我相信类似以下的东西应该可以工作：

```
#include <Accelerate/Accelerate.h>

const vFloat a = {1, 2, 3, 4};
const vFloat a2 = a*(vFloat){0.5,0.5,0.5,0.5};
const int n = 4;
vFloat sina2;
vvsinf((float *)&sina2, (const float *)&a, &n);
const vFloat b = sina2*sina2*(vFloat){4,4,4,4}; 
```

不像 vMathLib 那样漂亮，但仍然相当紧凑。

通常，向量上的许多基本算术运算都可以正常工作。无需使用对任何库的调用，这就是为什么 Accelerate 不会竭尽全力干净地提供这些操作。相反，Accelerate 通常会尝试提供其他方式无法立即使用的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T10:32:58.730

回答我自己的问题：在 iOS 6 中，将引入 vMathLib。正如斯蒂芬澄清的那样，vMathLib 已经可以在 OSX 上使用，但在 iOS 中不可用。到目前为止。

vMathLib 提供的函数将使向量计算更容易。

# html - 如何在 html 中创建带有 4 个选项卡的菜单，该菜单将在一页上显示内容？

> ID：10249602
> 
> 赞同：0
> 
> 时间：2012-04-20T16:03:53.897
> 
> 标签：html, tabs, division, menubar

我需要创建一个带有 4 个选项卡的网页。通过按下选项卡，相关内容应显示在**整个**页面上，并且应该适用于所有选项卡。我的意思是，当用户按下一个选项卡时，它将显示将链接到该选项卡的内容并隐藏另一个选项卡的内容。我怎样才能在 HTML 和 CSS 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:08:16.030

Jquery UI 有一个开箱即用的解决方案：

[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

当然，它不是一个纯 HTML 和 CSS 解决方案，但是我不确定你是否能够在没有某种形式的脚本的情况下做到这一点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T11:33:30.360

这是我对我的问题的最终解决方案：

```
 function show(showEl) {
        var elements = new Array("tahsilatlarIcerik", "faturaTabGraf", "odemeIcerik", "kasaIcerik");
        for (var i = 0; i < elements.length; i++) {
            if (showEl == elements[i]) {
                document.getElementById(showEl).style.display = "block";
            }
            else {
                hide(elements[i]);
            }
        }
    }

    function hide(hideEl) {
        if (document.getElementById(hideEl).style.display != "") {
            document.getElementById(hideEl).style.display = "none";
        }
    } 
```

基本上，我创建了一个包含元素 id 的数组，并使用 2 个函数操作它们。函数在选项卡内部调用，例如`<a id="faturaMenu" onclick="show('faturaTabGraf')">Fatura Analizi</a>`. 我希望这对某人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T14:27:26.117

我用javascript代码解决了问题。我正在发布它，我想知道是否有另一种编码更少的方式来做到这一点？据我研究，我发现在javascript中不支持同时声明和分配全局变量，你知道其他简单的方法吗？

和代码：

```
 function getFatura() {
        var tahsilatId = document.getElementById("tahsilatlarIcerik");
        var faturaTabloId = document.getElementById("faturaTabloIcerik");
        var faturaGrafikId = document.getElementById("faturaGrafikIcerik");
        var odemelerId = document.getElementById("odemeIcerik");
        var kasaId = document.getElementById("kasaIcerik");

        faturaTabloId.style.display = "block";
        faturaGrafikId.style.display = "block";
        tahsilatId.style.display = "none";
        odemelerId.style.display = "none";
        kasaId.style.display = "none";
    }

    function getTahsilatlar() {
        var tahsilatId = document.getElementById("tahsilatlarIcerik");
        var faturaTabloId = document.getElementById("faturaTabloIcerik");
        var faturaGrafikId = document.getElementById("faturaGrafikIcerik");
        var odemelerId = document.getElementById("odemeIcerik");
        var kasaId = document.getElementById("kasaIcerik");

        faturaTabloId.style.display = "none";
        faturaGrafikId.style.display = "none";
        tahsilatId.style.display = "block";
        odemelerId.style.display = "none";
        kasaId.style.display = "none";
    }

    function getOdemeler() {
        var tahsilatId = document.getElementById("tahsilatlarIcerik");
        var faturaTabloId = document.getElementById("faturaTabloIcerik");
        var faturaGrafikId = document.getElementById("faturaGrafikIcerik");
        var odemelerId = document.getElementById("odemeIcerik");
        var kasaId = document.getElementById("kasaIcerik");

        faturaTabloId.style.display = "none";
        faturaGrafikId.style.display = "none";
        tahsilatId.style.display = "none";
        odemelerId.style.display = "block";
        kasaId.style.display = "none";
    }
    function getKasa() {
        var tahsilatId = document.getElementById("tahsilatlarIcerik");
        var faturaTabloId = document.getElementById("faturaTabloIcerik");
        var faturaGrafikId = document.getElementById("faturaGrafikIcerik");
        var odemelerId = document.getElementById("odemeIcerik");
        var kasaId = document.getElementById("kasaIcerik");

        faturaTabloId.style.display = "none";
        faturaGrafikId.style.display = "none";
        tahsilatId.style.display = "none";
        odemelerId.style.display = "none";
        kasaId.style.display = "block";
    } 
```

我在带有 onclick 事件的元素中调用这些函数。基本上，我将选定选项卡的显示属性更改为 BLOCK，并将其他选项卡的显示属性更改为 NONE。现在，我有 4 个选项卡，但我无法想象如果超过 10 个选项卡，我需要多少代码。

谢谢，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T18:45:56.843

您可以通过更改`z-indexes`页面的 (as divs)来使用 CSS/javascript 来实现`onclick`。这将使一个在另一个前面。

只需有一个包含所有选项卡的 div，然后为每个选项卡设置不同 id 的 div。

从所有具有 的页面 div 开始`z-index:0;`，除了主页 div，它具有`z-index:1;`.

每个选项卡都有一个`onclick="nextpage('page1')`（将 page1 更改为相应页面的 id）。

然后在javascript中，放置以下代码：

```
function nextpage(pageid) {
    //Find the highest z-index. May need to be customized
    var elements = document.getElementsByTagName("*");
    var highest_index = 0;
    for (var i = 0; i < elements.length - 1; i++) {
        if (parseInt(elements[i].style.zIndex) > highest_index) {
        highest_index = parseInt(elements[i].style.zIndex;
        }
    }
    var highest_index_1 = highest_index + 1;
    //set the z index of the tab-page to the highest+1
    getElementByid(pageid).object.style.zIndex="1";
} 
```

# asp.net-mvc - 为什么我删除时模型没有值？

> ID：10249603
> 
> 赞同：0
> 
> 时间：2012-04-20T16:03:57.933
> 
> 标签：asp.net-mvc, asp.net-mvc-3, label

我在 LabelFors 中有我的值，但是当我进行回发时，模型具有默认值。

```
@using (Html.BeginForm("Delete", "Event", FormMethod.Post))
{
    <p>
        @Html.LabelFor(m => m.EventID, "Event ID")<br />
        @Html.LabelFor(m => m.EventID, Model.EventID.ToString())
    </p>
    <p>
        @Html.LabelFor(m => m.DayCode, "Type of Event")<br />
        @Html.LabelFor(m => m.DayCode, Model.DayCode.ToString())
    </p>
    <p>
        @Html.LabelFor(m => m.EventDate, "Date of Event")<br />
        @Html.LabelFor(m => m.EventDate, Model.EventDate.ToShortDateString())
    </p>
    <p>
        @Html.LabelFor(m => m.Subject, "Person or Interest")<br />
        @Html.LabelFor(m => m.Subject, Model.Subject)
    </p>
    <p>
        @Html.LabelFor(m => m.EventDesc, "Description")<br />
        @Html.LabelFor(m => m.EventDesc, Model.EventDesc)
    </p>

    <table>
        <tr>
            <td>
                @Html.ActionLink("Back", "Index", new { month = Model.EventDate.Month,
                                                        year = Model.EventDate.Year,
                                                        day = Model.EventDate.Day})
            </td>
            <td>            
                <input id="delete" type="submit" value="Submit Changes" />
            </td>
        </tr>
    </table>
}

        public ActionResult Delete(int eventID, int year, int month, int day)
        {
            //Find Event then return to Index
            EventModel thisEvent = EventRepository.getDayEvent(eventID, year, month, day);
            return View(thisEvent);
        }

        [HttpPost]
        public ActionResult Delete(EventModel deletedEvent) //here Model only has 0, "", and 1/1/0001
        {
            EventRepository.DeleteEvent(deletedEvent);
            return RedirectToAction("Index", new { year = deletedEvent.EventDate.Year, month = deletedEvent.EventDate.Month, day = deletedEvent.EventDate.Day });
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:17:35.927

尝试为每个值添加一个 HiddenFor

```
@Html.HiddenFor(m => m.EventID) 
```

这将确保在提交表单时将值发送回服务器。

如果您需要提供一个值，我喜欢[此处提供的已接受答案](https://stackoverflow.com/questions/3502498/how-can-i-set-default-value-for-hiddenfieldfor-in-asp-net-mvc)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:31:12.607

您的模型是空的，因为您的表单不包含任何数据。标签不被视为数据。它们是*数据*的标签。你需要的是这样的：

```
@Html.LabelFor(m => m.Subject, "Person or Interest")<br /> 
@Html.DisplayFor(m => m.Subject) 
```

**编辑**：为了使上述部分更清楚，我应该强调 glosrob 是正确的，因为您只需要`EventId`处理删除。其他一切只是为了显示正确的信息，以便用户可以验证他们正在删除正确的记录。我只是想指出标签不被视为表单数据，它们是一种视觉指示。

不过这里有几点需要注意：

首先，您`EventId`不应该对修改持开放态度，因此应该使用`@Html.HiddenFor(m => m.EventId)`. 这会将其呈现为用户无法看到的隐藏字段。这并不意味着它不能被修改，您最终应该使用[AntiForgeryToken](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper.antiforgerytoken%28v=vs.98%29.aspx)来帮助解决这个问题。

其次，您不需要为标签指定字符串。您可以在视图模型上执行此操作，而不是使用数据注释：

```
// DisplayName is in System.ComponentModel and not System.ComponentModel.DataAnnotations;
using System.ComponentModel;  

public class EventViewModel
{
    [DisplayName("Person or Interest")]
    public string Subject { get; set; }
} 
```

然后在视图中你可以使用`@Html.LabelFor(m => m.Subject)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T16:22:31.800

好的，问题是您的表单只有标签，但没有输入。它的输入值被发送到服务器，然后 ASP.NET MVC 绑定到模型类。

取而代之的是（您只有标签，标签不是帖子有效负载的一部分）

```
@Html.LabelFor(m => m.EventDesc, "Description")<br />
@Html.LabelFor(m => m.EventDesc, Model.EventDesc) 
```

你应该有（文本框将呈现`<input />`html 标签）

```
@Html.LabelFor(m => m.EventDesc, "Description")<br />
@Html.TextBox(m => m.EventDesc) 
```

我也同意@glosrob 的评论，您不必显示/允许编辑您的 ID。它应该取决于隐藏的输入，因此它将正确绑定到 POST 上的模型

```
@Html.HiddenFor(m => m.EventID) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T16:31:36.990

在我看来，您的回发没有通过您要删除的项目。你可以`HiddenFor(m => m.EventID)`用来传递你的模型的 ID，或者只是把它放在表单路由值中：

```
@using (Html.BeginForm("Delete", 
                       "Event", 
                       new { idToDelete = Model.EventID }, 
                       FormMethod.Post)) 
```

当然，要做到这一点，您必须将您的操作方法更改为仅使用 ID。

# java - 如何调用此实例方法

> ID：10249605
> 
> 赞同：0
> 
> 时间：2012-04-20T16:04:06.143
> 
> 标签：java, methods

您好我正在尝试调用返回类型为布尔值的非静态方法，

如果那里有一个静态，我会知道该怎么做，但是静态似乎把它全部扔掉了，我试图用该行创建一个新的方法实例

```
 Loginn auth = new Loginn(1,2,3) 
```

并且

```
 Login.Loginn auth = new Login.Loginn(1,2,3) 
```

代码可以在这里找到...

[http://www.pastebin.com/qwAtR7u0/](http://www.pastebin.com/qwAtR7u0/)

谢谢

C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:05:43.773

要调用您编写的静态方法`result = ClassName.methodName(parameters);`

（但乍一看，我无法在您引用的代码中看到任何静态方法。）

Loginn 你会调用：

```
Login instance = new Login();
boolean result = instance.Loginn(parameters); 
```

或者你可以这样做：

```
boolean result = new Login().Loginn(parameters); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:06:21.803

您可以像这样调用静态方法：

```
Login.Loginn(1,2,3) 
```

您不需要 new 关键字。

此外，您可能不想为 Login.Loginn 分配任何内容......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:09:22.663

您发布的代码中没有静态方法。

```
public class Login {
    ...

    public boolean Loginn(String UserName, String PassWord, String IP) throws UnknownHostException, IOException { ... }
} 
```

要调用该方法，您只需调用对象实例上的方法名称：

```
Login myLogin = new Login();
myLogin.Loginn( username, password, IP); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T16:10:06.640

如果它是返回类型为 Boolean 的静态方法，请尝试：

```
if(Login.Loginn(1,2,3))
{
//your code here
}
else
{
//some code
} 
```

或者

```
boolean result = Login.Loginn(1,2,3); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T16:12:41.070

你根本没有调用方法！您正在调用构造函数。

它是这样称呼的：

```
Loginn auth = new Loginn("username", "password", "IP"); 
```

您不能用整数调用它 - 3 个参数是`String`s。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T16:14:13.340

在您的代码`Loginn`中是一个公共方法，而不是静态的。所以你需要像这样打电话：

```
Login login = new Login();
login.Loginn("user","pass","ip"); 
```

如果您将方法转换为静态（`public static Loginn`），那么您可以使用：

```
Login.Loginn 
```

此外，请查看[java 代码约定](http://www.oracle.com/technetwork/java/codeconv-138413.html)以更好地命名您的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-20T16:08:58.700

根据那里的情况，您似乎想要：

```
Login login = new Login();
login.Loginn(1,2,3); 
```

# selenium - PHPUnit 和 Selenium 代码覆盖率 - 覆盖率指标在测试中途停止

> ID：10249606
> 
> 赞同：3
> 
> 时间：2012-04-20T16:04:09.603
> 
> 标签：selenium, phpunit, code-coverage

我刚刚开始使用 PHPUnit 和 Selenium，但一个问题一直困扰着我：我似乎无法获得正确的覆盖率数据。

我的应用程序让用户完成一个涉及多个页面的多步骤过程，每个页面在 PHP 中由一个显示函数（用于输出 HTML）和一个处理函数（用于处理 POST 操作的结果）处理。我的基线测试贯穿整个过程，并在访问了大约七页后正确完成。我已经通过视觉和测试用例本身的断言验证了这一点。

这个问题是覆盖率报告表明只执行了前几个函数，而其他函数从未被访问过（尽管我进行了视觉和测试用例检查）。我认为问题是在第一个函数期间发生的 PHP 通知，这可能会阻止 XDebug/PHPUnit 收集统计信息，但我解决了这个问题，问题仍然存在。

有什么东西可以在测试中途停止收集覆盖率统计信息吗？所有有问题的函数都在同一个文件中，并从（不同的）中央 PHP 脚本调用，该脚本根据递增的会话变量选择要调用的函数。

# asp.net - 在不影响存储在数据库中的路径的情况下更改文件夹的位置

> ID：10249610
> 
> 赞同：0
> 
> 时间：2012-04-20T16:04:13.983
> 
> 标签：asp.net, database, virtual, directory

我有一个存储图像的文件夹，图像的路径存储在数据库中。那里存储了近 2500 多张员工图像。

如果我想更改包含图像的文件夹的物理位置，如何管理数据库中存储的路径以及虚拟路径、根目录和所有相关信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:08:51.320

好吧，这就是我要做的：

1.  将图像复制到新目录。（暂时保留旧目录）
2.  在您的数据库上运行 SQL 更新脚本以更改存储位置。（在不知道您的数据库结构的情况下，我不能说更多。）
3.  更新您的应用程序代码以指向新目录。
4.  测试您的应用程序以验证它是否使用新目录。
5.  将旧目录重命名为其他目录，这样任何指向它的链接都会中断。
6.  看看有没有什么坏处，然后修复它！

# javascript - 验证 JS 函数

> ID：10249611
> 
> 赞同：0
> 
> 时间：2012-04-20T16:04:14.193
> 
> 标签：javascript, html, spring-mvc, jstl

我有一个通过搜索添加的人员列表。一切正常，但有一种情况，如果你不从这个列表中选择一个人，你会得到一个丑陋的 400 页。显然这是因为我没有在那里处理验证。

我的“从列表中删除”按钮是这样完成的：

```
<input type="button" value="Remove" onclick="delTeamNominee(document.f.teamList.value)"/> 
```

这是我的功能：

```
function delTeamNominee(id) {
    document.dl.empId.value = id;
    document.dl.submit();        
} 
```

`dl`是一个执行 Spring MVC 方法的隐藏表单：

```
 <form name="dl" action="teamDeleteEmployee" method="post">
    <input type="hidden" name="empId">
</form> 
```

显然我想做这样的事情：

```
function delTeamNominee(id) {
    if (id == null) {
         alert("You must select a person");
    } else {
         document.dl.empId.value = id;
         document.dl.submit();
    }
} 
```

当然，这是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:16:06.017

也许您还应该检查 id 是否未定义。类似以下的内容将同时捕获 null 和 undefined：

如果 (!id) { .... }

# dojo - Dojo 饼图 - 想要按原样显示数据数组值

> ID：10249613
> 
> 赞同：0
> 
> 时间：2012-04-20T16:04:21.853
> 
> 标签：dojo

我正在研究道场饼图。当我将数据作为 [ {y:10}, {y:40}, {y:30}] 提供给图表时，我希望看到图表上显示的值分别为 10%、40% 和 30%。但图表显示为 12.5%、37.5% 和 50%。我应该怎么做才能使饼图显示我发送的值？

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T09:34:00.097

解决方案很简单：根据需要设置标签：`[{y: 10, text: "10%"}, ...]`等等。您可以轻松地将其自动化。草图：

```
var items = [10, 40, 30];
addSeries("default", dojo.map(values, function(item){
  return {y: item, text: item + "%"};
}); 
```

您可以添加自定义工具提示或其他一些属性（例如颜色）的相同方式。

# ruby-on-rails - 使用 Rspec 测试具有局部变量的控制器

> ID：10249617
> 
> 赞同：1
> 
> 时间：2012-04-20T16:04:48.260
> 
> 标签：ruby-on-rails, ruby, rspec, mocking, stub

我是 Rspec 的新手，对 RoR 也很陌生。话虽如此，我已经用尽了所有的选择来试图让它发挥作用。我在方法中有一个变量，可以`User`在`create`我的`UserController.rb`. 此变量从身份验证方法获取数据。然后，我使用这个局部变量，它是来自 API 调用的响应，根据变量参数创建用户。据我所知，我已经尝试了所有关于 Rspec 的知识，但没有太多运气。我不断收到错误，因为数据变量为零，因为我存根/模拟了方法和变量。

如果有人可以帮助我弄清楚如何测试这个或将我链接到一个关于如何做到这一点的好教程（我读过很多），我真的很感激。

这是我的代码：

### users_controller.rb

```
def get_google_data
  ...
  data = response.parsed #OAuth2 

  @id = data['id']
  @email = data['email']
  @fname = data['given_name']
  @lname = data['family_name']
end

def create
  get_google_data
  puts "Got google data"
  puts @id
  if !@id.nil?
    puts "data is not nil"
    @user = User.find_by_google_id(@id)
    puts @user

    if @user.nil?
      puts "inside user condition"
      @user = User.new(:email => @email, :google_id => @id,
                       :first_name => @fname,
                       :last_name => @lname)

      if @user.save
        render json: @user, status: :created, location: @user
      else
        render json: @user.errors, status: :unprocessable_entity
      end
    else
      puts "ended in the right Place"
      render json: @user, location: @user
    end
  end
end 
```

### users_controller_spec.rb

```
describe "should not create duplicate user" do
  it "returns user object that was previously created" do
    @user = mock_model(User, :google_id=>1)
    #controller.should_receive(:get_google_data).and_return(:true)
    controller.instance_variable_set(:@id, 1)
    User.stub!(:find_by_google_id).with(1).and_return(@user)

    post :create
    @user.should_not be_nil
  end
end 
```

我有2个问题。

1.  测试失败，因为我无法控制数据`data['id']`和以下分配。

    ```
    Failure/Error: post :create
     NoMethodError:
       undefined method `[]' for nil:NilClass
     # ./app/controllers/users_controller.rb:109:in `get_google_data'
     # ./app/controllers/users_controller.rb:118:in `create'
     # ./spec/controllers/users_controller_spec.rb:6:in `block (3 levels) in <top (required)>' 
    ```

2.  return 的调用给`@user`了我一个循环引用错误：

    ```
    2) UsersController should not create duplicate user returns user object that was previously created
     Failure/Error: post :create
     ActiveSupport::JSON::Encoding::CircularReferenceError:
       object references itself
     # ./app/controllers/users_controller.rb:141:in `create'
     # ./spec/controllers/users_controller_spec.rb:24:in `block (3 levels) in <top (required)>' 
    ```

# php - 在 PHP 中处理要导入的 CSV 文件时，只导入了一半的行

> ID：10249621
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:01.170
> 
> 标签：php, csv, fopen

我们正在尝试通过 PHP 将 CSV 文件导入 MySQL。字符编码为 utf-8（经过检查、规范化和验证）。使用 MySQL 客户端界面工具导入时，所有行都存在。代码如下：

```
 $handle = fopen($this->file_name, 'r+') or die ('cant open a '.$this->file_name);
 $new_filename = $upload_directory.'/'.date('Y_m_d_H_i_s').'_data_import.csv';
 $for_import = fopen($new_filename, 'x+') or die ('cant open a '.$new_filename.'_for_import');

 $data = array();
 $row_counter = 0;

 while (($row = fgetss($handle)) !== false)
 {
    $row = fgetss($handle);
    if (($row_counter > $this->rows_to_ignore))
{
    $enc = mb_detect_encoding($row);
    $row = iconv($enc, 'UTF-8', $row);
    $row = str_replace(", ", '\\, ', $row);
    $row = trim($row);
    $row = str_getcsv($row, ',', '"', '\\');
    fputcsv($for_import, $row, ',', '"');
}

$row_counter++;

 }
 fclose($for_import);
 fclose($handle); 
```

row_counter 变量返回所有行的大约 50%。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:07:19.417

你打`$row = fgetts($handle)`了两次电话。第一个调用在您的`while()`条件下并消耗一行，第二个调用在循环内并消耗另一行。第一次调用的行正在丢失。

# html - 带有图像作为提交按钮的表单文本输入（输入类型 =“图像”），并且按钮未对齐

> ID：10249624
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:13.837
> 
> 标签：html, forms

HTML：

```
<form action="search.php" method="GET">
    <input type="text" name="q" value="Search for an item..." width="150" style="border: solid 1px black; padding: 3px;" />
    <input type="image" src="images/search_icon.png" style="width: 24px; height="30px;" /> 
</form> 
```

我得到什么：

![在此处输入图像描述](../Images/1cfbd1ce4319908760d5aa6b59dd1b75.png)

顺便说一句，如果我尝试在按钮上使用填充，它会将整个表单向下移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:24:17.103

尝试将输入上的垂直对齐属性设置为中间。

```
input {
    vertical-align: middle;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/wMYX4/1/)**。

# eclipse-rcp - 打开隐藏视图

> ID：10249626
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:16.443
> 
> 标签：eclipse-rcp

我有一个带有两个视图的透视图，在应用程序的开头显示了一个 viewA 并隐藏了 viewB。用户有可能从 viewA 中的表中选择一个项目，并且该选择打开了 viewB，它在开始时是隐藏的，而隐藏 viewA？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:54:20.897

假设您有一个 TableViewer，在您的视图上，您​​可以这样做：

```
this.yourTableViewer.addDoubleClickListener(new IDoubleClickListener() {
        public void doubleClick(DoubleClickEvent event) {
            IStructuredSelection selection = (IStructuredSelection) event.getSelection();
            if (selection .isEmpty()) {
                MessageHelper.openWarning("Select something");
                return;
            }

            try {
               //opens a Editor instead a view
                getSite().getPage().openEditor(new UsuarioEditorInput((Usuario) selecao.getFirstElement()), "br.com.germantech.ecf.usuarioEditor");
            }
            catch (PartInitException e) {
                e.printStackTrace();
            }
        }
    }); 
```

# facebook - Facebook 手机上的应用程序给了我 4oh4 / 404

> ID：10249631
> 
> 赞同：1
> 
> 时间：2012-04-20T16:05:24.630
> 
> 标签：facebook, mobile, http-status-code-404

我们已经创建了一个 Facebook 应用程序，但是在移动设备上（通过 Web 或 iPhone）打开它时，页面会导致 4oh4 错误。我已经设置了一个移动 Web URL，但仍然（等待 1 小时后）给出 404。

我需要对我的应用程序进行特定更改吗？

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:36:48.093

正如@Igy 所说，这是意料之中的。您将需要一个处理程序来支持将移动用户重定向到您的 apps.facebook.com/ 或者如果您要尝试使用嵌入的应用程序直接链接到您的页面，您可以将他们从 Facebook 重定向到您自己的 URL标签。

即指向[http://yoursite.com/redirector的链接](http://yoursite.com/redirector)

*   **移动**到[http://yoursite.com/myapp](http://yoursite.com/myapp)或[http://apps.facebook.com/](http://apps.facebook.com/)
*   **非移动设备**访问[http://facebook.com/](http://facebook.com/) /app_

需要注意的一些事项：

1.  您不会在您的页面上从 facebook 获取任何特定于页面的数据（即喜欢或不喜欢）。
2.  根据 #1，您将无法从页面限制不喜欢的应用程序用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-04T15:03:36.660

在尝试了所有方法以使 Facebook 重定向到移动 Web URL 之后，我需要执行以下操作才能使重定向正常工作：

1.  确保 Facebook 应用程序是画布应用程序。这使您能够为应用程序提供名称空间。
2.  为您的应用程序提供一个命名空间，以便您可以通过[https://apps.facebook.com/NAMESPACE](https://apps.facebook.com/NAMESPACE)访问它。从这里，Facebook 将为您进行检测，并在需要时将您的用户重定向到您指定的移动 URL。
3.  确保您的应用未处于沙盒模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-01T14:23:02.247

如果您的应用处于沙盒模式，Facebook 不会将您重定向到您在应用设置中指定的移动版本。

Facebook 为您进行重定向，您不必这样做。尽管他们对“移动”的版本和您认为的“移动”可能有所不同。

# objective-c - ARC下返回NSString时如何避免临时对象

> ID：10249633
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:29.913
> 
> 标签：objective-c, ios, nsstring, automatic-ref-counting

我有一个具有两个属性的类：

```
@interface Contact : NSObject {
    NSString *lastname;
    NSString *lastNameUpper;
} 
```

我已经将 lastname 声明为一个属性（并在 .m 文件中合成它）：

```
@property (nonatomic, retain) NSString *lastname; 
```

但是，我想编写自己的方法来访问 lastNameUpper，所以我声明了一个方法：

```
- (NSString *) lastNameUpper; 
```

并像这样实现它：

```
- (NSString *) lastNameUpper {
    if (!lastNameUpper) {
        lastNameUpper = [lastname uppercaseString];
    }
    return lastNameUpper;
} 
```

这可以正常工作，但是由于它经常被调用，所以会调用很多临时对象。有趣的是，Instruments 显示很多“Malloc (4k)”，每次`lastNameUpper`访问次数都增加。我还可以看到内存分配在`objc_retailAutoreleaseReturnValue`.

由于在我将项目转换为 ARC 之前这工作正常，我假设我必须对方法签名进行一些 ARC 特定的添加，但我似乎无法使其工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:14:54.140

0：你应该*复制*你的 NSString 属性：

```
 @property (nonatomic, copy) NSString * lastname; 
```

> 我猜返回字符串是通过复制来实现的。

不。*不可变*字符串的副本是保留操作。只需在分析器中运行它，看看这在时间和内存上的成本是多少。此外，在这种情况下没有隐式副本。

**更新**

我在 Lion-64 上对此进行了测试。`uppercaseString`可能返回一个*可变*字符串。

为了安全起见，您可以考虑分配 : 的结果的`uppercaseString`副本`lastNameUpper = [[lastname uppercaseString] copy];`。这可能会导致更多或更少的分配，具体取决于您在实现中使用字符串的方式。如果您的属性副本，则每次分配时都会制作一个副本。简单的概括是分配一个副本，其余的通常会自己处理。

**测试程序**

```
// ARC enabled
#import <Foundation/Foundation.h>

@interface Contact : NSObject
{
    NSString * lastname;
    NSString * lastNameUpper;
}

@property (nonatomic, copy) NSString *lastname;

@end

@implementation Contact

@synthesize lastname;

- (NSString *) lastNameUpper {
    if (!lastNameUpper) {
        lastNameUpper = [lastname uppercaseString];
    }
    return lastNameUpper;
}

@end

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        int n = 0;
        while (n++ < 100000) {
            Contact * c = [Contact new];
            c.lastname = @"skjdhskjdhaksjhadi";
            NSString * lastNameUpper = c.lastNameUpper;
        }
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:13:54.777

覆盖`- (void)setLastname:(NSString*)aLastname`方法（由 自动创建`@synthesize lastname`，并将 lastNameUpper 设置为现有方法。

现在创建一个 lastNameUpper 属性（并合成它）：

```
@property (nonatomic, readonly) NSString *lastNameUpper; 
```

由于这将返回 lastNameUpper 实例变量的指针，因此无论何时访问它都不应进行复制。

# html - 当缓存清单中不存在时，Chrome 从缓存中提供资源

> ID：10249635
> 
> 赞同：1
> 
> 时间：2012-04-20T16:05:31.690
> 
> 标签：html, cache-manifest

我正在玩 HTML 5 缓存清单，我在 Chrome 中看到了一个非常奇怪的问题。这是页面的标题：

```
<html id="html" xmlns="http://www.w3.org/1999/xhtml" manifest="Portal/CacheManifestHandler.ashx"> 
```

以下是从提琴手捕获的清单内容：

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/cache-manifest; charset=utf-8
Expires: -1
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Fri, 20 Apr 2012 15:56:20 GMT
Content-Length: 56

CACHE MANIFEST
NETWORK:
*
#Timestamp: 634705337615835020 
```

我在页面的标题内有一个特定的脚本，该脚本是在服务器上动态生成的。以下是用户第一次访问该页面时为该脚本标签返回的内容：

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/javascript; charset=utf-8
Expires: -1
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Fri, 20 Apr 2012 15:36:33 GMT
Content-Length: 74

document.location='/Portal/Login.aspx?ReturnUrl=%2fPortal%2fDefault.aspx'; 
```

您可以看到脚本既不在 Cache-manifest 中，也不在其标头允许浏览器 (Chrome) 缓存它。仍然当我随后在浏览器中打开同一页面时，Chrome 会从缓存清单加载页面，这没关系。然而令人惊讶的是，它也从缓存中加载了 <script>。我可以验证它，因为我的服务器断点没有被命中，Fiddler 也没有显示对此 <script> 的请求。网络没有关闭并且服务器可以访问（这应该没有什么不同，因为 Chrome 被要求不要缓存这个 <script> 反正）。

这是预期的行为吗？Chrome 不应该再次从服务器请求 <script> ，即使它的包含页面是从清单缓存中加载的。

Chrome 的 chrome://appcache-internals 在缓存中也只显示了 2 个 url，这也很好，为什么它会从缓存而不是服务器加载 <script> ![Chrome 的 chrome://appcache-internals 在缓存中也只显示了 2 个 url，这也很好，为什么它会从缓存而不是服务器加载 <script>](../Images/0e77621984fe0e3c33206d7f057b699c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:16:52.257

我们遇到了同样的问题，我们的解决方案是在 app.manifest 的网络部分添加 *，这样我们的网络部分看起来像

网络： *

我现在正在挖掘这是否真的是谷歌的“设计”，还是完全错误。

# java - 从 java 代码运行 .class 文件

> ID：10249637
> 
> 赞同：1
> 
> 时间：2012-04-20T16:05:37.000
> 
> 标签：java, compiler-construction, jvm

如何`.class`从 java 代码本身运行已编译的代码 () java？

我正在做一种提供服务，比如在服务器端编译和运行 java 代码并将输出提供给最终用户。

任何人都可以提出一种可以实现这一目标的方法吗？

```
import java.io.*;

public class demo {

    public static void main(String args[]) throws IOException, InterruptedException {
        int result;
        try {

            System.out.println("command output:");
            Process proc = Runtime.getRuntime().exec("java -cp . demoh");
            InputStream in = proc.getInputStream();
            result = proc.waitFor();

            BufferedInputStream buffer = new BufferedInputStream(proc.getInputStream());

            BufferedReader commandOutput = new BufferedReader(new InputStreamReader(buffer));
            System.out.print(commandOutput);

            String line = null;
            try {
                while ((line = commandOutput.readLine()) != null) {
                    System.out.print(line);
                    System.out.println("command output: " + line);
            }//end while
            commandOutput.close();

            } catch (IOException e) {
                //log and/or handle it  
            }
        } catch (IOException e) {
            System.err.println("IOException raised: " + e.getMessage());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:09:31.203

如果您`.class`在磁盘上的某处有文件，只需生成一个新进程并像从命令行一样运行 java 命令：

```
Process p = Runtime.getRuntime().exec("java <java class file>"); 
```

经过一些测试，以下代码对我有用：

```
public static void main(String args[]) throws IOException, InterruptedException {
    int result;

    try {

        System.out.println("command output:");
        Process proc = Runtime.getRuntime().exec("java -cp . Test");

        InputStream errin = proc.getErrorStream();
        InputStream in = proc.getInputStream(); 
        BufferedReader errorOutput = new BufferedReader(new InputStreamReader(errin));
        BufferedReader output = new BufferedReader(new InputStreamReader(in));
        String line1 = null;
        String line2 = null;
        try {
            while ((line1 = errorOutput.readLine()) != null || 
                   (line2 = output.readLine()) != null) {                   
                if(line1 != null) System.out.print(line1);
                if(line2 != null) System.out.print(line2);               
            }//end while
            errorOutput.close();
            output.close();
        } catch (IOException e) {
            e.printStackTrace(); 
        }//end catc
        result = proc.waitFor();
    } catch (IOException e) {
        System.err.println("IOException raised: " + e.getMessage());
    }
} 
```

这里注意两点：

1.  java进程给出的运行时错误被发送到错误流，而不是输入流，所以你必须阅读它们！
2.  您必须**在进程运行**时读取流。在读取流之前等待进程完成会导致死锁，因为进程输出缓冲区已满，正在等待父进程读取数据，而父进程正在等待子进程完成！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:20:31.877

一种选择是使用类加载器创建类的实例。类加载器可以将你的类作为一个字节数组，然后你可以创建它的一个实例并运行它。请参阅JDK 文档中的[此方法](http://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#defineClass%28java.lang.String,%20byte%5b%5d,%20int,%20int,%20java.security.ProtectionDomain%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T17:08:44.150

这是一个示例应用程序，它将编译 Java 源文件、加载类、实例化一个实例并打印出 HelloWorld 类的 toString()。我相信您需要在类路径中使用 tools.jar。示例代码需要 src 文件夹中的源文件。src 文件夹在类路径中是必需的，因为默认情况下会在此处生成 .class 文件。

有关 Java 编译器的更多控制，请阅读 javax.tools 包。

```
package sourcerunner;

import java.io.IOException;
import java.util.concurrent.TimeUnit;
import javax.tools.JavaCompiler;
import javax.tools.ToolProvider;

public class SourceRunner {

    public static void main(String[] args) throws IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, InterruptedException {
        JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();

        compiler.run(System.in, System.out, System.err, "src/sourcerunner/HelloWorld.java");

        TimeUnit.SECONDS.sleep(1L);

        Class<?> cls = Class.forName("sourcerunner.HelloWorld");

        Object instance = cls.newInstance();

        System.out.println(instance);
    }
} 
```

这是 HelloWorld 类：

```
package sourcerunner;

public class HelloWorld {

    @Override
    public String toString() {
        return "Hello Java Compiler World.";
    }
} 
```

上面的代码非常不安全。理解代码后，修改它以使用新的 ClassLoader 来加载和实例化类。确保 ClassLoader 具有最小权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:08:02.313

创建 .jar 文件并将该文件添加到构建路径

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T16:09:50.800

尝试

```
Process process = Runtime.getRuntime().exec("java " + filePath); // without .class
Scanner output = new Scanner(process.getInputStream());
while (output.hasNext) {
   String token = output.next();
   ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T16:10:04.083

还有很多构建/编译工具，即 Ant 或 Maven，您可以在编写自己的之前检查一下。

# django - Django排名解决方案

> ID：10249639
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:43.053
> 
> 标签：django, ranking, rownum

我正在尝试建立一个简单的排名系统，我按“分数”和“ID”对科目进行排序。我最初通过在 SQL 中设置“rownum”变量并像这样调用“Rank”来构建这是 PHP：

```
public function rank() {
    global $database;
    $sql = "SET @rownum :=0";
    $database->query($sql);
    $sql = "SELECT rank FROM ( 
        SELECT @rownum:=@rownum+1 AS rank, id, score 
        FROM subjects
        ORDER BY score DESC, id ASC) AS derived_table 
        WHERE id = {$this->id}";

    $result_set = $database->query($sql);
    $row = $database->fetch_array($result_set);
    return array_shift($row);
    } 
```

我可以从 Queryset 中对其进行索引，但我也没有弄清楚如何做到这一点。关于如何在 Django 中完成此任务的任何想法？

该模型：

```
class Subject(models.Model):
    def __unicode__(self):
        return self.name
    def __str__(self):
        return self.name

    name = models.CharField(max_length=40)
    score = models.IntegerField(default=0)
    created = models.DateTimeField(default=datetime.datetime.now) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T16:25:15.937

尝试

```
order_by('score', 'pk') #pk is the ID or primary key 
```

查看[Django Book：第 5 章模型](http://www.djangobook.com/en/2.0/chapter05/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:22:13.630

使用[额外的](https://docs.djangoproject.com/en/dev/ref/models/querysets/#extra)方法可以做到这一点。

```
Blog.objects.extra(
    select={
        'entry_count': 'SELECT COUNT(*) FROM blog_entry WHERE blog_entry.blog_id = blog_blog.id'
    },
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T08:44:37.957

尝试这个：

```
someSubject = Subject.objects.get(name='someSubject')
someSubject_rank = Subject.objects.filter(score__gt=someSubject.score).count()+1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-10T21:23:09.563

如果您只想显示数据而不是进一步处理每一行的排名字段，那么使用 Django[`forloop.counter`模板变量](https://docs.djangoproject.com/en/1.10/ref/templates/builtins/#for)的简单而优雅的方法：

```
# your views.py    
return (super(View, self).get_context_data(
        subjects=Subject.objects.order_by("-score", "pk"), 
        **kwargs)
)

# your template.html
{% for subject in subjects %}
    <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ subject.name }}</td>
        <td>{{ subject.score }}</td>
    </tr>
{% endfor %} 
```

# asp.net - 如何对齐 asp：列中的标签？

> ID：10249641
> 
> 赞同：0
> 
> 时间：2012-04-20T16:05:45.360
> 
> 标签：asp.net, css, label, alignment

我有一个单栏网页。在这个固定宽度的列中，我希望**在同一行上**有 3 个 asp:Labels 。第一个标签必须左对齐，中心对齐，右标签右对齐。

我如何标记这些 asp:Labels 来做我想做的事？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:12:32.040

由于列是固定宽度，因此将每个标签包装在一个 div 中，宽度明确设置为列的 1/3。所有 3 个 div 必须浮动：左。然后使用 css 定位标签。

```
<div style="width: 300px">
    <div style="width: 100px; float: left; text-align: left">left</div>
    <div style="width: 100px; float: left; text-align: center">center</div>
    <div style="width: 100px; float: left; text-align: right">right</div>
</div> 
```

只需将 div 的内容替换为您的标签即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:12:06.237

使用与页面一样宽的 1 行表格，并将每个标签放在每个单元格中。在每个单元格上设置 align 属性以将标签放置在左侧、中心和右侧

# javascript - 如何从 PhoneGap/webapp 将文件 ftp 到服务器？

> ID：10249645
> 
> 赞同：1
> 
> 时间：2012-04-20T16:05:58.280
> 
> 标签：javascript, jquery, android, ajax, cordova

是否可以从 PhoneGap 应用程序中连接到服务器并 FTP 文件？基本上我想 - 有没有办法以某种方式打开与 Ajax/JQuery 的 FTP 连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:12:22.880

我认为您无法从 PhoneGap FTP 文件，但是它们确实提供了一个 API，用于使用 HTTP 多部分编码将文件传输到服务器：

[http://docs.phonegap.com/en/1.0.0/phonegap_file_file.md.html#FileTransfer](http://docs.phonegap.com/en/1.0.0/phonegap_file_file.md.html#FileTransfer)

您需要使用所选技术的服务器上的脚本来接收文件，但是您应该能够对它做任何您喜欢的事情，包括将其移动到您尝试通过 FTP 访问的目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T11:10:23.630

用于电话间隙的 Ftp 程序在这里，请参阅下面的链接。

[https://github.com/macdonst/FtpClient](https://github.com/macdonst/FtpClient)

# java - JFreeChart：几个时间序列在时间序列图表上显示不正确

> ID：10249646
> 
> 赞同：2
> 
> 时间：2012-04-20T16:06:01.693
> 
> 标签：java, jfreechart

我有一个 TimeSeries 图表，显示每个日期的一些值，并且有两个系列显示为两条不同的线。问题是有时一个系列不包含某些特定日期的值。在那种情况下，我假设这条线将从本系列的前一点继续到下一点。不幸的是，它在图表上无法正常工作，看起来有些东西根本没有正确绘制。

如果每个系列在每个日期都包含适当的值，那很好。

我的代码在这里：

```
for (String source : graphData.keySet()) {
        SortedMap<LocalDate, BigDecimal> data = graphData.get(source);
        LocalDate prevDate = null;
        for (LocalDate date: data.keySet()) {
            if (prevDate == null) {
                prevDate = date;
                continue;
            }
            dataset.add(new SimpleTimePeriod(prevDate.toDateMidnight().toDate(), date.toDateMidnight().toDate()), data.get(prevDate), source, true);
            prevDate = date;
        }
        dataset.add(new SimpleTimePeriod(prevDate.toDateMidnight().toDate(), futureDate), data.get(prevDate), source, true);
    } 
```

`Map<String, SortedMap<LocalDate, BigDecimal>> graphData`包含所有系列的数据，其中地图的键是系列名称。正如我所说 - 有时 A 系列包含日期 1、2 和 3 的值，而 B 系列仅包含 1 和 2 的值。在这种情况下，A 和 B 的行看起来不正确......

有什么简单的方法可以解决这个问题吗？显而易见且难以实现的方法是计算 B 系列的遗漏值（使用线性插值？）并将其放入数据集，但这真的很难做到。也许我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:46:02.303

[*中点公式*](http://en.wikipedia.org/wiki/Midpoint)是替换单个缺失纵坐标的简单方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T11:06:28.377

了解如何解决它 - 为每个系列创建它自己的数据集和渲染器。然后，在创建图表时使用任何一个数据集，然后添加所有这些数据集和渲染器。

```
xyPlot.addDataset(0, firstDataset);
xyPlot.addDataset(1, secondDataset); 
```

或者如果可以有很多系列，那么最好在循环中进行

# php - 为什么 var_dump 可以确定私有变量的值，但在尝试访问单个属性时却不能

> ID：10249647
> 
> 赞同：3
> 
> 时间：2012-04-20T16:06:02.603
> 
> 标签：php, object, private-members, var-dump

我有一个对象被扔到会话数组中，我想在 items 属性上运行一个 foreach。

我似乎无法访问它。我看到它是私有的，但我不禁想知道为什么 var_dump 可以向我显示属性包含的内容但我无法读取数据，因为它会引发致命错误？

如果我真的必须喜欢[这个](https://stackoverflow.com/questions/139474/how-can-i-capture-the-result-of-var-dump-to-a-string)，我想我可以做一些输出缓冲并将 var_dump 评估为字符串，但似乎应该有更好的方法。有什么想法可以访问_items吗？

目标代码 var_dumped 来自`var_dump($_SESSION['PHPurchaseCart'])`：

```
object(PHPurchaseCart)#191 (4) {
  ["_items:private"]=>
  array(2) {
    [0]=>
    object(PHPurchaseCartItem)#190 (6) {
      ["_productId:private"]=>
      string(2) "80"
      ["_quantity:private"]=>
      int(1)
      ["_optionInfo:private"]=>
      string(20) "Monthly Sponsorship "
      ["_priceDifference:private"]=>
      string(3) ".01"
      ["_customFieldInfo:private"]=>
      NULL
      ["_formEntryIds:private"]=>
      array(0) {
      }
    }
    [1]=>
    object(PHPurchaseCartItem)#189 (6) {
      ["_productId:private"]=>
      string(2) "75"
      ["_quantity:private"]=>
      int(1)
      ["_optionInfo:private"]=>
      string(20) "Monthly Sponsorship "
      ["_priceDifference:private"]=>
      string(3) ".02"
      ["_customFieldInfo:private"]=>
      NULL
      ["_formEntryIds:private"]=>
      array(0) {
      }
    }
  }
  ["_promotion:private"]=>
  NULL
  ["_promoStatus:private"]=>
  int(0)
  ["_shippingMethodId:private"]=>
  NULL
} 
```

我尝试访问它的方式：

```
$fun = $_SESSION['PHPurchaseCart'];
var_dump($fun->_items);
exit; 
```

上面抛出了一个致命错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:13:12.877

这就是私有属性的想法：你不能访问它们。你真的不应该打破这个概念。如果您真的想访问此类属性，请在原始类定义中标记为“public”。

var_dump 之所以能够访问，是因为它是一个内部函数，拥有查看整个对象的“权力”。但是，您的代码没有这种能力。

我不会推荐它，但是如果你真的需要访问一个私有属性，你可以使用[PHP Reflection](http://php.net/manual/en/book.reflection.php)来实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:16:58.043

外部代码需要的私有属性通常有一个公共方法来读取它们，在这种情况下它是`getItems()`.

```
$items = $_SESSION['PHPurchaseCart']->getItems(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-18T13:39:53.410

> 我看到它是私有的，但我不禁想知道为什么 var_dump 可以向我显示属性包含的内容但我无法读取数据，因为它会引发致命错误？

请理解您应该使用所选答案中解释的 getter 和 setter 方法。

但是为了完成为什么以及如何阅读它（有助于调试）。好吧，值在那里，但私有方法被 NULL 字节（ASCII 值 0）包围。

所以如果你真的想用`var_dump();`

```
$key = "\0_items\0";
var_dump($fun->$key); 
```

# php - array_slice - 为什么这在 foreach 中不起作用

> ID：10249648
> 
> 赞同：1
> 
> 时间：2012-04-20T16:06:05.070
> 
> 标签：php

总菜鸟在这里。我有一个看起来像的数组：

```
Array
(
    [15] => Array
      (
        [0] => Array
            (
                [id] => 5216
                [name] => Grow your own Irish Shamrock gifts set
                [ordered] => 473
                [image] => FunShamrockPot.jpg
            )

        [1] => Array
            (
                [id] => 5217
                [name] => Irish Shamrock Seeds
                [ordered] => 357
                [image] => FunShamrockSeed.jpg
            )

        [2] => Array
            (
                [id] => 5759
                [name] => Ireland Fleece with Shamrock Badge
                [ordered] => 1
                [image] => IrelandFleeceShamrocks.jpg
            )

    )

    [31] => Array
      (
        [0] => Array
            (
                [id] => 5081
                [name] => Tartan Guinness Flat Cap
                [ordered] => 356
                [image] => GuinnessTartanFlatCap.jpg
            )

        [1] => Array
            (
                [id] => 4894
                [name] => Black signature emblem Guinness baseball hat
                [ordered] => 176
                [image] => GuinnessSigBBHat.jpg
            ) 
```

该数组称为 $products ，我试图仅打印出每个顶部数组中的前五个数组（如果有意义的话），换句话说，数组 [15]<-- 15 岁以下的前五个数组，数组 [31] <-- 这里的前 5 个数组。

我正在尝试的代码是：

```
foreach($products as $key=>$value) {
    array_slice($value, 0, 5);
    foreach($value as $product) {
        echo $product['name'] . '<br/>';
    }
    echo '<br/>';
} 
```

我不知道为什么 array_slice 不起作用，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:10:54.060

问题是`array_slice`不修改输入数组，需要返回值：

```
foreach($products as $key=>$value) {
    $sliced = array_slice($value, 0, 5);
    foreach($sliced as $product) {
        echo $product['name'] . '<br/>';
    }
    echo '<br/>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:08:01.290

```
foreach($products as $key=>$value) {
    $i = 0;
    foreach($value as $product) {
        if($i <5) {
        echo $product['name'] . '<br/>';
        $i++;
        } else {
        break;
        }
    }
    echo '<br/>';
} 
```

**编辑以回答为什么 array_slice 不起作用**

你需要做

```
$newarray = array_slice($value, 0, 5);
    foreach($newarray as $product) {
    echo $product['name'] . '<br/>';
} 
```

# java - 如何“读取字节”来读取 Objective-C 和 Java 之间的对象？

> ID：10249649
> 
> 赞同：0
> 
> 时间：2012-04-20T16:06:06.280
> 
> 标签：java, objective-c, sockets, byte

我需要在 Objective-C 客户端和 Java 服务器之间交换一个对象。我问我的朋友如何实现它，他回答我这`read byte`是要走的路。但它如何实现？我怎样才能知道可变长度和相关信息？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:10:45.097

不同语言的对象可能不容易交换。与其将 Java/ObjC 对象发送到 Java/ObjC 程序，我建议您将其作为其他字符串结构（可能是 XML/JSON）实际发送。然后从 XML/JSON 重建 Java/ObjC 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:14:04.650

您需要某种序列化格式。您可以使用基于文本的格式，例如 XML 或 JSON，并对其进行适当解码（无论是否手动）。或者，有各种可移植的基于二进制的序列化格式可用，例如具有[Objective-C 端口的](http://code.google.com/p/metasyntactic/wiki/ProtocolBuffers)[Protocol Buffers](http://protobuf.googlecode.com)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-20T16:12:57.490

这里有很多选择。 [JSON](http://en.wikipedia.org/wiki/JSON) , [protocol buffers](http://en.wikipedia.org/wiki/Protocol_Buffers) , ... 甚至还有一个[巨大](http://en.wikipedia.org/wiki/Comparison_of_data_serialization_formats)的可能性列表。

# jquery - 从插件外部更改默认值

> ID：10249650
> 
> 赞同：1
> 
> 时间：2012-04-20T16:06:06.953
> 
> 标签：jquery, plugins

我的插件是：

```
$.fn.iPopup = function() {
    var opts = new function() {
        this.width = 957;
        this.height = 590;
        this.left = ($(document).width() / 2) - (this.width/2) - (17/2);
        this.top = 160; 
    }
    alert (opts.width);
} 
```

我想在调用 plugin 时更改宽度或高度，例如：

```
$('div#tP').iPopup({width:280}); 
```

我应该在我的插件中做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:55:31.713

```
$.fn.iPopup = function(options) {
    var defaults = {
        'width' : 957,
        'height' : 590,
        'left' : ($(document).width() / 2) - (this.width()/2) - (17/2),
        'top' : 160
    },
    opts=$.extend({}, defaults, options);
} 
```

称它为

```
$('div#tP').iPopup({width:280}); 
```

[**一个例子。**](http://jsfiddle.net/heera/qa2ym/1/)

# java - 确定两个矩形重叠程度和方向的算法？

> ID：10249654
> 
> 赞同：0
> 
> 时间：2012-04-20T16:06:26.500
> 
> 标签：java, algorithm, collision-detection

有谁知道一种算法可以用来确定两个矩形重叠的数量和方向？我花了几个小时试图弄清楚这一点，以便我可以将它实现到一个用 slick2d + java 编写的基本瓷砖游戏中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:20:03.210

轮询角的坐标，如果的最近和最远顶点`Square1`之间有任何角`Square2`，它们是否因坐标差异而发生碰撞？

例子：

```
square1.setVertex1(0,0);
square1.setVertex2(2,0);
square1.setVertex3(2,2);
square1.setVertex4(0,2);

square2.setVertex1(1,1);
square2.setVertex2(4,1);
square2.setVertex3(4,4);
square2.setVertex4(1,4);

Vertex[] verticesSq1=Square1.getVertices();
for (Vertex vert: verticesSq1) {
    if(vert.getXVal>square2.getLowestXVal() &&
       vert.getXVal<square2.getHighestXVal() 

       &&
       vert.getYval>square2.getLowestYval() &&
       vert.getYVal<square2.getHighestYVal() {

            System.out.write("Vertex "+vert.ID+" is overlapping Square 2 by " +
            vert.getXval()-square2.getLowestXVal +","+
            vert.getYval()-square2.getLowestYVal);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:58:41.743

让我们将每个矩形表示为 R=(x1,x2,y1,y2)（即 (x1,y1), (x1,y2), (x2,y1), (x2,y2) 是该矩形的顶点，而 x1

现在，我们有两个矩形 R1 和 R2，我们想知道它们是否重叠，如果重叠，是什么方向。

对于 R1 的每个顶点，检查它是否在可以表示为 4 位的矩形 R2 内。映射很直接：

```
0000 -> None (or R2 is inside R1)
0001 -> R2 is bottom right of R1
0010 -> R2 is top right of R1
0100 -> R2 is bottom left of R1
1000 -> R2 is top left of R1
0011 -> R2 is right of R1
0101 -> R2 is bottom of R1
1100 -> R2 is left of R1
1010 -> R2 is left of R1
1111 -> R1 is inside R2 
```

其他组合是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:18:06.560

首先在矩形之间创建一个**中心点**（第二个矩形的中心 - 第一个矩形的中心）。检查从每个矩形的每个点到**中心点**的距离。选择 2 个最近的点，检查其中一个是否在另一个矩形内，如果是，则由这两个点创建的矩形给我们重叠区域。

# objective-c - 自定义函数出错

> ID：10249655
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:06:33.930
> 
> 标签：objective-c, xcode, ios5, xcode4.3

我试图让 UILabel.text 采用 NSString 自定义函数，但被错误难住了。我仍然是 iOS 的新手，但我的直觉表明它与语法有关。

```
- (void)viewDidLoad
{
    ...

    //Creating scrollable view
    CGRect scrollViewFrame = CGRectMake(0, 0, 320, 460);
    UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:scrollViewFrame];
    [self.view addSubview:scrollView];

    CGSize scrollViewContentSize = CGSizeMake(320, 800);
    [scrollView setContentSize:scrollViewContentSize];

    //Inserting Title
    UILabel *title = [[UILabel alloc]init];
    [title setFrame:CGRectMake(0, 0, 300, 40)];
    title.backgroundColor = [UIColor clearColor];
    title.text = self.setQuestion;<-error
    [scrollView addSubview:title];
    [title release];
}
- (void) setQuestion{
    NSString *qn = [NSString stringWithFormat:@"What do you get with%@", 5];

} 
```

提前谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:06:00.000

`title.text = [self setQuestion];`

但是`setQuestion`编码不正确。应该：

```
- (NSString*) setQuestion{
    return [NSString stringWithFormat:@"What do you get with %d", 5];
} 
```

并且不要忘记`setQuestion`在您的 .h 文件中包含原型。

（好吧，实际上，格式字符串也编码不正确。应该是“What do you get with %d”。）

# javascript - 相当于Javascript中的Ruby Enumerable#each_slice？

> ID：10249658
> 
> 赞同：16
> 
> 时间：2012-04-20T16:06:37.483
> 
> 标签：javascript, underscore.js

我在 Javascript 中寻找相当于 Ruby 的 Enumerable#each_slice 。

我已经在使用具有 each()、map()、inject() 的出色 underscore.js...

基本上，在 Ruby 中，这个很棒的方法可以做到这一点：

```
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].each_slice(3) {|a| p a}

# outputs below
[1, 2, 3]
[4, 5, 6]
[7, 8, 9]
[10] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T16:14:17.823

这个怎么样：

```
Array.prototype.each_slice = function (size, callback){
  for (var i = 0, l = this.length; i < l; i += size){
    callback.call(this, this.slice(i, i + size));
  }
};

[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].each_slice(3, function (slice){
  console.log(slice);
}); 
```

输出（在 Node.js 中）：

```
[ 1, 2, 3 ]
[ 4, 5, 6 ]
[ 7, 8, 9 ]
[ 10 ] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-20T16:31:54.403

我会稍微修改 Brandan 的答案，以更好地适应 JavaScript 和 underscore.js 的环境：

```
_.mixin({ "eachSlice": function(obj, size, iterator, context) {
    for (var i=0, l=obj.length; i < l; i+=size) {
      iterator.call(context, obj.slice(i,i+size), i, obj);
    } }}); 
```

这是一个[演示](https://jsfiddle.net/p0fe776L/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-11T06:46:31.120

我`_.chunk`在 lodash 中发现现在是一个更好的解决方案

```
var chunk = require('lodash/array/chunk');

_.chunk(['a', 'b', 'c', 'd'], 2);
// -> [['a', 'b'], ['c', 'd']] 
```

[https://lodash.com/docs#chunk](https://lodash.com/docs#chunk)

# ios - 有没有办法让键盘触发按钮按下？

> ID：10249660
> 
> 赞同：0
> 
> 时间：2012-04-20T16:06:39.103
> 
> 标签：ios, testing, xcode4, uibutton

我正在通过键盘在模拟器中测试 iOS 应用程序，并希望键盘返回键可以按下屏幕上的按钮。有没有办法做到这一点？我可以使用 Tab 键在 UITextField 之间移动，并通过 textFieldShouldReturn 方法捕获 Return 键，但我在页面上也有一个提交按钮，并且希望通过从键盘触发它而不使用鼠标来浏览它。如果有办法将焦点移到按钮上，以便我可以使用 KevinDTimm 建议的空格键，那就太好了。虽然我可以使用 Tab 键通过 UITextFields 移动焦点，但我只是不确定如何将焦点移到按钮上 - 此时选项卡不起作用。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:09:22.657

据我了解，您实际上想要进行自动化 UI 测试。但在这种情况下，“你”是自动化。以这种方式思考它导致我使用[ios-automated-tests-with-uiautomation](http://blog.manbolo.com/2012/04/08/ios-automated-tests-with-uiautomation) 可能无法直接解决您的问题，但可能是您应该走的路。

该博客引用了 Apples [UI 自动化参考集合](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/_index.html)，其中指出：

> 使用 UI 自动化功能编写测试脚本，在连接的设备上运行您的应用程序的用户界面元素。您使用 JavaScript 编写测试，调用 UI 自动化 API 来模拟用户交互。系统将日志信息返回给主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:08:24.670

IIRC，当您在 iOS 模拟器上的按钮上时，空格键起作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:33:47.343

如果焦点在按钮上，键盘就会消失。您捕获了返回，为什么不直接调用与按钮关联的操作？

编辑：在您的手机上使用蓝牙连接键盘进行尝试。那你知道事件了吗？我认为模拟器只是使用键盘作为使用虚拟键盘的一种方式，而不是像蓝牙连接的那样。

# html - HTML5 输入类型数字 16 位或更多 Chrome 用零替换

> ID：10249662
> 
> 赞同：3
> 
> 时间：2012-04-20T16:06:45.063
> 
> 标签：html, google-chrome, forms

在使用数字输入类型并且位数超过 16 时，是否有其他人遇到过 Chrome 问题？在我的情况下，第 16 位之后的任何内容都将被替换为模糊的零。这在其他浏览器中不会发生。

```
<label for="some-number-input">Number Input</label>
<input type="number" name="some-number-input" id="some-number-input" /> 
```

除了更改输入类型之外，还有其他解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T01:16:52.497

当数字输入模糊时，Chrome 会解析数字。根据[WHATWG 标准](http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#number-state-%28type=number%29)，它应该将其转换为 IEEE 754 双精度浮点数，就像在 JavaScript 中表示数字的方式一样。并且也像在 JavaScript 中一样，这些数字可以具有的精度是有限的，因此是四舍五入。

你可能想`<input type="text">`改用..

# javascript - 在加载和单击时检查下拉列表的值

> ID：10249664
> 
> 赞同：0
> 
> 时间：2012-04-20T16:06:48.340
> 
> 标签：javascript, jquery, html

我有一个下拉列表，我需要捕获页面加载时间和更改时间的值。如果未选择报告字段，则不显示 state-list 或 year-list，如果选择了报告字段（无论是在加载时还是当用户从下拉列表中选择时），显示相应的 div。

任何帮助表示赞赏，谢谢。

```
<script type="text/javascript"> 

$(document).ready(function() {
 checkReport();
});

</script>

<select name="report" id="report">
<option></option>
<option value="state">State</option>
<option value="year">Year</option>
</select>

<div id="state-list">NY, CA, TX</div>

<div id="year-list">2012, 2013, 2014</div>

function checkReport() {

  $('#report').live('change', function() {
    $('#year-list, #state-list).hide();
    var report = $('#report').val();

    if (report) {
      $('#' + type_of_report + '-list').show();
    } else {
      $('#year-list, #state-list).hide();
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:14:33.130

```
$(document).ready(function() {
checkReport();
 $('#report').live('change', checkReport);
});

function checkReport() {
    var report = $('#report').val();
    $('#year-list, #state-list').hide();
    if (report) {
      $('#' + report + '-list').show();
    }
} 
```

我猜这就是你需要的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:17:52.317

**尝试：**

```
<select name="report" id="report">
    <option value="">Select a type of report</option>
    <option value="state">State</option>
    <option value="year">Year</option>
</select>

<div id="state-list">NY, CA, TX</div>

<div id="year-list">2012, 2013, 2014</div>

<script type="text/javascript"> 

$(function(){

    checkReport($('#report')[0]);

    $('#report').on('change', function() {
        checkReport(this);
    });

    function checkReport(r) {            
        $('#year-list,#state-list').hide().filter(function(){
            return r.value.length > 0 &&   
             $(this).is('#' + r.value + '-list')
        }).show();            
    }
});

</script> 
```

**证明：http:** [//jsfiddle.net/iambriansreed/qvq3z/](http://jsfiddle.net/iambriansreed/qvq3z/)

**笔记：**

1.  我用说明替换了空白选项。

2.  您不需要`$('#report').on('change',`，因为它`select`最初是 DOM 的一部分。无需现场捕捉。你可以这样做： `$('#report').change(`。我只是添加它以保持`live`您的问题中显示的功能。

# apache - 配置 Apache 以将所有内容从端口 80 重定向到另一个域

> ID：10249666
> 
> 赞同：0
> 
> 时间：2012-04-20T16:07:09.057
> 
> 标签：apache, redirect

我通常在 Django 中编程，但在 Apache 中更有意义。我需要对到达端口 80 的任何域的每个请求都重定向到另一个域（在端口 80 上），但是到达任何其他端口的请求仍然应该进来。它不能是永久重定向。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T11:15:33.807

由于我在 Apache 中将虚拟主机设置为侦听端口 80，因此我不需要告诉重定向指令侦听该端口，因此只需将其添加到侦听端口 80 的虚拟主机中：

```
RewriteEngine on
RewriteRule ^$ http://other-domain.com/ [R=302,L] 
```

# android - 用于 Android TextView 的自定义样式的访问名称

> ID：10249672
> 
> 赞同：1
> 
> 时间：2012-04-20T16:07:25.830
> 
> 标签：android, fonts, styles, typeface

我们正在为我们的 Android 应用程序使用自定义样式，同时尝试使用自定义字体。由于我无法通过 xml 设置自定义字体，我们定义了 textview 的子类并在那里设置字体。但是，如果能够通过 xml 来调整字体（不是它的样式，即常规、粗体、斜体...），那就太好了。

基本想法是查看我们拥有的样式并利用其名称来确定要使用的字体。

样式可能如下所示：

```
<style name="MyFont">
  <item name="android:textSize">12sp</item>
  <item name="android:textStyle">normal</item>
</style>
<style name="MyFont.Font1"></style>
<style name="MyFont.Font2"></style> 
```

而 TextView 本身可能是

```
<com.project.some.OurTextView 
  style="@style/MyFont.Font1" 
  android:text="@string/hello" /> 
```

如果`com.project.some.OurTextView`我发现样式的名称实际上是`Font1`or `Font2`，我将能够切换大小写并使用基于此的字体。

所以，问题仍然存在：是否可以访问样式名称？

一如既往，我们非常感谢您的帮助！干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:11:41.453

```
<style name="MyFont" parent="android:Theme">
  <item name="android:textSize">12sp</item>
  <item name="android:textStyle">normal</item>
</style>
<style name="MyFont.Font1"></style>
<style name="MyFont.Font2"></style> 
```

试试上面的 style.xml 文件，每个样式元素都必须有父标签。参考这个[链接](http://developer.android.com/guide/topics/ui/themes.html)

# python - python一次读取网站源代码的行数100行

> ID：10249673
> 
> 赞同：0
> 
> 时间：2012-04-20T16:07:35.560
> 
> 标签：python, url, urllib, readline

我正在尝试一次从网站读取 100 行的源代码

例如：

```
self.code = urllib.request.urlopen(uri)

#Get 100 first lines
self.lines = self.getLines()

...

#Get 100 next lines
self.lines = self.getLines() 
```

我的 getLines 代码是这样的：

```
def getLines(self):
    res = []
    i = 0

    while i < 100:
        res.append(str(self.code.readline()))
        i+=1

return res 
```

但问题是它`getLines()`总是返回代码的前 100 行。

我见过一些带有`next()`or`tell()`和的解决方案`seek()`，但似乎这些功能没有在 HTTPResponse 类中实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:17:29.507

根据[文档](http://docs.python.org/library/urllib.html) `urllib.request.urlopen(uri)`返回一个类似对象的文件，所以你应该能够做到：

```
from itertools import islice

def getLines(self)
    res = []
    for line in islice(self.code,100): 
        res.append(line)
    return res 
```

`islice`在[itertools 文档](http://docs.python.org/library/itertools.html#itertools.islice)中有更多信息。使用迭代器将避免`while`循环和手动增量。

如果您绝对必须使用`readline()`，建议使用`for`循环，即

```
for i in xrange(100): 
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:20:58.577

这对我有用。

```
#!/usr/bin/env python

import urllib

def getLines(code):
    res = []
    i = 0

    while i < 100:
        res.append(str(code.readline()))
        i+=1

    return res

uri='http://www.google.com/'
code = urllib.urlopen(uri)

#Get 100 first lines
lines = getLines(code)

print lines

#Get 100 next lines
lines = getLines(code)

print lines 
```

# python - 为什么当客户端愉快地发送 TCP 数据包时，它们总是无法到达服务器？

> ID：10249677
> 
> 赞同：6
> 
> 时间：2012-04-20T16:07:50.987
> 
> 标签：python, c, sockets, tcp, tcpdump

我设置了一个简单的客户端服务器，似乎我从客户端发送的 TCP 数据包没有到达服务器。

通常一切正常，但是当我在客户端上启动 50 个线程以使用相同的小数据包（只有 39 个字节）“同时”访问服务器时，服务器没有收到所有字节的随机次数。更奇怪的是，它不接收它们的方式非常一致……只接收到 5 个字节。

我正在使用[tcpdump](http://www.tcpdump.org/)和[tcpflow](https://github.com/simsong/tcpflow/wiki/tcpflow-%E2%80%94-A-tcp-ip-session-reassembler)来捕获两端发生的事情（*如果不熟悉 tcp 流，它会从 TCP 流中消除大量的 TCP SYN/ACK/FIN/etc 噪声，并且只显示发送的数据任一方向）*。

在客户端，对于 50 个线程触发 39 字节数据包，它看起来很完美。具体来说，tcpflow（使用 libpcap）向我展示了 50 个相同的数据传输：

```
07 B6 00 01 | 00 1E 00 00 | <etc> 
```

据我了解，libpcap/tcpdump 从相当低的级别（低于 TCP 堆栈）获取数据，所以我认为这意味着数据发送正常，或者至少没有卡在内核缓冲区中。

但是，在查看服务器端时，一切都不是完美的。随机数失败，而且百分比很高。例如，在 50 个套接字连接中，有 30 个可以正常工作，但是对于其中的 20 个，我遇到了协议故障，服务器`socket.recv`超时等待字节（协议指示确切的数据包长度）。

它的失败方式**非常**一致。对于 30/20 的情况，30 个套接字完全接收传输的 39 个字节。剩下的 20 人都收到了这部分数据，之后我的`socket.recv`超时：

```
07 B6 00 01 | 00 
```

20 个连接中的每一个只有 5 个字节到达，而且它似乎在内核级别，因为 tcpdump 也只显示 5 个字节到达。

这怎么可能发生？

这个 5 字节的边界并不是 100% 的巧合。它是报头的第一部分，接下来是 34 字节的有效负载，但没有到达。在客户端，它是这样拆分的。

```
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((HOST, PORT))
sock.sendall(HEADER)  # 5 bytes
sock.sendall(PAYLOAD) #34 bytes 
```

并且两个`sock.sendall`调用在每个线程中都成功完成，正如我的 tcp 日志记录所证明的那样，所有 50 次运行都完美地“发送”了 39 个字节。

关于这个根本原因的任何想法？我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T16:21:20.110

回答我自己的问题...

简短的回答是，仅使用 TCP，客户端无法知道预期的接收者是否实际收到了发送的字节。

即：客户端是否“愉快地”发送字节无关紧要......即使使用TCP，它们也可能*永远不会*到达，而且您绝对不知道它们*何时*会到达预期的接收者。无论如何，如果没有在应用程序层中构建一些确认，就不是这样了。

对于我的特殊情况，事实证明客户端发送的字节 DID 实际上到达了服务器，但需要大约 30 秒（!!!）才能到达，此时客户端和服务器应用程序协议代码都已超时。

客户端和服务器端日志的视图（对于一个失败的连接）在这里：

*   [客户端 TCP 日志](http://static.inky.ws/image/1826/4f91b8a3733a8/image.jpg)
*   [服务器端 TCP 日志](http://static.inky.ws/image/1825/4f91b8a3733a8/image.jpg)

这些图像是来自[tcpdump](http://www.tcpdump.org/)捕获文件的一个特定 TCP 流的[Wireshark视图。](http://www.wireshark.org/)您可以看到发生了很多重新传输。推动这些重新传输需求的根本原因是什么？我完全不知道（但很想知道！）。

数据在最后一个条目 (#974) 中到达服务器，大约在发送后 30 秒，中间有大量的重传尝试。如果对服务器端 #793 感到好奇，这是我的应用层协议尝试向客户端发送一条消息，说“等待更多数据超时......它在哪里？”。

除了固有的延迟之外，数据没有出现在`tcpdump`服务器日志中的原因之一似乎也是我使用`tcpdump`. 简而言之：确保`tcpdump`在查看捕获文件（使用`-w`开关创建的文件）之前按 Ctrl-C 退出捕获，因为它似乎对您在文件中看到的内容产生了很大的影响。我希望这是一个刷新/同步问题，但我在猜测。但是，如果没有 Ctrl-C，我肯定会丢失数据。

**更多细节以供将来参考...**

尽管您经常读到/听说 TCP 会：

1.  保证您的数据包将到达（与[UDP](http://en.wikipedia.org/wiki/User_Datagram_Protocol)相比，它不会）
2.  保证您的包裹按顺序到达

很明显/很明显，第一个实际上根本不是真的。TCP 将尽最大努力将您的字节发送给预期的接收者（包括重试很长时间），但这并不能保证，无论[发送手册页](http://linux.die.net/man/2/send)是否指示`send`返回值“成功时，这些调用返回发送的字符数”。后者是*不*正确的并且具有高度误导性（见下文）。

其根源主要来自各种套接字调用（`send`特别是）的行为方式以及它们如何与操作系统的 TCP/IP 堆栈交互......

在 TCP 交换的发送端，进程非常简单。先是你`connect()`，然后是你`send()`。

`connect()`成功返回肯定意味着您能够建立与服务器的连接，因此您至少知道此时服务器在那里并且正在侦听（即：3部分TCP打开握手成功）。

对于“发送”，尽管调用的文档表明返回值（如果为正）是“发送的 [字节] 数”，但这完全是错误的。返回值告诉您的只是底层操作系统中的 TCP 堆栈接受到其传出缓冲区的字节数。在此之后，操作系统将尽最大努力将这些字节传递给您最初与之建立连接的接收者。但这*可能永远不会发生*，所以它*不会*意味着您可以指望那些正在发送的字节！有点令人惊讶的是，即使 TCP 内置了 ACK 消息，也没有真正的方法来确定这是否发生（或没有发生！），至少在 TCP 套接字层。要验证是否完全收到您发送的字节，您需要在应用层添加某种确认。nos在另一个关于这个问题的问题中有[一个很好的答案。](https://stackoverflow.com/a/4899773/465838)

**附录...**

我在这里留下的一个有趣的困境是我是否需要在我的应用层协议中构建一些重试功能。目前看来，如果在服务器上等待数据超时，关闭连接并打开一个具有相同请求的新连接将是有益的。看起来是这样的，因为低级别的 TCP 重试不成功，但同时还有其他客户端线程及时通过。但是，这感觉非常错误……您会认为 TCP 重试就足够了。但他们不是。我需要调查 TCP 问题的根本原因来解决这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T16:48:03.127

您发送的字节数非常少，因此您可能会违反[Nagle 算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)，该算法将保留您希望发送的数据，直到已缓冲大量数据并准备好传输。

创建套接字后，在发送任何数据之前尝试添加以下行：

```
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, True) 
```

但请注意，这样做会带来更多的通信开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:01:45.610

您必须非常小心，因为（由于缓冲） send 和 recv 可能不会发送或接收与您预期“应该”可用的数据一样多的数据。您还必须非常小心，任何线程都可以随时阻塞，即使它“应该”能够接收到您认为发送的尽可能多的数据。

# javascript - 在多个页面上显示导航栏

> ID：10249681
> 
> 赞同：0
> 
> 时间：2012-04-20T16:08:04.860
> 
> 标签：javascript, jquery, menu

我有一个子菜单，我只想在父子页面或父子页面处于活动状态时显示。我希望我的脚本可以使用多个 URL。

我为单页工作的代码是：

```
var myurl = "http://localhost/wordpress/?page_id=36"; 
var currenturl = window.location; 
if(myurl != currenturl) { 
    $(document).ready(function() {
        $('#main_nav ul.sub-menu').css({display: "none"}); 
    });
} 
```

我再次尝试使用具有不同变量名称的代码来获取其他 URL，但没有运气。我似乎无法找到如何创建 URL 数组，或者我什至无法做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:17:43.573

下面应该做你想要的：

```
$(document).ready(function() {
    var urls = ["/wordpress/?page_id=36", "/wordpress/?page_id=37"];
    var currenturl = window.location.pathname + window.location.search;
    if($.inArray(currenturl, urls) == -1) { 
        $('#main_nav ul.sub-menu').hide();
    }​
}); 
```

如您所见，我已将`http://localhost/wordpress/?page_id=37`您要在其上显示子导航的第二个 URL 用作示例。

# ruby - ruby：websocket 服务器和 websocket 客户端无法工作

> ID：10249683
> 
> 赞同：1
> 
> 时间：2012-04-20T16:08:09.307
> 
> 标签：ruby, websocket

我是一个真正的新手。但是，我无法弄清楚这个问题有什么问题。

我刚刚从网上某处复制了有关 ruby​​ websocket 服务器和 ruby​​ websocket 客户端实现的信息。我还在我的 windows xp 上安装了 ruby​​ 1.93。一切看起来都很好，但 websocket 客户端并不能很好地工作。

服务器端代码：

```
equire 'em-websocket'

EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 8080) do |ws|
  ws.onopen    { ws.send "Hello Client!"}
  ws.onmessage { |msg| ws.send "Pong: #{msg}" }
  ws.onclose   { puts "WebSocket closed" }
end 
```

客户端代码：

```
require 'eventmachine'
require 'em-http-request'

EventMachine.run {
  http = EventMachine::HttpRequest.new("ws://localhost:8080").get :timeout => 0
  http.errback { puts "oops" }
  http.callback {
      puts "WebSocket connected!"
      http.send("Hello client")
  }

  http.stream { |msg|
      puts "Recieved: #{msg}"
      http.send "Pong: #{msg}"
  }
} 
```

客户端总是发出“oops”。这意味着发生了错误。

有人可以给我任何线索吗？我很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T23:23:45.047

实际上，深入挖掘代码是可以的，问题是最新版本的依赖项发生了变化。修复步骤：

卸载当前的 gem

```
 gem uninstall em-http-request --version="1.0.2"  
 gem uninstall em-socksify --version "=0.2.0"     1.0.0.beta.4
 gem uninstall eventmachine --version "=1.0.0.beta.4" 
```

然后安装这些 gem

```
 gem install em-http-request --version "=0.3"
 gem install em-socksify --version "=0.1"
 gem install eventmachine --version "0.12.10" 
```

事情应该会奏效。如果这是针对某种类型的严肃项目，而不是学习，您将需要调查哪些更改正在破坏 websocket 客户端-服务器。

注意：这对我在 Ubuntu 上使用 Ruby 1.9.2 有效，它应该对你有效，但又可能不行。

# c# - 结合 IIS 7.5 的动态语言运行时中的错误

> ID：10249684
> 
> 赞同：4
> 
> 时间：2012-04-20T16:08:15.547
> 
> 标签：c#, dynamic, iis-7.5, dynamic-language-runtime, transparentproxy

我为这个问题的长度道歉，但我认为你们都会觉得值得。在我开始之前，让我说我*真的*在尝试制作一个独立的控制台应用程序，但遗憾的是这被证明是不可能的。该错误不会发生在控制台应用程序中。它不会发生在自包含的 ASP.NET 应用程序中。它仅在 Windows 7 上的 IIS 7.5 中运行时发生。

该错误似乎与动态语言运行时有关，因为它涉及`__TransparentProxy`（通过 WCF）和`dynamic`变量（int）的组合。产生问题的那一行是调用一个静态方法（恰好不包含方法体），同时传入代理和动态 int。

一旦调用该方法，w3wp.exe 进程就会占用整个 CPU 并开始非常迅速地增加内存（对我来说大约每秒 100 兆，尽管它可能由于 GC'ing 而逐渐减少）。

要重现此错误，请在 Visual Studio 中创建一个新的 ASP.NET 网站（“新建”|“项目”“C#”|“Web”|“ASP.NET Web 应用程序”）。然后在 IIS 中创建一个新站点，其主目录是您的新项目。（另外，授予“Everyone”对该文件夹的完全读/写权限，并确保应用程序池使用 .NET 4.0）为新站点提供特定端口，例如 7080。最后，将此代码粘贴到 Global.asax.cs 中：

```
public class Global : System.Web.HttpApplication
{
    void Application_Start(object sender, EventArgs e)
    {
        dynamic dynamicId = 5;

        var serviceUrl = "http://localhost:7182/FooServices.svc";
        ChannelFactory factory = new ChannelFactory<IFooServices>(new WSHttpBinding(), new EndpointAddress(serviceUrl));
        factory.Open();
        IFooServices fooServices = ((ChannelFactory<IFooServices>)factory).CreateChannel();

        BlowUpTheProgram(fooServices, dynamicId);  // This line hangs
    }

    [ServiceContract]
    public interface IFooServices
    {
        [OperationContract]
        void Bar();
    }

    public static void BlowUpTheProgram(IFooServices eventServices, int authorMailboxId)
    {
    }
} 
```

`http://localhost:7080`现在通过（或您选择的任何端口）在浏览器中访问该站点。准备好任务管理器，因为在确认报告的症状后，您需要终止 w3wp.exe 进程。

要确认代理和动态正在协同工作以显示此错误，请更改此行：

```
dynamic dynamicId = 5; 
```

到：

```
int dynamicId = 5; 
```

重试，您会发现问题已经消失并且页面已加载。现在将其更改回`dynamic`然后更改此行：

```
IFooServices fooServices = ((ChannelFactory<IFooServices>)factory).CreateChannel(); 
```

到：

```
IFooServices fooServices = null; 
```

重试，你会再次注意到在这种情况下问题也消失了。

最后，如果我附加调试器并全部中断，我可以看到它在卡在这个方法调用中时在做什么。它似乎总是显示类似：

> mscorlib.dll!System.RuntimeMethodHandle.GetDeclaringType(System.IRuntimeMethodInfo 方法) + 0x2f 字节
> mscorlib.dll!System.Reflection.Emit.DynamicResolver.ParentToken(int token) + 0x1f3 字节
> [本机到托管转换]
> [托管到本机转换]
> mscorlib.dll!System.Reflection.Emit.DynamicMethod.CreateDelegate(System.Type delegateType, object target) + 0x29 字节
> System.Core.dll!System.Linq.Expressions.Expression>.Compile() + 0xbb 字节
> System.Core。 dll!System.Runtime.CompilerServices.CallSiteBinder.BindCore>(System.Runtime.CompilerServices.CallSite> site, object[] args) + 0x10a 字节
> System.Core.dll!System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid3（System.Runtime.CompilerServices.CallSite 站点 = {System.Runtime.CompilerServices.CallSite>}，WebApplication1.Global arg0 = {ASP.global_asax}，WebApplication1.Global.IFooServices arg1 = {System.Runtime.Remoting.Proxies.__TransparentProxy}，对象 arg2 = 5) + 0x3f0 字节
> WebApplication1.dll!WebApplication1.Global.Application_Start(object sender = {System.Web.HttpApplicationFactory}，System.EventArgs e = {System .EventArgs}) 第 19 行 + 0x1b8 字节 C#

作为记录，我已经在三台不同的机器上进行了尝试，并且只能在 Windows7/IIS7.5 机器上进行复制。在 Windows Server 2008 / IIS7 盒子上没有问题。

问题是，我该如何解决这个问题并成功调用该方法？另外，为什么会这样？我不想在调用将使用 DLR 的东西时过于小心，因为它会使 IIS 崩溃。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:22:31.290

我无法回答为什么会发生这种情况，但是在传递参数时将`dynamic`对象转换为有效。`int`

```
DontBlowUpTheProgram(fooServices, (int)dynamicId); 
```

也许对内部知识更了解的人会介入并进行更全面的解释。

# php - 将 Javascript 函数转换为 PHP 函数

> ID：10249687
> 
> 赞同：8
> 
> 时间：2012-04-20T16:08:17.150
> 
> 标签：php, javascript

我是 PHP 新手，我正在尝试将一个简单的 Javascript 函数转换为 PHP 函数。到目前为止，我知道只转换变量，我需要排序函数和数组过滤器的帮助。谢谢你的帮助！

```
var closeRoll = function( number ) {
  var rollArray = [36, 48, 60, 72];
  var closest = rollArray.filter(function(ele){
    return ele - number >= 0
  }).sort()[0];
  return closest;   
}; 
```

我的一半转换：

```
function closeRoll( $number ) { 
  $rollArray = Array(36, 48, 60, 72);
  $closest = array_filter( $rollArray, function temp( $rollArray ) {
    return $rollArray - $number >= 0;
  }); //.sort()[0];
  return $closest;   
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:21:39.903

你非常接近，PHP 中的变量范围有点不同：

```
function closeRoll( $number ) { 
    $rollArray = Array(36, 48, 60, 72);
    $closest = array_filter( $rollArray, function($rollArray) use ($number) {
        return $rollArray - $number >= 0;
    }); //.sort()[0];
    return $closest;   
} 
```

基本上不同的是`use ($number)`，您不需要命名 temp 函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:28:26.990

作用域不像 JavaScript 那样工作。您不能简单地`$number`在回调函数内部引用，因为它没有范围链。

您要么必须使其成为全球性的（不推荐，但很简单）：

```
<?php
function doFilter($element) { // this could still be anonymous, but doesn't have to be
   return $element - $GLOBALS['number'] >= 0;
}

function closeRoll( $number ) { 
   $GLOBALS['number'] = $number;
   $rollArray = Array(36, 48, 60, 72);
   $closest = array_filter( $rollArray, 'doFilter' );
   return $closest;   
};
?> 
```

或者您可以使用`use`运算符（一个优雅的解决方案）：

```
<?php

function closeRoll( $number ) { 
   $rollArray = Array(36, 48, 60, 72);
   $closest = array_filter( $rollArray, function( $element ) use ($number) {
     return $element - $number >= 0;
   });
   return $closest;   
};

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:27:40.563

试试这个

```
function closeRoll($number) {
    $rollArray = array(36, 48, 60, 72);
    $closest = array_filter($rollArray, function ($rollArray) use ($number) { return $rollArray - $number >= 0; });

    if (!empty($closest))
    {
        sort($closest);
        return array_shift($closest);
    }
    return null;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:43:19.650

因此，如果我正确理解 JavaScript，该函数会返回`rollArray`大于给定`number`参数的最接近匹配值吗？

这是我的解决方案：

```
function closeRoll($number) {
    $rollArray = array(36, 48, 60, 72);

    $rollArray = array_filter(
        $rollArray,
        function($value) use ($number) {
            return $value - $number >= 0;
        }   
    );  

    return reset(sort($rollArray));
} 
```

[使用array_filter()](http://php.net/array_filter)时，您走在正确的道路上。然而，当给它一个匿名函数作为回调时，你会遇到第一个 JavaScript 与 PHP 的问题——范围。

在 PHP 中，函数不会自动共享定义它们的范围。如果您需要使用当前范围内的某些内容，则需要使用 use 关键字随身携带。

最后我使用[reset()](http://php.net/reset)来提取排序数组的第一个值，它应该是最接近的匹配值。您不能使用`$rollArray[0]`，因为 array_filter() 保留键，因此`0`可能不再存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T16:46:18.570

这是优化搜索的示例，不是直接的，而是使用您的大脑... :)

```
<?php

function find($number, array $a)
{
    $len = count($a);

    if ($len == 0)
    {
        return null;
    }
    elseif ($len == 1)
    {
        return array_shift($a);
    }

    sort($a, SORT_NUMERIC);

    $first  = array_slice($a, 0, (int) ($len / 2));
    $second = array_slice($a, (int) ($len / 2));

    // No need to check on isset because of if ($len == 0) elseif ($len == 1) 
    if ($second[0] == $number)
    {
        return $number;
    }

    $index = count($first) - 1;    
    if ($first[$index] == $number)
    {
        return $number;
    }

    return abs($number - $first[$index]) <= abs($number - $second[0]) ? find($number, $first) : find($number, $second);
}

$a = array(10, 99, 51, 201, 999, 500, 555, 618);
$n = 75;

echo find($n, $a);

?> 
```

# android - SDK 丢失了我定义 AVD 的位置

> ID：10249697
> 
> 赞同：0
> 
> 时间：2012-04-20T16:09:24.660
> 
> 标签：android, emulation

我安装了最新的 SDK，但大约在同一时间，我还在不同的位置安装了不同版本的 SDK 的单独实例（我不知道它是什么版本）。我不知道后一个事实是否相关。

为方便起见，我定义了一个 ANDROID_SDK_HOME 环境变量，它指向我安装 SDK 的位置。我将其中的工具和平台工具添加到我的 PATH 中。

在某些时候，我运行了 SDK 管理器并安装或更新了几个包，包括平台工具（我显然在上一步之前这样做了）。

我运行了 AVD 管理器并为 ICS 创建了一个 AVD。我运行了几次 AVD 并运行了一些简单的测试。

那是昨天。今天，当我尝试使用该 AVD 运行模拟器时，它说：

> 恐慌：无法打开：“android sdk 的路径”.android/avd/“我的 avd 名称”.ini

这很奇怪，因为我定义 AVD 的“.android”目录在我的 Windows HOME 中。

然后我运行了 AVD 管理器，毫不奇怪，它说我在“android sdk 的路径”.android/avd 中没有任何 AVD，而不是在我的 Windows HOME 中引用“.android/avd”。

我不确定这里发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-26T18:39:18.130

我遇到了这个问题，必须设置 AVD 主页的完整路径，如`D:\Android\sdk\.android\avd`. 该错误看起来好像只需设置 sdk 目录或 Windows 主目录就足够了，但在我将 AVD 主目录设置为包含`.android\avd`路径之前，我遇到了类似的错误。

我将 AVD 存储在 Windows 主目录之外的示例：

```
ANDROID_AVD_HOME=D:\Android\sdk\.android\avd
ANDROID_SDK_HOME=D:\Android\sdk 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:57:06.750

`ANDROID_SDK_HOME`至少在 Windows 上可以用作环境变量，指向您的 SDK*数据*所在的位置。这充其量是没有记录的。

因此，一旦守护进程发现环境变量更改（例如，重新启动），让它指向您的 SDK*安装将导致混乱。*`adb`

要么没有`ANDROID_SDK_HOME`（选择`.android`目录的默认位置），要么确保它指向 Android 可以找到您的`.android`目录的位置。

# scala - 在scala中实现隐含逻辑运算符

> ID：10249699
> 
> 赞同：4
> 
> 时间：2012-04-20T16:09:27.773
> 
> 标签：scala, operators

我想知道是否有可能在 scala 中实现逻辑含义。例如：

```
a implies b 
```

翻译成：

```
!a || b 
```

where`a`和`b`是一些计算结果为 的表达式`Boolean`。

我最初是从以下开始的，但这是错误的方法

```
 implicit def extendedBoolean(a : Boolean) = new {
    def implies(b : Boolean) = {
      !a || b
    }
  } 
```

因为它将`a`同时`b`评估`a`. 正确的解决方案只会评估`b`何时`a`为真。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:15:46.387

您想使用按名称调用的参数，我相信以下内容就足够了：

```
implicit def extendedBoolean(a : Boolean) = new {
    def implies(b : => Boolean) = {
      !a || b
    }
  } 
```

解释：

您必须在 for 中传递一些值，`b`但您不希望评估该表达式；Scala 可以自动将表达式转换为不带参数并计算表达式的函数。`implies`然后，如果需要，您的操作员会评估该空值（零参数）函数。

由于您提供的类型签名，编译器知道它可以执行此转换，`=> Boolean`. 这篇[文章](http://www.scala-lang.org/node/138)更详细地解释了，但仅它的标题就很好地概括了正在发生的事情：[“Automatic Type-Dependent Closure Construction”](http://www.scala-lang.org/node/138)。

Scala 的这一特性使人们能够编写控制结构，可能就像使用其他语言中的宏来编写它们一样容易。观察他们使用两个按名称调用的参数重新实现 while 循环的难易程度：一个用于条件，一个用于主体。

```
object TargetTest2 extends Application {
  //type signature not too terribly mysterious
  def whileLoop(cond: => Boolean)(body: => Unit): Unit =
    if (cond) {
      body
      whileLoop(cond)(body)
    }

  //about as easy to use as a plain-old while() loop
  var i = 10
  whileLoop (i > 0) {
    println(i)
    i -= 1
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T16:13:48.293

您想要创建`b`一个必须评估的函数。这样，只有在实际访问时才会对其进行评估。

您可以通过将其类型更改为 来做到这一点`=> Boolean`，这意味着`Boolean`无需任何输入即可评估为 a 的东西。

```
implicit def extendedBoolean(a: Boolean) = new {
  def implies(b: => Boolean) = {
    !a || b
  }
} 
```

以下是如何使用它：

```
scala> true implies { println("evaluated"); true }
evaluated
res0: Boolean = true

scala> false implies { println("evaluated"); true }
res1: Boolean = true 
```

请注意，当is`a`被评估时（打印“已评估”）。但是当is时，它不会被评估（没有打印）。`true``b``a``false`

# c# - 寻找一种方法来建立一个完整的注册/登录系统，每个用户都有自己的信息

> ID：10249703
> 
> 赞同：0
> 
> 时间：2012-04-20T16:09:34.713
> 
> 标签：c#, asp.net, sql

*   我正在使用 asp.net 4 。

我的目的是为用户创建一个登录/注册页面。

*   但是有一点我需要注意：每个注册用户在登录后都应该有自己的网格视图，并在其页面上显示自己的信息

到目前为止，这是我的想法：

*   制作一个注册页面，在“提交”按钮上创建帐户，它将创建一个包含用户名和所需列的新表。

*   在登录页面上，我想是这样的：在用户登录重定向到一般页面并在 sqldatasource 中获取记录的用户名表并将其绑定到 gridview。

这是一个好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:03:59.777

假设您知道如何保存和加载数据，我只会为您提供流程好吧，我要做的是制作两个表，一个用于用户信息，第二个用于用户权限，现在当您注册用户时，您不使用网格，但带有文本框和提交按钮现在在管理页面中保存逻辑，您显示一个网格并让管理员查看网格中的所有用户并使用编辑，非活动等逻辑希望你觉得它有用

# javascript - balance.init() 上的 JS 错误

> ID：10249710
> 
> 赞同：3
> 
> 时间：2012-04-20T16:10:11.447
> 
> 标签：javascript, balanced-payments

1.  未捕获的类型错误：无法使用“in”运算符在未定义中搜索“调试”
2.  a.balanced.initbalanced.js:1 [https://js.balancedpayments.com/v1/balanced.js](https://js.balancedpayments.com/v1/balanced.js)
3.  （匿名函数）

    ```
    <script type="text/javascript" src=" https://js.balancedpayments.com/v1/balanced.js"></script>
    <script>
    //balanced.init('/v1/marketplaces/TEST-MP798-194-2357');
    //balanced.init('/marketplaces/TEST-MP798-194-2357');
    balanced.init('TEST-MP798-194-2357');
    </script> 
    ```

在每个不同的调用上得到相同的错误。我的 URI 不正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:02:46.803

这是我们这边的一个文档错误。应该有第二个可选参数，但现在它是必需的。

就像你已经想通了，

```
balanced.init('YOUR-MARKETPLACE-URI', {}); // works
balanced.init('YOUR-MARKETPLACE-URI', {'debug': true}); // turns on debugging 
```

希望这可以帮助。

# ruby-on-rails - HAML - 如何在链接之间放置常规文本

> ID：10249712
> 
> 赞同：2
> 
> 时间：2012-04-20T16:10:13.037
> 
> 标签：ruby-on-rails, haml

我有一个小的 HAML 段落，其中包含如下链接：

```
%p
  =link_to("My Disclosures", "#")
  =link_to("Create Disclosure", "#")
  =link_to("My Programs", "#") 
  =link_to("Log Out", "#") 
```

我想要做的是放置一个像这样的分隔符“|” 链接之间，但我不知道如何。我尝试将它放在“”内的文本旁边，但它成为链接文本的一部分。当我尝试将分隔符放在行尾时，它只是没有出现。

知道如何让连字符在链接后仅呈现为文本吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:12:29.763

您可以将字符串本身写在自己的行上：

```
%p
  =link_to("My Disclosures", "#")
  |
  =link_to("Create Disclosure", "#")
  |
  =link_to("My Programs", "#") 
  |
  =link_to("Log Out", "#") 
```

或者，您可以将其附加到输出字符串：

```
%p
  =link_to("My Disclosures", "#") << '|'
  =link_to("Create Disclosure", "#") << '|'
  =link_to("My Programs", "#") << '|'
  =link_to("Log Out", "#") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T17:18:52.320

我有同样的问题。这就是我解决它的方法：

1）在模块ApplicationHelper中：

```
def links_bar(join_with = ' | ', &block)
  capture{yield}.split("\n").join(join_with).html_safe
end 
```

2) 在任何方面：

```
= links_bar do
  = link_to("My Disclosures", "#")
  = link_to("Create Disclosure", "#")
  = link_to("My Programs", "#") 
  = link_to("Log Out", "#") 
```

生成：

```
<a href="#">My Disclosures</a> | <a href="#">Create Disclosure</a> | <a href="#">My Programs</a> | <a href="#">Log Out</a> 
```

我疯了吗？;)

感谢 Semyon Perepelitsa 的提示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:12:56.933

在这种情况下，您以错误的方式处理事情。

获得您想要的效果的更正确的方法是使用一点 CSS：

```
ul.nav {
  list-style:none;
  margin:0;
  padding:0
}

ul.nav li {
  margin:0;
  padding:0 0.5em;
  border-right:1px solid black
}

ul.nav li.last {
  border-right:none;
}

%ul.nav
  %li=link_to("My Disclosures", "#")
  %li=link_to("Create Disclosure", "#")
  %li=link_to("My Programs", "#") 
  %li.last=link_to("Log Out", "#") 
```

这样你就有了一个简单的、语义正确的、可访问的和搜索引擎友好的链接列表，它使用 CSS 的魔力转换为样式列表。

我知道我正在回答与您提出的问题不同的问题，但您应该知道解决此用例的“正确”方法。

# c# - 如何通过 TFS API 获取最新的变更集编号

> ID：10249714
> 
> 赞同：7
> 
> 时间：2012-04-20T16:10:13.553
> 
> 标签：c#, api, tfs

如何通过 TFS API 获取最新的变更集编号？你能给我举个例子吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T19:58:11.667

干得好：

```
TeamProjectPicker tpp = new TeamProjectPicker(TeamProjectPickerMode.SingleProject, true);
tpp.ShowDialog();

var tpc = tpp.SelectedTeamProjectCollection;

VersionControlServer versionControl = tpc.GetService<VersionControlServer>();

var tp = versionControl.GetTeamProject("MyTeamProject");
var path = tp.ServerItem;

var q = versionControl.QueryHistory(path, VersionSpec.Latest, 0, RecursionType.Full, null, VersionSpec.Latest, VersionSpec.Latest, Int32.MaxValue, true, true, false, false);

Changeset latest = q.Cast<Changeset>().First();

// The number of the changeset
int id = latest.ChangesetId; 
```

QueryHistory 是使用 TeamProject 的 VersionControl 中的路径调用的，我们想要从最新到最新变更集的历史记录，在您的情况下，剩下的所有参数都是默认的。

# vb.net - 这段 SQL 代码是否应该让我们使用“用户名”和“密码”登录？

> ID：10249716
> 
> 赞同：0
> 
> 时间：2012-04-20T16:10:25.767
> 
> 标签：vb.net, sqlite, legacy

我们正在尝试调试一些遗留代码。我们发现我们可以使用所有用户的密码“password”登录系统。我们还可以使用用户名“username”和密码“password”登录，也可以使用用户名“username”和系统中某个用户的密码登录。

这使我们认为 SQL 查询可能存在问题，该查询可能与登录表单中的用户名字段匹配列“用户名”或“用户名”字符串。（与密码相同）。

然而，不幸的是，我们不是 VB.net 的人，无论我们做什么，这种行为似乎都是一样的。这是原始代码：

```
SQLcommand.CommandText = "SELECT level FROM tblUsers WHERE username = """ & username & """ AND password = """ & password & """"
SQLreader = SQLcommand.ExecuteReader() 
```

（我们不确定所有的`"""`s 是关于什么的）

因此，使用我们对编程和 SQL 的了解，我们做到了：

```
SQLcommand.CommandText = "SELECT level FROM tblUsers WHERE `username` = """ & username & """ AND `password` = """ & password & """"
SQLreader = SQLcommand.ExecuteReader() 
```

同样没有效果：

```
SQLcommand.CommandText = "SELECT level FROM tblUsers WHERE tblUsers.username = """ & username & """ AND tblUsers.password = """ & password & """"
SQLreader = SQLcommand.ExecuteReader() 
```

那也没有效果。

所以问题是这是 SQL 代码的问题吗？还是我们找错地方了？我认为我们没有找错地方。虽然我们不是 VB.net 的人，但我们仍然非常精通编程。还输出（跟踪）以“用户名”和“密码”作为用户名和密码的查询`SQLreader(0)`返回`1`，这意味着它正在匹配某些东西。

任何帮助都会很棒。有什么我们忽略的吗？

谢谢

（免责声明：此代码不在生产环境中的任何地方使用。大家现在可以放松了！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:50:08.150

如果我没看错的话，这里有几个问题。

假设您在这里连接到 Microsoft SQL Server（因为您使用的是 SQLCommand），您在用户名和密码变量周围加上双引号，从而表示您正在将列用户名与列进行比较（无论是在变量中）。假设用户名中有“john”，密码中有“1234”。您的 sql 语句如下所示：

```
SELECT level FROM tblUsers WHERE username = "john" and password = "1234" 
```

双引号意味着其中的任何文本都是列的名称，因此 SQL 正在查找名为 john 和 1234 的列。您应该使用单引号/撇号。

```
SELECT level FROM tblUsers WHERE username = 'john' and password = '1234' 
```

如果您使用用户名“username”和密码“password”，您实际上只是从用户表中选择级别，其中用户名列 = 用户名列，密码列 = 密码列。（：

无论如何，除此之外，将变量直接粘贴到您的 SQL 查询中会使您的查询对 SQL 注入开放，因此最好使用参数。

```
SQLcommand.CommandText = "SELECT level FROM tblUsers WHERE username = @username AND password = @password"
SQLcommand.Parameters.AddWithValue("@username",username)
SQLcommand.Parameters.AddWithValue("@password",password)
SQLreader = SQLcommand.ExecuteReader() 
```

试一试。

# java - DefaultTableModel 为空？

> ID：10249718
> 
> 赞同：0
> 
> 时间：2012-04-20T16:10:32.073
> 
> 标签：java, swing, vector, jtable, defaulttablemodel

我正在读取一个文件并希望将其输出到 jTable 以进行查看和编辑。当我尝试向 DefaultTableModel 添加行时，由于某种原因，模型始终为空。任何帮助/方向将不胜感激。谢谢！

```
public class ReadFileGUI extends javax.swing.JFrame {

public static String file;
private DefaultTableModel model = new DefaultTableModel();

public ReadFileGUI() {
    initComponents();
}

 @SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    jButton1 = new javax.swing.JButton();
    jScrollPane1 = new javax.swing.JScrollPane();
    jTable1 = new javax.swing.JTable(model);

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    jButton1.setText("Test");
    jButton1.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            jButton1ActionPerformed(evt);
        }
    });

    jScrollPane1.setViewportView(jTable1);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(14, 14, 14)
                    .addComponent(jButton1)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGap(0, 0, Short.MAX_VALUE))
                .addGroup(layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 397, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
            .addContainerGap())
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 282, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jButton1))
            .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
    );

    pack();
}// </editor-fold>

private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {

        String line = "Hello~There~This~Is~A~Test";
        String datavalue[] = line.split("~");                            
        Vector v = new Vector(Arrays.asList(datavalue));

        model.addRow(v);                  
        jTable1.tableChanged(new TableModelEvent(model));   
}

public static void main(String args[]) {

    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(ReadFileGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(ReadFileGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(ReadFileGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(ReadFileGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            new ReadFileGUI().setVisible(true);
        }
    });
}    

private javax.swing.JButton jButton1;
private javax.swing.JScrollPane jScrollPane1;
private javax.swing.JTable jTable1; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:21:27.147

这是您的代码的更新版本，似乎可以工作

```
import javax.swing.event.TableModelEvent;
import javax.swing.table.DefaultTableModel;
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Arrays;
import java.util.Vector;

public class ReadFileGUI extends javax.swing.JFrame {
  private DefaultTableModel tableModel = new DefaultTableModel();
  private javax.swing.JButton populateTableButton;
  private javax.swing.JScrollPane tableScrollPane;
  private javax.swing.JTable table;

  public ReadFileGUI() {
    initComponents();
    setDefaultCloseOperation( javax.swing.WindowConstants.EXIT_ON_CLOSE);
  }

  @SuppressWarnings("unchecked")
  private void initComponents() {
    populateTableButton = new javax.swing.JButton();
    tableScrollPane = new javax.swing.JScrollPane();
    table = new javax.swing.JTable( tableModel );

    populateTableButton.setText( "Test" );
    populateTableButton.addActionListener( new ActionListener() {
      @Override
      public void actionPerformed( ActionEvent evt ) {
        populateTable();
      }
    } );

    tableScrollPane.setViewportView( table );

    getContentPane().setLayout( new BorderLayout(  ) );
    getContentPane().add( tableScrollPane, BorderLayout.CENTER );
    getContentPane().add( populateTableButton, BorderLayout.SOUTH );
    pack();
  }

  private void populateTable( ) {
    String line = "Hello~There~This~Is~A~Test";
    String dataValue[] = line.split("~");
    Vector<String> v = new Vector<>( Arrays.asList( dataValue ));
    tableModel.setColumnCount( v.size() );
    tableModel.addRow( v );
  }

  public static void main(String args[]) {
    java.awt.EventQueue.invokeLater(new Runnable() {
      @Override
      public void run() {
        new ReadFileGUI().setVisible(true);
      }
    });
  }         
} 
```

我改变的事情：

*   使用导入而不是全名来避免水平滚动条
*   使用 BorderLayout iso 生成的布局来缩短代码
*   重命名了一些变量以提高代码的可读性
*   删除了`jTable1.tableChanged(new TableModelEvent(model));`调用，因为当您使用该方法`DefaultTableModel`时将触发相应的事件。`addRow`无需再次向表指示此更改

但相关的变化是`tableModel.setColumnCount( v.size() );`电话。的默认构造函数`DefaultTableModel`创建一个具有零列和行的模型。如果先设置列数，可以使用`addRow`方法

# css - CSS3变换：如果父母有rotateY，则补偿孩子

> ID：10249721
> 
> 赞同：0
> 
> 时间：2012-04-20T16:10:53.427
> 
> 标签：css, transform, rotatetransform

[先看看这里](http://jsfiddle.net/QnakF/)

当 div#container 旋转“x”度时，其中的`<ul>`and 和 元素也将旋转。但我想把`<img>`里面的每个`<li>`人都面平。如果我将 Y 全部旋转`<li>`“-x”度，它就行不通了。

有没有办法实现并使所有图像都面向您，同时沿着旋转的 div#container 定位？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T18:58:10.153

您不需要属性`-webkit-perspective`和`webkit-transform-style`in `ul#looks`，因为父级已经定义了这些属性。

此外，删除这些透视和变换属性`ul#looks li`并添加：

```
ul#looks li {
    -webkit-transform: rotateY(-10deg);
} 
```

[jsfiddle 演示在这里](http://jsfiddle.net/ruisoftware/QnakF/1/)

您可以看到我注释掉了您需要删除的内容。

# animation - Cinema 4d如何在已经设置关键帧的情况下移动轴点

> ID：10249725
> 
> 赞同：0
> 
> 时间：2012-04-20T16:11:14.593
> 
> 标签：animation, 3d, point, cinema-4d

我在cinema 4d 中创建了一个动画，现在我想返回并更改我的一个对象的轴点。如果我移动它，然后点击返回，对象将移动到一个新位置（这部分是有道理的，因为该位置是相对的。我想知道这是移动轴点的某种方式，而不影响我的多边形的位置已经动画了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T07:52:14.363

当您为对象的位置设置动画时，您实际上是在为其轴点的位置设置动画，如果您移动轴点，它会根据您的动画返回到它应该具有的位置，因此，移动您的对象......你已经注意到了。

您可以创建一个空对象并将对象的关键帧复制并粘贴到它，然后将您的对象设置为空对象的子对象并从对象中删除关键帧。这样您就可以从 null 获取动画，并且可以安全地更改对象的轴点。

# c# - 针对树视图编写单元测试

> ID：10249726
> 
> 赞同：0
> 
> 时间：2012-04-20T16:11:23.487
> 
> 标签：c#, silverlight, unit-testing, tdd

我在silverlight应用程序的viewModel中有类似以下内容：

```
 public void OnSelectedItemChanged(TreeView treeView)
    {
        if (treeView.SelectedItem is Customer)
        {
            var customer = treeView.SelectedItem as Customer;

            if (customer.IsSpecial)
            {
                treeView.SelectItem(specialNode);
              ...
        }
    } 
```

没关系逻辑（仅用于演示）。该应用程序工作正常。我的问题与为此方法编写单元测试严格相关。我似乎无法创建一个测试工具来使用我可以成功执行 SelectedItem 或 SelectItem 之类的事情。换句话说，我需要在我的设置中做这样的事情。

```
 TreeView tv = new TreeView();
 var item = new TreeViewItem();

 tv.ItemsSource = new List<object> { item };
 tv.SelectItem(item); // does not work 
```

有什么方法可以测试这种方法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-20T16:20:01.053

单元测试通常用于测试单一功能的单个代码单元，主要用于确认业务逻辑。

有可用的基于 UI 的测试框架，您可能想研究一下。或者您可以使用自动化 UI 测试框架，例如 ROBOT。

话虽如此，如果您尝试对树视图进行单元测试，那么这可能表明模块化代码不正确，您应该能够在单独的函数中取出基于单元测试的代码并对该函数进行单元测试。如果那不可能，那么您很可能不需要单元测试。

# c - 如何在多个线程之间同步，以便在不使用互斥锁的情况下使它们的事务 ID 唯一？

> ID：10249727
> 
> 赞同：1
> 
> 时间：2012-04-12T20:31:39.643
> 
> 标签：c, multithreading

我正在用 C 编写一个应用程序，它需要多个线程从函数请求唯一的事务 ID，如下所示；

```
struct list{
  int id;
  struct list *next
};

function generate_id()
{
  linked-list is built here to hold 10 millions 
} 
```

如何在两个或多个线程之间同步，以便它们的事务 ID 在它们之间是唯一的，而不使用互斥锁，这可能吗？

即使我需要将链接列表更改为其他内容，也请分享任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T17:34:01.960

让我先猜猜你想做什么（如果我错了，请纠正我）：

从每个线程调用函数“generate_id”并操作全局计数器为每个链表节点分配唯一的 ID。

在这样做时，您显然需要相互排斥。除了互斥之外，它还可以通过使用“测试和测试和设置”或“比较和交换”等原子操作来实现。

# java - Java Swing 动态网格

> ID：10249729
> 
> 赞同：0
> 
> 时间：2012-04-20T16:11:35.657
> 
> 标签：java, swing, layout, icons, jbutton

我正在做一个基于摇摆的java游戏，其中玩家轮流在已经存在的那些旁边添加一个瓷砖，所以我需要一个特殊的gridLayout来让我构建一个动态网格。

磁贴是一个（图像）按钮；那么，起始棋子在位置 0,0，第一个玩家可以选择八种不同的移动，等等，有什么想法吗？GridBagConstraints 不接受负值，对吗？

我正在尝试没有布局，使用绝对坐标，我可以想到其他不那么原始的解决方案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:36:06.660

You might get some ideas from this [game](https://sites.google.com/site/drjohnbmatthews/buttons) that uses a `GridLayout` of `JToggleButton`. Each button uses its *selected* state to decide which Unicode glyph to show, but an `Icon` would work as well.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:14:38.770

只需使用由整数对键控的哈希表。

# javascript - OAuth Javascript：推特，通过默默无闻的安全？有更好的方法吗？

> ID：10249736
> 
> 赞同：1
> 
> 时间：2012-04-20T16:12:08.357
> 
> 标签：javascript, security, twitter, oauth, security-by-obscurity

## 背景

假设我想使用 twitter 的 javascript api。推特 javascript api 说

> 将 JavaScript 与 OAuth 一起使用时要小心。不要暴露你的钥匙[[1]](https://dev.twitter.com/docs/twitter-libraries#javascript)。

听起来使用带有 OAuth 的 javascript 是不安全的[[2]](http://blog.programmableweb.com/2010/08/31/oauth-only-twitter-what-it-means-for-javascript-apps/)。不是因为网络问题（可以使用 https），而是因为有权访问查看源的用户也可以查看用 javascript 硬编码的密钥。使用这些密钥，用户可以独立于您的应用程序控制您的 Twitter 帐户！

我见过的最好的方法是使用 YQL [[3]](http://derek.io/blog/2010/how-to-secure-oauth-in-javascript/)。但是如何在您自己的服务器上执行此操作。

**以下场景是安全的还是晦涩的？**

## 设想

我打算使用 twitter 的 javascript api 来控制对我的 twitter 帐户的访问。

为了解决允许用户查看源访问我的 api 凭据的问题，假设我通过一个面向公众的页面（例如 Post.php）汇集所有 twitter api 通信。为了防止*所有*用户访问此页面，我可以在 url 中要求一个 guid：Post.php?pass=91626979-FB5C-439A-BBA3-7715ED647504

服务器端应用程序将向该页面发出 http 请求，因为服务器上的唯一 guid 是已知的。

api 通信可以保留在 javascript 中，而对该 javascript 的访问是通过服务器已知的 guid 保护的。**http 请求是在服务器上发起的，**因此无法通过查看流量来查看请求。guid 不会包含在客户端的源中。客户端将向服务器函数发出请求，然后向 Post.php 发出服务器端 http 请求

这实质上会导致 Post.php 无法从浏览器访问。本质上，服务器将启动 javascript api 调用。

**这是安全的还是晦涩的？** 您有更好的方法（当然是通过 javascript）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:16:05.173

更新下面给出的解释：是的，没关系。您有一个服务器，客户端通过登录进行身份验证，服务器处理向 twitter 发布的内容。由于只有您受信任的服务器具有 twitter 凭据，因此客户端只能通过它。

工作正常。

# c# - 获取与文件关联的 TFS 服务器详细信息

> ID：10249745
> 
> 赞同：1
> 
> 时间：2012-04-20T16:12:39.720
> 
> 标签：c#, .net

我有一个受 TFS 源代码控制的文件。

如果我们拥有对该文件的完全访问权限，是否有任何方法可以获取相关的 TFS 详细信息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:09:26.253

您可以从文件进入工作区（请参阅此[答案](https://stackoverflow.com/a/628106/67392)）。一旦你有了它，因此服务器你可以很容易地`VersionControlServer`使用它的[`GetItem`](http://msdn.microsoft.com/en-us/library/bb138919.aspx)方法（使用服务器或客户端路径）获取一个实例，以获取一个[`Microsoft.TeamFoundation.VersionControl.Client.Item`](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.item.aspx)包含文件或文件夹的所有 TFS 详细信息的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:26:08.520

TFS 有一个强大的 API 可用。[这是](http://msdn.microsoft.com/en-us/library/bb130331.aspx#versioncontrolserver)一个使用它的示例，尽管您可能想从[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/bb130146.aspx)开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T13:33:42.220

这取决于您要获取的详细信息。在源代码管理资源管理器中，您可以右键单击该文件并选择属性。此外，您可以从命令行运行“tf.exe 属性”以获取更多信息。

# windows-installer - 使用产品代码卸载失败“安装源不可用”

> ID：10249747
> 
> 赞同：0
> 
> 时间：2012-04-20T16:12:41.173
> 
> 标签：windows-installer

我正在处理一个令人困惑的卸载/安装问题，我已经用尽了我的 google-foo，所以我来到这里希望有人能指出我正确的方向。

场景：我们使用 AnthillPro 将旧版 ASP 网站（内置于 VS2003）的夜间构建/部署到 Windows Server 2003 (x64 SP2) Web 服务器，并且在大多数情况下它工作正常。AnthillPro 帐户使用产品代码卸载前一天晚上的更新包，然后使用 MSI 的名称安装新的。

例子：
`msiexec /qb /x {89B05BA3-679C-4120-BD6A-339BC3E726FD}`
`msiexec /qb /i "Update package.msi" PARAMETERVAL=X`

这在我们的 QA 和生产 Web 服务器上工作得很好，但开发服务器总是给我们错误：
`The installation source for this product is not available. Verify that the source exists and that you can access it.`

最有趣的细节是，当 AnthillPro 帐户安装它时，我在“添加/删除程序”小部件中看不到更新。几周前我最初发现了这个问题，并认为我通过手动将[ALLUSERS](http://msdn.microsoft.com/en-us/library/aa367559%28VS.85%29.aspx)属性添加到 MSI 并将其设置为 2 来修复它。同样，这是一个 Visual Studio 2003 解决方案，所以我不能只设置 All Users 属性通过界面。

但是，我可以看到有关 QA 和 Prod 的最新更新，因此开发盒似乎有些特别。我已经确认生成的 MSI 确实具有 ALLUSERS 属性，并且我尝试将其设置为 1 而不是 2（根据[此](http://www.itninja.com/question/allusers-1-or-2)讨论）。

每次构建都会覆盖 MSI，因此原始 MSI 确实没有保留在执行安装的目录中，但如果我只是尝试重新部署已经存在的内容，它仍然会失败。

如果我登录到开发 Web 服务器并自己安装它，确保在 UI 中选择了所有用户选项，如果我尝试另一个自动部署，它会表现出相同的行为。如果我确保未在盒子上安装更新并启动自动部署，它将成功（在发出有关卸载无法卸载任何内容的警告之后），但随后将失败并显示“源不可用" 如果我​​在此之后尝试另一个自动部署，则会出错。

包含 MSI 的文件夹和 MSI 本身的权限在 dev、QA 和 Prod 之间似乎是相同的。不幸的是，我没有 AnthillPro 使用的帐户的密码（企业安全万岁），但如果我愿意的话，我至少可以访问那些愿意并愿意检查事情的人。我确实使用这种方法确认，当我安装 AnthillPro 帐户可以看到的最新版本的更新时。

有人对可能导致此问题的原因有任何想法吗？

在大量使用这个网站几年之后，我终于打破并发布了我的第一个问题，所以如果这种情况看起来令人困惑或令人费解，请保持温和。如有必要，我可以提供更多详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-28T15:09:36.853

我只是回答这个以供参考：将**ALLUSERS**属性设置为 2 必须已为每个用户而不是每台机器安装了 MSI。然后只有安装该产品的用户才能在添加/删除程序中看到它。

如果您[查看 ALLUSERS 的文档，](http://msdn.microsoft.com/en-us/library/aa367559%28v=vs.85%29.aspx)您将看到 ALLUSERS = 1 是强制每台机器安装的常规方法。文档指出：“...值 ALLUSERS=2 使系统能够重置 ALLUSERS 的值和安装上下文，具体取决于用户的权限和 Windows 版本”。**换句话说， msiexec 已由用户安装，因为缺少安装帐户权限。**. 这种行为在不同的操作系统上可能会有所不同。

在重大升级中的 InstallInitialize 之前运行 RemoveExistingProducts 操作之后，可以通过自定义操作设置 ALLUSERS = 1 更改为每台计算机的安装状态。这涉及到测试，但如果您使用以前为每个用户安装的相同帐户运行安装，则可以使用管理权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T17:17:08.717

我最终通过简单地卸载所有版本的网络应用程序，然后手动浏览注册表并删除对网络应用程序名称、升级代码和每个版本的各种产品代码的所有引用来解决这个问题。

压力很大，但我终于想通了。将其留在这里可能会提醒将来的其他人注册表始终是您的敌人。

# c++ - const char...改变了？

> ID：10249750
> 
> 赞同：0
> 
> 时间：2012-04-20T16:12:57.040
> 
> 标签：c++

这是我的简单程序的一部分

```
string appData = getenv("APPDATA");
const char *mypath= (appData+"\\MyApplication\\hello.txt").c_str();      
cout << mypath;  
// output: c:\users\xrobot\appdata\Roaming\Myapplication\hello.txt   
fstream file(mypath,ios::in);
ofstream filetemp;    
filetemp.open("world.bak");
cout << mypath;  
// output: É↕7 
```

为什么 mypath 在那个奇怪的字符串中发生了变化？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:15:08.957

您应该`std::string`用作：

```
std::string appData = getenv("APPDATA");
std::string path = appData+"\\MyApplication\\hello.txt"; 
```

然后这样做：

```
const char * mypath = path.c_str(); 
```

请注意，您**不能**这样做：

```
const char* mypath = (appData+"\\MyApplication\\hello.txt").c_str(); 
```

这是因为右侧的表达式是一个临时的，它在表达式的末尾被销毁，`mypath`并将继续指向被销毁的对象。换句话说，它变成了一个悬空指针。

--

> 为什么 mypath 在那个奇怪的字符串中发生了变化？

因为在您发布的代码中，`mypath`是一个悬空指针，使用它会调用未定义的行为。

**这就是你应该如何编写代码：**

```
std::string appData = getenv("APPDATA");
std::string mypath= appData+"\\MyApplication\\hello.txt";
cout << mypath;  
fstream file(mypath.c_str(),ios::in); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T16:14:32.837

你不能像这样添加两个字符串。您应该会收到明确的警告。由于您使用的是 C++，因此您可能希望改用 C++ `std::string`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T16:15:52.890

这只是暂时的`std::string`：

```
(appData+"\\MyApplication\\hello.txt") 
```

因此，在使用表达式后，可以释放底层 C 字符串空间。由于您`char*`指向现在的垃圾内存，因此您有一个时髦的值。

# asp.net - 如何标记多个 ？

> ID：10249753
> 
> 赞同：10
> 
> 时间：2012-04-20T16:13:03.247
> 
> 标签：asp.net, html

我用

```
 <br /> 
```

在我的网页上插入空行。什么是相当于 20 到 40 个的优雅方法？格式化后，每个 br 标签都放在单独的行上，这使得读取文件很麻烦。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T16:16:00.370

`min-height`,`margin`和`padding`.

您可以为此定义 CSS 样式，例如

```
.space { margin-top: 300px; } 
```

并将其插入您想要的任何位置...

```
<div class="space"></div> 
```

希望有帮助...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:15:27.997

这绝对不是有间距的方法。

使用 Css 的 padding 属性：[http ://www.w3schools.com/css/css_padding.asp](http://www.w3schools.com/css/css_padding.asp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-05-04T09:02:13.837

老问题，但常青树。

如果你真的想使用多个 <br> 标签，你可以这样做

```
<br />&nbsp;<br /> 
```

当我想要段落之间的空白时，我发现这很有用。使用 Div 标签来做到这一点是一个非常糟糕的矫枉过正的黑客，对不起，伙计们。:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-20T16:14:16.030

在 div 或 td 之间使用填充而不是`<br />`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T18:35:39.217

问题是如果有人能解释为什么
不推荐使用多个的话会很有帮助

最好在元素上使用填充或边距来获得所需的间距。它更精确（每个浏览器都可以以不同的方式显示 br）

边距和填充更兼容几乎所有浏览器

# xml - WCF REST 4 模板 POST 请求适用于本地主机，但服务器上的错误代码 400

> ID：10249755
> 
> 赞同：0
> 
> 时间：2012-04-20T16:13:13.533
> 
> 标签：xml, wcf, rest, post, http-status-code-400

我有一个从 VS2010 在线模板定制的 WCF REST 服务。我专门将 POST 方法定制为最少量的 XML。在 localhost 上运行时，一切都完全符合我的要求。但是，当我将它部署到服务器时，Fiddler 给了我 400。通过 Fiddler 运行 GET 请求工作正常；唯一不起作用的是POST。

这是请求的 xml，我直接从 WCF 服务帮助页面中提取出来：

```
<UserData xmlns="http://schemas.datacontract.org/2004/07/SRAccountService.SRObjects">
  <key>12345</key>
  <favorite>chocolate</favorite>
</UserData> 
```

我在 HTTP 标头上设置 Content-Type:text/xml。我也知道有大约 1000 个关于 WCF、POST 和 400 个状态码的 stackoverflow 问题，但我认为我通读了其中的大部分问题，但没有一个（我所见）能满足我的需要。

有人有什么想法吗？我将不胜感激！

编辑：我在截止日期前工作，所以我重新配置了服务以将参数作为 URL 的一部分并通过 GET 请求返回数据。同样的事情正在发生——在 localhost 上工作正常，在服务器上工作 400。这太疯狂了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:22:51.133

这是一个想法

[http://geekswithblogs.net/michelotti/archive/2011/05/28/resolve-404-in-iis-express-for-put-and-delete-verbs.aspx](http://geekswithblogs.net/michelotti/archive/2011/05/28/resolve-404-in-iis-express-for-put-and-delete-verbs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T18:31:39.390

问题是我使用 ado.net 实体模型连接到后端数据库...连接字符串使用集成安全性（而不是 SQL Server 登录），所以当我开始在服务器上运行它时，集成部分坏了。

# mysql - Mysql 正则表达式查找固定长度的单词

> ID：10249758
> 
> 赞同：1
> 
> 时间：2012-04-20T16:13:23.223
> 
> 标签：mysql, regex

我正在尝试使用以下语法从给定集合中查找三个字母的单词：

```
SELECT * FROM words WHERE word REGEXP '^[dcqaahii]{3}' 
```

它返回超过三个字母的单词。我认为 {3} 限制了输出的长度。

有人知道我的表达有什么问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:18:54.920

您需要将字符串锚`$`的结尾添加到正则表达式的末尾：

```
SELECT * FROM words WHERE word REGEXP '^[dcqaahii]{3}$' 
```

此外，您可以在不改变含义的情况下从角色类中删除额外的`a`和：`i``^[dcqahi]{3}$`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:19:57.787

`REGEXP`与 不同`LIKE`，不必匹配整个字符串。它只需要匹配字符串的一部分。

如果您想要与您的正则表达式完全匹配的列，您需要在您的正则表达式中包含 BOL 和 EOL 字符：

```
'^[dcqaahii]{3}$' 
```

[正则表达式.info](http://www.regular-expressions.info/mysql.html)有更多细节。

# android - Kivy / Python-for-android：Build.py 无法构建 android 包 apk

> ID：10249765
> 
> 赞同：0
> 
> 时间：2012-04-20T16:14:01.560
> 
> 标签：android, python, python-2.7, ubuntu-11.10, kivy

我尝试了很多天使用 kivy 和 python for android 构建一个简单的 android 包。不幸的是，我花了很多时间试图解决所有问题，但我仍然无法做到。我希望你们能帮助我，因为在把我的笔记本电脑从窗户上扔下之前，你们是我最后的希望......

我已经成功地仅使用 kivy 模块构建了分发目录。因此输出文件夹 /dist/default 包含所有必要的文件（我希望）以构建我的 apk。根据文档中的示例，我用来构建 apk 的命令如下：

```
sudo ./build.py --dir ~/mount_point/kivy --name "Myapp" --package org.mytest.myapp --version 1.0 installd 
```

我得到的是：

> 调用 ~/android-sdk-linux/tools/android 更新时出错您的 PATH 必须包含 android 工具。

我已经插入`bashrc`了适当的出口。因此，如果我运行以下命令：

```
~/android-sdk-linux/tools/android update 
```

我得到：

> 错误：缺少动词“更新”的对象名称。[继续使用详细信息...]

我不知道该怎么做，我在互联网上找不到任何东西。如果您需要更多详细信息，请让我提供。我的操作系统是 UBUNTU 11.10。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:33:59.360

基本上，作为一个 linux 菜鸟，我不知道我必须将所需的变量导出到 root 的 .bashrc 文件，因为我不知道每个用户都有不同的 bash 配置文件，然后以 root 身份运行命令. 正如我所做的那样，构建脚本可以正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T11:54:39.470

为了让新手或像我这样没有耐心设置`Android sdk`,`Android ndk`和`python for android`, 以及适当的路径和设置的懒人更容易；现在有这个 Virtual Box [Image](http://kivy.org/#download)（在页面末尾向下滚动 932MB），所有内容都在 Ubuntu 上进行了预设置。使用 python for android 构建链，可以使用它通过 5 个简单的步骤轻松制作 apk。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:05:31.283

Python for android 尝试通过执行以下命令（8 或 14 取决于您的配置）升级您的项目：

```
android update project -p . -t android-8 
```

该消息表明在 PATH 中找不到 android 二进制文件。如果设置正确，则显示出现在此错误消息之前的确切错误消息，或手动更新项目时出现的消息。

# javascript - Javascript onKeyUp

> ID：10249767
> 
> 赞同：2
> 
> 时间：2012-04-20T16:14:11.413
> 
> 标签：javascript

所以我正在为历史课制作一个模拟版的谷歌审查。我试图让搜索在按 Enter 后工作，但到目前为止，我得到的只是搜索我输入的第一个字母。有什么建议么？

HTML 代码：

```
<form id="searchBox">
    <input type="text" id = "search" name="search" size="85" onKeyUp="searchCensor()"/><br />        
</form> 
```

JavaScript 代码：

```
function searchCensor() 
{
    var keyTerms = document.getElementById("search").value;
    if(keyTerms == "censorship")
        window.location = "http://andrewgu12.kodingen.com/history/censor.php";
    else if(window.event.keyCode == 13)
        window.location = "https://www.google.com/search?q="+keyTerms;
    else 
        window.location = "https://www.google.com/search?q="+keyTerms;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:19:13.493

您需要检查正在按下哪个键......每次按下任何键时，您都在运行您的功能。在您的 searchCensor() 函数中，您将希望进行如下检查：`if (event.keyCode == 13) {`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:26:50.143

这是你的逻辑：

> 如果搜索字段的值为“censorship”，则直接转到此页面
> 
> 否则，如果按键是 [Enter]，请在 google 上搜索搜索字段的值
> 
> 否则，在任何其他情况下，在谷歌上搜索搜索字段的值

现在，假设您在搜索字段中点击“e”。发生什么了？

> 首先检查：这不是“审查”，跳过
> 
> 第二次检查：hit键不是[Enter]，跳过
> 
> 第三次检查：好的，之前的检查都没有通过，我正在做这个。

因此，您最终会在 Google 上搜索字母“e”。

你知道这是怎么回事吗？

也就是说，脱掉`else`，你会没事的。

# c# - 使用外线在 DrawingContext 上的 WPF 中绘制线

> ID：10249771
> 
> 赞同：0
> 
> 时间：2012-04-20T16:14:17.763
> 
> 标签：c#, wpf, line, drawingcontext

我正在尝试在 WPF 中绘制许多类似的线条，如[本](https://stackoverflow.com/questions/9642395/line-with-fill-and-stroke)问题所示，但不同之处在于我需要在 DrawingVisual 对象的 DrawingContext 上绘制它。如何做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:52:42.177

您必须在彼此顶部的相同点之间绘制两条线，较低的用较粗的笔，较高的用较细的笔。

```
Pen background = new Pen(Brushes.Black, 5);
Pen foreground = new Pen(Brushes.White, 3);

drawingContext.DrawLine(background, new Point(100, 100), new Point(200, 200));
drawingContext.DrawLine(foreground, new Point(100, 100), new Point(200, 200)); 
```

当您还定义笔线帽时，这条线看起来好多了：

```
Pen background = new Pen
{
    Brush = Brushes.Black,
    Thickness = 5,
    StartLineCap = PenLineCap.Round,
    EndLineCap = PenLineCap.Round
};

Pen foreground = new Pen
{
    Brush = Brushes.White,
    Thickness = 3,
    StartLineCap = PenLineCap.Round,
    EndLineCap = PenLineCap.Round
}; 
```

使用这样的扩展方法

```
public static class DrawingContextExtensions
{
    public static void DrawLine(this DrawingContext drawingContext,
        Pen background, Pen foreground, Point start, Point end)
    {
        drawingContext.DrawLine(background, start, end);
        drawingContext.DrawLine(foreground, start, end);
    }
} 
```

您可以在一个电话中完成绘图：

```
drawingContext.DrawLine(background, foreground, new Point(100, 100), new Point(200, 200)); 
```

# sql - 内置 MAX 函数只返回一个整数

> ID：10249774
> 
> 赞同：3
> 
> 时间：2012-04-20T16:14:24.800
> 
> 标签：sql, sql-server, stored-procedures, max

我正在尝试编写一个存储过程（使用 SQL Server Management Studio 2008 R2）来从表中检索最大测量值。这似乎是一件容易的事，所以我编写了一个简短的存储过程来获取 MAX。但是，当我运行该过程时，它返回 0 而不是预期的 0.018 值。

当我将鼠标悬停在 MAX 函数上时，它会显示“内置函数 MAX(expression) RETURNS int”。因此，它似乎将我的结果转换为 int。这很烦人。

我想除非这里有人有更简单的解决方案，否则我将不得不计算最大值。有任何想法吗？

```
ALTER PROCEDURE [dbo].[GetMaxOscillation] (@SerialNumber varchar (16), @Date datetime)
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @MaxOsc DECIMAL(18,6)

    SELECT @MaxOsc = MAX(Value)
    FROM LoadListingOscillations
    WHERE SerialNumber=@SerialNumber AND Date=@Date AND Value IS NOT NULL

    RETURN @MaxOsc

    SET NOCOUNT OFF
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:21:41.333

你所要做的`MAX(CAST(Value AS DECIMAL(18,6)))`

我猜`Value`不是 DECIMAL，所以你必须在分配之前强制转换它

[这是证明如果表设置为十进制那么这将工作的 SQLFiddle](http://sqlfiddle.com/#!3/e2dfa/1)

[这是一个 SQLFiddle，显示需要强制转换](http://sqlfiddle.com/#!3/9abaf/8)

**更新**

如果`Value`确实是 Decimal(18,6)，那么您需要确保您的表值。因为，正如您从我的示例中看到的那样，这应该有效

**最后一件事可能是你的问题**是你返回一个整数。我认为您只能[在 SQL Server 中返回整数](http://msdn.microsoft.com/en-us/library/ms174998.aspx)。您将不得不执行`SELECT @MaxOsc`或使用[OUTPUT](http://msdn.microsoft.com/en-us/library/ms378108%28v=sql.90%29.aspx)变量

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:55:37.870

存储过程以三种方式通信：RETURN 值、OUTPUT 参数和结果集

**RETURN VALUE**
如果需要返回一个整数，可以使用这个方法：

```
CREATE PROCEDURE GetMyInt
( @Param int)
AS
DECLARE @ReturnValue int

SELECT @ReturnValue=MyIntField FROM MyTable WHERE MyPrimaryKeyField = @Param
RETURN @ReturnValue
GO 
```

现在调用您的程序，例如：

```
DECLARE @SelectedValue int
       ,@Param         int
SET @Param=1
EXEC @SelectedValue = GetMyInt @Param
PRINT @SelectedValue 
```

这仅适用于 INT，因为 RETURN 只能返回单个 int 值，并且 null 被转换为零。

**OUTPUT PARAMETER**
你可以使用一个输出参数：

```
CREATE PROCEDURE GetMyInt
( @Param     int
 ,@OutValue  int OUTPUT)
AS
SELECT @OutValue=MyIntField FROM MyTable WHERE MyPrimaryKeyField = @Param
RETURN 0
GO 
```

现在调用您的程序，例如：

```
DECLARE @SelectedValue int
       ,@Param         int
SET @Param=1
EXEC GetMyInt @Param, @SelectedValue OUTPUT
PRINT @SelectedValue 
```

输出参数只能返回一个值，但可以是任何数据类型

**结果集的RESULT SET** 使过程如下：

```
CREATE PROCEDURE GetMyInt
( @Param     int)
AS
SELECT MyIntField FROM MyTable WHERE MyPrimaryKeyField = @Param
RETURN 0
GO 
```

像这样使用它：

```
DECLARE @ResultSet table (SelectedValue int)
DECLARE @Param int
SET @Param=1
INSERT INTO @ResultSet (SelectedValue)
    EXEC GetMyInt @Param
SELECT * FROM @ResultSet 
```

结果集可以有任意数据类型的多行多列

# ruby-on-rails - Facebook 令牌到期和更新，与 Koala 和omniauth-facebook

> ID：10249778
> 
> 赞同：22
> 
> 时间：2012-04-20T16:14:33.160
> 
> 标签：ruby-on-rails, omniauth, koala

我正在编写一个 Rails 应用程序，该应用程序使用omniauth-facebook 对FB 用户进行身份验证（并为用户获取FB OAuth 访问令牌）。然后，该应用程序使用 Koala 使用保存的 OAuth 令牌对 FB Graph API 进行各种调用。

每次用户重新进行身份验证时（通常在他们登录到我的应用程序时），我都会更新保存的令牌。即便如此，该保存的令牌仍会不时过期（或以其他方式变为无效）。

使用 Koala 时防止身份验证失败和更新令牌的最佳做法是什么？

是否应该将所有调用都包装在开始/救援块中，并使用异常处理程序重新验证用户对 FB 的身份？

有没有办法（使用考拉）利用[这里](https://developers.facebook.com/roadmap/offline-access-removal/)描述的“扩展访问令牌”过程？如果没有，是否有编写自己的代码以自己从考拉调用中提取新令牌的最佳实践？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-01T01:03:19.090

我所拥有的是一个 before_filter，它在需要活动 Facebook 会话的每个页面上触发。像这样的东西应该工作：

```
 before_filter :reconnect_with_facebook
  def reconnect_with_facebook
    if current_account && current_account.token_expired?(session[:fb]["expires"])

    # re-request a token from facebook. Assume that we got a new token so
    # update it anyhow...
    session[:return_to] = request.env["REQUEST_URI"] unless request.env["REQUEST_URI"] == facebook_request_path
    redirect_to(with_canvas(facebook_request_path)) and return false
  end
end 
```

token_expired？方法如下所示：

```
def token_expired?(new_time = nil)
  expiry = (new_time.nil? ? token_expires_at : Time.at(new_time))
  return true if expiry < Time.now ## expired token, so we should quickly return
  token_expires_at = expiry
  save if changed?
  false # token not expired. :D
end 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-05-23T18:54:01.787

我看到了[这篇文章，它改编](https://github.com/mkdynamic/omniauth-facebook/issues/23#issuecomment-15565902)[了 Facebook 上 Railscast 的](http://railscasts.com/episodes/360-facebook-authentication)代码，展示了如何将短期令牌换成 60 天的令牌：

**用户.rb**

```
 def self.from_omniauth(auth)

    # immediately get 60 day auth token
    oauth = Koala::Facebook::OAuth.new(ENV["FACEBOOK_APP_ID"], ENV["FACEBOOK_SECRET"])
    new_access_info = oauth.exchange_access_token_info auth.credentials.token

    new_access_token = new_access_info["access_token"]
    # Facebook updated expired attribute
    new_access_expires_at = DateTime.now + new_access_info["expires_in"].to_i.seconds

    where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|
      user.provider = auth.provider
      user.uid = auth.uid
      user.name = auth.info.name
      user.image = auth.info.image
      user.email = auth.info.email
      user.oauth_token = new_access_token #originally auth.credentials.token
      user.oauth_expires_at = new_access_expires_at #originally Time.at(auth.credentials.expires_at)
      user.save!
    end
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-04T17:25:35.587

您可以执行类似的操作，检查 access_token 是否已过期并生成另一个。

```
 %w[facebook].each do |provider|
   scope provider, -> { where(provider: provider) }
 end

 def client
   send("#{provider}_client")
 end

 def expired?
   expires_at? && expires_at <= Time.zone.now
 end

 def access_token
   send("#{provider}_refresh_token!", super) if expired?
   super
 end

 def facebook_refresh_token!(token)
   new_token_info = 
   Koala::Facebook::OAuth.new.exchange_access_token_info(token)
   update(access_token: new_token_info["access_token"], expires_at: Time.zone.now + new_token_info["expires_in"])
 end 
```

您可以查看[gorails 截屏视频](https://gorails.com/episodes/facebook-api-and-auth-tokens-with-koala?autoplay=1)，该视频详细解释了这一点。

# ruby-on-rails-3 - Rails 邮件程序 url_for 绝对 url

> ID：10249782
> 
> 赞同：0
> 
> 时间：2012-04-20T16:14:46.693
> 
> 标签：ruby-on-rails-3, actionmailer

导轨 3.2

我正在尝试将 url 添加到链接到用户网站的邮件中。这是我目前拥有的链接：

```
<%= link_to "Visit our website", url_for(:host => @dealer.stores.first.website) %> 
```

但是，`/assets`一旦生成 url，就会附加到路径中。这是生成的网址：

```
http://www.foo.com/assets 
```

关于为什么会发生这种情况和/或如何防止`/assets`被添加的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:01:26.163

有趣的是，我想我是用错误的方式来做这件事的。我能够让它像这样工作：

```
<%= link_to "Visit our website", "http://#{@dealer.stores.first.website}" %> 
```

# apache-flex - 来自 Air 应用程序的 iPad 上的 https 问题

> ID：10249793
> 
> 赞同：1
> 
> 时间：2012-04-20T16:15:29.480
> 
> 标签：apache-flex, ipad, air, https

我为 iPad 开发了一个内部 Air 应用程序，它尝试使用 HTTPService 通过 SSL (https) 连接到码头 Web 服务器。即使是最简单的 GET 也会返回错误 #2032（使用纯 http 运行正常）。

我已经检查了明显的事情：URL 正确，证书正确且安装正确，我使用了正确的端口，该端口是开放的。事实上，可以从 iPad 上的 Safari 访问 URL 没有问题。它也可以在 adl 上正确运行。

我正在使用带有 iOS 5 的 iPad 2。该应用程序是使用 Air 4.6 构建的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T15:48:03.827

您已在我的主题中发布。我自己找到了解决这个问题的方法。这对我来说可以。

如果您有由第三家公司签署的证书，它应该可以工作。如果没有，请执行以下步骤：

首先，我将加载程序的 contentType（我使用 Flex 的 HTTPService）更改为“application/x-www-form-urlencoded”；但我认为这对我来说唯一重要。

其次创建了一个 StageWebView，将它放在舞台上并在屏幕外给它一个视口。然后在应用程序启动时使用您的 https url 从 StageWebView 调用函数 loadURL。

如果应用程序在 ios 设备上运行，则会出现一个对话框，询问您是否要允许自签名证书。接受证书后，下一个请求将起作用。

有两个缺点： • 您必须在应用程序的每次新启动时接受证书。• 您第一次调用（通过stageWebView）将不起作用。因为这会调用对话框并且您无法调度对话框输入。因此，您必须自己处理在该对话框之后发出 HTTPS 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T06:52:12.063

移动 Air 应用程序尚不支持 https

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T13:07:28.087

与@Eduardo 发布的内容相反，只要证书有效，HTTPS 在 AIR 中就可以正常工作。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-04-21T20:49:15.270

您需要将 AIR 版本从 3.1 升级到最新版本。Adobe AIR 3.2 还支持自签名证书。

# asp.net-mvc-2 - 将自定义业务逻辑验证添加到模型

> ID：10249798
> 
> 赞同：0
> 
> 时间：2012-04-20T16:15:48.020
> 
> 标签：asp.net-mvc-2

在[学习 MVC 2 NerdDinner 教程](http://tinyurl.com/aspnetmvc)时，我看到一些业务逻辑（必填字段、最大长度等）可以添加到模型的各个属性中。

如何添加更复杂的验证规则？例如，需要恰好填充两个属性之一？

示例 [QuantumMechanics/Models/Particle.cs]：

```
namespace QuantumMechanics.Models
{
   [MetadataType(typeof(Particle_Validation))]
   public partial class Particle {
   }
   public class Particle_Validation
   {
       // Mass is required; easy enough.
       [Required(ErrorMessage="Mass is required.")]
       public Mass double {get; set; }

       // How do I require exactly one or the other?
       public Position double {get; set; }
       public Momentum double {get; set; }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:08:58.773

在**MVC2**中，一旦将值发布到控制器，您将执行检查。

```
[HttpPost]
public ActionResult Add(Particle particleToAdd)
{
    ValidateModel(particleToAdd);

    if(ModelState.IsValid)
    {
        // Add particle
        return RedirectToAction(...) // etc
    }

    // Return the view with our errors
    return View(particleToAdd);
}

// This validate method can be invoked from your Add and Edit actions
private void ValidateModel(Particle particleToAddOrUpdate)
{
    if(particleToAddOrUpdate.Position == null && particleToAddOrUpdate.Momentum == null)
    {
        ModelState.AddModelError("", "You must supply a value for either Position or Momentum");
    }
} 
```

如果您喜欢（位置或动量），您可以将错误添加到属性之一，但我刚刚将其添加到将出现在您的验证摘要中的通用错误列表中。

```
<%: Html.ValidationSummary() %> 
```

在**MVC3**中有一个接口[`IValidateObject`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.ivalidatableobject.aspx)可以稍微抽象一下这个问题。它允许您执行您为每个类指定的检查，即您的粒子对象可以在绑定时检查其自己的属性，而您不必在您的`Add`方法中编写检查。

这是它的用法[示例](https://gist.github.com/630235#file_gistfile1.cs)。

**不幸的是，在MVC2**中没有开箱即用的东西允许您在绑定时验证类的多个属性，如**MVC3**`IValidateObject`中的接口。您只需要确保在调用or操作时调用附加的 Validate 方法。**`Add``Edit`**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T14:43:42.993

听起来您的目标是“条件要求”规则，即根据另一个属性的值标记为必需的属性。仅使用 ValidationAttribute 是不可能的，因为该属性的范围仅限于它所装饰的属性。您需要实现 match`DataAnnotationsModelValidator`以具有更广泛的范围（`ModelClientValidationRule`如果您希望它也验证客户端，还需要实现与关联的客户端 javascript ）。

因此，您的 ConditionalRequiredAttribute 看起来像：

```
[AttributeUsage(AttributeTargets.Property | AttributeTargets.Field, AllowMultiple = true)]
public class ConditionalRequiredAttribute : ValidationAttribute
{
    public ConditionalRequiredAttribute(string triggerProperty, object triggerValue)
    {
        TriggerProperty = triggerProperty;
        TriggerValue = triggerValue;
    }

    /// <summary>
    /// Checks that the value of the decorated member is not null/empty if the TriggerProperty's value is equal to TriggerValue.
    /// </summary>
    /// <param name="value">The data field value to validate.</param>
    /// <returns>true if validation is successful; otherwise, false.</returns>
    public override bool IsValid(object value)
    {
        if (value == null)
            return false;

        if (value is double)
        {
            return !((double)value).Equals(0);
        }

        string s = value as string;
        if (s != null)
            return s.Length > 0;

        return true;
    }

    /// <summary>
    /// The name of the property whose value will be checked to trigger the required field
    /// </summary>
    public string TriggerProperty { get; set; }

    /// <summary>
    /// The expected value of the trigger property that will trigger the required field
    /// </summary>
    public object TriggerValue { get; set; }
} 
```

这实际上与标准属性几乎相同`Required`- “特殊酱汁”实际上是验证器，您仅`IsValid`在某些情况下使用它来调用方法（即`TriggerProperty.Value`== `TriggerValue`）。验证器看起来像：

```
 public class ConditionalRequiredValidator : DataAnnotationsModelValidator<ConditionalRequiredAttribute>
{
    public ConditionalRequiredValidator(ModelMetadata metadata, ControllerContext context,
                                        ConditionalRequiredAttribute attribute)
        : base(metadata, context, attribute)
    {

    }

    /// <summary>
    /// Override the default validate method to only execute if the TriggerProperty's value is equal to TriggerValue
    /// </summary>
    public override IEnumerable<ModelValidationResult> Validate(object container)
    {
        // Does the specified property exist in the metadata?
        PropertyInfo triggerProperty = Metadata.ContainerType.GetProperty(Attribute.TriggerProperty);
        if (triggerProperty != null)
        {
            object actualValue = triggerProperty.GetValue(container, null);
            if (actualValue != null)
            {
                if (Attribute.TriggerValue.Equals(actualValue))
                {
                    // Run IsValid for the property if the actual value matches the expected value
                    foreach (ModelValidationResult result in base.Validate(container))
                    {
                        yield return result;
                    }

                }
            }
        }
    }
} 
```

最后，您需要向`ConditionalRequiredValidator`提供者注册，以确保框架在`ConditionalRequiredAttribute`使用 a 时更喜欢它。为此，请在`Application_Start()`Global.asax.cs 的方法中添加以下行：

```
DataAnnotationsModelValidatorProvider.RegisterAdapter(typeof(ConditionalRequiredAttribute), typeof(ConditionalRequiredValidator)); 
```

然后你像这样装饰粒子类（或者实际上是任何其他类）的成员：

```
public class Particle
{
    // Mass is required; easy enough.
    [Required(ErrorMessage="Mass is required.")]
    public double Mass  { get; set; }

    [ConditionalRequired("Momentum", 0D, ErrorMessage = "Position must be set if Momentum is not.")]
    public double Position { get; set; }

    [ConditionalRequired("Position", 0D, ErrorMessage = "Momentum must be set if Position is not.")]
    public double Momentum { get; set; }
} 
```

瞧，您现在应该能够根据另一个字段的值有条件地验证一个字段。

在旁注中，您可以将此条件逻辑抽象为一个辅助类并创建一系列“条件”验证器，ConditionalRequired，ConditionalRange 等......

注意 2：虽然它可能比您自己的解决方案更复杂/“更多代码”（在我仍在整理此回复时发布 - doh！）这确实具有非常可重用的好处。要将相同的功能添加到未来的视图模型中，您只需使用属性装饰您的`ConditionalRequired`属性...

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-23T13:22:41.013

以为我会发布我使用的解决方案。就像 Spencerooni 所说，没有一种优雅的机制可以为模型本身添加复杂的验证，但这似乎有效。它利用 DefaultModelBinder 接口的 OnModelUpdated 方法覆盖来使基础模型在更新时失效。

请注意，模型属性上的 DataAnnotations 仅在回发绑定字段时调用，这意味着验证将在根本没有 Mass 字段的表单上传递。

全球.asax

```
ModelBinders.Binders[typeof(Particle)] = new ParticleModelBinder(); 
```

模型/ParticleModelBinder.cs

```
public class ParticleModelBinder : DefaultModelBinder
{
    protected override void OnModelUpdated(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        base.OnModelUpdated(controllerContext, bindingContext);

        var particle = (Particle)bindingContext.Model;

        if (<Test for business rule violation here>)
        {
            var modelState = bindingContext.ModelState;
            // Message to appear in validation summary.
            modelState.AddModelError("","Please enter position OR momentum.");
            // Messages also appear in summary, but highlight the bound controls too.
            modelState.AddModelError(bindingContext.ModelName + ".Position",
                "Please enter position (or momemtum).");
            modelState.AddModelError(bindingContext.ModelName + ".Momentum",
                "Please enter momentum (or position).");
        }
    }
} 
```**

# sql - MS-Access 查询中的语法错误（缺少运算符）

> ID：10249802
> 
> 赞同：6
> 
> 时间：2012-04-20T16:15:56.357
> 
> 标签：sql, ms-access, syntax

以下查询给了我`"(missing operator)"`语法错误。所需的输出是来自表`[dbo_tbl*]`和视图的数据的组合`[vw_*]`。我用过的所有键都存在。有任何想法吗？

```
SELECT dbo_tbl_BOD.fpartno AS PartNumber,
      dbo_tbl_BOD.frev AS RevisionIssue,
      vw_DOCSwType.DocID,
      vw_DRHRelfilter.Rev,
      vw_DOCSwType.DocTypeDesc,
      vw_DOCSwType.DocDesc,
      vw_DOCSwType.DwgNoLegacy,
      vw_DOCSwType.FileLocationOld,
      vw_DRHRelfilter.DateCreated,
      vw_DOCSwType.CreatedBy,
      vw_DRHRelfilter.Rel,
      vw_DRHRelfilter.RelLink
FROM dbo_tbl_BOD
LEFT JOIN vw_DRHRelfilter
      ON ((dbo_tbl_BOD.DocID=vw_DRHRelfilter.DocID)
     AND (dbo_tbl_BOD.frev=vw_DRHRelfilter.Rev))
 LEFT JOIN vw_DOCSwType
      ON (dbo_tbl_BOD.DocID=vw_DOCSwType.DocID)
ORDER BY PartNumber; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T16:18:25.387

使用 Access，每个连接都需要括号，例如：

```
SELECT dbo_tbl_BOD.fpartno AS PartNumber,
dbo_tbl_BOD.frev AS RevisionIssue,
vw_DOCSwType.DocID,
vw_DRHRelfilter.Rev,
vw_DOCSwType.DocTypeDesc,
vw_DOCSwType.DocDesc,
vw_DOCSwType.DwgNoLegacy,
vw_DOCSwType.FileLocationOld,
vw_DRHRelfilter.DateCreated,
vw_DOCSwType.CreatedBy,
vw_DRHRelfilter.Rel,
vw_DRHRelfilter.RelLink
FROM (dbo_tbl_BOD
LEFT JOIN vw_DRHRelfilter
ON dbo_tbl_BOD.DocID=vw_DRHRelfilter.DocID
AND dbo_tbl_BOD.frev=vw_DRHRelfilter.Rev)
LEFT JOIN
vw_DOCSwType
ON dbo_tbl_BOD.DocID=vw_DOCSwType.DocID
ORDER BY PartNumber; 
```

如果您有 MS Access 的副本，则可以通过使用查询设计窗口来构建连接，轻松查看所需的括号。

您可以使用 VBA 来检查字段类型，例如：

```
Dim rs As DAO.Recordset
Dim fld As DAO.Field

Set rs = CurrentDb.OpenRecordset("query1")
For Each fld In rs.Fields
    Debug.Print fld.SourceField, fld.SourceTable, _
        DLookup("SQLName", "DataTypeEnum", "DataValue=" & fld.Type)
Next 
```

表 DataTypeEnum 包含 fld.type 返回的数值的文本描述。

```
数据值 SQLName
1 个布尔值
2 字节
3 整数
4长
5 货币
6单
7 双
8 日期
9 二进制
10 文本
11 长二进制
12 备忘录
15 图形用户界面
16 大整数
17 变量二进制
18 个字符
19 数字
20 十进制
21 浮动
22 时间
23 时间戳
```

# objective-c - 目标 c - 带圆角的 UINavigationBar

> ID：10249804
> 
> 赞同：5
> 
> 时间：2012-04-20T16:16:00.213
> 
> 标签：objective-c, uinavigationcontroller, uinavigationbar, cglayer

我想让我的导航栏有圆角（左上和右上）

我找到了实现它的代码：

```
CALayer *capa = [self.navigationController navigationBar].layer;
[capa setShadowColor: [[UIColor blackColor] CGColor]];
[capa setShadowOpacity:0.85f];
[capa setShadowOffset: CGSizeMake(0.0f, 1.5f)];
[capa setShadowRadius:2.0f];  
[capa setShouldRasterize:YES];

//Round
CGRect bounds = capa.bounds;
bounds.size.height += 10.0f;    //I'm reserving enough room for the shadow
UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:bounds 
                                               byRoundingCorners:(UIRectCornerTopLeft | UIRectCornerTopRight)
                                                     cornerRadii:CGSizeMake(10.0, 10.0)];

CAShapeLayer *maskLayer = [CAShapeLayer layer];
maskLayer.frame = bounds;
maskLayer.path = maskPath.CGPath;

[capa addSublayer:maskLayer];
capa.mask = maskLayer; 
```

但它有一个问题，现在 nab bar 没有角边缘，它在数千个角处都是透明的，我可以看到它后面的视图。
我不希望它是透明的我想在那里放一些黑色。
有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:26:05.543

假设这是一个顶级导航控制器，这样的东西应该适合你：

```
self.window.backgroundColor = [UIColor blackColor]; 
```

把它贴在你的`application:didFinishLaunchingWithOptions:`

如果做不到这一点，只需使用带有黑角的导航栏图像：

![在此处输入图像描述](../Images/e5237e549f4805c6476559c9125db6c5.png)

# c# - 使用 Web 服务方法将数据插入数据库，主键自动递增

> ID：10249808
> 
> 赞同：0
> 
> 时间：2012-04-20T16:16:14.937
> 
> 标签：c#, asp.net, database, web-services, web

我在使用自动增量 ID 的 Web 服务方法方面遇到问题。我的数据库中有一张表：tableExam

```
PK - IDExam - int - auto increment
---- ExamName - string
---- ExamGrade - int 
```

然后我创建一个 Web 服务方法：

```
[WebMethod]
public void addExam(int IDExam, string ExamName, int ExamGrade)
{
    Exam e = new Exam{
    ExamName = ExamName,
    ExamGrade = ExamGrade};
} 
```

然后我将它用于我的表单。当我点击提交按钮时，它运行：

```
sampleWS s = new sampleWS();
s.addExam(bla, bla, bla); 
```

现在有一个错误告诉我无法设置主键。

```
System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Data.SqlClient.SqlException: Cannot insert explicit value for identity column in table 'tableExam' when IDENTITY_INSERT is set to OFF.
  at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
  at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
  at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
  at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
  at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
  at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
  at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
  at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
  at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
  at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
  at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
  at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
  at System.Data.Linq.ChangeDirector.StandardChangeDirector.DynamicInsert(TrackedObject item)
  at System.Data.Linq.ChangeDirector.StandardChangeDirector.Insert(TrackedObject item)
  at System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode)
  at System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
  at System.Data.Linq.DataContext.SubmitChanges() 
```

我尝试像这样更改我的网络服务：

```
[WebMethod]
public void addExam(string ExamName, int ExamGrade)
{
    Exam e = new Exam{
    ExamName = ExamName,
    ExamGrade = ExamGrade};
} 
```

现在它仍然有错误：

> ObjectDataSource 'ObjectDataSourceP' 找不到具有以下参数的非泛型方法 'addExam'：IDExam、ExamName、ExamGrade。

那么，我必须怎么做才能使用这个带有自动递增 PK ID 的 WS 方法呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:52:49.860

如果我看到你的异常，你能给出你正在使用的 dal 代码然后它告诉 id 有身份并且你给 id 一个错误的值，id 将被自动添加。你不必设置examid 错误在Query not in webmethod

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T15:49:48.730

更改为

```
sampleWS s = new sampleWS();
s.addExam(100000000, bla, bla); 
```

它有效..

感谢您的参与...

# galaxy - 带有“黑桃 A”的 Galaxy Ace 与您的设备应用程序不兼容

> ID：10249810
> 
> 赞同：1
> 
> 时间：2012-04-20T16:16:25.953
> 
> 标签：galaxy, google-play

我开发了一个应用程序“Guia Dos Mares La Manga”，它在我的 Galaxy Ace 中找到了原始操作系统，但在刷入黑桃王牌 V3 后，一切正常，但这个应用程序没有出现在 PLAY 中电话。如果我从 PC 上查找它，PLAY 会告诉我“此项目与您的设备不兼容”。使用以前的操作系统时很好。

我已经查看了代码和清单，但一切看起来都很好。我已经阅读了几篇有类似问题的帖子，但没有运气。它既不是 SDK 版本，也不是成熟度，不是许可证，不是使用功能，我快疯了，因为它是唯一一个没有出现在我手机中的应用程序。

是否有可能知道 Google Play 显示“此项目与您的设备不兼容”的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T22:12:56.770

我已经发现了问题。只是为了帮助任何有类似问题的人。对于某些闪存设备，如果应用程序在产品中的版权保护处于活动状态，如果 Google Play 上没有选项卡，则设备将无法在 Google Play 中看到该应用程序。这个原因我不清楚，也许有人可以提供一些额外的信息。

# javascript - 链接到特定的选项卡式面板在 ModalBox 中不起作用

> ID：10249811
> 
> 赞同：0
> 
> 时间：2012-04-20T16:16:28.097
> 
> 标签：javascript, modal-dialog, spry

我有一个使用 ModalBox 的模态窗口，它在其中使用 Spry 选项卡式面板。窗口内有几个面板，应该是某种帐户管理窗口。我的问题来自于通过 onclick 事件调用 ModalBox 窗口内超链接中的特定选项卡。它只是简单地不起作用。

但是，当在新窗口中独立运行时，页面可以正常工作，特定选项卡的链接也是如此。

我假设有一些 javascript 干扰在起作用 - 我似乎找不到它。有没有其他人经历过这个？我在任何地方都没有找到任何文档。

有任何想法吗？

```
<a href='#' class='account_content' style='text-decoration: none;' onclick="TabbedPanels2.showPanel(2);"><span class='account_content'>Add one now</span></a> 
```

打开模态窗口的代码：

```
<a href="../../../myzp.php" title="My Zero Point" onClick="this.blur(); Modalbox.show('../../../myzp.php', {title: 'My Zero Point', width: 1100, height: 800}); return false;"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T01:57:53.107

显然，由于 Prototype 处理函数的方式，页面上任何脚本中声明为“var”的任何内容都将或多或少地被忽略，并且不会被脚本评估。在底部，我声明了我的选项卡式面板，代码是这样的：

```
var TabbedPanels2 = new Spry.Widget.TabbedPanels("TabbedPanels2"); 
```

通过删除使代码看起来像这样的“var”：

```
TabbedPanels2 = new Spry.Widget.TabbedPanels("TabbedPanels2"); 
```

我能够让 onclick 事件在 ModalBox 窗口内的选项卡式面板内工作。感谢您对此提供的任何帮助-我必须真正进行一些挖掘才能得出这个非常简单的答案。

# active-directory - Active Directory 多站点规划

> ID：10249813
> 
> 赞同：0
> 
> 时间：2012-04-20T16:16:34.003
> 
> 标签：active-directory, windows-server-2008, exchange-server

以下是我的计划的详细信息：

三个不同州的三个站点办公室。所有运行 pfsense IPsec VPN。1 个站点使用 Windows Server 2003 R2 DC，其他 2 个站点使用 Windows Server 2008 R2 DC。所有 3 个域控制器都是其自身的 DNS 服务器。

图片解释了我的场景。我想得到你的反馈？我需要对其进行规划，以便复制多个站点，并且如果其中一个 DC 出现故障或 VPN 服务崩溃，则其他站点 DC 会为用户请求提供服务。

[http://www.freeimagehosting.net/by5vk](http://www.freeimagehosting.net/by5vk)

这是我的想法。

降级所有DC。创建一个林和 3 个不同的域。使用 VPN 配置 Active Directory 站点和服务。允许 DS 在 IPSec 和 WAN 接口上从防火墙进行通信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:01:02.683

您不想要三个单独的域 - 这不符合您的要求。现在的设置（一个域，3 个 DC）将满足您的要求。确保 DC 可以通过 VPN 隧道进行复制，并且站点/子网拓扑配置为匹配。

# spring - 如何使用 Spring 连接需要身份验证的 MongoDB

> ID：10249816
> 
> 赞同：13
> 
> 时间：2012-04-20T16:16:43.003
> 
> 标签：spring, mongodb

我正在使用以下 Spring 配置来连接到 mongoDB

```
<bean id="mongoTemplate" class="org.springframework.data.document.mongodb.MongoTemplate">
        <constructor-arg name="mongo" ref="mongo"/>
        <constructor-arg name="databaseName" value="${mongodb.dbname}"/>
    </bean>

    <bean class="com.mongodb.MongoURI" id="mongoUri">
        <constructor-arg value="${mongodb.url}"  />
    </bean>

    <bean class="com.mongodb.Mongo" id="mongo">
        <constructor-arg ref="mongoUri" />
    </bean> 
```

在哪里`mongo.url=mongodb://<user>:<password>@<host>:27017`

但是我收到了一个身份验证错误。我的理解是 MongoUI 可以采用上述格式的 URL。

我知道 mongoTemplate 可以接受 userCredentials 对象，但是我需要先从 URL 中提取它们，我不确定如何在配置中执行此操作。

知道如何更改上面的配置以支持此假设 mongo.url 格式无法更改吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-23T14:12:43.443

使用 Spring Expression Language 找到了解决方案

```
<bean id="mongoTemplate" class="org.springframework.data.document.mongodb.MongoTemplate">
        <constructor-arg name="mongo" ref="mongo"/>
        <constructor-arg name="databaseName" value="${mongodb.dbname}"/>
        <constructor-arg name="userCredentials" ref="mongoCredentials"/>
    </bean>

    <bean id="mongoCredentials" class="org.springframework.data.authentication.UserCredentials">
        <property name="username" value="#{mongoURI.username}" />
        <property name="password" value="#{new java.lang.String(mongoURI.password)}" />
    </bean>

    <bean class="com.mongodb.MongoURI" id="mongoURI">
        <constructor-arg value="${mongodb.url}"  />
    </bean>

    <bean class="com.mongodb.Mongo" id="mongo">
        <constructor-arg ref="mongoURI" />
    </bean> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-04-30T15:58:00.750

如果要使用 java config 添加身份验证

```
@Configuration
@EnableMongoRepositories("path.to.your.repository")
public class MongoConfig extends AbstractMongoConfiguration
{
@Value("${mongodb.name}")
private String  dbName;

@Value("${mongodb.host}")
private String  host;

@Value("${mongodb.port}")
private Integer port;

@Value("${mongodb.username}")
private String  userName;

@Value("${mongodb.password}")
private String  password;

@Override
protected String getDatabaseName()
{
    return this.dbName;
}

@Override
public Mongo mongo() throws Exception
{
    return new MongoClient(this.host, this.port);
}

@Override
@Bean
public SimpleMongoDbFactory mongoDbFactory() throws Exception
{
    return new SimpleMongoDbFactory(mongo(), getDatabaseName());
}

@Override
@Bean
public MongoTemplate mongoTemplate() throws Exception
{
    final UserCredentials userCredentials = new UserCredentials(this.userName, this.password);

    final MongoTemplate mongoTemplate = new MongoTemplate(mongo(), getDatabaseName(), userCredentials);
    mongoTemplate.setWriteConcern(WriteConcern.SAFE);

    return mongoTemplate;
}

} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-07-20T12:27:12.460

为了更新 @Lealem Admassu 对 java config 的回答，他们在 Mongo 3 中更改了 API，现在建议使用 mongo's`MongoCredentials`而不是`UserCredentials`.

这里有一个如何获取 MongoClient 的简单示例：http: [//docs.spring.io/spring-data/mongodb/docs/current/reference/html/#mongo.mongo-3.authentication](http://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#mongo.mongo-3.authentication)

下一个代码可以模块化完成，但或多或​​少这对我有用（我需要一个 MongoTemplate）：

```
public MongoTemplate getMongoTemplate(String host, int port,
                                      String authenticationDB,
                                      String database,
                                      String user, char[] password)
        throws UnknownHostException {
    return new MongoTemplate(
            new SimpleMongoDbFactory(
                    new MongoClient(
                            new ServerAddress(host, port),
                            Collections.singletonList(
                                    MongoCredential.createCredential(
                                            user,
                                            authenticationDB,
                                            password
                                    )
                            )
                    ),
                    database
            )
    );
} 
```

# multithreading - Openmp线程发散？

> ID：10249817
> 
> 赞同：5
> 
> 时间：2012-04-20T16:16:47.433
> 
> 标签：multithreading, cuda, openmp

CUDA 中使用了术语线程发散；据我了解，这是一种分配不同线程来执行不同任务的情况，这会导致性能受到很大影响。

我想知道，在openmp中这样做会不会有类似的惩罚？例如，假设我有一个 6 核处理器和一个有 6 个线程的程序。如果我有一个条件让 3 个线程执行某个任务，然后让其他三个线程执行完全不同的任务，会不会对性能造成很大影响？我想本质上它有点像使用openmp来做MIMD。

基本上，我正在用 openmp 和 CUDA 编写程序。我希望两个线程运行 CUDA 内核，而其他剩余线程运行 C 代码。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:26:54.103

不，使用 OpenMP 的发散线程不会影响性能。这是 CUDA 中的一个问题，因为指令同时广播到一组内核的方式。当 OpenMP 线程以 CPU 内核为目标时，每个 CPU 内核都有自己独立的一组指令要遵循，并且它的运行方式与任何其他单线程程序一样。

如果您在线程分歧后有同步障碍，您可能会看到您的一些内核未被充分利用，因为这将迫使较快的线程等待较慢的线程赶上来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:27:16.330

在谈到 CPU 并行性时，使用某种线程设计模式并不会影响内在的性能。至少在理论上不是。

我看到的唯一问题是，由于线程正在做不同的事情，可能有不同的完成时间，一些线程在完成工作后可能会闲置，等待其他线程完成更长的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T13:40:12.833

openmp 没有这种问题，因为每个 openmp 线程都有自己的 PC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T04:58:00.407

CUDA 中的术语线程发散是指不是一个块的所有线程都评估具有相同结果的条件的情况。据说这样的线程是发散的。如果发散线程在同一个扭曲中，那么这些线程可能会连续执行工作，从而导致性能损失。

不过，我不确定 OpenMP 是否有同样的问题。当不同的线程执行不同的工作时，运行时可能会使用负载平衡，但这并不一定会导致工作序列化。

# java - java : 根据创建日期对文件进行排序

> ID：10249822
> 
> 赞同：2
> 
> 时间：2012-04-20T16:16:59.863
> 
> 标签：java

我正在尝试根据创建日期读取最新的 10 个文件。

我尝试使用此代码，但它不起作用，我的意思是，当我添加新文件时，它不会在输出中显示新文件名。

```
import java.io.File;
import java.util.Arrays;
import java.util.Comparator;

public class Main {
    public static void main(String[] args) {
        File inboxDir = new File("D:\\SPOTO");
        File[] files = inboxDir.listFiles();
        Arrays.sort( files, new Comparator()
        {
        public int compare(Object o1, Object o2) {
        return new Long(((File)o1).lastModified()).compareTo(new Long(((File) o2).lastModified()));
        }

        });

        for(int i=0;i<10;i++)
        {
            System.out.println(files[i].getName());
        }

    }
} 
```

我什至尝试使用 apache commons io，但这也不起作用（意味着在该目录中创建新文件时不会显示新文件）

**这是我的 Apache commons io 版本**

```
import org.apache.commons.io.comparator.LastModifiedFileComparator;

import java.io.File;
import java.util.Arrays;

public class Main {
    public static void main(String[] args) {
        File dir = new File("c:\\");
        File[] files = dir.listFiles();

        Arrays.sort(files, LastModifiedFileComparator.LASTMODIFIED_COMPARATOR);
        for (int i = 0; i < files.length; i++) {
            File file = files[i];
            System.out.printf("File %s - %2$tm %2$te,%2$tY%n= ", file.getName(),
                    file.lastModified());
        }

        Arrays.sort(files, LastModifiedFileComparator.LASTMODIFIED_REVERSE);
        for (int i = 0; i < files.length; i++) {
            File file = files[i];
            System.out.printf("File %s - %2$tm %2$te,%2$tY%n= ", file.getName(),
                    file.lastModified());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:30:04.450

尝试翻转比较顺序：

```
return new Long(((File)o2).lastModified()).compareTo(new Long(((File) o1).lastModified())); 
```

这适用于我刚才在本地测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:29:59.067

至少在常规 Java 版本中，您以错误的（升序）顺序比较文件。我将结果乘以 -1，我首先看到的是最新文件：

```
return -1* (new Long(((File)o1).lastModified()).compareTo(new Long(((File) o2).lastModified()))); 
```

对于时间戳，较大的时间戳对应于较新的文件。

# google-app-engine - 移动网络应用部署

> ID：10249824
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:17:09.963
> 
> 标签：google-app-engine, objectify

我想在移动设备上创建我的应用程序的受限版本。
我的应用位于 www.accountingguru.in（appid：accountingguru-india.appspot.com）。它正在使用 Servlets/GWT/Objectify 3.1 我正在研究如何推进有限移动应用程序的设计/开发选择

什么是移动用户体验的好网址。

1.  www.accountingguru.in/mobile
2.  mobile.accountingguru.in

-阿斯瓦特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T12:36:12.710

你可以有相同的网址。

使用延迟绑定根据user.agent实现不同的UI

1.  定义一个模块 .gwt.xml 来检测 user.agent
2.  在您的应用程序模块上，使用返回值来选择适当的实现。

查看 gwt 中的示例项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T18:18:45.427

1.  如果您正确设置域名（和 GAE 映射）并使用一些 url 重写，则两者都可以。从身份验证的角度来看，第一个选项可能更容易。

2.  如果您使用 GWT/GAE，如果您想拥有一个 GAE 实例，则它需要是一个通用项目。实际上，您不能拥有两个不同的 GWT 项目并将它们上传到同一个 GAE 实例。就 GWT 而言 - 您可以有两个单独的入口点：一个用于桌面，另一个用于移动浏览器。

# c - 如何处理大型二维数组

> ID：10249829
> 
> 赞同：3
> 
> 时间：2012-04-20T16:17:33.397
> 
> 标签：c, multidimensional-array

我有一个大小为 5428x5428 大小的二维数组。它是一个对称数组。但是在编译时它给了我一个错误，说数组大小太大。谁能给我一个方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:46:03.193

这个数组对于程序堆栈内存来说太大了——那是你的错误。

```
int main()
{
    double arr[5428][5428]; // 8bytes*5428*5428 = 224MB

    // ...
    // use arr[y][x]
    // ...

    // no memory freeing needed
} 
```

使用动态数组分配：

```
int main()
{
    int i;
    double ** arr;

    arr = (double**)malloc(sizeof(double*)*5428);
    for (i = 0; i < 5428; i++)
        arr[i] = (double*)malloc(sizeof(double)*5428);

    // ...
    // use arr[y][x]
    // ...

    for (i = 0; i < 5428; i++)
        free(arr[i]);
    free(arr);
} 
```

或分配大小的普通数组`MxN`并使用`ptr[y*width+x]`

```
int main()
{
    double * arr;
    arr = (double*)malloc(sizeof(double)*5428*5428);

    // ...
    // use arr[y*5428 + x]
    // ...

    free(arr);
} 
```

或使用组合方法：

```
int main()
{
    int i;
    double * arr[5428];  // sizeof(double*)*5428 = 20Kb of stack for x86
    for(i = 0; i < 5428; i++)
        arr[i] = (double)malloc(sizeof(double)*5428);

    // ...
    // use arr[y][x]
    // ...

    for(i = 0; i < 5428; i++)
        free(arr[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:59:05.113

当您创建局部变量时，它们会进入堆栈，堆栈的大小是有限的。你正在突破这个限制。

您希望您的阵列在堆上，这是您系统拥有的所有虚拟内存，即现代系统上的 gigs 和 gigs。有两种方法可以管理它。一种是动态分配数组，如 k06a 的回答；使用 malloc() 或特定于平台的分配器函数（例如 Windows 上的 GlobalAlloc()）。第二种是将数组声明为全局或模块静态变量，在任何函数之外。

使用全局或静态的缺点是该内存将在程序的整个生命周期内分配。此外，原则上几乎每个人都讨厌全局变量。另一方面，您可以使用二维数组语法“array[x][y]”等来访问数组元素...比使用 array[x + y * width] 更容易，而且您不需要不必记住你是应该做 "x + y * width" 还是 "x * height + y" 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:39:25.803

当数组变大时，有许多解决方案。对你有好处的一个在很大程度上取决于你实际在做什么。

我将列出一些让您思考：

1.  购买更多内存。

2.  将数组从堆栈移动到堆。

    栈比堆有更严格的大小限制。

3.  模拟数组的一部分（你说你的是对称的，所以只有不到 1/2 的数据是多余的）。

    在您的情况下，数组是对称的，因此不要使用数组，而是使用“模拟数组”

    `int getArray(array, col, row);`
    `void setArray(array, col, row, value);`

    其中 array 是一个数据结构，它只保存左下半部分和对角线。getArray(..) 然后确定列是否大于行，如果是，则返回（注意颠倒的条目`getArray(array, row, col);` 这利用了数组的对称属性，而无需实际保持对称边。

4.  使用“仅包含值的项”的列表（或树或哈希表）模拟数组

    这对于稀疏数组非常有效，因为您不再需要分配内存来保存大量零（或空）值。如果有人“查找”一个未设置的值，您的代码“发现”没有为该条目设置值，然后返回“零”或空值，而实际上它没有存储在您的数组中。

同样没有更多细节，很难知道哪种解决方案是最好的方法。

# java - 从数据库用Java实现图

> ID：10249830
> 
> 赞同：1
> 
> 时间：2012-04-20T16:17:33.550
> 
> 标签：java

我有两张桌子：

```
 Users (id, name, lastname) 
    Friends (id1, id2) 
```

鉴于这 2 个表，我需要能够找到 2 个用户之间的距离 d(id1,id2)

我定义了一个用户类，它包含表中的每个用户属性。

我需要建立一个图表。我的图表数据结构是

```
 Map<User, Set<User>> 
```

将用户映射到他的一组朋友。我如何构建图表？我在数据库中查询了数据库中所有用户的 ID。我有一个

```
 int[] userids 
```

然后对于这个数组中的每个 int：

（1）我建立一个用户对象，在数据库中获取该用户的属性

(2) 我在数据库中查询 Friends 表以获取该用户的朋友的 ID：

```
 int [] friends 
```

(3) 对于这个朋友数组中的每个 int，我构建了一个用户对象，在数据库中获取该用户的属性并将其添加到

```
 Set<User> friends = new Set<User>(); 
```

问题 1：任何想法如何更好地做到这一点？考虑到我有 500 个用户和 Friends 表中有 20000 个条目，这需要很长时间......

这里的大问题是，当数据库中的 2 个用户“相同”时，他们在我的图中的不同对象中被引用！

这弄乱了我的距离算法。我从用户 u 开始，获取他的 Friends {f1,f2} ，当我想使用 graph.get(f1) 和 graph.get(f2) 获取朋友的朋友时，我得到 null （原因在我的问题中说明，即在许多不同的用户对象中的 1 个 db 用户）

我需要找到一种方法来构建我的图表，以便在堆中的一个且唯一的用户对象中引用 1 个给定用户说 (1, John, Doe) ...

问题2：如何？？

非常感谢

[帮助 Java Graph 实现](https://stackoverflow.com/questions/7329427/help-with-java-graph-implementation)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:04:29.740

一次读取一个用户会很慢，这是到数据库的大量往返。如果表上没有索引，它会特别慢`Friends`。

您最好从数据库中获取所有数据并自己用 Java 构建图形。

```
select UserId, ... from Users; 
```

正如您现在所做的那样，`User`为每个用户构建一个。您需要创建一个`Map`from `userId`to`User`以在步骤 2 中使用（这样您就不会`User`为同一个对象获得多个对象`userId`）。

```
select id1, id2 from Friends; 
```

然后查找`Map`上面的两个id，然后分别添加`User`到对方`User`的出边集。

# php - 如何在开发服务器上使用 SVN 中的分支和主干？

> ID：10249831
> 
> 赞同：1
> 
> 时间：2012-04-20T16:17:34.213
> 
> 标签：php, svn, netbeans, tortoisesvn

我使用 NetBeans 在 PHP 中进行开发。修改由 NetBeans 直接上传到我机器上的虚拟化 LAMP 开发服务器。

我想分支一些发展。

问题是只有中继被发送到服务器。

我使用经典结构：

```
{svnroot}/trunk 
{svnroot}/branches 
{svnroot}/tags 
```

如何在不进行疯狂的分支/主干交换（所有可能的冲突）的情况下测试分支？

*   有没有 htaccess 配置的解决方案？
*   我应该以不同的方式使用 SVN 吗？
*   我应该以不同的方式使用 NetBeans 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:25:56.837

大多数 SVN 设置都有一些顶级目录

```
{svnroot}/trunk
{svnroot}/branches
{svnroot}/tags 
```

如果您缺少“分支”顶级目录，请添加它。然后使用`svn copy`从“主干”中复制所有内容。

如果您的 Web 服务器以这样一种方式提取代码，即您的“分支”目录被拉入 Web 服务器，那么这就是与您的 Web 服务器有关的部署问题，任何设置它的人都需要修复它。

有时，一个人通过`svn checkout`直接在 Web 服务器中编写代码来回避发布计划。虽然这适用于非常有限的案例，但它会降低您处理未来事件的能力，而无需迁移到更复杂的发布计划。如果你的环境倾向于做这样的事情，你可以通过选择性地只检查“主干”的子内容来继续遵循你的计划，或者你可以迁移到你的版本的适当“构建”，然后通过“部署计划”。

如果您缺少“主干”目录，则在尝试任何操作之前，您可能必须创建“主干”目录并将所有当前内容移入其中。这意味着所有开发都需要从“trunk”子目录而不是 {svnroot} 目录签出。这是通过扩展您的 URL（在末尾添加“/trunk”）来完成的。

我希望这能让你沿着正确的道路思考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:45:06.140

您可以在 Web 服务器上签出所有内容，并使用符号链接（或与 Windows 服务器的连接点 - 请参阅www.sysinernals.com 中的[Junction.exe](http://technet.microsoft.com/en-us/sysinternals/bb896768)）在测试/生产环境之间切换。或者是的，您可以使用 .htaccess 更改您的 Web 根目录指向的位置。正如其他人所说，拥有单独的测试/生产服务器通常是个好主意。

# macos - 压缩的 CGImage 与 CGImageDestination 在获取字节后被截断

> ID：10249834
> 
> 赞同：0
> 
> 时间：2012-04-20T16:17:43.823
> 
> 标签：macos, core-foundation, cgimage, cfdata

我想从 CGImageRef 获取压缩数据以通过网络连接发送它。为此，我使用 CGImageDestinationRef (CGImageDestinationCreateWithData)。

将数据从 CFDataRef 对象中拉出后，图像在底部丢失了几行。

这是我所做的（为阅读目的而清理......）：

```
CFImageRef image = getTheImageRefIWant();

CFMutableDataRef pngData = CFDataCreateMutable (kCFAllocatorDefault, 0);    

CGImageDestinationRef dataDest = CGImageDestinationCreateWithData (pngData, kUTTypePNG, 1, NULL);

CGImageDestinationAddImage (dataDest, image, NULL); //also tried this with options...

CGImageDestinationFinalize (dataDest);

CFIndex len = CFDataGetLength(pngData);

//copy data
unsigned char* m_image = malloc(len);
CFDataGetBytes (pngData, CFRangeMake(0,len), m_image);

//save data - for testing purpose
FILE *file = fopen("/path/test.png", "wb");
fwrite(m_image, 1, len, file);

//adding header and stuff - skipped here...

//send data
send(sockfd, m_image, len, 0); 
```

如果我使用 CFData 对象作为 NSData 对象并将其保存到磁盘，它确实可以工作：

```
NSData *data = [(NSData *)pngData autorelease];
[data writeToFile:@"/path/test.png" atomically:YES]; 
```

但如果是使用 NSDatas 字节方法，它是相同的（截断图像）：

```
NSUInteger len = [data length];
m_image = malloc(len);
memcpy(m_image, (unsigned char*)[data bytes], len); 
```

似乎 CFData 对象中的数据似乎没问题。但是如何正确获取字节？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:29:10.800

写完文件后你有`fflush()`ed 或d 吗？`fclose()`您的数据可能只是缓冲在内存中。

# c - 与 C 中具有结构化节点的链表相关联的奇怪错误消息

> ID：10249836
> 
> 赞同：0
> 
> 时间：2012-04-20T16:17:47.970
> 
> 标签：c, visual-c++, linked-list, structure

这假设是一个简单的链接列表问题，但是当我将 input_info() 添加到 main() 函数时，MSVC cl 编译器给了我这样的错误消息：

```
syntax error : missing ';' before 'type'
error C2065: 'first_ptr' : undeclared identifier
warning C4047: 'function' : 'struct linked_list *' differs in levels of indirection from 'int '
warning C4024: 'print_list' : different types for formal and actual parameter 1 
```

我不明白为什么编译器会向我显示这样的错误...请让我了解为什么 MSVC 6.0 编译器会给我这样的错误消息。

```
/*
*
*     this program is a simple link list which will have add(), 
*   remove(), find(), and tihs link list will contains the student 
*   information. 
*         
*/

#include <stdlib.h>
#include <stdio.h>

//this ppl structure student holds student info
typedef struct 
{

    char *name;
    int height;
    int weight;

}ppl;

//this structure is the link list structure
typedef struct linked_list
{
    ppl data;
    struct linked_list *next_ptr;
} linked_list;

//this function will print the link list in a reversed order
void print_list(linked_list *a)
{

    linked_list *llp=a;
    while (llp!=NULL)
    {
    printf("name: %s, height: %d, weight: %d \n",llp->data.name,llp->data.height,llp->data.weight);
        llp=llp->next_ptr;

    }
}

//this function will add ppl info to the link list
void add_list(ppl a, linked_list **first_ptr)
{
    //new node ptr
    linked_list *new_node_ptr;
    //create a structure for the item
    new_node_ptr=malloc(sizeof(linked_list));

    //store the item in the new element
    new_node_ptr->data=a;
    //make the first element of the list point to the new element
    new_node_ptr->next_ptr=*first_ptr;

    //the new lement is now the first element
    *first_ptr=new_node_ptr;
 }

void  input_info(void)
{
    printf("Please input the student info!\n");
}

int main()
{   
    ppl a={"Bla",125,11};

    input_info();
    //first node ptr
    struct linked_list *first_ptr=NULL;

    //add_list(a, &first_ptr);
    printf("name: %s, height: %d, weight: %d \n",a.name,a.height,a.weight);

    //print link list
    print_list(first_ptr);  
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:40:25.063

改成

```
ppl a={"Bla",125,11};
//first node ptr
struct linked_list *first_ptr=NULL;
input_info(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:40:57.353

由于您在严格遵循 C89 的 MSVC 中进行编译，因此不能混合声明和代码，所以

```
input_info();
struct linked_list *first_ptr=NULL; 
```

不起作用，因为在`input_info();`编译器看到一个类型之后，它不应该，因为你不能在那里声明任何东西。只需将其更改为：

```
struct linked_list *first_ptr=NULL;
input_info(); 
```

一切都应该工作。

# php - 谁能解释这个加扰功能是如何工作的？

> ID：10249842
> 
> 赞同：0
> 
> 时间：2012-04-20T16:18:19.500
> 
> 标签：php

我正在使用一个取自[Corrupt](https://github.com/recyclism/Corrupt)的函数（一个基于 Web 的软件，用于使用 jpeg 图像获得“故障”效果）。这个函数可以在第23 行的[损坏.php](https://github.com/recyclism/Corrupt/blob/master/corrupt.php)文件中找到。目前它还没有使文件出现足够的故障。我制作[这些图像](http://imgur.com/FaRPC)是为了向您展示我希望图像的外观。这是通过在文本编辑器中打开 jpeg 并剪切某些行并将它们粘贴到其他位置来制作的。

我希望这个函数做类似的事情，但目前它没有。有任何想法吗？有没有更好的方法可以做到这一点？

```
function scramble($content, $size) {
    $sStart = 10;
    $sEnd = $size-1;
    $nReplacements = rand(1, 30);

    for($i = 0; $i < $nReplacements; $i++) {
        $PosA = rand($sStart, $sEnd);
        $PosB = rand($sStart, $sEnd);

        $tmp = $content[$PosA];
        $content[$PosA] = $content[$PosB];
        $content[$PosB] = $tmp;
    }

    return($content);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:21:11.143

该函数在数组元素之间进行随机交换。交换次数是从 1 到 30 的随机生成的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:23:54.613

它在从图像加载的数据数组中随机交换信息。这会导致有效图像在某些扇区中带有无效的图像信息。此外，图像文件有时会在文件的前端/末尾包含附加信息；这似乎没有考虑到这一点，并且也可能破坏该信息。

要增加掉期的数量，您需要增加替换的数量。您特别感兴趣的代码是`rand(1, 30);`；如果您仍然没有获得预期的效果，我建议先增加最小加扰量，然后再增加上限。

# java - 产生更多线程

> ID：10249852
> 
> 赞同：1
> 
> 时间：2012-04-20T16:19:04.880
> 
> 标签：java

我开发了一个程序，其中线程 A 等待线程 B 完成它的任务，当线程 B 完成它的任务时，它使 notfiy() 到线程 A 继续前进..下面是代码..

```
 class ThreadA {
 public static void main(String [] args) {
 ThreadB b = new ThreadB();
 b.start();

 synchronized(b) {
 try {
 System.out.println("Waiting for b to complete...");
 b.wait();
} catch (InterruptedException e) {}
System.out.println("Total is: " + b.totals);
 }
}
}

class ThreadB extends Thread {
public  int totals;

 public void run() {
     synchronized(this) { //instance level lock
     for(int i=0;i<100;i++) {
      totals += i;
      }
      notify();
      }
      }

} 
```

现在我想说还有 3 个线程正在等待线程 b，所以请告诉我如何再生成 3 个线程，就像线程 A 正在等待一样，请告知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:23:12.760

使用[ExecutorService](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)它有一个方法[invokeAll()](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#invokeAll%28java.util.Collection,%20long,%20java.util.concurrent.TimeUnit%29)。你可以提交你所有的 ThreadB 并持有一个未来的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:29:11.060

您当前的代码实际上包含可能的死锁，因为您`start()`首先是 threadB 并且它`notify()`在其`run()`. 这`notify()`可以`wait()`在 main 之前调用。如果发生这种情况，您的 threadB 将永远等待。

要启动更多 ThreadB，您只需要创建更多实例。

```
ThreadB threadBs = new ThreadB[3];
for (ThreadB b : threadBs) {
    b = new ThreadB();
    b.start();
} 
```

但是，我会建议实现 Runnable 接口，而不是仅仅扩展 Thread 类。

# ruby - 由于错误，Ruby net/ftp 代码无法 PUT 文件

> ID：10249853
> 
> 赞同：1
> 
> 时间：2012-04-20T16:19:09.517
> 
> 标签：ruby, ftp

我有这个失败的基本代码：

```
 ftpconfighash = open("#{RAILS_ROOT}/config/ftp.yml") {|f| YAML.load(f) }
  config = ftpconfighash[12345]

  ftp = Net::FTP::new(config["host"])
  ftp.login(config["username"], config["password"])

  dir += "/" unless config["dir"].blank? or config["dir"].ends_with?("/")
  remotename = File.basename(filename)
  remotename = dir + remotename unless dir.blank?

  if File.binary?(filename)
    puts "PUTting binary file #{filename} to #{remotename}"
    ftp.putbinaryfile(filename, remotename)
  else
    puts "PUTting ASCII file #{filename} to #{remotename}"
    ftp.puttextfile(filename, remotename)
  end
  ftp.close 
```

我已经验证我可以 ftp 到服务器并手动 PUT 一个文件。我还使用 irb 逐行浏览代码。我正在使用 XML 文件作为测试，因此“ftp.puttextfile”是失败的行。这是错误：

```
Net::FTPPermError: 500 Invalid PORT Command. 
```

我不明白。我已经验证我确实可以放置这个文件，但是我不能用这个代码来做。

我将 ftp.debug_mode 设置为 true，这是 ftp.puttextfile 命令的输出：

```
put: TYPE A
get: 200 Type set to A.
put: PORT 10,0,1,20,198,170
get: 500 Invalid PORT Command.
Net::FTPPermError: 500 Invalid PORT Command.

from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:243:in `getresp'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:251:in `voidresp'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:274:in `voidcmd'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/monitor.rb:242:in `synchronize'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:272:in `voidcmd'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:287:in `sendport'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:295:in `makeport'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:328:in `transfercmd'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:424:in `retrlines'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/monitor.rb:242:in `synchronize'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:422:in `retrlines'
from /Users/me/.rvm/rubies/ruby-1.8.7-p352/lib/ruby/1.8/net/ftp.rb:631:in `list'
from (irb):42 
```

看起来 Ruby 正在尝试运行 FTP 服务器不理解的命令：

```
PORT 10,0,1,20,198,170 
```

有什么方法可以抑制该命令，还是我错过了其他东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:21:48.127

尝试使用被动 ftp：

```
ftp = Net::FTP::new(config["host"])
ftp.login(config["username"], config["password"])

ftp.passive = true 
```

# eclipse - 如何使用特定的 jdk（而不是 JDK_HOME）运行 eclipse

> ID：10249857
> 
> 赞同：5
> 
> 时间：2012-04-20T16:19:18.953
> 
> 标签：eclipse

如何在 Linux 上使用特定的 JDK 而不是 JDK_HOME 指向的 JDK 运行 Eclipse？

我读了这个 [http://wiki.eclipse.org/Equinox_Launcher#Finding_a_VM.2C_Using_JNI_Invocation_or_Executing_Java](http://wiki.eclipse.org/Equinox_Launcher#Finding_a_VM.2C_Using_JNI_Invocation_or_Executing_Java)

我已经把

```
-vm /home/michael/Programs/jdk1.7.0_03/bin 
```

在我的 eclipse.ini 文件中。

但是当我运行 Eclipse 时，它​​仍然使用我的 JDK_HOME 中的 JDK。我通过“关于 Eclipse”和配置详细信息选项卡进行检查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:34:07.603

我的`eclipse.ini`条目如下所示：

```
-vm  
C:/P/Java/jdk_1_7_0_02/bin/javaw.exe 
```

# jquery - 来自服务器的 Wordpress 响应“0”

> ID：10249858
> 
> 赞同：1
> 
> 时间：2012-04-20T16:19:27.820
> 
> 标签：jquery, ajax, wordpress, plugins

我使用[http://www.garyc40.com/2010/03/5-tips-for-using-ajax-in-wordpress/](http://www.garyc40.com/2010/03/5-tips-for-using-ajax-in-wordpress/)作为指南来创建一个表单供用户填写信息，然后创建一个帖子在自定义帖子类型中。当我收到一长串警报时，我总是从服务器得到“0”的响应。有什么帮助吗？

**我的插件文件php：**

```
function ajaxurl() {
wp_enqueue_script( 'my-ajax-request', plugin_dir_url( __FILE__ ) . 'js/ajax.js', array( 'jquery' ) );
    wp_localize_script( 'my-ajax-request', 'MyAjax', array(
    // URL to wp-admin/admin-ajax.php to process the request
    'ajaxurl'          => admin_url( 'admin-ajax.php' ),

    // generate a nonce with a unique ID "myajax-post-comment-nonce"
    // so that you can check it later when an AJAX request is sent
    'postCommentNonce' => wp_create_nonce( 'myajax-post-comment-nonce' ),
    )
);
}
add_action('wp_head', 'ajaxurl');
// if both logged in and not logged in users can send this AJAX request,
// add both of these actions, otherwise add only the appropriate one
add_action( 'wp_ajax_nopriv_myajax-submit', 'myajax_submit' );
add_action( 'wp_ajax_myajax-submit', 'myajax_submit' );

function myajax_submit() {
    $nonce = $_POST['postCommentNonce'];

    // check to see if the submitted nonce matches with the
    // generated nonce we created earlier
    if ( ! wp_verify_nonce( $nonce, 'myajax-post-comment-nonce' ) )
        die ( 'Busted!');

    // get the submitted parameters
    $postID = $_POST['postID'];   

    if ( isset($_post['post_ID']) ) {

    };

    //Create Post from post data
    $newpost = array(
        'post_title' => $_POST['title'],
        'post_author' => $_POST['author'],
        'post_type' => 'assets',
        'post_content' => $_POST['description'],
        'post_category' => $_POST['category']

    );

    //Actually Create the post
    $post_id = wp_insert_post($newpost);

    //now that we have an ID we can add the post meta
    update_post_meta($post_id ,'key', $_POST['key']);

update_post_meta($post_id ,'assetname', $_POST['assetname']);

update_post_meta($post_id ,'assetadd1', $_POST['assetadd1']);
update_post_meta($post_id ,'assetadd2', $_POST['assetadd2']);
update_post_meta($post_id ,'assetcity', $_POST['assetcity']); 
update_post_meta($post_id ,'assetstate', $_POST['assetstate']);    
update_post_meta($post_id ,'assetzipcode', $_POST['assetzipcode']);
update_post_meta($post_id ,'assetlocation', $_POST['assetlocation']);

    // generate the response
    $response = json_encode( array( 'success' => true ) );

    // response output
    header( "Content-Type: application/json" );
    echo $response;
    die();

    // IMPORTANT: don't forget to "exit"
    exit;
} 
```

**我的 jQuery：** 出于某种原因，除非我添加 $(document).ready 片段，否则 jquery 不会触发

```
$(document).ready(function () {

jQuery('#myForm').submit(function() {

data = $(this).serialize();
data = data + "&postCommentNonce=" + MyAjax.postCommentNonce + "&action=myajax_submit";
alert( data ); 
```

到目前为止，一切正常。我从表单输入字段中得到一长串输入

```
jQuery.post(
    MyAjax.ajaxurl,
    data,
    function( response ) {
        alert( response );
    }
);

return false;

});
}); 
```

毕竟，我每次仍然只能从服务器收到“0”的响应。对此的任何帮助将不胜感激。

# c++ - 无法从 std::basic_string 转换为 int Visual Studio C++

> ID：10249859
> 
> 赞同：0
> 
> 时间：2012-04-20T16:19:29.203
> 
> 标签：c++, visual-studio-2010, visual-c++, c++-cli, type-conversion

我写了一个小数独程序，我想这样做，所以每次你按下某个按钮时，该按钮上的文本是前一个数字加一。

因此，例如，我有一个显示“1”的大按钮，然后单击它，如果再次单击它，它将显示“2”然后显示“3”，依此类推，直到“9”。

起初我认为这很简单，我用这段代码调用了一个计数为 9 的整数，一个等于按钮文本的字符串，然后我尝试将 int 转换为字符串，但失败了，它给了我下面的错误。这是代码：

```
int s = 0;
String^ mystr = a0->Text;
std::stringstream out;
out << s;
s = out.str(); //this is the error apparently.
s++; 
```

这是错误：

> 错误 C2440：“=”：无法从“std::basic_string<_Elem,_Traits,_Ax>”转换为“int”

我尝试在 MSDN 上搜索该错误，但它与我的不同，而且我离开页面时比输入时更加混乱。

另外作为参考，我在 Windows XP 和 Visual Studio 2010 C++ 中使用 Windows 窗体应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:28:14.030

如果您想使用 转换或`std::string`to `char*`，它可能如下所示：`int``std::stringstream`

```
int s = 0;
std::string myStr("7");
std::stringstream out;
out << myStr;
out >> s; 
```

或者您可以`stringstream`直接使用`myStr`which 生成相同的结果来构造它：

```
std::stringstream out(myStr);
out >> s; 
```

如果您想转换`System::String^`为`std::string`，它可能如下所示：

```
#include <msclr\marshal_cppstd.h>
...
System::String^ clrString = "7";
std::string myStr = msclr::interop::marshal_as<std::string>(clrString); 
```

尽管正如[Ben Voigt](https://stackoverflow.com/users/103167/ben-voigt)指出的那样：当您从 . 开始时`System::String^`，您应该使用 .NET Framework 中的某些函数来转换它。它也可能看起来像这样：

```
System::String^ clrString = "7";
int i = System::Int32::Parse(clrString); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:57:40.727

由于您从 开始`String^`，因此您需要以下内容：

```
int i;
if (System::Int32::TryParse(a0->Text, i)) {
    ++i;
    a0->Text = i.ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:21:17.853

s 是类型`int`。`str()`返回一个`string`。您不能将字符串分配给 int。使用不同的变量来存储字符串。

这是一些可能的代码（尽管它不会编译）

```
string text = GetButtonText(); //get button text
stringstream ss (text); //create stringstream based on that
int s; 
ss >> s; //format string as int and store into s
++s; //increment
ss << s; //store back into stringstream
text = ss.str(); //get string of that
SetButtonText (text); //set button text to the string 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:30:06.680

在 C++ 中有很多方法可以将字符串转换为 int ——现代习惯用法可能是安装 boost 库并使用 boost::lexical_cast。

但是，您的问题表明您对 C++ 没有很好的掌握。如果您的目的是学习更多关于 C++ 的知识，那么在尝试像数独这样复杂的东西之前，您可能想尝试许多更简单的教程之一。

如果您只想使用 Windows 窗体构建数独，我建议您放弃 C++ 并查看 C# 或 VB.Net，对于没有经验的程序员来说，它们的陷阱要少得多。

# asp.net-mvc - 如何使用结构图设置属性注入？

> ID：10249863
> 
> 赞同：0
> 
> 时间：2012-04-20T16:19:40.530
> 
> 标签：asp.net-mvc, dependency-injection, structuremap

我有一个 MVC 属性，我需要使用属性注入与构造函数注入。我正在使用结构映射通过 xml 配置进行注入。该属性永远不会被设置，有人看到我做错了什么吗？谢谢

```
 public class RequirePermissionAttribute: AuthorizeAttribute, IAuthorizationFilter
{
    #region Fields

    private readonly IPermissionService _permissionService;

    #endregion

    #region Properties

    [SetterProperty]
    public IPermissionService PermissionService
    {
        get
        { 
            return _permissionService; 
        }
        set
        {
            value = _permissionService;
        }
    } 
```

……

配置文件

```
<DefaultInstance PluggedType="Service.Permissions.PermissionService,Service" PluginType="Service.Permissions.IPermissionService,Service" Scope="HttpContext" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:40:15.780

我猜这`RequirePermissionAttribute` **不是由 StructureMap 解决的，因此它可以设置您的属性**。属性是编译时间，因此您必须采取额外的步骤来启用它。

我不知道您是使用 ControllerFactory 还是 DependencyResolver 来启用 D​​I，但我曾经使用 ControllerFactory 来提供`ActionInvoker`属性的实现。

你可以在这里找到一些信息：http: [//www.jeremyskinner.co.uk/2008/11/08/dependency-injection-with-aspnet-mvc-action-filters/](http://www.jeremyskinner.co.uk/2008/11/08/dependency-injection-with-aspnet-mvc-action-filters/)。它很旧，但仍然适用。

# php - 名称的正则表达式

> ID：10249865
> 
> 赞同：-3
> 
> 时间：2012-04-20T16:19:59.180
> 
> 标签：php, regex, preg-match

我需要一个正则表达式来匹配帐户登录。

我想匹配的符号：

> ```
> Test
> testtest
> Special Char Testó
> Special Char Test
> Test Test
> Hai hai
> Test-ó
> Test.ó
> Testó
> Another Test 12345
> Another.Test.12345 
> ```

我找到的最接近的正则表达式是：`^(?=[^ ])[a-zA-Z0-9 +&-]+(?<=\S)$`. 但它仍然与上述所有示例都不匹配。

实时预览：[http ://regexr.com?30ncg](http://regexr.com?30ncg)

以下是它不应该匹配的所有符号：

```
Test?
Test$
Test= (and all special characters like those @#$%^&*=).
Test[]
Test>
Test< 
```

*   所以它基本上可以找到，但它不匹配单词 like `Another.Test.12345`or `Special Char Testó`。

我希望它只匹配一个单词字符（包括特殊字符，如`ółążźćęą`and `äöüß`）、数字、点和空格。

我一直在搜索很多，但在上面给出的示例中没有找到比这个更好的正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:30:34.570

如果您只想匹配您在问题中列出的字符，那么您应该使用这个正则表达式：

```
/(?:\A|(?<=[^a-zA-Z0-9\+\&\-ółążźćęąäöüß\.\s]))([a-zA-Z0-9\+\&\-ółążźćęąäöüß\.\s]+)(?:(?=[^a-zA-Z0-9\+\&\-ółążźćęąäöüß\.\s])|\z)/ 
```

* * *

但是，由于这个问题对我（以及许多其他用户）来说有点不清楚，我建议您使用一个匹配所有“字母类”单码 unicode 字符和一些特殊字符的正则表达式。这样的正则表达式将是：

```
/(?:\A|(?<=[^\p{L}\+\-\&\.\s]))([\p{L}\+\-\&\.\s]+)(?:(?=[^\p{L}\+\-\&\.\s])|\z)/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:41:47.913

**[注意]** 在发布此内容之前，我没有阅读您的编辑。

我假设您使用的是 PHP。这对我有用：

```
$a = 'Test
testtest
Special Char TestóááÓ
Special Char Testß
Test Test
Hai hai
Test-ó
Test.ó
Testó
Another Test 12345
Another.Test.12345';

preg_match_all('/^(?=[^ ])[\w \.-\p{L}]+$/m', $a, $ms);

var_dump($ms); 
```

它匹配所有行。[将匹配在http://php.net/manual/en/regexp.reference.unicode.php](http://php.net/manual/en/regexp.reference.unicode.php)`\p{L}`上读取的 unicode 字符

# html - 在相对 div 中居中文本，没有大小

> ID：10249872
> 
> 赞同：1
> 
> 时间：2012-04-20T16:20:48.423
> 
> 标签：html, css, positioning, css-position, variable-length

我有以下（简化的）HTML结构：

```
<table>
  <tr>
    <td>
      <div class="PromptContainer">
        <span class="Prompt">Prompt text</span>
      </div>
      <input type="text" name="..."/>
    </td>
  </tr>
</table> 
```

和 CSS：

```
.PromptContainer{
   width: 0;
   height: 0;
   position: relative;
   margin: 0 auto;
}

.Prompt{
   bottom: 0;
   padding-left: 0;
   white-space: nowrap;
   position: absolute;
} 
```

我想将跨度元素居中于输入元素。请注意，由于边缘对齐规则（.Prompt 元素可以与输入元素的任何边缘对齐），我无法更改 .PromptContainer 的大小。span 元素内的文本长度可变，可能比输入元素的宽度长。我不能使用 javascript 来执行此任务，因为在我的情况下它太无效了（大量此类元素）。

**编辑：** 图像可视化我所拥有的和我想要实现的可在此处获得：![在此处输入图像描述](../Images/ead09acf211d9c76818f0ba7eeb6e661.png)

**编辑2：** 让我描述这个问题的目的。我们正在为用更旧的技术（作为 Windows 应用程序）编写的巨型旧应用程序编写新的基于 Web 的运行时。我们已经创建了从这个应用程序的源代码到我们的新环境（ASP.NET）的转换器。这个旧应用程序中的所有控件都是绝对定位的，因此我们以相同的方式进行操作。控件（例如输入标签表）有它的位置和大小，以及与之相关的提示文本。提示文本是相对于控件定位的，所以在翻译过程中我们不知道它的绝对位置。请注意，它取决于字体设置、文本、与控件的偏移量以及附加提示的控件边缘。

我正在尝试编写一个 CSS 规则来将提示定位在正确的位置。我已经解决了几乎所有的配置，但是我在居中时遇到了很大的问题。

由于绝对定位，我不能使用非零大小的 .PromptContainer - 我只知道控制的位置，而不是 .Prompt 本身。更大的 .PromptCointainer 会向下移动整个控制。

此外，长于控件宽度的提示文本不得更改控件的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:54:17.127

像这样？

[http://jsfiddle.net/GZ7wR/1/](http://jsfiddle.net/GZ7wR/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:50:38.823

这应该使文本
居中 .PromptContainer { text-align: center; }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:58:33.350

这个怎么样？

```
.Prompt { display: inline-block; margin: 0 auto; } 
```

# .net - 实体框架中的数据访问控制

> ID：10249878
> 
> 赞同：1
> 
> 时间：2012-04-20T16:21:36.393
> 
> 标签：.net, sql-server, entity-framework, view, data-access

我想在实体框架中做一个简单的（或不做）数据访问控制。我看到它在 EF 中并不那么容易支持，因为 EF 实际上并没有很好地支持模式和视图。

我想对实体的某些列进行有条件的访问。

在 Sql Server 中，使用模式很容易实现。例如，我可以在他的模式中为用户创建一个视图，其中缺少一些列。其他用户（例如管理员）将在其架构中拥有所有列。它们都可以具有相同的视图名称，例如：getUsers，但只有从 dbo 模式（dbo.getUsers）执行它的管理员才能拥有所有列，而其他列只有一些。当然在Sql Server中也可以通过存储过程来实现。

如何在 EF 中实现数据访问的功能？

我想做一个可以像这样使用的函数：

```
-- function checks user role and returns appropirate columns/entity  
var result = getAppropirateDataForThisUser("getUsers", user); 
```

当然，这只是为了说明问题。用法可以完全不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:37:42.603

One thing you can do is to create a wrapper rover DbContext with the logic to filter the columns for relevant user,

```
public class EfWrapper:Context
{
 private DbContext _dbContext;

public EfWrapper(DbContext context){
    _dbContext=context;
  }

  public IEnumerable <User> getUsers(User user){

         //if ... write your logic to choose correct projection 
          var users=  from user in context.Users
          select new UserWithLessColumns
               {
                    id= user.Id,
                    Name= user.Name
               });   
        return users;
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:27:26.037

条件过滤的目的是什么？如果是用于显示，请在上层应用程序层中处理。如果您实际上在谈论不同的业务对象（即，一个用户获得一种类型的对象，另一个用户获得该对象的子类型），那么您可以创建不同的类，并为这些类映射，并使用代码优先EF技术

EF 是一个数据访问组件，具体来说，是一个对象关系映射器，即将数据库数据映射到业务对象，对吧？

# .net-4.0 - 来自 Intranet 共享的 Springframework .NET 4.0 控制台应用程序

> ID：10249881
> 
> 赞同：1
> 
> 时间：2012-04-20T16:21:43.200
> 
> 标签：.net-4.0, console-application, spring.net, trust

我最近将使用 spring 和 nhiberate 的 .NET 3.5 控制台应用程序迁移到 .NET 4.0。此应用程序在 .net 3.5 下的网络共享和 .net 4.0 下的本地驱动器上运行良好，但是一旦我将其迁移到 .net 4.0，从网络共享启动时出现以下错误：

```
 Unhandled Exception: System.TypeInitializationException: The type initializer for 'Spring.Context.Support.ContextRegistry' threw an exception. 
    ---> Common.Logging.ConfigurationException: Failed obtaining configuration for Common.Logging from configuration section 'common/logging'. 
    ---> System.Configuration.ConfigurationErrorsException: An error occurred creating the configuration section handler for common/logging: That assembly does not allow partially trusted callers. (Z:\Tools\SaaSDataPoster\SaaSDataPoster.exe.Config line 6) 
    ---> System.Security.SecurityException: That assembly does not allow partially trusted callers.
       at System.Security.CodeAccessSecurityEngine.ThrowSecurityException(RuntimeAssembly asm, PermissionSet granted, PermissionSet refused, RuntimeMethodHandleInternal rmh, SecurityAction action, Object demand, IPermission permThatFailed)
       at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
       at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache)
       at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache)
       at System.Activator.CreateInstance(Type type, Boolean nonPublic)
       at System.Configuration.TypeUtil.CreateInstanceWithReflectionPermission(Type type)
       at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.Init(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord)
       at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.InitWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord)
       at System.Configuration.RuntimeConfigurationRecord.CreateSectionFactory(FactoryRecord factoryRecord)
       at System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere)
       --- End of inner exception stack trace ---
       at System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere)
       at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
       at System.Configuration.BaseConfigurationRecord.GetSection(String configKey)
       at System.Configuration.ConfigurationManager.GetSection(String sectionName)
       at Common.Logging.LogManager.<>c__DisplayClass3.<BuildLoggerFactoryAdapter>b__0()
       at Common.Logging.Configuration.ArgUtils.<>c__DisplayClass13.<Guard>b__12()
       at Common.Logging.Configuration.ArgUtils.Guard[T](Function`1 function, String messageFormat, Object[] args)
       --- End of inner exception stack trace ---
       at Common.Logging.Configuration.ArgUtils.Guard[T](Function`1 function, String messageFormat, Object[] args)
       at Common.Logging.LogManager.BuildLoggerFactoryAdapter()
       at Common.Logging.LogManager.get_Adapter()
       at Common.Logging.LogManager.GetLogger(Type type)
       at Spring.Context.Support.ContextRegistry..cctor() in c:\_prj\spring-        net\trunk\src\Spring\Spring.Core\Context\Support\ContextRegistry.cs:line 60
       --- End of inner exception stack trace ---
       at Spring.Context.Support.ContextRegistry.GetContext() 
```

我已经尝试添加`<NetFx40_LegacySecurityPolicy enabled="true" />`和使用`CasPol.exe`来给予 Intranet 区域完全信任（当应用程序是 .net 2.0 时，这有效）。

我也在使用为 .net 4.0 编译的 spring.net 二进制文件。

我的程序集也都有一个强名称。我不确定这是否有帮助或伤害。

`IsFullTrusted`我正在执行的程序集的属性也返回 true。

有人对 spring、net 4.0 和网络共享有任何运气吗？

以下是来自的输出`caspol -m -lg`：

32 位：

```
 Code Groups:

    1\.  All code: Nothing
       1.1\.  Zone - MyComputer: FullTrust
          1.1.1\.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust
          1.1.2\.  StrongName - 00000000000000000400000000000000: FullTrust
       1.2\.  Zone - Intranet: FullTrust
          1.2.1\.  All code: Same site Web
          1.2.2\.  All code: Same directory FileIO - 'Read, PathDiscovery'
       1.3\.  Zone - Internet: Internet
          1.3.1\.  All code: Same site Web
       1.4\.  Zone - Untrusted: Nothing
       1.5\.  Zone - Trusted: Internet
          1.5.1\.  All code: Same site Web 
```

64 位：

```
 Code Groups:

    1\.  All code: Nothing
       1.1\.  Zone - MyComputer: FullTrust
          1.1.1\.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust
          1.1.2\.  StrongName - 00000000000000000400000000000000: FullTrust
       1.2\.  Zone - Intranet: FullTrust
          1.2.1\.  All code: Same site Web
          1.2.2\.  All code: Same directory FileIO - 'Read, PathDiscovery'
       1.3\.  Zone - Internet: Internet
          1.3.1\.  All code: Same site Web
       1.4\.  Zone - Untrusted: Nothing
       1.5\.  Zone - Trusted: Internet
          1.5.1\.  All code: Same site Web 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:34:06.010

我通过将 AllowPartiallyTrustedCallersAttribute 添加到包含用于反序列化配置部分的类型的程序集来部分解决了这个问题。

# flash - 为什么即使在我的机器上卸载了 Flash，Flash 也能在 Chrome 中工作？

> ID：10249886
> 
> 赞同：0
> 
> 时间：2012-04-20T16:22:06.767
> 
> 标签：flash, google-chrome, safari, webkit

在我的 mac 上卸载 flash 后，我不能再在 safari 中使用 flash。这就说得通了。但是 Flash 仍然可以在 chrome 中使用？为什么是这样？chrome 是否内置了自己的 flash 渲染引擎？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:39:58.547

是的，谷歌浏览器确实内置了flash插件：

链接：[http ://helpx.adobe.com/flash-player/kb/flash-player-google-chrome.html](http://helpx.adobe.com/flash-player/kb/flash-player-google-chrome.html)

该链接也包括禁用，但此链接也是如此。

[http://downloadsquad.switched.com/2010/12/03/how-to-disable-chromes-built-in-flash-to-use-a-flash-beta-rele/](http://downloadsquad.switched.com/2010/12/03/how-to-disable-chromes-built-in-flash-to-use-a-flash-beta-rele/)

# microsoft-metro - CLR 或 Metro 有问题吗？

> ID：10249887
> 
> 赞同：0
> 
> 时间：2012-04-20T16:22:07.117
> 
> 标签：microsoft-metro, windows-runtime

运行 Metro 应用程序时出现以下错误：

> 运行时遇到致命错误。错误地址位于线程 0x279c 上的 0x6e6b9a68。错误代码为 0x80131506。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。

我很难认为 CLR 有问题。

该应用程序是纯 C#，没有 C++。

我不使用互操作。

我应该看什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:05:41.500

如果您正在构建 Metro 应用程序，请为这种异常情况做好准备，从而导致严重的睡眠不足。在 Microsoft 论坛中，不久前有一个线程，我们似乎隔离了当您与自定义值转换器绑定时发生的问题。真正简单的转换器很好，但有趣的转换器会在看似随机的时间产生这个异常。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:27:18.180

Windows 8 仍处于测试阶段。我不确定“buggy”对于尚未发布的软件来说是一个公平的形容词。对于你的问题——在这个阶段他们可能都是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-22T16:44:53.293

即使您的应用程序是纯 c#，对 WinRT API 的任何调用都是 c# 和 c++ 之间的互操作。它们之间的互操作层是 CLR 的责任，这就是为什么异常说它可能是 CLR 错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:27:13.103

每个软件都有错误。如果这个问题是可重现的，你应该这样做：1）将问题缩小到一个测试用例。这也将确保问题不在您身边，而实际上是在运行时。2) 搜索是否没有任何已经发布的错误报告或知识库文章 3) 向微软提交错误报告。

如果崩溃是可重现的，我相信微软会尽最大努力找到并修复错误。

# android - 从我的应用程序登录到 facebook 可以在模拟器上运行，但不能在设备上运行

> ID：10249889
> 
> 赞同：7
> 
> 时间：2012-04-20T16:22:24.147
> 
> 标签：android, facebook, facebook-graph-api, facebook-android-sdk

这是我登录 facebook 的代码。

```
mLoginButton = (LoginButton) findViewById(R.id.login);

        // restore session if one exists
        SessionStore.restore(Utility.mFacebook, this);
        SessionEvents.addAuthListener(new FbAPIsAuthListener());
        SessionEvents.addLogoutListener(new FbAPIsLogoutListener());

        /*
         * Source Tag: login_tag
         */
        mLoginButton.init(this, AUTHORIZE_ACTIVITY_RESULT_CODE, Utility.mFacebook, permissions);

        if (Utility.mFacebook.isSessionValid()) {
            requestUserData();
        }
 public class FbAPIsAuthListener implements AuthListener {

        //@Override
        public void onAuthSucceed() {
            requestUserData();
        }

        //@Override
        public void onAuthFail(String error) {
            mText.setText("Login Failed: " + error);
        }
    }

    /*
     * The Callback for notifying the application when log out starts and
     * finishes.
     */
    public class FbAPIsLogoutListener implements LogoutListener {
        //@Override
        public void onLogoutBegin() {
            mText.setText("Logging out...");
        }

        ///@Override
        public void onLogoutFinish() {
            mText.setText("You have logged out! ");
            mUserPic.setImageBitmap(null);
        }
    } 
```

在模拟器上它工作得很好。我已经尝试了 3 台设备，这些设备已经安装了 facebook，这就是问题所在。

它只是在加载时旋转，它什么也不做。我再次看到登录按钮。然后我尝试从原始 facebook 应用程序中注销，当按下我的应用程序上的登录按钮时，我看到了登录窗口，但现在我以前在登录模拟器时看到的是原始 facebook 应用程序的登录窗口。就像是已经开始了这个。

我使用的代码取自 hackbook.java

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:14:26.077

平台状态表示 SSO 存在问题。

仅当您在 android 设备上安装了 facebook 应用程序并且您所描述的内容适合所有这些时，SSO 才有效。在模拟器上，您没有 facebook 应用程序，因此当您的应用程序尝试登录用户时，它会使用 sdk 中的对话框，而不是使用 fb 应用程序附带的 SSO 进程。

在设备上，您曾经说过您确实拥有 fb 应用程序，因此 SSO 启动，至少目前，它存在问题。尝试卸载设备上的 facebook 应用程序，或者只是取消 SSO，即：[How to disable Facebook single sign on for android - Facebook-android-sdk](https://stackoverflow.com/questions/4521013/how-to-disable-facebook-single-sign-on-for-android-facebook-android-sdk)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:20:36.173

您需要生成系统的哈希键，然后通过编辑现有的 facebook 应用程序来放置它。

# asp.net - 从 reportserver 文件夹中的所有报表中收集所有参数并填充 sql 表

> ID：10249899
> 
> 赞同：0
> 
> 时间：2012-04-20T16:23:12.687
> 
> 标签：asp.net, vb.net, gridview, reporting, checklistbox

[感谢 Filburt 和 Devjosh。我已经重组了这篇文章并包括了我的尝试方法。] 我的 SQL DB 调用 ReportList 上有一个表，它是一个报告列表。我需要遍历该列表并逐个报告查询报告服务器，以填充一个名为 ReportParameters 的表。ReportParameters 表有一个 ReportOwnerID 列，该列需要包含 ReportList 表中列出的相应（所有者）报告的 ReportID 值。

这是在 VB.NET 2005 ASP2.0 中，我最终弄得一团糟。请帮助我用最干净的方法来做这件事。

它需要这样工作：-我有一个根据 REportList 的报告列表框和一个列出所有参数的 GridView （唯一的 - 大多数参数对许多报告都是通用的）的想法是参数设置一次并且报告可以通过在 ReportList CheckListBox 中选择它们并单击 Execute 来启动。

我希望当我单击 ListView 中的特定报告时，Gridview 中的相关参数会显示为绿色背景，而那些不适用的参数会显示为红色。网格视图中最左边的列包含参数名称（不可编辑），下一列必须是可编辑的才能填充值。

到目前为止完成：

我尝试单击 EXECUTE 按钮，在测试框中构建参数字符串，并在新窗口中打开报告时使用 Javascript OpenReportWin() 函数调用它。这很好用，但我最大的问题是它询问报告服务器报告以获取参数列表并将它们添加到表格中。我已经尝试使用绑定到 ds 的隐藏 DataGrid 到 reportParamaters 表上；我尝试使用数据列表填充它，但我无法掌握这些 thionsg 的窍门，而且它看起来很乱。必须有一种简单干净的方法从报表服务器获取 .GetParameters 结果集并填充表，而无需创建 reportviewer 对象并循环浏览报表列表 - 然后必须呈现每个报表，然后才能获取该列表出去。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T11:18:54.907

我暂时撤消这个。当我对我已经获得一个干净的解决方案感到满意时，我将提交一个解决方案。

苹果电脑

请关闭！！！

# python - python初学者-在大文件中查找和替换的更快方法？

> ID：10249900
> 
> 赞同：8
> 
> 时间：2012-04-20T16:23:25.180
> 
> 标签：python, replace

我有一个大约 1 亿行的文件，我想用存储在制表符分隔文件中的替代文本替换其中的文本。我的代码有效，但处理前 70K 行大约需要一个小时。在尝试逐步提高我的 python 技能时，我想知道是否有更快的方法来做到这一点。谢谢！输入文件如下所示：

> CHROMOSOME_IV ncRNA 基因 5723085 5723105。- 。ID=基因：WBGene00045518 CHROMOSOME_IV ncRNA ncRNA 5723085 5723105。- 。父=基因：WBGene00045518

具有替换值的文件如下所示：

> WBGene00045518 21ur-5153

这是我的代码：

```
infile1 = open('f1.txt', 'r')
infile2 = open('f2.txt', 'r')
outfile = open('out.txt', 'w')

import re
from datetime import datetime
startTime = datetime.now()

udict = {}
for line in infile1:
    line = line.strip()
    linelist = line.split('\t')
    udict1 = {linelist[0]:linelist[1]} 
    udict.update(udict1)

mult10K = []
for x in range(100):
    mult10K.append(x * 10000)   
linecounter = 0
for line in infile2:
    for key, value in udict.items():
        matches = line.count(key)
        if matches > 0: 
            print key, value
            line = line.replace(key, value)
            outfile.write(line + '\n')
        else:
            outfile.write(line + '\n')
    linecounter += 1
    if linecounter in mult10K:
        print linecounter   
        print (datetime.now()-startTime)
infile1.close()
infile2.close()
outfile.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:46:03.953

我正在考虑您对字典键的循环，以及一个 wqya 来优化它，并让稍后对您的代码进行其他评论。

但后来我偶然发现了这部分：

```
if linecounter in mult10K:
    print linecounter   
    print (datetime.now()-startTime) 
```

这个看起来很无辜的片段实际上让 Python 依次查看和比较文件中每一行的“linecounter”列表中的 10000 个项目。

将此部分替换为：

```
if linecounter % 10000 == 0:
    print linecounter   
    print (datetime.now()-startTime) 
```

（忘记所有的 mult10k 部分） - 你应该得到显着的加速。

此外，您似乎正在为每条输入线记录多条输出线 - 您的主循环是这样的：

```
linecounter = 0
for line in infile2:
    for key, value in udict.items():
        matches = line.count(key)
        if matches > 0: 
            print key, value
            line = line.replace(key, value)
            outfile.write(line + '\n')
        else:
            outfile.write(line + '\n')
    linecounter += 1 
```

为此替换它：

```
for linecounter, line in enumerate(infile2):
    for key, value in udict.items():
        matches = line.count(key)
        if matches > 0: 
            print key, value
            line = line.replace(key, value)
    outfile.write(line + '\n') 
```

它只为每个输入行正确写入一个输出行（除了消除代码重复，并以“pythonic”方式处理行数）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T16:29:44.730

您应该将您的行拆分为“单词”，并且只在您的字典中查找这些单词：

```
>>> re.findall(r"\w+", "CHROMOSOME_IV ncRNA gene 5723085 5723105 . - . ID=Gene:WBGene00045518 CHROMOSOME_IV ncRNA ncRNA 5723085 5723105 . - . Parent=Gene:WBGene00045518")
['CHROMOSOME_IV', 'ncRNA', 'gene', '5723085', '5723105', 'ID', 'Gene', 'WBGene00045518', 'CHROMOSOME_IV', 'ncRNA', 'ncRNA', '5723085', '5723105', 'Parent', 'Gene', 'WBGene00045518'] 
```

这将消除您为每一行所做的字典循环。

这是完整的代码：

```
import re

with open("f1.txt", "r") as infile1:
    udict = dict(line.strip().split("\t", 1) for line in infile1)

with open("f2.txt", "r") as infile2, open("out.txt", "w") as outfile:
    for line in infile2:
        for word in re.findall(r"\w+", line):
            if word in udict:
                line = line.replace(word, udict[word])
        outfile.write(line) 
```

**编辑**：另一种方法是从您的字典中构建一个单一的大型正则表达式：

```
with open("f1.txt", "r") as infile1:
    udict = dict(line.strip().split("\t", 1) for line in infile1)
regex = re.compile("|".join(map(re.escape, udict)))
with open("f2.txt", "r") as infile2, open("out.txt", "w") as outfile:
    for line in infile2:
        outfile.write(regex.sub(lambda m: udict[m.group()], line)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-20T16:48:21.057

这段代码*充满*了线性搜索。难怪它运行缓慢。在不了解输入的情况下，我无法就如何解决这些问题提供建议，但我至少可以指出问题所在。我会指出主要问题和一些次要问题。

```
udict = {}
for line in infile1:
    line = line.strip()
    linelist = line.split('\t')
    udict1 = {linelist[0]:linelist[1]} 
    udict.update(udict1) 
```

不要`update`在这里使用；只需将项目添加到字典中：

```
 udict[linelist[0]] = linelist[1] 
```

这比为每个条目创建字典要快。（实际上，[Sven Marnach](https://stackoverflow.com/a/10249985/577088)的基于生成器的方法来创建这本字典更好。）虽然这相当小。

```
mult10K = []
for x in range(100):
    mult10K.append(x * 10000) 
```

这是完全没有必要的。删除这个；我将向您展示一种在没有这个的情况下每隔一段时间打印的方法。

```
linecounter = 0
for line in infile2:
    for key, value in udict.items(): 
```

这是你的第一个大问题。您正在通过字典对每一行的键进行线性搜索。如果字典非常大，这将需要大量的操作：100,000,000 * len(udict)。

```
 matches = line.count(key) 
```

这是另一个问题。您正在使用线性搜索查找匹配项。然后你做`replace`，它做同样的线性搜索！您无需检查匹配项；`replace`如果没有，则返回相同的字符串。这也不会产生很大的不同，但它会让你有所收获。

```
 line = line.replace(key, value) 
```

继续进行这些替换，然后仅在所有替换完成后才编写该行：

```
 outfile.write(line + '\n') 
```

最后，

```
 linecounter += 1
    if linecounter in mult10K: 
```

请原谅我，但这是一种荒谬的做法！您正在进行线性搜索`linecounter`以确定何时打印一行。在这里，这又增加了将近 100,000,000 * 100 次操作。您*至少*应该在一组中搜索；但最好的方法（如果你真的必须这样做）是做一个模运算并测试它。

```
 if not linecounter % 10000: 
        print linecounter   
        print (datetime.now()-startTime) 
```

为了使这段代码高效，您需要摆脱这些线性搜索。[Sven Marnach](https://stackoverflow.com/a/10249985/577088)的回答提出了一种可行的方法，但我认为这取决于文件中的数据，因为替换键可能与明显的单词边界不对应。（不过，他添加的正则表达式方法解决了这个问题。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:37:56.387

我希望为每行输入写一行输出乘以替换字符串的数量是一个错误，你真的只想为每个输入写一个输出。

您需要找到一种方法来尽快测试输入行是否匹配。遍历整个字典可能是您的瓶颈。

我相信正则表达式被预编译成可以高效的状态机。我不知道当你生成一个巨大的表达式时性能如何受到影响，但值得一试。

```
freakin_huge_re = re.compile('(' + ')|('.join(udict.keys()) + ')')
for line in infile2:
    matches = [''.join(tup) for tup in freakin_huge_re.findall(line)]
    if matches:
        for key in matches:
            line = line.replace(key, udict[key]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T16:25:39.680

这不是特定于 Python 的，但您可能会稍微展开您的双 for 循环，以便文件写入不会在循环的每次迭代中发生。也许每 1000 或 10,000 行写入文件。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-20T16:27:12.953

他们在 Python 中很明显的一个是[列表理解](https://www.youtube.com/watch?v=t85uBptTDYY)- 这是一种更快（且更易读）的方式：

```
mult10K = []
for x in range(100):
    mult10K.append(x * 10000) 
```

像这样：

```
mult10K = [x*10000 for x in range(100)] 
```

同样，您在哪里：

```
udict = {}
for line in infile1:
    line = line.strip()
    linelist = line.split('\t')
    udict1 = {linelist[0]:linelist[1]} 
    udict.update(udict1) 
```

我们可以使用`dict`推导式（使用生成器表达式）：

```
lines = (line.strip().split('\t') for line in infile1)
udict = {line[0]: line[1] for line in lines} 
```

这里还值得注意的是，您似乎正在使用制表符分隔的文件。在这种情况下，[模块`csv`可能](http://docs.python.org/library/csv.html?highlight=dic#module-contents)是比使用更好的选择`split()`。

另请注意，使用[该`with`语句](http://docs.python.org/reference/compound_stmts.html#the-with-statement)将增加可读性并确保您的文件被关闭（即使在异常情况下）。

如果在每个循环上都执行打印语句，它们也会大大减慢速度——它们对于调试很有用，但是当在你的主要数据块上运行时，可能值得删除它们。

您可以做的另一件“更pythonic”的事情是使用[`enumerate()`](http://docs.python.org/library/functions.html#enumerate)而不是每次都向变量添加一个。例如：

```
linecounter = 0
for line in infile2:
   ...
   linecouter += 1 
```

可以替换为：

```
for linecounter, line in enumerate(infile2):
    ... 
```

在计算键的出现次数时，更好的解决方案是使用`in`：

```
if key in line: 
```

因为这在找到实例后短路。

把所有这些加起来，让我们看看我们有什么：

```
import csv
from datetime import datetime
startTime = datetime.now()

with open('f1.txt', 'r') as infile1:
    reader = csv.reader(delimiter='\t')
    udict = dict(reader)

with open('f2.txt', 'r') as infile2, open('out.txt', 'w') as outfile:
    for line in infile2:
        for key, value in udict.items():
            if key in line: 
                line = line.replace(key, value)
        outfile.write(line + '\n') 
```

编辑：根据评论中的要求，列出 comp 与正常循环：

```
python -m timeit "[i*10000 for i in range(10000)]"
1000 loops, best of 3: 909 usec per loop

python -m timeit "a = []" "for i in range(10000):" "  a.append(i)"
1000 loops, best of 3: 1.01 msec per loop 
```

注意 usec 与 msec。它不是巨大的，但它是一些东西。

# ruby - Ruby 1.9 如果我有一个指向 ruby 的 shebang，为什么系统看不到它？

> ID：10249902
> 
> 赞同：4
> 
> 时间：2012-04-20T16:23:48.497
> 
> 标签：ruby

我正在使用 Ubuntu。我正在尝试运行一个 ruby​​ 文件 todo.rb 我将此 shebang 添加为文件的第一行

```
#!/usr/bin/env ruby 
```

我转到 rb 文件所在的目录，然后运行 ​​todo.rb 并得到错误`todo.rb: command not found`。

于是我直接去了 /usr/bin 目录。我找到了 env 命令并运行了它。该`env`命令的输出显示 ruby​​ 路径和 ruby​​ 数据：

```
MY_RUBY_HOME=/home/tallercreativo/.rvm/rubies/ruby-1.9.2-p290
PATH=/home/tallercreativo/.rvm/gems/ruby-1.9.2-p290/bin:/home/tallercreativo/.rvm/gems/ruby-1.9.2-p290@global/bin:/home/tallercreativo/.rvm/rubies/ruby-1.9.2-p290/bin:/home/tallercreativo/.rvm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
GEM_PATH=/home/tallercreativo/.rvm/gems/ruby-1.9.2-p290:/home/tallercreativo/.rvm/gems/ruby-1.9.2-p290@global
RUBY_VERSION=ruby-1.9.2-p290 
```

因此，由于无法使其正常工作，因此我将 shebang 更改为直接指向 ruby​​：

```
#!/home/tallercreativo/.rvm/rubies/ruby-1.9.2-p290/bin/ruby 
```

我得到相同的命令未找到错误。怎么了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T16:46:40.007

您需要首先使您的脚本可执行：

```
chmod +x todo.rb 
```

那么你需要像这样运行它：

```
./todo.rb 
```

你不能只说 来运行它`todo.rb`，除非你把它放在你的`PATH`中，在这种情况下你可以从任何地方这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T16:25:13.110

你在你的命令`ruby`结束时错过了。`env`你的意思：

```
#!/usr/bin/env ruby 
```

您需要告诉`env`您要查找的可执行文件。

## （问题更新）

你是这样执行代码的吗？ `todo.rb`? 您需要提供脚本的完整路径 ( `/home/you/project/todo.rb`) 或相对路径 ( `./todo.rb`)，除非该目录位于您的`$PATH`.

# jquery-ui - 如何将backbone.js 事件绑定到JQuery UI 对话窗口？

> ID：10249906
> 
> 赞同：1
> 
> 时间：2012-04-20T16:24:12.127
> 
> 标签：jquery-ui, backbone.js

我对backbone.js 很陌生，但是我们开始在前端使用越来越多的JS，我想使用一些框架来提供代码结构——主干似乎适合我们的需求。

所以从[一个非常简单的测试应用程序](http://jsfiddle.net/cocovan/hMyE2/)开始，它使用 jquery-ui 启动一个对话窗口。我遇到的问题是，由于 jquery-ui 在主干使用的原始模板周围添加了一个包装器 DIV，因此事件不再触发。

我不想使用 jquery-ui 事件模型，因为我宁愿只使用一个 - 如何将主干绑定到这个新结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T14:14:08.557

看起来好像调用`_.template()`实际上是在一个额外的 div 中进行包装。绑定了事件的父 div 被附加到`#well`. 一个简单的解决方法是在获取具有模型类 ID 的元素的结果上调用 .parent()。例如见[这里](http://jsfiddle.net/ZqeGY/)

_ 文档中的一些信息很可能也能更清楚地说明这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-19T12:26:33.303

好的 - 在这个项目结束时，我终于意识到我没有回答这个问题。当您使用 JQueryUI 创建一个 .dialog 时会发生什么，它实际上分离了您的原始 DOM 元素并将其移动到包装在它自己的 JQueryUI 标记中的 DOM 的底部，以将其变成一个对话框。

由于 Backbone 视图的元素现在已被移动，因此 Backbone 不会拾取任何触发的事件，因为它发生在它自己的“视图”之外。

所以你要做的是重新分配视图的元素：

```
var dlg = this.$("#dialogue-properties").dialog({ ..});
this.setElement(dlg); 
```

视野在哪里`this`。这是在`initialize`方法内完成的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T06:15:56.120

您可以在视图中创建 div 包装器并对其内容进行模态化，如此处所述[（文章的第一部分）](http://lostechies.com/derickbailey/2012/04/17/managing-a-modal-dialog-with-backbone-and-marionette/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-02T09:18:59.100

**cocovan**在他的回答中很好地解释了这个问题。但是，至于解决方案，JQuery UI 团队实际上在 2012 年底添加了一个方法（[允许对话框附加到 body 以外的元素](https://bugs.jqueryui.com/ticket/7948)）来处理这个问题。

它是`appendTo(selector)`方法（[jQuery Dialog appendTo 方法](https://api.jqueryui.com/dialog/#option-appendTo)）。因此，只需指定要将对话框附加到哪个元素。

# asp.net - 同时使用 oracle db 和访问一个 gridview

> ID：10249925
> 
> 赞同：0
> 
> 时间：2012-04-20T16:25:26.347
> 
> 标签：asp.net

我想为我拥有的网格视图添加一些功能。本质上，我只想做一些类似于 asp.net 2.0 所做的 AutoGenerateInsert 按钮。我希望这些字段将数据推送到 AccessDataSource。不过这里的技巧是，我想根据 Oracle DB 验证某些字段，甚至将其他字段自动填充到用户输入的字段中。例如，我的 Oracle DB 有个人信息，例如姓名、年龄、等如果网络应用用户在“姓名”字段中输入有效姓名，则应验证该字段并且应自动填充其他个人信息。输入所有字段后，单击“添加”按钮，gridview 上的新记录将数据插入 Access DB。

有任何链接或提示可以完成这样的事情吗？

谢谢！-狡猾的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:47:36.323

在我看来，当您想要验证字段获取连接字符串 [0] 并且当您想要保存字段获取连接字符串 [1] 时，您应该将两个连接字符串存储在 web.config 中的 aap 标记中，我假设您知道如何在此处加载和保存数据没什么复杂的。这里是例子

```
<appSettings>
<add key="dbConnection1" value="Integrated Security=SSPI;Persist Security Info=False;     Initial Catalog=dbname;Data Source=servername"/>
<add key="dbConnection2" value="Datasource=servername;    Initial Catalog=dbname;User ID=dbuser;Password=dbpassword" />
</appSettings> 
```

现在在后面的代码中

```
public string GetconnectionString1()
    {
        return ConfigurationManager.AppSettings["dbconnection1"];
    }

public string GetconnectionString2()
    {
        return ConfigurationManager.AppSettings["dbconnection2"];
    } 
```

# c++ - fopen() 失败

> ID：10249928
> 
> 赞同：0
> 
> 时间：2012-04-20T16:25:47.790
> 
> 标签：c++, windows, fopen

我有一个 C++ 程序，它在 windows xp 启动时将文件与远程服务器同步。需要打开公钥文件的函数在 fopen() 处失败。当我自己（从资源管理器中）启动程序时，一切正常。但是当我向注册表添加启动密钥时，该功能失败。

我通过调试器跟踪代码，一切都很好，直到调用 CreateFileA()。CreateFileA 返回 FILE_NOT_FOUND。

我删除了对 fopen() 的调用，并直接将其替换为对 CreateFileA() 的调用。然后我将 SECURITY_ATTRIBUTES 更改为 NULL，之后对 CreateFileA() 的调用起作用。

问题是我用于加密的第 3 方库需要一个 FILE* 对象，而不仅仅是从文件中读取的数据。我该如何解决我的问题？

这是我目前正在使用的代码：

```
if( !GetModuleFileNameA(NULL, Path, MAX_PATH) ){
    delete [] buf;
    delete [] Path;
    return strerror( errno );
}

rPath = Path;

delete [] Path;

ret = rPath.find_last_of( '\\' );

if( ret == string::npos ){
    delete [] buf;
    return strerror( errno );
}

ret++;

rPath.erase( rPath.begin() + ret, rPath.begin() + rPath.size() - ret );

rPath += "rsa_pub.txt";

if( ( f = fopen( rPath.c_str(), "rb" ) ) == NULL ){  // fails when started from registry
    delete [] buf;
    return strerror( errno );
} 
```

**编辑：**

我找到了一个解决问题的黑客方法：如果我释放运行时库然后重新加载它，问题就会消失。然而，这不是一个非常优雅的解决方案。是否可以在不删除和重新加载 dll 的情况下重置运行时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:37:50.543

你的`rPath.erase`电话似乎没有多大意义

```
rPath.erase( rPath.begin() + ret, rPath.begin() + rPath.size() - ret ); 
```

那应该做什么？

这里你使用的`(iterator, iterator)`是这里的版本`erase`。我相信您正试图从 position 开始擦除字符串的尾部`ret`。在那种情况下，我希望它看起来像

```
rPath.erase( rPath.begin() + ret, rPath.end() ); 
```

如果你想使用 的`(position, length)`版本`erase`，那么它看起来像

```
rPath.erase( ret, rPath.size() - ret ); 
```

但是您的具体用法看起来像是两者的奇怪混合。你想通过那个电话做什么？

可能会返回不同的`GetModuleFileNameA`字符串，具体取决于您启动程序的方式，这就是您的代码在某些情况下可能看起来“工作”的原因。

# ms-access - 从 MS Access 数据库表中的字段中删除字符

> ID：10249929
> 
> 赞同：5
> 
> 时间：2012-04-20T16:25:55.010
> 
> 标签：ms-access, sql-update

使用 MS Access 2010。我在表中有一个字段，其中包含用引号括起来的 Windows 路径名，如下所示

```
"C:\My Documents\Photos\img1.jpg"
"C:\My Documents\Photos\products\gizmo.jpg"
"C:\My Documents\Photos\img5.jpg" 
```

等等。

我需要去掉引号，所以列看起来像这样：

```
C:\My Documents\Photos\img1.jpg
C:\My Documents\Photos\products\gizmo.jpg
C:\My Documents\Photos\img5.jpg 
```

有没有办法编写更新查询来做到这一点？或者一个更好的方法来完全做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T16:42:58.327

如果您将在 Access 会话中使用 Access 2000 或更高版本执行此操作，则可以`Replace()`在更新查询中使用该函数来删除引号。删除意味着用空字符串替换它们。

```
UPDATE YourTable
SET path_field = Replace(path_field, '"', ''); 
```

如果这些路径字符串中的任何一个可能*在*其中包含引号（糟糕！），请考虑该`Mid()`函数...要求它从第二个字符开始（跳过前导引号），并返回相当于的字符数`Len(path_field) - 2`

```
UPDATE YourTable
SET path_field = Mid(path_field, 2, Len(path_field) - 2); 
```

无论哪种方式，您都可能希望包含一个 WHERE 子句来忽略没有`path_field`值的行。

```
WHERE Len(path_field) > 0 
```

如果在添加新数据时必须再次执行此操作，请使用不同的 WHERE 子句以确保仅更新`path_field`值以引号开头和结尾的那些行。

```
WHERE path_field Like '"*"' 
```

那是使用 * 通配符作为 Access 的默认 ANSI 89 模式。如果要从 ADO（ANSI 92 模式）执行此操作，请使用 % 通配符。

```
WHERE path_field Like '"%"' 
```

...或`ALike`在任一模式下使用和 % 通配符。

```
WHERE path_field ALike '"%"' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:00:23.260

其他人已经提到的解决方案`REPLACE`有效，但会删除所有引号，即使它们位于字符串的中间。

如果您只想删除开头或结尾的引号，但在字符串中间保留引号原样，您可以使用以下两个查询来完成：

如果是引号，则删除第一个字符：

```
update YourTable
set YourField = right(YourField, len(YourField) - 1)
where left(YourField, 1) = '"' 
```

如果是引号，则删除最后一个字符：

```
update YourTable
set YourTable = left(YourField, len(YourField) - 1)
where right(YourField, 1) = '"' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:46:53.013

要使其成为永久更改，您可能会运行如下所示的更新查询：

```
UPDATE [Your Table]
SET [Your Table].[Your Field] = Replace([Your Table].[Your Field],"""","") 
```

这将消除*所有*引号，即使它们不在开头或结尾。如果那不是您想要的，请回帖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:47:10.633

假设您的列名是 MyColumn 并且表名是 MyTable，您可以使用此 sql 更新您的数据以摆脱引号。

```
UPDATE MyTable
SET MyColumn = REPLACE(MyColumn,'"','') 
```

# android - 使用xml解析

> ID：10249937
> 
> 赞同：0
> 
> 时间：2012-04-20T16:26:15.027
> 
> 标签：android, xml-parsing

我正在尝试从 xml 文件中获取一些信息，我尝试了不同的链接并且它可以工作，但是当我通过这个 url="http://www.w3schools.com/xml/simple.xml" 它捕获 SAXexception 这是我的代码

```
public class XMLfunctions {

    public Document getDomElement(String xml){
        Document doc = null;
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        try {

            DocumentBuilder db = dbf.newDocumentBuilder();

            InputSource is = new InputSource();
                is.setCharacterStream(new StringReader(xml));
                doc = db.parse(is);

            } catch (ParserConfigurationException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (SAXException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (IOException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            }
                // return DOM
            return doc;
    } 
```

它捕获（SAXException e）任何人都可以帮助我如何避免这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:36:48.267

use this

```
 DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
 DocumentBuilder db = dbf.newDocumentBuilder();
 Document doc = db.parse(new InputSource(new StringReader(response)));
// normalize the document
doc.getDocumentElement().normalize();
 // get the root node
NodeList nodeList = doc.getElementsByTagName("your tag name"); 
```

# actionscript-3 - Flex 中继器组件

> ID：10249938
> 
> 赞同：0
> 
> 时间：2012-04-20T16:26:18.253
> 
> 标签：actionscript-3, apache-flex, flex4, flex3

在 flex 3 中，我使用中继器组件在画布中创建了子组件。我只想对转发器创建的子组件之一进行更改。是否有任何方法或方式来访问特定的子组件并进行所需的属性更改？

```
<mx:Repeater id="myrep" dataProvider="{myAC}"> 
    <mx:Label id="Label1" text="This is button "/>
</mx:Repeater> 
```

在上面的代码中，假设我创建了 10 个标签，并且我只想在第 5 个标签中应用一些更改？是否可以。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:55:31.730

是的，这是可能的。

您可以像这样访问转发器生成的组件：

```
component_id[index] 
```

因此，在您的情况下，要更改第 5 个元素的标签，您的代码将是`Label1[4].text='blah blah'`. 但是，以这种方式更改中继器生成的组件是一种不好的做法。而是使用**绑定**。

例如：

```
//...
[Bindable]
var myAC:ArrayCollection = new ArrayCollection(["label1","label2","label3","label4","label5","label6"]) ;
//...
<mx:Repeater id="myrep" dataProvider="{myAC}"> 
   <mx:Label id="Label1" text="{myrep.currentItem}"/>
</mx:Repeater> 
//Changing label of 5th element
myAC[4] = 'blah blah'; 
```

# html - 在 HTML5 表格上 + 列和行的工具

> ID：10249939
> 
> 赞同：4
> 
> 时间：2012-04-20T16:26:23.950
> 
> 标签：html, html-table

我正要分叉一个兼容性指南，当我查看 HTML 时，我发现它是一个表格。

表格可以很好地显示这样的数据，但是当您必须每隔几周编辑一次时，编辑起来并不有趣。

**请问有哪些工具可以非常快速、干净地添加/删除/克隆列和行？**

可以在线、GUI 或 WYSIWYG（首选）或命令行驱动、在线或离线（尽管首选与 Node.js 兼容的 JavaScript 引擎在线）。

或者，另一种方式可能更好地显示每隔几周更改的表格数据，例如 AJAX 呈现 JSON 数据，但仍然需要一些手握以实现最佳场景。

有问题的表格和建议： [https ://github.com/kangax/es5-compat-table/blob/gh-pages/es6/index.html](https://github.com/kangax/es5-compat-table/blob/gh-pages/es6/index.html)

[https://github.com/kangax/es5-compat-table/issues/29](https://github.com/kangax/es5-compat-table/issues/29)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T17:12:40.177

不同的人有不同的需求和态度！

1).您可以使用电子表格程序来编辑表格并导出为 html。Google 电子表格提供了将 preadsheet 嵌入网页或以简单 HTML 格式下载（导出）电子表格的功能，您可以使用 CSS 对其进行样式设置适合您的需求。

2).Google 的 API 可以从电子表格中抓取数据并像表格一样显示。您所要做的就是编辑 Google 电子表格！

我检查了 API 并可以构建一个快速示例，这就是[小提琴](http://jsfiddle.net/EgY22/)！

这是我所做的一个小总结，

```
var query = new google.visualization.Query(
      'http://spreadsheets.google.com/tq?key=pCQbetd-CptGXxxQIG7VFIQ&pub=1'); 
```

我在这里引用的电子表格是[http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ](http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ)

```
 // Apply query language.
  //I'm selecting all the cols!
  query.setQuery('SELECT * ');
// Send the query with a callback function.
      query.send(handleQueryResponse); 
```

在我的回调中，

```
var data = response.getDataTable();
   //init the table
  visualization = 
   new google.visualization.Table(document.getElementById('table'));
  visualization.draw(data, null); 
```

# c# - 是否可以通过 Word API 看到不同形式的单词？

> ID：10249940
> 
> 赞同：6
> 
> 时间：2012-04-20T16:26:32.250
> 
> 标签：c#, visual-studio, ms-word, word

我想知道是否可以通过 Word API 看到不同形式的单词。我正在制作一个*开源*工具，该工具会在保存文档时自动将文档添加到属性和方法中。它只会对 或 的方法执行此`public`操作`protected`。

我希望它工作的方式是，如果您遵循特定的命名约定并使用（例如）方法名称`AddPerson`or `add_person`，代码将采用这些方法名称并将它们转换为单词数组。“添加”和“人员”。

从这些词中，我想检测它是动词还是名词。例如，在本例中，“Add”是动词，“Person”是名词。

一旦检测到这一点，我还想转换这些词，以形成以下文档声明：

> **AddPerson**（个人）
> 
> 添加一个人。
> 
> *人*：那个人。

我希望你明白。

简而言之，如何以智能的方式将“Add”转换为“Adds”，以及如何以编程方式检测“Add”是动词还是名词？

我认为 Word API 将是一个好的开始。我只是不知道怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:43:50.440

我最终使用了`System.Data.Entity.Design.PluralizationServices.PluralizationService`Entity Framework 中的一个，它完美地完成了这项工作。

该项目可以在这里找到：

[http://todoc.codeplex.com/](http://todoc.codeplex.com/)

不过仍在努力。

# machine-learning - 机器学习如何使用用户的 Facebook 兴趣来做出决定

> ID：10249942
> 
> 赞同：2
> 
> 时间：2012-04-20T16:26:46.730
> 
> 标签：machine-learning

我试图找出一种方法可以将 Facebook 用户表示为向量。我决定将用户的不同属性/参数堆叠到一个大向量中（即年龄是一个大小为 100 的向量，其中 100 是您可以拥有的最大年龄，如果您说 50，则前 50 个值向量将是 1，就像温度计一样）。我只是想不出一种将 Facebook 兴趣表示为向量的方法，它们是单词的集合，代表所有单词的空间很大，我不能像一袋单词或相似的东西。有谁知道我应该如何进行？我对此仍然很陌生，任何参考将不胜感激。

如果希望对这个问题投反对票，请让我知道它有什么问题，以便我可以改进措辞和上下文。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:23:59.423

“正确”的方法取决于您的学习算法是什么以及决策问题是什么。

但是，将年龄表示为单个数字特征而不是 100 个指标特征通常会更好。这样，学习算法就不必学习这一百个特征之间的关系（它是内置的），并且问题的维度减少了 99 个，这将使一切变得更好。

为了对兴趣进行建模，您可能希望从一个极高维的词袋模型开始，然后使用各种选项之一来降低维度：

*   一种通用的降维技术，如[PCA](http://en.wikipedia.org/wiki/Principal_component_analysis)或更智能的非线性技术，包括[Kernel PCA](http://en.wikipedia.org/wiki/Kernel_PCA)或各种非线性方法：参见[维基百科对降维](http://en.wikipedia.org/wiki/Dimensionality_reduction)和[具体非线性技术的概述](http://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction)
*   将其通过[主题模型](http://en.wikipedia.org/wiki/Topic_model)并将学习的主题权重用作您的特征；示例包括[LSA](http://en.wikipedia.org/wiki/Latent_semantic_analysis)、[LDA](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)、[HDP](http://en.wikipedia.org/wiki/Hierarchical_Dirichlet_process)等等

# asp.net - ObjectDataSource 方法不能引用母版页方法

> ID：10249945
> 
> 赞同：0
> 
> 时间：2012-04-20T16:26:58.720
> 
> 标签：asp.net, master-pages

所以我有一个与之关联的更新和删除方法的 ObjectDataSource，并且 DS 连接到一个网格视图。当我调用这些方法时，我想在主页面中重新填充一个下拉列表，其中包含与网格相同的数据，所以我尝试按如下方式调用这些方法：

```
 MyApp MasterPage = (MyApp)Page.Master;
            MasterPage.getData(); 
```

现在，如果我从网格（由 RowCommand 事件而不是 DS 处理）进行插入，这工作得很好，但通过 DS 我得到以下错误：“对象引用未设置为对象的实例。 "

我可以从回发中看到 aspx 上的某些字段尚不可用，但是母版页怎么可能对依赖它的页面不可用？我不应该可以参考吗？这有什么后门技巧吗？我知道我可以摆脱 DS，但我想使用它，因为它使分页和排序变得如此简单。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:59:25.453

[检查masterpage-contentpage life-cycle](http://msdn.microsoft.com/en-us/library/dct97kc3.aspx)中的事件顺序。您可以将代码移动到在母版页可以访问下拉框后触发的事件。

* * *

编辑：另一种选择

如果您无法移动代码，请尝试将数据存储在母版页的属性中，然后在初始化下拉菜单后，返回母版页并获取数据。

```
protected object SomePropertyICreatedToStoreData {get;set;}

void GetData()
{
    // get the data (this part works already)
    var theData = WhereTheDataComesFrom

    // bind to dropdownlist - doesn't work, so...
    this.SomePropertyICreatedToStoreData = theData;
} 
```

...然后稍后

```
 this.MyDropDownList.DataSource = this.SomePropertyICreatedToStoreData; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:05:30.173

您需要添加 Master 指令：

```
<%@ MasterType TypeName ="MasterPageClassName" %> 
```

或者

```
<%@ MasterType virtualpath="~/Masters/Master1.master" %> 
```

[http://msdn.microsoft.com/en-us/library/xxwa0ff0.aspx](http://msdn.microsoft.com/en-us/library/xxwa0ff0.aspx)

**Update:** Separated TypeName and virtualpath as pointed out in the comments.

# javascript - Javascript推送方法不起作用

> ID：10249946
> 
> 赞同：2
> 
> 时间：2012-04-20T16:27:00.003
> 
> 标签：javascript, json, jquery

我无法将元素推送到作品数组。控制台日志正在返回正确的对象，但它们不会被推送到数组中......这是我的代码：

```
var works = new Array();
    $(window).ready(function()
    {       

        $.getJSON('AJAX/getWorks.php', function(data) {
          $.each(data, function(key, val) {
             console.log(val);
             works.push(val);
          });
        });
        console.log(works);
    }); 
```

和 json 对象：

```
Object
date: "2012-04-08 17:53:58"
description: "sadasd"
id: "2"
link: "sadasd"
name: "dsad"
objects: null
position: "2"
__proto__: Object 
```

有人看到我做错了吗？提前感谢您的回答...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:39:24.347

您在代码中过早地记录数组。将`console.log`在 ajax 请求完成之前运行，因为`ajax`它是异步的。

```
 $.getJSON('AJAX/getWorks.php', function(data) {
              $.each(data, function(key, val) {
                 console.log(val);
                 works.push(val);
              });
              console.log(works); // move this here so the array is logged after the ajax request finishes. 
            }); 
```

编辑

如果您想在 ajax 请求之后使用该变量，您可以执行以下操作

创建一个函数来容纳 ajax 请求

```
function getWorks() 
{
    return  $.getJSON('AJAX/getWorks.php', function(data) {
              $.each(data, function(key, val) {
                 works.push(val);
              }); 
} 
```

然后您可以执行以下操作以确保 ajax 请求完成。

```
 $.when( getWorks() ).then(function(){ 
     // you can access the array in here because the ajax has finished executing
 }); 
```

# asp.net - 验证 WSDL 模式

> ID：10249947
> 
> 赞同：0
> 
> 时间：2012-04-20T16:27:09.787
> 
> 标签：asp.net, visual-studio-2010, web-services, soap, wsdl

我有这个 wsdl 规范，我必须编写代码（在 asp.net 3.5 中），但它无法由 Visual Studio 2010 导入。我尝试使用液体 XML、soapUI、xmlspy 和 webservice 测试器，它们都给出了一个错误或其他。他们一直说这是对的，但我无法导入。我希望能够准确地找到问题所在，以及不符合架构的内容。在线验证 WSDL 工具并没有真正告诉我太多或细节。谁能告诉我这个 WSDL 有什么问题？

[https://secure.avangate.com/api/merchant/?wsdl](https://secure.avangate.com/api/merchant/?wsdl)

我要测试的具体方法是“addLicense”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:54:34.183

你需要`typens:CSOAP_CardPayment`，不是`xsd:CSOAP_CardPayment`。

还有其他几个错误（通过 XMLSpy 看到）。

# c++ - 如何在不重新编码的情况下剪切 MP3？我应该只复制框架吗？

> ID：10249957
> 
> 赞同：1
> 
> 时间：2012-04-20T16:28:03.410
> 
> 标签：c++, audio, mp3

我需要实现一个功能，该功能可以通过 TCP/IP 传输大型 mp3 文件的一部分，这种方式允许用户在没有整个文件的情况下收听每个部分（使用 libmpg123）。我希望允许用户在不重新编码流的情况下传输尽可能小的部分。我想忘记重新编码，因为我不希望每次传输都会降低音质。每次我想剪切 mp3 时，我确实有样本中的分割坐标：“从什么样本到什么样本”，所以每次我都应该将其转换为 mp3 帧的 ID。所以我的问题是：

*   每个 mp3 帧是否有足够的信息（bps/samplerate/bits-per-sample/channels）来播放它而无需整个 mp3 文件头，只需将它们提供给 mp3 解码器？
*   是否有任何 BSD/MIT 许可的小型库可以用作使用样本坐标和支持 VBR 的 mp3 拆分器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:39:39.537

每个 mp3 帧都是独立的，可以独立存在。所以你不必担心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:41:48.827

你可以只剪切二进制文件！此解决方案的唯一问题...标签问题

或者试试这个： http: [//www.codeproject.com/Articles/8295/MPEG-Audio-Frame-Header](http://www.codeproject.com/Articles/8295/MPEG-Audio-Frame-Header)

# delphi - 像 Internet Explorer 一样使用 ctrl+鼠标滚轮时如何使 TWebBrowser 缩放？

> ID：10249959
> 
> 赞同：11
> 
> 时间：2012-04-20T16:28:13.077
> 
> 标签：delphi, delphi-2007, twebbrowser, iwebbrowser2

根据

[http://www.rendelmann.info/blog/CommentView,guid,356fbe68-3ed6-4781-90a4-57070a0141da.aspx](http://www.rendelmann.info/blog/CommentView,guid,356fbe68-3ed6-4781-90a4-57070a0141da.aspx)和[http://msdn.microsoft.com/en-us/library/aa770056(v=vs. 85).aspx](http://msdn.microsoft.com/en-us/library/aa770056(v=vs.85).aspx)

使用控制键和鼠标滚轮让托管的 WebBrowser 进行缩放应该只需要`IWebBrowser2.ExecWB(OLECMDID_OPTICAL_ZOOM, ...)`使用 的`pvaIn`值进行调用`100`，
但是在调用它之后，ctrl+mousewheel 仍然不会缩放内容

我在 Delphi 2007 中使用的代码：

```
const
  OLECMDID_OPTICAL_ZOOM = 63;
var
  pvaIn, pvaOut: OleVariant;
begin
  pvaIn := 100;
  pvaOut := NULL;
  WebBrowser1.ControlInterface.ExecWB(OLECMDID_OPTICAL_ZOOM,
    OLECMDEXECOPT_DONTPROMPTUSER, pvaIn, pvaOut);
end; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T18:44:40.193

杰森便士，

100 是默认值，如果你想改变缩放，你必须增加或减少这个值，从 10 到 1000。

我写了一个测试，代码如下：

```
type
  TFormWebBrowserZoom = class(TForm)
    WebBrowser1: TWebBrowser;
    procedure FormMouseWheelDown(Sender: TObject; Shift: TShiftState; MousePos: TPoint; var Handled: Boolean);
    procedure FormMouseWheelUp(Sender: TObject; Shift: TShiftState; MousePos: TPoint; var Handled: Boolean);
    procedure FormShow(Sender: TObject);
  private
    FZoom: Integer;
    FLastZoom: Integer; 

    procedure ApplyZoom(ZoomValue: Integer);
    procedure DecZoom;
    procedure IncZoom;
  end;

implementation

const
  OLECMDID_OPTICAL_ZOOM = $0000003F;
  MinZoom = 10;
  MaxZoom = 1000;
  ZoomFactor = 20;
  DefaultZoom = 100;

procedure TFormWebBrowserZoom.FormShow(Sender: TObject);
begin
  WebBrowser1.Navigate('http://www.cesarromero.com.br');
  FZoom := DefaultZoom;
  FLastZoom := DefaultZoom;
end;

procedure TFormWebBrowserZoom.ApplyZoom(ZoomValue: Integer);
var
  pvaIn, pvaOut: OleVariant;
begin
  if ZoomValue = FLastZoom then
    Exit;
  FLastZoom := ZoomValue;
  pvaIn := ZoomValue;
  pvaOut := Null;
  WebBrowser1.ControlInterface.ExecWB(OLECMDID_OPTICAL_ZOOM, OLECMDEXECOPT_DONTPROMPTUSER, pvaIn, pvaOut);
end;

procedure TFormWebBrowserZoom.DecZoom;
begin
  System.Dec(FZoom, ZoomFactor);
  if FZoom < MinZoom then
    FZoom := MinZoom;
  ApplyZoom(FZoom);
end;

procedure TFormWebBrowserZoom.IncZoom;
begin
  System.Inc(FZoom, ZoomFactor);
  if FZoom > MaxZoom then
    FZoom := MaxZoom;
  ApplyZoom(FZoom);
end;

procedure TFormWebBrowserZoom.FormMouseWheelDown(Sender: TObject; Shift: TShiftState; MousePos: TPoint; var Handled: Boolean);
begin
  DecZoom;
end;

procedure TFormWebBrowserZoom.FormMouseWheelUp(Sender: TObject; Shift: TShiftState; MousePos: TPoint; var Handled: Boolean);
begin
  IncZoom;
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T20:28:39.223

来自[http://msdn.microsoft.com/en-us/library/cc849094(v=vs.85).aspx#OptInHighDPI](http://msdn.microsoft.com/en-us/library/cc849094%28v=vs.85%29.aspx#OptInHighDPI)：

> ## [让网络变得更大：DPI 缩放和 Internet Explorer 8](http://msdn.microsoft.com/en-us/library/cc849094%28v=vs.85%29.aspx#OptInHighDPI)
> 
> **选择加入 Web 浏览器控件 (WebOC) 的高 DPI 行为**
> 
> 为了保持与以前开发的 WebOC 的兼容性，默认情况下，Internet Explorer 8 不使用 Internet Explorer 8 高 DPI 行为呈现 WebOC 的 Web 内容，而是使用 Internet Explorer 7 行为，该行为以绝对值来放大指定的字体，比如积分。要在您的程序中利用 Internet Explorer 8 高 DPI 行为，您需要使用[名为](http://msdn.microsoft.com/en-us/library/aa753277%28v=vs.85%29.aspx)`DOCHOSTUIFLAG_DPI_AWARE`. 您可以通过使用方法[GetHostInfo](http://msdn.microsoft.com/en-us/library/aa753257%28v=vs.85%29.aspx)来使用此标志，该方法具有[DOCHOSTUIINFO](http://msdn.microsoft.com/en-us/library/aa770044%28v=vs.85%29.aspx)结构作为其参数之一。反过来，**DOCHOSTUIINFO**有一个称为[DWORD 的运算符](http://msdn.microsoft.com/en-us/library/aa743780%28v=vs.85%29.aspx)`dwFlags`作为其成员之一，它可以由一个或多个**DOCHOSTUIFLAG组成**价值观。您必须包含`DOCHOSTUIFLAG_DPI_AWARE`在**dwFlags**中才能在您的 WebOC 中利用 Internet Explorer 8 高 DPI 行为。
> 
> 选择加入高 DPI 行为后，模拟 WebOC 的 HTML 内容将如何显示的快速简单的方法是在 Internet Explorer 8 中打开等效的 HTML 内容（组成在 HTML 文件中），然后只需检查以等效缩放设置（120 DPI 到 125% 缩放，144 DPI 到 150% 缩放）渲染。我们建议您在实际的高 DPI 场景中测试 WebOC，以完全确保 HTML 内容按您希望的方式呈现。

# url - 更改对 ASMX Web 服务的 JSON 调用的 URL

> ID：10249967
> 
> 赞同：0
> 
> 时间：2012-04-20T16:28:26.370
> 
> 标签：url, asmx

我们正在通过 JSON 从我们的 Web 应用程序调用“本地”ASMX Web 服务。即服务位于同一个应用程序中。

URL 是可配置的。当我们更改 URL 时，对 JSON 服务的调用不再有效。我们可以通过 fiddler 看到该 URL 正在被调用并且看起来是正确的。我们还可以通过新 URL 检索 WSDL。

是否有任何我们可能错过的硬连接到 ASMX 服务的设置？

# android - doInBackground 上的 AsyncTask 错误

> ID：10249972
> 
> 赞同：0
> 
> 时间：2012-04-20T16:28:56.240
> 
> 标签：android, android-asynctask

有人可以帮我弄清楚为什么 AsyncTask 偶尔会崩溃吗？

这是我的代码：

```
 public class statuspage extends MapActivity {

LocationManager locationManager;
MapView mapView;
Criteria criteria;
Location location;
Geocoder gc;
Address address;

String bestProvider;
String LOCATION_SERVICE = "location";
String addressString = "No address found";
StringBuilder sb;

private MapController mapController;
private MyLocationOverlay myLocation;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.statuspage);

    // Get Mapping Controllers etc //
    mapView = (MapView) findViewById(R.id.mapView);
    mapController = mapView.getController();
    mapController.setZoom(17);
    mapView.setBuiltInZoomControls(true);

    // Add the MyLocationOverlay //
    myLocation = new MyLocationOverlay(this, mapView);
    mapView.getOverlays().add(myLocation);
    myLocation.enableMyLocation();

    // Animates the map to GPS Position //
    myLocation.runOnFirstFix(new Runnable() {
        public void run() {
            mapController.animateTo(myLocation.getMyLocation());
        }
    });
}

@Override
protected boolean isRouteDisplayed() {

    // Executes GeoCoding AsyncTask //
    new GeoCoder().execute();

    // Location Manager Intiation
    locationManager = (LocationManager) statuspage.this
            .getSystemService(LOCATION_SERVICE);
    criteria = new Criteria();

    // More accurate, GPS fix.
    criteria.setAccuracy(Criteria.ACCURACY_FINE); // More accurate, GPS fix.
    bestProvider = locationManager.getBestProvider(criteria, true);
    location = locationManager.getLastKnownLocation(bestProvider);
    if (location != null) {

        // Latitude and Longitude TextView
        TextView etlongitude = (TextView) findViewById(R.id.etlongitude);
        TextView etlatitude = (TextView) findViewById(R.id.etlatitude);

        double latitude = location.getLatitude();
        double longitude = location.getLongitude();

        // Latitude and Longitude TextView Display Coordinates //
        etlongitude.setText((longitude) + "");
        etlatitude.setText((latitude) + "");

        // locationManager.removeUpdates((LocationListener) location);
        locationManager = null;

    }

    return false;
}

class GeoCoder extends AsyncTask<Void, Void, Void> {

    @Override
    protected Void doInBackground(Void... params) {
        Log.d("Class == GeoCoder", "AsyncTask == doInBackGround");

        double latitude = location.getLatitude();
        double longitude = location.getLongitude();

        gc = new Geocoder(statuspage.this, Locale.getDefault());
        try {

            List<Address> addresses = gc.getFromLocation(latitude,
                    longitude, 1);

            sb = new StringBuilder();
            if (addresses != null && addresses.size() > 0) {
                address = addresses.get(0);

                int noOfMaxAddressLine = address.getMaxAddressLineIndex();
                if (noOfMaxAddressLine > 0) {
                    for (int i = 0; i < address.getMaxAddressLineIndex(); i++) {
                        sb.append(address.getAddressLine(i)).append("\n");
                    }
                    addressString = sb.toString();
                }
            }
        } catch (Exception e) {

            addressString = e.toString();
        }
        return null;

    }

    @Override
    protected void onPostExecute(Void result) {

        TextView scrollview = (TextView) findViewById(R.id.scrollview);
        scrollview.setText("Your location:" + "\n"
                + "(Accurate to 500 meters)" + "\n" + (addressString));

        Log.d("Class == GeoCoder", "AsyncTask == onPostExecute");
        return;
    }

}

@Override
protected void onResume() {
    super.onResume();
    myLocation.enableMyLocation();
}

@Override
protected void onDestroy() {
    super.onDestroy();
    new GeoCoder();

}

@Override
protected void onPause() {
    super.onPause();
    new GeoCoder().cancel(true);
    myLocation.disableMyLocation();
}

@Override
public void onStop() {
    super.onStop();
    new GeoCoder().cancel(true);

}

@Override
public void onBackPressed() {
    new GeoCoder().cancel(true);

    // Button OnClick Vibrating Service
    Vibrator vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

    // Vibrate Service
    vib.vibrate(50);

    startActivity(new Intent(statuspage.this, AgentPortalActivity.class));
    statuspage.this.finish();

    /** Fading Transition Effect */
    overridePendingTransition(R.anim.fadein, R.anim.fadeout);

    return;

}
 } 
```

这是我的日志：

```
 04-20 09:23:15.449: D/Class == GeoCoder(22493): AsyncTask == onPostExecute
 04-20 09:23:16.082: D/Dialog(22493): dialog button was clicked
 04-20 09:23:16.136: W/MapActivity(22493): Recycling dispatcher android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher@40685938
 04-20 09:23:16.140: V/MapActivity(22493): Recycling map object.
 04-20 09:23:16.167: I/Maps.MyLocationOverlay(22493): Request updates from gps
 04-20 09:23:16.167: I/Maps.MyLocationOverlay(22493): Request updates from network
 04-20 09:23:16.179: I/Maps.MyLocationOverlay(22493): Request updates from gps
 04-20 09:23:16.183: I/Maps.MyLocationOverlay(22493): Request updates from network
 04-20 09:23:16.238: I/MapActivity(22493): Handling network change notification:CONNECTED
 04-20 09:23:16.238: E/MapActivity(22493): Couldn't get connection factory client
 04-20 09:23:16.281: D/Class == GeoCoder(22493): AsyncTask == doInBackGround
 04-20 09:23:16.300: W/dalvikvm(22493): threadid=28: thread exiting with uncaught exception (group=0x40015578)
 04-20 09:23:16.390: E/AndroidRuntime(22493): FATAL EXCEPTION: AsyncTask #16
 04-20 09:23:16.390: E/AndroidRuntime(22493): java.lang.RuntimeException: An error occured while executing doInBackground()
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at android.os.AsyncTask$3.done(AsyncTask.java:200)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.FutureTask.run(FutureTask.java:138)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.lang.Thread.run(Thread.java:1019)
 04-20 09:23:16.390: E/AndroidRuntime(22493): Caused by: java.lang.NullPointerException
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at com.jetdelivery.mobile.statuspage$GeoCoder.doInBackground(statuspage.java:111)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at com.jetdelivery.mobile.statuspage$GeoCoder.doInBackground(statuspage.java:1)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at android.os.AsyncTask$2.call(AsyncTask.java:185)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
 04-20 09:23:16.390: E/AndroidRuntime(22493):   ... 4 more 
```

继承人第 111 行：双纬度 = location.getLatitude();

几天来我一直试图弄清楚，尝试在这里搜索，在谷歌上，遵循一些例子，没有运气。

多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:55:54.267

在 isRouteDisplayed() 中初始化位置对象之前启动 GeoCoder 任务。您应该在获取位置并测试 null 后启动它，这意味着在行之后：

```
if (location != null) { 
```

您还可以在 doInBackground 中测试它的空指针，但没有它，整个方法看起来毫无用处。

崩溃有时会发生，因为您不知道任务何时开始。这意味着有时创建 GeoCoder 任务的线程将继续运行，初始化位置对象而不是任务控制。然而，这只是偶尔发生。在其他情况下，任务在第一个线程到达位置初始化代码之前开始并崩溃。

# cakephp - cakephp 在正确的级别访问 foreach()

> ID：10249973
> 
> 赞同：1
> 
> 时间：2012-04-20T16:28:59.293
> 
> 标签：cakephp, foreach

我有一个似乎无法正确访问的多维 foreach()。第一种格式回显正确的父记录，但仅回显子记录的“数组”。第二种格式回显子记录，但对父记录给出错误。我想从父级输出 4 个字段以及相应子记录的字段。

看看[Cakebin](http://bin.cakephp.org/saved/73994)的这个糊状物。它包含指向其中输出屏幕截图的链接。

任何帮助是极大的赞赏。如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:40:47.687

要使用您发布的[馅饼](http://pastie.org/3839348)更新循环：

```
foreach ($data as $invoice)
{
    debug($invoice['SOP10100']); // should give you all "header" data

    // you should be able to do this:
    foreach ($invoice['SOP10100'] as $headerKey => $headerValue)
    {
        /* snip*/
    }

    foreach ($invoice['InvoiceDetail'] as $invoiceDetail)
    {
        debug($invoiceDetail); // should show entire detail

        // also, this:
        foreach ($invoiceDetail as $detailKey => $detailValue)
        {
            /* snip*/
        }
    }
} 
```

您始终可以使用[DebugKit](https://github.com/cakephp/debug_kit)来简化调试和调查。

# caching - NSURLConnection 粘性缓存

> ID：10249974
> 
> 赞同：0
> 
> 时间：2012-04-20T16:29:00.187
> 
> 标签：caching, ios5, nsurlconnection

我在使用 NSURLConnection 时遇到了粘性缓存问题。我使用以下行创建了一个 NSMutableURLRequest：

```
 NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:60];
[request setHTTPMethod:@"POST"];
[request setValue:@"text/javascript,application/json,application/javascript;q=0.9,*/*;q=0.8" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setValue:[NSString stringWithFormat:@"%d", [requestData length]] forHTTPHeaderField:@"Content-Length"];
[request setHTTPBody: requestData]; 
```

然后我像这样建立连接：

```
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

从表面上看，一切正常，它连接并拉入服务器发送的 json 对象。如果我更新服务器上的 json 对象，使其包含另一个节点，然后通过应用程序让它请求上面的 url，它会返回 json 对象的缓存版本。正如通过输出接收到的数据所证明的那样

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection 
```

我尝试向请求的 url 添加时间戳，但仍收到缓存版本。我在每次请求之前将 receivedData var 重置为 nil，并在 connection:didReceiveData: 上重新初始化 var，但仍然获得缓存版本。

我什至设置了一个委托方法来强制不缓存：

```
- (NSCachedURLResponse *) connection:(NSURLConnection *)connection
               willCacheResponse:(NSCachedURLResponse *)cachedResponse{
    return nil;
} 
```

编辑：我通过在浏览器中点击请求的 URL 来验证更改的响应，但即使在此之后应用程序仍然使用缓存的数据。

所以我的问题是如何完全销毁缓存？

谢谢，布鲁斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:59:24.447

我发现了如何使用以下方法删除缓存：

```
[[NSURLCache sharedURLCache] removeAllCachedResponses]; 
```

不幸的是，这仍然没有解决我们的问题，因此正如 Apple Developers Forum 上的乐于助人的人所建议的那样，我们使用数据包嗅探器准确查看服务器发送的内容，并发现服务器发送的信息不正确。

感谢所有研究此问题的人。

布鲁斯

# php - 可以使用函数定义 PHP 静态类变量吗？

> ID：10249977
> 
> 赞同：2
> 
> 时间：2012-04-20T16:29:17.753
> 
> 标签：php, class, static, static-members

使用这样的变量创建一个类**可以正常工作**：

```
class Example {
    public static $example = array('simple', 'example');
    // ... 
} 
```

但是，如果我使用函数，在定义变量时，我会得到一个`unexpected '(', expecting ')'`错误：

```
class Example {
    public static $example = explode(' ', 'simple example');
    // ... 
} 
```

`static`我在没有关键字的情况下尝试了它，但仍然遇到同样的错误。在定义这样的类变量时是否可以使用函数？什么是替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:31:14.637

根据[**文档**](http://php.net/manual/en/language.oop5.static.php)（强调我的）：

> 与任何其他 PHP 静态变量一样，静态属性只能**使用文字或常量进行初始化；不允许表达**。因此，虽然您可以将静态属性初始化为整数或数组（例如），但您不能将其初始化为另一个变量、函数返回值或对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:32:30.157

数组实际上并不是一个函数，而是一个~~运算符~~字面量，这就是它起作用的原因。要使用函数，只需使用 setter 或类外部即可：

```
class Example {
    public static $example = null;
    // ... 

    public static function setE($val) {
       self::$example = $val;
    }
}

Example::$example = explode(' ', 'simple example');

// or

Example::setE(explode(' ', 'nudder example')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:31:21.390

您应该能够执行以下操作，

public static $example = new array('simple','example');

# jquery - 从表行的子元素中删除 jquery click 事件处理程序

> ID：10249981
> 
> 赞同：2
> 
> 时间：2012-04-20T16:29:28.110
> 
> 标签：jquery, html, click

我有一个表格，第一列上有一个复选框。当我单击行上的任意位置时，会在表行上设置一个类“row_selected”并选中该复选框。代码如下：

```
$('#my_table > tbody > tr > td').live('click', function() {
    if ($(this).parent().hasClass('row_selected')) {
        $(this).parent().removeClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", false)
    } else {
        $(this).parent().addClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", true)
    }
}) 
```

问题是某些表格单元格有按钮，如果单击这些按钮，我不希望该行被选中。IE

```
<tr>
    <td class="checkbox">
        <input type="checkbox" checked="false"/>
    </td>
    <td>blah<td>
    <td>
        <a class="myButton">do stuff</a>
    </td>
    <td>blah<td>
</tr> 
```

我希望 jquery 单击事件能够正常工作，除非我单击 myButton。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:44:37.640

难道你不能停止对 myButton 类元素的传播吗？

```
$('a.myButton').click(function(e) {
    e.stopPropagation();
});​ 
```

这是一个使用您的代码的简化**[jsFiddle 示例](http://jsfiddle.net/j08691/2feV7/)**，该示例显示了 td 单击触发器的工作原理，除非单击链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:37:48.860

```
$('#my_table > tbody > tr > td').live('click', function() {
    if ($(this).children('a.myButton').length) return true; // prevents click on link
    if ($(this).parent().hasClass('row_selected')) {
        $(this).parent().removeClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", false)
    } else {
        $(this).parent().addClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", true)
    }
}) 
```

Where you try to find a link inside your td and if it finds it will return true so the link will continue working. (return false if you don't want the link to be performing the "click" action)

Created a simple example on [jsFiddle](http://jsfiddle.net/Ezh8t/).

Although you could use `.stopPropagation` if you change `.live` to `.on`

```
$('a.myButton').click(function(e) {
    e.stopPropagation();
});​

$('#my_table > tbody > tr > td').on('click', function() {
    if ($(this).parent().hasClass('row_selected')) {
        $(this).parent().removeClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", false)
    } else {
        $(this).parent().addClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", true)
    }
}) 
```

[Here](http://jsfiddle.net/xPBve/) you can see a different example where `.stopPropagation` works without using `.live`. It will work only with jQuery1.7+

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:00:56.373

我通过在方法开始时获取事件源并在它不是我所期望的情况下返回来做到这一点。例如

```
function getEventSrc(e)
{
    var eventIsFiredFromElement = e.target;
    if(eventIsFiredFromElement==null)
    {
        // I.E.
        eventIsFiredFromElement = e.srcElement;
    }
    return(eventIsFiredFromElement.type);
} 
```

返回单击的元素类型。如果它是一个按钮，看起来你想停止。

```
$('#my_table > tbody > tr > td').live('click', function(ev) {
    // Make sure event is not comming from a button.
    if(getEventSrc(ev) == 'button'){return;}

    if ($(this).children('a.myButton').length) return true; // prevents click on link
    if ($(this).parent().hasClass('row_selected')) {
        $(this).parent().removeClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", false)
    } else {
        $(this).parent().addClass('row_selected')
        $('td.checkbox input', this.parentNode).prop("checked", true)
    }
}) 
```

# c# - Ruby Sequel 等效于 LINQ to SQL 选择匿名对象

> ID：10249986
> 
> 赞同：2
> 
> 时间：2012-04-20T16:29:45.757
> 
> 标签：c#, ruby, linq, sequel

我有一些带有 LINQ 查询的 C# 代码，我正在尝试将其转换为 Ruby，并使用 Sequel 作为我的 DB ORM。linq 查询只是执行一些连接，然后返回一个匿名对象，其中包含对连接实体的引用。我已经翻译并正确运行了代码，但它只返回每个表中的所有列，我想将每组列包装在它自己的对象中，类似于它在 C# 代码中的完成方式。

LINQ 查询

```
from s in slots
join tu in _dbContext.table_usages on s.id equals tu.slot_id
join r in _dbContext.Reservations on tu.reservation_id equals r.ReservationID
join o in _dbContext.orders on r.OrderID equals o.OrderID
join c in _dbContext.Contacts on r.ContactID equals c.ContactID
where tu.reservation_id != null &&
      r.state != ReservationStates.Cancelled
select new { SlotId = s.id, Reservation = r, Order = o, Contact = c, TableUsage = tu }; 
```

红宝石代码：

```
select(:slots__id, :reservations.*, :orders.*, :restaurant_customers.*, :table_usages.*)
.filter(slots__restaurant_id: restaurant_id, slots__removed: false)
.filter(slots__slot_time: start_time..end_time)
.join(:table_usages, slot_id: :id)
.join(:reservations, id: :table_usages__reservation_id)
.join(:orders, id: :reservations__order_id)
.join(:restaurant_customers, id: :reservations__contact_id)
.filter('table_usages.reservation_id is not null')
.filter('reservations.state != ?', ReservationStates.cancelled) 
```

我无法通过文档找到完成此任务的方法，但我想我会看看是否有人以我还没有想到的方式做了类似的事情。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T17:51:07.307

我假设您只是指最后两行：

```
.filter('table_usages.reservation_id is not null')
.filter('reservations.state != ?', ReservationStates.cancelled) 
```

您可以通过以下方式处理：

```
.exclude(:table_usages__reservation_id=>nil)
.exclude(:reservations__states=>ReservationStates.cancelled) 
```

exclude 用作逆过滤器。

# jquery - Jquery addClass fadeIn fadeOut 在 IE8 中不起作用

> ID：10249991
> 
> 赞同：2
> 
> 时间：2012-04-20T16:30:03.400
> 
> 标签：jquery, twitter-bootstrap, fadein, fadeout, addclass

我正在修改 IE8 的引导轮播支持。这适用于chrome和FF，但不适用于IE 8，它会改变而不会淡入。有谁知道为什么？

```
<style>
  .carousel .activerow {display: none;} 
  .carousel .row { left: 0; opacity: 1; }
  </style>

  /*I have many rows of data in the dom
   They are not visible until'active' class 
   is added.

   This code is binded to a link
  */
  var activeset = $active; //contains the contents of current row
  var nextset = $next;    //contains contents of the next 

  $active.fadeOut('slow', function () {            
      activeset.removeClass('activerow');
      nextset.addClass('active');
      nextset.fadeIn('slow');          

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:15:20.440

我认为你有一个类型-o。

```
$active.fadeOut(.... 
```

可能需要

```
$(active).fadeOut(.... 
```

编辑：在我发布这个之前没有想到。

由于您正在缓存元素，您确定您的选择器正在返回匹配项吗？

# powershell - Powershell v2.0，无法从 tcpclient 读取正确的数据

> ID：10249994
> 
> 赞同：2
> 
> 时间：2012-04-20T16:30:15.190
> 
> 标签：powershell

我对powershell编程很陌生，我有以下脚本，只要数据可用，它就会从套接字流中读取，然后发送一个“q”退出连接。我在 win 2003 server std,Power shell V2.0 上运行它。当我执行 pgm 时，输出是来自 pgm 的文本，它正在读取和缓冲。它几乎看起来像以下是输出：

在端口 23 上连接到 aardwolf.org

```
while($stream.DataAvailable)  
       {  
     $read = $stream.Read($buffer, 0, 1024)  
write-Host $read  
if($read -gt 0)  
{  
      $outputBuffer += ($encoding.GetString($buffer, 0, $read))  
}  
    }## Read the user's command, quitting if they hit 
```

以下是代码：

```
# Interact with a service on a remote TCP port
param( [string] $remoteHost = "aardwolf.org",
[int] $port = 23     )

## Open the socket, and connect to the computer on the specified port 

write-host "Connecting to $remoteHost on port $port"  
$socket = new-object System.Net.Sockets.TcpClient($remoteHost, $port) 
if($socket -eq $null) { return; } 

$stream = $socket.GetStream() 
$writer = new-object System.IO.StreamWriter($stream)

$buffer = new-object System.Byte[] 1024 
$encoding = new-object System.Text.AsciiEncoding
while($true)    
{    
## Allow data to buffer for a bit
start-sleep -m 500 
$outputBuffer = ""  
## Read all the data available from the stream, writing it to the       ## screen when   done.              
if($stream.CanRead)
{   
while($stream.DataAvailable)  
    {  
     $read = $stream.Read($buffer, 0, 1024) 
write-Host $read 
if($read -gt 0)
{ 
      $outputBuffer += ($encoding.GetString($buffer, 0, $read)) 
}
    }## Read the user's command, quitting if they hit 
}
write-Host $outputBUffer
   $command = "q"    
   $writer.WriteLine($command) 
   $writer.Flush()
break 
```

} ## 关闭流 if($writer -ne $null)
{ $writer.Close()
$stream.Close() }

需要一些帮助来解决问题。

# java - 无法理解如何使用类维护状态

> ID：10249997
> 
> 赞同：0
> 
> 时间：2012-04-20T16:30:24.127
> 
> 标签：java, oop

我是使用 OOP 的新手，我通常只是将所有代码放在一个类中并使用方法。但是我想维护状态信息并认为类是最合适的，但是我很难理解它。

假设我有一个项目列表，我想在列表中所有先前项目的总和等于 X 时停止（在本例中为 10，因此需要项目 1 + 2，然后是 2+3.etc..直到它达到阈值 10），我可以使用一种方法来计算它，但是当我真正需要做的只是增加最后一项，然后查看我的数据是否超过阈值时，我需要重新执行整个过程。到目前为止，这是我的代码，但我知道它不好，因为虽然它确实只是将类用作独立方法并在每个循环上重新计算。我的目标是，如果不需要检查阈值，则使用这种结构减少循环。

有什么建议么？

代码：

```
public class LearningClassesCounter {
    public static void main(String[] args) {
        int[] list = new int[]{1,2,3,4,5,6,7,8,9,10};
        int[] data_list = new int[list.length];
        for (int current_location = 0; current_location<list.length;current_location++) {
            //can only put commands in here. Nothing above.
            Counter checker = new Counter(data_list);
            System.out.println(checker.check_data(current_location));
            for (int i =0; i<100; i++){
                if (checker.check_data(current_location) == false) {
                    break;
                }
                data_list[current_location] = (list[current_location]+1); //this is just a random function, it could be any math function I just put it in here to show that some work is being done.
            }
        }
        //its done now lets print the results
        for (Integer item : data_list) {
            System.out.println(item);
        }
    }
}

class Counter {
    private int[] data_list;
    private int total_so_far;   
    // create a new counter with the given parameters
    public Counter(int[] data_list) {
        this.data_list = data_list;
        this.total_so_far = 0;
    } 

    public boolean check_data(int current_location) {   
        // TODO Auto-generated method stub
        int total_so_far = 0;
        //System.out.println(total_so_far);
        for (int item : data_list) {
            total_so_far = item + total_so_far;
            if (total_so_far >= 10) {
                break;
            }
        }

        if (total_so_far>=10) {
            return false;
        } else {
            return true;
        }
    }

} 
```

我不需要任何人来修复我的代码或任何东西（我想自己做，代码只是为了让我知道我在做什么）。我对我的逻辑缺陷更感兴趣，也许是一种让我更好地考虑设计类的方法，这样我就可以更好地将它们应用到我自己的情况中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:39:24.490

所以解决方案是你不`data_list`直接更新。而是在`Counter`类中有一个 setter 方法来更新索引和值。它更新数组中的值并更新计数值。

像这样的东西：

```
class Counter{
    private final int[] list;
    private count = 0;
    private final maxCount = 10;

    public Counter(int[] list){
       this.list = list;
    }

    public boolean updateValueAndCheckPastMax(int index, int value){
         list[index] = value;
         count += value;
         return count >= maxCount;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:39:35.527

你想太多了，在这种情况下，计数器类并不是真正必要的。

我也对你为什么要这样做很感兴趣：

```
data_list[current_location] = (list[current_location]+1); 
```

您是否希望您的 data_list 与列表相同，但每个值都增加 1？

如果您只是试图返回 < 10 的值的子数组，我建议只在 for 循环中执行此操作，并使用 int 作为计数器。

# java - Java 自定义序列化最佳实践

> ID：10249998
> 
> 赞同：0
> 
> 时间：2012-04-20T16:30:27.553
> 
> 标签：java, performance, serialization

我试图通过从 Serializable 接口切换到 Externalizable 来提高我们当前的序列化性能，但是没有找到很多关于创建自定义和高性能序列化的最佳实践的文档。我目前的解决方案大约是现有 Java 序列化的两倍，虽然不错，但似乎并没有我所期待的巨大改进（[序列化技术/库的基准](http://code.google.com/p/thrift-protobuf-compare/wiki/Benchmarking)）

对于除了原语之外的任何东西，我都采用了写入 0 或 1 来显示该字段存在的方法，然后如果值为 1 则读取该字段：

```
if (in.read() == 1) {
    name = in.readUTF();
} 
```

那个听起来是对的吗？有更好的编码可以使用吗？地图、列表和其他复杂的数据结构呢？枚举的默认序列化是否正常？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:35:05.537

有什么理由不使用现有的序列化框架——而是一个比 Java 内置的更好的序列化框架？我自己的偏好是[Protocol Buffers](http://protobuf.googlecode.com)，但也有其他选择，例如 Thrift。我会尽量避免进行自己的低级序列化，除非你真的无法避免。您链接到的页面显示了*许多*替代方案。

您应该同时考虑性能*和*可维护性。虽然`Externalizable` *可以*为您提供出色的性能，但最终取决于您如何实现它-您可以做得好，也可以做得不好……但这一切都是手动的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:53:05.420

从可维护性的角度来看，我尝试使用生成的数据传输对象。通过这种方式，您可以从单个定义中生成 toString、hashCode、equals、readObject、writeObject 以及可能的它们的 Builder 类。

就速度而言，这取决于您的原始数据类型。反序列化/反序列化主要有三个成本

*   使用反射，这是自定义序列化的主要好处，因为您可以对字段和类型进行硬编码
*   创建新对象。您可以使用回收的对象，但这可能很棘手。
*   您读/写的字节数。使用更紧凑的表格会有所帮助。