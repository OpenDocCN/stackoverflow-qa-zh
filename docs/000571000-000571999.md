# StackOverflow 问答 000571000-000571999

# c# - 使用 Oracle .NET 提供程序的 C# 服务变得越来越慢

> ID：571007
> 
> 赞同：2
> 
> 时间：2009-02-20T19:55:01.290
> 
> 标签：c#, .net, performance, oracle

我有一个为 .NET 2.0 编写的 C# 服务，它使用 .NET 2.102.2.20 的 Oracle 数据访问提供程序。该服务运行多个线程并对 Oracle 9.2 数据库运行大量查询。我正在使用 NHibernate。

我看到的是，当它启动时它运行得很快，然后变得越来越慢。CPU使用率从低开始上升然后上升。几分钟后，它开始爬行，CPU 达到 100%。我查看了我的代码，没有发现任何可以这样做的东西。GC 中的百分比时间 < 5%。我尝试改变 ODP.NET 参数无济于事。

任何人都知道可以这样做吗？

更多细节：线程是工作线程，需要一直运行。我没有失控的线程，他们正在做真正的工作。我已经对程序进行了概要分析，看起来它在 Oracle 提供程序中花费了大量时间，这是您所期望的，但为什么它会使用这么多 CPU？就好像它在等待结果集或其他东西一样旋转，但它不会立即发生，只有在一段时间后才会发生。

更新：这可能与服务器上的 .NET CLR 有关。一个执行大量字符串操作的多线程测试程序在这台机器上也显示出相同的行为，开始很快，然后在 15 分钟内减慢到大约 1/3 的速度。测试程序在另一台具有相同操作系统版本和相同（我们认为）.NET CLR 版本的相同服务器上没有显示这种减速行为。

更新：现在看起来这是服务器过热和热保护启动并减慢 CPU 频率的问题。

更新：服务器的固件更新修复了这个问题。我仍然认为这是一个过热问题，因为如果我停止运行该进程并让服务器“休息”一会儿，当我重新启动该进程时它会开始快速运行，但如果我终止该进程并立即重新启动该进程将开始运行缓慢。我的猜测是风扇的固件控制出现故障，因此 CPU 会发热并变慢。如果我停止运行一段时间，它们会冷却下来并再次快速运行，直到它们再次升温。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T20:01:06.097

听起来您的线程没有终止并一直在运行，或者您有一些严重的内存泄漏。如果没有更多信息，这可能是任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T20:02:10.993

如果 CPU 为 100%，则您可能正面临一个失控的线程。您可以使用 WinDbg + SoS 进行诊断。附加到进程并使用该`!runaway`命令来了解每个线程正在使用多少 CPU。然后`!clrstack`用来找出失控线程在做什么。如果您需要更多详细信息，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-11T04:38:01.593

我遇到了完全相同的问题。OracleConnection 越来越慢。有趣的是，如果我打电话：

`cn.Close(); OracleConnection.ClearPool(cn);`

每一次，它都不会放慢速度。

它必须与oracle连接有关（缓存？？）

# c# - 如何在 c# 中读取 excel 文件而不丢失任何列？

> ID：571011
> 
> 赞同：5
> 
> 时间：2009-02-20T19:56:58.807
> 
> 标签：c#, .net, excel

很长一段时间以来，我一直在使用 OleDb 连接成功读取 excel 文件，但我遇到了一个问题。我有人试图上传第一列中没有任何内容的 Excel 电子表格，当我尝试读取文件时，它无法识别该列。

我目前正在使用以下 OleDb 连接字符串：

提供者=Microsoft.Jet.OLEDB.4.0；
数据源=c:\test.xls;
扩展属性="Excel 8.0;IMEX=1;"

因此，如果 excel 文件中有 13 列，我返回的 OleDbDataReader 只有 12 列/字段。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T20:28:57.700

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/products/spreadsheetgear.net.aspx)为您提供了使用 .NET 中的 xls 和 xlsx 工作簿的 API。它比 OleDB 或 Excel COM 对象模型更易于使用且速度更快。您可以查看[现场样品或通过](http://www.spreadsheetgear.com/support/samples/)[免费试用](https://www.spreadsheetgear.com/downloads/register.aspx)亲自试用。

免责声明：我拥有 SpreadsheetGear LLC

编辑：

StingyJack 评论道“*比 OleDb 更快？更好地支持这一说法*”。

这是一个合理的要求。我总是看到我知道事实是错误的说法，所以我不能责怪任何人持怀疑态度。

下面是使用 SpreadsheetGear 创建 50,000 行 x 10 列工作簿的代码，将其保存到磁盘，然后使用 OleDb 和 SpreadsheetGear 对数字求和。SpreadsheetGear 在 0.31 秒内读取 500K 单元格，而使用 OleDB 则为 0.63 秒 - 快了两倍多。SpreadsheetGear 实际上创建和读取工作簿的时间比使用 OleDB 读取工作簿的时间要短。

代码如下。您可以通过 SpreadsheetGear 免费试用版自行尝试。

```
using System;
using System.Data; 
using System.Data.OleDb; 
using SpreadsheetGear;
using SpreadsheetGear.Advanced.Cells;
using System.Diagnostics;

namespace SpreadsheetGearAndOleDBBenchmark
{
    class Program
    {
        static void Main(string[] args)
        {
            // Warm up (get the code JITed).
            BM(10, 10);

            // Do it for real.
            BM(50000, 10);
        }

        static void BM(int rows, int cols)
        {
            // Compare the performance of OleDB to SpreadsheetGear for reading
            // workbooks. We sum numbers just to have something to do.
            //
            // Run on Windows Vista 32 bit, Visual Studio 2008, Release Build,
            // Run Without Debugger:
            //  Create time: 0.25 seconds
            //  OleDb Time: 0.63 seconds
            //  SpreadsheetGear Time: 0.31 seconds
            //
            // SpreadsheetGear is more than twice as fast at reading. Furthermore,
            // SpreadsheetGear can create the file and read it faster than OleDB
            // can just read it.
            string filename = @"C:\tmp\SpreadsheetGearOleDbBenchmark.xls";
            Console.WriteLine("\nCreating {0} rows x {1} columns", rows, cols);
            Stopwatch timer = Stopwatch.StartNew();
            double createSum = CreateWorkbook(filename, rows, cols);
            double createTime = timer.Elapsed.TotalSeconds;
            Console.WriteLine("Create sum of {0} took {1} seconds.", createSum, createTime);
            timer = Stopwatch.StartNew();
            double oleDbSum = ReadWithOleDB(filename);
            double oleDbTime = timer.Elapsed.TotalSeconds;
            Console.WriteLine("OleDb sum of {0} took {1} seconds.", oleDbSum, oleDbTime);
            timer = Stopwatch.StartNew();
            double spreadsheetGearSum = ReadWithSpreadsheetGear(filename);
            double spreadsheetGearTime = timer.Elapsed.TotalSeconds;
            Console.WriteLine("SpreadsheetGear sum of {0} took {1} seconds.", spreadsheetGearSum, spreadsheetGearTime);
        }

        static double CreateWorkbook(string filename, int rows, int cols)
        {
            IWorkbook workbook = Factory.GetWorkbook();
            IWorksheet worksheet = workbook.Worksheets[0];
            IValues values = (IValues)worksheet;
            double sum = 0.0;
            Random rand = new Random();
            // Put labels in the first row.
            foreach (IRange cell in worksheet.Cells[0, 0, 0, cols - 1])
                cell.Value = "Cell-" + cell.Address;
            // Using IRange and foreach be less code, 
            // but we'll do it the fast way.
            for (int row = 1; row <= rows; row++)
            {
                for (int col = 0; col < cols; col++)
                {
                    double number = rand.NextDouble();
                    sum += number;
                    values.SetNumber(row, col, number);
                }
            }
            workbook.SaveAs(filename, FileFormat.Excel8);
            return sum;
        }

        static double ReadWithSpreadsheetGear(string filename)
        {
            IWorkbook workbook = Factory.GetWorkbook(filename);
            IWorksheet worksheet = workbook.Worksheets[0];
            IValues values = (IValues)worksheet;
            IRange usedRahge = worksheet.UsedRange;
            int rowCount = usedRahge.RowCount;
            int colCount = usedRahge.ColumnCount;
            double sum = 0.0;
            // We could use foreach (IRange cell in usedRange) for cleaner 
            // code, but this is faster.
            for (int row = 1; row <= rowCount; row++)
            {
                for (int col = 0; col < colCount; col++)
                {
                    IValue value = values[row, col];
                    if (value != null && value.Type == SpreadsheetGear.Advanced.Cells.ValueType.Number)
                        sum += value.Number;
                }
            }
            return sum;
        }

        static double ReadWithOleDB(string filename)
        {
            String connectionString =  
                "Provider=Microsoft.Jet.OLEDB.4.0;" + 
                "Data Source=" + filename + ";" + 
                "Extended Properties=Excel 8.0;"; 
            OleDbConnection connection = new OleDbConnection(connectionString); 
            connection.Open(); 
            OleDbCommand selectCommand =new OleDbCommand("SELECT * FROM [Sheet1$]", connection); 
            OleDbDataAdapter dataAdapter = new OleDbDataAdapter(); 
            dataAdapter.SelectCommand = selectCommand; 
            DataSet dataSet = new DataSet(); 
            dataAdapter.Fill(dataSet); 
            connection.Close(); 
            double sum = 0.0;
            // We'll make some assumptions for brevity of the code.
            DataTable dataTable = dataSet.Tables[0];
            int cols = dataTable.Columns.Count;
            foreach (DataRow row in dataTable.Rows)
            {
                for (int i = 0; i < cols; i++)
                {
                    object val = row[i];
                    if (val is double)
                        sum += (double)val;
                }
            }
            return sum;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T20:05:06.760

我们总是使用 Excel Interop 打开电子表格并直接解析（例如，类似于您在 VBA 中扫描单元格的方式），或者我们创建锁定模板，强制在用户保存数据之前填充某些列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:22:23.567

您可能可以查看 ExcelMapper。它是一种将 excel 文件作为强类型对象读取的工具。它隐藏了从代码中读取 excel 的所有细节。如果您的 excel 缺少列或列中缺少数据，请注意。[您阅读了您感兴趣的数据。您可以从http://code.google.com/p/excelmapper/](http://code.google.com/p/excelmapper/)获取 ExcelMapper 的代码/可执行文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:05:15.260

如果可能要求 Excel 工作表的格式具有列标题，那么您将始终拥有 13 列。您只需要在处理时跳过标题行。

这也将纠正用户按您不期望的顺序放置列的情况。（检测标题行中的列索引并正确读取）

我看到其他人推荐 Excel 互操作，但与 OleDb 方式相比，这是一个缓慢的选择。另外，它需要在服务器上安装 Excel 或 OWC（许可）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T20:06:07.740

您可以尝试使用 Excel 和 COM。这样一来，您就可以直接从马口中获取信息。

来自 MSDN 论坛上的 D. Anand：

在您的项目中创建对 Excel 对象库的引用。可以在添加引用对话框的 COM 选项卡中添加 excel 对象库。

以下是有关 C# 中 Excel 对象模型的一些信息 [http://msdn.microsoft.com/en-us/library/aa168292(office.11 ​​).aspx](http://msdn.microsoft.com/en-us/library/aa168292(office.11).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T22:14:03.687

我建议您尝试使用 Visual Studio Tools for Office 和 Excel 互操作！它的使用非常简单。

# java - Java GUI 布局问题

> ID：571026
> 
> 赞同：1
> 
> 时间：2009-02-20T20:01:45.190
> 
> 标签：java, user-interface, swing

我正在编写一个小型 Java GUI 程序，但在 Java 布局不正确时遇到了一些问题。我最近没有做太多的 Java GUI 代码，所以我很难看出问题出在哪里。

```
 final JFreeChart chart = createChart(dataset);
    final ChartPanel chartPanel = new ChartPanel(chart, false);
    chartPanel.setPreferredSize(new Dimension(500, 270));
    JPanel buttonPanel = new JPanel();
    buttonPanel.setPreferredSize(new Dimension(500,50));

    JButton toggleButton = new JButton("Toggle");
    final JTextField minRange = new JTextField("10");
    final JTextField maxRange = new JTextField("1000");
    JButton setLimits = new JButton("Set Limits");

    buttonPanel.add(toggleButton, BorderLayout.NORTH);
    buttonPanel.add(minRange, BorderLayout.SOUTH);
    buttonPanel.add(maxRange, BorderLayout.SOUTH);
    buttonPanel.add(setLimits);

JSplitPane jsp = new JSplitPane(JSplitPane.VERTICAL_SPLIT, chartPanel, buttonPanel);
jsp.setDividerLocation(0.8);
setContentPane(jsp); 
```

这里发生的是所有布局选项都被完全忽略了。GUI 组件正确显示，并且分隔线特别忽略了 JFreeChart 的首选大小，并将其压缩到框架顶部大约 5% 的空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T21:09:05.437

除了拆分窗格不符合您所需大小的问题外，您正在使用 BorderLayout 常量，但您尚未指定面板的布局（默认为 FlowLayout）。

这个：

```
JPanel buttonPanel = new JPanel(); 
```

应该：

```
JPanel buttonPanel = new JPanel(new BorderLayout()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T20:36:32.907

我相信在 JSplitPane 上使用浮动比例仅在“实现”拆分窗格后才有效，否则您将获得零比例，因为它不知道它将有多大。

还：

```
buttonPanel.add(minRange, BorderLayout.SOUTH);
buttonPanel.add(maxRange, BorderLayout.SOUTH); 
```

BorderLayout 只允许一个组件位于每个区域中，因此 min range 永远不会出现，因为 maxRange 现在是“南”组件。如果您想要两者，则需要将这两个组件放在另一个面板中，然后将该面板添加到南部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:32:09.107

***永远不要***调用 setPreferredSize() - 它应该是一个计算。

例如，您的 ButtonPanel 被设置为固定的首选大小。

如果您添加 I18N 支持并且用户正在使用具有很长本地化的语言怎么办？如果用户调整框架大小怎么办？

查看我关于布局管理器的文章，了解如何真正使用它们的详细信息。它是从 1999 年开始的，但仍然适用：

[http://java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/](http://java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/)

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:05:54.463

尝试设置最小尺寸。

请参阅：[Java GUI 问题](https://stackoverflow.com/questions/538240/java-gui-problems)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T20:06:38.690

`JSplitPane`注意最小尺寸，而不是首选尺寸。尝试简单地更改`setPreferredSize`为`setMinumumSize`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T21:30:06.040

Dan Dyer 是正确的，您没有设置布局。

你也可以设置它`buttonPanel.setLayout(new BorderLayout())`

约翰加德纳是正确的，你将一个组件设置为`BorderLayout.SOUTH`两次。

如果您还不了解[MigLayout](http://www.miglayout.com/) ，还可以查看它。它是我用过的最不“令人惊讶”的布局管理器。它只是工作。这需要一些学习，但是一旦你掌握了语法，就会非常直接。

如果可以的话，我会避免使用 SplitPane ......它非常挑剔

# ios - 更改 UITabBar 的色调/背景颜色

> ID：571028
> 
> 赞同：87
> 
> 时间：2009-02-20T20:02:04.957
> 
> 标签：ios, iphone, uitabbarcontroller, uitabbar

UINavigationBar 和 UISearchBar 都有一个 tintColor 属性，允许您更改这两个项目的色调颜色（我知道，这很奇怪）。我想在我的应用程序中对 UITabBar 做同样的事情，但现在找到了将其从默认黑色更改的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2011-12-19T21:18:08.930

iOS 5 添加了一些新的外观方法来自定义大多数 UI 元素的外观。

您可以使用外观代理来定位应用程序中的每个 UITabBar 实例。

对于 iOS 5 + 6：

```
[[UITabBar appearance] setTintColor:[UIColor redColor]]; 
```

对于 iOS 7 及更高版本，请使用以下内容：

```
[[UITabBar appearance] setBarTintColor:[UIColor redColor]]; 
```

使用外观代理将更改整个应用程序中的任何选项卡栏实例。对于特定实例，请使用该类的新属性之一：

```
UIColor *tintColor; // iOS 5+6
UIColor *barTintColor; // iOS 7+
UIColor *selectedImageTintColor;
UIImage *backgroundImage;
UIImage *selectionIndicatorImage; 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-14T17:17:56.867

我已经能够通过子类化 UITabBarController 并使用私有类来使其工作：

```
@interface UITabBarController (private)
- (UITabBar *)tabBar;
@end

@implementation CustomUITabBarController

- (void)viewDidLoad {
    [super viewDidLoad];

    CGRect frame = CGRectMake(0.0, 0.0, self.view.bounds.size.width, 48);
    UIView *v = [[UIView alloc] initWithFrame:frame];
    [v setBackgroundColor:kMainColor];
    [v setAlpha:0.5];
    [[self tabBar] addSubview:v];
    [v release];

}
@end 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-12-30T20:51:34.910

我对最终答案有一个附录。虽然基本方案是正确的，但可以改进使用部分透明颜色的技巧。我假设它只是为了让默认渐变显示出来。哦，另外，TabBar 的高度是 49 像素而不是 48 像素，至少在 OS 3 中是这样。

所以，如果你有一个合适的 1 x 49 的渐变图像，这是你应该使用的 viewDidLoad 版本：

```
- (void)viewDidLoad {

    [super viewDidLoad]; 

    CGRect frame = CGRectMake(0, 0, 480, 49);
    UIView *v = [[UIView alloc] initWithFrame:frame];
    UIImage *i = [UIImage imageNamed:@"GO-21-TabBarColorx49.png"];
    UIColor *c = [[UIColor alloc] initWithPatternImage:i];
    v.backgroundColor = c;
    [c release];
    [[self tabBar] addSubview:v];
    [v release];

} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-10-05T10:45:43.610

当您只使用 addSubview 您的按钮将失去可点击性，所以而不是

```
[[self tabBar] addSubview:v]; 
```

采用：

```
[[self tabBar] insertSubview:v atIndex:0]; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-20T20:11:21.487

没有简单的方法可以做到这一点，你基本上需要继承 UITabBar 并实现自定义绘图来做你想做的事。对于效果来说，这是相当多的工作，但它可能是值得的。我建议向 Apple 提交一个错误，以将其添加到未来的 iPhone SDK 中。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-02-03T05:21:00.383

以下是对此的完美解决方案。这适用于 iOS5 和 iOS4。

```
//---- For providing background image to tabbar
UITabBar *tabBar = [tabBarController tabBar]; 

if ([tabBar respondsToSelector:@selector(setBackgroundImage:)]) {
    // ios 5 code here
    [tabBar setBackgroundImage:[UIImage imageNamed:@"image.png"]];
} 
else {
    // ios 4 code here
    CGRect frame = CGRectMake(0, 0, 480, 49);
    UIView *tabbg_view = [[UIView alloc] initWithFrame:frame];
    UIImage *tabbag_image = [UIImage imageNamed:@"image.png"];
    UIColor *tabbg_color = [[UIColor alloc] initWithPatternImage:tabbag_image];
    tabbg_view.backgroundColor = tabbg_color;
    [tabBar insertSubview:tabbg_view atIndex:0];
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-01-02T18:46:44.977

在 iOS 7 上：

```
[[UITabBar appearance] setBarTintColor:[UIColor colorWithRed:(38.0/255.0) green:(38.0/255.0) blue:(38.0/255.0) alpha:1.0]]; 
```

我还建议首先根据您的视觉需求进行设置：

```
[[UITabBar appearance] setBarStyle:UIBarStyleBlack]; 
```

栏样式在您的视图内容和标签栏之间放置了一个微妙的分隔符。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-06-03T18:12:09.223

`[[self tabBar] insertSubview:v atIndex:0];` 非常适合我。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-03-01T09:34:44.547

对我来说，更改 Tabbar 的颜色非常简单，例如：-

```
[self.TabBarController.tabBar setTintColor:[UIColor colorWithRed:0.1294 green:0.5686 blue:0.8353 alpha:1.0]];

[self.TabBarController.tabBar setTintColor:[UIColor "YOUR COLOR"]; 
```

试试这个！！！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-10-31T01:16:24.517

```
 [[UITabBar appearance] setTintColor:[UIColor redColor]];
 [[UITabBar appearance] setBarTintColor:[UIColor yellowColor]]; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-11-03T13:27:12.650

**仅用于背景颜色**

```
Tabbarcontroller.tabBar.barTintColor=[UIColor redcolour]; 
```

或者这个在 App Delegate

```
[[UITabBar appearance] setBackgroundColor:[UIColor blackColor]]; 
```

**用于更改标签栏未选择图标的颜色**

对于 iOS 10：

```
// this code need to be placed on home page of tabbar    
for(UITabBarItem *item in self.tabBarController.tabBar.items) {
    item.image = [item.image imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];
} 
```

iOS 10 以上：

```
// this need to be in appdelegate didFinishLaunchingWithOptions
[[UITabBar appearance] setUnselectedItemTintColor:[UIColor blackColor]]; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-08T06:45:17.183

```
[v setBackgroundColor ColorwithRed: Green: Blue: ]; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-02-20T21:23:41.183

现有答案中有一些好主意，许多工作方式略有不同，您选择的内容还取决于您的目标设备以及您想要实现的外观。`UITabBar`在自定义外观方面是出了名的不直观，但这里还有一些技巧可能会有所帮助：

1）。如果您想摆脱光滑的覆盖层以获得更平坦的外观，请执行以下操作：

```
tabBar.backgroundColor = [UIColor darkGrayColor]; // this will be your background
[tabBar.subviews[0] removeFromSuperview]; // this gets rid of gloss 
```

2）。要将自定义图像设置为 tabBar 按钮，请执行以下操作：

```
for (UITabBarItem *item in tabBar.items){
    [item setFinishedSelectedImage:selected withFinishedUnselectedImage:unselected];
    [item setImageInsets:UIEdgeInsetsMake(6, 0, -6, 0)];
} 
```

在哪里`selected`和`unselected`是`UIImage`您选择的对象。如果您希望它们成为纯色，我发现的最简单的解决方案是创建`UIView`所需的 a `backgroundColor`，然后在`UIImage`QuartzCore 的帮助下将其渲染为 a。我在一个类别中使用以下方法`UIView`来获取`UIImage`视图的内容：

```
- (UIImage *)getImage {
    UIGraphicsBeginImageContextWithOptions(self.bounds.size, NO, [[UIScreen mainScreen]scale]);
    [[self layer] renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return viewImage;
} 
```

3) 最后，您可能想要自定义按钮标题的样式。做：

```
for (UITabBarItem *item in tabBar.items){
    [item setTitleTextAttributes: [NSDictionary dictionaryWithObjectsAndKeys:
                [UIColor redColor], UITextAttributeTextColor,
                [UIColor whiteColor], UITextAttributeTextShadowColor,
                [NSValue valueWithUIOffset:UIOffsetMake(0, 1)], UITextAttributeTextShadowOffset,
                [UIFont boldSystemFontOfSize:18], UITextAttributeFont,
            nil] forState:UIControlStateNormal];
} 
```

这使您可以进行一些调整，但仍然非常有限。特别是，您不能随意修改文本在按钮内的放置位置，并且不能为选中/未选中的按钮设置不同的颜色。如果您想做更具体的文本布局，只需设置`UITextAttributeTextColor`为清晰并将您的文本添加到第 (2) 部分的`selected`和`unselected`图像中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-08-03T11:09:13.253

另一个解决方案（这是一个 hack）是将 tabBarController 上的 alpha 设置为 0.01，这样它实际上是不可见的，但仍然可以点击。然后在 MainWindow 笔尖的底部设置一个 ImageView 控件，并在 alpha'ed tabBarCONtroller 下方使用您的自定义标签栏图像。然后在 tabbarcontroller 切换视图时交换图像、更改颜色或突出显示。

但是，您将失去“...更多”并自定义功能。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-12-22T17:55:18.523

嗨，我正在使用 iOS SDK 4，我只用两行代码就可以解决这个问题，就像这样

```
tBar.backgroundColor = [UIColor clearColor];
tBar.backgroundImage = [UIImage imageNamed:@"your-png-image.png"]; 
```

希望这可以帮助！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-05-07T16:18:49.487

```
if ([tabBar respondsToSelector:@selector(setBackgroundImage:)]) {
    // ios 5 code here
    [tabBar setBackgroundImage:[UIImage imageNamed:@"image.png"]];
} 
else {
    // ios 4 code here
    CGRect frame = CGRectMake(0, 0, 480, 49);
    UIView *tabbg_view = [[UIView alloc] initWithFrame:frame];
    UIImage *tabbag_image = [UIImage imageNamed:@"image.png"];
    UIColor *tabbg_color = [[UIColor alloc] initWithPatternImage:tabbag_image];
    tabbg_view.backgroundColor = tabbg_color;
    [tabBar insertSubview:tabbg_view atIndex:0];
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-14T10:02:51.120

**Swift 3.0 答案：（**来自 Vaibhav Gaikwad）

用于更改标签栏未选择图标的颜色：

```
if #available(iOS 10.0, *) {
        UITabBar.appearance().unselectedItemTintColor = UIColor.white
    } else {
        // Fallback on earlier versions
        for item in self.tabBar.items! {
            item.image = item.image?.withRenderingMode(UIImageRenderingMode.alwaysOriginal)
        }
} 
```

仅用于更改文本颜色：

```
UITabBarItem.appearance().setTitleTextAttributes([NSForegroundColorAttributeName: UIColor.white], for: .normal)

UITabBarItem.appearance().setTitleTextAttributes([NSForegroundColorAttributeName: UIColor.red, for: .selected) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-04-04T18:49:26.367

Swift 3 使用您`AppDelegate`的外观执行以下操作：

`UITabBar.appearance().barTintColor = your_color`

# sql - 以下选择语句是否符合 SQL92？

> ID：571032
> 
> 赞同：0
> 
> 时间：2009-02-20T20:02:43.427
> 
> 标签：sql, ansi-92

以下选择语句是否符合 SQL92？

```
SELECT table1.id, table2.id,*  
FROM table1, table2  
WHERE table1.id = table2.id 
```

* * *

```
SELECT table1.Num, table2.id,*  
FROM table1, table2  
WHERE table1.Num = table2.id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T20:18:48.007

继StingyJack之后...

```
SELECT 
    table1.id, 
    table2.id,
    * 
FROM
    table1
    INNER JOIN 
    table2 ON table1.id = table2.id
WHERE
    table1.column = 'bob'

SELECT table1.id, table2.id,* FROM table1, table2 WHERE table1.id = table2.id and table1.column = 'bob' 
```

JOIN 在哪里？过滤器在哪里？

JOIN 还强制进行一些纪律和基本检查：更容易避免交叉连接或部分交叉连接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T20:12:18.660

我可能错了，但我的理解是 SQL92 约定是使用 JOIN 语句连接表（例如 FROM table1 INNER JOIN table2）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T20:12:58.767

不幸的是，我相信它们是，但是连接语法更难阅读和维护。

我知道使用 MSSQL，这两种连接方法中的任何一种都没有性能差异，但哪一种更容易理解？

```
SELECT table1.id, table2.id,* 
FROM table1, table2 
WHERE table1.id = table2.id

SELECT 
 table1.id, 
 table2.id,
 * 
FROM table1
   INNER JOIN table2 
     ON table1.id = table2.id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T21:43:03.717

是的，您显示的查询使用符合 SQL92 的语法。[我的 Jim Melton 和 Alan R. Simon 的“理解新 SQL：完整指南](https://rads.stackoverflow.com/amzn/click/com/1558602453)”副本证实了这一点。

SQL92 仍然支持使用逗号语法的连接，以便与 SQL89 向后兼容。据我所知，所有 SQL 实现都支持逗号语法和`JOIN`语法连接。

在大多数情况下，SQL 实现知道如何优化它们，以使它们在语义（即，它们产生相同的结果）和性能上相同。

# sql-server - 反复将数据从 SQL Server 移动到 Oracle

> ID：571051
> 
> 赞同：12
> 
> 时间：2009-02-20T20:10:59.757
> 
> 标签：sql-server, database, oracle

定期将表数据从 SQL Server 移动到 Oracle（在 *nix 上）的最合理方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-20T20:28:33.207

使用 SQL Server Integration Services (SSIS) 可能是您最好的选择。如果您不熟悉 SSIS，最好的尝试方法是使用 SQL Server 导出向导并让它为您创建一个 SSIS 包。例如，如果您进入 SQL Server Management Studio 并右键单击您的数据库，然后选择 Tasks->Export Data。从那里单击下一步，直到进入“选择目的地”步骤。选择“Microsoft OLE DB Provider for Oracle”并单击“属性”来定义您的数据库连接。当您单击向导时，在“保存并执行”页面上，确保选中标记为“保存 SSIS 包”的复选框，在下一个屏幕上指定保存 SSIS 包的位置。完成导出向导后，您的数据将被导出，并且您将拥有一个 SSIS 包，您可以按原样使用它，也可以对其进行调整以执行更具体的操作。获得 SSIS 包后，您可以通过创建 SQL Server 代理作业来安排它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T20:11:27.663

*   Oracle[异构连接](http://download.oracle.com/docs/cd/B19306_01/server.102/b14232/toc.htm)/[数据库网关](http://www.oracle.com/technology/products/gateways/index.html)与物化视图、PL/SQL 或 Java 结合使用
*   [SSIS](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)或[DTS](http://en.wikipedia.org/wiki/Data_Transformation_Services)：两者都可以计划，但需要的不仅仅是对 SQL Server 的只读访问权限
*   Java（可能在 Oracle 中，但可选在操作系统中）使用 ODBC 或 SQLJ 访问 SQL Server，可能还有 Oracle
*   SQL Server 计划导出到 CSV，Oracle 计划从 CSV 导入
*   任何其他 ETL 工具（例如 Informatica、Cognos）
*   可以访问这两个数据库的无数语言中的任何一种（但需要维护第三个环境来运行应用程序）

调度：

*   自动/不需要物化视图
*   Oracle DBMS_JOB / DBMS_SCHEDULER
*   特定于操作系统（cron、Windows 计划任务等）
*   对于 SSIS、DTS 或 CSV 导出，在 SQL Server 中安排

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T20:15:39.917

您可以通过 SSIS（或 2k 的 DTS）直接与 Oracle 建立 SQL Server 接口。它将提供 ETL 功能，并且可以定期安排。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T17:19:34.357

创建从 Oracle 到 Sql Server 的数据库链接（异构连接）。您可以使用此链接通过简单的 select 语句从 Sql Server 检索数据。如果要调度，可以使用物化视图或 dbms_scheduler。

另一种方法是将数据放在 csv 文件中，您可以使用外部表或 sqlloader 将此数据加载到 Oracle 数据库中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-26T14:01:50.147

这是我所做的：Oracle SQL 开发人员使用此链接连接到 SQL Server： [https ://kentgraziano.com/2013/01/14/tech-tip-connect-to-sql-server-using-oracle-sql-开发商/](https://kentgraziano.com/2013/01/14/tech-tip-connect-to-sql-server-using-oracle-sql-developer/)

添加 SQL jar 后，您将在 Connection 窗口中看到 SQL Server 选项卡：

[![在此处输入图像描述](https://i.stack.imgur.com/RlWLX.png)](https://i.stack.imgur.com/RlWLX.png)

然后连接到 SQL 实例。

然后打开 SQL 实例并选择要复制的数据库或表。右键单击任何数据库/表，然后单击那里的“复制到 oracle”，然后在要复制表的“目标连接名称”中选择正确的用户 [数据库]。

您还可以在那里更改一些属性。单击“确定”，就是这样。

如果有任何问题，请告诉我。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T21:14:39.913

我成功地在 SQL Server 端创建了与 Oracle 的链接服务器（我认为是在企业管理器中）。然后我可以在两边使用普通的存储过程来完成更小的数据移动和双向更新。这种方法可以绕过尝试将某些东西放在数据库之外的需要。

尽量在 SQL Server 端使用最新的可能的 Oracle 客户端。我记得 10.2.0.2 客户端中的一些缺陷，并且获得 10.2.0.4 客户端需要您的“官方”Oracle 注册或购买号或其他东西。

对于大数据移动（或者甚至可能是您希望每天或更频繁地进行的移动/更新），一定要使用 ETL 工具之一。我们的 ETL 流程使用了 Informatica，但如果 SSIS 能够满足您的需求，那也很好。

# sql - 为什么 SQL 2005 说这个 UDF 是不确定的？

> ID：571065
> 
> 赞同：3
> 
> 时间：2009-02-20T20:14:25.287
> 
> 标签：sql, user-defined-functions, deterministic, non-deterministic

我有以下功能：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO    
ALTER FUNCTION [dbo].[IP4toBIGINT](
    @ip4 varchar(15)
) 
RETURNS bigint
WITH SCHEMABINDING
AS
BEGIN
    -- oc3 oc2 oc1 oc0
    -- 255.255.255.255
    -- Declared as BIGINTs to avoid overflows when multiplying later on     DECLARE @oct0 bigint, @oct1 bigint, @oct2 bigint, @oct3 bigint;
    DECLARE @Result bigint;

    SET @oct3 = CAST(PARSENAME(@ip4, 4) as tinyint);
    SET @oct2 = CAST(PARSENAME(@ip4, 3) as tinyint);
    SET @oct1 = CAST(PARSENAME(@ip4, 2) as tinyint);
    SET @oct0 = CAST(PARSENAME(@ip4, 1) as tinyint);

    -- Combine all values, multiply by 2^8, 2^16, 2^24 to bitshift.
    SET @Result = @oct3 * 16777216 + @oct2 * 65536 + @oct1 * 256 + @oct0;
    RETURN @Result;

END 
```

但...

```
SELECT 
     OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsDeterministic') as IsDeterministic 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsPrecise') as IsPrecise 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsSystemVerified') as IsSystemVerified 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'SystemDataAccess') as SystemDataAccess 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'UserDataAccess') as UserDataAccess 
```

返回（结果转置）：

确定性 0

精确 1

IsSystemVerified 1

系统数据访问 0

用户数据访问 0

我尝试多次删除并重新创建该函数，以确保它不是一些缓存问题。CAST 在这里应该是确定性的，因为我将它用于字符串-> 整数。

我完全被难住了，有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T20:36:08.213

PARSENAME 总体上是不确定的。是的，您在确定性的上下文中使用它，但我猜服务器不知道这一点。尝试替换 PARSENAME 并查看它是否更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T20:41:08.623

这是导致问题的 PARSENAME。用硬编码字符串替换它会导致确定性。不知道为什么... parse name 应该只是一个花哨的拆分函数。

看一下这个：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO    
ALTER FUNCTION [dbo].[IP4toBIGINT](
    @ip4 varchar(15)
) 
RETURNS bigint
WITH SCHEMABINDING
AS
BEGIN
    -- oc3 oc2 oc1 oc0
    -- 255.255.255.255
    -- Declared as BIGINTs to avoid overflows when multiplying later on         
    DECLARE @oct0 bigint, @oct1 bigint, @oct2 bigint, @oct3 bigint;
    DECLARE @Result bigint;

    SET @oct3 = CAST('1' as tinyint);
    SET @oct2 = CAST('2' as tinyint);
    SET @oct1 = CAST('3' as tinyint);
    SET @oct0 = CAST('4' as tinyint);

    -- Combine all values, multiply by 2^8, 2^16, 2^24 to bitshift.
    SET @Result = @oct3 * 16777216 + @oct2 * 65536 + @oct1 * 256 + @oct0

    RETURN @Result
END
GO

SELECT 
     OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsDeterministic') as IsDeterministic 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsPrecise') as IsPrecise 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'IsSystemVerified') as IsSystemVerified 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'SystemDataAccess') as SystemDataAccess 
    ,OBJECTPROPERTYEX(OBJECT_ID('dbo.IP4toBIGINT'), 'UserDataAccess') as UserDataAccess 
```

结果：

```
IsDeterministic IsPrecise IsSystemVerified  SystemDataAccess UserDataAccess
1               1         1                 0                0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T21:11:34.167

嗯，是的，所以问题确实是 PARSENAME 的使用。MSDN[明确表示](http://msdn.microsoft.com/en-us/library/ms178091(SQL.90).aspx)它是确定性的。也许这是因为 SQL 假设您将读取 DB 模式？这表明不确定性，但我只是在推测。

# c# - 如何在选项卡中选择 Winforms NumericUpDown 中的所有文本？

> ID：571074
> 
> 赞同：67
> 
> 时间：2009-02-20T20:17:54.480
> 
> 标签：c#, .net, winforms, numericupdown

当用户进入我的标签时，`NumericUpDown`我希望选择所有文本。这可能吗？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-02-20T20:24:07.120

```
private void NumericUpDown1_Enter(object sender, EventArgs e)
{
    NumericUpDown1.Select(0, NumericUpDown1.Text.Length);
} 
```

（请注意，Text 属性在 Intellisense 中是隐藏的，但它就在那里）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-11-20T16:13:27.980

我想为以后一直在搜索 Tab 和 Click 的人添加此内容。

Jon B 的答案非常适合 Tab，但我需要修改以包含点击

如果您进入或单击进入，下面将选择文本。如果您单击并输入该框，那么它将选择文本。如果您已经专注于该框，则单击将执行其通常执行的操作。

```
 bool selectByMouse = false;

    private void quickBoxs_Enter(object sender, EventArgs e)
    {
        NumericUpDown curBox = sender as NumericUpDown;
        curBox.Select();
        curBox.Select(0, curBox.Text.Length);
        if (MouseButtons == MouseButtons.Left)
        {
            selectByMouse = true;
        }
    }

    private void quickBoxs_MouseDown(object sender, MouseEventArgs e)
    {
        NumericUpDown curBox = sender as NumericUpDown;
        if (selectByMouse)
        {
            curBox.Select(0, curBox.Text.Length);
            selectByMouse = false;
        }
    } 
```

您可以将其用于多个 numericUpDown 控件。只需要设置 Enter 和 MouseDown 事件

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-08T04:10:25.860

我环顾四周，我遇到了同样的问题，这对我有用，首先选择项目，第二个选择文本，希望对未来有所帮助

```
myNumericUpDown.Select();
 myNumericUpDown.Select(0, myNumericUpDown.Value.ToString().Length); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-15T15:54:21.457

我创建了一个扩展方法来实现这一点：

VB：

```
<Extension()>
Public Sub SelectAll(myNumericUpDown As NumericUpDown)
    myNumericUpDown.Select(0, myNumericUpDown.Text.Length)
End Sub 
```

C＃：

```
public static void SelectAll(this NumericUpDown numericUpDown)
    numericUpDown.Select(0, myNumericUpDown.Text.Length)
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-12T13:40:52.190

我有多个 numericupdown 框，并希望为所有人实现这一目标。我建立：

```
private void num_Enter(object sender, EventArgs e)
{
    NumericUpDown box = sender as NumericUpDown;
    box.Select();
    box.Select(0, num_Shortage.Value.ToString().Length);
} 
```

然后通过将此函数与每个框的 Enter Event 相关联（我没有这样做），我的目标就实现了。我花了一段时间才弄清楚，因为我是初学者。希望这可以帮助别人

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-15T07:50:23.000

为了通过鼠标单击或 Tab 按钮选择所有文本，我使用：

```
 public frmMain() {
        InitializeComponent();
        numericUpDown1.Enter += numericUpDown_SelectAll;
        numericUpDown1.MouseUp += numericUpDown_SelectAll;
    }

    private void numericUpDown_SelectAll(object sender, EventArgs e) {
        NumericUpDown box = sender as NumericUpDown;
        box.Select(0, box.Value.ToString().Length);
    } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-09-16T12:11:00.757

尝试

```
 myNumericUpDown.Select(0, myNumericUpDown.Value.ToString().Length); 
```

# c - 如何编译一个C程序？

> ID：571076
> 
> 赞同：4
> 
> 时间：2009-02-20T20:18:20.830
> 
> 标签：c, windows, gcc, compiler-construction, porting

好久没做C了。我想编译[这个程序](http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html)，但我不知道如何进行。似乎makefile经常引用GCC，而我从未使用过GCC。

我只想要一个可以在 Windows 上运行的可执行文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T20:25:51.547

您可能需要安装 cygwin 或 mingw，它们是用于 Windows 的类 UNIX 环境。

*   [http://www.mingw.org/](http://www.mingw.org/)
*   [http://www.cygwin.com/](http://www.cygwin.com/)

在下载/安装 cygwin 或 mingw 时，您可以选择下载和安装一些可选功能；您将需要以下内容：

*   gcc（首先尝试版本 2.x，而不是 3.x）
*   二进制工具
*   GNU make（或 gmake）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T20:20:51.480

如果它需要 gcc 并且您希望它在 Windows 上运行，您可以下载 Cygwin。

这基本上是适用于 Windows 的 GNU/Linux 类型的模拟器。它适用于仿真 DLL。

[http://www.cygwin.com/](http://www.cygwin.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T20:46:14.960

为了编译这个程序，你需要一个 C 编译器。它不一定是 gcc，尽管您已经获得了一个设置为使用 gcc 的 makefile。您要做的最简单的事情是：

1.  安装[cygwin](http://www.cygwin.com)
2.  打开cygwin命令提示符
3.  进入你有你的makefile的目录
4.  输入“制作”
5.  那应该编译你的程序

如果您不习惯使用命令行工具，您可以下载[免费版](http://www.microsoft.com/Express/)的 MS Visual Studio 并将源文件导入新的 Visual Studio 项目。这样您就不需要安装 cygwin 和使用 gcc，但您需要知道如何在 Visual Studio 中创建项目和运行程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T20:24:24.513

您几乎可以肯定不需要所有 cygwin 来使用 gcc 进行编译。有很多适用于 Windows 的独立 gcc 克隆，例如[gcw](http://sourceforge.net/projects/gcw/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-20T20:31:24.900

如果它是相当可移植的 C 代码（我没有看过它），那么您可以忽略包含的 Makefile 并将源代码提供给您想要使用的任何编译器。当你尝试时会发生什么？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T23:24:34.860

[Dev-C++](http://www.bloodshed.net/devcpp.html)提供了一个简单但不错的 IDE，它使用 Mingw gcc 编译器并提供 Makefile 支持。以下是我使用 Dev-C++ 构建上述代码的步骤（即这是“操作方法”）

从 NIST 下载源 zip 后，我

*   下载并安装了 Dev-C++ 5 beta 9 版本
*   创建了一个新的空项目
*   添加了 sts-2.0\src 中的所有 .c 文件

然后在项目选项下

*   `-lm`在参数下的链接器列中添加
*   添加`sts-2.0\include`到目录中的包含目录
*   将 Executable 和 Object 目录设置为`obj`Build Options 下的目录

然后点击确定关闭对话框。转到执行>编译并让它旋转。一分钟后，您可以在目录中找到可执行文件`sts-2.0\obj`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-22T05:43:09.793

首先，只有 makefile 的程序几乎不可能使用 Visual Studio 构建，这仅仅是因为 Visual Studio 不是标准 POV 的优秀 C 编译器（尤其是数学函数在 MS 编译器上的支持非常差）。这可能是可能的，但这并不容易，特别是如果您不熟悉 C。您应该真正坚持使用 makefile，而不是尝试在自己的 IDE 中导入代码——这种科学代码显然是为了从命令行编译。这是一个测试套件，所以随机尝试并不是一个好主意。

您应该使用 mingw + msys 来安装它：mingw 将为您提供编译器（gcc 等）和 msys 外壳，以使 make 文件正确运行。与另一张海报相反，我建议您不要使用 gcc 2 - 我认为这没有任何意义。我经常在 windows 上使用 gcc 3（甚至 4）来构建科学代码，当代码类似于 unix（这是此类代码的标准平台）时，它运行良好。

# java - Java用户账户管理解决方案

> ID：571081
> 
> 赞同：4
> 
> 时间：2009-02-20T20:19:06.757
> 
> 标签：java, security, web-applications

我目前正在开发一个依赖权限机制来管理用户内容的 Java Web 应用程序。这当然意味着我们需要管理用户。我们当前的用户管理系统是一个内部系统，用于管理有关 RDBMS 中的用户、组、用户和权限的信息。该系统可以工作，但维护起来很麻烦。我想找到一种方法来简化事情。

鉴于用户管理是许多 Web 应用程序的核心功能，因此管理用户的软件包似乎必须在 Internet 机器上普遍使用。您使用什么解决方案来管理用户？似乎 Spring Security 包之类的东西可能会起作用，但我想在将自己锁定到 Spring Security 之前先了解一下可用的东西。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T20:30:34.170

您正在寻找诸如 LDAP 或 Active Directory 之类的东西来管理您的用户。您将使用 Spring Security 来应用/实施您存储在 LDAP 中的安全信息。可以肯定的是，您可以将任何应用服务器配置为使用 LDAP 进行开箱即用的基本身份验证和授权功能。

# python - 在 Python 中，如何登录、通过 HTTP POST（非 url 编码）回答 Web 表单并获取返回的 XML 文件？

> ID：571083
> 
> 赞同：3
> 
> 时间：2009-02-20T20:20:18.923
> 
> 标签：python, authentication, cookies, post

我基本上是在尝试每周一次导出配置文件。虽然有问题的产品允许您通过 Web 客户端手动登录，输入一些信息，并在您提交时获取 XML 文件，但没有自动执行此操作的工具。我可以使用 Python 2.5（已经使用了一段时间）或 2.6（不熟悉）来做到这一点。

1.  我认为我需要有某种方法来对产品进行身份验证。虽然我可以在 Firefox 中查看 cookie，但当我查看实际`cookie.txt`文件时，它并不存在。清除我的私人数据并重新认证后没有出现。奇怪的。我应该为模块拍摄，还是这可能是某种*看起来*像 cookie`Cookie`的神秘身份验证方法？我怎么会知道？

**   我想我需要`httplib`模块来执行 HTTP POST，但我不知道如何进行`multipart/form-data`编码。我是否忽略了一个方便的选择，或者这是我必须自己推出的东西？

    *   `HTTPesponse`我假设我可以在from中取回 XML 文件`httplib`。* 

 *我以前通过 Python 获取 Web 内容，但没有使用 POST、多部分编码和身份验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T20:23:05.500

[urllib2](http://docs.python.org/library/urllib2.html)应该涵盖所有这些。

这是一个[基本身份验证示例](http://www.voidspace.org.uk/python/articles/urllib2.shtml#id6)。

这是一个[带有 multipart/form-data 的帖子](http://code.activestate.com/recipes/146306/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T20:25:44.183

尝试[机械化](http://wwwsearch.sourceforge.net/mechanize/)模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T20:47:51.663

您应该查看 MultipartPostHandler：

[http://odin.himinbi.org/MultipartPostHandler.py](http://odin.himinbi.org/MultipartPostHandler.py)

如果您需要支持 unicode 文件名，请参阅修复： http: [//peerit.blogspot.com/2007/07/multipartposthandler-doesnt-work-for.html](http://peerit.blogspot.com/2007/07/multipartposthandler-doesnt-work-for.html)

# javascript - 如果安装了 Firefox 3 附加组件/扩展，如何使用 Javascript 检查

> ID：571092
> 
> 赞同：2
> 
> 时间：2009-02-20T20:22:58.823
> 
> 标签：javascript, firefox, add-on

实际上这个问题是基于一个[博客条目](http://enricofoschi.wordpress.com/2008/08/21/how-to-check-with-javascript-if-a-firefox-add-on-extension-is-installed/)，它讨论了 FF2 的主题。但是这如何与 FireFox 3 一起工作？

我知道必须有一个解决方法，因为最近我访问了一个网站说：“请在进入此网站之前禁用 AdBlock+”:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T20:45:08.533

出于安全原因，没有通用的方法可以做到这一点。即使是提到的 FF2 版本也特定于该特定扩展 - 您不能假设所有扩展的名称和位置都相同。

正如斯蒂芬推测的那样，AdBlock-spotters 往往是基于行为的并且特定于该扩展。同样，Greasemonkey-spotters 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T09:00:04.173

请看这个网址。[http://www.guyfromchennai.com/?p=104](http://www.guyfromchennai.com/?p=104)这对我有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T20:35:45.907

他们还有其他方法可以检测 AdBlock+。它可以说明您从未使用某些服务器端代码加载广告并假设您正在使用它，也许？

或者，如果广告是基于 Flash 的，则 javascript 可能会先尝试与之通信。

# visual-studio-2008 - IronXSLT 下载？xmllab.net 离线

> ID：571094
> 
> 赞同：2
> 
> 时间：2009-02-20T20:23:11.753
> 
> 标签：visual-studio-2008, xslt, plugins

有人有 IronXSLT 的安装程序吗？

xmllab.net 似乎已经倒闭，再也没有复活

[http://www.xmllab.net/Products/IronXSLT/tabid/187/Default.aspx](http://www.xmllab.net/Products/IronXSLT/tabid/187/Default.aspx)

[http://74.125.113.132/search?q=cache:jk_L4-aOCi8J:www.xmllab.net/Products/IronXSLT/tabid/187/Default.aspx%3FPageContentID%3D52+ironxslt&hl=en&ct=clnk&cd=13&gl=us&client=火狐-a](http://74.125.113.132/search?q=cache:jk_L4-aOCi8J:www.xmllab.net/Products/IronXSLT/tabid/187/Default.aspx%3FPageContentID%3D52+ironxslt&hl=en&ct=clnk&cd=13&gl=us&client=firefox-a)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T23:06:58.147

现在 Oleg 正在为 Microsoft 工作，也许 IronXSLT 被卷入其中：

[http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionID=a6a4ab2b-89aa-45ab-bbbf-3e84ce44af82](http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionID=a6a4ab2b-89aa-45ab-bbbf-3e84ce44af82)

现在称为：XSLT Profiler Addin

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T18:15:11.903

似乎是 Brothersoft 的镜像：

> [http://www.brothersoft.com/ironxslt-download-181062.html](http://www.brothersoft.com/ironxslt-download-181062.html)

# c# - 取消订阅子对象道具更改事件

> ID：571109
> 
> 赞同：3
> 
> 时间：2009-02-20T20:26:37.643
> 
> 标签：c#, .net, events

假设我有一个对象 Client，它有一个子 StatusType 对象。两者都实现了 INotifyPropertyChanged。

客户端在检查 null 并确保值不同后订阅属性中的 prop changed 事件

```
public StatusType Status
{
    get { return _status ?? (_status = this.GetNewStatusType()); }
    set
    {
        if (!(_status ?? (_status = this.GetNewStatusType())).Equals(value))
        {
            _status.PropertyChanged -= Status_PropertyChanged;
            _status = value;
            _status.PropertyChanged += Status_PropertyChanged;
            base.OnPropertyChanged("Status"); 
        }
    }
} 
```

客户端侦听属性更改事件并将其冒泡。

```
void Status_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
     base.OnPropertyChanged("Status." + e.PropertyName);
} 
```

Client 和 StatusType 都继承自 EntitiesBase，后者负责实现 INotifyPropertyChanged 的​​实际繁重工作。

所以我的实际问题是，出于内存原因，我是否需要让 Client 取消订阅 StatusType.PropertyChanged 事件？如果是这样，我应该使用解构器，还是让客户端实现 IDisposable？

如果我要使用解构器，它会看起来像这样吗？

```
~Client()
{
    if (_status != null)
    {
        _status.PropertyChanged -= Status_PropertyChanged;
        _status = null;
    }
} 
```

提前致谢。在我们的应用程序中，有时我们的内存中可能有超过 1000 个客户端，我想确保我的效率很高。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T20:30:28.977

如果这些客户端无限期地保留在内存中并且它们的 AppDomain 永远不会被卸载，那么您可能会造成内存泄漏。 `IDisposable`可能是一条更好的路线，因为您将有一种确定的方法来清理您不再需要的处理程序。

[编辑] 请记住，即使您可以从事件的调用列表中删除委托，您也不会在 GC 运行之前释放内存。

您也可能对此感兴趣：http: [//msdn.microsoft.com/en-us/library/aa970850.aspx](http://msdn.microsoft.com/en-us/library/aa970850.aspx)

# winapi - 用符号反汇编 Win32 DLL

> ID：571122
> 
> 赞同：0
> 
> 时间：2009-02-20T20:31:19.113
> 
> 标签：winapi, assembly, reverse-engineering

我搜索了谷歌，发现了大量的工具和答案。我想将 DLL 分解成至少可读的东西，例如通过名称识别 Win32 API 调用等。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T20:36:48.057

看看[这个](http://programmerstools.org/taxonomy/term/25)。他们中的任何一个都可以为你工作，但 IDA 摇滚......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T20:36:42.987

我认为您正在寻找的是[Windows Symbol Packages](http://www.microsoft.com/whdc/DevTools/Debugging/symbolpkg.mspx)。当您安装这些时，您基本上会获得大多数 Windows API 的符号信息（调试信息），包括 Kernel32 和 advapi（我发现这是我编程中的两个大人物）。

您可能需要告诉调试器和/或编译器符号所在的位置 - 只要确保您记住它们的安装位置，然后您可以使用调试器选项（有时称为“sympath”）告诉调试器在哪里找到它们。

# c# - 如何将数据从旧服务器提取到 SQL 服务器？

> ID：571125
> 
> 赞同：0
> 
> 时间：2009-02-20T20:33:22.853
> 
> 标签：c#, .net, asp.net, sql, sql-server

我想编写一个将数据从服务器传输到我的 SQL Server 的代码。在我放入数据之前，我想删除当前数据。然后将数据从一个到另一个。我怎么做。这是我到目前为止的代码片段。

```
string SQL = ConfigurationManager.ConnectionStrings["SQLServer"].ToString();
string OLD = ConfigurationManager.ConnectionStrings["Server"].ToString();

SqlConnection SQLconn = new SqlConnection(SQL);
string SQLstatement = "DELETE * FROM Data";
SqlCommand SQLcomm = new SqlCommand(SQLstatement, SQLconn);
SQLconn.Open();

OdbcConnection conn = new OdbcConnection(OLD);
string statement = "SELECT * FROM BILL.TRANSACTIONS ";
statement += "WHERE (TRANSACTION='NEW') ";            
OdbcCommand comm = new OdbcCommand(statement, conn);
comm.CommandTimeout = 0;
conn.Open();

SqlDataReader myDataReader = SQLcomm.ExecuteReader();
while (myDataReader.Read())
{
    //...            
}
SQLconn.Close();
SQLconn.Dispose(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T21:21:31.723

根据您使用的 SQL Server 版本，此处的标准解决方案是使用 DTS（2000 及之前）或 SSIS（2005 及更高版本）。如果需要，您可以将其转换为可执行文件，直接从 SQL Server 安排它，或手动运行它。这两个工具都相当健壮（尽管 SSIS 更强大），具有清除现有数据、发生错误时回滚、必要时转换数据、写出异常等方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T21:24:22.200

如果可能的话，我会尝试在 SQL Server 中完成所有操作。您可以创建一个链接服务器到您的其他数据库服务器。然后简单地使用 T-SQL 复制数据 - 它看起来像......

```
INSERT INTO new_server_table (field1, field2)
SELECT x, y
FROM mylinkedserver.myolddatabase.myoldtable 
```

如果您需要定期执行此操作或首先清除数据，您可以使用 SQL 代理将其作为计划任务的一部分执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T20:36:58.087

如果你只需要导入一次数据，而且你有很多数据，为什么不使用“BULK INSERT”命令呢？ [关联](http://msdn.microsoft.com/en-us/library/ms188365.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T20:38:06.180

T-SQl 允许您从`select`查询中插入数据。它看起来像这样：

```
insert into Foo
select * from Bar; 
```

只要字段类型对齐，这将起作用 - 否则您将不得不按摩数据`Bar`以适应`Foo`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T21:37:44.260

当您需要这样做一次时，请查看数据库发布向导（只是 google）并生成一个可以完成所有操作的脚本。

# svn - 我应该有 1 个还是多个存储库？

> ID：571127
> 
> 赞同：7
> 
> 时间：2009-02-20T20:35:09.463
> 
> 标签：svn, version-control

我发现自己在问一个问题：我应该为这个客户的所有项目创建一个存储库吗？还是我应该为每个单独的存储库？

你通常决定哪个？

请列出导致您做出决定的任何一种方法的优缺点。

编辑：请为以下之一标记为重复：

[一个 SVN 存储库还是多个？](https://stackoverflow.com/questions/252459/one-svn-repository-or-many)

[我应该将所有项目存储在一个存储库中还是多个存储库中？](https://stackoverflow.com/questions/130447)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T20:38:41.903

出于与 Ken 的回答相同的原因，我有一个大型存储库：

[一个 SVN 存储库还是多个？](https://stackoverflow.com/questions/252459/one-svn-repository-or-many/252491#252491)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T20:38:02.297

我对“所有内容”使用单个存储库，因为它使项目之间的内容移动变得更加容易 - 至少使用 SVN。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T20:46:01.310

我为每个项目都有一个存储库，因为它使版本号保持独立。我遵循了 TortoiseSVN 帮助第 4.1.5 节“存储库布局”中的思路：

> 如果项目不是密切相关并且每个项目都单独签出，则按项目编制索引是有意义的。

在这种情况下，我将 SVN 用于我自己的本地备份，所以这对我来说很有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:41:54.470

我在 .NET 开发商店工作，我们有两个 Visual SourceSafe 存储库。一种用于我们的旧版 .NET 1.1 应用程序，另一种用于我们较新的 .NET 2.0/3.0/3.5 应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T20:43:20.223

我能想到的原因只有一个，不能将它们全部放在一个存储库中。也就是说，如果您无权配置存储库所在的服务器，并且您需要将存储库的某些部分限制为不同的人员集。

我们有一个集中管理的服务器，我们可以根据需要创建存储库，但不能更改配置。我们有一个仅供内部使用的主代码存储库，但会创建其他代码库以与组织外部的人员协作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T20:46:08.250

对于每种类型的项目和访问它的人员类型，我们都有一个存储库。例如，我们所有的 .NET 项目都在一个存储库中，我们所有的遗留应用程序都在一个存储库中。这样，我们的 .NET 开发人员就不会意外地对我们的旧开发人员进行攻击（反之亦然）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T20:50:49.973

我曾经为所有项目使用一个存储库，直到它变得如此之大以至于提交项目的速度真的变慢了——这是使用 Subversion。如果您的项目要保存大量数据，尤其是二进制数据，那么我建议您使用单独的存储库。如果您主要只是存储代码，那么单个存储库更易于维护。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T20:52:48.890

我使用了几个存储库——尽管我承认在组织代码方面，我有点强迫症，而且我喜欢非常有条理和独特的东西。

我在我们公司管理 SCM 存储库，目前我们有三个：一个用于主要项目，一个用于包/库，一个用于第三方代码。如果我要再做一次，我也会为媒体文件创建一个单独的存储库（我们有很多需要版本控制的 mp3/wav 文件），但是唉，它们在我们的主存储库下。

我认为使用多个存储库的唯一有力论据（除了被强迫组织）是它可以更容易地处理每个存储库的访问权限，而根据您的 SCM 环境，这对于多个路径可能并不那么容易在一个回购协议下。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T21:06:45.737

我几乎所有事情都使用 git。所以我每个项目都有一个存储库（无论是 /etc、编码项目还是用户配置文件）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-20T21:29:38.957

如果您对所有内容都使用一个存储库，那么设置自动构建或继续集成变得更加困难。即使您现在不打算这样做，现在设置它也不是一个坏主意，这也为您提供了额外的好处，使您可以更轻松地管理您的内容。

一个好的经验法则是为每组不同的解决方案\项目创建一个存储库。

如果您有一个不共享任何内容的解决方案，请为每个解决方案创建一个存储库。另一个例子是，如果您有一个 .NET 1.1 版本的应用程序，并且您想创建一个 2.0 版本的应用程序分支您的代码并为您的新代码创建一个单独的存储库，这也可以使用 .NET 3.0 和 .NET 来完成。净 3.5。

# vb.net - 帮助我在我正在维护的 VB.NET 2.0 应用程序中找到的功能

> ID：571129
> 
> 赞同：0
> 
> 时间：2009-02-20T20:35:48.027
> 
> 标签：vb.net

我正在浏览一些本应显示 2/1/2009 - 2/28/2009 的报告，但显示的是 2/1/2009 - 3/1/2009。我已将错误缩小到此代码，有什么建议吗？

```
Function GetMonthLastDate(ByVal sDateTime As DateTime)
    Try
        Dim strArrMonth() As String = {"", "31", "29", "31", "30", "31", "30", "31", "31", "30", "31", "30", "31"}
        Dim days As Integer
        If sDateTime.Month = 2 Then
            If sDateTime.Year Mod 400 = 0 Then Return sDateTime.AddDays(28)
            If sDateTime.Year Mod 100 = 0 Then Return sDateTime.AddDays(27)
            If sDateTime.Year Mod 4 = 0 Then Return sDateTime.AddDays(28)
        End If
        days = strArrMonth(sDateTime.Month)
        Return Format(sDateTime.AddDays(days - 1), "MM/dd/yyyy")
    Catch ex As Exception
        Response.Write("<script>alert('" & ex.Message & "');</script>")
    End Try
End Function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T20:42:09.227

为什么不使用[`DateTime.DaysInMonth`](http://msdn.microsoft.com/en-us/library/system.datetime.daysinmonth.aspx)？它使代码*更加*清晰。

```
Function GetMonthLastDate(ByVal srcDate As DateTime) As String
    return _
       new DateTime(srcDate.Year, srcDate.Month, _
                    DateTime.DaysInMonth(srcDate.Year, srcDate.Month)) _
           .ToString("MM/dd/yyyy")
End Function 
```

您可以轻松（并且可能应该）返回 DateTime 本身（通过更改返回类型并取消 nixing `.ToString(...)`），但我看到您的原始函数将它作为格式化字符串返回，因此出于兼容性目的，我保留了它的方式你有它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T20:44:01.143

在查找数组中，索引 2（值为 29）仅适用于闰年。

整个函数很糟糕：它过于复杂，返回错误的结果，没有指定返回类型，不仅参数名称上有类型前缀，而且前缀*错误*。

改为这样做：

```
Function GetLastMonthDate(ByVal dtDateTime As DateTime) As DateTime
    Return dtDateTime.AddDays(DateTime.DaysInMonth(dtDateTime.Year, dtDateTime.Month)-dtDateTime.Day)
End Function 
```

除此之外，看起来原来的返回一个字符串，这真的不合适。这个函数应该返回一个 DateTime 并让调用它的函数处理适当的字符串转换。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T20:40:51.430

对于它正在做的事情，这是一些非常复杂的代码。你可以像这样完成同样的事情：

```
Function GetMonthLastDate(ByVal sDateTime As DateTime)
  Dim nextMonth As DateTime = sDateTime.AddMonths(1)
  Return New DateTime(nextMonth.YearPart, nextMonth.MonthPart, 1).AddDays(-1)
End Function 
```

这可能有点神秘，但它应该可以工作并且可以为清楚起见进行扩展。

# algorithm - 帮助人类选择的算法（例如小猫战争）

> ID：571132
> 
> 赞同：12
> 
> 时间：2009-02-20T20:36:32.627
> 
> 标签：algorithm, graph-theory

好吧，我正面临着我的家人即将加入的人，并且正在努力选择名字。

我考虑过编写软件来显示名字并强迫我选择我更喜欢的，类似于小猫战争。

但是，一旦我得到一个巨大的图表，我就不知道如何处理它，尤其是如果有循环的话。例如，我喜欢 mike 胜过 sam，sam 胜过 jared， jared 胜过 mike - 简单地分配选票并计算它们是没有意义的（我认为 kitten war 就是这样做的）。此外，我可能有一天会得到 mike vs jared 并以一种方式投票，但如果我在另一天得到它，就会以不同的方式投票。

所以：

*   获得数据后，如何处理图表并对名称进行排名？

交替：

*   还有哪些有用的算法可以用来做出选择（比如车辆样式，如果你正在寻找一辆新车）？

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T20:44:25.870

您可能想查看我不久前提出的一个问题的答案：[如何使用众包排序对一百万张图像进行排名](https://stackoverflow.com/questions/164831/how-to-rank-a-million-images-with-a-crowdsourced-sort)- 关于如何处理大量比较操作的结果以得出排名有一些很好的建议。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T20:44:35.230

> 例如，我喜欢迈克胜过山姆，山姆胜过杰瑞德，杰瑞德胜过迈克

如果你发现是这种情况，你可以断定你不适合选择名字，应该听从重要的其他人的选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T20:39:12.043

我以为我们已经经历了这个，答案仍然是 Jon Skeet :) 所有其他数据都无关紧要。

编辑：恭喜顺便说一句:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-20T21:02:10.350

这是错误的实现：[You're Doing It Wrong](http://www.codinghorror.com/blog/archives/001223.html)。这正是**Shell Always Win**算法的正确应用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-20T21:02:50.910

我不知道这个算法的可扩展性如何，但我已经在我设计的几个带有排名的网站中成功实现了它（改编自[IMDB 的评级](http://www.imdb.com/chart/top)）：

加权评级 (WR) =`(v / (v+m)) * R + (m / (v+m)) * C`

在哪里：

*   R =小猫的平均值（平均值）=（投票数/投票人数）
*   v = 小猫的票数 = (votes)
*   m = 进入前 100 名所需的最低票数（大约 25 是一个安全数字）
*   C =所有小猫的平均投票=（投票总和）/（投票的每个人的总和）

* * *

上面的算法适用于小猫战争风格的网站，但对于“专家系统”或推荐引擎来说，它**不是**一个合适的算法。

推荐引擎的一种方法——我不能保证是好的方法——是在矩阵中表示不同的选择。假设您想挑选一条裙子，您可能会表示裙子的不同属性，如下所示：

```
             时尚实惠多彩实用
迷你裙 10 5 7 5
拉拉裙 3 1 10 1
草裙 2 7 2 1
牛仔裙 9 5 3 10

```

现在，你问用户他们想穿什么样的衣服：

*   [X] 时尚的东西？
*   [ ] 买得起的东西？
*   [ ] 色彩斑斓的东西？
*   [X] 实用的东西？

上面的输入表明用户正在寻找时尚实用的东西，而不关心其他属性，因此很容易将上面的数据处理如下：

```
             时尚实用总
牛仔裙 9 10 19
迷你裙 10 5 15
啦啦裙 3 1 4
草裙 2 1 3

```

只要您知道要比较的每个对象的属性，这种非常简单但有效的方法就可以工作。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-20T21:12:12.447

查看有关“配对比较/偏好排名”的机器学习论文。

这是一篇可以帮助您入门的论文：[Pairwise Preference Learning and Ranking](http://www.springerlink.com/index/30KAXE2AVT9U6AF4.pdf)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-20T20:44:27.583

> 还有哪些有用的算法可以用来做出选择[...]？

1.  为配偶单位提供婴儿姓名簿。
2.  等待配偶单位就未来的婴儿姓名提供意见。

3.  拒绝冒犯性的选择

4.  重复直到您和配偶单位就名字达成一致，或者婴儿出生……在这种情况下，请在列表中选择最容易拼写的选项，这样医院就不会搞砸出生证明

这对我来说效果很好，两次。我们甚至不需要练习第 11 小时最简单的拼写选项！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-20T21:43:08.973

这是我们使用的算法：

1.  为每位家长分配一种性别。指定该父母为该性别的**主要**代号。
2.  允许，不*鼓励*，根据他们在任何特定时间的奇思妙想或奇思妙想来产生可能的后代名称列表。
3.  指定另一位父母为**替补**。对于非主要性别，候补人只有一项能力，那就是**否决权。** 替代者可能表达了对一个特定选项的偏好，但实际上只是在自欺欺人。
4.  **否决权获胜。** 它不需要任何理由或解释（尽管在父母打算保持婚姻幸福状态的情况下推荐一些……）。
5.  如果潜在子代是迭代 n>=2，您可以咨询迭代 n=1 以获得额外的排名建议。在大多数情况下，这种启发式应该被认为是**决定性的一票**。

在我们的案例中，我是两个案例中的主要成员（两个男孩），而 NumberOneSon 是我们在为 SecondSon 选择名称时的决定性投票。而且你最好相信 WifeUnit 是 A-OK 挥舞着她的否决权......

简而言之，恭喜。育儿是个麻烦。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-20T20:41:18.433

如果您跟踪赢/输，您可能更愿意向您显示赢/输比率高的名称。最终，您喜欢的名字会冒泡到顶部，并且更有可能相互比较。您可能还想为尚未比较或很少比较的名称添加一些权重。

在一定数量的损失后淘汰名称，确保不要将相同的名称相互比较两次，因为无论如何这都是你的意见。

一旦你从垃圾中过滤掉了“最佳产品”，你将直接比较最好的，竞争风格，直到你选择一个赢家。（或者只是在那时手动查看它们）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-20T21:11:06.727

我很确定迈克是正确的选择。

# .net - 标准 .Net TDD 内存测试

> ID：571138
> 
> 赞同：0
> 
> 时间：2009-02-20T20:37:34.450
> 
> 标签：.net, unit-testing, memory-management, memory-leaks

编写会暴露常见内存问题的标准化 TDD [测试] 方法是否有用？

这组测试可以轻松、快速地应用于方法，并且会使“经典”.NET 内存问题失败，但会通过经典解决方案。

例如，常见的内存问题可能是：垃圾收集器重定位过多；分配太多；太多的垃圾回收（经典示例更喜欢 StringBuilder 而不是字符串 reallocs ）；持有内存太久（经典示例调用 dispose 并且不依赖终结器）；物体不恰当地到达 g1, g2, LOH ；随着时间的推移，小泄漏会增加一些重要的东西，......等等。

也许代码看起来像这样……</p>

```
[Test]
public void Verify_MyMethodUnderTest_Is_Unlikely_To_Have_Common_Memory_Problem()
{

//-Setup
var ExpectationToleranceA = ...
var ExpectationToleranceB = ...
...

//-Execute
var MeasurementA = MyClassUnderTest.MyMethodUnderTest( dependancyA ) ; 
var MeasurementB = MyClassUnderTest.MyMethodUnderTest( dependancyB ) ; 
…

//-Verfiy
Assert.That(  MeasurementA  , Is.WithinTolerance( ExpectationToleranceA  ) ) ;
Assert.That(  MeasurementB  , Is.WithinTolerance( ExpectationToleranceB  ) ) ;

} 
```

还有其他关于内存压力问题的帖子，但这里的想法是能够快速将标准测试指向一个方法，并且测试会在常见/经典内存压力问题上失败，但通过常见解决方案绿色通过。然后可能会指示开发人员检查失败的代码并可能修复泄漏、更改容差甚至删除 TDD 内存压力测试。

这个想法有腿吗？

这里有一个与 C++ 应用程序相关的问题，[运行单元测试时的内存泄漏检测](https://stackoverflow.com/questions/169058/memory-leak-detection-while-running-unit-tests)，这是一个类似的问题，但并不完全相同。Twk 的问题是指在所有测试运行后查看内存...

我的想法是针对 .NET 1) 对常见内存问题的每种方法进行单元测试 2) 经典内存问题失败 3) 通过经典常见内存问题的经典修复 4) 能够快速对函数进行快速标准测试看它是否表现出经典症状 5) 能够升级在单元测试中应用的标准 TDD .Net 内存压力测试。这意味着对上述代码进行重构，以便升级到标准测试将更改升级整个项目的 Nunit 测试套件中应用的内存测试。

（ps 我知道没有 Is.WithinTolerance 电话，但我只是在展示一个想法。）干杯...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T20:47:17.767

单元测试通常最好用于测试小块功能。你所追求的听起来有点像集成测试，它测试整个系统的行为和性能。

我在这种方法中看到的问题是系统中的任何给定单元都可能不会生成这些与内存相关的错误。因此，即使您可以使这样的东西工作，您也不能保证一旦您的单元作为一个整体工作就不会出现内存问题。

所以我的建议是在多个状态下进行集成测试。在不同的负载水平下测试系统，看看会出现什么样的内存问题（如果有的话）。这种测试对你会更有益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T20:57:37.023

我会说这是一个坏主意。如果您想编写测试来“验证”垃圾收集器的某些行为，那么您基本上是在“测试”您无法控制的代码。垃圾收集器的确切行为是当前 CLR 的实现细节。它可能会在未来发生变化，从而导致您的测试“失败”。在大多数情况下，您可能无法更改代码中的任何内容来“修复”测试，因此您不得不更改测试以反映新的实现。在我看来，这用途有限。

应该使用单元测试来验证您自己的代码的意图，以便在更改破坏现有代码时通知您。使用它们来帮助开发和维护您自己的代码。

以我的经验，最好的结果是通过确保单元测试没有依赖关系来实现的。进行您描述的那种测试意味着测试将对硬件和运行时系统有很多依赖关系。

只是我的 5 美分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T22:19:04.080

好的单元测试应该针对小段代码。理想情况下，它们应该是可重复的，但当涉及垃圾收集器时，情况并非如此。

不过，您*可以*使用单元测试框架工具进行非单元测试（功能测试、回归测试、压力测试……）。但是您需要***注意***，您不是在进行真正的单元测试。所以不要在一些自动构建中使用它们，也不要强迫其他开发人员在他们的提交测试中包含这样的测试。**真正的单元测试可能不会受到非单元测试的影响！**

如果您想做这样的事情，请考虑在您要测试的操作之前和之后调用 GC.Collect() 方法。连续多次调用以更轻松地感知内存消耗的增长。考虑在单独的夜​​间构建中添加此类测试（与实际单元测试分开），因为这可能很耗时。在您可以完全控制的单独机器上调用测试（测试期间带有一些 Flash 动画的打开浏览器或病毒扫描程序可能会弄乱您的结果）。将内存消耗的数字存储在某个地方以供以后查看。这将使您意识到在较长的开发周期中内存消耗会缓慢增加。

# c# - 如何可靠地保证对文件/文件夹的访问？

> ID：571152
> 
> 赞同：1
> 
> 时间：2009-02-20T20:41:29.697
> 
> 标签：c#, file

- 确保我要操作的文件夹或文件可访问（非只读）的最简单方法是什么？

-我知道我可以使用 ACL 添加/设置条目（使文件/文件夹非只读），但我怎么知道我是否需要使用安全权限来确保文件访问？还是我可以将其添加为额外措施并处理异常/负面情况？

-我怎么知道什么时候关闭或只刷新流？例如，我是否应该尝试在方法中使用一次流，然后在最后刷新/关闭/丢弃？如果我使用 dispose()，我还需要显式调用 flush() 和 close() 吗？

我问这个问题是因为不断确保文件可用是核心要求，但很难保证这一点，所以我的代码设计中的一些技巧会很好。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T21:43:43.713

无法保证对文件的访问。我知道这不是一个受欢迎的回应，但它是 100% 正确的。即使您在 Win32 机器上打开了独占的非共享文件，您也永远无法保证对文件的访问。

失败的方式太多了，你根本无法控制。经典示例是通过网络打开的文件。使用任何帐户以任何方式打开它，我只需走过并拉动网线即可。这将终止您对文件的访问。

我说这不是刻薄或傲慢。我这样说是为了确保人们理解对文件系统进行操作是一项非常危险的操作。您**必须**接受该操作可以并且将会失败。任何涉及磁盘的操作都必须有一个备用方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T20:48:11.880

> - 确保我要操作的文件夹或文件可访问（非只读）的最简单方法是什么？

以写模式打开它们？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T20:52:03.947

*   尝试将新文件写入文件夹并捕获任何异常。除此之外，还会进行正常的完整性检查，例如文件夹/文件是否存在等。

*   您永远不应该更改代码中的文件夹安全性，因为环境可能会发生巨大变化并导致严重的问题。而是确保事先对安全性进行详细记录和配置。或者，在您自己的代码中使用模拟，以确保您始终以对文件夹/文件具有完全权限的用户身份运行所需的代码。

*   除非您别无选择，否则切勿调用 Dispose()。您总是在关闭文件之前或想要将流的内容提交到文件/磁盘时刷新。何时执行此操作的选择取决于需要写入的数据量以及写入数据所涉及的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:53:37.860

确保文件夹可写的 100% 万无一失的方法 - 创建一个文件，关闭它，验证它是否存在，然后删除它。有点乏味，但你要求万无一失=）

如果您无法写入文件，则更好的选择是处理各种异常，其中涵盖了您关于 ACL 的问题。

此外，我总是显式调用 Close ，除非我需要在完成写入之前从文件中读取（在这种情况下，我调用 flush 然后 close ）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T21:11:20.187

*   Flush() - 将内存缓冲区与磁盘同步。当您想将缓冲区写入磁盘但保持文件打开以供进一步使用时调用。
*   Dispose(bool) - 释放非托管资源（即 OS 文件句柄），如果传递为 true，则还释放托管资源。
*   Close() - 在对象上调用 Dispose(true)。

此外，Dispose 在关闭句柄之前会刷新数据，因此无需显式调用刷新（尽管根据您正在处理的数据的数量和类型，频繁刷新可能是个好主意）。

如果您正在对文件进行相对原子操作并且不需要长时间运行的句柄，则“使用”范例对于确保您正确处理文件很有用，例如：

```
using (StreamReader reader = new StreamReader("filepath"))
{
    // Do some stuff
} // CLR automagically handles flushing and releasing resources 
```

# ios - 复制 UITableViewCell

> ID：571158
> 
> 赞同：7
> 
> 时间：2009-02-20T20:43:25.950
> 
> 标签：ios, objective-c, iphone, uitableview, cocoa-touch

我正在`tableView:cellForRowAtIndexPath:`从 nib 文件中读取自定义表格单元格。这对我的目的很有用，只是速度很慢。

现在，我知道从长远来看正确的做法是完全在代码中创建单元格，并使用单个视图，等等。但这是一个原型，我不想为此付出太多努力。

现在，如果我在`UIViewController`子类中只阅读笔尖一次，然后`tableView:cellForRowAtIndexPath:`复制它，我会很高兴。我在这里的假设是复制会比阅读笔尖更快。

这是我用来加载笔尖的东西，我从`viewDidLoad:`（和`retain`之后）调用

```
-(id)loadFromNamed:(NSString*)name {
    NSArray *objectsInNib = [[NSBundle mainBundle] loadNibNamed:name
                                                          owner:self
                                                        options:nil];
    assert( objectsInNib.count == 1 );
    return [objectsInNib objectAtIndex:0];
} 
```

到目前为止一切都很好。但问题是：我如何一遍又一遍地复制它？甚至可能吗？

我试过`[_cachedObject copy]`但`[_cachedObject mutableCopy]`不`UITableViewCell`支持任何一种复制协议。

如果必须，我可以告诉他们在我准备完全移除笔尖之前忽略速度，但如果这里有一个低垂的果实，我宁愿让它快一点。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-03-17T12:00:17.693

我认为表格单元格的处理可以与出队机制一起使用，这将允许一次创建单元格（从 nib 或以编程方式或从其他 nib 自动加载并链接为 IB 中的出口）然后克隆它或将其出列需要的时候。

UITableViewCell 不符合 NSCopying 协议，但支持 keyed 归档/取消归档机制，因此可以用于克隆。

基于回答“ [如何在 Objective C 中复制 UIButton？](https://stackoverflow.com/questions/1092875/how-to-duplicate-an-object-in-objective-c/1093043#1093043) ”我的数据源委托方法如下所示：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellID = @"CellIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellID];

    if (!cell) {
        NSData *archivedData = [NSKeyedArchiver archivedDataWithRootObject:self.tableViewCell];
        cell = [NSKeyedUnarchiver unarchiveObjectWithData:archivedData];
    }

    // ... config ...

    return cell;
} 
```

在我的例子中*self.tableViewCell*是一个从视图的 nib 文件中加载一次的单元格。

我没有测试什么会更快：克隆“归档+取消归档”或“加载笔尖文件+取消归档”框架在*-loadNibNamed:owner:options:*的情况下会做什么，我使用这种方法只是为了方便考虑，但是内存操作与文件操作的好机会会更快。

编辑：它似乎并不像起初看起来那么容易。由于 UIImage 不符合 NSCoding，因此配置了 UIImageViews 的单元格不能在没有额外代码的情况下被复制。是的，复制整个图像绝对不是一个好习惯，为苹果指出这一点而欢呼。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T21:11:32.293

使用表格视图中内置的单元格克隆。Apple 知道生成大量表格单元格的速度很慢。查看此方法的文档：

```
- (UITableViewCell *)dequeueReusableCellWithIdentifier:(NSString *)identifier 
```

您创建一次单元格，然后在请求新单元格时，使用该方法克隆现有单元格。然后，您只需更改新单元格需要更改的内容并返回单元格对象。

另请查看 Apple 提供的使用此方法的 table view realted 示例代码，并向您展示正确的方法。您的细胞是从笔尖加载的这一事实根本不重要。

* * *

小澄清：我不认为上述方法为您克隆细胞。相反，它需要滚动离开屏幕的单元格对象并将它们简单地移动到新位置。所以它实际上是在重复使用一个单元格。因此，请确保您的自定义表格视图可以设置为它在初始化之外需要的所有新值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-08T09:06:04.163

对此解决方案并不感到自豪，但它适用于最大数量的可能 IB 绑定：

接口（AlbumTableViewCell 是 UITableViewCell 的子类，其实例在 AlbumViewController 的 XIB 文件中定义）：

```
@interface AlbumsViewController : UITableViewController {
    IBOutlet AlbumTableViewCell *tableViewCellTrack;
}

@property (nonatomic, retain) AlbumTableViewCell *tableViewCellTrack; 
```

实现（取消归档/归档复制/克隆表格视图单元格）：

```
@implementation AlbumsViewController

@synthesize tableViewCellTrack;

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    AlbumTableViewCell *cell = (AlbumTableViewCell *)[tableView dequeueReusableCellWithIdentifier: @"AlbumCell"];

    if (cell == nil) {
        AlbumsViewController *albumsViewController = [[[AlbumsViewController alloc] init] autorelease];
        [[NSBundle mainBundle] loadNibNamed: @"AlbumsViewController" owner: albumsViewController options: nil];

        cell = albumsViewController.tableViewCellTrack;
    }

    cell.labelTitle.text = ...;
    cell.labelArtist.text = ...;

    return cell;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T04:10:23.230

好吧，我不确定为什么所有的教程都没有指定这一步。

从 Nib 使用您自己的自定义 UITableViewCell 时，调用 dequeueReusableCellWithIdentifier 是不够的。您必须在 IB 中指定“标识符”，仅在 Table View Cell 选项卡部分中指定。

然后确保您放入 IB 的标识符与您用于 dequeueReusableCellWithIdentifier 的标识符相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-24T02:00:45.860

这是在斯威夫特

```
func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {

    var cell : UITableViewCell?
    let cellId = String(format: "Cell%d", indexPath.row)
    cell = alertTable!.dequeueReusableCellWithIdentifier(cellId) as! UITableViewCell?

    if cell == nil {
        let archivedData = NSKeyedArchiver.archivedDataWithRootObject(masterTableCell!)
        cell = NSKeyedUnarchiver.unarchiveObjectWithData(archivedData) as! UITableViewCell?
    }

    // do some stuff

    return cell!
} 
```

# c# - 哪个 JSON 库在 .NET 中最适合您？

> ID：571168
> 
> 赞同：30
> 
> 时间：2009-02-20T20:45:13.917
> 
> 标签：c#, json, serialization

我很想知道社区中的人们在 .NET 中使用了哪些 JSON 库？我需要将 .NET (C#) 内部的一些 JSON 对象图解析/序列化为实际的 .NET 类型。我可以自己动手，但是如果有人使用过一些可靠的库，我想听听您的意见。我在 json.org 网站上看到了库列表，但这是一个相当大的列表，社区通常擅长从伪装者中筛选出竞争者

您在图书馆体验的任何细节（优点/缺点）都会非常有帮助。 - 提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-20T20:47:21.727

我过去曾成功使用过[Json.NET](http://james.newtonking.com/projects/json-net.aspx)。

来自网站的示例：

```
Product product = new Product();
product.Name = "Apple";
product.Expiry = new DateTime(2008, 12, 28);
product.Price = 3.99M;
product.Sizes = new string[] { "Small", "Medium", "Large" };

string json = JsonConvert.SerializeObject(product);
//{
//  "Name": "Apple",
//  "Expiry": new Date(1230422400000),
//  "Price": 3.99,
//  "Sizes": [
//    "Small",
//    "Medium",
//    "Large"
//  ]
//}

Product deserializedProduct = JsonConvert.DeserializeObject<Product>(json); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-02T04:18:28.890

框架中至少有两个内置。

较新的：[System.Runtime.Serialization.Json](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.aspx)

和较旧的：[System.Web.Script.Serialization](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.aspx)

我更喜欢不依赖 3rd 方库。我每天都在使用 JSON，除了框架中已经存在的东西之外，我从来不需要任何东西。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-20T20:53:47.470

我在程序集中使用[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)编写了自己的 JSON 序列化`System.ServiceModel.Web.dll`程序 [这是 .NET 3.5 作为标准程序集和 .NET 3.5 SP1 客户端配置文件中包含的 WCF 的一个组件]（在 .NET 4.0 和 Silverlight 4 中，它已被移动到`System.Runtime.Serialization.dll`）。

```
using System.IO;
using System.Runtime.Serialization.Json;

public class JsonObjectSerializer 
{
    public string Serialize<T>(T instance) where T : class
    {
        var serializer = new DataContractJsonSerializer(typeof(T));
        using (var memoryStream = new MemoryStream())
        {
            serializer.WriteObject(memoryStream, instance);

            memoryStream.Flush();
            memoryStream.Position = 0;

            using (var reader = new StreamReader(memoryStream))
            {
                return reader.ReadToEnd();
            }
        }
    }

    public T Deserialize<T>(string serialized) where T : class
    {
        var serializer = new DataContractJsonSerializer(typeof(T));
        using (var memoryStream = new MemoryStream())
        {
            using (var writer = new StreamWriter(memoryStream))
            {
                writer.Write(serialized);
                writer.Flush();

                memoryStream.Position = 0;

                return serializer.ReadObject(memoryStream) as T;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-18T02:45:15.870

您还应该尝试我的 ServiceStack [JsonSerializer](http://www.servicestack.net/mythz_blog/?p=344) - 它是目前最快的 .NET JSON 序列化程序，[基于领先 JSON 序列化程序的基准，](http://www.servicestack.net/benchmarks/NorthwindDatabaseRowsSerialization.100000-times.2010-08-17.html)并支持序列化任何 POCO 类型、DataContracts、列表/字典、接口、继承、后期绑定对象，包括匿名种类等

基本示例：

```
Customer customer = new Customer { Name="Joe Bloggs", Age=31 };
string json = customer.ToJson();
Customer fromJson = json.FromJson<Customer>(json); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-22T00:56:27.533

查看 .NET 3.5 中包含的 System.Runtime.Serialization.Json 命名空间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-08-05T16:25:27.200

我在 google 中输入了“json”，最热门的是 json.org，这导致看起来像一个很好的单一实用程序类：

```
using System;
using System.Collections;
using System.Globalization;
using System.Text;

namespace Procurios.Public
{
    /// <summary>
    /// This class encodes and decodes JSON strings.
    /// Spec. details, see http://www.json.org/
    /// 
    /// JSON uses Arrays and Objects. These correspond here to the datatypes ArrayList and Hashtable.
    /// All numbers are parsed to doubles.
    /// </summary>
    public class JSON
    {
        public const int TOKEN_NONE = 0; 
        public const int TOKEN_CURLY_OPEN = 1;
        public const int TOKEN_CURLY_CLOSE = 2;
        public const int TOKEN_SQUARED_OPEN = 3;
        public const int TOKEN_SQUARED_CLOSE = 4;
        public const int TOKEN_COLON = 5;
        public const int TOKEN_COMMA = 6;
        public const int TOKEN_STRING = 7;
        public const int TOKEN_NUMBER = 8;
        public const int TOKEN_TRUE = 9;
        public const int TOKEN_FALSE = 10;
        public const int TOKEN_NULL = 11;

        private const int BUILDER_CAPACITY = 2000;

        /// <summary>
        /// Parses the string json into a value
        /// </summary>
        /// <param name="json">A JSON string.</param>
        /// <returns>An ArrayList, a Hashtable, a double, a string, null, true, or false</returns>
        public static object JsonDecode(string json)
        {
            bool success = true;

            return JsonDecode(json, ref success);
        }

        /// <summary>
        /// Parses the string json into a value; and fills 'success' with the successfullness of the parse.
        /// </summary>
        /// <param name="json">A JSON string.</param>
        /// <param name="success">Successful parse?</param>
        /// <returns>An ArrayList, a Hashtable, a double, a string, null, true, or false</returns>
        public static object JsonDecode(string json, ref bool success)
        {
            success = true;
            if (json != null) {
                char[] charArray = json.ToCharArray();
                int index = 0;
                object value = ParseValue(charArray, ref index, ref success);
                return value;
            } else {
                return null;
            }
        }

        /// <summary>
        /// Converts a Hashtable / ArrayList object into a JSON string
        /// </summary>
        /// <param name="json">A Hashtable / ArrayList</param>
        /// <returns>A JSON encoded string, or null if object 'json' is not serializable</returns>
        public static string JsonEncode(object json)
        {
            StringBuilder builder = new StringBuilder(BUILDER_CAPACITY);
            bool success = SerializeValue(json, builder);
            return (success ? builder.ToString() : null);
        }

        protected static Hashtable ParseObject(char[] json, ref int index, ref bool success)
        {
            Hashtable table = new Hashtable();
            int token;

            // {
            NextToken(json, ref index);

            bool done = false;
            while (!done) {
                token = LookAhead(json, index);
                if (token == JSON.TOKEN_NONE) {
                    success = false;
                    return null;
                } else if (token == JSON.TOKEN_COMMA) {
                    NextToken(json, ref index);
                } else if (token == JSON.TOKEN_CURLY_CLOSE) {
                    NextToken(json, ref index);
                    return table;
                } else {

                    // name
                    string name = ParseString(json, ref index, ref success);
                    if (!success) {
                        success = false;
                        return null;
                    }

                    // :
                    token = NextToken(json, ref index);
                    if (token != JSON.TOKEN_COLON) {
                        success = false;
                        return null;
                    }

                    // value
                    object value = ParseValue(json, ref index, ref success);
                    if (!success) {
                        success = false;
                        return null;
                    }

                    table[name] = value;
                }
            }

            return table;
        }

        protected static ArrayList ParseArray(char[] json, ref int index, ref bool success)
        {
            ArrayList array = new ArrayList();

            // [
            NextToken(json, ref index);

            bool done = false;
            while (!done) {
                int token = LookAhead(json, index);
                if (token == JSON.TOKEN_NONE) {
                    success = false;
                    return null;
                } else if (token == JSON.TOKEN_COMMA) {
                    NextToken(json, ref index);
                } else if (token == JSON.TOKEN_SQUARED_CLOSE) {
                    NextToken(json, ref index);
                    break;
                } else {
                    object value = ParseValue(json, ref index, ref success);
                    if (!success) {
                        return null;
                    }

                    array.Add(value);
                }
            }

            return array;
        }

        protected static object ParseValue(char[] json, ref int index, ref bool success)
        {
            switch (LookAhead(json, index)) {
                case JSON.TOKEN_STRING:
                    return ParseString(json, ref index, ref success);
                case JSON.TOKEN_NUMBER:
                    return ParseNumber(json, ref index, ref success);
                case JSON.TOKEN_CURLY_OPEN:
                    return ParseObject(json, ref index, ref success);
                case JSON.TOKEN_SQUARED_OPEN:
                    return ParseArray(json, ref index, ref success);
                case JSON.TOKEN_TRUE:
                    NextToken(json, ref index);
                    return true;
                case JSON.TOKEN_FALSE:
                    NextToken(json, ref index);
                    return false;
                case JSON.TOKEN_NULL:
                    NextToken(json, ref index);
                    return null;
                case JSON.TOKEN_NONE:
                    break;
            }

            success = false;
            return null;
        }

        protected static string ParseString(char[] json, ref int index, ref bool success)
        {
            StringBuilder s = new StringBuilder(BUILDER_CAPACITY);
            char c;

            EatWhitespace(json, ref index);

            // "
            c = json[index++];

            bool complete = false;
            while (!complete) {

                if (index == json.Length) {
                    break;
                }

                c = json[index++];
                if (c == '"') {
                    complete = true;
                    break;
                } else if (c == '\\') {

                    if (index == json.Length) {
                        break;
                    }
                    c = json[index++];
                    if (c == '"') {
                        s.Append('"');
                    } else if (c == '\\') {
                        s.Append('\\');
                    } else if (c == '/') {
                        s.Append('/');
                    } else if (c == 'b') {
                        s.Append('\b');
                    } else if (c == 'f') {
                        s.Append('\f');
                    } else if (c == 'n') {
                        s.Append('\n');
                    } else if (c == 'r') {
                        s.Append('\r');
                    } else if (c == 't') {
                        s.Append('\t');
                    } else if (c == 'u') {
                        int remainingLength = json.Length - index;
                        if (remainingLength >= 4) {
                            // parse the 32 bit hex into an integer codepoint
                            uint codePoint;
                            if (!(success = UInt32.TryParse(new string(json, index, 4), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out codePoint))) {
                                return "";
                            }
                            // convert the integer codepoint to a unicode char and add to string
                            s.Append(Char.ConvertFromUtf32((int)codePoint));
                            // skip 4 chars
                            index += 4;
                        } else {
                            break;
                        }
                    }

                } else {
                    s.Append(c);
                }

            }

            if (!complete) {
                success = false;
                return null;
            }

            return s.ToString();
        }

        protected static double ParseNumber(char[] json, ref int index, ref bool success)
        {
            EatWhitespace(json, ref index);

            int lastIndex = GetLastIndexOfNumber(json, index);
            int charLength = (lastIndex - index) + 1;

            double number;
            success = Double.TryParse(new string(json, index, charLength), NumberStyles.Any, CultureInfo.InvariantCulture, out number);

            index = lastIndex + 1;
            return number;
        }

        protected static int GetLastIndexOfNumber(char[] json, int index)
        {
            int lastIndex;

            for (lastIndex = index; lastIndex < json.Length; lastIndex++) {
                if ("0123456789+-.eE".IndexOf(json[lastIndex]) == -1) {
                    break;
                }
            }
            return lastIndex - 1;
        }

        protected static void EatWhitespace(char[] json, ref int index)
        {
            for (; index < json.Length; index++) {
                if (" \t\n\r".IndexOf(json[index]) == -1) {
                    break;
                }
            }
        }

        protected static int LookAhead(char[] json, int index)
        {
            int saveIndex = index;
            return NextToken(json, ref saveIndex);
        }

        protected static int NextToken(char[] json, ref int index)
        {
            EatWhitespace(json, ref index);

            if (index == json.Length) {
                return JSON.TOKEN_NONE;
            }

            char c = json[index];
            index++;
            switch (c) {
                case '{':
                    return JSON.TOKEN_CURLY_OPEN;
                case '}':
                    return JSON.TOKEN_CURLY_CLOSE;
                case '[':
                    return JSON.TOKEN_SQUARED_OPEN;
                case ']':
                    return JSON.TOKEN_SQUARED_CLOSE;
                case ',':
                    return JSON.TOKEN_COMMA;
                case '"':
                    return JSON.TOKEN_STRING;
                case '0': case '1': case '2': case '3': case '4': 
                case '5': case '6': case '7': case '8': case '9':
                case '-': 
                    return JSON.TOKEN_NUMBER;
                case ':':
                    return JSON.TOKEN_COLON;
            }
            index--;

            int remainingLength = json.Length - index;

            // false
            if (remainingLength >= 5) {
                if (json[index] == 'f' &&
                    json[index + 1] == 'a' &&
                    json[index + 2] == 'l' &&
                    json[index + 3] == 's' &&
                    json[index + 4] == 'e') {
                    index += 5;
                    return JSON.TOKEN_FALSE;
                }
            }

            // true
            if (remainingLength >= 4) {
                if (json[index] == 't' &&
                    json[index + 1] == 'r' &&
                    json[index + 2] == 'u' &&
                    json[index + 3] == 'e') {
                    index += 4;
                    return JSON.TOKEN_TRUE;
                }
            }

            // null
            if (remainingLength >= 4) {
                if (json[index] == 'n' &&
                    json[index + 1] == 'u' &&
                    json[index + 2] == 'l' &&
                    json[index + 3] == 'l') {
                    index += 4;
                    return JSON.TOKEN_NULL;
                }
            }

            return JSON.TOKEN_NONE;
        }

        protected static bool SerializeValue(object value, StringBuilder builder)
        {
            bool success = true;

            if (value is string) {
                success = SerializeString((string)value, builder);
            } else if (value is Hashtable) {
                success = SerializeObject((Hashtable)value, builder);
            } else if (value is ArrayList) {
                success = SerializeArray((ArrayList)value, builder);
            } else if (IsNumeric(value)) {
                success = SerializeNumber(Convert.ToDouble(value), builder);
            } else if ((value is Boolean) && ((Boolean)value == true)) {
                builder.Append("true");
            } else if ((value is Boolean) && ((Boolean)value == false)) {
                builder.Append("false");
            } else if (value == null) {
                builder.Append("null");
            } else {
                success = false;
            }
            return success;
        }

        protected static bool SerializeObject(Hashtable anObject, StringBuilder builder)
        {
            builder.Append("{");

            IDictionaryEnumerator e = anObject.GetEnumerator();
            bool first = true;
            while (e.MoveNext()) {
                string key = e.Key.ToString();
                object value = e.Value;

                if (!first) {
                    builder.Append(", ");
                }

                SerializeString(key, builder);
                builder.Append(":");
                if (!SerializeValue(value, builder)) {
                    return false;
                }

                first = false;
            }

            builder.Append("}");
            return true;
        }

        protected static bool SerializeArray(ArrayList anArray, StringBuilder builder)
        {
            builder.Append("[");

            bool first = true;
            for (int i = 0; i < anArray.Count; i++) {
                object value = anArray[i];

                if (!first) {
                    builder.Append(", ");
                }

                if (!SerializeValue(value, builder)) {
                    return false;
                }

                first = false;
            }

            builder.Append("]");
            return true;
        }

        protected static bool SerializeString(string aString, StringBuilder builder)
        {
            builder.Append("\"");

            char[] charArray = aString.ToCharArray();
            for (int i = 0; i < charArray.Length; i++) {
                char c = charArray[i];
                if (c == '"') {
                    builder.Append("\\\"");
                } else if (c == '\\') {
                    builder.Append("\\\\");
                } else if (c == '\b') {
                    builder.Append("\\b");
                } else if (c == '\f') {
                    builder.Append("\\f");
                } else if (c == '\n') {
                    builder.Append("\\n");
                } else if (c == '\r') {
                    builder.Append("\\r");
                } else if (c == '\t') {
                    builder.Append("\\t");
                } else {
                    int codepoint = Convert.ToInt32(c);
                    if ((codepoint >= 32) && (codepoint <= 126)) {
                        builder.Append(c);
                    } else {
                        builder.Append("\\u" + Convert.ToString(codepoint, 16).PadLeft(4, '0'));
                    }
                }
            }

            builder.Append("\"");
            return true;
        }

        protected static bool SerializeNumber(double number, StringBuilder builder)
        {
            builder.Append(Convert.ToString(number, CultureInfo.InvariantCulture));
            return true;
        }

        /// <summary>
        /// Determines if a given object is numeric in any way
        /// (can be integer, double, null, etc). 
        /// 
        /// Thanks to mtighe for pointing out Double.TryParse to me.
        /// </summary>
        protected static bool IsNumeric(object o)
        {
            double result;

            return (o == null) ? false : Double.TryParse(o.ToString(), out result);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-20T12:15:42.343

我使用 System.Web.Helpers.Json 进行编码和解码。它解码成动态类型，非常适合javascript的动态数据。

# unicode - 使用 imagemagick 从 unicode 字符串生成图像的问题

> ID：571174
> 
> 赞同：1
> 
> 时间：2009-02-20T20:46:14.007
> 
> 标签：unicode, imagemagick

我正在使用以下命令序列生成文本图像

```
convert -background "rgb(233, 231, 218)" -fill black \ 
-font media/fonts/FuturaStd-Medium.otf \
-pointsize 13 label:"ğüşıöçĞÜŞİÖÇ" -size 88x18 \
media/images/category_images/food-drink/category-top-row/tr_food-drink.png 
```

生成以下图像。 [替代文字 http://img54.imageshack.us/img54/5461/trfooddrinkai3.png](http://img54.imageshack.us/img54/5461/trfooddrinkai3.png)

ğşĞİŞ 是有问题的，其他人显示正确。我的语言环境是 en_US.UTF-8。我也没有任何问题尝试从 [http://www.imagemagick.org/Usage/text/#unicode中提取的以下示例](http://www.imagemagick.org/Usage/text/#unicode)

```
convert -background lightblue -fill blue -pointsize 32 \
      label:' é è à ù ç Ö ÿ ‘ ’ “ ” ° ² ³ € x ÷ '    label_i8n.gif 
```

Unicode 字符在 label_i8n.gif 中正确显示。

如何使 imagemagick 正确地将这些字符转换为图像？

编辑：以下图像是用 gimp 使用相同的字体创建的。[替代文字 http://img93.imageshack.us/img93/1986/gimpfuturastdnc4.png](http://img93.imageshack.us/img93/1986/gimpfuturastdnc4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T20:54:01.103

可能字体没有那些字形，这就是为什么它们显示为“？”。使用字符映射应用程序检查它。

# asp.net - 您可以将 ASP.net 用户控件构建为程序集吗？

> ID：571180
> 
> 赞同：1
> 
> 时间：2009-02-20T20:47:39.090
> 
> 标签：asp.net, user-controls, assemblies

VS2K8 中是否有一些设置或一些命令行实用程序可以将我的用户控件编译为 .net 程序集？甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T20:52:17.143

默认情况下没有提供任何设置来支持这一点。但是有一个 hack 在这里解释[ASP.NET: Reusing Web User Controls and Forms](http://www.cmswire.com/cms/tips-tricks/aspnet-reusing-web-user-controls-and-forms-000915.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T20:50:26.010

是的，使用 Web 部署项目。它将网站项目编译为 DLL。

插件下载： [http ://www.microsoft.com/DOWNLOADS/details.aspx?FamilyID=0aa30ae8-c73b-4bdd-bb1b-fe697256c459&displaylang=en](http://www.microsoft.com/DOWNLOADS/details.aspx?FamilyID=0aa30ae8-c73b-4bdd-bb1b-fe697256c459&displaylang=en)

操作方法视频： [http ://www.asp.net/learn/videos/video-418.aspx](http://www.asp.net/learn/videos/video-418.aspx)

一般信息： [http ://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspxW](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T21:05:10.000

如果您指的是继承 System.Web.UI.WebControls.WebControl 的纯 C# 类，只需创建一个类库项目并在您的网站中添加对该项目的引用。

# php - 如何使用 php 获得类似 Google 的速度？

> ID：571184
> 
> 赞同：5
> 
> 时间：2009-02-20T20:49:31.207
> 
> 标签：php, apache, optimization, performance

我将 PHP 与 Zend 框架和数据库连接一起使用似乎比 Google 进行查询所需的 0.02 秒要长。奇怪的是，我今天看了一段视频，说谷歌连接到 1000 台服务器进行一次查询。由于延迟，我希望每个查询的一台服务器比在不同的数据中心处理多台服务器更有效。

我如何让 PHP、MySQL 和 Zend 框架协同工作并达到同样出色的速度？

缓存是唯一的方法吗？您如何优化代码以减少“渲染”时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T20:58:30.343

Google 使用许多技术来实现其提供的吞吐量。[MapReduce](http://en.wikipedia.org/wiki/Map_reduce)、[Google File System](http://en.wikipedia.org/wiki/Google_filesystem)、[BigTable](http://en.wikipedia.org/wiki/BigTable)是其中的一些。

有一些非常好的免费和开源替代品，即[Apache Hadoop](http://en.wikipedia.org/wiki/Hadoop)、[Apache HBase](http://hadoop.apache.org/hbase/)和[Hypertable](http://www.hypertable.org/)。雅虎！正在大量使用和推广 Hadoop 项目，因此它们得到了非常积极的维护。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T22:13:28.463

> 我将 PHP 与 Zend 框架和数据库连接一起使用似乎比 Google 进行查询所需的 0.02 秒要长。

无论您是谁，数据库连接操作都是重量级的：使用连接池，这样您就不必为每个请求初始化资源。

性能是关于架构而不是语言。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-20T20:57:05.837

不久前，Google 决定将所有内容都放入 RAM。

[http://googlesystem.blogspot.com/2009/02/machines-search-results-google-query.html](http://googlesystem.blogspot.com/2009/02/machines-search-results-google-query.html)

如果您永远不必查询硬盘驱动器，您的结果将显着提高。缓存很有帮助，因为您不会查询硬盘驱动器，但是当缓存未命中时您仍然会这样做（除非您的意思是使用 PHP 进行缓存，这意味着您仅在修改源代码时才编译 PHP 程序）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T21:01:26.950

这真的取决于你想要做什么，但这里有一些例子：

*   用解释分析您的查询。在您的开发环境中，您可以将查询和执行时间输出到页面底部 - 减少查询数量和/或优化那些较慢的查询。

*   使用缓存层。看起来 Zend 可以启用内存缓存。通过将请求发送到超高速缓存层而不是数据库，这可能会极大地加速您的应用程序。

*   查看您的前端加载时间。在 Firebug 中使用 Yahoo 的 YSlow 插件。限制 http 请求，设置远期标头以缓存 js、css 和图像。等等。

如果您优化应用程序的每一层，您可以在您的网络应用程序上获得闪电般的速度，可能不如 google 快。您的数据库连接时间可能不是您的应用程序中最慢的部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T21:19:51.337

[Memcached](http://www.danga.com/memcached/)是在 Linux 上优化内存中的存储/检索的推荐解决方案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T13:09:33.363

默认情况下，PHP 脚本每次被 http 服务器调用时都会被解释，因此每次调用都会启动脚本解析，并且可能会被 Zend 引擎编译。您可以通过使用脚本缓存（如 APC）来摆脱这个瓶颈。它将曾经编译的 PHP 脚本保存在内存/磁盘中，并将其用于所有后续请求。收益通常很显着，尤其是在使用 ZF 等复杂框架创建的 PHP 应用程序中。

默认情况下，每个请求都会打开一个到数据库的连接，因此您应该使用某种数据库连接池或持久连接（这并不总是有效，取决于 http server/php 配置）。我从未尝试过，但也许有一种方法可以使用 memcache 来保持数据库连接句柄。

如果每个请求都使用它们，您还可以使用 memcache 来保存会话数据。它们的持久性并不那么重要，而 memcache 有助于使其变得非常快。

实际的“问题”是 PHP 的工作方式与其他框架有点不同，因为它以 SSI（服务器端包含）方式工作 - 每个请求都由 http 服务器处理，如果它需要运行 PHP 脚本，它的解释器会被初始化以及加载、解析、编译和运行的脚本。这可以比作上车，启动发动机并行驶 10 米。

另一种方式是应用程序服务器方式，其中 Web 应用程序本身在自己的循环中处理请求，始终共享数据库连接，而不是一遍又一遍地初始化运行时。该解决方案提供了更低的延迟。另一方面，这可以与已经在一辆正在行驶的汽车中并使用它行驶相同的 10 米进行比较。;)

上述缓存/预编译和池化解决方案是减少 init 开销的最佳方案。PHP/MySQL 仍然是一个基于 RDBMS 的解决方案，而且 BigTable 只是一个大的、分片的、大规模分布的哈希表（我知道有点过于简单化了）是有充分理由的——阅读[High Scalability](http://highscalability.com/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T06:25:35.473

Google 拥有一个庞大的、高度分布式的系统，其中包含许多专有技术（包括他们自己的硬件、操作、文件和数据库系统）。

这个问题就像在问：“我怎样才能让我的车成为卡车？” 并且基本上没有意义。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-20T21:04:19.487

如果是搜索引擎，瓶颈是数据库，取决于它的大小。

为了加快对大型集的全文搜索，您可以使用[Sphinx](http://www.sphinxsearch.com/)。它可以配置在一台或多台服务器上。但是，您将不得不调整现有的查询代码，因为 Sphinx 作为搜索守护进程运行（大多数语言都可以使用库）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T11:53:43.687

*   APC 代码缓存；
*   Zend_Cache 与 APC 或 Memcache 后端；
*   静态文件的 CDN；

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-20T21:10:26.523

根据@Coltin 提供的链接，谷歌响应时间在 0.2 秒左右，而不是 0.02 秒。只要您的应用程序具有高效的设计，我相信您应该能够在很多平台上实现这一点。虽然我不了解 PHP，但如果 0.2 秒是个问题，我会感到惊讶。

# reporting-services - 使用 SQL Server Reporting Services 将数据集传递到子报表

> ID：571185
> 
> 赞同：1
> 
> 时间：2009-02-20T20:49:48.057
> 
> 标签：reporting-services, report-designer

我正在使用 SQL Server Reporting Services 和 Visual Studio 附带的报表设计器。我有一个*非常大*的报告。它实际上太大了，以至于 Visual Studio 挂起（有时一次几个小时）或者在我进行更改时崩溃。

我无法解决这个问题，所以我决定将报告的下半部分移到子报告中。因此，我从一份庞大的、无响应的报告开始，以两份易于管理的小型报告结束——令人惊讶的是，这确实有效。

一个问题：我的子报表使用与我的主报表相同的数据。现在，它通过重新查询数据库来填充其数据集。到数据库的额外往返会导致生成报告的时间增加一倍；生成时间从 45 分钟增加到 1 1/2 小时。

我想避免再次访问数据库，而是在两个报告中使用相同的数据集。

如何在报表和子报表之间共享或传递数据集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-05T16:44:36.847

我认为这可以帮助你： [http ://www.gotreportviewer.com/subreports/index.html](http://www.gotreportviewer.com/subreports/index.html)

> 为子报表提供数据 - SubreportProcessing 事件 要为子报表提供数据，您必须处理 SubreportProcessing 事件。请注意，此事件在 LocalReport 对象上。您可以像这样添加事件处理程序：
> 
> ```
> private void MainForm_Load(object sender, EventArgs e)
> {
>     this.reportViewer1.LocalReport.SubreportProcessing += new SubreportProcessingEventHandler(MySubreportEventHandler);
> } 
> ```
> 
> 下面是事件处理程序的示例。在此示例中，LoadSalesData 被定义为返回一个 DataTable。
> 
> ```
> void MySubreportEventHandler(object sender, SubreportProcessingEventArgs e)
> {
>     e.DataSources.Add(new ReportDataSource("Sales", LoadSalesData()));
> } 
> ```
> 
> 如果您的报表有多个子报表，您可以查看 SubreportProcessingEventArgs 的 ReportPath 属性并为相应的子报表提供数据。您可能还想检查 SubreportProcessingEventArgs 的 Parameters 属性的值，并仅返回与子报表参数对应的数据子集，如此处所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T21:09:42.330

我很确定你不能。您可能最好寻找完全重新设计报表的方法，使其不那么大......更不用说导出到excel时子报表的各种问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T10:17:21.127

我有几个报告说 SQL 非常复杂，以至于当我尝试编辑它时它会锁定 Visual Studio。在这些报告中，我直接进入代码视图并直接编辑 XML，这很有效。当 Visual Studio 神秘地使列比我设置的稍宽时，我也会这样做。但是，如果您过多地编辑报告的布局，我怀疑您是否愿意走这条路。

除了在报表中运行查询之外，是否可以使用两个报表都使用的存储过程来构建表？第一个报表运行存储过程来构建表，然后两个报表都简单地查询报表。如果报告可以由多个用户运行，请注意并发问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T22:39:27.757

您是否尝试过在两个列表使用相同数据集的列表中使用列表，然后过滤内部列表以仅显示链接到外部列表的记录？

就执行时间而言，首先，45 分钟似乎是一个非常长的时间。我假设您已经对执行计划进行了一些分析，以验证您的查询或存储过程是否使用有意义的索引？

希望这可以帮助，

账单

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-03T17:06:28.567

您可以使用虚拟参数来做到这一点：

一世。在主报告“MyData”中创建一个参数并勾选“internal”

ii. 将“MyData”的默认值设置为您的数据集

iii. 用表达式设置子报表参数

```
=Parameters!MyData.Value 
```

希望这会有所帮助，邓肯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-29T20:09:39.220

如果你创建一个表格，你可以合并明细行的所有单元格，并把一个子报表作为内容。然后将子报表的参数设置为要对其运行子报表的字段。

杰森

# python - 在python中拆分标签

> ID：571186
> 
> 赞同：4
> 
> 时间：2009-02-20T20:50:04.077
> 
> 标签：python, split, template-engine

我有一个包含以下内容的文件：

```
<html>
  <head>
    <title> Hello! - {{ today }}</title>
  </head>
  <body>
    {{ runner_up }} 
         avasd
         {{ blabla }}
        sdvas
        {{ oooo }}
   </body>
</html> 
```

`{{today}}`提取,`{{runner_up}}`等的最好或最 Pythonic 的方法是什么？

我知道可以使用拆分/正则表达式来完成，但我想知道是否还有其他方法。

PS：考虑加载在一个名为的变量中的数据`thedata`。

编辑：我认为 HTML 示例很糟糕，因为它将一些评论者引导到 BeautifulSoup。所以，这是一个新的输入数据：

```
Fix grammatical or {{spelling}} errors.

Clarify meaning without changing it.

Correct minor {{mistakes}}.

Add related resources or links.

Always respect the original {{author}}. 
```

输出：

```
spelling
mistakes
author 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T21:09:48.350

嗯，这是一个似乎对我很有效的生成器解决方案。如果您愿意，您还可以提供不同的打开和关闭标签。

```
def get_tags(s, open_delim  ='{{', 
                close_delim ='}}' ):

   while True:

      # Search for the next two delimiters in the source text
      start = s.find(open_delim)
      end   = s.find(close_delim)

      # We found a non-empty match
      if -1 < start < end:

         # Skip the length of the open delimiter
         start += len(open_delim)

         # Spit out the tag
         yield s[start:end].strip()

         # Truncate string to start from last match
         s = s[end+len(close_delim):]

      else:
         return 
```

像这样针对您的目标输入运行：

```
# prints: today, runner_up, blabla, oooo
for tag in get_tags(html):
    print tag 
```

编辑：它也适用于您的新示例:)。在我明显的快速测试中，它似乎也以合理的方式处理了格式错误的标签，尽管我不保证它的稳健性！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T21:08:00.507

试试[templatemaker](http://code.google.com/p/templatemaker/)，一个反向模板制造商。它实际上可以从示例中自动学习它们！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T21:14:03.567

我知道你说没有正则表达式/拆分，但我忍不住尝试了一个单行解决方案：

```
import re
for s in re.findall("\{\{.*\}\}",thedata):
        print s.replace("{","").replace("}","") 
```

编辑：JFS

比较：

```
>>> re.findall('\{\{.*\}\}', '{{a}}b{{c}}')
['{{a}}b{{c}}']
>>> re.findall('{{(.+?)}}', '{{a}}b{{c}}')
['a', 'c'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T21:10:17.367

如果数据这么简单，一个简单的正则表达式就可以解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T21:34:59.680

JF Sebastian 在评论中写了这个，但我认为它已经足够好，值得拥有自己的答案：

```
re.findall(r'{{(.+?)}}', thestring) 
```

我知道 OP 正在寻求一种不涉及拆分或正则表达式的方式 - 所以也许这并不能*完全*回答所述问题。但是这一行代码绝对是我的投票，因为它是完成任务的最 Pythonic 方式。

# php - 您将如何构建论坛的数据库架构？

> ID：571192
> 
> 赞同：13
> 
> 时间：2009-02-20T20:51:31.123
> 
> 标签：php, sql, structure

我正在建立一个练习用的小论坛。我看到像 phpBB 这样的论坛将线程文本存储在一个单独的表中。

为什么？为什么不将它们全部存储在同一张表中？

就像是：`thread_id, thread_date, thread_text, thread_author`

为什么这样做？你会怎么做？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-11-18T19:54:39.813

我在网上找到了这个很酷的模式。

[![图式](https://i.stack.imgur.com/Zm9h9.jpg)](https://i.stack.imgur.com/Zm9h9.jpg)
[（来源：[yensdesign.com](http://yensdesign.com/tutorials/forumsdatabase/schemaFull.jpg)）]

对于任何基本论坛的数据库模式来说，这似乎都是不错的入门。

我知道这是旧的，但我想我会为任何会再次找到这个问题的人发布这个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T21:12:29.327

我实际上不知道为什么要这样做，但我可以想象的一个原因是优化帖子元数据（日期、作者等）的搜索和检索。

[根据 Joel](http://www.joelonsoftware.com/articles/fog0000000319.html)（而且 Joel 永远是对的！;-) 数据库将它们的数据存储在由固定长度记录组成的固定长度字段中，因此只需将指针增加一个字节长度就可以轻松地从一行跳转到下一行。记录。但是用于存储帖子文本的大文本字段不能具有固定大小，因为帖子的长度在很大范围内变化，并且创建足够大以容纳所有帖子的固定长度存储会浪费大量空间。这意味着当您想要检索大量帖子的元数据时，将帖子文本与其他信息存储在同一个表中会使速度变慢，就像每次有人查看主论坛页面时所做的那样。

两全其美的方法是将固定长度字段（即除帖子文本之外的所有内容）放在一个表中，将可变长度字段（即帖子文本）放在另一个表中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T21:10:34.137

从来没有看过 phpBB 的胆量，但也许是因为全文索引。主表的 Inno-db 引擎允许事务和不允许事务。MyIsam 用于全文索引。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T21:11:36.240

一方面，大多数关系数据库的文件系统布局使得存储大块任意文本或数据会降低系统速度。由于数据通常按行存储，因此在进行搜索时，即使在查找不相关的字段时，数据库现在也必须跳过可变长度的文本字段。

其次，如果您需要为每个 thread_id 提供更多数据，例如，将所有内容放在一个表中会使以后添加到数据模型中变得更加困难。

很好地设计数据库模式需要一些教育。您应该从[http://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization)开始。一定要理解第三范式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T21:10:33.123

`InnoDB`不支持`FULLTEXT`索引，`MyISAM`也不支持事务。

不知道`phpBB`，但可能这就是他们分开表格的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T21:08:39.400

由于表格可以达到的大小，它们不会将文本存储在同一个表格中。

这样，即使有非常多的条目，线程列表表也很小，索引很好，并且可以快速扫描它。仅在必要时使用主键访问文本，这也很快。

对于小型论坛，我认为这没有必要，因为有一点编码开销。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T21:10:28.647

除了 Julien 的出色回答之外，将帖子移动到其他线程（比如管理员或版主）是很常见的。将文本放在“发布表”中有助于支持这一点。

# java - MemoryCacheImageOutputStream 到 BufferedImage

> ID：571193
> 
> 赞同：1
> 
> 时间：2009-02-20T20:51:36.537
> 
> 标签：java, bufferedimage

我有一些图像约束代码，允许您输出到 MemoryCacheImageOutputStream，但我需要将其恢复为 BufferedImage，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T23:24:34.487

作为`MemoryCacheImageOutputStream`实现`ImageInputStream`，您可以将其用作`ImageReader`. 所以你最终会得到这样的东西（非常基本，未经测试）：

```
public BufferedImage readImage(MemoryCacheImageOutputStream input) {       
    ImageInputStream is = input;
    ImageReader decoder = ImageIO.getImageReadersByFormatName("JPEG").next();
    decoder.setInput(is);
    BufferedImage bi = decoder.read(0);
    return bi;
} 
```

# c++ - C++ Eclipse 调试器：“找不到当前函数的边界”并且不会在断点处停止

> ID：571224
> 
> 赞同：4
> 
> 时间：2009-02-20T21:04:36.443
> 
> 标签：c++, eclipse, debugging

我是第一次使用 Ubuntu，而 Eclipse 的调试器给我带来的麻烦超出了我的处理能力。目前我只是想弄清楚如何让“找不到当前函数的边界”停止，这样我就可以看到我的控制流在哪里出错了。

我知道这是一个模糊的问题，但我愿意迅速提供任何必要的信息。我已经在谷歌上搜索了大约 2 个小时的信息，并且打开和关闭不同的东西无济于事。

我正在使用版本：3.4.1（我相信是最新的）

此外，即使我在构建之前设置断点，我的断点也不总是有效（可能成功率约为 25%）。在程序崩溃之前，我的 cout<< 或 printf 也无法打印。这让我觉得这是某种超过调试器的并发进程，但我不知道如何解决这个问题。

我将不胜感激任何帮助。我会在附近。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T21:48:52.127

不是[闻所未闻的问题](http://www.nabble.com/debug-problem-in-Eclipse3.2.2-%2B-CDT3.1.2-td18569813.html)

我想你可以确认：

*   所有共享库都使用 -g 标志（调试）编译？
*   并且输出应用程序二进制文件似乎没问题，因为它在命令行中正确运行？
*   你没有编译一些框架（比如[Qt4](http://www.qtsoftware.com/products)），这[需要运行 qmake 来](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg14361.html)生成你添加“ `CONFIG += qt debug`”的项目文件？
*   在构建过程中您没有任何警告？（就像这个[“检测到时钟偏差”](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg12605.html)消息）

* * *

这一切的重点是：

**在某个地方，其中一个库或您自己的程序中没有“调试”信息。**

-g 标志可以直接在 makefile 中设置（在这种情况下并不特别依赖于操作系统）。

示例（***不针对 Linux***）

```
CXX = g++
CXXFLAGS =  -O2 -Wno-deprecated -g
DEFINES = -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -DLITTLE_ENDIAN

##########################

COMPILE=$(CXX) $(CXXFLAGS) $(DEFINES)
LINK=$(CXX)

UNRAR_OBJ=filestr.o recvol.o rs.o scantree.o

OBJECTS=rar.o strlist.o strfn.o pathfn.o

.cpp.o:
    $(COMPILE) -D$(WHAT) -c -g $<

all:    unrar

clean:
    @rm -f *.o *.bak *~

unrar:    WHAT=UNRAR
unrar:    $(OBJECTS) $(UNRAR_OBJ)
    @rm -f makeunrar
    $(LINK) -Wl,-s -g -o unrar $(LDFLAGS) $(OBJECTS)
$(UNRAR_OBJ) $(LIBS)   

sfx:    WHAT=SFX_MODULE
sfx:    $(OBJECTS)
    @rm -f default.sfx
    $(LINK) -Wl,-s -g -o default.sfx $(LDFLAGS)
$(OBJECTS) -DSFX_MODULE

g++ -O2 -Wno-deprecated -g  -D_FILE_OFFSET_BITS=64
-D_LARGEFILE_SOURCE -DLITTLE_ENDIAN -DUNRAR -c -g
rar.cpp
[...]
g++ -Wl,-s -g -o unrar  rar.o strlist.o ... 
```

在这里，该 makefile 包含一个巨大的陷阱：

```
g++ -Wl,-s -o unrar  rar.o strlist.o ... 
```

`-s`代表“strip”，表示之前生成的所有调试信息都在最终输出中丢失。所以也要检查你的链接选项。

# c++ - 为什么有些设备不能用 SetupDiGetDeviceInterfaceDetail() 枚举？

> ID：571229
> 
> 赞同：1
> 
> 时间：2009-02-20T21:07:11.977
> 
> 标签：c++, winapi, driver

我正在维护一个应用程序，它使用 SetupDiGetDeviceInterfaceDetail() 来查找有关计算机上已安装串行端口的信息。我在测试时注意到有一些设备，例如我的 Lucent WinModem，没有出现在该枚举中。事实证明，我公司生产的一组实现串行端口接口的设备也遇到了类似的问题。我的假设是设备的 INF 文件中缺少某些内容。有谁知道什么样的条件会导致这种遗漏？

编辑：这是我用来枚举串行端口的代码示例。我尝试了各种标志组合，但在行为上没有看到任何显着差异。

```
DEFINE_GUID(GUID_CLASS_COMPORT, 0x4d36e978, 0xe325, 0x11ce, 0xbf, 0xc1, \
            0x08, 0x00, 0x2b, 0xe1, 0x03, 0x18);

GUID *serial_port_guid = const_cast<GUID *>(&GUID_CLASS_COMPORT);
HDEVINFO device_info = INVALID_HANDLE_VALUE;
SP_DEVICE_INTERFACE_DETAIL_DATA *detail_data = 0;

device_info = SetupDiGetClassDevs(
   serial_port_guid, 0, 0, DIGCF_PRESENT | DIGCF_DEVICEINTERFACE);
if(device_info != INVALID_HANDLE_VALUE)
{
   uint4 const detail_data_size = sizeof(SP_DEVICE_INTERFACE_DETAIL_DATA) + 256;
   detail_data = reinterpret_cast<SP_DEVICE_INTERFACE_DETAIL_DATA *>(new char[detail_data_size]);
   SP_DEVICE_INTERFACE_DATA ifc_data;
   bool more_interfaces = true;
   int rcd;
   memset(&ifc_data, 0, sizeof(ifc_data)); 
   memset(detail_data, 0, detail_data_size);
   ifc_data.cbSize = sizeof(ifc_data);
   detail_data->cbSize = sizeof(SP_DEVICE_INTERFACE_DETAIL_DATA);
   for(uint4 index = 0; more_interfaces; ++index)
   {
      rcd = SetupDiEnumDeviceInterfaces(device_info, 0, serial_port_guid, index, &ifc_data);
      if(rcd)
      {
         // we need to get the details of this device
         SP_DEVINFO_DATA device_data = { sizeof(SP_DEVINFO_DATA) };
         rcd = SetupDiGetDeviceInterfaceDetail(
            device_info, &ifc_data, detail_data, detail_data_size, 0, &device_data);
         if(rcd)
         {
            StrAsc device_path(detail_data->DevicePath);
            byte friendly_name[256];

            rcd = SetupDiGetDeviceRegistryProperty(
               device_info, &device_data, SPDRP_FRIENDLYNAME, 0, friendly_name, sizeof(friendly_name), 0);
            if(rcd)
            {
               std::for_each(
                  port_names.begin(),
                  port_names.end(),
                  update_friendly_name(
                     reinterpret_cast<char const *>(friendly_name)));
            }
         }
         else
            more_interfaces = false;
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T20:24:02.407

这更像是一个关于这个问题的问题。当您调用该函数时，您传入的第一个参数应该是您可能从[SetupDiGetClassDevs](http://msdn.microsoft.com/en-us/library/ms792959.aspx)函数获得的 DeviceInfoSet。当您调用 SetupDiGetClassDevs 函数时，您为标志（最后一个参数）在函数上引用 Microsoft 的页面指定了什么：

> **DIGCF_ALLCLASSES** 返回所有设备设置类或所有设备接口类的已安装设备列表。
> 
> **DIGCF_DEVICEINTERFACE** 返回支持指定设备接口类的设备接口的设备。如果 Enumerator 参数指定设备实例 ID，则必须在 Flags 参数中设置此标志。
> 
> **DIGCF_DEFAULT** 仅返回与指定设备接口类的系统默认设备接口关联的设备（如果已设置）。
> 
> **DIGCF_PRESENT** 仅返回系统中当前存在的设备。
> 
> **DIGCF_PROFILE** 仅返回属于当前硬件配置文件的设备。

根据您的选择，设备列表会发生变化。例如，当前标志只会显示主动插入的设备。

* * *

更新：感谢您的示例代码。

我现在的问题是，如果您想知道调制解调器的友好名称，为什么不使用相同的调用，而是指定调制解调器 Guid 而不是 COM 端口？我的调制解调器 GUID 为 4D36E96D-E325-11CE-BFC1-08002BE10318

在注册表中，我可以看到一个名为“AttachedTo”的值，它指定了一个 COM 端口。我将不得不研究与 API 相关联的属性。注册表项位于

HKLM\SYSTEM\CurrentControlSet\Control\Class{4D36E96D-E325-11CE-BFC1-08002BE10318}\

* * *

另一个更新：

仔细查看示例代码。基于此，如果您尝试获取应该返回[SP_DEVICE_INTERFACE_DETAIL_DATA](http://msdn.microsoft.com/en-us/library/ms793116.aspx)结构的设备接口类。这不会提供获取设备友好名称的方法。我相信你会想要设备实例。

根据我的阅读，设备接口用于获取可用于写入的设备路径。

我为测试您的代码所做的一件事是再次尝试磁盘设备接口。我进行了一些更改以使其在我的系统上运行，但仍未完成。我认为一个问题（可能更多）是我需要在 SetupDiGetDeviceInterfaceDetail 调用之间调整 DevicePath 变量的大小。

```
void Test()
{

GUID *serial_port_guid = const_cast<GUID *>(&GUID_DEVINTERFACE_DISK);
HDEVINFO device_info = INVALID_HANDLE_VALUE;
SP_DEVICE_INTERFACE_DETAIL_DATA detail_data;

device_info = SetupDiGetClassDevs(
   serial_port_guid, 0, 0, DIGCF_PRESENT | DIGCF_DEVICEINTERFACE);
if(device_info != INVALID_HANDLE_VALUE)
{
   //uint4 const detail_data_size = sizeof(SP_DEVICE_INTERFACE_DETAIL_DATA);// + 256;
   //detail_data = reinterpret_cast<SP_DEVICE_INTERFACE_DETAIL_DATA *>(new char[detail_data_size]);
   SP_DEVICE_INTERFACE_DATA ifc_data;
   bool more_interfaces = true;
   int rcd;
   memset(&ifc_data, 0, sizeof(ifc_data)); 
   //memset(detail_data, 0, detail_data_size);
   ifc_data.cbSize = sizeof(ifc_data);
   detail_data.cbSize = sizeof(SP_DEVICE_INTERFACE_DETAIL_DATA);
   for(uint4 index = 0; more_interfaces; ++index)
   {
      rcd = SetupDiEnumDeviceInterfaces(device_info, 0, serial_port_guid, index, &ifc_data);
      if(rcd)
      {
         // we need to get the details of this device
         SP_DEVINFO_DATA device_data;
         device_data.cbSize = sizeof(SP_DEVINFO_DATA);
         DWORD intReqSize;
         rcd = SetupDiGetDeviceInterfaceDetail(device_info, &ifc_data, 0, 0, &intReqSize, &device_data);

         rcd = SetupDiGetDeviceInterfaceDetail(device_info, &ifc_data, &detail_data,intReqSize,&intReqSize,&device_data);
         if(rcd)
         {
            //StrAsc device_path(detail_data->DevicePath);
            byte friendly_name[256];

            rcd = SetupDiGetDeviceRegistryProperty(
               device_info, &device_data, SPDRP_FRIENDLYNAME, 0, friendly_name, sizeof(friendly_name), reinterpret_cast<DWORD *>(sizeof(friendly_name)));
            if(rcd)
            {
              cout<<reinterpret_cast<char const *>(friendly_name);
            }
            else
            {   int num = GetLastError();
            }
         }
         else
         {
                int num = GetLastError();
            }
      }
      else
            more_interfaces = false;
   }    
}
SetupDiDestroyDeviceInfoList(device_info);
} 
```

此外，在 INF 中，您可能必须添加[AddInterface](http://msdn.microsoft.com/en-us/library/ms794355.aspx)指令以将您的驱动程序与正确的接口相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T09:11:58.567

我不确定以下修补程序是否会解决您在

[http://support.microsoft.com/kb/327868](http://support.microsoft.com/kb/327868)

更有趣的一点：GUID_CLASS_COMPORT 从 Win2000 起已过时..

[http://msdn.microsoft.com/en-us/library/bb663140.aspx](http://msdn.microsoft.com/en-us/library/bb663140.aspx)

[http://msdn.microsoft.com/en-us/library/bb663174.aspx](http://msdn.microsoft.com/en-us/library/bb663174.aspx)

我发现另一个站点有 9 种不同的枚举方式。祝你好运。

[http://www.naughter.com/enumser.html](http://www.naughter.com/enumser.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T06:19:19.073

您说您的设备存在且可访问，但您是直接访问设备还是通过名称和编号 COMn 访问端口：

我有一个连接到我的音频驱动程序的 WinModem。我没有串口，甚至没有模拟的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-28T13:07:21.877

我决定放弃这一点并消除对 SetupDi() 函数的依赖。相反，我编写了遍历 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum 中的子键的代码，以查找支持串行端口 GUID 的任何驱动程序。我感觉这就是设备管理器所做的。如果有人感兴趣，我的代码片段如下所示：

```
typedef std::string StrAsc;
typedef std::pair<StrAsc, StrAsc> port_name_type;
typedef std::list<port_name_type> friendly_names_type;
void SerialPortBase::list_ports_friendly(friendly_names_type &port_names)
{
   // we will first get the list of names.  This will ensure that, at the very least, we get
   // the same list of names as we would have otherwise obtained. 
   port_names_type simple_list;
   list_ports(simple_list);
   port_names.clear();
   for(port_names_type::iterator pi = simple_list.begin(); pi != simple_list.end(); ++pi)
      port_names.push_back(friendly_name_type(*pi, *pi));

   // we will now need to enumerate the subkeys of the Enum registry key. We will need to
   // consider many levels of the registry key structure in doing this so we will use a list
   // of key handles as a stack.
   HKEY enum_key ;
   char const enum_key_name[] = "SYSTEM\\CurrentControlSet\\Enum";
   StrAsc const com_port_guid("{4d36e978-e325-11ce-bfc1-08002be10318}");
   char const class_guid_name[] = "ClassGUID";
   char const friendly_name_name[] = "FriendlyName";
   char const device_parameters_name[] = "Device Parameters";
   char const port_name_name[] = "PortName";
   long rcd = ::RegOpenKeyEx(
      HKEY_LOCAL_MACHINE, enum_key_name, 0, KEY_READ, &enum_key);
   char value_buff[MAX_PATH];
   StrAsc port_name, friendly_name;

   if(!port_names.empty() && rcd == ERROR_SUCCESS)
   {
      std::list<HKEY> key_stack;
      key_stack.push_back(enum_key);
      while(!key_stack.empty())
      {
         // we need to determine whether this key has a "ClassGUID" value
         HKEY current = key_stack.front();
         uint4 value_buff_len = sizeof(value_buff);
         key_stack.pop_front();
         rcd = ::RegQueryValueEx(
            current,
            class_guid_name,
            0,
            0,
            reinterpret_cast<byte *>(value_buff),
            &value_buff_len);
         if(rcd == ERROR_SUCCESS)
         {
            // we will only consider devices that match the com port GUID
            if(com_port_guid == value_buff)
            {
               // this key appears to identify a com port.  We will need to get the friendly name
               // and try to get the 'PortName' from the 'Device Parameters' subkey.  Once we
               // have those things, we can update the friendly name in our original list
               value_buff_len = sizeof(value_buff);
               rcd = ::RegQueryValueEx(
                  current,
                  friendly_name_name,
                  0,
                  0,
                  reinterpret_cast<byte *>(value_buff),
                  &value_buff_len);
               if(rcd == ERROR_SUCCESS)
               {
                  HKEY device_parameters_key;
                  rcd = ::RegOpenKeyEx(
                     current,
                     device_parameters_name,
                     0,
                     KEY_READ,
                     &device_parameters_key);
                  if(rcd == ERROR_SUCCESS)
                  {
                     friendly_name = value_buff;
                     value_buff_len = sizeof(value_buff);
                     rcd = ::RegQueryValueEx(
                        device_parameters_key,
                        port_name_name,
                        0,
                        0,
                        reinterpret_cast<byte *>(value_buff),
                        &value_buff_len);
                     if(rcd == ERROR_SUCCESS)
                     {
                        friendly_names_type::iterator fi;
                        port_name = value_buff;
                        fi = std::find_if(
                           port_names.begin(), port_names.end(), port_has_name(port_name));
                        if(fi != port_names.end())
                           fi->second = friendly_name;
                     }
                     ::RegCloseKey(device_parameters_key);
                  }
               }
            }
         }
         else
         {
            // since this key did not have what we expected, we will need to check its
            // children
            uint4 index = 0;
            rcd = ERROR_SUCCESS;
            while(rcd == ERROR_SUCCESS)
            {
               value_buff_len = sizeof(value_buff);
               rcd = ::RegEnumKeyEx(
                  current, index, value_buff, &value_buff_len, 0, 0, 0, 0);
               if(rcd == ERROR_SUCCESS)
               {
                  HKEY child;
                  rcd = ::RegOpenKeyEx(current, value_buff, 0, KEY_READ, &child);
                  if(rcd == ERROR_SUCCESS)
                     key_stack.push_back(child);
               }
               ++index;
            }
         }
         ::RegCloseKey(current);
      }
   }
} // list_ports_friendly 
```

# winapi - 如何在 VB6 中读取子进程的标准输出？

> ID：571230
> 
> 赞同：0
> 
> 时间：2009-02-20T21:07:49.743
> 
> 标签：winapi, vb6, stdout

在 VB6 中创建进程时（与[此](https://stackoverflow.com/questions/570295/can-i-spawn-a-synchronous-process-in-vb6-and-retrieve-its-return-value)问题相关：），我使用以下结构：

```
Private Type STARTUPINFO
      cb As Long
      lpReserved As String
      lpDesktop As String
      lpTitle As String
      dwX As Long
      dwY As Long
      dwXSize As Long
      dwYSize As Long
      dwXCountChars As Long
      dwYCountChars As Long
      dwFillAttribute As Long
      dwFlags As Long
      wShowWindow As Integer
      cbReserved2 As Integer
      lpReserved2 As Long
      hStdInput As Long
      hStdOutput As Long
      hStdError As Long
   End Type 
```

在我开始我的进程之前，为了让我的 VB6 应用程序读取我的托管进程的输出，STARTUPINFO.hStdOutput 需要发生什么？

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T16:38:18.557

跟进[OP 提出的另一个问题](https://stackoverflow.com/questions/570295/can-i-spawn-a-synchronous-process-in-vb6-and-retrieve-its-return-value)，我发布了另一种方法来执行命令并获取标准输出：

```
' References: "Windows Script Host Shell Object Model" '

Public Declare Sub Sleep Lib "kernel32" Alias "Sleep" ( _
  ByVal dwMilliseconds As Long)

Function ExecuteCommand(cmd As String, ExpectedResult as Long) As String
  Dim shell As New IWshRuntimeLibrary.WshShell
  Dim exec As IWshRuntimeLibrary.WshExec

  Set exec = shell.Exec(cmd)
  While exec.Status = 0
     Sleep 100
  Wend

  If exec.ExitCode = ExpectedResult Then
    ExecuteCommand = exec.StdOut.ReadAll
  Else
    ExecuteCommand = vbNullString     ' or whatever '
  End
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T21:25:56.067

[微软](http://support.microsoft.com/kb/173085/en-us)在这里举了一个例子来说明如何做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T21:42:34.590

看`AttachConsole(ATTACH_PARENT_PROCESS)`

# svn - SVN：Git 中的外部等效项？

> ID：571232
> 
> 赞同：188
> 
> 时间：2009-02-20T21:08:18.823
> 
> 标签：svn, git

[我使用svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)从另一个 SVN 存储库使用了两个 SVN 项目。

如何在 Git 中拥有相同的存储库布局结构？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-02-20T23:58:34.013

Git 有两种与 svn:externals 类似但不完全等价的方法：

*   **子树合并**将外部项目的代码插入到您的存储库中的单独子目录中。这有一个[详细的设置过程，](https://help.github.com/articles/about-git-subtree-merges/)对于其他用户来说非常容易，因为它会在存储库被检出或克隆时自动包含在内。这是在项目中包含依赖项的便捷方式。
    从另一个项目中提取更改很容易，但提交更改回来很复杂。如果另一个项目必须从您的代码中合并，则项目历史会合并，两个项目实际上会合二为一。

*   [**Git 子模块**](http://help.github.com/submodules/)（[手动](http://schacon.github.com/git/user-manual.html#submodules)）链接到另一个项目存储库中的特定提交，就像 svn:externals 带有`-r`参数一样。子模块易于设置，但所有用户都必须管理子模块，这些子模块不会自动包含在结帐（或克隆）中。
    尽管将更改提交回其他项目很容易，但如果 repo 发生更改，这样做可能会导致问题。因此，通常不适合将更改提交回正在积极开发的项目。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-08-06T18:57:30.380

[正如我在“ Git 子模块新版本更新](https://stackoverflow.com/a/17199855/6309)”中提到的，您可以使用 Git 1.8.2 子模块实现**相同的 SVN 外部功能：**

```
git config -f .gitmodules submodule.<path>.branch <branch> 
```

这足以让子模块跟随分支（如在子模块[上游 repo](https://stackoverflow.com/a/2749166/6309)的远程分支的最新提交中）。您需要做的就是：

```
git submodule update --remote 
```

这将更新子模块。

更多细节在“[`git submodule`跟踪最新](https://stackoverflow.com/a/9189815/6309)”中。

**要将现有子模块转换为跟踪分支的子模块**：请参阅“ [Git 子模块：指定分支/标签](https://stackoverflow.com/a/18799234/6309)”中的所有步骤。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-01-05T22:19:10.933

> 我是[gil (git links) 工具的作者](https://github.com/chronoxor/gil)

我有这个问题的替代解决方案 - [gil (git links) 工具](https://github.com/chronoxor/gil)

它允许描述和管理复杂的 git 存储库依赖项。

它还为[git 递归子模块依赖问题](https://github.com/chronoxor/gil#recursive-submodules-problem)提供了解决方案。

考虑您有以下项目依赖项： [示例 git 存储库依赖关系图](https://i.stack.imgur.com/HUM5M.png)

然后您可以`.gitlinks`使用存储库关系描述定义文件：

```
# Projects
CppBenchmark CppBenchmark https://github.com/chronoxor/CppBenchmark.git master
CppCommon CppCommon https://github.com/chronoxor/CppCommon.git master
CppLogging CppLogging https://github.com/chronoxor/CppLogging.git master

# Modules
Catch2 modules/Catch2 https://github.com/catchorg/Catch2.git master
cpp-optparse modules/cpp-optparse https://github.com/weisslj/cpp-optparse.git master
fmt modules/fmt https://github.com/fmtlib/fmt.git master
HdrHistogram modules/HdrHistogram https://github.com/HdrHistogram/HdrHistogram_c.git master
zlib modules/zlib https://github.com/madler/zlib.git master

# Scripts
build scripts/build https://github.com/chronoxor/CppBuildScripts.git master
cmake scripts/cmake https://github.com/chronoxor/CppCMakeScripts.git master 
```

每行以以下格式描述 git 链接：

1.  存储库的唯一名称
2.  存储库的相对路径（从 .gitlinks 文件的路径开始）
3.  Git 存储库，将在 git clone 命令中使用 Repository 分支进行结帐
4.  不解析空行或以 # 开头的行（视为注释）。

最后，您必须更新您的根示例存储库：

```
# Clone and link all git links dependencies from .gitlinks file
gil clone
gil link

# The same result with a single command
gil update 
```

结果，您将克隆所有必需的项目并以适当的方式将它们相互链接。

如果您想提交某个存储库中的所有更改以及子链接存储库中的所有更改，您可以使用单个命令来完成：

```
gil commit -a -m "Some big update" 
```

拉、推命令的工作方式类似：

```
gil pull
gil push 
```

Gil (git links) 工具支持以下命令：

```
usage: gil command arguments
Supported commands:
    help - show this help
    context - command will show the current git link context of the current directory
    clone - clone all repositories that are missed in the current context
    link - link all repositories that are missed in the current context
    update - clone and link in a single operation
    pull - pull all repositories in the current directory
    push - push all repositories in the current directory
    commit - commit all repositories in the current directory 
```

更多关于[git 递归子模块依赖问题](https://github.com/chronoxor/gil#recursive-submodules-problem)。

# wpf - WPF 数据绑定是否让事情变得比它的价值更痛苦？

> ID：571248
> 
> 赞同：5
> 
> 时间：2009-02-20T21:11:14.370
> 
> 标签：wpf, data-binding

好的，所以我在我最近的非工作项目中一直停滞不前，试图使用 WPF。坦率地说，我对数据绑定感到恼火。我认为应该通过将数据直接绑定到 UI 来简化事情。但是我越了解必须实现 INotifyPropertyChanged 来让事情发生变化时通知 UI，这似乎使整个事情适得其反。

我错过了什么吗？这似乎是一堆工作，并且必须让类实现 INotifyPropertyChanged 似乎是一种让数据绑定工作的可疑方式。

我错过了什么？我肯定错过了什么。请启发我如何使数据绑定变得容易，或者至少简单明了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T21:14:53.127

如果您希望在底层数据源更改时通知 UI，那么您需要*某种*通知机制。对于 WPF，INotifyPropertyChanged 就是这种机制。

在 Windows 窗体中也是如此，但 Windows 窗体还支持旧的通知机制，您可以在其中有一个名为 的事件`<Property>Changed`。

但是，如果您只想绑定到数据一次并显示它，那么这些都不需要这些机制。

如果您可以不接收通知，那么只需绑定到数据源即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T21:27:23.393

说实话，我还没有看到它那么糟糕，并认为这是一个非常可行的解决方案。

以这个简单的数据模型对象为例：

```
Public Class SimpleItemViewModel
Implements INotifyPropertyChanged

Private _item As String 
Public Property Item As String
   Get 
       return _item 
   End Get 
   Set (value as string) 
      _item = value : OnPropertyChanged("Item") 
   End Set 
End Property 

Protected Overridable Sub OnPropertyChanged(propChange as string) 
   Raise Event PropertChanged(me, new PropertyChangedEventArgs(propChange))
End Sub 
Public Event PropertyChanged(sender as object, e as PropertyChangedEventArgs)
End Class 
```

这很容易通过以下方式绑定到一个简单的文本框：

```
<Textbox Text="{Binding Item}" /> 
```

此外，如果我想要一个 DIRTY 标志，我可以轻松地将设置的标志放在 OnPropertyChanged 子中，并轻松确定是否需要保存任何用户更改。

我发现拥有一组位于数据访问层和包含这些东西的 UI 之间的类是最简单的。您甚至可以让您的业务逻辑和 DAL 传递这些类而不是原子值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T21:47:16.637

实施`INotifyProperty`更改并不是特别困难，因为它只有一个成员。

如果您不希望底层对象发生变化，那么不要担心`INotifyProperty`发生变化，并使用 Binding with `Mode=OneTime`。

`INotifyProperty`如果底层对象可以更改并且您希望 GUI 反映这些更改，那么在没有更改提供的那种通知的情况下如何实现呢？期望绑定项目轮询其绑定源是不合理的。

就我个人而言，我发现 WPF 需要一些时间来掌握，但现在我获得了舒适感，我发现它非常强大和令人愉快的工作。我鼓励任何发现 WPF 具有挑战性的人坚持下去。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T11:11:15.267

XAML 中的绑定非常容易，但是，代码中的动态 WPF 数据绑定是痛苦和混乱的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T21:33:54.830

DataBinding 是在 WPF/Silverlight 中实现模型视图模式的唯一方法。通过实现 INotifyPropertyChanged，您的模型可以是 UI 愚蠢的，它将它们与 UI 隔离。在将信息填充到 UI 中时，它还节省了大量的 UI 代码。

我喜欢的另一个好处是能够通过使用 {Binding} 快捷方式进一步绑定具有相同数据的子控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T21:44:11.030

首先，INotifyPropertyChanged 并不是让数据绑定起作用的唯一方法——依赖属性也起作用。

其次，如果您使用 AOP，INotifyPropertyChanged 只需在您的实体类中使用一行代码即可实现 - 您实际上不必自己执行所有这些通知调用。

总的来说，我会说数据绑定是一个很大的好处，尤其是当您进行代码生成以从某些数据源自动绑定控件时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T21:50:49.407

如果您正在寻找一种考虑构建数据绑定的好方法，那么只需在逻辑树上设置一次 DataContext，然后使用绑定路径来填充 UI 的各个部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T21:52:19.933

在绑定中尽可能声明性。让模板系统完成它的工作并大量使用`DataTemplate`指定显式`DataType`s 的 s。

# .net - 使用 LINQ 循环并执行操作而不仅仅是选择数据是不好的做法吗？

> ID：571265
> 
> 赞同：5
> 
> 时间：2009-02-20T21:17:21.563
> 
> 标签：.net, linq

**很大的主观问题：**我经常发现自己使用 LINQ 过滤一组对象，然后在查询之后执行老式的 foreach 以对每个结果执行操作。有没有一种结合这两个任务的好方法，以便对匹配 Where() 谓词的每个对象执行操作？几乎就像将一个动作传递给 Select()。那可能无法编译，但是传入一个返回布尔值的 Func 怎么样，然后你可以将它嵌套在另一个可以对失败或成功做某事的查询中。有没有人在生产代码中这样做过？这会被认为是不好的做法吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-20T22:13:38.213

很多人都要求提供一种`ForEach`方法——实际上它*很*方便（这就是为什么我们在[MoreLINQ](http://code.google.com/p/morelinq/)中有一个方法）。它也有*潜在*的危险。

大多数 LINQ 坚决反对副作用。他们是可能的，但气馁。这就是 OrderBy 等返回新集合而不是对现有集合进行排序的原因。

现在考虑`ForEach`- 它是一个“动作”而不是一个函数，因为它不返回任何东西。如果它没有任何副作用，那是绝对没有意义的！因此，它违背了 LINQ 的部分哲学——它基本上不是以函数式的方式处理事物。

我并不是要提出赞成或反对的理由，真的 - 在实践中，我认为这是一个有用的东西，而且我对它存在于*如此*多的库等中并不感到惊讶。这是一个非常明显的伪运算符添加。想想你在做什么，并注意你正在引入副作用的事实。它是 LINQ 的函数式风格和更命令式的编码风格之间的一种边界。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T21:19:19.560

`List<T>`有一种[`ForEach()`](http://msdn.microsoft.com/en-us/library/bwabdf9z.aspx)为此设计的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T21:21:11.443

您可以在 IEnumerable 上实现扩展[ForEach方法。](http://msdn.microsoft.com/en-us/library/bwabdf9z.aspx)

# class - 如何通过 NHibernate 将多个类映射到一张表？

> ID：571273
> 
> 赞同：2
> 
> 时间：2009-02-20T21:20:34.253
> 
> 标签：class, fluent-nhibernate, mapping, nhibernate-mapping

我有一个 Employee 类，其 Name 属性为 Name 类，Contact 属性为 Contact 类型。Name 类有两个字符串属性：FirstName 和 LastName，Contact 类有 PhoneNumber 和 EmailAddress 等属性。

所有数据都在一个表中，并假设它不能更改。我的地图会是什么样子，这样我就可以根据 id 加载 Employee 并使用适当的值填充 Contact 和 Name 属性？或者这甚至可能吗？

```
public class Employee
{       
    //Constructor ommitted.

    public virtual Name Name { get; set; }      
    public virtual Contact ContactInfo { get; set; }
}

public class Name
{       
    // Constructor omitted.

    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

Employee 表具有以下列：EmployeeId、FirstName、LastName，以及各种联系信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T21:24:00.343

使用组件映射...更多细节在这里：

[http://www.hibernate.org/hib_docs/nhibernate/html/components.html](http://www.hibernate.org/hib_docs/nhibernate/html/components.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T21:33:25.407

[我想我在http://wiki.fluentnhibernate.org/show/StandardMappingComponents](http://wiki.fluentnhibernate.org/show/StandardMappingComponents)和[http://blog.jagregory.com/2009/01/19/fluent-nhibernate-auto-mapping-](http://blog.jagregory.com/2009/01/19/fluent-nhibernate-auto-mapping-components/)找到了我想要的东西 [成分/](http://blog.jagregory.com/2009/01/19/fluent-nhibernate-auto-mapping-components/)

也感谢您的意见！

# mysql - Grails/Hibernate 数据库在负载下崩溃：无法连接（即使在池中）

> ID：571279
> 
> 赞同：5
> 
> 时间：2009-02-20T21:22:01.830
> 
> 标签：mysql, performance, hibernate, grails, scale

我在 Grails 中有一个应用程序。我使用 Hibernate 访问数据库（根据标准 grails 规则）我使用 MySql 并且该站点工作并且稳定（6 个月）。

我正在做负载测试，最近发现数据库在负载下拒绝连接。

使用 MySQL Server 5，我可以看到连接的线程在 20 左右徘徊。我认为我在 11 到 30 之间跳跃。

```
mysql> show status like '%con%';
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| Aborted_connects         | 72    |
| Connections              | 65539 |
| Max_used_connections     | 101   |
| Ssl_client_connects      | 0     |
| Ssl_connect_renegotiates | 0     |
| Ssl_finished_connects    | 0     |
| Threads_connected        | 1     |
+--------------------------+-------+
7 rows in set (0.00 sec) 
```

我的数据库配置是标准的。（MySql服务器安装在本地，未显示）

```
dataSource {
    pooled = false
    driverClassName = "com.mysql.jdbc.Driver"
    username = "username"
    password = "secret"

    maxIdle = 15
    maxActive = 100        
} 
```

我应该调查 C3P0 吗？或者我应该将我的 maxActive 提高到 1000 并希望获得最好的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T14:10:49.113

当 Grails 无法获得数据库连接时，它会报告什么错误？超时？拒绝？

当你运行你的测试时，盒子的负载是多少？CPU 百分比、内存使用率等。

有可能是数据库过载了，以至于 Grails 正在超时获取连接。如果要处理负载，则需要使用池化数据库连接。如果没有池化，Grails 将在每个请求中打开和关闭一个数据库连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T18:16:27.093

检查您的 mysql 配置（/etc/mysql.conf 或其本地等效项），特别是每个用户设置的最大连接数和最大连接数；这听起来好像它可能来自mysql而不是grails。

# c# - DDE 服务器窗口 - 应用程序错误

> ID：571281
> 
> 赞同：1
> 
> 时间：2009-02-20T21:22:42.423
> 
> 标签：c#, excel, com, dde

我有一个 ac# 应用程序，它打开一个 excel 的 COM 实例，并通过 oleDB 将 Access 2000 数据库中的一些数据转储到工作表上，然后释放 excel 对象，但是在我用标题栏关闭程序后我得到一个窗口：

```
DDE Server Error: [applicationName.exe] - Application Error 
```

我认为在关闭程序之前，我已经将其缩小为关闭 excel 的问题。确定这是我创建的 com 对象的问题，我检查了我的代码并尝试找到存储 Excel COM 对象的每个位置，并确保在将其设置为 null 之前将其释放。我忽略了我没有存储的那些，例如

```
excelSheet.GetRange("A1", "A1).Value2 = "Hello"; 
```

我仍然收到错误消息，并且我认为我已经释放了所有存储的 COM 对象，是否还有其他原因我可能仍然会收到此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T21:44:51.573

也许您没有正确清理您的 Excel 引用？

查看[此](https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c)线程以了解如何执行此操作。

# .net - ASP.NET MasterPage + Javascript 错误

> ID：571285
> 
> 赞同：0
> 
> 时间：2009-02-20T21:23:40.580
> 
> 标签：.net, asp.net, javascript, master-pages

在将 ASP.NET 网络表单 (v3.5) 转换为使用母版页后，我开始收到一个奇怪的 Javascript 错误。

内容页面有一段 javascript。这里是：

```
 <script type="text/javascript">

    var attCount = 0;

    function CreateAttachmentControl() {
        var newAtt = document.createElement('span');
        var newAttName = 'area' + attCount;
        newAtt.setAttribute('id', newAttName);
        newAtt.setAttribute('name', newAttName);

        var newInput = document.createElement('input');
        var newInputName = 'att' + attCount;
        newInput.setAttribute('type', 'file');
        newInput.setAttribute('id', newInputName);
        newInput.setAttribute('name', newInputName);

        if (newInput.addEventListener) {
            newInput.addEventListener("onchange", CreateAttachmentControl, false);
        } else if (newInput.attachEvent) {
            newInput.attachEvent("onchange", CreateAttachmentControl);
        } else {
            newInput.onchange = CreateAttachmentControl;
        }

        var newRemove = document.createElement('a');
        newRemove.setAttribute('href', 'javascript:RemoveAttachmentControl("' + attCount + '")');
        newRemove.setAttribute('title', 'Remove this attachment');
        newRemove.innerHTML = 'X';
        newAtt.appendChild(newInput);
        newAtt.appendChild(document.createTextNode(' '));
        newAtt.appendChild(newRemove);
        newAtt.appendChild(document.createElement('br'));
        attArea.appendChild(newAtt); // error here

        attCount++;
    }

    function RemoveAttachmentControl(n) {

        // get input element
        var input = document.getElementById('att' + n);

        // if the input is blank dont delete
        if (input.value != '' && input.value != null) {
            var att = document.getElementById('area' + n);
            attArea.removeChild(att);
        }
    }
</script> 
```

错误是：“attArea”未定义

但是，我知道它不是，因为在我的 javascript 块下面是这样的：

```
...<td align="left" colspan="2" style="height: 13px" id="attArea" name="attArea"></td>... 
```

在我将网络表单转换为带有母版页的内容页面之前，这非常有效。是否存在一些已知的 Javascript + Masterpage 问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T21:26:08.047

*在您提供的代码示例中*，attArea未定义。您正在调用它的第一个引用`attArea.appendChild()`。它是否在您未提供的源中更高的位置声明？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T21:32:01.933

我认为你错过了：

```
var attArea = document.getElementById('attArea');
attArea.appendChild(newAtt); // no more error! 
```

# validation - 如何最好地验证 URL 是否在公共互联网上？

> ID：571286
> 
> 赞同：4
> 
> 时间：2009-02-20T21:23:48.800
> 
> 标签：validation, url

我想验证一个主机名/IP 地址是否在公共互联网上；也就是说，在合理的范围内，无论我从哪里访问它，我都会得到相同的响应（显然这无法保证。

`localhost`即，我想排除`127.0.0.1`私有 IP 范围内的任何内容，以及任何具有无效 TLD 的内容。

我是否遗漏了我应该检查的其他任何内容？

对于有效 TLD 列表，是否有比[http://data.iana.org/TLD/tlds-alpha-by-domain.txt更好的列表？](http://data.iana.org/TLD/tlds-alpha-by-domain.txt)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T21:36:13.997

如果您对 DNS 或 /etc/hosts 没有严格控制，则有效的 TLD 仍可能解析为本地地址，因此解析然后按 IP 范围排除（10.0.0.0/8、172.16.0.0/12、192.168.0.0 /16, 169.254.0.0/16, 127.0.0.0/8) 是最好的。

您的 TLD 列表是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T21:38:50.527

IANA 是域名信息的官方来源，因此您无法获得更好的列表 - 或者至少，您无法获得更权威的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T21:38:52.430

最终的验证不是创建一个您本地的网络列表（例如，在您自己的防火墙后面），如果不是，请尝试连接主机？如果您可以连接并且它不是本地的，那么您没有理由期望互联网上的任何其他位置都无法连接。

# asp.net - 使用 AttributeCollection.Render 方法的正确方法是什么？

> ID：571289
> 
> 赞同：3
> 
> 时间：2009-02-20T21:24:55.287
> 
> 标签：asp.net, webforms, web-controls

我创建了一个 Web 控件，我想在渲染阶段传递元素属性。我更喜欢使用 writer.RenderBeginTag() 和 RenderEndTag() 但这是我似乎可以成功集成属性的唯一方法：

```
public override void RenderBeginTag(HtmlTextWriter writer)
{
    writer.Write("<");
    writer.Write(this.Tag);
    this.Attributes.Render(writer);
    writer.Write(">");
} 
```

是否有另一种方法可以在不遍历 Attributes 集合的情况下执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T21:32:47.250

```
writer.WriteBeginTag(this.Tag);
this.Attributes.Render(writer);
writer.Write(HtmlTextWriter.TagRightChar); 
```

# cmake - 如何修复明显损坏的 CMake 构建？

> ID：571292
> 
> 赞同：27
> 
> 时间：2009-02-20T21:25:45.130
> 
> 标签：cmake

我从源代码树上的 CMakeSetup 收到以下错误：

```
CMake Error: Error required internal CMake variable not set, cmake may be not be built correctly.
Missing variable is:
CMAKE_FIND_LIBRARY_PREFIXES 
```

删除缓存没有帮助，因此 CMakeLists 之一中的某些东西一定是问题所在。奇怪的是，如果我从旧版本的树中复制 CMakeCache.txt，并对其进行编辑以使路径匹配，那么 CMake 将成功配置......并且，即使在删除该固定缓存之后，它也会继续配置成功。

知道我应该寻找什么吗？

生成错误的 CMakeCache.txt 时缺少两个变量：Project_BINARY_DIR 和 Project_SOURCE_DIR。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-22T19:27:18.190

您的项目是否在顶部和基本 CMakeLists.txt 文件中声明，或者至少必须在需要之前声明，其中在顶部是最简单的。看来这是cmake中的一个错误。[http://www.mail-archive.com/cmake@cmake.org/msg13392.html](http://www.mail-archive.com/cmake@cmake.org/msg13392.html)

IE

```
PROJECT(inkscape)

SET(INKSCAPE_VERSION 0.46+devel)
SET(PROJECT_NAME inkscape)
CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6)
SET(CMAKE_INCLUDE_CURRENT_DIR TRUE)

... 
```

# windows-services - 在 Windows XP 中启动和停止 Windows 服务的更简单方法

> ID：571306
> 
> 赞同：9
> 
> 时间：2009-02-20T21:32:39.967
> 
> 标签：windows-services, windows-xp

我偶尔会发现自己启动和停止多个 Windows 服务。我知道的用于停止和启动 Windows 服务的唯一工具是“管理工具”下的“服务”程序 (%SystemRoot%\system32\services.msc /s)。该程序似乎一次只允许您操作一项服务，通常在等待服务停止时暂停。有一个“关闭”按钮可用，但我更愿意选择我想要停止或启动的所有服务，并一次对所有服务执行一个命令。

是否有更简单的方法来启动和停止 Windows XP 的多个 Windows 服务？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-20T21:39:59.790

使用 cmd.exe 中的“net start”和“net stop”命令来启动和停止服务：

```
net start "Service name with space"
net stop SerivceNameWithoutSpace 
```

请注意，如果服务名称包含空格，您将需要引号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-20T21:50:09.377

可以使用命令行工具（例如**net start**和**net stop**和**sc.exe** ）启动/停止 Windows 服务，但据我所知，它们都不允许同时操作多个服务。

最简单的解决方案是通过在批处理文件中指定不同的服务名称来*多次*调用命令行工具。

另外，请注意，在向 Windows 服务发出停止命令与进程实际退出的时间之间存在延迟的原因是，**Windows 服务控制器**最多等待 30 秒以允许服务正确关闭.
如果到那时服务没有退出，一条消息会通知您“*服务没有及时响应*”。更多细节可以在[这里](http://support.microsoft.com/kb/839174)找到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T21:58:21.587

你可以使用powershell。
类似于：

get-service -displayname *SQL* | stop-service

这将停止所有显示名称中带有 SQL 的服务。
[http://www.microsoft.com/technet/scriptcenter/topics/msh/cmdlets/stop-service.mspx](http://www.microsoft.com/technet/scriptcenter/topics/msh/cmdlets/stop-service.mspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T21:36:30.750

[命令行](http://technet.microsoft.com/en-us/library/cc736564.aspx#BKMK_cmd)呢？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T21:36:35.493

net start 和 net stop 命令是你要去的地方......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T21:36:15.293

尝试 msconfig（转到“运行”对话框，键入“msconfig”）。选择“服务”选项卡。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T21:36:35.713

您可以编写一个使用命令行服务控制器的命令/批处理脚本，`sc.exe`.

或者，您可以查看 SysInternals`psservice.exe`命令行工具。

# mysql - 如何正确索引 MySQL 中多对多连接的链接表？

> ID：571309
> 
> 赞同：40
> 
> 时间：2009-02-20T21:33:12.397
> 
> 标签：mysql, indexing, many-to-many

假设我在表“table1”和“table2”之间有一个简单的多对多表，它由两个 int 字段组成：“table1-id”和“table2-id”。我应该如何索引这个链接表？

我以前只是创建一个复合主索引（table1-id，table2-id），但我读到如果您更改查询中字段的顺序，该索引可能不起作用。那么最佳解决方案是什么 - 为没有主索引的每个字段创建独立索引？

谢谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-20T21:42:24.730

这取决于您如何搜索。

如果你这样搜索：

```
/* Given a value from table1, find all related values from table2 */
SELECT *
FROM table1 t1
JOIN table_table tt ON (tt.table_1 = t1.id)
JOIN table2 t2 ON (t2.id = tt.table_2)
WHERE t1.id = @id 
```

那么你需要：

```
ALTER TABLE table_table ADD CONSTRAINT pk_table1_table2 (table_1, table_2) 
```

在这种情况下，`table1`将是前导，`NESTED LOOPS`并且您的索引仅在首先被索引时才可用`table1`。

如果你这样搜索：

```
/* Given a value from table2, find all related values from table1 */
SELECT *
FROM table2 t2
JOIN table_table tt ON (tt.table_2 = t2.id)
JOIN table1 t1 ON (t1.id = tt.table_1)
WHERE t2.id = @id 
```

那么你需要：

```
ALTER TABLE table_table ADD CONSTRAINT pk_table1_table2 (table_2, table_1) 
```

由于上述原因。

您在这里不需要独立索引。复合索引可以在可以使用第一列的普通索引的任何地方使用。如果您使用独立的索引，您将无法有效地搜索这两个值：

```
/* Check if relationship exists between two given values */
SELECT 1
FROM table_table
WHERE table_1 = @id1
  AND table_2 = @id2 
```

对于这样的查询，两列至少需要一个索引。

为第二个字段添加一个额外的索引总是不错的：

```
ALTER TABLE table_table ADD CONSTRAINT pk_table1_table2 PRIMARY KEY (table_1, table_2)
CREATE INDEX ix_table2 ON table_table (table_2) 
```

主键将用于搜索`on both values`和基于值的搜索`table_1`，附加索引将用于基于值的搜索`table_2`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T22:02:25.243

只要您在查询中指定了两个键，它们在查询中的顺序无关紧要，您在索引中指定它们的顺序也无关紧要。

但是，您有时可能只有一个或另一个键。如果您有时只有 id_1，那应该是第一个（但您仍然只需要一个索引）。

如果您有时有一个，有时另一个，有时两者都有，您将需要一个具有两个键的索引，以及具有一个字段的第二个（非唯一）索引 - 两个键中更具选择性 - 主复合索引应该从另一个键开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-25T23:50:54.273

@Quassnoi，在您的第一个查询中，您实际上只使用了`tt.table_1`键，正如我们从 WHERE-clause: 中看到的那样`WHERE t1.id = @id`。并且在第二个查询中 - 仅`tt.table_2`。

因此，多列索引可能仅在第三个查询中有用，因为`WHERE table_1 = @id1 AND table_2 = @id2`. 如果不使用此类查询，您认为是否值得使用两个单独的单列索引？

# asp.net - 您将如何将 ASP.Net MVC 嵌入到现有的网站项目中？

> ID：571315
> 
> 赞同：46
> 
> 时间：2009-02-20T21:35:09.147
> 
> 标签：asp.net, asp.net-mvc, visual-studio, web-site-project

我在 Visual Studio 2008 SP1 中有一个旧版*（哈哈）* ASP.Net Webforms***网站项目***，我想逐步将一些 MVC 功能引入其中。

我能找到的关于如何将 ASP.Net MVC 与 WebForms 集成的大部分信息似乎都假设使用了***Web 应用程序项目***。但是，似乎不可能找到有关如何使用 ASP.Net MVC 功能改造现有 ASP.net 网站项目的信息。

我已经阅读了[Scott Hanselman 的文章](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)和他即将出版的书的[第 13 章](http://media.wiley.com/assets/1539/15/professionalaspnet35mvc_chapter13.pdf)，这两本书都假定了*Web 应用程序项目*类型。

这可能吗？有没有人有这方面的方法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-20T22:53:34.280

对于初学者来说，将 MVC 添加到 webforms 项目非常简单，要获得 VS 2008 for MVC 中的功能需要更多的工作（仍然很容易）。首先，您要确保引用程序集并使用 .Net 3.5。其次，您可以在当前的 Web 表单项目中创建一个控制器文件夹和视图文件夹。您还可以使用索引操作创建一个简单的控制器。然后在 global.ascx 文件中设置/配置路由。你应该从那里开始。[在这里](http://www.chadmyers.com/Blog/archive/2007/11/30/asp.net-webforms-and-mvc-in-the-same-project.aspx)查看以供参考。

但是，您将只能创建带有代码隐藏的 aspx 页面（您可以删除这些页面并在标记中输入正确的继承类）。要真正“转换”您的项目类型以便获得 MVC 和 Visual Studio 的优点（添加新视图、goto 控制器等）需要一些时间。我最好的建议是在 VS 2008 中创建一个新的 MVC 项目和一个新的 Web App 项目，并以纯文本形式比较 .csproj 文件。有一个长字符串值告诉 VS 项目模板。

相信我，这确实有效。我以前在自己的遗留项目上做过。我不记得除了试验/错误/消除之外，我是如何找到项目类型“关键”的。 **ASP.Net MVC 在与 webforms 相同的项目中确实表现出色。**

**更新：**我认为您可以更改为 MVC 项目类型，它仍然是一个 Web 应用程序，方法是在 .csproj 文件的 PropertyGroup 中使用这些。将这些与您拥有的进行比较并更改不同的，确保复制/备份文件。

```
<ProjectGuid>{B99EC98A-1F09-4245-B00D-5AF985190AA9}</ProjectGuid>
<ProjectTypeGuids>{603c0e0b-db56-11dc-be95-000d561079b0};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids> 
```

**更新 2：**您不会影响您的项目或对其产生太大影响。如果您对此不满意，请备份并四处玩耍。如果您遇到更改，您将始终拥有备份。起初我持怀疑态度，但很高兴我走上了 MVC 的道路。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-04-08T15:41:05.333

我想我会使用 Visual Studio 2010 SP1 / NuGet / Scott Hanselman 完全不受支持的实用程序给出更新的答案。

1.  安装 MVC3 (w/nuget) [http://www.asp.net/mvc/mvc3](http://www.asp.net/mvc/mvc3)
2.  转到 Visual Studio 中的“工具”菜单并选择“库包管理器”\“包管理器控制台”
3.  出现控制台窗口后，将“默认项目”更改为您的网络表单项目。
4.  键入“安装包 AddMvc3ToWebForms”（[http://nuget.org/List/Packages/AddMvc3ToWebForms](http://nuget.org/List/Packages/AddMvc3ToWebForms)）

这会将所有必要的 dll、javascript 文件、web.config 设置更改等添加到项目中。如果一切顺利，您应该可以按 F5，导航到您网站上的“主页”，然后看到 mvc 呈现的示例表单：“欢迎使用 ASP.NET MVC，以完全不受支持的方式使用 NuGet 包升级汉塞尔曼！没有保修！”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-26T15:06:24.687

对于网站项目，您只需将控制器添加到 App_Code，而不是根。你会错过一些 VS 的优点——因为它不知道你正在使用没有 csproj 文件的 MVC，但你实际上会让它工作。

只要记住从 Controller 和 ViewPage 继承就可以了。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-17T09:36:43.190

我有一个相当大的 ASP.NET 网站（不是 Web 应用程序），并且想向其中添加 MVC3。我没有选择更改项目类型，所以我不得不使用网站（asp.net 4.0）。

我使用一个单独的 MVC 项目，但不是作为它自己的 Web 应用程序，而是作为我旧网站中的一个程序集。

以下是我所做的简要说明：

*   我在 Visual Studio 2010 中创建了一个新的 MVC3 Web 应用程序，我使用了空模板和 Razor 视图引擎。
*   我将它添加到现有网站的解决方案中。
*   我将程序集的输出路径从本地 bin 目录更改为我网站的 bin 目录。
*   我从 MVC 应用程序中删除了“内容”和“脚本”文件夹。内容和脚本都已经是我网站的一部分，我也可以从 MVC 的“页面”中引用它们。
*   我从项目中删除了 Global.asax.* 文件。我在网站上使用 Global.asax。
*   我将“视图”文件夹和子文件夹复制到网站上。因为这些是实际文件而不是程序集的一部分，所以它们必须存在于网站中，而不是构建 MVC 程序集的项目中。
*   在这一点上，我可以从 MVC 项目中删除“视图”文件夹，但只有在这种项目类型中，我才能获得 Visual Studio 对添加新视图的支持。所以我有时会在这里创建一个视图，然后将它移到网站上。在我的网站上编辑 cshtml 文件时，我仍然得到完整的 Intellisense。
*   向网站添加了路由。我刚刚从我网站的 global.asax 中的 MVC global.asax 复制了一些代码。我们需要一些用途：

    ```
    using System.Web.Mvc;
    using System.Web.Routing; 
    ```

在 Application_Start 我们需要：

```
 AreaRegistration.RegisterAllAreas();
    RegisterGlobalFilters(GlobalFilters.Filters);
    RegisterRoutes(RouteTable.Routes); 
```

然后添加常用的路由方法：

```
 public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
    }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        // your routes
    } 
```

接下来在您网站的 web.config 中添加一些内容。在编译下的 system.web 中，我们需要以下程序集：

```
 <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies> 
```

最初，我还向 web.config 添加了一些 MVC 命名空间，但没有它们似乎也能正常工作。

您现在确实在网站的 Global.asax 中创建新路由，然后在 MVC 项目中添加相应的控制器，然后返回网站为其添加视图。所以你的逻辑都在一个程序集中，而视图和路由是在网站中定义的。

您仍然可以通过在其中设置断点来调试 MVC 控制器，但您可以通过启动网站进行调试。

如果您使用 MVC 的建议默认路由：

```
 routes.MapRoute("Default", "{controller}/{action}/{id}", 
            new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

对 www.mysite.com 的调用将提供主控制器/视图的内容，而不是您的旧 default.aspx 主页，所以我只是不使用这样的路由。如果您的路由与现有的物理文件夹和文件发生冲突，请在路由上使用带有正则表达式的约束来排除此类冲突。

尽管我在网站中使用母版页，但公共页面部分的实际 html 是由另一个程序集中的代码创建的。我可以从我的 _ViewStart.cshtml 或我的基本控制器中调用相同的方法。

到目前为止，我还没有看到任何关于这种方法的真正负面影响。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T22:53:24.047

只要你在 web.config 中设置好路由，设置好必要的目录结构，并在 global.asax 中添加正确的路由，理论上你可以将 MVC 项添加到任何 web 项目中。据我所知，这些是它工作的唯一要求。

但是，从长远来看，两者的结合可能会有点混乱且难以维护。也许您可以将所有现有的 Web 表单站点内容移动到一个子文件夹中，以使其不碍事，并保持站点的根目录干净，以减少混乱并使事情更加清晰。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-04T13:48:46.030

如果您想将 MVC 3 添加到 asp.net 网站而不是 Web 项目，那么 Scott Hanselman 的 AddMvc3ToWebForms nuget 包将使您完成 99% 的工作，但在安装过程中会抛出错误，您可以安全地忽略（我认为，至少在我的测试中似乎是这种情况），安装后需要几个简单的步骤。

[有关http://delradiesdev.blogspot.com/2011/08/adding-mvc-3-to-aspnet-web-site.html](http://delradiesdev.blogspot.com/2011/08/adding-mvc-3-to-aspnet-web-site.html)的完整详细信息

马克（@delradie）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-19T11:57:23.650

在尝试迁移 MVC2 应用程序时，我学到的是您的项目需要 Default.aspx。我的任务是向现有的 Web 服务项目添加一些 GUI 功能，因此没有 default.aspx。我花了一段时间才弄清楚为什么我的路线没有设置好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-27T13:16:58.310

Microsoft .NET 4.0 Web 开发考试 (70-519) 在备考材料中几乎有这个确切的问题。根据微软当时的说法，答案是：

1.  将 Web 表单网站转换为 Web 应用程序（即 webapp 项目）。
2.  在 webapp 的配置文件中添加对“ASP.NET MVC 2 程序集”的引用。

此信息在我的雇主购买的付费材料中，因此不一定有一个网页清楚地说明它，我可以链接到它。

# docbook - 如何在 docbook 文章中指定一个没有标题的类似节的实体？

> ID：571323
> 
> 赞同：2
> 
> 时间：2009-02-20T21:36:50.017
> 
> 标签：docbook

我有一篇文章正在转换为 Docbook 格式。文章包含将几个（简单）段落组合在一起的小型轻量级部分。这些部分不包含标题。

我在 Docbook 中找不到表示此结构的元素。我发现的所有类似部分的元素都需要标题。

我想要做的一个很好的例子是，有时在章节或短篇小说中如何表示设置中断，两段将由空行或** * **或其他一些暗示中断的视觉提示分隔。我查看了*book*元素以了解这将如何在书中实现，但在那里找不到任何合适的元素。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T22:40:04.280

[`bridgehead`](https://tdg.docbook.org/tdg/5.2/bridgehead.html)（[存档](https://web.archive.org/web/20210314142415/https://tdg.docbook.org/tdg/5.2/bridgehead.html)）作为段落之间的分隔符是否有效？例如，`<bridgehead>** * **</bridgehead>`。

我意识到这与无标题部分的容器不同，但我相信它是最接近您所追求的 DocBook。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T02:36:10.403

> [`bridgehead`](https://tdg.docbook.org/tdg/5.2/bridgehead.html)（[存档](https://web.archive.org/web/20210314142415/https://tdg.docbook.org/tdg/5.2/bridgehead.html)）作为段落之间的分隔符是否有效？例如，`<bridgehead>** * **</bridgehead>`。

这似乎是我想要的。在阅读[桥头](https://tdg.docbook.org/tdg/5.2/bridgehead.html)元素的 DocBook 文档时，我发现 DocBook 并没有太多设计用于执行老式的非分层布局。

> 一些文档，通常是遗留文档，使用与正常的部分层次结构无关的标题。这些标题可以在 DocBook 中用 [`bridgehead`](https://tdg.docbook.org/tdg/5.2/bridgehead.html)元素表示。
> 
> 桥头在没有嵌套层次结构的小说或新闻作品中也可能有用。

但至少支持这样的遗留文档。感谢您为我指明正确的方向！

# javascript - 如何淡入/淡出带有子菜单的 jQuery 菜单？

> ID：571326
> 
> 赞同：1
> 
> 时间：2009-02-20T21:37:31.060
> 
> 标签：javascript, jquery, css, xhtml-1.0-strict

我正在尝试制作一个包含许多链接的菜单，每个链接都有自己的子列表，这就是我正在使用的

```
$(document).ready(function() {
  $(".users").bind("click", function() {
    $('#menu').fadeOut();
    $('#sub_menu').fadeIn();
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div id="menu">
  <a href="#">
    <li>users <br /></a>
  </li>
  <a href="#">
    <li>product <br /></a>
  </li>
  <a href="#">
    <li>movies <br /></a>
  </li>
  <a href="#">
    <li>clips <br /></a>
  </li>
  <a href="#">
    <li>teaser <br /></a>
  </li>
  <a href="#">
    <li>trailer <br /></a>
  </li>
  <a href="#">
    <li>HDMovie <br /></a>
  </li>
</div>
```

这仅用于用户链接以显示其子列表。如果我想对产品、电影和剪辑链接执行相同操作，是否必须复制和粘贴该功能？谁能在这里给我一个函数示例，这样我就不必复制粘贴了？

谢谢 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T01:36:44.840

老实说，我会使用[Superfish](http://plugins.jquery.com/project/Superfish)插件而不是重新发明轮子。将其与[hoverIntent](http://plugins.jquery.com/project/hoverIntent)结合使用，它应该能够完成您需要的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T09:12:15.640

感谢回复的家伙，我已经使用了这个功能它正在工作它淡出我的菜单并且也淡入子菜单但是当我点击下一个链接时我希望子菜单2淡入的每个链接的相同子菜单..

这是我在做什么的链接[http://umarstudio.com/test/html/screen_2b.htm](http://umarstudio.com/test/html/screen_2b.htm)

我只需要子菜单为每个链接淡入。谢谢；）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-20T21:53:22.800

尝试这样的事情。另外，请确保正确结束嵌套标签

```
<body>
<ul id="products" class="menu">
<li><a href="#">users</a>
    <ul class="sub_menu'>
        <li><a href="#">user 1</a></li>
        <li><a href="#">user 1</a></li>
        <li><a href="#">user 1</a></li>
    </ul>
</li>
<li><a href="#">product</a>
    <ul class="sub_menu'>
        <li><a href="#">product 1</a></li>
        <li><a href="#">product 1</a></li>
        <li><a href="#">product 1</a></li>
    </ul>
</li>
<li><a href="#">movies</a></li>
<li><a href="#">clips</a></li>
<li><a href="#">teaser</a></li>
<li><a href="#">trailer</a></li>
<li><a href="#">HDMovie</a></li>
</ul>

</body> 
```

剧本

```
$(document).ready(function(){
    $(".menu > li > a").bind("click", function(){
        $('.sub_menu').fadeOut();
        $(this).parent().find('.sub_menu').fadeIn();
    }
}) 
```

# vba - Excel VBA 对象构造函数和析构函数

> ID：571327
> 
> 赞同：26
> 
> 时间：2009-02-20T21:37:37.223
> 
> 标签：vba, object, memory-leaks, constructor, destructor

我需要在 VBA 中创建一些需要相互引用的自定义对象，但我遇到了一些问题。

首先 - 对象构造函数如何在 VBA 中工作？有构造函数吗？

第二 - 有析构函数吗？VBA 如何处理对象生命周期的结束？如果我有一个引用其他对象的对象（这是他们唯一的引用），那么我可以将它设置为 Nothing 并完成它还是会产生内存泄漏？

这种准 OO 的东西只是有点烦人。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-20T21:44:55.630

VBA 支持类模块。它们有一个作为构造函数的 Class_Initialize 事件和一个作为析构函数的 Class_Terminate。您可以定义属性和方法。我相信 VBA 对对象生命周期使用引用计数。这就是为什么你在那种类型的代码中看到很多 Set whatever = Nothing 的原因。在您的示例中，我认为它不会泄漏任何内存。但是你需要小心循环引用。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-20T21:48:40.583

如果你在 VBA 中创建一个类模块，对于构造函数，你可以使用：

```
Private Sub class_initialize()
....
End Sub 
```

没有析构函数，因为 VBA 是垃圾收集的。只要确保清理所有循环引用，就应该避免任何可能的内存泄漏。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-20T21:52:01.277

我已经有一段时间没有使用它们了，但我认为你不能将参数传递给构造函数。我认为这是我遇到的问题之一，但是我遇到了很多关于这些类如何工作以及我期望它们如何工作的问题，我可能记错了。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-06-02T17:04:44.580

存在与析构函数几乎相同的 Class_Terminate。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-01T12:05:08.607

我确认 class_initialize 和 class_terminate。

您可以通过编写此 TestClass 来检查它：

```
Public testVar As Integer

Private Sub class_initialize()
    Debug.Print "Class init"
    testVar = 10
End Sub

Private Sub class_terminate()
    Debug.Print "Class terminate"
End Sub 
```

并将这段代码写在一个模块中：

```
Sub test()
   Dim myTestClass As New TestClass
   Debug.Print myTestClass.testVar
End Sub 
```

然后你会在调试窗口中看到日志。但是通过这个测试，我们可以看到 class_initialize 在您创建实例（使用 new）时不会被调用，而只会在实例中第一次调用方法或获取 var 值时调用。

class_terminate 似乎在 testModule 结束时被调用（如果在 Thisworkbook 对象上创建实例，则“从不”调用终止...可能仅在工作簿关闭或 Excel 关闭时调用）

# perl - 在 Perl 中，如何限制小数点后的位数但没有尾随零？

> ID：571329
> 
> 赞同：5
> 
> 时间：2009-02-20T21:38:00.997
> 
> 标签：perl, printf, decimal-point

这个问题类似于["dropping trailing '.0' from floats"](https://stackoverflow.com/questions/385325/dropping-trailing-0-from-floats)，但对于 Perl 并且小数点后的最大位数。

我正在寻找一种将数字转换为字符串格式的方法，删除任何多余的“0”，包括不只是小数点后。并且仍然具有最大数量的数字，例如 3

输入数据是浮点数。期望的输出：

```
0         -> 0
0.1       -> 0.1
0.11      -> 0.11
0.111     -> 0.111
0.1111111 -> 0.111 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-20T21:45:14.787

直接使用以下内容：

```
my $s = sprintf('%.3f', $f);
$s =~ s/\.?0*$//;

print $s 
```

...或定义一个子例程以更通用地执行此操作：

```
sub fstr {
  my ($value,$precision) = @_;
  $precision ||= 3;
  my $s = sprintf("%.${precision}f", $value);
  $s =~ s/\.?0*$//;
  $s
}

print fstr(0) . "\n";
print fstr(1) . "\n";
print fstr(1.1) . "\n";
print fstr(1.12) . "\n";
print fstr(1.123) . "\n";
print fstr(1.12345) . "\n";
print fstr(1.12345, 2) . "\n";
print fstr(1.12345, 10) . "\n"; 
```

印刷：

```
0
1
1.1
1.12
1.123
1.123
1.12
1.12345 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T00:11:35.997

您还可以使用[Math::Round](http://search.cpan.org/~grommel/Math-Round-0.05/Round.pm)来执行此操作：

```
$ perl -MMath::Round=nearest -e 'print nearest(.001, 0.1), "\n"'
0.1
$ perl -MMath::Round=nearest -e 'print nearest(.001, 0.11111), "\n"'
0.111 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-12T05:09:28.953

您可以`sprintf`与 结合使用`eval`。

```
my $num = eval sprintf('%.3f', $raw_num); 
```

例如：

```
#!/usr/bin/perl 

my @num_array = (
    0, 1, 1.0, 0.1, 0.10, 0.11, 0.111, 0.1110, 0.1111111
);

for my $raw_num (@num_array) {
    my $num = eval sprintf('%.3f', $raw_num);
    print $num . "\n";
} 
```

输出：

```
0
1
1
0.1
0.1
0.11
0.111
0.111
0.111 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T23:32:35.760

这将为您提供您正在寻找的输出：

```
sub dropTraillingZeros{
$_ = shift;
s/(\d*\.\d{3})(.*)/$1/;
s/(\d*\.\d)(00)/$1/;
s/(\d*\.\d{2})(0)/$1/;
print "$_\n";
}
dropTraillingZeros(0);
dropTraillingZeros(0.1);
dropTraillingZeros(0.11);
dropTraillingZeros(0.111);
dropTraillingZeros(0.11111111); 
```

# .net - .NET 是否有等效的 Java CAPS

> ID：571330
> 
> 赞同：0
> 
> 时间：2009-02-20T21:38:31.137
> 
> 标签：.net, web-services, frameworks

我正在寻找一个用于构建和管理 SOA 组合应用程序的集成框架，包括公开 Web 服务、调用第 3 方 Web 服务、执行业务逻辑和调用数据库。

它类似于 Sun Java Composite Application Platform Suite (Java CAPS)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T22:19:01.367

听起来您可能正在寻找 Microsoft 的 BizTalk。

但是，根据您的需求的繁重程度，您可能会发现 WCF（用于为其开发 Web 服务和客户端的 Microsoft 平台）的基础知识以及 Windows Workflow Foundation (WF) 的功能为它们提供服务。人们可以轻松地使用 WF 创建使用一项或多项 Web 服务的程序。您还可以将 WF 工作流公开为服务本身。

在复合应用程序专注于诸如 ETL 之类的过程的情况下，您可以使用 SQL Server Integration Services 做很多事情，它可以将 Web 服务作为整体 ETL 任务的一部分来使用。

请参阅MSDN 上的[WCF 开发人员中心](http://msdn.microsoft.com/wcf/)和[WF 开发人员中心。](http://msdn.microsoft.com/wf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T21:42:46.773

我不熟悉 CAPS，但它听起来与 Microsoft 的 Enterprise Library [http://msdn.microsoft.com/en-us/library/dd203099.aspx非常相似](http://msdn.microsoft.com/en-us/library/dd203099.aspx)

# asp.net - 有人在分布式场中使用 Memcached 和 ASP.NET 吗？

> ID：571338
> 
> 赞同：5
> 
> 时间：2009-02-20T21:41:07.357
> 
> 标签：asp.net, memcached

我们有 22 个 HTTP 服务器，每个服务器都运行自己的 ASP.NET 缓存。他们从只读数据库中读取，该数据库仅在非高峰时间更新。

我们使用文件依赖项来使缓存无效，从而提示服务器“新建”它们的缓存……如果在高峰时段意外这样做，由于打开连接的突然泛滥，可能会导致我们的数据库集群崩溃。

有没有人以这种分布式形式将 memcached 与 ASP.NET 一起使用？在我看来，这将提供一个巨大的优势，即只需构建一个缓存（并减少 21 次访问 DB），而 memcached 将处理在每个盒子上分发它。

如果你有，你是把它和 HTTP 盒子放在同一个盒子上，还是运行一个单独的缓存层？它的扩展性如何，我们可以期望它需要强大的服务器吗？我们的工作数据集并不大（我们将它放入每个 HTTP 框的 4 gigs 内存中就可以了）。

你如何处理失效？

寻找经验和战争故事。

编辑：Win2k3、IIS6、64 位服务器...每盒 4 个演出（我相信，当我们更改为 64 位服务器时，我们可能已经将其提高到 16 个演出）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T01:19:35.567

> “memcached 将处理在每个盒子上分发它”

memcached 不会将缓存分发或复制到 memcached 场中的每个盒子。memcached 客户端基本上对密钥进行散列，并根据该散列选择缓存服务器。当其中一个 memcached 服务器发生故障时，您将丢失该服务器上存在的所有缓存项，但是，客户端将识别故障并开始将值写入另一台服务器。在这种情况下，您的代码需要考虑缓存中丢失的项目并在必要时重置它们。

本文更详细地讨论了 memcached 架构：[memcached 的工作原理](http://code.google.com/p/memcached/wiki/FAQ#How_does_memcached_work?)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T21:51:21.730

最佳实践（根据 memcached 站点）是在与您的 Web 服务器应用程序相同的机器上运行 memcached，否则您正在进行 http 调用（这不是那么糟糕，但它不是最佳的）。如果您正在运行 64 位应用程序服务器（如果您要运行 memcached，您可能应该这样做），那么您可以为每个服务器加载大量内存，并且它可用于 memcached。memcached 使用 CPU 资源的方式并不多，因此如果您当前的应用服务器不是很重，它将保持这种状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T21:48:02.597

没有一起使用它们，但我已经在单独的项目中使用它们。

最后我看到文档明确说与网络服务器共享是可以的。

Memcache 真的只需要 RAM，如果你将你的 asp.net 缓存排除在等式之外，你的 Web 服务器实际使用了多少 RAM？应该不多吧。它不会与您的 Web 服务器竞争 CPU，而且它根本不需要磁盘。您可能会考虑从传入的 Web 请求中分割出网络流量（如果您还没有的话）。

它工作得很好而且速度很快，我没有任何问题。

哦，失效在我使用它的项目上是明确的。不知道还有什么其他模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T16:56:38.100

如果您想在您的 memcached 服务器上进行复制，那么可能值得一看[repcached](http://repcached.lab.klab.org/)。这是处理复制部分的 memcached 补丁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T17:26:26.803

值得一试[Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)，这是 Microsoft 提供的分布式缓存。我不能给你一个与 memcached 的逐点比较，但 Velocity 与 ASP.NET 集成，并将继续得到更多的开发和集成。

# erlang - Erlang - 产生进程和传递参数

> ID：571339
> 
> 赞同：13
> 
> 时间：2009-02-20T21:41:33.843
> 
> 标签：erlang

我一直遇到这个。我想在不使用 MFA 表单（模块/函数/参数）的情况下生成进程并将参数传递给它们，所以基本上不必导出我想用参数生成的函数。我已经使用闭包（fun's）解决了这个问题，并且让参数只是乐趣之外的绑定值（然后我在乐趣中引用），但是它限制了我的代码结构......我看过docs 和 spawn 只有常规 spawn/1 和 spawn/3 形式，没有别的......

我知道如果不使用 MFA 表单就不可能在生成的进程中重新加载代码，但是生成的进程不是长期运行的，并且完成得相对较快，所以这不是问题（我也想在一个模块中包含所有代码级函数，子作业被放置在该函数内的 funs 中）。

非常感谢谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-20T22:55:26.193

实际上，Richard 为我指出了正确的方向，可以很好地避免这个问题（在回复我在 Erlang GoogleGroups 上发布的同一篇文章时）： [http ://groups.google.com/group/erlang-programming/browse_thread/线程/1d77a697ec67935a](http://groups.google.com/group/erlang-programming/browse_thread/thread/1d77a697ec67935a)

## 他的回答：

通过“使用闭包”，我希望你的意思是这样的：

Pid = spawn(fun () -> any_function(Any, Number, Of, Arguments) end)

这将如何限制您的代码结构？

```
 /Richard 
```

* * *

感谢您及时评论您我的问题。非常感激

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T22:19:21.820

简短的回答：你不能。Spawn（以各种不同的形式）只需要一个 0-arity 函数。使用闭包并从生成函数中引入绑定变量是可行的方法，而不是使用诸如 ETS（即 Monster Overkill）之类的某种共享数据存储。

不过，我从未发现使用闭包会严重妨碍我的代码结构；你能举一个你遇到的问题的例子，也许有人可以帮你整理一下吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-29T16:53:21.787

这是一个老问题，但我相信可以通过一点创造力来正确回答：

问题的目标是

*   调用函数

具有以下限制；

*   无`M:F/A`格式
*   不导出调用函数

这可以通过以下方式解决；

使用第一个限制使我们得到以下解决方案：

```
run() ->
    Module = module,
    Function = function,
    Args = [arg1, arg2, arg3],
    erlang:spawn(Module, Function, Args). 
```

但是，在此解决方案中，需要导出该功能。

使用第二个限制（*不导出调用的函数*）和第一个限制我们使用传统的 erlang 逻辑得到以下解决方案：

```
run() ->
    %% Generate an anonymous fun and execute it
    erlang:spawn(fun() -> function(arg1, arg2, arg3) end). 
```

由于垃圾收集器需要执行的额外工作，此解决方案会在每次执行时生成匿名乐趣，根据您的设计可能需要也可能不需要（请注意，通常，这可以忽略不计，问题可能只会在更大系统）。

*在不*生成匿名乐趣的情况下编写上述内容的另一种方法是生成一个`erlang:apply/2`可以执行具有给定参数的函数的函数。

通过传递函数参考。to `erlang:apply/2`，我们可以引用一个本地函数并使用给定的参数调用它。

下面实现了这个解决方案：

```
run() ->
    %% Function Ref. to a local (non-exported) function
    Function = fun function/arity,
    Args = [arg1, arg2, arg3],
    erlang:spawn(erlang, apply, [Function, Args]). 
```

* * *

编辑：这种类型的解决方案可以在[Erlang Src](https://github.com/erlang/otp/blob/71af97853c40d8ac5f499b5f2435082665520642/erts/preloaded/src/erlang.erl#L2888)中找到，`erlang:apply/2`它被调用以执行`fun()`带有 args 的 a。

```
%% https://github.com/erlang/otp/blob/71af97853c40d8ac5f499b5f2435082665520642/erts/preloaded/src/erlang.erl#L2888%% Spawn and atomically set up a monitor.

-spec spawn_monitor(Fun) -> {pid(), reference()} when
      Fun :: function().
spawn_monitor(F) when erlang:is_function(F, 0) ->
    erlang:spawn_opt(erlang,apply,[F,[]],[monitor]);
spawn_monitor(F) ->
    erlang:error(badarg, [F]). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-29T17:52:17.370

首先，没有代码，我们无法为您提供很多帮助，因此使用生成的进程控制函数及其参数的最佳方法是使用接收函数生成进程，然后您将与您的进程联系发送和接收方法，尝试：

```
Pid=spawn(Node, ModuleName, functionThatReceive, [])
%%or just spawn(ModuleName....) if the program is not %%distributed
Pid ! {self(), {M1, f1, A1}}, 
receive
{Pid, Reply} ->Reply
end, 

Pid ! {self(), {M2, f2, A2}}, 
receive
{Pid, Reply} ->Reply
end, 
....... 
functionThatReceive() ->
receive
{From, {M1, f1, A1}} ->From ! {self(), doSomething1} ;
{From, {M2, f2, A2}} ->From ! {self(), doSomething2} 
end. 
```

# apache-flex - 像多选手风琴一样的 Flex 组件？

> ID：571341
> 
> 赞同：2
> 
> 时间：2009-02-20T21:42:24.090
> 
> 标签：apache-flex, accordion

我正在寻找一个像单代树视图这样的组件，它可以折叠一个部分或展开任何或所有部分，但它看起来像一个手风琴：标题和画布“页面”。

显然，每个页面不会占据容器的整个高度；他们将是固定的高度。

也许我没有使用正确的术语（因此是错误的搜索词）。

欢迎所有建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T01:06:18.733

[您可以尝试使用flexlib](http://code.google.com/p/flexlib/)库中的多个[WindowShade](http://flexlib.googlecode.com/svn/trunk/docs/flexlib/containers/WindowShade.html)组件的 VBox ，如本[例所示](http://flexlib.googlecode.com/svn/trunk/examples/WindowShade/WindowShade_Sample.swf)。您需要调整样式，使其看起来更像手风琴。

# c# - ASP.net session 默认是共享的吗？

> ID：571354
> 
> 赞同：3
> 
> 时间：2009-02-20T21:45:17.890
> 
> 标签：c#, asp.net, session-variables

我正在制作一个使用会话变量的应用程序。我创建了一个“HistoryLine”类和另一个名为“HistoryLineCollection”的类，其中包含“HistoryLine”列表。然后我将 HistoryLineCollection 的实例保存到会话中，如下所示：

会话["HistoryLines"] = hLines;

问题是，当我在另一台计算机上观看时，我看到的是相同的列表！我认为客户端独特的会话？我已经查看了 sessionState 并且可能 SessionID 被克隆或其他东西，但我只是看不到它。有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T22:09:24.387

不，不共享 asp.net 会话。发生这种情况的一种方法是在一台计算机上浏览该应用程序，然后在另一台计算机上使用该链接（假设您是某人）。在这种情况下，如果您碰巧禁用了 cookie，则会话 ID 位于 URL 上。另一个人将在同一会话中。如果不是这种情况，那么真的看看你正在使用的类，特别是任何标记为静态的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T22:11:55.127

创建然后放入 Session 的类的成员是否以某种方式静态（又名共享）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T21:50:49.967

检查创建要放入会话的列表的代码。您可能正在为每个会话创建相同的列表。

# wcf - WCF 测试客户端应用程序是否存在已知限制？

> ID：571356
> 
> 赞同：2
> 
> 时间：2009-02-20T21:46:28.870
> 
> 标签：wcf, wcf-client

我知道这已经发生过几次了。如果我将许多 OperationContract 添加到 ServiceContract，WCF 测试客户端应用程序会引发异常：

“添加服务失败。服务元数据可能无法访问。确保您的服务正在运行并公开元数据。”

在详细信息中，它继续：

错误：无法从 获取元数据。请求失败，HTTP 状态为 400：错误请求。

如果我删除了几个运营合同，那么一切都很好。在测试客户端之外也很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T22:20:30.567

您能否更具体地说明您必须从服务合同中删除哪些操作才能使其正常工作？

以下是.NET Framework 3.5 SDK 附带的[WcfTestClient.exe](http://msdn.microsoft.com/en-us/library/bb552364.aspx)工具中的一些已知限制。请注意，所有这些问题都已在 .NET 3.5 SP1 附带的版本中得到修复。

*   客户端不与调用的服务保持**会话。**所有调用都是在新的代理实例上进行的
*   客户端代理的自动生成的**配置文件**可以查看但不能编辑
*   无法调用使用**XML 序列化程序而不是数据协定序列化程序的服务**
*   无法调用使用**消息契约的服务**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T22:22:57.270

这是我必须添加到我的 devenv.exe.config 以使我的 WCF 测试客户端与非常大的服务一起使用的内容。然后我不得不重新启动我的 IDE。这可能不是您想要的，但我希望它有所帮助。

```
<system.serviceModel>
  <bindings>
    <customBinding>
      <binding name="MyBinding">
        <textMessageEncoding>
          <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647"/>
        </textMessageEncoding>
        <httpTransport maxReceivedMessageSize="2147483647" maxBufferSize="2147483647"/>
      </binding>
    </customBinding>
  </bindings>
  <client>
    <endpoint binding="customBinding" bindingConfiguration="MyBinding" contract="IMetadataExchange" name="http"/>
  </client>
</system.serviceModel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T22:41:12.233

感谢您的回复。

这些是有问题的行：

```
<OperationContract(), FaultContract(GetType(WcfService.Common.DefaultFaultContract))> _
Function GetJobSubTypesForJobTypeList(ByVal jobTypeList As Dictionary(Of Integer, String)) As List(Of JobSubTypeOfJobTypeDTO)

<OperationContract(), FaultContract(GetType(WcfService.Common.DefaultFaultContract))> _
Function GetActivityTypesForJobTypeList(ByVal jobTypeList As Dictionary(Of Integer, String)) As List(Of ActivityTypeOfJobTypeDTO) 
```

事实证明，我们在返回类型 (DTO) 和默认构造函数中缺少设置器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-04T06:37:18.680

这是我遇到的最奇怪的问题之一。您可能需要检查您的代码并注意以下问题：

```
Private _NetPay As Boolean
<DataMember()> _
Public Property NetPay() As Boolean
    Get
        Return _Amount = 0
    End Get
    Set(ByVal value As Boolean)
        _NetPay = value
    End Set
End Property 
```

我已经像上面那样定义了一个 DataMember。注意返回语句。它试图返回一个计算值。我删除了这个数据成员；它工作得很好。

# c++ - 如何在 Windows 上为 C++ 程序设置正确的初始语言环境？

> ID：571359
> 
> 赞同：19
> 
> 时间：2009-02-20T21:47:55.653
> 
> 标签：c++, windows, localization, locale

我对本地化编程相当陌生，我正在尝试弄清楚如何为新启动的非托管 C++ 应用程序（从应用程序内部）设置正确的初始语言环境。

据我所知，新应用程序从 C 语言环境开始，而不是正确的区域语言环境（英语、德语等）。所以我需要做的是 call `setlocale( LC_ALL, "???" )`，但我不确定如何获得第二个参数的正确值。它将类似于“英语”或“德语：德国” - 基本上是用户通过区域和语言选项控制面板设置的任何区域设置。为了清楚起见，我*不是*在寻找如何格式化语言环境字符串，而是在为运行应用程序的计算机寻找正确的语言环境字符串。

我猜有一些 Win32 API 会给我这个，或者可能是一个包含正确值的注册表项。有人知道我应该做什么吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-20T21:58:57.623

setlocale() 是 C，而不是 C++。我隐约记得在 VC6 上看到两者之间存在干扰，但那是一个错误。通常，setlocale() 只影响 C 函数的行为。

在 C++ 中，本地化由 std::locale 类控制。默认情况下，区域设置敏感操作使用全局区域设置，这是通过默认构造一个区域设置对象获得的，并且可以使用 std::locale::global(const std::locale&) 设置。

用空字符串 (std::locale("")) 构造一个语言环境对象会创建一个与程序环境相对应的语言环境。

在程序启动时，全局语言环境是“C”或“经典”语言环境。要将全局语言环境设置为程序的环境语言环境（我猜这就是你要问的），你可以这样写：

```
std::locale::global(std::locale("")); 
```

例如，我的区域设置当前设置为法语（加拿大）。运行这个：

```
int main(void)
{
  std::cout << std::locale().name() << std::endl;
  std::locale::global(std::locale(""));
  std::cout << std::locale().name() << std::endl;
  std::locale::global(std::locale("C"));
  std::cout << std::locale().name() << std::endl;
  return 0;
} 
```

印刷：

```
C
French_Canada.1252
C 
```

# sql - 通用 SQL 以获取给定表和列名称的最大值作为 varchar

> ID：571364
> 
> 赞同：1
> 
> 时间：2009-02-20T21:49:48.333
> 
> 标签：sql, sql-server-2005

使用以下 SQL 获取特定主键的值非常容易：来自特定表的 ID：myTale：

```
DECLARE @v_maxID bigint;
SELECT @v_maxID = MAX(ID) FROM myTable; 
```

我需要的是一个通用 SQL 代码来从表中获取键的最大值，其中键和表都被指定为 varchar(max) 类型作为参数：

```
DECLARE @v_maxID bigint;
-- SELECT @v_maxID = MAX(@p_ID) FROM @p_Table; 
```

我注释掉 SELECT 因为它不起作用。我尝试构建一个 SQL 字符串并且我可以执行它，但我无法将最大值返回给我的局部变量 (@v_maxID)。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T21:59:39.043

```
DECLARE @max bigint, @sql nvarchar(max)
SET @sql = N'SELECT @max = MAX(' + @p_ID + ') FROM ' + @p_Table

EXEC sp_executesql 
    @query = @sql, 
    @params = N'@max bigint OUTPUT', 
    @max = @max OUTPUT 

PRINT @max 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T22:12:01.087

用户是选择者，但我认为这是一个丑陋的想法（因为过于笼统）。并且无法优化。只写SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T22:02:08.520

正如[BC](https://stackoverflow.com/questions/571364/q-generic-sql-to-get-max-value/571401#571401)所述，您必须使用带有 OUTPUT 参数的 sp_executesql。

[在 SQL Server 中使用 sp_executesql 存储过程时如何指定输出参数](http://support.microsoft.com/kb/262499)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T21:54:09.990

如果我错了，请纠正我，但你不只是想要：

从 mytable 中选择 MAX(ID)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T21:58:25.987

只需在应用程序级别构建查询，因此运行的查询就像上面的查询一样。因为你必须使用 exec()，所以在 sql 上执行肯定会为你打开 sql 注入。同样在任何一种情况下，都要小心用户输入。

# .net - EnforceConstraints 属性似乎不起作用？

> ID：571367
> 
> 赞同：0
> 
> 时间：2009-02-20T21:50:19.080
> 
> 标签：.net, visual-studio, xsd, dataset

我的老板要求我禁用应用程序数据集层的约束。对我来说似乎很容易，因为 .XSD 具有 EnforceConstraints 布尔值。但是，在关闭它之后，我仍然收到“无法启用约束。一行或多行包含违反非空、唯一或外键约束的值。” 测试中的错误。任何信息/建议都会很有用。

编辑：忘了提到这是将 Visual Studio 与数据集设计器一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T23:27:17.320

这是不是来自 Designer 的错误，这是来自数据库的错误。
在 Designer 中，您可以添加另一层约束检查，但主要的例外来自数据库。
通常删除约束是不好的做法，因为它们检查数据库是否包含正确的数据。

# perl - 如何在 Perl 的 system() 中使用 bash 语法？

> ID：571368
> 
> 赞同：16
> 
> 时间：2009-02-20T21:50:22.903
> 
> 标签：perl, bash, command

如何`bash`在 Perl 的`system()`命令中使用语法？

我有一个特定于 bash 的命令，例如以下命令，它使用 bash 的进程替换：

```
 diff <(ls -l) <(ls -al) 
```

我想从 Perl 调用它，使用

```
 system("diff <(ls -l) <(ls -al)") 
```

但它给了我一个错误，因为它使用`sh`而不是`bash`执行命令：

```
sh: -c: line 0: syntax error near unexpected token `('
sh: -c: line 0: `sort <(ls)' 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-20T21:55:43.217

告诉 Perl 直接调用 bash。使用 的`list`变体[`system()`](http://perldoc.perl.org/functions/system.html)来降低引用的复杂性：

```
my @args = ( "bash", "-c", "diff <(ls -l) <(ls -al)" );
system(@args); 
```

如果您打算经常这样做，您甚至可以定义一个子例程：

```
sub system_bash {
  my @args = ( "bash", "-c", shift );
  system(@args);
}

system_bash('echo $SHELL');
system_bash('diff <(ls -l) <(ls -al)'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T21:54:15.873

```
 system("bash -c 'diff <(ls -l) <(ls -al)'") 
```

理论上应该这样做。`-c`根据手册页，Bash 的选项允许您传递要执行的 shell 命令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T01:35:09.767

vladr 的答案的问题是系统不会从命令（您通常想要的）捕获到 STDOUT 的输出，并且它也不允许执行多个命令（考虑到使用 shift 而不是访问完整@_ 的内容）。

像下面这样的东西可能更适合这个问题：

```
my @cmd = ( 'diff <(ls -l) <(ls -al)', 'grep fu' );
my @stdout = exec_cmd( @cmd );
print join( "\n", @stdout );

sub exec_cmd
{
    my $cmd_str = join( ' | ', @_ );
    my @result = qx( bash -c '$cmd_str' );
    die "Failed to exec $cmd_str: $!" unless( $? == 0 && @result );
    return @result;
} 
```

不幸的是，这不会阻止您调用 /bin/sh 来运行 bash，但是我没有看到解决此问题的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T00:58:26.937

我更喜欢在 perl 中使用反引号“`”执行 bash 命令。这样我得到一个返回值，例如：

```
my $value = \`ls`; 
```

另外，我不必使用“bash -c”来运行命令。为我工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-19T17:17:52.450

受到@errant.info 答案的启发，我创建了一些更简单的东西并为我工作：

```
my $line="blastn -subject <(echo -e \"$seq1\") -query <(echo -e \"$seq2\") -outfmt 6";
my $result=qx(bash -c '$line');
print "$result\n"; 
```

引入的 $line 变量允许每次修改输入（$seq1 和 $seq2）。希望能帮助到你！

# ruby-on-rails - Rails / Mongrel 可以接受带有文本字段的表单 POST，其值为 URL

> ID：571379
> 
> 赞同：1
> 
> 时间：2009-02-20T21:53:27.623
> 
> 标签：ruby-on-rails, http, mongrel, mod-security

在我的 Rails 应用程序中，我试图创建一个允许用户创建书签的表单。

```
<% form_tag( contents_path ) do %>
  <input name='item_type' value="Bookmark" type="hidden" /></p>
  <h3>Create New Bookmark</h3>
  <p>Title:<input name='item[title]' type="text" /></p>
  <p>URL:<input name='item[url]' type="text" /></p>
  <%= submit_tag 'Create' %>
<% end %> 
```

* * *

编辑：为清楚起见，这里是上述模板生成的实际 html：

```
<form action="/contents" method="post"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="cc709c404365f1a5754a7bf0c3fe79ce9ec9f96b" /></div>
  <input name='item_type' value="Bookmark" type="hidden" /></p>
  <h3>Create New Bookmark</h3>
  <p>Title:<input name='item[title]' type="text" /></p>
  <p>URL:<input name='item[url]' type="text" /></p>
  <input name="commit" type="submit" value="Create" />
</form> 
```

如您所见，这是一个完全正常的形式。

* * *

除非输入实际的 URL，否则它的效果很好，在这种情况下，服务器永远不会响应，并且我在 mongrel.log 文件中收到一条消息

```
Error reading HTTP body: #<RuntimeError: Socket read return nil>
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/http_request.rb:105:in `read_socket'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/http_request.rb:77:in `read_body'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/http_request.rb:55:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:149:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:149:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/../lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.4/bin/mongrel_rails:281
/usr/bin/mongrel_rails:16:in `load'
/usr/bin/mongrel_rails:16 
```

可以看出，请求永远不会到达我的控制器代码。

从那以后，我发现提交字段值以字符串“http：/”开头的任何表单都会导致问题。在解决问题之前放置任何其他字符或空格。我也在其他 Rails 应用程序（在同一台服务器上）中尝试过，结果相同。

因此，可以通过在字符串的开头插入额外的空间并在服务器上剥离它来解决该问题。

但我宁愿只在可能的情况下修复服务器端。

我希望这只是服务器上的一个简单错误配置。

我在基于 CPanel 的共享主机安排上在 Rails 2.1.0 下运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T07:18:05.220

堆栈跟踪显示它在跌倒时没有加载任何 Rails 代码，因此它可能不是您的代码或 Rails 本身的问题。我的猜测是您的主机正在使用类似 mod_security 的东西，它认为您的请求看起来很可疑并且正在破坏您的数据。

我在 Apache 上通过 Mongrel 和 Passenger 的表单输入 URL 没有问题，尽管那是在一个自我管理的专用服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T21:58:57.157

为什么不用 form_for 而不是 form_tag？我刚刚完成了与此类似的工作，并且在发布完整网址时从未遇到过问题。

我遇到的一个问题是您向我们展示了提交表单，但没有任何控制器代码很可能是中断的地方。

# java - 如何在 Java 中对 Map 的键进行排序？

> ID：571388
> 
> 赞同：62
> 
> 时间：2009-02-20T21:57:34.883
> 
> 标签：java

这是一个非常基本的问题，我只是不太擅长 Java。我有一个地图，我想按排序顺序获取一个列表或一些键，以便我可以遍历它们。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-20T21:59:34.487

使用 a [`TreeMap`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeMap.html)，它是`SortedMap`接口的实现。它按排序顺序显示其键。

```
Map<String, Object> map = new TreeMap<String, Object>();
/* Add entries to the map in any order. */
...
/* Now, iterate over the map's contents, sorted by key. */
for (Map.Entry<String, ?> entry : map.entrySet()) {
  System.out.println(entry.getKey() + ": " + entry.getValue());
} 
```

如果您正在使用另一个未按您喜欢的方式排序的 Map 实现，您可以将它传递给[构造函数](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeMap.html#TreeMap(java.util.Map))以`TreeMap`创建一个带有排序键的新映射。

```
void process(Map<String, Object> original) {
  Map<String, Object> copy = new TreeMap<String, Object>(original);
  /* Now use "copy", which will have keys in sorted order. */
  ... 
} 
```

A`TreeMap`适用于实现接口的任何类型的键`Comparable`，将它们置于“自然”顺序。对于不是的键`Comparable`，或者其自然顺序不是您需要的键，您可以实现自己的键并在[构造函数](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeMap.html#TreeMap(java.util.Comparator))[`Comparator`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html)中指定。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-20T22:04:44.210

你有几个选择。按优先顺序列出：

1.  使用 a [`SortedMap`](http://java.sun.com/javase/6/docs/api/java/util/SortedMap.html)：
    `SortedMap<whatever> myNewMap = new TreeMap<whatever>(myOldMap);`
    如果您想多次迭代，这是非常可取的。它使键保持排序，因此您不必在迭代之前对它们进行排序。
2.  没有#2。
3.  也没有#3。
4.  `SortedSet<whatever> keys = new TreeSet<whatever>(myMap.keySet());`
5.  `List<whatever> keys = new ArrayList<whatever>(myMap.keySet()); Collections.sort(keys);`

最后两个会给你你想要的，但只有当你只想迭代一次然后忘记整个事情时才应该使用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-20T22:07:35.357

您可以在迭代时创建一个排序集合，但首先拥有一个排序映射更有意义。（正如已经建议的那样）

都一样，这就是你的做法。

```
Map<String, Object> map;
for(String key: new TreeSet<String>(map.keySet()) {
  // accessed in sorted order.
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-11-16T10:15:50.630

除了其他答案中提到的方法之外，对于 Java 8 流，从映射中获取排序键列表的另一种简写方式是 -

```
List<T> sortedKeys = myMap.keySet().stream().sorted().collect(Collectors.toList()); 
```

实际上也可以在之后完成一些事情`.sorted()`（比如使用 a`.map(...)`或 a `.forEach(...)`），而不是在列表中收集它然后遍历列表。

# visual-studio - 有什么方法可以防止自己意外构建错误的 Visual Studio 配置？

> ID：571393
> 
> 赞同：3
> 
> 时间：2009-02-20T21:58:34.163
> 
> 标签：visual-studio, msbuild, build-process

在 Visual Studio 中，我有针对不同层的自定义 MSBuild 操作 - 开发、暂存、测试等。这些脚本将自动编译所有内容，进行 web.config 交换，并将代码推送到基于所选配置的位置。通常，当我想在开发以外的其他东西上运行其中一个构建时，我会从命令行调用构建脚本。

尽管我尝试尽可能地勤奋，但有时我自己（和其他在解决方案中工作的人）会不小心将配置留在他们不打算的配置中 - 也许他们将其切换到“暂存”配置以查看代码的外观及其特定的预处理器指令。然后他们点击“F5”，认为他们正在开发调试......并意外地将破坏的代码推出。

所以问题是，有没有办法让构建脚本仍然与配置相关联，但不允许从 IDE 构建某些配置？还是弹出警告？还是我一开始就以错误的方式开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T00:58:49.843

要使暂存构建失败，除非它是团队构建，您应该能够使用

```
<Error
  Text="No Staging builds except on the Team Build server"
  Condition=" '$(IsDesktopBuild)'=='true' And $(Configuration)='Staging' " /> 
```

CruiseControl.NET 还将独特的属性传递给 msbuild，因此类似的想法将适用于其中一个代替 IsDesktopBuild。

我不知道 Visual Studio 构建和命令行 msbuild 之间的默认属性有任何差异，但如果你能忍受一些额外的输入，这应该可以完成工作

```
<Error
  Text="You didn't say the magic word"
  Condition=" '$(MagicWord)'!='please' And $(Configuration)='Staging' " /> 
```

然后

```
msbuild /p:Configuration=Staging /p:MagicWord=please 
```

Visual Studio 不会包含额外的属性，因此构建将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:25:41.910

[用于在 MSBuild 编译过程中添加更多控制的任务类](http://msdn.microsoft.com/en-us/library/microsoft.build.utilities.task.aspx)。

# c++ - 如何找出一个项目是否存在于 std::vector 中？

> ID：571394
> 
> 赞同：726
> 
> 时间：2009-02-20T21:58:41.557
> 
> 标签：c++, vector, std

我要做的就是检查向量中是否存在元素，这样我就可以处理每种情况。

```
if ( item_present )
   do_this();
else
   do_that(); 
```

* * *

## 回答 #1

> 赞同：1075
> 
> 时间：2009-02-20T22:00:50.537

您可以使用[`std::find`](http://en.cppreference.com/w/cpp/algorithm/find)来自`<algorithm>`：

```
#include <algorithm>
#include <vector>
vector<int> vec; 
//can have other data types instead of int but must same datatype as item 
std::find(vec.begin(), vec.end(), item) != vec.end() 
```

这会将迭代器返回到找到的第一个元素。如果不存在，它会返回一个迭代器到最后一个。用你的例子：

```
#include <algorithm>
#include <vector>

if ( std::find(vec.begin(), vec.end(), item) != vec.end() )
   do_this();
else
   do_that(); 
```

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-02-20T22:26:14.953

正如其他人所说，使用 STL[`find`](http://en.cppreference.com/w/cpp/algorithm/find)或[`find_if`](http://en.cppreference.com/w/cpp/algorithm/find)函数。但是，如果您在非常大的向量中搜索并且这会影响性能，您可能需要对向量进行排序，然后使用[`binary_search`](http://en.cppreference.com/w/cpp/algorithm/binary_search)、[`lower_bound`](http://en.cppreference.com/w/cpp/algorithm/lower_bound)或[`upper_bound`](http://en.cppreference.com/w/cpp/algorithm/upper_bound)算法。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-02-20T22:06:50.880

使用 stl 的算法头中的 find。我已经说明了它与 int 类型的用法。您可以使用任何您喜欢的类型，只要您可以比较是否相等（如果您需要为您的自定义类重载 ==）。

```
#include <algorithm>
#include <vector>

using namespace std;
int main()
{   
    typedef vector<int> IntContainer;
    typedef IntContainer::iterator IntIterator;

    IntContainer vw;

    //...

    // find 5
    IntIterator i = find(vw.begin(), vw.end(), 5);

    if (i != vw.end()) {
        // found it
    } else {
        // doesn't exist
    }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2012-11-23T08:58:39.277

如果您的向量未排序，请使用 MSN 建议的方法：

```
if(std::find(vector.begin(), vector.end(), item)!=vector.end()){
      // Found the item
} 
```

如果您的向量是有序的，请使用 Brian Neal 建议的 binary_search 方法：

```
if(binary_search(vector.begin(), vector.end(), item)){
     // Found the item
} 
```

二分搜索产生 O(log n) 最坏情况的性能，这比第一种方法更有效。为了使用二分查找，您可以先使用 qsort 对向量进行排序，以保证它是有序的。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2013-09-04T16:34:07.027

我用这样的东西......

```
#include <algorithm>

template <typename T> 
const bool Contains( std::vector<T>& Vec, const T& Element ) 
{
    if (std::find(Vec.begin(), Vec.end(), Element) != Vec.end())
        return true;

    return false;
}

if (Contains(vector,item))
   blah
else
   blah 
```

...那样它实际上是清晰易读的。（显然你可以在多个地方重用模板）。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2015-08-11T04:15:57.720

在 C++11 中，您可以使用`any_of`. 例如，如果它是一个`vector<string> v;`then：

```
if (any_of(v.begin(), v.end(), bind(equal_to<string>(), _1, item)))
   do_this();
else
   do_that(); 
```

或者，使用 lambda：

```
if (any_of(v.begin(), v.end(), [&](const std::string& elem) { return elem == item; }))
   do_this();
else
   do_that(); 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2016-02-11T21:38:51.830

这是一个适用于任何容器的函数：

```
template <class Container> 
const bool contains(const Container& container, const typename Container::value_type& element) 
{
    return std::find(container.begin(), container.end(), element) != container.end();
} 
```

请注意，您可以使用 1 个模板参数，因为您可以`value_type`从容器中提取。您需要`typename`因为`Container::value_type`是[从属名称](http://en.cppreference.com/w/cpp/language/dependent_name)。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-02-20T22:42:36.647

请记住，如果您要进行大量查找，那么 STL 容器会更适合您。我不知道您的应用程序是什么，但像 std::map 这样的关联容器可能值得考虑。

std::vector 是首选容器，除非您有另一个原因，并且按值查找可能是这样的原因。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-02-20T22:18:34.877

使用 STL[查找](http://www.sgi.com/tech/stl/find.html)功能。

请记住，还有一个[find_if](http://www.sgi.com/tech/stl/find_if.html)函数，如果您的搜索更复杂，您可以使用它，即如果您不只是在寻找一个元素，而是，例如，想看看是否有一个元素满足某个特定条件条件，例如以“abc”开头的字符串。（`find_if`会给你一个指向第一个这样的元素的迭代器）。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2016-09-27T16:02:37.367

使用 boost，您可以使用[`any_of_equal`](http://www.boost.org/doc/libs/1_61_0/libs/algorithm/doc/html/the_boost_algorithm_library/CXX11/any_of.html)：

```
#include <boost/algorithm/cxx11/any_of.hpp>

bool item_present = boost::algorithm::any_of_equal(vector, element); 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-04-28T15:29:48.190

你可以试试这段代码：

```
#include <algorithm>
#include <vector>

// You can use class, struct or primitive data type for Item
struct Item {
    //Some fields
};
typedef std::vector<Item> ItemVector;
typedef ItemVector::iterator ItemIterator;
//...
ItemVector vtItem;
//... (init data for vtItem)
Item itemToFind;
//...

ItemIterator itemItr;
itemItr = std::find(vtItem.begin(), vtItem.end(), itemToFind);
if (itemItr != vtItem.end()) {
    // Item found
    // doThis()
}
else {
    // Item not found
    // doThat()
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-06-15T00:36:20.523

您可以使用命名空间[`find`](http://www.cplusplus.com/reference/algorithm/find/)中的函数`std`，即`std::find`. 您从要搜索的向量中传递`std::find`函数 the`begin`和`end`迭代器，以及要查找的元素，并将生成的迭代器与向量的末尾进行比较，以查看它们是否匹配。

```
std::find(vector.begin(), vector.end(), item) != vector.end() 
```

您还可以取消引用该迭代器并像任何其他迭代器一样正常使用它。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-01-26T17:55:40.613

```
template <typename T> bool IsInVector(const T & what, const std::vector<T> & vec)
{
    return std::find(vec.begin(),vec.end(),what)!=vec.end();
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-03-11T10:00:12.313

您也可以使用计数。它将返回向量中存在的项目数。

```
int t=count(vec.begin(),vec.end(),item); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-10-28T15:23:52.253

我个人最近使用模板来一次处理多种类型的容器，而不是只处理向量。我在网上找到了一个类似的例子（不记得在哪里）所以归功于我从谁那里偷来的。这种特殊的模式似乎也可以处理原始数组。

```
template <typename Container, typename T = typename std::decay<decltype(*std::begin(std::declval<Container>()))>::type>
bool contains(Container && c, T v)
{
    return std::find(std::begin(c), std::end(c), v) != std::end(c);
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-05-31T13:55:53.397

如果你想在向量中找到一个字符串：

```
 struct isEqual
{
    isEqual(const std::string& s): m_s(s)
    {}

    bool operator()(OIDV* l)
    {
        return l->oid == m_s;
    }

    std::string m_s;
};
struct OIDV
{
    string oid;
//else
};
VecOidv::iterator itFind=find_if(vecOidv.begin(),vecOidv.end(),isEqual(szTmp)); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-03-26T19:23:26.373

（C++17 及以上）：

`std::search`也可以用

这对于搜索元素序列也很有用。

```
#include <algorithm>
#include <iostream>
#include <vector>

template <typename Container>
bool search_vector(const Container& vec, const Container& searchvec)
{
    return std::search(vec.begin(), vec.end(), searchvec.begin(), searchvec.end()) != vec.end();
}

int main()
{
     std::vector<int> v = {2,4,6,8};

     //THIS WORKS. SEARCHING ONLY ONE ELEMENT.
     std::vector<int> searchVector1 = {2};
     if(search_vector(v,searchVector1))
         std::cout<<"searchVector1 found"<<std::endl;
     else
         std::cout<<"searchVector1 not found"<<std::endl;

     //THIS WORKS, AS THE ELEMENTS ARE SEQUENTIAL.
     std::vector<int> searchVector2 = {6,8};
     if(search_vector(v,searchVector2))
         std::cout<<"searchVector2 found"<<std::endl;
     else
         std::cout<<"searchVector2 not found"<<std::endl;

     //THIS WILL NOT WORK, AS THE ELEMENTS ARE NOT SEQUENTIAL.
     std::vector<int> searchVector3 = {8,6};
     if(search_vector(v,searchVector3))
         std::cout<<"searchVector3 found"<<std::endl;
     else
         std::cout<<"searchVector3 not found"<<std::endl;
} 
```

还有传递一些搜索算法的灵活性。参考这里。

[https://en.cppreference.com/w/cpp/algorithm/search](https://en.cppreference.com/w/cpp/algorithm/search)

# user-interface - 如何避免随机用户界面？

> ID：571403
> 
> 赞同：1
> 
> 时间：2009-02-20T22:00:02.987
> 
> 标签：user-interface

举例来说，我将做一些我的裤子编码，为企业应用程序添加一个功能。人们可以遵循哪些好的示例/租户/基本规则来使相当复杂的设置/配置屏幕看起来不像脚。

我正在寻找的是“不要把一个东西放在一个组合框中”的思路。但是，如果有人知道哪些布局最有可能实现相对数量的美观效果，我也希望得到一些对称方面的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T22:22:12.857

这是您要求的基本规则：垂直/水平排列控件，并平均间隔各种相关元素。并在标签上使用正确的拼写！

我们都遇到过存在未对齐控件（即使是几个像素也很明显）或标签拼写错误的屏幕。当这种情况发生在我身上时，我不禁下意识地寻找其他错误，而且它降低了我对我正在使用的应用程序的信心！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T22:19:52.597

这其实是一个很大的话题。我经常访问[Microsoft UX Guide](http://msdn.microsoft.com/en-us/library/aa511335.aspx)以获取有关如何执行此操作的提醒。

一些基础知识：

*   让您的应用像书一样阅读：从左到右，从上到下
*   使用[面向目标的语言](http://msdn.microsoft.com/en-us/library/aa974175.aspx)而不是面向技术的语言

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T22:21:50.457

不是基本规则，而是一个很好的资源：

[Apple UI 指南](http://developer.apple.com/documentation/userexperience/Conceptual/AppleHIGuidelines/XHIGIntro/chapter_1_section_1.html)（适用于任何操作系统的好信息）

编辑：回复：实现对称 - 事物不必完全对称，但你想要一种平衡的感觉。退后一步，感受一下页面或表单是向左还是向右倾斜/下落。

例如，使用stackoverflow，主要内容在左侧，但右侧的额外内容很好地平衡了它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T23:02:15.320

给你一些基本规则。

1.  尝试有效地利用空白。不要为了让尽可能多的东西出现在屏幕上而把所有东西都塞在一起。这将使分组控件更清晰，文本更清晰。

2.  基本排版。将字体的使用限制为 1 或 2。不要过多使用粗体，否则会失去重点。

3.  颜色也是如此。不要使用太多，大多数时候越少越好。

4.  不要只使用图标来节省空间。没有解释的小图标是没有用的。

5.  复制。当然不是批发，但如果你自己不精通 UI 设计，那么将你知道的界面元素应用到你自己的设计中是有意义的。

6.  明确接口的用途。例如，它如何适应更广泛的应用？您试图满足的具体目标是什么？

7.  让人们尽早并经常为您测试它。我不知道你正在使用什么设置，或者你在什么样的组织中，但是即使你缺乏时间和专业知识来进行适当的可用性评估，从你的工作中获得某种人工反馈总是有帮助的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T23:14:26.820

我发现那张纸是我的朋友。我喜欢写出表格必须完成的目标列表，然后用手画出表格，标记各个部分。把它画出来让我摆脱了确保它看起来完美和一切都恰到好处的对齐，让我专注于确保我需要的所有组件都放置在逻辑上的某个地方。它还迫使我布置 UI 两次，所以当我打开 UI 设计器时，我已经设计了一次表单，希望你知道我在做什么

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T22:19:35.267

由于您使用术语“您的裤子”，我假设您不想在 UI 上花费太多时间。如果您愿意花一些时间在 UI 上，您可能希望研究适合您情况的自定义控件或 UI 开发。像 Firefox 的 Options UI 或 Visual Studio 2008 中的 .NET 项目属性。

如果您正在寻找使用标准控件的东西，最好将相关项目的不同部分分离到选项卡或其他类型的堆叠控件（即功能区控件）中。选项卡式版本的一个很好的例子是[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm) Preferences UI。许多其他程序使用类似的方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T22:11:08.407

从您认为既简单又可用的现有应用程序的设置/配置 UI 开始。

大多数租户/基本规则通常适用于 UI，并在 UI 设计和 HCI 书籍中占据数百页，因此您现在可能只想通过示例来工作，同时尝试利用现有的用户体验（习惯），即遵守**“最不意外”的规则**：例如，如果您的应用程序是 Windows 应用程序，则使用安装向导模式，如果它是特定风格的 *nix 的 ncurses 应用程序，则遵循该特定操作系统的实际安装 UI 的样式等。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-20T23:20:43.560

获得有意义的 UI 的最佳方法是遵循 Joel 的建议：

[吃自己的狗粮。](http://www.joelonsoftware.com/articles/fog0000000012.html)

对你自己的 UI 做几次，你会注意到一些你最初没有想到的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-20T23:24:13.440

我发现一个非常好的测试是让非技术人员使用您的 GUI。观看某人使用它 5-10 分钟通常会让我很好地了解什么是/不是更容易理解。

Joel Spolsky 的这个[系列](http://www.joelonsoftware.com/uibook/fog0000000249.html)读起来非常好，Jakob Nielsen 的东西[可用性和网页设计](http://www.useit.com)非常有用。

我尝试使用的具体规则是：

*   将项目放在逻辑组中
*   把所有东西都排好
*   使用合理的图像/图标
*   花 5-10 分钟思考为什么事情会这样
*   只使用对用户而不是对您有意义的词！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-20T22:17:38.593

您可能对“ [Don't Make Me Think](https://rads.stackoverflow.com/amzn/click/com/0321344758) ”（作者的[网站](http://www.sensible.com/index.html)）或“ [About Face 3.0](https://rads.stackoverflow.com/amzn/click/com/0470084111) ”一书感兴趣。强烈推荐两者都阅读有关如何设计界面的信息。

# .net - WPF：如何使用嵌套（分层）控件实现拖放

> ID：571407
> 
> 赞同：7
> 
> 时间：2009-02-20T22:01:51.940
> 
> 标签：.net, wpf, silverlight

使用 WPF，我成功地实现了拖放以重新排列列表（视图或框）中的项目，并在列表之间拖放项目。

现在我正在尝试弄清楚如何使用嵌套列表实现拖放。

例如，我有一个包含项目的列表视图，每个项目项都包含另一个任务列表视图。我希望能够拖放以重新排列项目的顺序，还希望能够重新排序任务并在项目之间移动它们。

我的代码可以成功地完成其中之一，但我不知道如何同时做到这一点。

似乎有某种痛苦的解决方案会涉及命中测试以及嵌套列表的 z 顺序，但我找不到任何这样的例子。

任何人都可以提供任何指示吗？

仅供参考：我目前实现的工作代码基于以下两篇关于 WPF 拖放的优秀文章：

[http://bea.stollnitz.com/blog/?p=53](http://bea.stollnitz.com/blog/?p=53) [http://www.codeproject.com/KB/WPF/ListViewDragDropManager.aspx](http://www.codeproject.com/KB/WPF/ListViewDragDropManager.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-06T11:49:24.690

由于`MouseMove`wpf 中的大多数其他事件都是路由事件，因此您可以只签`e.OriginalSource`入一个通用事件处理程序。然后，您可以根据鼠标所在的元素决定要拖动的元素，可能使用“查找满足条件的父项”辅助方法技术之一。此外，您可以设置`e.Handled`视觉树中是否有多个元素订阅该事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T22:06:14.080

第一个想法是，如果要嵌套，为什么不使用 TreeView 而不是 ListView 呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-06T11:36:29.007

AllowDrop 在任何控件上都必须为真。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T20:27:43.777

在使用带有嵌套用户控件列表框的应用程序时，我遇到了类似的问题。
我在`PreviewMouseButtonDown event`每个控制级别上处理了所有这些。我检查被点击的点的坐标。如果它来自父级`ListBoxItem`中不在的任何地方`ListBox`，我会在`DragDrop.DoDragDrop()`那里处理。如果它来自内部`ListBoxItem`，我让它冒泡到子 ListBox 的`PreviewMouseButtonDown event`. 我检查该位置在子 ListBox 中的位置，以查看单击了哪个项目，以便我可以抓住它并`DragDrop`在此级别上执行操作。

伪代码如下：

```
Parent ListBox  
--  PListBoxItem1  
--  PListBoxItem2  
--  PListBoxItem3  
----    Child ListBox  
------  Child ListBoxItem1  
------  Child ListBoxItem2  -Click drag started here  
------  Child ListBoxItem3 
```

代码：

```
Parent_List_Box_PreviewMouseButtonDown  
If mouse position is not inside the Child ListBox Then  
  DoDragDrop() on the Parent level with this ListBoxItem  
End If

Child_ListBox_PreviewMouseButtonDown  
Determine which item the mouse was clicked on relative to the Child ListBox  
DoDragDrop() on the Child level with this ListBoxItem 
```

因此，由于`click`位于 a`Child's ListBox`中，因此事件会冒泡到通过`DragEvent`.

希望这可以帮助！

# iphone - 在 iPhone 上使用 NSDateFormatter 格式化日期

> ID：571413
> 
> 赞同：0
> 
> 时间：2009-02-20T22:04:01.823
> 
> 标签：iphone, cocoa, cocoa-touch, objective-c

由于 initWithDateFormat:allowNaturalLanguage: 现在已弃用，

```
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] initWithDateFormat:@"%B %d, %Y" allowNaturalLanguage:NO] autorelease]; 
```

当前如何使用 2.2.1 使用相同的格式化字符串进行格式化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-25T12:13:23.773

PL。使用以下步骤：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T22:08:46.447

只需手动分配给 dateFormat 并且只使用“init”而不是“initWithDateFormat:...”。

自然语言的东西似乎已被弃用。

# javascript - 帮助使用 jquery 构建部分导航菜单

> ID：571415
> 
> 赞同：0
> 
> 时间：2009-02-20T22:04:25.520
> 
> 标签：javascript, jquery

我真的可以使用一些帮助来解决我的感觉将是一些非常基本的 jquery，但我还是被困住了。

我的 html 中有一个未知（动态生成）数量的 div，每个 div 都有一个“页面”类。

我想要做的是为每个div.page添加一个id，然后为每个div.page填充一个id为menu的ul，每个div.page包含一个href值为#page_n的锚（即其对应的id值分）

我希望我的输出看起来像这样：

```
<div class="page" id="page_1">
...content...
</div>

<div class="page" id="page_2">
...content...
</div>

.....

<div class="page" id="page_n">
...content...
</div>

<ul #menu>
    <li><a href="#page_1">Page 1</a></li>
    <li><a href="#page_2">Page 2</a></li>
.....
    <li><a href="#page_n">Page n</a></li>
</ul> 
```

我正在添加 id 可以：

```
$('li.page').each(function(index){$(this).attr("id", "page_" + (index+1));
    }); 
```

但我正在努力解决问题的第二部分。我知道这可能有点基本，但我才刚刚开始......

感激地收到任何帮助...提前谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T22:12:06.267

如果您的 HTML 最初看起来像这样：

```
<div class='page'>...</div>
<div class='page'>...</div>
<div class='page'>...</div>
<ul id='menu'></ul> 
```

这个 jQuery 代码：

```
$(document).ready(function() {
    $('div.page').each(function(i) {
        var x = i+1;
        var id = 'page_' + x;
        $(this).attr('id', id);
        var li = $('<li/>').append(
            $('<a/>').attr('href', '#' + id).html('Page ' + x)
        );
        $('#menu').append(li);
    });
}); 
```

将使您的 HTML 看起来像这样：

```
<div class='page' id='page_1'>...</div>
<div class='page' id='page_2'>...</div>
<div class='page' id='page_3'>...</div>
<ul id='menu'>
    <li><a href="#page1">Page 1</a></li>
    <li><a href="#page2">Page 2</a></li>
    <li><a href="#page3">Page 3</a></li>
</ul> 
```

# powershell - PowerShell、Web 请求和代理

> ID：571429
> 
> 赞同：35
> 
> 时间：2009-02-20T22:08:30.207
> 
> 标签：powershell, powershell-2.0

发出简单的[Web 请求](https://stackoverflow.com/questions/340553/what-is-the-best-way-to-send-http-requests-from-windows-powershell)时，有没有办法告诉 PowerShell 环境只使用 Internet Explorer 的代理设置？

我的代理设置由网络策略（或脚本）控制，如果不需要，我不想稍后修改 ps 脚本。

**更新：** 来自参与者的重要信息。我将用于此的最终脚本模板如下所示：

```
$proxyAddr = (get-itemproperty 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings').ProxyServer
$proxy = new-object System.Net.WebProxy
$proxy.Address = $proxyAddr
$proxy.useDefaultCredentials = $true

$url = "http://stackoverflow.com"
$wc = new-object system.net.WebClient
$wc.proxy = $proxy
$webpage = $wc.DownloadData($url)
$str = [System.Text.Encoding]::ASCII.GetString($webpage)
Write-Host $str 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-02-14T14:52:28.043

更好的是以下，它也处理自动检测的代理：

```
$proxy = [System.Net.WebRequest]::GetSystemWebProxy()
$proxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials

$wc = new-object system.net.WebClient
$wc.proxy = $proxy
$webpage = $wc.DownloadData($url) 
```

（编辑）除上述之外，这个定义对我来说似乎也很好：

```
function Get-Webclient {
    $wc = New-Object Net.WebClient
    $wc.UseDefaultCredentials = $true
    $wc.Proxy.Credentials = $wc.Credentials
    $wc
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-20T22:37:23.180

*未经测试*：

```
$user = $env:username
$webproxy = (get-itemproperty 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings').ProxyServer
$pwd = Read-Host "Password?" -assecurestring

$proxy = new-object System.Net.WebProxy
$proxy.Address = $webproxy
$account = new-object System.Net.NetworkCredential($user,[Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($pwd)), "")
$proxy.credentials = $account

$url = "http://stackoverflow.com"
$wc = new-object system.net.WebClient
$wc.proxy = $proxy
$webpage = $wc.DownloadData($url)
$string = [System.Text.Encoding]::ASCII.GetString($webpage) 
```

...

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-05-08T15:54:19.073

这比原始问题晚得多，但对于更高版本的 PowerShell 仍然是一个相关的答案。从 v3 开始，我们有两个项目可以解决这个问题：

**Invoke-WebRequest** - 几乎在所有场景中都使用 system.net.webclient

**$PSDefaultParameterValues** - 可以存储参数的详细信息

如何将它们一起使用来解决由网络策略（或脚本）控制的代理设置的原始问题，而无需稍后修改 ps 脚本？

Invoke-WebRequest 带有 -Proxy 和 -ProxyUseDefaultCredentials 参数。

我们将这些参数的答案存储在 $PSDefaultParameterValues 中，如下所示： `$PSDefaultParameterValues.Add('Invoke-WebRequest:Proxy','http://###.###.###.###:80')` `$PSDefaultParameterValues.Add('Invoke-WebRequest:ProxyUseDefaultCredentials',$true)`

您可以随意将“ [http://###.###.###.###:80](http://###.###.###.###:80) ”替换为 $proxyAddr 。您选择将其存储在什么范围内，是您的选择。我把它们放到了我的 $profile 中，所以我再也不用在我的脚本中设置这些项目了。

希望这对某人有帮助！

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-21T17:20:05.837

```
$proxy = New-Object System.Net.WebProxy("http://yourProxy:8080")
$proxy.useDefaultCredentials = $true
$wc = new-object system.net.webclient
$wc.proxy = $proxy
$wc.downloadString($url) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-22T22:59:31.537

我知道这真的很老了，但是有一个正确的方法，似乎很少有人知道它。下面将找出您感兴趣的 URI 的代理是什么并使用它。

```
$uri = "http://www.google.com"
invoke-webrequest -ProxyUseDefaultCredentials -proxy (new-object System.Net.WebClient).Proxy.GetProxy($uri).AbsoluteUri $uri 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-07-18T06:37:57.610

只需使用您自己的代理地址更新 URL：端口。它使 PowerShellGet 能够使用您的本地凭据通过代理。如果您没有凭据要求，只需在提示您输入密码时单击“确定”。我将该框重命名为“关闭此窗口”。由于此脚本，您还可以通过代理使用其他包管理器，例如 Chocolatey/Nuget。

# oracle - 优化 Oracle 实例

> ID：571434
> 
> 赞同：3
> 
> 时间：2009-02-20T22:11:16.957
> 
> 标签：oracle

我正在与一个开发适用于 SQL Server 和 Oracle 的应用程序的团队合作。

SQL Server 有一个实例的概念，它可以容纳多个数据库。Oracle 10g 需要每个数据库一个实例（并且可以允许更多实例以实现冗余），因此对于我们运行的每个数据库，我们都有一组完全独立的进程，因此内存使用量要大得多。

正因为如此，我们开始更多地转向拥有一个具有单独架构的实例。但是，我们仍然希望将单独的客户（或开发机器）数据分开。

我们的大多数实例都是使用本地开发的脚本创建的（例如，Windows 上的 oradim）。

可以做些什么来减少 Oracle 实例的内存使用要求、占用空间等，以便多个实例可以在一台机器上安全运行？Linux 或 Windows 是更好的主机吗？我们可以通过禁用我们不需要的额外功能（数据挖掘、Oracle Text 等）轻松获得收益吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T22:28:36.663

恕我直言，记忆对性能来说是最重要的`Oracle`。

运行多个数据库意味着为系统表保留多组缓存`SQL`和`PL/SQL`多个数据缓存等。

如果您只需要将数据分开，您可以`TABLESPACES`为不同的用户创建不同的数据。不过，您仍然必须分享`LOGFILES`。

禁用诸如此类的额外功能`Data Mining`对您没有太大帮助，因为它们在不使用时不会消耗内存。

您当然需要降低任何内存值，但是如果没有看到您的数据库设计，就很难说出应该保留哪些以及需要降低哪些。

作为一个**非常不精确**的经验法则，如果你有`OLTP`数据库，即小表和高并发性，你可能应该牺牲`sort_area_size`and `hash_area_size`，但尽可能保持`db_block_buffers`高。

如果您有使用`HASH JOINS`and的大型表，则`MERGE JOINS`需要`sort_area_size`and`hash_area_size`来进行有效的连接和排序，但您可以减少`db_block_buffers`，因为无论如何您都无法缓存这些表。

`Linux`并且`Windows`在性能方面差别不大`Oracle`。`Linux`，不过，恩典`LOCK_SGA`。`Windows`也尝试这样做，但可以在艰难的内存条件下换出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T22:39:53.017

内存消耗将来自以下几个方面：

1.  实例 SGA
2.  每会话 UGA、PGA（排序等）
3.  杂项 上面未涵盖的其他每个进程的内存要求（例如，每个 oracle 进程使用的堆栈和堆，实际可执行映像使用的内存等）

为了防止开发人员和客户破坏彼此的缓冲区缓存，1 的成本是值得的。那些不关心这些事情的实例应该被合并。

您可以假设所有 RDBMS 以一种或另一种形式支付 2 的成本（并且仅是您的 RDBMS 配置的函数），因此这不是权衡。

我估计 3 的影响在 Linux 上是最好的，因为[fork 和 page sharing](http://en.wikipedia.org/wiki/Fork_(operating_system)#Fork_and_page_sharing)，所以你只需为你使用的东西付费。在现代 *nix 系统上，从 CPU 和内存的角度来看，fork-instead-of-multithreaded 方法非常高效，同时提供了许多其他优势（您几乎不必担心内存泄漏。）

* * *

话虽如此，不要忘记来自 Windows 任务管理器或来自 Windows 任务管理器的内存读数`top`可能会因为“重复计算”而误导进程的实际内存消耗：共享内存段以及实际 oracle 的大小实际上，所有相关进程共享内存（并且仅使用一次）时，可以为每个进程计算可执行文件和动态链接库。在 Unix 下使用“pmem”或“cat /proc//maps”来查看进程实际使用了多少内存以及共享了多少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T22:40:40.737

如果您使用的是 Oracle 11g，MEMORY_TARGET 是您要设置的参数。

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28320/initparams133.htm](http://download.oracle.com/docs/cd/B28359_01/server.111/b28320/initparams133.htm)

当您将更多数据库实例添加到同一台服务器时，您需要在所有其他实例上向下调整此参数，以便您不会在服务器上使用太多内存并导致其交换。在 Oracle 10g 上，您设置 PGA_AGGREGATE_TARGET 和 SGA_TARGET。

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams157.htm](http://download.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams157.htm)

不幸的是，您添加的 Oracle 实例越多，调优就越困难，系统也会变得越慢。

我真的没有太多关于 Windows 与 Linux 的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T22:51:37.060

如果您的主要目标是分离客户端数据，则无需运行多个实例。您可以实现两种类型的分离。通过将每个客户端放在单独的模式中，您已经实现了第一个逻辑分离。要物理分离数据，请为每个客户端创建一个表空间。表空间是一组实际的数据库文件。通过使用它们，您可以控制数据的物理存储位置。为客户端创建模式时，将客户端的表空间分配为“默认表空间”。

除非您想在同一台服务器上运行不同版本的 Oracle，否则很少有理由启动多个实例。要充分利用您的单个实例，请在内存中尽可能多地获取它，并使用 TOAD 等工具或随附的 Oracle 工具来优化对各种 Oracle 进程的内存分配。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T09:11:18.600

如果您有单独的模式，则您可以将不同客户的数据分开。为什么需要更多实例？每台机器一个实例最适合生产环境。

对于开发环境，您可以做出不同的选择。但是开发环境和生产环境应该是分开的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-21T11:00:11.693

同意“每台服务器一个实例”的概念。如果您想给予某些用户优先于其他用户的待遇或确保每个应用程序获得数据库的公平部分，请查看资源管理和配置文件。

```
http://download.oracle.com/docs/cd/B19306_01/network.102/b14266/admusers.htm#i1012785

http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_2007.htm#sthref4352

http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/dbrm.htm#ADMIN027 
```

将数据保存在单独的模式（和物理级别的表空间）中应确保客户数据的适当分离。只要您不在模式之间共享表空间，使用导出和可传输表空间来提取和分离单个模式就变得（相对）微不足道，因此您可以在随后需要时在数据库（以及实例）之间移动它们他们在自己的服务器上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T00:53:17.117

可以给服务器增加内存吗？您可以花不到 1000 美元购买 32 GB 的内存。

# azure - Azure 任务计划程序

> ID：571439
> 
> 赞同：19
> 
> 时间：2009-02-20T22:13:12.193
> 
> 标签：azure, cloud, scheduling, task

虽然这个问题是 Azure 特有的，但我确信它是一般云计算的常见情况。

我有一个需要在特定时间运行的任务列表。使用窗口的服务器，我可以使用任务计划程序并安排我的程序在某个时间运行。我可以更进一步，创建一个以给定时间间隔运行的 Windows 服务，然后执行相应的任务。

有人对云计算环境的最佳方法有什么建议吗？

我可以创建一个工作角色，它每秒轮询任务列表，然后将适当的任务放入由另一个工作角色处理的队列中。

我可以创建一个每天运行一次的工作者角色，获取所有任务并将它们提交到队列中。然后，处理器角色将从队列中拉出一个项目并在适当的时间进行处理。

还有其他建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-17T18:04:37.517

您可以设置服务总线队列并将其用作调度程序。

[通过将消息上的ScheduledEnqueueTimeUtc](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.brokeredmessage.scheduledenqueuetimeutc.aspx)设置为所需时间，将消息发送到队列中，此时消息将显示在队列中。在执行工作人员/网络角色中，您在该队列上设置了一个接收器，然后在消息显示后立即获取作业，即作业到期。

这样做的好处是您可以使用它来平衡多个实例之间的作业，并且由于计时器完全在您的应用程序之外，您不必存储、恢复和管理它。SB 为您做这一切。

一个警告：SB 没有取消预定消息的功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-06T18:21:51.820

现在有几个选项可以在 Azure 上执行此操作

*   [Web 作业](http://www.windowsazure.com/en-us/documentation/articles/web-sites-create-web-jobs/)（用于 Azure 网站）
*   [调度器](http://www.windowsazure.com/en-us/services/scheduler/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T22:23:54.773

重复：推荐一个 推荐[Quartz.Net](http://quartznet.sourceforge.net/)[的 C# 任务调度库](https://stackoverflow.com/questions/507247/recommend-a-c-task-scheduling-library)。我最近参与了一个在 Windows 下成功使用它的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-12T09:06:29.900

哟可以试试这四种供品：

1.  Azure 辅助角色（云服务）
2.  Azure 调度程序服务
3.  Azure 移动服务调度程序
4.  Azure 网站 Web 作业

有关更多信息，请点击 [Azure 计划任务链接](http://mattmilner.com/Milner/Blog/post/2014/02/10/How-many-schedulers-do-we-need-in-Windows-Azure.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-12T18:56:48.537

我意识到这已经过时了，但这仍然是一个常见问题。我在我的一个 Azure VM 上使用 Windows 任务计划程序。它实施起来很简单，让您不必重新发明轮子。

[http://www.voiceoftech.com/swhitley/index.php/2011/07/windows-azure-task-scheduler/](http://www.voiceoftech.com/swhitley/index.php/2011/07/windows-azure-task-scheduler/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T23:24:50.663

您是否考虑过在 Azure 队列中使用可变的项目到期日期？

我遇到了一种新的调度方法，它也应该适用于 Azure。使用 ASP.NET 缓存项回调。[在这里](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-27T16:22:58.070

您可以[在移动服务中安排任务](http://www.windowsazure.com/en-us/develop/mobile/tutorials/schedule-backend-tasks/)。

也不错的[演示视频](http://channel9.msdn.com/Series/Windows-Azure-Mobile-Services/Windows-Store-app-Getting-Started-with-the-Windows-Azure-Mobile-Services-Scheduler)。

# c# - 在 C# 中删除文件

> ID：571457
> 
> 赞同：4
> 
> 时间：2009-02-20T22:19:29.760
> 
> 标签：c#, asp.net, file

似乎它应该是一个非常简单的话题，所有的例子都只是几行但没有像样的解释，因此我在没有解决方案的情况下一直遇到同样的错误。

简而言之，这部分应用程序像这样运行

1.  从数据库中提取图像
2.  在临时文件夹中创建实际图像文件
3.  创建包含图像的 pdf
4.  现在删除创建的图像。

一切正常，直到删除。我不断收到错误

> **InnerException：**
> System.ArgumentException：不支持 URI 格式。在 System.IO.Path.NormalizePathFast（字符串路径，布尔 fullCheck）...

我尝试了几种不同的方法来完成删除最新的内容：

```
foreach (string item in TempFilesList)
    {
        path = System.Web.HttpContext.Current.Application["baseWebDomainUrl"] + "/temp/" + item;
        fileDel = new FileInfo(path);
        fileDel.Delete();
    } 
```

之前的尝试是：

```
foreach (string item in TempFilesList)
    {
        File.Delete(System.Web.HttpContext.Current.Application["baseWebDomainUrl"] + "/temp/" + item);
    } 
```

TempFilesList 是一个数组列表，其中包含要删除的图像的路径。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-20T22:21:18.850

您应该尝试调用 Server.MapPath(path) 来获取文件的“真实”路径。将其传递给 File.Delete，它应该可以工作（假设文件权限等是正确的）

例如：

```
foreach (string item in TempFilesList)
{
    path = System.Web.HttpContext.Current.Application["baseWebDomainUrl"] + "/temp/" + item;
    path = Server.MapPath(path);
    fileDel = new FileInfo(path);
    fileDel.Delete();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-20T22:23:35.757

您需要所创建文件的实际文件路径，而不是所创建路径的 URL。您的代码创建了一个类似于“ [http://www.mywebsite.com/location/temp/filename.jpg](http://www.mywebsite.com/location/temp/filename.jpg) ”的路径。

你需要一些看起来像“C:\MyWorkingFolder\filename.jpg”的东西。

但是，我建议不要使用 Server.MapPath。由于您是在自己的代码中自己创建文件，因此您可以控制创建文件的位置。改用那个。将其作为 AppSettings 键存储在 web.config 中。

例如：

```
string basePath = ConfigurationManager.AppSettings["PdfGenerationWorkingFolder"];
foreach(string item in TempFilesList)
{
  File.Delete(basePath + item);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T00:34:29.357

对于 Windows 系统，您将使用 \ 而不是 / 来分隔路径中的文件夹。要使代码在任何平台上工作，请使用`Path.Combine`将路径放在一起的方法：

```
path = Path.Combine(Path.Combine(System.Web.HttpContext.Current.Application["baseWebDomainUrl"], "temp"), item); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T22:22:10.970

也许使用`Server.MapPath(path)`会有所帮助？

```
foreach(string item in TempFilesList)
{
  string path = String.Format("{0}/temp/{1}", HttpContext.Current.Application["baseWebDomainUrl"], item);
  File.Delete(Server.MapPath(path));
} 
```

最好使用静态`File.Delete()`而不是创建新的 FileInfo(path) 只是为了删除

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T22:32:13.597

您使用的是什么 pdf-creater-tool？您是否检查过它是否支持流作为输入参数？那么您不必将图像临时写为文件..孔问题就消失了...-顺便说一句，我投票给了 Randolphos 答案：p

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T23:04:34.737

如果您保存了图像，则必须使用文件路径来执行此操作。你不能只使用相同的文件路径来删除它们吗？这意味着您可以避免两次文件路径的任何连接。（作为旁注：您可能应该使用 Path.Combine ）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T19:44:22.540

我只会添加这个，以防你想让它撞到回收站而不是把它吹灭：

```
FileSystem.DeleteFile(file.FullName, UIOption.OnlyErrorDialogs, RecycleOption.SendToRecycleBin, Microsoft.VisualBasic.FileIO.UICancelOption.DoNothing); 
```

唯一糟糕的是在你的 C# 中你必须引用一个 VisualBasic 命名空间

```
using Microsoft.VisualBasic.FileIO; 
```

在您的情况下，您甚至可能不需要 bin，因为它在数据库中，但我想我会把它扔在那里。

# design-patterns - 将规则应用于事实的设计模式和算法

> ID：571468
> 
> 赞同：16
> 
> 时间：2009-02-20T22:22:20.547
> 
> 标签：design-patterns, rules

我正在尝试确定客户对零售环境中定价引擎的要求。我们将定价引擎定义为在一组定价规则上运行，该规则根据购物车中已有的现有商品为购买的商品建立新的价格点。

一个简单的价格规则可能是**GET A SHIRT 40% OFF**。一个更复杂的规则可能是**当您购买 2 条裤子并花费至少 30 美元时获得一件免费衬衫**。

应用这些规则的一般行业惯例似乎是对客户的最终最优价格，但已经提出可能需要有一个排名选项以及一个堆叠选项。

排名将允许否则会失败的规则获胜。堆叠将允许多个规则获胜。

我已经在 SO 上查看了许多关于规则引擎的帖子，我需要帮助确定我是否应该将这些工具之一作为我的设计的一部分，或者是否应该将哪些设计模式和算法适用于设计。

很明显，这可能是一个 NP 问题，我将处理的项目（事实）数量可能超过每笔交易 100+，每次添加新项目时都需要重新定价。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T03:06:24.327

Martin Fowler 有一篇关于规则引擎以及在何处使用它们的好文章。看看有没有帮助

[http://www.martinfowler.com/bliki/RulesEngine.html](http://www.martinfowler.com/bliki/RulesEngine.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T22:33:50.037

规则引擎非常适合。如果规则引擎是可靠的，适合您的架构/应用程序的其余部分并且是您应用程序的核心功能所需要的，那么就选择它。

如果规则引擎只是您应用程序的一小部分，或者更糟糕的是：是一些代码，与您应用程序的其余部分不同的编程语言......那么您应该重新考虑。核心应用程序外部的每个应用程序部分（甚至数据库在 Java 应用程序的外部）都是一种风险。

那么有两种可能：自己编写一个简单的规则引擎，或者使用策略或状态模式。

# .net - .NET 中的异步 TCP 通信

> ID：571469
> 
> 赞同：6
> 
> 时间：2009-02-20T22:22:44.510
> 
> 标签：.net, networking, sockets, asynchronous, tcp

这里有一个快速的问题：与 NetworkStream 类（由 TcpClient 生成）使用异步通信有什么明显的好处，即 BeginRead/BeginWrite 方法，而不是运行一个单独的线程并对其使用同步操作，即读/写？我的印象是（这很容易完全错误）异步操作是非阻塞的，并且在操作系统级别（可能在 TCP 堆栈中？）执行，并带有一个用于回调的线程池项。我认为它肯定与在同步方法上调用 ThreadPool.QueueUserWorkItem 不同，否则提供它就没有什么意义了。现在，我相当有信心这是至少在文件 I/O 中发生的那种事情（操作系统级调用），但如果有人可以澄清有关网络（TCP）通信的问题，这将是最有帮助的。基本上，我想知道这两种方法是否有任何特定的好处（除了能够将 BinaryReader/StreamReader 类与同步调用一起使用的明显好处之外）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-20T22:47:39.753

有一个区别，如果您使用 Worker 线程来调用同步版本，您将在阻塞调用中占用一个线程。

Begin 方法不会占用线程，而是在适当的 I/O 信号上使用回调，而回调将在池中的线​​程上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T22:46:24.530

正如其他人指出的那样，当您使用同步方法时，为您的进程分配另一个线程会影响您，因为您增加了同时连接的数量。

但是，如果你知道你只会有少量的连接，我会说它变成了一种清洗，你应该选择最适合你的应用程序的方法。

在线程开销可以忽略不计的情况下，我希望这两种情况会像这样上演。

**异步：**

1.  你打电话给 BeginRead / BeginWrite
2.  “系统”（框架/操作系统）被告知你想要什么
3.  读/写完成
4.  “系统”告诉线程池中的一个线程调用你的回调
5.  你做任何你需要做的事情来完成操作

**在另一个线程中同步：**

1.  你从线程池中获取一个线程来处理 IO
2.  你打电话给读/写
3.  “系统”（框架/操作系统）被告知你想要什么
4.  读/写完成
5.  你做任何你需要做的事情来完成操作

这里唯一的区别是异步调用的第 4 步变成了另一个线程情况下的同步调用的第 1 步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T00:00:20.907

我同意 AnthonyWJones 的观点，假设您的线程池有 10 个线程，但您有 100 个被动足够的客户端。使用异步调用，您可以为其中的每一个调用 BeginRead，当来自某个调用的数据准备好时，它将由池线程之一处理。但如果您尝试使用 QueueUserWorkItem，您将安排仅从 10 个客户端接收数据。如果他们在 1 小时内什么都不发送，那么其他 90 个客户端将永远没有机会获取数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T00:09:23.787

我不太确定为什么 NetworkStream 甚至有 BeginRead/Write，因为这首先基本上违反了 NetworkStream 的目的。通过使用异步方法，您可以获得更快的响应、更高的可伸缩性并减少资源消耗。

如果您一次只能有一个连接，那么是否使用线程池线程并不重要，但是如果您接受许多连接，那么您肯定要使用异步。

# objective-c - CALayer addSublayer 增加保留计数？

> ID：571477
> 
> 赞同：3
> 
> 时间：2009-02-20T22:24:41.073
> 
> 标签：objective-c, iphone, cocoa-touch

我认为当我将视图添加为这样的子视图时：

```
UIView* view = [[UIView alloc] init];
[self addSubview:view];
[view release]; 
```

之后释放视图是安全的...对于 CALayer 对象是否相同？如果我使用 alloc/init 创建一个 CALayer，然后执行以下操作：

```
[self.layer addSublayer:layer]; 
```

之后释放图层是否安全？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T00:45:54.417

是的。一般来说，如果对象 A 需要对象 B，则对象 A 有责任保留它。因此，如果“self.layer”需要“layer”，它会在 addSublayer: 期间碰撞 retainCount，并在不再需要时释放 layer。虽然有一些例外情况，但这些例外情况往往有很好的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T19:48:31.610

我同意路易斯的观点。尽管在这种情况下它并不是真正必要的，但请注意，您`retainCount:`将来可以随时使用该方法仔细检查这些内容。例如：

```
NSLog(@"Retain count before: %d", [layer retainCount]);
[self.layer addSublayer:layer];
NSLog(@"Retain count after: %d", [layer retainCount]); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-21T20:00:47.977

首先，您使用 layer 类方法而不是 alloc/init 创建一个新的 CALayer 对象。像这样：-

```
CALayer *l = [CALayer layer];
l.frame = CGRectMake(...);
l.position = CGPointMake(...);
l.anchorpoint = CGPointMake(0,0);
l.contents = (id)someCGImageRef;
[self.layer addSublayer:l]; 
```

其次，这是您可能会遇到问题的地方，因为如果您在将 CALayer 作为子层添加到视图的主层后释放它，您将遇到崩溃。或者至少我做到了，我认为这是因为 layer 类方法将该层添加到自动释放池中，所以如果你自己释放它，你会得到一个双重释放，因此即使他视图的主层仍在使用它，它也会被释放。

# sql - SQL 查询以选择每种类型中的一种

> ID：571478
> 
> 赞同：26
> 
> 时间：2009-02-20T22:24:58.543
> 
> 标签：sql

假设我有这张桌子：

id 颜色名称
1 红
2 蓝
3 红
4 蓝

如何为每种颜色选择一个代表？
结果：
1红
2蓝

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-20T22:26:46.857

不是随机代表，而是...

```
select color, min(id)
from   mytable
group by color; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-20T22:28:52.060

```
select distinct colorname from mytable 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-20T22:32:04.893

在`MS SQL Server`和`Oracle`：

```
SELECT  id, colorName
FROM    (
        SELECT  id, colorName,
                ROW_NUMBER() OVER (PARTITION BY colorName ORDER BY id) AS rn
        FROM    colors
        ) q
WHERE   rn = 1 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-20T22:27:32.983

试试这个：

```
SELECT colorName,  
MIN(id) AS id  
FROM table  
GROUP BY colorname 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-30T09:12:37.797

这是最简单的方法：

```
SELECT DISTINCT colorName FROM mytable ORDER BY colorName 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-01T10:32:14.793

SELECT DISTINCT colorname FROM yourtable ORDER BY id; *（如果需要，将 id 更改为 colorname）*

或者

从您的表中选择颜色名称 GROUP BY 颜色名称；

# web-services - 在线设置查询表单然后插入 Access 的最简单方法是什么？

> ID：571486
> 
> 赞同：0
> 
> 时间：2009-02-20T22:27:25.420
> 
> 标签：web-services, ms-access

我想尝试在网站上放置表格。然后从填写的表格中获取答案并在 Access 中查看这些答案以直接链接到数据库中。
有任何想法吗？如何创建表单、ASP、html？我知道使用 ODBC 从 ASP 到 Access 的连接可以正常工作 - 我一般需要有关该问题的更多信息.. 替代方案等。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T22:43:24.913

这是一个非常广泛的问题，但您最简单的方法是执行以下操作。

使用 Visual Web Developer Express（或完整的 Visual Studio，如果你有的话）。使用 ASP.NET 和您选择的语言创建一个 Web 应用程序。

在项目的 App_Data 文件夹中将 Access 数据库添加到网站中，根据您的具体需求，您可以从这里使用大量的拖放项来构建页面。

一些笔记。

1.  使用拖放项目非常适合快速建立网站，但不要遵循最佳实践。
2.  4guysfromrolla.com 是 ASP.NET 方面的操作指南的一个很好的参考
3.  Access 不一定是网站数据库引擎的最佳选择……但可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T00:16:54.453

不要忘记您可以在 Access 中使用参数查询并更新它，它更安全。

# python - python中的三角形数字

> ID：571488
> 
> 赞同：10
> 
> 时间：2009-02-20T22:27:36.230
> 
> 标签：python

我正在尝试解决问题：

> 第一个有超过 500 个除数的三角形数的值是多少？

*三角形数是数之和的序列中的数，即 1+2+3+4+5...*

我很确定这是有效的代码，但我不知道，因为我的计算机计算它的时间太长了。有没有人知道如何使程序更快一点。
谢谢。

```
import math

def main():
    l = []
    one = 0
    a = 1
    b = 2
    while one == 0:
        a = a + b 
        b += 1
        for x in range(1, int(a/2 + 1)):
            if a % x == 0:
                l.append(x)
                if len(l) > 499:
                    print a 

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-20T22:39:49.647

提示：

*   `n`-th 三角数的公式是什么？
*   `n`并且`n+1`没有公因数（除了`1`）。问题：给定的因子数量`n`以及`n+1`如何计算因子的数量`n*(n+1)`？`n/2`和`(n+1)`（或`n`和`(n+1)/2`）呢？
*   如果您知道`n`如何计算除数的所有主要因素`n`？

如果您不想更改算法，则可以通过以下方式使其更快：

*   替换`l.append`为`factor_count += 1`
*   枚举到`int(a**.5)`而不是`a/2`（`factor_count += 2`在这种情况下使用）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-21T06:59:57.980

您将不得不多思考并使用更少的蛮力来解决 Project Euler 问题。

在这种情况下，您应该调查三角形数有哪些和多少个除数。从头开始，寻找模式，尝试理解问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-20T22:36:25.380

您没有更新 的值`one`，因此您的程序将永远不会结束。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-21T23:42:47.927

只是为了理智，你应该使用

```
while True: 
```

并摆脱`one`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-05T22:21:32.283

首先，那些告诉你不能在一分钟内用蛮力解决这个问题的人是错误的。这种规模的问题的蛮力算法将在几秒钟内运行。

其次，您发布的代码有几个问题，其中一些已经提到。

*   `one`您应该通过设置某个值来终止循环，而不是`0`在达到目标条件（您当前的位置`print a`）之后。
*   您永远不会重新初始化列表 ( `l = []`)。这应该在您每次重新计算`a`and时完成`b`，就在您进入 for 循环之前。
*   这个问题要求第一个三角形数有**超过**500 个除数。你的终止条件应该是`if len(l) > 500:`。
*   您可能不想`print a`进入 for 循环，但要等到 while 循环完成。

真正让你慢下来的是，对于每个三角形数字`a`，你要检查每个值，`a / 2`看看它是否是一个除数。您只需要检查直到平方根的值`a`。这样，对于 的每个值`x`，如果`x`是除数，您只需将`x`和添加`a / x`到列表中即可。

这是您的代码以及我上面概述的修改：

```
import math

def main():
    l = []
    one = 0
    a = 1
    b = 2
    while one == 0:
        a = a + b 
        b += 1
        l = []

        sqrt_a = int(math.sqrt(a))

        for x in range(1, sqrt_a + 1):
            if a % x == 0:
                l.append(x)
                if x < math.sqrt(a):
                    l.append(a // x)
                if len(l) > 500:
                    # print(a)
                    one = 1

    print(a, b, len(l))

if __name__ == '__main__':
    main() 
```

您会看到它在大约 5 或 6 秒内运行，这些修改不到一分钟。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-09-29T12:38:12.030

您当前的蛮力算法效率太低，无法在 1 分钟的 Project Euler 时间限制内解决此问题。相反，我建议查看除数函数：

[http://www.artofproblemsolving.com/Wiki/index.php/Divisor_function](http://www.artofproblemsolving.com/Wiki/index.php/Divisor_function)

# jquery - jQuery 选项卡在 IE 中干扰 SimpleModal

> ID：571490
> 
> 赞同：1
> 
> 时间：2009-02-20T22:28:32.763
> 
> 标签：jquery, internet-explorer, simplemodal

我有一个页面，其中有两个使用 jQuery 创建的选项卡，并且我还使用了 Eric Martin 的 SimpleModal 插件。但是，当我在 IE7 中时，SimpleModal 覆盖看起来完全不透明，而不是我想要的 50% 不透明度。如果我删除标签，模态看起来就好了。我查看了 IE Dev Toolbar 中的叠加样式信息，它显示叠加样式为 50%，即使它没有以这种方式显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T02:13:51.957

没有更多的代码很难说。

如果可以的话，我会推荐使用[jQuery UI 对话框。](http://docs.jquery.com/UI/Dialog)它们都是由 UI 团队制作的，应该可以很好地协同工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T03:10:08.147

埃里克·马丁在这里 ;)

您有链接或任何示例代码吗？我在很多地方使用标签和 SimpleModal 并且没有遇到任何问题......

# mysql - 通过 phpmyadmin 导入 csv 或 sql 并跳过 PK？

> ID：571500
> 
> 赞同：0
> 
> 时间：2009-02-20T22:29:46.303
> 
> 标签：mysql, import, primary-key, phpmyadmin

是否可以使用 phpmyadmin 或其他工具将 csv 或 sql 备份导入现有数据库并跳过主键，或者这是手动逐表插入查询并手动删除主键的过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:25:18.987

通往罗马的方式有很多： 1 方式：

```
LOAD DATA LOCAL INFILE 'file.txt'
  INTO TABLE t1 (column1, column2, column3); 
```

其他方式：

```
CREATE TABLE `import` (
  `column1` int(11) NOT NULL,
  `column2` varchar(128) NOT NULL,
  `column3` varchar(128) NOT NULL
) ENGINE=MyISAM CHARSET=utf8;
LOAD DATA LOCAL INFILE 'file.txt'
  INTO TABLE import
  (column1, column2, column3);
INSERT INTO destination_table (columnA,columnB,columnC)
SELECT column3, column1, column2 FROM import; 
```

# audio - 分析声音

> ID：571501
> 
> 赞同：1
> 
> 时间：2009-02-20T22:29:59.220
> 
> 标签：audio

我想知道是否有人可以提供有关音频分析的指导。我正在研究的是分析波形或音高和语音。我非常愿意使用任何基于 C 的语言（C++、C#、Java），如果这不可能的话，也许是一种新语言。有人对我应该从哪里开始有任何提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T22:37:26.673

这是相当广泛的，但解决此类问题的第一件事是找出一些有用的搜索词。[例如，您可以从信号处理](http://en.wikipedia.org/wiki/Category:Signal_processing)的维基百科类别列表开始。

您可能会发现[傅立叶分析](http://en.wikipedia.org/wiki/Fourier_analysis)值得研究——这可能为学习提供了一个很好的起点。有了它，您可以学习如何从复杂的波形中提取特定的频率分量。

您可能还想查看 Stack Overflow 上的其他问题

*   [音频编程入门](https://stackoverflow.com/questions/553646/getting-started-with-audio-programming)
*   [我应该使用哪种算法进行信号（声音）分类？](https://stackoverflow.com/questions/441438/which-algorithm-should-i-use-for-signal-sound-one-class-classification)
*   [给定一个音频流，找出门何时关上（声压级计算？）](https://stackoverflow.com/questions/499795/given-an-audio-stream-find-when-a-door-slams-sound-pressure-level-calculation)
*   [检测基频](https://stackoverflow.com/questions/435533/detecting-the-fundamental-frequency)
*   [**任何带有信号处理标签的东西**](https://stackoverflow.com/questions/tagged/signal-processing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T00:57:31.237

您可以[在此处](http://www.fftw.org/)查找与 C（和 C++）接口的 FFT 库。AFIK 也有许多其他人的语言绑定。

我建议，既然你问了这个问题，你就知道关于 DSP 的 SFA 并且应该从一些基本的阅读开始。在您能够编写音频处理器（即使使用可用的工具）之前，您需要收集很多知识。Paul 提供了一些指向 SO 的链接，但请访问搜索引擎并查看。

我听起来像个彻头彻尾的混蛋，但是如果没有数学支持，您就会陷入困境，并可能开始得到看起来不错但非常不准确的结果。

我推荐[Matlab](http://www.mathworks.com/products/matlab/)作为起点，因为它包含所有 FFT 代码以及慢速 DFT 代码。您将能够轻松地绘制结果图表并动态更改参数。您甚至应该能够通过拥有良好的参考资料并将代码输入 Matlab 来学习数学基础。有一个 15 天的试用期，最后我检查了（很久以前读博士时）学生版非常便宜。

# javascript - 有什么方法可以阻止 Firefox 在 Javascript 错误时提交表单？也许在 about:config?

> ID：571502
> 
> 赞同：1
> 
> 时间：2009-02-20T22:30:16.737
> 
> 标签：javascript, firefox, forms, firefox-3

有什么方法可以阻止 Firefox 在 Javascript 错误时提交表单？

我的意思是我知道我可以使用警报框或萤火虫来阻止它这样做，但是……并非所有人们使用的页面都使用萤火虫，而且那个警报框很烦人……

也许about：config中有一个设置？我可以玩弄吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T09:42:45.950

创建一个返回 true（无错误）或 false（一些错误）的函数。将提交处理程序添加到您的表单：

```
<form [..] onsubmit = "return yourFormCheckfunction();"> 
```

现在，如果 'yourFormCheckfunction' 返回 false，则您的表单未提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T23:16:32.960

使用 Javascript 提交表单。这样，如果脚本失败，它永远不会到达提交表单的行。

# javascript - javascript中的端口监听

> ID：571507
> 
> 赞同：3
> 
> 时间：2009-02-20T22:32:02.990
> 
> 标签：javascript, ajax, comet, ports, reverse-ajax

我正在尝试用 javascript 编写一些简单的聊天客户端，但我需要一种实时更新消息的方法。虽然我可以使用 xmlhttprequest 函数，但我相信它会占用服务器上的 TCP/IP 端口，而且可能更重要的是，它在我当前的托管包中是不允许的。无论如何，这似乎不是一个理想的解决方案，因为不断地打开连接似乎有点笨拙，如果我可以只在端口上监听并获取数据会容易得多。我在互联网上查看了很多关于彗星和连续轮询的参考资料，这些都不能令人满意，而且很多人说 javascript 并不真正适合它，我可以同意。现在我实际上已经了解了更多关于互联网的工作原理，但是，这似乎是可行的。到目前为止，我不需要担心发送消息；

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T22:39:01.443

在 Javascript 中无法监听端口。

但：

XmlHTTPRequest 在您的主机上是可能的，因为它是对特殊站点的简单 HTTP 请求，例如`chat.php?userid=12&action=poll&lasttime=31251`服务器打印自上次以来的所有新消息作为结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T22:38:37.233

您将需要一个可以加载到 Javascript 上下文中的第三方库。

Javascript 本身无法做到这一点，而且您不太可能（当然也不应该）在浏览器中做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T23:29:50.760

看看[彗星](http://en.wikipedia.org/wiki/Comet_(programming))

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-02-20T22:44:49.870

您是否考虑过在 Flex 中构建您的应用程序？你可以利用 Flex 的[XMLSocket](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/XMLSocket.html)类来实现一个低延迟的聊天客户端——几乎就是它的设计初衷

# c# - .net 紧凑框架访问音频元数据

> ID：571512
> 
> 赞同：0
> 
> 时间：2009-02-20T22:33:43.063
> 
> 标签：c#, .net, compact-framework

是否存在任何用于使用 .net 紧凑框架访问音频（mp3 wmw）元数据的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T22:41:17.490

你看过[OpenNETCF](http://www.opennetcf.com)：[http](http://www.opennetcf.com/library/sdf/html/f3fc3169-4143-54bc-1594-186da1fb01c2.htm) ://www.opennetcf.com/library/sdf/html/f3fc3169-4143-54bc-1594-186da1fb01c2.htm吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T22:41:54.120

或者[http://home.fuse.net/honnert/hundred/?UltraID3Lib](http://home.fuse.net/honnert/hundred/?UltraID3Lib)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T22:46:30.943

[BeyondPod](http://www.codeplex.com/beyondpod)是一个支持 mp3 播客的开源 RSS 阅读器。下载源代码，您将找到用于读取 mp3 ID3 标签的代码。

# python - Python中有声明关键字吗？

> ID：571514
> 
> 赞同：11
> 
> 时间：2009-02-20T22:34:34.903
> 
> 标签：python, variables

python中是否有任何声明关键字，如本地、全局、私有、公共等。我知道它是免费的，但你怎么知道这个语句：

```
x = 5; 
```

*   创建一个新变量。

或者

*   设置一个现有的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-21T00:21:28.903

我真的很喜欢 Van Gale 提供的理解，但它并没有真正回答“你怎么知道这个语句是创建一个新变量还是设置一个现有变量？”的问题？

如果您想知道在查看代码时如何识别它，您只需查找以前的作业。避免使用全局变量，无论如何这都是一种很好的做法，您将万事俱备。

以编程方式，您可以尝试引用该变量，并查看是否收到“名称错误”异常

```
try:
    x
except NameError:
    # x doesn't exist, do something
else:
    # x exists, do something else 
```

我从来不需要这样做......我怀疑你是否真的需要这样做。

## 肥皂盒警报！

尽管对于习惯于一遍又一遍地键入类名（或类型）的人来说，Python 看起来有点松散……它实际上就像你想要的那样严格。

如果你想要严格的类型，你会明确地这样做：

```
assert(isinstance(variable, type)) 
```

装饰器的存在以一种非常方便的方式进行函数调用......

不久之后，您可能会得出这样的结论：静态类型检查（在编译时）实际上并没有使您的代码变得更好。对于必须在整个地方拥有冗余类型信息的成本只有很小的好处。

我目前正在使用 actionscript，并输入以下内容：

```
var win:ThingPicker = PopUpManager.createPopUp(fEmotionsButton, 
       ThingPicker, false) as ThingPicker; 
```

在 python 中看起来像：

```
win = createPopup(parent, ThingPicker) 
```

而且我可以看到，查看动作脚本代码，静态类型检查根本没有任何好处。变量的生命周期是如此之短，以至于我必须完全喝醉才能用它做错事......并让编译器通过指出类型错误来拯救我。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-20T22:46:25.513

要了解 Python 的重要一点是没有变量，只有“名称”。

在您的示例中，您有一个对象“5”，并且您正在创建一个引用对象“5”的名称“x”。

如果以后你这样做：

```
x = "Some string" 
```

这仍然是完全有效的。名称“x”现在指向对象“Some string”。

这不是类型冲突，因为名称本身没有类型，只有对象。

如果你尝试 x = 5 + "Some string" 你会得到一个类型错误，因为你不能添加两个不兼容的类型。

换句话说，它不是免费的。Python 对象是强类型的。

以下是关于 Python 类型的一些非常好的讨论：

*   [强类型与强测试](http://mindview.net/WebLog/log-0025)
*   [打字：强与弱，静态与动态](http://www.artima.com/weblogs/viewpost.jsp?thread=7590)

**编辑**：要完成与您的问题的联系，名称可以引用现有对象或新对象。

```
# Create a new int object
>>> x = 500
# Another name to same object
>>> y = x
# Create another new int object    
>>> x = 600
# y still references original object
>>> print y
500
# This doesn't update x, it creates a new object and x becomes
# a reference to the new int object (which is int because that
# is the defined result of adding to int objects).
>>> x = x + y
>>> print x
1100
# Make original int object 500 go away
>>> del y 
```

**编辑2 ：** [Python数据模型](http://docs.python.org/reference/datamodel.html)的官方文档中对可变对象（可以更改）和不可变对象（不能更改）之间区别的最完整讨论。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-20T23:09:54.460

值得一提的是，这里有一个 global 关键字，所以如果要引用全局 x：

```
x = 4
def foo():
    x = 7 # x is local to your function 
```

你需要这样做：

```
x = 4
def foo():
    global x # let python know you want to use the top-level x
    x = 7 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-20T22:53:07.447

看起来提问者并没有试图分配一个类型，只是为了指定这是一个声明，而不是一个赋值。

看起来你正在寻找类似 javascript 的东西：

```
var x = 5; 
```

javascript 中声明关键字的概念是确保您在当前范围内创建一个新对象，而不是简单地更改一些其他同名变量。

Python 没有**这个**特性。程序员必须确保他或她没有重新分配预先存在的名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-21T19:04:35.400

我刚刚意识到还有一个更直接的答案：

```
x = 5

def test():
    print 'x' in globals()

if __name__ == "__main__":
    test() 
```

因此，如果 globals() 中的 'variablename'：该语句是一个赋值，否则该语句是一个声明

# python - 在 Python 的全局范围内提供一些默认方法的原因是什么？

> ID：571522
> 
> 赞同：1
> 
> 时间：2009-02-20T22:37:44.647
> 
> 标签：python, function

在全局范围内提供一些默认方法（例如 len 函数）而不是在实例级别提供它们的原因是什么，例如：

```
list.len() 
```

代替：

```
len (list) 
```

我发现像 len 这样的方法比实例方法更难发现。

这背后有什么原因吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T23:21:22.607

[这个问题与这个](https://stackoverflow.com/questions/83983/why-isnt-the-len-function-inherited-by-dictionaries-and-lists-in-python)问题非常相似。答案是一样的：

因为 Python 的创建者 Guido van Rossum 认为前缀表示法在某些情况下更具可读性。[这](http://mail.python.org/pipermail/python-3000/2006-November/004643.html)是完整的答案。我将引用一些部分：

> (a) 对于某些运算，前缀符号比后缀读起来更好——前缀（和中缀！）运算在数学中有着悠久的传统，它喜欢视觉帮助数学家思考问题的符号。比较我们将 x*(a+b) 这样的公式重写为 x *a + x* b 的简单性与使用原始 OO 表示法做同样事情的笨拙。
> 
> (b) 当我读到 len(x) 的代码时，我*知道*它是在询问某物的长度。这告诉我两件事：结果是一个整数，而参数是某种容器。相反，当我阅读 x.len() 时，我必须已经知道 x 是某种实现接口或继承自具有标准 len() 的类的容器。当一个没有实现映射的类有一个 get() 或 keys() 方法，或者不是文件的东西有一个 write() 方法时，我们偶尔会感到困惑。
> 
> 以另一种方式说同样的话，我将 'len' 视为内置 *操作*。我不想失去那个。我不能肯定你是否是这个意思，但 'def len(self): ...' 听起来你肯定想把它降级为普通方法。我对此强烈支持-1。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T23:17:55.483

[此常见问题解答条目](http://www.python.org/doc/faq/general/#why-does-python-use-methods-for-some-functionality-e-g-list-index-but-functions-for-other-e-g-len-list)可能会回答您的问题：

> 4.7 为什么 Python 对某些功能使用方法（例如 list.index()）而对其他功能使用函数（例如 len(list)）？
> 
> 主要原因是历史。函数用于那些对一组类型是通用的操作，并且这些操作甚至适用于根本没有方法的对象（例如元组）。当您使用 Python 的功能特性（map()、apply() 等）时，拥有一个可以轻松应用于无定形对象集合的函数也很方便。
> 
> 事实上，将 len()、max()、min() 实现为内置函数实际上比将它们实现为每种类型的方法所需的代码更少。人们可以对个别案例争论不休，但它是 Python 的一部分，现在做出如此根本的改变为时已晚。必须保留这些功能以避免大量代码损坏。
> 
> 请注意，对于字符串操作，Python 已从外部函数（字符串模块）转移到方法。但是， len() 仍然是一个函数。

[在 docs 中](http://docs.python.org/library/functions.html)有一个所有这些函数的列表（不是太多）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T22:48:28.817

一旦你学会了“len”方法，你就知道你可以将它应用于任何序列。您不必阅读遇到的每个序列的文档以了解它是否具有 len 方法。有一种期望。

[内置函数并不难发现，因为在python 文档](http://docs.python.org/library/functions.html)中有一个内置方法列表。[您可以从此页面](http://docs.python.org/library/functions.html)一次性学习它们，而不必在类库 Java 风格中到处寻找它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T23:23:03.147

除了 MrTopf 提供的常见问题解答之外，列表（和其他对象）确实有一个长度方法**__len__()**

len() 函数只是调用该方法的简写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T01:53:36.327

它们是相当容易发现的：

```
>>> import __builtin__
>>> dir(__builtin__)
['ArithmeticError', 'AssertionError', ...
... 
```

或更好

```
>>> help(__builtin__)

Help on built-in module __builtin__:

NAME
    __builtin__ - Built-in functions, exceptions, and other objects.
... 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-20T22:47:28.133

你可以写

```
re.match(r"\w+", "dog") 
```

代替

```
pattern = re.compile(r"\w+")
pattern.match("dog") 
```

就像你注意到的那样，有时它没有意义。

# wxwidgets - 基本 wxWidgets 计时器

> ID：571523
> 
> 赞同：4
> 
> 时间：2009-02-20T22:38:31.430
> 
> 标签：wxwidgets, timer

作为 wxWidgets 的新手，我需要一些示例代码来说明如何让 wxTimer 正常工作。

[该参考](http://docs.wxwidgets.org/stable/wx_wxtimer.html)提供了 3 种使用方法，但不包括其中任何一种的示例代码。最理想的是，我想让方法 2 工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-21T01:57:16.927

（来自样本/小部件/gauge.cpp :)

设置你的事件常量

```
enum
{ 
    GaugePage_Reset = wxID_HIGHEST,
    GaugePage_Progress, 
```

将事件连接到您的成员函数（使用您的事件常量）

```
EVT_TIMER(GaugePage_Timer, GaugeWidgetsPage::OnProgressTimer) 
```

然后你需要创建并启动你的计时器..

```
static const int INTERVAL = 300; // milliseconds
m_timer = new wxTimer(this, GaugePage_Timer);
m_timer->Start(INTERVAL); 
```

在文档中，我认为要理解的第二种方法是您的主窗口对象 ISA wxEventHandler，因此当您创建计时器时，计时器会将其自身连接到“this”（您的窗口）。现在事件正在进入您的窗口，EVT_TIMER 可能是将其连接到您的 OnProgressTimer 函数的最有效方法。

您也需要调用该函数...

```
void GaugeWidgetsPage::OnProgressTimer(wxTimerEvent& event)
{ 
```

应该不会比这更困难。

# python - `%` 运算符

> ID：571538
> 
> 赞同：0
> 
> 时间：2009-02-20T22:43:06.317
> 
> 标签：python, math

我想找到可以被 1 到 5 之间的所有数字整除的所有数字。我该如何编写程序，以便如果“start”的余数除以 x 经过的所有数字等于 0，它将打印 start . 是否有任何语法可以计算我要查找的内容。谢谢。

导入数学

```
def main():
    one = 1
    start = 1
    while one == 1:
        for x in range(1, 5):
            if start % x == 0:
                print start

            start += 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T23:27:58.317

首先，您似乎要求所有 60 的倍数。这些可以像这样轻松渲染（注意，这是一个无限循环）：

```
from itertools import count

for i in count():
    print i*60 
```

如果您只是过度简化了您的示例，那么这是您所写内容的更 Pythonic（和正确）的解决方案（再次是无限循环）：

```
from itertools import count

# put any test you like in this function
def test(number):
    return all((number % i) == 0 for i in range(1,6))

my_numbers = (number for number in count() if test(number))

for number in my_numbers:
    print number 
```

您的原始代码中有一个严重的错误：`range(1,5)`equals `[1, 2, 3, 4]`，因此它不会测试一个数字是否可被 5 整除！

PS：您以前使用过这种疯狂的`one = 1`结构，我们向您展示了如何以更好的方式对其进行编码。请从我们的回答中学习！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:13:19.537

如果我理解正确你想要这样的东西：

```
start = 1
while (True):
    flgEvenlyDiv = True
    for x in range(1, 5):
            if (start % x != 0):
                    flgEvenlyDiv = False
                    break

    if (flgEvenlyDiv == True):
                    print start
    start += 1 
```

# c# - 为希望在 JSP+Tomcat 中构建的 ASP.NET/C# 开发人员预订推荐书？

> ID：571565
> 
> 赞同：2
> 
> 时间：2009-02-20T22:55:48.893
> 
> 标签：c#, java, asp.net, jsp, tomcat

我是一名资深的 C# 开发人员，习惯于 ASP.NET 和 IIS，但有一个项目出现，我需要使用 Java/JSP 和 Tomcat，这对我来说都是新的。我有一点 Java 方面的经验，但没有 Tomcat 或 JSP 方面的经验，所以我正在寻找一本书（或多本书），以帮助我快速上手并运行 JSP 和 Tomcat。（顺便说一下，这个项目很小——只是一个五页/十页的 CRUD 应用程序。）

目前正在考虑的两个：

*   [开始 JSP、JSF 和 Tomcat Web 开发](https://rads.stackoverflow.com/amzn/click/com/1590599047)（Apress）
*   [Head First Servlet 和 JSP](https://rads.stackoverflow.com/amzn/click/com/0596005407) (O'Reilly)

以前有人做过这种特殊的过渡吗？如果是这样，您会推荐哪些书籍作为快速入门和运行的速成课程？

提前谢谢了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T23:05:13.207

嗯，从整体的“相似性”感觉来看，JSF 比原始 JSP 更接近 ASP.NET 组件模型。

因此，如果您“盲目地”接触到 JSP，您将会对您将从该平台获得什么样的“原始功能”感到震惊。

现在，如果您对原始 HTTP 请求周期感到满意，那么任何（体面的）JSP/Servlet 书籍都可能适合。

我喜欢Head First的书，我认为它们非常好。

但是，你可以去这里：

[免费的 JSP 书籍](http://www.theserverside.com/tt/books/addisonwesley/ServletsJSP/index.tss)

这是一本相当现代的书。（您可能需要注册才能获得这本书。）

恕我直言，对于一本 JSP 书籍，要寻找的关键是对 JSTL 的可靠覆盖，理想情况下，是对 JSP 2.0 标记文件的良好覆盖。

许多书籍仍然停留在 1999 年的 JSP 世界中，而且比这要好很多。

但是，JSP 不等同于 ASP.NET，JSF 更像。

我对 JSF 没有意见，我不使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:10:17.843

[Tomcat：权威指南](http://oreilly.com/catalog/9780596003180/)

[JavaServer Pages，第二版](http://oreilly.com/catalog/9780596003173/)

# c# - 异步 I/O 中未捕获的异常在哪里？

> ID：571566
> 
> 赞同：2
> 
> 时间：2009-02-20T22:55:53.573
> 
> 标签：c#, exception

我正在开发一个基于控制台的 .NET 应用程序（使用单声道）。我正在使用异步 I/O (Begin/EndReceive)。

我处于回调链的中间几层深，如果抛出异常，它不会被困在任何地方（让它冒泡到控制台是我所期望的，因为目前没有异常处理）。

但是，当我在它发生的地方记录它时查看堆栈跟踪，堆栈并没有显示它回到了初始执行点。

我已经尝试过 AppDomain.UnhandledException 技巧，但这在这种情况下不起作用。

```
System.ArgumentOutOfRangeException: Argument is out of range.
Parameter name: size
  at System.Net.Sockets.Socket.BeginReceive (System.Byte[] buffer, Int32 offset, Int32 size, SocketFlags socket_flags, System.AsyncCallback callback, System.Object state) [0x00000] 
  at MyClass+State.BeginReceive () [0x00000] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T23:03:24.553

*我相信在调用EndAction*方法（在您的情况下为 EndReceive）*时*应该抛出异步调用期间产生的任何错误。至少，这是我在使用 CLR (MSFT) 实现时所经历的，并且 Mono 应该做同样的事情，尽管它*可能*在这里可能有点错误（但认为这不太可能）。如果您在 Visual Studio 中，我建议您打开捕获所有异常的选项（i）在“调试”>“异常”菜单中）-也许在您使用的任何 IDE 中都有类似的选项？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:19:08.320

从堆栈的外观来看，异常是在 BeginReceive 中引发的，因此根本不会启动特定的 I/O 操作。

线程池线程上未处理异常的默认行为（自 CLR2.0 起）是终止进程，因此，如果您没有看到这一点，则说明有异常正在捕获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T01:42:54.233

使用 Microsoft 的 .NET 通常在异步调用期间抛出的大多数异常都是在异步回调方法中引发的，除了少数情况。为了处理剩下的事情，我通常设置一个超时回调方法。

# sharepoint - 好的开始 CAML 教程？

> ID：571567
> 
> 赞同：4
> 
> 时间：2009-02-20T22:57:02.507
> 
> 标签：sharepoint, sharepoint-2007, caml

现在我正在尝试在 SharePoint 中使用 CAML，最好的起点是哪里？MSDN 内容并没有给我留下深刻印象，因为它有点神秘，尽管 Wikipedia 条目对于开始来说相当不错。想法？谢谢！

编辑：下面的每个人都有很好的链接，但是我只能选择一个答案......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T23:08:10.110

对我来说，最好的学习方法是下载一些查询工具，这样我就可以在我的开发服务器上实时使用语法。这里有两个我觉得很不错的。

[http://www.codeplex.com/SPCamlViewer](http://www.codeplex.com/SPCamlViewer)

[http://www.u2u.be/res/Tools/CamlQueryBuilder.aspx](http://www.u2u.be/res/Tools/CamlQueryBuilder.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T23:12:15.187

[这是](http://sharepointmagazine.net/technical/development/writing-caml-queries-for-retrieving-list-items-from-a-sharepoint-list)使用 CAML 查询列表的不错介绍。我对 U2U 的查询生成器工具的上述建议表示赞同，它对于快速编写查询是相当不可或缺的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T08:23:29.330

我也用过[a2zdotnet](http://a2zdotnet.com/View.aspx?id=90b)

# c++ - 有没有办法在每个编译单元中包含一个头文件而不修改每个源文件？

> ID：571568
> 
> 赞同：3
> 
> 时间：2009-02-20T22:57:06.847
> 
> 标签：c++, gcc, g++, include

鉴于以下情况：

*   包含数千个 C++ 源文件的大型项目
*   没有通用头文件（没有一个头文件包含在每个源文件中）
*   所述项目是用 g++ 编译并由 make 管理的

有没有办法在每个编译单元中包含一个定义（例如宏）而不修改每个源文件以包含一个新的头文件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-20T23:02:58.517

来自 man gcc：

> *-包含文件*
> 
> 处理文件，好像“#include”file“”作为主要源文件的第一行出现。但是，搜索文件的第一个目录是预处理器的工作目录，而不是包含主源文件的目录。如果在此处未找到，则正常在“#include”...“”搜索链的其余部分中进行搜索。如果给出了多个 -include 选项，则文件将按照它们在命令行中出现的顺序被包含在内。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-20T23:02:41.310

您可以使用“-D”gcc 命令行选项来执行此操作。

例子：`gcc -ansi -Wall -Dblah='mymacrohere()' blah.cpp`

另请参阅：[GCC 手册、命令行选项、预处理器选项](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Preprocessor-Options.html#Preprocessor-Options)

# version-control - 您是否将非代码文件（例如 DLL、图像和 flv）放入版本控制中？

> ID：571569
> 
> 赞同：2
> 
> 时间：2009-02-20T22:57:45.750
> 
> 标签：version-control

好吧，相对而言，它们不会经常更改，但积极的一面是您可以查看一个网站并期望它在您的本地计算机上运行并看起来正常。

你做什么工作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-20T23:03:37.047

我将所有“原始资料”放入版本控制中，包括图像、外部 jars/库和其他用作输入或资源的数据文件。

我不会将任何生成的工件放入版本控制中。也就是说，构建生成的任何东西都被认为是“忽略的”或“私有的”——不受源代码控制。

一般来说，我觉得其他开发人员应该能够签出项目并执行一键（或一键）构建以生成产品的工作实例。这样做之后，开发人员的视图不应包含任何带有版本控制源的增量。

即构建应该能够在代码的“锁定”版本上完成，而不需要执行任何检查等，也不需要获取任何额外的外部依赖项（一般来说）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T23:01:19.970

是的。我们定期将外部依赖项和构建所需的任何其他内容置于源代码控制之下。通过这种方式，我们确保一台干净的机器可以加入源代码并从 sctratch 构建，而无需有人在其上手动安装东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T23:25:26.963

是的，主要是。

我离开源代码控制的唯一文件是网站“内容”，主要涵盖网站用户上传的图像和文档。构成网站“外观”的图像（通常在母版页上，或通过 CSS 加载）进入源代码管理。

编译站点所需的 DLL 和其他项目（或站点功能所需的，例如 javascript）肯定包括在内。开发人员应该能够从源代码管理中检查网站并拥有工作网站所需的一切。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T23:01:24.620

一般是的。您应该能够从源代码管理中获取项目并在没有进一步干预的情况下在与构建环境的其余部分断开连接的干净机器上构建它。

对于很少更改的文件或一般的二进制文件，您的源代码控制提供程序可能会提供一些选项，例如“存储每个修订版的整个文件” - 此设置可防止源代码控制程序在您签入新版本时尝试计算差异（这适用于 ASCII 文件，但不适用于二进制文件）。

另一方面，如果有一个网络驱动器或类似的东西总是可用于构建您的项目的所有机器，您可以引用该远程资源（无论是真正的驱动器，甚至是图像的 URL）只要您确保对该远程系统上的备份过程感到满意。

源代码控制提供了两个重要功能：开发人员之间的源代码共享和源代码备份 - 很多人忘记了第二个功能，直到为时已晚 :) 我自己之前也包括过一次。吸取了我的教训！哈哈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T23:07:38.257

是的，我们甚至将用于构建产品的工具置于源代码控制中。

一次同步，你的盒子里就有了构建产品所需的一切。如果不这样做，您将引入一些不确定性 - 不手动更新未签入依赖项的开发人员将浪费时间在他们的测试机器上跟踪错误配置问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T23:33:36.400

还有[一个](http://www.codinghorror.com/blog/archives/000743.html) [论点](https://stackoverflow.com/questions/115369/do-you-source-control-your-databases)是将数据库转储放入版本/源代码控制中。

特别是如果数据库的模式在开发过程中不断发展。（我知道，那完全是另一个话题）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T23:12:14.483

是的，我们有。

您应该能够从源代码控制中获取项目，并拥有构建所需的一切，而无需费力。

没有什么比浪费时间试图找到成功构建的依赖项更糟糕的了。:(

# php - php regex：如何匹配此注册表路径？

> ID：571571
> 
> 赞同：0
> 
> 时间：2009-02-20T22:58:12.770
> 
> 标签：php, regex, pcre

我对正则表达式不是很好，而且我对这个有点摸不着头脑。我使用 preg_match 得到了以下 php 代码，它应该匹配注册表路径中的所有字符，除了记录号......在这种情况下是“记录？？]”：

```
<?php 
$reg_section = "[HKEY_LOCAL_MACHIN\SOFTWARE\INTERSTAR TECHNOLOGIES\XMEDIUS\CONFIG MANAGER\SYSTEM\COMPANIES\RECORD11]";

$pattern = "/^(\[HKEY_LOCAL_MACHIN\\\SOFTWARE\\\INTERSTAR TECHNOLOGIES\\\XMEDIUS\\\CONFIG MANAGER\\\SYSTEM\\\COMPANIES\\\RECORD(\d+)\])$/";
if ( preg_match($pattern, $reg_section )) { 

echo "Found"; 
} else { 

echo "not found"; 
}

?> 
```

我得到的错误是：

`Parse error: syntax error, unexpected T_IF in C:\Inetpub\wwwroot\xfax\regmatch.php on line`5

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T23:00:11.707

你也必须逃避`[`：

```
/^\[HKEY_LOCAL_MACHIN\\SOFTWARE\\INTERSTAR TECHNOLOGIES\\XMEDIUS\\CONFIG MANAGER\\SYSTEM\\COMPANIES\\RECORD(\d+)]$/ 
```

否则它标志着一个字符类的开始。

这有效：

```
$subject = "[HKEY_LOCAL_MACHIN\\SOFTWARE\\INTERSTAR TECHNOLOGIES\\XMEDIUS\\CONFIG MANAGER\\SYSTEM\\COMPANIES\\RECORD11]";
$pattern = "/^\\[HKEY_LOCAL_MACHIN\\\\SOFTWARE\\\\INTERSTAR TECHNOLOGIES\\\\XMEDIUS\\\\CONFIG MANAGER\\\\SYSTEM\\\\COMPANIES\\\\RECORD\\d+\\]$/";
var_dump(preg_match($pattern, $subject)); 
```

# linux - 如何在 linux 中使用 find 打印与我的文本匹配的行？

> ID：571572
> 
> 赞同：6
> 
> 时间：2009-02-20T22:59:35.607
> 
> 标签：linux, find, printing

您好，我正在使用此命令在 linux 的文件中查找文本

```
find ./ -type f -exec grep -l "Text To Find" {} \; 
```

该命令工作正常，但我想自动打印包含文本的行，或者如果可能的话，文本上方的前两行和文本后面的两行。

此外，欢迎提出另一种查找文本和打印行而不是使用**find**的建议，

提前非常感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-20T23:04:38.013

```
find ./ -type f -exec grep -Hn "Text To Find" {} \; 
```

使用 -A 和 -B 标志来打印匹配前后的行：

```
find ./ -type f -exec grep -Hn -A1 -B1 "Text To Find" {} \; 
```

你也可以只使用grep：

```
grep -R -Hn -A1 -B1 "Text To Find" * 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T23:04:50.447

为什么不只是grep？

```
grep -r -C2 "Text To Find" * 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T23:15:29.733

您可以使用以下替代`find`结构进行更快的搜索：

```
find . -type f -print0 | xargs -0 grep -Hn -C2 "Text To Find" 
```

`grep`它不会为每个文件调用（这就是这样`-exec ... {}`做的），而是`grep`为一堆文件调用。

请注意，`-print0`,`-0`和`-C2`选项不可移植（可以与`find`,`xargs`和`grep`程序的 GNU 变体一起正常工作，即大多数 Linux、BSD 等安装以及 Cygwin 和 MinGW，但不要指望它们能与“较旧的”Solaris 一起工作， HPUX 等安装。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T23:08:12.357

要打印这些行（使用包含它的文件）：

> `find . -type f -exec grep "text" {} /dev/null \;`

要查看匹配的行后面的 2 行，请在`-A2`上一行中的“grep”之后添加，`-B2`对于之前的两行，以及`-C2`两者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T23:08:48.813

```
find ./ -type f -exec egrep -H -B 2 -A 2 "Text" '{}' ';' 
```

# php - 如何在 htaccess 中写这个

> ID：571574
> 
> 赞同：0
> 
> 时间：2009-02-20T22:59:42.160
> 
> 标签：php, .htaccess

我正在使用godaddy，我想做的是当有人输入域地址时，我希望它自动重定向到文件夹，而不是将文件放在根目录上，这样它就更有条理了。

我如何在 .htaccess 中写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:07:55.613

```
RewriteEngine on
RewriteRule (.*) subfolder/$1 [L] 
```

需要 L 以便如果有其​​他规则它们不会被执行（想想无限循环）；这是一个包罗万象的写法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T23:20:56.477

您是仅将 GoDaddy 用于您的 DNS，还是也用于您的网络托管？他们的经济计划不允许您托管多个网站 ( [http://www.godaddy.com/gdshop/hosting/shared.asp?ci=9009](http://www.godaddy.com/gdshop/hosting/shared.asp?ci=9009) )

GoDaddy 有一个不错的在线帮助，你应该看看：[http ://help.godaddy.com/article/4688](http://help.godaddy.com/article/4688)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T16:24:46.627

**简单重写**

除非存在条件，否则 Rewrite 不会做任何事情。这是一个在没有指定子文件夹中实际工作的代码。例如[http://domain.com](http://domain.com)将被重定向到[http://domain.com/subfolder/somefile](http://domain.com/subfolder/somefile)

您也可以将其指向子文件夹而不是文件，只需删除 somefile.php 和您的设置。记得更改“DOMAIN”和“SUBFOLDER”的值

```
#Turns the engines on!
rewriteEngine on
# Checks Condition, "Does it have a subfolder specified?"
rewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
# Does its Rewrite Magic
rewriteRule ^$ http://%{HTTP_HOST}/subfolder/somefile.php [R,L] 
```

# nhibernate - 基于唯一非主键插入/选择记录的 NHibernate 映射

> ID：571584
> 
> 赞同：0
> 
> 时间：2009-02-20T23:01:54.277
> 
> 标签：nhibernate

我有这些表：

创建表品牌（ID int identity(1,1), Name varchar(100) not null unique, primary key clustered (ID)）

创建表产品（ID int identity(1,1)，Name varchar(100) not null，BrandID int not null 引用 Brand(ID)）

我在 c# 中有各自的实体，即 Brand 实体有一个 int ID 和 string Name，而 Product 实体有 int ID、string Name、Brand Brand。

如何定义映射，以便在创建新产品模型、设置其名称并为其名称设置新品牌模型时，当我调用 ISession.SaveOrUpdate 时，它​​将首先使用品牌名称检查该记录是否存在? 如果我将 Brand 上的 ID 设置为身份，即使名称已经存在，它也会尝试插入记录，因为我没有明确检查记录的存在。如果我将名称设置为身份，那么它认为不需要第一次插入。我可以事先明确检查品牌是否存在，但我一直在寻找可以自动执行此操作的映射。可以让我指定品牌的身份应该通过其名称来验证，但 0 ID 表示它是新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T23:22:21.217

这不能通过映射来完成，因为它不是映射问题。

# vb.net - 如何简化这个数独代码？

> ID：571601
> 
> 赞同：1
> 
> 时间：2009-02-20T23:07:15.650
> 
> 标签：vb.net, math

SquareExp2 可以是 9 或 16

正方形可以是 3 或 4

gridbox 和 gridbox1 数组的长度可以是 0 到 80 或 0 到 255

（你现在看到模式了）

此代码仅在程序开始时运行一次。

```
 For j = 0 To squareExp2 - 1
     For i = 0 To squareExp2 - 1
         box = (j * squareExp2) + i

         gridbox(box) = ((j \ Square) * squareExp2 * Square) + ((j Mod Square) * Square) + (i \ Square) * squareExp2 + (i Mod Square)
         gridbox1(gridbox(box)) = ((j \ Square) * squareExp2 * Square) + (((j Mod Square) * Square) * Square)
     Next
 Next 
```

上面代码的目标是将代码从

```
 k = (gridRow(pos) \ iSquare) * iSquare
    l = (gridCol(pos) \ iSquare) * iSquare

    For i = l To l + iSquare - 1
        For j = k To k + iSquare - 1
            box = (j * squareExp2) + i
            foundNumber(grid(box)) = grid(box)
        Next
    Next 
```

到

```
 j = myGridbox1(i)
   For x = j To j + squareExp2 - 1
       foundNumber(grid(myGridbox(x))) = grid(myGridbox(x))
   Next 
```

*** 编辑 ***

到底

```
 Dim Square2 As Integer = iSquare * iSquare
            Dim Square3 As Integer = Square2 * iSquare
            Dim Square4 As Integer = Square2 * Square2

            Dim j2_offset As Integer = 0
            For j2 As Integer = 0 To iSquare - 1
                Dim j1_offset As Integer = 0
                Dim j1_interleaved_offset As Integer = 0
                For j1 As Integer = 0 To iSquare - 1
                    Dim i2_offset As Integer = 0
                    Dim i2_interleaved_offset As Integer = 0
                    Dim j_offset_value As Integer = j2_offset + j1_offset
                    For i2 As Integer = 0 To iSquare - 1
                        Dim offset_value As Integer = j_offset_value + i2_offset
                        Dim interleaved_value As Integer = j2_offset + i2_interleaved_offset + j1_interleaved_offset
                        For i1 As Integer = 0 To iSquare - 1
                            box = offset_value + i1
                            gridbox(box) = interleaved_value + i1
                            gridbox1(gridbox(box)) = j_offset_value
                        Next
                        i2_offset += iSquare
                        i2_interleaved_offset += Square2
                    Next
                    j1_offset += Square2
                    j1_interleaved_offset += iSquare
                Next
                j2_offset += Square3
            Next 
```

**几个月后**更新一点后续。****

 **[这是一个数独程序，你可以在这里](http://www.codeproject.com/KB/vb/CodeBehindSudoku.aspx)找到它的使用位置

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T23:31:58.243

如果我做对了，这应该做同样的事情：

```
For j1 = 0 To square - 1
  For j2 = 0 To square - 1
    j = j1 * square + j2
    For i1 = 0 To square - 1
      For i2 = 0 To square - 1
        box = (j * squareExp2) + i1 * square + i2
        gridbox(box) = (((j1 * square + i1) * square + j2) * square) + i2
        gridbox1(gridbox(box)) = j * squareExp2
      Next
    Next
  Next
Next 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T23:52:53.967

看起来这是为了生成从线性地址到相同数据中的偏移量的重映射表，以 morton 顺序排列。`gridbox(y*squareExp2+x)`是 swizzled 数据`gridbox1(x)`中的偏移量， 是块的偏移量。

这种事情通常表示为按位操作的序列，但这并不能推广到任何维度的块（例如，3x3）。

对于任意块大小，我不知道有任何更简洁的方法。块的坐标必须是已知的（it's `(i\square,j\square)`），块内的坐标必须是已知的（it's `(i mod square,j mod square)`），块坐标的每个部分都必须按该维度中的块大小进行缩放（`squareExp2*square`, j-wards 和`squareExp2`, i -wards)，并且块内的坐标必须在 j 方向上按块的步幅 ( `square`) 缩放。因此，如果只涉及这些计算（看起来没有，尽管我可能弄错了！）那么我不确定还有什么可以挤出来的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T00:20:13.837

编辑：真正终极力量的最终答案！

因此，对于 gridbox，您基本上是采用 i 和 j 并将它们的数字交错在基数（正方形）中。例如，给定基数（比例）中的 i 和 j，您正在计算：

i(2)j(2)i(1)j(1)

其中 (n) 表示数字基数（比例）。

所以这很容易加速：只需记录每个数字对 gridbox(...) 最终值的贡献。

加速 gridbox1(...) 更加容易。基本上，您正在计算：

```
Square * Square *(j\Square * Square + (j Mod Square)) 
```

现在，`(j Mod Square)`扩展为`(j - j\Square*Square)`将上述内容简化为：

```
Square * Square *(j\Square * Square + (j - j\Square*Square)) 
```

这简化为：

```
Square * Square *(j\Square * Square + j - j\Square*Square) 
```

这简化为：

```
Square * Square * (j) 
```

这是最后的循环：

```
Dim Square2 = Square * Square
Dim Square3 = Square2 * Square
Dim Square4 = Square2 * Square2

Dim j2_offset = 0
Dim j2_interleaved_offset = 0
Dim j2_value_offset= 0
For j2 = 0 To Square - 1
    Dim j1_offset = 0
    Dim j1_interleaved_offset = 0
    For j1 = 0 To Square - 1
        Dim i2_offset = 0
        Dim i1_interleaved_offset = 0
        For i2 = 0 To Square - 1
            For i1 = 0 To Square - 1
                Dim box = j2_offset + j1_offset + i2_offset + i1
                gridbox(box) = j2_interleaved_offset + i2_interleaved_offset + j1_interleaved_offset + i1
                gridbox1(gridbox(box)) = j2_offset + j1_offset
            Next
            i2_offset += Square
            i2_interleaved_offset += Square2
        Next
        j1_offset += Square2
        j1_interleaved_offset += Square
    Next
    j2_offset += Square3
    j2_interleaved_offset += Square3
Next 
```

# winforms - 子列表更改时我应该如何处理 INotifyPropertyChanged

> ID：571611
> 
> 赞同：3
> 
> 时间：2009-02-20T23:10:05.270
> 
> 标签：winforms, data-binding, inotifypropertychanged

我有一组数据对象，用于实现 INotifyPropertyChanged 接口的数据绑定，我试图弄清楚如何处理复杂类型的属性。

如果我有类似的东西

```
 class C {
 private string text;
 public string Text {
  get { return text; }
  set {
   if(Text != value) {
    text = value;
    OnPropertyChanged("Text");
   }
  }
 }
} 
```

我知道该怎么做，但是如果属性是可变的怎么办，大概我也应该通知类型的更改。

如果属性本身实现了 INotifyPropertyChanged，大概我可以处理该事件并将其冒泡，但如果引发 ListChangedEvent（比如它是 IBindingList），我是否应该这样做？

这是 .NET 2.0，因此不允许依赖属性等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T00:21:23.553

如果您有一个公开复杂类型的属性，则不需要在复杂类型上的属性更改时引发 PropertyChanged 事件，仅当您将实例更改为复杂类型时才需要。复杂类型应在其属性之一更改时引发其自己的 PropertyChanged 事件（您不必将事件冒泡到父对象）。

重申一下，您应该只在属性值更改时引发 PropertyChanged 事件，而不是在子属性更改时引发。您提供的示例代码是您所有属性集的外观。

# java - 平台强制版本控制机制是 Java 最需要的特性吗？

> ID：571616
> 
> 赞同：8
> 
> 时间：2009-02-20T23:12:20.023
> 
> 标签：java, dependencies, versioning, jar

作为开发人员，我经常对可以使您的生活更轻松的新语言功能感兴趣。例如，Java 5 为该语言带来了泛型和注释，这些特性绝对可以提高您的工作效率。

然而，当我回顾近十年在 java 平台上的工作时，我发现版本控制相关的问题是导致效率低下和不必要的努力的最大罪魁祸首。寻找正确版本的 jar，尝试调和一些版本冲突，升级依赖库等数小时和数小时。当我开始使用 java 时，事情并没有那么困难，你会有一些 3rd 方库，仅此而已. 今天，您的典型 Web 应用程序可能很容易使用：Spring Framework、Hibernate、Struts，应有尽有。所有这些都带有许多相关的第 3 方库。今天，我的耳朵档案通常包括大约 40 个或更多的 3rd 方库。一个真正的罐子地狱！

例如，使用注释，我不必管理 Hibernate 的配置文件。一个不错的功能，但我没有看到由于我将描述符保存在单独的文件中而引起的许多问题。使用泛型，我不必编写强制转换语句，但在我的整个编程载体中，我不记得使用类型安全容器可以防止的单个错误。版本控制问题的解决方案不是更有价值吗？

所有这些问题都导致了许多工具，如[Maven](http://maven.apache.org/)、[ivy](http://ant.apache.org/ivy/)、[One Jar](http://one-jar.sourceforge.net/)、[Jar Jar Links](http://code.google.com/p/jarjar/)（不是在开玩笑！），甚至恰当地命名为[Jar Hell](http://incubator.apache.org/depot/version/jar-hell.html)等。即使您使用其中一些工具，您也远不能对问题。我使用 Maven 2，它帮助很大。尽管如此，它本身就是一个世界。新手程序员可能需要一段时间来学习它。将遗留项目迁移到 Maven 结构也很痛苦。

似乎在 .Net 中，他们已经吸取了 dll 地狱的教训，并且 .Net 程序集的管理要简单得多。

似乎有计划为 java 平台和 OSGI 等替代品解决这个问题。我认为急需一些基本的和平台强制的版本控制机制

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T11:36:30.450

我也使用 Java 十多年了，但我不得不说我根本没有发现很多*JAR 地狱*问题（即使使用你提到的所有 3rd-party 工具）！我发现`Maven`这是一个可怕的工具，所以用`ant`.

在我们公司，我们有一个定制的依赖解决`ant`任务，它基于每个项目的简单（小）依赖文件，以及将每个项目定义为 an`app`或 a （你应该只依赖 a ；从不`lib`依赖）。它工作得很好。`lib``app`

我们还有一些`ant`任务来修改我们的 eclipse`.classpath`和 IDEA`.iml`文件来为我们的 IDE 生成依赖关系图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T17:28:16.370

看看 OSGi——它很好地处理了版本控制和包（jar）的管理。

另外：Eclipse（构建在 OSGi 之上）有一些相对较新的 API 工具，可以帮助您将您的 API 与以前的基线进行比较，并确定如何适当地表达您的包的下一个版本号。

通用的 Eclipse 版本控制方案：

```
v.m.n.q 
```

在哪里

v：高级版本 - 这里的更改通常代表 API 中的重大更改

m：主要变化 - 新功能，新 API

n：小改动 - 相同的 API，幕后改动

q: qualifier - 用于标记构建、alpha/beta 等

OSGi 使用范围指定版本依赖关系。例如

```
Require-Bundle: com.javadude.foo;bundle-version="[1.2.0,2.0.0)" 
```

在您的 MANIFEST.MF 中指定捆绑包需要 1.2.0 版或更高版本的捆绑包 com.javadude.foo，直至（但不包括）2.0.0 版。

您也可以改为在包级别指定依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T23:29:26.597

.NET 相对于 Java 的优势在于这些库与操作系统的联系更紧密。框架库（如果已安装）很容易位于 GAC 中这一事实确实简化了事情，但您也几乎仅限于 Windows。更好的比较是 Mono，但我没有任何经验。

至少对我而言，配置管理一直是软件开发的一大痛点。您尝试利用现有代码的次数越多，它似乎变得越糟糕。这个问题本身并不是 Java 独有的，但版本的激增、平台存在的时间以及支持的平台数量似乎确实使情况变得更糟。我刚刚检查了一下，现在我的盒子上有 3 个版本的 JRE —— 而且我什至不是一个活跃的 Java 开发人员。

至于您的问题，我不确定这是否是最紧迫的功能需求。就个人而言，我希望看到对 Web 服务的更好支持，尤其是那些需要身份验证标头的服务。上一次我试图让 Java 与我的一个 .NET Web 服务交互时，我差点把头发扯掉。将 LINQ 与 C#/.Net 一起使用后，我还可以说这将是对 Java 的一个非常酷的补充，可以说可以提高生产力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T03:32:32.097

.NET 支持并行程序集，因此您可以拥有同一个应用程序的多个版本。GAC 就像共享 DLL，但您仍然可以在 GAC 上注册同一程序集的多个版本，如果我没记错的话，另一个程序集可以请求某个版本或更高版本。在 JavaEE 中，你确实有几个类加载器级别，你可以做一些模拟类似版本控制的技巧

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T12:38:48.070

我在我工作的一个站点上遇到了这个问题：构建了一个工具来运行 Web 服务器上的 jar 文件并找到 jar 文件的所有嵌套副本 - 以及具有相同名称的不同文件（例如：log4j.jar 的版本）。这是一个可怕的混乱，包括一个*里面*有 WebLogic jar 的 WAR 。

不确定解决方案是什么。

事情是：java*有*东西来管理这个 - 带有包版本的标记 jar 文件。特别是：webstart。也许需要的是某种类型的类加载器，它可以做 webstart 类型的事情。

怎么样：**在 JAR 清单中，您指定库依赖**项，使用众所周知的名称和版本。由容器或运行时提供的类加载器将负责获取您想要的版本。

有很多系统（例如：Maven 本身）用于管理下载库的知名位置，以及 fink 和诸如此类的东西。

# php - 如何使用 Stomp 协议在 ActiveMQ/JMS 选择器中使用算术条件和运算符

> ID：571617
> 
> 赞同：1
> 
> 时间：2009-02-20T23:13:10.520
> 
> 标签：php, activemq, stomp

我有几条带有属性集的消息。其中一些包含数字数据，尽管我在发送消息时没有尝试向 ActiveMQ 显式声明这一点。

当我尝试使用算术条件时，即：<、>、<=、>= 和家庭，我得到一个错误。有没有办法通过 Stomp 使用选择器来使用算术条件？我已经在网上搜索过，在谷歌上只得到了以下点击：[http ://rubyforge.org/tracker/index.php?func=detail&aid=21378&group_id=1010&atid=3981](http://rubyforge.org/tracker/index.php?func=detail&aid=21378&group_id=1010&atid=3981)

STOMP 协议的 v1.1 似乎可以解决这个问题：http: [//stomp.codehaus.org/Stomp+v1.1+Ideas](http://stomp.codehaus.org/Stomp+v1.1+Ideas)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:42:40.820

目前 Stomp 将所有属性视为字符串，因此使用算术不起作用。正如您所发现的，它计划在 Stomp 1.1 中支持属性类型，然后您将能够像在 JMS 中一样使用它们。

干杯德让

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-24T04:36:22.730

我建议您尝试名为[Apollo](http://activemq.apache.org/apollo/)的 ActiveMQ 子项目。它专注于提供强大的 STOMP 支持，并且确实支持数字选择器[，请参阅文档](http://activemq.apache.org/apollo/documentation/user-manual.html#Message_Selectors)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T23:19:19.663

我发现使用 STOMP 和 ActiveMQ 以数字方式对消息进行选择的唯一方法是使用 XML 消息和 XPATH 选择器：

*   [http://activemq.apache.org/selectors.html#Selectors-UsingXPathtofiltermessages](http://activemq.apache.org/selectors.html#Selectors-UsingXPathtofiltermessages)

要使用 XML 消息，ActiveMQ 需要来自 xalan 的三个 jar：

*   xalan.jar
*   xmlImpl.jar
*   xml-apis.jar

这三个都必须在 CLASSPATH 中（即：在 activemq/lib 目录中）。这三个都可以从 xalan 二进制包中获得。

# django - 您如何在管理 list_filter 中引用相关模型的字段？

> ID：571635
> 
> 赞同：4
> 
> 时间：2009-02-20T23:22:31.043
> 
> 标签：django, django-admin

我的模型：

OrderInfo 和 Print 是一对一的，Print 是多对一的，而 Painting 本身是 Club 的多对一。

```
class OrderInfo(models.Model):
    print_ordered = models.OneToOneField(Print, blank=True)

class Print(models.Model):
    painting = models.ForeignKey(Painting)

class Painting(models.Model):
    club = models.ForeignKey(Club) 
```

在我的 OrderInfoAdmin 中，我希望能够按相关的俱乐部进行排序，但我无法弄清楚执行此操作的语法。

我试过这个，但它不起作用：

```
class OrderInfoAdmin(admin.ModelAdmin):
    list_filter = ['print_ordered__painting__club'] 
```

任何帮助表示赞赏，在此先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T12:40:08.747

该`list_filter`命令用于过滤而不是排序。您想要`ordering`此处记录的命令：http: [//docs.djangoproject.com/en/dev/ref/models/options/#ordering](http://docs.djangoproject.com/en/dev/ref/models/options/#ordering)。虽然从文档中我不清楚`modeling`Meta 命令是否允许通过外键进行排序。（`filter()`queryset 函数确实可以：[http://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by-fields](http://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by-fields)）

我发现管理员在使用深度层次模型时存在一些限制。例如，您可以在其父页面上内联子模型，但不能内联孙子模型。此外，默认情况下，该`list_filter`命令仅适用于建模表中的字段。在您的示例中，例如，您无法过滤admin 中`Print`的字段。`OrderInfo`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:08:44.713

就在今天，Josh VanderLinden 在他的博客上发布了一个解决方案：

[模型关系和“list_display”](http://www.codekoala.com:4000/posts/model-relationships-and-list_display/)

（通过[Django 社区](http://www.djangoproject.com/community/)找到）

# winsock - Winsock 上的实用通用组播

> ID：571648
> 
> 赞同：2
> 
> 时间：2009-02-20T23:28:49.343
> 
> 标签：winsock, multicast

有没有人在 Windows 上使用 Winsock（不是 MSMQ）级别的 PGM 的经验？它看起来像一个有用的可靠多播协议（la TIBCO Rendezvous），我认为如果在基于本地完成端口的 I/O 上运行，它可以使这样的东西真正飞起来。

我已经在 C++ 级别上涉足它，通过编写一些 boost::asio 支持并通过 SocketAsyncEventArgs 在 C# 中运行它，但可惜我微薄的家庭办公室设置缺乏真正的 LAN 来正确测试它，我想知道是否有人花时间在上面并有任何观察？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-04T10:14:39.513

Windows 上 Microsoft 堆栈的替代方案是 OpenPGM 2，也可在 Linux 和 Solaris 上使用。

[http://code.google.com/p/openpgm/](http://code.google.com/p/openpgm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:35:25.863

逃跑！我们曾经尝试将它用于一个项目，但无法使其工作。最大的问题是某种挂起的 I/O 请求挂在驱动程序中，因此您无法终止该进程。调试起来有点困难。

这是 Server 2003，我怀疑它在 2008 年会更好，但你总是可以在那里尝试。

# c++ - 在 C++ 中处理多个对象依赖关系的最佳方法是什么？

> ID：571652
> 
> 赞同：5
> 
> 时间：2009-02-20T23:29:44.647
> 
> 标签：c++

我正在构建一个 C++ 应用程序，并且我有几个实用程序对象，我的所有类都需要使用这些对象。这些是日志对象、全局状态对象、DAL 对象等...

到目前为止，我一直将所有这些对象作为引用传递给我的类构造函数。

例如：

```
本田级：公共汽车
{
    上市：
        本田 ( const GlobalState & state,
                常量日志和记录器，
                常量 DAL & dal );

    ...

    私人的：
      常量 GlobalState & my_state;
      常量日志 & my_logger;
      常量 DAL & my_dal;
}

```

这很快就会变得乏味，因为每次我添加一个我的所有类都需要访问的实用程序对象时，我必须到处更改构造函数。

我听说解决此问题的正确方法是创建一个包含所有不同实用程序对象的结构并将其传递（作为引用）给所有需要访问它的对象。

这是处理这个问题的正确方法吗？谢谢！

**更新：**感谢大家的反馈。经过一些额外的研究，我决定继续使用依赖注入。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-20T23:35:24.490

您可以将 GlobalState、Log、DAL 类设为单例：

```
class GlobalState {
public:
  static GlobalState& getInstance();
protected:
  GlobalState();
  GlobalState(const GlobalState&);
  GlobalState& operator= (const GlobalState&);
private:
  static GlobalState* p_instance;
};

static GlobalState* GlobalState::p_instance = NULL;

/*static*/
GlobalState& getInstance() {
  // TODO: acquire lock if multi-threaded
  if (!p_instance) {                 // first time?
    p_instance = new GlobalState(); // create sole instance
  }
  // TODO: release lock if multi-threaded
  return *p_instance;               // sole instance
} 
```

然后，在你的各种方法中，

```
Honda::MyMethod() {
  ...
  const GlobalState& my_state = GlobalState::getInstance();
  ...
} 
```

在某些条件下（例如，所有类的构造函数采用相同数量和类型的参数等），您可以通过[定义单例 C++ 模板](http://gpwiki.org/index.php/Programming_Techniques:Singleton#A_Singleton_Class_Template_in_C.2B.2B)来进一步简化您的生活（并减少代码重复量）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-21T00:05:25.013

您可以使用**服务定位器**模式。[本文](http://martinfowler.com/articles/injection.html)介绍了依赖注入（您当前正在使用）和服务定位器。

但是，请考虑这一点：依赖注入的想法是建立一个系统，其中每个组件都有明确定义的职责，并尽可能减少对其他组件的了解。如果组件需要其他组件来完成其工作，那么这些组件会显式传递给它。这使得组件更易于理解，更可能是正确的，并且更易于维护。

如果您经常需要添加需要在整个系统中了解的组件，那么系统的设计（或向其中添加新功能的方式）可能存在问题。依赖注入模式只会导致这个问题显式可见。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T23:33:36.400

我想说让工厂根据需要创建具有静态类方法的对象——如果它们自己不保持状态——可能是一个更好的解决方案。如果到处都需要对象并且需要保持全局状态，那么使用单例模式可能是合理的。不过，在我查看 Singleon 之前，我真的需要知道工厂方法和根据需要重新创建对象是行不通的。使用 Singleton 会使您的测试工作复杂化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T23:50:01.367

将状态对象变成单例的好处是您不再需要将 const 引用传递给所有构造函数。

因此，如果您的全局状态是按照[Vlad R](https://stackoverflow.com/users/66516/vlad-r)的建议定义的，您可以在构造函数（和其他地方）中使用它来引用它，例如：

```
GlobalState::getInstance() 
```

因此删除构造函数的参数以及成员变量，使您的接口更干净。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T23:50:14.127

我对大多数全局状态对象使用全局命名的实例。该模式类似于传统的单例，除了对于单例，纯粹主义者会坚持其构造函数也是私有的以防止独立构造，而我的模式允许在必要时进行独立构造（即：我的单例模板不需要单例类的构造函数是私人的）。否则，该模式类似于 Vlad 所写的。

需要注意的一件事是：如果您需要在程序退出时取消分配您的单例（例如，您有一个强制要求不要泄漏您分配的内存），那么处理可能会很快变得非常混乱。描述我为尝试使用单例实现没有内存泄漏而不得不处理的所有事情会占用大量空间，其中许多并不漂亮；因此，如果您需要清理，请考虑使用简单的全局变量（在方法上可能会令人反感）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-21T00:19:11.280

使用单例，不要忘记： http: [//www.parashift.com/c++-faq-lite/ctors.html#faq-10.12](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T06:44:25.207

为了回答你的问题，迈克尔，在这种情况下，你实际上可以做四种不同的事情：

1.  将所有实用程序对象变成全局对象。
2.  将所有实用程序类更改为单例。
3.  使用服务定位器。
4.  使用依赖注入（你已经在做）

让我们解决前三个选项：

1.  使用全局变量可能很方便，但它隐藏了对象依赖关系并使隔离测试更加困难。
2.  [使用单例不是一个好主意。](http://www.codingwithoutcomments.com/2008/10/08/singleton-i-love-you-but-youre-bringing-me-down/)
3.  [使用服务定位器不是一个好主意。](http://misko.hevery.com/2008/11/11/clean-code-talks-dependency-injection/)

因此，[继续使用依赖注入](http://misko.hevery.com/2009/01/14/when-to-use-dependency-injection/)。

# perl - Perl 分发了哪些模块？

> ID：571654
> 
> 赞同：12
> 
> 时间：2009-02-20T23:30:18.870
> 
> 标签：perl, module

我如何知道 Perl 分发了哪些模块？

我的第一个猜测是[这里](http://perldoc.perl.org/index-modules-A.html)列出的核心模块总是包含在内，尽管我找不到明确说明。但是，我使用了这个集合之外的模块（例如 LWP），而不必在 Mac OS X 和 Linux 上安装它们。

所以稍微完善一下我的问题：

*   所有 Perl 安装都分发了哪些模块？

并且：我如何找出分发了哪些模块：

*   Linux（尤其是 Debian/Ubuntu）？

*   Mac OS X？

*   索拉里斯？

在每种情况下，我都使用最新版本的操作系统标配的 Perl 版本。

TIA。

**更新：**问题的原因是我正在 Mac OS X 和 Linux 上开发以部署到不同的 Linux 和 Solaris，并且我在其中一些系统上没有 root，对于 Mac OS XI 没有甚至有一个编译器AFAIK。所以我想知道我在所有四个部署中都有哪些模块，而无需进一步安装。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-20T23:43:23.130

如果您安装[Module::CoreList](http://search.cpan.org/perldoc?Module::CoreList)，命令行程序`corelist`可以告诉您有关模块及其在不同版本 perl 中的版本的所有信息。您链接到的页面概述了最新版本的 perl。

请注意，默认情况下发行版通常提供比此列表更多的内容，但可以假定此列表无处不在（除非它明确是操作系统相关的模块，例如 Win32）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-21T08:16:52.087

已经给出了正确的直接答案，但我认为你问错了问题。您可能正在尝试仅使用核心模块进行开发。为什么？您这样做可能是因为您不想处理依赖关系。为什么？因为他们可能会让人头疼。[但是在没有CPAN](http://search.cpan.org)的情况下开发 Perl会失去一半的力量。你在折磨自己。这很值得。

**更新**：既然我对你想要做什么有了更多的了解，我可以回答正确的问题。首先是“当我没有 root 时如何安装模块？” 简单的答案是这样的：

```
perl Makefile.PL PREFIX=/some/path LIB=/some/path/lib
...and all the rest as normal... 
```

对于基于 MakeMaker 的模块（LIB 用于控制 PREFIX 的不精确性质。首选 INSTALL_BASE，但它不向后兼容）。

这对于 Module::Build

```
perl Build.PL --install_base=/some/path 
```

然后模块将在 /some/path/lib 中结束，您可以设置`PERL5LIB`环境变量或`use lib qw(/some/path/lib)`在您的代码中。

这意味着您可以将依赖模块直接粘贴到您的软件发行版中并发布它们。适用于纯 Perl 模块。对于需要编译器的东西，请查看[PAR](http://search.cpan.org/perldoc?pp)，因为其他人建议能够发布已编译的可执行文件。

或者，您可以将您的东西作为 CPAN 模块分发，并附上依赖项，然后让 CPAN 客户端解决它们。您甚至可以使用[Module::AutoInstall](http://search.cpan.org/perldoc?Module::AutoInstall)在 CPAN 客户端之外执行此过程。

所以你看，在发布 Perl 应用程序时，你并不局限于只使用核心模块。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-21T07:00:50.537

[Module::CoreList](http://search.cpan.org/perldoc?Module::CoreList)已经被提及。它带有一个[命令行界面](http://search.cpan.org/perldoc?corelist)，使事情变得简单。如果您已经安装了它，或者有一个程序需要弄清楚特定版本的 Perl 可能没有附带什么，那就太好了。

如果您想知道特定版本的 perl 附带了哪些模块，您可以`perldoc perlmodlib`在命令行上运行以获得完整列表。对于较旧或较新版本的 Perl，您只需转到[CPAN 上的 Perl 页面](http://search.cpan.org/dist/perl/)并从下拉列表中选择您想要的版本（例如，5.6.2），然后导航到`perlmodlib`文档中的页面。（输入`perlmodlib`浏览器的文本搜索会有所帮助）。

如果您考虑*不*使用模块，因为它不是旧版本 Perl 的核心，那么您可能希望考虑使用[PAR，Perl Archiver](http://search.cpan.org/perldoc?PAR)来捆绑您的额外依赖项，甚至 Perl 本身！Perl Training Australia 也有一个[关于使用 PAR 的 Perl 提示，](http://perltraining.com.au/tips/2008-05-23.html)其中涵盖了开始使用 PAR 的基础知识。

万事如意，

*保罗*

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-20T18:39:43.203

要快速查看已安装的模块和版本，请使用 cpan 工具创建自动捆绑包：

```
 cpan -a 
```

如果您需要更复杂的东西，ExtUtils::Installed 可以为您提供帮助。

曾经有“标准库”的想法，但实际上并不存在。[Module::CoreList](http://search.cpan.org/dist/Module-CoreList)告诉您“标准库”中有什么，但许多供应商安装了额外的模块，有些甚至删除或更新了模块。此外，[Strawberry Perl](http://www.strawberryperl.com)和[ActivePerl](http://www.activestate.com)等发行版带有许多奖励模块。

此外，您不需要 root 来安装模块。您只需要 root 即可安装模块，而 root 可以安装模块。[perlfaq8](http://faq.perl.org/perlfaq8.html)为您提供了在任何您喜欢的地方安装模块的所有详细信息。我建议您将所有模块安装在分布式 @INC 目录之外，以便保持分布式 Perl 干净。

祝你好运，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T12:09:35.793

听起来你想要[local::lib](http://search.cpan.org/perldoc?local::lib)。没有 root 的 cpan 的所有好处（并且使系统 perl 保持不变）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T23:56:03.117

这方面的一个简单参考在《*[Beginning Perl](http://www.perl.org/books/beginning-perl/)* [》的附录 D](http://blob.perl.org/books/beginning-perl/3145_AppD.pdf)中。当然它适用于 Perl 5.6，但据我所知，Perl 5.8 并没有删除任何这些，只是引入了新的（如 Digest::MD5、File::Temp、Filter::Simple、libnet、List::Util、Memoize , MIME::Base64, Scalar::Util, Storable, Switch, Test::More, Test::Simple, Text::Balanced, Tie::File等)

对于 perl 的每个版本，您可以查看[perldoc](http://perldoc.perl.org)。这是[perl 5.8.8 的列表](http://perldoc.perl.org/5.8.8/index-modules-A.html)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-20T09:04:32.290

这个问题现在不那么重要了（我在最终的目标机器上拥有 root 访问权限，所以我只需要安装我需要的包），但如果有人感兴趣，这就是我所做的：

首先，在每个目标系统上运行此代码：

```
foreach my $dir (@INC) {
    print "Directory: $dir\n";
    if (-d "$dir") {
        my @modules = `find $dir/ -name "*.pm"`;
        foreach my $m (@modules) {
            my $label = $m;
            $label =~ s|\n$||;
            $label =~ s|//+|/|g;
            $label =~ s|^$dir/||;
            print "$label\n";
        }
    }
} 
```

请注意，您需要一个带有 find 命令的 *nix 系统。将输出转储到三个文件中，并排序。然后使用这样的命令（从内存中）：

```
grep -F -x -f list-1.txt list2.txt > list-12.txt
grep -F -x -f list-12.txt list3.txt > list-123.txt 
```

现在 list-123.txt 应该或多或少有共享模块的列表。

值得一提的是，这三个系统都共享了一些额外的模块，尤其是 XML::Parser 模块。

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2009-02-20T23:41:14.603

查看您的主符号表，它将向您显示所有可用的“标准”包...

```
print %main::; 
```

# mysql - 选择项目，然后选择父项的名称

> ID：571655
> 
> 赞同：1
> 
> 时间：2009-02-20T23:31:39.040
> 
> 标签：mysql

匆匆：

表结构：

```
id | name | parent_id 
```

我想对 ID 进行查询，但还要返回该项目的 parent_id 和该 ID 的名称。

为了更好地解释

```
SELECT id, name FROM sections 
```

...然后对于每个 ID，使用“parent_id”列返回其父级的 ID 和名称。

我正在尝试将其放入数组中：

```
[0]
    [id]
    [name]
    [parent_id]
    [parent_name] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T23:34:35.927

这应该有效：

```
SELECT s.id, s.name, s.parent_id, p.name as parent_name
FROM sections s LEFT JOIN sections p ON s.parent_id = p.id 
```

基本上，您只想将表格与自身连接起来，并将名称字段作为父名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T23:35:06.927

```
SELECT a.id, a.name, b.id as parent_id, b.name as parent_name
FROM sections a
INNER JOIN sections b on a.parent_id = b.id 
```

（如果有没有父节点的节点也可以进行外部连接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T23:35:38.437

只需将表连接到自身

就像是：

SELECT child.id, child.name, child.parent_id, parent.name AS parentname FROM tablename child LEFT JOIN tablename parent ON child.parent_id = parent.id

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T23:56:53.333

做一个连接比简单地做子选择更有效吗？

```
select id as childID , name as childName, parent_id as pid, (select id from sections where id = pid) as parentID, (select name from sections where id = pid) as parentName from sections; 
```

更大的问题是这是非递归的......我很好奇如何让这个无限增长的多代关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-05T13:01:03.790

您可以有许多解决方案，例如::

1 >

```
Select id as id, name as id_name, (Select id from sections where id=parent_id) as parent_id, (Select name from sections where id=parent_id) as parent_name 
from sections where ..... 
```

2 >

```
Select child.id, child.name, parent.id, parent.name 
 from sections child
 inner join sections parent on (parent.id=child.parent_id)
 where ..... 
```

你可以实现任何一个，但我更喜欢第二个..

# ruby - Ruby XPath 查找属性

> ID：571663
> 
> 赞同：2
> 
> 时间：2009-02-20T23:35:20.483
> 
> 标签：ruby, xpath

什么 Ruby 库可用于使用 XPath 选择**属性**，并将其用作其他 XPath 查询的起点。

例子：

```
<root>
  <add key="A" value="B" />
  <add key="C" value="D" />
  <add foo="E" bar="F" />
</root> 
```

所需代码：

```
get_pair "//*/@key", "../@value"
get_pair "//*/@foo", "../@bar" 
```

预期输出：

```
"A" "B"
"C" "D"
"E" "F" 
```

伪实现：

```
def get_pair(key, value)
  xml_doc.select[key].each do |a|
    puts [a, a.select[value]]
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T23:46:55.663

您的出发点是[REXML](http://www.germane-software.com/software/rexml/)

这里的“挑战”是如何将属性节点视为子节点，这可以通过使用[单例方法](http://www.rubyist.net/~slagell/ruby/singletonmethods.html)来完成，然后一切自然如下：

```
require "rexml/document"
include REXML  # so that we don't have to prefix everything with REXML::...

def get_pair(xml_doc, key, value)
  XPath.each(xml_doc, key) do |node| 
    if node.is_a?(Attribute)
      def node.parent
        self.element
      end
    end
    puts "\"#{node}\" \"#{XPath.first(node, value)}\""
  end
end

xml_doc = Document.new <<EOF
  <root>
    <add key="A" value="B" />
    <add key="C" value="D" />
    <add foo="E" bar="F" />
  </root>
EOF

get_pair xml_doc, "//*/@key", "../@value"
get_pair xml_doc, "//*/@foo", "../@bar" 
```

产生：

```
"A" "B"
"C" "D"
"E" "F" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T23:59:37.070

显然 Nokogiri 是最快的 Ruby XML 解析器

见[http://www.rubyinside.com/nokogiri-ruby-html-parser-and-xml-parser-1288.html](http://www.rubyinside.com/nokogiri-ruby-html-parser-and-xml-parser-1288.html)

今天正在使用它，它很棒。

对于您的示例：

```
doc = Nokogiri::XML(your_xml)
doc.xpath("/root/add").map do |add|
  puts [add['key'], add['value']]
end 
```

**编辑**：不出所料，Nokogiri 更快的说法并非没有争议。

但是，我们发现它在我们的生产环境中比 libxml 更稳定（libxml 偶尔会崩溃；只需在 Nokogiri 中交换即可解决问题）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T23:53:30.063

如果您要在性能重要的任何领域解析大量数据，那么您将需要[libxml-ruby](http://libxml.rubyforge.org/)。REXML 和 Hpricot 都不错，但我最近不得不在我自己的服务器上进行一些解析，因为它快了 1200%。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T23:51:11.473

我还建议查看 Hpricot ...它是一个非常富有表现力的 HTML 和 XML 解析库，受 jQuery 启发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T23:58:48.240

ruby 附带的 rexml 会做你想做的事：

```
require 'rexml/document'
include REXML
xml = Document.new('<root><add key="A" value="B" /><add key="C" value="D" /><add foo="E" bar="F" /></root>')
xml.root.each_element_with_attribute('key'){|e| puts "#{e.attribute('key')} #{e.attribute('value')}"} 
```

# asp.net - 在 ASP.Net 中实现基于角色的安全性的最佳方法是什么？

> ID：571669
> 
> 赞同：0
> 
> 时间：2009-02-20T23:37:27.637
> 
> 标签：asp.net, security, login, security-roles

我正在开发的网站是中型网站，有 3 名开发人员，几千名用户，对于运行它的小型企业来说非常重要。所以我要说的是，这不是一家财富 500 强公司，而是一家严肃的企业，需要以一种时间/预算有效的方式实施基于角色的安全性，这种方式仍然非常易于使用并且具有高度的安全。

该站点将主要是自定义编码的，但我们希望尽可能有效地利用组件。将有大约 6 个角色（买方、卖方、管理员、合作伙伴等），大多数是外部用户，因此我们预计他们会在表单中输入 uername、pw 等。我们很可能会将用户信息存储在 SQL Server 中桌子。

我希望您对用于基于角色的安全性的最佳技术的想法，希望基于您的实际经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T23:40:56.507

这是你[最好的选择](http://msdn.microsoft.com/en-us/library/aa479032.aspx)。我还建议您将[提供者模型](http://msdn.microsoft.com/en-us/library/aa479030.aspx)作为一个整体进行研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:41:43.807

看看[SqlRoleProvider](http://msdn.microsoft.com/en-us/library/ms998314.aspx)，我已经成功地将它与 Sql 和 ActiveDirectory [Membership Providers](http://msdn.microsoft.com/en-us/library/aa478949.aspx)一起使用。

# tsql - 如何从存储过程中抑制存储过程的结果？

> ID：571670
> 
> 赞同：22
> 
> 时间：2009-02-20T23:37:58.337
> 
> 标签：tsql, stored-procedures

我有一个存储过程（我们称之为 A），它调用另一个存储过程（我们称之为 B）。B 包含一个我不想发回给 A 的调用者的 SELECT。

这是一些非常粗略的伪代码，但它应该可以理解这个想法。

```
PROCEDURE A
    CURSOR
        CALL B -- I WANT TO SUPPRESS THE RESULTS FROM B
    END
    SELECT *
END
PROCEDURE B
    Do some interesting things
    SELECT *
END 
```

正如您在上面看到的，A 调用 B 并且 B 做了一些我想要的事情并返回我不关心的结果。一旦 A 完成，它就会返回自己的一组结果。

如何抑制 A 中 B 的结果？我正在使用 SQL Server 2005。我不希望对 B 进行更改，因为它正在工作并且比我想要的更复杂。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-20T23:45:08.227

你可以尝试这样的事情：

```
/* Assume this table matches the output of your procedure */
DECLARE @tmpNewValue TABLE (newvalue int)
INSERT INTO @tmpNewValue 
EXEC ProcedureB 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T09:17:51.487

我真的很笨，但“做一些有趣的事情”不应该在另一个程序中吗？然后过程 A 将调用过程 C（它只执行“做一些有趣的事情”）然后执行所需的选择，过程 B 也可以调用过程 C 并执行其选择，而不是产生第二次选择和临时表的开销那只用作垃圾箱？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-29T14:44:52.417

这是对 proc A & B 的轻微修改，可满足您的需求：

```
PROCEDURE A
    CURSOR
        CREATE TABLE #__suppress_results (col1 int)
        CALL B -- I WANT TO SUPPRESS THE RESULTS FROM B
    END
    SELECT *
END
PROCEDURE B
    Do some interesting things
    IF OBJECT_ID('tempdb..#__suppress_results') IS NULL BEGIN
      SELECT *
    END
END 
```

这避免了嵌套的问题`INSERT...EXEC`，并保留了 proc B 的现有行为。如果其他调用 proc 已经创建了一个`#__suppress_results`在调用 proc B 之前命名的临时表，则只需使用不同的名称，例如`#__@supress_results`.

它可以工作，因为`#__suppress_results`如果从 proc A 调用 proc B，则在 proc B 中是可见的。

# .net - 如何构建类似 UI 的 Visual Studio？

> ID：571671
> 
> 赞同：9
> 
> 时间：2009-02-20T23:38:24.047
> 
> 标签：.net, visual-studio, user-interface

我正在寻找构建一个具有类似于 Visual Studio 的 UI 的 .Net 应用程序。这种范式有名字吗？或者有没有人知道这样做的教程......甚至是利用该范例的 OSS 项目？我正在寻找像对接方面和面板之间的交互......

我 99% 的经验是在网络空间中......所以这种应用程序对我来说是一个新的尝试。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-20T23:42:23.477

看看[Sharpdevelop](http://www.icsharpcode.net/OpenSource/SD/)。它的开源，甚至还有一本关于它的设计/实现以及如何扩展它的书。

这应该让你开始，甚至给你代码开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T23:43:11.150

如果您正在构建的应用程序也需要 VS 的某些行为，那么您可能需要考虑扩展 VS IDE 本身。请参阅[MSDN Visual Studio 可扩展性](http://msdn.microsoft.com/vsx)。请注意，从 VS 2008 开始，您可以将 IDE 扩展作为独立的（我认为它称为 shell 模式）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-20T23:52:31.207

对于对接方面，您可以尝试[Dock Panel Suite](http://sourceforge.net/projects/dockpanelsuite/)。这是一个免费的开源项目，托管在 SourceForge 上。从外观上看，它已经有几年没有新版本了，但它声称处于生产/稳定状态，所以也许这不是问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-20T23:42:59.513

[组件工厂](http://www.componentfactory.com/)制作了许多控件来创建类似于 UI 的 Visual Studio。您总是可以尝试弄清楚他们是如何做到的。有许多类似的商业控制。

就开源而言，我不熟悉任何强大的开源项目来做到这一点。

编辑：是的，我想Sharpdevelop也是一个不错的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T23:46:04.030

有很多 3rd 方控件可以为您提供可停靠的面板，等等。我知道[Infragistics](http://www.infragistics.com)提供了一个。我认为[组件工厂](http://www.componentfactory.com/)也是如此，但我不确定那个上的对接面板。

你看过[VS IDE Shell](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-10T05:25:13.450

请查看我的开源计划以获取类似的东西 - 它称为 Wide。

[https://github.com/chandramouleswaran/Wide](https://github.com/chandramouleswaran/Wide)

我喜欢的其他类似路线的开源计划是 Gemini

[https://github.com/tgjones/gemini](https://github.com/tgjones/gemini)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T01:18:46.520

您可能想看看[MonoDevelop](http://Monodevelop.com)（以及已经提到的 SharpDevelop）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T23:58:08.570

SourceForge 上有一个（曾经是？）项目，它只提供了构建 MDI 和类 Visual Studio UI 的对接特性所需的 DockingManager

在这里试试：http: [//sourceforge.net/projects/dockpanelsuite](http://sourceforge.net/projects/dockpanelsuite)

或者谷歌微分罗表单对接

# installshield - 选择 InstallShield 项目类型

> ID：571685
> 
> 赞同：12
> 
> 时间：2009-02-20T23:45:34.997
> 
> 标签：installshield

我即将开始一个新的 InstallShield 项目。项目类型有三种选择：

1.  基本微星
2.  安装脚本
3.  安装脚本-MSI

各有什么优缺点？我应该选择哪一个？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-21T16:36:58.093

**基本微星**：

这是标准安装类型。它使用 Windows Installer 进行几乎所有的安装（先决条件、语言选择和其他一些事情由 setup.exe 处理）。MSI 是一个包含许多表的数据库，这些表描述了安装的工作方式。表的数量一开始可能有点庞大，但 InstallShield 在抽象方面做得很好；大多数时候，您不需要直接编辑数据库表。

这是最常见的安装类型，因此有很多关于它的信息。[InstallShield 论坛](http://community.installshield.com/)是一个很好的信息来源。此外，许多安装使用 MSI，因此如果您了解它们，将更容易理解其他安装的作用（例如，如果您需要安装其他制造商的 MSI 作为安装的一部分）。使用命令行参数可以轻松完成静默安装。

不幸的是，由于 MSI 通过数据库表控制安装，因此存在一些学习曲线。如果您最终不得不直接编辑 MSI 表，一开始可能会感到困惑，因为有很多表，并且它们的一些用途和交互是微妙的。此外，在 MSI 中创建和排序对话更加困难，因为所有交互都需要由表控制。可以创建自定义 MSI 对话框，但只能在 C++ 中创建。

对于大多数用途，我会推荐这种项目类型。

**安装脚本**：

这些项目使用安装脚本而不是 Windows Installer 来安装软件。由于安装脚本是一个线性程序，因此更容易理解它的工作原理。这种项目类型的一个优点是创建和排序对话更容易。此外，InstallScript 对话框可以设置外观并且看起来比 MSI 对话框好一点。运行静默安装需要单独的“响应文件”来控制 UI。我不建议使用这种项目类型，除非您有特定的理由（例如，如果您必须以 MSI 不支持的方式非常精确地控制安装行为）。

**安装脚本 MSI**：

这本质上是一个基本的 MSI 项目，它使用 InstallScript 来控制 UI，并使用 MSI 来控制实际安装。它的优点是使用 MSI 来控制安装，但使用对话框更容易。在静默安装期间，它仍然需要一个响应文件来控制 UI。如果您不关心静默安装或有复杂的 UI 对话框序列，您可能会发现此项目类型很有用。

# open-source - 带有adsense的开源网站

> ID：571693
> 
> 赞同：2
> 
> 时间：2009-02-20T23:48:55.223
> 
> 标签：open-source, licensing, ads, adsense

我有用 Grails 开发的网站。网站上有谷歌广告和亚马逊链接。我想开源该网站的实现，但我不确定我是否仍然能够使用 Adsense“赚钱”。

所以问题是，如果我开源网站背后的代码，我还能在网站上运行 google adsense 吗？

我的感觉是，例如 LGPL 许可证可以做到这一点，但 GPL 许可证也可以吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T00:06:22.343

1.  您可以在任何许可下将您的代码发布给其他人。这不会自动将相同的许可证应用于您。但是，如果您在 GPL 下发布代码并接受贡献，则包含这些贡献的代码的任何分支都是 GPL 许可给您的。这就是例如 Sun 要求将任何对 MySQL 的贡献的版权分配给他们的原因之一，这样他们就不会属于 GPL 许可并且能够对 MySQL 进行双重许可。

2.  GPL 许可仅适用于您的代码，不适用于使用该代码处理的数据。例如，如果您正在编写 CMS，您可以 GPL 源代码，但发布的内容是在作者选择的任何许可下。因此，AdSense 是一种内容，因此 GPL 不应适用于它。

3.  从广义上讲，根据 GPL 许可产品并不禁止任何人以金钱为目的出售该产品。它只是声明，被许可人必须免费向获得最终产品的人提供源代码（或者如果以 CD 形式发送，则收取少量费用以支付费用，但没有利润）。

免责声明：我不是律师。您应该咨询版权律师，了解根据 GPL 许可某些内容的实际法律影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T23:52:11.267

是的，如果您在 GPL 风格的许可下发布代码，您可以在您的网站上运行 adsense。GPL 或 LGPL 中没有任何条款阻止您通过代码赚钱。

从广义上讲，这些限制表明，如果您选择在 GPL/LGPL 许可下发布代码，则必须给其他人使用您的代码的相同机会。

免责声明：我不是律师等。

# php - 什么因素使 PHP Unicode 不兼容？

> ID：571694
> 
> 赞同：43
> 
> 时间：2009-02-20T23:48:56.253
> 
> 标签：php, unicode

我可以在我的脚本中使用 UTF-8 字符。

事实上[，变量和函数的名称可以包含 Unicode 字符](http://www.script-tease.net/utfthis.php)。

还有处理多字节字符串的[mb_string 扩展](http://us.php.net/mb_string)，但在无数文章中，PHP 因缺乏 Unicode 支持而受到批评。

我不明白；为什么说 PHP 不支持 Unicode？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-20T23:56:31.837

几年前 PHP 刚开始的时候，UTF-8 并没有真正得到支持。我们谈论的是一个像 Windows 98/Me 这样的非 Unicode 操作系统仍然流行的时代，而像 Delphi 这样的其他大型语言也是非 Unicode 的时候。从第一天起，并非所有语言的设计都考虑到了 Unicode，并且在不破坏很多东西的情况下将您的语言完全更改为 Unicode 是很困难的。例如，Delphi 在一两年前才开始兼容 Unicode，而 Java 或 C# 等其他语言从第一天开始就采用 Unicode 设计。

因此，当 PHP 发展并成为 PHP 3、PHP 4 和现在的 PHP 5 时，根本没有人决定添加 Unicode。为什么？大概是为了与现有脚本保持兼容，或者因为 utf8_de/encode 和 mb_string 已经存在并且可以工作。我不确定，但我坚信这与有机增长有关。功能并不是默认存在的，它们必须由某人编写，而这对于 PHP 来说还没有发生。

编辑：好的，我读错了问题。问题是：字符串如何在内部存储？如果我输入“Währung”或“Écriture”，使用哪种编码来创建使用的字节？对于 PHP，它是带有代码页的 ASCII。这意味着：如果我使用 ISO-8859-15 对字符串进行编码，然后使用一些中文代码页对其进行解码，则会得到奇怪的结果。另一种选择是在 C# 或 Java 等语言中，所有内容都存储为 Unicode，这意味着：不再有代码页，理论上你不能搞砸。我推荐[乔尔的文章](http://www.joelonsoftware.com/articles/Unicode.html)关于 Unicode 和字符集，但本质上归结为：字符串是如何在内部存储的，而 PHP 的答案是“不在 Unicode 中”，这意味着在处理字符串时必须非常小心和明确，以确保始终在输入、存储（数据库）和输出过程中将字符串保持在正确的编码中，这很容易出错。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2011-04-30T06:11:23.927

我认为这主要是文化上的困难，而不是技术上的困难。

至于技术问题——在一个建立在“一个字符等于一个字节”的假设之上的生态系统中实现 unicode 并不是一件容易的事——开发人员可能已经复制了 java 或 python 的大部分工作（后者自 2001 年左右以来，具有良好且大部分工作的 unicode 兼容性），但他们从未这样做过。

当我阅读php[函数](http://php.net/manual/en/function.utf8-encode.php)[的官方当前文档所附的讨论线程`utf8_encode()`](http://php.net/manual/en/function.utf8-encode.php)时，我有一种眩晕的感觉。

首先，调用该函数`utf8_encode()`；但是，文档指出它期望的字符串应该是 ISO-8859-1（又名 latin-1）。那是sooo php，那是80年代。

大多数评论者似乎认为 unicode 是一种负担。有很多建议如何转换“未知内容”的字符串，如何处理“混合编码的字符串”（wtf？），或者处理通常会导致损坏的代码点，因为它们超出了该函数的每四个字节代码点限制。

讨论集中在修正以消除曲线或避免该函数行为的问题部分。对我来说，这就是 php：每个人都只是在做修复，很少有事情是以基本正确的方式实现的。如果你认为这是对我的诽谤，这里有一些花絮：

> 尽管如果文档已经是 UTF-8，这似乎会破坏德语变音符号 [äöü]。

（未能理解 utf-8 在应用两次时无法正常工作）

> 查看 iconv() 函数，它提供了一种将 8859 和可怕的 1252 转换为 UTF8 的方法

（优点：部分 php 开发人员忽略了现有技术；相反，错误的自己的实现）

> 使用 preg_match 来检测是否需要 utf8_encode [...] 不包括代理项 [...] 不包括 overlongs

（建议默默地从字符串中删除所有有问题的内容，只留下那些不会中断的内容`utf8_encode()`；这可能会使文本不可读（或完全消失），但是嘿，没有更多的错误消息）

> 仅当字符串还不是 UTF-8 [...] 时才对字符串进行编码`mb_detect_encoding($s, "UTF-8")`

[（正如另一位评论者](http://www.php.net/manual/en/function.mb-detect-encoding.php#102510)所指出的，这是行不通的：

```
$str = 'áéóú'; // ISO-8859-1
mb_detect_encoding($str, 'UTF-8'); // 'UTF-8'
mb_detect_encoding($str, 'UTF-8', true); // false 
```

所以在这里我们正在研究一个错误被另一个错误所取代。快乐的狩猎。此外，他们似乎在这里提出的是使用启发式（缓慢，不确定）手段解决问题，可以而且应该用机械（快速，确定）手段解决）

> utf8_[encode|decode] 实际上也将转换 windows-1252 字符，而不仅仅是文档说的从/到 ISO-8859-1

（你永远不能依赖官方的 php 文档来清晰或详尽——你必须始终阅读多年的用户经验，没有人会反馈给文档）

> 我一直在研究 is_utf8 函数并想在这里发布它，除此之外我还考虑了 5000 char 错误

（修复了很大程度上仅因为 unicode 未正确实现而存在的问题。我们还了解到，该函数不仅会`utf8_encode()`放弃每个代码点超过 4 个字节，而且如果结果（或输出？）文本超过限制，它也会中断5000 个字符）

我可以继续这样下去。你已经明白了：从这个线程来看，php 社区听起来根本不像他们准备好掌握编码和字符集的全部内容，一般来说构建健全的基础设施需要什么，或者具体来说，以适当的方式实现 unicode。相反，他们使用他们的脚手架、他们的纸板、他们的钉子和锤子，继续建造这座名为 php 的宏伟大厦，将他们的胶带扔到每一个用另一个钉子无法解决的问题上。当然，那栋建筑会受到每一次吹来的风的影响，例如偶尔合法但出乎意料的角色。

看到这个特定的线程活跃了八年并不能完全灌输信心，从现在起八年内情况会好转。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-26T18:12:26.620

“多字节字符”的概念是问题的核心。

1.  它泄露了一个实现细节：您应该能够在不知道实现者如何选择表示数据的情况下使用字符的抽象 - 可能取决于适合他们将所有内容表示为 UTF16 或 UTF32 的平台，在这种情况下，一切都是多字节，不是字符抽象的用户应该关心的。
2.  这是一个混乱：除了我们都“真正知道”字符串是字节序列的过时思维习惯之外，我们现在必须知道，有时字节会聚集在一起形成称为 Unicode 字符的东西，并且具有特殊的各地的案件都来处理。
3.  就像老鼠想吃大象一样。通过将 Unicode 构建为 ASCII 的扩展（我们有普通的字符串，我们有 mb_strings），它会让事情变得错误，并且在处理需要超过一个字节的有趣曲线的字符时需要什么特殊情况。如果您将 Unicode 视为为您需要的任何字符提供抽象空间，则 ASCII 可以容纳在其中，无需将其视为特殊情况。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-21T00:10:06.107

您自己说：为了正确处理包含多字节字符的字符串，您需要使用扩展名。忘记在任何地方使用扩展功能而不是更熟悉的“正常”功能，您的数据就会被破坏。如果您使用尚未更新的第三方库以在任何地方使用扩展功能，也会发生同样的情况。

此外， PHP仍然明确*不支持一些*[非常流行的编码](http://us3.php.net/manual/en/mbstring.php4.req.php)，大概是因为这样做并保持向下兼容是不可能的。

 ** * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-21T00:25:55.273

许多常见的扩展不支持 unicode，或者（更糟糕的是）您“需要知道”字符串包含 unicode/utf-8 序列，例如 XMLReader。PHP 的 glob() 在 win32 上调用 FindFirstFileA 或 FindFirstFileW 会产生很大的不同。
另一个（小得多但令人惊讶地经常成为烦恼的根源）问题是 PHP 无法识别的 BOM。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-21T00:28:51.273

许多字符串函数只是 C 库等价物的薄包装，它也将所有内容视为字节序列。另一个原因是 PHP 携带了许多不必要的向后兼容包袱，因此陷入了来自 3&4 的糟糕设计决策。

也许有了 5.3 的命名空间，他们最终将有办法逐步淘汰旧功能。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-21T00:06:29.267

“支持”的意思是“原生支持”。查看[此](http://acko.net/blog/unicode-in-php)内容以获取详细信息。

# c# - 以可变帧率写入视频帧

> ID：571700
> 
> 赞同：1
> 
> 时间：2009-02-20T23:52:02.360
> 
> 标签：c#, wpf, video, frame-rate

我正在使用[AVIFile Wrapper](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)从我的 WPF 应用程序创建视频。我正在使用 CompositionTarget 为每一帧抓取一张图像，但我遇到了帧率问题。由于我的应用程序因数据负载过重而速度变慢，因此 CompositionTarget 帧速率下降。使用较少的视频帧，当我播放这些部分时，这些部分显示为快进。

是否有允许我使用可变帧率的视频格式/库，或者我可以修复 WPF 帧率以便我不会丢帧？

编辑 -> AVI 中的帧没有与之关联的时间码，其他视频格式有吗？有这样做的标准方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-14T18:07:41.647

使用 AVI 文件执行此操作的标准方法是为每个跳过的样本写出一个大小为零的视频帧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T01:40:56.310

您链接到的页面在“从视频和声音复制剪辑”下提供了有关设置可变帧速率的信息，但这没有提供有关将时间码与帧相关联的任何信息。

# c# - WPF：类的数据模板

> ID：571705
> 
> 赞同：0
> 
> 时间：2009-02-20T23:53:32.530
> 
> 标签：c#, wpf, datatemplate

我有这个 XAML：

```
<UserControl x:Class="M_Cubed.Controls.TagEditor"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:classes="clr-namespace:M_Cubed.Classes">
    <UserControl.Resources>
        <DataTemplate DataType="{x:Type classes:TagEditorPic}">
            <ComboBox DataContext="{StaticResource PicTypes}"
                ItemsSource="{Binding}"/>
        </DataTemplate>
    </UserControl.Resources>
</UserControl> 
```

我有这个 C#：

```
namespace M_Cubed.Classes
{
     public class TagEditorPic : INotifyPropertyChanged
     {
          public TagEditorPic() { }
     }
} 
```

我得到这个错误：

类型引用找不到名为“TagEditorPic”的公共类型。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T00:25:53.590

这是因为您没有实现 INotifyPropertyChanged。如果你实现它，那么你的控件将编译。

它找不到控件，因为它首先无法编译 TagEditorPic 类。由于这不是一个可行的类，XAML 解析器不知道该做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T01:01:28.823

根据您的 Visual Studio 版本，您可能会得到陈旧的程序集。

尝试运行 Build -> Clean Solution，然后 Rebuild Solution。

如果这不起作用，请尝试重新启动 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T01:43:06.510

我决定只在数据模板上设置 x:Key 属性，然后将模板属性向前绑定到 x:Key 的 StaticResource。它对我很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T14:48:08.757

类`TagEditorPic`在同一个程序集中吗？否则，您需要像这样指定它：

```
xmlns:classes="clr-namespace:M_Cubed.Classes;assembly=myassembly" 
```

# c# - 将线程安全访问方法写入 Windows 窗体控件的最短方法

> ID：571706
> 
> 赞同：27
> 
> 时间：2009-02-20T23:54:15.477
> 
> 标签：c#, thread-safety

在本文中：

[http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx)

作者使用以下方法对 Windows 窗体控件进行线程安全调用：

```
private void SetText(string text)
{
    // InvokeRequired required compares the thread ID of the
    // calling thread to the thread ID of the creating thread.
    // If these threads are different, it returns true.
    if (this.textBox1.InvokeRequired)
    {    
        SetTextCallback d = new SetTextCallback(SetText);
        this.Invoke(d, new object[] { text });
    }
    else
    {
        this.textBox1.Text = text;
    }
} 
```

有没有更短的方法来完成同样的事情？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-21T00:04:55.527

**C# 3.0 及更高版本：**

扩展方法通常是要走的路，因为您总是希望对[`ISynchronizeInvoke`接口](http://msdn.microsoft.com/en-us/library/system.componentmodel.isynchronizeinvoke.aspx)实现执行操作，这是一个很好的设计选择。

您还可以利用[匿名方法](http://msdn.microsoft.com/en-us/library/0yw3tz5k%28v=vs.80%29.aspx)（闭包）来解决您不知道将哪些参数传递给扩展方法的事实；关闭将捕获所需的一切状态。

```
// Extension method.
static void SynchronizedInvoke(this ISynchronizeInvoke sync, Action action)
{
    // If the invoke is not required, then invoke here and get out.
    if (!sync.InvokeRequired)
    {
        // Execute action.
        action();

        // Get out.
        return;
    }

    // Marshal to the required context.
    sync.Invoke(action, new object[] { });
} 
```

然后你会这样称呼它：

```
private void SetText(string text)
{
    textBox1.SynchronizedInvoke(() => textBox1.Text = text);
} 
```

在这里，闭包在`text`参数之上，该状态被捕获并作为传递给扩展方法的[`Action`委托的一部分传递。](http://msdn.microsoft.com/en-us/library/system.action.aspx)

**在 C# 3.0 之前：**

您没有 lambda 表达式的奢侈，但您仍然可以概括代码。它几乎相同，但不是扩展方法：

```
static void SynchronizedInvoke(ISynchronizeInvoke sync, Action action)
{
    // If the invoke is not required, then invoke here and get out.
    if (!sync.InvokeRequired)
    {
        // Execute action.
        action();

        // Get out.
        return;
    }

    // Marshal to the required context.
    sync.Invoke(action, new object[] { });
} 
```

然后你用匿名方法语法调用它：

```
private void SetText(string text)
{
    SynchronizedInvoke(textBox1, delegate() { textBox1.Text = text; });
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-21T00:17:59.490

1) 使用匿名委托

```
private void SetText(string text)
{
    if (this.InvokeRequired)
    {    
        Invoke(new MethodInvoker(delegate() {
            SetText(text);
        }));
    }
    else
    {
        this.textBox1.Text = text;
    }
} 
```

2）AOP方法

```
[RunInUIThread]
private void SetText(string text)
{
    this.textBox1.Text = text;
} 
```

[http://weblogs.asp.net/rosherove/archive/2007/05.aspx?PageIndex=2](http://weblogs.asp.net/rosherove/archive/2007/05.aspx?PageIndex=2)

3) 使用 lambda 表达式（由其他人概述）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-21T00:00:24.430

编辑：我应该提到我不认为这是最佳实践

如果您使用的是 3.5，您可以制作一个扩展方法，效果如下：

```
public static void SafeInvoke(this Control control, Action handler) {
    if (control.InvokeRequired) {
        control.Invoke(handler);
    }
    else {
        handler();
    }
} 
```

这基本上取自：[这里](http://keithhill.spaces.live.com/blog/cns!5A8D2641E0963A97!765.entry)

然后像这样使用它：

```
textBox1.SafeInvoke(() => .... ); 
```

当然，根据您的用途修改扩展名等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-07T14:44:29.020

这对大多数人来说可能很明显，但是如果您需要检索值，您可以采用接受的答案并添加另一种方法......

```
public static T SynchronizedFunc<T>(this ISynchronizeInvoke sync, Func<T> func)
{
    if (!sync.InvokeRequired)
    {
        // Execute the function
        return func();
    }

    // Marshal onto the context
    return (T) sync.Invoke(func, new object[] { });
} 
```

我最近用它来以线程安全的方式处理表单......

```
var handle = f.SynchronizedFunc(() => f.Handle); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-16T20:38:29.177

我找到的最短解决方案显示在下面的按钮示例中，目标是更改按钮的文本。

```
 if (buttonX.InvokeRequired)
        buttonX.Invoke((Action)(() => buttonX.Text = "Record"));
    else
        buttonX.Text = "Record"; 
```

# php - 在 PHP 代码库中查找所有字符串

> ID：571734
> 
> 赞同：4
> 
> 时间：2009-02-21T00:08:34.317
> 
> 标签：php, string

我有几百万行的 PHP 代码库**，没有**真正分离显示和逻辑，我试图提取代码中表示的所有字符串以进行本地化。显示和逻辑的分离是一个长期目标，但现在我只想能够本地化。

在代码中，字符串以 PHP 的每种可能格式表示，因此我需要一种理论（或实际）方法来解析我们的整个源代码，并且至少要找到每个字符串所在的位置。理想情况下，当然，我会用函数调用替换每个字符串，例如

```
“这是一个字符串”
```

将被替换为

```
_("这是一个字符串")
```

当然，我需要同时支持单引号和双[引号格式](http://php.net/manual/en/language.types.string.php)。其他我不太关心的，它们出现的频率很低，我可以手动更改它们。

另外，我当然不想本地化数组索引。所以像这样的字符串

```
$arr[“价值”]
```

不应该成为

```
$arr[_("值")]
```

谁能帮我开始做这件事？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-21T00:23:03.190

您可以使用[`token_get_all()`](http://uk3.php.net/manual/en/function.token-get-all.php)从 PHP 文件中获取所有令牌，例如

```
<?php

$fileStr = file_get_contents('file.php');

foreach (token_get_all($fileStr) as $token) {
    if ($token[0] == T_CONSTANT_ENCAPSED_STRING) {
        echo "found string {$token[1]}\r\n";
        //$token[2] is line number of the string
    }
} 
```

您可以通过以下方式进行非常脏的检查，以确保它没有被用作数组索引：

```
$fileLines = file('file.php');

//inside the loop and if
$line = $fileLines[$token[2] - 1];
if (false === strpos($line, "[{$token[1]}]")) {
    //not an array index
} 
```

但是你真的很难正确地做到这一点，因为有人可能写了一些你可能没想到的东西，例如：

```
$str = 'string that is not immediately an array index';
doSomething($array[$str]); 
```

* * *

**编辑**正如 Ant P 所说，对于这个答案的第二部分 ，你可能会更好地寻找`[`和 在周围的标记中，而不是我的hack，如下所示：`]``strpos`

```
$i = 0;
$tokens = token_get_all(file_get_contents('file.php'));
$num = count($tokens);
for ($i = 0; $i < $num; $i++) {
    $token = $tokens[$i];

    if ($token[0] != T_CONSTANT_ENCAPSED_STRING) {
        //not a string, ignore
        continue;
    }

    if ($tokens[$i - 1] == '[' && $tokens[$i + 1] == ']') {
        //immediately used as an array index, ignore
        continue; 
    }

    echo "found string {$token[1]}\r\n";
    //$token[2] is line number of the string
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T00:53:34.523

除了关联数组之外，还有一些其他情况可能存在于代码库中，您将通过执行自动搜索和替换来彻底破坏这些情况。

SQL 查询：

```
$myname = "steve";
$sql = "SELECT foo FROM bar WHERE name = " . $myname; 
```

间接变量引用。

```
$bar = "Hello, World"; // a string that needs localization
$foo = "bar"; // a string that should not be localized
echo($$foo); 
```

SQL 字符串操作。

```
$sql = "SELECT CONCAT('Greetings, ', firstname) as greeting from users where id = ?"; 
```

没有自动过滤所有可能性的方法。也许解决方案是编写一个应用程序，该应用程序创建一个可能字符串的“审核”队列，并在多行代码的上下文中突出显示每个字符串。然后，您可以查看代码以确定它是否是需要本地化的字符串，然后单击一个键来本地化或忽略该字符串。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-02-21T00:26:32.293

与其尝试通过使用 perl 或 grep 的过于聪明的命令行 hack 来解决这个问题，不如编写一个程序来执行此操作:)

编写一个 perl/python/ruby/whatever 脚本在每个文件中搜索一对单引号或双引号。每次找到匹配项时，它都会提示您用下划线函数替换它，您可以告诉它这样做或跳到下一个。

在一个完美的世界里，你会写一些可以为你做这一切的东西，但这最终可能会花费更少的时间，并且你会面临更少的错误。

伪：

```
for fname in yourBigFileList:
    create file handle for actual source file
    create temp file handle (like fname +".tmp" or something)
    for fline in fname:
        get quoted strings
        for qstring in quoted_strings:
            show it in context, i.e. the entire line of code.
            replace with _()?
                if Y, replace and write line to tmp file
                if N, just write that line to the tmp file
    close file handles
    rename it to current name + ".old"
    rename ".tmp" file to name of orignal file 
```

我确信有一种更 *nix-fu 的方法可以做到这一点，但这种方法可以让您自己查看每个实例并做出决定。如果它是一百万行，并且每一行都包含一个字符串，并且每一行都需要你 1 秒的时间来评估，那么你将需要大约 270 个小时来完成整个事情......也许你应该忽略这篇文章 :)

# peoplesoft - 您如何配置 PeopleSoft 测试环境？

> ID：571741
> 
> 赞同：1
> 
> 时间：2009-02-21T00:12:27.787
> 
> 标签：peoplesoft

您在测试环境中更改了哪些项目以使其在生产环境中脱颖而出，您如何进行这些更改？我知道您可以更改 PS LOGO，但是您在测试环境中还有哪些更改？颜色、字体等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T00:45:22.623

更改配色方案并不太难。如果您想走这条路并需要帮助，我很乐意为您提供帮助。

其他客户端只是将环境名称放在 PIA Greeting 中。这也很容易： http: [//peoplesofttipster.com/2007/06/13/using-the-pia-welcome-message/](http://peoplesofttipster.com/2007/06/13/using-the-pia-welcome-message/)

不过，我还没有听说有人更改字体。

亲切的问候

邓肯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-05T01:18:58.373

这是我们所做的相对较小的更改，将工具栏中的“Home”链接替换为环境的名称，但 prod。它还被合并到刷新脚本中以动态地拉入 DBNAME。

更新 psmsgcatdefn set message_text = 'DBNAME', descrlong = '环境名称主页替换' where message_set_nbr = '95' and message_nbr = '401';

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T04:14:16.263

刷新 db 时，请确保更改具有 dbname、web url 等的工具表。测试数据库名称将出现在门户菜单中。

更改字体将需要更改所有样式表定义，这是一个令人头疼的问题。我想你可以在应用程序设计器 PS_TEXT 等中编辑一些基本的样式表属性。并在测试环境中更改它们。也许只是改变一些就足够了。

大多数测试环境也在某种程度上开放了安全性，仅仅是因为测试人员和开发人员可能需要访问所有内容。因此，人们的菜单将比生产中的要大得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-14T18:58:38.450

需要注意的项目：

*   文件路径 - 如果您打开文件进行读取，尤其是写入，以与外部系统通信，那么您需要确保您没有踩到生产环境。

*   我会假设 Web 服务也需要相同的重新路由，因此您不会“点击”实时外部生产 Web 服务。

*   电子邮件。工作流或其他子系统可能会向用户或外部方发送电子邮件。您需要确保这些电子邮件是测试人员的电子邮件，而不是真正的收件人。

# perl - 如何使用 Perl 提供大文件以供下载？

> ID：571744
> 
> 赞同：7
> 
> 时间：2009-02-21T00:13:46.613
> 
> 标签：perl, file-io, download

我需要提供一个大文件 (500+ MB) 以便从 Web 服务器无法访问的位置下载。我发现了[Serving large files with PHP](https://stackoverflow.com/questions/432713/serving-large-files-with-php)的问题，这与我的情况相同，但我使用的是 Perl 而不是 PHP。

我尝试简单地逐行打印文件，但这不会导致浏览器在获取整个文件之前提示下载：

```
use Tie::File;

open my $fh, '<', '/path/to/file.txt';
tie my @file, 'Tie::File', $fh
    or die 'Could not open file: $!';
my $size_in_bytes = -s $fh;
print "Content-type: text/plain\n";
print "Content-Length: $size_in_bytes\n";
print "Content-Disposition: attachment; filename=file.txt\n\n";
for my $line (@file) {
    print $line;
}
untie @file;
close $fh;
exit; 
```

Perl 是否具有与 PHP 的功能等效的`readfile()`功能（如 PHP 所建议的那样），还是有办法完成我在这里尝试做的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T02:52:16.313

如果您只想将输入输出到输出，这应该可以解决问题。

```
use Carp ();

{ #Lexical For FileHandle and $/ 
  open my $fh, '<' , '/path/to/file.txt' or Carp::croak("File Open Failed");
  local $/ = undef; 
  print scalar <$fh>; 
  close $fh or Carp::carp("File Close Failed");
} 
```

我想是为了回应“Perl 是否有一个 PHP ReadFile Equivelant”，我想我的答案是“但它并不真的需要一个”。

我使用了 PHP 的手动文件 IO 控件，但它们很痛苦，相比之下，Perls 非常易于使用，以至于为一个万能的函数而掏腰包似乎有点过头了。

此外，您可能想查看`X-SendFile`支持，基本上向您的网络服务器发送一个标头，告诉它要发送什么文件：http: [//john.guen.in/past/2007/4/17/send_files_faster_with_xsendfile/](http://john.guen.in/past/2007/4/17/send_files_faster_with_xsendfile/) （当然假设它有足够的权限访问该文件，但该文件通常不能通过标准 URI 访问）

*编辑*注意，*最好*循环执行，我用硬盘测试了上面的代码，它确实隐式地尝试将整个东西存储在一个不可见的临时变量中并吃掉你所有的内存。

## 替代使用块

以下改进的代码以 8192 个字符为单位读取给定文件，这样内存效率更高，并且吞吐量与我的磁盘原始读取率相当。（我还把它指向 /dev/full 以适应和咯咯笑，并获得了健康的 500mb/s 吞吐量，它并没有吃掉我所有的公羊，所以那一定很好）

```
{ 
    open my $fh , '<', '/dev/sda' ; 
    local $/ = \8192; # this tells IO to use 8192 char chunks. 
    print $_ while defined ( $_ = scalar <$fh> ); 
    close $fh; 
} 
```

## 应用 jrockways 建议

```
{ 
    open my $fh , '<', '/dev/sda5' ; 
    print $_ while ( sysread $fh, $_ , 8192 ); 
    close $fh; 
} 
```

这实际上使性能翻了一番，……在某些情况下，我得到的吞吐量比 DD 做的 O_o 更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T00:27:29.217

调用 readline 函数`readline`（也可以写成 `<>`）。

我不确定你遇到了什么问题。也许 for 循环不会被延迟评估（它们不是）。或者，也许 Tie::File 搞砸了？无论如何，一次读取一行文件的惯用 Perl 是：

```
open my $fh, '<', $filename or die ...;
while(my $line = <$fh>){
   # process $line
} 
```

无需使用 Tie::File。

最后，你不应该自己处理这种事情。这是 Web 框架的工作。如果您使用的是 [Catalyst](http://www.catalystframework.org/)（或 [HTTP::Engine](http://search.cpan.org/perldoc?HTTP::Engine)），您只需说：

```
open my $fh, '<', $filename ...
$c->res->body( $fh ); 
```

并且框架将自动有效地提供文件中的数据。（在这里通过 readline 使用 stdio 不是一个好主意，最好从磁盘中读取块中的文件。但谁在乎，它是抽象的！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T12:25:34.857

你可以使用我的[Sys::Sendfile](http://search.cpan.org/perldoc?Sys::Sendfile)模块。它应该是高效的（因为它在底层使用 sendfile），但不是完全可移植的（目前仅支持 Linux、FreeBSD 和 Solaris）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T00:28:53.113

回答（原始）问题（“Perl 是否具有与 PHP 的函数等价的`readline()`功能......？”），答案是“尖括号语法”：

```
open my $fh, '<', '/path/to/file.txt';
while (my $line = <file>) {
    print $line;
} 
```

但是，使用这种方法获取内容长度并不一定容易，所以我建议使用`Tie::File`.

* * *

**笔记**

使用：

```
for my $line (<$filehandle>) { ... } 
```

（正如我最初写的那样）将文件的内容复制到一个列表并对其进行迭代。使用

```
while (my $line = <$filehandle>) { ... } 
```

才不是。在处理小文件时差异并不显着，但在处理大文件时绝对可以。

* * *

回答（更新的）问题（“Perl 是否有与 PHP 的函数等价的`readfile()`功能……？”），答案是[slurping](http://search.cpan.org/dist/Perl6-Slurp/Slurp.pm#DESCRIPTION)。有[几种语法](http://www.perl.com/pub/a/2003/11/21/slurp.html)，但`Perl6::Slurp`似乎是当前选择的模块。

隐含的问题（“为什么浏览器在抓取整个文件之前不提示下载？”）与您在文件中的读取方式完全无关，而与浏览器认为好的形式有关。我猜浏览器会看到 mime-type 并决定它知道如何显示纯文本。

* * *

仔细观察 Content-Disposition 问题，我记得 IE 忽略 Content-Disposition 时遇到了类似的问题。不幸的是，我不记得解决方法。 [IE在这里有很长的问题历史](http://www.hanselman.com/blog/TheContentDispositionSagaControllingTheSuggestedFileNameInTheBrowsersSaveAsDialog.aspx)（旧页面，指的是IE 5.0、5.5和6.0）。但是，为了澄清，我想知道：

1.  您使用哪种链接指向这个大文件（即，您使用的是普通`a href="perl_script.cgi?filename.txt`链接还是使用某种 Javascript）？

2.  您使用什么系统来实际提供文件？例如，网络服务器是否在没有网络服务器的情况下自己连接到另一台计算机，然后将文件复制到网络服务器，然后将文件发送给最终用户，或者用户是否直接连接到没有网络服务器的计算机?

3.  在最初的问题中，您写道“这不会导致浏览器在获取整个文件之前提示下载”，在评论中您写道：“在整个下载之前，我仍然没有收到文件的下载提示。” 这是否意味着文件会显示在浏览器中（因为它只是文本），在浏览器下载整个文件后，您会收到“您要在哪里保存此文件”提示或其他提示？

我有一种感觉，HTTP 标头有可能在某些时候被剥离，或者缓存控制标头正在被添加（这显然会导致麻烦）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T20:42:19.140

当您说“这不会导致浏览器提示下载”时，“浏览器”是什么？

不同的浏览器表现不同，IE特别任性，它会忽略header，根据读取文件的前几kb自行决定做什么。

换句话说，我认为您的问题可能出在客户端，而不是服务器端。

尝试对“浏览器”撒谎并告诉它文件类型为 application/octet-stream。或者为什么不直接压缩文件，尤其是因为它太大了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T11:12:19.573

不要使用`for/foreach (<$input>)`，因为它会一次读取整个文件，然后对其进行迭代。改为使用`while (<$input>)`。`sysread`解决方案很好，但在性能`sendfile`方面是最好的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T17:34:28.250

我通过告诉浏览器它是 application/octet-stream 类型而不是 text/plain 类型来成功完成它。显然大多数浏览器更喜欢显示 text/plain inline 而不是给用户一个下载对话框选项。

从技术上讲，它对浏览器撒谎，但它确实完成了工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T21:23:04.800

提供大文件下载的最有效方式取决于您使用的网络服务器。

### 除了[@Kent Fredric的`X-Sendfile`建议](https://stackoverflow.com/questions/571744/how-do-i-serve-a-large-file-for-download-with-perl/572014#572014)：

[File Downloads Done Right](http://www.therailsway.com/2009/2/22/file-downloads-done-right)有一些链接描述了如何为[Apache](http://tn123.ath.cx/mod_xsendfile/)、[lighttpd](http://redmine.lighttpd.net/wiki/lighttpd/Docs:ModSecDownload)（mod_secdownload：通过 url 生成的安全性）、[nginx](http://blog.kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/)执行此操作。Perl 可以采用 PHP、Ruby (Rails)、Python 中的示例。

基本上可以归结为：

1.  为您的网络服务器配置路径和权限。
2.  为您的 Perl 应用程序中的重定向生成有效标头（`Content-Type`、`Content-Disposition`、`Content-length`^?或`X-Sendfile`等`X-Accel-Redirect`）。

There are probably CPAN modules, web-frameworks plugins that do exactly that e.g., [@Leon Timmermans mentioned `Sys::Sendfile` in his answer](https://stackoverflow.com/questions/571744/how-do-i-serve-a-large-file-for-download-with-perl/572891#572891).

# sql-server - 让 SQL Server 更快地处理数据——关闭事务日志？

> ID：571750
> 
> 赞同：17
> 
> 时间：2009-02-21T00:18:15.417
> 
> 标签：sql-server, sql-server-2005

我使用 SQL Server 2005 作为我进行分析工作的大量数据的数据存储。这不是一个事务性数据库，因为我没有更新或捕获实时数据。我从我的客户那里获得了一些数据，将它们加载到 SQL Server 中并进行一系列操作。然后我抓取这些数据的一部分并将它们拉入我进行大部分分析的 R 中。然后我将一些数据推送到 SQL Server 中的表中，并可能进行一两次连接。

我有一段时间 SQL Server 中的日志越来越大，我认为创建这些日志需要一定程度的开销。如何配置 SQL Server 使其运行时很少或没有日志记录？如果事情变得腐败，我很乐意从头开始。任何想法如何使这一切更快？

顺便说一句，无需告诉我如何缩小日志，我已经在这样做了。但我希望我不必首先制作日志。我只使用数据库来存放数据，因为它太大而无法放入 R 中的内存。

我应该使用比 Sql Server 更简单的数据库吗？随意告诉我，我正在用大锤杀死一只蚂蚁。但请推荐一个更合适尺寸的锤子。:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-21T00:22:15.407

> 如何配置 SQL Server 使其运行时很少或没有日志记录？一世

我不相信你可以。

但是，如果您为简单备份配置数据库（服务器上的每个数据库可以不同），则日志文件在您备份之前不会增长。这是通过将恢复模式设置为“简单”来完成的。

对于简单的备份，日志仅用于保存事务的状态，直到它们完全写入主数据库。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-05-25T13:54:11.217

在处理大型数据集时避免记录的一种方法是使用 SELECT/INTO。它将创建一个新表，但不会记录任何表。

在执行此操作时需要注意一些事项：

*   计算列成为常规数据列
*   也需要建立索引和标识列

如果处理得当，它不仅可以节省空间，还可以节省处理时间。

另一种方法类似于我现在正在做的事情，例如：

```
UPDATE [MyTable] 
SET    [Message] = REPLACE([Message], N'Content_Type', N'Content-Type') 
```

工作正常，但更新整个表创建一个巨大的事务集，而不是你可以这样做：

```
DECLARE @IDs TABLE ([id] int)
DECLARE @Batch TABLE ([id] int)

INSERT INTO @IDs ([ID]) SELECT [ID] FROM [MyTable]

WHILE EXISTS (SELECT TOP 1 [ID] FROM @IDs)
BEGIN
  INSERT INTO @Batch ([ID]) SELECT TOP 1000 [Id] FROM @IDS

  UPDATE [MyTable] 
  SET    [Message] = REPLACE([Message], N'Content_Type', N'Content-Type') 
  WHERE  [Id] IN (SELECT [Id] FROM @Batch)

  DELETE @IDs WHERE [Id] IN (SELECT [Id] FROM @Batch)
  DELETE @Batch
END 
```

这会一次更新表 1,000 行，从而降低事务大小。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-21T00:37:49.847

您可以通过更改数据库恢复模式来最大限度地减少 SQL 服务器中的日志消耗，请参阅此[链接](http://msdn.microsoft.com/en-us/library/aa173531.aspx)。由于您不处理并发和事务，您是否考虑过 Microsoft Access？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T18:37:26.783

关闭事务日志不会使 SQL Server 几乎快得多，但可以通过其他人已经建议的简单或批量日志恢复模式来减小日志大小。

我对此的看法是，您永远不应该打开完全恢复模式，除非在绝对不需要的情况下像您这样的特殊情况。

这样做的主要原因是，在您没有备份或所有数据不在备份中的意外执行 UPDATE、DELETE 或 TRUNCATE 的情况下，完全恢复中的事务日志可能是您恢复的唯一希望。

关于这个主题有几个线程，其中读取事务日志是恢复的最后希望。

[如何在 SQL Server 2005 中回滚 UPDATE 查询？](https://stackoverflow.com/questions/721471/how-can-i-rollback-an-update-query-in-sql-server-2005/)

[如何撤消 SQL Server 2005 中的删除操作？](https://stackoverflow.com/questions/201524/how-to-undo-a-delete-operation-in-sql-server-2005)

同样，在您的具体情况下，这可能不是问题，但我的猜测是它对其他人有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-21T15:08:21.817

为了最大限度地减少日志记录，请使用简单的恢复模型并分批完成您的工作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-04-08T07:42:44.120

[c#](/questions/tagged/c%23 "显示标记为“c#”的问题") Code using EntityFramework to configure your database like Richards answer描述：

```
using (var dbInstance = new YourEntityFrameworkDB_Context())
{
    var sqlConfigConn = dbInstance.Database.Connection as SqlConnection;
    sqlConfigConn.Open();

    using (var sqlCmd = new SqlCommand())
    {
        sqlCmd.Connection = sqlConfigConn as SqlConnection;
        sqlCmd.CommandText = String.Format("ALTER DATABASE model SET RECOVERY SIMPLE");
        var result = sqlCmd.ExecuteNonQuery();
    }
    sqlConfigConn.Close();
} 
```

要检查它是否成功，只需启动 Management Studio 并运行： ![截图管理工作室](https://i.stack.imgur.com/XrK7G.png)

**编辑 2018 年 2 月**：

关于恢复模型的[MSDN描述](https://docs.microsoft.com/en-us/sql/relational-databases/backup-restore/recovery-models-sql-server)

```
╔══════════╦══════════════════════╦══════════════════════════════════════════╗
║ Recovery ║    Description       ║      Recover to a point in time?         ║
║  model   ║                      ║                                          ║
╠══════════╬══════════════════════╬══════════════════════════════════════════╣
║ Simple   ║ No log backups       ║ Can recover only to the end of a backup. ║
║          ║                      ║                                          ║
║ Full     ║ Requires log backups ║ Can recover to a specific point in time, ║
║          ║                      ║ assuming that your backups are complete  ║
║          ║                      ║ up to that point in time.                ║
║          ║                      ║                                          ║
║ Bulk     ║ Requires log backups ║ Can recover to the end of any backup.    ║
║ logged   ║                      ║                                          ║
╚══════════╩══════════════════════╩══════════════════════════════════════════╝ 
```

# asp.net - asp.net mvc 查看数据

> ID：571753
> 
> 赞同：0
> 
> 时间：2009-02-21T00:19:36.490
> 
> 标签：asp.net, asp.net-mvc

我创建了一个类来保存模型中两种不同类型的视图数据。

```
class FooBarViewData
{
    public List<Foo> Foos { get; set; }
    public List<Bar> Bars { get; set; }
} 
```

我将视图输入到 FooBarViewData，但找不到类型。

```
<%@ Page Title="" 
    Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    Inherits="System.Web.Mvc.ViewPage<FooBarViewData>" %> 
```

我怎样才能让它工作。同样，一旦它起作用，我如何通过 ViewData 集合上的键或其他方式访问 Foo 和 Bar？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T00:22:46.780

您是否尝试指定完整的命名空间？像，错误， MyProject.ViewDTO.FooBarViewData ？

当它注册时，您可以通过视图上的 Model 属性访问您键入的视图数据。这应该有效：

```
<% foreach(Foo foo in Model.Foos) { %>
  <%= Foo.ToString() %>
<% } %> 
```

# oracle - 设置 Oracle Text 以索引 Oracle 表中多个列的值

> ID：571758
> 
> 赞同：7
> 
> 时间：2009-02-21T00:21:47.890
> 
> 标签：oracle, indexing, oracle-text

我有一组描述业主信息的 Oracle 表。对于每个所有者，所有者名称和其他文本值存储在多个相关表的多个字段中。我想索引这些字段的内容。我的目标是提供一个字段，用户可以在其中输入关键字来定位所有者。

如何设置 Oracle Text 来完成此任务？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-22T03:08:33.910

您只需要创建一个多数据存储首选项并将其作为参数传递给索引。

```
begin
ctx_ddl.create_preference('my_multi', 'MULTI_COLUMN_DATASTORE');
ctx_ddl.set_attribute('my_multi', 'columns', 'column1, column2, column3');
end;

create index myindex on mytable(docs) 
  indextype is ctxsys.context 
  parameters ('DATASTORE my_multi'); 
```

[http://download.oracle.com/docs/cd/B19306_01/text.102/b14217/ind.htm#sthref281](http://download.oracle.com/docs/cd/B19306_01/text.102/b14217/ind.htm#sthref281)

# multithreading - 为什么大型程序（例如游戏）不使用大量不同的线程？

> ID：571766
> 
> 赞同：22
> 
> 时间：2009-02-21T00:26:22.200
> 
> 标签：multithreading, concurrency, multicore

我不太了解商业游戏在内部是如何运作的，但我遇到的开源游戏似乎并没有大量使用线程。大多数其他桌面应用程序也是如此，通常似乎使用两个或三个线程（例如程序逻辑和 GUI 更新）。

为什么游戏没有很多线程？例如，物理、声音、图形、AI 等的单独线程？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-21T00:35:19.200

我不知道你玩过哪些游戏，但大多数游戏都在单独的线程上运行声音。网络代码，至少套接字侦听器在单独的线程上运行。

但是，游戏引擎的其余部分通常在单个线程中运行。这是有原因的。例如，游戏中的大多数处理都运行一个依赖链。图形取决于物理引擎的状态，人工智能也是如此。为多线程设计意味着您必须在各个子系统之间设置帧延迟以实现并发。如果这些子系统在每一帧中线性计算，您将获得更快的响应时间和更快的游戏体验。游戏中从并行化中受益最多的部分当然是渲染子系统，它被卸载到高度并行化的图形加速卡上。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-21T00:32:28.240

主要原因是，尽管听起来很优雅，但在像 3D 游戏一样复杂的程序中使用多个线程确实非常非常困难。此外，在最近引入低成本多核系统之前，使用多线程并没有提供太多的性能激励。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-21T01:43:09.987

你需要想一想，线程的实际好处是什么？请记住，在单核机器上，线程实际上并不允许并发执行，只是对它的印象。在幕后，CPU 在不同线程之间进行上下文切换，每次都做一些工作。因此，如果我有几个不涉及等待的任务，并发运行它们（在单个内核上）不会比线性运行它们快。事实上，它会更慢，因为频繁的上下文切换会增加开销。

如果是这样的话，为什么还要在单核机器上使用线程呢？首先，因为有时任务可能需要长时间等待某些外部资源（例如磁盘或其他硬件设备）变得可用。当任务处于等待阶段时，线程允许其他任务继续，从而更有效地利用 CPU 的时间。

其次，任务可能有某种完成的最后期限，特别是当它们响应事件时。典型的例子是应用程序的用户界面。计算机应该尽可能快地响应用户操作事件，即使它正忙于执行一些其他长时间运行的任务，否则用户会变得烦躁并可能认为应用程序已经崩溃。线程允许这种情况发生。

至于游戏，我不是游戏程序员，但我的理解是这样的：3D游戏创造了游戏世界的程序化模型；玩家、敌人、物品、地形等。这个游戏世界会根据自上次更新以来经过的时间以离散的步骤进行更新。因此，如果自上次游戏循环以来已经过去了 1 毫秒，则通过使用其速度和经过的时间来确定 delta 来更新对象的位置（显然物理比这要复杂一些，但你会得到主意）。AI 和输入键等其他因素也可能有助于更新。当一切都完成后，更新的游戏世界被渲染为一个新的帧，这个过程又开始了。这个过程通常每秒发生多次。

当我们以这种方式考虑游戏循环时，我们可以看到引擎实际上正在实现与线程非常相似的目标。它有许多长时间运行的任务（更新世界物理、处理用户输入等），并且通过将它们分解成小块并交错排列，给人的印象是它们是同时发生的，而不是依赖于CPU或操作系统来管理每个花费的时间，它自己做。这意味着它可以保持所有不同的任务正确同步，并避免真正线程带来的复杂性：锁、抢占、重入代码等。这种方法也没有性能影响，因为正如我们所说无论如何，单核机器只能真正线性地执行代码。

当拥有多核系统时，情况会发生变化。现在，任务可以真正并发运行，使用线程来处理游戏世界更新的不同部分确实有好处，只要我们能够设法同步结果以渲染一致的帧。因此，我们预计，随着多核系统的出现，游戏引擎开发人员将致力于此。事实证明，他们是。Valve，Half Life 的制造商，最近在他们的 Source Engine 中引入了多处理器支持，我想许多其他引擎开发人员也会效仿。

嗯，结果比我预期的要长一点。我不是线程或游戏专家，但我希望我没有犯任何特别明显的错误。如果我有我相信人们会纠正我:)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-21T10:04:35.587

如今，许多游戏都在使用“任务”或“作业”系统进行并行处理。也就是说，游戏会产生固定数量的工作线程，用于多个任务。工作被分成小块并排队，然后在工作线程可用时发送给它们进行处理。

这在游戏机上变得尤为普遍。PS3 基于 Cell 架构，因此您需要使用并行处理来获得系统的最佳性能。Xbox 360 可以模拟为 PS3 设计的任务/作业设置，因为它具有多个内核。您可能会发现，对于大多数游戏来说，很多系统设计在 360、PS3 和 PC 代码库之间共享，因此 PC 很可能使用相同的策略。

虽然很难编写线程安全代码，但正如许多其他答案所表明的那样，我认为您所看到的事情还有其他一些原因：

*   首先，许多开源游戏已经有几年历史了。尤其是在这一代控制台中，并行编程正变得流行，甚至是必要的，如上所述。
*   其次，似乎很少有开源项目关心获得尽可能高的性能。正如 John Carmack 在犹他州 GLX 项目中指出的那样，高度优化的代码通常比未优化的代码更难维护，因此后者通常在开源环境中更受欢迎。
*   第三，我不会认为游戏创建的少量线程意味着它没有很好地使用并行作业。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T00:39:16.227

我正要发布与威廉相同的内容，但我想稍微扩展一下。为未来编写最佳代码非常困难。考虑到编写可以扩展到您没有的硬件的东西与编写可以在您拥有的硬件上运行的东西之间的选择，大多数人会选择后者。由于单核范式已经存在了很长时间，因此大多数已编写的代码（尤其是对于有极大压力的游戏）都不是未来的证明。

x86 对游戏程序员非常友好，因为我们不必考虑不太宽容的硬件平台的后果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-21T01:31:40.513

除了多核编程的技术挑战之外，商业游戏必须在没有多核的低端系统上运行良好才能赚钱。

既然多核处理器已经出现了一段时间，并且主要的游戏机都有多核，那么双核出现在 PC 游戏的最低系统要求列表中只是时间问题。

这是来自英特尔[的 Orion Granatir 采访](http://www.gamasutra.com/view/feature/3838/sponsored_feature_an_interview_.php)的链接，他谈到让游戏开发人员利用多线程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T01:34:05.580

这里的每个人都正确地声称多线程很难，这一事实非常可悲。我们迫切需要简化并发系统。

我个人认为我们将需要范式转变和新工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T00:37:09.833

使用大量线程时，竞争条件和数据锁定存在许多问题。由于游戏的不同部分相互依赖，因此进行使用大量线程所需的所有额外工程没有多大意义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-21T00:49:08.650

毫无问题地使用线程是非常困难的，而且大多数 GUI API 无论如何都是基于事件驱动的编码。线程要求使用锁定机制，这会增加代码的延迟，并且该延迟通常是不可预测的，具体取决于当前持有锁的人。

对我来说，让单个（或者可能很少）线程以事件驱动的方式处理事物而不是数百个线程都导致奇怪和不可重复的错误似乎是明智的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-16T04:44:44.997

线程已经死了，宝贝。

实际上，在游戏开发中，线程除了卸载非常专用的任务（如网络和加载）之外，并没有扩展。作业系统似乎是唯一的出路，因为 8 CPU 系统甚至在 PC 上也变得越来越普遍。而且您几乎可以保证即将推出的超多核系统（如英特尔的[Larrabee](http://en.wikipedia.org/wiki/Larrabee_(GPU)) ）将基于作业系统。

这对于 Playstation3 和 XBOX360 项目来说是一个有点痛苦的认识，现在看来，甚至苹果公司也加入了他们在雪豹中的“革命性”[中央调度系统。](http://images.apple.com/macosx/technology/docs/GrandCentral_TB_brief_20090608.pdf)

线程有它们的位置，但是“把所有东西都放在一个线程中，它会运行得更快”的天真承诺在实践中根本行不通。

# php - 在网站上显示 pdf

> ID：571771
> 
> 赞同：4
> 
> 时间：2009-02-21T00:28:18.593
> 
> 标签：php, pdf

我们想在网页上显示一个 pdf 文件。根据我的想法，我看到了两种可能的解决方案，使用某种 pdf 阅读器（可能在 flash 中？）显示文件或在显示之前将 pdf 文件转换为 html。

你将如何着手解决这样的问题？哪种方法更可取？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-21T00:30:28.900

好吧，总有第三种方式：提供 PDF 本身，其余的留给访问者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T00:32:52.497

对于公共网站，您可以通过使用以下文档共享服务之一将 PDF 文档嵌入页面来改善用户体验并减少带宽开销：

[http://www.scribd.com](http://www.scribd.com)

[http://www.docstoc.com](http://www.docstoc.com)

我还应该补充一点，scribd 还有一个用于上传文档（以及更多）的 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T18:14:11.640

如果您绝对需要在浏览器中显示 PDF，您可以使用 FlashPaper。它作为打印机安装在 Windows 上，并允许您将任何类型的文档转换为嵌入 HTML 中的 SWF。

我已经在几个项目中使用过它，但这不是一个理想的解决方案。从用户的角度来看，最好的办法是能够下载 PDF 并使用她最喜欢的 PDF 查看器阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T20:59:51.820

尝试使用 embed 或 object html 标签。

[http://blog.flashcolony.com/?p=244](http://blog.flashcolony.com/?p=244)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T00:32:35.960

就我个人而言，我不会为此烦恼，只是依靠用户拥有合适的 pdf 阅读器。如果您选择闪光灯（或 silverlight？）解决方案，您将向用户提出另一个要求来掩盖第一个要求。另一方面，将 PDF 转换为 HTML 并不是那么容易，只需看看 Gmail 的“以 html 格式查看”功能的输出结果如何。

如前所述，正如其他人在我写这篇文章时已经发布的那样，我敢肯定，不要打扰，只是让访问者处理有一些东西可以阅读 pdf ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T06:34:19.210

其他人未提及的解决方案是光栅化 PDF（例如，通过 ghostscript）并将生成的图像提供为 PNG、JPG 等。您必须选择分辨率（可能是 72 dpi），并且您必须了解文档将变为可读性要差得多，尤其是对于感官受损的访问者。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-07-23T16:22:06.103

创建一个这样的 PHP 文件：我将第一个 php 文件称为“firstfile.php”

```
<?php
header('Content-type: application/pdf');
$file='yourpdffile.pdf';
@readfile($file);
?> 
```

然后创建另一个 PHP 文件并使用 iframe 获取所需的 PDF 文件。示例代码如下

```
<iframe src="http://localhost/Domainfolder/firstfile.php>" height="400px" width="750px">
  </iframe> 
```

除非您没有很好地引用链接，否则这应该可以解决问题。享受 ;）

# java - Android 中的文件权限

> ID：571783
> 
> 赞同：5
> 
> 时间：2009-02-21T00:33:07.690
> 
> 标签：java, android, permissions

我来这里只是想问一些可能非常简单的问题，我正在使用 Files、**FileOutputStream**和**FileInputStream**，但我只想从文件中获取/设置一些道具，我的意思是，文件的所有者，读取的权限/写等

环顾四周，我找到了**FileDescriptor**和**FilePermission**类，但我不知道我可以使用它们，所以我寻求一些帮助；实际上我正在使用类**File中的方法****setReadOnly()** ，但这就是我现在正在寻找的。

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T03:17:09.793

这里有几个问题：

1.  默认情况下，应用程序可以不受限制地访问自己的文件（读/写/删除/'执行'......无论执行意味着什么），但不能访问任何其他应用程序的文件。
2.  Android 使与其他应用程序及其数据的交互变得困难，除非通过 Intents。Intent 不适用于权限，因为您依赖于接收 Intent 的应用程序来执行/提供您想要的；他们可能不是为了告诉任何人他们的文件权限而设计的。有一些方法可以解决它，但只有当应用程序被设计为在同一个 JVM 中运行时（即您设计为一起在同一个 JVM 中运行的应用程序）

*您的应用程序可以为自己的文件*获取和设置权限，但不能为其他任何人这样做。据我所知，SDK 中没有明确的所有权概念，因此您无法找到文件的所有者。

Android 基于 Linux 内核，但它不是 Linux。它已针对在移动设备上运行进行了大量优化。如果您有一台应用程序只能在其自己的沙箱中运行的机器，您可以删除权限和所有权等内容，并获得更小、更快的操作系统。您的文件拥有的唯一权限是您在其上放置（并强制执行）的权限。其他应用程序的文件不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T01:08:47.730

Android 使用标准 Java API 来处理文件和文件权限。[这是一个讨论 Java 权限的页面。](https://docs.oracle.com/javase/1.5.0/docs/guide/security/permissions.html)

基本上，您需要做的就是获取文件的**[FilePermission](http://developer.android.com/reference/java/io/FilePermission.html)****对象，然后使用newPermissionCollection()**方法从 FilePermission 对象获取**[PermissionCollection](http://developer.android.com/reference/java/security/PermissionCollection.html)** ，然后在该集合中添加或删除项目。

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-26T02:14:54.227

好吧...如果您只想查看权限，您不能只使用“ls -l”吗？

# c# - 为什么 XmlDocument.Load(url) 返回一个陈旧的文件？

> ID：571793
> 
> 赞同：1
> 
> 时间：2009-02-21T00:39:59.750
> 
> 标签：c#, xml, .net-1.1

我有一个用 .NET 1.1 编写的应用程序，它在 URL 上调用 XmlDocument.Load。就在最近更新了 xml 文件。现在每当我调用 XmlDocument.Load 时，都会返回旧文件。当我从浏览器点击相同的 URL 时，我看到了新文件。我从 IE 中删除了所有临时文件，但仍然看到相同的问题。关于为什么我在以编程方式访问文件时看到旧版本的文件有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T00:42:54.580

只是猜测，但请尝试清除 IE 的浏览器缓存。.NET HTTP 与 IE 位于同一堆栈之上，并且还共享代理设置，因此如果缓存也被共享，我不会感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T00:46:48.640

删除 ASP.net 临时文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T14:42:22.820

所以看起来代理上一定有一些缓存，这在 48 小时内自行清除。

# kde - 如果我仍然想要我的“旧”图形 IDE，xmonad 有多棒？

> ID：571797
> 
> 赞同：3
> 
> 时间：2009-02-21T00:43:12.643
> 
> 标签：kde, xmonad

我听说过关于 xmonad 的优秀报告，但它对于日常使用和开发有多好？由于各种原因，我不使用 vim/emacs（尽管我没有终端恐惧症！）。我看到的所有屏幕截图/视频都显示 xmonad 主要用于终端应用程序。值得从 KDE 4.2 切换吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T04:16:46.110

KDE 是一个桌面环境——一个集成良好的应用程序的集合。XMonad 是一个窗口管理器，它只是从 KDE 中替换了 KWin，因此您在使用 XMonad（和其他窗口管理器）的同时仍然可以使用 KDE。

平铺窗口管理器通常用于提高生产力。使用 Vi 和 Emacs 的原因相同。这可能就是为什么您通常会在屏幕截图中看到人们使用大量终端和 vi/emacs 的原因。您没有理由不能将图形应用程序与平铺窗口管理器一起使用。但是，某些应用程序（想到 GIMP）存在各种怪癖，其中对话框和各种窗口不能很好地与平铺范例配合使用，因为开发人员没有想到它。他们基本上假设窗口会浮动。有一些方法可以解决这个问题，将特定的窗口设置为浮动，但配置它可能需要一些时间，而且一开始可能会很烦人。

平铺窗口管理器往往具有各种布局。据我所知，所有平铺窗口管理器都有“全屏”布局。这可能是一个很好的 IDE 布局，甚至可能是其他图形应用程序（我用它来浏览网页）。可以在 XMonad 中为每个工作区设置布局，因此您可以拥有一个“IDE”工作区并针对该环境进行特定设置。

建议你**试试看**，没有坏处，你自己判断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-20T01:05:05.577

这可能是你想要的： [http ://www.haskell.org/haskellwiki/Xmonad/Using_xmonad_in_KDE](http://www.haskell.org/haskellwiki/Xmonad/Using_xmonad_in_KDE)

我的经验：我喜欢 xmonad，但想住在我关注的 gnome 的神奇土地上 [http://haskell.org/haskellwiki/Xmonad/Using_xmonad_in_Gnome](http://haskell.org/haskellwiki/Xmonad/Using_xmonad_in_Gnome)

刚刚奏效。IIRC 我需要做的（在 ubuntu 上）是 *install xmonad *create .gnomerc *put WINDOW_MANAGER=xmonad *put import XMonad.Config.Gnome in my .xmonad

我以一种有条理的方式获得了 gnome 的所有魔力

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T00:48:26.703

我认为这取决于人。Linux 值得所有人从 OS X 切换到 Linux 吗？不，这取决于各种因素。至于完全切换到 xmonad （我知道你可以[同时运行](http://www.haskell.org/haskellwiki/Xmonad/Using_xmonad_in_KDE)），这将取决于人们喜欢的工作空间风格。就个人而言，我已经切换了，我只是希望我早点尝试过。无论如何，你能做的最好的事情就是继续安装和运行大坝！:) 希望有帮助。

# c# - 将函数从 C++ dll 导出到 C# P/Invoke

> ID：571799
> 
> 赞同：8
> 
> 时间：2009-02-21T00:44:10.973
> 
> 标签：c#, c++, dll, pinvoke, dllimport

我已经构建了一个我想从 C# 代码调用的 C++ dll。我可以调用一个函数，但是当 C# 代码尝试加载 dll 时，另一个会引发异常。

标题如下所示：

```
extern "C" __declspec(dllexport) BOOL Install();
extern "C" __declspec(dllexport) BOOL PPPConnect(); 
```

这会生成一个带有稍微混乱的导出表的 dll（foo = foo 在 name 字段中是什么意思？）：

```
File Type: DLL

Section contains the following exports for PPPManager.dll

00000000 characteristics
499F44F0 time date stamp Fri Feb 20 16:04:00 2009
    0.00 version
       1 ordinal base
       2 number of functions
       2 number of names

ordinal hint RVA      name

      1    0 000078E4 Install = Install
      2    1 000079DC PPPConnect = PPPConnect 
```

我的 P/Invoke 声明如下所示：

```
[DllImport("PPPManager.dll")]
private static extern bool Install();

[DllImport("PPPManager.dll")]
private static extern bool PPPConnect(); 
```

对 Install 的调用毫无例外地返回，但是当我调用 PPPConnect 时，我得到一个 MissingMethodException -“在 PInvoke DLL 'PPPManager.dll' 中找不到入口点 'PPPConnect'。”

我尝试从 Install 函数声明中删除 extern 和 declspec 指令，这样 PPPConnect 是唯一导出的函数，这仍然不允许我调用 PPPConnect。

我也尝试过按序号进行 DllImport；这给出了与按名称调用相同的结果 - 安装返回，但 PPPConnect 抛出异常“找不到入口点 '#2'...”。

互操作日志给出：

```
[pinvokeimpl][preservesig]
bool  invivodata.Common.System.IPAQUtils::Install();
BOOLEAN (I1_WINBOOL_VAL) Install();

JIT ERROR FOR PINVOKE METHOD (Managed -> Native): 
[pinvokeimpl][preservesig]
bool  invivodata.Common.System.IPAQUtils::PPPConnect();
BOOLEAN (I1_WINBOOL_VAL) PPPConnect(); 
```

这远远超出了我的专业领域，因此欢迎任何建议或想法。

谢谢，保罗

编辑：事实证明这段代码确实有效；问题在于最新的 dll 没有传播到设备。哦！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T02:51:05.707

您是否在 dll 项目中使用 .def 文件来导出这些函数？如果是这样，请将其删除并重试。这只是一个猜测，因为当您执行 extern "C" declspec(dllexports) 时，您的导出看起来不是应有的样子。

我用一个简单的 C++ dll 尝试了这个

```
extern "C" __declspec(dllexport) BOOL Install();
extern "C" __declspec(dllexport) BOOL PPPConnect(); 
```

和一个使用您的 PInvoke 声明的简单 C# 应用程序*，它运行良好。*

当我在 dll 上执行 dumpbin/exports 时，我看到：

文件 PPPManager.dll 的转储

文件类型：DLL

部分包含 PPPManager.dll 的以下导出

```
00000000 characteristics
499F6C2D time date stamp Fri Feb 20 20:51:25 2009
    0.00 version
       1 ordinal base
       2 number of functions
       2 number of names

ordinal hint RVA      name

      1    0 000110CD Install = @ILT+200(_Install)
      2    1 00011069 PPPConnect = @ILT+100(_PPPConnect) 
```

请注意，在我的情况下，导出的名称是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T02:00:18.027

它可能很简单，比如`PPPConnect`以一种被操作系统误解的方式失败。尝试同时实现`Install`和`PPPConnect`作为无操作（只是让它们返回`TRUE`而不做任何其他事情）并查看错误是否仍然存在。如果是这样，请尝试交换它们的导出顺序（仍然是无操作），看看问题是否与排序有关（不太可能）或其他原因。

您还可以使用图形工具`depends`来确认 DLL 的导出表是什么样的，但我怀疑问题出在那些方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T02:12:17.483

根据您的描述，Install 和 PPPConnect 仅在名称上有所不同。我猜你只是在你的 C# 应用程序中使用旧的 .dll 版本。一个没有定义 PPPConnect。

声明看起来是正确的（据我所知，没有消息来源）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T01:59:04.753

很好的信息，但正如你提到的，这里一切都井井有条。尝试安装适用于 Windows 的调试工具并运行：

```
kd -z \path\to\PPPManager.dll -y \path\to\PPPManager.pdb -c "x pppmodule!*" 
```

更好地转储符号表；这也是一个盲目的镜头，但你也可以尝试：

```
extern "C" 
{
    __declspec(dllexport) BOOL Install();
    __declspec(dllexport) BOOL PPPConnect();
}; 
```

以防 __declspec 做一些奇怪的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T15:02:06.803

使用依赖遍历器并打开您的 DLL 以验证可用的方法

# sql - 带有存储过程问题的光标

> ID：571804
> 
> 赞同：2
> 
> 时间：2009-02-21T00:46:12.590
> 
> 标签：sql, sql-server, stored-procedures

我需要使用游标来调用一个存储过程，该过程具有我需要从客户表传递的 2 个参数。

这就是我的意思；

我的目标是将客户表中的所有 CustomerID 和 CustomerName 传递到名为 AddCustomers 的存储过程中，该存储过程具有 CustomerID 和 CustomerName 2 个参数。即：AddCustomer [CustomerID],[CustomerName] [旁注：此 AddCustomer 存储过程执行我的应用程序所需的一些过滤操作]

因此，将此 CURSOR 与存储过程一起使用的最终结果是将客户表中的所有 customerID 和 CustomerName 转储/传递到 AddCustomer 存储过程中。

我使用过 sp_executesql，但没有成功。

这是我尝试过但不起作用的方法。

```
Declare @CustomerID int
Declare @CustomerName varchar(100)

Declare cur CURSOR READ_ONLY
FOR
SELECT CustomerID, CustomerName
from Customers

OPEN cur

FETCH NEXT FROM cur
INTO @CustomerID, @CustomerName

WHILE @@FETCH_STATUS = 0
BEGIN
   EXEC AddCustomer @CustomerID, @CustomerName 
   FETCH NEXT FROM cur
   INTO @CustomerID, @CustomerName
END

CLOSE cur
DEALLOCATE cur 
```

* * *

我是使用游标的新手，所以我不确定为什么这不起作用。如果您能提供任何线索或链接，我将不胜感激。

### 更新：

好的，如果 Cursor 不能循环通过存储过程，那么任何人都可以为我的问题提供解决方案或提示，即将客户表中的所有 CustomerID 和 CustomerName 传递到我的 AddCustomer 存储过程中，以便我可以对每个我传递给 AddCustomer 存储过程的 CustomerID 和 CustomerName。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T00:55:16.017

从语法角度来看，您的光标很好。我猜这个问题与您的存储过程引发错误有关。您还应该发布存储过程的代码。

以及错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T01:24:24.447

语法似乎没有任何问题。我们确实需要错误消息才能提供答案。

失明我最好的镜头是 varchar(100) ...也许桌子上有它 nvarchar ...

语法似乎没有任何问题。我们确实需要错误消息才能提供答案。

失明我最好的镜头是 varchar(100) ...也许桌子上有它 nvarchar ...

**更新1：** k，你在评论中提到

> “数据类型应该是相同的。我花时间检查了它。它们是 CustoemrID 的 uniquInde​​ntifier 和 customerName 的 varchar”

请注意，您在 customerid 变量上使用了 int。将其更改为：Declare @CustomerID uniqueidentifier

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T00:49:15.127

你为什么使用游标？您是否意识到这是解决此问题的效率最低、最复杂的方法？使用修改后的存储过程版本比您有更好的机会。或其他几种模式之一。

* * *

同样，最简单的方法可能是修改存储过程（如果需要，创建一个新过程）以进行输入。

或者，您可以使用您选择的语言 C#、VB 等）来查询客户，然后在存储过程中循环。

否则你打算如何处理异常/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T01:04:03.483

山姆，

有时使用存储过程来完成这样的任务是*非常合适的。* Le Dorfier 确实给了我很多很好的建议，但我不得不在这一点上不同意他的看法。特别是如果这是一次性处理您的记录以实现某种形式的转换，那么您*真的很*接近您的解决方案，因为我没有看到您的代码中有任何明显的缺陷。顺便说一句，我不止一次采用了同样的方法，而且效果很好。

所以......发布存储过程，我们会看看这是否没有帮助。另外，您看到了什么具体错误？

**更新：**等等，你只是在 SQL 窗口中运行它吗？我通常将这些东西打包到另一个存储过程中（通常只是一个临时的），然后运行它。当然，也可能是您只需要执行此代码 - 不使用 EXEC 而是仅使用 Execute 按钮......根据您的描述很难判断。

**更新2：**你在上面说错误是关于表的。你确定你定义的数据类型是正确的吗？该错误是否可能是从表中提取的数据与您放置它的 var 类型之间的不匹配？

# automation - 网站如何自动抓取个人资料图片？

> ID：571808
> 
> 赞同：2
> 
> 时间：2009-02-21T00:47:26.987
> 
> 标签：automation, profile, image, gravatar

有些网站可以在您首次注册后获取您的个人资料图片，而无需用户实际上传图片。我认为stackoverflow在签名时也有这个功能......它是如何工作的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T00:48:43.253

我相信它使用 gravatar.com。您将头像与您的电子邮件相关联，然后网站可以使用您的电子邮件来定位您的头像。Wordpress 有一个插件。或谷歌搜索“gravatar API”将其放在您自己的网站上。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-21T00:49:42.893

stackoverflow 使用通过您的电子邮件地址链接的[gravatar 。](http://gravatar.com)[你可以在他们的开发者资源页面上](http://en.gravatar.com/site/implement/)阅读更多关于gravatar 如何工作的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-21T00:49:18.230

有一个名为[http://gravatar.com](http://gravatar.com)的网站，它采用您电子邮件的 MD5 哈希值来加载个人资料图片

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T00:49:23.127

他们正在使用 OpenID。一些 OpenID 提供商允许您上传个人资料图片，或者它会将其与您的 Gravatar 电子邮件地址 ( [http://en.gravatar.com/](http://en.gravatar.com/) ) 相关联。

# content-management-system - 在 Umbraco 中，如何将页面或包设置为默认值？

> ID：571829
> 
> 赞同：1
> 
> 时间：2009-02-21T00:59:13.463
> 
> 标签：content-management-system, umbraco

我是 Umbraco 的新手。我安装了 Runway，然后安装了 creative be 包。

[http://localhost/home.aspx](http://localhost/home.aspx)将我带到 crative 网站，而[http://localhost/](http://localhost/)我则到 Runway 网站。

我该如何改变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T08:26:12.513

Hiya Greg 在我创建 Creaite Site 向导时，它不打算在安装了 Runway 的情况下运行。它们是两个不同的概念。

跑道是一个快速的线框污染，让您使用常用模块快速启动和运行，其中我的站点向导用作 umbraco 上基本站点的演示，用于帮助您学习/理解所有组件协同工作。

关于您的原始问题，可能有多个根节点，但它主要用于拥有多语言站点。

在每个根/站点节点上右键单击它并添加主机名，您可以将主机名添加到该根节点。

例如

主英国节点->分配主机名-yoursite.co.uk

主 IT 节点 --> 分配主机名 - yoursite.it

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T01:10:58.833

我卸载了 Runway 包，它恰好解决了这个问题，但不是我想要的。

# php - Drupal 向导表单：验证和上一个按钮

> ID：571837
> 
> 赞同：1
> 
> 时间：2009-02-21T01:06:04.087
> 
> 标签：php, drupal, drupal-6, drupal-fapi, drupal-form-validation

在我的 drupal6 站点中，我有向导表单。我使用表单存储和重建属性使用 FormAPI 实现了它。我的表单验证是使用#required 属性和#element_validate 属性中的函数完成的。它工作正常，但一方面，当我单击上一个按钮时，表单正在被验证，我不希望它这样做。当单击表单的特定按钮时，是否有一种智能且正确的方法来禁用验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T05:11:57.707

干净地（不幸地）做到这一点的唯一方法是避免使用 #required = TRUE 并在验证处理程序中自己验证它，同时考虑到在向导过程中表单在哪个“步骤”上的知识。

一种常见的方法是在 $form_state['storage'] 中累积所有正在进行的数据，它将在重建之间持续存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T00:56:24.170

```
 // hack to clear validation errors during wizard processing
  form_set_error(NULL, FALSE, TRUE);
  unset($_SESSION['messages']['error']); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:24:34.563

凯文的回答有效。您也可以尝试[http://drupal.org/project/skip_validation](http://drupal.org/project/skip_validation)，您可以在其中为上一个按钮添加一个附加属性，`'#skip_validation' => TRUE`

# python - 将元素添加到 python 生成器

> ID：571850
> 
> 赞同：26
> 
> 时间：2009-02-21T01:11:36.413
> 
> 标签：python, append, generator

是否可以将元素附加到 python 生成器？

我目前正在尝试从一组杂乱无章的文件夹中获取所有图像并将它们写入一个新目录。为了获取文件，我使用 os.walk() 返回单个目录中的图像文件列表。虽然我可以从这个单一列表中创建一个生成器，但我不知道如何将所有这些列表组合成一个单一的生成器。任何帮助将非常感激。

有关的：

*   [在python中展平一个浅表](https://stackoverflow.com/questions/406121/flattening-a-shallow-list-in-python)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-21T01:31:45.490

您正在寻找[`itertools.chain`](https://docs.python.org/library/itertools.html#itertools.chain). 它将多个可迭代对象组合成一个，如下所示：

```
>>> import itertools 
>>> for i in itertools.chain([1,2,3], [4,5,6]):
...     print(i)
... 
1
2
3
4
5
6 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-21T01:54:52.767

应该这样做，`directories`您的目录列表在哪里：

```
import os
import itertools

generators = [os.walk(d) for d in directories]
for root, dirs, files in itertools.chain(*generators):
    print root, dirs, files 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T01:25:53.103

```
def files_gen(topdir='.'):
    for root, dirs, files in os.walk(topdir):
        # ... do some stuff with files
        for f in files:
            yield os.path.join(root, f)
        # ... do other stuff

for f in files_gen():
    print f 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-21T01:28:36.467

像这样。

```
def threeGens( i, j, k ):
    for x in range(i):
       yield x
    for x in range(j):
       yield x
    for x in range(k):
       yield x 
```

效果很好。

# sql-server - MS SQL 2005 全文目录的替代品

> ID：571852
> 
> 赞同：2
> 
> 时间：2009-02-21T01:12:46.877
> 
> 标签：sql-server, performance, clr, full-text-search

我似乎无法从全文目录中获得可接受的性能。在某些情况下，我们必须尽快运行 100k+ 查询。有些查询使用 FREETEXT，有些则不使用。这是一个查询示例

IF EXISTS（从 user_data d 中选择 1，其中 d.userid=@userid 和 FREETEXT(*, @activities) SET @match=1

这可能需要 3-15 秒。如果可能的话，我需要它更快< 1s。

我喜欢全文查询的“灵活性”，因为它可以跨多个列进行搜索，而且语法非常直观。我宁愿不使用 Like 语句，因为我们希望能够匹配“Writer”和“Writing”之类的词。

我已经尝试了这里列出的一些建议[http://msdn.microsoft.com/en-us/library/ms142560(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms142560(SQL.90).aspx)

我们有尽可能多的内存和 CPU，不幸的是我们不能把目录放在他们自己的磁盘控制器上。

我很难过，准备探索全文查询的其他替代方案。还有其他什么东西可以提供那种“作家”/“写作”类似的匹配吗？也许甚至是使用 CLR 的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T18:41:19.277

查看这些替代方案，尽管我怀疑它们是否会在不将它们隔离到单独的硬件上的情况下提高性能：

[ASP.NET 使用哪种搜索技术？](https://stackoverflow.com/questions/120965/which-search-technology-to-use-with-aspnet)

[Lucene.Net 和 SQL Server](https://stackoverflow.com/questions/37059/lucenenet-and-sql-server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T10:31:06.287

由于 FREETEXT 的性质，性能低于使用 CONTAINS 时的性能，这仅仅是因为它必须考虑给定关键字的不太精确的替代方案。当您指定 Write btw 时，CONTAINS 可以找到 Writing，我不确定您是否检查过 CONTAINS 是否会起作用。

还要确保避免在 SQL 中使用 IF 语句，因为它们通常会导致每次查询执行都重新编译执行计划，这可能会导致您看到的性能不佳。我不确定如何使用 IF 语句，因为它可能在更大的 SQL 中。尝试将 EXISTS 查询与更大的 sql 片段合并，因为您可以在 EXISTS 内的 SELECT 语句中设置 @match 参数，或者完全摆脱变量并使用 EXISTS 子句作为更大查询中的谓词。

SQL 是一种面向集合的语言并且是解释型的。因此，摆脱命令式编程结构并使用 sql 的本机集合运算符通常更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-06T20:32:02.880

也许[https://github.com/MahyTim/LuceneNetSqlDirectory](https://github.com/MahyTim/LuceneNetSqlDirectory)可以帮助你，它允许在 SQLServer 中存储一个 LuceneNET 索引。

# infopath - STA 工作线程上的 InfoPath FormControl

> ID：571854
> 
> 赞同：0
> 
> 时间：2009-02-21T01:16:38.977
> 
> 标签：infopath

我有一个 .NET 类，它公开了两种公共方法：一种用于创建 InfoPath 表单，另一种用于导出为一种受支持的格式。我正在使用 Microsoft FormControl 来执行此操作。它由不显示的表单托管。我被 Winforms 应用程序调用，但在 MTA 工作线程而不是 UI 线程上调用。所以我创建了一个 STA 线程并在其上执行，它只工作一次，然后导致这个异常：

System.InvalidOperationException 未处理 Message="无法获取 'FormControl' 控件的窗口句柄。不支持无窗口 ActiveX 控件。" Source="System.Windows.Forms" StackTrace：在 System.Windows.Forms.AxHost.InPlaceActivate() 在 System.Windows.Forms.AxHost.TransitionUpTo(Int32 state) 在 System.Windows.Forms.AxHost.EnsureWindowPresent() System.Windows.Forms.AxHost.CreateHandle() 在 System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) 在 System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) 在 System.Windows.Forms.AxHost.EndInit( ) 在 C:\Windows\Temp\InfoPathCreateStaThreadTest\InfoPathCreateStaThreadTest\FormControlHost.Designer.cs 中的 InfoPathCreateStaThreadTest.FormControlHost.InitializeComponent()：

经过一些试验，我开始怀疑这是一个消息泵送问题。然后我遇到了这个，这让我更加怀疑：http: [//blogs.msdn.com/cbrumme/archive/2004/02/02/66219.aspx](http://blogs.msdn.com/cbrumme/archive/2004/02/02/66219.aspx)

我尝试了各种发送消息的方法，但都没有成功。我应该提到自动化 InfoPath 应用程序的替代方案是不可行的，除非我能弄清楚如何隐藏该应用程序。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-15T16:11:29.517

您是否在加载表单**后**创建工作线程（调用控件的线程） ？在我将所有调用移至父窗体的 Load 事件中的 FormControl 之前，我一直遇到这个问题。自从这样做以来，我没有遇到过这个特定的错误（尽管我见过很多其他错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T05:47:49.520

Thanks for your reply. Sorry for the long delayed reply on my end. DEP is not causing the problem for me. I ended up automating the InfoPath app vs. using the FormControl. Best of luck getting your issue resolved!

Rob

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:43:28.370

我正在研究同样的错误并发现：[http](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/9c36e5d3-a75c-4760-9070-5dbaf188992b/) ://social.msdn.microsoft.com/Forums/en-US/clr/thread/9c36e5d3-a75c-4760-9070-5dbaf188992b/将问题归因于 DEP意外打开并提供了修复。我还不知道这是否能解决我的问题。

# php - 在 Mac OSX 10.5 上编译 PHP-GD

> ID：571855
> 
> 赞同：0
> 
> 时间：2009-02-21T01:16:42.487
> 
> 标签：php, macos, gd

我在这里遵循了有用的说明： [在 Mac OS X 10.5 Leopard 上安装 GD for PHP](http://www.gigoblog.com/2008/10/08/install-gd-for-php-on-mac-os-x-105-leopard/)

我在 php.ini 文件中有我的扩展目录，如下所示：

> extension_dir = "/usr/local/php/lib/php/extensions/no-debug-non-zts-20060613/"

但是当我尝试加载 GD 时，出现错误：

> PHP 启动：无法加载动态库 '/usr/local/php/lib/php/extensions/no-debug-non-zts-20060613/gd.so' - (null) 在第 0 行 GDB - GNU 调试器协议中的未知=> $修订：1.88 $

这是一个常见的错误。有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-06T02:38:43.597

我有完全相同的错误，我花了几个小时才找到。答案是您需要确保为您的处理器编译正确的版本。就我而言，我不记得 PPC G5 是 64 位处理器，而这失败了，因为我使用的是 32 位版本。

我还发现将两个配置行更改为更具体地为 PPC64 架构进行设置很有帮助，如下所示

**对于 jpeg-6b：**

以下行无法正常工作：

```
MACOSX_DEPLOYMENT_TARGET=10.5 CFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe -no-cpp-precomp" CCFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" CXXFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" LDFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -bind_at_load" ./configure --enable-shared 
```

但是这个（至少在 G5 上）：

```
MACOSX_DEPLOYMENT_TARGET=10.5 CFLAGS=" -arch ppc64 -g -Os -pipe -no-cpp-precomp" CCFLAGS=" -arch ppc64 -g -Os -pipe" CXXFLAGS="-arch ppc64 -g -Os -pipe" LDFLAGS="-arch ppc64 -bind_at_load" ./configure --enable-shared 
```

**对于 GD：**

以下行无法正常工作：

```
MACOSX_DEPLOYMENT_TARGET=10.5 CFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe -no-cpp-precomp" CCFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" CXXFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -g -Os -pipe" LDFLAGS="-arch ppc -arch ppc64 -arch i386 -arch x86_64 -bind_at_load" ./configure --with-zlib-dir=/usr --with-jpeg-dir=/usr/local/lib --with-png-dir=/usr/X11R6 --with-freetype-dir=/usr/X11R6 --with-xpm-dir=/usr/X11R6 
```

但是这个（至少在 G5 上）：

```
MACOSX_DEPLOYMENT_TARGET=10.5 CFLAGS=" -arch ppc64 -g -Os -pipe -no-cpp-precomp" CCFLAGS=" -arch ppc64 -g -Os -pipe" CXXFLAGS="-arch ppc64  -g -Os -pipe" LDFLAGS=" -arch ppc64  -bind_at_load" ./configure --with-zlib-dir=/usr --with-jpeg-dir=/usr/local/lib --with-png-dir=/usr/X11R6 --with-freetype-dir=/usr/X11R6 --with-xpm-dir=/usr/X11R6 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T03:03:54.193

extension_dir 的路径错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T10:44:55.047

在您重新安装 PHP（例如，[在 Mac OS X 上使用 GD2 编译 PHP](http://stackoverflow.com/questions/581764/gd2-and-php-on-os-x/608820#608820)）后，这会修复与未加载 PHP 扩展相关的最常见错误（因此不允许 PEAR 和其他程序启动）。

输入 Terminal.app：这会备份与 OSX 捆绑的 PHP 的 CLI，然后符号链接到新的正确位置（请注意，由于每个 PHP 的安装位置可能会有所不同，在这种情况下，您应该替换为正确的路由到新安装的文件）。
`sudo mv /usr/bin/php /usr/bin/php_back
sudo ln -s /usr/local/php5/bin/php /usr/bin/php`

`/usr/local/php5/bin/php`

# multithreading - boost::thread: 运行优化版本时的段错误

> ID：571866
> 
> 赞同：3
> 
> 时间：2009-02-21T01:24:15.227
> 
> 标签：multithreading, segmentation-fault, boost-thread

`boost:thread`我上班有困难。在没有优化的情况下编译时运行良好：

```
g++ -o test-thread test-thread.cpp -lboost_thread-gcc-mt-s -lpthread
./test-thread 
```

但是使用优化编译的版本会崩溃

```
g++ -O2 -o test-thread test-thread.cpp -lboost_thread-gcc-mt-s -lpthread
./test-thread
Segmentation fault 
```

有谁知道可能是什么原因？

这是我正在使用的代码：

```
#include <boost/thread.hpp>
#include <boost/function.hpp>

void task1() {
  // do something
}
void task2() {
  // do something
}

int main (int argc, char ** argv) {
  using namespace boost;

  function0<void> f1(&task1);
  function0<void> f2(&task2);

  thread thread_1(f1);
  thread thread_2(f2);

  // do other stuff 
  thread_2.join();
  thread_1.join();
  return 0;
} 
```

PS：我在 ubuntu linux 上使用 boost 1.32。

**更新：**

这是它在调试器中崩溃的地方（第 37 行是`thread_2.join();`我原始代码中的行）：

```
(gdb) bt
#0  0x080499e0 in boost::thread::join ()
#1  0x080496b8 in main (argc=1, argv=0xbfea3eb4) at ../src/test-thread.cpp:37 
```

这是我实际的两个功能：

```
void task1() {
  std::cerr << "THREAD 1 START" << std::endl;
  for(double i=0; i<999999; ++i){
    std::cout << i << std::endl;
  }
  std::cerr << "THREAD 1 END" << std::endl;
}

void task2() {
  std::cerr << "THREAD 2 START" << std::endl;
  for(double i=0; i<999999; ++i){
    std::cout << i << std::endl;
  }
  std::cerr << "THREAD 2 END" << std::endl;
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T01:47:44.983

您能否确保核心转储处于活动状态（`ulimit -c unlimited`）、使用符号（-O2 -g）编译、运行并在 gdb 中打开堆栈跟踪？( `gdb test-thread core`，然后`backtrace`在`gdb`提示符下键入，`quit`退出)

> **更新**
> 
> 根据回溯，分段错误发生在 `boost::thread::join`. 您能否重新打开核心并：
> 
> *   获取`boost::thread::join`方法的反汇编：
>     *   `disassemble boost::thread::join`
>     *   `disassemble`
> *   获取寄存器的转储：
>     *   `info registers`
> 
> （boost 1.32 官方源代码）的实现 `boost::thread::join`非常简单，因此除非 Ubuntu 二进制文件与官方代码大相径庭（我们希望从反汇编中找到），否则只有两个可能的原因导致分段错误。
> 
> **您是否还可以确认在分段错误之前两个线程在打印输出中的距离？**
> 
> ```
> void thread::join()
> {
>     int res = 0;
> #if defined(BOOST_HAS_WINTHREADS)
>     res = WaitForSingleObject(reinterpret_cast<HANDLE>(m_thread), INFINITE);
>     assert(res == WAIT_OBJECT_0);
>     res = CloseHandle(reinterpret_cast<HANDLE>(m_thread));
>     assert(res);
> #elif defined(BOOST_HAS_PTHREADS)
>     res = pthread_join(m_thread, 0);
>     assert(res == 0);
> #elif defined(BOOST_HAS_MPTASKS)
>     OSStatus lStatus = threads::mac::detail::safe_wait_on_queue(
>         m_pJoinQueueID, NULL, NULL, NULL, kDurationForever);
>     assert(lStatus == noErr);
> #endif
>     // This isn't a race condition since any race that could occur would
>     // have us in undefined behavior territory any way.
>     m_joinable = false;
> } 
> ```

此类问题的常见原因：

*   未初始化的变量
*   未被标记的两个线程访问的变量`volatile`
*   内联调用和/或展开循环（其堆栈帧大小是所有内联方法实例的堆栈帧的总和）被递归调用并且比非内联版本更快地溢出堆栈

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T21:17:43.643

我发现了错误！我链接了错误版本的库。我一直在使用`boost_thread-gcc-mt-s`，但它适用于`boost_thread-gcc-mt`：

```
g++ -O2 -o test-thread test-thread.cpp -lboost_thread-gcc-mt -lpthread 
```

我查看了 boost 文档，但找不到任何有关这些库版本之间差异的信息。还有一个`boost_thread-gcc-mt-d`，我假设它是调试版本，但是链接到那个总是会导致二进制文件出现段错误，即使使用`-g`. 但至少我现在可以运行线程了。

# java - Java 随机存取文件

> ID：571874
> 
> 赞同：2
> 
> 时间：2009-02-21T01:25:49.297
> 
> 标签：java

```
 public void exportUrlsToFile(String file, String urls) throws IOException {
    String[] urlsArray = urls.split("\\s+");// split on one or more white space characters.

    // create a fresh file
    RandomAccessFile raf = new RandomAccessFile(file, "rw");

    for (String line : urlsArray) {
        line = line.trim();
        if (line.isEmpty()) {// this won't happen!
            continue;
        }
        raf.writeBytes(line);
        raf.writeBytes(newline);
    }
    // close the file handler
    raf.close();
} 
```

基本上，我使用这个类来做一些事情。这是在 Tomcat JVM 中运行的应用程序的一部分。我注意到，无论何时调用此方法，它都会创建一个与参数同名的文件，并且在 raf.close() 之后，它仍然存在。如何确保删除临时文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T02:25:17.063

一个更好的问题是，为什么您要经历制作文件、将内容写入文件，然后删除文件的所有麻烦？！

无论您不需要随机访问文件 - FileWriter 会更好。

为了确保文件被删除，按照 Eddie 的建议进行操作，并将删除放在一个 finnaly 块中 - 但您还需要确保处理 raf.close() IOException ......类似于：

```
} 最后 {
    尝试
    {
        raf.close();
    }
    捕获（最终 IOException 前）
    {
         // 在 14 年的 Java 编程中，我仍然不知道在这里做什么！;-)
    }
    最后
    {
        文件删除 = 新文件（文件）；
        如果（！todelete.delete（））{
            // 记录我们无法删除临时文件的投诉
        }
    }
}

```

编辑：

您也可能意味着在 Tomcat 进程完成后文件仍然存在并且您希望它消失。如果是这种情况，请查看 java.io.File.deleteOnExit()。当 Tomcat JVM 存在时，这应该删除文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T02:13:32.067

我将假设您只显示了一小部分代码，并且`RandomAccessFile`当您似乎没有进行任何随机访问时，您使用它是有充分理由的。

我会做这样的事情：

```
public void exportUrlsToFile(String file, String urls) throws IOException {
  String[] urlsArray = urls.split("\\s+");

  // create a fresh file
  RandomAccessFile raf = new RandomAccessFile(file, "rw");

  try {
    for (String line : urlsArray) {
      line = line.trim();
      if (line.isEmpty()) { // this won't happen!
        continue;
      }
      raf.writeBytes(line);
      raf.writeBytes(newline);
    }
  } finally {
    // don't leak file handles on Exception -- put close in "try/finally"
    try { raf.close(); } catch (IOException e) { /* ignore */ }
    File todelete = new File(file);
    if (!todelete.delete()) {
      // Log a complaint that we couldn't delete the temp file
    }
  }
} 
```

编辑：我同意，我们不希望 close() 上的理论 IOException 引起问题。比忽略它更好的是记录一个“我们从没想过会看到这个......”，但有例外。我经常创建一个 closeWithoutException() 方法来包装它。Close 理论上抛出 IOException 似乎是对检查异常的滥用，因为您不能期望调用者做任何响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T01:29:22.487

改用[File.createTempFile()](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#createTempFile(java.lang.String,%20java.lang.String))吗？

我意识到这不会为您提供与 RandomAccessFile 相同的功能，但您可以在此基础上构建您需要的东西。

实际上，我什至不确定您为什么要将这些内容写入文件。这是某种使用情况跟踪吗？为什么不直接将其存储在内存中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-20T09:47:02.387

你试过这个吗？

```
 File temp = File.createTempFile("file", ".tmp");
 temp.deleteOnExit( ); 
```

# c# - 动态设置附加程序文件路径的最佳方法

> ID：571876
> 
> 赞同：49
> 
> 时间：2009-02-21T01:27:20.430
> 
> 标签：c#, log4net

我试图找到比我更聪明的人来验证我写的一些语法。这个想法是将我的 RollingFileAppender 的文件名配置为程序集的名称，以使其对我的项目更具可重用性。

我已经看过[这篇以前的 SO 文章](https://stackoverflow.com/questions/308436/log4net-programmatcially-specify-multiple-loggers-with-multiple-file-appenders)，但它并不能完全回答我的问题......

我有一段时间试图了解 Log4net 的内部组件，这就是我想出的（位于 Global.asax 文件中 - Application_Start 方法）：

```
// Bind to the root hierarchy of log4net
log4net.Repository.Hierarchy.Hierarchy root = 
  log4net.LogManager.GetRepository() 
    as log4net.Repository.Hierarchy.Hierarchy;

if (root != null)
{
  // Bind to the RollingFileAppender
  log4net.Appender.RollingFileAppender rfa = 
    (log4net.Appender.RollingFileAppender)root.Root.GetAppender("RollingLogFileAppender");

  if (rfa != null)
  {
    // Set the file name based on the assembly name
    string filePath = 
      string.Format("~/App_Data/{0}.log", GetType().Assembly.GetName().Name);

    // Assign the value to the appender
    rfa.File = Server.MapPath(filePath);

    // Apply changes to the appender
    rfa.ActivateOptions();
  }
} 
```

谁能告诉我，“这太可怕了”，或者“这应该可以正常工作”？另外，如果我动态设置文件，我仍然可以期望 log4net 行为根据 log4net.config 文件设置来轮换文件吗？

非常感激！

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-02-21T02:28:09.850

你这样做很艰难！在应用程序的配置文件中将 log4net 配置定义为 XML 并使用`%property{}`：

```
<appender name="YourAppender" type="log4net.Appender.RollingFileAppender">
  <file type="log4net.Util.PatternString" value="~/App_Data/%property{LogName}" />
  ....
</appender> 
```

这是动态的——你只需要在初始化 log4net**之前**`LogName`设置 log4net 属性“ ” 。因此，在您配置 log4net 之前的任何时候，在您的代码中设置此属性的所需值：

 **```
string LogName = GetType().Assembly.GetName().Name + ".log";
log4net.GlobalContext.Properties["LogName"] = LogName; 
```

当然，您可以使用任何属性名称。我为一个简单的示例选择了“LogName”，但是如果您愿意，您可以为每个应用程序设置一个，只要您的代码知道正确的属性名称是什么以及正确的值应该是什么。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-03-23T13:08:00.433

这是在运行时设置或更改第一个附加程序的日志文件的方法：

```
var appender = (log4net.Appender.FileAppender)LogManager.GetRepository().GetAppenders()[0];
appender.File = "C:\whatever.log";
appender.ActivateOptions(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-07-03T13:40:19.060

2015年，我们这样做：

```
<file type="log4net.Util.PatternString">
  <conversionPattern value="%appdomain.log" />
</file> 
```

无需其他代码。

应用程序域是执行程序集的文件名。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-12-27T16:26:36.720

它对我有用 `<file type="log4net.Util.PatternString" value="./Log/logQueueService%date{yyyy_MM_dd}.log" />`

# c - C ：将字符串反转到位。我使用了前面问题中回答的编。它编译正常，但因分段错误而崩溃

> ID：571877
> 
> 赞同：1
> 
> 时间：2009-02-21T01:27:31.787
> 
> 标签：c, pointers

我从 main（C 代码）调用 Chris Conway 提供的函数（[How do you reverse a string in place in C or C++?](https://stackoverflow.com/questions/198199/how-do-you-reverse-a-string-in-place-in-c-or-c)）。当我使用 cygwin 运行这个程序时，程序在 while 循环中崩溃（注释掉它中断的行）。您能否解释一下这里出了什么问题。谢谢

```
#include <stdio.h>
#include <string.h>

void strrev(char* z);

int main()
{
        char *a;
    printf("before reverse: %s\n", a);
        strrev(a); // function provided by Chris Conway
    printf("after reverse: %s\n", a);
    return 0;
}

void strrev(char *str) {
  char temp, *end_ptr;

  /* If str is NULL or empty, do nothing */
  if( str == NULL || !(*str) )
    return;

  end_ptr = str + strlen(str) - 1;

  /* Swap the chars */
  while( end_ptr > str ) {
    temp = *str;
    *str = *end_ptr;  //crashes here (cygwin gives segmentation fault)
    *end_ptr = temp;  //for testing, if I comment out line above, it crashes here
    str++;
    end_ptr--;
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T01:30:43.420

该函数很好，但您`main()`似乎没有初始化 string `a`。

尝试：

```
int main() {
  char a[1024];
  strcpy(a, "Some string");
  printf("before reverse: %s\n", a);
  strrev(a); // function provided by Chris Conway
  printf("after reverse: %s\n", a);
  return 0;
} 
```

请注意，我在内部创建了“Some string”的副本`a`（而不是直接分配`char* a = "Some String"`），因为尝试直接更改常量字符串将无法编译。如果您确实设法编译（例如，宽松的编译器，或者您通过 cast/const_cast 强制取消 constness），那么您的程序崩溃的风险非常高，因为“某些字符串”实际上是在读取的内存的一部分中- 仅在某些系统上，这就是为什么必须在局部变量（即在堆栈上）或新变量（使用 new 或 malloc 分配，即在堆上）内部进行复制的原因。

# c# - 我应该等到 VS 2010 发布后再购买 Resharper 吗？

> ID：571883
> 
> 赞同：7
> 
> 时间：2009-02-21T01:29:03.360
> 
> 标签：c#, .net, visual-studio, resharper

我已经用完了 30 天的试用期，现在想购买 Resharper。但是，我很穷，现在 150 美元对我来说太多了。

VS 2010 中有什么东西会让现在购买 Resharper 成为一个错误吗？我听说 VS 2010 就像 VS 2008 + Resharper。

我很难相信，但想在花钱之前问一下。

谢谢！

结果：我买了 Resharper，从那以后就没有后悔过。我全天多次使用它的代码导航和重构工具。没有它，我真的无法使用 VS2008。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T07:11:09.903

首先看看R# 4.5的前景，知道里面会包含什么：[http](http://resharper.blogspot.com/2008/07/whats-next-life-after-release.html) ://resharper.blogspot.com/2008/07/whats-next-life-after-release.html和[http:// abdullin.com/journal/2008/12/19/resharper-45.html](http://abdullin.com/journal/2008/12/19/resharper-45.html)
我确信 R# 也将成为 VS2010 的必备插件（JetBrains 花了几年时间研究它，这对 MS 来说很难很好地实现所有这些功能）。您还可以检查 R# 4.5 nightly builds 并将它们与 VS 的 beta 进行比较。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-21T01:33:43.957

从我目前看到的 VS 预览来看，2010 版有一些与今天的 Resharper 重叠的增强功能，但我确信 Resharper 的下一个版本会增加更多功能，以填补 VS 遗漏的新空白。这是一个永远向前的行军。

这并不能真正直接回答您的问题，但希望额外的信息能帮助您做出决定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-21T02:18:25.457

你可能会想到[这一点](http://codebetter.com/blogs/james.kovacs/archive/2009/01/19/visual-studio-2010-visual-studio-2008-resharper.aspx).. 我推迟了一段时间对 Resharper 的追求，但从那时起我就没有后悔过。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-21T10:38:23.993

我不知道没有 ReSharper 的人怎么能忍受 VS。乞求、借钱或偷钱买一本！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-21T07:33:39.817

FWIW，Resharper 在 3.x 和 4.x 之间有很好的升级策略。如果您在周期快要结束时购买了 3.x，您可以免费升级到 4.x。IIRC，这个差距超过了几个月，所以非常好。如果他们这样做，您可能会因提早购买而受益匪浅。Resharper 很棒，当我必须使用没有它的 VS 安装时，我现在有点生气！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-21T07:42:06.787

无论 VS2010 中的功能如何，Resharper 现在都值 150 美元中的每一分钱。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T14:53:04.897

好的，以略高于 150 美元的要价，我可以获得一个完整的操作系统。大家不觉得这有点陡吗？几乎每年一次，我被要求再花几百美元购买升级。所以，我问你，4.1 和 3.0 版本哪个更好。我有 3.0 并安装了 4.1 试用版，但没有看到价值 150 美元的改进。它可能会更少崩溃，但增加的功能不值 150 美元。我卸载并放回我的 3.0。它现在工作正常。也许 4.5 版本可能会有一些新的东西让它物有所值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T09:23:55.390

我很确定人们说 VS2008 就像 VS2005 + R#...我不认为这是真的。当然，VS 2005 引入了一些重构支持，但在 R# 中提供了更好的支持，而且 R# 不仅仅是重构。

我的建议，现在就买。无论如何，它将在 VS 2010 发货之前节省 150 美元的时间和精力（即使 VS 2010 下周发货，您仍然会获得收益，恕我直言）。

至于另一张海报对成本的评论。我同意这并不便宜，但我认为我的投资回报率大约是一周。换句话说，这是一项值得进行的投资。

PS。如果您喜欢 R# 并使用[StyleCop ，我强烈建议您查看名为](http://code.msdn.microsoft.com/sourceanalysis)[StyleCop for R#](http://www.codeplex.com/StyleCopForReSharper)的 R# 插件

# css - 使用相对/绝对位置居中元素的最佳技术？

> ID：571889
> 
> 赞同：1
> 
> 时间：2009-02-21T01:33:06.313
> 
> 标签：css

当我将父元素的位置属性设置为相对并将子元素的位置设置为绝对时，我试图获得一致的跨浏览器居中（子元素是我要居中的元素）

目前在 Firefox 中它不完全是中心，但它是 ie6/7（我在下面使用的示例）

```
#wrapper { min-width:995px; position: relative; }
#wrapper2 { margin:0 auto; z-index: 0; position: absolute; } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T01:38:29.577

你想水平居中，垂直居中还是两者兼而有之？

在任何一种情况下，使用边距和绝对值都是不兼容的。绝对位置使其脱离正常流程。如果您取出绝对位置，则内部 div 将正确水平居中。

无论您想做什么，居中（尤其是垂直居中）在纯 CSS 中都是一个大问题，尤其是在需要 IE6 支持的情况下。

如果必须在内部 div 上使用绝对定位，则几乎需要依赖像素定位，这意味着知道外部和内部 div 的固定大小（除了一些极端情况）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T02:14:35.060

如果您对 jQuery 方法感兴趣，我在几周前使用了以下方法：

```
$(window).load(function() {
    $("ul.recent-list div img").each(function() {
        var moveX = ($(this).width() / 2 * -1) + 18;
        var moveY = ($(this).height() / 2) * -1 - 18; // 18 is 1/2 the default offset of 36px defined in CSS
        $(this).css({'top' : moveY, 'left' : moveX});
    });
}); 
```

我必须拍摄一张未知尺寸的图像并将其放置在 36x36px 的“窗口”内，以便通过窗口只能看到图像的 36 平方像素区域`<div>`。

之所以`(window).load`需要，是`(document).ready`因为如果 document.ready 上的图像上没有定义宽度/高度属性，Safari 将无法使用 width() 和 height() 函数。由于我的图像尺寸不同，我不得不改用 window.load。

# c++ - 用于快速名称查找的容器

> ID：571890
> 
> 赞同：5
> 
> 时间：2009-02-21T01:33:06.767
> 
> 标签：c++, containers, std

我想存储字符串并为每个字符串发出一个唯一的 ID 号（索引就可以了）。我只需要每个字符串的一份副本，并且需要快速查找。我经常检查表中是否存在字符串，以至于我注意到性能下降。什么是最好的容器，如果字符串存在，我如何查找？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-21T01:38:01.687

我建议使用 tr1::unordered_map。它被实现为哈希图，因此它的查找复杂度为 O(1)，最坏情况为 O(n)。如果您的编译器不支持 tr1，那么还有一个 boost 实现。

```
#include <string>
#include <iostream>
#include <tr1/unordered_map>

using namespace std;

int main()
{
    tr1::unordered_map<string, int> table;

    table["One"] = 1;
    table["Two"] = 2;

    cout << "find(\"One\") == " << boolalpha << (table.find("One") != table.end()) << endl; 
    cout << "find(\"Three\") == " << boolalpha << (table.find("Three") != table.end()) << endl; 

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-21T17:00:43.200

试试这个：

[![alt text](https://i.stack.imgur.com/YFIqM.png)](https://i.stack.imgur.com/YFIqM.png)
[(source: [adrinael.net](http://adrinael.net/containerchoice.png))]

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T01:51:02.153

试试 std::map。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-21T04:03:14.723

**首先，**您必须能够**量化**您的选择。您还告诉我们，您感兴趣的主要使用模式是**查找**，而不是插入。

*让`N`是您希望在表中具有的字符串数，并让`C`是所述表中存在的任何给定字符串（或根据表检查的字符串）中的平均字符数。*

1.  在**基于散列的方法**的情况下，对于每次查找，您需要支付以下费用：

    *   `O(C)`- 计算您要查找的字符串的哈希值
    *   在`O(1 x C)`和之间，您期望根据哈希键遍历存储桶的成本`O(N x C)`在哪里，这里乘以根据查找键重新检查每个字符串中的字符`1..N``C`
    *   总时间：介于`O(2 x C)`和`O((N + 1) x C)`
2.  在**`std::map`基于 - 的方法**（使用红黑树）的情况下，对于每次查找，您需要支付以下费用：

    *   总时间：介于`O(1 x C)`和`O(log(N) x C)`- 其中`O(log(N))`是最大树遍历成本，并且`O(C)`是`std::map`通用`less<>`实现在树遍历期间重新检查查找键所需的时间

在大值的情况下`N`和没有保证小于 log(N) 冲突的哈希函数，或者如果你只是想安全地玩它，**你最好使用基于树的 ( `std::map`) 方法**。如果 N 很小，请务必使用基于散列的方法（同时仍确保散列冲突较低。）

但是，在做出任何决定之前，您还应该检查：

*   [http://meshula.net/wordpress/?p=183](http://meshula.net/wordpress/?p=183)
*   [http://wyw.dcweb.cn/mstring.htm](http://wyw.dcweb.cn/mstring.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-21T01:38:34.647

听起来像数组在索引是数组索引的情况下工作得很好。要检查它是否存在，只需确保索引在数组的范围内并且其条目不为 NULL。

编辑：如果你对列表进行排序，你总是可以使用应该具有快速查找的二进制搜索。

编辑：另外，如果你想搜索一个字符串，你也可以使用 a `std::map<std::string, int>`。这应该有一些不错的查找速度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-21T01:52:46.173

要搜索的字符串是静态可用的吗？你可能想看看一个[完美的散列函数](http://en.wikipedia.org/wiki/Perfect_hash_function)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T01:59:18.967

最简单的是使用 std::map。

它是这样工作的：

```
#include <map>
using namespace std;

...

   map<string, int> myContainer;
   myContainer["foo"] = 5; // map string "foo" to id 5
   // Now check if "foo" has been added to the container:
   if (myContainer.find("foo") != myContainer.end())
   {
       // Yes!
       cout << "The ID of foo is " << myContainer["foo"];
   }
   // Let's get "foo" out of it
   myContainer.erase("foo") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T16:56:21.277

[谷歌稀疏哈希](http://code.google.com/p/google-sparsehash/)可能

# php - Drupal 视图：生成 xml 文件

> ID：571892
> 
> 赞同：7
> 
> 时间：2009-02-21T01:33:43.990
> 
> 标签：php, drupal, drupal-6, drupal-views

是否有可用于生成 xml 文件的视图插件？我想要一些东西，我可以选择我想在 xml 中出现的字段以及它们的显示方式（作为标签或父标签的属性）。

例如：我有一个包含三个字段的内容类型图片：标题、大小和尺寸。我想创建一个可以生成如下内容的视图：

```
<图片>
  <图片尺寸="1000" 尺寸="10x10">
    <标题>
      标题
    </title>
  </图片>
  <图片尺寸="1000" 尺寸="10x10">
    <标题>
      标题
    </title>
  </图片>
...
</图片>

```

如果没有什么已经实施，我应该实施什么？我想过实现一个显示插件、一个样式、一个行插件和一个字段处理程序。我错了吗？

我不喜欢用模板来做这件事，因为我想不出一种方法让它可以用模板重用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-21T05:26:22.667

自定义样式插件绝对可以做到这一点；我抽出一个来输出 Atom 提要而不是 RSS。[从Views Bonus Pack](http://drupal.org/project/views_bonus)或[Views Datasource](http://drupal.org/project/views_datasource)开始，您可能会发现一点运气。两者都试图为 Views 数据提供 XML 和其他输出格式，尽管后者是 Google Summer of Code 项目并且最近没有更新。不过，绝对是一个潜在的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T03:10:43.380

您可能希望查看为 XML 实现另一个主题或使用[服务](https://www.drupal.org/project/services)模块。关于它的一些细节（来自它的项目页面）：

> 用于构建 API 的标准化解决方案，以便外部客户端可以与 Drupal 通信。开箱即用，它旨在支持 Drupal Core 支持的任何内容，并为其他模块提供代码级 API 以公开它们的特性和功能。它提供 Drupal 插件，允许其他人创建自己的身份验证机制、请求格式和响应格式。

另见： [http ://cmsproducer.com/generate-how-to-drupal-node-XML-XHTML](http://cmsproducer.com/generate-how-to-drupal-node-XML-XHTML)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-17T17:20:44.067

在 Drupal 8 中，服务模块现在是核心（RESTful Web 服务）的一部分。这将允许您在 xml 或 json 中提供任何实体。也有意见。

在此处阅读更多信息：[https ://drupalize.me/blog/201401/introduction-restful-web-services-drupal-8](https://drupalize.me/blog/201401/introduction-restful-web-services-drupal-8)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T03:11:35.360

[Drupal 论坛](http://drupal.org/node/104823)上对此过程的描述有些陈旧。它引用 Drupal 4.7 和 5.x。如果 Drupal 6 的代码不同，我怀疑 5.x 的步骤将是相同的技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-20T18:49:53.610

如果您使用 drupal 7 及其更高版本，您可以使用视图数据导出模块导出为 xml、xls、... [https://www.drupal.org/project/views_data_export](https://www.drupal.org/project/views_data_export)

# php - 我怎么写<< 我忘记了如何编写一个看起来像这样的命令 <<TOC bla bla bal bal TOC; 又是怎么写的？

> ID：571894
> 
> 赞同：0
> 
> 时间：2009-02-21T01:35:41.970
> 
> 标签：php, string, heredoc

我忘记了如何编写一个看起来像这样的命令

```
<<TOC

bla bla

bal bal

TOC; 
```

又是怎么写的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-21T01:37:19.893

这些被称为[heredocs](http://us3.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T01:39:06.643

它是这样工作的：

```
$foo = <<<TOKEN
multi
line
string
TOKEN; 
```

`TOKEN`可以是任何你想要的东西，只要你是并且用同样的东西结束heredoc。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T01:41:05.047

是的，这是使用heredoc的正确语法，但请确保TOC；行没有缩进，否则将不起作用。仅供参考，您可以将其称为任何您想要的名称，例如 HTML，而不仅仅是 TOC。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T02:41:13.513

很好的例子：

```
$foo = <<<TOKEN⁋
multi⁋
line⁋
string⁋
TOKEN;⁋ 
```

但是，这些不起作用

```
$foo = <<<TOKEN‧anything here⁋
multi⁋
line⁋
string⁋
TOKEN;‧anything here⁋ 
```

```
$foo = <<<TOKEN
multi⁋
line⁋
string⁋
‧TOKEN; 
```

```
$foo = <<<TOKEN
multi⁋
line⁋
string⁋
→TOKEN; 
```

结束标记必须单独一行，紧靠左边距，紧跟其后的分号，紧跟回车。

# xml - 管理 RSS 提要

> ID：571897
> 
> 赞同：0
> 
> 时间：2009-02-21T01:37:34.527
> 
> 标签：xml, rss, blogs

我正在为具有事件“列表”服务的网站进行开发。它使用 rss 提要（位于名称“rss.xml”下的 Web 根目录）向对服务感兴趣的用户提供事件的 RSS 提要。

我的任务是为该网站开发一个博客。我已经完成了博客文章，但我不确定将博客的 RSS 提要集成到网站的最佳方式。理想情况下，将来有些人会访问以阅读博客，而其他人可能会访问以使用该服务。

将博客 RSS 提要集成到网站的最佳方式是什么？我是否将事件列表和博客 RSS 提要合并到主 rss.xml 中，还是需要选择一个？我也想知道这如何影响使用 feedburner 等服务来跟踪订阅等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T01:42:32.393

您可能想要选择一个主要和一个备份。既然你可能是从你的活动而不是你的博客中赚钱，我会把这些活动作为你的主要活动。因此，您的事件将是 rss.xml，而您的博客将是 blogrss.xml

我还建议在您的页面上为您的 RSS 添加一个链接标签

```
<link rel="alternate" type="application/rss+xml" title="My Company&#39;s Events (RSS 2.0)" href="http://example.com/rss.xml"  />
<link rel="alternate" type="application/rss+xml" title="My Company&#39;s Blog (RSS 2.0)" href="http://weblogs.asp.net/scottgu/blogrss.xml"  /> 
```

# perl - Perl 的模板工具包可以警告未定义的值吗？

> ID：571898
> 
> 赞同：15
> 
> 时间：2009-02-21T01:37:38.533
> 
> 标签：perl, templates, warnings, template-toolkit

有没有办法让 Perl对我尝试在 (via ) 期间使用[指令](http://search.cpan.org/~abw/Template-Toolkit-2.20/lib/Template/Manual/Directives.pod#GET)`Template`的所有未定义值显示警告？[`GET`](http://search.cpan.org/~abw/Template-Toolkit-2.20/lib/Template/Manual/Directives.pod#GET)`[% %]``Template::process`

默认行为是忽略并继续。如果可能的话，我*只想*在未定义值的情况下发出警告，并将消息记录到 STDERR。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T21:25:47.133

您正在寻找：

```
DEBUG_UNDEF 
```

> 此选项会导致模板工具包在遇到未定义的变量值时抛出“undef”错误。

```
use Template::Constants qw( :debug );

my $template = Template->new({
    DEBUG => DEBUG_UNDEF,
}); 
```

（来自[http://search.cpan.org/dist/Template-Toolkit/lib/Template/Manual/Config.pod](http://search.cpan.org/dist/Template-Toolkit/lib/Template/Manual/Config.pod)。）

如果您想对异常进行一些特殊处理，则需要[捕获它或替换`__DIE__`信号处理程序](https://stackoverflow.com/questions/451227/how-can-i-get-around-a-die-call-in-a-perl-library-i-cant-modify/451236)。

* * *

让我们把它放在一起：

```
#!/usr/bin/perl

use strict;
use warnings;

use Template;
use Template::Constants qw( :debug );

my $debug_tt = Template->new({
   DEBUG => DEBUG_UNDEF,
});

my $tt = Template->new();

my $vars = {
    something => "42",
};

my $template = <<EOF;
First something undefined: [% nothing %].
And now something defined: [% something %].
EOF

my $output = '';

eval {$debug_tt->process(\$template, $vars, \$output)};
warn $debug_tt->error() if $debug_tt->error();

$tt->process(\$template, $vars); 
```

输出是：

```
undef error - nothing is undefined
First something undefined: .
And now something defined: 42. 
```

我的方法是使用 Template 类的两个不同实例：

1.  `$debug_tt`它`DEBUG_UNDEF`打开了标志并将其输出隐藏在`$output`变量中。

2.  `$tt`这是一个香草实例，并将其输出打印`STDOUT`为默认值。

两个实例都使用存储在 中的相同模板和存储在 中`$template`的相同变量散列`$vars`。 `$debug_tt`包裹在 an中以避免过早退出，如果为真， `eval`则会发出警告。正常执行。我认为这可以满足您的主要要求，尽管它可能效率不高。我们需要使用这种方法解析两次。`$debug_tt->error()``$tt``$template`

我在这方面的一些想法：

1.  `Template::Toolkit`如果使用它会很好`Carp`，这样我们就可以获得更多关于警告的上下文。

2.  人们可能会从 Template 派生一个类，`warn`而不是`die`出错。我不想那样做。

3.  根据您的模板的设置方式，一次输入一行可能是有意义的，这样您就可以在找到未定义的值时发出行号。

4.  应该可以更改模板以测试它们自己的错误并在面对未定义的值时发出更合理的文本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-21T01:56:37.380

是的。如果您将 DEBUG 选项传递给`Template->new`，TT 将警告您未定义的值。

请参阅此处的文档：[http ://search.cpan.org/dist/Template-Toolkit/lib/Template/Manual/Variables.pod](http://search.cpan.org/dist/Template-Toolkit/lib/Template/Manual/Variables.pod)

# html - html中是否有vr（垂直规则）？

> ID：571900
> 
> 赞同：155
> 
> 时间：2009-02-21T01:38:15.117
> 
> 标签：html

我知道 html 中有一个 hr（水平规则），但我不相信有一个 vr（垂直规则）。我错了，如果不是，为什么没有垂直规则？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-02-21T01:46:29.230

不，没有垂直规则。

编辑：现在是 2021 年（我回答这个问题 12 年后），我不再认为我原来的解释是正确的：

> （原解释）
> 
> 拥有一个是没有逻辑意义的。HTML 是按顺序解析的，这意味着您从上到下、从左到右布置 HTML 代码，您希望它如何从上到下、从左到右（通常）显示。vr 标签不遵循该范例。

我不确定为什么从未引入 VR 标签，但这可能不是因为解析 HTML 的方式——现在 HTML/CSS 中有许多不同的布局模式不遵循这个“范式”。

如果我现在推测为什么没有 VR 标签，我可能会查看[MDN 对 HR 标签的定义](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/hr)作为线索：

> HTML`<hr>`元素代表段落级元素之间的主题中断：例如，故事中的场景变化，或章节中的主题转移。

然而，在实践中，`<hr>`标签通常最终用于除语义之外的其他事物。尽管看起来应该有一个`<vr>`标签，但它可能与任何与`<hr>`标签的语义定义相关的东西都不同。可能从未想过要介绍它。

我的直觉是，创建者会建议解决这个问题的领域在于 CSS，而不是 HTML（这个 SO 问题的大多数答案都反映了这一点）。

[Nixinova 的解决方案](https://stackoverflow.com/a/56015580/5865)看起来是解决这个问题的最优雅和现代的解决方案。

（我的旧答案的其余部分如下）：

但是，使用 CSS 很容易做到这一点。前任：

```
<div style="border-left:1px solid #000;height:500px"></div> 
```

请注意，您需要指定高度或用内容填充容器。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-04-14T22:43:06.140

您可以像这样制作垂直规则：`<hr style="width: 1px; height: 20px; display: inline-block;">`

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2019-05-07T04:29:44.453

display:flex 中的 <hr> 将使其垂直显示。

JSFiddle：[https ://jsfiddle.net/w6y5t1kL/](https://jsfiddle.net/w6y5t1kL/)

例子：

```
<div style="display:flex;">
  <div>
    Content
    <ul>
      <li>Continued content...</li>
    </ul>
  </div>
  <hr>
  <div>
    Content
    <ul>
      <li>Continued content...</li>
    </ul>
  </div>
</div> 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-08-11T09:55:45.787

正如其他人所指出的，垂直规则的概念不符合 HTML 文档结构和表示背后的原始想法。然而，现在（尤其是随着网络应用程序的激增）有少数场景确实有用。

例如，考虑一个固定在屏幕顶部的水平导航菜单，类似于大多数窗口 GUI 应用程序中的菜单栏。您有几个从左到右排列的顶级菜单项，单击它们会打开下拉菜单。多年前，使用单行表创建它是一种常见的做法，但这是一个糟糕的 HTML，并且人们普遍认为正确的方法是使用高度定制的 CSS 的列表。

现在，假设您想对相似的项目进行分组，但在组之间添加一个垂直分隔符，以实现如下效果：

```
[Item 1a] [Item 1b] | [Item 2a] [Item 2b] 
```

使用`<hr style="width: 1px; height: 100%; ..." />`有效，但可能被认为在语义上不正确，因为您正在更改该元素的实际用途。此外，您不能在 HTML DTD 仅允许内联级元素（例如，在`<span>`元素内）的某些元素中使用它。

更好的选择是`<span style="display: inline-block; width:1px; height:100%; background:#000; margin: 0 2px;"></span>`，但并非所有浏览器都支持`display: inline-block;`CSS 属性，因此唯一真正的内联级选项是使用如下图像：

`<img src="pixel.gif" alt="|" style="width:1px; height:100%; background:#000; margin: 0 2px;" />`

这具有与纯文本浏览器（如 lynx）兼容的额外优势，因为显示的是竖线字符而不是图像。（M$IE 错误地使用 alt 文本作为工具提示仍然让我很恼火；这就是 title 属性的用途！）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-02-29T02:59:37.590

```
<style type="text/css">
.vr
{
  display:inline;
  height:100%;
  width:1px;
  border:1px inset;
  margin:5px
}
</style>

<div style="font-size:50px">Vertical Rule: &rarr;<div class="vr"></div>&larr;</div> 
```

试试看。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-01-07T13:59:34.890

怎么样：

```
writing-mode:tb-rl 
```

顶部->底部，右侧->左侧？

为此，我们需要垂直规则。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-05-31T18:07:35.477

试试这个。

**您可以在“ div** ”上设置高度和宽度，例如“ **hr** ”的范围。

“ **hr** ”的边距用于对齐。

```
<div style="display: inline-flex; width: 25px; height: 100px;">
  <hr style="margin: 0px 0px 0px 12.5px;">
</div>
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-08-27T05:55:12.663

我知道我很晚才添加我的答案，但我确信这是值得的。`flex`您可以使用和实现垂直线`hr`

[在这里](https://codepen.io/umeshmanglani/pen/yoxxxo)查看我的代码笔。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-21T01:39:34.740

没有，去哪了？

如果您想要类似的东西，请使用 CSS 在元素上放置右边框。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-03-10T13:22:11.403

古老的问题，但我解决了这个问题`display:flex;`，效果很好：

```
<div style="display:flex;border:1px dotted black;margin-bottom:20px;">
    <div>
        This is a div
    </div>
    <div style="border-left:1px solid black;margin:0 7.5px;"></div>
    <div>
        This is another div
    </div>  
</div> 
```

[https://jsfiddle.net/6qfd59vm/3/](https://jsfiddle.net/6qfd59vm/3/)

该解决方案也不需要固定高度。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-21T01:43:02.547

由于内容布局的排版性质，HTML 几乎没有垂直定位。垂直规则只是不符合它的语义。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-08-04T10:06:28.037

您可以通过 2 种方式进行操作：

1.  创建您已经在 div 中给出的样式，但将border-left更改为border-right
2.  拍摄图像并使其宽度为 1-2 px

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-08-01T18:47:02.657

试试看，你就会知道：

```
<body>
rokon<br />
rkn <hr style="width: 1px; height: 10px; display: inline; margin-left: 2px; margin-right: 2px;" />rockon<br />
rocks
</body>
</html> 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-12-17T07:39:27.713

在将列表项用作导航的上下文中，<vr /> 标签将非常有用。它不存在的原因是因为十年前在 HTML 的上下文中“拥有一个没有逻辑意义”。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-11-03T13:20:31.030

要在大多数桌面客户端的 HTML 电子邮件中使用，您必须使用表格。在这种情况下，您可以使用`<hr>`带有必要（但简单）内联样式的标签，例如：

```
<hr width="1" size="50"> 
```

当然，使用 CSS 的样式更灵活，但 GMail 和类似的不允许使用除内联之外的任何 CSS 样式...

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-01-26T16:14:57.547

您可以使用 css 模拟一条垂直线，并使用 div 上的类

```
.vhLine {
  border-left: thick solid #000000;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-01-03T10:34:04.057

你可以很容易地做到这一点

```
hr{
 transform: rotate(90deg);
}
```

```
<html>
<head>
</head>
<body>
<hr>
</body> 
</html>
```

注意hr的高宽

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-04-05T02:32:48.820

您可以这样创建自定义标签：

```
<html>
<head>
<style>
vr {
display: inline-block;
// This is where you'd set the ruler color
background-color: black;
// This is where you'd set the ruler width
width: 2px;
//this is where you'd set the spacing between the ruler and surrounding text
margin: 0px 5px 0px 5px;
height: 100%;
vertical-align: top;
}
</style>
</head>
<body>
this is text <vr></vr> more text
</body>
</html> 
```

（如果有人知道我可以把它变成“开放式”标签的方法，比如`<hr>`让我知道，我会编辑它）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-11-02T01:16:23.947

HTML 中没有标签，但可以使用 |。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-02T07:52:47.120

您可以使用新的 HTML5 SVG 标签：

```
<svg style="position:absolute;width:100%;height:100%;">
    <line id="myVerticalLine" y1="0" y2="100" x1="0" x2="0">
    </line>
</svg> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-03-10T14:25:20.337

*我发现制作线条图像*很容易，然后将其作为“规则”插入代码中，根据需要设置宽度和/或高度。这些都是水平规则图像，但没有什么能阻止我（或你）使用“垂直规则”图像。

这很酷有很多原因；您可以轻松地使用不同的线条、颜色或图案作为“规则”，并且由于它们没有文本，即使您在 HTML 中使用 hr 以“正常”方式完成它，它也不应该影响 SEO 或其他类似的东西那。并且图像文件将/应该非常小（最多 1 或 2KB）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-11-02T16:49:32.170

太多过于复杂的答案。只需使用行跨度创建一个跨越多少行的 TableData 标记。然后使用实际栏的右边框。

例子：

```
<td rowspan="5" style="border-right-color: #000000; border-right-width: thin; border-right-style: solid">&nbsp;</td>
<td rowspan="5">&nbsp;</td> 
```

确保第二行中的“ ”运行的行数与第一行相同。以便两者之间有适当的间距。

这种技术在我使用 HTML5 的过程中为我提供了很好的帮助。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-12-30T19:20:38.510

今天有可能`CSS3`

```
hr {
  background-color:black;
  color:black;
  -webkit-transform:rotate(90deg);
  position:absolute;
  width:100px;
  height:2px;
  left:100px;
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-07-29T09:03:24.817

对于尝试为文本创建列的人，您应该考虑使用[column-rule属性！](https://developer.mozilla.org/en-US/docs/Web/CSS/column-rule)

```
.content{
  margin: 20px 5%;
  padding: 5px;

}
.content p{
  -webkit-column-count: 3;
  -moz-column-count:3;
  -o-column-count:3;
  column-count: 3; 
  -webkit-column-rule: 1px solid #ccc;
  -moz-column-rule: 1px solid #ccc;
  -o-column-rule: 1px solid #ccc;
  column-rule: 1px solid #ccc;

  text-align: justify;
}
```

```
<div class="content">
  <p>
    Lorizzle ipsum tellivizzle sit amizzle, consectetizzle adipiscing elit. Nullam away things, shizznit stuff, suscipizzle shiz, gravida vizzle, funky fresh. Doggy phat tortizzle. Check it out its fo rizzle. Bizzle izzle shizzle my nizzle crocodizzle dapibus turpizzle tempizzle i'm in the shizzle. Mauris gizzle nibh et ghetto. Vestibulum ass phat. Pellentesque eleifend nizzle nisi. Fo shizzle my shizz shiznit fo shizzle dizzle. Donec dapibus. That's the shizzle uhuh ... yih! urna, pretium eu, mattizzle cool, shit things, nunc. Fizzle suscipizzle. Shizzlin dizzle semper daahng dawg boofron bow wow wow.

  </p>

</div>
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-02-27T16:07:04.300

```
<div style="width:1px;background-color:red;height:30px;float:right;"></div> 
```

可以使用这样的 div 轻松完成

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-07-19T11:56:51.237

# HTML5[自定义元素](http://www.html5rocks.com/en/tutorials/webcomponents/customelements/)（或纯 CSS）

[![在此处输入图像描述](https://i.stack.imgur.com/JSHK5.png)](https://i.stack.imgur.com/JSHK5.png)

## 1\. javascript

注册您的元素。

```
var vr = document.registerElement('v-r'); // vertical rule please, yes! 
```

**`-`在所有自定义元素中都是强制性的。*

## 2.css

```
v-r {
    height: 100%;
    width: 1px;
    border-left: 1px solid gray;
    /*display: inline-block;*/    
    /*margin: 0 auto;*/
} 
```

**您可能需要摆弄一下，`display:inline-block|inline`因为`inline`不会扩展到包含元素的高度。使用边距使线条在容器内居中。*

## 3\. 实例化

```
js: document.body.appendChild(new vr());
or
HTML: <v-r></v-r> 
```

**不幸的是，您无法创建自定义的自闭合标签。*

# 用法

```
 <h1>THIS<v-r></v-r>WORKS</h1> 
```

[![在此处输入图像描述](https://i.stack.imgur.com/T8NcY.png)](https://i.stack.imgur.com/T8NcY.png)

示例：[http ://html5.qry.me/vertical-rule](http://html5.qry.me/vertical-rule)

* * *

# 不想弄乱javascript？

只需将此 CSS 类应用于您指定的元素。

## css

```
.vr {
    height: 100%;
    width: 1px;
    border-left: 1px solid gray;
    /*display: inline-block;*/    
    /*margin: 0 auto;*/
} 
```

**见上面的注释。*

链接到[SO 上的原始答案](https://stackoverflow.com/a/31707873/985454)。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2009-02-21T01:40:30.417

那没有。

为什么？可能是因为有两列的表就可以了。

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2016-09-02T20:56:38.150

不，那里没有。我会告诉你一个小故事，为什么它不是。但首先， **快速解决方案：**

**`span`a) 对基本元素/使用 CSS 类`div`，例如`<span class="vr"></span>`：**

```
.vr{ 
   display: inline-block; 
   vertical-align: middle; 
   /* note that height must be precise, 100% does not work in some major browsers */
   height: 100px; 
   width: 1px; 
   background-color: #000;
} 
```

使用演示 => [https://jsfiddle.net/fe3tasa0/](https://jsfiddle.net/fe3tasa0/)

**`:first-child`b)如果您想在兄弟/邻居元素之间应用一般分隔符，**请使用仅一侧边框**和可能的 CSS选择器。**

 **# `<vr>` **关于FITTING**在原始范式中的故事，
但仍然不存在：

这里的许多答案表明，垂直分隔线不适合原始的 HTML 范例/方法**……这是完全错误的。** *答案也自相矛盾。*

那些人可能称他们的清晰 CSS 类为“clearfix”——浮动没有什么可修复的，你只是在清除它...... HTML3 中甚至还有一个元素：`<clear>`。可悲的是，这和清除浮动是少数常见的误解之一。

反正。在“原始 HTML 时代”中的“那时”，没有想到类似的东西，`inline-block`只有和。**`blocks`****`inlines`****`tables`**

`<vr>`最后一个其实是不存在 的原因。
**当时的假设是：**
*如果你想从左到右垂直划分一些东西和/或制作更多块 =>
=> 你正在制作/想要制作列 =>
=> 这意味着你正在创建一个表 =>
= > 表格在它们的单元格之间有自然的边界 =>* ***没有理由做一个`<vr>`***

这种方法实际上仍然有效，但随着时间的推移，表格的语法并不适用于所有情况以及它的默认样式。

* * *

另一个可能稍后的假设是，*如果您不创建表，则可能是浮动块元素*。这意味着它们粘*在一起*，而且你*可以再次设置边框*，那些日子甚至可能使用`:first-child`我上面建议的选择器......

# java - 为什么 Java EE 具有可扩展性？

> ID：571910
> 
> 赞同：17
> 
> 时间：2009-02-21T01:41:32.627
> 
> 标签：java, jakarta-ee

我从各种渠道听说 Java EE 具有高度可扩展性，但在我看来，您似乎永远无法将 Java EE 应用程序扩展到 google 搜索引擎或任何其他大型网站的水平。

我想听听它如此可扩展的技术原因。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-21T01:51:42.823

Java EE 被认为是可伸缩的，因为如果您考虑 EJB 体系结构并在适当的应用程序服务器上运行，它包括透明集群的设施并允许使用 EJB 的多个实例来服务请求。

如果您在plain-old-java 中手动管理事物，则必须自己弄清楚所有这些，例如通过打开端口、同步状态等。

我不确定您是否可以将 Google 定义为“大型网站”。这就像把互联网比作你的办公室局域网。Java EE 并不打算扩展到全球水平，这就是为什么像亚马逊和谷歌这样的网站使用他们自己的技术（例如，使用 MapReduce）。

有许多论文讨论了 Java EE 可伸缩性的效率。例如[这个](http://portal.acm.org/citation.cfm?id=974040)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-06-09T05:48:18.343

使 Java EE 可扩展的原因就是使*任何东西都*具有可扩展性：关注点分离。随着您的处理或 IO 需求的增加，您可以添加新硬件并以半透明的方式重新分配负载（主要对应用程序透明，对配置猴子显然不那么透明），因为分离的、孤立的关注点不知道或不关心它们是否在同一物理硬件或集群中的不同处理器上。

您*可以*使用任何语言或执行平台制作可扩展的应用程序。（是的，甚至是古老的 System 370 大型机上的 COBOL。）像 Java EE（当然还有其他的——Java EE 在这方面几乎不是独一无二的！）这样的应用程序框架让您能够**轻松**（相对而言）通过这样做来做到这一点为您承担大部分繁重的工作。

例如，当我的 Web 应用程序使用 EJB 来执行某些业务逻辑时，该 EJB 可能位于同一个 CPU 内核上、同一 CPU 的不同内核上、完全不同的 CPU 上，或者在极端情况下甚至可能跨行星。我不知道，在大多数情况下，只要性能在那里，我不在乎。同样，当我在消息总线上发送消息以进行处理时，我不知道也不关心该消息的去向，哪个组件进行处理以及该处理发生在何处，只要性能符合我的需要。这就是配置猴子要解决的所有问题。该技术允许这样做，并且有工具可以评估随着系统规模的扩大，哪些部分必须去哪里才能获得可接受的性能。

现在，当我尝试手动滚动所有这些时，我会立即从问题开始。如果我没有提前考虑所有的代理、调度和分发等，当我的应用程序扩展超出单台机器的处理范围时，我现在有重大的重写，因为我将一些应用程序转移到另一个盒子。然后每次我的能力增长时，我都必须一次又一次地这样做。

如果我确实提前考虑了所有这些，我会为每个应用程序编写大量样板代码，这些代码会对所有相同的事情进行微小的变化。我*可以*以可扩展的方式编写代码，但我是否想每次都这样做。该死的。时间。我写一个应用程序？

因此，Java EE（和其他框架）带来的是预先编写的样板文件，以满足制作可扩展应用程序的常见要求。当然，将我的应用程序写入这些并不能保证它们是可扩展的，但是这些框架使编写所说的可扩展应用程序变得更加容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-21T02:12:43.990

可以从基本框架（如 Java EE）提供的内容的角度来看待可扩展架构。但这仅仅是开始。

设计可扩展的基础设施是一门建筑艺术。这就像投影的艺术......当它被炸得很大时它会如何表现。基本问题是：

*   我在哪里保存常用的东西，这样当有这么多人要求时，我就不必花这么多时间（缓存）？
*   我在哪里保存每个人的东西，这样当有这么多个人需要保存东西时，我就不会在管理所有东西时遇到麻烦。
*   我怎么记得一个人上次来这里时做了什么，因为他们可能不会回到他们上次访问的同一个特定节点。
*   如果有这么多人要求，我需要等待（阻止）长时间运行的程序多长时间？

...这种事情超出了框架可以包装的范围。换句话说，该框架可能是可扩展的，但产品连接过于紧密而无法扩展。

Java EE 作为一个框架具有相当大的可扩展性，就像大多数现代的以微处理器为目标的企业框架一样。但我已经看到了惊人的（不是以一种好的方式）的东西，即使是最好的。

如需大量参考资料，请在 Google 中搜索“Designing for Scalability”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T10:47:17.980

“可扩展性”是关于“当您的应用程序不再适合单台计算机时，您会怎么做？”。

可扩展的应用程序可以在多于一台的计算机上增长。

请注意，大型服务器可能具有非常大的应用程序，具有大量内存和大量 cpu - 请参阅[http://www.sun.com/servers/highend/m9000/](http://www.sun.com/servers/highend/m9000/)或[http://www-03.ibm.com/systems/ i/hardware/595/index.html](http://www-03.ibm.com/systems/i/hardware/595/index.html) - 但它通常比拥有大量小型服务器且应用程序遍布它们更昂贵。

# wcf - 如何创建一个无需卸载即可在一台机器上运行任意次数的安装和部署项目？

> ID：571920
> 
> 赞同：3
> 
> 时间：2009-02-21T01:50:20.703
> 
> 标签：wcf, service, windows-installer, installation

如何创建一个无需卸载即可在一台机器上运行任意次数的安装和部署项目？

我创建了一个安装程序来将 WCF 服务安装到 IIS 目录。它不仅仅是 xcopy，它会询问用户问题以正确设置 web.config。

问题是它只能在每台服务器上安装一次而无需卸载。

“已安装此产品的另一个版本....”

通常，该服务将有每台服务器 10-15 个单独的实例（每个实例最有可能指向一个单独的数据库或不同的安全上下文）

我不知道如何设置安装程序来执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T20:12:50.570

好的，我有这个工作，我想我会回答它。

1.  我下载了 Orca windows installer 编辑工具（Windows SDK 的一部分）
2.  在 InstallExecuteSequence 表中，将以下值更改为 0

    **注册用户 注册产品 发布功能 发布产品**

这应该允许安装程序反复运行而无需卸载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T02:06:55.220

听起来您的程序将 2 个部分合并为 1 个 - 一个安装程序和 1 个基于 UI 的更新服务。您能否将两者分开并让安装程序检查是否已安装，如果是，则启动 UI 程序以运行配置设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:12:51.720

如果你想安装同一个应用程序的多个版本，你必须做 3 件事：

1.  确保每个版本都安装到不同的文件夹，因此后续安装不会覆盖以前的安装。您可以通过在部署项目的文件系统面板中更改应用程序文件夹的 DefaultLocation 属性来执行此操作。使用应用程序版本作为位置的一部分是一个很好的策略；例如 [ProgramFilesFolder]\[Manufacturer]\[ProductName]\[ProductVersion]。
2.  确保您的部署项目的 ProductCode 属性不同，因此后续安装不会卸载以前的版本。最简单的方法是...
3.  更改部署项目的 Version 属性。Visual Studio 将询问您是否要更改 ProductCode 属性；你做。

# algorithm - 构建或查找“相关术语”建议功能

> ID：571932
> 
> 赞同：8
> 
> 时间：2009-02-21T01:56:35.430
> 
> 标签：algorithm, web-services, nlp, graph-theory, semantics

给定几个单词的输入，我想要一个实用程序，它可以返回一组不同的相关术语、短语或概念。需要注意的是，它需要有一个大的术语图，否则该功能不会很有用。

例如，提交“棒球”将返回

```
["shortstop", "Babe Ruth", "foul ball", "steroids", ... ] 
```

[Google Sets](http://labs.google.com/sets)是我能找到的此类功能的最佳示例，但我无法使用它，因为它们没有公共 API（而且我不会违反他们的 TOS）。此外，单个单词输入不会获得非常多样化的结果。我正在寻找一个切线的解决方案。

我尝试过的最接近的方法是使用[WikiPedia 的 API](http://en.wikipedia.org/w/api.php)来搜索类别和反向链接，但没有办法直接按*"相关性"*或*"流行度"*对这些结果进行排序。没有它，建议列表就会很庞大，而且到处都是，这不是立即有用的，而且很难减少。

使用 A Thesaurus 也可以最低限度地工作，但这会遗漏任何专有名词或切线相关的术语（如上面列出的任何结果）。

* * *

我很*乐意*重用一个开放服务，如果存在的话，但我还没有找到足够的东西。

我正在寻找一种方法来实现这一点，要么*在内部使用大量**的**起始集*，要么*重用***提供此功能的***免费服务。*****

 *****有解决办法吗？*** *提前谢谢！*

* * *

**更新：** 感谢您提供令人难以置信的密集和信息丰富的答案。我将在 6 到 12 个月内选择一个成功的答案，届时我希望能理解你们所有人的建议 =)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-21T02:00:16.530

您可能对[WordNet](http://wordnet.princeton.edu/)感兴趣。理解 API 需要一点语言知识，但基本上该系统是英语单词之间基于含义的链接的数据库，这或多或少是您正在搜索的内容。如果您愿意，我相信我可以挖掘更多信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-21T16:07:49.957

[Peter Norvig](http://www.norvig.com/)（Google 的研究主管）在[Facebook 技术谈话](http://www.facebook.com/video/video.php?v=644326502463)中谈到了他们在 Google 是如何做到这一点的（特别提到了 Google Sets） 。这个想法是一个相对简单的算法在一个巨大的数据集（例如整个网络）上比一个复杂的算法在一个小数据集上要好得多。

您可以将[Google 的 n-gram 集合](http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html)作为起点。你会开始看到哪些概念被组合在一起。Norvig 暗示谷歌内部有多达 7-grams 用于[谷歌翻译](http://translate.google.com/)之类的东西。

如果你更有野心，你可以[下载](http://en.wikipedia.org/wiki/Wikipedia_database)你想要的语言的所有维基百科文章，并创建你自己的 n-gram 数据库。

如果你只有一个词，问题就更复杂了；查看[这篇最近的论文](http://ethesis.helsinki.fi/julkaisut/hum/yleis/vk/linden/wordsens.pdf)，了解有关词义消歧的更多详细信息。

这不是一个简单的问题，但正如您提到的那样很有用。最后，我想你会发现一个真正成功的实现会有一个相对简单的算法和大量的数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T15:09:42.263

请看以下两篇论文：

*   [聚类搜索引擎的用户查询 [pdf]](http://research.microsoft.com/users/jrwen/jrwen_files/publications/QC-WWW10.pdf)*   [通过聚类关键字进行主题检测 [pdf]](http://www.uni-weimar.de/medien/webis/research/workshopseries/tir-08/proceedings/18_paper_655.pdf)

这是我尝试进行非常简化的解释：

如果我们有一个过去用户查询的数据库，我们可以定义两个查询之间的相似度函数。例如：共同的单词数。现在对于我们数据库中的每个查询，我们计算它与其他查询的相似度，并记住 k 个最相似的查询。这些中不重叠的单词可以作为“相关术语”返回。

我们还可以对包含用户可能正在搜索的信息的文档数据库采用这种方法。我们可以将两个搜索词之间的相似度定义为包含两者的文档数除以包含其中任何一个的文档数。为了决定测试哪些术语，我们可以扫描文档并丢弃太常见的单词（“and”、“the”等）或太晦涩的单词。

如果我们的数据允许，那么我们可以查看哪些查询导致用户选择哪些结果，而不是按内容比较文档。例如，如果我们有数据显示搜索“Celtics”和“Lakers”的用户最终都点击了 espn.com，那么我们可以调用这些相关术语。

如果您从头开始，没有关于过去用户查询的数据，那么您可以尝试使用 Wikipedia 或[Bag of Words](http://archive.ics.uci.edu/ml/datasets/Bag+of+Words)数据集作为文档数据库。如果您正在寻找用户搜索词和结果的数据库，并且您喜欢冒险，那么您可以查看 AOL 搜索数据。

# c - 声明大数组时出现堆栈溢出异常

> ID：571945
> 
> 赞同：46
> 
> 时间：2009-02-21T02:10:15.773
> 
> 标签：c, arrays, memory, stack, allocation

以下代码为我生成堆栈溢出错误

```
int main(int argc, char* argv[])
{
    int sieve[2000000];
    return 0;
} 
```

我该如何解决这个问题？我正在使用 Turbo C++，但想将我的代码保留在 C 中

编辑：

感谢您的建议。上面的代码只是举例，我实际上在函数中声明了数组，而不是在 sub main 中。此外，我需要将数组初始化为零，所以当我搜索 malloc 时，我发现 calloc 非常适合我的目的。

Malloc/calloc 也比在堆栈上分配的优点是允许我使用变量声明大小。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-02-21T02:16:08.833

您的数组太大而无法放入堆栈，请考虑使用堆：

```
int *sieve = malloc(2000000 * sizeof(*sieve)); 
```

如果您真的想更改堆栈大小，[请查看此文档。](http://www.faqs.org/faqs/msdos-programmer-faq/part2/section-6.html)

*提示*： - 不要忘记在不再需要时释放动态分配的内存。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-21T08:42:47.233

有3种方式：

1.  `malloc()`正如其他海报所建议的那样，在堆使用上分配数组。不要忘记`free()`它（尽管`main()`它并不重要 - 操作系统会在程序终止时为您清理内存）。
2.  在单元级别声明数组 - 它将在数据段中分配并对所有人可见（添加`static`到声明将限制单元的可见性）。
3.  将您的数组声明为`static`- 在这种情况下，它将在数据段中分配，但仅在`main()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T02:17:02.653

您最好将其分配在堆上，而不是堆栈上。就像是

```
int main(int argc, char* argv[])
{
    int * sieve;
    sieve = malloc(20000);
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T03:04:06.457

这大约是 7MB 的堆栈空间。在 Visual Studio 中，您将使用 /STACK:###,### 来反映您想要的大小。如果你真的想要一个巨大的堆栈（可能是一个很好的理由，使用 LISP 或其他东西 :)，即使堆在强制你使用 VirtualAlloc 之前也仅限于 small'sh 分配），你可能还想将你的 PE 设置为构建/LARGEADDRESSAWARE（又是 Visual Studio 的链接器），但此配置是您的 PE 标头，以允许您编译的二进制文件寻址完整的 4GB 32 位地址空间（如果在 WOW64 中运行）。如果构建真正庞大的二进制文件，您通常还需要将 /bigobj 配置为附加的链接器参数。

如果您仍然需要更多空间，您可以通过使用类似于（再次 MSVC 的链接）/merge: 的东西来彻底违反约定，这将允许您将一个部分打包到另一个部分中，因此您可以将每个字节用于单个共享代码/数据部分。当然，您还需要在 def 文件或 #pgrama 中配置 SECTIONS 权限。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T06:59:56.130

使用malloc。所有检查返回类型是否为空，如果它为空，那么您的系统根本没有足够的内存来容纳那么多值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-04T06:01:51.380

你的数组很大。

您的机器或操作系统可能没有或不想分配这么多内存。

* * *

如果您绝对需要一个巨大的数组，您可以尝试动态分配它（使用`malloc(...)`），但是您有内存泄漏的风险。不要忘记释放内存。

malloc 的优点是它尝试在堆而不是堆栈上分配内存（因此不会出现堆栈溢出）。

您可以检查 malloc 返回的值以查看分配是成功还是失败。如果失败，只需尝试 malloc 一个较小的数组。

* * *

另一种选择是使用可以动态调整大小的不同数据结构（如链表）。此选项是否合适取决于您要对数据执行的操作。

另一种选择是将内容存储在文件中，即时流式传输数据。这种方法是最慢的。

如果您在硬盘驱动器上进行存储，则不妨使用现有库（用于数据库）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-13T20:02:40.277

由于 Turbo C/C++ 是 16 位编译器 int 数据类型，因此消耗大约 2 个字节。2bytes*2000000=40,00,000 bytes=3.8147MB 空间。

函数的自动变量存储在堆栈中，导致堆栈内存溢出。而是使用数据内存 [使用静态或全局变量] 或动态堆内存 [使用 malloc/calloc] 根据处理器内存映射的可用性创建所需的内存。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-21T08:46:13.573

有什么原因不能使用 alloca() 根据对象真正需要的大小在堆栈帧上分配所需的空间？

如果你这样做了，但仍然破坏了堆栈，请将其放入已分配的堆中。我强烈建议不要在 main() 中将其声明为静态并将其放入数据段中。

如果它**真的**必须那么大并且你的程序不能在堆上分配它，那么你的程序一开始就真的没有业务在那种类型的机器上运行。

你（确切地）想要完成什么？

# html - 有人可以详细解释清楚在这段代码中是如何工作的吗？

> ID：571950
> 
> 赞同：2
> 
> 时间：2009-02-21T02:12:35.457
> 
> 标签：html, css

我是 CSS 新手。我有一个顶部、右侧和内容 div。我希望它看起来像这样：

```
Top     Right

Content 
```

但是，它显示如下：

```
Top Content Right 
```

我知道我需要在某处清除，但我不确定在哪里，因为我不清楚清除实际上是如何工作的，所以有人可以解释下面的 html 代码我将在哪里应用清除以及我会选择哪种类型的清除（左，对，或两者兼而有之）。这是精简的html代码：

```
<div style="float:left; width:600px; height:100px; 
            border:1px solid black;">Top</div>
<div style="float:right; width:200px; height:800px; 
            border:1px solid red;">Right</div>
<div style="width:500px; height:600px; 
            border:1px solid blue;">Content</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-21T02:20:05.547

把`clear`内容放在`<div>`：

```
<div style="float:left; width:600px; height:100px; 
            border:1px solid black;">Top</div>
<div style="float:right; width:200px; height:800px; 
            border:1px solid red;">Right</div>
<div style="width:500px; height:600px; clear: both;
            border:1px solid blue;">Content</div> 
```

这会推动内容`<div>`，使其位于任何浮动元素下方（从左侧*或*右侧）。

附注：`id`为了方便起见，您可能应该使用 CSS 类或属性，而不是使用`style`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T02:33:39.600

尽管它并非在所有情况下都有效，但[WebToolkit 的 clearfix](http://www.webtoolkit.info/css-clearfix.html)技术有助于缓解大部分这些问题。

## 用法

```
<div class="clearfix">
  <div style="float:left;">left</div>
  <div style="float:right;">right</div>
</div>
<div>
  Some block content that doesn't overlap the floats
</div> 
```

另请参阅[演示](http://www.webtoolkit.info/demo/css/clearfix/demo.html)

## 代码

```
.clearfix:after {
    content: ".";
    display: block;
    clear: both;
    visibility: hidden;
    line-height: 0;
    height: 0;
}

.clearfix {
    display: inline-block;
}

html[xmlns] .clearfix {
    display: block;
}

* html .clearfix {
    height: 1%;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T02:17:43.120

在右 div 之后放置一个立即清除的 DIV：

```
<div style="float:left; width:600px; height:100px; 
            border:1px solid black;">Top</div>
<div style="float:right; width:200px; height:800px; 
            border:1px solid red;">Right</div>
<div style="clear:both;"></div>
<div style="width:500px; height:600px; 
            border:1px solid blue;">Content</div> 
```

# vim - 在 Vim 中撤消关闭选项卡

> ID：571955
> 
> 赞同：85
> 
> 时间：2009-02-21T02:14:53.670
> 
> 标签：vim, tabs

我在 vim 中关闭了一个选项卡，并立即意识到我需要重新打开它。有没有办法在 Vim 7.2 中撤消关闭选项卡？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-02-21T20:27:06.433

您的文件可能仍在缓冲区中打开：

```
:ls " get the buffer number
:tabnew +Nbuf " where N is the buffer number 
```

要重新打开缓冲区 18，例如：

```
:tabnew +18buf 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-03-26T19:19:22.953

```
:tabnew# 
```

在新选项卡中重新打开最近关闭的文件

* * *

**编辑**：请使用 grayfade 的答案。我不喜欢我的答案，但我将其保留在这里以供参考和有用的评论信息。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-23T11:52:31.707

我正在使用[MRU（最近使用的文件）插件](http://www.vim.org/scripts/script.php?script_id=521)。所以我可以编辑刚刚编辑的最后 30 个文件

以下是 MRU 插件元数据：

```
File: mru.vim
Author: Yegappan Lakshmanan (yegappan AT yahoo DOT com)
Version: 3.2   Last Modified:
September 22, 2008 
```

> 用法
> 
> 要列出和编辑 MRU 列表中的文件，可以使用 ":MRU" 命令。":MRU" 命令在一个临时的 Vim 窗口中显示 MRU 文件列表。如果 MRU 窗口已经打开，则刷新窗口中显示的 MRU 列表。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-21T02:54:39.567

简单的答案是否定的，没有任何内置的。

但是一个可行的解决方案是使用像优秀的[BufExplorer](http://www.vim.org/scripts/script.php?script_id=42)这样的插件。由于它默认首先列出最近使用的缓冲区，因此重新打开关闭的选项卡就像按下一样简单`\bet`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-12T06:43:24.783

使用插件 Ben 建议：[BufExplorer Github Mirror](https://github.com/vim-scripts/bufexplorer.zip)

在他的回答中，必须按`<Leader>be<Down>t`。添加一点快捷方式：

```
map <silent><leader>t <leader>be<Down>t 
```

这样就`<leader>t`可以完成工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-24T21:28:23.670

如果发生`BufferClose`事件，这将很容易......[但似乎不可能，因为创建窗口是不可能的](http://vim.wikia.com/wiki/Detect_window_creation_with_WinEnter)。

`TabLeave`但是对于选项卡，我们可以通过保持选项卡计数并计算和之间的差异来检测选项卡是否已关闭`TabEnter`。

用法：`<leader>tr`在新选项卡上重新打开最后关闭的选项卡（假设选项卡只有一个缓冲区）：

```
let g:reopenbuf = expand('%:p')
function! ReopenLastTabLeave()
  let g:lastbuf = expand('%:p')
  let g:lasttabcount = tabpagenr('$')
endfunction
function! ReopenLastTabEnter()
  if tabpagenr('$') < g:lasttabcount
    let g:reopenbuf = g:lastbuf
  endif
endfunction
function! ReopenLastTab()
  tabnew
  execute 'buffer' . g:reopenbuf
endfunction
augroup ReopenLastTab
  autocmd!
  autocmd TabLeave * call ReopenLastTabLeave()
  autocmd TabEnter * call ReopenLastTabEnter()
augroup END
" Tab Restore
nnoremap <leader>tr :call ReopenLastTab()<CR> 
```

# java - 在 Java 中禁用 Log4J 输出

> ID：571960
> 
> 赞同：92
> 
> 时间：2009-02-21T02:16:00.067
> 
> 标签：java, logging, log4j

如何使用文件快速关闭所有**Log4J**`log4j.properties`输出？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-02-21T02:22:01.500

将级别设置为 OFF（而不是 DEBUG、INFO、....）

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2011-07-18T17:42:04.480

如果您想以编程方式关闭日志记录，请使用

```
List<Logger> loggers = Collections.<Logger>list(LogManager.getCurrentLoggers());
loggers.add(LogManager.getRootLogger());
for ( Logger logger : loggers ) {
    logger.setLevel(Level.OFF);
} 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2009-02-25T09:42:27.667

```
 log4j.rootLogger=OFF 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-21T12:07:01.720

您可以将级别更改为关闭，这应该会删除所有日志记录。根据 log4j 网站，有效级别按重要性顺序为 TRACE、DEBUG、INFO、WARN、ERROR、FATAL。有[一个未记录的级别](http://supportweb.cs.bham.ac.uk/documentation/tutorials/docsystem/build/tutorials/log4j/log4j.html#LOG4J-Basics-Logger)称为 OFF，它比 FATAL 级别更高，并且会关闭所有日志记录。

您还可以创建一个额外的根记录器以不记录任何内容（级别关闭），以便您可以轻松切换根记录器。[这是一篇](http://www.velocityreviews.com/forums/t130166-log4j-disable-output-for-console-rootlogger.html)让你开始的帖子。

您可能还想阅读[Log4J 常见问题解答，](http://logging.apache.org/log4j/1.2/faq.html#2.3)因为我认为关闭所有日志记录可能无济于事。它肯定不会使您的应用程序加速那么多，因为无论如何都会执行日志记录代码，直到 log4j 决定它不需要记录此条目。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-09-05T17:08:20.167

此外，还可以通过编程方式关闭注销：

```
Logger.getRootLogger().setLevel(Level.OFF); 
```

或者

```
Logger.getRootLogger().removeAllAppenders();
Logger.getRootLogger().addAppender(new NullAppender()); 
```

这些使用进口：

```
import org.apache.log4j.Logger;
import org.apache.log4j.Level;
import org.apache.log4j.NullAppender; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-08-18T09:12:09.287

将级别更改为您想要的。（我使用的是 Log4j2，版本 2.6.2）。这是最简单的方法，更改为`<Root level="off">`

例如：文件`log4j2.xml`
**开发环境**

```
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
        </Console>
        <Console name="SimpleConsole" target="SYSTEM_OUT">
            <PatternLayout pattern="%msg%n"/>
        </Console>
    </Appenders>
    <Loggers>
        <Root level="error">
            <AppenderRef ref="Console"/>
        </Root>
    </Loggers>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="SimpleConsole"/>
        </Root>
    </Loggers>
</Configuration> 
```

**生产环境**

```
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
        </Console>
        <Console name="SimpleConsole" target="SYSTEM_OUT">
            <PatternLayout pattern="%msg%n"/>
        </Console>
    </Appenders>
    <Loggers>
        <Root level="off">
            <AppenderRef ref="Console"/>
        </Root>
    </Loggers>
    <Loggers>
        <Root level="off">
            <AppenderRef ref="SimpleConsole"/>
        </Root>
    </Loggers>
</Configuration> 
```

# c# - 自动 Cookie 处理 C#/.NET HttpWebRequest+HttpWebResponse

> ID：571964
> 
> 赞同：56
> 
> 时间：2009-02-21T02:17:31.840
> 
> 标签：c#, .net, cookies

有没有办法使用 HttpWebRequest/HttpWebResponse 对象自动处理 .NET 中的 cookie？我最好只在 .NET 环境中寻找与 LWP::UserAgent 及其行为 (perl) 等效的东西。

有什么建议或建议吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-02-21T03:44:05.423

我认为您正在寻找的是[CookieContainer](http://msdn.microsoft.com/en-us/library/system.net.cookiecontainer.aspx)类。如果我理解您要正确执行的操作，则您有单独的请求和响应对象，并且您希望将*响应*cookie 集合自动传输到下一个*请求*cookie 集合中。尝试使用此代码：

```
CookieContainer cookieJar = new CookieContainer();
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("http://www.google.com");
request.CookieContainer = cookieJar;

HttpWebResponse response = (HttpWebResponse)request.GetResponse();
int cookieCount = cookieJar.Count; 
```

一旦您创建了一个`cookieJar`并将其设置为请求的 CookieContainer，它将存储来自响应的任何 cookie，因此在上面的示例中，cookie jar 的计数将是`1`一旦访问 Google.com。上述请求和响应的 cookie 容器属性将存储指向 cookieJar 的指针，因此 cookie 会自动处理并在对象之间共享。

# css - 网络表单布局：表格或其他

> ID：571966
> 
> 赞同：0
> 
> 时间：2009-02-21T02:17:57.313
> 
> 标签：css, layout, webforms, xhtml, html-table

我必须创建一个看起来像这样的网络表单

```
列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列列
标签：输入 - 标签：输入
标签：输入 - 标签：输入 - 标签：输入
标签：输入 - 标签：输入
标签：输入
标签：输入 - 标签：输入
标签：输入 - 标签：输入 - 标签：输入 - 输入：标签
```

ETC..

现在做这件事的最好方法是什么？我一直在尝试使用 css 完成的方法，但我一次又一次地失败了。

我应该继续使用表格，还是有一种简单的方法可以用css做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T02:30:20.453

只需使用表格即可。表格适用于表格数据，例如具有列和行的内容……就像您的情况一样！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T02:23:56.817

您的示例格式没有采用吗？如果您只想要一个标签、输入控件和一个空格，只需将控件添加到页面，无需任何格式。HTML 将以这种方式布局。

但是，我假设您想要某种列。你有几种可能性。最不灵活的是绝对定位控件（标记）。

您可以使用表格，这将是最直接的。然而，纯粹主义者会争辩说，表格是用于数据的，而不是用于布局的。

您还可以使用浮动一系列 DIV 来表示列：一列表示标签，一列表示输入，第三列表示标签，第四列表示输入，等等。

编辑：如果您不担心标签与标签垂直排列并且输入与输入垂直排列，只需在每一列中放置一个标签+输入对，无论您选择哪种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T05:38:28.080

这样的事情怎么样？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <style type="text/css">
    .column {
      width: 200px;
      float: left;
    }

    .column label {
      clear: both;
      float: left;
      margin-right: 10px;
      margin-bottom: 5px;
      text-align: right;
      width: 75px;
    }

    .column input {
      float: left;
      width: 100px;
    }
  </style>
</head>

<body>
  <div class="column">
    <label>Label 1:</label> <input type="text" />
    <label>Label 2:</label> <input type="text" />
    <label>Label 3:</label> <input type="text" />
    <label>Label 4:</label> <input type="text" />
  </div>

  <div class="column">
    <label>Label 5:</label> <input type="text" />
    <label>Label 6:</label> <input type="text" />
    <label>Label 7:</label> <input type="text" />
    <label>Label 8:</label> <input type="text" />
  </div>
</body>
</html> 
```

如果您喜欢这样，您可以考虑使用字段集而不是列的 div。他们的风格很好，更语义化。无论哪种方式都很好。

# asp.net - asp.net mvc 查看代码

> ID：571971
> 
> 赞同：1
> 
> 时间：2009-02-21T02:20:29.460
> 
> 标签：asp.net, asp.net-mvc

我正在动态生成一个表格来呈现一些表格数据。通常我不会靠近桌子，但对于这种数据来说它是合适的。

我注意到我的视图代码变得非常像意大利面条。在循环体中的单元格和行上分配类开始看起来很糟糕（对我的 asp 3.0 天的糟糕闪回）。

我研究了对我的 DTO 使用运行时序列化到 json，然后使用 JQuery 插件对 JSON 进行模板化呈现。这似乎是一个“很酷”的想法，但它更像是一种编程练习，而不是我现在想做的事情。

人们如何使用 asp.net mvc 构建更多相关的 UI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T03:01:15.493

如果您担心视图标记与代码混合后的外观，您可以尝试使用备用视图引擎：

*   [火花](http://dev.dejardin.org/)
*   [速度](http://code.google.com/p/mvccontrib/source/browse/#svn/trunk/src/MvcContrib.Castle)
*   [抄网](http://code.google.com/p/mvccontrib/source/browse/#svn/trunk/src/MvcContrib.BrailViewEngine)
*   [氨基甲酸酯](http://code.google.com/p/nhaml/)

所有这些视图引擎都采用不同的方法来组合代码和标记，从而使您的视图标记“更干净”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T02:40:01.130

我编写了一些 HtmlHelper 扩展来帮助构建表格。这些扩展使用代码中的 TagBuilder 根据定义的值和 HTMl 属性生成行。使用这些扩展方法，视图代码相当干净，并且扩展方法本身是可测试的，以确保它们可靠地生成干净的代码。

示例视图代码：

```
<% var alternating = false;
   foreach (var model in Model) { %>
   <% using (Html.BeginTableRow( new { @class = alternating ? "alternating-row" : "" } )) { %>
       <%= Html.TableElement( model.Column1 ) %>
       <%= Html.TableElement( model.Column2, new { @class = 'some-class' } ); %>
       <%= Html.TableElement( model.Column3 ) %>
   <% }
      alternating = !alternating;
    %>
<% } %> 
```

此外，我实际上创建了一个网格控件，它将使用上面的方法生成一个样式表，并且我的大部分视图代码都包含使用正确的模型渲染网格控件。

```
 <% Html.RenderPartial( "GridControl", Model, ViewData ); %> 
```

# asp.net - 是否有任何带有录音示例代码的 ASP.NET？

> ID：571978
> 
> 赞同：3
> 
> 时间：2009-02-21T02:27:36.310
> 
> 标签：asp.net, flash, voice-recording

我想知道是否有任何带有录音功能的 ASP.NET 代码示例。

好的，基本上，我想创建一个网页，允许用户单击录制按钮并通过他/她的麦克风录制他的声音，然后将其转换为 mp3 文件，然后我想单击 PLAY 按钮播放录制的内容。

我已经搜索了很多谷歌，但找不到任何代码可以做到这一点。

我已经看到可以做到这一点的网站，它正在使用带有 RoR 的 FLASH（我认为）。

有没有办法使用 ASP.NET 录制语音？我不在乎它是否需要将 FLASH 与 ASP.NET 结合起来，只要可能。

谢谢。

编辑：

斯蒂芬·M·雷德，

感谢您的意见。是的，我知道没有简单的方法可以完成我的要求。我也对这个问题进行了很多研究和谷歌搜索。是的，我知道最好的方法是通过使用带有 FMS 或 RED5（开源）的 FLASH。

所以我想弄清楚如何编写一个简单的 FLASH (.swf)，我可以录制语音，然后以 mp3 格式保存到 RED5 服务器。

你知道或者你能提供我上面问的任何方向吗？

1) FLASH 中的麦克风类教程（我正在阅读一本名为“教室中的 FLASH Actionscript”的书的一些基本实现，它没有告诉我如何录制语音，而只告诉我如何在 FLASH 中使用麦克风对象）

2) 关于如何设置和使用 RED5 的教程（由于成本原因，FMS 不是一个选项）

3) 如何将 1) 和 2) 与 asp.net 和 javascript 集成（如果我可以访问 FLASH microphon .swf 的任何 flashvars，以便 ASP.NET 可以与 javascript 一起使用）

谢谢。

编辑2：

我不能考虑接受答案，因为他们都没有提供好的答案。

看看我的问题并阅读我得到的评论，你会发现我的问题没有得到很好的答案。

我的问题是找到一个基于网络的音频/录音机，以便用户可以在网站上录制他们的声音。

为了更好地传达我的确切要求，请查看 www.snapvine.com 或 www.pubclip.com。它们都为用户提供了一种在网页上直接录制语音的方式。

所以，我正在寻找一个类似于他们提供的与我的网站集成的 FLASH 组件 (.swf)。

编辑 3：

对于大多数开发人员来说，这种语音/麦克风录音似乎是一个具有挑战性的项目。

我想这意味着我一个人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T09:16:05.313

我认为这是必须用 Flash 完成的事情。

这家伙似乎有一些在 Flash 中进行语音录制的示例，以及代码示例：

[http://fms.denniehoopingarner.com/](http://fms.denniehoopingarner.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T09:09:54.117

没有简单的方法来做这种事情。基于 HTTP 和 HTML 的标准 Web 技术不具备这些功能。HTTP 不适用于移动音频数据，HTML 和 Javascript 无法直接与托管操作系统或麦克风等硬件资源对话。

您可以通过 Web 应用程序使用 3rd 方浏览器插件和小程序来执行此类操作。

大多数人使用 Flash 和[Flash Media Server](http://www.adobe.com/products/flashmediaserver/)通过 Web 进行音频输入。

还有一些 Java 小程序具有类似的功能，例如[ListenUp SDK](http://www.javasonics.com/)（我没有使用过这个，所以它不是背书）。

关于这个与 Microsoft Silverlight 相关的主题有很多讨论，但据我了解，从 Silverlight 2 开始不支持来自客户端的语音和摄像头输入，尽管它可能会被放入 Silverlight 3。有很多关于如何在 Silverlight 应用程序中使用必要的 Flash 位的信息。有关这方面的更多信息，请查看[这篇文章](http://russellgreenspan.blogspot.com/2009/01/microphone-access-in-silverlight-via.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-22T09:59:57.230

嗨 Sam 在 Silverlight 4 中可以从麦克风和网络摄像头录制声音。

只需关注博客。 [http://blog.ondrejsv.com/post/Audio-recorder-Silverlight-4-sample.aspx](http://blog.ondrejsv.com/post/Audio-recorder-Silverlight-4-sample.aspx)

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T00:02:12.107

ASP.net 是一种服务器端技术，但语音录制是在客户端完成的。所以不管你用的是 ASP.net、PHP、Ruby on Rails 还是 Cobol，你都不能直接做。

您需要的是一个与服务器端一起工作的客户端应用程序来完成此任务。我不知道 Silverlight 是否可以做麦克风录音，但 Flash 可以。这显然很容易使用[Flash Media Interactive Server](http://www.adobe.com/products/flashmediaserver/)，但通常您应该能够在没有的情况下做到这一点，即只需让 Flash 应用程序进行录制，然后将其上传到服务器。

# wpf - WPF 依赖属性问题......需要关于在这种特定情况下做什么的建议：

> ID：571981
> 
> 赞同：0
> 
> 时间：2009-02-21T02:30:04.120
> 
> 标签：wpf, dependency-properties

我正在尝试在 WPF 中创建一个数独（如填字游戏）播放器，我意识到我有一大堆控件需要知道数独网格才能运行。

正因为如此，我认为 Sudoku Grid 对象将是创建依赖属性的良好候选者。我即将开始工作，但我有一些挥之不去的问题：

1.  谁应该拥有 SudokuGrid 依赖属性？我在想主窗口 UI 元素应该。

2.  我是否应该将其设置为共享依赖属性，其中代表数独网格一部分的所有用户控件只需通过 .AddOwner() 方法将自己添加到属性中？

或者

将其设置为附加属性，在主窗口中定义，并允许子用户控件进行相应设置？

我真的不希望允许子控件设置他们自己的网格属性值，所以此时我倾向于共享依赖属性，但我不确定它是否符合我的想法。

最终我想要的是一个属性，如果它设置在父 UI 元素上，所有知道该属性的子 UI 元素将共享相同的值，覆盖任何先前的值/设置。共享依赖会这样做吗？

我知道这有点啰嗦，但任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T07:08:13.653

我认为您想要的是带有 Inherits FrameworkPropertyOption 的附加属性。我们每个想要了解网格的控件都可以通过获取附加属性的值来找到网格（假设它在树中设置得更高）。[本文](http://msdn.microsoft.com/en-us/library/ms749011.aspx)介绍了附加属性以及如何设置它们。

或者，您可能想尝试模型视图视图模型 (MVVM) 模式并将数独网格实现为视图模型类，其中每个单元格都是一个单独的视图模型类。这样，整个数独谜题就与 UI 完全分离，UI 可以使用适当的数据模板绑定到它。

有关 MVVM 模式的更多信息，请参阅以下内容：http: [//www.codeproject.com/KB/WPF/MVCtoUnitTestinWPF.aspx](http://www.codeproject.com/KB/WPF/MVCtoUnitTestinWPF.aspx) [http://blogs.msdn.com/johngossman/archive/2005/10/08/478683。 aspx](http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx)

# c# - 迭代类属性

> ID：571982
> 
> 赞同：17
> 
> 时间：2009-02-21T02:30:16.490
> 
> 标签：c#, properties, iteration

我正在尝试遍历 Color 类的 Color 属性。

不幸的是，它不在一个集合中，所以它只是一个具有一堆静态属性的类。

有谁知道是否可以迭代一个类的属性是静态的还是基于对象的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-21T02:33:41.100

是的，可以使用反射。特定颜色被定义为`Color struct`.

```
 PropertyInfo[] colors = typeof(Color).GetProperties(BindingFlags.Static|BindingFlags.Public);
 foreach(PropertyInfo pi in colors) {
     Color c = (Color)pi.GetValue(null, null);
     // do something here with the color
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T03:01:59.410

您可能也对此代码感兴趣

[http://blog.guymaheu.com/2006/07/11/deep-reflection-of-properties-propertyreflector/](http://blog.guymahieu.com/2006/07/11/deep-reflection-of-properties-propertyreflector/)

它提供了一种按名称设置/获取属性的简单方法。如果您查看 GetBestMatchingProperty，您会发现对属性的迭代，其完成方式与 [迭代类属性之前发布的相同](https://stackoverflow.com/questions/571982/iterating-over-class-properties/571988#571988)

# matlab - 免费的MATLAB环境

> ID：571985
> 
> 赞同：7
> 
> 时间：2009-02-21T02:32:20.587
> 
> 标签：matlab

我正在学习 MATLAB 语言，并希望有某种免费的环境来进行试验。MathWorks 提供的 MATLAB 环境是商业的。似乎有可用的试用版，但我不知道如何获得试用许可证。

目前，我只需要一个命令行和“标准库”。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-21T02:35:15.353

Octave 主要与 matlab 兼容：[http ://www.gnu.org/software/octave/](http://www.gnu.org/software/octave/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-03T13:33:26.530

如果您刚开始使用 MATLAB，我强烈建议您改用[Python](http://en.wikipedia.org/wiki/Python_(programming_language))路径（除非有一些非常具体的原因必须使用 MATLAB）。基础知识（如数组/矩阵运算）与 MATLAB 非常相似。

在我目前的工作领域（神经科学）中，有一个从 MATLAB 到 Python 的强烈迁移。由于 Python 是免费的并且通常更强大，因此许多团体都在进行转换。

您可能需要开始使用的基本包是[numpy](http://numpy.scipy.org/)（基本数组数字）、[scipy](http://www.scipy.org/)（更多算法）和[matplotlib](http://matplotlib.sourceforge.net/)（绘图）。由于您想在命令行上工作，我也建议使用[IPython](http://ipython.scipy.org/moin/)。

正如在另一个答案中已经提到的，还有一些 Python 发行版包含许多包，例如[PythonXY](http://www.pythonxy.com)、[Enthought Python Distribution](http://www.enthought.com/products/epd.php)或[Anaconda](https://store.continuum.io/cshop/anaconda/)。

网上有很多教程，搜索一下，选择一个你喜欢的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-21T02:47:23.687

看看这些：

*   [科学实验室](http://www.scilab.org/)
*   [八度](http://www.gnu.org/software/octave/)
*   [智者](http://www.sagemath.org/index.html)

阅读[Ryan Morlok 的这篇博文](http://www.morlok.net/ryan/2006/11/01/open-source-matlab-alternatives/)，了解有关开源 Matlab 替代品的更多信息。

[我是R](http://en.wikipedia.org/wiki/R_programming_language)的忠实粉丝，但它不是 Matlab 的替代品……它是一种替代品。有很大的不同！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T13:10:15.150

我最近迷上了 Python XY。它与 Matlab 不完全一样，但它具有许多相同的功能并复制了外观和感觉。如果我不想购买 Matlab 许可证，我会亲自使用它——如果我想用 Matlab 替身练习的话，我不会。

[www.pythonxy.com](http://www.pythonxy.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T09:39:37.300

其他用户已经给了你我会建议的例子——Octave 和 Scilab。在这两者中，我会说 Scilab 更强大，但 Octave 非常努力地与标准 MATLAB 源代码兼容，而 Scilab 则没有。

因此，如果您的目标是尝试类似 MATLAB 的语言并学习最终能够转移到 MATLAB 的技能，那么我建议您坚持使用 Octave。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-21T02:51:58.870

如果您有兴趣直接在 MATLAB 中进行尝试，最近在 MathWorks 网站上有一篇关于 MATLAB 及其各种工具箱的免费试用下载的[博客文章。](http://blogs.mathworks.com/desktop/2009/03/02/free-toolboxes/)如果您还没有尝试与他们联系，该博客链接[到此页面](http://www.mathworks.com/downloads/web_downloads/trials?s_cid=pl_trials)，您可以在其中请求产品试用，或者，如果您已经拥有许可产品，您可以登录并下载工具箱的试用版。

# statistics - 查找整数数组的平均值

> ID：571986
> 
> 赞同：4
> 
> 时间：2009-02-21T02:32:47.060
> 
> 标签：statistics, average

假设您有一个 int 数组（使用任何具有固定大小 int 的语言）。您将如何计算最接近其平均值的 int 值？

编辑：要清楚，结果不必存在于数组中。也就是说，对于输入数组 [3, 6, 7]，预期结果是 5。另外我想我们需要指定一个特定的舍入方向，所以如果你同样接近两个数字，就说向下舍入。

编辑：这不是家庭作业。我已经五年没有做作业了。这是我第一次使用stackoverflow，所以请友好！

编辑：总结和划分的明显方法可能会溢出，所以我试图考虑一种对于大型数组和大型整数来说安全溢出的方法。我认为正确处理溢出（不作弊和使用不同的类型）是迄今为止这个问题中最难的部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-21T03:32:36.137

这是一种快速、合理的溢出安全方法**，并且**可以在事先不知道元素数量时工作。

```
// The length of someListOfNumbers doesn't need to be known in advance.
int mean(SomeType someListOfNumbers) {  
    double mean = 0, count = 0;
    foreach(element; someListOfNumbers) {
        count++;
        mean += (element - mean) / count;
    }
    if(count == 0) {
        throw new UserIsAnIdiotException(
                  "Problem exists between keyboard and chair.");
    }
    return cast(int) floor(mean);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T02:45:22.523

嗯...如何计算平均值然后舍入为整数？`round(mean(thearray))`大多数语言都有允许您指定舍入方法的工具。

*编辑：*所以事实证明，这个问题实际上是关于避免溢出，而不是四舍五入。让我明确一点，我同意那些（在评论中）说这在实践中不需要担心的人，因为它很少发生，当它发生时，你总是可以使用更大的数据类型。

我看到其他几个人给出的答案基本上包括将数组中的每个数字除以数组的计数，*然后*将它们相加。这也是一个很好的方法。但只是为了好玩，这里有一个替代方案（在 C-ish 伪代码中）：

```
int sum_offset = 0;
for (int i = 1; i < length(array); i++)
     sum_offset += array[i] - array[i-1];
// round by your method of choice
int mean_offset = round((float)sum_offset / length(array));
int mean = mean_offset + array[0]; 
```

或另一种方法来做同样的事情：

```
int min = INT_MAX, max = INT_MIN;
for (int i = 0; i < length(array); i++) {
     if (array[i] < min) min = array[i];
     if (array[i] > max) max = array[i];
}
int sum_offset = max - min;
// round by your method of choice
int mean_offset = round((float)sum_offset / length(array));
int mean = mean_offset + min; 
```

当然，您需要确保`sum_offset`不会溢出，如果最大和最小数组元素之间的差异大于 INT_MAX，就会发生这种情况。在这种情况下，将最后四行替换为如下内容：

```
// round by your method of choice
int mean_offset = round((float)max / length(array) - (float)min / length(array));
int mean = mean_offset + min; 
```

琐事：这种方法，或者类似的方法，也适用于心理计算一个数组的平均值，该数组的元素聚集在一起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T02:34:56.790

通过将数字相加并除以它们的数量来计算总和，并进行四舍五入：

```
mean = (int)((sum + length/2) / length; 
```

如果您担心溢出，可以执行以下操作：

```
int mean = 0, remainder = 0
foreach n in number
   mean += n / length
   remainder += n % length
   if remainder > length
       mean += 1
       remainder -= length
if remainder > length/2
   mean += 1
print "mean is: " mean 
```

请注意，这不是很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T03:40:04.153

保证不溢出：

```
length ← length of list
average ← 0
for each result in the list do:
    average ← average + ( result / length )
end for 
```

如果由于截断而使用整数，这会导致严重的准确性问题（六个 4 的平均值为 0）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T04:44:27.277

ARM 组件。=] 未经测试。不会溢出。曾经。（我希望。）

大概可以优化一下。（也许使用 FP/LR？） =S 也许 THUMB 在这里会更好用。

```
.arm

; r0 = pointer to array of integers
; r1 = number of integers in array
; returns mean in r0
mean:
stmfd sp!, {r4,r5}
mov r5, r1

mov r2, 0          ; sum_lo
mov r3, 0          ; sum_hi

cmp r1, 0          ; Check for empty array
bz .end

.loop:
ldr r4, [r0], #4
add r2, r2, r4
adc r3, r3, #0     ; Handle overflow
sub r1, r1, #1     ; Next
bnz .loop

.end:
div r0, r2, r3, r5 ; Your own 64-bit/32-bit divide: r0 = (r3r2) / r5
bx lr 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-21T02:54:39.160

欢迎。鱼，希望您的逗留愉快。

以下伪代码显示了在总和适合整数类型的情况下如何执行此操作，并四舍五入到最接近的整数。

在您的示例中，数字加总和为 16，除以 3 得到 5 1/3，四舍五入为 5。

```
sum = 0
for i = 1 to array.size
    sum = sum + array[i]
sum = sum / array.size
sum = round (sum) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-21T03:00:18.227

获取**平均值**的伪代码：

```
double mean = 0
int count = 0
foreach int number in numbers
    count++
    mean += number - mean / count

round(mean) // rounds up
floor(mean + 0.5) // rounds up
ceil(mean - 0.5) // rounds down 
```

舍入通常涉及加 0.5，然后截断（下限），这就是为什么 3.5 舍入为 4。如果您希望 3.5**舍**入为 3，请自己执行舍入代码，但反过来：减去 0.5，然后找到上限。

*编辑：更新的要求（没有溢出）*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-21T03:17:33.833

此伪代码找到平均值并涵盖溢出问题：

```
double avg = 0
int count = 0
for x in array:
    count += 1
    avg = avg * (count - 1) / count   // readjust old average
    avg += x / count                  // add in new number 
```

之后，您可以应用舍入代码。如果没有简单的方法以您的语言进行四舍五入，那么这样的方法将起作用（超过 0.5 时四舍五入）：

```
int temp = avg - int(avg)   // finds decimal portion
if temp <= 0.5
    avg = int(avg)          // round down
else
    avg = int(avg) + 1      // round up 
```**************