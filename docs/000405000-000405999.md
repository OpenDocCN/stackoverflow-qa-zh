# StackOverflow 问答 000405000-000405999

# firefox - http-on-examine-response 观察者 - 可能阻止进一步处理的响应？

> ID：405010
> 
> 赞同：5
> 
> 时间：2009-01-01T14:46:13.020
> 
> 标签：firefox, xpcom

我正在尝试实现一个 firefox 扩展来过滤传入的 HTTP 响应并相应地处理它们。

我希望阻止包含特定标头的 HTTP 响应。阅读了一些 MDC 文章后，观察 HTTP 响应的最常见方法似乎是注册一个 http-on-examine-response 观察者。

我的问题是：使用这个观察者，是否可以阻止 HTTP 请求进一步处理（作为副产品，页面将继续等待响应）？或者我是否需要使用 XPCOM 的其他方面（如果需要，请指出我正确的方向）？

在此先感谢，
迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-10T20:25:02.143

应该是可能的：该通知的“主题”是一个 HTTP 通道，您可以在该通道上调用 nsIRequest::cancel()。

但是，该页面**不会**继续等待响应，因为您阻止了响应。也许您实际上一直在寻找[改变 HTTP 响应](https://stackoverflow.com/questions/1695440/altering-http-responses-in-firefox-extension)的方法？

# c++ - “永久”std::setw

> ID：405039
> 
> 赞同：33
> 
> 时间：2009-01-01T15:06:49.560
> 
> 标签：c++, templates, setw

有什么方法可以永久设置`std::setw`机械手（或其功能）吗？`width`看这个：

```
#include <iostream>
#include <iomanip>
#include <algorithm>
#include <iterator>

int main( void )
{
  int array[] = { 1, 2, 4, 8, 16, 32, 64, 128, 256 };
  std::cout.fill( '0' );
  std::cout.flags( std::ios::hex );
  std::cout.width( 3 );

  std::copy( &array[0], &array[9], std::ostream_iterator<int>( std::cout, " " ) );

  std::cout << std::endl;

  for( int i = 0; i < 9; i++ )
  {
    std::cout.width( 3 );
    std::cout << array[i] << " ";
  }
  std::cout << std::endl;
} 
```

运行后，我看到：

```
001 2 4 8 10 20 40 80 100

001 002 004 008 010 020 040 080 100 
```

即除了必须为每个条目设置的`setw`/之外，每个操纵器都占有一席之地。`width`是否有任何优雅的方式如何使用`std::copy`（或其他）`setw`？我所说的优雅当然不是指创建自己的仿函数或函数来将内容写入`std::cout`.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-01T15:39:05.423

好吧，这是不可能的。没有办法让它`.width`每次都再次调用。但是你当然可以使用 boost：

```
#include <boost/function_output_iterator.hpp>
#include <boost/lambda/lambda.hpp>
#include <algorithm>
#include <iostream>
#include <iomanip>

int main() {
    using namespace boost::lambda;
    int a[] = { 1, 2, 3, 4 };
    std::copy(a, a + 4, 
        boost::make_function_output_iterator( 
              var(std::cout) << std::setw(3) << _1)
        );
} 
```

它*确实*创建了自己的仿函数，但它发生在幕后:)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-08-07T01:53:37.190

由于`setw`并且`width`不会导致持久设置，因此一种解决方案是定义一个覆盖 的类型，在值之前`operator<<`应用`setw`。这将允许`ostream_iterator`该类型的功能`std::copy`如下所示。

```
int fieldWidth = 4;
std::copy(v.begin(), v.end(),
    std::ostream_iterator< FixedWidthVal<int,fieldWidth> >(std::cout, ",")); 
```

您可以定义：（1）`FixedWidthVal`作为模板类，其参数用于数据类型（`typename`）和宽度（值），以及（2）适用*于每个插入*`operator<<`的 an`ostream`和 a 。`FixedWidthVal``setw`

 *```
// FixedWidthVal.hpp
#include <iomanip>

template <typename T, int W>
struct FixedWidthVal
{
    FixedWidthVal(T v_) : v(v_) {}
    T v;
};

template <typename T, int W>
std::ostream& operator<< (std::ostream& ostr, const FixedWidthVal<T,W> &fwv)
{
    return ostr << std::setw(W) << fwv.v;
} 
```

然后它可以与`std::copy`（或`for`循环）一起应用：

```
// fixedWidthTest.cpp
#include <iostream>
#include <algorithm>
#include <iterator>
#include "FixedWidthVal.hpp"

int main () {
    // output array of values
    int array[] = { 1, 2, 4, 8, 16, 32, 64, 128, 256 };

    std::copy(array,array+sizeof(array)/sizeof(int), 
        std::ostream_iterator< FixedWidthVal<int,4> >(std::cout, ","));

    std::cout << std::endl;

    // output values computed in loop
    std::ostream_iterator<FixedWidthVal<int, 4> > osi(std::cout, ",");
    for (int i=1; i<4097; i*=2)
        osi = i; // * and ++ not necessary

    std::cout << std::endl;

    return 0;
} 
```

**输出（[演示](http://cpp.sh/24n)）**

```
 1,   2,   4,   8,  16,  32,  64, 128, 256,
   1,   2,   4,   8,  16,  32,  64, 128, 256, 512,1024,2048,4096, 
```

# java - 在 Java 游戏上轻松从 2D 移植到 3D

> ID：405042
> 
> 赞同：0
> 
> 时间：2009-01-01T15:08:00.947
> 
> 标签：java, 3d, 2d

由于缺乏资金和时间，我们不得不在 2D 中制作我们的游戏，尽管我（开发人员）更喜欢在 3D 中完成。我讨厌用户加入游戏，只是认为图形看起来很糟糕然后离开。虽然我想我们只需要尽力而为。

话虽如此，我想以这样一种方式开发游戏，即如果时机成熟，我们可以尽可能轻松地移植到 3D。我知道必须从头开始重写整个内容的游戏。我不想那样做，所以我想在游戏编程时使用一些技巧/指南，这样当我们转向 3D 时，它就像更改 1-5 个图形渲染类的代码一样简单（或关闭）并且 3D 图形将运行。

PS这是一个多人角色扮演游戏（*不是*MMORPG，现在规模要小得多）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-01T15:24:28.013

实现这一点的最简单方法是以 3D 编写游戏，并使用 3d 到 2d 投影（例如平面或立面）渲染视图。如果游戏的内部机制是 2D 的，并且您尝试移动到真正的 3d 帧，那么您可能会更好地重写。这在一定程度上还取决于您所说的 3D 是什么意思，以及您是否有有效的映射选项。例如，微软的帝国时代是 3D 渲染的，但作为 2D 计划可以很好地工作。另一方面，像《半条命》或《雷神之锤》这样的第一人称射击游戏则不会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T15:26:49.770

> 由于缺乏资金和时间，我们不得不在 2D 中制作我们的游戏，尽管我（开发人员）更喜欢在 3D 中完成。我讨厌用户加入游戏，只是认为图形看起来很糟糕然后离开。虽然我想我们只需要尽力而为。

我不认为一切都必须是 3D 才能看起来不错。做得好的 2D 看起来比一些标准的 3D 图形好很多倍。要获得出色的 3D 图形，您必须投入大量精力。如果您的预算不允许这样做，我宁愿尝试在游戏开发上投入大量精力。

想想（有点过时的）暗黑破坏神 II，它不是 3D 但仍然有一些漂亮和好看的图形。

当然可以构建一个可以更轻松地更改图形表示的体系结构，但我认为它几乎永远不会像您描述的那样简单。当然，如果您只是为了 3D 而需要 3D，则可以这样做（而不是您现在渲染 3D 模型的位图），但这有点毫无意义。如果你想使用 3D，玩家应该能够使用它（例如通过移动相机，拥有更多的自由度，......）但这必须在游戏的整个设计中加以考虑，因此要认真考虑影响游戏性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T15:27:01.830

您可以使用 GL 正交视图。这将允许您仅使用 2D 坐标在屏幕上绘制，如果您稍后想要 3D，请从正交视图切换到透视视图并且您拥有 3D，但是我认为它不会帮助您重用代码，因为 2D 正交视图通常使用纹理完成，您不能将纹理转换为 3D 网格。

也许更好的方法是在 3D 中完成所有操作，然后将相机设置为从上方看，如果您稍后这样做，您可以通过重新定位相机并制作更好的模型和纹理来切换到 3D。这个选项听起来更好，但在不更改代码的情况下，您可以在 2D 到 3D 的可移植性之间进行更多的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T15:24:13.067

[MVC](http://en.wikipedia.org/wiki/Model-view-controller)模式应该会有所帮助。

我想你已经知道了，但是你看过[Java3D](http://java.sun.com/javase/technologies/desktop/java3d/)吗？也许有一个基于此的可替换的 3D 渲染视图（但不一定是经过打磨和生产就绪的）将使您保持诚实，这样您就不会以某种可怕的方式与 2D 联系在一起。它可以像渲染你的 2D 东西一样简单，添加一些 Z 定位。

# c# - Response.Redirect 带有 # 锚点，在 IE7 中不起作用

> ID：405043
> 
> 赞同：0
> 
> 时间：2009-01-01T15:08:33.147
> 
> 标签：c#, asp.net, jquery-ui, internet-explorer-7, jquery-ui-tabs

```
Response.Redirect(string.Format("myprofile.aspx?uid={0}&result=saved#main",user.UserID)); 
```

所述代码转换为

**IE7** -`myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&result=saved`

**法郎**-`myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&result=saved#main`

为什么IE7会掉我的锚？

编辑：我应该提到我将它与 jQuery UI 的选项卡控件结合使用。我希望回发标签进入特定标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T16:46:02.387

也许这是 IE6 的回归问题？

您是否尝试通过[在它](http://blogs.vertigo.com/personal/tomphan/Blog/Lists/Posts/Post.aspx?ID=6)前面加上 & 来解决它？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T23:50:53.107

这将是相当的黑客，但如果 IE 没有表现，你可以这样做。

也传递一个参数，例如

```
uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&result=saved&hash=main#main 
```

然后在您的页面上（在正文关闭标记之前，或作为 onload 事件），仅适用于 IE，提取参数（如果存在）并手动设置哈希。

```
<!--[if IE]>
<script>
  if(document.location.href.indexOf('&hash=') != -1){
    //extract value from url...
    document.location.hash = extractedValue;
  }
</script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-09T18:50:15.273

我曾经`RegisterClientScriptBlock`发出`window.location`.

像这样的东西：

```
string url = String.Format("{0}RegForm.aspx?regId={1}#A", this.CurrentFolderUrl, this.RegId);

Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "redirectToClientPage", String.Format("window.location='{0}'", url), true); 
```

# iphone - 如何在objective-C中对字符串进行排序？

> ID：405047
> 
> 赞同：1
> 
> 时间：2009-01-01T15:16:18.637
> 
> 标签：iphone, objective-c, algorithm, memory-management, sorting

根据[这个](https://stackoverflow.com/questions/401834/how-to-elegantly-compute-the-anagram-signature-of-a-word-in-ruby)问题的答案，我正在寻找一种对字符串中的字符进行排序的 Objective-C 方法。

理想情况下，一个函数接受一个 NSString 并返回排序后的等价物。

此外，我想运行长度编码 3 个或更多重复的序列。因此，例如“mississippi”首先变为“iiiimppssss”，然后可以通过编码为“4impp4s”来缩短。

我不是Objective-C（更多Java和C++背景）方面的专家，所以我也想知道处理内存管理（保留计数等-iphone上没有GC）的最佳实践是什么此类函数的返回值。我的源字符串在 iPhone 搜索栏控件中，`NSString *`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-01T17:09:45.197

```
int char_compare(const char* a, const char* b) {
    if(*a < *b) {
        return -1;
    } else if(*a > *b) {
        return 1;
    } else {
        return 0;
    }
}

NSString *sort_str(NSString *unsorted) {
    int len = [unsorted length] + 1;
    char *cstr = malloc(len);
    [unsorted getCString:cstr maxLength:len encoding:NSISOLatin1StringEncoding];
    qsort(cstr, len - 1, sizeof(char), char_compare);
    NSString *sorted = [NSString stringWithCString:cstr encoding:NSISOLatin1StringEncoding];
    free(cstr);
    return sorted;
} 
```

返回值是自动释放的，所以如果你想在调用者中保留它，你需要保留它。不是 Unicode 安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T08:36:46.630

对于有界代码集，基数排序是最好的：

```
NSString * sortString(NSString* word) {
    int rads[128];
    const char *cstr = [word UTF8String];
    char *buff = calloc([word length]+1, sizeof(char));
    int p = 0;
    for(int c = 'a'; c <= 'z'; c++) {
        rads[c] = 0;
    }
    for(int k = 0; k < [word length]; k++) {
        int c = cstr[k];
        rads[c]++;
    }
    for(int c = 'a'; c <= 'z'; c++) {
        int n = rads[c];
        while (n > 0) {
            buff[p++] = c;
            n--;
        }
    }
    buff[p++] = 0;
    return [NSString stringWithUTF8String: buff];
} 
```

请注意，上面的示例仅适用于小写字母（从需要对小写字符串进行排序的特定应用程序复制）。要将其扩展为处理所有 ASCII 127，只需执行 for(c=0; c <= 127; c++)。

# python - 0x1A 上的线路读取扼流圈

> ID：405058
> 
> 赞同：13
> 
> 时间：2009-01-01T15:29:35.913
> 
> 标签：python, windows, binary-data

我有以下文件：

```
abcde
kwakwa
<0x1A>
line3
linllll 
```

其中`<0x1A>`表示十六进制值为 0x1A 的字节。当尝试在 Python 中读取此文件时：

```
for line in open('t.txt'):
    print line, 
```

它只读取前两行，然后退出循环。

解决方案似乎是以二进制（或通用换行模式）打开文件 - 'rb' 或 'rU'。你能解释一下这种行为吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-01T15:31:38.933

0x1A 是 Ctrl-Z，DOS 历史上使用它作为文件结束标记。例如，尝试使用命令提示符并“键入”您的文件。它只会显示 Ctrl-Z 上方的内容。

Python 使用 Windows CRT 函数 _wfopen，它实现了“Ctrl-Z 是 EOF”语义。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-01T17:13:22.457

[内德](https://stackoverflow.com/questions/405058/line-reading-chokes-on-0x1a#405061)当然是正确的。

如果您的好奇心更深入一点，那么根本原因是向后兼容性发挥到了极致。Windows 与 DOS 兼容，后者使用 Ctrl-Z 作为文本文件的可选文件结束标记。您可能不知道的是，DOS 与 CP/M 兼容，CP/M 在 PC 之前在小型计算机上很流行。CP/M 的文件系统没有跟踪文件大小到字节级别，它只跟踪软盘扇区的数量。如果您的文件不是 128 字节的精确倍数，您需要一种方法来标记文本的结尾。[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Ascii)暗示 Ctrl-Z 的选择是基于 DEC 使用的更古老的约定。

# c# - 使用部分类进行自动生成代码，如何设置文件命名等？

> ID：405059
> 
> 赞同：0
> 
> 时间：2009-01-01T15:30:24.913
> 
> 标签：c#, partial-classes

我有一个使用代码生成工具生成的 datalayer.cs 文件。

我将该类标记为部分类，因此我可以使用自己的手写数据层代码创建另一个文件。

我应该如何命名我的文件？

我应该这样做：

/data/partial/datalayer.cs /data/datalayer.cs

因此，当我再次运行代码生成器时，我只是将文件转储到源代码树中的 /partial/ 文件夹中。

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T15:38:35.363

VS 对生成的文件使用*Filename.Designer.cs*约定。你可能会做类似的事情。例如，您可能有*DataLayer.cs*和*DataLayer.Generated.cs*。我个人会将文件彼此相邻地保存在同一目录中，以帮助发现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T15:40:46.390

创建 Windows.Form 时由 IDE 生成的部分类命名如下：

```
/mydirectory/MyFormName.cs
/mydirectory/MyFormName.Designer.cs 
```

所以我建议像：

```
/mydirectory/datalayer.cs
/mydirectory/datalayer.autocodegen.cs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T16:18:00.057

我个人使用 ClassName_Generated.cs 生成文件。我个人更喜欢 _ 而不是 . 对于生成的分隔符。

# .net - 我可以在 XPath 表达式中使用正则表达式吗？

> ID：405060
> 
> 赞同：61
> 
> 时间：2009-01-01T15:31:27.203
> 
> 标签：.net, xml, regex, xpath

类似于`.//div[@id='foo\d+]`用`id='foo123'`.

如果这很重要，我正在使用.NET。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-01-01T21:32:24.527

正如其他答案所指出的，**[XPath 1.0](http://www.w3.org/TR/xpath)不支持正则表达式**。

**尽管如此，您有以下选择**：

*   **像这样使用 XPath 1.0 表达式**（注意[**`starts-with()`**](http://www.w3.org/TR/xpath#function-starts-with)and[**`translate()`**](http://www.w3.org/TR/xpath#function-translate)函数）：

```
.//div
   [开始于（@id，'foo'）
  和
   'foo' = translate(@id, '0123456789', '')
  和
   字符串长度（@id）> 3   
   ]

```

*   **使用[EXSLT.NET](http://www.codeplex.com/MVPXML/Wiki/View.aspx?title=EXSLT.NET&referringTitle=Home)** - 有一种方法可以[**直接在 XPath 表达式中使用其函数，而无需使用 XSLT**](http://msdn.microsoft.com/en-us/library/ms950808.aspx)。允许使用 RegEx-es 的 EXSLT 扩展函数是[**`regexp:match()`**](http://exslt.org/regexp/functions/match/index.html)：[**`regexp:replace()`**](http://exslt.org/regexp/functions/replace/index.html)和[**`regexp:test()`**](http://exslt.org/regexp/functions/test/index.html)

*   **使用** [**XPath 2.0**](http://www.w3.org/TR/xpath20/) / [XSLT 2.0](http://www.w3.org/TR/xslt20/)及其[**对正则表达式的内置支持**](http://www.w3.org/TR/xpath-functions/#regex-syntax)（函数[**matches()**](http://www.w3.org/TR/xpath-functions/#func-matches)、[**replace()**](http://www.w3.org/TR/xpath-functions/#func-replace)和[**tokenize()**](http://www.w3.org/TR/xpath-functions/#func-tokenize)）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-01T16:01:22.820

XPath 2.0 有一些支持正则表达式的函数：`matches()`, `replace()`, `tokenize()`.

在 XPath 1.0 中没有正则表达式支持。

对于 .NET，您可以使用 Saxon.Net 中的 XPath 引擎来支持 XPath 2.0。

因此，如果在 Saxon.NET 中使用 XPath 2.0 引擎，您的示例将转向：`.//div[matches(@id,'foo\d+')]`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T16:05:42.063

在 .NET 中，您可以通过扩展对象访问您的自定义类（如果您可以根据需要对其进行适当编码，则可以访问正则表达式）。

教程[在这里](http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=64)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-02T02:41:48.677

我也想这样做，所以创建了我自己的基本[xpath 模块](https://bitbucket.org/richardpenman/webscraping)。

# delphi - 在 Delphi 中将 TMyQuery 数据集覆盖到 TClientDataSet

> ID：405065
> 
> 赞同：2
> 
> 时间：2009-01-01T15:37:29.670
> 
> 标签：delphi, devart, mydac

我利用devart（corelab）的Mydac组件从Delphi（2006）访问MySql我经常需要处理TClientDataSet中的数据将TMyQuery的数据集转换为TClientDataSet的最佳方法是什么目前我正在使用

```
var
    MyQuery : TMyQuery;
    Dsp     : TDataSetProvider;
    Cds     : TClientDataSet;
begin
    MyQuery := nil;
    Dsp     := nil;
    Cds     := nil;
    try
        MyQuery            := TMyQuery.Create(nil);
        Dsp                := TDataSetProvider.Create(nil);
        Cds                := TClientDataSet.Create(nil);
        MyQuery.Connection := TheConnection;
        MyQuery.SQL.Text   := CmdStr;
        Dsp.DataSet := MyQuery;
        Cds.SetProvider(Dsp);
        Cds.Open;
        ////////////////////////////////////////////////////////////////////////
        ///                  MAKE USES OF THE CDS                             //
        ////////////////////////////////////////////////////////////////////////
    finally
        FreeAndNil(Cds);
        FreeAndNil(Dsp);
        FreeAndNil(MyQuery);
    end;
end; 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-01T16:29:13.717

如果你真的经常需要这个，那么让它成为一个函数，就像这样：

```
function CreateAndOpenClientDataset(AOwner: TComponent;
  AConnection: TConnection; ACommand: string): TClientDataSet;
var
  MyQuery: TMyQuery;
  Dsp: TDataSetProvider;
begin
  Result := TClientDataSet.Create(AOwner);
  try
    MyQuery := TMyQuery.Create(Result);
    MyQuery.Connection := AConnection;
    MyQuery.SQL.Text := ACommand;

    Dsp := TDataSetProvider.Create(Result);
    Dsp.DataSet := MyQuery;

    Result.SetProvider(Dsp);
    Result.Open;
  except
    Result.Free;
    raise;
  end;
end; 
```

您可以在所有地方使用此函数而不是 TClientDataSet.Create()，除非引发异常，否则您将获得一个开放的 TClientDataSet，它拥有并释放两个帮助对象。

（注意：我只使用 MS Sql Server 的 DevArt 组件，所以无法测试。代码可能包含错误，但总体思路可行。）

# php - Zend Pagination - 似乎不限制每页上的结果数量

> ID：405072
> 
> 赞同：1
> 
> 时间：2009-01-01T15:43:58.910
> 
> 标签：php, zend-framework, zend-paginator

我对 Zend 框架比较陌生，最多只使用它两个月。我现在正试图从我运行的查询中获取结果列表，通过 zend 分页器类发送它并每页显示 4 个结果，但是当它得到 4 个结果时它似乎没有识别出来，我相信有一个我的代码中有错误，但我一生都看不到它，我希望这里的某个人能够了解它并帮助我，并可能告诉我这是我错过的愚蠢行为。谢谢这里是我写的代码。

这是我模型中的查询

```
public function getAllNews()
{
    $db = Zend_Registry::get('db');

    $sql = "SELECT * FROM $this->_name WHERE flag = 1 ORDER BY created_at";

    $query = $db->query($sql);
    while ($row = $query->fetchAll()) {
        $result[] = $row;
    }

    return $result;
} 
```

这是我的控制器中的代码

```
function preDispatch()
{
$this->_helper->layout->setLayout('latestnews');
    Zend_Loader::loadClass('newsArticles');
    $allNews = new newsArticles();
    $this->view->allNews = $allNews->getAllnews();
    //die (var_dump($this->view->allNews));
    $data = $this->view->allNews;
    // Instantiate the Zend Paginator and give it the Zend_Db_Select instance  Argument ($selection)
    $paginator = Zend_Paginator::factory($data);
    // Set parameters for paginator
    $paginator->setCurrentPageNumber($this->_getParam("page")); // Note: For this to work of course, your URL must be something like this: http://localhost:8888/index/index/page/1  <- meaning we are currently on page one, and pass that value into the "setCurrentPageNumber"
    $paginator->setItemCountPerPage(1);
    $paginator->setPageRange(4);
    // Make paginator available in your views
    $this->view->paginator = $paginator;
    //die(var_dump($data));
} 
```

下面是构建分页器的视图，

```
 <?php if ($this->pageCount): ?> 
<div class="paginationControl">
<!-- Previous page link --> 
<?php if (isset($this->previous)): ?> 
  <a href="<?= $this->url(array('page' => $this->previous)); ?>">&lt; Previous</a> | 
<?php else: ?> 
  <span class="disabled">&lt; Previous</span> | 
<?php endif; ?> 

<!-- Numbered page links -->
<?php foreach ($this->pagesInRange as $page): ?> 
  <?php if ($page != $this->current): ?>
    <a href="<?= $this->url(array('page' => $page)); ?>"><?= $page; ?></a> | 
  <?php else: ?>
    <?= $page; ?> | 
  <?php endif; ?>
<?php endforeach; ?>

<!-- Next page link --> 
<?php if (isset($this->next)): ?> 
  <a href="<?= $this->url(array('page' => $this->next)); ?>">Next &gt;</a>
<?php else: ?> 
  <span class="disabled">Next &gt;</span>
<?php endif; ?> 
</div> 
<?php endif; ?> 
```

最后是构成我观点的代码

```
<div id="rightColumn">
                <h3>Latest News</h3>
                <?php if (count($this->paginator)): ?>
                    <ul>
                        <?php foreach ($this->paginator as $item): ?>
                            <?php
                            foreach ($item as $k => $v)
                            {
                                echo "<li>" . $v['title'] . "</li>";
                            }
                            ?>

                        <?php endforeach; ?>
                    </ul>
                <?php endif; ?>

<?= $this->paginationControl($this->paginator, 'Sliding', '/latestnews/partial_pagination_control.phtml'); ?> 
                </div> 
```

我会很感激你能给我的任何帮助。

谢谢

西科

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-04T11:08:38.890

$paginator 应该设置为 4 因为你想一次只显示 4 条记录：

```
$paginator->setItemCountPerPage(4); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T01:14:44.067

如果您希望它限制您的查询，您不应该将值传递给分页器。有一个代码会为你工作

```
$usersTable = $this->getTable();
        $registerSelect = $usersTable->select()->where('status = ?', 'OK')->order('lastLogin DESC');
        $paginator = new Zend_Paginator(new Zend_Paginator_Adapter_DbTableSelect($registerSelect));
        $paginator->setCurrentPageNumber($page);
        $paginator->setItemCountPerPage($limit); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T18:23:21.287

所以我认为你的问题的根源在于你的带有 getAllNews 函数的模型类。Zend_Db fetchAll 函数检索与查询匹配的所有记录的关联数组。您将返回一个包含一个元素的数组，该元素是您的 select 语句检索到的所有行的数组。

尝试这个：

```
public function getAllNews()
{
        $db = Zend_Registry::get('db');

        $sql = "SELECT * FROM $this->_name WHERE flag = 1 ORDER BY created_at";

        return $db->fetchAll($sql);
} 
```

# apache-flex - 检索 SharedObject 时出现 Flash/Flex 错误 #1063

> ID：405073
> 
> 赞同：0
> 
> 时间：2009-01-01T15:47:07.047
> 
> 标签：apache-flex, flash, actionscript, shared-objects

我有一个基于 Flex 3 构建的部件应用程序，但部件列表有问题。零件清单使用两个对象：

*   部分
*   ArrayOfPart

我将部件列表本地缓存在 SharedObject 中。**这几个月来一直运行良好**。我在 Part 类中添加了一个新的布尔属性并重新导入了 Web 服务（这不应该影响任何东西），现在，**我可以很好地保存 ArrayOfPart SharedObject，但是当我尝试检索 SharedObject 时，我得到“ArgumentError：错误 #1063: ArrayOfPart 上的参数计数不匹配。预期为 1，得到 0。然后它完全删除了我的 SOL 文件。**

*（我在 Part 和 ArrayOfPart 上使用了 RegisterClass，所以它们都可以序列化为 SharedObjects）*

**这是我收到错误的步骤：**

**保存共享对象：**

```
so = SharedObject.getLocal("PartsList");
so.data.AllParts = AllParts;
so.flush(); 
```

**验证 SharedObject：**

*   SharedObject **PartsList.sol**存在于应有的位置
*   我打开了 SharedObject 文件，ArrayOfPart 数据看起来有效

**重新启动应用程序，它会从 SharedObject 中检索部件列表。这是引发错误 #1063 并导致 sol 文件被删除的行：**

```
so = SharedObject.getLocal("PartsList"); 
```

看起来数据保存在 SharedObject 中时可能格式不正确？这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T20:06:03.187

我解决了我自己的问题。

ArrayOfPart 有一个带参数的构造函数。当我删除构造函数时，错误消失了。

顺便说一句，这是 Flash 9。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T19:30:17.237

这看起来很艰难。

我不认为这是一个形成或序列化问题。也许您的代码中的其他内容正在写入共享对象？

有什么方法可以分享你的资源吗？这会有所帮助，因为我个人没有足够的信息来诊断没有看到其余代码的情况:(

还....

是否还有其他内容正在写入或更改此共享对象？

我的所有对象都是在 AS3 中创建的，还是在 MXML 中创建的（我注意到 Flex 编译器并不总是能很好地找出 MXML）。

我有什么版本的 Flash？

如果它的 Flash 10 是否会在 Flash 9 中出现同样的问题？

这是否发生在所有浏览器和所有平台上？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T19:58:17.960

只是一种预感，但是，自从我安装了 Flash Player 10，我在浏览时看到很多共享对象的错误。可能与新引入的沙盒/安全限制有关吗？

# php - 如何保存用户制作的 HTML 页面？

> ID：405076
> 
> 赞同：-1
> 
> 时间：2009-01-01T15:52:10.360
> 
> 标签：php, javascript, html

我制作了一个拖放实用程序，使用户可以直接在工作场所拖放元素并创建他们的页面，但我发现如何将用户的工作保存为 HTML 页面！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T16:08:38.750

你的意思是所有元素的位置？遍历它们并保存它们的位置怎么样？如果你使用 jQuery，你可以这样做：

```
var positions = new Array();
function savePositionOfAllDivs() {
 $('div').each( function(){
  $this = $(this);
  id = $this.attr('id');
  position = $this.position();
  left = position.left;
  top = position.top;
  positions[id] = new Array();
  positions[id]['left'] = left;
  positions[id]['top'] = top;
 }
} 
```

然后将位置数组发送到某个服务器端脚本，将其转换为 CSS，然后您可以将其嵌入到用户可以下载的 HTML 页面中。

（有了更多关于你试图做什么的具体信息，这可能会更容易和更有效。假设这是一个订单拖放功能，那么你只需要保存 div 的顺序）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T15:55:58.013

嗯，.. 按保存按钮？不过说真的，我认为您可能想在您的问题上提供更多信息，例如您正在使用什么系统等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T16:23:44.337

document.getElementsByTagName("BODY")[0].innerHTML

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T21:35:20.043

也许使用 XPath。你可能会发现[这个](https://stackoverflow.com/questions/354322/finding-a-node-or-close-to-it-using-xpath-in-non-well-formed-html)关于 SO 的讨论很有用。

编辑：或者也许你可以用 Node.childNodes 做某事。[有关更多信息，请在此处](https://developer.mozilla.org/En/DOM/Node.childNodes)查看 MDC

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T22:00:44.233

大多数 jQuery 拖放库都能够将要移动的元素序列化到可以保存的数组中。如果你给我你正在使用的特定库的链接，我可以告诉你如何利用它。

但是，如果您自己制作，您将不得不尝试上述建议之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T11:44:57.527

我正在使用 jquery ，并且我制作了一个拖放实用程序，您可以使用它在页面内放置一些 html 元素，我需要知道如何将用户的工作保存在他可以下载的 HTML 文件中，或者可以在之后查看他的工作保存它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T22:42:23.423

我需要与 porta 相同的解决方案。我的场景是我正在构建一个拖放 cms。用户可以拖放 html 元素来构建他们的页面。现在我如何保存这些更改（到 db 或会话 var），并且必须能够创建一个静态页面，其中包含用户使用 php.ini 所做的所有上述更改。有人可以阐明一下。我对 jquery 完全陌生，不会认为自己是 php 专家。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-01T23:42:40.440

您是想找出将 HTML 和 CSS 从前端传输到服务器的最佳方式，还是将 HTML 保存在服务器上的最佳方式（如在数据库或文件中）？

# java - 开始使用 Java 的简单 3D 用户界面的最佳方式是什么？

> ID：405078
> 
> 赞同：1
> 
> 时间：2009-01-01T15:53:47.533
> 
> 标签：java, 3d

我正在编写一个时间管理应用程序，并且我有一个以 3D 形式呈现时间线和待办事项的想法。在视觉上，我将其想象为以 3D 形式俯视走廊或高速公路，即将到来的截止日期和任务表示为路标——更重要的项目更大，即将到来的截止日期更近。

我想用 Java 做这个，但是我不知道如何开始。例如，我希望能够在走廊的地板/墙壁以及任务项目上渲染文本和 2D 图形（日期、日历等）。任务本身可以是简单的块。然而，我看到的 3D 代码示例都看起来在非常低的级别上运行，我无法弄清楚要使用的适当坐标，或者用户如何通过选择与视图交互使用鼠标的项目（例如单击展开或信息按钮以使用通常的摆动组件获取/编辑任务属性）。

有没有我可以使用的更高级别的 API，或者做这种事情的示例代码？关于如何最好地解决这个问题的任何其他想法？

*编辑：删除 Java3D 要求 - 我只需要在 Java 中执行此操作。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T18:42:36.723

老实说，大多数“聪明”的用户界面都无效，原因有很多：

*   他们更喜欢复杂性（为了酷）而不是简单性和可用性。
*   用户可能完全不熟悉它们。
*   您必须自己实现它们，而无需某些库为您完成艰苦的工作。

我认为你描述的界面有落入这个陷阱的风险。当前界面有什么问题？由于前景的阻碍，是否真的很难获得概览？当然，现在您可以更进一步，缩小/旋转以获得概览，但这会使事情复杂化。

说了这么多，如果你可以让它易于使用并且*非常*流畅，那么它可以制作一个应用程序。用户对“花哨”用户界面的失败容忍度较低，因此这可能不是最好的第一个 3D 项目。

我确实认为需要更多面向可视化而不是游戏的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T16:35:27.543

老实说，两者都试过了，如果你改用 JOGL，你会发现有大量的 OpenGL 示例可以从中复制这种东西，而且你不必围绕 Java3D 给你的场景图的限制编写代码。几年前，我在一个简单的线框查看器中尝试了 Java3D，但要让相机控制正确并且渲染几乎可以，我放弃了它，这真是太痛苦了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-06T15:05:29.020

我发现[Pro Java 6 3D Game Development](http://fivedots.coe.psu.ac.th/~ad/jg2/)包含非常好的代码示例。

这是来自[NeHe Productions](http://nehe.gamedev.net/)的 3D 文本[代码示例！](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=14)，查看示例末尾的“DOWNLOAD Java Code”和“DOWNLOAD JoGL Code”。

[顺便说一句， LWJGL](http://www.lwjgl.org/)给我留下了深刻的印象，它让您以与直接 OpenGL 非常相似的方式编写代码。

# sharepoint - 使用 SPGridView 的 SharePoint 自定义网站页面上的 Viewstate 错误

> ID：405082
> 
> 赞同：0
> 
> 时间：2009-01-01T16:02:27.233
> 
> 标签：sharepoint, spgridview

我在 Windows SharePoint Services 3.0 中有一个自定义网站页面，其中包含一个 SPGridView。当我使用此页面上的搜索框时，我收到以下错误：

```
Unable to validate data.   at System.Web.Configuration.MachineKeySection.EncryptOrDecryptData(Boolean fEncrypt, Byte[] buf, Byte[] modifier, Int32 start, Int32 length, IVType ivType, Boolean useValidationSymAlgo) 
   at System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) 
```

从页面中删除 SPGridView 可以解决此问题，但否则我不确定如何解决问题。

这是 WSS3 的全新默认安装，所以我认为它与任何其他自定义（母版页等）无关。我在此功能中还有另一个自定义站点页面（不包括 SPGridView），但我可以使用该页面上的搜索框而不会导致错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T19:55:25.553

好的，我终于弄清楚了问题所在（无论如何，在我的特殊情况下）：我正在指定 SPGridView 的 DataKeyNames 属性。删除该属性后，搜索工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T16:18:17.407

应用程序是否在 webfarm 环境中运行？
如果是这样，必须在 web.config 中设置 machineKey：
我们使用来自[eggheadcafe](http://www.eggheadcafe.com/articles/GenerateMachineKey/GenerateMachineKey.aspx)
的 machineKey 生成器 更多关于 Viewstate 和 webfarms 的信息[在这里](http://www.codinghorror.com/blog/archives/000132.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T18:19:03.013

SharePoint 中的搜索框似乎使用了母版页底部的隐藏字段。
< input type="text" name="__spDummyText1" style="display:none;" size=1/>
< input type="text" name="__spDummyText2" style="display:none;" size=1/> 因此，如果您对 application.master 或 Utility Content Placeholder 中的这些字段进行了任何操作，它将无法正常工作。
另一方面，我们一直在页面中使用 SPGridView 没有任何问题。

# php - PHP中的开发和生产环境

> ID：405092
> 
> 赞同：12
> 
> 时间：2009-01-01T16:12:50.053
> 
> 标签：php, web, testing, environment

我想为我用 PHP 编写的新网站设置两个环境。一 - 开发新版本并对其进行测试。第二个产品将提供我实际稳定的网站版本。

PHP 中的网站将包含许多 PHP 和其他文件（JS、图像等）。所以我想如何以最好的方式准备这个环境，以便于进行源代码控制，快速将网站从开发环境复制到生产环境，并使开发版本可供网络上的人们使用，以便他们能够看到实际的工作进度并建议更改或报告错误。

您能否给我一些建议，从这个起点到哪里去？有没有关于这方面的书（从实际的角度来看？）或者你有经验或提示需要注意什么，什么是重要的，以使这个过程对我和参与开发新项目的其他人有益？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-01T16:53:58.330

对于初学者，请使用以下三个：

1.  SVN - 这将为您提供源代码控制并允许您跟踪更改。您可能希望在此基础上获得 GUI（Tortoise 是一种流行的）以简化学习曲线。

2.  RSYNC - 这将允许您使用单个命令简化本地和远程站点之间的同步。RSYNC 使用差异引擎进行同步，这意味着增量同步会在几秒钟内发生。在紧张的编程过程中，我有时会在一小时内同步 4-5 次，因为我可以很容易地快速推出小改动。

3.  MySQLDump - 这将允许您从生产站点导入/导出数据。我通常每周执行一次以在本地服务器上获取生产数据，这不仅为我提供了本地备份，还让我可以在本地测试环境中处理生产数据。

从长远来看，仅这三个就可以为您节省大量时间并允许您扩展。稍后您可以研究自动化构建工具、单元测试框架、xml 文档框架等来构建一些重要的产品。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-01T16:39:46.143

我使用这样的设置，所以我可以给你一些关于如何做到这一点的提示。我已经这样做了一段时间了，在这里和那里解决问题，感觉这是一个我可以诚实地说非常有效的设置。

小提示：我在 OSX 上工作，因此如果您是 linux/windows 用户，使用的特定应用程序可能与您有所不同。

我在我的 Mac 上运行一个生产“服务器”，使用 MAMP (www.mamp.info) 轻松地为我提供一个带有 PHP 和 MySQL 的 Apache 服务器。您可以使用类似的工具（例如 XAMPP）或手动安装所有内容，这完全取决于您。

然后我有我的实时服务器，托管我的网站和客户网站。对于每个新的网站项目（我们以 abc.com 为例），我都会创建一个名为 staging.abc.com 的子域，并在其上进行测试。在实际上线之前在完全相同的硬件和软件上进行测试总是一件好事。

我使用 Subversion（或简而言之，SVN）来满足我的版本控制需求，此外，每当我将新更新的版本发送到 SVN 服务器时，我可以轻松添加“挂钩”以自动更新我的在线生产服务器。SVN 还允许您在同一个项目中轻松地与多个人一起工作。有关 SVN 以及如何使用它的更多信息，我建议在这里找到一本很棒的（免费的）在线书籍：http: [//svnbook.red-bean.com/](http://svnbook.red-bean.com/)

简而言之：我在本地使用 MAMP 为我提供本地“工作”服务器。之后，我在 staging.abc.com 位置进行在线测试，看看是否一切正常，**并**可能允许其他人看到该项目（例如，如果您希望您的客户看到正在发生的事情），然后我实际上是通过将项目放在实际域上来发布项目的。

可以做更多的事情来优化您的工作流程，但这应该可以帮助您入门。

希望这可以帮助！

-戴夫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T16:32:54.443

如果可能的话，我更喜欢在开发人员本地机器上进行开发。如果涉及到其他开发人员，您可能希望设置您的版本控制，以便数据库架构、javascript、css 和 php 代码都可以很容易地在开发人员的个人框中检出和设置（假设他们有正确的 LAMP/ WAMP 设置）

我还看到人们在进行积极开发的服务器上维护一个测试网站。对于主动开发，我会避免这种情况，但将其用于最新签入代码（最新版本）的黑盒测试。

测试网站签出后，只需将代码从版本控制导出到实时网站所在的位置即可。使用 svn，您实际上可以使用 svn update 指定指示当前实时版本的修订版或标签来更新实时代码。

我会进一步建议将一些设置（例如 db access/username/pass）保留在不受版本控制的单独包含文件中。将其保留在其他地方，让开发人员在他们的 PC 上插入对本地数据库的访问权限。在您的服务器上，插入访问数据库所需的一切。这应该是非常微不足道的代码（定义一些变量），因此不对其进行版本控制应该没什么大不了的。如果您愿意，您可以对模板版本进行版本控制，但我不会将真实的数据库信息放入版本控制中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-12T20:50:25.153

如果您想使用 MAMP 或 WAMP 在本地开发，然后将其推送到 github，然后从 github 更新您的实时站点，这是一个很好的起点： [http ://www.mybringback.com/bringers/14509/git-local -and-shared-server-development-environment-with-ssh-setup/](http://www.mybringback.com/bringers/14509/git-local-and-shared-server-development-environment-with-ssh-setup/)

希望有帮助。

# flash - 用于 Flash IDE 的类似 ReSharper 的插件？

> ID：405095
> 
> 赞同：0
> 
> 时间：2009-01-01T16:15:01.123
> 
> 标签：flash, refactoring, actionscript-2

有时需要在 AS2 中针对 Flash Player 8 编写代码，因此我们不得不在 Flash IDE 中编写代码。

任何可用于 Actionscript 的重构工具/插件？... *在 Flash IDE 内或外，这没问题，只要它是为 Flash Player 8、AS2 构建的。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-01T16:21:08.537

[FlashDevelop](http://www.flashdevelop.org/community/viewtopic.php?f=11&t=4041)看起来不错，您可以将其设置为使用 Flash IDE 构建。*（它模拟 ALT+TAB 和 CTRL+ENTER！）*

至于它的 AS2 支持，您可以简单地`#include`将您在 FlashDevelop 中编写的 AS 文件放入您的主 FLA 中。*这样您的代码就会被编译和发布。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T21:26:15.760

开源[MTASC ActionScript 2 编译器](http://www.mtasc.org/)不需要 Flash 创作工具。Jeremy Rudd 提到了[FlashDevelop](http://www.flashdevelop.org/)，这是一个用于 SWF 开发的酷炫免费 IDE。当我还在 AS2 中编码时，我广泛使用它，我绝对推荐它。它支持使用 Flash 创作工具或 MTASC 进行编译，这很好。最近的版本也支持使用免费的 Flex SDK 进行 AS3 开发。不过，它仅适用于 Windows，因此可能并非对所有开发人员都有用。

不过，我认为 FlashDevelop 还没有任何形式的重构支持。由于大多数开发人员都专注于 AS3，因此大多数编辑器中可能不会为 AS2 实现高级 IDE 功能，例如重构。

# .net - 使用 JVM 的 Sun 品牌竞争对手 .NET

> ID：405099
> 
> 赞同：2
> 
> 时间：2009-01-01T16:18:32.757
> 
> 标签：.net, jvm, sun, jvm-languages

近年来出现了许多 JVM 语言，包括 Javascript、Python、Ruby 等（完整列表在这里：[JVM 语言列表](http://en.wikipedia.org/wiki/List_of_JVM_languages)）。我的问题是：为什么 Sun 没有像 Microsoft 的 .NET 那样为 JVM 提供一整套语言？使用新版本的 JVM，他们可以对动态语言或类型系统进行任何必要的调整，并为至少几种语言发布编译器。这将立即为一大堆语言提供对 Java 已经存在的大型类库的访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-02-16T20:07:25.573

Sun（现在的 Oracle）实际上并不需要自己做很多事情来创建更多的 JVM 语言——因为这个角色在很大程度上已经被开源社区和/或更广泛的 Java 生态系统所占据。

考虑：

*   现代、日益流行的开源 JVM 语言，如[Scala](http://www.scala-lang.org/)、[Groovy](http://groovy.codehaus.org/)和[Clojure](http://clojure.org)
*   [由Apache Software Foundation](http://www.apache.org/)等组织创建或赞助的库，可供所有 JVM 语言使用
*   [Eclipse Foundation](http://www.eclipse.org/)和其他机构的 IDE / 开发工具
*   由 Java 的主要企业支持者创建的各种工具和企业产品，包括 IBM、Red Hat、Google 等...
*   [通过OpenJDK 项目](http://openjdk.java.net/)将 Java 语言和平台本身开发为开源产品

因此，将 Java 视为一个拥有众多参与者的开放生态系统更为合适，而不是由单个公司控制的平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T17:39:26.850

财务说明了一切：

* * *

MSFT - 市值 173B，净收入 17B

* * *

JAVA——市值2B，净收入4亿

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T19:15:10.590

我看到两个问题：Sun 是否会更改 JVM 以支持动态语言（这会很简洁，尽管一些动态语言已经设法在当前 VM 上运行，可能会以性能为代价）；以及为什么 Sun 没有正式开发其他语言。

我希望他们会做第一个，但我不认为需要第二个。斯科特的回答非常好。此外，Java 已经出现了相当长的一段时间，而微软不得不启动他们的 CLR/.NET 平台，因此他们需要尽最大努力说服开发人员……而且他们负担得起！

所以我不确定 Sun 是否需要为 JVM 推出替代语言，独立开发人员有足够的精力在没有帮助的情况下这样做。

此外，JavaFX 脚本语言可以被视为这样（即 JVM 的官方语言），并且似乎 BeanShell 可能会在 JSR 中采用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T09:07:07.317

如果您正在寻找适用[于 JVM 的 Visual Basic，](http://blogs.oracle.com/tor/entry/semplice_keynote_demo)恐怕该项目已被取消 :-)

说真的，在专注于 Java 语言多年之后，Sun 现在直接支持 Jython 和 JRuby 背后的开发人员，并且正在更改 JVM 和他们的 IDE 以更好地支持这些语言。Java 6 现在还包括 Rhino JavaScript 运行时。

你说得对，这些不是 Sun 从头开始​​开发的语言，我认为这是一件好事。Java 生态系统在社区以及许多其他依赖 Java 的公司（如 IBM 和甲骨文）中有着悠久的创新历史。

我真的不知道 Sun 会通过创建全新的语言来解决哪个问题来支持。我什至不确定 JavaFX 是否最好通过拥有一种全新的语言来服务。我理解为什么 MS 必须在 .NET 上支持 Visual Basic，但幸运的是 Sun 不必这样做。

# visual-sourcesafe - 在 Visual SourceSafe 中模拟另一个用户

> ID：405104
> 
> 赞同：1
> 
> 时间：2009-01-01T16:24:23.477
> 
> 标签：visual-sourcesafe, impersonation

我们有一名员工离开了公司，他们在我们的 VSS 数据库中留下了一些已签出的文件。模拟该用户的最佳方式是什么，以便我可以发布这些文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T16:32:44.567

在 ssadmin 中，您可以重置他们的 VSS 密码（这样您就知道他们的 VSS 密码是什么，以便您可以使用他们的密码以他们的身份登录）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T16:30:08.787

您可以尝试以管理员身份登录并撤消他们的结帐。你会失去他们在本地所做的任何工作，但如果你只关心释放文件锁，那也没关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T16:32:46.160

管理员可以撤消结帐。

# php - 我不禁想到我做错了（Python，再次）

> ID：405106
> 
> 赞同：2
> 
> 时间：2009-01-01T16:27:44.453
> 
> 标签：php, python, project, project-planning

我最近提出的关于 Python 的所有问题都是针对这个项目的。我已经意识到我问这么多问题的原因可能不是因为我对 Python 太陌生（但我对 PHP 有一点了解），也可能不是因为 Python 有一些固有的缺陷。

因此，我现在将说明项目是什么以及我目前的想法是什么，你可以告诉我我做错了，我需要学习一些东西，或者 Python 根本不适合处理这种类型在这种情况下，项目和语言 XYZ 会更好，甚至有一些我可能想参与的开源项目。

**该项目**
我运行一个免费的回合制策略游戏（想想全面战争系列中的战役模式，但更加复杂和深度），并正在为它创建一个战斗模拟器（再次，把全面战争看作是它的想法工作）。我绝不会自欺欺人地认为我会单独制作像全面战争游戏一样好的东西，但我确实认为我可以自动化我目前手工完成的过程。

**它会做什么**
它必须考虑到单位、设备、训练、天气、地形等的大量变量。我知道这是一项艰巨的任务，我计划在空闲时间一次完成。我的预算为零，但这是我准备投入时间（并且已经投入）的爱好。

**我当前的绊脚石**
在 PHP 中，一切都可以访问其他一切，“错误”，尽管有些人可能认为这真的很方便。如果我有一组设备供单位使用，我可以从任何地方获取该数组。使用 Python 时，每次导入相关数据文件时，我都必须重新制作该数组，这对于一种根据我的经验经过深思熟虑的语言来说似乎是一个非常愚蠢的解决方案。我已经建立了一个记录函数调用和类创建的系统（因为我从一个非常基本的版本中知道，我曾经在 PHP 中做过这将有很大帮助）以及我一直保持的方式一个地方的数据是将我的每个类传递一个实例到我的日志记录列表中，这对我来说就像一个黑客，但这是我让它工作的唯一方法。

因此，我得出结论，我错过了一些东西，并且非常感谢任何愿意提供它的人的洞察力。谢谢你。

**代码示例**

这会创建一个编队列表，到目前为止只有一个值（除了名称之外），但我预计会添加更多内容，这就是为什么它们是类列表而不仅仅是标准列表的原因。这可以在 data.py 中找到

```
formations = []
formationsHash = []
def createFormations(logger):
    """This creates all the formations that will be used"""

    # Standard close quarter formation, maximum number of people per square metre
    formationsHash.append('Tight')
    formations.append(Formation(logger, 'Tight', tightness = 1))

    # Standard ranged combat formation, good people per square metre but not too cramped
    formationsHash.append('Loose')
    formations.append(Formation(logger, 'Loose', tightness = 0.5))

    # Standard skirmishing formation, very good for moving around terrain and avoiding missile fire
    formationsHash.append('Skirmish')
    formations.append(Formation(logger, 'Skirmish', tightness = 0.1))

    # Very unflexible but good for charges
    formationsHash.append('Arrowhead')
    formations.append(Formation(logger, 'Arrowhead', tightness = 1))

def getFormation(searchFor):
    """Returns the fomation object with this name"""
    indexValue = formationsHash.index(searchFor)
    return formations[indexValue] 
```

我没有何时需要访问它的代码示例，因为我还没有做到这一点，但我预计代码如下所示：

```
Python
tempFormation = data.getFormation(unit.formationType)
tempTerrain = data.getTerrain(unit.currentTerrain)
unit.attackDamage = unit.attackDamage * tempTerrain.tighnessBonus(tempFormation.tightness) 
```

该单元包含一个整数，该整数链接到主列表中相关地形、地层和诸如此类的索引/键。临时变量用于使第 3 行更短，但从长远来看，如果我忘记获取一个并且它使用的是之前不正确的值，从长远来看可能会导致问题（这就是日志记录派上用场的地方）。

```
PHP
$unit->attackDamage *= $terrain[$unit->currentTerrain]->tighnessBonus($unit->currentTerrain) 
```

单位类包含它所在的相关地形的索引（可能是一个字符串）以及它所在的地层。

也许这会在我对 Python 的理解中显示出一些巨大的缺陷（6 个月与 PHP 的 3 年）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-01T17:03:41.027

> 每次导入相关数据文件时，我都必须使用 Python 重新制作该数组

您在这里错过了 Python 语义的一个微妙点。当您第二次导入一个模块时，您不会重新执行该模块中的代码。该名称可在所有导入的模块列表中找到，并将相同的模块返回给您。因此，第二次导入模块时，您将获得对同一列表的引用（在 Python 中，不要说数组，而是说列表）。

您可能需要发布特定的代码示例以获得更多帮助，似乎其中混杂了一些 Python 误解，一旦这些误解被清除，您将有一个更简单的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T16:43:47.993

我已将您的问题缩小到：

> 每次导入相关数据文件时，我都必须使用 Python 重新制作该数组

那么你真的有两个选择，第一个也是最简单的是将结构保存在内存中。这样（就像 PHP 一样）理论上你可以从“任何地方”访问它，你会受到命名空间的轻微限制，但这是为了你自己好。它将翻译为“您想去的任何地方”。

第二种选择是有一些数据抽象（如数据库或数据文件）来存储和检索数据。这可能比第一个选择更好，因为您可能有太多数据无法一次放入内存。再次获取这些数据的方式将像 PHP 一样“随处”可用。

您可以以显式方式将这些东西直接传递给实例，或者您可以使用模块级全局变量并将它们导入到您需要它们的地方，正如您继续说的那样：

> 我将数据保存在一个地方的方法是将我的每个类传递一个实例到我的日志记录列表

我可以向你保证，这不是黑客行为。这是相当合理的，取决于用途，例如配置对象可以以相同的方式使用，因为您可能希望同时使用不同的配置来测试您的应用程序。日志记录可能更适合作为刚刚导入和调用的模块级全局，因为您可能只需要一种日志记录方式，但同样，这取决于您的要求。

我想总结一下，你真的走在正确的轨道上。尽量不要屈服于那种“hackish”的味道，尤其是在使用你不完全熟悉的语言时。一种语言的 hack 可能是另一种语言的黄金标准。当然，祝你的项目好运——听起来很有趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T19:12:45.447

请不要重新发明轮子。您`formationsHash`作为键值列表没有帮助，它复制了字典的功能。

```
def createFormations(logger):
    """This creates all the formations that will be used"""
    formations = {}
    formations['Tight']= Formation(logger, 'Tight', tightness = 1)
    formations['Loose']= Formation(logger, 'Loose', tightness = 0.5)
    formations['Skirmish']= Formation(logger, 'Skirmish', tightness = 0.1)
    formations['Arrowhead']= Formation(logger, 'Arrowhead', tightness = 1)
    return formations 
```

请注意，您实际上并不需要`getFormation`，因为它对您没有好处。你可以简单地使用这样的东西。

```
formations = createFormations( whatever )
f= formations[name] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T19:35:40.533

“data.py 创建了一个数组（嗯，列表），要从另一个文件中使用这个列表，我需要导入 data.py 并重新制作所述列表。”

我不明白你在说什么。严重地。

这是一个导入数据的主程序和另一个模块。

SomeMainProgram.py

```
import data
import someOtherModule

print data.formations['Arrowhead']
someOtherModule.function() 
```

一些其他模块.py

```
import data
def function():
    print data.formations['Tight'] 
```

数据.py

```
import theLoggerThing
class Formation( object ):
    pass # details omitted.
def createFormations( logger ):
    pass # details omitted
formations= createFormations( theLoggerThing.logger ) 
```

所以主程序是这样工作的。

1.  `import data`. 模块已`data`导入。

    一种。 `import theLoggerThing`. 不管这是什么。

    湾。 `class Formation( object ):`. 创建一个类`Formations`。

    C。 `def createFormations( logger ):`. 创建一个函数`createFormations`。

    d。 `formations =`. 创建一个对象，`formations`。

2.  `import someOtherModule`. `someOtherModule`是进口的。

    一种。 `import data`. 没发生什么事。 `data`已经在全球范围内可用。这实际上是对**Singleton**的引用。所有 Python 模块都是**Singletons**。

    湾。 `def function`. 创建一个函数`function`。

3.  `print data.formations['Arrowhead']`. Evaluate `data.formations`，它是一个字典对象。对字典执行 a`get('Arrowhead')`进行一些神奇的查找并返回在那里找到的对象（的实例`Formation`）。

4.  `someOtherModule.function()`.

    在此函数评估期间会发生什么。

    一种。`print data.formations['Tight']`. Evaluate `data.formations`，它是一个字典对象。对字典执行 a`get('Tight')`进行一些神奇的查找并返回在那里找到的对象（的实例`Formation`）。

# c++ - 在 C++ 中，对象是如何存储在内存中的？

> ID：405112
> 
> 赞同：10
> 
> 时间：2009-01-01T16:34:00.383
> 
> 标签：c++, memory, memory-management

在 C++ 中，对象是如何存储在内存中的？

对于常规课程，例如

```
class Object
    {
public:
    int i1;
    int i2;
    char i3;
    int i4;
private:
    }; 
```

使用 Object 的指针作为数组可以访问 i1 如下？

```
((Object*)&myObject)[0] === i1? 
```

关于 SO 的其他问题似乎表明将结构转换为指针将指向 POD 类型的第一个成员。如果有构造函数的类，这有什么不同？非 POD 类型还有什么不同？

编辑：

因此，在内存中，上面的类会像下面这样排列吗？

```
[i1 - 4bytes][i2 - 4bytes][i3 - 1byte][padding - 3bytes][i4 - 4bytes] 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-01T16:52:18.787

几乎。您投射到一个对象*，而忽略了一个地址。让我们重新问如下：

```
((int*)&myObject)[0] == i1 
```

你必须非常小心这样的假设。当您定义了结构时，这在您可能遇到的任何编译器中都应该是正确的。但是，正如其他人所说，对象的各种其他属性（您可能已从示例中省略）将使其成为非 POD，并且可能（可能以编译器相关的方式）使上述陈述不正确。

请注意，如果您询问 i3，我不会这么快告诉您它会起作用——在这种情况下，即使是普通的 POD，对齐或字节序也很容易把您搞砸。

无论如何，如果可能的话，你应该避免这种事情。即使它现在可以正常工作，如果您（或其他任何不了解您正在使用此技巧的人）曾经更改结构顺序或添加新字段，此技巧在您使用过的所有地方都会失败，这可能很难找到。

回答您的编辑：如果这是您的整个类定义，并且您正在使用具有默认选项的主流编译器之一，并且在 x86 处理器上运行，那么是的，您可能已经猜到了正确的内存布局。但是编译器、编译器选项和不同 CPU 架构的选择很容易使您的假设无效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T16:39:31.590

没有虚拟成员和没有继承的类就像结构一样在内存中布局。但是，当您开始获取继承级别时，事情可能会变得棘手，并且可能很难弄清楚内存中事物的顺序（尤其是多重继承）。

当您有虚拟成员时，它们在内存中有一个“vtable”，其中包含指向实际函数的指针，该函数是根据类的继承层次结构创建的。

底线是：如果可以避免，就不要以这种方式访问​​类（也不要 memset 或 memcpy ）。如果您必须这样做（为什么？），那么请注意您确切地知道您的类对象将如何在内存中，并小心避免继承。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T16:41:42.897

不同之处在于此技巧仅对 POD 类型有效。这就是它的全部。该标准指定此强制转换对 POD 类型有效，但不保证非 POD 类型会发生什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T21:01:39.973

它实际上取决于编译器，或者更确切地说，由编译器决定内存布局。

例如，可以对公共、私有和受保护的成员变量进行混合布局，以使每种访问类型都是连续的。或者，派生类的成员变量可以与超类中未使用的空间交错。

虚拟继承会使情况变得更糟，虚拟继承的基类可以布置在为该特定实例分配的内存中的**任何位置。**

POD 是不同的，因为它需要与 C 兼容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T16:42:07.840

通常重要的不是类是否有构造函数：重要的是类是否有虚方法。有关详细信息，请在 Google 中查找“vtable”和“vptr”。

# c - 哪一个使用链表或静态数组？

> ID：405113
> 
> 赞同：1
> 
> 时间：2009-01-01T16:34:02.723
> 
> 标签：c, linked-list

我在 C 中有一个类似于数据库表记录的结构。现在当我使用 select 查询表时，我不知道我会得到多少条记录。我想将选择查询返回的所有记录存储在我的结构数据类型的数组中。

哪种方法最好？

### 方法一：查找数组大小并分配

1.  首先通过从表中执行 select count(*) 来获取记录数
2.  分配一个静态数组
3.  运行 select * from table 然后将每个记录存储在我的结构中。

### 方法二：使用单链表

```
while ( records returned )
{
    create new node 
    store the record in node 
} 
```

哪种实现最好？

我的要求是，当我拥有所有记录时，我可能会复制它们或其他东西。但我不需要随机访问，也不会对特定记录进行任何搜索。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T16:53:06.727

我忘记了选项#4。分配一个固定大小的数组。当该数组已满时，分配另一个。您可以通过将数组链接到链表中来跟踪数组，或者使用更高级别的数组来保存指向数据数组的指针。当您需要随机访问时，这种两级方案非常有用，您只需要将索引分成两部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T16:41:40.743

'select count(*)' 的一个问题是值可能会在调用之间发生变化，因此您的“真实”选择将有许多与您期望的计数不同的项目。

我认为最好的解决方案是你的“2”。我会亲自分配一个数组（根据需要重新分配），而不是链表。这在支持不断增长的数组的语言中更容易（例如`std::vector<myrecord>`在 C++ 和`List<myrecord>`C# 中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T16:49:33.787

您忘记了选项 3，它有点复杂，但它可能最适合您的特定情况。这是它通常在 C++ std::vector 中完成的方式。

分配一个任意大小的数组。当该数组被填充时，分配一个新的更大的数组，其大小是填充数组的 1.5 倍到 2 倍，然后将填充数组复制到这个数组。释放原始数组并用新数组替换它。起泡，冲洗，重复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T19:57:20.363

```
while(record = get_record()) {
  records++;
  records_array = (record_struct *) realloc(records_array, (sizeof record_struct)*records);
  *records_array[records - 1] = record;
} 
```

这只是一个例子——请不要在生产环境中使用 realloc()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T05:06:24.140

链表是一个不错的简单选项。我会同意的。如果您更喜欢不断增长的数组，您可以在 Dave Hanson 的[C Interfaces and Implementations](http://www.cs.princeton.edu/software/cii/)中找到一个实现，作为奖励，它还提供了链表。

在我看来，这就像一个设计决策，可能会随着您的应用程序的发展而改变，因此您绝对应该**将表示隐藏在合适的 API 后面**。如果你还不知道怎么做，Hanson 的代码会给你一些很好的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-01T17:14:54.203

应该提出很多可能的批评。

1.  您根本不是在谈论静态数组 - 静态数组将具有在编译时固定的预定大小，并且是源文件本地或函数本地的。您正在谈论动态分配的数组。

2.  您没有给出任何记录大小或记录计数的指示，也没有给出底层数据库的动态程度（也就是说，任何其他进程在您的运行时是否可以更改任何数据）。尺寸信息并不是非常关键，但另一个因素是。如果您正在做某种报告，那么将数据提取到内存中就可以了；您不会修改数据库，并且数据是准确的快照。但是，如果在您修改记录时其他人可能正在修改记录，您的大纲解决方案就是如何丢失其他人更新的主要示例。那是一件*坏事*！

3.  为什么一次需要内存中的所有数据？忽略大小限制，与按正确顺序处理每个相关记录一次相比，这到底有什么好处？您会看到，DBMS 为能够选择相关记录（WHERE 子句）和相关数据（SELECT 列表）并允许您指定序列（ORDER BY 子句）付出了很多努力，它们拥有最好的排序系统负担得起（比你或我可能生产的更好）。

4.  如果您以块的形式分配数组，请注意二次行为。每次重新分配时，很有可能必须将旧内存复制到新位置。这将使您的记忆碎片化（旧位置将可供重用，但根据定义将太小而无法重用）。Mark Ransom 指出了一个合理的替代方案——总体上不是世界上最简单的方案（但它避免了我提到的二次行为）。当然，您可以（并且会）通过一组合适的函数将其抽象出来。

5.  批量获取（Mark Ransom 也提到过）也很有用。您可能希望预先分配批量提取所提取的数组，这样您就不必进行额外的复制。不过，这只是线性行为，因此不太严重。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-01T17:37:05.343

创建一个数据结构来表示您的数组或列表。假设您使用 OO 语言，并为您需要的一切创建访问器和构造器。在该数据结构中，保留一个数组，并且正如其他人所说，当数组被填满时，分配一个 2 倍大的新数组并复制到其中。仅通过您定义的访问该结构的例程来访问该结构。

这就是 Java 和其他语言执行此操作的方式。在内部，这甚至是 Perl 在 C 中实现的方式。

我想说你最好的选择是寻找一个已经这样做的库......也许你可以借用 Perl 的这种数据结构的 C 实现。我敢肯定，它比您或我可以从头开始的任何东西都经过了更好的测试。:)

# macos - 在可移动媒体上在 OS X 和 Windows 之间传输 5+GB 文件的最佳文件系统

> ID：405114
> 
> 赞同：4
> 
> 时间：2009-01-01T16:34:11.413
> 
> 标签：macos, filesystems, large-files, ntfs, fat32

我需要在 Windows XP 计算机和运行 Leopard 的 Mac 之间传输 DVD 映像文件。

这些机器没有通过快速网络连接，我有一些我想使用的 USB 驱动器，例如 8GB 闪存、60GB 和 250GB USB 硬盘驱动器。

有时文件会超过 4GB（FAT32 上单个文件的最大大小），而且我对 Leopard 上的 NTFS 不满意。我不知道任何支持 Mac 文件系统（如 HFS）的 XP/Vista 驱动程序。

有人对这里最适合哪种文件系统有任何建议吗？

谢谢汤姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-01T17:15:31.377

你对 Leopard 上的 NTFS 做了什么尝试？

这很简单：

1.  安装[MacFUSE](http://code.google.com/p/macfuse/)和[NTFS-3G](http://macntfs-3g.blogspot.com/)驱动程序。
2.  ？？？
3.  利润。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-01T18:13:27.860

您可以`split`在 Mac 上使用将文件分成 2GB 的片段，然后在 Windows 上使用`copy`.

```
split -b 2048m file

copy xxa + xxb file 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T16:44:31.580

您可以尝试使用 linux 文件系统，例如在 mac 上使用[e2fs](http://bmannconsulting.com/macosx/how-to/ext2-for-mac)（不过我只尝试过阅读这些文件系统）。有windows的驱动程序。

或者，您可以使用`split`Mac 上的实用程序将文件切割成更小的块，然后在 Windows 上重新组合它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T19:39:42.843

格式化为[exFAT](http://en.wikipedia.org/wiki/ExFAT)对我有用，它应该对旧 Windows 有一些限制，但不是我的情况。

# c# - 为什么在 c# 中 if 和委托的范围是这种方式

> ID：405116
> 
> 赞同：7
> 
> 时间：2009-01-01T16:37:48.957
> 
> 标签：c#, language-design

受这个[问题](https://stackoverflow.com/questions/404899/scope-of-variables-in-a-delegate)的启发，我开始想知道为什么以下示例在 c# 中都是非法的：

```
VoidFunction t = delegate { int i = 0; };

int i = 1; 
```

和

```
{
   int i = 0;
}

int i = 1; 
```

我只是想知道是否有人知道这种语言设计的确切原因？是为了阻止不良的编程实践，如果是这样，为什么不发出警告？出于性能原因（编译和运行时）还是原因是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-01T17:29:04.923

C# 语言规范的第 3 节介绍了此行为。这是规范的报价

> 类似地，任何以 lambda 表达式形式作为匿名函数体出现的表达式都会创建一个包含匿名函数参数的声明空间。局部变量声明空间的两个成员具有相同名称是错误的。块的局部变量声明空间和嵌套的局部变量声明空间包含同名元素是错误的。因此，在嵌套的声明空间中，不可能声明与封闭声明空间中的局部变量或常量同名的局部变量或常量。

我认为更简单的阅读方式是，出于变量声明（以及许多其他与块相关的函数）的目的，lambda/匿名委托块的处理方式与普通块没有区别。

至于为什么以这种方式设计语言，规范没有明确说明。我的意见虽然是简单的。如果代码被视为只是另一个块，那么它会使代码分析例程更容易。您可以保留所有现有例程来分析块的语义错误和名称解析。当您考虑可变提升时，这一点尤其重要。Lambda 最终将成为一个不同的函数，但它们仍然可以在声明点访问所有范围内的变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T17:31:12.623

我认为这样做是为了使内部范围可以访问在外部范围中声明的变量。如果允许您覆盖外部范围中存在的变量，则可能会混淆预期的行为。因此，他们可能已决定通过防止问题发生来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T18:07:50.600

我认为这是防止开发人员在脚下开枪的方式。

# html - CSS 问题：链接显示错误

> ID：405120
> 
> 赞同：1
> 
> 时间：2009-01-01T16:39:07.770
> 
> 标签：html, css

```
a {
    color: #000;
}

a:hover {
    text-decoration: none;
    color: #fff;
} 
```

那是我使用的代码。但是，我页面中的链接都没有听这个。他们遵守这一点：

```
#menu li, a {
    text-align: center;
    display: block;
    float: left;
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
    font-size:1.2em;
    color: #575757;
    text-decoration: none;
    list-style: none;
} 
```

因此，很多链接都是倾斜的，因为它们都向左浮动。
链接本身的代码没有以任何方式包装。至少不能解释我的错误。

```
<div id="footer">
  <p><center>Copyright 2008 - <a href="index.php">G.S.B.V. Pugilice</a></center></p>
</div> 
```

那段代码给了我两行而不是一行，链接在第二行向左浮动。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T16:44:21.220

我认为您可能误解了选择器的工作原理。

```
#menu li, a { ... } 
```

意味着将样式应用于具有 id #menu 的元素的任何 li 后代**以及**在任何位置找到的任何 a。

你真的打算：-

```
#menu li, #menu a {...} 
```

?

# ios - 手动设置 UIButton 状态

> ID：405134
> 
> 赞同：19
> 
> 时间：2009-01-01T16:45:13.873
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uibutton

我`UIButton`用 +`buttonWithType:`

我需要弄清楚的是如何手动更改按钮状态。有时我需要将其设置为“禁用”。

我通读了`UIButton`文档，但似乎找不到任何有关手动设置按钮状态的信息。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-01T17:11:11.933

你试过了`button.enabled = NO;`吗？

**斯威夫特 5.0**

```
button.isEnabled = false 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-11-02T22:35:17.017

还有一些国家：

```
 button.highlighted = NO;
   button.selected = NO; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-26T10:02:33.663

目标 C：

```
button.selected = Yes;
button.highlighted = NO;
button.enabled = Yes; 
```

斯威夫特 4：

```
button.isSelected = true 
button.isEnabled = true 
```

你也可以使用:(swift 4)

```
 if (button.state == .selected) {
   //do something
 } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-23T07:50:59.940

您可以手动设置 UIButton 的状态。

```
UIButton *btnCheck=[UIButton buttonWithType:UIButtonTypeCustom];

if(btncheck isselected])
{
    btncheck.selected=FALSE;
}
else
{
    btncheck.selected=TRUE;
} 
```

您可以根据您的要求对 UIButton 进行操作，例如在选择 UIButton 和未选择 UIButton 时执行一些操作。

希望对你有帮助....

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-13T21:38:02.447

对于 Swift 3，您可以使用

button.isSelected = true

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-23T16:03:06.717

对于到达这里希望更改按钮“状态”（而不是“启用”）的任何人。Stephen 是正确的“这个属性是只读的——没有对应的 setter 方法。”

您真正要设置的是按钮单元格的状态。

```
[[myNSButtonOutlet cell] setState: NSOnState];  //Options NSOnState, NSOffState, NSMixedState 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-17T04:42:47.527

为了适应在选择按钮时设置不同按钮外观的需要，请设置`isSelected = true`.

`UIButton`以下是使用问答游戏环境设置状态并根据该状态更改外观的示例：

```
if sender.titleLabel?.text == correctAnswer {
    sender.isSelected = true
    // Set title color and image based on 'selected' state.
    sender.setTitleColor(.systemBlue, for: .selected)
    sender.setImage(Utilities.sharedInstance.returnAnswerButtonImage(for: .correctlyAnswered).withRenderingMode(.alwaysOriginal), for: .selected)
    sender.backgroundColor = .white
    sender.tintColor = .systemBlue
    // moveToNextQuestion()
} else {
    sender.isSelected = true
    sender.setTitleColor(.systemBlue, for: .selected)
    sender.setImage(Utilities.sharedInstance.returnAnswerButtonImage(for: .incorrectlyAnswered).withRenderingMode(.alwaysOriginal), for: .selected)
    sender.backgroundColor = .red
    sender.tintColor = .systemBlue
} 
```

# c# - 如何在不使用代码的情况下格式化日期 - 格式化字符串问题

> ID：405140
> 
> 赞同：2
> 
> 时间：2009-01-01T16:51:28.930
> 
> 标签：c#, datetime, formatting

如何使用格式字符串实现以下目标：Do 01.01.2009 ？它必须适用于所有语言（例如德国）。所以应该只有短暂的工作日，然后是短暂的日期。

我试过'ddd d'（没有'）。但是，这会导致“Do 01”。是否有可能我可以在“d”之前放置一个字符，以便它自己踩踏或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T17:01:07.130

```
DateTime.Now.ToString("ddd dd/MM/yyyy") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T17:12:48.840

如果您的目标受众使用不同的口语，您应该使用[ISO 8601标准。](http://en.wikipedia.org/wiki/ISO_8601)

```
DateTime.Now.ToString("ddd yyyy-MM-dd"); 
```

或者，您可以使用较短的日期定位当前文化：

```
DateTime.Now.ToString("d", Thread.CurrentThread.CurrentCulture); 
```

或长日期：

```
DateTime.Now.ToString("D", Thread.CurrentThread.CurrentCulture); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T17:13:52.783

要获取特定于区域设置的短日期以及区域设置日期名称，那么您将不得不使用两个调用，因此：

```
 myDate.ToString("ddd ") + myDate.ToString("d"); 
```

您是否考虑过使用长日期格式？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T17:15:37.977

如果你想本地化（我假设是这样，因为你说的是​​“所有语言”），你可以使用 CultureInfo 来设置你想要显示的不同文化。MSDN 库包含有关[Standard Date and Time Format Strings](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)和[CultureInfo Class](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)的信息。

示例 MSDN 提供：

```
// Display using pt-BR culture's short date format
DateTime thisDate = new DateTime(2008, 3, 15);
CultureInfo culture = new CultureInfo("pt-BR");      
Console.WriteLine(thisDate.ToString("d", culture));  // Displays 15/3/2008 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T17:21:17.373

仅供参考，在 Java 中是这样的：

```
DateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");
Date date = new Date();
String formattedDate = dateFormat.format(date); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-01T17:31:32.717

如果要确保使用相同的字符作为分隔符，则必须使用反斜杠来转义字符，否则它将默认为您所在的语言环境。如果您想要在问题中指定的格式，我建议使用此字符串

```
DateTime.Now.ToString("ddd dd.MM.yyyy"); 
```

要改用正斜杠，您应该转义它们，以便它们始终输出为斜杠。

```
DateTime.Now.ToString("ddd dd\\/MM\\/yyyy"); 
```

# cocoa-touch - 是否可以防止 NSURLRequest 在请求后缓存数据或删除缓存的数据？

> ID：405151
> 
> 赞同：90
> 
> 时间：2009-01-01T16:58:30.383
> 
> 标签：cocoa-touch, caching

在 iPhone 上，我使用 NSURLRequest 对一大块数据执行 HTTP 请求。对象分配高峰，我相应地分配数据。当我完成数据时，我会相应地释放它 - 但是仪器没有显示任何已释放的数据！

我的理论是默认情况下 HTTP 请求被缓存，但是 - 我不希望我的 iPhone 应用程序缓存这些数据。

有没有办法在请求后清除此缓存或首先防止任何数据被缓存？

我尝试使用所有记录在案的缓存策略，如下所示：

```
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:url]];
theRequest.cachePolicy = NSURLRequestReloadIgnoringLocalCacheData; 
```

但似乎没有什么可以释放内存！

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-01-02T02:30:58.120

通常像这样创建请求更容易

```
NSURLRequest *request = [NSURLRequest requestWithURL:url
      cachePolicy:NSURLRequestReloadIgnoringCacheData
      timeoutInterval:60.0]; 
```

然后创建连接

```
NSURLConnection *conn = [NSURLConnection connectionWithRequest:request
       delegate:self]; 
```

并在委托上实现 connection:willCacheResponse: 方法。只需返回 nil 就可以了。

```
- (NSCachedURLResponse *)connection:(NSURLConnection *)connection willCacheResponse:(NSCachedURLResponse *)cachedResponse {
  return nil;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-10-08T08:30:05.330

当我从 twitter 请求信息时，我的应用程序中遇到了同样的问题。在我的情况下，我不需要保留这些凭据，所以我使用下面的代码简单地删除它们：

```
- (void) eraseCredentials{
NSURLCredentialStorage *credentialsStorage = [NSURLCredentialStorage sharedCredentialStorage];
NSDictionary *allCredentials = [credentialsStorage allCredentials];

//iterate through all credentials to find the twitter host
for (NSURLProtectionSpace *protectionSpace in allCredentials)
    if ([[protectionSpace host] isEqualToString:@"twitter.com"]){
        //to get the twitter's credentials
        NSDictionary *credentials = [credentialsStorage credentialsForProtectionSpace:protectionSpace];
        //iterate through twitter's credentials, and erase them all
        for (NSString *credentialKey in credentials)
            [credentialsStorage removeCredential:[credentials objectForKey:credentialKey] forProtectionSpace:protectionSpace];
    }
} 
```

我希望它适用于某人:)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-01T23:55:19.853

如果你使用 NSURLConnection 看看委托：

```
- (NSCachedURLResponse *)connection:(NSURLConnection *)connection willCacheResponse:(NSCachedURLResponse *)cachedResponse 
```

**返回值**

要存储在缓存中的实际缓存响应。委托可以返回未修改的缓存响应，返回修改后的缓存响应，或者如果不应该为连接存储缓存响应，则返回 nil。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-10-09T11:17:39.280

如果您正在使用`NSURLSession`，另一种防止将请求和参数写入`Cache.db`iOS 的解决方案是在应用程序`Caches`目录中创建，是将会话`NSURLCache`配置设置为**0 大小的内存和 0 大小的磁盘缓存，**例如

```
let configuration = URLSessionConfiguration.default    
configuration.urlCache = URLCache(memoryCapacity: 0, diskCapacity: 0, diskPath: nil)
let session = URLSession(configuration: configuration) 
```

或者如上所述设置在全局缓存级别

```
URLCache.shared = URLCache(memoryCapacity: 0, diskCapacity: 0, diskPath: nil) 
```

大概是磁盘大小为 0 会阻止 iOS 写入磁盘，但是如果您有策略，`reloadIgnoringLocalCacheData`那么您可能对内存缓存也不感兴趣。

**注意**这将阻止任何`Caches/Cache.db`（请求和响应）或`Caches/fsCachedData/`文件夹（响应数据）被创建。出于安全目的，我们决定在应用程序中采用这种方法，因为我们不希望我们的请求永远存储在磁盘缓存中。

如果有人知道有一种方法可以仅停止请求缓存但保留来自 iOS URL 加载机制的响应数据缓存，我很想知道。（据我所知，没有关于此的 API 或官方文档）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-06-30T13:43:04.330

如果不是特定于单个请求（您希望禁用整个应用程序的缓存），则最好选择以下一个。将此代码添加到应用程序委托中或根据您的需要添加到任何地方

```
 int cacheSizeMemory = 0; // 0MB
        int cacheSizeDisk = 0; // 0MB
        NSURLCache *sharedCache = [[NSURLCache alloc] initWithMemoryCapacity:cacheSizeMemory diskCapacity:cacheSizeDisk diskPath:@"nsurlcache"];
        [NSURLCache setSharedURLCache:sharedCache]; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-08-14T21:09:09.810

```
NSMutableURLRequest* request = [[NSMutableURLRequest alloc] url];
[request setValue:@"no-store" forHTTPHeaderField:@"Cache-Control"];
[request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData]; 
```

假设服务器正确实现，将`Cache-Control:no-store`请求头放入请求中将生成具有相同头的服务器响应，从而导致`NSURLCache`无法将响应数据存储在磁盘上。

因此，不需要禁用`NSURLCache`磁盘缓存的霰弹枪方法。

PS：添加标头应该适用于所有 HTTP 框架，例如`AFNetworking`

# nlp - 检测单词中的音节

> ID：405161
> 
> 赞同：150
> 
> 时间：2009-01-01T17:08:41.313
> 
> 标签：nlp, spell-checking, hyphenation

我需要找到一种相当有效的方法来检测单词中的音节。例如，

隐形 -> in-vi-sib-le

有一些可以使用的音节规则：

V CV VC CVC CCV CCCV CVCC

*其中 V 是元音，C 是辅音。例如，

发音（5 Pro-nun-ci-a-tion；CV-CVC-CV-V-CVC）

我尝试了几种方法，其中使用正则表达式（仅在您想计算音节时才有帮助）或硬编码规则定义（证明非常低效的蛮力方法），最后使用有限状态自动机（确实没有任何有用的结果）。

我的应用程序的目的是创建给定语言的所有音节的字典。该词典稍后将用于拼写检查应用程序（使用贝叶斯分类器）和文本到语音合成。

除了我以前的方法之外，如果有人能给我关于解决此问题的替代方法的提示，我将不胜感激。

我在 Java 中工作，但 C/C++、C#、Python、Perl 中的任何技巧都对我有用。

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-01-01T17:17:58.890

阅读有关此问题的 TeX 方法以进行断字。尤其是Frank Liang 的[论文](http://www.tug.org/docs/liang/) *Word Hy-phen-a-tion by Computer*。他的算法非常准确，然后包含一个小的异常字典，用于算法不起作用的情况。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-01-02T07:19:44.887

我偶然发现这个页面寻找相同的东西，并在这里找到了 Liang 论文的一些实现： [https](https://github.com/mnater/hyphenator) ://github.com/mnater/hyphenator或继任者：[https ://github.com/mnater/Hyphenopoly](https://github.com/mnater/Hyphenopoly)

那是除非你是喜欢阅读 60 页论文而不是为非唯一问题改编免费可用代码的类型。:)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2010-11-05T02:52:20.400

这是使用[NLTK](http://www.nltk.org/)的解决方案：

```
from nltk.corpus import cmudict
d = cmudict.dict()
def nsyl(word):
  return [len(list(y for y in x if y[-1].isdigit())) for x in d[word.lower()]] 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-04-11T00:34:28.123

我正在尝试通过一个程序来解决这个问题，该程序将计算一段文本的 flesch-kincaid 和 flesch 阅读分数。我的算法使用我在这个网站上找到的内容：http: [//www.howmanysyllables.com/howtocountsyllables.html](http://www.howmanysyllables.com/howtocountsyllables.html)并且它相当接近。它仍然无法处理诸如隐形和连字符之类的复杂单词，但我发现它对我的目的来说是可行的。

它具有易于实施的优点。我发现“es”可以是音节也可以不是。这是一场赌博，但我决定删除算法中的 es。

```
private int CountSyllables(string word)
    {
        char[] vowels = { 'a', 'e', 'i', 'o', 'u', 'y' };
        string currentWord = word;
        int numVowels = 0;
        bool lastWasVowel = false;
        foreach (char wc in currentWord)
        {
            bool foundVowel = false;
            foreach (char v in vowels)
            {
                //don't count diphthongs
                if (v == wc && lastWasVowel)
                {
                    foundVowel = true;
                    lastWasVowel = true;
                    break;
                }
                else if (v == wc && !lastWasVowel)
                {
                    numVowels++;
                    foundVowel = true;
                    lastWasVowel = true;
                    break;
                }
            }

            //if full cycle and no vowel found, set lastWasVowel to false;
            if (!foundVowel)
                lastWasVowel = false;
        }
        //remove es, it's _usually? silent
        if (currentWord.Length > 2 && 
            currentWord.Substring(currentWord.Length - 2) == "es")
            numVowels--;
        // remove silent e
        else if (currentWord.Length > 1 &&
            currentWord.Substring(currentWord.Length - 1) == "e")
            numVowels--;

        return numVowels;
    } 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-02-07T15:40:54.953

这是一个特别困难的问题，LaTeX 断字算法并没有完全解决。[在Evaluating Automatic Syllabification Algorithms for English](http://eprints.ecs.soton.ac.uk/14285/1/MarchandAdsettDamper_ISCA07.pdf)（Marchand、Adsett 和 Damper 2007）一文中可以找到对一些可用方法和所涉及挑战的一个很好的总结。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-02-20T02:44:51.567

为什么要计算呢？每个在线词典都有此信息。[http://dictionary.reference.com/browse/invisible](http://dictionary.reference.com/browse/invisible) in·vis·i·ble

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-10-14T06:18:04.690

碰撞@Tihamer 和@joe-basirico。非常有用的功能，并不**完美**，但对大多数中小型项目都很好。乔，我用 Python 重写了你的代码实现：

```
def countSyllables(word):
    vowels = "aeiouy"
    numVowels = 0
    lastWasVowel = False
    for wc in word:
        foundVowel = False
        for v in vowels:
            if v == wc:
                if not lastWasVowel: numVowels+=1   #don't count diphthongs
                foundVowel = lastWasVowel = True
                        break
        if not foundVowel:  #If full cycle and no vowel found, set lastWasVowel to false
            lastWasVowel = False
    if len(word) > 2 and word[-2:] == "es": #Remove es - it's "usually" silent (?)
        numVowels-=1
    elif len(word) > 1 and word[-1:] == "e":    #remove silent e
        numVowels-=1
    return numVowels 
```

希望有人觉得这很有用！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-09-20T15:22:58.480

感谢 Joe Basirico，分享了您在 C# 中快速而肮脏的实现。我使用过大型库，它们可以工作，但它们通常有点慢，对于快速项目，你的方法效果很好。

这是您的 Java 代码以及测试用例：

```
public static int countSyllables(String word)
{
    char[] vowels = { 'a', 'e', 'i', 'o', 'u', 'y' };
    char[] currentWord = word.toCharArray();
    int numVowels = 0;
    boolean lastWasVowel = false;
    for (char wc : currentWord) {
        boolean foundVowel = false;
        for (char v : vowels)
        {
            //don't count diphthongs
            if ((v == wc) && lastWasVowel)
            {
                foundVowel = true;
                lastWasVowel = true;
                break;
            }
            else if (v == wc && !lastWasVowel)
            {
                numVowels++;
                foundVowel = true;
                lastWasVowel = true;
                break;
            }
        }
        // If full cycle and no vowel found, set lastWasVowel to false;
        if (!foundVowel)
            lastWasVowel = false;
    }
    // Remove es, it's _usually? silent
    if (word.length() > 2 && 
            word.substring(word.length() - 2) == "es")
        numVowels--;
    // remove silent e
    else if (word.length() > 1 &&
            word.substring(word.length() - 1) == "e")
        numVowels--;
    return numVowels;
}

public static void main(String[] args) {
    String txt = "what";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
    txt = "super";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
    txt = "Maryland";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
    txt = "American";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
    txt = "disenfranchized";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
    txt = "Sophia";
    System.out.println("txt="+txt+" countSyllables="+countSyllables(txt));
} 
```

结果符合预期（它对 Flesch-Kincaid 来说足够好）：

```
txt=what countSyllables=1
txt=super countSyllables=2
txt=Maryland countSyllables=3
txt=American countSyllables=3
txt=disenfranchized countSyllables=5
txt=Sophia countSyllables=2 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-07-02T19:56:12.713

不久前我遇到了同样的问题。

我最终使用[CMU 发音词典](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)快速准确地查找大多数单词。对于字典中没有的单词，我使用了一种机器学习模型，该模型在预测音节计数方面的准确率约为 98%。

我在这里将整个事情包装在一个易于使用的 python 模块中：[https ://github.com/repp/big-phoney](https://github.com/repp/big-phoney)

安装： `pip install big-phoney`

计数音节：

```
from big_phoney import BigPhoney
phoney = BigPhoney()
phoney.count_syllables('triceratops')  # --> 4 
```

如果您不使用 Python，并且想尝试基于 ML 模型的方法，我[对音节计数模型如何在 Kaggle 上工作进行](https://www.kaggle.com/reppic/predicting-english-pronunciations)了非常详细的文章。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-01T17:34:03.260

Perl 有[Lingua::Phonology::Syllable](http://search.cpan.org/~jaspax/Lingua-Phonology-0.3503/Phonology/Syllable.pm)模块。您可以尝试一下，或者尝试研究它的算法。我在那里也看到了其他一些较旧的模块。

我不明白为什么正则表达式只给你一个音节计数。您应该能够使用捕获括号自己获取音节。假设您可以构造一个有效的正则表达式，那就是。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-02-17T14:40:28.803

今天我发现[了这个](https://github.com/joeha480/texhyphj)带有英语或德语模式的 Frank Liang 的连字算法的 Java 实现，它工作得很好，可以在 Maven Central 上找到。

Cave：删除模式文件的最后几行很重要`.tex`，否则这些文件无法在 Maven Central 上以当前版本加载。

要加载和使用`hyphenator`，您可以使用以下 Java 代码片段。`texTable`是`.tex`包含所需模式的文件的名称。这些文件可在项目 github 站点上找到。

```
 private Hyphenator createHyphenator(String texTable) {
        Hyphenator hyphenator = new Hyphenator();
        hyphenator.setErrorHandler(new ErrorHandler() {
            public void debug(String guard, String s) {
                logger.debug("{},{}", guard, s);
            }

            public void info(String s) {
                logger.info(s);
            }

            public void warning(String s) {
                logger.warn("WARNING: " + s);
            }

            public void error(String s) {
                logger.error("ERROR: " + s);
            }

            public void exception(String s, Exception e) {
                logger.error("EXCEPTION: " + s, e);
            }

            public boolean isDebugged(String guard) {
                return false;
            }
        });

        BufferedReader table = null;

        try {
            table = new BufferedReader(new InputStreamReader(Thread.currentThread().getContextClassLoader()
                    .getResourceAsStream((texTable)), Charset.forName("UTF-8")));
            hyphenator.loadTable(table);
        } catch (Utf8TexParser.TexParserException e) {
            logger.error("error loading hyphenation table: {}", e.getLocalizedMessage(), e);
            throw new RuntimeException("Failed to load hyphenation table", e);
        } finally {
            if (table != null) {
                try {
                    table.close();
                } catch (IOException e) {
                    logger.error("Closing hyphenation table failed", e);
                }
            }
        }

        return hyphenator;
    } 
```

之后`Hyphenator`就可以使用了。要检测音节，基本思想是在提供的连字符处拆分术语。

```
 String hyphenedTerm = hyphenator.hyphenate(term);

    String hyphens[] = hyphenedTerm.split("\u00AD");

    int syllables = hyphens.length; 
```

您需要拆分`"\u00AD`“，因为 API 不会返回正常的`"-"`.

这种方法优于 Joe Basirico 的答案，因为它支持许多不同的语言并且更准确地检测德语连字符。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-09T21:46:06.033

谢谢@joe-basirico 和@tihamer。我已将@tihamer 的代码移植到 Lua 5.1、5.2 和 luajit 2（*很可能也会在其他版本的 lua 上运行*）：

`countsyllables.lua`

```
function CountSyllables(word)
  local vowels = { 'a','e','i','o','u','y' }
  local numVowels = 0
  local lastWasVowel = false

  for i = 1, #word do
    local wc = string.sub(word,i,i)
    local foundVowel = false;
    for _,v in pairs(vowels) do
      if (v == string.lower(wc) and lastWasVowel) then
        foundVowel = true
        lastWasVowel = true
      elseif (v == string.lower(wc) and not lastWasVowel) then
        numVowels = numVowels + 1
        foundVowel = true
        lastWasVowel = true
      end
    end

    if not foundVowel then
      lastWasVowel = false
    end
  end

  if string.len(word) > 2 and
    string.sub(word,string.len(word) - 1) == "es" then
    numVowels = numVowels - 1
  elseif string.len(word) > 1 and
    string.sub(word,string.len(word)) == "e" then
    numVowels = numVowels - 1
  end

  return numVowels
end 
```

还有一些有趣的测试来确认它是否有效（*尽可能多*）：

`countsyllables.tests.lua`

```
require "countsyllables"

tests = {
  { word = "what", syll = 1 },
  { word = "super", syll = 2 },
  { word = "Maryland", syll = 3},
  { word = "American", syll = 4},
  { word = "disenfranchized", syll = 5},
  { word = "Sophia", syll = 2},
  { word = "End", syll = 1},
  { word = "I", syll = 1},
  { word = "release", syll = 2},
  { word = "same", syll = 1},
}

for _,test in pairs(tests) do
  local resultSyll = CountSyllables(test.word)
  assert(resultSyll == test.syll,
    "Word: "..test.word.."\n"..
    "Expected: "..test.syll.."\n"..
    "Result: "..resultSyll)
end

print("Tests passed.") 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-09-25T15:44:12.213

我找不到合适的方法来计算音节，所以我自己设计了一个方法。

你可以在这里查看我的方法：[https ://stackoverflow.com/a/32784041/2734752](https://stackoverflow.com/a/32784041/2734752)

我使用字典和算法的组合方法来计算音节。

你可以在这里查看我的图书馆：[https ://github.com/troywatson/Lawrence-Style-Checker](https://github.com/troywatson/Lawrence-Style-Checker)

我刚刚测试了我的算法，获得了 99.4% 的命中率！

```
Lawrence lawrence = new Lawrence();

System.out.println(lawrence.getSyllable("hyphenation"));
System.out.println(lawrence.getSyllable("computer")); 
```

输出：

```
4
3 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-09-23T13:26:50.893

在进行了大量测试并尝试了连字符包之后，我根据一些示例编写了自己的包。我还尝试了与连字符字典接口的`pyhyphen`and`pyphen`包，但在许多情况下它们会产生错误的音节数量。对于这个用例来说，这个`nltk`包实在是太慢了。

我在 Python 中的实现是我编写的一个类的一部分，音节计数例程粘贴在下面。它有点高估了音节的数量，因为我还没有找到一种解释无声词尾的好方法。

该函数返回每个单词的音节比率，因为它用于 Flesch-Kincaid 可读性分数。这个数字不一定要准确，只要足够接近就可以估计。

在我的第 7 代 i7 CPU 上，这个函数需要 1.1-1.2 毫秒来处理一个 759 字的示例文本。

```
def _countSyllablesEN(self, theText):

    cleanText = ""
    for ch in theText:
        if ch in "abcdefghijklmnopqrstuvwxyz'’":
            cleanText += ch
        else:
            cleanText += " "

    asVow    = "aeiouy'’"
    dExep    = ("ei","ie","ua","ia","eo")
    theWords = cleanText.lower().split()
    allSylls = 0
    for inWord in theWords:
        nChar  = len(inWord)
        nSyll  = 0
        wasVow = False
        wasY   = False
        if nChar == 0:
            continue
        if inWord[0] in asVow:
            nSyll += 1
            wasVow = True
            wasY   = inWord[0] == "y"
        for c in range(1,nChar):
            isVow  = False
            if inWord[c] in asVow:
                nSyll += 1
                isVow = True
            if isVow and wasVow:
                nSyll -= 1
            if isVow and wasY:
                nSyll -= 1
            if inWord[c:c+2] in dExep:
                nSyll += 1
            wasVow = isVow
            wasY   = inWord[c] == "y"
        if inWord.endswith(("e")):
            nSyll -= 1
        if inWord.endswith(("le","ea","io")):
            nSyll += 1
        if nSyll < 1:
            nSyll = 1
        # print("%-15s: %d" % (inWord,nSyll))
        allSylls += nSyll

    return allSylls/len(theWords) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-06T16:50:57.390

你可以试试[Spacy Sylables](https://spacy.io/universe/project/spacy_syllables)。这适用于 Python 3.9：

设置：

```
pip install spacy
pip install spacy_syllables
python -m spacy download en_core_web_md 
```

代码：

```
import spacy
from spacy_syllables import SpacySyllables
nlp = spacy.load('en_core_web_md')
syllables = SpacySyllables(nlp)
nlp.add_pipe('syllables', after='tagger')

def spacy_syllablize(word):
    token = nlp(word)[0]
    return token._.syllables

for test_word in ["trampoline", "margaret", "invisible", "thought", "Pronunciation", "couldn't"]:
    print(f"{test_word} -> {spacy_syllablize(test_word)}") 
```

输出：

```
trampoline -> ['tram', 'po', 'line']
margaret -> ['mar', 'garet']
invisible -> ['in', 'vis', 'i', 'ble']
thought -> ['thought']
Pronunciation -> ['pro', 'nun', 'ci', 'a', 'tion']
couldn't -> ['could'] 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-19T01:48:40.687

我包括一个在 R 中“可以”工作的解决方案。远非完美。

```
countSyllablesInWord = function(words)
  {
  #word = "super";
  n.words = length(words);
  result = list();
  for(j in 1:n.words)
    {
    word = words[j];
    vowels = c("a","e","i","o","u","y");

    word.vec = strsplit(word,"")[[1]];
    word.vec;

    n.char = length(word.vec);

    is.vowel = is.element(tolower(word.vec), vowels);
    n.vowels = sum(is.vowel);

    # nontrivial problem 
    if(n.vowels <= 1)
      {
      syllables = 1;
      str = word;
      } else {
              # syllables = 0;
              previous = "C";
              # on average ? 
              str = "";
              n.hyphen = 0;

              for(i in 1:n.char)
                {
                my.char = word.vec[i];
                my.vowel = is.vowel[i];
                if(my.vowel)
                  {
                  if(previous == "C")
                    {
                    if(i == 1)
                      {
                      str = paste0(my.char, "-");
                      n.hyphen = 1 + n.hyphen;
                      } else {
                              if(i < n.char)
                                {
                                if(n.vowels > (n.hyphen + 1))
                                  {
                                  str = paste0(str, my.char, "-");
                                  n.hyphen = 1 + n.hyphen;
                                  } else {
                                           str = paste0(str, my.char);
                                          }
                                } else {
                                        str = paste0(str, my.char);
                                        }
                              }
                     # syllables = 1 + syllables;
                     previous = "V";
                    } else {  # "VV"
                          # assume what  ?  vowel team?
                          str = paste0(str, my.char);
                          }

                } else {
                            str = paste0(str, my.char);
                            previous = "C";
                            }
                #
                }

              syllables = 1 + n.hyphen;
              }

      result[[j]] = list("syllables" = syllables, "vowels" = n.vowels, "word" = str);
      }

  if(n.words == 1) { result[[1]]; } else { result; }
  } 
```

以下是一些结果：

```
my.count = countSyllablesInWord(c("America", "beautiful", "spacious", "skies", "amber", "waves", "grain", "purple", "mountains", "majesty"));

my.count.df = data.frame(matrix(unlist(my.count), ncol=3, byrow=TRUE));
colnames(my.count.df) = names(my.count[[1]]);

my.count.df;

#    syllables vowels         word
# 1          4      4   A-me-ri-ca
# 2          4      5 be-auti-fu-l
# 3          3      4   spa-ci-ous
# 4          2      2       ski-es
# 5          2      2       a-mber
# 6          2      2       wa-ves
# 7          2      2       gra-in
# 8          2      2      pu-rple
# 9          3      4  mo-unta-ins
# 10         3      3    ma-je-sty 
```

我没有意识到这是一个多大的“兔子洞”，看起来很容易。

```
 ################ hackathon #######

# https://en.wikipedia.org/wiki/Gunning_fog_index
# THIS is a CLASSIFIER PROBLEM ...
# https://stackoverflow.com/questions/405161/detecting-syllables-in-a-word

# http://www.speech.cs.cmu.edu/cgi-bin/cmudict
# http://www.syllablecount.com/syllables/

  # https://enchantedlearning.com/consonantblends/index.shtml
  # start.digraphs = c("bl", "br", "ch", "cl", "cr", "dr", 
  #                   "fl", "fr", "gl", "gr", "pl", "pr",
  #                   "sc", "sh", "sk", "sl", "sm", "sn",
  #                   "sp", "st", "sw", "th", "tr", "tw",
  #                   "wh", "wr");
  # start.trigraphs = c("sch", "scr", "shr", "sph", "spl",
  #                     "spr", "squ", "str", "thr");
  # 
  # 
  # 
  # end.digraphs = c("ch","sh","th","ng","dge","tch");
  # 
  # ile
  # 
  # farmer
  # ar er
  # 
  # vowel teams ... beaver1
  # 
  # 
  # # "able"
  # # http://www.abcfastphonics.com/letter-blends/blend-cial.html
  # blends = c("augh", "ough", "tien", "ture", "tion", "cial", "cian", 
  #             "ck", "ct", "dge", "dis", "ed", "ex", "ful", 
  #             "gh", "ng", "ous", "kn", "ment", "mis", );
  # 
  # glue = c("ld", "st", "nd", "ld", "ng", "nk", 
  #           "lk", "lm", "lp", "lt", "ly", "mp", "nce", "nch", 
  #           "nse", "nt", "ph", "psy", "pt", "re", )
  # 
  # 
  # start.graphs = c("bl, br, ch, ck, cl, cr, dr, fl, fr, gh, gl, gr, ng, ph, pl, pr, qu, sc, sh, sk, sl, sm, sn, sp, st, sw, th, tr, tw, wh, wr");
  # 
  # # https://mantra4changeblog.wordpress.com/2017/05/01/consonant-digraphs/
  # digraphs.start = c("ch","sh","th","wh","ph","qu");
  # digraphs.end = c("ch","sh","th","ng","dge","tch");
  # # https://www.education.com/worksheet/article/beginning-consonant-blends/
  # blends.start = c("pl", "gr", "gl", "pr",
  #                 
  # blends.end = c("lk","nk","nt",
  # 
  # 
  # # https://sarahsnippets.com/wp-content/uploads/2019/07/ScreenShot2019-07-08at8.24.51PM-817x1024.png
  # # Monte     Mon-te
  # # Sophia    So-phi-a
  # # American  A-mer-i-can
  # 
  # n.vowels = 0;
  # for(i in 1:n.char)
  #   {
  #   my.char = word.vec[i];
  # 
  # 
  # 
  # 
  # 
  # n.syll = 0;
  # str = "";
  # 
  # previous = "C"; # consonant vs "V" vowel
  # 
  # for(i in 1:n.char)
  #   {
  #   my.char = word.vec[i];
  #   
  #   my.vowel = is.element(tolower(my.char), vowels);
  #   if(my.vowel)
  #     {
  #     n.vowels = 1 + n.vowels;
  #     if(previous == "C")
  #       {
  #       if(i == 1)
  #         {
  #         str = paste0(my.char, "-");
  #         } else {
  #                 if(n.syll > 1)
  #                   {
  #                   str = paste0(str, "-", my.char);
  #                   } else {
  #                          str = paste0(str, my.char);
  #                         }
  #                 }
  #        n.syll = 1 + n.syll;
  #        previous = "V";
  #       } 
  #     
  #   } else {
  #               str = paste0(str, my.char);
  #               previous = "C";
  #               }
  #   #
  #   }
  # 
  # 
  # 
  # 
## https://jzimba.blogspot.com/2017/07/an-algorithm-for-counting-syllables.html
# AIDE   1
# IDEA   3
# IDEAS  2
# IDEE   2
# IDE   1
# AIDA   2
# PROUSTIAN 3
# CHRISTIAN 3
# CLICHE  1
# HALIDE  2
# TELEPHONE 3
# TELEPHONY 4
# DUE   1
# IDEAL  2
# DEE   1
# UREA  3
# VACUO  3
# SEANCE  1
# SAILED  1
# RIBBED  1
# MOPED  1
# BLESSED  1
# AGED  1
# TOTED  2
# WARRED  1
# UNDERFED 2
# JADED  2
# INBRED  2
# BRED  1
# RED   1
# STATES  1
# TASTES  1
# TESTES  1
# UTILIZES  4 
```

为了更好地衡量，一个简单的 kincaid 可读性函数...... syllables 是从第一个函数返回的计数列表......

由于我的函数有点偏向于更多的音节，这将给出一个夸大的可读性分数......现在这很好......如果目标是使文本更具可读性，这不是最糟糕的事情。

```
computeReadability = function(n.sentences, n.words, syllables=NULL)
  {
  n = length(syllables);
  n.syllables = 0;
  for(i in 1:n)
    {
    my.syllable = syllables[[i]];
    n.syllables = my.syllable$syllables + n.syllables;
    }
  # Flesch Reading Ease (FRE):
  FRE = 206.835 - 1.015 * (n.words/n.sentences) - 84.6 * (n.syllables/n.words);
  # Flesh-Kincaid Grade Level (FKGL):
  FKGL = 0.39 * (n.words/n.sentences) + 11.8 * (n.syllables/n.words) - 15.59; 
  # FKGL = -0.384236 * FRE - 20.7164 * (n.syllables/n.words) + 63.88355;
  # FKGL = -0.13948  * FRE + 0.24843 * (n.words/n.sentences) + 13.25934;

  list("FRE" = FRE, "FKGL" = FKGL); 
  } 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2018-01-09T16:09:55.567

我曾经使用 jsoup 来执行此操作。这是一个示例音节解析器：

```
public String[] syllables(String text){
        String url = "https://www.merriam-webster.com/dictionary/" + text;
        String relHref;
        try{
            Document doc = Jsoup.connect(url).get();
            Element link = doc.getElementsByClass("word-syllables").first();
            if(link == null){return new String[]{text};}
            relHref = link.html(); 
        }catch(IOException e){
            relHref = text;
        }
        String[] syl = relHref.split("·");
        return syl;
    } 
```

# javascript - 在 JavaScript 中测试函数的最佳方法是什么？

> ID：405164
> 
> 赞同：2
> 
> 时间：2009-01-01T17:11:43.647
> 
> 标签：javascript, function

我对此进行了大量研究，但似乎使用的方法不一致且多种多样。

以下是我过去使用的一些方法：

```
/* 1: */  typeof myFunc === 'function'
/* 2: */  myFunc.constructor === Function
/* 3: */  myFunc instanceof Function 
```

作为我研究的一部分，我了解了一些著名的图书馆是如何做到这一点的：

```
 /* jQuery 1.2.6: */  !!fn && typeof fn != "string" && !fn.nodeName && fn.constructor != Array && /^[\s[]?function/.test( fn + "" )
 /* jQuery 1.3b1: */  toString.call(obj) === "[object Function]"
/* Prototype 1.6: */  typeof object == "function"
      /* YUI 2.6: */  typeof o === 'function' 
```

我很惊讶有这么多不同的方法被使用，肯定已经商定了一个可接受的测试吗？而且我完全不知道 jQuery 1.2.6 的再现的意图是什么，看起来有点 OTT ......

那么，我的问题仍然存在，测试功能的最佳*方法是什么？

我也希望能深入了解上述一些方法，尤其是 jQuery 1.2.6。（我可以看到他们在做什么，只是看起来很奇怪）

[*] “最佳”是指最广泛接受的跨浏览器兼容方法。

* * *

编辑：是的，我知道它之前已经讨论过，但我仍然想讨论一下最有效的方法。为什么有这么多不同的使用方法？

到目前为止，关于 SO 的讨论只提到了 typeof 运算符（大部分），但没有人暗示替代方法的有效性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-01T20:53:05.213

测试对象是否为函数的最佳方法是`typeof myFunc === 'function'`. 如果您使用的是库，请使用该库的函数 test: `jQuery.isFunction(myFunc)`。

使用. *_* _ `typeof`这是非常罕见的，但有一个库可以消除这些不一致。jQuery 解决这些问题：

*   Firefox 报告功能与`typeof document.createElement("object")`
*   Safari 报告功能与`typeof document.body.childNodes`
*   旧版本的 Firefox 将正则表达式报告为函数（在 3.0 中不是这种情况）。
*   一些 IE 内置的全局函数 ( `alert`) 和一些节点方法 ( `getAttribute`) 被报告为“对象”类型。

使用`instanceof`而不是`typeof`规避其中的一些。例如， `document.createElement("object") instanceof Function`在`false`Firefox 中。

[您可以在原始票证（#3618）](http://dev.jquery.com/ticket/2968)的评论中查看第一种方法的诞生。新方法来自[变更集 5947](http://dev.jquery.com/changeset/5947)，似乎是 Resig 发明的，用于解决[IE 内存泄漏](http://dev.jquery.com/ticket/3618)问题。它可能更慢，但更小，更干净。

== 和 === 之间在事情如何工作方面没有太大区别，但严格的评估稍微快一点，因此更受欢迎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T17:34:17.830

jQuery 的开发者 John Resig 似乎确实在 jQuery 的内部做出了一些奇怪的选择。

```
toString.call(obj) === "[object Function]" 
```

看起来很整洁，但我想不出任何上述情况都是正确的，而简单的`typeof`方法会失败，但也许他知道其他使用方法不知道的东西。

```
typeof o === "function" 
```

我会选择后者，因为它更清晰，除非你有强有力的证据表明它不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T19:05:05.180

为什么要使用严格相等，`typeof`因为两个操作数都是字符串？我忽略了一些问题？

无论如何，我会采用更简单的 typeof 方式，这似乎是为此而做的并且是可读的。`instanceof`也是可读的，但它似乎更多地坚持函数是一个对象这一事实，这可能与问题无关。

# python - 请为非常喜欢 LISP 的人提供有关 Ruby 与 Python 的建议

> ID：405165
> 
> 赞同：21
> 
> 时间：2009-01-01T17:12:12.943
> 
> 标签：python, ruby, lisp

我是一名 C++ 开发人员，正在慢慢进入 Web 开发领域。我非常喜欢 LISP，但不喜欢可用于 LISP 的 AllegroCL 和网络框架。我正在寻找更多的自由和在语言层面上做酷黑客的能力。我不认为标签是对自然的犯罪。

哪个更接近 LISP：Python 还是 Ruby？

我似乎无法从 Python 和 Ruby 中进行选择：它们看起来非常相似，但显然 Ruby 更具有功能性和面向对象，这些都是好东西，而 Python 更像是 Perl：一种简单的脚本语言。我有正确的印象吗？

PS - 这可能看起来像一个火焰诱饵，但实际上并非如此，我只是尽量不要因为强迫症而疯狂地从 RoR 切换到 Python/Django 并返回。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-01T17:40:13.153

[Peter Norvig](http://norvig.com)，[一位著名的伟大的 lisper](http://norvig.com/paip.html)，转换为 Python。他写了文章[Python for Lisp Programmers](http://norvig.com/python-lisp.html)，你可能会发现它对特性的详细比较很有趣。

Python 看起来像可执行的伪代码。它很容易上手，而且经常使用你的直觉就可以了。Python 允许您轻松地将您的想法转化为代码。

现在，对于 Web 开发，Python 可能看起来比 Ruby 更分散，有大量 Python Web 框架可用。尽管如此，总的来说，Python 是一种非常好的和有用的语言。由于 Ruby 和 Python 的利基重叠，我同意 Kiv 的观点，部分原因在于您选择哪一个是个人喜好问题。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-01T17:24:30.813

我会和鲁比一起去。它有各种元编程和打鸭技巧，使其非常容易扩展。像块这样的功能一开始可能看起来并不多，但如果你正确使用它们，它们会产生一些非常干净的语法。如果你把开放类搞砸了，它们可能会调试地狱，但如果你是一个负责任的程序员，你可以`2.days.from_now`很容易地做一些事情（来自 Rails 的例子）（我认为 Python 也可以做到这一点，但有点痛苦）

PS：查看[“为什么 Ruby 是可接受的 LISP”](http://www.randomhacks.net/articles/2005/12/03/why-ruby-is-an-acceptable-lisp)。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-01T19:23:00.450

**恶魔倡导者：谁在乎？**

它们都是很好的系统，并且拥有一个由良好的 Web 框架和活跃的开发者社区组成的生态系统。我猜你是根据错误的标准来制定你的决定。这个问题听起来像是你在担心你是否会因为选择一个而不是另一个而遇到实施问题或其他困难。 **不。**

这类似于 Java/.Net 决策。在特定情况下可能有令人信服的原因，但架构师对平台的熟悉程度等软因素是项目成功的更强有力的预测因素。

我承认我使用 Python 比使用 Ruby 多得多，但我不会说除了熟悉之外我对这两者有很大的偏好。我从大约 1998 年开始就断断续续地使用 Python，我喜欢 Ruby 的 Smalltalkish 特性，因为我在大约 15 年前曾短暂使用过 Smalltalk。他们都做类似的事情略有不同。

我想要 Ruby（或 Smalltalk 的某些特性），但 Python 不能那样工作。相反，它具有其他功能，并且语言习语与 Ruby 或 Smalltalk 略有不同。 [其他](https://stackoverflow.com/questions/405165/please-advise-on-ruby-vs-python-for-someone-who-likes-lisp-a-lot#405188)[几张](https://stackoverflow.com/questions/405165/please-advise-on-ruby-vs-python-for-someone-who-likes-lisp-a-lot#405206)[海报](https://stackoverflow.com/questions/405165/please-advise-on-ruby-vs-python-for-someone-who-likes-lisp-a-lot#405312)链接到比较两者的文章。

如果您担心 Rails 与 Django，这表明您正在寻找 Web 应用程序的平台。两种语言都有良好的工具支持和活跃的开发者社区。Django 似乎是 Python web 框架混战的赢家，Rails 似乎正在“跨越鸿沟”并将 Ruby 带入其中。两者都是相当成熟的系统，并且已被证明可以很好地应对可观的交通量。

**专业提示：**宗教战争的存在是一个很好的指标，表明双方都没有令人信服的论点。

所以，我要扮演魔鬼的拥护者，说担心选择是没有意义的。这些语言相互之间有优点和缺点，但在一般情况下没有什么可以被视为引人注目的。担心一个平台或另一个平台的详细优点是错误地制定了决定。

选择一个并使用它。您将能够使用其中任何一个有效地构建系统。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-01T18:00:04.593

作为一个“Rubyist”，我同意 Kiv 的观点。这两种语言在编程范式方面都有很大的余地，但也有优点/缺点。我认为你做出的任何一种妥协很大程度上取决于你自己的编程风格和品味。

就个人而言，我认为 Ruby 读起来更像是伪代码而不是 Python。首先，Python 有活跃的空白，虽然在许多人眼中它很优雅，但在编写伪代码时不会进入等式。此外，Ruby 的语法非常灵活。这种灵活性会导致许多可能令人困惑的怪癖，但也允许代码非常富有表现力且看起来很漂亮。

最后，我真的想说 Ruby 对我来说更像 Perl。这部分是因为我对它更舒服，所以我可以很快地破解脚本。虽然很多 Ruby 的语法都是从 Perl 借来的，但我还没有看到太多感觉相似的 Python 代码（尽管我对 Python 的经验也很少）。

根据您希望采用的 Web 编程方法，我认为每种语言中可用的 Web 框架类型可能也是决定的一个因素。我会说两个都试试。您可以在一个下午获得它们中的每一个的工作知识，虽然您不会编写出色的 Ruby 或 Python，但您可能可以对它们建立一种感觉，并决定您更喜欢哪个。

**更新：**我认为您的问题实际上应该是两个单独的讨论：一个是 Ruby，一个是 Python。比较不太重要，因为您开始争论差异的优点，而不是哪种语言更适合您。如果您对 Ruby 有任何疑问，我将非常乐意尽我所能回答。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-01T19:01:50.057

Ruby 和 Python 都与不可变数据、程序即数据和宏的 Lisp 传统相去甚远。但是 Ruby 几乎是 Smalltalk 的一个克隆（我希望随着 Perlish 杂乱无章的弃用，它会变得更像 Smalltalk），而 Smalltalk 和 Lisp 一样，是一种将一个想法发挥到极致的语言。基于您希望**在语言级别上做一些很酷的 hack，**我会选择 Ruby，因为它继承了 Smalltalk 的许多元编程思维方式，并且这种思维*方式*与 Lisp 传统有关。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-01T19:03:23.843

Alex Martelli[对该主题进行了很好的分析](http://groups.google.com/group/comp.lang.python/msg/28422d707512283)。现在有点过时了，但我同意它的基本要点： **Python 和 Ruby 是实现同一事物的两种不同方式**。当然，有些事情你可以用 Ruby 做，而用 Python 做不到。并且确定 Python 的语法（可以说）比 Ruby 的更好。但是当你开始认真对待它时，并没有很多客观、科学的理由来选择一个胜过另一个。

你会听到的一个常见的事情是：平台比语言更重要，Python 的平台比 Ruby 更好（这个论点是双向的，所以不要投票给我，你们所有的 ruby​​ 主义者）。它有一些道理。不幸的是，它不是很相关。如果您不喜欢这两种语言的平台，Java 和 .Net 都有实现，因此如果您对平台有疑虑，可以使用它们。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-01T17:42:31.010

我还推荐namin 发布的[Peter Norvig的文章。](http://norvig.com/python-lisp.html)如果您想了解 Python 中的函数式编程，请查看标准库中的[functools](http://docs.python.org/dev/3.0/library/functools.html)模块。

在 Python 中也有很大的改进空间；私有变量是按照约定而不是强制执行的，因此如果您愿意，可以在对象的内部状态中四处寻找。不过，通常这不是必需的。

Ruby 和 Python 都非常面向对象，并且支持函数式编程；我不会说任何一个都明显优于您的项目。这部分是个人品味的问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-01T19:56:37.870

我是 Pythonista；但是，根据您的要求，尤其是“语言级别的酷技巧”，我建议您使用 Ruby。Ruby 在 Perl 的方式上更灵活，你可以做很多 hack；Python 的目标是*可读性*，这是一件非常好的事情，通常语言黑客有点不受欢迎。Ruby 的基本类型可以以原型语言通常允许的黑客方式进行修改，而 Python 的基本类型更适合子类化。

顺便说一句，我要补充一点：Ruby 和 Python 都是非常非常面向对象的，它们都不打算像 Perl 那样用于快速而肮脏的脚本。在这两者中，Ruby 在语法上更类似于 Perl 而不是 Python。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-01T19:06:39.203

如果您需要 Unicode 支持，请记住检查它的支持程度。AFAIK，Python 对 Unicode 的支持比 Ruby 更好，尤其是从 Python 3.0 开始。另一方面，Python 3 仍然缺少一些流行的包和 3rd 方库，所以这可能会产生冲突。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-01T20:58:37.730

我是一名 Rubyist，他根据非常相似的标准选择了该语言。Python 是一门很好的语言，我也喜欢使用它，但我认为 Ruby 在它给程序员的自由度方面更像 Lispy。Python 似乎更多地强加了它的意见（这可能是一件好事，但不符合我们这里的标准）。

Python 肯定不是更 Perl —— Ruby 本质上是 Smalltalk/Perl 混搭（它的一些较少使用的特性直接从 Perl 中提取），而 Python 只是与这两者的关系较远。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-01T22:27:38.360

为您的域选择最受欢迎的一个，以便您的工作获得最大的知名度。有些人可能会说 ruby​​/rails 用于 web，python 用于其他一切。仅仅因为它像lisp而选择一种语言确实不适合专业人士。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-06-12T22:06:54.327

如果你喜欢 lisp，我认为你会更喜欢 ruby​​，但 c++ 让我想起了 python。我已经发布了一篇关于这个主题的小帖子：http: [//hartator.wordpress.com/2011/06/12/ruby-vs-python-2011/](http://hartator.wordpress.com/2011/06/12/ruby-vs-python-2011/)

# c++ - 一旦 C++0x 成为主流，boost 的重叠部分会发生什么？

> ID：405175
> 
> 赞同：12
> 
> 时间：2009-01-01T17:16:03.793
> 
> 标签：c++, boost, c++11

一旦 C++0x 成为主流，boost 的重叠部分会发生什么？

boost 是否仍会包含以前的所有内容，或者他们是否会调整库以使用新的 std:: 内容对其进行更新？

boost 会同时拥有正常的 c++ 版本和他们将维护的 c++0x 版本吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-01T17:42:29.030

出于几个原因，人们*希望*Boost 继续支持现有的类。

首先，有一段代码使用了 Boost 中的重叠特性，需要在一段时间内得到支持。

其次，重叠的实现允许我选择我更喜欢使用哪一个。std::Frob 和 Boost::Frob 之间可能存在一些对我的项目很重要的区别，并且有一个选择是好的。

不过，从长远来看，我希望应用程序编写者和工具提供者都向标准迁移。这使得使用 std:: 成为一个风险较小的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T17:30:22.110

我不隶属于 Boost，也不知道他们会做什么，但似乎 Boost 不会受到影响。

已经发布了 TR1（VS 2008 功能包）并且 Boost 保持不变。由于许多用户尚未采用 Boost 或 TR1，我的预测是至少在未来五年内，boost 和 c++0x 库将存在于不同的命名空间中，并且可供 C++0x 用户和 C++ 用户使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T01:43:03.577

Namespaces make this somewhat of a non-issue for the Boost developers. There is no direct contention between the boost libraries and the standard libraries because they exist in separate namespaces. Therefore, changes to namespace std (for example the addition of std::tr1) have no direct impact on Boost.

Note however, that if you are importing both libraries (std and boost) into the global namespace, then you will have issues.

The following quote from the Boost TR1 documentation also sheds some light regarding Boost's implementation of TR1 components, suggesting that the corresponding Boost library will be maintained for the foreseeable future:

> The TR1 library provides an implementation of the C++ Technical Report on Standard Library Extensions. This library does not itself implement the TR1 components, rather it's a thin wrapper that will include your standard library's TR1 implementation (if it has one), otherwise it will include the Boost Library equivalents, and import them into namespace std::tr1.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T20:58:53.923

你是说tr1吗？

Boost 已经支持 tr1。boost 中所有被 std::tr1 采用的类都可以在 boost 的这个命名空间中使用。请参阅以下文档。

[http://www.boost.org/doc/libs/1_37_0/doc/html/boost_tr1.html](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_tr1.html)

# sql-server - 如何简化这个 Sql 查询

> ID：405176
> 
> 赞同：1
> 
> 时间：2009-01-01T17:16:25.417
> 
> 标签：sql-server, tsql, sql-server-2008

表 - 查询有 2 列（functionId、depFunctionId）

我想要所有在 functionid 或 depfunctionid 中的值

我正在使用这个：

```
select distinct depfunctionid from Query
union 
select distinct functionid from Query 
```

如何做得更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-01T17:20:26.297

我认为这是你能得到的最好的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T17:22:29.443

这和我想的一样好...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T20:48:58.857

丢失 DISTINCT 子句，因为您的 UNION（与 UNION ALL 相比）将负责删除重复项。

另一种选择 - 但可能不太清楚并且可能具有相同的执行计划 - 是跨 2 列执行 FULL JOIN。

```
SELECT 
    COALESCE(Query1.FunctionId, Query2.DepFunctionId) as FunctionId
FROM Query as Query1
FULL OUTER JOIN Query as Query2 ON
    Query1.FunctionId = Query2.DepFunctionId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T19:30:02.837

我几乎可以肯定你可以失去独特的。当您使用 UNION 而不是 UNION ALL 时，重复的结果将被丢弃。

这完全取决于您的内联视图查询的重量。获得更好性能的关键是只执行一次，但鉴于它返回的数据，这是不可能的。

如果你这样做：

```
select depfunctionid , functionid from Query
group by depfunctionid , functionid 
```

对于 depfunctionid 或 functionid，您很可能会得到重复的结果。

我可能是错的，但在我看来，您正在尝试检索依赖关系树。如果是这样，我个人会尝试使用物化路径方法。

如果物化路径存储在自引用表名中，我将使用类似的东西检索树

```
select asrt2.function_id
from   a_self_referencig_table asrt1,
       a_self_referencig_table asrt2
where  asrt1.function_name = 'blah function'
and    asrt2.materialized_path like (asrt1.materialized_path || '%')
order  by asrt2.materialized_path, asrt2.some_child_node_ordering_column 
```

这将以正确的顺序检索整个树。糟糕的是必须基于 function_id 和 parent_function_id（或者在你的情况下，functionid 和 depfunctionid）构建物化路径，但是触发器可以很容易地处理它。

# sql-server-ce - 使用类型化 DataSet 和 DataGridView 的最后插入记录 ID 问题

> ID：405189
> 
> 赞同：3
> 
> 时间：2009-01-01T17:24:34.557
> 
> 标签：sql-server-ce, strongly-typed-dataset, tableadapter, lastinsertid

我正在为一个简单的数据库应用程序使用以下内容：

*   SQL Server Compact Edition .sdf 文件作为数据库，具有 int 主键 ID。
*   类型化 DataSet 和 BindingSource 作为数据访问层
*   DataGridView 用于显示数据。

我的问题是，最后插入的记录/行 ID 有问题。当我使用导航器组件的追加按钮向 datagridview 添加一行时，新记录/行的 ID 为-1。即使使用 TableAdapter.Update() 将数据保存到数据库后，它仍然是 -1。*我知道我可以使用带有 @@identity 或 scope_identity() 的单独查询来获取最后一个 ID，但是您只需要*手动使用另一个查询来更新您的数据听起来并不正确。我在这里错过了什么吗？在保存到数据库并获取刚刚插入的记录的 ID 后，是否有自动更新数据的方法？

另外，我在数据集设计器->表适配器配置->高级窗口中看到了“刷新数据表”选项，但由于某种原因它被禁用了。但是不知道有没有关系。。

我会很感激这方面的任何帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T12:02:01.343

感谢您的两个答案。我找到了问题的根源，不幸的是没有我喜欢的解决方案。问题出在 SQL Server Compact Edition 中。由于它不支持存储过程或多活动结果集 (MARS)，因此您不能在一个查询中运行多个 SQL。因此“刷新数据表”选项被禁用，如果它没有被禁用，它将用实际值更新 ID 值。我要将我的主键 ID 值从 int 更改为 Guid 并处理 DataGridView 的 RowInit 事件并手动为新行提供 Guid ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T19:40:00.353

您还可以尝试在存储过程中将您的标识列声明为 OUTPUT 参数。

```
CREATE PROCEDURE YourSP
(@ID int OUTPUT, ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T21:23:56.607

set IdentitySeed and IdentityIncrement to 1 and evereything works.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T18:00:02.630

我通常用我的 DTO 做的事情类似于下面的 vb

```
Public Sub InsertSupplier(ByVal SupplierObject As Supplier) Implements ISupplierRepository.InsertSupplier
SupplierObject.SupplierID = MyBase.ExecuteNonQueryWithReturnValue("usp_Northwind_InsertSupplier", SupplierObject.CompanyName)
End Sub 
```

使用类似于以下的我的存储过程

```
USE [Northwind]
GO
/****** Object:  StoredProcedure [dbo].[usp_Northwind_InsertSupplier]    Script Date: 1/1/2009 10:59:01 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[usp_Northwind_InsertSupplier]
@CompanyName nvarchar(40)
AS
INSERT INTO dbo.Suppliers
VALUES (@CompanyName)

RETURN @@Identity 
```

只是为了澄清我在基类中的 1 班轮做了什么（使用企业库仅供参考）

```
Public Function ExecuteNonQueryWithReturnValue(ByVal storedProcedureName As String, ByVal ParamArray parameterValues() As Object) As Object Implements Interfaces.IRepository(Of T).ExecuteNonQueryWithReturnValue
    Dim Output As Object
    Dim db As Database = DatabaseFactory.CreateDatabase()
    Dim dbCommand As Common.DbCommand = db.GetStoredProcCommand(storedProcedureName, parameterValues)
    db.ExecuteNonQuery(dbCommand)
    Output = CType(db.GetParameterValue(dbCommand, "@RETURN_VALUE"), Object)
  Return Output
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T08:46:15.583

我在 Microsoft SQL Server Compact Edition 的文档中发现了这一点：

返回最后插入的身份：

选择@@IDENTITY 或选择@@IDENTITY AS 'TEMPNAME'

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-18T17:49:17.177

我认为在更新数据库后，您将不得不在 gridview 上调用 databind()，只要您依赖数据库为新插入的记录自动生成密钥。

# sql-server - 具有持续集成的 SQL Server 数据库管理

> ID：405192
> 
> 赞同：13
> 
> 时间：2009-01-01T17:26:44.193
> 
> 标签：sql-server, database, continuous-integration

假设我们有一个持续集成服务器。当我签入时，后挂钩会提取最新代码，运行测试，打包所有内容。自动化数据库更改的最佳方法是什么？

理想情况下，我会构建一个安装程序，它既可以从头开始构建数据库，也可以使用某种自动同步方法更新现有数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-30T10:36:38.820

最近偶然看到[一篇文章](https://www.sqlshack.com/sql-server-database-continuous-integration-ci-best-practices-and-how-to-implement-them-testing-processing-and-automation/)，可能有用。

作者解释了一些最佳的持续集成实践，包括测试、处理和自动化。

以下是一些关键要点：

*   在许多商店中，代码在提交时进行了单元测试。对于数据库，作为测试步骤的一部分，最好是针对 QA 数据库按顺序运行所有单元测试，而不是开发
*   测试步骤是任何 CI/CD 流程的关键部分。测试脚本，包括单元测试本身，也应该在源代码控制中进行版本控制，在构建步骤中提取并执行
*   从生产中提取数据是一种快速的权宜之计，但绝不是一个好主意
*   最好的方法是使用工具或脚本为您的事务表快速、重复和可靠地创建综合测试数据
*   运行单元测试以生成供人类消费的手动摘要结果违背了自动化的目的。我们需要机器可读的结果，它可以允许自动化过程中止、分支和/或继续。
*   运行一个需要 100% 通过所有测试的 CI 流程，如果工作流管道被原子地设置为在失败时停止，它就类似于根本没有 CI，这是它应该的。为了做到这一点，测试应该内置阈值，这将根据测试失败的百分比或在某些情况下，如果某些高优先级测试失败，则会引发错误。
*   所有流程最终都应该产生一个通过或失败的布尔结果，但一些非自动化流程可以很容易地进入您的 CI 工作流管道（例如单元测试）。软件应该即插即用到任何工作流管道中，接受已知的输入并产生预期的输出——比如通过、失败。
*   CI/CD 流程应在失败时中止，并应立即发送通知电子邮件，而不是继续循环管道。
*   在最后一次构建中的任何错误得到修复之前，CI 过程不应再次循环。失败时，整个团队都应该收到失败通知，包括尽可能多的失败细节。
*   如果管道从开始到结束需要 1 小时才能完成，包括所有测试，那么所有构建间隔应设置为不少于一小时，并且所有新提交都应排队，并应用于下一个构建。
*   自动化脚本中不应存在纯文本密码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T17:31:32.890

如果您有机会定义和控制整个数据库管理和数据库创建过程，请认真看看[DB Ghost](http://www.innovartis.co.uk/Home.aspx) - 它不仅仅是一个工具 - 它是一个过程。

如果您喜欢它并且可以实施它，您将获得丰厚的回报——但这有点像“全有或全无”的方法。受到推崇的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-20T18:49:22.480

我会告诫不要将数据库备份用作开发工件，大多数 CI 最佳实践建议您将架构、过程、触发器和视图作为一流的开发工件进行管理。副作用是您可以更进一步，并随时使用它们来构建新数据库，理想情况下，您还可以将一些数据推送到数据库中。

这是一个悬崖笔记版本，可以让你的脚湿透，但这个空间有很多：http: [//www.infoq.com/news/2008/02/versioning_databases_series](http://www.infoq.com/news/2008/02/versioning_databases_series)

我也喜欢 Scott Ambler 在这里的一些想法，这个网站很好，但是这本书对于如此困难的问题集的深度却出人意料。 [http://www.agiledata.org/](http://www.agiledata.org/) [http://www.amazon.com/exec/obidos/ASIN/0321293533/ambysoftinc](https://rads.stackoverflow.com/amzn/click/com/0321293533)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-11T18:08:16.510

使用 SQL 源代码控制和 SQL Compare Pro 命令行的 Red Gate 方法在此处通过代码示例进行了详细说明：http: [//downloads.red-gate.com/HelpPDF/ContinuousIntegrationForDatabasesUsingRedGateSQLTools.pdf](http://downloads.red-gate.com/HelpPDF/ContinuousIntegrationForDatabasesUsingRedGateSQLTools.pdf)

Troy Hunt 在 Simple Talk 上写了一篇题为“SQL Server 数据库的持续集成”的文章： [http ://www.simple-talk.com/content/article.aspx?article=1247](http://www.simple-talk.com/content/article.aspx?article=1247)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-10T08:13:21.900

Red Gate 是一个非常强大的解决方案，它开箱即用。但最好的事情是您可以将它与您的持续集成过程集成。我将它与 Msbuild 和 Hudson 一起使用。快速解释它是如何工作的：http: [//blog.vincentbrouillet.com/post/2011/02/10/Database-schema-synchronisation-with-RedGate](http://blog.vincentbrouillet.com/post/2011/02/10/Database-schema-synchronisation-with-RedGate)

如果您需要了解更多信息，请随时询问

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-27T17:27:08.087

你看过**FluentMigrator**吗？默认下载包括很容易添加到 CI 中的 Nant 脚本。免费、开源且易于使用。适用于各种数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-09T19:29:47.137

DB Ghost 的最新版本 (5.0) 没有遇到“非 ASCII 字符”问题（它只是意味着文件是 UTF8 编码的），它应该能够完全满足您的需求。

此外，如果您愿意，这些工具实际上可以独立使用来执行各种功能（脚本、构建、比较、升级和打包），只是将它们一起使用提供了一个完整的端到端流程，从而实现了整体价值大于其各部分的总和。

本质上，要对架构进行更改，您需要更新单独的对象创建脚本和每个表的插入脚本（用于参考数据），这些脚本受源代码控制，就像您开发“第一天”的新建数据库一样。DB Ghost 工具用于通过将这些脚本构建到一个全新的数据库（如果需要使用持续集成）然后比较和升级目标数据库（可以是生产数据库的副本）来启用整个功能。此过程会生成一个增量脚本，该脚本可在上线期间用于实际生产数据库。

您甚至可以生成一个 Visual Studio 数据库项目并将其添加到您当前拥有的任何解决方案中。

马尔克

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-12T20:06:24.003

我知道这篇文章很旧，但我们有一个采用以下方法的新解决方案：

1.  开发人员编写单独的 SQL 更改脚本并将其提交到源代码控制。
2.  我们的程序 ( [OneScript](https://www.onescript.com/) ) 从源代码管理中提取更改脚本文件，对其进行过滤和排序，并生成单个发布脚本文件。
3.  然后将该发布脚本文件应用于数据库以进行发布。

我们的主页更详细[地](https://www.onescript.com/)解释了这个过程，并提供了一个示例链接，该示例从 Subversion 挂钩自动执行这些步骤。提交后不久，开发人员会收到一封电子邮件，说明发布是成功还是有错误。包括 PowerScript 代码。

免责声明 - 我在制作 OneScript 的公司工作。

# asp.net - 将 Crystal Report 导出到文本文件 - 无 RTF 文件

> ID：405193
> 
> 赞同：5
> 
> 时间：2009-01-01T17:27:32.833
> 
> 标签：asp.net, file, text, crystal-reports

我正在使用 VS 2005 附带的 Crystal Report。我需要将 Crystal Report 导出到文本文件。有什么办法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T18:18:06.790

看起来他们出于某种原因取消了该[枚举。](http://msdn.microsoft.com/en-us/library/ms226443(VS.80).aspx)我想您可以遍历底层记录集，然后自己将内容转储到文本文件中。什么是皮塔饼……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T13:30:51.413

I think the closest you will get to a text file is to export as csv.

ExportFormatType.CharacterSeparatedValues

Now, the thing that sucks about this is if the report is designed to look good (with page footers, headers, etc) the csv file will contain all that. So you would need to make a minimal report to get a good csv export. Which really almost makes it seem more logical to dump to text file yourself.

# gpl - GPL 代码：什么算作衍生作品？

> ID：405208
> 
> 赞同：40
> 
> 时间：2009-01-01T17:40:57.333
> 
> 标签：gpl

我正在开发一个我想在许可许可下发布的开源项目，因为它是一个库，而不是应用程序，而且我个人不喜欢库代码的 copyleft。如果我浏览用不同编程语言编写的 GPL 代码只是为了大致了解如何做某事，然后用我正在使用的语言编写类似或相同算法的不同实现，那么可能是什么后果？如果我的代码与他们的代码有些相似并且明显受其影响，那么 Copyleft 所有者是否会有任何合理的投诉？这些灰色区域通常如何运作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T18:12:25.973

“什么是衍生作品？” 不是程序员可以回答的问题。参见例如[“聚合”和其他类型的“修改版本”有什么区别？](http://www.gnu.org/licenses/gpl-faq.html#MereAggregation)以及一般的[GNU 许可证常见问题解答](http://www.gnu.org/licenses/gpl-faq.html)。

关于您的具体情况，算法通常不受版权法的约束，但（可悲的是）受专利法的约束。

这些灰色区域通常的运作方式是，你对它持开放态度，与原作者交谈，也许会达成协议。这样的案件不太可能在法庭上告终，因为任何一方都无法从中获得太多收益。如果它*最终*出现在法庭上，将由律师和法官做出决定，而不是程序员。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-01T18:26:40.313

在发布任何类型的库时，我通常使用 X11 许可证（又名 3 条款 BSD），即使我知道在发布程序时倾向于 GPL2/3。我这样做是因为我想确保任何 FLOSS 项目都可以不受限制地使用我的库，这对我来说比在库方面断言 copyleft 的理想更重要。

在这方面限制库有点愚蠢，例如，BSD 将 GNU 的 libreadline 重写为 editline 并保持 100% 兼容的接口。这也是为什么您可能可以做您打算做的事情的一个例子。

如果您正在查看一些用 Scheme 编写的示例，或者说 LISP，甚至可能是 PERL .. 并用 C 编写它的一些实现，那么您应该完全没问题。在制作自己的实现时，研究现有实现绝对没有错。

我强烈建议您直接询问 GNU 项目，发送电子邮件至 license@gnu.org 并向他们提供您希望完成的工作的详细信息。您一定会收到非常友好的回复，并且可以放心进行。

就连 RMS 本人也会承认解释 GPL/AGPL/LGPL 可能很乏味，他们期待并欢迎这类问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T21:00:27.633

2 个可能符合您要求的出色许可证：

1.  [Apache 许可证，2.0 版](http://www.apache.org/licenses/)，非常宽松（如 MIT/BSD），但对双方都有专利诉讼保护
2.  [LGPL，版本 3](http://www.gnu.org/licenses/lgpl.html)，允许使用该库，但进一步开发它（并分发它）需要保留 LGPL 并发布源代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T18:08:31.020

免责声明：我不是律师，您应该去找一位对软件许可有足够了解的知识产权律师。如果你去看一个愚蠢的人，他或她会告诉你“不要为了安全起见而这样做”，任何人都可以这样说。

参见[洁净室设计](http://en.wikipedia.org/wiki/Clean_room_design)。如果软件的行为几乎完全相同，则您不应该阅读源代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T18:17:43.233

根据您计划使用的许可许可证，这个问题可能没有实际意义。换句话说，如果您的代码将具有 LGPL 提供的基本自由，那么即使是代码的直接副本也可以，并且版权所有者不太可能追随您。

另一点是，如果原始代码是 GPL 的，那么作者不太可能会反对你从他的算法和想法中推导出一些东西（因为 copyleft 者倾向于反对软件专利）。

通常的 IANAL 免责声明 - 我只是不认为这可能是现实生活中的问题，除非您使用大量代码并尝试限制作者打算通过其 copyleft 保证的自由。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-01T19:08:44.440

通常，如果您的 SW*必须*“链接”到 GPL 代码才能运行，那么它就是派生工作......

# editor - Komodo 编辑：如何进行这些基本的宏和代码段操作？

> ID：405212
> 
> 赞同：1
> 
> 时间：2009-01-01T17:43:10.027
> 
> 标签：editor, macros, komodo, code-snippets

我想知道如何在 Komodo Edit 中对这些基本的宏和片段操作执行（或在哪里找到文档）。

*   1) FILE/IO：从 komodo javascript 宏中将字符串写入临时文件

*   2) FILE/IO：将文本文件的内容读入 komodo javascript 宏中的字符串

*   3) INCLUDES：在宏中交叉引用本地 javascript“包含”库，或等同于 #script src="~/mylocal_javascript_addons.js" 的东西所以我可以合并宏代码。

*   4）SNIPPET_OUTPUT：创建一个片段插值占位符，它返回用户定义的javascript函数或宏的输出。

    例如：

    **[[%(myscript:SayHelloWorld())]]**

    **[[%(foomacro-MyAgeInMilliseconds)]]**

*   5) MACRO_OUTPUT：宏，在当前缓冲区中进行*多行*选择并将其传递给本地脚本或批处理文件，然后将选择替换为输出结果。（需要一种在 MSFT Windows 中执行此操作的方法，而不仅仅是 linux）。

如果您可以使用 Python 而不是 Javascript 回答其中的一个或多个问题，那就太好了，但请包含示例代码或指向它的链接，因为 Python 文档似乎非常 TODO。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-04T23:04:25.967

没有你的答案，但你可能有更多的运气在这里问：

[http://community.activestate.com/forums/komodo-extensions](http://community.activestate.com/forums/komodo-extensions)

# iphone - 什么是 iPhone 内存监视器？

> ID：405217
> 
> 赞同：3
> 
> 时间：2009-01-01T17:48:05.773
> 
> 标签：iphone, cocoa-touch, memory, monitor

我听说很多人都在谈论一个名为 Memory Monitor 的工具，它可以更好地检查 iPhone 应用程序的内存使用情况，因为 Object Alloc 不能准确地了解应用程序实际使用了多少内存。

如何启动内存监视器？我在乐器中找不到。它是我必须下载的单独工具的一部分吗？

谢谢！缺口。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-03T03:59:08.120

Memory Monitor 只是 Instruments 中的工具之一。开始 Instruments 运行后（Xcode：Run > Start With Performance Tool > Leaks），单击 Instruments 窗口工具栏中的 Library 并将 Memory Monitor 拖到主窗口中。

内存监视器很重要，因为它显示了您的应用程序的总内存使用情况，无论该使用情况是否反映在 ObjectAlloc 中。

Memory Monitor 中最重要的栏似乎是最后一个，Total Memory Used。如果这个继续攀升，最终你的应用程序将会失败。通过时间栏（窗口顶部）拖动三角形控件以获取任何时间点的数值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T06:06:11.710

如果您希望帮助定位代码中的漏洞，请尝试：[http ://clang.llvm.org/StaticAnalysis.html](http://clang.llvm.org/StaticAnalysis.html)

最好的问候理查德 L. 伯顿三世

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-01T18:52:12.587

“Leaks” Instruments 模板还监控整体内存使用情况（以及更多）。Activity Monitor 应用程序 (/Applications/Utilities/Activity Monitor.app) 可能是虚幻的“Memory Monitor”。它具有实际和虚拟内存使用情况的指示。

我不知道有任何其他明确称为“内存监视器”的工具。如果存在这样的应用程序，我无法想象它会获得 Activity Monitor 和 Instruments 尚未考虑的其他数据。

# sql - SQL Server 用什么代替“密钥”？

> ID：405229
> 
> 赞同：0
> 
> 时间：2009-01-01T18:00:29.757
> 
> 标签：sql, mysql, sql-server

我有一个我使用的 MySQL 查询脚本，并且可以正常工作。

我正在尝试在 Microsoft SQL Server 中执行相同的查询，但有一件事我不明白。

MySql 使用“key”来定义由不同字段组成的键。

在 SQL Server 中做同样事情的方法是什么？

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T18:05:13.850

您可以在 TSQL（SQL 服务器的查询语言）中声明由多列组成的主键

```
ALTER TABLE product
    ADD CONSTRAINT prim_prod PRIMARY KEY(product_foo, product_bar) 
```

如果你使用 SQL Server Management studio，你也可以通过“修改表”来实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T20:24:01.857

在 MySQL 中，关键字`KEY`只是`INDEX`. 以下两个是等价的：

```
CREATE TABLE foo (
  id     SERIAL PRIMARY KEY,
  ctime  DATETIME,
  KEY ctkey (ctime)
);

CREATE TABLE foo (
  id     SERIAL PRIMARY KEY,
  ctime  DATETIME,
  INDEX ctidx (ctime)
); 
```

在 Microsoft SQL Server 中，最接近的等价物是`INDEX`. 据我所知，要在 Microsoft SQL Server 中的列上创建索引，您可以使用`CREATE INDEX`. 您还可以创建将索引构建为`CREATE TABLE`语句一部分的约束，但如果您只需要索引，请使用`CREATE INDEX`.

```
CREATE TABLE foo (
  id     BIGINT IDENTITY PRIMARY KEY,
  ctime  DATETIME
);

CREATE INDEX ctidx ON foo(ctime); 
```

另请参阅有关[`CREATE INDEX`](http://msdn.microsoft.com/en-us/library/ms188783(SQL.90).aspx).

# active-directory - 允许用户仅在 Active Directory 中自己的 OU 中枚举帐户的策略

> ID：405230
> 
> 赞同：0
> 
> 时间：2009-01-01T18:01:21.877
> 
> 标签：active-directory

是否可以定义一个策略来限制用户仅枚举他自己的 OU 中的帐户？

例如，让我们考虑一个域 Contosos 和 OUs Sales 和 HR。Sales OU 有两个用户 A 和 B，HR OU 有用户 C 和 D。

是否可以定义一个策略，使 A 只能枚举帐户 A 和 B，而 C 只能枚举 C 和 D，而不是不在其 OU 中的帐户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T20:47:14.930

不要那样做！

但是，您可以为每个 OU 创建一个组，并将 ou 用户放入该组中。然后，您可以更改每个其他 OU 的权限以拒绝该组的“列出内容”权限。我认为没有脚本可以配置它。但由于规则很简单，因此可以编写脚本。

那就是说。我建议您不要在没有专门针对此特定主题的专家组的情况下更改活动目录默认权限。只需单击几下，您就可以很容易地使您的网络变得无用。即使您不这样做，对 Active Directory 安全性有期望的程序（甚至没有意识到这一点）也有可能会遭受细微的错误。

所以规则是。如果你不得不问，不要这样做。如果您需要成为专家，那么：

[http://www.google.com/search?hl=en&q=active+directory+permission+site:microsoft.com&btnG=Search](http://www.google.com/search?hl=en&q=active+directory+permission+site:microsoft.com&btnG=Search)

**更新：** “如果您需要询问”规则是指在这样的公共网站上询问。像我这样的非专家可以给你潜在的误导信息，就像我的一样（我希望不会，但是......）。我不确定您的要求没有简单的解决方案。但据我所知，这是一条烧毁了无数勇敢灵魂的道路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T05:36:00.490

好点子！我自己不知道该怎么做，但是 Igal Serban 的回答让我很感动。他是对的，在公共论坛上，如果您接受不成熟的建议，您将为此付出很多。我曾经因为这样的原因被咬过一次。

阅读一些书籍或咨询一些专家！

# c# - 此代码示例中的“{0:X2}”是什么意思？

> ID：405233
> 
> 赞同：22
> 
> 时间：2009-01-01T18:05:03.320
> 
> 标签：c#

在下面的代码示例中，是什么`{0:X2}`意思？这是来自 MCTS Application Development Foundation 书的反射部分（涵盖动态代码等）。

```
foreach(Byte b in body.GetILAsBodyArray())
{
Console.Write("{0:X2}", b);
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-01T18:09:03.470

这使用与 String.Format() 相同的格式。查看以下参考：

[http://msdn.microsoft.com/en-us/library/fht0f5be.aspx](http://msdn.microsoft.com/en-us/library/fht0f5be.aspx)

*   X = 十六进制格式
*   2 = 2 个字符

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-03-13T13:05:27.210

请注意，如果数字太大而无法适应长度，则不遵守指定的长度。

```
 long a = 123456789;
 Console.Write("{0:X2}", a);
 ->   75BCD15 
```

如果要显示所有高位都设置为 1 的负十六进制数，这一点尤其重要。

```
 long a = -1;
 Console.Write("{0:X2}", a);
 ->  FFFFFFFFFFFFFFFF 
```

# c - 在 Linux SCHED_FIFO 和 SCHED_RR

> ID：405246
> 
> 赞同：11
> 
> 时间：2009-01-01T18:14:26.983
> 
> 标签：c, linux, xen, scheduled-tasks

我正在编写一个非常小的守护进程，即使系统处于严重压力之下，它也必须保持响应。我正在研究 SCHED_FIFO 和 SCHED_RR 在调度方面的差异，并试图确定一个合理的优先级。

哪个调度程序适合小型但关键的监控守护进程，什么优先级是合理安全的？在试图理解两者之间的差异时，我仍然有点模糊。

我的程序分配在 3k 以下（并使用 mlockall()），它向 xenbus 写入大约 600 个字节然后休眠，但我无法确定实际写入数据需要多少时间（以毫秒为单位）......因为什么是写依赖于一个配置文件。

提前感谢您的任何建议/解释。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-01T19:33:53.610

这个臭名昭著的`pchdtvr`程序捕获数字电视信号，用于`SCHED_FIFO`确保无论如何将电视数据包写入磁盘。在旧电脑上玩《毁灭战士》时，它可以一次捕捉 4 个节目。

该程序臭名昭著，因为它是在 GPL 下发布的，而作者[试图追溯撤销 GPL](http://sourceforge.net/developer/diary.php?diary_id=26407&diary_user=147583)。这一行为引发了一场轻微的风暴。[无论如何，你可以在http://frequal.com/pmn/pchdtvr.html](http://frequal.com/pmn/pchdtvr.html)找到一个最新的版本来学习。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-02-23T00:58:59.640

SCHED_FIFO 不能被抢占（上下文切换到另一个进程），除非另一个更高优先级的进程出现在执行队列中。

SCHED_RR 可以被时间量（给进程执行的延迟）抢占。

它们都是基于 linux 的调度程序的“实时”优先级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T18:38:02.413

我不是调度方案的专家，但看看

```
man sched_setscheduler 
```

它详细说明了不同调度算法之间的区别，并提供了与其他调度功能的链接。SCHED_FIFO 实际上听起来很危险，但被描述为最激进的调度：

> SCHED_FIFO 进程一直运行直到它被 I/O 请求阻塞、被更高优先级的进程抢占或调用 sched_yield(2)。

注意不要锁定您的系统。我个人会做一些实证测试，看看什么优先级最适合以及它们的行为方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T14:21:42.433

如果您所有其他任务都使用标准调度程序，那没有什么区别；SCHED_FIFO 和 SCHED_RR 只影响这些任务的相互调度。

所以在一个正常的系统上没有什么区别。FIFO 是最容易理解的，所以我猜就使用它。

如果您有多个不同优先级的任务，如果它们都准备好运行，则只会运行较高的一个（并且只有一个 CPU 内核）

# email - 任何方式来同步桌面电子邮件和在线服务之间的“已发送”文件夹？

> ID：405247
> 
> 赞同：0
> 
> 时间：2009-01-01T18:16:44.937
> 
> 标签：email, email-client

我逐渐放弃了我的离线电子邮件并切换到在线电子邮件，但我仍然使用它定期收集我收到的电子邮件并将它们存档。有没有什么东西可以让我收集最初在线发送的邮件（除了系统地将它们抄送给自己），或者（甚至更好）“同步”两个电子邮件发送者的**发送**文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T18:42:55.397

如果您的在线提供商支持 IMAP，那将是可行的方法。

# asp.net - ASP.NET 本地开发设置

> ID：405255
> 
> 赞同：1
> 
> 时间：2009-01-01T18:20:54.693
> 
> 标签：asp.net, windows

我想在一个有趣的项目上开始学习 ASP.NET。我希望设置一个本地服务器来进行我的开发，但我不想用网络服务器、数据库和开发人员工具污染我的用户帐户。

我使用 Vista Home Premium 作为我的桌面操作系统。是否可以在 vista 中设置一个单独的用户并在其中包含所有开发人员的东西？（将 sql server、IIS 和 Visual Studio 分开，以便在我不进行开发工作时它们不会运行）

如果这不可能，有人可以提出一个好的选择吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-01T18:25:26.493

使用 VMWare 等虚拟机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T18:26:36.927

我个人认为为此创建单独的用户没有任何好处。有一个与 VS 捆绑在一起的 webdevserver 供开发使用。这仅在您启动时运行。除非您使用它，否则 VS 本身不会做任何事情......

SQL Server 可以设置为手动启动。

如果您刚刚开始，请查看 Visual web developer 和 sql server 的速成[版](http://www.microsoft.com/express/default.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T18:46:22.490

我同意 ocdecio：虚拟机是要走的路。还有一个好处是，您可以花几个小时来配置您的开发环境，然后*将*其完整保存。这样，如果您曾经使用它，您就不必再花一天时间来配置它。将其视为与您的源代码管理一起使用的“环境管理”。唯一需要注意的是确保您有足够的 RAM (2+ GB)。这些天 RAM 比时间便宜得多！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T18:32:45.823

我必须同意上述观点。

我在我的一个用户帐户上拥有所有开发内容（我也在使用 Vista Home Premium），但除非我也提出要求，否则什么都不会运行。

安装 Sql Server 时，应该会提示您是希望服务自动启动还是手动启动。选择手动并运行一个用户帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T18:55:16.073

@mdbritt 这个案例是asp.net 的一个开发学习环境。我几乎无法相信虚拟环境是首选。也不适用于任何其他正常的开发环境。

如果您想避免花费在重新安装和重新配置上的时间，为什么不直接创建硬盘驱动器的映像呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-02T01:37:46.230

I agree with ocdecio: a virtual machine is the way to go. For some things, you can even download fully functional VM's direct from MS (ie Sharepoint Development). The VM's can be a real timesaver and they're easy to backup in entirety.

# python - 一个类的许多实例

> ID：405282
> 
> 赞同：4
> 
> 时间：2009-01-01T18:47:32.987
> 
> 标签：python, class, object, multiple-instances

我正在尝试用各种动物在 python 中编写一个生活模拟。不可能命名我要使用的类的每个实例，因为我无法知道会有多少。

所以，我的问题：

如何自动为对象命名？

我正在考虑创建一个“牧群”类，它可以让所有这种类型的动物同时活着......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T18:52:03.210

嗯，你通常只是把所有这些实例都放在一个列表中，然后如果你想对它们做点什么，就遍历这个列表。如果您想自动跟踪创建的每个实例，您还可以在类的构造函数中隐式添加到列表中，或者创建一个工厂方法来跟踪创建的实例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T19:17:31.070

像这样？

```
class Animal( object ):
    pass # lots of details omitted

herd= [ Animal() for i in range(10000) ] 
```

此时，herd 将拥有`Animal`该类的 10,000 个不同的实例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-01T22:26:20.580

如果您需要一种方法来单独引用它们，那么让类在初始化时为每个实例提供一个唯一标识符是相对常见的：

```
>>> import itertools
>>> class Animal(object):
...     id_iter = itertools.count(1)
...     def __init__(self):
...             self.id = self.id_iter.next()
... 
>>> print(Animal().id)
1
>>> print(Animal().id)
2
>>> print(Animal().id)
3 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-01T18:53:15.953

您可以使用名称属性创建一个“动物”类。

或者

您可以像这样以编程方式定义类：

```
 from new import classobj
my_class=classobj('Foo',(object,),{}) 
```

发现这个： [http ://www.gamedev.net/community/forums/topic.asp?topic_id=445037](http://www.gamedev.net/community/forums/topic.asp?topic_id=445037)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T00:44:58.710

任何实例都可以有一个名称属性。所以听起来您可能会问如何动态命名一个*类*，而不是一个*实例*。如果是这种情况，您可以显式设置类的 __name__ 属性，或者更好地使用内置[类型](http://docs.python.org/library/functions.html#type)（使用 3 个参数）创建类。

```
class Ungulate(Mammal):
    hoofed = True 
```

相当于

```
cls = type('Ungulate', (Mammal,), {'hoofed': True}) 
```

# sql-server - SQL Server“AFTER INSERT”触发器看不到刚刚插入的行

> ID：405288
> 
> 赞同：45
> 
> 时间：2009-01-01T18:50:01.390
> 
> 标签：sql-server, sql-server-2005, triggers

考虑这个触发器：

```
ALTER TRIGGER myTrigger 
   ON someTable 
   AFTER INSERT
AS BEGIN
  DELETE FROM someTable
         WHERE ISNUMERIC(someField) = 1
END 
```

我有一个表 someTable，我试图阻止人们插入不良记录。就本问题而言，不良记录具有一个全为数字的字段“someField”。

当然，这样做的正确方法不是使用触发器，但我不控制源代码......只是 SQL 数据库。所以我不能真正阻止坏行的插入，但我可以马上删除它，这已经足够满足我的需要了。

触发器工作，有一个问题......当它触发时，它似乎永远不会删除刚刚插入的坏记录......它会删除任何旧的坏记录，但它不会删除刚刚插入的坏记录。所以经常有一个坏记录漂浮在周围，直到其他人出现并执行另一个 INSERT 时才会删除。

这是我对触发器的理解的问题吗？触发器运行时新插入的行是否尚未提交？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-01T18:52:50.340

触发器不能修改已更改的数据（`Inserted`或`Deleted`），否则您可能会在更改再次调用触发器时获得无限递归。一种选择是让触发器回滚事务。

**编辑：**这样做的原因是 SQL 的标准是触发器不能修改插入和删除的行。根本原因是修改可能导致无限递归。在一般情况下，此评估可能涉及相互递归级联中的多个触发器。让系统智能地决定是否允许这样的更新在计算上是难以处理的，本质上是[停机问题的一种变体。](http://en.wikipedia.org/wiki/Halting_problem)

对此的公认解决方案是不允许触发器更改更改的数据，尽管它可以回滚事务。

```
create table Foo (
       FooID int
      ,SomeField varchar (10)
)
go

create trigger FooInsert
    on Foo after insert as
    begin
        delete inserted
         where isnumeric (SomeField) = 1
    end
go

Msg 286, Level 16, State 1, Procedure FooInsert, Line 5
The logical tables INSERTED and DELETED cannot be updated. 
```

这样的事情会回滚交易。

```
create table Foo (
       FooID int
      ,SomeField varchar (10)
)
go

create trigger FooInsert
    on Foo for insert as
    if exists (
       select 1
         from inserted 
        where isnumeric (SomeField) = 1) begin
              rollback transaction
    end
go

insert Foo values (1, '1')

Msg 3609, Level 16, State 1, Line 1
The transaction ended in the trigger. The batch has been aborted. 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-01T20:04:32.020

你可以颠倒逻辑。与其在插入无效行后删除它，不如编写一个`INSTEAD OF`触发器以*仅*在您验证该行有效时才插入。

```
CREATE TRIGGER mytrigger ON sometable
INSTEAD OF INSERT
AS BEGIN
  DECLARE @isnum TINYINT;

  SELECT @isnum = ISNUMERIC(somefield) FROM inserted;

  IF (@isnum = 1)
    INSERT INTO sometable SELECT * FROM inserted;
  ELSE
    RAISERROR('somefield must be numeric', 16, 1)
      WITH SETERROR;
END 
```

如果您的应用程序不想处理错误（正如 Joel 所说，他的应用程序就是这种情况），那么不要`RAISERROR`. 只需让触发器静默*不*执行无效插入即可。

我在 SQL Server Express 2005 上运行了它，它可以工作。请注意，如果您插入到定义触发器的同一个表中，`INSTEAD OF`触发器*不会导致递归。*

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-22T14:20:51.970

这是我修改后的比尔代码：

```
CREATE TRIGGER mytrigger ON sometable
INSTEAD OF INSERT
AS BEGIN
  INSERT INTO sometable SELECT * FROM inserted WHERE ISNUMERIC(somefield) = 1 FROM inserted;
  INSERT INTO sometableRejects SELECT * FROM inserted WHERE ISNUMERIC(somefield) = 0 FROM inserted;
END 
```

这使插入始终成功，并且任何虚假记录都会被扔到您的 sometableRejects 中，您可以稍后在其中处理它们。重要的是让您的拒绝表对所有内容都使用 nvarchar 字段 - 而不是 ints、tinyints 等 - 因为如果它们被拒绝，那是因为数据不是您所期望的。

这也解决了多记录插入问题，会导致Bill的触发器失败。如果您同时插入 10 条记录（就像您执行 select-insert-into 一样）并且其中只有一条是伪造的，那么 Bill 的触发器会将它们全部标记为错误。这可以处理任意数量的好记录和坏记录。

我在一个数据仓库项目中使用了这个技巧，其中插入的应用程序不知道业务逻辑是否有任何好处，而是我们在触发器中执行业务逻辑。对性能来说真的很讨厌，但如果你不能让插入失败，它确实有效。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-01T18:57:46.897

我认为您可以使用 CHECK 约束——这正是它的发明目的。

```
ALTER TABLE someTable 
ADD CONSTRAINT someField_check CHECK (ISNUMERIC(someField) = 1) ; 
```

我之前的回答（也可能有点矫枉过正）：

我认为正确的方法是使用 INSTEAD OF 触发器来防止插入错误的数据（而不是事后删除）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-24T06:08:53.117

更新：从触发器中删除适用于 MSSql 7 和 MSSql 2008。

我不是关系专家，也不是 SQL 标准专家。然而 - 与公认的答案相反 - MSSQL 处理[递归和嵌套触发器评估](http://msdn.microsoft.com/en-us/library/aa258254(SQL.80).aspx)都很好。我不知道其他 RDBMS。

相关选项是['recursive triggers' 和 'nested triggers'](http://www.devx.com/tips/Tip/30031)。嵌套触发器限制为 32 级，默认为 1。递归触发器默认是关闭的，并且没有谈论限制 - 但坦率地说，我从来没有打开它们，所以我不知道不可避免的会发生什么堆栈溢出。我怀疑 MSSQL 只会杀死你的 spid（或者有递归限制）。

当然，这只是表明接受的答案有错误的*原因*，而不是不正确。但是，在 INSTEAD OF 触发器之前，我记得编写 ON INSERT 触发器可以愉快地更新刚刚插入的行。这一切都很好，正如预期的那样。

删除刚刚插入的行的快速测试也有效：

```
 CREATE TABLE Test ( Id int IDENTITY(1,1), Column1 varchar(10) )
 GO

 CREATE TRIGGER trTest ON Test 
 FOR INSERT 
 AS
    SET NOCOUNT ON
    DELETE FROM Test WHERE Column1 = 'ABCDEF'
 GO

 INSERT INTO Test (Column1) VALUES ('ABCDEF')
 --SCOPE_IDENTITY() should be the same, but doesn't exist in SQL 7
 PRINT @@IDENTITY --Will print 1\. Run it again, and it'll print 2, 3, etc.
 GO

 SELECT * FROM Test --No rows
 GO 
```

你这里有其他事情发生。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-01T19:17:31.177

从[CREATE TRIGGER](http://msdn.microsoft.com/en-us/library/aa258254.aspx)文档中：

> **删除**和**插入**是逻辑（概念）表。它们在结构上类似于定义触发器的表，即尝试用户操作的表，并保存用户操作可能更改的行的旧值或新值。例如，要检索已删除表中的所有值，请使用：`SELECT * FROM deleted`

因此，这至少为您提供了一种查看新数据的方法。

我在文档中看不到任何内容，它指定您在查询普通表时不会看到插入的数据......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-01T19:08:47.997

我找到了这个参考：

```
create trigger myTrigger
on SomeTable
for insert 
as 
if (select count(*) 
    from SomeTable, inserted 
    where IsNumeric(SomeField) = 1) <> 0
/* Cancel the insert and print a message.*/
  begin
    rollback transaction 
    print "You can't do that!"  
  end  
/* Otherwise, allow it. */
else
  print "Added successfully." 
```

我没有测试过它，但从逻辑上讲，它看起来应该 dp 你所追求的......而不是删除插入的数据，完全阻止插入，因此不需要你必须撤消插入。它应该表现得更好，因此最终应该更轻松地处理更高的负载。

编辑：当然，如果插入发生在其他有效事务中，*则*整个事务可能会回滚，因此您需要考虑这种情况并确定插入无效数据行是否构成完全无效的交易...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-01T19:20:52.497

上面概述的技术很好地描述了您的选择。但是用户看到了什么？我无法想象你和负责该软件的人之间的这种基本冲突怎么会导致与用户的混淆和对抗。

我会尽我所能找到摆脱僵局的其他方法——因为其他人很容易看到你所做的任何改变都会使问题升级。

编辑：

我将获得我的第一个“取消删除”并承认在这个问题首次出现时发布上述内容。当我看到它来自 JOEL SPOLSKY 时，我当然退缩了。但看起来它降落在附近的某个地方。不需要投票，但我会记录在案的。

IME，触发器很少是除了业务规则领域之外的细粒度完整性约束之外的正确答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T16:57:58.467

是否有可能 INSERT 是有效的，但是之后执行的单独的 UPDATE 是无效的但不会触发触发器？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T02:36:13.073

MS-SQL 具有防止递归触发器触发的设置。这通过 sp_configure 存储过程进行配置，您可以在其中打开或关闭递归或嵌套触发器。

在这种情况下，如果您关闭递归触发器以通过主键链接插入表中的记录，并对该记录进行更改，这是可能的。

在问题的特定情况下，这并不是真正的问题，因为结果是删除记录，这不会重新触发此特定触发器，但通常这可能是一种有效的方法。我们以这种方式实现了乐观并发。

可以以这种方式使用的触发器的代码是：

```
ALTER TRIGGER myTrigger
    ON someTable
    AFTER INSERT
AS BEGIN
DELETE FROM someTable
    INNER JOIN inserted on inserted.primarykey = someTable.primarykey
    WHERE ISNUMERIC(inserted.someField) = 1
END 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-04T13:49:41.903

你的“触发器”正在做一些“触发器”不应该做的事情。您可以简单地让您的 Sql Server 代理运行

```
DELETE FROM someTable
WHERE ISNUMERIC(someField) = 1 
```

每1秒左右。当你这样做的时候，写一个漂亮的小 SP 来阻止编程人员将错误插入你的表中怎么样。SP 的一件好事是参数是类型安全的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-03T23:19:26.470

我偶然发现了这个问题，以寻找有关插入语句和触发器期间事件序列的详细信息。我最终编写了一些简短的测试来确认 SQL 2016 (EXPRESS) 的行为方式 - 并认为分享它是合适的，因为它可能有助于其他人搜索类似的信息。

根据我的测试，可以从“插入”表中选择数据并使用它来更新插入的数据本身。而且，我感兴趣的是，插入的数据对其他查询不可见，直到触发器完成，此时最终结果可见（至少我可以测试最好）。我没有针对递归触发器等进行测试（我希望嵌套触发器对表中插入的数据具有完全可见性，但这只是一个猜测）。

例如 - 假设我们有一个带有整数字段“field”和主键字段“pk”的表“table”以及我们的插入触发器中的以下代码：

```
select @value=field,@pk=pk from inserted
update table set field=@value+1 where pk=@pk
waitfor delay '00:00:15' 
```

我们为“字段”插入一个值为 1 的行，然后该行将以值 2 结束。此外 - 如果我在 SSMS 中打开另一个窗口并尝试： select * from table where pk = @pk

其中@pk 是我最初插入的主键，查询将是空的，直到 15 秒过期，然后将显示更新的值（字段 = 2）。

我对触发器执行时其他查询可见哪些数据感兴趣（显然没有新数据）。我还测试了添加的删除：

```
select @value=field,@pk=pk from inserted
update table set field=@value+1 where pk=@pk
delete from table where pk=@pk
waitfor delay '00:00:15' 
```

同样，插入需要 15 秒才能执行。在不同会话中执行的查询显示没有新数据 - 在执行插入 + 触发器期间或之后（尽管我希望任何身份都会增加，即使似乎没有插入数据）。

# apache-flex - 以 PDF 格式创建交互式报告

> ID：405311
> 
> 赞同：0
> 
> 时间：2009-01-01T19:02:37.713
> 
> 标签：apache-flex, flash, pdf, air, alivepdf

我想创建读者可以深入研究的报告 - 但报告必须是 PDF 格式。我有两个选择：

1.  从 PDF 链接到在线报告工具
2.  使报告本身具有交互性

我喜欢#2...

我相信我可以使用 Adob​​e AIR（Flex、Flash + Adob​​e Reader 9 或更高版本）做到这一点。

有一些工具可以以编程方式创建 PDF 文档（AIR?、AlivePDF）

Adboe 中有一些框架非常适合报告和图表 (Flex)

PDF 文档可以包含 Flash 内容（Adobe Reader 9+）

我的问题是：

1.  如果我在 PDF 文档中有一个交互式 Flash 组件并且我要打印，会打印什么？他现在对Flash打印的看法？

2.  如果我想深入研究，所有数据都必须在 PDF 文档中（它必须是独立的）。这很好......但是如何以编程方式将数据放入 PDF 中？这是用 Flex 和 AlivePDF 完成的吗？

3.  我在 PDF 文档中看到了交互式图表报告的在线示例，但现在我找不到了。:( 如果你知道的话，我很想再找到一些东西。

我觉得我可能拥有所有的部分，但没有正确理解它们是如何组合在一起的。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-03T12:21:53.673

*对问题 3 的回答：*目前 AlivePDF 不允许您将 Flash 内容嵌入到生成的 PDF 中。生成的 PDF 可以包括文本、图像、简单图形和某些非视觉特征，例如书签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:37:33.260

PDF 现在将 JavaScript 作为本机控制语言。有了它，您可以嵌入跳转到其他页面的“链接”等。

从理论上讲，您可以使用 JS 从 PDF 中调用 Web 服务并处理响应，甚至可以动态填充页面区域。

但

PDF 非常适合提供在任何地方看起来和打印都相同的文档。它们也适用于填写表格。它们不是为客户端的“向下钻取”而构建的。你能检查一下项目的目标，看看他们为什么想要动态 PDF 吗？如果他们想要可移植性（即没有 Web 连接），也许您可​​以使用 AIR 应用程序和 XML 文件来满足他们的需求。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T02:50:00.533

我们使用 flex 作为前端为 PDF/flashpaper/etc开发了交互式**内容报告，但使用 Coldfusion 的 cfdocument/cfpdf（或 Itext，如果我们真的需要疯狂级别的放置/控制/等）来处理实际的报告创建服务器端。**基本上，用户选择内容，后端的 cf 应用程序将其布局并发回报告。

# javascript - 如何让 jQuery 只修改一个 div，而不是同一类的所有 div？

> ID：405320
> 
> 赞同：2
> 
> 时间：2009-01-01T19:08:15.003
> 
> 标签：javascript, jquery

我网站的每个页面都有 10 个（几乎）相同的 div，仅在文本中有所不同。单击 div 的某个部分时，我希望修改该 div 的不同部分。

我正在使用这段代码：

```
$(document).ready(function(){
 $(".notLogged img").mouseover(function(){
  $(this).parent()>$("span").html("You must be logged in to vote.");
 })
}) 
```

我认为这将按如下方式工作：对于`img`“notLogged”分类 div 中的所有元素，鼠标悬停会导致该 div 的不同部分发生变化。

然而，事实并非如此。每当触发鼠标悬停事件时，*所有*具有“notLogged”类的 div 都会被修改。

**如何修改此代码，以便仅修改鼠标悬停所在的 div？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T19:16:03.070

试试这样：

```
$(document).ready(function(){
 $(".notLogged img").mouseover(function(){
  $(this).parent().find("span").html("You must be logged in to vote.");
 });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T19:38:33.710

```
// Assuming the 1st span in the div is the one to be modified.
$(this).parent().$('span:eq(1)').html("You must be logged in to vote.");
// :eq(1) selects the first element that matches its selector.  You could
// also use ':first' in this case. 
```

# java - 我应该对从超类继承的方法进行单元测试吗？

> ID：405333
> 
> 赞同：8
> 
> 时间：2009-01-01T19:17:32.393
> 
> 标签：java, unit-testing, tdd, junit

我目前正在以 TDD 方式编写 JDBC 驱动程序的实现（*是的，你没看错*），虽然此时我只完成了类存根并且只有一些次要功能，但我突然想到，因为`Statement`它是一个超类对于`PreparedStatement`which 是 的超类`CallableStatement`，当我真正开始为这些类的实现编写测试时，我应该怎么做，我应该做其中的哪一个：

1.  创建一个测试套件`Statement`，然后扩展该套件以进行其他测试`PreparedStatement`，然后对`CallableStatement`.
2.  单独测试每个实现，忽略从超类继承的方法。
3.  为每个实现类单独严格测试每个方法；毕竟，某些继承的方法可能会因实现而有所不同。这一点的轻微变化是我会测试实现使用的所有那些继承的方法。

第二个感觉最自然，但由于我放在第三个的原因，我不确定这样做是否明智。所以，**你**觉得我应该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-01T19:38:42.103

“为每个实现类单独测试每个方法”

特别是，未能正确覆盖超类方法是一个常见的错误。子类的作者对超类做出假设。超类发生了变化，而子类现在被破坏了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-01T19:24:59.447

如果这意味着您将为每个测试子类重复运行相同的测试，我将永远不会做替代 1（让测试类层次结构与实际的类层次结构相同）。除了通用实用程序基类之外，我通常也对子类化测试类持怀疑态度。

我通常对层次结构中的每个类进行 1 次测试，无论是否抽象。所以基类有一个单独的测试（通常带有一个用于专门测试它的本地测试私有子类），我利用我对子类的了解为每个子类编写适当的测试。我可以在覆盖运行中看到缺少的测试，所以我通常不会提前正式化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-01T19:21:15.087

根据您对实现的了解，提供足够的测试让您感觉舒适。我不将单元测试视为完全的黑盒测试。如果您知道基类从不调用任何虚拟方法（或至少没有被覆盖），那么请注意这一事实，但不要有效地复制您已经获得的单元测试。

单元测试当然可以走极端——平衡你从中获得的价值和付出的努力总是值得的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T19:35:28.350

使用 TDD，您不应该针对测试方法，而是针对代码的行为或功能。因此，在实现子类时，您可以限制只测试与基类不同的行为。如有疑问，请编写一个新测试。

# java - 为什么从非静态方法访问静态方法不好？

> ID：405336
> 
> 赞同：4
> 
> 时间：2009-01-01T19:20:14.900
> 
> 标签：java, oop, static, methods

Netbeans 告诉我从非静态方法访问静态方法很糟糕。为什么这很糟糕？“访问静态方法 getInstance”是警告：

```
import java.util.Calendar;

public class Clock
{
    // Instance fields
    private Calendar time;

    /**
     * Constructor. Starts the clock at the current operating system time
     */
    public Clock()
    {
        System.out.println(getSystemTime());
    }

    private String getSystemTime()
    {
        return this.time.getInstance().get(Calendar.HOUR)+":"+
                this.time.getInstance().get(Calendar.MINUTE);
   } 
```

}

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-01T19:43:23.683

您可能是从实例而不是直接访问静态方法。尝试`Calendar.getInstance()`改用：

```
private String getSystemTime()
{
    return Calendar.getInstance().get(Calendar.HOUR)+":"+
           Calendar.getInstance().get(Calendar.MINUTE);
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-01T19:28:57.147

“返回静态方法”是什么意思？在我看来，从实例方法调用静态方法很好 - 当然取决于具体情况。您能否发布一些 Netbeans 抱怨的代码？

*我可以想象*的一件事是，如果您只使用实例方法中的静态方法，而不使用实例的任何数据。有时这是实现接口或覆盖基类中的方法所需要的，但如果你没有覆盖任何东西并且你没有使用任何实例变量，那么最好将方法设为静态以表明它确实没有取决于特定的实例。

编辑：对于已编辑的问题，这很有意义。IMO 这是Java中的一个缺陷，它首先允许它。它可能会产生非常具有误导性的代码。我最喜欢的例子（这意味着老前辈很可能已经看到我之前发布过它：）是 with `Thread.sleep`. 这段代码*看起来*像什么？

```
Thread t = new Thread(someRunnable);
t.start();
t.sleep(1000); 
```

在我看来，新线程似乎被要求休眠——类似于调用`suspend`. 但是不行——你只能让当前正在执行的线程休眠，这就是为什么`Thread.sleep`是静态方法。上面的代码是合法的 Java，并且会在新创建的线程（可能）运行时使当前正在执行的线程休眠一秒钟......根本不是代码乍一看的样子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T19:29:04.290

你的顺序是不是颠倒了？如果是这样，那么您不能从静态方法访问非静态方法是有道理的。如果没有，我也想知道为什么这很糟糕！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T19:43:37.320

不能从静态上下文中引用非静态方法。静态方法可以从非静态上下文中引用。

是 Netbeans 错误还是警告？您可以发布导致它的代码吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T20:51:23.750

打电话就好了`time.getInstance()`。在这种情况下，编译器将查看变量的类型`Calendar`，并在那里调用方法。它最终被编译为`Calendar.getInstance()`. 请注意， 的实际值`time`对此没有贡献，即它甚至可以是`null`，但没关系。

正是这种间接性和与常规方法的区别令人不悦。最好直接表示为`Calendar.getInstance()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-16T07:58:11.943

为什么不简单解释：

如果您调用非静态方法，1）您使用 a=new Class(); 创建新实例 2）然后调用方法a.method；

如果您调用静态方法： 1）您将其称为 Class.method；

您可以使用静态方法来完成它，因为它在其类中是独立的并且具有调用所需的一切。如果它依赖于其他一些信息（作为构造函数），您不将其声明为静态，它将失败。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-07-29T05:20:29.257

在java中，所有的静态成员变量都会先被加载到内存中，然后所有的静态成员会被加载，然后非静态变量和成员函数会被加载到内存中，然后会执行静态主块...... . 所以它给出了一个非.......

# php - 如何编写在正文中有锚标记的 Zend 框架 URL？

> ID：405338
> 
> 赞同：11
> 
> 时间：2009-01-01T19:20:57.647
> 
> 标签：php, zend-framework, zend-framework-mvc

使用 Zend Framework 中设置的标准 MVC，我希望能够显示始终具有锚点的页面。现在，我只是在 .phtml 文件中添加了一个我想要的带有“#anchor”的无意义参数。

```
<?= $this->url(array(
    'controller'=>'my.controller',
    'action'=>'my.action',
    'anchor'=>'#myanchor'
)); 
```

这会将 URL 设置为类似于 /my.controller/my.action/anchor/#myanchor

有没有更好的方法来实现这一点？导航到锚链接后，额外的 item 参数在用户的 URL 中设置，这是我不希望发生的事情。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-02T12:55:26.260

一种可能性是覆盖 url helper，或创建一个新的。

```
class My_View_Helper_Url extends Zend_View_Helper_Url
{    
    public function url(array $urlOptions = array(), $name = null, $reset = false, $encode = true)
    {
        if (isset($urlOptions['anchor']) && !empty($urlOptions['anchor']))
        {
            $anchor = $urlOptions['anchor'];
            unset($urlOptions['anchor']);
        }
        else
        {
            $anchor = '';
        }

        return parent::url($urlOptions, $name, $reset, $encode).$anchor;
    }
} 
```

这个助手覆盖了 url 助手，问题是，你不能使用名为“anchor”的参数，因为它会在 url 中变成锚。

你会在你的例子中调用它

```
<?= $this->url(array(
    'controller'=>'my.controller',
    'action'=>'my.action',
    'anchor'=>'#myanchor'
)); 
```

我希望它有帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-24T02:41:59.133

您可以通过多种方式在 URL 中实现[片段 ID 。](http://www.w3.org/TR/REC-html40/intro/intro.html#fragment-uri)以下是一些选项，以及每个选项的优缺点。

## 直接添加

您可以在通话`"#$fragment_id"`后简单地添加。`url()`不优雅，但简单。如果您不经常使用页面锚点（即仅一页或两页），那么这是可行的方法。

## 编写自定义`url()`助手

您可以编写自定义版本，`url()`为片段 ID 附加可选的第 5 个参数：

```
class My_View_Helper_Url extends Zend_View_Helper_Url
{    
    public function url(array $urlOptions  = array(), $name   = null, 
                              $reset       = false,   $encode = true, 
                              $fragment_id = null)
    {
        $uri = parent::url($urlOptions, $name, $reset, $encode);

        if(!is_null($fragment_id)) {
            $uri .= "#$fragment_id";
        }

        return $uri;
    }
} 
```

这样，锚（和锚/片段ID）信息严格保持在视图的范围内。这对于一般用途很有用，但对于默认路由可能会有点笨拙。此外，对于某些用途，这仍然有点过于硬编码。

## 编写自定义`Route`类（Extreme）

作为第三种选择，您可以编写`Zend_Controller_Router_Route`类的自定义版本，特别是`assemble($data, $reset, $encode)`方法（该`match($path)`方法默认忽略片段 ID）。

使用此方法可能非常棘手，但非常有用，特别是如果使用仅限于特定路由（此方法可用于基于任何变量的片段 id）。

## 警告

使用片段 ID 时*必须*考虑某些注意事项。例如，查询字符串必须在 uri 中的片段 id 之前，否则 PHP 会忽略查询字符串。但是，大多数 ZF 应用程序倾向于避免使用查询字符串，因此这可能不是问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-30T15:34:17.830

url 视图助手接受第三个选项的“片段”键：

```
url('[route]',array([params]),array('fragment'=>'anchor')); 
```

这将自动以#anchor 结束网址。

- 感谢 Exlord

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:16:42.567

我认为编写自定义路由类的 Extreme 方法更好，因为其他助手将具有相同的行为（如重定向器操作助手）。

# python - Mysql连接池问题：值得吗？

> ID：405352
> 
> 赞同：15
> 
> 时间：2009-01-01T19:32:29.183
> 
> 标签：python, mysql, sqlalchemy, connection-pooling

我记得听说 mysql 中的连接过程与其他 RDBMS 相比设计得非常快，因此如果启用连接池，使用[提供连接池 (SQLAlchemy) 的库实际上对您没有太大帮助。](http://www.sqlalchemy.org/)

有人对这个有经验么？

我对启用它持怀疑态度，因为如果某些代码对数据库连接执行有状态的操作并且（可能是错误地）没有自行清理，那么通常会在关闭连接时清理的状态将改为传播到获得回收连接的后续代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-02T02:41:50.470

使用 SQLA 的连接池时，无需担心连接上的残留状态，除非您的应用程序正在更改连接范围的选项，如事务隔离级别（通常不是这种情况）。SQLA 的连接池在重新签入时在连接上发出 connection.rollback() ，以便清除任何事务状态或锁定。

MySQL 的连接时间可能非常快，尤其是当您在同一台机器上通过 unix 套接字进行连接时。如果您确实使用连接池，您还需要确保在一段时间后回收连接，因为 MySQL 的客户端库会自动关闭空闲超过 8 小时的连接（在 SQLAlchemy 中，这是 pool_recycle 选项）。

您可以通过将池实现从默认的 QueuePool 更改为 NullPool 来快速对 SQLA 应用程序进行一些连接池与非连接池的比较，这是一个实际上不池化任何东西的池实现 - 当代理连接被获取并稍后关闭。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-01T19:37:35.787

即使 MySQL 本身的连接部分非常流畅，大概仍然涉及到网络连接（无论是环回还是物理连接）。如果您提出*很多*请求，那可能会变得非常昂贵。当然，这将取决于（通常情况下）您的应用程序究竟做了什么——如果您在每个连接上做了很多工作，那么它将占主导地位并且您不会获得很多。

如有疑问，基准测试 - 但我基本上相信连接池库（至少，一个有信誉的库）应该正常工作并适当地重置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T00:10:55.863

简短的回答：您需要对其进行基准测试。

长答案：这取决于。MySQL 的连接设置速度很快，因此避免这种成本并不是使用连接池的好理由。如果查询运行的速度很少且速度很快，那么您会在哪里获胜，因为这样您就会看到池化的胜利。

另一个担心是应用程序如何处理 SQL 线程。如果它不执行 SQL 事务，并且不对线程的状态做任何假设，那么池化就不会成为问题。OTOH，依赖线程关闭来丢弃临时表或回滚事务的代码将在池化方面存在很多问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T20:02:42.227

连接池加快了速度，因为您不必在每次执行数据库查询时都创建 java.sql.Connection 对象。我将 Tomcat 连接池连接到 mysql 数据库，用于执行大量查询的 Web 应用程序，在高用户负载期间，速度显着提高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-20T19:00:38.187

我使用 Django 制作了一个简单的 RESTful 服务，并在使用和不使用连接池的情况下对其进行了测试。就我而言，差异非常明显。

在没有它的 LAN 中，响应时间在 1 到 5 秒之间。有了它，不到 20 毫秒。结果可能会有所不同，但我用于 MySQL 和 Apache 服务器的配置是相当标准的低端配置。

如果您通过 Internet 提供 UI 页面，用户可能不会注意到额外的时间，但在我的情况下这是不可接受的，所以我选择使用池。希望这对您有所帮助。

# database - 我应该检查代码中的 DB 约束还是应该捕获 DB 抛出的异常

> ID：405359
> 
> 赞同：19
> 
> 时间：2009-01-01T19:38:10.403
> 
> 标签：database, nhibernate, exception-handling, constraints, unique

我有一个将数据保存到名为 Jobs 的表中的应用程序。Jobs 表有一个名为 Name 的列，它有一个 UNIQUE 约束。Name 列不是 PRIMARY KEY。我想知道在尝试保存/更新新条目之前是否应该自己检查重复条目，或者是否最好等待数据访问层抛出异常。如果它很重要，我正在为这个应用程序使用 NHibernate

* * *

感谢大家的大力投入。

我找到了另一个原因，为什么我应该在代码中进行验证，而不仅仅是等待抛出异常（并被我的代码捕获）。似乎 NHibernate 只会抛出一个 NHibernate.Exceptions.GenericADOException ，这对于这种情况下异常的原因并不是很丰富。还是我在这里错过了 NHibernate 的一个方面？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-01T19:49:48.087

答案是：两者都有。

如果您的数据库有约束，它可以保证数据的某些不变量，例如唯一性。这在几个方面有帮助：

*   如果您的应用程序中有错误，违反约束将标记一些可能不会被注意到的内容。

*   当 DBMS 强制执行不变量时，数据库的其他用户可以更多地假设数据的行为。

*   数据库保护自己免受违反约束的不正确更新。如果您发现您有一些其他系统或接口在跟踪数据库中填充数据库，那么数据库强制执行的约束意味着任何被约束捕获的东西都不会（或至少不太可能）破坏您的系统。

应用程序和数据库在任何情况下都存在 M:M 关系，但最微不足道的情况除外。应用程序仍应具有适当的数据和业务规则验证，但您仍不应计划将您的应用程序作为数据的唯一客户。在数据仓库工作几年，你会看到有这种心态的人设计的应用程序的效果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-01T22:59:22.213

如果您的设计是好的（数据库和 BL），那么数据库不应该有任何在 BL 中不会处理的约束——也就是说，您不应该向数据库提供不一致的数据。但没有什么是完美的。

我发现将数据库限制为数据一致性约束可以让我处理程序代码中的所有 BL 验证，并且我遇到数据库异常的唯一情况是可以（并且应该）修复的设计和编码错误。

在您的情况下，检查名称的唯一性是数据内容验证，在代码中正确处理。这可能会捕获最接近委托点的错误，希望您可以在其中调用更友好的 UI 资源，而不会在抽象之间引入不良耦合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T19:55:10.807

我会把这项工作完全留给数据库；您的代码应该专注于捕获和正确处理异常。

**原因：**

1.  **性能**- 数据库将高度优化，以快速有效的方式实施约束。您也没有时间优化代码。
2.  **可维护性**- 如果将来约束发生变化，您不必修改代码，或者您可能只需要添加一个新的 catch{}。如果删除了约束，您将根本不必接触您的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-01T19:53:29.857

如果您要自己检查约束，请在数据访问层中进行。该层之上的任何内容都不应该了解您的数据库或其约束。

在大多数情况下，我会说让 DAL 来捕获源自 DB 的异常。但在您的具体情况下，我认为我们正在谈论基本的输入验证。在提交整个表单之前，我会选择对数据库进行名称可用性检查调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-01T19:54:35.097

您绝对应该检查数据访问层抛出的任何异常。检查是否存在具有相同值的记录的问题在于，它要求您锁定表以进行修改，直到您插入新记录以防止竞争条件。

通常建议检查异常/错误，即使您以前自己检查过所有内容。几乎总是有一些事情可能出错，或者您在代码中没有考虑到但由数据库强制执行。

**编辑：**如果我理解正确的问题，这不是关于约束是否应该由数据库强制执行，而是如何在应用程序代码中处理它。当然，您应该**始终**在数据库中设置所有约束，以防止不良数据进入您的数据库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-15T15:06:47.023

您需要回答的问题是：

“我是否需要向用户展示好消息”。示例：已经有一个名为 TestJob1 的作业。如果答案是**否定**的，只需捕获错误并显示一条常见消息如果答案是**肯定**的，请继续阅读

如果您**在插入后发现错误，**则没有足够的信息来呈现正确的消息（至少以不可知的数据库方式）

另一方面，可能存在**竞争条件**，您可以同时进行事务尝试插入相同的数据，因此您需要**DB 约束**

一种行之有效的方法是：

*   检查之前提出一个很好的消息
*   捕获异常并显示一个常见的错误消息（假设这不会经常发生）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-01T19:52:47.707

就我个人而言，我会发现异常。它更简单，需要更少的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T15:49:43.167

GenericADOException 的内部异常会告诉您数据库操作失败的原因。您可以捕获 OracleException / MSSQLException / [InsertCustomExceptionHere] 并处理来自该消息的错误。如果您想将此返回到前端（假设用户是输入重复数据的用户），您可能希望首先将其包装在自定义异常中，这样您就不会将前端耦合到数据库。您真的不想传递 RDBMS 特定的异常。

我不同意在插入之前检查数据库的唯一性，两次往返数据库效率不高，如果您有大量用户流量，当然也无法扩展。

# java - java中的静态内存是怎么回事？

> ID：405364
> 
> 赞同：19
> 
> 时间：2009-01-01T19:40:58.090
> 
> 标签：java, memory-management, static

这个问题尤其适用于 java 语言。我知道为所有静态代码预留了一个静态内存部分。

我的问题是这个静态内存是如何填充的？静态对象是在导入时还是在第一次引用时放入静态内存中的？此外，对于静态对象是否适用与所有其他对象相同的垃圾收集规则？

```
 public class Example{
    public static SomeObject someO = new SomeObject();
}
/********************************/
// Is the static object put into static memory at this point?
import somepackage.Example;

public class MainApp{
    public static void main( Sting args[] ){
// Or is the static object put into memory at first reference?
       Example.someO.someMethod();
// Do the same garbage collection rules apply to a 
//     static object as they do all others?
       Example.someO = null;
       System.gc();
    }
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-01T20:04:24.657

导入与编译代码中的任何指令无关。他们建立别名仅在编译时使用。

有一些反射方法允许类被加载但尚未初始化，但在大多数情况下，您可以假设每当一个类被引用时，它已经被初始化。

静态成员初始化器和静态块的执行就像它们在源代码顺序中都是一个静态初始化器块一样。

通过静态成员变量引用的对象被强引用，直到类被卸载。一个普通的`ClassLoader`永远不会卸载一个类，但应用服务器使用的那些在正确的条件下会这样做。然而，这是一个棘手的领域，并且是许多难以诊断的内存泄漏的根源——这也是不使用全局变量的另一个原因。

* * *

作为（切线）奖励，这是一个需要考虑的棘手问题：

```
public class Foo {
  private static Foo instance = new Foo();
  private static final int DELTA = 6;
  private static int BASE = 7;
  private int x;
  private Foo() {
    x = BASE + DELTA;
  }
  public static void main(String... argv) {
    System.out.println(Foo.instance.x);
  }
} 
```

这段代码会打印什么？试试看，你会看到它打印出“6”。这里有几件事在起作用，其中之一是静态初始化的顺序。代码的执行就像是这样写的：

```
public class Foo {
  private static Foo instance;
  private static final int DELTA = 6;
  private static int BASE;
  static {
    instance = null;
    BASE = 0;
    instance = new Foo(); /* BASE is 0 when instance.x is computed. */
    BASE = 7;
  }
  private int x;
  private Foo() {
    x = BASE + 6; /* "6" is inlined, because it's a constant. */
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T19:50:46.027

通常没有“静态”内存之类的东西。大多数虚拟机都有永久生成的堆（加载类的地方），通常不会被垃圾收集。

静态对象的分配与任何其他对象一样。但是，如果它们存活很长时间，它们将在垃圾收集器中的不同代之间移动。但它们不会最终进入永久空间。

如果你的类永久持有这个对象，它只会在 vm 退出时被释放。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T19:50:53.530

一旦在代码中引用了您的类，这个静态变量**some0 就会被初始化。**在您的示例中，这将在您的 main 方法的第一行中执行。

您可以通过创建静态初始化程序块来验证这一点。在此初始化程序块中放置一个断点，您将看到何时调用它。或者更简单...在 SomeObject 的构造函数中放置一个断点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-01T20:01:37.423

静态变量的初始化在 suns JVM 规范的第[2.11 节 Static Initializers中介绍。](http://java.sun.com/docs/books/jvms/second_edition/html/Concepts.doc.html#32316)该规范没有定义垃圾收集的实现，但是我想静态对象的垃圾收集规则会因您的虚拟机而异。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-02T00:16:59.810

应该注意的是，只有指针（或任何其他原始类型）存储在 [PermGenSpace](http://blogs.oracle.com/fkieviet/entry/classloader_leaks_the_dreaded_java)中（这是存储静态内容的区域的正确名称）。

因此，指针引用的对象与任何其他对象一样位于普通堆中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-02T04:13:26.917

如果更改静态字段以引用不同的对象，则静态字段指向的原始对象与任何其他对象一样有资格进行 GC。

如果类本身被卸载并且整个对象图从堆中删除，它也可以被释放（即使没有为空）。当然，什么时候可以卸载一个类对于许多其他问题来说是一个很好的话题...... :)

# python - Python源代码合集

> ID：405374
> 
> 赞同：3
> 
> 时间：2009-01-01T19:51:53.637
> 
> 标签：python

有谁知道网络上有大量 Python 源代码和不错的文档？如果是这样，有人可以在这里发布吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-01T19:55:01.307

也许是[Python 标准库](http://docs.python.org/library/)？还是您在寻找更具体的东西？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-01T20:10:07.733

我不确定您所说的“源代码”是什么意思？Python 库的源代码或代码示例和食谱？

好吧，Python STL 的链接很棒（@zenazn）。

除此之外，如果您正在寻找特定问题及其解决方案和食谱，我会建议：

1.  [http://code.activestate.com/recipes/langs/python/](http://code.activestate.com/recipes/langs/python/)
2.  堆栈溢出本身。

虽然您不会在这些来源中找到太多文档，但有很好的答案、评论和讨论作为补充。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-01T19:56:54.047

[你可以在奶酪店](http://pypi.python.org/pypi)找到大量的 Python 库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-11T17:06:25.043

一个很好的地方，涵盖了几个图书馆，非常清楚的例子是：

[http://nullege.com/codes/](http://nullege.com/codes/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-01T20:54:01.327

我喜欢：

*   [Python 食谱](http://code.activestate.com/recipes/langs/python/)
*   [谷歌代码搜索](http://www.google.com/codesearch)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-13T19:46:02.037

cpython 源代码（原始 python 项目）位于[http://hg.python.org/cpython/file/default/](http://hg.python.org/cpython/file/default/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-27T17:34:04.773

不是 Python 本身，而是您甚至可以在源代码中搜索的第 3 方包源代码：

[http://pydoc.net/](http://pydoc.net/)

# php - 如何将数据库连接到网站，以便用户可以访问数据库并对其进行更改？

> ID：405375
> 
> 赞同：2
> 
> 时间：2009-01-01T19:52:10.140
> 
> 标签：php, mysql, web

我正在尝试创建一个允许用户更改其个人 mysql 数据库的网站。该网站是用 PHP 编写的。如何将其中一个网页连接到数据库？任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-01T19:58:19.100

[phpmyadmin](http://www.phpmyadmin.net/)将执行此操作，登录用户将只能看到他们有权访问的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T20:16:50.840

除了[phpmyadmin](http://www.phpmyadmin.net/)之外，我发现**[SQL Buddy](http://www.sqlbuddy.com/)**有一个非常干净、简单的界面可以使用。

# c# - 什么是“无法验证的代码”，为什么它不好？

> ID：405379
> 
> 赞同：21
> 
> 时间：2009-01-01T19:54:48.637
> 
> 标签：c#

我正在设计一个辅助方法，它为我延迟加载某些对象，调用它看起来像这样：

```
public override EDC2_ORM.Customer Customer {
    get { return LazyLoader.Get<EDC2_ORM.Customer>(
            CustomerId, _customerDao, ()=>base.Customer, (x)=>Customer = x); }
    set { base.Customer = value; }
} 
```

当我编译此代码时，我收到以下警告：

> 警告 5 通过匿名方法、lambda 表达式、查询表达式或迭代器的“base”关键字访问成员“EDC2_ORM.Billing.Contract.Site”会导致无法验证的代码。考虑将访问移动到包含类型的辅助方法中。

这里的抱怨到底是什么，为什么我做的不好？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-01T20:04:18.260

虚拟方法的“base.Foo”将对方法“Foo”的父定义进行非虚拟调用。从 CLR 2.0 开始，CLR 决定对虚拟方法的非虚拟调用可能是一个潜在的安全漏洞，并限制了可以使用 in 的场景。他们将其限制为对同一类层次结构中的虚拟方法进行非虚拟调用。

Lambda 表达式在这个过程中出现了问题。Lambda 表达式经常在底层生成一个闭包，它是一个完全独立的类。因此代码“base.Foo”最终将成为一个全新类中的表达式。这会使用 CLR 创建一个验证异常。因此 C# 发出警告。

旁注：等效代码将在 VB 中工作。在 VB 中，对于虚拟方法的非虚拟调用，将在原始类中生成方法存根。非虚拟调用将在此方法中执行。“base.Foo”将被重定向到“StubBaseFoo”（生成的名称不同）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-01T20:01:30.683

我怀疑问题在于您基本上是在说，“我不想使用最派生的 Customer 实现——我想使用*这个*特定的实现”——这是您无法正常执行的。您可以在派生类中执行此操作，并且有充分的理由，但是从其他类型中您将违反封装。

现在，当您使用匿名方法、lambda 表达式、查询表达式（基本上使用 lambda 表达式）或迭代器块时，有时编译器必须在幕后为您创建一个新类。有时它可以为 lambda 表达式创建一个相同类型的新方法，但这取决于上下文。基本上，如果在 lambda 表达式中捕获了任何局部变量，则需要一个新类（或者实际上是多个类，具体取决于范围 - 它可能会变得讨厌）。如果 lambda 表达式只捕获`this`引用，则可以为 lambda 表达式逻辑创建一个新的实例方法。如果没有捕获任何内容，则可以使用静态方法。

因此，尽管 C# 编译器知道您确实没有违反封装，但 CLR 却没有——因此它对代码持怀疑态度。如果您在完全信任下运行，那可能不是问题，但在其他信任级别（我不知道详细信息）下，您的代码将不允许运行。

这有帮助吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T20:00:23.633

[从这里](http://www.chinaitpower.com/A/2002-01-23/11684.html)复制/粘贴：

> Codesta：C#/CLR有2种代码，安全的和不安全的。它试图提供什么以及这对虚拟机有何影响？Peter Hallam：对于 C#，术语是安全的和不安全的。CLR 使用可验证和不可验证的术语。
> 
> 当运行可验证代码时，CLR 可以强制执行安全策略；CLR 可以阻止可验证代码做它无权做的事情。当运行潜在的恶意代码时，例如从 Internet 下载的代码，CLR 将只运行可验证的代码，并确保不受信任的代码不会访问它无权访问的任何内容。
> 
> 使用标准 C 样式指针会创建无法验证的代码。CLR 本身就支持 C 风格的指针。一旦你有了一个 C 风格的指针，你就可以读取或写入进程中的任何内存字节，因此运行时无法强制执行安全策略。实际上它可以，但性能损失会使它不切实际。

现在，这并不能完全回答您的问题（即为什么这是现在无法验证的代码），但至少它解释了“无法验证”是“不安全”的 CLR 术语。我假设匿名方法和基类在内部会产生一些时髦的指针魔术。

顺便说一句：我认为代码片段与警告消息不匹配。代码是关于客户的，警告是关于计费的。是否可以发布生成警告的动作代码？也许您在该代码中有其他内容可以更好地解释您收到警告的原因。

# c# - 我应该如何将多个文本框中的值存储在数据库中

> ID：405393
> 
> 赞同：0
> 
> 时间：2009-01-01T20:00:48.173
> 
> 标签：c#, asp.net

我在应用程序上有 14 个文本框，用户将输入个位数。我的任务是检索所有 14 个文本框的值并将其保存到数据库中……我在为所有文本框传递字符串时遇到问题。**有人可以帮我** **在 .aspx 文件中编写一些代码**吗？我做了一些工作：实际上我需要帮助来编写一个可以将所有 14 个值作为单个字符串传递的方法。

```
BLL: public static SubmitParentReport GetItem(string needHours) { 
  return SubmitParentReportDB.GetItem(needHours); 
}

BO: private string needHours = ""; public string NeedHours { 
  get { return needHours; } 
  set { needHours = value; } 
}

DAL: This parameter I am using to store in database:

OracleParameter prm3 = new OracleParameter("i_need_hours", OracleType.VarChar, 2);    
prm3.Direction = ParameterDirection.Input; prm3.Value = needHours;    
myCommand.Parameters.Add(prm3); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T20:20:46.510

您可以将分隔字符串传递给存储过程，该过程将解析出字符串。

但是，我会选择为要保存的 14 个值中的每一个创建一个单独的 OracleParameter。这样，您可以更好地控制数据类型的完整性，并且应用程序的每一层都确切地知道期望什么参数以及如何处理它们。

# asp.net - 在没有 MVC 的情况下使用路由：身份验证表单

> ID：405394
> 
> 赞同：3
> 
> 时间：2009-01-01T20:00:54.163
> 
> 标签：asp.net, authentication, routing

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T11:59:47.620

These steps should allow you to implement the required behaviour.
To summarize:

1.  You are using routing but not MVC. My example will map a url like [http://host/Mysite/userid/12345](http://host/Mysite/userid/12345) onto a real page at [http://host/Mysite/Pages/users.aspx?userid=12345](http://host/Mysite/Pages/users.aspx?userid=12345).
2.  You want to control access to these addresses, requiring the user to logon. My example has a page [http://host/Mysite/login.aspx](http://host/Mysite/login.aspx) with a standard login control, and the site is configured to use forms authentication.

## Step 1

I've "hidden" the contents of the Pages folder using this web.config in the Pages folder:

```
 <?xml version="1.0"?>
  <configuration>
    <system.web>
      <httpHandlers>
        <add path="*" verb="*"
            type="System.Web.HttpNotFoundHandler"/>
      </httpHandlers>
      <pages validateRequest="false">
      </pages>
    </system.web>
    <system.webServer>
      <validation validateIntegratedModeConfiguration="false"/>
      <handlers>
        <remove name="BlockViewHandler"/>
        <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler"/>
      </handlers>
    </system.webServer>
  </configuration> 
```

This ensures that if anyone uses a url like [http://host/Mysite/Pages/users.aspx?userid=12345](http://host/Mysite/Pages/users.aspx?userid=12345), then they receive a standard 404 response.

## Step 2

My top level web.config file contains (as well as all the standard stuff) this location element:

```
 <location path="userid">
    <system.web>
      <authorization>
        <deny users="?"/>
      </authorization>
    </system.web>
  </location> 
```

This prevents anonymous access to urls of the form [http://host/Mysite/userid/12345](http://host/Mysite/userid/12345) which means users will be automatically redirected to login.aspx, then if they provide valid credentials, they will be redirected to the correct location.

## Step 3

For reference here is my global.asax:

```
<script RunAt="server">

    void Application_Start(object sender, EventArgs e)
    {
        // Code that runs on application startup
        RegisterRoutes(RouteTable.Routes);
     }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.RouteExistingFiles = true;
        routes.Add("UseridRoute", new Route
        (
           "userid/{userid}",
           new CustomRouteHandler("~/Pages/users.aspx")
        ));
    }

</script> 
```

And here is my route handler:

```
using System.Web.Compilation;
using System.Web.UI;
using System.Web;
using System.Web.Routing;
using System.Security;
using System.Web.Security;

public interface IRoutablePage
{
    RequestContext RequestContext { set; }
}

public class CustomRouteHandler : IRouteHandler
{
    public CustomRouteHandler(string virtualPath)
    {
        this.VirtualPath = virtualPath;
    }

    public string VirtualPath { get; private set; }

    public IHttpHandler GetHttpHandler(RequestContext
          requestContext)
    {
        var page = BuildManager.CreateInstanceFromVirtualPath
             (VirtualPath, typeof(Page)) as IHttpHandler;

        if (page != null)
        {
            var routablePage = page as IRoutablePage;

            if (routablePage != null) routablePage.RequestContext = requestContext;
        }

        return page;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T20:07:20.907

The first result I got from a Google search is Frederiks excellent post on [forms authentication in ASP.NET MVC](http://weblogs.asp.net/fredriknormen/archive/2008/02/07/asp-net-mvc-framework-using-forms-authentication.aspx). Note that the post was relevant for an early version of ASP.NET MVC, you will have to write and test the code.

HTH, Indy

# ruby-on-rails - 您在 Rails 中指定复杂 SQL 查询的约定是什么？

> ID：405400
> 
> 赞同：5
> 
> 时间：2009-01-01T20:04:16.933
> 
> 标签：ruby-on-rails, ruby

我对 Rails 相当陌生，我很好奇专家在需要构建包含许多条件的非常复杂的 SQL 查询时使用的一些约定。具体来说，保持代码的可读性和可维护性。

我可以想到几种方法：

单行，在对 find() 的调用中：

```
@pitchers = Pitcher.find(:all, "<conditions>") 
```

使用预定义的字符串并将其传入：

```
@pitchers = Pitcher.find(:all, @conditions) 
```

使用私有成员函数返回查询

```
@pitchers = Pitcher.find(:all, conditionfunction) 
```

我有点倾向于私有成员函数约定，另外因为您可以传入参数来自定义查询。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-01T20:17:01.590

我几乎从不将条件传递给`find`. `named_scope`通常，这些条件以模型上的类方法或什至只是类方法的形式添加到您的对象模型中是有价值的。命名范围很好，因为您可以将它们链接起来，这会减少复杂性。它们还允许您传递参数。

此外，您几乎不应该只传递原始 SQL 条件字符串。您应该使用散列样式 ( `:conditions => { :name => 'Pat' }`) 或数组样式 ( `['name = ?', 'Pat']`)。这样，SQL 就会为您转义，提供一些针对 SQL 注入攻击的保护。

最后，我认为您正在考虑的方法，即您试图在您所调用的任何上下文中创造条件的`find`方法是一种有缺陷的方法。模型的工作是提供一个接口，通过该接口返回相关响应。如果你问我，试图确定传递给`find`调用的条件太接近底层实现了。此外，它更难测试。

# jquery - 在 $.AJAX 加载的 HTML 上使用 Jquery 选择器？

> ID：405409
> 
> 赞同：49
> 
> 时间：2009-01-01T20:09:29.747
> 
> 标签：jquery

我有

```
$.ajax({
  url: identity,
  success: function(data) { ProcessIdentityServer(data) }
}); 
```

当返回“数据”时，有没有办法在不将其添加到 DOM 的情况下对其运行选择器。例如，如何在不先将其添加到 DOM 的情况下获取包含在“数据”中的 HTML 中包含的任何 LINK 标记的所有 href 值？如果我只想将一些东西提取到数组中，那么必须将它添加到 DOM 中似乎很可惜。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-01-01T23:48:45.500

我将添加一个来自类似问题的注释，如果您的 AJAX 返回以下内容：

```
<div class="test">Hello</div>
<div class="one">World</div> 
```

以下 jQuery**不起作用**：

```
$(data).find('div.test'); 
```

由于 div 是顶级元素，而 data 不是元素而是字符串，因此要使其正常工作，您需要使用`.filter`

```
$(data).filter('div.test'); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-01T20:17:49.543

```
// Finds all div elements within an XML document from an AJAX response.
$("div", xml.responseXML); 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2011-10-20T04:41:05.747

在开始之前，让我们快速了解一下 jQuery 对`$.ajax()`调用返回的基本 HTML 页面的作用，并将返回的数据转换为 jQuery 对象。

```
$.ajax({
    dataType : 'html',
    url      : 'path/to/example-page.html',
    success  : function(data) {

        // log the result of the data converted into a jquery object.
        console.log( $(data) );

    }
}); 
```

这是您希望看到的：

```
[

    0         <TextNode textContent="\n\n\n\n\n ">
    1         title
    2         <TextNode textContent="\n ">
    3         meta
    4         <TextNode textContent="\n\n\n\n\n">
    5         div#container
    6         Comment { data=" #container ", length=12, nodeName="#comment", more...}
    7         <TextNode textContent="\n\n">
    jquery    "1.6.4"
    length    8
    selector  ""

    // additional data and functions removed for brevity

] 
```

***哎呀！*** 这是相当丑陋的！尝试做任何事情都*可以*产生结果，但是您需要每次都知道数据结构是什么样的，以及数据在该对象中的位置。该数据是在根部，还是埋藏在其中？

就像以前的海报提到的那样，您可以使用`.filter()`，但根是搜索的范围，因为您只是过滤返回的结果。但是，如果您`.find()`在此时使用并且您想要的元素位于根，您将收到一个空集，但会找到任何隐藏在根之外的元素。

那么，为什么要确定需要 100% 确定地知道该数据结构是什么样的，为什么还要费心费力地使用多个`.filter()`和`.find()`调用的所有麻烦，我敢说`.each()`循环吗？呸！这只是太多的工作，需要太多的时间。

如果`.find()`要从调用返回特定的 HTML 元素，`.ajax()`请从以下行开始：

```
var response = $('<html />').html(data); 
```

真的可以这么简单吗？事实上，是的！这里发生的`<html>`是正在创建一个新元素并将其转换为 jQuery 对象。这用于插入从`.ajax()`调用返回的 HTML 的起始位置。这有点像`$('html')`在网页上做的事情。有了这个，你就可以开始寻找元素了。

```
response.find( ... ); // any jquery selector in place of the ellipsis. 
```

这是一个使用原始海报问题的示例：

```
$.ajax({
    dataType : 'html',
    url      : 'path/to/example-page.html',
    success  : function(data) {

        // set the returned contents in a new base <html> tag.
        var response = $('<html />').html(data),
            anchors, hrefValuesList = [ ],
            i, end;

        // now you can search the returned html data using .find().
        anchors = response.find('a');

        // grab all your href values from each anchor element.
        end = anchors.length;
        for (i = 0; i < end; i++) {
            hrefValuesList.push( anchors[ i ].href );
        }

        // continue processing the data as necessary...

    }
}); 
```

显然，如果您想要过滤掉任何不需要的内容，或者想要细化返回的值，上述内容将需要一些细化。

这样，您可以看到类似以下示例数组的返回：

```
[ "http://stackoverflow.com/", "http://www.google.com/" ] // and so on... 
```

使用这种方法，您可以轻松地`.find()`对通过该函数返回的任何 HTML 数据使用强大的`$.ajax()`功能，就像您已经对您在 DOM 中找到的任何元素所做的那样。真正的好处是您无需直接操作 DOM 来查找或执行您想要的操作，这是一个昂贵的过程。

快乐擦洗！=)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-01T20:14:00.347

假设这`data`是一个 HTML 字符串，你可以这样做：

```
$(data).find('a'); 
```

这将返回链接而不将数据添加到 DOM。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-06T15:32:29.920

您必须首先定义一个容器，以便能够从响应中获取/修改元素：

```
 $.ajax({            
     url: url + "/ajax.htm",
     dataType: "html",
     success: function(html) {
         container = $('#ajax_content');
         container.html(html);
         container.find("a").css("background","red");
     }
 }); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-01T20:16:07.033

当然，您可以使用 $(data) 函数（核心 jquery 函数之一）将返回的 html 转换为 DOM 元素。查看[在线文档](http://docs.jquery.com/Core/jQuery#htmlownerDocument)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-01-10T18:14:26.857

您现在也可以使用上下文（不知道何时引入）：

```
$.get('some/url', '',
    function (data) {
        $("#domelement", data);
    }
); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-11T05:42:56.523

这与接受的答案相同，但有一些额外的解释。

您可以使用 jQuery**上下文**参数[Link to docs](http://api.jquery.com/jQuery/)

我真的无法比文档更好地解释。

> 选择器上下文
> 
> 默认情况下，选择器从文档根目录开始在 DOM 中执行搜索。但是，可以通过使用 $() 函数的可选第二个参数为搜索提供替代上下文

context 参数自 jQuery v1.0 以来一直存在

因此，对于 OP 示例“获取包含在 'data' 中的 HTML 中包含的任何 LINK 标记的所有 href 值而不先将其添加到 DOM”的解决方案将是：

```
success: function(data){
    $("a", data).each(function(){
        console.log( $(this).attr("href") );
    });
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-25T22:16:05.020

我的最终解决方案是

```
jQuery.ajax({
    url: "/some-url",
    cache: false,
    dataType: "html",
    success: function(data) {
        jQuery("#target").html( jQuery(data).find('#ajax-data'));
    }
}); 
```

# editor - 你可以在 vi/vim 中的括号之间抓取或删除吗？

> ID：405415
> 
> 赞同：145
> 
> 时间：2009-01-01T20:13:30.113
> 
> 标签：editor, vim

鉴于 C 中的这行代码：

> `printf("%3.0f\t%6.1f\n", fahr, **(**(5.0/9.0) * (fahr-32)**)**);`

有没有办法从第一个粗体括号删除或拉到其匹配的括号？我想过**df)**，但这只会让你在 9.0.0 之后。

有没有类似的方法让 vim 抓住匹配大括号之间的所有内容，而不考虑换行符？

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2009-01-01T20:36:47.633

**`dib`**或者**`di(`**。_

它将删除光标所在的*内部(...) 块。*

我喜欢[文本对象的](http://vimdoc.sourceforge.net/htmldoc/motion.html#object-select)动作和选择！

* * *

## 回答 #2

> 赞同：181
> 
> 时间：2009-01-01T20:25:10.917

## 各种议案：%

该[`%`命令](http://vimdoc.sourceforge.net/htmldoc/motion.html#%)跳转到光标下项目的匹配项。将光标定位在打开（或关闭）括号上，并`y%`用于拉动或`d%`删除从光标到匹配括号的所有内容。

这是有效的，因为`%`它是一个“运动命令”，所以它可以在 vim 需要这样一个命令的任何地方使用。来自[`:help y`](http://vimdoc.sourceforge.net/htmldoc/change.html#y)：

```
["x]y{motion}       Yank {motion} text [into register x].  When no
                    characters are to be yanked (e.g., "y0" in column 1),
                    this is an error when 'cpoptions' includes the 'E'
                    flag. 
```

默认情况下，“项目”包括方括号、大括号、括号、C 样式注释和各种预编译器语句（`#ifdef`等）。

您可以在[Vim 主页](http://www.vim.org/scripts/script.php?script_id=39)上找到“扩展 % 匹配”插件。

您可以通过进入命令模式阅读有关`%`和相关运动命令的文档。[`:help various-motions`](http://vimdoc.sourceforge.net/htmldoc/motion.html#various-motions)

## 对象选择

您可以在可视模式下使用另一组运动命令来选择各种文本对象。

要解决您的特定问题，您将执行以下操作：

```
printf("%3.0f\t%6.1f\n", fahr, ((5.0/9.0) * (fahr-32)));
                                   ^ 
```

假设您的光标位于`^`. 输入以下顺序以选择您要查找的零件：

```
v2a) 
```

首先`v`进入可视模式，然后您指定要`2`提高括号的级别。最后`a)`选择“一个块”。之后您可以使用`d`或`x`删除等。

如果您不想包含外部括号，则可以改用“内部块”：

```
v2i) 
```

[`:help object-select`](http://vimdoc.sourceforge.net/htmldoc/motion.html#object-select)有关相关命令的完整列表，请参阅。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2014-07-27T09:51:47.860

要删除一对括号内的所有内容，您始终可以发出`di(`及其派生词。

**笔记 ：**

正如@porglezomb 在他的评论中所建议的那样，您可以使用`a`("along with") 而不是`i`("inside") 来包含括号。因此， using`da(`删除了里面的所有内容`(`，`)`包括`(`and `)`。

**删除直接外部括号对内的文本：**

所以，对于这行代码

```
printf("%3.0f\t%6.1f\n", fahr, ((5.0/9.0) * (fahr-32)));
                                ^       ^
                                |       |
                                 \_______\___---> Cursor range 
```

假设您的光标在上述光标范围内，您可以发出以下命令：

```
di(   --> Deletes '5.0/9.0'
ci(   --> Substitutes '5.0/9.0'
yi(   --> Yanks '5.0/9.0' 
```

**删除第 n 个外部括号对内的文本：**

要获取第 n 个外圆括号内的所有内容，只需`n`在上述命令之前添加即可。因此，使用与上面相同的光标位置，

```
2di(   --> Deletes '(5.0/9.0) * (fahr-32)'
2ci(   --> Substitutes '(5.0/9.0) * (fahr-32)'
2yi(   --> Yanks '(5.0/9.0) * (fahr-32)'

3di(   --> Deletes '"%3.0f\t%6.1f\n", fahr, ((5.0/9.0) * (fahr-32))'
3ci(   --> Substitutes '"%3.0f\t%6.1f\n", fahr, ((5.0/9.0) * (fahr-32))'
3yi(   --> Yanks '"%3.0f\t%6.1f\n", fahr, ((5.0/9.0) * (fahr-32))' 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-01T20:17:16.847

您可以`d%`用于删除和`y%`拉动。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-01T20:15:20.920

将光标放在第一个括号上，然后按`v%y`或`v%d`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-01-15T09:55:32.940

试试 ci[block-surrounder]

在您的情况下，将光标放在您突出显示的 2 个括号之间的任何位置并尝试以下键： ci(

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-01T14:34:35.843

正如大卫诺曼的[回答](https://stackoverflow.com/a/405420/611007)所说，

## 将光标放在第一个括号上，然后按`v%y`或`v%d`。

来自[http://vimdoc.sourceforge.net/htmldoc/vimindex.html](http://vimdoc.sourceforge.net/htmldoc/vimindex.html)的解释：

```
普通模式下的标记字符注释动作        
-------------------------------------------------- ----------------------------
|v| v 启动字符可视模式
|%| % 1 找到下一个（大括号/方）括号
                                       这条线并转到它的匹配项，或者转到
                                       匹配注释括号，或转到匹配
|d| ["x]d{motion} 2 删除 Nmove 文本 [into buffer x]

```

这意味着它将选择包括两个括号 ( `%`) 之间的所有内容，同时以可视方式 ( `v`) 向您显示选择，然后将其拉出/复制`y`或删除/剪切`d`。（到默认缓冲区。）

您可以使用`p`.

做出这个回答是为了[“自学钓鱼”](https://en.wiktionary.org/wiki/give_a_man_a_fish_and_you_feed_him_for_a_day;_teach_a_man_to_fish_and_you_feed_him_for_a_lifetime)。

# iphone - 当在类实例化时未定义维度时，如何在 Objective-C 中将浮点数组声明为类变量？

> ID：405426
> 
> 赞同：2
> 
> 时间：2009-01-01T20:17:26.580
> 
> 标签：iphone, objective-c

在 Java 中，它看起来像这样：

```
class Foo
{
  float[] array;
}

Foo instance = new Foo();
instance.array = new float[10]; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-01T20:22:35.477

你可以只使用一个指针：

```
float *array;
// Allocate 10 floats -- always remember to multiple by the object size
// when calling malloc
array = (float *)malloc(10 * sizeof(float));
...
// Deallocate array -- don't forget to do this when you're done with your object
free(array); 
```

如果你使用的是 Objective-C++，你可以这样做：

```
float *array;
array = new float[10];
...
delete [] array; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-01T21:27:46.047

这是另一种方法。创建一个 NSMutableArray 对象并向其添加 NSNumber 对象。这是否明智由您决定。

```
NSMutableArray *array;
array = [[NSMutableArray alloc] init];
[array addObject:[NSNumber numberWithFloat:1.0f]];
[array release]; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-22T21:31:41.420

在 Objective-C 中执行此操作的另一种方法是使用索引实例变量：

```
@interface ArrayOfFloats : NSObject {
@private
  NSUInteger count;
  float      numbers[0];
}
+ (id)arrayOfFloats:(float *)numbers count:(NSUInteger)count;
- (float)floatAtIndex:(NSUInteger)index;
- (void)setFloat:(float)value atIndex:(NSUInteger)index;
@end

@implementation ArrayOfFloats
+ (id)arrayOfFloats:(float *)numbers count:(NSUInteger)count {
    ArrayOfFloats *result = [NSAllocateObject([self class], count * sizeof(float), NULL) init];
    if (result) {
        result->count = count;
        memcpy(result->numbers, numbers, count * sizeof(float));
    }
    return result;
}
...
@end 
```

有关更多信息，请参阅[NSAllocateObject()](http://developer.apple.com/mac/library/documentation/cocoa/reference/foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/uid/20000055-BCIHCIIB)的文档。索引实例变量的一个限制是您不能子类化使用它们的类。

# c# - 如何通过泛型类型的特定实例重载 C# 方法

> ID：405429
> 
> 赞同：1
> 
> 时间：2009-01-01T20:18:38.713
> 
> 标签：c#, generics, overloading

来自 C++ 背景，我遇到了基于泛型类型的特定实例的重载问题。以下内容不起作用，因为只`Foo<T>`生成了一次该类的代码实例，所以在里面`Method`，类型`this`是简单的，`Foo<T>`不是我希望的。在 C++ 中，我习惯于将模板实例化为唯一类型。`Foo<A>``Foo<B>`

```
using System.Collections.Generic;
class A
{
    // Concrete class
}

class B
{
    // Concrete class
}

class Bar
{
    public void OverloadedMethod(Foo<A> a) {} // do some A related stuff
    public void OverloadedMethod(Foo<B> b) {} // do some B related stuff
    public void OverloadedMethod(OtherFoo of) {} // do some other stuff

     public void VisitFoo(FooBase fb) { fb.Method(this); }
}

abstract class FooBase
{
    public abstract void Method(Bar b);
}

class Foo<T> : FooBase
{
    // Class that deals with As and Bs in an identical fashion.
    public override void Method(Bar b)
    {
        // Doesn't compile here
        b.OverloadedMethod(this);
    }
}

class OtherFoo : FooBase
{
    public override void Method(Bar b)
    {
        b.OverloadedMethod(this);
    }
}

class Program
{
    static void Main(string[] args)
    {
        List<FooBase> ListOfFoos = new List<FooBase>();
        ListOfFoos.Add(new OtherFoo());
        ListOfFoos.Add(new Foo<A>());
        ListOfFoos.Add(new Foo<B>());

        Bar b = new Bar();
        foreach (FooBase fb in ListOfFoos)
            b.VisitFoo(fb);
        // Hopefully call each of the Bar::Overloaded methods
    }
} 
```

有没有办法让这样的东西在 C# 中工作？我宁愿不必将 Foo 中的代码复制为我想要使用的每种类型的单独类。

编辑：希望这更清楚一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T20:47:23.680

我现在有一段真正完整的代码来演示这个问题。OP注意：请在发布之前尝试编译您的代码。我必须做很多事情才能走到这一步。让其他人尽可能轻松地帮助您是件好事。我还删除了一堆无关的位。OtherFoo 在这里并不真正相关，FooBase 也不是。

```
class A {}
class B {}

class Bar
{
    public static void OverloadedMethod(Foo<A> a) { }
    public static void OverloadedMethod(Foo<B> b) { }
}

class Foo<T>
{
    // Class that deals with As and Bs in an identical fashion.
    public void Method()
    {
        // Doesn't compile here
        Bar.OverloadedMethod(this);
    }
} 
```

是的，这不会编译。你期望它做什么，究竟是什么？请记住，重载决议是在*编译时*执行的，而不是在执行时执行的。正如fall888 所说，您可以强制转换并调用适当的重载方法 - 但是您希望编译器选择两个重载中的哪一个？你想让它做什么`Foo<string>`而不是`Foo<A>`or `Foo<B>`？

这一切都证明 .NET 泛型确实与 C++ 模板有很大不同，当然......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T21:06:41.537

我还没有尝试过，但似乎你应该能够通过使 A & B 可访问（例如使用非循环访问者模式）来实现你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T12:34:37.080

这适用于静态情况。处理实例函数会有点复杂。[Jon Skeet](http://msmvps.com/blogs/jon_skeet/archive/2008/08/09/making-reflection-fly-and-exploring-delegates.aspx)的这篇文章可能会提供一种处理实例方法的合理方法。

```
class Program
{
    static void Main(string[] args)
    {
        var testA = new Foo<A>();
        testA.Method();
        var testB = new Foo<B>();
        testB.Method();
        Console.ReadLine();
        var testString = new Foo<string>(); //Fails
        testString.Method(); 
        Console.ReadLine();
    }
}

class A { }
class B { }
class Bar
{
    public static void OverloadedMethod(Foo<A> a)
    {
        Console.WriteLine("A");
    }
    public static void OverloadedMethod(Foo<B> b)
    {
        Console.WriteLine("B");
    }
}
class Foo<T>
{
    static Foo()
    {
        overloaded = (Action<Foo<T>>)Delegate.CreateDelegate(typeof(Action<Foo<T>>), typeof(Bar).GetMethod("OverloadedMethod", new Type[] { typeof(Foo<T>) }));
    }

    public void Method()
    {
        overloaded(this);
    }

    private static readonly Action<Foo<T>> overloaded;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T20:36:57.367

编辑：我不确定您是否可以在尝试时完成此操作。我已经尝试了各种技巧来尝试让它工作并且无法让它编译。我能做的最好的就是将方法调用拉到我的 Generic 类之外。如果您的方法调用在外部，那么您可以专门定义泛型中的 T 是什么。但是，在方法内部，在编译时，编译器不知道 T 将是什么，因此它不知道要调用哪个重载方法。我能看到的唯一方法是使用开关来确定 T 的类型并手动指定要调用的重载。

我能做的最好的就是这个，这不是你所追求的，但它可以用来达到类似的效果：

```
class Stuff<T>
{
    public T value { get; set; }
}

class Program
{
    static void DummyFunc(Stuff<int> inst)
    {
        Console.WriteLine("Stuff<int>: {0}", inst.value.ToString());
    }

    static void DummyFunc(Stuff<string> inst)
    {
        Console.WriteLine("Stuff<string>: {0}", inst.value);
    }
    static void DummyFunc(int value)
    {
        Console.WriteLine("int: {0}", value.ToString());
    }
    static void DummyFunc(string value)
    {
        Console.WriteLine("string: {0}", value);
    }
    static void Main(string[] args)
    {
        var a = new Stuff<string>();
        a.value = "HelloWorld";

        var b = new Stuff<int>();
        b.value = 1;

        var c = "HelloWorld";
        var d = 1;

        DummyFunc(a);
        DummyFunc(b);
        DummyFunc(c);
        DummyFunc(d);
    }
} 
```

并得到输出：

```
Stuff<string>: HelloWorld
Stuff<int>: 1
string: HelloWorld
int: 1 
```

我有四个重载函数引用两个引用泛型类（一个用于 int，一个用于 string）和两个引用常规类型（一个用于 int，一个用于 string），一切正常......这就是你想要的?

编辑：问题似乎与重载方法的调用无关，它与您的 foreach 有关，它试图将列表中的所有项目转换为与第一个相同的类型以引用重载方法。不符合该确切定义的第一项将导致您的编译失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T21:22:19.383

我希望找到一种更简单的方法来做到这一点，但现在我要这样做：

用这些类替换`Foo<T>`类：

```
abstract class Foo<T> : FooBase
{
    // Class that deals with As and Bs in an identical fashion.
}

class Foo_A : Foo<A>
{
    public override void Method(Bar b)
    {
        b.OverloadedMethod(this);
    }
}

class Foo_B : Foo<B>
{
    public override void Method(Bar b)
    {
        // Doesn't compile here
        b.OverloadedMethod(this);
    }
} 
```

并将实例更改为

```
List<FooBase> ListOfFoos = new List<FooBase>();
ListOfFoos.Add(new OtherFoo());
ListOfFoos.Add(new Foo_A());
ListOfFoos.Add(new Foo_B()); 
```

这至少不需要复制代码`Foo<T>`，只需要我转发构造函数。

# c++ - 在 C++ 中动态创建和调用类方法的最简单方法是什么？

> ID：405432
> 
> 赞同：3
> 
> 时间：2009-01-01T20:23:33.137
> 
> 标签：c++, model-view-controller, object

我想用类名和方法、唯一标识符和指向方法的指针填充映射。

```
typedef std::map<std::string, std::string, std::string, int> actions_type;
typedef actions_type::iterator actions_iterator;

actions_type actions;
actions.insert(make_pair(class_name, attribute_name, identifier, method_pointer));

//after which I want call the appropriate method in the loop

while (the_app_is_running)
{
    std::string requested_class = get_requested_class();
    std::string requested_method = get_requested_method();

    //determine class
    for(actions_iterator ita = actions.begin(); ita != actions.end(); ++ita)
    {
        if (ita->first == requested_class && ita->second == requested_method)
        {
            //class and method match
            //create a new class instance
            //call method
        }
    }
} 
```

如果方法是静态的，那么一个简单的指针就足够了，问题很简单，但是我想动态创建对象，所以我需要存储一个指向类的指针和方法的偏移量，我不知道这是否有效（如果偏移量始终相同等）。

问题是 C++ 缺乏反射，具有反射的解释语言中的等效代码应该如下所示（PHP 中的示例）：

```
$actions = array
(
     "first_identifier" => array("Class1","method1"),
     "second_identifier" => array("Class2","method2"),
     "third_identifier" => array("Class3","method3")
);

while ($the_app_is_running)
{
     $id = get_identifier();

     foreach($actions as $identifier => $action)
     {
         if ($id == $identifier)
         {
             $className = $action[0];
             $methodName = $action[1];

             $object = new $className() ;

             $method = new ReflectionMethod($className , $methodName);
             $method -> invoke($object);    
         }
     }
 } 
```

PS：是的，我正在尝试用 C++ 制作一个（网络）MVC 前端控制器。我知道我知道为什么不使用 PHP、Ruby、Python（在此处插入您最喜欢的网络语言）等？我只想要 C++。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-01T20:37:44.510

也许您正在寻找[成员函数指针](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)。

基本用法：

```
class MyClass
{
    public:
        void function();
};

void (MyClass:*function_ptr)() = MyClass::function;

MyClass instance;

instance.*function_ptr; 
```

正如 C++ FAQ Lite 中所述，宏和`typedef`s 在使用成员函数指针时会大大提高可读性（因为它们的语法在代码中并不常见）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-02T16:18:40.560

我上几个小时写了这些东西，并将它添加到我的有用东西集合中。如果您要创建的类型没有任何关系，最困难的是处理工厂功能。我`boost::variant`为此使用了一个。你必须给它一组你想使用的类型。然后它将跟踪变体中当前的“活动”类型是什么。（boost::variant 是所谓的有区别的联合）。第二个问题是如何存储函数指针。问题是指向成员的指针`A`不能存储到指向成员的指针`B`。这些类型是不兼容的。为了解决这个问题，我将函数指针存储在一个重载其`operator()`并采用 boost::variant 的对象中：

```
return_type operator()(variant<possible types...>) 
```

当然，所有类型的函数都必须具有相同的返回类型。否则整个游戏将毫无意义。现在代码：

```
#include <boost/variant.hpp>
#include <boost/function.hpp>
#include <boost/bind.hpp>
#include <boost/tuple/tuple.hpp>
#include <boost/mpl/identity.hpp>
#include <boost/function_types/parameter_types.hpp>
#include <boost/function_types/result_type.hpp>
#include <boost/function_types/function_arity.hpp>
#include <boost/preprocessor/repetition.hpp>
#include <map>
#include <string>
#include <iostream>

// three totally unrelated classes
// 
struct foo {
    std::string one() {
        return "I ";
    }
};

struct bar {
    std::string two() {
        return "am ";
    }
};

struct baz {
    std::string three() const {
        return "happy!";
    }
};

// The following are the parameters you have to set
//

// return type
typedef std::string return_type;
// variant storing an object. It contains the list of possible types you
// can store.
typedef boost::variant< foo, bar, baz > variant_type;
// type used to call a function on the object currently active in
// the given variant
typedef boost::function<return_type (variant_type&)> variant_call_type;

// returned variant will know what type is stored. C++ got no reflection, 
// so we have to have a function that returns the correct type based on
// compile time knowledge (here it's the template parameter)
template<typename Class>
variant_type factory() {
    return Class();
}

namespace detail {
namespace fn = boost::function_types;
namespace mpl = boost::mpl;

// transforms T to a boost::bind
template<typename T>
struct build_caller {
    // type of this pointer, pointer removed, possibly cv qualified. 
    typedef typename mpl::at_c<
        fn::parameter_types< T, mpl::identity<mpl::_> >,
        0>::type actual_type;

    // type of boost::get we use
    typedef actual_type& (*get_type)(variant_type&);

// prints _2 if n is 0
#define PLACEHOLDER_print(z, n, unused) BOOST_PP_CAT(_, BOOST_PP_ADD(n, 2))
#define GET_print(z, n, unused)                                         \
    template<typename U>                                                \
    static variant_call_type get(                                       \
        typename boost::enable_if_c<fn::function_arity<U>::value ==     \
            BOOST_PP_INC(n), U>::type t                                 \
        ) {                                                             \
        /* (boost::get<actual_type>(some_variant).*t)(n1,...,nN) */     \
        return boost::bind(                                             \
            t, boost::bind(                                             \
                (get_type)&boost::get<actual_type>,                     \
                _1) BOOST_PP_ENUM_TRAILING(n, PLACEHOLDER_print, ~)     \
            );                                                          \
    }

// generate functions for up to 8 parameters
BOOST_PP_REPEAT(9, GET_print, ~)

#undef GET_print
#undef PLACEHOLDER_print

};

}

// incoming type T is a member function type. we return a boost::bind object that
// will call boost::get on the variant passed and calls the member function
template<typename T>
variant_call_type make_caller(T t) {
    return detail::build_caller<T>::template get<T>(t);
}

// actions stuff. maps an id to a class and method.
typedef std::map<std::string, 
                 std::pair< std::string, std::string >
                 > actions_type;

// this map maps (class, method) => (factory, function pointer)
typedef variant_type (*factory_function)();
typedef std::map< std::pair<std::string,      std::string>, 
                  std::pair<factory_function, variant_call_type> 
                  > class_method_map_type;

// this will be our test function. it's supplied with the actions map, 
// and the factory map
std::string test(std::string const& id,
                 actions_type& actions, class_method_map_type& factory) {
    // pair containing the class and method name to call
    std::pair<std::string, std::string> const& class_method =
        actions[id];

    // real code should take the maps by const parameter and use
    // the find function of std::map to lookup the values, and store
    // results of factory lookups. we try to be as short as possible. 
    variant_type v(factory[class_method].first());

    // execute the function associated, giving it the object created
    return factory[class_method].second(v);
}

int main() {
    // possible actions
    actions_type actions;
    actions["first"] = std::make_pair("foo", "one");
    actions["second"] = std::make_pair("bar", "two");
    actions["third"] = std::make_pair("baz", "three");

    // connect the strings to the actual entities. This is the actual
    // heart of everything.
    class_method_map_type factory_map;
    factory_map[actions["first"]] = 
        std::make_pair(&factory<foo>, make_caller(&foo::one));
    factory_map[actions["second"]] = 
        std::make_pair(&factory<bar>, make_caller(&bar::two));
    factory_map[actions["third"]] = 
        std::make_pair(&factory<baz>, make_caller(&baz::three));

    // outputs "I am happy!"
    std::cout << test("first", actions, factory_map)
              << test("second", actions, factory_map)
              << test("third", actions, factory_map) << std::endl;
} 
```

它使用了来自 boost 预处理器、函数类型和绑定库的非常有趣的技术。循环可能会很复杂，但是如果您在该代码中获得了密钥，那么就不再需要掌握了。如果要更改参数计数，只需调整 variant_call_type：

```
typedef boost::function<return_type (variant_type&, int)> variant_call_type; 
```

现在您可以调用采用 int 的成员函数。以下是调用方的外观：

```
return factory[class_method].second(v, 42); 
```

玩得开心！

* * *

如果您现在说上面的内容太复杂，我不得不同意您的看法。这*很*复杂，因为 C++*并不是*真正为这种动态使用而设计的。如果您可以在要创建的每个对象中对方法进行分组和实现，则可以使用纯虚函数。或者，您可以在默认实现中抛出一些异常（如 std::runtime_error），因此派生类不需要实现所有内容：

```
struct my_object {
    typedef std::string return_type;

    virtual ~my_object() { }
    virtual std::string one() { not_implemented(); }
    virtual std::string two() { not_implemented(); }
private:
   void not_implemented() { throw std::runtime_error("not implemented"); }
}; 
```

对于创建对象，通常的工厂会做

```
struct object_factory {
    boost::shared_ptr<my_object> create_instance(std::string const& name) {
        // ...
    }
}; 
```

映射可以由映射 ID 到一对类和函数名称（与上面相同）和映射到 boost::function 的映射组成：

```
typedef boost::function<my_object::return_type(my_object&)> function_type;
typedef std::map< std::pair<std::string, std::string>, function_type> 
                  class_method_map_type;
class_method_map[actions["first"]] = &my_object::one;
class_method_map[actions["second"]] = &my_object::two; 
```

调用该函数的工作方式如下：

```
boost::shared_ptr<my_object> p(get_factory().
    create_instance(actions["first"].first));
std::cout << class_method_map[actions["first"]](*p); 
```

当然，使用这种方法，您会失去灵活性和（可能还没有分析）效率，但您会大大简化您的设计。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-02T17:31:50.803

我认为这里最重要的是，你所有的方法都具有相同的签名吗？如果他们这样做了，这是对 boost 绑定的微不足道的使用（如果你喜欢的话），函子是一个选项（静态，鸭子类型），或者只是简单的 ole 虚拟继承是一个选项。继承目前并不流行，但它很容易理解，我认为它不再使事情复杂化，然后使用 boost bind（恕我直言，最适合小型非系统函子）。

这是一个示例实现

```
#include<iostream>
#include<map>
#include<string>

using std::map;
using std::string;
using std::cout;
using std::pair;

class MVCHandler
{
public:
    virtual void operator()(const string& somekindofrequestinfo) = 0;
};

class MyMVCHandler : public MVCHandler
{
public:
    virtual void operator()(const string& somekindofrequestinfo)
    {
        cout<<somekindofrequestinfo;
    }
};

void main()
{
    MyMVCHandler myhandler;
    map<string, MVCHandler*> handlerMap;
    handlerMap.insert(pair<string, MVCHandler*>("mysuperhandler", &myhandler));
    (*handlerMap["mysuperhandler"])("somekindofrequestdata");
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T10:08:04.907

像许多 C++ 问题一样，这看起来像是 Boost 的另一个应用程序。您基本上想要存储 boost::bind(&Class::member, &Object) 的结果。[编辑] 使用 boost::function 很容易存储这样的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-01T20:53:59.690

您可以尝试对类使用工厂或抽象工厂设计模式，并为函数使用函数指针。

在寻找类似问题的解决方案时，我发现了以下 2 个带有实现的网页：

[工厂](http://www.oodesign.com/factory-pattern.html)

[抽象工厂](http://programmerjoe.com/2007/03/18/the-abstract-factory-pattern-in-c/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-01T20:54:09.657

如果您不想使用[成员函数指针](https://stackoverflow.com/questions/405432/what-is-the-simplest-way-to-create-and-call-dynamically-a-class-method-in-c#405452)，则可以使用带有类实例参数的静态变量。例如：

```
class MyClass
{
    public:
        void function();

        static void call_function(MyClass *instance);  // Or you can use a reference here.
};

MyClass instance;
MyClass::call_function(&instance); 
```

这需要对编码器进行更多工作并导致可维护性问题（因为如果您更新一个签名，您也必须更新另一个签名）。

您还可以使用调用所有成员函数的单个静态函数：

```
class MyClass
{
    public:
        enum Method
        {
            fp_function,
        };

        void function();

        static void invoke_method(MyClass *instance, Method method);  // Or you can use a reference here.
};

void MyClass::invoke_method(MyClass *instance, Method method)
{
    switch(method)
    {
        default:
            // Error or something here.
            return;

        case fp_function:
            instance->function();
            break;

        // Or, if you have a lot of methods:

#define METHOD_CASE(x) case fp_##x: instance->x(); break;

        METHOD_CASE(function);

#undef METHOD_CASE
    }

    // Free logging!  =D
}

MyClass instance;
MyClass::invoke_method(instance, MyClass::fp_function); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-01T21:05:22.800

您还可以使用函数的动态加载：

在 Windows 中使用 GetProcAddress，在 Unix 中使用 dlsym。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-02T01:44:39.010

选择主题观察者设计模式。

# algorithm - 编码词表的压缩算法

> ID：405433
> 
> 赞同：14
> 
> 时间：2009-01-01T20:23:35.180
> 
> 标签：algorithm, data-structures, dictionary

我正在寻找对算法和/或数据结构的具体建议或参考，以将单词列表编码成有效的拼写检查字典。该方案的目标将导致原始单词列表到编码形式的非常高的压缩比。我对编码字典的唯一输出要求是，可以以相对有效的方式针对原始单词列表测试任何建议的目标单词是否存在。例如，应用程序可能希望对照 100,000 个单词的字典检查 10,000 个单词。它***不是***编码字典形式能够[轻松]转换回原始单词列表形式的要求 - 二进制是/否结果是针对结果字典测试的每个单词所需要的全部。

我假设编码方案，以提高压缩率，将利用给定语言中的已知结构，例如单数和复数形式、所有格形式、缩写等。我对主要编码英语单词特别感兴趣，但要清楚，该方案必须能够编码任何和所有 ASCII 文本“单词”。

我想到的特定应用程序可以假设用于嵌入式设备，其中非易失性存储空间非常宝贵，而字典将是一个随机访问的只读内存区域。

***编辑***：总结字典的要求：

*   零误报
*   零假阴性
*   非常高的压缩比
*   不需要解压

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-01T20:30:59.110

请参阅 McIlroy在[他的 pubs 页面上的](http://www.cs.dartmouth.edu/~doug/pubs.html)[“拼写列表的开发”](http://www.cs.dartmouth.edu/~doug/spell.ps.gz)。关于小型计算机上的拼写检查的经典旧论文，这些约束与您列出的约束非常吻合。词缀剥离和两种不同压缩方法的详细分析：布隆过滤器和相关方案 Huffman-coding a sparse bitset；我可能会优先使用 Bloom 过滤器，而不是他选择的方法，这种方法以显着的速度成本挤出更多 kB。（*Programming Pearls*有一个关于这篇论文的简短章节。）

 *另请参阅用于在全文搜索系统中存储词典的方法，例如[Introduction to Information Retrieval](http://nlp.stanford.edu/IR-book/html/htmledition/dictionary-compression-1.html)。与上述方法不同，这没有误报。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T20:33:34.083

布隆过滤器（[http://en.wikipedia.org/wiki/Bloom_filter](http://en.wikipedia.org/wiki/Bloom_filter)和[http://www.coolsnap.net/kevin/?p=13](http://www.coolsnap.net/kevin/?p=13)）是一种数据结构，用于以非常紧凑的形式存储字典中的单词一些拼写检查器。但是，存在误报的风险。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-01T21:31:40.470

我建议使用填充后缀树。对单词表的良好压缩，以及出色的查找时间。

[http://en.wikipedia.org/wiki/Suffix_tree](http://en.wikipedia.org/wiki/Suffix_tree)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-01T20:38:08.037

总结一下：

*   零误报
*   零假阴性
*   高压缩比
*   不需要逆（即不需要解压缩）

我打算建议 Bloom 过滤器，但这些过滤器的误报率非零。

相反，Programming Pearls 谈到了一组类似的要求（`/usr/share/dict/words`在 41K 中）。

这采用了词干收缩的方法：例如：sent 是根，因此可以添加前置和后置修复：

*   展示
*   代表
*   表示
*   虚假陈述

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-01T21:10:27.470

将单词存储为 7 位格式的连续后缀可以获得 30% 以上的压缩率。我不确定这叫什么，但它可以非常有效地转换为树结构。

例如：a+n+d+s|an+d+y|and+es+roid

是 26 个字符，相比之下：

一个广告和任何安第斯山脉的安卓

这是33。

考虑到存储为 7 位内容的 12.5% 压缩率，总压缩率约为 31%。当然，压缩比取决于单词列表的大小和内容。

将其转换为 26 根树结构可能会导致查找比纯文本子字符串与平面文件的比较更快。

想一想，如果您只使用 26 个字符加上两个作为分隔符，您可以在 5 位中完成所有操作，这本身就是 37.5% 的压缩率，使上述示例的压缩率超过 50%。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-01T22:20:12.917

我认为您最好的选择是[Compressed Suffix Tree](http://homepage3.nifty.com/wpage/links/compressed_suffix_trees.html) / [Compressed Suffix Array](http://homepage3.nifty.com/wpage/links/compressed_suffix_arrays.html)。您可以在上述链接中找到大量信息。这是一个正在进行的研究领域，确实非常有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-01T21:26:08.047

我不是这方面的专家，但是[前缀树](http://en.wikipedia.org/wiki/Prefix_tree)不是对此的标准解决方案吗？它只存储单词的公共前缀一次。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-01T22:03:33.510

对于纯压缩，[Maximum Compression](http://www.maximumcompression.com/data/dict.php)网站提供了一些 4 MB 英文单词列表的结果，最好的程序将其压缩到 400 KB 左右。用于文本/单词压缩的其他一些压缩资源是[Hutter Prize 页面](http://prize.hutter1.net/)和[大文本压缩基准](http://www.cs.fit.edu/~mmahoney/compression/text.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-01T21:05:15.173

Knuth在[The Art of Computer Programming vol.中提到了](http://books.google.com/books?id=jYNQAAAAMAAJ&q=patricia&dq=patricia&client=firefox-a&pgis=1)[“Patricia trie” 。](http://en.wikipedia.org/wiki/Radix_tree)[3](http://books.google.com/books?id=jYNQAAAAMAAJ&q=patricia&dq=patricia&client=firefox-a&pgis=1) . 我从未将它用于任何实际工作，但也许这会有所帮助。

编辑：你的 RAM 限制是什么？如果您的 RAM 比可用的 ROM 多得多，那么 ROM 中的数据压缩（需要解压缩到 RAM）可能是正确的方法。我想如果您有中等但不是大量的 RAM，从技术上讲，您还可以将数据结构的一部分作为压缩 blob 存储在内存中，并使用最近最少使用的缓存来保留其中的几个，然后动态解压缩适当的blob 不在缓存中时。

# php - 如何从网站连接到我使用 heidsql 制作的 mysql 数据库？

> ID：405442
> 
> 赞同：0
> 
> 时间：2009-01-01T20:30:19.627
> 
> 标签：php, mysql

我正在使用 heidisql 创建我的 mysql 数据库。我如何从我正在使用的网站连接到这些数据库。我需要能够从网站更改数据库。我正在用 php 编写网站，并用 python 编写与数据库交互的程序。谁能帮我？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T18:16:27.340

您可以使用 PHP 的 MySQL 函数。或者您可以使用 PEAR DB 包，它使事情变得更容易。如果您还没有使用 PEAR，则必须先安装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T03:38:25.643

您可以使用 PHP 的内置 MySQL 函数直接与数据库交互：[PHP MySQL Docs](http://php.net/system)

或者，您可以用 Python 编写所有的数据库交互，然后让您的 PHP 网站使用 PHP 的[系统函数](http://php.net/system)调用这些 Python 脚本。

# .net - 我的 .NET Web 服务可以被视为 RESTful 接口吗？

> ID：405470
> 
> 赞同：1
> 
> 时间：2009-01-01T20:55:18.313
> 
> 标签：.net, rest, soap, web-services

新年快乐。

我有一堆 SOAP Web 服务。它们都具有 HTTP POST 和 GET 接口以及 SOAP 接口。我相信在 .NET/Visual Studio 中构建 SOAP Web 服务时默认提供 POST 和 GET。

这些方法之一： (1) 获取信息，例如，提供您的用户名、密码和交易 ID -> 获取包含交易状态的 XML；(2) 通过提供您的用户名、密码和一些数据来创建交易 -> 使用您的交易 ID 获取 XML。

我的问题是：说我为那些 Ruby 人提供了一个 RESTful Web 服务是否准确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T20:58:15.950

好吧，它可能是 POX——但对于真正的 REST，URI 本身将代表所请求的数据，例如 /Orders/12345；是这样吗？

此外 - 返回的数据将以数据为中心，而不是以操作为中心（这往往是基于 SOAP 的服务的规范）。即结果通常与数据直接相关。

请注意，您可以使用 ADO.NET 数据服务（又名 Astoria）在 .NET 中创建 REST 服务。这是 3.5 SP1 的一部分，并在引擎盖下使用 WCF。默认情况下，完整的 REST 可用于实体框架，或在任何`IQueryable`API 上仅查询。但是您也可以通过实现`IUpdatable`. [从这里](http://marcgravell.blogspot.com/2008/12/astoria-and-linq-to-sql-getting-started.html)开始，我将在一个系列中对此进行介绍。

# asp.net - ASP.NET Datagrid HTML 输出（显示）

> ID：405478
> 
> 赞同：1
> 
> 时间：2009-01-01T21:01:03.543
> 
> 标签：asp.net, html, vb.net, data-binding, dataset

目前我正在将数据集与数据网格绑定。

```
ds = query.ExecuteReadQuery("select PollQuestionText as 'Survey Question',    
PollAnswer1Text as 'Selection 1', PollAnswer2Text as 'Selection 2', PollAnswer3Text  
as 'Selection 3', PollEnabled 'Status'  from tbl_pollquestions")

For Each row As Data.DataRow In ds.Tables(0).Rows
        If row.ItemArray(4).ToString = "0" Then
            row.ItemArray."<a href=""""> <img src=""img/box_icon_edit_pencil1.gif"" border=""0""> </a>"

        ElseIf row.ItemArray(4).ToString = "1" Then
            row.Item(4) = "<a href=""""> <img src=""img/box_icon_edit_pencil2.gif"" border=""0""> </a>"
        End If

    Next

GridView1.DataSource = ds

GridView1.DataBind() 
```

既然我正在插入 html 代码，为什么它没有被转换为 html？

输出结果全是文本。（假设正在显示一个没有重定向 url 的图标）

我不知道为什么。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-27T14:04:41.567

要让 GridView 输出 HTML，您只需在所需绑定字段上将 HtmlEncode 参数设置为 false。

```
<asp:BoundField DataField="Question" HeaderText="Question" HtmlEncode="false" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T00:43:40.957

这是一种无需使用内容模板即可快速解决问题的方法。

首先，将`RowDataBound`事件添加到您的 GridView。

```
<asp:GridView ID="GridView1" runat="server" onrowdatabound="GridView1_RowDataBound">
</asp:GridView> 
```

其次，使用您的逻辑添加事件处理程序的代码。RowDataBound 事件将为每一行触发，我们不必使用`foreach`. 我使用的是 C#，但您可以轻松地将其转换为 VB。

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e) {    
    if (e.Row.RowType == DataControlRowType.DataRow) {        
        if (e.Row.Cells[4].Text == "0") {            
            e.Row.Cells[4].Text = "<a href=''> <img src='img/box_icon_edit_pencil1.gif' border='0'> </a>"
        } else {
            e.Row.Cells[4].Text = "<a href=''> <img src='img/box_icon_edit_pencil2.gif' border='0'> </a>"
        }
    }
} 
```

作为旁注，您可能想要更改

```
<a href=''> <img src='img/box_icon_edit_pencil1.gif' border='0'> </a>
<a href=''> <img src='img/box_icon_edit_pencil2.gif' border='0'> </a> 
```

到

```
<a href="" class="Pencil1"></a>
<a href="" class="Pencil2"></a> 
```

并使用 CSS 设置背景图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T22:17:29.037

如果您使用的是网格视图，您可能希望按预期使用。

您应该有一个内容模板。

如果需要根据值进行格式化，请在 rowdatabound 事件中进行。

我认为你得到了“意外”的行为，因为 gridview 可以绑定到广泛的集合（数组、哈希表、数据集等），并且它管理它如何专门绑定数据。

gridview 的目的是在页面的 html 部分中进行格式化...您可以在那里进行许多精美的格式化。

如果您打算使用gridviews，最好熟悉onrowdatabound和onrowcommand事件......

快速解决：

我想可能需要一点时间来学习如何以正确的方式去做。在此期间，如果您想以最少的更改快速解决您的问题：

*   使用 asp:literal 控件来控制您想要图像的位置
*   更改数据库中的查询以将返回值替换为 html 而不是 0/1 值
*   将文字绑定到返回值并跳过当前的格式化部分

# c# - 在数据绑定控件中应用条件格式时的最佳实践？

> ID：405480
> 
> 赞同：1
> 
> 时间：2009-01-01T21:03:06.643
> 
> 标签：c#, .net, data-binding

我有一个绑定到自定义对象（EntitySpaces 查询）的 Repeater 控件，并且注意到有几种方法可以有条件地格式化正在显示的值。

1）从我的aspx，我可以在我的代码隐藏中调用一个方法并传递绑定值并使用它来驱动任何条件逻辑：

```
 <a class="star" href="<%#MakePackageSelectionUrl((int)DataBinder.Eval(Container.DataItem, "PackageId"))%>">

and then in the code-dehind:

    protected string MakePackageSelectionUrl(int packageId)
    {
              return string.Format("/Packages/NoAjax/ToggleStar.aspx?p={0}&amp;s={1}&amp;st={2}", packageId, _streamId, (int)_phase);
    } 
```

2）我可以挂钩到 ItemDataBound 事件，检索 e.Item.DataItem 作为 DataRowView 然后发疯：

```
 protected void PackageList_ItemDataBound(Object sender, RepeaterItemEventArgs e)
    {
        if (e.Item.ItemType != ListItemType.Item && e.Item.ItemType != ListItemType.AlternatingItem) { return; }

        DataRowView details = (DataRowView)e.Item.DataItem;

        EncodePackageName(e, details);
        EncodeStatusName(e);
        DisplayStarImage(e, details);
    }

    private static void EncodePackageName(RepeaterItemEventArgs e, DataRowView dr)
    {
        HtmlAnchor p = (HtmlAnchor)e.Item.FindControl("packageLink");
        if (p != null)
        {
            p.HRef = string.Format("/Packages/View.aspx?p={0}", dr["packageId"]);
            p.InnerHtml = HttpUtility.HtmlEncode((string)dr["packageName"]);
        }
    } 
```

我还注意到，在代码隐藏中使用 e.Item.FindControl() 需要在 aspx 中的控件上使用 runat="server" ，这有一个讨厌的编码 id 的习惯并且通常会弄乱 HTML。

我很想听听任何想出处理这类问题的好方法的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T21:59:16.343

把事情简单化。

你写的代码越多（即使它是重复的），可能会有越多的错误潜入。

我更喜欢第一种方法，因为您不需要事件处理程序，并且如果多次使用，请将所有格式保存在单独的类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:13:02.547

在这种情况下，您所做的只是处理一些 HTML，所以我将使用第一种方法。第二种方法适用于您需要检查正在数据绑定的项目并更改服务器控件作为响应（例如绑定嵌套列表）的情况。

另请注意，对 DataBinder.Eval() 的调用很昂贵 - 它使用反射。使用显式转换，您将获得更好的性能，如下所示：

```
MakePackageSelectionUrl(((System.Data.DataRowView)Container.DataItem)["PackageId"]) 
```

供参考：http: [//msdn.microsoft.com/en-us/library/ms998549.aspx](http://msdn.microsoft.com/en-us/library/ms998549.aspx)。请参阅有关最小化对 DataBinder.Eval 的调用的部分。

# python - Python 从字典更新对象

> ID：405489
> 
> 赞同：31
> 
> 时间：2009-01-01T21:12:51.133
> 
> 标签：python, iterable-unpacking

是否有一个内置函数/运算符可以用来从字典中解压缩值并将其分配给实例变量？

这就是我打算做的：

```
c = MyClass()
c.foo = 123
c.bar = 123

# c.foo == 123 and c.bar == 123

d = {'bar': 456}
c.update(d)

# c.foo == 123 and c.bar == 456 
```

类似于`update()`从另一个字典加载值但用于普通对象/类实例的字典？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-02T21:02:16.900

还有另一种方法是循环遍历 d 中的项目。这与它们将被存储的假设不同，`c.__dict__`这并不总是正确的。

```
d = {'bar': 456}
for key,value in d.items():
    setattr(c,key,value) 
```

或者您可以编写一个`update`方法作为其中的一部分，`MyClass`以便按照`c.update(d)`您的预期工作。

```
def update(self,newdata):
    for key,value in newdata.items():
        setattr(self,key,value) 
```

查看 setattr 的帮助

> ```
> setattr(...)
>     setattr(object, name, value)
>     Set a named attribute on an object; setattr(x, 'y', v) is equivalent to
>     ''x.y = v''. 
> ```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-01T21:14:32.347

你有没有尝试过

```
f.__dict__.update( b ) 
```

?

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-01T21:21:15.233

此外，也许在字典的更新方法周围有一个包装器会是一种很好的风格：

```
def update(self, b):
    self.__dict__.update(b) 
```

PS：很抱歉没有在@ [S.Lott](https://stackoverflow.com/users/10661/s-lott)的帖子上发表评论，但我还没有代表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-28T07:45:13.933

您可以尝试这样做：

```
def to_object(my_object, my_dict):
    for key, value in my_dict.items():
        attr = getattr(my_object, key)
        if hasattr(attr, '__dict__'):
            to_object(attr, value)
        else:
            setattr(my_object, key, value)

obj = MyObject()
data = {'a': 1, 'b': 2}
to_object(obj, data) 
```

# sql - 选择 ISAM 而不是 SQL

> ID：405491
> 
> 赞同：6
> 
> 时间：2009-01-01T21:14:25.513
> 
> 标签：sql, orm, isam

当应用程序设计需要过程代码和大量数据库时，许多开发人员似乎要么害怕，要么有点不知所措。在大多数情况下，“数据库”是指带有 SQL 接口的 RDBMS。

然而在我看来，用于解决两种范式之间“阻抗不匹配”的许多技术将更适合 ISAM（索引顺序访问方法）工具集，您可以（必须）指定表、索引、行- 导航等公开 - 例如，完全符合 ActiveRecord 模型规定的行为。

在早期的 PC 时代，dBASE 及其后代是主要的 dbms 平台，它是增强的 ISAM。Foxpro 非常成功地将这一血统延续到今天。MySQL 和 Informix 是至少最初构建在 ISAM 实现之上的两个 RDBMS，因此这种方法至少应该具有相同的性能。我感觉许多对 SQL 不满意的开发人员至少在不知不觉中渴望 ISAM 方法能够复兴，并且可以更容易地将数据库视为一组高效的可链接超阵列。在我看来，这可能是一个非常好的主意。

例如，您是否尝试过 ORM 到 ISAM 的实现？有多成功？如果没有，您认为值得一试吗？该模型是否有明确的工具集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T22:06:40.557

也许猪拉丁是你想要的？根据这篇文章 [http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=693D79B5EFDC0452E1C9A87D1C495D4C?doi=10.1.1.124.5496&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=693D79B5EFDC0452E1C9A87D1C495D4C?doi=10.1.1.124.5496&rep=rep1&type=pdf)：

> “此外，许多分析这些数据的人都是根深蒂固的过程式程序员，他们发现声明式的 SQL 风格是不自然的。更加过程化的 map-reduce 编程模型的成功，以及它在商品硬件上的相关可扩展实现—— ware, 是上述的证据。但是，map-reduce 范式太低级和死板，导致大量自定义用户代码难以维护和重用。我们描述了一种新的语言，称为 Pig Latin我们的设计是为了在 SQL 的声明式风格和 map-reduce 的低级程序风格之间找到一个最佳位置。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T21:30:50.473

与成熟的 SQL DBMS 相比，ISAM 在某些时间和地点以更少的成本和开销提供应用程序所需的服务。ISAM 机制的一个缺点是不一定有系统目录来描述数据。另一个是通常很少有用户友好的工具来获取数据。这些都是 RDBMS 提供相当大优势的地方。最好的 ISAM（或类似）系统提供事务支持——有时甚至是 XA 事务。

当您需要进行复杂的连接和计算（例如聚合）时，DBMS 所做的工作提供了巨大的好处。如果您只需要访问记录，那么 ISAM 可能会有所帮助。

使用基于 ISAM 的系统比使用 DBMS 更难实施安全性。此外，您需要担心崩溃时文件的完整性。大多数 DBMS 使用双进程架构（DBMS 客户端与 DBMS 服务器位于一个单独的进程中），这在客户端崩溃（或客户端 PC 被关闭）时提供了弹性。您还必须担心备份和恢复 - 一个称职的 DBMS 具有适当的系统，可以在数据库使用时提供数据库的一致备份；目前尚不清楚 ISAM 系统能否提供这种级别的完整性。

总的来说，给定一个合适的 ISAM 机制，在 ORM 系统中使用 ISAM 机制而不是完整的 RDBMS 至少有时，也许经常是有优势的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T21:55:27.333

我在 1990 年代实现了一个 ORM-to-isam 库，它作为共享软件获得了一些（非常）适度的成功。我在很大程度上同意你所说的 ISAM 的优点，如果你只寻求灵活性和速度，我认为在构建 ORM 层或产品时使用 ISAM 更好。

但是，您所承担的风险是您将失去目前市场上广泛的 SQL 相关产品的好处。特别是，报告工具已经发展到与最流行的 SQL 包更紧密地集成。虽然 1990 年代的 ISAM 产品供应商提供了 ODBC 驱动程序以与 Crystal Reports 等产品集成，但即使在那时，市场似乎也在逐渐远离 ISAM，如果我继续使用该技术，我将面临被淘汰的风险。因此，我切换到 SQL。

一个警告：自从我在 ISAM 沙盒中玩游戏以来已经快十年了，所以我不能声称掌握最新的 ISAM 工具及其解决此问题的方法。但是，除非我确信我不会在没有报告工具支持的情况下陷入困境，否则我不会采用基于 ISAM 的 ORM，无论其优点如何。这甚至不包括可用于基于 SQL 的开发的其他工具！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T22:06:55.033

我完成了 dBase、Clipper 和 FoxPro 的分享。但是我相信 SQL 提供的关系模型更加强大和有用，像 Oracle 和 SQL Server 这样的产品应该在市场上取得成功。

我总是很惊讶为什么人们如此重视为大约 80-90% 的案例创建映射层并编写 10-20% 的自定义 SQL 来处理复杂的查询（主要是报告）和批量数据移动。考虑到对休眠、活跃记录等的仇恨程度，我必须通过采用 DAL/DAO 模型来做一些非常好的或非常愚蠢的事情 - 参见之前的越南讨论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T21:35:26.000

多值数据库有人吗？（又名 Pick）认为没有标签的 XML。它们比 RDBMS 早了至少十年，如果你知道去哪里看，它们仍然很强大。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-16T16:04:23.270

如果您确切地知道要对数据执行什么操作以及如何执行此操作，请选择 ISAM。您会很高兴，因为您将构建索引来满足您的确切需求。预先知道，如果您的需求发生变化，您将需要更改索引。数据访问速度将非常快。

如果您不确定数据将用于什么用途，或者您知道您的数据需求会随着时间的推移发生很大变化，请选择 SQL。您将拥有临时查询、快速报告周转、数据挖掘等的灵活性。

多年来，这两种类型的数据库都已经成熟。两者都可以拥有具有实时备份、事务、安全性、元数据等的强大服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-19T21:47:04.007

老问题，但有趣的讨论。ISAM的*概念*很重要，我们在当今的 RDBMS 中提供的附加功能（如所讨论的，即备份、一致性、安全性、元数据）为我们提供了显着的好处。

NoSQL 热潮（是的，我说过......热潮）并不意味着我们不能在 RDBMS 中对类似 ISAM 的访问进行建模。你肯定我会尽可能多地将逻辑推向数据库，但有时像“传统”数据网格化/多维数据插值，我会通过我自己的逻辑遍历所有必要的记录指数。

# c# - 是否可以在 Visual Studio 2008 中为具有相对路径的 DLL 设置共享文件夹？

> ID：405493
> 
> 赞同：0
> 
> 时间：2009-01-01T21:16:11.580
> 
> 标签：c#, version-control, tfs, relative-path

我使用 Team Foundation 作为包含八个 C# 项目的解决方案的源代码控制。为了强制解耦和稳定性，我只启用了项目与其测试之间的依赖关系。

我想做的是创建一个公共文件夹，可以在其中放置已编译的库和外部工具，并在所有项目的解决方案中共享。问题是解决方案文件夹似乎是虚拟的，即使它们不是，仍然存在一些其他问题，例如相对路径和在 TFS 源代码控制中保持 DLL 更新。

所以我的问题是，是否可以创建一个包含库的通用文件夹，解决方案中的所有项目都可以使用相对路径引用该库并且仍然能够由 TFS 控制？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T21:27:59.917

我不了解 TFS，但是每当我为源代码控制的 VS 解决方案添加第三方库时，我通常会在解决方案文件夹中进行。

```
+-- MySolution
    | // The solution is in source control
    |
    +-- MyProject1
    |   |
    |   +-- Project and source code files for a specific project
    |
    +-- MyProject1.Test
    |   |
    |   +-- Test files for MyProject1
    |
    +-- Third Party
    |   |
    |   +-- Library dll's are stored here.
    |
    |
    +-- Solution files, more project folders, user settings (user settings are not in source control) etc… 
```

当您指出第三方库时，它们应该通过相对路径链接。验证这一点的唯一方法是打开 *proj 文件并在依赖项标签下查看相关库是否与相对路径而不是绝对路径链接。

要将库添加到源代码管理中，您只需添加第三方文件夹。由于我没有使用 TFS，我不确定它是否会破坏这个设置（我使用 Subversion 或 Mercurial 作为源代码控制，它们运行良好）。

# asp.net - 您离不开哪些第三方 ASP.NET 控件或库？

> ID：405500
> 
> 赞同：3
> 
> 时间：2009-01-01T21:23:54.293
> 
> 标签：asp.net

我现在正在做一个项目，我有一些必备的控件，这些控件包含在我构建的大多数网站中。很多时候让我感到震惊的是，最好的控件并不总是那么广为人知，所以我想我会向 Stack Overflow 社区询问他们最喜欢的第三方 ASP.NET 控件——你必须在项目中拥有这些控件，因为它们是如此有价值的。

编辑：

有些人要求澄清和我包括的控制。

首先，我说的不仅仅是用户界面控件，还有库，一些人提到了属于这一类的[log4net 。](http://en.wikipedia.org/wiki/Log4j#Ports)

对我来说，有一个第三方控制包，我发现它做得很巧妙，而且物超所值——它是 Peter Blum 的数据输入套件。正如 Scott Hanselman 所说，它是“对 ASP.NET 验证框架的完全重新构想”，并且加载了与数据输入表单进行丰富交互的控件。

除此之外，我最近真的在挖掘[jQuery](http://en.wikipedia.org/wiki/JQuery)，但像迄今为止的大多数答案一样，在许多地方也使用 ASP.NET Ajax Control Toolkit。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-02T02:15:17.450

一般来说，我更喜欢尽可能避免依赖。但是，有几个 3rd 方库通常最终用于几乎所有项目：

*   ASP.NET AJAX 工具包
*   Log4net

在许多项目中，我还使用了一些内部库（单独编译并由项目引用）。这些用于数据访问、配置管理和实用程序功能。

Telerik 控件也非常适合用于 ASP.NET 项目，但同样，只有在实际使用时才添加到项目中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T22:02:45.510

没有任何。没有所有第三方控件，我可以很高兴地生活。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-02T01:58:59.400

作为一项规则，我尽量避免或至少*尽量减少*对第三方组件的任何依赖。这个想法是我想尽可能地简化应用程序的部署（尽管 X-Copy 部署在这方面还有很长的路要走），而且，我想避免任何 3rd 方组件的供应商将（1 ) 停业，这可能导致他们 (2) 停止对组件的支持，或 (3) 以任何可能导致系统架构、设计或代码发生根本变化的方式更改组件。

如果我没有编写组件，它就超出了我的控制范围。这意味着它包含的任何缺陷或设计缺陷都超出了我的控制范围。叫我控制狂。我可以处理。但是，如果将第 3 方组件添加到我的软件中，因为它具有“浮华”，并且“浮华”引入了缺陷或缺陷，然后我必须编写软件来保护系统的其余部分，我现在必须维护“屏蔽代码”需要额外的成本和时间。

如果我不需要它，我不会添加它。

那是，当然，我的意见，你的里程我会有所不同。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-02T02:06:46.483

在这一点上，ASP.NET AJAX 是一个“必备”扩展。我还依赖[Telerik提供的 JavaScript 文字处理器、ceTe (](http://www.telerik.com/) [DynamicPDF](http://www.dynamicpdf.com/) ) 提供的报告工具，以及[DevExpress](http://www.devexpress.com/)提供的 Scheduling、Charting、Pivo​​tGrid 和 Grid 控件。

我经营一家公司，我是唯一的开发人员。我管理着一个积极增长的 Web 产品，其 C# 代码总数约为 45 [KSLOC](http://en.wikipedia.org/wiki/Source_lines_of_code#Related_terms)，以及三个较旧的 Delphi 应用程序，其 KSLOC 超过 200。我对能够从头开始构建一切以与更大的公司竞争并不抱*任何*幻想，因此第三方工具是必不可少的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-01T22:22:14.330

[ASP.NET AJAX 工具包。](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/)

我可以没有它，但它使一些事情变得更容易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-02T02:58:28.097

我会说我虔诚地使用很少的 3rd 方控件，因为我倾向于编写自己的所有控件。

但是，有一些难以重现，尤其是那些以图形方式显示数据的工具，例如 Dundas 的 Charting 和 Guage 工具。我不擅长图形，所以这些工具在开发的这些方面是无价的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-02T03:07:38.670

我真正经常使用的唯一第三方控件是[FCKeditor](http://en.wikipedia.org/wiki/CKEditor)和 ASP.NET Ajax Control Toolkit。

我以前用过[reCAPTCHA](http://en.wikipedia.org/wiki/ReCAPTCHA)，但我不会说没有它我就活不下去。

最终我想我可能会使用第三方库来访问[Amazon S3](http://en.wikipedia.org/wiki/Amazon_S3)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-02T10:05:41.463

ASP.NET Ajax 控件
asp:chart 对 ASP.NET 3.5 的补充（[此处](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)为 Scott Gutheries 博客）
log4net
Nunit

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-29T15:38:40.727

我曾经是[Telerik](http://telerik.com) Rad Controls 的核心，但我已经改进了我的方法。我现在几乎可以在没有它们的情况下生活。

话虽这么说，有一些真的很棒，当需要时，我使用这些比其他任何东西都多。

*   [Lucene.Net](http://incubator.apache.org/lucene.net/)
*   [DotNetOpenAuth](http://www.dotnetopenauth.net/)
*   [自动映射器](http://automapper.codeplex.com/)

尽管它与 .NET 无关，但我绝对不能没有[jQuery](http://jquery.com/)以及我可以从中获得的所有乐趣。[jQuery](http://jquery.com/)在我的工作流程中完全取代了[AJAX 工具包](http://www.asp.net/ajax)和[Telerik Rad 控件。](http://www.telerik.com/products/aspnet-ajax.aspx)

最后但并非最不重要的一点是，虽然这是 Visual Studio 插件而不是库或控件，但无论如何我不得不提及它，因为它太棒了。我已经开始使用[Chirpy](http://chirpy.codeplex.com/)来缩小和合并我所有的 CSS 和 JS 文件。在我的项目中，这是一个巨大的性能提升器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-02T01:23:05.043

如果他或她已经很好地掌握了.NET，我认为他或她真的不需要第三方控件。当然，拥有它是件好事。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-02T01:32:17.770

*我有一些必须具有的控件，我在我构建的大多数网站中都包含这些控件*

你应该把它们列出来...

对我来说，在我构建的每个项目中，我都没有遇到任何我认为“必须具备”的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-02T02:37:22.133

我使用的唯一第三方控件是 ASP.NET Ajax，尽管我不会将它作为第三方插入。我避免在基于 Web 的项目中使用第三方控件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-02T02:16:40.817

我几乎在每个项目中都使用 AJAX 控件工具包和 Telerik 的 ASP.NET AJAX 控件。它们为我节省了大量时间，您可以获得两者的来源。

# asp.net - 如何在没有 a) 数据绑定或 b) 使用 Response.Write 的情况下创建 HTML 输出？

> ID：405508
> 
> 赞同：-1
> 
> 时间：2009-01-01T21:33:58.437
> 
> 标签：asp.net, html, data-binding, web-controls, htmlcontrols

有点与我的[另一个问题有关](https://stackoverflow.com/questions/405480/best-practices-when-applying-conditional-formatting-in-data-bound-controls)——我只勉强使用了带有 runat="server" 和 WebControls 的 HTMLControls，更喜欢控制生成的标记（包括元素的 id 等）。

你有什么建议，比如说，迭代集合的内容并生成一个表或列表而不诉诸数据绑定或在代码隐藏的循环中使用 Response.Write？我对创建干净、可维护代码的不同方法很感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-01T22:32:05.793

没有什么可以阻止您直接在您的 aspx 页面中迭代您的集合。

```
 <ul>
     <% foreach(Person person in this.People) {%>

         <li><%=person.Firstname %> <%=person.Lastname %></li>

     <% } %>
 </ul> 
```

在此示例中，People 是我的代码隐藏中的列表属性。你会发现很多 ASP.NET MVC 项目都在使用这种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T22:05:51.540

当您说“数据绑定”时，您是指通过 .Bind() 调用将数据库结果集绑定到 Gridview 或 Repeater 等，还是一般仅使用任何 ASP.NET 服务器控件（或 HTML 服务器控件）？

因为，如果您只想避免使用一般的服务器控件，但又不想使用 Response.Write，那么您的选择就会受到严重限制。

就个人而言，如果您想控制标记，为什么不循环遍历 SqlDataReader 或其他东西，然后在适用的情况下使用 HTML 将结果保存到 Literal 控件。然后在页面内（无论您希望数据出现在哪里），只需执行以下操作：

```
 <asp:Literal ID="ltrResults" runat="server" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T22:33:46.400

@Brownie ......是的，但那些是 Response.Write 语句......你只是使用速记格式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-03T05:40:42.343

受第一个建议的启发，我还尝试向 aspx 添加 PlaceHolder，然后从代码隐藏中以编程方式向其添加子控件。我希望我可以为重复内容创建一个用户控件，然后将其添加到循环中的 PlaceHolder 中。这将允许 UI 代码被很好地封装，并且应该隐藏所有 StringBuilder 操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-03T06:43:38.007

中继器控件完全用于您想要的。它是一个服务器控件，但您可以指定在模板中生成的 HTML。您进行数据绑定，但这不只是手动循环的快捷方式吗？

# python - 隐藏用 Python 编写的电子邮件模板系统的实现细节

> ID：405509
> 
> 赞同：0
> 
> 时间：2009-01-01T21:34:26.533
> 
> 标签：python, email, formatting, templates

我正在编写一个应用程序，其中一个功能是允许用户使用 Markdown 语法编写电子邮件模板。

除了格式化之外，用户还必须能够为几个在运行时被替换的变量使用占位符。

目前的工作方式非常简单：模板具有 Pythonic %(var)s 占位符，我在应用 Markdown2 格式之前将其替换为字典。

事实证明，这个系统的最终用户将是一个精通技术的用户，我不想让每个人都明白它是用 Python 编写的。

并不是我不喜欢 Python……我实际上认为 Python 是完成这项工作的完美工具，我只是不想将它暴露给用户（即使它是用 Java、Perl 编写的，我也希望，红宝石或其他任何东西）。

因此，我想就您认为向用户公开占位符的最佳方式征求意见：

1.  你认为最好的占位符格式是什么（如 ${var}、$(var) 或 #{var}）？

2.  替换这些占位符的最佳方法是什么？

我虽然使用正则表达式将 - 例如 - ${var} 更改为 %(var)s 然后应用常规 Python 模板替换，但我不确定这是最好的方法。

如果你这样做，如果你能告诉我那个正则表达式的草稿是什么，那就太好了。

谢谢！

**更新**：一位用户指出使用成熟的模板系统，但我认为这可能不值得，因为我需要的只是占位符替换：我不会有循环或类似的东西。

**最终更新**：此时我选择不使用任何模板引擎。[我选择使用更简单的 string.Template 方法（正如hyperboreean](https://stackoverflow.com/users/49032/hyperboreean)的评论所指出的那样）。事实是，我不喜欢选择解决方案，因为将来某个时候可能需要。我将保留所有这些建议，如果在应用程序的生命周期内明确需要他们提供的一个或多个功能，我将重新考虑这个想法。现在，我真的认为这是一个矫枉过正。至少在我看来，拥有**最终用户可以根据需要编辑的**完整模板是麻烦多于好处。尽管如此，知道我没有走这条路的原因感觉要好得多，而不是不研究任何东西并选择它。

非常感谢所有输入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-01T21:36:53.783

使用真正的模板工具：[mako](http://www.makotemplates.org/)或[jinja](http://jinja.pocoo.org/)。不要自己滚。不值得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T21:39:26.757

有一个轻量级的模板系统......我不确定你是否可以使用 TurboGears 提供的一些（Kid 或 Genshi）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T12:56:21.670

我会推荐[jinja2](http://jinja.pocoo.org/2/)。

它不应该产生运行时性能问题，因为它将模板编译为 python。它将提供更大的灵活性。至于*可维护性*；它在很大程度上取决于编码器，但从理论上（并且诚然表面上）我不明白为什么它应该更难维护。

多做一点工作，您就可以让精通技术的用户自己定义替换样式。或者从您提供的默认值中选择一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T13:27:39.267

您可以尝试 Python 2.6/3.0 的新 str.format() 方法：[http ://docs.python.org/library/string.html#formatstrings](http://docs.python.org/library/string.html#formatstrings)

这看起来与 %-formatting 有点不同，并且可能不像 Python 那样容易识别：

```
'fish{chips}'.format(chips= 'x') 
```

# python - 如果列表中的所有内容 == 某事

> ID：405516
> 
> 赞同：33
> 
> 时间：2009-01-01T21:41:22.543
> 
> 标签：python, python-2.6

使用 Python 2.6，有没有办法在一个语句中检查序列的所有项目是否等于给定值？

```
[pseudocode]
my_sequence = (2,5,7,82,35)

if all the values in (type(i) for i in my_sequence) == int:
     do() 
```

而不是，说：

```
my_sequence = (2,5,7,82,35)
all_int = True
for i in my_sequence:
    if type(i) is not int:
        all_int = False
        break

if all_int:
    do() 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-01T21:45:31.037

采用：

```
all( type(i) is int for i in lst ) 
```

例子：

```
In [1]: lst = range(10)
In [2]: all( type(i) is int for i in lst )
Out[2]: True
In [3]: lst.append('steve')
In [4]: all( type(i) is int for i in lst )
Out[4]: False 
```

[编辑]。根据评论变得更干净。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-01T21:43:29.697

你的意思是

```
all( type(i) is int for i in my_list ) 
```

?

编辑：更改为`is`. 稍微快一点。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-01T23:06:42.167

我会建议：

```
if all(isinstance(i, int) for i in my_list): 
```

[`all`](https://docs.python.org/3/library/functions.html#all)并[`any`](https://docs.python.org/3/library/functions.html#any)于 2006 年首次出现在[Python 2.5 中（由 Raymond Hettinger 实现的功能）](https://docs.python.org/3/whatsnew/2.5.html#other-language-changes)。
如果您使用的是旧版本的 Python，这些链接提供了示例实现。

我还建议使用[`isinstance`](https://docs.python.org/3/library/functions.html#isinstance)，因为它还会捕获`int`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-10T20:13:05.680

为了完整起见，我想我会补充一个事实，即 NumPy 的“全部”与内置的“全部”不同。例如，如果通过 Python(x,y) 运行 Python，NumPy 会自动加载（据我所知无法卸载），因此在尝试运行上述代码时会产生相当意外的结果：

```
>>> if (all(v == 0 for v in [0,1])):
...     print 'this should not happen'
... this should not happen 
```

有关这方面的更多信息，请参阅 Stack Overflow 问题*[numpy all 与 builtin all 不同](https://stackoverflow.com/questions/14391501/numpy-all-differing-from-builtin-all)*。作为一种解决方案，您可以用括号将生成器括起来以生成列表：

```
>>> all( [v == 0 for v in [0,1]] )
False 
```

或者显式调用内置函数：

```
>>> __builtins__.all(v == 0 for v in [0,1,'2'])
False 
```

我找到了一种阻止 Spyder 默认导入 NumPy 的方法： *[Spyder 默认模块导入列表](https://stackoverflow.com/questions/14400993/spyder-default-module-import-list)*

# c# - 如何在单元测试中处理太多的模拟期望？

> ID：405518
> 
> 赞同：1
> 
> 时间：2009-01-01T21:42:20.183
> 
> 标签：c#, tdd, rhino-mocks

我正在用 MVP 模式为我的演示类编写单元测试。但是我在编写模拟设置代码时遇到了麻烦。

我有一个演示者，当调用演示者的 Load 方法时，我想测试视图应该加载类属性、表字段、数据类型、设置演示者......所以当演示者加载时我有不同的事情要做时，我必须添加新的期待测试。并且测试每次都变得越来越大。

```
 [Test]
    public void When_Presenter_Loads_View_Should_Display_Selected_Class_Properties()
    {
        IList<string> dataTypes =new List<string>();
        IClassGenerationView view = mockRepository.StrictMock<IClassGenerationView>();
        tableRepository = mockRepository.Stub<ITableRepository>();

        using(mockRepository.Record())
        {
            SetupResult.For(tableRepository.GetDataTypes()).Return(dataTypes);
            view.Presenter = null;
            LastCall.IgnoreArguments();
            view.DataTypes = dataTypes;
            view.Show();

            view.ClassProperties = classProperties;
            view.TableName = "Table";
            view.Table = table;
            LastCall.IgnoreArguments();
        }

        using(mockRepository.Playback())
        {
            ClassGenerationPresenter presenter = new ClassGenerationPresenter(view, clazz,  tableRepository);
            presenter.Load();
        }
    } 
```

这段代码中是否有代码异味？我该如何改进或简化这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-31T19:41:11.207

多年来我一直在为此苦苦挣扎。起初我使用 MVP 模式，但后来切换到 Presentation Model（类似于 WPF/Silverlight 的 MVVM）。无论如何，结果从来都不是令人满意的，尤其是在 UI 快速变化的敏捷项目中。因此，我们不再为这些类型的类编写测试，而是切换到 SpecFlow/WaTiN 来创建仍然可维护的自动化 UI 测试。在此处阅读更多信息：http: [//www.codeproject.com/Articles/82891/BDD-using-SpecFlow-on-ASP-NET-MVC-Application](http://www.codeproject.com/Articles/82891/BDD-using-SpecFlow-on-ASP-NET-MVC-Application)

如果您仍想为 UI 逻辑编写测试，我绝对不会使用 setup 方法从测试中删除一些内容。您必须能够理解测试的原因和影响，而无需上下浏览。相反，使用更 BDD 风格的单元测试，就像我在这篇博文中解释的那样：http: [//www.dennisdoomen.net/2010/09/getting-more-out-of-unit-testing-in.html](http://www.dennisdoomen.net/2010/09/getting-more-out-of-unit-testing-in.html)

一般来说，我将这些 BDD 风格的测试用于本质上非常管控的类，而对普通类使用更多的 AAA 风格的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T13:00:47.060

经过漫长的不眠之夜和研究，我找到了这个解决方案。当我仔细考虑时，我想出了这个。我在一项测试中测试了太多的行为。我已经改变了这样的测试

```
[TestFixture]
public class When_Presenter_Loads
{
    private MockRepository mockRepository;
    private ITableRepository tableRepository;
    private IClass clazz;
    private Dictionary<string, Type> properties;
    private IClassGenerationView view;
    private ClassGenerationPresenter presenter;

    [SetUp]
    public void Setup()
    {
        mockRepository =new MockRepository();
        properties = new Dictionary<string, Type>();

        clazz = mockRepository.DynamicMock<IClass>();
        view = mockRepository.DynamicMock<IClassGenerationView>();
        tableRepository = mockRepository.Stub<ITableRepository>();

    }

    [Test]
    public void View_Should_Display_Class_Properties()
    {
        using(mockRepository.Record())
        {
            SetupResult.For(clazz.Properties).Return(properties);
            view.ClassProperties = properties;
        }

        using(mockRepository.Playback())
        {
            presenter = new ClassGenerationPresenter(view, clazz, tableRepository);
            presenter.Load();
        }
    }

    [Test]
    public void View_Should_Display_Class_Name_As_A_Table_Name()
    {
        using (mockRepository.Record())
        {
            SetupResult.For(clazz.Name).Return("ClassName");
            view.TableName = "ClassName";
        }

        using (mockRepository.Playback())
        {
            presenter = new ClassGenerationPresenter(view, clazz, tableRepository);
            presenter.Load();
        }
    }

    [Test]
    public void View_Should_Display_SQL_Data_Types()
    {
        List<string> dataTypes = new List<string>();

        using(mockRepository.Record())
        {
            SetupResult.For(tableRepository.GetDataTypes()).Return(dataTypes);
            view.DataTypes = dataTypes;
        }

        using(mockRepository.Playback())
        {
            presenter = new ClassGenerationPresenter(view, clazz, tableRepository);
            presenter.Load();
        }
    }

    [Test]
    public void View_Should_Show_Table()
    {
        using (mockRepository.Record())
        {
            SetupResult.For(clazz.Name).Return("ClassName");
            view.Table = null;
            LastCall.IgnoreArguments();
        }

        using (mockRepository.Playback())
        {
            presenter = new ClassGenerationPresenter(view, clazz, tableRepository);
            presenter.Load();
        }
    }
} 
```

我曾经使用过很多动态模拟来测试一种行为。您也可以阅读 Dave 的[One Mock Per Test](http://laribee.com/blog/2007/08/04/one-mock-per-test/)文章关于此

# windows - Windows Installer 数据库检查？

> ID：405526
> 
> 赞同：4
> 
> 时间：2009-01-01T21:53:26.200
> 
> 标签：windows, installation

有谁知道一个工具可以让我检查安装程序在运行后刚刚添加到系统中的哪些文件？

听起来应该是应该存在的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T22:05:56.097

一个快速的谷歌搜索想出了[Total Uninstall](http://www.softpedia.com/get/Tweak/Uninstallers/Total-Uninstall.shtml)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T22:06:17.250

除非为时已晚，否则您可以使用诸如进程监视器之类的工具或运行带有日志记录的安装程序：

> msiexec /i.msi /log install.log

如果要检查 MSI 数据库，可以从 Windows 安装程序 SDK 运行 ORCA。您可以找到有关已安装文件、注册表和其他操作的信息。

# c - 对通过指针访问结构成员感到困惑

> ID：405537
> 
> 赞同：3
> 
> 时间：2009-01-01T22:05:15.270
> 
> 标签：c, pass-by-value

我是 C 新手，对通过指针引用结构成员时得到的结果感到困惑。有关示例，请参见以下代码。当我第一次引用 tst->number 时发生了什么？我在这里缺少什么基本的东西？

```
#include <stdio.h>
#include <stdlib.h>

typedef struct {
   int number;
} Test;

Test* Test_New(Test t,int number) {
    t.number = number;
    return &t;
}    

int main(int argc, char** argv) {    
    Test test;
    Test *tst = Test_New(test,10);
    printf("Test.number = %d\n",tst->number);
    printf("Test.number = %d\n",tst->number);
    printf("Test.number = %d\n",tst->number);
} 
```

输出是：

```
Test.number = 10
Test.number = 4206602
Test.number = 4206602 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-01T22:18:22.733

当您将测试传递给您的 Test_New 函数时，您是按值传递它，因此会在堆栈上为您的 Test_New 函数的函数范围制作一个本地副本。因为你返回了变量的地址，一旦函数返回堆栈就没有用了，但是你返回了一个指向旧堆栈上的结构的指针！所以你可以看到你的第一次调用返回了正确的值，因为没有任何东西覆盖你的堆栈值，但是后续的调用（它们都使用堆栈）会覆盖你的值并给你错误的结果。

为此，请正确重写您的 Test_New 函数以获取指针并将指向结构的指针传递给函数。

```
Test* Test_New(Test * t,int number) {
    t->number = number;
    return t;
}

int main(int argc, char ** argv)  {
   Test test;
   Test * tst = Test_New(&test,10);

   printf("Test.number = %d\n",tst->number);
   printf("Test.number = %d\n",tst->number);
   printf("Test.number = %d\n",tst->number);

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T05:01:44.900

与`struct`此**无关，返回局部变量的地址总是不正确的**。将局部变量的地址放入全局变量或将其存储在堆上分配的对象中通常也是不正确的`malloc`。通常，如果您需要返回指向对象的指针，则需要让其他人为您提供指针，否则您需要使用 分配空间`malloc`，这将返回一个指针。`free`在这种情况下，您的函数的部分 API 必须指定在不再需要对象时由谁负责调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T22:15:32.503

您正在返回的地址`t`方法中声明`Test_New`的地址，而不是`test`您传递给方法的地址。也就是说，`test`它是按值传递的，而您应该传递一个指向它的指针。

所以，当你调用`Test_New`. 创建了一个名为的新`Test`结构并将其设置为等于（您尚未初始化）的值。然后你设置`t``t.number``test.number``t.number`等于`number`你传递给方法的参数，然后你返回的地址`t`。但是`t`是一个局部变量，一旦方法结束就超出范围。因此，您正在返回一个指向不再存在的数据的指针，这就是您最终得到垃圾的原因。

更改声明`Test_New`为

```
Test* Test_New(Test* t,int number) {
    t->number = number;
    return t;
} 
```

并通过调用它

```
Test *tst = Test_New(&test,10); 
```

一切都会如你所愿。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T22:20:34.770

问题是您没有将引用传递给`Test_New`，而是传递了一个值。然后，您将返回*局部变量*的内存位置。考虑这段代码，它演示了您的问题：

```
#include <stdio.h>

typedef struct {
} Test;

void print_pass_by_value_memory(Test t) {
  printf("%p\n", &t);
}

int main(int argc, char** argv) {
  Test test;
  printf("%p\n", &test);
  print_pass_by_value_memory(test);

  return 0;
} 
```

这个程序在我的机器上的输出是：

```
0xbfffe970
0xbfffe950 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-01T22:33:37.133

只是为了扩展 BlodBath 的答案，想想当你这样做时内存中会发生什么。

当您进入主程序时，会在堆栈上创建一个新的自动测试结构，因为它是自动的。所以你的堆栈看起来像

```
    | 主要返回地址 | 将在底部使用
    | 氩气 | 从环境复制到堆栈
    | argv 地址 | 从环境复制到堆栈
-> | 测试号 | 按定义创建测试测试；

```

用`->`指示堆栈指针指向堆栈的最后使用的元素。

现在您调用`Test_new()`，它会像这样更新堆栈：

```
    | 主要返回地址 | 将在底部使用
    | 氩气 | 从环境复制到堆栈
    | argv 地址 | 从环境复制到堆栈
    | 测试号 | 按定义创建测试测试；
    | 返回 Test_new 的地址| 用于返回底部
    | test.number 的副本 | 复制到堆栈中，因为 C 总是使用按值调用
-> | 10 | 复制到堆栈

```

当您返回`&t`时，您将获得哪个地址？答：堆栈上数据的地址。但是然后你返回，堆栈指针递减。当您调用 时`printf`，堆栈上的那些单词会被重新使用，但您的地址仍然指向它们。碰巧，堆栈中该位置的*数字*（解释为地址）指向的值为 4206602，但这纯属偶然；事实上，这是一种倒霉，因为*好运*会导致分段错误，让您知道某些东西实际上被破坏了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-02T10:21:42.867

****在Test_New()***中声明的***测试 t***是一个局部变量。您正在尝试返回局部变量的地址。一旦函数存在，局部变量就会被销毁，内存将被释放，这意味着编译器可以自由地将其他值放在保存局部变量的位置。*

 *在您的程序中，当您第二次尝试访问该值时，内存位置可能已分配给不同的变量或进程。因此，您得到了错误的输出。

对您来说更好的选择是通过引用而不是通过值从 main() 传递结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-01T22:22:46.547

您已将 test by value 的内容传递给 Test_New。当您调用 Test_New 时，IOW 已在堆栈上分配了一个新的测试结构副本。它是您从函数返回的此测试的地址。

当您第一次使用 tst->number 时，将检索 10 的值，因为尽管该堆栈已展开，但尚未对该内存进行其他使用。然而，一旦第一个 printf 被调用，堆栈内存就会被重新用于它需要的任何东西，但 tst 仍然指向该内存。因此 tst->number 的后续使用会检索 printf 留在该内存中的任何内容。

在函数签名中使用 Test &t 。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-02T05:57:22.417

你可以做这样的事情来使它更容易一点：

```
typedef struct test {
   int number;
} test_t;

test_t * Test_New(int num)
{
   struct test *ptr;

   ptr = (void *) malloc(sizeof(struct test));
   if (! ptr) {
     printf("Out of memory!\n");
     return (void *) NULL;
   }

   ptr->number = num;

   return ptr;
}

void cleanup(test_t *ptr)
{
    if (ptr)
     free(ptr);
}

....

int main(void)
{
    test_t *test, *test1, *test2;

    test = Test_New(10);
    test1 = Test_New(20);
    test2 = Test_new(30);

    printf(
        "Test (number) = %d\n"
        "Test1 (number) = %d\n"
        "Test2 (number) = %d\n",
        test->number, test1->number, test2->number);
    ....

    cleanup(test1);
    cleanup(test2);
    cleanup(test3);

    return 0;
} 
```

...正如您所看到的，它很容易为几个完全不同的 test_t 实例分配空间，例如，如果您需要保存一个的现有状态以便以后可以恢复.. 或出于任何原因。

除非，当然有某些原因必须将其保留在本地.. 但我真的想不出一个。

# python - 循环数据结构有什么用？

> ID：405540
> 
> 赞同：14
> 
> 时间：2009-01-01T22:06:09.903
> 
> 标签：python, data-structures, recursion, cyclic-reference

我刚刚阅读[了 Mark Lutz 的“Learning Python”并遇到了这个代码示例](http://books.google.com/books?id=1HxWGezDZcgC&lpg=PP1&dq=learning%20python&pg=PA254#v=onepage&q=cyclic&f=false)：

```
 >>> L = ['grail']
>>> L.append(L)
>>> L
['grail', [...]] 
```

它被识别为循环数据结构。

所以我想知道，这是我的问题：

## **在现实生活中的编程中使用的“循环数据结构”是什么？**

似乎有点混乱，我认为这源于非常简短的代码示例......这里还有几行使用相同的对象 L

```
 >>> L[0]
'grail'
>>> L[1][0]
'grail'
>>> L[1][1][0]
'grail' 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-01T22:17:30.567

许多事。循环缓冲区，例如：你有一些数据集合，前面和后面，但是任意数量的节点，最后一个“下一个”项目应该带你回到第一个。

图结构通常是循环的；非周期性是一种特殊情况。例如，考虑一个包含旅行商问题中所有城市和道路的图。

* * *

好的，这是给你的一个特别的例子。我在科罗拉多州建立了一系列城镇：

```
V=["Boulder", "Denver", "Colorado Springs", "Pueblo", "Limon"] 
```

然后，我建立了成对的城市，其中有一条连接它们的道路。

```
E=[["Boulder", "Denver"],
   ["Denver", "Colorado Springs"],
   ["Colorado Springs", "Pueblo"],
   ["Denver", "Limon"],
   ["Colorado Springs", "Limon"]] 
```

这有一堆循环。例如，您可以从科罗拉多斯普林斯开车到利蒙，再到丹佛，然后再返回科罗拉多斯普林斯。

如果创建一个数据结构，其中包含 V 中的所有城市和 E 中的所有道路，那就是*图*数据结构。该图将具有循环。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-01T22:21:42.600

我最近创建了一个循环数据结构来表示八个基数和序数方向。它对每个方向了解其邻居很有用。例如，Direction.North 知道 Direction.NorthEast 和 Direction.NorthWest 是它的邻居。

这是循环的，因为每个邻居都知道它的邻居，直到它全力以赴（“->”代表顺时针）：

北 -> 东北 -> 东 -> 东南 -> 南 -> 西南 -> 西 -> 西北 -> 北 -> ...

注意我们回到了北方。

这允许我做这样的事情（在 C# 中）：

```
public class Direction
{
    ...
    public IEnumerable<Direction> WithTwoNeighbors
    {
        get {
           yield return this;
           yield return this.CounterClockwise;
           yield return this.Clockwise;
        }
    }
}
...
public void TryToMove (Direction dir)
{
    dir = dir.WithTwoNeighbors.Where (d => CanMove (d)).First ()
    Move (dir);
} 
```

事实证明，这非常方便，并且使很多事情变得不那么复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T22:18:04.310

可以在垃圾收集器的测试用例中使用嵌套结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T21:58:11.030

这有点令人困惑，因为它是一个包含自身的列表，但我理解它的方式是不要将 L 视为一个列表，而是一个节点，而不是列表中的事物，您将其视为其他此节点可访问的节点。

举一个更真实的例子，把它们想象成一个城市的飞行路径。

所以芝加哥 = [丹佛，洛杉矶，纽约市，芝加哥]（实际上你不会列出芝加哥本身，但为了举例，你可以从芝加哥到达芝加哥）

然后你有 denver = [phoenix, philedelphia] 等等。

凤凰 = [芝加哥，纽约市]

现在你有来自的循环数据

> 芝加哥 -> 芝加哥

但是也

> 芝加哥 -> 丹佛 -> 凤凰城 -> 芝加哥

现在你有：

```
chicago[0] == denver
chicago[0][0] == phoenix
chicago[0][0][0] == chicago 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T22:38:53.210

`L`仅包含对自身的引用作为其元素之一。这没什么特别的。

循环结构有一些明显的用途，其中最后一个元素知道第一个元素。但是这个功能已经被常规的 python 列表所覆盖。

您可以`L`使用`[-1]`. 您可以使用 python 列表作为队列，使用`append()`和`pop()`。您可以拆分 python 列表。这是循环数据结构的常规用途。

```
>>> L = ['foo', 'bar']
>>> L.append(L)
>>> L
['foo', 'bar', [...]]
>>> L[0]
'foo'
>>> L[1]
'bar'
>>> L[2]
['foo', 'bar', [...]]
>>> L[2].append('baz')
>>> L
['foo', 'bar', [...], 'baz']
>>> L[2]
['foo', 'bar', [...], 'baz']
>>> L[2].pop()
'baz'
>>> L
['foo', 'bar', [...]]
>>> L[2]
['foo', 'bar', [...]] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T23:35:20.757

[确定性有限自动机](http://en.wikipedia.org/wiki/Deterministic_Finite_Automaton)迭代的数据结构通常是循环的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-01T22:17:08.897

一个例子是最后一项指向第一项的链表。这将允许您创建固定数量的项目，但始终能够获得下一个项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-01T22:17:42.157

在进行晶格模拟时，经常使用循环/环形边界条件。通常一个简单的`lattice[i%L]`就足够了，但我想可以将晶格创建为循环的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-01T22:37:49.637

假设您的存储空间有限，并且数据不断累积。在许多现实生活中，您不介意删除旧数据，但您不想移动数据。您可以使用循环向量；使用具有两个特殊索引的大小为 N 的向量 v 实现：开始和结束，它们从 0 开始。

现在插入“新”数据如下：

```
v[end] = a;
end = (end+1) % N;
if (begin == end)
  begin = (begin+1) % N; 
```

您可以以类似的方式插入“旧”数据并删除“旧”或“新”数据。扫描矢量是这样的

```
for (i=begin; i != end; i = (i+1) % N) {
 // do stuff
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T21:27:11.453

循环数据结构通常用于表示循环关系。这听起来很明显，但它发生的次数比你想象的要多。我想不出任何时候我使用过非常复杂的循环数据结构，但双向关系相当普遍。例如，假设我想做一个 IM 客户端。我可以做这样的事情：

```
class Client(object):
    def set_remote(self, remote_client):
        self.remote_client = remote_client

    def send(self, msg):
        self.remote_client.receive(msg)

    def receive(self, msg):
        print msg

Jill = Client()
Bob = Client()
Bob.set_remote(Jill)    
Jill.set_remote(Bob) 
```

然后，如果 Bob 想给 Jill 发送消息，你可以这样做：

```
Bob.send("Hi, Jill!") 
```

当然，Jill 可能想发回一条消息，所以她可以这样做：

```
Jill.send("Hi, Bob!") 
```

诚然，这是一个人为的例子，但它应该为您提供一个示例，说明您何时可能想要使用循环数据结构。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T21:32:23.500

任何类型的对象层次结构，其中父母了解他们的孩子，孩子了解他们的父母。我总是不得不在 ORM 中处理这个问题，因为我希望数据库知道它们的表和表以知道它们是哪个数据库的一部分，等等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T07:00:04.310

让我们看一个实际的例子。

假设我们正在为游戏编写菜单导航。我们要为每个菜单项存储

1.  条目的名称
2.  按下后我们将到达的另一个菜单。
3.  按下菜单时将执行的操作。

当一个菜单项被按下时，我们将激活菜单项动作，然后移动到下一个菜单。所以我们的菜单将是一个简单的字典列表，如下所示：

```
options,start_menu,about = [],[],[]

def do_nothing(): pass

about += [
    {'name':"copyright by...",'action':None,'menu':about},
    {'name':"back",'action':do_nothing,'menu':start_menu}
    ]
options += [
    {'name':"volume up",'action':volumeUp,'menu':options},
    {'name':"save",'action':save,'menu':start_menu},
    {'name':"back without save",'action':do_nothing,'menu':start_menu}
    ]
start_menu += [
    {'name':"Exit",'action':f,'menu':None}, # no next menu since we quite
    {'name':"Options",'action':do_nothing,'menu':options},
    {'name':"About",'action':do_nothing,'menu':about}
    ] 
```

看看如何`about`循环：

```
>>> print about
[{'action': None, 'menu': [...], 'name': 'copyright by...'},#etc.
# see the ellipsis (...) 
```

当按下菜单项时，我们将发出以下点击功能：

```
def menu_item_pressed(item):
    log("menu item '%s' pressed" % item['name'])
    item['action']()
    set_next_menu(item['menu']) 
```

现在，如果我们没有循环数据结构，我们将无法拥有指向自身的菜单项，例如，在按下音量增大功能后，我们将不得不离开选项菜单。

如果循环数据结构不可能，我们必须自己实现它，例如菜单项是：

```
class SelfReferenceMarkerClass: pass
#singleton global marker for self reference
SelfReferenceMarker = SelfReferenceMarkerClass()
about += [
    {'name':"copyright by...",'action':None,'menu':srm},
    {'name':"back",'action':do_nothing,'menu':start_menu}
    ] 
```

该`menu_item_pressed`功能将是：

```
def menu_item_pressed(item):
    item['action']()
    if (item['menu'] == SelfReferenceMarker):
        set_next_menu(get_previous_menu())
    else:
        set_next_menu(item['menu']) 
```

第一个例子更好一点，但是是的，不支持自我引用并不是什么大不了的恕我直言，因为很容易克服这个限制。

菜单示例就像一个带有自引用的图，我们通过顶点指针列表存储图（每个顶点都是指向其他顶点的指针列表）。在这个例子中，我们需要自边（一个指向自身的顶点），因此 python 对循环数据结构的支持很有用。

# .net - C# - 都是枚举常量吗？

> ID：405548
> 
> 赞同：13
> 
> 时间：2009-01-01T22:10:48.177
> 
> 标签：.net, enums

所有 Enum 枚举都是常量吗？它们**是在编译时**还是在运行时转换为它们的值？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-01T22:12:36.143

它们是恒定的。是的，编译时间。

参考：http: [//msdn.microsoft.com/en-us/library/sbbt4032.aspx](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)

从介绍：

> enum 关键字用于声明一个枚举，一种由一组 称为枚举数列表的**命名常量组成的独特类型。**

在“鲁棒编程”下：

> 与任何常量一样，对枚举的各个值的所有引用都**在编译时转换为数字文字**。这可能会产生潜在的版本控制问题，如常量（C# 编程指南）中所述。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-01T22:13:07.797

枚举值是常量，它们不能改变。

它们的值在编译时是固定的。

# visual-studio - 如何获取 t4 文件以在 Visual Studio 中构建？

> ID：405560
> 
> 赞同：14
> 
> 时间：2009-01-01T22:15:11.133
> 
> 标签：visual-studio, t4

当我构建我的 c# 解决方案时，.tt 文件不会创建 .cs 文件输出。但是，如果我在解决方案资源管理器中一次一个地右键单击 .tt 文件并选择“运行自定义工具”，则会生成 .cs，因此构建工具设置是正确的。我该怎么做才能构建整体解决方案以强制自定义工具在 .tt 文件上运行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-02T01:18:28.343

Paul，您还可以在构建时使用[TextTransform.exe](http://msdn.microsoft.com/en-us/library/bb126245.aspx)或[Elton Stoneman 的 MSBuild 任务](http://geekswithblogs.net/EltonStoneman/archive/2008/07/25/an-msbuild-task-to-execute-t4-templates.aspx)生成代码。请记住，当 T4 在 Visual Studio 和命令行主机中运行时，内置指令（如[程序集](http://www.olegsych.com/2008/02/t4-assembly-directive/)和[包含）的行为是不同的。](http://www.olegsych.com/2008/02/t4-include-directive/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T22:48:33.513

回答我自己的问题，它们应该根据这个讨论在设计时生成：

[https://web.archive.org/web/20081227142303/http://www.olegsych.com/2008/02/t4-template-directive/](https://web.archive.org/web/20081227142303/http://www.olegsych.com/2008/02/t4-template-directive/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-21T15:29:16.640

在 Visual Studio 2017（也可能是下一个版本）中，您应该在 Pre-build 事件中添加它：

```
"$(DevEnvDir)TextTransform.exe" -out "$(ProjectDir)YourTemplate.cs" "$(ProjectDir)YourTemplate.tt" 
```

ps 唯一对我有用的解决方案。

pss 如果模板不在根项目目录中，请更改模板的路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-08T22:50:23.833

在 Visual Studio 2013 中，我只需将这些行添加到 .csproj 文件中，就可以让 .tt 文件重新生成它们的目标：

```
<PropertyGroup>
  <!-- Get the Visual Studio version – defaults to 10: -->
  <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
  <!-- Keep the next element all on one line: -->
  <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
</PropertyGroup>
<!-- To enable build tasks on your development computer, install Modeling SDK for Visual Studio. https://www.microsoft.com/en-us/download/details.aspx?id=40754 -->
<Import Project="$(VSToolsPath)\TextTemplating\Microsoft.TextTemplating.targets" />
<!-- Run the Transform task at the start of every build -->
<PropertyGroup>
  <TransformOnBuild>true</TransformOnBuild>
</PropertyGroup>
<!-- Overwrite files that are read-only, for example because they are not checked out -->
<PropertyGroup>
  <OverwriteReadOnlyOutputFiles>true</OverwriteReadOnlyOutputFiles>
</PropertyGroup>
<!-- Transform every template every time -->
<PropertyGroup>
  <TransformOutOfDateOnly>false</TransformOutOfDateOnly>
</PropertyGroup> 
```

但是，要使其正常工作，您需要安装[Visual Studio 的 Modeling SDK](https://www.microsoft.com/download/details.aspx?id=40754)。我在此页面上找到了所有这些信息以及可用选项的更完整描述：[构建过程中的代码生成](https://msdn.microsoft.com/en-us/library/ee847423.aspx)。

# php - 帮助复选框和数据库

> ID：405574
> 
> 赞同：0
> 
> 时间：2009-01-01T22:25:42.203
> 
> 标签：php

请我帮助我是一个初学者

我有一个带有复选框的表格。当复选框被选中时，每个都有一个值，它的值被添加到总和中......我想将选中的复选框保存到数据库中。

```
<script type="text/javascript">
    function checkTotal() {
        document.listForm.total.value = '';
        var sum = 0;
        for (i=0;i<document.listForm.choice.length;i++) {
          if (document.listForm.choice[i].checked) {
            sum = sum + parseFloat(document.listForm.choice[i].value);
          }
        }
        document.listForm.total.value = sum;
    }
</script>

<form name="listForm" method="post" action="insert_options.php" >
<TABLE cellPadding=3 width=600 border=0>
        <TBODY>

        <TR>
          <TH align=left width="87%" bgColor=#b0b3b4><SPAN 
            class=whiteText>Item</SPAN></TH>
          <TH align=right width="13%" bgColor=#b0b3b4><SPAN 
            class=whiteText>Select</SPAN></TH></TR>
        <TR>
          <TD  bgcolor="#9da8af"colSpan=2><SPAN class=normalText><B>General</B></SPAN></TD></TR>
        <TR>
          <TD  bgcolor="#c4c8ca"><SPAN class=normalText >TEAK SIDE DECKS (2889)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="2889" type="checkbox" onchange="checkTotal()" /></TD></TR>
        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>LEAD DEEP KEEL (1825)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="1825" type="checkbox" onchange="checkTotal()"></TD></TR>

        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>FULLY BATTENED MAINSAIL (558)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="558"  type="checkbox"  onchange="checkTotal()"></TD></TR>

        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>HIGH TECH SAILS FOR CONVENTIONAL RIG (1979)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="1979" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>IN MAST REEFING WITH HIGH TECH SAILS (2539)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="2539" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>SPlNNAKER GEAR (POLE LINES DECK FITTINGS) (820)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="820" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>SPINNAKER POLE VERTICAL STOWAGE SYSTEM (214)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="214" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>GAS ROD KICKER (208)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="208" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>SIDE RAIL OPENINGS (BOTH SIDES) (392)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="392" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>SPRING CLEATS MIDSHIPS -ALUMIMIUM (148)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="148" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>ELECTRIC ANCHOR WINDLASS (1189)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="1189" type="checkbox" onchange="checkTotal()"> </TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>ANCHOR CHAIN GALVANISED (50m) (202)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="202" type="checkbox" onchange="checkTotal()"> </TD></TR>

          <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>ANCHOR CHAIN GALVANISED (50m) (1141)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="1141" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD  bgcolor="#9da8af"colSpan=2><SPAN class=normalText><B>NAVIGATION & ELECTRONICS</B></SPAN></TD></TR>
        <TR>
          <TD  bgcolor="#c4c8ca"><SPAN class=normalText >WIND VANE (STAINLESS STEEL)(41)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="41" type="checkbox" onchange="checkTotal()" /></TD></TR>
        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>RAYMARINE ST6O LOG & DEPTH (SEPARATE UNITS)(226)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="226" type="checkbox" onchange="checkTotal()"></TD></TR>

      <TR>
          <TD  bgcolor="#9da8af"colSpan=2><SPAN class=normalText><B>ENGINES & ELECTRICS</B></SPAN></TD></TR>
        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>SHORE SUPPLY (220V) WITH 3 OUTLETS (EXCLUDJNG SHORE CABLE) (327)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="327"  type="checkbox"  onchange="checkTotal()"></TD></TR>

        <TR>
          <TD bgColor=#c4c8ca><SPAN class=normalText>3rd BATTERY(14OA/H)(196)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="196" type="checkbox" onchange="checkTotal()"></TD></TR>

         <TD bgColor=#c4c8ca><SPAN class=normalText>24 AMP BATTERY CHARGER (475)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="475" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>2 BLADED FOLDING PROPELLER (UPGRADE)(299)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="299" type="checkbox" onchange="checkTotal()"></TD></TR>

         <TR>
          <TD  bgcolor="#9da8af"colSpan=2><SPAN class=normalText><B>BELOW DECKS/DOMESTIC</B></SPAN></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>WARM WATER (FROM ENGINE & 220V)(749)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="749" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>SHOWER IN AFT HEADS WITH PUMPOUT(446)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="446" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>DECK SUCTION DISPOSAL FOR HOLDINGTANK(166)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="166" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>REFRIGERATED COOLBOX (12V)(666)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="666" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>LFS SAFETY PACKAGE (COCKPIT HARNESS POINTS STAINLESS STEEL JACKSTAYS)(208)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="208" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>UPHOLSTERY UPGRADE IN SALOON (SUEDETYPE)(701)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="701" type="checkbox" onchange="checkTotal()"></TD></TR>

          <TR>
          <TD  bgcolor="#9da8af"colSpan=2><SPAN class=normalText><B>NAVIGATION ELECTRONICS & ELECTRICS</B></SPAN></TD></TR>

          <TD bgColor=#c4c8ca><SPAN class=normalText>VHF RADIO AERIAL CABLED TO NAVIGATION AREA(178)</SPAN></TD>
          <TD align=right bgColor=#c4c8ca><input  name="choice" value="178" type="checkbox" onchange="checkTotal()"></TD></TR>
</table> 
```

而php代码是

```
<?php

$opt=serialize($_POST['choice']); //takes the data from a post operation...
$query="INSERT INTO options VALUES('$opt')"; 

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-01T22:43:22.683

首先，您的所有`<input type="checkbox">`字段都具有相同的`name`属性。这会导致发送多个具有相同名称的值（如果选中了多个复选框），PHP 仅将最后一个用于其`$_POST`集合。

为了解决这个问题，给他们命名为“ `choice[]`”，而不是“ `choice`”。这向 PHP 发出信号，表明可能有多个值，并且它们都将作为数组提供。换句话说，您将能够执行以下操作：

```
$choices = $_POST['choice'];
foreach ( $choices as $key => $value )
    echo "$key  => $value"; 
```

这将输出类似

```
0 => 32
1 => 12
2 => 48 
```

换句话说 - 你得到一个包含选中复选框值的数组。之后，您可以对他们做您喜欢的事情。例如，`implode()`他们得到一个逗号分隔的列表。

不过，您应该警告一件事。它被称为“SQL 注入”，是没有经验的程序员的常见错误。这个想法是恶意用户也可以轻松地在那里发送其他值，而不仅仅是您在 HTML 中指定的值。伪造 HTTP 请求不需要太多技巧。可能有来自用户的任何东西，所以你应该**总是****检查**你从用户那里得到的**所有输入。**不要相信您所做的任何 JavaScript 验证。只要它来自用户端 - 它就不能被信任。曾经。

如果你想知道这怎么可能是一件坏事 - 考虑一下，如果你的数组中的某个值突然`43`不再存在，而是变成“ **`'); DROP DATABASE; --`**”，会发生什么。

由于您盲目地执行查询，例如

```
INSERT INTO options VALUES('$opt'); 
```

这将变成

```
INSERT INTO options VALUES(''); DROP DATABASE; --); 
```

再见了你的数据库。因此，请**始终**确保用户输入是您所期望的，并且不会出现这样的情况。哦，是的 -`addslashes()`这不是一个好方法，因为仍然有办法解决这个问题。参数化查询是最好的方法，但如果你不能使用它，那么至少使用`mysql_real_escape_string()`MySQL，或者你的 DBMS 提供的任何其他东西。

# open-source - 是否有受支持的 CodePlex 许可证限制将源用于商业？

> ID：405581
> 
> 赞同：10
> 
> 时间：2009-01-01T22:29:32.693
> 
> 标签：open-source, licensing, codeplex

我一直在阅读 CodePlex 支持的开源许可证，我不太了解所有内容，我正在寻找的是一个限制我的源代码商业使用的许可证。

有吗？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-02T00:18:57.637

你为什么要这样做？这不是开源精神！甚至 GPL也[允许](http://www.gnu.org/philosophy/selling.html)甚至[鼓励](http://www.interesting-people.org/archives/interesting-people/200001/msg00055.html)商业供应商付费分发免费（开源）软件。大量的开源软件是商业生产的（许多对 Linux、GNOME、KDE ​​的贡献），如果有这样的条款是不可能的。

[CodePlex 是微软的开源[项目托管](http://en.wikipedia.org/wiki/Comparison_of_open_source_software_hosting_facilities)站点：它相当于 Sourceforge、Google Code、Savannah、Launchpad 等。该[网站称它支持](http://www.codeplex.com/CodePlex/Wiki/View.aspx?title=CodePlex%20FAQ#License)以下许可证：

> Apache 许可证 2.0、通用开发和分发许可证 (CDDL)、Eclipse 公共许可证 (EPL)、GNU 通用公共许可证 (GPL) v2、GNU 库通用公共许可证 (LGPL)、微软公共许可证 (Ms-PL)、微软互惠许可证(Ms-RL)、Mozilla 公共许可证 1.1 (MPL)、新 BSD 许可证和 MIT 许可证。

其中以 "Microsoft" 开头的[实际上可能比 "open-source" 更具限制性](http://www.theregister.co.uk/2008/10/03/codeplex_licenses/)。

[让我用Dave Johnson 的话](http://rollerweblogger.org/roller/entry/gimme_credit_gimme_fixes_gimme)来解释开源许可证的“三个层次” ：

*   *级别 1：**给予我信用**（Apache 许可证、BSD、MIT） 您可以在您的产品中使用、修改和重新分发我的代码，但请给予我信用。*
*   *级别 2：给**我修复**（Mozilla 公共许可证、CDDL、LGPL） 您可以在您的产品中使用、修改和重新分发我的代码，但请给我您对它所做的任何修复的源代码。*
*   *第 3 级：**全都给我！**(GPL) 您可以在您的产品中使用、修改和重新分发我的代码，但请给我您的整个产品的源代码。*

前两个级别允许公司从您的代码中制作专有（非开源）衍生产品；我不喜欢他们。GPL（“copyleft”）强制他们发布源代码（仅适用于他们*分发*产品的情况；没有什么能阻止他们在内部使用该软件供自己使用——这是一件好事）。如果您想避免感觉被商业公司“窃取”您的代码“敲竹杠”，那么您应该使用 GPL。他们可以对其进行改进，但每个人都可以使用这些改进。

请注意，这一切都不会阻止公司单独联系您并根据非 GPL 许可获取您的代码——如果您愿意，您可以向他们收取费用以允许他们制作您的代码的专有衍生品。（当然，只要您的代码完全由您自己提供。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T15:16:20.500

谢谢，如果您限制代码的商业用途，您将鼓励免费的开源项目，这是我最初的想法，但现在我将考虑使用 Mozilla 公共许可证。

# mysql - 使用带有规定值的 MySQL 的 IN 子句

> ID：405583
> 
> 赞同：2
> 
> 时间：2009-01-01T22:31:18.307
> 
> 标签：mysql

我正在尝试编写一个查询，如果某个列在我提供的列表中有值，则更新表中的行：

```
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 IN ('x', 'y', 'z'); 
```

我收到语法错误，但我知道这应该是可能的。它本质上是一个执行以下 3 个命令的命令：

```
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 = 'x';
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 = 'y';
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 = 'z'; 
```

值 xyz 是由用户动态设置的，并且可能有任意数量的值（或者我只是用冗长而糟糕的方式对其进行编码并完成它。我可以在*IN*子句中找到的唯一信息是有关有子查询有人可以帮我重写这个查询吗？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T23:34:24.827

您应该发布*准确*的错误消息。错误消息将提供有关查询的哪个部分混淆了解析器的线索。

某些值 x、y、z 是否包含引号作为值的一部分？你可能有不平衡的报价。例如，以下显然是一个语法错误：

```
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 IN ('O'Reilly', 'Smith', 'Jones'); 
```

提供更多信息，我将使用更多故障排除建议编辑此答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T00:49:18.730

所以现在大家都告诉我要找不平衡的报价，我更仔细地查看了查询，发现如下：

```
UPDATE BOOK SET INVOICE_ID TO '1' WHERE START_NUMBER IN (1) 
```

应该是：

```
UPDATE BOOK SET INVOICE_ID = '1' WHERE START_NUMBER IN (1) 
```

不过，感谢所有帮助，但现在我感觉很好，很愚蠢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T22:42:11.343

那是您的完整更新查询吗？看起来它缺少结尾部分。缺少丢失的位，它看起来不错。您可以发送您收到的实际错误消息吗？

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-01T23:09:56.030

我很确定您不需要引用各个值。

```
UPDATE MY_TABLE SET COL1 = 'xyz' WHERE COL2 IN ('x, y, z'); 
```

这也总是让我着迷。

如果值是数字，则根本不需要引号。

# rest - What RESTful API would you use for a turn-based game server?

> ID：405588
> 
> 赞同：13
> 
> 时间：2009-01-01T22:34:54.663
> 
> 标签：rest, chess

How would you model a turn-based game server as a RESTful API? For example, a chess server, where you could play a game of chess against another client of the same API. You would need some way of requesting and negotiating a game with the other client, and some way of playing the individual moves of the game.

Is this a good candidate for a REST (RESTful) API? Or should this be modelled a different way?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T01:09:35.680

I'm thinking something like:

```
/game/<gameID>/move/<moveID> 
```

as far as the basic resources are concerned. I'm not sure how to handle the "has the other player moved yet?" idea, though. I've thought about simply having the GET request block until the move is played--i.e. my client would PUT the coordinates of my move to

```
/game/13/move/1 
```

and then would GET

```
/game/13/move/2 
```

The server would not respond immediately, but keep the connection open until the other player moved (i.e. PUT to that location). Is this what nakajima is referring to as "comet-esque"?

Charlie, I'm not quite sure what you meant by the "token" for whose turn it is--does this solve the same problem without the need for polling or a blocking connection?

For player IDs, does it make sense to model those as a resource in part of the URL? I was planning to simply use HTTP user authentication (where the user/pass is sent as part of every request). You could still GET most resources without authentication, but if you tried to, say,

```
PUT /game/13/move/2 
```

it would give you a permission denied error if you didn't have the correct credentials for that game.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-02T02:32:22.720

OKay, the basic idea of REST is that you're transferring the state; you want to have little or no "session state" on the server. So you wouldn't want to use session state and a keepalive, which is what Comet does. But think about the example of a play-by-mail game: You both have a copy of the board, and you exchange moves. The Post Office doesn't know about the game.

Now, I'll admit this is growing in my mind as I think about it -- in fact, I may write an article based on this question -- but here's the idea, as some stories:

1.  You want to play a game of chess on line, so you go to a known URI to get one. You get back a page showing who, if anyone, is waiting to start a game.
2.  You pick one of the people waiting to play, and click the appropriate link. You get a new display (ajax magic in here if you want) with the board set up. One of you is white, white moves first.
3.  Whoever has the right to move enters a move, and commits (like taking your hand off the piece in a game.) The board updates and the right to move goes to the other player.

You don't need anything much in terms of server state --- although you might want to extend this by keeping track of moves etc, say for ranking -- and the question of who has the right to move can be computed entirely from the board page: if you have the right, you have a form for entering a move; when you send the form return back, the response returns a page to you with no slot for entering a move.

By "the token" I just mean some arbitrary representation of that one bit of state "My move"/"your move".

Seems as if the resources you need are

*   A "find a game" home page
*   A user page if you're tracking stats and such
*   a unique URI for every active game.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-01T22:46:35.220

What are the resources you're trying to model? I would seem to have four: You, your opponent, the particular game (session, instance) and the game board state. So it would start with something like

```
/game
/game/gameID/gamer/gamerID
/game/gameID/board 
```

we've got a good intro/overview on [InfoQ](http://www.infoq.com/articles/rest-introduction).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-17T17:18:09.620

I don't think REST is a good choice for such an application. The transformations and operations you need to do (make move, view move history, undo, get suggestion, turn notification) do not map neatly to REST's concept of resources. (The difficulties are perhaps more obvious if one considers how a RESTful API for more complicated turn-based games such as Scrabble or Monopoly might look.)

I think any sensible REST API would probably end up being a wrapper around something non-RESTful, such as a stateful protocol that sent [portable game notation](http://en.wikipedia.org/wiki/Portable_Game_Notation) back and forth.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-02T03:06:18.563

Thanks, Charlie. I'm still not clear how you get notified of the opponent's move in your scheme. Of course the question of who has the right to move can be computed simply--either from the board resource, or by using a separate resource that explicitly states whose turn it is to move. But how does a client know that this resource has changed? Does it have to simply continually poll, remembering the previous state, until it notices something has changed? In the Post Office model, the Post Office "pushes" a message to the client (your mailbox), which is not possible in HTTP.

I suppose this is part of a more general question: if there is a REST resource that I want to monitor for changes or modifications, what is the best way to do so? And is there something the server can do to make this easier for the client?

I think I'll actually post this as a separate question since I think it's interesting by itself.

Edited to add: [What is a RESTful way of monitoring a REST resource for changes?](https://stackoverflow.com/questions/405950/what-is-a-restful-way-of-monitoring-a-rest-resource-for-changes)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-02T18:59:54.823

One of the developers in [planet.jabber](http://planet.jabber.org/) is involved in [Chesspark](http://www.chesspark.com/), an online chess community. They are using Jabber/XMPP extensively; if I'm not mistaken, [these are his posts on the subject](http://metajack.wordpress.com/category/chesspark/).

XMPP is an instant-messaging protocol, roughly based on small XML message exchange. There are libraries for most languages, *including* Javascript. I'm not sure it will fit your problem, though.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-01T22:44:34.257

I think you could *model* it RESTfully. *Implementing* it will be more difficult, because you'd either need a [comet](http://en.wikipedia.org/wiki/Comet_(programming)))-esque solution or you'd have to be polling the server at a relatively short interval via AJAX.

In terms of how you'd expose a RESTful interface, I'd say that you need a playing board with coordinates, pieces that can occupy those coordinates, and actions that alter those coordinates.

When a player makes a move, a new action would be created. After validating to make sure it's allowed, you'd update the status of the game, then render whatever response is needed to update the UI.

So that's basically how I'd model it. The implementation side is what I'd consider the bigger difficulty here though.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-01T23:01:28.713

I don't think it's all that complciated, Nakajima. You'd pass data, say in JSON, for the board position, for the moves, and with a token for who has the next move. It'd be exactly like playing by mail.

You start by going to the game and looking for a partner, so

```
/game/ 
```

gives you a list of people waiting. when you come in, if there is no one waiting you get a game ID; otherwise you pick someone waiting and get the game ID they have.

```
/game/gameID 
```

shows you the board. You need something to set up the decision of who plays white, i'll leave that as an exercise. The GET operation gives you the board, so a POST sends a move; if you don't have the move you get an error. You find the result by the next GET.

Hell, in this model I'm not even using the gamer ID, although it might be good so no one can sneak into the game as a kibitzer.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-02T00:55:05.117

So your thought is that instead of making the actions a first class object, each move would be treated as an update of the game itself? It's certainly a different way to do it, though I think I'd prefer to split the action object out into its own first class entity for a couple reasons. The biggest reason is that I believe it's more testable. Whether or not a move is valid could live in the action object, instead of needing to worry about the board being in a valid state at all times. Granted, I don't know what either approach would entail, but this feels better to me.

The other reason, which you can totally refute via YAGNI, is that a first class action object would provide a history of moves. Interesting perhaps, but unless a requirement, is a moot point.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-25T19:26:34.543

For a simple game like chess, it is really just about defining the mediatype.

Here is an example of what is probably an over simplified mediatype to model a chess game.

I'm going to skip the management of multiple games that may be running on the same server and just model an already running game.

The first step is usually to define an index to the application.

`index`

The entry point for the game. Fetch this to discover information about the game.

The payload might look something like this:

```
{
    "links": {
        "self": "http://my-chess-game.host/games/123",
        "player": "http://my-chess-game.host/players/1",
        "player": "http://my-chess-game.host/players/2",
        "me": "http://my-chess-game.host/players/1",
         ...
    }
    "board": [
        {
           "x": 0,
           "y": 1,
           "piece": null,
           "rel": "space",
           "href": "http://my-chess-game/.../boards/123/0/1/something-random-to-discourage-uri-construction"
        },
        {
           "x": 1,
           "y": 2,
           "rel": "space",
           "href": "...",
           "piece": {
               "player": "http://my-chess-game/.../players/1",
               "type": "http://my-chess-game/pieces/Bishop",
               "rel": "piece",
               "href": "http://my-chess-game/games/123/pieces/player1/Bishop/1",
               "links": [
                    { "rel": "move": "href": "http://my-chess-game/.../boards/123/..." },
                    ...
                ]
            }
        },

        ...
    ]
} 
```

`move`

POST a JSON payload to links marked with a `rel` of `move` to move a piece. The following fields MUST be included:

*   location: the URI of the space to move to

Successful responses have a status code of 200 and will contain an entity that the same as the `index` payload with the updated state of the game.

400 if the user is not allowed to move his piece there, or if it isn't his turn.

`player`

GET a description of a player.

The following fields MUST be in the response:

*   username: User name of the player
*   href: URI identifying the player of this game.

`piece`

Pieces are embedded in the `index` payload, but MAY exist on their own. Each `piece` MUST have the following fields:

*   type: A URI identifying the type of the piece. E.G. Bishop, Rook, King. GETing this URI MAY provide information about how this piece works within the game of chess.
*   href: A URI identifying the actual piece on this board. GET requests to this URI MAY provide information about this particular piece.

Each piece MUST have a `move` link.

* * *

An alternative design decision I could have made here was to provide an individual link for every valid move. There may be good reasons to do that, but I wanted to demonstrate that it isn't required. There are probably a handful of other resources that you would want to include to handle things like helping the client determine whose turn it is and whatnot.

For more complicated games, like Civilization, RTSs, FPSs, or MMOGs and what not, this may not be so practical IMO.

# c# - 检测到 ThreadPool WorkItem 已完成/等待完成

> ID：405600
> 
> 赞同：4
> 
> 时间：2009-01-01T22:44:33.133
> 
> 标签：c#, multithreading, asynchronous, concurrency, threadpool

无论出于何种原因，`ThreadPool`'s`QueueWorkItem`都不会返回`IAsyncResult`工作项的句柄或其他句柄，这将允许等待它完成。有一些`RegisterWait...`方法，但是您必须通过 a`WaitHandle`并且创建它们很昂贵（请参阅`IAsyncResult`文档，它建议您延迟创建 a`WaitHandle`直到请求）。Task Parallel Library 将解决这个缺陷，但在可用之前等待很长时间。那么，这个设计有什么问题吗：

```
public class Concurrent<T> {
    private ManualResetEvent _resetEvent;
    private T _result;

    public Concurrent(Func<T> f) {
        ThreadPool.QueueUserWorkItem(_ => {
                                         _result = f();
                                         if (_resetEvent != null)
                                             _resetEvent.Set();
                                     });
    }

    public WaitHandle WaitHandle {
        get {
            if (_resetEvent == null)
                _resetEvent = new ManualResetEvent(_result != null);
            return _resetEvent;
        }

    ... 
```

编辑：我问了一个[关于使用异步委托而不是 ThreadPool 时出现的问题的后续问题](https://stackoverflow.com/questions/406915/using-begininvoke-endinvoke-in-a-multithreaded-fashion-how-do-asynccallback-asy)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-02T00:25:12.867

好吧，您在获取 WaitHandle 和设置它之间存在竞争条件。如果他们碰巧迟到了一点，你真的希望来电者永远等待吗？

您可能应该做一些适当的锁定并保留一个“我已经完成”标志，以便如果您在*完成*后创建 WaitHandle，您可以在返回之前设置它。

我还会亲自编写一个静态工厂方法，而不仅仅是使用公共构造函数——或者将其设为“创建*然后*显式启动”模式。在构造函数中排队工作项对我来说感觉很奇怪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T01:32:59.313

你为什么不使用异步委托，如下所示：

[http://msdn.microsoft.com/en-us/library/h80ttd5f.aspx](http://msdn.microsoft.com/en-us/library/h80ttd5f.aspx)

那会使 Concurrent 过时，不是吗？

# python - 在 Python 中接受文件参数（从发送到上下文菜单）

> ID：405612
> 
> 赞同：3
> 
> 时间：2009-01-01T22:50:42.730
> 
> 标签：python, urllib2, contextmenu, sendto

我将首先指出我几乎没有 python 经验。

[替代文字 http://www.aquate.us/u/9986423875612301299.jpg](http://www.aquate.us/u/9986423875612301299.jpg)

您可能知道，只需在 Windows PC 上的“发送到”文件夹中放置一个快捷方式，您就可以允许程序将文件作为参数。

我将如何编写一个将此文件作为参数的python程序？

而且，如果有人有机会，作为奖励——我如何将它与 urllib2 集成以将文件发布到我服务器上的 PHP 脚本？

提前致谢。

编辑——另外，我如何在 Sendto 菜单中显示一些东西？我的印象是，您只需将快捷方式放入 SendTo 文件夹，它就会自动在菜单中添加一个选项……没关系。我发现我做错了什么:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-01T22:57:47.037

1.  找出拖动的文件是什么： http: [//docs.python.org/library/sys.html#sys.argv](http://docs.python.org/library/sys.html#sys.argv)
2.  打开它：[http ://docs.python.org/library/functions.html#open](http://docs.python.org/library/functions.html#open)
3.  阅读：[http ://docs.python.org/library/stdtypes.html#file.read](http://docs.python.org/library/stdtypes.html#file.read)
4.  发布它：[http ://docs.python.org/library/urllib2.html#urllib2.urlopen](http://docs.python.org/library/urllib2.html#urllib2.urlopen)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T22:56:55.963

```
import sys

for arg in sys.argv:
  print arg 
```

# python - 使用python程序将mysql表中的两个值插入另一个表

> ID：405617
> 
> 赞同：-2
> 
> 时间：2009-01-01T22:54:43.050
> 
> 标签：python, mysql, database

我正在编写的 Python 程序（如下）有一个小问题。

我想将 MySQL 表中的两个值插入 Python 程序中的另一个表中。

这两个字段是优先级和产品，我从商店表中选择了它们，我想将它们插入到产品表中。

任何人都可以帮忙吗？非常感谢。马克。

```
import MySQLdb

def checkOut():
    db = MySQLdb.connect(host='localhost', user = 'root', passwd = '$$', db = 'fillmyfridge')
    cursor = db.cursor(MySQLdb.cursors.DictCursor)
    user_input = raw_input('please enter the product barcode that you are taking out of the fridge: \n')
    cursor.execute('update shops set instock=0, howmanytoorder = howmanytoorder + 1  where barcode = %s', (user_input))
    db.commit()
    cursor.execute('select product, priority from shop where barcode = %s', (user_input))
    rows = cursor.fetchall()
    cursor.execute('insert into products(product, barcode, priority) values (%s, %s)', (rows["product"], user_input, rows["priority"]))
    db.commit()
    print 'the following product has been removed from the fridge and needs to be ordered' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T23:21:40.420

好吧，又是同样的事情：

```
import MySQLdb

def checkOut():
    db = MySQLdb.connect(host='localhost', user = 'root', passwd = '$$', db = 'fillmyfridge')
    cursor = db.cursor(MySQLdb.cursors.DictCursor)
    user_input = raw_input('please enter the product barcode that you are taking out of the fridge: \n')
    cursor.execute('update shops set instock=0, howmanytoorder = howmanytoorder + 1  where barcode = %s', (user_input))
    db.commit()
    cursor.execute('select product, priority from shop where barcode = %s', (user_input))
    rows = cursor.fetchall() 
```

1.  你需要 fetchall() 吗？我猜条形码是独一无二的，我猜一个条形码对应一种产品。所以， fetchone() 就足够了....不是吗？

2.  无论如何，如果您执行 fetchall() 它是一个结果集，而不是单个结果。所以`rows["product"]`无效。它一定要是

    ```
    for row in rows:
        cursor.execute('insert into products(product, barcode, priority) values (%s, %s, %s)', (row["product"], user_input, row["priority"]))
    db.commit()
    print 'the following product has been removed from the fridge and needs to be ordered' 
    ```

或更好

```
import MySQLdb

def checkOut():
    db = MySQLdb.connect(host='localhost', user = 'root', passwd = '$$', db = 'fillmyfridge')
    cursor = db.cursor(MySQLdb.cursors.DictCursor)
    user_input = raw_input('please enter the product barcode that you are taking out of the fridge: \n')
    cursor.execute('update shops set instock=0, howmanytoorder = howmanytoorder + 1  where barcode = %s', (user_input))
    cursor.execute('insert into products(product, barcode, priority) select product, barcode, priority from shop where barcode = %s', (user_input))
    db.commit() 
```

**编辑：**此外，您`db.commit()`几乎`print`可以在任何地方使用，您需要阅读并理解数据库的[原子性](http://en.wikipedia.org/wiki/Atomicity_(database_systems))原则

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T23:22:56.207

你没有提到问题是什么，但在你展示的代码中：

```
cursor.execute('insert into products(product, barcode, priority) values (%s, %s)', (rows["product"], user_input, rows["priority"])) 
```

你的 values 子句只有两个 %s，它应该有三个：

```
cursor.execute('insert into products(product, barcode, priority) values (%s, %s, %s)', (rows["product"], user_input, rows["priority"])) 
```

# c# - 将字符串转换为 int 并在 C# 中测试成功

> ID：405619
> 
> 赞同：40
> 
> 时间：2009-01-01T22:55:31.253
> 
> 标签：c#, string, parsing, int

如何检查**字符串**是否**可转换**为**int？**

假设我们有像“House”、“50”、“Dog”、“45.99”这样的数据，我想知道我应该只使用**字符串**还是使用解析后的**int**值。

*在 JavaScript 中，我们有这个[parseInt()](http://www.w3schools.com/jsref/jsref_parseInt.asp)函数。**如果无法解析**字符串，它将返回**NaN**。*

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-01T23:00:08.077

`Int32.TryParse(String, Int32)`- [http://msdn.microsoft.com/en-us/library/f02979c7.aspx](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

```
 bool result = Int32.TryParse(value, out number);
  if (result)
  {
     Console.WriteLine("Converted '{0}' to {1}.", value, number);         
  } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-02T03:10:15.997

通过将 tryparse 直接运行到 if 中，你能不能让它更优雅一点？

像这样：

```
if (Int32.TryParse(value, out number))     
  Console.WriteLine("Converted '{0}' to {1}.", value, number); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-01T23:00:20.010

Int.TryParse

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-03T08:54:08.503

在其中一个搜索结果中发现了这一点：[如何识别字符串是否为数字？](https://stackoverflow.com/questions/894263/how-do-i-identify-if-a-string-is-a-number)

添加这个是因为我之前看到的答案没有使用：

```
int n;
bool isNumeric = int.TryParse("123", out n); 
```

这里`"123"`可以是`s = "123"`OP 正在测试的字符串，如果发现它是数字，则在调用后该值`n`将具有一个值 ( )。`123`

# language-agnostic - 基于流的编程

> ID：405627
> 
> 赞同：40
> 
> 时间：2009-01-01T22:57:22.717
> 
> 标签：language-agnostic, paradigms

在过去的几天里，我一直在阅读有关[基于流的编程的一些内容。](http://www.jpaulmorrison.com/fbp/)有一个[wiki](http://www.jpaulmorrison.com/cgi-bin/wiki.pl)提供了更多详细信息。维基百科对此也有[很好的概述](http://en.wikipedia.org/wiki/Flow-based_programming)。我的第一个想法是，“另一个伟大的乐高乐园假装编程支持者”——这个概念可以追溯到 80 年代后期。但是，当我阅读更多时，我必须承认我已经变得很感兴趣。

1.  您是否将 FBP 用于实际项目？
2.  您对于 FBP 的观点是？
3.  FBP有未来吗？

从某种意义上说，这似乎是我们的行业自过程语言出现以来所追求的重用圣杯。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-04-29T08:35:22.070

> *1、你有没有在实际项目中使用过FBP？*

我们为我们的自动化项目（调度程序、组件接口、一堆组件、DF 语言、DF 编译器、UI）设计并实现了一个 DF 服务器。它是用纯 C++ 编写的，可以在多个类 Unix 系统（Linux x86、MIPS、avr32 等、Mac OSX）上运行。它缺少一些特性，例如复杂的流控制，复杂的线程控制（它只有一个不太高级的组件），所以它只是一个原型，即使它可以工作。我们现在正在开发一个功能齐全的服务器。在实现和使用原型的过程中，我们学到了很多东西。

此外，我们有一天会制作一个可视化编辑器。

> *2.您对FBP有何看法？*

*2.1。首先，数据流编程是* ***终极乐趣***

当我遇到数据流编程时，我感觉就像 20 年前，当我第一次遇到编程时。尽管如此，DF 编程与过程/OOP 编程不同，它只是一种编程。有很多东西要发现，甚至是非常简单的东西！很有趣，作为一个经验丰富的程序员，你遇到了一个 DF 问题，这是一个非常非常基本的事情，但你以前完全不知道。所以，如果你跳入 DF 编程，你会觉得自己像个新手程序员，第一次遇到“循环”或“条件”。

*2.2\. 它只能用于特定的架构*

它只是一把锤子，用来敲钉子。DF 不适用于 UI、Web 服务器等。

*2.3\. 数据流架构对于某些问题是最优的*

数据流框架可以创造神奇的东西。它可以并行化最初不是为并行化而设计的程序。组件是单线程的，但是当它们被组织成一个 DF 图时，它们就变成了多线程的。

示例：您知道吗，那个**品牌**是 DF 系统？尝试*make -j*（参见 man，-j 的用途）。如果您有多核机器，请在使用和不使用 -j 的情况下编译您的项目，并比较时间。

*2.4\. 问题的最优拆分*

如果您正在编写程序，您通常会将问题拆分为较小的子问题。众所周知的子问题通常有拆分点，您不需要实现，只需使用现有的解决方案，例如用于 DB 的 SQL，或用于图形/动画的 OpenGL 等。

DF 架构以一种非常有趣的方式解决了您的问题：

*   提供架构的数据流框架（只使用现有的），
*   组件：程序员创建组件；组件是简单的、分离良好的单元——制作组件很容易；
*   配置：又名数据流编程：配置器使用程序员提供的组件将数据流图（程序）放在一起。

如果你的组件集设计得很好，配置器可以构建这样的系统，这是程序员做梦都想不到的。配置器可以在不打扰程序员的情况下实现新*功能。*客户很高兴，因为他们有个性化的解决方案。软件制造商也很高兴，因为他/她不需要维护几个客户特定的软件分支，只需要客户特定的配置。

*2.5\. 速度*

如果系统建立在本地组件上，DF 程序很快。与简单的 OOP 程序相比，唯一的时间损失是组件之间的消息调度，它也是最小的。

> *3\. FBP有前途吗？*

是的，当然。

主要原因是它可以解决大量的多处理问题，而无需引入全新的奇怪的软件架构、奇怪的语言。数据流编程很简单，我的意思是：组件编程和数据流配置构建。（即使是数据流框架的编写也不是一门火箭科学。）

此外，它非常经济。如果你有一套好的组件，你只需要把乐高积木放在一起。DF 程序易于维护。DF 配置构建不需要经验丰富的程序员，只需要系统集成商。

我会很高兴，如果本机系统传播开来，为自定义组件创建敞开大门。还应该有一个标准的 DF 语言，这意味着它可以与平台无关的可视化编辑器和多个 DF 服务器一起使用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-07T16:18:19.373

有趣的讨论！昨天我突然想到，部分混淆可能是由于许多不同的符号使用有向弧，但用它们来表示不同的东西。在 FBP 中，线条表示有界缓冲区，数据包流穿过这些缓冲区。由于组件通常是长时间运行的进程，流可能包含大量数据包，并且 FBP 应用程序可以运行很长时间 - 甚至可能“永久”运行（参见 2007 年关于名为 Eon 的项目的论文，主要由 UMass Amherst 的人撰写）。由于当缓冲区（暂时）满（或暂时空）时，向有界缓冲区的发送暂停，因此可以使用有限资源处理无限量的数据。

相比之下，Grafcet 中的 E 来自 Etapes，意思是“步骤”，这是一个完全不同的概念。在这种模型中（并且有很多这样的模型），步骤之间流动的数据要么被限制在一次可以保存在高速内存中，要么必须保存在磁盘上。FBP 还支持网络中的循环，这在基于步骤的系统中很难做到 - 参见例如[http://www.jpaulmorrison.com/cgi-bin/wiki.pl?BrokerageApplication](http://www.jpaulmorrison.com/cgi-bin/wiki.pl?BrokerageApplication)- 请注意，此应用程序以自然的方式同时使用了 MQSeries 和 CORBA。此外，FBP 本身是并行的，因此它适用于网格网络、多核机器和许多现代计算方向的编程。最后一点评论：在文献中我发现了很多相关的项目，但很少有项目具备 FBP 的所有特性。[可以在http://www.jpaulmorrison.com/cgi-bin/wiki.pl?FlowLikeProjects](http://www.jpaulmorrison.com/cgi-bin/wiki.pl?FlowLikeProjects)中找到我多年来积累的列表（其中一些比 Grafcet 更接近）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-06T19:40:43.100

我确实不同意关于 FBP 只是实现 FSM 的一种手段的评论：我认为 FSM 很整洁，并且我相信它们在构建应用程序中具有一定的作用，但是 FBP 的核心概念是多个组件进程*异步*运行，通过跨越现在称为有界缓冲区的数据块流进行通信。是的，FSM 绝对是构建组件流程的一种方式，事实上，在我关于 FBP 的书中有一整章专门讨论了这个想法，以及相关的 PDA ( [1](https://i.stack.imgur.com/3iF73.jpg) ) - [http://www.jpaulmorrison.com/ fbp/compil.htm](http://www.jpaulmorrison.com/fbp/compil.htm) - 但在我看来，实现非平凡 FBP 网络的 FSM 将是不可能的复杂。例如，图中所示的图表 ![http://www.jpaulmorrison.com/fbp/image010.jpg](https://i.stack.imgur.com/3iF73.jpg) 约为 a 的 1/3*在大型机上运行的单个*批处理作业。这些块中的每一个都与所有其他块异步运行。顺便说一句，我很想听到第一篇文章中问题的更多答案！

[1](https://i.stack.imgur.com/3iF73.jpg) : [http://en.wikipedia.org/wiki/Pushdown_automaton](http://en.wikipedia.org/wiki/Pushdown_automaton)下推自动机

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-21T02:28:24.467

每当我听到基于流的编程这个术语时，我都会从概念上想到 LabView。即，调度的组件进程主要由对其输入数据的更改驱动。这真的是乐高编程，因为 labview 平台被用于最新的头脑风暴产品。但是我不同意这使它成为一个不太有用的编程模型。

对于通常涉及数据收集、控制和自动化的工业系统，它非常适合。如果不是数据输入转换为数据输出，那么任何控制系统是什么？即，如果可以的话，您不希望将控制方案中的哪个组件表示为更大图中的黑匣子。要使用其他方法实现该级别的架构清晰度，您可能必须绘制数据域类图，然后绘制问题域运行时类关系，然后在此之上绘制用例图，并在它们之间来回翻转。使用流驱动系统，您可以足够准确地将大量此类信息整合在一起，这样您就可以在构建和定义组件后真实地直观地设计系统。

在查看用 labview 编写的应用程序时，我从来不必问的一个问题是“哪段代码设置了这个值？”，因为它是固有的，很容易从数据中追溯，而且像多个无意识的编写者这样的错误是不可能的错误地创造。

如果以更典型的程序方式编写的代码也是如此！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-16T13:07:41.737

1）我为异常检测项目构建了一个小型 FBP 框架，结果证明这是一个好主意。

您还可以观看一些[KNIME 视频](http://www.knime.org/)，这些视频很好地了解了当框架由一个优秀的团队组合在一起时基于流的框架的感觉。诚然，它是基于批处理的，不是为连续操作而创建的。

然而，到目前为止，基于流的编程最好的例子是**UNIX 管道**，它是最古老、最容易被忽视的 FBP 框架之一。我认为我不必详细说明 nix 管道的功能......

2) FBP 是一个非常强大的工具，可以解决大量问题。内在的并行性是一个很大的优势，任何 FBP 框架都可以通过使用适配器模块使网络完全透明。智能框架还具有荒谬的容错能力，并且能够在必要时动态重新加载崩溃的模块。概念上的简单性还允许与项目中涉及的每个人进行更清晰的沟通，以及更简洁的代码。

3）绝对！管道将继续存在，并且是 unix 最强大的功能之一。与静态程序相比，FBP 框架固有的强大功能很多，并且微不足道，以至于某些框架可以*在运行*时重新配置而无需特殊措施。

***FBP FTW！;-)***

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-13T16:56:30.663

在汽车开发中，他们有一个与语言无关的消息协议，该协议是 MOST 规范（面向媒体的系统传输）的一部分，旨在通过网络或同一设备内的组件之间进行通信。系统通常既有真实的消息总线也有可视化的消息总线——因此您实际上拥有了一种基于流的编程形式。

这就是几年前让灯泡亮起来并把我带到这里的原因。这确实是一种很棒的工作方式，比传统编程更有趣。消息目录构成了中心规范和参考点。它适用于开发人员和管理人员。即管理能够浏览消息目录而不是查看源。

通过集成日志记录，还可以参考目录以产生可理解的分析，事情可以变得非常高效。我有以这种方式开发商业产品的真实世界经验。我有兴趣更进一步，特别是在工具和 IDE 方面。不幸的是，我认为汽车行业的许多人都忽略了这一点，即这是多么伟大，并且未能在此基础上再接再厉。他们现在被其他时尚分散了注意力，并没有意识到**大多数**发展远不止物理巴士。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-01T23:05:48.957

我在 Java Web 应用程序中广泛使用[Spring Web Flow](http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html)来建模（通常）应用程序进程，这些进程往往是复杂的类似向导的事务，有很多关于显示哪些页面的条件逻辑。它非常强大。添加了一个新产品，我设法在一两个小时内将现有的部分重新切割成一个全新的应用程序流程（添加了几个新的视图/状态）。

我还研究了使用[OS Workflow](http://www.opensymphony.com/osworkflow/)对业务流程进行建模，但该项目因各种原因而被搁置。

在 Microsoft 世界中，您拥有[Windows Workflow Foundation](http://www.opensymphony.com/osworkflow/)（“WWF”），它变得越来越流行，尤其是与[Sharepoint](http://www.microsoft.com/Sharepoint/default.mspx)结合使用。

FBP 只是一种实现[有限状态机](http://en.wikipedia.org/wiki/Finite_state_machine)的方法。这不是什么新鲜事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T20:18:38.170

我意识到这并不完全相同，但这种模型已经在 PLC 编程中使用了多年。ISO 将其称为顺序流程图，但许多人在流行实施后将其称为 Grafcet。它提供并行处理并定义状态之间的转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-22T06:51:26.723

如今，它在商业智能世界中被用于混搭和处理数据。最终用户可以完成 ETL、查询、加入和生成报告等数据处理步骤。我是开放系统上的开发人员 - [ComposableAnalytics.com](http://composableanalytics.com)在 CA 中，可以通过浏览器共享和执行基于流的应用程序。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-02T00:43:57.027

这就是 MQ 系列、MSMQ 和 JMS 的用途。

这是 Web 服务和企业服务总线实现的基石。

TIBCO 和 Sun 的 JCAPS 等产品基本上是基于流的，没有使用这个特殊的流行词。

应用程序的大部分工作是通过通过处理网络传递消息的小模块完成的。

# php - 向 JavaScript 对象添加一些自定义会话变量

> ID：405636
> 
> 赞同：0
> 
> 时间：2009-01-01T23:01:08.183
> 
> 标签：php, jquery

我目前有一个自定义会话处理程序类，它只是建立在 php 的会话功能上（并与一些 mySQL 表相关联）。

我有各种各样最适合我的应用程序的会话变量（主要保存在服务器端）。虽然我也在使用 jQuery 来提高前端的可用性，但我想知道将一些会话变量（一些基础知识和一些浏览偏好 id）提供给 JS 对象是否是一个不好的方法。

目前，如果我需要在前端访问任何这些信息，我会向专门编写的 php 页面发出 ajax 请求以提供适当的响应，尽管我不确定这是否是最佳实践（实际上我很确定这只是创建了过多的 Ajax 请求）。

有人对此有任何意见吗？这是向客户端提供此类信息的最佳方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-01T23:21:46.740

我真的猜这取决于很多因素。我的脑海里总是有“过早的优化......”。

早些年，我把想到的每一个小想法都冲进了这个应用程序。这通常会导致“我做得很酷，但我没有花时间完全掌握我要解决的问题；还是有问题吗？”

如今，我使用明显的方法（如您的方法），这种方法很快（在第一次尝试时不会完全影响性能），然后分析我是否遇到问题。

换句话说：

1.  您需要多久从不同类型的已加载页面访问此信息（因为如果您在没有用户重新加载的情况下加载一次信息，那么重新获取它可能没有多大意义）乘以并发客户端的数量？

2.  如果您将信息写入客户端 cookie 以实现快速 JS 访问，如果滥用（未经应用程序同意而修改）会对您的应用程序造成损害吗？如果 #1 适用，则无需像 WHATWG 建议的那样使用任何类型的离线存储来替换“JS”和“cookie”。

“快速”方法适合我，因为通常不会对前期开发研究进行大量投资。如果您已经仔细地做到了……但是您可能已经知道该答案了；）

作为 3\. 您始终可以将 HTML 推送到您的客户端，其中已经包含您在 JS 中需要的数据，也许这可以在您的情况下工作。看看还会有什么其他建议会很有趣！

正如我的旁注：我也将 PHP 会话存储在 DB 中，直到我将它们移到 memcached （警告：它是缓存而不是持久存储，所以对你来说可能不是一个好主意，我可以忍受它，我只是确保它始终在运行）以实现 20% 的数据库查询平均下降，并通过这个下降 90% 的写入查询。而且我什至还没有使用任何花哨的 Ajax，只是并发用户的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T23:40:39.760

我会说这绝对是 AJAX 的过度杀伤力，这些会话是私人的还是重要的不向访问者展示？只是把它扔在那里；就两者而言，cookie 是最简单的，将数据保存在 javascript 对象中使其对访问者来说同样容易读取，而当涉及到 cookie 是否启用时，如果没有 cookie，您将不会有会话.

[http://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)是关于 JS 中 cookie 处理的一个很好的来源，它包括两个用于读取和写入 cookie 的函数。

# c# - 与 Pervasive SQL 数据库交互的方法

> ID：405640
> 
> 赞同：0
> 
> 时间：2009-01-01T23:02:33.423
> 
> 标签：c#, orm, data-access-layer, pervasive

我正在为使用 Pervasive SQL 数据库存储信息的服务业务管理应用程序开发 Web 界面（顺便说一句，这不是我的选择）。目前，我正在使用带有一组自定义查询生成类的官方 Pervasive SqlClient 实现，因此我可以编写如下代码：

```
new SelectQuery().From("CUSTOMER").Fields("CUSTOMERNBR", "NAME"); 
```

到目前为止它工作正常，但我在这里和那里遇到了一些小问题。与其继续朝着这个方向前进，我更愿意使用经过验证的 DAL。但是，我在找到可以与 Pervasive 数据库交互的 DAL 系统时运气不佳。

Opf3 有一个 Pervasive 存储提供程序，但我以前从未听说过该框架，并且该网站仅显示 Pervasive v8 徽标，而我需要可以与 v9.5 以及未来 v10 一起使用的东西。

我尝试编写 NHibernate 提供程序，但结果比我当前的查询生成系统更令人头疼。

你有什么建议？我的时间线很匆忙，所以我想要一些尽可能容易整合的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T09:27:34.303

Pervasive.SQL 有一个非常可靠的 ADO 适配器，并且在大多数情况下都优于 ODBC；我已经成功使用了 if 多年，但并非没有 Pervasive 的语法令人头疼。在 Pervasive 的辩护中，他们的关系引擎确实符合 SQL-92 和大部分 SQL-99。

我很好奇的是你对语法的哪些部分有问题，是什么导致你的悲伤？

您使用的是哪个版本的 Pervasive 引擎？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T23:07:07.423

您应该能够从 Pervasive 中找到 ODBC 驱动程序——它们必须是可靠的，否则 Pervasive 将停止营业。大多数更高级别的抽象软件可以处理 ODBC 级别的数据。我认为这将是你最好的选择，如果你觉得你真的需要比 ODBC 本身进一步抽象它。

# c# - 显式实现 IAsyncResult

> ID：405647
> 
> 赞同：6
> 
> 时间：2009-01-01T23:04:51.563
> 
> 标签：c#, concurrency, asynchronous, iasyncresult

我通常对部分实现接口持谨慎态度。然而，`IAsyncResult`这是一种特殊情况，因为它支持几种完全不同的使用模式。您多久使用/看到使用`AsyncState`/`AsyncCallback`模式，而不是仅仅调用`EndInvoke`、使用`AsyncWaitHandle`或轮询`IsCompleted`（讨厌）？

相关问题：[Detecting that a ThreadPool WorkItem has completed/waiting for completion](https://stackoverflow.com/questions/405600/detecting-that-a-threadpool-workitem-has-completed-waiting-for-completion)。

考虑这个类（非常近似，需要锁定）：

```
public class Concurrent<T> {
    private ManualResetEvent _resetEvent;
    private T _result;

    public Concurrent(Func<T> f) {
        ThreadPool.QueueUserWorkItem(_ => {
                                         _result = f();
                                         IsCompleted = true;
                                         if (_resetEvent != null)
                                             _resetEvent.Set();
                                     });
    }

    public WaitHandle WaitHandle {
        get {
            if (_resetEvent == null)
                _resetEvent = new ManualResetEvent(IsCompleted);
            return _resetEvent;
        }

    public bool IsCompleted {get; private set;}
    ... 
```

它有`WaitHandle`（懒惰地创建，正如`IAsyncResult`文档中描述的那样）和`IsCompleted`，但我没有看到`AsyncState`（`{return null;}`？）的合理实现。那么实施它有意义`IAsyncResult`吗？请注意，`Task`在 Parallel Extensions 库中确实实现了`IAsyncResult`，但只是`IsCompleted`隐式实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-02T02:02:36.680

看来您有几个问题。让我们单独处理它们

**懒惰地创建 WaitHandle**

是的，这是最正确的方法。您应该以线程安全的方式执行此操作，但懒惰是一种方式。

诀窍是处理 WaitHandle。WaitHandle 是 IDisposable 的基础，**必须**及时处理。IAsycResult 的文档不包括这种情况。最好的方法是在 EndInvoke 中。BeginInvoke 的文档明确指出，对于每个 BeginInvoke，都必须有一个对应的 EndInvoke（或 BeginRead/EndRead）。这是处理 WaitHandle 的最佳位置。

**AsyncState 应该如何实现？**

如果您查看返回 IAsyncResult 的标准 BCL API，它们中的大多数都采用状态参数。这通常是从 AsyncState 返回的值（有关示例，请参见 Socket API）。对于返回 IAsyncResult 的任何 API BeginInvoke 样式 API，最好包含一个类型为对象的状态变量。没有必要，但很好的做法。

在没有状态变量的情况下，返回 null 是可以接受的。

**已完成 API**

这将高度依赖于创建 IAsyncResult 的实现。但是，是的，您应该实施它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T00:04:50.910

*   以我的经验，只调用 EndInvoke 而不等待或先被回调很少有用
*   仅提供回调有时是不够的，因为您的客户可能希望一次等待多个操作（WaitAny、WaitAll）
*   我从来没有投票过 IsCompleted，确实很糟糕！因此，您可以保存 IsCompleted 的实现，但它非常简单，似乎不值得让您的客户感到惊讶。

因此，异步可调用方法的合理实现应该真正提供完全实现的 IAsyncResult。

顺便说一句，您通常不需要自己实现 IAsyncResult，只需返回 Delegate.BeginInvoke 返回的内容。有关示例，请参见 System.IO.Stream.BeginRead 的实现。

# python - 将带有通配符的参数传递给 Python 脚本

> ID：405652
> 
> 赞同：16
> 
> 时间：2009-01-01T23:08:01.760
> 
> 标签：python, windows, command-line, arguments

我想做这样的事情：

```
c:\data\> python myscript.py *.csv 
```

并将目录中的所有 .csv 文件传递​​给我的 python 脚本（例如`sys.argv`包含`["file1.csv", "file2.csv"]`等）

但是`sys.argv`只是收到`["*.csv"]`表明通配符没有被扩展，所以这不起作用。

我觉得有一种简单的方法可以做到这一点，但在谷歌上找不到。有任何想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-01T23:15:46.487

您可以使用 glob 模块，这样您就不会依赖特定外壳的行为（好吧，您仍然依赖外壳不扩展参数，但至少您可以通过转义通配符在 Unix 中实现这一点:-) )。

```
from glob import glob
filelist = glob('*.csv') #You can pass the sys.argv argument 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-01T23:19:50.610

在 Unix 中，shell 扩展通配符，因此程序得到扩展的文件名列表。Windows 不这样做：shell 将通配符直接传递给程序，程序必须自己扩展它们。

Vinko 是对的：glob 模块完成了这项工作：

```
import glob, sys

for arg in glob.glob(sys.argv[1]):
    print "Arg:", arg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-15T09:15:49.077

如果你的脚本是一个实用程序，我建议你在你`.bashrc`的目录中定义一个这样的函数来调用它：

```
myscript() {
   python /path/myscript.py "$@"
} 
```

然后整个列表被传递给你的python，你可以像这样处理它们：

```
for _file in sys.argv[1:]:
    # do something on file 
```

# .net - 如何在 .NET 中绘制 3D 数学模型？哪种 3D 引擎最适合有效地做到这一点？

> ID：405666
> 
> 赞同：5
> 
> 时间：2009-01-01T23:18:38.523
> 
> 标签：.net, wpf, math, graphics, 3d

我最近遇到了一个问题，即展示简单遗传算法的输出，该算法寻找 2 个参数函数 f(x1,x2) 的极值。我希望能够使用 x1 作为 x、x2 作为 y 和 f 作为 z，并在 3d 空间中绘制可以旋转的点。（我目前正在使用颜色作为“z 轴”在位图上绘制它。）

我应该从哪里开始？

更新：

我找到了一个[用于 C# 的 3D 引擎](http://www.devmaster.net/engines/list.php?fid=6&sid=2)目录，但有很多可供选择...您能否建议其中任何一个最适合我的问题？

更新 2：

感谢 Cameron 的建议，WPF 中的 3D 选项似乎适合我的需要。我一定会试一试的。

我在这里转发他的链接：
[~~* WPF 3D 教程~~](http://www.kindohm.com/technical/WPF3DTutorial.htm)
[* CodeProject：WPF 3D Primer](http://www.codeproject.com/KB/WPF/Wpf3DPrimer.aspx)
[* CodeProject：WPF 3D：第 1 部分 n](http://www.codeproject.com/KB/WPF/WPF3D_1.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-01T23:53:06.847

如果你想像我一样从头开始做 tings，有 tao 框架。它是一个用于 C# 的 opengl 框架（还有更多）。[tao框架链接](http://taoframework.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T00:19:00.430

如果您完全可以使用 WPF，那么您可以立即做一些非常简单的事情。

以下是一些入门链接：

*   [WPF 3D 教程](http://www.kindohm.com/technical/WPF3DTutorial.htm)
*   [CodeProject：WPF 3D 入门](http://www.codeproject.com/KB/WPF/Wpf3DPrimer.aspx)
*   [代码项目：WPF 3D：n 的第 1 部分](http://www.codeproject.com/KB/WPF/WPF3D_1.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T23:53:03.853

我使用 OpenInventor 进行科学可视化。它可能（在某些方面）是旧 SGI 时代的遗物，但它仍然受到支持并且运行良好。关于绘图和其他科学可视化，请查看 Mercury 的 MeshViz 和其他扩展：

*   [Mercury（前身为 TGS）OpenInventor](http://www.tgs.com/)
*   [MeshViz 扩展](http://www.tgs.com/products/oiv_mesh_viz_overview.asp)

它有图表，矢量可视化等。它非常全面。

它不是免费的，但他们提供试用许可证，因此您可以确定它是否适合您的需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T07:28:06.113

如果您更喜欢直接编码 OpenGL（而不是使用引擎），请查看[OpenTK](http://www.opentk.com)或[Tao Framework](http://www.taoframework.com)。两者都使用相同的代码库，但 OpenTK 更紧密地遵循 .Net 约定并且更易于使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T02:04:35.780

wpf + 托管 dx。

# c++ - 如果你编写了一个 C++/OO 跨平台框架，并且由于没有时间而意识到它在你的磁盘上放置太多，你会怎么做？

> ID：405673
> 
> 赞同：3
> 
> 时间：2009-01-01T23:24:05.033
> 
> 标签：c++, oop, frameworks, cross-platform

这个项目最初是一个开发平台，因为我希望能够为移动设备编写游戏，同时也能够在我的台式机上运行和调试代码（即 EPOC 设备模拟器太糟糕了）：它的平台目前支持的是：

*   窗口-桌面
*   WinCE
*   塞班
*   苹果手机

它的架构非常完整，有 16 位 565 视频帧缓冲区、blitters、基本光栅操作、软件像素着色器、带着色器的音频混合器 (dsp fx)、基本输入、一个简单的虚拟文件系统......虽然这是第一次编写和所以有些地方需要进行一些重构。一切都被抽象出来了，指导原则是：

*   大部分是干净的代码，就好像这是一本可以阅读的书
*   面向对象，不牺牲性能
*   以移动为中心

想法是开源它，但无法管理它，我怀疑软件本身会从这一举措中受益。不过，我自己从无人维护的项目中学到了很多东西。

所以，提前感谢你阅读所有这些......真的，你会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-01T23:46:18.467

把它扔到一个开源网站上，并附上一堆好的关键字来帮助搜索引擎找到它。如果有人在寻找它，他们会找到它并能够使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T00:25:24.397

我会说你应该开源它。

如果你有时间，可能对其他对项目感兴趣的程序员了解项目的状态以及项目下一步要做什么很有帮助。编写待办事项列表可能会有所帮助，或者在代码中编写注释也可能会有所帮助。

如果你没有时间写一份待办事项清单，也许有人愿意在项目上采取主动，找出需要做的事情。

换个角度看。可能发生的最坏情况是您的工作会被忽视，您的努力将付诸东流。可能发生的最好的事情是，您将因有远见而开始这样一个伟大的项目并将其开源而受到认可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-02T00:37:51.373

[http://sourceforge.net](http://sourceforge.net)

这允许您设置为管理员并管理项目。
当然，如果有人不同意你的观点，他们可以分叉项目并启动他们自己的版本，但这对你来说是开源的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T01:52:23.690

如果你投入了时间和精力，不要让它安静地死去。而是在您选择的许可下在协作站点上共享它。在最坏的情况下，你什么也得不到。充其量，其他人喜欢这个想法并提供建设性的反馈或代码。更好的是，如果你将来有时间把它捡起来。

几个可以发布的好网站

1.  [代码复合体](http://codeplex.com)
2.  [魔法锻造](http://sourceforge.net)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-28T22:17:12.283

当然，您应该开源它，只需在任何人都可以看到的地方做出与此问题相同的考虑...

也许有人会拿起它，或者只是从中学习

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-02T02:03:24.353

把它放在[github](http://github.com/)上，这样我们都可以检查出来。

# django - Django 标签云插件

> ID：405675
> 
> 赞同：6
> 
> 时间：2009-01-01T23:26:30.583
> 
> 标签：django, tag-cloud

是否有一个好的 Django 应用程序可以获取标签列表及其出现频率并为它们呈现标签云？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-02T00:19:10.820

[Django-tagging](http://code.google.com/p/django-tagging/)有生成标签云的助手。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-27T02:05:59.150

一点点自我推销永远不会伤害任何人，对吧？ [http://dburke.info/blog/logarithmic-tag-clouds](http://dburke.info/blog/logarithmic-tag-clouds)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T15:41:49.670

你可以试试这个模板标签： http: [//www.djangosnippets.org/snippets/140/](http://www.djangosnippets.org/snippets/140/)

它适用于 django-tagging 应用程序 [http://code.google.com/p/django-tagging/](http://code.google.com/p/django-tagging/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T15:58:40.097

抓住后备箱，它将适用于 1.0

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-30T18:53:14.037

目前面临同样的问题，我发现这些链接对于标记模板很有用——因此您不必从头开始键入所有标记模板：

*   [http://www.napes.co.uk/blog/django-tagging/](http://www.napes.co.uk/blog/django-tagging/)

*   [http://tylerlesmann.com/2009/mar/09/adding-tagging-django-10-views-and-templates/](http://tylerlesmann.com/2009/mar/09/adding-tagging-django-10-views-and-templates/)

希望那些可以帮助:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-09T12:58:55.227

这是无耻的自我推销，但我刚刚发布了一个非常简单的模板标签助手来做到这一点，因为我有同样的需求并且不想使用更重的东西，比如 Django-tagging。

它不会使标签云变得困难，但它会进行必要的计算并将结果存储在一个可以在 HTML/CSS 中轻松引用的属性中。

[https://github.com/niconoe/django-nuages-tag](https://github.com/niconoe/django-nuages-tag)

# xml - Oracle：如何使用 updateXML 更新文档中的多个节点？

> ID：405679
> 
> 赞同：2
> 
> 时间：2009-01-01T23:29:29.967
> 
> 标签：xml, oracle, updatexml

我可以写：

```
update my_table
set xml = updateXML(xml, '/a/b', '1')
where document_id = 123 
```

现在，如果在同一个更新查询中我还想将 /a/c 设置为 2（此外 /a/b 设置为 1）怎么办？我很想写：

```
update my_table
set 
    xml = updateXML(xml, '/a/b', '1'),
    xml = updateXML(xml, '/a/c', '2')
where document_id = 123 
```

但这给了我一个“ORA-00957：重复的列名”。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-02T00:36:23.343

文档表明 XPath 字符串和表达式可以重复 [http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions205.htm#i1134878](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions205.htm#i1134878)

所以试试

更新 my_table 集 xml = updateXML(xml, '/a/b', '1', '/a/c', '2') where document_id = 123

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-26T13:06:26.530

更新 my_table 设置
xml = updateXML(xml, '/a/b/text()', '1','/a/c/text()','2') where document_id = 123

# php - PHP/MySQL 有编码问题

> ID：405684
> 
> 赞同：5
> 
> 时间：2009-01-01T23:35:44.730
> 
> 标签：php, mysql, encoding, utf-8

我在使用 PHP 编码时遇到问题。

我有一个使用 $.post 与我的 PHP 脚本交互的 JavaScript/jQuery HTML5 页面。然而，PHP 面临一个奇怪的问题，可能与编码有关。

当我写

```
htmlentities("í") 
```

我希望 PHP 输出`&iacute;`. 但是，相反，它输出`&Atilde;&shy;` 一开始，我认为我在编码方面犯了一些错误，但是

```
htmlentities("í")=="&iacute;"?"Good":"Fail"; 
```

正在输出“失败”，其中

```
htmlentities("í")=="&Atilde;&shy;"?"Good":"Fail"; 
```

但`htmlentities($search, null, "utf-8")`按预期工作。

我想让 PHP 与 MySQL 服务器通信，但它也有编码问题，即使我使用 utf8_encode。我应该怎么办？

编辑：在 SQL 命令上，写

```
SELECT id,uid,type,value FROM users,profile
WHERE uid=id AND type='name' AND value='XXX'; 
```

其中 XXX 不包含 í 字符，按预期工作，但如果有任何 'í' 字符，则不会。

```
SET NAMES 'utf8';
SET CHARACTER SET 'utf8';
SELECT id,uid,type,value FROM users,profile
WHERE uid=id AND type='name' AND value='XXX'; 
```

不仅 í 字符失败，而且没有任何“特殊”字符的字符串也失败。从 SET NAMES 和 SET CHARACTER SET 中删除 ' 字符似乎没有任何改变。

我正在使用 PDO 连接到 MySQL 数据库。

编辑 2：我正在使用 MySQL 版本 5.1.30 的 XAMPP for Linux。

编辑 3：`SHOW VARIABLES LIKE '%character%'`从 PhpMyAdmin 输出运行

```
character_set_client    utf8
character_set_connection    utf8
character_set_database  latin1
character_set_filesystem    binary
character_set_results   utf8
character_set_server    latin1
character_set_system    utf8
character_sets_dir  /opt/lampp/share/mysql/charsets/ 
```

从我的 PHP 脚本（使用 print_r）运行相同的查询输出：

```
Array
(
    [0] => Array
        (
            [Variable_name] => character_set_client
            [0] => character_set_client
            [Value] => latin1
            [1] => latin1
        )

    [1] => Array
        (
            [Variable_name] => character_set_connection
            [0] => character_set_connection
            [Value] => latin1
            [1] => latin1
        )

    [2] => Array
        (
            [Variable_name] => character_set_database
            [0] => character_set_database
            [Value] => latin1
            [1] => latin1
        )

    [3] => Array
        (
            [Variable_name] => character_set_filesystem
            [0] => character_set_filesystem
            [Value] => binary
            [1] => binary
        )

    [4] => Array
        (
            [Variable_name] => character_set_results
            [0] => character_set_results
            [Value] => latin1
            [1] => latin1
        )

    [5] => Array
        (
            [Variable_name] => character_set_server
            [0] => character_set_server
            [Value] => latin1
            [1] => latin1
        )

    [6] => Array
        (
            [Variable_name] => character_set_system
            [0] => character_set_system
            [Value] => utf8
            [1] => utf8
        )

    [7] => Array
        (
            [Variable_name] => character_sets_dir
            [0] => character_sets_dir
            [Value] => /opt/lampp/share/mysql/charsets/
            [1] => /opt/lampp/share/mysql/charsets/
        )

) 
```

跑步

```
SET NAMES 'utf8';
SET CHARACTER SET 'utf8';
SHOW VARIABLES LIKE '%character%' 
```

输出一个空数组。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-01T23:41:56.497

[指定htmlentities](http://www.php.net/htmlentities)的编码以匹配输入的编码非常重要，正如您在最后一个示例中所做的那样，但在前三个示例中省略了。

```
htmlentities($text,ENT_COMPAT,'utf-8'); 
```

关于与 MySQL 的通信，您需要确保连接排序规则和字符集与您正在传输的数据相匹配。您可以在配置文件中设置它，也可以在运行时使用以下查询：

```
SET NAMES utf8;
SET CHARACTER SET utf8; 
```

确保表、数据库和服务器字符集也匹配。有一个设置是您无法在运行时更改的，那就是服务器的字符集。需要在配置文件中修改：

```
[mysqld]
character-set-server = utf8
default-character-set = utf8 
skip-character-set-client-handshake 
```

阅读[手册中有关 MySQL 中](http://dev.mysql.com/doc/refman/5.0/en/charset.html)字符集和排序规则的更多信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-23T17:13:50.803

晚复兴。但为了进一步参考，这里有一些额外的提示：

1.  使用[mysql_set_charset](http://php.net/manual/en/function.mysql-set-charset.php)而不是`SET xxx`
2.  确保使用 UTF-8 编码保存文件（这通常被忽略）
3.  设置标题：
    `<?php header("Content-type: text/html; charset=utf-8"); ?>`

    `<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />`

4.  如果您的 Apache 服务器配置包含具有不同编码的[AddDefaultCharset](http://httpd.apache.org/docs/2.0/mod/core.html#AddDefaultCharset)指令，请向您的主机管理员大喊大叫。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T20:25:00.173

我刚遇到这个问题。我有整个网站的西班牙语内容，包括所有你能想到的特殊字符 (áéíóúñ) 及其大写字母版本。

就我而言，这与服务器字符集/排序规则不一致。其他所有内容都设置为 utf8，但服务器字符集具有 latin1。这导致在数据库中输入的所有 utf8 数据都以原始编码形式显示，例如 L í 将等于带有波浪号的 A ...

我正在使用 mysqli，为了修复它，我使用了 Anthony Accioly 上面解释的方法（使用 mysql_set_charset）。所述方法有一个[mysqli](http://php.net/manual/en/mysqli.set-charset.php)版本，这就是我使用的。

在那之后，我很困惑。查看我的网站时，我仍然一团糟。当然，我不知道通过将 latin1 更改为 utf8 我也会弄乱整个字符的编码/解码。所以我使用[在线字符串编码器/解码器](http://coderstoolbox.net/string/)的帮助来修复我的表数据。

我对所有内容数据进行了各种导出（您可以将它们设置为获取更新查询，这对于您的更新过程来说会更快）并通过上述在线编码器/解码器运行 sql 输出，然后复制粘贴固定查询phpmyadmin sql 面板...从而修复了我的编码错误。现在一切都应该是这样，并且我能够再次处理有损搜索：Maria、maria、maria、maria 都将匹配 maría、maria、Maria 等。所有锐音字符都评估为它们的基本元音字符。大胜。

# authentication - 在 Subversion 中，我可以成为我的登录名以外的用户吗？

> ID：405690
> 
> 赞同：263
> 
> 时间：2009-01-01T23:41:25.357
> 
> 标签：authentication, svn

我想知道如何`Subversion`更改我的更改出现的名称。

我刚开始用`Subversion`。我目前正在使用它来对 XP 笔记本电脑上的代码进行版本控制，我总是以我妻子的名字登录。我希望颠覆数据库以我的名义显示更改。

稍后我将复制数据库，以便整个房子都可以访问它。我的妻子使用办公室电脑，她总是以我的名义登录。我可能会设置它，以便它自动签入修改过的文档……最好是在她的名字下。

最终，我可能会在另一个用户名下的 linux 机器上使用它。

有什么办法可以修改用户环境来改变Subversion调用你的用户名吗？我希望像设置`SVN_USERNAME='Mark'`这样的东西会覆盖但它通常会得到名称。

**更新：**看起来`--username`迈克尔提到的标志确实可以更改报告的名称`"svn stat"`，即使对于本地文件：存储库也是如此。此外，它具有粘性，因此您无需为下一个命令指定它。我什至重新启动，它仍然使用`"--username"`我之前启动的值。

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2009-01-01T23:43:01.440

大多数 Subversion 命令都可以`--username`选择指定要用于存储库的用户名。Subversion 会记住每个工作副本中使用的最后一个存储库用户名和密码，这意味着，除其他外，如果您使用，则`svn checkout --username myuser`无需再次指定用户名。

[正如 Kamil Kisiel 所说](https://stackoverflow.com/questions/405690/in-subversion-can-i-be-a-user-other-than-my-login-name#405699)，当 Subversion 直接从文件系统访问存储库时（即存储库 URL 的格式为`file:///path/to/repo`or `file://file-server/path/to/repo`），它使用您的文件系统权限来访问存储库。当您[通过 SSH 隧道](http://svnbook.red-bean.com/nightly/en/svn.serverconfig.svnserve.html#svn.serverconfig.svnserve.sshauth)( `svn+ssh://server/path/to/repo`) 连接时，SVN 会使用您在*服务器*上的 FS 权限，这取决于您的 SSH 登录名。在这些情况下，`svn checkout --username`可能不适用于您的存储库。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2010-03-01T14:59:46.813

对于 svn over ssh 尝试：

```
svn list svn+ssh://[user_name]@server_name/path_to_repo 
```

svn 会提示你输入`user_name`密码。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2011-11-30T17:49:36.183

您可以通过 ~/.subversion/servers 设置默认用户名：

```
[groups]
yourgroupname = svn.example.com

[yourgroupname]
username = yourusername 
```

请注意旧版本的 svn 不支持它（例如 1.3.1 [原文如此！]）。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2011-03-08T16:04:39.443

```
"svn co --username=yourUserName --password=yourpassword http://path-to-your-svn" 
```

在另一个用户帐户上为我工作。不过，系统会提示您再次输入用户名/密码。您需要像上面一样登录一次，然后您就可以准备好以后的时间了（除非您重新启动机器）。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-05-23T14:56:19.517

如果您需要指定与 svn+ssh 一起使用的登录用户以外的用户名，[只需在 .ssh/config 文件中添加一个条目](http://gcc.gnu.org/wiki/SvnTricks#I.27m_also_tired_of_always_typing_mygccuserid.40gcc.gnu.org.__Am_I_able_to_set_a_default_username.3F "SVN 技巧：我可以设置默认用户名吗？")：

```
主机 example.com
用户 jdoe

```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-01-01T23:44:26.663

如果使用我的登录用户名失败，Subversion 通常会询问我的“Subversion 用户名”。所以，当我懒惰时（通常），我会让它询问我的密码，然后我会按 Enter，然后等待用户名提示并使用我的 Subversion 用户名。

否则，Michael 的解决方案是立即指定用户名的好方法。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-04-11T06:57:20.077

大多数答案似乎是针对 svn+ssh 的，或者似乎对我们不起作用。

对于 http 访问，从命令行注销 SVN 用户的最简单方法是：

`rm ~/.subversion/auth/svn.simple/*`

帽子提示：[http ://www.yolinux.com/TUTORIALS/Subversion.html](http://www.yolinux.com/TUTORIALS/Subversion.html)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-01T23:47:25.860

我相信如果您使用 file:// 方法访问您的 subversion 存储库，您的更改总是在访问存储库的用户下执行。您需要使用支持身份验证的方法，例如 http:// 或 svn://。

见[http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.serverconfig.choosing](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.serverconfig.choosing)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-02T00:37:23.670

使用带有 Apache 模块或 svnserve 的 Subversion。我已经能够以多个用户的身份使用`--username`.

每次您以“新”用户身份调用 Subversion 命令时，您的`$HOME/.subversion/auth/<authentication-method>/`目录都会为该用户缓存一个新条目（假设您能够使用正确的密码或身份验证方法对您作为该特定用户联系的服务器进行身份验证） .

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-03-09T20:15:33.857

如果您使用 svn+ssh 连接到存储库，那么唯一可以验证您并授权您的是您的 ssh 凭据。其他一切都被忽略。您的用户名将完全按照您在 ssh 连接中建立的方式登录 subversion。[jimmyg.org/blog/2007/subversion-over-svnssh-on-debian.html](http://jimmyg.org/blog/2007/subversion-over-svnssh-on-debian.html)对此有很好的解释

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-05-31T20:47:18.990

转到`~/.subversion/auth/svn.simple/*`，您将看到一个文件列表，其中包含有关您的 svn 用户帐户的信息。只需删除您不需要的所有其他人。

之后，当你做任何与 SVN 操作有关的事情时，例如 commit、rm 等。系统将再次提示您输入用户名或密码。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-02T00:26:04.893

TortoiseSVN 总是提示输入用户名。（除非你告诉它不要）

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-01-02T00:59:12.207

我相信您可以设置`SVN_USER`环境变量来更改您的 SVN 用户名。

# gravatar - 如何生成像 Stack Overflow 上的随机默认“头像”？

> ID：405717
> 
> 赞同：44
> 
> 时间：2009-01-01T23:59:55.803
> 
> 标签：gravatar

Stack Overflow 如何为不上传图片或未创建 Gravatar 图标的用户自动生成 Gravatar？

这些随机头像来自哪里，我如何为自己的网站生成它们？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-02T00:10:48.950

因为这个查询字符串参数被添加到每个 gravatar 源 URL 中，所以会显示“随机”彩色 gravatar：`d=identicon`

这样做是为了如果用户没有与他的电子邮件相关联的头像图像，则会显示此“随机”图像，而不是默认的蓝色头像图像。

以下显示“默认”蓝色图像，因为不包含该参数： ![替代文字](https://www.gravatar.com/avatar/94d093eda664addd6e450d7e9881bcad?s=32&r=PG)

然而，包含参数的相同 URL`d=identicon`显示了这一点： ![替代文字](https://www.gravatar.com/avatar/94d093eda664addd6e450d7e9881bcad?s=32&d=identicon&r=PG)

这是用于示例的 URL：`https://www.gravatar.com/avatar/94d093eda664addd6e450d7e9881bcad?s=32&d=identicon&r=PG`

顺便说一下，这些图像（称为[Identicons](http://en.wikipedia.org/wiki/Identicon)）并不是真正随机的，而是基于电子邮件哈希生成的。

请参阅[如何生成默认用户头像？](https://meta.stackexchange.com/questions/17443/how-is-the-default-user-avatar-generated)对于该算法的一些语言实现。

# python - 从 Python 修改 Microsoft Outlook 联系人

> ID：405724
> 
> 赞同：8
> 
> 时间：2009-01-02T00:11:57.993
> 
> 标签：python, winapi, outlook, mapi

我过去写过一些 Python 工具来从我的 Outlook 联系人中提取数据。现在，我正在尝试*修改*我的 Outlook 联系人。我发现 Outlook 正在记录我的更改，但它们并没有坚持下去。我似乎正在更新一些缓存，但不是真正的记录。

代码很简单。

```
import win32com.client
import pywintypes

o = win32com.client.Dispatch("Outlook.Application")
ns = o.GetNamespace("MAPI")
profile = ns.Folders.Item("My Profile Name")
contacts = profile.Folders.Item("Contacts")
contact = contacts.Items[43] # Grab a random contact, for this example.
print "About to overwrite ",contact.FirstName, contact.LastName
contact.categories = 'Supplier' # Override the categories

# Edit: I don't always do these last steps.
ns = None 
o = None 
```

此时，我切换到 Outlook，它打开到详细地址卡视图。

我查看了联系人摘要（没有打开它），类别没有变化（没有刷新？）。

我打开联系人，它的类别*有时会*发生变化。（不确定何时，但感觉它与缓存相关。）如果它已更改，它会在我关闭它时提示我保存更改，这很奇怪，因为我没有更改 Outlook UI 中的任何内容。

如果我退出并重新启动 Outlook，更改就会消失。

我*怀疑*我没有调用[SaveChanges](http://msdn.microsoft.com/en-us/library/cc842181.aspx)，但我看不到哪个对象支持它。

所以我的问题是：

*   我应该打电话给 SaveChanges 吗？如果是这样，它在哪里？
*   我是否犯了其他一些愚蠢的错误，导致我的数据被丢弃？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-02T00:44:33.950

我相信联系人上有一个 .Save() 方法，因此您需要添加：

联系。保存（）

# reusability - 项目源或已发布的 DLL？

> ID：405740
> 
> 赞同：1
> 
> 时间：2009-01-02T00:33:28.560
> 
> 标签：reusability

重用代码时（例如，您创建的 Util 库），您是将其项目添加到您的解决方案中还是使用 Util 库中已编译/发布的 DLL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T00:36:48.787

如果一个程序集已经成熟，不太可能改变，或者我相当确定我不需要介入它，我会引用 DLL。如果可能会在程序集的项目中进行更改，或者我可能想要介入其中，我会引用该项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T00:37:09.393

如果我想确保拥有所有更改和最新版本的库，我会添加项目。然后我可以在更新整个解决方案时更新库项目。

如果我想确定我使用的是特定版本的库，我只需添加 dll。

编辑：另外，米奇说的。

# iphone - 在 iPhone 上解析 HTML

> ID：405749
> 
> 赞同：68
> 
> 时间：2009-01-02T00:37:51.080
> 
> 标签：iphone, html, parsing, html-content-extraction

任何人都可以推荐用于 HTML 解析的 C 或 Objective-C 库吗？它需要处理无法完全验证的混乱 HTML 代码。

是否存在这样的库，或者我最好尝试使用正则表达式？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-10-24T15:30:40.633

我发现使用[hpple](http://github.com/topfunky/hpple)来解析凌乱的 HTML 非常有用。Hpple 项目是用于解析 HTML 的 XPathQuery 库的 Objective-C 包装器。使用它，您可以发送 XPath 查询并接收结果。

**要求**：

- 将 libxml2 包含到您的项目中

1.  菜单项目->编辑项目设置
2.  搜索设置“标题搜索路径”
3.  添加新的搜索路径“${SDKROOT}/usr/include/libxml2”
4.  启用递归选项

- 将 libxml2 库添加到您的项目中

1.  菜单项目->编辑项目设置
2.  搜索设置“其他链接器标志”
3.  添加新的搜索标志“-lxml2”

[-从 hpple](http://github.com/topfunky/hpple)获取以下源代码文件并将它们添加到您的项目中：

1.  TFpple.h
2.  TFpple.m
3.  TFppleElement.h
4.  TFppleElement.m
5.  XPathQuery.h
6.  XPathQuery.m

- 浏览[w3school XPath 教程](http://www.w3schools.com/XPath/default.asp)，熟悉 XPath 语言。

**代码示例**

```
#import "TFHpple.h"

NSData *data = [[NSData alloc] initWithContentsOfFile:@"example.html"];

// Create parser
xpathParser = [[TFHpple alloc] initWithHTMLData:data];

//Get all the cells of the 2nd row of the 3rd table 
NSArray *elements  = [xpathParser searchWithXPathQuery:@"//table[3]/tr[2]/td"];

// Access the first cell
TFHppleElement *element = [elements objectAtIndex:0];

// Get the text within the cell tag
NSString *content = [element content];  

[xpathParser release];
[data release]; 
```

**已知的问题**

由于 hpple 是另一个包装器 XPathQuery 的包装器，因此此选项可能不是最有效的。如果您的项目中存在性能问题，我建议您根据 hpple 和 xpathquery 库代码编写您自己的轻量级解决方案。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-01-02T05:35:05.613

看起来像`libxml2.2`在 SDK 中，并`libxml/HTMLparser.h`声称以下内容：

> 该模块实现了一个 HTML 4.0 非验证解析器，其 API 与 XML 解析器兼容。它应该能够解析“真实世界”的 HTML，即使从规范的角度来看严重破坏。

这听起来像是我需要的，所以我可能会使用它。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-03-09T12:57:59.603

以防万一有人通过谷歌搜索一个不错的 XPath 解析器并离开并使用 TFHpple，请注意 TFHpple 使用 XPathQuery。这很好，但有内存泄漏。

在*PerformXPathQuery函数中，如果发现节点为nil，则在清理之前跳出。

所以你在哪里看到这段代码：添加两个清理行。

```
 xmlNodeSetPtr nodes = xpathObj->nodesetval;
  if (!nodes)
    {
      NSLog(@"Nodes was nil.");
        /* Cleanup */
        xmlXPathFreeObject(xpathObj);
        xmlXPathFreeContext(xpathCtx);
      return nil;
    } 
```

如果你正在做大量的解析，这是一个恶性泄漏。现在....我如何让我的夜晚回来:-)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-05-10T21:18:07.673

我围绕 libxml 编写了一个轻量级包装器，它可能有用：

[Objective-C-HMTL-解析器](https://github.com/zootreeves/Objective-C-HMTL-Parser)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-02T02:14:19.417

这可能取决于 HTML 的混乱程度以及您要提取的内容。但通常[Tidy](http://tidy.sourceforge.net/)做得很好。它是用 C 语言编写的，我想您应该能够为 iPhone 构建和静态链接它。您可以轻松安装命令行版本并首先测试结果。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-29T20:46:38.230

您可能想查看 ElementParser。它提供了对 HTML 和 XML 的“刚刚好”的解析。漂亮的界面使浏览 XML/HTML 文档变得非常简单。[http://touchtank.wordpress.com/](http://touchtank.wordpress.com/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-01-27T11:39:41.073

使用 Webkit 组件以及可能的第三方包（如 jquery）来完成此类任务怎么样？难道不能在一个不可见的组件中获取 html 数据并利用 javascript 框架非常成熟的选择器吗？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-02T06:09:22.173

Google 的 GData Objective-C API 重新实现了 Apple 从 iPhone SDK 中删除的 NSXMLElement 和其他相关类。你可以在这里找到它[http://code.google.com/p/gdata-objectivec-client/](http://code.google.com/p/gdata-objectivec-client/)。我用它来通过 Jabber 处理消息。当然，如果您的 HTML 格式不正确（缺少结束标签），这可能无济于事。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-01-12T18:18:50.457

我们使用 Convertigo 在服务器端解析 HTML 并将干净整洁的 JSON Web 服务返回到我们的移动应用程序

# iphone - iPhone游戏开发时使用CALayer和UIView有什么区别？

> ID：405751
> 
> 赞同：0
> 
> 时间：2009-01-02T00:37:59.580
> 
> 标签：iphone, cocoa-touch

对于 iPhone 游戏开发，似乎有很多类似的功能使用 CALayer 和 UIView ，我们可以使用 CALayer 或 UIView 来实现我们的精神，并且动画也可以用于它们。但是对于编码来说，CALayer 和 UIView 有很多区别，比如对象方法和属性等。那么哪个是更好的选择呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-02T00:44:31.237

每个`UIView`都是图层支持的，因此您可以获得任何视图的图层参考。如果您需要它具有 UIResponder 特性（例如，响应事件），您可能应该使用 UIView。

# haskell - Typed FP: Tuple Arguments 和 Curriable Arguments

> ID：405761
> 
> 赞同：7
> 
> 时间：2009-01-02T00:47:53.540
> 
> 标签：haskell, f#, functional-programming, language-design, type-systems

在静态类型的函数式编程语言中，如标准 ML、F#、OCaml 和 Haskell，函数通常会使用彼此分隔的参数和函数名称简单地通过空格来编写：

```
let add a b =
    a + b 
```

这里的类型是“ `int -> (int -> int)`”，即一个函数，它接受一个 int 并返回一个函数，该函数又接受一个 int 并最终返回一个 int。因此，柯里化成为可能。

也可以定义一个以元组作为参数的类似函数：

```
let add(a, b) =
    a + b 
```

`(int * int) -> int`在这种情况下，类型变为“ ”。

从语言设计的角度来看，有什么理由不能简单地识别类型代数中的这两种类型模式？换句话说，使得“(a * b) -> c”简化为“a -> (b -> c)”，从而允许两个变体同样容易地被柯里化。

我想这个问题一定是在设计我提到的四种语言时出现的。那么有没有人知道任何原因或研究表明为什么所有这四种语言都选择不“统一”这两种类型模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-02T02:57:59.157

我认为今天的共识是通过柯里化（表单）来处理*多个参数*`a -> b -> c`，并在您真正想要元组类型的值（在列表等中）时保留元组。自标准 ML 以来，每种静态类型的函数式语言都尊重这种共识，标准 ML（纯粹作为惯例）将元组用于接受多个参数的函数。

为什么会这样？标准 ML 是这些语言中最古老的，当人们第一次编写 ML 编译器时，还不知道如何有效地处理柯里化参数。（问题的根源在于，*任何柯*里化函数*都可能*被您尚未见过的其他代码部分应用，并且您必须在考虑这种可能性的情况下对其进行编译。）由于设计了标准 ML，编译器具有改进了，您可以在[Simon Marlow 和 Simon Peyton Jones 的一篇优秀论文](http://research.microsoft.com/en-us/um/people/simonpj/papers/eval-apply/index.htm)中了解最新技术。

LISP 是所有语言中最古老的函数式语言，其具体语法对柯里化和部分应用*极为*不友好。哼。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-02T01:04:16.720

不将 curried 和 uncurried 函数类型混为一谈的至少一个原因是，当元组用作返回值时会非常混乱（这些类型化语言中返回多个值的一种方便方式）。在混合类型系统中，函数如何保持良好的可组合性？`a -> (a * a)`还会`a -> a -> a`变身？如果是，`(a * a) -> a`和`a -> (a * a)`是同一类型吗？`a -> (a * a)`如果没有，你会如何作曲`(a * a) -> a`？

你为作文问题提出了一个有趣的解决方案。但是，我觉得它并不令人满意，因为它不能很好地与部分应用程序相结合，这确实是柯里化函数的一个关键便利。让我尝试在 Haskell 中说明问题：

```
apply f a b = f a b
vecSum (a1,a2) (b1,b2) = (a1+b1,a2+b2) 
```

现在，也许您的解决方案可以理解`map (vecSum (1,1)) [(0,1)]`，但是等价的`map (apply vecSum (1,1)) [(0,1)]`呢？变得复杂了！您最完整的解包是否意味着 (1,1) 使用 apply 的 a 和 b 参数解包？这不是意图......无论如何，推理变得复杂。

简而言之，我认为在 (1) 保留旧系统下有效代码的语义和 (2) 为合并后的系统提供合理的直觉和算法的同时，将 curried 和 uncurried 函数混为一谈是非常困难的。不过，这是一个有趣的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-02T00:54:33.260

可能是因为将元组作为单独的类型很有用，并且将不同的类型分开很好？

至少在 Haskell 中，从一种形式转换到另一种形式非常容易：

```
Prelude> let add1 a b = a+b
Prelude> let add2 (a,b) = a+b
Prelude> :t (uncurry add1)
(uncurry add1) :: (Num a) => (a, a) -> a
Prelude> :t (curry add2)
(curry add2) :: (Num a) => a -> a -> a 
```

so`uncurry add1`与 相同，`add2`与`curry add2`相同`add1`。我想类似的事情在其他语言中也是可能的。自动柯里化在元组上定义的每个函数会有什么更大的收获？（因为这似乎是你要问的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T01:23:44.620

元组在这些语言中不存在只是为了用作函数参数。它们是表示结构化数据的一种非常方便的方式，例如，2D 点 ( `int * int`)、列表元素 ( `'a * 'a list`) 或树节点 ( `'a * 'a tree * 'a tree`)。还要记住，结构只是元组的语法糖。IE，

```
type info = 
  { name : string;
    age : int;
    address : string; } 
```

是一种处理`(string * int * string)`元组的便捷方式。

在编程语言中没有需要元组的*根本*原因（您可以在 lambda 演算中构建元组，就像您可以使用布尔值和整数一样 - 实际上使用 currying*），但它们方便且有用。

`*`例如，

```
tuple a b = λf.f a b
fst x     = x (λa.λb.a)
snd x     = x (λa.λb.b)
curry f   = λa.λb.f (λg.g a b)
uncurry f = λx.x f 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-02T02:05:21.557

扩展 namin 的好答案下的评论：

所以假设一个函数的类型为`'a -> ('a * 'a)`：

```
let gimme_tuple(a : int) =
    (a*2, a*3) 
```

然后假设一个具有类型的函数`('a * 'a) -> 'b`：

```
let add(a : int, b) =
    a + b 
```

然后组合（假设我建议的合并）不会造成任何问题，据我所知：

```
let foo = add(gimme_tuple(5))
// foo gets value 5*2 + 5*3 = 25 
```

但是你可以设想一个多态函数来代替`add`最后一个代码片段，例如一个小函数，它只接受一个 2 元组并列出两个元素：

```
let gimme_list(a, b) =
    [a, b] 
```

这将具有类型`('a * 'a) -> ('a list)`。现在的作曲将是有问题的。考虑：

```
let bar = gimme_list(gimme_tuple(5)) 
```

`bar`现在会有值`[10, 15] : int list`还是`bar`类型的函数`(int * int) -> ((int * int) list)`，它最终会返回一个列表，其头部是元组`(10, 15)`？为此，我在对 namin 的回答的评论中提出，在类型系统中需要一个额外的规则，即实际参数与形式参数的绑定是“尽可能完整的”，即系统应该尝试非部分绑定首先并且仅在无法实现完全绑定时才尝试部分绑定。在我们的示例中，这意味着我们获得了值`[10, 15]`，因为在这种情况下可以进行完全绑定。

这种“尽可能充分”的概念本身就没有意义吗？我不知道，但我不能立即看到它的原因。

一个问题当然是，如果您*想要*对最后一个代码片段进行第二种解释，那么您需要跳过一个额外的圈（通常是一个匿名函数）来获得它。

# delphi - Delphi IDE - CodeRush 可视“连接器”替代方案

> ID：405764
> 
> 赞同：1
> 
> 时间：2009-01-02T00:52:14.857
> 
> 标签：delphi, ide, coderush

我曾经在 Delphi 6 中工作，并且非常习惯使用 CodeRush 的各种有用的 IDE 添加。许多现在都在 IDE 本身中，或者我已经设法用其他东西替换了，但是我经常发现自己希望我在 Delphi 2007 中仍然拥有的一个功能是 CodeRush 具有在组件之间添加少量“连接线”的能力彼此链接（例如，显示 TDataSet 和 TDataSource 之间连接的线条）。

有没有人在较新的 Delphi IDE 中做出这样的事情？

=== * 稍后说明/澄清 * ===

安德烈亚斯在下面的评论中是正确的......“我不认为他的意思是在源代码上工作的结构突出显示。他想要表单设计器中组件之间的“连接线”。

他还说“据我所知，Delphi 2005 或更高版本没有这样的工具”.. 如果属实，那真是太可惜了。（...如果是这样的话，提出 Delphi IDE 功能请求的最佳位置是什么？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T16:08:15.760

我不认为它存在。提出表单设计器功能请求的最佳地点是[这里](http://qc.codegear.com/wc/qcmain.aspx?da=29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T14:52:13.230

另一个**免费软件/开源**选项是查看支持结构突出显示并在 Delphi 2009 中运行良好的[CNPack](http://www.cnpack.org/index.php?lang=en)。该库还包含对 IDE 的许多其他增强，其中一些在 GExperts 等其他包中重复。我在 2009 年和 2006 年都运行 CNPack 和 GExperts 没有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T09:58:52.770

你想要 Castalia，它在我的 D2007 上可以很好地突出显示结构。 [来自 Twodesk 的 Castalia](http://www.twodesk.com/castalia/)

# c++ - 是否可以将 libxml 与 unicode xmlchar 一起使用？

> ID：405766
> 
> 赞同：1
> 
> 时间：2009-01-02T00:54:59.110
> 
> 标签：c++, unicode, libxml2

是否可以将 libxml 与 unicode 一起使用？

例如 xmlParseDoc 函数采用 xmlChar

xmlChar 具有以下定义：

```
typedef unsigned char xmlChar; 
```

我希望 libxml 将所有内容解释为 2 字节字符。

我有一种感觉，以下内容无法与 lib 一起正常工作：

```
typedef unsigned short xmlChar; 
```

注意：我不是在谈论它何时实际读取/写入 xml 编码。我知道支持unicode。我想要的是进入 lib 的接口使用 unicode 字符串 wstring 而不是普通字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T01:52:51.833

我在@Mitch Wheat 提供的[链接中找到了答案](http://xmlsoft.org/encoding.html)

您不能将 xmlchar 重新定义为无符号短。但是，如果您将字符串编码为 UTF-8，则 xmlChar 将正确处理 unicode。

您可以通过使用 CP_UTF8 参数调用 WideCharToMultiByte 将 windows 中的字符串转换为 UTF8

# performance - 为什么编译器这么笨？

> ID：405770
> 
> 赞同：41
> 
> 时间：2009-01-02T01:01:36.617
> 
> 标签：performance, language-agnostic, compiler-construction

我总是想知道为什么编译器无法弄清楚人眼显而易见的简单事物。他们做了很多简单的优化，但从来没有一点点复杂的东西。例如，此代码在我的计算机上打印零值大约需要 6 秒（使用 java 1.6）：

```
int x = 0;
for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
    x += x + x + x + x + x;
} 
```

```
System.out.println(x); 
```

很明显，x 永远不会改变，所以无论你多久将 0 添加到自身，它都保持为零。所以编译器理论上可以用 System.out.println(0) 代替它。

或者更好的是，这需要 23 秒：

```
public int slow() {
   String s = "x";
   for (int i = 0; i < 100000; ++i) {
       s += "x";
   }
   return 10;
} 
```

首先，编译器可能会注意到我实际上是在创建一个 100000 "x" 的字符串 s，因此它可以自动使用 s StringBuilder 代替，或者更好地直接用生成的字符串替换它，因为它总是相同的。其次，它不承认我实际上根本没有使用字符串，因此可以丢弃整个循环！

为什么在这么多人力投入到快速编译器之后，它们仍然相对愚蠢？

**编辑**：当然，这些都是愚蠢的例子，不应该在任何地方使用。但是，每当我必须将漂亮且可读性强的代码重写为不可读的代码时，以便编译器满意并生成快速代码时，我想知道为什么编译器或其他一些自动化工具不能为我完成这项工作。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-02T01:34:08.250

在我看来，我不相信编译器的工作是修复什么，老实说，糟糕的编码。您已经非常明确地告诉编译器您希望执行第一个循环。它与以下内容相同：

```
x = 0
sleep 6 // Let's assume this is defined somewhere.
print x 
```

我不希望编译器`sleep`仅仅因为它什么也没做就删除我的语句。您可能会争辩说 sleep 语句是对延迟的明确请求，而您的示例不是。但是随后您将允许编译器就您的代码应该做什么做出非常高级的决定，我认为这是一件坏事。

代码和处理它的编译器都是工具，如果你想有效地使用它们，你需要成为一个工具匠。有多少 12 英寸的电锯会拒绝尝试砍倒 30 英寸的树？如果检测到混凝土墙，有多少钻头会自动切换到锤击模式？

没有，我怀疑，这是因为一开始将其设计到产品中的成本将是可怕的。但是，更重要的是，如果您不知道自己在做什么，就不应该使用电钻或电锯。例如：如果您不知道回扣是什么（对于新手来说，这是一种很容易脱手的方法），请远离电锯，直到您知道为止。

我完全赞成允许编译器*提出*改进建议，但我宁愿自己维护控制。编译器不应单方面决定循环是不必要的。

例如，我在嵌入式系统中完成了计时循环，其中 CPU 的时钟速度是准确已知的，但没有可靠的计时设备可用。在这种情况下，您可以精确计算给定循环需要多长时间，并使用它来控制事情发生的频率。如果编译器（或这种情况下的汇编器）认为我的循环无用并将其优化为不存在，那将无法正常工作。

话虽如此，让我给您讲一个关于 VAX FORTRAN 编译器的老故事，该编译器正在进行性能基准测试，发现它比最接近的竞争对手快了*许多数量级。*

事实证明，编译器注意到基准循环的结果没有在其他任何地方使用，并将循环优化为遗忘。

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-01-05T22:43:32.623

哦，我不知道。有时编译器非常聪明。考虑以下 C 程序：

```
#include <stdio.h>  /* printf() */

int factorial(int n) {
   return n == 0 ? 1 : n * factorial(n - 1);
}

int main() {
   int n = 10;

   printf("factorial(%d) = %d\n", n, factorial(n));

   return 0;
} 
```

在我的[GCC版本（](http://en.wikipedia.org/wiki/GNU_Compiler_Collection) [Debian](http://en.wikipedia.org/wiki/Debian)测试中为4.3.2 ）上，当编译时没有优化，或者`-O1`，它会生成`factorial()`你所期望的代码，使用递归调用来计算值。但是`-O2`，它做了一些有趣的事情：它编译成一个紧密的循环：

```
 factorial:
   .LFB13:
           testl   %edi, %edi
           movl    $1, %eax
           je  .L3
           .p2align 4,,10
           .p2align 3
   .L4:
           imull   %edi, %eax
           subl    $1, %edi
           jne .L4
   .L3:
           rep
           ret 
```

相当令人印象深刻。递归调用（甚至不是尾递归）已被完全消除，因此阶乘现在使用 O(1) 堆栈空间而不是 O(N)。虽然我对 x86 汇编只有非常肤浅的了解（在这种情况下实际上是 AMD64，但我认为上面没有使用任何 AMD64 扩展），但我怀疑您是否可以手动编写更好的版本。但真正让我大吃一惊的是它生成的代码`-O3`。阶乘的实现保持不变。但是`main()`变了：

```
 main:
   .LFB14:
           subq    $8, %rsp
   .LCFI0:
           movl    $3628800, %edx
           movl    $10, %esi
           movl    $.LC0, %edi
           xorl    %eax, %eax
           call    printf
           xorl    %eax, %eax
           addq    $8, %rsp
           ret 
```

看到`movl $3628800, %edx`线了吗？**gcc 在编译时进行预计算`factorial(10)`。**它甚至不叫`factorial()`。极好的。我向 GCC 开发团队致敬。

当然，所有常见的免责声明都适用，这只是一个玩具示例，过早优化是万恶之源等等，但它说明编译器通常比你想象的更聪明。如果你认为你可以用手做得更好，那你几乎肯定是错的。

（改编[自我博客上的一篇文章](http://jcreigh.blogspot.com/2008/12/gcc-is-smarter-than-you.html)。）

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-01-02T01:13:02.850

从 C/C++ 的角度来说：

大多数编译器都会优化您的第一个示例。如果 Sun 的 java 编译器真的执行了这个循环，那是编译器的错，但是相信 1990 年以后的任何 C、C++ 或 Fortran 编译器都会完全消除这样的循环。

您的第二个示例无法在大多数语言中进行优化，因为内存分配是将字符串连接在一起的副作用。如果编译器会优化代码，内存分配的模式就会改变，这可能会导致程序员试图避免的影响。内存碎片和相关问题是嵌入式程序员每天仍然面临的问题。

总的来说，我对这些天编译器可以做的优化感到满意。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-01-02T02:50:39.407

编译器被设计成可**预测**的。这可能会让他们有时看起来很愚蠢，但没关系。编译器编写者的目标是

*   您应该能够查看您的代码并对其性能做出合理的预测。

*   代码中的微小更改不应导致性能上的巨大差异。

*   如果一个小改动让程序员看起来应该提高性能，它至少应该不会降低性能（除非硬件中发生了令人惊讶的事情）。

所有这些标准都会影响仅适用于极端情况的“神奇”优化。

* * *

您的两个示例都有一个**在循环中更新但未在其他地方使用的变量**。除非您使用某种可以将死代码消除与其他优化（如复制传播或常量传播）结合起来的框架，否则这种情况实际上很难接受。对于一个*简单*的数据流优化器来说，这个变量看起来并没有死。要了解为什么这个问题很难，请参阅[Lerner、Grove 和 Chambers 在 POPL 2002 中](http://cseweb.ucsd.edu/groups/progsys/pubs/dataflow_popl_02.html)的论文，其中使用了这个例子并解释了为什么它很难。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-01-02T01:34:40.730

HotSpot JIT 编译器只会优化已经运行了一段时间的代码。当您的代码变热时，循环已经开始，JIT 编译器必须等到下一次输入该方法时才寻找优化循环的方法。如果您多次调用该方法，您可能会看到更好的性能。

这在[HotSpot FAQ](http://java.sun.com/docs/hotspot/HotSpotFAQ.html#benchmarking_simple "热点常见问题")中进行了介绍，在“我编写了一个简单的循环来计时一个简单的操作并且它很慢。我做错了什么？”的问题下。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-01-02T01:04:33.800

严重地？为什么有人会编写这样的真实代码？恕我直言，代码而不是编译器是这里的“愚蠢”实体。我非常高兴编译器编写者不会浪费时间尝试优化类似的东西。

**编辑/澄清：** 我知道问题中的代码只是一个例子，但这只是证明了我的观点：你要么必须尝试，要么相当无能，才能编写这样极其低效的代码。握住我们的手不是编译器的工作，因此我们不会编写糟糕的代码。作为编写代码的人，我们有责任对我们的工具有足够的了解，以便高效、清晰地编写代码。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-01-02T08:35:28.447

好吧，我只能说 C++，因为我完全是一个 Java 初学者。在 C++ 中，编译器可以自由地忽略标准提出的任何语言要求，只要**可观察到**的行为**就像**编译器实际上模拟了标准提出的所有规则一样。可观察行为被定义为**对易失性数据的任何读取和写入以及对库函数的调用**。考虑一下：

```
extern int x; // defined elsewhere
for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
    x += x + x + x + x + x;
}
return x; 
```

允许 C++ 编译器优化那段代码，只需将由该循环产生的适当值添加到 x，因为代码的行为**就像**循环从未发生过一样，并且不涉及易失性数据，也不涉及库函数这可能会导致需要的副作用。现在考虑 volatile 变量：

```
extern volatile int x; // defined elsewhere
for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
    x += x + x + x + x + x;
}
return x; 
```

*不允许*编译器再做同样的优化，因为它不能证明写到的副作用`x`不会影响程序的可观察行为。毕竟，x 可以设置为某个硬件设备监视的存储单元，该设备将在每次写入时触发。

* * *

说到 Java，我已经测试了你的循环，碰巧 GNU Java 编译器`gcj`（我启用了优化标志（-O2），它`0`立即打印出来：

```
[js@HOST2 java]$ gcj --main=Optimize -O2 Optimize.java
[js@HOST2 java]$ ./a.out
0
[js@HOST2 java]$ 
```

也许这种观察对这个线程有帮助？为什么gcj碰巧这么快？嗯，一个原因肯定是 gcj 编译成机器代码，因此不可能根据代码的运行时行为优化该代码。它将其所有优点结合在一起，并尝试在编译时尽可能多地进行优化。然而，虚拟机可以及时编译代码，正如这段代码的 java 输出所示：

```
class Optimize {
    private static int doIt() {
        int x = 0;
        for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
            x += x + x + x + x + x;
        }
        return x;
    }
    public static void main(String[] args) {
        for(int i=0;i<5;i++) {
            doIt();
        }
    }
} 
```

输出`java -XX:+PrintCompilation Optimize`：

```
1       java.lang.String::hashCode (60 bytes)
1%      Optimize::doIt @ 4 (30 bytes)
2       Optimize::doIt (30 bytes) 
```

如我们所见，它 JIT 编译了 doIt 函数 2 次。根据对第一次执行的观察，它会对其进行第二次编译。但它恰好与字节码大小相同两次，表明循环仍然存在。

正如另一位程序员所展示的那样，某些死循环的执行时间甚至在某些情况下对于随后编译的代码也会增加。他报告了一个可以在[此处](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6763452)阅读的错误，截至 2008 年 10 月 24 日。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-01-02T01:12:50.960

在您的第一个示例中，这是一种仅在值为零时才有效的优化。编译器中需要寻找这个很少见的子句的额外`if`语句可能不值得（因为它必须检查每个变量）。此外，这又如何：

```
int x = 1;
int y = 1;
int z = x - y;
for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
    z += z + z + z + z + z;
}
System.out.println(z); 
```

这显然仍然是同一件事，但现在我们必须在编译器中编写一个额外的案例。有无数种方法最终可能为零，不值得编码，我猜你可能会说，如果你要拥有其中的一个，你不妨拥有它们。

一些优化确实处理了您发布的第二个示例，但我认为我在函数式语言中看到的更多，而不是 Java。使新语言变得困难的最大事情是[猴子补丁](https://blog.codinghorror.com/monkeypatching-for-humans/)。现在`+=`可能会产生[副作用](https://en.wikipedia.org/wiki/Side_effect_(computer_science))，这意味着如果我们对其进行优化，它可能是错误的（例如，添加`+=`打印出当前值的功能将意味着完全不同的程序）。

但这又归结为同样的事情：您必须寻找太多案例以确保没有执行可能会改变最终程序状态的副作用。

花一点时间来确保你正在写的是你真正希望计算机做的事情，这更容易。:)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-01-02T01:27:32.570

编译器通常非常聪明。

您必须考虑的是，它们必须考虑到优化或重构代码可能导致不必要的副作用的每个可能的异常或情况。

诸如线程程序、指针别名、动态链接代码和副作用（系统调用/内存分配）等使正式证明重构变得非常困难。

即使您的示例很简单，但仍然可能需要考虑一些困难的情况。

至于您的 StringBuilder 参数，这不是编译器选择为您使用的数据结构的工作。

如果您想要更强大的优化，请转向更强类型的语言，如 fortran 或 haskell，编译器可以使用更多信息。

大多数教授编译器/优化（甚至在学术上）的课程都对如何使一般的正式证明的优化而不是破解特定案例是一个非常困难的问题感到赞赏。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-01-02T01:13:25.860

我认为您低估了确保一段代码不会影响另一段代码的工作量。只需对您的示例 x、i 和 s 稍作改动，就可以全部指向同一个内存。一旦其中一个变量是指针，就很难判断哪些代码可能会产生副作用，具体取决于指向什么。

另外，我认为编写编译器的人宁愿花时间进行人类不容易做到的优化。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-02T01:13:56.137

因为我们还没有到达那里。您可以很容易地问：“为什么我还需要编写程序……为什么我不能直接输入需求文档并让计算机为我编写应用程序？”

编译器编写者将时间花在小事情上，因为这些是应用程序程序员往往会错过的类型。

此外，他们不能假设太多（也许你的循环是某种贫民窟时间延迟或其他东西）？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-02T01:21:04.970

这是编译器编写者和程序员之间永恒的军备竞赛。

非人为的示例效果很好——大多数编译器确实优化了明显无用的代码。

人为的检查*总是*难倒编译器。证明，如果需要的话，任何程序员都比任何程序更聪明。

将来，您将需要比您在此处发布的示例更多的人为示例。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-02T03:18:04.843

由于其他人已经充分解决了您问题的第一部分，我将尝试解决第二部分，即“自动使用 StringBuilder 代替”。

不按照您的建议做有几个很好的理由，但在实践中最大的因素可能是优化器在实际源代码被消化和遗忘后很长时间才运行。优化器通常对生成的字节码（或汇编、三地址码、机器码等）或解析代码产生的抽象语法树进行操作。优化器通常对运行时库（或任何库）一无所知，而是在指令级别（即低级别控制流和寄存器分配）进行操作。

其次，随着库的发展（尤其是在 Java 中）比语言快得多，跟上它们并知道什么会弃用什么以及其他库组件可能更适合该任务将是一项艰巨的任务。也可能是不可能的，因为这个提议的优化器必须准确理解您的意图和每个可用库组件的意图，并以某种方式找到它们之间的映射。

最后，正如其他人所说（我认为），编译器/优化器编写者可以合理地假设编写输入代码的程序员不是脑死的。当其他更通用的优化比比皆是时，投入大量精力来处理像这些愚蠢的特殊情况将是浪费时间。此外，正如其他人也提到的，看似脑死的代码可能有实际目的（自旋锁、系统级屈服之前的忙等待等），编译器必须尊重程序员的要求（如果它在语法和语义上都是有效的）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-02T01:17:28.190

你编译发布代码了吗？我认为一个好的编译器在您的第二个示例中检测到该字符串从未使用过，并删除了整个循环。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-02T02:41:45.167

实际上，Java 应该在第二个示例中使用字符串生成器。

试图优化这些例子的基本问题是这样做需要*定理证明*。这意味着编译器需要构建一个数学证明来证明你的代码实际上会做什么。这根本不是一项小任务。事实上，能够证明**所有**代码确实有效果，就等同于停机问题。

当然，你可以想出一些琐碎的例子，但琐碎的例子的数量是无限的。你总是可以想到别的东西，所以没有办法把它们都抓住。

当然，有可能证明**某些**代码没有任何效果，就像您的示例一样。您想要做的是让编译器优化可以在 P 时间证明未使用的每个问题。

但无论如何，这是大量的工作，它并不能让你得到那么多。人们花了很多时间试图找出防止程序出现错误的方法，而 Java 和 Scala 中的类型系统正在尝试防止错误，但现在没有人使用类型系统来声明执行时间， 据我所知。

您可能想研究 Haskel，我认为它具有最先进的理论证明材料，尽管我对此不确定。我自己不知道。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-02T03:29:37.800

绝对优化是一个不可判定的问题，这意味着没有图灵机（因此没有计算机程序）可以产生任何给定程序的最佳版本。

可以（并且实际上已经）完成了一些简单的优化，但是，在您给出的示例中......

1.  要检测您的第一个程序总是打印零，编译器必须检测 x 尽管所有循环迭代都保持不变。你怎么能向编译器*解释*（我知道，这不是最好的词，但我想不出另一个词）？

2.  编译器如何知道 StringBuilder 是适合该工作的工具，而无需对其进行任何参考？

~~在现实世界的应用程序中，如果效率对应用程序的一部分至关重要，那么它必须用 C 之类的低级语言编写。~~（哈哈，认真的，我写了这个？）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-02T03:52:47.767

您主要抱怨的是“为什么 Java 编译器如此愚蠢”，因为大多数其他语言编译器都更聪明。

Java 编译器愚蠢的原因是历史性的。首先，最初的 java 实现是基于解释器的，性能被认为是不重要的。其次，许多原始的 Java 基准测试存在优化问题。我记得一个看起来很像你的第二个例子的基准。不幸的是，如果编译器优化了循环，当基准测试试图将基线数除以经过的时间来计算其性能得分时，它会得到除以零的异常。因此，在编写优化 java 编译器时，您必须非常小心，不要优化某些东西，因为人们会声称您的编译器已损坏。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-02T04:58:45.170

在编译为 JVM 字节码时，优化这样的事情几乎被认为是不好的做法。Sun`javac`确实有一些基本的优化，如`scalac`,`groovyc`等。简而言之，任何真正特定于语言的东西都可以在编译器中得到优化。然而，像这样明显被人为设计成与语言无关的事情将完全脱离政策。

这样做的原因是它允许 HotSpot 对字节码及其模式有一个更加一致的视图。如果编译器开始处理边缘情况，这会降低 VM 优化一般情况的能力，这在编译时可能并不明显。Steve Yeggie 喜欢强调这一点：由聪明的虚拟机在运行时执行优化通常*更容易。*他甚至声称 HotSpot 去除了 javac 的优化。虽然我不知道这是否属实，但我不会感到惊讶。

总而言之：针对 VM 的编译器有一套非常不同的标准，特别是在优化领域和适当的时候。不要责怪编译器编写者将工作留给功能更强大的 JVM。正如在该线程上多次指出的那样，针对本机架构（如`gcc`系列）的现代编译器*非常*聪明，通过一些非常智能的优化生成非常快的代码。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-02T05:59:19.650

首先，我从未见过消除死代码的意义。程序员为什么要写？？如果你打算对死代码做点什么，声明它是编译器错误！这几乎可以肯定意味着程序员犯了错误——在少数情况下它没有，使用变量的编译器指令将是正确的答案。如果我将死代码放入我希望它执行的例程中——我可能正计划在调试器中检查结果。

编译器可以做一些好事的情况是提取循环不变量。有时，清晰地说在循环中编码计算并让编译器将这些东西拉出来会很好。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-06-04T10:20:09.877

可以进行严格混叠优化的编译器将优化第一个示例。见[这里](http://www.cellperformance.com/mike_acton/2006/06/understanding_strict_aliasing.html)。

第二个示例无法优化，因为这里最慢的部分是内存分配/重新分配，并且 operator+= 被重新定义为一个处理内存的函数。字符串的不同实现使用不同的分配策略。

我自己也宁愿拥有 malloc(100000) 而不是千 malloc(100) 在做 s += "s"; 但是现在这东西超出了编译器的范围，必须由人们进行优化。这就是 D 语言试图通过引入[纯函数](http://en.wikipedia.org/wiki/Pure_function)来解决的问题。

正如这里在其他答案中所提到的，perl 在不到一秒的时间内完成了第二个示例，因为它分配的内存比请求的多，以防万一以后需要更多内存。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-10-01T04:33:57.900

在发布模式 VS 2010 C++ 中，这不需要任何时间来运行。然而调试模式是另一回事。

```
#include <stdio.h>
int main()
{
    int x = 0;
    for (int i = 0; i < 100 * 1000 * 1000 * 1000; ++i) {
        x += x + x + x + x + x;
    }
    printf("%d", x);
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-02T08:29:35.307

这是程序代码与功能代码的示例。

您已经详细说明了编译器要遵循的过程，因此优化将基于详细的过程，并将最大限度地减少任何副作用或不优化它不会按照您的预期进行的地方。这使得调试更容易。

如果您输入您想要的功能描述，例如。SQL 那么你就为编译器提供了广泛的优化选项。

也许某种类型的代码分析能够在运行时找到此类问题或分析，但随后您将希望将源更改为更合理的东西。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-13T20:13:23.443

因为编译器编写者尝试为重要的事情添加优化（我希望）并且在 *Stone 基准测试中测量（我担心）。

还有无数像你这样的其他可能的代码片段，它们什么都不做，可以通过增加编译器编写者的努力来优化，但几乎从未遇到过。

我感到尴尬的是，即使在今天，大多数编译器也会生成代码来检查 switchValue 是否大于 255，以检查无符号字符上的密集或几乎完全开关。这为大多数字节码解释器的内部循环添加了 2 条指令。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-11-06T03:18:48.423

我讨厌在这么老的问题上提出这个问题（无论如何，我是怎么到这里的？），但我认为其中一部分可能是 Commodore 64 时代的顽固分子。

在 1980 年代初期，一切都在固定的时钟上运行。没有 Turbo Boosting 并且总是为具有特定处理器和特定内存等的特定系统创建代码。在 Commodore BASIC 中，实现`delay`s 的标准方法看起来很像：

```
10 FOR X = 1 TO 1000
20 NEXT : REM 1-SECOND DELAY 
```

（实际上，在实践中，它更接近于`10FORX=1TO1000:NEXT`，但你知道我的意思。）

如果他们要对此进行优化，它将破坏一切——任何事情都不会被计时。我不知道有什么例子，但我敢肯定，在编译语言的历史中散布着很多这样的小事情，这些事情阻碍了事情的优化。

诚然，这些非优化在今天*是*不必要的。然而，编译器开发人员可能有一些潜规则，不要优化这样的事情。我不会知道的。

很高兴您的代码经过了一些优化，这*与*C64 上的代码不同。使用最高效的 BASIC 循环在 C64 上显示位图可能需要 60 秒；因此，大多数游戏等都是用机器语言编写的。用机器语言编写游戏并不好玩。

只是我的想法。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-11-23T09:58:17.460

前提：我在大学学习编译器。

javac 编译器非常愚蠢，并且完全不执行任何优化，因为它依赖于 java 运行时来执行它们。运行时会捕获并优化它，但只有在函数执行几千次后才会捕获它。

如果您使用更好的编译器（如 gcc）启用优化，它将优化您的代码，因为这是一个非常明显的优化。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-03-17T15:41:31.857

编译器的工作是优化代码***如何****做某事*，而不是优化*代码做****什么***。

 *当你编写一个程序时，你是在告诉计算机该做什么。如果编译器更改了您的代码以执行与您指示不同的操作，那么它就不是一个很好的编译器！当您编写 时`x += x + x + x + x + x`，您明确告诉计算机您希望它设置`x`为自身的 6 倍。编译器可能会很好地优化它是*如何*做到这一点的（例如乘以`x`6 而不是重复加法），但无论如何它仍然会以某种方式计算该值。

> 如果你不想做某事，不要告诉别人去做。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2009-01-02T08:30:12.170

你的两个例子的意思是没有意义的，无用的，只是为了愚弄编译器。

编译器不能（也不应该）看到方法、循环或程序的含义。这就是你进入图片的地方。你为某种功能/意义创建了一个方法，不管它有多愚蠢。对于简单的问题或极其复杂的程序也是如此。

在您的情况下，编译器可能会对其进行优化，因为它“认为”应该以另一种方式对其进行优化，但是为什么要留在那里呢？

极端的其他情况。我们有一个编译 Windows 的智能编译器。大量代码要编译。但如果它很聪明，它可以归结为 3 行代码......

```
"starting windows"
"enjoy freecell/solitaire"
"shutting down windows" 
```

其余的代码已经过时了，因为它从未被使用、触摸、访问过。我们真的想要吗？

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2009-01-13T20:24:19.320

编译器和我们制造的一样聪明。我不知道有多少程序员会费心编写一个编译器来检查诸如您使用的构造之类的构造。大多数人专注于更典型的提高性能的方法。

有可能有一天我们会拥有可以真正学习和成长的软件，包括编译器。当那一天到来时，大多数，也许是所有人，程序员都会失业。

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2009-01-02T01:09:14.510

它迫使你（程序员）思考你在写什么。强迫编译器为你做你的工作对任何人都没有帮助：它使编译器更复杂（而且更慢！），它让你更愚蠢，对你的代码更不关注。

# iphone - 有没有基于 Cocos2d 的开源 iPhone 游戏？

> ID：405772
> 
> 赞同：5
> 
> 时间：2009-01-02T01:03:16.893
> 
> 标签：iphone, cocoa-touch, cocos2d-iphone

想学Cocos2d，看来是个不错的iPhone游戏编程框架。那么有没有基于 Cocos2d 的开源 iPhone 游戏呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T02:13:17.000

问这个问题的地方是[cocos2d google group](http://groups.google.com/group/cocos2d-iphone-discuss?pli=1)。

我相信有几个游戏和游戏演示可供研究。开发人员非常积极地使用该框架，尽管他目前正在休假。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-18T04:49:58.897

Tweejump [http://tweejump.com/](http://tweejump.com/) [http://github.com/haqu/tweejump/tree/master](http://github.com/haqu/tweejump/tree/master)

ABC123 [http://kwigbo.com/wp/2009/05/02/abc123-iphone-cocos2d-game-open-source/](http://kwigbo.com/wp/2009/05/02/abc123-iphone-cocos2d-game-open-source/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T12:36:57.260

以下是大量示例的列表，所有示例均基于 Cocos2d：

[http://www.cocos2d-iphone.org/forum/topic/24798](http://www.cocos2d-iphone.org/forum/topic/24798)

下载页面的直接链接：

[https://docs.google.com/spreadsheet/ccc?key=0Ap9yzw5RaZIZdFNoWEtvTXdfbThHM0hJUGxWUHZwSGc#gid=0](https://docs.google.com/spreadsheet/ccc?key=0Ap9yzw5RaZIZdFNoWEtvTXdfbThHM0hJUGxWUHZwSGc#gid=0)

注意：单击“DropBox”链接以获取源代码，而无需在其他站点进行大量点击。

# c# - .NET 64 位升级

> ID：405776
> 
> 赞同：0
> 
> 时间：2009-01-02T01:05:49.167
> 
> 标签：c#, 64-bit, upgrade

将 dotnet 应用程序从 32 位迁移到 64 位时要寻找的最佳资源是什么。

* * *

类似的问题

[在 x64 和 x86 上运行 .net 程序是否需要考虑任何因素？](https://stackoverflow.com/questions/145026/are-there-any-considerations-needed-to-be-taken-running-your-net-program-on-x64)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-02T01:26:20.560

*   这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms973190.aspx)很有用。
*   这个[博客](http://blogs.msdn.com/joshwil/archive/tags/Writing+code+targeted+at+64bit_2E00_/default.aspx)有一些很好的 .NET 64 位信息。
*   运行内置或独立的 FxCop 并修复其所有 64 位警告，尤其是在 P/Invoke 周围。
*   **编辑：**[如果您](http://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx)在代码中使用 IntPtr 或调用 x86 编译程序集，请小心。

就是这样，真的。只要您注意 FxCop 警告并重新编译您的代码（以避免 32 位 WOW 层），您应该没问题。

# php - PDO查询问题

> ID：405782
> 
> 赞同：1
> 
> 时间：2009-01-02T01:11:19.093
> 
> 标签：php, mysql, pdo

我正在将一些代码从旧的 mysql_* 函数更新到 PDO。它连接没有问题，运行查询没有问题，但结果集是空的。PDO::query() 应该返回一个 PDOStatement 对象，但我得到的回报是真实的。没有错误报告。

这是我的代码：

```
 try
{
    $DB = new PDO("mysql:host=localhost;dbname=dbname", "user", "pass");
    $stmt = $DB->prepare("SELECT * FROM report_clientinfo");
    $stmt->execute();
}catch(PDOException $e)
{
    echo $e->getMessage() . "\n";
}

echo gettype($stmt) . "\n";
if ($stmt) echo "true\n";
else echo "false\n";

$resultset = $stmt->fetchAll();

if(empty($resultset))
{
    exit("ERROR: getClientInfo query failed.");
}

$DB = null;

print_r($resultset); 
```

我看到的输出是：

object true 错误：getClientInfo 查询失败。

任何想法为什么它没有返回任何结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-02T01:22:24.733

```
object  
true  
ERROR: getClientInfo query failed. 
```

在我看来，您的`PDOStatement $stmt`变量实际上被报告为一个对象，而不是“ `true`”。然后，当代码`true`看到它`$stmt`是非空的时，它会打印“”，因为它是一个对象。

我建议您检查从`$stmt->execute()`. 您可能遇到 SQL 错误。例如，如果您拼错了表名，或者该表在`dbname`您连接的数据库“ ”中不存在，或者您登录的用户没有权限查询该表。

还要检查[`$stmt->errorInfo()`](http://php.net/manual/en/pdostatement.errorinfo.php)以获取有关发生的任何错误的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T03:31:20.090

我有点尴尬地报告说我指向了错误的 DSN。我想这就是我在跨年夜外出后仅仅几个小时的睡眠就尝试学习新东西的结果。感谢 PDOStatement::errorInfo() 方法的提示，我之前没有注意到它。

# html - 与书签链接混淆的基本标签

> ID：405786
> 
> 赞同：2
> 
> 时间：2009-01-02T01:13:06.310
> 
> 标签：html, hyperlink

我有一个`mod_rewrite`用于创建漂亮 url 的 Joomla 网站。

```
http://www.example.com/resources/newsletter 
```

然而，这产生了一个问题。包括这样的图像: `src="images/pic.jpg"`，然后它会在以下位置查找文件：

```
http://www.example.com/resources/newsletter/images/pic.jpg 
```

...这显然不存在。为了解决这个问题，我`<base>`在我的部分中添加了一个标签`head`：

```
<base href="http://www.example.com/" /> 
```

...效果很好，直到我尝试在同一页面上创建指向锚点（书签）的链接：

```
<!-- on http://www.example.com/resources/newsletter -->
<a href="#footer">go to the footer</a>

<!-- clicking that link takes you to http://www.example.com/#footer --> 
```

将我的链接更改`<a href="resources/newsletter/#footer">`为不可行，因为我在编辑页面时不一定知道页面的 URL。有什么方法可以让某些链接忽略该`<base>`指令？

虽然我真的更喜欢直接的 HTML 解决方案，但我已经在这个站点上使用了 jQuery，所以如果我被卡住了，这可能是一个选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T01:33:33.353

是否可以将您的`src`属性更改为类似的东西`/images/pic.jpg`？这样就可以达到你想要的效果。

如果这是不可能的，这个（未经测试的）jQuery代码应该适合你：

```
$('a[@href^="#"]').click(function() { 
  var hash = this.hash, el = $(hash), offset;
  if(!el.size()) {
    el = $("[@name=" + hash.slice(1) + "]");
  }

  offset = el.offset();
  window.scroll(offset.left, offset.top);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-07T01:26:04.217

老问题，新答案..试试这个：

```
$('a[href^="#"]').on('click', function (event) { 
    event.preventDefault();
    window.location.hash = $(this).attr('href');
}); 
```

# mysql - MySQL 与 SQL Server Express 性能比较

> ID：405795
> 
> 赞同：1
> 
> 时间：2009-01-02T01:19:22.600
> 
> 标签：mysql, sql-server, performance, comparison

我有一个有点复杂的查询，大约有 100K 行。

查询在 SQL Server Express 中运行 13 秒（在我的开发盒上运行）

具有相同索引和表的相同查询需要超过 15 分钟才能在 MySQL 5.1 上运行（在我的生产机器上运行 - 功能更强大，并且经过 100% 资源测试）有时查询会因内存不足错误而导致机器崩溃。

我在 MySQL 中做错了什么？为什么需要这么长时间？

```
select e8.*
from table_a e8
inner join (
    select max(e6.id) as id, e6.category, e6.entity, e6.service_date
    from (
        select e4.* 
        from table_a e4
        inner join (
            select max(e2.id) as id, e3.rank, e2.entity, e2.provider_id, e2.service_date
            from table_a e2
            inner join (
                select min(e1.rank) as rank, e1.entity, e1.provider_id, e1.service_date
                from table_a e1
                where e1.site_id is not null
                group by e1.entity, e1.provider_id, e1.service_date 
            ) as e3
            on e2.rank= e3.rank
            and e2.entity = e3.entity
            and e2.provider_id = e3.provider_id
            and e2.service_date = e3.service_date
            and e2.rank= e3.rank
            group by e2.entity, e2.provider_id, e2.service_date, e3.rank
        ) e5
        on e4.id = e5.id
        and e4.rank= e5.rank                            
    ) e6
    group by e6.category, e6.entity, e6.service_date 
) e7
on e8.id = e7.id and e7.category = e8.category 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T14:01:18.903

这个答案我最初试图发布到您已删除的问题，但并未表明这是 MySQL 的问题。我仍然会继续使用 SQL Server 使用 CTE 重构查询，然后转换回嵌套查询（如果有的话）。对格式感到抱歉，杰夫·阿特伍德（Jeff Atwood）将原始发布的文本发给了我，我不得不再次重新格式化。

没有数据、预期结果和好的名称很难做到，但我会将所有嵌套查询转换为 CTE，将它们堆叠起来，有意义地命名它们并重构 - 从排除您不使用的列开始。删除列不会导致改进，因为优化器非常聪明——但它会让你有能力改进你的查询——可能会排除部分或全部 CTE。我不确定您的代码在做什么，但您可能会发现新的 RANK() 类型函数很有用，因为您似乎正在使用带有所有这些自连接的回溯类型的模式。

所以从这里开始吧。我已经为您查看了 e7 的改进，e7 中未使用的列可能表明存在缺陷或对分组可能性的考虑不完整，但如果这些列确实是不必要的，那么这可能会一直渗透到您在 e6 中的逻辑中， e5 和 e3。如果 e7 中的分组是正确的，那么您可以消除结果和连接中除了 max(id) 之外的所有内容。我不明白为什么每个类别会有多个 MAX(id)，因为这会在您加入时成倍增加您的结果，因此 MAX(id) 在类别中必须是唯一的，在这种情况下，该类别在连接中是多余的。

```
WITH e3 AS (
select min(e1.rank) as rank,
e1.entity,
e1.provider_id,
e1.service_date
from table_a e1
where e1.site_id is not null
group by e1.entity, e1.provider_id, e1.service_date
)

,e5 AS (
select max(e2.id) as id,
e3.rank,
e2.entity,
e2.provider_id,
e2.service_date
from table_a e2
inner join e3
on e2.rank= e3.rank
and e2.entity = e3.entity
and e2.provider_id = e3.provider_id
and e2.service_date = e3.service_date
and e2.rank= e3.rank
group by e2.entity, e2.provider_id, e2.service_date, e3.rank
)

,e6 AS (
select e4.* -- switch from * to only the columns you are actually using
from table_a e4
inner join e5
on e4.id = e5.id
and e4.rank= e5.rank
)

,e7 AS (
select max(e6.id) as id, e6.category -- unused, e6.entity, e6.service_date
from e6
group by e6.category, e6.entity, e6.service_date
-- This instead
-- select max(e6.id) as id
-- from e6
-- group by e6.category, e6.entity, e6.service_date
)

select e8.*
from table_a e8
inner join e7
on e8.id = e7.id
and e7.category = e8.category
-- THIS INSTEAD on e8.id = e7.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T01:22:57.273

如果有效的索引可用，100,000 行不应该花费 13 秒。我怀疑这种差异是由于 SQL Server 具有比 MySQL 更强大的查询优化器这一事实。MySQL 的功能更像是 SQL 解析器而不是优化器。

对于初学者，您需要提供更多信息 - 所有参与表的完整模式，以及每个表的完整索引列表。

然后了解数据是关于什么的，以及查询打算产生什么。用例的顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T02:14:19.247

用两者来解释计划会很有趣，看看有什么区别。我不确定这是否是苹果和橙子的比较，但我会很好奇。

我不知道[这](http://www.informit.com/articles/article.aspx?p=377652&seqNum=2)是否有帮助，但这是搜索“mysql 查询优化器”时的第一次点击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T02:20:53.477

这是[另一个](http://20bits.com/articles/10-tips-for-optimizing-mysql-queries-that-dont-suck/)可能值得的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T21:18:54.300

我知道的唯一拥有 CTE 的开源数据库是 Firebird ( [http://www.firebirdsql.org/rlsnotesh/rlsnotes210.html#rnfb210-cte](http://www.firebirdsql.org/rlsnotesh/rlsnotes210.html#rnfb210-cte) )

我认为 Postgres 将在 8.4

# jquery - 我将如何为使用 jquery 刷新的动态内容进行适当的淡入淡出？

> ID：405797
> 
> 赞同：1
> 
> 时间：2009-01-02T01:20:46.203
> 
> 标签：jquery

我有一个需要包含在页面中的 .txt 文件，该文件每 5 秒动态更新一次，因此我需要通过 ajax 刷新它，以便在不刷新页面的情况下看到更新的内容。我想这样做，使其淡入 div，每 5 秒更新一次。

目前我正在这样做，这看起来很丑陋

```
function getSearches() {
      $("#latest_searches").animate({ 
        opacity: 0.3
      }, 1000 );

$("#latest_searches").load("_latest_searches.php", '', callback);
}

function callback() {
  $("#latest_searches").animate({ 
        opacity: 1
      }, 1000 );

setTimeout("getSearches();", 5000);
}

$(document).ready(getSearches); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T01:36:13.613

我认为您想创建类似[Digg Spy 的](http://leftlogic.com/lounge/articles/jquery_spy2/)效果，请查看[此演示](http://leftlogic.com/jquery/spy.html)。

还要查看这篇文章/截屏视频：[简单的 jQuery 间谍效果](http://jqueryfordesigners.com/simple-jquery-spy-effect/)

# java - 大量数据 - 发送它们的最佳方式是什么？

> ID：405800
> 
> 赞同：4
> 
> 时间：2009-01-02T01:21:17.917
> 
> 标签：java, networking, data-transfer

我们有这种情况：

包含所需数据的服务器和这些数据所需的客户端组件。

服务器上存储了 2 种类型的数据： - 一些信息 - 基本上只有几个字符串 - 二进制数据

我们在获取二进制数据时遇到了问题。双方都是用 Java 5 编写的，所以我们有几种方法......

由于速度、内存等原因，Web 服务不是最佳解决方案......

那么，你更喜欢什么？

如果可能的话，我想错过低级套接字连接......

提前致谢

维泰克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-02T01:52:29.587

我认为处理大量数据的唯一方法是使用原始套接字访问。

您将使用大多数其他方法在大文件上遇到内存不足问题。

套接字处理在 Java 中非常简单，它可以让您流式传输数据而无需将整个文件加载到内存中（这是在没有您自己的缓冲的情况下在幕后发生的事情）。

使用这种策略，我设法构建了一个允许传输任意大文件的系统（我使用 7 GB 以上的 DVD 映像来测试系统），而不会遇到内存问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-02T03:34:48.927

查看 W3C 标准 MTOM 以将二进制数据作为 SOAP 服务的一部分进行传输。它是高效的，因为它作为二进制发送，也可以作为缓冲块发送。它还将与其他客户端或提供者互操作：

[如何进行 MTOM 互操作](http://blogs.msdn.com/smguest/archive/2005/06/30/434218.aspx)

[服务器端 - 使用 SOAP 发送附件](http://www.theserverside.com/tt/articles/article.tss?l=SendingAttachmentsWithSOAP)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-02T01:33:36.707

你可能想看看[protobuf](http://code.google.com/p/protobuf/)，这是 google 用来交换数据的库。它非常高效且可扩展。在旁注中，永远不要低估装满 1TB 硬盘的旅行车的带宽！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-02T01:26:08.453

我尝试将二进制数据转换为 Base64，然后通过 SOAP 调用发送它，它对我有用。我不知道这是否算作一项 Web 服务，但如果是的话，那么您几乎就被套接字困住了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T01:39:25.760

一些选项：

*   您可以使用 RMI，它会为您隐藏套接字级别的东西，也许 gzip 数据......但如果连接失败，它将不会为您恢复。可能也会遇到内存问题。

*   只需 HTTP 二进制 mime 类型的数据（同样可能在网络服务器上配置 gzip）。简历上的类似问题。

*   产生类似 wget 的东西（我认为这可以恢复）

*   如果客户端已经有数据（它的以前版本），rsync 将只复制更改

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-02T01:49:45.380

旧的、负担得起的和强大的 FTP 怎么样？例如，您可以轻松地将 FTP 服务器嵌入到服务器端组件中，然后编写 FTP 客户端。FTP 正是为此而生的（文件传输协议，不是吗？），而带有附件的 SOAP 在设计时并没有考虑到这些东西，而且性能很差。例如，您可以查看：

[http://mina.apache.org/ftpserver/](http://mina.apache.org/ftpserver/)

但是还有其他实现，Apache Mina 只是我记得的第一个。

祝你好运和问候

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-02T01:55:20.813

[运动鞋网](http://en.wikipedia.org/wiki/Sneakernet)是一种选择吗？:P

RMI 以其易用性和内存泄漏而闻名。被警告。根据我们谈论的数据量，sneakernet 和套接字都是不错的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-02T02:27:31.327

将GridFTP视为您的[传输](http://www.globus.org/alliance/publications/clusterworld/0404GridFinal.pdf)层。另请参阅[此问题](https://stackoverflow.com/questions/227117/file-transfer-protocol-options#227195)。

# iphone - 我可以通过 SDK 访问 iphone 上的可视语音邮件文件吗？

> ID：405808
> 
> 赞同：2
> 
> 时间：2009-01-02T01:27:24.987
> 
> 标签：iphone, sdk

我想访问存储在 iphone 上的可视语音邮件文件。有没有办法通过 SDK 访问这些文件？有人有处理这些文件的经验吗？我假设它们是从网络下载并本地存储在 iphone 上的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T01:36:59.120

不，iPhone 上的每个应用程序都是隔离的，因此您无法访问任何其他应用程序的数据，除非 Apple 专门为此提供 API，就像他们为联系人列表所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T01:39:35.523

不 - 问题在于 Apple 提供的访问应用程序“沙箱”之外数据的方法很少。此时，您实际上只能通过支持的方法访问联系人数据和相机。如果您尝试在不使用 Apple 提供的为此目的设计的公共 API 的情况下访问应用程序外部的数据，您的应用程序很可能不会在应用程序商店中被允许。也许这会在未来改变，但我不会屏住呼吸。

# .net - .NET 矩形数组：如何循环访问？

> ID：405810
> 
> 赞同：3
> 
> 时间：2009-01-02T01:27:58.310
> 
> 标签：.net, arrays, loops

基本上你有两种方法可以做到这一点：

```
for (int x = 0; x < UPPER_X; x++)
    for (int y = 0; y < UPPER_Y; y++)
    {        
        arr1[x, y] = get_value();
        arr2[y, x] = get_value();
    } 
```

唯一的区别是内部循环中要更改的变量：第一个或第二个。我听说结果因语言而异。

.NET 的正确顺序是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T01:37:26.903

您应该确定您的特定情况。

您会认为矩形数组（即连续分配的内存）没有区别，但是根据这篇[MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163995.aspx)有区别：

> 通过将多维数组转换为一维数组，您可以获得更好的结果。如果您不介意语法，这可能是微不足道的；只需使用一个索引作为偏移量。例如，以下声明一个单维数组用作二维数组：

```
double[] myArray = new double[ROW_DIM * COLUMN_DIM]; 
```

> 要索引此数组的元素，请使用以下偏移量：

```
myArray[row * COLUMN_DIM + column]; 
```

> 这无疑会比等效的锯齿状或矩形阵列更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T03:28:49.440

一个比另一个快的原因与处理器的缓存以及数据在内存中的布局方式有关。

将二维数据存储在一维地址空间中有两种常规方法，您可以存储第一行的所有数据，然后是第二行，依此类推（又名[*行主要顺序*](http://en.wikipedia.org/wiki/Row-major_order)），或者您可以按列（又名列[*主要顺序*](http://en.wikipedia.org/wiki/Row-major_order#Column-major_order)）来完成。下面是这两个选项的 3x3 阵列的内存位置。

行：

```
1 2 3
4 5 6
7 8 9 
```

列：

```
1 4 7
2 5 8
3 6 9 
```

当您访问一个内存位置时，整个缓存行（根据 Wikipedia 可以在 8 到 512 个字节之间）被加载到缓存中。因此，如果您访问下一个内存位置，它将已经在缓存中。因此，顺序访问内存比在地址空间中跳转要快得多。因此，对于大型二维数组，在选择行或列作为内部循环变量之间可能存在显着的速度差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T02:12:08.923

所以我做了基准测试，结果是访问 arr1 快了三倍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-02T03:54:22.773

非常有趣，我从来没有停下来考虑过，仅仅通过“非顺序”访问数组索引就可以产生如此巨大的差异。我自己试了一下，还发现以下代码的第二个循环要长 2 到 3 倍：

```
// Hmmm, how to insert blank lines in the code formatter???
static void Main(string[] args)
{
    Stopwatch timer = new Stopwatch();
    int arraySize = 10000;

    // First array, access X by Y
    int[,] xbyy = new int[arraySize, arraySize];

    timer.Start();
    for (int x = 0; x < arraySize; x++)
        for (int y = 0; y < arraySize; y++)
        {
            xbyy[x, y] = 15;
        }
    timer.Stop();
    TimeSpan duration = timer.Elapsed;
    string realTimeFormat = string.Format("{0:00} minutes {1:00} seconds {2:000} milliseconds",
                    duration.Minutes, duration.Seconds, duration.Milliseconds);
    Console.WriteLine("X by Y took " + realTimeFormat);

    // Seecond array, access Y by X
    int[,] ybyx = new int[arraySize, arraySize];

    timer.Start();
    for (int x = 0; x < arraySize; x++)
        for (int y = 0; y < arraySize; y++)
        {
            ybyx[y, x] = 15;
        }
    timer.Stop();
    duration = timer.Elapsed;
    realTimeFormat = string.Format("{0:00} minutes {1:00} seconds {2:000} milliseconds",
                duration.Minutes, duration.Seconds, duration.Milliseconds);
    Console.WriteLine("Y by X took " + realTimeFormat);

    Console.ReadLine();
} 
```

为了简短起见，这里是 X by Y 循环和 Y by X 循环的发出的 IL 片段。

循环之前的初始代码，

```
.method private hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       290 (0x122)
  .maxstack  4
  .locals init ([0] class [System]System.Diagnostics.Stopwatch timer,
           [1] int32 arraySize,
           [2] int32[0...,0...] xbyy,
           [3] int32 x,
           [4] int32 y,
           [5] valuetype [mscorlib]System.TimeSpan duration,
           [6] string realTimeFormat,
           [7] int32[0...,0...] ybyx,
           [8] int32 V_8,
           [9] int32 V_9)
  IL_0000:  newobj     instance void [System]System.Diagnostics.Stopwatch::.ctor()
  IL_0005:  stloc.0
  IL_0006:  ldc.i4     0x2710
  IL_000b:  stloc.1 
```

用 Y 循环 X

```
 IL_000c:  ldloc.1
  IL_000d:  ldloc.1
  IL_000e:  newobj     instance void int32[0...,0...]::.ctor(int32,
                                                             int32)
  IL_0013:  stloc.2
  IL_0014:  ldloc.0
  IL_0015:  callvirt   instance void [System]System.Diagnostics.Stopwatch::Start()
  IL_001a:  ldc.i4.0
  IL_001b:  stloc.3
  IL_001c:  br.s       IL_003d
  IL_001e:  ldc.i4.0
  IL_001f:  stloc.s    y
  IL_0021:  br.s       IL_0034
  IL_0023:  ldloc.2
  IL_0024:  ldloc.3
  IL_0025:  ldloc.s    y
  IL_0027:  ldc.i4.s   15
  IL_0029:  call       instance void int32[0...,0...]::Set(int32,
                                                           int32,
                                                           int32)
  IL_002e:  ldloc.s    y
  IL_0030:  ldc.i4.1
  IL_0031:  add
  IL_0032:  stloc.s    y
  IL_0034:  ldloc.s    y
  IL_0036:  ldloc.1
  IL_0037:  blt.s      IL_0023
  IL_0039:  ldloc.3
  IL_003a:  ldc.i4.1
  IL_003b:  add
  IL_003c:  stloc.3
  IL_003d:  ldloc.3
  IL_003e:  ldloc.1
  IL_003f:  blt.s      IL_001e
  IL_0041:  ldloc.0 
```

用 X 循环 Y

```
 IL_0090:  ldloc.1
  IL_0091:  ldloc.1
  IL_0092:  newobj     instance void int32[0...,0...]::.ctor(int32,
                                                             int32)
  IL_0097:  stloc.s    ybyx
  IL_0099:  ldloc.0
  IL_009a:  callvirt   instance void [System]System.Diagnostics.Stopwatch::Start()
  IL_009f:  ldc.i4.0
  IL_00a0:  stloc.s    V_8
  IL_00a2:  br.s       IL_00c7
  IL_00a4:  ldc.i4.0
  IL_00a5:  stloc.s    V_9
  IL_00a7:  br.s       IL_00bc
  IL_00a9:  ldloc.s    ybyx
  IL_00ab:  ldloc.s    V_9
  IL_00ad:  ldloc.s    V_8
  IL_00af:  ldc.i4.s   15
  IL_00b1:  call       instance void int32[0...,0...]::Set(int32,
                                                           int32,
                                                           int32)
  IL_00b6:  ldloc.s    V_9
  IL_00b8:  ldc.i4.1
  IL_00b9:  add
  IL_00ba:  stloc.s    V_9
  IL_00bc:  ldloc.s    V_9
  IL_00be:  ldloc.1
  IL_00bf:  blt.s      IL_00a9
  IL_00c1:  ldloc.s    V_8
  IL_00c3:  ldc.i4.1
  IL_00c4:  add
  IL_00c5:  stloc.s    V_8
  IL_00c7:  ldloc.s    V_8
  IL_00c9:  ldloc.1
  IL_00ca:  blt.s      IL_00a4
  IL_00cc:  ldloc.0 
```

IL 逻辑流程有些相似。我可以观察到的主要区别是第一个循环设法将 stloc 和 ldloc 用于第一个数组的位置 2 和 3 以及 X 索引变量。到第二个循环时，它已经消耗了 maxstack，因此使用了 stloc.s 和 ldloc.s 指令。我相信这是在堆栈上引用变量与在堆上引用变量之间的区别，并导致性能下降。

现在，如果您交换测试循环的顺序，以便首先运行 Y by X 循环以访问堆栈引用，您将看到时序持续时间被反转。

* * *

更新：关于引用堆栈或堆地址我错了。似乎方法中的前四个变量用专用的 stloc.0, 1, 3, 4 和 ldloc.0, 1, 3, 4 操作码来引用更有效。

[http://weblogs.asp.net/mnolton/archive/2004/01/09/48992.aspx](http://weblogs.asp.net/mnolton/archive/2004/01/09/48992.aspx)

# silverlight - silverlight...使用相对路径文件的超链接按钮

> ID：405812
> 
> 赞同：6
> 
> 时间：2009-01-02T01:29:54.937
> 
> 标签：silverlight, download

我正在尝试使用 silverlight 中的超链接按钮来使用户能够下载 word 文档。我不在乎是否出现文件​​另存为框或单词 doc 是否在新浏览器中打开。我收到错误“无法导航到相对于页面的位置”。我已经看到它发布了您可以使用绝对路径（www.domain.com/filename.doc）执行此操作，但必须有一种方法可以使此相对路径（/docs/filename.doc）。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-02-22T06:10:02.937

稍微容易一点：

```
Uri myAbsoluteUri = new Uri(HtmlPage.Document.DocumentUri, myRelativePath); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-02T18:21:00.283

HyperlinkBut​​ton 仅适用于绝对 URL，因此您应该在运行时修复您的 URL：

```
uriCurrent = System.Windows.Browser.HtmlPage.Document.DocumentUri;
string current = uriCurrent.OriginalString;
int iLastSlash = current.LastIndexOf('/') + 1;
current = current.Remove(iLastSlash, current.Length - iLastSlash); 
```

来自[Silverlight.net 论坛](http://silverlight.net/forums/t/12073.aspx)。

# java - 快速 Java 问题：仅从另一个类实例化给定类？

> ID：405826
> 
> 赞同：4
> 
> 时间：2009-01-02T01:37:36.903
> 
> 标签：java, class, instantiation

因此，我的问题是：我需要一种方法来确保只有一个给定的类可以实例化另一个。我不想让另一个嵌套的内部类或类似的愚蠢。我该怎么做呢？我一下子忘记了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-02T01:46:33.640

私有静态内部类正是您想要的。没什么愚蠢的。

```
public class Creator {
  private static class Created {
  }
} 
```

否则，您只能在包级别保护实例化。

```
public class Created {
  Created() {
  }
} 
```

这仅使来自同一包的类可以访问构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T01:45:26.200

您可以将要从实例化包中保护的类设为私有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T01:48:38.580

将构造函数设为私有。创建一个静态工厂方法，该方法采用允许访问的类的实例。让工厂方法创建一个合适的对象，并在允许访问创建的对象的对象上使用设置器，为该类提供创建的副本。

```
public class AllowedAccess
{
    private SecureClass secure;
    public setSecureClass( SecureClass secure )
    {
        this.secure = secure;
    }

    ...
}

public class SecureClass
{
     private SecureClass() {}

     public static void Create( AllowedAccess allowed )
     {
          allowed.setSecureClass( new SecureClass() );
     }

     ...
} 
```

顺便说一句，我对这种设计持怀疑态度。对我来说似乎太耦合了。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-02T02:11:28.690

我同意 tvanfosson 的回答以及他关于耦合太高的评论。为什么不通过采用像[Spring](http://www.springsource.org/)或[Guice这样](http://code.google.com/p/google-guice/)[的控制反转](http://martinfowler.com/bliki/InversionOfControl.html)框架来保留对类创建过程的更多控制？

恕我直言，使用“new”语句创建类被认为有点......过时了，工厂将是首选，而 IoC 框架则更多。

问候

# php - 未设置或空字符串——如果它最终向用户显示“无”会更好？

> ID：405842
> 
> 赞同：1
> 
> 时间：2009-01-02T01:52:05.577
> 
> 标签：php

我想知道您是否使用未设置的变量、空字符串（或 0）或“无”来确定变量是否为“无”？

我正在考虑的情况是，我正在从数据库中检索某些内容，但发现没有为记录设置值，通常是由没有记录或空值决定的。这将向用户显示为“无”或“未设置”。

所以问题是，当将此值传递给脚本的另一部分（即另一个函数、脚本、模板等）时，我是否：

*   不设置变量（因此检查它是否在模板中设置）
*   将变量设置为空字符串或 0（并检查模板中的空字符串）
*   将变量设置为“无”或“未设置”并回显变量

有没有你经常做的事情，你为什么这样做？

（我使用的是 PHP，所以变量的类型有点不重要。）

我正在寻找一个普遍的答案；我知道这并不总是正确的，而是要遵循的一般规则。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T01:58:40.510

在可能的情况下，我通常会使用语言中的 nil 值映射到 NULL。

如果值设置为空字符串、无或未设置，当您真正的意思是 NULL 时，您提到的其他选项都可能出现与数据库中相同的歧义问题。

如果用户可以更新值，也存在传播回数据库的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T02:01:52.423

我认为我不会做的唯一选择是第三种选择。“无”或“未设置”看起来确实像一个 UI 描述符，并不适合设置为稍后由代码解释的值。

唯一的例外是如果您有一组已知值。如果它们或多或少是常数。

*   没有设置
*   不
*   是的

其中 NOT_SET 可能是默认值。不过，在这种情况下，我仍然不会简单地向用户回显“未设置”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T03:26:21.627

正如您自己所说，“无”或“未设置”值仅在向用户显示时才相关。对于所有内部使用，该值应该是本机 NULL 值。人类可读的值只能由将值呈现到输出流中的任何函数替换

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T04:06:51.297

在 PHP 中，您可以将变量设置为 FALSE 或 NULL，然后说：

```
if($var === FALSE)
    ... 
```

（注意三个等号）

您应该明确设置该值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T04:28:44.217

我建议将其设置为`NULL`. 如果您从数据库中获取值，并且它在`NULL`(SQL) 那里，那么获取记录的 PHP 函数很可能会为该字段返回`NULL`(PHP)。

您可以将您的字符串与`NULL`PHP 中的字符串进行比较，如下所示：

```
if($myString === NULL) {
    /* It's NULL! */
} 
```

如果您希望显示某个字符串而不是`NULL`（当转换为字符串时，等于“”），您可以将其设置为：

```
if($myString === NULL) {
    $myString = 'None';
} 
```

考虑到您以后可能需要重构代码以进行国际化。如果您在整个代码中使用用户字符串，则执行此操作会困难得多。

简单地不设置变量是不好的，因为您可能会打错变量名称，并想知道为什么设置它时仍然显示“无”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-02T02:21:31.913

通常，我发现最好在整个程序中始终如一地处理数据结构。这意味着当我将数据库中未设置的变量传递给程序的其他部分时，它们保持不变。如果特定函数需要不同格式的数据，我会在执行过程中强制转换或检查边界条件。

# svn - 将 svn 与 Textmate 一起使用

> ID：405850
> 
> 赞同：7
> 
> 时间：2009-01-02T01:56:19.563
> 
> 标签：svn, textmate

来自具有全面 svn 支持的 IDE，例如 Eclipse 和 Netbeans，我想知道将 svn 与 Textmate 一起使用的推荐方法是什么？都是手动的，即使用命令行，还是有允许您在 Textmate 本身中进行差异/签入/合并/等的功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-02T01:59:39.557

有一个 textmate 插件可以在这里找到：[http ://www.reinventar.com/2008/07/svn-plugin-for-textmate/](http://www.reinventar.com/2008/07/svn-plugin-for-textmate/)

那篇文章中提到的插件是 SVNMate

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-02T02:32:01.863

Ciarán Walsh 已经用[ProjectPlus](http://ciaranwal.sh/projectplus)取代了 SVNMate——除了 Subverison 之外，它还处理 Git、Mercurial、Bazaar 和 Svk。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-02T02:11:11.560

我从未真正使用过它，但 TextMate 中没有现有的[Subversion 包](http://manual.macromates.com/en/bundles#subversion)。这对你来说还不够吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T05:52:56.370

可以通过 ctrl-shift-a 访问 svn 菜单。我发现这个包比在 Eclipse 中使用 svn 有点不直观，但它确实完成了这项工作。我发现的一个问题是，您需要在项目中至少打开一个文件才能使 svn 菜单选项可用。我一完成文件就关闭标签，所以这已经出现了几次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T15:24:00.343

尽管 Project Plus 非常适合快速查看文件状态，但您可能仍然需要 SVN 包来进行差异和合并——我不得不说现有的 SVN 包处理得很好。

尝试查看合并选项；您可以对差异进行并排比较，从任一文件中选择要包含在合并中的内容。

你不能做的是对任意文件做差异 - 但是你可以使用差异包来做到这一点，很有趣。这不是我需要经常做的事情，但它已经派上用场了几次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-30T13:02:26.070

project plus 是 textmate 进行版本控制的方式；）

# sql - 为另一个模式中的表创建触发器时权限不足

> ID：405889
> 
> 赞同：6
> 
> 时间：2009-01-02T02:27:05.257
> 
> 标签：sql, oracle, plsql, triggers, oracle10g

当我尝试在模式 A 中为模式 B 中的表创建触发器时，我收到一个 ora 错误：权限不足。

我需要什么特权？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-02T02:37:20.043

如果您在架构中创建触发器，则需要 CREATE TRIGGER 权限。为了在其他人的模式中创建触发器，您需要 CREATE ANY TRIGGER 权限。

[该资源](https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_7004.htm)很好地解释了需求，并包含有关触发器的更多信息（语法、启用、禁用等）。

# iis-6 - FastCGI 问题和包含 index.php 的链接？与 index.php

> ID：405894
> 
> 赞同：0
> 
> 时间：2009-01-02T02:29:49.793
> 
> 标签：iis-6, windows-server-2003, fastcgi, expressionengine

在运行 IIS 6.0 和 FastCGI 的 Windows 2003 服务器上，我遇到了一个问题，即包含 index.php 的链接会失败，除非添加问号。

基本问题是，如果链接指向“index.php/archive/article”，则页面无法加载（见下文），但在使用“index.php?/archive/article”时它会工作。

当“index.php”链接失败时，浏览器地址栏中的 URL 会发生变化，但仍显示主页内容。将问号附加到“index.php”，页面加载正确。

该站点以前使用 ISAPI 作为服务器 API 运行，没有任何问题：服务器看到“index.php”和“index.php？” 作为同义词，路径中带有“index.php”的页面将按预期加载。

我将如何在某处配置设置来告诉 FastCGI 处理“index.php”和“index.php”？一样的方法？

谈到 Windows 服务器，我有点不喜欢。我的经验主要是在 Unix 机器上运行的 Apache 服务器。

任何指导或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T01:08:28.057

一种选择是您可以简单地[启用 EE 的强制 URL 查询字符串选项](http://expressionengine.com/docs/cp/admin/system_preferences/output_and_debugging_preferences.html)。

但是，如果您不喜欢 URL 中的问号，您可以尝试[这种解决方法](http://expressionengine.com/wiki/Workaround_for_Forced_Query_Strings/)。

我不能说我对 Windows 服务器一无所知，但是当将 PHP 作为 CGI 运行时，这对我在 Apache 服务器上有效。祝你好运！

# php - Zend_Form - 基于数组的元素？

> ID：405897
> 
> 赞同：16
> 
> 时间：2009-01-02T02:31:57.337
> 
> 标签：php, zend-framework, zend-form

使用 Zend_Form，我将如何创建这样的表单元素：

```
<input type="text" name="element[1]" value="" />
<input type="text" name="element[2]" value="" />
// etc... 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-02T08:07:25.743

您可以使用子表单：

```
$form = new Zend_Form();

$subForm = new Zend_Form_SubForm();
$subForm->addElement('Text', '1')
        ->addElement('Text', '2');

$form->addSubForm($subForm, 'element'); 
```

或者您也应该能够`setBelongsTo()`在表单元素上使用（未经测试）：

```
$form = new Zend_Form();
$form->addElement('Text', '1', array('belongsTo' => 'element'))
     ->addElement('Text', '2', array('belongsTo' => 'element')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-21T22:41:07.983

我认为这`setBelongsTo`是不合格的质量，因为无法设置默认值。因此，目前，没有合理的方法可以实现您的目标。

# asp.net - 在 ASP.Net 中使 javascript 对象名称唯一的想法？

> ID：405901
> 
> 赞同：0
> 
> 时间：2009-01-02T02:32:28.227
> 
> 标签：asp.net, javascript, function, prototype, unique

我创建了一个 ASP.Net 用户控件，该控件将多次放置在网页中。在这个控件中，我定义了一个 javascript 对象，例如：

```
function MyObject( options )
{
  this.x = options.x;
}

MyObject.prototype.someFunction=function someFunctionF()
{
  return this.x + 1;
} 
```

在后面的代码中，我在启动脚本中创建了 MyObject --

```
var opts = { x: 99 };

var myObject = new MyObject( opts ); 
```

当控件中的某个按钮被按下时，它将调用 myObject.someFunction()。现在假设 x 的值对于一个控件将是 99，而对于另一个控件则为 98。这里的问题是 var myObject 将被重复，只有最后一个实例很重要。当然，有一种方法可以使 var myObject 使用一些我还没有遇到过的概念独一无二。想法？

谢谢，

克雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T11:50:04.940

你的 Javascript 是这样的：-

```
function MyObject(options) { this.x = options.x; }
MyObject.prototype.someFunction = function() { return this.x + 1; }
MyObject.create(id, options) {
    if (!this._instances) this._instances = {};
    return this._instances[id] = new MyObject(options);
}
MyObject.getInstance(id) { return this._instances[id]; } 
```

你的启动 javascript 是这样的：-

```
MyObject.create(ClientID, {x: 99}); 
```

其他需要使用实例的代码（比如在客户端的 onclick 事件中）

```
String.Format("onclick=\"MyObject.getInstance('{0}').someFunction()\", ClientID); 
```

注意对客户端全局命名空间的影响很小，只有 MyObject 标识符被添加到全局命名空间，而不管有多少控件实例被添加到页面中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T02:40:37.743

如果它只是一个值，为什么不让函数将其作为参数并构建您的 onclick 处理程序，以便为每个控件输入正确的值。如果它比这更复杂，则考虑将选项设置为一个数组，并且对于每个控件，将正确的选项插入到数组中与每个特定控件相对应的位置。然后将适当的索引传递到数组中的函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T03:53:33.897

为此，我使用 ScriptManager.RegisterClientScriptBlock 将字符串注册为客户端的 JavaScript 块。然后我可以使用 {0}、{1}..、{n} 占位符修改我的脚本字符串以注入必要的 ID。这取决于您的代码结构，这是否是最优雅的方式，但它在紧要关头起作用。然后，您可以使用对 Me.ClientID 的引用来注入变量名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T04:22:09.957

您可以将“x”的值设为静态并在代码中的任何位置访问它，例如：

```
function MyObject( options ) { MyObject.x = options.x; }
MyObject.x = 99; // static
MyObject.prototype.someFunction = function () { return MyObject.x + 1; } 
```

这样您就可以在代码中的任何位置访问 MyObject.x，甚至无需重新实例化 MyObject。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T14:54:47.280

优秀的解决方案安东尼。提供的其他解决方案同样好，我确实考虑过它们，但我正在寻找像这个解决方案这样更优雅的东西。谢谢！

# database - 处理用户输入时的 NULL vs Empty

> ID：405909
> 
> 赞同：6
> 
> 时间：2009-01-02T02:39:24.437
> 
> 标签：database, null

是的，另一个 NULL 与空字符串的问题。

我同意 NULL 表示未设置，而空字符串表示“空值”的想法。这是我的问题：如果列的默认值为 NULL，我如何允许用户输入该 NULL。

假设在系统上创建了一个新用户。有一个名字和姓氏字段；姓是必需的，而名字不是。创建用户时，此人将看到 2 个文本输入，一个用于第一个，一个用于最后一个。此人选择仅输入姓氏。名字在技术上没有设置。在插入期间，我检查每个字段的长度，将所有为空的字段设置为 NULL。

查看数据库时，我看到没有设置名字。立即想到的问题是，也许他们从未见过名字字段（即，由于错误）。但这种情况并非如此; 如果空白，他们就离开了。

所以，我的问题是，当接收用户输入时，您如何决定何时将字段设置为 NULL 或空字符串？你怎么知道用户希望在没有检测到焦点的情况下不设置该字段，或者他们是否删除了一个值......或......或......？

相关问题：[我应该使用 NULL 还是空字符串来表示表列中没有数据？](https://stackoverflow.com/questions/167952/null-or-empty-string-to-represent-no-data-in-table-column)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-02T03:24:04.923

我将打破这种模式，并说我总是将 NULL 用于零长度字符串，原因如下。

1.  如果您开始细化空白的含义，那么您必须以某种方式确保每个其他开发人员都以相同的方式读取和写入它。

2.  你如何按字母顺序排列它？

3.  与故意将其留空相比，您能否明确确定用户何时省略输入值？

4.  您将如何明确地询问差异？查询屏幕用户能否使用标准输入表单语法指示 NULL 与空白？

5.  在实践中，我从未被禁止使用默认的、使用此规则的行为来读取和写入数据。如果我需要知道区别，我使用了一个布尔字段（它更容易映射到明确的 UI 设备）。在一种情况下，我使用触发器来强制执行 True => null 值，但从未见过它被调用，因为 BR 层有效地过滤了条件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-02T02:48:50.643

如果用户提供了一个空字符串，从数据库的角度来看，我总是将其视为 null。此外，我通常会修剪我的字符串输入以删除前导/尾随空格，然后检查是否为空。这是使用 varchar() 类型在数据库中的一个小胜利，它还减少了搜索的情况，因为我只需要检查`name is null`而不是`name is null or name = ''` 你也可以采用另一种方式，将 null 转换为 ''。无论哪种方式，选择一种方式并保持一致。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-02T02:47:43.423

你需要做的是弄清楚你想要什么*行为*。对于如何解释名称字符串，没有一个固定的代数。

想想这里的状态机：你有几个状态的字段：它看起来像你在考虑“未初始化”状态，另一个“故意空”状态和第三个具有一些设定值的状态。您所做的任何与您的程序的其余部分一致的任务都会被找到；听起来很容易映射

NULL → 未初始化的
"" → 故意取消设置
名称 → 已初始化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-02T02:49:36.320

在引用实际数据时，我几乎从不使用 NULL。当用于外键时，我会说 NULL 是有效的，但它几乎对用户输入的数据无效。可能会经常出现的一个例外是不存在的日期，例如具有“termination_date”字段的员工数据库。在这种情况下，所有当前员工在该字段中的值都应为 NULL。至于让他们实际输入一个空值，对于真正需要一个空值的值，我会在输入字段旁边放一个复选框，以便用户可以打开和关闭它以查看对应的空值（或以更用户友好的方式，没有）。启用复选框将字段设置为空时，应禁用相应的文本框，如果已关联空值，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T02:44:07.190

我尽量保持简单。在这种情况下，我会让 first-name 列不可为空并允许空白。否则，您将在引用此字段的任何地方处理三种情况：

1.  空白的名字
2.  空名字
3.  非空名

如果您选择“空白为空”或“空为空白”，那么您将面临两种情况。两个案例比三个好。

为了进一步回答您的问题：输入数据的用户可能不（也不应该）知道什么是“null”以及它与“empty”的比较。这个问题应该在系统而不是 UI 中干净一致地解决。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T10:39:29.410

虽然您的示例主要用于字符串，但我想说我将 null 用于数字和布尔字段。账户余额 0 对我来说是非常不同的，因为它是空的。布尔值也是如此，如果人们进行了真假答案的多项选择测试，那么了解某人的答案是真假还是根本没有回答是非常重要的。在这些情况下不使用 null 将需要我有一个额外的表格或不同的设置来查看是否有人回答了问题。例如，您可以使用 -1 来表示未填写，0 表示假，1 表示真，但随后您将数字字段用于本质上是布尔值的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-02T02:43:53.820

我从来没有在生产代码中使用过 NULL 值。空字符串是任何应用程序的空白名称字段、电话号码或年收入的精细标记值。也就是说，我相信你可以找到一些用处，但我只是认为它被过度使用了。*但是，*如果我要使用 NULL 值，我想我会在任何我想表示空值的地方使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-25T18:14:16.697

我一直使用`NULL`未初始化的值、`empty`故意为空的值和`0`关闭指标。

通过一直这样做，即使我不使用它，它也在那里，但如果我需要这种区别，我不必做任何不同的事情。

我通常会测试，`empty()`但有时我会检查`isset()`评估`false`。`NULL`这对于提醒回答某些问题很有用。如果是`empty`，`false`则`0`问题已回答。

# c# - 使用 C# 获取插入行的 id

> ID：405910
> 
> 赞同：26
> 
> 时间：2009-01-02T02:40:05.480
> 
> 标签：c#, mysql, last-insert-id

我有一个查询要在表中插入一行，该表有一个名为 ID 的字段，该字段使用列上的 AUTO_INCREMENT 填充。我需要为下一个功能获取这个值，但是当我运行以下命令时，即使实际值不是 0，它也总是返回 0：

```
MySqlCommand comm = connect.CreateCommand();
comm.CommandText = insertInvoice;
comm.CommandText += "\'" + invoiceDate.ToString("yyyy:MM:dd hh:mm:ss") + "\', " + bookFee + ", " + adminFee + ", " + totalFee + ", " + customerID +  ")";
int id = Convert.ToInt32(comm.ExecuteScalar()); 
```

根据我的理解，这应该返回 ID 列，但它每次只返回 0。有任何想法吗？

**编辑：**

当我运行时：

```
"INSERT INTO INVOICE (INVOICE_DATE, BOOK_FEE, ADMIN_FEE, TOTAL_FEE, CUSTOMER_ID) VALUES ('2009:01:01 10:21:12', 50, 7, 57, 2134);last_insert_id();" 
```

我得到：

```
{"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'last_insert_id()' at line 1"} 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-02-06T11:07:33.140

```
MySqlCommand comm = connect.CreateCommand();
comm.CommandText = insertStatement;  // Set the insert statement
comm.ExecuteNonQuery();              // Execute the command
long id = comm.LastInsertedId;       // Get the ID of the inserted item 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-02T02:48:54.073

[编辑：在引用 last_insert_id() 之前添加了“选择”]

`select last_insert_id();`插入后运行“”怎么样？

```
MySqlCommand comm = connect.CreateCommand();
comm.CommandText = insertInvoice;
comm.CommandText += "\'" + invoiceDate.ToString("yyyy:MM:dd hh:mm:ss") + "\', "  
    + bookFee + ", " + adminFee + ", " + totalFee + ", " + customerID +  ");";
    + "select last_insert_id();"

int id = Convert.ToInt32(comm.ExecuteScalar()); 
```

* * *

**编辑：正如 duffymo 所提到的，使用**[像这样](http://weblogs.asp.net/cumpsd/archive/2004/04/05/107456.aspx)的参数化查询确实会为您提供很好的服务。

* * *

**编辑：**在您切换到参数化版本之前，您可能会发现 string.Format 很平静：

```
comm.CommandText = string.Format("{0} '{1}', {2}, {3}, {4}, {5}); select last_insert_id();",
  insertInvoice, invoiceDate.ToString(...), bookFee, adminFee, totalFee, customerID); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-28T11:38:29.947

使用 LastInsertedId。

在此处查看我的建议示例：http: [//livshitz.wordpress.com/2011/10/28/returning-last-inserted-id-in-c-using-mysql-db-provider/](http://livshitz.wordpress.com/2011/10/28/returning-last-inserted-id-in-c-using-mysql-db-provider/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T02:55:20.893

看到有人拿日期并将其作为字符串存储在数据库中，我感到很困扰。为什么不让列类型反映现实？

我也很惊讶看到使用字符串连接构建 SQL 查询。我是一名 Java 开发人员，我根本不懂 C#，但我想知道库中的某处是否没有类似于 java.sql.PreparedStatement 的绑定机制？推荐用于防范 SQL 注入攻击。另一个好处是可能的性能好处，因为 SQL 可以被解析、验证、缓存一次并重用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T03:11:29.600

实际上，ExecuteScalar 方法返回正在返回的 DataSet 的第一行的第一列。在你的情况下，你只是在做一个插入，你实际上并没有查询任何数据。您需要在插入后查询 scope_identity() （这是 SQL Server 的语法），然后您就会得到答案。看这里：

[连锁](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)

**编辑：**正如 Michael Haren 指出的那样，您在标签中提到您正在使用 MySql，使用 last_insert_id(); 而不是 scope_identity();

# wpf - WPF - 在 StackPanel 中设置 Horizo ntalAlignment= 拉伸到文本框

> ID：405935
> 
> 赞同：14
> 
> 时间：2009-01-02T03:04:20.660
> 
> 标签：wpf, stackpanel, autosize

为什么文本框不拉伸以填充堆栈面板中的空间？这是设计使然吗？在网格中，文本框按预期伸展。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-02T08:24:52.447

是的，这是设计使然。将`StackPanel`分配所`TextBox`要求的空间。如果您没有在 上设置宽度`TextBox`，则它只需要足够的宽度来适应其文本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-02T09:00:48.833

肯特的回答似乎是对的。
为了仍然强制覆盖 StackPanel 行为，我认为您需要动态计算设置包含元素的 Width 属性或一些时髦的[MeasureOverride](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.measureoverride.aspx)覆盖。我宁愿使用另一个布局管理器/面板。我注意到的一些事情..

*   子元素的 Horizo​​ntalAlignment 和 VerticalAlignment 属性的默认值为**Stretch**（如果您没有明确指定）。
*   StackPanel 将根据其 Orientation 属性值拉伸元素。所以

    *   Orientation=Horizo​​ntal 表示所有元素将被垂直拉伸到最大。元素水平流动。
    *   方向=垂直意味着所有元素将被水平拉伸到最大。元素垂直流动。
*   除非明确指定，否则子元素的宽度和高度均为 NaN。如果您指定一个明确的值，StackPanel 将在水平和垂直对齐设置上使用它们。
*   StackPanel 本身具有 Horizo​​ntalAlignment 和 VerticalAlignment，这增加了进一步的布局扭曲。您可以试验这个[例子](http://msdn.microsoft.com/en-us/library/ms752328.aspx)。

[堆栈面板](http://msdn.microsoft.com/en-us/library/system.windows.controls.stackpanel.aspx)

> StackPanel 中包含的内容的 Horizo​​ntalAlignment 和 VerticalAlignment 的默认值是拉伸。

[水平对齐](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.horizontalalignment.aspx)

> 当在元素上显式设置 Height 和 Width 属性时，这些测量值在布局期间具有更高的优先级，并将取消将 Horizo​​ntalAlignment 设置为 Stretch 的典型效果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-02T15:57:13.027

我需要物品尺寸均匀，但垂直堆叠。

我使用了 UniformGrid，并将 Columns 属性设置为 1。（使用 TextBox 进行测试，它可以像你想要的那样伸展）

# ajax - Ajax 库的比较

> ID：405936
> 
> 赞同：5
> 
> 时间：2009-01-02T03:05:52.263
> 
> 标签：ajax, comparison, review

谁能指出各种 AJAX 库的良好统一比较？我已经阅读了大约十几个不同的，我即将开始一个项目，我只是不相信我已经探索了可能性的空间。

请注意，我不是在要求“我认为 XXX 很棒”——我正在寻找良好的全面比较。哦，我会使用 .NET 或 ASP.NET 的可能性很小；我没有任何可用的 Microsoft 环境，也不急于获得一个。

好的，这背后的原因是我有几个想要构建的小应用程序。它们都或多或少有点像游戏，而且没有*那么*复杂，其中一部分目的是获得一些 AJAX 和 DHTML 的经验。我怀疑任何主要的包都可以工作，比如 Rico、Scriptaculous 或 Dojo。

我将寻找一些东西：图形，通过 SVG 或 Canvas，以及将图标作为片段拖放的能力。除此之外，谁知道呢？但我希望有足够的信息来让一个好的开始，而不是不得不尝试几个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T03:24:50.307

老实说，比较 ajax 框架是很困难的，而且不可能得到彻底的比较。有些是扩展 js 的基础库，比如原型。其他的，比如 jQuery，扩展了 dom 并使操作更容易。其他的仍然是 js UI 框架，例如 Dojo 或 extjs。还有面向服务器端的平台和包装器（Jayrock、ms-ajax 的一部分和 RoR 的一部分）。

如果您使用 MS 路线，我会查看 WCF REST 堆栈、MS Ajax 客户端库和 jQuery，这将为您提供良好的支持路径，我知道您不想要 X 是很好的响应，但是需要更多信息给你一个更好的答案。您是否正在寻找零件、零件组合或多合一应用和组件解决方案？您所要求的就像要求对面包进行良好的比较，缩小范围。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-02T03:27:16.493

[http://chandlerproject.org/bin/view/Projects/AjaxLibraries](http://chandlerproject.org/bin/view/Projects/AjaxLibraries)

[http://www.devx.com/AJAXRoundup/Article/33209](http://www.devx.com/AJAXRoundup/Article/33209)

[http://www.sitepoint.com/javascript-library/](http://www.sitepoint.com/article/javascript-library/)

这些都不包括jQuery

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T14:00:52.490

作为大型库的替代方案，请参阅[Fork Javascript 库](http://forkjavascript.org/)，即 FORK.Ajax——简单且运行良好。对于处理 JSON 表示法：我更喜欢 Doug Crockford 的[json2.js](http://www.json.org/js.html)而不是 FORK.Json。（从 javascript 端处理 JSON 比处理 XML 容易得多。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-02T14:13:57.550

我过去在 AJAX 中使用过 moo.fx 和 jQuery，两者都非常有效。moo 的占用空间非常小，这很好，并且在基本包中还具有相当多的图形功能。但是，如果您希望使用 javascript 做很多事情，那么 jQuery 具有更多功能并且有很好的文档记录。

两者都具有拖放功能

[http://demos111.mootools.net/DragDrop](http://demos111.mootools.net/DragDrop)

[http://ui.jquery.com/demos/droppable](http://ui.jquery.com/demos/droppable)

# performance - 有这么多可用的系统资源，你有多确定你的代码是经过调优的？

> ID：405944
> 
> 赞同：0
> 
> 时间：2009-01-02T03:21:04.103
> 
> 标签：performance, language-agnostic

随着 CPU 越来越快、硬盘旋转、比特飞得越来越快、网络速度也越来越快，要像以前那样区分坏代码和好代码并不容易。

我记得有一次你可以优化一段代码并且不可否认地感觉到性能的提高。那些日子快结束了。相反，我想我们现在有一套我们遵循的规则，比如“不要在循环中声明变量”等。遵守这些规则很好，这样你就可以默认编写好的代码。但是你怎么知道没有工具就不能进一步改进呢？

有些人可能会争辩说，现在几纳秒不会真正产生那么大的影响。事实是，我们被困在如此多的层次上，以至于你得到了惊人的效果。

我并不是说我们应该优化我们代码的每一毫秒，因为这将是昂贵且不可行的。我相信，鉴于我们的时间限制，我们必须尽最大努力编写高效的代码。

**我只是想知道您使用哪些工具来分析和测量代码的性能（如果有的话）。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T04:33:16.453

我认为优化不应该被认为是查看每一行代码，而是你的算法是什么渐近复杂度。例如，使用冒泡排序可能是您可以在优化方面使用的最差排序算法之一。它需要的时间最长。快速排序和归并排序在排序方面更快，应始终在冒泡排序之前使用。

如果在设计问题的解决方案时始终牢记优化，那么您应该能够编写可读的代码，其他开发人员会认可。此外，如果您正在使用将在运行之前编译的高级语言进行编程，请记住编译器现在进行了一些您或我可能没有想到的很棒的优化，而且（更重要的是）不必担心。

坚持一个好的和低的大 O()，它应该被优化得很好。如果您在某种类型的数据集中处理数百万或更多，那么寻找一个大的 O(logn) 算法。它们非常适合大型任务，并保持您的代码优化。

让编译器逐行优化代码，这样您就可以专注于解决方案。

有时确实需要逐行优化，如果您需要这么快的速度，也许您可​​能想要研究汇编，以便您可以控制所编写的每一行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T03:28:25.087

“好”代码和“快”代码之间有很大的区别。它们也不是完全分开的，但是“快速”代码并不意味着“好”。很多时候，“快”实际上意味着糟糕的代码，因为必须在可读性上做出妥协以使其快速。

在我看来，[硬件很便宜，程序员很贵](http://www.codinghorror.com/blog/archives/001198.html)。除非某些代码存在严重的性能问题，否则您永远不必担心速度。如果存在性能问题，您会注意到它们。只有当您注意到良好硬件上的性能问题时，您才需要担心优化（在我看来）

如果你的代码速度很慢，但你不知道为什么，我会使用像[ANT](http://www.red-gate.com/Products/ants_profiler/index.htm)这样的分析器，如果你在 .NET 世界中，我会使用[dotTrace](http://www.jetbrains.com/profiler/)（我相信还有其他的对于其他平台和语言）。它们非常有用，但我只遇到过一种需要分析器来识别问题的情况。现在我知道了这个问题，我不再需要分析器来告诉我这是一个问题，因为我永远不会忘记我在优化它上所花费的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T03:24:25.703

这绝对是一个有效的问题，但对大多数开发人员而言并非如此。大多数开发人员都关心获得适合其雇主的产品。很少需要优化代码。

确保您的代码快速的最佳方法是对其进行基准测试或分析。许多编译器优化会在程序员代码的性能中产生非直观的怪异，因此最终测量变得至关重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T03:27:08.193

根据我的经验，[Rational Quantify](http://www-01.ibm.com/software/awdtools/quantify/support/)在代码调优方面给了我最好的结果。它不是免费的，但功能非常齐全，似乎给了我最有用的结果。

在免费工具方面，如果您在 Unix 环境中，请查看[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof_toc.html)或[oprofile 。](http://oprofile.sourceforge.net/news/)它们不如某些商业工具好，但通常可以为您指明正确的方向。

在旁注中，我几乎总是对我第一次使用分析器时出现的内容感到惊讶。您可以凭直觉知道代码可能在哪里出现瓶颈，但它通常可能是完全错误的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T04:25:01.510

我写的几乎所有代码都足够快。在极少数情况下，对于 C、C++ 和 Objective Caml，我使用古老`gprof`而卓越[`valgrind`](http://valgrind.org)的可视化[`kcachegrind`](http://api.kde.org/4.x-api/kdesdk-apidocs/kcachegrind/html/index.html)工具（KDE SDK 的一部分；不要被过时的代码所迷惑）源锻造）。

MLton标准 ML 编译器和[Glasgow Haskell 编译器都](http://haskell.org/ghc)[附带](http://mlton.org)了出色的分析器。

我希望有一个更好的[Lua](http://www.lua.org/)分析器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-02T03:25:43.610

呃，也许是剖析器？几乎所有平台和语言都有可用的。

# rest - 什么是监视 REST 资源以进行更改的 RESTful 方式？

> ID：405950
> 
> 赞同：40
> 
> 时间：2009-01-02T03:26:47.853
> 
> 标签：rest, long-polling, polling

如果有一个 REST 资源我想监视来自其他客户端的更改或修改，那么最好（也是最 RESTful）的方法是什么？

我这样做的一个想法是通过提供特定资源来保持连接打开，而不是在资源不（尚）存在时立即返回。例如，给定资源：

```
/game/17/playerToMove 
```

对此资源的“GET”可能会告诉我轮到我的对手移动了。与其不断轮询此资源以找出轮到我移动的时间，我可能会记下移动编号（例如 5）并尝试检索下一步：

```
/game/17/move/5 
```

在“正常”REST 模型中，对此 URL 的 GET 请求似乎会返回 404（未找到）错误。但是，如果相反，服务器保持连接打开，直到我的对手下棋，即：

```
PUT /game/17/move/5 
```

然后服务器可以返回我的对手放入该资源的内容。这既可以为我提供我需要的数据，也可以为我的对手何时移动而不需要轮询提供一种通知。

这种方案是 RESTful 的吗？还是它违反了某种 REST 原则？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-02T04:39:44.973

您提出的解决方案听起来像[long polling](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)，可以很好地工作。

您将请求`/game/17/move/5`并且服务器不会发送任何数据，直到移动 5 完成。如果连接断开或超时，您只需重新连接，直到获得有效响应。

这样做的好处是它非常快——只要服务器有新数据，客户端就会得到它。它对断开的连接也具有弹性，并且如果客户端断开连接一段时间（您可以`/game/17/move/5`在它被移动后一小时请求并立即获取数据，然后继续`move/6/`等等）

长轮询的问题是每个“轮询”都会占用一个服务器线程，这会很快破坏像 Apache 这样的服务器（因为它用完了工作线程，所以不能接受其他请求）。你需要一个专门的网络服务器来服务长轮询请求。Python 模块[`twisted`](http://twistedmatrix.com/trac/)（一个“事件驱动的网络引擎”）非常适合这个，但它比常规轮询工作更多。

在回答您关于 Jetty/Tomcat 的评论时，我对 Java 没有任何经验，但似乎它们都使用与 Apache 类似的工作线程池系统，所以它会有同样的问题。我确实找到[了这篇](http://www.ibm.com/developerworks/web/library/wa-aj-hiperform/index.html)似乎正好解决了这个问题的帖子（对于 Tomcat）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T03:43:17.147

我发现[这篇文章](http://cometdaily.com/2007/12/27/a-standards-based-approach-to-comet-communication-with-rest/)提出了一个新的 HTTP 标头“When-Modified-After”，它基本上做同样的事情——服务器等待并保持连接打开，直到资源被修改。

我更喜欢基于版本的方法而不是基于时间戳的方法，因为它不太容易出现竞争条件，并且可以为您提供更多关于您正在检索的信息的信息。对这种方法有什么想法吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-02T03:54:18.030

如果您的预期客户端是 Web 浏览器，我建议使用 404，因为保持连接打开可以主动阻止客户端中对同一域的浏览器请求。多久轮询一次取决于客户。

* * *

2021 年编辑：上面的答案是在 2009 年，以供参考。

今天，我建议使用带有推送通知的 WebSocket 接口。

或者，在上述建议中，我可能建议保持连接 500-1000 毫秒，并在返回 404 之前在服务器上检查两次，以减少在客户端创建多个连接的开销。

# c++ - 从 C++ 代码生成 UML？

> ID：405953
> 
> 赞同：124
> 
> 时间：2009-01-02T03:27:45.290
> 
> 标签：c++, uml

是否有可以解析项目中的 C++ 文件并从中生成 UML 的工具？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-02T05:47:51.297

这里有几个选项：

使用 Microsoft Visio 2000 将代码逆向工程代码到 UML 图中的分步指南 - [http://msdn.microsoft.com/en-us/library/aa140255(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa140255(office.10).aspx)

BoUML - [http://bouml.fr/features.html](http://bouml.fr/features.html)

StarUML - [http://staruml.sourceforge.net/en/](http://staruml.sourceforge.net/en/)

在存在弱类型容器的情况下从 C++ 代码逆向工程 UML 类图 (2001) - [http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.27.9064](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.27.9064)

Umbrello UML 建模器 - [http://uml.sourceforge.net/](http://uml.sourceforge.net/)

要查看的其他工具列表 - [http://plg.uwaterloo.ca/~migod/uml.html](http://plg.uwaterloo.ca/~migod/uml.html)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-01-02T18:50:48.053

如果它只是你想要的图表，[doxygen](http://www.doxygen.org)做得很好。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-06-23T23:22:12.850

我开发了一个名为[Doxygraph](http://code.google.com/p/doxygraph/)的工具，它可以解析 Doxygen 生成的 XML 并将其转换为交互式 UML 类图，您可以在 Web 浏览器中查看它或导入任何可以读取 Graphviz“点”文件的软件。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-02T04:32:16.690

我相信[Enterprise Architect](http://www.sparxsystems.com.au/)可以做到这一点。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-07-18T12:11:19.687

我发现 Wikipedia 可以成为有关此类工具的重要信息来源，尤其是比较表。有一个关于[UML 工具](http://en.wikipedia.org/wiki/List_of_UML_tools)的页面。请特别参阅[反向工程语言](http://en.wikipedia.org/wiki/List_of_UML_tools#Features)专栏。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-02T14:13:15.663

[根据我的经验， UML Studio](http://www.pragsoft.com)在这方面做得很好，并且会在小型项目的“免费软件模式”下运行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-05-07T13:36:19.840

与**Dia**和其他工具的命令行**autodia**相比，似乎**Umbrello**从 C++ 代码（建议使用最新版本 >= 2.22）生成最佳 UML 。

 ******StarUML**没有为我制作好的图表：奇怪的导入，不可用，对很多人不起作用：[https ://github.com/staruml/Cpp/issues](https://github.com/staruml/Cpp/issues)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-02T03:40:31.663

任何想要 UML 的人都应该得到[Rational Rose](http://www-01.ibm.com/software/awdtools/swarchitect/standard/) :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-12-13T02:01:11.160

我使用 Rational Rose 和 Rational Rhapsody 对大型项目进行逆向工程。我更喜欢 Rational Rhapsody 来获取 C++ 的 UML 类文件！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-02T06:06:46.873

[StarUML](http://staruml.sourceforge.net/en/)就是这样做的，而且它是免费的。不幸的是，它已经有一段时间没有更新了。有几个分支项目（因为项目管理员不允许接管它）但他们也死了。

# wpf - 如何更改 WPF 文本框的突出显示文本颜色？

> ID：405967
> 
> 赞同：14
> 
> 时间：2009-01-02T03:37:26.550
> 
> 标签：wpf, textbox, resources, styles, highlight

WPF`TextBox`本机使用系统突出显示颜色来绘制选定文本的背景。我想覆盖它并使其保持一致，因为它因操作系统/用户主题而异。

对于`ListBoxItem`s，有一个[巧妙的技巧](http://blogs.msdn.com/wpfsdk/archive/2007/08/31/specifying-the-selection-color-content-alignment-and-background-color-for-items-in-a-listbox.aspx)（见下文），您可以在其中覆盖资源键以`HighlightBrushKey`在焦点设置中自定义系统突出显示颜色：

```
<Style TargetType="ListBoxItem">
    <Style.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                         Color="LightGreen"/>
    </Style.Resources>
</Style> 
```

`TextBox`不幸的是，同样的技巧不适用于。除了“覆盖”之外，还有其他人有什么想法`ControlTemplate`吗？

[注意：此行为似乎已添加到 WPF 4。](http://blogs.msdn.com/llobo/archive/2009/10/27/new-wpf-features-caretbrush-selectionbrush.aspx)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-10-01T14:57:16.257

从 .NET 4 开始，[`TextBoxBase.SelectionBrush`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.textboxbase.selectionbrush.aspx)

> 您可以通过设置 SelectionBrush 和 SelectionOpacity 属性来指定突出显示选定文本的画笔。SelectionOpacity 属性指定 SelectionBrush 的不透明度。

例如。

```
<TextBox SelectionBrush="Red" SelectionOpacity="0.5"
         Foreground="Blue" CaretBrush="Blue"> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-02T08:51:16.387

正如史蒂夫所提到的：[注意：此行为似乎已添加到 WPF 4。](http://blogs.msdn.com/b/llobo/archive/2009/10/27/new-wpf-features-caretbrush-selectionbrush.aspx)

我遇到了同样的问题。

正如 WPF 博士所说

> “在当前的 .NET 版本（3.0 和 3.5 beta）中这是完全不可能的。控件被硬编码为使用系统设置......它根本不查看控件模板。”

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/bbffa6e3-2745-4e72-80d0-9cdedeb69f7f/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/bbffa6e3-2745-4e72-80d0-9cdedeb69f7f/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-20T13:44:59.727

这是一个经过 Windows 8.1 .Net 4.6.1 测试的解决方案，用于自定义应用程序`SelectionBrush`中的每个`TextBox`：

```
/// Constructor in App.xaml.cs
public App() : base()
{
    // Register an additional SelectionChanged handler for appwide each TextBox
    EventManager.RegisterClassHandler(typeof(TextBox), TextBox.SelectionChangedEvent, RoutedEventHandler(_textBox_selectionChanged));
}

private void _textBox_selectionChanged(object sender, RoutedEventArgs e)
{
    // Customize background color of selected text
    (sender as TextBox).SelectionBrush = Brushes.MediumOrchid;

    // Customize opacity of background color
    (sender as TextBox).SelectionOpacity = 0.5;
} 
```

如果你想包含`RichTextBox`替换类型名称`TextBox`4 次`TextBoxBase`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-02T08:45:26.960

您可以为 TextBox 创建一个 Style 并为背景编写一个 Setter。TextBox 样式应该是默认样式，以便可视化树下的任何 TextBox 都将获得更改后的 TextBox

```
<Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBox}"> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-11-29T08:35:59.617

试试这个：

```
 <Trigger Property="IsHighlighted" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="OrangeRed"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger> 
```

# character-encoding - htmlencode 和 urlencode 是什么意思？

> ID：405994
> 
> 赞同：6
> 
> 时间：2009-01-02T04:12:19.133
> 
> 标签：character-encoding, urlencode, html-encode

> **可能重复：**
> [Url 编码和 HTML 编码之间的区别](https://stackoverflow.com/questions/1812473/difference-between-url-encode-and-html-encode)

HTMLEncode 是什么意思，我该如何使用它？

URLEncode 是什么意思，它与 HTMLEncode 有何不同？

# lua - 在 OCaml 中嵌入 Lua

> ID：405995
> 
> 赞同：7
> 
> 时间：2009-01-02T04:12:57.620
> 
> 标签：lua, embed, ocaml

能否请您提供一个代码片段来展示如何使用嵌入在 OCaml 中的 Lua？

一个简单的示例可能是“Hello, World”变体。让 OCaml 提示用户输入名称。然后将该名称传递给 Lua 函数。让 Lua 打印一个问候语并返回名称的长度。然后让 OCaml 打印一条关于名称长度的消息。

例子：

> user@desktop:~$ ***./hello.opt***
> 
> 姓名？***用户***
> 
> 你好，用户。
> 
> 你的名字有 4 个字母。
> 
> 用户@桌面：~$

**[编辑]**

作为非 C 程序员，我是否可以在不必编写中间 C 程序来在 Lua 和 OCaml 之间传递数据的情况下实现这一点？

以下是我想尝试的理论想法。不幸的是，ocaml_hello.ml 的第 3 行需要知道如何调用 lua_hello.lua 中定义的函数才能使代码有效。

**lua_hello.lua** 定义 lua_hello，它打印一个参数并返回它的长度。

```
1  function lua_hello (name)
2    print ("Hello, "..name..".")
3    return (string.len (name))
4  end 
```

**ocaml_hello.ml** OCaml 提示输入名称，调用 Lua 函数，并打印返回值。

```
1  let () = print_string "Name? "; flush stdout in
2  let name = input_line stdin in
3  let len  = Lua_hello.lua_hello name in
4    Printf.printf "Your name is %d letters long." len; flush stdout;; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-02T04:39:08.220

我不知道有一套成熟的绑定将 Lua 的 C 实现嵌入到 OCaml 中。一组不成熟的绑定[于 2004 年发布在 Caml 邮件列表上](http://tinyurl.com/9cx5xm)。

如果您想使用 ML 实现，您可以在一篇名为[ML Module Mania](http://www.cs.tufts.edu/~nr/pubs/maniaws-abstract.html)的论文中找到一些示例。与 C 实现不同，ML 实现保证了类型安全，但为了做到这一点，它在 ML 模块系统中使用了一些非常糟糕的技巧。如果您问的是基本问题，您可能希望避免这种情况。

在您的示例中，很难猜测您希望该函数来自何处。我建议您要么要求一个 C 示例，要么给人们一个 C 示例，然后询问如何在 OCaml 中实现它（尽管我认为绑定将是一个问题）。

* * *

## 编辑

在回答修改后的问题时，它非常复杂。通常的模型是让 Lua 负责，然后从 Lua 调用 Objective Caml 代码。你让 Caml 负责，这让事情变得更加复杂。这是事情可能看起来的粗略草图：

```
let lua = Lua.new()  (* create Lua interpreter *)
let chunk = LuaL.loadfile lua "hello.lua" (* load and compile the file hello.lua *)
let _ = Lua.call lua 0 0 (* run the code to create the hello function *)
let lua_len s =
  (* push the function; push the arg; call; grab the result; pop it; return *)
  let _ = Lua.getglobal lua "lua_hello" in
  let _ = Lua.pushstring lua s in
  let _ = Lua.call lua 1 1 in
  let len = Lua.tointeger lua (-1) in
  let _ = Lua.pop lua 1 in
  len

let () = print_string "Name? "; flush stdout
let name = input_line stdin
let len  = lua_len name
Printf.printf "Your name is %d letters long." len; flush stdout;; 
```

再说一次，我不知道你会从哪里得到`Lua`和`LuaL`模块的绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T17:44:28.420

进一步思考，我不确定你是否可以使用 Lua 的官方 C 实现来做到这一点，因为我认为 OCaml 相信它拥有`main()`. 您必须确定 OCaml 是否可以从 C 主程序打包为库。

有关 Lua-ML 负责的示例，您可以从 Cminusminus.org 获得[独立的 Lua-ML](http://www.cminusminus.org/code.html#luaml)，您还可以查看[有关 Lua-ML 的论文](http://www.cs.tufts.edu/~nr/pubs/embedj-abstract.html)中的示例以及[QC-- 编译器](http://www.cminusminus.org/)的源代码本身。********