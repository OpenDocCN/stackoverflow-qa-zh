# StackOverflow 问答 000225000-000225999

# spring - Spring-WS：如何从 PayloadEndpoint 访问 MessageContext

> ID：225009
> 
> 赞同：0
> 
> 时间：2008-10-22T09:25:32.953
> 
> 标签：spring, spring-ws

从 PayloadEndpoint 访问 MessageContext 的“规范”方式是什么？

我们正在使用[PayloadEndpoint](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/server/endpoint/PayloadEndpoint.html)和[AbstractMarshallingPayloadEndpoint](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/server/endpoint/AbstractMarshallingPayloadEndpoint.html)，它们不会将 MessageContext 暴露给它们的 invoke / invokeinternal 方法，但现在需要访问 HTTP 请求参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T09:57:15.980

我能想到的最简单的方法：创建一个实现[MessageEndpoint](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/server/endpoint/MessageEndpoint.html)的“包装器”端点。然后您可以提取您的请求参数并将它们传递给您的实际端点。

您可以将请求变量存储在 ThreadLocal 中，以便原始端点可以访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T13:23:35.017

Spring论坛[有人建议](http://forum.springframework.org/showthread.php?t=62388)使用[TransportContext](http://static.springframework.org/spring-ws/sites/1.5/reference/html/common.html#transport-context)来访问HTTP请求参数。这有助于解决我们的特定问题，但没有回答原始问题如何获取 MessageContext。

另一个想法是引入[EndpointInterceptor](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/server/EndpointInterceptor.html)并使用 ThreadLocal。但我希望有一种感觉不像黑客的方式。

# directx - 我应该现在创建 CUDA 应用程序，还是等待 DirectX 11？

> ID：225016
> 
> 赞同：3
> 
> 时间：2008-10-22T09:27:25.197
> 
> 标签：directx, cuda, gpgpu, directx-11

Windows 7 可能会在明年 10 月进入 RTM（以及 DirectX 11），是否值得等待 DirectX 11 的显式 GPGPU 功能，这意味着它将是跨平台的（ATI/Nvidia，而不是 Windows/Linux/Mac/Whatever） ; 还是我现在应该创建一个 CUDA 应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T08:36:58.730

根据我的经验，从通用处理器编程到 GPGPU 编程的主要飞跃是概念上的飞跃。这里的关键是数据并行代码。

即使在 CPU 上的多线程环境中，每个线程都在底层做自己的事情，线程之间的同步是比较少见的。要使用 GPGPU 的强大功能，您需要运行数千个线程，这些线程在逻辑上运行相同的指令，处理不同的数据，几乎完全同步。

与了解数据并行范式相比，学习 CUDA 语法相对较快，因此，如果您打算为 GPGPU 编程做好准备，现在开始使用 CUDA 将是一个非常值得的举措。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T10:58:55.840

从学习的角度来看，我认为您将从现在开始使用 CUDA 中受益，因为它将帮助您思考 GPU 擅长的数据并行性。然后，当/如果您转向 DirectX 11，您就有了使用它的良好基础，但这取决于您可用的时间类型（即，您是否有时间尝试只是为了学习经验）。

或者，mac 人正在推动将 OpenCL（开放计算语言）作为通用解决方案，尽管目前知之甚少。这是您可以等待并检查的另一种技术。

Microsoft PDC 大会在本月晚些时候举行，也许他们会公布一些有关 DX11 的有用信息，以帮助您下​​定决心。

我的一般建议是，我认为现在有很多东西要学，以后可以使用（使用 DX11 或 OpenCL），但是你必须问问自己，你是否愿意学习一些可能无法使用的技术从长远来看。无论如何，这些只是我的想法，我还没有大量使用 CUDA 的经验。

在一个高度推测性的注释中，我的直觉是，像 CUDA 这样的 API 不会长期存在，而 DirectX 和/或 OpenCL 是唯一有前途的解决方案（除非他们真的搞砸了他们的实现，我对此表示怀疑）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T21:03:42.357

如果你想要学习体验，那就去吧！

另一种选择是 AMD/ATI 的流 SDK，您可以在此处下载：http: [//ati.amd.com/technology/streamcomputing/sdkdwnld.html](http://ati.amd.com/technology/streamcomputing/sdkdwnld.html)

nVidia 的 Cuda 和 ATI 的 CAL 在功能上大致相当。Cuda 仅适用于 nVidia gpus，CAL 仅适用于 ATI gpus。

最终，会有很好的跨平台开发工具，但现在这是一个巨大的空白。DirectX 11 计算着色器和 OpenCL 将争取成为首选工具，但目前还没有任何一个可用。

如果您想构建一些“真正的”应用程序，而不仅仅是一次性的学习体验，**并且**您希望它能够跨平台工作，那么有一些替代方案：例如 Brook。此外，多年来人们一直在使用 DirectX 和 OpenGL（不是 OpenCL）进行 gpgpu 工作，而无需等待明确的 GPGPU 功能。转到 gpgpu.org 获取指针

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T21:26:45.040

DirectX 11 Compute Shaders 和 OpenCL 都主要基于 CUDA，因此现在开​​始使用 CUDA 绝对值得。基本上，它们都使用相同的内存模型，并且具有相似的语法，它更接近 CUDA 而不是 Brook+（您将与 Stream SDK 一起使用）。

但是，如果您想要 DX11，则无需等待，只需从 Microsoft 获取[2008 年 11 月的 SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=5493F76A-6D37-478D-BA17-28B1CCA4865A&displaylang=en) ，它带有 DX11 预览版，您已经可以使用它来编写（至少）简单的计算着色器应用程序。

# javascript - **尝试**调试时如何阻止IE询问选择哪个调试器？

> ID：225030
> 
> 赞同：7
> 
> 时间：2008-10-22T09:32:42.080
> 
> 标签：javascript, visual-studio, debugging, internet-explorer, options

在 Internet Explorer 中调试时；我首先得到一个警告框，其中包含非常有限的信息（如果不是无用的话）（对不起 IE）和调试它的选择；选择是后；*每次*在“Microsoft 脚本调试器的新实例”和“Visual Studio 的新实例”之间进行选择时，我都会得到另一个选项。我已经厌倦了在警报框上单击一次后必须再次单击是按钮。

更新：我发现你可以从它自己的选项中禁用微软脚本调试器；只需从 Tools -> Options 和 JIT 禁用 JIT 调试器。这会阻止它出现在菜单上，但现在我得到一个对话框，询问我选择哪一个，它只显示一个 Visual Studio - 为什么？如果只有一个选项，并且您已经问我是否要调试，为什么还要问？！？！呜呜。

你能说我厌倦了点击两次“是”吗？哈哈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T11:01:43.027

显然，如果您在安装较新的 Microsoft 脚本编辑器之前没有卸载旧的（蹩脚的）Microsoft 脚本调试器，就会出现问题。

你会认为你需要做的就是卸载旧的调试器 - 但是，根据一篇博客文章（我现在不记得了），如果你此时卸载 Microsoft Script Debugger，它会搞砸MSE，您将不得不再次重新安装 MSE。我现在的日程安排很紧，所以我没有时间正确解决问题 - 尽我所能忍受它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T10:33:28.323

也许不是完整的解决方案，但您可以尝试设置默认脚本调试器，可以直接**在注册表**中设置。为此，请按照下列步骤操作：

*   单击开始、运行并键入 regedit.exe
*   导航到以下分支：

HKEY_CLASSES_ROOT\CLSID\{834128A2-51F4-11D0-8F20-00805F2CD064}\LocalServer32

*   通过将分支导出到文件来备份分支
*   在上述键中，双击（默认）并将其值数据设置为：

    “C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe”

    （或者无论你的 devenv.exe 路径是什么）

*   退出注册表编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T12:52:26.577

如果所有其他解决方案都失败了，您可以尝试另一条路线：使用宏语言（à la AutoHotkey 或 AutoIt）一键关闭所有提示...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T13:15:09.947

这不是您要的，但其他来到此线程的人可能想知道如何完全禁用这些。只需在以下情况下一起禁用调试：

```
Options -> Advanced -> Browsing -> Disable script debugging. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T18:54:24.257

只需在服务列表中禁用机器调试管理器！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T16:36:12.947

发生这种情况是因为这就是及时调试事物的设计方式。

一般来说，我有多个 Visual Studio 实例正在运行，并且那个小框将它们全部列出，因此我可以选择正确的一个。如果只有一个选项，您会认为只选择一个选项就足够聪明了，但事实并非如此。

# .net - 我可以为从 IntPtr 编组值的方法创建单元测试吗？

> ID：225032
> 
> 赞同：0
> 
> 时间：2008-10-22T09:33:17.993
> 
> 标签：.net, unit-testing, marshalling, native

我正在使用一个本机库，它将 IntPtr 返回到包含属性值的内存位置。我知道属性的类型是什么，并且我有一种方法可以从指针指向的内存中编组一个值（获取 IntPtr 和属性的类型）。此方法调用 Marshal.ReadInt32，或读取一系列字节并将它们转换为双精度，或使用 Marshal.PtrToStringUni 等读取字符串。我想为此方法编写一些单元测试，但不确定我该怎么做关于创建 IntPtr 以传递给该方法。我正在使用 NUnit，不能使用模拟框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T09:53:32.930

查看[Marshal.Copy()](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.copy.aspx)的各种重载，这将允许您使用 IntPtr 初始化值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T09:49:34.277

如果我理解正确，你想对你的反序列化逻辑进行单元测试，给定一个 IntPtr。
如果是这种情况，您所要做的就是拥有序列化输出的不同组合的副本，以测试每个唯一路径。对于每个测试，获取可能的序列化实体的 IntPtr，调用您的方法并验证预期结果。

类似于获取指向内存区域的指针。将序列化的输出保存在一个字符串中，并从中获取一个 Intptr。GCHandle 看起来像你需要的东西。（虽然从未尝试过） [http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.tointptr.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.tointptr.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T10:44:12.857

我对您的问题的阅读使我认为您要问的是：

> 如何创建模拟我正在进行的本机调用的函数，该调用将 IntPtr 返回到双精度或 unicode 字符串，以便我可以将该 IntPtr 传递给我想要测试的函数？

这样的事情可能会有所帮助：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;
using System.Diagnostics;

namespace ConsoleApplication1
{
    class Program
    {
        private static double myDouble = 3.14;
        private static unsafe void TestPtrToDouble()
        {
            fixed(double* pDouble = &myDouble)
            {
                IntPtr intp = new IntPtr(pDouble);
                double[] copy = new double[1];
                Marshal.Copy(intp, copy, 0, 1);

                Debug.Assert(copy[0] == myDouble);
            }           
        }

        private static char[] myString = { 'T', 'h', 'i', 's', ' ', 'i', 's', ' ', 'm', 'y', ' ', 's', 't', 'r', 'i', 'n', 'g' };

        private static unsafe void TestPtrToUnicodeString()
        {
            fixed (char* pChar = &myString[0])
            {
                IntPtr intp = new IntPtr(pChar);
                string copy = Marshal.PtrToStringUni(intp);

                Debug.Assert(copy == "This is my string");
            }
        }

        static void Main(string[] args)
        {
            TestPtrToUnicodeString();
            TestPtrToDouble();
        }
    }
} 
```

需要非常注意的是，您将无法返回从函数创建的模拟 IntPtr。即，您不能创建 P/Invoke 调用的模拟版本并期望一切正常。

.Net 运行时在内存中移动托管对象（垃圾收集过程的一部分）。该`fixed`语句会阻止您获取地址的成员/对象发生这种情况。但仅限于块的生命周期。如果您从函数返回，则块结束，因此返回后指针值可能无效。即，您的 IntPtr 可能正在引用不再包含您要编组的数据的内存。

查看有关[不安全代码](http://msdn.microsoft.com/en-us/library/aa288474(VS.71).aspx)和[固定语句](http://msdn.microsoft.com/en-us/library/f58wzh21(VS.80).aspx)的 MSDN 文档。但是我在这里得到的内容应该会让您朝着正确的方向前进，为您的编组代码构建 NUnit 测试。

另请注意，此代码需要 /unsafe 编译器选项才能编译。如果您需要您的程序集在不支持不安全程序集的环境中运行，您必须在另一个程序集中拥有测试代码。但是由于您已经在使用 P/Invoke，我想情况并非如此。

# java - 如何在java中将字体识别为符号？

> ID：225034
> 
> 赞同：3
> 
> 时间：2008-10-22T09:34:33.233
> 
> 标签：java, fonts, symbols

我目前正在寻找一种在 Java 中将字体识别为符号的可能性，就像 OpenOffice 一样。字体为 Windings 或 Webdings 等的字符应使用正确的“图片”进行渲染。

有人知道如何区分普通字体和带符号的字体吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T10:26:03.253

[Java 不显示 windows 符号字体中的所有字符](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4549043)的错误提供了有关符号字体特有的特征的线索。

它们是[SYMBOL_CHARSET](http://java.sun.com/j2se/1.4.2/docs/guide/intl/fontprop.html)（font.properties 文件的 WindowsCharsetName）的一部分

因此 [jdk1.6.0_10]\jre\lib\fontconfig.98.properties.src 可能是确定字体名称是否与符号字体匹配的第一个信息源，并且应该通过[Property.load()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html#load(java.io.InputStream))加载.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-22T21:35:35.893

`SYMBOL_CHARSET`根据 VonC 的回答，我的字体属性文件中没有看到任何内容。

一个简单的测试似乎是[`if( !java.awt.Font#canDisplay('a') )`](http://download.oracle.com/javase/6/docs/api/java/awt/Font.html#canDisplay%28char%29)。在我的 Windows 框中，我得到了一个符号字体列表，包括普通的 Symbol 和 Wingdings，以及像“Estrangelo Edessa”这样的外来字体。

# .net - Visual Studio Team System 2008 Developer Edition 上的代码覆盖率（在 NUnit 应用程序上）

> ID：225040
> 
> 赞同：4
> 
> 时间：2008-10-22T09:38:30.027
> 
> 标签：.net, visual-studio, visual-studio-2008, nunit, code-coverage

这可能吗？我期待着一个解释实现这一目标的步骤的教程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T09:46:47.043

[TestDriven.NET](http://testdriven.net/)能够使用 Team Coverage 进行测试（NUnit/MSTest/etc）（自从您拥有 Team System : Dev 以来您已经拥有）。

演练：[在这里](http://weblogs.asp.net/nunitaddin/archive/2006/11/08/Driving-MSTest-and-Team-Coverage-using-TestDriven.NET.aspx)（您还可以看到覆盖结果窗口，以查看每种方法的覆盖范围） - 但这说明了一切：

[![将 TestDriven.NET 与团队覆盖一起使用](https://i.stack.imgur.com/JoWzV.gif "将 TestDriven.NET 与团队覆盖一起使用")](https://i.stack.imgur.com/JoWzV.gif "将 TestDriven.NET 与团队覆盖一起使用")
[（来源：[mutantdesign.co.uk](http://www.mutantdesign.co.uk/weblog/images/DrivingMSTestandTeamCoverageusingTes.NET_F424/MSTestAndTeamCoverage_thumb1.gif)）]

您可以使用 NUnit 测试，但使用 MS IDE 集成进行着色、百分比等（不需要 NCover）。我一直都用这个；-p

优点是：

*   无需设置“测试运行配置”（对不起，MSFT，但那里有自己的目标）
*   与 VS（代码覆盖结果和着色）完全集成
*   易于使用（只需右键单击 -> 测试 -> 团队覆盖）
*   也易于调试（右键单击 -> 测试方式 -> 调试器）
*   如果需要，可以轻松使用单独的 NUnit/NCover 应用程序（右键单击等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T00:17:40.203

[这是关于将 NCover 与 MSBuild 集成的教程](http://morten.lyhr.dk/2008/05/using-nunit-and-ncover-with-tfs-build.html)。 [这是一个](http://blog.prokrams.com/2008/03/13/mbunit-ncover-and-teambuild-living-together-mass-hysteria/)关于如何在 NCover 报告代码覆盖率低于最小阈值时告诉 Team Build 使构建失败的教程。据我所知，目前还没有一种方法可以将您的 NCover 结果直接发布到 TFS 数据仓库，但我希望有人能证明我错了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T09:49:48.130

TestDriven.NET 也可以很好地与 NCover 配合使用。您可以从 NCover 中获得一些非常好的 html 报告，并且可以将其与 Nant 集成。

# ruby - FizzBu zz 使用三元条件运算符

> ID：225045
> 
> 赞同：8
> 
> 时间：2008-10-22T09:42:06.803
> 
> 标签：ruby, operators, conditional-operator, fizzbuzz

我一直在阅读 ruby​​ 中的条件式表达式。然而，我遇到了一个我不太明白定义经典 FizzBu​​zz 问题的问题。我了解 FizzBu​​zz 问题，甚至在使用三元运算符找到以下快速解决方案之前编写了自己的问题。如果有人可以向我解释这个链是如何解决 FizzBu​​zz 问题的，那将非常感激:)

```
for i in 0...100
  puts i%3==0 ? i%5==0 ? "FizzBuzz" : "Buzz" : i%5==0 ? "Fizz" : i
end 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-22T09:47:36.873

一些括号可能会有所帮助：

```
puts (i%3 == 0) ? ((i%5 == 0) ? "FizzBuzz" : "Buzz") : ((i%5 == 0) ? "Fizz" : i) 
```

因此，如果 i 可以被 3 整除，那么它会检查 i 是否也可以被 5 整除。如果是，则打印“FizzBu​​zz”，否则就打印“Buzz”。如果 i 不能被 3 整除，那么它会再次检查是否能被 5 整除，如果是，则打印“Fizz”，否则只打印 i。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-22T09:58:42.637

这是[Jeff Atwood 文章](http://www.codinghorror.com/blog/archives/000781.html)中所述的 FizzBu​​zz 问题的描述。

> 编写一个打印从 1 到 100 的数字的程序。但是对于三的倍数打印“Fizz”而不是数字，对于五的倍数打印“Buzz”。对于同时是三和五的倍数的数字，请打印“FizzBu​​zz”。

[三元运算符](http://en.wikipedia.org/wiki/Ternary_operation)是 if-else 语句的简写。一般格式为：

```
条件 ？evaluate_if_cond_is_true : evaluate_if_cond_is_false

```

所以如果我写：

```
int isEven = (i % 2 == 0) ? 1 : 0; 
```

相当于下面的代码：

```
if (i % 2 == 0) {
    isEven = 1;
} else {
    isEven = 0;
} 
```

其中 cond 是`i % 2 == 0`， evaluate_if_cond_is_true 是`1`并且 evaluate_if_cond_is_false 是`0`。

三元运算符的好处是它们可以组合。这意味着当任一条件评估为真或假时要执行的语句可以是另一个三元运算符。

让整个条件以更易读的方式呈现：

```
i%3==0 ?
    i%5==0 ?
        "FizzBuzz"
        : "Buzz"
    : i%5==0 ?
        "Fizz"
        : i 
```

使用上面解释的规则，将其映射到 if-else 语句很容易：

```
if (i%3==0) {
    if (i%5==0) {
        "FizzBuzz"
    } else {
        "Buzz"
    }
} else {
    if (i%5==0) {
        "Fizz"
    } else {
        i
    }
} 
```

这不是有效的代码，但因为三元运算符的结果被内联在结果表达式中，它被用作 puts 命令的输入。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-22T19:57:29.730

为了好玩，这里有另一种方式：

```
puts (1..100).map {|i| (fb = [["Fizz"][i%3],["Buzz"][i%5]].compact.join).empty? ? i : fb} 
```

还有一个：

```
(1..100).zip([nil,nil,"Fizz"]*34,[nil,nil,nil,nil,"Buzz"]*20).map {|a,b,c| b || c ? [b,c].join : a} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T09:49:01.707

三元是一个基本的 if-then 结构。

以上等价于...

```
if i%3 ==0
    if i%5 == 0
        "FizzBuzz"
    else
        "Buzz"
else
    if i%5 == 0
        "Fizz"
    else
        i 
```

或者，使用一些括号...

```
puts i%3==0 ? ( i%5==0 ? "FizzBuzz" : "Buzz" ) : ( i%5==0 ? "Fizz" : i ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T09:47:45.403

流程是：

```
if (i%3 == 0) {              // multiple of 3
    if (i%5 == 0) {          // multiple of 3 and 5
        puts "FizzBuzz"
    } else {                 // not multiple of 5, only of 3
        puts "Buzz"
    }
} else (                     // not multiple of 3
    if (i%5 == 0) {          // multiple of 5, not of 3
        puts "Fizz"
    } else {                 // multiple of neither 5 nor 3
        puts i
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-27T19:23:28.187

只是为了好玩。如果您想在 C# 中执行此操作。这是一个简单的方法。它基本上从您的 for 循环开始，它将打印从 1 到 100 的数字。然后询问您的索引“i”是否可被 3 和 5 整除，如果为真，则打印到控制台“FizzBu​​zz”。否则，如果您的索引“i”可以被 3 整除，则打印到控制台“Fizz”。否则，如果您的索引“i”可以被 5 整除，则打印到控制台“Buzz”。否则只需打印出“i”，这是您的整数。我添加了标签以提高可读性。

```
for(int i = 1; i <= 100; i++) {
        string result = (i % 3 == 0 && i % 5 == 0) ? 
        "FizzBuzz" :  
            (i % 3 == 0) ? 
                "Fizz" : 
                    (i % 5 == 0) ? 
                        "Buzz" : 
                            i.ToString();
    Console.WriteLine(result);
    } 
```

# delphi - 在 Delphi Mdi 应用程序的父窗口中使用 KeyDown 事件

> ID：225052
> 
> 赞同：1
> 
> 时间：2008-10-22T09:46:19.870
> 
> 标签：delphi, mdi, keypress

如何让 KeyDown 事件在 Delphi (2007) MDI 应用程序父窗口中工作，即使子窗口具有焦点？

我想实现一个在 MDI 应用程序中显示帮助屏幕的快捷键 (F1)，我已将 KeyDown 过程添加到 MDI 父窗口并在父窗口和子窗口中启用了 KeyPreview，但它不能作为预期的。

如果我在父母 KeyDown 代码中设置一个断点，我可以看到它永远不会执行，即使它没有打开子窗口。但是，如果我将相同的代码添加到子窗口中，它就可以正常工作。

有没有办法让父窗口接收按键，即使子窗口有焦点，因为将代码添加到 25+ 窗体接缝有点浪费？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T12:32:36.663

这周我遇到了完全相同的问题！我通过在主窗体上的 ActionManager 中创建一个动作来修复它。此操作打开帮助文件并将 F1 键设置为快捷方式。它也适用于所有 MDI 子屏幕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T09:54:34.470

您可以使用本地（不需要全局）[键盘挂钩](http://delphi.about.com/od/windowsshellapi/a/keyboard_hook.htm)。您还可以从一个单一表单基类派生所有 MDI 子表单并在那里实现一次。你会发现这种设计对于其他问题也很方便。

**编辑**

应用程序范围的热键/快捷方式也可以通过 TApplication.OnShortCut 事件来实现。见[http://delphi.about.com/od/adptips2004/a/bltip0904_3.htm](http://delphi.about.com/od/adptips2004/a/bltip0904_3.htm)

F1 已经是触发 TApplication.OnHelp 的标准帮助快捷方式。所以也许你想使用 OnHelp 事件？如果您使用 HelpFile、HelpContext、HelpType 和 HelpKeyword 属性，您甚至可能根本不需要实现任何代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T14:32:05.363

> 如何让 KeyDown 事件在 Delphi (2007) MDI 应用程序父窗口中工作，即使子窗口具有焦点？

作为更通用的解决方案（对于 F1 以外的应用程序寻求帮助），我使用与此类似的代码来捕获主窗体中的 keydown 事件。无论如何，这都会获取所有密钥，即使 MDI 子项处于活动状态也是如此。在此示例中，我正在做与您尝试做的相反的事情（我希望消息由我的子表单而不是主表单处理），但是在父表单中捕获键的概念是相同的）。

```
Application.OnMessage := AppMessage;

procedure TMainForm.Appmessage(var Msg: TMsg; var Handled: Boolean);
var
  message: TWMKey;
begin
  If (msg.message = WM_KEYDOWN) and
     ( LoWord(msg.wparam) = VK_TAB ) and
     (GetKeyState( VK_CONTROL ) < 0 ) and
     Assigned( ActiveMDIChild ) then
  Begin
    Move( msg.message, message.msg, 3*sizeof(Cardinal));
    message.result := 0;
    Handled := ActiveMDIChild.IsShortcut( message );
  End;
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T10:45:27.880

F1 帮助处理内置在 Delphi 中，因此您所要做的就是正确处理帮助消息。这可能与为应用程序设置帮助文件属性一样少。您可以使用表单的帮助设置特定页面？？？特性。

基本上，只需使用提供的帮助系统并忘记 keydown。这就是德尔福——你不必努力工作。

# ant - ant 内部的 groovy：如何从 grooy 访问由 ant 标签定义的 refid

> ID：225063
> 
> 赞同：0
> 
> 时间：2008-10-22T09:49:41.580
> 
> 标签：ant, groovy

我在 ant 构建文件中使用了一个 groovy 代码片段。在 groovy 代码中，我试图引用在 groovy 部分之外定义的文件集，如下所示：

```
<target name="listSourceFiles" >
    <fileset id="myfileset" dir="${my.dir}">
         <patternset refid="mypatterns"/>
    </fileset>
    <groovy>
        def ant = new AntBuilder()

        scanner = ant.fileScanner {
            fileset(refid:"myfileset")
        }

    ...
    </groovy>
</target> 
```

当我执行此操作时，我收到以下错误消息：

```
Buildfile: build.xml

listSourceFiles:   
   [groovy]

BUILD FAILED
d:\workspace\Project\ant\build.xml:13:
Reference myfileset not found. 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:03:49.637

根据[Groovy Ant Task](http://groovy.codehaus.org/The+groovy+Ant+Task "Groovy Ant 任务")文档，groovy 任务的***绑定***之一是当前的*AntBuilder*，`ant`.

因此，修改您的脚本以删除冲突的 'ant' def 我让它运行没有错误：

```
<project name="groovy-build" default="listSourceFiles">

<taskdef name="groovy"
         classname="org.codehaus.groovy.ant.Groovy"/>

<patternset id="mypatterns">
  <include name="../*.groovy"/>
</patternset>
<target name="listSourceFiles" >
    <fileset id="myfileset" dir="${my.dir}">
         <patternset refid="mypatterns"/>
    </fileset>
    <groovy>
        scanner = ant.fileScanner {
            fileset(refid:"myfileset")
        }
    </groovy>
</target>
</project> 
```

# web-applications - 当前窗口应该在顶部看到

> ID：225071
> 
> 赞同：0
> 
> 时间：2008-10-22T09:53:00.497
> 
> 标签：web-applications

我正在用java（使用jsp）制作一个基于web的应用程序。当appliaction被调用时会来到登录页面，当用户输入有效的凭证时，他会被带到索引页面。但问题是，当登录成功时，索引页面来了，但它在登录页面后面打开。（意味着登录页面出现在显示器的顶部，我希望索引页面应该出现在窗口的顶部。）任何人都可以帮我解决这个问题...请

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T10:08:59.137

在浏览器中编程不支持您所说的模式窗口 - 要做到这一点，您确实需要编写一个“桌面”应用程序。

最简单的解决方案是将浏览器重定向到登录页面（记住用户请求的页面），处理登录，然后重定向回请求的页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T08:58:57.593

你应该重新考虑你的设计。

拥有一个带有额外登录页面的 web 应用程序以及需要订购窗口的功能将不会在不同的浏览器上以相应的方式工作，甚至在同一个浏览器中也不会。

现代网络浏览器越来越多地使用标签打开新窗口，越来越多的人开始习惯它。即使在标签式浏览之前，它也不容易做到。

使用 1 个单一窗口，只需在同一个窗口中导航。

# java - 测试写入 Java OutputStream 的内容

> ID：225073
> 
> 赞同：26
> 
> 时间：2008-10-22T09:53:48.310
> 
> 标签：java, junit, outputstream

我即将为直接输出到 OutputStream 的 XML 解析 Java 类编写 junit 测试。例如`xmlWriter.writeString("foo");`，会产生类似`<aTag>foo</aTag>`写入到 XmlWriter 实例中保存的输出流的内容。问题是如何测试这种行为。一种解决方案当然是让 OutputStream 成为 FileOutputStream，然后通过打开写入的文件来读取结果，但这不是很优雅。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-22T09:55:08.463

使用[ByteArrayOutputStream](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)，然后使用[toByteArray()](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html#toByteArray())从中获取数据。这不会测试它*如何*写入流（一次一个字节或作为一个大缓冲区），但通常你不应该关心它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T14:03:14.860

如果您可以将 Writer 传递给 XmlWriter，我会将其传递给`StringWriter`. 您可以使用它查询`StringWriter`'s 的内容`toString()`。

如果你必须传递一个`OutputStream`，你可以传递一个`ByteArrayOutputStream`，你也可以调用`toString()`它来获取它的内容作为一个字符串。

然后你可以编写如下代码：

```
public void testSomething()
{
  Writer sw = new StringWriter();
  XmlWriter xw = new XmlWriter(sw);
  ...
  xw.writeString("foo");
  ...
  assertEquals("...<aTag>foo</aTag>...", sw.toString());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-13T16:17:07.750

这很简单。正如@JonSkeet 所说：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
// pass the baos to be writed with "value", for this example
byte[] byteArray = baos.toByteArray();
Assert.assertEquals("value", new String(byteArray)); 
```

# c++ - 如何将视频从我的应用程序流式传输到网络？

> ID：225078
> 
> 赞同：0
> 
> 时间：2008-10-22T09:55:18.823
> 
> 标签：c++, winapi, video-streaming

我有一个应用程序可以从多个网络摄像头抓取视频，进行一些图像处理，然后在屏幕上显示结果。我希望能够将视频输出流式传输到网络上 - 最好是某种分发服务，而不是自己直接连接到客户端。

所以我的问题是：

*   是否存在这样的流媒体分发服务？我正在考虑类似 ShoutCAST 继电器，但用于视频。我知道 ustream.tv，但我认为他们只是采用直接的网络摄像头连接，而不是允许您发送任何流。
*   如果是这样，是否有执行此操作的标准协议？
*   如果是这样，是否有适用于 Win32 的该协议的免费库实现？

理想情况下，我只想在 SendToServer(bitmap) 函数中抛出 DIB 格式的视频帧，并让它为我压缩、发送和分发它；)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T10:21:24.930

看看视频 LAN 客户端（或简称 VLC）作为流式视频的一种手段。

至于分发站点，我不知道它与 ustream.tv 和类似的新服务的配合情况如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T02:08:22.787

ustream.tv 通过使用 Adob​​e Flash 对从网络摄像头读取输入的支持来工作。要伪造它，您需要一个伪造的网络摄像头驱动程序。在 ustream.tv 网站上，他们指向一个名为 WebCamMax 的应用程序，该应用程序允许在视频中进行效果和拼接。它的工作原理是创建一个伪网络摄像头，将来自一个或多个摄像头的视频与其他来源混合在一起。由于该应用程序可以做到这一点，您自己的代码也可以做到这一点，尽管您可能需要编写一个 Windows 驱动程序才能使其正常工作。

# ldap - ejabberd - LDAP 身份验证

> ID：225080
> 
> 赞同：0
> 
> 时间：2008-10-22T09:55:44.047
> 
> 标签：ldap, ejabberd

我正在尝试使用 LDAP 身份验证配置 ejabberd 安装，但我无法登录，即使使用管理员用户也是如此。这是我的 ejabberd.cfg 文件的一部分：

```
%...
{auth_method, ldap}.
{ldap_servers, ["server2000.tek2000.local"]}.
{ldap_port,389}.
{ldap_uidattr, "uid"}.
{ldap_base, "dc=server2000,dc=tek2000,dc=com"}.
{ldap_rootdn, "tempadm@tek2000.local"}.
{ldap_password, "secret"}.
%... 
```

我错过了什么？

我必须说，使用 OpenFire，我可以使用此凭据/配置进行连接。

我使用 Spark 作为我的客户端应用程序。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T10:22:49.797

我希望您的 ldap_rootdn 实际上应该看起来像

```
cn=tempadm,dc=server2000,dc=tek2000,dc=com 
```

而不是您在那里使用的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:23:03.723

我以前见过它，你实际上必须在实际路径之前提供 LDAP:// ......所以对于这个例子

```
LDAP://cn=tempadm,dc=server2000,dc=tek2000,dc=com 
```

而且我之前也看到过**LDAP**需要全部大写的地方。我对您使用的是什么一无所知，但就在我使用 LDAP 的时候，我发现了一些东西。

# python - Python 中的 RFC 1123 日期表示？

> ID：225086
> 
> 赞同：76
> 
> 时间：2008-10-22T09:59:21.777
> 
> 标签：python, http, datetime

是否有一种相当简单的方法可以将日期时间对象转换为 RFC 1123 (HTTP/1.1) 日期/时间字符串，即格式为的字符串

```
Sun, 06 Nov 1994 08:49:37 GMT 
```

使用`strftime`不起作用，因为字符串依赖于语言环境。我必须手动构建字符串吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-10-22T10:07:19.577

您可以使用不依赖于语言环境设置的标准库中的 wsgiref.handlers.format_date_time

```
from wsgiref.handlers import format_date_time
from datetime import datetime
from time import mktime

now = datetime.now()
stamp = mktime(now.timetuple())
print format_date_time(stamp) #--> Wed, 22 Oct 2008 10:52:40 GMT 
```

您可以使用 stdlib 中的 email.utils.formatdate ，它不依赖于语言环境设置

```
from email.utils import formatdate
from datetime import datetime
from time import mktime

now = datetime.now()
stamp = mktime(now.timetuple())
print formatdate(
    timeval     = stamp,
    localtime   = False,
    usegmt      = True
) #--> Wed, 22 Oct 2008 10:55:46 GMT 
```

如果您可以将区域设置过程设置为广泛，那么您可以执行以下操作：

```
import locale, datetime

locale.setlocale(locale.LC_TIME, 'en_US')
datetime.datetime.utcnow().strftime('%a, %d %b %Y %H:%M:%S GMT') 
```

如果您不想设置语言环境进程范围，您可以使用[Babel](http://babel.edgewall.org/) [日期格式](http://babel.edgewall.org/wiki/Documentation/dates.html)

```
from datetime import datetime
from babel.dates import format_datetime

now = datetime.utcnow()
format = 'EEE, dd LLL yyyy hh:mm:ss'
print format_datetime(now, format, locale='en') + ' GMT' 
```

与 wsgiref.handlers.format_date_time 相同的手动格式化方法是：

```
def httpdate(dt):
    """Return a string representation of a date according to RFC 1123
    (HTTP/1.1).

    The supplied date must be in UTC.

    """
    weekday = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"][dt.weekday()]
    month = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep",
             "Oct", "Nov", "Dec"][dt.month - 1]
    return "%s, %02d %s %04d %02d:%02d:%02d GMT" % (weekday, dt.day, month,
        dt.year, dt.hour, dt.minute, dt.second) 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-22T10:34:04.453

您可以使用 Python 标准电子邮件模块中的 formatdate() 函数：

```
from email.utils import formatdate
print formatdate(timeval=None, localtime=False, usegmt=True) 
```

以所需格式给出当前时间：

```
Wed, 22 Oct 2008 10:32:33 GMT 
```

事实上，这个函数是“手动”完成的，而不使用 strftime()

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-05-12T15:18:56.000

如果有人阅读这篇文章正在处理**Django**项目，那么 Django 提供了一个函数[`django.utils.http.http_date(epoch_seconds)`](https://docs.djangoproject.com/en/stable/ref/utils/#django.utils.http.http_date)。

```
from django.utils.http import http_date

some_datetime = some_object.last_update
response['Last-Modified'] = http_date(some_datetime.timestamp()) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T10:05:46.990

您可以设置 LC_TIME 以强制 stftime() 使用特定的语言环境：

```
>>> locale.setlocale(locale.LC_TIME, 'en_US')
'en_US'
>>> datetime.datetime.now().strftime(locale.nl_langinfo(locale.D_T_FMT))
'Wed 22 Oct 2008 06:05:39 AM ' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T10:40:11.820

好吧，这是一个手动格式化它的函数：

```
def httpdate(dt):
    """Return a string representation of a date according to RFC 1123
    (HTTP/1.1).

    The supplied date must be in UTC.

    """
    weekday = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"][dt.weekday()]
    month = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep",
             "Oct", "Nov", "Dec"][dt.month - 1]
    return "%s, %02d %s %04d %02d:%02d:%02d GMT" % (weekday, dt.day, month,
        dt.year, dt.hour, dt.minute, dt.second) 
```

# filesystems - 您如何将上传的文件存储在文件系统中？

> ID：225088
> 
> 赞同：0
> 
> 时间：2008-10-22T10:00:02.277
> 
> 标签：filesystems, organization

我试图找出将用户上传的文件存储在文件系统中的最佳方式。文件范围从个人文件到 wiki 文件。当然，数据库将以某种我尚未弄清楚的方式指向这些文件。

基本要求：

*   童话般的安全，所以人们无法猜测文件名（Picture001.jpg、Picture002.jpg、Music001.mp3 是一个很大的禁忌）
*   轻松备份和镜像（我更喜欢一种方式，这样我就不必每次备份时都复制整个 HDD。我喜欢只备份最新项目的想法，但我对这里的选项很灵活。 )
*   如果需要，可扩展到多台服务器上的数百万个文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T10:04:32.983

一种技术是将数据存储在以其内容的哈希 (SHA1) 命名的文件中。这不容易猜到，任何备份程序都应该能够处理它，并且它很容易分片（通过在一台机器上存储以 0 开头的哈希值，在下一台机器上存储以 1 开头的哈希值，等等）。

数据库将包含用户分配的名称和内容的 SHA1 哈希之间的映射。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T10:11:04.220

文件名指南，自动扩展文件夹层次结构，每个文件夹中不超过几千个文件/文件夹。备份新文件是通过备份新文件夹来完成的。

您没有说明您正在使用什么环境和/或编程语言，但这里有一个 C#/.net/Windows 示例：

```
using System;
using System.IO;
using System.Xml.Serialization;

/// <summary>
/// Class for generating storage structure and file names for document storage.
/// Copyright (c) 2008, Huagati Systems Co.,Ltd. 
/// </summary>

public class DocumentStorage
{
    private static StorageDirectory _StorageDirectory = null;

    public static string GetNewUNCPath()
    {
        string storageDirectory = GetStorageDirectory();
        if (!storageDirectory.EndsWith("\\"))
        {
            storageDirectory += "\\";
        }
        return storageDirectory + GuidEx.NewSeqGuid().ToString() + ".data";
    }

    public static void SaveDocumentInfo(string documentPath, Document documentInfo)
    {
        //the filestream object don't like NTFS streams so this is disabled for now...
        return;

        //stores a document object in a separate "docinfo" stream attached to the file it belongs to
        //XmlSerializer ser = new XmlSerializer(typeof(Document));
        //string infoStream = documentPath + ":docinfo";
        //FileStream fs = new FileStream(infoStream, FileMode.Create);
        //ser.Serialize(fs, documentInfo);
        //fs.Flush();
        //fs.Close();
    }

    private static string GetStorageDirectory()
    {
        string storageRoot = ConfigSettings.DocumentStorageRoot;
        if (!storageRoot.EndsWith("\\"))
        {
            storageRoot += "\\";
        }

        //get storage directory if not set
        if (_StorageDirectory == null)
        {
            _StorageDirectory = new StorageDirectory();
            lock (_StorageDirectory)
            {
                string path = ConfigSettings.ReadSettingString("CurrentDocumentStoragePath");
                if (path == null)
                {
                    //no storage tree created yet, create first set of subfolders
                    path = CreateStorageDirectory(storageRoot, 1);
                    _StorageDirectory.FullPath = path.Substring(storageRoot.Length);
                    ConfigSettings.WriteSettingString("CurrentDocumentStoragePath", _StorageDirectory.FullPath);
                }
                else
                {
                    _StorageDirectory.FullPath = path;
                }
            }
        }

        int fileCount = (new DirectoryInfo(storageRoot + _StorageDirectory.FullPath)).GetFiles().Length;
        if (fileCount > ConfigSettings.FolderContentLimitFiles)
        {
            //if the directory has exceeded number of files per directory, create a new one...
            lock (_StorageDirectory)
            {
                string path = GetNewStorageFolder(storageRoot + _StorageDirectory.FullPath, ConfigSettings.DocumentStorageDepth);
                _StorageDirectory.FullPath = path.Substring(storageRoot.Length);
                ConfigSettings.WriteSettingString("CurrentDocumentStoragePath", _StorageDirectory.FullPath);
            }
        }

        return storageRoot + _StorageDirectory.FullPath;
    }

    private static string GetNewStorageFolder(string currentPath, int currentDepth)
    {
        string parentFolder = currentPath.Substring(0, currentPath.LastIndexOf("\\"));
        int parentFolderFolderCount = (new DirectoryInfo(parentFolder)).GetDirectories().Length;
        if (parentFolderFolderCount < ConfigSettings.FolderContentLimitFolders)
        {
            return CreateStorageDirectory(parentFolder, currentDepth);
        }
        else
        {
            return GetNewStorageFolder(parentFolder, currentDepth - 1);
        }
    }

    private static string CreateStorageDirectory(string currentDir, int currentDepth)
    {
        string storageDirectory = null;
        string directoryName = GuidEx.NewSeqGuid().ToString();
        if (!currentDir.EndsWith("\\"))
        {
            currentDir += "\\";
        }
        Directory.CreateDirectory(currentDir + directoryName);

        if (currentDepth < ConfigSettings.DocumentStorageDepth)
        {
            storageDirectory = CreateStorageDirectory(currentDir + directoryName, currentDepth + 1);
        }
        else
        {
            storageDirectory = currentDir + directoryName;
        }
        return storageDirectory;
    }

    private class StorageDirectory
    {
        public string DirectoryName { get; set; }
        public StorageDirectory ParentDirectory { get; set; }
        public string FullPath
        {
            get
            {
                if (ParentDirectory != null)
                {
                    return ParentDirectory.FullPath + "\\" + DirectoryName;
                }
                else
                {
                    return DirectoryName;
                }
            }
            set
            {
                if (value.Contains("\\"))
                {
                    DirectoryName = value.Substring(value.LastIndexOf("\\") + 1);
                    ParentDirectory = new StorageDirectory { FullPath = value.Substring(0, value.LastIndexOf("\\")) };
                }
                else
                {
                    DirectoryName = value;
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T10:05:14.480

文件名的 SHA1 哈希 + 盐（或者，如果需要，文件内容的哈希值。这使得检测重复文件更容易，但也给服务器带来了更多压力）。这可能需要一些调整才能使其独一无二（即添加上传的用户 ID 或时间戳），并且加盐是为了使其不可猜测。

文件夹结构然后由散列的部分组成。

例如，如果哈希是“2fd4e1c67a2d28fced849ee1bb76e7391b93eb12”，那么文件夹可能是：

```
/2
/2/2f/
/2/2f/2fd/
/2/2f/2fd/2fd4e1c67a2d28fced849ee1bb76e7391b93eb12 
```

这是为了防止大文件夹（某些操作系统无法枚举包含一百万个文件的文件夹，因此为部分哈希创建了几个子文件夹。多少级别？这取决于您期望的文件数量，但通常是 2 或 3合理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T10:06:46.490

就您问题的一个方面（安全性）而言：将上传的文件安全地存储在文件系统中的最佳方法是确保上传的文件不在 webroot 之外（即，您不能通过 URL 直接访问它们 - 您必须通过脚本）。

这使您可以完全控制人们可以下载的内容（安全性）并允许进行诸如日志记录之类的事情。当然，您必须确保脚本本身是安全的，但这意味着只有您允许的人才能下载某些文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T10:54:25.910

扩展 Phill Sacre 的回答，安全性的另一个方面是为上传的文件使用单独的*域名*（对于即时，维基百科使用 upload.wikimedia.org），并确保该域无法读取您网站的任何 cookie。这可以防止人们上传带有脚本的 HTML 文件来窃取用户的会话 cookie（仅设置 Content-Type 标头是不够的，因为已知[某些浏览器](http://en.wikipedia.org/wiki/Internet_Explorer)会忽略它并根据文件的内容进行猜测；它还可以嵌入到其他类型的文件中，因此检查 HTML 并禁止它并非易事）。

# c - 为什么我们不能在结构中初始化成员？

> ID：225089
> 
> 赞同：57
> 
> 时间：2008-10-22T10:01:26.203
> 
> 标签：c, struct, initialization, member

为什么我们不能在结构中初始化成员？

例子：

```
struct s {
   int i = 10;
}; 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-22T10:03:43.267

如果要在**声明中初始化****非静态**成员：`struct`

 **在 C++（不是 C）中，`structs`几乎是类的同义词，并且可以在构造函数中初始化成员。

```
struct s {
    int i;

    s(): i(10)
    {
    }
}; 
```

如果要初始化**实例**：

在 C 或 C++ 中：

```
struct s {
    int i;
};

...

struct s s_instance = { 10 }; 
```

C99 还有一个称为指定初始化器的特性：

```
struct s {
    int i;
};

...

struct s s_instance = {
    .i = 10,
}; 
```

还有一个 GNU C 扩展，它与 C99 指定的初始化器非常相似，但最好使用更便携的东西：

```
struct s s_instance = {
    i: 10,
}; 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-10-22T15:14:12.797

直接的答案是因为结构定义声明了一个类型而不是一个可以初始化的变量。你的例子是：

```
struct s { int i=10; }; 
```

这没有声明任何变量——它定义了一个类型。要声明一个变量，您需要在`}`和之间添加一个名称`;`，然后再对其进行初始化：

```
struct s { int i; } t = { 10 }; 
```

正如 Checkers 所指出的，在 C99 中，您还可以使用指定的初始化器（这是一个了不起的改进——有一天，C 将赶上 Fortran 66 用于数据初始化的其他功能，主要是重复初始化器指定的次数）。使用这种简单的结构，没有任何好处。如果你有一个结构，比如说，20 个成员并且只需要初始化其中一个（比如说因为你有一个标志，表明结构的其余部分是否已初始化），那么它更有用：

```
struct s { int i; } t = { .i = 10 }; 
```

这个符号也可以用来初始化联合，选择联合的哪个元素被初始化。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-05-31T16:12:45.143

请注意，在 C++ 11 中，现在允许以下声明：

```
struct s {
   int i = 10;
}; 
```

这是一个老问题，但它在谷歌中排名很高，不妨澄清一下。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-22T10:05:30.017

**Edit2：**这个答案写于 2008 年，与 C++98 相关。成员初始化的规则在语言的后续版本中发生了变化。

**编辑：**这个问题最初是被标记`c++`的，但发帖人说它是关于`c`所以我重新标记了这个问题，但我留下了答案......

在 C++ 中，a`struct`只是一个`class`默认值，`public`而不是`private`成员和继承。

C++ 只允许`static const`内联初始化整数成员，其他成员必须在构造函数中初始化，或者如果`struct`是初始化列表中的[POD （声明变量时）。](http://en.wikipedia.org/wiki/Plain_Old_Data_Structures)

```
struct bad {
    static int answer = 42; // Error! not const
    const char* question = "what is life?"; // Error! not const or integral
};

struct good {
    static const int answer = 42; // OK
    const char* question;
    good() 
        : question("what is life?") // initialization list
        { }
};

struct pod { // plain old data
    int answer;
    const char* question;
};
pod p = { 42, "what is life?" }; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-14T18:14:19.370

我们不能初始化，因为当我们声明任何结构而不是我们实际所做的时，只需通知编译器它们的存在，即没有为此分配内存，如果我们初始化没有内存的成员。通常，当我们初始化任何变量时会发生什么，这取决于我们声明变量的位置编译器为该变量分配内存。

```
int a = 10; 
```

*   如果它是自动的，而不是在堆栈内存中分配
*   如果它是全局的，而不是在数据部分内存要分配

所以需要什么内存来保存这些数据，但是在结构的情况下没有内存，所以不可能初始化它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-31T16:26:06.623

正如你所说，它只是一个成员而不是变量。当您声明一个变量时，编译器还将为那些您可以放置​​值的变量提供内存空间。在结构成员 a 的情况下，编译器没有为它提供内存空间，因此除非您创建该结构类型的变量，否则您不能为结构成员分配值。

# javascript - Rails 中的 RJS/Javascript 约定

> ID：225096
> 
> 赞同：1
> 
> 时间：2008-10-22T10:04:31.393
> 
> 标签：javascript, ruby-on-rails, prototype, rjs

我开始研究 Rails 中的 RJS 和 Prototype/jQuery 的整个世界，我有点困惑。似乎没有明确的界限在哪里使用一个或另一个。

假设我想要 SO 上的“活动、热门、周”标签之一。当按下其中一个时，我想从我所在的那个中删除一个 CSS 类（如“active-tab”）并将其添加到我单击的那个中。然后我还想重新加载包含项目的 div 并将新项目放入其中。

似乎在纯 javascript 中更改类最容易，比如将代码放在 application.js 中，然后用内容更新 div 显然在 RJS 中是最简单的。但是一个人*应该*怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T11:27:39.477

如果您对编写 JavaScript 感到满意，那么请务必使用 JavaScript。这没有什么问题；您不必仅仅因为它存在就使用 RJS。事实上，您可能会发现它的抽象会妨碍您。

但是，如果您更愿意编写生成 JavaScript 的 Ruby 代码，就像在 ActiveRecord 迁移中编写生成 SQL 的 Ruby 代码一样，那么 RJS 是适合这项工作的工具。或者您可以同时使用两者：RJS 用于相当简单的事情，然后下拉到 JavaScript 用于更复杂的行为。使用你觉得合适的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T11:18:31.027

如果您想让用户能够直接链接到生成的页面，那么一定要选择静态页面。使用 AJAX 会破坏后退按钮，除非您使用像[真正简单的历史](http://code.google.com/p/reallysimplehistory/)（[不是 100% 跨浏览器](http://code.google.com/p/reallysimplehistory/wiki/ReleaseNotesVersionZeroPointSix)）这样的东西，所以[在页面导航中使用 JS 路由](http://ajaxian.com/archives/ajaxified-body-when-to-refresh-the-page)几乎肯定会导致一些用户问题。

也就是说，我认为您已经讨论过的内容很好 - 只需在您的 RJS 文件中更改类，然后您甚至可能会发现使用 page.replace 和部分更新 div 内容很有用：

```
page.replace(dom_id, :partial => @page_content); 
```

# c# - 游戏项目的类层次结构建议

> ID：225103
> 
> 赞同：2
> 
> 时间：2008-10-22T10:06:27.880
> 
> 标签：c#, oop, hierarchy, mud

我正在编写一个 MUD 引擎，我刚刚开始研究需要可扩展的游戏对象模型。

我需要帮助主要是因为我所做的事情感觉很混乱，但我想不出另一种更好的解决方案。

我有一个名为 的类`MudObject`，另一个名为的类`Container`，一个容器可以包含多个`MudObjects`，但它`MudObject`本身就是一个，但是`MudObject`需要知道它们包含在什么中。

所以它们看起来像这样：

```
public abstract class MudObject
{
    Container containedBy;
}

public abstract class Container : MudObject
{
    List<MudObject> Contains;
} 
```

*（请注意，这些只是示例，一些限定符和访问修饰符、属性等被遗漏了）*

现在这本身看起来很混乱，但让我们添加一些其他的东西：

`Item`是一个`MudObject`所有视觉物品（例如武器）都将从中继承的，但是其中一些也需要是容器（例如箱子）。但是在c#中没有多重继承之类的，所以归结为接口，最好的选择是使容器成为接口（据我所知）但是我不希望它是有原因的，那就是向容器中添加一个`MudObject`将导致容器更新`MudObject`s`.containedBy`值。

有什么想法可以完成这项工作，还是我陷入了让事情变得过于复杂的陷阱？
如果是这样，你还有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T10:17:08.357

我认为你过于复杂了。如果 MudObjects 可以包含其他 MudObjects，则您需要的单个基类应遵循以下原则：

```
public abstract class MudObject
{    
    MudObject containedBy; //technically Parent
    List<MudObject> Contains; //children
} 
```

这类似于 WinForms 和 ASP.NET 的工作方式。许多容器控件既是控件，又可以包含子控件的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T10:14:19.673

你想要的很合理：它与 Windows 窗体控件没有什么不同，它本身可以是其他控件的容器。

您需要做的是创建自己的实现`List<MudObject>`：

```
public class MudObjectList : List<MudObject> 
```

除其他外，它实现了添加功能：

```
public void new Add(MudObject obj)
{
    obj.ContainedBy = this;
    base.Add(obj);
} 
```

*注意：此方法隐藏而不是覆盖旧的 Add 功能*

通过这种方式，您可以在添加时立即填充 ContainedBy 属性。当然，这意味着您的 ContainedBy 可以是`null`，这意味着它是顶级对象。

最后，我认为不需要单独创建`MudObject`和`Container`类，因为作为容器看起来是 a 所固有的`MudObject`（ff 使用 C# 3.0 自动属性）：

```
public abstract class MudObject
{
    MudObject ContainedBy { get; set; }
    MudObjectList Contains { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T19:39:00.250

您要求的是合理的，并且是[复合设计模式](http://home.earthlink.net/~huston2/dp/composite.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T10:15:17.643

为什么不制作所有 MudObjects 容器？...或者至少，就您的类代码而言，能够包含其他对象。例如

```
public abstract class MudObject
{
    MudObject containedBy;
    List<MudObject> contains;
} 
```

然后，您可以在对象本身上设置某种标志，以识别玩家是否能够实际将东西放入或取出对象，而不是使用对象的类型来确定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T10:15:24.897

实际上，将某物既作为项目*又*作为容器是一个坏主意。这打破了许多对 IList 做出假设的绑定场景；所以对于一个箱子，我可能想在箱子上拥有一个 Items 属性*，*即集合，但让箱子只是一个箱子。

但是，对于所问的问题...

我很想将 MudObject 设为接口......这样，您可以使用类似以下的内容，它为您提供了任何具体对象的通用容器，以及自动父级：

```
public interface IMudObject
{
    IMudObject Container { get; set; }
    /* etc */
}

public class MudContainer<T> : Collection<T>, IMudObject
    where T : IMudObject
{

    public IMudObject Container { get; set; }

    protected override void ClearItems()
    {
        foreach (T item in this)
        {
            RemoveAsContainer(item);
        }
        base.ClearItems();
    }

    protected override void InsertItem(int index, T item)
    {
        SetAsContainer(item);
        base.InsertItem(index, item);
    }

    protected override void RemoveItem(int index)
    {
        RemoveAsContainer(this[index]);
        base.RemoveItem(index);            
    }
    protected override void SetItem(int index, T item)
    {
        RemoveAsContainer(this[index]);
        SetAsContainer(item);
        base.SetItem(index, item);
    }

    void RemoveAsContainer(T item)
    {
        if (item != null && ReferenceEquals(item.Container, this))
        {
            item.Container = null;
        }
    }
    void SetAsContainer(T item)
    {
        if (item.Container != null)
        {
            throw new InvalidOperationException("Already owned!");
        }
        item.Container = this;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T10:37:43.463

采用组合而不是继承的想法似乎已经消失了。

也许我可以做更多这样的事情

```
public class Container<T> where T : MudObject
{
    List<T> Contains;
    MudObject containerOwner;

    public Container(MudObject owner)
    {
        containerOwner = owner;
    }
    // Other methods to handle parent association
}

public interface IMudContainer<T> where T : MudObject
{
    Container<T> Contains { get; }
}

public class MudObjectThatContainsStuff : IMudContainer
{
    public MudObjectThatContainsStuff()
    {
        Contains = new Container<MudObject>(this);
    }

    public Contains { get; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T11:05:54.483

按照 Marc 的回答，编写几个在后台保持双向父子关系的类。

# java - 根据 JDialog 调整 JPanel 的大小

> ID：225108
> 
> 赞同：2
> 
> 时间：2008-10-22T10:08:09.373
> 
> 标签：java, swing, resize, jdialog

我有一个`JDialog`包含一系列的`JPanels`a `CardLayout`。其中一些面板包含`JTables`我希望根据`JDialog`. 我不知道如何实现这一点，任何帮助将不胜感激。

目前，这些表格只是保持其当前大小并且不缩放。我确定它很简单，但我无法找到所需的确切方法。

提前谢谢了。如果需要，我会提供更多信息。

编辑：`JDialog`用作向导，因此任何时候都只显示一个面板，因此使用`CardLayout`. 理想情况下，我希望将其保留为布局管理器，尽管如果它是问题的根源，那么显然我会重新考虑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T11:21:32.563

您可以保留 CardLayout，但您需要执行以下操作： 1\. 将 JDialog 的布局设置为 BorderLayout，并将新的 JPanel ( *contentPanel* ) 添加到 JDialog
2\. 现在将此*contentPanel*布局设置为 CardLayout
3\. 添加您的根据需要将其他面板添加到卡片布局中。
4\. 还要确保您在添加到 CardLayout 的每个面板上使用的布局。默认情况下，JPanel 使用 FlowLayout，我认为，这对于 JTable 来说并不理想。因此，您可能还需要调整包含表格的面板的布局；也可以试试 BoxLayout 或 BorderLayout。

# svn - 每个 SVN 自动冲突解决动作执行什么？

> ID：225109
> 
> 赞同：9
> 
> 时间：2008-10-22T10:08:20.247
> 
> 标签：svn

我编写了一个批处理脚本，它根据公司的工作基础递归地更新我的源代码。当发生冲突时，它会提示采取行动。'base' 和 'theirs-full' 和有什么不一样？'mine-full' 是否意味着“将我的更改保留在工作副本中，我稍后再提交”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-22T10:15:08.517

[http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.ref.svn.c.resolve](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.ref.svn.c.resolve)

总之：

根据

在更新工作副本之前选择作为 BASE 修订的文件。也就是说，您在进行最新编辑之前签出的文件。

在职的

假设您已手动处理冲突解决方案，请选择当前工作副本中的文件版本。

满地雷

在运行 svn update 之前，使用文件的副本解决所有冲突的文件。

他们的满

使用运行 svn update 时从服务器获取的文件副本解决所有冲突文件。

# html - 一行文本的工具提示

> ID：225114
> 
> 赞同：1
> 
> 时间：2008-10-22T10:12:07.570
> 
> 标签：html, xhtml

```
<td title="this is a really long line that I'm going to truncate">this is a really long line that I'm going to trunc ...</td> 
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T10:28:42.890

该属性在标签`title`内不起作用。`td`将文本括在 span 标记中：

```
<td>
    <span title="this is a really long line that I'm going to truncate">this is a really long line that I'm going to trunc ...</span>
</td> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T10:58:34.607

标题有一个最大长度。大约 80 个字符（在 FF2 上测试）。

因此，如果您的文本很长，则标题将无济于事。有几个很好的 css/javascript 工具提示解决方案可以显示您需要的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T10:18:08.807

是的，这就是您应该将工具提示分配给 html 元素的方式。我不会在 <td> 上使用它。虽然我没有测试过，但我感觉如果你直接在表格行/单元格上使用它，你可能会在某些浏览器上遇到问题，因为这些元素的行为与其他元素有些不同。您应该将它用于更多“常规”元素，例如 <div>、<span>、<img> 或 <input>。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T06:38:09.763

如果您想对工具提示进行一些控制，您可以尝试根据您的需要修改它 [css Tooltip](http://evolutionarygoo.com/blog/?p=45)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T10:28:43.170

我同意@DrJokepu，`title`属性是这样做的方法，但可能不在`TD`元素上，尝试`ABBR`元素，这就是它的用途，否则，简单`SPAN`的可能是最好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T11:07:24.713

您将如何格式化文本以显示换行符？在 IE 7.0 中

```
<title="long line of text\nanotherlong line of text" /> 
```

按预期工作 - 但在 Firefix 3.01 中，“\n”更改为空格。使用`<br/>`也无济于事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T11:07:31.297

FF2 有一个错误阻止它显示长标题：[https ://bugzilla.mozilla.org/show_bug.cgi?id=45375](https://bugzilla.mozilla.org/show_bug.cgi?id=45375)

标题不是核心属性吗？所以它几乎对每个标签都有效（只有少数标签，例如 html、head 等）

# delphi - Delphi：远离 VSS

> ID：225115
> 
> 赞同：8
> 
> 时间：2008-10-22T10:12:23.843
> 
> 标签：delphi, version-control, visual-sourcesafe

我们是几个多年来一直在使用 VSS 的 Delphi 开发人员团队（我知道这很遗憾），但我们不使用 VCS 的任何高级功能，所以它在很多情况下都可以正常工作（但有时它是快把我逼疯了 ：（ ）。

VSS 的好处是我们使用第三方插件将 VSS 与 Delphi 集成，这很好用，但是现在当我们的项目变得更大时，我们想从 VSS 转移。

我查看了其他几个 VCS（免费和商业），发现它们中的大多数似乎都是为 Linux 人员制作的，而且您必须使用命令行来进行许多管理工作（我知道我是 windows 人：P）。

我正在寻找新的版本控制，它应该易于使用和维护，并与 Delphi IDE (D2007) 很好地集成，或者至少为管理员和开发人员提供一个好的 UI。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-22T10:14:15.493

只需使用[SVN](http://subversion.tigris.org/)和与 Windows 资源管理器集成的优秀[TortoiseSVN客户端。](http://tortoisesvn.tigris.org/)

PS 发现了这个问题：[开发 Win32 Delphi 应用程序的最佳工具集是什么？](https://stackoverflow.com/questions/63957/what-is-the-best-set-of-tools-to-develop-win32-delphi-applications)而这个 Delphi IDE/TortoiseSVN 集成工具在答案之一： http: [//delphiaddinfortortoisesvn.tigris.org/](http://delphiaddinfortortoisesvn.tigris.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T16:02:04.540

您至少应该看看[JVCS](http://jedivcs.sourceforge.net/)。它与 Delphi IDE 集成，它是用 Delphi 编写的并且是开源的，您可以从包括 Firebird 在内的多个数据库中进行选择来存储您的存档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T10:02:31.647

有 Team Coherence ( [http://www.teamcoherence.com/](http://www.teamcoherence.com/) )，它是用 Delphi 编写的，与 IDE 集成得很好。我们仍然使用它。支持虽然不完整。

不过，大多数人似乎正在转向 SubVersion。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-25T10:46:47.470

Team Coherence 是一个不错的选择。他们刚刚发布了一个新客户端，所以看起来支持很活跃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-30T12:28:51.347

除非您直接前往 SVN（如果您想免费使用 Git 或 Mercurial，我不建议您这样做）检查 Plastic SCM。在这里找到几个 Delphi 特定的教程：

[http://codicesoftware.blogspot.com/2008/06/branching-and-merging-with-delphi-part.html](http://codicesoftware.blogspot.com/2008/06/branching-and-merging-with-delphi-part.html) [http://codicesoftware.blogspot.com/2008/06/branching-and-merging-with-delphi -part_02.html](http://codicesoftware.blogspot.com/2008/06/branching-and-merging-with-delphi-part_02.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T20:18:02.777

我们的 Delphi 团队最近（去年）从 VSS 升级到了[Perforce](http://www.perforce.com)，与它一起工作非常愉快。它很贵，但非常值得。它使源代码控制成为您交易的工具之一，而不是一件苦差事或障碍。它有很好的 GUI 工具，在需要时有一个很棒的命令行，并且在线提供免费的 Delphi IDE 集成。

这确实需要一些时间来适应，但是当您知道您不必担心永远丢失任何更改时，您可以创建带有放弃和合并更改的分支时，值得付出努力。它快速、高效且使用愉快。

# sql - Sql CE 的探查器

> ID：225121
> 
> 赞同：17
> 
> 时间：2008-10-22T10:15:01.480
> 
> 标签：sql, sql-server-ce, profiler

我想知道是否有类似于 Sql Profiler for Sql Server Compact Edition 的东西？我使用 SqlCE 作为桌面应用程序的后端，为这个嵌入式数据库提供类似 sql profiler 的东西真的很棒。或者至少与 NHibernate show_sql 功能类似的东西......有什么想法吗？谢谢j。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T06:30:24.417

我所知道的唯一可以解决这个问题的经过测试的解决方案是[Altiris Profiler](https://stackoverflow.com/questions/206743/is-there-any-way-i-can-get-net-stack-traces-in-sql-profiler-or-a-similar-tool)，它是我在上一份工作中设计的工具，但它是封闭源代码且非出售的。

您将其挂钩的方式是为您的命令创建一个工厂，并在使用它们之前对它们进行代理以进行分析（使用 RealProxy）。它的重量非常轻，大约需要 10 行代码来实现。

在[我的问题](https://stackoverflow.com/questions/206743/is-there-any-way-i-can-get-net-stack-traces-in-sql-profiler-or-a-similar-tool)上，弗洛里谈到了一个名为[dynaTrace](http://www.dynatrace.com/en/)的新工具，它也可以解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T00:09:16.107

我认为这行不通——CE 似乎是完全不同的野兽。

您可以启用一些可能对您有帮助的日志记录：

[http://msdn.microsoft.com/en-us/library/ms171949(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms171949(SQL.90).aspx)

我尝试这样做并设法设置数据库并从 SSMS 连接 - 您必须指定“SQL Server Compact Edition”的备用连接类型。Profiler 没有这样的东西 - 为“数据库”字段输入数据文件的路径什么也没做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T16:17:49.593

尝试安装标准版本（使用分析器），您也可以连接到 CE 实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-21T16:55:18.247

我认为它有可能使用 Default Profiler Trace Template（来自 Visual Studio 2008）来完成。我在我的博客中谈到了使用模板用于非 CE 版本的 SQL：http: [//codingathome.blogspot.com/2009/04/create-sql-trace-and-read-it-using-sql.html](http://codingathome.blogspot.com/2009/04/create-sql-trace-and-read-it-using-sql.html) .

该模板可能适用于 SQL 的 CE 版本。我没试过。您的里程可能会有所不同。我知道 SQL CE 不支持存储过程，所以这可能行不通。您可能必须在代码中设置调试以跟踪查询。

由于 CE 不支持存储过程，我敢打赌您仍然可以将脚本作为 .sql 脚本运行并安装跟踪事件。这值得一试。

# .net - 从 WCF/ADO.NET 数据服务中的请求正文接收参数

> ID：225130
> 
> 赞同：2
> 
> 时间：2008-10-22T10:17:37.310
> 
> 标签：.net, javascript, ajax, wcf, ado.net

我正在尝试发布到 ADO.NET 数据服务，但参数似乎在此过程中丢失了。

我得到了类似的东西：

```
[WebInvoke(Method="POST")]
public int MyMethod(int foo, string bar) {...} 
```

我使用prototype.js进行ajax调用：

```
var args = {foo: 4, bar: "'test'"};
new Ajax.Requst(baseurl + 'MyMethod',
  method: 'POST',
  parameters: args,
  onSuccess: jadda,
  onFailure: jidda
} 
```

如果我用“方法：'GET'”和“WebInvoke（Method =“POST”）”替换“方法：'POST'”和“WebGet”一切正常，但现在（使用post）我得到的是：

> 错误请求 - 查询语法错误。

从服务。

唯一的解决方法（我不想使用）是即使在我执行帖子时也发送 URL 中的所有参数。欢迎任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T23:49:20.323

WCF 和 ASMX 网络服务往往对请求正文有点挑剔，当您指定 args 时，请求通常被编码为表单 post 即 foo=4&bar=test 而您需要指定 javascript 文字：-

```
 new Ajax.Request(baseurl + 'MyMethod', {
        method: 'POST',
        postBody: '{"foo":4, "bar":"test"}',
        encoding: "UTF-8",
        contentType: "application/json;",
        onSuccess: function(result) {
            alert(result.responseJSON.d); 
        },
        onFailure: function() {
            alert("Error");
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T10:27:30.550

如果要使用 POST，则需要在 WebInvoke 属性中指定要包装在请求中的参数，除非参数包含对象（例如消息合同）。这是有道理的，因为如果不包装在 json 或 xml 中，就无法序列化参数。

未包装的确实不是 XML，因为缺少根元素

```
<foo>1</foo>
<bar>abc</bar> 
```

已包装的有效 XML

```
<Request>
   <foo>1</foo>
   <bar>abc</bar>
</Request> 
```

此示例也适用于 JSON

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T11:36:49.647

你是说我应该像javascript一样包装参数吗

```
var args = {Request: {foo: 3, bar: "'test'"}} 
```

还是我错过了什么？

我试图添加：

```
ResponseFormat=WebMessageFormat.Json, RequestFormat=WebMessageFormat.Json, BodyStyle=WebMessageBodyStyle.Wrapped 
```

到 WebInvoke-attribute 但没有结果。我尝试将“Content-Type”（在 js POST ajax-call 中）设置为“application/x-www-form-urlencoding”和“application/json; charset=utf-8”，但没有结果。

# ms-word - 为什么你可以在 Office Interop 中创建接口实例？

> ID：225135
> 
> 赞同：1
> 
> 时间：2008-10-22T10:18:46.153
> 
> 标签：ms-word

在使用 Office 互操作类时，我已经多次看到这种情况

```
this.CustomXMLParts.Add(MyResources.Data, new Office.CustomXMLSchemaCollection()); 
```

如果我将鼠标悬停在 CustomXMLSchemaCollection 类上，它会显示为一个界面。那我怎么可以做一个新的呢？是什么赋予了？顺便说一句，这段代码可以编译并工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T11:01:28.547

您不是在创建`CustomXMLSchemaCollection`接口的实例，而是创建`CustomXMLSchemaCollectionClass`coclass 的实例。

接口的定义`CustomXMLSchemaCollection`是：

```
[Guid("000CDB02-0000-0000-C000-000000000046")]
[CoClass(typeof(CustomXMLSchemaCollectionClass))]
public interface CustomXMLSchemaCollection : _CustomXMLSchemaCollection
{
} 
```

这意味着实现接口的指定 coclass 是`CustomXMLSchemaCollectionClass`. 我的猜测是，当 C# 编译器看到新的 for`CustomXMLSchemaCollection`接口时，它会将其转换为`CustomXMLSchemaCollectionClass`基于接口提供的属性创建一个 COM 实例。

写完这个简单的例子后：

```
namespace ConsoleApplication2
{
    using System;
    using Office = Microsoft.Office.Core;

    class Program
    {
        static void Main(string[] args)
        {
            Office.CustomXMLSchemaCollection test = new Office.CustomXMLSchemaCollection();
        }
    }
} 
```

我刚刚运行了[ildasm](http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx)并获得了以下 MSIL：

```
.method private hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       8 (0x8)
  .maxstack  1
  .locals init ([0] class [Interop.Microsoft.Office.Core]Microsoft.Office.Core.CustomXMLSchemaCollection test)
  IL_0000:  nop
  IL_0001:  newobj     instance void [Interop.Microsoft.Office.Core]Microsoft.Office.Core.CustomXMLSchemaCollectionClass::.ctor()
  IL_0006:  stloc.0
  IL_0007:  ret
} // end of method Program::Main 
```

如您所见，构造的类是`CustomXMLSchemaCollectionClass`为了证明我最初的假设。

# jakarta-ee - 如何在 jBoss 4.2 中查找 ejb？

> ID：225148
> 
> 赞同：2
> 
> 时间：2008-10-22T10:24:21.837
> 
> 标签：jakarta-ee, jboss

我有一个简单的 j2ee 应用程序：

```
foo.ear
 - foo.war
 - foo.jar (ejb3 jar) 
```

我正在使用 ejb3 jar 部署程序部署到符合 J2EE 1.4 的 jBoss 4.2.2。因此，目前不可能在 servlet 中使用 @EJB 注释。但是，在常规的 1.4 j2EE 应用程序中，我可以`<ejb-local-ref>`在 web.xml 中使用一个元素，因为我的 ejb 是 v3，它们没有`<local-home>`接口。任何人都可以建议一种符合 Java EE 的方法来从 servlet 中查找我的 ejb，**而无需使用特定于平台的 JNDI 查找**吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T11:42:57.887

答案是**否定**的。您必须使用全局 JNDI 名称：

> @EJB 注释可用于 servlet 和 JSP，但不幸的是，我们尚未更新 tomcat 以支持它。此外，Tomcat 使用旧的 XML 格式，因此您也不能使用 XML。所以现在，您必须通过其全局 JNDI 名称来查找 EJB。

有关详细信息，请参阅[jBoss 文档](http://www.jboss.org/jbossejb3/docs/tutorial/ear/ear.html)。

# asp.net - 如何让 Asp.Net 将用户重定向回他们的起点

> ID：225149
> 
> 赞同：0
> 
> 时间：2008-10-22T10:24:39.340
> 
> 标签：asp.net, navigation

伙计们，我已经编写代码 15 年多了，但直到 3 个月前才设法避免“Web 开发”。

我继承了一个旧的 Asp.net 应用程序（从 .net 1.1 开始，我们现在使用 .Net 2.0），它是我们产品的管理工具。

在一些地方，管理工具只是维护一长串值。

列表（可能是 200 多个项目）出现在 GridView（页面 A）中，用户单击项目的编辑按钮，这会将他们带到项目的编辑页面（页面 B），他们可以在其中更改值（或值，列表中的项目可能与多个值相关联，例如名称和地址以及首选颜色、猫的品种......）

目前，当用户在页面 B 上按下“保存”时，我们会重定向回页面 A。该页面在列表顶部打开，这让用户很恼火，因为经常需要依次配置多个项目，而用户需要到 1\. 记住他们刚刚编辑的项目，2\. 向下滚动到该项目

我想要做的是让列表将用户带回到他们刚刚编辑的项目，因为通常需要一起配置顺序的几个项目。

**最快的枪停止**。. . 继续阅读

1.  关于“重新组合项目以减少列表中的项目”行的建议将被视为无用
2.  .Net 3.5 自动执行此操作的有效点，将被我认为没有帮助（但无论如何发布它们，它可能会帮助其他一些可怜的傻瓜）
3.  我想我可以通过在重新加载页面 A 时发布已编辑项目的 ID 并将网格滚动到这一点来做到这一点，但是**我的问题是**. . .

是否有一个我不知道的功能（以及它是什么）和/或
什么是公认的这样做的方式？

在此先感谢 B. Warrier

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T10:49:43.313

这可以使用锚标签来实现。在页面 A 上输出元素时，在每个元素旁边设置一个锚标记，如下所示：

```
<a name="#175"></a> 
```

该项目的项目 ID 为 175。然后，当您重定向回 PageA 时，将“#175”添加到 url 的末尾

```
Response.Redirect("PageA.aspx#175"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T10:39:25.580

您可以做的最简单的方法是在 URL 中的查询字符串中从 PageB 传回一个 id，同时在保存到 PageB 后重定向回 PageA。

例如 www.example.com/PageA.aspx?editedId=89

而在PageA的PageLoad中，可以通过查看HttpContext.Current.QueryStrubg["editedId"]中是否有有效值来判断是否来自编辑详情页，如果有则表示来自PageB。您可以使用此值轻松突出显示或选择数据网格中的行

**最快的枪停止。. .** 并继续阅读...

一个好的控件允许您在同一页面上同时编辑多行，例如在 PageA 上，并将它们保存在一起。检查您的 Telerik 控件是否有数据网格。你会喜欢的。

# mysql - 从 MyISAM 更改为 InnoDB 时是否有任何陷阱/需要知道的事情

> ID：225150
> 
> 赞同：8
> 
> 时间：2008-10-22T10:24:59.823
> 
> 标签：mysql, innodb, myisam, change-management

我的一个项目在 MySQL 中使用了 MyISAM 引擎，但我正在考虑将其更改为 InnoDB，因为我需要在这里和那里的事务支持。

*   在执行此操作之前，我应该查看或考虑什么？
*   我可以只更改引擎，还是应该为此准备数据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T10:31:11.353

是的，绝对有很多事情，你应该非常彻底地测试你的应用程序：

*   事务可能会死锁并且需要重复。即使自动提交的事务只插入一行，情况也是如此（在某些情况下）。
*   光盘使用量几乎肯定会增加
*   写入期间的 I/O 负载几乎肯定会增加
*   由于 InnoDB 使用聚集索引，索引行为将发生变化——这在某些情况下可能是有益的影响
*   您的备份策略将受到影响。仔细考虑这一点。

迁移过程本身需要仔细计划，因为如果您有大量数据，这将需要很长时间（在此期间数据将是只读的，或者完全不可用 - 请检查！）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-26T16:04:00.583

有一个很大的警告。如果您在写入期间遇到任何类型的硬件故障（或类似情况），InnoDB 将损坏表。

MyISAM 也会，但是 mysqlcheck --auto-repair 会修复它们。尝试使用 InnoDB 表将失败。是的，这是来自经验。

这意味着您需要有一个良好的定期数据备份计划才能使用 InnoDB。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T08:28:30.743

其他一些注意事项：

删除表/数据库或删除记录后，InnoDB 不会重新分配文件系统上的可用空间，这可以通过“转储和导入”或`innodb_file_per_table=1`在 my.cnf 中设置来解决。

在大型 InnoDB 表上添加/删除索引可能会非常痛苦，因为它会锁定当前表，使用您更改的索引创建一个临时表并逐行插入数据。[Innobase](http://www.innodb.com/doc/innodb_plugin-1.0/innodb-create-index.html)有一个插件，但它仅适用于 MySQL 5.1

InnoDB 也有更多的内存密集型，我建议您在`innodb_buffer_pool_size`服务器内存允许的范围内拥有尽可能大的变量（70-80% 应该是一个安全的赌注）。如果您的服务器是 UNIX/Linux，请考虑将 sysctl 变量减少`vm.swappiness`到 0 并使用`innodb_flush_method=O_DIRECT`以避免双重缓冲。在切换这些值时，请务必测试是否点击了交换。您可以随时在[Percona 博客上](http://www.mysqlperformanceblog.com/2007/11/01/innodb-performance-optimization-basics/)阅读更多内容，这很棒。

此外，您可以在备份开始时`mysqlbackup`使用`--single-transaction --skip-lock-tables`并且没有表锁来运行。

无论如何，InnoDB 很棒，不要让一些陷阱让你灰心。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T15:55:00.267

只需更改表格并设置引擎就可以了。

*   需要注意的一个大问题是`select count(*) from MyTable`InnoDB比 MyISAM 慢得多*。*

*   在服务器重新启动后，auto_increment 值将重置为表 +1 中的最大值——如果您有一个带有一些删除的凌乱数据库，这可能会导致有趣的问题。
*   最佳服务器设置将不同于主要的 MyISAM 数据库。
*   确保 innodb 文件的大小足以容纳您的所有数据，否则当您更改表的引擎时，您将被不断的重新分配所困扰。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T05:53:23.933

如果您打算使用 InnoDB 作为获取并发查询的一种方式，那么您将需要进行设置`innodb_file_trx_commit=1`，以便获得一些性能。OTOH，如果您希望重新编码您的应用程序以了解事务，那么决定此设置将成为 InnoDB 设置所需的一般性能审查的一部分。

另一个需要注意的主要事情是 InnoDB 不支持全文索引，也不支持 INSERT DELAYED。但是，MyISAM 不支持参照完整性。:-)

但是，您只能移动需要事务感知的表。我已经做到了。小表（最多几千行）通常可以随时更改，顺便说一句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T10:26:17.933

性能特征可能不同，因此您可能需要密切关注负载。

数据会好的。

# .net - 我可以在 Windows 上将 32 位 DLL 加载到 64 位进程中吗？

> ID：225151
> 
> 赞同：34
> 
> 时间：2008-10-22T10:25:29.620
> 
> 标签：.net, windows, 64-bit, x86-64

我最近升级了 ac# windows 服务以作为 64 位 .net 进程运行。通常，这很简单，但系统使用了一个用 C++ 编写的 32 位 DLL。将此 DLL 转换为 64 位不是一个选项，因此我将 DLL 包装在一个单独的 32 位 .net 进程中，并通过远程处理公开了一个 .net 接口。

这是一个非常可靠的解决方案，但我更愿意将系统作为单个进程运行。有什么方法可以将我的 32 位 DLL 加载到 64 位进程中并直接访问它（可能通过某种 thunking 层）？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-22T10:29:47.957

不，你不能。

> 16 位和 32 位 Windows 都存在于 32 位线性地址空间中。术语 16 和 32 指的是相对于选择器的偏移量大小。
> 
> ...
> 
> 首先，请注意全尺寸的 16 位指针和 32 位平面指针的大小相同。值 0x0123:0x467 需要 32 位，哇，32 位指针也是如此。这意味着包含指针的数据结构不会在 16 位和 32 位对应物之间改变大小。一个非常方便的巧合。
> 
> **这两个观察结果都不适用于 32 位到 64 位的转换。指针的大小发生了变化，这意味着将 32 位结构转换为 64 位结构（反之亦然）会改变结构的大小**。并且 64 位地址空间是 32 位地址空间的 40 亿倍。如果 64 位地址空间中偏移量 0x000006fb`01234567 处有一些内存，则 32 位代码将无法访问它。并不是说你可以建立一个临时地址窗口，因为 32 位平面代码不知道这些临时地址窗口；他们放弃了选择器，记得吗？

[http://blogs.msdn.com/oldnewthing/archive/2008/10/20/9006720.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/10/20/9006720.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-14T23:00:56.917

如果您的 .NET 应用程序是在 IIS 中运行的网站，您可以绕过它。

在 64 位机器上的 IIS 上运行的 ASP.NET 网页将由 64 位版本的 w3wp.exe 进程托管，如果您的网页使用 32 位 dll，您的网站将失败。

但是在 IIS 中，您可以进入运行该站点的应用程序池的高级设置，并将“启用 32 位应用程序”更改为 true。

所以它仍然无法在 64 位进程中运行 32 位 dll，而是将 w3wp.exe 作为 32 位进程运行。

# project-management - 软件需求实际上是政治性的好指针？

> ID：225154
> 
> 赞同：-1
> 
> 时间：2008-10-22T10:25:40.680
> 
> 标签：project-management, requirements

可能是一个简单的：

**是否有任何经验法则或提示可以帮助识别政治要求？**

假设一个利益相关者（您的老板、另一个部门的负责人或实际用户）要求您或您的团队正在开发的软件的功能或特定特征。是否有确定要求是否具有政治性的试金石？

这个问题真的很简单，不是关于如何处理政治要求或者它们对软件是好是坏。你怎么知道无论你被要求做什么都是为了追求某人的默许或实际上公开声明的政治议程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T10:44:00.720

它真的会帮助你知道吗？我的意思是——如果你已经卷入了政治游戏，无论如何你都会知道的。如果你不是，它不是你可以使用的东西。

如果您无论如何都必须实现该功能，我会说继续使用它。发现它是一些管理游戏的一部分只会让你失去动力。

也就是说 - 如果您正在开发的应用程序是如此的*软件*以至于您无法判断它是真正的用户功能还是某种政治杠杆，那么它可能是一个安全的假设，一切都是政治的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T10:36:03.013

最好的办法是找出所有特征的用途，即不仅要找出一个特征是如何实现的，还要了解为什么要这样做。了解所需解决方案的背景确实很有帮助。它甚至可以让您建议更适合您的客户的替代功能集（甚至可以玩您自己的政治游戏）。

只要有什么你不明白的，就不要做这个项目。它只会在某些时候引起问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T11:20:24.827

我想说你应该假设所有要求都是政治性的。

如果您处于一个多人负责确定您实现的功能集的情况，那么每个功能实际上都是这些人之间的协商。那次谈判使这些特征具有政治性。

然而，即使只有一个人来决定发布哪些功能，这些决定仍然很有可能是政治性的。在任何规模合理的组织中（比如十个人以上），你都会有政治。这种情况下的政治将不同于“委员会设计的情况”。他们将专注于讨好决定发布哪些功能的人，而不是委员会场景中存在的“如果你支持我的功能，我会支持你的”。然而，这一过程仍然是政治性的。

我并不是说不可能有一个没有政治的发展环境。这是。但是，我会说要实现它，您需要：

1.  一个小而紧密的团队
2.  一个专注于创造一个培养创造力的环境的老板，并委派创意所有权，而不是专注于控制创意过程。
3.  聪明、才华横溢、富有创造力的人，具有强烈的使命感和审美价值观。

缺少其中任何一项，你就注定会陷入重复的办公室政治泛滥。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T10:30:48.953

显然这是一个棘手的问题，很大程度上取决于你对“政治”的定义。我将从一个简单的问题开始： * 需求的作者/发起者是否真的在使用相关软件？

需求可能来自你的老板，但它可能是真实用户的翻译有效需求

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T10:44:01.797

以下是我见过的一些：

*   它直接与其他要求相矛盾
*   技术上显然不可行
*   它是“在左边的领域”......它不适合定义的问题空间
*   违背常识

当心...有时这是由于您的用例错误或不完整造成的。我还特意允许其中一些进行开发（例如，销售产品但无用或至少通常不被运营商使用的 Eye-candy）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T11:22:17.820

使用 SCRUM 方法。不要将功能描述为

“它应该以下列方式做这个和那个”

虽然上面的句子描述了实现该功能所需的所有知识，但它并不能证明该功能的合理性。我的 SCRUM 书说功能应该写成故事。一个故事是这样的：

“作为 <user-role>
我需要一个 <functionality>
以便获得 <business value>”

使用这样的故事无法证明的功能是不合理的功能，因此实际实现它是没有用的。

例如

“作为*门户网站的访问者，*我需要一种*身份验证*方法，以便我可以*访问我的客户数据，但其他人无法访问*”

现在您不仅知道您需要对您的门户网站进行身份验证，您还知道谁需要它（访问者，基本上每个人都计划更深入地使用它）并且您还知道**为什么**需要它，因为它为用户提供了一些价值。

其他示例：

“作为一名*乘客*，我需要*一份我所有预订旅程的清单*，以便*我知道我什么时候要去哪里旅行，并且不会丢失概览*”

“作为一名*簿记员*，我希望*根据客户数据将销售税自动打印到每张账单上*，这样*我就不必每次打印账单时都手动输入*”

如果每个功能都需要这样编写，您将自动查看某个功能是否适合客户，因为它确实是必要的，或者只是您的老板/公司想要拥有的东西以及他们想要拥有它的原因（什么是背后的大局？他们为什么要这样做？）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T10:36:20.580

使用模棱两可的词或短语通常是政治性的。

然而，

[永远不要把可以用愚蠢充分解释的事情归咎于恶意。](http://en.wikiquote.org/wiki/Robert_J._Hanlon)

# java - 在 Eclipse 中，当所有 Java 源编译没有错误时，什么会导致 Package Explorer “red-x”错误图标？

> ID：225167
> 
> 赞同：105
> 
> 时间：2008-10-22T10:28:46.070
> 
> 标签：java, eclipse

我正在使用 Eclipse 进行 Java 开发。我所有的源代码都编译得很好，生成的应用程序也编译得很好。但是，我在包资源管理器中不断收到“red-x”错误通知。

我在这个源目录中的所有源（对于快照来说太长）编译得很好，没有一个显示“red-x”错误图标。

任何有关如何解决问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-10-22T10:39:34.083

是的，这种情况有时会无缘无故地发生。您可以转到“问题”-选项卡（就在控制台输出旁边）并查看错误消息，所以也许您可以通过这种方式缩小范围。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-02-03T17:07:00.013

这在我使用 Maven 时经常发生，在我发现这个问题之前我一直忽略它。在这种情况下，您需要更新项目（通过查看“问题”窗格来解决这个问题）

从项目上下文菜单中：Maven -> Update Project 并选择可用的 Maven 代码库

或者，您可以使用 (Alt + F5) 调出相同的窗口

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-22T10:44:16.790

尝试清理项目并重建它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-06-17T12:25:14.113

建好后。刷新项目，如果仍然存在，只需右键单击 Eclipse 中的问题选项卡并选择全部删除。

如果您执行 maven 安装并且 eclipse 属性文件没有正确更新，这通常会发生。即使您的项目没有任何错误。希望！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T11:16:32.793

我想首先感谢所有回答的人。但就我而言，清洁和重建还不够，因为问题仍然存在并且需要修复。

结果发现我的一个包目录被意外复制了，所以现在存在一个名为“dagskra 副本”的额外目录，其中包含带有错误包声明的 Java 文件。此外，这个“新”目录中的错误不会在它所在的包中显示为“red-x”：

[包资源管理器的快照显示错误的“dagskra 副本”目录 http://www.freeimagehosting.net/uploads/a824304b18.png](http://www.freeimagehosting.net/uploads/a824304b18.png)

正是阅读“问题”选项卡的提示 :-) 使我转向了正确的方向，因此我选择该答案作为已接受的答案，因为这是我需要的：

[来自问题选项卡的快照 http://www.freeimagehosting.net/uploads/dea26d5dd0.png](http://www.freeimagehosting.net/uploads/dea26d5dd0.png)

希望这会帮助其他人......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-13T13:17:06.217

因此，在发现构建路径中可能缺少包时，因此对主项目的红色 x 将其删除：

1) 进入项目的“配置构建路径” 2) Java 构建路径 -> 源选项卡 - 您应该看到红色 x 与缺少的包/文件相对。如果它不再存在，只需“删除”它。

红 X 走开！:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T10:39:55.643

有时 .project 中存在构建路径错误，您需要切换到资源视图才能实际查看导致错误的文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T11:21:27.743

正如其他人所说，构建路径中的错误文件引用通常是罪魁祸首。

通常是已移动/删除的 .jar 文件。Eclipse 希望在指定位置找到构建路径上引用的所有内容，如果没有，则会报错。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-19T18:47:45.773

我有同样的问题，下面的步骤解决了这个问题：

1.  从 PROJECT>properties>java build path>libraries 中删除 JRE。

2.  重启日食

3.  再次添加 JRE

4.  使用 Project>Clean 重建项目并选择自动构建选项。

请试试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-08-06T16:00:53.723

Subversion 有时也是造成这种情况的罪魁祸首。它可能与您的环境无关。但是，项目的当前状态和本地状态之间可能存在差异。在我的情况下，进行更新，然后提交到颠覆服务器为我提供了预期的干净结果，项目中没有任何标志，例如 X.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-02T15:57:59.523

在我的情况下，解决这个问题的方法只是关闭 Eclipse 并再次打开它......但是我仍然不确定为什么会发生这种情况或为什么会起作用。我在清理我的项目时遇到问题（它说它无法删除某些文件），这解决了它:)：

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T10:38:39.203

尝试进行重建。我发现在重建完成之前，红色的 x 并不总是消失。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-22T10:43:37.617

我多次遇到类似的问题，对我来说通常发生的情况是一个 java 文件会说它不会在文本编辑器中编译，但在包资源管理器中它会说它编译得很好。

有时进行“重建”或“清理构建”不起作用，文件实际上并没有被构建（必须假设 eclipse 认为它拥有的文件是最新的），当这种情况发生时，我通常会打开java构建路径，只需将我的依赖项之一向下/向上移动啄食顺序。这迫使 Eclipse 重新构建所有内容，并且它似乎总是有效。

如果您仍然遇到问题，请尝试复制项目并查看是否有相同的行为，并在最后一次尝试发布 Eclipse 错误时，他们可能需要一段时间才能修复，但至少您知道您正在听到。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-22T10:49:30.383

要添加到先前的答案，“清理”项目的一种极端方法是删除它（即从工作区中删除其引用，而不是删除实际文件），然后重新导入它。
有时，它有助于...

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-23T09:15:30.523

FindBugs 还会在文件/包上放置一个 red-x，以指示静态代码分析错误。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-18T17:35:57.497

我经历过这个。我的案子涉及更多。该项目是从 Maven 命令行很好地打包的。

我做了几件事。1.一个类有很多混淆了eclipse的导入。清理它们解决了部分问题 2。一个案例是关于 Setter，按 F3 导航到该 Setter，尽管 Eclipse 抱怨它不存在。所以我只是重新输入它并且它工作正常（即使对于所有其他 Setter）

我仍在为默认构造函数未定义隐式超级构造函数而苦苦挣扎。必须定义一个显式构造函数”

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-03-09T08:49:38.937

我也时不时在包裹上遇到那些神秘的错误符号。摆脱它们对我有用的一种方法是从 Java 构建路径中有效地删除 JRE 系统库并重新添加它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-06-07T18:18:28.203

我最终奏效的解决方案是清理所有项目，关闭 Eclipse，清理所有项目，关闭 Eclipse，等等至少 5-6 次。最终一切都安定下来，一切都如预期的那样。有史以来最奇怪的事情！

不，问题或控制台视图中没有错误。

这也发生在计算机崩溃后。上次发生这种情况时，我的整个工作空间都完全丢失了。它仍然在计算机上，但是当我尝试访问它时，它全是空白的。

无论出于何种原因，日食对计算机崩溃的处理确实非常糟糕。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-08-01T07:59:54.430

此外，您可以通过单击更新项目，

右键单击项目名称 -> 选择 Maven -> 右键单击​​ -> 更新项目。

这对我有帮助。

谢谢。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-09-30T12:00:33.383

发生这种情况的原因有很多。如果您更改了 jdk，Project facet 旁边将有一个红色的 X，而其他文件夹不会显示错误。如果是这种情况，请修改显示的 jdk。这有时发生在我们的 JAX-WS 类（[HSG](http://www.hartmannsoftware.com)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-03-25T18:24:12.253

我解决了我的

*   关闭所有其他项目（即不相关的项目选项）

*   清洁和建造

我的项目是 android，并且做到了。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-02-13T07:00:58.380

当我在 Eclipse Mars 上下载 fabric.io 时发生了这种情况，但重新启动计算机为我解决了这个问题。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-05-11T02:29:15.123

我有同样的问题。我检查了“问题”-选项卡，没有发现该项目的服务器。我定义了服务器。red-x 消失了

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-05-17T08:14:40.740

您可以转到项目-> 构建路径-> 库

如果有任何带有 X 标记的库，即 [交叉标记] 将其删除，然后再次尝试构建。它也对我有用/

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-05-28T11:33:59.037

我今天遇到了这个问题，找到了这个链接。我按照上面 Patrick Schaefer 的说法，打开了更新 Maven 项目对话框。单击我的工作项目并选中复选框“强制更新快照/发布”和“确定”。所有的红十字都消失了。我希望这可以帮助处于类似情况的任何人。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-07-01T10:10:49.783

这个问题很老，但我遇到了这个问题，我尝试了以下方法无济于事。

*   mvn 更新（带快照）
*   删除项目并重新导入
*   干净的构建
*   重新启动 Eclipse
*   更改构建路径中的项目顺序

就我而言，我有多模块 mvn 项目，其中一个嵌套项目仅在项目资源管理器中显示红色 X 图标（包资源管理器和问题都很好），整个项目都很好，因为我可以运行没有任何类问题。所以似乎是一个显示问题。

唯一对我有用的是编辑 pom.xml 如果有问题的项目模块并进行破坏性更改（将“xxx”添加到标签名称）导致 1000 个错误然后撤消。

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2017-07-07T15:58:06.260

右键单击有错误的项目，然后在子菜单中选择： *Maven* > *UpdateProject* >

进而：

*   选中所有依赖项目的复选框
*   选择强制更新快照
*   单击确定。

这对我有用..

# java - 什么样的行为会导致异常中断？

> ID：225194
> 
> 赞同：33
> 
> 时间：2008-10-22T10:41:35.187
> 
> 标签：java, multithreading, exception

我对 Java 中的 Threading 比较陌生，我注意到每次使用 Thread.sleep() 时，我都必须捕获 InterrupetdException。

什么样的行为会导致这种情况，在我有监控线程的简单应用程序中，我可以忽略异常吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-22T11:34:52.273

它发生在线程上 调用[interrupt()时。](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#interrupt())[Brian Goetz 的这篇文章](http://www.ibm.com/developerworks/java/library/j-jtp05236.html)解释了中断机制以及应该如何处理 InterruptedExceptions：

> “对 InterruptedException 最常见的响应是吞下它——捕获它而不做任何事情（或者可能记录它，这也没有更好）——正如我们稍后将在清单 4 中看到的那样。不幸的是，这种方法抛弃了重要的有关发生中断的事实的信息，这可能会损害应用程序取消活动或及时关闭的能力。”
> 
> “如果你捕获了 InterruptedException 但不能重新抛出它，你应该保留中断发生的证据 [...]。这个任务是通过调用 interrupt() 来“重新中断”当前线程来完成的。”

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-22T11:18:57.140

正如其他人所说，这是由其他一些线程调用正在休眠`interrupt()`的`Thread`对象引起的。

用简单的英语来说，这意味着其他一些线程已决定取消休眠线程。try/catch 块在那里，因此您可以优雅地处理线程的取消，并安全地清理任何资源，或关闭它正确执行的任何操作。

如果您实际上不需要执行任何操作，那么是的，您仍然需要一个空的 catch 块。但那是适合你的 Java...​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-22T15:24:56.380

Java Concurrency in Practice 的一些建议：

> *   传播异常（可能在某些特定于任务的清理之后），使您的方法也成为可中断的阻塞方法；或者
> *   恢复中断状态，以便调用堆栈上更高的代码可以处理它。
> *   只有实现线程中断策略的代码才能吞下中断请求。通用任务和库代码不应该吞下中断请求。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T10:46:16.910

主要情况是当有人在您的线程上调用[Thread.interrupt()](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#interrupt())时。

如果您真的不希望它发生，那么抛出 RuntimeException 可能会更安全，但对于非常简单的情况，您可能会忽略它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-22T10:47:05.067

从[javadocs](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/InterruptedException.html)：

> **类 InterruptedException**
> 
> 当一个线程等待、休眠或以其他方式暂停很长时间**并且另一个线程使用 Thread 类中的中断方法中断它时抛出。**

希望这能回答你的问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-22T10:47:00.417

InterruptedException 是一个检查异常，所以不幸的是你不能忽略它。在大多数简单的情况下，您不必在 catch 子句中做任何事情，因为您确信它不会发生。

从 API

> 当一个线程等待、休眠或以其他方式暂停很长时间并且另一个线程使用 Thread 类中的中断方法中断它时抛出。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-22T10:45:58.097

好吧，如果其他一些线程调用thread.interupt()，而线程正在休眠，你会得到异常。是的，您可能只需将 try..catch 放在 sleep() 周围并忽略它；)

# java - 如果 Java VM 反复崩溃，我该怎么办？

> ID：225207
> 
> 赞同：4
> 
> 时间：2008-10-22T10:46:40.730
> 
> 标签：java, crash, virtual-machine

如果满足以下条件，解决 Java VM 崩溃的最佳做法是什么：

*   没有自己的或第三方的本机代码。100% 纯 Java
*   相同的程序在许多其他系统上运行没有任何问题。

PS：VM崩溃的意思是VM写一个像hs_err_pid1234.log这样的转储文件并终止。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T11:13:23.797

阅读 hs_err_pid1234.log 文件（或任何错误日志文件名）。里面一般都有线索。下一步取决于您在日志中发现的内容。

是的，这可能是您正在使用的特定 JVM 实现版本中的错误，但我也看到了操作系统中内存碎片引起的问题。例如，Windows 很容易将 dll 固定在不适当的位置，因此当 JVM 要求时无法分配连续的内存块。其他 out opf 内存问题也可以通过这种类型的故障转储表现出来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T11:03:39.743

更新或更换您的 JVM。如果您当前拥有最新版本，请尝试使用旧版本，或者如果您没有最新版本，请尝试更新到它。也许它在您的特定版本中是一个已知问题？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T11:41:10.107

Assuming the JVM version across machines is the same:

Figure out what is different about the machine where the JVM is crashing. Same `OS` and `OS` version? We have problems with JVMs crashing on a particular version of Red Hat for example. And we have also found some older Red Hat versions unable to cope with extra memory properly, resulting in running out of swap space. (Our solution was to upgrade RedHat).

Also, is the program doing *exactly* the same thing across machines? Is it accessing a shared filesystem? Is the file system mounted similarly on your machines (`SMB`/`NFS` etc)? Something must be different.

The log file should give you some idea of where the crash occurred (`malloc` for example).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:22:46.630

查看转储文件中的堆栈跟踪，因为它应该告诉您崩溃发生时发生了什么。

除了深入研究`hs_err`转储文件之外，我还将它提交给 Sun 或制作你的 JVM 的任何人（我相信文件顶部有关于如何执行此操作的说明？）。它伤不起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T11:45:14.327

32位？64位？客户端机器中的内存量？处理器？操作系统？查看系统之间是否有任何连接。一个连接可能会导致一个线索。如果一切都失败了，请考虑使用不同的主要/次要版本的 JVM。此外，如果问题刚刚开始，您能否到达程序没有崩溃的时间（通过版本控制）？查看 hs_err 日志，您可能会了解导致崩溃的原因。它可能是 JVM 使用的其他一些客户端库的一个版本。最后，在 debug/profile 中运行程序，也许你会在崩溃前看到一些症状（假设你可以复制它）

# c# - 删除重复图像

> ID：225210
> 
> 赞同：33
> 
> 时间：2008-10-22T10:47:20.683
> 
> 标签：c#, algorithm, image-processing

我们收集了数百张大小的照片图像。大量照片在视觉上是重复的，但文件大小、分辨率、压缩等不同。

是否可以使用任何特定的图像处理方法来搜索和删除这些重复的图像？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-07-18T10:59:30.383

我最近想为 PHP 图像库完成这项任务。我希望能够为上传的图像生成“模糊”指纹，并检查数据库中是否存在具有相同指纹的任何图像，表明它们相似，然后更仔细地比较它们以确定相似程度。

我通过将上传的图像大小调整为 150 像素宽，将其减小为灰度，将每种颜色的值四舍五入到最接近的 16 倍数（在 0 到 255 之间给出 17 种可能的灰度阴影），将它们标准化并将它们存储在一个数组，从而创建一个“模糊”颜色直方图，然后创建一个直方图的 md5sum，然后我可以在我的数据库中搜索它。这对于缩小与上传文件在视觉上非常相似的图像非常有效。

然后将上传的文件与数据库中的每个“相似”图像进行比较，我拍摄了两张图像，将它们调整为 16x16，并逐个像素地分析它们，并将每个像素的 RGB 值与其他图像，将所有值相加并除以像素数，得出平均颜色偏差。任何小于特定值的都被确定为重复。

整个过程是使用 GD 模块用 PHP 编写的，与数千张图片的比较每个上传的文件只需要几百毫秒。

我的代码和方法在这里： http: [//www.catpa.ws/php-duplicate-image-finder/](http://www.catpa.ws/php-duplicate-image-finder/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T11:37:54.263

尝试[PerceptualDiff](http://pdiff.sourceforge.net/)比较具有相同尺寸的 2 个图像。允许阈值，例如考虑仅具有 X 个不同像素的图像在视觉上无法区分。

如果视觉副本可能由于缩放或不同的文件类型而具有不同的尺寸，您可能需要制作标准格式以进行比较。例如，我可能会使用 ImageMagick 将所有图像缩放到 100x100 并将它们保存为 PNG 文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T11:55:38.767

一个非常简单的方法如下：

*   在内存中将图像转换为灰度，因此每个像素只是 0（黑色）和 255（白色）之间的数字。

*   将图像缩放到固定大小。找到合适的尺寸很重要，你应该尝试不同的尺寸。例如，您可以将每个图像缩放到 64x64 像素，但使用更小或更大的图片可能会得到更好或更差的结果。

*   为所有图像完成此操作后（是的，这将需要一段时间），请始终在内存中加载两个图像并将它们彼此相减。那就是将图像 A 中的像素 (0,0) 的值减去图像 B 中的像素 (0,0) 的值，现在对两者中的 (0,1) 执行相同的操作，依此类推。结果值可能是正数或负数，您应该始终存储绝对值（因此 5 会导致 5，-8 但会导致 8）。

*   现在您有了第三张图像，它是图像 A 和 B 的“差异图像”（增量图像）。如果它们相同，则增量图像全黑（所有值都将减为零）。它的“黑色越少”，图像就越不一样。你需要找到一个好的阈值，因为即使图像实际上是相同的（对你的眼睛而言），通过缩放、改变亮度等，增量图像也不会是全黑的，而是只有非常深的灰色调。所以你需要一个阈值，上面写着“如果平均误差（增量图像亮度）低于某个值，它们仍然很有可能是相同的，但是如果高于该值，它们很可能不是。找到正确的阈值与找到正确的缩放大小一样难。您将始终有误报（图像被认为是相同的，

这个算法非常慢。实际上，仅创建灰度图像需要大量时间。然后，您需要将每张 GS 图像相互比较，再一次，大量的时间。存储所有 GS 图像也会占用大量磁盘空间。所以这个算法很糟糕，但结果并没有那么糟糕，尽管它很简单。虽然结果并不令人惊讶，但它们比我最初想象的要好。

获得更好结果的唯一方法是使用高级图像处理，在这里它开始变得非常复杂。它涉及很多数学（真的很多）；许多系统都有很好的应用程序（欺骗查找器）已经实现了这些，所以除非你必须自己编程，否则最好使用这些解决方案之一。我阅读了很多关于这个主题的论文，但恐怕其中大部分都超出了我的视野。甚至我根据这些论文可能能够实现的算法也超出了它；这意味着我了解需要做什么，但我不知道它为什么起作用或它实际上是如何起作用的，这只是魔术;-)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-09T23:58:17.237

我实际上写了一个[应用程序](http://deadringer.codeplex.com)来做这件事。

我从以前的应用程序开始，该应用程序使用基本的[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)算法来计算图像相似度，但由于多种原因，这种方法是不可取的。毫无疑问，您要找到的用于确定图像相似度的最快算法是[均方误差](http://en.wikipedia.org/wiki/Mean_squared_error)或[平均绝对误差](http://en.wikipedia.org/wiki/Mean_absolute_error)（两者的运行时间均为 O(n)，其中 n 是图像中的像素数，并且以多种不同的方式线程化任一算法的实现也是微不足道的）。Mecki 的帖子实际上只是一个平均绝对误差实现，我的应用程序可以执行（如果您愿意，代码也可用于您的浏览乐趣）。

无论如何，在我们的应用程序中，我们首先对图像进行下采样（例如，将所有图像缩放为 32*32 像素），然后转换为灰度，然后通过我们的比较算法运行生成的图像。我们还在研究一些更高级的预处理算法，以进一步规范化图像，但是……还没有。

肯定有比 MSE/MAE 更好的算法（事实上，这两种算法应用于视觉信息的问题已得到充分证明），例如[SSIM](http://en.wikipedia.org/wiki/SSIM)，但它是有代价的。其他人试图比较图像中的其他视觉质量，例如亮度、对比度、颜色直方图等，但与简单地测量误差信号相比，这一切都是昂贵的。

我的应用程序*可能会*工作，具体取决于这些文件夹中有*多少*图像。它是多线程的（我已经看到它完全加载了八个处理器内核来执行比较），但我从未针对大于几百张图像的图像数据库进行测试。几百演出的图像听起来大得令人望而却步。（只需从磁盘读取它们、下采样、转换为灰度并存储在内存中——假设你有足够的内存来保存所有内容，而你可能没有——可能需要几个小时）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T11:18:58.950

我相信这仍然是一个研究领域。如果您有一些时间，一些相关的关键字是：

*   图像复制检测
*   基于内容的图像检索
*   图像索引
*   图像重复删除

基本上，每个图像都经过处理（索引）以产生“图像签名”。相似的图像具有相似的签名。如果您的图像只是重新缩放，那么它们的签名可能几乎相同，因此它们聚集得很好。一些流行的签名是 MPEG-7 描述符。对于聚类，我认为 K-Means 或其任何变体可能就足够了。但是，您可能需要处理数百万张图像，这可能是个问题。

这是维基百科主要条目的链接：
[http ://en.wikipedia.org/wiki/CBIR](http://en.wikipedia.org/wiki/CBIR)

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T10:51:35.433

一个快速的破解方法是编写一个程序，该程序将计算每个图像中的平均像素值，以灰度显示，按此值排序，然后在视觉上比较它们。非常相似的图像应该按排序顺序彼此靠近。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T10:57:07.510

图像相似度可能是图像处理/AI 的一个子领域。

如果您正在寻找一个出色的（即高性能和可扩展的）解决方案，请准备好从论文中实现算法/公式。

如果您想要快速而肮脏的东西，请在谷歌搜索[图像相似度](http://www.google.com.au/search?q=image+similarity+&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a)

[这是](http://knight.cis.temple.edu/~video/ImRet/index.htm)一个 C# 图像相似性应用程序，它可能会做你想做的事。

基本上，所有算法都提取和比较特征。他们如何定义“特征”取决于他们所基于的数学模型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T11:39:00.437

您将需要一个命令行工具来处理如此多的数据。

比较每对可能的图像不会扩展到如此大的图像集。您需要根据某些指标对整组图像进行排序，以便仅对相邻图像进行进一步比较。

一个简单度量的示例是图像中所有像素的平均值，表示为单个灰度值。这只有在副本没有任何视觉变化时才有效。使用有损文件格式也会导致视觉上的改变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-22T11:55:49.360

跳出框框思考，您也许可以使用图像元数据来缩小数据集的范围。例如，您的图像可能包含显示图像拍摄日期和时间的字段，精确到秒。重复项可能具有相同的值。可以使用诸如[exiv2](http://www.exiv2.org/)之类的工具将这些数据转储为更方便和可排序的文本格式（对批处理/shell 脚本有一点了解）。

甚至相机制造商和型号等字段也可以用于将一组 1,000,000 张图像减少到 100 组 10,000 张图像，这是一个显着的改进。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T10:54:56.003

gqview 程序有一个查找重复项的选项，因此您可以尝试在那里查找。然而，它并不是万无一失的，所以它只适合作为一种启发式向人类呈现重复项，以进行手动确认。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T11:01:27.253

最重要的部分是使文件具有可比性。

一个通用的解决方案可能是将所有图像缩放到某个固定大小和灰度。然后将生成的图像保存在具有相同名称的单独目录中以供以后参考。然后可以按文件大小排序并直观地比较相邻条目。

生成的图片可能会以某些方式量化，以编程检测相似性（块、线等的平均）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T12:25:13.060

我想最可扩展的方法是为每个图像存储一个指纹。然后，当添加新图像时，这是一个简单的例子，`SELECT id FROM photos where id='uploaded_image_id'`检查重复（或指纹所有图像，然后查询重复

显然，由于实际内容不同，简单的文件哈希将不起作用..

[声学指纹](http://en.wikipedia.org/wiki/Acoustic_fingerprint)/[本文](http://ismir2002.ismir.net/proceedings/02-FP04-2.pdf)可能是这个概念的一个良好开端，因为它有很多实现。[这](http://www.jjtc.com/pub/csis_tr_99_05_nfj/)是一篇关于图像指纹识别的论文。

也就是说，您也许可以摆脱一些更简单的事情。一些基本的东西，比如将图像大小调整为相等的宽度或高度，减去`image_a`，`image_b`然后求和。如果总差异低于阈值，则图像是重复的。

这样做的问题是您需要将每张图像相互比较。所需时间将成倍增加..

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-22T12:47:15.200

如果你能想出一种比较遵循三角不等式的图像的方法（例如，如果 d(a,b) 是图像 a 和 b 之间的差异，那么 d(a,b) < d(a,c) + d(b,c) 对于所有 a,b,c)，那么[BK-Tree](http://en.wikipedia.org/wiki/BK-tree)将是索引图像的有效方法，这样您就可以在 O(log n) 时间而不是 O(n) 时间内找到匹配项每个图像。

如果在不同程度的压缩/调整大小/等之后您的匹配仅限于同一图像，那么转换为一些规范的大小/颜色平衡/等并简单地将每个像素的差异平方相加可能是一个很好的指标，这服从三角不等式，因此您可以使用 BK-tree 进行有效访问。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-22T13:06:09.450

如果你有一点钱可以花，也许一旦你运行第一遍以确定哪些图像*可能*匹配，你可以为亚马逊的 Mechanical Turk 编写一个测试。

[https://www.mturk.com/mturk/welcome](https://www.mturk.com/mturk/welcome)

本质上，您将创建一个小部件，AMT 将向真正的人类用户展示，然后他们基本上只需要回答“这两个图像是否相同？”的问题。或者你可以向他们展示一个 5x5 图像的网格，然后问他们“这些图像中的哪一个匹配？”。然后，您将收集数据。

另一种方法是使用 Luis Von Ahn ( [http://www.cs.cmu.edu/~biglou/](http://www.cs.cmu.edu/~biglou/) ) 最着名的人类计算原理和 reCaptcha，它使用验证码答案来确定不可读的单词已通过光学字符识别运行，从而有助于将书籍数字化。您可以制作一个验证码，要求用户帮助优化图像。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-22T13:05:11.573

这听起来像是程序问题而不是编程问题。谁上传照片？你还是客户？如果您要上传照片，请将尺寸标准化为固定比例和文件格式。这样比较会更容易。但是，就目前而言，除非您有几天甚至几周的空闲时间，否则我建议您改为手动删除重复的图像，由您自己或您的团队通过视觉比较图像。

也许您应该按位置对图像进行分组，因为它是旅游图像。

# java - 带有远程和本地接口的 EJB 业务接口模式

> ID：225221
> 
> 赞同：0
> 
> 时间：2008-10-22T10:52:27.130
> 
> 标签：java, jakarta-ee, ejb

如何将业务接口模式与具有本地和远程接口的 EJB（会话 bean）一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T12:37:15.297

接口是本地的还是远程的都没有关系。您可以将所有业务方法写入一个接口，然后将其用作本地和远程接口。不同之处在于它将如何被调用，而不是执行什么。

# .net - VB.Net 中我的功能的文档在哪里？

> ID：225233
> 
> 赞同：8
> 
> 时间：2008-10-22T10:56:44.783
> 
> 标签：.net, vb.net, visual-studio-2005

不，我不是一个聪明人...

对于那些幸运地不知道 My 类的人：它是**在 VB 2005 中添加的（在 C# 中不存在），最好将其描述为“.net 框架的快速拨号”。** 应该让那些不会阅读他们应该使用哪些框架类的新手的生活更轻松

```
Dim contents As String
contents = My.Computer.FileSystem.ReadAllText("c:\mytextfile.txt") 
```

而不是这个：

```
Dim contents As String
contents = IO.File.ReadAllText("c:\mytextfile.txt") 
```

我的问题：**快速拨号按钮映射到什么的 MSDN 文档页面在哪里？**
通过将功能名称选择为 My - 他们让搜索变得更加有趣。我需要用 C# 编写代码，无法忍受翻译专门处理 VB 的培训/操作方法办公室编视频的乐趣。

来自丹斯的更多信息

*   [http://msdn.microsoft.com/en-us/magazine/cc163972.aspx](http://msdn.microsoft.com/en-us/magazine/cc163972.aspx)
*   [http://blogs.msdn.com/danielfe/archive/2005/06/14/429092.aspx](http://blogs.msdn.com/danielfe/archive/2005/06/14/429092.aspx)

Juval Lowy 在 C# 中移植了 My as That 作为临时解决方案。不要问我为什么...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T11:01:57.330

可能有助于搜索的是“我的命名空间”而不是“我的类”。

到目前为止，我发现了这个：http: [//msdn.microsoft.com/en-us/vbasic/ms789188.aspx](http://msdn.microsoft.com/en-us/vbasic/ms789188.aspx)，但这并不理想。寻找更多...

编辑：我认为[“与我一起开发”](http://msdn.microsoft.com/en-us/library/5btzf5yk.aspx)实际上是文档的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T11:07:54.057

My 命名空间的官方参考可以[在](http://msdn.microsoft.com/en-us/library/8ffec36z.aspx)MSDN 上找到。

不幸的是，它没有描述我的快捷方式映射到哪个“真正的”框架功能（尽管在大多数情况下这并不难弄清楚）。

As a further annoyance, the source code isn't released as part of the .NET Reference Source either (same situation as with Microsoft.VisualBasic, even though being able to check the source would do a lot to demystify this part of the Framework...)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T11:04:05.143

[这](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.myservices.aspx)看起来很有希望 - 它是 MyServices 区域的详细说明（在 VB 中提供 My）

还有一些[在这里](http://msdn.microsoft.com/en-us/vbasic/ms789188.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T11:04:28.543

命名空间内的不同功能的`My`行为非常不同，并且使用不同的技术实现。不幸的是，他们没有“一个”文档。

许多快捷方法引用 Microsoft.VisualBasic.dll 中的类。您当然可以从 C# 中引用它。

一些映射（绝不完整）：

*   `My.Application`=>`Microsoft.VisualBasic.ApplicationServices.ApplicationBase`

    继承自该类以产生VB的应用程序框架。

*   `My.Computer`=>`Microsoft.VisualBasic.Devices.ServerComputer`
*   `My.User`=>`Microsoft.VisualBasic.ApplicationServices.User`
*   `My.Settings`=> 直接映射到 C#`RootNamespace.Properties.Settings`
*   `My.Resources`=> 直接映射到 C#`RootNamespace.Properties.Resources`

# sharepoint - 在 Sharepoint 中的用户 MySite 上默认 WebPart

> ID：225243
> 
> 赞同：4
> 
> 时间：2008-10-22T10:59:14.730
> 
> 标签：sharepoint, moss

我正在开展一个项目，该项目正在用 sharepoint 替换旧的门户系统 (Plumtree)，我们希望使过渡尽可能顺利。

我们目前正在研究的一件事是获取所有小工具（WebParts 的 Plumtree 术语）并确保它们出现在用户新的 MySite 上的相同位置。

Plumtree 将这些信息保存在一个包含用户、页面、小工具和位置信息的简单表格中。我想找到一种方法来自动读取此表并将新的 WebParts 放在用户 MySite 上，而不必为数百个用户手动设置它。

有人告诉我，直接在 SQL Server 中修改 Sharepoint 表不是一个好选择，因为它可能会影响我们的支持安排，但如果这样可以节省手动执行此操作，那么我会考虑它。

想到的其他选项是创建等效表并在用户第一次访问其 MySite 时使用 API 调用加载 WebPart。

有更好的建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T15:12:31.367

你是对的，不支持也不推荐直接搞乱数据库。

不幸的是，修改 MySites 的方法并不多，我所知道的最好的方法来自 MOSS 团队博客：http: [//blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my -sites-within-the-enterprise.aspx](http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T16:29:24.890

我们这样做的方式几乎就是上面链接中描述的内容（[http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-企业.aspx](http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx)）。

您最好的选择可能是在 MySite 创建中装订一个功能，并让它轮询 plumtree 数据库，找到该用户的小工具，并为每个用户添加一个“页面查看器”Web 部件，指向小工具的位置。也就是说，您可能需要重新考虑盲目地将所有的 plumtree 小工具迁移到 SharePoint 中。可能有更好的“SharePointy”方式来提供您的小工具当前提供的功能。

# c++ - 如何在给定头文件的情况下生成空定义

> ID：225250
> 
> 赞同：10
> 
> 时间：2008-10-22T11:01:25.210
> 
> 标签：c++

我有一个 3rd-party 库，由于各种原因我不想链接。我不想破坏我的代码以删除对其 API 的所有引用，所以我想生成它的虚拟实现。

有没有我可以使用的工具在给定头文件的情况下吐出类的空定义？默认情况下返回 null、false 和 0 就可以了。我不想做任何即时或任何聪明的事情——我看过的模拟对象库看起来很重？理想情况下，我想要使用类似的东西

```
$ generate-definition my_header.h > dummy_implemtation.cpp 
```

我正在使用 Linux，GCC4.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T16:00:00.957

这是一个比你想象的更难的问题，因为解析 C++ 很快就会成为一项艰巨的任务。您最好的选择是选择一个具有良好界面的现有解析器。

快速搜索发现[这个线程](http://compilers.iecc.com/comparch/article/06-09-169)有很多建议解析器做类似的事情。

在最坏的情况下，您可能能够使用 SWIG --> Python，然后在其上使用反射来打印一个虚拟实现。

抱歉，这只是一个半答案，但我认为没有现有的工具可以做到这一点（除了模拟框架，这可能与使用解析器的工作量相同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:43:53.173

创建一个读取头文件并创建源文件的测试应用程序。测试应用程序应解析头文件以了解函数名称。

# c# - 有没有一种方法可以在没有例如数据的情况下绑定单个项目。中继器控件？

> ID：225263
> 
> 赞同：19
> 
> 时间：2008-10-22T11:05:07.697
> 
> 标签：c#, asp.net, webforms

假设我有一个 Car 类型的对象，我想将其呈现为 HTML：

```
class Car {
  public int Wheels { get; set; }
  public string Model { get; set; }
} 
```

我不想使用 ASP.NET Repeater 或 ListView 控件进行绑定，因为它看起来太冗长了。我只有一个对象。但我仍然希望能够使用数据绑定语法，因此我不必使用标签或文字。就像是：

```
<div>
  Wheels: <%# (int)Eval("Wheels") %><br />
  Model: <%# (string)Eval("Model") %>
</div> 
```

有人知道那里有一个控制吗？

而且我还没有准备好切换到 ASP.NET MVC。

* * *

不幸的是，DetailsView 控件不能满足我的需要，因为它似乎不支持我所追求的模板样式语法。它也需要绑定到一种 DataSource 对象。

我更喜欢 Maxim 和 Torkel 建议的解决方案。我会努力做到这一点。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-22T11:09:48.563

如果页面是关于特定项目的（例如，Car.aspx?CarID=ABC123），我通常在页面上有一个名为“CurrentCar”的公共属性

```
public Car CurrentCar { get; set; } 
```

然后我可以拥有以下内容：

```
<div>
  Wheels: <%= CurrentCar.Wheels %><br />
  Model: <%= CurrentCar.Model %>
</div> 
```

这使您具有类型安全性。只需确保在实际渲染之前分配了一个有效的对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T11:16:24.790

我建议您在页面上将 car 设为受保护的属性，这将允许您直接在 aspx 页面中访问它：

```
<div>
  Wheels: <%= Car.Wheels %>
  Wheels: <%= Car.Models %>
</div> 
```

这种方法实际上更适合单项数据绑定方案，因为“绑定”是强类型的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T11:44:06.620

受保护属性解决方案的一个缺点是您不能使用它来绑定控件的属性。

例如，以下内容将不起作用：

```
<asp:Label ID="Label1" Text="Probably a truck" Visible='<%# CurrentCart.Wheels > 4 %>' runat="server" /> 
```

# editor - 在 vi 中自定义单词分隔符

> ID：225266
> 
> 赞同：58
> 
> 时间：2008-10-22T11:06:11.753
> 
> 标签：editor, vi

vi 将破折号`-`和空格视为`dw`和等命令的单词分隔符`cw`。

有没有办法添加下划线`_`？

我经常想更改包含下划线的变量名的一部分，例如更改`src_branch`为`dest_branch`. 我最终计算了字符并使用`s`（like `3sdest`），但它会更容易使用`cw`（like `cwdest`）。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-23T18:13:53.600

> 有没有办法添加下划线`_`？

```
:set iskeyword-=_ 
```

什么是关键字，什么不是成员字符取决于语言。有关 iskeyword 使用的帮助`:help iskeyword`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-22T11:31:15.743

如果您使用的是 vim，您可以通过设置`iskeyword`选项 ( `:he iskeyword`) 来更改它。如果这不是一个选项，您可以随时使用`ct_`而不是计数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-14T18:56:55.247

在这种情况下，另一个不错的选择是使用[camelcasemotion](http://www.vim.org/scripts/script.php?script_id=1905)插件。

它添加了新的动作`,b`、`,e`和，它们与、和`,w`类似地工作，除了它们识别 CamelCase 和 snake_case 词。有了它，您可以使用`b``e``w`

```
c,edest 
```

如果您的光标位于“src_branch”的第一个字符上，这将用“dest_branch”替换“src_branch”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T11:27:37.183

您可以键入`cf_dest_`并保存计数部分。

**编辑：**或按照建议：`ct_`更改文本直到下划线字符之前。（我更多地使用这个`f`动作，所以它对我来说更自然）

或者你可以重新定义`'iskeyword'`（`:help iskeyword`详情）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T13:11:02.927

我自己只是在看这个并将其添加到我的 .vimrc 中：

```
set iskeyword=!-~,^*,^45,^124,^34,192-255,^_ 
```

我的 .vimrc 有问题 ^| 和 ^"，这是我设置的默认 iskeyword 的一部分，所以我更改为它们的 ascii 值并且它工作正常。我的主要修改是在默认设置的末尾添加 "^_" 以防止 vim 看到下划线作为单词的一部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-10-09T18:17:14.630

要删除到下一个下划线，请输入“df_” 要更改到下一个下划线，请输入“cf_” 注意：不要包含双引号。

# delphi - 是否有谷歌数据 API 的 Delphi 实现？

> ID：225273
> 
> 赞同：11
> 
> 时间：2008-10-22T11:09:10.497
> 
> 标签：delphi, google-data-api, atom-feed

Google 提供了[各种](http://code.google.com/apis/gdata/clientlibs.html)用于与 Google 数据 API 交互的库。目前这些不包括 Delphi (Win32) 支持。

有没有人在谷歌数据的 Delphi 接口或底层 Atom/AtomPub 协议上做过任何工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T19:58:07.107

谷歌有一个[未解决](http://code.google.com/p/gdata-issues/issues/detail?id=209&colspec=API%20ID%20Type%20Status%20Priority%20Stars%20Summary&start=100)的问题，建议他们创建一个。

> 谢谢你的建议。
> 
> 这在不久的将来可能不会发生，因为我们需要将可用资源集中在其他领域。
> 
> 然而，GData 是基于标准 XML 和 HTTP 请求的，所以在 Delphi 客户端库上的工作当然可以在 Google 之外完成。我会将这个问题保持开放，以便其他人可以投票，也许社区中的某个人可以选择这个。

所以你可以[投票](http://code.google.com/p/gdata-issues/issues/detail?id=209&colspec=API%20ID%20Type%20Status%20Priority%20Stars%20Summary&start=100)。

# python - 在 python 中从 feedparser 解析不同的日期格式？

> ID：225274
> 
> 赞同：11
> 
> 时间：2008-10-22T11:09:20.513
> 
> 标签：python, datetime, parsing, rss, feedparser

我正在尝试通过[feedparser](http://feedparser.org)从两个不同的 RSS 提要中的条目中获取日期。

这是我正在做的事情：

```
import feedparser as fp
reddit = fp.parse("http://www.reddit.com/.rss")
cc = fp.parse("http://contentconsumer.com/feed")
print reddit.entries[0].date
print cc.entries[0].date 
```

他们是这样出来的：

```
2008-10-21T22:23:28.033841+00:00

Wed, 15 Oct 2008 10:06:10 +0000 
```

我想达到可以轻松找出哪个更新的程度。

我尝试使用 Python 的 datetime 模块并搜索 feedparser 文档，但我无法解决这个问题。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-22T11:35:42.317

使用 RSS 提要在野外解析日期是一件很痛苦的事情，而这`feedparser`可以提供很大的帮助。

如果您使用`*_parsed`属性（如`updated_parsed`），`feedparser`将完成工作并将返回 UTC 中的 9 元组 Python 日期。

有关更多血腥细节，请参阅[http://packages.python.org/feedparser/date-parsing.html](http://packages.python.org/feedparser/date-parsing.html)。

# .net - 如何强制卸载windows服务

> ID：225275
> 
> 赞同：189
> 
> 时间：2008-10-22T11:09:25.957
> 
> 标签：.net, windows-services

我使用 installUtil.exe 安装了 Windows 服务。

更新代码后，我再次使用 installUtil.exe 安装服务，无需先卸载原始版本。

当我现在尝试卸载服务时，installUtil.exe 成功完成卸载，但服务仍然出现。

如果我尝试更改其属性，我会收到消息“服务已标记为删除”。

如何强制删除（最好不重启服务器）？

* * *

## 回答 #1

> 赞同：512
> 
> 时间：2009-10-28T15:34:19.413

过去引起我注意的一件事是，如果您正在运行服务查看器，那么这会阻止服务被完全删除，因此请提前关闭

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2011-06-09T12:21:57.130

您不必重新启动机器。以提升模式启动 cmd 或 PowerShell。

```
sc.exe queryex <SERVICE_NAME> 
```

然后你会得到一些信息。将显示一个 PID 编号。

```
taskkill /pid <SERVICE_PID> /f 
```

其中 /f 是强制停止。

现在您可以安装或启动您的服务。

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2009-10-08T21:01:28.117

好吧，如果卸载不删除任何机会，您可以使用 SC.EXE 强制删除任何 Windows 服务。

```
sc delete <Service_Name> 
```

阅读有关“MS Techno Blogging”的更多信息[从服务 MMC 中强制删除服务](http://mstechnoblogger.blogspot.com/2009/04/deleting-services-forcefully-from.html)

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2010-11-11T16:05:13.557

我知道这不会有帮助，但它可能会在未来帮助某人。

我刚刚遇到了同样的问题，关闭并重新打开服务管理器从注册表中删除了两个条目并完成了服务的卸载。

在此之前，刷新服务经理并没有帮助。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-10-24T03:51:26.917

```
sc delete sericeName 
```

只需确保在执行此操作之前停止服务即可。我大部分时间都看过这部作品。有时我看到 Windows 卡在某些东西上并且它坚持要重新启动。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-19T00:41:37.177

这对我有用

```
$a = Get-WmiObject Win32_Service | Where-Object {$_.Name -eq 'psexesvc'}
$a.Delete() 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-02-12T09:45:48.440

如果打开，请关闭 cmd 和服务窗口，然后通过右键单击并选择以管理员身份运行再次启动 cmd。如果`sc delete serviceName`不起作用或任何事情都不起作用。

[http://weblogs.asp.net/avnerk/archive/2007/09/05/windows-services-services-msc-and-the-quot-this-service-is-marked-for-deletion-quot-error。 aspx](http://weblogs.asp.net/avnerk/archive/2007/09/05/windows-services-services-msc-and-the-quot-this-service-is-marked-for-deletion-quot-error.aspx)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-22T11:16:38.487

不幸的是，您需要重新启动服务器。那应该删除“已删除”的服务。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-03-25T13:29:46.560

以防万一这个答案对某人有帮助：如发现[here](https://stackoverflow.com/questions/330836/how-to-uninstall-a-windows-service-when-there-is-no-executable-for-it-left-on-th?rq=1) ，您可能会为自己以管理员身份运行[Sysinternals Autoruns](https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)省去很多麻烦。只需转到“服务”选项卡并删除您的服务。

它在我没有任何编辑注册表权限的机器上为我做了诀窍。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-11-15T21:44:38.447

您可以手动删除位于 的服务的注册表项`HKLM\SYSTEM\CurrentControlSet\Services`，之后您将不会在服务控制管理器中看到该服务（需要刷新或重新打开才能看到更改），并且您可以照常重新安装该服务。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-03-17T11:48:20.777

还值得注意的是：

```
sc delete "ServiceName" 
```

在 PowerShell 中不起作用，sc 是 PowerShell 中 cmdlet Set-Content 的别名。你需要做：

```
sc.exe delete "ServiceName" 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-09-07T11:50:42.730

这对我有用：

```
net stop "MyWindowsService"
taskkill /F /IM mmc.exe
sc delete "MyWindowsService" 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-03-28T05:59:05.247

以下将在不重新启动机器的情况下工作：

1.  在注册表 \HKEY_LOCAL_MACHINE 中搜索 <您的服务名称>（键和值）
2.  将“旧版”值设置为 0

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-24T03:30:25.150

您是否尝试在调用卸载之前停止服务？我随机遇到了这个问题。有时我可以在不重新启动的情况下将其删除。我的猜测是它与仍在运行的服务有关

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-02-24T09:25:36.023

我迟到了，但想添加一个替代方案，这可能看起来很奇怪，但我没有看到另一种方式：

当我每晚在 CI 进程中安装我的 Windows 服务时，我需要一些可以一直工作并且完全自动化的东西。出于某种原因，这些服务在卸载后总是被标记为删除很长一段时间（5 分钟或更长时间）。因此，我扩展了重装批处理脚本，以确保该服务真的被删除（简化版）：

```
REM Stop the service first
net stop My-Socket-Server

REM Same as installutil.exe, just implemented in the service
My.Socket.Server.exe /u

:loop1
    REM Easy way to wait for 5 seconds
    ping 192.0.2.2 -n 1 -w 5000 > nul
    sc delete My-Socket-Server
    echo %date% %time%: Trying to delete service.
    if errorlevel 1072 goto :loop1

REM Just for output purposes, typically I get that the service does not exist
sc query My-Socket-Server

REM Installing the new service, same as installutil.exe but in code
My.Socket.Server.exe /i

REM Start the new service
net start My-Socket-Server 
```

我可以看到，该服务被标记为删除大约 5 分钟（！），直到它最终通过。最后，我不需要任何手动干预。我将在未来扩展脚本，以便在特定时间后发生某些事情（例如 30 分钟后通知）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-10-17T07:02:21.990

如果您无法在服务中停止该服务**，您可以在****任务管理器**中停止您的 windows 服务 exe 。之后，您可以删除该服务。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-10-28T15:26:39.663

刷新服务列表总是对我有用。如果服务窗口是打开的，它会保存一些由于某种原因而存在的内存。F5，我又重新安装了！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-03-06T11:03:29.150

还要确保没有任何可执行文件的实例仍然处于活动状态（无论出于何种原因，可能独立于服务而运行的实例）。

我正在打开和关闭 MMC 并寻找要杀死的 PID - 但是在查看进程资源管理器时，有几个现存的进程从一个被遗忘的预定批处理中运行。杀了他们。任务完成。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-05-23T16:14:35.167

该主题有很多论坛问题。

我在 windows api 中找到了答案。卸载服务后无需重启电脑。您必须致电：

```
BOOL WINAPI CloseServiceHandle(
  SC_HANDLE hSCObject
); 
```

这将关闭服务的句柄。在 Windows 7 上，它解决了我的问题。我愿意：

*   停止服务
*   关闭手柄
*   卸载服务
*   等待 3 秒
*   将新的exe复制到目录
*   安装服务
*   启动服务
*   关闭手柄

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-02-10T00:31:07.883

当 TopShelf 出现问题或服务因其他原因失败时，我使用以下 PowerShell 从几个地方拼凑而成的 Octopus Deploy 实例。

```
$ServiceName = 'MyNaughtyService'
$ServiceName | Stop-Service -ErrorAction SilentlyContinue
# We tried nicely, now KILL!!!
$ServiceNamePID = Get-Service | Where { $_.Name -eq $ServiceName} # If it was hung($_.Status -eq 'StopPending' -or $_.Status -eq 'Stopping') -and
$ServicePID = (Get-WmiObject Win32_Service | Where {$_.Name -eq $ServiceNamePID.Name}).ProcessID
Stop-Process $ServicePID -Force 
```

# .net - 如何从非托管代码调用托管代码？

> ID：225277
> 
> 赞同：20
> 
> 时间：2008-10-22T11:09:34.430
> 
> 标签：.net, c++-cli, interop, clr, unmanaged

我想从非托管 C++ 调用我的 .NET 代码。我的进程入口点是基于 .NET 的，所以我不必担心托管 CLR。我知道它可以使用 .NET 对象的 COM 包装器来完成，但我想访问托管类的各个静态方法，所以 COM 不是我最短/最简单的路线。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2011-07-22T20:09:12.297

查看此解决方案： [https](https://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports) ://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports 该解决方案允许通过使用 [DllExport] 属性装饰您的函数（与 P/Invoke DllImport 相对）从 C 调用 C# 函数.

**示例：**

C# 代码

```
class Test
{
     [DllExport("add", CallingConvention = CallingConvention.StdCall)]
     public static int Add(int left, int right)
     {
         return left + right;
     } 
} 
```

C代码：

```
 extern "C" int add(int, int);

 int main()
 {
      int z = add(5,10);
      printf("The solution is found!!! Z is %i",z);
      return 0;
 } 
```

输出：

```
The solution is found!!! Z is 15 
```

**更新**：评论中有一个问题和一个很好的答案：

如何在非托管项目中包含 dll？

您必须链接到编译 C# 代码时生成的 .lib 文件（[https://msdn.microsoft.com/en-us/library/ba1z7822.aspx?f=255&MSPPError=-2147217396](https://msdn.microsoft.com/en-us/library/ba1z7822.aspx?f=255&MSPPError=-2147217396)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-22T11:44:32.503

看看[GCHandle](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.aspx)类和 gcroot 关键字，它提供了一个围绕 GCHandle 的类型安全、模板化的包装器。

您可以使用它们在本机代码中保存对 CLR 对象（或装箱值）的引用。

[MSDN这里](http://msdn.microsoft.com/en-us/library/481fa11f(VS.80).aspx)有一个基本教程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-22T11:27:16.657

假设您正在谈论真正的非托管代码 - 不仅仅是在使用 /clr 编译的混合模式程序集中运行的本机 C++ - 最简单的方法是在 C++/CLI 中为您的 .NET 代码创建一个包装器。然后，您可以通过使用 __declspec(dllexport) 标记它们来导出 C++/CLI 方法。

或者，如果您可以控制非托管代码的调用，则可以将函数指针编组到您的 .NET 方法并将它们传递给非托管代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-30T17:27:08.617

我相信您正在寻找反向 PInvoke。如果你用谷歌搜索反向 pinvoke，你会得到很多有用的条目。我认为以下有一个很好的快速而肮脏的例子。

[PInvoke-反向 PInvoke 和 __stdcall - __cdecl](http://blogs.msdn.com/thottams/archive/2007/06/02/pinvoke-reverse-pinvoke-and-stdcall-cdecl.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T12:04:31.743

您的调用代码是`/clr`启用的 C++。对？

如果是，那么您可以简单地使用 using 语句在代码中使用您的 .NET dll。就像是：

```
#using <Mydll.dll> 
```

然后您可以简单地制作托管类的对象，例如：

```
MyNameSpace::MyClass^ obj = new MyNameSpace::MyClass(); 
```

如果你想让这个 obj 成为你的类的数据成员，那么使用 gcroot 是要走的路。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-07T12:56:39.957

在集成到不同的解决方案后[，在 C++/CLI 的帮助下，在本机 C++ 中使用 C#，](https://pragmateek.com/using-c-from-native-c-with-the-help-of-ccli-v2/)还发现了这些变化：

附加的**IncludeDirectories** ...YahooAPIWrapper

附加**依赖**项...YahooAPIWrapper.lib

并且与这两个项目的关系，能够在最后一个 DLL 中通过线程打开 C# 表单并从本机 C++ 发送信息，只需要 ...APIWrapper.h 包括 - 应该做得更好，但可以工作;-)

```
public YahooAPI()
{
    new Thread(() =>
    {
        Thread.CurrentThread.IsBackground = true;
        ShowForm();
    }).Start();
}

private static Form1 form = null;
public static void ShowForm()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    form = new Form1();
    Application.Run(form);
}

public void SendValues(bool[] values)
{
    if (form != null && form.ready) ...
} 
```

*ready 是我在表单初始化完成时设置的 bool 成员*

# c++ - MFC C++ 应用程序的最佳 XML 序列化库

> ID：225283
> 
> 赞同：5
> 
> 时间：2008-10-22T11:11:41.930
> 
> 标签：c++, xml, mfc

我有一个应用程序，使用 MFC 和 Stingray 库用 C++ 编写。该应用程序适用于各种大型数据类型，这些数据类型目前都基于 MFC 文档/视图序列化派生功能进行序列化。我还添加了基于 Stingray 库的 XML 序列化选项，该库通过 Microsoft XML SDK 实现 DOM。虽然易于实现，但性能却很糟糕，以至于除了非常小的文档之外，它在任何东西上都无法使用。

对于这种情况，你们会推荐哪些其他 XML 序列化工具。我不想要 DOM，因为它似乎是一个内存猪，而且我已经在处理大量内存数据。理想情况下，我想要一个快速且易于与 MFC 一起使用的流解析器。我目前的领跑者是[expat](http://expat.sourceforge.net/)，它既快速又简单，但需要逐类添加大量序列化代码。人们会推荐任何其他有效且更易于实施的替代方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T13:40:14.327

[Boost 序列化](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)库支持 XML。该库主要包括：

1.  从MFC序列化的原理入手，把它提供的所有好东西都拿来。
2.  解决MFC序列化的每一个问题！

与 MFC 相比的改进之一是对 XML 的支持。请注意，您不一定要控制此序列化的 XML 模式。它使用自己的模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-13T17:20:44.150

这是一个古老的问题。在 1999 年和 2000 年期间，我是对世界上最大的软件项目具有最关键路径依赖关系的开发团队的团队负责人，而这个问题正是我在那段时间工作的重点。我确信轮子是由多个工程师发明的，他们不知道其他人已经发明了它。C++ 中的 XML 数据绑定也是如此。我也发明了它，10 多年来我一直在各种项目中完善它。我有一个解决方案可以解决此处提到的问题以及反复出现的一些其他问题：

1.  XML 更新。这是将 XML 的子集重新应用到现有对象模型中的能力。在许多情况下，XML 绑定到索引对象，我们无法为每次更新重新索引。

2.  COM 和 CORBA 接口管理。同样，XML 数据绑定可以通过面向对象的实践实现自动化——向应用程序层提供数据的接口对象的实例也可以实现自动化。

3.  状态跟踪。应用程序通常需要区分空值和缺失值——两者都创建一个空字符串。这提供了与数据绑定一起的验证。

源代码使用限制最少的许可证——更少的 GPL。该项目从这里得到支持和管理：

[http://www.codeproject.com/KB/XML/XMLFoundation.aspx](http://www.codeproject.com/KB/XML/XMLFoundation.aspx)

现在是 2010 年，我相信没有其他人会尝试重新发明轮子，因为有几个可供选择。恕我直言 - 这个轮子是可用的最抛光和最全面的实现。

享受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T11:35:18.650

一个好的解决方案是[libxml](http://xmlsoft.org/)。它为 XML 处理提供了轻量级的 SAX 解析和数据结构。有几个构建在 libxml 之上的 DOM 库。

不幸的是，它是一个 C 库，但可以使用 C++ 包装器。

几年前，由于您提到的性能问题，我从 MSXML 切换到了 libxml。

如果您决定使用 libxml，您还应该看看[libxslt](http://xmlsoft.org/XSLT/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T12:10:25.367

我们使用[Xerces-C++](http://xerces.apache.org/xerces-c/)。它很容易设置，性能也足够好，所以我们不需要考虑改变。然而，我们并不重 XML。

我确实收听了[Scott Hanselman 的播客](http://www.hanselminutes.com/default.aspx?showID=4)（来自[Hansel Minutes](http://www.hanselminutes.com/default.aspx)），他们在其中讨论了 MSXML 和 XSLT 的 XML 性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T13:17:34.873

[RapidXML](http://rapidxml.sourceforge.net/)怎么样，我在 MFC 应用程序中使用它，并进行了一些修改以支持带有 std::string 的 UTF-16。到目前为止，我对此非常满意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-30T02:17:56.120

gSOAP 工具包自动序列化本地 C 和 C++ 数据到 XML 或从 XML 序列化，并通过 XML 数据绑定支持完整的 XML 模式规范：

[gSOAP SourceForge 项目](http://sourceforge.net/projects/gsoap2)

自 1999 年以来，它已经发展成为具有代码生成工具和库的重要代码库。它支持许多数据绑定和自定义功能，这对于将 XML 模式类型映射到 C 和 C++ 类型/从 C 和 C++ 类型映射尤其重要。它可以序列化任何 C/C++ 类型以及 STL 容器、容器模板和循环数据结构。它已在 W3C 数据绑定模式模式工作组中使用（多年来，模式模式覆盖率达到 100%）。有一个活跃的开源用户群，gSOAP 开发功能已被许多工业项目和财富 100 强公司用于开发 SOAP/XML 基础设施。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-29T11:56:04.180

这是游戏的后期，我只想提一下我们也使用 LIBXML。它坚固可靠，并且运行良好。有点太低级了，您需要在其功能之上构建一些包装器。

例如，您将获得不同的函数返回序列，具体取决于您是否拥有：

```
<tag attribute="value"/> 
```

或这个：

```
<tag attribute="value"> </tag> 
```

有时你可能想要，有时你不在乎。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T19:48:55.550

我们使用 TinyXML 来满足我们所有的 XML 需求，无论是 MFC 还是直接的 C++。

[http://sourceforge.net/projects/tinyxml](http://sourceforge.net/projects/tinyxml)

# git - git-upload-pack：克隆远程 Git 存储库时找不到命令

> ID：225291
> 
> 赞同：175
> 
> 时间：2008-10-22T11:14:13.297
> 
> 标签：git, version-control, unix, ssh

我一直在使用 git 来同步我的项目的两个副本，一个是我的本地机器，另一个是测试服务器。这是我使用 ssh 登录远程开发服务器时出现的问题；

```
git clone me@me.mydevbox.com:/home/chris/myproject
Initialized empty Git repository in /tmp/myproject/.git/
Password:
bash: git-upload-pack: command not found
fatal: The remote end hung up unexpectedly
fetch-pack from 'me@me.mydevbox.com:/home/chris/myproject' failed. 
```

（文件名已更改以保护有罪...！）

两个盒子都运行 Solaris 10 AMD。我已经做了一些挖掘，如果我添加`--upload-pack=$(which git-upload-pack)`命令有效，（并根据 RTFM 解决方案证明它`$PATH`包含“git-upload-pack”的路径）但这真的很烦人，加上“git push”不起作用，因为我认为没有`--unpack=`选择。

顺便说一句，所有 git 命令在我的本地机器上都可以正常工作，它是相同版本的软件（1.5.4.2），安装在`/usr/local/bin`.

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2008-10-22T11:20:42.363

确保`git-upload-pack`位于非登录 shell 的路径上。（在我的机器上它位于`/usr/bin`）。

要从非登录 shell 查看您的路径在远程计算机上的样子，请尝试以下操作：

```
ssh you@remotemachine echo \$PATH 
```

（这适用于 Bash、Zsh 和 tcsh，可能也适用于其他 shell。）

`git-upload-pack`如果它`.bashrc`返回`.zshenv`的路径不包括具有`.cshrc`.

您将需要在远程计算机上进行此更改。

如果您不确定需要将哪个路径添加到您的 remote `PATH`，您可以使用以下命令找到它（您需要在远程机器上运行它）：

`which git-upload-pack`

在我打印的机器上`/usr/bin/git-upload-pack`。因此，在这种情况下，`/usr/bin`您需要确保的路径位于远程非登录 shell`PATH`中。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-10-29T23:50:58.860

您还可以使用“-u”选项来指定路径。我发现这对我的 .bashrc 没有在非交互式会话中获取来源的机器很有帮助。例如，

```
git clone -u /home/you/bin/git-upload-pack you@machine:code 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2011-06-27T16:15:22.170

基于[Brian 的回答](https://stackoverflow.com/questions/225291/git-upload-pack-command-not-found-how-to-fix-this-correctly/1647238#1647238)，可以通过在克隆后运行以下命令来永久设置上传包路径，这样就不需要`--upload-pack`后续的拉/取请求。同样，设置 receive-pack 消除了`--receive-pack`对推送请求的需要。

```
git config remote.origin.uploadpack /path/to/git-upload-pack
git config remote.origin.receivepack /path/to/git-receive-pack 
```

这两个命令相当于将以下行添加到 repo 的`.git/config`.

```
[remote "origin"]
    uploadpack = /path/to/git-upload-pack
    receivepack = /path/to/git-receive-pack 
```

的频繁用户`clone -u`可能对以下别名感兴趣。myclone 应该是不言自明的。myfetch/mypull/mypush 可用于配置未按上述修改的 repos 上，通过替换`git push`为`git mypush`，依此类推。

```
[alias]
    myclone = clone --upload-pack /path/to/git-upload-pack
    myfetch = fetch --upload-pack /path/to/git-upload-pack
    mypull  = pull --upload-pack /path/to/git-upload-pack
    mypush  = push --receive-pack /path/to/git-receive-pack 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-02-15T01:49:39.597

我找到并（成功地）使用了这个修复：

```
# Fix it with symlinks in /usr/bin
$ cd /usr/bin/
$ sudo ln -s /[path/to/git]/bin/git* . 
```

感谢[保罗约翰斯顿](http://marc.info/?l=git&m=122146743006470&w=2)。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-02-16T21:33:24.617

出于安全原因，Mac OS X 和其他一些 Unix 至少将用户路径编译到 sshd 中，因此我们这些将 git 安装为 /usr/local/git/{bin,lib,...} 的人可能会因为 git 而遇到麻烦可执行文件不在预编译路径中。要覆盖这一点，我更喜欢编辑我的 /etc/sshd_config 更改：

```
#PermitUserEnvironment no 
```

到

```
PermitUserEnvironment yes 
```

然后根据需要创建 ~/.ssh/environment 文件。我的 git 用户在他们的 ~/.ssh/environment 文件中有以下内容：

```
PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin 
```

注意读取 ~/.ssh/environment 文件时不会发生变量扩展，因此：

```
PATH=$PATH:/usr/local/git/bin 
```

不管用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-05T12:06:23.487

Matt 的解决方案在 OS X 上对我不起作用，但 Paul 的解决方案对我有用。

保罗链接的简短版本是：

`/usr/local/bin/ssh_session`使用以下文本创建：

```
#!/bin/bash
export SSH_SESSION=1
if [ -z "$SSH_ORIGINAL_COMMAND" ] ; then
    export SSH_LOGIN=1
    exec login -fp "$USER"
else
    export SSH_LOGIN=
    [ -r /etc/profile ] && source /etc/profile
    [ -r ~/.profile ] && source ~/.profile
    eval exec "$SSH_ORIGINAL_COMMAND"
fi 
```

执行：

> `chmod +x /usr/local/bin/ssh_session`

将以下内容添加到`/etc/sshd_config`：

> ForceCommand /usr/local/bin/ssh_session

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-21T17:20:53.557

对于 bash，它需要放入 .bashrc 而不是 .bash_profile （.bash_profile 也仅用于登录 shell）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-26T06:56:33.327

我在 MsysGit 版本中遇到了这些错误。

在遵循了我可以在这里和其他地方找到的所有建议之后，我最终得到了：

> 安装 Cygwin 版本的 Git

在服务器上（带有 Cygwin SSHD 的 Win XP），这终于修复了它。

我仍然使用 MsysGit 版本的客户端

> ..事实上，它对我有用的唯一方法，因为我从同一个 sshd 服务器中提取 Cygwin Git 时遇到 POSIX 错误

我怀疑在使用 Git 的这一方面仍然需要做一些工作.. （ssh+在 Windows 中易于拉/推）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-16T20:42:14.063

就像 Johan 多次指出的 .bashrc 一样：

ln -s .bash_profile .bashrc

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-09-26T17:05:55.000

您必须添加

```
export PATH=/opt/git/bin:$PATH 
```

在 .bashrc 中的这一行之前：

```
# If not running interactively, don't do anything
[ -z "$PS1" ] && return 
```

否则所有的导出语句都不会被执行（[见这里](https://stackoverflow.com/questions/940533/how-do-i-set-path-such-that-ssh-userhost-command-works/941995#941995)）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-08-30T17:48:55.360

我的案例是在带有 GIT bash 的 Win 10 上，而我在标准位置下没有 GIT。相反，我在 /app/local/bin 下有 git。我使用了@Garrett 提供的命令，但需要更改以双/开头的路径：

```
git config remote.origin.uploadpack //path/to/git-upload-pack
git config remote.origin.receivepack //path/to/git-receive-pack 
```

否则 GIT 会在前面添加你的 Windows GIT 路径。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-12T23:41:09.370

对于 zsh，你需要把它放在这个文件中：~/.zshenv

例如，在 OS X 上使用来自 MacPorts 的 git-core 包：

$ echo 'export PATH=/opt/local/sbin:/opt/local/bin:$PATH' > ~/.zshenv

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-31T05:03:26.980

我在使用 Windows 的 SSH 连接到 Gitolite 存储库时遇到问题，结果证明我的问题是 PLINK！它一直要求我输入密码，但 ssh gitolite@[host] 会很好地返回 repo 列表。

检查您的环境变量：GIT_SSH。如果它设置为 Plink，那么在没有任何值的情况下尝试它（“set GIT_SSH=”），看看它是否有效。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-30T14:17:35.470

将您的位置添加`git-upload-pack`到远程 git 用户的 .bashrc 文件中。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-06-11T22:42:14.927

它可能就像在远程主机上安装 git 一样简单（就像我的情况一样）。

```
sudo apt-get install git 
```

或其他包管理系统的等效项。

# sql-server - SQL Server 查询执行计划在使用的索引上显示错误的“实际行数”并且性能非常缓慢

> ID：225309
> 
> 赞同：5
> 
> 时间：2008-10-22T11:18:51.633
> 
> 标签：sql-server, performance, stored-procedures, optimization, sql-execution-plan

今天，我偶然发现了一个有趣的性能问题，即在 Sql Server 2005 SP2 上运行的存储过程在兼容级别为 80 (SQL2000) 的数据库中运行。

proc 运行大约 8 分钟，执行计划显示使用了一个实际行数为 1.339.241.423 的索引，这比表本身的“真实”实际行数 1.144.640 高大约 1000 倍，如正确显示通过估计的行数。所以查询计划优化器给出的实际行数肯定是错误的！

![替代文字](https://i.stack.imgur.com/kESKH.png)

有趣的是，当我将 proc 中的 procs 参数值复制到局部变量并在实际查询中使用局部变量时，一切正常 - proc 运行 18 秒，执行计划显示正确的实际行数。

**编辑：**正如 TrickyNixon 所建议的，这似乎是参数嗅探问题的标志。但实际上，我在这两种情况下都得到了完全相同的执行计划。相同的索引以相同的顺序使用。我看到的唯一区别是直接使用参数值时，PK_ED_Transitions 索引上的实际行数较高。

我已经完成了 dbcc dbreindex 和 UPDATE STATISTICS 没有任何成功。dbcc show_statistics 也显示了良好的索引数据。

proc 是用 RECOMPILE 创建的，因此每次运行时都会编译一个新的执行计划。

更具体地说 - 这个运行速度很快：

```
CREATE  Proc [dbo].[myProc](
@Param datetime
)
WITH RECOMPILE 
as

set nocount on

declare @local datetime
set @local = @Param

select 
some columns
from 
table1
where
column = @local
group by
some other columns 
```

这个版本运行速度非常慢，但产生完全相同的执行计划（除了已用索引上的实际行数过高）：

```
CREATE  Proc [dbo].[myProc](
@Param datetime
)
WITH RECOMPILE 
as

set nocount on

select 
some columns
from 
table1
where
column = @Param
group by
some other columns 
```

有任何想法吗？有谁知道 Sql Server 在计算查询计划时从哪里获得实际的行计数值？

**更新**：我在另一台服务器上尝试了查询，将 copat 模式设置为 90（Sql2005）。它的行为相同。我想我会打开一个 ms 支持电话，因为这在我看来就像一个错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T11:30:47.583

好的，最后我自己解决了。

这两个查询计划在我起初错过的一个小细节上有所不同。慢的使用嵌套循环运算符将两个子查询连接在一起。这会导致索引扫描运算符的当前行数很高，这只是将输入 a 的行数与输入 b 的行数相乘的结果。

我仍然不知道为什么优化器决定使用嵌套循环而不是在这种情况下运行 1000 计时器更快的哈希匹配，但我可以通过创建一个新索引来处理我的问题，以便引擎执行索引查找 statt而不是嵌套循环下的索引扫描。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:18:20.443

当您根据复制/粘贴查询检查存储过程的执行计划时，您使用的是估计计划还是实际计划？确保单击查询、包括执行计划，然后运行每个查询。比较这些计划，看看有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T12:25:40.343

这听起来像是参数嗅探的案例。这是一个很好的解释以及可能的解决方案： [我闻到一个参数！](http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx)

这是解决它的另一个 StackOverflow 线程： [SQL Server 中的参数嗅探（或欺骗）](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T11:38:50.627

对我来说，听起来好像统计数据不正确。重建索引不一定会更新它们。

您是否已经`UPDATE STATISTICS`为受影响的表尝试了显式？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T19:46:54.057

您是否运行**sp_spaceused**来检查 SQL Server 是否为该表提供了正确的摘要？我相信在 SQL 2000 中，引擎在构建执行计划时会使用这种元数据。我们过去必须每周运行**DBCC UPDATEUSAGE**来更新一些快速变化的表上的元数据，因为 SQL Server 由于不正确的行计数数据而选择了错误的索引。

您正在运行 SQL 2005，并且 BOL 说在 2005 中您应该不必再运行 UpdateUsage，但由于您处于 2000 兼容模式，您可能会发现它仍然是必需的。

# visual-studio - How to make a ComboBox column with two data sources (for DataGridView)

> ID：225317
> 
> 赞同：0
> 
> 时间：2008-10-22T11:21:28.320
> 
> 标签：visual-studio, winforms, datagridview, combobox

The data sources have the same structure, but different data. One would be used for rows that are saved (view mode), and the other one would be for rows that are being added or edited (edit/new rows). How can that be acomplished?

I have a standard foreign key column that references a standard lookup table which has an ID, Name and Active (bit). The combo box column uses that lookup table to show the list, but only active items. Let's say a lookup item is used and later deactivated (Active = 0). The combo box column now shows errors because the ID is not found in the list. Does anyone have any ideas how to solve it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-30T16:45:14.470

不知道你是否还在寻找，但我刚刚遇到了同样的问题。以上就是我的处理方式，希望对你有用。

定义一个函数，该函数返回具有适当数据源集的 DataGridViewComboCell（在别处定义的集合对象，请注意，我在此示例中使用 EntitySpaces 来填充 DataSource）：

```
Private Function GetStockComboDataSource(ByVal type As eStockComboType) As DataGridViewComboBoxCell
        Try
            Dim cell As New DataGridViewComboBoxCell
            Select Case type
                Case eStockComboType.StockIn

                    cell.DataSource = Me.StockInCol.Query.LoadDataTable
                    cell.DisplayMember = "FullName"
                    cell.ValueMember = JCStockInMetadata.ColumnNames.StockItemID

                Case eStockComboType.StockItem

                    cell.DataSource = StockItemCol.Query.LoadDataTable
                    cell.ValueMember = JCStockItemMetadata.ColumnNames.StockItemID
                    cell.DisplayMember = "FullName"
            End Select

            Return cell
End Function 
```

现在在设置组合数据源时（例如，我在这里使用 RowEnter 事件）：

```
 Private Sub dgvStock_RowEnter(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles dgvStock.RowEnter
        Try
            If IsNumeric(Me.dgvStock.Rows(e.RowIndex).Cells("ID").Value) Then
                Dim intValue As Integer = Convert.ToInt32(Me.dgvStock.Rows(e.RowIndex).Cells("Stock Item").Value)
                Me.dgvStock.Rows(e.RowIndex).Cells("Stock Item") = GetStockComboDataSource(eStockComboType.StockItem)
                Me.dgvStock.Rows(e.RowIndex).Cells("Stock Item").Value = intValue
            Else
                Me.dgvStock.Rows(e.RowIndex).Cells("Stock Item") = GetStockComboDataSource(eStockComboType.StockIn)

            End If
        Catch ex As Exception
            JCExceptionLogger.LogException(ex)
        End Try

End Sub 
```

在这里，我根据 ID 列是否为数字来切换组合 DataSource，但您可以实现所需的任何业务逻辑。请注意，我在设置组合（intValue）之前保存了单元格的值。这似乎是必要的，否则组合将显示为空白。

# php - WordPress Admin Plugin

> ID：225319
> 
> 赞同：4
> 
> 时间：2008-10-22T11:21:35.433
> 
> 标签：php, wordpress, plugins

I'm wondering how I can make a plugin to output some data via the admin panel. Just to get me going what code would make a page in the admin panel (for only administrators) to display time()?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-22T11:32:52.167

It's actually very easy, you only need two things:

1.  [One of many tutorials on writing a Wordpress plugin](http://ditio.net/2007/08/09/how-to-create-wordpress-plugin-from-a-scratch/). Plugins subscribe to actions (amongst other things) and can emit HTML when an action is triggered by the Wordpress engine.
2.  The [list on the Wordpress codex of actions to which plugins can subscribe](http://codex.wordpress.org/Plugin_API/Action_Reference) to trigger their own code. Adding actions is defined in that tutorial. Specifically you want the [administrative actions](http://codex.wordpress.org/Plugin_API/Action_Reference#Administrative_Actions). e.g.: the `admin_footer` action will cause your plugin's output to be displayed in the footer of the admin page. There's a wide range of actions for all kinds of situations and conditions.

The PHP `date()` function will give you the current time, so you just need to write a function in your plugin that does `echo date()`, and then use `add_action` to get your PHP function executed in response to the appropriate Wordpress action.

So to make it completely clear, your plugin code would look like this (not tested!):

```
/*
Plugin Name: Admin Date Displayer
Plugin URI: http://example.com/
Description: Displays the current datetime on the admin page
Author: Stewart
Version: 1.0
Author URI: http://bolidian.com/
*/

function display_date()
{
    echo date();
}

add_action('admin_footer', 'display_date'); 
```

# c# - 从库类中公开枚举

> ID：225323
> 
> 赞同：3
> 
> 时间：2008-10-22T11:21:59.223
> 
> 标签：c#, .net, oop, enums

在 C# 中，我使用的是定义枚举的库。我想允许我的代码的使用者（在不同的程序集中）将枚举值作为参数传递给我的一个函数，而不必自己引用底层库。

有没有办法让我向我的消费者公开图书馆的枚举？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T11:25:46.127

您可以使用要支持的值定义自己的枚举，将其公开给您的消费者，然后在调用它之前将其简单地转换为库的枚举。由于枚举只是幕后的数字，因此很容易将一个枚举的值转换为另一个枚举的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T11:27:25.890

您可以提供一个采用 int 的重载，描述哪些值是有效的，然后自己执行转换。或者，您可以在库中提供不同的枚举，然后在调用第二个库之前对其进行转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T11:28:46.340

我真的不知道，这样做的合理原因是什么（“消费者从我的程序集中的类型调用方法”和“消费者没有我的程序集作为参考”的组合），但有两种方法。

第一个（推荐）：您应该将程序集分成两部分。一个带有枚举类型定义，第二个带有函数。消费者只会引用“第一个”组件。

第二个（不推荐）：您可以在参数中使用 (sbyte/(u)short/(u)int/(u)long 代替枚举。

但我认为，您的对象模型设计不匹配。

# asp.net - 内联脚本在 ASP.Net 自定义控件中无法解析

> ID：225327
> 
> 赞同：2
> 
> 时间：2008-10-22T11:23:32.747
> 
> 标签：asp.net, validation, controls

目前我正在使用**自定义**正则表达式验证器*（不幸的是）*。

我正在尝试使用这样的服务器端内联脚本设置正则表达式模式：

```
ValidationExpression="<%= RegExStrings.SomePattern %>" 
```

但是，该脚本并未解析为服务器端代码。相反，它是按字面意思解释的，我最终在渲染的标记中得到了类似的东西：

```
ctl00_DefaultContent_regexValidatorInvitation.validationexpression = "<%= RegExStrings.SomePattern %>"; 
```

关于为什么这不能正确解决的任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T14:36:38.633

但这是为什么呢？我可以使用如下简单的 aspx 页面重现您的问题：

```
<%@ Page language="c#" AutoEventWireup="true" %>
<html>
  <body >
    <form id="Form1" method="post" runat="server" action="?<%=Request.QueryString%>">
                Query String value: <%=Request.QueryString %>
                <br />
                <input type=submit />
     </form>
  </body>
</html> 
```

提交表单后显示以下内容：

> 查询字符串值：%3c%25=Request.QueryString%25%3e

由于某种原因，当 runat="server" 存在时，内联代码不会执行。奇怪的是，我有 3 台机器不这样做，而另一台机器则这样做，所以我只能假设这是一个 IIS/.NET 配置问题，可能是由最近的 MS 更新引起的。我最近在表现出这种行为的机器上安装的软件是：Visual Studio 2008 WSE 3.0 IE8 RC1

我想知道这些是否导致了这种情况？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T10:00:37.093

这现在已经清除了我的MS。我发现的问题是由于服务器表单中的“action”属性在 .NET 2 SP2 之前没有效果，但现在可以设置。代码渲染块从来没有在属性值中工作过——这在本文末尾进行了解释。

这是 Microsoft .NET Framework 3.5 SP1 中引入的故意更改行为的结果。在服务包之前，不能覆盖服务器端 FORM 标记上的操作和方法属性。如果指定，它们将被 ASP.NET 替换为“POST”和“页面名称”。

以前，ASP.NET 页面解析器并没有阻止指定这些属性，尽管文档建议不要将其用于操作属性：http: [//msdn.microsoft.com/en-us/library/k33801s3.aspx](http://msdn.microsoft.com/en-us/library/k33801s3.aspx)

特别是注释（在 FORM 元素的上下文中）：

• “开始标记不得包含操作属性。ASP.NET 在处理页面时动态设置这些属性，覆盖您可能进行的任何设置。”

最初由 Josh 报告的问题，其中代码块没有被解释不是新行为，而是一个已知的错误 - 代码渲染块不能在服务器控制属性中使用。这被报告为“连接”错误： [http](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=109257) ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=109257 其中包含以下内容：“服务器控件的属性不能将内联表达式作为值。这解释了如下所示的意外行为：“ <link href="<%=RootPath %> ..." 但是，内联代码可用于属性值。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T15:24:54.247

devstuff，这并不能解释为什么这可以在我的 3 台机器上运行，但不能在第 4 台机器上运行，是吗？他们都使用相同的 .NET Framework 版本和 IIS 设置（我相信，我已经检查了尽可能多的）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T12:23:59.567

我在调查此问题时卸载了 .NET 框架（3.5 然后 3.0 和 2.0） - 然后在安装以下各项后我没有问题： .net framework 2.0 .net framework 2.0 SP1 .net framework 3.0 .net framework 3.0 SP1 。网络框架 3.5

但是在我安装了 .net framework 3.5 SP1 之后，行为又返回了——我想这就是问题所在。我已向 Microsoft 提出此问题，并会在收到回复时更新此线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T11:28:06.997

Web 控件中的值不会呈现服务器端代码。而是从后面的代码中设置

```
RegExValidator1.ValidationExpression = RegExStrings.SomePattern; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T11:30:29.130

它被视为文字字符串，请尝试

ValidationExpression='<%= RegExStrings.SomePattern %>'

编辑：以上不起作用，我试图看看如何做到这一点但没有成功，我通常在代码隐藏中设置属性，并且只在必须时使用这种语法进行数据绑定。我很想知道它是否也可以完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T13:02:39.800

如果您的正则表达式验证器具有 runat="server" 属性，则从后面的代码中更改它。这会容易得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T15:03:30.233

您在未绑定数据的控件上使用数据绑定表达式。您需要调用 DataBind()，或使用 ExpressionBuilder 实现。可以在[http://weblogs.asp.net/infinitiesloop/archive/2006/08/09/The-CodeExpressionBuilder.aspx找到一个用于绑定到任意代码的简单 ExpressionBuilder](http://weblogs.asp.net/infinitiesloop/archive/2006/08/09/The-CodeExpressionBuilder.aspx)

# .net - 如何为反射操作加载 .NET 程序集并随后将其卸载？

> ID：225330
> 
> 赞同：40
> 
> 时间：2008-10-22T11:24:45.583
> 
> 标签：.net, assemblies, appdomain, assembly-attributes

我正在编写一个工具来报告有关在我的客户系统中跨环境和区域部署的 .NET 应用程序的信息。

我想读取这些程序集中的程序集属性值。

这可以使用 来实现`Assembly.ReflectionOnlyLoad`，但是即使这种方法也会使程序集保持加载。这里的问题是我不能从不同的路径加载两个同名的程序集，所以自然不能比较部署在不同系统中的同一个应用程序。

在这一点上，我假设解决方案将涉及使用临时`AppDomain`s。

有人可以详细说明如何将一个程序集加载到另一个程序集中`AppDomain`，从中读取属性然后卸载`AppDomain`吗？

这需要适用于文件系统上的程序集以及 URL 地址上的程序集。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-22T11:30:39.283

从[System.Reflection.Assembly.ReflectionOnlyLoad (String) 的 MSDN 文档中](http://msdn.microsoft.com/en-us/library/0et80c7k.aspx)：

> 仅反射上下文与其他上下文没有什么不同。加载到上下文中的程序集只能通过卸载应用程序域来卸载。

因此，恐怕卸载程序集的唯一方法是卸载应用程序域。要创建一个新的 AppDomain 并将程序集加载到其中：

```
public void TempLoadAssembly()
{
    AppDomain tempDomain = AppDomain.CreateDomain("TemporaryAppDomain");
    tempDomain.DoCallBack(LoaderCallback);
    AppDomain.Unload(tempDomain);
}

private void LoaderCallback()
{
    Assembly.ReflectionOnlyLoad("YourAssembly");
    // Do your stuff here
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T09:19:00.510

虽然不是真正关于卸载程序集，但如果您只是想获取可以使用的文件的版本号`System.Diagnostics.FileVersionInfo`。

```
var info = FileVersionInfo.GetVersionInfo(path); 
```

`FileVersionInfo`具有以下属性：

```
public string Comments { get; }
public string CompanyName { get; }
public int FileBuildPart { get; }
public string FileDescription { get; }
public int FileMajorPart { get; }
public int FileMinorPart { get; }
public string FileName { get; }
public int FilePrivatePart { get; }
public string FileVersion { get; }
public string InternalName { get; }
public bool IsDebug { get; }
public bool IsPatched { get; }
public bool IsPreRelease { get; }
public bool IsPrivateBuild { get; }
public bool IsSpecialBuild { get; }
public string Language { get; }
public string LegalCopyright { get; }
public string LegalTrademarks { get; }
public string OriginalFilename { get; }
public string PrivateBuild { get; }
public int ProductBuildPart { get; }
public int ProductMajorPart { get; }
public int ProductMinorPart { get; }
public string ProductName { get; }
public int ProductPrivatePart { get; }
public string ProductVersion { get; }
public string SpecialBuild { get; } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-06-22T13:48:15.180

您可以在新的 AppDomain 中创建一个实例并在该实例中执行您的代码。

```
var settings = new AppDomainSetup
{
    ApplicationBase = AppDomain.CurrentDomain.BaseDirectory,
};
var childDomain = AppDomain.CreateDomain(Guid.NewGuid().ToString(), null, settings);

 var handle = Activator.CreateInstance(childDomain,
            typeof(ReferenceLoader).Assembly.FullName,
            typeof(ReferenceLoader).FullName,
            false, BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance, null, null, CultureInfo.CurrentCulture, new object[0]);

var loader = (ReferenceLoader)handle.Unwrap();

//This operation is executed in the new AppDomain
var paths = loader.LoadReferences(assemblyPath);

AppDomain.Unload(childDomain); 
```

这是参考加载器

```
public class ReferenceLoader : MarshalByRefObject
{
    public string[] LoadReferences(string assemblyPath)
    {
        var assembly = Assembly.ReflectionOnlyLoadFrom(assemblyPath);
        var paths = assembly.GetReferencedAssemblies().Select(x => x.FullName).ToArray();
        return paths;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-22T11:33:20.777

您可以尝试使用[非托管元数据 API](http://msdn.microsoft.com/en-us/library/ms404434.aspx)，它是 COM，可以通过某种包装器轻松地从 .NET 应用程序中使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T11:36:24.093

您必须使用应用程序域，没有其他方法可以卸载程序集。基本上你必须使用这样的代码：

```
AppDomain tempDomain = AppDomain.CreateDomain("Temp Domain");
tempDomain.Load（程序集）；
AppDomain.Unload(tempDomain);

```

# java - 如何使用任何空白字符作为分隔符拆分字符串

> ID：225337
> 
> 赞同：573
> 
> 时间：2008-10-22T11:27:17.107
> 
> 标签：java, string, whitespace, split

我需要传递什么正则表达式模式才能 使用所有空白字符（ 、、、等）作为分隔符`java.lang.String.split()` 将字符串拆分为子字符串数组？`' '``'\t'``'\n'`

* * *

## 回答 #1

> 赞同：982
> 
> 时间：2008-10-22T11:31:11.640

有点像

```
myString.split("\\s+"); 
```

这会将所有空格分组为分隔符。

所以如果我有字符串：

```
"Hello[space character][tab character]World" 
```

这应该产生字符串`"Hello"`，并省略和`"World"`之间的空格。`[space]``[tab]`

正如 VonC 指出的那样，应该转义反斜杠，因为 Java 会首先尝试将字符串转义为特殊字符，然后将其发送*以*进行解析。您想要的是文字`"\s"`，这意味着您需要通过`"\\s"`. 它可能会有点混乱。

`\\s`相当于`[ \\t\\n\\x0B\\f\\r]`。_

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-10-22T11:30:37.430

在大多数正则表达式方言中，有一组方便的字符摘要可用于此类事情 - 这些是要记住的好词：

`\w`- 匹配任何单词字符。

`\W`- 匹配任何非单词字符。

`\s`- 匹配任何空白字符。

`\S`- 匹配除空白字符以外的任何内容。

`\d`- 匹配任何数字。

`\D`- 匹配除数字以外的任何内容。

搜索“Regex Cheatsheets”应该会给你很多有用的总结。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2012-03-01T22:18:11.040

为了让它**在 Javascript**中工作，我必须执行以下操作：

```
myString.split(/\s+/g) 
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-10-22T11:29:25.247

"\\s+" 应该可以解决问题

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-09-09T03:29:23.780

此外，您可能有一个 UniCode 不间断空格 xA0...

```
String[] elements = s.split("[\\s\\xA0]+"); //include uniCode non-breaking 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-03-31T18:14:14.643

```
String string = "Ram is going to school";
String[] arrayOfString = string.split("\\s+"); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-12-01T17:10:18.083

Apache Commons Lang 有一种方法可以使用空格字符作为分隔符来拆分字符串：

```
StringUtils.split("abc def") 
```

[http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#split(java.lang.String)](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#split(java.lang.String))

这可能比正则表达式模式更容易使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-02-14T09:01:22.270

因为它是一个正则表达式，我假设你也不想要逗号、点等可能被空格包围的非字母数字字符（例如，“一，二”应该给出 [一] [二]），它应该是：

```
myString.split(/[\s\W]+/) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-01-21T21:35:19.120

**您只需要**使用 Java Ragex Engine 的特殊字符之一进行拆分，

那就是-**空白字符**

*   **\d** 代表一个数字：`[0-9]`
*   **\D** 代表一个非数字：`[^0-9]`
*   **\s** 代表一个**空白字符**，包括`[ \t\n\x0B\f\r]`
*   **\S** 将非空白字符表示为`[^\s]`
*   **\v** 将垂直空白字符表示为`[\n\x0B\f\r\x85\u2028\u2029]`
*   **\V** 将非垂直空白字符表示为`[^\v]`
*   **\w** 表示一个单词字符为`[a-zA-Z_0-9]`
*   **\W** 将非单词字符表示为`[^\w]`

**在这里，要记住**的关键点**`\s`是小字母字符代表所有类型的空格，包括单个空格`[ ]`、制表符`[ ]`或任何类似的字符。**

 **所以，如果你会尝试这样的事情 -

```
String theString = "Java<a space><a tab>Programming"
String []allParts = theString.split("\\s+"); 
```

您将获得所需的输出。

* * *

**一些非常有用的链接：**

*   [Split() 方法最佳示例](https://shubhamklogic.com/how-to-use-split-in-java-a-modern-guide/)
*   [正则表达式](https://regexr.com/)
*   [拆分-Java 11](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html#split)
*   [正则表达式信息](https://www.regular-expressions.info/)
*   [模式类](https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html)

* * *

**希望，这可能对你有最大的帮助！！！**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-09-01T13:40:50.347

您可以使用以下语句按换行符拆分字符串：

```
 String textStr[] = yourString.split("\\r?\\n"); 
```

您可以使用以下语句按空格分割字符串：

```
String textStr[] = yourString.split("\\s+"); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-04-12T04:04:41.493

```
String str = "Hello   World";
String res[] = str.split("\\s+"); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-16T20:09:32.630

***要使用任何 Unicode 空格***分割字符串，您需要使用

```
s.split("(?U)\\s+")
         ^^^^ 
```

内`(?U)`联嵌入标志选项等效于[`Pattern.UNICODE_CHARACTER_CLASS`](https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html#UNICODE_CHARACTER_CLASS)使`\s`速记字符类能够匹配空白 Unicode 类别中的任何字符。

如果您想用空格分割并将空格**保留在结果数组**中，请使用

```
s.split("(?U)(?<=\\s)(?=\\S)|(?<=\\S)(?=\\s)") 
```

请参阅[正则表达式演示](https://regex101.com/r/I2yoEt/2)。请参阅[Java 演示](https://ideone.com/d2ZflI)：

```
String s = "Hello\t World\u00A0»";
System.out.println(Arrays.toString(s.split("(?U)\\s+"))); // => [Hello, World, »]
System.out.println(Arrays.toString(s.split("(?U)(?<=\\s)(?=\\S)|(?<=\\S)(?=\\s)")));
// => [Hello,    , World,  , »] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-09T07:11:43.860

当您只想按空格而不是制表符拆分时，例如，您可以使用：

```
String[] words = textline.split(" "); 
```

## 例子

textline: "忽略第一个单词中的制表符"

> words: [igno\tre, the, tab, in, the, first, word]

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-10-24T14:08:00.437

研究这段代码..祝你好运

```
 import java.util.*;
class Demo{
    public static void main(String args[]){
        Scanner input = new Scanner(System.in);
        System.out.print("Input String : ");
        String s1 = input.nextLine();   
        String[] tokens = s1.split("[\\s\\xA0]+");      
        System.out.println(tokens.length);      
        for(String s : tokens){
            System.out.println(s);

        } 
    }
} 
```

# algorithm - Scheduled Report(task) Monitor

> ID：225357
> 
> 赞同：0
> 
> 时间：2008-10-22T11:30:58.987
> 
> 标签：algorithm, language-agnostic, database-design, scheduling, task

I have to develop a system to **monitor** the **generation/transmission** of reports.

*   System data will be stored in database tables (Sybase)
*   Reports will be generated with different schedules ("mon-fri 10pm", "sat 5am", "1st day of the month", etc.)
*   System will just monitor that the reports were created. It will not create the reports itself.
*   System will notify appropriate personnel when a report did not finish.
*   System will maintain a log of all generated reports

Anyone know of a good(tried and proven) table(s) design for storing the task shedules?. I already have an idea, but I don't want reinvent the wheel.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T22:48:14.693

如果您真的要支持所有这些类型的复杂计划，我不确定尝试为这些计划的所有**细节**发明一个同样复杂的关系数据库模式是一个好主意。

我会考虑为时间表的详细信息设计一个 XML 模式，如果您确实需要将时间表存储在关系数据库中，请将 XML 数据存储在一个列中。您可以将列用于那些适用于任何类型的日程表的日程表属性（如日程表名称或上次修改时间和时间的人）。

例如，假设一个时间表可用于多个报告，您可以执行以下操作：

```
Table: Schedule
---------------
Columns:
    ID                  - Surrogate key to refer to schedules
                          from other tables.

    Name                - Short textual description of the schedule
                          (to be shown in GUI).

    ...

    Details             - XML containing all the details of
                          the schedule (frequency, exceptions,
                          complex combinations of simple schedules, 
                          whatsoever). 
```

即使您的应用程序必须回答诸如“在给定日期/时间之前应该提交哪些报告”之类的问题，我认为您必须有非常非常多的计划来证明使用关系模式存储细节的开销是合理的将详细信息安排在单独的列中（并且可能在多个表中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T20:42:56.490

您可以使用列创建表**计划**

*   ID
*   姓名
*   周一, 周二, 周三, 周四, 周五, 周六, 太阳
*   天
*   月
*   年
*   时间 (h*60+m)

你的例子是：

**周一至周五晚上 10 点**

```
mon, tue, wed, thu, fri = true, time=22*60, the rest are NULL 
```

**早上 5 点坐**

```
sat=true, time=5*60, the rest are NULL 
```

**每月的第一天**

```
day=1, the rest are NULL 
```

您还可以有一个包含列的表格**报告**

*   ID
*   姓名
*   schedule_id

和一个表**report__schedule___late**与列：

*   ID
*   约会时间
*   报告ID

# c++ - 在 C++ 中将数字转换为具有指定长度的字符串

> ID：225362
> 
> 赞同：53
> 
> 时间：2008-10-22T11:31:23.870
> 
> 标签：c++, integer, stdstring

我有一些不同长度的数字（如 1、999、76492 等），我想将它们全部转换为具有共同长度的字符串（例如，如果长度为 6，那么这些字符串将为：'000001' ，“000999”，“076492”）。

换句话说，我需要在数字中添加正确数量的前导零。

```
int n = 999;
string str = some_function(n,6);
//str = '000999' 
```

C++中有这样的函数吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-10-22T11:49:35.423

或使用字符串流：

```
#include <sstream>
#include <iomanip>

std::stringstream ss;
ss << std::setw(10) << std::setfill('0') << i;
std::string s = ss.str(); 
```

我编译了我在[arachnoid.com](http://www.arachnoid.com/cpptutor/student3.html)上找到的信息，因为我更喜欢 iostreams 的类型安全方式。此外，您同样可以在任何其他输出流上使用此代码。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-22T11:36:58.337

```
char str[7];
snprintf (str, 7, "%06d", n); 
```

见[snprintf](http://libslack.org/manpages/snprintf.3.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-22T17:08:08.137

**您可能**需要注意的一件事是当您使用该`stringstream`方法时可能发生的潜在锁定。至少在 Visual Studio 2008 附带的 STL 中，由于在格式化过程中使用了各种语言环境信息，因此有许多锁被取出和释放。这可能对您来说是一个问题，也可能不是一个问题，具体取决于您有多少线程可能同时将数字转换为字符串......

该`sprintf`版本不使用任何锁（至少根据我目前正在开发的锁监控工具......），因此在并发情况下使用可能“更好”。

我之所以注意到这一点，是因为我的工具最近吐出了“语言环境”锁，因为它是我的服务器系统中竞争最激烈的锁之一；这有点出人意料，可能会让我修改我一直在采取的方法（即`sprintf`从移回`stringstream`）......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-22T11:33:38.967

有很多方法可以做到这一点。最简单的是：

```
int n = 999;
char buffer[256]; sprintf(buffer, "%06d", n);
string str(buffer); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T12:25:18.830

此方法不使用流或 sprintf。除了存在锁定问题之外，流还会产生性能开销，而且实际上是一种矫枉过正。对于流，开销来自于构建流和流缓冲区的需要。对于 sprintf，开销来自需要解释格式字符串。即使*n*为负数或 n 的字符串表示形式*比*len 长，*这*也有效。这是最快的解决方案。

```
inline string some_function(int n, int len)
{
    string result(len--, '0');
    for (int val=(n<0)?-n:n; len>=0&&val!=0; --len,val/=10)
       result[len]='0'+val%10;
    if (len>=0&&n<0) result[0]='-';
    return result;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-22T11:55:35.367

stringstream 会做（[正如 xtofl 指出的那样](https://stackoverflow.com/questions/225362/convert-a-number-to-a-string-with-specified-length-in-c#225435)）。[Boost 格式](http://www.boost.org/doc/libs/1_36_0/libs/format/doc/format.html#printf_directives)是 snprintf 的更方便的替代品。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-12T14:16:50.300

这是一个旧线程，但由于[fmt](http://fmtlib.net/latest/index.html)可能使其成为标准，这里有一个额外的解决方案：

```
#include <fmt/format.h>

int n = 999;

const auto str = fmt::format("{:0>{}}", n, 6); 
```

请注意，`fmt::format("{:0>6}", n)`当在编译时已知所需的宽度时，效果同样好。另一种选择是[abseil](https://abseil.io)：

```
#include <absl/strings/str_format.h>

int n = 999;

const auto str = absl::StrFormat("%0*d", 6, n); 
```

再次，`abs::StrFormat("%06d", n)`是可能的。[boost 格式](https://www.boost.org/doc/libs/1_67_0/libs/format/)是解决这个问题的另一个工具：

```
#include <boost/format.hpp>

int n = 999;

const auto str = boost::str(boost::format("%06d") % n); 
```

Unfortunately, variable width specifier as arguments chained with the `%` operator are unsupported, this requires a format string setup (e.g. `const std::string fmt = "%0" + std::to_string(6) + "d";`).

In terms of performance, abseil and fmt claim to be very attractive and faster than boost. In any case, all three solutions should be more efficient than `std::stringstream` approaches, and other than the `std::*printf` family, they do not sacrifice type safety.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T11:33:58.997

sprintf 是类似 C 的方式，它也适用于 C++。

在 C++ 中，字符串流和流输出格式的组合（请参阅[http://www.arachnoid.com/cpptutor/student3.html](http://www.arachnoid.com/cpptutor/student3.html)）将完成这项工作。

# javascript - 那里有什么好的 JavaScript 哈希（代码/表）实现吗？

> ID：225367
> 
> 赞同：6
> 
> 时间：2008-10-22T11:32:30.310
> 
> 标签：javascript, hash

是的，我知道您可以在 JavaScript 中使用常规对象作为关联数组，但我想使用更接近 java 的 Map 实现的东西（HashMap、LinkedHashMap 等）。可以将任何类型的数据用作密钥的东西。JavaScript 实现中有没有好的哈希（代码/表）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-22T11:39:26.007

在 javascript 中，**对象实际上是一个哈希实现**。Java HashMap 会有点假，所以我会**挑战你**重新考虑你的需求。

直接的**答案是否定**的，我不相信在 javascript 中有很好的 Java HashMap 实现。如果有，它一定是您可能想使用或不想使用的库的一部分，而且您当然**不需要**仅仅为了拥有一个小哈希表而包含一个库。

所以让我们继续写一个，只是为了**检查这个问题**。如果你喜欢，你可以使用它。我们将从编写一个构造函数开始，我们将捎带 Array，它是 Object，但有一些有用的方法可以避免这个例子变得过于乏味：

```
function HashMap () {
    var obj = [];
    return obj;
}

var myHashMap = HashMap(); 
```

我们将添加一些直接来自 Java 世界的方法，但在我们进行的过程中将其转换为 javascript...

```
function HashMap() {
    var obj = [];
    obj.size = function () {
        return this.length;
    };
    obj.isEmpty = function () {
        return this.length === 0;
    };
    obj.containsKey = function (key) {
        for (var i = 0; i < this.length; i++) {
            if (this[i].key === key) {
                return i;
            }
        }
        return -1;
    };
    obj.get = function (key) {
        var index = this.containsKey(key);
        if (index > -1) {
            return this[index].value;
        }
    };
    obj.put = function (key, value) {
        if (this.containsKey(key) !== -1) {
            return this.get(key);
        }
        this.push({'key': key, 'value': value});
    };
    obj.clear = function () {
        this = null;  // Just kidding...
    };
    return obj;
} 
```

我们可以继续构建它，但我认为这是错误的方法。归根结底，我们最终使用了 javascript 在幕后提供的功能，因为我们只是没有 HashMap 类型。在**伪装**的过程中，它适合做各种**额外的工作**。

具有讽刺意味的是，使 javascript 成为一种如此有趣和多样化的语言的原因之一是它可以轻松地处理这种**摔跤**。从字面上看，我们可以做任何我们想做的事情，如果没有说明语言的欺骗性力量，这里的快速示例将无济于事。然而，鉴于这种力量，似乎**最好不要使用它**。

我只是认为javascript想要更轻。我个人的建议是在尝试实现正确的 Java HashMap 之前重新检查问题。 **Javascript 既不想也买不起**。

**记住原生替代品**：

```
var map = [{}, 'string', 4, {}]; 
```

..相比之下如此快速和容易。

另一方面，我不相信这里有任何硬性的答案。这种实现确实**可能是一个完全可以接受的解决方案**。如果你觉得你可以使用它，我会说**试一试**。但是，如果我觉得我们有**相当简单和更自然的方法**可供我们使用，我永远不会使用它。我几乎可以肯定我们这样做了。

**旁注：** 效率与风格有关吗？请注意**性能**下降.. HashMap.put() 有一个大 O 盯着我们的脸...不太理想的性能可能不是这里的阻碍，你可能需要做一些非常雄心勃勃的东西或拥有大量数据，您甚至都不会注意到现代浏览器的性能提升。有趣的是，当您逆向工作时，操作的效率往往会降低，就好像有一个自然熵在起作用。Javascript 是一种高级语言，当我们遵守它的约定时应该提供有效的解决方案，就像 Java 中的 HashMap 将是一个更自然和高性能的选择一样。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T13:37:02.733

我发布了一个独立的 JavaScript 哈希表实现，它比这里列出的更进一步。

[http://www.timdown.co.uk/jshashtable/](http://www.timdown.co.uk/jshashtable/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T14:16:47.903

请注意，使用“任何类型的对象”作为键的 java 集合并不完全正确。是的，您可以使用任何对象，但除非该对象具有良好的 hashcode() 和 equals() 实现，否则它将无法正常工作。基 Object 类具有这些的默认实现，但是要使自定义类（有效地）作为哈希表键工作，您需要覆盖它们。Javascript 没有等价物（据我所知）。

要在 javascript 中创建一个可以（有效地）使用任意对象作为键的哈希表，您需要对您使用的对象强制执行类似的操作，至少如果您想保持哈希表的性能增益。如果您可以强制执行返回字符串的“hashcode()”方法，那么您可以只使用引擎盖下的对象作为实际的哈希表。

否则，您需要像发布的其他解决方案一样，到目前为止，这些解决方案的性能不像哈希表。他们都对列表进行 O(n) 搜索以尝试找到密钥，这几乎违背了哈希表的目的（哈希表通常是获取/放置的恒定时间）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T12:46:20.630

这是我刚刚放在一起的一个天真的实现 - 正如评论中提到的keparo，其中一个大问题是平等检查：

```
var ObjectMap = function()
{
    this._keys = [];
    this._values = [];
};

ObjectMap.prototype.clear = function()
{
    this._keys = [];
    this._values = [];
};

ObjectMap.prototype.get = function(key)
{
    var index = this._indexOf(key, this._keys);
    if (index != -1)
    {
        return this._values[index];
    }
    return undefined;
};

ObjectMap.prototype.hasKey = function(key)
{
    return (this._indexOf(key, this._keys) != -1);
};

ObjectMap.prototype.hasValue = function(value)
{
    return (this._indexOf(value, this._values) != -1);
};

ObjectMap.prototype.put = function(key, value)
{
    var index = this._indexOf(key, this._keys);
    if (index == -1)
    {
        index = this._keys.length;
    }

    this._keys[index] = key;
    this._values[index] = value;
};

ObjectMap.prototype.remove = function(key)
{
    var index = this._indexOf(key, this._keys);
    if (index != -1)
    {
        this._keys.splice(index, 1);
        this._values.splice(index, 1);
    }
};

ObjectMap.prototype.size = function()
{
    return this._keys.length;
};

ObjectMap.prototype._indexOf = function(item, list)
{
    for (var i = 0, l = list.length; i < l; i++)
    {
        if (this._equals(list[i], item))
        {
            return i;
        }
    }
    return -1;
};

ObjectMap.prototype._equals = function(a, b)
{
    if (a === b)
    {
        return true;
    }

    // Custom objects can implement an equals method
    if (typeof a.equals == "function" &&
        typeof b.equals == "function")
    {
        return a.equals(b);
    }

    // Arrays are equal if they're the same length and their contents are equal
    if (a instanceof Array && b instanceof Array)
    {
        if (a.length != b.length)
        {
            return false;
        }

        for (var i = 0, l = a.length; i < l; i++)
        {
            if (!this._equals(a[i], b[i]))
            {
                return false;
            }
        }

        return true;
    }

    // Checking object properties - objects are equal if they have all the same
    // properties and they're all equal.
    var seenProperties = {};
    for (var prop in a)
    {
        if (a.hasOwnProperty(prop))
        {
            if (!b.hasOwnProperty(prop))
            {
                return false;
            }

            if (!this._equals(a[prop], b[prop]))
            {
                return false;
            }

            seenProperties[prop] = true;
        }
    }

    for (var prop in b)
    {
        if (!(prop in seenProperties) && b.hasOwnProperty(prop))
        {
            if (!a.hasOwnProperty(prop))
            {
                return false;
            }

            if (!this._equals(b[prop], a[prop]))
            {
                return false;
            }
        }
    }

    return true;
}; 
```

示例用法：

```
>>> var map = new ObjectMap();
>>> var o = {a: 1, b: [1,2], c: true};
>>> map.put(o, "buns");
>>> map.get(o)
"buns"
>>> map.get({a: 1, b: [1,2], c: true});
"buns"
>>> map.get({a: 1, b: [1,2], c: true, d:"hi"});
>>> var a = [1,2,3];
>>> map.put(a, "cheese");
>>> map.get(a);
"cheese"
>>> map.get([1,2,3]);
"cheese"
>>> map.get([1,2,3,4]);
>>> var d = new Date();
>>> map.put(d, "toast");
>>> map.get(d);
"toast"
>>> map.get(new Date(d.valueOf()));
"toast" 
```

这绝不是一个完整的实现，只是一个实现此类对象的方法的指针。例如，查看我给出的内容，您还需要在对象属性检查之前添加构造函数属性检查，因为这目前有效：

```
>>> function TestObject(a) { this.a = a; };
>>> var t = new TestObject("sandwich");
>>> map.put(t, "butter");
>>> map.get({a: "sandwich"})
"butter" 
```

# windows - 在 XP 上，同步文件和文件夹的最佳方式

> ID：225370
> 
> 赞同：6
> 
> 时间：2008-10-22T11:33:24.413
> 
> 标签：windows, synchronization, backup, file-organization

我正在使用 SyncToy 1.4，它可以满足我的需要，除了：

*   它无法处理系统之间分配的驱动器号更改（例如同步 USB 驱动器），
*   它将自己的（隐藏的）文件留在正在同步的文件夹中（这是 OS/FS 的限制吗？），
*   它为已删除的文件夹重新创建空文件夹，
*   它会同步已从同步中取消选择的文件夹中的新子文件夹
*   有时会发现所有文件都已更改，而它们仍然与原来相同。
*   它无法处理很长的文件路径/名称

SyncToy 2.1 太慢而无法使用。特别是在没有任何更改的文件夹上再次运行时，它将从头开始扫描所有文件和子文件夹以查找差异。

它必须是一个不使用基于 Internet 的存储的解决方案，因为这并不总是可用的，否则可能会太慢。我更喜欢不会将自己的文件添加到要同步的文件夹中的东西，以及可以快速轻松地更改文件和文件夹同步选择的东西。运行时交互性越少越好，理想情况下，只需单击几下鼠标就可以安全地同步多个文件夹对（就像 SyncToy 一样）。

我必须使用 rsync 和批处理文件吗？带有GUI的东西可以让奶奶轻松使用，会更好。这是我的标准：

1.  不需要 Internet 连接。

2.  它不能在源或目标中创建它自己的管家文件/文件夹（也许因为 NTFS 的缺点而必须这样做？）

3.  测试：具有两个非空子文件夹 A 和 B 的源文件夹。将子文件夹 B 移动到子文件夹 A 中，它是否在目标文件夹中复制了这个？

4.  测试：重命名子文件夹 A 中的文件，它是否在目标文件夹中重复？

5.  只需单击一两次鼠标，是否可以同时完成多个文件夹对同步？

6.  它是否具有预览即将进行的更改的选项？

7.  它是否允许轻松更改源和/或目标路径？

8.  它必须很快，（特别是如果重新扫描两个文件夹树而没有任何改变）。

9.  测试：在 PC 1 上同步 USB 驱动器，然后将文件和文件夹从 USB 驱动器复制到 PC 2，在 PC 2 上更改文件夹和文件（PC 1 上的文件夹和文件保持不变），在 PC 2 上同步 USB 驱动器，然后重新同步USB 驱动器中 PC 1 上的文件和文件夹。它可以做到这一点而没有任何错误吗？

10.  不包括安装，奶奶用起来舒服吗？-->

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T11:35:38.340

[http://allwaysync.com/](http://allwaysync.com/) - 它是免费的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T11:43:17.183

SyncBackSE 是一个更强大的解决方案，我用于日常备份到外部。它不是免费的，但它轻便、功能丰富且直观。

[http://www.2brightsparks.com/syncback/sbse.html](http://www.2brightsparks.com/syncback/sbse.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T12:27:21.807

[Dropbox](http://www.getdropbox.com)绝对很棒。它在后台自动同步，将所有文件本地存储在您要使用文件的每台计算机上，并集中存储在网络服务器上。文件以加密方式发送，最多可免费使用 2GB 存储空间。

您提到您不想使用基于 Web 的存储，但我认为这仍然符合要求 - 您可以在离线时访问文件（因为您有本地副本）如果您在离线时进行更改，那么更改当您上线时将与服务器同步。不确定它如何处理冲突的修订。

适用于 Windows、Linux 和 Mac。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T11:21:54.893

[Robocopy 女士](http://www.microsoft.com/downloads/details.aspx?displaylang=en&familyid=9D467A69-57FF-4AE7-96EE-B18C4790CFFD)似乎可以满足您的所有标准。

大量的选择，非常可靠。

仅命令行，但制作/下载 gui 很简单

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T11:37:02.610

贾斯汀弗兰克尔（Winamp Fame）写了这个

[http://www.brothersoft.com/pathsync-64550.html](http://www.brothersoft.com/pathsync-64550.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T11:46:40.423

如果我理解正确，您正在使用 SyncToy 同步不同机器中的文件夹。这不是一个好主意，因为尚未实现 SyncToy 来执行此操作；它更像是一种备用解决方案。

要在机器之间同步文件夹，您有两个非常好的解决方案，它们工作得很好并且可以自动同步。

第一个是[Windows Live Mesh](https://www.mesh.com/Welcome/Welcome.aspx)。尽管是技术预览版，但它运行良好，它还允许您远程访问添加到 Mesh 的机器。

另一个选项是[Windows Live FolderShare](https://www.foldershare.com/welcome.aspx)。它是 Beta 版，也很好用。我推荐这个选项的原因很简单：Windows Live Mesh 将成为 Microsoft 的共享平台，FolderShare 将在它之上实现，因此 FolderShare 将成为使用的应用程序，而 Mesh 将成为底层平台。如果您使用 Mesh，在某些时候您将不得不移动到 FolderShare，如果您使用 FolderShare，您将一切就绪。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T11:49:42.023

Winmerge 是我更喜欢的工具：它是开源的并且非常有用。

[Winmerge主页](http://www.winmerge.org/index.php)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T12:07:19.007

## 同步器

这里是功能列表（您可以在网站上找到它们）：

*   同步多个文件夹
*   选项卡允许您同时运行更多同步
*   定期同步以选定的时间间隔自动同步您的文件夹
*   恢复在同步期间被覆盖的文件
*   将文件和文件夹添加到黑名单以确保它们将来不会同步
*   使用 multisync 制定计划和备份

它是一款免费软件，可在 Linux、Mac 和 Windows 上运行，带有 QT 编写的 GUI。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T12:11:29.203

您还可以使用免费版本的 SyncBack，它足以同步不同机器上的文件夹。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T13:19:05.203

我用[Unison](http://www.cis.upenn.edu/~bcpierce/unison/)很长时间了。它是免费的，它是跨平台的，它使用 rsync 协议通过网络连接仅传输变化的增量。它在检查文件的更改方面也非常彻底——因此不幸的是它不是很快（如果你让它使用文件修改时间作为 Windows 下的 inode 等价物，你可以显着加快速度）。

但是，除非您愿意在 SyncBackSE（我现在使用并强烈推荐）上花钱，否则我认为您会在 Unison 上走得更远。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-31T13:38:15.613

我会投票支持 allway 同步，立即将我的主机与便携式 HDD 备份连接起来。

我有一个 60,000 个文件夹结构，它可以发现一个简单的更改（一个更改的 .txt 文件加上相应的新 .bak）并在几分钟内同步。

这对我来说似乎很有用......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-31T14:36:50.953

为此，我使用了一个名为[Mercurial](http://www.selenic.com/mercurial/wiki/)的分布式版本控制系统。[它是 CLI，但您可以使用像TortoiseHG](http://tortoisehg.sourceforge.net/)这样的不错的前端。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-09T08:27:52.100

## 对于单向同步

最好的 Unix 同步工具之一 (rsync) 有一个 Windows 端口：

*   带图形用户界面：[DeltaCopy](http://www.aboutmyip.com/AboutMyXApp/DeltaCopy.jsp)；
*   对于命令行爱好者：[CWRsync](http://www.itefix.no/i2/node/10650)。

有安装程序，没有 Cygwin 依赖项，不需要任何互联网连接等。

Rsync 非常快速、轻量且高效，只要您花时间学习使用它。

## 用于双向同步

参考是[Unisson](http://www.cis.upenn.edu/~bcpierce/unison/)。由于它使用 Java 运行，因此非常易于使用和跨平台。但它并没有快速减轻...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-11-18T10:39:35.733

[超级灵活的文件同步](http://www.superflexible.com/features.htm)器可以检测重新组织的文件夹和文件，并快速复制相同的动作，因此它不会进行不必要的复制。此外，它不会将自己的管家文件添加到目标文件夹中。它还带有一个调度程序。

# php - 如何比较两个数组并从中删除匹配元素以进行下一个循环？

> ID：225371
> 
> 赞同：17
> 
> 时间：2008-10-22T11:33:37.907
> 
> 标签：php, arrays

您还能如何比较两个数组（$A 和 $B）并从第一个数组中减少匹配元素，以便为数组 $A 上的下一个循环做准备？

```
$A = array(1,2,3,4,5,6,7,8);
$B = array(1,2,3,4);

$C = array_intersect($A,$B);  //equals (1,2,3,4)
$A = array_diff($A,$B);       //equals (5,6,7,8) 
```

这是最简单的方法还是有办法使用我没有想到的另一个功能？我的目标是拥有一个可以循环的数组，提取相关内容组（我在其他地方定义了这些关系），直到数组返回 false。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-22T13:15:15.970

你明白了。只需使用`array_diff`or `array_intersect`。没有比这更容易的了。

**编辑：** 例如：

```
$arr_1 = array_diff($arr_1, $arr_2);
$arr_2 = array_diff($arr_2, $arr_1); 
```

[来源](https://stackoverflow.com/a/8691348/2210140)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-07T12:22:52.960

亲爱的简单干净的方式

```
$clean1 = array_diff($array1, $array2); 
$clean2 = array_diff($array2, $array1); 
$final_output = array_merge($clean1, $clean2); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T14:57:26.153

另请参见[array_unique](http://us.php.net/array_unique)。如果你连接这两个数组，它会抽出所有重复的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T21:50:31.513

嘿，更好的解决方案：[array_uintersect。](http://us.php.net/manual/en/function.array-uintersect.php) 这让您可以根据 array_intersect 比较数组，然后它可以让您将数据与回调函数进行比较。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-08-13T06:28:18.443

试试这个

```
$a = array(0=>'a',1=>'x',2=>'c',3=>'y',4=>'w');
$b = array(1=>'a',6=>'b',2=>'y',3=>'z');
$c = array_intersect($a, $b);

$result = array_diff($a, $c);
print_r($result); 
```

# java - 在 Eclipse 中，如何排除某些文件（可能基于 .svn 扩展名或文件名）被复制到输出文件夹？

> ID：225375
> 
> 赞同：29
> 
> 时间：2008-10-22T11:34:16.313
> 
> 标签：java, eclipse, svn, build-process

我正在使用 Eclipse 开发 Java 应用程序。我的项目有两个构建的源目录，然后将一些文件复制到输出文件夹中。然后从输出目录运行我的应用程序，一切正常。

但是，我不断收到以下警告：

[Eclipse 中问题选项卡的快照 http://www.freeimagehosting.net/uploads/128c1af93f.png](http://www.freeimagehosting.net/uploads/128c1af93f.png)

任何人都知道如何摆脱这些警告？也许通过从构建过程中排除一些文件，可能基于 .svn 扩展名或文件名？如果是这样，我将如何排除这些？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-22T11:44:21.317

您是否尝试添加

`**/.svn/`

到项目构建路径设置的*源首选项中的**排除模式？*

 ** * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-22T11:52:36.637

您还可以尝试为 Eclipse 安装 Subversion 插件 ( [Subclipse](http://subclipse.tigris.org/) )。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T11:44:37.027

当然，这很简单：在 Project Properties -- Java Build Path 中，您可以在每个源文件夹上添加排除过滤器。在那里，您可以将排除模式添加为 *.svn

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T11:43:36.403

听起来您的构建过程正在使用 subversion 工作区中的版本化目录。

您不应该将您的“输出”文件夹和/或您的“tst”文件夹设为“私有”吗？（即没有任何.svn，并被颠覆忽略）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-20T16:37:42.463

右键单击源文件 > 构建路径 > 排除。

# c# - 如何计算出用户 MySite 的 ID

> ID：225391
> 
> 赞同：3
> 
> 时间：2008-10-22T11:37:05.200
> 
> 标签：c#, .net, sharepoint, moss

在用 c# 编写的 Sharepoint WebPart 中，我需要找出当前用户 MySite 的 ID，或者检查当前站点是否是用户 MySite。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T14:59:56.710

我花了一个下午的时间来解决这个问题，并且已经解决了。

在引用 Microsoft.Office.Server.dll 和 Microsoft.Sharepoint.dll 后添加以下 using 语句

```
using Microsoft.SharePoint;
using Microsoft.Office.Server;
using Microsoft.Office.Server.UserProfiles; 
```

然后通过执行以下操作访问用户配置文件：

```
ServerContext sc = ServerContext.Current;
UserProfileManager upm = new UserProfileManager(sc);
UserProfile up = upm.GetUserProfile(SPContext.Current.Web.CurrentUser.LoginName); 
```

然后您可以通过以下方式获取 MySite 的网站集 ID (SPSite.ID)：

```
upm.GetUserProfile(SPContext.Current.Web.CurrentUser.LoginName).ID 
```

或站点 ID (SPWeb.ID) 通过：

```
upm.GetUserProfile(SPContext.Current.Web.CurrentUser.LoginName).PersonalSite.RootWeb.ID 
```

很明显，不是真的！

# c# - 将项目动态添加到上下文菜单并设置单击操作

> ID：225394
> 
> 赞同：13
> 
> 时间：2008-10-22T11:37:29.660
> 
> 标签：c#, .net, contextmenu

我有一个每 5 秒重新生成一次的字符串列表。我想创建一个上下文菜单并使用此列表动态设置其项目。问题是我什至不知道如何做到这一点并为生成的每个项目管理 Click 操作（应该使用具有不同参数 DoSomething("item_name") 的相同方法）。

我该怎么做？

谢谢你的时间。最好的祝福。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-22T12:15:49.723

因此，您可以使用以下命令从上下文菜单中清除项目：

```
myContextMenuStrip.Items.Clear(); 
```

您可以通过调用添加项目：

```
myContextMenuStrip.Items.Add(myString); 
```

上下文菜单有一个 ItemClicked 事件。您的处理程序可能如下所示：

```
private void myContextMenuStrip_ItemClicked(object sender, ToolStripItemClickedEventArgs e)
{
    DoSomething(e.ClickedItem.Text);
} 
```

对我来说似乎工作正常。如果我误解了你的问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-25T11:49:25.590

`ToolStripMenuItem`使用对象的另一种选择：

```
//////////// Create a new "ToolStripMenuItem" object:
ToolStripMenuItem newMenuItem= new ToolStripMenuItem();

//////////// Set a name, for identification purposes:
newMenuItem.Name = "nameOfMenuItem";

//////////// Sets the text that will appear in the new context menu option:
newMenuItem.Text = "This is another option!";

//////////// Add this new item to your context menu:
myContextMenuStrip.Items.Add(newMenuItem); 
```

在您的`ItemClicked`事件中`myContextMenuStrip`，您可以检查选择了哪个选项（*基于菜单项的名称属性*）

```
private void myContextMenuStrip_ItemClicked(object sender, ToolStripItemClickedEventArgs e)
{
    ToolStripItem item = e.ClickedItem;

    //////////// This will show "nameOfMenuItem":
    MessageBox.Show(item.Name, "And the clicked option is...");
} 
```

# sql - 用更少的参数编写更有针对性的存储过程会更好吗？

> ID：225398
> 
> 赞同：3
> 
> 时间：2008-10-22T11:38:19.580
> 
> 标签：sql, stored-procedures

假设我有一个从 SELECT 查询返回数据的存储过程。我想根据我通过的参数对这些结果进行稍微不同的削减。我想知道是否有多个存储过程采用一个或不采用参数来执行此操作（例如，GetXByDate 或 GetXByUser），还是一个具有多个参数的存储过程（例如，GetX）更好？

第一个选项的优点是它更简单并且可能更快，但缺点是查询的本质在存储过程中是重复的，并且需要在多个地方进行维护。

第二个选项的优点是查询只出现一次，但缺点是查询更复杂，更难排除故障。

您在解决方案中使用什么，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T11:54:53.573

存储过程越复杂，SQL Server 就越复杂，无法正确编译并快速高效地执行。

即使在大型存储过程中，您也必须拥有多个查询副本，或者在其中添加大量 CASE 和 IF，这会降低性能。因此，将所有内容放在一起并不会真正获得太多收益。

根据我的个人经验，我还认为具有大量分支的大型 SQL sp 代码比几个更小且简单的 sproc 更难维护。

您可以考虑使用视图和 UDF 来减少查询代码的复制粘贴。

说如果您不关心性能（Intranet 应用程序，查询不是那么重，不要经常运行），您可能会发现拥有一个通用存储过程非常方便。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T12:24:41.110

我会像对待类中的方法一样对待存储过程。它应该做一件事并且简单地做。考虑将相同类型的重构/代码异味规则应用于存储过程，就像应用于应用程序代码一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T11:52:53.810

对于简单的存储过程，我更喜欢 GetXByDate、GetXByUser...，因为它们无论如何都需要很少的维护，在这种情况下，我认为维护重复代码比维护复杂代码更容易。

当然，如果你有更复杂的存储过程，这可能不是真的。GetAndProcessXByDate 可以更好地简化为 GetXByDate, GetXByUser, ... 调用另一个存储过程 ProcessX。

所以我想最终的答案是：这取决于...... :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T16:53:14.470

我第二个@tvanfosson。

但是，我要补充一点，您可以同时做到这两个：拥有一个包含整个查询类的基本逻辑的多用途存储过程（例如 GetX），并将其包装在一系列较小的存储过程（GetXY、GetXZ）中，这些存储过程执行大的，传入适当的参数。

这意味着您不会重复自己，但您也可以为客户端应用程序提供一个简单的接口：只调用 GetXY 的应用程序不必知道 GetXZ。

我们有时会使用这种方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T14:42:05.810

如果您使用生成的 C# 数据访问层（如 LinqToSQL），则单个存储过程的一个优点是生成单个类来表示您的结果集。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T17:13:49.700

AJs 方法为您提供两全其美的方法。不得不在多个存储过程中维护重复代码的痛苦怎么强调都不为过。

构建 Sproc 和 UDF 模块以供常用，并从特定于任务的 sproc 调用它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T11:48:13.120

谁/什么将调用这些存储过程？我通常不会为 SELECT 语句编写存储过程，正是因为您可能需要许多不同的 SELECT 语句，包括连接到其他表等。

# visual-studio - 折叠到除区域以外的定义的快捷方式

> ID：225413
> 
> 赞同：9
> 
> 时间：2008-10-22T11:43:15.670
> 
> 标签：visual-studio, visual-studio-2008, keyboard-shortcuts

在 vs2008 中，我如何（可能使用宏）分配快捷键以折叠到定义但保持区域展开（如果折叠则它们必须展开）？

**编辑：**我讨厌地区，但我的同事不喜欢（：所以我希望这样可以避免他们使用的地区。

我读了杰夫的帖子。Ctrl M + O 是我真正想做的，如果没有区域的话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-26T20:53:02.040

我相信我*终于*得到了我一直在寻找的答案，我认为它也可能对您有所帮助，@Serhat。你说：

> 我读了杰夫的帖子。Ctrl M + O 是我真正想做的，如果没有区域的话。

这*正是*我对自己的想法。我继续这种思路并努力（暂时）摆脱#regions。

这不是一个完整的解决方案，但我很高兴有*一些*我即将上下跳跃的东西。我会尽量让这些方向变得简单，尽管我敢说发布我创建的宏的实际内容可能更容易。（见底部链接）

我创建了两个宏：

1.  注释掉所有#region 和#endregion 指令。
2.  取消注释所有出现的 //#region 和 //#endregion。

创建第一个宏：

*   使用 开始录制宏`Ctrl+Shift+R`，然后按照以下步骤操作：
*   `Ctrl+H`, 查找什么: `#region`, 替换为:`//#region`
*   `Alt+A`全部替换
*   `Ctrl+H`, 查找什么: `#endregion`, 替换为:`//#endregion`
*   `Alt+A`全部替换
*   结束录制宏`Ctrl+Shift+R`
*   `Alt+F8`使用或 工具打开宏资源管理器| 宏 > 宏资源管理器
*   将 TemporaryMacro 重命名为 CommentRegionDirectives

然后，创建第二个宏：

*   使用 开始录制宏`Ctrl+Shift+R`，然后按照以下步骤操作：
*   `Ctrl+H`, 查找什么: `//#region`, 替换为:`#region`
*   `Alt+A`全部替换
*   `Ctrl+H`, 查找什么: `//#endregion`, 替换为:`#endregion`
*   `Alt+A`全部替换
*   结束录制宏`Ctrl+Shift+R`
*   `Alt+F8`使用或 工具打开宏资源管理器| 宏 > 宏资源管理器
*   将（这个新的）TemporaryMacro 重命名为 UncommentRegionDirectives

现在，使用 Ctrl+S 将宏保存在宏资源管理器中。

最后，为这两个宏分配快捷键：

*   打开工具 | 选项 | 环境+键盘
*   在“显示包含：的命令”中输入`Directives`. 这应该向您显示您的两个宏，名为“Macros.MyMacros.RecordingModule.CommentRegionDirectives”和“...UncommentRegionDirectives”
*   突出显示 CommentRegionDirectives 条目并在“按快捷键：”框中键入`Alt+/`，然后单击`Assign`按钮
*   突出显示 UncommentRegionDirectives 条目并在“按快捷键：”框中键入`Alt+Shift+/`然后单击`Assign`按钮（默认情况下，这两个快捷键组合未分配给任何内容）
*   单击确定以保存您的快捷方式分配。

现在，当您遇到自动折叠的#regions 时，点击`Alt+/`注释掉#region 指令，然后点击`Ctrl+M+O`Collapse to Definitions 的标准（如果您选择的话）。稍后，在使用已注释掉的#regions 提交该单元之前，只需点击`Alt+Shift+/`取消注释#regions，它们将被重新激活。

最后，@Serhat，再次感谢您最初的评论，这让我首先进入了这条赛道。

在实践中，我非常愿意忍受一个小问题。 `//#region`紧随其后的`#//endregion`是连续评论，评论仍然折叠，但至少那里没有隐藏代码。

这是我从宏资源管理器中提取的承诺宏文本：http: [//pastebin.ca/1688618](http://pastebin.ca/1688618)，尽管如果您手动按照我上面概述的步骤进行操作，则不需要它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T12:02:24.697

我发现`Ctrl`+ `M`, `Ctrl`+`O`对于折叠所有内容非常有用。

你读过[Jeff 关于区域的博文](https://blog.codinghorror.com/the-problem-with-code-folding/)吗？他列出了一些更有用的快捷方式。

为什么要保持这些扩展，如果您不希望它折叠，您真的需要该区域吗？

# discrete-mathematics - 有没有支持离散数学的工具？

> ID：225430
> 
> 赞同：5
> 
> 时间：2008-10-22T11:48:13.993
> 
> 标签：discrete-mathematics

[离散数学（也是有限数学）](http://en.wikipedia.org/wiki/Discrete_mathematics)处理诸如逻辑、集合论、信息论、部分有序集合、证明、关系和许多其他主题的主题。

对于其他数学分支，也有支持编程的工具。对于统计，[R](http://en.wikipedia.org/wiki/R_(programming_language))和[S](http://en.wikipedia.org/wiki/S_programming_language)内置了许多有用的统计函数。对于数值分析，[Octave](http://en.wikipedia.org/wiki/GNU_Octave)可以用作语言或集成到 C++ 中。

我不知道任何专门处理离散数学的语言或包（尽管几乎每种语言都可用于实现离散数学中使用的算法，但应该有专门为这些应用程序设计的库或环境）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T23:30:14.177

[Mathematica](http://www.wolfram.com/products/mathematica/index.html)的当前版本是 7。许可证费用：

1.  [家庭版](http://wolfram.com/products/mathematicahomeedition/qa.html)：295 美元。
2.  标准：$2,495 Win/Mac/Linux PC（$3,120 for Solaris）
3.  政府：1,996 美元（Solaris 为 2,496 美元）
4.  教育：1,095 美元（Solaris 为 1,370 美元）
5.  学生：139.95 美元（无 Solaris）

上面，家庭版链接说：

Mathematica Home Edition 是 Mathematica Professional 的全功能版本，具有相同的功能。

[Maple](http://www.maplesoft.com/)的当前版本是 12。 许可费用：

1.  学生：99美元
2.  商业：1,895 美元
3.  学术：995 美元
4.  政府：$1,795

是的，看看上面 Thomas Owens 提到的 Sage。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T11:59:49.023

数学

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-03T16:35:35.057

Mathematica 有一个 Combinatorica 包，虽然在这一点上相当古老，但它为组合数学和图形提供了很好的支持。可以使用这样的命令： NecklacePolynomial[8, m, Cyclic]; GrayCodeSubsets[{1, 2, 3, 4}]; 整数分区[6]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T12:00:54.870

我会说 Mathematica 是您最好的选择.. 即使它没有开箱即用的某些功能，它也有设计精良的补充包，可在网上
查看[http://www.wolfram.com/ products/mathematica/analysis/](http://www.wolfram.com/products/mathematica/analysis/)
您可能对数论、图形可视化的链接感兴趣

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T15:15:42.513

我还找到了[Sage](http://www.sagemath.org/index.html)。它似乎是最接近 Mathematica 的开源软件，但我不确定它处理离散数学的能力如何。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-15T19:54:06.143

[Maple](http://en.wikipedia.org/wiki/Maple_(software))和[Matlab](http://en.wikipedia.org/wiki/MATLAB)将是几个数学软件包，可能涵盖您想要的部分内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-05T01:56:42.970

[主要由 Donald Knuth 编写的Stanford GraphBase](http://www-cs-faculty.stanford.edu/~uno/sgb.html)是一个很棒的组合计算包。我不会称它为广泛的代码库，但它对图有很好的支持，并且可以根据图论来制定大量离散数学。它是用 CWEB 编写的，它是（IMO）一个更易读的 C 版本。

编辑：它是免费的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-06T02:14:21.333

我喜欢 Mathematica，并在我攻读计算物理学博士学位期间用它来原型化想法。然而，Mathematica 试图成为所有人的一切，但也有一些缺点：

*   作为一家营利性公司，错误修复有时会在下一个主要版本中出现：您付费。
*   作为专有产品，与非 Mathematica 人员（世界）共享代码是有问题的。
*   当您尝试将其扩展到嵌入式示例之外时，新功能通常是半生不熟的。
*   它的用户群（教程、建议、外部库）不如 python 活跃，
*   多面板图很难生成；请参阅[SciDraw](http://scidraw.nd.edu/levelscheme/)库。

话虽如此，Mathematica 的核心功能令人惊叹，原因如下：

*   它的默认数学功能非常强大，可以快速解决问题。
*   它允许函数式和过程式编程。
*   可以快速编码并以多种格式发布：pdf、交互式网站。
*   一本新的离散[书](https://rads.stackoverflow.com/amzn/click/com/1938159004)问世了。

**底线**

*   期待易用性的 Apple 用户会喜欢 Mathematica，因为它具有 Apple 式的、易于使用的感觉。
*   想要可扩展性的 Linux 用户会发现 Mathematica 令人沮丧，因为它具有类似 Apple 的盒式焊接闭合设计。

# c++ - 创建 DLL 时导出所有符号

> ID：225432
> 
> 赞同：76
> 
> 时间：2008-10-22T11:48:47.720
> 
> 标签：c++, windows, visual-studio, visual-studio-2005

使用 VS2005，我想创建一个 DLL 并自动导出所有符号，而无需`__declspec(dllexport)`到处添加，也无需手动创建`.def`文件。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2015-08-29T10:03:11.533

## 简短的回答

您可以借助新版本的 CMake（任何版本的 cmake-3.3.20150721-g9cd2f-win32-x86.exe 或更高版本）来完成此操作。

目前它在 dev 分支中。稍后，该功能将在 cmake-3.4 的发布版本中添加。

链接到 cmake 开发：

[cmake_dev](http://www.cmake.org/files/dev/)

链接到描述该技术的文章：

[使用新的 CMake 导出所有功能在没有 declspec() 的情况下在 Windows 上创建 dll](https://blog.kitware.com/create-dlls-on-windows-without-declspec-using-new-cmake-export-all-feature/)

链接到示例项目：

[cmake_windows_export_all_symbols](https://bitbucket.org/vlasovmaksim/cmake_windows_export_all_symbols/overview)

* * *

## 长答案

*注意：* 以下所有信息都与 MSVC 编译器或 Visual Studio 有关。

如果您在 Linux 上使用 gcc 或 Windows 上的 MinGW gcc 编译器等其他编译器，则不会由于未导出符号而出现链接错误，因为 gcc 编译器默认导出动态库 (dll) 中的所有符号，而不是 MSVC 或 Intel Windows 编译器.

在 Windows 中，您必须从 dll 中显式导出符号。

链接提供了有关此的更多信息：

[从 DLL 导出](https://msdn.microsoft.com/en-us/library/z4zxe9k8.aspx)

[HowTo：从 DLL 导出 C++ 类](http://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL)

因此，如果您想使用 MSVC（Visual Studio 编译器）从 dll 中导出所有符号，您有两种选择：

*   在类/函数的定义中使用关键字 __declspec(dllexport)。
*   创建模块定义 (.def) 文件并在构建 DLL 时使用 .def 文件。

* * *

*1.在类/函数的定义中使用关键字__declspec(dllexport)*

* * *

*1.1。将“__declspec(dllexport) / __declspec(dllimport)”宏添加到要使用的类或方法中。因此，如果要导出所有类，则应将此宏添加到所有类*

链接提供了有关此的更多信息：

[使用 __declspec(dllexport) 从 DLL 导出](https://msdn.microsoft.com/en-us/library/a90k134d.aspx)

使用示例（将“项目”替换为真实项目名称）：

```
// ProjectExport.h

#ifndef __PROJECT_EXPORT_H
#define __PROJECT_EXPORT_H

#ifdef USEPROJECTLIBRARY
#ifdef  PROJECTLIBRARY_EXPORTS 
#define PROJECTAPI __declspec(dllexport)
#else
#define PROJECTAPI __declspec(dllimport)
#endif
#else
#define PROJECTAPI
#endif

#endif 
```

然后将“PROJECTAPI”添加到所有类。仅当您希望从 dll 导出/导入符号时才定义“USEPROJECTLIBRARY”。为 dll 定义“PROJECTLIBRARY_EXPORTS”。

类导出示例：

```
#include "ProjectExport.h"

namespace hello {
    class PROJECTAPI Hello {}   
} 
```

函数导出示例：

```
#include "ProjectExport.h"

PROJECTAPI void HelloWorld(); 
```

*注意：*不要忘记包含“ProjectExport.h”文件。

* * *

*1.2\. 导出为 C 函数。如果您使用 C++ 编译器编译代码是用 C 编写的，您可以在函数前面添加 extern "C" 以消除名称混淆*

链接提供了有关 C++ 名称修饰的更多信息：

[名称装饰](https://msdn.microsoft.com/en-us/library/deaxefa7.aspx)

使用示例：

```
extern "C" __declspec(dllexport) void HelloWorld(); 
```

链接提供了有关此的更多信息：

[导出 C++ 函数以用于 C 语言可执行文件](https://msdn.microsoft.com/en-us/library/wf2w9f6x.aspx)

* * *

*2.创建模块定义（.def）文件，构建DLL时使用.def文件*

链接提供了有关此的更多信息：

[使用 DEF 文件从 DLL 导出](https://msdn.microsoft.com/en-us/library/d91k01sh.aspx)

此外，我描述了三种关于如何创建 .def 文件的方法。

* * *

*2.1。导出 C 函数*

在这种情况下，您可以简单地手动在 .def 文件中添加函数声明。

使用示例：

```
extern "C" void HelloWorld(); 
```

.def 文件示例（__cdecl 命名约定）：

```
EXPORTS 
_HelloWorld 
```

* * *

*2.2\. 从静态库中导出符号*

我尝试了“user72260”建议的方法。

他说：

*   首先，您可以创建静态库。
*   然后使用“dumpbin /LINKERMEMBER”从静态库中导出所有符号。
*   解析输出。
*   将所有结果放入 .def 文件中。
*   使用 .def 文件创建 dll。

我使用了这种方法，但总是创建两个构建（一个作为静态库，另一个作为动态库）并不是很方便。但是，我不得不承认，这种方法确实有效。

* * *

*2.3\. 从 .obj 文件或借助 CMake 导出符号*

* * *

*2.3.1。使用 CMake*

*重要通知：*您不需要任何导出宏到类或函数！

*重要提示：*使用此方法时不能使用 /GL（[全程序优化](https://msdn.microsoft.com/en-us/library/0zza0de8.aspx)）！

*   根据“CMakeLists.txt”文件创建 CMake 项目。
*   将以下行添加到“CMakeLists.txt”文件中： set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)
*   然后在“CMake (cmake-gui)”的帮助下创建 Visual Studio 项目。
*   编译项目。

使用示例：

*根文件夹*

CMakeLists.txt（根文件夹）

```
cmake_minimum_required(VERSION 2.6)
project(cmake_export_all)

set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)

set(dir ${CMAKE_CURRENT_SOURCE_DIR})
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${dir}/bin")

set(SOURCE_EXE main.cpp)

include_directories(foo)

add_executable(main ${SOURCE_EXE})

add_subdirectory(foo)

target_link_libraries(main foo) 
```

main.cpp（根文件夹）

```
#include "foo.h"

int main() {
    HelloWorld();

    return 0;
} 
```

*Foo 文件夹（根文件夹/Foo 文件夹）*

CMakeLists.txt（Foo 文件夹）

```
project(foo)

set(SOURCE_LIB foo.cpp)

add_library(foo SHARED ${SOURCE_LIB}) 
```

foo.h（Foo 文件夹）

```
void HelloWorld(); 
```

foo.cpp（Foo 文件夹）

```
#include <iostream>

void HelloWorld() {
    std::cout << "Hello World!" << std::endl;
} 
```

再次链接到示例项目：

[cmake_windows_export_all_symbols](https://bitbucket.org/vlasovmaksim/cmake_windows_export_all_symbols/overview)

CMake 使用不同于“2.2\. 从静态库中导出符号”的方法。

它执行以下操作：

1）在构建目录中创建“objects.txt”文件，其中包含在dll中使用的.obj文件的信息。

2）编译dll，即创建.obj文件。

3) 根据“objects.txt”文件信息从.obj 文件中提取所有符号。

使用示例：

```
DUMPBIN /SYMBOLS example.obj > log.txt 
```

链接提供了有关此的更多信息：

[/符号](https://msdn.microsoft.com/en-us/library/b842y285.aspx)

4) 解析从.obj 文件信息中提取的信息。

在我看来，我会使用调用对流，例如“__cdecl/__fastcall”、“SECTx/UNDEF”符号字段（第三列）、“外部/静态”符号字段（第五列）、“??”、“? " 解析 .obj 文件的信息。

我不知道 CMake 究竟是如何解析 .obj 文件的。但是，CMake 是开源的，因此您可以了解它是否对您感兴趣。

链接到 CMake 项目：

[CMake_github](https://github.com/Kitware/CMake)

5) 将所有导出的符号放入 .def 文件中。

6) 使用 .def 创建的文件链接 dll。

步骤 4)-5)，即在链接和使用 .def 文件之前解析 .obj 文件并创建一个 .def 文件 CMake 在“预链接事件”的帮助下执行。当“预链接事件”触发时，您可以调用任何您想要的程序。因此，在“CMake 使用”“预链接事件”的情况下，使用以下信息调用 CMake，其中包含有关将 .def 文件放置在何处以及“objects.txt”文件在何处以及参数“-E __create_def”的信息。您可以通过使用“set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)”创建 CMake Visusal Studio 项目来检查此信息，然后检查 dll 的“.vcxproj”项目文件。

如果您尝试在没有“set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)”或“set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS OFF)”的情况下编译项目，您将收到链接错误，因为符号不是从 dll 导出的。

链接提供了有关此的更多信息：

[了解自定义构建步骤和构建事件](https://msdn.microsoft.com/en-us/library/e85wte0k.aspx)

* * *

*2.3.2\. 不使用 CMake*

您可以简单地创建一个小程序来自己解析 .obj 文件，而无需使用 CMake。但是，我不得不承认 CMake 是非常有用的程序，尤其是对于跨平台开发。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-22T14:36:31.127

可以办到...

我们在这里的做法是使用链接器的 /DEF 选项来传递一个[“模块定义文件”](https://docs.microsoft.com/en-us/cpp/build/reference/module-definition-dot-def-files?view=vs-2017)，其中包含我们的导出列表。我从您的问题中看到您了解这些文件。但是，我们不会手动操作。导出列表本身是由[dumpbin](http://msdn.microsoft.com/en-us/library/c1h23y6c.aspx) /LINKERMEMBER 命令创建的，并通过一个简单的脚本将输出操作为模块定义文件的格式。

设置工作量很大，但它允许我们在没有 dllexport 声明的情况下为 Windows 上的 Unix 编译创建的代码。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-01-07T01:54:04.910

> 我想创建一个 DLL 并自动导出所有符号，而无需在任何地方添加 __declspec(dllexport) 并且无需手动创建 .def 文件。有没有办法做到这一点？

这是一个较晚的答案，但它提供了 Maks 在第 (2) 节中的答案的详细信息。它还避免使用脚本并使用名为`dump2def`. 的源代码`dump2def`如下。

最后，以下步骤假设您正在使用 Visual Studio [Developer Prompt](https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs)工作，这是一个`vcvarsall.bat`已运行的 Windows 终端。您需要确保构建工具（如、 和`cl.exe`）`lib.exe`在路径上。`link.exe``nmake.exe`

> 链接提供了有关此的更多信息：
> 
> [使用 DEF 文件从 DLL 导出](https://msdn.microsoft.com/en-us/library/d91k01sh.aspx)
> ...

下面的指令使用：

*   `static.lib`- 静态库存档（Linux 上的 *.a 文件）
*   `dynamic.dll`- 动态库（Linux 上的 *.so 文件）
*   `import.lib`- 动态库（Windows 上的导入库）

另请注意，尽管您从 DLL 中导出所有内容，但客户端仍然必须`declspec(dllimport)`在他们使用的所有符号（类、函数和数据）上使用。另见 MSDN。

首先，获取您的对象并创建一个静态存档：

```
AR = lib.exe
ARFLAGS = /nologo

CXX_SRCS = a.cpp b.cpp c.cpp ...
LIB_OBJS = a.obj b.obj c.obj ...

static.lib: $(LIB_OBJS)
    $(AR) $(ARFLAGS) $(LIB_OBJS) /out:$@ 
```

其次，`dumpbin.exe /LINKERMEMEBER`在存档上运行以创建`*.dump`文件：

```
dynamic.dump:
    dumpbin /LINKERMEMBER static.lib > dynamic.dump 
```

第三，`dump2def.exe`对`*.dump`文件运行产生`*.def`文件。的源代码`dump2def.exe`如下。

```
dynamic.def: static.lib dynamic.dump
    dump2def.exe dynamic.dump dynamic.def 
```

四、构建DLL：

```
LD = link.exe
LDFLAGS = /OPT:REF /MACHINE:X64
LDLIBS = kernel32.lib

dynamic.dll: $(LIB_OBJS) dynamic.def
    $(LD) $(LDFLAGS) /DLL /DEF:dynamic.def /IGNORE:4102 $(LIB_OBJS) $(LDLIBS) /out:$@ 
```

`/IGNORE:4102`用于避免此警告。在这种情况下预计：

```
dynamic.def : warning LNK4102: export of deleting destructor 'public: virtual v
oid * __ptr64 __cdecl std::exception::`scalar deleting destructor'(unsigned int)
 __ptr64'; image may not run correctly 
```

当`dynamic.dll`调用配方时，它也会创建一个`dynamic.lib`导入文件和`dynamic.exp`文件：

```
> cls && nmake /f test.nmake dynamic.dll
...
Creating library dynamic.lib and object dynamic.exp 
```

和：

```
 C:\Users\Test\testdll>dir *.lib *.dll *.def *.exp
 Volume in drive C is Windows
 Volume Serial Number is CC36-23BE

 Directory of C:\Users\Test\testdll

01/06/2019  08:33 PM        71,501,578 static.lib
01/06/2019  08:33 PM        11,532,052 dynamic.lib

 Directory of C:\Users\Test\testdll

01/06/2019  08:35 PM         5,143,552 dynamic.dll

 Directory of C:\Users\Test\testdll

01/06/2019  08:33 PM         1,923,070 dynamic.def

 Directory of C:\Users\Test\testdll

01/06/2019  08:35 PM         6,937,789 dynamic.exp
               5 File(s)     97,038,041 bytes
               0 Dir(s)  139,871,186,944 bytes free 
```

在这里将它们粘合在一起就是 Nmake makefile 的样子。它是[真实 Nmake 文件](https://github.com/weidai11/cryptopp/blob/master/cryptest.nmake)的一部分：

```
all: test.exe

test.exe: pch.pch static.lib $(TEST_OBJS)
    $(LD) $(LDFLAGS) $(TEST_OBJS) static.lib $(LDLIBS) /out:$@

static.lib: $(LIB_OBJS)
    $(AR) $(ARFLAGS) $(LIB_OBJS) /out:$@

dynamic.map:
    $(LD) $(LDFLAGS) /DLL /MAP /MAPINFO:EXPORTS $(LIB_OBJS) $(LDLIBS) /out:dynamic.dll

dynamic.dump:
    dumpbin.exe /LINKERMEMBER static.lib /OUT:dynamic.dump

dynamic.def: static.lib dynamic.dump
    dump2def.exe dynamic.dump

dynamic.dll: $(LIB_OBJS) dynamic.def
    $(LD) $(LDFLAGS) /DLL /DEF:dynamic.def /IGNORE:4102 $(LIB_OBJS) $(LDLIBS) /out:$@

clean:
    $(RM) /F /Q pch.pch $(LIB_OBJS) pch.obj static.lib $(TEST_OBJS) test.exe *.pdb 
```

* * *

这里是源代码`dump2def.exe`：

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <vector>
#include <set>

typedef std::set<std::string> SymbolMap;

void PrintHelpAndExit(int code)
{
    std::cout << "dump2def - create a module definitions file from a dumpbin file" << std::endl;
    std::cout << "           Written and placed in public domain by Jeffrey Walton" << std::endl;
    std::cout << std::endl;

    std::cout << "Usage: " << std::endl;

    std::cout << "  dump2def <infile>" << std::endl;
    std::cout << "    - Create a def file from <infile> and write it to a file with" << std::endl;
    std::cout << "      the same name as <infile> but using the .def extension" << std::endl;

    std::cout << "  dump2def <infile> <outfile>" << std::endl;
    std::cout << "    - Create a def file from <infile> and write it to <outfile>" << std::endl;

    std::exit(code);
}

int main(int argc, char* argv[])
{
    // ******************** Handle Options ******************** //

    // Convenience item
    std::vector<std::string> opts;
    for (size_t i=0; i<argc; ++i)
        opts.push_back(argv[i]);

    // Look for help
    std::string opt = opts.size() < 3 ? "" : opts[1].substr(0,2);
    if (opt == "/h" || opt == "-h" || opt == "/?" || opt == "-?")
        PrintHelpAndExit(0);

    // Add <outfile> as needed
    if (opts.size() == 2)
    {
        std::string outfile = opts[1];
        std::string::size_type pos = outfile.length() < 5 ? std::string::npos : outfile.length() - 5;
        if (pos == std::string::npos || outfile.substr(pos) != ".dump")
            PrintHelpAndExit(1);

        outfile.replace(pos, 5, ".def");
        opts.push_back(outfile);
    }

    // Check or exit
    if (opts.size() != 3)
        PrintHelpAndExit(1);

    // ******************** Read MAP file ******************** //

    SymbolMap symbols;

    try
    {
        std::ifstream infile(opts[1].c_str());
        std::string::size_type pos;
        std::string line;

        // Find start of the symbol table
        while (std::getline(infile, line))
        {
            pos = line.find("public symbols");
            if (pos == std::string::npos) { continue; }        

            // Eat the whitespace after the table heading
            infile >> std::ws;
            break;
        }

        while (std::getline(infile, line))
        {
            // End of table
            if (line.empty()) { break; }

            std::istringstream iss(line);
            std::string address, symbol;
            iss >> address >> symbol;

            symbols.insert(symbol);
        }
    }
    catch (const std::exception& ex)
    {
        std::cerr << "Unexpected exception:" << std::endl;
        std::cerr << ex.what() << std::endl;
        std::cerr << std::endl;

        PrintHelpAndExit(1);
    }

    // ******************** Write DEF file ******************** //

    try
    {
        std::ofstream outfile(opts[2].c_str());

        // Library name, cryptopp.dll
        std::string name = opts[2];
        std::string::size_type pos = name.find_last_of(".");

        if (pos != std::string::npos)
            name.erase(pos);

        outfile << "LIBRARY " << name << std::endl;
        outfile << "DESCRIPTION \"Crypto++ Library\"" << std::endl;        
        outfile << "EXPORTS" << std::endl;
        outfile << std::endl;

        outfile << "\t;; " << symbols.size() << " symbols" << std::endl;

        // Symbols from our object files
        SymbolMap::const_iterator it = symbols.begin();
        for ( ; it != symbols.end(); ++it)
            outfile << "\t" << *it << std::endl;
    }
    catch (const std::exception& ex)
    {
        std::cerr << "Unexpected exception:" << std::endl;
        std::cerr << ex.what() << std::endl;
        std::cerr << std::endl;

        PrintHelpAndExit(1);
    }   

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-08T20:50:16.737

我编写了一个小程序来解析 .lib 文件上“dumpbin /linkermember”的输出。我有超过 8,000 个函数引用要从一个 DLL 导出。

在 DLL 上执行此操作的问题是，您必须在没有导出定义的情况下链接 DLL 一次以创建 .lib 文件，然后生成 .def，这意味着您现在必须再次使用 .def 文件重新链接 DLL 才能实际导出参考。

使用静态库更容易。将所有源代码编译到静态库中，运行 dubin，使用您的小程序生成 .def，然后在导出名称可用时将这些库链接到 DLL 中。

不幸的是，我的公司不允许我向您展示来源。所涉及的工作是识别转储输出中的哪些“公共符号”在您的 def 文件中不需要。你必须丢弃很多这些引用，NULL_IMPORT_DESCRIPTOR、NULL_THUNK_DATA、__imp* 等。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-04-18T05:28:05.457

感谢@Maks 的[详细回答](https://stackoverflow.com/a/32284832/246605)。

下面是我在 Pre-Link 事件中用于从 obj 生成 def 文件的示例。我希望它对某人有所帮助。

```
dumpbin /SYMBOLS $(Platform)\$(Configuration)\mdb.obj | findstr /R "().*External.*mdb_.*" > $(Platform)\$(Configuration)\mdb_symbols
(echo EXPORTS & for /F "usebackq tokens=2 delims==|" %%E in (`type $(Platform)\$(Configuration)\mdb_symbols`) do @echo  %%E) > $(Platform)\$(Configuration)\lmdb.def 
```

基本上我只取了一个对象 (mdb.obj) 并 grepped mdb_* 函数。然后解析输出以保留名称，同时考虑缩进的空格数量（一个在拆分为标记后，另一个在回显中。我不知道这是否重要）。

不过，现实世界的脚本可能会更复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-20T15:46:10.197

也许有人发现我的 Python 脚本对于将 .dump 转换为 .def 很有用。

```
import sys, os
functions = []
startPoint = False
# Exclude standard API like sprintf to avoid multiple definition link error
excluded_functions = [ 'sprintf', 'snprintf', 'sscanf', 'fprintf' ]

if len(sys.argv) < 2:
    print('Usage: %s <Input .dump file> <Output .def file>.' % sys.argv[0])
    print('Example: %s myStaticLib.dump exports.def' % sys.argv[0])
    sys.exit(1)
print('%s: Processing %s to %s' % (sys.argv[0], sys.argv[1], sys.argv[2]))

fin = open(sys.argv[1], 'r')
lines = fin.readlines()
fin.close()

# Reading
for l in lines:
    l_str = l.strip()
    if (startPoint == True) and (l_str == 'Summary'): # end point
        break
    if (startPoint == False) and ("public symbols" in l_str):
        startPoint = True
        continue
    if (startPoint == True) and l_str is not '':
        funcName = l_str.split(' ')[-1]
        if funcName not in excluded_functions:
            functions.append("    " + funcName)
# Writing
fout = open(sys.argv[2], 'w')
fout.write('EXPORTS\n')
for f in functions:
    fout.write('%s\n' % f)
fout.close() 
```

使用此脚本，您可以分两步获取 .lib 的 .def 文件：

```
dumpbin /LINKERMEMBER:1 myStaticLib.lib > myExports.dump
python dump2def.py myExports.dump myExports.def 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-10-22T11:57:05.237

不，您将需要一个宏，`__declspec(dllexport)`当它被实现导出函数的 .cpp 文件包含时解析为，`__declspec(dllimport)`否则解析为。

# .net - .NET 日期时间选择器平面样式

> ID：225441
> 
> 赞同：2
> 
> 时间：2008-10-22T11:51:45.093
> 
> 标签：.net, winforms

在 .NET 3.0 中，大多数控件具有“平面”样式。显然，日期选择器没有这样的样式，但表单中的所有其他控件都设置为平面。如何使日期选择器变平？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T12:29:09.417

我对日期时间选择器的理解是它仅限于系统内置的内容。换句话说，它继承了 Shell 的局限性。这是解释[DateTimePicker 常见问题解答条目](http://windowsclient.net/blogs/faqs/archive/2006/05/18/why-doesn-t-the-datetimepicker-control-support-the-flat-style.aspx)的常见问题解答链接。

我喜欢使用 [DotNetBar 组件](http://www.devcomponents.com/dotnetbar/)很长一段时间并取得了巨大的成功。在其他控件中，它提供了一个日期时间选择器，可以解决标准控件的许多问题。

# release - 源代码交接培训

> ID：225446
> 
> 赞同：2
> 
> 时间：2008-10-22T11:54:01.610
> 
> 标签：release

我们必须就我们开发的应用程序的源代码对客户专业人员进行培训。我应该在他们的源代码培训计划中包括什么？任何帮助将非常感激。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T11:55:56.987

这可能会有所帮助：

[支持文档中包含哪些核心元素？](https://stackoverflow.com/questions/205374/what-are-the-core-elements-to-include-in-support-documentation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T12:05:36.967

1.）如果可能的话，向他们展示代码经历的各种更改/修订，那么这将有助于他们在更高层次上理解代码设计。（该功能需要针对什么功能进行修改？）

2.）使用一些工具提取一些函数调用图/函数流程图，让他们熟悉。

3.) 应向他们解释应用程序的测试设置。

4.) 高级设计和低级设计文档

-广告

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T11:56:35.677

您可以突出显示重要的设计决策。因此，他们了解您选择哪种解决方案的原因。

# java - Doxygen 与 Javadoc

> ID：225447
> 
> 赞同：67
> 
> 时间：2008-10-22T11:54:36.803
> 
> 标签：java, maven-2, documentation, doxygen

我刚刚从 CACM 的一篇文章中意识到 Doxygen 也可以与 Java（和其他几种语言）一起使用。但是Java 已经有了Javadoc 工具。有人可以解释这两种方法的优缺点吗？它们是相互排斥的吗？Doxygen 有 Maven 插件吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-27T12:51:12.553

Doxygen 有许多 JavaDoc 不提供的特性，例如层次结构和合作上下文的类图、更多摘要页面、可选的源代码浏览（与文档交叉链接）、额外的标签支持，如 @todo on一个单独的页面，它可以生成 TeX 和 PDF 格式的输出。它还允许大量的视觉定制。

由于 Doxygen 支持标准的 JavaDoc 标签，您可以在任何带有 JavaDoc 注释的源代码上运行 Doxygen。在没有 JavaDoc 的情况下在源代码上运行通常甚至是有意义的，因为即使没有文档，图表和源代码浏览也可以帮助理解代码。由于 JavaDoc 工具会忽略未知标签，因此您甚至可以使用额外的 Doxygen 标签而不会破坏 JavaDoc 的生成。

说了这么多，我必须承认我已经很久没有使用 Doxygen 了。现在我倾向于严重依赖我的 IDE 来提供相同的可视化，我通常不会将 JavaDoc 当作 HTML 页面来阅读，而是将源文件导入我的 IDE，以便它可以生成 JavaDoc 弹出窗口，我可以跳转到定义。这比 Doxygen 提供的功能更强大。如果您想在 IDE 之外拥有文档并且乐于运行非 Java 工具，那么 Doxygen 值得一试，因为它不需要对您的 Java 代码进行任何更改。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-22T12:07:44.623

如果您是 Java 新手并且以前使用过 Doxygen，我只会将 Doxygen 与 Java 一起使用，从而减少您在使用 javadoc 时遇到的学习曲线。如果您以前没有使用过 Doxygen，我会坚持使用 javadoc，因为它是专门为 Java 设计的。如果您不知道其中任何一种，并且您使用 C++（或其他支持的语言）和使用 Java 一样多，那么 Doxygen 是一个不错的选择，因为您可以将它用于两种语言。

这两种工具都易于使用，具有相似的功能集。两者都有用于 NetBeans 和 Eclipse 的插件（或预先内置），从而可以更快地生成文档。每个人使用的评论风格有很多重叠，但它们并不*完全相同*，所以很难将它们混合在一起（你必须知道*两者*的细节，忽略任何特征特定于一个或另一个）。我从未使用过它，但似乎确实有一个[Doxygen 的 Maven 插件](http://doodleproject.sourceforge.net/mavenite/index.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T12:24:39.083

我喜欢使用 Doxygen，您可以将类图显示在与文档相同的页面上。此外，如果需要，我喜欢它直接将您链接到源代码的事实。我不知道 javadoc 是否具有这些功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-20T07:26:56.777

JavaDocs 的一大优势是它们可以正常工作。构建和查看它们所需的一切都包含在 JDK 中，您已经需要安装这些 JDK 来编译程序。

另一方面，Doxygen 的设置和正常工作可能会很痛苦。但如果设置正确，它应该能够生成 PDF、RTF、DocBook 以及 HTML。默认情况下，HTML 的组织方式不如 JavaDocs，因为 index.html 默认情况下会显示一个空白页面。此外，内联类和静态成员可能需要在文档中包含特殊标志，如果您想生成 PDF，您可能必须处理没有所需 pdflatex 命令的 Linux 发行版的麻烦（例如 Ubuntu/Mint 有最近有问题）所以如果你只是简单地安装它并运行你可能会得到一个充满错误的屏幕，即使是一个简单的程序。与安装 API 时自动获取 javadoc 的便利性相比，Doxygen 设置可能是一种悲惨的体验。一旦你克服了障碍，

# java - 如何在 Eclipse 中指定要包含在 .WAR 文件中的内容

> ID：225456
> 
> 赞同：3
> 
> 时间：2008-10-22T11:56:54.317
> 
> 标签：java, eclipse, jakarta-ee

在 eclipse 开发 java 应用程序中，有几个由自定义 ant 脚本生成的类文件。这会自动发生，它被设置为 /WEB-INF/classes 的导出/发布依赖项。发布时它会发生，但是在导出到 .WAR 时，这些文件就丢失了。有没有办法自动化这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T16:51:46.920

1.  转到您将导出的项目属性。
2.  设置 Java EE 模块依赖项

现在它们应该存在于您的出口战争中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T12:02:33.463

我建议使用 Ant 生成你的战争文件。

我喜欢使用简单的工具链轻松生成我的可交付成果，即不需要启动 Eclipse 来生成它们；这样，事情就更容易自动化和记录。

编辑六年后：当我写这篇文章时，我是一个蚂蚁人——今天我可能会建议 Maven

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:11:39.020

也许您可以尝试添加一个额外的构建器。转到项目属性，然后转到“构建器”。您可以添加自己的命令，这些命令将在 eclipse 构建过程运行后运行。

这不是一个理想的解决方案，但也许它有效。

# .net - How do I sanitize CSV input with the CsvReader?

> ID：225458
> 
> 赞同：2
> 
> 时间：2008-10-22T11:58:10.167
> 
> 标签：.net, vb.net, csv

I'm using the [CsvReader](http://sql.codeproject.com/KB/database/CsvReader.aspx) library in my Windows Forms application, which is coded in horribly messy VB (I've recently taken over the project.)

I'm currently capable of reading semi-colon separated files without quoting, but I'm having a problem: most of the input has quoted fields, but includes unescaped quote characters within the fields.

I cannot change the input, so I must tackle it somehow. One solution would be to entirely disable quoting -- but I'm not quite sure how to do that...

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T13:29:05.067

我只玩过这个库[LINQtoCSV](http://www.codeproject.com/KB/linq/LINQtoCSV.aspx)，但我认为它可能对引用的字段有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:45:43.223

查看[FileHelpers](http://www.filehelpers.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:44:42.523

你需要它有多通用？编写自己的 CSV 解析器将数据读入 DataTable 非常简单。

在某些情况下，解析 csv 文件可以像执行 a 一样简单`File.ReadAllLines(filename)`，然后对每一行执行 a，`string.Split`使用分号作为分隔符来获取列。您的代码可能会比这更高级，但如果您有特定的需求，自己编写它可能是一个好主意。

# c# - 无法解析 DNS

> ID：225467
> 
> 赞同：2
> 
> 时间：2008-10-22T12:01:54.167
> 
> 标签：c#, web-services, dns

我正在尝试使用 webmethod，但似乎我的应用程序无法解析 DNS。当我使用 url 配置我的应用程序（例如：[http://mywebservice.com/webservice/methods.asmx](http://mywebservice.com/webservice/methods.asmx)）时，问题就会浮出水面，但当我通过服务器的 IP 地址访问相同的 webmethod 时，问题就不会出现。

问题是由于现有的 DHCP 服务器策略，我需要使用 url 而不是 IP 地址来访问 web 服务。

谁能帮我 ？

提前致谢。

更新：查看 moocha 要求我做什么，我发现：

D:>nslookup server.com 服务器：dnsserver.mycompany.com 地址：XXX.YYY.XXX.YYY

*** dnsserver.mycompany.com 找不到 server.com：域不存在

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T12:13:01.680

您是否尝试过通过 nslookup*从运行您的应用程序的同一系统*确认相同的 DNS 查询有效？

IE，

```
C:\>nslookup
默认服务器：whatever.dns.example.org
地址：111.222.333.111

> 设置 q=a
> mywebservice.com
服务器：whatever.dns.example.org
地址：111.222.333.111

非权威答案：
名称：mywebservice.com
地址：208.254.26.139
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:17:38.633

再挖掘一点，我发现我的 PC 和服务器之间有一个代理。因此，我必须使用有效用户登录才能访问互联网。问题**是**我的应用程序的服务器（运行 IIS 的地方）被配置为使用匿名访问运行。我所要做的就是在 IIS 中配置一个有权访问互联网的用户（通过代理）。终于问题解决了。

还有另一种选择，我可以使用登录用户的凭据通过代理授予访问权限；但这要求所有用户对应用程序和 Intranet 使用相同的登录信息。

# asp.net - ASP.NET 性能：无需预编译的 Web 应用程序

> ID：225470
> 
> 赞同：5
> 
> 时间：2008-10-22T12:02:26.927
> 
> 标签：asp.net, performance

目前我们正在使用 Web 应用程序项目，因此我们在编译方面有所收获。但据我所知，aspx 页面仍然在第一页命中时编译。那么预编译会带来明显的性能提升吗？（第一击除外）。

什么类型的网站（点击次数/秒，用户数量）会从中受益？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T12:07:40.270

预编译节省了进行 JIT 编译的第一次工作，对于一个拥有大量页面的站点来说，他们知道每个页面被访问和编译之前需要多长时间。

在第一次点击之后，编译 JIT 或预编译的页面之间没有区别。

我们使用预编译来确保网站能够真正编译，并且不会因缺少参考或生产环境的某些问题而陷入困境。这一点也很重要，因为用户必须等待 JIT 编译，因此不会对我们的网站有不同的体验。

# ruby-on-rails - 如何替换 Ruby 中的重音拉丁字符？

> ID：225471
> 
> 赞同：79
> 
> 时间：2008-10-22T12:03:23.040
> 
> 标签：ruby-on-rails, ruby, activerecord, unicode, utf-8

我有一个`ActiveRecord`模型，`Foo`它有一个`name`字段。我希望用户能够按名称搜索，但我希望搜索忽略大小写和任何重音符号。因此，我还存储了一个`canonical_name`要搜索的字段：

```
class Foo
  validates_presence_of :name

  before_validate :set_canonical_name

  private

  def set_canonical_name
    self.canonical_name ||= canonicalize(self.name) if self.name
  end

  def canonicalize(x)
    x.downcase.  # something here
  end
end 
```

我需要填写“这里的东西”来替换重音字符。有什么比

```
x.downcase.gsub(/[àáâãäå]/,'a').gsub(/æ/,'ae').gsub(/ç/, 'c').gsub(/[èéêë]/,'e').... 
```

而且，就此而言，由于我不在 Ruby 1.9 上，我不能将那些 Unicode 文字放入我的代码中。实际的正则表达式会看起来更丑陋。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2011-08-23T11:47:19.760

`ActiveSupport::Inflector.transliterate`（需要 Rails 2.2.1+ 和 Ruby 1.9 或 1.8.7）

例子：

`>> ActiveSupport::Inflector.transliterate("àáâãäå").to_s => "aaaaaa"`

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2008-11-15T14:18:52.243

Rails 已经有一个用于规范化的内置函数，您只需使用它来规范化您的字符串以形成 KD，然后像这样删除其他字符（即重音符号）：

```
>> "àáâãäå".mb_chars.normalize(:kd).gsub(/[^\x00-\x7F]/n,'').downcase.to_s
=> "aaaaaa" 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2013-12-14T18:33:34.740

更好的是使用 I18n：

```
1.9.3-p392 :001 > require "i18n"
 => false
1.9.3-p392 :002 > I18n.transliterate("Olá Mundo!")
 => "Ola Mundo!" 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-09-10T14:43:03.430

我已经尝试了很多这样的方法，但他们没有达到这些要求中的一个或几个：

*   尊重空间
*   尊重 'ñ' 字符
*   尊重大小写（我知道不是原始问题的要求，但将字符串移动到*lowcase*并不难）

一直是这样的：

```
# coding: utf-8
string.tr(
  "ÀÁÂÃÄÅàáâãäåĀāĂăĄąÇçĆćĈĉĊċČčÐðĎďĐđÈÉÊËèéêëĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħÌÍÎÏìíîïĨĩĪīĬĭĮįİıĴĵĶķĸĹĺĻļĽľĿŀŁłÑñŃńŅņŇňŉŊŋÒÓÔÕÖØòóôõöøŌōŎŏŐőŔŕŖŗŘřŚśŜŝŞşŠšſŢţŤťŦŧÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųŴŵÝýÿŶŷŸŹźŻżŽž",
  "AAAAAAaaaaaaAaAaAaCcCcCcCcCcDdDdDdEEEEeeeeEeEeEeEeEeGgGgGgGgHhHhIIIIiiiiIiIiIiIiIiJjKkkLlLlLlLlLlNnNnNnNnnNnOOOOOOooooooOoOoOoRrRrRrSsSsSsSssTtTtTtUUUUuuuuUuUuUuUuUuUuWwYyyYyYZzZzZz"
) 
```

– [http://blog.slashpoundbang.com/post/12938588984/remove-all-accents-and-diacritics-from-string-in-ruby](http://blog.slashpoundbang.com/post/12938588984/remove-all-accents-and-diacritics-from-string-in-ruby)

您必须稍微修改字符列表以尊重“ñ”字符，但这很容易。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-07-23T12:07:55.117

我的回答：[String#parameterize](http://apidock.com/rails/ActiveSupport/Inflector/parameterize)方法：

```
"Le cœur de la crémiére".parameterize
=> "le-coeur-de-la-cremiere" 
```

对于非 Rails 程序：

安装activesupport：`gem install activesupport`然后：

```
require 'active_support/inflector'

"a&]'s--3\014\xC2àáâã3D".parameterize
# => "a-s-3-3d" 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-23T07:41:08.327

我认为您可能并不真正走这条路。如果您正在为具有此类字母的市场进行开发，您的用户可能会认为您是一种……*点子*。因为对于用户而言，“å”在任何意义上都不接近“a”。走一条不同的路，阅读有关以非 ascii 方式进行搜索的信息。这只是有人发明 unicode 和[collat](http://msdn.microsoft.com/en-us/library/ms187582.aspx) ​​ion 的案例之一。

**一个很晚的PS**：

[http://www.w3.org/International/wiki/Case_folding](http://www.w3.org/International/wiki/Case_folding) [http://www.w3.org/TR/charmod-norm/#sec-WhyNormalization](http://www.w3.org/TR/charmod-norm/#sec-WhyNormalization)

除此之外，我没有办法将排序规则的链接转到 msdn 页面，但我把它留在那里。应该是[http://www.unicode.org/reports/tr10/](http://www.unicode.org/reports/tr10/)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-01-15T15:37:14.523

分解字符串并从中删除[非间距标记](http://ruby.runpaint.org/regexps)。

```
irb -ractive_support/all
> "àáâãäå".mb_chars.normalize(:kd).gsub(/\p{Mn}/, '')
aaaaaa 
```

如果在 .rb 文件中使用，您可能还需要它。

```
# coding: utf-8 
```

此处的`normalize(:kd)`部分在可能的情况下拆分出变音符号（例如：“n with tilda”单个字符被拆分为 n，后跟一个组合变音符号 tilda 字符），然后该`gsub`部分删除所有变音字符。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-04-29T07:54:21.480

*这假设您使用 Rails。*

```
"anything".parameterize.underscore.humanize.downcase 
```

鉴于您的要求，这可能是我会做的……我认为它简洁、简单，并且会在 Rails 和 Ruby 的未来版本中保持最新。

更新：dgilperez 指出`parameterize`采用分隔符参数，因此`"anything".parameterize(" ")`（已弃用）`"anything".parameterize(separator: " ")`或更短且更清晰。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-22T14:52:42.077

将文本转换为规范化形式 D，删除所有带有 unicode 类别非间距标记 (Mn) 的代码点，然后将其转换回规范化形式 C。这将去除所有变音符号，您的问题将简化为不区分大小写的搜索。

详见[http://www.siao2.com/2005/02/19/376617.aspx](http://www.siao2.com/2005/02/19/376617.aspx)和[http://www.siao2.com/2007/05/14/2629747.aspx](http://www.siao2.com/2007/05/14/2629747.aspx)。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-23T18:59:30.800

关键是在数据库中使用两列：`canonical_text`和`original_text`. 用于`original_text`显示和`canonical_text`搜索。这样，如果用户搜索“Visual Café”，她就会看到“Visual Café”结果。如果她*真的*想要一个不同的物品，叫做“视觉咖啡馆”，可以单独保存。

要在 Ruby 1.8 源文件中获取 canonical_text 字符，请执行以下操作：

```
register_replacement([0x008A].pack('U'), 'S') 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-22T12:14:25.513

您可能需要 Unicode 分解（“NFD”）。分解字符串后，只需过滤掉不在 [A-Za-z] 中的任何内容。æ 将分解为“ae”，ã 分解为“a~”（大约 - 变音符号将成为单独的字符），因此过滤会留下合理的近似值。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-22T12:50:21.417

图标v：

[http://groups.google.com/group/ruby-talk-google/browse_frm/thread/8064dcac15d688ce](http://groups.google.com/group/ruby-talk-google/browse_frm/thread/8064dcac15d688ce)？

==============

我无法理解的 perl 模块：

[http://www.ahinea.com/en/tech/accented-translate.html](http://www.ahinea.com/en/tech/accented-translate.html)

=============

蛮力（有很多 htose 小动物！：

[http://projects.jkraemer.net/acts_as_ferret/wiki#UTF-8support](http://projects.jkraemer.net/acts_as_ferret/wiki#UTF-8support)

[http://snippets.dzone.com/posts/show/2384](http://snippets.dzone.com/posts/show/2384)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-08-29T12:48:51.453

对于任何阅读本文并希望删除所有非 ascii 字符的人来说，[这](http://www.jroller.com/obie/tags/unicode)可能很有用，我成功地使用了第一个示例。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-09-19T11:04:07.273

我无法让 foo.mb_chars.normalize(:kd).gsub(/[^\x00-\x7F]/n,'').downcase.to_s 解决方案正常工作。我没有使用 Rails，并且与我的 activesupport/ruby 版本存在一些冲突，我无法深入了解。

使用 ruby​​-unf gem 似乎是一个很好的替代品：

```
require 'unf'
foo.to_nfd.gsub(/[^\x00-\x7F]/n,'').downcase 
```

据我所知，这与 .mb_chars.normalize(:kd) 的作用相同。它是否正确？谢谢！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-12-08T21:06:55.850

**如果您使用 PostgreSQL** => 9.4 作为您的数据库适配器，也许您可​​以在迁移中添加它的[“unaccent”扩展](https://www.postgresql.org/docs/9.6/unaccent.html)，我认为它可以满足您的需求，如下所示：

```
def self.up
   enable_extension "unaccent" # No falla si ya existe
end 
```

为了测试，在控制台中：

```
2.3.1 :045 > ActiveRecord::Base.connection.execute("SELECT unaccent('unaccent', 'àáâãäåÁÄ')").first
 => {"unaccent"=>"aaaaaaAA"} 
```

请注意，到目前为止还区分大小写。

然后，也许在一个范围内使用它，比如：

```
scope :with_canonical_name, -> (name) {
   where("unaccent(foos.name) iLIKE unaccent('#{name}')")
} 
```

iLIKE 运算符使搜索不区分大小写。还有另一种方法，使用[citext](https://www.postgresql.org/docs/9.3/citext.html)数据类型。[这](https://stackoverflow.com/a/41691993/2553863)是关于这两种方法的讨论。还要注意[不推荐](https://www.postgresql.org/docs/9.3/citext.html)使用 PosgreSQL 的 lower() 函数。

这将为您节省一些数据库空间，因为您将不再需要 cannonical_name 字段，并且可能使您的模型更简单，但代价是在每个查询中进行一些额外处理，其数量取决于您使用的是 iLIKE 还是 citext，并且你的数据集。

**如果您使用 MySQL**，也许您可[​​以使用这个简单的解决方案](https://stackoverflow.com/a/4813651/2553863)，但我还没有测试过。

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2009-03-29T08:02:25.407

大声笑..我刚试过这个..它正在工作..我仍然不太清楚为什么..但是当我使用这4行代码时：

*   str = str.gsub(/[^a-zA-Z0-9 ]/,"")
*   str = str.gsub(/[ ]+/," ")
*   str = str.gsub(/ /,"-")
*   str = str.downcase

它会自动从文件名中删除任何重音..我试图删除（文件名中的重音并重命名它们）希望它有所帮助:)

# twitter - 保护桌面应用程序中的用户密码

> ID：225475
> 
> 赞同：3
> 
> 时间：2008-10-22T12:04:08.000
> 
> 标签：twitter, passwords, hash

我正在制作一个 twitter 客户端，并且正在评估保护用户登录信息的各种方法。

*   散列显然不这样做
*   以可逆的方式混淆就像试图躲在我的手指后面
*   纯文本听起来很混杂
*   要求用户每次都输入他的密码会使应用程序厌烦

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T12:09:25.917

您可以进行一些操作系统调用来为您加密密码。

在 Windows 上：

*   您可以加密文件（在 NTFS 文件系统上）
*   使用C中的[DPAPI](http://msdn.microsoft.com/en-us/library/ms995355.aspx)
*   通过使用[ProtectedData](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)类在 .Net 中使用 DPAPI

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T12:11:53.070

什么平台？

在 *nix 上，将密码以纯文本形式存储在主目录的子目录中 chmod 为 400 的文件中。参见例如 ~/.subversion。管理员无论如何都可以对用户做任何他们喜欢的事情，包括用他们自己的捕获密码的黑客版本替换你的程序，所以他们可以看到文件并没有什么坏处。请注意，取出该硬盘的人也可以访问该密码 - 如果这是一个问题，那么请让用户每次重新输入密码或检查此版本的 *nix 是否具有文件加密。

在 Windows Pro 上，将密码存储在加密文件中。

在 Windows 业余爱好者中，执行与 *nix 相同的操作。[编辑：正如 Aleris 建议的那样，CryptProtectData 看起来不错。如果它在所有 Windows 上都可用，那么它解决了仅支持加密文件的更昂贵版本的问题]。

在 Symbian 上，将密码存储在您的数据笼中。具有 AllFiles 权限的程序很少见，而且应该是值得信赖的，有点像 *nix 管理员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T12:13:31.290

CryptProtectData 是一个用于存储此类敏感数据的 windows 函数。

[http://msdn.microsoft.com/en-us/library/aa380261.aspx](http://msdn.microsoft.com/en-us/library/aa380261.aspx)

例如，看看 Chrome 如何使用它：
[http ://blog.paranoidferret.com/index.php/2008/09/10/how-google-chrome-stores-passwords/](http://blog.paranoidferret.com/index.php/2008/09/10/how-google-chrome-stores-passwords/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T12:15:01.690

对于 Windows：使用 DPAPI（用户存储）加密密码并将其存储在您的设置文件或其他位置。这将在每个用户的基础上工作，例如，同一台机器上的不同用户将拥有不同的不相关的加密密钥。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T12:08:01.660

你不能一边吃蛋糕一边吃。要么存储密码（您已排除），要么不存储并要求每次都输入密码（您已排除）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T12:14:14.750

拥有一个好的对称加密方案，它应该使解密不值得尝试的凭据变得足够困难。否则，如果服务只需要通过网络发送散列，您可以加密存储 hast。这样，即使是解密也不会让攻击者更接近解决方案。但是其他用户是真实的。如果您存储数据，则可以找到它。关键是在安全性和可用性之间找到平衡。

# c++ - 在代码中嵌入图像，不使用资源部分或外部图像

> ID：225480
> 
> 赞同：4
> 
> 时间：2008-10-22T12:06:09.353
> 
> 标签：c++, visual-c++, mfc

我正在寻找一种将图像嵌入库中的方法（仅限 Windows）。我不想采用“传统”方式将其放入资源中（因为特殊情况使得弄乱资源句柄不太方便。

理想情况下，会有类似 xpm 文件的东西：一个图像的“文本”表示，它放在 ac 数组中，一些代码转换为内存中的位图，然后可以以某种方式加载到 HIMAGE 或 HICON 中。我要嵌入的图像是 32 位位图 (bmp)。有任何想法吗？我正在使用 MFC，所以 MFC 库会很好，但当然我也可以使用不使用 MFC 的库。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T13:09:08.477

谷歌的 bin2c 实用程序（类似于[http://stud3.tuwien.ac.at/~e0025274/bin2c/bin2c.c](http://stud3.tuwien.ac.at/~e0025274/bin2c/bin2c.c)）。它采用文件的二进制表示并输出一个 C 源文件，其中包含初始化为该数据的字节数组。

只需将文件链接进去，您的图像就会放在一大块内存中。

在嵌入式系统上使用这种工具非常普遍，在这些系统中，诸如“资源”甚至文件之类的东西可能不存在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T14:02:39.727

[Gimp](http://www.gimp.org/)可以导出为 C 文件。我认为这将是最简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-16T15:27:23.980

开源应用程序 Hexy 就是专门为此设计的。它在windows和linux上运行。[https://github.com/tristan2468/Hexy](https://github.com/tristan2468/Hexy)

# c# - 如何检查 ObjectQuery 中是否存在 OrderBy 表达树

> ID：225481
> 
> 赞同：6
> 
> 时间：2008-10-22T12:06:33.050
> 
> 标签：c#, linq, generics, linq-to-entities, code-generation

我正在使用 T4 为 LINQ to Entities 实体生成存储库。

存储库包含（除其他外）适合分页的 List 方法。[Supported and Unsupported Methods](http://msdn.microsoft.com/en-us/library/bb738474.aspx)的文档没有提到它，但你不能`Skip`在 unordered 上“调用” `IQueryable`。它将引发以下异常：

> System.NotSupportedException：方法“Skip”仅支持 LINQ to Entities 中的排序输入。方法 'OrderBy' 必须在方法 'Skip' 之前调用。

我通过允许通过部分方法定义默认排序来解决它。但是我在检查表达式树是否确实包含`OrderBy`.

我已将问题减少到尽可能少的代码：

```
public partial class Repository
{
    partial void ProvideDefaultSorting(ref IQueryable<Category> currentQuery);

    public IQueryable<Category> List(int startIndex, int count)
    {
        IQueryable<Category> query = List();
        ProvideDefaultSorting(ref query);
        if (!IsSorted(query))
        {
            query = query.OrderBy(c => c.CategoryID);
        }
        return query.Skip(startIndex).Take(count);
    }
    public IQueryable<Category> List(string sortExpression, int startIndex, int count)
    {
           return List(sortExpression).Skip(startIndex).Take(count);
    }
    public IQueryable<Category> List(string sortExpression)
    {
        return AddSortingToTheExpressionTree(List(), sortExpression);
    }
    public IQueryable<Category> List()
    {
           NorthwindEntities ent = new NorthwindEntities();
           return ent.Categories;
    }

    private Boolean IsSorted(IQueryable<Category> query)
    {
        return query is IOrderedQueryable<Category>; 
    }
}

public partial class Repository
{
    partial void ProvideDefaultSorting(ref IQueryable<Category> currentQuery)
    {
        currentQuery = currentQuery.Where(c => c.CategoryName.Contains(" ")); // no sorting..
    }
} 
```

这不是我真正的实现！

但我的**问题**是，我该如何实现该`IsSorted`方法？问题是 LINQ to Entities 查询始终是类型`ObjectQuery`，它实现了`IOrderedQueryable`.

那么我应该如何确保`OrderBy`表达式树中存在方法呢？是解析树的唯一选择吗？

**更新**
我添加了另外两个重载以明确这不是关于如何向存储库添加排序支持，而是如何检查`ProvideDefaultSorting`部分方法是否确实向`OrderBy`表达式树添加了一个。

问题是，第一个部分类是由模板生成的，而部分类的第二部分的实现是由团队成员在另一个时间完成的。您可以将其与 .NET Entity Framework 生成 EntityContext 的方式进行比较，它允许为其他开发人员提供扩展点。因此，我想尝试使其健壮，并且在`ProvideDefaultSorting`未正确实施时不会崩溃。

所以也许问题更多，我怎样才能确认`ProvideDefaultSorting`确实向表达式树添加了排序。

**更新 2**
新问题已得到回答并被接受，我想我应该更改标题以更匹配问题。或者我应该留下当前的标题，因为它会引导有同样问题的人使用这个解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T13:36:35.707

分页强烈依赖于 Ordering。为什么不将操作紧密耦合？这是一种方法：

支持对象

```
public interface IOrderByExpression<T>
{
  ApplyOrdering(ref IQueryable<T> query);
}

public class OrderByExpression<T, U> : IOrderByExpression<T>
{
  public IQueryable<T> ApplyOrderBy(ref IQueryable<T> query)
  {
    query = query.OrderBy(exp);
  }
  //TODO OrderByDescending, ThenBy, ThenByDescending methods.

  private Expression<Func<T, U>> exp = null;

  //TODO bool descending?
  public OrderByExpression (Expression<Func<T, U>> myExpression)
  {
    exp = myExpression;
  }
} 
```

正在讨论的方法：

```
public IQueryable<Category> List(int startIndex, int count, IOrderByExpression<Category> ordering)
{
    NorthwindEntities ent = new NorthwindEntities();
    IQueryable<Category> query = ent.Categories;
    if (ordering == null)
    {
      ordering = new OrderByExpression<Category, int>(c => c.CategoryID)
    }
    ordering.ApplyOrdering(ref query);

    return query.Skip(startIndex).Take(count);
} 
```

一段时间后，调用该方法：

```
var query = List(20, 20, new OrderByExpression<Category, string>(c => c.CategoryName)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:10:03.733

恐怕比这更难一些。您会看到，实体框架在某些情况下会[默默地忽略 OrderBy。](http://msdn.microsoft.com/en-us/library/bb896317.aspx#OrderingInfoLost)因此，仅在表达式树中查找 OrderBy 是不够的。OrderBy 必须在“正确”的地方，而“正确”的地方的定义是实体框架的一个实现细节。

你现在可能已经猜到了，我和你在同一个地方；我正在使用实体存储库模式并在表示层上执行 Take/Skip。我使用的解决方案可能并不理想，但对于我正在做的事情来说已经足够好了，就是在可能的最后一刻之前不进行任何排序，以确保 OrderBy 始终是表达式树中的最后一件事。因此，任何要执行 Take/Skip（直接或间接）的操作都会首先插入 OrderBy。代码的结构使得这种情况只能发生一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T17:02:17.180

您可以在 ProvideDefaultSorting 的返回类型中解决此问题。此代码不构建：

```
 public IOrderedQueryable<int> GetOrderedQueryable()
    {
        IQueryable<int> myInts = new List<int>() { 3, 4, 1, 2 }.AsQueryable<int>();
        return myInts.Where(i => i == 2);
    } 
```

这段代码可以构建，但很隐蔽，编码人员得到了他们应得的。

```
 public IOrderedQueryable<int> GetOrderedQueryable()
    {
        IQueryable<int> myInts = new List<int>() { 3, 4, 1, 2 }.AsQueryable<int>();
        return myInts.Where(i => i == 2) as IOrderedQueryable<int>;
    } 
```

* * *

与 ref 相同的故事（这不会建立）：

```
 public void GetOrderedQueryable(ref IOrderedQueryable<int> query)
    {
        query = query.Where(i => i == 2);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T19:13:31.097

感谢 David B，我得到了以下解决方案。（我必须为部分方法未执行或仅返回其参数的情况添加检测）。

```
public partial class Repository
{
    partial void ProvideDefaultSorting(ref IOrderedQueryable<Category> currentQuery);

    public IQueryable<Category> List(int startIndex, int count)
    {
        NorthwindEntities ent = new NorthwindEntities();
        IOrderedQueryable<Category> query = ent.CategorySet;
        var oldQuery = query;
        ProvideDefaultSorting(ref query);
        if (oldQuery.Equals(query)) // the partial method did nothing with the query, or just didn't exist
        {
            query = query.OrderBy(c => c.CategoryID);
        }
        return query.Skip(startIndex).Take(count);
    }
    // the rest..        
}

public partial class Repository
{
    partial void ProvideDefaultSorting(ref IOrderedQueryable<Category> currentQuery)
    {
        currentQuery = currentQuery.Where(c => c.CategoryName.Contains(" ")).OrderBy(c => c.CategoryName); // compile time forced sotring
    }
} 
```

它确保在编译时，如果实现了部分方法，它至少应该将其保持为 IOrderdQueryable。

并且当分部方法没有实现或者只返回它的参数时，查询不会改变，这将使用回退排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:39:33.510

```
 ProvideDefaultSorting(ref query);
    if (!IsSorted(query))
    {
            query = query.OrderBy(c => c.CategoryID);
    } 
```

改成：

```
 //apply a default ordering
    query = query.OrderBy(c => c.CategoryID);
    //add to the ordering
    ProvideDefaultSorting(ref query); 
```

这不是一个完美的解决方案。

它不能解决您所说的“排序函数中的过滤器”问题。它确实解决了“我忘记执行订购”或“我选择不订购”的问题。

我在 LinqToSql 中测试了这个解决方案：

```
 public void OrderManyTimes()
    {
        DataClasses1DataContext myDC = new DataClasses1DataContext();
        var query = myDC.Customers.OrderBy(c => c.Field3);
        query = query.OrderBy(c => c.Field2);
        query = query.OrderBy(c => c.Field1);

        Console.WriteLine(myDC.GetCommand(query).CommandText);

    } 
```

生成（注意排序的相反顺序）：

```
SELECT Field1, Field2, Field3
FROM [dbo].[Customers] AS [t0]
ORDER BY [t0].[Field1], [t0].[Field2], [t0].[Field3] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-19T17:19:46.330

我已经实现了一个解决方案，该解决方案通过其主键对任何集合进行排序，因为未指定默认排序顺序。也许这对你有用。

请参阅[http://johnkaster.wordpress.com/2011/05/19/a-bug-fix-for-system-linq-dynamic-and-a-solution-for-the-entity-framework-4-skip-problem /](http://johnkaster.wordpress.com/2011/05/19/a-bug-fix-for-system-linq-dynamic-and-a-solution-for-the-entity-framework-4-skip-problem/)用于讨论和通用代码。（以及一个附带的动态 LINQ 错误修复。）

# .net - 分发 .Net 二进制文件和 PDB 的最佳方式是什么？

> ID：225488
> 
> 赞同：2
> 
> 时间：2008-10-22T12:08:03.593
> 
> 标签：.net, packaging, pdb-files

[我们在这里](https://stackoverflow.com/questions/88950/is-there-any-reason-to-not-ship-the-pdbs-with-your-application)已经有一个类似的问题，但讨论并没有涵盖所有方面，所以我再次问：

*考虑到构建模式（发布与调试）和 PDB 文件的分发，分发 .Net 应用程序的最佳方式是什么？*对涵盖这些方面的文章有很好的参考会很棒。

还要考虑 Web 应用程序的分布与 Windows 窗体应用程序的分布。

提前致谢

马西莫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T13:30:31.227

不应分发调试版本，它们实际上是供您自己查看的。但是，一旦您使用符号构建发布版本并从中生成 .pdb，您就可以保留 pdb 并愉快地发布 dll。

如果您将 .pdbs 存储在符号服务器中（请参阅这篇出色的[bugslayer 文章](http://msdn.microsoft.com/en-gb/magazine/cc301459.aspx)），那么您无需担心哪些符号与哪个版本的 dll 匹配，因为调试器会为您处理这些问题。

如果您的应用程序崩溃，请让 DrWatson 生成一个 minidump（运行 DrWtsn32.exe，选中 minidump 复选框），将该转储发送给您，然后在 windbg 中加载它。它将向您显示异常、堆栈跟踪、变量、寄存器、线程、批次（嗯，不是批次，因为您需要一个完整的故障转储，但它们相当大，小型转储具有所有有用信息的一小部分大小）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T12:25:56.367

不应分发调试版本 - 您可能无权这样做。使用符号服务器最容易分发 PDB。

# java - 如何在 Java ME 中获取异常堆栈跟踪的文本？

> ID：225489
> 
> 赞同：8
> 
> 时间：2008-10-22T12:08:26.090
> 
> 标签：java, java-me

在常规 Java 中，您可以通过将 PrintWriter 传递给 printStackTrace 来获取堆栈跟踪的文本。我有一种感觉，我知道这个问题的答案（即“不”），但是，

有什么方法可以将 JavaME 中的堆栈跟踪文本作为字符串获取？

**更新：**

我应该提到我仅限于 CLDC 1.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T15:18:47.360

两种解决方案：

*   在模拟器上重现异常。无线工具包和 Netbeans 将在您的计算机上打印堆栈跟踪。

*   使用 Symbian 设备。

在 Series 60 第三版的 Feature Pack 2 之前，Symbian 手机使用 Sun Hotspot java 虚拟机。它通过将它链接到 C 标准库的部分实现来适应 Symbian OS。

这使得 Symbian 可以创建一个名为 redirector 的 C++ 程序，该程序能够捕获 VM 标准输出和标准错误，包括 java 异常堆栈跟踪。

C++ 重定向器从未升级到 Symbian OS 版本 9。取而代之的是，在 VM 中引入了“redirect://”GCF 协议，

从一个单独的 MIDlet，从 Connector.open("redirect://", Connector.READ); 返回的连接打开一个 InputStream；然后，您可以在 Symbian 手机上捕获异常堆栈跟踪。

编辑：“redirect://”又回到了 Series60 第 5 版，“redirect://test”应该在 Series60 第 3 版功能包 2 上工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:00:18.203

AFAIK 无法将堆栈跟踪作为字符串值获取，除非特定平台提供了覆盖默认 System.err 流的方法。在 BlackBerry 平台上，它会抛出堆栈跟踪`catch(Exception)`以节省内存，但它不会这样做，而是`catch(Throwable)`通过设备事件日志访问堆栈跟踪。

我最终做的是在最后一刻捕获 Throwable 而不是 Exception 并从那里打印堆栈跟踪。这当然有危险，你也捕捉到`java.lang.Error`它不是很好，特别是如果它`OutOfMemoryError`，虽然在打印堆栈跟踪之前调用 to`System.gc()`似乎降低了风险，而且我们没有遇到任何问题。

我会查看您所针对的任何平台，看看他们是否可以在某处访问 System.err。你总是可以连接一个调试器，它应该出现在控制台输出上，尽管听起来你是在“现场”获取堆栈跟踪之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:40:24.937

我不认为在 CLDC 1.0 中有办法做到这一点。但是，在某些设备/操作系统上，底层 Exception 类可能会提供一种访问堆栈跟踪的方法（想想更新的 CLDC 版本）。只需在运行时使用反射检查异常实例，即可查看它在目标平台上公开了哪些成员。然后，您可以编写一些代码，以便能够在提供此类信息的平台上安全地提取堆栈跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-06T14:09:28.360

我创建了一个工具，可用于在 CLDC 中记录正确的堆栈跟踪。[在http://jarrut.sourceforge.net](http://jarrut.sourceforge.net)上查看。它仍然很新，可能有一些粗糙的边缘，但它对我有用，我无法想象没有它来开发 MIDlet。使用它的最佳方法是将其与 microlog 结合使用。

不幸的是，该工具目前需要 CLDC 1.1，因此它可能无法解决原始海报的问题。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-22T12:21:45.673

您可以让 PrintWriter 写入 ByteArrayOutputStream 并从字节重建字符串。

```
try{
    throw new Exception("Message");     
} catch (Exception ex){
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    ex.printStackTrace(new PrintStream(out));
    System.out.println(new String(out.toByteArray()));
} 
```

它不漂亮，但它应该在任何地方都可以工作。在尝试上述方法之前，请确保您无权访问 [Throwable#getStackTrace]( [http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Throwable.html#getStackTrace ())](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Throwable.html#getStackTrace()))，Eclipse 声称它在 CDC/Foundation 1.1 中可用，但这并没有说明其他配置文件。

# security - IIS 6.0 集成身份验证：401.1 和 IE7

> ID：225496
> 
> 赞同：3
> 
> 时间：2008-10-22T12:09:38.940
> 
> 标签：security, iis

今天我将 ASP.NET 应用程序的应用程序池标识从“网络服务”更改为域用户。

我将用户添加到本地组“IIS_WPG”，为了以防万一，完成了 iisreset，一切都可以在 IE6 和 Firefox 3.0 上正常运行

但是当我使用 IE7 访问网站时，会出现一个身份验证弹出窗口，我输入我的凭据，然后：

```
HTTP Error 401.1 - Unauthorized: Access is denied due to invalid credentials. Internet Information Services (IIS) 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T01:53:02.320

通常，如果您发现身份验证在 IE 6 中有效但在 IE 7 中无效，我会检查以确保 Kerberos 配置正确。

作为网络服务运行，您的 Kerberos SPN 应附加到计算机帐户。作为域帐户，SPN 需要在该帐户上。

至于为什么 IE 6 与 IE 7 不同，这很可能是由于某些适用于 CNames 和票证超时的 Kerberos HotFixes。在 MS 支持中搜索“kerberos HotFix”

要为站点关闭 Kerberos：

cscript adsutil.vbs 设置 w3svc/###/NTAuthenticationProviders “NTLM”

其中 ### 是 MetaBase 中的 SiteID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T06:48:43.410

您可以尝试在选项、高级设置中禁用“启用集成身份验证”。但是不知道有没有副作用。

# xaml - Scrolling Text Block/Area/Div in Loose XAML

> ID：225513
> 
> 赞同：2
> 
> 时间：2008-10-22T12:15:44.653
> 
> 标签：xaml, scroll

Is there any way to display scrollabletext in loose xaml? The equivalent in HTML would be

```
<div style="overflow:scroll">some long bit of text here</div> 
```

Can you do this in loose xaml?

From my experiments so far it seems that in loose xaml:

1.  You cannot use TextBox -- it must be TextBlock.
2.  TextBlock doesn't seem to have any styling settings which would make it scrollable.
3.  ScrollViewer doesn't seem to be allowed in loose xaml.

Any help gratefully appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T12:29:17.450

You can use a textbox for scrolling text e.g.:

```
<TextBox Text="{Binding YourText}" VerticalContentAlignment="Top"
 TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
MaxHeight="200" MaxWidth="300"/> 
```

This will show scrollbars if your text doesn't fit in the displayed area.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T05:52:21.587

```
<ScrollViewer Height="239" VerticalScrollBarVisibility="Auto">
<toolkit:PhoneTextBox x:Name="newcTextBox" AcceptsReturn="True"  TextWrapping="Wrap"/>
</ScrollViewer> 
```

# sql - 从单独的列构建视图列

> ID：225535
> 
> 赞同：4
> 
> 时间：2008-10-22T12:25:14.667
> 
> 标签：sql, sql-server, views

在我们的数据库中，我们设置了一个系统来跟踪应用程序。我们有一个 bool 列，指示应用程序是否被批准。然后还有另一列指示申请是否被拒绝。如果两列都不为真，则认为该应用程序处于待处理状态。

有没有什么简单的方法可以在视图中将它们合并为一个值（比如一个 tinyint 或者一个字符串，上面写着“已批准”、“拒绝”或“待定”）？或者这需要像表值函数这样的东西吗？

**更新：**很难选择答案选择，因为它们都很有帮助。自从他第一次发布以来，我会选择baldy。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T12:39:07.430

您可以使用这样的 case 语句：

```
select case 
  when Approved = 1 then 'Approved'
  when Denied = 1 then 'Denied'
  else 'Pending'
  end 'Status' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T12:47:46.930

由于您同时存储了 Approved 和 Denied 值，因此您必须担心排序（如果两者都为 True，则优先级？）。您*绝对*应该只将其放入 View 中，这样您以后不必重复该逻辑。

根据 NTFS 权限，我总是更喜欢 Deny 优先：

```
CASE 
    --Denied has precedence
    WHEN Denied = 1 THEN 'Denied'
    WHEN Approved = 1 THEN 'Approved'
    ELSE 'Pending'
END as Status 
```

除非您有其他要求排除它，否则我更喜欢 Baldy 关于可为空的 int 或检查约束 tinyint 列的建议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T12:38:07.370

您可以在查询中使用 case 语句：select case approved when 1 then 'Approved' else ...

Case 语句可以嵌套，因此您可以深入研究不同的选项。

为什么不使用具有 3 个不同值的 int 列，或者您甚至可以使用一个 bool 列，启用 null。当为 null 时，它处于待处理状态，1 批准，0 拒绝。

# shell - 如何使失败的 $(shell) 命令中断

> ID：225542
> 
> 赞同：25
> 
> 时间：2008-10-22T12:29:03.847
> 
> 标签：shell, makefile

我有一个 Makefile，它首先在应用构建规则（该工具为我编写）之前运行一个工具。如果这个工具（它是一个 python 脚本）以非空状态码退出，我希望 GNU Make 停在那里而不继续构建程序。

目前，我做这样的事情（顶级，即第1列）：

```
$(info Generating build rules...)
$(shell python collect_sources.py)
include BuildRules.mk 
```

但这不会停止 make if`collect_sources.py`以状态码 1 退出。这也捕获了标准输出，`collect_sources.py`但不会将其打印出来，所以我觉得我看错了方向。

如果可能的话，当一个简单的 MS-DOS shell 是标准系统 shell 时，该解决方案甚至应该可以工作。

有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T12:58:42.337

可能有更好的方法，但我尝试了以下方法并且它有效：

```
$(if $(shell if your_command; then echo ok; fi), , $(error your_command failed)) 
```

在这里，我确实假设它`your_command`没有给出任何输出，但解决这种情况应该不难。

编辑：要使其与默认的 Windows shell（可能还有任何像样的 shell）一起工作，您可以编写`your_command && echo ok`而不是`if`在`shell`函数内编写。我认为这对于（旧的）DOS shell 是不可能的。对于这些，您可能想要调整`your_command`或编写一个包装脚本来打印错误（或成功）的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T18:22:46.100

您应该使用常规目标来创建 BuildRules.mk：

```
BuildRules.mk: collect_sources.py
        python $< >$@

include BuildRules.mk 
```

这是自动生成依赖项时使用的标准技巧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T16:35:36.487

好的，这是我自己的解决方案，不幸的是，它不是基于 collect_sources.py 脚本的状态代码，而是适用于我 (TM) 并让我看到脚本产生的任何输出：

```
SHELL_OUTPUT := $(shell python collect_sources.py 2>&1)
ifeq ($(filter error: [Errno %],$(SHELL_OUTPUT)),)
  $(info $(SHELL_OUTPUT))
else
  $(error $(SHELL_OUTPUT))
endif 
```

编写脚本以便任何错误都会产生以 . 开头的输出`"collect_sources: error:"`。此外，如果 python 无法找到或执行给定的脚本，它会输出一条包含该消息`"[Errno 2]"`或类似内容的错误消息。所以这段小代码只是捕获输出（将stderr重定向到stdout）并搜索错误消息。如果没有找到，它只是用于`$(info)`打印输出，否则它使用`$(error)`，这有效地使 Make 停止。

请注意， 中的缩进`ifeq ... endif`是用空格完成的。如果使用了制表符，Make 会认为您正在尝试调用命令并抱怨它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-22T08:09:41.867

修复[https://stackoverflow.com/a/226974/192373](https://stackoverflow.com/a/226974/192373)

```
.PHONY: BuildRules.mk

BuildRules.mk: collect_sources.py
        echo Generating build rules...)
        python $< >$@
        $(MAKE) -f BuildRules.mk 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-22T18:35:02.877

确保您没有使用 -k 选项调用 make/gmake。

# c# - 检测在 C# 库的主线程中运行

> ID：225545
> 
> 赞同：7
> 
> 时间：2008-10-22T12:29:50.273
> 
> 标签：c#, .net, winforms, multithreading

我正在创建一个 C# dll，它将被其他开发人员在 WinForms 中使用。出于某些原因，我想检测是否从主（GUI）线程调用了该库中的方法，并警告开发人员他做了这样的事情（即在日志文件中）。有什么合理的方法来检测主线程的调用方法吗？请记住，我无法访问 WinForm 应用程序。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-22T12:35:53.380

在这种情况下，一个简单的解决方案是在主 UI 线程上创建的库程序集中声明一个静态控件。如果要检测是否从主线程调用了该库，请使用以下命令

```
if (MyLibraryControl.InvokeRequired)
  //do your thing here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T12:38:24.093

最简单的选项（如果您手边有一个表单/控件）是检查 InvokeRequired。

如果没有，您可以尝试使用`SynchronizationContext`模拟 Post 或 Send，检查发生在哪个线程上？调用 Send 或 Post 将切换到 UI 线程。

# css - 图像替换时弹出的文本

> ID：225547
> 
> 赞同：1
> 
> 时间：2008-10-22T12:31:37.040
> 
> 标签：css

我为我的一个链接使用了标准图像替换技术（嵌套跨度技术），但由于图像的边缘是圆形且透明的，因此底层文本链接正在弹出。

这是我的截图，解释了我的意思。

[http://dl.getdropbox.com/u/240752/peepo.gif](http://dl.getdropbox.com/u/240752/peepo.gif)

隐藏此文本的最佳方法是什么？我不想将`display:none`其用作不好的做法，而且我感觉将文本大小设置为 0 也是不行的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T12:34:25.023

最简单的解决方案是使用另一种图像替换技术，例如给文本一个非常大的`text-indent`值。有关技术及其权衡的综合列表，请参阅[Mezzoblue 。](http://www.mezzoblue.com/tests/revised-image-replacement/)

或者，您可以在样式表的部分中提供该`display: none`属性。`@media screen`这意味着它不应该应用于屏幕阅读器（因为它们应该是 media type `aural`）。但是，我无法验证当前的屏幕阅读器是否真的有这种（预期的）行为。

# algorithm - 图像失真算法的资源

> ID：225548
> 
> 赞同：22
> 
> 时间：2008-10-22T12:31:37.557
> 
> 标签：algorithm, image, graphics, image-processing

我在哪里可以找到图像失真的算法？Blur 和其他经典算法的信息很多，但更复杂的算法却很少。特别是，我对漩涡效应图像失真算法感兴趣。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-22T12:41:10.187

我找不到任何参考资料，但我可以大致了解失真效果的工作原理。

失真的关键是一个函数，它取失真图像中的两个坐标 (x,y)，并将它们转换为原始图像中的坐标 (u,v)。这指定了失真的反函数，因为它将失真图像带回原始图像

为了生成失真图像，循环 x 和 y，使用逆失真函数从 (x,y) 计算点 (u,v)，并将 (x,y) 处的颜色分量设置为与那些相同在原始图像中的 (u,v) 处。通常使用插值（例如[http://en.wikipedia.org/wiki/Bilinear_interpolation](http://en.wikipedia.org/wiki/Bilinear_interpolation)）来确定 (u,v) 处的颜色，因为 (u,v) 通常不完全位于像素的中心，但是而不是在像素之间的某个分数点。

漩涡本质上是一种旋转，其中旋转角度取决于与图像中心的距离。一个例子是：

```
a = amount of rotation
b = size of effect

angle = a*exp(-(x*x+y*y)/(b*b))
u = cos(angle)*x + sin(angle)*y
v = -sin(angle)*x + cos(angle)*y 
```

在这里，为了简单起见，我假设漩涡的中心在 (0,0)。漩涡可以放在任何地方，方法是在失真函数之前从 x 和 y 中减去漩涡位置坐标，然后将它们添加到 u 和 v 之后。

周围有各种漩涡效果：一些（如上图）仅在局部区域产生漩涡，并且漩涡的量向图像边缘逐渐减小。其他人则增加了朝向图像边缘的漩涡。这种事情可以通过使用 angle= 线来完成，例如

```
angle = a*(x*x+y*y) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-22T16:28:40.307

[Jerry's Java Image Filters](http://www.jhlabs.com/ip/filters/index.html "Jerry 的 Java 图像处理页面")有很多图像过滤器/效果的 Java 实现。也许你可以从那里得到灵感。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T12:44:56.280

漩涡和其他类似的东西是像素位置的矩阵变换。您制作一个新图像并从图像上的某个位置获取颜色，该位置是通过将当前位置乘以矩阵获得的。

矩阵取决于当前位置。

这是一个很好的 CodeProject 展示如何做到这一点

[http://www.codeproject.com/KB/GDI-plus/displacementfilters.aspx](http://www.codeproject.com/KB/GDI-plus/displacementfilters.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-13T05:11:20.267

有一个新的图形库有很多功能

[http://code.google.com/p/picasso-graphic/](http://code.google.com/p/picasso-graphic/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T12:41:35.227

看看[ImageMagick](http://www.imagemagick.org/script/index.php)。它是一个图像转换和编辑工具包，具有所有流行语言的接口。

-displace 运算符可以使用正确的置换贴图创建漩涡。

如果您出于某种原因对 ImageMagick 界面不满意，您可以随时查看过滤器的源代码并从那里开始。

# .net - How to close a .Net Form from its PreFilterMessage()?

> ID：225550
> 
> 赞同：0
> 
> 时间：2008-10-22T12:32:15.057
> 
> 标签：.net, window, messages

I'm filtering the messages that come to a form with PreFilterMessage like this:

`print("code sample");`

```
 public bool PreFilterMessage(ref Message m) 
 {
     if (m.Msg == WM_KEYDOWN && (int)m.WParam == VK_ESCAPE)
     {
         this.Close();
         return true;
     }
     return false;
 } 
```

`print("code sample");`

but the matter is that form closes only for the first time. After reopening a form it won't close anymore by pressing ESC.

How can I accomplish this?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T12:44:40.807

I don't know if this fits with what you are doing. I usually set Form.CancelButton to the close or cancel button on my form, and it will automatically call the button OnClick when the user hits Esc on the keyboard.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T03:27:09.323

根据 MSDN

> 表单未在 Close 上处理的两种情况是： (1) 它是多文档界面 (MDI) 应用程序的一部分，并且表单不可见；(2) 您已经使用 ShowDialog 显示了表单。在这些情况下，您将需要手动调用 Dispose 以将表单的所有控件标记为垃圾回收。

如果您确实使用 向您展示了表单`ShowDialog()`，则调用`Close()`不会从您的表单中删除。您仍然可以稍后“重新打开”它，并且可能这就是您正在做的事情。我怀疑您`PreFilterMessage()`在第一次关闭它时可能会打扰它。您是否检查过消息循环是否仍在工作？或者你实际上应该做`this.Visible = false;`or `Control.Hide`,

> 当在显示为无模式窗口的窗体上调用 Close 方法时，您不能调用 Show 方法使窗体可见，因为窗体的资源已被释放。要隐藏窗体然后使其可见，请使用 Control..::.Hide 方法。

因为您需要稍后“重新打开”它。如果您实际上希望表单 dispose 关闭，并稍后显示一个新实例，然后在关闭后手动调用 dispose

# jakarta-ee - How can you uniquify context-root on jBoss

> ID：225559
> 
> 赞同：2
> 
> 时间：2008-10-22T12:36:31.057
> 
> 标签：jakarta-ee, jboss

Say I have a simple j2EE ear:

```
foo.ear
- foo.war 
```

I would like to deploy the same ear twice so I rename the ear:

```
bar.ear
- foo.war 
```

The `META-INF\application.xml` file looks like this:

```
<application>
    <module>
        <web>
            <web-uri>foo.war</web-uri>
            <context-root>/baz</context-root>
        </web>
    </module>
</application> 
```

When I deploy there is a collison, both apps will try to mount at `http://localhost:8080/baz`. Is there a way to prefix the ear name to the context-root to get `foo/baz` and `bar/baz`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T14:42:56.573

如何在构建时通过生成*application.xml*来设置它？Ant 可以通过过滤器轻松做到这一点，在

```
<context-root>@context.root@</context-root> 
```

在 Ant 构建脚本中，执行以下操作：

```
<copy todir="${ear.dir}/META-INF" file="${ear}/META-INF/application.xml" overwrite="true">
    <filterset>
        <filter token="context.root" value="${context.root}" />
    </filterset>
</copy> 
```

# php - 是否有 PHP 函数可以从数组中删除任何/所有具有特定值的键/值对？

> ID：225560
> 
> 赞同：0
> 
> 时间：2008-10-22T12:36:39.933
> 
> 标签：php, arrays

我认为这样的问题是我不喜欢使用 PHP 的原因。手册很好，如果你能找到你要找的东西。通读[Array Functions](http://us3.php.net/array)后，我没有看到提供我需要的功能的功能。

我有一个数组（在我的例子中，是数字索引的），我想扫描一个特定的值，如果它在那里，删除它。然后，当该值的所有实例都被删除时，我想使用[array_values](http://us3.php.net/manual/en/function.array-values.php)重新排列数组。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T12:38:31.893

[`array_diff`](http://de.php.net/array_diff)是你想要的。

```
$array1 = array("a" => "green", "red", "blue", "red");
$array2 = array("b" => "green", "yellow", "red");
$result = array_diff($array1, $array2); 
```

结果：`"blue"`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T13:00:21.337

只是为了补充这个......

array_diff 似乎显示了第一个数组中没有出现在第二个数组中的元素。它不显示仅出现在一个或另一个数组中的那些元素。

例如

```
<?
$test = "hello";
$array1 = array("a" => "green", "red", "bicycle", "red");
$array2 = array("b" => "green", "yellow", "red", "blue", "yellow", "pink");
$result = array_diff($array1, $array2);
print_r ($result);
?> 
```

返回

```
Array
(
    [1] => bicycle
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T14:11:48.867

我喜欢 array_diff 函数，但如果你不想传递一个数组，我有一个脚本：

```
function array_unset_value($value, &$array) {
    $key = array_search($value, $array);
    while ($key !== false) {
        unset($array[$key]);
        $key = array_search($value, $array);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:13:25.667

array_filter 为您执行此操作。你只需要提供一个过滤回调函数：

```
function myFilter($Value){
   if($Value == 'red'){
      return false;
   }
   return true;
}

$Values = array("a" => "green", "red", "bicycle", "red");

$Values = array_filter($Values, 'myFilter'); 
```

返回：

```
array {
  ["a"] => "green"
  [1]   => "bicycle"
} 
```

对于要保留的值，过滤器函数应返回 true，对于要删除的值，应返回 false。然后继续使用 array_values 重新索引数组。例如

```
$Values = array_values(array_filter($Values, 'myFilter')); 
```

如果您在对象中执行此操作，并且想要在对象中调用过滤器方法，则可以使用此表单进行回调：

```
array_filter($Values, array($this,'myFilter')); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-16T15:23:59.820

重建这个“不可能”的函数，我建议：
function pf_cleanarray($arraytoclean=false,$to_explode=false,$delimiter=false) { /* PortalPress.org 2011 [请保留此评论] - 清理一个数组为 NULL 或创建一个包含内容的数组；小心使用，最好不要使用取决于 [associative] 数组的偶数长度

它看起来很糟糕，我知道，尤其是在 Stackoverflow 上没有缩进。但是在重建时，它可能是一个非常有用的动态工具，只使用最简单的函数，因此您将能够在多数组上随意操作键和值。keyfunction是删除空值或者用explode做一个数组，很干净，但是有点麻烦，可以做成一个函数，根据key或者value去掉元素。- 伊戈尔 M。

$A[0][0][0][0][0][0]="A";
$A[1][0][0][0][0][0]="";
$A[2][0][0][0][0][0]="";
$A[0][0][0][0][0][1]="";
$A[1][0][0][0][0][1]="";
$A[2][0][0][0][0][1]="";
$A[0][0][0][0][0][2]="";
$A[1][0][0][0][0][2]="";
$A[2][0][0][0][0][2]="";
$A[0][0][0][0][0][3]="";
$A[1][0][0][0][0][3]="";
$A[2][0][0][0][0][3]="";
$A[0][0][0][0][0][4]="";
$A[1][0][0][0][0][4]="";
$A[2][0][0][0][0][4]="";
$A[0][0][0][0][0][5]="";
$A[1][0][0][0][0][5]="A";
$A[2][0][0][0][0][5]="";
$A 数组：
[1]=>数组（[0]=>数组（[0]=>数组（[0]=>数组（[0]=>数组（[0]=>[1]=>[2]=> [3]=>[4]=>[5]=>A))))))
[2]=>Array([0]=>Array([0]=>Array([0]=>Array([ 0]=>Array([0]=>[1]=>[2]=>[3]=>[4]=>[5]=>))))))
结果为 $A:
Array([ 0]=>Array([0]=>Array([0]=>Array([0]=>Array([0]=>Array([0]=>A)))))
[1]=> Array([0]=>Array([0]=>Array([0]=>Array([0]=>Array([0]=>A))))))
*/
if($arraytoclean== =0 || $arraytoclean) {
if(!is_array($arraytoclean)) {
if($to_explode && $delimiter) {
$arraytoclean=explode($delimiter,$arraytoclean);
} 其他 {
$arraytoclean=Array($arraytoclean);

$keyarray=array_keys($arraytoclean);
for($nYx=0;$nYx $keydigit=true;
if($keyarray[$nYx]!==$nYx) {
$keydigit=false;
break;
}
}
for($nYx=0;$nYx if(! is_array($arraytoclean[$keyarray[$nYx]])) {
if($arraytoclean[$keyarray[$nYx]]) {
if(!isset($retarraytoclean)) {
$retarraytoclean=Array();
}
$retarraytoclean[ (($keydigit) ? $nZx : $keyarray[$nYx])]=$arraytoclean[$keyarray[$nYx]];
$nZx++;
}
} else {
$temparr=pf_cleanarray($arraytoclean[$keyarray[$nYx]]);
if($temparr) {
if(!isset($retarraytoclean)) {
$retarraytoclean=Array();
}
$retarraytoclean[(($keydigit) ? $nZx : $keyarray[$nYx])]=$temparr;
$nZx++;
}
}
}
}
if(isset($retarraytoclean)) {
return($retarraytoclean);
} 其他 {
返回（NULL）；
}
}

# javascript - 使用 JavaScript 获取 2 个 DOM 元素之间的相对位置

> ID：225563
> 
> 赞同：14
> 
> 时间：2008-10-22T12:37:54.157
> 
> 标签：javascript, jquery, dom

我已经实现了一组可以使用 jQuery 拖放到某些容器中的可拖动元素。我需要的是一个无需用户交互即可将元素移动到特定容器的动画。问题是元素和放置容器位于**DOM 的完全不同的部分，**并且大多使用浮动定位。

我只需要一些代码来获取 2 个浮动 DOM 元素之间的绝对位置差异，最好使用 jQuery。我发现的唯一一件事是一些向上解析 DOM 的 hack，但总是非常特定于浏览器（例如“这不适用于 Firefox 或 IE 或其他任何东西”）。

最好是这样的：

```
var distance = getDistance(element1, element2); 
```

或在 jQuery 表示法中：

```
var distance = $(element1).distanceTo($(element2)); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-22T12:49:37.847

我从未使用过 jQuery，只是查找了 API，所以我可以假设您可以执行以下操作：

```
var o1 = $(element1).offset();
var o2 = $(element2).offset();
var dx = o1.left - o2.left;
var dy = o1.top - o2.top;
var 距离 = Math.sqrt(dx * dx + dy * dy);

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T12:59:50.540

使用纯 JavaScript。

```
var dx = obj1.offsetLeft - obj2.offsetLeft;
var dy = obj1.offsetTop - obj2.offsetTop;
var distance = Math.sqrt(Math.pow(dx,2) + Math.pow(dy,2)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T13:38:39.620

下面的呢？

```
var isIE = navigator.appName.indexOf("Microsoft") != -1;

function getDistance(obj1, obj2){
    var obj1 = document.getElementById(obj1);
    var obj2 = document.getElementById(obj2);
    var pos1 = getRelativePos(obj1);
    var pos2 = getRelativePos(obj2);
    var dx = pos1.offsetLeft - pos2.offsetLeft;
    var dy = pos1.offsetTop - pos2.offsetTop;
    return {x:dx, y:dy};
}
function getRelativePos(obj){
var pos = {offsetLeft:0,offsetTop:0};
while(obj!=null){
    pos.offsetLeft += obj.offsetLeft;
    pos.offsetTop += obj.offsetTop;
    obj = isIE ? obj.parentElement : obj.offsetParent;
}
return pos;
}
//
var obj = getDistance("element1","element2")
alert(obj.x+" | "+obj.y); 
```

# java - API java 5 及更多：我应该返回数组还是集合？

> ID：225572
> 
> 赞同：33
> 
> 时间：2008-10-22T12:39:54.950
> 
> 标签：java, arrays, api, generics, collections

本着[最佳实践的精神：总是返回一个____，而不是一个____](https://stackoverflow.com/questions/171156/best-practices-always-return-a-never-a)，在我即将[从 JDK1.4.2 迁移到 JDK5 等](https://stackoverflow.com/questions/219164/generics-in-legacy-code)时，我面临着类似的问题。（是的，我*知道*，[JDK1.4.2 已停产！](http://java.sun.com/products/archive/eol.policy.html) ;-)）。

对于返回集合的函数（不是简单的[属性集合](https://stackoverflow.com/questions/35007/how-to-expose-a-collection-property)），我总是更喜欢（在 JDK1.4.2 中）返回 Array 而不是泛型 List，因为：

*   它强制返回类型（`MyObject[]`而不是对象列表，在静态上更加***类型安全***——如在“编译”——级别）
*   它向返回的集合*建议*一个“只读”字符（将一个元素添加到集合中更复杂，即使这不像 c# 中的“只读”关键字那么严格）。这与说它是“不可变的”不同，因为数组内的引用仍然可以修改......

当然，我总是*创建*这个返回的数组（我不公开任何“内部”数组）

现在，在 JDK5 及更高版本中，我可以根据需要使用`List<MyObject>`。

**选择 return`MyObject[]`而不是 List 或`Collection<MyObject>`在 java5 中编码的充分理由是什么？**

如果使用奖金，是否`Collection<MyObject>`可以：

*   对返回的集合强制执行只读属性？（没有`add()`或`remove()`可能）
*   对返回的集合强制执行不可变的方面？（即使该集合的引用也不能修改）

PS：[JavaGenericFAQ](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)没有那个。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-22T12:51:50.150

首选集合（或列表，或根据需要设置）而不是数组。使用泛型，您可以获得 Java 5 之前缺少的类型检查。此外，通过仅公开接口，您可以在以后自由更改实现（例如，将 ArrayList 切换为 LinkedList）。

数组和泛型不能很好地混合。所以，如果你想利用泛型，你*通常*应该避免使用数组。
即：你不能一般地创建一个数组。例如，如果 T 是泛型类型，则 "new T[0]" 不会编译。您必须执行类似“(T[]) new Object[0]”的操作，这会生成未经检查的强制转换警告。出于同样的原因，您不能在没有警告的情况下使用带有可变参数的泛型类型。

使用[Collections.unmodifiableCollection](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#unmodifiableCollection(java.util.Collection))（和类似方法），您可以获得只读约束（您无法使用数组实现 - 您必须返回数组的克隆）。

你不能强制成员的不变性，但是你也不能用数组来做到这一点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-10T07:52:01.907

实际上数组仍然比集合/列表有一个优势。由于 Java 通过类型擦除实现泛型的方式，您不能有两个将集合作为参数但仅因集合的泛型类型不同的方法。

前任：

```
public void doSomething(Collection<String> strs) { ... }
public void doSomething(Collection<Integer> ints) { ... } 
```

上述两种方法都不会编译，因为 javac 编译器使用类型擦除，因此无法将类型信息传递给 JVM。JVM 只会看到两个以 Collection 作为参数的方法。

在上述情况下，最好的解决方法是让方法将数组作为参数，并在将参数传递给它们时使用 Collection/List 的 toArray() 方法。如果您仍想在上述方法中使用 Collection/List，只需使用 java.util.Arrays.asList() 方法来获取您的 List。

前任：

```
public void doSomething(String[] strs) {
        List<String> strList = Arrays.asList(strs);
        ...
}

public void doSomething(Integer[] ints) {
        List<Integer> intList = Arrays.asList(ints);
        ...
}

public static void main(String[] args) {
        List<String> strs = new ArrayList<String>();
        List<Integer> ints = new ArrayList<Integer>();
        obj.doSomething(strs.toArray());
        obj.doSomething(ints.toArray());
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T12:53:45.093

查看`Collections`类中的 unmodifiable* 方法以使返回的集合成为只读/不可变的。这会将原始集合包装在一个列表中，以防止访问更改列表本身（尽管元素本身不是不可变的）。

例如[不可修改列表。](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#unmodifiableList(java.util.List))

对我来说，这取决于如何使用返回的列表。它被传递给哪些其他方法，它将如何使用？一般来说，我更喜欢通用集合而不是数组，但会根据具体情况进行更改。

如果您正在做一些关键的事情，该阵列可能也会执行得更快。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-23T13:41:26.323

我的回答被否决了，因为我在课堂上使用代理，并且禁止使用那些东西（代理和反射），因为它会影响某些人的思想表现（很多人甚至不使用反射，但是他们使用休眠和弹簧，它们使用反射，类代理和xml）。

来自 cglib.sourceforge.net 项目的增强器，它允许为类创建代理（JDK 仅支持接口代理）。代理允许您控制对象中的方法，但是您不能使用反射访问字段。如果你有一些问题问。

# apache-flex - Flash and Flex

> ID：225573
> 
> 赞同：1
> 
> 时间：2008-10-22T12:39:55.883
> 
> 标签：apache-flex, flash, mxml

Just a few quick questions from me:

What is the best way to inserting a Flash SWF file into a flex, that will enable me to have it start from frame 0 on reentry of that framework? Would this be States, Viewstack?

Is there a way of using forward and back buttons to navigate through displaying a set of States rather than selecting certain objects that will then change the state onscreen?

Is there some code anywhere that can show this?

Also buttons in Flash, is there a problem of them being selectable when they are displayed in Flash?

TIA - Regards

J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T02:10:49.700

如果您使用 Viewstack，则可以将 SWF 放入容器中，例如 Canvas，然后执行类似的操作

```
<mx:ViewStack>
   <mx:Canvas show="(mySWFA.content as MovieClip).gotoAndPlay(0);">
      <mx:SWFLoader id="mySWFA" source="mySWFA.swf"/>
   </mx:Canvas>
   <mx:Canvas show="(mySWFB.content as MovieClip).gotoAndPlay(0);">
      <mx:SWFLoader id="mySWFB" source="mySWFB.swf"/>
   </mx:Canvas>
</mx:ViewStack> 
```

我没有对此进行测试，我对 .content 部分进行了一些猜测，但基本思想是 Viewstack 将在堆栈索引更改时触发 show 事件。这会给你一个钩子来倒带你的瑞士法郎。

此外，可以通过项目属性->Flex 编译器->浏览器集成将 Viewstack 设置为服从浏览器的前进和后退按钮。一旦打开，它应该会自动工作。

# rfc - RFC 文件为 A4 格式

> ID：225586
> 
> 赞同：16
> 
> 时间：2008-10-22T12:45:35.983
> 
> 标签：rfc

在我的 A4 格式打印机上打印 RFC 文档时，我注意到我打印的数量超过了 RFC 文档中的一页。我认为这是因为 RFC 可能是用北美纸质信函格式（216 × 279 毫米）编写的，而我想使用 ISO A4 格式（210 × 297 毫米）。[纸张尺寸](http://en.wikipedia.org/wiki/Paper_size)信息。所以我的问题是，是否有某种方法或程序至少可以将每个字母格式页面打印到单独的 A4 格式页面上。我知道底部会有一些未使用的空间，但至少每个 A4 纸页只有一个文本页。我尝试将打印机上的纸张尺寸从 A4 更改为 letter，但没有帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-22T12:53:38.510

RFC 文档以行式打印机控制代码的形式包含分页符等。仅从 vi / notepad / word / 中打印纯文本 rfc*可能*无法按预期工作。尝试以 PDF 格式搜索 rfc，它们会更容易打印，并且页码应该是正确的。您也许可以在 A4 中找到 pdf，否则打印机对话“缩小以适应”功能应该可以处理它。

哦，货比三家，有些 PDF 比其他的要好得多……

您可以在这里找到 PDF 格式[http://tools.ietf.org/pdf/](http://tools.ietf.org/pdf/)，对于 RFC 1928，它是[http://tools.ietf.org/pdf/rfc1928.pdf](http://tools.ietf.org/pdf/rfc1928.pdf)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T14:27:31.660

将 RFC 的 .txt 版本加载到 MS Word 中是可行的，只要您确保下载的版本中仍然包含嵌入的换页符。

[http://www.ietf.org/rfc/](http://www.ietf.org/rfc/)上的那些很好。

如果将整个文档的字体设置为 10pt Courier，则每页文本都将适合 A4 纸，并且 FF 字符确保正确的分页符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-09T04:20:24.880

[http://ietfreport.isoc.org/rfc/PDF/](http://ietfreport.isoc.org/rfc/PDF/)

IETF 的 Internet 报告包含所有 rdf 和 bcp 文档的 PDF 版本的存档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T18:39:34.883

使用 MS word 从[http://www.ietf.org/rfc/rfcXXXX.txt](http://www.ietf.org/rfc/rfcXXXX.txt)打开 RFC txt 文件。它将每个 RFC 页面格式化为文档页面，您可以随意缩放/缩放它。我自己刚刚打印了一个 rfc :)

# java - Thread.getContextClassLoader() == null？

> ID：225594
> 
> 赞同：7
> 
> 时间：2008-10-22T12:48:50.140
> 
> 标签：java, classloader, contextclassloader

可以`Thread.getContextClassLoader()`为空吗？javadoc 不是很清楚。
图书馆应该考虑这种情况吗？

更新：我问的原因是在这种情况*下*`beansbinding.dev.java.net`不起作用（我的代码确实*`setContextClassLoader(null)`*

 ** * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-22T13:56:22.203

在非 Java 线程中从 JNI 代码创建的 Java 线程具有 null ContextClassloader，除非创建者明确设置它。

同样在这种情况下 Thread.currentThread() 返回 null。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T13:12:46.193

是的，你应该，有人可以打电话`Thread.setContextClassLoader(null)`，你的图书馆 IMO 应该能够处理这个问题。

# sql-server - LINQ to SQL 与非 MS SQL Server 的 RDBMS

> ID：225595
> 
> 赞同：3
> 
> 时间：2008-10-22T12:49:10.763
> 
> 标签：sql-server, linq-to-sql

Microsoft 是否有计划在 MS SQL 服务器之外支持 LINQ to SQL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T17:19:40.673

Microsoft 没有计划将 LINQ to SQL 扩展到 SQL Server 之外，这样做没有多大意义。LINQ to SQL 中的大部分代码都在 SQL Provider 的实现中。

Microsoft 提供实体框架作为其跨数据库平台 ORM 解决方案，其他 ORM 解决方案也在实施 LINQ 提供程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T12:52:55.093

我不知道微软是否计划这样做，但这可能不太可能。但是，如果您想使用类似的东西，您可以同时使用[DbLinq](http://www.ohloh.net/projects/dblinq)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:26:00.753

我不认为 MS 会这样做，我猜他们将从现在开始大量投资于 Entity Framework。

[Devart](http://www.devart.com/linq/)可以在这里提供一些东西，但我没有广泛测试他们的 LINQ 产品，所以不能说质量。

# javascript - 用于代码语法突出显示的 JavaScript 库，然后在 HTML 中在行级别进行差异？

> ID：225597
> 
> 赞同：0
> 
> 时间：2008-10-22T12:49:40.607
> 
> 标签：javascript, html, diff, line

任何人都知道一个 JS 库，它可以让我语法高亮代码块，然后高亮行级差异？例如，在颠覆差异中，我想突出显示行上已更改的字符（以及突出显示行上有更改的事实）。

编辑：我正在寻找一些可以让我根据语言突出显示语法的东西，然后语法突出显示它是一个差异的事实，理想情况下，最重要的是，突出显示已更改行上的更改字符。我看到 Gallio 现在这样做是因为它的不相等的断言异常，但还没有看过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T19:33:44.770

我用它在浏览器中生成代码差异——非常棒

[https://github.com/cemerick/jsdifflib](https://github.com/cemerick/jsdifflib)

它是线级的，但您也许可以将其用作基础。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T10:40:31.193

[Google Syntax Highlighter](http://code.google.com/p/syntaxhighlighter/)很棒，支持多种语言。我不确定它是否支持差异，但我认为它是相当可扩展的。

# python - Python 的“漂亮”持续集成

> ID：225598
> 
> 赞同：116
> 
> 时间：2008-10-22T12:49:54.633
> 
> 标签：python, jenkins, continuous-integration, buildbot

这是一个有点......徒劳的问题，但BuildBot的输出并不是特别好看......

例如，相比..

*   [phpUnderControl](http://phpundercontrol.org/about.html)
*   [詹金斯](http://jenkins-ci.org/content/about-jenkins-ci)
    *   [哈德逊](http://blogs.oracle.com/arungupta/entry/top_10_features_of_hudson)
*   [CruiseControl.rb](http://cruisecontrolrb.thoughtworks.com/)

..和其他人，[BuildBot](http://buildbot.python.org/stable/)看起来相当.. 陈旧

我目前正在玩 Hudson，但它非常以 Java 为中心（尽管使用[本指南](http://redsolo.blogspot.com/2007/11/hudson-embraces-python.html)，我发现它比 BuildBot 更容易设置，并产生了更多信息）

基本上：是否有任何针对 python 的持续集成系统，可以产生大量闪亮的图表等？

* * *

**更新：**从那时起，Jenkins 项目已取代 Hudson 作为包的社区版本。原作者也已移至该项目。Jenkins 现在是 Ubuntu/Debian、RedHat/Fedora/CentOS 等的标准软件包。以下更新基本上仍然是正确的。[使用Jenkins](http://jenkins-ci.org)执行此操作的起点是不同的。

***更新：***在尝试了一些替代方案之后，我想我会坚持使用 Hudson。[完整性](http://integrityapp.com/)很好也很简单，但非常有限。我认为[Buildbot](http://buildbot.net/trac)更适合拥有大量的 build-slave，而不是像我使用的那样在一台机器上运行所有东西。

为 Python 项目设置 Hudson 非常简单：

*   [从http://hudson-ci.org/](http://hudson-ci.org/)下载 Hudson
*   运行它`java -jar hudson.war`
*   在默认地址打开网页界面`http://localhost:8080`
*   转到管理 Hudson，插件，单击“更新”或类似
*   安装 Git 插件（我必须`git`在 Hudson 全局首选项中设置路径）
*   新建项目，进入仓库，SCM轮询间隔等
*   如果尚未安装，请`nosetests`通过`easy_install`
*   在构建步骤中，添加`nosetests --with-xunit --verbose`
*   选中“发布 JUnit 测试结果报告”并将“测试报告 XMLs”设置为`**/nosetests.xml`

这就是所有需要的。您可以设置电子邮件通知，[插件](http://wiki.hudson-ci.org/display/HUDSON/Plugins)值得一看。我目前用于 Python 项目的一些：

*   [SLOCCount 插件](http://wiki.hudson-ci.org/display/HUDSON/SLOCCount+Plugin)用于计算代码行数（并绘制图表！） - 您需要单独安装[sloccount](http://www.dwheeler.com/sloccount/)
*   解析 PyLint 输出的[违规行为（您可以设置警告阈值，绘制每个构建的违规数量）](http://wiki.hudson-ci.org/display/HUDSON/Violations)
*   [Cobertura](http://wiki.hudson-ci.org/display/HUDSON/Cobertura+Plugin)可以解析 coverage.py 输出。Nosetest 可以在运行测试时收集覆盖率，使用`nosetests --with-coverage`（这将输出写入`**/coverage.xml`）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-20T20:13:24.927

您可能想查看[Nose](http://somethingaboutorange.com/mrl/projects/nose/)和[Xunit 输出插件](http://nose.readthedocs.org/en/latest/plugins/xunit.html)。你可以让它运行你的单元测试，并使用这个命令检查覆盖率：

```
nosetests --with-xunit --enable-cover 
```

如果您想走 Jenkins 路线，或者如果您想使用另一个支持 JUnit 测试报告的 CI 服务器，这将很有帮助。

[同样，您可以使用Jenkins 的违规插件](https://wiki.jenkins-ci.org/display/JENKINS/Violations)捕获 pylint 的输出

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-22T13:46:55.140

不知道会不会：[Bitten](http://bitten.edgewall.org/)是由编写 Trac 的人制作的，并与 Trac 集成。[Apache Gump](http://gump.apache.org/)是 Apache 使用的 CI 工具。它是用 Python 编写的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-23T01:30:17.593

[TeamCity](http://www.jetbrains.com/teamcity/)作为我们的 CI 服务器并使用鼻子作为我们的测试 运行程序，我们取得了巨大的成功。[用于鼻子测试的 Teamcity 插件为](http://pypi.python.org/pypi/teamcity-nose)您提供通过/失败计数，失败测试的可读显示（可以通过电子邮件发送）。您甚至可以在堆栈运行时查看测试失败的详细信息。

如果当然支持在多台机器上运行之类的东西，那么它的设置和维护要比 buildbot 简单得多。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-01-08T09:16:55.063

Buildbot 的瀑布页面可以大大美化。这是一个很好的例子[http://build.chromium.org/buildbot/waterfall/waterfall](http://build.chromium.org/buildbot/waterfall/waterfall)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-02-25T15:25:37.993

我想这个线程已经很老了，但这是我对哈德森的看法：

我决定使用 pip 并设置一个 repo（开始工作很痛苦但看起来很漂亮的蛋篮），hudson 自动上传到成功的测试。这是我的粗略和准备好的脚本，可与 hudson 配置执行脚本一起使用，例如：/var/lib/hudson/venv/main/bin/hudson_script.py -w $WORKSPACE -p my.package -v $BUILD_NUMBER，只需放入**/coverage.xml、pylint.txt 和 nosetests.xml 在配置位：

```
#!/var/lib/hudson/venv/main/bin/python
import os
import re
import subprocess
import logging
import optparse

logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s %(levelname)s %(message)s')

#venvDir = "/var/lib/hudson/venv/main/bin/"

UPLOAD_REPO = "http://ldndev01:3442"

def call_command(command, cwd, ignore_error_code=False):
    try:
        logging.info("Running: %s" % command)
        status = subprocess.call(command, cwd=cwd, shell=True)
        if not ignore_error_code and status != 0:
            raise Exception("Last command failed")

        return status

    except:
        logging.exception("Could not run command %s" % command)
        raise

def main():
    usage = "usage: %prog [options]"
    parser = optparse.OptionParser(usage)
    parser.add_option("-w", "--workspace", dest="workspace",
                      help="workspace folder for the job")
    parser.add_option("-p", "--package", dest="package",
                      help="the package name i.e., back_office.reconciler")
    parser.add_option("-v", "--build_number", dest="build_number",
                      help="the build number, which will get put at the end of the package version")
    options, args = parser.parse_args()

    if not options.workspace or not options.package:
        raise Exception("Need both args, do --help for info")

    venvDir = options.package + "_venv/"

    #find out if venv is there
    if not os.path.exists(venvDir):
        #make it
        call_command("virtualenv %s --no-site-packages" % venvDir,
                     options.workspace)

    #install the venv/make sure its there plus install the local package
    call_command("%sbin/pip install -e ./ --extra-index %s" % (venvDir, UPLOAD_REPO),
                 options.workspace)

    #make sure pylint, nose and coverage are installed
    call_command("%sbin/pip install nose pylint coverage epydoc" % venvDir,
                 options.workspace)

    #make sure we have an __init__.py
    #this shouldn't be needed if the packages are set up correctly
    #modules = options.package.split(".")
    #if len(modules) > 1: 
    #    call_command("touch '%s/__init__.py'" % modules[0], 
    #                 options.workspace)
    #do the nosetests
    test_status = call_command("%sbin/nosetests %s --with-xunit --with-coverage --cover-package %s --cover-erase" % (venvDir,
                                                                                     options.package.replace(".", "/"),
                                                                                     options.package),
                 options.workspace, True)
    #produce coverage report -i for ignore weird missing file errors
    call_command("%sbin/coverage xml -i" % venvDir,
                 options.workspace)
    #move it so that the code coverage plugin can find it
    call_command("mv coverage.xml %s" % (options.package.replace(".", "/")),
                 options.workspace)
    #run pylint
    call_command("%sbin/pylint --rcfile ~/pylint.rc -f parseable %s > pylint.txt" % (venvDir, 
                                                                                     options.package),
                 options.workspace, True)

    #remove old dists so we only have the newest at the end
    call_command("rm -rfv %s" % (options.workspace + "/dist"),
                 options.workspace)

    #if the build passes upload the result to the egg_basket
    if test_status == 0:
        logging.info("Success - uploading egg")
        upload_bit = "upload -r %s/upload" % UPLOAD_REPO
    else:
        logging.info("Failure - not uploading egg")
        upload_bit = ""

    #create egg
    call_command("%sbin/python setup.py egg_info --tag-build=.0.%s --tag-svn-revision --tag-date sdist %s" % (venvDir,
                                                                                                              options.build_number,
                                                                                                              upload_bit),
                 options.workspace)

    call_command("%sbin/epydoc --html --graph all %s" % (venvDir, options.package),
                 options.workspace)

    logging.info("Complete")

if __name__ == "__main__":
    main() 
```

在部署东西时，您可以执行以下操作：

```
pip -E /location/of/my/venv/ install my_package==X.Y.Z --extra-index http://my_repo 
```

然后人们可以使用以下方法开发东西：

```
pip -E /location/of/my/venv/ install -e ./ --extra-index http://my_repo 
```

这些东西假设你每个包都有一个 repo 结构，其中设置了 setup.py 和依赖项，然后你可以检查主干并在其上运行这些东西。

我希望这可以帮助某人。

- - - 更新 - - - - -

我添加了 epydoc，它非常适合 hudson。只需使用 html 文件夹将 javadoc 添加到您的配置中

请注意，这些天 pip 不正确支持 -E 标志，因此您必须单独创建 venv

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-06-28T18:08:12.157

Atlassian 的[Bamboo](http://www.atlassian.com/software/bamboo)也绝对值得一试。整个 Atlassian 套件（JIRA、Confluence、FishEye 等）非常可爱。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-12-20T08:28:42.910

另一个：[Shining Panda](https://www.shiningpanda.com/)是 python 的托管工具

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-04-28T12:43:00.743

如果您正在考虑托管 CI 解决方案并进行开源，那么您也应该研究[Travis CI——](http://travis-ci.org/)它与 GitHub 的集成非常好。虽然它最初是一个 Ruby 工具，但不久前他们已经[添加了 Python 支持。](http://about.travis-ci.org/blog/announcing_python_and_perl_support_on_travis_ci/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-29T04:05:02.383

信号是另一种选择。[您可以在此处](http://www.diegocarrion.com/2009/10/30/really-easy-continuous-integration-with-signal/)了解更多信息并观看视频。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-11-08T16:41:53.427

我会考虑[CircleCi](https://circleci.com) - 它有很好的 Python 支持，并且输出非常漂亮。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-25T19:01:39.773

continuum 的[binstar](http://docs.binstar.org/draft/examples.html#SubmitABuildFromGithub)现在能够从 github 触发构建，并且可以为 linux、osx 和 windows ( 32 / 64 ) 编译。巧妙的是，它确实允许您将分布和持续集成紧密结合在一起。那是跨越 t 并点缀 I 的整合。站点、工作流程和工具都非常精致，AFAIK conda 是分发复杂 Python 模块的最强大和最 Python 的方式，您需要在其中包装*和*分发 C/C++/Fotran 库。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-06T15:03:28.260

我们已经用过很多次了。它很漂亮并且与 Trac 很好地集成在一起，但是如果你有任何非标准的工作流程，定制是一件很痛苦的事情。此外，插件也没有更流行的工具那么多。目前，我们正在评估 Hudson 作为替代品。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-08-03T17:27:27.363

检查[rultor.com](http://www.rultor.com)。正如[本文](http://www.yegor256.com/2014/07/29/docker-in-rultor.html)所解释的，它在每次构建时都使用 Docker。多亏了这一点，您可以在 Docker 映像中配置任何您喜欢的内容，包括 Python。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-29T19:14:47.167

一点免责声明，我实际上不得不为一个想要一种方法来自动测试和部署*任何*代码在 git push 上并通过 git notes 管理问题票证的客户构建一个这样的解决方案。这也导致了我在[AIMS 项目](https://github.com/denzuko/AIMS)上的工作。

可以轻松地设置一个具有构建用户的裸节点系统，并通过`make(1)`、`expect(1)`、`crontab(1)`/`systemd.unit(5)`和`incrontab(1)`. 甚至可以更进一步，将 ansible 和 celery 用于带有 gridfs/nfs 文件存储的分布式构建。

虽然，除了 Graybeard UNIX 人员或原理级工程师/架构师之外，我不希望任何人真正走到这一步。因为构建服务器只不过是一种以自动化方式任意执行脚本任务的方式，因此只是一个不错的想法和潜在的学习体验。

# activation - 用户验证下降百分比

> ID：225607
> 
> 赞同：0
> 
> 时间：2008-10-22T12:52:41.180
> 
> 标签：activation

我们为我们的网站用户提供了一个简单的注册表单，我们只需要一个电子邮件地址和一个密码（两者都重复两次以确保它们是正确的）。我们要求用户通过单击电子邮件中的链接来确认他们的电子邮件帐户。

我们看到很多用户不费心点击电子邮件中的链接（超过 18% 的人从未激活过他们的帐户），我们想知道这与其他网站相比如何。

我们不知道我们的域在任何地方都被列入黑名单，并且它已正确设置 SPF 以通过垃圾邮件过滤器。

有没有我错过的统计数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T12:54:22.267

我没有任何统计数据可以帮助您，但是您是否收集了有关有多少人尝试登录非活动帐户的统计数据？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:45:45.347

我运营的网站执行相同类型的注册场景，并且我有大约 12-15% 的非活动用户，从未确认过。

我发现通常有以下三个原因之一。

1.  他们打错了他们的电子邮件，即使有重复，也会发生这种情况，因为许多人会从一号信箱复制并粘贴到二号信箱。
2.  他们的电子邮件服务器由于某种原因没有收到邮件、邮箱已满或其他问题，我通常会因此收到退回邮件。
3.  他们决定，因为我正在验证帐户，他们不想处理它，所以我发生了这种情况，他们刚刚给我发了电子邮件说，删除帐户。

# sharepoint - Access Web Datasheet in a webApp

> ID：225611
> 
> 赞同：3
> 
> 时间：2008-10-22T12:53:38.010
> 
> 标签：sharepoint, asp.net-3.5

I am trying to write a web application in C# ASP.NET 3.5 and want to include a Microsoft Office Access Web Datasheet in my application. I can't find an example on how to use it anywhere.

It's the editing view in a SharePoint grid so I know it's possible, I just can't find out how to implement it.

Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-25T19:02:32.933

开箱即用，我相信这是不可能的。这个类似的[问题](http://www.experts-exchange.com/Programming/Languages/.NET/ASP.NET/Q_24539090.html)似乎证实了这一点。但是，有很多替代方法可以做到这一点。

最近，我一直在使用 Telerik 控件，这创造了很好的结果。许多免费的替代品也可用于多个开发框架，那么您为什么不先研究一下呢？

# c# - C# 下载网页。需要更好的方法，CPU使用率很高

> ID：225617
> 
> 赞同：2
> 
> 时间：2008-10-22T12:54:32.983
> 
> 标签：c#, url, download, uri

我试图让这段代码工作得更好一点。我怀疑这是一次读取一个字节的循环。我找不到使用 gzip 解压缩的另一种方法。实现 a`StreamReader`很好，但它返回一个我无法传递给解压缩流的字符串。

有没有更好的办法？

```
byte[] bufffer = null;
List<byte> resourceBytes = new List<byte>();
int byteValue = 0;
WebResource resource = new WebResource();
HttpWebResponse webResponse = null;

try {
    HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(resourceUri);
    webRequest.Headers.Add(HttpRequestHeader.AcceptEncoding, "gzip,deflate");
    webRequest.Headers.Add(HttpRequestHeader.AcceptCharset, "ISO-8859-1,utf-8;q=0.7,*;q=0.7");
    webRequest.UserAgent = agent;
    webRequest.Accept = "text/html, application/xml;q=0.9, application/xhtml+xml, image/png, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1";
    webRequest.Credentials = CredentialCache.DefaultCredentials;
    webRequest.Referer = resourceUri.OriginalString;
    webRequest.Timeout = 5000;

    webResponse = (HttpWebResponse)webRequest.GetResponse();

    Stream webStream = webResponse.GetResponseStream();

    if (!string.IsNullOrEmpty(webResponse.ContentEncoding)) {
        if (webResponse.ContentEncoding.ToLower().Contains("gzip")) {
            webStream = new GZipStream(webStream, CompressionMode.Decompress);
        }
        else if (webResponse.ContentEncoding.ToLower().Contains("deflate")) {
            webStream = new DeflateStream(webStream, CompressionMode.Decompress);
        }
    }

    do {
        byteValue = webStream.ReadByte();

        if (byteValue != -1) {
            resourceBytes.Add((byte)byteValue);
        }

    } while (byteValue != -1);

    //Free up resources
    webStream.Close();
    webResponse.Close();

    bufffer = resourceBytes.ToArray(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T13:01:35.560

我同意 jmcd 的观点，即 WebClient 会简单得多，尤其是 WebClient.DownloadData。

重新实际的问题，问题是你正在读取单个字节，当你可能应该有一个固定的缓冲区和循环 - 即

```
int bytesRead;
byte[] buffer = new byte[1024];
while((bytesRead = webStream.Read(buffer, 0, buffer.Length)) > 0) {
  // process "bytesRead" worth of data from "buffer"
} 
```

[编辑以强调] 重要的是您每次*只*处理“bytesRead”的数据；外面的一切都是垃圾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T12:56:39.737

[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)类对您想做的事情没有用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T12:56:57.177

如果您希望将响应作为字符串，您可以这样做。

```
String ReponseText;

IO.StreamReader ResponseReader = New IO.StreamReader(webStream );
ReponseText= ResponseReader.ReadToEnd(); 
```

如果您想要一个实际的字节数组，请执行此操作（抱歉，不想为此转换为 C#）

```
'Declare Array Same size as response
Dim ResponseData(webStream .Length) As Byte 
'Read all the data at once
webStream.Read(ResponseData, 0, webStream .Length) 
```

# optimization - 多少个哈希桶

> ID：225621
> 
> 赞同：21
> 
> 时间：2008-10-22T12:56:40.000
> 
> 标签：optimization, hashtable

如果我注意到哈希表（或基于哈希表构建的任何其他数据结构）正在填满，那么您应该在什么时候构建一个包含更多存储桶的新表。到目前为止，给定表中的 n 个项目，您如何计算在新项目中要使用多少个存储桶？

假设我有 100 个桶。当里面有 50 个项目时，我应该重新组织它吗？500？5000？还是我应该寻找最满的桶和钥匙？那么当我达到那个点时，我要制作多大的新哈希表？

与此相关，如果您事先知道大概有多少项将进入，有没有办法计算桶的数量以获得良好的平均性能？

我知道真正的答案取决于许多其他考虑因素，例如在特定示例中速度与大小的重要性，但我正在寻找一般的准则。

我也知道我不应该优化这类事情，除非良好的分析表明这是一个瓶颈。我只是在考虑一个将使用大量哈希表的项目，并想知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-22T13:11:07.630

一个好的经验法则（并不总是理想的，嗯，只是一个经验法则）是在哈希表填充到 80% 时重新散列。这意味着如果你有 100 个桶和 80 件物品，无论你之前有多少碰撞，都需要时间来增加容量。

你应该增加多少？好吧，也没有完美的价值。最简单的解决方案是每增加一倍容量。所以它会达到 200、400、800 等等。如果您认为这太多了（毕竟当哈希表变得非常大并且您可能永远无法填满 16 MB 时，它会从 8 MB 内存跃升至 16 MB），请选择较小的增长因子。建议至少 1/3（从 100 增长到 133）我会说，作为妥协，也许让它每次增长 50%。

请注意，所有这些还取决于如何处理冲突。处理它们的一种简单方法（我个人最喜欢的）是在发生碰撞时将项目存储在链表中。如果将 3 个项目放在同一个键上，则仍然最多只有 3 次比较才能找到它。由于链表对搜索非常无效，您可能希望提前增加容量，例如，如果使用 60% 的容量来保持哈希表的快速。OTOH，您可以做一些更复杂的事情并保留有关碰撞次数的统计信息。只要你几乎没有任何冲突（如果你有一个非常好的散列函数），就根本不需要重新散列，即使它的 99% 的容量都在使用中。此外，如果您以复杂的方式处理碰撞（例如 每个节点又是一个排序表，您可以在这些表中执行二进制搜索）如果表加载到 200%，您的查找可能仍然足够快（因此您的项目数量是容量的两倍）。在这种情况下，您可以统计最大的排序表有多大，当它大于 8 个条目时，您认为这太慢了，然后您重新散列。

重新散列非常慢，因此应尽可能避免。因此，如果您需要重新散列，不要只是将容量增长得太少，否则在添加更多项目时您必须很快再次重新散列。所以当你需要重新散列时，让容量明显大于当前表中的项目数，其他的都是容量太少。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-22T13:02:56.900

*通常，您要注意正式定义为 α = n*  /  *N*的负载因子（非正式地，您已经说过），即已 用桶与总桶的比率。为了使哈希表正常运行（或至少从数学角度推断其性能），它应该是 α < 1。

其他一切都取决于经验测试：如果您发现哈希表在 α > 0.5 时表现不佳，请确保保持在该值以下。该值还取决于您的冲突解决技术。使用链式散列可能需要其他负载因子，而不是使用开放寻址的散列。另一个因素是缓存位置。如果您的表变得太大，它将不适合主内存。由于您对数组的访问是随机的，因此从缓存加载可能会成为瓶颈。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T13:21:20.980

通常有两种类型的哈希表：开放式和封闭式。

在一个开放的哈希表中，您可以根据哈希找到正确的存储桶，然后构建一个挂在该存储桶上的项目列表。

在一个封闭的哈希表中，您可以使用哈希值找到初始存储桶，如果它被占用，您将探测下一个值。在最简单的情况下，您可以通过查找下一个空闲存储桶来执行此操作，或者您可以从您的项目中创建第二个哈希值并逐步进行（尽管您必须确保这是以哈希表大小为模的素数，因此您将访问所有桶）。

打开的哈希表通常不会调整大小。您将初始大小设置为您认为对问题合理的大小。正如其他人指出的那样，您可以在打开的哈希表上调整大小，但是现在推理这种数据结构的性能变得非常困难。如果您在给定存储桶的长度为 L 时调整大小，那么您最终**可能只调整整个哈希表中的 L 个项目的大小，这是非常低效的。**

当负载因子（哈希表中的项目数/桶数）达到某个预定义值时，将调整关闭的哈希表的大小。我倾向于使用 80%，但确切的值不太可能太关键。

封闭哈希表的好处是插入项目的**摊销成本始终为 O(1)（假设哈希函数良好）。**由于调整大小的成本，插入特定项目可能是 O(N)，但这种情况很少发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T13:15:14.143

取决于您正在构建的哈希表的类型。如果您使用基于固定数组的哈希表（与存储桶的链表相反），则应在表已满或达到最大探测计数时调整数组大小（取决于您是否更关心速度或记忆）。如果您使用的是链表，那么内存就不是那么重要了，因为并且不必探测空白空间，因此调整大小并不是什么大问题。

哈希表的关键是哈希算法，而不是桶的数量。理想情况下，您总是希望每个存储桶中最多有一个项目，因此理想情况下，您应该在哈希表中的项目数 = 存储桶数时调整大小。如果您的数据分布不均，则最好使用更好的哈希算法而不是更好的调整大小策略。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T06:26:04.163

如果您使用线性散列，则表本身会通过保持恒定的负载因子来自动调整大小。

# windows-installer - 安装程序对话框带有 800x480 分辨率的滚动条

> ID：225623
> 
> 赞同：1
> 
> 时间：2008-10-22T12:57:30.733
> 
> 标签：windows-installer, dialog, resolution, wise

我正在使用 WISE 构建一个 msi。在 1280x800 分辨率的屏幕上运行时，对话框看起来很好。但是当我在 800x480 分辨率的屏幕上运行相同的 msi 时，安装程​​序对话框看起来非常大，您无法在屏幕上看到整个对话框。但是，该对话框现在带有一个垂直和水平滚动条，允许您滚动和查看它完全。

是否需要设置任何属性来调整安装程序对话框，使其在高分辨率和低分辨率屏幕上都正确显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T05:54:11.487

据我所知，根据 Windows XP 设计指南，这些表单设计的最低分辨率为 800x600。您在屏幕高度上比该目标少了 120 像素。

也就是说，您可以通过从源代码构建 WISE 安装程序并手动编辑 .rc 文件来编写基于 C++ 的解决方案。（是的，我知道这很模糊）

# asp.net - 如何根据域名加载不同的主题/css

> ID：225624
> 
> 赞同：1
> 
> 时间：2008-10-22T12:57:47.987
> 
> 标签：asp.net

我有一个站点，它将出售给不同的客户，但出于维护原因，我们将保留一个代码库。所以这意味着这个代码库必须足够动态以具有不同的样式等等，具体取决于客户端。

域将是一个子域类型的系统，例如：projectname.clientname.com、projectname.clientname.com 等等，其中客户名称是我们将系统出售给的公司。

我想要做的是根据域加载不同的主题。所以我可能有 ecards.savills.com，为此，我在 Themes 中有一个名为 Savills 的文件夹，在该文件夹中名为 Savills，一个 .CSS 文件，我想加载它。我一直在玩请求对象，但没有运气。

我已经尝试了几种方法来实现这一点，使用样式表主题（不需要皮肤按钮顺便说一句），但我不断在.NET 的系统 dll 中获得堆栈溢出。

什么是实现这一目标的稳健方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T04:36:28.043

您可以使用不同的母版页来完成此操作。

针对一个母版页（或一组母版）编写默认值，然后在运行时根据主机域以编程方式更改母版页。

为此，您必须在页面生命周期的 OnPreInit 阶段设置页面的 MasterPageFile 属性。（之后不允许，因为已经加载了主控。）

选择的母版页可以有截然不同的布局并引用完全独立的 CSS 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T13:05:23.790

```
/* Do you have a folder in "Themes" or "APP_Themes" called Savillis? */ 
```

当您为页面指定主题时，将加载该主题文件夹中的所有样式表。它们将按字母顺序加载，因此请注意顺序。

在页面级别，您可以在 Page 指令 (aspx) 或 PreInit (codebehind) 中设置主题，也可以在 web.config 中设置默认主题。（您也可以设置全局主题，但通常不使用。

```
/* Are you doing that? */ 
```

是否有单独的网站实例？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:05:49.217

使用以下想法中的信息来更改代码中的主题。检查 HTTP_REFERER 以查看正在请求哪个域并使用 SELECT CASE 更改为该域您喜欢的主题。

[http://msdn.microsoft.com/en-us/library/tx35bd89.aspx](http://msdn.microsoft.com/en-us/library/tx35bd89.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T13:11:41.157

我的根目录中有 APP_THEMES，然后我向其中添加了一个主题（这是一个我重命名的文件夹）。

我想以编程方式设置主题，因为它是条件绑定的，所以我使用 page_preinit。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T13:21:16.987

编写一个 HttpModule 来分配特定领域的主题。就像 UrlRewrite httpmodule 一样。如果您不知道如何创建 httpmodule，可以在 msdn 上获取教程。

# database-design - 锁定以处理并发——一个好主意？

> ID：225625
> 
> 赞同：5
> 
> 时间：2008-10-22T12:57:53.040
> 
> 标签：database-design, locking

为了处理并发问题，锁定——任何形式的锁定，无论是行锁定、表锁定还是数据库锁定，都是一个好的解决方案吗？

**如果没有，如何处理并发问题？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T13:29:16.847

如果你相信甲骨文，不，根本不相信。那是因为甲骨文竭尽全力避免它。

问题是读者可以阻止写入者，而写入者会阻止读取者，而写入者必须等到所有读取者都完成一行后才能写入。这会延迟写入过程及其调用者。排他锁（用于写入）被保留到事务结束，以防事务必须回滚 - 这会阻止其他事务看到新值，直到事务提交。

实际上，如果没有太多争用，锁定通常是可以的，就像任何并发编程一样。如果对行/页/表的争用过多（没有多少数据库服务器会进行整个 DB 锁定），则会导致事务依次执行而不是并发执行。

Oracle 使用行版本控制，而不是锁定一行来写入它，而是创建该行的新版本。需要重复阅读的读者会记住他们阅读的行的版本。但是，如果正在记住其读取的读取器尝试更新自该事务读取以来已由另一个写入器更新的行，则会发生错误；这是为了阻止丢失的更新。为确保您可以更新一行，您必须说 SELECT 是 FOR UPDATE；如果你这样做，它需要一个锁——一次只有一个事务可以保存一行 FOR UPDATE，并且一个冲突的事务必须等待。

SQL Server 2005 及更高版本支持快照隔离，这是它们对行版本控制的名称。同样，如果您需要更新刚刚读取的某些数据，您应该请求更新锁 - 在 SQL Server 中，使用 WITH (UPDLOCK)。

锁定的另一个问题是死锁的可能性。这只是两个事务各自持有另一个需要的资源的锁，或者通常一个事务循环持有彼此需要进行的锁。数据库服务器通常会检测到此死锁并终止其中一个事务，将其回滚——然后您需要重试该操作。任何有多个并发事务修改相同行的情况都可能发生死锁。如果以不同的顺序触摸行，则会发生死锁；很难强制执行数据库服务器将使用的顺序（通常您希望优化器选择最快的顺序，这在不同的查询中不一定是一致的）。

一般来说，我会建议与线程相同 - 使用锁，直到您可以证明它们导致了可伸缩性问题，然后研究如何使最关键的部分无锁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T13:17:47.790

你必须首先定义你的目标。在并发请求的情况下，您想赢得最后一个用户还是第一个用户。数据库锁定当然是一个坏方法。尝试尽可能晚地锁定表/行并尽快释放锁定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T13:00:17.777

我认为不是，因为它一直“向下”，使您的应用程序更加复杂。大多数语言都有出色的并发处理技术，即使这样，最好的方法是编写可以“本机”处理并发的代码。

有关 Java 并发的更多信息：http: [//java.sun.com/docs/books/tutorial/essential/concurrency/index.html](http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T13:02:42.750

数据库锁定 - 与表或行锁定相反 - 是处理并发性的不好方法；它排除了并发性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T13:27:02.887

除了必须自己编写某种 DMBS 锁定代码之外，还有许多合理的替代方案。请记住，某种锁定确实总是在发生（原子操作等），但关键是如果您不需要，您不想去那里。如果没有必要，你不会想和哲学家一起吃饭。事务是绕过锁定的一种方式，但主要用于提交。使用标记/指示记录脏的字段（脏位模式）是另一种方式，只需确保您以原子访问方式执行此操作。正如之前的帖子所引用的那样，该语言通常有一个合适的解决方案，但是该语言通常只支持应用程序、进程到进程、级别并发，有时并发**必须是**在数据库中。我不想假设您有一个丰富的应用程序层，但如果您这样做了，那么有许多抽象层可以为您处理这个问题。Oracle 的 TopLink 是免费的，并且是 Hibernate 更强大的兄弟，两者都通过抽象、脏位、缓存和惰性锁定帮助您管理数据库并发挑战。你真的不想自己实现这些，除非你正在为学校或个人项目编码。明白问题，但站在巨人的肩膀上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T13:02:17.353

您是要在应用程序中处理并发，还是要解决您在数据库中遇到的并发问题。如果是前者，我觉得这不是一个好方法。如果是后者，这可能是您唯一的答案，而无需重新设计您的模式。

# javascript - 创建 HTML 菜单栏

> ID：225633
> 
> 赞同：5
> 
> 时间：2008-10-22T13:01:10.990
> 
> 标签：javascript, html, css, user-interface

我正在寻找有关在 HTML 中创建水平菜单栏的帮助。菜单栏将包含文件、编辑、查看等菜单，当您将鼠标悬停或单击文件菜单（例如）时，将显示菜单并显示新建、打开等菜单项。

理想情况下，我想使用纯 HTML 和 CSS 创建菜单栏和菜单，但如有必要，我还可以使用 JQuery、Prototype 和 Scriptaculous。有谁知道我可以从中汲取灵感的任何好的例子/教程？

**编辑**：感谢所有链接。我应该提到我真的在寻找一个解释如何在 HTML/CSS/JS 中自己动手做的教程，而不是一个为您构建所有代码的所见即所得工具。

干杯，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T13:05:32.917

我发现A List Apart 上的[这个菜单教程](http://www.alistapart.com/articles/horizdropdowns)很有帮助。如果您在该网站上四处搜索，您会发现很多很好的设计教程和模板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T13:26:04.963

这是您可以查看的另一个参考：[http ://www.dynamicdrive.com/style/csslibrary/item/suckertree-menu-horizo​​ntal/](http://www.dynamicdrive.com/style/csslibrary/item/suckertree-menu-horizontal/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T13:30:40.493

获取这个免费的基于 Windows 的 CSS 导航菜单创建器。它很棒，也是很好的教学辅助工具。

[http://www.highdots.com/css-tab-designer/](http://www.highdots.com/css-tab-designer/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T14:41:46.123

如果您说法语，在[http://www.alsacreations.com/上有很多带有 HTML + CSS 的菜单示例](http://www.alsacreations.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T13:03:40.970

看看 CoffeeCup 免费 DHTML 菜单生成器：

[http://www.coffeecup.com/free-dhtml/](http://www.coffeecup.com/free-dhtml/)

听起来它会做你想做的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T13:33:56.087

有一个公共领域的纯 CSS 菜单系统

[http://www.grc.com/menudemo.htm](http://www.grc.com/menudemo.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T13:36:03.307

如果可以使用，我强烈推荐[YUI 菜单组件。](http://developer.yahoo.com/yui/menu/)您可以使用从 Javascript 的 HTML 标记构建的[应用程序菜单](http://developer.yahoo.com/yui/examples/menu/applicationmenubar.html)（[查看示例）。](http://developer.yahoo.com/yui/examples/menu/applicationmenubar_source.html)

YUI 组件非常易于使用，开源，它们有很好的支持和文档，而且看起来设计得很好。他们来自雅虎；）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T13:26:00.567

我认为最强大的是这个“DHTML 菜单” [http://www.milonic.com/](http://www.milonic.com/) Milonic。

它处理主题和一大堆选项。

# asp.net - ASP.NET AJAX：如何获取使用 $create 方法创建的客户端实例？

> ID：225635
> 
> 赞同：1
> 
> 时间：2008-10-22T13:01:51.473
> 
> 标签：asp.net, javascript, ajax, asp.net-ajax, client-side

使用客户端 ASP.NET AJAX 库，我使用 $create 快捷方式方法 ( [http://msdn.microsoft.com/da-dk/library/bb397487(en-us)创建了一个客户端组件的实例.aspx](http://msdn.microsoft.com/da-dk/library/bb397487(en-us).aspx)）。该对象附加到一个 DOM 元素。现在我需要获取对实例的引用，但它既没有在窗口上也没有在 DOM 元素上注册，而且我在任何地方都找不到它。

有人知道如何获得对实例的引用吗？

最好的祝福，

雅各布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:21:34.493

根据 MSDN，Sys.Component.Create 应该返回它刚刚创建的对象。而且，$create 只是 Sys.Component.create 的快捷方式。

```
Returns: A new instance of a component that uses the specified parameters. 
```

所以，试试：

```
var instance = $create(someType); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:57:06.680

$find() 例程是否找到它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T21:49:50.050

是的，$find 方法原来是我的解决方案。

如果我对 javascript 在页面上的呈现方式有任何影响，我可能也可以使用 $create 的返回值 - 但不幸的是我没有...... :-)

# ruby-on-rails - 有人使用 RailRoad 图表生成器吗？

> ID：225637
> 
> 赞同：1
> 
> 时间：2008-10-22T13:02:22.377
> 
> 标签：ruby-on-rails, ruby, gem

我最近安装了 RailRoad gem 来生成我的应用程序模型和控制器的 .svg 图。

rake 任务不断出现类似的错误：

```
1.8/usr/lib/ruby/gems/1.8/gems/activesupport-1.4.4/lib/active_support/dependencies.rb:263:in `load_missing_constant': uninitialized constant 
```

我在 2 个单独的应用程序上尝试了 rake 任务，但错误一直以不同的“常量”名称出现。

任何人使用它有类似的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T13:57:20.457

我运行它没有任何问题（尽管我确实必须进行快速编辑，因为它以错误的方式代表鱼尾纹）。

这个问题[似乎也存在于他们的跟踪器中](http://rubyforge.org/tracker/index.php?func=detail&aid=21153&group_id=3383&atid=12998)。我会继续将您的堆栈跟踪添加到该票证中。我很好奇它是否是您的 ActiveSupport 版本？Bur您的版本和正在使用的版本都显示相同的问题，因此某处必须有相似之处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-08T02:36:28.820

Ivan 和其他人尝试使用来自 Github 的 Bryan Larsen 版本：http: [//github.com/bryanlarsen/railroad](http://github.com/bryanlarsen/railroad)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-12T20:52:00.387

你能发布完整的堆栈跟踪吗？不知道你今天有没有和我一样的问题：

```
user@laptop:11:15 AM:rails_app> rake doc:diagrams
(in /Users/ivan/Sites/lqas)
railroad -i -l -a -m -M | dot -Tsvg | sed 's/font-size:14.00/font-size:11.00/g' > doc/models.svg
railroad -i -l -C | neato -Tsvg | sed 's/font-size:14.00/font-size:11.00/g' > doc/controllers.svg
Error loading controller classes.
  (Are you running railroad on the aplication's root directory?)

/usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- app/controllers/application.rb (MissingSourceFile)
        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.3.5/lib/active_support/dependencies.rb:156:in `require'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.3.5/lib/active_support/dependencies.rb:521:in `new_constants_in'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.3.5/lib/active_support/dependencies.rb:156:in `require'
        from /usr/local/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/controllers_diagram.rb:39:in `load_classes'
        from /usr/local/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/app_diagram.rb:21:in `initialize'
        from /usr/local/lib/ruby/gems/1.8/gems/railroad-0.5.0/lib/railroad/controllers_diagram.rb:14:in `initialize'
        from /usr/local/lib/ruby/gems/1.8/gems/railroad-0.5.0/bin/railroad:38:in `new'
        from /usr/local/lib/ruby/gems/1.8/gems/railroad-0.5.0/bin/railroad:38
        from /usr/local/bin/railroad:19:in `load'
        from /usr/local/bin/railroad:19 
```

我不得不注释掉 lib/railroad/controllers_diagram.rb 中的行，它在其中查找 applicaton.rb 而不是 application_controller.rb，因为它现在被称为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T08:52:45.310

我用头撞了一下，让铁路工作终于遇到了[rails-erd gem](https://github.com/bryanlarsen/railroad)。它像魅力一样醒来。会向所有面临铁路问题的人推荐它。

# pdf - 如何使用 XSL-FO 在 PDF 中添加分页符？

> ID：225654
> 
> 赞同：29
> 
> 时间：2008-10-22T13:07:24.003
> 
> 标签：pdf, xslt, xsl-fo

如何使用 XSL-FO 在文档中添加分页符？我正在使用[Apache FOP](http://xmlgraphics.apache.org/fop/)创建 PDF，如果这有所作为的话。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-09-01T11:36:59.593

你也可以这样做：

```
<fo:block page-break-before="always">
  ...things you want in a new page...
</fo:block> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-22T13:21:07.080

[FOP 合规性页面](http://xmlgraphics.apache.org/fop/compliance.html)说它 支持`page-break-after`, `page-break-before`, 和`page-break-inside`在更高版本中，加上部分支持`keep-together`, `keep-with-next`, `keep-with-previous`.

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-22T13:51:15.523

谢谢，以下内容可用于在表格后添加分页符：

```
<fo:table break-after="page"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-12T14:05:09.590

这对我有用。但这是 Elite Design Gallery 的语法。

```
<w:p ><w:r><w:br w:type="page"/></w:r></w:p> 
```

# asp.net - 如何让 UpdatePanel 拦截 CompositeControl 的 DropDownList

> ID：225666
> 
> 赞同：1
> 
> 时间：2008-10-22T13:11:22.733
> 
> 标签：asp.net, asp.net-ajax

我有一个包含 DropDownList 的 CompositeControl。

我已将 DropDownList 的 AutoPostBack 属性设置为 true。

在页面上，我有：

```
<asp:UpdatePanel ID="UpdatePanel" runat="server">
    <ContentTemplate>
        <MyControl:Control ID="CustomControl" runat="server" />
    </ContentTemplate>
</asp:UpdatePanel> 
```

我也试过设置**ChildrenAsTriggers="true"**和**UpdateMode="Always,"**但都没有解决问题。

问题是UpdatePanel 没有拦截CompositeControl 的DropDownList 的回发。（更改 DropDownList 时正在执行完整的 POST）

如何让 UpdatePanel 处理回发？

谢谢！

**编辑——请求的信息**

Country 和 states 都是 CompositeControl 中的 DropDownLists。

```
country.SelectedIndexChanged += new EventHandler(country_SelectedIndexChanged);

protected void country_SelectedIndexChanged(Object sender, EventArgs e)
{
    states.DataSource = XXX;
    states.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T14:17:10.620

好的，所以这可能不是最好的答案，但我认为您遇到的问题是 UpdatePanel 无法看到子控件的事件。好消息是，它很容易修复。假设您有一个控件（CatchMyEvent，顺便说一句，这是一个非常聪明的名字）并且它上面有一个 DropDownList。现在您希望父页面在该列表上看到 SelectedIndexChanged 事件并更新标签以匹配 SelectedItem.Text。事实上，父母真的不能这样做。所以让我们改变一下：

```
public partial class CatchMyEvent : System.Web.UI.UserControl
{
    public delegate void ChangedIndex(object sender, EventArgs e);
    public event ChangedIndex SelectedIndexChanged;

    protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);
        dropDownListThrow.SelectedIndexChanged += new EventHandler(dropDownListThrow_SelectedIndexChanged);
        labelOutput.Text = "no";
    }

    public void dropDownListThrow_SelectedIndexChanged(object sender, EventArgs e)
    {
        labelOutput.Text = ((DropDownList)sender).SelectedItem.Text;
        if(SelectedIndexChanged != null)
        {
            SelectedIndexChanged(sender, e);
        }
    }
} 
```

基本上我所做的只是让控件捕获 DropDownList 的 SelectedIndexChanged 事件并触发它，以便任何父页面或控件都可以看到它。基本上我所做的就是把它传递下去。现在在父页面上，它真的很容易捕获。

您只需要添加一个带有触发器的 UpdatePanel，该触发器包含：

```
<asp:AsyncPostBackTrigger ControlID="catchMyEventMain" EventName="SelectedIndexChanged" /> 
```

...当然，将其添加到父页面后面的代码中：

```
protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    catchMyEventMain.SelectedIndexChanged += dropDownListThrow_SelectedIndexChanged;
}

public void dropDownListThrow_SelectedIndexChanged(object sender, EventArgs e)
{        
    labelSelectedValue.Text = ((DropDownList)sender).SelectedItem.Text;
} 
```

其中标签是前面提到的标签。然后让魔法发生。

还有两个注意事项：

1) 不要像我在测试它时那样傻，忘记将 DropDownList 上的 AutoPostBack 属性设置为 true。

2) 确保标签在 UpdatePanel 的 ContentTemplate 中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-29T18:31:34.700

我在 UpdatePanel 内的 ListView 中重复了子控件（文本框和标签）。

更改文本框会导致完全（同步）回发。

我添加了 PAGE 元素（.aspx 页面的第一行）：ClientIDMode="AutoID"

这为我解决了这个问题，现在只有 UpdatePanel 会根据需要刷新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T12:53:00.470

我在 BuildControlHierarchy 的末尾做了以下操作：

```
 ...
        if (DesignMode || Page == null) return;

        var sm = ScriptManager.GetCurrent(Page);
        if (sm == null)
        {
            throw new MissingFieldException("The ScriptManager is needed on the page!");
        }
        sm.RegisterAsyncPostBackControl(<control which initiates async postback>); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-17T09:30:47.603

只需确保整个层次结构中的每个控件都有一个 ID 集。

看到[这个问题](https://stackoverflow.com/questions/2158033/asp-compositecontrol-scriptmanager)。

# css - 使用什么工具来比较和减少 css 样式表

> ID：225672
> 
> 赞同：10
> 
> 时间：2008-10-22T13:13:05.880
> 
> 标签：css, compare

我有一个引用 css 文件 (style1.css) 的页面 (page1.html)

一切都很好。

我需要 Page1.html 来额外引用 Style2.css 但是当我添加引用时，Page1.html 上的一些东西搞砸了。

如何确定导致此问题的 Style2.css 是什么？一些差异工具？一些过程？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-22T13:20:08.143

[Firebug](http://getfirebug.com/)向您显示哪些规则被覆盖，以及规则来自哪个样式表。

只需选择问题元素，它就会向您显示应用于它的规则。然后，您可以打开/关闭它们以查看效果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-05-13T01:36:02.143

直接比较两个 CSS 样式表即可立即看到它们之间的差异：[http ://www.alanhart.co.uk/archives/2010/12/15/compare-css-stylesheet-tool/](http://www.alanhart.co.uk/archives/2010/12/15/compare-css-stylesheet-tool/)

当您更改网站的 CSS 并且您不记得更改了什么时非常方便（只要您保留原始的备份以进行比较）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T13:14:23.677

是的，我会使用 diff 工具（[DiffMerge](http://www.sourcegear.com/diffmerge/)是免费的）并查看两个 css 文件之间的相似之处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T13:19:20.203

如果您的文件具有相似的布局，但如果它们非常不同（就像我期望您的 CSS 可能那样），则 DiffMerge（或任何与此相关的差异工具）很好，可能很容易将整个文件显示为一个很大的差异，因此证明一点用都没有。

在这种情况下我会做的是在 FireFox 中安装 dom 检查器，然后检查这个插件。

然后，包含您的第二个样式表并查看该页面。

右键单击被阻止的元素并“检查此”。然后将 dom 检查器的视图模式更改为 CSS。它将向您显示应用于当前元素的当前样式级联，并提供对哪个文件和哪一行的引用。

这样你就可以找出你在哪里有冲突的风格。

诚然，这不是自动过程，但除非您的样式 99% 相同，否则差异将不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-27T13:51:55.990

我以前使用过这个 php 类 - 效果很好。

[http://www.phpclasses.org/package/4638-PHP-Compare-two-CSS-style-definitions.html](http://www.phpclasses.org/package/4638-PHP-Compare-two-CSS-style-definitions.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T13:34:28.037

所有好的答案......这次我不愿意选择一个正确的答案。

只是为了添加...一位同事推荐了 FF 的 Web 开发人员工具栏。

我使用了 CSS\View Style Info，然后单击了奇怪的东西……我很快从新样式表中找到了一条规则，该规则从根本上改变了它的高度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T14:25:13.770

对于可能正在阅读本文的使用**Visual Studio 2008的开发人员：**

在 WYSIWYG 设计器中选择 HTML 元素时，可以使用 CSS 属性窗口查看所有 CSS 规则及其相应设置，包括从各种 CSS 规则继承的级联设置。

通过单击属性窗格中的规则，您可以识别每个 CSS 设置的来源。这使得更容易弄清楚为什么页面或元素看起来具有特定的方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-16T06:29:22.013

diffchecker（在线）工具。非常有用和快速。[http://www.diffchecker.com/](http://www.diffchecker.com/)

# python - Python中的意外列表理解行为

> ID：225675
> 
> 赞同：6
> 
> 时间：2008-10-22T13:15:08.527
> 
> 标签：python, list-comprehension, language-implementation

我相信我被嵌套范围规则和列表理解的某种组合所困扰。 [Jeremy Hylton 的博客文章](http://www.python.org/~jeremy/weblog/040204.html)暗示了原因，但我不太了解 CPython 的实现，无法弄清楚如何解决这个问题。

这是一个（过于复杂？）示例。如果人们有一个更简单的演示它，我想听听。问题：使用 next() 的列表推导填充了上一次迭代的结果。

**编辑**：问题：

这到底是怎么回事，我该如何解决？我必须使用标准 for 循环吗？显然，该函数运行了正确的次数，但列表推导式以*最终*值结束，而不是每个循环的结果。

一些假设：

*   发电机？
*   懒惰填写列表推导？

**代码**

```
import itertools
def digit(n):
    digit_list = [ (x,False) for x in xrange(1,n+1)]
    digit_list[0] = (1,True)
    return itertools.cycle ( digit_list) 
```

```
>>> D = 数字（5）
>>> [D.next() for x in range(5)]
## 这个列表理解按预期工作
[（1，真），（2，假），（3，假），（4，假），（5，假）]

```

```
class counter(object):
    def __init__(self):
        self.counter = [ digit(4) for ii in range(2) ] 
        self.totalcount=0
        self.display = [0,] * 2
    def next(self):
        self.totalcount += 1
        self.display[-1] = self.counter[-1].next()[0]
        print self.totalcount, self.display
        return self.display

    def next2(self,*args):
        self._cycle(1)
        self.totalcount += 1
        print self.totalcount, self.display
        return self.display

    def _cycle(self,digit):
        d,first = self.counter[digit].next()
        #print digit, d, first
        #print self._display
        self.display[digit] = d
        if first and digit > 0:
            self._cycle(digit-1)

C = counter()
[C.next() for x in range(5)]
[C.next2() for x in range(5)] 
```

**输出**

```
在 [44] 中：[C.next() for x in range(6)]
1 [0, 1]
2 [0, 2]
3 [0, 3]
4 [0, 4]
5 [0, 1]
6 [0, 2]
输出[44]：[[0, 2], [0, 2], [0, 2], [0, 2], [0, 2], [0, 2]]

在 [45] 中：[C.next2() for x in range(6)]
7 [0, 3]
8 [0, 4]
9 [1, 1]
10 [1, 2]
11 [1, 3]
12 [1, 4]
输出[45]：[[1, 4], [1, 4], [1, 4], [1, 4], [1, 4], [1, 4]]

# 这应该是：[[0,3],[0,4]....[1,4]] 或类似的

```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-22T13:50:47.130

问题是`return self.display`您返回对此列表的*引用*（而不是副本）。所以你最终得到的是一个列表，其中每个元素都是对 self.display 的引用。为了说明，请看以下内容：

```
>>> a = [1,2]
>>> b = [a,a]
>>> b
[[1, 2], [1, 2]]
>>> a.append(3)
>>> b
[[1, 2, 3], [1, 2, 3]] 
```

您可能想使用类似`return self.display[:]`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T21:34:09.580

介意我重构一下吗？

```
def digit(n):
    for i in itertools.count():
        yield (i%n+1, not i%n) 
```

但实际上你不需要那个，如果你将整个事情实现为一个简单的迭代器：

```
def counter(digits, base):
    counter = [0] * digits

    def iterator():
        for total in itertools.count(1):
            for i in range(len(counter)):
                counter[i] = (counter[i] + 1) % base
                if counter[i]:
                    break
            print total, list(reversed(counter))
            yield list(reversed(counter))

    return iterator()

c = counter(2, 4)
print list(itertools.islice(c, 10)) 
```

如果您想摆脱打印（调试，是吗？），请使用 while 循环。

这顺便也解决了您最初的问题，因为`reversed`返回列表的副本。

哦，现在它是从零开始的；）

# c# - C# 中的一次性单例

> ID：225686
> 
> 赞同：13
> 
> 时间：2008-10-22T13:19:26.867
> 
> 标签：c#, .net, singleton, dispose

我有一个使用“静态只读 T Instance = new T();”的单例 图案。但是，我遇到了 T 是一次性的，实际上需要为单元测试而被丢弃的情况。如何修改此模式以支持一次性单例？

我想要的界面是这样的：

```
var x = Foo.Instance;
var y = Foo.Instance; // x == y
...
x.Release(); // this causes the next Foo.Instance to return a fresh object
             // also, it assumes no further operations on x/y will be performed. 
```

注意 - 当然，模式必须是线程安全的。

**编辑**- 出于生产代码的目的，这是一个真正的单例。问题是它锁定了一些文件，因此为了在单元测试中进行清理，我们必须处理它。

如果可能的话，我也更喜欢可以重复使用的模式。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-22T13:21:44.210

在这一点上，老实说，我认为我不再认为它是单身人士了。

特别是，如果客户使用单例，他们真的不会期望他们必须处理它，如果其他人这样做，他们会感到惊讶。

你的生产代码要做什么？

编辑：如果你真的，真的需要这个用于单元测试并且*只*用于单元测试（坦率地说，这在设计方面听起来有问题），那么你总是可以使用反射来摆弄这个领域。最好弄清楚它是否*真的*应该是单例的，或者它是否*真的*应该是一次性的——这两者很少一起出现。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-22T14:00:17.953

标记`Release`为`internal`并使用该`InternalsVisibleTo`属性仅将其公开给您的单元测试程序集。您可以这样做，或者如果您担心自己程序集中的某个人会调用它，您可以将其标记为`private`并使用反射访问它。

在单例中使用终结器来调用`Dispose`单例实例上的方法。

在生产代码中，只有卸载 an`AppDomain`才会导致单例的处理。`Release`在测试代​​码中，您可以向自己发起调用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T13:42:31.017

单例不应该是一次性的。时期。如果有人过早地调用 Dispose，那么您的应用程序将被搞砸，直到它重新启动。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T13:38:48.963

```
 public class Foo : IDisposable
  { [ThreadStatic] static Foo _instance = null;

    private Foo() {IsReleased = false;}

    public static Foo Instance
     { get
        { if (_instance == null) _instance = new Foo();
          return _instance;
        }
     }

    public void Release()
     { IsReleased = true;
       Foo._instance = null;
     }

    void IDisposable.Dispose() { Release(); }

    public bool IsReleased { get; private set;}

  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T13:36:04.493

您可以通过一些简单的修改来使用嵌套的惰性单例（参见[此处）：](http://www.yoda.arachsys.com/csharp/singleton.html)

```
public sealed class Singleton : IDisposable
{
    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            if (!Nested.released)
                return Nested.instance;
            else
                throw new ObjectDisposedException();
        }
    }

    public void Dispose()
    {
         disposed = true;
         // Do release stuff here
    }

    private bool disposed = false;

    class Nested
    {
        // Explicit static constructor to tell C# compiler
        // not to mark type as beforefieldinit
        static Nested()
        {
        }

        internal static readonly Singleton instance = new Singleton();
    }
} 
```

如果对象已被释放，请记住在对象的所有公共方法/属性中抛出 ObjectDisposedException。

您还应该为对象提供终结器方法，以防 Dispose 未被调用。[在此处](http://msdn.microsoft.com/en-us/library/ms244737(VS.80).aspx)查看如何正确实现 IDisposable 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T13:38:29.293

如果该类实现了 IDisposable （正如您所暗示的那样），那么只需调用 x.Dispose()

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T13:39:53.830

对于单元测试，您可以使用“手动”实例（但您需要一种实例化对象的方法）。

在您的情况下，您可能应该更好地使用工厂模式（抽象/方法 - 以最适合您的情况为准），并结合单例。

如果要测试单例是否正确处理了使用的对象（在单元测试中），则使用工厂方法，否则使用单例模式。

顺便说一句，如果您无权访问单例源代码或不允许修改它，则最好将其包装到另一个单例中，并提供新单例中的所有逻辑（更像是代理）。这听起来有点矫枉过正，但它可能是一个可行的解决方案。

此外，为了能够控制对它的访问，提供一个工厂，并让客户端仅在对象尚未被释放时才获取新对象。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T04:04:46.553

制作一次性 Singleton 的另一种选择是为您的类使用 SandCastle 的*[Singleton]*属性，然后 Castle 框架负责处理所有一次性 Singleton 对象

# vb.net - ADO.NET 数据服务查询拦截器 - 谁能告诉我这个 C# 的 VB 语法？

> ID：225687
> 
> 赞同：2
> 
> 时间：2008-10-22T13:19:45.540
> 
> 标签：vb.net, entity-framework, ado.net, code-conversion

我对 VB.NET 很陌生 - 我正在努力在以下代码片段中转换方法的签名。表达式<...>> 位。

提前致谢。

```
 [QueryInterceptor("Orders")]
 public Expression<Func<Orders,bool>> OnQueryOrders()
 {
     return o => o.Customer.ContactName == 
         HttpContext.Current.User.Identity.Name          
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T13:24:35.500

```
Public Function OnQueryOrders() As Expression(Of Func(Of Orders, Boolean)) 
```

# iphone - 在 iPhone 上打开 .webarchive？

> ID：225699
> 
> 赞同：7
> 
> 时间：2008-10-22T13:23:16.157
> 
> 标签：iphone, safari, webarchive

有谁知道您是否可以在 iPhone 上以编程方式打开 .webarchive？.webarchive 是 Safari 将网页和相关资源打包成单个文件的方式。

我尝试在移动 safari 中创建一个并浏览到一个链接，但它没有用....

注意：我有点希望这可以在没有 3rd 方应用程序的情况下完成，因为它是打包 WebApp 以在 iphone 上使用而不需要第三方工具的好方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-02-10T01:05:47.840

iOS 支持 webarchive。只需将其加载到 UIWebView 上。它只是工作！

要在您的捆绑包上加载网络存档，只需执行

```
NSURL *fileURL = [[NSBundle mainBundle] URLForResource:@"myFile"
     withExtension:@"webarchive"];

[webView loadRequest:[NSURLRequest requestWithURL:fileURL]]; 
```

webview 是你的 UIWebview

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T13:37:03.570

.webarchive 只是一个 plist；理论上，您可以使用 NSPropertyListSerialization 读取它，然后在手机上构建本地文件结构，然后将其泵入 UIWebView。或者使用 AirSharing。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-05T22:50:10.920

稍微扩展一下上面的建议，如果你只是想获取 HTML，下面的代码片段可能是一个很好的起点。通过检查 webMainResource 字典，您也可以提取其他材料，例如图像。

```
#define WEB_ARCHIVE @"Apple Web Archive pasteboard type"

- (NSString*) htmlStringFromPasteboard;
{
    NSData* archiveData = [[UIPasteboard generalPasteboard] valueForPasteboardType:WEB_ARCHIVE];

    if (archiveData)
    {
        NSError* error = nil;
        id webArchive = [NSPropertyListSerialization propertyListWithData:archiveData options:NSPropertyListImmutable format:NULL error:&error];

        if (error)
        {
            return [NSString stringWithFormat:@"Error: '%@'", [error localizedDescription]];
        }
        NSDictionary* webMainResource = [webArchive objectForKey:@"WebMainResource"];
        NSData * webResourceData = [webMainResource objectForKey:@"WebResourceData"];

        NSString* string = [[NSString alloc] initWithData:webResourceData encoding:NSUTF8StringEncoding];

        return [string autorelease];
    }

    return @"No WebArchive data on the pasteboard just now";

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T13:28:56.877

iPhone 上的 AirSharing 将打开 webarchive 文件，但我不知道他们是自己做这一切还是使用本地 webarchive 支持。

请参阅[http://www.avatron.com/products/](http://www.avatron.com/products/)

# html - 在您的链接中包含 title="" 是否很好？

> ID：225700
> 
> 赞同：22
> 
> 时间：2008-10-22T13:23:18.200
> 
> 标签：html, seo, accessibility

我正在开发一个网站，对于主导航，我认为包含标题属性是个好主意。

```
<a href="/results/" title="Results">Results</a> 
```

这是一件好事吗？此外，它对 SEO 和可访问性有好处吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-22T13:24:14.487

这是一件很棒的事情。为了可访问性，为了 SEO，为了标准，为了良好的网络礼仪。
不过，您可能想让它们更具描述性：title="Results of your Search" 或 "Results of Test #2"

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-22T13:27:16.757

从[这篇文章](http://www.netmechanic.com/news/vol2/html_no1.htm)：

> TITLE 属性在您的 HTML 设计限制链接文本长度的地方很有用。
> 
> 导航栏中的链接通常是这种情况，尤其是当您的页面具有多列布局时。
> 
> 尝试使用 TITLE 属性为访问者提供额外的导航信息。

[早期（1998 年！）对此功能](http://www.useit.com/alertbox/980111.html)的支持有些担忧，但现在它是加强所谓的**[信息气味的好方法](http://www.useit.com/alertbox/20030630.html)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T13:37:00.857

查看[H33：使用标题属性补充链接文本](http://www.w3.org/TR/2007/WD-WCAG20-TECHS-20071211/H33.html "W3C 的一篇关于使用带有链接的标题的文章")。

这样做是为了获得更具语义意义的文档并可能增加 SEO 价值，但不同的浏览器对它的支持程度不同。

*   您无法通过键盘在文档中搜索标题文本
*   您无法控制标题元素的外观、位置或持续时间（无需用一些 Javascript 混蛋替换标题）
*   使用屏幕阅读器的人可能会觉得同时听到链接文本和描述会很尴尬（尽管至少使用 JAWS，您可以更改设置以启用/禁用此功能）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T13:25:36.353

是的，对于使用屏幕阅读器等辅助技术的网站用户来说非常重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T13:26:09.630

如果您想要更详细一点并且没有太多空间用于实际链接文本，这也很有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T13:26:48.863

此外，添加到其他答案中，如果您进行任何自动化测试，最好拥有尽可能多的属性以便能够识别各种小部件。

# winforms - 在 CTRL-A 上停止响铃（WinForms）

> ID：225711
> 
> 赞同：13
> 
> 时间：2008-10-22T13:26:44.370
> 
> 标签：winforms, keyeventargs

任何想法如何阻止系统铃声响起时`CTRL`-`A`用于在 Winforms 应用程序中选择文本？

这就是问题所在。创建一个 Winforms 项目。在表单上放置一个文本框并在表单上添加以下事件处理程序以允许`CTRL`-`A`选择文本框中的所有文本（无论哪个控件具有焦点）。

```
void Form1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.A && e.Modifiers == Keys.Control)
    {
        System.Diagnostics.Debug.WriteLine("Control and A were pressed.");
        txtContent.SelectionStart = 0;
        txtContent.SelectionLength = txtContent.Text.Length;
        txtContent.Focus();
        e.Handled = true;
    }
} 
```

它可以工作，但尽管 e.Handled = true，系统铃声每次都会响起`CTRL`-`A`被按下。

* * *

谢谢回复。

表单上的 KeyPreview 设置为 true - 但这不会阻止系统铃声响起 - 这是我要解决的问题 - 烦人。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-29T20:01:11.173

```
 private void textBox1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Control && e.KeyCode == Keys.A)
        {
            this.textBox1.SelectAll();
            e.SuppressKeyPress = true;
        }
    } 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-23T16:28:44.893

感谢 MSDN 论坛帖子 - 只有当文本框处于多行模式并且您希望实现`Ctrl`+`A`以全选时才会出现此问题。

这是解决方案

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData) 
{
  if (keyData == (Keys.A | Keys.Control)) {
    txtContent.SelectionStart = 0;
    txtContent.SelectionLength = txtContent.Text.Length;
    txtContent.Focus();
    return true;
  }
  return base.ProcessCmdKey(ref msg, keyData);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T13:37:09.390

这对我有用：

将窗体上的 KeyPreview 设置为 True。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-27T23:40:28.083

@H7O 解决方案很好，但我对其进行了一些改进，以便在表单上增加 TextBox 组件。

```
private void textBox_KeyDown(object sender, KeyEventArgs e)
{
  if (e.Control && e.KeyCode == Keys.A)
  {
    ((TextBox)sender).SelectAll();
    e.SuppressKeyPress = true;
  }
} 
```

# c# - 使用 C# 获取 Int/short/byte 结构字节表示

> ID：225717
> 
> 赞同：2
> 
> 时间：2008-10-22T13:28:56.737
> 
> 标签：c#, reflection, marshalling, binary-data

给定一个 FieldInfo 对象和一个对象，我需要获取该字段的实际字节表示。我知道该领域是要么`int,Int32,uint,short`等。

如何获得实际的字节表示？BinaryFormatter.Serialize 无济于事，因为它会给我提供比我需要的更多的信息（它还记录类型名称等）。该类`Marshal`似乎没有使用字节数组的设施（但也许我遗漏了一些东西）。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T13:32:08.370

使用 BitConverter.GetBytes()

您首先必须将值转换为它的本机类型，而不是使用 BitConverter 来获取字节：

```
byte[] Bytes;

if (valType == typeof(int))
{
    int intVal = (int) GetFieldValue(....);
    Bytes = BitConverter.GetBytes(intVval);
} 
else if (valType == typeof(long))
{
    int lngVal = (long) GetFieldValue(....);
    Bytes = BitConverter.GetBytes(lngVal);
} else .... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T13:41:06.760

如果您真正想要的是将结构作为字节数组传输，您也可以尝试以下代码：

```
int rawsize = Marshal.SizeOf(value);
byte[] rawdata = new byte[rawsize];
GCHandle handle = GCHandle.Alloc(rawdata, GCHandleType.Pinned);
Marshal.StructureToPtr(value, handle.AddrOfPinnedObject(), false);
handle.Free(); 
```

这会将给定的对象*值*转换为字节数组 rawdata。我从我之前编写的代码中获取了这一点，您可能需要对其进行调整以使其实际工作。我用它与一些具有用户定义结构的硬件进行通信，但它也应该适用于内置类型（毕竟，它们是结构，不是吗？）

要使结构成员正确对齐，请使用 StructLayout 属性指定一字节对齐：

```
[StructLayout(LayoutKind.Sequential, Pack = 1)] 
```

然后根据需要对字段使用 MarshalAs 属性，例如对于内联数组：

```
[MarshalAs(UnmanagedType.ByValArray, SizeConst = 8)]
byte[] _state; 
```

从字节数组中取回结构的代码是这样的：

```
public T GetValue<T>()
{
    GCHandle handle = GCHandle.Alloc(RawValue, GCHandleType.Pinned);
    T structure = (T)Marshal.PtrToStructure(handle.AddrOfPinnedObject(), 
                      typeof(T));
    handle.Free();
    return structure;
} 
```

当然，您需要知道要使其正常工作的类型。

请注意，这不会自行处理字节序。在我的项目中，大多数字段只有一个字节，所以没关系，但对于少数几个字段，我只是将字段设为私有并添加公共属性来处理字节顺序（[Jon Skeet 的链接](http://pobox.com/~skeet/csharp/miscutil)来自对他的回答发表评论可能会对您有所帮助，我为此编写了一些实用程序函数，因为我只需要很少）。

当我需要这个时，我创建了一个 Message 类来存储原始值（因此 GetValue 方法，顶部的代码实际上是 SetValue 方法的主体）并有一些很好的方便方法来获取格式化的值等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T13:32:53.873

你的意思是最终的内存表示吗？BitConverter.GetBytes (with an overload suitably chosen by reflection) will return you *a* byte representation, but not necessarily what it is currently in memory.

也许如果您提供更多关于您为什么想要这个的信息，我们将能够更好地为您提供帮助。

编辑：我应该补充一点，在我能想到的任何合理情况下，BitConverter*都会*为您提供与内存中相同的表示形式 - 但可能存在涉及字节序的奇怪情况，并且可能存在具有不同浮点表示形式的奇怪架构，这可能会产生奇怪的结果。

编辑：这是一个完整的示例程序，展示了您可能如何去做：

```
using System;
using System.Reflection;

public class Test
{
    public int x = 300;

    static void Main()
    {
        Test instance = new Test();
        FieldInfo field = typeof(Test).GetField("x");

        MethodInfo converter = typeof(BitConverter).GetMethod("GetBytes", 
            new Type[] {field.FieldType});

        if (converter == null)
        {
            Console.WriteLine("No BitConverter.GetBytes method found for type "
                + field.FieldType);            
        }
        else
        {
            byte[] bytes = (byte[]) converter.Invoke(null,
                new object[] {field.GetValue(instance) });
            Console.WriteLine("Byte array: {0}", BitConverter.ToString(bytes));
        }        
    }
} 
```

# vb.net - 使用 GridView 和 LINQ 进行排序的最佳方法是什么？

> ID：225725
> 
> 赞同：3
> 
> 时间：2008-10-22T13:31:05.157
> 
> 标签：vb.net, linq, linq-to-sql, gridview

LINQ 对我来说似乎缺少的一件事是一种通过文本字符串引用列的方法。例如，我有一个典型的 GridView 设置了这样的排序（数据源绑定到代码隐藏中的 LINQ 查询）：

```
<asp:GridView ID="MyGridView" runat="server" AllowSorting="True">
    <Columns>
        <asp:BoundField DataField="field1" SortExpression="field1" HeaderText="Field 1" />
        <asp:BoundField DataField="field2" SortExpression="field2" HeaderText="Field 2" />
        <%-- etc. --%>
    </Columns>
</asp:GridView> 
```

为了使排序工作，我必须在 MyGridView_Sorting 事件处理程序中使用两个巨大的 Select 语句（处理升序和降序）：

```
Dim query = From t In context.MyTables

If e.SortDirection = SortDirection.Ascending Then
    Select Case e.SortExpression
        Case "field1"
            query = query.OrderBy(Function(x) x.field1)
        Case "field2"
            query = query.OrderBy(Function(x) x.field2)
        'etc.'
    End Select
Else
    Select Case e.SortExpression
        Case "field1"
            query = query.OrderByDescending(Function(x) x.field1)
        Case "field2"
            query = query.OrderByDescending(Function(x) x.field2)
        'etc.'
    End Select
End If 
```

必须有更好的方法来做到这一点，不是吗？我从网格中获取字段名称和排序方向 - 您认为有一种方法可以轻松地将其提供给 LINQ 查询，而无需逐个字段地翻译它。有人有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T14:16:47.827

您可能想查看这篇题为[使用 LINQ 表达式树的自排序 GridView 的文章](http://www.singingeels.com/Articles/Self_Sorting_GridView_with_LINQ_Expression_Trees.aspx)

# python - Batch Renaming of Files in a Directory

> ID：225735
> 
> 赞同：106
> 
> 时间：2008-10-22T13:33:23.407
> 
> 标签：python, file-io, rename, batch-rename

Is there an easy way to rename a group of files already contained in a directory, using Python?

**Example:** I have a directory full of *.doc files and I want to rename them in a consistent way.

> X.doc -> "new(X).doc"
> 
> Y.doc -> "new(Y).doc"

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2011-10-27T14:53:14.117

I prefer writing small one liners for each replace I have to do instead of making a more generic and complex code. E.g.:

This replaces all underscores with hyphens in any non-hidden file in the current directory

```
import os
[os.rename(f, f.replace('_', '-')) for f in os.listdir('.') if not f.startswith('.')] 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2008-10-22T18:59:57.850

Such renaming is quite easy, for example with [os](http://docs.python.org/lib/module-os.html) and [glob](http://docs.python.org/lib/module-glob.html) modules:

```
import glob, os

def rename(dir, pattern, titlePattern):
    for pathAndFilename in glob.iglob(os.path.join(dir, pattern)):
        title, ext = os.path.splitext(os.path.basename(pathAndFilename))
        os.rename(pathAndFilename, 
                  os.path.join(dir, titlePattern % title + ext)) 
```

You could then use it in your example like this:

```
rename(r'c:\temp\xx', r'*.doc', r'new(%s)') 
```

The above example will convert all `*.doc` files in `c:\temp\xx` dir to `new(%s).doc`, where `%s` is the previous base name of the file (without extension).

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-10-22T19:30:05.743

If you don't mind using regular expressions, then this function would give you much power in renaming files:

```
import re, glob, os

def renamer(files, pattern, replacement):
    for pathname in glob.glob(files):
        basename= os.path.basename(pathname)
        new_filename= re.sub(pattern, replacement, basename)
        if new_filename != basename:
            os.rename(
              pathname,
              os.path.join(os.path.dirname(pathname), new_filename)) 
```

So in your example, you could do (assuming it's the current directory where the files are):

```
renamer("*.doc", r"^(.*)\.doc$", r"new(\1).doc") 
```

but you could also roll back to the initial filenames:

```
renamer("*.doc", r"^new\((.*)\)\.doc", r"\1.doc") 
```

and more.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-12-04T09:46:49.960

I have this to simply rename all files in subfolders of folder

```
import os

def replace(fpath, old_str, new_str):
    for path, subdirs, files in os.walk(fpath):
        for name in files:
            if(old_str.lower() in name.lower()):
                os.rename(os.path.join(path,name), os.path.join(path,
                                            name.lower().replace(old_str,new_str))) 
```

I am replacing all occurences of old_str with any case by new_str.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-22T13:37:36.907

Try: [http://www.mattweber.org/2007/03/04/python-script-renamepy/](http://www.mattweber.org/2007/03/04/python-script-renamepy/)

> I like to have my music, movie, and picture files named a certain way. When I download files from the internet, they usually don’t follow my naming convention. I found myself manually renaming each file to fit my style. This got old realy fast, so I decided to write a program to do it for me.
> 
> This program can convert the filename to all lowercase, replace strings in the filename with whatever you want, and trim any number of characters from the front or back of the filename.

The program's source code is also available.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-04-15T05:56:20.827

I've written a python script on my own. It takes as arguments the path of the directory in which the files are present and the naming pattern that you want to use. However, it renames by attaching an incremental number (1, 2, 3 and so on) to the naming pattern you give.

```
import os
import sys

# checking whether path and filename are given.
if len(sys.argv) != 3:
    print "Usage : python rename.py <path> <new_name.extension>"
    sys.exit()

# splitting name and extension.
name = sys.argv[2].split('.')
if len(name) < 2:
    name.append('')
else:
    name[1] = ".%s" %name[1]

# to name starting from 1 to number_of_files.
count = 1

# creating a new folder in which the renamed files will be stored.
s = "%s/pic_folder" % sys.argv[1]
try:
    os.mkdir(s)
except OSError:
    # if pic_folder is already present, use it.
    pass

try:
    for x in os.walk(sys.argv[1]):
        for y in x[2]:
            # creating the rename pattern.
            s = "%spic_folder/%s%s%s" %(x[0], name[0], count, name[1])
            # getting the original path of the file to be renamed.
            z = os.path.join(x[0],y)
            # renaming.
            os.rename(z, s)
            # incrementing the count.
            count = count + 1
except OSError:
    pass 
```

Hope this works for you.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-09-03T21:43:41.870

> Be in the directory where you need to perform the renaming.

```
import os
# get the file name list to nameList
nameList = os.listdir() 
#loop through the name and rename
for fileName in nameList:
    rename=fileName[15:28]
    os.rename(fileName,rename)
#example:
#input fileName bulk like :20180707131932_IMG_4304.JPG
#output renamed bulk like :IMG_4304.JPG 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-30T08:37:46.327

```
directoryName = "Photographs"
filePath = os.path.abspath(directoryName)
filePathWithSlash = filePath + "\\"

for counter, filename in enumerate(os.listdir(directoryName)):

    filenameWithPath = os.path.join(filePathWithSlash, filename)

    os.rename(filenameWithPath, filenameWithPath.replace(filename,"DSC_" + \
          str(counter).zfill(4) + ".jpg" ))

# e.g. filename = "photo1.jpg", directory = "c:\users\Photographs"        
# The string.replace call swaps in the new filename into 
# the current filename within the filenameWitPath string. Which    
# is then used by os.rename to rename the file in place, using the  
# current (unmodified) filenameWithPath.

# os.listdir delivers the filename(s) from the directory
# however in attempting to "rename" the file using os 
# a specific location of the file to be renamed is required.

# this code is from Windows 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-18T21:15:53.330

I had a similar problem, but I wanted to append text to the beginning of the file name of all files in a directory and used a similar method. See example below:

```
folder = r"R:\mystuff\GIS_Projects\Website\2017\PDF"

import os

for root, dirs, filenames in os.walk(folder):

for filename in filenames:  
    fullpath = os.path.join(root, filename)  
    filename_split = os.path.splitext(filename) # filename will be filename_split[0] and extension will be filename_split[1])
    print fullpath
    print filename_split[0]
    print filename_split[1]
    os.rename(os.path.join(root, filename), os.path.join(root, "NewText_2017_" + filename_split[0] + filename_split[1])) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-08-17T11:59:31.467

as to me in my directory I have multiple subdir, each subdir has lots of images I want to change all the subdir images to 1.jpg ~ n.jpg

```
def batch_rename():
    base_dir = 'F:/ad_samples/test_samples/'
    sub_dir_list = glob.glob(base_dir + '*')
    # print sub_dir_list # like that ['F:/dir1', 'F:/dir2']
    for dir_item in sub_dir_list:
        files = glob.glob(dir_item + '/*.jpg')
        i = 0
        for f in files:
            os.rename(f, os.path.join(dir_item, str(i) + '.jpg'))
            i += 1 
```

(mys own answer)[https://stackoverflow.com/a/45734381/6329006](https://stackoverflow.com/a/45734381/6329006 "mys own answer")

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-04-02T15:57:25.047

```
#  another regex version
#  usage example:
#  replacing an underscore in the filename with today's date
#  rename_files('..\\output', '(.*)(_)(.*\.CSV)', '\g<1>_20180402_\g<3>')
def rename_files(path, pattern, replacement):
    for filename in os.listdir(path):
        if re.search(pattern, filename):
            new_filename = re.sub(pattern, replacement, filename)
            new_fullname = os.path.join(path, new_filename)
            old_fullname = os.path.join(path, filename)
            os.rename(old_fullname, new_fullname)
            print('Renamed: ' + old_fullname + ' to ' + new_fullname 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-07-26T14:38:24.010

If you would like to modify file names in an editor (such as vim), the [click](https://click.palletsprojects.com/en/7.x/) library comes with the command `click.edit()`, which can be used to receive user input from an editor. Here is an example of how it can be used to refactor files in a directory.

```
import click
from pathlib import Path

# current directory
direc_to_refactor = Path(".")

# list of old file paths
old_paths = list(direc_to_refactor.iterdir())

# list of old file names
old_names = [str(p.name) for p in old_paths]

# modify old file names in an editor,
# and store them in a list of new file names
new_names = click.edit("\n".join(old_names)).split("\n")

# refactor the old file names
for i in range(len(old_paths)):
    old_paths[i].replace(direc_to_refactor / new_names[i]) 
```

I wrote a command line application that uses the same technique, but that reduces the volatility of this script, and comes with more options, such as recursive refactoring. Here is the link to the [github page](https://github.com/Jim-Shaddix/bulkrename). This is useful if you like command line applications, and are interested in making some quick edits to file names. (My application is similar to the "bulkrename" command found in [ranger](https://github.com/ranger/ranger)).

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-09T04:46:04.520

# This code will work

# The function exactly takes two arguments f_patth as your path to rename file and new_name as your new name to the file.

```
import glob2
import os

def rename(f_path, new_name):
    filelist = glob2.glob(f_path + "*.ma")
    count = 0
    for file in filelist:
        print("File Count : ", count)
        filename = os.path.split(file)
        print(filename)
        new_filename = f_path + new_name + str(count + 1) + ".ma"
        os.rename(f_path+filename[1], new_filename)
        print(new_filename)
        count = count + 1 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-30T19:19:59.910

Building off of Cesar Canassa [comment](https://stackoverflow.com/a/7917798/16790441) above.

```
import os
[os.rename(f, f.replace(f[f.find('___'):], '')) for f in os.listdir('.') if not f.startswith('.')] 
```

This will find three underscores (_) and replace them and everything after them with nothing ('').

# java - 有谁知道一个好的开源评论模块？

> ID：225736
> 
> 赞同：2
> 
> 时间：2008-10-22T13:33:41.113
> 
> 标签：java, comments

我想添加在现有网站集上提交、审核和显示评论的功能。当然，已经有很多开源组件可以处理以下内容：

1.  评论提交
2.  标记验证
3.  私人评论审核
4.  线程评论显示
5.  本地安装（因此可以与我现有的注册用户无缝协作）

我查看了几个系统，例如[disqus](http://disqus.disqus.com "disqus")，但它们失败了，因为它们要么是远程托管的，要么没有连接到我现有的注册用户集。

我们现有的系统是用 Java 实现的，所以如果评论系统也是 Java，那将是一个额外的好处。

* * *

有趣的是，由于网络上包含“评论”一词的页面数量庞大，谷歌在查找评论模块方面几乎毫无用处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:06:33.917

看看[黛米酱](http://code.google.com/p/demisauce/)。

从谷歌代码描述：

> Demi Sauce 是一个为其他应用程序提供 Web 服务的应用程序。它在您的环境中作为服务器运行，其他应用程序像使用 Javascript 嵌入或 xml Web 服务的软件组件一样使用它。Demi Sauce 不是在一个框架之上构建以在您的原生应用程序之上获得额外的功能，而是基于 Web 服务来保持它分离但很容易与您的软件应用程序集成。您可以通过调用简单的 Web 服务或将 javascript 嵌入到您的应用程序（如谷歌分析，但用于评论、反馈/帮助等）在现有应用程序中使用它。这允许 DemiSauce 服务器提供的相同内容和服务在多个应用程序中使用在你的环境中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T14:08:45.160

至于论坛上的垃圾邮件，您可以使用 Mollom ( [http://mollom.com/](http://mollom.com/) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:40:18.477

好吧，我认为这里的问题是评论，一个人真的需要评论*Something*，所以几乎你发现的任何应用程序也将包括Something（如博客引擎）。

此外，在不知道您网站上的某物是什么的情况下，很难编写一个可以附加评论的应用程序。

# wcf - WCF 客户端和版本控制

> ID：225739
> 
> 赞同：3
> 
> 时间：2008-10-22T13:34:15.713
> 
> 标签：wcf, versioning

如果我更改 WCF，是否必须在所有访问该服务的客户端计算机上运行某种更新？（即运行 svutils.exe 并更新所有 app.config 等？）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T14:37:45.007

阅读有关数据联系人版本控制的信息：

[数据联系人版本控制：](http://msdn.microsoft.com/en-us/library/ms731138.aspx)

[前向兼容的数据合约](http://msdn.microsoft.com/en-us/library/ms731083.aspx)

[最佳实践：数据合同版本控制](http://msdn.microsoft.com/en-us/library/ms733832.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T13:44:13.993

除非消息发生更改并且使用您的服务需要更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T13:49:45.213

如果 WCF 方法的签名没有改变，那么您将不需要更新客户端。如果需要，您可以向服务添加新方法，而不是更改现有方法的签名。

# c# - 如何使用代码设置 Windows 窗体窗体的 StartPosition？

> ID：225741
> 
> 赞同：17
> 
> 时间：2008-10-22T13:34:23.140
> 
> 标签：c#, .net, winforms

有没有办法使用代码设置 Windows 窗体窗体的 StartPosition？似乎无论我尝试什么都会导致 StartPostion 成为默认值。

这是我在表单中显示的内容：

```
 public DealsForm()
    {
        InitializeComponent();
        this.StartPosition = FormStartPosition.CenterParent;
    } 
```

这是我为显示表单所做的工作：

```
 private void nvShowDeals_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
    {
        DealsForm frm = new DealsForm();

        frm.DataSource = this.Deals;

        frm.Show(this);
    } 
```

我尝试在上述每种方法中添加以下内容，但无济于事：

```
this.StartPosition = FormStartPosition.CenterParent; 
```

如果我通过属性编辑器设置它......它工作得很好，但我**真的**很想通过代码来做。

应该是不费吹灰之力的......但对于我的生活，我似乎无法弄清楚......也许我需要更多的咖啡因。

### 更新：

如果我做 a`ShowDialog()`并传递父级它可以工作......但我真的不想将它显示为一个对话框。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-22T14:09:23.787

也许你并不孤单。也许你并不疯狂。阅读此内容（Microsoft Connect 客户反馈）：

[Windows 窗体 StartPosition 属性仅适用于 .ShowDialog 方法，不适用于 .Show 方法](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=107589)

*客户：“Windows 窗体 StartPosition 仅适用于 .ShowDialog 方法，不适用于 .Show 方法。注意：我还附上了简单的代码和结果图像。”*

*MS：“不幸的是，我们将无法在未来的版本中修复这个特定问题，因为这里的修复将对 WinForms 1、1.1 和 2 的行为进行重大更改”*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-22T14:01:58.963

> 如果我执行 ShowDialog() 并传递父级，它可以工作......但我真的不想将它显示为对话框。

这是正确的，因为 ShowDialog 会设置 frm.Parent == nvShowDeals.Parent
因为您使用的是 .Show() 然后 frm.Parent == null 因此 FormStartPosition.CenterParent 被忽略。

因此，要完成此功能，我将进行以下更改：

```
public DealsForm()
{
    InitializeComponent();
    //this.StartPosition = FormStartPosition.CenterParent;
}

//DealsForm_Load Event
private void DealsForm_Load(object sender, EventArgs e)
{
    this.Location = this.Owner.Location;  //NEW CODE
} 
```

在这里，我将进行以下更改：

```
private void nvShowDeals_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
{
    DealsForm frm = new DealsForm();

    frm.DataSource = this.Deals;
    frm.StartPosition = FormStartPosition.Manual; //NEW CODE
    frm.Show(this);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-25T14:08:08.677

您可以通过在 Form_Load 事件中调用 this.CenterToParent() 来执行此操作（当实际知道父级时）。不要在构造函数中调用它，因为它在调用 Show(form) 时设置的父级。

```
private void myForm_Load(object sender, EventArgs e)
{
    CenterToParent();
} 
```

我知道这个帖子很旧，但可以很容易地回答，所以希望能帮助遇到它的其他人找到简单的解决方案。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-23T19:54:11.397

要以 .Show 调用的父级为中心，这就是我必须做的：

```
childForm.Location = new Point(
    (parentForm.Location.X + parentForm.Width / 2) - (childForm.Width / 2), 
    (parentForm.Location.Y + parentForm.Height / 2) - (childForm.Height / 2));
childForm.StartPosition = FormStartPosition.Manual; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T13:40:31.690

您是否尝试在调用方法中设置属性？

```
private void nvShowDeals_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
{
    DealsForm frm = new DealsForm();

    frm.DataSource = this.Deals;

    // Insert this
    frm.StartPosition = FormStartPosition.CenterParent;

    frm.Show(this);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T13:43:38.207

```
public DealsForm()
{
    InitializeComponent();
    this.StartPosition = FormStartPosition.CenterParent;       
} 
```

试着把它放在 InitializeComponent() 之前。在 InitializeComponent 之后可能已经太晚了（表单可能已经启动并且 StatPosition 设置得太晚了）。

# 更新

我刚刚写道：

```
public Form1()
{
    InitializeComponent();
    this.StartPosition = FormStartPosition.CenterScreen;
} 
```

和：

```
private void button1_Click(object sender, EventArgs e)
{
    Form1 f = new Form1();
    f.Show();
} 
```

在一个 VS 项目（全新）中，当我在我的 form2 中单击一个按钮时，它会在屏幕中间打开表单。你可以对父母做同样的事情......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T13:49:35.637

我建议检查您的 DealsForm.Designer.cs 并删除在那里设置 StartPosition 的行，然后照常做。

或者，也许尝试在表单的 Load 或 Shown 事件中设置它。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-10-22T13:40:29.133

我的第一反应是：用 VS2008 试验一下。它应该在一般属性屏幕中。

如果您没有 Visual Studio，那么它会变得有点困难。

一个值得检查的好网站可能是这个：[csharp-online.net](http://en.csharp-online.net/CSharp_Certification%2C_Development%2C_and_Training)

对不起，我不能更有帮助

# windows-vista - 在带有 UAC 的 Vista 上使用带有 Windows AccessCheck() 的 SSPI (NTLM) Api

> ID：225757
> 
> 赞同：0
> 
> 时间：2008-10-22T13:38:29.230
> 
> 标签：windows-vista, uac, sspi

摘要 客户端 (Windows XP SP3) 服务器 (Windows Vista Business SP1) / 作为 LocalSystem 服务运行

Api 序列客户端 - AcquireCredentialsHandle 客户端 - Initializesecuritycontext 服务器 - Acquirecredentialhandle 服务器 - AcceptSecurityContext 客户端/服务器 - CompleteAuthnToken 服务器 - ImpersonateSecurityContext 服务器 - AccessCheckAndAuditAlarm (MAXIMUM_allowed) 服务器 - 然后我将请求的访问与允许的访问进行比较。

我对使用 createprivateobjectsecurityex 创建的私有安全对象调用访问检查。打开 Uac 后，我从 accesscheck 中获得了成功，但没有任何特权被保留。关闭 uac 后，我可以通过 GantedAccess 参数中的所有权限获得成功

详细信息 该应用程序有两个组件，一个客户端和一个服务器。它使用 tcp 通过不安全的网络进行通信。为了验证传入连接，我使用上面列出的 sspi api，并模拟调用用户。一旦调用用户被模拟，我使用 Accesscheckandauditalarm，如果失败，我将恢复为仅 accesscheck。打开 UAC 后，我从 accesscheckandauditalarm 获得了成功，但所有访问权限都不在 grandedaccess 参数中，但如果 uac 关闭，它会按预期工作。我检查了服务器进程的完整性级别并将其设置为高，我查看了用于模拟调用用户的模拟令牌的完整性级别并将其设置为中。我尝试将调用用户的完整性级别设置为高，成功，但访问检查仍然返回不正确的结果。想我可能有一个链接令牌，我尝试调用 GetTOkenInformation(TokenLInkedToken) 链接令牌，结果为 0x520。任何关于我下一步可能尝试的想法将不胜感激。

验证后的代码。

```
SECURITY_STATUS ss = SEC_E_OK; 
 HANDLE _hToken = NULL; 
 ss = QuerySecurityContextToken((PCtxtHandle)pContext,&_hToken); 
 if(SEC_E_OK != ss) 
 { 
  return ss; 
 } 
 CAccessToken impToken; 
 impToken.Attach(_hToken); 
 if(CWin32::IsVista()) 
 { 
  /*TOKEN_LINKED_TOKEN linkedToken; 
  DWORD nLen = 0; 
  BOOL bRet = GetTokenInformation(_hToken, 
(TOKEN_INFORMATION_CLASS)TokenLinkedToken,&linkedToken,sizeof(linkedToken), &nLen); 
  if(bRet) 
  { 
   CloseHandle(impToken.Detach()); 
   impToken.Attach(linkedToken.LinkedToken); 
  } 
  else 
  { 
   TRACE(_T("GetTokenInfo Failed 0x%x\n"),GetLastError()); 
  }*/ 
  PSID    pHighIntegritySid = NULL; 
  BOOL bConvertSid = FALSE; 
  bConvertSid = ConvertStringSidToSid(SDDL_ML_HIGH, 
&pHighIntegritySid); 
  if (bConvertSid) 
  { 
   TOKEN_MANDATORY_LABEL TML = {0}; 
   TML.Label.Attributes = SE_GROUP_INTEGRITY | 
SE_GROUP_INTEGRITY_ENABLED; 
   TML.Label.Sid        = pHighIntegritySid; 
   BOOL bSetTokenRet = SetTokenInformation(_hToken, 
(TOKEN_INFORMATION_CLASS)TokenIntegrityLevel,&TML,sizeof(TML) + 
GetLengthSid(pHighIntegritySid)); 
   LocalFree(pHighIntegritySid); 
   if(!bSetTokenRet) 
   { 
    nReturn = GetLastError(); 
    DBGOUT(DebugOut::LOG_COMP_AUTH_LAYER,DebugOut::LOG_DETAIL_ERROR, 
     _T("Failed to set Token information %x\n"),nReturn); 
    return nReturn; 
   } 
  } 
 } 
 bool bRet = impToken.Impersonate(); 
 if(false == bRet) 
 { 
  return GetLastError(); 
 } 
 _GetTokenSecurityLevel(impToken.GetHandle()); 
 ::MapGenericMask(&nRights, GetGENERIC_MAPPING()); 
 DWORD nAccessGranted = 0; 
 BOOL bAccessStatus = FALSE; 
 BOOL bGenerateOnClose = FALSE; 
 BOOL bAccessCheckRet = FALSE; 
 bAccessCheckRet = ::AccessCheckAndAuditAlarm(_T("Purgos 
Security"),impToken.GetHandle(),_T("Purgos"),m_csObjectName.GetBuffer(0), 
const_cast<SECURITY_DESCRIPTOR*>(m_ObjectSD.GetPSECURITY_DESCRIPTOR())/ 
*privObjectSD.GetPSECURITY_DESCRIPTOR())*/,MAXIMUM_ALLOWED,GetGENERIC_MAPPI NG(),FALSE,&nAccessGranted,&bAccessStatus,&bGenerateOnClose); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T03:45:57.787

为所有相关方找到解决方案。

问题在于被验证的用户是本地帐户，默认情况下，本地帐户具有过滤令牌，其中 BUILTIN\Administrators 组具有拒绝 ACL。我正在检查 BUILTIN\Administrators 组的权限。所以不得不设置注册表设置或使用域帐户。

瑞安

# cygwin - 安全地更改主目录

> ID：225764
> 
> 赞同：82
> 
> 时间：2008-10-22T13:40:15.950
> 
> 标签：cygwin, etcpasswd

我正在尝试按照 中指定的方式安全地更新主目录`/etc/passwd`，但 Cygwin 不提供用于执行此操作的标准 Linux 实用程序 - usermod 和 vipw。

谁能告诉我他们是如何在 Cygwin 中改变这个的？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-11-29T05:52:02.903

**编辑：**对于 Cygwin 的最新版本（1.7.34 及更高版本），请参阅[这个较新的问题](https://stackoverflow.com/q/1494658/1858225)。

就像 sblundy 的回答一样，您始终可以手动编辑。

但是，如果您想以“官方”方式进行操作，请使用 cygwin-specific[**`mkpasswd`**](https://cygwin.com/cygwin-ug-net/mkpasswd.html)命令。以下是官方文档的片段[`mkpasswd`](https://cygwin.com/cygwin-ug-net/mkpasswd.html)：

> 例如，这个命令：
> 
> **例 3.11。使用备用主根**
> 
> ```
> $ mkpasswd -l -p "$(cygpath -H)" > /etc/passwd 
> ```
> 
> 会将本地用户的主目录放在 Windows 的“配置文件”目录中。

[**Cygwin Utilities**](http://cygwin.com/cygwin-ug-net/using-utils.html)文档页面（包括`mkpasswd`）中描述了许多其他非常有用的命令。上面示例中的使用`cygpath`是这些 cygwin 特定工具中的另一个。

在阅读过程中，您可能还想阅读[Using Cygwin Effectively with Windows](http://cygwin.com/cygwin-ug-net/using-effectively.html)文档。有很多非常好的建议。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-22T14:56:32.427

我最终退出了我所有的 cygwin shell 并在文本编辑器中手动编辑它。到现在为止还挺好。

注意：不要转义“文档和设置”目录中的空格。条目看起来像

```
user:...:/cygdrive/c/Documents and Settings/user:/bin/bash 
```

该行在`:`字符上被标记化。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-04-25T18:28:27.940

我找到的最简单的答案是使 /home 成为您的 Windows Home/UserProfile 目录的软链接

```
cd /
mv home oldhome
ln -s "$(cygpath -H)" home 
```

我使用了 cygpath，因为它会在当前版本的 Windows 上为 HOME 目录获取正确的位置。在我的盒子上`cygpath -H`返回`/cygdrive/c/Users`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-04-22T14:38:47.177

对于当前用户，以下内容对我有用：

1.  关闭 Cygwin。
2.  设置 HOME Windows 用户环境变量。
3.  启动 Cygwin。
4.  运行“mkpasswd -c -p”$（cygpath -H）“> /etc/passwd”。
5.  重新启动 Cygwin。

我通过不带任何参数运行 ssh-keygen 确认它有效。进行此更改后，应用程序现在默认将密钥保存到 /cygdrive/c/Users/user 而不是 /home/user。

我不知道是否需要设置 HOME，但我还是按照使用 Tortoise 的官方文档[在此处](https://tortoisegit.org/docs/tortoisegit/tgit-dug-settings.html#tgit-dug-settings-main)使用 Tortoise 的非官方 Cygwin 支持设置 TortoiseGit 和 Cygwin 的说明进行了设置。虽然单独设置 HOME 不足以让 ssh-keygen 识别主目录更改。

另外，请注意 Cygwin 关于这个问题的官方文档可以在[这里](http://cygwin.com/cygwin-ug-net/using-utils.html#utils-althome-ex)找到。

在使用 64 位 Cygwin v1.7.35 的 Windows 7 中确认。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T13:54:16.563

我总是在计算机属性中将 HOME 设置为用户特定的环境变量。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-12T05:03:08.903

为避免因主目录路径中有空格而导致的问题，请使用 Windows 'Profiles' 目录的缩写形式 - 即`/cygdrive/c/DOCUME~1/user`.

您可以通过键入以下命令来执行此操作：

```
mkpasswd -l -p "$(cygpath $(cygpath -dH))" > /etc/passwd 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-11-23T05:46:32.927

> 来自[其他地方](https://stackoverflow.com/q/1494658/193617)的[克里斯托弗](https://stackoverflow.com/users/193617/christopher)的原始[答案](https://stackoverflow.com/a/11182877/193617)

### Cygwin 1.7.34+

对于使用**Cygwin 1.7.34**或更高版本的用户，Cygwin 支持配置如何在`/etc/nsswitch.conf`. Cygwin 用户指南部分对此进行了详细说明：

*   [Cygwin 用户名、主目录、登录 shell](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-passwdinfo)

如果您之前创建了一个`/etc/passwd`or`/etc/group`文件，您将希望删除这些文件并使用新的 Windows 安全模型到 POSIX 映射来配置 Cygwin。

```
[[ -f /etc/passwd ]] && mv /etc/passwd /etc/passwd.bak
[[ -f /etc/group ]] && mv /etc/group /etc/group.bak 
```

该`/etc/nsswitch.conf`文件的`db_home:`设置定义了 Cygwin 如何获取用户的主目录。默认设置`db_home:`为

```
db_home: /home/%U 
```

所以默认情况下，Cygwin 只是将主目录设置为`/home/$USERNAME`. 您可以将其更改为指向您想要的任何其他自定义路径。支持的通配符有：

*   `%u`Cygwin 用户名（小写的 u）。
*   `%U`Windows 用户名（大写的 U）。
*   `%D`NetBIOS 风格的 Windows 域。
*   `%H`POSIX 风格的 Windows 主目录。请注意，对于`db_home:`设置，这仅在前面的斜杠之后才有意义，如`db_home: /%H/cygwin`
*   `%_`由于空格和 TAB 字符用于分隔模式，因此文件名中的空格必须指定为`%_`（即下划线）。
*   `%%`一个百分比字符。

您可以指定预定义的四个命名路径模式之一来代替路径。

1.  `windows`用户的主目录设置为与 Windows 主目录相同的目录，通常类似于`%USERPROFILE%`或`C:\Users\$USERNAME`。当然，Windows 目录是由 Cygwin 转换为 POSIX 样式的。

2.  `cygwin`仅限 AD：用户的主目录设置为 cygwinUser 辅助类的 cygwinHome 属性中给出的 POSIX 路径。另请参阅[名为“cygwin 模式”的部分</a>。](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin)

[](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin)
4.  [`unix`仅限 AD：用户的主目录设置为 posixAccount 辅助类的 unixHomeDirectory 属性中给出的 POSIX 路径。另请参阅](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin)[名为“unix 模式”的部分</a>。](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin)

[*   `desc`用户的主目录设置为在 SAM 或 AD 中用户的描述属性中的 home="..." XML 类似设置中给出的 POSIX 路径。有关详细说明，请参阅名为“描述模式”的部分。](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin) 

 [以下将使 Cygwin 中的用户主目录与用于 Windows 主目录的相同。

```
db_home: windows 
```

### Cygwin 1.7.33 或更早版本](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin) 

[对于使用**Cygwin 1.7.33**或更早版本的用户，请更新到](https://www.cygwin.com/cygwin-ug-net/ntsec.html#ntsec-mapping-nsswitch-cygwin)[最新版本的 Cygwin](https://cygwin.org/install.html)并删除以前使用的`/etc/passwd`和`/etc/group`文件，然后参见上述步骤。

否则，请按照以下这些较早的步骤操作。

首先，为指向您的用户配置文件的 HOME 设置一个 Windows 环境变量：

1.  在*控制面板*上打开*系统*
**   在*高级*选项卡上单击*环境变量*（向底部）*   在用户变量区域中单击“新建...”*   对于变量名称输入`HOME`*   对于变量值输入`%USERPROFILE%`*   在所有打开的对话框中单击“确定”以应用此新设置*

 *现在我们将使用刚刚创建`/etc/passwd`的 Windows`%HOME%`变量更新 Cygwin 文件。Shell 登录和远程登录通过`ssh`将依靠`/etc/passwd`告诉他们用户`$HOME`路径的位置。

在 Cygwin bash 命令提示符处键入以下内容：

```
cp /etc/passwd /etc/passwd.bak
mkpasswd -l -p $(cygpath -H)  > /etc/passwd 
mkpasswd -d -p $(cygpath -H)  >> /etc/passwd 
```

该`-d`开关告诉 mkpasswd 包括 DOMAIN 用户，而`-l`is 只输出 LOCAL 机器用户。如果您在工作中使用从 Windows 域控制器获取用户信息的 PC，这一点很重要。

现在，您也可以对组执行相同的操作，但除非您将使用属于 Windows 域的计算机，否则这不是必需的。Cygwin 从 Windows 帐户数据库中读取组信息，但`/etc/group`如果您的机器经常与其域控制器断开连接，您可以添加一个文件。

在 Cygwin bash 提示符下键入以下内容：

```
cp /etc/group /etc/group.bak
mkgroup -l > /etc/group 
mkgroup -d >> /etc/group 
```

现在，退出 Cygwin 并重新启动它。您应该会发现您的 HOME 路径与您的 Windows 用户配置文件指向相同的位置 - 即`/cygdrive/c/Users/username`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-13T02:15:00.303

我喜欢让我的 cygwin 安装同步到笔式驱动器和另一台计算机，所以我讨厌硬编码主目录。我使用以下 cygwin.bat：

```
echo off
SETLOCAL
set SHELL=\\bin\\bash
set HOME=%~dp0..\..\doc\unix
bin\bash --login -i
ENDLOCAL 
```

SETLOCAL 和 ENDLOCAL 确保 SHELL 和 HOME 不会破坏其他程序的现有环境变量。`HOME=%~dp0..\..\doc\unix`将 HOME 设置为两个目录，在 doc/unix 子目录中。然后在 ....\doc\unix.bashrc 中，我包含`PATH="/bin:/usr/local/bin:/usr/X11R6/bin:/usr/bin"`. 我没有`start /wait %CD%\bin\bash`用来启动 bash，因为我使用的是[Console2](http://portableapps.com/apps/utilities/console_portable)，所以我不需要额外的 cmd 窗口。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-05-30T15:01:15.377

# 使用 Windows 环境变量：HOME

这对我来说适用于永久、非便携式、非网络解决方案；即在 Windows 中永久设置 HOME 环境变量。

**请注意**，这不会影响始终引用*/etc/passwd的**ssh*或*telnet会话*

 **[参考：设置 Cygwin-我的 HOME 环境变量不是我想要的。](http://cygwin.com/faq/faq.setup.html#faq.setup.home "我的 HOME 环境变量不是我想要的。")*

## 命令

对于*当前*用户（每个用户需要运行一次）::

```
reg add HKCU\Environment /v HOME /t REG_EXPAND_SZ /d ^%USERPROFILE^% 
```

对于*新*用户：

```
reg add HKU\.DEFAULT\Environment /v HOME /t REG_EXPAND_SZ /d ^%USERPROFILE^% 
```

**注意：**插入符号^*在*百分号之前 %

## 导入注册文件

导入此 reg 文件（*当前*用户）：

```
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Environment]
"HOME"=hex(2):25,00,55,00,53,00,45,00,52,00,50,00,52,00,4f,00,46,00,49,00,4c,\
  00,45,00,25,00,00,00 
```

对于*新*用户：

```
Windows Registry Editor Version 5.00

[HKU\.DEFAULT\Environment]
"HOME"=hex(2):25,00,55,00,53,00,45,00,52,00,50,00,52,00,4f,00,46,00,49,00,4c,\
  00,45,00,25,00,00,00 
```

## 注册

在 Regedit 中，在：

对于*当前*用户：

```
HKEY_CURRENT_USER\Environment 
```

对于*新*用户：

```
HKU\.DEFAULT\Environment 
```

创建**HOME**作为新的*可扩展字符串值*(*REG_EXPAND_SZ*) 并放入**%USERPROFILE%**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-17T08:32:09.600

```
cd /home
rm -rf chris
ln -s /cygdrive/z chris 
```

我不确定这是否是最安全的解决方案，但它可能是适合我的解决方案；）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-14T22:46:31.967

我直接编辑了我的 /etc/passwd 文件（确保没有其他人可以访问它），并将所有对 /home 的引用更改为 /Users （在 Windows 7 上）。我发现，为了让一切正常工作，我必须删除 /home 目录中的所有目录（或将它们移动到适当的其他位置）。否则，cygwin 会发展出人格分裂，例如，'bash -l' 会从 /home/Pablo 开始，但 $HOME 会是 /Users/Pablo，而 emacs 似乎会做相反的事情。删除 /home/Pablo 后，一切正常。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-18T14:47:51.397

我只需要在`C:\Users\username`启动 cygwin 时加入。所以，我只是添加到`.bashrc`和`.profile`

```
cd ${HOMEPATH} 
```

如果您更喜欢使用`~/.`而不是`$HOMEPATH`，还可以添加以下内容：

```
export HOME=${HOMEPATH} 
```

这样我就不会打扰 cygwin 安装。

# java - 从 Java 控制 Jython 脚本的执行

> ID：225770
> 
> 赞同：2
> 
> 时间：2008-10-22T13:40:47.027
> 
> 标签：java, controls, jython

我试图从 Java 中控制 Jython 脚本的执行，并通过调用 PythonInterpreter.exec() 来执行。该脚本包含对 Java 中定义的类的调用。我将这里的讨论称为这些类“命令”。这些命令也可以通过 RMI 在不同的机器上运行。

由于命令需要一段时间才能完成，所以我想检查调用方的命令执行进度，例如执行完成的百分比。我可以为这些类提供一个 getProgress() 方法，但是访问这个方法似乎是不可能的，因为 PythonInterpreter 不允许调用者访问在其中运行的命令对象。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T15:17:59.280

我的 0.10 欧元：（这不容易）

按照中的描述建立一个工厂

[http://wiki.python.org/jython/JythonMonthly/Articles/September2006/1](http://wiki.python.org/jython/JythonMonthly/Articles/September2006/1)

和一个表示脚本类 (IJScript) 的 Java 接口（包括 run() 和 getProgress() 方法）

您的脚本应如下所示：

```
class xyscript(IJScript) :

def __init__(self) :
   ...
def run(self) :
   ...
def getProgress(self) :
   .... 
```

在访问接口 IJScript（Java 接口）时运行您的脚本（查看员工示例）

# mysql - 比较两个 MySQL 数据库

> ID：225772
> 
> 赞同：368
> 
> 时间：2008-10-22T13:41:07.557
> 
> 标签：mysql, database, diff

我目前正在使用 MySQL 数据库开发应用程序。

数据库结构在开发过程中仍在不断变化和变化（我更改了我的本地副本，仅将一个留在测试服务器上）。

有没有办法比较数据库的两个实例以查看是否有任何更改？

虽然目前简单地丢弃以前的测试服务器数据库很好，但随着测试开始输入测试数据，它可能会变得有点棘手。
同样的情况会在以后的生产中再次发生......

是否有一种简单的方法来增量更改生产数据库，最好是通过自动创建脚本来修改它？

* * *

答案中提到的工具：

*   [Red-Gate 的 MySQL 模式和数据比较](https://www.red-gate.com/products/mysql/mysql-compare/)（商业）
*   [Maatkit（现在的 Percona）](https://launchpad.net/percona-toolkit)
*   [液基](http://www.liquibase.org)
*   [蟾蜍](http://www.quest.com/toad-for-mysql/)
*   [Nob Hill 数据库比较](http://nobhillsoft.com/NHDBCompare.aspx)（商业）
*   [MySQL 差异](http://adamspiers.org/computing/mysqldiff/)
*   [SQL EDT](http://www.sqledt.com)（商业）

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2012-01-03T21:03:01.917

如果您正在使用小型数据库，我发现在两个数据库上运行 mysqldump 并使用`--skip-comments`和`--skip-extended-insert`选项来生成 SQL 脚本，那么在 SQL 脚本上运行 diff 效果很好。

通过跳过注释，您可以避免无意义的差异，例如运行 mysqldump 命令的时间。通过使用该`--skip-extended-insert`命令，您可以确保使用自己的插入语句插入每一行。这消除了单个新记录或修改记录可能导致所有未来插入语句中的连锁反应的情况。使用这些选项运行会产生更大的转储而没有注释，因此这可能不是您在生产使用中想要做的事情，但对于开发来说应该没问题。我在下面放置了我使用的命令示例：

```
mysqldump --skip-comments --skip-extended-insert -u root -p dbName1>file1.sql
mysqldump --skip-comments --skip-extended-insert -u root -p dbName2>file2.sql
diff file1.sql file2.sql 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2008-10-22T13:48:09.290

[Toad for MySQL](http://www.quest.com/toad-for-mysql/)具有数据和模式比较功能，我相信它甚至会创建一个同步脚本。最重要的是，它是免费软件。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-22T13:52:46.563

我使用一个名为[Navicat](http://www.navicat.com/)的软件来：

*   将实时数据库同步到我的测试数据库。
*   显示两个数据库之间的差异。

它要花钱，它只有 windows 和 mac，而且它的 UI 很糟糕，但我喜欢它。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-04-01T16:32:54.907

[SQLyog](http://www.webyog.com/) （商业）中有一个模式同步工具，它生成用于同步两个数据库的 SQL。

![在此处输入图像描述](https://i.stack.imgur.com/7xuOn.jpg)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-22T13:50:30.360

从功能比较列表中... [MySQL Workbench](http://dev.mysql.com/workbench/?page_id=11 "MySQL 工作台")在其社区版中提供 Schema Diff 和 Schema Synchronization。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-04-23T18:02:11.077

当然有很多方法，但就我而言，我更喜欢 dump 和 diff 命令。所以这是一个基于 Jared 评论的脚本：

```
#!/bin/sh

echo "Usage: dbdiff [user1:pass1@dbname1] [user2:pass2@dbname2] [ignore_table1:ignore_table2...]"

dump () {
  up=${1%%@*}; user=${up%%:*}; pass=${up##*:}; dbname=${1##*@};
  mysqldump --opt --compact --skip-extended-insert -u $user -p$pass $dbname $table > $2
}

rm -f /tmp/db.diff

# Compare
up=${1%%@*}; user=${up%%:*}; pass=${up##*:}; dbname=${1##*@};
for table in `mysql -u $user -p$pass $dbname -N -e "show tables" --batch`; do
  if [ "`echo $3 | grep $table`" = "" ]; then
    echo "Comparing '$table'..."
    dump $1 /tmp/file1.sql
    dump $2 /tmp/file2.sql
    diff -up /tmp/file1.sql /tmp/file2.sql >> /tmp/db.diff
  else
    echo "Ignored '$table'..."
  fi
done
less /tmp/db.diff
rm -f /tmp/file1.sql /tmp/file2.sql 
```

欢迎反馈:)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2010-10-04T22:17:08.640

dbSolo，它是付费的，但此功能可能是您正在寻找的功能 [http://www.dbsolo.com/help/compare.html](http://www.dbsolo.com/help/compare.html)

它适用于 Oracle、Microsoft SQL Server、Sybase、DB2、Solid、PostgreSQL、H2 和 MySQL ![替代文字](https://i.stack.imgur.com/Z1A1N.jpg)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-10-22T14:29:18.240

如果您只需要比较模式（而不是数据），并且可以访问 Perl，那么 mysqldiff 可能会起作用。我使用它是因为它可以让您将本地数据库与远程数据库（通过 SSH）进行比较，因此您无需费心转储任何数据。

[http://adamspiers.org/computing/mysqldiff/](http://adamspiers.org/computing/mysqldiff/)

它将尝试生成 SQL 查询以同步两个数据库，但我不信任它（或任何工具，实际上）。据我所知，没有 100% 可靠的方法可以对将一个数据库模式转换为另一个数据库模式所需的更改进行反向工程，尤其是在进行多项更改时。

例如，如果您只更改列的类型，自动化工具可以轻松猜测如何重新创建它。但是，如果您还移动列、重命名并添加或删除其他列，那么任何软件包所能做的最好的事情就是猜测可能发生的事情。您最终可能会丢失数据。

我建议跟踪您对开发服务器所做的任何架构更改，然后在实时服务器上手动运行这些语句（或将它们滚动到升级脚本或迁移中）。这更乏味，但它会确保您的数据安全。当您开始允许最终用户访问您的站点时，您真的会不断地对数据库进行大量更改吗？

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-22T13:46:46.077

看看[http://www.liquibase.org/](http://www.liquibase.org/)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-04-12T18:08:37.923

检查： http: [//schemasync.org/](http://schemasync.org/) schemasync 工具对我有用，它是一个命令行工具，可以在 linux 命令行中轻松工作

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-07T21:22:49.130

还有另一个开源命令行 mysql-diff 工具：

[http://bitbucket.org/stepancheg/mysql-diff/](http://bitbucket.org/stepancheg/mysql-diff/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-22T13:44:39.810

有一个使用 perl 编写的有用工具，称为[Maatkit](http://code.google.com/p/maatkit/)。它有几个数据库比较和同步工具等。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-22T13:53:29.387

RedGate 的 SQL 比较 [http://www.red-gate.com/products/SQL_Compare/index.htm](http://www.red-gate.com/products/SQL_Compare/index.htm)

DBDeploy 以自动化方式帮助进行数据库变更管理 [http://dbdeploy.com/](http://dbdeploy.com/)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-22T13:54:14.127

对于我自己，我会先转储两个数据库并区分转储，但如果您想要自动生成合并脚本，您将需要一个真正的工具。

一个简单的[谷歌搜索](http://www.google.com/search?q=Mysql+schema+comparison)出现了以下工具：

*   [MySQL Workbench](http://dev.mysql.com/workbench/)，在社区 (OSS) 和商业变体中可用。
*   [Nob Hill 数据库比较](http://nobhillsoft.com/NHDBCompare.aspx)，可免费用于 MySQL。
*   [其他 SQL 比较工具的列表](http://mysql-schema-compare.qarchive.org/)。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-09-24T11:21:45.463

看看[dbForge Data Compare for MySQL](http://www.devart.com/dbforge/mysql/datacompare/)。这是一个有 30 天免费试用期的共享软件。它是一个快速的 MySQL GUI 工具，用于数据比较和同步、数据差异管理以及可自定义的同步。

![MySQL 的 dbForge 数据比较](https://i.stack.imgur.com/Hcrhx.gif)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-08-16T18:13:22.533

在网上搜索简单工具几个小时后，我意识到我没有查看 Ubuntu 软件中心。这是我找到的免费解决方案：http: [//torasql.com/](http://torasql.com/) 他们声称也有适用于 Windows 的版本，但我只在 Ubuntu 下使用它。

编辑：2015-Feb-05 如果您需要 Windows 工具，TOAD 是完美且免费的：http: [//software.dell.com/products/toad-for-mysql/](http://software.dell.com/products/toad-for-mysql/)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-11-24T09:01:31.053

apache zeta 组件库是一个通用的松耦合组件库，用于开发基于 PHP 5 的应用程序。

**eZ 组件 - DatabaseSchema**允许您：

```
   .创建/保存数据库模式定义；
   .比较数据库模式；
   .生成同步查询；

```

您可以在此处查看教程：http: [//incubator.apache.org/zetacomponents/documentation/trunk/DatabaseSchema/tutorial.html](http://incubator.apache.org/zetacomponents/documentation/trunk/DatabaseSchema/tutorial.html)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-03-08T13:00:18.107

非常易于使用的比较和同步工具：
Database Comparer [http://www.clevercomponents.com/products/dbcomparer/index.asp](http://www.clevercomponents.com/products/dbcomparer/index.asp)

好处：

*   快速地
*   便于使用
*   易于选择要应用的更改

缺点：

*   不将长度同步到小整数
*   未正确同步索引名称
*   不同步评论

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-01-25T08:05:27.337

我认为[Navicat for MySQL](http://www.navicat.com/en/products/navicat_mysql/mysql_detail_win.html)对这种情况会有所帮助。它支持 MySQL 的数据和结构同步。 ![在此处输入图像描述](https://i.stack.imgur.com/gyRNg.jpg)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-22T13:43:12.200

对于问题的第一部分，我只是对两者进行转储并区分它们。不确定 mysql，但 postgres pg_dump 有一个命令可以只转储模式而不转储表内容，因此您可以查看是否更改了任何模式。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-22T19:09:57.223

我正在与 Nob Hill 的营销团队合作，我想告诉您，我很乐意听到您的问题、建议或任何其他内容，请随时与我联系。

我们最初决定从头开始创建我们的工具，因为虽然市场上还有其他此类产品，但它们都没有做好这项工作。向您展示数据库之间的差异非常容易。实际上使一个数据库像另一个数据库一样是另一回事。架构和数据的平滑迁移一直是一个挑战。好吧，我们在这里实现了它。
我们非常有信心它可以为您提供顺利的迁移，而不是如果它不能提供 - 如果它生成的迁移脚本可读性不够或对您不起作用，并且我们无法在五个工作日内修复它 -您将获得自己的免费副本！

[http://www.nobhillsoft.com/NHDBCompare.aspx](http://www.nobhillsoft.com/NHDBCompare.aspx)

# internet-explorer - 更改 Internet Explorer (7.0) 标题栏和选项卡中的文本

> ID：225794
> 
> 赞同：0
> 
> 时间：2008-10-22T13:48:27.493
> 
> 标签：internet-explorer, browser

当我打开某个网站时，作为最终用户，我能否让打印在顶部 IE 标题栏中的文本消失（将其设为空白或将其更改为我自己的文本）。例如，在输入这​​个问题时，我的 IE 标题栏说

**问一个问题 - 堆栈内存溢出 - Windows Internet Explorer**

我想通过一些 IE 设置/Windows 设置/注册表设置等在浏览器结束时将其设为空白。这可能吗？

也可以使 IE windows Tab 上的文本以类似的方式变为空白/自定义文本吗？

只想让我的 SO 浏览会话继续工作，尽可能不被注意！！

-广告

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T14:50:12.273

按 F11。这将使标题栏消失。使用我的设置，选项卡也会消失（自动隐藏或其他东西），这样就可以为您解决所有问题。

作为副作用，浏览器将填满整个屏幕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:53:03.867

[KB176497](http://support.microsoft.com/kb/176497)几乎总结了它。（归结为：你不能，真的。）

当简单地查看代理日志会显示您所做的任何事情时，更改网页标题对“浏览不被注意”有何帮助？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-15T14:42:03.270

[DllImport("User32.dll")] public static extern Int32 SendMessage( IntPtr hWnd, int Msg, int wParam, [MarshalAs(UnmanagedType.LPStr)] string lParam);

//清空 SendMessage(IEFrameHwnd, 0x000C, 0, "");

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:04:05.137

您可以切换到 Firefox，安装 Greasemonkey 并创建一个适用于每个页面的自定义脚本，将页面标题设置为 "" 一个空字符串（如果第一个不起作用，则将 " " 一个空格字符串）

这不会完全删除标题栏文本（仍然识别浏览器），但标题栏和选项卡上的页面标识将是空白的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T02:38:24.303

您可以使用 SendMessage 将标题更改为您想要的任何内容。我已经做过很多次了，很轻松。

标签....不太确定。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-07-15T14:51:04.160

除非通过注册表，否则您无法从 Internet Explorer 的标题栏中删除“Windows Internet Explorer”。没有 javascript 可以做到这一点。

# .net - 我应该为我的版本包含依赖项吗？

> ID：225800
> 
> 赞同：3
> 
> 时间：2008-10-22T13:50:44.697
> 
> 标签：.net, deployment, dependencies, release, release-management

我应该在为 CommonUtils 等常见项目发布版本时包含依赖项，还是应该简单地指定在使用它们时应该引用哪些依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T14:10:28.480

如果弄清楚您的依赖关系，您的用户不想要这项工作。

*   我需要什么包？
*   如果它不可用怎么办？（服务器死机，提供商停业）
*   我需要每个版本的哪个版本？
*   如果它不可用怎么办？（新版本）
*   如何下载每一个？
*   我如何安装每一个？

保护您的软件免受消失/不可用的依赖项的影响。保护您的用户免受解决这些问题的痛苦。

让你的卸载程序做正确的事：删除你安装的东西，如果它们不是共享的。（这可能很难）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T13:54:39.527

我总是会在合法和实用的情况下包含依赖项。

依赖项并不总是在 GAC 中，您将简化软件的部署。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T13:53:42.990

我总是创建两个版本（可能不是完美的解决方案）。一个只使用了我自己的代码和 3 层派对 dll。还有一个包含所有框架的更大版本。这样，如果它部署在一台新机器上，我知道我会没事的。否则（如果更新或在我知道依赖 DLL 已经存在的机器上）我使用 lite 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T13:59:37.143

我会在您的版本中包含依赖项。当您发布时，您希望控制应用程序的执行方式和行为方式。如果用户需要安装依赖项，那么他们可能会选择兼容的版本，但它可能不会做 X 或做 X 不同。这将改变您的应用程序的行为方式并增加应用程序的支持和维护。

# .net - 如何处理多个版本的依赖关系？

> ID：225810
> 
> 赞同：1
> 
> 时间：2008-10-22T13:52:43.023
> 
> 标签：.net, dependencies

嗨，我有一个依赖层次结构的问题，我不确定如何解决：

[替代文字 http://img525.imageshack.us/my.php?image=56330713it2.jpg](http://img525.imageshack.us/my.php?image=56330713it2.jpg) [http://img525.imageshack.us/my.php?image=56330713it2.jpg](http://img525.imageshack.us/my.php?image=56330713it2.jpg)

问题在于我应该如何从 MyProject 项目中引用这些依赖项。我已经将 BaseProject 和 CommonUtil（1.0 版）构建到程序集中。现在在 MyProject 中，我正在使用 CommonUtil 中的类，我不确定是否应该引用 CommonUtil.v.1.0 或者是否可以/应该引用当前版本的 CommonUtil (v 2.0)。

我应该从 MyProject 中引用哪个 CommonUtils 程序集？我无法引用这两个程序集，因为 VS 告诉我它无法确定要使用哪个程序集，因为它们都包含一些相同的方法。如果我只引用 v.1.0，我可能不会拥有 v.2.0 所需的一切，如果我只引用 v.2.0，我可能不会拥有 v.1.0（BaseProject）所需的所有功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T13:55:37.760

如果您使用 BaseProject 直接在 MyProject 中返回的类，则需要坚持使用相同的版本 (1.0)。但是如果 BaseProject 只在内部使用这些类并且不与 MyProject 共享，您可以安全地使用新版本（2.0）。

最佳实践：强烈命名您的程序集，以便编译器可以帮助您。

# sql-server - 使用策略管理 (DMF) 在 SQL 2008 中创建默认列

> ID：225814
> 
> 赞同：0
> 
> 时间：2008-10-22T13:53:17.860
> 
> 标签：sql-server, sql-server-2008

有人可以告诉我是否可以使用 SQL 2008 策略管理功能添加策略以在表架构中创建默认列

因此，例如，我可能希望在我的所有表中都有一个名为 CreateDate 的日期列，并且没有 DBA 可以创建一个没有日期时间类型的列名为“CreateDate”的表

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T23:33:39.533

声明式管理框架不会为您创建列（尽管这可能很不错！）

Column 属性也没有 facit，就像 Table 一样。你也许可以让 Multipart Name facit 做到这一点，但我没有想到任何事情。

关于防止操作的 DMF 策略需要注意的一点是，它仅在与安排定期检查策略一起使用时似乎有用（除非我遗漏了什么），因为我可以使用 CreateDate 列创建一个表来传递策略，然后sp_rename 之后立即将其命名为其他名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T22:27:39.863

我不熟悉使用 PBM 来执行此操作，但您绝对可以使用数据库级 DDL 触发器进行此类检查。[请参阅此处](http://msdn.microsoft.com/en-us/library/ms190989.aspx)的BOL 。

# geolocation - Web 应用程序的简单地理数据源

> ID：225824
> 
> 赞同：2
> 
> 时间：2008-10-22T13:55:13.517
> 
> 标签：geolocation, geography

对于我正在开发的网络应用程序，我需要知道大约 300 个美国城市的纬度/经度。我还需要知道每个美国邮政编码的纬度/经度。

有谁知道获取此信息的免费来源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T13:59:09.500

[Freebase](http://freebase.com)可能会为您提供帮助。 [这是纽约](http://www.freebase.com/view/guid/9202a8c04000641f80000000002f8906)，它有纬度/经度。

[Wal-Mart Expansion 视频](http://blog.kiwitobes.com/?p=51)使用Freebase 获取数据，听起来您正在做类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T14:04:41.720

看看 Ben Fry 的[Zip Code Visualizer](http://benfry.com/zipdecode/)。这是他的书[Visualizing Data](https://rads.stackoverflow.com/amzn/click/com/0596514557)的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T14:06:54.883

[Geocoder.us](http://geocoder.us/)上有一个在线数据库。还有一个[简单的 perl 模块](http://search.cpan.org/~sderle/Geo-Coder-US/US.pm)（我们为此添加了一个 soap 服务，因此我们可以简单地从任何语言访问它，并且开发过程中最长的部分是下载数据库（大约 4 GB）。） geocoing 数据库可从美国获得人口普查局，可以在[此处](http://www.developer.com/tech/article.php/3557171)找到有关获取此设置的好文章。

# windows - 保存 Windows 窗体大小

> ID：225825
> 
> 赞同：7
> 
> 时间：2008-10-22T13:55:32.270
> 
> 标签：windows, vb.net, winforms, preferences, savestate

我正在用 VB.NET 开发一块。在我的主要表单中，我正在创建一个用作对话框的新表单。我想知道是否有办法在新对话框关闭时为每个用户保存它的大小设置（可能在他们机器上的文件中，通过 XML 或其他方式？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T14:17:00.010

您可以将其保存到设置文件中，并在“关闭”事件中更新它。

进行设置转到项目属性->设置->然后进行设置，如 system.drawing.size 类型的“对话框大小”。

然后在您的对话框表单中执行此操作：

```
Public Sub New()
    InitializeComponent()
End Sub

Public Sub New(ByVal userSize As Size)
    InitializeComponent()
    Me.Size = userSize
End Sub

Protected Overrides Sub OnClosing(ByVal e As System.ComponentModel.CancelEventArgs)
    MyBase.OnClosing(e)
    My.Settings.DialogSize = Me.Size
    My.Settings.Save()
End Sub 
```

做这样的事情来检查和使用设置：

```
 Dim dlg As MyDialogWindow
    If My.Settings.DialogSize.IsEmpty Then
        dlg = New MyDialogWindow()
    Else
        dlg = New MyDialogWindow(My.Settings.DialogSize)
    End If
    dlg.ShowDialog() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:00:40.137

虽然[这是针对 C#](https://stackoverflow.com/questions/18421/best-way-to-bind-windows-forms-properties-to-applicationsettings-in-c)的，但它对 VB.Net 也有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-05T17:41:32.170

您还可以向您的应用程序（大小）添加新设置并将其设置为`system.drawing.size`

然后，确保在关闭时将当前大小保存到设置。

```
 Private Sub myForm_FormClosing(ByVal sender As System.Object,
                          ByVal e As System.Windows.Forms.FormClosingEventArgs) _
                             Handles MyBase.FormClosing

    My.Settings.size = Me.Size
    My.Settings.Save()

End Sub 
```

并在加载时应用您在设置中保存的大小

```
 Private Sub myForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) _
    Handles MyBase.Load
    ' if  this is the first  time to load the form 
    ' dont set the size ( the form will load  with the size  in the designe)
    If Not My.Settings.size.IsEmpty Then
        Me.Size = My.Settings.size
    End If
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-02T19:39:34.437

这是[我在网上找到](http://christ-offer.blogspot.com/2012/02/vbnet-remember-application-window-size.html)的一个解决方案，似乎对我来说效果很好。

前面提到的一些解决方案并没有像预期的那样对我有用。根据我的表单在关闭时的位置，当我再次加载它时，表单不会重新定位回那个确切的位置。

该解决方案似乎还通过考虑其他一些因素来解决问题：

您需要在 Project Properties -> settings: WindowLocation 和 WindowSize 下设置这两个设置，如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/rk34J.png)](https://i.stack.imgur.com/rk34J.png)

然后创建以下函数：

```
Private Sub LoadWindowPosition()

    'Get window location/position from settings
    Dim ptLocation As System.Drawing.Point = My.Settings.WindowLocation

    'Exit if it has not been set (X = Y = -1)
    If (ptLocation.X = -1) And (ptLocation.Y = -1) Then
        Return
    End If

    'Verify the window position is visible on at least one of our screens
    Dim bLocationVisible As Boolean = False

    For Each S As Screen In Screen.AllScreens
        If S.Bounds.Contains(ptLocation) Then
            bLocationVisible = True
            Exit For
        End If
    Next

    'Exit if window location is not visible on any screen 
    If Not bLocationVisible Then
        Return
    End If

    'Set Window Size, Location
    Me.StartPosition = FormStartPosition.Manual
    Me.Location = ptLocation
    Me.Size = My.Settings.WindowSize
End Sub 
```

接下来，您需要向表单的加载和关闭事件添加代码，如下所示：

```
Private Sub frmMain_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    LoadWindowPosition()
End Sub

Private Sub frmMain_Closing(sender As Object, e As CancelEventArgs) Handles Me.Closing
    My.Settings.WindowLocation = Me.Location
    My.Settings.WindowSize = Me.Size
End Sub 
```

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T14:11:19.680

您也可以使用 VB.NET IDE 本身提供的 UI 来执行此操作。在表单的属性窗格中，查看名为“（应用程序设置）”的项目，然后查看“属性绑定”。您可以将表单的几乎每个属性（包括大小和位置）绑定到该应用程序的设置值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T18:15:31.713

事实证明，我找到了一种方法来使用`System.IO.IsolatedStorage`

# html - 我可以 ... 在 HTML 文件的正文中添加标签以通过电子邮件发送吗？

> ID：225828
> 
> 赞同：56
> 
> 时间：2008-10-22T13:56:06.870
> 
> 标签：html, css, email

由于很多电子邮件客户端忽略了 HEAD 标签，我可以在正文中嵌入内联样式表吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-22T13:58:33.027

最简洁的答案是不。Gmail 会去除标签及其内容。

Hotmail，雅虎！Mail 和 Windows Live Mail 不会去除正文元素中的样式标签。

但是请查看Campaign Monitor[中 HTML 电子邮件的“CSS 终极指南” 。](http://www.campaignmonitor.com/css/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T01:13:10.950

创建适用于每个电子邮件客户端的 HTML 电子邮件非常困难。我花了几个月的时间来完善一个好看的模板。

[http://commadot.com/the-holy-mail/](http://commadot.com/the-holy-mail/) - original blog with my findings.

[http://commadot.com/email-best-practices/](http://commadot.com/email-best-practices/) - latest greatest.

Specific answer to your question: Gmail will be ok with `style=""` but not with a `<style>` block.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-22T22:51:31.953

您可能想查看 CampaignMonitor 和 MailChimp（**编辑：**和 Zurb 的 Ink）提供的免费 html 电子邮件模板：

[http://www.campaignmonitor.com/templates/](http://www.campaignmonitor.com/templates/)

[http://www.mailchimp.com/resources/templates/](http://www.mailchimp.com/resources/templates/)

[http://zurb.com/ink/](http://zurb.com/ink/)

这里有更新版本的 Campaign Monitor 有用指南：http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

不幸的是，在电子邮件中使用的最可靠的 HTML 完全是石器时代

**编辑：** Ink 有一个“内联”工具，它获取`style`标签的内容并将它们内联到适当的元素上：http: [//zurb.com/ink/inliner.php](http://zurb.com/ink/inliner.php)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-05T19:28:38.567

Most gmail clients now support embedded CSS as of September 2016, so it should be safe to do.

[https://litmus.com/blog/gmail-to-support-responsive-email-design](https://litmus.com/blog/gmail-to-support-responsive-email-design)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T14:02:02.023

是的你可以。但是您必须记住，很少有电子邮件客户端尊重 css 标准。只需坚持基本的 css 属性，如`margin`and`padding`等，一切都应该没问题。

您也可以为您的 html 元素内联 ( `<div style="">`) 设置样式，尽管这不是一个优雅的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-06T21:14:55.357

The top answer is outdated. Gmail now supports using media query's along with other css properties now - [https://developers.google.com/gmail/design/css](https://developers.google.com/gmail/design/css)

# html - 粘贴到电子邮件时突出显示语法

> ID：225830
> 
> 赞同：9
> 
> 时间：2008-10-22T13:56:18.960
> 
> 标签：html, email, vim, syntax-highlighting, paste

我经常通过我的前景向同事和合作伙伴发送小的代码片段和 xml 片段。在我将它们粘贴到电子邮件中之前，有没有人有一个好主意或工具可以用来突出显示我的粘贴语法。

我正在考虑将中间粘贴到“$fancytool”，然后我会复制一些将 html 化的内容，这样我就可以将其复制粘贴到“撰写电子邮件”窗口中。

*编辑更多信息：*

我从 VMWare 虚拟机中的窗口粘贴，它可能是 eclipse、xmlspy、日志文件和其他程序

*更多信息：*

我已经看到[这个链接](http://vim.wikia.com/wiki/Pasting_code_with_syntax_coloring_in_emails)如何从 Vim 中做到这一点。不幸的是，它很少来自 vim im 复制代码，而且我的电子邮件机器没有任何 vim。vmware 机器有 gvim，但我希望有一种更简单的方法，可以粘贴到 vim，保存到文件，在 internetexplorer 中打开，然后复制/粘贴

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-24T16:04:11.087

晚了，但我可以给出一个有效的答案。你需要两件事

1.  油灰
2.  访问某些 Unix 服务器（使用 vim）

在腻子选项中，在窗口→选择下，打开复选框

`Paste in to clipboard in RTF as well as plain text`.

使用 putty 登录服务器。通过键入 vim 启动 vim 将您的文本（例如 XML ）粘贴到 vim 中。进入命令模式（按 键进入 vim 模式`ESC`）并输入 `:set syn=xml`.

语法突出显示开始。使用鼠标复制文本并将其粘贴到您的电子邮件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-05T13:49:04.860

5 年太晚了，对不起，但我有一个比公认的答案更简单的解决方案。

使用这个在线工具：[http ://tohtml.com/](http://tohtml.com/)

从浏览器窗口复制预览，然后粘贴到 Word 或 Outlook 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T14:05:21.407

Vim（或 GVim）会将您的代码输出为格式化的 HTML。然后，只要您的电子邮件使用 HTML 格式，您就可以将其复制并粘贴进去。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-15T20:39:07.613

只是关于这个问题的更新，如果你在 Windows 上，你可以安装 Notepad++（无论如何它是最好的 Windows 编辑器之一），它带有一个开箱即用的插件：“使用语法突出显示复制文本”，当您选择一些文本并右键单击它时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T14:03:52.300

如果您只想要[加载项，那就是](http://www.jtleigh.com/people/colin/software/CopySourceAsHtml/).

如果您想知道它是如何完成的，[这里有一篇关于如何编写 Add-In 的文章](http://msdn.microsoft.com/en-gb/magazine/cc163652.aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T14:33:47.073

这个[链接](http://www.fauskes.net/nb/syntaxms/)把我带到了[SciTE](http://www.scintilla.org/SciTE.html)。

看起来[SciTE](http://www.scintilla.org/SciTE.html)具有 Copy to RTF 功能：

![赛特](https://i.stack.imgur.com/YAfob.png)

编辑（vmware 升级）：但看起来我在使用 vmware 时几乎迷路了，因为我无法将 rtf 剪贴板项目传输到 vmware 主机。而且我无法在 vmware 主机上安装软件。

也许是一个带有语法突出显示的粘贴站点？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-28T17:57:37.203

评论：svrist 提到了一个带有语法高亮的代码粘贴站点。试试[http://codepad.org/](http://codepad.org/)

（还没有足够的魔力发表评论）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T14:07:31.323

如果您使用的是 Windows，Visual Studio 会自动执行此操作。至少它对我有用，在 XP 上使用 Visual Studio 2005 并复制/粘贴到 MS Word 和 Lotus Notes

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-27T17:16:52.253

**HeidiSQL**为 sql 查询执行此操作，并且他们所做的语法高亮选择非常易读。但是，这仅适用于 sql 查询，不适用于其他代码。我喜欢基于 Windows 的系统的**Notepad++ ，**[这里有一些关于 Notepad++ 的说明](https://superuser.com/a/578059)。有几个人提到了用于 unix/shell 环境的**VIM 。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-30T13:45:52.810

对于**gVim (Windows)**，我定义了这个函数和一个方便的映射：

```
function! HlCopy() range
    exec a:firstline.','.a:lastline.'TOhtml'
    normal yG
    q!
    !start /min powershell "Get-Clipboard | Set-Clipboard -AsHtml"
    redraw
endfun
vmap Y :call HlCopy()<CR> 
```

**如何使用？**

*   `v`使用鼠标左键选择文本或通过选择文本进入可视模式。然后将当前选择复制为带有 的原始文本`y`或带有 的突出显示文本`Y`。
*   直接通过范围（无视觉模式）`:1,3call HlCopy()`：.

如果您像我一样懒惰，您可以`TOhtml`在该功能中设置其他选项。我的 vimrc 中有这个：

```
function! HlCopy() range
    let g:html_font = "Consolas"
    let g:html_number_lines = 0
    exec a:firstline.','.a:lastline.'TOhtml'
    normal yG
    q!
    !start /min powershell "Get-Clipboard | Set-Clipboard -AsHtml"
    redraw
endfun
vmap Y :call HlCopy()<CR> 
```

# c# - 逐条验证和提取 XML 记录到数据库中

> ID：225832
> 
> 赞同：1
> 
> 时间：2008-10-22T13:56:44.607
> 
> 标签：c#, .net, xml, linq, linq-to-xml

这是交易。我有一个包含很多记录的 XML 文档。像这样的东西：

```
print("<?xml version="1.0" encoding="utf-8" ?>
      <Orders>
       <Order>
         <Phone>1254</Phone>
         <City>City1</City>
      <State>State</State>
      </Order>
      <Order>
         <Phone>98764321</Phone>
         <City>City2</City>
        <State>State2</State>
      </Order>  
     </Orders>"); 
```

还有一个 XSD 模式文件。我想从此文件中提取数据并将这些记录插入到数据库表中。首先，我想验证每个订单记录。例如，如果文件中有 5 个订单，其中 2 个未通过验证，我想将通过验证的 3 个插入 db 并留下另外 2 个。一个 xml 文件中可能有数千条记录。这里最好的方法是什么。以及验证将如何进行，因为我需要丢弃失败的记录并仅使用通过验证的记录。目前我正在使用**XmlReaderSettings**来验证 XML 文档记录。在插入数据库之前，我是否应该将这些记录提取到另一个 XML 文件或数据集或自定义对象中。我正在使用.Net 3.5。欢迎任何代码或链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:08:44.957

如果数据相当干净地映射到对象模型，您可以尝试使用 xsd.exe 从 .xsd 生成一些类，并将这些类处理到您选择的 DAL 中。问题是，如果容量很大（您提到数千条记录），您很可能会有*很多*往返。

另一种选择可能是将数据“按原样”传递到数据库并使用 SQL/XML 处理 TSQL 中的数据 - 大概作为接受 xml 类型参数的存储过程（SQL Server 2005 等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:43:41.100

我同意你应该使用 XmlReader 的想法，但我想我会尝试一些不同的东西。

基本上，我首先验证整个 XDocument，然后如果有错误，我会枚举订单并根据需要对它们进行分类。它不漂亮，但也许它会给你一些想法。

```
 XDocument doc = XDocument.Load("sample.xml");
        XmlSchemaSet schemas = new XmlSchemaSet();
        schemas.Add("", "sample.xsd");

        bool errors = false;
        doc.Validate(schemas, (sender, e) =>
        {
            errors = true;
        });

        List<XElement> good = new List<XElement>();
        List<XElement> bad = new List<XElement>();
        var orders = doc.Descendants("Order");
        if (errors)
        {
            foreach (var order in orders)
            {
                errors = false;
                order.Validate(order.GetSchemaInfo().SchemaElement, schemas, (sender, e) =>
                {
                    errors = true;
                });

                if (errors)
                    bad.Add(order);
                else
                    good.Add(order);
            }
        }
        else
        {
            good = orders.ToList();
        } 
```

您可以使用通用函数代替 lambda 表达式，但我只是将它们放在一起。此外，您可以构建两个 XDocument，而不是将订单元素放入列表中。我敢肯定这里还有很多其他问题，但也许这会引发一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:06:38.477

这在很大程度上取决于您的场景中“验证”的含义。我假设，由于您使用的是 .xsd，因此您已经在验证数据在语法上是否正确。那么，验证可能意味着您将调用其他服务或程序来确定订单是否有效？

您可能想查看 Sql Server 集成服务。SSIS 中的 XML 任务允许您执行 XPath 查询、合并等操作，以及您可能需要对该文档执行的任何操作。您也可以将其用于所有带有模式文件的前期验证。

Marc 将该数据传递给存储过程的选项在这种情况下也可能有效，但是 SSIS（或者，甚至是 DTS，但您将放弃与 XML 相关的太多内容以使其成为一个不错的选项）将使您在视觉上协调所有这些工作。另外，它会让这些事情更容易耗尽进程，因此您最终应该得到一个更具可扩展性的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:17:51.713

你有几个选择：

1.  [XmlDataDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldatadocument(VS.80).aspx)或[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument(VS.80).aspx)。这种方法的缺点是数据将被缓存在内存中，如果你有很多数据，那就不好了。另一方面，您可以使用 DataSet 获得良好的内存查询功能。XmlDocument 要求您使用 XPath 查询来处理数据，而 XmlDataDocument 为您提供更像 DataSet 功能的体验。

2.  [xml阅读器](http://msdn.microsoft.com/en-us/library/9d83k261(VS.80).aspx)。这是一种很好、快速的方法，因为数据没有被缓存；你一次读一点它作为一个流。您从一个元素移动到下一个元素，并在应用程序中查询有关该元素的信息以决定如何处理它。这确实意味着您在应用程序的内存中维护您所在的树级别，但是对于像您这样的简单 XML 文件结构，这应该非常简单。

在您的情况下，我推荐选项 2。它应该在内存使用方面可以很好地扩展，并且应该为处理文件提供最简单的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T07:16:52.103

通过验证，我的意思是验证每个节点。至少有一个错误的节点需要插入到一个新的 xml 文档中。基本上最后我应该有 2 个 xml 文档。一个包含成功节点，另一个包含失败节点。我有什么办法可以做到这一点？我正在使用 LINQ。

# database - 从表中仅选择一个字段

> ID：225833
> 
> 赞同：2
> 
> 时间：2008-10-22T13:56:47.570
> 
> 标签：database, database-design

我必须在我的数据库中添加一张优惠券表。优惠券有 3 种类型：百分比、金额或 2 换 1。

到目前为止，我已经想出了一个包含这 3 个字段的优惠券表。如果有一个百分比值未设置为空，那么它就是这种优惠券。

我觉得这不是正确的做法。我应该创建一个 CouponType 表吗？你会怎么看？您会将这些值存储在哪里？

任何帮助或提示表示赞赏！

谢谢，

发球台

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T14:04:35.700

你是对的，我认为 CouponType 表适合你的问题。

两个表：优惠券和优惠券类型。将 CouponTypeId 存储在 Coupons 表中。

例如，您将有一个名为“50% 折扣”的优惠券记录，如果将引用 CouponType 记录的折扣百分比，您可以从那里确定将商品成本降低 50% 的逻辑。

因此，现在您可以创建无限优惠券，如果它是美元金额优惠券类型，它将采用“金额”列并将其视为美元金额。如果它是一个百分比折扣，它会将其视为百分比，如果它是“x for 1”交易，它将将该值视为 x。

```
- Table Coupons
  - ID
  - name
  - coupon_type_id # (or whatever fits your style guidelines)
  - amount # Example: 10.00 (treated as $10 off for amount type, treated as  
           # 10% for percent type or 10 for 1 with the final type) 
  - expiration_date

- Table CouponTypes
  - ID
  - type # (amount, percent, <whatever you decided to call the 2 for 1> :)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:05:58.597

将来您可能会有更多不同的优惠券类型。你也可以有不同的业务逻辑与它们相关联——你永远不知道。在这种情况下，做正确的事情总是有用的，所以是的，当然，创建一个优惠券类型字段和一个关联的字典表来配合它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T14:04:53.060

我肯定会创建一个 CouponType 查找表。这样你就可以避免所有的 NULL 并在未来允许更多的优惠券类型。

优惠券 coupon_id INT 名称 VARCHAR coupon_type_id INT <- 外键

优惠券类型 coupon_type_id INT type_description VARCHAR ...

或者我想你可以在你的优惠券表 CHAR(1) 中有一个优惠券类型列

# twitter - 保护桌面应用程序中的用户密码（修订版 2）

> ID：225838
> 
> 赞同：11
> 
> 时间：2008-10-22T13:58:22.293
> 
> 标签：twitter, passwords, hash

我正在制作一个 twitter 客户端，并且正在评估保护用户登录信息的各种方法。

重要提示：我需要保护用户的数据免受其他应用程序的影响。例如，想象一下如果一个机器人开始从用户桌面上运行的应用程序中窃取 Twhirl 密码或 Hotmail/GMail/Yahoo/Paypal 会发生什么。

澄清：我之前在没有“重要”部分的情况下问过这个问题，但 stackoverflow 的 UI 对稍后在 Q/A 对话中添加细节没有帮助。

*   散列显然不这样做
*   以可逆的方式混淆就像试图躲在我的手指后面
*   纯文本听起来很混杂
*   要求用户每次都输入他的密码会使应用程序厌烦

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-22T14:05:31.813

这是第 22 条规则。要么让用户每次都输入他的密码，要么不安全地存储它（混淆、加密等等）。

解决这个问题的方法是让更多的操作系统加入内置的密码管理器——比如 OS X 的钥匙串。这样，您只需将密码存储在钥匙串中，操作系统即可确保其安全，用户只需输入 1 个主密码。OS X 上的许多应用程序（如 Skype）使用 Keychain 来完成您所描述的操作。

但由于您可能使用的是 Windows，我想说只是进行一些混淆和加密。我认为您可能对密码窃取机器人有点偏执；如果您的应用程序没有大量用户群，那么有人会针对它并专门尝试窃取密码的可能性非常低。除此之外，他们还必须有权访问受害者的文件系统。如果是这种情况，他们可能有病毒/蠕虫并且有更大的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T23:35:56.293

我认为您在这里错过了更大的图景：

**如果桌面被入侵，你就是 F#*%ED！**

要从您的程序中窃取密码，病毒必须以管理员身份在系统上运行。如果病毒已经做到了这一点，那么从你的程序中窃取密码就在它想要做的恶意事情的列表中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T04:01:29.927

以纯文本形式存储并*让用户知道*。

这样，就不会对您已达到的安全级别产生误解。如果用户开始抱怨，请*考虑*将一个发布在您的网站上的常量异或到它上面。如果用户不断抱怨，请“隐藏”代码中的常量，并告诉他们它的安全性很差。

如果用户无法将坏人拒之门外，那么*实际上*他们拥有的所有秘密数据都为邪恶博士所知。加密与否无关紧要。如果他们可以将邪恶的人拒之门外，为什么还要担心以纯文本形式存储密码呢？

当然，我可以在这里说我的屁股。是否有研究表明，以纯文本形式存储密码比将密码模糊存储更安全？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-29T18:50:39.443

**如果您正在制作 twitter 客户端，请使用他们的 API**

Twitter 有非常好的[文档](https://dev.twitter.com/docs)，所以我建议你在做客户端之前阅读它。与此问题相关的最重要部分是您不需要存储密码，而是存储[OAuth](https://dev.twitter.com/docs/auth/oauth)令牌。您需要使用[xAuth](https://dev.twitter.com/docs/oauth/xauth)阶段来获取 OAuth 令牌，然后在必要时将其他 Twitter API 与此 OAuth 令牌一起使用。

> xAuth 为桌面和移动应用程序提供了一种将用户名和密码交换为 OAuth 访问令牌的方法。检索到访问令牌后，启用 xAuth 的开发人员应处理与用户对应的登录名和密码。

**如果你可以逃脱它，你永远不会存储密码**

使用 OAuth 可能发生的最糟糕的情况是第 3 方（黑帽黑客）可以**访问**该 Twitter 帐户，但不能访问**密码**。这将保护那些天真地为多个在线服务使用相同密码的用户。

**使用某种钥匙串**

最后，我同意应该使用 OSX 的钥匙串等预制解决方案来存储敏感的 OAuth 信息，受感染的机器只会泄露当前解锁的钥匙串的信息。这意味着在多用户系统中，只有登录用户的钥匙串才会容易受到攻击。

**其他损坏限制**

可能有一些我错过的东西，请使用 Google 获取“最佳安全实践”并开始阅读可能相关的内容。

**编辑**（响应 finnw 所需的一般案例解决方案）

您想要在没有用户输入的情况下访问在线服务。这意味着通常您最多可以通过 Keychain 之类的方式对身份验证凭据进行用户级别的访问控制。

我从未使用过 OSX 钥匙串，所以现在我将谈谈 SELinux。在 SELinux 中，您还可以确保这些身份验证凭据只提供给您的程序。如果我们继续进行操作系统级别的工作，您还可以对从启动到加密的所有进程进行签名，以确保没有其他程序可以模仿您的程序。这完全超出了典型的用户系统，鉴于这种级别的设置，您可以确信用户还不够天真而不会受到损害，或者系统管理员足够兼容。在这个级别，我们可以保护这些凭据。

让我们假设我们在保护这些凭据方面没有走得太远，那么我们可以假设系统受到了损害。此时，身份验证凭据被泄露，在本地对这些凭据进行混淆/加密不会增加任何真正的安全性，也不会将其部分或全部存储在第 3 方服务器上。这很容易看出，因为在没有用户输入的情况下，您的程序需要自行引导以获取这些凭据。如果您的程序可以在没有输入的情况下执行此操作，那么任何对您的混淆/加密/服务器协议进行逆向工程的人都可以。

此时是损坏限制，请勿将密码存储为身份验证凭据。使用 OAuth、cookie 会话、加盐哈希等，它们都只是表示在过去某个时刻你证明你知道密码的令牌。在任何好的系统中，这些令牌都可以被撤销、过期和/或在活动会话期间定期交换新令牌。

令牌（无论其形式如何）还可以包含额外的非用户输入身份验证信息，这会限制您在其他地方使用它们的能力。例如，它可以封装您的主机名和/或 IP 地址。这使得在不同的机器上使用凭证变得困难，因为模仿这些形式的凭证需要访问适当级别的网络基础设施。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T14:19:06.090

经过进一步的思考，我想我找到了一种方法。我将为我的应用程序桌面应用程序使用 ASP.net 身份验证，在线存储他们的凭据，并让 Internet Explorer 的密码管理器为我处理这个辅助对或凭据的本地缓存。

我只需要让他们在第一次登录时通过类似 Facebook-API 的表单进行身份验证。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T23:41:20.823

我不明白...为什么加密不好？使用大密钥并将密钥存储在机器密钥库中（假设是 Windows）。完成了，完成了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-14T02:10:22.270

OSX：使用钥匙串

Windows：使用 CryptProtectData 和 CryptUnprotectData

Linux：使用 GNOME 密钥环和 KDE KWallet

# css - 除非页面向下滚动超过某个点，否则我如何才能拥有一个不会移动的滑动菜单 div

> ID：225843
> 
> 赞同：3
> 
> 时间：2008-10-22T13:59:11.357
> 
> 标签：css, html

我有一个要向下滑动的菜单 div，因此它始终可见，但我希望它位于我的标题 div 下。我不希望它移动，直到菜单顶部到达屏幕顶部然后保持原位。基本上我想要一个可以滑动到的最大高度的滑动菜单。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T14:18:53.300

我想我明白你在说什么——我们在[The King](http://www.kingtray.com) with jQuery 中使用了类似的技术。就是这样：

```
///// CONFIGURATION VARIABLES:

var name                = "#rightsidebar";
var menu_top_limit      = 241;
var menu_top_margin     = 20;
var menu_shift_duration = 500;
var menuYloc = null;
///////////////////////////////////

$(window).scroll(function() 
{ 
    // Calculate the top offset, adding a limit
    offset = menuYloc + $(document).scrollTop() + menu_top_margin;

    // Limit the offset to 241 pixels...
    // This keeps the menu out of our header area:
    if(offset < menu_top_limit)
        offset = menu_top_limit;

    // Give it the PX for pixels:
    offset += "px";

    // Animate:
    $(name).animate({top:offset},{duration:menu_shift_duration,queue:false});
}); 
```

（向编写此代码的[@soyrex 致敬。）](http://soyrex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T14:10:46.433

Slashdot 做到了这一点。例如，请访问[http://tech.slashdot.org/tech/08/10/22/1246200.shtml](http://tech.slashdot.org/tech/08/10/22/1246200.shtml)

您也许可以从他们的网站上提升这项技术。

# kernel - 如何配置 modprobe 来查找我的模块？

> ID：225845
> 
> 赞同：52
> 
> 时间：2008-10-22T13:59:34.553
> 
> 标签：kernel, kernel-module, insmod

我正在尝试让内核模块在启动时加载。

如果我运行`insmod /path/to/module.ko`，它工作正常。但是每次重新启动时都必须重复此操作。

如果我运行`modprobe /path/to/module.ko`，它找不到模块。我知道 modprobe 使用了一个配置文件，但是即使将 /path/to/module.ko 添加到 /etc/modules 后，我也无法让它加载模块。

什么是正确的配置？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-10-22T14:27:55.403

您可以为您的模块创建一个到标准路径的符号链接，因此 depmod 将看到它并且您将能够像任何其他模块一样加载它。

```
sudo ln -s /path/to/module.ko /lib/modules/`uname -r`
sudo depmod -a
sudo modprobe module 
```

如果您将模块名称添加到 /etc/modules，它将在您启动时加载。

无论如何，我认为正确的配置是将模块复制到标准路径。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-03-13T09:55:37.090

请按照以下步骤操作：

> 1.  将 hello.ko 复制到 /lib/modules/'uname-r'/misc/
> 2.  在 /lib/modules/'uname-r'/modules.dep 中添加 misc/hello.ko 条目
> 3.  须藤depmod
> 4.  sudo modprobe 你好

modprobe 将检查 modules.dep 文件中的任何依赖项。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-22T14:36:14.730

我认为关键是将模块复制到标准路径。

完成后，modprobe 只接受模块名称，因此不要使用路径和“.ko”扩展名。

# asp.net - 如何“单实例”一个 ASP.Net AJAX 门户网站？

> ID：225860
> 
> 赞同：0
> 
> 时间：2008-10-22T14:03:59.990
> 
> 标签：asp.net, ajax, single-instance

有人问我是否可以选择“单实例”我们的门户网站。有关WinForms 应用程序中的相同想法，请参阅 [Hanselman 博客上的这篇文章。](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)

假设我们在同一台客户端机器上有 2 个快捷方式：

[http://MyServer/MyWebPortal/Default.aspx?user=username&document=Foo](http://MyServer/MyWebPortal/Default.aspx?user=username&document=Foo) [http://MyServer/MyWebPortal/Default.aspx?user=username&document=Bar](http://MyServer/MyWebPortal/Default.aspx?user=username&document=Bar)

单击第一个快捷方式将启动我们的门户网站，登录并显示文档“Foo”。单击第二个快捷方式应在 Web 门户的运行实例中显示文档“Bar”。

我目前的方法是：在页面加载中，首先为每个客户端创建一个应用程序变量。第二个实例查找 Application 变量以查看门户是否在客户端上运行。如果是，则将第二个 URL 记录在另一个 Application 变量中，并强制退出第二个实例。我尝试创建一个 ASP.Net AJAX 计时器来轮询应用程序变量以显示要显示的文档。这类作品。为了快速响应第二个请求，我将 Timer 间隔设置为 2 秒。由于频繁的回发，这使得门户网站使用起来很烦人。

使用我的方法，有没有办法让第二个实例通知第一个实例检查应用程序变量而不进行轮询？有没有更好的整体方法来解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T14:08:23.227

服务器端无法控制您的页面在客户端打开哪个浏览器实例。您不能强制所有请求在同一个浏览器窗口中打开。

此外，应用程序范围变量由应用程序的*所有用户*共享。至少让它成为一个会话范围的变量——否则你一次只允许一个用户访问你的门户！

老实说，这听起来像是来自某人的愚蠢要求比您的门户的一个实例打开。

# xaml - 如何正确继承 Silverlight 中 XAML 中定义的用户控件

> ID：225878
> 
> 赞同：17
> 
> 时间：2008-10-22T14:07:19.140
> 
> 标签：xaml, inheritance, user-controls, silverlight-2.0

如果我有一个我编写的用户控件（在 Silverlight 中），它使用 XAML 来定义它的外观，我该如何制作它的自定义版本？

即我有 MyControl.xaml & MyControl.xaml.cs

如果我想要一个“SpecializedControl”子类，我需要做什么？我假设我只是创建一个新的代码文件，然后从 MyControl 继承。但是如果我想改变基类的外观怎么办——那我该怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T14:29:56.287

我写了这篇文章，以为你在谈论 WPF，而不是 Silverlight，但是可能有足够的重叠来提供帮助，所以无论如何我都会发布它。

如果“更改基类的外观”是指“提供新模板”，那么您需要的可能是 CustomControl，而不是 UserControl。

完成此操作的最佳方法是遵循其他 Microsoft 控件设置的示例，例如 Button 或 ListBox：

1.  创建一个直接派生自 Control（或任何最接近您的控件）的类。
2.  如果需要向控件公开任何属性（例如按钮上的文本），请确保将它们正确定义为 DependencyProperties。
3.  [如此处](http://msdn.microsoft.com/en-us/library/ms745025.aspx)所述，创建一个名为 Themes/generic.xaml 的 ResourceDictionary 并为您的类添加一个包含模板的样式（不要给样式一个键）。
4.  对控件上需要从控件获取值的元素的任何属性使用 TemplateBindings。
5.  如果您需要将任何事件处理程序附加到模板中的元素，请给它们一个唯一的名称。Microsoft 使用在这些名称前加上“PART_”前缀的约定，我认为为了保持一致性，这样做是一件好事，但这并不是严格要求的。
6.  同样，如果您需要附加事件处理程序，请重载 OnApplyTemplate()。在此方法中，您应该分离任何旧的事件处理程序（我们当然不希望任何内存泄漏！），并查找具有您在模板中提供的名称的元素 - 当您找到它们时，根据需要附加事件处理程序.

这当然比简单地从 UserControl 派生要多得多，但是如果您希望能够完全重新模板化控件，就像您可以使用内置控件一样，这就是实现它的方法。

*另一方面*，如果您只想提供一定数量的有限自定义，例如更改背景，或将命令与某些用户操作相关联，那么最好的做法是公开 DependencyProperties，这样就可以在控件的样式中设置，或者在控件的实例上设置。

在您提到想要自定义继承控件的外观的情况下，过程非常相似：只需使用新模板为新控件添加默认样式；如果您需要添加更多事件处理程序，请绝对确定您调用了 base.OnApplyTemplate()。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T17:16:36.080

我不知道，我喜欢只用简单的物体做事。这是一篇文章，描述了一种将 XAML 设计的控件滑出继承层次结构的简单方法，以便您可以使用 SimpleThingsLikeInheritance 而不是 MicrosoftStuffThatAlmostWorks 自定义外观和行为

[http://gen5.info/q/2009/02/10/subverting-xaml-how-to-inherit-from-silverlight-user-controls/](http://gen5.info/q/2009/02/10/subverting-xaml-how-to-inherit-from-silverlight-user-controls/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-06-24T13:35:29.873

正如 Mihnea 的链接所述，最简单的解决方案是在 XAML 中简单地添加一个命名空间：

# C＃

```
public class MyBase : UserControl
{
}

public class FirstUserControl : MyBase
{
...
} 
```

## XAML

```
<local:MyBase 
    x:Class="FirstUserControl" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:local="YourAssembly" ...>

    <!-- Sticking with UserControl instead of local:MyBase makes this clearer -->
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                ..
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

..Your XAML
</local:MyBase> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T11:46:25.250

您可以使用上面链接中描述的包装器来解决此问题。但是你也可以使用策略模式来解决这个问题。

在这篇文章中，我将解释如何实现这两种方法。 [http://www.lab101.be/2008/07/silverlight-usercontrol-inheritance/](http://www.lab101.be/2008/07/silverlight-usercontrol-inheritance/)

# sql - Postgres 外键“更新时”和“删除时”选项如何工作？

> ID：225881
> 
> 赞同：25
> 
> 时间：2008-10-22T14:07:35.363
> 
> 标签：sql, database-design, postgresql, foreign-keys, cascade

任何人都可以对这些功能的作用以及何时使用它们提供清晰的解释/示例吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-22T14:11:53.127

直接从[说明书](http://www.postgresql.org/docs/8.3/static/ddl-constraints.html#DDL-CONSTRAINTS-FK)...

> 我们知道外键不允许创建与任何产品无关的订单。但是，如果在创建引用该产品的订单后删除该产品怎么办？SQL 也允许您处理它。直观地说，我们有几个选择：
> 
> 禁止删除引用的产品
> 
> 也删除订单
> 
> 还有什么？

```
CREATE TABLE order_items (
 product_no integer REFERENCES products ON DELETE RESTRICT,
 order_id integer REFERENCES orders ON DELETE CASCADE,
 quantity integer,
 PRIMARY KEY (product_no, order_id)
); 
```

> 限制和级联删除是两个最常见的选项。RESTRICT 防止删除引用的行。NO ACTION 表示如果在检查约束时仍然存在任何引用行，则会引发错误；如果您不指定任何内容，这是默认行为。（这两种选择之间的本质区别在于 NO ACTION 允许将检查推迟到事务的后期，而 RESTRICT 不允许。） CASCADE 指定当一个引用的行被删除时，引用它的行应该被自动删除也是。还有两个其他选项：SET NULL 和 SET DEFAULT。当引用的行被删除时，这些会导致引用列分别设置为空值或默认值。请注意，这些并不能成为您遵守任何约束的借口。例如，
> 
> 与 ON DELETE 类似，还有一个 ON UPDATE，它在引用的列被更改（更新）时被调用。可能的动作是一样的。

**编辑：**您可能想看看这个相关问题：[When/Why to use Cascading in SQL Server?](https://stackoverflow.com/questions/59297/whenwhy-to-use-cascading-in-sql-server) . 问题/答案背后的概念是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T14:15:27.830

我有一个 PostGreSQL 数据库，当我有一个从数据库中删除的用户并且我需要从其他表中删除它的信息时，我使用 On Delete。这种方式我只需要执行 1 次删除，具有 ON 删除功能的 FK 将从其他表中删除信息。

您可以对 ON Update 执行相同操作。如果您更新表并且该字段具有 On Update 的 FK，如果在 FK 上进行了更改，您将在 FK 表上注意到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T14:48:16.093

Daok 说的是真的……它可以相当方便。另一方面，让事情在数据库中自动发生可能是一个真正的问题，尤其是在消除数据时。将来有人可能会指望 FK 通常会在有孩子时阻止删除父母这一事实，而没有意识到您使用 On Delete Cascade 不仅不能阻止删除，它还​​会在几十个中生成大量数据由于级联删除的瀑布，其他表消失了。

@Arthur 的评论。

数据库中“隐藏”的事情发生得越频繁，任何人就越不可能很好地掌握正在发生的事情。触发器（这本质上是一个触发器）可以导致我删除一行的简单操作，在整个数据库中产生广泛的后果。我发出一条 Delete 语句，17 个表受到级联触发器和约束的影响，而对于命令的发出者来说，这一切都不是显而易见的。OTOH，如果我将删除父项及其所有子项放在一个过程中，那么任何人都可以非常容易和清楚地看到当我发出命令时会发生什么。

这与我设计数据库的好坏完全无关。它与触发器引入的操作问题有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-08T09:27:06.500

您可以简单地编写一条警告消息，而不是编写级联删除或级联更新的所有工作的方法。比重新发明轮子容易得多，而且它让客户（以及新开发人员拿起代码）清楚

# visual-studio - 视觉辅助低性能

> ID：225889
> 
> 赞同：5
> 
> 时间：2008-10-22T14:08:48.140
> 
> 标签：visual-studio, visual-assist

我在 Visual Studio 2005 中将 Visual Assist X 用于 C/C++ 代码，但我发现，有时，当 Visual Studio 获得焦点时，处理器工作过多，我无法输入代码。如果我等待几秒钟，它会返回焦点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T14:19:37.697

如果您还没有，您真的应该尝试在[Visual Assist 论坛上提问。](http://www.wholetomato.com/forum/default.asp)他们在那里有很大的支持。

他们可能有问题的解决方案/解决方法，如果没有，他们可能想知道问题以便解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T14:15:11.903

尝试从 Visual Assist X 选项对话框的“性能”选项卡中“重建”符号数据库和“清除”历史、缓存和临时文件。您还可以在此处关闭其他可能导致性能问题的“优化”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T16:07:34.233

您可以通过修改`VAssistX`菜单中的设置来显着加快解析时间：

```
    VAssistX | Visual Assist X 选项... | 项目 | C/C++ 目录
    VAssistX | Visual Assist X 选项... | 项目 | 扩展

```

这将允许您将某些目录标记为稳定，这意味着它们不会被重复重新解析。将 VC++ 头目录（例如`C:\Program Files\Microsoft Visual Studio 9.0\VC\include`）和大型库（例如 Boost）添加到此列表应该会有所帮助。

正如其他人所提到的，[Visual Assist X 论坛](http://www.wholetomato.com/forum/default.asp)非常有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:11:55.870

这通常发生在大文件和/或大量打开的文件中，并且是由于对这些文件的解析。

这是[Visual Assist 论坛](http://www.wholetomato.com/forum/default.asp)上的一个已知问题。

# windows-vista - Visual FoxPro 9 与 Windows Vista 的兼容性

> ID：225892
> 
> 赞同：4
> 
> 时间：2008-10-22T14:09:23.457
> 
> 标签：windows-vista, visual-foxpro, foxpro

在 Windows Vista 上使用 Visual FoxPro 9 进行开发时，您发现了哪些兼容性问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T14:29:29.907

我的公司目前没有迁移到 vista 的计划，所以我们还没有测试兼容性问题。Doug Hennig 有一篇关于这个主题的优秀文章：

[http://my.advisor.com/articles.nsf/aid/18897](http://my.advisor.com/articles.nsf/aid/18897)

这些链接也描述了一些问题：

[http://fox.wikis.com/wc.dll?Wiki~VistaAeroIssues~VFP](http://fox.wikis.com/wc.dll?Wiki~VistaAeroIssues~VFP)

[http://fox.wikis.com/wc.dll?Wiki~SP2problemwithVistaan​​dBorderstyle~VFP](http://fox.wikis.com/wc.dll?Wiki~SP2problemwithVistaandBorderstyle~VFP)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T05:57:53.960

我们公司发现 Vista Windows 颜色和外观设置存在一些问题。显然 FoxPro 不能很好地处理新的 Vista 图形。我相信我们通过让用户切换回 Windows“经典”外观设置来解决这些问题。

# java - 这个 Java 单例可以在 WebSphere 6 中重复重建吗？

> ID：225895
> 
> 赞同：13
> 
> 时间：2008-10-22T14:09:24.970
> 
> 标签：java, singleton, instance

我试图找出我们系统中的一个问题，下面的代码让我很担心。以下发生在我们的主 servlet 中的 doPost() 方法中（名称已更改以保护有罪者）：

```
...
if(Single.getInstance().firstTime()){
   doPreperations();
}
normalResponse();
... 
```

单例“Single”如下所示：

```
private static Single theInstance = new Single();

private Single() {
...load properties...
}

public static Single getInstance() {
    return theInstance;
} 
```

通过将其设置为使用静态初始化程序而不是在 getInstance() 方法中检查 null theInstance 的方式，这可以一遍又一遍地重建吗？

PS - 我们在 Java 1.4 上运行带有应用程序的 WebSphere 6

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-22T14:14:18.987

我在 Sun 的网站上找到了这个：

> ### 不同的类加载器同时加载多个单例
> 
> 当两个类加载器加载一个类时，您实际上有该类的两个副本，每个副本都可以有自己的 Singleton 实例。这与在某些 servlet 引擎（例如 iPlanet）中运行的 servlet 尤其相关，其中每个 servlet 默认使用自己的类加载器。事实上，访问联合 Singleton 的两个不同的 servlet 将获得两个不同的对象。
> 
> 多个类加载器比您想象的更常见。当浏览器从网络加载类以供小程序使用时，它们为每个服务器地址使用单独的类加载器。类似地，Jini 和 RMI 系统可以为它们下载类文件的不同代码库使用单独的类加载器。如果您自己的系统使用自定义类加载器，则可能会出现所有相同的问题。
> 
> 如果由不同的类加载器加载，两个具有相同名称的类，甚至相同的包名称，都被视为不同的——即使它们实际上是逐字节的同一个类。不同的类加载器代表不同的命名空间来区分类（即使类的名称相同），因此这两个 `MySingleton`类实际上是不同的。（请参阅参考资料中的“类加载器作为命名空间机制”。）由于两个 Singleton 对象属于同名的两个类，因此乍一看会出现同一个类的两个 Singleton 对象。

[引文](http://www.oracle.com/technetwork/articles/java/singleton-1577166.html)。

除了上述问题之外，如果`firstTime()`未同步，您也可能在那里遇到线程问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-22T14:12:29.427

不，它不会一遍又一遍地构建。它是静态的，所以它只会被构造一次，就在类加载器第一次接触该类时。

唯一的例外——如果你碰巧有多个类加载器。

（来自[GeekAndPoke](http://geekandpoke.typepad.com/.a/6a00d8341d3df553ef0147e0761e2f970b-800wi)）：

![替代文字](https://i.stack.imgur.com/ZHqCV.jpg)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T14:18:33.907

正如其他人所提到的，每个类加载器只会运行一次静态初始化程序。

我要看的一件事是`firstTime()`方法 - 为什么不能在`doPreparations()`单例本身内处理工作？

听起来像是一组令人讨厌的依赖项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-22T14:44:20.300

使用静态初始化器和延迟初始化绝对没有区别。事实上，搞乱延迟初始化要容易得多，这也会强制同步。JVM 保证静态初始化程序总是在访问类之前运行，并且只会发生一次。

也就是说，JVM 不能保证你的类只会被加载一次。但是，即使它被多次加载，您的 Web 应用程序仍然只能看到相关的单例，因为它将在 Web 应用程序类加载器或其父级中加载。如果您部署了多个 Web 应用程序，那么 firstTime() 将为每个应用程序调用一次。

要检查的最明显的事情是 firstTime() 需要同步，并且在退出该方法之前设置了 firstTime 标志。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T21:37:12.993

不，它不会创建“Single”的多个副本。（稍后会访问 Classloader 问题）

您概述的实现在 Briant Goetz 的书“ [Java Concurrency in Practice](http://www.javaconcurrencyinpractice.com/) ”中被描述为“Eager Initialization ”。

```
public class Single
{
    private static Single theInstance = new Single();

    private Single() 
    { 
        // load properties
    }

    public static Single getInstance() 
    {
        return theInstance;
    }
} 
```

但是，代码不是您想要的。您的代码在创建实例后尝试执行延迟初始化。这要求所有客户端库在使用之前执行“firstTime()/doPreparation()”。您将依赖客户端做正确的事情，这使得代码非常脆弱。

您可以将代码修改如下，这样就不会出现任何重复的代码。

```
public class Single
{
    private static Single theInstance = new Single();

    private Single() 
    { 
        // load properties
    }

    public static Single getInstance() 
    {   
        // check for initialization of theInstance
        if ( theInstance.firstTime() )
           theInstance.doPreparation();

        return theInstance;
    }
} 
```

不幸的是，这是延迟初始化的糟糕实现，并且在并发环境（如 J2EE 容器）中不起作用。

有很多关于 Singleton 初始化的文章，特别是关于内存模型的文章。 [JSR 133](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html)解决了 Java 1.5 和 1.6 中 Java 内存模型的许多弱点。

对于 Java 1.5 和 1.6，您有多种选择，它们在Joshua Bloch的“ [Effective Java](http://java.sun.com/docs/books/effective/) ”一书中提到。

1.  Eager Initialziation，如上[EJ Item 3]
2.  Lazy Initalization Holder 类成语 [EJ Item 71]
3.  枚举类型 [EJ 项目 3]
4.  带有“volatile”静态字段的双重检查锁定 [EJ Item 71]

解决方案 3 和 4 仅适用于 Java 1.5 及更高版本。所以最好的解决方案是#2。

这是伪实现。

```
public class Single
{
    private static class SingleHolder
    {
        public static Single theInstance = new Single();
    }

    private Single() 
    { 
        // load properties
        doPreparation();
    }

    public static Single getInstance() 
    {
        return SingleHolder.theInstance;
    }
} 
```

请注意，'doPreparation()' 在构造函数内部，因此您可以保证获得正确初始化的实例。此外，您正在利用 JVM 的延迟类加载，并且不需要任何同步“getInstance()”。

您注意到静态字段 theInstance**不是“最终”的一件事。** Java Concurrency 上的示例没有“final”，但 EJ 有。也许詹姆斯可以为他对“类加载器”的回答和“最终”的要求添加更多颜色以保证正确性，

话虽如此，使用“静态最终”有一个副作用。当 Java 编译器看到“static final”并尝试尽可能地内联它时，它会非常激进。[Jeremy Manson 的博客文章](http://jeremymanson.blogspot.com/2008/07/immutability-in-java-part-3.html)中提到了这一点。

这是一个简单的例子。

文件：A.java

```
public class A
{
    final static String word = "Hello World";
} 
```

文件：B.java

```
public class B
{
    public static void main(String[] args) {
        System.out.println(A.word);
    }
} 
```

编译 A.java 和 B.java 之后，将 A.java 更改为以下。

文件：A.java

```
public class A
{
    final static String word = "Goodbye World";
} 
```

您重新编译“A.java”并重新运行 B.class。你会得到的输出是

```
Hello World 
```

至于类加载器问题，答案是肯定的，你可以在多个类加载器中拥有多个 Singleton 实例。[您可以在wikipedia](http://en.wikipedia.org/wiki/Java_Classloader)上找到更多信息。还有一篇关于[Websphere](http://www-128.ibm.com/developerworks/websphere/library/techarticles/0112_deboer/deboer.html)的具体文章。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T14:17:24.270

关于单例实现（除了根本不使用单例），我唯一要改变的就是使实例字段成为最终的。静态字段将在类加载时初始化一次。由于类是延迟加载的，因此您可以有效地免费获得延迟实例化。

当然，如果它是从单独的类加载器加载的，您会得到多个“单例”，但这是 Java 中每个单例惯用语的限制。

**编辑**： firstTime() 和 doPreparations() 位看起来确实很可疑。不能将它们移到单例实例的构造函数中吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T14:14:07.177

否 - 的静态初始化`instance`只会执行一次。需要考虑两件事：

*   这不是线程安全的（实例未“发布”到主内存）
*   除非正确同步，否则您的`firstTime`方法可能会被多次调用

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T14:16:18.670

理论上它只会被建造一次。但是，这种模式在各种应用程序服务器中中断，您可以获得“单例”类的多个实例（因为它们不是线程安全的）。

此外，单例模式也受到了很多批评。看例如[Singleton 我爱你，但你让我失望](http://www.codingwithoutcomments.com/2008/10/08/singleton-i-love-you-but-youre-bringing-me-down/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T14:33:37.653

这只会在类加载器加载类时加载一次。这个例子提供了一个更好的 Singleton 实现，然而，它尽可能地延迟加载并且线程安全。此外，它适用于所有已知的 Java 版本。该解决方案是跨不同 Java 编译器和虚拟机的最可移植的解决方案。

```
 public class Single {

private static class SingleHolder {
   private static final Single INSTANCE = new Single();
}

private Single() {
...load properties...
}

public static Single getInstance() {
    return SingleHolder.INSTANCE;
}

}
```

内部类的引用不早于调用 getInstance() 的那一刻（因此类加载器不早于加载）。因此，该解决方案是线程安全的，不需要特殊的语言结构（即易失性和/或同步）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-13T15:14:30.513

单个实例不是强制的（这确实不是一个好主意，因为这将避免您使用其他模式切换它的行为）。

# 在下面的代码中，您可以看到它是如何只实例化一次的（第一次调用构造函数时）

包装日期；

导入 java.util.Date；

公共类 USDateFactory 实现 DateFactory { 私有静态 USDateFactory usdatefactory = null;

```
private USDateFactory () { }

public static USDateFactory getUsdatefactory() {
    if(usdatefactory==null) {
        usdatefactory = new USDateFactory();
    }
    return usdatefactory;
}

public String getTextDate (Date date) {
    return null;
}

public NumericalDate getNumericalDate (Date date) {
    return null;
} 
```

}

# javascript - Javascript：如何遍历元素并为某些元素调用 onblur 处理程序

> ID：225915
> 
> 赞同：1
> 
> 时间：2008-10-22T14:15:05.193
> 
> 标签：javascript, javascript-events

我有一个案例，我在屏幕上有一堆文本框和单选按钮，所有这些都是用各种 DIV 动态构建的。所有文本框都有 onblur 例程来验证条目，但根据单选按钮的选择，文本框条目在最初有效时可能无效。我不能将 onblur 与单选按钮一起使用，因为它们可以从单选按钮进入无效的文本框之一并创建无限循环，因为我将焦点放在无效元素上。由于每个文本框都有自己的 onblur 调用特殊参数，我认为最好的方法是在提交表单时调用文本框的 onblur 事件，以确保所有条目在单选按钮配置下仍然有效已选择。如果其中一个 onblur 事件返回 false，我还需要它停止提交，以便他们可以更正错误的文本框。这是我写的...

```
 for (var intElement = 0; intElement < document.forms[0].elements.length; intElement = intElement + 1)
    {
        if (document.forms[0].elements[intElement].name.substr(3) == "FactorAmount") // The first 3 characters of the name are a unique identifier for each field
        {
            if (document.forms[0].elements[intElement].onblur())
            {
                return false;
                break;
            }
        }
    }

return true; 
```

我最初有 (!document.forms[0].elements[intElement].onblur()) 但是当我有那个时，来自 onblur 事件的警报消息没有弹出。现在警报消息正在弹出，但如果遇到错误，它仍会继续循环遍历元素。我已经用调试器两种方式逐步完成了这个，它似乎循环得很好，但它要么是1）在我需要它时没有停止并返回false，要么2）没有执行我的警报消息来告诉用户什么错误是。有人可以帮忙吗？这可能是我正在做的愚蠢的事情。

被调用的 onblur 方法看起来像这样......

```
function f_VerifyRange(tagFactor, reaMin, reaMax, intPrecision, sLOB, sIL, sFactorCode)
{
    var tagCreditOrDebit;
    var tagIsTotal;
    var tagPercentageOrDecimal;

    eval("tagCreditOrDebit = document.forms[0]." + tagFactor.name.substr(0,3) + "CreditOrDebitC");

    eval("tagIsTotal = document.forms[0]." + tagFactor.name.substr(0,3) + "IsTotal");
    eval("tagPercentageOrDecimal = document.forms[0]." + tagFactor.name.substr(0,3) + "PercentageOrDecimal");

    if (tagPercentageOrDecimal.value == "P")
    {
        reaMax = Math.round((reaMax - 1) * 100);
        reaMin = Math.round((1 - reaMin) * 100);

        if (parseFloat(tagFactor.value) == 0)
        {
            alert("Please enter a value other than 0 or leave this field blank.");

            f_SetFocus(tagFactor);
            return false;
        }

        if (tagIsTotal.value == "True")
        {
            if (tagCreditOrDebit.checked)
            {
                if (parseFloat(tagFactor.value) > reaMin)
                {
                    alert("Please enter a value less than or equal to " + reaMin + "% for a credit or " + reaMax + "% for a debit.");
                    f_SetFocus(tagFactor);
                    return false;
                }
            }
            else
            {
                if (parseFloat(tagFactor.value) > reaMax)
                {
                    alert("Please enter a value less than or equal to " + reaMin + "% for a credit or " + reaMax + "% for a debit.");
                    f_SetFocus(tagFactor);
                    return false;
                }
            }
        }
    }

    return true;
} 
```

**编辑：**我想我已经弄清楚为什么这不能按预期工作，但我仍然不知道如何完成我需要做的事情。下面的行...

```
 if (!document.forms[0].elements[intElement].onblur()) 
```

或者

```
 if (document.forms[0].elements[intElement].onblur()) 
```

没有返回单个 onblur 函数 (f_VerifyRange) 返回的内容。相反，无论如何它总是返回真或假。在第一种情况下，它返回 true，然后在第一个文本框之后退出并中止提交，即使第一个文本框没有错误。在第二种情况下，它返回 false 并遍历所有框。即使可能有错误（它显示），它也不认为有任何错误，所以它继续提交。我想我真正需要的是如何从我的 onblur 函数 f_VerifyRange 获取返回值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:26:06.860

这个问题对我来说有点太深夜了，但我会给你一些建议：

```
eval("tagCreditOrDebit = document.forms[0]." + tagFactor.name.substr(0,3) + "CreditOrDebitC"); 
```

这可以用更好的方式编写：

```
tagCreditOrDebit = document.forms[0][tagFactor.name.substr(0,3) + "CreditOrDebitC"]; 
```

在 javascript 中，任何可以使用点分语法的地方，都可以使用方括号。

```
document.body;
document['body'];
var b = 'body';
document[b]; 
```

另外，考虑为您的表单提供某种标识符。我完全不知道为什么`document.forms[0]`这么长时间处理表单的标准方法是……如果您决定在该表单之前的页面上放置另一个表单，那么一切都会中断！

其他方法包括：

```
// HTML
<form name="myFormName">

// Javascript
var f = document.myFormName; 
```

或者

```
<form id="myFormId">

var f = document.getElementById("myFormId") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T23:21:25.013

你没有得到任何成功，`if (!...onblur())`因为直接使用时`onblur()`总是返回。是一个[事件处理函数](http://www.w3schools.com/jsref/jsref_events.asp)。就像您发现的那样，您必须创建一个解决方法。`undefined``OnBlur()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T18:51:15.840

我最终用一个全局变量解决了这个问题。`g_bHardEditsPassed`假设我们没有错误，我最初将值设置为 true。然后在 中`f_VerifyRange`，每次我返回一个值时，我都会在它前面放一行来设置`g_bHardEditsPassed`要匹配的变量。然后我修改循环看起来像这样......

```
 g_bHardEditsPassed = true;

    for (var intElement = 0; intElement < document.forms[0].elements.length; intElement = intElement + 1)
    {
        if (document.forms[0].elements[intElement].name.substr(3) == "FactorAmount")
        {
            document.forms[0].elements[intElement].onblur()
            if (!g_bHardEditsPassed)
            {
                g_bHardEditsPassed = true;
                return false;
            }
        }
    }

    return true; 
```

感谢大家的建议。我确信 jQuery 的东西在未来特别值得研究。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-22T14:27:20.770

首先，看在上帝的爱和所有神圣的事物上，停止编写原生 javascript 并帮助自己使用一些[jQuery](http://jquery.com) :)

其次，开始使用验证框架。对于 jQuery，[jQuery Validate](http://docs.jquery.com/Plugins/Validation)通常工作得很好。它支持不同字段之间的依赖关系等。你还可以很容易地添加新规则，比如有效的 ISBN 号等。

**编辑：**至于你的代码，我不确定你是否可以使用 onunload ，因为那时没有回头路，你不能在那个时候中止。您应该将此代码放在 onsubmit 事件上。

# javascript - 如何将 ActiveX 事件中的对象参数传递给脚本

> ID：225916
> 
> 赞同：2
> 
> 时间：2008-10-22T14:15:07.753
> 
> 标签：javascript, events, vbscript, activex

[从这里](https://stackoverflow.com/questions/150814/how-to-handle-an-activex-event-in-javascript)的这个问题开始

我有一个自定义 ActiveX 控件，它引发一个事件“BeforePageValidated”，该事件有一个参数“args”，它是一个包含布尔值的对象。这样做的目的是允许客户端覆盖验证并通过将布尔值设置为 true 来强制验证失败。

我可以使用以下方法在 IE 中捕获事件

```
<script for="objInterviewNOW" event="BeforePageValidated(args)"> 
```

但是我无法访问 args 对象的属性。

我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:28:16.243

为我自己解决了。

问题是该事件是从另一个被 activeX 控件使用的 dll 传递下来的，这就是声明 args 类的地方。

通过在 activeX 对象中创建 args 类的副本并在引发事件时使用它来修复它。

不幸的是，这确实意味着 args 类是重复的，所以也许有人知道更好的方法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-18T05:07:59.530

`args`还需要注册为 com 对象。

```
[ComVisible(true)]
[GuidAttribute("xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx")]
public class args
{

} 
```

希望这会有所帮助。

# oop - 多重继承的确切问题是什么？

> ID：225929
> 
> 赞同：127
> 
> 时间：2008-10-22T14:17:50.117
> 
> 标签：oop, multiple-inheritance, language-theory

我可以看到人们一直在问是否应该在下一个版本的 C# 或 Java 中包含多重继承。有幸拥有这种能力的 C++ 人说，这就像给某人一根绳子，最终让自己上吊。

多重继承是怎么回事？有具体的样品吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2008-10-22T14:44:37.210

最明显的问题是函数覆盖。

假设有两个类`A`和`B`，它们都定义了一个方法`doSomething`。现在您定义了第三个 class `C`，它继承自`A`and `B`，但您不覆盖该`doSomething`方法。

当编译器播种此代码时...

```
C c = new C();
c.doSomething(); 
```

...应该使用哪种方法实现？没有任何进一步的说明，编译器就不可能解决歧义。

除了覆盖之外，多重继承的另一个大问题是物理对象在内存中的布局。

C++、Java 和 C# 等语言为每种类型的对象创建了基于地址的固定布局。像这样的东西：

```
class A:
    at offset 0 ... "abc" ... 4 byte int field
    at offset 4 ... "xyz" ... 8 byte double field
    at offset 12 ... "speak" ... 4 byte function pointer

class B:
    at offset 0 ... "foo" ... 2 byte short field
    at offset 2 ... 2 bytes of alignment padding
    at offset 4 ... "bar" ... 4 byte array pointer
    at offset 8 ... "baz" ... 4 byte function pointer 
```

当编译器生成机器代码（或字节码）时，它使用这些数字偏移量来访问每个方法或字段。

多重继承使它非常棘手。

如果 class`C`继承自`A`and `B`，编译器必须决定是按`AB`顺序还是按`BA`顺序布局数据。

但是现在假设您正在调用`B`对象的方法。真的只是一个`B`吗？或者它实际上是一个`C`通过其`B`接口被多态调用的对象？根据对象的实际身份，物理布局会有所不同，并且不可能知道要在调用点调用的函数的偏移量。

处理这种系统的方法是放弃固定布局方法，允许在尝试调用函数或访问其字段*之前查询每个对象的布局。*

所以......长话短说......编译器作者支持多重继承是一件很痛苦的事情。因此，当像 Guido van Rossum 这样的人设计 python，或者当 Anders Hejlsberg 设计 c# 时，他们知道支持多重继承将使编译器实现变得更加复杂，并且大概他们认为收益不值得付出代价。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-11-14T22:03:03.990

你们提到的问题其实并没有那么难解决。事实上，例如 Eiffel 做得非常好！（并且没有引入任意选择或其他）

例如，如果您从 A 和 B 继承，都具有方法 foo()，那么您当然不希望在从 A 和 B 继承的类 C 中进行任意选择。您必须重新定义 foo，以便清楚将是什么如果 c.foo() 被调用，则使用，否则您必须重命名 C 中的方法之一。（它可能变成 bar()）

另外我认为多重继承通常非常有用。如果您查看 Eiffel 的库，您会发现它在所有地方都被使用，而且当我不得不回到 Java 编程时，我个人已经错过了这个功能。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-10-22T14:30:42.340

[钻石问题](http://en.wikipedia.org/wiki/Diamond_problem)：

> 当两个类 B 和 C 继承自 A，而类 D 继承自 B 和 C 时，就会出现歧义。如果 A 中存在 B 和 C 已[覆盖](https://en.wikipedia.org/wiki/Method_overriding_(programming))的方法，并且 D 没有覆盖它，那么哪个版本的D 继承的方法：B 的方法，还是 C 的方法？
> 
> ...由于在这种情况下类继承图的形状，它被称为“钻石问题”。在这种情况下，A 类位于顶部，B 和 C 分别位于其下方，D 类在底部将两者连接在一起形成菱形......

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-22T14:33:05.797

多重继承是不经常使用的东西之一，可能会被误用，但有时需要。

我从来不理解不添加一个功能，只是因为它可能被滥用，当没有好的替代品时。接口不是多重继承的替代品。一方面，它们不允许您强制执行前置条件或后置条件。就像任何其他工具一样，您需要知道何时适合使用以及如何使用它。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-22T14:19:47.663

假设您有对象 A 和 B，它们都由 C 继承。A 和 B 都实现了 foo() 而 C 没有。我打电话给 C.foo()。选择哪个实现？还有其他问题，但这种事情是一个大问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-07-06T07:57:52.250

我不认为钻石问题是个问题，我会考虑诡辩，仅此而已。

从我的角度来看，多重继承最糟糕的问题是 RAD——受害者和自称是开发人员但实际上被困在半边知识（充其量）的人。

就个人而言，如果我最终能在 Windows 窗体中做这样的事情，我会非常高兴（这不是正确的代码，但它应该给你这个想法）：

```
public sealed class CustomerEditView : Form, MVCView<Customer> 
```

这是我没有多重继承的主要问题。你可以对接口做类似的事情，但是我称之为“s***代码”，例如，你必须在每个类中编写这种痛苦的重复c***来获取数据上下文。

在我看来，对于现代语言中的任何代码重复，绝对没有必要，一点也没有。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-22T14:28:15.213

tloach 的例子很好地总结了多重继承的主要问题。当从多个实现相同函数或字段的基类继承时，编译器必须决定要继承什么实现。

当您从多个继承自同一个基类的类继承时，情况会变得更糟。（菱形继承，如果你绘制继承树，你会得到菱形）

这些问题对于编译器来说并不是真正需要克服的问题。但是编译器必须在这里做出的选择是相当随意的，这使得代码变得不那么直观。

我发现在进行良好的 OO 设计时，我从不需要多重继承。如果我确实需要它，我通常会发现我一直在使用继承来重用功能，而继承只适用于“is-a”关系。

还有其他技术（例如 mixins）可以解决相同的问题，并且没有多重继承所存在的问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-09-02T14:54:44.900

多重继承本身并没有错。问题是将多重继承添加到从一开始就没有考虑多重继承的语言中。

Eiffel 语言以一种非常有效和高效的方式无限制地支持多重继承，但该语言从一开始就是为了支持它而设计的。

对于编译器开发人员来说，这个特性实现起来很复杂，但似乎可以通过良好的多重继承支持可以避免支持其他特性（即不需要接口或扩展方法）来弥补这个缺点。

我认为是否支持多重继承更多的是一个选择问题，一个优先级问题。更复杂的功能需要更多时间才能正确实施和操作，并且可能更具争议性。C++ 实现可能是 C# 和 Java 中没有实现多重继承的原因......

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-03-26T08:19:31.093

Common Lisp 对象系统 (CLOS) 是另一个例子，它支持 MI 同时避免了 C++ 风格的问题：继承被赋予一个[合理的默认值](http://www.gigamonkeys.com/book/object-reorientation-classes.html)，同时仍然允许您自由地明确决定如何准确地调用 super 的行为.

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-05-22T21:54:10.510

只要您**不**使用 C++ 虚拟继承之类的东西，菱形就不是问题：在正常继承中，每个基类都类似于一个成员字段（实际上它们以这种方式在 RAM 中布局），为您提供一些语法糖和一个覆盖更多虚拟方法的额外能力。这可能会在编译时产生一些歧义，但这通常很容易解决。

另一方面，使用虚拟继承，它很容易失控（然后变得一团糟）。以“心”图为例：

```
 A       A
 / \     / \
B   C   D   E
 \ /     \ /
  F       G
    \   /
      H 
```

在 C++ 中，这是完全不可能的：一旦`F`和`G`被合并到一个类中，它们`A`的 s 也会被合并，句号。这意味着您可能永远不会认为 C++ 中的基类是不透明的（在此示例中，您必须在其中构造`A`，`H`因此您必须知道它存在于层次结构中的某个位置）。但是，在其他语言中它可能会起作用；例如，`F`并且`G`可以明确地将 A 声明为“内部”，从而禁止随后的合并并有效地使自己变得稳固。

另一个有趣的例子（**不是**C++ 特定的）：

```
 A
 / \
B   B
|   |
C   D
 \ /
  E 
```

这里，只`B`使用虚拟继承。所以`E`包含两个`B`共享相同的 s `A`。这样，您可以获得指向 的`A*`指针`E`，但不能将其转换为`B*`指针，尽管对象**实际上**是`B` 这样的转换是模棱两可的，并且在编译时无法检测到这种歧义（除非编译器看到整个程序）。这是测试代码：

```
struct A { virtual ~A() {} /* so that the class is polymorphic */ };
struct B: virtual A {};
struct C: B {};
struct D: B {};
struct E: C, D {};

int main() {
        E data;
        E *e = &data;
        A *a = dynamic_cast<A *>(e); // works, A is unambiguous
//      B *b = dynamic_cast<B *>(e); // doesn't compile
        B *b = dynamic_cast<B *>(a); // NULL: B is ambiguous
        std::cout << "E: " << e << std::endl;
        std::cout << "A: " << a << std::endl;
        std::cout << "B: " << b << std::endl;
// the next casts work
        std::cout << "A::C::B: " << dynamic_cast<B *>(dynamic_cast<C *>(e)) << std::endl;
        std::cout << "A::D::B: " << dynamic_cast<B *>(dynamic_cast<D *>(e)) << std::endl;
        std::cout << "A=>C=>B: " << dynamic_cast<B *>(dynamic_cast<C *>(a)) << std::endl;
        std::cout << "A=>D=>B: " << dynamic_cast<B *>(dynamic_cast<D *>(a)) << std::endl;
        return 0;
} 
```

此外，实现可能非常复杂（取决于语言；参见 benjismith 的回答）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-04-08T15:49:38.213

Java 和 .NET 等框架的设计目标之一是使编译后的代码能够与预编译库的一个版本一起工作，即使这些后续版本也能与该库的后续版本同样好地工作添加新功能。虽然 C 或 C++ 等语言的正常范例是分发包含所需所有库的静态链接可执行文件，但 .NET 和 Java 中的范例是将应用程序分发为在运行时“链接”的组件集合.

.NET 之前的 COM 模型试图使用这种通用方法，但它并没有真正的继承——相反，每个类定义都有效地定义了一个类和一个包含其所有公共成员的同名接口。实例属于类类型，而引用属于接口类型。将一个类声明为从另一个类派生等同于将一个类声明为实现另一个类的接口，并且要求新类重新实现一个派生类的所有公共成员。如果 Y 和 Z 从 X 派生，然后 W 从 Y 和 Z 派生，则 Y 和 Z 以不同方式实现 X 的成员无关紧要，因为 Z 将无法使用它们的实现——它必须定义它的自己的。W 可能封装 Y 和/或 Z 的实例，

Java 和 .NET 的困难在于允许代码继承成员，并且对它们的访问*隐含地*引用父成员。假设一个类 WZ 与上述相关：

```
class X { public virtual void Foo() { Console.WriteLine("XFoo"); }
class Y : X {};
class Z : X {};
class W : Y, Z  // Not actually permitted in C#
{
  public static void Test()
  {
    var it = new W();
    it.Foo();
  }
} 
```

似乎`W.Test()`应该创建一个 W 实例调用`Foo`定义在`X`. 然而，假设 Y 和 Z 实际上是在一个单独编译的模块中，虽然它们在 X 和 W 编译时定义如上，但它们后来被更改并重新编译：

```
class Y : X { public override void Foo() { Console.WriteLine("YFoo"); }
class Z : X { public override void Foo() { Console.WriteLine("ZFoo"); } 
```

现在调用的效果应该是什么`W.Test()`？如果程序必须在分发之前进行静态链接，静态链接阶段可能能够识别出，虽然在 Y 和 Z 更改之前程序没有歧义，但对 Y 和 Z 的更改使事情变得模棱两可，链接器可以拒绝构建程序，除非或直到这种歧义得到解决。另一方面，同时拥有 W 和新版本 Y 和 Z 的人可能只是想运行该程序而没有任何源代码的人。运行时`W.Test()`，将不再清楚是什么`W.Test()`应该这样做，但是在用户尝试使用新版本的 Y 和 Z 运行 W 之前，系统的任何部分都无法识别存在问题（除非 W 在更改 Y 和 Z 之前就被认为是非法的） .

# c# - foreach 与 someList.ForEach(){}

> ID：225937
> 
> 赞同：196
> 
> 时间：2008-10-22T14:19:06.760
> 
> 标签：c#, .net, generics, loops, enumeration

显然有很多方法可以迭代一个集合。好奇是否有任何差异，或者为什么你会使用一种方式而不是另一种方式。

第一种：

```
List<string> someList = <some way to init>
foreach(string s in someList) {
   <process the string>
} 
```

另一种方式：

```
List<string> someList = <some way to init>
someList.ForEach(delegate(string s) {
    <process the string>
}); 
```

我想在我的脑海中，而不是我上面使用的匿名委托，你会有一个可重用的委托，你可以指定......

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2008-10-22T14:50:46.683

两者之间有一个重要且有用的区别。

因为 .ForEach 使用`for`循环来迭代集合，所以这是有效的（编辑：**在 .net 4.5 之前**- 实现发生了变化并且它们都抛出了）：

```
someList.ForEach(x => { if(x.RemoveMe) someList.Remove(x); }); 
```

而`foreach`使用枚举器，所以这是无效的：

```
foreach(var item in someList)
  if(item.RemoveMe) someList.Remove(item); 
```

* * *

**tl;dr：不要将此代码复制粘贴到您的应用程序中！**

`ForEach()`这些示例不是最佳实践，它们只是为了演示和之间的区别`foreach`。

从循环中的列表中删除项目`for`可能会产生副作用。对此问题的评论中描述了最常见的一种。

通常，如果您希望从列表中删除多个项目，您可能希望将确定要删除的项目与实际删除分开。它不会使您的代码保持紧凑，但它保证您不会错过任何项目。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-10-22T15:28:58.540

我们这里有一些代码（在 VS2005 和 C#2.0 中），以前的工程师不遗余力地使用这些代码，`list.ForEach( delegate(item) { foo;});`而不是`foreach(item in list) {foo; };`他们编写的所有代码。例如，用于从 dataReader 读取行的代码块。

我仍然不知道他们为什么这样做。

的缺点`list.ForEach()`是：

*   它在 C# 2.0 中更加冗长。但是，从 C# 3 开始，您可以使用 " `=>`" 语法来制作一些非常简洁的表达式。

*   它不太熟悉。必须维护此代码的人会想知道您为什么这样做。我花了一段时间才确定没有任何理由，除了可能让作者看起来很聪明（其余代码的质量破坏了这一点）。它的可读性也较差，`})`在委托代码块的末尾带有“”。

*   另请参阅 Bill Wagner 的书“Effective C#: 50 Specific Ways to Improvement Your C#”，其中他谈到了为什么 foreach 比其他循环（如 for 或 while 循环）更受欢迎 - 重点是让编译器决定构建的最佳方式循环。如果编译器的未来版本设法使用更快的技术，那么您将通过使用 foreach 和重新构建来免费获得它，而不是更改您的代码。

*   一个`foreach(item in list)`构造允许您使用`break`或者`continue`如果您需要退出迭代或循环。但是您不能更改 foreach 循环内的列表。

我很惊讶地看到它`list.ForEach`稍微快了一点。但这可能不是始终使用它的正当理由，那将是过早的优化。如果您的应用程序使用的数据库或 Web 服务，而不是循环控制，几乎总是会成为时间流逝的地方。您是否也针对`for`循环对其进行了基准测试？由于`list.ForEach`在内部使用它可能会更快，而`for`没有包装器的循环会更快。

我不同意该`list.ForEach(delegate)`版本在任何重要方面都“更具功能性”。它确实将函数传递给函数，但结果或程序组织没有太大区别。

我不认为`foreach(item in list)`“确切地说明了您希望它如何完成”-`for(int 1 = 0; i < count; i++)`循环可以做到这一点，`foreach`循环将控制权的选择留给编译器。

我的感觉是，在一个新项目中，`foreach(item in list)`为大多数循环使用以遵守常见用法和可读性，并且`list.Foreach()`仅用于短块，当您可以使用 C# 3 " `=>`" 运算符更优雅或更紧凑地做一些事情时。在这种情况下，可能已经有一个比`ForEach()`. 查看`Where()`, `Select()`, `Any()`,`All()`或`Max()`许多其他 LINQ 方法之一是否尚未从循环中执行您想要的操作。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-22T14:53:48.080

为了好玩，我将 List 弹出到反射器中，这是生成的 C#：

```
public void ForEach(Action<T> action)
{
    if (action == null)
    {
        ThrowHelper.ThrowArgumentNullException(ExceptionArgument.match);
    }
    for (int i = 0; i < this._size; i++)
    {
        action(this._items[i]);
    }
} 
```

同样，foreach 使用的 Enumerator 中的 MoveNext 是这样的：

```
public bool MoveNext()
{
    if (this.version != this.list._version)
    {
        ThrowHelper.ThrowInvalidOperationException(ExceptionResource.InvalidOperation_EnumFailedVersion);
    }
    if (this.index < this.list._size)
    {
        this.current = this.list._items[this.index];
        this.index++;
        return true;
    }
    this.index = this.list._size + 1;
    this.current = default(T);
    return false;
} 
```

List.ForEach 比 MoveNext 更精简 - 处理更少 - 更有可能将 JIT 转化为有效的东西。

此外，foreach() 无论如何都会分配一个新的 Enumerator。GC 是您的朋友，但是如果您重复执行相同的 foreach，这将产生更多的一次性对象，而不是重用相同的委托 -**但是**- 这确实是一个边缘案例。在典型用法中，您会发现很少或没有区别。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2019-12-11T01:03:16.907

正如他们所说，魔鬼在细节中......

两种集合枚举方法的最大区别是`foreach`带状态，`ForEach(x => { })`而不带。

但是让我们再深入一点，因为有些事情您应该注意会影响您的决定，并且在为任何一种情况编码时都应该注意一些警告。

让我们`List<T>`在我们的小实验中使用来观察行为。对于这个实验，我使用的是 .NET 4.7.2：

```
var names = new List<string>
{
    "Henry",
    "Shirley",
    "Ann",
    "Peter",
    "Nancy"
}; 
```

让我们先迭代一下`foreach`：

```
foreach (var name in names)
{
    Console.WriteLine(name);
} 
```

我们可以将其扩展为：

```
using (var enumerator = names.GetEnumerator())
{

} 
```

拿着枚举器，我们得到：

```
public List<T>.Enumerator GetEnumerator()
{
  return new List<T>.Enumerator(this);
}
    internal Enumerator(List<T> list)
{
  this.list = list;
  this.index = 0;
  this.version = list._version;
  this.current = default (T);
}

public bool MoveNext()
{
  List<T> list = this.list;
  if (this.version != list._version || (uint) this.index >= (uint) list._size)
    return this.MoveNextRare();
  this.current = list._items[this.index];
  ++this.index;
  return true;
}

object IEnumerator.Current
{
  {
    if (this.index == 0 || this.index == this.list._size + 1)
      ThrowHelper.ThrowInvalidOperationException(ExceptionResource.InvalidOperation_EnumOpCantHappen);
    return (object) this.Current;
  }
} 
```

两件事变得显而易见：

1.  我们返回一个对底层集合有深入了解的有状态对象。
2.  集合的副本是浅拷贝。

这当然不是线程安全的。正如上面所指出的，在迭代时更改集合只是不好的魔力。

但是，在迭代期间通过我们之外的方式在迭代期间对集合进行处理而导致集合变得无效的问题呢？最佳实践建议在操作和迭代期间对集合进行版本控制，并检查版本以检测底层集合何时更改。

这就是事情变得非常模糊的地方。根据微软文档：

> 如果对集合进行了更改，例如添加、修改或删除元素，则枚举器的行为是未定义的。

嗯，那是什么意思？举例来说，仅仅因为`List<T>`实现了异常处理并不意味着所有实现`IList<T>`的集合都会这样做。这似乎明显违反了 Liskov 替换原则：

> 超类的对象应该可以用它的子类的对象替换而不破坏应用程序。

另一个问题是枚举器必须实现`IDisposable`——这意味着潜在内存泄漏的另一个来源，不仅是调用者弄错了，而且如果作者没有`Dispose`正确实现该模式。

最后，我们有一个生命周期的问题......如果迭代器是有效的，但是底层的集合已经消失了怎么办？*我们现在是什么*的快照......当你将集合的生命周期和它的迭代器分开时，你是在自找麻烦。

现在让我们检查一下`ForEach(x => { })`：

```
names.ForEach(name =>
{

}); 
```

这扩展为：

```
public void ForEach(Action<T> action)
{
  if (action == null)
    ThrowHelper.ThrowArgumentNullException(ExceptionArgument.match);
  int version = this._version;
  for (int index = 0; index < this._size && (version == this._version || !BinaryCompatibility.TargetsAtLeast_Desktop_V4_5); ++index)
    action(this._items[index]);
  if (version == this._version || !BinaryCompatibility.TargetsAtLeast_Desktop_V4_5)
    return;
  ThrowHelper.ThrowInvalidOperationException(ExceptionResource.InvalidOperation_EnumFailedVersion);
} 
```

重要的注意事项如下：

`for (int index = 0; index < this._size && ... ; ++index) action(this._items[index]);`

此代码不分配任何枚举器（没有分配给），并且在迭代时`Dispose`不会*暂停。*

请注意，这也会执行底层集合的浅拷贝，但该集合现在是时间快照。如果作者没有正确实施对集合更改或“陈旧”的检查，则快照仍然有效。

这绝不会保护您免受生命周期问题的影响...如果基础集合消失了，您现在有一个浅拷贝，指向什么...但至少您没有`Dispose`问题处理孤立的迭代器...

是的，我说的是迭代器……有时拥有状态是有利的。假设您想维护类似于数据库游标的东西……也许多`foreach`样式`Iterator<T>`是要走的路。我个人不喜欢这种设计风格，因为有太多的终生问题，而且你依赖于你所依赖的集合的作者的好意（除非你真的从头开始写所有东西）。

总有第三种选择...

```
for (var i = 0; i < names.Count; i++)
{
    Console.WriteLine(names[i]);
} 
```

它不性感，但它有牙齿（向**汤姆克鲁斯**和电影**The Firm**道歉）

这是你的选择，但现在你知道了，它可以成为一个知情的人。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-22T14:22:48.750

我猜这个`someList.ForEach()`调用可以很容易地并行化，而正常`foreach`的并行运行并不容易。您可以轻松地在不同的核心上运行多个不同的委托，这对于普通的`foreach`.
只是我的 2 美分

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-10-22T15:41:40.213

我知道有两件晦涩难懂的东西让它们与众不同。走我！

首先，存在为列表中的每个项目创建委托的经典错误。如果您使用 foreach 关键字，您的所有代表最终都可以引用列表的最后一项：

```
 // A list of actions to execute later
    List<Action> actions = new List<Action>();

    // Numbers 0 to 9
    List<int> numbers = Enumerable.Range(0, 10).ToList();

    // Store an action that prints each number (WRONG!)
    foreach (int number in numbers)
        actions.Add(() => Console.WriteLine(number));

    // Run the actions, we actually print 10 copies of "9"
    foreach (Action action in actions)
        action();

    // So try again
    actions.Clear();

    // Store an action that prints each number (RIGHT!)
    numbers.ForEach(number =>
        actions.Add(() => Console.WriteLine(number)));

    // Run the actions
    foreach (Action action in actions)
        action(); 
```

List.ForEach 方法没有这个问题。迭代的当前项通过值作为参数传递给外部 lambda，然后内部 lambda 在其自己的闭包中正确捕获该参数。问题解决了。

（遗憾的是，我相信 ForEach 是 List 的成员，而不是扩展方法，尽管您自己定义它很容易，因此您可以在任何可枚举类型上使用此功能。）

其次，ForEach 方法方法有一个局限性。如果您通过使用 yield return 来实现 IEnumerable，则不能在 lambda 内执行 yield return。因此，这种方法不可能循环遍历集合中的项目以产生返回的东西。您必须使用 foreach 关键字并通过在循环内手动制作当前循环值的副本来解决闭包问题。

[更多在这里](http://incrediblejourneysintotheknown.blogspot.com/2008/06/classic-delegateforeach-interaction-bug.html)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-22T14:24:52.630

您可以命名匿名代表:-)

你可以把第二个写成：

```
someList.ForEach(s => s.ToUpper()) 
```

我更喜欢，并且节省了很多打字。

正如 Joachim 所说，并行性更容易应用于第二种形式。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-22T14:41:38.837

List.ForEach() 被认为更实用。

`List.ForEach()`说你想做什么。 `foreach(item in list)`还准确地说明了您希望它如何完成。这使得将来`List.ForEach`可以自由更改*how部分的实现。*例如，假设`List.ForEach`每个人都有许多通常处于空闲状态的 cpu 内核，假设的未来版本的 .Net 可能总是并行运行。

另一方面，`foreach (item in list)`让您对循环有更多的控制。例如，您知道项目将按某种顺序迭代，如果项目满足某些条件，您很容易在中间中断。

* * *

此处提供了有关此问题的一些最新评论：

> [https://stackoverflow.com/a/529197/3043](https://stackoverflow.com/a/529197/3043)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-22T14:26:44.857

在幕后，匿名委托变成了一个实际的方法，所以如果编译器没有选择内联函数，你可能会在第二个选择中产生一些开销。此外，匿名委托示例的主体引用的任何局部变量本质上都会发生变化，因为编译器技巧会隐藏它被编译为新方法的事实。有关 C# 如何做到这一点的更多信息：

[http://blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-04-25T10:50:04.600

ForEach 函数是泛型类 List 的成员。

我创建了以下扩展来重现内部代码：

```
public static class MyExtension<T>
    {
        public static void MyForEach(this IEnumerable<T> collection, Action<T> action)
        {
            foreach (T item in collection)
                action.Invoke(item);
        }
    } 
```

所以最后我们使用了一个普通的 foreach （或者如果你想要一个循环）。

另一方面，使用委托函数只是定义函数的另一种方式，这段代码：

```
delegate(string s) {
    <process the string>
} 
```

相当于：

```
private static void myFunction(string s, <other variables...>)
{
   <process the string>
} 
```

或使用 labda 表达式：

```
(s) => <process the string> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-03-31T06:49:57.220

整个 ForEach 作用域（委托函数）被视为一行代码（调用函数），您不能设置断点或单步执行代码。如果发生未处理的异常，则标记整个块。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-22T14:25:43.580

您展示的第二种方法使用扩展方法为列表中的每个元素执行委托方法。

这样，您就有了另一个委托 (=method) 调用。

此外，还可以使用*for*循环来迭代列表。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-22T14:35:55.543

需要注意的一件事是如何退出 Generic .ForEach 方法 - 请参阅[此讨论](http://silverlight.net/forums/t/32450.aspx)。虽然链接似乎说这种方式是最快的。不知道为什么 - 你会认为一旦编译它们就会等价......

# sql-server - SQL Server 2005 数据文件不一致（可能是8个数据文件，也可能是5个，谁知道呢）

> ID：225946
> 
> 赞同：0
> 
> 时间：2008-10-22T14:20:15.947
> 
> 标签：sql-server, database, sql-server-2005, file

我有一个 SQL Server 2005 sp2 框，其中 tempdb 有 8 个数据文件或 5 个数据文件，具体取决于您查看的位置。DBCC showfilestates 和 sys.database_files（均在 tempdb 中查询）显示 8 个数据文件（tempdev - tempdev8），但是当我查询 sys.master_files（在 master db 中，这也是 GUI 使用的）时，我只看到 5 个（tempdev， tempdev5 - tempdev8)。我无法添加 tempdev2 - tempdev4，因为我收到一个错误，指出它已经存在，并且我无法很快重新启动 SQL Server 以重新创建 tempdb。

任何人都知道：1.）这怎么会发生？2.）更重要的是，我该如何纠正它？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T04:55:46.980

一个视图可能显示过时的信息。一种情况是这些文件已从 tempdb 中删除，但 SQL Server 尚未重新启动以从某些系统目录中删除这些文件我们的条目。在旧的真正消失之前，您不能添加新的。您对 tempdb 所做的任何破坏性操作（移动、删除文件等）通常都需要重新启动 SQL Server。

我的猜测是它们显示了系统的两种不同状态，并且会在实例重新启动时协调其中一种状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T14:42:43.083

如果您在适当的目录中查看磁盘，您会看到多少个文件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T21:01:43.063

我要问的第一个问题是，你为什么要搞乱 tempdb？您是否因为 tempdb 而遇到瓶颈？

# c# - C# 颜色常数 R,G,B 值

> ID：225953
> 
> 赞同：7
> 
> 时间：2008-10-22T14:22:48.970
> 
> 标签：c#, colors, rgb, system.drawing.color

在哪里可以找到所有 C# 颜色常量和相关 R、G、B（红、绿、蓝）值的列表？

例如

颜色.白色 == (255,255,255)

颜色.黑色 == (0,0,0)

ETC...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-22T14:26:55.420

运行这个程序：

```
using System;
using System.Drawing;
using System.Reflection;

public class Test
{
    static void Main()
    {
        var props = typeof(Color).GetProperties(BindingFlags.Public | BindingFlags.Static);
        foreach (PropertyInfo prop in props)
        {
            Color color = (Color) prop.GetValue(null, null);
            Console.WriteLine("Color.{0} = ({1}, {2}, {3})", prop.Name,
                              color.R, color.G, color.B);
        }
    }
} 
```

或者：

```
using System;
using System.Drawing;

public class Test
{
    static void Main()
    {
        foreach (KnownColor known in Enum.GetValues(typeof(KnownColor)))
        {
            Color color = Color.FromKnownColor(known);
            Console.WriteLine("Color.{0} = ({1}, {2}, {3})", known,
                              color.R, color.G, color.B);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-22T14:26:19.133

看起来此[页面](http://www.flounder.com/csharp_color_table.htm)包含所有这些。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T18:52:12.250

[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.drawing.color.aspx)

[通过 MSDN 按名称/十六进制着色](http://msdn.microsoft.com/en-us/library/aa358802.aspx)

# css - 如何水平对齐 span 或 div？

> ID：225956
> 
> 赞同：88
> 
> 时间：2008-10-22T14:24:49.403
> 
> 标签：css, html

我唯一的问题是让它们三个交叉排列并具有相等的间距。显然，span 不能有宽度，并且 div（以及带有 display:block 的 span）不会水平相邻出现。建议？

`<div style='width:30%; text-align:center; float:left; clear:both;'>`是我现在所拥有的。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-22T14:28:22.203

您可以将 div 与`float: left;`属性一起使用，这将使它们彼此水平显示，但是您可能需要对以下元素使用清除以确保它们不重叠。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-10-22T14:37:51.920

您可以使用

```
.floatybox {
     display: inline-block;
     width: 123px;
} 
```

如果您只需要支持支持内联块的浏览器。内联块可以有宽度，但是是内联的，就像按钮元素一样。

哦，您可能需要在元素上添加 vertical-align: top 以确保对齐

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-22T15:20:22.737

### 我的答案：

```
<style>
 #whatever div {
  display: inline;
  margin: 0 1em 0 1em;
  width: 30%;
}
</style>

<div id="whatever">
 <div>content</div>
 <div>content</div>
 <div>content</div>
</div> 
```

### 为什么？

从技术上讲，Span 是一个内联元素，但是它可以有宽度，您只需先将其 display 属性设置为 block。但是，在这种情况下，一个 div 可能更合适，因为我猜你想用内容填充这些 div。

您绝对不想做的一件事是`clear:both`在 div 上设置。像这样设置它意味着浏览器将不允许任何元素与它们位于同一行。结果，你的元素会堆积起来。

注意，使用`display:inline`. 这处理 ie6 边距加倍错误。如有必要，您可以通过其他方式解决此问题，例如条件样式表。

我添加了一个包装器（#whatever），因为我猜这些不会是页面上唯一的元素，因此您几乎肯定需要将它们与其他页面元素隔离开来。

无论如何，我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-22T14:35:02.377

你可以做：

```
<div style="float: left;"></div> 
```

或者

```
<div style="display: inline;"></div> 
```

任何一个都会导致 div 水平平铺。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-22T15:44:53.453

我会这样做，因为它为您提供 3 个均匀大小的列、均匀的间距和（甚至）比例。**注意：**这未经测试，因此可能需要针对较旧的浏览器进行调整。

```
<style>
html, body {
    margin: 0;
    padding: 0;
}

.content {
    float: left;
    width: 30%;
    border:none;
}

.rightcontent {
    float: right;
    width: 30%;
    border:none
}

.hspacer {
    width:5%;
    float:left;
}

.clear {
    clear:both;
}
</style>

<div class="content">content</div>
<div class="hspacer">&nbsp;</div>
<div class="content">content</div>
<div class="hspacer">&nbsp;</div>
<div class="rightcontent">content</div>
<div class="clear"></div> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-10-26T13:00:23.237

我会使用：

```
<style>
.all {
display: table;
}
.maincontent {
float: left;
width: 60%; 
}
.sidebox { 
float: right;
width: 30%; 
}
<div class="all">
   <div class="maincontent">
       MainContent
   </div>
   <div class="sidebox"> 
       SideboxContent
   </div>
</div> 
```

这是我第一次从溢出中使用这个“代码工具”......但现在应该这样做......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T14:34:55.997

您可能想做的是查找基于 CSS 网格的布局。此布局方法涉及指定一些 CSS 类以将页面内容与网格结构对齐。它与基于打印的布局比基于 Web 的布局更密切相关，但它是许多网站上使用的一种技术，用于将内容布局到结构中，而无需求助于表格。

[从Smashing](http://www.smashingmagazine.com/2007/04/14/designing-with-grid-based-approach/) Magazine开始尝试这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-22T14:28:32.920

查看 css Float 属性。 [http://w3schools.com/css/pr_class_float.asp](http://w3schools.com/css/pr_class_float.asp)

它适用于像 div 这样的块元素。或者，你想显示什么，如果你真的想显示一些信息的表格，表格并不邪恶。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T15:18:10.450

我会尝试给他们所有`display: block;`属性并使用`float: left;`.

然后你可以设置`width`和/或`height`你喜欢。您甚至可以指定一些垂直对齐规则。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-26T13:11:16.353

```
 <!-- CSS -->
<style rel="stylesheet" type="text/css">
.all { display: table; }
.menu { float: left; width: 30%; }
.content { margin-left: 35%; }
</style>

<!-- HTML -->
<div class="all">
<div class="menu">Menu</div>
<div class="content">Content</div>
</div> 
```

另一个...尝试使用`float: left;`or `right;`，更改`width`其他值...它应该可以工作...还请注意，div 之间没有使用的 10%...抱歉英语不好:)

# php - 如何将数据插入两个不同的表？

> ID：225965
> 
> 赞同：1
> 
> 时间：2008-10-22T14:26:41.973
> 
> 标签：php, mysql

我有一个表格，其中包含用户详细信息和他们上传的图像。我想将数据写入用户表和图像表，但我很确定它不能只用两个单独的插入语句来完成。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T14:30:17.987

您需要先插入用户，然后执行“SELECT LAST_INSERT_ID()”来检索用户的 ID。然后您可以使用新创建的用户 ID 将图像插入图像表中。在 PHP 中，您实际上可以使用[mysql_insert_id()](http://no.php.net/mysql_insert_id)来检索新 id。如果您将 mysql 与 InnoDB 一起使用，您还可以通过发出 BEGIN，然后是 INSERT，如果所有内容都成功添加，然后是 COMMIT，或者失败时 ROLLBACK，将插入包装在[事务中。](http://dev.mysql.com/doc/refman/5.0/en/ansi-diff-transactions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T14:31:59.357

为什么你很确定它不能完成？你试过了吗？您插入用户表，然后插入图像表......完全没有问题。

唯一的警告是您应该将插入包装在事务中，以便它们充当单个插入并一起成功/失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T06:11:25.840

```
$rec = mysql_query("insert into userdet values("$id","$username",....)");
if($rec)
  mysql_query("insert into imag values("$id","$imgname",...)"); 
```

# c# - 如何在 DataGridViewCell 中托管控件以进行显示和编辑？

> ID：225972
> 
> 赞同：2
> 
> 时间：2008-10-22T14:27:57.867
> 
> 标签：c#, .net, datagridview, user-interface

我已经看到[How to: Host Controls in Windows Forms DataGridView Cells](http://msdn.microsoft.com/en-us/library/7tas5c80.aspx)，它解释了如何在 DataGridView 中托管用于编辑单元格的控件。但是我怎样才能拥有一个显示单元格的控件呢？

我需要在同一个单元格中显示一个文件名和一个按钮。我们的 UI 设计师是图形设计师而不是程序员，所以我必须将代码与他所绘制的内容相匹配，无论这是否可能 - 或明智 - 与否。我们正在使用 VS2008 并用 C# 编写 .NET 3.5，如果这有所作为的话。

更新： 'net 建议创建一个自定义 DataGridViewCell 作为第一步托管面板；有人这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T06:21:26.170

根据您的“更新”，创建自定义`DataGridViewCell`是完成此操作的方式。我已经完成了，它不需要对 MSDN 提供的示例代码进行太多修改。就我而言，我需要一堆自定义编辑控件，所以我最终继承自`DataGridViewTextBoxCell`and `DataGridViewColumn`。我在我的类（继承自的类）中插入了`DataGridViewTextBoxCell`一个新的自定义控件，该控件已实现`IDataGridViewEditingControl`，并且一切正常。

我想在您的情况下，您可以编写一个`PanelDataGridViewCell`包含`MyPanelControl`从 Panel 继承并实现的控件的控件`IDataGridViewEditingControl`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T06:46:56.580

与其使用 datagridview，不如使用 TableLayoutPanel。创建具有标签、按钮和事件的控件，并用它们填充布局面板。可以这么说，你的控制变成了细胞。如果那是您想要的布局样式，那么让表格布局面板看起来像一个 datagridview 并不需要太多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-03T00:55:26.157

有两种方法可以做到这一点：

1）。将 DataGridViewCell 转换为存在的特定单元格类型。例如，将 DataGridViewTextBoxCell 转换为 DataGridViewComboBoxCell 类型。

2）。创建一个控件并将其添加到 DataGridView 的控件集合中，设置其位置和大小以适合要托管的单元格。

请参阅下面叶志新的示例代码，其中说明了这些技巧：

```
private void Form_Load(object sender, EventArgs e)
{
    DataTable dt = new DataTable();
    dt.Columns.Add("name");
    for (int j = 0; j < 10; j++)
    {
        dt.Rows.Add("");
    }
    this.dataGridView1.DataSource = dt;
    this.dataGridView1.Columns[0].Width = 200;

    /*
    * First method : Convert to an existed cell type such ComboBox cell,etc
    */

    DataGridViewComboBoxCell ComboBoxCell = new DataGridViewComboBoxCell();
    ComboBoxCell.Items.AddRange(new string[] { "aaa","bbb","ccc" });
    this.dataGridView1[0, 0] = ComboBoxCell;
    this.dataGridView1[0, 0].Value = "bbb";

    DataGridViewTextBoxCell TextBoxCell = new DataGridViewTextBoxCell();
    this.dataGridView1[0, 1] = TextBoxCell;
    this.dataGridView1[0, 1].Value = "some text";

    DataGridViewCheckBoxCell CheckBoxCell = new DataGridViewCheckBoxCell();
    CheckBoxCell.Style.Alignment = DataGridViewContentAlignment.MiddleCenter;
    this.dataGridView1[0, 2] = CheckBoxCell;
    this.dataGridView1[0, 2].Value = true;

    /*
    * Second method : Add control to the host in the cell
    */
    DateTimePicker dtp = new DateTimePicker();
    dtp.Value = DateTime.Now.AddDays(-10);
    //add DateTimePicker into the control collection of the DataGridView
    this.dataGridView1.Controls.Add(dtp);
    //set its location and size to fit the cell
    dtp.Location = this.dataGridView1.GetCellDisplayRectangle(0, 3,true).Location;
    dtp.Size = this.dataGridView1.GetCellDisplayRectangle(0, 3,true).Size;
} 
```

[MSDN 参考：如何在 DataGridView 控件的同一列中托管不同的控件](http://social.msdn.microsoft.com/forums/en-US/winformsdesigner/thread/63ddb457-f769-44db-87cc-9e88e74929e8/)

使用第一种方法如下所示：

![DataGridView 列中的不同控件](https://i.stack.imgur.com/x9Eco.png)

使用第二种方法如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/DxuoK.png)

附加信息：[初始化网格时，同一 DataGridView 列中的控件不呈现](https://stackoverflow.com/questions/15238322/controls-in-the-same-datagridview-column-dont-render-while-initializing-grid)

# ruby-on-rails - 在 Ruby on Rails 中的一页上多次重用部分

> ID：225984
> 
> 赞同：2
> 
> 时间：2008-10-22T14:30:04.133
> 
> 标签：ruby-on-rails, ruby

我有一个使用以下方法呈现选择框的部分：

```
<%= collection_select 'type', 'id', @types, "id", "name", 
  {:prompt => true}, 
  {:onchange => 
              remote_function(
              :loading => "Form.Element.disable('go_button')",
              :url => '/sfc/criteria/services', 
              :with => "'type_id=' + encodeURIComponent(value) + '&use_wizard=#{use_wizard}'"),
    :class => "hosp_select_buttons"
} %> 
```

这个部分在每个页面上被使用了 2 次，但有一次我需要获取第一个选择框的值。使用：

```
$('type_id') 
```

返回第二个选择框。有没有办法轻松找到第一个？我应该使用 javascript 还是通过重做我的部分来解决这个问题？

注意：下拉菜单会以单独的形式呈现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:13:37.963

我想出了一种方法，方法是在 html_options 块中分配一个 ID。我已经为 use_wizard 传递了一个值，因此我可以将该值附加到 ID 以区分两个下拉列表。

```
:id => "type_id_wizard_#{use_wizard}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:54:57.270

是的，每个元素都需要一个唯一的 ID，页面也可能无法通过 HTML 验证。此外，除非它们采用 2 种不同的形式，否则您将与 CGI 参数名称发生冲突。

如果它们采用 2 种不同的形式，您可能只需设置 :id 就可以了，如果它们是相同的形式，您也需要抽象参数名称：

collection_select 'type', "id_wizard_#{use_wizard}"...

# database - 数据库表中的键值是否应该被散列？

> ID：225985
> 
> 赞同：2
> 
> 时间：2008-10-22T14:30:15.647
> 
> 标签：database, database-design, hash, key

假设一个数据库表有一个列“名称”，它被定义为表的键。通常的名称值为“Bill”、“Elizabeth”、“Bob”、“Alice”。表上的查找也将通过名称键完成。

散列值是否以任何方式优化操作？即输入每个名称作为名称的一些散列值（假设 MD5 - 32 位）。

如果是这样 - 这不应该是数据库的一个功能，而不是客户端处理的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T14:31:21.590

假设您的数据库为主键生成索引（我无法想象它不会），它正在为您执行此操作。所以是的，它绝对应该是数据库处理的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:34:43.377

“散列值是否以任何方式优化操作？” 不是真的。

哈希是单向的。您无法进行表扫描并重建原始名称。

如果您想同时保留名称和名称哈希，那么您通过包含派生数据违反了基本规则。现在名称更新需要哈希更新。

散列会发生的“均匀分布我的值”是索引的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T14:35:46.510

不，不要散列它们。您的数据库将根据数据建立索引，而散列将无济于事。唯一*可能*有帮助的是您的键值比散列长得多。

# sql-server - 导入新的数据库表

> ID：225993
> 
> 赞同：1
> 
> 时间：2008-10-22T14:31:15.740
> 
> 标签：sql-server, database, performance, indexing, import

我所在的地方有一个运行在大型 AIX 大型机上的主系统。为了方便报告和操作，每晚都会从大型机转储到 SQL Server，这样我们的 50 多个客户端中的每一个都在具有相同架构的自己的数据库中。这个转储每晚大约需要 7 个小时才能完成，而且我们真的无能为力：我们被应用程序供应商提供的东西所困扰。

转储到 sql server 后，我们使用它来运行许多其他日常程序。其中一个过程是将数据导入一种管理报告沙箱表，该表将来自不同数据库的一个特别重要的表中的记录组合到一个表中，不了解 sql 的管理人员可以使用该表来运行临时报告无需冲洗系统的其余部分。这又是一个商业问题：经理们想要它，他们有权看到我们实施它。

此表的导入过程本身需要几个小时。它将分布在 50 个数据库中的大约 4000 万条记录过滤成大约 400 万条记录，然后在某些列上对它们进行索引以进行搜索。即使在几个小时内，它仍然不到初始负载的三分之一，但是我们已经没有时间进行夜间处理了，我们无法控制大型机转储，我们可以控制它。所以我的任务是寻找改进现有程序的方法。

目前，理念是从每个客户端数据库加载所有数据，然后一步索引它会更快。此外，为了避免在运行时间过长时使其他重要系统陷入困境，一些较大的客户端被设置为始终首先运行（表上的主索引由 clientid 字段组成）。我们开始做的另一件事是一次从几个客户端并行加载数据，而不是顺序加载每个客户端。

所以我的问题是，加载此表的最有效方法是什么？我们是否认为稍后索引更好？还是我们应该在导入数据之前创建索引？我们是否应该按索引顺序加载表，以避免大量重新排序页面，而不是首先加载大客户？并行加载是否会因为一次导致大量磁盘访问或消除我们控制顺序的能力而使事情变得更糟？还有其他想法吗？

**更新**
嗯，有事。白天我可以做一些基准测试，无论是在操作开始时创建索引还是在操作结束时创建索引，加载时间都没有区别，但是我们节省了构建索引本身的时间（它的课程几乎立即构建，表中没有数据）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T19:43:16.297

索引在最后，是的。还可以考虑将日志级别设置设置为 BULK LOGGED 以尽量减少对事务日志的写入。请记住在完成后将其设置回 FULL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T14:37:04.837

我已经在 SQL Server 中加载了大量数据集，并在插入时对索引进行了一些性能测试，然后再添加它。我发现 BY FAR 在加载所有数据后创建索引效率更高。在我们的例子中，加载最后添加的索引需要 1 小时，而在索引仍然打开的情况下添加它需要 4 小时。

我认为关键是尽可能快地移动数据，我不确定按顺序加载它是否真的有帮助，你有关于加载时间与索引时间的统计数据吗？如果你这样做了，你可以开始在这方面进行一些实验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T15:18:47.967

加载删除索引会更好，因为实时索引将为数据库中的每一行生成多个 I/O。400 万行足够小，您不会期望从表分区中获得显着的好处。

通过使用 bcp 将数据加载到暂存区域并并行运行多个任务（SSIS 将执行此操作），您可以获得性能优势。为 bcp 编写一个通用批处理文件包装器，该包装器采用文件路径（必要时还包括表名），并在 SSIS 中使用“执行进程”任务在六个线程中调用一系列作业。对于 50 个作业，可能不值得尝试编写数据驱动的负载控制器进程。将这些任务包装在一个序列容器中，这样您就不必显式维护所有依赖项。

您绝对应该删除并重新创建索引，因为这将大大减少该过程中的 I/O 量。

如果 50 个源的处理方式相同，请尝试将它们加载到公用表中或在临时表上构建分区视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:33:48.760

据我所知，您是正确的 - 最好一次添加所有记录，然后在最后索引一次。********