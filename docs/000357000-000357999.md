# StackOverflow 问答 000357000-000357999

# eclipse - Eclipse 中的 FTP 部署

> ID：357007
> 
> 赞同：2
> 
> 时间：2008-12-10T18:03:02.263
> 
> 标签：eclipse, deployment, ftp, eclipse-plugin

除了 DeployerFTP 之外，是否有任何插件可以将项目部署到 FTP 位置？我希望有一种方法可以在单个文件的基础上执行此操作，甚至可能将 FTP 信息存储在每个项目中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T18:18:58.487

蚂蚁：http : [//ant.apache.org/manual/Tasks/ftp.html](http://ant.apache.org/manual/Tasks/ftp.html)

Maven：[http ://maven.apache.org/wagon/wagon-providers/wagon-ftp/](http://maven.apache.org/wagon/wagon-providers/wagon-ftp/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T21:04:59.950

Eclipse 工具的[Aptana Studio](http://www.aptana.com/studio)套件内置了 FTP。您必须购买完整版才能通过 SFTP 等其他方法进行同步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T01:20:47.773

您可能想查看 Eclipse Remote System Explorer 工具。项目网站[http://www.eclipse.org/dsdp/tm/上有一些屏幕截图](http://www.eclipse.org/dsdp/tm/)

编辑：

该网站现在是[http://www.eclipse.org/tm/](http://www.eclipse.org/tm/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-05T16:41:24.943

由于我发现没有其他解决方案令我满意，因此我编写了自己的脚本，该脚本使用 WinSCP 将项目文件夹中的本地文件夹同步到远程文件夹。也许这就是你要找的东西，虽然这只适用于 Windows： [http ://rays-blog.de/2012/05/05/94/use-winscp-to-upload-files-using-eclipses-autobuild -特征/](http://rays-blog.de/2012/05/05/94/use-winscp-to-upload-files-using-eclipses-autobuild-feature/)

# sharepoint - 如何升级已投入生产的长期运行的 SharePoint 工作流

> ID：357032
> 
> 赞同：17
> 
> 时间：2008-12-10T18:13:06.487
> 
> 标签：sharepoint

我的任务是帮助部署以前 SharePoint 部署的第 2 阶段。

原始部署具有已在第 2 阶段更新的自定义工作流。
**是否有针对这种情况的“操作方法”？**

我们看到的一些缺陷要求您将原始工作流标记为不接受任何新实例，然后将其更新部署为新工作流。这将允许以前的项目在旧代码下完成处理，并允许任何新流程启动新的工作流程。

这样做的一个问题是，我们必须访问附加原始工作流的每个站点并附加新的工作流V2。现在我们在文档库中有两个工作流状态列。

我刚刚进入项目，这些是开发人员注意到的问题。

**您可以向我提供的任何资源或提示将不胜感激，因为我正在学习所有这些内容。**

以下是另一位开发人员的一些笔记，他向我介绍了他所见的背景：

> 如果工作流的某个版本已经存在，那么将其重新部署为功能将导致现有工作流的状态设置为“无新实例”。这可以通过转到已附加工作流的文档库来查看，选择设置 -> 文档库设置 -> 工作流设置 -> 删除工作流并注意工作流的单选按钮设置。任何当前正在工作的工作流实例仍将正常完成，但此设置将阻止工作流的任何新实例。
> 
> 部署同一工作流程的第二个“版本”后，您需要重新访问您希望与其关联的每个文档库并重新添加它，就好像它是一个新的工作流程一样。您必须给它一个唯一的名称，例如“MyWorkflow_v2”。另一个副作用是现在您将在文档库中拥有 2 个工作流状态列。一旦它的所有实例都完成并且不再需要状态，您可以删除/隐藏第一个。
> 
> 如果您使用相同的功能和清单 XML 文件重新部署工作流，则内部 GUID 将与第一次部署中使用的相同。SharePoint 会将其识别为同一工作流的第二个“版本”，并自动将第一个版本设置为“无新实例”状态。但是，如果您选择在 XML 文件中使用不同的 GUID，SharePoint 会将其视为全新工作流的部署，并且不会对现有实例执行任何操作。您需要手动将每个文档库中的每个实例设置为“无新实例”设置。
> 
> 在重新部署工作流的第二个“版本”后，您仍然需要手动访问您希望使用它的每个文档库并将其添加到文档库中。请记住，它的工作流模板名称将出现在工作流模板列表中，就像它在 XML 文件中的名称一样（这没关系），但是一旦添加它，您将需要为工作流输入一个唯一的工作流名称。这就是您必须选择像“Workflow_v2”这样的新名称的地方。
> 
> 撤回操作会删除解决方案中的所有功能实例，特别是对于我的工作流应用程序，它会从与之关联的所有文档库中删除工作流的所有实例。然而，在*，其中任务由工作流创建，一旦解决方案被撤回，如果用户单击期望获得签名页面的任务项，他们将改为获得 SharePoint“未知错误”页面。原因是撤回过程从数据库中删除了工作流，并且不再有与任务关联的工作流。*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-14T13:17:16.583

我想您已经阅读了 Chris O'brien 对此主题的评论。所以这是第二个链接： http: [//msmvps.com/blogs/theproblemsolver/archive/2008/09/10/versioning-long-running-workfows.aspx](http://msmvps.com/blogs/theproblemsolver/archive/2008/09/10/versioning-long-running-workfows.aspx)

# c# - C# 数据绑定不更新 WPF

> ID：357033
> 
> 赞同：4
> 
> 时间：2008-12-10T18:13:33.960
> 
> 标签：c#, .net, data-binding, xaml, code-behind

我正在尝试在后面的 C# 代码而不是 XAML 中进行数据绑定。在 Expression Blend 2 中创建的 XAML 绑定到我的 CLR 对象工作正常。我的 C# 实现仅在应用程序启动时更新，之后对 CLR 的后续更改不会更新我的标签内容。

这是有效的 XAML 绑定。首先在我的 Window.Resources 中创建了一个 ObjectDataProvider。

```
<ObjectDataProvider x:Key="PhoneServiceDS" 
    ObjectType="{x:Type kudu:PhoneService}" d:IsDataSource="True"/> 
```

和标签内容绑定：

```
<Label x:Name="DisplayName" Content="{Binding 
    Path=MyAccountService.Accounts[0].DisplayName, Mode=OneWay, 
    Source={StaticResource PhoneServiceDS}}"/> 
```

效果很好。但我们希望在 C# 中进行此设置，以便我们可以独立更改 XAML（即新皮肤）。我的一次工作 C# 如下：

```
 Binding displayNameBinding = new Binding();
     displayNameBinding.Source = 
         PhoneService.MyAccountService.Accounts[0].DisplayName;
     displayNameBinding.Mode = BindingMode.OneWay;
     this.DisplayName.SetBinding(Label.ContentProperty, displayNameBinding); 
```

这是在 InitializeComponent(); 之后的我的 MainWindow 内。

任何见解为什么这只适用于启动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T18:58:55.723

您的 C# 版本与 XAML 版本不匹配。应该可以编写标记的代码版本，尽管我不熟悉 ObjectDataProvider。

尝试这样的事情：

```
Binding displayNameBinding = new Binding( "MyAccountService.Accounts[0].DisplayName" );
displayNameBinding.Source = new ObjectDataProvider { ObjectType = typeof(PhoneService), IsDataSource = true };
displayNameBinding.Mode = BindingMode.OneWay;
this.DisplayName.SetBinding(Label.ContentProperty, displayNameBinding); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T06:44:35.977

在原始代码中，您混淆了源代码和路径。

```
 Binding displayNameBinding = new Binding();
     displayNameBinding.Source = PhoneService;
     displayNameBinding.Path = "MyAccountService.Accounts[0].DisplayName";
     displayNameBinding.Mode = BindingMode.OneWay;
     this.DisplayName.SetBinding(Label.ContentProperty, displayNameBinding); 
```

（我假设 PhoneService 是一个对象实例，否则可能 PhoneService.MyAccountService.Accounts[0] 应该是 Source？）

从内存中，您可以将路径作为参数传递给构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T18:20:39.623

将其写入 Loaded 事件而不是构造函数中。希望您实现了在 DisplayName 属性设置器上触发的 INotifyPropertyChanged？

# c# - 封装 LINQ 选择语句

> ID：357041
> 
> 赞同：2
> 
> 时间：2008-12-10T18:18:36.163
> 
> 标签：c#, linq, linq-to-sql

我有如下所示的 LINQ 语句：

```
return ( from c in customers select new ClientEntity() { Name = c.Name, ... }); 
```

我希望能够将选择抽象为自己的方法，以便我可以有不同的“映射”选项。我的方法需要返回什么？

本质上，我希望我的 LINQ 查询看起来像这样：

```
return ( from c in customers select new Mapper(c)); 
```

**编辑：**

这是针对 LINQ to SQL 的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T20:05:43.577

新答案现在我注意到它是 Linq to SQL ...... :)

如果您查看适用于`IQueryable<T>`它的 Select 版本，则不需要`Func<In, Out>`. 相反，它需要一个`Expression<Func<In, Out>>`. 编译器知道如何从 lambda 生成这样的东西，这就是正常代码编译的原因。

因此，要通过将各种选择映射函数传递给 Select 来准备好使用它们，您可以像这样声明它们：

```
private static readonly Expression<Func<CustomerInfo, string>> GetName = c => c.Name;

private static readonly Expression<Func<CustomerInfo, ClientEntity>> GetEntity = c => new ClientEntity { Name = c.Name, ... }; 
```

然后你会像这样使用它们：

```
var names = customers.Select(GetName);

var entities = customers.Select(GetEntity); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T18:36:59.263

您可能必须使用链式方法而不是使用 LINQ 语法，然后您将能够传入您指定的各种值中的任何一个：[`Expression`](http://msdn.microsoft.com/en-us/library/bb335710.aspx)`<`[`Func<TSource, TResult>`](http://msdn.microsoft.com/en-us/library/bb549151.aspx)`>`

```
Expression<Func<CustomerTable, Customer>> someMappingExpression = c => new Customer { Name = c.Name };
return context.CustomerTable.Select(someMappingExpression); 
```

~~**UPDATE：** [`Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)需要一个`Func`，而不是一个`Expression`~~
**UPDATE：**[`Select`](http://msdn.microsoft.com/en-us/library/bb548743.aspx)应该使用的*函数确实*需要一个`Expression<Func>`，而不仅仅是一个`Func`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T18:23:01.850

这是针对对象的 linq 吗？或者对于一个 linq to ？

因为... select new Mapper(c)，要求'c'已经物化为一个对象，然后传递给Mapper() CTor。（因为“c”在 db 级别未知，仅在 .NET 级别）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T03:17:52.617

BTW: The solutions described here will work only if you want to use the 'factored' part of the code in a separate query clause (e.g. Select). If you'd like to use it as part of a clause that also does some other thing (perhaps return anonymous type with some other information), you'll need to construct the whole expression tree dynamically using **Expression.Xyz** methods.

Alternatively you could use the trick for embedding lambda expressions that I described here:

*   [http://tomasp.net/blog/dynamic-linq-queries.aspx](http://tomasp.net/blog/dynamic-linq-queries.aspx)

# sharepoint - 在 Sharepoint 中存储功能配置

> ID：357046
> 
> 赞同：4
> 
> 时间：2008-12-10T18:20:57.297
> 
> 标签：sharepoint

我有一个 Sharepoint 功能，它本质上使用列表接收器扩展了具有新功能的列表。对于附加功能的每个列表，我需要存储一些配置。

现在，我想到的第一件事是显而易见的解决方案：拥有一个全局列表。这当然可行，但我想知道是否有某种方法可以将特定于功能的配置存储在隐藏的地方？并不是说它是敏感信息，但我不想用太多列表使用户显示混乱。我相信我可以隐藏列表，但同时我想知道 sharepoint 是否允许我使用它的数据库？

我不是在谈论仅使用 ADO.net 直接访问数据库（这对 Sharepoint 来说是一个很大的禁忌），我正在考虑一些官方支持的机制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T18:29:26.237

SPList 与其他对象不同，没有属性包，但是 SharePoint 网站中的所有列表都有一个相关的 SPFolder 对象存储在 RootFolder 中，而 SPFolder 对象有一个属性包，您可以在其中存储列表的自定义配置数据。

编辑：如果您有兴趣，我写了一篇文章，展示[了如何使用 SPFolder](http://furuknap.blogspot.com/2009/01/consuming-rss-or-atom-feed-in.html)存储自定义列表数据。

.b

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T18:34:18.237

你应该看看[Sharepoint Config Store](http://www.codeplex.com/SPConfigStore)。它是由[Chris O'Brien](http://www.sharepointnutsandbolts.com/)制作的。

使用 SPConfigStore，您可以通过这种方式检索配置项

```
string sAdminEmail = ConfigStore.GetValue("MyApplication", "AdminEmail"); 
```

# database - 一对多关系中的标识符

> ID：357048
> 
> 赞同：1
> 
> 时间：2008-12-10T18:21:04.397
> 
> 标签：database, oracle, database-design, ddl

我有两个表，我们将它们称为`Foo`和`Bar`，具有一对多的关系，其中`Foo`的父级是`Bar`。Foo 的主键是一个随序列自动生成的整数。

因为`Bar`完全取决于`Foo`我将如何设置`Bar`给定以下约束的主键：

*   Bar 的记录是以编程方式生成的，因此不能依赖用户输入作为标识符。
*   多个进程正在生成 Bar 记录，因此任何涉及 a `Select Max()`来生成 an`ID`都会呈现竞争条件。

我提出了两种我不满意的可能解决方案：

*   将这些表视为与第三个表的多对多关系，第三个表将它们的记录映射在一起，并让应用程序代码处理插入记录，以便正确创建记录之间的映射。我不喜欢这样，因为它会使数据库设计产生误导，并且应用程序代码中的错误可能会导致无效数据。
*   给 Bar 两个列：`FooID`and 并通过选择 for some`FooBarID`生成一个值 ，但如前所述，这会产生竞争条件。`FooBarID``max(FooBarID)+1``FooID`

我很欣赏任何关于替代表格布局的想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T18:28:14.023

给 Bar 一个与 Foo 相同的自动主键。将外键 FooID 列添加到 Bar。

除非我遗漏了什么，否则似乎没有理由让它不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T18:36:30.027

除非我在您的描述中遗漏了某些内容，否则这听起来很普通。通常的解决方案是这样的：

```
INSERT INTO Foo (foo_id, othercolumn)
  VALUES ( FooSeq.NextVal(), 'yadda yadda');

INSERT INTO Bar (bar_id, foo_id, extracolumn)
  VALUES ( BarSeq.NextVal(), FooSeq.CurrVal(), 'blah blah');
INSERT INTO Bar (bar_id, foo_id, extracolumn)
  VALUES ( BarSeq.NextVal(), FooSeq.CurrVal(), 'bling bling');
INSERT INTO Bar (bar_id, foo_id, extracolumn)
  VALUES ( BarSeq.NextVal(), FooSeq.CurrVal(), 'baz baz'); 
```

序列的函数只返回*当前会话期间*`CURRVAL()`该序列生成的最新值。该序列的其他并发使用不会影响会话中返回的内容。*`CURRVAL()`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T18:33:09.537

根据您的描述，我假设您的数据库不支持自动增量标识符字段（MS SQL 支持，Oracle 有“序列”，即使不是更好，也一样好，我不记得 MySql 有）。

如果是这样，那么您只需要一个自增的 FooId 和一个自增的 BarId，而 Bar 也有一个 FooId 作为外键

如果没有，那么您可以创建一个单行表进行分配，如下所示：

```
create table SystemCounter 
( 
    SystemCounterId int identity not null, 
    BarIdAllocator int 
)
--initialize SystemCounter to have one record with SystemCounterId = 1
--and BarIdAllocator = 0
insert into SystemCounter values (1,0)
--id allocator procedure
create procedure GetNextBarId ( @BarId int output ) AS
    SET NOCOUNT ON
    begin tran
        update SystemCounter set 
            @BarId = BarIdAllocator = BarIdAllocator + 1
        where SystemCounterId = 1
    commit
GO 
```

请注意，如果您的数据库不支持该语法

```
@BarId = BarIdAllocator = BarIdAllocator + 1 
```

那么你需要这样做

```
begin tran
    update SystemCounter set 
        BarIdAllocator = BarIdAllocator + 1
    where SystemCounterId = 1
    select 
        @BarId = BarIdAllocator
    from SystemCounter
    where SystemCounterId = 1
commit 
```

编辑：我最初错过了 Oracle 标签，所以 Bill 的解决方案就是必要的。如果有人使用不支持身份或序列构造的数据库，我将把这个答案作为一个例子来说明如何做到这一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T18:43:42.510

根据 Ant P 和其他答案，我也不太明白为什么只为 bar 生成唯一 ID 并将 Foo 的 ID 放入其中是行不通的。但是假设您处于自动递增 ID 不可用的情况，那么有两种解决方案不涉及选择 max(barid)+1

1.  预先生成唯一 ID 表并使用事务从表中提取下一个可用 ID 并将其删除（作为原子操作）。这可以正常工作，但缺点是您必须保持表格填充。

2.  生成一个 UUID 作为主键。这通常不是一个好的选择，因为 UUID 在此用途中效率低下，但它确实具有不需要额外基础结构表的优点。UUID 生成器广泛可用，一些数据库内置了它们。

# jquery - 使用jQuery验证表单后如何发送数据？

> ID：357049
> 
> 赞同：5
> 
> 时间：2008-12-10T18:21:12.790
> 
> 标签：jquery, ajax, validation, forms

我有一个简单的电子邮件地址注册表单，如下所示：

```
<form action="" id="newsletterform" method="get">
      <input type="text" name="email" class="required email" id="textnewsletter"  />
      <input type="submit" id="signup" />
</form> 
```

**这是我希望能够做到的：**

*   验证表单以查找用户单击提交或点击输入的空字符串或错误填写的电子邮件地址。
*   如果发生上述情况之一（空字符串等），我想生成一个错误让用户知道。
*   然后，一旦用户填写了正确格式的电子邮件地址并点击提交（或输入），我希望表单将电子邮件地址发送到我在 jQuery 代码中指定的任何位置，然后生成一点“感谢您注册通知”，所有无需重新加载浏览器。

我看了太多的教程，在这个阶段我的眼睛很痛，所以请不要指向任何网址（我很可能去过那里）。

如果有人可以提供该做什么的准系统大纲，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T18:31:35.560

首先，请确保您在服务器端进行所有验证。我喜欢让我的表单在没有任何 JavaScript 的情况下工作。我假设你已经做了那么多。

****原始答案***

然后，将您的“提交”元素更改为按钮元素。在按钮元素的 OnClick 上，运行验证的 JavaScript 函数。如您所知，有很多关于如何做到这一点的示例。

如果验证失败，请发送警报。如果成功，使用 JavaScript 提交表单。

****新，使用答案的工具***

您还可以将 JQuery 用作（orip 指出），它的插件可以做到这一点。他们处理了很多艰苦的工作。请确保我的评论讲述的是正确的故事。此代码还执行 AJAX 提交。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Load JQuery on your page -->
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <!-- Load JQuery validation sytles and (rules?) on your page -->
    <link rel="stylesheet" href="http://dev.jquery.com/view/trunk/plugins/validate/jquery.validate.css" type="text/css" media="screen" />
    <!-- Load JQuery validation plugin on your page -->
    <script type="text/javascript" src="http://dev.jquery.com/view/trunk/plugins/validate/jquery.validate.js"></script>
    <!-- Load JQuery form plugin on your page -->
    <script type="text/javascript" src="http://jqueryjs.googlecode.com/svn/trunk/plugins/form/jquery.form.js"></script>
  <script type="text/javascript" language="javascript">
    //Wait until the document is loaded, then call the validation.  Due to magic in JQuery or the plugin
    //  this only happens when the form is submitted.
  $(document).ready(function(){
        //When the submit button is clicked
        $("#signup").click(function() {
            //if the form is valid according to the fules
            if ($("#newsletterform").valid()) {
                //Submit the form via AJAX
                $('#newsletterform').ajaxForm(function() { 
                    //this alert lets me know the submission was successfull
                    alert("Thank you!"); }); 
                }
            })
  });
  </script>
    <!-- Just some styles -->
    <style type="text/css">
            * { font-family: Verdana; font-size: 96%; }
            label { width: 10em; float: left; }
            label.error { float: none; color: red; padding-left: .5em; vertical-align: top; }
            p { clear: both; }
            .submit { margin-left: 12em; }
            em { font-weight: bold; padding-right: 1em; vertical-align: top; }
    </style>  
</head>
<body>
    <form action="" id="newsletterform" method="get">
        <!-- The classes assigned here are where the validation rules come fome.  
        This is required, and it must be an email -->
        <input type="text" name="email" class="required email" id="textnewsletter"  />
        <input type="submit" id="signup" />
    </form>
</body>
</html> 
```

这不是您可以编写的最严格的代码，但它将作为示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T18:40:32.267

使用[jQuery 验证插件](http://docs.jquery.com/Plugins/Validation)。

有了它，您无需修改​​表单 - 只有在验证通过时才会提交。它可以为您节省大量时间和复杂性。

编辑：

为防止页面重新加载，请使用插件的“ `submitHandler`”选项提交自己：

```
$('#myform').validate({
   // ...
   submitHandler: function() { alert("submitted"); }
}); 
```

或使用[jQuery Form Plugin](http://www.malsup.com/jquery/form/)将您的表单提交转换为 AJAX 提交 - Validation 插件与之集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T17:16:39.610

感谢您的所有帮助。

我有一个可以按照我想要的方式完美运行的解决方案（不得不雇用某人:) - 任何人，对于其他需要它的人，你去：

```
$(document).ready(function () {
      $('#textnewsletter').click(function () 
      {
            if($('#textnewsletter').val()=='Your email address')
                  $(this).attr("value",'');
      });

      $('form#newslattersub').submit(function () 
      {
            if(!isEmail($('#textnewsletter').val() ))
            {
                  $('p.idmsg').html('<span class="error">Please enter a valid email             address</span>').hide().fadeIn("slow");

                }
                else{
                    $.post($('form#newslattersub').attr('action'), { email:$('#textnewsletter').val() },function(data){
                        $('p.idmsg').html('<span class="success">Thanks for signing up! Please check your email for confirmation!</span>').hide().fadeIn("slow");
                         //alert("server return " + data);
                    });

                }
                return false;

            });

        }); 
```

# c - C中的代码覆盖率

> ID：357051
> 
> 赞同：2
> 
> 时间：2008-12-10T18:21:38.467
> 
> 标签：c, unit-testing, code-coverage

我希望在 C 中进行代码覆盖。当我在不同的平台/编译器上工作时，我不能依赖像 gcov 这样的工具。

基本上，我正在寻找一种将代码覆盖率纳入我（自己的实现）单元测试框架的策略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T19:31:16.390

您是否有这么多特定于平台的代码，想要测量每个平台上的单元测试覆盖率？我的意思是，除非您有很多特定于平台的代码，否则您的单元测试覆盖率在所有目标上都应该是相似的，因此您可能不需要在您拥有的每个目标上测量它。将特定于平台的代码移动到特定于平台的模块可能会很有趣，这样公共代码的覆盖率就不会被特定代码降低。

您是在查看分支覆盖率还是功能覆盖率？如果是后者，您可以只使用 gcc 来检测您的代码，以便每个函数将其名称或地址输出到文件并编写脚本来聚合来自所有平台的结果。

抱歉只回答问题... HTH

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T12:01:03.727

如果您更新您的问题以描述您正在使用的平台和编译器，这将非常有帮助。

我使用的一种策略是在可以跟踪所有指令的模拟器上运行系统。然后可以使用此指令跟踪来计算代码覆盖率。

在 UNIX 上，您还可以使用 ptrace() 运行进程以单步执行应用程序，从而捕获执行的指令。

如果您只想要函数调用跟踪，您可以对过程链接表进行一些令人讨厌的黑客攻击以跳转到一些专门的日志记录代码，但这可能很疯狂。

同样，需要有关执行环境和详细程度的更多详细信息才能给出有用的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T03:33:32.363

一个[关于代码覆盖工具的页面](http://web.archive.org/web/20120628034928/http://www.codecoveragetools.com/index.php/coverage-process/code-coverage-tools-c.html)说，Brian Marick 称为 GCT 的东西通过源到源转换实现代码覆盖，因此您可以转换 C 代码，然后使用特定于平台的编译器构建它。我没有跟进细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T18:44:39.700

您可能会考虑构建一组测试用例作为应用程序本身的一部分，或者作为替代构建目标。然后应用程序可以测试自己，并获得访问所有“内部”的额外好处，而不是尝试使用黑盒技术测试所有分支。

# c# - 单元测试用例生成器

> ID：357059
> 
> 赞同：14
> 
> 时间：2008-12-10T18:24:40.520
> 
> 标签：c#, .net, unit-testing

有没有人尝试过任何用于 .Net 的单元测试生成器？

我认为虽然它不会替代编写功能的人编写的任何好的单元测试，但我认为它会带走一些工作并成为我们可以改进单元测试的起点。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-10T18:28:56.253

单元测试生成是执行单元测试的错误方法。进行单元测试的正确方法是在编写功能代码之前创建测试用例，然后开发代码直到测试通过，这被称为 TDD（测试驱动开发）。

单元测试生成是一个坏主意的关键原因之一是，如果现有代码中存在任何错误，则将针对这些错误生成测试，因此如果您将来修复它们，错误的测试将失败并且您当它实际上被修复时，我会假设它已经坏了。

但既然代码已经写好了，现在就变成了桥下的水。并且可能有错误的单元测试总比没有单元测试要好。我一直更喜欢 NUnit，这里有一个兼容 NUnit 的测试生成器[（](http://www.kellermansoftware.com/p-30-nunit-test-generator.aspx)非常实惠）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T18:30:50.430

你考虑过[Pex](http://research.microsoft.com/Pex/)吗？它来自微软研究院。

> Pex 自动为 .NET 程序生成具有高代码覆盖率的小型测试套件。为此，Pex 执行系统程序分析（使用动态符号执行，类似于路径有界模型检查）以确定参数化单元测试的测试输入。Pex 通过监视执行跟踪来了解程序行为。Pex 使用约束求解器生成新的测试输入，这些输入执行不同的程序行为。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-10T19:27:31.703

几年前，我修改了 Haskell 的[QuickCheck](http://www.haskell.org/haskellwiki/QuickCheck)，以允许使用生成式测试进行[纯功能测试驱动开发。](http://www.scannedinavian.com/~shae/qc-tdd.tgz)我的解决方案是保存生成失败测试用例的 PRNG 种子，并使用相同的种子运行未来的测试。

我最近得到了一份 .NET 工作，Google 发现 MbUnit[在2004 年](http://www.testingreflections.com/node/view/611)[确实](http://blog.dotnetwiki.org/RowBasedTestingInMbUnitIeRowFixture.aspx) 支持生成测试。我还发现了更新的[Gallio](http://code.google.com/p/mb-unit/wiki/GallioObjectModel)，但我在使用它时遇到了一些麻烦，我不记得具体是什么了。

所以，TDD 和生成测试并不是相互排斥的，Gallio 是我最近看到的唯一 .NET 选项，我不记得为什么我现在不使用它了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-31T20:35:55.360

我为 .Net 创建了一个单元测试生成器 ErrorUnit

使用生成器进行 TDD 开发当然是实用的；例如，在对单击按钮时发生的情况进行编码时，以 TDD 方式使用 ErrorUnit 的一种方法是：

1）先手动创建一个测试，保证有按键按下事件；然后根据纯 TDD 创建事件和测试。

2）然后运行程序，使用按钮导航到屏幕，并在事件方法中设置断点，按下按钮

3）当断点被击中时，您可以单击 ErrorUnit 的“添加单元测试”来生成一个单元测试，其中所有对象和当前数据库状态已经被模拟。（根据需要重复使用不同的用例状态）

4) 然后，您将更改创建的单元测试以使 Assert 与您希望单击按钮按照 TDD 执行的操作的结果相匹配。

5）然后编写点击事件背后的代码，并运行由ErrorUnit（用于Arrange和Act）和部分自定义（用于Assert）生成的测试。

通过这种方式，您可以节省大部分时间，这些时间将花费在键入 Arrange 和 Act 上。

ErrorUnit 还与错误日志一起使用，通过在单元测试中序列化和模拟错误时的确切状态来重现其他环境中的错误；将 TDD 用于解决生产问题。

# c - sprintf() 在 C 中没有尾随空空间

> ID：357068
> 
> 赞同：46
> 
> 时间：2008-12-10T18:29:24.487
> 
> 标签：c, string, null, printf

有没有办法使用 C sprintf() 函数而不在其输出末尾添加一个 '\0' 字符？我需要在固定宽度字符串的中间编写格式化文本。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-10T18:33:32.483

没有办法告诉`sprintf()`不要写一个尾随空值。您可以做的是使用`sprintf()`写入临时字符串，然后`strncpy()`仅复制您想要的字节。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-10T20:00:32.307

sprintf 返回写入的字符串的长度（不包括空终端），您可以使用它来了解空终端的位置，并将空终端字符更改为其他字符（即空格）。这将比使用 strncpy 更有效。

```
 unsigned int len = sprintf(str, ...);
 str[len] = '<your char here>'; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T16:32:12.087

您不能使用 sprintf() 执行此操作，但您*可以*使用 snprintf() 执行此操作，具体取决于您的平台。

您需要知道要替换多少个字符（但是当您将它们放入字符串的中间时，您可能无论如何都知道这一点）。

这是因为 snprintf() 的某些实现不保证写入终止字符 - 大概是为了与 stncpy() 等函数兼容。

```
char message[32] = "Hello 123, it's good to see you.";

snprintf(&message[6],3,"Joe"); 
```

此后，“123”被“乔”取代。

即使字符串被截断，在 snprintf() 保证空终止的实现上，这将不起作用。所以如果代码可移植性是一个问题，你应该避免这种情况。

大多数[基于 Windows](http://msdn.microsoft.com/en-us/library/2ts7cx93.aspx)的 snprintf() 版本都表现出这种行为。

但是，[MacOS](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/snprintf.3.html)和 BSD（也许还有 linux）似乎总是空终止。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T07:52:24.913

您还可以使用固定宽度字符串作为格式字符串，如下所示：

```
char my_fixed_width_string_format[] = "need 10 chars starting here: %10s";
char my_fixed_width_string[40];
char string_to_print[] = "abcdefghijklmnop";
sprintf(my_fixed_width_string, my_fixed_width_string_format, string_to_print;
printf(my_fixed_width_string); 
```

应该产生

> 从这里开始需要 10 个字符：abcdefghij

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T23:01:47.733

由于您正在写入固定区域，因此您可以这样做：

```
// pointer to fixed area we want to write to
char* s;

// number of bytes needed, not including the null
int r = snprintf(0, 0, <your va_args here>);

// char following the last char we will write - null goes here
char c = s[r + 1];

// do the formatted write
snprintf(s, r + 1, <your_va_args here>);

// replace what was overwritten
s[r + 1] = c; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-21T18:26:33.240

实际上，如果您使用 snprintf，此示例不会添加 null：

```
char name[9] = "QQ40dude";  
unsigned int i0To100 = 63;  
_snprintf(&name[2],2,"%d",i0To100);  
printf(name);// output will be: QQ63dude 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-27T21:56:23.127

这是内存受限设备的一个选项。它以速度换取使用更少的 RAM。我有时必须这样做来更新打印到 LCD 上的字符串的中间部分。

这个想法是您首先使用零大小的缓冲区调用 snprintf 以确定哪个索引将被空终止符破坏。

您可以在此处运行以下代码：[https ://rextester.com/AMOOC49082](https://rextester.com/AMOOC49082)

```
#include <stdio.h>
#include <string.h>

int main(void)
{
  char buf[100] = { 'a', 'b', 'c', 'd', 'e' };
  const size_t buf_size = sizeof(buf);
  const int i = 123;

  int result = snprintf(buf, 0, "%i", i);
  if (result < 0)
  {
    printf("snprintf error: %i\n", result);
    return -1;
  }

  int clobbered_index = result; //this index will get the null term written into it

  if (result >= buf_size)
  {
    printf("buffer not large enough. required %i chars\n", result + 1);
    return -1;
  }

  char temp_char = buf[clobbered_index];
  result = snprintf(buf, buf_size, "%i", i); //add result error checking here to catch future mistakes
  buf[clobbered_index] = temp_char;

  printf("buf:%s\n", buf);

  return 0;
} 
```

印刷`buf:123de`

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2010-10-04T13:38:54.013

看这里：[http ://en.wikipedia.org/wiki/Printf](http://en.wikipedia.org/wiki/Printf)

> printf("%.*s", 3, "abcdef") 将导致打印 "abc"

# ruby-on-rails - Rails 2.0：为什么不使用 sqlite3？

> ID：357071
> 
> 赞同：7
> 
> 时间：2008-12-10T18:30:28.730
> 
> 标签：ruby-on-rails, sqlite

我一直在阅读一些关于如何开始使用 Rails 2.0 的教程。

（超时：天才网站名称创意源于我刚刚打的错字：“tutoRAILS。”对不起，回到我的问题。）

在我阅读的大部分教程中，似乎都鼓励使用 MySQL 而不是 sqlite3。这有什么原因吗，比如性能方面的还是什么？我现在只是在我的 PC 上使用 InstantRails 测试 Rails，它们已经足够好了，可以在他们的设置中包含 MySQL，但我一直在使用 sqlite3 制作我的实验应用程序。我是否错过了 sqlite3 的一些主要警告，或者这只是其他人对 MySQL 的一般偏好？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-10T18:32:18.867

SQLite 是一个很好的引擎，但它仍然是一个*进程中*（或桌面）风格的引擎。In process 引擎在并发方面具有固有的弱点，这使得它们从根本上比基于服务器的引擎（如用于网站的 MySQL 或其他可能进行大量同时写入访问的场景）成为糟糕的选择。

请参阅 SQLite 网站上的此页面：
[http ://www.sqlite.org/whentouse.html](http://www.sqlite.org/whentouse.html)

> SQLite 通常可以很好地用作中低流量网站的数据库引擎

和

> 如果...您正在考虑将数据库组件拆分到单独的机器上，那么您绝对应该考虑使用企业级客户端/服务器数据库引擎而不是 SQLite。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T18:47:11.393

SQLite 很棒，但它在多个并发读取器和写入器时存在性能问题。

就像 Joel 所引用的那样，如果您的网站流量较低，这很少会成为问题，但在中等活动中，我有时会锁定数据库（和挂起的查询）。在这种情况下，对多并发用户有更好支持的数据库会更好。

就个人而言，如果我使用与 DB 无关的层来访问 DB，那么从一个层切换到另一个层很容易，因此从 SQLite 开始并在必要时转移到另一个层很容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T18:57:43.573

我总是从 SQLite 开始。如果我需要对 Rails 项目进行原型设计，我可以立即启动并运行。构建一些脚手架，运行我的迁移，编写一些测试，然后我就可以参加比赛了。

但是，如果一个项目达到您将要部署它的地步，我建议使用 MySQL 或 PostgreSQL 以获得更好的性能。

SQLite 对于小型嵌入式应用程序也有好处，或者如果您没有为只有少数人使用的工具运行数据库的开销。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T08:27:39.680

从 Rails 2.0 开始，sqlite3*是*默认数据库，所以当然没有偏见。许多 Rails 教程早于 Rails 2.0，然而，默认数据库是 MySQL。

正如其他几个人提到的，sqlite3 是一个很好的数据库，可以快速轻松地启动和运行应用程序。对于您的 Rails 开发环境，它有其优势——即使您的应用程序变得复杂，它也可能会正常工作。对于 Rails 测试环境，它也是一个很好的选择——它非常快，而且大多数测试对数据库的需求都比较简单，而且往往不需要并发，否则会遇到 sqlite3 的限制。

但是，对于许多（如果不是大多数）生产网站来说，可能需要为更高并发性设计的数据库——MySQL、Postgres 等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T16:28:26.650

For something like a Rails blog engine SQLite will work very well even at pretty high volumes because its all reads and very few writes. In fact the majority of your hits will be cached pages - depending on if you allow comments and how active your comment threads are - you might get away with a single rails process because your web server will handle almost every request.

With a SQLite database each rails process has to fight over a file system lock on the file to do writes so you'll end up blocking a lot if you have a lot of processes writing. A way to think about this is to consider how many rails processes you will have...if its going to need more than 3-4 then probably SQLite is not a good choice.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T18:35:52.323

我认为这主要是在教程中保持低摩擦水平的问题。如果你是新手，我只推荐 MySql，因为它会更容易完成教程。sqlite 是一个很好的桌面解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T19:02:36.310

请注意，Sqlite 是[Camping](http://redhanded.hobix.com/bits/campingAMicroframework.html)框架的默认引擎。有道理，因为两者都针对小而快，而不是大而企业

# .net - 从 Alt-Tab 程序切换器隐藏窗口的最佳方法？

> ID：357076
> 
> 赞同：105
> 
> 时间：2008-12-10T18:31:39.693
> 
> 标签：.net, wpf, winforms, alt-tab

几年来，我一直是 .NET 开发人员，而这仍然是我不知道如何正确完成的事情之一。通过 Windows 窗体和 WPF 中的属性从任务栏中隐藏窗口很容易，但据我所知，这并不能保证（或必然影响）它从`Alt`+`↹Tab`对话框中隐藏。我已经看到*不可见*的窗口出现在`Alt`+`↹Tab`中，我只是想知道什么是保证窗口*永远不会*出现（可见或不可见）在`Alt`+`↹Tab`对话框中的最佳方法。

**更新：**请参阅下面我发布的解决方案。我不允许将自己的答案标记为解决方案，但到目前为止，它是唯一有效的方法。

**更新 2：** Franci Penov 现在有一个看起来不错的适当解决方案，但我自己还没有尝试过。涉及到一些 Win32，但避免了离屏窗口的蹩脚创建。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-02-15T23:36:23.280

**更新：**

根据@donovan 的说法，现代 WPF 通过设置 `ShowInTaskbar="False"`和`Visibility="Hidden"`在 XAML 中本机支持这一点。（我还没有对此进行测试，但仍然决定提高评论的可见性）

**原答案：**

在 Win32 API 中，有两种方法可以从任务切换器中隐藏窗口：

1.  添加`WS_EX_TOOLWINDOW`扩展窗口样式 - 这是正确的方法。
2.  使其成为另一个窗口的子窗口。

不幸的是，WPF 不像 Win32 那样支持对窗口样式的灵活控制，因此窗口以`WindowStyle=ToolWindow`默认`WS_CAPTION`和`WS_SYSMENU`样式结束，这导致它具有标题和关闭按钮。另一方面，您可以通过设置删除这两种样式`WindowStyle=None`，但这不会设置`WS_EX_TOOLWINDOW`扩展样式，并且窗口不会从任务切换器中隐藏。

要使 WPF 窗口`WindowStyle=None`也从任务切换器中隐藏，可以采用以下两种方式之一：

*   使用上面的示例代码，使窗口成为一个小隐藏工具窗口的子窗口
*   修改窗口样式以包括`WS_EX_TOOLWINDOW`扩展样式。

我个人更喜欢第二种方法。再说一次，我做了一些高级的事情，比如在客户区扩展玻璃并在标题中启用 WPF 绘图，所以一点互操作不是一个大问题。

这是 Win32 互操作解决方案方法的示例代码。首先，XAML 部分：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300"
    ShowInTaskbar="False" WindowStyle="None"
    Loaded="Window_Loaded" > 
```

这里没什么花哨的，我们只是用`WindowStyle=None`and声明一个窗口`ShowInTaskbar=False`。我们还向 Loaded 事件添加了一个处理程序，我们将在其中修改扩展窗口样式。我们不能在构造函数中完成这项工作，因为此时还没有窗口句柄。事件处理程序本身非常简单：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    WindowInteropHelper wndHelper = new WindowInteropHelper(this);

    int exStyle = (int)GetWindowLong(wndHelper.Handle, (int)GetWindowLongFields.GWL_EXSTYLE);

    exStyle |= (int)ExtendedWindowStyles.WS_EX_TOOLWINDOW;
    SetWindowLong(wndHelper.Handle, (int)GetWindowLongFields.GWL_EXSTYLE, (IntPtr)exStyle);
} 
```

和 Win32 互操作声明。我已经从枚举中删除了所有不必要的样式，只是为了保持这里的示例代码很小。此外，不幸的`SetWindowLongPtr`是，在 Windows XP 上的 user32.dll 中没有找到入口点，因此通过路由调用的技巧`SetWindowLong`。

```
#region Window styles
[Flags]
public enum ExtendedWindowStyles
{
    // ...
    WS_EX_TOOLWINDOW = 0x00000080,
    // ...
}

public enum GetWindowLongFields
{
    // ...
    GWL_EXSTYLE = (-20),
    // ...
}

[DllImport("user32.dll")]
public static extern IntPtr GetWindowLong(IntPtr hWnd, int nIndex);

public static IntPtr SetWindowLong(IntPtr hWnd, int nIndex, IntPtr dwNewLong)
{
    int error = 0;
    IntPtr result = IntPtr.Zero;
    // Win32 SetWindowLong doesn't clear error on success
    SetLastError(0);

    if (IntPtr.Size == 4)
    {
        // use SetWindowLong
        Int32 tempResult = IntSetWindowLong(hWnd, nIndex, IntPtrToInt32(dwNewLong));
        error = Marshal.GetLastWin32Error();
        result = new IntPtr(tempResult);
    }
    else
    {
        // use SetWindowLongPtr
        result = IntSetWindowLongPtr(hWnd, nIndex, dwNewLong);
        error = Marshal.GetLastWin32Error();
    }

    if ((result == IntPtr.Zero) && (error != 0))
    {
        throw new System.ComponentModel.Win32Exception(error);
    }

    return result;
}

[DllImport("user32.dll", EntryPoint = "SetWindowLongPtr", SetLastError = true)]
private static extern IntPtr IntSetWindowLongPtr(IntPtr hWnd, int nIndex, IntPtr dwNewLong);

[DllImport("user32.dll", EntryPoint = "SetWindowLong", SetLastError = true)]
private static extern Int32 IntSetWindowLong(IntPtr hWnd, int nIndex, Int32 dwNewLong);

private static int IntPtrToInt32(IntPtr intPtr)
{
    return unchecked((int)intPtr.ToInt64());
}

[DllImport("kernel32.dll", EntryPoint = "SetLastError")]
public static extern void SetLastError(int dwErrorCode);
#endregion 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2013-07-27T02:19:37.730

在您的表单类中，添加以下内容：

```
protected override CreateParams CreateParams
{
    get
    {
        var Params = base.CreateParams;
        Params.ExStyle |= WS_EX_TOOLWINDOW;
        return Params;
    }
} 
```

就这么简单；很有魅力！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-10T21:00:35.213

我找到了一个解决方案，但它并不漂亮。到目前为止，这是我尝试过的唯一真正有效的*方法：*

```
Window w = new Window(); // Create helper window
w.Top = -100; // Location of new window is outside of visible part of screen
w.Left = -100;
w.Width = 1; // size of window is enough small to avoid its appearance at the beginning
w.Height = 1;
w.WindowStyle = WindowStyle.ToolWindow; // Set window style as ToolWindow to avoid its icon in AltTab 
w.Show(); // We need to show window before set is as owner to our main window
this.Owner = w; // Okey, this will result to disappear icon for main window.
w.Hide(); // Hide helper window just in case 
```

[在这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/8e3a788e-1e14-4751-a756-2d68358f898b/)找到它。

一个更通用、可重用的解决方案会很好。我想您可以创建一个窗口 'w' 并将其重用于应用程序中需要从`Alt`+隐藏的所有窗口`↹Tab`。

**更新：**好的，我所做的就是将上面的代码，减去该`this.Owner = w`位（并在`w.Hide()`之后立即移动`w.Show()`，这工作正常）到我的应用程序的构造函数中，创建一个`Window`名为`OwnerWindow`. 每当我想要一个窗口展示这种行为时，我只需设置`this.Owner = App.OwnerWindow`. 效果很好，只需要创建一个额外的（和不可见的）窗口。您甚至可以设置`this.Owner = null`是否希望窗口重新出现在`Alt`+`↹Tab`对话框中。

感谢 Ivan Onuchin 在 MSDN 论坛上提供的解决方案。

**更新 2：**您还应该设置`ShowInTaskBar=false`on`w`以防止它在显示时在任务栏中短暂闪烁。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-04-30T03:33:46.087

这就是诀窍，无论您试图从`Alt`+隐藏的窗口样式如何`↹Tab`。

将以下内容放入表单的构造函数中：

```
// Keep this program out of the Alt-Tab menu

ShowInTaskbar = false;

Form form1 = new Form ( );

form1.FormBorderStyle = FormBorderStyle.FixedToolWindow;
form1.ShowInTaskbar = false;

Owner = form1; 
```

本质上，您使您的表单成为一个不可见窗口的子窗口，该窗口具有正确的样式和 ShowInTaskbar 设置，以避开 Alt-Tab 列表。您还必须将自己表单的 ShowInTaskbar 属性设置为 false。最重要的是，主窗体的样式并不重要，完成隐藏的所有调整只是构造函数代码中的几行代码。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-04-23T11:35:27.963

为什么这么复杂？试试这个：

```
me.FormBorderStyle = FormBorderStyle.SizableToolWindow
me.ShowInTaskbar = false 
```

取自这里的想法：[http ://www.csharp411.com/hide-form-from-alttab/](http://www.csharp411.com/hide-form-from-alttab/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-05-11T13:09:37.537

看到它：（来自[http://bytes.com/topic/c-sharp/answers/442047-hide-alt-tab-list#post1683880](http://bytes.com/topic/c-sharp/answers/442047-hide-alt-tab-list#post1683880)）

```
[DllImport("user32.dll")]
public static extern int SetWindowLong( IntPtr window, int index, int
value);
[DllImport("user32.dll")]
public static extern int GetWindowLong( IntPtr window, int index);

const int GWL_EXSTYLE = -20;
const int WS_EX_TOOLWINDOW = 0x00000080;
const int WS_EX_APPWINDOW = 0x00040000;

private System.Windows.Forms.NotifyIcon notifyIcon1;

// I use two icons depending of the status of the app
normalIcon = new Icon(this.GetType(),"Normal.ico");
alertIcon = new Icon(this.GetType(),"Alert.ico");
notifyIcon1.Icon = normalIcon;

this.WindowState = System.Windows.Forms.FormWindowState.Minimized;
this.Visible = false;
this.ShowInTaskbar = false;
iconTimer.Start();

//Make it gone frmo the ALT+TAB
int windowStyle = GetWindowLong(Handle, GWL_EXSTYLE);
SetWindowLong(Handle, GWL_EXSTYLE, windowStyle | WS_EX_TOOLWINDOW); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-22T11:21:53.150

为什么要尝试这么多代码？只需将`FormBorderStyle`属性设置为`FixedToolWindow`. 希望能帮助到你。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-01-02T16:27:19.400

我尝试将主窗体的可见性设置为 false，只要它自动更改为 true：

```
private void Form1_VisibleChanged(object sender, EventArgs e)
{
    if (this.Visible)
    {
        this.Visible = false;
    }
} 
```

它完美地工作:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-10T19:25:01.270

在 XAML 中设置 ShowInTaskbar="False"：

```
<Window x:Class="WpfApplication5.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    ShowInTaskbar="False"    
    Title="Window1" Height="300" Width="300">
    <Grid>

    </Grid>
</Window> 
```

编辑：我猜它仍然显示在 Alt+Tab 中，只是不在任务栏中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-27T18:50:13.920

如果您希望表单是无边界的，那么您需要在表单的构造函数中添加以下语句：

```
this.FormBorderStyle = FormBorderStyle.None;
this.ShowInTaskbar = false; 
```

并且您必须将以下方法添加到派生的 Form 类中：

```
protected override CreateParams CreateParams
{
    get
    {
        CreateParams cp = base.CreateParams;
        // turn on WS_EX_TOOLWINDOW style bit
        cp.ExStyle |= 0x80;
        return cp;
    }
} 
```

[更多细节](http://www.csharp411.com/hide-form-from-alttab/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-01-28T13:02:09.003

我试过这个。这个对我有用

```
 private void Particular_txt_KeyPress(object sender, KeyPressEventArgs e)
    {
        Form1 frm = new Form1();         
        frm.Owner = this;
        frm.Show();
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-29T16:32:36.940

不要显示表格。使用隐形。

更多信息：http: [//code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-12-10T19:02:58.570

就我个人而言，如果不以某种方式连接到窗口，这是不可能的，我什至不确定这将如何完成或是否可能。

根据您的需要，将您的应用程序上下文开发为 NotifyIcon（系统托盘）应用程序将允许它在不显示在 ALT + TAB 中的情况下运行。但是，如果您打开一个表单，该表单仍将遵循标准功能。

如果需要，我可以挖掘我的博客文章，了解如何创建默认情况下只有 NotifyIcon 的应用程序。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-23T20:38:40.857

Form1 属性：
FormBorderStyle：可调整的
WindowState：最小化
ShowInTaskbar：False

```
private void Form1_Load(object sender, EventArgs e)
{
   // Making the window invisible forces it to not show up in the ALT+TAB
   this.Visible = false;
}> 
```

# php - PHP 中输 出的默认小数位数

> ID：357084
> 
> 赞同：2
> 
> 时间：2008-12-10T18:35:51.463
> 
> 标签：php, decimal, numbers

我在家里的开发盒上做我的 php 工作，在那里我有一个基本的 LAMP 设置。当我在我的 home box 上查看我的网站时，我回显的任何数字都会自动截断到最低要求的精度。例如 2 回显为 2，2.2000 回显为 2.2。

在生产框上，所有数字都与至少一个不必要的零相呼应，例如，100 变为 100.0。在这两个盒子上，PHP 版本都是 5.2.5。有没有人知道我可以更改的设置会强制 PHP 自动删除任何不必要的零？我不想去我的代码中输出数字并用 printf 或类似的东西替换 echo 的每个地方。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T18:51:39.140

当您不能依赖 PHP 配置时，不要忘记[number_format()](http://us.php.net/manual/en/function.number-format.php)，您可以使用它来定义如何返回数字，例如：

```
// displays 3.14 as 3 and 4.00 as 4    
print number_format($price, 0); 
// display 4 as 4.00 and 1234.56 as 1,234.56 aka money style
print number_format($int, 2, ".", ","); 
```

PS：并尽量避免使用money_format()，因为它不适用于Windows 和其他一些机器

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T18:46:17.013

快速浏览可用的[INI](http://us2.php.net/manual/en/ini.php#ini.list)设置让我觉得你的[精度](http://us2.php.net/manual/en/ini.core.php#ini.precision)值不同？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T11:57:17.337

感谢所有答案 - 解决方案是将负责的方法的返回值转换为浮点数。即它在做

```
return someNumber.' grams'; 
```

我只是将其更改为

```
return (float)someNumber.' grams'; 
```

然后 PHP 在需要时截断任何尾随零。

有人可以关闭这个吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T18:51:59.497

只是为了排除其他可能的原因：这些数字来自哪里？它是否使用文字值执行此操作？

单独的精度设置似乎不太可能导致这种情况。`auto_prepend_file`还要检查是否有任何东西可能通过或之类的东西干扰输出`output_handler`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T18:52:43.677

您应该使用 round() 命令始终向下舍入所需的精度，否则由于浮点运算的性质，有一天您会得到类似 2.2000000000123 的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-01T09:01:02.960

尝试内置功能[`round`](http://php.net/round)；

```
float round ( float $val [, int $precision = 0 [, int $mode = PHP_ROUND_HALF_UP ]] ); 
```

> 将 val 的四舍五入值返回到指定精度（小数点后的位数）。精度也可以是负数或零（默认）。

Example #1 round() 例子

```
<?php
echo round(3.4);         // 3
echo round(3.5);         // 4
echo round(3.6);         // 4
echo round(3.6, 0);      // 4
echo round(1.95583, 2);  // 1.96
echo round(1241757, -3); // 1242000
echo round(5.045, 2);    // 5.05
echo round(5.055, 2);    // 5.06
?> 
```

Example #2 模式示例

```
<?php
echo round(9.5, 0, PHP_ROUND_HALF_UP);   // 10
echo round(9.5, 0, PHP_ROUND_HALF_DOWN); // 9
echo round(9.5, 0, PHP_ROUND_HALF_EVEN); // 10
echo round(9.5, 0, PHP_ROUND_HALF_ODD);  // 9

echo round(8.5, 0, PHP_ROUND_HALF_UP);   // 9
echo round(8.5, 0, PHP_ROUND_HALF_DOWN); // 8
echo round(8.5, 0, PHP_ROUND_HALF_EVEN); // 8
echo round(8.5, 0, PHP_ROUND_HALF_ODD);  // 9
?> 
```

# gcc - 如何处理旧编译器的 sstream 与 strstream 不一致

> ID：357086
> 
> 赞同：0
> 
> 时间：2008-12-10T18:35:55.940
> 
> 标签：gcc, stringstream, deprecated

我暂时使用 gcc 2.95.2，`sstream`它没有定义标题，而是定义了 (略有不同，已弃用) `strstream`。我目前正在解决这个问题

```
#if __GNUC__ < 3       // or whatever version number it changes
#include <strstream>
#else
#include <sstream>
#endif 
```

然后是：

```
#if __GNUC__ < 3
    strstream str;
    str << "Hello World";
#else
    stringstream str("Hello World");
#endif 
```

但这真的很烦人。我只是想确保当我切换回更新的 gcc（或其他一些编译器）时，我不必重写这些段落。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T18:41:19.627

创建`mystream.h`为

```
#ifndef mystream

#if __GNUC__ < 3       // or whatever version number it changes
#include <strstream>
#define mystream(x,y) strstream x; x << y;
#else
#include <sstream>
#define mystream(x,y) sstream x(y);
#endif

#endif 
```

然后改用`mystream.h`标题和`mystream`类型。

如果你真的想让它看起来像现代的 sstream，你可以手动创建一个新类（借助更新的 std c++ 库源代码或手动创建一个使用 strstream 作为底层工作方式的代理类）。

# java - 如何在 Websphere 中启用 JMX？

> ID：357095
> 
> 赞同：30
> 
> 时间：2008-12-10T18:39:02.457
> 
> 标签：java, jakarta-ee, websphere, jmx, jconsole

我想使用 JConsole 来监控我的 Websphere 应用程序，但我不确定如何启用 JMX。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-11T09:43:40.010

以下信息适用于 Windows 上的 Websphere 6.1。

首先，连接 MBean 服务器的神奇 URL 是：

```
service:jmx:iiop://<host>:<port>/jndi/JMXConnector 
```

如果您有一个默认的 Websphere 安装，那么 JNDI 端口号可能是 2809、2810...，这取决于一个系统上安装了多少服务器以及您要连接到的特定服务器。可以肯定的是，在启动 Websphere 时，请检查日志，因为它会转储如下一行

```
0000000a RMIConnectorC A   ADMC0026I: The RMI Connector is available at port 2810 
```

如果您没有收到此行，请打开 Websphere 管理控制台并转到

> 应用程序服务器 > server1 > 管理服务 > JMX 连接器

查看是否需要添加或更改配置。

第二个重要的信息是，在使用服务器执行 JMX 时总是需要以下 JAR：

```
com.ibm.ws.admin.client_6.1.0.jar 
```

`runtimes`您可以在Websphere的目录中找到这个 JAR 。无论您做什么，无论是以编程方式访问 Websphere 上的 MBean，还是使用 JConsole 等等，都可以使用魔术 URL 并**始终**包含此 JAR。

对于此答案的其余部分，假设 Websphere 安装在 D:\prog\was61 中。

要运行 JConsole，请输入以下内容：

```
D:\prog\was61\java\bin>jconsole -J-Djava.class.path=d:\prog\was61\java\lib\tools.jar;D:\prog\was61\runtimes\com.ibm.ws.admin.client_6.1.0.jar 
```

然后转到“高级”选项卡并输入神奇的 JMX URL。按连接，您应该会看到 MBean 出现。

使用 Sun JDK 是完全不同的事情。您需要一个额外的 JAR，它位于 IBM JDK 的库中，但不是 Sun 的 (ibmorb.jar)，也许以下命令可能对您有用：

```
C:\Program Files\Java\jdk1.5.0_11\bin>jconsole -J-Djava.class.path="c:\Program Files\Java\jdk1.5.0_11\lib\jconsole.jar";"c:\Program Files\Java\jdk1.5.0_11\lib\tools.jar";D:\prog\was61\runtimes\com.ibm.ws.admin.client_6.1.0.jar;D:\prog\was61\java\jre\lib\ibmorb.jar 
```

我说也许吧，因为它对我不起作用。我收到了一条不错的 jndiUnavailCommErr 错误消息，因为它在我的 Websphere 安装正在侦听 2810 时预计端口 2809 上有一些东西，尽管我在 JMX URL 中正确指定了端口 2810。但是，如果您调整路径以指向您的 Sun JDK，它可能对您有用。这是我使用 Sun 的 JDK 连接到 Websphere 最接近的一次。

最后说明：我尝试了基于 RMI 的解决方案，还有一个可用的 SOAP 连接器，但没有尝试过。

与 J2EE、Websphere 和其他东西一样：祝你好运，你会需要它的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-03-28T08:09:31.780

很简单。只需使用以下 JMX 参数启动 Websphere：

```
-Djavax.management.builder.initial= 
-Dcom.sun.management.jmxremote 
-Dcom.sun.management.jmxremote.authenticate=false 
-Dcom.sun.management.jmxremote.ssl=false 
-Dcom.sun.management.jmxremote.port=1099 
```

然后启动 JConsole 或 VisualVM 并连接到 localhost:1099

由于我不允许发布证明屏幕截图，因此我发布了来自 visualvm“概览选项卡”的信息。

```
PID：12568
主机：本地主机
主类：<未知>
参数：<无>
JVM：IBM J9 VM（2.3、J2RE 1.5.0 IBM J9 2.3 Windows XP x86-32 j9vmwi3223-20100808（启用 JIT）
J9VM - 20100629_60535_lHdSMr
JIT - 20100623_16197_r8
GC-20100211_AA)
Java：版本 1.5.0，供应商 IBM Corporation
Java 主页：C:\Program Files\IBM\SDP\runtimes\base_v61\java\jre
JVM 标志：<无>
OOME 上的堆转储：已禁用

```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-12T15:49:51.953

也许这有点离题，但我找到了一种从 JConsole 连接到 WAS 7.0 JMX 服务器的方法。不需要服务器设置，不需要 AppClient，只需要一些 JAR 和一点客户端设置。

使用以下脚本

```
@echo off 
set HOST=<host>
set PORT=2809

set WAS_HOME=D:/Programy/IBM/WebSphere/AppServer

set THIS_DIR=E:/Home/Bogus/Pulpit

set CLIENTSAS=-Dcom.ibm.CORBA.ConfigURL=file:/%THIS_DIR%/sas.client.props
set PROVIDER=-Djava.naming.provider.url=corbaname:iiop:%HOST%:%PORT% 

set PROPS=
set PROPS=%PROPS% %CLIENTSAS%
set PROPS=%PROPS% %PROVIDER%

set CLASSPATH=
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\java\lib\tools.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\runtimes\com.ibm.ws.admin.client_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\runtimes\com.ibm.ws.ejb.thinclient_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\runtimes\com.ibm.ws.orb_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\java\lib\jconsole.jar

set URL=service:jmx:iiop://%HOST%:%PORT%/jndi/JMXConnector

@echo on

:: %WAS_HOME%\java\bin\
java -classpath %CLASSPATH% %PROPS% sun.tools.jconsole.JConsole %URL% 
```

如果目标服务器禁用了管理安全性，请注释掉 CLIENTSAS 和 PROVIDER 行。

如果启用了安全性，您还需要将 sas.client.props 文件放在 THIS_DIR 目录中。可以在 WAS_profile\properties 目录下找到模板文件。您将不得不做一些设置。这是我的 sas.client.props 的摘录

```
com.ibm.CORBA.securityEnabled=true

com.ibm.CORBA.authenticationTarget=BasicAuth
com.ibm.CORBA.authenticationRetryEnabled=true
com.ibm.CORBA.authenticationRetryCount=3
com.ibm.CORBA.validateBasicAuth=true
com.ibm.CORBA.securityServerHost=
com.ibm.CORBA.securityServerPort=
com.ibm.CORBA.loginTimeout=300
com.ibm.CORBA.loginSource=prompt

com.ibm.CORBA.loginUserid=
com.ibm.CORBA.loginPassword=

com.ibm.CORBA.krb5ConfigFile=
com.ibm.CORBA.krb5CcacheFile=

com.ibm.CSI.performStateful=true

com.ibm.CSI.performClientAuthenticationRequired=false
com.ibm.CSI.performClientAuthenticationSupported=true

# SET ALL THE FOLLOWING VALUES TO FALSE

com.ibm.CSI.performTLClientAuthenticationRequired=false
com.ibm.CSI.performTLClientAuthenticationSupported=false

com.ibm.CSI.performTransportAssocSSLTLSRequired=false
com.ibm.CSI.performTransportAssocSSLTLSSupported=false

com.ibm.CSI.performMessageIntegrityRequired=false
com.ibm.CSI.performMessageIntegritySupported=false

com.ibm.CSI.performMessageConfidentialityRequired=false
com.ibm.CSI.performMessageConfidentialitySupported=false

# COMMENT THIS OUT
#com.ibm.ssl.alias=DefaultSSLSettings

com.ibm.CORBA.requestTimeout=180 
```

好的 ：）

连接后，将出现登录弹出窗口。输入您的管理员用户和密码（在 JConsole 的连接对话框中不需要用户和密码）

您可以从 IBM JDK 或 Sun JDK 运行 JConsole。对于 IBM，不需要其他设置。但是，对于 Sun，您可能需要将 orb.properties 文件放在您的主目录中。该文件可以在 com.ibm.ws.ejb.thinclient_7.0.0.jar 中找到。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-23T14:51:47.757

我无法让它工作。我得到的只是

> 与 username@service:jmx:iiop//localhost:2809/jndi/JMXConnector 的连接没有成功。你想再试一次吗？

但是，我确实通过执行以下操作使其工作：

1.  将“-Djavax.management.builder.initial= -Dcom.sun.management.jmxremote”添加到通用 JVM 参数。
2.  将这些行添加到 WebSphere/AppServer/java/jre/lib/management/management.properties

```
com.sun.management.jmxremote.port=9999
com.sun.management.jmxremote.authenticate=false
com.sun.management.jmxremote.ssl=false

```

但是没有一个有用的mbeans出现..？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-09T19:03:51.977

我发现为了使用 Sun JDK JConsole 连接到 WAS 6.1，除了`com.ibm.ws.admin.client_6.1.0.jar`JAR 文件之外，我还必须在启动 JConsole 时在引导类路径中包含以下 3 个 JAR：-

```
ibmorbapi.jar
ibmorb.jar
ibmcfw.jar 
```

这些可以在 websphere 的 java\jre\lib 目录中找到。

例如在 Windows 上，如果您将上面列出的所有四个 JAR 复制到您选择的目录中（在下面的示例中，我已将它们复制到 C:\packages\was61-jmx），您可以使用如下所示的批处理文件启动 JConsole：-

```
set JAVA_HOME=C:\Progra~1\Java\jdk1.5.0_20
set WAS6.1_JARS=C:\packages\was61-jmx

set BOOTJARS=%WAS6.1_JARS%\ibmorbapi.jar
set BOOTJARS=%BOOTJARS%;%WAS6.1_JARS%\ibmorb.jar
set BOOTJARS=%BOOTJARS%;%WAS6.1_JARS%\ibmcfw.jar

set CLASSPATH=%WAS6.1_JARS%\com.ibm.ws.admin.client_6.1.0.jar
set CLASSPATH=%CLASSPATH%;%JAVA_HOME%\lib\tools.jar
set CLASSPATH=%CLASSPATH%;%JAVA_HOME%\lib\jconsole.jar

%JAVA_HOME%\bin\jconsole  -J-Xbootclasspath/p:%BOOTJARS% -J-Djava.class.path=%CLASSPATH% 
```

这对我来说适用于 Sun Jconsole 的 jdk 1.5 和 1.6 版本。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-07T06:27:00.377

我也挣扎了几个小时才能让它工作，我找到了解决方案。这里的关键问题是 SSL——客户端必须使用正确的密钥来建立与服务器的 SSL 连接。这包括指向正确的信任库位置和信任库密码，如此[处](http://publib.boulder.ibm.com/infocenter/wxsinfo/v7r1/index.jsp?topic=/com.ibm.websphere.extremescale.admin.doc/cxsjmxsec.html)所述。设置环境的最佳方法是为相关服务器调用 setupCmdLine.sh（在 Windoze 上为 setupCmdLine.bat），然后像这样调用 jconsole：

```
#!/bin/bash

WAS_HOME=/opt/IBM/WebSphere/AppServer

# setup server-specific env variables
. $WAS_HOME/profiles/AppSrv01/bin/setupCmdLine.sh

HOST=localhost
PORT=9100

CLASSPATH=$JAVA_HOME/lib/jconsole.jar
CLASSPATH=$CLASSPATH:$WAS_HOME/runtimes/com.ibm.ws.admin.client_8.5.0.jar
CLASSPATH=$CLASSPATH:$WAS_HOME/runtimes/com.ibm.ws.ejb.thinclient_8.5.0.jar
CLASSPATH=$CLASSPATH:$WAS_HOME/runtimes/com.ibm.ws.orb_8.5.0.jar

$JAVA_HOME/bin/jconsole \
    -J-Djava.class.path=$CLASSPATH\
    -J$CLIENTSAS\
    -J$CLIENTSSL\
    service:jmx:iiop://$HOST:$PORT/jndi/JMXConnector 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-07T12:41:27.570

您无法通过 WAS 控制台设置所需的系统属性，因为它不允许您指定空值。相反，您必须在“server.xml”的底部插入以下内容：

```
<systemProperties xmi:id="Property_1315391623828" name="com.sun.management.jmxremote" value="" required="false"/>    <systemProperties xmi:id="Property_1315327918140" name="com.sun.management.jmxremote.port" value="1235" required="false"/>
<systemProperties xmi:id="Property_1315327935281" name="com.sun.management.jmxremote.authenticate" value="false" required="false"/>
<systemProperties xmi:id="Property_1315327948046" name="com.sun.management.jmxremote.ssl" value="false" required="false"/>
<systemProperties xmi:id="Property_1315390852859" name="javax.management.builder.initial" value="" required="false"/> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-06-19T07:08:50.950

来自[http://malliktalksjava.in/2010/07/26/enable-jmx-remote-port-in-websphere/](http://malliktalksjava.in/2010/07/26/enable-jmx-remote-port-in-websphere/)

1.  登录到网络领域的*管理控制台*任何配置文件（服务器），快捷方式将在开始菜单程序中可用。

    *   如果尚未部署，请部署**PerfServletApp.ear应用程序。**
    *   检查是否部署了**PerfServletApp.ear**：
        *   扩展**应用程序**+>**应用程序类型**+> **WebSphere 企业应用程序**
        *   如果没有，请单击**新建应用程序**。
    *   从**WebSphere 目录**-> **AppServer** -> **InstallableApps**浏览。
    *   *（按照步骤。）*
2.  启用 PMI 数据并启用所有统计信息。

    *   在左窗格（底部）中，转到**Monitoring and Tuning** +> **Performance Monitoring Infrastructure(PMI)**
    *   在*配置*选项卡中，启用**PMI**。
    *   在此*配置*选项卡和*运行时*选项卡中，设置**所有统计信息**。然后**保存**更改。
3.  设置 JVM 参数

    *   在**Severs** +> **Server Types** +> **WebSphere Application Servers**中，然后 -> **[server-name]** +> **Process definition** -> **Java Virtual Machine**
    *   将通用 jvm 参数设置为 include

        > `-Djavax.management.builder.initial= -Dcom.sun.management.jmxremote`

    in 显示服务器列表。单击所需的服务器。

    *   在右窗格中 ->**服务器基础结构**-> **Java and Process Management** 单击**Process** definition，再次在 Additional Properties of **Configuration**选项卡中单击**Java Virtual Machine**。将*Generic Jvm Argument*字段放入并`-Djavax.management.builder.initial= -Dcom.sun.management.jmxremote`保存**更改**。

****   要启用 JMX 远程端口，请打开以下属性文件并添加以下代码。在*[WebSphere-directory]\AppServer\java\jre\lib\management\management.properties*中，添加：

    ```
    com.sun.management.jmxremote.port=9001
    com.sun.management.jmxremote.ssl=false
    com.sun.management.jmxremote.authenticate=false 
    ```

    *   保存主数据，停止服务器，然后启动服务器以加载更改。*** 

 **** * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T18:09:02.237

看下面[jconsole连接Websphere 6.1的简单方法](http://www.interface101.org/iblog/post/JConsole-on-WAS-61.aspx)

它确实适用于我（Solaris、Was 6.1、Sun JVM），它也适用于 Visual VM

享受 ！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-14T15:18:43.180

您可以在 WebSphere Application Server 上的 Communications -> Ports 下找到要连接的正确端口。与 BOOTSTRAP_ADDRESS 关联的端口允许您进行连接。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-10-04T14:01:17.123

您可以尝试以下方法，它使用 SOAP 协议适配器。我认为这是尽可能精简的配置。

```
#!/bin/sh 
current_dir=`dirname "$0"`

HOSTNAME=host.fqdn
PORT=2809

WAS_HOME=/opt/IBM/WebSphere/AppServer
WAS_PROFILE=$WAS_HOME/profiles/AppSrv01
WAS_RUNTIMES=$WAS_HOME/runtimes

WAS_LIB=$WAS_HOME/java/lib
JAVA_HOME=$WAS_HOME/java

CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/jconsole.jar:$WAS_RUNTIMES/com.ibm.ws.admin.client_7.0.0.jar:$WAS_LIB/ibmcfw.jar 

TARGET=service:jmx:soap://$HOSTNAME:$PORT/jndi/JMXConnector

CP="-J-Djava.class.path=$CLASSPATH"
SSL_SERVER_KEY="-J-Djavax.net.ssl.keyStore=$WAS_PROFILE/etc/DummyServerKeyFile.jks -J-Djavax.net.ssl.keyStorePassword=WebAS"
SSL_TRUST_STORE="-J-Djavax.net.ssl.trustStore=$WAS_PROFILE/etc/DummyServerTrustFile.jks -J-Djavax.net.ssl.trustStorePassword=WebAS"
SSL_OPTS="-J-Dcom.ibm.SSL.ConfigURL=file:$WAS_PROFILE/properties/ssl.client.props"
SOAP_OPTS="-J-Dcom.ibm.SOAP.ConfigURL=file:$WAS_PROFILE/properties/soap.client.props"
WAS_OPTS="-J-Dwas.install.root=$WAS_HOME -J-Djava.ext.dirs=$WAS_HOME/plugins:$WAS_HOME/lib:$WAS_HOME/plugins/com.ibm.ws.security.crypto_6.1.0:$WAS_HOME/lib:$JAVA_HOME/jre/lib/ext"

COMMAND="$JAVA_HOME/bin/jconsole $CP $SSL_SERVER_KEY $SSL_TRUST_STORE $SSL_OPTS $SOAP_OPTS $WAS_OPTS $TARGET"

exec $COMMAND 
```

感谢我的同事 Jeroen 使用 IIOP 的脚本的初始版本（我正在尝试 SOAP，希望它能与 Hyperic 一起使用）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-28T17:39:53.890

好的。有两种方法可以做到这一点：一种使用 SOAP 连接器，另一种使用 RMi/IIOP 连接器。

对于 SOAP，您需要进行 WAS 设置以添加新的 PORT 和上述其他 JVM 参数。但是一旦 JConsole 连接到服务器，您得到的只是基本的 JVM 指标。

使用 RMI，您可以获得 WebSphere 公开的所有内容。所有的 MBean！唯一需要注意的是：如果您的 WAS JVM 在防火墙后面 - 您需要打开一个端口才能从您的桌面访问它。但是您可以通过 X11 直接在应用服务器主机上运行它！

我在我的 Windows XP 桌面上使用 JDK7 连接到启用了全局安全性的 WAS 7.0。我从上面的答案 #4 中获取了一个脚本并将其用作起点。这是我的版本：

```
@echo off 
set HOST=<put hostname here>
set PORT=<put JVM's BOOTSTRAP_PORT here>

set WAS_HOME=C:\jconsole
set JAVA_HOME=C:\glassfish3\jdk7
set PROPS_DIR=C:\jconsole\properties

set CLIENTSAS=-Dcom.ibm.CORBA.ConfigURL=file:/%PROPS_DIR%/sas.client.props
set CLIENTSSL=-Dcom.ibm.SSL.ConfigURL=file:/%PROPS_DIR%/ssl.client.props
set PROVIDER=-Djava.naming.provider.url=corbaname:iiop:%HOST%:%PORT% 

set PROPS=
set PROPS=%PROPS% %CLIENTSAS% %CLIENTSSL% %PROVIDER%

set CLASSPATH=
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\com.ibm.ws.admin.client_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\com.ibm.ws.ejb.thinclient_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%WAS_HOME%\com.ibm.ws.orb_7.0.0.jar
set CLASSPATH=%CLASSPATH%;%JAVA_HOME%\lib\jconsole.jar
set CLASSPATH=%CLASSPATH%;%JAVA_HOME%\lib\tools.jar

set URL=service:jmx:iiop://%HOST%:%PORT%/jndi/JMXConnector

@echo on

%JAVA_HOME%\bin\java -classpath %CLASSPATH% %PROPS% sun.tools.jconsole.JConsole %URL% 
```

WAS_HOME 只是我从 WebSphere 二进制文件（脱离 Solaris）下载的那些 IBM JAR 的目录。我还在下面创建了两个子目录：**properties**和**keystore**。在属性子目录中，我放置了我的 sas.client.props 和 ssl.client.props，它们也是从工作中的 WAS7 单元下载的（我从 DM 中取出了它）。在密钥库子目录中，我放置了同样从 WAS7 单元下载的 key.p12 和 trust.p12 文件。确保他们拥有正确的证书！如果 WAS/etc 中的那些不起作用 - 请尝试 ${CONFIG_ROOT}/cells/ 中的那些。 **修改 ssl.client.props 以确保 p12 文件的路径正确！**

现在，为了让它工作，您还必须从您的 WAS 二进制文件中下载以下内容：

```
WAS_BIN_HOME/java/jre/lib/endorsed 
```

将整个目录放在您的 SUN JDK 的**jre/lib**目录下。这会处理 IBM JSSE2 Provider 错误等。**此外，从WAS_BIN_HOME/java/jre/lib/security**获取以下三个文件：

```
java.security
local_policy.jar
US_export_policy.jar 
```

我只是用我从 IBM 获取的那些覆盖了 SUN 的 JDK 附带的那些。

此外，请务必在**sas.client.props**中输入用户 ID 和密码，类似于在 soap.client.props 中的操作。您可以以相同的方式对密码进行编码。这是通过 Global Security 的 BasicAuth 所必需的。

我想就是这样。PS我不是Windows专业人士，所以如果有更清洁的方法可以做到这一点 - 请分享。

# c# - 在 NHibernate 中调用 Session.CreateSQLQuery ExecuteUpdate 失败

> ID：357103
> 
> 赞同：4
> 
> 时间：2008-12-10T18:42:23.150
> 
> 标签：c#, nhibernate, exception

我有一个存储过程，用于通过链接服务器同步来自另一个系统的数据。我在使用 Quartz.net 运行任务的 Windows 服务中使用 NHibernate 执行此调用。其中一项任务是同步数据任务，它实际上只是 sproc 调用：

```
using(var tx = Session.BeginTransaction())  {   
    Session
        .CreateSQLQuery("exec dbo.spSyncData")
        .ExecuteUpdate();
    tx.Commit();
} 
```

此存储过程不接受任何参数并且不返回任何结果。当这个调用完成后，我然后加载像这样同步的数据，，，

```
return Session.CreateCriteria(typeof(MyData))
    .Add(Restrictions.Eq("Status", Status.Waiting))
    .List<MyData>(); 
```

但是，此调用失败并出现 ADOException，并显示消息“读取器关闭时调用 Read 的尝试无效”。

我发现存储过程被设置为 SET NOCOUNT ON 所以我改变了它，现在我得到了一个不同的异常......

“已经有一个打开的 DataReader 与此命令关联，必须先关闭它。”

提交 sproc 调用时会发生此错误。

有任何想法吗？谢谢，史蒂夫

更新：我发现的一些问题与跨多个线程访问会话对象有关，这是我没有预料到的。我能够清理它，但没有机会再次尝试使用 Session.Connection 对象执行 IDbCommand 的建议。以前失败过，但我认为这也与线程问题有关。我希望尽快回到那个尝试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T20:33:05.613

我会尝试通过 session.Connection （这是一个 IDbConnection）而不是 CreateSQLQuery 来执行存储过程

ExecuteUpdate() 用于批量操作（参见NHibernate 开发人员之一[Dario Quintana 的这篇文章）。](http://darioquintana.com.ar/blogging/?p=23)

# c# - Asp.net 在重新加载时重复提交表单

> ID：357104
> 
> 赞同：2
> 
> 时间：2008-12-10T18:42:31.747
> 
> 标签：c#, asp.net

如何防止由于浏览器中的页面重新加载而第二次发布的表单再次使用 C# Asp.Net 添加到我的数据库中。

谢谢，史蒂文

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T18:51:35.987

您可以做的一件事是在提交第一页后，您可以执行 response.redirect 回到同一页面（因此如果刷新命中则终止 SUMBIT）。

编辑：拼写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T18:51:20.793

您需要一些唯一值来标识表单/页面 - 可能是隐藏字段中生成的数字 - 并记住/检查已处理

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T18:52:05.550

我有时会添加以下行“Response.Redirect("ThisPage.aspx");” 回发处理程序结束有几个原因。如果您要更新保存在外部源中的数据并且具有复杂的接口（尤其是使用 javascript 更改服务器控件的接口），这会强制所有控件重置，并且当触发 onload 事件时，IsPostBack 属性设置为 false。另一个副作用是按 F5 不会重新发送命令。在您的情况下，这可能是正确的，也可能不是：

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T18:55:47.633

尝试使用[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)习惯用法：在处理回发后（在`Page_Load`或代码隐藏单击处理程序中），将页面重定向回自身，

```
Response.Redirect(Request.Url.ToString(), true); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T11:25:41.517

最后使用 Response.Redirect("Address of Page");

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-10T18:50:16.910

HTTP 提供了一种避免意外重新提交的机制——在表单标签中使用 POST 方法，而不是 GET 方法。

我认为公平地说，您**应该**对更新资源的请求使用 POST 方法，因为它也可以防止其他不良行为，例如为更新数据的页面添加书签。

# javascript - IE7：作为新标签打开时自定义弹出背景颜色

> ID：357114
> 
> 赞同：1
> 
> 时间：2008-12-10T18:46:37.590
> 
> 标签：javascript, popup, internet-explorer-7

我的页面上有一个弹出窗口，如果它在 IE7 中作为新选项卡打开，我希望它具有白色背景。IE7 有一个用户设置，用于控制是否在新选项卡中打开弹出窗口，或者以其他方式打开。

可以定制这个吗？还是我被黑色背景困住了？

另外，如果在新选项卡中打开弹出窗口，我可以设置它的位置吗？例如，如果弹出窗口作为新选项卡打开，我希望它以白色背景居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T19:02:55.043

您无法读取用户的设置 - 这是严重的安全违规行为，浏览器会故意阻止访问此信息。

# windows - 什么导致 Visual Studio 2005 无序命令行构建？

> ID：357116
> 
> 赞同：2
> 
> 时间：2008-12-10T18:47:02.440
> 
> 标签：windows, visual-studio, visual-c++, visual-studio-2005

在 Visual Studio 2005 中，我有一个通过“项目依赖关系”对话框指定的显式依赖关系的解决方案。

例如，当我通过 devenv /rebuild Release 构建时，项目的构建顺序与加载 IDE 时不同。这是我指定的依赖项不允许的顺序。

在某些情况下，devenv 崩溃:(

日志在显示顺序的每一行之前显示一个数字，我认为这是依赖引起的顺序：

11>MyExeProject - 1 个错误，0 个警告

但是，构建似乎以该顺序**开始**，**中断**并以另一个顺序继续 - 这是行不通的。所以 8 可能会在 11 之前完成它的构建。如果 8 中有 11 个链接，那就有问题了。

IDE 中会发生类似的重新排序，但构建顺序仍保持完整性。

需要通过命令行构建，任何想法为什么会这样或原因是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-15T19:25:04.080

好的，我相信这是真正的答案。

启用多处理器构建。依赖顺序仍然在 IDE 中强制执行，但不是通过命令行，至少在 VS 2005 中是这样。

关闭它是通过工具/选项/构建和运行。将最大值设置为 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T00:23:42.870

确保您已正确设置解决方案中的依赖项。这会直接影响构建顺序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-11T00:43:08.150

If devenv didn't crash for you when building in the IDE, you've been lucky.

The following workaround is obnoxious but it worked for me, sigh. Reboot and set the BIOS to allow only a single CPU core to run.

# java - JMockit 中有没有办法从模拟方法调用原始方法？

> ID：357121
> 
> 赞同：7
> 
> 时间：2008-12-10T18:49:13.730
> 
> 标签：java, mocking, jmockit

在我的模拟类中，我正在模拟方法 foo()。对于某些测试用例，我希望 foo() 的模拟实现返回一个特殊值。对于其他测试用例，我想使用 foo() 的真正实现。我在我的模拟类中定义了一个布尔值，以便我可以在模拟方法中确定是要返回特殊值还是使用“真实”方法。问题是，我似乎无法弄清楚如何从模拟方法中调用真正的方法。

我发现您可以在名为“it”的模拟对象中定义一个特殊成员（具有被模拟对象的类型）。这允许您从模拟实现中引用真实的类。所以，我的计划是，如果我需要调用 foo() 的“真实”实现，模拟方法将调用 it.foo()。但是，这不起作用，因为调用 it.foo() 只是再次调用模拟版本，而不是真实版本，所以我最终得到了无限递归。

有什么办法可以使这项工作？

编辑：使用代码示例可能会更清楚，这是我当前的模拟方法实现的样子：

```
private RealClass it;
...
public SomeClass foo() {
    if(fakeIt) {
        return new SomeClass("fakevalue");
    } else {
        // doesn't work, just keeps calling the mock foo
        // in infinite recursion
        return it.foo();
    }
} 
```

编辑 2：另外，对于我的大多数测试用例，我*不*想要模拟实现。所以我最初的尝试是只在我需要模拟对象的那些测试用例中调用 Mockit.redefineMethods() 。但这不起作用 - 似乎你只能在 setup/teardown 中做到这一点......当我尝试这样做时，我的模拟实现从未被调用过。

解决方案注意事项：

起初我不认为给出的答案有效，但在玩了一些之后，似乎问题在于我将 JMockit “核心”方法与“注释”驱动方法混合在一起。显然，在使用注释时，您需要使用 Mockit.setupMocks，而不是 Mockit.redefineMethods()。这就是最终奏效的方法：

```
@Before 
public void setUp() throws Exception
{
    Mockit.setUpMocks(MyMockClass.class);
} 
```

然后，对于模拟类：

```
@MockClass(realClass = RealClass.class)
public static class MyMockClass {
    private static boolean fakeIt = false;
    private RealClass it;

    @Mock(reentrant = true)
    public SomeClass foo() {
        if(fakeIt) {
            return new SomeClass("fakevalue");
        } else {
            return it.foo();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-06-10T01:06:33.233

在更新的 JMockit 版本中，[`Invocation.proceed()`](http://jmockit.org/api1x/mockit/Invocation.html#proceed-java.lang.Object...-)可以从[`MockUp`](http://jmockit.org/api1x/mockit/MockUp.html)实现中调用。请参阅[访问调用上下文](https://jmockit.github.io/tutorial/Faking.html#invocation)。

```
public class MyMockClass extends MockUp<RealClass> {

    private static boolean fakeIt = false;

    @Mock
    public SomeClass foo(Invocation inv) {
        if (fakeIt) {
            return new SomeClass("fakevalue");
        } else {
            return inv.proceed();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T04:14:55.413

我认为您可以使用`@Mock`注释来做到这一点。从文档中，`@Mock(reentrant=true)`您的模拟课程应该这样做。

请参阅[http://jmockit.googlecode.com/svn/trunk/www/javadoc/mockit/Mock.html](http://jmockit.googlecode.com/svn/trunk/www/javadoc/mockit/Mock.html)
示例请看这里[http://jmockit.googlecode.com/svn/trunk/www/tutorial/StateBasedTesting.html #可重入](http://jmockit.googlecode.com/svn/trunk/www/tutorial/StateBasedTesting.html#reentrant)

虽然我没有测试过这个..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T20:07:27.363

除了投入模拟对象之外，您还可以将要测试的对象子类化并覆盖应该返回特殊值的方法。

例如：

```
RealClass toTest = new RealClass(){
      public String foo(){
          return "special value";
      }
}

//use toTest in test 
```

通过将此定义保留在您的测试中，其他人也很清楚哪些方法正在被“模拟”。

# php - PHP/mySQL - 如何将嵌套行提取到多维数组中

> ID：357122
> 
> 赞同：4
> 
> 时间：2008-12-10T18:49:27.850
> 
> 标签：php, mysql, join, subquery, one-to-many

来自我的[另一个问题](https://stackoverflow.com/questions/356778/php-query-single-value-per-iteration-or-fetch-all-at-start-and-retrieve-from-ar)，我学会了不要在循环中使用数据库查询，因此我必须学习如何在循环之前以方便的方式获取所有数据。

假设我有两个表“秤”和“项目”。items 中的每一项都属于一个 scale in scales，并与一个外键（scaleID）链接。我想在一个查询中将所有数据提取到一个数组结构中，这样第一个维度是所有列的所有比例并嵌套在其中，一个项目的所有项目都缩放所有列。

结果将是这样的：

```
scale 1, scaleParam1, scaleParam2, ...
....item1, itemParam1, itemParam2, ...
....item2, itemParam1, itemParam2, ...
scale 2, scaleParam2, scaleParam2, ...
....item1, itemParam1, itemParam2, ...
....item2, itemParam1, itemParam2, ... 
```

到目前为止，我主要完成了一对一关系的左连接。这是一个一对多的，我无法完全理解它。

它是一个正确的连接吗，它也可以用一个子查询来完成，如何将完整的外部行也放入其中......

稍后我想用嵌套的 foreach 循环遍历它。

也许只是我头疼...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T19:23:32.117

查询应如下所示：

```
SELECT * FROM scales
INNER JOIN items ON scales.id = items.scale_id 
```

如果您想使用嵌套循环进行迭代，您需要将此数据拉入一个数组 - 希望您不会拉回太多以至于它会占用太多内存。

```
$scales = array();

while ($row = mysql_fetch_assoc($data))
{
    if (!isset($scales[$row['scale_id']]))
    {
        $row['items'] = array();
        $scales[$row['scale_id']] = $row;
    }

    $scales[$row['scale_id']]['items'][] = $row;
} 
```

然后你可以循环遍历：

```
foreach ($scales as $scale)
{
    foreach ($scale['items'] as $item)
        ; //... do stuff
} 
```

注意：这有点天真，因为 $scale 和 $item 都将包含来自两个表的字段......如果这是一个问题，那么您需要更改上面循环中的分配以仅提取您想要的字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T19:19:45.587

首先获得所有秤，然后获得所有项目可能更容易。

```
//first get scales
while ($row = fetchrowfunctionhere()) {
    $scale = $scales->createFromArray($row);
}

//then get items
$lastId = null;
while ($row = fetchrowfunctionhere()) {
    $scaleId = $row['scaleID'];
    if ($lastId != $scaleId) {
        $scale = $scales->getByScaleId($scaleId);
    }
    $item = $items->createFromArray($row);
    $scale->addItem($item);
    $lastId = $scaleId;
} 
```

或一个 sql 中的所有内容

```
$lastId = null;
while ($row = fetchrowfunctionhere()) {
    $scaleData = array_slice($row, 0, 5, true);
    $itemData = array_slice($row, 5, 5, true);
    $scaleId = $scaleData['scaleID'];
    if ($lastId != $scaleId) {
        $scale = $scales->createFromArray($scaleData);
    }
    $item = $items->createFromArray($itemData);
    $scale->addItem($item);
    $lastId = $scaleId;
} 
```

一切都像一个快乐的阵列

```
while ($row = fetchrowfunctionhere()) {
    $scaleData = array_slice($row, 0, 5, true);
    $itemData = array_slice($row, 5, 5, true);
    $scaleId = $scaleData['scaleID'];
    if (!isset($scales[$scaleId])) {
        $scales[$scaleId] = $scaleData;
    }
    $itemId = $itemData['itemID'];
    $scales[$scaleId]['items'][$itemId] = $itemData;
} 
```

# visual-studio-2008 - 尝试添加 ajax TabContainer，出现错误“无法修改控件集合，因为控件包含代码块（即 <% ... %>）。”

> ID：357138
> 
> 赞同：1
> 
> 时间：2008-12-10T18:53:40.553
> 
> 标签：visual-studio-2008, ajaxcontroltoolkit

我想在我的网页中添加一个 ajax:TabContainer。我没有收到任何构建错误，但是当我尝试浏览到该页面时，它给了我错误：“无法修改 Controls 集合，因为控件包含代码块（即 <% ... %>）。” .

我为示例站点重新下载了 Ajax Control Toolkit，在 VS 中打开了解决方案，为 TabContainer 运行了示例，它运行良好。我认为这可能是 Ajax Control Toolkit 的不同版本——但不是。两个站点引用的 AjaxControlToolkit.dll 文件是相同的。为什么我不能让 TabContainer 在我的网站上工作？

还有一个问题，但我不知道它是否相关。我最近刚刚安装了 Visual Studio 2008。打开我的网站后，VS 自动在工具箱中创建了“AJAX 控件”选项卡，并在其中填充了所有 ajax 控件。在源代码中，所有控件都以“ajax”为前缀——即“< ajax:TabContainer runat="server" ... >”。

但是，当我打开示例网站时，Visual Studio 在工具箱中创建了另一个选项卡 - “AjaxControlToolkit 组件”，其中填充了与“AJAX 控件”中相同的所有控件。我不知道为什么它两次添加了相同的控件（但奇怪的是，工具箱中有不同的图标）。在源代码中，所有控件都以“ajaxToolkit”为前缀——即“< ajaxToolkit:TabContainer runat="server" ... >”。这里发生了什么？我只想让该死的 TabContainer 在我的网站上工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-29T13:21:31.423

您不能在使用标准服务器呈现的控件内使用 <%= %> (write) 块 - 您会收到此错误。

为了让 ASP AJAX 组件正常工作，您需要：

```
<head runat="server">... 
```

否则它也会因此错误而崩溃。

但是，您可以在这些服务器控件中进行*数据绑定：*

```
<head runat="server">
    <link rel="stylesheet" type="text/css" 
        href="<%# ResolveUrl( "~/styles/common.aspx" ) %>" />
... 
```

然后在您的页面加载中：

```
Page.Header.DataBind(); 
```

发生错误的原因是 ASP WebForms 将控件呈现为组件集合的方式 - 它们可以处理集合（并且期望数据绑定 <%#）或文字写入（并且期望 <%=），但不能同时处理两者。

永久避免此问题的最佳方法是切换到 ASP MVC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T18:57:29.750

此错误并非特定于 Ajax。

您可以尝试将您的 ajax:TabContainer 放在 asp:Panel 中。或者，从您的页面中删除 <% ...%> 代码块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T20:57:14.457

我想通了！

如果您在`<head>`包含`<script>`标签时尝试使用 AJAX 控件，则会收到此错误消息。

我刚刚将 JavaScript 移到正文中，现在它似乎工作正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-25T08:58:02.990

嘿，伙计们，这不仅是 javascript 标记，还包括页面头部标记中使用 <%= %> 或 <% Response.Write %> 的任何内容。更改代码以使用数据绑定指令 <%# eval( *some code* ) %> 或将内容移至正文（这对于加快页面的加载时间也很有用）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-04T15:43:03.030

Pragnesh，检查任何 javascript 的 HEAD 标记。我有一些带有 <%%> 代码块的 javascript，这些代码块阻止了 AJAX 选项卡控件的工作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-25T11:19:31.423

无需做任何事情，只需保留 <%=....%> 母版页中的部分代码

# .net - 获取 SQL Server CLR 运行时中引发的错误的行号

> ID：357145
> 
> 赞同：2
> 
> 时间：2008-12-10T18:56:12.530
> 
> 标签：.net, sql-server, error-handling, clr

我创建了一个在 SQL 2k5 上运行的 CLR 存储过程，我想知道是否有任何方法可以获取 .NET 代码引发的异常的行号。当抛出异常时，我会得到类似的东西

消息 6522，级别 16，状态 1，过程 myProcedure，第 0 行在执行用户定义的例程或聚合“myProcedure”期间发生 .NET Framework 错误：System.Exception：测试异常 System.Exception：在 DummyDLL.myProcedure（String dummyInput ) .

有什么方法可以加载程序集来给我特定的行号，而不仅仅是引发错误的函数？程序集本身是用 .pdb 编译的，但是当我最初加载程序集时，SQL 2k5 似乎没有读取它。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T03:53:39.937

I'm not sure if registering the PDB as well will give you line numbers (theoretically, it should though).

Are you sure you are registering your PDB correctly? The following tells you how to do so:

[http://blogs.msdn.com/ericnel/archive/2005/03/18/398534.aspx](http://blogs.msdn.com/ericnel/archive/2005/03/18/398534.aspx)

Basically, the syntax is:

```
CREATE ASSEMBLY Asm1 FROM 'MyAssembly.dll'
GO
ALTER ASSEMBLY Asm1 ADD FILE FROM 'MyAssembly.pdb'
GO 
```

# .net - 如何让 Visual Studio 2005 调用 WCF 服务？

> ID：357159
> 
> 赞同：1
> 
> 时间：2008-12-10T19:00:00.807
> 
> 标签：.net, visual-studio, wcf

如何让 Visual Studio 2005 调用 WCF 服务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T19:02:06.153

是的，使用 wsHttpBinding 会将服务公开为标准 Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T19:36:00.127

Yes you can.

*   If you have .NET 3.0 or 3.5 installed, you can add references to the WCF assemblies (System.ServiceModel.dll etc) which are in the directory "%WINDIR%\Microsoft.NET\Framework\v3.0\Windows Communication Foundation". Visual Studio 2005 does not include the svcutil utility that generates a WCF proxy, but you can download this (it comes with the Windows SDK), or use WCF without a generated proxy (e.g. by using the ChannelFactory<T> class).

*   Or you can add a web reference to a WCF service that uses the basicHttpBinding, as suggested by Jeremy Lew.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T19:06:51.963

您需要使用基本的 HTTP 绑定。有关详细信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/ms751433.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T09:09:45.320

只是为了防止某些人查找此问题-您曾经能够将 CTP 版本的 WCF 扩展下载到 VS 2005，但这从未超出 CTP 参见[此线程](https://stackoverflow.com/questions/243843/visual-studio-2005-extensions-for-net-framework-30-wpf)

如果您只想尝试一些东西，仍然可以在非 ms 站点中获得这些，但毫无疑问，正确的方法是使用 basicHttpBinding 并将该服务作为“普通”Web 服务使用或移至 Visual工作室 2008。

# caching - phpbb3 缓存问题

> ID：357161
> 
> 赞同：1
> 
> 时间：2008-12-10T19:00:25.160
> 
> 标签：caching, templates, phpbb3

我在 phpbb3 中缓存模板时遇到问题。我在管理控制面板中对模板进行了更改并保存了它，然后通过“清除缓存”清除了模板缓存，我没有看到论坛上反映的更改，但更改已保存在管理控制面板中。接下来我手动编辑了模板文件（不是通过管理控制面板）并上传了我更改的模板文件并从缓存目录中删除了所有文件，我仍然看不到任何更改。谁能告诉我还有其他地方存储缓存文件吗？此外，当我尝试通过样式部分的管理控制面板删除特定文件的缓存并选择“缓存”链接时，页面显示它已被删除，但缓存似乎仍然存在。谁能告诉我是否有' s多个地方存放缓存文件？？想法？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-09T15:22:07.740

我意识到这是一个非常古老的帖子，但是这个周末我遇到了同样的问题，所以很抱歉把它带回来......

如果您从 ACP 编辑样式并且 phpBB3 无法写入*整个*样式文件夹，它会将整个样式复制到数据库，现在它会覆盖服务器上的文件。“清除缓存”按钮现在将恢复为**存储在数据库中的版本**

要解决此问题，请返回您编辑样式的 ACP，然后单击“导出”按钮以在文件版本中获取样式的修改版本，然后单击“刷新”按钮。这将破坏样式的数据库版本。

现在，由于您可能*需要*这些更改，请将样式文件替换为您刚刚下载的文件。对这些文件进行任何进一步的更改，再次清除缓存，并远离 ACP 中的“编辑”按钮，除非这是您编辑样式的**唯一方法。**

# c# - 内存映射文件 .NET

> ID：357170
> 
> 赞同：13
> 
> 时间：2008-12-10T19:02:51.440
> 
> 标签：c#, .net, asp.net, memory-mapped-files

我有一个项目，它需要访问 ASP.NET 中的大量专有数据。这是在 Linux/PHP 上通过将数据加载到共享内存中来完成的。我想知道是否尝试使用内存映射文件是可行的方法，或者是否有更好的方法来提供更好的 .NET 支持。我正在考虑使用数据缓存，但不确定保存在缓存中的数据大小的所有缺陷。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-04-27T11:29:42.463

我知道这有点晚了，但是 .NET 4.0 框架现在支持开箱即用的内存映射文件：

[http://blogs.msdn.com/salvapatuel/archive/2009/06/08/working-with-memory-mapped-files-in-net-4.aspx](http://blogs.msdn.com/salvapatuel/archive/2009/06/08/working-with-memory-mapped-files-in-net-4.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-10T19:12:14.993

如果您正在寻找 C# 的内存映射库，请查看[Tomas Restrepo 的文件映射](http://github.com/tomasr/filemap/tree/master)包装器。它在 LGPL 下获得许可。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T19:13:11.297

当您拥有大量数据并且不想承担跨进程边界封送数据的成本时，可以使用内存映射文件。我已经将它用于类似的目的。您需要对 .NET 中的不安全和固定内存概念相当熟悉才能利用 MMF。 [显然](http://msmvps.com/blogs/manoj/archive/2003/12/05/973.aspx)，企业库的缓存块包含包装底层 C# API 的代码。我在其他地方至少看到过另一种实现。

如果您可以忍受编组成本，那么使用某种 .NET 远程解决方案可能更容易、更优雅。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T19:14:25.893

您可能只想将其放入 Cache[] 对象中。您可以根据真实文件设置缓存过期时间。然后，每当您修改实际文件时，缓存中对象的内容将为空，您可以重新加载它。如果您要处理大量字节，这可能不合适。

```
byte[] fileBytes = Cache["fileBytes"];
if (null == fileBytes) {
   // reload the file and add it to the cache.
   string fileLocation = Server.MapPath("path/to/file.txt");
   // Just a same of some bytes.
   fileBytes = new byte[10];
   Cache.Insert(fileLocation, fileBytes, new System.Web.Caching.CacheDependency(fileLocation));
} 
```

我想我没有关于缓存和大量数据的性能特征的具体答案。 [http://www.alachisoft.com/ncache/asp-net-cache.html](http://www.alachisoft.com/ncache/asp-net-cache.html)声明您获得了 2 到 3 GB 的缓存空间，这些空间必须在您的应用程序和缓存之间共享。

# asp.net - .net 3.5，是否需要重新启动计算机才能正常工作？

> ID：357176
> 
> 赞同：2
> 
> 时间：2008-12-10T19:04:23.730
> 
> 标签：asp.net, .net-3.5, restart

嘿，伙计，我需要知道在安装后是否需要重新启动计算机才能让 .net 3.5 与我的 Web 应用程序一起使用。我的服务器机器正在使用 IIS。在我的本地机器上，Web 应用程序运行良好。当我在服务器上浏览它时，我看到了诸如找不到 Linq 程序集之类的错误……即使引用在 web.config 文件中，并且对于我使用时髦的 no 字段定义属性的类的引用生成方式，编译器抱怨说我需要指定那些字段（同样，当我构建 Web 应用程序时，这不会发生在本地机器上）。对此的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T19:07:36.783

这可能会有所帮助（将最新版本加载到 IIS 中）：

使用命令窗口，在 C:\Windows\Microsoft.Net\Framework\ 下访问最新版本的 .net 现在运行以下命令：“net stop w3svc”以停止 Web 服务。然后使用“aspnet_regiis.exe -ua”从 IIS 中卸载所有 ASP.NET 实例。使用“aspnet_regiis.exe -i”将 ASP.NET 安装到 IIS 中。现在使用“net start w3svc”重新启动 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T19:08:06.237

您可能忘记将服务器上的站点的 .net 版本设置为 3.5；如果你不重置它，我认为它默认为 1.1 或 2.0

（IIS 维护实用程序可以做到这一点）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T19:59:39.033

如果您使用的是 IIS7，则不需要运行 aspnet_regiis 实用程序。

# c# - ASP.NET/C# - 从其他服务器检测文件大小？

> ID：357190
> 
> 赞同：4
> 
> 时间：2008-12-10T19:08:08.200
> 
> 标签：c#, asp.net

我正在尝试查找服务器上文件的文件大小。我[从这个人](http://www.thejackol.com/2005/06/11/aspnet-get-file-size/)那里得到的以下代码为你自己的服务器完成了这个任务：

```
string MyFile = "~/photos/mymug.gif";

FileInfo finfo = new FileInfo(Server.MapPath(MyFile));
long FileInBytes = finfo.Length;
long FileInKB = finfo.Length / 1024;

Response.Write("File Size: " + FileInBytes.ToString() + 
  " bytes (" + FileInKB.ToString() + " KB)"); 
```

有用。但是，我想找到文件大小，例如：

```
string MyFile = "http://www.google.com/intl/en_ALL/images/logo.gif";

FileInfo finfo = new FileInfo(MyFile); 
```

然后我得到一个讨厌的错误说`URI formats are not supported.`

如何使用 ASP.NET 找到 Google 徽标的文件大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T19:15:08.217

您可以使用`WebRequest`该类向服务器发出 HTTP 请求并读取`Content-Length`标头（您可能使用 HTTP`HEAD`方法来完成它）。但是，并非所有 Web 服务器都以`Content-Length`标头响应。在这些情况下，您必须接收所有数据才能获得大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T19:10:50.037

要获取此值，您必须首先在本地下载文件，然后您可以使用标准方法获取其大小。

# sql - 使用 try/catch 进行更新

> ID：357203
> 
> 赞同：3
> 
> 时间：2008-12-10T19:11:30.893
> 
> 标签：sql, sql-server, sql-server-2005

因为我是新手，所以我试图注销我编写的存储过程可能发生的任何错误。我了解 SQL 2005 中的 Try/Catch 以及 error_procedure()、ERROR_MESSAGE() 和其他内置函数。我不知道该怎么做是捕获导致更新错误的记录。

我可能可以使用游标并一次循环并更新一行。然后在循环中设置一个值并报告该值。但这似乎违背了使用 SQL 的目的。

任何关于在哪里研究这个问题的想法或指针都非常感谢。我不完全理解 RowNumber() 我可以以某种方式使用它吗？这里有点抓稻草。

欢呼和感谢

鲍勃

我正在使用 SQL 2005。

编辑

我真的不想在大多数情况下使用事务，因为它只是用于报告目的。所以我正在做的一个例子是：

```
/******************************************************************************
   Now get update the table with the current worker.  That depends on the
   current status of the loan.
******************************************************************************/

UPDATE #table SET currWorker = tblUser.UserLogonName
      FROM tblUser
            JOIN tblLoanInvolvement ON tblLoanInvolvement.invlUnderwriterDeptID = tblUser.userID 
            WHERE tblLoanInvolvement.LOANid = #table.loanid
            AND #table.currstatus in('R_UW_Approved','R_Submitted to Underwriting')

  UPDATE #table SET currWorker = tblUser.UserLogonName
  FROM tblUser
        JOIN tblLoanInvolvement ON tblLoanInvolvement.invlProcessorID  = tblUser.userID 
        WHERE tblLoanInvolvement.LOANid = #table.loanid
        AND #table.currstatus in('R_UW Approved With Conditions','R_Loan Resubmitted','R_UW_Suspended','R_Submitted to Processing')

  UPDATE #table SET currWorker = tblUser.UserLogonName
  FROM tblUser
        JOIN tblLoanInvolvement ON tblLoanInvolvement.invlCloserID = tblUser.userID 
        WHERE tblLoanInvolvement.LOANid = #table.loanid
        AND #table.currstatus in('R_Docs Out','R_Ready to Close','R_Scheduled to Close and Fund','Scheduled To Close') 
```

因此，如果某一行没有正确更新，我不想放弃整个事情。但是知道导致问题的#table.loanid 的值会非常方便。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T19:48:04.737

像这样的 try/catch 块......

```
BEGIN TRY
    -- Your Code Goes Here --
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() AS ErrorNumber,
        ERROR_SEVERITY() AS ErrorSeverity,
        ERROR_STATE() AS ErrorState,
        ERROR_PROCEDURE() AS ErrorProcedure,
        ERROR_LINE() AS ErrorLine,
        ERROR_MESSAGE() AS ErrorMessage
END CATCH 
```

...将帮助您找到 SQL*代码*中的问题。如果这是在存储过程中，您还可以返回参数（即添加一个 SELECT @RecordID AS [RecordID] 到 catch 块中的该列表）。但是，如果您在实际数据方面遇到问题，我建议您考虑添加外键和其他约束以保护数据库的逻辑完整性。理想情况下，您至少不能将数据放入数据库，这会破坏您的存储过程。

编辑

参考您最近的编辑，如果您将 UPDATE 放在存储过程中并捕获错误，然后用对该过程的调用替换您的更新系列，剩余的更新将继续，您可以在其中返回/跟踪/记录错误SP 的 catch 块，但是你希望。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-10T19:46:48.030

替代方案：使用事务和 @@IDENTITY 怎么样？

```
DECLARE @problemClientID INT
BEGIN TRANSACTION

    UPDATE ... --etc

    IF @@ERROR <> 0
    BEGIN
        ROLLBACK TRANSACTION
        SET @problemClientID = @@IDENTITY
        PRINT N'There was a problem...' --etc
    END
    ELSE
    BEGIN
        -- transaction was a success, do more stuff?
    END
COMMIT TRANSACTION 
```

# ruby-on-rails - Rails：将 HTML 转换为 PDF？

> ID：357212
> 
> 赞同：62
> 
> 时间：2008-12-10T19:12:55.260
> 
> 标签：ruby-on-rails, pdf

获取 HTML 并将其转换为 PDF 的最佳和最简单的方法是什么，类似于在 ColdFusion 上使用 CFDOCUMENT？

**更新：**我非常感谢到目前为止人们给出的所有评论和建议，但是我觉得留下答案的人没有抓住重点。

1) 解决方案必须是免费或开源的。一个人建议使用pricexml，另一个人建议使用pd4ml。这两种解决方案都需要花钱（pricexml 花费了一条胳膊和一条腿），我不是为了分叉。

2) 他们必须能够接收 html（来自文件、url 或字符串变量），然后生成 pdf。prawn、rprf、rtex 等库是使用它们自己的方法生成的，而不是使用 html。

请不要认为我对这些建议忘恩负义，只是对于像我这样使用 ColdFusion 但想转换为 Rails 的人来说，生成 PDF 似乎是一个真正的问题。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-12-05T20:55:41.010

宝石[WickedPDF](https://github.com/mileszs/wicked_pdf)*正是*这样做的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-04-09T17:29:28.633

现在最棒的事情是 PDFKit 用于这项工作：

*   [https://github.com/pdfkit/PDFKit](https://github.com/pdfkit/PDFKit)
*   [http://railscasts.com/episodes/220-pdfkit](http://railscasts.com/episodes/220-pdfkit)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-10-07T12:26:12.697

[试试 WickedPDF](https://github.com/mileszs/wicked_pdf)，PDF 生成器（来自 HTML）插件。

这是示例

```
gem 'wicked_pdf'  
gem 'wkhtmltopdf-binary' 
#wicked_pdf is a wrapper for wkhtmltopdf, you'll need to install that, too 
```

在你的控制器中（我想你在 show 方法中）：

```
 respond_to  do |format|
      format.html
      format.pdf do
        pdf = render_to_string :pdf => 'test',
                         layout: 'pdf.html.erb',
                         template: 'show.pdf.slim',
                         header: { :right => '[page] of [topage]'},
                         margin: {top: 0,
                                  bottom: 0,
                                  left: 0,
                                  right: 0},
                         outline: {outline: true,
                                   outline_depth: 2}
        end
     end 
```

在您查看 PDF 链接

```
= link_to 'Download Pdf', you_show_path(@uour_object, format: :pdf) 
```

如果您想在电子邮件附件中发送 pdf，首先将您的 pdf 文件保存在 public 或 temp 文件夹中，然后保存在 mailer 类中（例如在 mailers/e_mailer.rb 中）

```
attachments["test.pdf"] = File.read(Rails.root.join('public',"test.pdf"))
mail(:to => to, :cc => cc , :subject => "subject") 
```

发送电子邮件后，您可以删除文件

```
File.delete(Rails.root.join("public", "test.pdf")) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-05T17:30:43.497

我知道这个问题在这一点上已经有将近 5 年的历史了。但是，有新的选项可用。

试试虾！[https://github.com/aven/shrimp](https://github.com/adeven/shrimp)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T14:43:45.507

经过大量的汗水和眼泪，我设法编写了一个非常简单的 Rails 应用程序，允许用户通过[TinyMce](http://github.com/kete/tiny_mce/tree/master)编写字母模板，然后将这些模板保存并可以作为 pdf 文档查看。

我决定尽可能地限制所见即所得编辑器中的选项，因为某些选项不能完全按预期工作，但如果需要，这不是一个小 gsub-ing 无法解决的问题。

有一个包装 HTMLDOC 的 ruby​​ gem，你需要它：[PDF::HTMLDoc](http://htmldoc.rubyforge.org/)

完成后，注册 mime 类型，然后您可以执行以下操作：

```
@letter_template = LetterTemplate.find(params[:id])

respond_to do |format|
      format.html
      format.pdf { send_data render_to_pdf({:action => 'show.rpdf',  :layout => 'pdf_report'}), :filename => @letter_template.name + ".pdf",  :disposition => 'inline' }
    end 
```

在应用程序控制器中，我添加了 render_to_pdf 方法，例如：

```
def render_to_pdf(options =nil)
    data = render_to_string(options)
    pdf = PDF::HTMLDoc.new
    pdf.set_option :bodycolor, :white
    pdf.set_option :toc, false
    pdf.set_option :portrait, true
    pdf.set_option :links, false
    pdf.set_option :webpage, true
    pdf.set_option :left, '2cm'
    pdf.set_option :right, '2cm'
    pdf.set_option :footer, "../"
    pdf.set_option :header, "..."
    pdf.set_option :bottom, '2cm'
    pdf.set_option :top, '2cm'
    pdf << data
    pdf.generate
  end 
```

您可以在 Travis Beale 链接到的 HTMLDOC 站点上找到更多文档。希望这对您有所帮助，除非您的文件真的很复杂，否则就足够了。让我们知道您的身体情况如何。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T13:11:42.257

我发现作为“解决方案”的最接近的方法是使用 JRuby，然后使用[The Flying Saucer Project](http://xhtmlrenderer.dev.java.net/)。我只是希望它能够被移植到 Ruby 上，这样它就可以成为一个原生解决方案。上帝，我希望我在 Java 方面做得更好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T17:16:49.300

*   有一个[RPDF](http://rubyforge.org/projects/railspdfplugin/)，您可以在其中将您的 pdf 描述为一个视图。
*   还有使用 (La)TeX 生成 pdf 的[RTEX 。](http://rtex.rubyforge.org/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-05T23:54:14.977

该项目可能已经停滞，但 Pisa（又名[XHTML2PDF](http://www.xhtml2pdf.com/)）是一个 Python 库，可以将 CSS+HTML 转换为 PDF。不久前，通过将它作为命令行工具驱动它在（低流量）Rails 应用程序中使用它——效果很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-01T09:27:28.203

我想通过[https://grabz.it](https://grabz.it)向您推荐 HTML 到 PDF 的解决方案。

它们有一个非常灵活且易于使用的屏幕截图 API，任何类型的 Ruby 应用程序都可以使用它。

如果你想尝试，首先你应该得到授权[app key + secret](https://grabz.it/api/#Key)和[开发免费SDK](https://grabz.it/api/ruby/download.aspx)

然后，在您的应用程序中，实施步骤将是：

```
//initialization    
require 'grabzit'
grabzItClient = GrabzIt::Client.new("APPLICATION KEY", "APPLICATION SECRET")

//capturing the url to PDF
grabzItClient.url_to_pdf("http://www.google.com") 
```

接下来是储蓄。`save`如果可访问的回调句柄可用，您可以使用两种保存方法之一：

```
grabzItClient.save("http://www.example.com/handler/index") 
```

如果`save_to`您需要同步保存（这将迫使您的应用程序在创建屏幕截图时等待）：

```
filepath = "images/result.jpg"
grabzItClient.save_to(filepath) 
```

[有关保存的详细信息](https://grabz.it/api/ruby/)，请查看文档。

就这样。也可以获得其他类型的屏幕截图，例如[图像屏幕截图](https://grabz.it/api/ruby/)。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-10T19:21:52.073

如果你想拥有真正好的质量（想想，适当的布局/CSS 等），你需要创建一个嵌入真正的网络浏览器的进程，将其呈现在屏幕外并通过 PDF 打印机驱动程序打印。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-10T19:44:36.177

在 Ruby 中肯定没有直接的方法可以做到这一点（至少几个月前我尝试这样做时没有）。如果您真的无法避免从 html 生成 pdf，您可能应该为此寻找一些外部工具或服务。

祝你好运！

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-12-17T19:15:32.367

我正在尝试来自 www.pd4ml.com 的库

这是一个代码片段....

我将 html 拉入字符串内容。然后我做了几件事，比如用复选框替换单选按钮，然后通过 pd4ml 库运行它来呈现 pdf。
结果看起来很像原始页面......

```
 String content = nextPage.generateResponse().contentString();

    content = content.replace("Print", "");
    content = content.replace("Back", "");

    content = content.replace("border=\"1\"", "border=\"0\"");
    content = content.replace("radio", "checkbox");

    java.net.InetAddress i = java.net.InetAddress.getLocalHost();
    String address =  i.getHostAddress()+":53000";

    content = content.replace("img src=\"/cgi-bin", "img src=\"http://"+address+"/cgi-bin");

    System.out.println(content);

    PD4ML html = new PD4ML();
    html.setPageSize( new java.awt.Dimension(650, 700) );
    html.setPageInsets( new java.awt.Insets(30, 30, 30, 30) );
    html.setHtmlWidth( 750 );
    html.enableImgSplit( false );
    html.enableTableBreaks(true);

    StringReader isr = new StringReader(content);
    baos = new ByteArrayOutputStream();
    html.render( isr, baos);
    PDFRegForm pdfForm = (PDFRegForm)pageWithName("PDFRegForm");
    pdfForm.baos = baos;
    pdfForm.generateResponse(); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-12-17T20:09:54.083

您是否尝试过查看 html2pdf？主页是[http://html2pdf.seven49.net/Web/](http://html2pdf.seven49.net/Web/)

它还有一个 sourceforge 项目。

艾伦

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-06-10T19:56:12.833

[文档](https://www.msweet.org/projects.php?Z1)？

*   将 HTML 转换为 PDF；
*   免费和开源（提供商业支持）；
*   可以用作...
    *   ...独立应用程序，
    *   ...对于批处理文档，
    *   ...或作为基于 Web 的服务运行；
*   界面是 CLI 或 GUI。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-05-08T13:26:58.203

不特定于 Ruby，但我发现的最佳解决方案是开源[HTMLDOC](https://www.msweet.org/projects.php?Z1 "HTMLDOC")。

# c++ - 我认为 STL 导致我的应用程序的内存使用量增加了三倍

> ID：357243
> 
> 赞同：2
> 
> 时间：2008-12-10T19:20:12.623
> 
> 标签：c++, memory, memory-leaks, stl

我在我的应用程序中输入了一个 200mb 的文件，由于一个非常奇怪的原因，我的应用程序的内存使用量超过了 600mb。我已经尝试过vector和deque，以及std::string和char *，但无济于事。我需要我的应用程序的内存使用与我正在阅读的文件几乎相同，任何建议都会非常有帮助。是否存在导致如此多内存消耗的错误？你能查明问题还是我应该重写整个事情？

Windows Vista SP1 x64, Microsoft Visual Studio 2008 SP1, 32Bit Release Version, Intel CPU

到目前为止的整个应用程序：

```
#include <string>
#include <vector>
#include <iostream>
#include <iomanip>
#include <fstream>
#include <sstream>
#include <iterator>
#include <algorithm>
#include <time.h>

static unsigned int getFileSize (const char *filename)
{
    std::ifstream fs;
    fs.open (filename, std::ios::binary);
    fs.seekg(0, std::ios::beg);
    const std::ios::pos_type start_pos = fs.tellg();
    fs.seekg(0, std::ios::end);
    const std::ios::pos_type end_pos = fs.tellg();
    const unsigned int ret_filesize (static_cast<unsigned int>(end_pos - start_pos));
    fs.close();
    return ret_filesize;
}
void str2Vec (std::string &str, std::vector<std::string> &vec)
{
    int newlineLastIndex(0);
    for (int loopVar01 = str.size(); loopVar01 > 0; loopVar01--)
    {
        if (str[loopVar01]=='\n')
        {
            newlineLastIndex = loopVar01;
            break;
        }
    }
    int remainder(str.size()-newlineLastIndex);

    std::vector<int> indexVec;
    indexVec.push_back(0);
    for (unsigned int lpVar02 = 0; lpVar02 < (str.size()-remainder); lpVar02++)
    {
        if (str[lpVar02] == '\n')
        {
            indexVec.push_back(lpVar02);
        }
    }
    int memSize(0);
    for (int lpVar03 = 0; lpVar03 < (indexVec.size()-1); lpVar03++)
    {
        memSize = indexVec[(lpVar03+1)] - indexVec[lpVar03];
        std::string tempStr (memSize,'0');
        memcpy(&tempStr[0],&str[indexVec[lpVar03]],memSize);
        vec.push_back(tempStr);
    }
}
void readFile(const std::string &fileName, std::vector<std::string> &vec)
{
    static unsigned int fileSize = getFileSize(fileName.c_str());
    static std::ifstream fileStream;
    fileStream.open (fileName.c_str(),std::ios::binary);
    fileStream.clear();
    fileStream.seekg (0, std::ios::beg);
    const int chunks(1000); 
    int singleChunk(fileSize/chunks);
    int remainder = fileSize - (singleChunk * chunks);
    std::string fileStr (singleChunk, '0');
    int fileIndex(0);
    for (int lpVar01 = 0; lpVar01 < chunks; lpVar01++)
    {
        fileStream.read(&fileStr[0], singleChunk);
        str2Vec(fileStr, vec);
    }
    std::string remainderStr(remainder, '0');
    fileStream.read(&remainderStr[0], remainder);
    str2Vec(fileStr, vec);      
}
int main (int argc, char *argv[])
{   
        std::vector<std::string> vec;
        std::string inFile(argv[1]);
        readFile(inFile, vec);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T19:41:16.903

你的记忆正在支离破碎。

尝试这样的事情：

```
 HANDLE heaps[1025];
  DWORD nheaps = GetProcessHeaps((sizeof(heaps) / sizeof(HANDLE)) - 1, heaps);

  for (DWORD i = 0; i < nheaps; ++i) 
  {
    ULONG  HeapFragValue = 2;
    HeapSetInformation(heaps[i],
                       HeapCompatibilityInformation,
                       &HeapFragValue,
                       sizeof(HeapFragValue));
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T19:45:04.710

如果我没看错的话，最大的问题是该算法会自动将所需内存翻倍。

在 ReadFile() 中，您将整个文件读入一组“singleChunk”大小的字符串（块），然后在 str2Vec() 的最后一个循环中，为块的每个换行符分隔段分配一个临时字符串。所以你在那里将内存加倍。

您还遇到了速度问题 - str2vec 对块进行了 2 次遍历以找到所有换行符。没有理由你不能做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T20:15:03.870

STL 容器的存在是为了抽象出内存操作。如果你有一个硬内存限制，那么你就不能真正将它们抽象出来。

我建议使用`mmap()`在（或在 Windows 中`MapViewOfFile()`）中读取文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T20:25:38.623

您可以做的另一件事是将整个文件加载到一个内存块中。然后制作一个指向每行第一个字符的指针向量，同时用 \0 替换换行符，使其以空值结尾。（当然假设你的字符串不应该有 \0 。）

它不一定像拥有一个字符串向量那样方便，但拥有一个 const char* 向量可能“一样好”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T19:40:20.850

在 readFile 中，您至少有 2 个文件副本 - ifstream 和复制到 std::vector 中的数据。只要您打开文件，并且像以前一样复制它，就很难将总内存占用降低到文件大小的两倍以下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T19:48:48.837

1.  不要使用 std::list。它需要比向量更多的内存。
2.  vector 执行所谓的“加倍”，即，当空间不足时，它分配的内存是当前内存的***两倍。***为了避免它，您可以使用 std::vector:: **reserve** () 方法，如果我没记错的话，您可以使用 std::vector:: **capacity** () 方法检查它（注意 capacity() >= size() ）。

由于在执行过程中不知道行数，我看不到简单的算法可以避免“加倍”问题。根据 slavy13.myopenid.com 的评论，解决方案是在完成阅读后将信息移动到另一个保留的向量（相关问题是[如何缩小 std::vector？](https://stackoverflow.com/questions/253157/how-to-downsize-stdvector)）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-10T19:49:16.323

首先，您如何确定内存使用情况？任务管理器*不是*一个合适的工具，因为它显示的实际上并不是内存使用情况。

其次，除了您的（出于某种原因？）静态变量之外，在您完成读取文件时唯一没有被释放的数据是向量。所以测试它的容量，测试它包含的每个字符串的容量。找出他们每个人使用了多少内存。您拥有确定内存使用位置的工具。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-11T05:03:57.610

我认为您尝试编写自己的缓冲策略是错误的。

流已经实现了非常好的缓冲策略。如果您认为需要更大的缓冲区，您可以将基本缓冲区安装到流中，而无需任何额外的代码来控制缓冲区。

这是我想出的： NB 用我在网上找到的“国王詹姆斯圣经”的文本版本进行了测试。

```
#include <string>
#include <vector>
#include <list>
#include <fstream>
#include <algorithm>
#include <iterator>
#include <iostream>

class Line: public std::string
{
};

std::istream& operator>>(std::istream& in,Line& line)
{
    // Relatively efficient way to copy a line into a string.
    return std::getline(in,line);
}
std::ostream& operator<<(std::ostream& out,Line const& line)
{
    return out << static_cast<std::string const&>(line) << "\n";
}

void readLinesFromStream(std::istream& stream,std::vector<Line>& lines)
{
    /*
     * Read into a list as this is flexible in memory usage and will not
     * allocate huge chunks of un-required space.
     *
     * Even with huge files the space for list will be insignificant
     * compared to the size of the data.
     *
     * This then allows us to reserve the correct size of the vector
     * Thus avoiding huge memory chunks being prematurely allocated that
     * are not required. It also prevents the internal structure from
     * being copied every time the container is re-sized.
     */
    std::list<Line>     data;
    std::copy(  std::istream_iterator<Line>(stream),
                std::istream_iterator<Line>(),
                std::inserter(data,data.end())
             );

    /*
     * Reserve the correct size in the vector.
     * then copy out of the list into the vector
     */
    lines.reserve(data.size());
    std::copy(  data.begin(),
                data.end(),
                std::back_inserter(lines)
             );
}

void readLinesFromFile(std::string const& name,std::vector<Line>& lines)
{
    /*
     * Set up the file stream and override the default buffer used by the stream.
     * Make it big because we think the istream buffer is insufficient!!!!
     */
    std::ifstream       file;
    std::vector<char>   buffer(10000);
    file.rdbuf()->pubsetbuf(&buffer[0],buffer.size());

    file.open(name.c_str());
    readLinesFromStream(file,lines);
}

int main(int argc,char* argv[])
{
    std::vector<Line>   lines;
    readLinesFromFile(argv[1],lines);

    // Un-comment if your file is larger than 1100 lines.

    // I tested with a copy of the King James bible. 
    // std::cout << "Lines: " << lines.size() << "\n";
    // std::copy(lines.begin() + 1000,lines.begin() + 1100,std::ostream_iterator<Line>(std::cout));
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-10T19:32:21.163

尝试使用列表而不是向量。向量（几乎总是）在内存中是线性的。

诚然，你有字符串，这些字符串（几乎总是）在修改时复制，引用计数应该减少这个问题，但它可能会有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-10T19:32:51.490

我不知道这是否相关，因为我真的不知道您的文件是什么样的。

但是您应该知道，在存储非常短的字符串时，std::string 可能会产生相当大的空间开销。而且，如果您为非常短的字符串单独更新 char*，您还将看到所有分配块开销。

您将多少个字符串放入该向量中，它们的平均长度是多少？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-11T05:43:28.277

也许您应该详细说明为什么需要读取内存中的整个文件，我怀疑可能有一种方法可以做您想做的事情，而无需一次将整个文件读入内存。如果您真的需要此功能，请查看内存映射文件，这可能比您编写等效文件更有效率。然后，您的内部数据结构可以在文件中使用偏移量。顺便说一句，一定要看看你是否需要处理字符编码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-11T05:49:08.937

您应该知道，因为您声明`fileStream`为`static`，所以它永远不会超出范围，这意味着文件直到执行的最后一刻才关闭。这肯定会涉及**一些**记忆。您可以在最后一次之前明确关闭它`str2Vec`以尝试帮助解决这种情况。

此外，您多次打开和关闭同一个文件，只需打开一次并通过引用传递它（如果需要，重置状态）。虽然我想你可以通过文件的单次传递来实现你需要的东西。

哎呀，我怀疑您是否真的**需要**像在这里一样知道文件大小，您可以只读取大小“块”的数量，直到您进行短读（此时您已完成）。

你为什么不解释代码的目标，我觉得有一个**更**简单的解决方案可能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-18T21:52:03.050

我发现做行的最好方法是只读内存映射文件。不要为 \n 写 \0，而是使用成对的`const char *`s，like`std::pair<const char*, const char*>`或成对的`const char*`s 和一个计数。如果您需要编辑这些行，一个好方法是创建一个可以存储指针的对象对或带有修改后的行的 std::string。

至于用 STL 向量或双端队列节省内存空间，一个好的技术是让它加倍，直到你完成添加。然后将其调整为实际大小，这应该将未使用的内存释放回堆分配器。内存可能仍会分配给程序，尽管我不担心。此外，不要采用默认大小，而是从获取文件大小（以字节为单位）开始，除以您对每行平均字符的最佳猜测，并在开始时保留那么多空间。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-12-10T19:49:02.673

通过 pushBack() 增加向量会导致内存碎片和内存使用效率低下。我会尝试使用列表，并且只有在您确切知道它需要多少元素时才创建一个向量（如果您需要的话）。

# sql-server - SQL Server 2005 日期时间戳查询

> ID：357244
> 
> 赞同：6
> 
> 时间：2008-12-10T19:20:14.853
> 
> 标签：sql-server, datetime

我的列类型之一是 DateTime（注册日期）。我无法创建过滤所有数据的查询，例如。在 2008 年 10 月 22 日 18:00 至 20:00 之间注册的所有注册。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T19:25:26.513

```
SELECT *
FROM YourTable
WHERE DateRegistered BETWEEN '10/22/2008 18:00:00' AND '10/22/2008 20:00:00' 
```

应该做的伎俩

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T19:25:49.413

你试过使用 datediff 吗？

[http://msdn.microsoft.com/en-us/library/ms189794.aspx](http://msdn.microsoft.com/en-us/library/ms189794.aspx)

# .net-2.0 - 在 .net 2.0 中使用 .net 3.0 命名空间

> ID：357246
> 
> 赞同：1
> 
> 时间：2008-12-10T19:20:22.107
> 
> 标签：.net-2.0, namespaces

无论如何，是否可以在 .net 2.0 应用程序中使用 .net 3.0 命名空间？我特别希望使用 System.Windows.Media.Media3D 命名空间。

编辑：我希望使用实际的程序集，而不仅仅是名称空间。我的措辞很糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T19:28:05.307

不，您不能在 .NET 2.0 中使用新的 .NET 3.0

就是这么简单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T20:24:38.623

.NET 2.0 和 .NET 3.0/3.5 都使用相同的 2.0 .NET 运行时。3.0 添加了 WCF WPF WF 和 Cardspace，3.5 添加了 Linq 等。仅通过库。

如果您使用 VS2008，您可以使用 csharp 3.0 功能（lambda、匿名类型、匿名方法等）编译应用程序，只要您将项目设置为面向 2.0 框架，它们仍然可以在 2.0 运行时运行。

为了使用 3.0 中库之一的功能，用户需要安装 3.0 框架。

我想如果您能够更具体地了解 2.0 应用程序的含义，那将会很有帮助。你的意思是你的应用程序需要能够在没有安装 3.0 和 3.5 的情况下运行？你的意思是你老板不让你把项目设置里的rolldown改成3.0？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T19:23:53.443

您是在尝试使用命名空间还是代码？只要您不导入适用的 DLL，您就可以将命名空间用于您想要的任何东西。这会导致意大利面条代码的噩梦，但你可以做到。

我相信您已经知道了，不，您不能使用 3.0 代码……或者您必须将其称为“.Net 3.0 应用程序”。

# c# - 可以从安装过程中加密配置数据吗？

> ID：357280
> 
> 赞同：0
> 
> 时间：2008-12-10T19:27:47.460
> 
> 标签：c#, .net, sql-server

我正在开发一个连接到 SQL Server 2005 数据库的 .NET (2.0) WinForms 实用程序。我找到了参考资料，例如[避免使用纯文本密码](https://stackoverflow.com/questions/42833/how-do-i-avoid-having-the-database-password-stored-in-plaintext-in-sourcecode)来处理连接字符串数据的实际加密。我现在需要在安装过程中实施加密，以便管理员可以在用户桌面上安装该实用程序，但不向用户提供数据库连接信息。

示例代码似乎都适合在主应用程序中执行加密。因此，应用程序需要执行一次才能进行加密。如果应用程序已安装但未执行，则配置信息将在配置文件中以纯文本形式显示。

任何人都可以提供显示如何从设置应用程序执行加密的信息。也欢迎其他解决问题的方法（但是，由于业务需求，我无法要求对数据库连接进行 Windows 身份验证 - 我仅限于 SQL Server 身份验证）。

**编辑：** 我的描述可能过于简短。我们已经进行了风险评估，并确定使用内置的 .NET 框架功能来加密连接信息可以为应用程序提供足够的安全性。

我们知道，一个真正有决心的人最终可以获得连接信息，我们欣然接受这种风险。加密连接数据的目的只是为了提高努力的标准并帮助“让诚实的人保持诚实”。

已经制定了执行加密的方法，我现在正在尝试制定一种从安装过程中执行加密的方法。任何有关这些方面的帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T19:42:03.780

加密配置的主要问题是保护用于解密配置设置的密钥。

使用服务器应用程序，您可以通过限制对服务器的访问来做到这一点。客户端 WinForms 应用程序需要在以当前用户身份运行时访问密钥，因此如果他足够聪明，用户将能够找到密钥。

如果您不能对数据库连接使用 Windows 身份验证，或者在服务器上使用带有数据访问代码的 n 层架构，那么您将不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T22:04:55.053

在安装过程中让安装程序运行 postscript 进程怎么样？

这样，它将在安装期间运行，因此在管理监视下运行，并且 encritpion 的代码将是您喜欢的任何代码。

# html - 是否可以在嵌入 AS2 swf 之上的 DIV 中嵌入 AS3 swf？

> ID：357281
> 
> 赞同：3
> 
> 时间：2008-12-10T19:27:49.940
> 
> 标签：html, flash, embed

我认为这个问题是不言自明的。以前有人做过吗？

**更新**：澄清为什么我需要这样做。我们有一个 AS1 - AS2 站点的单一 swf 庞然大物，带有一个大型视频库部分。客户想要更新视频部分，因为 AS2 代码无法处理他们更新的、更大的视频文件。客户不会为整个网站的更新付费。因此，当导航到该部分时，我希望能够在现有站点上覆盖基于 AS3 的视频浏览器和播放器，从而使站点的其余部分使用现有的 AS2 代码正常工作。

希望能更清楚地解释事情！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T21:08:26.883

我不认为它是 AS3 还是 AS2 与它有任何关系。

从网络浏览器的角度来看，它们都是一个黑盒子，上面写着“Flash Player Plugin”。您一次只能安装一个版本的插件，因此即使您有一个 AS2 和一个 AS3 swf，Web 浏览器也只会看到它有 2 个“Flash player plugin version 10”实例

归结为你似乎想要做的是：

1.  创建一个页面：
2.  在里面放一个swf
3.  向页面添加一个 div 并使用 CSS 定位将其“置于”另一个 swf 之上
4.  在该 div 中粘贴另一个 swf。

那么，这行得通吗？-~~否~~是的，非常好，但您必须设置`wmode="transparent"`嵌入的 Flash 对象（感谢grapefrukt 的评论）。

我进行了测试：这是我的源代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <style type="text/css" media="screen">
            DIV{ width: 300px; height; 300px;}
            #background{ border: 1px solid green; background-color: green; z-index: 0; }
            #foreground{ border: 1px solid red; background-color: red; z-index: 50; }
        </style>
    </head>
    <body>
        <div id="background">
            <embed height="208" width="208" quality="high" bgcolor="#fff" src="bgswf.swf" type="application/x-shockwave-flash" wmode="transparent"/>
        </div>  

        <div id="foreground" style="position: absolute; left: 30px; top: 30px;">
            <embed height="208" width="208" quality="high" bgcolor="#fff" src="fgswf.swf" type="application/x-shockwave-flash" wmode="transparent"/>
        </div>  

    </body>
</html> 
```

结果：

没有`wmode=transparent`, 在 Firefox 和 IE 中不一致且轻微损坏。有了它，就可以在 IE 和 Firefox 中完成您认为它应该做的事情。
swf 文件的行为（从布局的角度来看）就好像它们只是图像一样。这个很酷。

# sql-server - SQL Server 配置文件 - 查看参数值？

> ID：357283
> 
> 赞同：11
> 
> 时间：2008-12-10T19:28:06.040
> 
> 标签：sql-server, sql-server-profiler

在 SQL Server Profile 中，我让它跟踪 SP:StmtStarting 事件。“TextData”包括如下信息：

```
EXEC MySortedProc 
   @param, NULL,
   @param2, NULL 
```

我必须跟踪什么（或者我可以跟踪什么？）才能查看这些参数的值？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-25T06:49:35.960

有点害怕误解了这个问题，但您可以分析 RPC:Completed 事件，该事件将在 textdata 列中返回存储过程执行的结果，例如：

执行 usp_yourproc @param = '值'

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T21:49:02.963

如果我理解正确，您有一个存储过程被另一个存储过程调用，并且您想要获取传递给内部存储过程的参数值？

我认为 SQL Profiler 不可能。如果我找到方法，我会发布更新。如果这只是为了调试，那么您可以将值保存到表中以便事后检查，但这不是一个很好的生产解决方案，除非您真的想要那种广泛的日志记录。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-06-20T11:14:10.703

对于某些事件，SQL Profiler 将在 TextData 列中显示 NULL 值而不是真实数据。您可以使用下面文章中解释的方法来捕获此信息。我使用这种方法来捕获另一组引发排序警告的查询。让我知道这是否有帮助。

[http://sankarreddy.spaces.live.com/blog/cns!1F1B61765691B5CD!367.entry](http://sankarreddy.spaces.live.com/blog/cns!1F1B61765691B5CD!367.entry)

# asp-classic - 经典 ASP Server.MapPath 无法正常工作

> ID：357297
> 
> 赞同：0
> 
> 时间：2008-12-10T19:32:33.877
> 
> 标签：asp-classic

我正在处理的网站是在 Classic ASP 中完成的，我正在努力做到最好。我已将其抽象为类似 Rails 的目录结构：

```
app_name
 - 应用程序
   - 包括
     - 帮手
     - 库
     - 部分
  - 上市
    - 样式表
    - 图片
    - javascripts

```

我创建了一些类似 Rails 的助手，例如：

```
Function ImageTag(ByVal imageFileName, ByVal altText)
  path = Server.MapPath(IMAGE_ROOT & imageFileName & ".jpg")
  ImageTag = "<img src=""" & path & """ title=""" & altText & """ alt=""" & altText & """ />"
End Function 
```

因此使用它：

```
<%= ImageTag("my_pic") %> 
```

在配置文件中将“IMAGE_ROOT”定义为“../public/images/”。我在 XP 上进行开发，因此该站点被设置为虚拟目录。但是，图像根本不会加载到网页上。它显示了正确的路径，因为我可以将它复制/粘贴到我的浏览器中并查看图像 - 由于某种原因它不会显示在页面上。我的 CSS 样式表也是如此——路径是正确的，但页面根本没有呈现它。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T19:41:11.130

您可能会遇到混合服务器端和 Web 目录的问题。

`Server.MapPath`**`C:\InetPub\...\public\images\my_pic.jpg`**当你可能想要的时候会给你**`/public/images/my_pic.jpg`**。浏览器无法从您的服务器中获取第一个。

该图像必须通过您的域可用：**localhost/public/images/my_pid.jpg**。

* * *

我假设，既然您可以查看图像，那么您是在托管它的同一个盒子上开发的？如果是这种情况，您可以查看图像，因为它只是被浏览器作为本地文件打开。其他所有人都必须仅使用 HTTP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T19:39:11.570

- 生成的html可能有问题吗？
- 您可能想尝试使 IMAGE_ROOT 成为像“/public/images”这样的绝对路径，而不是相对路径（如果可能）。
- 你也可以查看 IIS 日志，看看你是否收到图像和 css 文件的 404 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T02:33:57.927

如果 app_name/app 是 IIS 站点的根目录，那么您必须将 app_name/app 作为 IIS 站点中的虚拟目录。由于它只是静态内容，因此您也不需要执行 .asp 脚本的权限。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-10T22:59:04.210

Fiddler 是解决这些类型问题时使用的出色工具。它将直接显示您的网络浏览器和服务器之间的调用和响应。它在 IE 和 FireFox 支持下开箱即用，只是一个配置设置。

我曾亲自使用 Fiddler 来追踪图像加载问题、CSS 问题、缓存问题、重定向错误，甚至用它来篡改 URL 变量以尝试破坏/入侵我的网站。

[提琴手网站](http://www.fiddlertool.com/)

# c++ - 如何从派生类函数调用父类函数？

> ID：357307
> 
> 赞同：702
> 
> 时间：2008-12-10T19:35:45.430
> 
> 标签：c++, oop, inheritance

如何使用 C++ 从派生类调用父函数？例如，我有一个名为 的类`parent`，以及一个`child`从父类派生的类。每个类中都有一个`print`函数。在孩子的打印功能的定义中，我想调用父母的打印功能。我该怎么做呢？

* * *

## 回答 #1

> 赞同：893
> 
> 时间：2008-12-10T19:57:40.800

我将冒险说明这一点：您调用该函数，如果它在基类中定义，则它在派生类中自动可用（除非它是`private`）。

如果派生类中存在具有相同签名的函数，您可以通过添加基类名称后跟两个冒号来消除歧义`base_class::foo(...)`。您应该注意，与 Java 和 C# 不同，C++ 没有**“**基类”（`super`或`base`）的关键字，因为 C++ 支持[多重继承](http://en.wikipedia.org/wiki/Multiple_inheritance)，这可能会导致歧义。

```
class left {
public:
    void foo();
};

class right {
public:
    void foo();
};

class bottom : public left, public right {
public:
    void foo()
    {
        //base::foo();// ambiguous
        left::foo();
        right::foo();

        // and when foo() is not called for 'this':
        bottom b;
        b.left::foo();  // calls b.foo() from 'left'
        b.right::foo();  // call b.foo() from 'right'
    }
}; 
```

顺便说一句，您不能直接从同一个类派生两次，因为无法引用其中一个基类而不是另一个。

```
class bottom : public left, public left { // Illegal
}; 
```

* * *

## 回答 #2

> 赞同：234
> 
> 时间：2008-12-10T19:37:42.760

给定一个名为的父类`Parent`和一个名为 的子类`Child`，您可以执行以下操作：

```
class Parent {
public:
    virtual void print(int x);
};

class Child : public Parent {
    void print(int x) override;
};

void Parent::print(int x) {
    // some default behavior
}

void Child::print(int x) {
    // use Parent's print method; implicitly passes 'this' to Parent::print
    Parent::print(x);
} 
```

请注意，这`Parent`是类的实际名称，而不是关键字。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-12-10T19:40:45.110

如果您的基类被调用`Base`，并且您的函数被调用，`FooBar()`您可以使用直接调用它`Base::FooBar()`

```
void Base::FooBar()
{
   printf("in Base\n");
}

void ChildOfBase::FooBar()
{
  Base::FooBar();
} 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-05-26T18:51:57.053

在 MSVC 中有一个 Microsoft 特定的关键字：**__super**

* * *

MSDN：允许您明确声明您正在为要覆盖的函数调用基类实现。

```
// deriv_super.cpp
// compile with: /c
struct B1 {
   void mf(int) {}
};

struct B2 {
   void mf(short) {}

   void mf(char) {}
};

struct D : B1, B2 {
   void mf(short) {
      __super::mf(1);   // Calls B1::mf(int)
      __super::mf('s');   // Calls B2::mf(char)
   }
}; 
```

* * *

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-05-04T21:50:50.113

使用父范围解析运算符调用父方法。

> 父::方法()

```
class Primate {
public:
    void whatAmI(){
        cout << "I am of Primate order";
    }
};

class Human : public Primate{
public:
    void whatAmI(){
        cout << "I am of Human species";
    }
    void whatIsMyOrder(){
        Primate::whatAmI(); // <-- SCOPE RESOLUTION OPERATOR
    }
}; 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-12-25T07:46:49.017

如果基类成员函数的访问修饰符是protected OR public，则可以从派生类调用基类的成员函数。可以从派生的成员函数调用基类的非虚拟和虚拟成员函数。请参考程序。

```
#include<iostream>
using namespace std;

class Parent
{
  protected:
    virtual void fun(int i)
    {
      cout<<"Parent::fun functionality write here"<<endl;
    }
    void fun1(int i)
    {
      cout<<"Parent::fun1 functionality write here"<<endl;
    }
    void fun2()
    {

      cout<<"Parent::fun3 functionality write here"<<endl;
    }

};

class Child:public Parent
{
  public:
    virtual void fun(int i)
    {
      cout<<"Child::fun partial functionality write here"<<endl;
      Parent::fun(++i);
      Parent::fun2();
    }
    void fun1(int i)
    {
      cout<<"Child::fun1 partial functionality write here"<<endl;
      Parent::fun1(++i);
    }

};
int main()
{
   Child d1;
   d1.fun(1);
   d1.fun1(2);
   return 0;
} 
```

输出：

```
$ g++ base_function_call_from_derived.cpp
$ ./a.out 
Child::fun partial functionality write here
Parent::fun functionality write here
Parent::fun3 functionality write here
Child::fun1 partial functionality write here
Parent::fun1 functionality write here 
```

* * *

## 回答 #7

> 赞同：-16
> 
> 时间：2014-06-02T14:07:17.270

```
struct a{
 int x;

 struct son{
  a* _parent;
  void test(){
   _parent->x=1; //success
  }
 }_son;

 }_a;

int main(){
 _a._son._parent=&_a;
 _a._son.test();
} 
```

参考例子。

# asp.net - 将 DropDownList 数据源绑定到 XPathSelect

> ID：357311
> 
> 赞同：1
> 
> 时间：2008-12-10T19:36:33.120
> 
> 标签：asp.net, data-binding, drop-down-menu

问候！

我有一些这样的 XML：

```
<Root>
    <MainSection>
        <SomeNode>Some Node Value</SomeNode>
        <SomeOtherNode>Some Other Node Value</SomeOtherNode>
        <Areas>
            <Area someattribute="aaa" name="Alpha" value="0" />
            <Area someattribute="bbb" name="Beta" value="1" />
            <Area someattribute="ddd" name="Delta" value="2" />
        </Areas>
    </MainSection>
</Root> 
```

我的 Web 表单上有一个 FormView，其中绑定了许多值。我想将 Areas 子节点绑定到 DropDownList ，如下所示：

```
<asp:FormView ID="MyFormView" runat="server" DataSourceID="MyXmlDataSource">
    <ItemTemplate>
        <h1><%# XPath("SomeNode")%></h1>
        <asp:Label ID="MyLabel" runat="server" AssociatedControlID="MyDdl" Text='<%# XPath("SomeOtherNode")%>' />
        <asp:DropDownList ID="MyDdl" runat="server" DataSource='<%# XPathSelect("Areas/*") %>' DataTextField="name" DataValueField="value"></asp:DropDownList>
    </ItemTemplate>
</asp:FormView>
<asp:XmlDataSource ID="MyXmlDataSource" runat="server" XPath="Root/MainSection" /> 
```

不幸的是，我没有在下拉列表中看到我期望的数据，而是看到了 3 个条目，其中“区域”作为文本并且没有值。

我知道我的 XML 没问题，因为出于测试目的，我尝试在页面上抛出一个 Repeater 控件，如下所示：

```
<asp:Repeater ID="MyRepeater" runat="server" DataSource='<%# XPathSelect("Areas/*") %>'>
    <ItemTemplate>
        <%# XPath("@name") %> - <%# XPath("@value") %><br />
    </ItemTemplate>
</asp:Repeater> 
```

这很好用。

绑定到下拉列表时我做错了什么，可能是 DataTextField 和 DataValueField 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T02:56:51.917

XPathSelect 不会返回可以像这样直接绑定的 DataSource。就像您绑定了 FormView 并且您的绑定使用 XPath("...") 而不是 Bind("...") 一样，DropDownList 也有同样的问题。使用您的属性构建标准数据源并将 DDL 绑定到该数据源，或者使用生成选择选项标签或类似内容的 ListView 滚动您自己的 HTML。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-10T20:07:08.580

请原谅我对 ASP 不熟悉，但您的路径不应该包含 @ 吗？

<asp:DropDownList ID="MyDdl" runat="server" DataSource='<%# XPathSelect("Areas/*") %>' DataTextField=" **@name** " DataValueField=" **@value** " />

# permissions - File permissions in cygwin and MVFS

> ID：357314
> 
> 赞同：3
> 
> 时间：2008-12-10T19:38:16.020
> 
> 标签：permissions, cygwin, clearcase, chmod

I am using Cygwin with a dll version of 1.5.19 (yes, out-of-date, I know, but we're doing it for configuration control reasons). All my files (existing and newly created) show up with permissions 644, despite a umask of 022\. Also, using chmod doesn't change the permissions. I have ntsec set in the CYGWIN environment variable. I need to be able to add execute permissions; is there anything I can try to fix this or is it a lost cause?

* * *

A much later note: I realized that a key part of the problem is that the files I was trying to chmod were in a ClearCase dynamic view, which uses MVFS. I still have not found way to successfully set the execute permissions, though.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-21T09:08:56.783

编辑`/etc/passwd`以将用户的 GID 的默认值更改为 545（即 NT 'Users' 组）而不是 513（'None' 组）。

查看系统范围和`/etc/bash.bashrc`默认umask 设置。`$HOME/.bashrc``.bash_profile`

即使默认，也请尝试将 NT 系统环境中的 CYGWIN 变量设置为“binmode ntsec”。

让我知道问题是否消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T20:50:55.670

您需要`/etc/passwd`和`/etc/group`文件以获得权限才能正常工作。

请参阅[为什么不起作用`chmod`？](https://cygwin.com/faq/faq.html#faq.using.chmod)在[Cygwin 常见问题解答中](http://cygwin.com/faq.html)

和

[Cgywin 用户指南](http://cygwin.com/cygwin-ug-net/cygwin-ug-net.html)中的[文件权限](http://cygwin.com/cygwin-ug-net/ntsec.html#ntsec-files)

# windows - 如何获取参数列表？

> ID：357315
> 
> 赞同：458
> 
> 时间：2008-12-10T19:38:38.857
> 
> 标签：windows, batch-file

我想找到一个与 Bash 对应的 Windows 批处理`$@`，它包含传递给脚本的所有参数的列表。

还是我不得不打扰`shift`？

* * *

## 回答 #1

> 赞同：702
> 
> 时间：2008-12-19T21:50:16.370

`%*`对于所有命令行参数（不包括脚本名称本身） ， [dancavallaro](https://stackoverflow.com/a/357338/511529)是正确的。这些对你也可能有用：

`%0`- 用于调用批处理文件的命令（可以是`foo`, `..\foo`,`c:\bats\foo.bat`等）
`%1`是第一个命令行参数，
`%2`是第二个命令行参数，
以此类推直到`%9`（并且`SHIFT`可以用于第 9 个之后的那些）。

`%~nx0`- 批处理文件的实际名称，与调用方法无关 (some-batch.bat)
`%~dp0`- 脚本的驱动器和路径 (d:\scripts)
`%~dpnx0`- 是脚本的完全限定路径名 (d:\scripts\some -批处理.bat)

更多信息示例在[https://www.ss64.com/nt/syntax-args.html](https://www.ss64.com/nt/syntax-args.html)和[https://www.robvanderwoude.com/parameters.html](https://www.robvanderwoude.com/parameters.html)

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2008-12-10T19:44:28.487

`%*`似乎保存了传递给脚本的所有参数。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2011-03-17T12:09:39.493

`%1`...`%n`并`%*`保存参数，但访问它们可能很棘手，因为内容将被解释。
因此，用普通语句处理这样的事情是不可能的

```
myBatch.bat "&"^& 
```

每一行都失败，因为 cmd.exe 尝试执行其中一个与号（ %1 的内容是`"&"&`）

```
set var=%1
set "var=%1"
set var=%~1
set "var=%~1" 
```

但是有一个临时文件的解决方法

```
@echo off
SETLOCAL DisableDelayedExpansion

SETLOCAL
for %%a in (1) do (
    set "prompt=$_"
    echo on
    for %%b in (1) do rem * #%1#
    @echo off
) > param.txt
ENDLOCAL

for /F "delims=" %%L in (param.txt) do (
  set "param1=%%L"
)
SETLOCAL EnableDelayedExpansion
set "param1=!param1:*#=!"
set "param1=!param1:~0,-2!"
echo %%1 is '!param1!' 
```

诀窍是启用`echo on`和扩展`%1`after`rem`语句（也适用于 %2 .. %*）。
但是为了能够重定向 的输出`echo on`，您需要两个 FOR-LOOPS。

额外的字符`* #`用于防止内容安全`/?`（将显示 REM 的帮助）。
或者行尾的插入符号 ^ 可以用作多行字符。

FOR /F 应该在延迟扩展关闭的情况下工作，否则内容为“！” 将被摧毁。
删除多余的字符后`param1`，你就明白了。

并以`param1`安全的方式使用，启用延迟扩展。

**编辑：对 %0 的评论**

`%0`包含用于调用批处理的命令，也保留大小写，例如在`FoO.BaT`
调用函数之后`%0`，并且还`%~0`包含函数名称（或者更好的是用于调用函数的字符串）。
但`%~f0`你仍然可以回忆起文件名。

```
@echo off
echo main %0, %~0, %~f0
call :myLabel+xyz
exit /b

:MYlabel
echo func %0, %~0, %~f0
exit /b 
```

输出

```
main test.bat, test.bat, C:\temp\test.bat
func :myLabel+xyz, :myLabel+xyz, C:\temp\test.bat 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2012-03-24T03:09:55.597

我发现下次你需要查找这些信息时。无需打开浏览器并搜索它，您只需输入`call /?`cmd 即可：

```
...

%* in a batch script refers to all the arguments (e.g. %1 %2 %3
    %4 %5 ...)

Substitution of batch parameters (%n) has been enhanced.  You can
now use the following optional syntax:

    %~1         - expands %1 removing any surrounding quotes (")
    %~f1        - expands %1 to a fully qualified path name
    %~d1        - expands %1 to a drive letter only
    %~p1        - expands %1 to a path only
    %~n1        - expands %1 to a file name only
    %~x1        - expands %1 to a file extension only
    %~s1        - expanded path contains short names only
    %~a1        - expands %1 to file attributes
    %~t1        - expands %1 to date/time of file
    %~z1        - expands %1 to size of file
    %~$PATH:1   - searches the directories listed in the PATH
                   environment variable and expands %1 to the fully
                   qualified name of the first one found.  If the
                   environment variable name is not defined or the
                   file is not found by the search, then this
                   modifier expands to the empty string

The modifiers can be combined to get compound results:

    %~dp1       - expands %1 to a drive letter and path only
    %~nx1       - expands %1 to a file name and extension only
    %~dp$PATH:1 - searches the directories listed in the PATH
                   environment variable for %1 and expands to the
                   drive letter and path of the first one found.
    %~ftza1     - expands %1 to a DIR like output line

In the above examples %1 and PATH can be replaced by other
valid values.  The %~ syntax is terminated by a valid argument
number.  The %~ modifiers may not be used with %* 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-04-22T23:01:16.830

将所有参数检索到脚本的方法如下：

```
@ECHO off
ECHO The %~nx0 script args are...
for %%I IN (%*) DO ECHO %%I
pause 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-29T19:03:51.943

这是获取参数并将它们设置为环境变量的一种相当简单的方法。在本例中，我将它们称为键和值。

将以下代码示例另存为“args.bat”。然后从命令行调用您保存的批处理文件。示例：arg.bat --x 90 --y 120

我提供了一些 echo 命令来引导您完成整个过程。但最终结果是 --x 的值为 90，而 --y 的值为 120（也就是说，如果您按照上面指定的方式运行示例 ;-) ）。

然后，您可以使用“if defined”条件语句来确定是否运行您的代码块。所以让我们说运行：“arg.bat --x hello-world”然后我可以使用语句“IF DEFINED --x echo %--x%”，结果将是“hello-world”。如果您运行批处理应该更有意义。

```
@setlocal enableextensions enabledelayedexpansion
@ECHO off
ECHO.
ECHO :::::::::::::::::::::::::: arg.bat example :::::::::::::::::::::::::::::::
ECHO :: By:      User2631477, 2013-07-29                                   ::
ECHO :: Version: 1.0                                                         ::
ECHO :: Purpose: Checks the args passed to the batch.                        ::
ECHO ::                                                                      ::
ECHO :: Start by gathering all the args with the %%* in a for loop.          ::
ECHO ::                                                                      ::
ECHO :: Now we use a 'for' loop to search for our keys which are identified  ::
ECHO :: by the text '--'. The function then sets the --arg ^= to the next    ::
ECHO :: arg. "CALL:Function_GetValue" ^<search for --^> ^<each arg^>         ::
ECHO ::                                                                      ::
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

ECHO.

ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO :: From the command line you could pass... arg.bat --x 90 --y 220       ::
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO.
ECHO.Checking Args:"%*"

FOR %%a IN (%*) do (
    CALL:Function_GetValue "--","%%a" 
)

ECHO.
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO :: Now lets check which args were set to variables...                   ::
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO.
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO :: For this we are using the CALL:Function_Show_Defined "--x,--y,--z"   ::
ECHO ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO.
CALL:Function_Show_Defined "--x,--y,--z"
endlocal
goto done

:Function_GetValue

REM First we use find string to locate and search for the text.
echo.%~2 | findstr /C:"%~1" 1>nul

REM Next we check the errorlevel return to see if it contains a key or a value
REM and set the appropriate action.

if not errorlevel 1 (
  SET KEY=%~2
) ELSE (
  SET VALUE=%~2
)
IF DEFINED VALUE (
    SET %KEY%=%~2
    ECHO.
    ECHO ::::::::::::::::::::::::: %~0 ::::::::::::::::::::::::::::::
    ECHO :: The KEY:'%KEY%' is now set to the VALUE:'%VALUE%'                     ::
    ECHO :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    ECHO.
    ECHO %KEY%=%~2
    ECHO.
    REM It's important to clear the definitions for the key and value in order to
    REM search for the next key value set.
    SET KEY=
    SET VALUE=
)
GOTO:EOF

:Function_Show_Defined 
ECHO.
ECHO ::::::::::::::::::: %~0 ::::::::::::::::::::::::::::::::
ECHO :: Checks which args were defined i.e. %~2
ECHO :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
ECHO.
SET ARGS=%~1
for %%s in (%ARGS%) DO (
    ECHO.
    ECHO :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    ECHO :: For the ARG: '%%s'                         
    IF DEFINED %%s (
        ECHO :: Defined as: '%%s=!%%s!'                                             
    ) else (
        ECHO :: Not Defined '%%s' and thus has no value.
    )
    ECHO :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    ECHO.
)
goto:EOF

:done 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-02-27T14:03:17.720

[![在此处输入图像描述](https://i.stack.imgur.com/L2hkd.png)](https://i.stack.imgur.com/L2hkd.png)

> *对于使用循环来获取所有参数并在纯批处理中：*

**Obs：**用于不使用：**`?*&<>`**

* * *

```
@echo off && setlocal EnableDelayedExpansion

for %%Z in (%*)do set "_arg_=%%Z" && set/a "_cnt+=1+0" && call set "_arg_[!_cnt!]=!_arg_!")

:: write/test these arguments/parameters ::
for /l %%l in (1 1 !_cnt!)do echo/ The argument n:%%l is: !_arg_[%%l]!

goto :eof 
```

* * *

> *您的代码已准备好使用所需的参数编号执行某些操作，例如...*

```
@echo off && setlocal EnableDelayedExpansion

for %%Z in (%*)do set "_arg_=%%Z" && set/a "_cnt+=1+0" && call set "_arg_[!_cnt!]=!_arg_!"

echo= !_arg_[1]! !_arg_[2]! !_arg_[2]!> log.txt 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-21T10:00:33.940

下面的代码模拟了一个数组（' `params`'）——获取脚本接收到的参数并将它们存储在变量`params_1`..`params_n`中，其中`n`==`params_0`数组的元素个数：

```
@echo off

rem Storing the program parameters into the array 'params':
rem Delayed expansion is left disabled in order not to interpret "!" in program parameters' values;
rem however, if a parameter is not quoted, special characters in it (like "^", "&", "|") get interpreted at program launch
set /a count=0
:repeat
    set /a count+=1
    set "params_%count%=%~1"
    shift
    if defined params_%count% (
        goto :repeat
    ) else (
        set /a count-=1
    )    
set /a params_0=count

rem Printing the program parameters stored in the array 'params':
rem After the variables params_1 .. params_n are set with the program parameters' values, delayed expansion can
rem be enabled and "!" are not interpreted in the variables params_1 .. params_n values
setlocal enabledelayedexpansion
    for /l %%i in (1,1,!params_0!) do (
        echo params_%%i: "!params_%%i!"
    )
endlocal

pause
goto :eof 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-08-17T13:36:21.090

如果引号中包含空格的参数，`%*`将无法正常工作。我发现的最佳解决方案是有一个连接所有参数的循环：[https ://serverfault.com/a/22541](https://serverfault.com/a/22541)

```
set args=%1
shift
:start
if [%1] == [] goto done
set args=%args% %1
shift
goto start

:done
(use %args% here) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-07T11:47:51.590

您可以使用`For`Commad 来获取 Arg 列表。

帮助：`For /?` 帮助：`Setlocal /?`

这是我的方式=

```
@echo off
::For Run Use This = cmd /c ""Args.cmd" Hello USER Scientist etc"
setlocal EnableDelayedExpansion
set /a Count=0
for %%I IN (%*) DO (
 Echo Arg_!Count! = %%I
 set /a Count+=1 
)
Echo Count Of Args = !Count!
Endlocal 
```

不需要 Shift 命令。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-12T12:49:25.830

```
@echo 关闭
：开始

:: 在此处插入您的代码
echo.%%1 现在是：%~1
:: 在这里结束插入你的代码

如果 "%~2" NEQ "" (
    转移
    转到：开始
)
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-30T21:26:29.273

上面的很多信息让我进行了进一步的研究并最终得到了答案，所以我想贡献我最终所做的事情，希望它可以帮助其他人：

*   我还想将不同数量的变量传递给批处理文件，以便可以在文件中处理它们。

*   我可以使用引号将它们传递给批处理文件

*   我希望它们类似于下面的处理 - 但使用循环而不是手动写出：

所以我想执行这个：

```
prog_ZipDeleteFiles.bat "_appPath=C:\Services\Logs\PCAP" "_appFile=PCAP*.?" 
```

并通过 for 循环的魔力在批处理文件中执行此操作：

```
set "_appPath=C:\Services\Logs\PCAP"
set "_appFile=PCAP*.?" 
```

我遇到的问题是我所有使用 for 循环的尝试都不起作用。下面的例子：

```
for /f "tokens* delims= " in %%A (%*) DO (
   set %%A
) 
```

只会做：

```
set "_appPath=C:\Services\Logs\PCAP" 
```

并不是：

```
set "_appPath=C:\Services\Logs\PCAP"
set "_appFile=PCAP*.?" 
```

即使在设置之后

```
SETLOCAL EnableDelayedExpansion 
```

原因是 for 循环读取整行并将我的第二个参数分配给 %%B 在循环的第一次迭代期间。因为 %* 代表所有参数，所以只有一行要处理 - 因此只发生了一次 for 循环。事实证明这是设计使然，我的逻辑是错误的。

所以我不再尝试使用 for 循环，而是通过使用 if、shift 和 goto 语句来简化我想要做的事情。同意它有点黑客，但它更适合我的需要。我可以遍历所有参数，然后在处理完所有参数后使用 if 语句退出循环。

我试图完成的获奖声明：

```
echo on
:processArguments
:: Process all arguments in the order received
if defined %1 then (
    set %1
    shift
    goto:processArguments
) ELSE (
    echo off 
) 
```

更新 - 我不得不修改下面的内容，当我尝试引用 %1 并以这种方式使用 shift 时，我暴露了所有环境变量：

```
echo on
shift
:processArguments
:: Process all arguments in the order received
if defined %0 then (
    set %0
    shift
    goto:processArguments
) ELSE (
    echo off 
) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-05T15:26:44.240

有时我需要提取几个命令行参数，但不是全部，也不是从第一个参数中提取。让我们假设以下调用：

```
Test.bat uno dos tres cuatro cinco seis siete 
```

当然，扩展名“.bat”是不需要的，至少你在同一文件夹中有 test.exe。我们想要的是获得输出“tres cuatro cinco”（无论是一行还是三行）。目标是我只需要三个参数并从第三个开始。为了有一个简单的例子，每个动作都只是“回声”，但您可以在所选参数上考虑其他更复杂的动作。

我已经制作了一些示例（选项），以便您可以看到您认为哪个更适合您。不幸的是，没有一个很好的（或者我不知道的）方法，它基于“for %%i in (%3, 1, %5)”这样的范围内的 for 循环。

```
@echo off 
setlocal EnableDelayedExpansion

echo Option 1: one by one (same line)
echo %3, %4, %5
echo.

echo Option 2: Loop For one by one
for %%a in (%3, %4, %5) do echo %%a
echo.

echo Option 3: Loop For with check of limits
set i=0
for %%a in (%*) do (
    set /A i=i+1
    If !i! GTR 2 if !i! LSS 6 echo %%a
)
echo.

echo Option 4: Loop For with auxiliary list
for /l %%i in (3,1,5) do  (
    set a=%%i
    set b=echo %%
    set b=!b!!a!
    call !b!
)
echo.

echo Option 5: Assigning to an array of elements previously
set e[0]=%0
set i=0 
for %%a in (%*) do (
    set /A i=i+1
    set e[!i!]=%%a
)
for  /l %%i in (3,1,5) do (
    echo !e[%%i]!
)
echo.

echo Option 6: using shift and goto loop. It doesn't work with for loop
set i=2
:loop6
    set /A i=i+1
    echo %3
    shift
    If %i% LSS 5 goto :loop6 
```

可能您可以找到更多选项或组合几个选项。享用它们。

# iphone - Is there a way to create a fullscreen gallery on iPhone through Safari?

> ID：357319
> 
> 赞同：0
> 
> 时间：2008-12-10T19:39:38.480
> 
> 标签：iphone, mootools, image-gallery, mobile-safari, slimbox

I've been creating CSS/Javascript to style an upcoming site differently on iPhone - mostly to enhance usability. On the desktop app, I use [slimbox](http://www.digitalia.be/software/slimbox) in combination with mootools for an image gallery. This doesn't work on iPhone because it won't show the image fullscreen (safari chrome gets in the way). The solution I have at the moment is just to display image links.

I was wondering if there is some way to display images fullscreen through Mobile Safari - like the App Store and Photos.app. Anyone found such a solution?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T04:03:00.027

您可能已经知道这一点 - 但您可以通过以下方式摆脱地址栏： document.body.onload = function(){setTimeout("window.scrollTo(0,1);",100);};

要进一步创建原生应用程序的错觉，您可以禁用滚动： document.body.ontouchmove = function(e){e.preventDefault();};

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T19:53:59.560

有一个元标记[apple-mobile-web-app-capable](http://daringfireball.net/linked/2008/10/03/fullscreen-iphone-web-apps)，您可以使用它以全屏模式启动移动 safari。请记住，用户需要在其主屏幕上添加一个网络书签才能使其正常工作，并且他们单击的任何链接都会发送到常规的移动 Safari，后者会作为新应用程序打开。

# html - 在 html 页面加载和渲染期间显示一个 throbber

> ID：357323
> 
> 赞同：3
> 
> 时间：2008-12-10T19:40:10.180
> 
> 标签：html, rendering, throbber

我有一个呈现缓慢的页面。穿越网络的旅程很快。页面的初始加载速度很快。您实际上可以看到（如果您的机器足够慢）html 组件的初始布局。然后一些 javascript 的东西运行，使其中一些组件全部 ajaxy。然后最后应用 css。

我对让一切都慢下来的 javascript 无能为力。所以我需要一个 throbber 来告诉用户等一下，浏览器正在工作。有什么办法可以捕获浏览器完成渲染事件？甚至有这样的事件吗？还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T19:47:25.220

在调用所有 Ajax 内容之前检查 DOM 何时准备就绪。

使用[原型](http://prototypejs.org)：

```
document.observe("dom:loaded", function() {
  //your code
}); 
```

使用[jQuery](http://jquery.com/)：

```
$(document).ready(function() {
      //your code
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T18:58:30.767

在代码运行之前显示 throbber 并在之后隐藏它。

使用 JQuery：

```
$("#throbber").show();
/* Your AJAX calls */
$("#throbber").hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-13T23:40:16.457

看看： http: [//plugins.jquery.com/project/throbber](http://plugins.jquery.com/project/throbber)

# database - 表之间钻石关系中的标识符

> ID：357328
> 
> 赞同：0
> 
> 时间：2008-12-10T19:41:22.440
> 
> 标签：database, oracle, database-design, ddl

我有四个表（A、B、C、D），其中 A 是与 B 和 C 的一对多关系的父级。C 和 D 是与表 D 的一对多关系的父级。从概念上讲，这些的主键表可以是：

*   答：援助
*   B: Aid, bnum (外键指向 A)
*   C：aid，cnum（外键指向A）
*   D：Aid、bnum、cnum（带有 B 和 C 的外键）

其中“num”列根据关系中的每个父 id 而不是每条记录自动递增。我在以前的应用程序中使用了这种方法，这不是问题，因为 B 和 C 记录的创建是通过顺序过程通过“select max()”查询生成新的“num”值来完成的。我从未对这种方法感到真正满意，但它完成了工作。

对于我现在正在处理的特定情况，表 A 和 B 中的记录由用户输入，因此自动生成 id 不是问题。对于表 C 和 D，这些表中的记录是由多个并发批处理生成的，因此需要以某种方式生成它们的标识符。我列出的先前方法不适用于竞争条件。

请注意，这是针对 Oracle 数据库的，因此我将使用序列而不是自动递增列。

鉴于上述约束，您将如何设计表来表示 A、B、C 和 D，以便正确执行实体之间的关系并且不需要应用程序代码生成任何标识符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T20:28:21.970

序列或自动编号应始终由数据库系统生成，而不是由应用程序生成。对于 MSSQL，这可以使用存储过程并从存储过程返回“select @@identity”来为应用程序提供插入行的 ID。

序列非常适合imo 主键，但是有些阵营崇拜“自然键”之神。

存储在表中的数据的含义以及关系的含义对于充分回答您的问题很重要，但关系可以允许级联删除。

就个人而言，我会在每个表中创建主键序列，并允许不属于主键的外键。您将通过主要对象（如员工、商品、商店）定义您的表，然后它们之间的关系将由组合组成因此商店中的员工将有一个表“storeemployee”，主键将是 empid , storeid 没有定义序列。通常，我会从对象（始终具有主键序列）和对象之间的关系（使用其他表的 ID 作为组合主键）来考虑它。

希望有帮助！

编辑：我应该补充一点，这很好地允许了钻石关系。想想“商店”和“员工”。一张表可以是 storeemployees，另一张表可以是“storesales”。两者都可以识别商店和员工，但它们的含义截然不同。一个是工作时间，另一个是销售额。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T21:52:07.403

如果我理解正确，您可能有一个解决方案

```
Table A
-------
100
101
102

Table B
-------
100 1
100 2
101 1

Table C
-------
100 1
100 2
101 1

Table D
-------
100 1 1
100 2 1
100 1 2
101 1 1 
```

等等

现在，'num' 值是否很小并且在无间隙序列中是否重要？如果没有，那么也只需使用序列。所以你可能会得到

```
Table B
-------
100 29125
100 29138
101 29130

Table D
-------
100 29125 401907
100 29138 404911
101 29130 803888 
```

我会为 bnum 和 cnum 使用单独的序列。在选择时，您可以（如果需要）使用类似的东西

```
SELECT AID, 
      RANK(BNUM) OVER (PARTITION BY AID ORDER BY BNUM) bnum_seq,
      RANK(CNUM) OVER (PARTITION BY AID ORDER BY CNUM) cnum_seq 
```

# sql-server - enableviewstate = false 时 SQL 登录失败

> ID：357333
> 
> 赞同：0
> 
> 时间：2008-12-10T19:43:27.397
> 
> 标签：sql-server, gridview, asp.net-2.0, viewstate

再会，

我在使用 asp.net 2.0 viewstate 时遇到问题。

基本上，我想禁用网格视图的视图状态。但是，当我这样做时，一旦有回发，甚至在进入 Page_Load 之前，我都会收到“用户 sa 登录失败 ...”。

如果我重新启用视图状态，一切都会顺利进行。

在 PageLoad 中，我将连接字符串设置为所有 SqlDataSource，但正如我所说，错误甚至在 PageLoad 之前就出现了。

在 PageLoad 中，我尝试执行以下操作： MyGridView.DataSourceId = "MySqlDataSource" 但没有运气。我的想法不多了。

任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T20:06:09.113

您必须在页面生命周期的早期执行此操作。

如果您正在开发 ASP.NET 网站并且不了解页面生命周期，请运行，不要走，并阅读以下内容：

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

尝试在 Page_Init 事件期间设置数据源。

# programming-languages - Scheme中柯里化函数的实现

> ID：357353
> 
> 赞同：2
> 
> 时间：2008-12-10T19:48:44.280
> 
> 标签：programming-languages, scheme, racket, currying

当我执行以下操作时会发生什么？

```
(define ((func x) y)
    (if (zero? y)
        ((func x) 1)
        12)) 
```

我知道我可以这样做：

```
(define curried (func 5)) 
```

现在我可以使用咖喱了。我很好奇的是函数的定义。是否行

```
((func x) 1) 
```

以 x 作为参数创建一个新的 lambda，然后在 1 上调用它？或者它是否比这更聪明，它只是重新使用现有的。（例如，如果我这样做`(curried 0)`，该`((func x) 1)`行将等同于`(curried 1)`- PLAI Scheme 这样做吗？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T15:01:35.797

在方案标准中规定

```
(define (f x) 42) is short for (define f (lambda (x) 42)) . 
```

自然（非标准）概括意味着：

```
(define ((f x) y) (list x y)) is short for (define (f x) (lambda (y) (list x y)))
                which is short for (define f (lambda (x) (lambda (y) (list x y)))) 
```

为了测试它，让我们试试 DrScheme 中的例子

欢迎来到 DrScheme，版本 4.1.3.3-svn5dec2008 [3m]。语言：模块；内存限制：384 兆字节。

> （定义（（fx）y）（列表xy））（f 1）
> 
> # 
> 
> ((f 1) 2) (1 2)

如果我们命名临时值，可能更容易看出发生了什么：

> (定义 h (f 1)) (h 2) (1 2) (h 3) (1 3)

由于“PLAI Scheme”是在 DrScheme 中实现的，我相信它继承了这个快捷符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T20:03:51.910

自从我使用方案以来已经太久了，但是您可能会发现[这篇文章](http://www.engr.uconn.edu/~jeffm/Papers/curry.html)很有帮助。它描述了两个宏 c-lambda 和 c-define 的实现，它们允许对 lambda 表达式进行隐式柯里化定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T17:46:42.203

soegaard 的回答是正确的——这是传统的扩展。但是，drscheme 很聪明！

我发现以下代码在运行时间上是等效的：

原始来源：

```
(define ((substitute lv value) e)
  (cond [(LogicVar? e)
     (type-case LogicVar e
       [lv-any (id) (if (symbol=? id (lv-any-id lv))
                value
                e)]
       [lv-cons (f r) 
            (lv-cons ((substitute lv value) f)
                 ((substitute lv value) r))])]
    [(cons? e)
     (cons ((substitute lv value) (car e))
           ((substitute lv value) (cdr e)))]
    [else e])) 
```

尝试优化：

```
(define (substitute lv value)
  (local ([define inner
        (lambda (e)
          (cond [(LogicVar? e)
             (type-case LogicVar e
               [lv-any (id) (if (symbol=? id (lv-any-id lv))
                    value
                    e)]
               [lv-cons (f r) 
                (lv-cons (inner f)
                     (inner r))])]
            [(cons? e)
             (cons (inner (car e))
               (inner (cdr e)))]
            [else e]))])
    inner)) 
```

大量使用此功能的代码（多次，而不仅仅是一次）在两个版本中的运行时间均为 1800 毫秒。更有趣的是，这个版本（我对正在发生的事情的可视化）：

```
(define (substitute lv value)
  (local ([define inner
        (lambda (e)
          (cond [(LogicVar? e)
             (type-case LogicVar e
               [lv-any (id) (if (symbol=? id (lv-any-id lv))
                    value
                    e)]
               [lv-cons (f r) 
                (lv-cons ((substitute lv value) f)
                     ((substitute lv value) r))])]
            [(cons? e)
             (cons ((substitute lv value) (car e))
               ((substitute lv value) (cdr e)))]
            [else e]))])
    inner)) 
```

以 2000 毫秒运行。因此，如果在substitute 中对substitute 的调用都创建了一个lambda，那么肯定会减慢速度，但使用快捷表示法似乎并非如此。

# java - 这在堆栈跟踪中意味着什么？

> ID：357355
> 
> 赞同：11
> 
> 时间：2008-12-10T19:48:49.227
> 
> 标签：java, exception, stack-trace

我在堆栈跟踪中看到了这一点：

> myorg.vignettemodules.customregistration.NewsCategoryVPDAO.getEmailContentByID(I)Lmyorg/pushmail/model/EmailContent；

“ `(I)L`”是什么意思？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-10T19:59:38.160

这是一种[名称修饰](http://en.wikipedia.org/wiki/Name_mangling)形式，用于消除方法重载的歧义。方法名称附加了一系列描述参数和返回类型的字符：参数在括号内按顺序出现，返回类型在右括号之后。代码如下：

*   `Z`：`boolean`
*   `B`：`byte`
*   `C`：`char`
*   `S`：`short`
*   `I`：`int`
*   `J`：`long`
*   `F`：`float`
*   `D`：`double`
*   `L`*全限定类名* `;`：全限定类
*   `[` *type :**类型*数组
**   `V`：`void`*

 *因此，在您的情况下，这`(I)Lmyorg/pushemail/model/EmailContent;`意味着该方法采用一个 type 参数`int`并返回一个 type 对象`myorg.pushemail.model.EmailContent`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-10T19:51:03.607

这意味着该方法需要一个`int`, 并返回`myorg.pushemail.model.EmailContent`

从“L”到“;”的字符串 是一种类型描述符，用于返回类型。括号内的东西是方法参数（在这种情况下，只有一个）。

这些类型描述符被定义为 Java 虚拟机规范的一部分，在[4.3.2 节](http://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.3.2)中。[表 4.3-A](http://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.3.2-200)显示了所有使用的代码。当一个类被编译时，这种形式的描述符用于指定方法的签名以及字段和变量的类型。

在 Java 序列化中，方法描述符是经过散列以形成类默认值的信息的[一部分`serialVersionUID`](http://docs.oracle.com/javase/8/docs/platform/serialization/spec/class.html#a4100)`Serializable`。

在 RMI 中，方法描述符被散列，结果用于识别远程接口[中正在调用的方法。](http://docs.oracle.com/javase/8/docs/platform/rmi/spec/rmi-stubs24.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-01T10:11:09.190

这是一个小问题，但我不认为这是名称修改。名称修饰意味着在名称中添加额外的东西。ZBC 等就是 java 在类文件中编码方法签名的方式。他们没有写布尔值，而是写了一个 Z。这样可以节省空间。

根据维基百科（标准免责声明适用），java 中唯一的名称修饰涉及内部类和 JNI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-13T07:29:16.277

`myorg.vignettemodules.customregistration.NewsCategoryVAPDAO`它说，在被调用的类中没有方法`getEmailContentByID`接受`int`参数[由 (I) 表示] 并返回一个被称为`myorg/pushemail/model/EmailContent`(由“;”关闭) 的对象(由 L 宣布)。

L 和 I 字符用于表示 Java 内部类规范中的类名和整数。

# vba - 如何编写 Excel 宏来选择一组单元格？

> ID：357363
> 
> 赞同：1
> 
> 时间：2008-12-10T19:52:11.920
> 
> 标签：vba, excel, select, range

我正在寻找一个可以运行以选择一致范围的单元格的宏，以便我可以轻松地将它们复制到另一个电子表格。范围是 F3:BJ3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T19:56:14.610

这应该可以解决问题：

```
Public Sub selectCells()
    Range("F3:BJ3").Select
End Sub
```

**编辑：**就此而言，您也可以使用以下内容为您实际执行“复制”命令：

```
Public Sub selectCellsAndCopy()
    Range("F3:BJ3").Select
    Selection.Copy
End Sub
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-02T07:48:03.023

使用这个它工作正常。

```
Sub On_Click()
    ActiveSheet.Range("A1:E1").Select
End Sub 
```

# .net - .NET 中真正的字符串是什么？

> ID：357364
> 
> 赞同：5
> 
> 时间：2008-12-10T19:52:42.493
> 
> 标签：.net, string

字符串实际上是一个字符数组（is-a），还是它有一个字符数组作为内部存储（has-a），还是它自己的对象可以将自己暴露为一个字符数组？

我更倾向于说它是它自己的对象，但是为什么我们总是倾向于说“字符串是字符数组......”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T20:00:18.500

这取决于您对“字符串”一词的定义。

`System.String`.NET 中的类型有一个字符数组作为内部存储（例如，它还存储长度（即 O(1)）等）。

但是字符串这个词通常意味着连续出现的东西，这也可能意味着一个字符数组:))

顺便说一句，当我说`string`类型有一个“字符数组”时，我并不是特指“类型的字段`char[]`”。我的意思是“数组”一词的一般含义，即某事物的有序集合。:))

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-10T20:08:48.983

.NET 字符串不仅仅是一个字符数组。它包含一个字符数组，所以严格来说，它是 has-a。

此外，还有很多与 Unicode 相关的细微之处，它的行为*不像*数组。连接一个字符可能不仅仅是将字符串长度增加一，然后在末尾插入新字符。根据 Unicode 规范化规则，它实际上可能会改变整个字符串。所以它*绝对*不像一个字符数组，但是在类的某个地方，存在这样一个数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T19:55:36.577

字符串的语义是第二种。

.Net String 类维护一个内部存储（has-a），并且可以按照设计人员选择的多种抽象方式公开该存储。

这个问题就像“苹果是红色的圆形东西吗？因为我一直认为它是一种水果。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T19:54:34.847

[MSDN](http://msdn.microsoft.com/en-us/library/362314fe(VS.71).aspx)：字符串类型表示一串 Unicode 字符。

这意味着：它是一个 Unicode 字符数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T19:56:33.377

以抽象的方式（我猜，当在内存中布局时） - 它是一个字符数组。

纠正我，如果我的想法是错误的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T20:01:17.063

String 是一个类的名称。它在不同的语言中有不同的含义。它可以是 unicode 或 ASCII 内部，这意味着它的存储机制是一系列字节。此类提供用于操作其自己的内部存储的函数，并且由于它可以包含各种不同编码的字符，因此不能直接访问和修改它。因此，就您的问题而言，它有一个字节存储。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T20:08:48.530

这取决于语言和实现。在最基本的级别（ascii char* string）上，它是一系列连续的内存地址，每个内存地址都包含一个对应于 ascii 代码的短 int，并以 null (char(0)) 终止。大多数高级语言都提供了一个字符串对象，该对象*具有*字符数组以及方便的方法，因为使用 char* 字符串或多或少会让人感到痛苦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T20:11:08.743

完全取决于你如何看待它。如果你用 GCHandle 固定它，然后查看它所在的内存，你会看到它实际上是一个 32 位长度的描述符，后面紧跟一个 unicode 字符数组（注意 AddrOfPinnedObject 会给你第一个的地址字符，*而不是*长度。如果它给出了长度的地址，那么它对 P/Invoking 的用处要小得多）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-10T20:27:28.383

从功能上讲，字符串是字符的列表或序列。字符串通常以字符数组的形式透明地存储（例如，在 C 中），因此我们经常这样称呼它们。数组允许方便地随机访问字符，这对某些算法很重要。

但是，出于其他目的，将 Unicode 字符串存储为 UTF-8 可能是最合适的形式。请注意，尽管它存储在字节数组中，但字节和字符之间不再存在一对一的对应关系：您的字符串算法通常需要从头开始按顺序访问字符 - 作为列表。

这个故事的寓意是：您的字符串代码应该只在实际需要时才要求随机访问。你可能会惊讶于你很少真正需要一个字符数组。

# java - 从数据库加载 FreeMarker 模板

> ID：357370
> 
> 赞同：27
> 
> 时间：2008-12-10T19:54:19.387
> 
> 标签：java, templates, freemarker

我想将我的 FreeMarker 模板存储在一个看起来像这样的数据库表中：

```
template_name | template_content
---------------------------------
hello         |Hello ${user}
goodbye       |So long ${user} 
```

当收到对具有特定名称的模板的请求时，这应该会导致执行查询，该查询会加载相关的模板内容。这个模板内容，连同数据模型（上面例子中的“用户”变量的值），应该被传递给 FreeMarker。

但是，[FreeMarker API](http://freemarker.sourceforge.net/docs/api/index.html)似乎假设每个模板名称对应于文件系统特定目录中的同名文件。有什么方法可以轻松地从数据库而不是文件系统加载模板？

**编辑：**我应该提到我希望能够在应用程序运行时将模板添加到数据库中，所以我不能简单地在启动时将所有模板加载到新的 StringTemplateLoader 中（如下所示）。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-10T21:26:49.823

我们使用 StringTemplateLoader 来加载我们从数据库中获得的模板（正如 Dan Vinton 建议的那样）

这是一个例子：

```
StringTemplateLoader stringLoader = new StringTemplateLoader();
String firstTemplate = "firstTemplate";
stringLoader.putTemplate(firstTemplate, freemarkerTemplate);
// It's possible to add more than one template (they might include each other)
// String secondTemplate = "<#include \"greetTemplate\"><@greet/> World!";
// stringLoader.putTemplate("greetTemplate", secondTemplate);
Configuration cfg = new Configuration();
cfg.setTemplateLoader(stringLoader);
Template template = cfg.getTemplate(firstTemplate); 
```

**编辑** 您不必在启动时加载所有模板。每当我们访问模板时，我们将从数据库中获取它并通过 StringLoader 加载它，并通过调用 template.process() 我们生成（在我们的例子中）XML 输出。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-10T20:34:37.620

几种方法：

*   创建[TemplateLoader](http://freemarker.sourceforge.net/docs/api/freemarker/cache/TemplateLoader.html)的新实现以直接从数据库加载模板，并在加载任何模板之前将其传递给您的[配置](http://freemarker.sourceforge.net/docs/api/freemarker/template/Configuration.html)实例。`setTemplateLoader()`

*   使用您在应用程序启动时从数据库配置的[StringTemplateLoader 。](http://freemarker.sourceforge.net/docs/api/freemarker/cache/StringTemplateLoader.html)将其添加到上面的配置中。

**根据提问者的编辑**进行编辑，您自己的 TemplateLoader 实现看起来像是要走的路。[在这里](http://freemarker.sourceforge.net/docs/api/freemarker/cache/TemplateLoader.html)查看 Javadoc ，它是一个简单的小接口，只有四个方法，并且它的行为有据可查。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-04-07T08:11:15.817

从 2.3.20 开始，您可以简单地[使用字符串](http://freemarker.org/docs/api/freemarker/template/Template.html#Template-java.lang.String-java.lang.String-freemarker.template.Configuration-)[构造 a`Template`](http://freemarker.org/docs/api/freemarker/template/Template.html#Template-java.lang.String-java.lang.String-freemarker.template.Configuration-)：

```
public Template(String name,
                String sourceCode,
                Configuration cfg)
         throws IOException 
```

这是一个方便的构造函数[`Template(name, new StringReader(sourceCode), cfg)`](http://freemarker.org/docs/api/freemarker/template/Template.html#Template-java.lang.String-java.io.Reader-freemarker.template.Configuration-)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-04-29T21:07:30.593

对于那些寻找一些代码的人，这里就是。请查看代码中的注释以更好地理解。

数据库模板：

```
@Entity
public class DBTemplate implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    private long templateId;

    private String content; // Here's where the we store the template

    private LocalDateTime modifiedOn;

} 
```

TemplateLoader 实现（EMF 是 EntityManagerFactory 的一个实例）：

```
public class TemplateLoaderImpl implements TemplateLoader {

    public TemplateLoaderImpl() { }

    /**
     * Retrieves the associated template for a given id.
     *
     * When Freemarker calls this function it appends a locale
     * trying to find a specific version of a file. For example,
     * if we need to retrieve the layout with id = 1, then freemarker
     * will first try to load layoutId = 1_en_US, followed by 1_en and
     * finally layoutId = 1.
     * That's the reason why we have to catch NumberFormatException
     * even if it is comes from a numeric field in the database.
     *
     * @param layoutId
     * @return a template instance or null if not found.
     * @throws IOException if a severe error happens, like not being
     * able to access the database.
     */
    @Override
    public Object findTemplateSource(String templateId) throws IOException {

        EntityManager em = null;

        try {
            long id = Long.parseLong(templateId);
            em = EMF.getInstance().getEntityManager();
            DBTemplateService service = new DBTemplateService(em);
            Optional<DBTemplate> result = service.find(id);
            if (result.isPresent()) {
                return result.get();
            } else {
                return null;
            }
        } catch (NumberFormatException e) {
            return null;
        } catch (Exception e) {
            throw new IOException(e);
        } finally {
            if (em != null && em.isOpen()) {
                em.close();
            }
        }
    }

    /**
     * Returns the last modification date of a given template.
     * If the item does not exist any more in the database, this
     * method will return Long's MAX_VALUE to avoid freemarker's
     * from recompiling the one in its cache.
     *
     * @param templateSource
     * @return
     */
    @Override
    public long getLastModified(Object templateSource) {
        EntityManager em = null;
        try {
            em = EMF.getInstance().getEntityManager();
            DBTemplateService service = new DBTemplateService(em);
            // Optimize to only retrieve the date
            Optional<DBTemplate> result = service.find(((DBTemplate) templateSource).getTemplateId());
            if (result.isPresent()) {
                return result.get().getModifiedOn().atZone(ZoneId.systemDefault()).toInstant().toEpochMilli();
            } else {
                return Long.MAX_VALUE;
            }
        } finally {
            if (em != null && em.isOpen()) {
                em.close();
            }
        }
    }

    /**
     * Returns a Reader from a template living in Freemarker's cache.
     */
    @Override
    public Reader getReader(Object templateSource, String encoding) throws IOException {
        return new StringReader(((DBTemplate) templateSource).getContent());
    }

    @Override
    public void closeTemplateSource(Object templateSource) throws IOException {
        // Nothing to do here...
    }

} 
```

设置配置类：

```
...
TemplateLoaderImpl loader = new TemplateLoaderImpl();

templateConfig = new Configuration(Configuration.VERSION_2_3_25);
templateConfig.setTemplateLoader(loader);
... 
```

最后，使用它：

```
...
long someId = 3L;
Template template = templateConfig.getTemplate("" + someId);
... 
```

这很好用，并允许您使用 Freemarker 的所有功能，如导入、包含等。请看以下示例：

```
<#import "1" as layout> <!-- Use a template id. -->
<@layout.mainLayout>
... 
```

或在：

```
<#include "3"> <!-- Use a template id. -->
... 
```

我在我自己的 CMS (CinnamonFramework) 上使用这个加载器，它就像一个魅力。

最好的，

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-15T13:24:19.660

老问题，但对于任何有同样问题的人，我实现了一个简单的解决方案，不需要自定义模板加载器或在启动时加载模板。

假设您的数据库中有动态模板：

*数据库：*

```
<p>Hello <b>${params.user}</b>!</p> 
```

您可以创建一个 Freemarker 文件 (ftlh)，它解释接收到的字符串 ( `content`) 并从中生成模板，使用[解释](https://freemarker.apache.org/docs/ref_builtins_expert.html#ref_builtin_interpret)：

*动态.ftlh：*

```
<#assign inlineTemplate = content?interpret>
<@inlineTemplate /> 
```

然后在您的 java 代码中，您只需要从数据库中获取字符串（就像从数据库中检索任何其他数据一样），并使用`interpret`必须生成模板的文件：

*爪哇：*

```
String content = getFromDatabase(); 
Configuration cfg = getConfiguration(); 
String filePath = "dynamic.ftlh";

Map<String, Object> params = new HashMap<String, Object>();
params.put("user", "World");

Map<String, Object> root = new HashMap<>();
root.put("content", content);   
root.put("params", params);     

Template template = cfg.getTemplate(filePath);

try (Writer out = new StringWriter()) {
    template.process(root, out);
    String result = out.toString();
    System.out.println(result);
} 
```

（将方法更改为您想从数据库中获取动态内容并分别获取`getFromDatabase()`Freemarker[配置对象](https://freemarker.apache.org/docs/api/freemarker/template/Configuration.html)的任何内容）`getConfiguration()`

这应该打印：

```
<p>Hello <b>World</b>!</p> 
```

然后您可以更改数据库中的动态内容或创建其他内容、添加新参数等，而无需创建其他 Freemarker 文件 (ftlh)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-24T16:21:47.177

实施配置。

例子 ：

```
@Configuraton
public class FreemarkerConfig {

@Autowired
TemplateRepository tempRepo;

@Autowired
TemplateUtils tempUtils;

@Primary
@Bean   
public FreeMarkerConfigurationFactoryBean getFreeMarkerConfiguration() {
    // Create new configuration bean
    FreeMarkerConfigurationFactoryBean bean = new FreeMarkerConfigurationFactoryBean();
    // Create template loader
    StringTemplateLoader sTempLoader = new StringTemplateLoader();
    // Find all templates
    Iterable<TemplateDb> ite = tempRepo.findAll();
    ite.forEach((template) -> {
        // Put them in loader
        sTempLoader.putTemplate(template.getFilename(), template.getContent()); 
    });
    // Set loader
    bean.setPreTemplateLoaders(sTempLoader);
    return bean;
} 
```

}

然后你可以像这样使用它：

```
@Autowired
private Configuration freemarkerConfig;

  Template template = freemarkerConfig.getTemplate(templateFilePath);
  String html = FreeMarkerTemplateUtils.processTemplateIntoString(template, mapTemplate); 
```

# project-organization - 您如何订购/控制客户文档和资产？

> ID：357388
> 
> 赞同：1
> 
> 时间：2008-12-10T20:00:06.240
> 
> 标签：project-organization

我将自己归类为典型的小型开发人员/独立设计师，我最近为办公室购买了一些新硬件，并认为我比过去更好地组织自己。

所以我想知道你们是如何组织所有文件等的，这样你就可以很容易地找到它们，并将它们联系在一起。

目前我有一个在桌面上运行的网络服务器，我有一个名为 Projects、已关闭项目等的文件夹，每个文件夹都包含一个带有客户端/网站名称的文件夹，并且它包含它们的 Web 文件夹结构。但是您如何处理所有其他文件，通常我会收到 PSD、带有 CSS 布局的 zip 文件、图像、内容文档、电子邮件、徽标、规格、项目文档、要上传到网站的 PDF 等。

您是否使用另一个文件夹（我的文档）和每个文件夹的客户端名称，或者是否有更好的方法来控制所有客户端文件夹。

这尤其针对从客户/经理那里获得大量信息/资源的程序员，因此我认为这是一个关于如何设置自己的重要编程问题，因为干净的设置会带来更好的编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T19:52:51.330

我更喜欢让事情尽可能简单。我从事的每个项目都在其自己的目录中运行。我保留了一个名为“source”的子目录，其中包含所有与项目相关的工件 - 文档、PSD、zip 等等。

我将根据需要随着时间的推移有机地组织它，而不是试图提前制定一个复杂的目录结构——通常只有零碎的东西被使用，所以如果我采用这种方法，我最终会感到困惑。

因为我在 OS X 上进行开发工作，所以快速的 Spotlight 搜索可以让我很快找到我需要的确切文件，而不必费力地浏览大量文件。Google 桌面搜索在 PC 上提供了类似的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T12:07:12.733

我通常为每个客户创建一个文件夹，该文件夹分为资源、项目和常规

我在资源中投入了可能在项目之间反复使用的徽标、小册子、字体等。

项目将包含与特定工作相关的文件。我将开发服务器中的项目开发文件备份到这个文件夹中，并将项目数据库的 SQL 也转储到这里。

一般适用于我想要保存的任何信件（合同、发票 PDF 等）

我同意 Mark 的观点，即使用过于复杂的文件夹结构可能会适得其反。

我还做的其他事情，虽然不是每个人都同意这一点，就是将我的源 PSD 与字体一起压缩，然后在工作完成后将其上传到网络服务器上受保护的 src 文件夹。我已经接管了客户对他们以前的开发商店不满意的网站，在那里进行微小的更改是一件非常痛苦的事情，因为我无法访问字体或源 PSD，而之前的公司要么不愿意，要么提供源文件非常迟缓。在我旅行的情况下，它对我也很有用。

# c# - 列出泛型和强制转换

> ID：357396
> 
> 赞同：0
> 
> 时间：2008-12-10T20:01:30.853
> 
> 标签：c#, generics, casting

我有两个类：媒体和容器。

我有两个列表`List<Media>`和`List<Container>`

我将这些列表传递给另一个函数（一次一个）；

它可以是一个或另一个；

检查列表的“模板”类型的正确方法是什么，以便我可以根据列表类型调用关联方法？

还是我应该尝试投射到 List<> 并在其周围放置 Try/Catch 块？

```
 Object tagObj = mediaFlow1.BackButton.Tag;

    if (tagObj == Media)
       //do this
    else if (tagObj == Container)
        //do this
    else
        throw new Exception("Not a recognized type"); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-10T20:03:35.967

正确的做法是为这个函数设置两个重载，接受每种类型：

```
public void MyMethod(List<Media> source)
{
  //do stuff with a Media List
}

public void MyMethod(List<Container> source)
{
  //do stuff with a Container List
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T20:08:08.547

您可以使用 Type 类型的 GetGenericArguments 方法，如下所示：

对象[] 模板 = myObject.GetType().GetGenericArguments();

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T20:05:42.280

大卫所说的。

但如果这必须通过相同的功能，[`typeof`](http://msdn.microsoft.com/en-us/library/58918ffs.)操作员应该提供帮助。此外，这听起来更像是您存在架构缺陷。Media 类与 Container 类有什么关系？是否有一些他们应该实现的共同接口？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T20:22:24.743

嗯，这取决于你的“//do this”方法是什么......如果它是一个在 Media 或 Container 对象上操作的方法，并且根据它做不同的事情，那么你应该把那个方法放在那些课...

声明一个名为 ICanDoThis 的接口

```
public interface ICanDoThis { void DoThis(); } 
```

确保 Media 和 Container 都实现了该接口

```
public class Media: ICanDoThis { // }
public class Container: ICanDoThis { // } 
```

然后，在您的客户端代码“其他功能”中，您可以

```
 public void OtherFunction(List<ICanDoThis> list)
 {
    foreach(ICanDoThis obj in list)
        obj.DoThis();
 } 
```

就是这样...此代码将根据实际对象的具体类型在 Media Class 或 Container 类中调用适当的实现，而无需编写代码来区分它们...

# asp.net - 内联 .aspx 页面中的导入错误

> ID：357399
> 
> 赞同：4
> 
> 时间：2008-12-10T20:01:48.110
> 
> 标签：asp.net, import

我的内联 .aspx 页面中有一个导入指令（没有代码隐藏）。

出现错误：命名空间“Microsoft.SqlServer”中不存在类型或命名空间名称“Dts”（您是否缺少程序集引用？）

问题是什么？我需要一个包含 .dll 的 /bin 目录吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T20:09:53.413

听起来没有“项目”。在这种情况下，要引用 dll（程序集），请使用[`<%@ Assembly >`](http://msdn.microsoft.com/en-us/library/d864zc1k.aspx)指令。

```
<%@ Assembly Name="microsoft.sqlserver.manageddts.dll" %>
<%@ Import namespace="Microsoft.SqlServer.Dts.Runtime" %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T20:03:21.803

您的项目是否引用了 microsoft.sqlserver.manageddts.dll？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T13:43:35.983

谢谢！难道你不喜欢 SharePoint... 我不得不为引用 Oracle 的功能做 Code Infront：

```
<%@ Assembly Name="System.Data.OracleClient, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" %>
<%@ Import Namespace="System.Data.OracleClient" %> 
```

然后我可以引用这个 OracleClient 程序集中的类：OracleConnection、OracleCommand、OracleDataReader

不好的部分是，我没有编译错误，并且不得不使用非常有用的 SmartPart（来自 codeplex 的儿子或“ReturnOfSmartPartv1_3.wsp”：http://smartpart.codeplex.com/ [）](http://smartpart.codeplex.com/)。

我没有编译错误，但它没有显示我的 SharePoint 功能（来自代码内联 ASCX）......我实际上确实有编译错误，但它“说”它在 VS.NET 中成功编译......所以我使用了 SmartPart在所有注释掉的情况下托管控件，然后我取消注释并按 F5/刷新。

我在 SmartPart 容器中遇到编译错误 - 带有行号！时髦酷！所以现在我的 ASCX 工作得很好，因为我可以使用 SmartPart 来查看它是否工作，如果没有，为什么！

# c++ - 为什么要使用未命名的命名空间，它们有什么好处？

> ID：357404
> 
> 赞同：308
> 
> 时间：2008-12-10T20:03:05.687
> 
> 标签：c++, oop, namespaces

我刚刚加入了一个新的 C++ 软件项目，我正在尝试了解该设计。该项目经常使用未命名的命名空间。例如，类定义文件中可能会出现这样的情况：

```
// newusertype.cc
namespace {
  const int SIZE_OF_ARRAY_X;
  const int SIZE_OF_ARRAY_Y;
  bool getState(userType*,otherUserType*);
}

newusertype::newusertype(...) {... 
```

可能导致使用未命名命名空间的设计注意事项有哪些？有什么优点和缺点？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2008-12-10T20:19:20.320

未命名的命名空间是一种使标识符[翻译单元](https://stackoverflow.com/a/1106167/)本地化的实用程序。它们的行为就像您为命名空间的每个翻译单元选择一个唯一名称：

```
namespace unique { /* empty */ }
using namespace unique;
namespace unique { /* namespace body. stuff in here */ } 
```

使用空主体的额外步骤很重要，因此您已经可以在命名空间主体中引用在该命名空间`::name`中定义的标识符，因为 using 指令已经发生。

这意味着您可以拥有（例如）`help`可以存在于多个翻译单元中的自由函数，并且它们不会在链接时发生冲突。效果几乎与使用`static`C 中使用的关键字相同，您可以将其放入标识符的声明中。未命名的命名空间是一个更好的选择，甚至可以使类型转换单元成为本地的。

```
namespace { int a1; }
static int a2; 
```

两者`a`都是本地翻译单元，不会在链接时发生冲突。但不同的是，`a1`匿名命名空间中的 获得了唯一的名称。

阅读 comeau-computing 上的优秀文章[为什么使用未命名的命名空间而不是静态的？](http://www.comeaucomputing.com/techtalk/#nostatic)（[Archive.org 镜像](https://web.archive.org/web/20181115023158/http://www.comeaucomputing.com/techtalk/#nostatic)）。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2008-12-10T20:08:44.537

在匿名命名空间中包含某些内容意味着它在此[翻译单元](https://en.wikipedia.org/wiki/Translation_unit_(programming))（.cpp 文件及其所有包含）中是本地的，这意味着如果在其他地方定义了另一个具有相同名称的符号，则不会违反[单一定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)(ODR)。

这与具有静态全局变量或静态函数的 C 方式相同，但它也可以用于类定义（并且应该使用而不是`static`在 C++ 中使用）。

同一个文件中的所有匿名命名空间都被视为同一个命名空间，不同文件中的所有匿名命名空间都是不同的。匿名命名空间等价于：

```
namespace __unique_compiler_generated_identifer0x42 {
    ...
}
using namespace __unique_compiler_generated_identifer0x42; 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-05-26T16:56:48.297

未命名的命名空间限制类、变量、函数和对象对定义它的文件的访问。未命名的命名空间功能类似于`static`C/C++ 中的关键字。
`static`关键字限制全局变量和函数对定义它们的文件的访问。
未命名命名空间和关键字之间存在差异，`static`因为未命名命名空间比静态命名空间具有优势。`static`关键字可以与变量、函数和对象一起使用，但不能与用户定义的类一起使用。
例如：

```
static int x;  // Correct 
```

但，

```
static class xyz {/*Body of class*/} //Wrong
static structure {/*Body of structure*/} //Wrong 
```

但是对于未命名的命名空间也是可能的。例如，

```
 namespace {
           class xyz {/*Body of class*/}
           static structure {/*Body of structure*/}
  } //Correct 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-08-29T09:19:10.257

除了这个问题的其他答案之外，使用匿名命名空间还可以提高性能。由于命名空间内的符号不需要任何外部链接，因此编译器可以更自由地对命名空间内的代码进行积极优化。例如，一个在循环中被多次调用的函数可以被内联，而不会对代码大小产生任何影响。

例如，在我的系统上，如果使用匿名命名空间（x86-64 gcc-4.6.3 和 -O2），以下代码将占用大约 70% 的运行时间；请注意 add_val 中的额外代码使编译器不想包含它两次）。

```
#include <iostream>

namespace {
  double a;
  void b(double x)
  {
    a -= x;
  }
  void add_val(double x)
  {
    a += x;
    if(x==0.01) b(0);
    if(x==0.02) b(0.6);
    if(x==0.03) b(-0.1);
    if(x==0.04) b(0.4);
  }
}

int main()
{
  a = 0;
  for(int i=0; i<1000000000; ++i)
    {
      add_val(i*1e-10);
    }
  std::cout << a << '\n';
  return 0;
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-07-24T17:20:04.520

该示例表明您加入的项目中的人不了解匿名命名空间:)

```
namespace {
    const int SIZE_OF_ARRAY_X;
    const int SIZE_OF_ARRAY_Y; 
```

这些不需要在匿名命名空间中，因为`const`对象已经具有静态链接，因此不可能与另一个翻译单元中的同名标识符发生冲突。

```
 bool getState(userType*,otherUserType*);
} 
```

这实际上是一种悲观：`getState()`具有外部联系。通常最好选择静态链接，因为这不会污染符号表。最好写

```
static bool getState(/*...*/); 
```

这里。我陷入了同样的陷阱（标准中的措辞表明文件静态以某种方式被弃用以支持匿名命名空间），但是在像 KDE 这样的大型 C++ 项目中工作，你会得到很多人把你的头转向正确的方式又来了:)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-12-10T20:10:03.707

匿名命名空间使封闭的变量、函数、类等仅在该文件中可用。在您的示例中，这是一种避免全局变量的方法。没有运行时或编译时性能差异。

除了“我希望这个变量、函数、类等是公共的还是私有的？”之外，没有太多的优势或劣势。

# javascript - 绕过IE“您正在查看的网页...”弹出

> ID：357410
> 
> 赞同：11
> 
> 时间：2008-12-10T20:04:20.647
> 
> 标签：javascript, asp.net, internet-explorer, popup

有没有办法绕过下面的 IE 弹出框：

> 您正在查看的 webapge 正在尝试关闭窗口。你想关闭这个窗口吗？是|否

当我将 window.close() 添加到 asp.net 按钮控件的 onclick 事件时，就会发生这种情况。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-11-15T11:13:29.540

# 在打开的弹出窗口中写入以下内容

```
var objWin = window.self;
objWin.open('','_self','');
objWin.close(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T20:12:23.563

您的 JavaScript 代码只能在没有确认的情况下关闭先前由 window.open() 打开的窗口。这是一种有意的安全预防措施，因为在网页上运行的脚本并不拥有该窗口，并且通过关闭它会丢弃该窗口中的浏览历史记录。

解决方法是要么有一个“欢迎页面”，要么有一个弹出你想用 window.open 关闭的窗口的页面，或者告诉你的用户修改他们的浏览器安全设置以允许你的应用程序关闭他们的窗户。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-10T20:56:15.720

对此有一个技巧。

对于 IE 调用：

```
window.open('close.html', '_self'); 
```

然后在 close.html 中，您只需要：

```
<script>window.close();</script> 
```

由于这实质上会在同一个命名窗口中打开一个弹出窗口，因此当“新”窗口打开时，它有一个“开启器”，因此可以关闭。

# ruby - 组织图片（或任何文件）

> ID：357412
> 
> 赞同：1
> 
> 时间：2008-12-10T20:04:54.763
> 
> 标签：ruby, image

这有点牵强，但我有一个有趣的（对我来说）编程（错误...脚本？算法？组织？）问题。（我在 Ruby 中对此进行了标记，因为我更喜欢使用 Ruby 编写脚本。）

想象一下，您有 100 GB 的图片漂浮在多个驱动器上。可能总共有 25 GB 的独特图片。其余的要么是重复的（具有相同的文件名）、重复的（具有不同的名称），要么是图片的较小版本（导出为电子邮件）。当然，除了这些位于多个驱动器上之外，它们还位于不同的文件夹结构中。例如，img_0123.jpg 可能存在（在 Windows 世界中）为 c:\users\username\pics\2008\img_0123.jpg、c:\pics\2008\img_0123.jpg、c:\pics\export\img_0123- email.jpg 和 d:\pics\europe_2008\venice\bungy_jumping_off_st_marks.jpg。

回到过去，我们必须将所有内容都放在文件夹中，然后将它们重命名为非常小的名称（如上所示）。今天，搜索和标记处理了所有这些并且是多余的（并且难以组织）。

过去，我曾尝试将所有内容移动到一个驱动器上，编写了一个 ruby​​ 脚本来扫描重复项（我不相信那些 dupfinder 程序 - 我运行了一个，它开始删除所有内容！），并尝试重新组织它们。但是，几天后，我放弃了（关于组织和手动删除部分）。

我即将开始一个新的想法。首先将我所有驱动器中的所有图片复制到一个新驱动器的一个文件夹中。任何具有重复文件名的内容都需要手动检查。然后启动 Picasa，手动扫描文件并自己删除重复的文件（使用好的 ol' noggen）。

但是，我很不满意我不能以编程方式轻松解决这个问题，并且有兴趣以编程方式或其他方式听到一些其他解决方案（也许编写代码不是最好的解决方案，喘气！）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T20:38:16.850

我喜欢按拍摄日期对照片进行排序，所以我编写了一个 groovy 脚本来查看图片的 EXIF 数据并将它们以 ISO 日期格式 (2008-12-11) 放入目录中。它使他们井井有条。不过，它并没有解决根据内容进行标记的问题，我为此使用了 flickr。

至于重复问题，校验和会减少您必须手动排序的图像数量，但不幸的是它不会拾取调整大小的图像。您可以寻找一个不那么糟糕的欺骗查找器，它不会自动删除重复项？请务必在测试之前进行备份：p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T20:24:57.080

您是否考虑过对每个文件进行 md5 校验和并以这种方式确定重复项？如果你这样做了，你就不必手动解决重复问题。

我将对每个文件进行校验和，并根据已处理文件的字典对其进行检查。如果它作为重复出现，我会将其拍摄到重复目录而不是完全删除它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T09:45:22.517

您可以使用类似[Exiftool 之](http://www.sno.phy.queensu.ca/~phil/exiftool/)类的东西，它确实存在于 Windows 中，根据 CaptureTime（这是我自己的方案）或可以在 JPG 或 RAW 文件中找到的任何其他 Exif 参数重新组织您的图片。您将能够非常轻松地找到重复项。

# file - 如何读取 NASA .hgt 二进制文件

> ID：357415
> 
> 赞同：27
> 
> 时间：2008-12-10T20:05:36.527
> 
> 标签：file, binary

如果您对二进制文件有所了解，我敢肯定这真的很简单，但我是这方面的新手。

如何从 NASA .hgt 文件中提取数据？这是来自 www2.jpl.nasa.gov/srtm/faq.html 的描述：

> **SRTM 数据文件的名称类似于“N34W119.hgt”。字母和数字分别代表什么，什么是“.hgt”格式？**
> 
> 每个数据文件覆盖地球表面一个纬度乘一经度的块。前七个字符表示该块的西南角，其中 N、S、E 和 W 分别表示北、南、东和西。因此，“N34W119.hgt”文件涵盖北纬 34 到 35 度和西经 118-119（该文件包括加利福尼亚州洛杉矶市中心）。文件扩展名“.hgt”仅代表单词“height”，意思是海拔。它不是格式类型。这些文件采用“原始”格式（无标题且未压缩），16 位有符号整数，海拔以米为单位测量，采用“地理”（纬度和经度数组）投影，数据空白由 -32768 表示. 国际 3 角秒文件有 1201 列和 1201 行数据，总文件大小为 2,884,802 字节 (= 1201 x 1201 x 2)。美国 1 角秒文件有 3601 列和 3601 行数据，总文件大小为 25,934,402 字节 (= 3601 x 3601 x 2)。有关更多信息，请阅读 http://edcftp.cr.usgs.gov/pub/data/srtm/Readme.html 上的文本文件“SRTM_Topo.txt”

谢谢你的帮助！我将在 python 脚本中使用这些数据，所以如果你不能对任何其他语言使用任何特定于语言的技巧，那就太棒了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-13T19:09:10.240

一个经过测试的 numpy 示例：

```
import os
import math
import numpy

fn = 'DMV/N51E000.hgt'

siz = os.path.getsize(fn)
dim = int(math.sqrt(siz/2))

assert dim*dim*2 == siz, 'Invalid file size'

data = numpy.fromfile(fn, numpy.dtype('>i2'), dim*dim).reshape((dim, dim)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-10T20:21:12.657

由于记录是固定长度（16 位有符号整数）并且您知道网格大小（1201 x 1201 或 3601x3601），因此 Python 的[struct](http://www.python.org/doc/2.5.2/lib/module-struct.html)模块似乎非常适合（未经测试的代码）：

```
from struct import unpack,calcsize

# 'row_length' being 1201 or 3601 and 'row' being the raw data for one row
def read_row( row, row_length ):
    format = 'h'  # h stands for signed short

    for i in range(0, row_length):
        offset = i * calcsize(format)
        (height,) = unpack(format, row[offset : offset+calcsize(format))
        # do something with the height 
```

用更通用的术语来描述它，基本上你想一次读取 2 个字节的文件，将读取的字节解析为 16 位有符号整数并处理它。由于您已经知道网格大小，您可以逐行或以任何其他对您的应用程序方便的方式读取它。这也意味着您可以随机寻找数据文件中的特定坐标。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T11:58:29.360

如果您想要比从数百万次调用 struct.unpack 获得的速度快一点，请查看 array.array。虽然“struct-and-for-loop”的实现在我公认的慢速笔记本电脑上需要几秒钟，但以下内容几乎是瞬间完成的：

```
from array import array

f = open(filename, 'rb')
format = 'h'
row_length = 1201
data = array(format)
data.fromfile(f, row_length*row_length)
data.byteswap()
f.close() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-08T12:48:50.747

[https://gdal.org/drivers/raster/srtmhgt.html](https://gdal.org/drivers/raster/srtmhgt.html)

```
 Input_HGT = 'N30E120.hgt'
    import gdal
    Raster = gdal.Open(Input_HGT) 
```

GDAL 在栅格文件上可用的所有函数都可以应用于此“栅格”，例如 [变量“栅格”可用的函数](https://i.stack.imgur.com/Ct4Kq.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T14:39:23.893

NASA SRTM 数据文件采用 Big-Endian 格式，因此根据您在哪个平台上读取数据，您可能需要将 Big-Endian 转换为 Little-Endian。

有很多关于如何做到这一点的资料，我没有使用 Python 的经验，所以我无法帮助你。

但如果你忘记了这一点，你的价值观就会一团糟。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-06T05:46:16.730

如果您有 Photoshop，您可能可以使用原始导入来让它读取这些文件并将它们保存到更有用的东西中。过去，我在做这类事情方面取得了一些成功。

# java - 在 Java 中删除数组中重复项的最佳方法是什么？

> ID：357421
> 
> 赞同：15
> 
> 时间：2008-12-10T20:07:08.643
> 
> 标签：java, filtering, duplicates

我有一个需要删除/过滤重复项的对象数组。我打算只覆盖 Object 元素上的 equals 和 hach​​Code，然后将它们放在 Set 中……但我认为我至少应该轮询 stackoverflow 以查看是否有其他方法，也许是其他 API 的一些聪明方法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-10T20:13:48.553

我同意你的方法来覆盖`hashCode()`和`equals()`使用实现`Set`.

这样做也使任何其他开发人员都清楚地知道非重复特征是必需的。

另一个原因 - 您现在可以选择最能满足您需求的实现：

*   [哈希集](http://java.sun.com/j2se/1.5.0/docs/api/java/util/HashSet.html)
*   [树集](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeSet.html)
*   [链接哈希集](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedHashSet.html)

并且您不必更改代码来更改将来的实现。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T20:16:22.213

我在网上找到了这个

这里有两种方法可以让您删除 ArrayList 中的重复项。removeDuplicate 不维护顺序，而 removeDuplicateWithOrder 以一些性能开销维护顺序。

1.  removeDuplicate 方法：

    ```
    /** List order not maintained **/
    public static void removeDuplicate(ArrayList arlList)
    {
     HashSet h = new HashSet(arlList);
     arlList.clear();
     arlList.addAll(h);
    } 
    ```

2.  removeDuplicateWithOrder 方法：

    ```
    /** List order maintained **/
    public static void removeDuplicateWithOrder(ArrayList arlList)
    {
       Set set = new HashSet();
       List newList = new ArrayList();
       for (Iterator iter = arlList.iterator(); iter.hasNext();) {
          Object element = iter.next();
          if (set.add(element))
             newList.add(element);
       }
       arlList.clear();
       arlList.addAll(newList);
    } 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T20:14:58.330

覆盖`equals`和`hashCode`创建一个集合也是我的第一个想法。无论如何，在您的继承层次结构中拥有这些方法的一些覆盖版本是一种很好的做法。

我*认为*如果你使用 a`LinkedHashSet`你甚至会保留独特元素的顺序......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T00:28:56.557

基本上，您需要一个`LinkedHashSet<T>`支持`List<T>`随机访问接口的实现。因此，这就是您需要的：

> `public class LinkedHashSetList<T> extends LinkedHashSet<T> implements List<T> {`
> 
> `// Implementations for List<T> methods here` `...`
> 
> `}`

方法的实现`List<T>`将访问和操作底层的`LinkedHashSet<T>`. 诀窍是在尝试通过 add 方法添加重复项时让此类行为正确`List<T>`（抛出异常或在不同的索引处重新添加项目将是选项：您可以选择其中之一或使其用户可配置班上）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-19T03:50:20.700

使用 List `distinctList` 记录第一次`iterator`偶然发现的元素，返回 distinctList 作为列表删除所有重复项

```
 `private List removeDups(List list) {
        Set tempSet = new HashSet();
        List distinctList = new ArrayList();
        for(Iterator  it = list.iterator(); it.hasNext();) {
            Object next = it.next();
            if(tempSet.add(next)) {
                distinctList.add(next);
            } 
        }
        return distinctList;
   }` 
```

* * *

 `## 回答 #6

> 赞同：1
> 
> 时间：2008-12-10T21:41:29.327

我想重申 Jason 在评论中提出的观点：

为什么要把自己放在那个时候呢？

为什么将数组用于根本不应该包含重复项的数据结构？

始终使用 a`Set`或 a `SortedSet`（当元素也具有自然顺序时）来保存元素。如果您需要保留插入顺序，则可以使用`LinkedHashSet`已指出的 。

必须对某些数据结构进行后处理通常暗示您应该选择不同的开始。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-10T22:03:39.937

当然，原来的帖子引出了一个问题，“你是如何得到那个数组（可能包含重复的条目）的？”

您是否需要将数组（带有重复项）用于其他目的，或者您可以从一开始就简单地使用 Set 吗？

或者，如果您需要知道每个值的出现次数，您可以使用 a`Map<CustomObject, Integer>`来跟踪计数。此外，Multimap 类的[Google Collections](http://code.google.com/p/google-collections/)定义也可能有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T20:14:08.410

A`Set`绝对是你最好的选择。从数组中删除东西（不创建新数组）的唯一方法是将它们清空，然后你会在以后进行大量的空检查。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-10T20:17:45.313

从一般编程标准来看，您总是可以双重枚举集合，然后比较源和目标。

如果你的内部枚举总是在源之后开始一个条目，它是相当有效的（伪代码遵循）

```
foreach ( array as source )
{
    // keep track where we are in the array
    place++;
    // loop the array starting at the entry AFTER the current one we are comparing to
    for ( i=place+1; i < max(array); i++ )
    {
        if ( source === array[place] )
        {
            destroy(array[i]);
        }
    }
} 
```

可以说，您可以添加一个休息时间；销毁后的语句，但您只发现第一个重复项，但如果这就是您将拥有的全部，那么这将是一个不错的小优化。

# django - 跨模型的 Django 查询集？

> ID：357425
> 
> 赞同：8
> 
> 时间：2008-12-10T20:07:42.463
> 
> 标签：django, django-models, django-queryset

我有几个模型并且想要返回属于用户的所有模型的查询集，我想知道是否可以从多个模型返回一个查询集？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T23:03:17.570

我假设您的意思是您希望从每个模型返回属于用户的所有对象的单个查询集。

你需要一个查询集还是只需要一个可迭代的？AFAIK，异构 qs 是不可能的。但是，您可以轻松返回列表、链式迭代器 (itertools) 或生成器来执行您想要的操作。这假设引用用户的模型是提前知道的。假设默认的related_name，可以通过模型的名称从用户实例访问相关的查询集属性：

```
qs = getattr(user, '%s_set' % model_name.lower()); 
```

当然，使用任何异构列表，您要么只能使用在所有此类模型中定义的字段或方法，要么必须确定每个对象的类型才能执行任何类型特定的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T20:55:03.040

您的模型必须包含关系字段（ForeigKey 和 ManyToManyField），并设置了相关名称关键字参数。[在此处](http://docs.djangoproject.com/en/dev/topics/db/queries/#backwards-related-objects)查看文档。

# c# - 如何从 vbScript 调用 .NET 代码 (C#/vb.net)？

> ID：357440
> 
> 赞同：6
> 
> 时间：2008-12-10T20:12:49.943
> 
> 标签：c#, .net, com, asp-classic

我想我可以编译一个 C# DLL，然后将它公开为一个 COM 对象，以便它可以从 VBscript 中创建对象。我只是不确定这样做所涉及的步骤......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T21:32:33.683

这样做非常简单。但也有很多地方没那么简单。这在很大程度上取决于您的班级需要能够做什么，以及您打算如何部署它。

需要考虑的一些问题：

*   你的类必须有一个无参数的构造函数。
*   它不能公开静态方法。
*   在全局程序集缓存中部署 COM DLL 好吗？如果没有，您将不得不给它一个强名称并使用`regasm /codebase`.
*   您是否关心标识类及其接口的 GUID？如果没有，您可以`regasm`分配它们，但是每次（和每个地方）注册课程时它们都会有所不同。如果您需要 GUID 在安装过程中保持不变，则需要使用该`Guid`属性标记成员。
*   您是否要在 .NET 和 COM 之间使用数据类型的默认封送处理？如果没有，您将需要使用`MarshalAs`属性标记属性和方法。
*   你的类公开什么样的 COM 接口对你来说很重要吗？如果是这样，您将需要处理该`InterfaceType`属性。
*   您的班级是否需要提出或回应事件？如果是这样，那么对你如何设计你的类接口有影响。

[这里](http://www.codeproject.com/KB/COM/cominterop.aspx)有一篇关于 COM 互操作和 .Net 的非常好的（如果过时的话）文章。（这篇文章谈到的很多事情，比如生成类型库，现在都是自动为您处理的。）[微软的文档](http://msdn.microsoft.com/en-us/library/zsfww439.aspx)是最新的，但不是很详细。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-10T20:17:18.390

您应该使用该`regasm`实用程序来注册程序集（就像`regsvr32`使用 COM 服务器一样）。然后你可以从 COM 使用它。确保它已安装在 GAC 中。这些东西应该`[ComVisible(true)]`可以从 COM 中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T20:17:23.163

您可以选择的每个项目都有一个“COM Accessible”选项。然后，当然，您必须注册程序集才能使用它，但仅此而已。

* * *

我不得不为 C# 寻找它（我习惯于 VB.Net），但您可以通过双击`Properties`解决方案资源管理器中的文件夹，选择`Application`选项卡，然后单击`Assembly Information...`按钮来找到该选项。

# debugging - 如何调试 MSBuild 自定义任务

> ID：357445
> 
> 赞同：18
> 
> 时间：2008-12-10T20:13:56.213
> 
> 标签：debugging, msbuild

我正在尝试调试我刚刚创建的 MSBuild Customtask，但由于某种原因，它永远不会在断点处停止。我什至试过这个：

```
 public override bool Execute()
    {
        System.Diagnostics.Debugger.Break(); 
```

并在该行添加了一个断点...我什至消除了该方法中的所有其他代码，但这并没有改变任何东西。

是否有任何特殊要求能够为 MSBuild 调试自定义任务的创建？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-10T20:42:55.810

这有点小技巧，但你总是可以把这行代码放在你想开始调试的任何地方：

```
System.Diagnostics.Debugger.Launch(); 
```

当您调用它时，CLR 将启动一个对话框，询问您要附加的调试器。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-11T21:49:13.960

这就是我所做的......在“调试”选项卡上的“项目属性”对话框中选择“启动外部应用程序” - 将 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MSBuild.exe 放入框中..

然后在命令行参数中，输入你的参数 /Target:Whatever test.proj

在您的自定义任务中放置一个代码停止并启动应用程序..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-28T14:44:56.263

您可以设置环境变量`MSBUILDDEBUGONSTART=1`以`MSBuild.exe`在应用程序启动时提示启动调试器。

然后，您可以选择用于开发任务的 Visual Studio 实例作为调试器，并在任务代码中设置断点。

这通常比修改要调用的任务要困难一些`Debugger.Launch()`，但它可以用于发布版本并且无需修改任务，这可能很有用。

这里有一个主要警告：当您使用 构建时`-m`，MSBuild 将启动多个进程，并且*每个*进程都会提示附加一个调试器。在执行此操作时尝试构建`-m:1`或构建单个项目，这样您就不会意外产生数十个要调试的进程。

# .net - .NET：是否有用于将对象属性的值插入字符串的 String.Format 表单？

> ID：357447
> 
> 赞同：9
> 
> 时间：2008-12-10T20:14:24.183
> 
> 标签：.net, string, string.format

我认为这个问题的直接答案是“不”，但我希望有人写了一个真正简单的库来做到这一点（或者我可以做到......呃......）

让我用一个例子来展示我在寻找什么。假设我有以下内容：

```
class Person {
  string Name {get; set;}
  int NumberOfCats {get; set;}
  DateTime TimeTheyWillDie {get; set;}
} 
```

我希望能够做这样的事情：

```
static void Main() {
  var p1 = new Person() {Name="John", NumberOfCats=0, TimeTheyWillDie=DateTime.Today};
  var p2 = new Person() {Name="Mary", NumberOfCats=50, TimeTheyWIllDie=DateTime.Max};

  var str = String.Format(

"{0:Name} has {0:NumberOfCats} cats and {1:Name} has {1:NumberOfCats} cats.  They will die {0:TimeTheyWillDie} and {1:TimeTheyWillDie} respectively
", p1, p2);

  Console.WriteLine(str);
} 
```

有谁知道是否有一种格式可以做这样的事情，或者是否有人写了一个库来做这样的事情？我知道这不应该太难，但我宁愿不重新实现轮子。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T22:07:21.367

编辑：您不必为每个对象实现 IFormattable ......那将是一个 PITA，严重限制和相当大的维护负担。只需将 Reflection 和 IFormatProvider 与 ICustomFormatter 一起使用，它就可以与*任何*对象一起使用。String.Format 有一个重载，可以将其作为参数。

我以前从来没有想过这个，但是你让我很感兴趣——所以我不得不快速旋转一下。请注意，我选择允许将额外的格式字符串传递给属性值，并且它仅适用于非索引和可访问的属性（尽管您可以轻松添加它）。

```
public class ReflectionFormatProvider : IFormatProvider, ICustomFormatter {
    public object GetFormat(Type formatType) {
        return formatType == typeof(ICustomFormatter) ? this : null;
    }

    public string Format(string format, object arg, IFormatProvider formatProvider) {
        string[] formats = (format ?? string.Empty).Split(new char[] { ':' }, 2);
        string propertyName = formats[0].TrimEnd('}');
        string suffix = formats[0].Substring(propertyName.Length);
        string propertyFormat = formats.Length > 1 ? formats[1] : null;

        PropertyInfo pi = arg.GetType().GetProperty(propertyName);
        if (pi == null || pi.GetGetMethod() == null) {
            // Pass thru
            return (arg is IFormattable) ? 
                ((IFormattable)arg).ToString(format, formatProvider) 
                : arg.ToString();
        }

        object value = pi.GetGetMethod().Invoke(arg, null);
        return (propertyFormat == null) ? 
            (value ?? string.Empty).ToString() + suffix
            : string.Format("{0:" + propertyFormat + "}", value);
    }
} 
```

以及您稍作修改的示例：

```
var p1 = new Person() {Name="John", NumberOfCats=0, TimeTheyWillDie=DateTime.Today};
var p2 = new Person() {Name="Mary", NumberOfCats=50, TimeTheyWillDie=DateTime.MaxValue};

var str = string.Format(
    new ReflectionFormatProvider(),
    @"{0:Name} has {0:NumberOfCats} cats and {1:Name} has {1:NumberOfCats} cats. 
    They will die {0:TimeTheyWillDie:MM/dd/yyyy} and {1:TimeTheyWillDie} respectively.
    This is a currency: {2:c2}.", 
    p1, 
    p2,
    8.50M
);

Console.WriteLine(str); 
```

输出：

```
John has 0 cats and Mary has 50 cats. 
They will die 12/10/2008 and 12/31/9999 11:59:59 PM respectively.
This is a currency: $8.50. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T20:16:04.773

您可以为您的班级覆盖 ToString()。

好文章[在这里](http://codebetter.com/blogs/david.hayden/archive/2005/02/24/55984.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-10T20:18:08.763

“：”之后的内容作为参数传递给您的类的 ToString 方法。
只需声明一个接受字符串的 ToString 方法，“Name”、“NumberOfCats”等将在该参数中传递。

编辑：您必须实现 System.IFormattable。这有效：

```
class Person : IFormattable
{
    public override string ToString()
    {
        return "Person";
    }

    public string ToString(string format, IFormatProvider formatProvider)
    {
        if (format == "Name")
        {
            return "John";
        }
        if (format == "NumberOfCats")
        {
            return "12";
        }
        return "Unknown format string";
    }

}

class Program
{
    static void Main(string[] args)
    {
        Person p = new Person();
        Console.WriteLine(string.Format("Name = {0:Name}",p));
        Console.WriteLine(string.Format("NumberOfCats = {0:NumberOfCats}", p));
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-26T06:22:19.583

看看我的图书馆“膨胀”

在 Nuget 上：http: [//nuget.org/List/Packages/Expansive](http://nuget.org/List/Packages/Expansive)

在 GitHub 上：http: [//github.com/anderly/expansive](http://github.com/anderly/expansive)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T20:21:58.160

我真的不明白这是怎么回事：

```
"{0:Name} has {0:NumberOfCats} cats and {1:Name} has {1:NumberOfCats} cats.  They will die {0:TimeTheyWillDie} and {1:TimeTheyWillDie} respectively", p1, p2); 
```

比这更好：

```
"{0} has {1} cats and {2} has {3} cats.  They will die {4} and {5} respectively
", p1.Name, p1.NumberOfCats, p2.Name, p2.NumberOfCats, p1.TimeTheyWillDie, p2.TimeTheyWillDie); 
```

事实上，由于您在第一个中失去了智能感知帮助，不仅它更容易失败，而且在 IDE 中编写可能需要更长的时间。

如果你想做这样的事情，你总是可以为它设计一个扩展方法。我敢打赌，这看起来就像一场噩梦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T20:22:12.733

这是 Python 世界中许多人通过使用“someString % locals()”所做的事情。尽管您的建议与 string.format 的工作方式有几个根本性的突破：

*   通常占位符符号在冒号后具有字符串格式信息，而您想要进行属性访问。

*   占位符索引（{0、{1 等）通常是指 params 参数中的 numberes 参数，但您似乎希望您的函数为传入的每个参数呈现整个字符串。应该将它们连接起来吗？作为字符串数组返回？

所以你最终可能会自己写这个，在这种情况下你可以完全跳过索引符号（所以 {NumberOfCats} 而不是 {0:NumberOfCats} 甚至使用属性名称后跟格式提供程序 {NumberOfCats:c}。使用元数据从输入对象不应该太难。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T20:25:55.453

Boo 或 Nemerle 有类似的东西。几年来，我一直试图想一个简单的方法来做这件事，但没有简单的答案。

您能做的最好的事情是为您提供自己的 IFormatProvider，并手动解析输入（糟糕的部分......）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-10T20:28:18.883

如果你决定自己解析格式字符串，你应该考虑这个......：

Spring.NET 项目在 Spring.Core 中有[Spring.NET 表达式语言。](http://www.springframework.net/doc-latest/reference/html/expressions.html)它允许您通过使用字符串指向属性来查询对象图。使用您的示例，您可以想象这样的事情：

```
var person = new Person { Name = "joe", Email = new Email { Address = "joe@joe.com" } };

var message = string.Format("{0}'s e-mail is {1}",
    ExpressionEvaluator.GetValue(person, "Name"), 
    ExpressionEvaluator.GetValue(person, "Email.Address")); 
```

（我可能不会存储这样的电子邮件，但我想不出更好的东西）

# .net - 如何从 .Net 调用 Pb 生成的本机 Win32 dll？还是来自其他地方？

> ID：357452
> 
> 赞同：0
> 
> 时间：2008-12-10T20:15:26.553
> 
> 标签：.net, dll, powerbuilder

我一直在尝试链接到 Pb (11.5) 生成的本机 Win32 dll：来自不同的 Pb 应用程序和 .net (2.0) 应用程序。我知道注册的 COM 对象对 Pb 是可见的。我想要做的是在本机 Win32 dll 中使用 Pb（运行 11.5 Enterprise）调用函数——而不是 COM。我还想换一种方式：我想要一个 Win32 exe（本机和 .net）调用 Pb 生成的 dll 中的函数。我的成功有限。

**场景一：pb 生成原生 Win32 exe & dll。**

我创建了一个简单的应用程序，其中包括单独的 pbl（称为 shared.pbl）和一些琐碎的函数（包括返回字符串 HelloWorld 的函数）。该项目构建为一个 exe 和一个单独的 dll。它可以工作（单击按钮会在标签中显示文本 HelloWorld）。

在一个*单独*的Pb 工作区中，我创建了一个几乎相同的应用程序，但*没有*shared.pbl。我声明了一个外部函数来引用第一个工作区中的 shared.dll：

```
 function int GetSystemMetrics( int index ) library "user32.dll";
 function int f_rtn_int( int number ) library "shared.dll"; 
```

运行应用程序——单击绑定到 GetSystemMetrics() 的按钮有效。单击第二个按钮以访问 shared.dll 失败，并显示“调用外部函数时出错 ...”消息。

我能够让第二个应用程序工作的*唯一方法是在目标属性的库列表选项卡下**添加*shared.dll。 *然而*，这似乎导致 dll 的内容嵌入到生成的 exe 中——我可以删除 shared.dll 并且第二个应用程序运行得很好！

***如何在 Pb 中引用外部 Win32 dll，而无需将 dll 嵌入生成的 Pb 代码中？*** 请记住，shared.dll 是由 Pb 在单独的工作区中生成的。

**场景二：.Net exe 访问 Pb 生成的 dll**

接下来，我创建了一个简单的 .net 应用程序（.net v2.0，vs2005），它具有与 Pb 应用程序并行的功能。我引用shared.dll：

```
 [DllImport( "user32.dll" )]
  static extern int GetSystemMetrics( int smIndex );
  [DllImport( "shared.dll" )]
  static extern string f_get_hello_world(); 
```

并尝试调用 HelloWorld 函数，我得到 .net 错误：

```
 Unable to find an entry point named 'f_get_hello_world' in DLL 'shared.dll' 
```

使用编辑器/反汇编器，我发现函数名称已被修改为“_getVtableInfo_f_get_hello_world@12”。我在声明上尝试了不同的命名变体，并在没有运气的情况下调用。

***是否可以从另一种语言（c++、c#）引用由 Pb 创建的本机 Win32 dll？如果是这样，怎么做？***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T05:18:53.383

基本上，你没有。您可以创建一个 COM 对象项目，或者使用 11 或 11.5 您可以创建一个 .NET 程序集。“本机”生成创建的 DLL 不是标准的 Windows DLL，因此不能用普通的 DLL 方法调用。

祝你好运，

特里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T05:28:12.007

如果 Pb 在您的函数定义中遵循“extern C”，那么它应该使用未损坏的名称导出它们。

对于为什么删除 dll 似乎可以并且程序仍然运行的另一个问题，我只能给出一个稍微可能的猜测：看看是否某个工具制作了 dll 的另一个副本并且它仍然存在。

# eclipse - Eclipse编码转换

> ID：357461
> 
> 赞同：7
> 
> 时间：2008-12-10T20:18:00.633
> 
> 标签：eclipse

有谁知道任何可让您轻松更改和使用文件编码的 ecipe 插件？我有时需要编辑模板文件来做一些小的调整，但这些文件有时是 ISO，有时是 UTF8，有时是其他文件，所以使用 eclipse 会导致灾难:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-28T21:46:00.227

试试这个来转换一个文件：

1.  将文件的全部内容复制到剪贴板（在 Mac 上按`ctrl+c`或）`cmd+c`
2.  右键单击文件，然后打开“属性”并将文本文件编码更改为首选的编码
3.  按`ctrl-a`（或`cmd-a`在 Mac 上）选择整个文本并将其替换为剪贴板的内容（`ctrl-v`或`cmd-v`）

来源：[http ://artur.ejsmont.org/blog/Convertig-file-encoding-to-UTF-8-from-other-Unicode-and-removing-Byte-Order-Marks](http://artur.ejsmont.org/blog/Convertig-file-encoding-to-UTF-8-from-other-Unicode-and-removing-Byte-Order-Marks)

在我的 Mac 上工作！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-19T00:05:26.683

更改属性中的编码与对文件进行转码完全相反：它重新解释文件的内容，就好像它是以指定的编码进行编码一样。这也很有用，但不是 Prody 想要的功能。

显然没有办法在 Eclipse 中实际对文件进行转码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-10T20:44:20.520

这应该在每个文件的属性中。

在“信息”标题下，有一个“文本文件编码”组。您可以将选择更改为“其他”，然后从那里选择所需的编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-18T11:33:49.843

我刚刚为 Eclipse “**自动检测编码”找到了一个****插件**——您可以检测/转换文件中的编码。它可以在帮助->市场中找到...

 **我刚开始测试，但到目前为止它还有效。

提示：有时您需要将检测器更改为 ICU4j

即使转换在当前文档中不起作用（由于检测），您也可以这样做：`CTRL`+`C`在一个编码开关上切换到另一个，`CTRL`+`V`它将正确粘贴然后保存。

# c# - 我可以在运行时将 ConnectionStrings 添加到 ConnectionStringCollection 吗？

> ID：357465
> 
> 赞同：20
> 
> 时间：2008-12-10T20:19:47.590
> 
> 标签：c#, asp.net, web-config, connection-string

有没有一种方法可以在 Asp.Net 应用程序中将连接字符串添加到 ConfigurationManager 在运行时返回的 ConnectionStringCollection 中？

我尝试了以下方法，但被告知配置文件是只读的。

```
ConfigurationManager.ConnectionStrings.Add(new ConnectionStringSettings(params)); 
```

还有其他方法可以在运行时执行此操作吗？我知道在设计时我可以将连接字符串添加到 web.config；但是，我希望在运行时向该集合添加一些内容。

谢谢

编辑：我尝试这样做的原因之一是由于安全要求阻止我将 ConnectionStrings 放在 web.config 中（甚至加密）。我想在我的项目中使用 Membership 和 Profiles 等元素；但是，我正在寻找一种替代方法，而不是编写自定义提供程序。自定义提供程序并不是那么糟糕，但如果我能找到更简单的解决方案，我完全赞成。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-12-13T18:29:41.697

您可以使用反射来禁用私有 bReadOnly 字段（坏主意等）：

```
typeof(ConfigurationElementCollection)
    .GetField("bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic)
    .SetValue(ConfigurationManager.ConnectionStrings, false);
ConfigurationManager.ConnectionStrings.Add(new ConnectionStringSettings()); 
```

这类似于[修改现有连接字符串](http://david.gardiner.net.au/2008/09/programmatically-setting.html)所需的技术，并由 Brian Rodgers 作为评论添加。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T20:49:54.487

```
var cfg = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(@"/");
cfg.ConnectionStrings.ConnectionStrings.Add(new ConnectionStringSettings(params));

cfg.Save(); 
```

请注意，这将导致您的网站进行回收，因为它会修改配置文件。查看[http://msdn.microsoft.com/en-us/library/4c2kcht0(VS.80).aspx](http://msdn.microsoft.com/en-us/library/4c2kcht0%28VS.80%29.aspx)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-10T21:01:28.567

只是指出谁给了你不能将连接字符串放在 web.config 中的“安全要求”是一个白痴。除了您的应用程序或对服务器的远程访问之外，任何东西都不能访问 web.config。

这听起来完全像一个需求问题，应该在那里解决。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-10T20:47:32.197

如果您尝试在运行时编辑 web.config 中的连接字符串，请查看[WebConfigurationManager](http://msdn.microsoft.com/en-us/system.web.configuration.webconfigurationmanager.aspx)。

如果您只是想在运行时修改配置以注入连接字符串，那么您就不走运了。ConfigurationManager 对象树旨在直接反映配置文件，如果您能够更改该状态将不一致。

我建议创建一个简单的外观类，您可以使用它来检索您的连接字符串。这样，您可以让外观从您的动态集合中返回一个连接字符串，或者如果一个不存在，那么它可以从 ConfigurationManager 中获取它。

```
class ConnectionStringProvider
{
    Dictionary<string, System.Configuration.ConnectionStringSettings> _localStrings = new Dictionary<string, System.Configuration.ConnectionStringSettings>();

    public void AddLocalConnectionString(string name, string connstring)
    {
        System.Configuration.ConnectionStringSettings cs = new System.Configuration.ConnectionStringSettings(name, connstring);
        _localStrings.Add(name, cs);
    }

    public void RemoveLocalConnectionString(string name)
    {
        _localStrings.Remove(name);
    }

    public System.Configuration.ConnectionStringSettings this[string name] {
        get 
        { 
            return _localStrings.ContainsKey(name) ? _localStrings[name] : System.Configuration.ConfigurationManager.ConnectionStrings[name]; 
        }
    }
} 
```

或者，您总是可以更重一些并使用 Enterprise Library Configuration Block 之类的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-10T20:56:39.590

还没有尝试过，但也许您可以在运行时更改现有连接字符串的值？例如，而不是：

```
ConfigurationManager.ConnectionStrings.Add(new ConnectionStringSettings(params)); 
```

也许您可以执行以下操作：

```
ConfigurationManager.ConnectionStrings["myconnection"].ConnectionString = "something"; 
```

如果是这样，您可以在配置中指定连接字符串“变量”，但将它们设置为 false 或空连接字符串：

```
<add name="myconnection" connectionString="SET AT RUNTIME" ... /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T01:54:28.957

配置基础结构通过 Windows DataProtection API 支持非常强大的加密，该 API 使用机器特定的密钥来加密配置部分。这样，除了在加密的机器上，不可能在任何地方读取加密数据。

这与 Windows 中用于政府兼容驱动器/文件夹加密的 API 相同。这是否符合贵公司的安全要求？

您可以手动或通过您的部署自动化执行此命令来加密特定 Web 应用程序的 web.config 的 connectionStrings 部分。

```
aspnet_regiis -pe "connectionStrings" -app "/MyCoolWebApplication" -prov "DataProtectionConfigurationProvider" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T02:00:53.047

如果您使用的是 MS SQL，您可以将 Web 服务器配置为通过 Windows 身份验证访问 SQL Server，因此您无需在 webconfig 中设置任何密码，甚至无需在应用程序内存中使用任何密码。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-10T20:31:31.730

不，您不能在运行时修改配置文件，它不是为此而设计的。也许您可以使用 Enterprise Libraries Configuration 来做到这一点。

# asp.net - .NET - 如何为大型 CSS 文件构建主题

> ID：357470
> 
> 赞同：3
> 
> 时间：2008-12-10T20:21:34.793
> 
> 标签：asp.net, css, themes

我负责使用我刚刚继承的大型 CSS 文件（数千个元素）为网站提供主题功能。基本上我们希望允许用户能够改变屏幕上的颜色。

每个 CSS 元素，除了颜色定义之外，还有许多其他属性——大小、字体、浮点数等……以及特定的颜色出现在各种 CSS 元素中。

如果我使用 ASP.NET 的主题功能为每个主题创建不同的 CSS 文件，我必须在所有主题中复制我的 CSS 文件，这将成为维护的噩梦。

理想情况下，我希望有一个 CSS 文件（用于维护）并且只能更改颜色属性。

这里有哪些选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T20:26:12.397

你只需要复制颜色属性，所以如果你有

```
a:hover
{
   text-decoration:none;
   color:Black;
   display:block    
} 
```

在您的主题的 css 文件中，您只需要：

```
a:hover
{
    color:Red;
} 
```

现在在您的页面中，您要确保仍然引用原始 css 文件，并且浏览器将合并所有样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T20:30:49.673

如果差异很小，则可能的方法是 CSS 级联规则，例如：

html:

```
<body class="dark">
    <a ...>some text</a>
</body> 
```

CSS：

```
/* default */
body { color:white }
    a { color:blue }

/* dark theme */
body.dark { color:black }
    .dark a { color:white } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T20:33:44.737

我认为保留一个 CSS 文件可能不是一个好主意，特别是因为主题的目的是拥有多个。我建议使用两个 CSS 文件，一个基本的（你已经使用的）和当前的主题，它们在基本的文件之后被包含/链接，并覆盖你想要的与基本不同的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T20:40:38.280

像 TravisO 一样，我建议使用两个 CSS 文件……但我不会让你已经使用的基础文件。我将从您的基础数据中提取所有颜色数据并将其添加到新的“默认”主题中。

这样，您的定位细节都在一个位置，并且您的主题只有颜色信息。除了主题颜色之外，还节省了浏览器下载和解释默认颜色的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T20:40:12.383

记住：元素可以有多个样式类。由于布局保持静态并且将与着色分开，因此您希望在完全不同的文件中分别定义布局和颜色的类。

所以你想要为主题做的是在一个单独的 css 文件中定义一些颜色，如下所示：

```
.DefaultBackgroundColor { background-color: white; }

.PrimaryColor { background-color: #123456; }
.PrimaryAsForeground  { color: #123456; }

.AccentColor { background-color: #654321; }
.AccentAsForeground { color: #654321; }

.ComplementColor { background-color: #333333; }
.ComplementAsForeground { color: #333333; }

.DefaultTextColor { color:black; }
.HighlightTextColor { color:black; font-style:bold; }
.ComplementTextColor { color:white; } 
```

您可以添加更多颜色，但您明白了。然后，在您的 HTML 中，除了布局类之外，您还可以将这些类添加到元素中。例如，使用这些类，您可以为 StackOverflow 设置导航按钮的样式，如下所示：

```
<div class="nav ComplementTextColor">
    <ul class="primarynav">
         <li class="PrimaryColor"><a href="/questions">Questions</a></li> <!-- selected -->
         <li class="ComplementColor"><a href="/tags">Tags</a></li>
         <li class="ComplementColor"><a href="/users">Users</a></li> 
         <li class="ComplementColor"><a href="/badges">Badges</a></li>
         <li class="ComplementColor"><a href="/unanswered">Unanswered</a></li>
    </ul>
</div> 
```

显然，这些颜色是合成的，不会一起使用，但这就是这个设置的美妙之处。这使得使用和调整颜色变得非常容易，因为您不必在所有地方都定义相同的颜色。您设置一次，然后只需要进行少量更改即可完全重新着色站点。

缺点是你是有限的。例如，使用我发布的 html，您不能仅仅通过更改 css 文件来使此处的按钮与其他所有按钮颜色不同，因为我们没有为它设置“挂钩”。但是你可以通过一个简单的编辑来改变他们在这里使用的那种难看的橙色。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T22:45:06.563

我将不得不接受 TravisO 的想法。

在这种情况下，与创建单独的 css 文件相比，保留一个文件实际上会产生更大的维护开销。您需要的是一个适用于所有主题（我通常是根/样式文件夹）的某个位置的基本 css 文件，然后是每个主题中的一个文件，用于着色信息（或任何其他特定于主题的 css）。

# asp.net - 输出缓存 - 基于 PageLoad() 中设置的值的 GetVaryByCustomString

> ID：357475
> 
> 赞同：0
> 
> 时间：2008-12-10T20:23:29.220
> 
> 标签：asp.net, caching, outputcache

我正在使用 ASP.net 输出缓存并希望实现它的 GetVaryByCustomString() 版本。但是，当缓存基于页面的 PageLoad() 中设置的值时，我遇到了问题。

当 Default.aspx 加载时，我想显示的 USER CONTROL 版本基于需要通过数据库查询的 URL。

www.website.com/apples 将加载并在页面后面的代码中，我对数据库进行查询，检索我想要的值。

是否可以使用输出缓存，或者我需要实现我自己的变体。

是否可以在页面生命周期的早期查询数据库，以便在执行 GetVaryByCustomString 时已经设置变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T21:36:22.880

我将分配变量的代码移到了似乎在 GetVaryByCustomString() 之前执行的 Page_PreInit 方法中。

# c++ - 将二维数组写入输出文件 - C++

> ID：357481
> 
> 赞同：0
> 
> 时间：2008-12-10T20:25:40.697
> 
> 标签：c++, file-io, multidimensional-array

我正在尝试将二维数组写入输出文件，除了创建 .getline 函数以将数组从文件中拉回之外，一切正常。我的问题是放置字符串长度。我当前的代码是；

inputFile.getline(myArray, [10][10], '\n');

但它似乎不喜欢将字符串长度放在方括号中，我该怎么办？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T20:46:20.170

要编译它，`myArray`必须是一个数组`char`，或者一个`char*`. 特别是，它是一个*一维*数组。要读取多个维度，您需要分别读取每一行。第二个参数 to[`std::istream::getline`](http://en.cppreference.com/w/cpp/io/basic_istream/getline)是数组中读取和存储的最大`char`s 数减一。

要开始从文件中读取内容，您应该首先了解文件的写入方式。*我希望你*知道文件是如何创建的，但你没有在你的问题中描述这一点。了解文件的编写方式对于了解如何读取文件至关重要。请显示一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T23:09:27.370

恕我直言*Rob Kennedy*，他歪曲了 C/C++ 如何处理多维数组。

考虑 int foo[10][10] 和 int foo[100]。在这两种情况下， foo 都是指向包含 sizeof(int)*100 字节的内存块的指针。

int *pointer 和 int foo[10][10] 之间存在细微**差别**。特别是关于 sizeof() 和某些特定于编译器的错误检查。但是，如果需要，我们可以互换处理它们。

* * *

也就是说，*leachrode*不能将*getline()*的参数 2 传递为*"[10][10]"*。他可以通过*"10*10*sizeof(foo)"*，其中 foo 是*myArray*的类型。如果它实际上被声明为数组，他也可以传递*sizeof(myArray) 。*

变量*myArray*不一定需要是*char*类型。*但是，如果该getline()*调用将起作用，则 myArray 数据块中的任何字节都不能具有值 '\n' 。

就个人而言，我会选择二进制存储。例如：（假设*inputFile*是一个 iostream 对象。）

```
 inputFile.write( (const char *)myArray, sizeof(myArray) );
 inputFile.read( (char *)myArray, sizeof(myArray) ); 
```

***HOWEVER***，这确实假设您正在二进制兼容的系统上进行读写。我们正在假设您的编译器如何将该数组存储在内存中。不同的编译器可能会做不同的事情。填充和对齐问题可能会造成跨平台的噩梦。

从可移植性和未来维护的角度来看，**单独读/写每个数组元素会更好！** 就代码而言，它并不复杂。速度方面，iostreams 是缓冲的，无论如何你都受到磁盘 io 的约束......

参考：[http ://www.cplusplus.com/reference/iostream/](http://www.cplusplus.com/reference/iostream/)

***Afterthought:*** - **IF** myArray in not an elementary type (int[], double[]), but instead represents an array of objects (with virtual members) or pointers, you'll need a means of serializing. Pointers won't point to valid memory when they are read back in.

# iphone - iPhone 客户端证书

> ID：357491
> 
> 赞同：4
> 
> 时间：2008-12-10T20:28:33.750
> 
> 标签：iphone, security, ssl, certificate, client-certificates

我想验证我正在编写的应用程序是否在 iPhone 上运行。完美的是：Apple 将 SSL 客户端证书放入每个 iphone 中，该证书可以由接收服务器进行身份验证。我是这种情况？

我还没有开始研究这个，我会更新我发现的任何东西。

更新： [这](http://developer.apple.com/DOCUMENTATION/Security/Conceptual/SecureCodingGuide/Articles/SecuritySvcs.html)是一些关于证书和钥匙串的 Apple 文档。所以：

> 在 iPhone OS 中，Keychain Services 在授予应用程序访问钥匙串之前检查应用程序的签名，并让应用程序只能访问其自己的钥匙串项目（可能例外，应用程序已获得持久引用的项目）。在 iPhone OS 中，从不要求用户进行身份验证，Apple 也不提供 Keychain Access 实用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T20:42:26.123

我认为大多数执行此检测的站点都是通过查看 HTTP_USER_AGENT 变量来实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T20:43:03.907

受[信任的平台](http://en.wikipedia.org/wiki/Trusted_computing)模块可以按照您的要求做一些事情。这称为[远程证明](http://en.wikipedia.org/wiki/Trusted_computing#Remote_attestation)。

然而，对可信计算的接受程度有限——精明的消费者将其视为供应商继续控制消费者拥有的设备和数据的一种方式。Apple 勉强承认 DRM 是愚蠢的，以及 TPM 的额外成本，这[表明 iPhone 不支持此功能](http://blogoftrust.com/tpm-in-the-3g-apple-iphone/112)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T01:39:30.470

与格雷格上面提到的有关。您绝对可以将用户代理添加到我们在应用程序中所做的标题中。整个 http 连接代码还有更多内容，但这是一种可以将用户代理添加到标头的方法：

```
NSMutableURLRequest *request;
NSMutableDictionary *headers;
headers = [[[NSMutableDictionary allocWithZone:[self zone]] init] autorelease];
[headers setValue:@"YourApp/1.0 (iPhone)" forKey:@"User-Agent"];
[request setAllHTTPHeaderFields:headers]; 
```

同样，请注意，此代码仅关注标头位，因此您必须实现完整的 http 解决方案。

# asp.net-mvc - asp:calendar 在 MVC 中无法正常工作

> ID：357497
> 
> 赞同：2
> 
> 时间：2008-12-10T20:31:49.140
> 
> 标签：asp.net-mvc

我的视图页面上有一个 asp:calendar，当我将鼠标悬停在它上面时，它会显示一个 javascript 回发状态栏。但是我在同一页面上也有一个 asp:button，当我将鼠标悬停在它上面时。来自控制器的操作在状态栏中..因为我有一个 onClick 属性用于触发服务器端操作的按钮。在 asp:calendar 我也有一个触发事件 OnSelectionChanged 在服务器端有一个方法......但正如我所说，当我将鼠标悬停在日历上以在状态栏中选择一个日期时，它显示：javascript:_doPostBack($ ct100ContentPlaceHolder?mycalendar',''3270) 并且当我单击日期时收到一条错误消息，指出对象不支持此方法。mycalendar 也是 asp:calendar 的 id 名称

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T20:35:21.333

ASP.NET 服务器端控件并不真正适合与 MVC 一起使用。服务器端控件将视图和控制器组合在一个包中，而 MVC 将它们分开。

Calendar 控件不起作用的另一个原因是它依赖于回发模型，该模型在 MVC 中不起作用。

我建议尝试使用 javascript 日历控件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-10T20:38:41.497

山姆是对的（赞成）。看看在你的网络应用程序中使用 jQuery。在 jQuery 的 UI（它是一个额外的 .js 文件）中，有一个很棒的日历选择器（如果这是您想要做的——选择一个日期）。只需确保获取日期选择器的 .css 文件即可。

jQuery： http: [//jquery.com/](http://jquery.com/)
jQuery UI： [http](http://ui.jquery.com/)
://ui.jquery.com/ jQuery 日期选择器演示： [http://ui.jquery.com/repository/tags/latest/demos/functional/#ui。日期选择器](http://ui.jquery.com/repository/tags/latest/demos/functional/#ui.datepicker)

我认为您需要获取开发包以确保您获得日期选择器的 .css 文件

[http://ui.jquery.com/download](http://ui.jquery.com/download)

如果找不到 css 文件（我找不到），请在 google 上搜索 ui.datepicker.css

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-16T02:50:07.073

您可以尝试[BaseCalendar](http://basecalendar.codeplex.com/)，它不依赖或使用回发。

# sql - 使用 ASP 和 INSERT INTO -

> ID：357499
> 
> 赞同：0
> 
> 时间：2008-12-10T20:32:10.760
> 
> 标签：sql, asp-classic, vbscript, ado

我正在尝试创建一个将数据输入数据库的简单页面，我的代码如下。

```
<%@ LANGUAGE="VBSCRIPT" %>
<% Option Explicit %>
<!--#include FILE=dbcano.inc-->
<%

dim username,password,f_name,l_name,objConn,objs,query

username   = Request.Form("user")
password   = Request.Form("pass")
f_name     = Request.Form("fname")
l_name     = Request.Form("lname")

if((f_name <> null) or (f_name <> "")) then
    response.redirect("patti_account.asp")
else
    Set objConn = ConnectDB()
    query       = "INSERT INTO user (username,password,f_name,l_name) VALUES ('"& username &"','"& password &"','"& f_name &"','"& l_name &"')"
    Set objs    = objConn.Execute(query)

    Response.Redirect ("thankyou.asp")

end if

%> 
```

运行页面时出现此错误：

> 用于 SQL Server 错误“80040e14”的 Microsoft OLE DB 提供程序
> 
> 关键字“用户”附近的语法不正确。
> 
> create_account.asp，第 18 行

我已经检查了所有内容，我的字段名存在并且我的表名也是正确的。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T20:36:13.750

**用户**是 SQL Server 中的保留字。将其放入方括号中，例如**[user]**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T21:08:43.607

这很容易受到 SQL 注入的攻击。想象一下如果有人把这个作为姓氏会发生什么：

```
');DROP Table [user];-- 
```

修好它，否则我会亲自追踪你并用湿面条打败你，直到你这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T20:38:14.463

尝试将其更改为：

```
query       = "INSERT INTO [user] (username,password,f_name,l_name) VALUES ('"& username &"','"& password &"','"& f_name &"','"& l_name &"')" 
```

（转义表名，因为它是保留字）

此外，不要忘记验证键盘输入，因为此代码会受到 SQL 注入攻击。

# reporting-services - 报告服务匿名访问报告

> ID：357500
> 
> 赞同：5
> 
> 时间：2008-12-10T20:32:11.963
> 
> 标签：reporting-services, anonymous-access

我无法为需要访问报告的每个人创建 NT 帐户。是否有人知道或拥有该信息的链接以允许匿名访问报告服务报告？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T21:03:50.340

谢谢，我之前尝试过但失败了，再次尝试并且工作正常，一定是第一次错过了一些东西。

步骤非常简单：

1.  SSRS 2005 的标准安装（集成身份验证）
2.  在 IIS 中，复制 ReportingServices 虚拟目录并将其命名为 Public
3.  在公共属性下设置目录安全 - 身份验证和访问控制 - 以使用 IUSR_ 帐户启用匿名访问。取消选中所有其他访问类型。
4.  使用报表管理器，设置一个名为 Public 的文件夹，并将 IUSR_ 帐户添加到具有 viewonly 角色的 Public 目录角色管理器中。（假设您已经将 viewonly 角色设置为仅启用了“查看报告”任务的角色。）
5.  添加任何其他类型的管理/开发人员帐户

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-05T19:59:50.970

匿名访问不再是 MS SQL Reporting Services 2008 的简单配置。我从这条道路开始，最终将 Reporting Services 集成到我们现有的安全系统中。您也可以按照[这些说明](http://agilemusings.blogspot.com/2009/11/reporting-services-2008-custom-security.html)来实现匿名访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-08T00:37:39.817

如果您的服务器位于 Windows 域上，您可以授予对组的访问权限，例如。`Domain Users`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T08:32:53.493

如果它可能有帮助 - 特别是`SSRS 2008`

这取决于您选择的身份验证类型，使用基本身份验证您可以实现此目的。但是，如果是在公司环境中，为什么不使用`RSWindowsKerberos`, `RSWindowsNegotiate`, `RSWindowsNTLM`- ，因为用户是域的成员，他们使用集成身份验证。

您将获得更好的安全性和灵活性以及访问权限的整合。也请不要忘记使用内置的网络服务作为您的记者的服务帐户，如果您使用域帐户，您肯定需要在您的域控制器上注册 SPN。

# seo - 动态内容和搜索引擎优化

> ID：357505
> 
> 赞同：0
> 
> 时间：2008-12-10T20:34:16.420
> 
> 标签：seo

我有一个网络论坛，我用 Python 为 App Engine 平台编写了代码。我注意到它没有被谷歌很好地索引，我正在努力解决这个问题。
我使用 Google Webmaster 提交了一个包含近 400 个 URL 的站点地图，但显然只有 8 个被编入索引！
我什至收到警告说：

> 您的站点地图中的所有 URL 都被标记为具有动态内容（值为“始终”）。由于动态内容很难被搜索引擎抓取和索引，这可能会影响您网站在搜索结果中的性能。检查您的站点地图以确保您的站点信息正确无误。

我正在考虑的一件事是我的 URL 的形成方式。几乎所有 URL 都使用参数，我为每个帖子、线程、论坛、用户等分配一个 ID。

例如，我的一个论坛是：

[http://silicon.appspot.com/readforum?id=2075](http://silicon.appspot.com/readforum?id=2075)

论坛的 ID 是 2075。我听说这是不好的做法，所以我正在考虑更改此设置，但我不确定它是否会有所作为。有人能给我一些关于如何让谷歌索引我的*整个*网站的提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T21:11:21.947

真正要注意的是：

```
 http://www.example.com/forum.py?thread=1000
 http://www.example.com/forum.py?thread=1000&mode=printer 
```

网络爬虫会看到两个具有相同内容的不同 URL，并假设您正在尝试做一些可疑的事情。您需要确保您的“打印此页面”链接中包含 rel="nofollow"。目标是在您的网站上每个唯一数据集只有一个链接。

论坛当然会一直存在重复内容的问题。但是对于文章/博客，您应该能够接近 1:1 的页面与 URL 比率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T10:04:44.783

谷歌网站管理员工具中的统计数据永远不会是最新的。以下 Google 搜索显示几乎所有站点地图 URL 都已编入索引，因此您没有问题：

```
site:silicon.appspot.com 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-10T21:04:40.027

URL内容是图片的一部分，但只是一小部分。

让 URL 说 readforum2106 而不是 /readforum?id=2106 不会做任何事情，除非有人在搜索“readforum”这个词。要使 URL 真正有用，您需要在文本中包含一些好的搜索词，这对论坛没有意义。

我不认为 URL 映射真的会对你有多大帮助。也许您应该寻找动态生成站点地图的方法？

# sql-server - 你可以在动态sql中调用ROW_NUMBER()并在动态sql中使用公用表表达式吗？

> ID：357506
> 
> 赞同：0
> 
> 时间：2008-12-10T20:34:28.947
> 
> 标签：sql-server, tsql

我想限制调用ROW_NUMBER()返回的记录数，但是我很好奇你是否可以在动态sql中调用它？

另外，您可以在动态 sql 中使用 CTE 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T20:36:40.863

您的意思是，与从存储过程或其他代码对象内部调用相反？如果这是问题，答案是**肯定**的。请注意，row_number 仅在 SQL 2005 及更高版本上受支持。

# sharepoint - Sharepoint 剥离 HTTP 标头

> ID：357512
> 
> 赞同：2
> 
> 时间：2008-12-10T20:35:45.327
> 
> 标签：sharepoint, http, header, request.servervariables

我有一个自定义共享点应用程序，其安全模型取决于 HTTP 标头。当移动设备发出请求时，每个请求都会添加一个名为 HTTP_RIM_DEVICE_EMAIL 的 http 标头。我通过以下方法获取 http 标头：

```
private static string GetValueFromHeader(string headerName)
        {
            HttpRequest Request = HttpContext.Current.Request;
            string returnValue = string.Empty;
            try
            {
                string[] val = Request.ServerVariables.GetValues(headerName);
                if (val.Length > 0)
                    returnValue = val[0];
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.ToString());
            }
            return returnValue;
        } 
```

我传入“HTTP RIM DEVICE EMAIL”，它返回 null。我在同一台服务器上有一个常规的 asp.net 2.0 站点，当我通过黑莓向它发出请求时，我看到了标题，但在请求共享点站点时却没有。

有没有办法防止共享点剥离我需要的 http 标头？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T17:39:00.423

实际上，sharepoint 不会剥离 HTTP 标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T16:04:03.720

http 标头中的值是特定于设备的，它是动态的。

# java - Spring Integration 1.0 RC2：流文件内容？

> ID：357520
> 
> 赞同：1
> 
> 时间：2008-12-10T20:36:50.457
> 
> 标签：java, file-io, streaming, spring-integration

我一直在努力寻找这方面的信息，但由于 Spring Integration 框架的不成熟，我运气不佳。

这是我想要的工作流程：

1.  新文件放置在“传入”目录中

2.  使用 file:inbound-channel-adapter 获取文件

3.  文件内容一次 N 行流式传输到“Stage 1”通道，该通道将行解析为中间（共享）表示。

4.  这条解析后的线路被路由到多个“Stage 2”通道。

5.  每个“第 2 阶段”通道对 N 条可用线路进行自己的处理，以将它们转换为最终表示。该通道必须有一个队列，以确保在一个通道的处理速度明显慢于其他通道的情况下，不会使第 2 阶段通道不堪重负。

6.  N 行的最终表示被写入文件。将有与步骤 4 中的路由目标一样多的输出文件。

**上面的'N'代表一次读取的任何合理数量的行，从[1，我可以合理地放入内存中]，但保证始终小于完整文件中的行数。*

如何在 Spring Integration 中完成**流式传输（步骤 3、4、5） ？**不流式传输文件相当容易，但我的文件足够大，我无法将整个文件读入内存。

作为旁注，我有一个没有 Spring Integration 的工作流的工作实现，但是由于我们在项目的其他地方使用 Spring Integration，我想在这里尝试一下它的执行方式以及结果如何代码比较长度和清晰度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-08T10:43:19.847

这是一个非常有趣的用例，很抱歉我错过了这么长时间。绝对值得为此创建一个问题。目前，我们在 Spring Integration 中支持获取文件并发送*对它们*的引用。对于将文件转换为 byte[] 或 String 也有一些基本的支持。

答案是现在您将在自定义 Java 代码中执行第 2 步，将块发送到第 2 阶段通道。我建议不要将流的引用作为消息有效负载发送。

# apache-flex - Flex：弄清楚运行的 swf 是什么时候编译的？

> ID：357522
> 
> 赞同：6
> 
> 时间：2008-12-10T20:37:08.613
> 
> 标签：apache-flex, actionscript-3

flex 应用程序中是否有（在运行时）确定运行 swf 的编译时间？

我想将此与服务器上最新的 swf 文件版本进行比较，并检测服务器上是否有更新版本，如果有，则强制用户重新加载浏览器以获取新版本。

我需要它来处理缓存中的 swfs。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T08:42:53.517

为了确保用户获得最新版本的 Flash 文件（因为 Flash 内容的缓存有些奇怪），我通常会使用服务器端脚本来附加文件更改的时间。

我也一直在尝试在 swf 中设置变量，尽管这需要一些命令行技巧，而且如果您不使用构建脚本，这将不实用。

基本上，您将其附加到您的 mxmlc 调用中：

```
-define+=BUILD::DATE,"2008-12-10" 
```

然后变量 BUILD::DATE 将在您的构建期间可用，因此您可以使用它来设置您稍后阅读的静态变量：

```
private static var COMPILEDATE:String = DATE; 
```

（我从内存中写了所有这些，所以它可能不是 100% 正确的语法）

# linux - QVariant 和 qRegisterMetaType 问题

> ID：357537
> 
> 赞同：2
> 
> 时间：2008-12-10T20:41:35.110
> 
> 标签：linux, qt, qvariant, kdelibs

我有一个类 Pkg，我需要以 QVariant 的形式使用它。

在我的 Pkg.h 结束时，我有：

```
Q_DECLARE_METATYPE(Pkg) 
```

这不会产生编译错误，但在我的 main.cpp 中我必须这样做：

```
qRegisterMetaType<Pkg>("Pkg"); 
```

这也不会产生错误，但是当我尝试创建 QVariant(Pkg) 时，会出现很多错误，例如：

```
In member function 'void MainWindow::FillPackagesList()':  
mainWin.cpp:233: error: 'qRegisterMetaType' isnot a member of 'QMetaType' mainWin.cpp:234: error: no matching function for call to QVariant::QVariant(Pkg&)'                                             

/usr/lib/qt/include/QtCore/qvariant.h:208: note: QVariant::QVariant(Qt::GlobalColor)           
/usr/lib/qt/include/QtCore/qvariant.h:206: note: QVariant::QVariant(const QRegExp&)            
/usr/lib/qt/include/QtCore/qvariant.h:204: note: QVariant::QVariant(const QLocale&)            
/usr/lib/qt/include/QtCore/qvariant.h:203: note: QVariant::QVariant(const QUrl&)               
/usr/lib/qt/include/QtCore/qvariant.h:201: note: QVariant::QVariant(const QRectF&)             
/usr/lib/qt/include/QtCore/qvariant.h:200: note: QVariant::QVariant(const QRect&) 
```

和错误再次错误......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T02:08:47.697

QVariant 构造函数不会只采用任何旧类型。您需要使用[QVariant::setValue()](http://doc.trolltech.com/4.4/qvariant.html#setValue)或[qVariantFromValue](http://doc.trolltech.com/4.4/qvariant.html#qVariantFromValue)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T19:07:13.257

啊啊解决了，非常感谢，我用过：

```
 item->data(1,Qt::UserRole).value<Pkg>(); 
```

item 是在此事件中选择的 QTreeWidgetItem：

```
connect(packList,SIGNAL(itemClicked(QTreeWidgetItem*, int)), SLOT(setActualPackage(QTreeWidgetItem*))); 
```

# email - 测试电子邮件功能的好方法

> ID：357543
> 
> 赞同：8
> 
> 时间：2008-12-10T20:42:55.687
> 
> 标签：email, testing

使用通过电子邮件通知的应用程序。我想在不向生产服务器和客户端发送电子邮件的情况下运行测试。几年前，我记得有人用糟糕的电子邮件循环关闭了我们的交换服务器，并且不想重复......

对开发设置有什么建议吗？目前认为一个简单的 SMTP 服务器就可以完成这项工作，但我不熟悉那个空间。我需要能够查看发送到服务器的所有电子邮件，但它们永远不应该被传递。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-11T00:57:08.497

[Papercut](https://github.com/changemakerstudios/papercut)非常适合您的需求。在过去的几个月里，它一直是公开的。我已经使用它一个月了。测试电子邮件功能再简单不过了。

1.  下载剪纸。
2.  运行 Papercut，运行时它位于您的托盘中。
3.  将应用程序的 smtp 主机配置到运行 Papercut 的机器上。
4.  观看 Papercut 接收电子邮件并查看内容。
5.  当你完成时。关闭剪纸。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-10T20:53:02.733

设置一个传递到文件的别名非常简单，而不是通过任何主要 Unix/Linux 邮件服务器（如 Postfix 或 Sendmail）中的任何传递机制。在测试期间，您可以跟踪该文件以查看邮件是否按预期发送。测试结束后，您可以将其重新定向到它真正应该去的任何地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-27T08:53:28.550

您可以使用[邮件陷阱](https://mailtrap.io/)。您可以在登台服务器或开发服务器上进行设置。它易于使用，您也可以使用生产电子邮件地址。所有电子邮件都将被困在 mailtrap 的电子邮件收件箱中。设置起来更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T20:52:48.443

根据您的电子邮件机制，另一种选择是制作一个 testmail.(py,php,sh) 脚本，该脚本记录所有提供的参数并将它们转储到带有事件时间戳的标签表中。它并不优雅，但可以用于调试。技巧完全取决于您发送电子邮件的方式。

同样，如果您使用 smtp 而不是 sendmail，则编写一个 ghetto 应用程序，该应用程序侦听某个高范围的端口号，并以正确的值愚蠢地回复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T00:43:56.103

您的问题没有描述环境，但如果您使用的是 OO 语言（例如 Java），则可以使用依赖注入。编写一个`MessageSender`具有两个实现的接口；一个 ( `EmailMessageSender`) 实际发送电子邮件，而另一个 ( `FileMessageSender`) 捕获字符串中的消息。

单独编写和测试`EmailMessageSender`；确认无误后上架。

针对系统的其他部分编写`MessageSender`并使用`FileMessageSender`. （如果`FileMessageSender`还允许检索“已发送消息”的内容，那么您可以在单元测试中使用它。）

验证系统的其余部分后，使用（再次通过注入）正确配置的`EmailMessageSender`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T20:46:18.643

为什么不简单地将电子邮件列表输出到文本文件并断开对邮件服务器的任何调用？

# reporting-services - Reporting Services 垂直布局不可排序？

> ID：357552
> 
> 赞同：0
> 
> 时间：2008-12-10T20:46:38.750
> 
> 标签：reporting-services

我最近将报告从通常的表格视图（水平）切换到垂直，因为我有很多列。现在的问题是，当我单击排序时，报告本身没有任何反应。有谁知道是否可以使用非水平布局进行排序？（使用默认排序表达式）

**目前在交互式排序对话框中，我有一个复选框，用于向此文本框添加一个 int 排序操作。接下来，我选择了第二个单选按钮“选择数据区域或分组”，并为此报告选择了我的数据集

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T22:26:17.890

当您说您切换到“垂直”布局时，您的意思是您现在使用的是矩阵，还是通过在报告正文中添加列来使用报纸样式的多列布局？

# linux - 使用 Unix 排序对多个键进行排序

> ID：357560
> 
> 赞同：145
> 
> 时间：2008-12-10T20:48:39.027
> 
> 标签：linux, unix, sorting

我有可能需要按 1-n 个键排序的大文件。其中一些键可能是数字，而其中一些可能不是。这是一个固定宽度的柱状文件，因此没有分隔符。

有没有用 Unix 排序的好方法？只需一键，就像使用“-n”一样简单。我已经阅读了手册页并简单地搜索了谷歌，但没有找到一个很好的例子。我将如何实现这一目标？

注意：由于文件大小的可能性，我已经排除了 Perl。这将是最后的手段。

* * *

## 回答 #1

> 赞同：341
> 
> 时间：2011-07-15T15:26:39.917

不过要小心：

如果您想主要按字段 3 对文件进行排序，然后按字段 2 对文件进行排序，则需要：

```
sort -k 3,3 -k 2,2 < inputfile 
```

**不是这个：** `sort -k 3 -k 2 < inputfile`它按从字段 3 开头到行尾的字符串对文件进行排序（这可能是唯一的）。

```
-k, --key=POS1[,POS2]     start a key at POS1 (origin 1), end it at POS2
                          (default end of line) 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2008-12-10T21:03:00.840

-k 选项是您想要的。

```
-k 1.4,1.5n -k 1.14,1.15n 
```

将在第一个字段中使用字符位置 4-5（对于固定宽度，它都是一个字段）并按数字排序作为第一个键。

第二个键也是第一个字段中的字符 14-15。

（编辑）

示例（我所拥有的只是 DOS/cygwin 方便）：

```
dir | \cygwin\bin\sort.exe -k 1.4,1.5n -k 1.40,1.60r 
```

对于数据：

```
12/10/2008  01:10 PM         1,564,990 outfile.txt 
```

按月份编号 (pos 4-5) 对目录列表进行数字排序，然后按文件名 (pos 40-60) 反向排序。由于没有选项卡，因此所有字段 1 都需要排序。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2008-12-10T20:54:59.717

使用`-k`选项（或`--key=POS1[,POS2]`）。它可以出现多次，每个键可以有全局选项（例如`n`数字排序）

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2014-03-07T21:50:00.190

这是一个按数字和字典顺序对 csv 文件中的各个列进行排序的方法，第 5 列和之后的列作为字典顺序

```
~/test>sort -t, -k1,1n -k2,2n -k3,3d -k4,4n -k5d  sort.csv
1,10,b,22,Ga
2,2,b,20,F
2,2,b,22,Ga
2,2,c,19,Ga
2,2,c,19,Gb,hi
2,2,c,19,Gb,hj
2,3,a,9,C

~/test>cat sort.csv
2,3,a,9,C
2,2,b,20,F
2,2,c,19,Gb,hj
2,2,c,19,Gb,hi
2,2,c,19,Ga
2,2,b,22,Ga
1,10,b,22,Ga 
```

请注意 -k1,1n 表示从第 1 列开始到第 1 列结束的数字。如果我在下面完成，它将连接第 1 列和第 2 列，使 1,10 排序为 110

```
~/test>sort -t, -k1,2n -k3,3 -k4,4n -k5d  sort.csv
2,2,b,20,F
2,2,b,22,Ga
2,2,c,19,Ga
2,2,c,19,Gb,hi
2,2,c,19,Gb,hj
2,3,a,9,C
1,10,b,22,Ga 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-10T21:11:40.590

我相信你的情况是这样的

```
sort -t@ -k1.1,1.4 -k1.5,1.7 ... <inputfile 
```

会工作得更好。@ 是字段分隔符，请确保它是一个无处出现的字符。那么您的输入被视为由一列组成。

编辑：显然 clintp 已经给出了类似的答案，抱歉。正如他所指出的，可以将标志 'n' 和 'r' 添加到每个 -k.... 选项中。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-08-30T08:52:27.043

请注意，可能还需要使用`-s`开关来稳定排序，以便相同排名的行在输出中也保持其原始相对顺序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-30T16:08:04.767

我只想添加一些提示，当您使用 sort 时，请注意影响键比较顺序的语言环境。我通常明确地使用 LC_ALL=C 来制作我想要的语言环境。

# java - 基于 Java 的 Swing 浏览器应该支持 JavaScript

> ID：357562
> 
> 赞同：3
> 
> 时间：2008-12-10T20:49:09.073
> 
> 标签：java, javascript, swing, swt

在我的公司，我正在实现一个基于 java 的 html 浏览器。我发现很多工具只能在 Swing 中生成看起来像 Mozilla 的完整浏览器。但是我找不到支持 JavaScript 的浏览器。我将实现的浏览器应该在 HTML 端执行 JavaScript。

您知道支持此功能的工具吗？或者你知道一个解析器，它可以将 javascript 与我可以在 html 浏览器中使用的东西配对？

我知道 eclipse 插件可以处理 javascript，但我不能在我的项目中使用 AWT。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T21:00:50.860

您不想自己构建它。幸运的是，有许多开源[javascript 引擎](http://en.wikipedia.org/wiki/List_of_ECMAScript_engines)可以让您适应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T21:31:12.063

我会看看[Lobo](https://github.com/lobobrowser/LoboBrowser)。听起来只是想要你想要的。它有一个 HTML 渲染器和解析器，以及对 Javascript 的一些支持。如果它缺少您需要的 Javascript 功能，似乎更容易为 Lobo 做出贡献，而不是重新发明轮子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T21:30:29.723

*在我的公司，我正在实现一个基于 java 的 html 浏览器。*

天哪，为什么？

也就是说，[java.net 上的这个页面](http://today.java.net/pub/a/today/2004/05/24/html-pt1.html)讨论了一些选项；你可以更广泛地搜索它。

# c++ - 用于头文件中的匿名命名空间

> ID：357564
> 
> 赞同：56
> 
> 时间：2008-12-10T20:49:11.070
> 
> 标签：c++, namespaces, initialization, header

今天有人在 SO 上断言，你永远不应该在头文件中使用匿名命名空间。通常这是正确的，但我似乎记得曾经有人告诉我，其中一个标准库在头文件中使用匿名命名空间来执行某种初始化。

我没记错吗？有人可以填写详细信息吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-11T09:46:07.540

标头中的无名命名空间有用的唯一情况是您只想将代码作为头文件分发。例如，Boost 的一个大型独立子集纯粹是标头。

另一个答案中提到的元组令牌`ignore`是一个示例，`_1`等`_2`绑定占位符是其他的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-10T21:38:18.240

我认为将匿名名称空间放入头文件中没有任何意义。我已经找到了标准和 libstdc++ 标头，发现除了`tuple`标头中的一个之外没有匿名名称空间（C++1x 的东西）：

```
 // A class (and instance) which can be used in 'tie' when an element
  // of a tuple is not required
  struct _Swallow_assign
  {
    template<class _Tp>
      _Swallow_assign&
      operator=(const _Tp&)
      { return *this; }
  };

  // TODO: Put this in some kind of shared file.
  namespace
  {
    _Swallow_assign ignore;
  }; // anonymous namespace 
```

这样你就可以做到

```
std::tie(a, std::ignore, b) = some_tuple; 
```

some_tuple 的元素被分配了左侧的变量（参见[此处），](https://stackoverflow.com/questions/275128/parallel-assignment-in-c#275149)[此](https://stackoverflow.com/questions/335930/discarding-the-output-of-a-function-that-needs-an-output-iterator#335972)迭代器使用了类似的技术。第二个元素被忽略。

但正如他们所说，它应该被放入一个 .cpp 文件中，并且一个实例应该由所有用户共享。他们会像这样在标题中声明它：

```
extern _Swallow_assign ignore; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-08T08:21:51.293

我已经看到它用于为不同翻译单元中的变量提供默认值。但在名称冲突的情况下，它可能会导致意外行为。

例子

**一个.hpp**

```
namespace
{
    const char name[] = "default";
}
// This macro will hide the anonymous variable "name"
#define SET_NAME(newname) \
static const char name[] = newname; 
```

**b.cpp**

```
#include "a.hpp"
SET_NAME("file b") // name is "file b" in this translation unit 
```

**cpp**

```
#include "a.hpp"
SET_NAME("file c") // name is "file c" in this translation unit 
```

**d.cpp**

```
#include "a.hpp"
// name is "default" in this translation unit 
```

**e.cpp**

```
#include "a.hpp"
static const char name[] = "unintended";
// accidently hiding anonymous name 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T21:25:28.970

我真的看不出在标题中使用匿名命名空间没有任何积极的好处。具有相同符号声明可能导致的混乱意味着，本质上，包含该标头的编译单元中的不同事物将是一种过早且痛苦地秃顶的保证方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T21:29:04.360

如果它是初始化，它可能是一个`iostream`s 标头（如`istream`,`ios`等）。

# web-services - 如何保护 ws discovery ad hoc 网络免受中间人攻击

> ID：357567
> 
> 赞同：1
> 
> 时间：2008-12-10T20:49:37.247
> 
> 标签：web-services, security, ws-security, ws-discovery, man-in-the-middle

[ws-discovery 规范](http://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf)解释了如何保护您的网络免受

1.  消息更改
2.  拒绝服务
3.  重播
4.  欺骗

但是中间人攻击呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T22:49:53.293

据我了解，“消息更改”缓解，即签署消息，是保护交互免受中间人攻击。如果您可以通过发件人的唯一签名来验证消息的来源及其真实性，那么任何试图假装是合法发件人的人都无法做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T22:27:04.460

[中间人攻击](http://en.wikipedia.org/wiki/Man-in-the-middle_attack)(Wikipedia.org)背后的想法是，您的网络受到威胁，攻击者可以拦截、查看和修改所有成员之间的流量。防止这种情况的最基本步骤是使用 WPA 加密网络（至少）并保持接入点锁定。您的目标应该是首先防止攻击者进入网络。您可以采用的第二层防御是对网络上各方之间的所有流量（可能不是公共/私有的）使用某种形式的加密，因此即使网络受到损害，流量仍然无法被理解。攻击者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-13T00:53:55.003

WS 安全性在您签署消息时确保了这一点。它使用私钥加密，然后接收者使用公钥解密。这样一来，中间的人就无法插手了。

# asp.net - ASP.NET CSS 适配器没有注入疯狂的 js 来“帮助你”

> ID：357571
> 
> 赞同：1
> 
> 时间：2008-12-10T20:50:28.977
> 
> 标签：asp.net, javascript, cssadapter

在这种情况下，游戏的目标是使用带有站点地图提供程序的 Treeview - 并使用 CSS 实现。我猜这样做的方法是使用 CSS 适配器套件。

我已经使用 DLL 实现插入了适配器，在那里我得到了我的基本树视图，但它似乎引入了各种 js，让我可以点击节点等。就我而言，我只想显示具有嵌套 UL 和 LI 的层次结构。我不想要任何 js clicky clicky ！

无论如何，无需使用单独的适配器项目并重写代码来转换/渲染树视图就可以做到这一点？

我也对其他选项持开放态度，目标是树视图/菜单上的简单层次结构，以及来自 XML 文件的面包屑。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T21:36:54.377

我将使用从 asp.net 数据访问教程中获取的本示例中的中继器：

```
<asp:Repeater runat="server" ID="menu" DataSourceID="SiteMapDataSource1">
    <ItemTemplate>
        <li>
            <asp:HyperLink runat="server"
             NavigateUrl='<%# Eval("Url") %>'>
             <%# Eval("Title") %></asp:HyperLink>

            <asp:Repeater runat="server"
             DataSource="<%# CType(Container.DataItem,
             SiteMapNode).ChildNodes %>">
                <HeaderTemplate>
                    <ul>
                </HeaderTemplate>

                <ItemTemplate>
                    <li>
                        <asp:HyperLink runat="server"
                         NavigateUrl='<%# Eval("Url") %>'>
                         <%# Eval("Title") %></asp:HyperLink>
                    </li>
                </ItemTemplate>

                <FooterTemplate>
                    </ul>
                </FooterTemplate>
            </asp:Repeater>
        </li>
    </ItemTemplate>
</asp:Repeater> 
```

这是整篇文章的链接： **[母版页和站点导航](http://www.asp.net/LEARN/data-access/tutorial-03-vb.aspx)**

我忘了说，我不会使用 css 适配器，我听说它们很痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T08:07:32.767

CSS 适配器作为示例代码提供。这就是为什么它们出现在自己的命名空间中，而不是在 System 或 Microsoft 命名空间中。这个想法是您可以自定义它们以满足您自己的需求。

如果您不需要 Js，请编辑代码并将其删除。或者，改用您自己的代码。

# wpf - XAML - 集合初始值设定项中的静态资源

> ID：357578
> 
> 赞同：2
> 
> 时间：2008-12-10T20:53:23.607
> 
> 标签：wpf, xaml, observablecollection, static-resource

我想添加一个已在 XAML 中实例化*一次*的模型对象，并将其添加到两个不同的集合（在 xaml 中）。

以下代码在 Blend 的设计时呈现良好，但在运行时出现以下错误：

*对于“WpfBlog.Models.Tag”类型的“Post1”*
对象，无法转换为“System.Collections.ObjectModel.ObservableCollection`1[WpfBlog.Models.Tag]”类型。标记文件 'WpfBlog;component/Admin.xaml' 行 XX 位置 YY 中的对象 'WpfBlog.Admin' 出错。

*如果我注释掉“Post1”，我将在“Post2”上收到此错误，*
无法将元素添加到属性“标签”，因为如果该属性使用显式集合标签，则它只能有一个子元素。标记文件“WpfBlog;component/Admin.xaml”行 AA 位置 BB 中的对象“System.Windows.StaticResourceExtension”出错。

```
<Window.Resources>
    <model:Tag x:Key="TDD" Name="TDD" ForeColor="Black" BackColor="White" />
    <model:Tag x:Key="Agile" Name="Agile" ForeColor="White" BackColor="Black" />
    <model:Tag x:Key="Waterfail" Name="Waterfail" ForeColor="Red" BackColor="White" />
</Window.Resources>
<Window.DataContext>
    <local:AdminViewModel>
        <local:AdminViewModel.AllTags>
            <StaticResource ResourceKey="TDD"/>
            <StaticResource ResourceKey="Agile"/>
            <StaticResource ResourceKey="Waterfail"/>
        </local:AdminViewModel.AllTags>
        <local:AdminViewModel.Posts>
            <local:PostViewModel Title="Post1">
                <local:PostViewModel.Tags>
                    <StaticResource ResourceKey="TDD" />
                </local:PostViewModel.Tags>
            </local:PostViewModel>
            <local:PostViewModel Title="Post2">
                <local:PostViewModel.Tags>
                    <StaticResource ResourceKey="TDD" />
                    <StaticResource ResourceKey="Agile" />
                    <StaticResource ResourceKey="Waterfail" />
                </local:PostViewModel.Tags>
            </local:PostViewModel>
        </local:AdminViewModel.Posts>
    </local:AdminViewModel>
<Window.DataContext> 
```

以下代码编译并运行良好，但创建了两个名为“TDD”的标签，因此如果我尝试重命名该标签，我必须为所有帖子重命名，而不仅仅是一个 Tag 对象。

```
<Window.Resources>
    <model:Tag x:Key="TDD" Name="TDD" ForeColor="Black" BackColor="White" />
    <model:Tag x:Key="Agile" Name="Agile" ForeColor="White" BackColor="Black" />
    <model:Tag x:Key="Waterfail" Name="Waterfail" ForeColor="Red" BackColor="White" />
</Window.Resources>
<Window.DataContext>
    <local:AdminViewModel>
        <local:AdminViewModel.AllTags>
            <StaticResource ResourceKey="TDD"/>
            <StaticResource ResourceKey="Agile"/>
            <StaticResource ResourceKey="Waterfail"/>
        </local:AdminViewModel.AllTags>
        <local:AdminViewModel.Posts>
            <local:PostViewModel Title="Post1">
                <local:PostViewModel.Tags>
                    <model:Tag Name="TDD" ForeColor="Black" BackColor="White" />
                </local:PostViewModel.Tags>
            </local:PostViewModel>
            <local:PostViewModel Title="Post2">
                <local:PostViewModel.Tags>
                    <model:Tag Name="TDD" ForeColor="Black" BackColor="White" />
                    <model:Tag Name="Agile" ForeColor="White" BackColor="Black" />
                    <model:Tag Name="Waterfail" ForeColor="Red" BackColor="White" />
                </local:PostViewModel.Tags>
            </local:PostViewModel>
        </local:AdminViewModel.Posts>
    </local:AdminViewModel>
<Window.DataContext> 
```

有任何想法吗？如果 Blend 没有正确渲染它，我可以忽略它并解决它，但它确实如此！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T17:20:10.940

我可以通过在 Tags 属性中显式初始化一个新集合来避免这个问题。像这样的东西：

```
<local:PostViewModel Title="Post1">
  <local:PostViewModel.Tags>
     <model:TagCollection>
        <StaticResource ResourceKey="TDD" />
     </model:TagCollection>
  </local:PostViewModel.Tags> 
```

显然，这只有在您允许您的 Tags 属性可写时才有可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T21:25:42.353

我认为这与[这个](https://stackoverflow.com/questions/150150/how-do-i-share-a-menu-definition-between-a-context-menu-and-a-regular-menu-in-w#150706)问题中描述的问题非常相似。

解决方案应该是为您的 <model:Tag> 元素添加一个 x:Shared="False" 属性。这告诉 WPF 不要在每次引用一个实例时共享一个实例，而是创建它们的新实例。

# java - 使用 JavaMail 1.4 时超时不起作用

> ID：357579
> 
> 赞同：1
> 
> 时间：2008-12-10T20:53:53.400
> 
> 标签：java, jakarta-mail

我正在使用 JavaMail 向 SMTP 服务器发送电子邮件请求。我将“mail.smtp.connectiontimeout”和“mail.smtp.timeout”属性分别设置为 5 秒和 30 秒，并将这两个属性都传递给 Session.getDefaultInstance()。但是，当我执行 Transport.send() 时，我设置的超时似乎被忽略了，在 Solaris 机器上超时大约需要 3:45。在 Mac 上超时时间约为 1:30。这是 JavaMail 中的错误还是我需要设置一些其他属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T05:27:58.997

我认为超时设置是特定于 Sun JVM - 所以它可能无法在 mac 上完全相同。

我过去曾遇到过这个问题 - 最终消耗了网络线程。我所做的是添加一个小 JMS，这样 Web 层代码就会发送电子邮件请求 - 并有一个消息监听器（它是它自己的线程）监听并发送电子邮件 - 在偶尔遇到卡住的情况下它没有t 影响应用程序的其余部分（只是电子邮件花费了一小段时间）。并没有真正解决根本问题，但我最终得到了更好的设计。

# cocoa-touch - 为什么 iPhone Interface Builder 不允许我设置顶级 UIView 的 X、Y 坐标？

> ID：357593
> 
> 赞同：4
> 
> 时间：2008-12-10T20:57:27.810
> 
> 标签：cocoa-touch, interface-builder

为什么 iPhone Interface Builder 不允许我设置顶级 UIView 的 X、Y 坐标？（意思是直接父级是 UIViewController 的视图。）View Size 选项卡上的 X 和 Y 框是灰色的。我可以在运行时更改代码中的 X、Y 值，那么为什么不能在 Interface Builder 中更改呢？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T22:03:38.720

因为 a 拥有的视图`UIViewController`填充了其父级中的可用空间。它的父级将是 a 或由 a或`UIWindow`之类的东西控制的视图。它将为您定位视图。如果要控制视图的位置，请将其设置为由.`UINavigationController``UITabBarController``UIViewController`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-20T19:21:11.940

我同意这是 IB 中缺少的功能。对于基本用法，即创建单个顶级视图以放置在标准视图控制器中，当然没有必要设置视图原点。然而，NIB 被设计为能够在任意对象图中保存任意数量的顶级视图。由于这允许您以您认为合适的任何方式使用这些视图，包括以编程方式将它们嵌入到任何其他视图中，因此在 IB 中锁定这些控件是不必要的约束。在一个相关但有趣的注释中，如果您将定位视图移动到顶层，IB 本身会记住其相对位置以用于显示目的。但是，一旦加载了 NIB，此位置将不可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T20:53:55.580

在 Xcode 4.3.2 中，您可以在属性检查器中选择 size->freeform。

# sql - 这个查询有什么问题？无法让 ROW_NUMBER() 工作

> ID：357594
> 
> 赞同：1
> 
> 时间：2008-12-10T20:58:06.233
> 
> 标签：sql, sql-server, tsql, row-number

```
SELECT * FROM (SELECT ROW_NUMBER() OVER (ORDER BY hrl.Frn) as Row,
        hrl.unq, hrl.LcnsId, hc.Business,hc.Name,hc.Phone,
        hrl.Frn,hrl.CallSign, hrl.gsamarkettypeid, 
        gmt.[Market Type Code] + ' - ' + gmt.gsamarkettype,
        hrl.gsalatitude,hrl.gsalongitude,
        rsc.RadioServiceCode + ' - ' + rsc.RadioService, 
                    GrantDt, ExpirationDt, EffectiveDt, 
        CancellationDt
        FROM dbo.sbi_f_HldrRgstrtnLcns hrl
        INNER JOIN dbo.sbi_f_HldrCntcts hc on 
                    hc.CallSign = hrl.CallSign
        INNER JOIN dbo.sbi_l_radioservicecodes rsc on 
                    rsc.radioservicecodeid = hrl.radioservicecodeid
        LEFT OUTER JOIN dbo.sbi_l_GSAMarketTypes gmt on 
                    gmt.GSAMarketTypeId = hrl.GSAMarketTypeId
        WHERE hc.Entity_Type = 'L'  AND hrl.LicenseStatusId IN (1)
        and Row >=1 and Row <= 20) -- The error occurs here,
                    -- it says incorrect syntax near ) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-10T21:06:36.463

将您的行条件移动到外部选择中

```
SELECT * FROM (SELECT ROW_NUMBER() OVER (ORDER BY hrl.Frn) as Row,
     ...
               WHERE hc.Entity_Type = 'L'  AND hrl.LicenseStatusId IN (1)
              ) T
WHERE T.Row >=1 and T.Row <= 20) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T21:11:01.977

您可以使用 CTE 执行此操作：

```
WITH NumberedRows AS
(
    SELECT 
        ROW_NUMBER() OVER (ORDER BY hrn.Frl) AS RowNum,
        ...
    WHERE 
        hc.Entity_Type = 'L'
        AND hrl.LicenseStatusId IN (1)
)
SELECT
    *
FROM
    NumberedRows
WHERE
    RowNum <= 20 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T21:03:10.387

您不能在 where 子句中为列使用别名，因为 where 子句在 Select 子句之前处理。

编辑：

您也可以在 where 子句中添加子查询

```
Where ((SELECT ROW_NUMBER() OVER (ORDER BY hrl.Frn)) < 20, 
```

或根本不使用 Row_Number，

```
Where (Select Count(*) 
From dbo.sbi_f_HldrRgstrtnLcns 
Where Frn < hrl.Frn) < 20 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T15:22:46.817

检查您使用的是哪个版本的 sql server 数据库。row_number 从 sql server 2005 开始添加。它不支持 sql server 2000

# xml - 您可以从 Spring.NET XML 中的对象复制属性或构造函数参数值吗？

> ID：357595
> 
> 赞同：1
> 
> 时间：2008-12-10T20:59:08.680
> 
> 标签：xml, spring.net, business-logic

我相信我在几个月前遇到了这个问题，但现在我很难找到答案。也许有人可以将我指向[文档](http://springframework.net/documentation.html)中的正确部分？

使用[Sprint.NET](http://springframework.net/)，我将远程 XML 文件组合到单个应用程序上下文中，其中引擎对象与业务规则对象是分开的。问题是一些业务规则是值，而不是对象，引擎 xml 中的`<property>`和`<constructor-arg>`节点需要它们：

```
<object name="Engine">
    <constructor-arg index="0" value="business rule" />
</object> 
```

引用另一个对象的属性（使用`expression`属性而不是`value`？）或者一些专门的名称/值列表（例如 Spring 的 to 版本`<appsettings>`，无论是什么）都可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-10T21:46:21.877

找到了！从“IoC 容器”一章中的 Spring Framework（版本 1.2.0 M1）PDF 第 41 页开始：

> 5.3.8。使用其他对象和类的成员设置引用。
> 
> 本节详细介绍了那些涉及使用其他对象和类的成员设置属性和构造函数参数的配置方案。这种情况很常见，尤其是在处理无法（或不会）更改以适应 Spring.NET 的某些约定的遗留类时……考虑具有构造函数参数的类的情况，该参数只能是通过说，一个数据库来计算。MethodInvokingFactoryObject 正好处理这种情况......它将允许您将任意方法调用的结果注入构造函数（作为参数）或作为属性设置器的值。同样，PropertyRetrievingFactoryObject 和 FieldRetrievingFactoryObject 允许您从另一个对象检索值' s 属性或字段值。这些类实现了 IFactoryObject 接口，该接口向 Spring.NET 指示该对象本身就是一个工厂，而工厂产品，而不是工厂本身，将与对象 ID 相关联。工厂对象在???中进一步讨论

这是[最新在线文档](http://www.springframework.net/doc-latest/reference/html/objects.html#objects-advancedproperty-setting)中的 5.3.9.1 。

# c++ - const_cast 安全吗？

> ID：357600
> 
> 赞同：95
> 
> 时间：2008-12-10T21:01:13.417
> 
> 标签：c++, casting, const-cast

我找不到太多关于`const_cast`. 我能找到的唯一信息（在 Stack Overflow 上）是：

> `const_cast<>()`用于添加/删除变量的 const(ness)（或 volatile-ness）。

这让我很紧张。可以使用`const_cast`导致意外行为吗？如果是这样，是什么？

或者，什么时候可以使用`const_cast`？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-12-10T21:04:30.760

`const_cast`仅当您正在转换一个最初不是的变量时才是安全的`const`。例如，如果您有一个接受 a 参数的函数`const char *`，并且您传入一个 modifiable `char *`，那么`const_cast`将该参数返回给 a`char *`并对其进行修改是安全的。但是，如果原始变量实际上是`const`，那么 using`const_cast`将导致未定义的行为。

```
void func(const char *param, size_t sz, bool modify)
{
    if(modify)
        strncpy(const_cast<char *>(param), sz, "new string");
    printf("param: %s\n", param);
}

...

char buffer[16];
const char *unmodifiable = "string constant";
func(buffer, sizeof(buffer), true);  // OK
func(unmodifiable, strlen(unmodifiable), false); // OK
func(unmodifiable, strlen(unmodifiable), true);  // UNDEFINED BEHAVIOR 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-12-10T21:25:59.263

我可以想到 const_cast 安全且有用的两种情况（可能还有其他有效情况）。

一种是当您有一个 const 实例、引用或指针，并且您想将指针或引用传递给不正确的 API，但您确定不会修改该对象。您可以 const_cast 指针并将其传递给 API，相信它不会真正改变任何东西。例如：

```
void log(char* text);   // Won't change text -- just const-incorrect

void my_func(const std::string& message)
{
    log(const_cast<char*>(&message.c_str()));
} 
```

另一种情况是，如果您使用的是未实现“可变”的旧编译器，并且您想创建一个逻辑上为 const 但不是按位 const 的类。您可以在 const 方法中 const_cast 'this' 并修改类的成员。

```
class MyClass
{
    char cached_data[10000]; // should be mutable
    bool cache_dirty;        // should also be mutable

  public:

    char getData(int index) const
    {
        if (cache_dirty)
        {
          MyClass* thisptr = const_cast<MyClass*>(this);
          update_cache(thisptr->cached_data);
        }
        return cached_data[index];
    }
}; 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-12-10T21:10:29.310

我很难相信这是你能找到的关于 const_cast的*唯一信息。*引用[Google 的第二次点击](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v7v91/index.jsp?topic=/com.ibm.vacpp7l.doc/language/ref/clrc05keyword_const_cast.htm)：

> 如果您抛弃已显式声明为 const 的对象的 const 性，并尝试修改它，则结果是未定义的。
> 
> 然而，如果你抛弃了一个没有显式声明为 const 的对象的 const 性，你可以安全地修改它。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-12-10T21:17:48.983

亚当所说的。另一个 const_cast 可能有用的例子：

```
struct sample {
    T& getT() { 
        return const_cast<T&>(static_cast<const sample*>(this)->getT()); 
    }

    const T& getT() const { 
       /* possibly much code here */
       return t; 
    }

    T t;
}; 
```

我们首先将 const 添加到`this`指向的类型，然后调用 的 const 版本`getT`，然后从返回类型中删除 const，这是有效的，因为`t`必须是非常量（否则，非常量版本的`getT`不能有被调用）。如果你有一个大的函数体并且你想避免冗余代码，这将非常有用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-10T22:39:53.047

简短的回答是否定的，它不安全。

长答案是，如果你知道足够使用它，那么它应该是安全的。

当你进行强制转换时，你实际上是在说，“我知道一些编译器不知道的东西。” 在 const_cast 的情况下，您要说的是，“即使此方法接受非 const 引用或指针，我知道它不会更改我传递给它的参数。”

因此，如果您确实知道在使用演员表时声称知道什么，那么使用它就可以了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-10T21:16:37.100

如果你开始修改编译器认为是 const 的东西，你就会破坏线程安全的任何机会。

# asp.net-mvc - ASP.NET MVC 控制器单元测试难以置信

> ID：357604
> 
> 赞同：2
> 
> 时间：2008-12-10T21:03:02.993
> 
> 标签：asp.net-mvc, unit-testing

我一直在阅读有关单元测试控制器逻辑的正确方法的各种教程。采取以下措施：

```
 public ActionResult Login()
    {
        //Return the index view if we're still here
        return View();
    } 
```

街上的消息是连接一个类似这样的测试方法：

```
 [TestMethod]
    public void TestLoginView()
    {
        //Set up an instance of the controller
        var thisController = new UserController();

        //Invoke the index action
        var actionResult = (ViewResult)thisController.Login();

        //Validate the test
        Assert.AreEqual("Login", actionResult.ViewName);
    } 
```

断言按预期工作。然而，这个控制器有一个基类覆盖 OnActionExecuting 函数，以设置各种页面元素 chrome（导航元素、面包屑等）。这一点逻辑永远不会受到影响。

我可以轻松地测试控制器中使用的模型，但是我想在控制器层进行测试。想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T21:13:44.657

测试框架只调用被测的特定方法，它不模仿 ASP.NET MVC 框架并触发所有通常会发生的事件。我会在单独的测试中测试您的 OnActionExecuting 逻辑，以确保它有效。此测试应仅测试关联控制器方法中的功能。如果您基于其他事件触发有特定的期望，则需要在调用控制器方法之前在控制器上下文中模拟它们。

# version-control - 分布式版本控制系统库的开发（bazaar）

> ID：357616
> 
> 赞同：0
> 
> 时间：2008-12-10T21:09:20.030
> 
> 标签：version-control, bazaar

我对 bazaar 比较陌生（主要使用 cvs，然后是 subversion，在我目前的工作中，我们使用的是 SourceUnsafe）。我当前的开发环境结构如下：

```
\dev（共享存储库）
  \树干
    \project1（分支）
    \project2（分支）
  \分支
    \proj1-bugfix123（\trunk\project1 的分支）
    \proj1-featureA（\trunk\project1 的分支）

```

现在，如果我决定 project1 的某些方面更适合作为库（或程序集，因为它是 ac# 项目）而不是项目内的类，**那么在 bazaar 中构建它的最佳方法是什么。**我提出了两种我认为可行的可能性。第一个我认为是“正确”的方式。

```
\dev（共享存储库）
  \树干
    \project1（分支）
    \project2（分支）
    \libXXX
  \分支
    \proj1-bugfix123
      \main（\trunk\project1 的分支）
      \libXXX（\trunk\libXXX 的分支）
    \proj1-featureA
      \main（\trunk\project1 的分支）
      \libXXX（\trunk\libXXX 的分支）

```

这样做的问题是，现在我需要记住在创建分支时更新解决方案文件以包含正确的项目并且不要将其推回，并且还要记住将更改同时推回项目和库时间（例如，如果 project1 中的 featureA 需要更改 libXXX 才能工作）。

```
\dev（共享存储库）
  \树干
    \project1（分支）
    \project2（分支）
      \libXXX
  \分支
    \proj1-bugfix123（\trunk\project1 的分支）
      \libXXX
    \proj1-featureA（\trunk\project1 的分支）
      \libXXX        

```

这种方法的问题在于，如果另一个项目，比如 project3 想要使用 libXXX 并处于源代码控制中，则它需要是 project1 的一个分支，并删除了 project1 文件。会很乱。

我想还有第三种选择让整个主干成为一个分支，就像在颠覆中一样，但这似乎与我认为它们应该在集市上工作的方式背道而驰。

如果这是在 SourceSafe 中完成的，我会像第二个示例那样做，但在两个地方都有 libxxx 文件夹，但要共享，因为这是 sourcesafe 必须这样做的唯一机制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T21:05:53.710

bzr 中还没有简单的解决方案。您需要嵌套树支持，但它尚未实现 ( [http://bazaar-vcs.org/NestedTreeSupport](http://bazaar-vcs.org/NestedTreeSupport) )，但可能很快就会实现。

有一个名为 config-manager ( [https://launchpad.net/config-manager](https://launchpad.net/config-manager) ) 的旧工具。

还有一个名为 scmproj ( [https://launchpad.net/bzr-scmproj](https://launchpad.net/bzr-scmproj) ) 的 bzr 新插件，它现在是 alpha 版并且正在积极开发中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T12:27:43.093

直到 Bazaar 中的嵌套树支持得到修复，或者 Bazaar 开发了类似于 Subversion 'Externals' 的东西（如果我理解正确的话），您将库包含到 Bazaar 分支的树中的灵活性是有限的。

在那之前，将库作为​​一个单独的项目维护在它自己的一个干净的“分支”中。如果您需要项目中包含的库，例如其文件位于项目自己的树中，则将它们复制过来。如果您对该库中的文件进行了任何更改，并希望将这些更改回馈给该库，请将更改带回该库的本地分支并在那里合并/提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T00:18:51.287

您是否不希望任何新库拥有自己的解决方案并作为其中的一部分构建，然后被其他项目引用。这样库就只有一个版本正在构建（而不是每个解决方案一个）

# winapi - 查看故障转储中的寄存器

> ID：357627
> 
> 赞同：1
> 
> 时间：2008-12-10T21:12:32.600
> 
> 标签：winapi, visual-studio-2005, crash-dumps, minidump

有没有办法在故障转储中查看每个堆栈帧中的寄存器内容？寄存器窗口似乎包含发生异常时的寄存器，但能够在每个堆栈帧中查看它们的内容会很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T16:39:23.873

根据调用约定，您可以获得一些保存在堆栈中的寄存器。例如，在[cdecl 调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions#cdecl)中，除了 EAX、ECX 和 EDX 之外的所有寄存器都需要被调用者或被调用者保存。这三个寄存器是可破坏的，因此您通常无法从调用堆栈中更高的位置获取它们的值。如果一个函数不使用必须保存的寄存器，那么它不会保存它，但由于它不使用它，所以该寄存器在下一个更高的堆栈帧中具有相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T04:58:55.403

在做了一些研究和思考之后，我意识到这可能是不可能的。崩溃小型转储保存进程内存的某些区域（取决于传递给 MiniDumpWriteDump() 函数的标志）和足够的状态信息，以在调试器中重新创建崩溃发生的环境。它没有每条指令甚至每个堆栈帧的处理器状态，它只知道异常发生时的处理器状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T16:08:20.223

在优化的构建中，确实可能会丢弃堆栈中的某些信息，但是，您可以要求调试器尝试向您显示给定堆栈帧的信息。首先执行“ `kn`”以查看带有帧号的堆栈，然后尝试“ `.frame /c [frame]`”或“ `.frame /r [frame]`”。

查看帮助 (" `.hh`") 了解更多信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-25T16:18:49.873

我认为您在调试时也无法获得它。您可以从寄存器中获得的唯一值是它们在当前指令中的值。

# c++ - 您如何找到整数类型在 C++ 中可以表示的值的范围？

> ID：357629
> 
> 赞同：11
> 
> 时间：2008-12-10T21:13:25.827
> 
> 标签：c++, types

C++ 中整数值类型的大小和范围是特定于平台的。在大多数 32 位系统上找到的值可以在[变量中找到。数据类型。- C++ 文档](http://www.cplusplus.com/doc/tutorial/variables.html)。您如何确定您的特定系统的实际尺寸和范围？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-10T21:15:32.203

## C风格

limits.h 包含整数的最小值和最大值以及应该正是您需要的其他数据类型：

```
#include <limits.h> // C header
#include <climits> // C++ header

// Constant containing the minimum value of a signed integer (–2,147,483,648)
INT_MIN; 

// Constant containing the maximum value of a signed integer (+2,147,483,647)
INT_MAX; 
```

有关常量及其常用值的完整列表，请查看：[Wikipedia - limits.h](http://en.wikipedia.org/wiki/Limits.h)

* * *

## C++ 风格

正如其他评论者提到的那样，有一个基于模板的 C++ 方法：

```
 #include <limits>

  std::numeric_limits 
```

看起来像：

```
 std::numeric_limits<int>::max(); 
```

它甚至可以做一些更巧妙的事情，比如确定可能的位数或数据类型是否有符号：

```
 // Number of digits for decimal (base 10)
  std::numeric_limits<char>::digits10;

  // Number of digits for binary
  std::numeric_limits<char>::digits;

  std::numeric_limits<unsigned int>::is_signed; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T21:17:59.563

看一眼`std::numeric_limits`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-10T21:15:31.737

为什么不只是确定并使用 boost 的数字类型呢？

IE：

```
boost::uint32_t
boost::int32_t 
```

ETC

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-10T21:18:41.790

使用`sizeof()`C++ 中的运算符来确定值类型的大小（以字节为单位）。标准库头文件 limits.h 包含整数值类型的范围限制。您可以运行以下程序来了解系统上整数类型的大小和范围限制。

```
#include <stdlib.h>
#include <iostream>
#include <limits>

using namespace std;

int main(int argc, char** argv) {

    cout << "\nCharacter Types" << endl;
    cout << "Size of character type is " << sizeof(char) << " byte." << endl;
    cout << "Signed char min: " << SCHAR_MIN << endl;
    cout << "Signed char max: " << SCHAR_MAX << endl;
    cout << "Unsigned char min: 0" << endl;
    cout << "Unsigned char max: " << UCHAR_MAX << endl;

    cout << "\nShort Int Types" << endl;
    cout << "Size of short int type is " << sizeof(short) << " bytes." << endl;
    cout << "Signed short min: " << SHRT_MIN << endl;
    cout << "Signed short max: " << SHRT_MAX << endl;
    cout << "Unsigned short min: 0" << endl;
    cout << "Unsigned short max: " << USHRT_MAX << endl;

    cout << "\nInt Types" << endl;
    cout << "Size of int type is " << sizeof(int) << " bytes." << endl;
    cout << "Signed int min: " << INT_MIN << endl;
    cout << "Signed int max: " << INT_MAX << endl;
    cout << "Unsigned int min: 0" << endl;
    cout << "Unsigned int max: " << UINT_MAX << endl;

    cout << "\nLong Int Types" << endl;
    cout << "Size of long int type is " << sizeof(long) << " bytes." << endl;
    cout << "Signed long min: " << LONG_MIN << endl;
    cout << "Signed long max: " << LONG_MAX << endl;
    cout << "Unsigned long min: 0" << endl;
    cout << "Unsigned long max: " << ULONG_MAX << endl;

    return (EXIT_SUCCESS);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-10T21:38:09.803

您可以使用*stdint.h*（或*cstdint*，如果您使用 C++）中定义的类型，它们是 C99 标准的一部分。它定义了具有诸如*int32_t*、*uint8_t*、*int64_t*等名称的类型，这些类型保证可移植且与平台无关。

更多信息：[stdint.h](http://en.wikipedia.org/wiki/Stdint.h)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-26T10:02:08.627

您可以通过应用以下公式来获取任何数据类型的范围：

**[-2 次方 (N-1)] 到 { [+2 次方 (N-1)] - 1 }**

其中“N”是数据类型的宽度，例如在 JAVA 中 int 的宽度是 32，因此 N = 32。

试试这个你会明白的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-12T04:50:51.180

```
#include<stdio.h>  
#include<limits.h>   
void main()  
{  
     printf(" signed data types " );  
     printf(" int min : %d ", INT_MIN); // INT_MIN, INT_MAX, SCHAR_MIN, SCHAR_MAX ....etc  
     printf(" int max : %d  ",INT_MAX);// pre defined constants to get the values of datatypes       
     printf(" signed char min : %d ", SCHAR_MIN);  
     printf(" signed char max : %d ", SCHAR_MAX);  
// similarly for un_signed  
// use %u for control charter, and UINT_MAX, UCHAR_MAX, USHRT_MAX, ULONG_MAX.  
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-18T09:38:14.150

按位运算可用于查找平台中 int 的位数和范围。这是我为测试机器上的 int 范围而编写的示例。

```
 #include <iostream>

    using namespace std;

    void print_int_range() {
        int i=1;

        int nOfBits=0;
        while (i != 0) {
            i = i << 1;
            nOfBits++;
        }

        cout << "int has " << nOfBits << " bits" << endl;

        cout << "mininum int: " << (1 << (nOfBits - 1)) << ", maximum int: " << ~(1 << (nOfBits - 1))  << endl;

    }

    void print_unsigned_int_range() {
        unsigned int i=1;

        int nOfBits=0;
        while (i != 0) {
            i = i << 1;
            nOfBits++;
        }

        cout << "unsigned int has " << nOfBits << " bits" << endl;

        cout << "mininum int: " << (0) << ", maximum int: " << (unsigned int) (~0) << endl;
    }

    int main() {
        print_int_range();

        print_unsigned_int_range();
    } 
```

这是我的输出：

```
int has 32 bits 
mininum int: -2147483648, maximum int: 2147483647 
unsigned int has 32 bits 
mininum int: 0, maximum int: 4294967295 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2008-12-10T21:42:26.453

```
sizeof(int) 
```

# apache-flex - 谁在使用带有导入 Web 服务的 Cairngorm 2.2？

> ID：357630
> 
> 赞同：0
> 
> 时间：2008-12-10T21:13:35.640
> 
> 标签：apache-flex, web-services, flexbuilder, cairngorm

我对 Cairngorm 很陌生，所以很抱歉可能是一个简单的问题：

我正在处理一些导入到 Flex Builder 3 中的 WCF 服务（通过数据 > 管理 Web 服务），我想知道如何将这些服务公开给 Cairngorm 中的 ServiceLocator。从我目前所读到的内容来看，Cairngorm 似乎更喜欢在 Services.mxml（或以某种方式在 MXML 中）定义服务，但这在我的情况下不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T22:01:16.353

我现在正在开发一个应用程序，Services.mxml 让我发疯......只是没有拨打电话。我已经阅读了描述此问题解决方案的博客文章，但这是一个反复出现、令人烦恼的问题，因此我想找到一种更可靠的方法。我相信您可以简单地替换您的代表中的代码，您可以在其中检索对 Web 服务的引用

```
this.service = ServiceLocator.getInstance().getWebService("web service name here"); 
```

像这样：

```
this.service = generated.webservices.MyService(); 
```

我希望在那之后，其余的应该是直截了当的。我打算今晚做一些测试，所以我会告诉你进展如何。

# caching - 内存缓存限制

> ID：357634
> 
> 赞同：2
> 
> 时间：2008-12-10T21:15:21.003
> 
> 标签：caching, memcached, distributed-caching

是否有人在以下方面遇到过 memcached 限制：

*   # 缓存存储中的对象数量 - 是否存在性能下降的点？

*   分配的内存量 - 使用的基本数字是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T17:15:12.207

我可以给你一些关于我们环境的指标。我们在 12 个机器上运行用于 Win32 的 memcached（作为数据库非常重的 ASP.NET 网站的缓存）。这些盒子每个都有自己的其他职责；我们只是将 memcached 节点分布在所有有空闲内存的机器上。每个节点最多有 512MB 由 memcached 分配。

我们的节点平均有 500 - 1000 个连接打开。一个典型的节点在缓存中有 60.000 个项目，每秒处理 1000 个请求（！）。所有这些运行都相当稳定，几乎不需要维护。

我们遇到了两种限制： 1\. 客户端机器上的 CPU 使用。我们使用 .NET 序列化在 memcached 中存储和检索对象。无缝运行，但 CPU 使用率会随着我们的负载而变得非常高。我们发现有些对象最好先转换为字符串（或 HTML 片段）然后缓存。2\. 我们遇到了一些问题，memcached box 的 TCP/IP 连接用完。分布在更多的盒子上有所帮助。

[我们运行 memcached 1.2.6 并使用来自http://www.codeplex.com/EnyimMemcached/](http://www.codeplex.com/EnyimMemcached/)的 .NET 客户端

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T02:19:44.397

我不能保证这种说法的准确性，但在几个月前的一次 linux/开发者聚会上，一位工程师谈到了他的公司如何将 memcache 缩减为使用 2GB 块，每个 memcache 盒 3-4 个。他们发现吞吐量很好，但是对于非常大的 memcache 守护进程，他们的未命中率增加了 4%。他说他们无法弄清楚为什么会有差异，但决定只使用有效的方法。

# php - 返回页面后继续运行 php 脚本

> ID：357639
> 
> 赞同：6
> 
> 时间：2008-12-10T21:15:50.690
> 
> 标签：php

我正在尝试编写一个脚本，该脚本将在服务器上创建一个文件，然后用于`header()`将用户重定向到该文件。然后，大约 10 秒后，我想删除该文件。我试过这个：

```
header('Location: '.$url);
flush();
sleep(10);
unlink($url); 
```

但是浏览器只是等待脚本完成然后被重定向，但是那个时候文件已经被删除了。有没有办法告诉浏览器“文件结束”，然后继续计算？或者也许让 PHP 启动另一个脚本，但不等待该脚本完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T22:04:32.527

让 PHP 页面提供文件可能会更好。在这种情况下无需创建临时文件并将其删除，只需将您要写入的数据发送到临时文件即可。您需要正确设置标题，以便浏览器可以识别您发送的文件类型。即Content-Type：text/xml；用于 xml 或用于 jpg 的图像/jpeg。

此方法还可以处理下载文件所需时间较长的慢速客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T21:31:26.977

到目前为止，我发现这样做的唯一方法是在标题中提供内容长度。尝试添加这个：

```
header("Content-Length: 0"); 
```

在你的 flush();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T22:02:56.507

[http://us2.php.net/ignore_user_abort](http://us2.php.net/ignore_user_abort)

使用它时要非常小心，您可以通过滥用它来快速杀死服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T22:05:34.053

或者....而不是在运行中动态生成文件...为什么不制作这样的处理程序：

tempFile.php?key={md5 哈希}

然后 tempFile.php 查询数据库、内存缓存（带有附加的前置键）或 apc 的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T21:28:58.917

你可以尝试这样做：

```
<iframe src="<?=$url?>"></iframe>

....
<?
sleep(10);
unlink($url);
?> 
```

其他选项是使用 curl - 然后在请求中加载文件并显示给用户。

问题-您是否要删除用户无法拥有的文件-恐怕这是不可能的，当用户加载文件时，它会暂时在他的浏览器中-因此他可以保存它。

下一个选项 - 如果您知道此文件的类型，您可以生成内容/类型标头，以便用户下载该文件。然后你删除它。

这只是简单的想法，不知道哪个对你有用（如果有的话:)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-24T02:53:46.123

如果您想实现您的原始设计，请阅读有关在 PHP 中运行“即发即忘”的命令的问题 [Asynchronous shell exec in PHP](https://stackoverflow.com/questions/222414/asynchronous-shell-exec-in-php/222445#222445)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-11T09:27:21.927

如所见`\Symfony\Component\HttpFoundation\Response::send`

```
/**
 * Sends HTTP headers and content.
 *
 * @return Response
 *
 * @api
 */
public function send()
{
    $this->sendHeaders();
    $this->sendContent();

    if (function_exists('fastcgi_finish_request')) {
        fastcgi_finish_request();
    } elseif ('cli' !== PHP_SAPI) {
        // ob_get_level() never returns 0 on some Windows configurations, so if
        // the level is the same two times in a row, the loop should be stopped.
        $previous = null;
        $obStatus = ob_get_status(1);
        while (($level = ob_get_level()) > 0 && $level !== $previous) {
            $previous = $level;
            if ($obStatus[$level - 1]) {
                if (version_compare(PHP_VERSION, '5.4', '>=')) {
                    if (isset($obStatus[$level - 1]['flags']) && ($obStatus[$level - 1]['flags'] & PHP_OUTPUT_HANDLER_REMOVABLE)) {
                        ob_end_flush();
                    }
                } else {
                    if (isset($obStatus[$level - 1]['del']) && $obStatus[$level - 1]['del']) {
                        ob_end_flush();
                    }
                }
            }
        }
        flush();
    }

    return $this;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-11T02:41:57.067

你以错误的方式解决这个问题。您可以创建文件并将其提供给他们，然后一步将其删除。

```
<?php
$file_contents = 'these are the contents of your file';
$random_filename = md5(time()+rand(0,10000)).'.txt';
$public_directory = '/www';
$the_file = $public_directory.'/'.$random_filename;
file_put_contents($the_file, $file_contents);
echo file_get_contents($the_file);
unlink($the_file);
?> 
```

如果你这样做，文件会在用户看到它们后立即被删除。当然，这意味着文件不需要首先存在。因此，您可以将代码缩短为：

```
<?php
$file_contents = 'these are the contents of your file';
echo $file_contents;
?> 
```

这完全取决于您从哪里获得要向他们展示的内容。如果它来自文件，请尝试：

```
<?php
$file_contents = file_get_contents($filename_or_url);
echo $file_contents;
?> 
```

至于自动删除文件，只需设置一个每 10 秒运行一次的 cron 作业，并删除临时文件夹中 filemtime($filename) 大于 5 分钟的秒数的所有文件。

# date - 表示重复日期

> ID：357643
> 
> 赞同：6
> 
> 时间：2008-12-10T21:17:23.650
> 
> 标签：date

## 重复日期：

计费周期有很多不同的格式，例如：“每月的第一个”、“每月的第三个星期五”或“每月 13 日之后的第 21 天或之后的第一个工作日”（感谢 visa！） . 我的目标是能够在一个易于解析的数据库文本字段中表示这些不同的计费周期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T21:40:55.507

你忘了周末处理。如果我的帐单是星期天到期，我希望它在星期五出现。那种事。我认为有三种可能：

1.  总是在周末之前
2.  总是在周末之后
3.  如果是周六，周五，如果是周日，周一

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-11T00:30:57.683

## 当前解决方案：

```
YYYY/MM/DD+YY/MM/DD+DOW 
```

*   所有块（由 分隔`+`）以及每个块的所有部分都是可选的。
*   第一个块表示开始日期
    *   如果空白 - 表示今天
    *   如果缺少部分 - 表示所有...即“//12”将表示每个月的第 12 天。
    *   负数表示从期末开始计数。即“//-1”表示该月的最后一天
    *   超支将进入下个月，即“//40”将是当月第一天之后的 40 天
*   第二个块表示重复之间的日期变化
    *   如果为空 - 设置日期（从第一个块开始）
    *   添加当前部分 - 即“/1/”表示给定开始日期之后的每个月
*   第三个块表示计算日期应移动到的星期几
    *   可用时间为`[m,t,w,r,f,s,d,b]`（一周中的 7 天，“工作日”）

## 计算：

*   计算从第一个块中指定的日期开始，用添加记录的日期填充缺失的部分。
*   然后添加 DOW 以获得有效的开始日期。这是活动的第一个日期。
*   下一个日期是通过将第二个块添加到最后计算的第一个块并添加 DOW 以获得下一个日期来计算的。

## 例子：

*   2008 年 3 月 12 日 - “2008/3/12”
*   每个月的第一天 - "//1+/1/"
*   每个月的第三个星期五 - "//21+/1/+f"
*   每月 13 日之后的第 21 天或之后的第一个工作日 - "//34+/1/+b"
*   从今天起每 2 周 - “+//14”
*   从三月开始的每个第二个月的最后一天 - “/3/-1+/2/”

# intellij-idea - 值得从 Intellij Idea7 升级到 Idea8？

> ID：357648
> 
> 赞同：5
> 
> 时间：2008-12-10T21:18:29.437
> 
> 标签：intellij-idea

我将 Intellij Idea 7 用于 Java 开发。我的开发人员“仅限于”所有 J2SE 功能以及轻量级 JSP、Servlet 和 JPA 的超轻量级使用。没有 J2EE，没有大量使用随机框架等。

是否值得升级到版本 8？对我来说，“值得”意味着在速度（特别是启动速度）、内存利用率（似乎在打开四个或更多项目时它开始出现严重问题）和自动查找错误方面更好的“核心功能”。支持更多的框架和更多的语言（可能除了 Haskell 和 C++），以及更多的重构目前我不感兴趣。

不久前，我安装了 8 的预览版，就我的需求而言，它似乎与 7 完全相同。

有人喜欢升级到 8，如果是，为什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T21:30:45.917

在现有代码的复杂集合之上配置新项目似乎也更容易。

例如，您自然会配置成 5 个或更多模块的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T12:53:42.723

最好的判断方法是查看[新功能列表](http://www.jetbrains.com/idea/features/newfeatures.html)并自行决定。到目前为止，我还没有发现任何值得升级的特性——简化的 UML 视图非常好，改进的 Maven 集成也是如此。用户界面感觉更加精简和快速。似乎大部分注意力都集中在了非 Java 特性上，比如更好的 Flex 支持（我非常感谢，因为我不喜欢 FlexBuilder，但我还没有机会使用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-21T08:15:06.110

有一个非常漂亮的 go to/create 测试向导绑定到 ctrl-shift-T。值得自己升级

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T20:07:10.303

我正在研究 Diana-EAP 构建 - 但 8 内置了 git 集成。EAP 具有比 8.0.1 版本更好的 git 集成 - 看起来这是他们真正关注的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T21:27:31.727

IntelliJ 8 具有配置插件功能，允许您禁用具有依赖关系的插件。没有什么试验和错误无法复制，但它很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T21:38:47.600

启动只是稍微慢一点。但是一旦打开索引就比以前快了很多，对于大多数项目来说甚至是不明显的，除非是在提交到 Subversion 之后。似乎对颠覆的提交会触发两次索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T21:43:19.533

当然不！似乎我们自定义标记库中定义的变量不再能够在 jsp 中使用（在 7.0.4 中工作）。都是红色的。没有自动完成。

哦，新的设置菜单太可怕了！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T00:27:36.510

IntelliJ IDEA 8 的一些好处：

IDEA 8 支持[Subversion 1.5](http://subversion.tigris.org/svn_1.5_releasenotes.html)的新功能 - 例如合并跟踪，这可能很有用，特别是如果您的团队（[如我们](https://stackoverflow.com/questions/200757/how-do-you-handle-the-tension-between-refactoring-and-the-need-for-merging/583650#583650)的团队）使用大量开发分支并因此合并频繁。

关于 IDEA 8 的一个细节我很欣赏：你可能知道，IDEA 已经有很长时间的[变更列表，建立在任何底层版本控制系统之上——这是一个非常有用的特性。](http://www.jetbrains.com/idea/features/version_control.html#VCS_Change_List_Management)所以，既然 Subversion 本身支持[changeslists](http://subversion.tigris.org/svn_1.5_releasenotes.html#changelists)，IDEA 的 changelist 实现已经改变，因此它与 Subversion 的本机 changelists 完美兼容。（例如，在`svn`直接使用命令行工具时，您也可以使用在 IDEA 中创建的任何更改列表。）

**编辑**：在您的情况下，也许不值得升级。至少对我来说，8 的启动和文件索引似乎比 7 慢一些。[但对我个人而言，升级绝对值得，因为它解决了 IDEA 7 长期存在的 VCS 问题——它可能会挂起“等待让 VCS 同步完成”一小时或按 Ctrl-K 后的任何时间。]

# asp.net - ASP.net AJAX：文本框只读状态

> ID：357650
> 
> 赞同：0
> 
> 时间：2008-12-10T21:18:39.077
> 
> 标签：asp.net

我目前在 ajax 更新面板上有一个名为 Edit 的按钮和一个名为 blah 的文本框。是否可以通过触发器将 asp.net 的文本框设置为只读？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T21:27:37.263

对的，这是可能的。

假设触发器是编辑按钮的 onclick 处理程序，把代码放在那里......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T21:33:27.237

只要按钮触发更新面板，您只需在按钮的单击事件处理程序中将只读属性设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T21:34:54.690

如果你在设计窗口中双击你的编辑按钮，它会创建一个这样的方法：

```
protected void btnEdit_Click(object sender, EventArgs e)
    {

    } 
```

只需添加一些这样的代码：

```
txtbox.ReadOnly = true; 
```

使您的文本框只读。

# python - 取消接受和关闭 Python 处理/多处理侦听器连接的正确方法

> ID：357656
> 
> 赞同：11
> 
> 时间：2008-12-10T21:25:18.360
> 
> 标签：python, sockets, multiprocessing

（我在这个例子中使用了[pyprocessing模块，但是如果你运行](http://developer.berlios.de/projects/pyprocessing)[python 2.6](http://docs.python.org/library/multiprocessing.html)或者使用[multiprocessing backport](http://code.google.com/p/python-multiprocessing/)，用 multiprocessing 替换 processing 应该可以工作）

我目前有一个程序可以侦听 unix 套接字（使用 processing.connection.Listener），接受连接并生成一个处理请求的线程。在某个时刻，我想优雅地退出该过程，但由于 accept() 调用被阻塞，我看不出有什么办法可以很好地取消它。我至少有一种方法可以在这里工作（OS X），设置一个信号处理程序并从另一个线程发出进程信号，如下所示：

```
import processing
from processing.connection import Listener
import threading
import time
import os
import signal
import socket
import errno

# This is actually called by the connection handler.
def closeme():
    time.sleep(1)
    print 'Closing socket...'
    listener.close()
    os.kill(processing.currentProcess().getPid(), signal.SIGPIPE)

oldsig = signal.signal(signal.SIGPIPE, lambda s, f: None)

listener = Listener('/tmp/asdf', 'AF_UNIX')
# This is a thread that handles one already accepted connection, left out for brevity
threading.Thread(target=closeme).start()
print 'Accepting...'
try:
    listener.accept()
except socket.error, e:
    if e.args[0] != errno.EINTR:
        raise
# Cleanup here...
print 'Done...' 
```

我想到的唯一另一种方法是深入连接（listener._listener._socket）并设置非阻塞选项......但这可能有一些副作用并且通常非常可怕。

有没有人有更优雅（甚至可能是正确的！）的方式来完成这个？它需要可移植到 OS X、Linux 和 BSD，但 Windows 可移植性等不是必需的。

**澄清**：谢谢大家！像往常一样，我原来的问题中的歧义被揭示了:)

*   我需要在取消监听后执行清理，并且我并不总是想真正退出该过程。
*   我需要能够从不是从同一个父进程产生的其他进程访问这个进程，这使得队列变得笨拙
*   线程的原因是：
    *   他们访问共享状态。实际上或多或少是一个常见的内存数据库，所以我想它可以做得不同。
    *   我必须能够同时接受多个连接，但实际线程大部分时间都在阻塞。每个接受的连接都会产生一个新线程；这是为了不阻止 I/O 操作上的所有客户端。

关于线程与进程，我使用线程来使我的阻塞操作非阻塞，并使用进程来启用多处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T19:03:29.077

这不是选择的目的吗？

如果选择表明它不会阻塞，则仅在套接字上调用接受...

选择有超时，因此您可以偶尔中断以检查是否该关闭...。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T13:46:04.070

我以为我可以避免它，但似乎我必须做这样的事情：

```
from processing import connection
connection.Listener.fileno = lambda self: self._listener._socket.fileno()

import select

l = connection.Listener('/tmp/x', 'AF_UNIX')
r, w, e = select.select((l, ), (), ())
if l in r:
  print "Accepting..."
  c = l.accept()
  # ... 
```

我知道这违反了 demeter 法则并引入了一些邪恶的猴子补丁，但似乎这将是实现这一点的最容易移植的方式。如果有人有更优雅的解决方案，我会很高兴听到它:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T03:46:03.413

我是多处理模块的新手，但在我看来，混合处理模块和线程模块是违反直觉的，他们的目标不是解决同样的问题吗？

无论如何，将你的监听函数包装到一个进程本身怎么样？我不清楚这如何影响您的其余代码，但这可能是一个更干净的选择。

```
from multiprocessing import Process
from multiprocessing.connection import Listener

class ListenForConn(Process):

    def run(self):
        listener = Listener('/tmp/asdf', 'AF_UNIX')
        listener.accept()

        # do your other handling here

listen_process = ListenForConn()
listen_process.start()

print listen_process.is_alive()

listen_process.terminate()
listen_process.join()

print listen_process.is_alive()
print 'No more listen process.' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T22:14:28.683

可能并不理想，但您可以通过从信号处理程序或终止进程的线程向套接字发送一些数据来释放块。

编辑：实现这一点的另一种方法可能是使用~~Connection~~ [Queues](http://docs.python.org/dev/library/multiprocessing.html#pipes-and-queues)，因为它们似乎支持超时（抱歉，我在第一次阅读时误读了您的代码）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-02T09:06:14.740

我遇到了同样的问题。我通过向侦听器发送“停止”命令来解决它。在侦听器的主线程（处理传入消息的线程）中，每次收到新消息时，我只是检查它是否是“停止”命令并退出主线程。

这是我正在使用的代码：

```
def start(self):
    """
    Start listening
    """
    # set the command being executed
    self.command = self.COMMAND_RUN

    # startup the 'listener_main' method as a daemon thread
    self.listener = Listener(address=self.address, authkey=self.authkey)
    self._thread = threading.Thread(target=self.listener_main, daemon=True)
    self._thread.start()

def listener_main(self):
    """
    The main application loop
    """

    while self.command == self.COMMAND_RUN:
        # block until a client connection is recieved
        with self.listener.accept() as conn:

            # receive the subscription request from the client
            message = conn.recv()

            # if it's a shut down command, return to stop this thread
            if isinstance(message, str) and message == self.COMMAND_STOP:
                return

            # process the message

def stop(self):
    """
    Stops the listening thread
    """
    self.command = self.COMMAND_STOP
    client = Client(self.address, authkey=self.authkey)
    client.send(self.COMMAND_STOP)
    client.close()

    self._thread.join() 
```

我正在使用身份验证密钥来防止黑客通过从任意客户端发送停止命令来关闭我的服务。

我的不是一个完美的解决方案。似乎更好的解决方案可能是修改 中的代码`multiprocessing.connection.Listener`，并添加一个`stop()`方法。但是，这需要通过流程发送它以供 Python 团队批准。

# xml - 使用 XSL 生成在同一脚本中执行的动态 XSL？

> ID：357672
> 
> 赞同：6
> 
> 时间：2008-12-10T21:29:56.230
> 
> 标签：xml, xslt, dynamic

我想动态创建具有动态名称的变量，以便以后在我的转换中使用，但要做到这一点，我需要动态生成 XSL，然后在同一个脚本中运行它。

这只是我正在寻找的一个粗略的伪代码示例。

```
 <xsl:for-each select="//constants/constant" >
        <xsl:variable >
            <xsl:attribute name="name">
              <xsl:value-of select="@name"/>
            </xsl:attribute>
          <xsl:attribute name="select">
            <xsl:value-of select="@value"/>
          </xsl:attribute>
        </xsl:variable>
      </xsl:for-each> 
```

我可以使用 XSL 动态构建 XSL 以便稍后在同一脚本中运行吗？

注意：我们的 XML 是通过运行 CL XSL 转换引擎的批处理来转换的；因此，仅在 XSL 文档中引用 XSL 样式表不是一种选择。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-11T00:56:17.313

**XSLT 有一个特殊的内置特性，它支持生成输出，这就是 XSLT**本身。

这是**`<xsl:namespace-alias>`**XSLT 指令。

**正如** [**XSLT 1.0 Spec**](http://www.w3.org/TR/xslt#literal-result-element)所解释的那样：

"

```
<!-- 分类：顶级元素 -->
<xsl:命名空间别名
  样式表前缀 = 前缀 | “＃默认”
  结果前缀 = 前缀 | "#default" />

```

样式表可以使用该`xsl:namespace-alias`元素来声明一个命名空间 URI 是另一个命名空间 URI 的**别名**。当一个文本命名空间 URI 被声明为另一个命名空间 URI 的别名时，结果树中的命名空间 URI 将是文本命名空间 URI 作为别名的命名空间 URI，而不是文本命名空间 URI 本身。该`xsl:namespace-alias`元素声明绑定到属性指定前缀`stylesheet-prefix`的命名空间URI 是绑定到属性指定前缀的命名空间URI 的别名`result-prefix`。因此，该`stylesheet-prefix`属性指定将出现在样式表中的命名空间 URI，而该`result-prefix`属性指定将出现在结果树中的相应命名空间 URI。"

**下面是一个生成`xsl:stylesheet`包含 an的转换的小示例`xsl:variable`，**它以所需的方式构造：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xxx="my:dummyNS" 排除结果前缀="xxx"
 >
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:namespace-alias result-prefix="xsl" stylesheet-prefix="xxx"/>

 <xsl:template match="/*">
  <xxx:stylesheet 版本="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xxx:变量名="{@name}">
    <xsl:value-of select="."/>
  </xxx:变量>
 </xxx:样式表>
 </xsl:模板>
</xsl:stylesheet>

```

When this transformation is applied on the following XML document:

    `<v name="myVarName">myValue</v>`

the wanted result is produced:

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:variable name="myVarName">myValue</xsl:variable>
</xsl:stylesheet>

```

**Then the next step will be to launch in your "script" this dynamically generated XSLT transformation**.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T14:22:25.843

What you want is not possible at present in pure XSLT (1.0 or 2.0).

If you are useing the [**Saxon 9.x XSLT processor**](http://www.saxonica.com/), there is a couple of extension functions that implement this: [**saxon:compile-stylesheet()**](http://www.saxonica.com/documentation/extensions/functions/compile-stylesheet.html) and [**saxon:transform()**](http://www.saxonica.com/documentation/extensions/functions/transform.html).

一个问题的解决方案真的需要这样的功能是非常罕见的，如果你描述了这个问题，人们很可能会找到解决它的最佳方法，而不必动态地生成和执行 XSLT 样式表。

# .net - 如何确定我的 .NET 程序正在使用多少内存？

> ID：357675
> 
> 赞同：7
> 
> 时间：2008-12-10T21:30:18.397
> 
> 标签：.net, profiling, memory-management

似乎经常说任务管理器不提供进程正在使用多少内存的准确指示。

如果确实如此，找出这些东西的最简单方法是什么？

我想知道：

*   使用中的总内存（无论是在 RAM 中还是在分页中或其他）
*   正在使用的总 RAM（在机器有大量可用物理 RAM 的情况下运行，因此希望被强制分页的事情不是问题）
*   程序实际使用的总内存（不计算 GC 保留的额外开销）
*   仅由我的程序使用的总内存使用量（不包括共享库/共享内存）
*   共享内存使用总量。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T21:46:45.090

抓住[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)，右键单击 -> 属性列表中的进程，然后单击“.NET”选项卡。从组合框中选择“.NET CLR 内存”，您将获得有关您的流程的更多实时信息，而不是您知道如何处理；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T21:44:04.143

[http://memprofiler.com/](http://memprofiler.com/)是一个非常好的.Net 内存分析器。但微软在 Windows 性能监视器 (perfmon) 中的构建也会为您提供这些数据。请参阅[http://dotnetdebug.ne​​t/2005/06/30/perfmon-your-debugging-buddy/](http://dotnetdebug.net/2005/06/30/perfmon-your-debugging-buddy/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T21:35:55.937

您可以做一些事情，但我相信，如果您认真分析您的应用程序，最好的办法是使用 Red Gate 的 Ants Profiler：

[http://www.red-gate.com/Products/ants_profiler/index.htm](http://www.red-gate.com/Products/ants_profiler/index.htm)

该软件非常全面，可以很好地了解您的应用程序呈现的内存使用情况和其他类型的指标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T21:47:35.243

启动性能监视器 (perfmon.exe) 并查看 .Net CLR 内存性能对象。每个正在运行的 .net 程序都有自己的实例。你应该能够在那里找到你想要的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T21:48:17.893

如果您双击某个进程， [Process Explorer将向您显示其中的一些内容。](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T21:49:10.653

[SysInternals](http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx) ProcessExplorer中有一些很好的功能，包括 .NET 分析器，但如果您需要专业工具，ANTS 是您的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T21:52:22.597

我也使用 memprofiler，它极大地帮助了我们。

# ibm-datapower - DataPower XA35 - 处理规则 - 路由操作

> ID：357678
> 
> 赞同：1
> 
> 时间：2008-12-10T21:30:39.380
> 
> 标签：ibm-datapower

我们的处理规则包括两个转换操作、一个验证和结果操作。我们想在两个转换动作之间添加另一个动作来执行以下操作：

新操作将使用 XSLT 来评估表达式。如果存在匹配项，则跳过其余的处理规则操作以转到最后的结果操作。否则，继续处理处理规则提供的其余操作。

我需要使用什么类型的操作来提供此解决方案，也许是“路由操作”？如果是，xslt 文件中调用最后一个结果操作的语法是什么？

请提供任何建议。

谢谢你 - Eneo。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-02T21:18:34.663

在最新的固件中，有一个“条件”动作，您可以使用它来跳过动作。

# iphone - UISearchBar 动画

> ID：357684
> 
> 赞同：11
> 
> 时间：2008-12-10T21:32:42.357
> 
> 标签：iphone, cocoa-touch

在应用程序中看到 UISearchBar 是很常见的，单击它会放大并使用键盘动画显示。我很好奇，这是 iPhone SDK 免费提供的东西，还是动画代码很可能是由开发人员编写的？我在几个控制器中使用 UISearchBar，但是默认情况下，键盘只是弹出视图，搜索栏不会以任何方式动画。这在具有搜索图标的应用程序中也非常突出。它通常是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-08T10:52:26.310

这可以通过使用 iPhone SDK 3.0 及更高版本的 UISearchDisplayController 轻松实现。

请参阅 SDK 中包含的 TableSearch 示例项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-22T09:48:38.540

在苹果网站上有一个讨论[“UISearchBar like Contacts” 。](http://discussions.apple.com/thread.jspa?threadID=1652157&tstart=0)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T21:07:25.293

您是通过 Interface Builder 还是以编程方式放入的？因为默认情况下应该播放键盘动画。

# c# - 调试使用多个 [Row] 属性编写的单元测试的好方法是什么？

> ID：357690
> 
> 赞同：0
> 
> 时间：2008-12-10T21:35:01.993
> 
> 标签：c#, debugging, tdd, mbunit

当我在 Gallio 的 Icarus 中运行以下测试时，它通过了，但是当我使用 TestDriven.NET（Test With->Debugger）进入它时，它失败了，因为没有根据 Row 属性设置参数。

我期望为每个应用的 Row 属性调用一次该方法。

我究竟做错了什么？如果没有，那么当它们中断时我需要做什么来调试这些测试？如果它们不可调试，我应该避免参数化测试吗？

```
[TestFixture]
public class TestDrivenIgnoresMbUnitAttributesWhenDebugging
{
    [Test]
    [Row(1)]
    [Row(2)]
    public void SomeFunc(int x)
    {
        Assert.AreNotEqual(default(int), x);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T04:43:22.877

嗯...您在安装 Gallio 之前安装了 TestDriven.Net 吗？

如果没有，则不会安装 TestDriven.Net 的 Gallio 扩展。在这种情况下，TestDriven.Net 可能会在“ad-hoc”模式下使用其参​​数的默认值运行测试。

判断是否是这种情况应该很漂亮。如果安装了 TestDriven.Net 的 Gallio 扩展，那么您将在测试执行期间在输出窗口中看到“Gallio”横幅消息。如果不是，您可能会看到其他类似“ad-hoc”的内容。

要解决此问题，请重新安装 Gallio。或者，您可以使用 Gallio 安装程序的添加/删除功能部分，然后确保选择了 TestDriven.Net 组件进行安装（在“Test Runners”下）。

# php - 缓存总是在 PHP 中加载文件

> ID：357691
> 
> 赞同：0
> 
> 时间：2008-12-10T21:35:16.080
> 
> 标签：php, performance, caching

在我的`index.php`文件中，我总是加载一些稍后使用的类。分析器指出，有时它可能会占用整个代码的 20%。有什么改进可以使这个过程更快吗？

我会尝试使这个类列表更短，但是应用程序非常大，检查所有依赖项的成本很高。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T21:43:43.067

诸如[APC](http://www.php.net/apc)和[eAccelerator](http://eaccelerator.net/)之类的操作码缓存将脚本的编译版本存储在缓存中。这大大减少了频繁使用的静态脚本的内存使用和加载时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T22:14:36.920

虽然使用操作码缓存（例如 APC）将减少加载/解析/编译类的影响，但您仍将在每次页面加载时全部加载它们并执行 require_once() 调用附带的任何初始化。如果您要设置[自动加载功能](http://www.php.net/__autoload)，那么在您的代码实际需要使用它们之前，不会加载这些类。使用类自动加载器会产生一些开销，但它使代码更易于维护。

与往常一样，YMMV，因此对您的应用程序进行基准测试，看看它是否值得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T21:41:13.977

你可能想看看 apc php.net/apc

# c# - 如何在 ANTLR v3 生成的解析器或词法分析器上指定访问说明符？

> ID：357695
> 
> 赞同：1
> 
> 时间：2008-12-10T21:37:02.690
> 
> 标签：c#, antlr

使用 ANTLR v3 和 CSharp2 语言说明符，有没有办法表明您希望生成的词法分析器或解析器是内部的而不是默认的公共？

命名空间指定为：

```
@lexer::namespace {My.Namespace} 
```

我会假设访问说明符存在类似的东西，但我一直找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:35:49.970

antlr-interest 邮件列表上的这个[线程](http://antlr.markmail.org/message/hwddx4xi7da4czre)讨论了它。在撰写本文时，他们正在向规则添加访问说明符，但不支持整个解析器/词法分析器类的访问说明符。如果情况发生变化，将更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T04:19:16.357

我想知道同样的事情，通过查看它使用的模板，它看起来不像你可以。“公共”是硬编码的。

# c# - 如何在 C#/SQL Server 中跟踪重复的日历事件？

> ID：357704
> 
> 赞同：8
> 
> 时间：2008-12-10T21:39:18.333
> 
> 标签：c#, database, datetime, calendar

我想在应用程序的日期/时间显示上显示重复事件。此日期时间显示可以采用日历的形式，但也可以只是即将发生的事件的列表。

**处理跟踪这个可以重复的事件的最佳方法是什么？**

*例如：事件是否应该在数据库中存储一次并在显示代码中投影/重复多次？是否应该多次存储事件然后才渲染？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T21:56:59.937

我以前做过类似的事情，我的架构基于 SQL Server 的 sysschedules 表。

[http://technet.microsoft.com/en-us/library/ms178644.aspx](http://technet.microsoft.com/en-us/library/ms178644.aspx)

上面链接的模式将允许您存储作业（事件）的计划。然后，您可以根据计划计算事件发生的日期。这可能是一个冗长的计算，所以我会尝试在某处缓存该结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T21:50:26.237

我认为这取决于事件的类型。是不是就像圣诞节一样，一旦它来临时，你真的对它不感兴趣，直到下一次发生？还是像“确保我每个月都给我妈妈打电话”这样的任务，如果它发生并且你错过了它，你不希望它消失吗？

我最近实现后者的一种方法是创建一个包含 next_occurrence（日期）、reoccurence_period（每周、每月、每年等）列的记录。这样当下一次出现时它就会出现在列表中。一旦它通过，列表项将有一个回收图标，一旦按下它将更新记录到下一个未来发生。

同样，我不确定这是否适用于您的情况，但对我来说效果很好。

# heatmap - Web 应用程序的热图工具

> ID：357721
> 
> 赞同：7
> 
> 时间：2008-12-10T21:44:15.267
> 
> 标签：heatmap

我有一个客户想要我为他们构建的 Web 应用程序显示数据的[热图](http://en.wikipedia.org/wiki/Heat_map)。

我根本没有使用过热图，我想知道是否有人知道一些生成它们的好工具。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T18:50:11.313

热图通常用于代替更传统的术语：[核密度估计器](http://en.wikipedia.org/wiki/Kernel_density_estimation)。如果您需要即时计算这些，请考虑[GRASS GIS](http://grass.osgeo.org/) - 特别是[v.kernel](http://grass.osgeo.org/grass64/manuals/html64_user/v.kernel.html)或[v.neighbors](http://grass.osgeo.org/grass64/manuals/html64_user/v.neighbors.html)模块。这些将在某个目标分辨率（由当前[区域](http://grass.osgeo.org/grass64/manuals/html64_user/g.region.html)设置定义）下生成密度的连续估计（即光栅表面）。GRASS GIS 可以通过 Python 代码进行控制，因此围绕底层模块编写 Python 包装器将是一件简单的事情，可以将结果导出到您的 Web 应用程序。

对于小型数据集，[R](http://www.r-project.org/)项目具有多个用于读取/写入空间数据和计算内核密度估计的功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-13T01:25:18.793

我意识到这是一篇很旧的帖子——但是下一个偶然发现这个页面的人可能会尝试[gheat](http://code.google.com/p/gheat/)在 webapps 中的热图。如果您碰巧使用这些后端，则有 Django 和 Google App Engine 的端口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T21:57:45.783

我假设这是每个数据点具有三个值的数据——我们将它们称为 x、y 和 z。如果 x 和 y 是空间坐标，那真的很有帮助，因为这会让事情变得更容易。

无论如何，生成一个 x by y 的位图（适当缩放）。

对于数据中的每个 x 和 y 对，将 z 缩放到 0 和 1 之间（或 0 以及地图中的许多颜色），并将 z 绘制为由该值表示的颜色。例如，一个简单的地图可以只使用 RGB 的 R 部分，在这种情况下，您的红色将有 256 个刻度。

最有可能的是，您想要更花哨的东西，但您应该能够理解。

如果您的数据点分散开，您可以将它们绘制为占用空间的矩形，或者在它们之间平滑插值。

注意：这是一个基于 Web 的工具，可以[在此处](http://bioinformatics.ubc.ca/pavlidis/lab/cgi-bin/matrix2png.cgi)执行此操作。我发现它链接自[Wikipedia article on heatmaps](http://en.wikipedia.org/wiki/Heat_map)。也有一个 java 也从那里链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-01T20:05:22.720

如果您想在客户端（使用 JavaScript）生成热图，我可以向您推荐[heatmap.js](http://www.patrick-wied.at/static/heatmapjs/)。它使用 HTML5 Canvas 元素生成动态 Web 热图，您可以随时新添加数据并刷新热图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-11T10:16:29.540

[Pyheat](https://github.com/amccollum/pyheat)是 python 中另一个用于构建热图的好库。 JJ的回复中已经提到了[Gheat](http://code.google.com/p/gheat/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-08T08:51:15.817

我为 PC 和移动网页推荐了一个引人注目的热图工具：http: [//miapex.com](http://miapex.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-03T23:45:01.397

我可以推荐我自己的 jQuery 插件吗？

[jQuery Hottie](https://github.com/DLarsen/jquery-hottie)使得使用普通标记和添加背景颜色变得容易，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/N0ZR4.png)

```
<!-- Coloring elements is easy! -->
<ul id="example1">
  <li>1<li>
  <li>2<li>
  <li>3<li>
  <li>4<li>
  <li>5<li>
</ul>

$('ul#example1 li').hottie(); 
```

# tomcat - 部署时 Grails 数据库连接问题

> ID：357732
> 
> 赞同：4
> 
> 时间：2008-12-10T21:48:09.733
> 
> 标签：tomcat, grails, connection

我可以在 Jetty 中成功运行我的 Grails 应用程序。它成功连接到我的 MsSql 数据库，一切都很好。当我在同一台机器上的 Tomcat 6 中部署相同的应用程序时，在 Tomcat 日志中启动时收到以下错误：

```
Caused by: java.net.ConnectException: Connection refused: connect 
```

我不相信我的 MsSql 服务器是问题，因为我有另一个 Java 应用程序在同一个 Tomcat 实例中运行并成功访问同一个数据库服务器。

当我在 Jetty 和 Tomcat 中部署它时，连接字符串完全相同。在 Tomcat 6 中部署 Grails 应用程序时为什么无法连接到数据库的任何想法？当我的 Grails 应用程序部署在 Tomcat 中时，我似乎无法访问任何数据库。（我的其他 Java 应用程序（Confluence）连接没有问题。

这是我的连接信息：

```
dataSource {
    pooled = true
    driverClassName = "net.sourceforge.jtds.jdbc.Driver"
    username = "user"
    password = "pass"
}
hibernate {
    cache.use_second_level_cache=true
    cache.use_query_cache=true
    cache.provider_class='com.opensymphony.oscache.hibernate.OSCacheProvider'
}
// environment specific settings
environments {
    development {
        dataSource {
            dbCreate = "update" // one of 'create', 'create-drop','update'
            url = "jdbc:jtds:sqlserver://localhost:1143/holidayCards"
        }
    }
    test { //for AD-DEV02
        dataSource {
            dbCreate = "update"
            url = "jdbc:jtds:sqlserver://AD-DEV02:1237/holidayCards;instance=SQL2005"
        }
    }
    production {
        dataSource {
            dbCreate = "update"
            url = "jdbc:jtds:sqlserver://SQL:1433/holidayCards"
        }
    }
} 
```

我总是部署为“测试”：

```
grails test war 
```

正如您从下面的回答中看到的那样，**我认为这不是连接问题，因为当我从 grails 1.1beta1 降级到 1.0.4 时，我能够成功开始工作**。

任何帮助表示赞赏，

安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T11:12:29.033

您的 DataSource.groovy 文件是什么样的？当您使用“grails run-app”运行应用程序时，Grails 使用“开发”部分中的数据源。当您使用“grails war”生成一个war 文件并将其部署到应用程序服务器时，Grails 将使用“生产”部分中的数据源。您可能需要确保您的开发和生产数据源配置相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T18:42:48.110

这是 grails 1.1beta1 的一个问题。当我将我的应用程序恢复到 grails 1.0.4 时，它似乎工作了。不幸的是，我不得不更改几段代码，因为 grails 的 beta 版本修复了一些错误，但这似乎植根于我使用的 grails 版本。

我刚刚使用 1.1beta1 创建了一个空的 grails 应用程序，并且能够在 Tomcat 中成功部署它（并访问数据库）。这让我觉得我的项目中还有一些其他设置不能很好地与 beta 版本配合使用。也许这是我的 jquery 插件。也许它正在将我的项目从 grails 1.0.4 升级到 1.1beta1

这并不能完全解决问题，但可以缩小范围。

安德鲁

# java - 如何在 Swing 中组合组合框和树？

> ID：357739
> 
> 赞同：1
> 
> 时间：2008-12-10T21:49:52.367
> 
> 标签：java, swing, combobox, tree

对于我的应用程序，我想要一个[组合框](http://java.sun.com/docs/books/tutorial/uiswing/components/combobox.html)，它在作为[Tree](http://java.sun.com/docs/books/tutorial/uiswing/components/tree.html)下拉时显示其元素。问题是，我对 Swing 不够精通，不知道如何去做。至少不会最终从头开始编写新的小部件，或者类似的东西。

如果不从头开始创建一个，我将如何做这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T22:40:48.317

我想我会将它实现为 JViewPort 中的 JTree 组件，然后是扩展按钮。折叠时，它看起来像一个组合框。当您单击展开按钮时，视口将展开，允许您滚动并选择 JTree 中的节点。当您选择节点时，视口将折叠回仅显示所选节点和展开按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T22:38:56.433

嘿，你猜怎么着！这是你的幸运日。

我过去使用过这个框架。它非常完整。我不知道他们已经有了这个。

[吉德软](http://www.jidesoft.com/)

[替代文字 http://img89.imageshack.us/img89/8324/combotreejj1.png](http://img89.imageshack.us/img89/8324/combotreejj1.png)

不是太贵，但需要一些时间来理解 API（这并不复杂，但他们创造了很多新东西）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T22:02:40.453

覆盖 getListCellRendererComponent 方法并按级别顺序创建组件。对于每个树级别，将绘制的字符串向右移动 3 个空格。

例子：

1

. 一种

. b

2

. C

您可以查看的原始实现

```
public Component getListCellRendererComponent(
                                       JList list,
                                       Object value,
                                       int index,
                                       boolean isSelected,
                                       boolean cellHasFocus) {
        //Get the selected index. (The index param isn't
        //always valid, so just use the value.)
        int selectedIndex = ((Integer)value).intValue();

    if (isSelected) {
        setBackground(list.getSelectionBackground());
        setForeground(list.getSelectionForeground());
    } else {
        setBackground(list.getBackground());
        setForeground(list.getForeground());
    }

    //Set the icon and text.  If icon was null, say so.
    ImageIcon icon = images[selectedIndex];
    String pet = petStrings[selectedIndex];
    setIcon(icon);
    if (icon != null) {
        setText(pet);
        setFont(list.getFont());
    } else {
        setUhOhText(pet + " (no image available)",
                    list.getFont());
    }

    return this;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T22:05:07.203

您可以创建一个 ComboBoxEditor，其组件（由 getEditorComponent 返回）是 JTree

尽管您可能已经尝试过。

我不知道它会是什么样子。如果您使它起作用，请发布屏幕截图。:)

**编辑**

我给它一个快速肮脏的尝试。它很糟糕，但只是一个开始。

[替代文字 http://img120.imageshack.us/img120/2563/yiakxk2.png](http://img120.imageshack.us/img120/2563/yiakxk2.png)

这是代码，值得。:(

也许你应该开始考虑替代方案。当按下隐藏面板时，会出现一个没有边框的 JButton 假 Combo 并显示树。

```
import javax.swing.*;
import javax.swing.event.*;
import java.awt.*;
import java.awt.event.*;

public class ComboTree {
    public static void main( String [] args ) { 
        JComboBox c = new JComboBox( new String [] { "Hello", "there"});
        c.setModel( new CustomComboModel() );
        c.setEditor( new TreeComboEditor() );
        c.setRenderer( new TreeComboEditor() );
        JFrame frame = new JFrame();
        frame.add( c , BorderLayout.NORTH ) ;
        frame.pack();
        frame.setVisible( true );

    }
}

class CustomComboModel implements ComboBoxModel {
     public Object  getSelectedItem() { return ":P"; }
     public void    setSelectedItem(Object anItem) {}
     public void    addListDataListener(ListDataListener l) {}
     public Object  getElementAt(int index)  { return "at " + index ; }
     public int getSize()  { return 2; }
     public void    removeListDataListener(ListDataListener l)  {}
}
class TreeComboEditor implements ComboBoxEditor, ListCellRenderer {

     // Editor interface
     public void addActionListener(ActionListener l) {}
     public Component   getEditorComponent() {
         return new JTree() ;
         }
     public Object  getItem() { return "";}
     public void    removeActionListener(ActionListener l) {}
     public void    selectAll() {}
     public void    setItem(Object anObject) {}

     // Render interface
     public Component getListCellRendererComponent(JList list,
                                           Object value,
                                           int index,
                                           boolean isSelected,
                                           boolean cellHasFocus) {
        return new JTree();
    }
} 
```

# javascript - 使用正则表达式在javascript中用另一个单词替换一个单词零次或多次

> ID：357740
> 
> 赞同：2
> 
> 时间：2008-12-10T21:49:53.727
> 
> 标签：javascript, regex, replace

我有一个词 : `[lesserthen]`，我需要`<`在一个字符串中用零次或多次替换。我正在使用该`String.replace`方法来做到这一点。但是这个词在字符串中只被替换了一次，我需要被替换不止一次。我对正则表达式很弱，我有兴趣找到解决这个问题的方法。

这是我一直在使用的代码：

```
var wordReplaced="This a text with one [lesserthen], and another [lesserthen]";
wordReplaced=wordReplaced.replace("[lesserthen]","<"): 
```

我的目标是：

> 这是一个带有一个 < 和另一个 < 的文本

但我得到的是：

> 这是一个带有一个 < 和另一个 [lesserthen] 的文本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T21:58:17.220

尝试在替换中使用实际的正则表达式（带有“g”选项）而不是搜索字符串，例如：

```
wordReplaced = wordReplaced.replace(/\[lesserthen\]/g,"<"); 
```

# jquery - getJSON 调用适用于 IE 7 但不适用于 Firefox 3

> ID：357752
> 
> 赞同：4
> 
> 时间：2008-12-10T21:53:43.483
> 
> 标签：jquery, ajax, json, firefox, rest

我有一个使用当前版本的 JQuery 的 Web 应用程序，它需要从 REST Web 服务中获取一些 JSON 对象。我正在使用以下对 $.getJSON 的调用：

$.getJSON(" [http://localhost:17245/Service.svc/?format=json](http://localhost:17245/Service.svc/?format=json) ", function(data) {alert(data.id);});

此调用在 IE7 中运行良好，我可以在 Fiddler 中毫无问题地调用该服务。我已经在 Firebug 中逐步完成了这个，但是当 Firefox 到达这一行时，javascript 执行似乎“死”了，没有错误，没有回调，没有任何东西。

我也使用过 $.ajax 并且有同样的问题；在 IE 中运行良好，在 Firefox 中没有。

有人有想法么？我对 JQuery 很陌生，所以请温柔一点。

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T22:01:00.100

我有一个类似的问题。签名 $.getJSON 是 (url, data, callback) 我也没有传递 data 参数。试试这个：

```
$.getJSON("http://localhost:17245/Service.svc/?format=json", {}, function(data) {alert(data.id);}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-20T20:37:34.523

不确定它是否已经解决，但它看起来像是 Firefox 中的跨站点脚本限制。它将开发 ASP.NET 服务器 (localhost:0000) 上的端口号视为不同的域。尝试在不使用端口号的 IIS 上同时托管服务和 Web 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T04:00:12.480

在我找到[ajaxdotnet](http://blog.dogma.co.uk/search/label/ajaxdotnet "ajaxdotnet")插件之前，我在使用 jQuery 的 Web 服务时遇到了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T14:11:20.950

确保您正在处理[ajaxError](http://docs.jquery.com/Ajax/ajaxError)，否则如果服务器返回错误，您将永远看不到回复。

正如palehorse 所说，您对getJSON 的调用似乎缺少数据参数。当我不需要它时，我通常会为此传递 null 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T22:55:47.173

如果您无法让 JQuery 工作，请尝试[Fork](http://forkjavascript.org/)。看看 Fork.Ajax 和 Fork.Json。或者使用 Doug Crockford 的[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)来解析 JSON，使用你喜欢的任何 XMLHttpRequest 包装器。不久前，我环顾了各种 Javascript 库，大多数情况下它们对我来说太臃肿和奇怪了。你必须学习图书馆的所有小怪癖。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T05:49:21.397

我刚刚遇到了这个问题，发现根本原因是返回的 JSON 中的尾随逗号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T06:10:59.993

由于 Firebug 扩展中的错误，我看到了类似的问题。如果您安装了它，请尝试禁用它。

# ruby - 我可以用“**”glob 遍历 Ruby 中的符号链接目录吗？

> ID：357754
> 
> 赞同：21
> 
> 时间：2008-12-10T21:55:44.197
> 
> 标签：ruby, symlink

在 Ruby 中，`Dir.glob("**/*.rb")`（例如）不遍历符号链接目录。是否有可能获得`**`遍历符号链接？

我正在使用两个以这种方式查找文件的 gem，但我需要它们查看符号链接目录中的文件。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-04-27T18:48:18.100

乔纳森聪明而狡猾的方法非常棒，只需轻弹几个星号就可以削减成群的符号链接，muahaha。但是，它具有不返回直接子匹配项的不幸副作用。改进的版本可能是：

```
Dir.glob("**{,/*/**}/*.rb") 
```

哪个（在我的测试中）会遵循一个符号链接并返回直接的孩子。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-10T22:15:33.160

由于存在无限循环的风险，通常不使用递归搜索。

但是，[这个讨论可能会有所帮助](http://groups.google.com/group/ruby-talk-google/browse_thread/thread/e319f62f55cdea31?pli=1)：

> `Dir.glob("**/*/**/b")`将遵循一个符号链接最多一次。

# c# - 管理多个解决方案的共享二进制依赖项

> ID：357766
> 
> 赞同：0
> 
> 时间：2008-12-10T22:00:50.240
> 
> 标签：c#, winforms, dependencies

好的，我们有很多解决方案，都有很多共享的二进制文件：

我们要做的是以下。

在共享驱动器中，我们有以下布局，其中每个二进制依赖项都有一个目录，每个版本都有一个子目录

BinaryDep1
-----------易失性
-----------1.0
-----------1.1
-----------1.2

BinaryDep3
-----------易失性
-----------1.0
-----------1.1
-----------2.2

BinaryDep3
-----------易失性
-----------1.0
-----------1.1
-----------1.2

在我们的解决方案中，我们有一个 XML 文件，其中列出了所有依赖项和版本。我们有一个脚本，然后会转到共享驱动器并将依赖项下载到名为 /ext 的解决方案的子文件夹中

这工作得很好，但有一些我们正在寻求改进的缺陷，我想得到人们的反馈。

1.  我们有很多解决方案，所以如果它们都依赖于相同版本的二进制依赖项，那么我们每个解决方案都会得到一个副本（因为它应该是自包含的）。因此，如果我有 5 个都依赖于 Syncfusion 的解决方案，我会在我的桌面上获得 5 个 syncfusion 副本。这里的两个问题是 1) 下载时间慢（比我需要的多 5 倍）并占用大量磁盘空间。

我们喜欢每个解决方案都有一个带有 /ext 的本地子目录的模型，因此我们永远不必更改项目引用，但这些似乎是相互竞争的力量。

关于如何规范下载的任何想法，因此我们无需下载 5 倍的数据和相同的磁盘大小，而无需手动更新项目引用，我必须在每次版本升级时更改 VS 中的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-28T22:38:17.693

所有开发人员机器中的相同结构怎么样？

像：

d:/projects
d:/projects/ext（这里需要的共享库）
d:/projects/project1
d:/projects/project2
d:/projects/project3 d:/projects/
project4
...

ps：我喜欢约定俗成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-22T15:21:20.003

您可能想看看[DEVPATH](http://msdn.microsoft.com/en-us/library/cskzh7h6.aspx)。

其他 StackOverflow 参考：[支持 DEVPATH](https://stackoverflow.com/questions/1186892/support-for-devpath)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T08:32:44.877

有什么[理由](http://en.wikipedia.org/wiki/Global_Assembly_Cache#Pitfalls)不将共享程序集放入[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz.aspx)吗？

# asp.net - 如何在不删除目标文件夹内容的情况下使用 Visual Studio 2008 中的“发布”功能？

> ID：357769
> 
> 赞同：11
> 
> 时间：2008-12-10T22:02:31.220
> 
> 标签：asp.net, visual-studio, visual-studio-2008, build-process, publish

当我在 Visual Studio 2008 中使用 Build->Publish Web Site 时，大多数时候它会编译站点，然后简单地问我“目标文件夹中的所有文件都将被删除。继续吗？” （或类似的东西）。但是，有时，在 Visual Studio 中发布项目时，我会看到一个对话框，让我可以选择完全替换文件夹的内容，或者只是用更新的版本替换更改的文件。

我更喜欢在不完全删除文件夹的情况下发布，因为部署的应用程序会在使用时创建用户文件和缓存文件，我不想采取额外的步骤来保存。但是，我不确定为什么 Visual Studio 并不总是给我这个选项。这是我可以更改的设置吗？它是否与我正在使用的 .NET 版本相关联？

任何见解表示赞赏！

**编辑 - 2009-01-20 的后续行动**

我还没有弄清楚这一点，但这里有更多信息。

这是我的 Win XP 桌面上的一个 ASP.NET 项目的发布功能的样子：

![](https://i.stack.imgur.com/QegqZ.gif)

这是我的 Vista 笔记本电脑上不同项目的样子：

![](https://i.stack.imgur.com/gbcZh.gif)

请注意第二个屏幕截图中的单选按钮，允许我选择在发布之前删除文件夹的内容，或者仅覆盖匹配的文件。我希望每个项目都有这些选项。

两台计算机都运行 Visual Studio 2008 Professional（版本 9.0.30729.1 SP，根据 Help->About）。完全相同的版本。而且我怀疑操作系统差异导致了此功能更改。这一定是某个地方的设置，对吧？有人知道吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T23:21:18.333

**John 是对**的，唯一的区别是您的项目之一是[网站项目](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx)，而另一个是[Web 应用程序项目](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)。除非您在*Web 应用程序项目*中，否则您不会看到“**转换为 Web 应用程序**”选项。我知道……这是非常具有误导性的。这背后的原因源于您[转换为 Web 应用程序项目](http://webproject.scottgu.com/CSharp/Migration2/Migration2.aspx)的方式。如果您打算转换它（这可能是一个真正的痛苦，取决于它的设置方式），那么您需要注意一些差异：

 *在*Web 应用程序项目*中，所有内容都经过预编译，所有代码隐藏页面都将编译为 .dll ---- 在*网站项目* 中，项目中没有任何内容是预编译的，编译器将编译所有内容以确保其有效但没有任何已编译的页面被上传。当用户第一次尝试访问该站点时，每个页面都会被编译成自己的 dll。这意味着在*网站项目*中，您可以上传单个代码隐藏文件。

命名空间 - 在*Web 应用程序项目*中，默认情况下会在*网站项目*中创建命名空间，但它们不是。因此，如果您打算转换它们，您可能需要花一些时间来添加它们。

项目文件 - 您会注意到*网站项目*没有*Web 应用程序项目*所具有的“cproj”文件。

我已经转换了其中一些项目，只要“app_code”文件夹中没有很多代码，我发现它们运行得相当顺利。您可以尝试一下，看看它是多么容易，如果看起来会很痛苦，我建议[FileZilla](http://filezilla-project.org/)只需 FTP 就可以了，免得您头疼。

祝你好运

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T15:55:49.827

对于网站项目和 Web 应用程序项目，该对话框是不同的。在我的 MVC 项目（Web 应用程序项目）中，我看到了其他选项。在我的常规网站项目中，我看到发布的第一个对话框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-12T22:05:54.397

不确定此选项是否适合您，但您可以使用解决方案资源管理器中的复制网站功能。单击解决方案资源管理器顶部的“复制网站”图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T22:19:05.087

我认为您问题的真正答案是您应该将用户文件和缓存文件放在其他地方。

发布网站时，Visual Studio 旨在确保目标文件夹包含您的网站文件，并且绝对没有其他内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T11:54:15.673

显然，此功能将在 VS2010 中推出 - 这就是 Vishal Joshi 在 TechEd EMEA 会议“PDC307：Microsoft Visual Studio 10：Web 开发未来”中宣布的内容

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-06-10T10:13:46.393

**该站点已从更新图层中的站点更新。**

# iphone - 仿射变换与关键帧

> ID：357775
> 
> 赞同：2
> 
> 时间：2008-12-10T22:04:41.980
> 
> 标签：iphone, cocoa-touch, core-animation, core-graphics

对于图形专家（我不是）来说，这可能是一个愚蠢的问题，但是仿射变换和关键帧之间有什么区别？我在 iPhone 食谱中读到了前者，她说“仿射变换使您能够通过将对象从一个视图坐标系映射到另一个视图坐标系来更改对象的几何形状”。这让我想起了我玩 Adob​​e After Effects 的时候，你会设置开始、“中间”和结束位置，并且会得到一个漂亮的视觉动画。他们称之为关键帧。那么这个和仿射变换有什么区别。它是 2D 与 3D 的东西吗？谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T22:22:30.227

本机仿射变换中没有动画的概念。当它说“改变对象的几何形状”时，它并不意味着动画。仿射变换仅仅是关于如何在引擎盖下执行平移、旋转和缩放的数学基础。一种思考方式是，它们主要用于将*相对*坐标系映射到其他坐标系。

例如，如果您有一个 100 像素宽 x 30 像素高的面板，在 (10, 10) 处有一个单选按钮，在 (80, 10) 处有一个复选框。然后将此面板放置在屏幕上的 (40, 15) 处并放大 50%，使其现在为 50 像素宽 x 15 像素高，然后有一个仿射变换将单选按钮从 (10, 10) 映射相对于面板，到屏幕上的 (45, 20)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-10T22:21:40.260

仿射变换是从一个坐标系到另一个坐标系的线性映射。如果我有一个仿射变换 X，我可以取一个正方形“s”并且 X(s) 可以返回某种类型的平行四边形。没有时间的概念，只是空间到不同空间的映射。

关键帧是空间/时间上的固定状态。因此，您可以说，取您的 square 并在 3 秒时执行变换 X，在 6 秒时执行另一个变换 Y，然后在它们之间进行插值。请注意，关键帧不需要仿射变换——您可以将关键帧存储为非线性变换，甚至是非矩阵变换（例如视频游戏中的角色动画）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T22:21:59.400

仿射变换是一个线性变换，然后是一个平移。例子是：

*   向左旋转 45 度然后向上移动 10 个像素
*   放大 2 倍，然后向右移动 10 个像素。
*   旋转 95 度。

它们比关键帧等简单得多。

# python - 对 Python 代码使用 Vim 折叠的推荐方法是什么

> ID：357785
> 
> 赞同：122
> 
> 时间：2008-12-10T22:10:45.587
> 
> 标签：python, vim, folding

我有兴趣在 Vim 中为 Python 代码启用代码折叠。我注意到有多种方法可以做到这一点。

有没有人有首选的方式在 Vim 中进行 Python 代码折叠？IE，

*   你有什么特别喜欢的 Vim 插件吗？
*   您使用手动折叠还是在评论中放置标记？
*   在 Vim 中为 Python 进行代码折叠的任何其他推荐方法？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-12-11T19:47:43.767

就我个人而言，我无法说服自己用标记乱扔我的代码。我已经非常习惯（并且高效）使用缩进折叠。连同我将空格键（见下文）映射到打开/关闭折叠以及 zR 和 zM 命令，我就在家里。非常适合 Python！

```
set foldmethod=indent
nnoremap <space> za
vnoremap <space> zf 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-12-12T00:32:01.930

我[将此](http://www.vim.org/scripts/script.php?script_id=2462 "这")语法文件用于 Python。它将折叠方法设置为语法并折叠所有类和函数，但仅此而已。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-26T13:51:00.467

另一个用于折叠 Python 代码的插件。相当简单，处理文档字符串，在 GitHub 上：

[简单折叠](https://github.com/tmhedberg/SimpylFold)

享受！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-10T22:26:19.487

Python 非常适合折叠缩进，有点用于编写我自己的代码我使用标记，因为它们可以按照您想要的方式压缩文档，并且可以用作一种目录。当我查看别人的代码时，我的 vimrc 中有这个可以在两者之间切换。

```
#Toggle fold methods \fo
let g:FoldMethod = 0
map <leader>fo :call ToggleFold()<cr>
fun! ToggleFold()
    if g:FoldMethod == 0
        exe 'set foldmethod=indent'
        let g:FoldMethod = 1
    else
        exe 'set foldmethod=marker'
        let g:FoldMethod = 0
    endif
endfun
#Add markers (trigger on class Foo line)
nnoremap ,f2 ^wywO#<c-r>0 {{{2<esc>
nnoremap ,f3 ^wywO#<c-r>0 {{{3<esc> 
nnoremap ,f4 ^wywO#<c-r>0 {{{4<esc>
nnoremap ,f1 ^wywO#<c-r>0 {{{1<esc> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-10T22:29:04.240

我真的很喜欢这个[`python_ifold`插件](http://www.vim.org/scripts/script.php?script_id=2002)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-12-08T18:32:36.403

我认为缩进折叠对 python 来说很好。我正在为 vim-config python/django IDE 的想法制作一个多分支的 git 存储库。叉开！

[http://github.com/skyl/vim-config-python-ide](http://github.com/skyl/vim-config-python-ide)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-11T07:23:05.643

试试这个插件：

[http://vim.sourceforge.net/scripts/script.php?script_id=515](http://vim.sourceforge.net/scripts/script.php?script_id=515)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-01-03T03:46:37.597

在你的`.vimrc`：

```
set foldmethod=indent
set shiftwidth=4 
```

然后`zM`屏蔽所有`zR`以扩展所有。我还补充说：

```
nnoremap <space> za
vnoremap <space> zf
map z1  :set foldlevel=0<CR><Esc>
map z2  :set foldlevel=1<CR><Esc>
map z3  :set foldlevel=2<CR><Esc>
map z4  :set foldlevel=3<CR><Esc>
map z5  :set foldlevel=4<CR><Esc>
map z6  :set foldlevel=5<CR><Esc>
map z7  :set foldlevel=6<CR><Esc>
map z8  :set foldlevel=7<CR><Esc>
map z9  :set foldlevel=8<CR><Esc> 
```

所以你可以一点一点地取消缩进`z1`。`z2`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-01-14T11:09:43.493

对我来说，理想的折叠是只折叠`class`and`def`块，缩进折叠对我来说太过分了。我认为一种优雅的解决方案是使用 Tomas 提到的语法[系统](http://www.vim.org/scripts/script.php?script_id=2462)。然而，这个是为了替换原来的语法文件，它可能会比原来的更旧（即该脚本没有提到 Python 3 语法）。

我的解决方案是在`~/.vim/syntax`文件夹中放置一个仅以重要行命名的文件`python.vim`（取自上述脚本）：

```
syn match   pythonDefStatement  /^\s*\%(def\|class\)/
       \ nextgroup=pythonFunction skipwhite
syn region  pythonFunctionFold  start="^\z(\s*\)\%(def\|class\)\>"
       \ end="\ze\%(\s*\n\)\+\%(\z1\s\)\@!." fold transparent

hi link pythonDefStatement Statement 
```

然后简单地用 激活折叠`:set foldmethod=syntax`。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-06T23:24:48.980

Python 源代码带有一个 vim 语法插件以及一个自定义 vimrc 文件。查看[vim 上的 python 常见问题解答](http://web.archive.org/web/20101128033925/http://python.org/dev/faq/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-06-18T14:55:51.147

我真的很喜欢我为 .vimrc 编写的这个小 vim 脚本。它映射`alt+1`到折叠第一个 python 缩进级别（类定义和函数），`alt+2`折叠第二级（类方法），并`alt+0`展开所有内容。它确保它只折叠一个级别并且不折叠任何嵌套的子级别。您仍然可以使用`za`来切换当前块的折叠。请注意，在 中`^[0`，这`^[`是`alt`我的终端。对vim脚本没有太多经验，所以请随意对功能提出建议:)

```
" Python folding
nnoremap ^[0 zR<CR>
nnoremap ^[1 :call Fold(0)<CR>
nnoremap ^[2 :call Fold(1)<CR>
function Fold(level)
    :let b:max = a:level + 1
    :set foldmethod=indent
    :execute 'set foldnestmax='.b:max
    :execute 'set foldlevel='.a:level
endfunction 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-31T15:43:37.213

根据[@Genma 的回答，](https://stackoverflow.com/a/21112061/10247460)我将以下语法规则粘合在一起，只需将其添加为`.vim/after/syntax/python.vim`

```
syn keyword pythonStatement class def
syn match pythonFunction "\h\w*" containedin=pythonFold
syn region  pythonFold  fold transparent
      \ start = "\(^\z(\s*\)\v%(def|class|if|elif|else|for|while|try|except|finally|with)>)@<="
      \ end   = "\v\ze%(\s*\n)+%(\z1\s)@!."

syn region pythonCurlyBrace start="{" end="}" fold transparent
syn region pythonSquareBrace start="\[" end="\]" fold transparent 
```

# c# - 文本框的 C# 舍入值

> ID：357790
> 
> 赞同：2
> 
> 时间：2008-12-10T22:12:59.747
> 
> 标签：c#, rounding

我有一个用 C# (Sharp Develop) 创建的小型计算器。用户输入两个值，代码返回第三个。一旦返回第三个值，我无法四舍五入。我已经浏览了几个论坛和 msdn 站点，并且我了解那里发布的代码，但我似乎无法让它在我的情况下工作。谁能提供一点帮助？参考下面的代码。

```
int y; 
decimal x, z;
x = int.Parse(tb2_fla.Text);      
y = int.Parse(tb2_e.Text);
z = (x * y * 1.732050808m) / 1000;  
tb2_kva.Text = z.ToString(); 
```

我欢迎帮助和批评
格雷格

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-10T22:17:28.397

Use [Math.Round](http://msdn.microsoft.com/en-us/library/system.math.round.aspx). Or, since you're going into a string, you could use either the [Standard Numeric Format Strings](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx), or the [Custom ones](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx).

```
Math.Round(z, 2).ToString();
z.ToString("0.00"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T22:15:49.007

Math.Round(z, nrofdecimals) 可以解决您的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T22:15:57.667

试试 Math.Round 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T22:16:05.763

尝试使用 Math.Round()

```
tb2_kva.Text = Math.Round(z, # Places).ToString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T22:17:14.387

在帮助中查找[数字格式说明符](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)。就像是：

```
tb2_kva.Text = String.Format("{0:d2}", z); 
```

格式化为 2dp

# visual-studio-2008 - 带有 WiX、Inno Setup 和 VS2008 的自动构建版本号

> ID：357803
> 
> 赞同：16
> 
> 时间：2008-12-10T22:16:30.567
> 
> 标签：visual-studio-2008, wix, build-automation, inno-setup

基本上我需要的是一种自动化的方式来更新 WiX 中的产品版本号（带有 Votive 等的 3.0），然后将该版本号放入 Inno Setup“引导程序”中

我几乎让这个过程大部分是自动化的，但是版本号仍然需要手动更新，这显然不理想，但我找不到如何在编译时将值传递给 Inno Setup（以及如何引用它们），在 WiX 项目中，我需要知道如何在 Visual Studio 2008 的同一解决方案中引用不同项目的版本号

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-11T08:58:33.517

无需通过任何东西！您可以简单地让 InnoSetup 预处理器直接从二进制文件的版本资源中读取版本信息，例如：

```
#define AppName "My App"
#define SrcApp "MyApp.exe"
#define FileVerStr GetFileVersion(SrcApp)
#define StripBuild(str VerStr) Copy(VerStr, 1, RPos(".", VerStr)-1)
#define AppVerStr StripBuild(FileVerStr)

[Setup]
AppName={#AppName}
AppVersion={#AppVerStr}
AppVerName={#AppName} {#AppVerStr}
UninstallDisplayName={#AppName} {#AppVerStr}
VersionInfoVersion={#FileVerStr}
VersionInfoTextVersion={#AppVerStr}
OutputBaseFilename=MyApp-{#FileVerStr}-setup 
```

在版本 5.4.1 (2011-02-09) 之前，ISPP 不包含在默认的 InnoSetup 包中。您必须下载 InnoSetup 快速启动包：[http](http://www.jrsoftware.org/isdl.php#qsp) ://www.jrsoftware.org/isdl.php#qsp（感谢@Gwyn，更新）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T18:51:11.353

您可以从包中的文件版本中获取适用于 WiX 的 ProductVersion。语法类似于：

```
<Product Version="$(var.FileVersion.FileId)"> 
```

或者，您可以在命令行上使用“-dVersionFromCommandLine=1.0.0.0”开关将其提供给蜡烛，语法​​如下：

```
<Product Version="$(var.VersionFromCommandLine)"> 
```

两者都适用于最新版本的 WiX v3。只有后者适用于 WiX v2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T22:23:15.203

我这样做的方法是使用 WSF 脚本（我使用 JavaScript，但您可以使用 VBScript 甚至使用 Cygwin 的 SH 脚本）创建一个包含版本号定义的头文件。您可以使用 Wix`<include>`语句将版本号拖入。

对于 Inno Setup，我创建了一个包含版本号的 .iss 文件，该版本号 #included 到主 iss 脚本中。

我在家，但如果你愿意，明天可以发布一些示例代码。

编辑：我忘了提到我在各种 VS 项目的预构建阶段运行生成包含内部版本号的文件的脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T08:06:17.990

承诺的一些示例代码。这应该足以让你开始。

以下 JavaScript 可用于创建包含版本号的 InnoSetup iss 文件。实际文件将如下所示：

```
VersionInfoVersion=1.2.3.12345
AppVerName=My App v1.2.3.12345 
```

主 Inno Setup 脚本将通过在**[Setup]**部分的末尾添加以下内容来包含此文件：

```
[Setup]
AppId={{...}}
...

#include "version.iss" 
```

这是 JavaScript（这将被保存为单独的文件 - 例如 version.js）：

```
createInnoSetupIncludeFile("My App", 1, 2, 3, 12345, "version.iss");

function createInnoSetupIncludeFile(appName, verMajor, verMinor, verSubMinor, buildNumber, headerFileName)
{
    var versionString = verMajor + "." + verMinor + "." + verSubMinor + "." + buildNumber;
    var fileSystemObject = WScript.CreateObject("Scripting.FileSystemObject");
    var fileObject = fileSystemObject.CreateTextFile(headerFileName, true);
    fileObject.WriteLine("VersionInfoVersion=" + versionString);
    fileObject.WriteLine("AppVerName=" + appName + " v" + versionString);
    fileObject.Close();
    fileObject = null;
    fileSystemObject = null;
} 
```

您可以调整此脚本以在不同的文件夹中创建 version.iss 文件。

最后，您需要执行 JavaScript - 最好的位置是在您的 Visual Studio 项目的 Pre-Build Event 中。添加以下内容：

```
cscript version.js //NoLogo 
```

您需要更改它以构建与 Wix 兼容的包含文件。我曾经这样做过，但为了支持 Inno Setup 而放弃了 Wix，所以我手头没有这个代码。不过，Wix 脚本有一个机制，因此应该为您指明正确的方向 - 概念是相同的 - 生成一个定义版本号的文本文件，然后包含它。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T23:03:14.093

我在 inno setup 部分找到了这个，看起来它可以工作：

[http://agiletracksoftware.com/blog.html?id=4](http://agiletracksoftware.com/blog.html?id=4)

# c# - 字符串替换转义字符

> ID：357804
> 
> 赞同：9
> 
> 时间：2008-12-10T22:17:08.287
> 
> 标签：c#, string, resx

今天发现把字符串放到资源文件里会被当成文字处理，即把“Text for first line \n Text for second line”会导致转义字符本身被转义，所以存储的是“第一行的文本 \n 第二行的文本” - 然后这些出现在显示屏中，而不是我的回车和制表符

所以我想做的是使用 string.replace`\\`变成`\`- 这似乎不起作用。

```
s.替换（“\\\\”，“\\”）;
```

根本不更改字符串，因为字符串认为只有 1 个反斜杠

```
s.Replace("\\", "");
```

替换所有双引号，只留下 n 而不是 \n

此外，使用`@`和一半的`\`字符或`Regex.Replace`方法给出相同的结果

有谁知道在不逐个字符循环的情况下做到这一点的好方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T22:20:50.793

由于`\n`实际上是单个字符，因此您无法通过简单地替换字符串中的反斜杠来实现这​​一点。您需要`\`用转义字符替换每一对和以下字符，例如：

```
s.Replace("\\n", "\n");
s.Replace("\\t", "\t");
etc 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-10T22:31:44.437

最好自己调整 resx 文件。可以通过两种机制输入换行符：您可以将 resx 文件编辑为 XML（在解决方案资源管理器中右键单击，选择“打开为”并选择 XML），或者您可以在设计器中进行。

如果您在 XML 中执行此操作，只需按 Enter，退格到您创建的换行符的开头，就完成了。您也可以使用搜索和替换来做到这一点，尽管它会很棘手。

如果您使用 GUI resx 编辑器，按住 SHIFT 的同时按 ENTER 会给您一个换行符。

你可以做运行时替换的事情，但正如你所发现的那样，开始起来很棘手——在我看来，这构成了一种代码味道。（您也可以提出性能参数，但这取决于调用字符串资源的频率以及您的应用程序的一般规模。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T23:03:15.963

我实际上是使用 John 的解决方案并直接编辑 XML，因为这是该项目的更好解决方案，但 codelogic 回答了让我发疯的问题。

# python - 关于python的变量作用域的一个小问题

> ID：357810
> 
> 赞同：1
> 
> 时间：2008-12-10T22:20:07.127
> 
> 标签：python, variables, scope

我是python的初学者，有一个问题，让我很困惑。如果我先定义一个函数但在函数内我必须使用在下面另一个函数中定义的变量，我可以这样做吗？或者如何将另一个函数的返回内容导入到函数中？例如：

```
def hello(x,y):
    good=hi(iy,ix)
    "then do somethings,and use the parameter'good'."
    return something

def hi(iy,ix):
    "code"
    return good 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T22:36:30.167

功能`hello`和范围`hi`是完全不同的。它们没有任何共同的变量。

请注意，调用的结果`hi(x,y)`是某个对象。`good`您使用函数中的名称保存该对象`hello`。

`good`in中命名的变量是不同的变量，与函数中`hello`命名的变量无关。`good``hi`

它们拼写相同，但存在于不同的命名空间中。为了证明这一点，在两个函数之一中更改`good`变量的拼写，你会发现事情仍然有效。

* * *

编辑。追问：“那如果我想在`hi`函数中使用`hello`函数的结果怎么办？”

没有什么不寻常的。`hello`仔细看。

```
def hello(x,y):
    fordf150 = hi(y,x)
    "then do somethings,and use the variable 'fordf150'."
    return something

def hi( ix, iy ):
    "compute some value, good."
    return good 
```

一些脚本评估`hello( 2, 3)`.

1.  Python 创建一个新的命名空间来评估`hello`.

2.  在`hello`,`x`被绑定到对象`2`上。绑定完成位置顺序。

3.  在`hello`,`y`被绑定到对象`3`上。

4.  在`hello`中，Python 计算第一条语句 ，`fordf150 = hi( y, x )`是`y`3，`x`是 2。

    一种。Python 创建一个新的命名空间来评估`hi`.

    湾。在`hi`,`ix`被绑定到对象`3`上。绑定完成位置顺序。

    C。在`hi`,`iy`被绑定到对象`2`上。

    d。在`hi`中，某事发生并`good`绑定到某个对象，例如`3.1415926`。

    e. 在`hi`中，a`return`被执行；将对象标识为 的值`hi`。在这种情况下，对象被命名为`good`并且是对象 `3.1415926`。

    F。命名空间被`hi`丢弃。 `good`，`ix`然后`iy`消失。然而，对象 ( `3.1415926`) 仍然是评估的值`hi`。

5.  在`hello`中，Python 完成了第一条语句，`fordf150 = hi( y, x )`，`y`是 3，`x`是 2。 的值`hi`是 `3.1415926`。

    一种。 `fordf150`绑定到通过求值创建的对象`hi`, `3.1415926`。

6.  在`hello`中，Python 继续执行其他语句。

7.  在某些时候`something`绑定到一个对象，比如说，`2.718281828459045`。

8.  在`hello`中，a`return`被执行；将对象标识为 的值`hello`。在这种情况下，对象被命名为`something`并且是对象 `2.718281828459045`。

9.  命名空间被丢弃。 `fordf150`和`something`消失，`x`和一样`y`。然而，对象 ( `2.718281828459045`) 仍然是评估的值`hello`。

无论调用什么程序或脚本`hello`都会得到答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T23:35:45.557

如果你想从一个函数内部定义一个变量到全局命名空间，从而让这个空间中的其他函数可以访问它，你可以使用 global 关键字。这里有一些例子

```
varA = 5   #A normal declaration of an integer in the main "global" namespace

def funcA():
    print varA #This works, because the variable was defined in the global namespace
               #and functions have read access to this.
def changeA():
    varA = 2  #This however, defines a variable in the function's own namespace
              #Because of this, it's not accessible by other functions.
              #It has also replaced the global variable, though only inside this function
def newVar():
    global varB #By using the global keyword, you assign this variable to the global namespace
    varB = 5

def funcB():
    print varB #Making it accessible to other functions 
```

结论：在函数中定义的变量保留在函数的命名空间中。它仍然可以访问全局命名空间以进行只读，除非该变量已使用 global 关键字调用。

全球一词并不像乍看起来那样完全是全球性的。它实际上只是指向您正在处理的文件中最低名称空间的链接。全局关键字无法在另一个模块中访问。

作为一个温和的警告，一些人可能认为这不是“好的做法”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T22:35:55.287

您的示例程序有效，因为“好”的两个实例是不同的变量（您恰好有两个变量同名）。以下代码完全相同：

```
def hello(x,y):
    good=hi(iy,ix)
    "then do somethings,and use the parameter'good'."
    return something

def hi(iy,ix):
    "code"
    return great 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-10T23:54:34.987

关于 python 作用域规则的更多细节在这里：

[Python 范围规则的简短描述](https://stackoverflow.com/questions/291978/short-description-of-python-scoping-rules#292502)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T22:37:05.767

“hello”函数不介意您调用尚未定义的“hi”函数，前提是您在定义两个函数之前不要尝试实际使用“hello”函数。

# history - 记住艾伦凯的一句话

> ID：357813
> 
> 赞同：38
> 
> 时间：2008-12-10T22:20:53.227
> 
> 标签：history, quotes, innovation

几年前曾引用艾伦·凯的话说，在过去的 20 年里，软件中只有三个新事物（实际上是 PC 的生命周期）。其中之一是电子表格。

有人记得另外两个吗？

艾伦·凯是谁？（有些人可能会问。）他在 Xerox Parc 的工作可以说比其他任何影响都更能塑造我们当前的软件范式。

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2008-12-23T18:14:38.113

我会尽量记住我说的话，但到目前为止没有一个答案是正确的（每个答案都是在 80 年代 PC 商业化之前的 60 年代和 70 年代完成的）。

但是，我们可以从头开始，尝试思考[自 1980 年代以来计算领域的新发明](https://stackoverflow.com/q/432922/1288)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-05T01:45:43.707

每当我想到施乐公司时，我总是记得史蒂夫乔布斯的书呆子的胜利中的这句话：

> 他们真的向我展示了三件事，但我被第一件事蒙蔽了双眼，以至于我并没有真正“看到”另外两件事。他们向我展示的一件事是面向对象的编程。他们向我展示了这一点，但我什至没有“看到”这一点。他们向我展示的另一个实际上是一个联网的计算机系统。他们有 100 多台 Alto 计算机，全部联网，使用电子邮件等，等等。我什至没有“看到”这一点。他们向我展示的第一件事就是图形用户界面，我被蒙蔽了双眼。我认为这是我一生中见过的最好的东西。现在，请记住这是非常有缺陷的。我们看到的是不完整的。他们做错了很多事情，但我们当时并不知道。不过，这个想法的萌芽就在那里，而且他们做得很好。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-23T18:19:13.173

没有提到电子表格，但是这句话怎么样，来自 1991 年字节杂志的采访：

> “在 1968 年，我看到两三件事改变了我对计算的整个概念。……Doug Englebart 的观点 [是] 大型机就像一条铁路，由一个机构拥有，它决定你可以做什么以及什么时候可以做。Englebart试图像亨利福特一样。60 年代人们认为的个人电脑就像汽车。1968 年，我看到了 Symour Papert 的第一个孩子和 LOGO 的作品，我看到了第一个非常棒的手写字符识别系统在兰德……这对我产生了巨大的影响，因为它有一种亲密的感觉。当我把它和孩子们必须使用它的想法结合起来时，计算机的概念变得更像是一种超级媒介。更像是超级纸。 "

[来源](http://dc-mrg.english.ucsb.edu/conference/2002/documents/william_warner_kay-intro.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-05T13:40:27.117

也许这个链接导致论文

[](http://www.dwheeler.com/innovation/innovation.html)***David A. Wheeler 撰写*[**的最重要的软件创新**](http://www.dwheeler.com/innovation/innovation.html)**

 ***帮助你记住两个缺失的东西。

*PS：我个人会选择（1980及以后）：*

*   1982：计算机病毒
*   2004：MapReduce（2004 年，Google 的 Jeffrey Dean 和 Sanjay Ghemawat*揭示了*MapReduce）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-05T13:07:42.910

我很确定 C++ 不是这两件事之一。

请参阅[https://stackoverflow.com/questions/58640/great-programming-quotes#58810](https://stackoverflow.com/questions/58640/great-programming-quotes#58810)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-14T18:48:11.170

Alan Kay 发明了 Smalltalk。在这样做的过程中，可以说他发明了面向对象编程，尽管在这方面 Smalltalk 有重要的先驱。

Simula 是 1960 年代用于编写模拟的一种语言。另一种是 Planner，一种由麻省理工学院的 Carl Hewitt 发明的语言。Alan Kay 特别赞扬 Hewitt 在 Xerox PARC 时对他的影响。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-12-10T22:37:25.643

鼠标和图形用户界面

# regex - 什么时候最好使用正则表达式而不是基本的字符串拆分/子字符串？

> ID：357814
> 
> 赞同：22
> 
> 时间：2008-12-10T22:21:35.313
> 
> 标签：regex, parsing, string

似乎每当出现我需要字符串的一部分、有关所述字符串的信息等情况时，我都会定期选择使用字符串解析与正则表达式。

出现这种情况的原因是我们正在评估一个肥皂头的动作，**在**它通过 WCF 的 OperationContext 对象被解析为可管理的东西之后，*然后*对此做出决定。现在，简单的解决方案似乎是基本的子字符串化以保持实现简单，但我的一部分想知道 RegEx 是否会更好或更健壮。我的另一部分想知道在我们的特定场景中是否会像使用霰弹枪杀死苍蝇一样。

所以我不得不问，人们在尝试决定使用 RegEx 而不是典型的字符串解析时使用的典型阈值是什么。请注意，我在正则表达式方面不是很擅长，因此，我会尽量回避，除非避免引入比我需要的更多的复杂性是绝对重要的。

如果您无法通过我选择的缩写来判断，这是在 .NET 领域（C#）中，但我相信这与这个问题没有太大关系。

* * *

**编辑**：根据我典型的 Raybell 魅力，我的问题似乎过于冗长或误导。我想道歉。我提供了一些背景信息，以帮助提供有关我在做什么的线索，而不是误导人们。

我基本上是在寻找关于何时使用子字符串及其变体而不是正则表达式的指南，反之亦然。虽然有些答案可能错过了这一点（同样是我的错），但我真的很感激他们并相应地投票赞成。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-10T22:37:34.440

My main guideline is to use regular expressions for throwaway code, and for user-input validation. Or when I'm trying to find a specific pattern within a big glob of text. For most other purposes, I'll write a grammar and implement a simple parser.

One important guideline (that's really hard to sidestep, though I see people try all the time) is to always use a parser in cases where the target language's grammar is recursive.

For example, consider a tiny "expression language" for evaluating parenthetized arithmetic expressions. Examples of "programs" in this language would look like this:

```
1 + 2
5 * (10 - 6)
((1 + 1) / (2 + 2)) / 3 
```

A grammar is easy to write, and looks something like this:

```
DIGIT := ["0"-"9"]
NUMBER := (DIGIT)+
OPERATOR := ("+" | "-" | "*" | "/" )
EXPRESSION := (NUMBER | GROUP) (OPERATOR EXPRESSION)?
GROUP := "(" EXPRESSION ")" 
```

With that grammar, you can build a recursive descent parser in a jiffy.

An equivalent regular expression is *REALLY* hard to write, because regular expressions don't usually have very good support for recursion.

Another good example is JSON ingestion. I've seen people try to consume JSON with regular expressions, and it's INSANE. JSON objects are recursive, so they're just begging for regular grammars and recursive descent parsers.

* * *

Hmmmmmmm... Looking at other people's responses, I think I may have answered the wrong question.

I interpreted it as "when should use use a simple regex, rather than a full-blown parser?" whereas most people seem to have interpreted the question as "when should you roll your own clumsy ad-hoc character-by-character validation scheme, rather than using a regular expression?"

Given that interpretation, my answer is: never.

* * *

Okay.... one more edit.

I'll be a little more forgiving of the roll-your-own scheme. Just... don't call it "parsing" :o)

I think a good rule of thumb is that you should only use string-matching primitives if you can implement ALL of your logic using a single predicate. Like this:

```
if (str.equals("DooWahDiddy")) // No problemo.

if (str.contains("destroy the earth")) // Okay.

if (str.indexOf(";") < str.length / 2) // Not bad. 
```

Once your conditions contain multiple predicates, then you've started inventing your own ad hoc string validation language, and you should probably just man up and study some regular expressions.

```
if (str.startsWith("I") && str.endsWith("Widget") &&
    (!str.contains("Monkey") || !str.contains("Pox")))  // Madness. 
```

Regular expressions really aren't that hard to learn. Compared to a huuuuge full-featured language like C# with dozens of keywords, primitive types, and operators, and a standard library with thousands of classes, regular expressions are absolutely dirt simple. Most regex implementations support about a dozen or so operations (give or take).

Here's a great reference:

[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

PS: As a bonus, if you ever **do** want to learn about writing your own parsers (with lex/yacc, ANTLR, JavaCC, or other similar tools), learning regular expressions is a great preparation, because parser-generator tools use many of the same principles.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-10T22:27:30.840

正则表达式可以是

*   更容易理解
*   更清楚地表达意图
*   矮得多
*   更容易改变/适应

In some situations all of those advantages would be achieved by using a regex, in others only some are achieved (the regex is not really easy to understand for example) and in yet other situations the regex is harder to understand, obfuscates the intent, longer and hard to change.

The more of those (and possibly other) advantages I gain from the regex, the more likely I am to use them.

Possible rule of thumb: if understanding the regex would take minutes for someone who is somewhat familiar with regular expressions, then you don't want to use it (unless the "normal" code is even more convoluted ;-).

Hm ... still no simple rule-of-thumb, sorry.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-10T22:33:25.837

> [W]e're evaluating a soap header's action and making decisions on that

Never use regular expressions or basic string parsing to process XML. Every language in common usage right now has perfectly good XML support. XML is a deceptively complex standard and it's unlikely your code will be correct in the sense that it will properly parse all well-formed XML input, and even it if does, you're wasting your time because (as just mentioned) every language in common usage has XML support. It is unprofessional to use regular expressions to parse XML.

To answer your question, in general the usage of regular expressions should be minimized as they're not very readable. Oftentimes you can combine string parsing and regular expressions (perhaps in a loop) to create a much simpler solution than regular expressions alone.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-10T22:46:42.440

I would agree with what benjismith said, but want to elaborate just a bit. For very simple syntaxes, basic string parsing can work well, but so can regexes. I wouldn't call them overkill. If it works, it works - go with what you find simplest. And for moderate to intermediate string parsing, a regex is usually the way to go.

As soon as you start finding yourself needing to define a grammar however, i.e. complex string parsing, get back to using some sort of finite state machine or the likes as quickly as you can. Regexes simply don't scale well, to use the term loosely. They get complex, hard to interpret, and even incapable.

I've seen at least one project where the use of regexes kept growing and growing and soon they had trouble inserting new functionality. When it finally came time to do a new major release, they dumped all the regexes and went the route of a grammar parser.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-10T22:28:46.097

When your required transformation isn't basic -- but is still conceptually simple.

no reason to pull out Regex if you're doing a straight string replacement, for example... its easier to just use the string.Replace

on the other hand, a complex rule with many conditionals or special cases that would take more than 50 characters of regex can be a nightmare to maintain later on if you don't explicitly write it out

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T22:32:55.777

I would always use a regex unless it's something *very* simple such as splitting a comma-separated string. If I think there's a chance the strings might one day get more complicated, I'll probably start with a regex.

I don't subscribe to the view that regexes are hard or complicated. It's one tool that every developer should learn and learn well. They have a myriad of uses, and once learned, this is exactly the sort of thing you never have to worry about ever again.

Regexes are rarely overkill - if the match is simple, so is the regex.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T22:55:14.403

I would think the easiest way to know when to use regular expressions and when not to, is when your string search requires an IF/THEN statement or anything resembling this or that logic, then you need something better than a simple string comparison which is where regex shines.

# flv - 全屏后菜单缩进

> ID：357819
> 
> 赞同：3
> 
> 时间：2008-12-10T22:22:40.600
> 
> 标签：flv, flash, flvplayback, jwplayer

使用 JW 播放器，通过 rtmp 流式传输 flv。我也在使用 snell.swf 皮肤。当我单击全屏时，然后恢复正常，我看到了当前播放项目缩进的菜单。任何想法是什么原因造成的？

有时还会看到突出显示的不是当前播放的菜单项。这里也有什么想法吗？

# vba - 自动生成问题处理

> ID：357822
> 
> 赞同：19
> 
> 时间：2008-12-10T22:24:51.953
> 
> 标签：vba, ms-access, error-handling

这更像是一个观察而不是一个真正的问题：MS-Access（和一般的 VBA）非常缺少一个可以自动生成错误处理代码以及在发生错误时可以显示行号的工具。你找到解决办法了吗？它是什么？我才意识到自从几年前我找到了这个基本问题的正确答案以来，我节省了多少数百小时，我想看看你对这个非常重要的问题有什么想法和解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-10T22:47:05.340

如果使用“Erl”，它将显示错误之前的最后一个标签（例如，10、20 或 30）？

```
Private Sub mySUB()
On Error GoTo Err_mySUB
10:
    Dim stDocName As String
    Dim stLinkCriteria As String
20:
    stDocName = "MyDoc"
30:
    DoCmd.openform stDocName, acFormDS, , stLinkCriteria    
Exit_mySUB:
    Exit Sub
Err_mySUB:
    MsgBox Err.Number & ": " & Err.Description & " (" & Erl & ")"
    Resume Exit_mySUB
End Sub 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-10T22:45:32.753

我的解决方案如下：

1.  安装[MZ-Tools](http://www.mztools.com)，一个非常有趣的 VBA 插件。不，他们没有付钱给我写这篇文章。第 3 版是免费的，但从 8.0 版开始，该插件在商业上出售。
2.  编写一个标准的错误处理程序代码，例如这个（参见 MZ-Tools 菜单/选项/错误处理程序）：

* * *

```
On Error GoTo {PROCEDURE_NAME}_Error
{PROCEDURE_BODY}
On Error GoTo 0
Exit {PROCEDURE_TYPE}

{PROCEDURE_NAME}_Error:
debug.print "#" & Err.Number, Err.description, "l#" & erl, "{PROCEDURE_NAME}", "{MODULE_NAME}" 
```

* * *

然后可以通过单击 MZ-Tools 菜单中的相应按钮将此标准错误代码自动添加到您的所有 procs 和函数中。您会注意到，我们在这里引用了 VBA 标准库中的一个隐藏且未记录的函数“Erl”，它代表“错误行”。你说对了！如果您要求 MZ-Tools 自动为您的代码行编号，“Erl”会为您提供发生错误的行号。您将在即时窗口中看到错误的完整描述，例如：

```
#91, Object variable or With block variable not set, l# 30, addNewField, Utilities 
```

当然，一旦你意识到对系统的兴趣，你可以考虑一个更复杂的错误处理程序，它不仅会在调试窗口中显示数据，而且还会：

1.  在屏幕上显示为消息
2.  自动在错误日志文件中插入一行描述错误**或**
3.  如果您正在使用 Access 或连接到数据库，请自动将记录添加到 Tbl_Error 表！

这意味着在用户级别生成的每个错误都可以存储在文件或表中，也可以存储在机器或网络上的某个位置。我们是在谈论构建一个使用 VBA**的自动错误报告系统吗？**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-10T22:40:02.343

好吧，有几个工具可以满足您对[MZ Tools](http://www.mztools.com/index.aspx)和[FMS Inc](http://www.fmsinc.com)的要求。

基本上它们涉及添加：

```
On Error GoTo ErrorHandler 
```

在每个 proc 的顶部，最后他们放了一个：

```
ErrorHandler:
  Call MyErrorhandler Err.Number, Err.Description, Err.LineNumber 
```

标签通常调用全局错误处理程序，您可以在其中显示和记录自定义错误消息

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-30T15:24:07.657

[您始终可以像Chip Pearson](http://www.cpearson.com/excel/vbe.aspx)那样推出自己的工具。VBA 实际上可以通过[Microsoft Visual Basic for Applications Extensibility 5.3 Library](http://msdn.microsoft.com/en-us/library/aa443718(v=vs.60).aspx)访问它自己的 IDE 。我编写了一些类模块，使自己更容易使用。它们可以在[Code Review SE](https://codereview.stackexchange.com/q/52364/41243)上找到。

我用它来插入`On Error GoTo ErrHandler`语句以及与我的错误处理模式相关的适当标签和常量。我还使用它来将常量与实际过程名称同步（如果函数名称发生变化）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-10T18:13:19.523

没有必要购买DJ提到的工具。这是我的免费代码：

```
Public Sub InsertErrHandling(modName As String)
    Dim Component As Object
    Dim Name As String
    Dim Kind As Long
    Dim FirstLine As Long
    Dim ProcLinesCount As Long
    Dim Declaration As String
    Dim ProcedureType As String
    Dim Index As Long, i As Long
    Dim LastLine As Long
    Dim StartLines As Collection, LastLines As Collection, ProcNames As Collection, ProcedureTypes As Collection
    Dim gotoErr As Boolean

    Kind = 0
    Set StartLines = New Collection
    Set LastLines = New Collection
    Set ProcNames = New Collection
    Set ProcedureTypes = New Collection

    Set Component = Application.VBE.ActiveVBProject.VBComponents(modName)
        With Component.CodeModule

            ' Remove empty lines on the end of the code
            For i = .CountOfLines To 1 Step -1
                If Component.CodeModule.Lines(i, 1) = "" Then
                  Component.CodeModule.DeleteLines i, 1
                Else
                    Exit For
                End If
            Next i

            Index = .CountOfDeclarationLines + 1
            Do While Index < .CountOfLines
                gotoErr = False
                Name = .ProcOfLine(Index, Kind)
                FirstLine = .ProcBodyLine(Name, Kind)
                ProcLinesCount = .ProcCountLines(Name, Kind)
                Declaration = Trim(.Lines(FirstLine, 1))
                LastLine = FirstLine + ProcLinesCount - 2
                If InStr(1, Declaration, "Function ", vbBinaryCompare) > 0 Then
                    ProcedureType = "Function"
                Else
                    ProcedureType = "Sub"
                End If
                Debug.Print Component.Name & "." & Name, "First: " & FirstLine, "Lines:" & ProcLinesCount, "Last: " & LastLine, Declaration
                Debug.Print "Declaration: " & Component.CodeModule.Lines(FirstLine, 1), FirstLine
                Debug.Print "Closing Proc: " & Component.CodeModule.Lines(LastLine, 1), LastLine

                ' do not insert error handling if there is one already:
                For i = FirstLine To LastLine Step 1
                    If Component.CodeModule.Lines(i, 1) Like "*On Error*" Then
                        gotoErr = True
                        Exit For
                    End If
                Next i
                If Not gotoErr Then
                    StartLines.Add FirstLine
                    LastLines.Add LastLine
                    ProcNames.Add Name
                    ProcedureTypes.Add ProcedureType
                End If

                Index = FirstLine + ProcLinesCount + 1
            Loop

            For i = LastLines.Count To 1 Step -1
                If Not (Component.CodeModule.Lines(StartLines.Item(i) + 1, 1) Like "*On Error GoTo *") Then
                    Component.CodeModule.InsertLines LastLines.Item(i), "ExitProc_:"
                    Component.CodeModule.InsertLines LastLines.Item(i) + 1, "    Exit " & ProcedureTypes.Item(i)
                    Component.CodeModule.InsertLines LastLines.Item(i) + 2, "ErrHandler_:"
                    Component.CodeModule.InsertLines LastLines.Item(i) + 3, "    Call LogError(Err, Me.Name, """ & ProcNames.Item(i) & """)"
                    Component.CodeModule.InsertLines LastLines.Item(i) + 4, "    Resume ExitProc_"
                    Component.CodeModule.InsertLines LastLines.Item(i) + 5, "    Resume ' use for debugging"

                    Component.CodeModule.InsertLines StartLines.Item(i) + 1, "    On Error GoTo ErrHandler_"
                End If
            Next i
        End With
End Sub 
```

将它放在一个模块中，并在每次将新函数或子添加到这样的表单或模块时从即时窗口调用它（Form1 是表单的名称）：

```
MyModule.InsertErrHandling "Form_Form1" 
```

它将改变您在 Form1 中的 ode：

```
Private Function CloseIt()
    DoCmd.Close acForm, Me.Name
End Function 
```

对此：

```
Private Function CloseIt()
    On Error GoTo ErrHandler_
        DoCmd.Close acForm, Me.Name
ExitProc_:
Exit Function
ErrHandler_:
    Call LogError(Err, Me.Name, "CloseIt")
    Resume ExitProc_
    Resume ' use for debugging
End Function 
```

现在在一个模块中创建一个 Sub ，它将显示错误对话框，您可以在其中添加将错误插入文本文件或数据库的位置：

```
Public Sub LogError(ByVal objError As ErrObject, moduleName As String, Optional procName As String = "")
    On Error GoTo ErrHandler_
    Dim sql As String
    MsgBox "Error " & Err.Number & " Module " & moduleName & Switch(procName <> "", " in " & procName) & vbCrLf & " (" & Err.Description & ") ", vbCritical
Exit_:
    Exit Sub
ErrHandler_:
    MsgBox "Error in LogError procedure " & Err.Number & ", " & Err.Description
    Resume Exit_
    Resume ' use for debugging
End Sub 
```

如果 proc 中已经存在“On Error”语句，则此代码不会进入错误处理。

# iphone - iPhone：在应用程序中同时使用 OpenGL 和本机用户界面的最佳方式是什么？

> ID：357823
> 
> 赞同：2
> 
> 时间：2008-12-10T22:25:00.550
> 
> 标签：iphone, opengl, user-interface

我对 iPhone 平台还很陌生，所以我想知道在 OpenGL 渲染和 UIView 之间切换的最佳方式可能是什么？

任何意见非常感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-11T23:58:55.570

根本不需要切换模式。iPhone 上的 OpenGL ES 渲染是在 CAEAGLLayer 核心动画层中完成的。这可以用作 UIView 的基础层，这意味着您可以将所有 UIView 布局和触摸处理与您的 3-D 渲染结合起来。这个 UIView 可以是全屏的，也可以放在显示器上的任何位置。UIViews 也可以成为你的 3-D 视图的子视图，因此它们可以出现在你的渲染之上。

OpenGL ES Application Xcode 模板在 UIView 实例中为您提供了一个 OpenGL 层，是一个很好的起点。对于更复杂的示例，我可以将您定向到[Molecules 的源代码](http://www.sunsetlakesoftware.com/2008/10/02/molecules-source-code-now-available)，我的 3-D 分子查看器。在那个应用程序中，我使用了很多视图功能来进行触摸检测，并在右下角放置了一个信息按钮作为子视图。我什至用另一个视图替换该视图以在进入应用程序设置时生成翻转动画。

# vim - 如何在vim中自动对齐python变量赋值行

> ID：357824
> 
> 赞同：12
> 
> 时间：2008-12-10T22:25:39.567
> 
> 标签：vim

我想在vim中自动对齐python变量赋值的行。

例如我想改变这个：

```
a = 1
banana = 2 
```

进入这个

```
a      = 1
banana = 2 
```

vim 中自动生成。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-10T22:31:30.443

您可能正在寻找 vim 的 Align 插件：

[http://www.vim.org/scripts/script.php?script_id=294](http://www.vim.org/scripts/script.php?script_id=294)

安装后，您只需选择要对齐的文本（Shift V）并输入：

:对齐 =

这将根据 = 字符对齐文本，因此您可以使用任何您真正想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T22:30:36.437

[Align](http://www.vim.org/scripts/script.php?script_id=294)插件可以做到这一点以及更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T22:30:54.983

试试[对齐插件](http://www.vim.org/scripts/script.php?script_id=294)。

[这里](http://linux.byexamples.com/archives/153/vim-tip-1-align/)描述...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-17T13:43:26.753

这将完成工作：

```
vap

:!column -t 
```

# flash - Flash / Actionscript CPU 分析器

> ID：357825
> 
> 赞同：16
> 
> 时间：2008-12-10T22:26:09.923
> 
> 标签：flash, actionscript, profiling, cpu-usage

你找到这样的工具并成功使用了吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T19:28:26.483

我也在寻找一个用于 AS 的分析器，但我想要一个与 FlashDevelop 和 Flex SDK 一起使用的免费软件/开源解决方案。我没有找到。所以我写了一个简单的python脚本和一个更简单的AS类。该脚本本质上采用任何 AS 文件并将分析代码（即调用以测量该函数的总运行时间，精度为 1 毫秒 -`flash.utils.getTimer()`调用的分辨率）到每个函数定义。脚本有时会出错，但这些通常很容易手动修复。然后你需要手动添加一行：在某个地方转储分析统计信息。这种方法显然远非准确，但它仍然让您对代码中的瓶颈有很好的感觉。我成功地将它用于 100k 文件。

这是 AS 类：

```
package  {
    public class Profiler {
        private static var instance:Profiler;

        public static function get profiler():Profiler {
            if (!Profiler.instance) Profiler.instance = new Profiler;
            return Profiler.instance;
        }

        private var data:Object = {};

        public function profile(fn:String, dur:int):void {
            if (!data.hasOwnProperty(fn)) data[fn] = new Number(0);
            data[fn] += dur / 1000.0;
        }

        public function clear():void {
            data = { };
        }

        public function get stats():String {
            var st:String = "";
            for (var fn:String in data) {
                st += fn + ":\t" + data[fn] + "\n";
            }
            return st;
        }
    }
} 
```

这是解决问题的python脚本：

```
import sre, sys

rePOI = sre.compile(r'''\bclass\b|\bfunction\b|\breturn\b|["'/{}]''')
reFun = sre.compile(r'\bfunction\b\s*((?:[gs]et\s+)?\w*)\s*\(')
reCls = sre.compile(r'class\s+(\w+)[\s{]')
reStr = sre.compile(r'''(["'/]).*?(?<!\\)\1''')

def addProfilingCalls(body):
    stack = []
    pos = 0
    depth = 0
    retvar = 0
    klass = ""
    match = rePOI.search(body, pos)
    while match:
        poi = match.group(0)
        pos = match.start(0)
        endpos = match.end(0)

        if poi in '''"'/''':
            strm = reStr.match(body, pos)
            if strm and (poi != '/' or sre.search('[=(,]\s*$', body[:pos])):
                endpos = strm.end(0)

        elif poi == 'class':
            klass = reCls.match(body, pos).group(1)
            sys.stderr.write('class ' + klass + '\n')

        elif poi == 'function':
            fname = reFun.match(body, pos)
            if fname.group(1):
                fname = klass + '.' + fname.group(1)
            else:
                lastf = stack[-1]
                lastf['anon'] += 1
                fname = lastf['name'] + '.anon' + str(lastf['anon'])
            sys.stderr.write('function ' + fname + '\n')
            stack.append({'name':fname, 'depth':depth, 'anon':0})

            brace = body.find('{', pos) + 1
            line = "\nvar __start__:int = flash.utils.getTimer();"
            body = body[:brace] + line + body[brace:]
            depth += 1
            endpos = brace + len(line)

        elif poi == '{':
            depth += 1

        elif poi == 'return':
            lastf = stack[-1]
            semicolon = body.find(';', pos) + 1
            if sre.match('return\s*;', body[pos:]):
                line = "{ Profiler.profiler.profile('" + lastf['name'] + \
                       "', flash.utils.getTimer() - __start__); return; }"
            else:
                retvar += 1
                line = "{ var __ret" + str(retvar) + "__:* =" + body[pos+6:semicolon] + \
                       "\nProfiler.profiler.profile('" + lastf['name'] + \
                       "', flash.utils.getTimer() - __start__); return __ret" + str(retvar) + "__; }"
            body = body[:pos] + line + body[semicolon:]
            endpos = pos + len(line)

        elif poi == '}':
            depth -= 1
            if len(stack) > 0 and stack[-1]['depth'] == depth:
                lastf = stack.pop()
                line = "Profiler.profiler.profile('" + lastf['name'] + \
                    "', flash.utils.getTimer() - __start__);\n"
                body = body[:pos] + line + body[pos:]
                endpos += len(line)

        pos = endpos
        match = rePOI.search(body, pos)
    return body

def main():
    if len(sys.argv) >= 2: inf = open(sys.argv[1], 'rU')
    else: inf = sys.stdin
    if len(sys.argv) >= 3: outf = open(sys.argv[2], 'wU')
    else: outf = sys.stdout
    outf.write(addProfilingCalls(inf.read()))
    inf.close()
    outf.close()

if __name__ == "__main__":
    main() 
```

随意使用、分发和修改两者。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-10T23:29:23.227

Adobe 最近发布了一个新的 Flash 分析工具，称为 Adob​​e Scout：

[http://gaming.adobe.com/technologies/scout/](http://gaming.adobe.com/technologies/scout/)

这是对旧的 Flash Builder 分析器的巨大改进 - 它为您提供了 CPU 时间的详细细分，包括 ActionScript 执行以及渲染和网络等内部播放器功能。

它在试用期内是免费的 - 您只需注册一个免费的 Creative Cloud 帐户。之后，将继续提供免费的基本版本，完整版作为付费 Creative Cloud 帐户的一部分提供。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T17:42:06.433

It's important to note that the Flash Player implementation is different on each platform and to an extent each browser, so expect notable speed differences. So if you're developing a resource intensive application you should be using profiling tools specific to each OS you're targeting, like for example [Instruments](http://developer.apple.com/technology/tools.html) on OS X and of course test the performance in each browser.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-20T18:45:37.467

This one is my personal favorite. Note that it's built on java and open source. [http://github.com/bengarney/PBLabsProfiler](http://github.com/bengarney/PBLabsProfiler)

It uses undocumented features of flash/flex compiler. The same ones Flash Builder built-in profiler uses. And yes! I have successfully used it to optimize some of my flash code.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T08:41:22.077

我使用 Flex Builder 3 附带的分析器取得了一定的成功。我发现在查找内存泄漏和/或 GC 问题时特别有用。

由于相关应用程序的异步性质以及 [onEnterFrame] 和其他内部方法的时间量，它在方法时间性能方面对我的用处要小得多，尽管我仍然能够做一些基于输出的优化。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-21T06:59:14.147

前段时间我写了一个基于 flasm 的 flash profiler ( [http://snow.prohosting.com/bensch/flasp.html](http://snow.prohosting.com/bensch/flasp.html) ) 你需要使用 flasm 插入 profiling asm 然后运行程序。

另一种（也许）更好的方法是使用 David Chang 的分析代码，它根本不需要 flasm。www.nochump.com/asprof/

干杯

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T02:14:29.293

Flex Builder 3 包括一个[性能和内存分析器](http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:_Performance_and_Memory_Profiling)。我没用过，但看起来很时髦。我不确定它是否可以用于非 Flex 内容，但它肯定只适用于 AS3。

除此之外，多年来，我发现了一些可行的方法来进行一定程度的分析。在最简单的情况下，您显然可以构建一个 FPS 计并观察它的行为。有关代码繁重的应用程序的更多信息，我所做的一件事是创建一个简单的框架，用于`getTimer()`在方法的开头和结尾进行调用并跟踪累积时间，但我从未为此使用任何预制工具. 在实践中，代码繁重工作的瓶颈通常很明显，在这些情况下，我只是将计时器直接放在我要优化的地方。

当瓶颈出现在渲染中时，首先要尝试的是简单地以目标 FPS 发布，并使用 FPS 仪表来跟踪实际播放何时低于该值（在目标硬件上）。您可以通过调用 1ms 超时来获取有关渲染的更多详细信息`refreshAfterUpdate`，并监控刷新之间的实际时间。不幸的是，您无法获得比“每次刷新”更精细的信息 - 您无法直接看到光栅化、合成等花费了多少时间。（尽管您通常可以推断出这些事情。例如，您可以启用位图缓存在矢量重的对象上取消光栅化，并观察结果。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-17T05:01:06.647

我发现[The Miner](http://www.sociodox.com/theminer/)非常有用，而且它对非商业项目是免费的。它具有广泛的功能，但标有“性能分析器”的选项卡是最有帮助的。我发现这是找到代码瓶颈的好方法，或者至少知道主要原因是什么（渲染、文本、网络等）。

我花了一点时间找到安装说明，但这很简单。在项目中包含 .swc 文件，然后在文档类构造函数中添加 1 行代码。

```
this.addChild(new TheMiner(true)); 
```

更多信息： http: [//www.sociodox.com/theminer/support.html](http://www.sociodox.com/theminer/support.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-05T22:07:16.433

有一个 FlashPreloaderProfiler：http: [//jpauclair.net/flashpreloadprofiler](http://jpauclair.net/flashpreloadprofiler)

它是用 actionscript 编写的，不需要在后台运行 java 应用程序，并且具有更多功能，例如 Memory Profiler。

但我也更喜欢 PBLabsProfiler :)

# ant - 处理 ant bpelc 任务中的 PermGen 错误

> ID：357827
> 
> 赞同：2
> 
> 时间：2008-12-10T22:26:31.857
> 
> 标签：ant, bpel

在使用 jdk 1.5.0_11 在 Linux 下使用 ant 编译项目时，我遇到了 java.lang.OutOfMemoryError: PermGen 错误。同一个项目在windows下编译没有问题。

通常这与分配给 JVM 的 MaxPermSize 有关。Irakli Nadareishvili[对 PermGen 错误的最佳解释之一](http://www.freshblurbs.com/explaining-java-lang-outofmemoryerror-permgen-space)和设置[Java HotSpot VMOptions](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp#PerformanceTuning)的指南（例如 -XX:MaxPermSize=128M）

在这种情况下，我迅速将问题缩小到特定的[bpelc](http://ode.apache.org/bpelc-task.html) ant 任务

```
<bpelc input="${build.dir}/bpel/bpel.xml" 
out="${build.dir}/output" rev="${version}" home="${bpel.home}"/> 
```

现在我不认为 bpelc 像 javac 那样采用 compilerarg 元素：

```
 <javac srcdir="${src.dir}"
         destdir="${classes.dir}"
         classpathref="libraries">
    <compilerarg value="-XX:MaxPermSize=128M"/>
  </javac> 
```

那么如何修复 bpelc 任务的错误呢？到目前为止，我想出的最佳解决方案是设置[ANT_OPTS](http://ant.apache.org/manual/running.html#envvars)环境变量。这似乎避免了迄今为止的问题。

```
export ANT_OPTS=-XX:MaxPermSize=128m 
```

谁能阐明更多？这是一个万无一失的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T22:33:32.547

当`bpelc`任务在运行 ant 的原始 JVM 中执行时，设置`ANT_OPTS`（或等效的东西）是唯一可能的解决方案。

一个这样的等价物可能是将该任务重构为第二个 ant 构建文件并使用单独的 JVM 运行该文件。不是真的更好，但根据您的环境，它可能更容易实现。

# debugging - 保留挂起的应用程序的 Windows 错误报告转储

> ID：357828
> 
> 赞同：1
> 
> 时间：2008-12-10T22:27:27.783
> 
> 标签：debugging, windows-server-2003, dump, freeze, windows-error-reporting

一个应用程序偶尔会挂起，我想当时看转储来弄清楚。我编写了一个应用程序，用户可以运行它来自动创建我可以查看的转储。但是，无论我尝试什么，我似乎都无法让用户记住在它挂起时运行它。他们总是最终关闭调用 Windows 错误报告的程序。

WER 将在临时目录中创建转储，但不幸的是，一旦关闭将信息发送给 Microsoft 的对话框，它们就会被删除。

成为 ISV 并从 Microsoft 的错误报告服务器获取此信息是一种解决方案。但目前还不是现实的解决方案。

我无法想象我是唯一面临这个问题的人。该软件由数十名员工同时使用，因此可以联系他们并让他们运行应用程序，或者在运行其他应用程序或其他应用程序没有解决之前不要单击该对话框上的关闭。

该应用程序在 Windows Server 2003 上运行。太糟糕了，因为我知道 Server 2008 有一些 LocalDumps 选项可以让我保留它们。

任何想法以某种方式保留这些转储以便我可以分析它们？障碍是用户，从某种意义上说，我已经接受了他们的固执，不希望他们运行任何其他应用程序或做任何特别的事情。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T09:01:35.977

您可以选择自动解决方案。我相信您可以使用多种选择来检测您是否被挂起。

一种是在应用程序的单独线程中使用 SendMessageTimeout（也请注意 SMTO_ABORTIFHUNG 作为 fuFlags 值之一）。一旦你确定主线程没有响应，你可以在任何你想要的地方保存一个转储文件。从 w2k 开始还有一个 IsHungAppWindow() (user32.dll) 可用。

# asp.net - ASP.NET 编译行为根据页面内容而变化？

> ID：357839
> 
> 赞同：0
> 
> 时间：2008-12-10T22:31:43.127
> 
> 标签：asp.net, visual-studio-2008

我一直在努力解决与在 FormView 中引用子控件有关的一些问题。另一位开发人员编写了一个正在编译和工作的 ASPX 页面，在该代码中，他将 FormView 中的子控件**直接**引用为页面对象的属性。该页面是 ASP.NET 网站项目（与 Web 应用程序项目相对）的一部分。我们决定将项目转换为 Web 应用程序项目模型，并注意到这些属性引用现在无法编译。文件隐藏代码不会在表单视图中生成控件。

在研究这个问题时（我在这里有一篇关于这些问题的单独帖子），我遇到了一些莫名其妙的事情。从我读过的所有帖子中，您应该**始终**需要使用 FindControl 在 FormView 的模板中引用子控件 - 即，无论您是否在网站项目模型中，都不能通过简单的生成属性来完成或 Web 应用程序项目模型。

我对我同事的代码如何编译和运行感到困惑。正如我所指出的，他通过页面中的简单属性引用 FormView 包含的子控件，而不必求助于 FindControl 调用。因此，为了弄清这个谜团，我编造了一个最短的例子来证明这一现象。

我发现很奇怪。我在这里的代码有一个 ASP:FormView，它的 ItemTemplate 中有一些标签控件。其中一个标签的 ID 为**MyComment**。当 FormView 数据绑定（到 Northwind 的 Products 表）时，我只是设置了一些文本。

```
using System;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        this.FormView1.ChangeMode(FormViewMode.ReadOnly);
    }
    protected void FormView1_DataBound(object sender, EventArgs e) {
        MyComment.Text = "Data bound at " + DateTime.Now.ToString();
    }
} 
```

此代码将无法编译，因为 MyComment 不是有效属性。奇怪的部分来了。 **如果我在 FormView 的 ItemTemplate 中嵌入来自 Ajax 控件工具包库的 TabContainer 控件，则上面的代码可以正确编译和运行**。

所以我同事的代码正在编译的原因是因为 FormView 中嵌入了 TabContainer 控件？为什么这应该改变编译器的行为以及您可以访问 FormView 的子控件的机制对我来说是一个谜。顺便说一句，尽管它可以干净地编译并正确运行，但 Intellisense 看不到这些属性，ReSharper 将它们报告为编译错误（通过指示器栏中的红灯）。

这是页面的标记。任何人都可以阐明这种行为吗？顺便说一句，我并不是在抱怨 ASP.NET 在这种情况下创建这些属性的事实。（不幸的是，这种快乐但奇怪的行为似乎只适用于该项目是一个网站项目；作为一个 Web 应用程序项目，即使使用嵌入的 TabControl，属性访问器也不能在 FormView 中工作）。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <div>
        <asp:FormView ID="FormView1" runat="server" DataKeyNames="ProductID" DataSourceID="SqlDataSource1"
            OnDataBound="FormView1_DataBound">
            <ItemTemplate>
                <ajaxToolkit:TabContainer runat="server" ID="TabsItem">
                    <ajaxToolkit:TabPanel runat="Server" ID="PanelBasicsItem" HeaderText="Basics">
                        <ContentTemplate>
                            ProductID:
                            <asp:Label ID="ProductIDLabel" runat="server" Text='<%# Eval("ProductID") %>' />
                            <br />
                            ProductName:
                            <asp:Label ID="ProductNameLabel" runat="server" Text='<%# Bind("ProductName") %>' />
                            <br />
                            My Comment:
                            <asp:Label ID="MyComment" runat="server"></asp:Label>
                            <br />
                        </ContentTemplate>
                    </ajaxToolkit:TabPanel>
                </ajaxToolkit:TabContainer>
            </ItemTemplate>
        </asp:FormView>
        <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:NorthwindConnectionString %>"
            SelectCommand="SELECT [ProductID], [ProductName] FROM [Alphabetical list of products]">
        </asp:SqlDataSource>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T15:41:04.560

当您将**网站**转换为Web**应用程序**时，您是否检查过为您的 aspx 文件正确生成的部分类（例如，在您的 Web 应用程序中，默认值下应该有一个名为“Default.aspx.cs.designer”的文件） .aspx 和 Default.aspx.cs 文件）。

在**网站**中，这些是由服务器在您的网站运行和编译时动态生成的（因此在您的项目中不存在），而在 Web**应用程序**中，它们由 Visual Studio 创建和管理 - 如果它们不'不存在，那么代码可能无法编译，因为对象还没有被实例化——你看到的实际编译器错误是什么？

通过在将项目转换为 Web 应用程序后向页面添加新控件，您将强制 VS 创建缺少的部分类。

# regex - 如何对普通话字符串进行正则表达式搜索？

> ID：357845
> 
> 赞同：1
> 
> 时间：2008-12-10T22:33:11.733
> 
> 标签：regex, internationalization

如何对普通话字符串进行正则表达式搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T10:54:17.153

与任何其他字符串没有什么不同；当然，它需要一种语言和一个正则表达式库，该库正确地将 unicode 用于其字符串，并且不假定字符串只是解释为 ASCII 的字节数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T22:35:48.313

用什么语言？在 PHP 中，使用 UTF-8 和 /u 修饰符。

# java - 在 Java 中：如何从 byte[] 数组中压缩文件？

> ID：357851
> 
> 赞同：59
> 
> 时间：2008-12-10T22:34:42.060
> 
> 标签：java, zip

我的应用程序正在通过 SMTP 服务器接收电子邮件。电子邮件中有一个或多个附件，并且电子邮件附件返回为 byte[]（使用 sun javamail api）。

我正在尝试即时压缩附件文件而不先将它们写入磁盘。

实现这一结果的可能方法是什么？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-12-10T22:48:17.693

您可以使用 Java 的 java.util.zip.ZipOutputStream 在内存中创建一个 zip 文件。例如：

```
public static byte[] zipBytes(String filename, byte[] input) throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipOutputStream zos = new ZipOutputStream(baos);
    ZipEntry entry = new ZipEntry(filename);
    entry.setSize(input.length);
    zos.putNextEntry(entry);
    zos.write(input);
    zos.closeEntry();
    zos.close();
    return baos.toByteArray();
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-10-30T01:42:47.613

我有同样的问题，但我需要一个 zip 中的许多文件。

```
 protected byte[] listBytesToZip(Map<String, byte[]> mapReporte) throws IOException {
    String extension = ".pdf";
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipOutputStream zos = new ZipOutputStream(baos);
    for (Entry<String, byte[]> reporte : mapReporte.entrySet()) {
        ZipEntry entry = new ZipEntry(reporte.getKey() + extension);
        entry.setSize(reporte.getValue().length);
        zos.putNextEntry(entry);
        zos.write(reporte.getValue());
    }
    zos.closeEntry();
    zos.close();
    return baos.toByteArray();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-10T15:03:42.263

您可以从字节数组创建一个 zip 文件并返回到 ui streamedContent

```
public StreamedContent getXMLFile() {
        try {
            byte[] blobFromDB= null;
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            ZipOutputStream zos = new ZipOutputStream(baos);
            String fileName= "fileName";
            ZipEntry entry = new ZipEntry(fileName+".xml");
            entry.setSize(byteArray.length);
            zos.putNextEntry(entry);
            zos.write(byteArray);
            zos.closeEntry();
            zos.close();
            InputStream is = new ByteArrayInputStream(baos.toByteArray());
            StreamedContent zipedFile= new DefaultStreamedContent(is,   "application/zip", fileName+".zip", Charsets.UTF_8.name());
            return fileDownload;
        } catch (IOException e) {
            LOG.error("IOException e:{} ",e.getMessage());
        } catch (Exception ex) {
            LOG.error("Exception ex:{} ",ex.getMessage());
        }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T22:36:58.420

也许[java.util.zip](http://java.sun.com/j2se/1.3/docs/api/java/util/zip/package-summary.html)包可能会帮助你

由于您询问如何从字节数组转换，我认为（未测试）您可以使用 ByteArrayInputStream 方法

```
int     read(byte[] b, int off, int len)
          Reads up to len bytes of data into an array of bytes from this input stream. 
```

你会喂给

```
ZipInputStream  This class implements an input stream filter for reading files in the ZIP file format. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-10T22:42:24.663

您必须为此使用 ZipOutputStream。

[http://java.sun.com/javase/6/docs/api/java/util/zip/ZipOutputStream.html](http://java.sun.com/javase/6/docs/api/java/util/zip/ZipOutputStream.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-16T07:35:57.740

```
ByteArrayInputStream bais = new ByteArrayInputStream(retByte);

ZipInputStream zis = new ZipInputStream(bais);

zis.getNextEntry();

Scanner sc = new Scanner(zis);
while (sc.hasNextLine()) {
    System.out.println("-->:" +sc.nextLine());
}

zis.closeEntry();
zis.close(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-27T11:33:59.697

```
 byte[] createReport() {
    try {
     ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
     ZipArchiveOutputStream zipOutputStream = new 
     ZipArchiveOutputStream(byteArrayOutputStream);

     zipOutputStream.setMethod(ZipArchiveOutputStream.STORED);
     zipOutputStream.setEncoding(ENCODING);

     String text= "text";
     byte[] textBytes = text.getBytes(StandardCharsets.UTF_8);

     ArchiveEntry zipEntryReportObject = newStoredEntry("file.txt", textBytes);
     zipOutputStream.putArchiveEntry(zipEntryReportObject);
     zipOutputStream.write(textBytes);

     zipOutputStream.closeArchiveEntry();
     zipOutputStream.close();

     return byteArrayOutputStream.toByteArray();
     } catch (IOException e) {
       return null;
    } 
```

和

```
ArchiveEntry newStoredEntry(String name, byte[] data) {
    ZipArchiveEntry zipEntry = new ZipArchiveEntry(name);
    zipEntry.setSize(data.length);
    zipEntry.setCompressedSize(zipEntry.getSize());
    CRC32 crc32 = new CRC32();
    crc32.update(data);
    zipEntry.setCrc(crc32.getValue());
    return zipEntry;
  } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-03T01:56:59.567

```
public static void createZip(byte[] data) throws ZipException {
    ZipInputStream zipStream = new ZipInputStream(new ByteArrayInputStream(data));
    ZipParameters parameters = new ZipParameters();
    parameters.setFileNameInZip("bank.zip");
    new ZipFile("F:\\ssd\\bank.zip").addStream(new ByteArrayInputStream(data), parameters);
} 
```

# internet-explorer - 为什么 IE 和 Firefox 呈现相同的图像不同，我该如何防止它？

> ID：357860
> 
> 赞同：1
> 
> 时间：2008-12-10T22:37:12.850
> 
> 标签：internet-explorer, firefox, image, rendering

![替代文字](https://farm4.static.flickr.com/3199/3099078396_a3c4924c81_o.gif)

在左边你会注意到 IE 渲染的 google 标志，我在 G 的顶部和底部画了一条黑线，它延伸到 FF 窗口，呈现相同的标志，但 FF 版本将图像渲染得更大。此页面没有链接到 css，只有简单的 Html。

谁能告诉我为什么会发生这种情况，我可以阻止它吗？我的盒子只是fubar，没有其他人得到这种行为吗？

编辑：未能提及 IE7/FF3

编辑：按要求发布 Html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="ctl00_Head1"><title></title>
</head>
<body>
<img src="http://www.google.com/intl/en_ALL/images/logo.gif" />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T00:56:17.233

我刚刚在 IE、Firefox 和 Chrome 中创建了 Google 图像的屏幕截图的合成图像，它们都完美匹配（前 2 个图像，不透明度为 30%）。

我相信它必须是您在其中一个浏览器中设置的自定义缩放。例如，检查状态栏右侧的 IE 缩放。

[![合成图像](https://i.stack.imgur.com/dZcXR.png)](https://i.stack.imgur.com/dZcXR.png)
[（来源：[mikescommunity.com](http://mikescommunity.com/public/images/googleimagecomposite.png)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T22:55:09.163

文本渲染有什么不同吗？可能是您在 FF（或 IE）中放大了页面？

可以尝试 Ctrl-0 来重置缩放大小（两者都适用），我有一个带有免费旋转轮的罗技鼠标，所以当我忘记滚轮仍在旋转并按下 Ctrl 键时，这种情况发生在我身上。许多其他可以设置缩放等的地方。

也可能是完全不同的东西，但通常我发现 IE 和 FF 渲染图像大致相同。

不会基于此将盒子称为 fubar，更可能是某处的软件设置......但是，嘿，快到圣诞节了，如果你想找一个新盒子的借口，我不会告诉任何人 :)

# ado.net - 具有重复列名的 DataReader

> ID：357864
> 
> 赞同：1
> 
> 时间：2008-12-10T22:37:35.877
> 
> 标签：ado.net

处理尝试从具有多个同名列的 DataReader 获取数据的最佳方法是什么？

由于涉及的工作量很大，并且我们不想通过更改我们用于检索数据的存储过程而失去供应商的支持，我正在尝试找到另一种方法来访问显示更多的列在数据读取器中不止一次，而不必重写存储过程。

有任何想法吗？

编辑：好的，实际上从数据读取器填充的函数在多个地方使用，因此该函数有可能被不同的存储过程调用。我所做的是使用索引执行 GetName 以检查它是否是正确的列，如果是，则提取其值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T22:40:00.253

如果您知道列的索引，则通过索引访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T22:39:40.100

你不能使用列序号吗？0 代表第 1 次，1 代表第 2 次，等等？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T22:40:02.267

您必须按索引号引用该列；即阅读器[5].ToString(); 读取第 5 列中的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-21T14:37:48.957

基于“编辑”段落中描述的原始发布者的方法，这里有一个扩展方法，它将根据列名和该名称的索引给出值，例如，0 表示名称的第一个实例，1 表示第二个等：

```
using System;

namespace WhateverProject {

    internal static class Extentions {

        // If a query returns MULTIPLE columns with the SAME name, this allows us to get the Nth value of a given name.
        public static object NamedValue(this System.Data.IDataRecord reader, string name, int index) {
            if (string.IsNullOrWhiteSpace(name)) return null;
            if (reader == null) return null;
            var foundIndex = 0;
            for (var i = 0; i < reader.FieldCount; i++) {
                if (!reader.GetName(i).Equals(name, StringComparison.CurrentCultureIgnoreCase)) continue;
                if (index == foundIndex) return reader[i];
                foundIndex++;
            }
            return false;
        }
    }
} 
```

这样使用它：

```
var value1 = reader.NamedValue("duplicatedColumnName", 0);
var value2 = reader.NamedValue("duplicatedColumnName", 1); 
```

# tsql - T-SQL 的 CASE 是正常（“懒惰”）评估吗？

> ID：357866
> 
> 赞同：7
> 
> 时间：2008-12-10T22:39:14.063
> 
> 标签：tsql

T-SQL 的 CASE 是惰性求值吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-10T22:47:40.333

是的，它按顺序评估 WHEN，直到找到一个正确的 WHEN，并且不评估剩余的 WHEN。

# asp.net - 相互依赖的组件的设计模式

> ID：357885
> 
> 赞同：1
> 
> 时间：2008-12-10T22:46:03.003
> 
> 标签：asp.net, design-patterns, architecture

我们正在为传送带构建一个“配置器”应用程序。基本上用户进来并挑选一个模型，然后开始挑选他们想要的零件。一些组件依赖于其他组件。例如，如果我选择 A 部分，那么我需要选择 1 个或多个 B 部分。这有点类似于在 Dell.com 上配置 PC。该应用程序还将提供有关零件/组件的建议。

基于这些信息，我正在研究是否有现有的模式可以让我们轻松维护和设计。有什么想法、想法吗？是否有任何具有类似功能的开源项目我可以借鉴想法/模式？

我最感兴趣的是如何在组件之间定义“规则”而不对规则/依赖项进行硬编码。

谢谢你的帮助。

没关系，但我们正在 .NetFramework 3.5/Asp.Net 中构建它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T22:54:25.793

没有充分的理由不这样做，我会保持简单，每个部分都有一个依赖部分的列表。

# java - GWT - Intellij IDEA 中的 GWT 有什么好的 GUI 编辑器？

> ID：357886
> 
> 赞同：17
> 
> 时间：2008-12-10T22:46:29.697
> 
> 标签：java, gwt, intellij-idea

IDEA 附带的只是一个 GWT 项目创建工具。有没有更好的插件？GWT 有独立的 GUI 编辑器吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T17:56:22.723

要直接回答您的问题，目前没有用于 GWT 的 Intellij IDEA GUI WYSIWYG 编辑器之类的东西。

GWT 最流行/功能完整的 WYSIWYG 编辑器是[Instantiations GWT Designer](http://www.instantiations.com/windowbuilder/)。但它仅适用于 Eclipse。

GWT 团队还提供了[一系列工具和库。](http://code.google.com/intl/nn/webtoolkit/tools.html). 虽然它似乎相当不完整，因为它没有列出 Ext-GWT 和 GWT-Ext 库（最流行的小部件库）。

但是请注意，大多数 WYSIWYG 编辑器仅支持 GWT 的基本小部件。如果您有自定义小部件，您可能无法在编辑器中使用它们。

* * *

[编辑] 截至 2010 年 8 月，Instanciation 已被 Google 收购

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T05:00:13.810

我从未亲自使用过这些，但我发现的一些东西包括：

*   [http://www.gdevelop.com/（JDeveloper](http://www.gdevelop.com/)的扩展，因此如果您使用 IDEA 并且不想为您的 GWT 项目下载和使用 JDeveloper，它可能不适合您）
*   [http://code.google.com/p/gwt-html-editor/](http://code.google.com/p/gwt-html-editor/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T07:10:04.470

你在这里有一个非常全面[的 GWT 插件/编辑器列表](http://javabyexample.wisdomplug.com/component/content/article/36-core-java/66-gwt-plugins-for-various-ides.html)。这些是针对 GWT 项目创建的，而不是针对 GUI。

但是，您也有[**VistaFei**](http://www.wirelexsoft.com/VistaFei.html)（目前不是很活跃，但值得一试）。它带有自己的 Eclipse 发行版：

[替代文字 http://blogs.zdnet.com/images/burnette_vistafei_control_grid_398.png](http://blogs.zdnet.com/images/burnette_vistafei_control_grid_398.png)

> 一个可视化集成开发环境 (IDE)，用于为所有支持 AJAX 的平台构建基于 Google Web Toolkit (GWT) 的 AJAX 应用程序。应用程序是通过“所见即所得”从调色板中“拖放”构建的。
> 
> VistaFei 是一个面向基于 GWT 的应用程序开发的视觉功能完整的 Java 开发环境。应用程序用 Java 开发，然后使用 GWT 编译器和调试器进行编译和调试，并从同一环境中启动到浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T02:36:41.957

不幸的是，真的还没有。我们将不得不等到 2016 年 Google 接管世界。那时一切都会变得容易得多！;)

# java - swing中数据对象的编辑器，最简单的方法是什么？

> ID：357896
> 
> 赞同：1
> 
> 时间：2008-12-10T22:50:48.860
> 
> 标签：java, swing

我有一个包含几个成员的 java 对象。我想创建一个小型、快速和肮脏的编辑器，允许我以简单的方式设置成员的值。我创建了一个面板，其中包含每个成员的 TextField。我有一个 setValues() 方法，它将获取 TextFields 的值并将它们设置到对象中。当我从面板调用 getDataObject() 时，会自动调用此方法。有些成员包含字符串，有些是双精度数，有些是整数。没有什么花哨。

然而，问题是，改进这个小组的更简单的方法是什么？如何在无需手动检查每个值的情况下添加一些验证？我怎样才能在不必编写大量代码的情况下做到这一点？目前，我快速且非常肮脏的实现只是传播了 RuntimeException，但这当然只是暂时的。

在我着手编写所有这些代码之前，我想知道什么是最好的模式，或者是否有一些库可用于执行此类操作，因为这似乎是一个相对常见的用例。换句话说，如果有一个懒惰的出路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T23:03:41.830

魁哈伯马里奥！:)

我前段时间从 JGoodies 读过这个库，但老实说，我不知道它是否相关。

[JGoodies 装订](http://www.jgoodies.com/downloads/libraries.html)

看看它，看看它是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T22:06:58.467

[在http://www.l2fprod.com/common/](http://www.l2fprod.com/common/)上查看属性编辑器

# .net - 如何重新加载经常崩溃的第 3 方 DLL

> ID：357898
> 
> 赞同：3
> 
> 时间：2008-12-10T22:53:52.457
> 
> 标签：.net, c++, winapi, dll

我正在使用用非托管 C++ 编写的第 3 方 DLL，它控制我们拥有的一些硬件。

不幸的是，这个 DLL 不时崩溃，我的任务是让它自动“重新加载”。我不太确定如何继续获得最佳结果。

我的项目使用 C++.Net 2.0 (2005)。我将第 3 方的东西包装在一个单独的 DLL 中。我一直在尝试 FreeLibrary() 和 LoadLibrary()。但是，当我使用 FreeLibrary() 时，仍然分配了一些内部 DLL 依赖项，并且 LoadLibrary() 会因为内存损坏而使其崩溃。

建议的另一种方法是使用 .NET 远程处理接口重构整个项目。杀死另一个进程并重新启动它会更容易，但这将是很多工作。

有什么建议么？指针？提示？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T15:39:08.240

最有效的方法是根本不在应用程序的进程中加载​​该 DLL。相反，创建第二个进程，其唯一工作是代表您的应用程序使用该 DLL。您可以使用共享内存区域、本地套接字或其他 IPC 机制来控制代理进程。

这样，当有问题的 DLL 崩溃时，您可以简单地让代理进程终止，而不必担心（几乎不可能）尝试确保 DLL 在其下降过程中没有损坏任何重要的任务。您的主进程只需要启动代理进程的新实例并继续。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-10T23:03:57.117

我不是 Windows 专家，但我认为总体思路应该成立。

LoadLibrary、FreeLibrary 处理将DLL 映射到进程内存空间。您看到的损坏可能是由于 DLL 中的某些代码做了一些“坏事”并且几乎​​肯定会损坏进程内存。现在如果它崩溃了，它几乎肯定会杀死它正在运行的线程——如果不是整个进程的话。

我会做出有根据的猜测，可靠地恢复并确保内存未损坏的唯一方法是运行一个牺牲进程作为流氓 DLL 的包装器。我认为远程接口是这样做的一种方式。可能还有其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T04:23:36.753

LoadLibrary 和 FreeLibrary 是开始，但是如果您希望能够在 DLL 中避免崩溃，则需要将所有调用包装到 SEH（结构化异常处理）__try / __catch 块中的 DLL 中。注意，这与 C++ 异常和 try/catch 块完全不同。有关详细信息，请参阅 MSDN。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T04:35:01.893

如果 DLL 本身正在崩溃，而您的公司会为此而努力，那么花时间重新创建它可能是值得的。更好地解决问题，而不是仅仅用绷带包扎它。

# ssis - 如何在脚本任务中指定源和目标 FTP 目录？

> ID：357903
> 
> 赞同：1
> 
> 时间：2008-12-10T22:56:15.540
> 
> 标签：ssis, ftp

我正在创建一个脚本来从远程计算机上 ftp 一些文件。我创建了一个文件，然后从命令行调用

```
ftp -s:filename proxy 
```

其中 filename 是我刚刚创建的文件。该文件的代码类似于以下内容：

```
anonymous@ip address
username
prompt off
binary
cd c:\destination directory
mget c:\source directory\*.*
quit 
```

那是行不通的。以下内容也没有：

```
anonymous@ip address
username
prompt off
binary
cd c:\source directory
mput c:\destination directory
quit 
```

显然，我不太擅长 ftp。如何，以什么顺序，在我的文件中的哪个位置指定我希望放置文件的位置（目标目录，以及运行 ftp 进程的位置），以及我希望文件的来源（IP 地址有我想要的文件的计算机）。我需要在启动 ftp 进程之前设置目录吗？

我在 SSIS 包中运行它，并且我没有使用 SSIS ftp 任务，因为如果找不到文件，我不希望失败。如果那里什么都没有，那就太好了。如果那里有东西，我想要一份。

（它在我的开发区域工作，现在，当我尝试从除 ftp 之外我真的无法访问的服务器获取文件时，我什么也得不到。请参阅[如何避免 SSIS FTP 任务失败时没有要下载的文件？](https://stackoverflow.com/questions/140850/the-best-way-for-a-ssis-ftp-task-to-not-fail-when-there-are-no-files-to-copy)对于较早的相关问题。）

**更新：** 下面列出 lcd 和 cd 的两个答案都是正确的。但是，我的示例仍然失败，直到我用正斜杠替换了反斜杠。换句话说，我的最终工作结果如下：

```
anonymous@ip address
username
prompt off
binary
lcd /destination directory
cd /source directory
mget *.*
quit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T23:08:27.217

您是否在寻找 LCD 和 CD 以在本地计算机上更改 LCD 目录？例如：

```
LCD c:\destination directory
mget c:\source directory\*.* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T23:06:43.320

在大多数 ftp 客户端中，您可以使用命令**cd**在服务器上设置工作目录，并使用命令**lcd**在客户端上设置工作目录。

但我不清楚你想做什么。

您是否尝试将 ftp 服务器上的文件移动或复制到 ftp 服务器上的另一个位置？据我所知，你不能用 ftp 做到这一点。如果您希望将文件从 ftp 服务器上的一个文件夹复制到另一个文件夹，那么我相信您会得到一个副本到本地系统，然后将它们重新上传到一个新文件夹。如果要移动文件，可以使用**重命名**命令。

# c# - 基于选定的下拉值重新绑定回发

> ID：357908
> 
> 赞同：0
> 
> 时间：2008-12-10T22:58:06.817
> 
> 标签：c#, asp.net, data-binding, drop-down-menu, postback

问候！

我在绑定到 XmlDataSources 的 FormView 中有一个 DropDownList：

```
<asp:FormView ID="MyFormView" runat="server" DataSourceID="MyXmlDataSource">
    <ItemTemplate>
        <h1><%# XPath("SomeNode")%></h1>
        <asp:Label ID="MyLabel" runat="server" AssociatedControlID="MyDdl" Text='<%# XPath("SomeOtherNode")%>' />
        <asp:DropDownList ID="MyDdl"
                          runat="server"
                          DataSourceID="MyDdlDataSource"
                          DataTextField="name"
                          DataValueField="value"
                          AutoPostBack="true"
                          OnSelectedIndexChanged="MyDdl_SelectedIndexChanged">
        </asp:DropDownList>
    </ItemTemplate>
</asp:FormView>
<asp:XmlDataSource ID="MyXmlDataSource" runat="server" XPath="Root/MainSection" />
<asp:XmlDataSource ID="MyDdlDataSource" runat="server" XPath="Root/MainSection/Areas/*" /> 
```

在页面的代码隐藏中，我有以下 OnLoad() 方法以及下拉列表的选择索引更改时的方法：

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);

    if (!IsPostBack)
    {
        string xml = GetMyXml(0); // default value
        MyXmlDataSource.Data = xml;
        MyDdlDataSource.Data = xml;
    }
}

protected void MyDdl_SelectedIndexChanged(object sender, EventArgs e)
{
    DropDownList l_MyDdl = FindControl("MyDdl") as DropDownList;
    int myVal;
    if (l_MyDdl != null)
        if (!Int32.TryParse(l_MyDdl.SelectedItem.Value, out myVal))
            myVal = 0;
    string xml = GetMyXml(myVal);
    MyXmlDataSource.Data = xml;
    MyDdlDataSource.Data = xml;
} 
```

当从下拉列表中选择不同的值并调用 SelectedIndexChanged 时，我无法获取下拉列表的值（FindControl 始终返回 null）以使用它重新绑定数据源。我怎样才能得到这个值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T23:11:43.187

因为您的下拉列表包含在另一个控件中，所以您可能需要一个递归查找控件。

[http://weblogs.asp.net/palermo4/archive/2007/04/13/recursive-findcontrol-t.aspx](http://weblogs.asp.net/palermo4/archive/2007/04/13/recursive-findcontrol-t.aspx)

# wix - 使用 WiX 管理配置文件

> ID：357911
> 
> 赞同：6
> 
> 时间：2008-12-10T22:58:59.950
> 
> 标签：wix

我有一个包含多个文件的应用程序，这些文件包含配置参数和其他随着用户使用应用程序而更改的数据。这些文件可以随着我的软件的较新版本而更改，但用户也可以修改它们（或者它们可能由应用程序本身更改）。基本上，我正在寻找一种解决方案来防止用户对这些文件的更改被覆盖，同时也是一种在用户升级我的软件时安装可能更新的文件的方法。

使用 *NIX 上的 RPM，您可以使用 %config 函数将文件定义为配置文件，然后 RPM 将重命名现有文件（如果存在）并在升级时安装新文件（可能不理想，但我可以活对于 WiX 有类似的东西）。

我想将我的配置文件安装到子目录甚至不同的名称（例如 default.cfg），然后使用`<CopyFile>`WiX 中的元素将文件复制到正确的位置。这样，默认文件将在安装时被删除并在升级时被覆盖，但实际用户文件将保持不变。不幸的是`<CopyFile>`，Windows Installer 仍然希望管理（和删除）目标文件。

我还考虑过在 WixUtilExtension 中使用 QtExec 操作来基本上执行“复制 default.cfg reallocation.cfg”，但这不太可行，而且有点破解。

处理这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T19:29:34.663

我的建议通常是将用户可编辑的内容放在单独的文件中，并通过应用程序而不是安装进行管理。这也意味着单独的文件是“用户内容”，应该被排除在安装之外。

我发现尝试以声明方式迁移用户数据看似困难。当您需要考虑所有这些情况的安装、卸载、修复、修补和回滚时，尝试在设置时执行此操作只会使情况变得更糟。

例如，RPM 行为对“修复”做了什么。将用户数据复制出来并用一个好的文件替换它？这可能是正确的 60% - 80% 的时间。和卸载，应该删除文件吗？如果用户只是要升级到下一个版本，那就很棘手了。

同样，最好让他们决定如何对配置进行调整。恕我直言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:09:45.450

我认为没有“干净”的方法可以做到这一点，因为 msi 项目必须能够通过设计完全卸载自己。我认为解决此问题的最佳方法是使用执行批处理文件并将配置文件更新逻辑放入该批处理文件的自定义操作。自定义操作如下所示（仅相关部分）：

```
<Directory Id="MYDIR" Name="MyDir">
    <Component Id="update.cmd" Guid="YOUR-GUID">
        <File Id="update.cmd" Name="update.cmd" KeyPath="yes" 
                Source="source\update.cmd" />
    </Component>
</Directory>

<CustomAction Id='RunUpdate' Directory='MYDIR' 
        ExeCommand='[SystemFolder]cmd.exe /c update.cmd' Return='ignore'/>

<InstallExecuteSequence>
    <Custom Action='RunUpdate' After='InstallFinalize'>NOT Installed</Custom>
</InstallExecuteSequence> 
```

# http - 如何分析 HTTP 转储？

> ID：357920
> 
> 赞同：3
> 
> 时间：2008-12-10T23:03:34.997
> 
> 标签：http, dump, computer-forensics

我有一个文件，它显然包含某种保持活动 HTTP 对话的转储，即多个 GET 请求和响应，包括标题、包含 HTML 页面和一些图像。但是，两者之间存在一些二进制垃圾 - 可能是 TCP 甚至 IP 级别的转储（我不确定如何确定它是什么）。

基本上，我需要提取传输的文件。有没有我可以使用的免费工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T23:05:04.447

使用[Wireshark](http://www.wireshark.org/)。

查看其转储的文件格式并将您的转储转换为它。它非常简单。它称为[pcap 文件格式](http://wiki.wireshark.org/Development/LibpcapFileFormat)。然后你可以在Wireshark中打开它没有问题，它应该能够识别内容。Wireshark 在各种 OSI 层（包括 TCP/IP/HTTP）上支持数十种甚至数百种通信格式，非常适合这种调试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T23:08:37.107

Wireshark 将在数据包级别进行分析。如果要在协议层面分析，我推荐Fiddler：[http ://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

它将向您显示发送的标头、响应以及解密 HTTPS 会话。还有一吨。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-11T01:14:20.147

Firefox 的 Firebug 插件中的 Net 选项卡可能有用。

# c# - 使用正则表达式查找特定格式的字段

> ID：357923
> 
> 赞同：1
> 
> 时间：2008-12-10T23:04:01.517
> 
> 标签：c#, .net, regex

在我正在开发的应用程序中，有人认为在 csv 文件的值中包含逗号是个好主意。所以我想要做的是选择这些值，然后从这些值中去掉逗号。但是我构建的正则表达式与任何东西都不匹配。

***正则表达式模式是：*** `.*,\"<money>(.+,.+)\",?.*`

我试图匹配的值是`2700, 2650 and 2600 in "2,700","2,650","2,600"`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T23:19:42.217

CSV 中允许使用逗号，如果您使用文本限定符（通常是双引号“），则不会导致问题。

以下是详细信息：[http ://en.wikipedia.org/wiki/Comma-separated_values](http://en.wikipedia.org/wiki/Comma-separated_values)

**关于正则表达式：**

此代码适用于您的示例数据（但只允许一个逗号，基本上是数千个分隔数字，最多 999,999）：

```
string ResultString = null;
try {
    ResultString = Regex.Replace(myString, "([0-9]{1,3})(?:(,)?([0-9]{3})?)", "$1$3");
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

它需要这个：

> 测试 12,205 26,000 测试。我要匹配的值是 "2,700","2,650","2,600" 中的 2700、2650 和 2600

并产生这个：

> 测试 12205 26000 测试。我试图匹配的值是 "2700","2650","2600" 中的 2700 2650 和 2600

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T23:29:55.410

感谢瑞恩的回答。我应该多克制自己的脾气。尽管如此，CSV 中的逗号还是不分隔值？

在办公室四处询问后，我得到了一个免费的正则表达式设计器应用程序，我用它来构建我需要的模式。该应用程序是[Rad Software 正则表达式设计器](http://www.radsoftware.com.au/regexdesigner/)

哦，为了回答的目的，我得出的模式是： `\"(?<money>[0-9,.$]*)\"`

**编辑：最终安德烈**

哇。完全忘记了这个问题。我更多地使用正则表达式，并提出了一个可以匹配我需要的所有内容的表达式。正则表达式是：

`\"([0-9.$]+(,[0-9.]+)+)\"`

该正则表达式能够匹配我抛出的双引号内的任何十进制字符串。

# c# - 对构造函数进行单元测试重要吗？

> ID：357929
> 
> 赞同：90
> 
> 时间：2008-12-10T23:06:08.767
> 
> 标签：c#, .net, unit-testing, constructor

我应该对构造函数进行单元测试吗？假设我有一个这样的构造函数：

```
IMapinfoWrapper wrapper;
public SystemInfo(IMapinfoWrapper mapinfoWrapper)
{
    this.wrapper = mapinfoWrapper;
} 
```

我需要为此构造函数编写单元测试吗？我没有任何包装变量的吸气剂，所以我不需要测试它。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-12-10T23:14:56.940

单元测试是关于测试对象的公共状态、行为和交互。

如果您只是在构造函数中设置一个私有字段，那么有什么要测试的？

不要费心对简单的访问器和修改器进行单元测试。这很愚蠢，对任何人都没有帮助。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-12-10T23:10:25.483

是的。如果您的构造函数中有逻辑，则应该对其进行测试。简单地设置属性不是逻辑 IMO。条件、控制流等 IS 逻辑。

**编辑：** 如果需要该依赖项，您可能应该测试 IMapinfoWrapper 何时为空。如果是这样，那么这就是逻辑，你应该有一个测试来捕获你的 ArgumentNullException 或其他什么......你的测试是定义代码行为方式的规范。如果它抛出 ArgumentNullException，那么应该在测试中指定。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-11T21:02:03.383

问：如果你在构造函数中设置一个成员变量，你为什么要设置它。

答：因为您有一个失败的单元测试，只能通过在构造函数中设置它才能通过。

如果您使用这种逻辑，您只编写代码以使单元测试通过（测试驱动开发），那么您已经有了问题的答案。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-10T23:09:37.263

不会。它的功能将由该类的所有其他单元测试进行测试。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-02-09T16:16:19.367

你绝对应该测试构造函数。如果你有一个默认构造函数，你应该测试它是否可以被调用。如果以后类被改变了——也许它变成了一个单例或者默认构造函数被删除以支持一个需要参数的类怎么办？在这种情况下，测试应该失败以提醒该更改（以便可以修复类或测试以满足新要求）。

默认构造函数的存在是应该进行测试的要求。即使构造函数所做的只是设置将在别处测试的私有成员，也应该测试存在无参数构造函数的事实。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-02-20T19:53:52.360

这取决于。

我不会为您给出的示例如此简单的事情编写专用的构造函数测试。

但是，如果您在构造函数中进行了逻辑测试，例如参数验证，那么绝对可以。尽管像原始海报一样，如果可能的话，我不会在构造函数中进行任何工作，但通常必须进行参数验证。在这种情况下，不可避免地要阻止构造函数做*一些*工作。如果构造函数中存在逻辑，则总是有可能出错，因此我将其视为任何其他方法调用并适当地对其进行测试。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-06-16T10:33:39.300

我正在测试包含逻辑的构造函数——例如验证或有条件地设置私有状态。验证错误最终会导致构造函数抛出异常。成功的执行最终会创建一个对象，该对象根据构造函数中设置的状态表现出特定的行为。无论哪种方式，它都需要测试。但是构造函数测试很无聊，因为它们看起来都一样——调用构造函数，做出断言。测试方法声明通常比整个测试逻辑占用更多的空间......所以我写了一个简单的测试库来帮助为构造函数编写声明性测试：[如何在 C# 构造函数中轻松测试验证逻辑](http://codinghelmet.com/articles/constructor-tests)

这是一个示例，其中我在一个类的构造函数上尝试了七个测试用例：

```
[TestMethod]
public void Constructor_FullTest()
{

    IDrawingContext context = new Mock<IDrawingContext>().Object; 

    ConstructorTests<Frame>
        .For(typeof(int), typeof(int), typeof(IDrawingContext))
        .Fail(new object[] { -3, 5, context }, typeof(ArgumentException), "Negative  length")
        .Fail(new object[] { 0, 5, context }, typeof(ArgumentException), "Zero length")
        .Fail(new object[] { 5, -3, context }, typeof(ArgumentException), "Negative width")
        .Fail(new object[] { 5, 0, context }, typeof(ArgumentException), "Zero width")
        .Fail(new object[] { 5, 5, null }, typeof(ArgumentNullException), "Null drawing context")
        .Succeed(new object[] { 1, 1, context }, "Small positive length and width")
        .Succeed(new object[] { 3, 4, context }, "Larger positive length and width")
        .Assert();

} 
```

通过这种方式，我可以为我的构造函数测试所有相关案例，而无需输入太多内容。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-02-20T19:45:46.710

在许多受 FDA 监管的环境中，必须对更关键的代码进行 100% 测试……包括类的构建。因此，有时需要对构造函数进行测试，而不管是否要测试它们。此外，使用静态分析工具的公司将需要确保一个类的所有数据成员都正确初始化，以便没有错误，尽管代码可以顺利运行并且没有错误。通常数据成员初始化是在构造函数中完成的……只是值得深思。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-15T01:55:59.727

我认为这个问题的答案是“是”。

那里有很多代码可怕地假设一个初始化的对象状态，而不是一个空引用——通常是在构造函数中没有明确分配值的时候。

当初始化的公共成员值发生更改时，我很高兴让构造函数测试中断以提醒我。这是关于防御性测试的——我很务实，并且比没有测试更快乐，当它们被证明无用或无用时将其删除。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-10T23:22:40.980

我相信100%的覆盖率。此外，100% 的覆盖率不是通过简单地通过模拟事物或设置和获取事物来测试简单的交互，而是通过更多的集成/验收测试来检查功能。因此，如果您最终编写了非常好的集成/验收测试，则应该调用您的所有构造函数（以及简单的方法，例如 setter 和 getter）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-02-20T19:50:05.517

除非开发人员确保不能更改任何状态逻辑，否则测试访问器和修改器也是必要的。例如，如果使用 Singleton 的设计模式，则通常会使用访问器或属性，并且如果未初始化类，则从访问器完成，因为构造函数是私有的。在 C++ 中，可以将它们的函数设为 const 或 static，其中类的数据成员不能更改。（注意：即使使用 static 也有一点风险，因为这些变量通常是全局的。）但是，如果没有测试，如果有人没有使用预防措施，你怎么能保证 100% 准确，写的东西不会成为失败时间？维护并非万无一失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-10T23:31:31.757

的实例的什么行为`SystemInfo`取决于 的值`wrapper`？

如果有任何问题（例如空值导致损坏），那么我建议编写描述每种情况的场景并使用它们来驱动适当单元测试的定义。

如果所有场景最终都依赖于 的私有实例的状态或行为`IMapinfoWrapper`，那么我建议改为在该类上编写单元测试。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T12:48:52.747

除非您正在编写编译器，否则不会，因为您只会测试编译器是否可以生成代码来执行分配，这通常是没有意义的。

现在，在更常见的情况下，如果您想用包装器做其他事情，那么也许有一点。例如，如果您尝试传递空值，则可以抛出 ArgumentNullException，理论上，这可以进行单元测试。即使这样，测试的价值也很小。

就个人而言，我几乎从不明确测试构造函数。如果它们足够复杂以至于需要测试，我倾向于觉得代码有点臭。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-19T10:03:45.910

如果构造函数包含一些逻辑，比如初始化一个类，我认为你应该测试这个构造函数。或者您可以与开发人员交谈，将初始化放在构造函数中会降低被测代码的可测试性。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-12-10T23:37:49.700

单元测试是关于检查执行路径，通常称为[循环复杂性](http://www.lexjansen.com/pharmasug/2004/FDACompliance/FC06.pdf)

如果你没有可供选择的路径，没有 if，没有循环，没有 GOTO (=P) 它不是很有用

# apache - 使用 AuthType Digest 跨子域对用户进行一次身份验证的示例？

> ID：357939
> 
> 赞同：5
> 
> 时间：2008-12-10T23:09:35.407
> 
> 标签：apache, authentication, subdomain, single-sign-on, digest

我有一个域将由一小群私人访问。所以我想通过身份验证来控制访问。

该域安装了一组应用程序，每个应用程序都有自己的子域。例如：domain.com、app1.domain.com、app2.domain.com、app3.domain.com

我希望有一个单点登录解决方案，这样他们就不必为每个应用程序验证自己。此外，应用程序是用不同的语言（PHP、Python 和 Perl）编写的，因此通过 Apache 模块对用户进行身份验证是理想的选择。

我是消化身份验证的新手，但这似乎是一个很好的解决方案。我曾经`htdigest`创建我的用户。我已经配置了我的域和子域（见下文）。

如果我转到域或任何子域，它将提示输入用户名和密码。如果我输入正确的用户名和密码，它将对我进行身份验证并加载页面。但是，如果我转到另一个子域，它会要求我再次输入用户名和密码。如果我输入相同的用户名和密码，它将起作用。

所以密码文件没问题，认证也没问题，但问题似乎出在`AuthDigestDomain`.

我在网上搜索了一个在多个域上使用摘要身份验证的示例，但我找不到解决我的问题的具体示例。

我希望这里有人可以提供帮助。我是否将相同的身份验证信息放入每个`Directory`? 我应该使用`Directory`or `Location`or`Files`吗？我错过了什么吗？

提前致谢！

下面是我的 domain.com 的 Apache 配置示例：

```
<Directory /var/www>
  AuthType Digest
  AuthName "realm"
  AuthDigestAlgorithm MD5
  AuthDigestDomain / http://domain.com/ http://app1.domain.com/ http://app2.domain.com/ http://app3.domain.com/
  AuthDigestNcCheck Off
  AuthDigestNonceLifetime 0
  AuthDigestQop auth
  AuthDigestProvider file
  AuthUserFile /etc/apache2/.htpasswd-digest
  AuthGroupFile /dev/null
  Require valid-user
</Directory> 
```

以下是 app1.domain.com 的示例：

```
<Directory /var/lib/app1>
  AuthType Digest
  AuthName "realm"
  AuthDigestAlgorithm MD5
  AuthDigestDomain / http://domain.com/ http://app1.domain.com/ http://app2.domain.com/ http://app3.domain.com/
  AuthDigestNcCheck Off
  AuthDigestNonceLifetime 0
  AuthDigestQop auth
  AuthDigestProvider file
  AuthUserFile /etc/apache2/.htpasswd-digest
  AuthGroupFile /dev/null
  Require valid-user
</Directory> 
```

更令人困惑的是，这在使用 IE6 时有效，但不适用于 Firefox 或 Chrome。是客户端没有正确发送身份验证，还是服务器没有发送正确的凭据？

我也一直在阅读[RFC 2617](http://www.faqs.org/rfcs/rfc2617.html)并使用 PHP 编写身份验证标头以确保请求/响应质询是正确的。这根本没有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-30T04:13:58.613

大多数浏览器不尊重 Digest “域”指令，并且不会重新发送其他 URI 的凭据。据我所知，Opera 是唯一支持它的浏览器。

对于 Opera，服务器必须对域列表中的每个 URI 使用相同的“领域”字符串进行响应。换句话说，如果 domain="/test /example"，服务器需要在这两个 URI 的 WWW-Authenticate 标头中发送“Test Realm - example.com”。我认为 Opera 这样做是因为它存储 H(A1) 而不是实际密码以确保安全。阅读 RFC2617 了解更多信息。

这是我对这个问题的跨浏览器解决方案：http: [//travisce.com/arest/](http://travisce.com/arest/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T12:56:33.073

我自己没有这样的经验。但我只是看了一下[Apache 文档](http://httpd.apache.org/docs/2.2/mod/mod_auth_digest.html)，发现了这个：

> AuthDigestNonceLifetime 指令控制服务器随机数的有效时间。[...] 如果秒小于 0，则随机数永不过期。

所以在我看来，0 秒（您正在使用的值）要么是非法的，要么是真的告诉 Apache 在 0 秒后使 nonce 过期，这将准确地解释你得到的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T07:14:20.517

AuthDigestDomain 上的通配符有帮助吗？

```
    *.domain.com
```

# c# - 如何将 .NET 委托附加到 mshtml 事件？

> ID：357949
> 
> 赞同：1
> 
> 时间：2008-12-10T23:11:14.840
> 
> 标签：c#, .net, javascript, events, mshtml

我正在开发 Internet Explorer 的扩展 (BHO)，并且无法将 .NET 委托附加到 mshtml 对象以捕获 DOM 事件。

我已经尝试使用由 IHTMLElementEvents2_Event, ... 接口发布的事件，并且它有效，但前提是我为要捕获其事件的 DOM 元素指定了正确的类型。我还需要在代码中指定元素的类型，并且这种技术不允许捕获自定义 DOM 事件。

我也尝试过使用[HtmlEventProxy 类](http://www.codeproject.com/KB/dotnet/NetHtmlEventHandler.aspx)，它通过 IHTMLElement2.attachEvent 方法将 IDispatch 对象附加到 DOM 元素，但这对我来说根本不起作用。当我尝试访问[该线程](https://stackoverflow.com/questions/110015/not-getting-event-arguments-in-ihtmlelement-event-handler)中描述的事件对象时，在访问 DOM 元素的文档属性时遇到了挂起。

那么如何在不需要特殊情况下每种元素和每种事件的情况下将事件处理程序附加到 DOM 元素？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T12:19:30.663

你可以试试这段代码：

```
[ComVisible(true)]
public class Foo
{
  public Foo(HtmlDocument doc) 
  {
    IHTMLDocument2 doc2 = (IHTMLDocument2)doc.DomDocument;
    doc2.onkeydown = this;
  }

  [System.Runtime.InteropServices.DispId(0)]
  public void EventHandler()
  {
    IHTMLWindow2 win2 = (IHTMLWindow2)_doc.Window.DomWindow;
    IHTMLEventObj e = win2.@event;

    if (e.keyCode == (int)Keys.F5)
    {
      // ...
    }
  }
} 
```

# excel - 如何获取对数组中单元格的引用，只知道它的值？

> ID：357953
> 
> 赞同：0
> 
> 时间：2008-12-10T23:12:49.143
> 
> 标签：excel, excel-formula

我的工作表中有一个包含以下值的列数组：11、15、5、7、2。我想获取对包含值 15 的单元格的引用。我将如何去做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T23:28:24.353

如果您的数组是 A2:A13，这里有一个公式可以让您获得对值为 15 的单元格的引用...

索引（A2：A13，匹配（15，A2：A13））

# reporting-services - 我应该将 SQL Reporting Services 2008 用于我的报告引擎吗？

> ID：357955
> 
> 赞同：1
> 
> 时间：2008-12-10T23:13:06.413
> 
> 标签：reporting-services

我想使用 SQL Reporting Services 2008 来生成我的报告，但我想使用我自己的 UI 来指定报告类型、列、参数和所有内容。我希望能够采用这些标准，然后向 SSRS 发起异步请求，并将报告通过电子邮件发送给我。这可能吗？我不想在研究 SQL Reporting Services 2008 的道路上一路走下去，却发现它没有做我需要它做的事情。此外，我将有大量需要从中提取数据的数据库分区。有些报告只需要从其中一个中提取数据，但其他报告实际上可能需要跨越不同的数据库。向 SSRS 发送报告请求以指定从哪个服务器名称/数据库中提取数据时是否有可能？是否可以告诉它从多个数据库中获取数据并将其组合起来？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T00:06:27.427

与 Crystal Reports、ActiveReports 和其他报表生成器一样，SSRS 在每个报表背后都有两个基本元素：SQL 查询和报表布局。无论您对 SQL 使用什么工具——它可以是报表中的内联 SQL 或对存储过程的调用——它都将是同一个查询。只要您可以预先指定多个数据库，就可以了。

您可以进行参数化查询，因此系统会提示用户输入相关过滤器（客户 ID、产品组、日期范围等）。

进行报表布局与其他工具类似——您将控件（如标签）拖放到报表上，并设置它们的格式。

SSRS 确实提供了许多分发报告的选项，包括电子邮件。您可以将报表嵌入到 ASP.Net 网页中，将其保留在报表服务器站点上供用户浏览，在凌晨运行并缓存它，这样每个用户都不必等待很长时间查询运行。

这是一个很棒的工具。我认为值得您尝试一下。我会等待创建自定义 UI，直到您用尽了该工具固有的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T00:13:19.037

SSRS 在设计时并未考虑到这种情况，因此我不确定任何开箱即用的报告解决方案都会为此提供优雅的解决方案。虽然 SSRS 可以满足您的要求（以及其他要求），但它绝不是快速或容易的。您似乎正在寻找具有动态数据源的高级临时解决方案。我首先会质疑需求并确定业务场景是否真的证明了这种实现是合理的。我会权衡自定义构建解决方案与使用 BI 报告解决方案的学习曲线。您可能会发现自己构建一些东西更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T00:22:51.483

我认为异构动态数据库混搭可能是最具挑战性的部分。

根据您的可扩展性要求，包含该部分的地方和报告编写者是 Access。（鸭子！来了！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T15:36:04.423

我认为您可能在某种程度上为自己的背部创建了一个杆，因为 RS 附带了一些用于创建报告的接口。

请注意，最终产品是一个 rdl 文件，它只不过是 xml，所以如果你真的喜欢，你可以手动编写它们。

支持多个数据源，但不支持将它们组合在单个控件/图表/等上，因此如果您想这样做，您需要在报告请求之前从您的数据源之一配置自己的跨数据库功能.

# haskell - “结缘”的解释

> ID：357956
> 
> 赞同：47
> 
> 时间：2008-12-10T23:14:07.813
> 
> 标签：haskell, functional-programming, tying-the-knot

在阅读与 Haskell 相关的内容时，我有时会遇到“打结”的表达，我想我理解*它*的作用，但不*知道如何*。

那么，对这个概念有什么好的、基本的和简单易懂的解释吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-26T16:35:08.107

打结是解决循环数据结构问题的方法。在命令式语言中，您首先创建一个非循环结构，然后返回并修复指针以添加循环性，从而构造一个循环结构。

假设您想要一个包含元素“0”和“1”的二元素循环列表。似乎不可能构造，因为如果您创建“1”节点然后创建“0”节点指向它，那么您无法返回并修复“1”节点以指向“0”节点. 所以你有一个先有鸡还是先有蛋的情况，两个节点都需要存在才能创建。

这是在 Haskell 中的操作方法。考虑以下值：

```
alternates = x where
   x = 0 : y
   y = 1 : x 
```

在非惰性语言中，由于未终止的递归，这将是一个无限循环。但是在 Haskell 中，惰性求值是正确的：它生成一个包含两个元素的循环列表。

要了解它在实践中是如何工作的，请考虑在运行时会发生什么。惰性求值的通常“thunk”实现将未求值表达式表示为包含函数指针和要传递给函数的参数的数据结构。在评估 this 时，thunk 将被实际值替换，以便将来的引用不必再次调用该函数。

当您获取列表的第一个元素时，“x”被评估为一个值（0，&y），其中“&y”位是指向“y”值的指针。由于 'y' 尚未被评估，这目前是一个 thunk。当您获取列表的第二个元素时，计算机会跟随从 x 到此 thunk 的链接并对其进行评估。它的计算结果为 (1, &x)，或者换句话说，是一个指向原始“x”值的指针。所以你现在在内存中有一个循环列表。程序员不需要修复反向指针，因为惰性求值机制会为您完成。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-13T06:40:57.480

这不是您所要求的，并且与 Haskell 没有直接关系，但 Bruce McAdam 的论文[That About Wraps It Up](http://www.lfcs.inf.ed.ac.uk/reports/97/ECS-LFCS-97-375/)以相当广的广度和深度探讨了这个主题。Bruce 的基本思想是使用称为 WRAP的**显式打结运算符，而不是在 Haskell、OCaml 和其他一些语言中自动完成的****隐式**打结。这篇论文有很多**有趣的例子**，如果你对打结感兴趣，我想你会对这个过程有更好的感觉。

# c++ - std::ifstream::open() 不工作

> ID：357963
> 
> 赞同：1
> 
> 时间：2008-12-10T23:15:36.063
> 
> 标签：c++, stl, iostream

我正在开发一款游戏的原型，并且某些游戏规则将在 ini 文件中定义，以便游戏设计师可以调整游戏参数而无需我的帮助，除了重新编译。这就是我目前正在做的事情：

```
std::ifstream stream;
stream.open("rules.ini");

if (!stream.is_open())
{
    throw new std::exception("Rule file could not be opened");
}

// read file contents here

stream.close(); 
```

但是，我的流从未成功打开。在调试期间深入研究 STL 源代码会发现 _getstream()（如 stream.c 中定义的）不断返回 NULL，但我就是不知道为什么会这样。帮助，有人吗？

编辑：Rules.ini 与 .exe 文件位于同一目录中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T00:37:14.167

您假设**工作目录**是可执行文件所在的目录。这是一个错误的假设。

您的可执行文件可以从任何工作目录运行，因此在软件中硬编码相对路径通常不是一个好主意。

如果您希望能够访问与可执行文件位置相关的文件，则应首先确定可执行文件的路径并从中创建一个完全限定的路径。

您可以通过检查`argv[0]`传递给`main()`. 或者，如果您使用的是 Windows，则可以[`GetModuleFileName()`](http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx)通过将 NULL 作为第一个参数传递来获取它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T23:21:49.267

您的开放流的范围是否正确。

“rules.ini”不是一个完整的路径，所以它必须是相对的，所以它是相对的。或者你需要在那里使用完整路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T01:02:28.533

（这里是疯狂的假设）您正在使用视觉工作室。在调试期间，您的程序将在项目目录中搜索“rules.ini”

但是，如果您尝试从“myproject/debug/myexe.exe”执行程序，它应该可以正常运行，因为它将在“/debug”中搜索 rules.ini

就像提到的那样，您应该指定完整路径，因为相对路径往往会导致错误

# python - 康威生命游戏的 Python 实现问题

> ID：357968
> 
> 赞同：0
> 
> 时间：2008-12-10T23:17:02.643
> 
> 标签：python

我目前正在制作[康威的生命游戏，](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)但被卡住了。我的代码不起作用。

当我在 GUI 中运行我的代码时，它说：

```

[[0 0 0 0]
 [0 1 1 0]
 [0 1 0 0]
 [0 0 0 0]]

回溯（最近一次通话最后）：
  文件“C:\Users\Documents\Physics\Python\MainProject\conway.py”，第 53 行，在
    b= apply_rules(a)
  文件“C:\Users\Documents\Physics\Python\MainProject\conway.py”，第 14 行，在 apply_rules
    邻居=number_neighbours(universe_array,iy,ix)
  文件“C:\Users\Documents\Physics\Python\MainProject\conway.py”，第 36 行，位于 number_neighbours
    邻居+=1
UnboundLocalError：分配前引用的局部变量“邻居”

```

这是我的代码：

```
'''If a cell is dead at time T with exactly three live neighbours, the cell will be alive at T+1
If a cell is alive at time T with less than two living neighbours it dies at T+1
If a cell is alive at time T with more than three live neighbours it dies at T+1
If a cell is alive at time T with exactly two or three live neighbours it remains alive at T+1'''
import numpy

def apply_rules (universe_array):
    height, width = universe_array.shape
    # create a new array for t+1
    evolved_array = numpy.zeros((height, width),numpy.uint8)
    for iy in range(1, height-1):
        for ix in range(1,width-1):
            neighbours=number_neighbours(universe_array,iy,ix)
            if universe_array[iy,ix]==0 and neighbours==3:
                evolved_array[iy,ix]==1
            elif universe_array[iy,ix]==1 and neighbours<2:
                evolved_array[iy,ix]==0
            elif universe_array[iy,ix]==1 and neighbours>3:
                evolved_array[iy,ix]==0
            elif universe_array[iy,ix]==1 and neighbours==2 or neighbours==3:
                evolved_array[iy,ix]=universe_array[iy,ix]

    return evolved_array

def number_neighbours(universe_array,iy,ix):
    neighbours=0 #fixed this line,thanks:)
    if universe_array[iy-1,ix-1]==1:
            neighbours+=1
    if universe_array[iy,ix-1]==1:
            neighbours+=1
    if universe_array[iy+1,ix-1]==1:
            neighbours+=1
    if universe_array[iy-1,ix]==1:
            neighbours+=1
    if universe_array[iy+1,ix]==1:
            neighbours+=1
    if universe_array[iy-1,ix+1]==1:
            neighbours+=1
    if universe_array[iy,ix+1]==1:
            neighbours+=1
    if universe_array[iy+1,ix+1]==1:
            neighbours+=1
    else:
        neighbours=neighbours
    return neighbours

if __name__ == "__main__":
    a = numpy.zeros((4,4),numpy.uint8)
    a[1,1]=1
    a[1,2]=1
    a[2,1]=1
    print a
    b= apply_rules(a)
    print b 
```

我是 Python 的初学者，我不知道如何修复错误。我有点困惑`import "neighbours"`，`function "apply_rules"`这是正确的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-10T23:44:47.923

*好吧，我想您对编程本身*也很陌生，否则您在解释那个简单的错误消息时应该没有任何问题。

我帮你剖析一下：

*   首先，按调用顺序显示项目文件的所有“当前”行号。
*   然后，它会显示发生错误的函数：`number_neighbours`
*   然后，它会显示包含错误的行的内容：`neighbours+=1`
*   最后，它会告诉您该行的问题所在：`UnboundLocalError: local variable 'neighbours' referenced before assignment`

这是什么意思？让我们看看`+=`操作符做了什么：它为 的当前值添加了一些东西`neighbours`。这意味着它读取当前值，向其中添加一些内容，最后将其存储回来。关于变量，“阅读”被称为“参考”。

的当前值是`neighbours`多少？好吧，它以前从未被使用过，所以它没有任何价值——从来没有给它分配过价值。添加一些“没有价值”的东西并不是一件明智的事情。我猜你希望它的值为 0，但你必须告诉你的解释器。为此，请在函数开头添加以下语句： `neighbours = 0`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T23:39:28.090

您正在尝试增加一个尚不存在的变量。如果 Python 不知道是什么，它就不能增加一些东西。尝试在 def number_neighbours 函数的顶部添加以下行。

```
neighbours = 0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-10T23:20:30.330

粗略一瞥表明您的`number_neighbors`索引已关闭。

此外，您永远不会初始化`neighbors`.

**回复评论：**

```
def number_neighbours(universe_array,iy,ix):
    if universe_array[iy,ix-1]==1:
        neighbours+=1
    if universe_array[iy,ix-1]==1:
        neighbours+=1
    if universe_array[iy+1,ix-1]==1:
        neighbours+=1 
```

你说，，`neighbors +=1`这意味着加1 `neighbors`，但你从来没有告诉它从0开始，所以它不知道加1到什么。

另外，请注意第一行和第三行完全相同。我很确定这不是你想要的。这就是我所说的“您的索引已关闭”的意思。

**对评论 2 的响应：** `apply_rules`有几行您想为某物（即“=”）分配值，但您使用“==”代替。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T23:24:28.760

这是一个非常低级的懒惰问题，但是您的 number_neighbours 函数已损坏，它检查了 Universe_array[iy,ix-1] 两次（因此省略了它应该进行的检查）。

# css - 组合 CSS 属性

> ID：357969
> 
> 赞同：0
> 
> 时间：2008-12-10T23:17:08.353
> 
> 标签：css, xhtml, refactoring

我正在尝试结合我的一些 CSS，这是一个简单的问题，但我有点麻烦，我有这个代码：

```
h2.post-title, h2.post-title a{
    display:block;
    background-color:#000;
    padding:3px;
    color:#ffffff;
    text-decoration:none;
    text-transform:uppercase;
    font:lighter 130% Georgia, Arial;
} 
```

我需要在那里同时拥有这两个选择器吗？我唯一一次使用`h2.post-title`它将是一个链接。任何建议，我尝试删除第一个，但它变得巨大。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T23:23:57.857

如果您删除 h2 字体样式，它将恢复为相当大的默认字体大小。您可以单独设置它：

```
h2.post-title {
    font-size:130%;
} 
```

但这比简单地将两个选择器设置为相同的样式会占用更多的空间。我的建议——保持原样，除非你有充分的理由改变它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-10T23:29:51.027

问题是“h2.post-title a”仅适用于代码的 <a> 元素。浏览器在 <h2>-tag 上使用标准 css！

让我们看看你的 HTML：

```
<h2 class="post-title"><a href="#">Clickable title</a></h2> 
```

<h2> 和 <a>-tag 都需要规则。为此，您需要在样式表中同时包含*h2*和*a （如您所述）。*

一个解决方案可能是删除 <h2> 的默认样式，通过您可以在 Internet 上找到的许多[重置 css规则中的一些。](http://www.google.no/search?client=opera&rls=nb&q=reset+css&sourceid=opera&ie=utf-8&oe=utf-8)

另一种解决方案是将 class-spesification 从“h2”移动到“a”（并且样式只是 CSS 中的“a.post-title”属性）：

```
<h2><a class="post-title" href="#">Clickable title</a></h2> 
```

或者您可以完全删除 <h2>-tag，只需打印出 <a>。但这可能会破坏您的语义。

# python - Python 有类似 Java 的匿名内部类的东西吗？

> ID：357997
> 
> 赞同：45
> 
> 时间：2008-12-10T23:26:57.413
> 
> 标签：python, class, anonymous-class

在 Java 中，您可以使用匿名内部类内联定义一个新类。当您只需要重写类的单个方法时，这很有用。

假设您要创建一个`OptionParser`仅覆盖单个方法的子类（例如`exit()`）。在 Java 中，您可以编写如下内容：

```
new OptionParser () {

    public void exit() {
        // body of the method
    }
}; 
```

这段代码创建了一个匿名类，`OptionParser`它只扩展和覆盖该`exit()`方法。

Python中有类似的成语吗？在这些情况下使用哪个成语？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-10-12T13:53:02.040

您可以使用[`type(name, bases, dict)`](http://docs.python.org/library/functions.html#type)内置函数动态创建类。例如：

```
op = type("MyOptionParser", (OptionParser,object), {"foo": lambda self: "foo" })
op().foo() 
```

由于 OptionParser 不是新式类，因此您必须明确地包含`object`在基类列表中。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-10T23:35:43.170

Java 主要使用匿名类来模拟闭包或简单的代码块。由于在 Python 中您可以轻松地传递方法，因此不需要像匿名内部类那样笨拙的构造：

```
def printStuff():
   print "hello"

def doit(what):
   what()

doit(printStuff) 
```

编辑：我知道这不是这种特殊情况所需要的。我刚刚描述了Java中匿名内部类最常见的问题的最常见python解决方案。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-11T00:01:54.643

您可以通过三种方式完成此操作：

1.  适当的子类（当然）
2.  您使用对象作为参数调用的自定义方法
3.  （您可能想要什么）- 向对象添加新方法（或替换现有方法）。

选项 3 的示例（编辑以删除“新”模块的使用——它已被弃用，我不知道）：

```
import types
class someclass(object):
    val = "Value"
    def some_method(self):
        print self.val

def some_method_upper(self):
    print self.val.upper()

obj = someclass()
obj.some_method()

obj.some_method = types.MethodType(some_method_upper, obj)
obj.some_method() 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-11T00:05:13.610

好吧，类是第一类对象，所以如果你愿意，你可以在方法中创建它们。例如

```
from optparse import OptionParser
def make_custom_op(i):
  class MyOP(OptionParser):
    def exit(self):
      print 'custom exit called', i
  return MyOP

custom_op_class = make_custom_op(3)
custom_op = custom_op_class()

custom_op.exit()          # prints 'custom exit called 3'
dir(custom_op)            # shows all the regular attributes of an OptionParser 
```

但是，真的，为什么不在正常级别定义类呢？如果您需要自定义它，请将自定义作为参数放入`__init__`.

（编辑：修复代码中的输入错误）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-11T15:06:37.393

Python 不直接支持这一点（匿名类），但由于其简洁的语法，它并不是真正必要的：

```
class MyOptionParser(OptionParser):
    def exit(self, status=0, msg=None):
        # body of method

p = MyOptionParser() 
```

唯一的缺点是您将 MyOptionParser 添加到您的命名空间，但正如 John Fouhy 指出的那样，如果您要多次执行此操作，您可以将其隐藏在函数中。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-10T23:54:47.560

Python 可能有更好的方法来解决您的问题。如果您可以提供有关您想要做什么的更具体的详细信息，那将有所帮助。

例如，如果您需要更改在代码中的特定点调用的方法，您可以通过将函数作为参数传递来实现（函数是 python 中的第一类对象，您可以将它们传递给函数等）。您还可以创建匿名`lambda`函数（但它们仅限于单个表达式）。

此外，由于 python 非常动态，您可以在创建对象后更改对象的方法`object.method1 = alternative_impl1`，虽然它实际上有点复杂，请参阅[gnud 的答案](https://stackoverflow.com/questions/357997/python-does-have-something-like-anonymous-inner-classes-of-java#358055)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-10T23:49:53.593

在 python 中，你有匿名函数，使用 lambda 语句声明。我不太喜欢它们——它们的可读性不强，功能有限。

但是，您正在谈论的内容可能会以完全不同的方法在 python 中实现：

```
class a(object):
  def meth_a(self):
    print "a"

def meth_b(obj):
  print "b"

b = a()
b.__class__.meth_a = meth_b 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-30T10:28:57.763

您始终可以按变量隐藏类：

```
 class var(...):
     pass
 var = var() 
```

代替

```
 var = new ...() {}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-23T06:21:41.737

这就是你在 Python 3.7 中要做的事情

```
#!/usr/bin/env python3
class ExmapleClass:
    def exit(self):
        print('this should NOT print since we are going to override')

ExmapleClass= type('', (ExmapleClass,), {'exit': lambda self: print('you should see this printed only')})()
ExmapleClass.exit() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-10T13:36:56.553

我通常在 python3 中使用内部类来执行此操作

```
class SomeSerializer():
    class __Paginator(Paginator):
        page_size = 10

    # defining it for e.g. Rest:
    pagination_class = __Paginator

    # you could also be accessing it to e.g. create an instance via method:
    def get_paginator(self):
        return self.__Paginator() 
```

当我使用双下划线时，这将“修改”的想法与内部类混合在一起，从外部您仍然可以使用`SomeSerializer._SomeSerializer__Paginator`, 和子类访问内部类，但是 SomeSerializer.__Paginator 将不起作用，这可能是也可能不是你的愿望您希望它更“匿名”。

但是，如果您不需要修改，我建议使用带有单个下划线的“私有”表示法。

In my case, all I need is a fast subclass to set some class attributes, followed up by assigning it to the class attribute of my RestSerializer class, so the double underscore would denote to "not use it at all further" and might change to no underscores, if I start reusing it elsewhere.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-25T23:24:20.687

Being perverse, you could use the throwaway name `_` for the derived class name:

```
class _(OptionParser):

    def exit(self):
        pass  # your override impl 
```******`******