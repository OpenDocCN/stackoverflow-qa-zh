# StackOverflow 问答 11089000-11089999

# regex - 如何提取某个单词之后的数据？

> ID：11089002
> 
> 赞同：-9
> 
> 时间：2012-06-18T18:40:35.517
> 
> 标签：regex, perl, regex-greedy

[交叉张贴在 Perlmonks](http://perlmonks.org/?node_id=976880)

```
$String = "hello I went to the store yesterday and the day after and the day after"; 
```

我只想打印单词`i went to the store`。我尝试了两种方法，都没有奏效：

```
if ($String =~ /hello/i) {
    until ($String =~ /yesterday/i) {
        print "Summary: $'"
    }
} 
```

这打印了整个字符串。我使用了 $' 函数，但它占用了太多数据。我该如何限制它？

如果我只想打印“昨天和后天”怎么办？我怎样才能开始匹配中间的脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:35:46.217

首先，以前的答案使用`$1`，但我讨厌在不需要时使用全局变量。这里没有必要。

其次，以前的答案假设您不想捕获换行符，但您没有说任何类似的话。

使固定：

```
if (my ($match) = $s =~ /hello (.*?) yesterday/s) {
   say $match;
} 
```

最后，使用`?`贪婪修饰符可能会导致意外（特别是如果您在一个模式中使用多个）。如果给出

```
hello foo hello bar yesterday 
```

上面的正则表达式将捕获

```
foo hello bar 
```

如果你想

```
bar 
```

改用以下内容：

```
if (my ($match) = $s =~ /hello ((?:(?!yesterday).)*) yesterday/s) {
   say $match;
} 
```

`(?:(?!STRING).)`就是`STRING`这样。`[^CHAR]`_`CHAR`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:39:24.933

这回答了原始问题和后续问题。

```
use strict;
use warnings FATAL => 'all';
my $String = 'hello I went to the store yesterday and the day after and the day after';
my ($who_what_where) = $String =~ /hello (.*) yesterday/;
# 'I went to the store' 
```

匹配字符串的中间是默认行为，它与第一个示例没有什么不同。

```
my ($when) = $String =~ /store (.*) and/;
# 'yesterday and the day after' 
```

我不建议对初学者使用 , `$1`，`$``它经常有问题，请参阅[Perl:Why does not eval '/(...)/' set $1?](https://stackoverflow.com/questions/10909127/perl-why-doesnt-eval-set-1) 对于最近的示例，[Perl 不会更新到下一个匹配项](https://stackoverflow.com/questions/11015832/perl-doesnt-update-to-next-match)，因为它在更复杂的程序中很容易出错。相反我教的是简单地**使用匹配操作的返回值**，它没有`$1`，`$``和朋友们的缺点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T18:44:30.177

这是一个开始。

```
if ($String =~ /hello (.*?) yesterday/i) {
    print $1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T18:47:22.147

您可以使用括号`()`和`$1`(`$2`对于第二个括号组等) 来捕获文本。

```
use strict;
use warnings;  # always use these 

my $string= "hello I went to the store yesterday and the day after " ;

if (/hello (.*?) yesterday/i) {
    print "Summary: $1\n";
} 
```

# f# - 除了 FSharpCodeProvider（来自 PowerPack），动态编译 F# 代码还需要什么？

> ID：11089003
> 
> 赞同：7
> 
> 时间：2012-06-18T18:40:50.870
> 
> 标签：f#, fsharpcodeprovider

我正在使用 PowerPack 库中的 FSharpCodeProvider 类即时编译代码。关键是在没有 Visual Studio 2010 的机器上，只要我在该机器上安装了 F# 独立编译器，我就能够做到这一点。有人知道这是否应该是这样吗？我担心的是独立编译器仅作为 CTP 软件分发，没有最终发布版本。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:37:44.217

您可以在调用 fsc.exe[的源代码](http://fsharppowerpack.codeplex.com/SourceControl/changeset/view/68767#684933)中看到。`FSharpCodeProvider`所以，是的，它依赖于 F# 编译器。

独立的 F# 版本始终称为 CTP（不知道为什么）。过去[有人说](http://blogs.msdn.com/b/dsyme/archive/2010/02/10/announcing-the-f-february-2010-release.aspx)代码与 Visual Studio 版本中的代码相同。

# git - git 可以找出所有更改过代码行的作者吗？

> ID：11089004
> 
> 赞同：5
> 
> 时间：2012-06-18T18:40:56.640
> 
> 标签：git

我想找出所有更改了一行代码的作者。Git-log 可以在文件级别上做到这一点。我阅读了手册页，似乎 git log 无法在行级别上执行此操作。有没有办法使用 git 命令来做到这一点，或者我需要为自己编写一个脚本？

出于我的目的，我想对所有代码行执行此操作。我这样做是为了为我的研究生成作者身份培训数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T21:27:56.893

您想将`-S`和`--pretty`标志组合在`git log`.

从`git log`手册页，`-S`镐搜索：

```
 -S<string>
       Look for differences that introduce or remove an instance of <string>. Note that this is different than the string simply appearing in diff output;
       see the pickaxe entry in gitdiffcore(7) for more details. 
```

此标志查找对特定字符串的所有更改。[使用另一个 SO 答案中的示例，](https://stackoverflow.com/questions/746684/how-to-search-through-all-commits-in-the-repository) `git log -g -Ssearch_for_this`将在历史记录中搜索对“search_for_this”的所有更改。

结合它`--pretty`以获得更好的结果。例如，此命令将在历史记录中搜索对 'foo' 的更改并返回缩短的哈希值，然后是作者、两个破折号、消息的第一行、两个破折号和日期：

```
$ git log -Sfoo --pretty=format:'%h %an -- %s -- %ad'
bc34134 Sally Developer -- Fixed all bugs and made all clients happy forever -- Tue Jan 31 17:41:17 2025 -0500 
```

# sql - 数据流任务成功执行但未向 Excel 文件写入任何行

> ID：11089008
> 
> 赞同：4
> 
> 时间：2012-06-18T18:41:18.713
> 
> 标签：sql, ssis, business-intelligence

我正在研究从 SQL 服务器获取数据并插入 Excel 文件的 SSIS 包...在**数据流任务**中，我使用了**OLE Db 源**和**Excel 目标**。

配置 OLE Db 源后，我可以**预览**结果行甚至数据流任务成功执行而不会出现任何错误..但不插入任何行..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:28:00.257

幸运的是我找到了答案，我做了两件事..

1.  我刚刚**删除了旧的数据流任务**，我尝试了很多不同的设置和参数......并重新构建数据流任务......

2.  在 SQL 查询中，我写了完全限定名称而不是**“使用数据库”**语句。

希望这会对某人有所帮助..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:54:22.813

您是否尝试过首先写入平面（文本）文件以确保数据来自您的数据流任务并进入结果？

绝对确保您也将列从源映射到目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-02T21:43:03.703

这是一个清楚的解释发生了什么。最有可能的是，您正在使用表变量...使用表变量的 [SSIS OLE DB 源返回无行](http://www.bidn.com/blogs/DustinRyan/ssis/835/ssis-ole-db-source-using-table-variables-returns-no-rows)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-12T20:17:55.273

我的问题是 SQL 命令中的打印语句。我把它注释掉了，它起作用了。预览与那里的打印语句一起工作。棘手...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-24T03:47:53.317

I already had SSIS package that was running well and writing to file properly. I changed the query and it stopped writing anything in text file even though i have records which i can see in preview. Solution : Sometimes you have query that has USE database command before the query begins.. remove that command and it will work. Hope it helps someone. Cheers.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-03T17:44:47.933

我需要`Connection Manager`在我的数据流任务中选择节点并`ConnectionString`使用我希望创建的文件的名称设置属性；如果不填写此字段，则不会出现文件。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-07-26T12:11:50.880

我发现如果我重新打开我的脚本组件并选择“运行代码分析”，它会执行较慢的“全部重建”（Visual Studio 2017），它会再次“唤醒它”，然后处理行。总体而言，尽管 SSIS/VS 2017 是内存错误的噩梦，但崩溃会摧毁整个 csproj 和文件夹结构。我不得不多次重新创建该项目。

# sql-server - 如何使用证书保护 SQL Server 数据库连接？

> ID：11089009
> 
> 赞同：1
> 
> 时间：2012-06-18T18:41:26.763
> 
> 标签：sql-server, winforms, web-services, certificate

目前我有 Windows 应用程序，它使用 SqlConnection 对象直接打开数据库连接（SQL Server 位于远程），没有任何适当的安全措施。

现在我需要使用证书来保护数据库连接。我阅读了有关在 SQL Server 和我的 Windows 应用程序上添加证书的内容。但我并不清楚如何做到这一点，也不确定它会有多有效。有人可以给我一些想法，有用的文章链接或示例代码吗？

我的一位朋友建议我创建“Web 服务”并将其托管在 IIS 上，因为我们可以在 IIS 上为“Web 服务”配置证书。并从我的 Windows 应用程序中调用该 WebService。但我不确定这个解决方案有多好。

提前感谢您为帮助我付出的努力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:18:46.963

这个链接在这里一步一步解释（`How To: Use SSL to Secure Communication with SQL Server`）- [http://msdn.microsoft.com/en-us/library/ff649255.aspx](http://msdn.microsoft.com/en-us/library/ff649255.aspx)

```
Step 1\. Request and Install a Server Authentication Certificate
Step 2\. Verify that the Certificate Has Been Installed
Step 3\. Install the Issuing CA's Certificate on the Client
Step 4\. Force All Clients to Use SSL
Step 5\. Allow Clients to Determine Whether to Use SSL
Step 6\. Verify that Communication Is Encrypted 
```

然后在这里阅读 -`How to enable SSL encryption for SQL Server 2000 if you have a valid Certificate Server`

[http://support.microsoft.com/default.aspx?scid=kb;en-us;276553](http://support.microsoft.com/default.aspx?scid=kb;en-us;276553)

这可能会给你一些想法和方向。

# asp.net-mvc - JqG rid 从 ASP.NET MVC 3 部分视图加载

> ID：11089010
> 
> 赞同：1
> 
> 时间：2012-06-18T18:41:31.927
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jqgrid, partial-views

我是 .net MVC 结构的新手。我正在尝试创建部分视图（如传统 asp.net 中的用户控件），我在其中传递 Id 并根据值显示 jqgrid。

当我在部分视图中添加标签以使用 jqery 加载 Jqgrid 并调用控制器的方法时，它可以工作。但是当我将该代码移动到 .js 文件时，jqgrid 不会加载。

索引视图

```
 @model Compass.Models.Sales
@{
    ViewBag.Title = "Lead Details";
}
@section  Css {
    @Content.Css("themes/base/jquery-ui.css", Url)
    @Content.Css("jquery.jqGrid/ui.jqgrid.css", Url)
}
@section JavaScript {
       @Content.Script("jquery-ui.multiselect.js", Url)
       @Content.Script("jquery.tmpl.min.js", Url)
       @Content.Script("i18n/grid.locale-en.js", Url)
       @Content.Script("jquery.jqGrid.min.js", Url)

}  
<div><h3>Lead Details # @ViewBag.LeadID</h3></div>

@using (Html.BeginForm()) { 
    @Html.ValidationSummary(true, "Please correct error/s and try again.");
<div>
<table>
    <tr>
        <td>@Html.LabelFor(m=>m.OwnerID,"Owner:") </td> <td>@Model.OwnerID</td>
    </tr>
    <tr>
        <td>@Html.LabelFor(m=>m.StatusID, "Status:") </td> <td>@Model.StatusID</td><td>@Html.LabelFor(m=>m.RatingID, "Rating:") </td> <td>@Model.RatingID</td>
    </tr>
</table>
</div>
<p></p>

@Html.Partial("_Notes", Model)
} 
```

部分视图 (_Notes.cshtml)

```
@Html.RequireScript("/Scripts/NotesView.js")
<h4>
    Notes for Lead # @Model.ID</h4>
<div style="width: 90%">
    <table id="jqgNotes" style="width: 100%">
    </table>
    <div id="jqgpNotes" style="text-align: center; width: 100%">
    </div>
</div>
<div id="editNote">
</div> 
```

NotesView.js ：在 JqgNotes 表格元素中加载 jQgrid。

```
 $(document).ready(function () {
            alert('testing');
            $('#jqgNotes').jqGrid({
                //url from wich data should be requested
                url: '@Url.Action("getNotes")',
                //type of data
                datatype: 'json',
                //url access method type
                mtype: 'POST',
                postData: {
                    UnitID: '@Model.ID'
                },
                //columns names
                colNames: ['Title', 'Last Modified', 'Last Modified By', 'Edit'],
                //columns model
                colModel: [

                                { name: 'Title', index: 'Title', align: 'left', search: true, stype: 'text', editable: true, edittype: 'text' },
                                { name: 'UpdatedDate', index: 'UpdatedDate', align: 'left', formatter: 'date', formatoptions: { srcformat: 'm/d/Y h:i:s', newformat: 'm/d/Y h:i:s' }, sorttype: "date", datefmt: "m/d/Y h:i:s", search: true },
                                { name: 'UpdatedBy', index: 'UpdatedBy', align: 'left', search: true },
                                { name: 'Edit', index: 'Edit', align: 'center', formatter: supplierFormatter, unformat: supplierUnFormatter, editable: false },
                              ],
                //pager for grid
                pager: $('#jqgpNotes'),
                //number of rows per page
                rowNum: 10,
                //initial sorting column
                sortname: 'UpdatedDate',
                //initial sorting direction
                sortorder: 'desc',
                //we want to display total records count
                viewrecords: true,
                //grid height
                height: '100%',
                autowidth: true
            });
 function supplierFormatter(cellvalue, options, rowObject) {
            return "<a href='#' data-edit-id='" + options.rowId + "'>Edit</a>&nbsp;&nbsp;<a href='#' data-delete-id='" + options.rowId + "'>Remove</a>";
        };
        function supplierUnFormatter(cellvalue, options, cellobject) {
            return cellvalue;
        };

        $('#jqgNotes').jqGrid('navGrid', '#jqgpNotes',
                { editfunc: function (rowid) {
                    editNoteFunc(rowid);
                    return false;
                }
                },
                {}, // Edit Option
                {}, // add option
                {}, // delete option
                {} // search option
            ); 
```

当我在 _notes.chtml 中有 .js 代码时，标签页加载正常。它执行控制器“getNotes”方法，但是当我将此 JavaScript 代码移动到 .js 文件并加载它时，我仍然可以看到警报到来，但控制器“getNotes”方法没有被执行。我在那个方法上设置了断点，但它从来没有达到那个。

如果您能帮助我，我将不胜感激。要么我的方法不对，要么我正在做的事情不对。基本上，我想创建部分视图，它可以自己获取其数据（使用 jquery），所以我将此视图插入任何其他页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:36:04.367

您似乎在您的外部 javascript 文件中使用了服务器端帮助程序，例如`url: '@Url.Action("getNotes")'`显然`UnitID: '@Model.ID'`不起作用。Javascript 是静态文件，服务器端助手不运行。因此，您必须将这些值作为参数传递给脚本。

例如，您可以`data-*`在视图中使用 HTML5 属性：

```
<table id="jqgNotes" style="width: 100%" data-url="@Url.Action("getNotes")" data-unitid="@Model.ID">
</table> 
```

然后在您的javascript文件中，您可以将此值与[`.data()`](http://api.jquery.com/data/)函数一起使用：

```
url: $('#jqgNotes').data('url') 
```

和：

```
postData: {
    UnitID: $('#jqgNotes').data('unitid')
} 
```

请注意，静态 javascript 文件中不再使用`@`Razor 服务器端函数。

# python - 使用在函数内部或外部创建的实例？

> ID：11089012
> 
> 赞同：2
> 
> 时间：2012-06-18T18:41:38.933
> 
> 标签：python, class, global, instances

我正在尝试创建一个创建类的函数，并将这些类附加到列表中。

当我运行程序时：我收到以下错误：

> NameError：名称'jackie'未定义

这意味着只能使用函数内部的实例。我怎样才能让它全球化？，我试过`global eval('jackie')`但没有用。

```
population =[]
class person():pass
def createdarwin(name):
    global population
    darwin=p.image.load('darwin.png')
    vars()[name]=person(darwin)
    population.append(name)
def main():
    createdarwin('jackie')
    for i in population:
                eval(i).update() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T18:45:26.623

如果您想要可变命名的变量，请改用字典。那么你不需要`vars()`也不需要`eval()`：

```
population = {}
class Person(object):
    pass

def create_darwin(name):
    darwin = p.image.load('darwin.png')
    population[name] = person(darwin)

def main():
    create_darwin('jackie')
    for name in population:
        population[name].update() 
```

# java - 如何在 servlet 执行过程中向用户发送页面并在用户提交页面后继续执行

> ID：11089015
> 
> 赞同：0
> 
> 时间：2012-06-18T18:41:51.103
> 
> 标签：java, jakarta-ee

我想在 servlet 的执行过程中呈现一个页面，并在用户提交 from 和重命名执行将使用该页面时继续执行。我们能做到这一点，请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T18:45:49.180

使其成为两个 servlet，（或一个 servlet 并在表单中使用附加请求参数区分 2 个逻辑）。

如果您希望第一个 servlet 中的变量在第二个 servlet 中可用，请使用 Session。

设置正在使用

`request.getSession().setAttribute("name", var);`

并在第二个代码中使用

`request.getSession().getAttribute("name");`

# python - IronPython Windows 窗体，在 python 中传递变量

> ID：11089016
> 
> 赞同：0
> 
> 时间：2012-06-18T18:41:51.530
> 
> 标签：python, ironpython

我是 IronPython 的新手，并尝试使用 Windows 窗体创建一个简单的应用程序，将固定字段文件转换为分隔文件。

我创建了一个带有三个按钮的表单。

首先是选择要转换的文件。第二个是选择具有第一个文件布局的文件。第三个是“提交”按钮，用于将上述两个文件的文件名发送到将转换文件的 python 函数。

前两个按钮工作正常。我的问题是将文件名传递给“button_submitPressed”函数。我试图制作 FILENAME 和 LAYOUT 全局变量（我已经在“HelloWorldForm”类的内部和外部尝试过，但都没有工作）。

我必须做什么才能将我在按钮事件中收集的变量传递给另一个函数？

当我运行它时，当我单击提交按钮时（单击前两个并选择文件名和布局后）我收到错误：

```
IronPython.Runtime.UnboundNameException: global name 'FILENAME' is not defined 
```

谢谢。

```
class HelloWorldForm(Form):
    FILENAME = ''
    LAYOUT = ''
    def __init__(self):
        self.Text = 'ff2delim'

        self.label = Label()
        self.label.Text = "Convert fixed legnth file to delimited"
        self.label.Location = Point(50, 50)
        self.label.Height = 30
        self.label.Width = 200

        self.count = 0

        button = Button()
        button.Text = "File name"
        button.Location = Point(50, 100)

        button.Click += self.buttonPressed

        button2 = Button()
        button2.Text = "Layout"
        button2.Location = Point(50, 130)

        button2.Click += self.button2Pressed

        button_submit = Button()
        button_submit.Text = "Convert"
        button_submit.Location = Point(50, 190)

        button_submit.Click += self.button_submitPressed

        self.Controls.Add(self.label)
        self.Controls.Add(button)
        self.Controls.Add(button2)
        self.Controls.Add(button_submit)

    def buttonPressed(self, sender, args):
        dialogf = OpenFileDialog()
        if dialogf.ShowDialog() == DialogResult.OK:
            FILENAME = dialogf.FileName
            print "FILENAME: " + FILENAME 
            self.label_filename = Label()
            self.label_filename.Text = FILENAME
            self.label_filename.Location = Point(140, 105)
            self.label_filename.Height = 30
            self.label_filename.Width = 200    
            self.Controls.Add(self.label_filename) 
        else:
            print "No file selected"

    def button2Pressed(self, sender, args):
        dialogl = OpenFileDialog()
        if dialogl.ShowDialog() == DialogResult.OK:
            LAYOUT = dialogl.FileName
            print "LAYOUT: " + LAYOUT 
            self.label_layout = Label()
            self.label_layout.Text = LAYOUT
            self.label_layout.Location = Point(140, 135)
            self.label_layout.Height = 30
            self.label_layout.Width = 200    
            self.Controls.Add(self.label_layout) 
        else:
            print "No file selected"

    def button_submitPressed(self, sender, args):
        convert(FILENAME,LAYOUT) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:07:11.443

I was able to get this working by putting in a global variable in the first two button handlers.

```
def buttonPressed(self, sender, args):
    global FILENAME
    dialogf = OpenFileDialog()
    if dialogf.ShowDialog() == DialogResult.OK:
        FILENAME = dialogf.FileName
        print "FILENAME: ",FILENAME
    ...

def button2Pressed(self, sender, args):
    global LAYOUT
    dialogl = OpenFileDialog()
    if dialogl.ShowDialog() == DialogResult.OK:
        LAYOUT = dialogl.FileName
        print "LAYOUT: " + dialogl.FileName
    ... 
```

Then in the third button handler:

```
def button_submitPressed(self, sender, args):
    print "FILENAME SUB: ",FILENAME
    print "LAYOUT SUB: ",LAYOUT
    convert(FILENAME,LAYOUT) 
```

The third button handler then successfully calls the convert function.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T16:36:35.340

对于未来的读者，如果他通过类访问他的类级常量，OP 的代码将会起作用：

```
def button_submitPressed(self, sender, args):
    convert(self.FILENAME,self.LAYOUT) 
```

# c - 在缓冲区中搜索十六进制值并返回 C 中的结果位置

> ID：11089017
> 
> 赞同：1
> 
> 时间：2012-06-18T18:41:52.427
> 
> 标签：c, search, hex, buffer

我是 C 的新手，所以我为任何“明显的问题”道歉。

我正在尝试在缓冲区中搜索一组十六进制值。我试图将它放入一个函数中，因为我将不得不搜索它们的多组。

这是我到目前为止的代码：

```
#define bin_buff_size (1024 * 1500)
unsigned char *bin_buff;
int i, hex_location, reset_i, hex_i, fix_location_1, buff_size;
unsigned char hex_string_search_1[] = {0x5e, 0x00, 0x75, 0x0d, 0x68, 0xb4, 0x2c, 0x63};

<other code here>

int get_location_from_buffer(unsigned char *needle, unsigned char *haystack, size_t haystack_size) {
    // Find the location of the hex-values in the buffer
    for (i = 0; i < haystack_size; i++) {
        // Reset hex_value because I will need to do this for multiple sets of hex values
        for (reset_i = 0; reset_i <= 7; reset_i++) {
            hex_value[reset_i] = 0x00;
          }

        // Set hex_value equal to the next section of the haystack
        for (hex_i = 0; hex_i <= 7; hex_i++) {
            hex_value[hex_i] = haystack[i + hex_i];
            printf("hex_value[%i] = %s\n",hex_i,hex_value[hex_i]); // Print the resulting hex-value for this sub-location
          }
        printf("hex_value = %s\n",hex_value);  // Print the entire hex_value

        // Check if needle equals haystack, and if so, return the resulting location
        if (needle == hex_value){
            printf("Found the first value at %i", i);
          }else{
            printf("Havent found the first value yet!\n");
          }
      }
    return i;
}

fix_location_1 = get_location_from_buffer(hex_string_search_1, bin_buff, buff_size); 
```

我遇到的问题是这是我的输出：

```
hex_value[0] = (null)
hex_value[1] = (null)
hex_value[2] = (null)
hex_value[3] = (null)
hex_value[4] = (null)
hex_value[5] = (null)
hex_value[6] = (null)
hex_value[7] = (null)
hex_value =
Havent found the first value yet!
<The above is repeated multiple times> 
```

它看起来像这一行：

```
hex_value[hex_i] = haystack[i + hex_i]; 
```

实际上并没有像我想的那样从缓冲区中提取数据。有人能指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:53:40.913

几个观察：

1) 一个问题是您应该使用“0x%02x”（或“$0x2x”或其他）来打印二进制十六进制值。而不是“%s”。它打印一个字符串（字符数组），而不是十六进制二进制（单个值）。

2) "null" == "0" 这意味着你没有找到*任何东西*。

3) 问：你确定你正确地初始化了缓冲区吗？

4）我没有仔细看，但是问：你确定你的搜索算法吗？

5）问：你会考虑递归算法吗？

只是一些想法...

'希望这会有所帮助......至少有一点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T18:44:57.437

```
printf("hex_value[%i] = %s\n",hex_i,hex_value[hex_i]); 
```

应该

```
printf("hex_value[%i] = %x\n",hex_i,hex_value[hex_i]); 
```

您正在打印原始值，而不是字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:11:24.047

您的代码中有几个问题。主要问题：`if (needle == hex_value)`只比较指针，而不是它们的内容。用于`strncmp`比较两个字符串的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:21:01.503

线

```
if (needle == hex_value){ 
```

是比较两个地址，而不是存储在这些地址的值。我不认为这种比较是你想要的......

# c# - C# 中的 GIF LZW 压缩

> ID：11089018
> 
> 赞同：4
> 
> 时间：2012-06-18T18:42:01.477
> 
> 标签：c#, compression, gif, lzw

我目前正在使用 C# 进行编程以制作图像解码器的自学练习，我已经制作了几个可行的解决方案，因此我认为我应该在转向更复杂的 PNG 和 JPEG 格式之前处理 GIF。我的问题是我真的很难想出一个解压缩 LZW 子块的实际解决方案。我只是在努力弄清楚如何尝试它；我见过几个松散的伪代码示例，但它们似乎使用了我在 C# 中没有真正遇到过的术语以及我发现难以理解的过程。大多数还专注于压缩，但解压缩是我最感兴趣的。

例如，在 C# 中创建代码表的最佳方法是什么？字节数组、字典或其他东西？那么我该如何解压数据呢？我不一定要代码，只是一些帮助或指向其他人已经完成的示例的链接（我发现图像解码有点被忽视了在线资源和教育材料）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:46:54.650

也许这有帮助:-) [http://paste.lisp.org/display/12198](http://paste.lisp.org/display/12198)

我同意字典是 Stringtable 的不错选择。

# java - SAX 解析器上的文档意外结束（怀疑输入流多次使用）

> ID：11089020
> 
> 赞同：0
> 
> 时间：2012-06-18T18:42:03.210
> 
> 标签：java, android, inputstream, sax

我在行上有意外的文档结尾：

```
Document xmlDoc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(inputStream); 
```

但是我有一些线索，我认为我的错误可能与 SAX 解析器无关。这是我的简化代码片段。

```
 public boolean createDataList(InputStream inputStream) {

        try {               
            XmlHelper xmlHelper = new XmlHelper();

            ArrayList<Category> categories = xmlHelper.getCategoriesFromXml(inputStream);
            ArrayList<Budget> budgetEntries = xmlHelper.getBudgetFromXml(inputStream);                  
            ArrayList<StandingOrder> standingOrders = xmlHelper.getOrdersFromXml(inputStream);

            return true;

        } catch (Exception e) {

            return false;
        }           
    } 
```

3 ArrayList getter 指向导致问题的行。它们都使用相同的 InputStream。所有方法都几乎相同，我相信它们可以正常工作......只是分开。只有第一个数组 getter 成功执行，第二个和第三个总是失败，不管它是什么顺序，第一个都很好。

我怀疑使用相同的 InputStream 有问题，我试图在每个数组 getter 之后关闭输入 - 没有效果。请给我一些线索。我真的很感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:50:55.327

我怀疑在阅读时，输入流会在您的文件中前进直到最后。因为我不认为 SAX 解析器调用 mark() 和 reset() 来将阅读器定位到文件的开头，所以当你第二次调用它时没有什么可以阅读的了。

作为旁注，您为什么不同时解析和创建所有 3 个列表，然后通过 getter 将它们暴露在 XMLHelper 之外？这也应该可以提高您的性能，避免至少 2 次完整的 I/O 操作。

# javascript - 从 Javascript 中的另一个对象调用对象中的函数

> ID：11089025
> 
> 赞同：0
> 
> 时间：2012-06-18T18:42:18.367
> 
> 标签：javascript, function, scope, prototype

我这里有两个功能

```
function Preloader() {}
Preloader.prototype = {
    init:function() {
        // do something
    }
}

var preloader = new Preloader();

function Project() {}
Project.prototype = {
    init:function() {
        // do something else 
    }
}

var project = new Project(); 
```

我想在预加载器的 init 函数中调用 project.init() 但显然

```
project.init() 
```

不起作用，因为预加载器中没有项目变量。我该怎么称呼它？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:45:17.160

```
Preloader.prototype = {
    init:function(project) {
        project.init();
    }
}

var preloader = new Preloader(),
    project = new Project();

preloader.init(project); 
```

# php - 如何将 Mysqli 中的大量列值与准备好的语句绑定？

> ID：11089034
> 
> 赞同：1
> 
> 时间：2012-06-18T18:42:30.023
> 
> 标签：php, mysqli, prepared-statement

我正在使用 mysqli 和准备好的语句从 MySQL 表中选择大约 50 列。我的代码：

```
if ($stmt = $mysqli->prepare("SELECT ".explode(",",$some_arr)." FROM some_table WHERE userid=?"))
{       
    $stmt->bind_param("i", $user->get_userid());                        
    $stmt->execute();
    $stmt->store_result();
    $num_rows = $stmt->num_rows;

    // Do I have to add 50 variables here? What if some_arr contains less than 50?
    $stmt->bind_result($col1, $col2);

    if($num_rows > 0)
    {                   
        while($stmt->fetch())
        {
             // wouldn´t this create a new array within each while loop?
             $output_arr[] = array("key1" => $col1, "key2" => $col2);
        }   

        $stmt->close();

    }
} 
```

我有两个问题，我也写到了源代码中。首先，当我有多个变量时，我不明白如何将结果绑定到变量？有没有办法将我的结果绑定到数组？我的第二个问题是在 while 循环内。我想将我的 50 个值添加到关联数组中，但是显示的示例不会在每次循环通过 while 循环时覆盖现有数组吗？

# vba - 使用和不使用 Set 关键字的类型差异

> ID：11089040
> 
> 赞同：5
> 
> 时间：2012-06-18T18:42:43.737
> 
> 标签：vba

我刚刚解决了一个问题，我将“Set”关键字放在定义行中，但我想知道的是“为什么”？

基本上，我正在这样做：

```
Dim startCell, iCell as Range
For Each iCell in Range(whatever)
    If iCell.value <>"" Then
        Set startCell = Cells(iCell.Row + 1, iCell.Column)
    End If
Next iCell 
```

如果我省略“Set”关键字，代码仍然可以正常编译，但在局部变量窗口中，我看到它的*类型*更改为“String”而不是“Variant/Object/Range”。为什么会这样？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-18T19:28:10.433

这就是为什么。当你这样说时：

```
Dim startCell, iCell As Range 
```

你*认为*你已经做到了：

```
Dim startCell As Range, iCell As Range 
```

但你*真正*做的是：

```
Dim startCell 'As Variant, by default
Dim iCell As Range 
```

这是一个典型的 VBA 错误。大多数 VBA 程序员都做到了，这就是为什么大多数 VBA 程序员只能在每条`Dim`语句中声明一个变量（即每行一个）。否则很容易犯这个错误，之后很难发现它。

因此，`Dim startCell`您已将变量隐式声明为 Variant 类型（等效于`Dim startCell As Variant`）。

当你这样说时：

```
Set startCell = Cells(iCell.Row + 1, iCell.Column) 
```

Variant 获取引用赋值（Range）右侧事物的类型。然而，当你这样说：

```
startCell = Cells(iCell.Row + 1, iCell.Column) 
```

没有`Set`关键字，您不是为变量分配一个引用，而是一个值，该变量`startCell`现在获取右侧值的类型。那是什么类型？嗯，Range 对象的默认属性是`Value`，因此您将获得 的类型`Cells(iCell.Row + 1, iCell.Column).Value`。如果该单元格包含一个字符串，那么您将得到一个字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T18:51:43.457

`Set`用于分配对对象的引用，`Let`（或简单分配）分配对象的值（如果有）

```
 Dim a As Variant
  Set a = ActiveSheet.Cells(1)
  'TypeName(a) = Range, a now contains reference to the cell's range
  a = ActiveSheet.Cells(1)
  'TypeName(a) = Double or String, whatever is in the Cell, a contains the cell's value 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T18:50:03.003

将对象分配给变量时 必须使用**Set关键字。**`Cells(iCell.Row + 1, iCell.Column)`正在返回一个**Range**对象，因此必须使用**Set**`91: Object variable or With block variable not set` ，否则您将得到每个人都喜欢的 VBA 错误： .

编辑：

Range 对象也有一个默认的返回属性，即“Value”属性。如果您仅引用 Range("A1") ，它将将该范围 'Value' 作为变体的默认值。这就是为什么在提前知道数据类型时应避免使用变体的原因。

# php - 使用 Zend GData，我如何通过查找其值来获取工作表单元格索引？

> ID：11089041
> 
> 赞同：0
> 
> 时间：2012-06-18T18:42:46.453
> 
> 标签：php, zend-framework, google-docs, gdata

假设我在工作表中有一个值为“最后一个数据单元格”的单元格，这是使用 Zend GData 获取该单元格（即 A5）索引的正确方法吗？

```
 $query = new Zend_Gdata_Spreadsheets_CellQuery();
$query->setSpreadsheetKey($this->_spreadsheetKey);
$query->setWorksheetId($worksheet);

$cellFeed = $this->_spreadsheetService->getCellFeed($query);

foreach($cellFeed as $cellEntry) {
      $row = $cellEntry->getCell()->getRow();
      $col = $cellEntry->getCell()->getColumn();
      $val = $cellEntry->getCell()->getText();
      if ($val == 'last data cell'){ $index = array($row, $col); }
      //echo "$row, $col = $val\n";
}
return  $index; 
```

我想稍后使用 $index 值作为定义范围的边界，例如：

```
$range = (string)$index[0]+1 + $index[1].":F20";
$contentAsCells = $worksheet->getContentsAsCells($range); 
```

但索引值是数字。如何将其转换为“A1”格式？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T09:01:17.550

您可以像这样获取单元 ID：

```
$cellId = $row . $col; //vars from your code above.
echo $cellId; 
```

如果 $col 是 'A' 并且 $row 是 1 这将输出

> A1

# asp.net - ASP.Net 客户端模式进度指示器

> ID：11089043
> 
> 赞同：1
> 
> 时间：2012-06-18T18:42:52.707
> 
> 标签：asp.net, ajax

我试过实现[这个例子](http://weblogs.asp.net/guillermo/archive/2008/02/24/ajax-how-to-create-a-quot-processing-quot-modal-window-using-updateprogress-and-modalpopup-asp-net-ajax-controls.aspx)，但进度永远不会显示。我的页面不包含任何 UpdatePanel 或任何内容，这可能是为什么？

在我的页面声明中，我添加了：

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="ajaxToolkit" %> 
```

在我添加的 head 元素内：

```
<script src="Scripts/jsUpdateProgress.js" type="text/javascript"></script> 
```

在我的表单标签中，我立即添加了：

```
<asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
<asp:Panel ID="panelUpdateProgress" runat="server" CssClass="updateProgress">
    <asp:UpdateProgress runat="server" ID="UpdateProg1" DisplayAfter="0">
        <ProgressTemplate>
            <div style="position:relative; top:30%; text-align: center;">
                <img src="Processing.gif" style="vertical-align: middle" alt="Processing"/>
                  Processing...
            </div>
        </ProgressTemplate>
    </asp:UpdateProgress>
</asp:Panel>
<ajaxToolkit:ModalPopupExtender runat="server" ID="ModalProgress" TargetControlID="panelUpdateProgress" BackgroundCssClass="modalBackground" PopupControlID="panelUpdateProgress"/> 
```

紧随我添加的结束表单标签：

```
<script type="text/javascript">
        Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(beginReq);
        Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endReq);
        var ModelProgress = '<%= ModalProgress.ClientID %>';
        function beginReq(sender, args) {
            $find(ModalProgress).show();
        }            
        function endReq(sender, args) {
            $find(ModalProgress).hide();
        }
</script> 
```

我希望使进度显示的按钮：

```
<asp:Button runat="server" ID="submit" CssClass="multiViewTab" Text="Submit"/> 
```

该按钮肯定会发回，因为在我的表单标签中我有：

```
onsubmit="return validateForm()" 
```

并且 validateForm 运行。如果表单有效，validateForm 还会启动 submitForm 函数，其中包含对 AJAX 调用 Web 服务的 JQuery 调用。

取2：

更简单和纯粹的 AJAX，但仍然不起作用。

```
 </form>
 <script type='javascript'>
   $(document).ready(function() {
    $('body').append('<div id="ajaxBusy"><p><img src="Processing.gif"></p></div>');
    $('#ajaxBusy').css("updateProgress");
  });

  $(document).ajaxStart(function () {
            $('#ajaxBusy').css("z-index", 2);
        }).ajaxStop(function () {
            $('#ajaxBusy').css("z-index", -1);
        }); 
```

我使用 z-index 是因为我有一个临时的“向导”，它本质上使用 z-index 显示/隐藏 div，如果我不更改 z-index，进度 div 将不会显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:53:20.133

根据 MSDN，在更新`UpdateProgress`内容时提供反馈`UpdatePanel`。

> 我的页面不包含任何 UpdatePanel 或任何内容，这可能是为什么？

简而言之，是的。

来源：[UpdateProgress 类](http://msdn.microsoft.com/en-us/library/system.web.ui.updateprogress.aspx)

上面的链接有一个很好的例子。

# jquery - jQuery 使用多个选项卡组

> ID：11089048
> 
> 赞同：3
> 
> 时间：2012-06-18T18:43:06.313
> 
> 标签：jquery, jquery-ui-tabs

我有一个包含多个选项卡的页面。但是如果你复制/粘贴代码并在 Chrome 中查看，你就会明白我在说什么。当页面加载时，我想显示对应于 [管理角色] 的选项卡。然后，当用户单击 [管理角色-人员关联] 或 [管理应用程序-数据包关联] 时，我想显示相应的选项卡。

以下是我到目前为止使用的代码。我遇到的问题是，当我单击左侧的链接时，页面会返回到我完全理解的 [Manage Roles] 选项卡，因为我已经在 $(document).ready 函数中编写了所有内容。但我不知道如何让它按照我想要的方式工作。任何帮助将不胜感激。

```
<body>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script type="text/javascript">

    $(document).ready(function () {

        $('#divRolesTabs').tabs();
        $('#divRolesPersonsAssociations').hide();
        $('#divManageApplicationDataPackageAssociation').hide();

        $('#sManageRoles').click(function () {
            $('#divRolesTabs').tabs();
            $('#divRolesTabs').show();

            $('#divRolesPersonsAssociations').hide();
            $("#divManageApplicationDataPackageAssociation").hide();
        });

        $('#sManageRolesPersonAssociation').click(function () {
            $('#divRolesPersonsAssociations').show();
            $('#divRolesPersonsAssociations').tabs();
            $('#divRolesPersonsAssociations').focus();

            $('#divRolesTabs').hide();
            $("#divManageApplicationDataPackageAssociation").hide();
        });

        $('#sManageApplicationDataPackageAssociation').click(function () {
            $("#divManageApplicationDataPackageAssociation").show();
            $("#divManageApplicationDataPackageAssociation").tabs();

            $('#divRolesTabs').hide();
            $('#divRolesPersonsAssociations').hide();
        });
    });
</script>
<form id="frmAdminView" runat="server">
    <table>
        <tr>
            <td>
                <div id="divNavigationPane">
                    <ul>
                        <li><a href=""><span id="sManageRoles">Manage Roles</span></a></li>
                        <li><a href=""><span id="sManageRolesPersonAssociation">Manage Roles-Person Associations</span></a></li>
                        <li><a href=""><span id="sManageApplicationDataPackageAssociation">Manage Application-Data Package Associations</span></a></li>
                    </ul>
                </div>
            </td>
            <td>
                <div id="divRolesTabs">
                    <ul>
                        <li><a href="#divAddRoles"><span>Add Roles</span></a></li>
                        <li><a href="#divDeleteRoles"><span>Delete Roles</span></a></li>
                        <li><a href="#divChangeRoles"><span>Change Roles</span></a></li>
                    </ul>
                    <div id="divAddRoles">
                        <p>Add Roles</p>
                    </div>
                    <div id="divDeleteRoles">
                        <p>Delete Roles</p>
                    </div>
                    <div id="divChangeRoles">
                        <p>Change Roles</p>
                    </div>
                </div>
                <div id="divRolesPersonsAssociations">
                    <ul>
                        <li><a href="#divAssignRoles"><span>Add Roles</span></a></li>
                        <li><a href="#divDeleteRoleAssociations"><span>Delete Roles</span></a></li>
                    </ul>
                    <div id="divAssignRoles">
                        <p>Assign Roles to persons</p>
                    </div>
                    <div id="divDeleteRoleAssociations">
                        <p>Delete Role Associations</p>
                    </div>
                </div>
                <div id="divManageApplicationDataPackageAssociation">
                    <ul>
                        <li><a href="#divAddApplications"><span>Add Applications</span></a></li>
                        <li><a href="#divAddDataPackage"><span>Add Data Package</span></a></li>
                        <li><a href="#divAddApplicationDataPackageAssociations"><span>Add Application/Data Package</span></a></li>
                    </ul>
                    <div id="divAddApplications">
                        <p>Add Applications</p>
                    </div>
                    <div id="divAddDataPackage">
                        <p>Add Data Packages</p>
                    </div>
                    <div id="divAddApplicationDataPackageAssociations">
                        <p>Add App Data Package Association</p>
                    </div>
                </div>
            </td>
        </tr>
    </table>

</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:50:26.800

最有可能的答案是从您的点击处理程序返回 false：

```
$('#sManageRoles').click(function () {
    $('#divRolesTabs').tabs();
    $('#divRolesTabs').show();

    $('#divRolesPersonsAssociations').hide();
    $("#divManageApplicationDataPackageAssociation").hide();

    return false;
}); 
```

当您不从单击处理程序返回“false”时，默认锚标记功能将启动，这意味着（因为您没有指定 href）页面被重新加载。

# jquery - 使用 AJAX 提交评论而不刷新页面不再起作用

> ID：11089056
> 
> 赞同：1
> 
> 时间：2012-06-18T18:43:52.270
> 
> 标签：jquery, form-submit

嗨，我有这段代码可以通过 AJAX 和文件 php 提交评论，而无需刷新页面。以前可以工作，但是自从我更换计算机来开发此应用程序后，我遇到了问题，并且代码从未更改过。现在它要么使 Chrome 崩溃，要么在未到达文件 comment.php 的情况下提交

这是JS代码

```
 <script src="/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript"> 
    $("#formcomment").submit(function(){        
        ctask = this.task.value;
        cname = this.usrnm.value;
        cmessage = this.comment.value;
        submitter = this.submitter;
        cty = this.ty.value;
        celem = this.elem.value;
        cusrcd = this.usrcd.value;
        cusrcdauth = this.usrcdauth;
        val_recaptcha_challenge_field = this.recaptcha_challenge_field.value;
        val_recaptcha_response_field = this.recaptcha_response_field.value;

        if(cname=="" || cmessage=="") { $("#errAll").html('<p>Please don\'t leave the requierd fields.</p>');  }

        $.post("/comment.php", {task: ctask, usrnm: cname, comment: cmessage, ty: cty, elem: celem, recaptcha_challenge_field:val_recaptcha_challenge_field, recaptcha_response_field:val_recaptcha_response_field, usrcd: cusrcd, usrcdauth: cusrcdauth}, function(data){
            if(data=='0') { $("#errAll").html('<p>Please don\'t leave the requierd fields.</p>'); }
            else if (data=='1') {$("#errAll").html('<p>The reCAPTCHA wasn\'t entered correctly. Try it again.</p>'); }
            else if (data=='2') {$("#errAll").html('<p>Username must contain 6 to 20 characters.</p>'); }
            else { 
                submitter.value="Comment posted"; 
                submitter.disabled=true; 
                $('#listcom').prepend(data); 
                $("#errAll").html('');
                window.location.hash = "#comments";
            }
        });

        return false;
    });
   </script> 
```

以及页面中的表单

```
 <form class="well" method="post" id="formcomment"> 
    <input type="hidden" id="ty" name="ty" value="stg" /> 
    <input type="hidden" id="elem" name="elem" value="13" /> 
    <input type="hidden" name="task" id="task" value="addComments" /> 
    <input type="hidden" name="usrcdauth" id="usrcdauth" value="yudtjnisifwndyubleedbtisngvxlj" /> 

    <label>Username</label> 
    <input value="" type="text" id="usrnm" name="usrnm" maxlength="20" class="span3" /> 
    <input type="hidden" id="usrcd" name="usrcd" value="" /> 

    <label>Message</label> 
    <textarea id="comment" name="comment" rows="5" cols="150" class="span7"></textarea> 

    <div style="margin: 15px 0;"><input type="submit" id="submitter" name="submitter" value="Add Comment" class="btn" /></div> 
    <div id="errAll"></div> 
   </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T07:52:35.320

听起来可能很傻，但是您是否在新计算机上安装了像 xammp 这样的 php 服务器？如果是这样，请确保文件位于同一目录中，并尝试删除comment.php 之前的“/”。我没有详细介绍您的代码，但我认为因为它以前有效；可能是这种情况。

# javascript - 在使用 ArrayBuffer 的 Javascript 中搜索 Inflate 实现

> ID：11089057
> 
> 赞同：1
> 
> 时间：2012-06-18T18:43:59.587
> 
> 标签：javascript, implementation, unzip, inflate, arraybuffer

我正在拼命寻找充分利用 ArrayBuffer 数据类型的 Inflate 算法的 Javascript 实现。这样的实现将 ArrayBuffer 作为输入并给出 ArrayBuffer 作为输出，而在处理数据时不使用那些讨厌的二进制字符串。

你知道这样的实现是否已经存在？现在 IE10 支持 ArrayBuffer 以及其他当前浏览器将非常有用。

# c# - 如何自动计算给定位置数量的正弦波值？

> ID：11089058
> 
> 赞同：0
> 
> 时间：2012-06-18T18:44:07.677
> 
> 标签：c#, math

我至少有 12 个职位。最小值和最大值是 0 和 1。因此，如果我想在我的 12 个位置绘制一个正弦波（即每个位置一个值），我将有一个像这样的值列表：0.5、0.66、0.83、1、0.83、 0.66、0.5、0.33。0.16, 0, 0.16, 0.33, 0.5

但是，如果我想将泊松的数量扩展到 24、48 或 96 等，我将如何计算出这些值（即某种算法而不是手动计算）？

请注意，我的正弦波不是重复的正弦波，只是上面列表构建的单个图形。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:56:00.100

正弦波方程是 y = sin x（对于“单位”正弦波）。

您需要做的是将 x 轴划分为要显示的位置数，然后显示这些 x 值。

由于您的 x 最大值为 1，请使用： **注意：由于正弦波不会在 x 轴上以 1 结束，我假设您希望它绑定到这些值，因此 x 轴将被缩放所以 1.0 = 2*Pi**

```
double xStep = 1.0/NumberOfPositions; 
```

然后做：

```
for(double x = 0.0; x < 1.0; x += xStep)
{
    double yValue = Math.Sin(x*2*Math.PI); // Since you want 2*PI to be at 1
} 
```

或者：

```
double xStep = 1.0/NumberOfPositions;
double[] yValues = new double[NumberOfPositions+1];
double[] xValues = new double[NumberOfPositions+1];
for (int i = 0; i < NumberOfPositions+1; i++)
{
    xValues[i] = i * xStep;
    yValues[i] = Math.Sin(xValues[i]*2*Math.PI); // Since you want 2*PI to be @ 1
} 
```

# c# - 使用存储库和服务层在 EF 中排序

> ID：11089059
> 
> 赞同：0
> 
> 时间：2012-06-18T18:44:08.273
> 
> 标签：c#, entity-framework, repository, service-layer

我有几个实现公共存储库接口的类，这些类中的一个方法是返回分页结果并采用

```
Expression<Func<T, bool>> OrderBy 
```

我还创建了一个将使用存储库类的服务层，因为我已经阅读过将表达式对象从 UI 发送到服务层不是首选，所以我决定将它作为参数发送，如果我将它作为包含的字符串发送参数的名称如何将字符串转换为要在表达式对象中使用的属性，例如假设我有一个名为 User 的实体，我向方法发送一个名为“UserName”的参数，我该如何转换“用户名”要变成“用户名”属性，可以在 Expression> OrderBy 对象中使用？

如果可能的话，你能告诉我一个更合适的分类方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T23:08:26.487

而不是接收`Expression<Func<T, bool>>`您的服务可以接收`Func<IQueryable<T>, IQueryable<T>>`更灵活（启用任何 LINQ，而不仅仅是在哪里）并且不需要表达式所做的额外工作。

如果您想防止滥用（例如代码注入），则改为将枚举（或字符串）（包含 sortby 参数）传递给服务并让您的服务相应地构建查询。

我希望 UI 不是指实际的 UI，而是指 VM 或控制器，并且您的视图不知道它们下面的任何内容。

# html - CSS ARGB RGBA 十六进制格式

> ID：11089067
> 
> 赞同：3
> 
> 时间：2012-06-18T18:44:41.677
> 
> 标签：html, css, colors, hex, rgba

对于我一直在研究的 jQuery 颜色选择器 (https://github.com/vanderlee/colorpicker)，我被要求实现 hex-ARGB ( `#AARRGGBB`) 解析。

但是，我厌倦了实现 hex-ARGB，因为 CSS 当前支持该`RGBA(r,g,b,a)`语法，并且如果曾经支持 hex，将更有可能支持`#RRGGBBAA`语法。

另一方面，IE 的`filter`CSS 标签已经使用`#AARRGGBB`. 但是，这两种格式都不是任何类型的实际标准。

我的颜色选择器已经支持所有标准的 CSS/HTML 语法，并且输出格式足够灵活，可以输出您可能想要的大多数非标准格式。问题是输入；解析。没有合理的方法来区分这两种格式，所以我不能自动解析它们。

有没有人知道任何强烈的论据支持或反对任何一个`#AARRGGBB`或`#RRGGBBAA`用于网络上的颜色选择器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T20:53:57.880

你不能包括一个小复选框/单选按钮并有一个自动的吗？

另外，有人多久做一次 IE 做的事情？=p 我实际上从未在我做过的任何事情中看到 ARGB。甚至其他微软产品。

我在搜索引擎中输入了“ARGB vs RGBA”，发现并[没有多大用处](http://lists.cairographics.org/archives/cairo/2005-January/002648.html)，除了在第一页结果之后，几乎没有搜索结果包含 ARGB，这进一步表明它没有用。

# google-maps - 将 MarkerCluster 添加到谷歌地图，不出现

> ID：11089071
> 
> 赞同：-1
> 
> 时间：2012-06-18T18:44:50.640
> 
> 标签：google-maps, google-maps-api-3

我正在尝试将 MarkerCluster 功能添加到带有标记的现有 Google 地图中。使用 API 说明，我尝试添加最简单的示例来开始。不幸的是，它使地图消失了。

我假设我将 markerClsuter 变量放在错误的位置，但我不能确定。我的 JavaScript 不好，所以有点混乱。

提前为冗长的代码道歉，但我想提供尽可能多的上下文。

任何见解表示赞赏。

```
function mainGeo()
{
     if (navigator.geolocation) 
        {
          navigator.geolocation.getCurrentPosition( mainMap, error, {maximumAge: 30000, timeout: 10000, enableHighAccuracy: true} );
    }
    else
    {
          alert("Sorry, but it looks like your browser does not support geolocation.");
    }
}

var stories = {{story_Json|safe}};
var geocoder;
var map;

var markers = [];

function loadMarkers(stories){
    for (i=0;i<stories.length;i++) {
        var story = stories[i];

        (function(story) {
            var pinColor = "69f2ff";
                var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor,
                    new google.maps.Size(21, 34),
                    new google.maps.Point(0,0),
                    new google.maps.Point(10, 34));
          var point = new google.maps.LatLng(story.latitude, story.longitude);
          var marker = new google.maps.Marker({position: point, map: map, icon: pinImage});
          var infowindow = new google.maps.InfoWindow({
            content: '<div >'+
                '<div >'+
                '</div>'+
                '<h2 class="firstHeading">'+story.headline+'</h2>'+
                '<div>'+
                '<p>'+story.author+'</p>'+
                '<p>'+story.copy+'</p>'+

                '</div>'+
                '</div>'

          });
          google.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map,this);
          });
        })(story);
    }
var markerCluster = new MarkerClusterer(map, markers);
}

 function mainMap(position)
 {
       geocoder = new google.maps.Geocoder();
       // Define the coordinates as a Google Maps LatLng Object
       var coords = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

       // Prepare the map options
       var mapOptions =
      {
                  zoom: 15,
                  center: coords,
                  mapTypeControl: false,
                  navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
                  mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        // Create the map, and place it in the map_canvas div
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

        // Place the initial marker
        var marker = new google.maps.Marker({
                  position: coords,
                  map: map,
                  title: "Your current location!"
        });

        loadMarkers(stories);

    }

  function codeAddress() {
    var address = document.getElementById("address").value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T02:30:25.247

当您的地图消失时，很可能是因为某处的语法错误。也许您错过了逗号或分号。当您编辑标记并且标记代码不正确时，通常会加载地图而标记不会加载。

另请注意，如果您向标记添加了新代码，标记集群和标记管理器也将需要更改核心变量。

例如，当我决定创建一个新函数来使用带有标签的标记时，这使得标记管理器对我不起作用，除非我还为标记管理器添加了一个新函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T21:36:47.080

[使用 MarkerClusterer 的“简单”示例](http://www.geocodezip.com/MarkerClusterer_simple_exampleA.html)的工作副本，显然不包括您的数据，因为您没有提供。

# php - php委派密集任务

> ID：11089073
> 
> 赞同：0
> 
> 时间：2012-06-18T18:45:07.030
> 
> 标签：php

我正在尝试为我的应用程序创建一个邮件功能，用户可以在其中向每个订阅者发送电子邮件。问题是这可能需要相当长的时间，具体取决于订阅者的数量。我想把它放在用户编写消息并将其发送到服务器的地方。然后服务器将“委派”要在 http 请求之外执行的任务。这样，可以将“事务”ID 发送给客户端，客户端反过来可以定期“轮询”服务器以检查电子邮件事务的进度。我可以通过哪些方式（或一种方式）来实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:51:52.780

您正在描述一个消息队列（在这种情况下，“消息”和“工作”可以互换使用）。它的工作原理是将一条消息弹出到队列中，其中包含有关要完成的工作的信息。工作人员不断检查队列是否有新消息。一旦找到，worker 将获得消息的所有权，将其从队列中删除，并执行它被编程执行的任何操作。

我以前用过[Gearman](http://us.php.net/manual/en/book.gearman.php)。他们有一些[很好的例子](http://us.php.net/manual/en/gearman.examples.php)来展示消息队列的基础知识。

*   [简单的反向示例](http://us.php.net/manual/en/gearman.examples-reverse.php)
*   [后台任务](http://us.php.net/manual/en/gearman.examples-reverse-bg.php)

有两种类型的工作：前台和后台。

## 前台工作

前台作业被阻塞，因为您的 PHP 代码将等待作业完成，然后再继续。这旨在将硬件密集型处理卸载到工作人员（很可能在与 webhead 不同的服务器上运行）。

## 后台作业

后台作业没有阻塞。这些是发送到队列并假定稍后工作的作业。一个很好的例子是由查询生成的报告，该查询需要几分钟才能运行并在准备好后通过电子邮件（或以其他方式发送）给用户。

# node.js - 使用 node.js v0.6.18 安装 socket.io。ws 在安装过程中失败

> ID：11089082
> 
> 赞同：1
> 
> 时间：2012-06-18T18:45:36.617
> 
> 标签：node.js, websocket, socket.io

我正在尝试在 beaglebone (linux angstrom) 上使用 npm 安装 socket.io

/> npm 安装 socket.io

它在具有旧内核的旧版本节点上运行良好。我现在正在使用节点 v0.6.18。

当 npm triing 安装应该与 socket.io 一起安装的 ws 时似乎有问题

如果我尝试，我会得到同样的错误：

```
npm install ws --ws:verbose 
```

结果如下：

```
root@beaglebone:~# npm install ws --ws:verbose
npm http GET https://registry.npmjs.org/ws
npm http 304 https://registry.npmjs.org/ws
npm http GET https://registry.npmjs.org/commander
npm http GET https://registry.npmjs.org/tinycolor
npm http GET https://registry.npmjs.org/options
npm http 304 https://registry.npmjs.org/commander
npm http 304 https://registry.npmjs.org/tinycolor
npm http 304 https://registry.npmjs.org/options

> ws@0.4.18 install /home/root/node_modules/ws
> node install.js

[ws v0.4.18] Attempting to compile blazing fast native extensions.
info it worked if it ends with ok 
spawn python [ '/home/root/.node-gyp/0.6.18/tools/gyp_addon',
  'binding.gyp',
  '-I/home/root/node_modules/ws/build/config.gypi',
  '-f',
  'make' ]
Traceback (most recent call last):
  File "/home/root/.node-gyp/0.6.18/tools/gyp_addon", line 14, in <module>
    import gyp
  File "/home/root/.node-gyp/0.6.18/tools/gyp/pylib/gyp/__init__.py", line 8, in <module>
    import gyp.input
  File "/home/root/.node-gyp/0.6.18/tools/gyp/pylib/gyp/input.py", line 5, in <module>
    from compiler.ast import Const
ImportError: No module named compiler.ast
ERR! Error: `gyp_addon` failed with exit code: 1
    at ChildProcess.onCpExit (/usr/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:226:16)
    at ChildProcess.emit (events.js:70:17)
    at maybeExit (child_process.js:362:16)
    at Process.onexit (child_process.js:398:5)
ERR! not ok
[ws v0.4.18] Native extension compilation failed.
[ws v0.4.18] On Windows, native extensions require Visual Studio and Python.
[ws v0.4.18] On Unix, native extensions require Python, make and a C++ compiler.
[ws v0.4.18] Start npm with --ws:verbose to show compilation output (if any).
ws@0.4.18 ./node_modules/ws
├── tinycolor@0.0.1
├── options@0.0.3
└── commander@0.5.2
root@beaglebone:~# 
```

我正在使用内核 3.2.18

```
root@beaglebone:~# uname -a
Linux beaglebone 3.2.18 #1 Thu Jun 14 23:26:20 CEST 2012 armv7l GNU/Linux
root@beaglebone:~# 
```

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:14:45.047

这并不是真正的错误。不需要本机扩展 - 它只是恰好使 websockets 快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:24:41.457

我不知道，但我做了一个完整的升级，看看我是否能找到任何东西，但我没有（一切正常）。我不得不重新发出命令两次 ( `npm up -g`) 才能完成，这归因于上游服务器或网络问题。无论如何，这就是我所拥有的一切正常（一个基本的 Ubuntu 12.04 x64 系统）：

```
Linux marius-i7 3.2.0-25-generic #40-Ubuntu SMP Wed May 23 20:30:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
node -v: v0.6.19
ws@0.4.18
python --version: 2.7.3 
```

`npm install -g ws --ws:verbose`输出：

```
/usr/local/bin/wscat -> /usr/local/lib/node_modules/ws/bin/wscat

> ws@0.4.18 install /usr/local/lib/node_modules/ws
> node install.js

[ws v0.4.18] Attempting to compile blazing fast native extensions.
make: Entering directory `/usr/local/lib/node_modules/ws/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node: Finished
  COPY Release/bufferutil.node
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/obj.target/validation.node
  SOLINK_MODULE(target) Release/obj.target/validation.node: Finished
  COPY Release/validation.node
make: Leaving directory `/usr/local/lib/node_modules/ws/build'
[ws v0.4.18] Native extension compilation successful!
tinycolor@0.0.1 /usr/local/lib/node_modules/ws/node_modules/tinycolor

options@0.0.3 /usr/local/lib/node_modules/ws/node_modules/options

commander@0.5.2 /usr/local/lib/node_modules/ws/node_modules/commander

ws@0.4.18 /usr/local/lib/node_modules/ws 
```

我看到你在使用手臂系统。对不起，我不能帮你。

# php - 从 foreach 循环建立一个数组

> ID：11089083
> 
> 赞同：0
> 
> 时间：2012-06-18T18:45:42.973
> 
> 标签：php

我有一个表格，允许用户注册多个事件。它们以带有复选框的形式列出（均以`registrations[]`事件 ID 作为值命名）并作为数组提交。

随后的页面循环遍历每个“已检查”事件，为每个事件向数据库添加一条记录：

```
foreach ($_POST['registrations'] as $registration) {

$query="SELECT exhibitions.exhib_id, DATE_FORMAT(exhibitions.exhib_date, %d/%m/%y'), venues.venue_name FROM exhibitions, venues WHERE     exhibitions.venue_id='$registration' AND venues.venue_id='$registration' LIMIT 1";
$result=mysql_query($query);
$vr=mysql_fetch_array($result, MYSQL_NUM);
$exhib_id=$vr[0];
$exhib_date=$vr[1];
$exhib_venue=$vr[2];

// do database stuff here

} 
```

我需要做的是将每`$exhib_date`一个存储`$exhib_venue`在一个单独的数组中，以后可以重复使用（在确认电子邮件中，它将列出用户注册的所有事件）。

我认为这就像在 foreach 循环之外建立一个新数组一样简单，例如，在 foreach 循环**中****向**`$events_attending=array();`数组中添加元素，例如和.**`$events_attending['date'] = $exhib_date;``$events_attending['venue'] = $exhib_venue;`**

 **我已经测试了这个减去 foreach 循环`print_r()`，它工作正常 - 所以我猜这就是我的问题所在？

任何人都可以提供帮助吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T18:50:47.280

您的猜测是正确的，您只是错过了一个小（但很大）的细节。您需要将该数组的每一行与某种其他标识符区分开来。例如：

```
$events_attending[$exhib_id]['date'] = $exhib_date;
$events_attending[$exhib_id]['venue'] = $exhib_venue; 
```

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T18:53:15.063

看起来您正在覆盖数组中的相同条目。尝试这个：

```
$events_attending[] = array('date' => $exhib_date, 'venue' => $exhib_venue); 
```

顺便说一句，在我看来，您应该真正使用 mysql_fetch_assoc() 代替 mysql_fetch_array()，它确实有助于在维护代码时避免错误。

哦，是的，请务必在您在查询中注入的 POST 值上使用 mysql_real_escape_string()，人们可以进行 SQL 注入！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T18:49:23.173

除了清理您的 $_POST 数据之外，请尝试：

```
foreach ($_POST['registrations'] as $registration) {

    $query="SELECT exhibitions.exhib_id, DATE_FORMAT(exhibitions.exhib_date, %d/%m/%y'), venues.venue_name FROM exhibitions, venues WHERE     exhibitions.venue_id='$registration' AND venues.venue_id='$registration' LIMIT 1";
    $result=mysql_query($query);
    $vr=mysql_fetch_array($result, MYSQL_NUM);
    $event[$exhib_id] = array('date' => $vr[1], 'venue' => $vr[2]);

// do database stuff here

} 
```

然后你可以做一个：

```
print_r($event);

Array(
    [1] => Array (
             date => 'event date',
             venue => 'venue'
           )
    [2] => Array (
             date => 'event date',
             venue => 'venue'
           ) 
```

如果你知道你想要什么事件，你可以打电话：

```
$event[2]['date'] to get event date, or $event[2]['venue'] for the venue, etc. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T18:50:01.020

```
$events_attending[] = array( 'date' => $exhib_date, 'venue' => $exhib_venue ); 
```

这会将您的值附加到数组的末尾，而不是在每次循环迭代时覆盖它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T18:50:06.667

我认为最简单的方法是更改​​这些行

```
$exhib_date=$vr[1];
$exhib_venue=$vr[2]; 
```

至

```
$exhib_date[]=$vr[1];
$exhib_venue[]=$vr[2]; 
```

然后你将有两个数组供以后使用

```
$exhib_date
$exhib_venue 
```**

# sql - SQL中两个同名的临时表

> ID：11089085
> 
> 赞同：2
> 
> 时间：2012-06-18T18:45:48.783
> 
> 标签：sql, sql-server, foxpro

我们正在将 foxpro 数据库重写为 SQL。我遇到了以下情况。`if`Foxpro 可以在两个不同的语句下创建两个具有相同名称的游标。

我试图在 SQL 中做同样的事情。创建了两个临时表。如下所示：

```
IF @id = 1
BEGIN
SELECT * INTO #abc from table1
END

IF @id = 2
BEGIN
SELECT * INTO #abc frm table2
END 
```

NEXT 这里我写了一个代码来用另一列更新一个临时表列的值。但是 sql 向我抛出一个错误，说“数据库中已经有一个名为 #abc 的对象”。

请问我可以解决这个问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:09:22.137

`SELECT INTO`为什么不先定义表，然后再定义表`INSERT`（假设两者的临时表结构相同），而不是创建表？

```
CREATE TABLE #abc (Col1 Int, Col2 varchar(50))

IF @id = 1
BEGIN
  INSERT INTO #abc SELECT * from table1
END

IF @id = 2
BEGIN
  INSERT INTO #abc SELECT * from table2
END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:11:56.483

对于您的特定用例，鉴于两者具有您可以使用的相同结构。

```
IF @id IN ( 1, 2 )
  BEGIN
      SELECT *
      INTO   #abc
      FROM   table1
      WHERE  @id = 1
      UNION ALL
      SELECT *
      FROM   table2
      WHERE  @id = 2
  END 
```

以避免您遇到的解析器问题。我同意 Ben 的评论，尽管 FoxPro 代码的直译可能会导致您陷入低效且无法维护的混乱局面。

# .net - 带有 C# Entity Framework 的 MySQL 适配器 - 空闲后连接缓慢

> ID：11089088
> 
> 赞同：1
> 
> 时间：2012-06-18T18:45:55.877
> 
> 标签：.net, mysql, c#-4.0, entity-framework-4

我在 .NET 4 中有一个带有实体框架的程序和带有 MySQL.NET 适配器版本 6.5.4 的 MySQL。在我让程序空闲一段时间（比如 5 分钟）并尝试搜索数据库后，会有大约 5-6 秒的延迟。但在那之后，搜索将再次快速。

我对延迟进行了分析，发现实体框架正在尝试在一定的空闲时间后重新建立与数据库的连接，从而导致延迟。由于我的程序将仅在大约 20 台机器的小组中使用，我希望保持连接始终处于活动状态以加快查找速度。有没有办法做到这一点？如果没有，在这种情况下如何提高与 MySQL 的连接速度？

**编辑（更新）：**

我在连接字符串中设置“Min Pool Size=1”后发现，即使长时间空闲也不会有任何延迟。它似乎解决了我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:47:55.807

持久连接很少是一个好主意，但话虽如此......

您可以在 ObjectContext 上执行此命令：

```
yourObjectContext.ExecuteStoreCommand("SET SESSION wait_timeout=28800;"); 
```

这应该告诉数据库保持连接打开 8 小时。

# asp.net - 在开发时防止缓存 javascripts 和 css

> ID：11089089
> 
> 赞同：3
> 
> 时间：2012-06-18T18:45:59.370
> 
> 标签：asp.net, visual-studio-2010

我目前正在从 Visual Studio 2010 开发和运行我的网站。该网站在编译后在 Google Chrome 中启动。

一路上的某个地方，东西被缓存了。我可以更改 javascript 函数，但除非我清除 chrome 中的缓存，否则旧版本的脚本正在运行。

我正在使用 .net 3.5 和最新版本的 Google Chrome 运行 Visual Studio 2010。

是否可以每次都自动加载最新的脚本？我真的不想每次保存和编译时都在我的脚本标签上添加一个 ? 参数。每次都必须清除缓存已经过时了。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-18T18:50:05.240

打开 Chrome 开发工具。在右下角有一个齿轮图标。单击它，然后单击“禁用缓存”。

还有一个选项“向右停靠”。试试看，也许，你会喜欢它！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T18:59:54.500

您还可以让服务器将以下标头添加到从服务器发出的请求中：

```
cache-control:no-store, no-cache, must-revalidate, max-age=0 
```

此外，您可以使用禁用缓存的命令行标志启动 chrome。为此，请创建一个新的快捷方式并在目标框中键入以下内容，替换为您自己的计算机用户名：

```
C:\Users\<username here>\AppData\Local\Google\Chrome\Application\chrome.exe --disk-cache-size=1 -media-cache-size=1 
```

标志必须设置为 1，因为 0 是无限的。数字以字节为单位。

希望这可以帮助。

**编辑：**要在没有缓存的情况下仅重新加载一次页面，请按`CTRL+SHIFT+R`。这*应该*适用于所有浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T19:10:01.270

我使用的简单方法是`CTRL`-`F5`每次打开 chrome 时，或者，您可以在运行应用程序之前终止本地 Web 服务器：

![在此处输入图像描述](../Images/a31f15b8d0b185cec9191a2382464785.png)

请参阅 chrome 快捷键列表以获取更多信息：[键盘快捷键](https://support.google.com/chrome/bin/answer.py?hl=en&answer=157179)。请注意`CTRL`-`F5`以及`SHIFT`-`F5`将重新加载当前页面，同时忽略缓存的内容。

我通常使用上述方法而不是一起禁用缓存（从 chrome 设置），因为这是我想要取消缓存的本地化情况。所有其他情况（如正常浏览）我更愿意保留缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T18:51:04.843

您始终可以使用一些参数导入 javascript 源代码：

```
<script type="text/javascript" src="../scripts/scriptFile.js?28361823"></script> 
```

大多数人使用 getTimeInMillis() 函数来填充请求。这将绕过缓存（通常），您将获得最新数据。

这也将迫使您的用户再次获取 javascript，所以要小心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-05T06:02:40.407

如果您想防止在浏览器中缓存 css 或 javascript 文件，请在链接中使用随机版本 ID。例如使用这个：

```
<link   href=<%="'mystyle.css?version="+ DateTime.Now.ToString("yyyyMMddhhmmss") +"'"%>   rel="stylesheet" type="text/css"/> 
```

其中 myStyle.css 是样式表文件，而 DateTime.Now.ToString("yyyyMMddhhmmss") 函数用于生成随机的不同版本 ID。

# session - 使用 ADFS 的单页应用程序 - 超时问题

> ID：11089093
> 
> 赞同：3
> 
> 时间：2012-06-18T18:46:14.280
> 
> 标签：session, timeout, adfs

我正在使用 ASP.Net MVC3 和 ADFS（使用被动联合）创建单页应用程序 (SPA)。除了我所说的“从 ADFS 重新验证”之外，一切都按预期工作。网站将定期（少于 30 分钟）尝试使用 STS 重新验证用户身份。这很好，但是 Web 应用程序是作为单页面应用程序构建的，因此一旦页面加载，我们就永远不会重新加载页面。此外，重新认证请求通常发生在 ajax 调用期间。

ADFS 具有 WebSSOLifetime 和 TokenLifetime 的默认设置。

有没有办法：a）在后台从javascript静默重新验证用户（也许创造性地使用CORS和/或JSONP）？或 b) 延长重新认证请求之间的时间？或 c) 别的东西。

关于 b) 似乎我可以设置 persistentCookiesOnPassiveRedirects="true" 然后在 cookieHandler 中将 persistentSessionLifetime 设置为所需的值。

```
<wsFederation persistentCookiesOnPassiveRedirects="true" passiveRedirectEnabled="true" issuer="xxx" realm="yyy" requireHttps="true" />
    <cookieHandler requireSsl="true" persistentSessionLifetime="0.8:0:0" path="/" /> 
```

但是，我宁愿不使用持久性 cookie。

最后，我使用了此处描述的 Freshness 设置：[如何在与 ADFS 2.0 联合](https://stackoverflow.com/questions/9130999/how-to-set-the-timeout-properly-when-federating-with-the-adfs-2-0)但未成功时正确设置超时。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T18:50:34.503

关于 b)，您想要的设置是 Token Lifetime。[您可以使用Set-AdfsRelyingPartyTrust](http://technet.microsoft.com/en-us/library/ee892363.aspx) PowerShell 脚本更新此值：

```
Set-AdfsRelyingPartyTrust -TargetName "My App" -TokenLifetime 120 
```

令牌生命周期的值以分钟为单位。AD FS 2.0 的默认值 (0) 是 60 分钟。

至于 a)，我知道的唯一方法是捕获 ajax 调用引发的异常并刷新您的单个页面。

# c# - 时间：2019-04-10 标签：c#webclientasync

> ID：11089095
> 
> 赞同：2
> 
> 时间：2012-06-18T18:46:41.273
> 
> 标签：c#, asynchronous, webclient

我继承了 ac# 应用程序，该应用程序通过 Webclient downloadfileasync 从约 380 个站点采样数据。为每个站点创建一个单独的线程！（在下载下一个数据之前，每次下载都会等待一个超时时间 - 所以负载不是恒定的......但仍然！）无论如何，随着网站数量在未来一年左右（可能会急剧增加）增加，我想将其更改为几个（合理数量）的工作线程，它们为站点的子集发出一堆 Webclient 下载文件异步调用。但我不确定如果多个下载同时完成会发生什么 - downloadfilecompleted 事件处理程序是否会被 webclient 序列化？或者多个 webclient 完成是否可以“同时”发生（或者更有可能，交错）？我会冒一个完成破坏另一个完成的风险吗？或者是否有人对如何管理当前实现中的线程爆炸有更好的建议？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:49:43.940

我*预计*可能会同时引发多个完成事件 - 但除非*您*有一些不小心处理的共享状态，否则应该没问题。结果不应该被“破坏”——如果他们这样做了，那绝对是 .NET 中的一个错误。

请注意，如果您使用异步调用，您可能不需要工作线程 - 做异步操作的全部意义在于您发出调用然后*不*阻塞线程，因此可以从UI线程（或其他）。

如果您能够使用尖端技术，C# 5 / .NET 4.5（处于候选发布模式）中的 async/await 功能可以让您的生活更轻松。

# database - 如何使用 perl 将数据库的每一行保存为目录中的单独数据块文件？

> ID：11089098
> 
> 赞同：1
> 
> 时间：2012-06-18T18:46:48.073
> 
> 标签：database, arrays, perl, hash

现在，我有一个大约 20 列和 70 行的数据库。我想遍历每一行并将每一行保存为一个单独的数据块，文件名由前三列生成。我已经有 SQL 代码选择我想要的特定列并根据我想要的参数对其进行排序。我想要文件的目录位于`c:/database/first_past`.

在我的代码中，`$ds`是一个散列数组变量，即我当前的数据库。我有两个 for 循环遍历数据库并进入该行，但我不确定要插入的行以将行保存为上面提到的目录中自己的单独文件，并带有特定的标题参数。

这在 Perl 中可能吗？这是我目前正在使用的代码的一部分：

```
for my $rec (@{$ds->{DATA}}) {
    for my $role (keys %{$rec} } {
        #here is the save file line? ("$role=$rec->{$role}"
    }
} 
```

`$ds`是一个哈希数组，该`DATA`字段是一行的所有数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:24:07.453

```
use DBI qw( );

my $dbh = DBI->connect($dsn, $user, $passwd, {
   RaiseError       => 1,
   PrintError       => 0,
   PrintWarn        => 1,
   AutoCommit       => 1,
   FetchHashKeyName => 'NAME_lc',
});

my $sth = $dbh->prepare('
    SELECT *
      FROM Table
     ORDER BY ...
');

$sth->execute();
while (my $row = $sth->fetch()) {
    my $fn = join('-', @{$row}[0,1,2]);
    my $qfn = "c:\\database\\first_past\\" . $fn;
    open(my $fh, '>', $qfn) or die $!;
    print($fh ...);
} 
```

[DBI](http://search.cpan.org/perldoc?DBI) , [`open`](http://perldoc.perl.org/functions/open.html),[`print`](http://perldoc.perl.org/functions/print.html)

* * *

对于您的后续问题：

```
$sth->execute();
while (my $row = $sth->fetch()) {
    my $fn = join('-', @{$row}[0,1,2]);
    my $qfn = "c:\\database\\first_past\\" . $fn;
    open(my $fh, '>>', $qfn) or die $!;
    print($fh ...);
} 
```

或者

```
my $last_fn;
my $fh;
$sth->execute();
while (my $row = $sth->fetch()) {
    my $fn = join('-', @{$row}[0,1,2]);
    if (!defined($last_fn) || $last_fn ne $fn) {
        $last_fn = $fn;
        my $qfn = "c:\\database\\first_past\\" . $fn;
        open($fh, '>', $qfn) or die $!;
    }

    print($fh ...);
} 
```

# rspec - TeamCity Server 无法与 Rspec/Turnip/Capybara 集成测试一起使用

> ID：11089102
> 
> 赞同：1
> 
> 时间：2012-06-18T18:46:57.020
> 
> 标签：rspec, continuous-integration, teamcity, capybara, gherkin

我一直在为[rspec](http://rspec.info/)、[capybara](https://github.com/jnicklas/capybara)和[turnip](https://github.com/jnicklas/turnip)中的 Web 应用程序编写集成测试。

当我在命令行上使用 rake :name_of_task 在本地机器上运行测试时，它可以正常工作，并且会弹出浏览器和所有内容。我的 rake 任务在这里：

```
desc "Run Integration Tests"
RSpec::Core::RakeTask.new(:integration_test) do |t|
  t.pattern = 'spec/*'
  t.rspec_opts =  ["--format documentation", "--format documentation", "--out spec/rspec_logs/rspec_log.txt"]
end 
```

在 TeamCity 中，我使用以下选项进行了构建配置以运行测试：

跑步者类型：耙

启动参数：使用'bundle exec'

附记者：RSpec

当我运行构建时，我得到了成功......只是没有运行！

```
[Execute idme:integration_test] /opt/TeamCity/buildAgent/work/92c98e465299a9e1/spec/extension_helper.rb:3: warning: already initialized constant FIREFOX_PROTOCOL
[11:50:34][Execute idme:integration_test] 
[11:50:34][Execute idme:integration_test] Starting.. (0 examples)
[11:50:34][Execute idme:integration_test] 
[11:50:34][Execute idme:integration_test] 0 examples, 0 failures, 0 passed
[11:50:34][Execute idme:integration_test] 
[11:50:34][Execute idme:integration_test] Finished in 0.000370012 seconds
[11:50:34][Execute idme:integration_test] 
[11:50:34][Step 2/2] Process exited with code 0 
```

我真的不知道该怎么做。任何人都可以帮忙吗？

# c# - 使用 ItemsSource 时操作无效。改为使用 ItemsControl.ItemsSource 访问和修改元素

> ID：11089104
> 
> 赞同：30
> 
> 时间：2012-06-18T18:47:04.827
> 
> 标签：c#, wpf, xml, listview, multiple-columns

我最近是 Binding 和 WPF 的新手，我学会了如何`listBox`使用 Binding 技术创建具有多个列的

```
 <ListView ItemsSource="{Binding Items}" Margin="306,70,22,17" MouseDoubleClick="listBoxSS_MouseDoubleClick" Name="listBoxSS" >           
    <ListView.View>
            <GridView>
                <GridView.Columns>
                    <GridViewColumn Header="first_name " Width="100" DisplayMemberBinding="{Binding Path=First_name}" />
                    <GridViewColumn Header="last_name" Width="100" DisplayMemberBinding="{Binding Path=Last_name}" />
                    <GridViewColumn Header="phone_number" Width="100" DisplayMemberBinding="{Binding Path=Phones[0]}" />
                    <GridViewColumn Header="notes" Width="100" DisplayMemberBinding="{Binding Path=Notes}" />
                </GridView.Columns>
            </GridView>
        </ListView.View>
    </ListView> 
```

这是代码：

```
List<Student> arr = search.students();
        listBoxSS.ItemsSource = arr; 
```

但问题是当我尝试使用添加或删除项目或清除

```
 listBoxSS.Items.Clear(); 
```

请我需要一个使用项目源的示例，或者我可以添加或删除项目或清除列表的方式。

**编辑：**

```
<ListView ItemsSource="{Binding Items}" Margin="306,70,22,17" MouseDoubleClick="listBoxSS_MouseDoubleClick" Name="listBoxSS" >
    <ListView.View>
        <GridView>
            <GridView.Columns>
                <GridViewColumn Header="first_name " Width="100" DisplayMemberBinding="{Binding Path=First_name}" />
                <GridViewColumn Header="last_name" Width="100" DisplayMemberBinding="{Binding Path=Last_name}" />
                <GridViewColumn Header="phone_number" Width="100" DisplayMemberBinding="{Binding Path=Phones[0]}" />
                <GridViewColumn Header="notes" Width="100" DisplayMemberBinding="{Binding Path=Notes}" />
            </GridView.Columns>
        </GridView>
    </ListView.View>
</ListView> 
```

这是代码：

```
 ObservableCollection<Employee> Gemployees;
var employees = new ObservableCollection<Employee>(search.employees()); 
```

`search.employees()`获取我的数据库中所有员工的列表

```
 listBoxPE.ItemsSource = employees;
        Gemployees = employees; 
```

现在我可以在 Gemployees 上执行所有方法

```
 Gemployees.Remove((Student)listBoxSS.SelectedItem);
 Gemployees.Add((Student)listBoxSS.SelectedItem); 
```

每当我从Gemployees`ListView`添加或删除项目时执行刷新！很酷，但在装订方面仍然有些努力。现在我正在为每个 ListView 做一个接口类，这样我就可以把我的东西放进去。它不会在添加项目中执行任何灵活性。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-18T19:32:20.643

您将 绑定到被调用`ItemsSource`的属性，因此要更新集合，您需要转到 中的属性并清除它。`DataContext``Items``Items``DataContext`

此外，该`Items`属性必须是 type `ObservableCollection`，`List`如果您希望它在底层集合更改时更新 UI，则不需要。

`ItemsSource`不需要您在后面的代码中设置的代码，应该将其删除。您只需要`ItemsSource`在一个地方设置，而不是同时设置。

这是它如何工作的一个简单示例：

```
// Using Students instead of Items for the PropertyName to clarify
public ObservableCollection<Student> Students { get; set; }

public MyConstructor()
{
    ...

    Students = search.students();
    listBoxSS.DataContext = this;
} 
```

现在当你有：

```
<ListView ItemsSource="{Binding Students}" ... /> 
```

您将 绑定`ItemsSource`到`ObservableCollection<Student>`，当您想清除列表时，您可以调用：

```
Students.Clear() 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-06-13T19:35:12.857

奇怪但真实：我的 XAML 文件中的以下错误击键产生了错误“在使用 ItemsSource 时操作无效。改为使用 ItemsControl.ItemsSource 访问和修改元素。”：

```
</ItemsControl.ItemTemplate>x` 
```

注意`x`` 结束元素标记后的字符。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-06-01T09:21:57.773

我知道这个问题大约在 2 年前就已经得到了回答，但是我自己也遇到了这个问题，并且自己想到了一个可行的解决方案。也许这在某些情况下不起作用，也许我根本没有看到什么，但它对我有用，所以我在这里分享它：

```
listView.ClearValue(ItemsControl.ItemsSourceProperty);
listView.ItemsSource = NewSource; 
```

我真诚地希望这对某人有所帮助。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-11-25T08:44:09.817

我认为[上面的答案](https://stackoverflow.com/a/24212698/3195477)不是很清楚。与流氓角色有关，这也会导致异常：

```
<ItemsControl ItemsSource="{Binding AnObservableCollection}">
    <Label Content="{Binding Name}"/>
</ItemsControl> 
```

当你的意思是：

```
<ItemsControl ItemsSource="{Binding AnObservableCollection}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <Label Content="{Binding Name}"/>
            </StackPanel>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

很容易认为第一个是正确的，而例外决不能解释什么是错的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-18T18:52:45.973

您需要针对数据绑定到您的`ItemsSource`. 为了获得集合更改通知（添加或删除项目时），您应该使用[`ObservableCollection<T>`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)：

```
var students = new ObservableCollection<Student>(search.students());
listBoxSS.ItemsSource = students;

students.Clear();
students.Add(new Student("ABC")); 
```

你应该`ItemsSource="{Binding Items}"`从你的 XAML 中删除声明。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-12-27T01:52:21.040

由于语法错误，我出现了相同的错误消息。事实证明，我不小心定义了一个`TreeView`已定义的项目`ItemsSource`。我为树视图定义了 a `DataTemplate`，但不小心将它直接放入`<TreeView>`而不是`<TreeView.Resources>`，导致错误。

我有什么：

```
<TreeView ItemSource ="{Binding Items}">
  <HierarchicalDataTemplate> ... </HierarchicalDataTemplate>
  <DataTemplate> ... </DataTemplate>
</TreeView> 
```

我应该有的：

```
<TreeView ItemSource ="{Binding Items}">
  <TreeView.Resources>
    <HierarchicalDataTemplate> ... </HierarchicalDataTemplate>
    <DataTemplate> ... </DataTemplate>
  </TreeView.Resources>
</TreeView> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-18T18:51:39.560

将列表框的 ItemsSource 属性分配给窗体类中的公共属性。然后尝试从中添加删除，在 setter 中调用 PropertyChanged，而不是直接在列表框项目源上调用 clear。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-20T19:04:36.730

始终将 ItemsSource 绑定到 ObservableCollection 以避免内存泄漏。ObservableCollection 还将导致显示通过添加/删除自动更新。在我学会这一点之前，我曾经总是绑定到数组。

一个有用的来源： [https ://onewindowsdev.com/2016/09/22/a-memory-leak-may-occur-when-you-use-data-binding-in-windows-presentation-foundation/](https://onewindowsdev.com/2016/09/22/a-memory-leak-may-occur-when-you-use-data-binding-in-windows-presentation-foundation/)

1) 对于一般的 DataBinding，您绑定的类应该实现 INotifyPropertyChanged。例外情况是使用 Mode=OneTime 绑定。

2) ItemsSource 应始终是实现 INotifyCollectionChange 的类。最简单的方法是使用 ObservableCollection。ObservableCollection 确实有一个构造函数，它接受一个我发现有用的 IEnumerable。

3) 如果 ItemsControl 是 ObservableCollection<SomeClass>，那么 SomeClass 应该实现 INotifyPropertyChange。然后，您可以安全地绑定到 SomeClass 的各个属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-11T02:21:47.227

我遇到了同样的问题，我最终意识到我试图将新项目直接添加到控件的 ItemsSource，而不是添加到用作 ItemsSource 的 ObservableCollection。

我想我会发布这个，因为它可能会帮助其他新手 wpfers。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-25T11:57:03.900

对我来说，这是完全不相关的问题。这是一个愚蠢的语法错误，我忘记`<style> </style>`用`<DataGrid.Style> </DataGrid.Style>`.

感谢 Microsoft 提供完全令人困惑的错误消息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-15T23:29:21.717

对我来说，问题是我误解了控件的说明，不小心把它放在了 datagrid 控件内部而不是外部。

```
 <DataGrid> 
        <mytag the tag for the open source control />
    </DataGrid> 
```

上面有人提到了无关字符，我突然意识到 DataGrid 可能不喜欢那里。我移动了它，瞧，错误

*使用 ItemsSource 时操作无效。改为使用 ItemsControl.ItemsSource 访问和修改元素。*

失去了！它确实与 ItemsSource 没有任何关系，但是无论解析器生成 Microsoft 错误，它都会让人感到困惑。

# ruby-on-rails - 仅部分渲染 find_by_tag

> ID：11089113
> 
> 赞同：0
> 
> 时间：2012-06-18T18:47:50.440
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, partial-views, tagging

我在我的应用程序中实现了一个标签系统，以便帖子可以应用不同的标签。我正在用这样的特定标签渲染帖子

```
 <% my_posts = post.find_by_tag("sports") %>
   <%= my_posts.each do |post| %>
   <%= post.title %><br />
   <%= post.body %><br />
 <% end %> 
```

唯一的问题是它只会在我的 _post.html.erb 部分或我的 show.html.erb 中呈现

当我尝试创建另一个部分时，例如 _fact.html.erb 它不会呈现

这是它工作的页面的帖子控制器

```
 def newest
     @posts = Post.paginate(:page => params[:page], :per_page => 10)
     @title = "Newest"
     @vote = Vote.new(params[:vote])

     respond_to do |format|
       format.html
       format.json { render :json => @users }
     end
   end 
```

在最新的视图中，我只是做了一个 <% render :partial => @posts %>

我想做同样的事情，除了 def sports 和 sports.html.erb 视图，但由于某种原因，当我这样做并使用除@posts 之外的另一个部分时，它不起作用。我已经在 def sports 中为@facts 添加了一行，所以不是这样，但我不确定问题可能是什么。

仍然是编程新手，因此将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T22:09:14.657

当你告诉 Rails 渲染一个集合时，它似乎做了一定的魔法，但是，由于自然不信任魔法，我更喜欢指定部分并使用 :collection 选项，正如我在回答这个问题时所描述的那样： [如何渲染在rails3中使用模板收集？](https://stackoverflow.com/questions/10916851/how-to-render-collection-with-template-in-rails3/10916962#10916962)

在你的情况下，假设你有一个`_fact.html.erb`partial in `views/things/`，大概你想做这样的事情：

```
<%= render :partial => 'things/fact', :collection => @facts %> 
```

# matlab - 用matlab求解这个微分方程？

> ID：11089116
> 
> 赞同：1
> 
> 时间：2012-06-18T18:48:10.383
> 
> 标签：matlab, math, equation

就是这样：y'(t)=y(t)/tt^2/y^2*ty(1)=1

我试过：函数hazi3b（）

[T,Y] = ode45(@bfugveny, [1 12], 1); 情节（T，Y，'gx'）

结尾

和：

函数 dy=bfugveny(t,y)

dy = y(t)/t - t^2/(y^2*t);

结尾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:52:15.827

你不需要写`y(t)`在你的公式中。

`y`传入你的预言机已经是-evaluated `y`-at-time-的猜测`t`。

所以试试

```
dy = y/t - t^2/(y^2*t); 
```

# ios - 在 iOS 上使用 LLVM 编译时，Sqlite FTS 不起作用

> ID：11089117
> 
> 赞同：4
> 
> 时间：2012-06-18T18:48:15.233
> 
> 标签：ios, sqlite, full-text-search, llvm

我一直在开发企业 iPad 应用程序一段时间。由于应用程序开发大约在 2 年前开始，我需要从源代码编译我自己的 SQLite 版本，因为默认的 SQLite 库（sqlite3.dylib）默认没有启用 FTS。

好的，从那时起一切正常。我一直使用 GCC 作为项目编译器。

问题是现在我正试图将我的整个项目转换为使用[ARC](http://clang.llvm.org/docs/AutomaticReferenceCounting.html)。为此，我需要使用 Apple 的[LLVM](http://llvm.org)编译器。

而已。当我更改编译器（从 GCC 4.2 到 LLVM 3.1 或 4.0，不转换为 ARC，也不更改任何其他内容）时，我的应用程序构建良好，一切运行正常，除了我的 FTS 查询，它根本不起作用甚至最简单的。它们运行并返回总是没有结果（不过使用 SQLITE_OK 代码）。

我被困在这里。我已经在 WWDC'12 上与一位 Apple 工程师交谈过，但我们找不到任何解决方案。

我保证它不太可能是格式错误的查询或类似的东西，因为该应用程序在 GCC 上运行良好。此外，我可以在终端版本的 SQLite 上运行查询（或使用其他应用程序，如 Base）

我也在使用旧版本的 SQLite，但我已经更新到迄今为止的最新版本（3.7.13）。一切都保持不变。我还注意到，现在（我不知道从什么时候开始）mac 附带的 sqlite 支持 FTS（！！！），我能够删除自己的版本并使用 Apple 的版本。问题是，我的行为完全相同。

我一直在寻找解决方案，但找不到。我发现了一些与 armv6 和编译器优化相关的错误（可以使用 -mno-thumb 标志修复），但这不是我的情况。我还注意到，当我使用 Clang 分析我的自定义 sqlite 文件时，它指出了很多很多“潜在错误”。

我有这个不怀疑的观点，我（仍然）不相信这是一个 LLVM 或 SQLite 错误。我更喜欢在解决它们之前检查所有可能的错误。也许我忘记配置某些东西或者需要向编译器添加一些我没有做的标志。

我很感激任何帮助。同样，该错误仅发生在使用 LLVM 编译的项目上（即使使用默认的 sqlite）。如果我在 sqlite3 的终端版本上运行相同的查询，一切都会好起来的。

更新：

此代码有效。它创建一个新数据库，一个使用 fts 的新虚拟表，插入几个项目，然后执行选择。稍后我将尝试更复杂的查询，但就目前而言，我的应用程序的问题可能正如预期的那样是我的代码中的错误。

```
NSArray *dirPaths = dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *docsDir = [dirPaths objectAtIndex:0];
sqlite3 *database;

// Build the path to the database file
NSString *databasePath = [[NSString alloc] initWithString: [docsDir stringByAppendingPathComponent: @"test.db"]];

NSFileManager *filemgr = [NSFileManager defaultManager];
NSError *error = nil;
[filemgr removeItemAtPath:databasePath error:&error];

const char *dbpath = [databasePath UTF8String];

if (sqlite3_open(dbpath, &database) == SQLITE_OK)
{
    char *errMsg;
    const char *sql_stmt = "CREATE VIRTUAL TABLE IF NOT EXISTS pages USING fts3(title, body);";

    if (sqlite3_exec(database, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK)
    {
        NSLog(@"Failed to create table");
    } else {

        sql_stmt = "INSERT INTO pages(docid, title, body) VALUES(53, 'Home Page', 'SQLite is a software...');";
        if (sqlite3_exec(database, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK)
        {
            NSLog(@"Failed to insert");
        }

        sql_stmt = "INSERT INTO pages(title, body) VALUES('Download', 'All SQLite source code...');";
        if (sqlite3_exec(database, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK)
        {
            NSLog(@"Failed to insert");
        }
    }

    sqlite3_stmt *statement;
    const char *query_stmt = "select * from pages where body match 'soft*';";

    if (sqlite3_prepare_v2(database, query_stmt, -1, &statement, NULL) == SQLITE_OK)
    {
        if (sqlite3_step(statement) == SQLITE_ROW)
        {
            NSLog(@"%@ - %@", [[NSString alloc] initWithUTF8String:(const char *) sqlite3_column_text(statement, 0)],
                  [[NSString alloc] initWithUTF8String:(const char *) sqlite3_column_text(statement, 1)]);
        } else {
            NSLog(@"no results");
        }
        sqlite3_finalize(statement);
    }

    sqlite3_close(database);

} else {
    NSLog(@"Failed to open/create database");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T18:04:29.997

毕竟，我已经找到了错误。它在我的代码中。总之，我发现：如果我有类似的东西（我知道这很奇怪/错误）：

```
int a = 0;
a = a++;
NSLog(@"%d", a); 
```

如果此代码使用 gcc 编译，则记录值为 1，如果使用 llvm 编译，则记录值为 0。

我不知道为什么，但这是另一个问题:)

# android - 我必须启动服务来控制后台媒体播放器的原因或好处是什么？

> ID：11089120
> 
> 赞同：2
> 
> 时间：2012-06-18T18:48:21.810
> 
> 标签：android, media-player

我阅读了 Android 文档 - [http://developer.android.com/guide/topics/media/mediaplayer.html](http://developer.android.com/guide/topics/media/mediaplayer.html)

它说“..您希望它在用户与其他应用程序交互时继续播放 - 那么您**必须**启动一个服务并从那里控制 MediaPlayer 实例。”

但是我发现如果我从一个活动开始一个本地音乐文件，然后离开那个活动，（例如，按 HOME 键并与另一个应用程序交互），音乐会继续播放。

所以，我不明白“文档中的“必须启动服务”。我错过了什么吗？

目前这对我的应用程序来说不是一个大障碍。我只是想知道如果我不使用服务可能会出现什么潜在问题。（服务的寿命更长，所以媒体播放器可以更早地被杀死，还有其他的吗？）

我们的开发基于Android 2.2。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:59:48.940

一个重要的原因是，如果您不使用服务，当活动暂停或终止时，用户将无法在您的应用程序之外收听音乐。从技术上讲，您可以制作一个音乐应用程序，但如果您的用户在另一个应用程序处于前台或手机处于不同状态（锁定）时无法听音乐，那么它不会成为一个非常好的应用程序。您应该查看活动生命周期以更深入地了解该过程。请注意，此行为是为节省电力、内存和 cpu 周期而设计的。

它也有助于不要在更传统的桌面开发使用中考虑服务。即使您的活动不活跃，您也希望这件事能够继续存在。

有关活动生命周期[的更多信息 管理活动生命周期](http://developer.android.com/training/basics/activity-lifecycle/index.html)

对于如何 [http://www.androidcompetencycenter.com/2009/01/basics-of-android-part-iii-android-services/](http://www.androidcompetencycenter.com/2009/01/basics-of-android-part-iii-android-services/)

为什么 [将服务用于后台任务很重要？](https://stackoverflow.com/questions/7737067/why-is-it-important-to-use-services-for-background-tasks)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:00:28.307

现在在 Activity 中播放音乐可能没问题，但是当 Android 资源不足时，它可能会试图杀死你的 Activity。当您将服务添加到应用程序时，如果该进程符合某些条件（例如播放音乐），Android 将尝试尽可能长时间地保持该进程。阅读服务的流程生命周期部分：

[http://developer.android.com/reference/android/app/Service.html#ProcessLifecycle](http://developer.android.com/reference/android/app/Service.html#ProcessLifecycle)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T18:50:38.750

该活动可能会被 Android 或用户杀死，然后音乐将停止播放。

# java - 比较 getString() 返回值时的意外结果

> ID：11089122
> 
> 赞同：1
> 
> 时间：2012-06-18T18:48:26.717
> 
> 标签：java

我面临的一个问题是我正在编码的 if 语句产生了错误的结果并且无法比较两个结果：

我的代码是：

`temp_code`有价值`130`也`rs.getString(employee_id)`有价值`130`_

```
String temp_code = rs.getString(employee_id);

if ((rs.getString(employee_id)).equals(temp_code)) 
{
out.println("employee IDs equal");
}
else
{
out.println("employee IDs not equal");
} 
```

但它给我的员工 ID 不相等

当我打印它们的值时，它们都是 130，当我打印以下值时：

```
out.println((rs.getString(employee_id)).equals(temp_code)); 
```

它正在产生错误的价值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T18:52:03.283

其中一个字符串可能包含空格字符。用其他字符将它们打印出来，例如：

```
out.println("[" + rs.getString(employee_id) + "]);
out.println("[" + temp_code + "]); 
```

# ruby - iTunes 10.6.3 更改 AppleScript 界面？

> ID：11089123
> 
> 赞同：3
> 
> 时间：2012-06-18T18:48:32.817
> 
> 标签：ruby, applescript, itunes, rb-appscript

我有一个简单的 Ruby 脚本，它使用 rb-appscript gem 来控制 iTunes，现在我已经更新到 iTunes 10.6.3，它似乎被破坏了。

在 10.6.3 之前，这段代码将按预期工作以获取当前选定的轨道：

```
Appscript.app('iTunes').selection.get() 
```

现在它产生以下错误：

```
RuntimeError: Unknown property, element or command: 'selection' 
```

*编辑：刚刚确认这在 py-appscript 中也被破坏了，因此它不与 rb-appscript 隔离。*

这很奇怪，因为以下实际 AppleScript 仍然有效：

```
tell application "iTunes" to get selection 
```

类似的例子，如`Appscript.app('Finder').desktop.files.get()`仍然有效。

我找不到任何信息来解释是否或为什么会更改，或者我可以做些什么来更新我的脚本。我猜这与Mountain Lion的变化有关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T20:16:22.623

看起来 iTunes 10.6.3 是随 Mountain Lion 一起发布的沙盒。这是一篇谈论它的文章（也请阅读评论）[http://www.leancrew.com/all-this/2012/06/the-first-nail-in-the-coffin-of-python-appscript/](http://www.leancrew.com/all-this/2012/06/the-first-nail-in-the-coffin-of-python-appscript/)

从山狮开始，可能会开始发生更多（如果不是所有事情的话）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-21T17:12:06.110

我在这里为这个问题提供了一个修复：

[https://github.com/mattneub/appscript/tree/master/rb-appscript](https://github.com/mattneub/appscript/tree/master/rb-appscript)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T20:45:57.477

是的，他们肯定把它弄坏了。您可以将 rb-appscript 与 System Events 应用程序一起使用，以有条件地检查各种 UI 元素的子元素，以查看“selected”属性是否为真......例如：

```
i = 0
row_exists = true
selected_row = nil
while row_exists && !selected_row
    i += 1
    row_exists = app("System Events").application_processes["iTunes"].windows["iTunes"].scroll_areas[3].outlines[1].rows[i].exists
    if row_exists 
        if (app("System Events").application_processes["iTunes"].windows["iTunes"].scroll_areas[3].outlines[1].rows[i].attributes["AXSelected"].value.get == true)
            selected_row = app("System Events").application_processes["iTunes"].windows["iTunes"].scroll_areas[3].outlines[1].rows[i]
        end
    end 
end 
```

然后，您可以从所选行的子项中提取所需信息。不过，这将是一种非常烦人的方式。

# sql - VARCHAR 转 DECIMAL

> ID：11089125
> 
> 赞同：37
> 
> 时间：2012-06-18T18:48:41.237
> 
> 标签：sql, sql-server

我想将一`varchar(max)`列转换为`decimal(10,4)`.

当我尝试使用`cast`或`convert`遇到算术溢出异常时。问题是存储在 varchar 列中的数据可能包含不同的精度和不同的比例。例如，123456789.1234567'、1.12345678 或 123456.1234。

对于像 123456.1234 这样的值，它正在转换没有任何问题，但对于其他值，我遇到了一些问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-18T21:55:36.103

经过测试，我发现问题不是小数位，而是精度（10）

这不起作用：将 varchar 转换为数字数据类型的算术溢出错误。

```
DECLARE @TestConvert VARCHAR(MAX) = '123456789.12343594'

SELECT CAST(@TestConvert AS DECIMAL(10, 4)) 
```

这有效

```
DECLARE @TestConvert VARCHAR(MAX) = '123456789.12343594'

SELECT CAST(@TestConvert AS DECIMAL(13, 4)) 
```

应该像 9 int + 4 floating = 13 chars

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-18T21:33:43.113

我的解释在代码中。:)

```
DECLARE @TestConvert VARCHAR(MAX) = '123456789.1234567'
BEGIN TRY
    SELECT CAST(@TestConvert AS DECIMAL(10, 4))
END TRY
BEGIN CATCH
    SELECT 'The reason you get the message "' + ERROR_MESSAGE() + '" is because DECIMAL(10, 4) only allows for 4 numbers after the decimal.'
END CATCH

-- Here's one way to truncate the string to a castable value.
SELECT CAST(LEFT(@TestConvert, (CHARINDEX('.', @TestConvert, 1) + 4)) AS DECIMAL(14, 4))

-- If you noticed, I changed it to DECIMAL(14, 4) instead of DECIMAL(10, 4) That's because this number has 14 digits, as proven below.
-- Read this for a better explanation as to what precision, scale and length mean: http://msdn.microsoft.com/en-us/library/ms190476(v=sql.105).aspx
SELECT LEN(LEFT(@TestConvert, (CHARINDEX('.', @TestConvert, 1) + 4))) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-04-28T17:20:25.910

我想出了以下解决方案：

```
SELECT [Str], DecimalParsed = CASE 
WHEN ISNUMERIC([Str]) = 1 AND CHARINDEX('.', [Str])=0 AND LEN(REPLACE(REPLACE([Str], '-', ''), '+', '')) < 29 THEN CONVERT(decimal(38,10), [Str])
WHEN ISNUMERIC([Str]) = 1 AND (CHARINDEX('.', [Str])!=0 AND CHARINDEX('.', REPLACE(REPLACE([Str], '-', ''), '+', ''))<=29) THEN 
    CONVERT(decimal(38,10), 
            CASE WHEN LEN([Str]) - LEN(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Str], '0', ''), '1', ''), '2', ''), '3', ''), '4', ''), '5', ''), '6', ''), '7', ''), '8', ''), '9', '')) <= 38 
                 THEN [Str] 
                 ELSE SUBSTRING([Str], 1, 38 + LEN(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Str], '0', ''), '1', ''), '2', ''), '3', ''), '4', ''), '5', ''), '6', ''), '7', ''), '8', ''), '9', ''))) END)
ELSE NULL END
FROM TestStrToDecimal 
```

我知道这看起来有点矫枉过正，可能确实是这样，但它对我有用（检查了不同精度和比例的正数、负数、大数和小数 - 一切都转换为`decimal(38,10)`or `NULL`）。

它是硬编码的`decimal(38,10)`，因此如果您需要不同的精度，请更改代码中的常量（38、10、29）。

**这个怎么运作？结果是**：

*   如果转换很简单，没有溢出或精度损失（例如 123 或 123.456），那么它只是转换它。
*   如果数字不是太大，但小数点后的数字太多（例如 123.1234567890123456789012345678901234567890），那么它会在最后修剪超出的数字，只保留前 38 个数字。
*   如果数字太大并且不能在没有溢出的情况下转换为十进制（例如 9876543210987654321098765432109876543210），则返回 NULL

在上面的代码中，每种情况都是单独的 WHEN 语句。

**以下是几个转换示例：** ![在此处输入图像描述](../Images/0baa582c292411683a53029fa7430056.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-25T05:24:57.327

您错过了 6.999,50 不是有效小数的事实。你肯定不能在十进制值中有逗号和小数点吗？它应该是什么数字？

假设您的语言环境指定 . 作为分组和 , 作为小数分隔符：删除分组数字：

选择转换（十进制（11,2），替换（'6.999,50'，'.'，''））

将产生 6999,50 作为小数

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-18T19:44:50.687

你还没有解释为什么你不能使用 Float 数据类型，所以这里有一个例子：

```
DECLARE @StringVal varchar(50)

SET @StringVal = '123456789.1234567'
SELECT @StringVal, CAST(@StringVal AS FLOAT)

SET @StringVal = '1.12345678'
SELECT @StringVal, CAST(@StringVal AS FLOAT)

SET @StringVal = '123456.1234'
SELECT @StringVal, CAST(@StringVal AS FLOAT) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-18T21:53:34.660

你的主要问题不是小数点右边的东西，而是左边的东西。类型声明中的两个值是精度和比例。

> 来自 MSDN：“精度是数字中的位数。比例是数字中小数点右侧的位数。例如，数字 123.45 的精度为 5，小数位数为 2。”

如果您指定 (10, 4)，则意味着您只能在小数点左侧存储 6 位数字，或者最大数字为 999999.9999。任何比这更大的都会导致溢出。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-18T18:52:39.527

在将它们放入该列之前，您必须自己将值截断为字符串。

否则，如果您想要更多小数位，则需要更改小数列的声明。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-08-02T09:23:39.393

使用自定义函数实现。这将检查字符串值是否可以安全地转换为十进制

```
CREATE FUNCTION [dbo].[TryParseAsDecimal]
(
    @Value      NVARCHAR(4000)
    ,@Precision INT
    ,@Scale     INT
)

RETURNS BIT
AS
BEGIN

    IF(ISNUMERIC(@Value) =0) BEGIN
        RETURN CAST(0 AS BIT)
    END
    SELECT @Value = REPLACE(@Value,',','') --Removes the comma

    --This function validates only the first part eg '1234567.8901111111'
    --It validates only the values before the '.' ie '1234567.'
    DECLARE @Index          INT
    DECLARE @Part1Length    INT 
    DECLARE @Part1          VARCHAR(4000)   

    SELECT @Index = CHARINDEX('.', @Value, 0)
    IF (@Index>0) BEGIN
        --If decimal places, extract the left part only and cast it to avoid leading zeros (eg.'0000000001' => '1')
        SELECT @Part1 =LEFT(@Value, @Index-1);
        SELECT @Part1=SUBSTRING(@Part1, PATINDEX('%[^0]%', @Part1+'.'), LEN(@Part1));
        SELECT @Part1Length = LEN(@Part1);
    END
    ELSE BEGIN
        SELECT @Part1 =CAST(@Value AS DECIMAL);
        SELECT @Part1Length= LEN(@Part1)
    END 

    IF (@Part1Length > (@Precision-@Scale)) BEGIN
        RETURN CAST(0 AS BIT)
    END

    RETURN CAST(1 AS BIT)

END 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-02-16T13:57:13.963

我知道这是一个老问题，但比尔似乎是唯一一个真正“解释”了这个问题的人。其他人似乎都在为滥用声明提出复杂的解决方案。

> “类型声明中的两个值是精度和比例。”

...

> “如果您指定 (10, 4)，这意味着您只能在小数点左侧存储 6 位数字，或者最大数字为 999999.9999。任何大于该数字的内容都会导致溢出。”

因此，如果您声明`DECIMAL(10,4)`总共可以有**10 个**数字，其中**4**个在小数点之后。所以 123456.1234 有 10 位，小数点后 4 位。这将适合`DECIMAL(10,4)`. 1234567.1234 会抛出错误。有 11 位数字适合 10 位数字空间，小数点后必须使用 4 位数字。修剪小数点左侧的数字不是一种选择。如果您的 11 个字符是 123456.12345，这不会引发错误，因为从十进制值末尾进行修整（舍入）是可以接受的。

声明小数时，请始终尝试声明您的列将实际使用的最大值以及您希望看到的最大小数位数。因此，如果您的列只显示最大值为 100 万的值，并且您只关心前两位小数，请声明为`DECIMAL(9,2)`. 在引发错误之前，这将为您提供最大数量的 9,999,999.99。

在尝试修复之前了解问题，将确保您选择适合您的情况的修复，并帮助您了解需要/有效修复的原因。

再说一次，我知道我迟到了五年。但是，我为此提供了两分钱的解决方案，（根据您的评论判断该列已设置为`DECIMAL(10,4)`并且无法更改）最简单的方法是两个步骤。检查你的小数点距离不超过 10 点，然后修剪到 10 位数。

```
CASE WHEN CHARINDEX('.',CONVERT(VARCHAR(50),[columnName]))>10 THEN 'DealWithIt'
ELSE LEFT(CONVERT(VARCHAR(50),[columnName]),10) 
END AS [10PointDecimalString] 
```

我将其保留为字符串的原因是您可以处理小数点左侧长度超过 10 位的值。

但它是一个开始。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-11-26T21:40:01.607

```
create function [Sistema].[fParseDecimal]
(
    @Valor nvarchar(4000)
)
returns decimal(18, 4) as begin
    declare @Valores table (Valor varchar(50));

    insert into @Valores values (@Valor);

    declare @Resultado decimal(18, 4) = (select top 1 
        cast('' as xml).value('sql:column("Valor") cast as xs:decimal ?', 'decimal(18, 4)')
    from @Valores);

    return @Resultado;
END 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-12T07:48:00.087

如果您需要 ROUND 结果，而不是截断，可以使用这个：

```
select convert(decimal(38,4), round(convert(decimal(38,10), '123456789.1234567'),4)) 
```

这将返回以下内容：

```
'123456789.1235' for '123456789.1234567'
'123456789.1234' for '123456789.1234467' 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-11-18T22:14:53.813

在 MySQL 中

```
select convert( if( listPrice REGEXP '^[0-9]+$', listPrice, '0' ), DECIMAL(15, 3) ) from MyProduct WHERE 1 
```

# java - 使用 Java 连接到 Oracle 数据库

> ID：11089129
> 
> 赞同：4
> 
> 时间：2012-06-18T18:49:07.747
> 
> 标签：java, oracle, jdbc

这段 Java 代码编译得很好，但是当我尝试运行它时，我得到：

> 线程“主”java.lang.ClassNotFoundException 中的异常：oracle.jdbc.driver.OracleDriver

这是我的代码：

```
import java.sql.*;

public class TestConnection {

    public static void main(String[] args) throws Exception {
        //connect to database
        Class.forName("oracle.jdbc.driver.OracleDriver");
        String serverName = "000.000.000.000";
        String portNumber = "1521";
        String sid = "abcd";
        String url = "jdbc:oracle:thin:@" + serverName + ":" + portNumber + ":" + sid;
        String username = "user";
        String password = "pass";
        Connection conn = DriverManager.getConnection(url, username, password);
    }
} 
```

我怎样才能让它工作？我正在使用 Ubuntu 11.04 和 JDK 6。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T18:50:47.573

您需要 Oracle 罐子。

你可以从[这里](http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html)得到它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-06T18:27:33.273

如果您使用的是 Maven：

```
<dependency>
    <groupId>com.oracle</groupId>
    <artifactId>ojdbc6</artifactId>
    <version>11.2.0</version>
</dependency> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-18T18:54:23.083

将*ojdbcXX.jar* -其中XX 是版本号 - 添加到项目的 Java 构建路径。除了类路径问题之外，不推荐使用请求“oracle.jdbc.driver.OracleDriver”。长期以来一直推荐使用：“oracle.jdbc.OracleDriver”。对于一些更新的驱动程序版本，前者甚至不起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T18:54:06.950

此外，您必须将这些 jar 添加到您的项目中。@Netbeans，您可以在项目属性中轻松做到这一点

# build - 有没有办法避免重复的参数化 Jenkins 构建？

> ID：11089133
> 
> 赞同：4
> 
> 时间：2012-06-18T18:49:37.720
> 
> 标签：build, continuous-integration, jenkins

我知道在 Jenkins 中，您可以通过取消选中“如有必要执行并发构建”复选框来避免重复构建相互运行。

但是，它确定并发构建的方式只是作业本身是否正在运行。我希望它根据传递给作业的所有参数是否相同来确定并发构建。

因此，如果我在队列中有一个带有参数 foo 和 bar 的作业，那么用 foo 和 baz 排队一个实际上应该排队，但是用参数 foo 和 bar 排队另一个应该放弃它。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T21:49:02.103

我相信如果以前排队的作业具有完全相同的参数，Jenkins 会自动终止排队的作业。如果一个作业使用参数 foo 和 bar 排队，那么同一个作业再次使用 foo 和 bar 排队，第二个实例被丢弃。

在您的示例中（第一份工作是 foo 和 bar，第二个工作是 foo 和 baz，第三个工作是 foo 和 bar），我相信所有工作都会排队。

# ios - Ipad 上的 Adwhirl 和 InMobi

> ID：11089134
> 
> 赞同：0
> 
> 时间：2012-06-18T18:49:38.260
> 
> 标签：ios, ipad, adwhirl, inmobi

我在我的新通用应用程序中实现了 Adwhirl。并且能够让admob适配器为Ipad运行......在帮助形成这个很好的[答案](https://stackoverflow.com/questions/7087834/adwhirl-ads-in-ipad)......

现在我坚持实施 InMobi。

我尝试更改获取广告功能，但它似乎对我不起作用：

```
IMAdView *inMobiView;

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
    {
        CGRect adFrame;
        adFrame.size = CGSizeMake(728,90);

        inMobiView = [[IMAdView alloc]
                      initWithFrame:adFrame
                      imAppId:[self siteId]
                      imAdUnit:IM_UNIT_728x90
                      rootViewController:[self rootViewControllerForAd]];

    } else {

        inMobiView = [[IMAdView alloc]
                                initWithFrame:kAdWhirlViewDefaultFrame
                                imAppId:[self siteId]
                                imAdUnit:IM_UNIT_320x50
                                rootViewController:[self rootViewControllerForAd]];
    }

  inMobiView.refreshInterval = REFRESH_INTERVAL_OFF;
  inMobiView.delegate = self;
  self.adNetworkView = [inMobiView autorelease]; 
```

你能看到我做错了什么吗？

非常感谢您的帮助。

问候

安瑟伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:54:29.443

由于您已“关闭”刷新间隔，IMAdView 不会自行加载广告请求。根据 InMobi & AdWhirl 文档，您只需在调用 inmobiView 上的 autorelease 之前再添加一行：

[inmobiView loadIMAdRequest]; 调用此方法将立即触发广告请求，您还可以通过传递可选的 IMAdRequest 实例来传递其他参数。

IMAdRequest *request = [IMAdRequest 请求]；//如果需要，分配可选参数。. . . [inmobiView loadIMAdRequest:request];

# css - 各种平台/浏览器支持什么 css 光标大小？

> ID：11089141
> 
> 赞同：0
> 
> 时间：2012-06-18T18:50:00.820
> 
> 标签：css

Firefox 说他们支持 128px 光标，但你必须保持在 32x32px 内才能支持“在所有平台上”。有谁知道哪些平台/浏览器支持什么尺寸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:59:25.663

我认为这可能是操作系统限制而不是浏览器限制。根据[W3 规范](http://www.w3.org/TR/CSS2/ui.html#cursor-props)：

> 光标的固有大小与背景图像一样计算，但使用 UA 定义的矩形代替为“背景图像”属性建立坐标系的矩形。这个 UA 定义的矩形应该基于 UA 操作系统上典型光标的大小。如果生成的光标大小不适合该矩形，UA 可以按比例缩小生成的光标，直到它适合该矩形。

如果您需要使用更大的光标，另一种方法是隐藏光标并使用 JavaScript 创建一个带有背景图像的 div，该背景图像跟随光标所到之处。

# php - 为表单下拉菜单使用对象

> ID：11089147
> 
> 赞同：0
> 
> 时间：2012-06-18T18:50:07.730
> 
> 标签：php, codeigniter

我试图弄清楚如何转动这个对象并将其用于我的下拉选项，但我很难理解如何使用 CodeIgniter 网站上的文档。

```
Array
(
[0] => stdClass Object
    (
        [id] => 1
        [event_name] => First City Shodown
        [status_id] => 1
    )

[1] => stdClass Object
    (
        [id] => 2
        [event_name] => First City Festival
        [status_id] => 1
    )

)

<?php 
$options = array(

);
?>
<?php echo form_dropdown('eventname', $options); ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:05:13.563

您要做的是遍历每个事件对象，并检索事件 ID 和事件名称。这可以通过使用 foreach 循环很容易地完成，因为事件对象存储在一个数组中。

假设这些对象存储在一个名为的数组中`$events`：

```
$options = array();

foreach ( $events as $event ) {
    $options[$event->id] = $event->event_name;
}

echo form_dropdown('eventname', $options); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:03:43.870

尝试

```
$options = array();
foreach($array as $object){
    $options["{$object->id}"] = $object->event_name;
}
echo form_dropdown('eventname', $options); 
```

# silverlight - Silverlight 中的滚动验证摘要

> ID：11089155
> 
> 赞同：0
> 
> 时间：2012-06-18T18:50:41.080
> 
> 标签：silverlight, validation, c#-4.0, silverlight-4.0

我正在尝试使 Silverlight 中的 ValidationSummary 可滚动。它不起作用，我不确定我做错了什么。

包裹在 ScrollViewer 中时，不会显示验证摘要。

```
<UserControl x:Class="SilverlightDataValidation.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:ct="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data.Input"       
mc:Ignorable="d"
d:DesignHeight="300" d:DesignWidth="400">

<Grid x:Name="LayoutRoot" Background="White" BindingValidationError="LayoutRoot_BindingValidationError">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="55" />
        <ColumnDefinition Width="345" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="25" />
        <RowDefinition Height="25" />
        <RowDefinition Height="25" />
        <RowDefinition Height="25" />
        <RowDefinition Height="160" />
        <RowDefinition Height="40*" />
    </Grid.RowDefinitions>
    <ScrollViewer Grid.Row="4" Height="135" HorizontalAlignment="Left" Margin="0,4,0,0" Name="scrollViewer1" VerticalAlignment="Top" MaxHeight="200" Width="333" Grid.Column="1" HorizontalScrollBarVisibility="Auto">
        <ct:ValidationSummary Width="300" Grid.Column="1" Margin="0,0,45,0" />
    </ScrollViewer>
    <TextBox Name="txtName" Text="{Binding Name, Mode=TwoWay, ValidatesOnExceptions =True, NotifyOnValidationError=True, UpdateSourceTrigger=Explicit}"
             Grid.Column="1" Grid.Row="1" 
             Height="23" HorizontalAlignment="Left" VerticalAlignment="Top" Width="185" />

    <TextBox Name="txtAge" 
             Text="{Binding Age, Mode=TwoWay, ValidatesOnExceptions=True, NotifyOnValidationError=True, UpdateSourceTrigger=Explicit}"
             Grid.Column="1" Grid.Row="2" 
             Height="23" HorizontalAlignment="Left"  VerticalAlignment="Top" Width="120" />

    <Button Content="Save" Grid.Column="1" Grid.Row="3" 
            Height="23" HorizontalAlignment="Left" Name="butSave" VerticalAlignment="Top" Width="75" Click="butSave_Click"  />

    <TextBlock Grid.Row="1" Name="textBlock1" Text="Name" 
               VerticalAlignment="Top" Margin="22,0,0,0" Height="23" HorizontalAlignment="Left" />
    <TextBlock Grid.Row="2"  Name="textBlock2" Text="Age" 
               VerticalAlignment="Top" Margin="34,0,0,0" Height="23" HorizontalAlignment="Left" />
</Grid> 
```

当您从 ScrollViewer 中删除验证摘要时，它会显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T17:15:11.007

不需要 ScrollView，可以通过在 ValidationSummary 上设置 maxheight 属性来实现相同的效果

# php - 将字符串隐藏到时间并在 PHP 中总结

> ID：11089163
> 
> 赞同：0
> 
> 时间：2012-06-18T18:51:28.577
> 
> 标签：php, forms, timestamp

我正在创建预订系统，并试图从表单值中总结时间字符串。前两个表单字段是用户选择的小时（9 到 18）和分钟（00 和 30）的起点，例如 9 和 30。

```
$time = "".$_POST['h'].":".$_POST['min'].":00"; 
```

第二个表单字段是项目将保留多长时间（30 分钟到 3 小时）。

```
<select name="reserved">
<option value="0:30">30 min.</option>
<option value="1:00">1:00 h.</option>
<option value="1:30">1:30 h.</option>
<option value="2:00">2 h.</option>
<option value="2:30">2:30 h.</option>
<option value="3:00">3 h.</option>
</select> 
```

所以我需要总结 $time 和“保留”下拉值以获得正确的总和时间 9:30 + 0:30 = 10:00。希望您能理解，谢谢您的建议。试图转换为时间戳并总结，但没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T18:54:11.850

为什么不尝试将时间组合为一个字符串，然后将其提供给`strtotime()`函数呢？这会给你一个时间戳。从那里你可以做任何你想做的操作。

[在此处](http://php.net/manual/en/function.strtotime.php)查看文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:05:28.833

给定开始时间为 9:30，预留时间为 0:30，用于`strtotime`获取开始时间的时间戳，并将其与预留时间的总秒数相加。

```
$a = '9:30';
$b = '0:30';
list($h, $m) = explode(':', $b);
echo date('H:i', strtotime($a) + $h*60*60 + $m*60); // 10:00 
```

# ember.js - 为什么我的 Ember.Router 会给出这个 TypeError？

> ID：11089166
> 
> 赞同：2
> 
> 时间：2012-06-18T18:51:36.557
> 
> 标签：ember.js

我正在使用从 git master 构建的 Ember。我的 RouteManager 并不复杂，但是当我尝试启动我的应用程序时，我收到了这个错误：

> 未捕获的类型错误：对象的属性“1”，不是函数

跟踪跟踪表明这是在应用程序初始化时发生的。

[这个 jsfiddle](http://fiddle.jshell.net/pjmorse/ubbcv/)显示了问题，尽管您必须在 javascript 控制台中查看错误消息。我的实际路由器将比这更复杂，但我已将其精简到骨头以试图消除潜在的错误源。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T21:30:25.173

随着注入 API 的更改，您需要将 Ember Data 的版本更新到 master 的最新版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T21:52:07.177

这是一个“有效”的小提琴。

[http://fiddle.jshell.net/Sly7/ZySzK/](http://fiddle.jshell.net/Sly7/ZySzK/)

我从在 stackoverflow 上找到的另一个小提琴中获取了一个 ember-data 资源。

填充数组控制器的方式很奇怪。通常你在控制器的 connectOutlet 方法中传递上下文，通过指定一个上下文（在你的情况下，它应该是 Sylvius.Section.find() ）我不知道为什么，但是这样做，我有错误'Sylvius .Section 没有方法 find'... 可能是由于 ember-data/emberjs 错误版本而导致的其他混乱。

# sql - 使用复合主键基于多条记录查询结果

> ID：11089170
> 
> 赞同：0
> 
> 时间：2012-06-18T18:51:54.903
> 
> 标签：sql, gridview, join, primary-key

根据选定的主键从数据库中获取记录的最佳方法是什么？

我能够从网格视图中获取选定（选中）行的主键，现在需要从数据库中检索这些选定复合主键的相应记录。

如果这些行只使用一个主键，那就更容易了。我可以只连接主键（逗号分隔）并在 WHERE IN 子句中使用它。但是这些行使用三个主键（int、int、string）

我正在考虑使用 SELECT JOIN（每组主键选择一个，然后加入所有选择），但我不确定这是否是最优化的方法。

处理这个问题的最佳方法是什么？

提前致谢。

尼基

[更新] - 无法回复个别评论，我可能还没有足够的权限，所以会在此处更新帖子以明确。

这是我正在做的一个例子：

来自一个具有复合键的数据库表的数据：

```
TABLE1
KeyCol1 INT (Primary Key),
KeyCol2 STRING (Primary Key),
KeyCol3 INT (Primary Key),
Col4    Decimal,
Col5    STRING,
Other columns . . . 
```

带有网格视图 1 的第 1 页：

```
Sel |KeyCol1 |KeyCol2 |KeyCol3 |Col4  |Col5          |Other Columns . . .
[ ] |100     |CODE1   |01      |10.05 |Description 1 |. . .
[/] |100     |CODE1   |02      | 5.03 |Description 2 |. . .
[ ] |100     |CODE2   |01      |12.45 |Description 4 |. . .
[/] |102     |CODE1   |01      |21.50 |Description 1 |. . .
[/] |102     |CODE2   |01      | 9.10 |Description 5 |. . .
[/] |102     |CODE3   |03      | 7.15 |Description 1 |. . . 
```

. . . （其中 Sel 列是一个复选框，并且 [/] 被选中）

然后在第 1 页上单击一个按钮（例如“取消记录”）后，我需要获取这些行，以显示到另一个页面，如下所示：

第 2 页，带有 GridView 2

```
KeyCol1 |KeyCol2 |KeyCol3 |Col4  |Other Colums  |Reason
100     |CODE1   |02      | 5.03 |. . .         |_______
102     |CODE1   |01      |21.50 |. . .         |_______
102     |CODE2   |01      | 9.10 |. . .         |_______
102     |CODE3   |03      | 7.15 |. . .         |_______ 
```

（其中原因列是一个文本框）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T08:34:43.740

您可以在单个查询中执行此操作，方法是为每个三个 id 添加一个 OR 子句（即，为您的 gridview 中的每个选定行）。例如：

从 Table1 中选择任何内容 WHERE (KeyCol1=val1-1 AND KeyCol2=val1-2 AND KeyCol3=val1-3) OR (KeyCol1=val2-1 AND KeyCol2=val2-2 AND KeyCol3=val2-3) OR .. etc

# c++ - 在 C++ 中使用 void 对象作为通用对象类型

> ID：11089171
> 
> 赞同：-1
> 
> 时间：2012-06-18T18:51:57.637
> 
> 标签：c++

我有一个 dll，它尊重我获得的接口。其中有许多方法依赖于我没有的头文件中定义的对象类型。例如

```
STDMETHOD(OnPrepareNextScan)(BOOL* isSurvey, long curExp, ExtractMethod* pEM,
            unsigned long scanTime, double* selectedMass, double* selectedIntensity) = 0; 
```

标头定义了 ExtrctMethod 类型但是，我不关心这个对象，我不会使用它，所以我想知道是否可以使用 void 指针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T18:55:28.417

只需使用前向声明来启用未定义的类型，并将 NULL 传递给函数。

```
class ExtractMethod;

OnPrepareNextScan(isSurvey, curExp, NULL, scanTime, selectedMass, selectedIntensity); 
```

# ajax - getJSON $.each 没有显示价值

> ID：11089175
> 
> 赞同：0
> 
> 时间：2012-06-18T18:52:04.953
> 
> 标签：ajax, json, getjson

我有以下 getJSON 调用返回信息的 MVC 控制器：

```
 $.getJSON('@Url.Action("List", "Spkr")',
              { id: spkrid},
            function (data) {

                     $.each(data.spk, function () {
                               alert(spk.ID);
                      });
     }); 
```

JSON 对象如下所示： {"spk":[{"ID":31,"Title":"SprkTitle","Status":"Onlne"}]}

.each 没有显示警报中的任何内容。不确定我是否配置错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T18:58:53.250

我看不到 spk 的定义/声明
$.each 方法可以将函数`function(index, value)`作为第二个参数，其中 index 是当前项目的索引， value 是它的值，即 data.spk[index == value
所以这应该有效

```
$.each(data.spk, function (index, spk) {
    alert(spk.ID);
}); 
```

# sql - “此行没有唯一标识符。” 尝试删除行时在 Postgres 中

> ID：11089181
> 
> 赞同：1
> 
> 时间：2012-06-18T18:52:24.653
> 
> 标签：sql, postgresql

我有一个带有以下方案的简单表格：

```
CREATE TABLE dateien(
    id int PRIMARY KEY UNIQUE DEFAULT NEXTVAL('dateien_id_seq'),
    name varchar(64),
    zeit timestamp DEFAULT now(),
    groesse float,
    dateityp_id int references dateitypen(id),
    benutzer_id int references benutzer(id)
); 
```

当尝试通过 phppgadmin 删除一行时，我总是收到以下消息： `No unique identifier for this row.`

同样通过纯sql删除语句后没有效果。你能告诉我问题是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T08:42:01.453

啊该死的...我发现了错误。我忘了提一个在这张桌子上也很活跃的触发器。触发器是：

```
CREATE TRIGGER update_quota BEFORE INSERT OR UPDATE OR DELETE
ON dateien
FOR EACH ROW
EXECUTE PROCEDURE f_update_quota(); 
```

但是在删除时我返回了一些错误。这就是为什么它不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T21:05:38.203

**我看不到引用的表是如何创建的。**

```
dateityp_id int references dateitypen(id),
benutzer_id int references benutzer(id) 
```

因此，我只能猜测......，作为一个例子。表产品、订单、日期。

如果在创建引用该产品的订单后删除该产品怎么办？SQL 也允许您指定它。直观地说，我们有几个选择：

*   不允许删除引用的产品。
*   也删除订单
*   还有什么？

当有人想要删除仍被订单引用的产品时（通过 dateien），我们不允许这样做。如果有人删除了一个订单，那么 dateien 也会被删除。

```
product_no integer REFERENCES products ON DELETE RESTRICT,
order_id integer REFERENCES orders ON DELETE CASCADE, 
```

限制和级联删除是两个最常见的选项。RESTRICT 也可以写成 NO ACTION，**如果你没有指定任何东西，它也是默认的**。对于删除主键时外键列应该发生的情况，还有另外两个选项：SET NULL 和 SET DEFAULT。请注意，这些并不能成为您遵守任何约束的借口。例如，如果一个操作指定了 SET DEFAULT 但默认值不满足外键，则删除主键将失败。

更多信息：[http ://www.postgresql.org/docs/7.4/static/ddl-constraints.html](http://www.postgresql.org/docs/7.4/static/ddl-constraints.html)

# expressionengine - 表达式引擎从 href 中删除服务器

> ID：11089184
> 
> 赞同：0
> 
> 时间：2012-06-18T18:52:40.943
> 
> 标签：expressionengine

我刚刚发现，如果我在包含我的家庭服务器的条目中创建一个 html 链接（例如[http://www.lcbcchurch.com/img/etc](http://www.lcbcchurch.com/img/etc)），它会删除我的服务器（例如 /img/等等）...有没有可以关闭这个“功能”的选项。我不希望它取消链接的服务器部分。我通过 json 请求在 iphone 应用程序中使用站点信息，它目前正在弄乱我的链接。想法？

# delphi - 将文件名加载到 TStrings

> ID：11089188
> 
> 赞同：-1
> 
> 时间：2012-06-18T18:52:59.773
> 
> 标签：delphi

您好，我正在尝试将文件夹中的文件名列表加载到 Stringlist 中。我只想添加以 .jpg 结尾的文件的名称。当我现在运行它时，会出现访问冲突错误。这是我得到的。

选择目录。

```
procedure TMainForm.Load1Click(Sender: TObject);
var
  DirName: string;
begin
    mylist.Free;
    myList := TList<TBitmap>.Create;
  DirName := 'c:\';
  if SelectDirectory(DirName,[sdAllowCreate, sdPerformCreate, sdPrompt],SELDIRHELP)
  then;
    LoadImages(DirName);
end; 
```

获取文件夹中的总文件数

```
function GetFilesCount(Dir : string; Mask : string) : integer;
var
  Path : string;
begin
  Result := 0;
  for Path in TDirectory.GetFiles(Dir, Mask) do
    inc(Result);
end; 
```

从文件夹中获取文件名

```
function TMainForm.GetFilenames(Path: string ):TStrings;
var
  Dest: TStrings;
  SR: TSearchRec;
begin
  Dest.create;
  if FindFirst(Path+'*.*', faAnyFile, SR) = 0 then
  repeat
    Dest.Add(SR.Name);
  until FindNext(SR) <> 0;
  FindClose(SR);
  Result := Dest;
  Dest.Free;
end; 
```

和负载图

```
 procedure TMainForm.LoadImages(const Dir: string);
    const
      FIRST_IMAGE = 0;
    var
      iFile : Integer;
      CurFileName: string;
      FoundFile : boolean;
      FileNameTemplate : string;
      FileNames : Tstrings;
    begin
       FileNames.Create;
       FileNameTemplate := IncludeTrailingPathDelimiter(Dir) + '*.jpg';          FileNames:=GetFileNames(FileNameTemplate);                                                 
      try
        ifile := 0;                                                                 
        repeat
          CurFileName := FileNames.Names[ifile];                                      
          showmessage(Curfilename);
 if FoundFile then
      begin
        end;
        Inc(iFile);
      end;
    until not FoundFile;
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T18:57:10.423

问题就在这里（实际上您有两个问题） - 实际上，您的代码中有两次相同的问题：

```
Dest.Create;  // In GetFileNames

FileNames.Create; // In LoadImages 
```

首先，`TStrings`是一个抽象类。您不能创建它的实例；它是其他更具体的类的基础，例如`TStringList`. 改为创建这些具体类之一。

其次，您必须创建`TStringList`并存储对它的引用。

```
FileNames := TStringList.Create; 
```

更好的方法是创建您的字符串列表并将其传递给函数或过程，因为您需要它返回时的结果。我将为您快速浏览其中一个：

```
function TMainForm.GetFilenames(const Path: string; const FileList: TStringList ): Boolean;
var
  SR: TSearchRec;
begin
  Assert(Assigned(FileList));      // Make sure it was created and passed in
  FileList.Clear;                  // Remove any previous names
  if FindFirst(Path+'*.*', faAnyFile, SR) = 0 then
  repeat
    FileList.Add(SR.Name);
  until FindNext(SR) <> 0;
  FindClose(SR);
  Result := FileList.Count > 0;  // Return true if we have found any files
end; 
```

像这样称呼它：

```
FileNames := TStringList.Create;
try
  if GetFileNames(PathToFolder, FileNames) then
  begin
    // Process files here
    for i := 0 to FileNames.Count - 1 do
    begin
      CurrFile := FileNames[i];
      // Use the file here from CurrFile
    end;

  end;
finally
  FileNames.Free;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T18:58:44.470

```
function GetAllFiles(AFolder: string; AMask: string; AStringList: TStringList): integer;
// Add all files matching AMask in AFolder to AStringList. Returns number of files
var
  iSearch: TSearchRec;
  iCount: integer;
  iFileAttrs: integer;
begin
  iCount := 0;
  iFileAttrs := $23 - faHidden;
  // Find all files
  if FindFirst(IncludeTrailingPathDelimiter(AFolder) + AMask, iFileAttrs, iSearch) = 0 then
  begin
    repeat
      // Add the files to the stringlist
      AStringList.Add(IncludeTrailingPathDelimiter(AFolder) + iSearch.name);
      inc(iCount);
    until FindNext(iSearch) <> 0;
  end;
  FindClose(iSearch);
  Result := iCount;
end; 
```

# sql - MS Access SQL -> 统计表1中的记录，执行表2中的If条件，但显示所有记录

> ID：11089189
> 
> 赞同：1
> 
> 时间：2012-06-18T18:53:00.620
> 
> 标签：sql, ms-access, join

我目前有一个生成 3 列的 SQL 语句：

```
 [Review Date] [Total Reviews] [Reviewed By]  

     10/24/2001         16            Jane
     10/24/2001         1             Bob
     10/24/2001         2             Chloe
     09/20/2001         17            Jane
     09/20/2001         34            Bob
     09/20/2001         86            Chloe
     02/04/2001         14            Jane
     02/04/2001         3             Bob
     02/04/2001         41            Chloe 
```

SQL 看起来像这样（为了得到上面的输出）：

```
SELECT 

[Review Results].[Review Date], 
count([Review Results].[Reviewed By]) as [Total Reviews], 
[Review Results].[Reviewed By]

FROM 
[Review Results]

GROUP BY  [Review Results].[Review Date], [Review Results].[Reviewed By]

ORDER BY [Review Results].[Review Date] 
```

我想做的是加入另一个名为 [Home_Days_table] 的表。该表如下所示：

```
[Reviewed By]     [WFH Date]

   Jane           10/12/2011
   Jane           07/11/2010
   Bob            04/09/2002
   Jane           01/01/2007 
```

我正在寻找上述查询以填充 [Home_Days_Table] 中的 [WFH 日期] 字段，用于在 [Results Review].[Review Date] 和 [Results Review].[Reviewed By] 之间匹配的每条记录与 [Home_Days_Table].[审阅者] 和 [Home_Days_Table].[WFH 日期]。我想显示上面原始 SQL 中的所有记录，并附加一个满足此条件的列。

## 有人可以帮忙吗？

除了上述内容之外，我还希望按照给定的方式执行查询，但要添加另一个日期字段。我使用的查询是：

```
SELECT 
   [Review Results].[Review Date], 
   count([Review Results].[Reviewed By]) as [Total Reviews], 
   [Review Results].[Reviewed By], 
   [Home_Days_table].[WFH Date]

FROM [Review Results]
LEFT JOIN [Home_Days_table]
ON  [Review Results].[Reviewed By]=[Home_Days_table].[Reviewed By] 
AND [Review Results].[Review Date]=[Home_Days_table].[WFH Date]

GROUP BY  
   [Review Results].[Review Date], 
   [Review Results].[Reviewed By],
   [Home_Days_table].[WFH Date]

ORDER BY [Review Results].[Review Date] 
```

上述查询回答了原始问题，但我想在 [WFH 日期] 顶部添加另一列，称为 [Summer Days]。这个想法与原始问题相同，但我正在寻找查询以填充 [Home_Days_Table] 中的 [WFH Date] 字段和 [Home_Days_Table] 中的 [Summer Days] 字段，用于匹配的每条记录在 [结果审核].[审核日期] 和 [结果审核].[审核人] 与 [Home_Days_Table].[审核人] 和 [Home_Days_Table].[WFH 日期] 和 [结果审核].[审核日期] & [Results Review].[Reviewed By] with the [Home_Days_Table].[Reviewed By] & [Home_Days_Table].[Summer Days]。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:08:52.703

就像是 .. ？

```
SELECT 
   [Review Results].[Review Date], 
   count([Review Results].[Reviewed By]) as [Total Reviews], 
   [Review Results].[Reviewed By], 
   [Home_Days_table].[WFH Date]

FROM [Review Results]
LEFT JOIN [Home_Days_table]
ON  [Review Results].[Reviewed By]=[Home_Days_table].[Reviewed By} 
AND [Review Results].[Review Date]=[Home_Days_table].[WFH Date]

GROUP BY  
   [Review Results].[Review Date], 
   [Review Results].[Reviewed By],
   [Home_Days_table].[WFH Date]

ORDER BY [Review Results].[Review Date] 
```

# java - 打印长除法和乘法的值时遇到问题

> ID：11089190
> 
> 赞同：3
> 
> 时间：2012-06-18T18:53:00.653
> 
> 标签：java, math, integer, long-integer

我很难弄清楚为什么像这样的简单除法总是返回 0。

```
System.out.println(4091365376L / 4091495462L * 100L); 
```

我用 Ls 为所有数字添加了后缀，因此它们被视为 Longs。我一直得零。

我正在尝试计算 4091365376L 与 4091495462L 的百分比。我的价值观是多头，但我只是在寻找一个简单的整数值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-18T18:55:56.390

您是整数舍入的受害者（实际上是截断）。试试这个：

```
System.out.println(4091365376L * 100L / 4091495462L); 
```

打印`99`。或`double`隐式转换为：

```
System.out.println(100.0 * 4091365376L / 4091495462L); 
```

给予`99.99682057572328`。您的问题是，在潜水它们时，结果`4091495462L`略大`4091365376L`，结果被截断为（如果您不相信，请`0`尝试）。`3 / 4`和`0`时代`100`是...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T18:56:57.350

```
4091365376L / 4091495462L * 100L
\_______________________/       |
      0.99... = 0               |
      \_________________________/
                    0 
```

你可以这样表达

```
100 * 4091365376L / 4091495462L 
```

那么它会变成

```
100 * 4091365376L / 4091495462L
\_______________/              |
  409136537600L                |
  \____________________________/
          99.99... = 99 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-18T18:57:32.397

顺序很重要，类型也很重要。long 除以 long 的输出是 long。您执行的除法结果是 0，并且 0 * 100 == 0。使用这样的东西会更好：

```
System.out.println((long) (4091365376.0 / 4091495462.0 * 100)); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-18T18:59:02.080

在整数数学中：

```
4091365376 / 4091495462 = 0
0 * 100 = 0 
```

你在期待

```
4091365376 / 4091495462 = 0.9999682057572327
0.9999682057572327 * 100 = 99.99682057572327 
```

但是你不能用整数（或长整数）来做到这一点。如果您想要一个双精度值，请使用双精度值。

# c# - C# 异步 Web 请求

> ID：11089192
> 
> 赞同：1
> 
> 时间：2012-06-18T18:53:08.170
> 
> 标签：c#, asynchronous, httpwebrequest, webrequest

我需要使用 C# 以编程方式调用如下所示的 url：

```
http://mysite.com/AdjustSound.php 
```

这个 php 文件需要`SoundLevel`我一个。所以，一个示例调用将是这样的：

```
http://mysite.com/AdjustSound.php?SoundLevel=30 
```

我有两个问题：

## 1：

```
WebRequest request = 
   WebRequest.Create("http://mysite.com/AdjustSound.php?SoundLevel=30");
// Which one?
// request.Method = "GET";
// request.Method = "POST"; 
```

**问题1：**我需要提出`GET`或`POST`请求吗？

## 2：

因为，我非常频繁地进行这个 http 调用（每秒 10-20 次）；我有一些速度问题。所以，我不希望我的程序等到这个 http 调用完成并检索结果。我希望它`Webrequest`异步运行。

另一个问题是我不需要看到这个 http 调用的结果。我只想调用服务器端。甚至，我不在乎这个调用是否成功完成......（如果失败，很可能我会在几毫秒后调整声音。所以，我不在乎。）我写了以下代码：

```
WebRequest request = 
     WebRequest.Create("http://mysite.com/AdjustSound.php?SoundLevel=30");
request.Method = "GET";
request.BeginGetResponse(null, null); 
```

**问题 2：**运行此代码似乎可以吗？可以打电话`request.BeginGetResponse(null, null);`吗？

# 编辑

看完评论；我修改了我的代码，如下所示：

```
WebClient webClient = new WebClient();
Uri temp = new Uri("http://mysite.com/AdjustSound.php?SoundLevel=30");
webClient.UploadStringAsync(temp, "GET", ""); 
```

现在好了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:56:47.090

> 问：我需要发出 GET 或 POST 请求吗？

A：这个例子实际上*是*一个“GET”请求。在这里，我会使用“GET”。如果您有表格，我会推荐“POST”

> 问：我非常频繁地进行此 http 调用（每秒 10-20 次）；我有一些速度问题。

如果您碰巧有幸使用 .Net 4.x，我强烈建议您查看他们的“异步 API”：

*   [http://msdn.microsoft.com/en-us/library/hh191443%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/hh191443%28v=vs.110%29.aspx)

*   [http://msdn.microsoft.com/en-us/library/hh300224%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/hh300224%28v=vs.110%29.aspx)

# sql - SQL Alter 表默认错误

> ID：11089194
> 
> 赞同：0
> 
> 时间：2012-06-18T18:53:14.257
> 
> 标签：sql, sql-server-2008, tsql, ddl

我正在尝试将现有表上的整数字段从可空修改为不可空，并为其添加默认值。

```
 ALTER TABLE dbo.current_status  
ALTER COLUMN next_sign_id INT NOT NULL 
```

此语句有效，但此语句无效：

```
 ALTER TABLE dbo.current_performance_status  
ALTER COLUMN next_sign_tp_id INT NOT NULL DEFAULT(0) 
```

这里有什么问题，我如何在一个声明中实现两者？我正在使用 sql 2008。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:02:52.877

您必须在三个语句中执行此操作（感谢@MartinSmith 的健全性检查，他建议`WITH VALUES`在这种情况下不正确，但仍然提醒我该表可能不是空的）：

```
ALTER TABLE dbo.current_performance_status 
  ADD CONSTRAINT df DEFAULT (0) FOR next_sign_id;

UPDATE dbo.current_performance_status 
 SET next_sign_id = 0
 WHERE next_sign_id IS NULL

ALTER TABLE dbo.current_performance_status
  ALTER COLUMN next_sign_id INT NOT NULL; 
```

# drupal - 在 Drupal Ubercart 中将项目添加到购物车后的钩子是什么

> ID：11089198
> 
> 赞同：0
> 
> 时间：2012-06-18T18:53:30.120
> 
> 标签：drupal, ubercart

我一直在尝试获得一个在将项目添加到购物车后立即执行的钩子。我知道有一个名为 hook_uc_add_to_cart 的钩子在将项目添加到购物车时运行。但是我想显示一个表单并在项目添加到购物车后对表单进行处理。问题是当我尝试在钩子中使用 drupal_goto 进行表单处理时，它不会根据钩子要求返回任何内容。因此，在处理完我的表单后，该项目不会添加到购物车中。因此，我正在寻找一个在项目成功添加到购物车后运行的钩子。任何帮助或指向它的指针。非常感谢史密斯

# asp.net - 使用 jquery ui 模态对话框提交表单

> ID：11089200
> 
> 赞同：3
> 
> 时间：2012-06-18T18:53:39.117
> 
> 标签：asp.net, jquery-ui

提交表单时，我在使用 JQuery UI 模态对话框时遇到了困难。目的是您点击提交按钮，弹出模式，并根据您从模式中的选择提交或不提交表单。而是弹出模式并自动提交

前端：

```
<div id="dialog" title="Basic dialog">
    <p>Please double check to be sure all data is entered correctly.</p>
</div>
<div class="buttons">
    <asp:Button ID="btnSave" Text="Save for later" runat="server" OnClick="btnSubmit_Click"
        ValidationGroup="GroupSave" />
    <asp:Button ID="btnSubmit" Text="Submit" runat="server" OnClientClick="return checkSubmit()" OnClick="btnSubmit_Click" />
</div> 
```

我为 jquery/js 所做的尝试

一种。）

```
function checkSubmit() {
$("#dialog").dialog({ modal: true,
    buttons: { "Submit": function () { $(this).dialog("close"); return true; },
        "Go Back": function () { $(this).dialog("close"); return false; }
    }
});
} 
```

乙）

```
$(document).ready(function () {
$("#dialog").dialog({ autoOpen: false,
    modal: true,
    buttons: { "Submit": function () { $(this).dialog("close"); return true; },
        "Go Back": function () { $(this).dialog("close"); return false; } 
    }
});
});

function checkSubmit() {
 $("#dialog").dialog("open");
} 
```

我了解 B （特别是`checkSubmit`）如何失败，它所做的只是打开对话框，但考虑到我有按钮返回值，AI 认为它会起作用，但这本质上也*只是*打开对话框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:08:38.680

使用标有“提交”的按钮打开对话框：

```
<div id="dialog" title="Basic dialog">
    <p>Please double check to be sure all data is entered correctly.</p>
</div>
<div class="buttons">
    <asp:Button ID="btnSave" Text="Save for later" runat="server" OnClick="btnSubmit_Click" ValidationGroup="GroupSave" />
    <input type="button" id="preSubmit" value="Submit" />
    <asp:Button ID="btnSubmit" class="ui-helper-hidden" Text="Submit" runat="server" OnClick="btnSubmit_Click" />
</div> 
```

使用`Submit`对话框中的按钮为您的`<asp:Button>`.

```
function submitForm() {
    $('input#<%=btnSubmit.ClientID %>').click();
}
function checkSubmit() {
    $("#dialog").dialog({
        "modal": true,
        "buttons": {
            "Submit": function() {
                submitForm();
            },
            "Go Back": function() {
                $(this).dialog("close");
            }
        }
    });
}
$(document).ready(function() {
    $('button#preSubmit').click(function(e) {
        checkSubmit();
        e.preventDefault();
        return false;
    });
    $('button#saveForLater').click(function(e) {
        $("#dialog").dialog('close');
        e.preventDefault();
        return false;
    });
});​ 
```

# java - Swing GUI 中未出现按钮

> ID：11089210
> 
> 赞同：2
> 
> 时间：2012-06-18T18:54:22.743
> 
> 标签：java, swing, user-interface

对于我在 Java 课程中的第二个编程作业，我们必须创建一个 Pizza Shop 菜单 GUI。除了您应该单击以计算总成本的按钮（“流程选择”）之外，所有内容都出现在我的 GUI 上（包括选项、框、单选按钮等）。以下是我的代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class PizzaShop extends JFrame {

    private Topping t;
    private PizzaSize ps;
    private PizzaType pt;
    private JPanel buttonPanel;
    private JButton ProcessSelection;

    public PizzaShop() {
        super("Welcome To Home Pizza Shop");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout());
        t = new Topping();
        ps = new PizzaSize();
        pt = new PizzaType();
        createPanel();
        add(t, BorderLayout.NORTH);
        add(ps, BorderLayout.WEST);
        add(pt, BorderLayout.CENTER);
        setVisible(true);
    }

    private void createPanel() {
        buttonPanel = new JPanel();
        ProcessSelection = new JButton("Process Selection");
        ProcessSelection.addActionListener(new calButton());
        buttonPanel.add(ProcessSelection);
    }

    private class calButton implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            double subtotal;
            subtotal = t.getTopping() + ps.getPizzaSize();
            JOptionPane.showMessageDialog(null, "Your Order \n" + "Pizza Type" + pt.getPizzaType() + "\n" + "Amount Due" + subtotal);
        }
    }

    private class ExitButtonListener implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            System.exit(0);
        }
    }
} 
```

我忘了在某处添加一些代码吗？我很困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T18:55:27.843

您没有添加`buttonPanel`到主视图

**更新**：你应该这样做：

```
private void createPanel() {
    buttonPanel = new JPanel();
    ProcessSelection = new JButton("Process Selection");
    ProcessSelection.addActionListener(new calButton());
    buttonPanel.add(ProcessSelection);
    add(buttonPanel, BorderLayout.SOUTH);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T18:57:46.577

您需要将按钮面板添加到框架中：

```
add(buttonPanel, BorderLayout.SOUTH); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T21:41:35.727

将您的 createPanel() 更改为：

```
private JPanel createPanel() {
    buttonPanel = new JPanel();
    ProcessSelection = new JButton("Process Selection");
    ProcessSelection.addActionListener(new calButton());
    buttonPanel.add(ProcessSelection);
    return buttonPanel;
 } 
```

并将以下代码添加到您的 PizzaShop() 方法中：

```
add(createPanel(), BorderLayout.SOUTH); 
```

或者你可以按照 Adel Boutros 所说的去做。

# javascript - 如何访问“onfocus”函数中的发送文本框？

> ID：11089216
> 
> 赞同：0
> 
> 时间：2012-06-18T18:54:40.693
> 
> 标签：javascript, jquery

给定以下 HTML 和函数：

```
<input type="text" onfocus="TextBoxFocus()" id="txtName" /> 
```

.

```
function TextBoxFocus()
{

} 
```

是否可以从函数内部获取调用文本框的 id？

谢谢凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:56:34.437

`this`只需作为处理程序的参数传递：

```
onfocus="TextBoxFocus(this)"

function TextBoxFocus(textbox)
{

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T18:57:13.583

传递这个 obj。见下文，

```
//<!--                   Passing this obj---v                 -->
<input type="text" onfocus="TextBoxFocus(this)" id="txtName" /> 
```

在脚本中，

```
function TextBoxFocus(obj)
{
    alert(obj.id);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T19:01:32.643

改变一点你的html

```
<input type="text" onfocus="TextBoxFocus(this)" id="txtName" /> 
```

给你：

```
function TextBoxFocus(self) {
    var id = self.id
}​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:01:56.023

我做了一个[**JSFiddle**](http://jsfiddle.net/WgNDW/5/)，这似乎有效：

`<input type="text" onFocus="onFocus(this)" />`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T19:04:23.773

假设您想将它用于许多文本框，所以我提供了一个`class`选择器

```
<input type="text"  id="txtName1" class="someTextBox"/>
<input type="text"  id="txtName2" class="someTextBox"/> 
```

脚本

```
$(function(){

  $(".someTextBox").focus(function(){
     var txtID=$(this).attr("id");
     alert(txtID);
  });

}); 
```

Jsfiddle 示例：http: [//jsfiddle.net/MLH4p/](http://jsfiddle.net/MLH4p/)

# selenium - 在 Selenium 中，waitForPageToLoad 命令是否有目标值？

> ID：11089217
> 
> 赞同：0
> 
> 时间：2012-06-18T18:54:42.507
> 
> 标签：selenium

也许我对何时使用该`waitForPageToLoad`命令有点困惑，但我会在 Target 框中输入什么？到目前为止，我有：

命令：waitForPageToLoad

目标：

价值：7000

多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:03:03.777

假设您使用的是 Selenium IDE for Firefox，那么您所拥有的就足够了。[文档](http://release.seleniumhq.org/selenium-remote-control/0.9.2/doc/dotnet/Selenium.ISelenium.WaitForPageToLoad.html)仅在等待导航到页面加载时指定超时。

# php - 表达式引擎安装差异

> ID：11089221
> 
> 赞同：0
> 
> 时间：2012-06-18T18:54:58.150
> 
> 标签：php, configuration-files, expressionengine

不确定这是否是问这个问题的正确地方，但我有一个站点，其中包含表达式引擎的暂存和 beta 安装。相同的版本相同的文件一切似乎都是相同的。除了 url 不同之外，配置文件是相同的，但是对于许多扩展/模块，这两个站点的行为不同。一个问题是，在登台站点上，以前的开发人员有一个嵌入另一个模板的模板，并在循环中使用它来执行另一个查询，如下所示：

```
 {!-- template uri /example/uri --}

        start loop

        {embed="template/.thistemplate" id="{id}"}

        end loop

   {!--end template--} 
```

这在 staging 上运行得非常好，但在 beta 安装时却没有，它实际上只嵌入了循环中每个项目通过的最后一个 id，这导致整个循环的结果相同。

为了使这个特定问题正常工作，我重写了代码，使其没有嵌入任何内容，但我遇到了许多其他类似的问题，因为它们适用于暂存而不是 beta，我想知道是否有人知道任何设置可能会彻底改变网站行为的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:52:57.350

在 EE 开发的四年中，我从未见过这样的问题。我唯一的猜测是您的 beta 环境可能不使用受支持的 PHP 版本，或者可能配置的模块解析 EE 的 PHP 代码的方式与您的登台服务器不同。如果您还没有这样做，请检查 beta 服务器的设置以确保它符合[EE 的要求](http://expressionengine.com/user_guide/installation/requirements.html)。如果没有进一步的信息，很难给你任何其他的指示。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T21:34:27.483

在我看来，这两个站点并不真正同步。

第二个站点是如何从第一个站点中分离出来的？

数据库和文件系统是否同时克隆？

我会考虑制作一个新的登台快照并将其用作您的测试站点。

# c# - WPF 搜索按钮功能

> ID：11089224
> 
> 赞同：0
> 
> 时间：2012-06-18T18:55:01.307
> 
> 标签：c#, wpf, windows-phone-7, search

> **可能重复：**
> [Windows Phone 7 搜索按钮](https://stackoverflow.com/questions/2796304/windows-phone-7-search-button)

我认为所有 Windows Phone 手机都有一个搜索按钮（无论是否物理）。

实际上，它们有三个按钮：`Back button`、`Windows Logo button`、`Search button`。

可以修改此按钮的功能（作为后退按钮）。类似的东西`OnSearchKeyPress`（作为事件处理程序）。

这是可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:07:13.353

这是不可能的，因为这可能会严重改变手机的行为。您可以使用一个搜索任务，[有关详细信息，请参阅此 MSDN 文章。](http://msdn.microsoft.com/en-us/library/hh202889%28v=VS.92%29.aspx#sectionToggle3)

# php - 使用 PHP 处理站点范围的 URL 重写

> ID：11089225
> 
> 赞同：1
> 
> 时间：2012-06-18T18:55:01.893
> 
> 标签：php, mod-rewrite, redirect, canonical-link

我正在研究使用 PHP（而不是）`mod_rewrite`来处理 URL 规范化的可行性。我希望能够将大量不同的 URL 映射到给定的物理 PHP 页面，并以更集中和可维护的方式处理 301 和 404。这将包括常见的拼写错误、别名、搜索引擎友好的 URL 参数等。这些需求似乎远远超出了 的能力`mod_rewrite`，所以我正在寻找其他选择。

我想我会创建一个`canonical.php`脚本，我将每个页面映射到 .htaccess 中的以下内容（[借自这篇文章](http://www.dynamicdrive.com/forums/showthread.php?t=51923)）：

```
RewriteEngine On
RewriteBase /
RewriteRule ^(.*)$ canonical.php/$1?%{QUERY_STRING} [L] 
```

然后`canonical.php`会做任何必要的 URL 解析 / 数据库查找 / 重定向 / 等，然后简单地包含`/the/appropriate/file.php`给定的请求。

这是一个合理的做法吗？这样的功能实际上是否可以`mod_rewrite`直接使用？（除了数据库查找等）这会明显慢于`mod_rewrite`？有没有比 PHP 包装器更强大的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:00:35.390

您在谈论路由，很多框架都这样做。看看这个答案：[https ://stackoverflow.com/questions/115629/simplest-php-routing-framework](https://stackoverflow.com/questions/115629/simplest-php-routing-framework)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:00:44.670

我建议和使用的是一个 php 文件，每次遇到 404 时都会调用它并存储遇到的 url。然后每周一次我去管理控制台，我将拼写错误的旧网址，搜索引擎的历史网址映射到当前现有的网址，然后我点击解析按钮，它会为我喷出一个新的更新的 .htaccess 文件。

这样可以减轻数据库的负载、加载时间、编译时间和重定向时间。

只是我的2美分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T19:31:09.553

没有机会对此进行测试，但[这个答案](https://stackoverflow.com/a/13612810/113632)向我指出了 Apache 的[`FallbackResource`](http://httpd.apache.org/docs/trunk/mod/mod_dir.html#fallbackresource)指令，这听起来很有希望。

# java - 寻找包的 Java 2 SDK 和 Java 工具

> ID：11089231
> 
> 赞同：0
> 
> 时间：2012-06-18T18:55:13.943
> 
> 标签：java, eclipse, classpath, package

假设我有一个属于 org.cadenhead.library 包的类 TreansferBook

我读到 Java 2 SDK 和 Java 工具在以下位置寻找包：

1 输入 java 命令的 org\cadenhead\library 子文件夹

第一个问题是，在 Eclipse 中，修改 java 命令输入位置的选项在哪里？

我什至不知道您将如何在命令行上执行此操作；会不会像

C:> 光盘

目录会是工作区和项目目录吗？并且是在这个目录旁边的包

C:\\ java org\cadenhead\library

2 ClassPath 设置中任何文件夹的 org\cadenhead\library 子文件夹

我知道类路径告诉 jvm 类和包的位置。同样，正如我上面所问的，这是工作区/项目/的子文件夹吗？

3 类路径中 java 归档文件 (JAR) 的 org\cadenhead\library 子文件夹

最后，这是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:16:01.067

使用 Eclipse 之类的 IDE 时，您无需设置任何内容。IDE 已经知道您的代码在哪里，并且可以适当地设置类路径。这不是您需要担心的事情，它是使用 IDE 的好处之一。

从哪里运行 java 并不重要。重要的是 java 命令的类路径设置为包含类文件的根目录（在您的情况下为 /org 的父目录）以及您可能拥有的任何依赖 jar 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:18:06.683

关于类加载和 Eclipse 的一些事情：

1.  JVM（和编译器）在每个目录和 CLASSPATH 中列出的每个 JAR 文件中查找类。例如，如果您有一个类路径，如：CLASSPATH=c:\workspace\myproject;some_library.jar，那么 VM 将在

    1.  c:\workspace\myproject\org\cadenhead\library
    2.  在 JAR 文件中包含的目录 org\cadenhead\library 中。
2.  在 Eclipse 中，类路径上的默认目录是工作空间内的“bin”目录，以及所有链接的项目和 JAR 文件。

3.  调用“java”命令的位置是项目目录本身。

# android - UDP 数据包（通过 WiFi Direct）永远不会到达

> ID：11089232
> 
> 赞同：3
> 
> 时间：2012-06-18T18:55:21.853
> 
> 标签：android, udp, wifi-direct

那些阅读过我之前的问题的人可能已经知道这一点：我目前正试图掌握整个 WiFi Direct 的内容。到目前为止，我所做的是创建连接。我正在尝试做的是通过 UDP 向 groupOwner 发送一个数据包（当然它的 IP 是已知的） - 但它似乎每次都迷路了..

这是我的一些代码，我有一个用于接收文件的服务和一个用于在后台提交它们的意图服务：

**FileReceiverService.java**

```
 @Override
    public void run() {
        Log.d(TAG, "Thread starting...");
        try {
            app.log("Opening UDP socket to receive files.");
            DatagramSocket socket = new DatagramSocket(PORT);
            app.log("Socket open!");
            socket.setSoTimeout(5000);
            app.log("Waiting for packet..");
            while (isRunning && !isInterrupted()) {
                DatagramPacket packet = new DatagramPacket(
                        new byte[WiFiPacket.PACKET_SIZE],
                        WiFiPacket.PACKET_SIZE);
                try {
                    socket.receive(packet);
                    app.log("Received " + packet.getLength()
                            + " bytes, trying to parse!");
                    parsePacket(packet);
                } catch (SocketTimeoutException e) {
                } catch (Exception e) {
                    app.log("Something went wrong: " + e.getMessage());
                    e.printStackTrace();
                }
            }
            socket.close();
            app.log("Closing UDP socket");
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

常量 WiFiPacket.PACKET_SIZE 设置为 1024*32（32 KB，因为我收到了更高值的“ERRBLABLA MSG too long”错误）。

**文件传输服务.java**

```
@Override
protected void onHandleIntent(Intent intent) {
    App app = (App) getApplication();

    Context context = getApplicationContext();
    boolean rightIntent = false;
    WiFiFile file = null;

    if (intent.getAction().equals(ACTION_SEND_TEXT)) {
        rightIntent = true;
        file = WiFiFile.fromText(intent.getExtras().getString(EXTRAS_TEXT));
    } else if (intent.getAction().equals(ACTION_SEND_FILE)) {
        rightIntent = true;
        file = WiFiFile.fromFile(intent.getExtras().getString(
                EXTRAS_FILE_PATH));
    }
    if (rightIntent && file != null) {

        app.getOnWiFiTransmissionChangedListener().onNewOutgoingTransfer(
                file);
        String text = intent.getExtras().getString(EXTRAS_TEXT);
        String host = intent.getExtras().getString(
                EXTRAS_GROUP_OWNER_ADDRESS);
        DatagramSocket socket = null;
        int port = intent.getExtras().getInt(EXTRAS_GROUP_OWNER_PORT);
        Log.d(TAG, "Sending packets to " + host + ":" + port);
        try {
            socket = new DatagramSocket();
            int bytesSent = 0;
            for (WiFiPacket p : file) {
                Log.d(TAG, "Preparing another packet..");
                byte[] payload = p.getBytes();
                DatagramPacket packet = new DatagramPacket(payload,
                        payload.length, InetAddress.getByName(host), port);
                Log.d(TAG, "Sending packet..");
                socket.send(packet);
                bytesSent += payload.length;
                Log.d(TAG, "Packet send! Contained " + payload.length
                        + " bytes! All over we've sent about " + bytesSent
                        + " bytes!");
                List<WiFiFile> list = new ArrayList<WiFiFile>();
                list.add(file);
                app.getOnWiFiTransmissionChangedListener()
                        .onTransferProgressChanged(list);
            }

            app.getOnWiFiTransmissionChangedListener()
                    .onFileTransferSuccessful(file);

            Log.d(TAG, "Client: Data written");
        } catch (IOException e) {
            e.printStackTrace();
            Log.e(TAG, e.getMessage());
        } finally {
            if (socket != null) {
                if (socket.isConnected()) {
                    socket.close();
                }
            }
        }

    }
} 
```

代码可能不是最好的，但就目前而言，我唯一关心的是接收该死的数据包。:)

供您参考：我将 WiFiFile 类的实例拆分为不超过 PACKET_SIZE 限制的 WiFiPackets，因此包含一些关于文件偏移量、总长度、发件人（用户名/inetaddress）等的自己的标头信息那。我的日志告诉我发送了大约 25 KB，socket.send 没有抛出任何错误，而是调用了我的侦听器（也是告诉我传输完成的那个）。据我所知，UDP 数据包很容易在途中被丢弃，但我已经尝试了大约 10 次，我认为每次丢失 25KB 数据包的可能性非常小。

你看到我遗漏了什么吗？几个小时以来，我一直盯着我的代码，试图弄清楚，在其中放入越来越多的调试/日志语句，但没有任何进展。

谢谢！

PS：

IP 地址和端口正确。

PS2：

**AndroidManifest.xml**

```
<uses-feature
    android:name="android.hardware.wifi.direct"
    android:required="true" />

<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE" />
<uses-permission android:name="android.permission.CHANGE_COMPONENT_ENABLED_STATE" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T15:42:00.303

好的，我解决了这个问题。我在收到成功创建组的回调后直接发送消息，认为组真的会“准备好”......通过每隔约 200-500 毫秒在 TimerTask 中发送一条初始消息来解决这个问题，收到后取消任务确认。希望这对你们中的一些人有所帮助，面临同样的问题。:)

# c++ - 删除链表的最后一个节点后没有释放内存

> ID：11089233
> 
> 赞同：0
> 
> 时间：2012-06-18T18:55:24.170
> 
> 标签：c++, pointers, data-structures, linked-list, delete-operator

我编写了以下代码。在开头插入、删除、在开头和结尾插入都可以正常工作。粗体标记的内存没有被释放。应该**`cout<<temp`**报错吗？请评论此代码的正确性。

```
void del(node** head)
{
    node* temp = (*head)->next;
    node* prev = *head;
    while(temp ->next!= NULL)
    {
        prev = temp;
        temp = temp -> next;
    }
    cout<<endl<<temp;
    cout<<endl<<prev;

    //delete prev ->next;
    prev -> next = 0;

    delete temp;
    cout<<endl<<"temp after free"<<temp;
    cout<<endl<<prev;
}
void main()
{
    node* head = NULL;  
int x = 5;
head = insert(head,x);
insert(head,6);
insert(head,7);
insert(head,8);
print(head);
del(&head);
print(head);
getch();    } 
```

输出：

```
Empty List
|5| at 00673BF0
-------------------
|6| at 00673C30
-------------------
|7| at 00673FB8
-------------------
|8| at 00673FF8
-------------------

00673FF8
00673FB8
temp after free00673FF8
00673FB8

|5| at 00673BF0
-------------------
|6| at 00673C30
-------------------
|7| at 00673FB8
------------------- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T18:59:45.343

`delete`不将指针的值设置为 NULL，但指向的内存不再有效（不包含 live `node`）

这意味着`cout << temp`将打印它仍然拥有的指针的值（并且是 之前的节点地址`delete`），但是取消引用`temp`（例如`*temp`or `temp->next`）是未定义的行为

*注意*：在任何地方都没有`del`修改 指向的指针`head`，因此您要么不需要双重间接（`node**`），要么应该将新的头分配给`*head`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:54:07.847

正如 Attila 已经指出的那样，在删除指针后取消引用指针是未定义的行为。为了防止意外这样做，最好`NULL`在`delete`. 取消引用 NULL 指针会立即导致错误，指出正确的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-24T06:55:20.073

在代码中，最好先释放临时节点。然后将 prev->next 赋值为 NULL。这样就很容易理解临时节点不可用，这就是使 prev->next NULL 的方式。

# c# - 需要使用 DllImport 导入的非托管 dll 版本

> ID：11089236
> 
> 赞同：2
> 
> 时间：2012-06-18T18:55:30.990
> 
> 标签：c#, dllimport

我正在开发一个将非托管 dll 导入 C# 的应用程序。它有一个包装类来加载方法，以便可以调用它。这些方法在 dll 的程序中运行良好。我想添加保存正在使用的 dll 的版本。我发现我需要使用 FileVersionInfo.GetVersionInfo("my.dll") 多亏了[C# 获取 unmanaged dll 的版本](https://stackoverflow.com/questions/2459786/c-sharp-getting-version-of-unmanaged-dll)。但是，当运行此函数时，它会出现异常说它找不到“my.dll”。dll 位于 c: 根目录下的文件夹中。该文件夹位于 PATH 中，根据[http://msdn.microsoft.com/en-us/library/ms682586(VS.85).aspx#search_order_for_desktop_applications](http://msdn.microsoft.com/en-us/library/ms682586(VS.85).aspx#search_order_for_desktop_applications)应该可以找到它。

知道 my.dll 文件已加载并正常工作，为什么我不能在同一个包装类中调用 GetVersionInfo() 并找到 my.dll 以便我可以获得相同文件的版本号？感谢您的帮助，因为我一直在寻找几天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:01:19.273

从 MSDN，GetVersionInfo 的参数是：

> **要为其检索版本信息的文件的完全限定路径和名称**。

所以很清楚。您需要传递完整路径，因为这个函数似乎依赖它。否则它很可能会在当前目录中查找文件（所以你的应用程序的目录）。

附带说明一下，将本机 DLL 保存在 C:\ 中是不好的做法。您应该将其存储在应用程序的文件夹中。然后此功能将起作用，您的应用程序将更加独立。没有文件散布在磁盘周围。当然，除非您有充分的理由将其存储在 C 驱动器的根目录中，否则这是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:36:09.180

它需要完整路径，它不会搜索 DLL。这太冒险了，Windows 的 DLL 搜索规则很复杂并且需要配置。如果您需要在调用任何函数*之前*执行此操作，那么最好的方法是调用 SearchPath()。如果将第一个参数设置为 null，则它使用与 LoadLibrary 相同的算法。

如果您需要在调用函数*后*执行此操作，那么最好的方法是使用加载的 DLL。迭代 Process.GetCurrentProcess().Modules 以检索 ProcessModule.FileName。

# sql - SQL Query 根据列值显示名称

> ID：11089238
> 
> 赞同：2
> 
> 时间：2012-06-18T18:55:42.640
> 
> 标签：sql

对于名为 ORDER_STATUS 的列，我有三种不同的状态

*   110（已发布）
*   120（包装）
*   130（已发货）。

现在根据查询返回的数值，我想显示实际名称。我怎样才能做到这一点？我正在尝试在`SELECT`.

```
SELECT 
  OLI.do_dtl_status ORDER_STATUS
FROM 
  appwms.order_line_item OLI
WHERE 
  ORD.tc_order_id = '1002424748' 
```

这里 OLI.do_dtl_status ORDER_STATUS 是我想要根据其值替换为名称的列。请注意，这是为了排除故障。所以我不是在寻找性能等，而是在查询中添加一些简单的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T18:58:58.770

理想情况下，您会将名称存储在单独的表中并使用 JOIN。

> 请注意，这是为了排除故障，所以我不是在寻找性能等，而是在查询中添加一些简单的东西。

对于一次性情况，您可以将它们硬编码到查询中：

```
SELECT CASE OLI.do_dtl_status
          WHEN 110 THEN 'Released'
          WHEN 120 THEN 'Packed'
          WHEN 130 THEN 'Shipped'
       END AS ORDER_STATUS
FROM appwms.order_line_item OLI
WHERE ORD.tc_order_id='1002424748' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:00:13.843

典型的方法是有一个单独的表，其中包含 orderstatus（值、名称）和该表的可能外键。这样，您可以加入 orderstatus 表以获取状态名称，外键确保您仅在主表中输入有效的 orderstatus。

# javascript - Mediawiki：侧边栏标题链接？

> ID：11089245
> 
> 赞同：1
> 
> 时间：2012-06-18T18:56:02.587
> 
> 标签：javascript, hyperlink, mediawiki

我正在尝试通过将侧边栏标题设为链接来编辑 mediawiki 页面的侧边栏。

根据我的发现，侧边栏唯一`[[mediawiki:sidebar]]`可以解释的是星号。

我试图做这样的事情：

```
* [[google.com | Help]]
** mainpage| Help
** Subheading1|Sub1
** Subheading2|Sub2
** Subheading3|Sub3
** Subheading4|Sub4 
```

当我预览此代码示例时，它会正确显示。但是当它实现时，它会在侧边栏中显示括号和 url。

我假设我将不得不对“common.js”做一些事情，所以它对所有页面都这样做，因为我们没有使用皮肤。

**注意** 我没有访问服务器文件的权限，因为我是新来的。他们想让我看看是否可以编辑 [[mediawiki:common.js]] 中的 common.js 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:05:50.613

如果要链接到 google.com，则必须使用`http://google.com|Help`. 界面消息没有像通常的`MediaWiki:Sidebar`页面那样解析，导致预览混乱。

有关更多信息，请阅读出色[的 MediaWiki 手册：侧边栏](http://www.mediawiki.org/wiki/Manual%3aInterface/Sidebar)，尤其是“高级定制”部分。尝试寻找非 JS 的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-03T16:56:51.540

您可以从 mediawiki 界面本身获取可点击的链接，您可以从搜索中编辑 Mediawiki:Sidebar，如下所示：

```
[[Mediawiki:Sidebar]]
* navigation
** mainpage|mainpage-description
** recentchanges-url|recentchanges
** randompage-url|randompage
** helppage|help
** https://www.google.co.in/|Google
** https://www.reddit.com/|Reddit
** https://www.google.co.in/|hi
** https://www.reddit.com/|hi1
* SEARCH
* TOOLBOX 
* LANGUAGES 
```

[![在此处输入图像描述](../Images/a539c583f06afd3c82e8e75b7ae53d83.png)](https://i.stack.imgur.com/dcMsH.gif)

# c - gdb 不接受用户输入

> ID：11089251
> 
> 赞同：5
> 
> 时间：2012-06-18T18:56:43.910
> 
> 标签：c, linux, assembly, gdb

我目前正在关注[这个](http://www.securitytube.net/video/210)关于如何使用[这个 C 程序](http://code.securitytube.net/SimpleDemo.c)使用程序集和 gdb 的视频，但我遇到了一个问题。这是我编译和运行 gdb 的方法：

```
chiggins@host:~/assem$ gcc -ggdb -o SimpleDemo SimpleDemo.c
chiggins@host:~/assem$ gdb ./SimpleDemo
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.launchpad.net/gdb-linaro/>...
Reading symbols from /home/chiggins/assem/SimpleDemo...done.
(gdb) list
4       int add(int x, int y)
5       {
6               int z =10;
7
8               z = x + y;
9               return z;
10      }
11
12      main(int argc, char **argv)
13      {
(gdb)
14              int a = atoi(argv[1]);
15              int b = atoi(argv[2]);
16              int c;
17              char buffer[100];
18
19              gets(buffer);
20              puts(buffer);
21
22              c = add(a,b);
23
(gdb)
24              printf("Sum of %d+%d = %d\n",a, b, c);
25
26              exit(0);
27
28      }
(gdb) run 10 20
Starting program: /home/chiggins/assem/SimpleDemo 10 20
demo 
```

现在，我在最后输入了“演示”，这就是程序应该接受用户输入的地方。但是当我在输入回车后按回车时，什么也没有发生。我不能ctrl+c退出程序，什么也做不了。我最终不得不从另一个会话中终止该进程，这样我才能重新获得控制权。任何想法为什么 gdb 会这样做，或者我可能做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T06:37:40.267

我不确定为什么这对你不起作用；它在这里按预期工作......

不过，我发现在单独的终端中运行执行交互式 I/O 的程序更容易，也许它会对您有所帮助。

在一个终端中，

```
$ gdbserver --multi localhost:4242
监听 4242 端口

```

在另一个中，

```
$ gdb ./SimpleDemo 
(gdb)目标扩展远程 localhost:4242
使用 localhost:4242 进行远程调试
(gdb)运行 10 20

```

回到终端运行`gdbserver`，

```
从主机 127.0.0.1 远程调试
处理 ./SimpleDemo 创建；pid= *PID*
演示
演示
10+20 之和 = 30

孩子以状态 0 退出

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:02:15.953

您是否尝试在程序期间进行用户输入？如果你只是想在开始时设置命令行参数，你可以说 set args ... 在这里你可以像在程序过程中一样给出参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T20:55:17.770

你试过这个吗？

```
gdb --args ./SimpleDemo 10 20 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-12T09:46:26.620

使用`Ctrl`+`Enter`代替`Enter`键。

# refinerycms - RefineryCMS，在前端上传图片

> ID：11089255
> 
> 赞同：1
> 
> 时间：2012-06-18T18:57:05.763
> 
> 标签：refinerycms

很抱歉这个非常愚蠢的问题，但经过几天的搜索，我仍然没有答案，我真的很喜欢它。

我有refinerycms 扩展。像这样：

```
$ rails generate refinery:engine shop name:string logo:image 
```

我希望它可以从我的应用程序的后端和前端进行控制。后端没有问题。（感谢refinerycms 团队。）当表单仅包含“名称”时，前端没有问题。（或任何其他没有图像类型的属性）。

图像类型属性​​有问题。

我不希望前端用户拥有与后端用户相同的图像编辑表单。我希望表格是这样的：

```
<div class='field'> 
  <%= f.label :logo , "Logo"%>
  <%= f.file_field :logo %>  
</div> 
```

我希望前端用户加载的图像使用 Refinery::Image 保存。

我敢打赌，问题仅在于我的前端控制器为商店创建操作，但我不知道应该如何覆盖它。

非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T18:15:21.340

在控制器中，您必须将“logo”参数作为`Refinery::Image`实例传递给模型。为此，您创建一个实例`Refinery::Image`并将其合并到模型中。

例子：

```
logo = Refinery::Image.create(image: params[:shop][:logo])

@shop = Refinery::Shops::Shop.create(params[:shop].merge({logo: logo})) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T11:13:01.210

我在 FE 和我的普通控制器（***不是管理员***）中有带有 file_field (:logo) 的 FE 表单，我有这种方法来处理来自请求的参数：

```
def model_params
    permitted = params.require(:model).permit!
    permitted[:logo] = Refinery::Image.create(image: permitted[:logo])
    return permitted
 end 
```

允许参数并创建图像表单文件。

然后在我的创建方法中：

```
def create
    if (@new_beer = ::Refinery::Models::Model.create(model_params))
      #do some stuff when it succeeds to create it
      redirect_to SOMEWHERE
    else
      redirect_to SOMEWHERE, notice: "Something went wrong!"
    end
  end 
```

希望它可以帮助！:)

# c# - ShutdownBlockReasonCreate - 创建在注销/关闭期间显示的多个原因

> ID：11089259
> 
> 赞同：1
> 
> 时间：2012-06-18T18:57:22.910
> 
> 标签：c#

我在我的 C# 应用程序中使用 ShutdownBlockReasonCreate 来警告用户注销/关闭是否会影响我的应用程序中当前正在运行的方法。

我有两种方法可以警告用户：“上传”方法和“下载”方法。

如果用户开始长时间上传，我会设置 ShutdownBlockReasonCreate 并使用“上传当前正在运行”之类的消息。

我遇到的问题是，如果用户在长时间上传运行时开始简单下载，还会再次调用 ShutdownBlockReasonCreate 并显示“下载当前正在运行”之类的消息。

这会覆盖原来的“上传正在运行”消息。因此，当我的下载方法完成并调用 ShutdownBlockReasonDestroy 时，用户现在突然能够关闭和注销，即使上传仍在运行。

我希望能够使用我可以调用的可选参数调用 ShutdownBlockReasonCreate，这样我就可以向它发送多个字符串，说明程序为什么不允许 Windows 关闭或注销。

因此，当用户注销时，我希望它显示：

“上传正在运行”
“下载正在运行”

如果上传和下载都在运行。

有人可以修改我的代码来告诉我如何做到这一点吗？如果我可以传递除“this.Handle”之外的其他内容；也许我可以做到这一点，但我不确定如何做到这一点。

```
 //http://blogs.msdn.com/b/oldnewthing/archive/2012/06/14/10319617.aspx
        //http://bartdesmet.net/blogs/bart/archive/2006/10/25/Windows-Vista-_2D00_-ShutdownBlockReasonCreate-in-C_2300_.aspx
        [DllImport("user32.dll")]
        public extern static bool ShutdownBlockReasonCreate(IntPtr hWnd, [MarshalAs(UnmanagedType.LPWStr)] string pwszReason);

        [DllImport("user32.dll")]
        public extern static bool ShutdownBlockReasonDestroy(IntPtr hWnd);

        private bool isBlocked = false;

        protected override void WndProc(ref Message aMessage)
        {
            const int WM_QUERYENDSESSION = 0x0011;
            const int WM_ENDSESSION = 0x0016;

            if (isBlocked && (aMessage.Msg == WM_QUERYENDSESSION || aMessage.Msg == WM_ENDSESSION))
                return;

            base.WndProc(ref aMessage);
        }

        private void StopShutdown(string strMessage)
        {
            try
            {
                //strMessage == Message to display in shutdown/logoff box
                if (ShutdownBlockReasonCreate(this.Handle, strMessage))
                {
                    isBlocked = true;
                   Console.WriteLine("++ StopShutdown successful");
                }
                else
                    Console.WriteLine("++ StopShutdown failed");

            }
            catch (Exception ext)
            {
                MessageBox.Show("++ StopShutdown Error:    " + ext.Message + " " + ext.StackTrace);
            }
        }

        private void ResetShutdown()
        {
            try
            {

                if (ShutdownBlockReasonDestroy(this.Handle))
                {
                    isBlocked = false;
                    Console.WriteLine("++ ResetShutdown successful");
                }
                else
                    Console.WriteLine("++ ResetShutdown failed");

            }
            catch (Exception ext)
            {
                MessageBox.Show("++ ResetShutdown Error:    " + ext.Message + " " + ext.StackTrace);
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            StopShutdown("Upload in Progress");
            MessageBox.Show("Upload in Progress");
            ResetShutdown();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            StopShutdown("Download in Progress");
            MessageBox.Show("Download in Progress");
            ResetShutdown();
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:23:38.210

为了确保显示正确的消息，并且在阻塞操作正在进行时始终显示消息（并防止关闭），您需要仔细跟踪系统中发生的情况。

例如，假设您可以同时运行任意数量的上传和下载。在这种情况下，您的`StopShutdown()`方法需要确定当前正在发生的操作。如果至少有一个上传，但没有下载，则将消息设置为“上传中”。如果至少有一次下载，但没有上传，请将消息设置为“正在下载”。如果每个都至少有一个，则将消息设置为“正在上传和下载”。

在您的`ResetShutdown()`方法中，您需要再次检查哪些操作仍在进行中。如果没有，那么你应该销毁原因，然后`isBlocked`重新设置`false`。否则，您应该根据当前运行的内容*调整*`isBlocked`消息，并保留为`true`.

通过这样做，您可以确保您都拥有正确的关闭方法，并且只有在您的程序不在应该阻止关闭的操作中间时才允许关闭。

（此外，您应该记住，即使您“阻止”它，用户也可以自由“强制关闭”系统，因此更安全的方法通常是尝试暂停您正在执行的操作，然后稍后再恢复.)

# .htaccess - 使用 HTACCESS，我如何将 example.php 重写为 /example2.php，无论 example1.php 位于哪个文件夹中

> ID：11089260
> 
> 赞同：0
> 
> 时间：2012-06-18T18:57:26.780
> 
> 标签：.htaccess, rewrite

所以，例如，

```
fakesite.com/folder1/example1.php
fakesite.com/folder2/folder2a/example1.php
fakesite.com/folder3/example1.php 
```

all 会用 . 的内容重写 example1.php。. .

```
fakesite.com/example2.php 
```

这将发生在服务器上各种文件夹中的大量文件中，因此简单的重写将不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:00:32.753

假设您使用的是 Apache，请尝试：

```
RewriteEngine On
RewriteRule example1.php /example2.php [L] 
```

这对于 mod_rewrite 来说真的很基础，谷歌搜索“apache rewrite examples”会给你这个。

# android - Android 模拟器上的 OpenGL ES 2.0 不工作

> ID：11089262
> 
> 赞同：1
> 
> 时间：2012-06-18T18:57:30.227
> 
> 标签：android, android-emulator, opengl-es-2.0

在[Android 上 OpenGL ES 2.0 的文档中](https://developer.android.com/resources/tutorials/opengl/opengl-es20.html)，它指出：

```
Caution: OpenGL ES 2.0 is currently not supported by the Android Emulator. You must have a physical test device running Android 2.2 (API Level 8) or higher in order to run and test the example code in this tutorial. 
```

但是，这（[http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html](http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html)）指出：

```
As a bonus, since we’re now supporting OpenGL ES 2.0, your OpenGL games can now run inside the emulator. 
```

但是，我尝试在模拟器上使用 OpenGL ES 2.0 并出错，说设备（模拟器）不支持 OpenGL ES 2.0>

虚拟机作为加速的 Intel Atom x86 处理器运行，我将 GPU 仿真设置为“是”。

我在 64 位 Windows 7 Professional 上使用 API 级别 15 和最新版本的 SDK (19)。

我的 CPU 是：Intel Core i7-2670QM，我有一个 NVIDIA GeForce GTX 560M。

有任何想法吗？它应该工作吗？如果是这样，我该如何让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:18:58.407

事实证明，我看到的错误消息是我使用的 3d 框架（Rajawali）正在输出的。OpenGL ES 2.0 在模拟器上运行良好，但是，模拟器没有报告它受支持。我删除了支票，它工作正常。

# batch-file - 选择和错误级别？

> ID：11089266
> 
> 赞同：6
> 
> 时间：2012-06-18T18:57:48.820
> 
> 标签：batch-file

我做这样的事情：

```
echo 1-exit
echo 2-about
echo 3-play
choice /c 123 >nul
if errorlevel 1 goto exit
if errorlevel 2 goto about
if errorlevel 3 goto play
:play
blah
:about
blah
:exit
cls 
```

如果我选择“播放”选项，它就会退出。我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-18T19:44:08.537

`if errorlevel`如果选择返回的实际错误级别大于或等于给定值，则表达式计算为真。因此，如果您点击 3，则第一个 if 表达式为真并且脚本终止。致电`help if`了解更多信息。

有两种简单的解决方法。

第一个（更好） - 用系统变量与给定值`if errorlevel`的实际比较替换表达式：`%ERRORLEVEL%`

```
if "%ERRORLEVEL%" == "1" goto exit
if "%ERRORLEVEL%" == "2" goto about
if "%ERRORLEVEL%" == "3" goto play 
```

第二个 - 更改比较顺序：

```
if errorlevel 3 goto play
if errorlevel 2 goto about
if errorlevel 1 goto exit 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T03:49:41.173

The easiest way to solve this problem is to use the %errorlevel% value to directly go to the desired label:

```
echo 1-exit
echo 2-about
echo 3-play
choice /c 123 >nul
goto option-%errorlevel%
:option-1
rem play
blah
:option-2
rem about
blah
:option-3
exit
cls 
```

# android - layout_alignParentRight 或 layout_alignParentLeft 是否适用于包含布局？

> ID：11089267
> 
> 赞同：0
> 
> 时间：2012-06-18T18:58:03.753
> 
> 标签：android, android-layout, android-widget, android-relativelayout

我有一个小问题。

我正在创建一个自定义按钮小部件

```
<?xml version="1.0" encoding="utf-8"?>

<Button
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/barBtn"
    android:layout_width="wrap_content"
    android:layout_height="32dp"
    android:layout_marginLeft="8dp"
    android:layout_marginRight="8dp"
    android:textColor="@color/white"
    android:background="@drawable/sel_btn_bar"
    android:layout_centerVertical="true"
/> 
```

然后我将它放入`RelativeLayout`

```
<RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
    <ImageView
            android:layout_height="wrap_content"
            android:layout_width="fill_parent"
            android:scaleType="fitXY"
            android:src="@drawable/bar"/>
    <include layout="@layout/segm_btn_stores"/>

        <include
                layout="@layout/btn_bar"
                android:layout_alignParentRight="true"/>
</RelativeLayout> 
```

但是 align 在我放置可以随意移动的`include`标签之前不起作用。`RelativeLayout`但是这种方法会产生另一个问题：按钮会比在外面时更窄`RelativeLayout`。我能做些什么？我想在一个地方设置按钮参数。

是的，我可以添加这一行：`android:layout_alignParentRight="true"`标记`Button`，它会工作！

所以问题是：为什么它适用于`Button`标签而不适用于`include`标签？

## 更新

按钮和片段布局在[那里](http://db.tt/4EMEUhPq)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:16:45.217

我认为该`android:layout_centerVertical`属性（对于您的`Button`布局）仅在 a中有效`RelativeLayout`（至少它记录在`RelativeLayout.LayoutParams`文档中：http: [//developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)），因此我不会不要指望它可以在，比如说，a 中工作`LinearLayout`。

至于按钮内部比外部窄的情况`RelativeLayout`，我真的不知道该说什么。鉴于您提供的 XML 片段，您似乎`RelativeLayout`是文档根目录，`<include ... />`即将标签移出它会生成非法 XML，因此编译错误（如果使用 Eclipse）。

我实际上更喜欢在自定义样式中定义按钮主题，然后您可以在应用程序全局样式 xml 中进行设置，例如：

```
<resources>
    <style name="my_custom_style" parent="android:style/Theme.NoTitleBar">
        <item name="android:buttonStyle">@style/my_button_style</item>
    </style>

    <style name="my_button_style" parent="@android:style/Widget.Button">
        <item name="android:gravity">center_vertical|center_horizontal</item>
        <item name="android:background">@drawable/my_button_background</item>
        <item name="android:focusable">true</item>
        <item name="android:clickable">true</item>
        <item name="android:textColor">@color/my_custom_red_color</item>
        <item name="android:textStyle">bold</item>
        <item name="android:textSize">11sp</item>
    </style>
</resources> 
```

然后在 中设置自定义样式`AndroidManifest.xml`，如下所示：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/application_title"
    android:theme="@style/my_custom_style">

    <!-- Your Activities, Services etc goes here -->

</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:04:33.217

我很困惑你的问题是什么。你想把你的观点从相对布局中移开吗？如果您进行布局，您的视图将必须属于一个 ViewGroup。对齐不起作用，因为您的视图位于定义该属性“RelativeLayout”的 ViewGroup 之外

# excel - 如何将 20120103 之类的数字转换为 Excel 可以识别的日期？

> ID：11089270
> 
> 赞同：2
> 
> 时间：2012-06-18T18:58:08.107
> 
> 标签：excel, vba, datetime

我有一个 8 位数字告诉我日期，YYYYMMDD。如何将此数字转换为 Excel 将识别为日期的日期。

假设单元格 A1 中有 20120229 ......我该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T19:11:46.180

既然你用 VBA 标记了这个问题，我假设你想在 VBA 中得到答案，所以你去：

```
Dim l As Long
Dim s As String
Dim d As Date

l = Range("A1").Value ' 20120229

' convert it to a string 
s = CStr(l)

' can now use string functions to parse it
d = DateSerial(CInt(Left(s, 4)), CInt(Mid(s, 5, 2)), CInt(Right(s, 2)))
' d is now 29 Feb 2012

' write it back to the sheet
Range("A2").Value = d 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-18T19:01:50.333

使用这个公式：`=DATE(LEFT(A1,4),MID(A1,5,2),RIGHT(A1,2))`其中 A1 是单元格坐标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-22T19:50:07.477

我喜欢能够在 excel 中选择文本并调用宏来完成这项工作。

```
Sub YYYYMMDDToDate()
 Dim c As Range
 For Each c In Selection.Cells
  c.Value = DateSerial(Left(c.Value, 4), Mid(c.Value, 5, 2), Right(c.Value, 2))
  'Following line added only to enforce the format.
  c.NumberFormat = "mm/dd/yyyy"
 Next
End Sub 
```

# wpf - WPF 表单到表单更新

> ID：11089273
> 
> 赞同：0
> 
> 时间：2012-06-18T18:58:23.893
> 
> 标签：wpf, forms, textbox

我正在尝试将标签从一种形式更新到另一种形式。代码编译正常但没有更新？

```
Class MainWindow 

    Private Sub Window_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
        Dim frm As New Window1
        frm.Show()
    End Sub
End Class 
```

第二种形式：

```
Public Class Window1

    Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click
        My.Windows.MainWindow.Label1.Content = "dsfdsfsdf"
        My.Windows.MainWindow.Label1.UpdateLayout()
    End Sub
End Class 
```

它不会更新主表单的标签...希望它更清楚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:05:37.690

所以这是您实际需要的代码：

公共课窗口1

```
Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click
    DirectCast(Application.Current.MainWindow, MainWindow).Label1.Content = "test"
End Sub 
```

结束类

我不确定`My.Windows`集合是什么，但它`Application.MainWindow`为您提供了对在项目属性中设置为启动对象的窗口的引用（或您在 app.xaml.cs 文件中设置的那个）。以前您可能会获得对该`Window1`类的不同实例的引用，因此它正在运行并且不会引发异常，但是由于它不是窗口的*实际*可见实例，因此您看不到任何更改。

# c# - 在 C# 中将对象序列化为 xml

> ID：11089275
> 
> 赞同：2
> 
> 时间：2012-06-18T18:58:29.893
> 
> 标签：c#, xmlserializer

我在命名空间学校下有一个简单的学生类。

```
namespace XmlTestApp
{
    public class Student
    {
        private string studentId;

        public string FirstName;
        public string MI;
        public string LastName;

        public Student()
        {
            //Just provided for making Serialization work as obj.GetType() needs parameterless constructor.
        }

        public Student(String studentId)
        {
            this.studentId = studentId;
        }

    }
} 
```

现在，当我序列化它时，我将它作为序列化的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<Student xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <FirstName>Cad</FirstName>
  <MI>Dsart</MI>
  <LastName>dss</LastName>
</Student> 
```

但我想要的是这个，基本上我需要在xml中以类名为前缀的命名空间，这可能吗？

```
<?xml version="1.0" encoding="utf-8"?>
<XmlTestApp:Student xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <FirstName>Cad</FirstName>
  <MI>Dsart</MI>
  <LastName>dss</LastName>
</Student> 
```

这是我的序列化代码：

```
Student s = new Student("2");
            s.FirstName = "Cad";
            s.LastName = "dss";
            s.MI = "Dsart";

            System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(s.GetType());

            TextWriter txtW=new StreamWriter(Server.MapPath("~/XMLFile1.xml"));
            x.Serialize(txtW,s); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:03:59.937

**编辑**：简短的回答仍然是肯定的。正确的属性实际上是 XmlType 属性。此外，您需要指定一个命名空间，然后在序列化代码中，您需要为将用于限定元素的命名空间指定别名。

```
namespace XmlTestApp
{
    [XmlRoot(Namespace="xmltestapp", TypeName="Student")]
    public class Student
    {
        private string studentId;

        public string FirstName;
        public string MI;
        public string LastName;

        public Student()
        {
            //Just provided for making Serialization work as obj.GetType() needs parameterless constructor.
        }

        public Student(String studentId)
        {
            this.studentId = studentId;
        }

    }
}

...

        Student s = new Student("2");
        s.FirstName = "Cad";
        s.LastName = "dss";
        s.MI = "Dsart";

        System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(s.GetType());

        System.Xml.Serialization.XmlSerializationNamespaces ns = new System.Xml.Serialization.XmlSerializationNamespaces();

        ns.Add("XmlTestApp", "xmltestapp");

        TextWriter txtW=new StreamWriter(Server.MapPath("~/XMLFile1.xml"));
        x.Serialize(txtW,s, ns); //add the namespace provider to the Serialize method 
```

您可能不得不尝试设置命名空间以确保它仍然使用来自 W3.org 的 XSD/XSI，但这应该会让您走上正轨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:04:23.387

如何实现它的另一种方法是编写你的 xml - 而不是使用 Visual Studio 中的工具 - xml 到 xsd。如果你有 xsd，你可以用 xsdToCode 生成可序列化的类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:08:44.007

一个优雅的解决方案是使用 XmlSerializerNamespaces 来声明您的命名空间，然后将其传递给 XmlSerializer

请参阅[XML 序列化和命名空间前缀](https://stackoverflow.com/questions/2339782/xml-serialization-and-namespace-prefixes)

# css - simple_form：在一行上嵌套模型表单元素？

> ID：11089303
> 
> 赞同：0
> 
> 时间：2012-06-18T19:00:07.217
> 
> 标签：css, ruby-on-rails, twitter-bootstrap, nested-attributes, simple-form

我正在使用嵌套模型表单来编辑客户的所有电话号码。如果我将所有电话属性放在一条线上，我认为 simple_form 显示它的方式可以得到改进。

这是我目前拥有的代码：

```
.main
  .form-inputs
    = f.input :lname, label: t('client.lname')
    = f.input :fname, label: t('client.fname')
    = f.simple_fields_for :phones do |phones_form|
      = phones_form.input :phone, label: 'Phone'
      = phones_form.input :kind, collection: [:home, :work, :cell, :unknown], label: 'Kind'
      = phones_form.input :_destroy, as: :boolean, label: 'Delete?'

  .form-actions
    = f.button :submit, value: t('client.submit'), class: 'btn btn-primary' 
```

它产生以下内容： ![在此处输入图像描述](../Images/ac1b2f526bdc98684d1fd881a1ddb2c5.png)

是否可以将嵌套模型的表单属性放在一行上（像这样）？ ![在此处输入图像描述](../Images/50f97d764b52eefffb191302cc79d1fc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:07:29.037

是的，这是一个 CSS 问题。简而言之，您可以这样写：

```
= phones_form.input :kind, collection: [:home, :work, :cell, :unknown], label: 'Kind', style: 'width: 50px;' 
```

# jquery - 如何让我的新注册设计表单成为 AJAXified？

> ID：11089315
> 
> 赞同：3
> 
> 时间：2012-06-18T19:01:04.110
> 
> 标签：jquery, ajax, ruby-on-rails-3, devise

我想要发生的是成功创建帐户后，提交的表单应该消失并且应该出现一条消息（取决于注册的状态）。

如果成功，他们应该会看到一个简单的“谢谢。请检查您的电子邮件”。

如果不是，那么他们应该会看到一条适当的消息 - 例如“抱歉，该电子邮件已被占用”。

这是我的表格：

```
<div class="nine columns offset-by-three sign-up-form">
  <%= form_for(resource, :as => resource_name, :class => "send-with-ajax", :url => user_registration_path(resource), :validate => true, :html => { :id => 'user_new' }) do |f| %>
    <div class="six columns alpha"> 
       <%= f.text_field :email, :placeholder => "your-email@address.com", :input_html => {:autofocus => true}, :validate => true %>
    </div>              
    <div class="three columns sign-up alpha">
      <%= f.submit :label => "Submit", :value => "Sign Me Up!"  %>
      <div class="ajax-response"><%= devise_error_messages! %></div>
    </div>
    <% end %>
  </form>
</div> 
```

这是我的`create.js.erb`：

```
$(document).ready(function() {    
  $('#user_new').submit(function() { 
    $(this).fadeOut(600).hide(); 
    $(this).append('<h3>Thank You. You should receive an email shortly.</h3>').fadeIn(1000);
  });    
)} 
```

但这不能正常工作。例如，当我按下提交并且电子邮件地址已经在数据库中时 - 没有任何反应。

PS我知道如果它是一个“常规”表单，我会`format.js`在处理这个表单的控制器中做 - 并在那里计算状态代码和消息 - 但设计是一个不同的野兽，我不想生成新的当我不完全舒服时，控制器和覆盖我不应该的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T12:41:22.573

正如 Devise`respond_with`在`Devise::Registrations`控制器上使用的那样，您应该能够使用简单的 AJAX 调用来发送表单并检索响应。这是我所知道的最简单的形式。

为此，请将此 Javascript 代码添加到您的注册表单页面：

```
$("#user_new").submit(function(){
  $.ajax({
    url: "/users",
    success: function(){
      $(this).fadeOut(600).hide(); 
      $(this).append('<h3>Thank You. You should receive an email shortly.</h3>').fadeIn(1000);
    },
    error: function(){
      // Put your error code here
    }
  });
}); 
```

如果你想在创建后使用 create.js.erb 文件，你应该这样做：

*   添加`:format => :js`和`:remote => true`到您的`form_for`
*   只有此代码应`create.js.erb`存档：

    ```
    $("#user_new").fadeOut(600).hide().append('<h3>Thank You. You should receive an email shortly.</h3>').fadeIn(1000); 
    ```

这样，Devise 会在 AJAX 响应成功后执行 :js 文件内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T05:15:17.553

对我有用的方法是

首先在`:remote => true`注册表中输入

那么有2个选项

1.  为了确保表单是 repond_to :js 的控制器和控制器 js 文件中的控制器（特别是在我的情况下，它是页面控制器（pages#home）中的主页操作，我会在 home.js.erb 中放入类似

> ```
>  $(function() {
>       return $(".new_user").ajaxError(function(event, jqXHR, ajaxSettings, thrownError) {
>         if (jqXHR.status === 401) {
>           $("#notice").fadeIn();
>           $("#notice").html(jqXHR.responseText).fadeOut(1000);
>         }
>       });
>     }); 
> ```

1.  第二种选择是使用 rails/devise 自动使用的 js 文件，即 create.js.erb，需要在 /views/devise/registrations 下创建。该文件将类似于

> ```
>  $("#signUpForm").bind("ajax:success", function(xhr, data, status) {
>   <% if resource.errors.full_messages.count <1 %>
>       $("#noticesignup").html("Confirmation Mail Sent :) ");
>   <% else %>
>       $("#noticesignup").html("<%= escape_javascript ( devise_error_messages!) %>");
>   <% end %>
> }); 
> ```

差不多就是这样

# iphone - 支持 NSString 的国际化

> ID：11089317
> 
> 赞同：0
> 
> 时间：2012-06-18T19:01:06.513
> 
> 标签：iphone, objective-c, ios, ipad, internationalization

我有一堆以下代码行：

```
[NSString stringWithFormat:@"%@ and %@", subject.title, secondsubject.title];

 [NSString stringWithFormat:@"%@ and %d others", subject.title, [newsfeeditem count] - 1]; 
```

以及应用程序中的更多内容。基本上我正在构建一个像 facebook 这样的新闻提要风格，它有字符串常量。废话喜欢废话。我应该在哪里/如何做这些字符串常量，以便轻松实现国际化？我应该有一个仅用于存储字符串常量的文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:57:27.387

请参阅资源编程指南的[字符串资源](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/LoadingResources/Strings/Strings.html)部分。这个特定问题的关键部分是“格式化字符串资源”。

你会有类似的东西：

```
[NSString stringWithFormat:NSLocalizedString(@"%1$@ and %2$@", @"two nouns combined by 'and'"),
                           subject.title, secondsubject.title]; 
```

`%1$@`是第一个替换的位置。这使您可以重新排列文本。然后你会有字符串资源文件，如：

英语：

```
/* two nouns combined by 'and' */
"%1$@ and %2$@" = "%1$@ and %2$@"; 
```

西班牙语：

```
/* two nouns combined by 'and' */
"%1$@ and %2$@" = "%1$@ y %2$@"; 
```

你需要对这些组合非常深思熟虑。首先，您永远无法以可翻译的方式从句子的一部分中构建一个句子。您几乎总是需要一口气翻译整个消息。我的意思是你不能有一个字符串说`@"I'm going to delete"`和另一个字符串说`@"%@ and %@"`并将它们粘合在一起。语言之间的词序变化太大。

同样，由于各种协议规则，复杂的事物列表可能会导致各种令人头疼的问题。一些语言有特殊的复数规则、性别协议和类似问题。尽可能保持您的信息简单、简短和静态。

但是上述工具对于解决您正在讨论的问题非常有用。有关更多详细信息，请参阅文档。

# javascript - 如何指定用于测试的虚拟数据

> ID：11089321
> 
> 赞同：1
> 
> 时间：2012-06-18T19:01:31.183
> 
> 标签：javascript, jquery, asp.net-mvc, backbone.js, handlebars.js

我正在为使用 Backbone.js 的 MVC 项目开发 UI。控制器等方面的工作还没有结束，但我想测试我所做的 UI 更改。我定义了以下模型：

```
app.models.Test = Backbone.Model.extend({
        urlRoot: '/users/getTestValues',
        fetch: function (data) {
            return $.ajax({
                type: 'get',
                dataType: 'jsonp',
                url: this.url(),
                **data: data**               
            });
        }
    }); 
```

视图使用此模型在 UI 上呈现模板（包含 2 列的表）。

```
{{#each data}}          
<tr>                                        
<td>{{this.T1}}</td>
<td>{{this.T2}}</td>
</tr>
{{/each}} 
```

以下控制器仅用作占位符：

```
[HttpGet]
        public JsonpResult  getTestValues(int? entityId, int? id)
        {
            return JsonpResult(WebResult.Success());
        } 
```

我应该如何对“数据”值进行硬编码以进行测试？我尝试将其添加到模型中，但它不起作用：

```
dataFilter: function (response) {                    
                    return { data: [{ "T1": "test1", "T2": "test2"
                    }]
                    };
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:27:31.113

您可以硬编码控制器中的值或使用[Mockjax 之](https://github.com/appendto/jquery-mockjax)类的库来拦截 AJAX 请求并返回数据。

```
[HttpPost]
public JsonResult getTestValues(int? entityId, int? id)
{
    return Json(new { "T1": "test1", "T2": "test2" });
} 
```

# events - ExtJS menu checkItem：在某些情况下如何防止项目检查事件？

> ID：11089323
> 
> 赞同：2
> 
> 时间：2012-06-18T19:01:44.673
> 
> 标签：events, extjs, click

对于一个菜单checkItem，当用户点击它时，默认会触发checkchange；我想知道如果遇到某种情况，单击后如何不更改其检查状态，换句话说，停止此事件链。

我尝试了以下代码，但不起作用：

```
listeners: {
'click': function(item, evt) {
    if(1) { //verify whether that certain case
        evt.stopEvent(); //since click_event is triggered before setChecked()/checkChange, I thought this may stop its going further...
        alert('case met!');
    }
},
checkHandler: function(item, checked) {
   //...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T19:59:05.667

您可以收听该`beforecheckchange`事件。[这](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.menu.CheckItem-event-beforecheckchange)是在文档中。

根据文档，只需应用您的条件逻辑，如果它没有通过，则从处理程序返回 false。

例如：

```
listeners: {
    'beforecheckchange': function(item, checked) {
        if(!1) { // or whatever your conditional logic is
            return false;
        }
    },
} 
```

# javascript - 使用 jQuery Deferred 查找第一个可用的数据源

> ID：11089335
> 
> 赞同：5
> 
> 时间：2012-06-18T19:02:37.940
> 
> 标签：javascript, jquery, jquery-deferred

所以我在一次采访中被问到这个问题，但它提出了一个很好的用例。假设您有一堆数据源。您想找到第一个可用的并处理它并忽略其余的。

所以像：

```
var datasources = new Array("somedatabase1/pizza","somedatabase2/beer","somedatabase3/llama");
var dfds = new Array();
$.each(datasources,function(source){
    dfds.push($.getJSON(source));
});

$.when(dfds).done(function(){alert("they are all done");}); 
```

忽略我真的不认为什么时候接受一个数组（也许是这样）。这当然会让它等到它们全部完成。我正在寻找一些代码，让它等到一个，其中任何一个完成，然后不用担心其他的。

我被告知它只会递归地工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:10:21.877

这不使用递归，但符合​​从多个数据源获取的要求，并且只关心返回成功响应的第一个。

[http://jsfiddle.net/mNJ6D/](http://jsfiddle.net/mNJ6D/)

```
function raceToIt(urls) {
    var deferred = $.Deferred(),
        promises;

    function anyComplete(data) {
        if (!deferred.isResolved()) {
            deferred.resolveWith(this, [data]);
            promises.forEach(function(promise) {
                promise.abort();
            });
        }
    }
    promises = urls.map(function(url) {
        return $.getJSON(url).then(anyComplete);
    });
    return deferred.promise();
}
raceToIt(["/echo/json/", "/echo/json/", "/echo/json/"]).then(function(data) {
    console.log(data);
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T20:21:50.423

我制作了一个插件，它提供了另一个版本的`$.when()`反向语义。它是从实际的 jQuery 实现修改而来的，`$.when()`因此它与原来的完全相同，只是它等待第一个`resolve`d 承诺，或者所有承诺都被`reject`ed。

只需在加载 jQuery 后立即放入此代码：

```
(function($) {
  $.reverseWhen = function( subordinate /* , ..., subordinateN */ ) {
    var i = 0,
      rejectValues = Array.prototype.slice.call( arguments ),
      length = rejectValues.length,

      // the count of uncompleted subordinates
      remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

      // the master Deferred. If rejectValues consist of only a single Deferred, just use that.
      deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

      // Update function for both reject and progress values
      updateFunc = function( i, contexts, values ) {
        return function( value ) {
          contexts[ i ] = this;
          values[ i ] = arguments.length > 1 ? Array.prototype.slice.call( arguments ) : value;
          if( values === progressValues ) {
            deferred.notifyWith( contexts, values );
          } else if ( !( --remaining ) ) {
            deferred.rejectWith( contexts, values );
          }
        };
      },

      progressValues, progressContexts, rejectContexts;

    // add listeners to Deferred subordinates; treat others as rejected
    if ( length > 1 ) {
      progressValues = new Array( length );
      progressContexts = new Array( length );
      rejectContexts = new Array( length );
      for ( ; i < length; i++ ) {
        if ( rejectValues[ i ] && jQuery.isFunction( rejectValues[ i ].promise ) ) {
          rejectValues[ i ].promise()
            .done( deferred.resolve )
            .fail( updateFunc( i, rejectContexts, rejectValues ) )
            .progress( updateFunc( i, progressContexts, progressValues ) );
        } else {
          --remaining;
        }
      }
    }

    // if we're not waiting on anything, reject the master
    if ( !remaining ) {
      deferred.rejectWith( rejectContexts, rejectValues );
    }

    return deferred.promise();
  };
})(jQuery); 
```

# node.js - 将 PutObject 与 awssum v0.6.1 一起使用时出现 403 SignatureDoesNotMatch 错误

> ID：11089345
> 
> 赞同：1
> 
> 时间：2012-06-18T19:03:23.937
> 
> 标签：node.js, amazon-s3

使用 awssum 0.6.1

三重检查访问密钥 ID、访问密钥和帐户 ID。向存储桶上的每个人授予权限。检查本地 pc 时间与 s3 服务器时间。

我使用的代码直接取自 awssum 的示例文件夹，即 put-object.js 示例。我正在寻找的是适用于 awssum 0.6.1 的 PutObject 方法的工作示例或确认有人让它工作。任何其他关于我的问题的想法，都值得赞赏。

```
var express = require('express')
  , routes = require('./routes');

var app = module.exports = express.createServer();

var awssum = require('awssum');
var amazon = awssum.load('amazon/amazon');
var S3 = awssum.load('amazon/s3').S3;

var accessKeyId = '-----------------';
var secretAccessKey = '----------------------';
var awsAccountId = '-------------------';

var s3 = new S3({
    accessKeyId : accessKeyId,
    secretAccessKey : secretAccessKey,
     awsAccountId    : awsAccountId,
    region : amazon.US_EAST_1
});

// Configuration

app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'ejs');
  app.use(express.bodyParser({ uploadDir: __dirname + '/public/files', keepExtensions: true }));
  app.use(express.limit('5mb'));
  app.use(express.methodOverride());
  app.use(require('stylus').middleware({ src: __dirname + '/public' }));
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
});

app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

// Routes

app.get('/upload', function(req, res) {

});

app.post('/upload', function (req, res) {
    res.send("true");

    var body = "Hello, World!\n";

    var options = {
        BucketName    : 'FTPSE',
        ObjectName    : 'success',
        ContentLength: Buffer.byteLength(body),
        Body: body
    };

  s3.PutObject(options, function(err, data) {
        console.log(err)
        console.log(data)
    });
});

app.get('/', routes.index);

app.listen(3000, function(){
  console.log("Express server listening on port %d in %s mode", app.address().port, app.settings.env);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T21:09:22.897

安迪 AwsSum 的作者在这里。

AwsSum v0.6.x 中的 S3 签名存在一些已知问题，但在更高版本中已修复。当前版本（截至 2012 年 8 月 16 日）是 v0.8.0，可以满足您的需求。

如果可能，请升级并重试。：） 非常感谢。

# javascript - 传递 2 文本框

> ID：11089348
> 
> 赞同：0
> 
> 时间：2012-06-18T19:03:38.427
> 
> 标签：javascript

我是 javascript 新手，我正在尝试将 2 个文本框值传递给一个函数，并用结果更新第三个文本框。我试过用这个：

```
 function setamount(input1,input2,input3) {
        alert(input1);
        var amnt1=parseInt(document.getElementById(input1).value);
        var amnt2=parseInt(document.getElementById(input2).value);
        var total=amnt1+amnt2;

        document.getElementById(input3).value=total;
    }

<input type="text" id="amnt1" maxlength=3 />
<input type="text" id="amnt2" maxlength=3 onBlur="setamount('amnt1','amnt2','total');"/>
<input type="text" id="total"  /> 
```

当我试图计算总数时它停止工作。有什么我错了。我似乎无法让它发挥作用。我尝试了很多不同的方法，但我无法将数字加在一起并将其分配给总数？？？

任何帮助，将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:05:00.303

错别字：

```
var total=amnt1+amnt2; 
```

应该：

```
var total=amt1+amt2; 
```

# symfony - 在 Twig 扩展中使用配置参数

> ID：11089350
> 
> 赞同：5
> 
> 时间：2012-06-18T19:03:58.307
> 
> 标签：symfony, twig

我正在创建 Twig 扩展，因此我可以创建自定义过滤器和函数。我需要访问“parameters.ini”文件中的全局配置参数。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T20:55:15.477

您可以通过依赖注入传递它们。通过构造函数传递参数或使用 setter 方法。此示例使用 xml 进行服务定义：

```
public class MyExtension extends \Twig_Extension
{
    protected $param;

    public function __construct($param)
    {
        $this->param = $param;
    }
} 
```

* * *

```
<!-- in services.xml -->
<service id="my_bundle.twig.extension.name" class="Acme\Bundle\DemoBundle\Twig\Extension\MyExtension">
    <argument>%my_parameter%</argument>
    <tag name="twig.extension" />
</service> 
```

请注意参数如何被限制在百分比符号中。[您可以从官方书籍](http://symfony.com/doc/current/book/service_container.html#service-parameters)中阅读有关依赖注入的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-13T10:15:02.960

这不是在 Twig 扩展中使用容器的好习惯，但您可以在 services.xml 中声明您的 twig 扩展时将 service_container 作为参数传递

```
 <service id="example.twig.my_extension" class="Example\CoreBundle\Twig\MyExtension">
            <argument type="service" id="service_container" />
            <tag name="twig.extension" />
        </service> 
```

在 __construct() 函数声明中添加 ContainerInterface 参数：

```
<?php
namespace Example\CoreBundle\Twig;

use Symfony\Component\DependencyInjection\ContainerInterface;

class MyExtension extends \Twig_Extension
{    
    /**
     * @var ContainerInterface
     */
    private $container;

    public function __construct(ContainerInterface $container)
    {
        $this->container = $container;
    }
    ... 
```

（不要忘记使用 Symfony\Component\DependencyInjection\ContainerInterface）

在函数中调用配置参数，如下所示：

```
$this->container->getParameter('key'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:23:58.227

我不知道在 Twig 视图中是否有可能，但在控制器中你可以这样做：

```
$this->container->getParameter('name_of_ini_value'); 
```

# javascript - 如何在 require.config() 中定义一个变量

> ID：11089353
> 
> 赞同：1
> 
> 时间：2012-06-18T19:04:00.943
> 
> 标签：javascript, requirejs

我有一个看起来像这样的文件结构：

```
/js
/vendor/
/spec
 |-main.js 
```

`spec/min.js`是我的入口点，我从中加载模块`/js,` `/vendor`，`/spec`

实际上，为了使事情正常工作，我需要把`baseUrl: '../'`.
由于目录 js、vendor 和 spec 有很多子目录，处理它们很无聊，还因为如果我更改文件结构中的某些内容，我需要更改很多字符串。

我的问题是：是否可以使用 requirejs 设置不同`paths`的或引用的变量？
显然，没有定义任何全局变量。

例子：

```
require.config({
    baseUrl: '../',
    paths: {
       userView: 'js/users/views/userView' // how it works
       userView: baseDir + '/jquery' // possible solution where baseDir = js/users/views/
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T01:49:26.323

为避免创建全局变量，您可以将其包装在自调用函数中：

```
(function() {
    var baseDir = 'something/';

    require.config({
        baseUrl: '../',
        paths: {
            userView: 'js/users/views/userView' // how it works
            userView: baseDir + '/jquery' // possible solution where baseDir = js/users/views/
        }
    });    
})(); 
```

# java - 带有 OnTouch 事件的 ScrollView

> ID：11089358
> 
> 赞同：3
> 
> 时间：2012-06-18T19:04:23.183
> 
> 标签：java, android

我有`ScrollView`一个很长的文本`TextView`，我想根据这样的用户操作拖动到下一个/上一个文本：

在我的 xml 上：

```
<ScrollView
        android:id="@+id/scrollViewTest"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content">            
    <TextView
            android:id="@+id/textViewTest"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="very long text" />    
</ScrollView> 
```

在 onCreate 我实现了`OnTouchListener`以拖动到下一个文本。

```
ScrollView sv = (ScrollView) findViewById(R.id.scrollViewTest);         
sv.setOnTouchListener(new MyOnTouch()); 
```

像这样的`OnTouchListener`定义：

```
public class MyOnTouch implements OnTouchListener {
   @Override
   public boolean onTouch(View v, MotionEvent event) {
       return pageFlip(v, event);           
   }

   public boolean pageFlip(View v, MotionEvent event) {
       switch (event.getAction()) {
       case MotionEvent.ACTION_DOWN:
           startX = event.getX();
           break;
           case MotionEvent.ACTION_UP:
           float currentX = event.getX();       
            if (startX > currentX + 150 ) {
                nextText(v);
            }
            if (startX  < currentX - 150) {                
                previousText(v);
            }
       default:
           break;
   }
   return true;
   }
} 
```

问题是当我像这样实现它时，我可以进入下一个/上一个文本，但我无法上下滚动以查看底部的文本。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:32:51.727

在方法`pageFlip`更改`return true;`为`return false;`

# javascript - Css 自定义光标在页面加载时表现异常

> ID：11089366
> 
> 赞同：0
> 
> 时间：2012-06-18T19:05:05.977
> 
> 标签：javascript, css

我使用带有 url 值的 css-crusor 属性。

在 chrome 中，页面加载时光标的行为非常奇怪。一旦我 :hoover 元素，自定义光标闪烁，然后恢复正常。

有没有人有关于如何解决这个问题的建议？

这是网站： [http](http://dev.nuagency.se/illustrators/beata-boucht-2/) ://dev.nuagency.se/illustrators/beata-boucht-2/ 发布后，它将是： http: [//nuagency.se/illustrators/beata-boucht-2/](http://dev.nuagency.se/illustrators/beata-boucht-2/)

我运行 chrome 19.0.1084.56

# php - 由于只读属性，PHP mkdir 权限被拒绝在 Windows Server 2008 IIS 7 上运行？

> ID：11089368
> 
> 赞同：14
> 
> 时间：2012-06-18T19:05:08.417
> 
> 标签：php, iis, iis-7, permissions, windows-server-2008

我遇到了在 Windows Server 2008 上的 IIS 7 上运行的 PHP 网站的问题。

有一行代码调用 mkdir 出错，错误日志显示：

“... 没有权限 ...”

**我已经排除了与文件夹权限有关的任何事情（我尝试了多个组：所有人、用户、IUSR、网络服务等，但没有运气）。**

**我需要知道 mkdir 是如何工作的，它是否检查父文件夹的只读属性？**

如果是这样，那么这可能是问题的根源，因为 Windows Server 2008 中的所有文件夹都被标记为“只读”并且复选框是灰色的 - 微软说这是“设计使然”，但我认为它真的很“糟糕”设计”。

请帮忙。

PS 可以在这里找到错误的代码行[https://github.com/LimeSurvey/LimeSurvey/blob/070d255ba381d7abcd231d7c9e0c7d11f5578c97/admin/templates.php#L1182](https://github.com/LimeSurvey/LimeSurvey/blob/070d255ba381d7abcd231d7c9e0c7d11f5578c97/admin/templates.php#L1182)它是第 1182 行。

解决方案：

*   毕竟是权限问题！
*   我们正在向错误的文件夹应用权限（用手摸额头）
*   有两个“模板”文件夹：/Templates 和 /Uploads/Templates
*   /Template 用于默认模板，而 /Uploads/Templates 用于用户创建的模板
*   我们授予“用户”组 r/w/execute/modify 对 /Uploads/Templates 文件夹的权限
*   而之前我们对 /Templates 应用权限
*   为了调试这个我用来`echo`输出`$target`值

得到教训：

*   总是阅读错误信息 - 它说“权限被拒绝”，我不相信
*   不要假设显而易见的事实 - /Templates 不是正确的文件夹
*   如果代码出错，请调试代码，不要试图猜测问题
*   使用简单的技术调试代码，例如输出变量值 - 例如 echo
*   听大多数人的意见 - 这里的大多数人都说这是一个权限问题是正确的！
*   大多数错误都有一个简单的修复 - 不要去寻找复杂的东西

赏金授予@BOMEz，因为`mkdir()`文档中的有用引用表明我应该仔细考虑权限。@BOMEz 还提供了量身定制的答案，并通过有帮助的评论与我互动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T18:04:42.370

*   作为测试（最好是在开发环境中），给予 IIS 用户对父文件夹的完全访问权限。如果这使它起作用，请慢慢开始取消特权以查看您需要哪些特权。

*   尝试改变：

    `if(mkdir($target,0777))`

到：

`if(mkdir($target))`

Windows 忽略模式选项。可能是一些奇怪的错误导致它失败。

此外，对于您的 $target 变量，您可以尝试强制它链接到完整的 Windows 路径吗？如`C:\Program Files\ IIS\...`

在尝试使用相对路径拒绝访问之前，我遇到过 Windows 的情况，但完整路径工作得很好。

编辑：查看[mkdir()](http://us3.php.net/manual/en/function.mkdir.php)文档的评论，一位评论者提到您可能还需要向用户添加执行权限：

> 如果您收到 Permission Denied 错误，但确定您尝试创建目录的权限和所有权是正确的，请再次检查：
> 
> 您尝试在其中创建目录的位置必须具有尝试创建它的所有者的执行权限，无论该文件夹是可读的还是可写的。
> 
> 这对某些人来说可能很明显，但起初对我来说并不明显。希望这可以为您省去我遇到的麻烦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T20:40:26.443

由于您没有提到任何类型的控制面板，我假设您可以访问物理或远程桌面服务器。我还将假设您检查了您的 php.ini 设置。

话虽如此，其中一些权限问题可以解决。

您需要为该站点创建一个管理员帐户（并将其添加到管理员组）以使用或仅使用您的管理员凭据。

1.  打开 IIS 管理器
2.  扩展站点
3.  突出显示有问题的网站
4.  在屏幕右侧单击“基本设置”，应弹出一个对话框。
5.  单击底部显示“连接为...”的按钮
6.  选择“特定用户”，然后单击“设置...”按钮
7.  键入您的帐户或您创建的帐户的用户名和密码。
8.  点击“确定”按钮 3 次。

这有点像大锤修复，因为它将授予您脚本对文件系统的完全不受限制的访问权限。

如果您创建了一个新用户并且想要维护某种级别的脚本安全性，那么您可以尝试将该用户从管理员组中拉出，然后通过以下方式仅授予它对该站点的完全权限：

1.  突出显示网站
2.  右键单击，编辑权限
3.  安全选项卡
4.  点击“编辑”按钮
5.  点击“添加”按钮
6.  单击“高级”，然后单击“立即查找”
7.  双击您创建的用户
8.  点击“确定”
9.  突出显示您的用户，勾选完全控制旁边的允许下的框
10.  单击“确定”两次

如果询问，请选择您要应用于所有目录和文件。

~

如果您仍然有问题，那么很有可能您的 php 设置配置不正确或损坏。（可能打开了安全模式？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:27:34.060

以下是权限的解释。

*   **读**

    *   在文件上：这意味着读取文件的内容
    *   在目录上：意思是查看目录的内容，即能够使用`ls`或`dir`
*   **写**

    *   在文件上：这意味着能够编辑文件的内容
    *   在目录上：这意味着能够创建/修改目录的内容，即在该目录中创建新文件或文件夹。
*   **执行**

    *   在文件上：这意味着从文件中执行代码（对于脚本/可执行文件）
    *   On a Directory：意思是，进入目录。`cd`没有此权限，您不能进入该目录。

--

因此，现在这清楚地说明了您的问题的答案（正如您猜对的那样），要创建新目录或将新文件写入目录，您需要对该目录的写入权限。因此，为了使文件夹成为`C:/your_folder/`您需要的，`write`以及`execute`对该文件夹的权限。（是的，你也需要执行，显然`mkdir`你需要先进入文件夹。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T14:35:20.400

我们经常遇到的问题之一是文件已从任何位置移动到网站位置，保持原始权限，而不是继承网站正在使用的池的应用程序池用户所需的权限。

所以尝试的一件好事是右键单击您的文档根文件夹，转到属性，然后转到安全选项卡。按下高级按钮，选中复选框“将所有子对象上的权限条目替换为此处显示的适用于子对象的条目”。这样，您至少可以确保在所有子文件夹和文件上设置了所有权限。

我们对只读属性有任何问题，即使我们所有的文件夹都检查了这一点。（灰显/选中）。所以我怀疑这是你的问题。

# php - 复选框值进入 mysql 查询

> ID：11089371
> 
> 赞同：1
> 
> 时间：2012-06-18T19:05:17.953
> 
> 标签：php, mysql

我有这段代码，它允许我从复选框中检索数据，还没有包含任何 mysql，所以你能帮我修改一下吗？

表格是这样的：

```
<form action="checkbox.php" method="post">
<input type="checkbox" name="checkbox[]" value="hostess_name">
<input type="checkbox" name="checkbox[]" value="hostess_familyname_en">
<input type="checkbox" name="checkbox[]" value="hostess_id">
<input type="checkbox" name="checkbox[]" value="hostess_firstname_en">
<br>
<br>
<input type="submit" name="Submit" value="Submit">
</form> 
```

我插入的值应该是数据库字段，然后我有这个 checkbox.php 文件，它读取选定的值。

```
 <?php
mysql_connect("localhost", "root", "") or die(mysql_error());
echo "Connected to MySQL<br />";
?>
<?

/* and in your checkbox.php you do this: */

if(isset($_POST['Submit']))
{
echo "<pre>"; print_r($_POST);
}
$checked = mysql_real_escape_string(implode(',', $_POST['checkbox'])); 
echo $checked;
?> 
```

如何分配给复选框值数据库字段？我想要做的是存储值并使用 implode 将它们导出到查询中..帮助我..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:32:32.563

您的 POST 变量 ($_POST['checkbox']) 实际上已经是一个数组。首先，要弄清楚您实际使用的是什么，请执行以下操作：

```
echo '<pre>';
print_r ($_POST['checkbox']);
echo '</pre>'; 
```

然后查看您的脚本并查看输出。您可能会看到一个包含一些键和值的数组。使用它，您可以决定如何进行。

如果是我，我会执行以下操作来完成您的任务：

```
$sql = "SELECT `table_id_column`, `another_column` ";
foreach ($_POST['checkbox'] as $key => $value) {
  $sql .= ", `$value`";
}
$sql .= " FROM `hostess` ORDER BY `another_colmn` ASC"; 
```

请记住，允许以这种方式修改 SQL 语句是非常糟糕的做法。在将其放入生产环境之前，您需要为此引入一些安全性。

卢克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:12:40.583

利用

```
foreach($_POST[checkbox] as $key => $value {
    echo PHP_EOL . "Key is => " . $key . " Value is => " . $value . PHP_EOL;
} 
```

试试这个，看看输出，你会看到自己如何进一步进行。

# xpages - 一段时间后按钮无响应

> ID：11089378
> 
> 赞同：3
> 
> 时间：2012-06-18T19:05:44.427
> 
> 标签：xpages

今天我们遇到了一个奇怪的问题。我们有一个带有一些按钮的 XPage，这些按钮在 editMode 中打开并绑定到后端 Notes 文档。

我们可以按下按钮并将值更新到后端文档。通过部分刷新，我们看到了新值。

到目前为止，一切都很好。

但是.. 当我们让 XPage 保持打开状态时，比如说 1 分钟，什么都不做。在这段时间之后，我们尝试单击一个按钮，我们注意到该按钮变得无响应。这种行为有原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:18:20.193

从未见过它在一分钟内发生，但我认为服务器 INI 中有一个超时设置，默认为 30 分钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T13:43:27.877

我看到了同样的问题，但是，不是在一分钟之后，而是几个小时之后。我有一个与单选按钮相关联的 onclick 事件，一段时间后，如果我返回浏览器，单击单选按钮不会执行任何操作...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-28T10:08:19.147

你有没有尝试过：

[https://openntf.org/XSnippets.nsf/snippet.xsp?id=extend-partial-refresh-timeout](https://openntf.org/XSnippets.nsf/snippet.xsp?id=extend-partial-refresh-timeout)

XSP.submitLatency = 120*1000;

# android - Android：如何模仿谷歌阅读器的窗格分隔符？

> ID：11089379
> 
> 赞同：0
> 
> 时间：2012-06-18T19:05:45.373
> 
> 标签：android

![在此处输入图像描述](../Images/041b42e5fff76847aa3807f05e0a65af.png)

Google 阅读器应用程序有一个很好的阴影，用于分隔两个窗格。我试图以非常有限的成功重新创建它。我正在使用下面的 xml，它给出了下面的屏幕截图。关于改进这一点的任何建议？

vertshadowgradient.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle">
<gradient
android:startColor="#ffffff"
android:centerColor="#e6e6e6"
android:endColor="#c8c8c8"
android:angle="0" />
</shape> 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFFFF"
    android:orientation="horizontal" >
    <View android:id="@+id/divider" 
        android:background="@drawable/vertshadowgradient"
        android:layout_marginLeft="200dip"
        android:layout_width="10dip" 
        android:layout_height="fill_parent"/>
</LinearLayout> 
```

![在此处输入图像描述](../Images/85f0d2cd24a9c615d7b891655f449b70.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:40:47.287

使用在 Google Reader [http://developer.android.com/guide/developing/debugging/debugging-ui.html](http://developer.android.com/guide/developing/debugging/debugging-ui.html)`hierarchyviewer`中了解它是如何制作的

# gcc - GCC创建的exe文件没有权限？

> ID：11089383
> 
> 赞同：0
> 
> 时间：2012-06-18T19:05:58.103
> 
> 标签：gcc, permissions, compiler-errors

我正在尝试用 C++ 编译一个简单的 hello world 代码。Mingw, Dev c++ with mingw, Code::Blocks (再次使用编译器)。当我尝试编译和执行时，会创建并执行一个 exe。但是当我尝试再次编译（覆盖到相同的输出文件）时，我得到一个错误：“权限被拒绝”。

我要覆盖的文件没有运行，我敢肯定。但是当我检查文件的权限时，它会说：“您无权查看此对象的权限”。我在管理员模式下运行一切，我的帐户是管理员，如果我没有权限，谁有？

并且创建的 exe 文件会在一段时间后自行删除。

我不知道发生了什么。我对其他文件/程序/权限没有任何其他问题，防病毒软件什么也没找到。有人知道吗？

编辑：操作系统是Win7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:09:51.863

可能有几件事情出错了。首先，它可能在某个地方开放。您可以下载 Process Explorer 并检查是否有任何程序打开了它的句柄。您可以关闭程序或句柄，然后再次尝试将其删除。或者，问题可能与权限有关 - 它可能是其他人的文件。右键单击-> 属性-> 安全选项卡-> 高级-> 所有者选项卡，然后获取对象的所有权。如果您使用 Vista/7 并启用了 UAC，则可能会有其他按钮。

进程资源管理器：[http ://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-04T07:20:39.040

我也遇到了这个问题，我通过删除包含文件的“冗余”g++ 提及来解决它。不知何故 g++ 可以自动引入一些包含文件，然后当您尝试使用 g++ 命令编译它们时，它们被自动包含编译锁定......天哪！

# html - 如何使用 libxml2 解析 HTML？我需要真实的代码示例

> ID：11089389
> 
> 赞同：0
> 
> 时间：2012-06-18T19:06:37.630
> 
> 标签：html, c, libxml2

我正在寻找如何使用 libxml2 解析 HTML 的代码示例。官方网页只包含原型声明和一些描述。我需要真实的代码示例。`XPath`和`DOM`HTMLParser 模块。我做了很多谷歌搜索；但我没有得到任何令人满意的结果。我只找到了关于 xml 解析的教程和很多 obj-c 示例（我想要纯 C）。

# cygwin - cygwin 波浪号扩展在交互式 shell 中不起作用

> ID：11089390
> 
> 赞同：4
> 
> 时间：2012-06-18T19:06:38.917
> 
> 标签：cygwin, tilde-expansion

出于某种原因，Cygwin 中的波浪号扩展在提示时对我不起作用：

```
$ ls ~
ls: cannot access : No such file or directory

$ ls ~/bin
(lists /bin not $HOME/bin)

$ echo $HOME
/home/myusername

$ echo ~

$ 
```

在最后一种情况下 ( `echo ~`) 没有输出（除了几个空行。）

我已经`set expand-tilde on`在我的`$HOME/.inputrc`文件中设置了。还有什么我需要配置的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T10:32:29.560

这是 Cygwin 的一个反复出现的问题，我相信，它与不久前的一些升级错误有关，并且从未解决。

无论如何，解决方案很简单：`/etc/passwd`在您最喜欢的编辑器中打开，在您的用户名所在的行中，在第五个和第六个冒号之间（最后一个和倒数第二个），在您的主目录的正确路径中写入，即`/home/myusername`。

我的相关行`/etc/passwd`如下所示：

```
meand:unused:12345:54321:PCNAME\meand,S-1-5-21-4567891230-654987321-312456978-58252:/home/meand:/bin/screen 
```

# parsing - 获取有关 Groovy 函数的信息（名称、签名、正文代码）

> ID：11089391
> 
> 赞同：4
> 
> 时间：2012-06-18T19:06:41.670
> 
> 标签：parsing, scala, reflection, groovy

我有一个包含一堆简单函数的 Groovy 文件，如下所示：

```
// useful functions
def myFunc1(String arg) {
    println("Hello " + arg)
}

def myFunc2(String arg) {
    println("Goodbye " + arg)
} 
```

我想从中获得：

*   方法名称
*   论据
*   函数的主体代码

（所有都是简单的字符串，我还不需要运行任何东西。）

我正要求助于一些正则表达式，但由于我使用的是 JVM 语言（Scala），我想我也许可以使用一些 Groovy 编译器的东西来以一种“更好”的方式来做这件事。

似乎有很多关于动态加载 Groovy 代码并运行它的信息，但关于自省源代码的信息却不多。有任何想法吗？

（如果以“不错”的方式失败，我还将接受一些 Scala-foo 以简洁的方式解析信息。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T23:24:43.197

这有效，并演示了在 AST 中查找每个重要节点所需的令牌类型。希望这是有道理的...通过使用大量的 Groovy 动态，我希望我没有让移植到 Scala 变得太难:-(

```
import org.codehaus.groovy.antlr.*
import org.codehaus.groovy.antlr.parser.*
import static org.codehaus.groovy.antlr.parser.GroovyTokenTypes.*

def code = '''
// useful functions
def myFunc1(String arg) {
    println("Hello " + arg)
}

def myFunc2(arg, int arg2) {
    println("Goodbye " + arg)
}

public String stringify( int a ) {
  "$a"
}
'''

def lines = code.split( '\n' )

// Generate a GroovyRecognizer, compile an AST and assign it to 'ast'
def ast = new SourceBuffer().with { buff ->
  new UnicodeEscapingReader( new StringReader( code ), buff ).with { read ->
    read.lexer = new GroovyLexer( read )
    GroovyRecognizer.make( read.lexer ).with { parser ->
      parser.sourceBuffer = buff
      parser.compilationUnit()
      parser.AST
    }
  }
}

// Walks the ast looking for types
def findByPath( ast, types, multiple=false ) {
  [types.take( 1 )[ 0 ],types.drop(1)].with { head, tail ->
    if( tail ) {
      findByPath( ast*.childrenOfType( head ).flatten(), tail, multiple )
    }
    else {
      ast*.childrenOfType( head ).with { ret ->
        multiple ? ret[ 0 ] : ret.head()[0]
      }
    }
  }
}

// Walk through the returned ast
while( ast ) {
  def methodModifier = findByPath( ast, [ MODIFIERS   ] ).firstChild?.toStringTree() ?: 'public'
  def returnType     = findByPath( ast, [ TYPE, IDENT ] ) ?: 'Object'
  def methodName     = findByPath( ast, [ IDENT       ] )
  def body           = findByPath( ast, [ SLIST ] )
  def parameters     = findByPath( ast, [ PARAMETERS, PARAMETER_DEF ], true ).collect { param ->
    [ type: findByPath( param, [ TYPE ] ).firstChild?.toStringTree() ?: 'Object',
      name: findByPath( param, [ IDENT ] ) ]
  }

  def (y1,y2,x1,x2) = [ body.line - 1, body.lineLast - 1, body.column - 1, body.columnLast ]
  // Grab the text from the original string
  def snip = [  lines[ y1 ].drop( x1 ),                // First line prefix stripped
               *lines[ (y1+1)..<y2 ],                  // Mid lines
                lines[ y2 ].take( x2 ) ].join( '\n' )  // End line suffix stripped

  println '------------------------------'
  println "modifier: $methodModifier"
  println "returns:  $returnType"
  println "name:     $methodName"
  println "params:   $parameters"
  println "$snip\n"

  // Step to next branch and repeat
  ast = ast.nextSibling
} 
```

它打印出来：

```
------------------------------
modifier: public
returns:  Object
name:     myFunc1
params:   [[type:String, name:arg]]
{
    println("Hello " + arg)
}

------------------------------
modifier: public
returns:  Object
name:     myFunc2
params:   [[type:Object, name:arg], [type:int, name:arg2]]
{
    println("Goodbye " + arg)
}

------------------------------
modifier: public
returns:  String
name:     stringify
params:   [[type:int, name:a]]
{
  "$a"
} 
```

希望它有所帮助，或者为您指明正确的方向:-)

# jquery-ui - 取消选择后，jQuery UI 按钮集颜色不清除

> ID：11089393
> 
> 赞同：0
> 
> 时间：2012-06-18T19:06:52.300
> 
> 标签：jquery-ui, firefox, button

我敢肯定我不是唯一一个问这个问题的人。当您有一个 jQuery UI 实现，并使用`.buttonset();`命令将一组复选框转换为按钮集（多选）时，当用户在选择项目后取消选择项目时，我遇到了麻烦。

所以假设在悬停时，它变成了某种颜色（基于我下载的jQueryUI主题的设置），点击后变成了活动状态颜色。当我再次单击同一个项目并将鼠标移开时，它仍然是悬停颜色，导致对该项目是否被取消选择造成混淆。

这只发生在 Firefox 上 - 似乎在 Chrome 和 Safari 上运行良好。

这是一个演示链接：[http ://www.tylervolker.com/mls-search](http://www.tylervolker.com/mls-search)

我试图对这些项目强制执行 blur() 事件，但似乎没有骰子。

```
$('.label').click(function(){
    $(this).blur();
}); 
```

我错过了什么？或者这只是我需要使用的 Firefox 东西，直到 jQueryUI 更新他们的代码，或者 Firefox 附加它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:36:34.180

这似乎是这个已知的 jQuery UI 错误 - [http://bugs.jqueryui.com/ticket/5518](http://bugs.jqueryui.com/ticket/5518)。[jQuery UI 开发团队直到 1.11 才设置](http://wiki.jqueryui.com/w/page/12138038/Roadmap)按钮小部件，所以我不希望很快解决这个问题。

该票证的相关问题中有一些建议的解决方法。

# javascript - 用 A、B、C、D 计数，而不是用 JavaScript 计数 0、1、2、3、...

> ID：11089399
> 
> 赞同：13
> 
> 时间：2012-06-18T19:07:08.527
> 
> 标签：javascript, count, numbers, counter

这可能是一个不寻常的请求，但对于我的脚本，我需要一个按字母而不是数字递增的函数。例如：

这是一个数字示例：

```
var i = 0;
while(condition){
 window.write('We are at '+i);
 ++i;
} 
```

本质上，我想用字母来计数，就像 Microsoft Excel 一样，而不是数字。所以不是打印“我们在 0”、“我们在 1”、“我们在 2”等，我需要打印“我们在 A”、“我们在 B”、“我们在C”等。

为了模仿 Excel（我能想到的唯一示例），在达到索引 25 (Z) 后，我们可以继续使用“AA”、“AB”、“AC”等。

所以它会像这样很好地工作：

```
var i = 0;
while(condition){
 window.write('We are at '+toLetter(i));
 ++i;
} 
```

如果有人可以编写一个函数，然后将字母转换回数字，那就更好了，即 toNumber('A') = 0 或 toNumber('DC') = 107（我认为）。

谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-18T20:00:16.383

这是一个将数字转换为字母的简单递归函数。

它是从一开始的，所以 1 是 A，26​​ 是 Z，27 是 AA。

```
function toLetters(num) {
    "use strict";
    var mod = num % 26,
        pow = num / 26 | 0,
        out = mod ? String.fromCharCode(64 + mod) : (--pow, 'Z');
    return pow ? toLetters(pow) + out : out;
} 
```

这是一个将字符串转换回数字的匹配函数：

```
function fromLetters(str) {
    "use strict";
    var out = 0, len = str.length, pos = len;
    while (--pos > -1) {
        out += (str.charCodeAt(pos) - 64) * Math.pow(26, len - 1 - pos);
    }
    return out;
} 
```

一个测试：http: [//jsfiddle.net/St6c9/](http://jsfiddle.net/St6c9/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:23:10.283

你的意思是这样的吗？

```
function num2chars(num, upper){
 num2chars.letters = num2chars.letters || 'abcdefghijklmnopqrstuvwxyz'.split('');
 var ret = repeat(num2chars.letters[num%26],Math.floor(num/26));

 function repeat(chr,n){
  if (n<1) {return chr;}
  return new Array(n+1).join(chr);
 }

 return upper ? ret.toUpperCase() : ret;
}
//usage
while(i<104){
 console.log(num2chars((i+=1),true));
}
//=> A..Z, AA..ZZ, AAA..ZZZ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:16:34.917

创建一个由字母 A、B、C、D 等组成的数组，然后使用 array[0] 调用 A，因为 0 是 A 的索引，您可以使用 array[i] 作为索引，只需验证，所以我不能25岁以上。

使用以下任一方式创建数组：

```
var alphabet = new Array("A","B","C");

var alphabet = new Array(25);
alphabet[0] = "A";
alphabet[1] = "B";
alphabet[2] = "C"; 
```

而不是`toLetter(i);`使用`alphabet[i];`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:40:10.207

试试下面的。在几分钟内尝试和测试

```
 var prefix = Array('','A','B'); //this will extends to 3x26 letters. Determines the Max generated
//first element of prefix is `''` so you can have A B C D
var prefix = Array('','A','B');
var alphabets = Array('A','B','C','D'); //extend this to Z
var letters = Array();

function fillArray()
{
   var prefix_len = prefix.length;
   var array_len = prefix_len * alphabets.length;
   var alpha_len = alphabets.length;

   for(var i=0; i<prefix_len; i++)
   {
      for(var a=0; a<alpha_len; a++)
         letters.push(''+prefix[i]+alphabets[a]);
   }

}

function getLetter(index)
{
  return letters[index];
}

function generateTestValues() 
{
  fillArray();
  //make sure 10 is less than letters.length
  for(var i=0; i<10; i++)
     document.write(getLetter(i)+' ');  //A B C D AA AB AC AD BA BB BC....
} 
```

HTML

```
<span id="clickable" onclick="generateTestValues()">Click Me</span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-30T20:30:39.600

这就是你如何生成随机字母：

```
function getRandomArbitrary(min, max) {
  max = Math.ceil(max);
  min = Math.floor(min); 
  return Math.round(Math.random() * (max - min) + min);
}

function assignLetter(){
  var group = ['A', 'B', 'C', 'D'];
  var text = 'We are at ';
  var str = '';
  str = text + group[getRandomArbitrary(0, group.length-1)];
  return str;
}
assignLetter(); 
```

# c# - 在 Sharepoint 2010 中获取当前登录用户

> ID：11089400
> 
> 赞同：4
> 
> 时间：2012-06-18T19:07:09.013
> 
> 标签：c#, sharepoint-2010

我有一个显示调查的 Web 部件。我需要获取当前用户，以便根据当前用户的权限隐藏或显示调查的某些信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T19:11:22.617

`SPContext.Current.Web.CurrentUser`应该做的伎俩。它具有您应该能够使用的`IsSiteAdmin`功能。`Groups`

# java - 如何在 JAVA 中减慢线程

> ID：11089401
> 
> 赞同：5
> 
> 时间：2012-06-18T19:07:11.660
> 
> 标签：java, multithreading

我有这个类，我在其中运行了一个 for 循环 10 次。此类实现 Runnable 接口。现在在 main() 我创建了 2 个线程。现在两者都将循环运行到 10 点。但我想检查每个线程的循环计数。如果 t1 超过 7 则让它休眠 1 秒以让 t2 完成。但是如何实现呢？请看代码。我尝试过，但看起来完全愚蠢。只是如何检查线程的数据？？？

```
class SimpleJob implements Runnable {
    int i;
    public void run(){
        for(i=0; i<10; i++){
            System.out.println(Thread.currentThread().getName()+" Running ");
        }        
    }

    public int getCount(){
        return i;
    }
}
public class Threadings {
    public static void main(String [] args){
        SimpleJob sj = new SimpleJob();
        Thread t1 = new Thread(sj);
        Thread t2 = new Thread(sj);

        t1.setName("T1");
        t2.setName("T2");

        t1.start();
        try{
            if(sj.getCount() > 8){ // I know this looks totally ridiculous, but then how to check variable i being incremented by each thread??
                System.out.println("Here");
                Thread.sleep(2000);
            }            
        }catch(Exception e){
            System.out.println(e);
        }
        t2.start();
    }    
} 
```

请帮忙

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-18T19:11:27.797

您应该使用一些同步对象，而不是依赖于减慢线程。我强烈建议您查看 java.util.concurrent 包中的一个类。你可以使用这个 CountdownLatch - 线程 1 将等待它，线程 2 将执行倒计时并释放锁，并让线程 1 继续（释放应该在线程 2 代码的末尾完成）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:13:11.647

如果目标是并行运行 2 个 Runnables（作为线程）并等待它们都完成，您可以按照复杂性/功能的递增顺序：

1.  使用 Thread.join （如@Suraj Chandran 所建议，但他的回复似乎已被删除）
2.  使用 CountDownLatch（也由 @zaske 建议）
3.  使用 ExecutorService.invokeAll()

编辑添加

首先，我不明白“如果你在 7 岁，那么等待另一个”的逻辑是什么。但是，要从您的主代码中使用 Thread.join()，代码看起来像

```
t1.start();  // Thread 1 starts running...
t2.start();  // Thread 2 starts running...

t1.join();   // wait for Thread 1 to finish
t2.join();   // wait for Thread 2 to finish

// from this point on Thread 1 and Thread 2 are completed... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:24:19.233

我添加了一个同步块，一次可以由一个线程进入。两个线程并行调用并进入方法。一个线程将赢得比赛并获得锁定。第一个线程离开块后等待 2 秒。在这个时候，第二个线程可以迭代循环。我认为这种行为是需要的。如果第二个线程也不能等待 2 秒，您可以设置一些布尔标志，即第一个线程完成了块并在 if 语句中使用此标志，这样可以防止第二个线程的等待时间。

```
class SimpleJob implements Runnable {
int i;
public void run(){

    synchronized (this) {
        for(i=0; i<8; i++){
            System.out.println(Thread.currentThread().getName()+" Running ");
        } 
    } 

    try {
        System.out.println("Here");
        Thread.sleep(2000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    for(i=0; i<2; i++){
        System.out.println(Thread.currentThread().getName()+" Running ");
    }
}

public int getCount(){
    return i;
}
}

public class Threadings {
public static void main(String [] args){
    SimpleJob sj = new SimpleJob();
    Thread t1 = new Thread(sj);
    Thread t2 = new Thread(sj);

    t1.setName("T1");
    t2.setName("T2");

    t1.start();
    t2.start();
}    
} 
```

# c++ - 如何使用顶点缓冲区对象

> ID：11089405
> 
> 赞同：1
> 
> 时间：2012-06-18T19:07:18.260
> 
> 标签：c++, opengl

想象一下，我想画一个由三角形组成的金字塔。

- 我应该为每个三角形创建一个 VBO 还是一个包含所有三角形的 VBO？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:09:40.477

将 VBO 选择到上下文中是相当昂贵的状态更改，因此使用更少的 VBO 绝对是有利的。

# c# - 如何获取文本块绑定值？

> ID：11089406
> 
> 赞同：0
> 
> 时间：2012-06-18T19:07:18.737
> 
> 标签：c#, windows-phone-7

我已经在 xaml 中绑定了我的文本块，是否可以将值输出到我的编码中？

我的绑定编码

```
<TextBlock Height="40" HorizontalAlignment="Left" Margin="8,24,10,0" Name="txtBlockCustName" Text="{Binding CustName, Mode=OneWay}" VerticalAlignment="Top" FontSize="26" /> 
```

我想把我的 mainpage.xaml.cs 像

```
string CustName = txtBlockCustName.Text; 
```

但它有错误..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:41:27.673

您无法访问此文本块，因为它绑定在列表框模板中。如果列表中有多个文本块，如何通过名称访问它？该程序不会知道您要求的文本块。这就是引发错误的原因。

您可以使用绑定到列表框的集合来获取客户名称。

# visual-studio-2010 - NAnt MSBuild 版本

> ID：11089407
> 
> 赞同：0
> 
> 时间：2012-06-18T19:07:27.807
> 
> 标签：visual-studio-2010, build, msbuild, nant

nant 中设置要使用哪个版本的 MSBuild 的配置设置在哪里？

Nant 在需要使用 4.0 的时候想使用 3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:32:58.917

几年前，我写了一篇博客文章，解释了如何从您的 NAnt 构建脚本中利用任何版本的 MSBuild。本质上，您将使用该`<exec>`节点来调用 MSBuild，因为它安装在您的计算机上。

[http://enterpriseyness.com/2009/12/continuous-integration-with-cruise-control-net-nant/](http://enterpriseyness.com/2009/12/continuous-integration-with-cruise-control-net-nant/)

```
<target name=”build”&gt;
  <exec program=”${MSBuildPath}”&gt;
    <arg line=’”${SolutionFile}”‘ />
    <arg line=”/property:Configuration=${SolutionConfiguration}” />
    <arg value=”/target:Rebuild” />
    <arg value=”/verbosity:normal” />
    <arg value=”/nologo” />
    <arg line=’/logger:”C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll”‘/>
  </exec>
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T19:13:42.787

您还可以创建 NAnt 框架配置。如果您编辑 NAnt.exe.config 文件，请复制其中一个`<framework>`元素及其所有子元素。更改`frameworkdirectory`以使用您要使用的 MSBuild 的版本号。您可以查看其他`<framework>`元素以了解正确用法。例如，如果您想让“net-3.5”`<framework>`元素使用 MSBuild 4.0，只需将重复的`<framework>`打开元素更改为如下所示：

```
<framework 
    name="net-3.5-msbuild-4.0"
    family="net"
    version="3.5"
    description="Microsoft .NET Framework 3.5 with MSBuild 4.0"
    sdkdirectory="${sdkInstallRoot}"
    frameworkdirectory="${path::combine(installRoot, 'v4.0.30319')}"
    frameworkassemblydirectory="${path::combine(installRoot, 'v2.0.50727')}"
    clrversion="2.0.50727"
    clrtype="Desktop"
    vendor="Microsoft"
    ><!-- Rest of framework contents here --></framework> 
```

`frameworkdirectory`请注意属性中的不同版本号。

然后指定要在 NAnt 中使用的框架。

```
<property name="nant.settings.currentframework" value="net-3.5-msbuild-4.0" /> 
```

# html - 显示：隐藏的 CSS 不起作用

> ID：11089410
> 
> 赞同：2
> 
> 时间：2012-06-18T19:07:32.500
> 
> 标签：html, css

我试图在页面加载时隐藏部分列表。
特别`sdt_wrap`是我的 HTML 类。
我知道 display:hidden 位于正确的位置，它只是没有接受隐藏值

这是CSS：

```
ul.sdt_menu li span.sdt_wrap{
    position:absolute;
    top:25px;
    left:50px;
    width:170px;
    height:150px;
    z-index:501;
    display: hidden;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-18T19:09:30.857

`hidden`不是 的有效值`display`。您正在寻找`none`，如：

```
ul.sdt_menu li span.sdt_wrap{
    display:none;
} 
```

**文档**

`display`MDN 上的CSS - [https://developer.mozilla.org/en/CSS/display](https://developer.mozilla.org/en/CSS/display)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-18T19:09:39.930

是`display:none`或`visibility:hidden`。“隐藏”不是“显示”的有效值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-16T05:41:48.890

使用`visibility:hidden`；或`opacity: 0;`财产

# php - 在 Simpletest 中将复选框设置为关闭

> ID：11089414
> 
> 赞同：0
> 
> 时间：2012-06-18T19:07:42.663
> 
> 标签：php, simpletest

在我使用 simpletest webtester 的一个测试用例中，我想取消设置一个复选框。

从文档来看，似乎 setField 应该这样做，但到目前为止它还没有奏效。文档并不清楚它如何与单个复选框一起使用，但我尝试了几种不同的设置但没有成功。

`setField('name','')`, `setField('name','off')`, 并且`setField('name', array())`似乎不起作用。

如何在simpletest中将复选框设置为未选中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:26:53.653

显然`setField('name', false)`取消选中一个复选框。

# android - 在 Android 上使用带空格的参数进行 SQLite 查询

> ID：11089416
> 
> 赞同：2
> 
> 时间：2012-06-18T19:07:57.073
> 
> 标签：android, sql

我是 SQLite 和 Android 的新手，所以也许我遗漏了一些明显的东西。

有谁知道将包含空格的参数传递给非平凡的 SQLite 数据库查询的方法，形式为“AAA BBB”

我已经尝试了所有显而易见的事情，例如在参数将被替换为选择字符串的位置周围放置单引号。

实际上尝试将“AAA BBB”硬编码到选择字符串中，但它仍然不起作用。好吧，它确实在简单的原始查询级别上工作，而不是作为更复杂查询的一部分。

我的意思是似乎没有一种方法可以将我想做的查询作为普通的 SELECT 原始查询进行。我已经尝试将子查询提供给原始查询，并且除了参数有空格之外，它可以完成我想要它做的所有事情。用作原始查询的相同子查询确实正确处理带有空格的参数（添加单引号时）。

该查询使用多个表，因此 db.Query 不是一个选项。

所以现在我正在使用 BuildQueryString 并将其输入 rawQuery。相同的故事。即使我将“AAA BBB”字符串直接硬编码到 BuildQueryString 的输入中。还有其他方法我应该使用 BuildQueryString 的结果吗？

有人知道这样做的方法吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:17:34.687

这是您要执行的操作的示例：

```
database.rawQuery("SELECT bar FROM Foo WHERE bar = 'AAA BBB'", null); 
```

如果 SQL 注入是一种威胁，并且您在以下位置有“AAA BBB” `String myName`：

```
database.rawQuery("SELECT bar FROM Foo WHERE bar = ?", new String[] { myName }); 
```

但我不确定“在更复杂的层面上意味着什么”......也许是这样的：

```
database.rawQuery("SELECT bar FROM Foo WHERE bar LIKE ? ORDER BY bar = ?, bar LIKE ?, bar LIKE ?", new String[] { myName, myName, myName + "%", "%" + myName + "%" }); 
```

# jquery - 带有marginTop的jQuery动画在IE9中不起作用

> ID：11089417
> 
> 赞同：1
> 
> 时间：2012-06-18T19:08:03.337
> 
> 标签：jquery, internet-explorer-9

我在这里运行了一个测试：[http](http://raglefant.com/test.php) ://raglefant.com/test.php我在标题中有这个 jQuery：

```
$(document).ready(function() {
    $('#hideable_header').stop().delay(2000).animate(
            {marginTop: '-=290'}
        ,1000,function() {
    });

    $('#hideable_header').click(function() {
        var position = parseInt($("#hideable_header").css("margin-top"),10);
        console.log('Position: ' + position);
        if (position == 0)
        {
            $('#hideable_header').stop().animate(
                    {marginTop: '-=290'}
                ,1000,function() {
            });
        }
        else
        {
            $('#hideable_header').stop().animate(
                    {marginTop: '+=290'}
                ,1000,function() {
            });
        }
    });
}); 
```

这是div：

```
<div id="hideable_header" style="position:fixed; top: 0; left: 0; width: 100%; height: 300px; background: #000; z-index:9999;"></div> 
```

这在 Chrome 中运行良好，但在 IE9 中却不行。如果我单击 DIV，它应该更改 margintop 以隐藏或显示 DIV，但在 IE9 中没有任何反应。如果我在 IE9 中打开 devtools，一切正常，没有出现任何错误。但是，一旦我关闭页面并再次打开它，它仍然会失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:12:41.270

在 IE9 中为我工作，但在 IE8 中不是你所期望的。在 IE8 中，初始位置是 NaN，所以我建议在内联样式中将 margin-top 设置为 0。

# python - sqlalchemy 从版本 0.5 更改为 0.7

> ID：11089420
> 
> 赞同：1
> 
> 时间：2012-06-18T19:08:16.440
> 
> 标签：python, mysql, sqlalchemy, bulkinsert

我正在尝试收集字典列表，并使用 sqlalchemy 将批量插入到 mysql 数据库中。

根据[版本 0.5 的这些文档](http://docs.sqlalchemy.org/en/rel_0_5/sqlexpression.html#executing-multiple-statements)，您可以`executemany`通过对象的函数调用来执行此操作`connection`。这是我能找到的唯一`executemany`存在的地方。

但是，在[这些 0.7 的文档中](http://docs.sqlalchemy.org/en/rel_0_7/core/tutorial.html#executing-multiple-statements)，我发现即使引用了 executemany，他们*也没有在代码片段中使用它，*事实上，它不再存在于`connection`类中。

看起来这两个功能是结合在一起的，但是如果是这样，那么`connection.execute`方法与方法有什么不同`session.execute`呢？似乎在`session.execute`不支持批量插入的文档中，那么如何将数千个字典插入到一个表中呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T21:10:35.197

我认为您误读了 0.5 链接，您指向的示例仍然使用“execute()”。SQLAlchemy 从未公开过明确的 executemany() 方法。executemany() 特别是*底层 DBAPI*的一个函数，如果给定的参数集被检测为参数列表，SQLAlchemy 将使用它。

`session.execute()`支持与 相同的功能`connection.execute()`，除了参数列表是使用命名参数“params”给出的。文档字符串对此没有明确说明，应该对其进行调整。

您还可以通过using方法获取特定于事务的`Connection`对象。`Session``session.connection()`

# javascript - 尝试在 for 循环中创建对象

> ID：11089426
> 
> 赞同：1
> 
> 时间：2012-06-18T19:08:49.843
> 
> 标签：javascript

我确信有一个非常简单的解决方案，但我无法理解它。我正在尝试在 for 循环中创建对象数组，如下所示：

```
for(var i = 0; i < 100; i++) {
    foos[i] = new Foo(i*10);
    bars[i] = someObject.createBar({
         x : 0,
         y : 0,
         foobar = function() {
              foo[i].a = true;
         }
    });
} 
```

当尝试运行它时，我得到“无法设置未定义的属性 a”，foos 和 bar 在代码的前面都被声明为全局变量。

如果我将 foos 创建为 foos[0] 并通过 bar[0] 访问，它工作正常。我怀疑这与函数级别范围有关，但据我所知，数组应该可以在全局对象上访问......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:12:46.467

您需要“锚定” 的值`i`。去做这个...

```
for(var i=0; i<100; i++) {
    (function(i) {
        // now do stuff with i
    })(i);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:11:13.470

试试这个：

```
for(var i = 0; i < 100; i++) { 
    foos.push( new Foo(i*10) ); 
    bars.push( someObject.createBar({ 
         x : 0, 
         y : 0, 
         foobar = function() { 
              foo[i].a = true; 
         } 
    }) ); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:12:14.130

i 在执行 foobar 时的值是循环结束时的值（100）。因为循环块是一个闭包。

你最好存储你想要的值。例如 ：

```
for(var i = 0; i < 100; i++) {
    foos[i] = new Foo(i*10);
    bars[i] = someObject.createBar({
         x : 0,
         y : 0,
         i : i,
         foobar: function() {
              foos[i].a = true;
         }
    });
} 
```

或者在循环中使用中间闭包来包含 i ：

```
for(var i = 0; i < 100; i++) {
    (function(i){
        foos[i] = new Foo(i*10);
        bars[i] = someObject.createBar({
             x : 0,
             y : 0,
             foobar: function() {
              foos[i].a = true;
             }
        });
    })(i);
} 
```

第一个解决方案更明确，第二个可能现在更常见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:17:26.640

您不能设置未定义的值“a”，因为“foo[i]”未定义。你从来没有定义过 foo[i]。你的意思是 foos[i]，也许吧？

此外，正如其他人所说，您的函数 foobar 将为您创建的每个对象使用相同的 i 值。您应该使用 i 创建一个新的闭包，这将允许您定义一个局部变量 i，该变量对于每个内部函数都可能不同，如下所示：

```
for(var i=0; i<100; i++) {
   (function(i) {
      // now do stuff with i
   })(i);
} 
```

# java - 多线程访问数组

> ID：11089428
> 
> 赞同：2
> 
> 时间：2012-06-18T19:08:51.613
> 
> 标签：java, arrays, multithreading, initialization, final

```
class EverythingMustBeInAClass
{
    private final int i = 42;
    private final int[] a = {2, 3, 5, 7, 11, 13, 17, 19};
} 
```

`i`声明的事实`final`保证所有线程都看到相同的 int 值 42（而不是 0）。

`a`声明的事实`final`保证所有线程都看到相同的数组*引用*。

但是如何确保所有线程都看到相同的数组*元素*（而不是 0）？我是否必须同步对数组的访问，即使我以后不打算更改数组元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T19:10:28.683

`final`不仅保证可以看到数组引用，而且保证对象本身已经完全构造和初始化。所以数组中的值也会被所有线程看到。

这是关于该主题的一个很好的链接：

> [http://www.javamex.com/tutorials/synchronization_final.shtml](http://www.javamex.com/tutorials/synchronization_final.shtml)

去引用：

> 通过最终引用访问的任何对象上的字段也保证至少与构造函数退出时一样最新。

但是，重要的是要注意`a`数组*不是*不可变的，例如，您可以设置`a[0] = 10`并且更新不会同步。但只要你*不*改变任何价值观，`a`你应该是好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:11:11.710

如果您永远不会更改内容，那么您是安全的，因为“发生在语义之前”和最终。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:11:49.197

不，如果数据结构使用关键字 final，则不必同步访问。只要您从不写入变量，您就可以根据需要进行尽可能多的同时读取。如果您不使用 final 关键字，则需要在您想要访问它的任何时候锁定该变量。

# django - django-paypal：IPN 请求总是无效的

> ID：11089431
> 
> 赞同：6
> 
> 时间：2012-06-18T19:09:08.443
> 
> 标签：django, paypal, paypal-ipn, django-paypal

我正在使用[dcramer 的 django-paypal 分支](https://github.com/dcramer/django-paypal)，但在使用我的沙盒帐户时总是遇到无效的 IPN。

我收到以下 IPN：

```
Invalid postback. (INVALID) 
```

我尝试了所有出现在谷歌上的东西：

*   检查卖家和买家的电子邮件
*   沙盒帐户都经过验证
*   我`form.sandbox`用来呈现贝宝表格
*   尝试删除自定义值
*   请求中没有非 ASCII 字符

[当使用https://www.sandbox.paypal.com/cgi-bin/webscr](https://www.sandbox.paypal.com/cgi-bin/webscr)手动检查请求时，我也得到`INVALID`.

有人遇到过这个问题吗？是否有任何更详细的页面来验证 ipn 请求？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-18T22:43:56.247

是的，从昨天（6 月 18 日）开始，我也收到回发错误：

```
Opened POST Back Socket to PayPal.
PayPal Post Back returns HTTP/1.0 400 Bad Request
Server: AkamaiGHost
Mime-Version: 1.0
Content-Type: text/html
Content-Length: 216
Expires: Mon, 18 Jun 2012 22:18:00 GMT
Date: Mon, 18 Jun 2012 22:18:00 GMT
Connection: close

<HTML><HEAD>
<TITLE>Invalid URL</TITLE>
</HEAD><BODY>
<H1>Invalid URL</H1>
The requested URL "&#47;cgi&#45;bin&#47;webscr", is invalid.<p>
....
</BODY></HTML>
: not handled. 
```

我使用自己的 IPN 集成。它试图处理来自 PayPal 的所有回复，这就是为什么我收到最后一条消息（：未处理。）我昨天进行了包升级，所以我不太确定这是一个 PayPal 问题。

# python - 使用列表创建数据框

> ID：11089435
> 
> 赞同：0
> 
> 时间：2012-06-18T19:09:25.990
> 
> 标签：python, list, dictionary

我有以下代码，我从 csv 文件中读取数据，然后操作其中的一些数据，我想将修改后的数据放入数据框中。我正在考虑将它添加到字典中，但我不确定我应该如何真正做到这一点。

我使用以下 CSV 数据文件作为数据源：

```
"17",20.2147418139502,20,20,20.8652568117822
"6",19.9412500131875,13,19,20.4982216893409
"4",16.3402085164562,6,18,16.729284141648
"11",15.9562389152125,11,17,16.4769352577916
"19",13.2889788383618,12,16,13.8285694613856
"15",11.7133173411712,1,15,11.7133173411712 
```

我忽略了 csv 数据集中的第一列。

重新计算后，我的数据是这样的（看下面的代码来理解数据操作）：

```
15.9562389152125    11  12.0    16.4769352577916    16.4958295382
13.2889788383618    12  13.0    13.8285694613856    13.8459505145
11.7133173411712    1   2.0 11.7133173411712    11.863832339
9.68207331560552    14  15.0    10.2551373334446    10.2701189451
9.56895540188998    19  20.0    10.2083322023664    10.2194703997
7.30124705657363    2   3.0 7.45176205440562    7.53980768393
6.83169608190656    5   6.0 7.18118108407457    7.2207717071
6.40446470770985    4   5.0 6.70549470337383    6.75394970988 
```

然后我按第 4 列、第 3 列和第 5 列反向排序。

然后我根据第 5 列在末尾添加一个排名列，如下所示。

```
15.9562389152125    11  12.0    16.4769352577916    16.4958295382    1
13.2889788383618    12  13.0    13.8285694613856    13.8459505145    2 
11.7133173411712    1   2.0 11.7133173411712    11.863832339     3 
9.68207331560552    14  15.0    10.2551373334446    10.2701189451    4
9.56895540188998    19  20.0    10.2083322023664    10.2194703997    5
7.30124705657363    2   3.0 7.45176205440562    7.53980768393    6
6.83169608190656    5   6.0 7.18118108407457    7.2207717071     7
6.40446470770985    4   5.0 6.70549470337383    6.75394970988    8 
```

我不确定要使用哪种数据结构来实现这一点。

我尝试了以下代码：

```
def increaseQuantityByOne(self, fileLocation):
    rows = csv.reader(open(fileLocation))
    rows.next()
    print "PricePercentage\t" + "OldQuantity\t" + "newQuantity\t" + "oldCompScore\t" + "newCompScore"
    priceCompValue = []
    priceCompRank = []
    newPriceCompValue = []
    newPriceCompRank = []
    for row in rows:
        newQuantity = float(row[2]) + 1.0
        newCompetitiveScore = float(row[1]) + float(math.log(float(newQuantity), 100))
        print row[1] + "\t", str(row[2])+"\t", str(newQuantity) + "\t", str(row[4]) + "\t", newCompetitiveScore
        priceCompValue.append(float(row[4]))
        priceCompRank.append(int(row[3]))
        newPriceCompValue.append(newCompetitiveScore)
    priceCompValue.sort(reverse=True)
    priceCompRank.sort(reverse=True)
    newPriceCompValue.sort(reverse=True)
    for item in priceCompValue:
        print item
    for item in priceCompRank:
        print item
    for item in newPriceCompValue:
        print item 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:15:10.740

不确定我是否理解您想要做什么，但我对所有表格和排序类型的东西都使用 python numpy。

[http://www.scipy.org/Tentative_NumPy_Tutorial](http://www.scipy.org/Tentative_NumPy_Tutorial) http://docs.scipy.org/doc/numpy/reference/generated/numpy.lexsort.html#numpy.lexsort

基根

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:43:23.260

假设您的数据位于`data.csv`与此脚本位于同一目录中的 csv 文件（称为 ）中：

```
from pprint import pprint
import math
import csv

# function to massage each row into desired values
def calc_new_vals(row):
    newQuantity = float(row[2]) + 1.0
    newCompetitiveScore = float(row[1]) + math.log(newQuantity, 100)
    return [ float(row[1]), 
             float(row[2]), 
             newQuantity, 
             float(row[4]), 
             newCompetitiveScore ]

# read data from file and recalculate each row
f = open('./data.csv', 'r')
reader = csv.reader(f)
records = [ calc_new_vals(record) for record in reader ]

# This sorts by the three columns in reverse
# see this page for more: http://wiki.python.org/moin/HowTo/Sorting/
records = sorted(records, key=lambda record: record[3], reverse = True)
records = sorted(records, key=lambda record: record[2], reverse = True)
records = sorted(records, key=lambda record: record[4], reverse = True)

new_records = []
rank = 1
for row in records:
    row.append( rank )
    new_records.append( row )
    rank += 1
pprint(new_records) 
```

这会产生一个列表列表：

```
[[20.2147418139502, 20.0, 21.0, 20.8652568117822, 20.87585146131716, 1],
 [19.9412500131875, 13.0, 14.0, 20.4982216893409, 20.51431403102662, 2],
 [16.3402085164562, 6.0, 7.0, 16.729284141648, 16.76275753646333, 3],
 [15.9562389152125, 11.0, 12.0, 16.4769352577916, 16.49582953823631, 4],
 [13.2889788383618, 12.0, 13.0, 13.8285694613856, 13.845950514515218, 5],
 [11.7133173411712, 1.0, 2.0, 11.7133173411712, 11.86383233900319, 6]] 
```

我希望这能让你开始。

# apache - 以点结尾的重定向 URL

> ID：11089439
> 
> 赞同：1
> 
> 时间：2012-06-18T19:09:39.687
> 
> 标签：apache, .htaccess, redirect

我正在尝试重定向以点结尾的 URL，但它不起作用...

我已经对此进行了测试：

```
RedirectMatch 301 ^/tum_and_valhalla.$ /tum_and_valhalla
RedirectMatch 301 ^/tum_and_valhalla\.$ /tum_and_valhalla
RedirectMatch 301 ^/tum_and_valhalla(.*)$ /tum_and_valhalla 
```

但他们都没有工作。应该怎么做？

我也将非常感谢获得有关如何处理 URL 的输入，包括一个 & 示例：

```
RedirectMatch 301 ^/ol&t$ /olt 
```

谢谢！

# sinatra - 我检查了 heroku 日志，发现一个意外错误没有要加载的文件 - ./astute

> ID：11089442
> 
> 赞同：1
> 
> 时间：2012-06-18T19:09:43.360
> 
> 标签：sinatra

SSup Whiz 人！！！我在heroku 上部署了一个simple_fb_app。当我 heroku 打开应用程序页面（[https://astute.heroku.com/](https://astute.heroku.com/)）时，它显示应用程序错误。我检查了heroku日志，发现了一个意外错误

> 没有要加载的文件 - ./astute 。请帮我解决这个问题，我给你买啤酒-:)

我的 GEMFILE 有

```
gem 'sinatra', '1.0'
gem 'oa-oauth', '0.1.6'
GEM 
```

我的 GEMFILE 锁有

```
remote: http://rubygems.org/
  specs:
    addressable (2.2.8)
    faraday (0.5.7)
      addressable (~> 2.2.4)
      multipart-post (~> 1.1.0)
      rack (>= 1.1.0, < 2)
    multi_json (0.0.5)
    multipart-post (1.1.5)
    nokogiri (1.4.7-x86-mingw32)
    oa-core (0.1.6)
      rack (~> 1.1)
    oa-oauth (0.1.6)
      multi_json (~> 0.0.2)
      nokogiri (~> 1.4.2)
      oa-core (= 0.1.6)
      oauth (~> 0.4.0)
      oauth2 (~> 0.1.0)
    oauth (0.4.6)
    oauth2 (0.1.1)
      faraday (~> 0.5.0)
      multi_json (~> 0.0.4)
    rack (1.4.1)
    sinatra (1.0)
      rack (>= 1.0)

PLATFORMS
  ruby

DEPENDENCIES
  oa-oauth (= 0.1.6)
  sinatra (= 1.0) 
```

这是我的 config.ru

*   require './astute' #这是加载astute.rb

    运行 Sinatra::Application

这是我的精明.rb

```
require 'sinatra'         #required for framework detection in heroku.
require 'omniauth/oauth'

enable :sessions
disable :show_exceptions

#Here you have to put your own Application ID and Secret
APP_ID = "429085837122498"
APP_SECRET = "2232ac2dd09f452a015f9f00083da8e3"

use OmniAuth::Builder do
  provider :facebook, APP_ID, APP_SECRET, { :scope => 'email, status_update, publish_stream' }
end

get '/' do
    @articles = []
    @articles << {:title => 'Deploying Rack-based apps in Heroku', :url => 'http://docs.heroku.com/rack'}
    @articles << {:title => 'Learn Ruby in twenty minutes', :url => 'http://www.ruby-lang.org/en/documentation/quickstart/'}

    erb :index
end

get '/auth/facebook/callback' do
  session['fb_auth'] = request.env['omniauth.auth']
  session['fb_token'] = session['fb_auth']['credentials']['token']
  session['fb_error'] = nil
  redirect '/'
end

get '/auth/failure' do
  clear_session
  session['fb_error'] = 'In order to use this site you must allow us access to your Facebook data<br />'
  redirect '/'
end

get '/logout' do
  clear_session
  redirect '/'
end

def clear_session
  session['fb_auth'] = nil
  session['fb_token'] = nil
  session['fb_error'] = nil
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T21:39:12.857

你的 config.ru 应该是：

```
 require './astute'

  run Sinatra::Application 
```

# excel - 获取 VBA 中连续单元格的值

> ID：11089444
> 
> 赞同：0
> 
> 时间：2012-06-18T19:09:49.343
> 
> 标签：excel, vba, foreach

我有这段代码，我在其中从 Excel 工作表中获取值并根据条件显示结果。

在我的第二个`if`声明中，我想检查`ocell.value < sd11`.

在检查完我需要检查接下来的五个连续值是否相等。如果是，则显示结果。

谁能告诉我如何获得接下来五个连续术语的单元格值？我以为我在代码中提到了但它不起作用。

```
 Sub DoStuff()
   Dim oCell As Range
   sd11 = Range("s11")

   For Each oCell In Range("e4:e48")
       If oCell.Value < sd13 Then
            Range("R2").Value = "Rule 1s voilation"
            End If

        If oCell.Value < sd11 And oCell.Value = oCell.Value + 1 And oCell.Value = oCell.Value + 2 And oCell.Value = oCell.Value + 3 And oCell.Value = oCell.Value + 4 Then
           Range("T5").Value = "Rule 4s voilation"
          End If

   Next
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:43:40.920

在这部分代码中：

```
If oCell.Value < sd11 And oCell.Value = oCell.Value + 1 And oCell.Value = oCell.Value + 2 And oCell.Value = oCell.Value + 3 And oCell.Value = oCell.Value + 4 Then
      Range("T5").Value = "Rule 4s voilation"
End If 
```

给定 oCell.Value 为 6 和 sd11 值为 11 ，您实际上是在问

```
If 6 < 11 And 6 = 7 And 6 = 8 And 6 = 9 And 6 = 10 Then
    Range("T5").Value = "Rule 4s voilation"
End If 
```

因为 Range (Cell) 的 Value 属性返回与该单元格关联的值。

由于这种逻辑是无意义的，我认为错误在于您理解如何在 VBA 中使用 Excel 对象的方式，鉴于您是 VBA 的新手，我假设您正在尝试查看值在 oCell 正下方的 5 行中的任何一行都等效于 oCell。这可以通过使用偏移功能引用单元格本身来完成，就像这样。

```
' i used Or because I thought it might be more what you want. Change to AND if you require all 5 cells to be equal to oCell
    If oCell.Value < sd11 Then
        If oCell.Value = oCell.Offset(1).Value Or oCell.Value = oCell.Offset(2).Value Or oCell.Value = oCell.Offset(3).Value or oCell.Value = oCell.Offset(4).Value or oCell.Value = oCell.Offset(5).Value Then
            Range("T5").Value = "Rule 4s voilation"
        End If
    End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:37:11.797

科学地做：

`if WorksheetFunction.AveDev(oCell.Resize(5)) = 0 then`...

# coffeescript - CoffeeScript 中的列表/对象搜索

> ID：11089449
> 
> 赞同：4
> 
> 时间：2012-06-18T19:10:12.527
> 
> 标签：coffeescript, list-comprehension

我试图尽可能有效地使用 CoffeeScript 理解。我想我有基本的映射——将一个列表变成另一个列表——但搜索对我来说似乎仍然很冗长。

假设我有一张商店商品地图：

```
shopMap:
  toyStore: ["games", "puzzles"]
  bookStore: ["novels", "picture books"] 
```

并且，给定一个项目，我想知道它在哪家商店。在 CoffeeScript 中最好的方法是什么？

以下是我在 JavaScript 中可以做的事情：

```
var shop = findShop(item);

function findShop(item) {
   for (shop in shopMap)
      itemList = shopMap[shop]
      for (i = 0, ii = itemList.length; i<ii; i++) {
         if (itemList[i] === item) {
            return shop;
         }
      }
  }
} 
```

我使用了一个函数来让它通过 return 语句快速跳出循环，而不是使用中断，但是这个函数有点丑陋，因为它只被使用一次。

那么是否有更短的 CS 等效项，最好是不需要创建新函数的等效项？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-18T19:36:04.370

你可以试试[这个](http://coffeescript.org/#try%3ashopMap%20%3D%0A%20%20toyStore%3A%20%5b%22games%22%2C%20%22puzzles%22%5d%0A%20%20bookStore%3A%20%5b%22novels%22%2C%20%22picture%20books%22%5d%0A%0AfindShop%20%3D%20%28item%29%20-%3E%0A%20%20for%20shop%2C%20items%20of%20shopMap%0A%20%20%20%20return%20shop%20if%20item%20in%20items%0A%0Aconsole.log%20findShop%20%27novels%27%0Aconsole.log%20findShop%20%27games%27%0Aconsole.log%20findShop%20%27cupcakes%27)：

```
findShop = (item) ->
  for shop, items of shopMap
    return shop if item in items 
```

如果您真的想尝试使用列表推导，这是等效的：

```
findShop = (item) ->
  (shop for shop, items of shopMap when item in items)[0] 
```

但我认为第一个读起来更好（也不需要为结果生成中间数组）。如果您想查找给定商品的[所有商店，这将是 IMO 更好的方法：](http://coffeescript.org/#try%3ashopMap%20%3D%0A%20%20toyStore%3A%20%5b%22games%22%2C%20%22puzzles%22%5d%0A%20%20bookStore%3A%20%5b%22novels%22%2C%20%22picture%20books%22%2C%20%22games%22%5d%0A%0AfindShops%20%3D%20%28item%29%20-%3E%0A%20%20shop%20for%20shop%2C%20items%20of%20shopMap%20when%20item%20in%20items%0A%0Aconsole.log%20findShops%20%27novels%27%0Aconsole.log%20findShops%20%27games%27%0Aconsole.log%20findShops%20%27cupcakes%27)

```
findShops = (item) ->
  shop for shop, items of shopMap when item in items 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T22:31:01.250

如果这是一个常见操作，您最好先创建一个中间数据结构并直接进行查找。

```
shopMap =
  toyStore: ["games", "puzzles"]
  bookStore: ["novels", "picture books"]

categoryMap = {}
for k, v of shopMap
  for category in v
    categoryMap[category] = k

alert(categoryMap['puzzles']) 
```

[演示](http://coffeescript.org/#try%3ashopMap%20=%0A%20%20toyStore%3a%20%5B%22games%22,%20%22puzzles%22%5D%0A%20%20bookStore%3a%20%5B%22novels%22,%20%22picture%20books%22%5D%0A%0AcategoryMap%20=%20%7B%7D%0Afor%20k,%20v%20of%20shopMap%0A%20%20for%20category%20in%20v%0A%20%20%20%20categoryMap%5Bcategory%5D%20=%20k%0A%0Aalert%28categoryMap%5B%27puzzles%27%5D%29)

使用此实现，您只需要预先循环一次结构（如果 shopMap 更改，还可能更新它）。使用您和流行病的答案，每次需要进行这种特定类型的查找时，您都必须循环。如果您经常执行此操作，可能会有所作为。另一方面，如果您的 shopMap 真的很大（如数千个条目），那么我的实现将占用更多内存。

根据您想要使其变得多么健壮，您可能希望将其变成一个类并通过类的接口对其进行任何操作。您需要 addCategory 和 deleteCategory 方法以及 getStoreFromCategory 方法，这基本上就是我们在上面实现的。这种面向对象的方法将隐藏内部数据结构/实现，以便您以后可以更改实现以优化内存或速度。

# jquery - .addClass 动画 css3 菜单

> ID：11089450
> 
> 赞同：1
> 
> 时间：2012-06-18T19:10:21.337
> 
> 标签：jquery, html

我的 css3 动画菜单运行良好。但现在我想给`selected`他增加一些课程。

但我不知道如何用 css3 动画实现。

我试过这个：

```
$('#menu a').click(function(e) {
            e.preventDefault();
            $(this).addClass("selected");
            var h = $(this).attr('href');
            $("#conteudo").fadeOut("slow", function() {
                $(this).html($(h).html()).fadeIn("slow");
            });
        }); 
```

但不工作。我做了这个小提琴：http: [//jsfiddle.net/8L797/](http://jsfiddle.net/8L797/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:34:53.947

我修复了这个`selected`类，我还让点击事件从现有链接中删除了这个类。

小提琴：http: [//jsfiddle.net/iambriansreed/TNzuH/](http://jsfiddle.net/iambriansreed/TNzuH/)

CSS：

```
#menu a.selected span,
#menu a.selected:hover span {
    top: -100%;
}
#menu a.selected em,
#menu a.selected:hover em {
    top: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:23:27.147

你的代码中有一些错误，比如没有关闭你的 jQuery 函数。此外，看起来您的样式适用于 LI 标记，而不是 A 标记，因此您需要将类添加到 LI。查看我[更新的 jsFiddle](http://jsfiddle.net/8L797/1/)，看看你是否可以使用它。

# css - FlexSlider - 导航图像

> ID：11089459
> 
> 赞同：0
> 
> 时间：2012-06-18T19:10:55.973
> 
> 标签：css, image, flexslider

我第一次使用 FlexSlider 无法在我的项目中显示导航图像。flexSlider css 文件中“主题”文件夹的 url 是正确的。将不胜感激一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:56:02.317

这是一个网址问题。它必须在括号中。

# api - TeamCity - 你如何通过 rest api 获得每个项目的最后完成构建的列表？

> ID：11089462
> 
> 赞同：7
> 
> 时间：2012-06-18T19:11:01.510
> 
> 标签：api, rest, teamcity

我正在尝试找出一种从 teamcity 返回所有最后完成的构建的方法。本质上，我正在为 teamcity 创建一个状态页面，并希望显示所有当前失败的构建。到目前为止，我已经尝试了各种 API 调用。我认为以下 API 调用肯定会给我自上次成功构建以来的所有失败，但它似乎不起作用。

> /guestAuth/app/rest/builds/?locator=status:failure,sinceBuild:(status:success)

任何帮助将不胜感激。如果我能得到所有最后完成的构建，我可以只显示失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:38:50.607

那个 REST 调用是正确的。我正在使用 TeamCity 7.1。可能是因为自上次成功构建以来您根本没有任何失败？尝试反转条件：

> /guestAuth/app/rest/builds/?locator=status:success,sinceBuild:(status:failure)

这将返回自上次失败以来成功构建的列表（相反）。如果您使用此查询获得结果，则您的查询不应返回任何结果。换句话说，在这两个查询中：

> /guestAuth/app/rest/builds/?locator=status:failure,sinceBuild:(status:success) /guestAuth/app/rest/builds/?locator=status:success,sinceBuild:(status:failure)

在任何给定时间，假设有已完成的构建，一个应该始终返回零个构建，另一个应该始终返回一个或多个构建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-09T10:58:21.643

根据对此[JetBrains 票证](https://youtrack.jetbrains.com/issue/TW-22717#comment=27-681190)的评论，从 TeamCity 8.1 开始，可以使用此 API 调用来获取项目下所有构建配置的最新构建状态：

```
http://teamcity.jetbrains.com/app/rest/buildTypes?locator=affectedProject:(id:TeamCityPluginsByJetBrains)&fields=buildType(id,name,builds($locator(running:false,canceled:false,count:1),build(number,status,statusText))) 
```

# vb.net - Page_Load 控件触发两次，尝试了已知的分辨率

> ID：11089463
> 
> 赞同：0
> 
> 时间：2012-06-18T19:11:10.193
> 
> 标签：vb.net

我正在将 1.1 Web 应用程序升级到 4.0，并且遇到了自定义用户控件的 page_load 触发两次的问题，两者都被视为非回发（IsPostBack 在这种情况下为假）。我已经阅读过，似乎有 2 个罪魁祸首，1 是 img 标签，在 src 部分中没有任何内容（此页面上根本没有图像）或 2 AutoEventWireup 和 Handles 正在使用的问题同时。我查看了所有代码，其中根本没有 Handles 关键字，并且 AutoEventWireUp 在每个页面上都设置为 true，但我仍然遇到这个问题。这是一些来源

```
Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs)
    If Not IsPostBack Then
    End If
End Sub 
```

和宣言

```
<%@ Control Language="vb" CodeBehind="UCHeader.ascx.vb" Inherits="PO.Web.UCHeader"
AutoEventWireup="true" TargetSchema="http://schemas.microsoft.com/intellisense/ie5" %> 
```

如果需要，我可以显示更多来源。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:40:10.770

我建议设置 AutoEventWireup = false。阅读[本文](http://support.microsoft.com/kb/814745)，因为 aspx 框架根据方法名称/签名调用方法，并且 autoeventwireup 正在生成代码以绑定它们被调用两次的事件。至少这是 .net/visual studio 早期版本中的行为，我没有发现任何说明 Visual Studio 2010 中是否存在这种情况的信息。

# java - 图片保存在android上的sdcard上

> ID：11089476
> 
> 赞同：-1
> 
> 时间：2012-06-18T19:11:52.283
> 
> 标签：java, android

从我的应用程序将图片保存到 sdcard 时出现问题。当我拍照并将其保存在 sdcard 上并转到我的应用程序并拍摄一个新的并将其保存在 sdcard 上时，会出现以前的预览图片，当在我的计算机上查看它时它似乎已损坏？

为什么会出现这个问题？

```
public static void save(Bitmap bm, String path) {
    OutputStream outStream = null;

    try {
        outStream = new FileOutputStream(new File(path));
        bm.compress(Bitmap.CompressFormat.JPEG, 100, outStream);
        outStream.flush();
        outStream.close();

        bm.recycle();
        System.gc();

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}
}

enter code here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:32:01.860

使用此方法存储图像并显示它。用于存储图像

```
 //create new directory to store image    
             File photo = new File(Environment.getExternalStorageDirectory()+"/Android/data/"+getApplicationContext().getPackageName()+"/files/Receipt"); 
             boolean success = false;
             if(!photo.exists())
             { 
                 success = photo.mkdirs(); 
             }
               //if exists save the image in specified path
             if(!success)
             {
                 dbimgguid = UUID.randomUUID();
                 imagename =dbimgguid.toString();
                 Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                 photo = new File(Environment.getExternalStorageDirectory()+"/Android/data/"+getApplicationContext().getPackageName()+"/files/Receipt", imagename+".png");
                 intent.putExtra(MediaStore.EXTRA_OUTPUT,Uri.fromFile(photo));
                 imageurl = Uri.fromFile(photo); 
                 startActivityForResult(intent, CAMERA_RECEIPTREQUEST); 
             } 
```

查看图像

```
 @Override
 protected void onActivityResult(int requestCode, int resultCode, Intent data) {  

     super.onActivityResult(requestCode, resultCode, data);  
     switch(requestCode)
     {
     case CAMERA_RECEIPTREQUEST:  
         if(resultCode== Activity.RESULT_OK)
         {
         //Toast.makeText(this, "Receipt Image Saved", Toast.LENGTH_SHORT).show();
         BitmapFactory.Options options = new BitmapFactory.Options();
         options.inSampleSize = 8;
         ImageView jpgView = (ImageView)findViewById(R.id.imageView1);
         Bitmap receipt = BitmapFactory.decodeFile(photo.toString(),options); 
         jpgView.setImageBitmap(receipt);                 

         } 
         break;
  } 
```

我希望这能帮到您.. }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:21:35.953

您是否有权存储到 SD 卡？我相信您需要保存并保存到 sd 权限。

# python - 如何在金字塔中使用通用的 ini 配置（在开发和生产之间）？

> ID：11089479
> 
> 赞同：11
> 
> 时间：2012-06-18T19:11:59.480
> 
> 标签：python, configuration, pyramid

我希望有一个通用配置，其设置不会在不同的环境（开发和生产）中改变。我知道我可以设置一个全局 settings.py 文件（例如，sql 限制），但据我所知，金字塔需要在启动时在 ini 文件中找到某些设置（例如，模板目录路径）。

我可以，如果可以，我将如何在金字塔中做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-19T03:13:08.273

在不超出 PasteDeploy 的 INI 范围的情况下，有几个可能的选项。但是，首先要意识到 INI 文件模型的美妙之处在于它具有创建具有不同设置/配置的多个文件的基本能力。是的，您必须使它们保持同步，但它们只是设置（没有逻辑），因此不应该是不可克服的。

无论如何，PasteDeploy支持由部分继承[的默认](http://pythonpaste.org/deploy/#global-configuration)`[app:XXX]`部分。所以你可以在那里放置通用设置，并有不同的`[app:myapp-dev]`和`[app:myapp-prod]`部分。

```
# settings.ini

[DEFAULT]
foo = bar

[app:myapp-dev]
use = egg:myapp

[app:myapp-prod]
use = egg:myapp

set foo = baz 
```

这可以通过

```
env/bin/pserve -n myapp-dev settings.ini 
```

另一种选择是使用多个配置文件。

```
# myapp.ini

[app:myapp-section]
use = egg:myapp

foo = bar

# myapp-dev.ini

[app:main]
use = config:myapp.ini#myapp-section

foo = baz

# myapp-prod.ini

[app:main]
use = config:myapp.ini#myapp-section 
```

这可以通过

```
env/bin/pserve myapp-prod.ini 
```

如果您不想使用 PasteDeploy（ini 文件），您可以在 Python 中做一些事情，但这种配置简单有真正的好处。

# wpf - 格式化一个没有代码的字符串

> ID：11089483
> 
> 赞同：0
> 
> 时间：2012-06-18T19:12:26.737
> 
> 标签：wpf, xaml

我需要重新格式化包含日期的字符串而不使用后面的代码。该字符串的格式为 YY/MM/DD，但必须为 MM/DD/YYYY。我已经看到在给定 Date 对象的情况下这样做了，但是我受到限制，因为它是一个字符串。

到目前为止，我似乎需要代码来执行此操作，但目前我们的供应商不支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:37:29.173

您可以使用 Binding 上的 StringFormat 属性来格式化绑定数据。如果 XAML 中有字符串，则可以将其作为静态源绑定到 TextBlock 的 Text 属性，并通过 StringFormat 重新格式化。有关详细信息，请参阅此[帖子](http://elegantcode.com/2009/04/07/wpf-stringformat-in-xaml-with-the-stringformat-attribute/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T20:18:55.507

由于询问了有关仅 XAML 的字符串格式的问题，因此您将`StringFormat`在 XAML 中指定以下内容：

简单的：

```
StringFormat=d 
```

速记：（注意转义大括号）

```
StringFormat='\{0:d\}' 
```

自定义：（添加文本）

```
StringFormat='The date is \{0:d\}' 
```

`TextBox`使用 a的整体`StringFormat`：

```
<TextBox Text="{Binding myProperty, StringFormat='The date is \{0:d\}'}" 
```

语法与 String.Format 相同；然而：

*   您只能使用一个参数
*   你必须用反斜杠转义花括号
*   如果要指定的不仅仅是格式字符串，则必须将整个表达式放在单引号中

话虽如此，您要做的不仅仅是格式化日期，而是尝试将字符串解析为 a `DateTime`，然后将其格式化`DateTime`为字符串。在这两个步骤中，只有后者可以在 XAML 中完成。这是悲伤的时刻，但毕竟，XAML 是用于标记，而不是计算。

从好的方面来说，如果您能够在项目中引用另一个程序集，则可以实现 an `IValueConverter`，这将使您能够将输入字符串转换为 a `DateTime`，然后 XAML 中的 StringFormat 将起作用。或者，您`IValueConverter`可以只以指定格式导出日期。

# groovy - 如何从 Groovy OptionAccessor 获取所有选项？

> ID：11089486
> 
> 赞同：1
> 
> 时间：2012-06-18T19:12:32.570
> 
> 标签：groovy

我有以下内容：

```
final cli = new CliBuilder(...)
cli.with {...}

final arguments = cli.parse(args)
println arguments.properties 
```

但无论如何，输出是：

```
false 
```

如何获得所有设置的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:45:18.593

```
cli.options.getOptions()
    .findAll {
        arguments[it.key]
    }
    .each {
        println "${it.key}: ${arguments[it.key]}"
    } 
```

# c# - 具有自己依赖项的 Autofac 模块

> ID：11089487
> 
> 赞同：8
> 
> 时间：2012-06-18T19:12:37.283
> 
> 标签：c#, autofac

鉴于某些模块本身具有依赖性，我正在努力解决如何在模块中组织我的 Autofac 组件注册。

我在接口中实现了配置数据的抽象（*即*web.config）：

```
interface IConfigurationProvider
{
    T GetSection<T>(string sectionName)
        where T : System.Configuration.ConfigurationSection;
} 
```

以及 ASP.NET ( `WebConfigurationProvider`) 和“桌面”应用程序 ( `ExeConfigurationProvider`) 的实现。

然后我的一些 autofac 模块需要 a`IConfigurationProvider`作为构造函数参数，但有些不需要：

```
class DependentModule : Module
{
    public DependentModule(IConfigurationProvider config)
    {
        _config = config;
    }

    protected override void Load(ContainerBuilder builder)
    {
        var configSection = _config.GetSection<CustomConfigSection>("customSection");
        builder.RegisterType(configSection.TypeFromConfig);
    }

    private readonly IConfigurationProvider _config;
}

class IndependentModule : Module
{
    protected override void Load(ContainerBuilder builder)
    {
        builder.Register(/* other stuff not based on configuration */);
    }
} 
```

由于`RegisterType()`扩展方法不接受注册委托（`Func<IComponentContext, T>`），就像这样`Register()`做一样，我不能预先注册`IConfigurationProvider`然后在我去注册配置中指定的类型时解决它，例如：

```
// this would be nice...
builder.RegisterType(c => c.Resolve<IConfigurationProvider>().GetSection<CustomConfigSection>("sectionName").TypeFromConfig); 
```

这意味着我需要能够注册**具有和不**依赖于`IConfigurationProvider`.

很明显如何手动实例化每个模块并注册它：

```
IConfigurationProvider configProvider = ...;
var builder = new ContainerBuilder();
builder.RegisterModule(new DependentModule(configProvider));
builder.RegisterModule(new IndependentModule());
using (var container = builder.Build())
{
    ...
} 
```

但我不想手动实例化我的模块 - 我想扫描程序集以查找模块并自动注册它们（如[本问题中](https://stackoverflow.com/questions/10018831/autofac-module-scanning-for-various-applications)所述）。所以我必须使用反射来扫描程序集的`IModule`类型，并使用它`Activator.CreateInstance`来制作可注册的实例。但是我怎么知道是否将 an`IConfigurationProvider`作为构造函数参数传递。当其他模块有额外的或不同的依赖时会发生什么？

必须有一种更直接的方法来完成基本任务：注册在通过接口提供的某些配置中指定的类型，对吗？那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T02:07:55.493

你可以这样做：

```
using System.Collections.Generic;
using System.Linq;
using Autofac;
using Autofac.Core;
using NUnit.Framework;

namespace Yo_dawg
{
    [TestFixture]
    public class I_heard_you_like_containers
    {
        [Test]
        public void So_we_built_a_container_to_build_your_container()
        {
            var modules = GetModules();
            Assert.That(modules.Length, Is.EqualTo(4));

            var builder = new ContainerBuilder();

            foreach (var module in modules)
                builder.RegisterModule(module);

            var container = builder.Build();
        }

        private IModule[] GetModules()
        {
            var builder = new ContainerBuilder();

            var configurationProvider = new ConfigurationProvider();
            builder.RegisterInstance(configurationProvider).AsImplementedInterfaces().ExternallyOwned();

            builder.RegisterAssemblyTypes(GetType().Assembly)
                .Where(t => t.IsAssignableTo<IModule>())
                .AsImplementedInterfaces();

            using (var container = builder.Build())
                return container.Resolve<IEnumerable<IModule>>().ToArray();
        }
    }

    public class ModuleA : Module
    {
        public ModuleA(IConfigurationProvider config)
        {
        }
    }

    public class ModuleB : Module
    {
        public ModuleB(IConfigurationProvider config)
        {
        }
    }

    public class ModuleC : Module
    {
    }

    public class ModuleD : Module
    {
    }

    public interface IConfigurationProvider
    {
    }

    public class ConfigurationProvider : IConfigurationProvider
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T21:15:24.577

对于这种情况，Autofac 自己的 XML 配置似乎涵盖了您所针对的情况。添加新`IConfigurationProvider`机制似乎是对容器已经提供的这种功能的重新发明。基础知识记录在：[https](https://code.google.com/p/autofac/wiki/XmlConfiguration) ://code.google.com/p/autofac/wiki/XmlConfiguration 。配置语法具有对模块的内置支持。

Paul Stovell 提供了一个不错的替代方案，它允许在代码中注册模块但从配置中接收参数 - 请参阅： http: [//www.paulstovell.com/convention-configuration](http://www.paulstovell.com/convention-configuration)。希望这可以帮助！

# html - 使用 Cordova 为手机游戏自动调整屏幕大小（跨不同设备）

> ID：11089493
> 
> 赞同：1
> 
> 时间：2012-06-18T19:12:59.543
> 
> 标签：html, mobile, cordova

是否有使用 Cordova API 的快速简便的功能，其中游戏的屏幕尺寸会根据检测到的设备和检测到的屏幕尺寸自动调整大小？

否则，我必须建立自己的设备库，我们可以支持的设备、我们可以支持的操作系统等。这也会限制我们可以支持的设备和市场的数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-09T14:31:05.037

只有一个：[https](https://github.com/biodiv/cordova-screengod) ://github.com/biodiv/cordova-screengod 您为 FULLHD 设备 (1080x19xx) 开发，并将`screengod`您的设计适应所有屏幕，在所有设备上使用

```
screengod(['path/to/fullhd.css'],function(){
    /* do your stuff */
}); 
```

设备就绪后。

# facebook - 使用锚点问题的带有 data-href 的 Facebook 评论框

> ID：11089512
> 
> 赞同：5
> 
> 时间：2012-06-18T19:14:26.247
> 
> 标签：facebook, facebook-social-plugins, facebook-comments

目前我在一个页面上有 3 个评论框。该页面有三个选项卡，显示不同的内容，每个选项卡内容都有自己的评论部分，与其他两个不同。

为了确保为每个选项卡加载独特的评论，我目前正在使用类似于：

```
<div class="fb-comments" data-href="http://webpage.com/index.html#tab1" 
     data-num-posts="2" data-width="470"></div>
<div class="fb-comments" data-href="http://webpage.com/index.html#tab2" ...
<div class="fb-comments" data-href="http://webpage.com/index.html#tab3" ... 
```

这适用于显示相关内容。但是，当有人回复其中一条评论时，原始评论者会在其 fb 个人资料上收到一个链接，该链接显示为：

> [http://webpage.com/index.html?fb_comment_id=fbc_26547577547547_477747457_3745757457435737#4574575475](http://webpage.com/index.html?fb_comment_id=fbc_26547577547547_477747457_3745757457435737#4574575475)

**问题是**给用户的这个链接没有显示相关的评论线程，甚至没有显示基于锚的 data-href 评论框。也许末端锚绊倒了显示器？如果是这样，是否有在一个页面上有不同的 facebook 评论框的范例？

感谢您帮助解决这个烦人的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T23:23:31.860

我使用这段代码实现了类似的东西

```
<div class="fb-comments" data-href="http://stabmail.com/study-groups-tutoring/#comm-enl" data-width="880" data-num-posts="20"></div>

<div class="fb-comments" data-href="http://stabmail.com/study-groups-tutoring/#comm-esl" data-width="880" data-num-posts="20"></div>

<div class="fb-comments" data-href="http://stabmail.com/study-groups-tutoring/#psyc" data-width="880" data-num-posts="20"></div> 
```

也许您的问题可以通过简单地删除“index.html”来解决，因为 Facebook 会将“#tab”视为页面，而不是指向页面不同部分的链接

在这里可以看到我的解决方案[http://stabmail.com/study-groups-tutoring/](http://stabmail.com/study-groups-tutoring/)

# c# - onchange 事件 - IE 错误

> ID：11089514
> 
> 赞同：0
> 
> 时间：2012-06-18T19:14:38.977
> 
> 标签：c#, javascript

在我后面的代码中，我有 -

```
tbWhatIfBeginDate.Attributes.Add("onchange", "checkDates(" + tbWhatIfBeginDate.ClientID + ", " + tbWhatIfEndDate.ClientID + ")");
tbWhatIfEndDate.Attributes.Add("onchange", "checkDates(" + tbWhatIfBeginDate.ClientID + ", " + tbWhatIfEndDate.ClientID + ")"); 
```

这是我的javascript函数-

```
function checkDates(BeginDateId, EndDateId) {
    if (BeginDateId.value > EndDateId.value) {
        var beginDt = new Date(BeginDateId.value);
        var endDt = new Date(EndDateId.value);

        var newDt = new Date(endDt.getTime() - (24 * 60 * 60 * 1000));

        var y = newDt.getFullYear(),
        m = newDt.getMonth() + 1, // january is month 0 in javascript     
        d = newDt.getDate();

        BeginDateId.value = [pad(m), pad(d), y].join("/");
    }
} 
```

当我通过 Visual Studio 2010 运行时，它可以工作。

当我部署到我的测试服务器时，我收到一条错误消息。“预期对象 - 行：176，字符：1”

第 176 行是 - 输入名称="ctl00$cpMain$tbWhatIfBeginDate" type="text" value="8/1/2012" id="ctl00_cpMain_tbWhatIfBeginDate" onchange="checkDates (ctl00_cpMain_tbWhatIfBeginDate, ctl00_cpMain_tbWhatIfEndDate)" style="width:70px; "

我没有看到错误。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:21:45.743

您将 HTML 元素的 id 传递给函数，它们是字符串，但您传递它时不带引号，就好像它是一个已定义的变量一样。在`onClick`范围内，还没有`ctl00_cpMain_tbWhatIfBeginDate`定义这样的变量，所以你得到了一个 javascript 错误。这是意料之中的——你还没有声明这样的变量。

在您的函数中，您立即尝试将这些参数视为对象，但同样，您传入了`undefined`因为具有指定名称的变量不存在。他们也不应该！当您尝试通过 id 引用 DOM 节点时，您必须使用`getElementById`from the `document`object 来“获取”相关对象。那么，ID 只是字符串。

因此，您应该传递那些用引号括起来的字符串。为此，您需要修改添加事件的两行：

```
tbWhatIfBeginDate.Attributes.Add("onchange", "checkDates('" + tbWhatIfBeginDate.ClientID + "', '" + tbWhatIfEndDate.ClientID + "')");
tbWhatIfEndDate.Attributes.Add("onchange", "checkDates('" + tbWhatIfBeginDate.ClientID + "', '" + tbWhatIfEndDate.ClientID + "')"); 
```

这样，字符串 id 就会传递给您的函数。然后，需要修改您的函数以根据传递的 id 获取 DOM 对象：

```
function checkDates(BeginDateId, EndDateId) {
    beginDate = document.getElementById(BeginDateId);
    endDate = document.getElementById(EndDateId);
    if (!beginDate || !endDate)
        return; // <--- add an error message here?
    if (beginDate.value > endDate.value) {
        var beginDt = new Date(beginDate.value);
        var endDt = new Date(endDate.value);
        // existing logic here
    }
} 
```

**文档**

*   `document.getElementById`- [https://developer.mozilla.org/en/DOM/document.getElementById](https://developer.mozilla.org/en/DOM/document.getElementById)
*   javascript 函数 - [http://www.quirksmode.org/js/function.html](http://www.quirksmode.org/js/function.html)
*   javascript 变量 - [http://www.tizag.com/javascriptT/javascriptvariables.php](http://www.tizag.com/javascriptT/javascriptvariables.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:17:21.973

你是在 Cassini 服务器和 2003 机器之间来回切换吗？MS 将控件命名更改为 IIS 7 / VS 的最新版本。我会检查您的控件的实际变量名称在呈现的 HTML 中是什么。

# python - Google App Engine - 在模板 HTML 中打印 GQL ID 字段

> ID：11089516
> 
> 赞同：1
> 
> 时间：2012-06-18T19:14:44.547
> 
> 标签：python, google-app-engine, templates, gql

我正在使用 App Engine 生成与我的 GQL 表对应的 HTML 表。每个 HTML 行将包含多个数据和 GQL 行 ID。HTML 中的此 ID 允许我稍后删除该项目。

首先，我将数组提供给模板：

```
 userSearch = UserSearch.all()
 us = userSearch.fetch(1000)
 template_values = { 'userSearch' : us }
 path = os.path.join(os.path.dirname(__file__), 'template/index.html')
 self.response.out.write(template.render(path, template_values)) 
```

在模板中，我在 HTML 中打印 ID：

```
{% for us in userSearch %}
    <tr>
        <td><a href="/delete?id={{ us.ID }}">delete</a></td>
        <td>...</td>
    </tr>
{% endfor %} 
```

但是在 HTML 中，ID 是空的，所以我不能删除我的项目：

```
class DeleteItem(webapp.RequestHandler):
    def get(self):
        id = int(self.request.get('id'))
        item = UserSearch.get_by_id(id)
        if item != None:
            db.delete(item) 
```

我不知道出了什么问题？我什至不知道这是否是继续的方法...获取要删除的元素...谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:22:57.647

假设 1) 您指的是内置`id()`和 2) 您正在使用 Django 模板，您的模板语法应该如下所示：

```
{% for us in userSearch %}
    <tr>
        <td><a href="/delete?id={{ us.key.id }}">delete</a></td>
        <td>...</td>
    </tr>
{% endfor %} 
```

如果您使用 Jinja2 模板，则语法会略有不同：

```
{% for us in userSearch %}
    <tr>
        <td><a href="/delete?id={{ us.key().id() }}">delete</a></td>
        <td>...</td>
    </tr>
{% endfor %} 
```

# python - Python：如何从变量中获取信息

> ID：11089518
> 
> 赞同：2
> 
> 时间：2012-06-18T19:14:51.547
> 
> 标签：python, reflection, python-internals

好的，这可能是一个困难的问题。而且我不希望你为我做所有的辛苦工作。我只是想得到一些好的建议和我应该开始的地方。

我正在编写几个 python 程序，但调试这些程序时遇到了麻烦。所以我想创建一个简单的调试函数来记录一些事情。

这就是我使用它的方式：

```
# Defined in random_function_definitios.py
def some_random_function():
  a = 1 + 1
  debug(a)
  # More stuff 
```

我想在调试中显示此信息：

*   调用它的函数：some_random_function
*   定义该函数的文件名：random_function_definitios.py
*   行号：4
*   一些上下文：定义的全局变量和定义的局部变量。

我一直在看检查模块和框架内置对象。但我不完全确定我是否在正确的方向。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:23:03.113

您可以使用 Python 的标准日志记录工具。大量数据带有日志记录 - 文档中提供了它们的完整列表：http: [//docs.python.org/library/logging.html#logrecord-attributes](http://docs.python.org/library/logging.html#logrecord-attributes)。您需要的是`funcName`, `filename`, `lineno`。要记录局部变量的转储，您可以转换为内置函数的字符串输出`locals()`并将其用作日志消息。您需要做的就是使用一个像这样的记录器：

```
import logging

logger = logging.getLogger('some_module')

def some_random_function():
    a = 1 + 1
    logger.debug(str(locals())) 
```

并使用前面提到的格式属性将其配置为正确的格式。所有这些都在基本日志记录教程中有详细记录：http: [//docs.python.org/howto/logging.html#logging-basic-tutorial](http://docs.python.org/howto/logging.html#logging-basic-tutorial)

**编辑**

但如果我是你，我会在调试的上下文中启动 python 调试器，以交互方式检查你想要检查的所有内容：

```
def some_random_function():
    a = 1 + 1
    import pdb; pdb.set_trace() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:26:32.827

我用信息/警告和调试消息编写了自己的 debugger.py。

见：[https ://github.com/unixunion/toolbox/blob/master/python/debugger.py](https://github.com/unixunion/toolbox/blob/master/python/debugger.py)

我还使用回溯来遍历堆栈，例如：

```
except Exception, e:
    # capture the traceback data
    exc_type, exc_value, exc_traceback = sys.exc_info()
    warningMsg("-14 %s" % str(e))
    warningMsg("Exec Traceback")
    traceback.print_tb(exc_traceback, limit=1, file=sys.stdout)
    warningMsg("Exception")
    traceback.print_exception(exc_type, exc_value, exc_traceback, limit=2, file=sys.stdout)
    raise 
```

给出如下结果：

```
WARNING fabfile.py:76 glassfish_deploy()-14 cannot concatenate 'str' and 'float' objects
WARNING fabfile.py:77 glassfish_deploy()Exec Traceback
File "/home/marzubus/go-agent-scripts/fabfile.py", line 52, in glassfish_deploy    oiled =     gfOil(**kwargs)
WARNING fabfile.py:79 glassfish_deploy()Exception
Traceback (most recent call last):  File "/home/marzubus/go-agent-scripts/fabfile.py",    line 52, in glassfish_deploy
oiled = gfOil(**kwargs)
File "/home/marzubus/go-agent-scripts/oilon/gfdeployer.py", line 37, in __init__
self.tmpDirectory = '/tmp/' + self.domainName + self.time
TypeError: cannot concatenate 'str' and 'float' objects 
```

基根

# java - 类层次结构中的 Java 可选接口

> ID：11089521
> 
> 赞同：3
> 
> 时间：2012-06-18T19:15:01.180
> 
> 标签：java, inheritance, interface, styles

假设您有大约 30 个类的 Java 类层次结构，其中有一个基类 BaseClass 和两个主要子类（SubclassA、SubclassB），每个子类有几个子类。其中一些子类具有特定的行为。假设你可以“戳”它们，改变它们的状态。（这是向现有层次结构添加行为的新要求。“Poke”对大多数类来说毫无意义。）

```
interface Pokeable {
  void poke();
  int getTimesPoked();
}

public class Pokey extends SubclassB 
implements Pokeable {
  private int timesPoked = 0;
  public void poke() {
    timesPoked++;
  }
  public int getTimesPoked() {
    return timesPoked;
  }
} 
```

这是否应该通过仅在那些需要它的类中实现 Pokeable 来完成，然后在所有必须戳任何可戳对象的代码中执行以下操作？

```
public void process(BaseClass b) {
  if (b instanceof Pokeable) {
    ((Pokeable)b).poke();
  }
} 
```

或者整个层次结构是否应该为了少数真正 Pokeable 的人而实现 Pokeable？

```
interface Pokeable {
  void poke();
  int getTimesPoked();
  boolean isReallyPokeable();
}

public class BaseClass implements Pokeable {
  public void poke() {}
  public int getTimesPoked() { return 0; }
  public boolean isReallyPokeable() { return false;}
}

public class Pokey {
  private int timesPoked = 0;
  @Override
  public void poke() {
    timesPoked++;
  }
  @Override
  public int getTimesPoked() {
    return timesPoked;
  }
  @Override
  public boolean isReallyPokeable() {
    return true;
  }
}

public void process(BaseClass b) {
  b.poke();
} 
```

编辑补充说：这是一种双重调度问题。在“扑克”代码对对象执行某些操作的情况下，如果对象是“可戳的”，则它必须调用“poke()”，否则就不能。是否“poke()”取决于某物是否想要戳以及对象是否接受被戳。我可以使用访客模式，但这似乎使它更复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:21:57.470

如果一个类是不可破解的，我建议不要使用它来实现`Pokeable`接口，因为这会让人困惑。

请改用以下方法之一。

*   创建`BaseClass`该 implements的抽象或具体子类`Pokable`，并让您所有的`Pokeable`子类扩展它。`poke()`如果ing 通过所有实现类中的相同逻辑实现，则此方法效果很好。
*   让每个子类`Pokeable`单独实现

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:21:48.557

我认为拥有一个名为“isReallyX”的方法是一个警告信号。如果有人一眼看到一个类并发现它是“可戳的”，他们可能会尝试戳它并最终出现意想不到的行为，因为它并不是*真正*可戳的。

我会采用您以前的方法，因为它不会误导外部程序员（或忽略此代码两个月后的您自己！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:16:20.443

如果您不想实现父类的所有方法，您的子类可能是抽象的。但....

> 或者整个层次结构是否应该为了少数真正 Pokeable 的人而实现 Pokeable？

绝对不行......不可戳的类不应该实现可戳接口。

> 这是否应该通过仅在那些需要它的类中实现 Pokeable 来完成，然后在所有必须戳任何可戳对象的代码中执行以下操作？

这是一个稍微好一点的模型......但是，它是一个非常程序化的设计。

还可以将对象的集合保留在`<Pokeable>`某处，然后快速迭代该集合以将它们全部戳穿吗？

你能让 pokeable 类注册到事件调度器吗？...所以当某个事件发生时，所有的类都被戳了？

# java - 在andengine中重置计时器

> ID：11089524
> 
> 赞同：-2
> 
> 时间：2012-06-18T19:15:26.477
> 
> 标签：java, android, andengine

我有这个类，用于在游戏期间设置间隔。

```
public class Timer implements IUpdateHandler {
    // ===========================================================
    // Constants          
    // ===========================================================

    // ===========================================================          
    // Fields        
    // ===========================================================
    private ITimerCallback mCallback;
    private float mInterval;

    private float mSecondsElapsed;
    // ===========================================================          
    // Constructors          
    // ===========================================================
    public Timer(final float pInterval, final ITimerCallback pCallback) {
            this.mInterval = pInterval;
            this.mCallback = pCallback;
    }
    // ===========================================================          
    // Getter & Setter          
    // ===========================================================
    public void setInterval(final float pInterval) {
            this.mInterval = pInterval;
    }
    // ===========================================================          
    // Methods for/from SuperClass/Interfaces          
    // ===========================================================  
    @Override
    public void onUpdate(float pSecondsElapsed) {
            this.mSecondsElapsed += pSecondsElapsed;
            if(this.mSecondsElapsed >= this.mInterval) {
                    this.mSecondsElapsed -= this.mInterval;
                    this.mCallback.onTick();
            }
    }
    @Override
    public void reset() {
            this.mSecondsElapsed = 0;

    }
    // ===========================================================          
    // Methods          
    // ===========================================================  

    // ===========================================================          
    // Inner and Anonymous Classes          
    // ===========================================================
    public interface ITimerCallback {
            public void onTick();
    }
} 
```

问题是我需要找到一种方法来暂停它，或者在需要时完全重置时间。

我怎么能这样做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:40:09.853

该类有一个用于此目的的 reset() 方法。如果你想暂停它，你可能想在类中添加一个私有布尔值并创建一个 pause() 方法来调用 - 在 pause 方法中设置你的暂停布尔值。然后修改 onUpdate() 方法并添加一个`if (!paused) { //do rest of onUpdate here }`

您可能还需要一个 unPause() 方法 - 或者当您传入您想要的状态时只创建一个方法，例如`setPause(boolean state) {}`

# windows - Windows git/ssh/cygwin: git: '/oneplant.git' 不是 git 命令

> ID：11089525
> 
> 赞同：0
> 
> 时间：2012-06-18T19:15:26.887
> 
> 标签：windows, git, ssh, amazon-ec2, cygwin

因此，我一直致力于让 Windows 2008 EC2 实例启动并运行，同时将 git 作为远程存储库将我的项目实时推送到服务器。以下是我遵循的步骤：

1.  创建 Windows EC2
2.  安装 git & cygwin (带 openssh)
3.  添加所需的端口，防火墙例外。

此时，我可以远程通过 SSH 连接到我的服务器，初始化 repo 就可以了。我现在正在使用[这篇博文](http://toroid.org/ams/git-website-howto)来设置我的远程存储库。遵循以下步骤：

本地：

1.  `git clone`来自另一个来源的项目
2.  `git remote add production ssh://[USER]@[SERVER]/oneplant.git`

远程：

1.  创建接收后挂钩并使用 +x 对其进行 chmod：

    ```
    #!/bin/sh
    GIT_WORK_TREE=C:/inetpub/wwwroot git checkout -f 
    ```

最后，我`git push production +master:refs/heads/master`在本地调用并登录，它使用以下命令返回：

```
 git: '/oneplant.git' is not a git command. See 'git --help'
    fatal: The remote end hung up unexpectedly 
```

我一直在尝试在网上搜索此内容，但我不确定我做错了什么，希望有人能引导我朝着正确的方向前进。

# javascript - createObjectURL 有限制吗？

> ID：11089528
> 
> 赞同：3
> 
> 时间：2012-06-18T19:15:49.337
> 
> 标签：javascript, html, websocket

我通过 websocket 接收大量图片，只需将我从“createObjectURL”获取的 url 保存在一个数组中，以便以后使用这些图片。有谁知道，我以这种方式创建的 URL 数量是否有限制？还是限制取决于我可以在数组中保存多少个 URL？

# python - 聚合 QuerySet 以获取 FileFields 大小的总和

> ID：11089533
> 
> 赞同：2
> 
> 时间：2012-06-18T19:16:28.430
> 
> 标签：python, django, mongodb, gridfs

我使用 django-nonrel，Postgre 作为数据库，Mongo 作为文件存储。

我的模型看起来像这样并且工作正常

```
class Doc(models.Model):
    created_on = models.DateTimeField(auto_now_add=True)
    file = models.FileField(storage=gridfs_storage, upload_to='/') 
```

并且工作正常

```
Doc.objects.all()[0].file.size
108776 
```

现在我正在尝试聚合大小以获得查询集的总大小。

我试过了

```
Doc.objects.all().aggregate(Sum('file__size')) 
```

但是这个扔

```
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/Users/zoidberg/dev/backus/lib/python2.6/site-packages/django/db/models/query.py", line 321, in aggregate
    is_summary=True)
  File "/Users/zoidberg/dev/backus/lib/python2.6/site-packages/django/db/models/sql/query.py", line 974, in add_aggregate
    field_list, opts, self.get_initial_alias(), False)
  File "/Users/zoidberg/dev/backus/lib/python2.6/site-packages/django/db/models/sql/query.py", line 1417, in setup_joins
    raise FieldError("Join on field %r not permitted. Did you misspell %r for the lookup type?" % (name, names[pos + 1]))
FieldError: Join on field 'file' not permitted. Did you misspell 'size' for the lookup type?
    enter code here 
```

知道是否可以使用 ORM 或者我必须自己迭代文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:30:07.450

使用 ORM 是不可能做到这一点的，因为它只能针对数据库字段生成聚合，而`file.size`它是存储后端提供的动态属性。

也就是说，您最好在上传时将此信息保存在您的实际数据库中，这样您就可以避免遍历所有文件的开销。

```
class Doc(models.Model):
    created_on = models.DateTimeField(auto_now_add=True)
    file = models.FileField(storage=gridfs_storage, upload_to='/')
    file_size = models.PositiveIntegerField()

    def save(self, *args, **kwargs):
        self.file_size = self.file.size
        super(Doc, self).save(*args, **kwargs) 
```

现在聚合按预期工作，因为您正在处理数据库字段：

```
Doc.objects.all().aggregate(Sum('file_size')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T20:40:36.300

一个 hcalves 指出使用直接 ORM 是不可能的。我假设您的数据库已经完成并设置，那么您为什么不能这样做呢？

```
total_size = sum([ x.file.size for x in Doc.objects.all() ]) 
```

只是一个想法？

# qt - JPEG 图像在 Ubuntu 上的 QTWebkit 中显示

> ID：11089535
> 
> 赞同：1
> 
> 时间：2012-06-18T19:16:30.953
> 
> 标签：qt, webkit, jpeg, qtwebkit

我们有一个基于 qt webkit 的网络浏览器应用程序。它在 windows 和 mac 上运行良好。但是当我们在 Linux 下编译时，我们无法让它在任何网站的 webview 中显示任何 JPEG 图像。我做了一些谷歌搜索，并相信它可能与 QT 的 jpeg 插件有关。

但是即使我们将图像编解码器复制到 $exepath/plugins/imageformats/ 然后在 $exepath 下创建具有以下内容的 qt.conf 文件，我也无法显示 jpeg 图像：

[路径] 插件 = 插件

在 Windows 和 Mac 上，我们无需为显示 jpeg 图像的调试版本做任何事情。我们只需复制插件 dll 和 qt.conf 文件即可重新分发发布版本。

我们尝试了 qt 4.7.4 和 qt 4.8.1

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T22:08:04.590

如果您在 Ubuntu 之类的桌面 linux 上运行，请尝试安装系统 jpeg 库。我认为您编译的 Qt 库可以与系统 jpeg 一起使用。

```
sudo apt-get install libjpeg62 
```

# java - JodaTime 从一天的开始获取当前毫秒数

> ID：11089538
> 
> 赞同：6
> 
> 时间：2012-06-18T19:16:41.893
> 
> 标签：java, jodatime

我正在尝试从那天开始获取当前的毫秒数。所以我想做以下计算。`86400000-currMilliSecondsFromBeginningOfDay`. 任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-18T19:30:43.333

```
long result = new DateTime().millisOfDay().getMillis(); 
```

或者

```
long result = new DateTime().getMillis() - new DateTime().withMillisOfDay(0).getMillis(); 
```

或者

```
long result = new LocalTime().get(DateTimeFieldType.millisOfDay()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-21T14:53:17.170

您可以使用来自 jodatime 库的 DateMidnight 获取一天的[开始](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateMidnight.html)。

```
long todayStart = new DateMidnight().getMillis(); 
```

而[DateTime 构造函数](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#DateTime())会将其 millis 字段设置为当前值。

# html - 文本区域高度：100%

> ID：11089540
> 
> 赞同：71
> 
> 时间：2012-06-18T19:16:47.590
> 
> 标签：html, css

这是我的小提琴：http: [//jsfiddle.net/e6kCH/15/](http://jsfiddle.net/e6kCH/15/)

听起来可能很愚蠢，但我找不到使文本区域高度等于 100% 的方法。它适用于宽度，但不适用于高度。

我希望文本区域根据窗口大小调整大小......就像它在我的小提琴中一样适用于宽度......

有任何想法吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-06-18T19:21:19.880

**元素的高度是相对于其父元素的。**因此，如果您想将元素扩展到视口的整个高度，则需要将 CSS 应用到`html`以及`body`（父元素）：

```
html, body {
    height: 100%;
}

#textbox {
    width: 100%;
    height: 100%;
} 
```

**CSS3 的替代解决方案**：如果您可以使用 CSS3，您可以使用[视口百分比单位](http://dev.w3.org/csswg/css-values/#viewport-relative-lengths)并将您的文本框直接缩放到视口的 100% 高度（和 100% 宽度）[（此处为 jsfiddle）](http://jsfiddle.net/A22SF/)

```
body {
    margin: 0;
}
#textbox {
    width: 100vw;
    height: 100vh;
} 
```

# algorithm - 如何存储顺序呈现的未知大小集合的样本？

> ID：11089542
> 
> 赞同：4
> 
> 时间：2012-06-18T19:16:59.320
> 
> 标签：algorithm, math, random, sampling

假设我想存储 N 个样本（每个样本占用了很大一部分内存），这应该形成一个由总共 M>>N 个样本按顺序呈现给我的代表性集合。我事先不知道M，只能同时在内存中保存N个样本。

在这里，代表性意味着 M 个样本中的每个样本都应该具有相同的存储概率。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:35:36.217

这个问题被称为[储层采样](http://en.wikipedia.org/wiki/Reservoir_sampling)，并且有一个非常有效的 O(M) 时间、O(N) 空间算法。该算法的工作原理如下：在每个点上，保持“猜测”您要选择哪些 N 个元素。最初，选择前 N 个元素。然后，在看到序列的第 k 个元素后，在 1 和 k 之间选择一个随机数，包括 1 和 k。如果选择的数字在 1..N 范围内，则将索引的“猜测”项替换为当前项；否则什么也不做。您可以使用快速归纳论证表明这将随机均匀地对 N 个元素进行采样，并且一次遍历数据。

希望这可以帮助！

# html - 如何在不影响内容的情况下向站点添加多个图层？

> ID：11089543
> 
> 赞同：0
> 
> 时间：2012-06-18T19:17:03.283
> 
> 标签：html, css

在不影响任何现有内容的情况下，借助 z-index 向站点添加多个图层的最佳方法是什么？一层是绝对定位，第二层是相对的，第三层是固定的，依此类推。

我不知道，如果我又犯了一个错误，但我已经尝试了不止一次，它适用于两层或三层。随着更多（例如 10 层），它开始影响某些元素的位置，所以我调整它们的位置，但我认为这只是一个视觉解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:35:01.520

以与其他图层相同的方式放置图层，因此，是的，您可以在不影响定位的情况下创建更多图层。每一层的内容应该是相同的大小，以免推*高*或推*宽*。顺便说一句，将它们全部定位为**绝对值**，您就可以开始了。在这里查看多个层：http: [//jsfiddle.net/BcAWC/](http://jsfiddle.net/BcAWC/)

示例代码：

CSS：

```
div { width: 300px; height: 300px; text-align: center; border: 1px solid black;  position: absolute; }
div#layer1 { background-color: red; }
div#layer2 { background-color: green; }
div#layer3 { background-color: blue; }
div#layer4 { background-color: red; }
div#layer5 { background-color: green; }
div#layer6 { background-color: blue; }
div#layer7 { background-color: red; }
div#layer8 { background-color: green; }
div#layer9 { background-color: blue; }
div#layer10 { background-color: red; }

p { color: white; font-size: 50px; margin-top: 120px; }
.movetotop { z-index: 10; } 
```

HTML：

```
<div id="layer1" class="">
    <p>Layer 1</p>
</div>
<div id="layer2" class="">
    <p>Layer 2</p>
</div>
<div id="layer3" class="">
    <p>Layer 3</p>
</div>
<div id="layer4" class="">
    <p>Layer 4</p>
</div>
<div id="layer5" class="">
    <p>Layer 5</p>
</div>
<div id="layer6" class="">
    <p>Layer 6</p>
</div>
<div id="layer7" class="">
    <p>Layer 7</p>
</div>
<div id="layer8" class="movetotop">
    <p>Layer 8</p>
</div>
<div id="layer9" class="">
    <p>Layer 9</p>
</div>
<div id="layer10" class="">
    <p>Layer 10</p>
</div> 
```

​--

在每一层上移动类“ **movetotop** ”，以查看层在另一层之上的移动。

# socket.io - 停止 socket.io 重新连接

> ID：11089545
> 
> 赞同：17
> 
> 时间：2012-06-18T19:17:10.647
> 
> 标签：socket.io

简单场景：

1.  `socket = io.connect(...)`客户端使用 socket.io ( )连接到服务器
2.  服务器崩溃
3.  客户端尝试重新连接
4.  用户告诉客户端断开连接 ( `socket.disconnect()`)
5.  服务器启动
6.  客户端重新连接

似乎一旦 socket.io 开始尝试重新连接，它就不能再停止了。我想要第 4 步来防止第 6 步发生，但事实并非如此。我必须打电话给什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-29T18:19:01.543

您可能想自己处理重新连接。

```
// Disables the automatic reconnection
var socket = io.connect('http://server.com', {
    reconnection: false
});

// Reconnects on disconnection
socket.on('disconnect', function(){
    socket.connect(callback);
}); 
```

注意：使用旧版本`reconnect`而不是`reconnection`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:11:38.870

我认为您需要[配置](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO) `socket.io` `client`的不是`reconnect`将属性设置`reconnect`为`false`

我创建了一个小服务器（`server.js`）来测试这个：

```
var io = require('socket.io').listen(8888);

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

然后我创建了这个`test.js`来测试它不会重新连接

```
var client = require('socket.io-client'),
    socket = client.connect('http://localhost:8888', {
        'reconnect': false
    });

socket.on('connect', function () {
    socket.on('news', function (data) {
        console.log(data);
        socket.emit('my other event', { my: 'data' });
    });
}); 
```

为了`test.js`工作，您需要`socket.io-client`从`npm`发布`npm install socket.io-client`或添加`socket.io-client`(dev-)`dependency`到您的`package.json`.

当我在运行时停止`server.js`时会立即返回，我相信这是您想要的结果。当我设置为客户端时，将尝试重新连接到服务器，这不是所需的行为`test.js``test.js``reconnect``true`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-07T21:30:30.650

在新的 socket.io 1.1.x 中，您可以执行以下操作：

```
var manager = io.Manager('http://localhost:9823', { autoConnect: false }); 
```

这是[博客链接](http://socket.io/blog/socket-io-1-1-0/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-12T04:46:13.847

试试下面的代码：

```
self.socket?.manager?.reconnects = false 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-17T10:42:22.830

不过，这对我来说效果很好，它会在完全停止之前再尝试一次。

socket.io-client": "2.2.0"

`this.socket.io.reconnectionAttempts(0);`

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2019-04-19T07:44:21.430

你可以打电话`socket.disconnect()`，然后它会停止尝试重新连接。

# sql - 使用 SQL Server 2005 发送电子邮件：是否使用光标？

> ID：11089548
> 
> 赞同：1
> 
> 时间：2012-06-18T19:17:22.487
> 
> 标签：sql, sql-server

我不确定何时适合使用游标。

在运行某个更新某些表的存储过程后，我需要发送电子邮件。因此，如果

```
table1.field1 = "value" and 
   (select count(*) 
      from table1 join table2 
        on table2.table1_id = table1.id) > 20 
```

然后需要为 table1 中满足这些条件的所有内容发送一封电子邮件。在电子邮件中我需要包含 table1.field2 和 table2.field3 等等......

我能想到的唯一方法是获取 table1 中满足这些条件的行数据集，然后使用游标遍历它。我以前从未使用过从 SQL Server 发送电子邮件，而且我不知道我的选择……我以前从未使用过游标（尽管我确实了解如何使用），因为我学会了避开它们。

谢谢。

**编辑：**
使用while循环：所以......我可能想将我需要的所有信息推入一个临时表（从table1中选择*（条件）），然后启动一个遍历结果数据每一行的while循环设置在我的临时表中。(WHILE i = 1 to (select count(*) from #temp) / assemble e-mail send e-mail / next)...那么参考/指向我应该是#temp的哪一行的最佳方法是什么用于每个循环迭代？我可以给#temp 一个身份（1,1）或使用row_number（）......对吗？我猜？不过，似乎我只是想通过这样做来编写自己的光标？假设我们设置@subject = (select 'Site ' & field2 & ' has a value of ' & field1 from #temp where temp_id_or_row_number = @i) 然后为每个循环增加@i ...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:30:22.210

我使用了与[这篇文章](http://www.sqlservercentral.com/blogs/robert_davis/2010/06/15/Building-HTML-Emails-With-SQL-Server-and-XML/)类似的东西， 我用来构建直接 html，然后在使用 .html 的 html 格式邮件中使用它`sp_send_dbmail`。这些存储过程可能会变得混乱

我从未使用过游标 - 有几个存储过程，其中有 WHILE 循环发送多封电子邮件

```
WHILE (condition)
   begin
   end 
```

这是一个完整的例子；希望能帮助到你：

```
/*
drop table #the_table
drop table #Emails
*/
create table #the_table 
( [Email] varchar(50),
  [Date] datetime,
  [Amount] decimal(12, 2))

insert into #the_table
values
( 'example@googlemail.co.uk', '2012-1-1', 10),
( 'example@googlemail.co.uk', '2012-1-3', 10),
( 'foo@bar.co.uk', '2012-1-3', 20),
( 'foo@bar.co.uk', '2012-1-5', 10)

  --get a list of email addresses
SELECT   
    Email
    , ROW_NUMBER() OVER(ORDER BY [Email]) AS [Counter] 
INTO    #Emails
FROM    #the_table
GROUP BY Email

DECLARE @html VARCHAR(8000)
DECLARE @Recipient VARCHAR(100)

DECLARE @row INT = 1

WHILE @row <= (SELECT COUNT(*) FROM #Emails)
BEGIN
    SET @Recipient= (SELECT [Email] FROM #Emails WHERE [Counter] = @row)

      --start building the html string
    SELECT @html = '<html><p>Hello World.</p>'
    SELECT @html = @html + '<p><table border="1"><tr><th>Date</th><th>Amount</th></tr>' 

    SELECT
        @html = 
            @html + 
            ('<tr><td>' + CONVERT(VARCHAR(6), [Date])                           
            + '</td><td>$' + LEFT(CONVERT(VARCHAR(20), CONVERT(MONEY,Amount),1), LEN(CONVERT(VARCHAR(20), CONVERT(MONEY,Amount),1))-3) + '</td></tr>')
    FROM    #the_table
    WHERE   [Email] = @Recipient
    SELECT @html = @html + '</table></p>'   

      --finish building the html string 
    SELECT @html = @html + '<p></p></html>'

    DECLARE @mySubject VARCHAR(100)
    SET @mySubject = 'TESTING 1-2-3'

    EXEC msdb..sp_send_dbmail
        @recipients = @Recipient  
        , @subject = @mySubject
        , @body_format = 'html'
        , @body = @html 

    SET @Row = @Row +1

END 
```

# jquery - chrome中colorbox和iframe的奇怪行为

> ID：11089551
> 
> 赞同：0
> 
> 时间：2012-06-18T19:17:31.397
> 
> 标签：jquery, colorbox

基本上发生的事情是我有一个视频列表，您单击一个视频，它从数据库中获取嵌入 url 并将该 url 加载到颜色框中...发生的事情是当您关闭颜色框时它会淡出然后闪烁回来打开一瞬间然后关闭。它仅在 chrome 中执行，在 safari 和 FF 中进行了测试。它也只使用嵌入视频，无论我使用 html: 还是 iframe 和 href 它仍然可以......

这是我的代码...

```
$.post('/keep-it-safe/get-video/'+$vidid, function(data) {  
$.colorbox({iframe: true, href:data, width:"50%", height:"50%"});
}); 
```

除了这两个之外，Chrome 检查器不会抛出任何错误......

资源解释为文档，但使用 MIME 类型 application/x-shockwave-flash: "http://www.youtube.com/v/jvNgktxURM4" 传输。jquery.min.js:3

不安全的 JavaScript 尝试从 URL [http://www.youtube.com/v/jvNgktxURM4的框架访问具有 URL](http://www.youtube.com/v/jvNgktxURM4) [http://myurl.org/keep-it-safe/videos/](http://myurl.org/keep-it-safe/videos/)的框架。域、协议和端口必须匹配。

//更新===============================

似乎这个问题与将视频嵌入彩盒直接相关。如果我用静态站点切换它，它不会闪烁，也不会出现上面列出的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T02:41:17.883

> 然后重新闪烁一秒钟并关闭

除了确保 Chrome 和 Flash 是最新的外，我对此没有任何建议。

直接 iframe 制作 youtube 视频时，不安全的 javascript 警告是不可避免的，但它不应该造成任何伤害。如果您使用 YouTube 的 iframe API，我相信它不会发生：http: [//apiblog.youtube.com/2011/01/introducing-javascript-player-api-for.html](http://apiblog.youtube.com/2011/01/introducing-javascript-player-api-for.html)

# facebook-graph-api - FQL 获取未授权我的应用的朋友

> ID：11089558
> 
> 赞同：2
> 
> 时间：2012-06-18T19:17:53.527
> 
> 标签：facebook-graph-api, facebook-fql

如何获取尚未授权我的申请的好友列表？我想向他们发送邀请。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:36:32.317

我想我得到了答案。这是查询：

SELECT uid, name, pic_square FROM user WHERE is_app_user=0 AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())

# post - 是否可以在 Selenium 中捕获 POST 数据？

> ID：11089560
> 
> 赞同：3
> 
> 时间：2012-06-18T19:18:09.087
> 
> 标签：post, selenium

我正在使用[Selenium](http://seleniumhq.com) WebDriver Tool，我想知道这个工具是否提供了一种捕获提交表单时生成的 POST 数据的方法。我正在使用 django 测试框架来测试我的数据是否在后端被正确处理，我想使用 Selenium 来验证表单是否产生了预期的数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T19:46:54.443

您将不得不在中间放置一个代理并监控该代理。您可以使用[http://pypi.python.org/pypi/browsermob-proxy](http://pypi.python.org/pypi/browsermob-proxy)。这允许您将代理详细信息传递给 WebDriver，然后您可以提取一个显示所有网络流量的 HAR 文件。

你也可以使用[HARPy](https://github.com/adamgoucher/HARPy)来获取你想要的信息

BrowserMob 代理和 Selenium 的示例

```
 from browsermobproxy import Server

            server = Server("path/to/browsermob-proxy")
            server.start()
            proxy = server.create_proxy()

            from selenium import webdriver
            profile  = webdriver.FirefoxProfile()
            profile.set_proxy(proxy.selenium_proxy())
            driver = webdriver.Firefox(firefox_profile=profile)

            proxy.new_har("google")
            driver.get("http://www.google.co.uk")
            proxy.har # returns a HAR JSON blob

            proxy.stop()
            driver.quit() 
```

# qt - glClear(GL_COLOR_BUFFER_BIT) 后的 OpenGL 无效帧缓冲操作；

> ID：11089561
> 
> 赞同：9
> 
> 时间：2012-06-18T19:18:14.783
> 
> 标签：qt, opengl, error-handling, osx-lion, framebuffer

每次调用后`glClear(GL_COLOR_BUFFER_BIT);`，我都会收到 OpenGL 错误“帧缓冲区操作无效”。

这个电话似乎工作得很好，似乎没有任何问题。我在方法中调用`glClear(GL_COLOR_BUFFER_BIT);`了第一件事`::paintGL()`。

嗯？我应该忽略这个错误吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T15:20:32.927

我最好的猜测是您的帧缓冲区不完整，调用`glClear`不完整的帧缓冲区会引发错误。

使用检查帧缓冲区的状态`glCheckFramebufferStatus`并确保它返回`GL_FRAMEBUFFER_COMPLETE`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-15T13:56:43.937

我在 osx 上使用 NSOpenGLView 和 CVDisplayLink 来触发渲染回调时遇到了这个问题。

确保在开始渲染之前等待 NSOpenGLView**完全显示**，即：

```
-(void)viewDidAppear {
    [super viewDidAppear];

    CVDisplayLinkStart(_displayLink);
} 
```

在 viewDidLoad 中这样做还为时过早。

# java - Java 中 PKCS#5 PBKDF1 的算法名称是什么？

> ID：11089566
> 
> 赞同：2
> 
> 时间：2012-06-18T19:19:06.107
> 
> 标签：java, c++, security

我在使用密码学方面有几个问题。我正在使用 AES。

***问题一：***

我正在尝试使用`SecretKeyFactory`. 我正在尝试获取与 PBKDF1 PKCS#5 相关的实例。我是密码学的新手。我在网上试过，但我找不到任何这样的算法。是否支持。我想要这样的东西。

```
SecretKeyFactory factory = SecretKeyFactory.getInstance("PBKDF1Pkcs#5");
KeySpec spec = new PBEKeySpec(password, salt, 1, 128); 
```

***问题2：***

以上两行代码是否与 Crypto++ 代码中的以下代码行做同样的事情？

```
PKCS5_PBKDF1 <MD5> fn;
fn.DeriveKey(key, MD5::DIGESTSIZE, 0, key.getBytes(), salt.getBytes(), salt.size(), PBKDF1_ITERATIONS, time_in_seconds); 
```

如果没有，有人可以给出一些可以模仿上述c ++代码行的东西。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T20:01:51.950

**回复：问题 1**

根据[SecretKeyFactory 的 Java 6 API 文档](http://docs.oracle.com/javase/6/docs/api/javax/crypto/SecretKeyFactory.html)，

> 应用程序开发人员应参考其提供者的文档，以了解 generateSecret 和 getKeySpec 方法支持哪些密钥规范。例如，“SunJCE”提供者提供的 DES 密钥工厂支持 DESKeySpec 作为 DES 密钥的透明表示，并且该提供者的三重 DES 密钥的密钥工厂支持 DESedeKeySpec 作为三重 DES 密钥的透明表示。

如果我们查看PKCS的[SunJCE 提供程序文档，我们会看到...](http://docs.oracle.com/javase/1.5.0/docs/guide/security/jce/JCERefGuide.html)

> PBEWithMD5AndDES：基于密码的加密算法，定义在：RSA 实验室，“PKCS #5：基于密码的加密标准”，1.5 版，1993 年 11 月。请注意，该算法暗示 CBC 作为密码模式，PKCS5Padding 作为填充方案，并且不能与任何其他密码模式或填充方案一起使用。

**回复：问题 2**

在同一文档中，在**使用基于密码的加密**部分中，您将找到以下示例代码。请记住，示例代码使用静态盐，但安全实现将使用在用户每次更改密码时生成随机盐。

```
PBEKeySpec pbeKeySpec;
PBEParameterSpec pbeParamSpec;
SecretKeyFactory keyFac;

// Salt
byte[] salt = {
    (byte)0xc7, (byte)0x73, (byte)0x21, (byte)0x8c,
    (byte)0x7e, (byte)0xc8, (byte)0xee, (byte)0x99
};

// Iteration count
int count = 20;

// Create PBE parameter set
pbeParamSpec = new PBEParameterSpec(salt, count);

// Prompt user for encryption password.
// Collect user password as char array (using the
// "readPasswd" method from above), and convert
// it into a SecretKey object, using a PBE key
// factory.
System.out.print("Enter encryption password:  ");
System.out.flush();
pbeKeySpec = new PBEKeySpec(readPasswd(System.in));
keyFac = SecretKeyFactory.getInstance("PBEWithMD5AndDES");
SecretKey pbeKey = keyFac.generateSecret(pbeKeySpec);

// Create PBE Cipher
Cipher pbeCipher = Cipher.getInstance("PBEWithMD5AndDES");

// Initialize PBE Cipher with key and parameters
pbeCipher.init(Cipher.ENCRYPT_MODE, pbeKey, pbeParamSpec);

// Our cleartext
byte[] cleartext = "This is another example".getBytes();

// Encrypt the cleartext
byte[] ciphertext = pbeCipher.doFinal(cleartext); 
```

**其他算法**

同样，来自同一页面。真的，我建议你通读整本书，因为它可能也会回答你的其他问题

> PBEWith<digest>And<encryption> 或 PBEWith<prf>And<encryption>：用于 PKCS #5 基于密码的加密的密钥工厂，其中 <digest> 是消息摘要，<prf> 是伪随机函数，<encryption>是一种加密算法。示例：PBEWithMD5AndDES (PKCS #5, v 1.5) 和 PBEWithHmacSHA1AndDESede (PKCS #5, v 2.0)。注意：它们都只使用每个密码字符的低 8 位。

# actionscript-3 - 如何在borderContainer中包含AS的孩子

> ID：11089570
> 
> 赞同：0
> 
> 时间：2012-06-18T19:19:20.313
> 
> 标签：actionscript-3, apache-flex, flex4

以前（Flex 3.5），我使用过 HBox 并包含 TextInput 框。在 Flex 4.x 中，必须使用 BorderContainers；但是当我使用 addElement 或 addChild 函数时，孩子们不会出现。如何在 Flex 4.x 中使用 AS 完成任务？

```
//Flex 3.5
var twpBox:HBox = new HBox();
twpBox.id = "twp";
var ti1:TextInput = new TextInput();
ti1.id = "section";
var ti2:TextInput = new TextInput();
ti2.id = "township";
twpBox.addChild(ti1);
twpBox.addChild(ti2);

//Flex 4.x
var bcTest:BorderContainer = new BorderContainer();
var cmdOK:Button = new Button();
bcTest.addElement(cmdOK); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:22:28.540

HGroup 可能更适合作为 HBox 的替代品。还可以尝试设置按钮的标签并检查它在调试器中的位置以实际查看它的位置。您还必须将borderContainer 或组添加到舞台。

```
var bcTest:BorderContainer = new BorderContainer();
var cmdOK:Button = new Button();
bcTest.addElement(cmdOK);
this.addElement(bcTest); 
```

# c# - SQL Management Studio 2008 的编程扩展

> ID：11089574
> 
> 赞同：1
> 
> 时间：2012-06-18T19:19:39.803
> 
> 标签：c#, .net, sql-server, visual-studio-2010, sql-server-2008-r2

是否可以在 Visual Studio 2010 中为 SQL Management Studio 创建扩展？Visual Studio 具有用于为 Visual Studio 进行扩展的项目类型。

Visual Studio 中是否存在用于制作的模板？如果我想学习如何制作一个，我应该从哪里开始？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:23:00.980

是的。[这是一篇帮助您入门的文章](http://blogs.microsoft.co.il/blogs/shair/archive/2008/07/28/how-to-create-sql-server-management-studio-addin.aspx)。注意：[我猜 2008 R2 有一些陷阱](https://www.sqlskills.com/blogs/jonathan/sql-server-2012-extended-events-add-in-to-manage-2008r2-instances/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:23:11.003

您可以为 SSMS 创建加载项。虽然我认为你必须针对 VS2008。SQL Server 2012 Managament Studio 基于 VS2010 SP1。作为起点，请查看[http://ssmsaddins.codeplex.com/](http://ssmsaddins.codeplex.com/)

# php - 显示数组的输出

> ID：11089578
> 
> 赞同：0
> 
> 时间：2012-06-18T19:20:15.687
> 
> 标签：php, mysql

我使用插件将数据输入数据库。现在我正在显示数据并编写代码以进行搜索/排序。我的问题是我不熟悉放入数据库中单个字段的数组。我什至不确定这种格式的数据的正确“名称”。因此，如果有人可以指导我查看教程或文档，我将不胜感激。这是包含在数据库的一个字段中的代码示例。

```
a:4:{i:0;s:32:"Green";i:1;s:26:"Red";i:2;s:31:"Blue";i:3;s:33:"Yellow";} 
```

最终，我需要通过`<br/>`分隔数组中的每个元素来显示这些数据。我还需要更好地理解它，以便可以搜索以这种方式显示的字段。我也很想了解它，因为我相信它相当普遍，我应该理解它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:22:52.560

此数据已被[序列化](http://php.net/manual/en/function.serialize.php)，因此请调用

```
$array = unserialize($data);
print_r($array); 
```

另一种流行的编码是 JSON，您也应该研究一下。

让你知道发生了什么

*   "a:4" 表示后面是一个包含 4 个元素的数组
*   "i:0" 表示这是数组中的第 0 个索引
*   "s:32" 表示接下来是一个字符串
*   “绿色”是那个字符串
*   其余的只是遵循这种模式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:23:34.513

那个数据已经[`serialized`](http://php.net/serialize)。[`unserialize`](http://php.net/unserialize)它来取回数组。

# magento - mangeto admin 当前配置范围

> ID：11089579
> 
> 赞同：1
> 
> 时间：2012-06-18T19:20:25.163
> 
> 标签：magento

我正面临当前配置范围的这个问题：在系统 => 配置中。Mangeto 的单一安装用于多商店前端。用户是单一的店面，只能使用 AITOC 的高级权限访问他们的数据。当用户在配置部分时，他必须取消选中复选框，然后他可以使用输入来输入他的数据。我想从每个字段中删除此取消选中，以便用户轻松使用，但我无法找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T17:08:40.883

您可以查看 DOM (html) 中的复选框是否有模式，并添加一点 javascript 以自动清除它们（或清除它们并隐藏它们）。

我们正在升级到 1.7.0.0，这些复选框遍布商店配置（不使用 AITOC 扩展，所以我认为扩展无关）。我们必须取消选中它们才能更改任何设置；烦人之外。

# jquery - 处理来自 JSONP 的回调

> ID：11089583
> 
> 赞同：2
> 
> 时间：2012-06-18T19:20:39.647
> 
> 标签：jquery, ajax, wcf, web-services

我正在尝试处理 JSONP 回调，我有以下 JavaScript

```
var URL = "http://localhost:8000/returndata?s=testjsonp";
function alertResponse(data, status) {
    alert("data: " + data + ", status: " + status);
}

$.ajax({
    url: URL,
    dataType: 'jsonp',
    jsonpCallback: "alertResponse",
    complete: alertResponse
}); 
```

当对服务器做出响应时，它会返回以下 JSON：注意双引号。

```
"alertResponse({'status':'OK'})" 
```

我不确定如何用我的 javascript 处理这个问题。

有人可以在这里帮助我。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:22:45.030

## 问题

它返回被视为字符串并使用 JSON 编码的 JSONP 响应。

换句话说，**来自服务器的答案是不正确的**。

## 解决方案

代替：

```
"alertResponse({'status':'OK'})" 
```

它应该是：

```
alertResponse({'status':'OK'}) 
```

## “为什么？” 部分

**JSONP 的要点**是使用`<script>`标记包含它，因此返回的响应**必须是正确的 JavaScript**，调用一些回调函数（通常由调用远程服务器期间的 GET 参数之一指定），该函数应该**处理检索到的数据**。

# android - getLastKnownLocation() 使用 GPS_PROVIDER 返回 null

> ID：11089586
> 
> 赞同：0
> 
> 时间：2012-06-18T19:20:47.997
> 
> 标签：android, gps

我正在制作一个小测试程序来掌握 Android GPS 的窍门，看看电池对学校项目的影响。我只是想让我的设备通过打印出最后检测到的已知位置的纬度来检测我的位置。但该位置始终在 onResume() 回调中返回 null。

任何帮助是极大的赞赏。

```
TextView Updates;
long start = -1;
long battStart = -1;
long stop = -1;
PowerManager.WakeLock wl;
LocationManager locationManager; 
LocationListener locationListener;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Updates = (TextView) findViewById(R.id.textView);
    Updates.append("\n onCreate()");

    batteryLevel();
    start = System.currentTimeMillis(); 

    locationManager = (LocationManager)getSystemService(LOCATION_SERVICE);
    locationListener = new LocationListener() {
        public void onLocationChanged(Location location) {
          // Called when a new location is found by the network location provider.
          Updates.append("\n Found a place! "+location.getLatitude()+","+location.getLongitude());
        }
        public void onStatusChanged(String provider, int status, Bundle extras) {}
        public void onProviderEnabled(String provider) {
            Updates.append("yes"+provider);
        }
        public void onProviderDisabled(String provider) {
            Updates.append("No"+provider);
        }
    }; 
}

protected void onStart() {
    super.onStart();
    Updates.append("\n onStart()");

    // Set up a wake lock 
    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    this.wl = pm.newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK, "My Tag2");
    this.wl.acquire();

    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener);
}

protected void onResume() {
    super.onResume();
    batteryLevel();
    Location loc = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    if (loc != null) {
        Updates.append(String.valueOf(loc.getLatitude()));
    } else {
        Updates.append("loc is null");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:34:36.227

我想到了！

原来，我只好出去了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:24:11.790

如果 GPS 被禁用，它将始终返回 null。[有关LocationManager.getLastKnownLocation](http://developer.android.com/reference/android/location/LocationManager.html#getLastKnownLocation%28java.lang.String%29)的信息，请参阅 Android 文档

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:26:13.820

在这种情况下，您应该使用 LocationListener。因为它可能会发生，您可能无法从 getLastKnownLocation() 获取位置。

只需调用 requestLocationUpdates 您将在 LocationListener 中获得回调

# python - Django: Is Base64 of md5 hash of email address under 30 characters?

> ID：11089590
> 
> 赞同：4
> 
> 时间：2012-06-18T19:21:13.093
> 
> 标签：python, django

I am investigating since a few hours the best way to use the Email address instead of username in Django authentication. This topic has been discussed many times but the given results are inconsistent.

1) The answer [here](https://stackoverflow.com/questions/778382/accepting-email-address-as-username-in-django) points to a [snippet](http://www.davidcramer.net/code/224/logging-in-with-email-addresses-in-django.html) that distinguishes the username and email simply by having an '@'char in it. The max length of email and username is not equal though and not considered in the answer.

2) The second answer - from the same [link](https://stackoverflow.com/questions/778382/accepting-email-address-as-username-in-django) - from S.Lott (13 votes) is doing some black magic with admin.site. It doesn't make sense to me what the code is doing, is this the accepted way of doing it short and sweet?

3) Then I found [this solution](http://www.xairon.net/2011/05/django-email-only-authentication/), which seems almost perfect (and makes sense to me):

```
username = uuid.uuid4().hex[:30] 
```

It picks only the first 30 chars of a unique Python generated ID as the username. But there is still a chance of collision. Then I came across a post where someone has claimed

> A base64 encoding of an md5 hash has 25 characters

If thats true, couldn't we take the base64 encoding of an md5 hash of the **email address** and guarantee 100% unique usernames, which are also under 30 character? If this is true, how could this be achieved?

Many Thanks,

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:28:23.843

You can do it like this:

```
>>> from hashlib import md5
>>> h = md5('email@example.com').digest().encode('base64')[:-1]
>>> _
'Vlj/zO5/Dr/aKyJiOLHrbg=='
>>> len(h)
24 
```

You can ignore the last char because it's just a new line. The chance of collision is the same as the MD5 hash, you don't lose information when you encode in base64.

```
>>> original = md5('email@example.com').digest()
>>> encoded = original.encode('base64')
>>> original == encoded.decode('base64') 
True 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:42:26.287

[MD5 hashes](https://en.wikipedia.org/wiki/Md5_Hash) are always 16 bytes long, and [Base64](https://en.wikipedia.org/wiki/Base64) encodes groups of 3 bytes to 4 characters; thus (16 / 3 rounded up) => 6 groups of 3, times 4 = 24 characters for a MD5 hash encoded to Base64.

However, note that the above linked Wikipedia page states:

> However, it has since been shown that MD5 is not collision resistant.

So you cannot count on this method giving you unique usernames from email addresses. Producing them is very easy with the help of the [`hashlib` module](http://docs.python.org/library/hashlib.html):

```
>>> from hashlib import md5
>>> md5('foo@bar.com').digest().encode('base64').strip()
'862kBc6JC2+CBAlN6xLYqA==' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T06:35:30.637

`UUID` is 128bit, thus you could apply base64 on it directly to get a 22-chars long string (by removing fixed padding `'=='`, as Gumbo suggests in comments of the question)

```
>>> import base64
>>> len(base64.urlsafe_b64encode(uuid.uuid4().bytes).rstrip('='))
22 
```

Here, the `urlsafe_b64encode` and the stripping of `'='` are used to avoid chars that `User.username` field does not like, including `'/' '+'` and `'='`

Also, UUID has two bits of fixed `'10'`(hence the 17th char in the hex representation is always `8,9,A,B`) and four bits of versions, check [the wiki](http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29).
Thus you could throw away the 4+2=6bits along w/ 2 effective bits to get a 30-chars long hex string:

```
>>> s = uuid.uuid4().hex
>>> len(s[:12] + s[13:16] + s[17:])
30 
```

In this way you only throw away 2 effective bits instead of 8 when simply slicing s by `s[:30]`, and you could expect better *uniqueness* (1/4 coding space of uuid at most).

# events - 事件处理程序是否应该直接响应事件？

> ID：11089593
> 
> 赞同：0
> 
> 时间：2012-06-18T19:21:29.030
> 
> 标签：events, node.js, socket.io

我有一个 socket.io 服务器监听套接字上的某些事件。每当触发事件时，它会将事件数据传递给事件处理程序。我的问题是，事件处理程序是否应该引用服务器，并像这样直接响应事件？

```
eventHandler.handle = function(event){
myServerReference.emit(event, etc);
} 
```

或者事件处理程序是否应该在有数据要发送时触发一个事件，服务器应该监听它并像这样处理数据发送：

```
eventHandler.onResponse(function(data){ server.emit(data); } 
```

从长远来看，哪种方法更好？有没有更好的方法来设计这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:29:19.073

虽然简短的回答是“视情况而定”，但一个好的 OO 实践是牢记[“SOLID”的“S”](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)：

> 在面向对象编程中，[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)指出每个类都应该有单一职责，并且该职责应该完全由类封装。它的所有服务都应与该责任密切相关。

如果事件处理程序所在的代码单元做的太多（即做别人的工作），你应该把那个功能移到别处。

# c# - 发布集合和 ModelState

> ID：11089596
> 
> 赞同：4
> 
> 时间：2012-06-18T19:21:41.960
> 
> 标签：c#, asp.net-mvc

我的 MVC 应用程序中有一个问题，我不确定如何解决，或者我是否以错误的方式处理它。

我有一个控制器/视图，它在带有复选框的网格中显示项目列表，当项目发布到我的控制器时，我想根据传入的 id 从我的数据库中删除行。

视图看起来像这样：

```
@for(int index = 0; index < Model.Items.Length; index++)
{
    <td>
        @Html.HiddenFor(m => m[index].Id)
        @Html.CheckBoxFor(m => m[index].Delete)
    </td>
} 
```

我的控制器接受以下值：

```
[HttpPost]
public ActionResult Delete(DeleteItemsModel model)
{
    if( !ModelState.IsValid )
    {
        // ...
    }

    foreach( var id in model.Items.Where(i => i.Delete))
        repo.Delete(id);
} 
```

这个场景工作正常。项目正在正确发布，带有 id 和要删除或不删除的标志，并且它们被正确删除。我遇到的问题是我的页面验证失败。我需要再次从数据库中获取项目并将数据发送回视图：

```
if( !ModelState.IsValid )
{
    var order = repo.GetOrder(id);

    // map
    return View(Mapper.Map<Order, OrderModel>(order));
} 
```

在用户获得要删除的项目列表和他们单击提交之间的时间，可能已经添加了新项目。现在，当我提取数据并将其发送回视图时，列表中可能会有新项目。

问题示例：
我在我的页面上执行 HTTP GET，我的网格中有两个项目，ID 为 2 和 1。我选择第一行（ID 2，按最新排序），然后单击提交。页面验证失败，我将视图返回给用户。现在网格中有三行 (3, 2, 1)。MVC 将在第一项上具有复选框（现在 id 为 3）。如果用户不检查这些数据，那么他们可能会删除错误的内容。

关于如何解决这种情况或我应该怎么做的任何想法？有谁知道如何

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T16:13:02.957

有趣的问题。让我们首先用一个简单的例子来说明这个问题，因为从其他答案来看，我不确定每个人都理解这里的问题所在。

假设以下模型：

```
public class MyViewModel
{
    public int Id { get; set; }
    public bool Delete { get; set; }
} 
```

以下控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        // Initially we have 2 items in the database
        var model = new[]
        {
            new MyViewModel { Id = 2 },
            new MyViewModel { Id = 1 }
        };
        return View(model);
    }

    [HttpDelete]
    public ActionResult Index(MyViewModel[] model)
    {
        // simulate a validation error
        ModelState.AddModelError("", "some error occured");

        if (!ModelState.IsValid)
        {
            // We refetch the items from the database except that
            // a new item was added in the beginning by some other user
            // in between
            var newModel = new[]
            {
                new MyViewModel { Id = 3 },
                new MyViewModel { Id = 2 },
                new MyViewModel { Id = 1 }
            };

            return View(newModel);
        }

        // TODO: here we do the actual delete

        return RedirectToAction("Index");
    }
} 
```

和一个观点：

```
@model MyViewModel[]

@Html.ValidationSummary()

@using (Html.BeginForm())
{
    @Html.HttpMethodOverride(HttpVerbs.Delete)
    for (int i = 0; i < Model.Length; i++)
    {
        <div>
            @Html.HiddenFor(m => m[i].Id)
            @Html.CheckBoxFor(m => m[i].Delete)
            @Model[i].Id
        </div>
    }
    <button type="submit">Delete</button>
} 
```

以下是将会发生的事情：

用户导航到该`Index`操作，选择要删除的第一个项目并单击“删除”按钮。这是他提交表单之前的视图：

![在此处输入图像描述](../Images/b79f3539c57222640ad814145222f19e.png)

调用 Delete 操作，当再次呈现视图时（因为存在一些验证错误），用户将看到以下内容：

![在此处输入图像描述](../Images/6508586c2d4bbfc5886c88e3fcd2f616.png)

看看如何预选了错误的项目？

为什么会这样？因为 HTML 助手在绑定时优先使用 ModelState 值而不是模型值，这是设计使然。

那么如何解决这个问题呢？通过阅读 Phil Haack 的以下博客文章：http: [//haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

在他的博客文章中，他谈到了*非序列索引*并给出了以下示例：

```
<form method="post" action="/Home/Create">

    <input type="hidden" name="products.Index" value="cold" />
    <input type="text" name="products[cold].Name" value="Beer" />
    <input type="text" name="products[cold].Price" value="7.32" />

    <input type="hidden" name="products.Index" value="123" />
    <input type="text" name="products[123].Name" value="Chips" />
    <input type="text" name="products[123].Price" value="2.23" />

    <input type="hidden" name="products.Index" value="caliente" />
    <input type="text" name="products[caliente].Name" value="Salsa" />
    <input type="text" name="products[caliente].Price" value="1.23" />

    <input type="submit" />
</form> 
```

看看我们如何不再为输入按钮的名称使用增量索引？

我们如何将其应用到我们的示例中？

像这样：

```
@model MyViewModel[]
@Html.ValidationSummary()
@using (Html.BeginForm())
{
    @Html.HttpMethodOverride(HttpVerbs.Delete)
    for (int i = 0; i < Model.Length; i++)
    {
        <div>
            @Html.Hidden("index", Model[i].Id)
            @Html.Hidden("[" + Model[i].Id + "].Id", Model[i].Id)
            @Html.CheckBox("[" + Model[i].Id + "].Delete", Model[i].Delete)
            @Model[i].Id
        </div>
    }
    <button type="submit">Delete</button>
} 
```

现在问题已解决。或者是吗？您是否看到该视图现在所代表的可怕混乱？我们已经解决了一个问题，但我们在视图中引入了一些绝对可恶的东西。我不了解你，但当我看到这个我想呕吐。

那么可以做些什么呢？我们应该阅读 Steven Sanderson 的博客文章：http: [//blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)其中他提出了一个非常有趣的自定义`Html.BeginCollectionItem`像这样使用的助手：

```
<div class="editorRow">
    <% using(Html.BeginCollectionItem("gifts")) { %>
        Item: <%= Html.TextBoxFor(x => x.Name) %>
        Value: $<%= Html.TextBoxFor(x => x.Price, new { size = 4 }) %>
    <% } %>
</div> 
```

注意表单元素是如何包装在这个助手中的？

这个助手是做什么的？它用 Guids 替换了强类型助手生成的顺序索引，并使用一个额外的隐藏字段在每次迭代时设置此索引。

* * *

话虽如此，仅当您需要在删除操作中从数据库中获取新数据时才会出现问题。如果您依靠模型粘合剂来补充水分，则根本不会有任何问题（除非存在模型错误，您将使用旧数据显示视图->这可能不是那么有问题）：

```
[HttpDelete]
public ActionResult Index(MyViewModel[] model)
{
    // simulate a validation error
    ModelState.AddModelError("", "some error occured");

    if (!ModelState.IsValid)
    {

        return View(model);
    }

    // TODO: here we do the actual delete

    return RedirectToAction("Index");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:32:41.680

这个问题的常见解决方案是使用[Post-Redirect-Get 模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)。

[您可以在此处](http://weblogs.asp.net/rashid/archive/2009/04/01/asp-net-mvc-best-practices-part-1.aspx)找到 MVC 代码示例的解释（以及许多其他好的 MVC 技巧）。向下滚动到列表中的第 13 项以获取 PRG 说明。

# java - Hibernate：通过 id 获取实体

> ID：11089599
> 
> 赞同：45
> 
> 时间：2012-06-18T19:21:48.820
> 
> 标签：java, hibernate

我有用户实体并试图通过 id 从 base 获取它。实体定义如下。

```
package com.hibernate.logic;

import java.io.Serializable;
import java.util.Random;

import javax.persistence.*;

@Entity
@Table(name="users")
public class User implements Serializable {
    private static final long serialVersionUID = 1L;

@Id
@Column(name="user_id")
private Long userId;

@Column(name="middlename")
private String middlename;

@Column(name="name")
private String name;

@Column(name="surname")
private String surname;

@Column(name="pass")
private String pass;

//bi-directional many-to-one association to Role
@ManyToOne
@JoinColumn(name="role_id")
private Role role;

public User() {
    Random random = new Random();
    this.userId = random.nextLong();
    this.name = "";
    this.surname = "";
    this.middlename = "";
}

public Long getUserId() {
    return this.userId;
}

public void setUserId(Long userId) {
    this.userId = userId;
}

public String getMiddlename() {
    return this.middlename;
}

public void setMiddlename(String middlename) {
    this.middlename = middlename;
}

public String getName() {
    return this.name;
}

public void setName(String name) {
    this.name = name;
}

public String getSurname() {
    return this.surname;
}

public void setSurname(String surname) {
    this.surname = surname;
}

public Role getRole() {
    return this.role;
}

public void setRole(Role role) {
    this.role = role;
}

public String getPass() {
    return pass;
}

public void setPass(String pass) {
    this.pass = pass;
}

} 
```

所以 getUserById(Long user_id) 方法没有从数据库中获取信息，它只是调用用户构造函数。为什么会这样？

```
public User getUserById(Long user_id) {
        Session session = null;
        User user = null;
        try {
            session = HibernateUtil.getSessionFactory().openSession();
            user =  session.load(User.class,
                    user_id);
            Hibernate.initialize(user);
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (session != null && session.isOpen()) {
                session.close();
            }
        }
        return user;
    } 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-06-19T14:18:07.677

使用`get`而不是`load`

```
// ...
        try {
            session = HibernateUtil.getSessionFactory().openSession();
            user =  (User) session.get(User.class, user_id);
        } catch (Exception e) {
 // ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T19:28:37.260

在`getUserById`您不应该创建未使用的新对象（user1）。只需将其分配给已经（但为空）的 initialized `user`。否则`Hibernate.initialize(user);`实际上是`Hibernate.initialize(null);`

这是新的`getUserById`（我还没有测试过这个；））：

```
public User getUserById(Long user_id) {
    Session session = null;
    Object user = null;
    try {
        session = HibernateUtil.getSessionFactory().openSession();
        user = (User)session.load(User.class, user_id);
        Hibernate.initialize(user);
    } catch (Exception e) {
       e.printStackTrace();
    } finally {
        if (session != null && session.isOpen()) {
            session.close();
        }
    }
    return user;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-12T11:13:06.180

使用 EntityManager em;

```
public User getUserById(Long id) {
     return em.getReference(User.class, id);
} 
```

# php - 使用 php 显示动态图像

> ID：11089601
> 
> 赞同：0
> 
> 时间：2012-06-18T19:21:53.967
> 
> 标签：php, image

我正在尝试使用 php 根据项目的 id 显示图像。这是针对电子商务商店的，但是我很难弄清楚。这是我拥有的 php：

```
 <?php 
     $product_list = "";
     $sql = mysql_query("SELECT * FROM products ORDER BY date_added DESC");
     $productCount = mysql_num_rows($sql);
     if ($productCount > 0) {
         while($row = mysql_fetch_array($sql)){ 
             $pid = $row['id'];
             $product_name = $row["product_name"];
             $price = $row["price"];
             $date_added = strftime("%b %d, %Y", strtotime($row["date_added"]));
             $product_list .= "HERE IS WHERE THE IMAGE  &nbsp; <strong>$product_name</strong> - $$price - <em>Added $date_added</em> &nbsp; &nbsp; &nbsp; <a href='inventory_edit.php?pid=$id'>edit</a> &bull; <a href='inventory_list.php?deleteid=$id'>delete</a><br />";
         }
     } else {
         $product_list = "You have no products listed in your store yet";
     }
?> 
```

从理论上讲，我试图添加，文本 HERE IS WHERE THE IMAGE 是要使用的：

```
 <img src='../inventory_images/$pid.jpg' /> 
```

然而，我尝试过的这个和其他变体不起作用。图片是怎么上传的，变量“$pid”是商品的id，加上.jpg结尾，下面代码解释一下：

```
 $pid = mysql_insert_id();
    $newname = "$pid.jpg";
    move_uploaded_file( $_FILES['fileField']['tmp_name'], "../inventory_images/$newname"); 
```

因此，理论上只需拥有产品 ID，我就可以使用 $pid 来获取图像......这是行不通的。想法？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:39:09.350

我看到您发现您的图像实际上并不存在，所以我想与您分享。您可以很容易地检查此文件是否存在：

```
if (file_exists ('../inventory_images/' . $pid . '.jpg')) {
  $product_image = '<img src="../inventory_images/' . $pid . '.jpg">';
} else {
  $product_image = '<img src="../inventory_images/image_not_found.jpg">';
} 
```

然后只需在 $product_list 中需要它的地方使用该 $product_image 变量。您还可以修改 else 语句并进行一些错误处理（更新数据库中的字段，向您发送电子邮件等）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T20:14:09.960

看起来您的输出中也有错误，您能否尝试替换该行：

```
$product_list .= "HERE IS WHERE THE IMAGE  &nbsp; <strong>$product_name</strong> - $$price - <em>Added $date_added</em> &nbsp; &nbsp; &nbsp; <a href='inventory_edit.php?pid=$id'>edit</a> &bull; <a href='inventory_list.php?deleteid=$id'>delete</a><br />"; 
```

用那一行：

```
$product_list .= "HERE IS WHERE THE IMAGE  &nbsp; <strong>$product_name</strong> - \$$price - <em>Added $date_added</em> &nbsp; &nbsp; &nbsp; <a href='inventory_edit.php?pid=$pid'>edit</a> &bull; <a href='inventory_list.php?deleteid=$pid'>delete</a><br />"; 
```

# c# - 如何将图像绑定到按钮？

> ID：11089602
> 
> 赞同：1
> 
> 时间：2012-06-18T19:21:55.323
> 
> 标签：c#, wpf, data-binding, binding

图像显示为列表框，但不显示为按钮。有任何想法吗？如何使用 DataTemplate 将图像绑定到按钮？

```
namespace wpftest
{
  /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
    string URL1 = "example.com/test.jpg";

    public MainWindow()
    {
        InitializeComponent();
        MyObj list = new MyObj(URL1);

        List<MyObj> _list = new List<MyObj>()
        {
           new MyObj{ url1 = "example.com/test.jpg"},
           new MyObj{ url1 = "example.com/test.jpg"},
           new MyObj{ url1 = "example.com/test.jpg"}
        };

        button1.DataContext = new MyObj { url1 = "example.com/test.jpg" };
        listBox1.DataContext = new CollectionViewSource { Source = _list };

    }
}
} 
```

///////////////////////////////////////// ///////////////////////////////

```
 <ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:Res="clr-namespace:wpftest.Properties"
                    >

    <DataTemplate x:Key="myTemplate">
        <StackPanel Orientation="Horizontal">
            <Image Height="307" Name="image1" Stretch="None" Width="300" Source="{Binding url1}"/>
            <StackPanel>
                <TextBlock 
                    Text="{x:Static Res:Resources.Title}"/>
                <TextBlock Text="URL"/>
            </StackPanel>
        </StackPanel>
   </DataTemplate>

    <DataTemplate x:Key="customImageTileButton">
        <StackPanel Orientation="Horizontal">
            <Image Height="307" Name="image1" Stretch="None" Width="300" Source="{Binding url1}"/>

            <TextBlock Name="customTitle" Text="Title"/>
        </StackPanel>
    </DataTemplate>
</ResourceDictionary> 
```

///////////////////////////////////////// //

```
<Window x:Class="wpftest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="720" Width="1280"
    xmlns:Res="clr-namespace:wpftest.Properties" DataContext="{Binding}">

<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="ResourceDictionary.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources>

<Grid>
    <StackPanel Height="457" HorizontalAlignment="Left" Name="stackPanel1" VerticalAlignment="Top" Width="1258" >
        <ListBox Height="452" Name="listBox1" Width="1253" 
                 ItemTemplate="{StaticResource myTemplate}"
                 ItemsSource="{Binding}">         
        </ListBox>
    </StackPanel>

    <Button Content="Button" 
            ContentTemplate="{StaticResource customImageTileButton}"
            HorizontalAlignment="Left"
            Margin="84,492,0,0"
            Name="button1" 
            VerticalAlignment="Top" 
            />
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:49:33.983

您可以将图像直接绑定到按钮的前景：

```
<Button Height="50" Width="50" Grid.Column="1">
    <Image Source="{DynamicResource ChooseImageSource}" />
</Button> 
```

其中图像资源定义为：

```
<BitmapImage x:Key="ChooseImageSource" CacheOption="OnLoad"
             CreateOptions="IgnoreImageCache" UriSource="resources/shuffle.png"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T20:42:39.310

使用 ImageBrush 作为按钮的背景。示例代码如下。

```
 <Window x:Class="ImageOnButton.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <ImageSource x:Key="img">C:\Users\vanathi\Desktop\SampleImage.jpg</ImageSource>
</Window.Resources>
<Grid>
    <Button Width="250" Height="100">
        <Button.Background>
            <ImageBrush ImageSource="{StaticResource img}"/>
        </Button.Background>
    </Button>
</Grid> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T21:38:55.957

这似乎起到了作用：

```
<Style x:Key="customStyle" TargetType="{x:Type Button}">
    <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="3"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="0,0,1,1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Canvas x:Name="ButtonCanvas" Width="296" Height="121">
                    <Image x:Name="ButtonImage" Width="280" Height="105" Canvas.Left="8" Canvas.Top="8" Source="{Binding url1}"/>
                </Canvas>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsKeyboardFocused" Value="true"/>
                    <Trigger Property="IsDefaulted" Value="true"/>
                    <Trigger Property="IsPressed" Value="true"/>
                    <Trigger Property="ToggleButton.IsChecked" Value="true"/>
                    <Trigger Property="IsEnabled" Value="true">
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

没有花里胡哨的较短版本///////////////////////////////////

```
 <Style x:Key="myButton" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Image x:Name="ButtonImage" Width="280" Height="105" Canvas.Left="8" Canvas.Top="8" Source="{Binding url1}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>   
    </Style 
```

# c++ - Foo** 如何是一个数组数组？

> ID：11089608
> 
> 赞同：1
> 
> 时间：2012-06-18T19:22:13.607
> 
> 标签：c++, pointers

在 C++ 中，有人告诉我这`Foo** foo;`是一个指向指针的指针，也是一个数组数组？

有人会详细说明为什么它是数组数组或如何解释它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T19:23:57.400

它不是真正的数组数组。但是，您可以使用与实际二维数组相同的语法访问各个元素。

```
int x[5][7];   // A real 2D array

// Dynamically-allocated memory, accessed through pointer to pointer
// (remember that all of this needs to be deallocated with symmetric delete[] at some point)
int **y = new int*[5];
for (int i = 0; i < 7; i++) {
    y[i] = new int[7];
}

// Both can be accessed with the same syntax
x[3][4] = 42;
y[3][4] = 42;

// But they're not identical.  For example:

void my_function(int **p) { /* ... blah ... */ }

my_function(x);  // Compiler error!
my_function(y);  // Fine 
```

还有很多其他的微妙之处。要进行更深入的讨论，我强烈建议通读 C 常见问题解答中有关此主题的所有部分：[*数组和指针*](http://c-faq.com/aryptr/index.html)（几乎所有内容在 C++ 中同样有效）。

然而，在 C++ 中，通常很少有理由使用这样的原始指针。使用容器类（例如`std::vector`、`std::array`或）可以更好地处理您的大部分需求`boost::multi_array`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:25:25.257

它不是*数组数组，*但您可以`Foo**`通过以下方式构造数组数组：

```
Foo** arr = new Foo*[height];
for (int i = 0; i < height; ++i)
    arr[i] = new Foo[width]; // in case of Foo has default constructor 
```

要访问单个元素，您可以使用

```
arr[i][j].some_method(); 
```

它也可以只是指向类型指针的指针`Foo`。

```
Foo* fooPointer = &fooInstance;
Foo** fooPointerPointer = &fooPointer; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T19:26:37.047

它不是数组的数组——指针不是数组，因此指向指针的指针不是指向数组的数组。

它们可以被类似地索引以存储和检索信息......因此在功能上它们的行为很像数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:28:08.350

简单的回答：在 C++ 中，（可变大小，即没有像 int[5] 这样的固定大小）数组只是指向该数组第一个元素的指针。因此，编译器无法区分指针是指向数组的开头还是指向单个实例。因此，编译器始终允许您将指针视为数组。但是，如果指针没有指向足够大的内存块以用作数组，那么使用它会导致某种内存故障（分段故障或静默故障）。

# ruby-on-rails - 带有 Core Data 陡峭学习曲线的 RestKit 0.10.1

> ID：11089611
> 
> 赞同：1
> 
> 时间：2012-06-18T19:22:32.073
> 
> 标签：ruby-on-rails, ios, core-data, restkit

我目前处于以下情况：

我正在创建一个 iOS 应用程序，我想将 RestKit 与 Core Data 结合使用。我是 RestKit 的新手，但我真的很想弄清楚。

我遇到了一些麻烦：

1.  如何使我的核心数据与服务器保持同步？如果我在服务器上删除一个对象或添加一个对象，我如何确保 Core Data 得到更新？我将对象发布到服务器没有问题，但我也想管理“入站”更改。
2.  我无法找到最新的文档和示例。有没有人有最新的代码示例？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:36:13.687

查看您的 restkit 下载中包含的 RKTwitterCoreData 示例应用程序中的代码。它应该让你了解这一点。另外，请注意，您需要阅读有关 RKObjectManager 的文档，这是您在将 JSON 或 XML 响应从服务器映射到 Core Data 时使用的类而不是 RKClient。

# java - 如何使用 javascript 添加复杂的表格行？

> ID：11089619
> 
> 赞同：0
> 
> 时间：2012-06-18T19:23:01.970
> 
> 标签：java, javascript, jsp

我有一个包含三列的表格，两个单元格包含选择框，其中包含 10-20 个值的列表。像这样的东西：

```
| USER    | MANAGER            | DEPARTMENT   |

| Rob     | [John Smith |V]    | [Sales |V]   | 

| Sue     | [Bob Jones |V]     | [Support |V] | 
```

该页面是一个 JSP，所以我正在使用 for 循环构建选择框内容。所有“经理”和所有“部门”列表都包含相同的项目。

我也有“添加新行”链接。我知道如何使用 Javascript 向表中添加新行，如下所示：

```
var table = document.getElementById("myTable");
var rowCount = table.rows.length;
var row = table.insertRow(rowCount); 
```

而且我知道如何将正确的“html”添加到新行，如下所示：

```
var cell0 = row.insertCell(0);
var element0 = document.createElement("span");
element0.innerHTML = 'Hello';
cell0.appendChild(element0); 
```

... 等等。

我的问题是我的表格行有*很多*HTML（因为每个选择框中可能有很多值）。

解决这个问题的好方法是什么？我应该如何添加我的新行？

任何建议都非常感谢！

谢谢，罗伯

# 更新

我突然想到，我可以编写一个“addNewRow”servlet，它接受表单上的所有数据，将其转换为 Java 列表，添加新项目，然后使用表中的新值重定向回我的页面。那可能很容易。

唯一的问题是网页会在每次“添加新”点击时重新加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:30:40.773

[你可以考虑一个模板解决方案——我是Mustache.js](https://github.com/janl/mustache.js/)的忠实粉丝。它允许您在一个单独的文件中编写 HTML，并将对象文字传递给模板引擎，模板引擎将为您呈现所有表格行。

你可以有一个这样的模板（只是弥补）：

```
{{#person}}
<td>
    <h2 class="jobTitle">{{jobTitle}}</h2>
    <span>{{name}}</span> - {{age}}
</td>
{{/person}} 
```

将对象的对象字面量传递给它`person`，每个对象都有一个`jobTitle`,`name`和`age`属性，它会为你做剩下的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:35:02.130

您可以克隆现有行之一并简单地编辑您需要的项目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:58:44.137

听起来问题不仅在于创建行，还在于您想要清理 html，以便选择选项不会弄乱一切 - 如果我理解正确的话。

您是否尝试过将选项分离到 JavaScript 数组中？

您可以单独使用 JavaScript 完成此操作，但如果您使用提供数据绑定的 JavaScript 库（如 KnockoutJS、AngularJS 或 Ember），则可以非常轻松地完成此操作。此外，它将帮助您解决其他关注点分离问题。

它们中的大多数还带有模板解决方案——这在创建表格时肯定会有所帮助。

Knockout 有一个`foreach`绑定，您可以使用它来生成行：

```
<tbody data-bind="foreach: people">
        <tr>
            <td data-bind="text: firstName"></td>
            <td data-bind="text: lastName"></td>
        </tr>
    </tbody> 
```

这是一个示例的链接：http: [//knockoutjs.com/documentation/foreach-binding.html](http://knockoutjs.com/documentation/foreach-binding.html)

如果你以前没有尝试过这个，我做了一个超级简单的例子，在 JSFiddle 中用 KnockoutJS 绑定一个选择框：http: [//jsfiddle.net/phillipkregg/eQF3e/](http://jsfiddle.net/phillipkregg/eQF3e/)

以防万一值存储在服务器上，您可以将值下拉并使用 JQuery ajax 调用将它们存储到数组中 - 如下所示：

```
$.getJSON('/my_items', function(data) {
   viewModel.items(data);
}); 
```

如果您对淘汰赛感兴趣 - 这是他们网站上的另一个示例，向您展示如何使用行和选择框做更复杂的事情：http: [//knockoutjs.com/examples/cartEditor.html](http://knockoutjs.com/examples/cartEditor.html)

可能值得检查整个站点 - 文档非常好。

希望有帮助。

# javascript - 如何查看两个图像源是否相等？

> ID：11089625
> 
> 赞同：2
> 
> 时间：2012-06-18T19:23:18.917
> 
> 标签：javascript, jquery

我正在尝试查看用户单击的两个图像是否相同。我有一些代码可以检索被点击的图像的来源：

`$('img').click(function() { var path = $(this).attr('src'); });`

我只需要一种方法来比较两个来源。我尝试将源存储在一个数组中并查看它们是否相等，但我无法让它工作：

```
var bothPaths = [];

$('img').click(function() {
    var path = $(this).attr('src');
    bothPaths.push(path);
}); 

if (bothPaths[0] == bothPaths[1]) {
    alert("they match.");
} else {
    alert("they don't match.");
} 
```

我假设这将比较用户单击的前两个图像源，但我似乎在某个地方遇到了问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T19:26:18.973

您正在检查路径是否匹配...在单击任何内容之前。

相反，试试这个：

```
(function() {
    var lastclicked = "";
    $("img").click(function() {
        var path = $(this).attr("src");
        if( lastclicked == path) {
            alert("Match!");
        }
        else {
            if( lastclicked != "") alert("No match...");
        }
        lastclicked = path;
    });
})(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:28:26.463

您的 if 语句仅在加载时被解释，试试这个：

```
var bothPaths = [];

$('img').click(function() {
    var path = $(this).attr('src');
    bothPaths.push(path);
    compare()
}); 

function compare() {
   if (bothPaths[0] == bothPaths[1]) {
      alert("they match.");
   } else {
       alert("they don't match.");
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T20:07:57.513

单击图像后，单击处理程序会将内容添加到数组中。您的比较发生在您的点击处理程序附加后。换句话说，在任何人有机会点击任何内容之前，您先比较数组中的前两个位置。

这是您应该学习的一些最佳实践代码。它将帮助您了解页面的生命周期以及 jQuery 如何与它进行最佳交互。

```
$(document).ready(function(){
    var lastClicked = '';
    $(document).on('click', 'img', function(){
        var src = $(this).attr('src');
        if (src == lastClicked) {
            alert('matching');
        } else {
            lastClicked = src;
        }
    });
}); 
```

# c# - 在调用 read() 之前访问字段的尝试无效

> ID：11089633
> 
> 赞同：5
> 
> 时间：2012-06-18T19:23:58.693
> 
> 标签：c#, mysql, database

我已经搜索了好几个小时，寻找解决这个问题的方法。我正在尝试使用下面的代码和正确的查询从我的数据库中获取信息。我知道这些查询有效，因为我已经在 MySQL 工作台中测试过它们。我不断收到错误：

> 在调用 read() 之前访问字段的尝试无效

正如您将看到的，我确实调用了 read()，而我的研究只是提出了没有使用正确的数据库，我也已经验证它是正确的。关于我为什么收到此错误的任何想法？在此先感谢您的帮助。

```
public static string ExecuteSelect(string query)
{
    //Example query is: SELECT entity_id FROM catalog_product_flat_1 WHERE sku='itemSku';
    string statement = "";

    MySqlCommand myCommand = new MySqlCommand(query, _conn);

    MySqlDataReader myReader;
    myReader = myCommand.ExecuteReader();
    myReader.Read();

    statement = myReader.GetString(0);
    myReader.Close();

    return statement;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T19:27:58.047

不确定这是否是您的问题，但您应该始终检查 Read() 的结果。例如

```
if (myReader.Read())
{
  statement = myReader.GetString(0);
} 
```

**编辑：**您实际上正在做的是检索标量，因此您可以使用 ExecuteScalar()

```
return (myCommand.ExecuteScalar() ?? string.Empty).ToString();
//also rename your method appropriately 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-12T15:44:21.880

我刚刚摆脱了与您类似的问题。我的解决方案是使用

```
if (!myReader.HasRows)
                {

                } 
```

就在遍历数据集之前。

```
while(myRead.Read()
{
 //read tuples
} 
```

这对您的代码意味着：

```
public static string ExecuteSelect(string query)
{
//Example query is: SELECT entity_id FROM catalog_product_flat_1 WHERE 
sku='itemSku';
string statement = "";

MySqlCommand myCommand = new MySqlCommand(query, _conn);

MySqlDataReader myReader;
myReader = myCommand.ExecuteReader();
myReader.Read();
if(!myReader.HasRows)
{
 //set your statement variable to some generic value
 statement="abracadabra";
}

while(myReader.Read())
{
statement = myReader[0].ToString();
}
myReader.Close();

return statement;
} 
```

# c++ - Windows 内存管理中的备用列表是什么？

> ID：11089638
> 
> 赞同：8
> 
> 时间：2012-06-18T19:24:20.020
> 
> 标签：c++, windows, memory-management

Windows 中的内存管理方案非常复杂，我试图更好地理解它，以便更准确地诊断内存问题。

例如，我们的 C++ 应用程序（在 SysInternal 的 Process Explorer 中）显示 1.4GB 的“虚拟大小”、400MB 的“私有字节”和 366MB 的“工作集”。

我做了一些研究，发现了这个问题： [什么是私有字节、虚拟字节、工作集？](https://stackoverflow.com/questions/1984186/what-is-private-bytes-virtual-bytes-working-set)

这是一本很好的读物，但有些东西仍然没有加起来。具体来说，投票最高的答案表明虚拟字节包括备用列表。我不太确定这些是什么，而且我所做的任何研究都没有对它做出友好的解释。我最大的问题是：将页面移动到备用列表如何影响应用程序的虚拟地址空间（如果有的话）？换句话说，虚拟大小比任何其他大小都大得多，差异是内存碎片吗？

如果有人可以帮助我更好地理解这一点，我将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T19:32:26.693

在一个简单的场景中，一段时间未使用的页面将从进程中删除，清除并放入空闲列表，以便任何其他进程在需要更多内存时可以使用它。

使用备用列表，页面会从进程中删除，*而不是修改*，然后放入备用列表。如果同一进程碰巧需要该页面，它会立即返回。如果另一个进程需要更多内存，则该页面将被清除并提供给该进程。

因此，简而言之，内存管理器会保留已初始化的内存，以防最初使用它的进程想要它回来 - 但如果其他人想要更多内存，他们会得到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:30:56.760

备用列表实际上是当前缓存的内存页面列表，但可以丢弃以便为其他应用程序释放内存。

鉴于此，将页面移动到备用列表不会影响应用程序的虚拟地址空间，因为该列表上的内存未被进程占用，尽管进程能够在需要时快速回收它。

# c# - 填充列表 with push json data and display table Im using aspx engine. I've been trying to push data into my list but i don't know how. every time i run the program it says create new instance of an object..im not too sure what they ta 问问题 问问题 2012-06-18T19:24:28.507 983 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Im using aspx engine. I've been trying to push data into my list but i don't know how. every time i run the program it says create new instance of an object..im not too sure what they talking about..but i did create an instance of the class but still didnt work Can anyone please help me this is my trying to populate data in my homecontroller public ActionResult GetEvent() { try { string i = "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa"; string et = "KI2XfwQNByLPFdK4i3a74slLT7sjjzYRi9RR7zEtCoQ%3D"; string t = "20111128183020"; string _checkingUrl = String.Format("http://172.22.22.10/SampleAPI/Event/GetEvents?at={0}&et={1}&t={2}&responseFormat=json", i, et, t); System.Net.HttpWebRequest request=System.Net.WebRequest.Create(_checkingUrl) as System.Net.HttpWebRequest; System.Net.HttpWebResponse response=request.GetResponse() as System.Net.HttpWebResponse; System.IO.StreamReader _readResponse=new System.IO.StreamReader(response.GetResponseStream()); //The encrypted dynamics response in either xml or json var _responseAsString=_readResponse.ReadToEnd(); JavaScriptSerializer parseResponse = new JavaScriptSerializer(); List <event>events = parseResponse.Deserialize<list<event>>(_responseAsString); Event eventOjb = new Event(); events.Add(eventOjb); ViewBag.eventss = events; _readResponse.Close(); // check json object return Content(_responseAsString.ToString()); } catch (Exception e) { Console.WriteLine(e.ToString()); //log error } return View(); } this is my Event class that is in the model folder using System; using System.Collections.Generic; using System.Linq; using System.Web; using System.ComponentModel.DataAnnotations; namespace StopMalaria.Models { public class Event { public string event_key { get; set; } public string user_token { get; set; } public string event_set_key { get; set; } public string event_type { get; set; } public string event_date { get; set; } public string event_amount { get; set; } public string event_location_key { get; set; } public string event_location_name { get; set; } public string event_location_city { get; set; } public string event_location_state { get; set; } public string event_location_country { get; set; } public string event_acknowledged { get; set; } } } this is my html trying to step through the list and create a table and error message comes on the foreach loop that says Object reference not set to an instance of an object <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %> <asp:content id="Content1" contentplaceholderid="TitleContent" runat="server">GetEvent</asp:content> <asp:content id="Content2" contentplaceholderid="MainContent" runat="server"><%List <stopmalaria.models.event>events = new List<stopmalaria.models.event>();%> <%events = ViewBag.eventss;%> <% foreach (var item in events ) { %></stopmalaria.models.event></stopmalaria.models.event> <% } %>

| event_key | user_token | event_set_key | event_type | event_date | event_amount | event_location_key | event_location_name | event_location_city | event_location_state | event_location_country | event_acknowledged |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| <%: item.event_key%> | <%: item.user_token%> | <%: item.event_set_key%> | <%: item.event_type%> | <%: item.event_date%> | <%: item.event_amount%> | <%: item.event_location_key%> | <%: item.event_location_name%> | <%: item.event_location_city%> | <%: item.event_location_state%> | <%: item.event_location_country%> | <%: item.event_acknowledged%> |</asp:content> An alternative option would be using the PHP ImageMagick extension, Imagick. You can create the rectangle by setting the background parameter of the Imagick::newImage function, the cicle using the ImagickDraw::circle function, and the key is to apply the circle using the Imagick::compositeImage and only copying the transparency over. This will prevent you from having a solid image with a transparent circle on top; everything that is transparent in the mask will be transparent on the original image. The below code should do the trick (although I am sure it will need a few tweaks to meet your needs :P): cropImage(512, 512, 0, 0); $base->setImageMatte(true); $mask = new Imagick(); $mask->newImage(512, 512, new ImagickPixel("transparent")); $circle = new ImagickDraw(); $circle->setFillColor("black"); $circle->circle(150, 150, 100, 100); $mask->drawImage($circle); $base->compositeImage($mask, Imagick::COMPOSITE_COPYOPACITY, 0, 0); $base->writeImage('after.png'); header("Content-Type: image/png"); echo $base; ?> c#htmlasp.net-mvcjson 4 1 回答 1 This answer is useful 0 究竟是在哪里抛出异常？ 从什么返回 _readResponse.ReadToEnd(); 在您尝试反序列化您的响应后，events会是什么样子？ 最后，您确定这不会导致问题： Event eventOjb = new Event(); events.Add(eventOjb); 不会设置任何字符串属性，这将导致空指针异常。 于 2012-06-18T20:49:02.120 回答 Related 1 c - 在C中的链表内将元素添加到链表 1 c# - .NET WCF 命名管道与 COM 对象性能 3 javascript - 使用jQuery查找两个DIV之间的距离？ 4 git - Git 新提交作为项目的旧版本 1 javascript - Javascript 复选框 onClick 添加 2 java - Android Surface 类 Surface.ROTATION_ 无法解析或不是字段 0 android - 奇怪的android性能问题 1 opengl - glDrawElements 是否在后台缓冲区同步？ 0 java - Activity.saveInstanceState 和 Guava ImmutableList 序列化 1 c - 我在这里做错了什么？程序循环不停 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</dynamic></list<event></event>

> ID：11089639
> 
> 赞同：0
> 
> 时间：
> 
> 标签：c#, html, asp.net-mvc, json

Im using aspx engine. I've been trying to push data into my list but i don't know how. every time i run the program it says create new instance of an object..im not too sure what they talking about..but i did create an instance of the class but still didnt work Can anyone please help me

this is my trying to populate data in my homecontroller

```
 public ActionResult GetEvent()
    {
        try
        {

            string i = "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa";
            string et = "KI2XfwQNByLPFdK4i3a74slLT7sjjzYRi9RR7zEtCoQ%3D";
            string t = "20111128183020";
            string _checkingUrl =  String.Format("http://172.22.22.10/SampleAPI/Event/GetEvents?at={0}&et={1}&t={2}&responseFormat=json", i, et, t);
            System.Net.HttpWebRequest request=System.Net.WebRequest.Create(_checkingUrl) as System.Net.HttpWebRequest;
            System.Net.HttpWebResponse response=request.GetResponse() as System.Net.HttpWebResponse;
            System.IO.StreamReader _readResponse=new System.IO.StreamReader(response.GetResponseStream());
            //The encrypted dynamics response in either xml or json
            var _responseAsString=_readResponse.ReadToEnd();
            JavaScriptSerializer parseResponse = new JavaScriptSerializer();

            List<Event> events = parseResponse.Deserialize<List<Event>>(_responseAsString);

            Event eventOjb = new Event();
            events.Add(eventOjb);

            ViewBag.eventss = events;

            _readResponse.Close();
            // check json object
            return Content(_responseAsString.ToString());  

        }
        catch (Exception e)
        {
            Console.WriteLine(e.ToString());
            //log error
        }
        return View();
    } 
```

this is my Event class that is in the model folder

```
 using System;
  using System.Collections.Generic;
 using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;

 namespace StopMalaria.Models
 {
public class Event
{
    public string event_key { get; set; }
    public string user_token { get; set; }
    public string event_set_key { get; set; }
    public string event_type { get; set; }
    public string event_date { get; set; }
    public string event_amount { get; set; }
    public string event_location_key { get; set; }
    public string event_location_name { get; set; }
    public string event_location_city { get; set; }
    public string event_location_state { get; set; }
    public string event_location_country { get; set; }
    public string event_acknowledged { get; set; }
} 
```

}

this is my html trying to step through the list and create a table and error message comes on the foreach loop that says Object reference not set to an instance of an object

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    GetEvent
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

   <table id="eventist" border="0" cellspacing="0" cellpadding="0">
    <thead>
        <tr>
            <th>
                event_key
            </th>
             <th>
                user_token
            </th>                
            <th>
                event_set_key
            </th>           
            <th>
                event_type
            </th>
             <th>
              event_date
            </th>
              <th>
                event_amount
            </th>
             <th>
                event_location_key
            </th>                
            <th>
                event_location_name
            </th>           
            <th>
                event_location_city
            </th>
             <th>
              event_location_state
            </th>
            <th>
                event_location_country
            </th>
             <th>
              event_acknowledged
            </th>
        </tr>
    </thead>
    <tbody>
    <%List<StopMalaria.Models.Event> events = new List<StopMalaria.Models.Event>();%>
    <%events = ViewBag.eventss;%>

    <% foreach (var item in events )
       { %>

        <tr>
            <td>
                <%: item.event_key%>
            </td>
            <td>
                  <%: item.user_token%>
            </td>               
            <td>
                <%: item.event_set_key%>
            </td>           
            <td>
                <%: item.event_type%>
            </td> 
             <td>
                <%: item.event_date%>
            </td>
            <td>
                  <%: item.event_amount%>
            </td>               
            <td>
                <%: item.event_location_key%>
            </td>           
            <td>
                <%: item.event_location_name%>
            </td> 
             <td>
                <%: item.event_location_city%>
            </td>
            <td>
                  <%: item.event_location_state%>
            </td>               
            <td>
                <%: item.event_location_country%>
            </td>           
            <td>
                <%: item.event_acknowledged%>
            </td>                   
        </tr>

    <% } %>
    </tbody>
    </table>

</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:49:02.120

究竟是在哪里抛出异常？

从什么返回

```
 _readResponse.ReadToEnd(); 
```

在您尝试反序列化您的响应后，`events`会是什么样子？

最后，您确定这不会导致问题：

```
 Event eventOjb = new Event();
        events.Add(eventOjb); 
```

不会设置任何字符串属性，这将导致空指针异常。

# php - 动态缩放图像以适应指定大小的宽度和高度

> ID：11089640
> 
> 赞同：9
> 
> 时间：2012-06-18T19:24:28.540
> 
> 标签：php, html, dynamic, scale, aspect-ratio

因此，经过广泛的研究和大量的 jQuery 和 Javascript 解决方案，我根本找不到一种方法来动态地将图像水平和垂直缩放到指定的大小，我发现了大量关于缩放以适应宽度并保持纵横比的信息，或缩放以适应高度并保持纵横比，但无法确定图像是太高还是太短并相应地进行调整。

所以在我的例子中，我有`<div>`一个设置宽度为 460 像素，设置高度为 280 像素的图像，我需要图像完全适合该区域而不拉伸（保持其纵横比）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-18T19:24:29.100

现在，在摆弄了一些宽泛的例子之后，我的经典代数技能开始发挥作用。

如果我把宽度除以高度，那么在这种情况下，460/280 你反过来得到 1.642... 这是该区域的纵横比，现在如果我查看图像的纵横比，我知道如果它大于 1.642... 那意味着它比区域更宽，如果图像的纵横比小于 1.642 则意味着它更高。

所以我想出了以下内容，

```
// Set the Image in question
$image = 'img/gif/b47rz.gif';

// Set the width of the area and height of the area
$inputwidth = 460;
$inputheight = 280;

// Get the width and height of the Image
list($width,$height) = getimagesize($image);

// So then if the image is wider rather than taller, set the width and figure out the height
if (($width/$height) > ($inputwidth/$inputheight)) {
            $outputwidth = $inputwidth;
            $outputheight = ($inputwidth * $height)/ $width;
        }
// And if the image is taller rather than wider, then set the height and figure out the width
        elseif (($width/$height) < ($inputwidth/$inputheight)) {
            $outputwidth = ($inputheight * $width)/ $height;
            $outputheight = $inputheight;
        }
// And because it is entirely possible that the image could be the exact same size/aspect ratio of the desired area, so we have that covered as well
        elseif (($width/$height) == ($inputwidth/$inputheight)) {
            $outputwidth = $inputwidth;
            $outputheight = $inputheight;
            }
// Echo out the results and done
echo '<img src="'.$image.'" width="'.$outputwidth.'" height="'.$outputheight.'">'; 
```

它工作得很好，所以我想我会分享，希望这可以帮助一些人

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T10:24:07.510

如果我正确理解您的问题，我更简单的缩放图像的方法是使用以下 CSS 样式规则：

```
max-width
max-height 
```

这两个样式规则允许您指定图像的最大宽度/高度。浏览器将缩小图像（保留纵横比）以适合您指定的大小。您还可以使用这两个来指定图像的最小宽度/高度：

```
min-width
min-height 
```

# sql - What is the Oracle equivalent of the Informix `interval` function?

> ID：11089643
> 
> 赞同：2
> 
> 时间：2012-06-18T19:24:31.910
> 
> 标签：sql, oracle, oracle11g, informix

I have been tasked with converting some scripts referencing an Informix database to be compatible with a new Oracle database.

I thought I would start out by going through the individual scripts and looking for function calls that may vary syntactically between Informix and Oracle. I had been able to find the Oracle equivalent for most of the function calls I came across, however this one has me a little stumped:

```
where f.writetime > current - interval(xxx) day to day 
```

What exactly does that function mean, particularly the `(xxx)` part and what is the Oracle equivalent?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:32:10.780

这不是函数调用 - 它是 Informix SQL 的`INTERVAL` [数据类型文字语法](http://publib.boulder.ibm.com/infocenter/idshelp/v111/index.jsp?topic=/com.ibm.sqlr.doc/sqlr127.htm)。

Oracle SQL 也支持[区间数据类型](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements003.htm#i38598)。

我希望甲骨文会给出类似的结果

```
WHERE f.writetime > current_timestamp - INTERVAL 'xxx' DAY TO DAY 
```

本质上，当写入时间大于当前时间减去 xxx 天时。

# objective-c - UIBarButtonItem 未添加到导航中

> ID：11089653
> 
> 赞同：0
> 
> 时间：2012-06-18T19:25:39.677
> 
> 标签：objective-c, uibarbuttonitem, uinavigationitem

我无法在导航栏中设置左按钮。任何人都知道为什么下面的代码没有显示按钮？

```
UIBarButtonItem *barButton = [[UIBarButtonItem alloc] 
 initWithTitle:@"my left button" 
 style:UIBarButtonItemStyleBordered 
 target:nil 
 action:nil];

[self.navigationItem setLeftBarButtonItem:barButton];

 //this is now printing out "my left button", 
 //but the button still does not appear on the navigation.
 NSLog(@"navigationItem.leftBarButtonItem.title:
  %@",self.navigationItem.leftBarButtonItem.title); 
```

界面生成器：

![在此处输入图像描述](../Images/98d55ba999cb38e2dfdcf5646f8debf3.png)

模拟器：

![在此处输入图像描述](../Images/72271581b8e1c60e49948e02a060cf72.png)

- -更新 - -

上面的代码根据 CodaFi 的建议使用正确的 enum 和 init 进行了更新，但按钮仍然没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:51:09.427

您的 init 方法的`initWithBarButtonSystemItem:`一部分被提供了错误的枚举值。

系统项不同于条形按钮样式（例如 UIBarButtonItem* *Style* *Bordered，与 UIBarButton* *System* *ItemAdd）。

以下是有效枚举值的列表：

> typedef enum { UIBarButtonSystemItemDone, UIBarButtonSystemItemCancel, UIBarButtonSystemItemEdit, UIBarButtonSystemItemSave, UIBarButtonSystemItemAdd, UIBarButtonSystemItemFlexibleSpace, UIBarButtonSystemItemFixedSpace, UIBarButtonSystemItemCompose, UIBarButtonSystemItemReply, UIBarButtonSystemItemAction, UIBarButtonSystemItemOrganize, UIBarButtonSystemItemBookmarks, UIBarButtonSystemItemSearch, UIBarButtonSystemItemRefresh, UIBarButtonSystemItemStop, UIBarButtonSystemItemCamera, UIBarButtonSystemItemTrash, UIBarButtonSystemItemPlay, UIBarButtonSystemItemPause, UIBarButtonSystemItemRewind, UIBarButtonSystemItemFastForward, UIBarButtonSystemItemUndo, // iOS 3.0 及更高版本 UIBarButtonSystemItemRedo, // iOS 3.0 及更高版本 UIBarButtonSystemItemPageCurl

# php - 在文件上传时更改文件权限--PHP？

> ID：11089654
> 
> 赞同：3
> 
> 时间：2012-06-18T19:25:41.550
> 
> 标签：php, upload, permissions

我有一个 PHP 上传脚本，并且正在尝试制作它，以便我网站的所有用户都可以编辑和读取上传的文件（即将上传文件的文件权限设置为`chmod 777`）。文件上传到的目录具有正确的权限。但是，上传的文件没有。因为新文件会不断上传，所以我需要在上传过程中内置某种代码，在上传时设置/更改上传文件的文件**权限**。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:29:47.307

只需`chmod()`在上传功能后使用..

```
<?php

/* 
 * All your upload code here; then pass the filename
 * and the base permissions to the chmod() below
 */

chmod($uploadedFile, 0777);

?> 
```

# python - 排序字典python 3

> ID：11089655
> 
> 赞同：49
> 
> 时间：2012-06-18T19:25:44.280
> 
> 标签：python, dictionary

我正在研究 python 3.2.2。打破我的头脑超过 3 个小时来按它的键对字典进行排序。我设法使它成为一个带有 2 个参数成员的排序列表，但最终不能使它成为一个排序字典。

这就是我的想法：

```
myDic={10: 'b', 3:'a', 5:'c'}
sorted_list=sorted(myDic.items(), key=lambda x: x[0]) 
```

但无论如何我都无法从这个排序列表中制作字典。我怎么做？谢谢！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2018-03-06T16:43:20.080

适用于 Python 3.7 的现代且快速的解决方案。也可以在 Python 3.6 的一些解释器中工作。

**TLDR**

要按键对字典进行排序，请使用：

```
sorted_dict = {k: disordered[k] for k in sorted(disordered)} 
```

几乎比公认的答案快三倍；当你包括进口时，可能更多。

**评论接受的答案**

接受的答案中的示例而不是仅迭代键 - 使用`key`参数 of`sorted()`或 dict 迭代的默认行为 - 迭代元组`(key, value)`，令人惊讶的是，这比仅比较键和访问列表理解中的字典元素要慢得多.

**如何在 Python 3.7 中按键排序**

Python 3.7 最大的变化是[字典现在是默认排序的](https://mail.python.org/pipermail/python-dev/2017-December/151283.html)。

*   您可以使用字典推导生成排序字典。
*   `OrderedDict`出于兼容性考虑，使用可能仍然是可取的。
*   不要使用`sorted(d.items())`没有`key`。

看：

```
disordered = {10: 'b', 3: 'a', 5: 'c'}

# sort keys, then get values from original - fast
sorted_dict = {k: disordered[k] for k in sorted(disordered)}

# key = itemgetter - slower
from operator import itemgetter
key = itemgetter(0)
sorted_dict = {k: v for k, v in sorted(disordered.items(), key=key)}

# key = lambda - the slowest
key = lambda item: item[0]
sorted_dict = {k: v for k in sorted(disordered.items(), key=key)} 
```

**计时结果**：

```
Best for {k: d[k] for k in sorted(d)}: 7.507327548999456
Best for {k: v for k, v in sorted(d.items(), key=key_getter)}: 12.031082626002899
Best for {k: v for k, v in sorted(d.items(), key=key_lambda)}: 14.22885995300021

Best for dict(sorted(d.items(), key=key_getter)): 11.209122000000207
Best for dict(sorted(d.items(), key=key_lambda)): 13.289728325995384
Best for dict(sorted(d.items())): 14.231471302999125

Best for OrderedDict(sorted(d.items(), key=key_getter)): 16.609151654003654
Best for OrderedDict(sorted(d.items(), key=key_lambda)): 18.52622927199991
Best for OrderedDict(sorted(d.items())): 19.436101284998585 
```

测试代码：

```
from timeit import repeat

setup_code = """
from operator import itemgetter
from collections import OrderedDict
import random
random.seed(0)
d = {i: chr(i) for i in [random.randint(0, 120) for repeat in range(120)]}
key_getter = itemgetter(0)
key_lambda = lambda item: item[0]
"""

cases = [
    # fast
    '{k: d[k] for k in sorted(d)}',
    '{k: v for k, v in sorted(d.items(), key=key_getter)}',
    '{k: v for k, v in sorted(d.items(), key=key_lambda)}',
    # slower
    'dict(sorted(d.items(), key=key_getter))',
    'dict(sorted(d.items(), key=key_lambda))',
    'dict(sorted(d.items()))',
    # the slowest 
    'OrderedDict(sorted(d.items(), key=key_getter))',
    'OrderedDict(sorted(d.items(), key=key_lambda))',
    'OrderedDict(sorted(d.items()))',
]

for code in cases:
    times = repeat(code, setup=setup_code, repeat=3)
    print(f"Best for {code}: {min(times)}") 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-06-18T19:29:58.617

`dict`不保持其元素的顺序。您需要的是 OrderedDict：[http ://docs.python.org/library/collections.html#collections.OrderedDict](http://docs.python.org/library/collections.html#collections.OrderedDict)

**编辑**

使用示例：

```
>>> from collections import OrderedDict
>>> a = {'foo': 1, 'bar': 2}
>>> a
{'foo': 1, 'bar': 2}
>>> b = OrderedDict(sorted(a.items()))
>>> b
OrderedDict([('bar', 2), ('foo', 1)])
>>> b['foo']
1
>>> b['bar']
2 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-09-23T06:41:28.630

我不认为你想要一个 OrderedDict。听起来您更喜欢[SortedDict](http://www.grantjenks.com/docs/sortedcontainers/sorteddict.html)，这是一个按排序顺序维护其键的字典。sortedcontainers模块就提供了这样一种数据类型[。](http://www.grantjenks.com/docs/sortedcontainers/)它是用纯 Python 编写的，速度与 C 一样快，具有 100% 的覆盖率和数小时的压力。

使用 pip 安装很容易：

```
pip install sortedcontainers 
```

请注意，如果您不能，`pip install`那么您可以简单地从开源存储库中提取源文件。

然后你的代码很简单：

```
from sortedcontainers import SortedDict
myDic = SortedDict({10: 'b', 3:'a', 5:'c'})
sorted_list = list(myDic.keys()) 
```

sortedcontainers 模块还保持与其他流行实现的[性能比较。](http://www.grantjenks.com/docs/sortedcontainers/performance.html)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-06-18T19:30:18.087

Python 的普通`dicts`程序不能以任何特定顺序提供键/元素。为此，您可以使用模块中的`OrderedDict`类型`collections`。请注意，该`OrderedDict`类型仅保留插入顺序的记录。如果您希望后续视图/迭代器每次都按顺序返回元素，则必须在初始化字典之前对条目进行排序。例如：

```
>>> myDic={10: 'b', 3:'a', 5:'c'}
>>> sorted_list=sorted(myDic.items(), key=lambda x: x[0])
>>> myOrdDic = OrderedDict(sorted_list)
>>> myOrdDic.items()
[(3, 'a'), (5, 'c'), (10, 'b')]
>>> myOrdDic[7] = 'd'
>>> myOrdDic.items()
[(3, 'a'), (5, 'c'), (10, 'b'), (7, 'd')] 
```

如果您想为新添加的项目保持正确的顺序，您确实需要使用不同的数据结构，例如二叉树/堆。除非您的数据完全是静态的，否则这种构建排序列表并使用它来初始化新`OrderedDict()`实例的方法效率非常低。

编辑：因此，如果对数据进行排序的对象只是按顺序打印它，以类似于 python`dict`对象的格式，类似以下内容就足够了：

```
def pprint_dict(d):
    strings = []
    for k in sorted(d.iterkeys()):
        strings.append("%d: '%s'" % (k, d[k]))
    return '{' + ', '.join(strings) + '}' 
```

请注意，此函数在键、值对的类型方面不灵活（即，它希望键是整数，对应的值是字符串）。如果您需要更大的灵活性，请改用类似的东西`strings.append("%s: %s" % (repr(k), repr(d[k])))`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-08-23T10:33:24.227

使用 Python 3.7，我可以这样做：

```
>>> myDic={10: 'b', 3:'a', 5:'c'}
>>> sortDic = sorted(myDic.items())
>>> print(dict(sortDic))
{3:'a', 5:'c', 10: 'b'} 
```

如果你想要一个元组列表：

```
>>> myDic={10: 'b', 3:'a', 5:'c'}
>>> sortDic = sorted(myDic.items())
>>> print(sortDic)
[(3, 'a'), (5, 'c'), (10, 'b')] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-26T14:47:48.800

也许不是那么好，但我已经想到了这一点：

```
def order_dic(dic):
    ordered_dic={}
    key_ls=sorted(dic.keys())
    for key in key_ls:
        ordered_dic[key]=dic[key]
    return ordered_dic 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-26T07:27:34.040

这个问题的任何现代解决方案？我解决了这个问题：

```
 order = sorted([ job['priority'] for job in self.joblist ])
    sorted_joblist = []
    while order:
        min_priority = min(order)
        for job in self.joblist:
            if job['priority'] == min_priority:
                sorted_joblist += [ job ]
                order.remove(min_priority)
    self.joblist = sorted_joblist 
```

作业列表的格式为： joblist = [ { 'priority' : 3, 'name' : 'foo', ... }, { 'priority' : 1, 'name' : 'bar', ... } ]

*   基本上我创建了一个列表（顺序），其中包含我想要对字典进行排序的所有元素
*   然后我迭代这个列表和字典，当我在字典上找到项目时，我将它发送到一个新的字典并从“订单”中删除该项目。

似乎正在工作，但我想有更好的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-04T02:49:39.913

我不确定这是否有帮助，但我有一个类似的问题，我设法通过定义一个合适的函数来解决它：

```
def sor_dic_key(diction):
    lista = []
    diction2 = {}
    for x in diction:
        lista.append([x, diction[x]])
    lista.sort(key=lambda x: x[0])
    for l in lista:
        diction2[l[0]] = l[1]
    return diction2 
```

此函数返回另一个具有相同键和相对值的字典，但按其键排序。同样，我定义了一个函数，可以按字典的值对字典进行排序。我只需要在 lambda 函数中使用`x[1]`而不是。`x[0]`我发现这第二个功能几乎没用，但永远无法分辨！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-18T19:52:22.720

我喜欢这种东西的python numpy！例如：

```
r=readData()
nsorted = np.lexsort((r.calls, r.slow_requests, r.very_slow_requests, r.stalled_requests)) 
```

我有一个将 CSV 数据导入 numpy 并按列优先级排序的示例。 [https://github.com/unixunion/toolbox/blob/master/python/csv-numpy.py](https://github.com/unixunion/toolbox/blob/master/python/csv-numpy.py)

基根

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-13T17:47:23.233

字典根据定义是无序的，按键排序的主要原因是什么？由 sort 方法创建的元组列表可用于任何需要，但将元组列表更改回字典将返回随机顺序

```
>>> myDic
{10: 'b', 3: 'a', 5: 'c'}
>>> sorted(myDic.items())
[(3, 'a'), (5, 'c'), (10, 'b')]
>>> print(dict(myDic.items()))
{10: 'b', 3: 'a', 5: 'c'} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-27T10:42:38.623

接受的答案肯定有效，但不知何故错过了重要的一点。

OP 要求按其排序的字典，这`keys`实际上是不可能的，而不是`OrderedDict`在做什么。

OrderedDict 以插入顺序维护字典的内容。插入的第一个项目，插入的第二个项目，等等。

```
>>> d = OrderedDict()
>>> d['foo'] = 1
>>> d['bar'] = 2
>>> d
OrderedDict([('foo', 1), ('bar', 2)])

>>> d = OrderedDict()
>>> d['bar'] = 2
>>> d['foo'] = 1
>>> d
OrderedDict([('bar', 2), ('foo', 1)]) 
```

因此，我将无法真正对字典进行*就地*排序，而只是创建一个插入顺序与键顺序匹配的新字典。这在新字典为 b 的已接受答案中是明确的。

如果您通过容器保持对字典的访问，这可能很重要。如果您以后打算通过添加或删除项目来更改字典，这也很重要：它们不会按键顺序插入，而是在字典的末尾。

```
>>> d = OrderedDict({'foo': 5, 'bar': 8})
>>> d
OrderedDict([('foo', 5), ('bar', 8)])
>>> d['alpha'] = 2
>>> d
OrderedDict([('foo', 5), ('bar', 8), ('alpha', 2)]) 
```

现在，字典按其键排序是什么意思？这在通过键访问元素时没有区别，这仅在您迭代项目时才重要。将其作为字典本身的属性似乎有点矫枉过正。在许多情况下，迭代时对 keys() 进行排序就足够了。

这意味着它等同于：

```
>>> d = {'foo': 5, 'bar': 8}
>>> for k,v in d.iteritems(): print k, v 
```

在按键字典排序的假设上或：

```
>>> d = {'foo': 5, 'bar': 8}
>>> for k, v in iter((k, d[k]) for k in sorted(d.keys())): print k, v 
```

当然，通过重载迭代器和维护排序的键列表将这种行为包装在对象中并不难。但这很可能是矫枉过正。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-12-14T17:26:22.710

使用推导按值对字典进行排序。我认为它就像 1 行一样好，不需要函数或 lambdas

```
a = {'b':'foo', 'c':'bar', 'e': 'baz'}
a = {f:a[f] for f in sorted(a, key=a.__getitem__)} 
```

# haskell - Haskell：为什么模式匹配适用于类型而不是相等的实例？

> ID：11089657
> 
> 赞同：7
> 
> 时间：2012-06-18T19:25:47.507
> 
> 标签：haskell, types, pattern-matching

我想知道 Haskell 中的模式匹配是如何工作的。我知道[这个线程](https://stackoverflow.com/questions/4718084/how-does-haskell-do-pattern-matching-without-us-defining-an-eq-on-our-data-types)，但不太明白其中的答案。

*   答案表明类型由布尔表达式匹配，但这怎么可能呢？
*   我得到的另一件事是模式匹配比模式匹配更通用，`(==)`并且`Eq`是通过使用模式匹配来实现的。

即使我在下面的代码片段中省略了，你能告诉我为什么`match`并且正在工作吗（很清楚为什么会失败）？`match3``deriving (Eq)``match2`

```
data MyType = TypeA | TypeB
            deriving (Eq)

match :: MyType -> String
match TypeA = "this is type A"
match TypeB = "this is type B"

match2 :: MyType -> String
match2 a | a == TypeA = "this is type A matched by equality"
         | a == TypeB = "this is type B matched by equality"
         | otherwise = "this is neither type A nor type B"

match3 :: MyType -> String
match3 a = case a of TypeA -> "this is type A matched by case expression"
                     TypeB -> "this is type B matched by case expression"

main :: IO ()
main = do
    (print . match) TypeA
    (print . match) TypeB
    (print . match2) TypeA
    (print . match2) TypeB
    (print . match3) TypeA
    (print . match3) TypeB 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-19T01:10:39.500

我只想指出，数据类型和模式匹配（初步近似）只是有用但冗余的语言特性，可以纯粹使用 lambda 演算来实现。如果您了解如何在 lambda 演算中实现它们，您就可以理解为什么它们不需要`Eq`实现模式匹配。

在 lambda 演算中实现数据类型被称为“教堂编码”（在[Alonzo Church](https://en.wikipedia.org/wiki/Alonzo_Church)之后，他演示了如何做到这一点）。Church-encoded 函数也被称为“Continuation-passing style”。

它被称为“连续传递样式”，因为您提供了一个处理该值的函数，而不是提供值。因此，例如，`Int`我可以不给用户一个 ，而是给他们一个以下类型的值：

```
type IndirectInt = forall x . (Int -> x) -> x 
```

上述类型与`Int`. “同构”只是一种奇特的说法，我们可以将 any`IndirectInt`转换为`Int`：

```
fw :: IndirectInt -> Int
fw indirect = indirect id 
```

...我们可以将 any`Int`转换为`IndirectInt`：

```
bw :: Int -> IndirectInt
bw int = \f -> f int 
```

...这样：

```
fw . bw = id -- Exercise: Prove this
bw . fw = id -- Exercise: Prove this 
```

使用延续传递风格，我们可以将任何数据类型转换为 lambda 演算项。让我们从一个简单的类型开始，例如：

```
data Either a b = Left a | Right b 
```

在延续传递风格中，这将变为：

```
type IndirectEither a b = forall x . (Either a b -> x) -> x 
```

但是 Alonzo Church 很聪明，他注意到对于任何具有多个构造函数的类型，我们可以只为每个构造函数提供一个单独的函数。因此，在上述类型的情况下`(Either a b -> x)`，我们可以提供两个单独的函数，一个用于 ，一个用于 ，而不是提供`a`type的函数，`b`这同样好：

```
type IndirectEither a b = forall x . (a -> x) -> (b -> x) -> x
-- Exercise: Prove that this definition is isomorphic to the previous one 
```

那么`Bool`构造函数没有参数的类型呢？好吧，`Bool`与 (Exercise: Prove this) 同构`Either () ()`，所以我们可以将其编码为：

```
type IndirectBool = forall x . (() -> x) -> (() -> x) -> x 
```

并且`() -> x`与 (Exercise: Prove this) 同构`x`，因此我们可以进一步将其重写为：

```
type IndirectBool = forall x . x -> x -> x 
```

只有两个函数可以具有上述类型：

```
true :: a -> a -> a
true a _ = a

false :: a -> a -> a
false _ a = a 
```

由于同构，我们可以保证所有 Church 编码将具有与原始数据类型的可能值一样多的实现。因此，恰好有两个函数存在于其中并非巧合，`IndirectBool`就像 恰好有两个构造函数一样`Bool`。

但是我们如何在我们的 ? 上进行模式匹配`IndirectBool`？例如，对于普通的`Bool`，我们可以只写：

```
expression1 :: a
expression2 :: a

case someBool of
    True  -> expression1
    False -> expression2 
```

好吧，我们的`IndirectBool`它已经带有解构自身的工具。我们只想写：

```
myIndirectBool expression1 expression2 
```

请注意，如果`myIndirectBool`是`true`，它将选择第一个表达式，如果是`false`，它将选择第二个表达式，就像我们以某种方式对其值进行了模式匹配一​​样。

让我们尝试对`IndirectEither`. 使用普通的`Either`，我们会写：

```
f :: a -> c
g :: b -> c

case someEither of
    Left  a -> f a
    Right b -> g b 
```

有了`IndirectEither`，我们只需要写：

```
someIndirectEither f g 
```

简而言之，当我们以延续传递风格编写类型时，延续就像 case 构造的 case 语句，所以我们所做的就是将每个不同的 case 语句作为参数传递给函数。

这就是您不需要`Eq`对类型进行模式匹配的原因。在 lambda 演算中，类型决定它“等于”什么，只需定义它从提供给它的参数中选择哪个参数。

因此，如果我是，我通过始终选择我的第一个参数`true`来证明我是“平等的” 。`true`如果我是 a ，我通过总是选择我的第二个参数`false`来证明我是“平等的” 。`false`简而言之，构造函数“相等”归结为“位置相等”，它总是在 lambda 演算中定义，如果我们可以将一个参数区分为“第一个”，另一个作为“第二个”，这就是我们所需要的“比较”构造函数的能力。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-18T19:59:32.800

首先，`match`实际上`match3`是完全相同的（忽略不同的字符串）：函数中的模式匹配被取消为 case 语句。

接下来，模式匹配适用于*构造函数*，而不是任意值。模式匹配内置于语言中，不依赖于布尔表达式——它只是直接作用于构造函数。这在包含一些可匹配术语的更复杂的匹配中最为明显：

```
f :: MyType -> Int
f (A a) = a + 1
f (B a b) = a + b 
```

您将如何将这些模式重写为布尔表达式？你不能（不知道其他任何事情`MyType`）。

相反，模式匹配只是通过构造函数进行。每个模式都必须以构造函数为首——你不能像`f (a b c)`在 Haskell 中那样编写模式。然后，当函数获得一个值时，它可以查看该值的构造函数并立即跳转到适当的情况。这是它必须为更复杂的模式（如`A a`）工作的方式，也是它为您使用的简单模式工作的方式。

由于模式匹配只是通过转到适当的构造函数来工作，它根本不依赖`Eq` *于*. 您不仅不必有一个`Eq`实例来进行模式匹配，而且拥有一个实例也不会改变模式匹配的行为方式。例如，试试这个：

```
data MyType = TypeA | TypeB | TypeC

instance Eq MyType where 
  TypeA == TypeA = True
  TypeB == TypeC = True
  TypeC == TypeB = True
  _ == _         = False

match :: MyType → String
match TypeA = "this is type A"
match TypeB = "this is type B"
match TypeC = "this is type C"

match2 :: MyType → String
match2 a | a == TypeA = "this is type A matched by equality"
         | a == TypeC = "this is type B matched by equality"
         | a == TypeB = "this is type C matched by equality"
         | otherwise = "this is neither type A nor type B" 
```

现在您已经定义了`TypeB`等于`TypeC`但不等于自身的相等性。（在现实生活中，您应该确保相等行为合理并遵循自反属性，但这是一个玩具示例。）现在，如果您使用模式匹配，`TypeB`仍然 match`TypeB`和`TypeC`matches `TypeC`。但是如果你使用你的保护表达式，`TypeB`实际上 match`TypeC`和`TypeC`matches `TypeB`。`TypeA`两者之间没有变化。

此外，请注意如何*使用*模式匹配`Eq`定义实例。当您使用子句时，它的定义方式与编译时生成的代码类似。所以模式匹配比——它是语言的一部分，而它只是标准库的一部分。*`deriving``Eq``Eq`*

 *总而言之：模式匹配内置在语言中，通过比较构造函数然后递归匹配其余值来工作。平等通常是根据模式匹配来实现的，它比较整个值而不仅仅是构造函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-18T19:57:29.533

您缺少的是 Haskell 中的构造函数可以有参数。类型标签“它们自己”可通过相等性进行比较（至少在内部，在幕后），但只有当组成参数也可比较时，完整值才可比较。

所以如果你有这样的类型

```
data Maybe a = Nothing | Just a 
```

那么即使您可以测试类型标记是“Nothing”还是“Just”（即；模式匹配可能的值），通常您也无法比较完整的可能，除非“a”类型的值是持有的Just也恰好是可比的。

```
--note that your first and third examples are
--just syntactic sugar for each other...
matchMaybe mb = case mb of
    Nothing -> "Got a Nothing"
    Just _  -> "Got a Just but ignored its value" 
```

现在也应该清楚为什么不可能为 Maybes 编写 match2 的变体。在 Just 案例中，您将使用什么来测试相等性？

```
matchMaybe_2 mb | mb == Nothing = "Got a Nothing"
                | mb == Just {- ??? -} = "This case is impossible to write like this" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T02:05:27.177

在我看来，模式匹配基本上是按位相等。它基于类型，而不是一些抽象的价值概念。

但是请记住，您应该将 say`Int`视为

```
data Int = ... | -2 :: Int | -1 :: Int | 0 :: Int | 1 :: Int | 2 :: Int | ... 
```

所以在某种程度上，每个整数都有不同的类型。

这就是为什么你可以匹配`Int`say `2`。

`Eq`更进一步，它允许您将可能不是按位相同的事物设置为相等。

例如，您可能有一个存储已排序元素的二叉树。说以下内容：

```
 A       A
 / \     / \
B   C   B   D
     \   \
      D   C 
```

可能被 视为相等`Eq`，因为它们包含相同的元素，但您无法在此处使用模式匹配检查相等性。

但是在数字的情况下，按位相等基本上与逻辑相等相同（可能除了正浮点和负浮点`0.0`），所以这里`Eq`和模式匹配几乎是等价的。

* * *

与 C++ 类比，将`Eq`as`operator==`和模式匹配视为`memcmp`. 您可以简单地使用 比较许多类型的相等性`memcmp`，但如果它们可以对“相等”值有不同的表示，则不能比较一些类型。*

# android - 覆盖的图像蒙版在摩托罗拉 Xoom（android 4.0.4）上不起作用

> ID：11089661
> 
> 赞同：0
> 
> 时间：2012-06-18T19:26:22.587
> 
> 标签：android, css

我正在测试我们的网站，发现在 android 4.0.4 中，图像不再被正确屏蔽。

由于弹出图像没有应用蒙版，因此它被深色背景覆盖。

这似乎是相关的 CSS 代码，它是从“查看大图”链接触发的。任何帮助解决此问题将不胜感激：

```
 .overlay {
  background:none;
  display:none;
  position:absolute;
  z-index:9999999;
  text-align:left;
  font-size:11px;
  color:#565656;
  font-family:Arial, Helvetica, sans-serif;
  -moz-box-shadow: 3px 3px 10px #000;
  -webkit-box-shadow: 3px 3px 10px #000;
  box-shadow: 3px 3px 10px #000;
  }

.overlay #close-overlay {
width:62px;
height:30px;
cursor:pointer;
position:absolute;
background: url(../wwwasmeorg/media/images/button-close-overlay.gif) 10px 0px no-repeat #000;
font-size:12px;
color:#fff;
top:-30px;
right:0px;
line-height:30px;
padding-left:40px;
    }

   .overlay #overlay-img {
   }

   .overlay .caption {
padding:10px 0px;
color:#fff;
opacity:.8;
font-size:13px;
background:#242424; 
    }

   .overlay .caption p {
padding:0 7px;  
   }

   .overlay .cart-overlay {
background:#fff;
float:left;
padding:35px 40px 40px 40px;
width:380px;
font-size:16px;
line-height:21px;
text-align:center;
    }

   .overlay .cart-overlay .buttons {
margin-left:40px;
_margin-left:20px;
margin-top:30px;
    }

   .overlay .cart-overlay .buttons .blue-button {
margin-right:15px;  
    }

   .overlay .cart-overlay.error .buttons .blue-button {
margin-left:120px;  
_margin-left:60px;
    }

   .overlay .cart-overlay .buttons .green-button {
margin-top:-4px;
    }

    #overlay-landing.overlay {
    background:#000;
    opacity:.6;
    }

    #overlay-blocker {
    background:#000000;
    left:0;
    opacity:0.7;
    position:absolute;
    top:0;
    width:100%;
    z-index:999999;
    }

    #overlay-blocker iframe {
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    filter : alpha(opacity = 0);
    z-index: 9999;
    }

    #overlay-blocker {
    filter: alpha(opacity = 70);
    }

    #overlay-blocker #overlay-loading {
background:url(../wwwasmeorg/media/images/ajax-loader.gif) 0px 0px no-repeat;
height:16px;
width:16px;
position:absolute;  
    }

    #overlay-content {
    position:relative;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:49:53.210

据我了解，Android 4.0.4 对 CSS3 Image Masks 的支持很差。您的 CSS 可能根本没有问题。

# asp.net-mvc-3 - MVC 强类型视图在同一项目的命名空间中找不到我的模型

> ID：11089662
> 
> 赞同：1
> 
> 时间：2012-06-18T19:26:23.547
> 
> 标签：asp.net-mvc-3, namespaces, strongly-typed-view

尝试使用强类型视图打开 ASP.NET MVC3 网站时出现以下错误。

```
Compiler Error Message: CS0234: The type or namespace name 'Survey' does not exist in the namespace 'MyWeb.Models' (are you missing an assembly reference?)
public class _Page_Views_Home_Survey_cshtml : System.Web.Mvc.WebViewPage<MyWeb.Models.Survey> { 
```

笔记：

*   我在解决方案中只有一个项目。
*   MyWeb.Models.Survey 存在并且是公开的。
*   在我的 Survey.cshtml 文件中，我可以完全访问智能感知。
*   非强类型工作的页面会找到。
*   在我的网络配置中，我有以下内容：

```
    <页面>
    <命名空间>
    ...
    <add namespace="MyWeb.Models"/>
    </命名空间>
    </pages>

```

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:01:13.280

我通过创建一个新项目并将所有文件复制到新项目中解决了这个问题。某处的 web.config 中可能有一些东西，或者其他一些东西在此过程中被遗忘了。如果其他人有更简单的解决方案，我会保持打开状态，但如果其他人遇到同样的问题，这个解决方案对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-24T06:57:30.713

我通过删除 .edmx 文件（包括删除连接字符串）然后再次读取它们来解决这个问题。

# mongodb - 检查运行 MongoDB map reduce 作业的状态

> ID：11089664
> 
> 赞同：1
> 
> 时间：2012-06-18T19:26:27.647
> 
> 标签：mongodb, mapreduce

如何检查 Mongo DB 中运行 map reduce 作业的状态？我的代码可以运行 Mongo map reduce 作业，但我想要一个状态表，将作业列为“进行中”或“完成”。如何从 Mongo DB 获取这些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-02T17:47:12.743

您可以使用 db.currentOp() 查询所有正在运行的作业。

通常，Map/Reduce 作业有一些您可以查询的属性。

我刚刚运行的 AM/R 工作有以下统计数据：

```
"opid" : 258101377,
"active" : true,
"secs_running" : 4638,
"op" : "query",
"ns" : "<database>.<collectionname>",
"query": {
    "mapreduce": "<collectionname>",
    "map": function <randomname>() { ... },
    "reduce": function <randomname>(k, v) { ... },
    "out": { ... }
}
"msg":  "m/r: (1/3) emit phase 1235099/11558528 10%",
"progress" : {
    "done" : 1235099,
    "total" : 11558528
},
... 
```

这就是你应该寻找的！特别是“msg”属性，它表示 M/R 的进展情况。

# ruby-on-rails - Rails - 对 AJAX 和非 AJAX 请求使用相同的表单部分

> ID：11089667
> 
> 赞同：6
> 
> 时间：2012-06-18T19:26:38.783
> 
> 标签：ruby-on-rails, ajax

我有一个部分表格，我在两个地方使用来添加新成分（在食谱应用程序中）。当我第一次构建应用程序时，我希望用户能够在填写新食谱卡时添加新成分。我使用了模态弹出窗口和 AJAX，所以新的成分表单会弹出并完成，当单击提交按钮时，一些 jQuery 会隐藏模态框并更新页面上的一些选项标签。

从配方表格中，我将成分称为部分使用`<%= link_to 'New ingredient', new_ingredient_path, :remote => true %>`。我的成分 new.html.erb 文件仅包含对部分的调用：

```
<%= render 'form' %> 
```

_form.html.erb 看起来像：（为简洁起见，其他字段被剪掉）

```
<%= form_for @ingredient, :remote => true do |f| %>
    <%= render 'shared/ingredient_error_messages' %>
    <div class="field">
        <%= f.label :name %>
        <%= f.text_field :name %>
    </div>
    <div class="field">
        <%= f.label :amount %>
        <%= f.text_field :amount%>
    </div>
    <div class="actions">
        <%= f.submit "Save ingredient" %>
    </div>
<% end %> 
```

我的问题是我现在希望用户也能够从网站的成分部分创建新成分。由于我不需要站点的该部分的模态框和 jQuery 功能，我宁愿将其视为普通 HTML 请求。但是，我不知道如何按需“关闭”AJAX 功能，或者这是否是一种好的做法。

我想在新成分表单的链接中传递一个参数，并使用它来控制表单中的 :remote 属性。这里的最佳做法是什么？理想情况下，一种从链接控制表单远程属性的方法，允许我将 AJAX 保留在一个位置并在另一个位置使用 HTML。我可以轻松地将表单复制为非 AJAX 版本并调用它，但这不是很干燥......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T20:01:03.060

怎么样简单：

```
<%= form_for @ingredient, :remote => request.xhr? do |f| %> 
```

# java - junit 测试 - 类型不匹配：无法从 void 转换为布尔值

> ID：11089671
> 
> 赞同：1
> 
> 时间：2012-06-18T19:27:01.217
> 
> 标签：java, junit

我有以下测试 -

```
public void testStore() throws ItemNotStoredException {
    Boolean result = itemSrvc.storeItem(items);
    Assert.assertFalse(result);
        } 
```

但我收到错误类型不匹配：无法从 void 转换为布尔值。

它在测试什么...

```
public void storeItem(Items items) throws ItemNotStoredException {
    try { 
        ObjectOutputStream output = new
                ObjectOutputStream (new FileOutputStream ("itemdatabase"));

        output.writeObject(items);
        output.flush();
        output.close();
    } catch (IOException e) {
        throw new ItemNotStoredException ("Unable to store file", e);
    }

} 
```

澄清一下 - 我不希望 storeItem 返回任何东西，我只是想测试它，所以也许我的测试本身就是错误的。如果是这种情况，任何有关如何修复测试的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:29:42.240

`storeItem()`有`void`返回类型，但代码试图将其分配给`Boolean`: 这是非法的。

可能的测试重组（假设没有例外）：

```
public void testStore()
{
    try
    {
        itemSrvc.storeItem(items);
    }
    catch (ItemNotStoredException e)
    {
        Assert.fail("storeItem() failure: " + e.getMessage());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:29:46.330

的返回类型`storeItem()`是`void`，这是您要捕获的`Boolean result`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T19:29:11.847

storeItem 不返回任何内容，但您正在分配一个布尔值作为该函数的结果。

您需要从 storeItem 方法返回一个布尔值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-18T19:29:30.130

请注意，您正在对返回 void（无）但试图将此结果存储在布尔值中的方法进行方法调用！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-18T19:32:35.923

回答基本问题：

您必须阅读该文件。

或者，更好的是，注入输出流，以便您可以在测试中定义它，然后直接读取对象流。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-18T19:33:14.330

如果您想在保存失败时测试这种情况，并假设如果保存失败应该抛出异常，那么您可以将测试更改为如下所示：

```
@Test(expected= ItemNotStoredException.class) 
public void testStore() throws ItemNotStoredException {
    itemSrvc.storeItem(items);
} 
```

或者，如果您使用的是旧版 JUnit：

```
public void testStore() throws Exception {
    try {
        itemSrvc.storeItem(items);
        Assert.fail();
    }
    catch (ItemNotStoredException e) {
    }
 } 
```

# facebook - 为同一 URL 创建了多个 Facebook ID

> ID：11089672
> 
> 赞同：1
> 
> 时间：2012-06-18T19:27:06.760
> 
> 标签：facebook, facebook-graph-api

我的问题是关于为同一个 URL 创建多个 FB ID。例如：

如果我去 graph.facebook.com?ids=http://www.imdb.com/title/tt0981324/ 我得到这个 ID：

289135387789014

但是，如果我单击该 IMDb 页面上的 Like 按钮（或者即使我在 fb:like 链接中使用该 URL 在外部页面上创建一个新的 Like 按钮），那么实际显示在我的 Like 列表中的 ID 是：

318006948223183

在图表末尾使用这些 ID，如下所示：graph.facebook.com/318006948223183 或 graph.facebook.com/289135387789014 会显示不同的数据，但两者都有完全相同的 URL。

当有人点击该 URL 的 FB Like 按钮时，只有 SECOND ID 真正被点赞。但是，当您通过执行 graph.facebook.com/?ids=http://www.imdb.com/title/tt0981324/ 查找该 URL 的信息时，只会显示 FIRST

所以我的问题是 - 我如何确保获得具有多个关联 FB ID 的 URL 的正确 ID。我需要能够查找 URL 以找到 ID，然后确保当有人单击“赞”按钮时，我的 ID 实际显示在“赞”列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T17:26:59.987

您的 IMDB 电影的 Like 按钮的 href 参数中有一个 # 符号。由于页面 URL 和 Like 按钮 href URL 之间存在差异，因此创建了两个不同的 Open Graph 对象。与您的 Like 事件相关联的图形 ID 对应于 Like 按钮的 href 参数中的 URL。请注意，“og:url”或“Canonical URL”只是将显示在 Facebook 新闻故事中的链接，并且可以与多个不同的图形项目相关联。

这是不带 # 符号的 URL 的图形 API 数据（显示 1 个赞）：http: [//developers.facebook.com/tools/explorer?method=GET&path=%3Fids%3Dhttp%3A%2F%2Fwww.imdb。 com%2Ftitle%2Ftt0981324%2F](http://developers.facebook.com/tools/explorer?method=GET&path=%3Fids%3Dhttp%3A%2F%2Fwww.imdb.com%2Ftitle%2Ftt0981324%2F)

这是带有 # 符号的 URL 的图形 API 数据（显示 575 个共享）：http: [//developers.facebook.com/tools/explorer?method=GET&path=%3Fids%3Dhttp%3A%2F%2Fwww.imdb。 com%2Ftitle%2Ftt0981324%2F%23](http://developers.facebook.com/tools/explorer?method=GET&path=%3Fids%3Dhttp%3A%2F%2Fwww.imdb.com%2Ftitle%2Ftt0981324%2F%23)

通常，您可以使用 Graph API Explorer 或通过执行 FQL 查询从 URL 中检索图形 ID：SELECT url, id, type, site FROM object_url WHERE url = "http://www.imdb.com/title/ tt0981324/#"

但是，对于带有 # 符号的 URL，这些工具将仅返回有限的图形信息，因为没有 Open Graph 元标记与该特定 URL 关联，因此图形对象未完全初始化。因此，在 Like 列表中查找对象的现有解决方案可能是查找与 Like 事件相关的特定图形 ID 的最佳选择。

但即使 ID #318006948223183 与 Like 事件相关联，ID #289135387789014 也是与规范 URL 相关联的 ID（不带 # 符号），并且包含页面的所有最重要的元内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:40:38.867

这可能是相关的：[https ://developers.facebook.com/bugs/258471964213573?browse=search_4eeb62f1008762435910806](https://developers.facebook.com/bugs/258471964213573?browse=search_4eeb62f1008762435910806)

您获得的第一个 ID 可能是站点本身的图形节点，而第二个 ID 是相关电影项目的图形节点。您会注意到您提供的两个 URL 中的数据*并不*相同；一种是“未知”类型，另一种是“电影”类型。

# html - 在查询中需要一个日期选择器，例如在 jQuery 中使用的酒店网站

> ID：11089673
> 
> 赞同：0
> 
> 时间：2012-06-18T19:27:14.497
> 
> 标签：html, jquery-ui, datepicker

我需要帮助，因为我正在尝试创建像[http://www.strandpalacehotel.co.uk/](http://www.strandpalacehotel.co.uk/)这样的预订系统，但是我没有从头开始编写代码的知识，所以有人知道我在哪里可以找到插件吗？

我需要： -Date From -Date To -Nights（更新日期）-Adults

我能找到的只是日期选择器，但没有自动更新 Nights 字段。请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:32:19.590

jQuery UI 有一个非常普遍的日期选择器（[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)）。那里还有许多其他小部件，您可能会发现它们也很有用。

# asp.net - 使用 EntityDataSource 和 DetailsView 插入多个表

> ID：11089675
> 
> 赞同：1
> 
> 时间：2012-06-18T19:27:50.410
> 
> 标签：asp.net, entity-framework-4, entity-framework-4.1

在我的新站点中，我正在使用 edmx 文件和实体数据源从正常的 n 层设置过渡到实体框架站点。我有一个 SiteUsersAdd.aspx 页面，这是标记...

```
<asp:EntityDataSource ID="SiteUserDataSource" runat="server" 
                ContextTypeName="NutritionBridgeModel.NutritionBridgeEntities" 
                EnableFlattening="False" EntitySetName="SiteUsers" EnableInsert="True" 
                Include="Person" ConnectionString="name=NutritionBridgeEntities" 
                DefaultContainerName="NutritionBridgeEntities" >
            </asp:EntityDataSource>
            <asp:EntityDataSource ID="DataUserTypes" runat="server" 
                ConnectionString="name=NutritionBridgeEntities" 
                DefaultContainerName="NutritionBridgeEntities" EnableFlattening="False" 
                EntitySetName="SiteUserTypes" Select="it.[SiteUserTypeID], it.[Description]">
            </asp:EntityDataSource>
            <asp:EntityDataSource ID="DataSubscriptionTypes" runat="server" 
                ConnectionString="name=NutritionBridgeEntities" 
                DefaultContainerName="NutritionBridgeEntities" EnableFlattening="False" 
                EntitySetName="SubscriptionTypes" 
                Select="it.[Description], it.[SubscriptionTypeID]">
            </asp:EntityDataSource>

            <asp:DetailsView ID="detailsInsertSiteUser" runat="server" AutoGenerateRows="False" DataSourceID="SiteUserDataSource" DefaultMode="Insert" CssClass="standardTable" >
                <Fields>
                    <asp:BoundField DataField="FirstName" HeaderText="First Name" ReadOnly="True" HeaderStyle-CssClass="rowHeader" SortExpression="FirstName"  ControlStyle-CssClass="standardTextbox" />
                    <asp:BoundField DataField="LastName" HeaderText="Last Name" ReadOnly="True" HeaderStyle-CssClass="rowHeader" SortExpression="LastName" ControlStyle-CssClass="standardTextbox" />
                    <asp:BoundField DataField="Email" HeaderText="Email" ReadOnly="True" HeaderStyle-CssClass="rowHeader" SortExpression="Email" ControlStyle-CssClass="standardTextbox" />
                    <asp:BoundField DataField="Password" HeaderText="Password" ReadOnly="True" HeaderStyle-CssClass="rowHeader" SortExpression="Password" ControlStyle-CssClass="standardTextbox" />
                    <asp:TemplateField HeaderText="User Type" SortExpression="UserTypeID" HeaderStyle-CssClass="rowHeader">
                        <InsertItemTemplate>
                            <asp:DropDownList ID="DropDownList1" runat="server" 
                                DataSourceID="DataUserTypes" DataTextField="Description" 
                                DataValueField="SiteUserTypeID" CssClass="standardDropdown">
                            </asp:DropDownList>
                        </InsertItemTemplate>
                    </asp:TemplateField>
                    <asp:CheckBoxField DataField="Active" HeaderText="Active" ReadOnly="True" HeaderStyle-CssClass="rowHeader" SortExpression="Active" />
                    <asp:TemplateField HeaderText="Subscription Type" HeaderStyle-CssClass="rowHeader" SortExpression="SubscriptionTypeID">

                        <InsertItemTemplate>
                            <asp:DropDownList ID="ddlSubscriptionTypes" runat="server" 
                                DataSourceID="DataSubscriptionTypes" DataTextField="Description" 
                                DataValueField="SubscriptionTypeID" CssClass="standardDropdown">
                            </asp:DropDownList>
                        </InsertItemTemplate>

                    </asp:TemplateField>
                    <asp:CheckBoxField DataField="TestAccount" HeaderText="Test Account" HeaderStyle-CssClass="rowHeader" ReadOnly="True" SortExpression="TestAccount" />
                    <asp:CommandField ShowInsertButton="True" ControlStyle-CssClass="standardButton" ItemStyle-CssClass="submitArea" />
                </Fields>
            </asp:DetailsView> 
```

我有一个 people 表和一个 siteusers 表：

人员：PersonID、FirstName、LastName SITEUSERS：SiteUserID、PersonID 等。

所以当我创建一个新的 SITEUSER 时，我也想创建一个新的 PERSON。有没有一种优雅的方法可以使用我的 entitydatasource 来做到这一点？它需要在后面的代码中吗？如果是这样，那看起来像什么？到目前为止，我假设如果它在后面的代码中，它需要是这样的......

```
 Protected Sub detailsInsertSiteUser_ItemInserting(sender As Object, e As System.Web.UI.WebControls.DetailsViewInsertEventArgs) Handles detailsInsertSiteUser.ItemInserting
        NutritionBridgeContext = New NutritionBridgeEntities

        'insert new person
        Dim intPersonID As Integer = 0

        'use the generated identity field to insert into SiteUser record
        e.Values("PersonID") = intPersonID
    End Sub 
```

# java - 应该如何打包/部署 ESB？

> ID：11089676
> 
> 赞同：9
> 
> 时间：2012-06-18T19:27:52.283
> 
> 标签：java, architecture, soa, apache-camel, esb

我正试图围绕 Apache Camel，它似乎是一个轻量级 ESB。如果我正确理解 Camel/ESB，那么您可以将 Camel Route 视为节点和边的图。每个节点都是路由上的一个端点（可以消费/产生消息）。每条边都是两个不同端点（1 个生产者和 1 个消费者）之间的路由。

假设这是正确的，我有一个实际问题：最佳实践对部署应用程序的 ESB/Camel Route 有什么要求？我应该将它打包为自己的 JAR，还是值得成为自己的 EAR，里面装满了 EJB、Web 服务和其他 JAR？

我想我在问应该如何部署/构建 Camel Route 或 ESB，例如：

```
my-esb.ear/
    ejb1.jar/
        MyEJB_1.class
    ejb2.jar/
        MyEJB_2.class
    webservice.war/
        MyWebService.class 
```

或者...

```
my-esb.jar/
    MyEJB_1.class
    MyEJB_2.class
    MyWebService.class 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T07:23:39.510

据我了解，有几种方法可以运行 Camel。

1.  **嵌入到 Java 应用程序中**：您可以将 Camel 嵌入到独立的 Java 应用程序中。在这种情况下，您将在您的应用程序中启动一个 Camel 上下文，它将启动路由等。当您的应用程序需要与服务等进行通信时，这非常有用。为此，您需要为组件部署 Camel 和第三方 jars类路径。

2.  **嵌入 Web 应用程序**：正如人们已经指出的那样，这似乎是一种流行的选择。Camel jars 和第三方 jars 被包装在一个 WAR 文件中，并且基本上部署到一个 Web 容器（例如 Tomcat）来托管 Camel 服务。

3.  **嵌入应用程序服务器**：我读过一些关于如何将 Camel 部署到 JBoss 等应用程序服务器的文章，我什至读过有关部署到 Glassfish 的人的文章。这似乎与您部署到 Tomcat 的方式非常相似。JBoss 有一些你需要解决的类加载问题，这使得它变得棘手。所以是的，您可以通过 WAR 路由部署到应用程序服务器。

4.  **部署到 OSGi**：您可以相对快速地将 Camel jar 制作成 OSGi 包，然后部署到 OSGi 框架，例如 Apache Felix。将 jar 转换为适当的 OSGi 包然后部署相对简单。这里的一个大问题是某些第三方可能没有 OSGi 兼容的捆绑包供您部署。

我个人的偏好是 OSGi 路线。它既简单又轻量，允许我将我的骆驼路由托管为持久服务（即 Window 服务、Unix Deamon），占用空间非常小。

您现在应该意识到 Apache Camel 可以通过多种方式进行部署，您可以自行决定如何进行部署。我花了一段时间才了解如何部署 Camel，因为我必须使用不同的部署模型才能对它有一个好的感觉。我唯一没有接触过的是部署到应用服务器，因为我觉得这些服务器中的大多数都足够重了。

就架构而言，我喜欢将不同的路由/应用程序保存在不同的 jar 中。由于我使用的是 OSGi，因此我希望能够更新特定路由并进行部署，而无需重新部署所有内容。如果您将所有内容部署在一个 jar 中，您将需要重新构建世界并重新部署该 jar。但是，这是个人喜好，您的里程可能会有所不同

希望这个对你有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T18:19:00.747

让我一一回答您的问题：

> 提供一个描述性的、非模糊的一般因素列表，应用于确定如何最好地部署 ESB（作为单个 EAR，每个端点都是嵌入式 JAR 或作为单个“整体”JAR）；

嵌入式或单体 jar 无关紧要。重要的是捆绑或战争部署。在**独立**包的情况下，您最终可能会得到一个非常胖的部署存档，其中包含大量用于依赖解析的 jar。

> 充分解释为什么 Camel 不能很好地与 JBoss 或 GlassFish 等 Java EE 应用服务器配合使用

1.  App-Server/Container 的线程/资源/端口管理可能会施加限制。

2.  常用库版本冲突

3.  ClassLoading 机制冲突

从逻辑上讲，如果您的容器支持 OSGi，那么 Camel 应该不会遇到任何问题。

1.  由于 Apache Camel 是一个非常轻量级的消息路由器，因此您绝对可以将它与您的 Web 应用程序一起打包为一个**war****文件**。如果您使用 maven/Ivy 并且您的 Web 容器支持 osgi，那么 Bingo！生活会轻松很多。
***   第二种选择是将您的应用程序部署为**捆绑包***   另一个是独立的 Java SE jar。**

 **按照下面的链接[虽然，已经过时了]，这些将为您提供有关包装的逐步指导，至少对包装机制有清晰的认识：

[骆驼一步一步](http://camel.apache.org/tutorial-osgi-camel-part1.html)

[Web 应用程序中的骆驼](http://camel.apache.org/tutorial-on-using-camel-in-a-web-application.html)

[OSGi 环境中的 Camel Real Life 打包和部署](http://camel.apache.org/tutorial-osgi-camel-part2c.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T16:28:19.583

与其他答案一样，这取决于您的需求，但 ESB 通常是不同集成过程的组合，它们不一定共享相同的生命周期。

如果您遇到这种情况，我建议您使用`jar`按集成流程的方法。这样，您可以为每个不同`jar`的开发生命周期提供不同的开发生命周期，并且您可以向您的客户保证，除了其中的代码之外，您没有接触过任何代码`jar`。

这并不意味着您必须采用`ear`解决方案。您可以将不同进程的代码完美地打包在一个`war`文件中，而不会产生`ear`开销。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T03:48:13.257

这取决于您的需求。没有比这更好的真理答案了。

Camel 可以适应您现有的基础架构和运行时平台。因此，使用 Camel 嵌入您的应用程序，以该平台可以执行的方式以及您想要的方式进行打包。

例如，要在 Web 应用程序 (WAR) 中使用 Camel，您可以查看此链接：[http ://camel.apache.org/tutorial-on-using-camel-in-a-web-application.html](http://camel.apache.org/tutorial-on-using-camel-in-a-web-application.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T20:45:28.437

你正在考虑.ear嵌入，我明白了。

我建议您在将 Camel 嵌入到功能齐全的 Java EE 服务器中时三思而后行。这当然是可行的，但是您将需要做一些工作来连接它们（使用 commonJ、WorkManagers、JNDI 引用等）。具体来说，让 Camel 处理线程是一大优势。

将 Camel 嵌入 spring web-app (.WAR) 我个人最喜欢在 Jetty 或 Tomcat 中部署。然后你可以访问一个像样的 servlet 容器，一个可以做一些事情的运行时，等等。

实际上，我在一些带有嵌入式 Camel 的生产环境中使用了 ActiveMQ 的标准下载，更多的是用于适配器目的，而不是 ESB，但是，如果 ActiveMQ 是您的 ESB 的消息传递主干，它可能是一个有效的选择。**

# drupal - Zen Drupal 子主题中的 PHP 警告消息

> ID：11089692
> 
> 赞同：0
> 
> 时间：2012-06-18T19:28:44.513
> 
> 标签：drupal, drupal-zen

在 Drupal 中使用 Zen 子主题时，我收到以下警告。我该如何解决它们？

```
Warning: in_array() [function.in-array]: Wrong datatype for second argument in zen_preprocess_html() (line 111 of sites/all/themes/zen/template.php).
Warning: in_array() [function.in-array]: Wrong datatype for second argument in zen_preprocess_html() (line 112 of sites/all/themes/zen/template.php).
Warning: in_array() [function.in-array]: Wrong datatype for second argument in zen_preprocess_html() (line 113 of sites/all/themes/zen/template.php). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:28:45.167

在子主题的 .info 文件中，添加以下行：

```
settings[zen_html5_respond_meta][] = respond
settings[zen_html5_respond_meta][] = html5
settings[zen_html5_respond_meta][] = meta 
```

我在[http://drupal.org/node/1357538](http://drupal.org/node/1357538)找到了这个解决方法。

# php - 跟踪外部链接点击

> ID：11089694
> 
> 赞同：0
> 
> 时间：2012-06-18T19:28:51.893
> 
> 标签：php, jquery, ajax, internet-explorer

当有人单击链接时，我想通过 ajax 将一些数据发布到文件中。我有以下代码，它适用于除 IE 之外的所有主要浏览器:(

```
 <script type="text/javascript">
        $(document).ready(function() {

           $('a').click(function() {

                $.ajax({

                    url: '<?php echo SITE_URL ?>stats/add_click/',
                    type: 'POST',
                    datatype: 'html',
                    data: {

                        id: $(this).attr('data-id'),
                        ip: '<?php echo $_SERVER['REMOTE_ADDR'] ?>'

                    }

                });

                return true;

           });

        });
    </script> 
```

如何让它在 IE 中工作或调试 IE 的代码？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:37:22.263

尝试使用 ajax 的成功回调来进行重定向。听起来 IE 正在中止请求

```
$('a').click(function() {
            $.ajax({
                url: '<?php echo SITE_URL ?>stats/add_click/',
                type: 'POST',
                dataType: 'html',
                data: {
                    id: $(this).attr('data-id'),
                    ip: '<?php echo $_SERVER['REMOTE_ADDR'] ?>'
                },                  
                success:function(){
                    window.location = this.href;
                }

            });

            return false;

       }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:31:09.630

试试这个...

```
$('a').click(function(e) {
    e.preventDefault();
    ... 
```

# python - 杀死线程困境

> ID：11089697
> 
> 赞同：0
> 
> 时间：2012-06-18T19:29:02.187
> 
> 标签：python, multithreading

我找到了两种方法来实现我的`TerminatableThread`课程。我想问问你对他们每个人的优缺点或意见，有什么不同吗？

第一种解决方案：使用类的`__stop()`私有方法`Thread`：

```
class TerminatableThread(threading.Thread):
    def __init__(self, *args, **argv):
        threading.Thread.__init__(self, *args, **argv)

    def terminate(self):
        threading.Thread._Thread__stop(self) #@UndefinedVariable

    @property
    def should_run(self):
        return threading.Thread.is_alive(self) 
```

第二种解决方案：使用额外的`Event`：

```
class TerminatableThread(threading.Thread):
    def __init__(self, *args, **argv):
        self.__terminated = threading.Event()
        threading.Thread.__init__(self, *args, **argv)

    def terminate(self):
        self.__terminated.set()

    @property
    def should_run(self):
        return not self.__terminated.is_set() 
```

你怎么看？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:34:29.627

对于第一个解决方案：您不应该使用私有方法，因为这可能会改变并且无论如何都是不好的形式。另外，线程不应该被冷停；您应该让该线程内的进程有机会首先进行清理，并自行响应终止请求。

对于第二种解决方案：抽象类在 Python 上比在其他一些语言（如 Java）上不太常见，也不太必要。如果您`TerminatableThread`本身就是线程操作的抽象类，为什么不`terminated`直接将行为添加到它呢？

```
class TerminatableThread(threading.Thread):
    def __init__(self, *args, **argv):
        super.__init__(self, *args, **argv)
        self.terminated = False

    # Note: not actually thread-safe
    def terminate(self):
        self.terminated = True 
```

**编辑：**您删除了“抽象类”提案，但我会使用某种线程安全标志机制。线程事件听起来他们可能会这样做，所以我会选择那个选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:47:58.247

Python 线程也可以用 sys.exit() 关闭，它在线程内与 thread.exit() 相同

```
def nuke(self):
    # set autodestruct, remove thread from stack and exit thread
    global threads
    try:
        threads.remove([self.threadId,self])
    except:
        sys.exit() 
```

# jsf - primefaces 文件上传微缩模型

> ID：11089707
> 
> 赞同：3
> 
> 时间：2012-06-18T19:29:56.337
> 
> 标签：jsf, jakarta-ee, jsf-2, primefaces

我想上传多个文件，但在我执行上传后，微型消失了，我不知道我上传了哪些文件。有没有办法在上传后保留带有名称的缩影？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T09:22:02.933

我想我已经这样做了，但我不确定这是否是你的意思。无论如何..我`<ui:repeat>`用来显示选择的图像。

以下是代码片段：

```
 <p:outputPanel id="imagePreview">
    <ui:repeat value="#{clientController.images}" var="uploadedImages">
         <p:graphicImage value="#{controller.imageSelected}" height="135" width="135" styleClass="images"/>
    </ui:repeat>
</p:outputPanel> 
```

在你的`<p:fileUpload>`.

```
<p:fileUpload id="clientProfile" immediate="true" auto="true" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" fileUploadListener="#{controller.uploadListener}" mode="advanced" multiple="true" update="imagePreview"/> 
```

# linux - 通过 NPM 在 Debian Lenny (5.0) 中安装 Forever - 错误

> ID：11089710
> 
> 赞同：1
> 
> 时间：2012-06-18T19:30:01.970
> 
> 标签：linux, node.js, debian, lenny, forever

我试图通过 NPM 在 Debian Lenny (5.0) 上永久安装，但**我在安装过程中收到以下错误，首先是：**

```
> node-waf configure build

npm ERR! TypeError: options.uid should be a number 
```

我试过用谷歌搜索——但没有任何用处，除了**我偶然发现[这个 pastebin 页面](http://pastebin.com/ZHc831tS)**与其他一些可怜的灵魂也遇到的完全相同的错误。

**那里的任何 Node/forever 人都知道可能出了什么问题？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-26T14:17:45.320

我认为您正在尝试使用旧的 npm 版本进行安装。尝试使用[nvm](https://github.com/creationix/nvm)。

**注意：请使用 curl/wget 命令安装 nvm。**

```
curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash 
```

安装 4+ 节点版本。

```
nvm install v5.11.0
nvm use v5.11.0 
```

所以运行：

```
npm install -g forever 
```

# svn - 将自定义元数据添加到 Subversion

> ID：11089713
> 
> 赞同：0
> 
> 时间：2012-06-18T19:30:11.837
> 
> 标签：svn

我们如何向颠覆分支添加/更新自定义元数据？

例如元数据将是 "July-3-2012" 。日期指示何时应将分支合并到主干

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:34:17.807

您可以使用在目录上`svn propset mergedate July-3-2012 dir`设置一个名为`mergedate`所需值的属性`dir`。

[在手册](http://svnbook.red-bean.com/en/1.2/svn.ref.svn.c.propset.html)中查看更多信息

这实际上意味着您可以[将自定义属性](http://svnbook.red-bean.com/en/1.7/svn.advanced.props.html)** 设置为主干或分支中的任何文件/文件夹。这在很多情况下都非常方便。虽然我不确定您是否可以检测到分支操作，但您也可以尝试使用[钩子脚本](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.reposadmin.create.hooks)自动执行此过程- 它们非常强大，可以为您完成很多工作。

** - 在页面中搜索“自定义修订属性是”，因为没有指向我想与您分享的确切内容的锚链接。

# ssis - 在数据流任务的错误输出中捕获更多信息

> ID：11089715
> 
> 赞同：1
> 
> 时间：2012-06-18T19:30:20.567
> 
> 标签：ssis, dataflow

我创建了一个 SSIS 包

在数据流任务中，我有几列

![在此处输入图像描述](../Images/eb389947a6624ac6aa1c01182c4bc9aa.png)

现在我将第 0 列和第 3 列的数据类型转换为*int*，故意创建一个错误： ![在此处输入图像描述](../Images/62a4fc0884f8851c4f6fb9859676eeed.png)

现在我将错误配置为：

![在此处输入图像描述](../Images/c357e48f982a01f509ae21755c52a312.png)

之后我保留了一个数据查看器并执行了包，毫不奇怪我得到了预期的错误输出：

![在此处输入图像描述](../Images/952218ded6bf805c00da7a83bf66ccdb.png)

我可以看到我还有 3 列

但我的问题是：

1.  错误列是 101 和 73。如何获得正确的列名？
2.  如何将其他信息添加到同一个错误输出表中：包 ID、包名称等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-10-10T09:00:09.110

这在 SS2016 及更高版本中很容易： [https ://www.mssqltips.com/sqlservertip/4066/retrieve-the-column-causing-an-error-in-sql-server-integration-services/](https://www.mssqltips.com/sqlservertip/4066/retrieve-the-column-causing-an-error-in-sql-server-integration-services/)

```
public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    Row.ErrorDescription = this.ComponentMetaData.GetErrorDescription(Row.ErrorCode);
    IDTSComponentMetaData130 componentMetaData = this.ComponentMetaData as IDTSComponentMetaData130;
    Row.ErrorColumnName = componentMetaData.GetIdentificationStringByID(Row.ErrorColumn);
} 
```

对于在 SS2016 之前使用 SQL Server 版本的任何人，这里有几个参考链接，用于获取列名称：

[http://www.andrewleesmith.co.uk/2017/02/24/finding-the-column-name-of-an-ssis-error-output-error-column-id/](http://www.andrewleesmith.co.uk/2017/02/24/finding-the-column-name-of-an-ssis-error-output-error-column-id/)

这是基于： [http ://toddmcdermid.blogspot.com/2016/04/finding-column-name-for-errorcolumn.html](http://toddmcdermid.blogspot.com/2016/04/finding-column-name-for-errorcolumn.html)

我很感激我们不应该只发布链接，但是这个解决方案非常复杂，我试图通过从 Todd 和 Andrew 的博客文章中提取信息并在此处重新创建它们来进行总结。（如果你读过这篇文章，谢谢你们！）

从托德的页面：

> 1.  转到“输入和输出”页面，然后选择“输出 0”节点。将“SynchronousInputID”属性更改为“无”。（这会将脚本从同步更改为异步。）
>     2.  在同一页面上，打开“Output 0”节点并选择“Output Columns”文件夹。按“添加列”按钮。将此新列的“名称”属性更改为“LineageID”。
>     3.  再次按下“添加列”按钮，将“DataType”属性更改为“Unicode string [DT_WSTR]”，将“Name”属性更改为“ColumnName”。
>     4.  转到“脚本”页面，然后按“编辑脚本”按钮。将此代码复制并粘贴到 ScriptMain 类中（您可以删除所有其他方法存根）：

```
public override void CreateNewOutputRows() {
    IDTSInput100 input = this.ComponentMetaData.InputCollection[0];
    if (input != null)
    {
        IDTSVirtualInput100 vInput = input.GetVirtualInput();
        if (vInput != null)
        {
            foreach (IDTSVirtualInputColumn100 vInputColumn in vInput.VirtualInputColumnCollection)
            {
                Output0Buffer.AddRow();
                Output0Buffer.LineageID = vInputColumn.LineageID;
                Output0Buffer.ColumnName = vInputColumn.Name;
            }
        }
    } } 
```

> 随意使用数据查看器将虚拟输出附加到该脚本，看看你得到了什么。从这里开始，它是您 ETL 专家的“标准工程”。只需将失败组件的错误输出与此元数据合并，您就可以将 ErrorColumn 编号转换为有意义的列名。
> 
> 但是对于那些确实想了解上述脚本在做什么的人：
> 
> 1.  它正在获取附加到脚本组件的“第一个”（也是唯一的）输入。
>     2.  它正在获取与输入相关的虚拟输入。“输入”是脚本实际上可以在输入上“看到”的内容 - 由于我们没有将任何列标记为“只读”或“读写”......这意味着输入没有列。但是，“虚拟输入”具有存在的每一列的完整列表，无论我们是否说过我们正在“使用”它。
>     3.  然后我们遍历这个虚拟输入上的所有“虚拟列”，并且对于每一个......
>     4.  获取 LineageID 和列名，并将它们作为我们异步脚本的新行推出。

Andrew 页面中的图像和文本有助于更详细地解释它：

[![在此处输入图像描述](../Images/2453c7ebfc539177e0504d2fb82d09fc.png)](https://i.stack.imgur.com/YrJzL.png)

> 然后将此映射与沿错误路径向下的 ErrorColumn 沿袭 ID 合并连接，以便错误信息可以附加到映射中的列名称。我包含了第二个脚本组件，它从错误代码中查找错误描述，因此我们在上面看到的错误表行包含列名和错误描述。
> 
> 需要解释的剩余组件是条件拆分——这只是为了向创建地图的脚本组件提供元数据。我创建了一个表达式 (1 == 0)，对于“No Rows – Metadata Only”路径，它的计算结果始终为 false，因此没有行会沿着它向下移动。
> 
> 虽然此解决方案确实需要在数据流中插入一些额外的管道，但当确实发生错误时，我们会记录非常有价值的信息。因此，特别是当数据流在生产环境中无人看管地运行时——当我们在设计时没有可用的工具和技术来找出问题所在时——结果日志记录为我们提供了关于问题所在和原因的更精确的信息，与简单地给我们失败的数据并让我们弄清楚它被拒绝的原因相比。

# psexec - 服务无法启动，可能是因为它被禁用，或者因为它没有与之关联的启用设备

> ID：11089718
> 
> 赞同：0
> 
> 时间：2012-06-18T19:30:29.183
> 
> 标签：psexec

我需要使用 PSEXEC 从不同的服务器远程在旧的 Windows Server 2003 SE SP2 上执行脚本。PSEXEC 可在除此旧服务器之外的所有其他服务器上运行。我收到以下错误：无法启动该服务，因为它已被禁用，或者因为它没有与之关联的启用设备。甚至 D:\PSTools>psexec \ALA-SIEBI1P.corp.ad.wrs.com cmd 也会引发错误。

任何帮助将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:45:18.257

在没有看到更多信息的情况下，我将首先删除相关远程主机上的 PSExec 服务。PSExec 实际上在远程主机上创建了一个服务，有时该服务会被破坏。以下是删除它的方法，其中 %1 替换为远程主机名：

```
sc \\%1 delete psexesvc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T14:23:55.627

尝试对 psexec 使用 -e 选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-27T16:29:10.620

删除 PSEXEC 服务并再次运行。

```
Get-Service *psexec* 
```

将向您显示已安装的服务。

```
Remove-Service PSEXESVC 
```

将删除服务

然后...

```
psexec -s -i powershell 
```

应该按预期执行

# ruby-on-rails - 用户模型补丁仅适用于少数请求

> ID：11089725
> 
> 赞同：1
> 
> 时间：2012-06-18T19:31:01.773
> 
> 标签：ruby-on-rails, metaprogramming, ruby-on-rails-plugins, redmine, redmine-plugins

我需要我的 Redmine 插件的补丁，以便为用户模型添加一个新的“has_many”关系。在我以开发模式启动rails服务器后它可以工作一段时间，但是奇怪的是在几个请求后停止工作。

这是我的补丁：

```
require_dependency 'project'
require_dependency 'principal'
require_dependency 'user'

module UserPatch
  def self.included(base) 
    base.extend(ClassMethods)

    base.send(:include, InstanceMethods)

    # Same as typing in the class 
    base.class_eval do
      unloadable # Send unloadable so it will not be unloaded in development
      has_many :favourites

    end

  end

  module ClassMethods

  end

  module InstanceMethods
  end

end

User.send(:include, UserPatch) 
```

这是错误日志：

```
NoMethodError (undefined method `favourites' for #<User:0x007f99cbc3d478>):
  activemodel (3.2.3) lib/active_model/attribute_methods.rb:407:in `method_missing'
  activerecord (3.2.3) lib/active_record/attribute_methods.rb:148:in `method_missing'
  plugins/redmine_asset_tracker/app/controllers/asset_types_controller.rb:20:in `index'
  actionpack (3.2.3) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (3.2.3) lib/abstract_controller/base.rb:167:in `process_action'
  actionpack (3.2.3) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (3.2.3) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
  activesupport (3.2.3) lib/active_support/callbacks.rb:447:in `_run__2420136461919276817__process_action__3214240126008154381__callbacks'
  activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
  activesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.3) lib/abstract_controller/callbacks.rb:17:in `process_action'
  actionpack (3.2.3) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (3.2.3) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
  activesupport (3.2.3) lib/active_support/notifications.rb:123:in `block in instrument'
  activesupport (3.2.3) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (3.2.3) lib/active_support/notifications.rb:123:in `instrument'
  actionpack (3.2.3) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
  actionpack (3.2.3) lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
  activerecord (3.2.3) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (3.2.3) lib/abstract_controller/base.rb:121:in `process'
  actionpack (3.2.3) lib/abstract_controller/rendering.rb:45:in `process'
  actionpack (3.2.3) lib/action_controller/metal.rb:203:in `dispatch'
  actionpack (3.2.3) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
  actionpack (3.2.3) lib/action_controller/metal.rb:246:in `block in action'
  actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:73:in `call'
  actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
  actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:36:in `call'
  journey (1.0.3) lib/journey/router.rb:68:in `block in call'
  journey (1.0.3) lib/journey/router.rb:56:in `each'
  journey (1.0.3) lib/journey/router.rb:56:in `call'
  actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:600:in `call'
  rack-openid (1.3.1) lib/rack/openid.rb:98:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
  rack (1.4.1) lib/rack/etag.rb:23:in `call'
  rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/head.rb:14:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/flash.rb:242:in `call'
  rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
  rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/cookies.rb:338:in `call'
  activerecord (3.2.3) lib/active_record/query_cache.rb:64:in `call'
  activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:467:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
  activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `_run__4577554638097020546__call__1559518111822758715__callbacks'
  activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
  activesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/reloader.rb:65:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.1) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.1) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.3) lib/rails/engine.rb:479:in `call'
  railties (3.2.3) lib/rails/application.rb:220:in `call'
  rack (1.4.1) lib/rack/content_length.rb:14:in `call'
  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
  /Users/myth/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /Users/myth/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /Users/myth/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:36:17.127

Try this:

```
module UserPatch
  def self.included(base) 
    base.extend(ClassMethods)
    base.send(:include, InstanceMethods)
    # Note the change below
    base.unloadable 
    base.has_many :favourites
  end

  module ClassMethods    
  end

  module InstanceMethods
  end

end 
```

You can run the class methods on the class in the `included` section.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T08:10:34.120

会不会是你的模型被重新加载但这个扩展没有？如果您包含模型本身的扩展，会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:47:18.657

您是否使用乘客？如果您使用乘客，可能难以保证何时加载它，加载的对象使用多远等。

[我在这个问题](https://stackoverflow.com/questions/8003576/passenger-migrations-and-class-constants-loaded-from-table)中有类似的问题，我无法得到答案。我也以类似的方式进行了全局变量初始化，似乎不能保证工作。

我解决了我的问题，不依赖于方法外语句执行的时间/次数。

已经给出的答案可以避免部分问题，但就您使用Passenger而言，这并不容易，就我而言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T22:50:30.850

由于这仅在开发环境中不起作用，因此在开发中重新加载类是一个问题。

在你的添加一个配置`config/environments/development.rb`：

```
config.to_prepare do
  load 'user_patch.rb'
end 
```

应确保为每个请求重新加载它。

有了这个，您可能会惊讶于该模块可能在用户中多次包含，要修复它，您可以使用[ActiveSupport::Concern](http://api.rubyonrails.org/classes/ActiveSupport/Concern.html)。

有 2 个问题可能对您有所帮助：

*   [重新打开 gem 提供的 ActiveRecord 模型](https://stackoverflow.com/q/10761059/793002)
*   [Rails 扩展 ActiveRecord::Base](https://stackoverflow.com/q/2328984/793002)

# sql - 内部联接是否排除重复项？

> ID：11089726
> 
> 赞同：-2
> 
> 时间：2012-06-18T19:31:09.323
> 
> 标签：sql, sql-server, sql-server-2008, join

我的查询：

```
 select 
  SUM(payments.paid_amt) as paid_amt, 
  SUM(payments.copay_amt) as copay_amt,
  SUM(payments.CO_INSURANCE_AMT) as co_ins_amt,
  payor_group.PAYOR_GROUP as payor_group,
  DATEPART(MM,accession.XIFIN_LOAD_DATE) as load_month,
  DATEPART(yyyy,accession.XIFIN_LOAD_DATE) as load_year,
  accession.ACCESSION_ID

  from 
  [F_PAYOR_PAYMENTS_monthly] payments

  join D_PAYOR payor
  on payor.PAYOR_ID=payments.PAYMENT_PAYOR_ID

  join D_PAYOR_GROUP payor_group
  on payor.PAYOR_GROUP_KEY=payor_group.PAYOR_GROUP_KEY

  join F_ACCESSION_daily accession
  on accession.ACCESSION_ID=payments.ACCESSION_ID

  where accession.XIFIN_LOAD_DATE between '20120501' and '20120531'

  group by  payor_group.PAYOR_GROUP, DATEPART(MM,accession.XIFIN_LOAD_DATE),
  DATEPART(yyyy,accession.XIFIN_LOAD_DATE),accession.ACCESSION_ID 
```

出于某种原因，它们多次`SUMs`计数相同。`accession.ACCESSION_ID`

当我进行所有这些连接时，我担心我可能`SUMming`多次使用相同的值。

我怎样才能确保我`accession.ACCESSION_ID` 只计算一次？

非常感谢您的帮助和指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:38:25.147

`ACCESSION_ID`您的付款表上可能有多行具有不同付款人组的相同行。由于您还按 payor_group 进行分组，因此您最终会得到多个登录 ID。

但是，我们需要查看一些示例数据才能确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:54:15.910

问题是数据重复。

为了找出`JOIN`导致问题的原因，我会依次评论每一个并检查结果。创建额外数据的原因通常很明显。

如果没有看到数据，这很棘手，但是如果，例如，accession 表中有一个 GeographyKey，而 Payments 表没有，并且如果一个 ACCESSION_ID 出现在两个 GeographyKeys 上，那么在将这些表连接在一起时，您将获得两行数据在 ACCESSION_ID 上。

一种解决方案可能是在您的 OP 中点击查询之前对 #temp 表进行一些初始分组，另一种选择是 CTE，如下所示。

```
;with accession (XIFIN_LOAD_DATE, ACCESSION_ID)
    as 
    (
    select 
        XIFIN_LOAD_DATE
        ,ACCESSION_ID
    from F_ACCESSION_daily
    group by
         XIFIN_LOAD_DATE
         ,ACCESSION_ID
    )
    , payments (PAYMENT_PAYOR_ID, ACCESSION_ID, paid_amt, copay_amt, CO_INSURANCE_AMT)
    as 
    (
    select 
        PAYMENT_PAYOR_ID
         ,ACCESSION_ID
        ,sum(paid_amt) paid_amt
        ,sum(copay_amt) copay_amt
        ,sum(CO_INSURANCE_AMT) CO_INSURANCE_AMT
    from F_PAYOR_PAYMENTS_monthly
    group by
         PAYMENT_PAYOR_ID
         ,ACCESSION_ID
    )
select 
  SUM(payments.paid_amt) as paid_amt, 
  SUM(payments.copay_amt) as copay_amt,
  SUM(payments.CO_INSURANCE_AMT) as co_ins_amt,
  payor_group.PAYOR_GROUP as payor_group,
  DATEPART(MM,accession.XIFIN_LOAD_DATE) as load_month,
  DATEPART(yyyy,accession.XIFIN_LOAD_DATE) as load_year,
  accession.ACCESSION_ID

from 
  payments

  join D_PAYOR payor
  on payor.PAYOR_ID=payments.PAYMENT_PAYOR_ID

  join D_PAYOR_GROUP payor_group
  on payor.PAYOR_GROUP_KEY=payor_group.PAYOR_GROUP_KEY

  join accession
  on accession.ACCESSION_ID=payments.ACCESSION_ID

where accession.XIFIN_LOAD_DATE between '20120501' and '20120531'

group by  
  payor_group.PAYOR_GROUP
  , DATEPART(MM,accession.XIFIN_LOAD_DATE),
  DATEPART(yyyy,accession.XIFIN_LOAD_DATE),accession.ACCESSION_ID 
```

# c++ - Visual Studio，C++，在另一个 DLL 导出类中使用一个 DLL 导出类

> ID：11089729
> 
> 赞同：2
> 
> 时间：2012-06-18T19:31:27.893
> 
> 标签：c++, class, dll, import, export

我正在玩 Visual Studio，但发现了一个我无法理解的错误。我创建了一个导出类的 DLL；如果我创建另一个 DLL 项目并尝试使用第一个 DLL 类作为成员变量，则它不起作用，具体取决于我如何声明它。

这是第一个 DLL 类：

```
class LOCKING_API CCriticalSection {
public:
    CCriticalSection(void);
    ~CCriticalSection(void);
    void Enter(void);
    void Leave(void);
    BOOL TryEnter(void);
private:
    CRITICAL_SECTION CriticalSection;
}; 
```

在第二个 DLL 中：

```
#include "../Locking/Locking.h"

class APPLICATION_API CApplication {
public:
    static CApplication* instance(void);
private:
    CApplication(void);
    static CApplication* pInstance;
    static CCriticalSection CritSect;
}; 
```

如果我尝试编译我会得到错误：

```
Application.obj : error LNK2001: unresolved external symbol "private: static class CCriticalSection CApplication::CritSect" (?CritSect@CApplication@@0VCCriticalSection@@A) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:48:52.663

您可能没有初始化`CApplication`. 在您的一个 cpp 文件中，具有：

```
CCriticalSection CApplication::CritSect; 
```

（当然，对 做同样的事情`pInstance`）

编辑：

另一种可能性是您没有在第二个 DLL 的项目中链接到第一个 DLL 的 lib 文件。如果是这种情况，编译器会看到`CCriticalSection`的声明，但链接器找不到它的实现。请参阅[.Lib 文件作为链接器输入](http://msdn.microsoft.com/en-us/library/ba1z7822.aspx)。

# java - 是否有任何表格可以从 MAC 地址识别设备品牌？

> ID：11089730
> 
> 赞同：3
> 
> 时间：2012-06-18T19:31:38.077
> 
> 标签：java, php, mac-address

我听说可以使用设备的部分 MAC 地址来识别设备的品牌（或至少是 NIC 品牌）。这可能吗？我该怎么做？是否有一张图表列出了最常见的部分 MAC？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T19:36:05.980

是的。您可以从 IEEE 找到它： http: [//standards.ieee.org/develop/regauth/oui/oui.txt](http://standards.ieee.org/develop/regauth/oui/oui.txt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:36:16.883

MAC 地址由 IEEE 分配。[在http://standards.ieee.org/develop/regauth/oui/public.html](http://standards.ieee.org/develop/regauth/oui/public.html)搜索/浏览和下载

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-22T10:58:31.387

如果您正在寻找围绕它的 API，这是正确的解决方案：- [http://www.macvendors.com/api](http://www.macvendors.com/api)

通过简单的 HTTP GET 请求对 MAC 地址供应商进行高性能查找。

希望能帮助到你。谢谢

# php - PHP PDO CRUD 类调用非对象上的成员函数 rowCount()

> ID：11089731
> 
> 赞同：0
> 
> 时间：2012-06-18T19:31:39.957
> 
> 标签：php, pdo

我刚刚开始使用 PDO 来摆脱 mysqli 但遇到了问题。我正在学习教程，我想从数据库中返回一个数组，但出现以下错误：

致命错误：在第 27 行的 C:\xampp\htdocs\phptuts\crud\core\managedb.class.php 中的非对象上调用成员函数 rowCount()

这是我的 managedb.php 类：

```
<?php

class ManageDatabase
{

    public $link;

    function __construct()
    {
        include_once('database.class.php');
        $conn = new database;
        $this->link = $conn->connect();
        return $this->link;
    }

    function getData($table_name, $id=null)
    {
        if(isset($id))
    {
        $query = $this->link->query("SELECT * FROM $table_name WHERE id = '$id' ORDER BY id ASC");
    }
    else
    {
        $query = $this->link->query("SELECT * FROM $table_name ORDER BY id ASC");
    }

    $rowCount = $query->rowCount();
    if($rowCount >= 1)
    {
        $result = $query->fetchAll();
    }
    else
    {
        $result = 0;
    }
    return $result;
}

} 
```

然后我只是使用以下代码来尝试获得响应：

```
<?php

include_once('../core/managedb.class.php');
$init = new ManageDatabase;

$table_name = 'users';
$data = $init->getData($table_name);

print_r($data); 
```

这是我收到错误的时候，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:55:31.703

我想`var_dump($query)`在这`$rowCount = $query->rowCount();`条线之前看看它实际上是什么，因为它显然不是一个对象。我猜它要么是 NULL 要么是空的，因为整体`$this-link->query(<sql statement>);`没有返回你所期望的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T05:29:22.307

有几件事要检查：

从[PHP 手册](http://www.php.net/manual/en/pdostatement.rowcount.php)：

> PDO::query() 返回一个 PDOStatement 对象，如果失败则返回 FALSE。

您需要测试查询是否成功，如果不成功，为什么。您可以使用 PDO 的[`errorInfo`](http://www.php.net/manual/en/pdo.errorinfo.php)功能检查错误：

```
if ($query == false) 
{
    print_r($this->link->errorInfo());
    exit();
} 
```

另一件需要注意的是，`rowCount()`在 PDO 中，从 INSERT / UPDATE / DELETE 类型的语句中返回受影响的行。对于 SELECT，您可能会获得行数，也可能不会。该手册建议使用单独的查询来查找行数，但在您的实例中，如果您从 fetchAll() 得到任何返回，则测试可能会更容易：

```
$result = $query->fetchAll();
if (!empty($result)) 
{
    return $result;
} 
else 
{
    return 0;
} 
```

# javascript - 使用 javascript 和 websockets 显示来自 blob 的图像

> ID：11089732
> 
> 赞同：31
> 
> 时间：2012-06-18T19:31:40.447
> 
> 标签：javascript, html, websocket, blob, filereader

我目前正在开发一个显示由 C++ 服务器发送的图像的 WebSocket 应用程序。我在那里看到了几个主题，但我似乎无法摆脱 Firefox 中的这个错误：

> 图像损坏或截断：data:image/png;base64,[一些数据]

这是我用来显示我的 blob 的 Javascript 代码：

```
socket.onmessage = function(msg) {
    var blob = msg.data;

    var reader = new FileReader();
    reader.onloadend = function() {
        var string = reader.result;
        var buffer = Base64.encode(string);
        var data = "data:image/png;base64,"+buffer;

        var image = document.getElementById('image');
        image.src = data;
    };
    reader.readAsBinaryString(blob);
} 
```

我正在使用我在这个主题上找到的红点图像：[https](https://stackoverflow.com/a/4478878/1464608) ://stackoverflow.com/a/4478878/1464608 Base64 类来自这里：[https ://stackoverflow.com/a/246813/ 1464608](https://stackoverflow.com/a/246813/1464608)

但是我得到的 base64 结果不匹配，Firefox 检索到图像已损坏的错误。

我知道这不是很多信息，但我不知道在哪里看：/任何帮助都非常受欢迎！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-18T23:12:33.997

我认为最干净的解决方案是更改 base64 编码器以直接在 Uint8Array 而不是字符串上操作。

重要提示：为此，您需要将 Web 套接字的 binaryType 设置为“arraybuffer”。

onmessage 方法应如下所示：

```
socket.onmessage = function(msg) {
    var arrayBuffer = msg.data;
    var bytes = new Uint8Array(arrayBuffer);

    var image = document.getElementById('image');
    image.src = 'data:image/png;base64,'+encode(bytes);
}; 
```

转换后的编码器应如下所示（基于[https://stackoverflow.com/a/246813/1464608](https://stackoverflow.com/a/246813/1464608)）：

```
// public method for encoding an Uint8Array to base64
function encode (input) {
    var keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
    var output = "";
    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
    var i = 0;

    while (i < input.length) {
        chr1 = input[i++];
        chr2 = i < input.length ? input[i++] : Number.NaN; // Not sure if the index 
        chr3 = i < input.length ? input[i++] : Number.NaN; // checks are needed here

        enc1 = chr1 >> 2;
        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
        enc4 = chr3 & 63;

        if (isNaN(chr2)) {
            enc3 = enc4 = 64;
        } else if (isNaN(chr3)) {
            enc4 = 64;
        }
        output += keyStr.charAt(enc1) + keyStr.charAt(enc2) +
                  keyStr.charAt(enc3) + keyStr.charAt(enc4);
    }
    return output;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-11-21T12:58:57.440

你可以写得更简单：

```
socket.onmessage = function(msg) {
   var arrayBuffer = msg.data;
   var bytes = new Uint8Array(arrayBuffer);
   var blob = new Blob([bytes.buffer]);

   var image = document.getElementById('image');

   var reader = new FileReader();
   reader.onload = function(e) {
       image.src = e.target.result;
   };
   reader.readAsDataURL(blob);
}; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-19T14:06:49.770

谢谢，效果很好！！

所以我想我会分享我的最终 javascript 代码：

```
var socket = new WebSocket('ws://'+host+':'+port, protocol);
socket.binaryType = 'arraybuffer';

try {
    socket.onopen = function() {
        document.getElementById('status').style.backgroundColor = '#40ff40';
        document.getElementById('status').textContent = 'Connection opened';
    }

    socket.onmessage = function(msg) {
        var arrayBuffer = msg.data;
        var bytes = new Uint8Array(arrayBuffer);

        var image = document.getElementById('image');
        image.src = 'data:image/png;base64,'+encode(bytes);
    }

    socket.onclose = function(){
        document.getElementById('status').style.backgroundColor = '#ff4040';
        document.getElementById('status').textContent = 'Connection closed';
    }
} catch(exception) {
    alert('Error:'+exception);
} 
```

不太明白为什么 blob 版本如此棘手，但这成功了！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-02-10T09:34:02.117

感谢其他答案，我设法通过 websocket 接收 jpeg 图像并将其显示在新窗口中：

```
socket.binaryType = "arraybuffer";                 
socket.onmessage = function (msg) {
    var bytes = new Uint8Array(msg.data);
    var blob = new Blob([bytes.buffer]);
    window.open(URL.createObjectURL(blob),'Name','resizable=1');
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-10-29T16:45:51.113

另一种选择

```
let urlObject;

socket.onmessage = function(msg) {
    const arrayBuffer = msg.data;
    const image = document.getElementById('image');

    if (urlObject) {
        URL.revokeObjectURL(urlObject) // only required if you do that multiple times
    }
    urlObject = URL.createObjectURL(new Blob([arrayBuffer]));

    image.src = urlObject;

}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-01T18:33:51.543

使用 Blob 非常简单：

```
// Small red dot image
const content = new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10, 0, 0, 0, 13, 73, 72, 68, 82, 0, 0, 0, 5, 0, 0, 0, 5, 8, 6, 0, 0, 0, 141, 111, 38, 229, 0, 0, 0, 28, 73, 68, 65, 84, 8, 215, 99, 248, 255, 255, 63, 195, 127, 6, 32, 5, 195, 32, 18, 132, 208, 49, 241, 130, 88, 205, 4, 0, 14, 245, 53, 203, 209, 142, 14, 31, 0, 0, 0, 0, 73, 69, 78, 68, 174, 66, 96, 130]);

document.getElementById('my-img').src = URL.createObjectURL(
  new Blob([content.buffer], { type: 'image/png' } /* (1) */)
);
```

```
Should display a small red dot: <img id="my-img">
```

(1) 它也可以在不指定 MIME 类型的情况下工作。

# php - 使用 PHP 和 cURL 通过 Google 电子表格 API 从 XLS 创建电子表格

> ID：11089733
> 
> 赞同：0
> 
> 时间：2012-06-18T19:31:43.823
> 
> 标签：php, curl, google-spreadsheet-api

我正在尝试使用 PHP 和 cURL 从 Google Drive 中的 XLS 创建一个电子表格。我从 .doc 成功创建了文档，我可以从 .csv 创建电子表格，但是当我尝试从 xls 文件创建文档时，它只是作为“文件”保存在 Google Drives 中，没有预览并且可以选择仅下载它.

我正在使用以下代码来启动可恢复上传：

```
$curl = curl_init();

$upload_href = 'https://docs.google.com/feeds/upload/create-session/default/private/full'; // I'm actually taking the upload href from document listing

curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

$filename = 'MyFile';
$type = 'spreadsheet'; 
$content_type = 'application/msexcel'; // I can use 'text/csv' here to upload csv files     just alright
$body = '<?xml version="1.0" encoding="UTF-8"?><entry xmlns="http://www.w3.org/2005/Atom" xmlns:docs="http://schemas.google.com/docs/2007"><category scheme="http://schemas.google.com/g/2005#kind" term="http://schemas.google.com/docs/2007#'.$type.'"/><title>'.$filename.'</title></entry>';

$headers = array(
"Authorization: GoogleLogin auth=" . $g_auth, //  using ClientLogin
"GData-Version: 3.0",
"Content-Length: ".strlen($body),
"Content-Type: application/atom+xml",
"X-Upload-Content-Type: ".$content_type,
"X-Upload-Content-Length: ".$buffer_size // the size of the spreadsheet to be uploaded
);

curl_setopt($curl, CURLOPT_URL, $upload_href);
curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $body);
curl_setopt($curl, CURLOPT_HEADER, true); 

$response = curl_exec($curl);

// ...
// what follows is the start of resumable upload 
```

Google Spreadsheet API 指向 Google Docs API 关于如何创建电子表格，但 Google Docs API 没有指出任何关于创建电子表格的具体内容。

我想我在这里犯的错误是错误的 ContentType，但我不知道在哪里可以找到 Google API 接受的有效内容类型列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T12:48:42.443

您是否尝试过 mime type as `application/vnd.google-apps.spreadsheet`？它是 Google API 可接受的 MIME 类型

# backup - 备份大文件目录

> ID：11089734
> 
> 赞同：0
> 
> 时间：2012-06-18T19:31:49.777
> 
> 标签：backup, rsync

我需要每周备份一个非常大的文件目录（500+ GB）的建议。（在 LAMP 环境中）

我读过 rsync，但我不确定如何用 CRON 触发它。

另外，有没有人碰巧知道 rsync 中的压缩会缩小文件大小？（假设是 3MB .jpeg）。我只是问，因为我不知道我需要多大的备份服务器。

只要给我指出正确的方向就足够了，我不指望任何人为我做功课。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:36:55.077

不管它是否那么大，都需要一些时间——我会通过 cron 运行压缩作业，然后在 UNIX 上通过 cron 运行压缩文件的大型 'ol robocopy (windows) 或 robocopy 等价物。

您可能想研究一种 RAID 安排来处理这个（特别是 RAID 1）大量数据，因此它不必是“工作”并且是隐式完成的。但是您是否可以实现这可能取决于您的资源和您的情况（您的写入时间会更糟......更糟）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:41:12.813

[这](https://wiki.archlinux.org/index.php/Rsync)是一个 wiki 页面，其中回答了您的大部分问题。

我会阅读整个页面以一次掌握一个概念，但“快照备份”是 rsync-script-to-beat-all-rsync-scripts：它执行类似于 TimeMachine 的备份，其中它执行向后的差异存储及时，非常方便。如果您需要按时间顺序排列但大小最小的备份，这非常有用。

Arch（本 wiki 涵盖的发行版）做了一件非常好的事情，您可以将脚本放到已知位置；您将不得不调整它以将脚本称为 cron 作业。[这](http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/)是对cron的相当全面的介绍。

我还想指出，rsync 的压缩是在*传输*上而不是在*存储*上运行的。备份磁盘上的文件应该相同，但传输所需的带宽可能更少。

# java - Java 中的内存高效 XML 操作

> ID：11089741
> 
> 赞同：1
> 
> 时间：2012-06-18T19:32:31.983
> 
> 标签：java, dom, sax

我们正在实施一个具有两个后端组件的事务系统：

*   组件 A 生成初始 XML 响应
*   组件 B 修改初始响应 XML

生成的 XML 被发送回请求者。由于我们可能会在重负载下执行此操作，因此我想以非常高效的 CPU/内存方式执行此操作。

在严格控制整体内存利用率的同时执行上述操作的最佳方法是什么？

具体来说，我最好对组件 A 的输出进行 DOM 解析并将其传递给组件 B 以在内存中修改吗？有没有更好的方法使用 SAX 来做到这一点，它可能更节省内存？是否有通过 SAX 或 DOM 执行此操作的标准库？

感谢您的任何见解。

-拉吉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:54:03.450

通常，SAX 比 DOM 更节省内存，因为不需要将整个文档加载到内存中进行处理。但是，答案取决于您的“组件 B 修改初始响应 XML”要求的细节。

*   如果每个更改都对它自己的 XML 子树来说是本地的（即，您可能需要来自通向树根的所有节点的数据，而不是兄弟节点的数据），那么 SAX 会更好地工作。
*   如果更改需要引用同级来产生结果，则 DOM 会更好地工作，因为它可以让您避免构建自己的数据结构来存储同级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:35:19.877

将 XSL-T 转换应用于初始 XML 响应的组件 B 上的方面或过滤器可能是完成它的一种简洁方法。内存利用率取决于请求的大小和内存中的实例数。CPU 也将取决于这两个因素。

DOM 要求在修改之前将整个 XML 文档驻留在内存中。如果只是需要更改几个元素，那么 SAX 是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:54:56.560

SAX 是一个基于事件的解析实用程序。您会收到诸如 beginDocument()、startElement()、endElement() 等事件的通知。您将希望保存的内容保存在内存中。您只控制您想要的事件，这可以真正提高解析速度并减少内存使用。它**可以**提高内存效率，具体取决于您在内存中保存的内容和数量。对于一般情况，与 DOM 相比，SAX 的内存效率更高。DOM 会将整个文档保存在内存中以便对其进行处理。

# ios - iOS NSCoding 实现

> ID：11089743
> 
> 赞同：1
> 
> 时间：2012-06-18T19:32:34.340
> 
> 标签：ios, nscoding

我有一个自定义对象，我想将其保存到磁盘而不是内存。自定义对象具有子对象，子对象具有子对象，依此类推。这棵树相当广泛。其中一个子对象有 30 多个属性，其中 6 个是子对象本身。

如果我想使用 NSCoding，是否需要在每个子自定义对象上实现 NSCoding，并在每个自定义对象中实现 encodeWithCoder 和 initWithCoder？

我认为答案是肯定的，但这将是一件很痛苦的事情，只是忙于遍历每个对象并使其基本上符合 NSCoding 对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:51:35.650

是的。

值得庆幸的是，Accessorizer 正是出于这个原因而存在：http: [//itunes.apple.com/us/app/accessorizer/id402866670 ?mt=12](http://itunes.apple.com/us/app/accessorizer/id402866670?mt=12)

# objective-c - 绘制点垂直于通过 cocos2d 中途的线

> ID：11089745
> 
> 赞同：0
> 
> 时间：2012-06-18T19:32:41.470
> 
> 标签：objective-c, cocos2d-iphone

所以我有一条在两点之间绘制的线。比方说 A 和 B，我可以很容易地在 Cocos2d 中抓取线的中点，并且我也可以很容易地计算出该线的向量和垂直向量。但是我的数学技能非常生疏，我不知道如何做以下事情。

假设 A 和 B 之间的距离是 50，所以中点是 25。我想绘制一个垂直于这条线的点，距离它有 10 的距离。

```
 C
     /  \
    /    \
   /      \
  /        \
 /          \
A------------B 
```

对不起这个可怕的例子，但我不知道该怎么做。而且 AB 线总是在某个角度，它永远不会像这里那样笔直。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:58:17.367

给定中点`m`和垂直向量`v`，您需要进行归一化`v`，然后向`v`from的方向移动`m`。所以是这样的：

```
Vector2d nv = v / v.length(); // Assuming Vector2d is your vector class and length gives the length of v
Point2d newPoint = m + (nv * 10.0); // Assumes you can multiply a vector by a scalar 
```

如果您不在 C++ 中工作，则可能必须像这样手动编写它：

```
Vector2d nv;
nv.x = v.x / v.length();
nv.y = v.y / v.length();
newPoint.x = m.x + nv.x * 10.0;
newPoint.y = m.y + nv.y * 10.0; 
```

# jquery - 在主覆盖之前打开模态覆盖

> ID：11089748
> 
> 赞同：1
> 
> 时间：2012-06-18T19:32:47.123
> 
> 标签：jquery, cookies, overlay

我正在使用 jQuery 工具。我想做的是：一旦用户单击文本链接，验证是否存在 cookie；如果没有，请打开一个模式叠加层，要求他选择一个区域；一旦他这样做，将其存储在 cookie 中，然后打开主叠加层。

如果 cookie 已经存在，则直接打开主叠加层。

我到目前为止是这样的：

```
$(function() {

// if the function argument is given to overlay,
// it is assumed to be the onBeforeLoad event listener
$("a[rel]").live('click', function (e){
    e.preventDefault();

    var el = $(this);
    var target = el.attr('rel');
    $(target).appendTo('body');

    $(this).overlay({
    mask: {color:'black'},
    effect: 'apple',
    api: true,

    onBeforeLoad: function() {

// grab wrapper element inside content
        var wrap = this.getOverlay().find(".contentWrap");

        // load the page specified in the trigger
        wrap.load(this.getTrigger().attr("href"));

    },
    load:true,
    closeOnClick: false

     });
});
}); 
```

我知道在某些时候，我应该有这样的事情：

```
 if ($.cookie('myRegion') == null){ 
            $("#selectRegion").overlay().load();
        } 
```

但我不确定它适合哪里。任何人都知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:50:36.967

首先，确认一下，确保您正在加载[jQuery Cookie](https://github.com/carhartl/jquery-cookie)。

这似乎是一个简单的解决方案，但基本上它会检查 cookie，如果不存在则创建对话框，然后关闭对话框或保存选择，具体取决于是否单击了背景或按钮。

为您的 jQuery 尝试这样的操作：

```
$(document).ready(function(){
    if($.cookie("myRegion") == null){
        $("#modal-background").toggleClass("active");
        $("#modal-content").toggleClass("active");
    }

    $("#modal-background").click(function(){
        $("#modal-background").toggleClass("active");
        $("#modal-content").toggleClass("active");
    });
    $("#modal-save").click(function(){
        $.cookie("myRegion", $("region").val());
        $("#modal-background").toggleClass("active");
        $("#modal-content").toggleClass("active");
    });
});​ 
```

所有相关的 HTML 和 CSS 都可以在这个小提琴中找到：http: [//jsfiddle.net/9HrwN/2/](http://jsfiddle.net/9HrwN/2/)

# iphone - 模态视图全屏无法正确返回查看

> ID：11089751
> 
> 赞同：0
> 
> 时间：2012-06-18T19:32:53.687
> 
> 标签：iphone, objective-c, modal-dialog, presentmodalviewcontroller

我在尝试在 iPhone 应用程序上创建全屏模式视图时遇到了麻烦，但是当我以横向方式呈现它时，视图将位于屏幕的一小部分。如果它出现，然后你将它旋转到不同的方向，它要么是一个白屏，要么是一个角落里的缩小窗口。我是这样称呼它的：

```
bookmarks.modalPresentationStyle = UIModalPresentationFormSheet;
bookmarks.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
[self presentModalViewController:bookmarks animated:YES];
bookmarks.view.superview.bounds = CGRectMake(0, 0, 320,460); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T12:36:35.537

我最终做的是将调用模式视图的位置替换为导航堆栈上的推送。花了一点时间，因为我不得不用导航控制器而不是常规视图控制器来重构我正在处理的选项卡。

# java - Apache Camel：是什么推动消息？

> ID：11089755
> 
> 赞同：10
> 
> 时间：2012-06-18T19:33:08.693
> 
> 标签：java, architecture, soa, apache-camel, esb

在像 Apache Camel 这样的 ESB 上，什么机制实际上是沿着从端点到端点的路由“行进”（拉/推）消息？

骆驼是否`RouteBuilder`只是组成一个图表`Endpoints`并且知道在它访问某个目的地之后将消息传递到`Routes`哪个目的地/下一个目的地，或者他们自己知道哪个是它已处理的消息的下一个目的地。`Endpoint``Endpoint``Endpoints`

无论哪种方式，我都很困惑：

*   如果它`RouteBuilder`知道通过系统的消息“流”，那么这`RouteBuilder`将需要知道何时应该在vs`Endpoint A`旁边传递消息的业务逻辑，但是在所有 Camel 示例中，我看到这个业务逻辑没有存在; 和`Endpoint B``Endpoint C`
*   似乎将这种“流”业务逻辑放在`Endpoints`它们本身中会使它们耦合在一起，并破坏了 SOA/ESB/EIP 等的一些基本原则。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T16:48:46.030

在幕后，我相信骆驼正在构建一个纯图，其中每个节点都是骆驼端点/处理器，每条边都是两个端点（源和目的地）之间的路线。该图正是`RouteBuilder`您调用其 API 时所构建的内容。当你走`start()`骆驼路线时，图很可能被验证并翻译成一系列`Runnable`需要执行的 s，并且可能使用某种自定义`Executor`或线程管理来处理这些`Runnable`s。

因此，`Runnable`s（消息到达时处理消息的处理器）的执行由这个 custom 处理`Executor`。这是“沿着消息前进”的机制，尽管任务排队的顺序是由 组成的图的总体结构驱动的`RouteBuilder`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-19T03:54:04.970

我建议先阅读这个 QA [Apache Camel 到底是什么？](https://stackoverflow.com/questions/8845186/what-exactly-is-apache-camel) ...以及它所指的链接，有关 Apache Camel 的更多背景信息。

业务逻辑可以是任何类型的逻辑，例如 Java bean (POJO)。Camel 允许您以一种松散耦合的方式访问您的业务逻辑。例如，请参阅这些链接

*   [http://camel.apache.org/service-activator.html](http://camel.apache.org/service-activator.html)
*   [http://camel.apache.org/bean-integration.html](http://camel.apache.org/bean-integration.html)
*   [http://camel.apache.org/bean.html](http://camel.apache.org/bean.html)
*   [http://camel.apache.org/bean-binding.html](http://camel.apache.org/bean-binding.html)
*   [http://camel.apache.org/hiding-middleware.html](http://camel.apache.org/hiding-middleware.html)
*   [http://camel.apache.org/spring-remoting.html](http://camel.apache.org/spring-remoting.html)

# database-design - 专用聊天应用程序的数据模型设计

> ID：11089757
> 
> 赞同：1
> 
> 时间：2012-06-18T19:33:17.560
> 
> 标签：database-design, data-modeling

我很难为我的应用程序设计合适的数据模型。
在我的应用程序中，我有成对的参与者，他们将一起完成多项活动。每个配对在其存在过程中将进行 2-3 次对话。每个对话可能有许多由配对中的任何一个参与者创作的消息。
我拥有的最好的模型是这样的：

```
 PAIRINGS
          /     \
         /       \
        V         V  
PARTICIPANTS     CONVERSATIONS
-pairing_id      -pairing_id
       \          /
        \        /
         V      V
         MESSAGES
         -participant_id
         -conversation_id 
```

但是，此模型允许消息的作者不在与对话相关联的配对之外，这似乎是错误的。有人对我如何构建数据模型有更好的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:26:50.313

这是一个常见的问题。`pairing_id`在表中添加`MESSAGES`并适当更改两个`FOREIGN`键以包含此列：

```
 PAIRINGS
          /     \
         /       \
        V         V  
PARTICIPANTS     CONVERSATIONS
-pairing_id      -pairing_id
       \          /
        \        /
         V      V
         MESSAGES
         -participant_id
         -conversation_id
         -pairing_id 
```

大多数 DBMS 还要求您不断添加`UNIQUE`索引`PARTICIPANTS (pairing_id, participant_id)``CONVERSATIONS (pairing_id, conversation_id)`

# html - 为什么两个内联块不在父包装器 div 的顶部排列？

> ID：11089761
> 
> 赞同：6
> 
> 时间：2012-06-18T19:33:37.897
> 
> 标签：html, css

我有这样的 HTML

```
<div id="wrapper">
    <div id="main">
        <p>test</p>
    </div>
    <div id="sidebar">
        <p>test</p>
    </div>
</div> 
```

和 CSS

```
#wrapper {
    width: 960px;
    margin: 0px auto;
}

#main {
    width: 790px;
    display: inline-block;
    padding: 0px;
    margin: 0px;
}

#sidebar {
    width: 170px;
    display: inline-block;
    vertical-align: top;
    padding: 0px;
    margin: 0px;
} 
```

示例：http: [//jsfiddle.net/Hpwff/](http://jsfiddle.net/Hpwff/)

问题是，即使两个 div 的总和为 960px，与父容器的宽度（#wrapper）相同，它们也不会彼此相邻浮动。我必须将侧边栏或主容器的宽度缩小 4px 以使其适合。为什么会这样，有没有办法解决它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-18T19:39:39.240

您在两个`div`s 之间有一个换行符；因为它们是`inline-block`，所以它们之间的换行符呈现为一个空格。[没有空间](http://jsfiddle.net/Hpwff/2/)，它可以按您的预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:37:16.933

添加浮动：左；到每个 div，它应该像它一样工作！[更新了 jsFiddle](http://jsfiddle.net/Hpwff/1/)

更新代码：

```
#wrapper {
    width: 960px;
    margin: 0px auto;
}

#main {
    width: 790px;
    display: inline-block;
    padding: 0px;
    margin: 0px;
    float: left;
}

#sidebar {
    width: 170px;
    display: inline-block;
    vertical-align: top;
    padding: 0px;
    margin: 0px;
    float: left;
}​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T19:43:04.800

看这个：[jsfiddle](http://jsfiddle.net/Hpwff/3/)。您需要添加 float: left 到您的主要和侧边栏块。并在它们之后添加清除块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-18T19:43:13.013

```
<div id="wrapper">
    <div id="main">
        <p>test</p>
    </div><div id="sidebar">
        <p>test</p>
    </div>
</div> 
```

`</div>`和之间没有空格`<div>`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-02T17:59:43.013

这是较老的技巧之一 - 您需要将包装容器 (#wrapper) 的字体大小设置为 0px，然后将每个子项设置为您需要的任何字体大小。

这个技巧几乎适用于所有浏览器。但是，这一次不是 IE，而是 Safari 无法确认设置。

所以代码应该是这样的：

```
#wrapper {
    width: 960px;
    margin: 0px auto;
    font-size:0px;
}

#main {
    width: 790px;
    display: inline-block;
    padding: 0px;
    margin: 0px;
    font-size:16px;
}

#sidebar {
    width: 170px;
    display: inline-block;
    vertical-align: top;
    padding: 0px;
    margin: 0px;
    font-size:16px;
}​ 
```

您可以在您已经创建的 jsfiddle 上对其进行测试，它运行良好。

# php - PHP SOAP 请求

> ID：11089765
> 
> 赞同：3
> 
> 时间：2012-06-18T19:34:03.307
> 
> 标签：php, soap, soap-client, content-length

我正在为客户端开发 API 脚本，他们需要请求的服务之一需要内容长度。据我所知，PHP 无法在标头中发送 Content-Length。我可能是错的，但没有它，我不断`Premature end of data in tag html line 3 [string:Exception:private] => [code:protected] => 0 [file:protected] =>`

代码如下所示：

```
<?
try
{
    $soap_url = 'http://admin.stock.imdfulfilment.com/api/service.asmx';
    $client = new SoapClient($soap_url);

    $header = new SoapHeader(

        'http://admin.stock.imdfulfilment.com/api/service/',
        'GetCouriers',
        array(
            'Content-Length' => '255'
        )
    );
    $client->__setSoapHeaders($header);
    var_dump($client->__getFunctions());
}
catch (Exception $e)
{
   print_r($e);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-18T19:40:59.787

您的`wsdl`uri 不提供`wsdl`文件，这就是问题所在...使用`http://admin.stock.imdfulfilment.com/api/service.asmx?wsdl`

# c# - MVC3 DropDownListFor 模型绑定正确但未选择模型值

> ID：11089768
> 
> 赞同：1
> 
> 时间：2012-06-18T19:34:20.437
> 
> 标签：c#, asp.net-mvc-3, razor

将 MVC3 与 NHibernate 一起使用，我遇到了下拉问题。我有一个包含各种字段供用户输入的表单，并且只遇到了特定选择元素的问题。

我的问题是，即使模型已绑定并在发布时正确保存，当视图加载时模型属性的值也不会显示为选中状态。奇怪的是 MainPopulationFocus（下面的代码片段）下拉菜单可以正常工作，而 MilitaryService 下拉菜单不能正常工作。

模型 - 相关属性的声明

```
public virtual System.Int32? MilitaryService { get; set; }
public virtual System.Int32? MainPopulationFocus { get; set; } 
```

查看 - 兵役标签和下拉菜单

```
@Html.LabelFor( m => m.MilitaryService, "Military Service" )
@Html.DropDownListFor(m => m.MilitaryService, ViewBag.MilitaryService as IQueryable<SelectListItem>, "", new { style = "width: 140px" }) 
```

HTML

```
<label for="MilitaryService">Military Service</label>
<select id="MilitaryService" name="MilitaryService" style="width: 140px">
    <option value=""></option>
    <option value="1028">Active</option>
    <option value="1029">Reserve</option>
    <option value="1030">National Guard</option>
    <option value="1031">Retired Military</option>
</select> 
```

相同视图 - 主要人口焦点标签和下拉菜单

```
@Html.LabelFor( m => m.MainPopulationFocus, "Main Population Focus" )
@Html.DropDownListFor(m => m.MainPopulationFocus, ViewBag.MainPopulationFocuses as IQueryable<SelectListItem>, "", new { style = "width: 140px" }) 
```

HTML

```
<label for="MainPopulationFocus">Main Population Focus</label>
<select data-val="true" data-val-number="The field MainPopulationFocus must be a number." id="MainPopulationFocus" name="MainPopulationFocus" style="width: 140px">
    <option value=""></option>
    <option value="808">Education</option>
    <option value="809">Policy</option>
    <option selected="selected" value="810">Clinical Practice</option>
    <option value="811">Research</option>
</select> 
```

控制器 - 从服务层获取对象列表并将列表保存到 ViewBag

```
.Select(s => new SelectListItem() { Text = s.Display, Value = s.ID.ToString(), Selected = (s.ID == fellowsProfile.MilitaryService) }); 
```

MainPopulationFocus 下拉菜单完美运行，而选择的 MilitaryService 下拉列表值绑定到模型并保存在数据库中，但在视图加载时不显示选择的值。

我知道当您为模型和下拉列表使用相同的名称时存在一个问题，但我避免了这种情况。我认为这可能与我形成列表的方式有关。

感谢您提供任何可能的帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T14:54:20.773

发现我确实使用了相同的名称，这就是我遇到问题的原因。使用 ViewBag.MilitaryService 和 MilitaryService 的模型属性是破坏下拉列表使用的原因。

# android - 获取设备规范中指定的设备的完整显示高度。

> ID：11089770
> 
> 赞同：0
> 
> 时间：2012-06-18T19:34:30.357
> 
> 标签：android, fullscreen

Android中是否有返回设备全屏高度的API？我对设备规范中指定的全高感兴趣，而不是返回的可视屏幕的高度

```
android.view.Display.getHeight(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:12:13.167

我花了一些时间寻找这个并没有找到像你要求的那样的东西。问题的一部分是占用它们不包括的像素的条可能具有不同的大小。

我最终做的是测量设备的宽度（即全宽）和不完全全高，以与标准分辨率相匹配。这不是很好。如果您确实需要它，您可以强制更改方向以完全匹配两个尺寸。不过，这很恶心。

真正的答案是你不应该关心硬件的确切尺寸和使用操作系统提供的大小桶的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T21:16:42.197

这对你不起作用吗？

```
 DisplayMetrics dm = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(dm);
        displayHeight = dm.heightPixels; 
```

对我来说，displayHeight 在我的 HTC Sensation 上返回 960 像素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T20:40:32.743

在[DisplayMetrics](http://developer.android.com/reference/android/util/DisplayMetrics.html#DisplayMetrics%28%29)对象上尝试[heightPixels 。](http://developer.android.com/reference/android/util/DisplayMetrics.html#heightPixels)

# python - 如何同时使用 Django 视图和模板标签？

> ID：11089772
> 
> 赞同：0
> 
> 时间：2012-06-18T19:34:40.660
> 
> 标签：python, django, django-views, django-templates

在我的 Django 模板中：

```
<div class="A">
    {% url renders_data object.id %}
</div>
<div class="B">
    {% render_data object.id %}
</div> 
```

Div`A`是调用方法的常用方法，`views.py`而 Div`B`用于模板标签。

用户将打开一个链接。假设：`/myapp/test/`一个页面将打开，该页面包含两个模板标签部分。这个标签的名称是`render_data`我想将数据加载到每个模板标签中`Ajax`。要使用它，我们需要`request.ajax:`. 这就是为什么我想写视图方法。我想用以下方式完成它：

*   `template tag`我编写了in (renders_data 并传递 object_id 参数)的精确副本`views.py`并将其渲染到正确的模板。当我从模板中`maypp/test`删除后打开。`div A`它在除数据之外的每个模板标签部分（每个角）中显示`URL`( )。`myapp/test/<object_id>`他们是否有可能显示除此 URL 之外的上下文[当我选择此选项时查看图像](https://dl.dropbox.com/u/21766438/Screenshot%20at%202012-06-19%2001_34_22.png)*   `renders_data`其次，我还考虑在模板标签（ ）中导入视图方法（`render_data`）。这样数据将显示在每个角落并且`request.Ajax:`也将起作用。如果这是可能的，那怎么办？

我无法解决这个问题。请帮我 ：（

查看 render_data 的样子：

```
 @register.simple_tag
 def render_widget(object_id):
     from myapp.plugins.model import Widgetsetting
     widget_setting = Widetsetting.objects.get(id = object_id)
     widget = widget_settings.get_widget()
     template_name = widget.template_name
     context = widget.context(widget=widget_settings)
     t =  get_template("widgets/%s" % template_name)
     return t.render(Context(context)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:00:46.877

从您发布的代码中，类似下面的内容应该可以工作......

在views.py中：

```
from django.http import HttpResponse
from netadmin.plugins.templatetags.widgets import render_widget

def ajax_render_data(request, object_id):
    return HttpResponse(render_widget(object_id)) 
```

在你的 django 模板中：（
你说你想要页面上的几个，所以我将在 django 模板中使用一个循环，我不知道你的小部件集合叫什么，但我相信你可以工作它适用于您的特定情况）

```
<div class="widgets-container">
    {% for widget_settings in widgetsettings.objects.all %}
    <div class="widget-content" id="widget-content-{{ widget_settings.pk }}">
        not loaded yet
    </div>
    {% endfor %}
</div>

<script>
// here we use django to render the ajax urls into an object
// in javascript so we can use it on the client side 
var ajax_urls = {
  {% for widget_settings in widgetsettings.objects.all %}
    "{{ widget_settings.pk }}: "{% url ajax_render_data widget_settings.pk %}"{% if not forloop.last %},{% endif %}
  {% endfor %}
};

// (I'll assume you're using jQuery)
// start the ajax calls when the page is loaded:
$(document).ready(loadWidgets());

function loadWidgets() {
    // loop over the urls we provided from django:
    jQuery.each(ajax_urls, function(widget_id, url) {
        // do the ajax call:
        $.get(url, function(data) {
            // put the content into the widget div:
            $('#widget-content-'+widget_id).html(data);
        });
    });
}
</script> 
```

在 urls.py 中：

```
urlpatterns += patterns('netadmin.plugins.ajax_view',
    url(r'^ajax/(?P<object_id>\d+)/$', 'ajax_render_data', name='ajax_render_data'),
) 
```

# authentication - 自定义站点上的 phpBB 密码验证

> ID：11089779
> 
> 赞同：0
> 
> 时间：2012-06-18T19:35:22.550
> 
> 标签：authentication, passwords, phpbb

过去几个小时我一直在寻找如何在自定义站点上使用 phpBB 登录脚本。我想我只是没有在寻找正确的东西。

不久前，我创建了一个 phpBB 网站，并通过 phpBB 注册了 900 多个成员。我目前正在对这个网站进行整容，并重做用户注册以及我拥有的所有其他自定义代码。

我的问题是，我希望用户能够像往常一样登录，尽管我想将它们输入到我的新数据库中，以便一切顺利运行。我主要需要他们的用户名，密码和旧ID#，但**我不知道如何使用phpBB的密码认证或在哪里找到它**

该语句需要看起来像这样：

```
On Login, grab username and password variables:
    if the username is not in MY database, check phpBB database.  
        If the username is in phpBB database, check to see if the password is correct **(This is the part I don't know how to do)**
            If the password is correct, input the username, user ID and the password (encrypted my way) into MY database
                Login
            If the password is incorrect - error
        if the username is NOT in phpBB database - continue
    if the username is not in MY database - input username and encrypted pass into my DB
        login 
```

我在哪里可以找到验证 phpBB 用户密码的脚本？我不在乎脚本是如何完成的，我知道这是一个秘密，我只需要能够验证密码，这样我就可以确保它是同一个用户

我确实可以访问 phpBB 数据库，我只需要一种方法来验证他们的密码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T21:31:52.683

我宁愿删除这个问题，但这里是答案：

在这里查看：http: [//sunnyis.me/blog/secure-passwords/](http://sunnyis.me/blog/secure-passwords/)

当您下载 PasswordHash.php 时，将所有 $P$ 更改为 $H$。它会起作用的。奇怪的是它是如何创建密码的，每次创建密码都不一样。但是它的 CHECK 部分确保它正确地检查它，无论它创建什么散列传递。

# java - Tomcat的字符编码问题

> ID：11089783
> 
> 赞同：17
> 
> 时间：2012-06-18T19:35:46.410
> 
> 标签：java, jsp, tomcat, jstl, tomcat6

发生了奇怪的字符编码。我正在使用 JSP (JSTL) 和带有 Tomat 6 的 Struts。

我的 JSP 页面编码如下：

```
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %> 
```

问题是当我尝试使用 encodeURI 传递 url 时：

```
<script type="text/javascript">
          $('#mailer_filter').change(function(){
            var val = $(this).val();
            console.log(val);
            console.log(escape(val));
            console.log(encodeURI(val));
            location.href = 'mailList.a?' + encodeURI($(this).val());
          });
        </script> 
```

动作上的参数（java端）出来为：

```
Gaz MÃ©tro 
```

但是在前端它显示为：

```
Gaz Métro 
```

这是正确的方法。对此我能做些什么？？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-25T08:38:59.007

执行以下操作

1) HTML 代码

```
 <meta contentType="text/html; charset="UTF-8"/> 
```

2) IE 视图的浏览器设置 -- 编码 -- Unicode (UTF-8)

3) Tomcat Server server.xml - 在连接器标签中添加“URIEncoding”属性为

```
<Connector port="8080" protocol="HTTP/1.1" 
           connectionTimeout="20000" 
           redirectPort="8443" URIEncoding="UTF-8"/> 
```

catalina.sh/catalina.bat - 添加以下内容

```
set JAVA_OPTS=--Xms256m -Xmx1024m -Xss268k -server -XX:MaxPermSize=256m -XX:-UseGCOverheadLimit -Djava.awt.headless=true -Djavax.servlet.request.encoding=UTF-8 -Dfile.encoding=UTF-8

set CATALINA_OPTS=-Dfile.encoding="UTF-8" 
```

4) MIME 类型的响应应该是“application/x-www-form-urlencoded”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-18T20:01:16.960

您是否遵循了这些步骤？

[http://wiki.apache.org/tomcat/FAQ/CharacterEncoding#Q8](http://wiki.apache.org/tomcat/FAQ/CharacterEncoding#Q8)

**复制如下：**

使用 UTF-8 作为所有字符的编码是一个安全的选择。这应该适用于几乎所有情况。

为了完全切换到使用 UTF-8，您需要进行以下更改：

1.  在 server.xml 中设置 URIEncoding="UTF-8"。参考：HTTP 连接器、AJP 连接器。

2.  使用默认编码设置为 UTF-8 的字符编码过滤器

3.  更改所有 JSP 以在其 contentType 中包含字符集名称。

    例如，`<%@page contentType="text/html; charset=UTF-8" %>`用于通常的 JSP 页面和`<jsp:directive.page contentType="text/html; charset=UTF-8" />`XML 语法的页面（也称为 JSP 文档）。

4.  更改所有 servlet 以设置响应的内容类型并将内容类型中的字符集名称包括为 UTF-8。

    使用`response.setContentType("text/html; charset=UTF-8")`或`response.setCharacterEncoding("UTF-8")`。

5.  更改您使用的任何内容生成库（Velocity、Freemarker 等）以使用 UTF-8 并在它们生成的响应的内容类型中指定 UTF-8。

6.  在您的字符编码过滤器或 jsp 页面有机会将编码设置为 UTF-8 之前，禁用任何可能读取请求参数的阀门或过滤器。有关详细信息，请参阅[http://www.mail-archive.com/users@tomcat.apache.org/msg21117.html](http://www.mail-archive.com/users@tomcat.apache.org/msg21117.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T19:41:07.393

尝试将您的 tomcat 连接器（在 server.xml 中）的 URIEncoding 参数设置为 UTF-8：

例如：

```
<Connector port="8080" maxHttpHeaderSize="8192"
           maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
           enableLookups="false" redirectPort="8443" acceptCount="100"
           connectionTimeout="20000" disableUploadTimeout="true"
           URIEncoding="UTF-8"/> 
```

# ruby-on-rails - Databasedotcom gem 和 dbdc_controller 错误

> ID：11089786
> 
> 赞同：1
> 
> 时间：2012-06-18T19:35:54.593
> 
> 标签：ruby-on-rails, heroku, databasedotcom-gem

我尝试将 dbdc_controller 项目 (https://github.com/dburkes/dbdc_controller) 部署到 Heroku，但在为用户调出索引页面时出现错误：

```
 def index
    @users = User.all
  end 
```

日志仅显示“ArgumentError (ArgumentError)”，没有具体错误。有没有其他人遇到过这样的事情？

# c# - VS 2010 查询生成器无法解析插入语句上的 SCOPE_IDENTITY

> ID：11089789
> 
> 赞同：0
> 
> 时间：2012-06-18T19:36:05.833
> 
> 标签：c#, sql, query-builder

我正在使用这样的 SQL 数据源：

```
<asp:sqldatasource id="sds_sale" runat="server" connectionstring="<%$ ConnectionStrings:TestServerConnection %>"
    InsertCommand="INSERT INTO Sale (transactionID, salePrice) VALUES (@transactionID,@salePrice)  SET @Identity = SCOPE_IDENTITY()">
    <InsertParameters>
        <asp:Parameter Name="transactionID" />
        <asp:Parameter Name="salePrice" />
    </InsertParameters>
</asp:sqldatasource> 
```

插入 SQL 语句：

```
INSERT INTO Sale (transactionID, salePrice) 
VALUES (@transactionID,@salePrice)  
SET @Identity = SCOPE_IDENTITY() 
```

我想返回范围标识，但查询生成器说它无法解析 SQL 语句。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:48:52.750

你可以用这个替换第三行：

```
SELECT @Identity = SCOPE_IDENTITY() 
```

* * *

**编辑）**

您可以查看 SQL 探查器以查看发送到 Sql Server 的语句，您可以更轻松地对其进行调试

# android - setBackgroundColor 方法，android

> ID：11089791
> 
> 赞同：1
> 
> 时间：2012-06-18T19:36:06.837
> 
> 标签：android, android-layout

现在我正在构建一个简单的表单并且我正在设计它，以便如果用户在单击提交按钮之前没有输入必要的信息，背景会变成红色。之后，如果他们输入了正确的信息，表格就会恢复到以前的样子。

```
// "if empty then set fields to red" checks
            if (firstLastName.getText().toString().equals("")) {
                firstLastName.setBackgroundColor(Color.RED);
            }
            else
                firstLastName.setBackgroundColor(Color.WHITE);
        } 
```

问题是白色显然不是以前的样子，因为它看起来不同了。有没有办法在不删除用户输入的信息的情况下重置表单？

如果我不清楚，请告诉我，我会尽力详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:49:17.737

如何设置和删除滤色器而不是更改背景颜色：

```
if (firstLastName.getText().toString().equals("")) {
    // 0xFFFF0000 is red
    firstLastName.getBackground().setColorFilter(0xFFFF0000, PorterDuff.Mode.DARKEN);}
else {
    //Setting to null removes filter
    firstLastName.getBackground().setColorFilter(null);
} 
```

# python - 哪个http python代理？

> ID：11089792
> 
> 赞同：0
> 
> 时间：2012-06-18T19:36:08.743
> 
> 标签：python, http, proxy

我想要一个用python编写的非常简单的代理，它将接收一些http请求，它会丢弃参数，然后根据参数的正确性代理或不请求请求。主要用于身份验证。所以我会编写自己的小代码。你建议什么？听起来很微不足道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:40:41.980

我会使用[Twisted](http://twistedmatrix.com)。它非常适合这种服务器。

[这是如何将其用作代理的示例](http://twistedmatrix.com/documents/current/web/examples/) 滚动到虚拟主机和代理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:19:49.547

我还发现这个很好[用 http://www.oki-osk.jp/esc/python/proxy/](http://www.oki-osk.jp/esc/python/proxy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-24T04:51:23.687

如果您希望使用代理访问某些外国网站并且您可以在本地访问，您可能希望将其添加到您的脚本中

```
Proxy1 = '188.166.174.77:80'

proxies = {
             'http': 'http://' + Proxy1 + '',
                 'https': 'https://' + Proxy1 + ''

}

r1 = requests.get('url', proxies=proxies) 
```

# powershell - Powershell 检索每个进程的 IO 操作并列出进程信息

> ID：11089799
> 
> 赞同：-2
> 
> 时间：2012-06-18T19:36:32.827
> 
> 标签：powershell, performancecounter

我正在尝试获取具有大量 I/O 读取的进程列表以及相关的 ProductVersion。代码看起来像这样：

```
$counter = "\Process*\IO Read Operations/sec"
get-counter | ? {$counter -gt 10} | gps | select name,productversion,reads 
```

输出看起来像这样：

```
Name    ProductVersion    Reads
-----   --------------    -----
p1      16.1.723.2342     15.98324
p2      12.3.234.1231     11.34323 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:26:11.713

我认为您可以使用[格式表](http://technet.microsoft.com/en-us/library/dd347677.aspx)

我正在使用不同的计数器在我的系统上获取结果。您可以得出一个类比并相应地使用：-

```
$Proc = Get-counter "\Process(*)\% processor time"

$Proc.CounterSamples | where {$_.instanceName -ne "idle"} | where {$_.instanceName -ne "_total"} | Format-Table -auto 
```

**输出：-**

```
Path                                                                   InstanceName                          CookedValue
----                                                                   ------------                          -----------
\\angshuman\process(system)\% processor time                           system                           1.54907723252374
\\angshuman\process(smss)\% processor time                             smss                                            0
\\angshuman\process(csrss#1)\% processor time                          csrss                            1.54907723252374 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T19:29:25.223

要从多个源创建自定义表，您需要创建一个数组，然后将每个变量作为一个新对象进行管道传输：

```
$counter = "\Process*\IO Read Operations/sec"
$processes = gps | select id | ForEach {$_.id}
$ccounter = get-counter -listset process | get-counter -maxsamples 1 | select -expandproperty countersamples | where {$_.path -like $counter -and $_cookedvalue -eq $processes} | select cookedvalue | ForEach {$_.cookedvalue}
function Get-CounterValue ($mypid) { Code Here.... }
function GetProductVersion ($mypid) { ...code here... }
function GetProcessName ($mypid) { ...code here... }

$myresults = @()
$x = foreach ($procc in $processes) {
 $thisname = GetProcessName $procc
 $thisprod = GetProductVersion $procc
 $thisread = GetCounterValue $procc
 $robj = New-Object System.Object
 $robj | Add-Member -type NoteProperty -name Name -value $thisname
 $robj | Add-Member -type NoteProperty -name ProductVersion -value $thisprod
 $robj | Add-Member -type NoteProperty -name Reads -value $thisread
 $myresults += $robj
}
$myresults | ft -auto 
```

# c++ - 如何从 char * 中删除换行符？

> ID：11089802
> 
> 赞同：3
> 
> 时间：2012-06-18T19:36:46.190
> 
> 标签：c++, string, newline

我有一个变量：`char * tmp`我用它做很少的操作。最后，我有这样的东西，`"fffff"`但有时在 fffff 之前是`"\n"`. 我怎样才能删除它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T19:58:44.953

```
char *tmp = ...;

// the erase-remove idiom for a cstring
*std::remove(tmp, tmp+strlen(tmp), '\n') = '\0'; // removes _all_ new lines. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T20:26:45.937

在您的问题中，您正在谈论将此字符串传递给套接字。当将 char* 指针传递给将复制它的套接字之类的东西时，执行此操作的代码非常简单。

在这种情况下，您可以这样做：

```
if (tmp[0] == '\n')
  pass_string(tmp+1); // Passes pointer to after the newline
else
  pass_string(tmp);   // Passes pointer where it is 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T09:15:50.690

在 C 中：

```
#include <string.h>
tmp[strcspn(tmp, "\n")] = '\0'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T19:46:14.403

如果 tmp 是动态分配的，请记住使用以下命令释放它`tmp`：

```
if (tmp[0] == '\n') {
    tmp1 = &tmp[1];
}
else {
    tmp1 = tmp;
}

// Use tmp1 from now on 
```

# facebook - FQL 截断/空照片文件

> ID：11089805
> 
> 赞同：1
> 
> 时间：2012-06-18T19:36:58.150
> 
> 标签：facebook, facebook-fql

我想获取所有照片 fids 相册。

例如，我有相册，我的朋友当然也有相册。

我可以通过以下方式获取专辑文件：

```
SELECT object_id FROM album WHERE owner IN (...) 
```

有效。现在我想得到这张专辑的照片：

```
SELECT object_id from photo WHERE album_object_id IN (albumFid1,albumFid2) 
```

现在我可以得到错误（空或截断数据）。如果我在 IN() 中只使用一个参数，那就没问题了。我看到照片fids。但是如果我使用几个专辑文件，我开始得到不正确的数据。无论谁是专辑所有者。

我尝试简单的测试：获取我所有相册的所有照片文件：

```
fql?q={"albums":"SELECT object_id FROM album WHERE owner = me()", "photos":"SELECT object_id from photo WHERE album_object_id IN (SELECT object_id FROM #albums)"} 
```

有效。如果我使用我的任何朋友，也可以使用。但是，如果我使用多个用户 - 以及不同用户的专辑文件，现在会得到神奇的结果。

[我在https://developers.facebook.com/bugs/445214712163793](https://developers.facebook.com/bugs/445214712163793)打开错误。但没有任何回应。在错误中，我使用两张专辑（我和我的朋友）的情况。我得到差异结果，然后使用带有 IN() 的差异专辑 fids 顺序。

有兴趣，两周前一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T14:29:09.130

我只找到一种解决方案：使用 FQL 多查询。每个查询 - 一个用户相册。

# python - 在 Python 3 中的表达式中引发和捕获异常

> ID：11089808
> 
> 赞同：3
> 
> 时间：2012-06-18T19:37:14.243
> 
> 标签：python, exception-handling, python-3.x

让我首先说：这是用于深奥目的 - 不是生产代码。我正在用一行 Python 代码做一些事情，因此我需要表达式而不是语句。（**编辑：**我正在将代码机械编译成单行（主要是）等效的 Python 代码，[BitBucket - onelinepython](https://bitbucket.org/ShadowMaster/onelinepython)。请注意，它正在进行中，因此我在最初提到它时保持沉默）

我基本上想做两件事：

*   调用一个引发我选择的异常实例的函数，例如：

    raise_exception(WhateverException())

*   在封闭的环境中运行一个函数，我可以在其中获取引发的异常实例，如果引发了异常实例，否则返回被调用函数的返回值。例如：

    has_exception, return_or_exception = check_exception(f, param1, param2, ...)

理想情况下，我想用一些默认库或内置函数来做到这一点（不管我有多少要混蛋它的预期用途）。我不需要与我提供的示例具有完全相同签名的函数，只是我可以将其分解成足够接近的东西。不过，我确实有一个限制：**不使用 eval() 或等效函数**。

**编辑：**我知道我可以定义自己的函数来执行此操作，但是他们仍然必须遵循它们是单个表达式的限制。因此，在函数定义中使用`raise`和内部的解决方案已被淘汰。`try`不幸的是，函数定义、raise-statement 和 try-blocks 是语句而不是表达式。

至于我尝试过的任何解决方案。答案还没有。我最接近如何解决这个问题的想法是滥用`unittest`断言功能，但我认为这是一个死胡同。

**编辑 2：**为了清楚起见，我可以使用在其代码中某处使用`raise`-statements 或`try`-blocks 的模块或其他模块。我的目标是获取一些代码并将其转换为等效的单行代码（包括我可能正在使用的任何辅助函数）。但由于我希望它在默认安装的 Python 上工作，我只想使用默认库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T10:08:24.797

To raise an exception:

```
>>> import warnings
>>> WV = type("WV", (Warning, ValueError), {})
>>> warnings.simplefilter("error", WV)
>>> warnings.warn("wv", WV)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
__main__.WV: wv 
```

To catch an exception:

```
>>> import unittest
>>> res = type("TR", (unittest.TestResult, ), dict(addError=lambda self, test, err: setattr(self, '_last_err', err)))()
>>> unittest.FunctionTestCase(lambda: [][0])(res)
>>> res._last_err
(<type 'exceptions.IndexError'>, IndexError('list index out of range',), <traceback object at 0x2b4358e69950>) 
```

Note that the `warnings` method will only work for exceptions that derive from `Warning`, but you should always be able to multiply-inherit; here's an example:

```
>>> WS = type("WS", (Warning, StopIteration), {})
>>> warnings.simplefilter("error", WS)
>>> list(type("R", (object,), dict(__init__=lambda self, stop: (setattr(self, 'stop', stop), setattr(self, 'i', 0), None)[-1], __iter__=lambda self: self, next=lambda self: (self.i, setattr(self, 'i', self.i + 1))[0] if self.i < self.stop else warnings.warn("Stop", WS)))(5))
[0, 1, 2, 3, 4] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:41:39.047

您可以定义自己的函数来执行此操作：

```
def raise_exception(ex):
    raise ex

def check_exception(f, *args, **kwargs):
    try:
        return False, f(*args, **kwargs)
    except Exception as e:
        return True, e 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T20:05:28.177

[这个答案](https://stackoverflow.com/questions/1528237/how-can-i-handle-exceptions-in-a-list-comprehension-in-python)表明通常不可能用表达式捕获异常。我也很确定不使用`raise`. （您可以使用`1/0`or之类的表达式生成一些特定的异常`dict['keyThatWillNeverExist']`，但不能使用任意异常信息生成任意异常。）

The [language reference](http://docs.python.org/reference/executionmodel.html#exceptions) says:

> The Python interpreter raises an exception when it detects a run-time error (such as division by zero). A Python program can also explicitly raise an exception with the raise statement. Exception handlers are specified with the try ... except statement.

Although this doesn't rule out the possibility that some dark corner of the language specification allows raising exceptions in other ways, the statement is pretty straightforward: you raise exceptions with `raise` and catch them with `try/except`.

Note that using unittest, or any other Python library, is unlikely to be a real solution in your sense, because unittest contains functions written in Python that use try/except. So if you're okay with using unittest, you ought to be okay with writing your own functions.

I imagine it might be possible to achieve your goal by "cheating" and writing a C extension that provides functions doing what you want. But that's not really converting it to equivalent Python code.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-19T09:22:54.147

You are asking how to raise an exception without using `raise` and catch an exception without using `except`. Your reluctance to use these statements is because you can't use more than one statement in a single line of code, and you have the idea to compile Python modules into oneliners.

Short answer: **Well, you can't.**

And even if you could, why would you? It's a completely meaningless effort. The code is not faster or even significantly smaller because it is in one line. It goes against the idea of Python as well. And if you want to obfuscate it, there are much better ways, including compiling it to bytecode.

Longer answer:

You could implement your own exception system, independent of the Python exceptions, but that would be astonishingly slow, and this would still not catch the Python exceptions, so it's not useful in your case.

For the `raise`-statement, you could re-implementing the raise statement as a function in C, but this you seem to think is cheating, and I also don't see how it would be possible with other statements, such as `except`.

You could also move out some statements into functions in a separate module, but this is of course then no longer actually a one-liner module in any meaningful way, and not all statements are easily wrapped like this, `except` being the most relevant case here. You'd have to wrap the whole `try/except` block, but the resulting function would in turn also only take expressions as parameters, so you would have to extract the blocks into functions, and you'd end up needing to basically re-implement most of Python as a statement-less language, which is silly. And you'd end up with the helper functions in a separate module, which you don't want to.

So the answer to your question of how to raise an exception without using `raise` and catch an exception without using `except` is **"You don't"**.

# twitter - Twitter Bootstrap：下拉菜单悬停在桌面上，点击平板电脑/手机？

> ID：11089817
> 
> 赞同：9
> 
> 时间：2012-06-18T19:38:03.313
> 
> 标签：twitter, drop-down-menu, click, hover, twitter-bootstrap

关于如何将 Twitter Bootstrap 的下拉菜单从点击显示更改为悬停显示似乎有很多问题/答案。Bootstrap 的构建者有充分的理由使用点击而不是悬停——悬停在大多数平板电脑和手机上都不起作用。然而，我使用 Bootstrap 的原因之一是它的响应特性。我想要一个可以在台式机、平板电脑和手机上查看的网站。尽管平板电脑和手机需要单击以获取下拉菜单，但这不是台式机的预期行为。我希望我的网站具有响应性，但不以必须重新培训用户为代价！

有没有办法为台式机提供悬停下拉菜单并为平板电脑和手机提供点击下拉菜单？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T15:22:27.693

我创建了一个插件（进行了一些改进，但它确实可以按原样工作）允许下拉菜单在悬停时工作，但它不会干扰 Twitter Bootstrap 的点击事件，所以你可以安全地绑定两者，这基本上意味着如果有是鼠标，它会在悬停时激活，但如果没有鼠标（即平板电脑上的触摸屏），它仍然会在单击时激活。

我将插件托管在 GitHub 上：[https ://github.com/CWSpear/twitter-bootstrap-hover-dropdown](https://github.com/CWSpear/twitter-bootstrap-hover-dropdown)

它通过显式调用来工作，但我将在不久的将来调整代码以使用数据属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T22:42:35.167

您可以使用“响应式实用程序类”

[http://twitter.github.com/bootstrap/scaffolding.html](http://twitter.github.com/bootstrap/scaffolding.html)在页面底部

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-13T17:46:29.417

我正在寻找这个。而且我找到了更好的解决方案（我认为）。**我们可以使用很棒的Modernizr.js**库轻松做到这一点。我们可以通过以下函数检测触摸屏设备。

```
function is_touch_device() {
  return !!('ontouchstart' in window);
} 
```

然后我们可以通过 Javascript 动态禁用超链接中的 URL，方法是将位置更改为“#”或阻止父菜单项的默认操作。最终代码如下。

```
$(document).ready(function() { 

    /* If mobile browser, prevent click on parent nav item from redirecting to URL */
    if(is_touch_device()) { 

        $('#mainmenu li > ul').each(function (index, ev) {
            /* Option 1: Use this to modify the href on the <a> to # */
            $(ev).prev('a').attr('href' ,'#');  

            /* OR Option 2: Use this to keep the href on the <a> intact but prevent the default action */
            $(ev).prev('a').click(function(event) {
                event.preventDefault();
            });
        });
    }

}); 
```

有关更多详细信息，您可以查看[此链接](http://goo.gl/NUWXVQ) 我相信有人会投票给我 :-)

谢谢

# ant - 如何在 ANT 中支持 3 字节 UTF-8 字符

> ID：11089818
> 
> 赞同：1
> 
> 时间：2012-06-18T19:38:04.420
> 
> 标签：ant, utf-8

我试图在我的 ANT 脚本中支持 UTF-8 字符。

只要字符串由 2 字节的 UTF-8 字符组成，例如：

*   登录
*   用户身份

然后一切正常。

当我使用 Unicode 汉字时：

*   我</li>

其中，根据此站点： [http](http://www.fileformat.info/info/unicode/char/6211/index.htm) ://www.fileformat.info/info/unicode/char/6211/index.htm 具有 0xE6 0x88 0x91 的 UTF-8 编码

我可以在 UltraEdit 中看到，我的输入属性文件具有连续的值“E6 88 91”，所以我相当有信心我的输入是正确的。当我在 Notepad++ 中打开同一个文件时，我可以正确看到所有字符。

这是我的构建脚本：

```
<?xml version="1.0" encoding="UTF-8" ?>

<project
    name="utf8test"
    default="all"
    basedir=".">

    <target name="all">
        <loadproperties  encoding="UTF-8" srcfile="./apps.properties.all.txt"  />

        <echo>No encoding ${common.app.name}</echo>
        <echo encoding="UTF-8">UTF-8 ${common.app.name}</echo>
        <echo encoding="UnicodeLittle">UnicodeLittle ${common.app.name}</echo>
        <echo encoding="UnicodeLittleUnmarked">UnicodeLittleUnmarked ${common.app.name}</echo>
        <echo>${common.app.ServerName}</echo>
        <echo>${bb.vendor}</echo>

        <echo>No encoding ${common.app.UserIdText}</echo>
        <echo encoding="UTF-8">UTF-8 ${common.app.UserIdText}</echo>
        <echo encoding="UnicodeLittle">UnicodeLittle ${common.app.UserIdText}</echo>
        <echo encoding="UnicodeLittleUnmarked">UnicodeLittleUnmarked ${common.app.UserIdText}</echo>

        <echoproperties />
      </target>
    </project> 
```

这是我的属性文件：

```
common.app=VrvPsLTst
common.app.name=我們
common.app.description=Pseudo Loc Test App for Build Script testing
common.app.ServerName=http://Vèrìvò.com
bb.vendor=Vèrìvò
common.app.PasswordText=Pàsswòrð
bb.override.list=MP_COPYRIGHTTEXT, "Çòpÿrìght 2012 Vèrívó Bùîlð TéàＭ"
common.app.LoginButtonText=Lògìñ
common.app.UserIdText=Ùsèr ÌÐ
bb.SMSSuccess=Mèssàgéß Sùççêssfúllÿ Sëñt
common.app.LoginScreenMessage=WèlçòＭé Mêssàgë
common.app.LoginProgressMessage=Àùthèñtìçàtíòñ îñ prógréss...
ios.RegistrationText=Règìstràtíòñ Téxt
ios.RegistrationURL=http://www.josscrowcroft.com/2011/code/utf-8-multibyte-characters-in-url-parameters-%E2%9C%93/ 
```

这是输出的样子：

```
Buildfile: C:\Temp\utf8\build.xml

all:
     [echo] No encoding ??
     [echo] UTF-8 ??
     [echo] ÿþU n i c o d e L i t t l e   ? ? 
     [echo] U n i c o d e L i t t l e U n m a r k e d   ? ? 
     [echo] http://Vèrìvò.com
     [echo] Vèrìvò
     [echo] No encoding Ùsèr ÌÐ
     [echo] UTF-8 Ã™sÃ¨r ÃŒÃ?
     [echo] ÿþU n i c o d e L i t t l e   Ù s è r   Ì Ð 
     [echo] U n i c o d e L i t t l e U n m a r k e d   Ù s è r   Ì Ð 
[echoproperties] #Ant properties
[echoproperties] #Mon Jun 18 15:25:13 EDT 2012
[echoproperties] ant.core.lib=C\:\\ant\\lib\\ant.jar
[echoproperties] ant.file=C\:\\Temp\\utf8\\build.xml
[echoproperties] ant.file.type=file
[echoproperties] ant.file.type.utf8test=file
[echoproperties] ant.file.utf8test=C\:\\Temp\\utf8\\build.xml
[echoproperties] ant.home=c\:\\ant\\bin\\..
[echoproperties] ant.java.version=1.6
[echoproperties] ant.library.dir=C\:\\ant\\lib
[echoproperties] ant.project.default-target=all
[echoproperties] ant.project.invoked-targets=all
[echoproperties] ant.project.name=utf8test
[echoproperties] ant.version=Apache Ant version 1.8.1 compiled on April 30 2010
[echoproperties] awt.toolkit=sun.awt.windows.WToolkit
[echoproperties] basedir=C\:\\Temp\\utf8
[echoproperties] bb.SMSSuccess=M\u00E8ss\u00E0g\u00E9\u00DF S\u00F9\u00E7\u00E7\u00EAssf\u00FAll\u00FF S\u00EB\u00F1t
[echoproperties] bb.override.list=MP_COPYRIGHTTEXT, "\u00C7\u00F2p\u00FFr\u00ECght 2012 V\u00E8r\u00EDv\u00F3 B\u00F9\u00EEl\u00F0 T\u00E9\u00E0?"
[echoproperties] bb.vendor=V\u00E8r\u00ECv\u00F2
[echoproperties] common.app=VrvPsLTst
[echoproperties] common.app.LoginButtonText=L\u00F2g\u00EC\u00F1
[echoproperties] common.app.LoginProgressMessage=\u00C0\u00F9th\u00E8\u00F1t\u00EC\u00E7\u00E0t\u00ED\u00F2\u00F1 \u00EE\u00F1 pr\u00F3gr\u00E9ss...
[echoproperties] common.app.LoginScreenMessage=W\u00E8l\u00E7\u00F2?\u00E9 M\u00EAss\u00E0g\u00EB
[echoproperties] common.app.PasswordText=P\u00E0ssw\u00F2r\u00F0
[echoproperties] common.app.ServerName=http\://V\u00E8r\u00ECv\u00F2.com
[echoproperties] common.app.UserIdText=\u00D9s\u00E8r \u00CC\u00D0
[echoproperties] common.app.description=Pseudo Loc Test App for Build Script testing
[echoproperties] common.app.name=??
[echoproperties] file.encoding=Cp1252
[echoproperties] file.encoding.pkg=sun.io
[echoproperties] file.separator=\\
[echoproperties] ios.RegistrationText=R\u00E8g\u00ECstr\u00E0t\u00ED\u00F2\u00F1 T\u00E9xt
[echoproperties] ios.RegistrationURL=http\://www.josscrowcroft.com/2011/code/utf-8-multibyte-characters-in-url-parameters-%E2%9C%93/
[echoproperties] java.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment
[echoproperties] java.awt.printerjob=sun.awt.windows.WPrinterJob
[echoproperties] java.class.path=c\:\\ant\\bin\\..\\lib\\ant-launcher.jar;C\:\\Temp\\utf8\\.\\;C\:\\Program Files (x86)\\Java\\jre7\\lib\\ext\\QTJava.zip;C\:\\ant\\lib\\ant-antlr.jar;C\:\\ant\\lib\\ant-apache-bcel.jar;C\:\\ant\\lib\\ant-apache-bsf.jar;C\:\\ant\\lib\\ant-apache-log4j.jar;C\:\\ant\\lib\\ant-apache-oro.jar;C\:\\ant\\lib\\ant-apache-regexp.jar;C\:\\ant\\lib\\ant-apache-resolver.jar;C\:\\ant\\lib\\ant-apache-xalan2.jar;C\:\\ant\\lib\\ant-commons-logging.jar;C\:\\ant\\lib\\ant-commons-net.jar;C\:\\ant\\lib\\ant-contrib-1.0b3.jar;C\:\\ant\\lib\\ant-jai.jar;C\:\\ant\\lib\\ant-javamail.jar;C\:\\ant\\lib\\ant-jdepend.jar;C\:\\ant\\lib\\ant-jmf.jar;C\:\\ant\\lib\\ant-jsch.jar;C\:\\ant\\lib\\ant-junit.jar;C\:\\ant\\lib\\ant-launcher.jar;C\:\\ant\\lib\\ant-netrexx.jar;C\:\\ant\\lib\\ant-nodeps.jar;C\:\\ant\\lib\\ant-starteam.jar;C\:\\ant\\lib\\ant-stylebook.jar;C\:\\ant\\lib\\ant-swing.jar;C\:\\ant\\lib\\ant-testutil.jar;C\:\\ant\\lib\\ant-trax.jar;C\:\\ant\\lib\\ant-weblogic.jar;C\:\\ant\\lib\\ant.jar;C\:\\ant\\lib\\bb-ant-tools.jar;C\:\\ant\\lib\\xercesImpl.jar;C\:\\ant\\lib\\xml-apis.jar;C\:\\Program Files\\Java\\jre7\\lib\\tools.jar
[echoproperties] java.class.version=51.0
[echoproperties] java.endorsed.dirs=C\:\\Program Files\\Java\\jre7\\lib\\endorsed
[echoproperties] java.ext.dirs=C\:\\Program Files\\Java\\jre7\\lib\\ext;C\:\\Windows\\Sun\\Java\\lib\\ext
[echoproperties] java.home=C\:\\Program Files\\Java\\jre7
[echoproperties] java.io.tmpdir=C\:\\Users\\efelton\\AppData\\Local\\Temp\\
[echoproperties] java.library.path=C\:\\Windows\\SYSTEM32;C\:\\Windows\\Sun\\Java\\bin;C\:\\Windows\\system32;C\:\\Windows;C\:\\Windows\\SYSTEM32;C\:\\Windows;C\:\\Windows\\SYSTEM32\\WBEM;C\:\\Windows\\SYSTEM32\\WINDOWSPOWERSHELL\\V1.0\\;C\:\\PROGRAM FILES\\INTEL\\WIFI\\BIN\\;C\:\\PROGRAM FILES\\COMMON FILES\\INTEL\\WIRELESSCOMMON\\;C\:\\PROGRAM FILES (X86)\\MICROSOFT SQL SERVER\\100\\TOOLS\\BINN\\;C\:\\PROGRAM FILES\\MICROSOFT SQL SERVER\\100\\TOOLS\\BINN\\;C\:\\PROGRAM FILES\\MICROSOFT SQL SERVER\\100\\DTS\\BINN\\;C\:\\PROGRAM FILES (X86)\\MICROSOFT SQL SERVER\\100\\TOOLS\\BINN\\VSSHELL\\COMMON7\\IDE\\;C\:\\PROGRAM FILES (X86)\\MICROSOFT SQL SERVER\\100\\DTS\\BINN\\;C\:\\Program Files\\ThinkPad\\Bluetooth Software\\;C\:\\Program Files\\ThinkPad\\Bluetooth Software\\syswow64;C\:\\Program Files (x86)\\QuickTime\\QTSystem\\;C\:\\Program Files (x86)\\AccuRev\\bin;C\:\\Program Files\\Java\\jdk1.7.0_04\\bin;C\:\\Program Files (x86)\\IDM Computer Solutions\\UltraEdit\\;.
[echoproperties] java.runtime.name=Java(TM) SE Runtime Environment
[echoproperties] java.runtime.version=1.7.0_04-b22
[echoproperties] java.specification.name=Java Platform API Specification
[echoproperties] java.specification.vendor=Oracle Corporation
[echoproperties] java.specification.version=1.7
[echoproperties] java.vendor=Oracle Corporation
[echoproperties] java.vendor.url=http\://java.oracle.com/
[echoproperties] java.vendor.url.bug=http\://bugreport.sun.com/bugreport/
[echoproperties] java.version=1.7.0_04
[echoproperties] java.vm.info=mixed mode
[echoproperties] java.vm.name=Java HotSpot(TM) 64-Bit Server VM
[echoproperties] java.vm.specification.name=Java Virtual Machine Specification
[echoproperties] java.vm.specification.vendor=Oracle Corporation
[echoproperties] java.vm.specification.version=1.7
[echoproperties] java.vm.vendor=Oracle Corporation
[echoproperties] java.vm.version=23.0-b21
[echoproperties] line.separator=\r\n
[echoproperties] os.arch=amd64
[echoproperties] os.name=Windows 7
[echoproperties] os.version=6.1
[echoproperties] path.separator=;
[echoproperties] sun.arch.data.model=64
[echoproperties] sun.boot.class.path=C\:\\Program Files\\Java\\jre7\\lib\\resources.jar;C\:\\Program Files\\Java\\jre7\\lib\\rt.jar;C\:\\Program Files\\Java\\jre7\\lib\\sunrsasign.jar;C\:\\Program Files\\Java\\jre7\\lib\\jsse.jar;C\:\\Program Files\\Java\\jre7\\lib\\jce.jar;C\:\\Program Files\\Java\\jre7\\lib\\charsets.jar;C\:\\Program Files\\Java\\jre7\\lib\\jfr.jar;C\:\\Program Files\\Java\\jre7\\classes
[echoproperties] sun.boot.library.path=C\:\\Program Files\\Java\\jre7\\bin
[echoproperties] sun.cpu.endian=little
[echoproperties] sun.cpu.isalist=amd64
[echoproperties] sun.desktop=windows
[echoproperties] sun.io.unicode.encoding=UnicodeLittle
[echoproperties] sun.java.command=org.apache.tools.ant.launch.Launcher -cp .;C\:\\Program Files (x86)\\Java\\jre7\\lib\\ext\\QTJava.zip
[echoproperties] sun.java.launcher=SUN_STANDARD
[echoproperties] sun.jnu.encoding=Cp1252
[echoproperties] sun.management.compiler=HotSpot 64-Bit Tiered Compilers
[echoproperties] sun.os.patch.level=Service Pack 1
[echoproperties] user.country=US
[echoproperties] user.dir=C\:\\Temp\\utf8
[echoproperties] user.home=C\:\\Users\\efelton
[echoproperties] user.language=en
[echoproperties] user.name=efelton
[echoproperties] user.script=
[echoproperties] user.timezone=
[echoproperties] user.variant=

BUILD SUCCESSFUL
Total time: 1 second 
```

感谢您的帮助

编辑\更新 2012 年 6 月 19 日

我正在 Windows 环境中开发。

我从以下位置安装了一个 TTF：http: [//freedesktop.org/wiki/Software/CJKUnifonts/Download](http://freedesktop.org/wiki/Software/CJKUnifonts/Download)

我已将 UltraEdit 更新为使用 TTF，并且可以看到中文字符。

```
<?xml version="1.0" encoding="UTF-8" ?>

<project name="utf8test" default="all" basedir="."> 

   <target name="all">        

      <echo>我們&lt;/echo>
      <echo encoding="ISO-8859-1">ISO-8859-1 我們&lt;/echo> 
      <echo encoding="UTF-8">UTF-8 我們&lt;/echo> 

      <echo file="echo_output.txt" append="true" >我們 ${line.separator}</echo>
      <echo file="echo_output.txt" append="true"  encoding="ISO-8859-1">ISO-8859-1 我們 ${line.separator}</echo> 
      <echo file="echo_output.txt" append="true"  encoding="UTF-8">UTF-8 我們 ${line.separator}</echo> 
      <echo file="echo_output.txt" append="true"  encoding="UnicodeLittle">UnicodeLittle 我們 ${line.separator}</echo> 
      <echo file="echo_output.txt" append="true"  encoding="UnicodeLittleUnmarked">UnicodeLittleUnmarked 我們 ${line.separator}</echo> 

   </target> 
</project> 
```

在 UltraEdit 中运行捕获的输出为： Buildfile: E:\temp\utf8\build.xml

```
 all:
         [echo] ??
         [echo] ISO-8859-1 ??
         [echo] UTF-8 ??

    BUILD SUCCESSFUL
    Total time: 1 second 
```

echo_output.txt 文件显示如下：

```
 ?? 
    ISO-8859-1 ?? 
    UTF-8 ?? 
    ÿþU n i c o d e L i t t l e   ? ?   

     U n i c o d e L i t t l e U n m a r k e d   ? ? 
```

因此，我的 ANT 环境的设置方式似乎存在根本性错误，因为我不能简单地将字符回显到屏幕或文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:44:23.320

[java.util.Properites](http://docs.oracle.com/javase/6/docs/api/java/util/Properties.html)类使用ISO 8859-1 编码。在使用 Ant 1.8.2 进行测试时，以下内容有效。

**构建.xml**

```
<?xml version="1.0" encoding="UTF-8" ?>
<project name="utf8test" default="all" basedir=".">

<target name="all">
  <loadproperties encoding="ISO-8859-1" srcfile="./apps.properties.all.txt"  />

  <echo>No encoding ${common.app.name}</echo>
  <echo encoding="ISO-8859-1">ISO-8859-1 ${common.app.name}</echo>
</target>
</project> 
```

**输出**

```
all:
     [echo] No encoding æå
     [echo] ISO-8859-1 我們

BUILD SUCCESSFUL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:40:18.510

我通过首先通过此编码器传递所有输入（属性文件）解决了我在 Windows 和 MacOS 上的问题。当输入以这种方式转义时，ANT 可以正确读取并写入值。

```
 StringBuffer buffer = new StringBuffer();
 try 
 {
            FileInputStream fis = new FileInputStream(input);
            InputStreamReader isr = new InputStreamReader(fis, "UTF8");
            Reader in = new BufferedReader(isr);    
            int ch;
            while ((ch = in.read()) > -1)
            {
                if (ch > 127 || ch < 0) 
                {
                    String hex = Integer.toHexString(ch);
                    switch (hex.length()) 
                    {
                        case 1:
                        buffer.append("\\u000");
                        break;
                        case 2:
                        buffer.append("\\u00");
                        break;
                        case 3:
                        buffer.append("\\u0");
                        break;
                        case 4:
                        default:
                        buffer.append("\\u");
                        break;
                    }
                    buffer.append(hex);
                } 
                else if (ch != 0) 
                {
                    buffer.append((char) ch);
                }
            }//while
            in.close();

        //System.out.println(buffer.toString());

    }//try
    catch (IOException e) 
    {
            //e.printStackTrace();
            throw new BuildException(e.getMessage() );
    }
try 
    {
        FileOutputStream fos = new FileOutputStream(dest);
        Writer out = new OutputStreamWriter(fos, "windows-1252");
        out.write(buffer.toString());
        out.close();
    }
        catch (IOException e) 
    {
        throw new BuildException(e.getMessage() );
    } 
```

# c# - MVC 路由与部分类

> ID：11089819
> 
> 赞同：2
> 
> 时间：2012-06-18T19:38:06.793
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

我有一个失控的请求控制器，我想在几个控制器上划分操作，同时保持一个干净的 URL。我正在尝试路由，但没有成功。我已经阅读了一些关于路由的示例和教程，但是，虽然我理解了这些示例，但似乎没有任何内容适用于我的案例，而且我觉得不明智。我想要的是`Requests/Approval`在我的 ApprovalController 而不是我的 RequestController 上处理 URL，所以我写了以下内容。

```
public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

        routes.MapRoute(
            "Approval",
            "Request/{controller}/{action}",
            new { controller = "Approval", action="Index", id = "" }
        );

    } 
```

但它不起作用。为什么？我的视图中有一个名为 Approval 的文件夹，其中有一个名为`Index.cshtml`. 我应该如何编码 MapRoute？

**编辑**

我添加了我拥有的所有路线

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T19:44:43.997

您需要交换两个 MapRoute 语句，如下所示：

```
routes.MapRoute(
    "Approval",
    "Request/Approval/{action}",
    new { controller = "Approval", action="Index", id = "" }
);

routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

它当前不起作用的原因是因为第一个语句（“默认”路由名称）在第二个语句甚至被评估之前就已经匹配了。

此外（如我上面的示例中所述），您需要在 Approval 路由中删除“{controller}”并替换为“Approval”...除非您特别想要 URL /Request/{ANY controller}/{action}通过，我对此表示怀疑。从您的问题来看，您似乎只希望 /Request/Approval/ 转到您的 Approval 控制器。

不要忘记将默认路由保留在底部，以匹配您的其他控制器和操作。如果不存在其他匹配项，它可以作为一个包罗万象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:46:59.473

您映射路线的顺序很重要。将第二条路线移到默认路线之前。

但是，您仍然会遇到问题，因为任何事情`/request/something`都会寻找`SomethingContoller`. 要解决此问题，请将您的路线更改为：

```
routes.MapRoute(
        "Approval",
        "Request/Approval/{action}",
        new { controller = "Approval", action="Index", id = "" }
    ); 
```

# python - Python 和 MySQL 不正确的字符串值

> ID：11089820
> 
> 赞同：1
> 
> 时间：2012-06-18T19:38:14.857
> 
> 标签：python, mysql, character-encoding

我知道以前有人问过这个问题，但提出的解决方案似乎不起作用。我正在尝试将文本插入表格，但我不断收到以下信息：

```
Warning: Incorrect string value: '\xEBrt of...' for column 'title' at row 1 
```

有问题的字符是：ë

这是表格的外观：

```
CREATE TABLE `rstest_article` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `source_id` int(11) NOT NULL,
  `title` varchar(200) NOT NULL DEFAULT '',
  `link` varchar(200) NOT NULL DEFAULT '',
  `content` longtext NOT NULL,
  `description` longtext NOT NULL,
  PRIMARY KEY (`id`),
  KEY `rstest_article_89f89e85` (`source_id`),
  CONSTRAINT `source_id_refs_id_c47b907b` FOREIGN KEY (`source_id`) REFERENCES `rstest_source` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=606 DEFAULT CHARSET=utf8; 
```

我正在从另一个具有相同字符集的数据库中获取文本，如下所示：

```
_cursor.execute('SELECT title,link,content,descr,channel FROM articles')
    rows = _cursor.fetchall()
    for row in rows:
        article = Article(source=src,title=row[0],link=row[1],content=row[2],description=row[3])
        article.save() 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:48:33.053

尝试更改表格的排序规则。

```
ALTER TABLE rstest_article CHARACTER SET utf8 COLLATE UTF8_general_ci; 
```

或仅更改一列的排序规则。

```
ALTER TABLE rstest_article MODIFY COLUMN title varchar(200) DEFAULT '' CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL; 
```

您还可以检查您的 python 代码，您如何存储标题。

```
title = u'unicode_string'.encode('unicode_escape') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T02:35:31.920

需要对特殊字符进行转义，Mysqldb有escape_string函数用于对特殊字符进行转义为：
假设一个变量title存储字符串，需要在db的title列中输入。

标题 = MySQLdb.escape_string(标题)

为了从标题字符串中转义**' 和 "**您必须创建类似以下的查询：

q = ''' 插入 rstest_article(title) values("%s") ''' % (title)

这应该可以解决问题:)

# ruby-on-rails - 如何确定 Ruby 中是否存在 I18n 命名空间

> ID：11089823
> 
> 赞同：0
> 
> 时间：2012-06-18T19:38:22.207
> 
> 标签：ruby-on-rails, ruby, internationalization

我正在尝试为 I18n gem 编写一个自定义异常处理程序，它将覆盖默认的“翻译丢失”错误，并在特殊情况下抛出嘈杂的异常，例如当缺少语言环境和缺少顶级命名空间时。缺少语言环境只是检查 if 的问题`available_locales.include?(locale)`，但是我如何查看是否定义了命名空间？本质上，我想要以下功能：

```
def caption
  begin
    I18n.t("event.welcome", :locale => :en)
  rescue MissingNamespace # should be thrown when "event" doesn't exist as a key under :en, (I18n would normally overspecify and say that "event.welcome" as a full key doesn't exist"
    "Namespace is missing"
  rescue
    #other stuff
  end
end 
```

有没有办法做到这一点？或者我只能根据一个键查找？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T01:18:32.560

这是诀窍：

```
module I18n
  def namespace_missing?(locale, key)
    namespace = key.split(".")[0] # assuming you want the top level namespace
    !backend.send(:translations)[locale][namespace] # this presupposes locale exists
  end
end 
```

...然后你可以把它扔到你的异常处理程序中

# iphone - 为 iphone 游戏实现菜单系统的好方法是什么？

> ID：11089824
> 
> 赞同：0
> 
> 时间：2012-06-18T19:38:22.870
> 
> 标签：iphone, objective-c, xcode, uiviewcontroller, menu

我正在做一个项目，我被要求添加一个相当详细和嵌套的菜单系统，以覆盖预先存在的游戏玩法。一般来说，我是 iphone 编程的新手，但对不同平台上的其他 C 语言有经验。我正在寻找一个好的干净菜单系统架构的例子。

到目前为止，我已经有点习惯了 xib 文件如何与代码交互，但我似乎还有很长的路要走。我有两个 UIViewController；让我们称它们为 UIViewControllerA 和 UIViewControllerB。我从 UIViewControllerA（游戏的主视图控制器）开始，想将 UIViewControllerB 作为菜单添加到游戏窗口的顶部。我发现让 UIViewControllerB 呈现的唯一方法是将其用作 UIViewControllerA 的数据成员并将其作为子视图添加到 UIViewControllerA。

这似乎是组织该系统的一种非常不干净的方式，并引入了一些错误。IE - 当我显示 UIViewControllerB 时，触摸事件会落入我不想要的 UIViewControllerA。

对不起，这很长，但我会直奔主题。有没有人对如何创建一个干净而强大的菜单系统有很好的建议？我觉得我好像离题了。我认为我没有足够的经验在这个平台上提出一个好的系统。

提前致谢！

编辑：

我觉得也许我没有说明我正在寻求技术编程设计而不是视觉设计的帮助。我正在寻找一种为 iphone 平台实现状态机类型架构的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:44:33.047

拥有干净的菜单页面的一种非常简单的方法，只需拍摄硬木地板的照片（或从网络上）并添加按钮。我会举一个例子，但我需要10分......

拍照，到 PS (photoshop) 上并添加一个框或正方形，添加阴影和一些很酷的特效，将其上传到 xcode，但框中的按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:54:35.747

查看此链接 - [https://github.com/relikd/OGActionChooser](https://github.com/relikd/OGActionChooser)

它是 UIActionSheet 或 UIAlertView 的漂亮替代品 - 可以轻松定制以呈现模式菜单系统。

# c++ - CreateProcess 成功，但 GetLastError() 返回拒绝访问

> ID：11089825
> 
> 赞同：1
> 
> 时间：2012-06-18T19:38:23.203
> 
> 标签：c++, access-denied, createprocess, getlasterror

`CreateProcess()`由于和的返回值冲突，我有点困惑`GetLastError()`。当我`CreateProcess()`以类似于下面的方式使用时，它成功并且似乎完成了它所需的任务。然而，`GetLastError()`仍然返回 Access is Denied。

如果访问被拒绝，为什么它似乎完成了任务。相反，如果`CreateProcess()`成功，为什么`GetLastError()`返回访问被拒绝？

还是我的用法`GetLastError()`不正确？我只应该在`CreateProcess()`返回失败值时使用它吗？（我对以下行为的理由是我认为安全总比抱歉好）

```
 SetLastError(0);
    hello = CreateProcess(_T("C:\\Windows\\System32\\cmd.exe"), 
        _T("C:\\Windows\\System32\\cmd.exe /C ant debug"),
        NULL,NULL,false,0,NULL,
        _T("C:\\My\\Directory"),&siStartupInfo, &piProcessInfo);
    FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM |FORMAT_MESSAGE_ALLOCATE_BUFFER 
        |FORMAT_MESSAGE_IGNORE_INSERTS,NULL,GetLastError(), 
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), 
        (LPTSTR)&errorText, 0, NULL); 
    AfxMessageBox(errorText); 
```

这种行为正常吗？在`CreateProcess()`文档中，它提到了`GetLastError()`在`CreateProcess()`失败时使用，但没有提到相反的情况。不批评文档，只是想澄清一下。

无论 in 的第二个参数是否存在，都会发生这种`CreateProcess()`情况`NULL`。也许它与`cmd.exe`权限有关？如果是这样，不应该`CreateProcess()`失败吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:46:39.457

从文档`GetLastError`

> 设置最后一个错误代码的每个函数的文档的返回值部分记录了函数设置最后一个错误代码的条件。大多数设置线程最后错误代码的函数在失败时都会设置它。但是，**某些函数在成功时也会设置最后一个错误代码**。[强调我的]

我认为您会获得经验丰富的结果，因为成功后`CreateProcess`不会设置错误值`GetLastError`返回。相反，您的调用会`GetLastError`返回由之前调用的另一个函数设置的错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:45:22.640

`GetLastError`只有当文档说明它有意义时才有意义。

`GetLastError`返回用 设置的 Win32 线程最后一个错误`SetLastError`。由于函数只应该在记录它们这样做时设置或清除最后一个错误，如果没有发生，最后一个错误很可能包含一个不相关的早期错误。

据记录，`CreateProcess`如果失败，将设置最后一个错误，而不是如果成功。所以你应该忽略它。

# facebook-graph-api - 从朋友和朋友的朋友那里获得雇 主的数量 - facebook 应用程序

> ID：11089827
> 
> 赞同：0
> 
> 时间：2012-06-18T19:38:31.847
> 
> 标签：facebook-graph-api, facebook-fql

我知道使用friends_work_history 权限，我们可以访问朋友的工作历史。现在，我有 150 个朋友，在这 150 个朋友中，有 45 个朋友授权了这个应用程序。

正因为如此，我有那45个朋友的朋友的工作经历。

现在，我需要计算您的朋友和您朋友的朋友的唯一雇主总数，他们已经授权了 Facebook 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:45:31.623

FQL 和 Graph API 都没有`count`方法。您需要从查询中获取结果并使用另一种编程语言计算这些结果。

# ios - 如何在 iPhone 应用程序中断开连接后知道互联网是否处于活动状态

> ID：11089828
> 
> 赞同：0
> 
> 时间：2012-06-18T19:38:38.820
> 
> 标签：ios, uitableview, internet-connection

我创建了一个显示RSSS 的tableview。我检查互联网连接，然后将 RSS 提要加载到 tableview 中，如果互联网不可用，它会显示网络错误警报并显示空 tableview。但是我想在互联网连接激活时加载 tableview。 **有什么方法可以知道在 iPhone 应用程序断开连接后互联网连接何时变为活动状态。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:40:11.430

是的，使用可达性类。

[http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)

# asp.net - ASP.NET MVC 3 WCF 在负载平衡服务器上不起作用

> ID：11089832
> 
> 赞同：0
> 
> 时间：2012-06-18T19:39:02.673
> 
> 标签：asp.net, asp.net-mvc-3, wcf, load-balancing

我搜索了互联网，但找不到任何像我这样的场景。场景是我有一个 ASP.NET MVC 3 报告应用程序和独立的 WCF 托管服务。我正在为 ASP.NET MVC 3 进行 bin 部署。在我的本地环境和开发服务器上一切正常。我在 ASP.NET MVC 项目中使用服务引用来调用客户端代理。

但是，当我部署到负载平衡的客户端测试环境（ASP.NET 和 WCF 层都位于相同的负载平衡服务器上）时，它失败了。如果我运行本地构建并将端点指向他们的开发 wcf 服务，它工作正常。只有在尝试从测试 URL 本身启动应用程序时才会失败。我收到以下错误（编辑了端点和服务调用信息：

> “System.ServiceModel.CommunicationException：接收对 http:[testserver] 的 HTTP 响应时发生错误。这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于 HTTP 请求上下文被中止服务器（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。---> System.Net.WebException：底层连接已关闭：接收时发生意外错误。---> System.IO .IOException：无法从传输连接读取数据：现有连接被远程主机强制关闭。---> System.Net.Sockets.SocketException：现有连接被远程主机在 System.Net 强制关闭。 Sockets.NetworkStream.Read(Byte[] 缓冲区，Int32 偏移量，Int32 size) --- 内部异常堆栈跟踪结束 --- 在 System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) at System.Net.PooledStream.Read(Byte[] buffer , Int32 偏移量, Int32 大小) 在 System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead) --- 内部异常堆栈跟踪结束 --- 在 System.Net.HttpWebRequest.GetResponse() 处。 ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) --- 内部异常堆栈跟踪结束 --- 服务器堆栈跟踪：在 System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason ) 在 System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel。HttpChannelRequest.WaitForReply(TimeSpan timeout) at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object [] outs, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) 在 [0] 处重新抛出异常：在 System.Runtime。 Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) at ReportingApp.UserClientProxy.IUser.GetUsersBetween(DateTime start,DateTime end) at ReportingApp.Controllers.HomeController.PopulateResultsTable(ReportingViewModel vm) at ReportingApp.Controllers.HomeController.Index() at lambda_method(Closure , ControllerBase , Object[] ) at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext,字典`2 parameters) at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 个参数）在 System.Web.Mvc.ControllerActionInvoker.<> *c_DisplayClass15.b* _12() 在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter（IActionFilter 过滤器，ActionExecutingContext preContext，Func `1 continuation) at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 过滤器，ActionDescriptor actionDescriptor，IDictionary`2 参数）在 System.Web.Mvc.ControllerActionInvoker.InvokeAction（ControllerContext 控制器上下文，字符串 actionName）”

我的 ASP.NET wcf 配置如下：

```
<bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IUser" closeTimeout="00:10:00"
          openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="5242880" maxBufferPoolSize="5242880" maxReceivedMessageSize="5242880"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="5242880" maxStringContentLength="5242880" maxArrayLength="5242880"
            maxBytesPerRead="5242880" maxNameTableCharCount="5242880" />
          <security mode="None" >
            <transport clientCredentialType="None" proxyCredentialType="None" realm=""/>
            <message clientCredentialType="UserName"/>
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="[testEndPoint]" binding="basicHttpBinding"
        bindingConfiguration="BasicHttpBinding_IUser" contract="UserClientProxy.IUser"
        name="BasicHttpBinding_IUser" /> 
```

我的服务网络配置如下所示：

```
 <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
          <!--Doubled from value again to resolve issues with the reporting process.-->
          <dataContractSerializer maxItemsInObjectGraph="524288" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <bindings>
      <basicHttpBinding>
        <binding maxBufferSize="5242880" maxBufferPoolSize="5242880" maxReceivedMessageSize="5242880">
          <readerQuotas maxDepth="5242880" maxStringContentLength="5242880" maxArrayLength="5242880"
           maxBytesPerRead="5242880" maxNameTableCharCount="5242880" />
        </binding>
      </basicHttpBinding>
    </bindings>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer> 
```

知道可能导致此问题的原因是什么吗？可能是权限问题还是配置问题？我很困惑，因为它从我的本地构建指向客户端测试环境端点工作。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-23T18:37:22.097

我知道这个答案已经晚了，但是我的 Rest 服务也有类似的问题，它们在我们的开发服务器上运行良好，然后当我们将它们部署到负载平衡池时它们停止工作，并且它们调用了另一个服务在负载平衡池上。

一旦我们打开源地址转换，我们就可以开始工作。我们的 Web 管理员不得不将 F5 池中的 Translation 设置更改为 SNAT 池。此链接为您的网络人员提供了更多信息。

[https://support.f5.com/kb/en-us/products/lc_9_x/manuals/product/lc_config_guide_10_1/lc_addrtrans.html](https://support.f5.com/kb/en-us/products/lc_9_x/manuals/product/lc_config_guide_10_1/lc_addrtrans.html)

因此，如果服务正常工作，现在调用负载平衡的东西时失败，这可能会有所帮助。

# timezone - 夏令时标准时间重复几小时

> ID：11089833
> 
> 赞同：0
> 
> 时间：2012-06-18T19:39:03.530
> 
> 标签：timezone, dst

我目前有一个存储为时区 UTC 日期时间的 DateTimes 列表。当我从 UTC 转换为本地日期时间并且日期落在夏令时标准时间的开始时，重复的时间是凌晨 1 点而不是凌晨 2 点。

我使用以下内容从 UTC 转换为本地时间。请注意，1am 在 local1 和 local2 中重复。我预计凌晨 2 点会重复。

哪个是对的？

```
 TimeZoneInfo tz = TimeZoneInfo.FindSystemTimeZoneById("Mountain Standard Time");
        //UTC time
        var utc1 = new DateTime(1990, 10, 28, 7, 0, 0);     //This is start of daylight standard time.
        var utc2 = new DateTime(1990, 10, 28, 8, 0, 0);
        var utc3 = new DateTime(1990, 10, 28, 9, 0, 0);
        utc1 = DateTime.SpecifyKind(utc1, DateTimeKind.Utc);
        utc2 = DateTime.SpecifyKind(utc2, DateTimeKind.Utc);
        utc3 = DateTime.SpecifyKind(utc3, DateTimeKind.Utc);

        //Get the local time with adjustment for Daylight standard time, "fall back"
        var local1 = TimeZoneInfo.ConvertTimeFromUtc(utc1, tz); //Returns 1am
        var local2 = TimeZoneInfo.ConvertTimeFromUtc(utc2, tz); //Returns 1am. Should this be 2am?
        var local3 = TimeZoneInfo.ConvertTimeFromUtc(utc3, tz); //Returns 2am 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:45:40.200

在凌晨 2 点，您“退回”到凌晨 1 点（1:59 -> 1），因此重复了凌晨 1 点，而凌晨 2 点仅在一小时后发生。同样，当您“向前跳”时，不会有凌晨 2 点 (1:59 -> 3)

来源：[http](http://aa.usno.navy.mil/faq/docs/daylight_time.php) ://aa.usno.navy.mil/faq/docs/daylight_time.php （美国海军天文台保持美国国防部官方时间（来源：[http ://www.usno.navy.mil/USNO/时间](http://www.usno.navy.mil/USNO/time)））

# jquery - 无法将 JSON 发送到服务器

> ID：11089834
> 
> 赞同：1
> 
> 时间：2012-06-18T19:39:07.477
> 
> 标签：jquery, json, post

由于我稍微更改了代码，因此我无法让服务器识别 JSON POST 请求。以前，对于 for 循环的每次迭代都会发出一个 POST 请求，但现在我已将其更改为包含一个多级 JSON 数组。

```
var json=[];

for (var i=0; i < tourList.length; i++){
  var data = tourList[i];
  json.push({latitude: data.position.ab, longitude: data.position.cb, filename: data.title, stopNum: i});
}

var results= JSON.stringify(json);
console.log(json);
console.log(results);

//this code was previously inside the for loop above, moved it outside
$.ajax({
  type: "POST",
  url: "../includes/phpscripts.php?action=postTour",
  data: results,
  datatype: "json",
  beforeSend: function(x){
    if (x && x.overrideMimeType){
      x.overrideMimeType("application/json;charset=UTF-8");
    }
  },
  success: function(data){
    if (data == "success")
      console.log("Tour update successful");
    else 
      console.log("Tour update failed");
  }
}); 
```

此时，tourList 的长度为 6，`results`基于 Google 地图标记点击并在 Firebug 中生成：

```
[
  {"latitude":43.682211,"longitude":-70.45070499999997,"filename":"../panos/photos/1-prefix_blended_fused.jpg","stopNum":0},
  {"latitude":43.6822,"longitude":-70.45076899999998,"filename":"../panos/photos/2-prefix_blended_fused.jpg","stopNum":1},
  {"latitude":43.682219,"longitude":-70.450828,"filename":"../panos/photos/3-prefix_blended_fused.jpg","stopNum":2},
  {"latitude":43.68218,"longitude":-70.45088699999997,"filename":"../panos/photos/4-prefix_blended_fused.jpg","stopNum":3}
] 
```

但是，没有任何东西显示为`$_POST`变量，就像在调试器中`$_POST`显示的那样。`type: array[0]`所以我没有数据集可以运行`json_decode`。据我所知，JSON 是有效的。问题是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:42:19.453

您没有发送键/值，只有值

在ajax中更改为：

```
 data: {results:results}, 
```

在php中

```
$results=$_POST['results'] 
```

现在你可以使用`json_deocde($results)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:40:49.433

将字符串作为 post var 发送。

```
$.ajax({
  type: "POST",
  url: "../includes/phpscripts.php?action=postTour",
  data: {"json": results},
  dataType: "json",
  beforeSend: function(x){
    if (x && x.overrideMimeType){
      x.overrideMimeType("application/json;charset=UTF-8");
    }
  },
  success: function(data){
    if (data == "success")
      console.log("Tour update successful");
    else 
      console.log("Tour update failed");
  }
}); 
```

访问 json`$_POST["json"]`

我不确定你从你的 PHP 返回什么，但是，如果它是 json，它永远不会等于`"success"`

编辑：还有一个问题。您的`datatype`参数应该是`dataType`，并且此参数仅定义从 PHP 返回的数据类型，而不是您发送的数据类型。

# python - 如何在我的网站空间上使用 python 执行 JSONP ..？

> ID：11089837
> 
> 赞同：2
> 
> 时间：2012-06-18T19:39:12.627
> 
> 标签：python, apache, jsonp

我刚刚检查了我的网络空间，它的签名说：Apache/2.2.9 (Debian) mod_python/3.3.1 Python/2.5.2 mod_ssl/2.2.9 OpenSSL/0.9.8g

这让我希望 Python 能以某种方式得到支持。为什么python被列出两次？mod_python/3.3.1 和 Python/2.5.2 ???

我的网站空间上有一个 cgi-bin 文件夹。

我想做的事：我需要进行跨站点调用以从服务器获取一些文本数据。文本数据不是 JSON，但我想我应该将其转换为 JSON（或者是否可以选择在没有 JSON 的情况下进行跨站点？）

python 脚本获取一些 JSONP 的请求。根据请求（我想我应该以某种方式解析 URL），python 脚本将从网络服务器加载请求的文本数据文件并将其包装在一些 JSON 中并返回它。

有人可以告诉我如何在我的网络空间上使用 python 完成这三个步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:02:38.967

首先，签名没有两次列出 python。它首先列出了[mod_python](http://www.modpython.org/)的版本，这是一个 Apache Web 服务器插件，然后列出了系统上 python 解释器的版本。

[python cgi 模块](http://docs.python.org/library/cgi.html)- 这确实是一种编写 python 服务器代码的低效方法，但就是这样。最终，您应该考虑使用众多令人惊叹的 Python Web 框架之一。但是，使用 cgi 模块，您的响应将始终以此开头：

```
print 'Content-Type: application/json\n\n' 
```

您的 python 脚本将通过 HTTP 请求在服务器上运行。在该脚本中，您将检查请求并根据 URL 值或查询字符串确定要提供的数据。

至少您只需将返回值包装在基本的 JSON 数据结构中。文本数据本身可以只是一个字符串：

```
import json
text_data = "FOO"
json_data = json.dumps({'text': text_data})
print json_data
# {"text": "FOO"} 
```

对于 JSONP 方面，您通常会检查查询字符串以查看请求是否包含客户端想要的回调函数的特定名称，或者只是默认为“回调”

```
print "callback(%s);" % json_data
# callback({"text": "FOO"}); 
```

返回这将是一个 JSONP 类型的响应，因为当客户端收到它时，会为客户端执行回调。

最后，让我补充一点，您应该知道，python cgi 脚本将需要为每个请求（甚至来自同一客户端的重复请求）启动一个全新的 python 解释器进程。这很容易使负载增加的服务器不堪重负。出于这个原因，人们通常选择 wsgi 路由（apache 中的[mod_wsgi](http://code.google.com/p/modwsgi/)）。wsgi 允许持久应用程序继续运行，并处理正在进行的请求。

# eclipse - eclipse加载时出错

> ID：11089841
> 
> 赞同：2
> 
> 时间：2012-06-18T19:39:32.610
> 
> 标签：eclipse

在我的 Eclipse 中，我看到一个窗口中出现错误消息，并且每个项目都有一个红色的 X。

以下是一些错误：

```
An internal error occurred during: "Android Library Update".
java.lang.NullPointerException
parseSdkContent failed
java.lang.NullPointerException
An internal error occurred during: "Initializing Java Tooling".
java.lang.NullPointerException
Parsing Data for android-3 failed
java.lang.NullPointerException 
```

为什么是这样？

我做了什么：我删除了eclipse文件夹并再次下载，现在它可以正常工作了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T05:11:34.547

错误消息表明您的 Android SDK 安装（在 Eclipse 之外）以某种方式损坏。SDK 安装在您在 Window->Preferences->Android->SDK location 中指定的路径中。

您可以删除该文件夹（关闭 Eclipse），从[http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)下载新版本，然后在 Eclipse 中再次运行 Android SDK 管理器（检查是否有更多更新或要安装的驱动程序）。那应该可以解决您的问题。

在此过程中，您的仿真器设备保持不变，它们存储在不同的目录中。

# image - 从选定大小的 tiff 文件中绘制多个帧序列

> ID：11089843
> 
> 赞同：0
> 
> 时间：2012-06-18T19:39:35.393
> 
> 标签：image, matlab, plot, tiff, matlab-figure

我正在分析 .tiff 多帧形式的一些实验数据。在这些 tiff 文件中，我需要可视化和比较一些特定的帧序列。我想生成一个包含我从我选择的文件中选择的帧的图形。文件列表和帧索引列表是通过用户界面生成的，当参数被填充时，它会调用绘图函数。

问题：最好的解决方案是什么，以最佳尺寸绘制所选帧，但保持方形图像（如原始图像）？更简单，如何选择我在图中绘制的每一帧的位置和大小？

我尝试过使用子图：它可以工作，但我无法控制图像大小。

```
pos=0;
for j = 1:length(file_list)
    for i = 1:length(index_list)
         pos=pos+1;
         subplot(size(file_list,1),length(index_list),pos)
         a =imagesc(imread(file_list{j,:},index_list(i))); 
```

我也试过

```
for j = 1:length(file_list)
    for i = 1:length(index_list)
         a =imagesc(imread(file_list{j,:},index_list(i))); 
         set(gca,'Units','Pixels', 'Position', [10+100*i 10+100*j 100 100]); 
```

但似乎我无法在不覆盖最后修改的情况下单独设置它。

最后，我考虑过使用“蒙太奇”，但我将图像保存在列表中的方式似乎并不好。

```
 frm_list=zeros(1,length(FL)*length(index_list));
for j = 1:length(FL)
    for i = 1:length(index_list)
        a =(imread(FL{j,:},index_list(i)));
        frm_list=[frm_list a];
    end
end

montage(frm_list,'Size', [length(FL) length(index_list)]); 
```

谢谢JC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:53:09.953

您可以使用`axis image`来保持原始图像的相同纵横比。

`subplot('Position', [left bottom width height])`允许您指定图像与图形窗口的相对位置。

如果要使用 以外的命令`imagesc`，可以在绘制之前缩放图像的数据范围，然后使用`colormap`对图像应用假着色。

# cocoa - NSView 绘制优先级奇怪的bug

> ID：11089845
> 
> 赞同：1
> 
> 时间：2012-06-18T19:39:36.487
> 
> 标签：cocoa, drawing, nsview

我有 NSTableView 用于显示一些信息，有时我需要在 NSTableView 上方的自定义视图中显示其他信息，但是当我滚动表格时，MyCustomView 在 NSTableView（好！）上方绘制，而 NSScroller 在 MyCustomView（坏...）上方绘制，尽管事实上，MyCustomView 在对象树中高于 NSScroller。我得到的结果显示在正确的图像上。我怎样才能达到左图所示的结果？

![图片](../Images/8c7316ef16cd10a98aae4ba9fc7ed2fb.png)

# ios - Xcode 检索、执行函数并将数据添加到 SQL DB

> ID：11089847
> 
> 赞同：0
> 
> 时间：2012-06-18T19:39:38.523
> 
> 标签：ios, sqlite, xcode4.3

我想我让这变得比它必须的更复杂。我的应用程序中有一个 Sqlite DB。我正在尝试拉出每个位置的纬度/经度，获取 iPhone 与该位置之间的距离，然后将该距离插入数据库。然后我就可以为我的表格视图提取这些数据并按距离排序。如果我以正确的方式进行此操作，请告诉我。

如果这是正确的方法，我仍然对如何更新每行数据中的一个单元格一无所知。

# django - IntegrityError 重复键值违反唯一约束 - django/postgres

> ID：11089850
> 
> 赞同：80
> 
> 时间：2012-06-18T19:39:46.440
> 
> 标签：django, postgresql, duplicates, unique-constraint, database-integrity

我正在跟进[我之前提出的一个问题，](https://stackoverflow.com/questions/11000068/changing-a-weird-mysql-query-to-postgresql-that-uses-group-concat)在该问题中我试图寻求从愚蠢/写得不好的 mysql 查询到 postgresql 的转换。我相信我成功了。无论如何，我使用的是手动从 mysql 数据库移动到 postgres 数据库的数据。我正在使用如下所示的查询：

```
 UPDATE krypdos_coderound cru

  set is_correct = case 
      when t.kv_values1 = t.kv_values2 then True 
      else False 
      end

  from 

  (select cr.id, 
    array_agg(
    case when kv1.code_round_id = cr.id 
    then kv1.option_id 
    else null end 
    ) as kv_values1,

    array_agg(
    case when kv2.code_round_id = cr_m.id 
    then kv2.option_id 
    else null end 
    ) as kv_values2

    from krypdos_coderound cr
     join krypdos_value kv1 on kv1.code_round_id = cr.id
     join krypdos_coderound cr_m 
       on cr_m.object_id=cr.object_id 
       and cr_m.content_type_id =cr.content_type_id 
     join krypdos_value kv2 on kv2.code_round_id = cr_m.id

   WHERE
     cr.is_master= False
     AND cr_m.is_master= True 
     AND cr.object_id=%s 
     AND cr.content_type_id=%s 

   GROUP BY cr.id  
  ) t

where t.id = cru.id
    """ % ( self.object_id, self.content_type.id)
  ) 
```

我有理由相信这很好用。然而，这又引出了一个新问题。尝试提交时，我从 django 收到一条错误消息，指出：

```
IntegrityError at (some url): 
duplicate key value violates unique constraint "krypdos_value_pkey" 
```

我查看了此处发布的一些回复，但我还没有找到解决问题的方法（尽管相关问题已经引起了一些有趣的阅读）。我在我的日志中看到了这一点，这很有趣，因为我从不明确调用 insert-django 必须处理它：

```
 STATEMENT:  INSERT INTO "krypdos_value" ("code_round_id", "variable_id", "option_id", "confidence", "freetext")
   VALUES (1105935, 11, 55, NULL, E'') 
   RETURNING "krypdos_value"."id" 
```

但是，尝试运行会导致重复键错误。实际错误在下面的代码中抛出。

```
 # Delete current coding         CodeRound.objects.filter(object_id=o.id,content_type=object_type,is_master=True).delete()
  code_round = CodeRound(object_id=o.id,content_type=object_type,coded_by=request.user,comments=request.POST.get('_comments',None),is_master=True)
  code_round.save()
  for key in request.POST.keys():
    if key[0] != '_' or key != 'csrfmiddlewaretoken':
      options = request.POST.getlist(key)
      for option in options:
        Value(code_round=code_round,variable_id=key,option_id=option,confidence=request.POST.get('_confidence_'+key, None)).save()  #This is where it dies
  # Resave to set is_correct
  code_round.save()
  o.status = '3' 
  o.save( 
```

我已经检查了序列等，它们似乎是有序的。在这一点上，我不确定该怎么做——我认为这是 django 的结果，但我不确定。任何反馈将不胜感激！

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2012-06-19T01:41:00.280

这发生在我身上——事实证明你需要在 Postgres 中重新同步你的主键字段。关键是SQL语句：

```
SELECT setval('tablename_id_seq', (SELECT MAX(id) FROM tablename)+1); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2016-05-12T10:18:50.520

这似乎是 MySQL 和 SQLite 后端和其他后端（如 Postgres、Oracle 等）之间的已知行为差异（它们更新下一个可用的主键，即使在插入具有显式 id 的对象时也是如此）（它们没有） .

[有一张票描述了同样的问题](https://code.djangoproject.com/ticket/11423)。即使它被关闭为无效，它也提供了一个提示，即有一个 Django 管理命令来更新下一个可用密钥。

要显示更新应用程序*MyApp*的所有下一个 ID 的 SQL ：

```
python manage.py sqlsequencereset MyApp 
```

为了执行该语句，您可以提供它作为**dbshel​​l**管理命令的输入。对于 bash，您可以键入：

```
python manage.py sqlsequencereset MyApp | python manage.py dbshell 
```

管理命令的优点是抽象出底层数据库后端，因此即使稍后迁移到不同的后端也可以工作。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2017-09-22T15:45:50.353

我的“库存”应用程序中有一个现有表，我想在 Django 管理中添加新记录，但出现此错误：

> 重复的键值违反了唯一约束“inventory_part_pkey”详细信息：键 (part_id)=(1) 已存在。

如前所述，我运行下面的代码来获取重置 id-s 的 SQL 命令：

```
python manage.py sqlsequencereset inventory 
```

将管道连接`python manage.py sqlsequencereset inventory | python manage.py dbshell`到外壳不起作用

*   所以我复制了生成的原始 SQL 命令
*   然后为 postgreSQL 打开 pgAdmin3`https://www.pgadmin.org`并打开我的数据库
*   点击 6\. 图标（执行任意 SQL 查询）
*   复制了生成的语句

在我的情况下，原始 SQL 命令是：

```
BEGIN;
SELECT setval(pg_get_serial_sequence('"inventory_signup"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "inventory_signup";
SELECT setval(pg_get_serial_sequence('"inventory_supplier"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "inventory_supplier";
COMMIT; 
```

用F5执行它。

这解决了一切。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-12-21T20:25:52.573

除了 zapphods 回答：

在我的情况下，索引确实不正确，因为我已经删除了所有迁移，并且数据库在开发时可能 10-15 次，因为我没有处于迁移任何阶段。

我收到一个 IntegrityError`finished_product_template_finishedproduct_pkey`

# 重新索引表并重新启动 runserver：

我正在使用 pgadmin3 并且对于哪个索引不正确并抛出重复的键错误，我导航到`constraints`并重新索引。

![在此处输入图像描述](../Images/b56c8af2016c1ee1be7fc7b136abe175.png)

然后重新索引。

![在此处输入图像描述](../Images/1c6c7f3a102a387be528f94259a20be4.png)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-05-10T15:34:42.673

解决方案是您需要重新同步您的主键字段，正如“Hacking Life”所报告的那样，他编写了一个示例 SQL 代码，但正如“Ad N”所建议的那样，最好运行 Django 命令`sqlsequencereset`以获取您可以使用的确切 SQL 代码复制并粘贴或使用另一个命令运行。

作为对这些答案的进一步改进，我建议您和其他读者不要复制和粘贴 SQL 代码，而是更安全地以`sqlsequencereset`这种方式执行从您的 python 代码中生成的 SQL 查询（*使用默认数据库*） ：

```
from django.core.management.color import no_style
from django.db import connection

from myapps.models import MyModel1, MyModel2

sequence_sql = connection.ops.sequence_reset_sql(no_style(), [MyModel1, MyModel2])
with connection.cursor() as cursor:
    for sql in sequence_sql:
        cursor.execute(sql) 
```

**我用Python3.6**、**Django 2.0**和**PostgreSQL 10**测试了这段代码。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-14T17:56:30.450

如果你想像我一样重置所有表上的 PK，你可以使用[PostgreSQL 推荐的方式](https://wiki.postgresql.org/wiki/Fixing_Sequences)：

```
SELECT 'SELECT SETVAL(' ||
       quote_literal(quote_ident(PGT.schemaname) || '.' || quote_ident(S.relname)) ||
       ', COALESCE(MAX(' ||quote_ident(C.attname)|| '), 1) ) FROM ' ||
       quote_ident(PGT.schemaname)|| '.'||quote_ident(T.relname)|| ';'
FROM pg_class AS S,
     pg_depend AS D,
     pg_class AS T,
     pg_attribute AS C,
     pg_tables AS PGT
WHERE S.relkind = 'S'
    AND S.oid = D.objid
    AND D.refobjid = T.oid
    AND D.refobjid = C.attrelid
    AND D.refobjsubid = C.attnum
    AND T.relname = PGT.tablename
ORDER BY S.relname; 
```

运行此查询后，您将需要执行查询的结果。我通常复制并粘贴到记事本中。然后我找到并替换`"SELECT`为`SELECT`和。我复制并粘贴到 pgAdmin III 并运行查询。它重置数据库中的所有表。上面的链接提供了更多“专业”说明。`;"``;`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-18T20:00:04.930

如果您手动复制了数据库，您可能会[遇到此处描述的问题](http://www.vlent.nl/weblog/2011/05/06/integrityerror-duplicate-key-value-violates-unique-constraint/)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-01-02T13:01:14.720

我遇到了这个错误，因为我以错误的方式将额外的参数传递给了 save 方法。

对于遇到这种情况的任何人，请尝试使用以下命令强制更新：

```
instance_name.save(..., force_update=True) 
```

如果您同时遇到无法传递的错误，则`force_insert`可能`force_update`像我一样以错误的方式传递了一些自定义参数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-15T01:08:51.517

我遇到了与 OP 相同的错误。

我创建了一些 Django 模型，基于模型创建了 Postgres 表，并通过 Django Admin 向 Postgres 表添加了一些行。然后我摆弄了模型中的一些列（围绕 ForeignKeys 进行更改等），但忘记了迁移更改。

运行迁移命令解决了我的问题，考虑到上面的 SQL 答案，这是有道理的。

要查看将应用哪些更改，而不实际应用它们：
`python manage.py makemigrations --dry-run --verbosity 3`

如果您对这些更改感到满意，请运行：
`python manage.py makemigrations`

然后运行：
`python manage.py migrate`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-10T09:54:39.377

我遇到了类似的问题，但似乎没有任何效果。如果您需要数据（即在转储时不能排除它），请确保您已关闭（注释）任何 post_save 接收器。我认为数据会被导入，但由于这些，它会再次创建相同的模型。为我工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-16T19:28:52.170

您只需要转到 pgAdmin III 并使用表的名称执行您的脚本：

```
SELECT setval('tablename_id_seq', (SELECT MAX(id) FROM tablename)+1); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-22T21:36:35.187

根据[Paolo Melchiorre 的回答](https://stackoverflow.com/a/50276535/2120931)，我写了一个块作为在任何 .save() 之前调用的函数

```
from django.db import connection
def setSqlCursor(db_table):
    sql = """SELECT pg_catalog.setval(pg_get_serial_sequence('"""+db_table+"""', 'id'), MAX(id)) FROM """+db_table+""";"""
    with connection.cursor() as cursor:
        cursor.execute(sql) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-02T21:45:48.723

这是正确的说法。大多数情况下，当我们插入带有 id 字段的行时会发生这种情况。

```
SELECT setval('tablename_id_seq', (SELECT MAX(id) FROM tablename)); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-03T10:51:04.297

这个问题大约是 9 年前提出的，很多人给出了自己的解决方法。

对我来说，我输入`unique=True`了我的`email`自定义模型字段，但是在创建超级用户时我并没有要求`email`强制。

现在，在创建超级用户后，我的电子邮件字段只是保存为空白或`Null`. 现在这就是我创建和保存新用户的方式

```
obj = mymodel.objects.create_user(username='abc', password='abc')
obj.email = 'abc@abc.com'
obj.save() 
```

它只是在第一行抛出了错误`duplicate-key-value-violates`，因为电子邮件默认设置为空，这与管理员用户相同。**Django 发现了一个重复！**

### 解决方案

*   选项1：在创建任何用户时强制发送电子邮件（对于超级用户也是如此）
*   选项 2：删除`unique=True`并运行迁移
*   选项3：如果您不知道重复项在哪里，您可以删除该列，也可以使用清除数据库`python manage.py flush`

**强烈建议您了解您的案例中发生错误的原因。**

# php - PHP SDK Facebook 中的错误 - 奇怪的错误

> ID：11089851
> 
> 赞同：-1
> 
> 时间：2012-06-18T19:39:53.700
> 
> 标签：php, facebook, sdk

```
 if(isset($basic)){
    function meme(){
    $i = 1;
    while(file_exists("pg/".$i.".jpg")){
    $file[$i] = "pg/".$i.".jpg";
    $i++;
    }
    }
    $file[1] = 'pg_1.jpg';
    $file[2] = 'pg_2.jpg';
    $file[3] = 'pg_3.jpg';
    $file[4] = 'pg_4.jpg';
    $file[5] = 'pg_5.jpg';
    $file[6] = 'pg_6.jpg';
    $file[7] = 'pg_7.jpg';
    $file[8] = 'pg_8.jpg';
    $file[9] = 'pg_9.jpg';
    $file[10] = 'pg_10.jpg';
    $file[11] = 'pg_11.jpg';
    $file[12] = 'pg_12.jpg';
    $file[13] = 'pg_13.jpg';
    $file[14] = 'pg_14.jpg';

    $tuomeme = 'pg/'.$file[rand(1, 14)];
    $album_details = array(
            'message'=> 'CiaoCiao',
            'name'=> 'CiaoCiaoCiao'
    );
    $create_album = $facebook->api('/me/albums', 'post', $album_details) or die("Errore nella connessione con Facebook");
    $album_uid = $create_album['id'];
    $photo_details = array(
        'message'=> he(idx($basic, 'name')).''
    );
    $finale=$tuomeme;
    $photo_details['image'] = '@' . realpath($finale);
    $upload_photo = $facebook->api('/'.$album_uid.'/photos', 'post', $photo_details) or die("Errore nella connessione con Facebook"); 
```

**粗体**错误是：

> [2012 年 6 月 18 日 19:30:32 UTC] PHP 警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由（输出开始于 /home/xtigbexz/public_html/dev/index .php:27) 在第 7 行的 /home/public_html/sdk_php/facebook.php [18-Jun-2012 19:30:32 UTC] PHP 警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 第 7 行 [2012 年 6 月 18 日 19:30:36 UTC ] PHP致命错误：未捕获的CurlException：26：无法打开文件“”
> 
> 在第 423 行抛出 /home/public_html/sdk_php/base_facebook.php

你能帮助我吗？请！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:52:04.433

文件的第 27 行`/home/xtigbexz/public_html/dev/index.php`正在生成输出。之后您正在调用 Facebook API，它试图设置一个`$_SESSION`或`$_COOKIE`变量。在脚本生成一些输出后，您无法设置其中任何一个。

# ruby-on-rails - 直接连接到 Rails 中的数据库（Heroku？）

> ID：11089852
> 
> 赞同：0
> 
> 时间：2012-06-18T19:40:01.713
> 
> 标签：ruby-on-rails, heroku

我目前正在编写 RoR 应用程序并使用 Heroku 进行部署。

有没有办法使用连接字符串直接连接到数据库？

我想我在这里要问的是我可以直接连接到数据库吗，是否有连接字符串，如何获取连接字符串等。我希望能够在我正在开发的终端之外的数据库上执行查询. 我目前的解决方案是使用

```
heroku db:pull 'anotherPOSTGRESQLdatabasesCONNECTIONstring' 
```

然后对该数据库执行查询，但这不是一个有效的解决方案，因为我正在为不精通代码的用户开发此应用程序，他们应该能够在没有我或他们使用终端的情况下对数据库执行查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:20:25.453

我想你可能会问什么可以在这里找到： [https ://postgres.heroku.com/](https://postgres.heroku.com/)

单击“免费试用”，选择您已经拥有 heroku 帐户的选项，使用正确的凭据登录。

现在您可以选择要对其执行操作的数据库，并创建您的客户端可以运行的“数据剪辑”以获取数据报告等（数据剪辑可用于运行任意选择 SQL 命令）。

# java - Java - 在导出期间设置应用程序包版本

> ID：11089853
> 
> 赞同：1
> 
> 时间：2012-06-18T19:40:02.340
> 
> 标签：java

所以我有一个字符串，它代表我正在处理的静态程序版本。我在很多地方都使用它，这就是我创建一个全局变量的原因。

问题：将我的项目导出为 Mac 应用程序包时，是否可以将 info.plist 中的 CFBundleVersion 设置为该字符串？如果没有，我可以在导出期间将其设置为任何内容，还是必须在之后手动完成？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:47:16.460

您可以使用 Maven 资源过滤机制将变量导出到某些文件： http: [//www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-description.html](http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-description.html)

我用它来导出当前版本和项目的构建日期：

1.  我有一个名为的文件`"release.properties"`，`"D:\workspace\...\src\main\resources"`其中包含一些变量

    ```
    # release version
    version=${project.version}_${svninfo.committedRevision}

    # date when the current release was built
    build_date=${buildDate} 
    ```

2.  在我的 pom.xml 中，我声明了一组资源，Maven 将解析这些资源并用相应的值填充变量

    ```
    <resources>
       <resource>
         <directory>D:\workspace\...\src\test\resources</directory>
       </resource>
       <resource>
         <filtering>true</filtering>
         <directory>D:\workspace\...\src\main\resources</directory>
         <includes>
           <include>**/release.properties</include>
         </includes>
       </resource>
       <resource>
         <filtering>false</filtering>
         <directory>D:\workspace\...\src\main\resources</directory>
         <excludes>
           <exclude>**/release.properties</exclude>
         </excludes>
       </resource>
    </resources> 
    ```

# jquery - jQuery全屏背景图片

> ID：11089855
> 
> 赞同：0
> 
> 时间：2012-06-18T19:40:10.347
> 
> 标签：jquery, image, background, fullscreen, slideshow

我需要一个 jQuery 插件的帮助，它可以将图像缩放到全屏，并且仍然允许用户将内容放在它下面。例如：

[www.burton.com](http://www.burton.com/)

上面的网站有一个全屏图像，下面还有内容。有人可以告诉我如何做到这一点吗？

我尝试了不同的 jQuery Image 幻灯片插件，但仍然无法完成。我将在我的学校项目中使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T14:40:14.087

试试这个 > [MaxImage 2.0 - jQuery 全屏背景幻灯片插件](http://jquery-plugins.net/maximage-2-0-jquery-fullscreen-background-slideshow-plugin#)

# c# - 以编程方式添加按钮列

> ID：11089860
> 
> 赞同：3
> 
> 时间：2012-06-18T19:40:21.743
> 
> 标签：c#, asp.net, gridview, webforms

我正在尝试以编程方式将 a 添加`ButtonField`到 a 中。`GridView`

所以在 aspx 中它看起来像这样：

```
<asp:ButtonField ButtonType="Image" 
                 CommandName="buttonClicked" 
                 ImageUrl="~/checkdailyinventory.bmp" /> 
```

这是我在 C# 中尝试复制的内容。

```
 GridView genGridView = new GridView();

        //Where the xml gets bonded to the data grind
        XmlDataSource xds = new XmlDataSource();
        xds.Data = xml;
        xds.DataBind();
        xds.EnableCaching = false;

        genGridView.DataSource = xds;
        genGridView.DataBind();

        // formating is done here

        ButtonField test3 = new ButtonField();
        test3.ButtonType = ButtonType.Image;
        test3.CommandName = "buttonClicked";
        test3.ImageUrl = "~/checkdailyinventory.bmp";
        genGridView.Columns.Add(test3); 
```

这不会创建任何新列任何帮助都会有所帮助。

# 更新进度

我能够创建列，但它们是第一列，而不是最后一列。为此，我必须在数据绑定之前创建按钮并添加列。

```
GridView genGridView = new GridView();

        //Where the xml gets bonded to the data grind
        XmlDataSource xds = new XmlDataSource();
        xds.Data = xml;
        xds.DataBind();
        xds.EnableCaching = false;

        //Set the rowdatabound before binding.  This will allow the correct function to be called.
        genGridView.RowDataBound += new GridViewRowEventHandler(inventoryGridView_RowDataBound);
        genGridView.RowCommand += new GridViewCommandEventHandler(inventoryGridView_RowCommand);

        ButtonField test3 = new ButtonField();
        test3.ButtonType = ButtonType.Image;
        test3.CommandName = "buttonClicked";
        test3.ImageUrl = "checkdailyinventory.bmp";

        genGridView.Columns.Add(test3);
        genGridView.DataSource = xds;
        genGridView.DataBind(); 
```

即使我正确设置了所有变量，该按钮也无法实际执行任何操作，但我猜是一次一步。

小编辑：

我想我知道为什么按钮不起作用了。在 html 中，它应该如下所示：

```
<td><input type="image" src="checkdailyinventory.bmp" onclick="javascript:__doPostBack('inventoryGridView','buttonClicked$2')" style="border-width:0px;" /></..> 
```

虽然它实际上看起来像这样：

```
<td><input type="image" src="checkdailyinventory.bmp" onclick="javascript:__doPostBack('ctl03','buttonClicked$2')" style="border-width:0px;" /></..> 
```

所以我需要弄清楚如何`ct103`替换`inventoryGridView`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:34:59.363

看起来您正在后面的代码中创建 genGridView 但没有将其添加到您的页面中。

我收集 GridView 是在标记中定义的。如果是这样，请尝试删除该行

```
GridView genGridView = new GridView(); 
```

并且您应该能够将您的列添加到页面上的对象中。

提示：您可能还需要在 OnInit（或从 OnInit 调用的方法）中添加项目。

# php - Symfony2 实体集合 - 如何添加/删除与现有实体的关联？

> ID：11089861
> 
> 赞同：69
> 
> 时间：2012-06-18T19:40:25.930
> 
> 标签：php, forms, collections, symfony, entity

# 1\. 快速概览

### 1.1 目标

我想要实现的是创建/编辑用户工具。可编辑的字段是：

*   用户名（类型：文本）
*   普通密码（类型：密码）
*   电子邮件（类型：电子邮件）
*   组（类型：集合）
*   avoRoles（类型：集合）

*注意：最后一个属性没有命名为**$roles**，因为我的 User 类扩展了 FOSUserBundle 的 User 类并且覆盖角色带来了更多问题。为了避免它们，我只是决定将我的角色集合存储在**$avoRoles**下。*

### 1.2 用户界面

[我的模板](http://rockoweogrodki.radiowww.eu/tmp/scr1.png)由两部分组成：

1.  用户表单
2.  显示 $userRepository->findAllRolesExceptOwnedByUser($user); 的表格

*注意：findAllRolesExceptOwnedByUser() 是一个自定义存储库函数，返回所有角色的子集（那些尚未分配给 $user 的角色）。*

### 1.3 所需功能

1.3.1 添加角色：

```
    当用户单击角色表中的“+”（添加）按钮时，  
     jquery 从角色表中删除该行  
    并且  jquery 将新列表项添加到用户表单（avoRoles 列表）
```

 **1.3.2 移除角色：

```
    当用户单击用户表单（avoRoles 列表）中的“x”（删除）按钮时，  
     jquery 从用户表单（ avoRoles列表）中删除该列表项，  
    并且  jquery 将新行添加到角色表

```

1.3.3 保存更改：

```
    当用户单击“Zapisz”（保存）按钮  
    时，用户表单提交所有字段（用户名、密码、电子邮件、avoRoles、组）  
    并将avoRoles  保存为角色实体的 ArrayCollection（ManyToMany 关系）  
    并将组保存为角色实体  的 ArrayCollection（多对多关系）  

```

*注意：只有现有的角色和组可以分配给用户。如果由于任何原因未找到该表格，则不应验证该表格。*

* * *

# 2.代码

在本节中，我将介绍/或简要描述此操作背后的代码。如果描述不够，您需要查看代码，请告诉我，我会粘贴它。我并不是一开始就将其全部粘贴，以避免向您发送不必要的代码垃圾邮件。

### 2.1 用户类

我的用户类扩展了 FOSUserBundle 用户类。

```
namespace Avocode\UserBundle\Entity;

use FOS\UserBundle\Entity\User as BaseUser;
use Doctrine\ORM\Mapping as ORM;
use Avocode\CommonBundle\Collections\ArrayCollection;
use Symfony\Component\Validator\ExecutionContext;

/**
 * @ORM\Entity(repositoryClass="Avocode\UserBundle\Repository\UserRepository")
 * @ORM\Table(name="avo_user")
 */
class User extends BaseUser
{
    const ROLE_DEFAULT = 'ROLE_USER';
    const ROLE_SUPER_ADMIN = 'ROLE_SUPER_ADMIN';

    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\generatedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\ManyToMany(targetEntity="Group")
     * @ORM\JoinTable(name="avo_user_avo_group",
     *      joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id")},
     *      inverseJoinColumns={@ORM\JoinColumn(name="group_id", referencedColumnName="id")}
     * )
     */
    protected $groups;

    /**
     * @ORM\ManyToMany(targetEntity="Role")
     * @ORM\JoinTable(name="avo_user_avo_role",
     *      joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id")},
     *      inverseJoinColumns={@ORM\JoinColumn(name="role_id", referencedColumnName="id")}
     * )
     */
    protected $avoRoles;

    /**
     * @ORM\Column(type="datetime", name="created_at")
     */
    protected $createdAt;

    /**
     * User class constructor
     */
    public function __construct()
    {
        parent::__construct();

        $this->groups = new ArrayCollection();        
        $this->avoRoles = new ArrayCollection();
        $this->createdAt = new \DateTime();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set user roles
     * 
     * @return User
     */
    public function setAvoRoles($avoRoles)
    {
        $this->getAvoRoles()->clear();

        foreach($avoRoles as $role) {
            $this->addAvoRole($role);
        }

        return $this;
    }

    /**
     * Add avoRole
     *
     * @param Role $avoRole
     * @return User
     */
    public function addAvoRole(Role $avoRole)
    {
        if(!$this->getAvoRoles()->contains($avoRole)) {
          $this->getAvoRoles()->add($avoRole);
        }

        return $this;
    }

    /**
     * Get avoRoles
     *
     * @return ArrayCollection
     */
    public function getAvoRoles()
    {
        return $this->avoRoles;
    }

    /**
     * Set user groups
     * 
     * @return User
     */
    public function setGroups($groups)
    {
        $this->getGroups()->clear();

        foreach($groups as $group) {
            $this->addGroup($group);
        }

        return $this;
    }

    /**
     * Get groups granted to the user.
     *
     * @return Collection
     */
    public function getGroups()
    {
        return $this->groups ?: $this->groups = new ArrayCollection();
    }

    /**
     * Get user creation date
     *
     * @return DateTime
     */
    public function getCreatedAt()
    {
        return $this->createdAt;
    }
} 
```

### 2.2 角色类

我的角色类扩展了 Symfony 安全组件核心角色类。

```
namespace Avocode\UserBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Avocode\CommonBundle\Collections\ArrayCollection;
use Symfony\Component\Security\Core\Role\Role as BaseRole;

/**
 * @ORM\Entity(repositoryClass="Avocode\UserBundle\Repository\RoleRepository")
 * @ORM\Table(name="avo_role")
 */
class Role extends BaseRole
{    
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\generatedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\Column(type="string", unique="TRUE", length=255)
     */
    protected $name;

    /**
     * @ORM\Column(type="string", length=255)
     */
    protected $module;

    /**
     * @ORM\Column(type="text")
     */
    protected $description;

    /**
     * Role class constructor
     */
    public function __construct()
    {
    }

    /**
     * Returns role name.
     * 
     * @return string
     */    
    public function __toString()
    {
        return (string) $this->getName();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Role
     */
    public function setName($name)
    {      
        $name = strtoupper($name);
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set module
     *
     * @param string $module
     * @return Role
     */
    public function setModule($module)
    {
        $this->module = $module;

        return $this;
    }

    /**
     * Get module
     *
     * @return string 
     */
    public function getModule()
    {
        return $this->module;
    }

    /**
     * Set description
     *
     * @param text $description
     * @return Role
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return text 
     */
    public function getDescription()
    {
        return $this->description;
    }
} 
```

### 2.3 组类

由于我对组和角色有同样的问题，所以我在这里跳过它们。如果我让角色发挥作用，我知道我可以对组做同样的事情。

### 2.4 控制器

```
namespace Avocode\UserBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\Security\Core\SecurityContext;
use JMS\SecurityExtraBundle\Annotation\Secure;
use Avocode\UserBundle\Entity\User;
use Avocode\UserBundle\Form\Type\UserType;

class UserManagementController extends Controller
{
    /**
     * User create
     * @Secure(roles="ROLE_USER_ADMIN")
     */
    public function createAction(Request $request)
    {      
        $em = $this->getDoctrine()->getEntityManager();

        $user = new User();
        $form = $this->createForm(new UserType(array('password' => true)), $user);

        $roles = $em->getRepository('AvocodeUserBundle:User')
                    ->findAllRolesExceptOwned($user);
        $groups = $em->getRepository('AvocodeUserBundle:User')
                    ->findAllGroupsExceptOwned($user);

        if($request->getMethod() == 'POST' && $request->request->has('save')) {
            $form->bindRequest($request);

            if($form->isValid()) {
                /* Persist, flush and redirect */
                $em->persist($user);
                $em->flush();
                $this->setFlash('avocode_user_success', 'user.flash.user_created');
                $url = $this->container->get('router')->generate('avocode_user_show', array('id' => $user->getId()));

                return new RedirectResponse($url);
            }
        }

        return $this->render('AvocodeUserBundle:UserManagement:create.html.twig', array(
          'form' => $form->createView(),
          'user' => $user,
          'roles' => $roles,
          'groups' => $groups,
        ));
    }
} 
```

### 2.5 自定义仓库

没有必要发布这个，因为它们工作得很好 - 它们返回所有角色/组的子集（那些未分配给用户的）。

### 2.6 用户类型

用户类型：

```
namespace Avocode\UserBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class UserType extends AbstractType
{    
    private $options; 

    public function __construct(array $options = null) 
    { 
        $this->options = $options; 
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder->add('username', 'text');

        // password field should be rendered only for CREATE action
        // the same form type will be used for EDIT action
        // thats why its optional

        if($this->options['password'])
        {
          $builder->add('plainpassword', 'repeated', array(
                        'type' => 'text',
                        'options' => array(
                          'attr' => array(
                            'autocomplete' => 'off'
                          ),
                        ),
                        'first_name' => 'input',
                        'second_name' => 'confirm', 
                        'invalid_message' => 'repeated.invalid.password',
                     ));
        }

        $builder->add('email', 'email', array(
                        'trim' => true,
                     ))

        // collection_list is a custom field type
        // extending collection field type
        //
        // the only change is diffrent form name
        // (and a custom collection_list_widget)
        // 
        // in short: it's a collection field with custom form_theme
        // 
                ->add('groups', 'collection_list', array(
                        'type' => new GroupNameType(),
                        'allow_add' => true,
                        'allow_delete' => true,
                        'by_reference' => true,
                        'error_bubbling' => false,
                        'prototype' => true,
                     ))
                ->add('avoRoles', 'collection_list', array(
                        'type' => new RoleNameType(),
                        'allow_add' => true,
                        'allow_delete' => true,
                        'by_reference' => true,
                        'error_bubbling' => false,
                        'prototype' => true,
                     ));
    }

    public function getName()
    {
        return 'avo_user';
    }

    public function getDefaultOptions(array $options){

        $options = array(
          'data_class' => 'Avocode\UserBundle\Entity\User',
        );

        // adding password validation if password field was rendered

        if($this->options['password'])
          $options['validation_groups'][] = 'password';

        return $options;
    }
} 
```

### 2.7 角色名称类型

这种形式应该呈现：

*   隐藏角色 ID
*   角色名称（只读）
*   隐藏模块（只读）
*   隐藏的描述（只读）
*   删除 (x) 按钮

*模块和描述被呈现为隐藏字段，因为当管理员从用户中删除一个角色时，该角色应该由 jQuery 添加到角色表 - 并且该表具有模块和描述列。*

```
namespace Avocode\UserBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class RoleNameType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder            
            ->add('', 'button', array(
              'required' => false,
            ))  // custom field type rendering the "x" button

            ->add('id', 'hidden')

            ->add('name', 'label', array(
              'required' => false,
            )) // custom field type rendering &lt;span&gt; item instead of &lt;input&gt; item

            ->add('module', 'hidden', array('read_only' => true))
            ->add('description', 'hidden', array('read_only' => true))
        ;        
    }

    public function getName()
    {
        // no_label is a custom widget that renders field_row without the label

        return 'no_label';
    }

    public function getDefaultOptions(array $options){
        return array('data_class' => 'Avocode\UserBundle\Entity\Role');
    }
} 
```

* * *

# 3\. 当前/已知问题

### 3.1 案例一：配置如上

上述配置返回错误：

```
Property "id" is not public in class "Avocode\UserBundle\Entity\Role". Maybe you should create the method "setId()"? 
```

但不应该要求设置 ID。

1.  首先是因为我不想创建一个新角色。我只想在现有角色和用户实体之间创建关系。
2.  即使我确实想创建一个新角色，它的 ID 也应该是自动生成的：

    /**

    *   @ORM\Id
    *   @ORM\Column(type="整数")
    *   @ORM\generatedValue(strategy="AUTO") */ protected $id;

### 3.2 案例2：在Role实体中为ID属性添加setter

我认为这是错误的，但我这样做只是为了确定。将此代码添加到角色实体后：

```
public function setId($id)
{
    $this->id = $id;
    return $this;
} 
```

如果我创建新用户并添加角色，然后保存...会发生什么：

1.  新用户已创建
2.  新用户具有分配了所需 ID 的角色（耶！）
3.  **但是该角色的名称被空字符串覆盖**（真糟糕！）

显然，这不是我想要的。我不想编辑/覆盖角色。我只想在他们和用户之间添加一个关系。

### 3.3 案例 3：Jeppe 建议的解决方法

当我第一次遇到这个问题时，我最终找到了一个解决方法，这与 Jeppe 建议的相同。今天（由于其他原因）我不得不重新制作我的表单/视图并且解决方法停止工作。

Case3 UserManagementController -> createAction 的变化：

```
 // in createAction
  // instead of $user = new User
  $user = $this->updateUser($request, new User());

  //and below updateUser function

    /**
     * Creates mew iser and sets its properties
     * based on request
     * 
     * @return User Returns configured user
     */
    protected function updateUser($request, $user)
    {
        if($request->getMethod() == 'POST')
        {
          $avo_user = $request->request->get('avo_user');

          /**
           * Setting and adding/removeing groups for user
           */
          $owned_groups = (array_key_exists('groups', $avo_user)) ? $avo_user['groups'] : array();
          foreach($owned_groups as $key => $group) {
            $owned_groups[$key] = $group['id'];
          }

          if(count($owned_groups) > 0)
          {
            $em = $this->getDoctrine()->getEntityManager();
            $groups = $em->getRepository('AvocodeUserBundle:Group')->findById($owned_groups);
            $user->setGroups($groups);
          }

          /**
           * Setting and adding/removeing roles for user
           */
          $owned_roles = (array_key_exists('avoRoles', $avo_user)) ? $avo_user['avoRoles'] : array();
          foreach($owned_roles as $key => $role) {
            $owned_roles[$key] = $role['id'];
          }

          if(count($owned_roles) > 0)
          {
            $em = $this->getDoctrine()->getEntityManager();
            $roles = $em->getRepository('AvocodeUserBundle:Role')->findById($owned_roles);
            $user->setAvoRoles($roles);
          }

          /**
           * Setting other properties
           */
          $user->setUsername($avo_user['username']);
          $user->setEmail($avo_user['email']);

          if($request->request->has('generate_password'))
            $user->setPlainPassword($user->generateRandomPassword());  
        }

        return $user;
    } 
```

不幸的是，这并没有改变任何东西。结果是 CASE1（没有 ID 设置器）或 CASE2（有 ID 设置器）。

### 3.4 案例4：用户友好的建议

添加 cascade={"persist", "remove"} 到映射。

```
/**
 * @ORM\ManyToMany(targetEntity="Group", cascade={"persist", "remove"})
 * @ORM\JoinTable(name="avo_user_avo_group",
 *      joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id")},
 *      inverseJoinColumns={@ORM\JoinColumn(name="group_id", referencedColumnName="id")}
 * )
 */
protected $groups;

/**
 * @ORM\ManyToMany(targetEntity="Role", cascade={"persist", "remove"})
 * @ORM\JoinTable(name="avo_user_avo_role",
 *      joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id")},
 *      inverseJoinColumns={@ORM\JoinColumn(name="role_id", referencedColumnName="id")}
 * )
 */
protected $avoRoles; 
```

并在 FormType**中将 by_reference 更改**为**false ：**

```
// ...

                ->add('avoRoles', 'collection_list', array(
                        'type' => new RoleNameType(),
                        'allow_add' => true,
                        'allow_delete' => true,
                        'by_reference' => false,
                        'error_bubbling' => false,
                        'prototype' => true,
                     ));

// ... 
```

并且保留 3.3 中建议的解决方法代码确实改变了一些东西：

1.  **未创建**用户和角色之间的关联
***   .. 但是角色实体的名称被空字符串覆盖（如 3.2 中）**

 **所以..它确实改变了一些东西，但方向错误。

# 4\. 版本

### 4.1 Symfony2 v2.0.15

### 4.2 教义2 v2.1.7

### 4.3 FOSUserBundle 版本：[6fb81861d84d460f1d070ceb8ec180aac841f7fa](https://github.com/FriendsOfSymfony/FOSUserBundle/commit/6fb81861d84d460f1d070ceb8ec180aac841f7fa)

# 五、总结

我尝试了许多不同的方法（以上只是最新的方法），经过数小时研究代码、谷歌搜索和寻找答案后，我无法得到这个工作。

任何帮助将不胜感激。如果您需要了解任何内容，我会发布您需要的任何代码部分。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-10T14:48:03.747

我得出了相同的结论，即 Form 组件有问题，并且看不到修复它的简单方法。但是，我提出了一个完全通用的稍微不那么繁琐的解决方案。它没有任何实体/属性的硬编码知识，因此将修复它遇到的任何集合：

## 更简单、通用的解决方法

这不需要您对实体进行任何更改。

```
use Doctrine\Common\Collections\Collection;
use Symfony\Component\Form\Form;

# In your controller. Or possibly defined within a service if used in many controllers

/**
 * Ensure that any removed items collections actually get removed
 *
 * @param \Symfony\Component\Form\Form $form
 */
protected function cleanupCollections(Form $form)
{
    $children = $form->getChildren();

    foreach ($children as $childForm) {
        $data = $childForm->getData();
        if ($data instanceof Collection) {

            // Get the child form objects and compare the data of each child against the object's current collection
            $proxies = $childForm->getChildren();
            foreach ($proxies as $proxy) {
                $entity = $proxy->getData();
                if (!$data->contains($entity)) {

                    // Entity has been removed from the collection
                    // DELETE THE ENTITY HERE

                    // e.g. doctrine:
                    // $em = $this->getDoctrine()->getEntityManager();
                    // $em->remove($entity);

                }
            }
        }
    }
} 
```

## **`cleanupCollections()`**在持久化之前调用新方法

```
# in your controller action...

if($request->getMethod() == 'POST') {
    $form->bindRequest($request);
    if($form->isValid()) {

        // 'Clean' all collections within the form before persisting
        $this->cleanupCollections($form);

        $em->persist($user);
        $em->flush();

        // further actions. return response...
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-06-13T10:17:21.410

一年过去了，这个问题变得相当流行。Symfony 从那以后发生了变化，我的技能和知识也有所提高，我目前解决这个问题的方法也有所提高。

我为 symfony2 创建了一组表单扩展（参见github 上的[FormExtensionsBundle](https://github.com/symfony2admingenerator/FormExtensionsBundle)项目），它们包括一个用于处理 One/Many **ToMany**关系的表单类型。

在编写这些代码时，向控制器添加自定义代码来处理集合是不可接受的 - 表单扩展应该易于使用、开箱即用，并使我们开发人员的生活更轻松，而不是更难。另外..记住..干！

所以我不得不将添加/删除关联代码移到其他地方 - 正确的地方自然是 EventListener :)

查看[EventListener/CollectionUploadListener.php](https://github.com/loostro/FormExtensions/blob/master/EventListener/CollectionUploadListener.php)文件，了解我们现在如何处理这个问题。

PS。在这里复制代码是不必要的，最重要的是这样的东西实际上应该在 EventListener 中处理。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-19T09:03:47.597

# 1.变通解决方案

Jeppe Marianger-Lam 建议的解决方案是目前我所知道的唯一可行的解​​决方案。

### 1.1 为什么它在我的案例中停止工作？

我将我的 RoleNameType（出于其他原因）更改为：

*   身份证（隐藏）
*   名称（自定义类型 - 标签）
*   模块和描述（隐藏，只读）

问题是我的自定义类型标签将 NAME 属性呈现为

```
    <span> 角色名称 </span>

```

而且由于它不是“只读”的，因此 FORM 组件有望在 POST 中获取 NAME。

相反，仅发布了 ID，因此 FORM 组件假定 NAME 为 NULL。

这导致 CASE 2 (3.2) -> 创建关联，但用空字符串覆盖 ROLE NAME。

# 2\. 那么，这个解决方法到底是什么？

### 2.1 控制器

这种解决方法非常简单。

在您的控制器中，在验证表单之前，您必须获取已发布的实体标识符并获取匹配的实体，然后将它们设置为您的对象。

```
// example action
public function createAction(Request $request)
{      
    $em = $this->getDoctrine()->getEntityManager();

    // the workaround code is in updateUser function
    $user = $this->updateUser($request, new User());

    $form = $this->createForm(new UserType(), $user);

    if($request->getMethod() == 'POST') {
        $form->bindRequest($request);

        if($form->isValid()) {
            /* Persist, flush and redirect */
            $em->persist($user);
            $em->flush();
            $this->setFlash('avocode_user_success', 'user.flash.user_created');
            $url = $this->container->get('router')->generate('avocode_user_show', array('id' => $user->getId()));

            return new RedirectResponse($url);
        }
    }

    return $this->render('AvocodeUserBundle:UserManagement:create.html.twig', array(
      'form' => $form->createView(),
      'user' => $user,
    ));
} 
```

在 updateUser 函数中的解决方法代码下方：

```
protected function updateUser($request, $user)
{
    if($request->getMethod() == 'POST')
    {
      // getting POSTed values
      $avo_user = $request->request->get('avo_user');

      // if no roles are posted, then $owned_roles should be an empty array (to avoid errors)
      $owned_roles = (array_key_exists('avoRoles', $avo_user)) ? $avo_user['avoRoles'] : array();

      // foreach posted ROLE, get it's ID
      foreach($owned_roles as $key => $role) {
        $owned_roles[$key] = $role['id'];
      }

      // FIND all roles with matching ID's
      if(count($owned_roles) > 0)
      {
        $em = $this->getDoctrine()->getEntityManager();
        $roles = $em->getRepository('AvocodeUserBundle:Role')->findById($owned_roles);

        // and create association
        $user->setAvoRoles($roles);
      }

    return $user;
} 
```

为此，您的 SETTER（在本例中为 User.php 实体）必须是：

```
public function setAvoRoles($avoRoles)
{
    // first - clearing all associations
    // this way if entity was not found in POST
    // then association will be removed

    $this->getAvoRoles()->clear();

    // adding association only for POSTed entities
    foreach($avoRoles as $role) {
        $this->addAvoRole($role);
    }

    return $this;
} 
```

# 3\. 最后的想法

不过，我认为这种解决方法正在做的工作

```
$form->bindRequest($request); 
```

应该做！要么是我做错了，要么是 symfony 的 Collection 表单类型不完整。

symfony 2.1[中的表单组件有一些重大变化，希望这将得到修复。](http://symfony.com/blog/towards-symfony-2-1 "Towards Symfony 2.1 by Fabien Potencier – May 29, 2012")

### PS。如果是我做错了什么...

...请张贴它应该做的方式！我很高兴看到一个快速、简单且“干净”的解决方案。

### PS2。特别感谢：

Jeppe Marianger-Lam 和用户友好（来自 IRC 上的#symfony2）。你一直很有帮助。干杯!

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-18T20:04:09.177

这是我以前做过的——我不知道这是否是“正确”的做法，但它确实有效。

当您从提交的表单中获得结果时（即，就在 之前或之后`if($form->isValid())`），只需询问角色列表，然后将它们全部从实体中删除（将列表保存为变量）。使用此列表，只需遍历它们，向存储库询问与 ID 匹配的角色实体，然后将这些添加到您的用户实体中，`persist`然后`flush`.

我刚刚搜索了 Symfony2 文档，因为我记得有关`prototype`表单集合的一些内容，结果出现了：[http](http://symfony.com/doc/current/cookbook/form/form_collections.html) ://symfony.com/doc/current/cookbook/form/form_collections.html - 它有如何正确处理的示例javascript 在表单中添加和删除集合类型。也许先尝试这种方法，然后如果你不能让它工作，然后再尝试我上面提到的方法:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-21T13:26:12.570

您需要更多实体：
***USER***
id_user (type: integer)
username (type: text)
plainPassword (type: password)
email (type: email)

* * *

***GROUPS***
id_group（类型：整数）
描述（类型：文本）

* * *

***AVOROLES***
id_avorole（类型：整数）
描述（类型：文本）

* * *

* **USER_GROUP***
id_user_group (type:integer)
id_user (type:integer) (这是用户实体上的 id)
id_group (type:integer) (这是组实体上的 id)

* * *

* **USER_AVOROLES***
id_user_avorole (type:integer)
id_user (type:integer) (这是用户实体上的 id)
id_avorole (type:integer) (这是 avorole 实体上的 id)

* * *

例如，您可以使用以下内容：
用户：
id：3
用户名：john
plainPassword：johnpw
电子邮件：john@email.com

组：
id_group：5
描述：组 5

user_group:
id_user_group: 1
id_user: 3
id_group: 5
*这个用户可以有很多组所以在另一行*****

# php - 当 mysqli 和 PDO 不可用时，可以使用准备好的语句吗？

> ID：11089862
> 
> 赞同：0
> 
> 时间：2012-06-18T19:40:32.157
> 
> 标签：php, mysql, prepared-statement

当 mysqli 和 PDO 不可用时，是否可以使用 PHP/mysql 准备语句？是否有针对此问题的有效 Pear 解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:44:34.997

[http://pear.php.net/manual/en/package.database.mdb2.intro-execute.php](http://pear.php.net/manual/en/package.database.mdb2.intro-execute.php)

这应该包含您需要的所有信息。

否则，标准 mysql_* 函数不为准备好的语句提供功能。

# javascript - 标题文本框字段的 JavaScript 正则表达式

> ID：11089867
> 
> 赞同：1
> 
> 时间：2012-06-18T19:40:51.377
> 
> 标签：javascript, regex

我的正则表达式知识很薄弱。如果用户将标题文本框字段留空，我需要帮助构建正则表达式并尝试显示两个通知。在我的原始项目中，货币、描述文本区域、检查框等的文本框不止一个。但我不想让这个示例变得广泛，所以我只使用一个文本框。

如果文本框字段为空，则会出现两个通知，但问题是一旦放置了正确的输入，它仍会显示第二个通知：“*您的帖子的描述性标题”。这是为什么？

**JS 表达式**

```
"required": { // Add your regex rules here, you can take telephone as an example
                    "regex": "none",
                    "alertText": "* This is required",
                    "alertTextCheckboxMultiple": "* Please select an option",
                    "alertTextCheckboxe": "* This checkbox is required",
                    "alertTextDateRange": "* Both date range fields are required"
                },

"title": {
                    "regex": "none",
                    "alertText": "* Descriptive title for your post"
                }, 
```

**HTML**

```
input type="text"  id="ValidField" class="validate[required,custom[title]] text-input" size="60" autocomplete="off" value=""/> 
```

**输入正确后的结果：** ![在此处输入图像描述](../Images/0914d486bfb8a7c0d68669311a756078.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:13:07.957

查看您的标记，当它验证标题时，似乎`regex`当前设置为匹配单词。`none`

验证插件网页上的[**自定义**](https://github.com/posabsolute/jQuery-Validation-Engine#customizations)部分解释说，此值是`regex`根据您的表单标题要求的模式。

尽管该`regex`示例仅允许使用字母，但`regex`可以根据您的表单要求使用不同的模式来包含数字、符号等。

这个[**在线工具**](http://www.ninjavspenguin.com/regexp.html)可能有助于测试创建正确的正则表达式。

例如，`regex`要确保标题具有某些内容的 a 将是： `/^(\S+)/`
这`regex`将允许标题具有字母、空格和数字：`/^[a-zA-Z0-9\ \']+$/`

# ios - 获取 iPhone 上音频输入的频率

> ID：11089870
> 
> 赞同：0
> 
> 时间：2012-06-18T19:41:08.427
> 
> 标签：ios, signal-processing, fft

如何获取 iPhone 上音频输入的频率？如果我只对查找特定频率感兴趣（即在 x 毫秒的时间范围内，检查 y Hz 处是否有峰值），是否有必要使用 FFT？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T20:16:16.533

如果您只对特定的固定频率（即纯音）感兴趣，那么您可以使用[Goertzel 算法](https://en.wikipedia.org/wiki/Goertzel_algorithm)，该算法与 FFT 相比实现起来非常简单且相对轻量级（计算上）。

# windows - 成功运行signTool后发布者未知

> ID：11089873
> 
> 赞同：10
> 
> 时间：2012-06-18T19:41:21.220
> 
> 标签：windows, installation, windows-installer, signtool

我正在尝试创建一个测试证书并签署一个我创建的 .MSI 文件。在我们购买真正的安全证书之前，我需要让测试版本与签名的 .MSI 一起使用。

我已执行以下步骤来签署我的 .MSI 文件。一切都成功完成，并显示一条消息，表明在最后一步之后成功签署了 1 个文件。

```
makecert.exe -sv c:\Test\mykey.pvk -n "CN=WTS" c:\Test\myCert.cer

cert2spc.exe c:\Test\mycert.cer c:\Test\mycert.spc

pvk2pfx -pvk c:\Test\mykey.pvk -pi password -spc c:\Test\mycert.spc -pfx c:\Test\mycert.pfx -po password

signTool sign /f c:\Test\mycert.pfx /p password /v c:\Test\test.msi 
```

执行这些步骤后，我运行 .MSI 文件（为 .MSI 修改的日期确实会更改以匹配运行 signTool 步骤的时间）。表示此 .MSI 来自未知发布者的警告消息仍显示为“发布者：未知”。

我错过了一步吗？一切似乎都正常工作，我从来没有看到任何错误，但我的文件似乎没有签名。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-18T20:06:53.997

您的文件已签名。Windows 将发布者声明为未知，因为它不信任签名中的发布者标识。

请记住，在数字签名的世界中，您总是需要同时验证至少两件事，否则整个练习毫无意义。您必须检查签名上的名称，并且您还需要从您已经信任的东西（例如，证书颁发机构或手动添加为受信任的证书）中找到一个信任链接，直到您正在检查的签名。只有这样才有意义信任签名上的名称，并可能将其显示给操作系统用户。

在您的网络浏览器中，转到工具/Internet 选项/内容/发布者/证书并将您的测试证书添加到受信任的发布者。

（其他浏览器在设置/显示高级设置/HTTPS/SSL/管理证书下可能具有相同的功能。）

并重试。它不起作用，但我真的不知道为什么，这是一个有启发性的游戏。

如果您的证书是自制的并且没有证书颁发机构支持，则尚不清楚 Windows 是否有办法建立信任链。 [这个消息来源](http://msdn.microsoft.com/en-us/library/ff699202.aspx)说：

> 如果您使用测试（自行创建）证书，安装对话框将显示“未知发布者”消息。对于组织内部部署的应用程序，这是一种可接受的做法。”

[但是，您可以按照此处](http://www.codeproject.com/Articles/28248/Securing-WCF-Services-with-Certificates)所述创建自己的证书颁发机构，并在受信任的根证书颁发机构下添加 CA 证书。通过这样做，您基本上可以让该 CA 颁发的任何证书签署任何内容并被 Windows 信任。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-30T09:40:46.823

我遇到了同样的问题，发现微软不再信任具有“sha 1”算法的证书。

我通过要求我的 CA 更换证书解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T13:13:28.497

如果您在签署包时没有使用开关“/d”来指定描述，也会发生这种情况。在此页面上的“签名命令选项”下查看更多详细信息：http: [//msdn.microsoft.com/en-us/library/8s9b9yaz.aspx](http://msdn.microsoft.com/en-us/library/8s9b9yaz.aspx)

# windows - windows 7下安装yuidoc

> ID：11089881
> 
> 赞同：1
> 
> 时间：2012-06-18T19:41:41.797
> 
> 标签：windows, node.js, npm

我试图让 yuidoc 在 Windows 7 下运行......但失败了。
现在我是一个 nodejs 菜鸟，所以也许我做错了什么。

我已经从 nodejs.org 安装了 node-v0.6.19.msi（运行了“hello world”，这很好）
然后我尝试通过 npm 安装 yuidoc（如此处所述[http://yui.github.com/yuidoc/](http://yui.github.com/yuidoc/) )

npm install 似乎工作（很多http GET，没有大红色ERR！s）。
接下来我尝试了“node yuidoc”。但这会引发“找不到模块”。

节点 msi 默认安装文件夹是 C:\Program Files\nodejs\ 而 npm 将 yuidoc 安装到 C:\Users[username]\AppData\Roaming\npm\node_modules\yuidocjs

~~奇怪的是， npm install 只创建了一些空文件夹。我究竟做错了什么？~~
抱歉，尝试使用 npm 重新安装 yuidoc 是我的错误（它出错并清除了文件夹）。

我现在似乎正确安装了 yuidoc（..node_modules\yuidocjs 中有很多文件）。但是尝试从 node.js 运行它仍然不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T13:16:44.060

啊，只是我是一个 nodejs 菜鸟。我认为我需要从节点内运行所有内容（最初也尝试过以这种方式运行 npm）。

只需直接从命令提示符运行 yuidoc 就可以了。

# visual-studio-2010 - 标记为 [TestMethod] 的方法如何在 [AssemblyInitializeAttribute] 之前运行？

> ID：11089882
> 
> 赞同：0
> 
> 时间：2012-06-18T19:41:47.547
> 
> 标签：visual-studio-2010, unit-testing

在我们的单元测试中，我们必须在每次测试运行之前设置一些配置。但是，由于某种原因，在我们标记为 [AssemblyInitializeAttribute] 的方法之前运行了两个单元测试。

我所指的两种测试方法都用 [TestMethod] 属性和 MSDN 适当标记（http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assemblyinitializeattribute(v=vs .80).aspx) 应该还没有运行。

有任何想法吗？在网上找不到有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T21:29:50.537

看起来问题是这两个测试实际上是在另一个程序集中我一定忽略了这个事实，我运行了测试->当前解决方案中的所有测试

# api - myspace 流媒体订阅 API 是否仍然有效，如果可以，我怎么知道？

> ID：11089885
> 
> 赞同：2
> 
> 时间：2012-06-18T19:41:54.777
> 
> 标签：api, streaming, subscription, myspace

为了为我们正在构建的应用程序获取与音乐相关的事件，我们仔细研究了 Myspace 明显笨拙的身份验证过程，并设法设置了订阅和端点。

使用所有这些有趣的东西：

[http://wiki.developer.myspace.com/index.php?title=Category:Real_Time_Stream](http://wiki.developer.myspace.com/index.php?title=Category:Real_Time_Stream) http://wiki.developer.myspace.com/index.php?title=Stream_Subscription_API [http://wiki.developer.myspace。 com/index.php?title=Stream_Subscription_Example_Walkthrough](http://wiki.developer.myspace.com/index.php?title=Stream_Subscription_Example_Walkthrough)

Myspace GET 请求验证我们的订阅是否存在。所以我们希望做的就是坐下来等待......

...但即使没有任何查询过滤设置（即我们应该得到所有发生的事情！），我们似乎没有得到任何数据推送。

最令人担忧的是，我最近没有看到任何人在网络上谈论这个。它还存在吗？它仍然在 Myspace 的开发者主页上。他们忘了把它拿下来吗？在这一点上，他们的自尊心是否如此低（出于显而易见的原因）以至于他们不再关心他们的服务是否有效？

带有确凿支持证据的布尔答案将不胜感激。

不到一年的资源和讨论的链接将是一个很棒的奖励。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:15:32.620

Myspace 有一个非常不活跃的[**MySpace Developer Team News and Announcements**](http://developer.myspace.com/community/blogs/devteam/default.aspx) ，其中列出了设计用于该标准的各种**API 模块**`ActivityStrea.ms`，并有一个带有示例的专用[**活动 API**](http://wiki.developer.myspace.com/index.php?title=OpenSocial_v0.9_Activities)网页。

查看该页面后，您会发现它们在已弃用的[**OpenSocial API**](http://opensocial-resources.googlecode.com/svn/spec/1.0/OpenSocial-Specification.xml) v1 平台中工作。

参考您使用的**Stream Subscription**方法，History Log 的最后一个条目是**January 2010**。可以肯定地说，该方法已被放弃。参考截图：

![在此处输入图像描述](../Images/dd2f3e836bd6a13926a353cd11978178.png)

我访问了[**Wikipedia Myspace 页面**](http://en.wikipedia.org/wiki/Myspace#MySpace_Developer_Platform_.28MDP.29)以了解当前使用的开发人员 API，并收到了与您已经拥有的相同的过时信息。最后一次使用的 API 是在 2010 年。

您仍然有希望通过当前 API 方法获取音乐相关事件的目标：上面的 Wikipedia 页面有一个标题为[**Decline: 2008–present**](http://en.wikipedia.org/wiki/Myspace#Decline:_2008.E2.80.93present)**的部分，该部分链接到2012 年 1 月**文章的脚注 71 ： [**MySpace 在 Panasonic 新闻发布会上重生，释放贾斯汀汀布莱克**](http://www.pcmag.com/article2/0,2817,2398677,00.asp)

维基百科的公告内容如下：

```
In January 2012, the company announced at CES that it would introduce MySpace TV with Panasonic. 
```

虽然 Myspace 目前还处于开发人员的雷达之下，而您的目标是通过 API 获取**音乐相关事件**（来自音乐艺术家？），但请考虑使用具有强大搜索功能的 YouTube API 从具有合法 YouTube ID 的艺术家那里查找此类事件。

如果这不是一个选项，也许**Myspace TV / Panasonic**的合资企业将很快实现。

由于这不是一个令人愉快的答案，因此它只适合[**Cry Me A River**](http://www.youtube.com/watch?v=DksSPZTZES0)，直到实现新的[**API**](http://www.youtube.com/watch?v=Fz1BXF7bVpM)。

* * *

**编辑：**当您寻找布尔答案时，MySpace API 是`false`. 为了补充该布尔状态，这些其他 JavaScript 值也被认为是错误的：`0` `-0` `null` `""` `undefined` `NaN`.

[**MySpace API 的 WordPress 在**](http://developer.myspace.com/wordpress/)**2010 年 4 月**的最后一篇博客文章中被放弃。

[**MySpace Stream Subscription API**](http://wiki.developer.myspace.com/index.php?title=Stream_Subscription_API)是[**MySpace RESTful API**](http://wiki.developer.myspace.com/index.php?title=Category:RESTful_API)的一个组件，已被废弃。

最后，[**MySpace 开发者主页**](http://wiki.developer.myspace.com/index.php?title=Main_Page)最后一次更新是在 2010 年[**12 月**](http://wiki.developer.myspace.com/index.php?title=Main_Page&action=history)。

即使到今天，[**Google Groups for MySpace API**](https://groups.google.com/forum/?fromgroups#!forum/myspace-apis)**自 2010 年7 月**以来也没有任何活动。

以上链接是MySpace API 已死的**进一步证据。**

# sencha-touch - 在 Sencha Touch 中使用外部插件

> ID：11089888
> 
> 赞同：1
> 
> 时间：2012-06-18T19:42:06.540
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我想使用一个简单的 Sencha Touch 键盘插件。插件代码可以在[这里](https://github.com/msmeeks/sencha-keypad)找到。可以在标签下的 html 文件中创建键盘，如下所示：

```
<script>
    Ext.setup({
        onReady: function () {
            var basic = new Ext.ux.Keypad();
            basic.render('keypad');
        }
     });
</script>

<div id="keypad"/> 
```

或者，它也可以在 Sencha 容器中使用，如下所示：

```
...
items:[
    {
        xtype: 'keypad'
    }
] 
```

但是，我无法让它以后一种方式工作。我是 Sencha 的新手，我认为我没有将文件放在正确的位置或没有正确包含它们。我的 index.html 中已经包含以下内容：

```
<script type="text/javascript" charset="utf-8" src="js/sencha-touch-1.1.1/sencha-touch.js"></script>
<link rel="stylesheet" type="text/css" href="js/sencha-touch-1.1.1/resources/css/sencha-touch.css">
<script src="js/Keypad.js" type="text/javascript" charset="utf-8"></script> 
```

有人可以让我知道哪些文件需要进行哪些修改，以便我可以直接在容器中使用键盘插件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T10:26:31.017

在您的 app.js 文件中，您需要在加载程序中设置插件文件夹的路径...将 ux（插件）文件夹放在您的 app.js 所在的位置...在 app.js 中设置以下内容

```
Ext.Loader.setPath('Ext.ux', 'ux'); 
```

在您使用小键盘的视图上，您​​需要指定一个

```
requires: ['Ext.ux.NumPad' ...] //All plugin related files 
```

还要确保 CSS 文件位于正确的位置......希望它有帮助......

# memcached - 缓存 40% 满时 Memcached 驱逐

> ID：11089889
> 
> 赞同：7
> 
> 时间：2012-06-18T19:42:11.980
> 
> 标签：memcached

当 memcached 只有 40% 满时，我看到了驱逐。这怎么可能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-26T18:58:33.573

通过运行 memcached stats 检查slab 大小。看起来您的平板没有均匀填充，即使缓存未满，也会导致驱逐。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T21:45:26.830

我对这个问题写了一个很长的解释，这同样适用于[这个问题。](https://stackoverflow.com/questions/6868256/memcached-eviction-prior-to-key-expiry/10456364#10456364)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T11:49:35.027

Memcached根据不同内存块的slab存储数据。如果已经分配了不同的内存块，那么最近最少使用的算法在slab上运行并将数据逐出，即使其他内存slab中没有数据。

因此，数据大小的大分布可能是造成此问题的原因。通过运行多个 memcached 实例并将其用作分布式系统，可以减少问题。

# java - 为什么 ByteBuffers hashCodes 是一样的？

> ID：11089890
> 
> 赞同：6
> 
> 时间：2012-06-18T19:42:13.880
> 
> 标签：java, debugging, buffer, hashcode, bytebuffer

我有一个这样的类构造函数：

```
public JavoImageCorrectedDataHeader()
    {
        ByteBuffer buffer = ByteBuffer.allocate(this.size());
        buffer.order(java.nio.ByteOrder.LITTLE_ENDIAN);
        setByteBuffer(buffer, 0);
        System.out.println("buffer.hasCode=" + buffer.hashCode());
    } 
```

在我的其他课程中，我通过使用在不同的位置和时间创建了上述课程的许多实例

```
new JavoImageCorrectedDataHeader() 
```

然后，我希望它会为它们打印出不同的 hashCode。但我实际上看到打印出相同的**hashCode ：**

```
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241
buffer.hasCode=1742602241 
```

我必须错过一些关于如何使用 ByteBuffer 的内容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-18T19:47:06.987

从javadoc：

> 字节缓冲区的哈希码仅取决于其剩余元素；也就是说，在从 position() 到且包括在 limit() - 1 处的元素上。
> 
> 因为缓冲区哈希码是依赖于内容的，所以不建议使用缓冲区作为哈希映射或类似数据结构中的键，除非知道它们的内容不会改变。

如果您没有填充`ByteBuffers`，或者使用相同的东西填充它们，则哈希码将是相同的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-18T19:49:10.823

从[ByteBuffer.java](http://developer.classpath.org/doc/java/nio/ByteBuffer-source.html)源代码：

```
public int hashCode () {
    int hashCode = get(position()) + 31;
    int multiplier = 1;
    for (int i = position() + 1; i < limit(); ++i) {
        multiplier *= 31;
        hashCode += (get(i) + 30)*multiplier;
    }
    return hashCode;
} 
```

在您当前的实现下，`position()` 总是返回`0`，因此哈希码总是相同的。哈希码取决于缓冲区的内容，而不是用于表示它的物理对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-18T19:50:28.320

这是正确的行为。根据 ByteBuffer 文档：

> 当且仅当，两个字节缓冲区相等
> 
> 它们具有相同的元素类型，
> 
> 它们具有相同数量的剩余元素，并且
> 
> 剩余元素的两个序列，独立于它们的起始位置考虑，是逐点相等的。
> 
> 字节缓冲区不等于任何其他类型的对象。

所以，假设 this.size() 总是返回相同的东西，你的缓冲区总是相等的。根据 hashCode 的一般合同，因此它们都必须具有相同的哈希码。

您似乎正在尝试使用 hashCode 来确定对象身份 - 这不是一个好主意（因为 hashCode 和 == 如何交互）。如果您需要将类的实例彼此区分开来，并且需要比 == 运算符提供的更多内容，则必须找到其他方法来做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-18T19:48:41.743

`ByteBuffer.hashcode`让您计算包装字节 [] 的哈希值。在这种情况下，新初始化的 byte[] 的内容对于每个字节都是 0。假设 ByteBuffer 内容相同，则哈希码相同。

# database - 创建这些表的最佳方法

> ID：11089894
> 
> 赞同：0
> 
> 时间：2012-06-18T19:42:27.820
> 
> 标签：database, normalization, database-normalization

我有以下情况。

我们需要一个信誉表来评估用户和公司。

该信誉表将存储公司给予用户的信誉，反之亦然。

有人建议我们应该创建两个信誉表，一个用于用户，另一个用于公司，两者具有相同的列。

我不认为那是最好的方法，但我找不到另一种解决方案。

我们有没有其他方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:47:01.300

我不认为你的方法不好。另一种解决方案是有一个抽象`Entity`表，每个表都有自己的记录（`User`以及实体 ID）；那么您只能在单个表中跟踪两个实体之间的声誉。`Company``Entity``Reputation`

另一种方法是创建一个`Reputation`表，其中包含用户 ID、公司 ID 和`type`（或`direction`，或在您的模型中看起来合乎逻辑的任何内容）字段，该字段指示它是用户给出的公司声誉，还是相反。不过似乎不太规范化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:51:54.467

您将有一个公司表，其中包含该公司的唯一键。用户也一样。

我假设 Co 和 User 之间的关系是多对多的。

您还需要一张表，其中包含 Co 和 User 的两个键，以及两个字段，一个用于 Co-rep，一个用于 User-rep。Co-key 和 User-key 组合将是该表的唯一条目。

# wpf - 关于 WPF MVVM 和用户控件的菜鸟问题

> ID：11089895
> 
> 赞同：2
> 
> 时间：2012-06-18T19:42:36.000
> 
> 标签：wpf

我正在开始使用 WPF，并且在实现数据绑定时遇到了一些困难。

具体来说，我创建了一个简单的用户控件，其中包含一个标签和一个按钮。对于这个用户控件，我创建了一个 ViewModel，它只包含两个属性，`string`“Text”和`SimpleEnum`“Status”。

控件的重点是显示某物的状态，例如“已连接”是/否等。按钮的背景颜色表示状态。

我的 XAML 看起来像这样

```
<Control.DataContext>
    <vm:OnOffStatusViewModel />
</Control.DataContext>

<Label x:Name="label1" Height="Auto" HorizontalAlignment="Left" Content="{Binding Text}" Width="280" />
<Button Style="{StaticResource GlassButton}" Height="14" Width="14" Background="{Binding Status}" Grid.Column="1" /> 
```

和`xmlns:vm="clr-namespace:Controls"`

代码隐藏具有`ViewModel`公开视图模型的属性，实现 INotifyPropertyChanged，并初始化为`_viewModel = (OnOffStatusViewModel) DataContext;`

现在，在我使用这个控件的视图中，我已经设法将 Text 设置为某些东西，就像我在我的实现视图代码隐藏中一样`onOffStatus1.ViewModel.Text = ...`，但是，状态是由枚举设置的，因此不能真正绑定到按钮的背景属性。

我与此相关的问题：

1.  我进行控制的方式是否正确？如果不是，在用户控件中实现数据绑定的正确方法是什么？

2.  如何让我的枚举状态使用绑定更新按钮的背景属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:59:22.950

> 如何让我的枚举状态使用绑定更新按钮的背景属性？

建议为此任务使用[值转换器](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)，为枚举的每个可能值返回一个画笔。这样，您的视图模型不需要知道任何关于颜色或画笔的信息，并且您可以在任何您想可视化状态的地方使用转换器。

**XAML**

```
<UserControl x:Class="WpfApplication1.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:WpfApplication1">

    <UserControl.Resources>
        <local:StatusColorConverter x:Key="StatusColorConverter" />
    </UserControl.Resources>

    <Button Background="{Binding Status, Converter={StaticResource StatusColorConverter}" />

</UserControl> 
```

**转换器**

```
public enum Status
{
  Connected
}

public class StatusColorConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    switch ((Status)value)
    {
      case Status.Connected: return new SolidColorBrush(Colors.Green);
    }

    return new SolidColorBrush(Colors.Black);
  }

  public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    throw new NotImplementedException();
  }
} 
```

> 我进行控制的方式是否正确？如果不是，在用户控件中实现数据绑定的正确方法是什么？

你的实现对我来说似乎很好。您可能希望通过依赖注入消除视图模型和视图（当前持有对视图模型的引用）之间的耦合。但这取决于您的用例和您要使用的架构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T20:08:43.153

就个人而言，我无法将自定义 UserControls 与 MVVM 一起使用。要么我的想法还没有考虑如何将它们一起使用，要么它们只是不混合。我将 DataTemplates 用于不是窗口的所有内容。

保持简洁...

```
OnOffStatusVM : INPC
   string Status
   Color Color (or Brush)
   (set Color when enum value updates)

(OnOffStatus DataTemplate)
<DataTemplate DataType="{x:Type ViewModel:OnOffStatusVM}" x:Shared="False" x:Key="rezOnOffStatus">
   <Grid>   
      <Label Height="Auto" HorizontalAlignment="Left" Content="{Binding Status}" Width="280" />
      <Button Style="{StaticResource GlassButton}" Height="14" Width="14" Background="{Binding Color}" Grid.Column="1" />
   </Grid>
</DataTemplate> 
```

DataContext 派生自 OnOffStatusVM 时的用法

`<ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource rezOnOffStatus}" />`

DataContext 有`OnOffStatusVM OnOffStatus`属性时的用法

`<ContentPresenter Content="{Binding OnOffStatus}" ContentTemplate="{StaticResource rezOnOffStatus}" />`

如果需要，提供说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T20:17:12.990

我将采用与此处的其他答案略有不同的方法，我喜欢将代码和逻辑直接放入我的视图模型中，所以我会这样做：

```
<Control.DataContext>
    <vm:OnOffStatusViewModel />
</Control.DataContext>

<Label x:Name="label1" Height="Auto" HorizontalAlignment="Left" Content="{Binding Text}" Width="280" />
<Button Style="{StaticResource GlassButton}" Height="14" Width="14" Background="{Binding ButtonBg}" Grid.Column="1" /> 
```

在虚拟机中：

```
public MyStatus Status
{
   get { return _status; }
   set
   {
      _status = value;
      OnPropertyChanged("Status");

      ButtonBg = Colors.Red;
   }    
}

public Color ButtonBg 
{
   get { ... }
   set { ... }
} 
```

由于您的按钮背景绑定到视图模型上的属性，因此您可以自由更改它以响应视图模型中发生的任何事情，而无需将逻辑或代码移出转换器和模板。

# sas - SAS let 语句：引用单元格值？

> ID：11089896
> 
> 赞同：1
> 
> 时间：2012-06-18T19:42:41.587
> 
> 标签：sas, let

在 SAS 中，是否可以将`%let`语句引用到位于数据库中的值？

例如，my n in 的值`%let n=50`取决于在我的一个数据库中计算的某个值，例如，第一行加第一列。而且由于该值在我的循环中被修改了 100 次，我不想手动输入该值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T20:17:52.933

有几种方法可以做到这一点。这里有两个：

```
proc sql;
 select a+b into :n
 from your_table
 where some_condition;
quit; 
```

这用变量和`&n`的总和填充一个宏变量。您指定的条件应仅适用于表的一行。`a``b`

另一种方法：

```
data tmp;
 set your_table;
 if _n_=1 then do;
  call symputn('n',a+b);
 end;
run; 
```

# javascript - IE 9 中 FileReader() 的 Shim

> ID：11089897
> 
> 赞同：14
> 
> 时间：2012-06-18T19:42:44.170
> 
> 标签：javascript, jquery, internet-explorer

[`FileReader`](https://developer.mozilla.org/en/DOM/FileReader)IE 9 中有 shim吗？

```
var reader = new FileReader(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-18T19:56:12.953

[这个 polyfill](https://github.com/Jahdrien/FileReader)使用 Flash 在不支持文件 API（IE 和 Safari）但不支持拖放的浏览器上提供对文件系统的访问。

[这个](https://github.com/MrSwitch/dropfile)使用 Silverlight 来允许拖放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:58:02.430

看起来有一个[https://github.com/ebidel/idb.filesystem.js](https://github.com/ebidel/idb.filesystem.js)（未经测试）。
[http://html5please.com/](http://html5please.com/)非常适合这类问题。

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2012-06-18T19:45:14.317

IE9[不支持 HTML5 File API](http://caniuse.com/filereader)。当然，可能还有其他方法可以实现您尝试实现的功能（顺便说一下，您还没有解释过）。

# c# - 使用 linq to xml 按属性获取元素的值

> ID：11089900
> 
> 赞同：0
> 
> 时间：2012-06-18T19:43:05.027
> 
> 标签：c#, xml, linq

我有以下 xml，我想获取具有属性的节点的值。

```
<quiz xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="quiz.xsd">
    <mchoice>
        <question>What is the capital city of Australia?</question>
        <answer>Sydney</answer>
        <answer correct="yes">Canberra</answer>
        <answer>Melbourne</answer>
        <answer>Gold Coast</answer>
    </mchoice>
    <mchoice>
        <question>Launceston is the second largest city in which Australian state?</question>
        <answer>Victoria</answer>
        <answer>New South Wales</answer>
        <answer correct="yes">Tasmania</answer>
        <answer>Western Australia</answer>
    </mchoice>
</quiz>

public class Question
{
    public string QuestionText { get; set; }
    public List<string> Answers { get; set; }
    public string CorrectAnswer { get; set; }

} 
```

**我尝试了以下查询，但在CorrectAnswer**归档中我得到了空值

```
var questions = from docs in _doc.Descendants("mchoice")
                        let answers = _doc.Elements("answer")
                        select new Question
                        {
                            QuestionText = docs.Element("question").Value,
                            Answers = docs.Elements("answer").Select(a => a.Value).ToList(),
                            CorrectAnswer=docs.Elements("answer").Where(x=>x.Attribute("correct").Value=="yes").Select(x=>x) 
```

**例外输出**

*   QuestionText-澳大利亚的首都是哪里？
*   答案列表

*   CorrectAnswer-堪培拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:49:45.327

尝试更改此行：

```
CorrectAnswer=docs.Elements("answer").Where(x=>x.Attribute("correct").Value=="yes").Select(x=>x) 
```

成为：

```
CorrectAnswer=docs.Elements("answer")
   .First(x=> x.HasAttributes && x.Attribute("correct").Value=="yes")
   .Value 
```

# coldfusion - 在 ColdFusion 10 的自定义标签中使用 CFThread 时出现未定义错误

> ID：11089901
> 
> 赞同：2
> 
> 时间：2012-06-18T19:43:10.643
> 
> 标签：coldfusion, custom-tag, coldfusion-10, cfthread

**注意：**我已经完全重写了这个问题以考虑新信息。如果你已经读过这个，请重新阅读。

`cfthread`在 ColdFusion 10 的自定义标签中使用 from 时出现错误。在应用程序日志中，我收到以下条目：

```
Variable _cffunccfthread_cfThreadTag2ecfm16902001291 is undefined. 
```

它作为错误返回的函数的名称是`_cffunccfthread_cf[Page Name Calling the CFThreadTag]`一个不会随着请求而改变的数字。我每次都可以使用以下代码复制它：

**应用程序.cfc：**

```
component
{
    this.name = "CFThreadCustomTagTest";
} 
```

**ThePage.cfm：**

```
<cfthread action="run" name="ThreadTestInPage">
    <cflog log="Application" text="The thread in the page successfully ran" type="information" />
</cfthread>
<cf_ThreadTag /> 
```

**ThreadTag.cfm：**

```
<cfif thisTag.ExecutionMode EQ "start">
    <cfthread action="run" name="ThreadTest">
        <cflog log="Application" text="The thread within the tag successfully ran" type="information" />
    </cfthread>
</cfif> 
```

只需将所有三个文件放在 ColdFusion 10 的目录中并加载 ThePage.cfm。我在应用程序日志中得到以下条目：

```
"Severity","ThreadID","Date","Time","Application","Message"
"Information","ajp-bio-8012-exec-1","06/19/12","07:18:11",,"C:\ColdFusion10\cfusion\logs\application.log initialized"
"Information","cfthread-11","06/19/12","07:18:15","CFTHREADCUSTOMTAGTEST","The thread in the page successfully ran"
"Error","cfthread-9","06/19/12","07:18:15",,"THREADTEST: Variable _cffunccfthread_cfThreadTag2ecfm16902001291 is undefined. " 
```

我还注意到，在自定义标签内的线程错误中，它*不*包含应用程序名称。虽然页面中线程的日志条目确实如此。请注意，错误行仅`,,`针对日志的 Application 列，而成功线程具有`"CFTHREADCUSTOMTAGTEST"`.

如果我更改`ThreadTag.cfm`为等待标记中的线程完成处理，那么一切正常，并且我得到了日志中的两个条目，如我所料：

```
<cfif thisTag.ExecutionMode EQ "start">
    <cfthread action="run" name="ThreadTest">
        <cflog log="Application" text="The thread within the tag successfully ran" type="information" />
    </cfthread>
    <cfthread action="join" name="ThreadTest" timeout="10" />
    <cfdump var="#cfthread#">

</cfif> 
```

为了验证任何地方都没有时髦的设置，这是我的[本地开发环境的设置摘要](https://dl.dropbox.com/u/2586403/serversettings.pdf)。

所以看起来如果我只是把线程扔出去，而不是等待它完成，那么线程似乎正在从父页面中寻找不再存在于内存中的东西。至少这是我完全没有根据的猜测:)。

我还向 Adob​​e 提交了一个错误。[错误号 3218452](https://bugbase.adobe.com/index.cfm?event=bug&id=3218452)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T12:59:22.567

我理解你的困境，但这里没有真正的*问题*。

基本上你在 CF 中发现了一个错误。一些人——包括我自己——可以复制它。

没有人会遗漏任何东西，除了 Adob​​e 工程师在实施 CF10 时错过了在回归测试中包含此类内容。这不是对他们的起诉，真的，因为我认为这是合理的边缘情况，也许？

CF 找不到的“变量”实际上是 CF 编译器在编译代码时生成的已编译类的名称。对我来说似乎有一个编译器错误。

例如，我的错误是这样的： `THREADTEST: Variable _cffunccfthread_cfThreadTag2ecfm13713410591 is undefined.`

但是编译的类是： `cfThreadTag2ecfm1371341059$func_CFFUNCCFTHREAD_CFTHREADTAG2ECFM13713410591.class`

我不知道应该为变量命名的类名的哪一部分，但我怀疑它应该寻找`func_CFFUNCCFTHREAD_CFTHREADTAG2ECFM13713410591`. 或者另一方面，编译器不应该将 ThreadTag.cfm 文件编译为 FUNCTION？但我猜......它可能需要将线程代码编译为函数以便在单独的线程中调用它？这是一个猜测。无论哪种方式：它将代码编译为一件事，然后寻找另一件事。因为一个错误。

但这里的底线是：是的，你发现了一个错误。您已经使用 Adob​​e 对其进行了标记。我不知道你在这里还能做什么？

所以基本上我们现在知道不能`<cfthread>`在自定义标签中进行调用（我也通过`<cfmodule>`：相同的问题进行了测试）。您将不得不使用包含或方法或其他东西以不同的方式编写代码。不太理想，我知道，但你能做什么？

脚注：我查看了编译后的代码，看起来问题是 CF 正在编译带有该`func_`前缀的类，但它在其代码中引用它时没有。我没有一直遵循代码来检查正在发生的所有事情，但在我看来，似乎有对它的引用试图加载`_cffunccfthread_cfThreadTag2ecfm13713410591`而不是正确的名称：`func_CFFUNCCFTHREAD_CFTHREADTAG2ECFM13713410591.class`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T13:32:22.310

担，

请看这个页面：

[http://help.adobe.com/en_US/ColdFusion/10.0/Developing/WSc3ff6d0ea77859461172e0811cbec0b2e1-7ff0.html](http://help.adobe.com/en_US/ColdFusion/10.0/Developing/WSc3ff6d0ea77859461172e0811cbec0b2e1-7ff0.html)

而本节“确定标签执行模式”

并尝试等效模式检查代码`<cfswitch expression=#thisTag.ExecutionMode#>`

看看这是否会导致不同的编译器代码生成。也许它会生成代码有点不同，并且会生成变量。

此外，另一个要尝试的测试是将您的标签放在“ThePage.cfm”中，看看这是否也会导致不同的代码生成。

最后，您是否使用较新的 JVM，因为较新的 JVM 使用 Java 并发方法的最新 Fork/Join 功能，例如 Futures 等，它们可能会导致不同的代码生成。也许将您的 JDK 设置为较旧的，看看代码生成是否不同。

没有真正的答案，但有些事情要看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:36:20.933

我也遇到了这个。

我的解决方案是重构并将 cfthread 内容放入 .cfc 并从 .cfm 页面调用它。

# ruby - 我可以使用什么 Ruby Regex 代码从输入“outofsight”中获取“outofsight”？

> ID：11089903
> 
> 赞同：0
> 
> 时间：2012-06-18T19:43:13.410
> 
> 标签：ruby, regex

我正在构建一个应用程序，它根据用户的电影输入返回结果。如果用户搞砸了并且忘记将电影的标题隔开，有没有办法我仍然可以接受输入并返回正确的数据？例如，“outofsight”仍将被解释为“outofsight”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T20:13:33.943

没有正则表达式可以以一种好的和可靠的方式做到这一点。您可以尝试像[Solr](http://lucene.apache.org/solr/)这样的搜索服务器。

或者，您可以在用户输入的 GUI（如果有的话）中自动完成，这样可以减轻用户最终可能会犯的一些常见错误。

# 例子：

1.  用户想要搜索“outofsight”
2.  开始输入“out”
3.  将“看不见”视为建议
4.  从建议中选择“看不见”
5.  ？？？
6.  利润！！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T19:53:44.457

没有正则表达式可以告诉您单词 break 应该在哪里。例如，如果输入是“offlight”，它应该返回“Off Light”还是“Of Flight”？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T21:29:18.990

你不能用正则表达式来做到这一点，除非你想存储一个或多个模式来匹配每个电影记录。那将是愚蠢的。

捕捉轻微拼写错误的更好方法是计算用户键入的内容与您的电影标题之间的[Levenshtein 距离。](http://en.wikipedia.org/wiki/Levenshtein_distance)但是，当您的电影列表很大时，这将成为一个相当缓慢的操作，因此您最好使用像 Lucene/Solr 这样擅长此类事情的专用搜索引擎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T19:50:03.287

如果没有字典和某种模糊搜索算法，这是不可能的。对于后者，请参阅[如何在 Ruby 中进行模糊子字符串匹配？](https://stackoverflow.com/questions/6093473/how-can-i-do-fuzzy-substring-matching-in-ruby).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-18T20:06:28.843

您可以取一个字符串并放在`\s*`每个字符之间。

所以`outofsight`将转换为：

`o\s*u\s*t\s*o\s*f\s*s\s*i\s*g\s*h\s*t`

...和匹配`out of sight`。

# c# - 如何创建 ClickOnce MS Office Outlook 加载项？

> ID：11089905
> 
> 赞同：1
> 
> 时间：2012-06-18T19:43:16.780
> 
> 标签：c#, outlook, clickonce, ms-office, add-in

我使用 Visual Studio 2005 创建的 Outlook 加载项不使用 ClickOnce 安装程序，而只是使用常规的 Windows 安装程序。

（文件 -> 新项目 -> 可扩展性 -> 共享加载项）

我需要使用 ClickOnce 安装程序创建加载项，因为据我所知，这是对加载项进行签名的唯一方法，因此它们可以在客户端计算机上进行宏安全设置的情况下运行。

有人可以告诉我如何使用 ClickOnce 创建 Outlook 加载项安装程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:56:51.377

将安装程序项目添加到您的解决方案。这会将应用程序安装到默认信任的程序文件目录中。它将要求最终用户具有管理员权限才能安装，但不需要对安装程序文件进行签名。从技术上讲，它不是一次单击安装，但它非常适用于办公室插件。

**编辑：**您还需要向注册表添加对插件的引用。查看MSDN 上[的使用 Windows Installer 为 Office 解决方案部署 Visual Studio 2010 工具。](http://msdn.microsoft.com/en-us/library/ff937654.aspx)图 6 及其前面的说明描述了这是如何完成的。

添加到注册表项的实际值可能有点令人困惑，所以这里是我使用的可以正常工作的值：

*   描述：`"Provides functionality to access data from ..."`
*   友好名称：`"CompanyTools"`
*   LoadBehavior：（`3`表示应在宿主应用程序启动时加载加载项）
*   显现：`"file:///[ProgramFilesFolder][Manufacturer]/[ProductName]/T360.Office.CompanyTools.vsto|vstolocal"`

另外，我认为您需要添加 Microsoft.VisualStudio.Tools.Applications.Runtime.dll 作为依赖项。我不认为它是默认的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T07:33:43.487

转到项目属性/签名选项卡。选中“签署 ClickOnce 清单”并提供您的签名证书。

现在转到发布选项卡。您需要填写发布文件位置，应该是 URL 或文件共享。如果安装位置与发布位置相同，可以留空。

单击先决条件按钮并确保选择了必要的先决条件。

单击更新按钮并选择检查或更新的频率。

单击选项。填写发布者名称（通常是您的公司）、产品名称（您希望它在卸载页面和 Office 产品的加载项列表中的外观）和支持 URL（如果需要）。检查办公室设置，太。

填写发布版本。

单击立即发布。它会将您的部署发布到发布文件位置。

您应该能够使用安装 URL 或发布位置来安装加载项。请注意，如果您正在运行 Office 产品，则需要将其关闭并重新打开以加载加载项。

# c# - 如何在隔离存储中保存最近的文本条目列表。？

> ID：11089906
> 
> 赞同：0
> 
> 时间：2012-06-18T19:43:20.233
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-7.1

在我的应用程序中，我有一个名为“msgBox”的文本框和一个名为“sendBtn”的按钮。
当用户点击按钮时，在 msgBox 中键入的文本将发送到服务器。

我想保存并显示最近发送的 15-20 个项目。
我怎样才能做到这一点..？？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:04:00.610

如果您想显示最近的项目，您可以在提交表单时包含当前日期。然后，在访问服务器时，按日期对项目进行排序，仅显示前 15-20。这种方法比创建另一个专门用于最近条目的表更简单。此外，按日期浏览档案会容易得多，因为日期将被标记到条目中。

作为 mySQL 语句（是我最了解的服务器语言），插入消息如下（其中 [message] 是经过清理的 MsgBox 值）：

```
INSERT INTO `messages` (`msg`,`date`) VALUES ('[message]',NOW()); 
```

检索看起来像这样：

```
SELECT `msg` FROM `messages` ORDER BY `date` DESC LIMIT 15; 
```

这种方法比创建另一个专门用于最近条目的表更简单。此外，按日期浏览档案会容易得多，因为日期将被标记到条目中。

希望这可以帮助！

# jquery - 显示/隐藏 jPlayer Div

> ID：11089908
> 
> 赞同：1
> 
> 时间：2012-06-18T19:43:24.057
> 
> 标签：jquery, html, jplayer

我试图弄清楚如何在单击链接时从页面顶部淡入 jPlayer，然后在歌曲停止播放时让它淡出。

我还刚刚开始，我可以让 jPlayer 正常工作，但是我在尝试实现显示/隐藏功能时遇到了麻烦。

有人可以帮我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T21:38:25.717

尝试这个：

```
$(document).ready(function() {

    $("#jp_container").hide();

    $.jPlayer.event.play, function() {
        $("#jp_container").slideDown();
    });

    $.jPlayer.event.ended, function() {
        $("#jp_container").slideUp();
    });

}); 
```

# google-apps-script - 将压缩后的数据导入 Google 表格

> ID：11089910
> 
> 赞同：4
> 
> 时间：2012-06-18T19:43:32.903
> 
> 标签：google-apps-script, google-sheets, gzip, import-from-csv

我正在尝试从 URL 获取 gzip 并将其自动导入 Google 表格。gzip 包含一个 CSV 数据文件。

我知道我可以将 CSV 数据导入 Google 表格，但我希望能够省去下载 gzip 并在将文件上传到 Google 表格之前先提取文件的步骤。

所以我的查询：

是否可以将压缩后的 CSV 文件从 URL 直接导入 Google 表格？

如果没有，如何使用 Google Apps 脚本来完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-12-20T05:36:42.547

我能够使用第三方 javascript 库 pako 对 gzip 压缩文件进行膨胀（解压缩）。这是代码：

```
 eval(UrlFetchApp.fetch('https://cdn.rawgit.com/nodeca/pako/master/dist/pako.js').getContentText());

  var charData = UrlFetchApp.fetch("<url to a .gz file>").getContent();

  var binData = [];
  for (var i = 0; i < charData.length; i++) {
    binData.push(charData[i] < 0 ? charData[i] + 256 : charData[i]);
  }

  var data = pako.inflate(binData);

  var decoded = '';
  for (var i = 0; i < data.length; i++) {
    decoded += String.fromCharCode(data[i]);
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T21:59:21.770

GAS 中有一个名为 unzip 的未记录实用程序，我知道它可以解压缩普通的 .zip 文件，但不知道是否支持 GNU zip……也许值得一试？这是我为我的谷歌文档/驱动器中的 zip 编写的快速测试

```
function testzip(){
var files=DocsList.getRootFolder().find('Sans titre.txt.zip');
var zipblob=files[0].getBlob();
var unzipblob = Utilities.unzip(zipblob);
var unzipstr=unzipblob[0].getDataAsString();// it is a text file
DocsList.createFile('Sans titre.txt',unzipstr);// I kept the original name to make it simple
} 
```

如果它对您不起作用，请不要怪我……这只是一个建议；-)

# ruby-on-rails - 设计打破了生产中的迁移

> ID：11089911
> 
> 赞同：0
> 
> 时间：2012-06-18T19:43:36.117
> 
> 标签：ruby-on-rails, devise, capistrano

我正在使用设计 2.1.0。在开发方面，事情很棒。我刚刚尝试进行上限部署：迁移到我在 EC2 中设置的新服务器，并在设计迁移时出错。我正在使用运行 ruby​​ 1.9.3 的 rvm。我的数据库是 MySql，它通过 Amazon RDS 运行。它错误的迁移是：

```
def self.up
 change_table(:users) do |t|
  t.database_authenticatable :null => false
  t.recoverable
  t.rememberable
  t.trackable
 end

 add_index :users, :email,                :unique => true
 add_index :users, :reset_password_token, :unique => true 
```

结尾

出现此错误：ActiveRecord::ConnectionAdapters::Table:0x00000004eb8968 的未定义方法“database_authenticable”

我已经确认设计 gem 已经安装在服务器上。我也尝试过直接从服务器运行迁移，但它失败了。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:55:23.430

我相信迁移方法`database_authenticatable`已从设计中删除。它们在 2.0 中被弃用并在 2.1 中被删除。

您必须明确创建必填字段。例如

```
def self.up
 change_table(:users) do |t|
   t.string :email
   t.string :encrypted_password
   t.timestamps
end 
```

请参阅[如何：](https://github.com/plataformatec/devise/wiki/How-To%3a-Upgrade-to-Devise-2.0-migration-schema-style)从 Devise wiki 升级到 Devise 2.0 迁移模式样式。

# objective-c - 在 Xcode IB 中链接新标签时崩溃

> ID：11089913
> 
> 赞同：0
> 
> 时间：2012-06-18T19:43:50.290
> 
> 标签：objective-c, xcode

我昨晚更新到 Xcode 4.3.3。今天我尝试在表单中添加另一个 UILabel。为了测试东西，我什至只是将完全匹配的内容复制并粘贴到 .h 文件中已经存在的标签上，并在末尾添加了 2。一切运行良好。但是，一旦我将标签链接到文件所有者并运行，我就会收到以下错误。这怎么可能？

在 .h 文件中（accountNumText 效果很好，但连接 accountNumText2 会杀死它）

```
UILabel *accountNumText;
UILabel *accountNumText2;
}
@property (nonatomic, retain) IBOutlet UILabel *accountNumText;
@property (nonatomic, retain) IBOutlet UILabel *accountNumText2; 
```

在 .m 文件中

```
@synthesize patientNameText, accountNumText, accountNumText2;

- (void)dealloc
{

    [patientNameText release]; 
    [accountNumText release];
    [accountNumText2 release];
} 
```

在 IB 中，我删除了所有内容，只看到了 2 个 UILabel 的视图。我将一个连接到 accountNumText 保存并运行，它工作得很好。我将另一个连接到 accountNumText 并崩溃！

唯一的区别是我升级之前 accountNumText 就在那里，而 accountNumText2 是在我升级之后添加的。帮助！

```
ERROR: thread 1: signal SIGABRT

int main(int argc, char *argv[]) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    [pool release];
    return retVal;
} 
```

# git - Git 提交失败：“断言 `g_type_from_name (name) == 0' failed”

> ID：11089914
> 
> 赞同：2
> 
> 时间：2012-06-18T19:43:51.597
> 
> 标签：git, ubuntu

我是 Git 的初学者，我尝试做我的第一次提交。

命令后`$ git commit`，我收到以下消息：

```
/usr/lib/python2.7/dist-packages/gobject/constants.py:24: Warning: g_boxed_type_register_static: assertion `g_type_from_name (name) == 0' failed
  import gobject._gobject 
```

有谁知道如何解决这个问题？

*   Ubuntu版本：12.04
*   Git版本：1.7.9.5

**稍后添加：** 现在我收到此消息：**“由于提交消息为空，正在中止提交。”**

我的默认编辑器是 gedit。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T17:38:02.137

试试`git commit -m "commit message"`。如果这可行，那么您的问题可能与编辑器有关。将您的提交消息编辑器设置为在终端中工作的东西，例如 vim 或 nano

```
git config --global core.editor "nano" 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T00:38:18.663

这可能与 git 无关（除非您从 python 解释器会话中键入 git 命令！）

它更有可能与您当前的操作系统（Ubuntu 12.04）及其与安装在其上的软件之一的交互有关：
请参阅[此 Ubuntu 错误 962639](https://bugs.launchpad.net/ubuntu/+source/python-defaults/+bug/962639)，它报告了相同类型的错误消息。目前（2012 年 4 月至 2012 年 6 月）
正在试验修复程序。`/usr/lib/python2.7/dist-packages/gobject/constants.py`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T09:53:21.717

我暂时用过`git commit -a -m "My commit message"`。

干杯

# regex - R：如何使用正则表达式区分内括号和最内括号

> ID：11089919
> 
> 赞同：2
> 
> 时间：2012-06-18T19:44:18.567
> 
> 标签：regex, r, brackets

我需要的字符串`((VBD)(((JJ))(CC)((RB)(JJ)))((IN)((DT)(JJ)(NNP)(NNPS))))`是：

`"JJ", "RBJJ", "DTJJNNPNNPS", "JJCCRBJJ", "INDTJJNNPNNPS" "VBDJJCCRBJJINDTJJNNPNNPS"`

也就是说，要查找最里面的括号之间的文本，请删除紧邻的括号，以便可以组合和提取文本。但这包括不同的层次。括号的揭开不能一次完成，因为括号的 no, 失去了平衡：

```
str1<-c()
str2<-c()
library(gsubfn)
strr<-c("((VBD)(((JJ))(CC)((RB)(JJ)))((IN)((DT)(JJ)(NNP)(NNPS))))")
repeat {
str1<-unlist(strapply(strr, "((\\(([A-Z])+\\))+)"))
str2<-append(str1, str2)
strr<-gsub("(\\(\\w+\\))", "~\\1~", strr)
strr<-gsub("~\\(|\\)~", "", strr)
if (strr == "") {break}
}

strr
[1] "(VBD(JJCCRBJJINDTJJNNPNNPS" 
```

左括号阻止了文本的组合，使其逃脱了正则表达式。我认为解决这个问题的方法是区分最里面的括号（JJ、RB、JJ、DT、JJ、NNP、NNPS、（新鲜字符串上的 2、4、5、7、8、9、10））和内部括号括号。这样当所有最里面的括号都被逐步揭开，文本合并提取时，我们将到达整个字符串。是否有正则表达式可以做到这一点？或者还有其他方法吗？请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T22:09:59.367

这不使用正则表达式。事实上，我不确定 regexp 是否足够强大来解决问题以及解析器是否必要。我没有在 R 中创建/定义解析器，而是利用现有的`R`代码解析器。这样做会使用一些相当具有潜在危险的技巧。

基本思想是将字符串转换为可解析的代码，该代码使用列表生成树结构。然后这个结构被有效地反向修剪（只保留叶子节点向内），并创建每个级别的各种字符串。

一些辅助包

```
library("plotrix")
library("plyr") 
```

您提供的原始字符串

```
strr<-c("((VBD)(((JJ))(CC)((RB)(JJ)))((IN)((DT)(JJ)(NNP)(NNPS))))") 
```

将此字符串转换为可解析的代码，引用括号内的内容，然后使每组括号调用`list`. 必须在列表项之间插入逗号，但最里面的部分始终是长度为 1 的列表，所以这不是问题。然后解析代码。

```
tmp <- gsub("\\(([^\\(\\)]*)\\)",  '("\\1")', strr)
tmp <- gsub("\\(", "list(", tmp)
tmp <- gsub("\\)list", "),list", tmp)
tmp <- eval(parse(text=tmp)) 
```

此时，`tmp`看起来像

```
> str(tmp)
List of 3
 $ :List of 1
  ..$ : chr "VBD"
 $ :List of 3
  ..$ :List of 1
  .. ..$ :List of 1
  .. .. ..$ : chr "JJ"
  ..$ :List of 1
  .. ..$ : chr "CC"
  ..$ :List of 2
  .. ..$ :List of 1
  .. .. ..$ : chr "RB"
  .. ..$ :List of 1
  .. .. ..$ : chr "JJ"
 $ :List of 2
  ..$ :List of 1
  .. ..$ : chr "IN"
  ..$ :List of 4
  .. ..$ :List of 1
  .. .. ..$ : chr "DT"
  .. ..$ :List of 1
  .. .. ..$ : chr "JJ"
  .. ..$ :List of 1
  .. .. ..$ : chr "NNP"
  .. ..$ :List of 1
  .. .. ..$ : chr "NNPS" 
```

括号的嵌套现在是列表的嵌套。需要更多的辅助函数。第一个折叠低于某个深度的所有内容，并丢弃高于该深度的任何节点。第二个只是粘贴的包装器，用于共同处理列表中的一个元素。

```
atdepth <- function(l, d) {
  if (d > 0 & !is.list(l)) {
    return(NULL)
  }
  if (d == 0) {
    return(unlist(l))
  }
  if (is.list(l)) {
    llply(l, atdepth, d-1)
  }
}

pastelist <- function(l) {paste(unlist(l), collapse="", sep="")} 
```

创建一个列表，其中每个元素都是折叠到特定深度的树结构。

```
down <- llply(1:listDepth(tmp), atdepth, l=tmp) 
```

向后迭代此列表，将叶子集粘贴在一起。向后“向上”（折叠）树。这样做会产生一些空白字符串（上面有一片叶子），所以这些被修剪掉了。

```
out <- if (length(down) > 2) {
  c(unlist(llply(length(down):3, function(i) {
    unlist(do.call(llply, c(list(down[[i]]), replicate(i-3, llply), pastelist)))
  })), unlist(pastelist(down[[2]]))) 
} else {
  unlist(pastelist(down[[2]]))
}
out <- out[out != ""] 
```

结果是我认为你要求的：

```
> out
[1] "JJ"                       "RBJJ"                    
[3] "DTJJNNPNNPS"              "JJCCRBJJ"                
[5] "INDTJJNNPNNPS"            "VBDJJCCRBJJINDTJJNNPNNPS"
> dput(out)
c("JJ", "RBJJ", "DTJJNNPNNPS", "JJCCRBJJ", "INDTJJNNPNNPS", "VBDJJCCRBJJINDTJJNNPNNPS"
) 
```

编辑：

回应带有后续问题的评论：如何调整它以处理一组这些字符串。

解决 do-it-multiple-times-for-different-inputs 的一般方法是创建一个函数，该函数将单个项目作为输入并返回相关的单个输出。然后使用 apply 系列函数之一循环该函数。

将之前的所有代码合并到一个函数中：

```
parsestrr <- function(strr) {
  atdepth <- function(l, d) {
    if (d > 0 & !is.list(l)) {
      return(NULL)
    }
    if (d == 0) {
     return(unlist(l))
    }
    if (is.list(l)) {
      llply(l, atdepth, d-1)
    }
  }

  pastelist <- function(l) {paste(unlist(l), collapse="", sep="")}

  tmp <- gsub("\\(([^\\(\\)]*)\\)",  '("\\1")', strr)
  tmp <- gsub("\\(", "list(", tmp)
  tmp <- gsub("\\)list", "),list", tmp)
  tmp <- eval(parse(text=tmp))
  down <- llply(1:listDepth(tmp), atdepth, l=tmp)
  out <- if (length(down) > 2) {
    c(unlist(llply(length(down):3, function(i) {
      unlist(do.call(llply, c(list(down[[i]]), replicate(i-3, llply), pastelist)))
    })), unlist(pastelist(down[[2]]))) 
  } else {
    unlist(pastelist(down[[2]]))
  }
  out[out != ""]
} 
```

现在给定一个要处理的字符串向量，例如：

```
strrs<-c("((VBD)(((JJ))(CC)((RB)(JJ)))((IN)((DT)(JJ)(NNP)(NNPS))))",
         "((VBD)(((JJ))(CC)((RB)(XX)(JJ)))((IN)(BB)((DT)(JJ)(NNP)(NNPS))))",
         "((VBD)(((JJ)(QQ))(CC)((RB)(JJ)))((IN)((TQR)(JJ)(NNPS))))") 
```

您可以使用

```
llply(strr, parsestrr) 
```

返回

```
[[1]]
[1] "JJ"                       "RBJJ"                    
[3] "DTJJNNPNNPS"              "JJCCRBJJ"                
[5] "INDTJJNNPNNPS"            "VBDJJCCRBJJINDTJJNNPNNPS"

[[2]]
[1] "JJ"                           "RBXXJJ"                      
[3] "DTJJNNPNNPS"                  "JJCCRBXXJJ"                  
[5] "INBBDTJJNNPNNPS"              "VBDJJCCRBXXJJINBBDTJJNNPNNPS"

[[3]]
[1] "JJQQ"                     "RBJJ"                    
[3] "TQRJJNNPS"                "JJQQCCRBJJ"              
[5] "INTQRJJNNPS"              "VBDJJQQCCRBJJINTQRJJNNPS" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T20:56:29.720

我不确定您是否只想构建平衡文本的树结构。
或者，为什么要在最内层去除包含括号。

使用您的示例，如果要分阶段进行，则必须首先确定最内层。然后括号在递归传递的后续级别中被剥离。

这当然需要一种平衡文本的方法。一些正则表达式引擎可以做到这一点。
如果您使用的引擎不支持此功能，则必须通过文本处理手动完成。

我碰巧有一个正则表达式分析程序。我将您的初始字符串注入其中，并通过组级别对其进行可视化格式化。每次通过，我只是剥离了模拟递归的内括号。

也许这可以帮助您想象需要做什么。

```
 ## Pass 0
 ## ---------
 (
      ( VBD )
      (
           (
                ( JJ )
           )
           ( CC )
           (
                ( RB )
                ( JJ )
           )
      )
      (
           ( IN )
           (
                ( DT )
                ( JJ )
                ( NNP )
                ( NNPS )
           )
      )
 )

 ## Pass 1
 ## ---------
 (
      ( VBD )
      (
           ( JJ )
           ( CC )
           ( RB JJ )
      )
      (
           ( IN )
           ( DT JJ NNP NNPS )
      )
 )

 ## Pass 2
 ## ---------
 (
      ( VBD )
      ( JJ CC RB JJ )
      ( IN DT JJ NNP NNPS )
 )

 ## Pass 3
 ## ---------
 ( VBD JJ CC RB JJ IN DT JJ NNP NNPS )

 ## Pass 4
 ## ---------
 VBD JJ CC RB JJ IN DT JJ NNP NNPS 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:53:41.130

你真的不需要在这里考虑匹配括号......听起来你只是想递归匹配 pattern `[()]([^()]*)[()]`。

也就是说，“匹配包含 no`(` `)`并由`(`or分隔的内容`)`”

# algorithm - 确定一组点的“内部域”

> ID：11089925
> 
> 赞同：3
> 
> 时间：2012-06-18T19:44:49.267
> 
> 标签：algorithm, math, polygon, computational-geometry, point

我有一组 (x, y) 点，我想从这些点中插入这组点“内部”的任何点的值。（下图中黄色区域）。

![示例图片](../Images/162fbbc898f1e31fc022c088394ed983.png)

问题是我没有找到任何好的方法：

1.  找到将成为我的插值点边界的多边形（绿线）
2.  测试该点是否在多边形内。我找到了[Point in Polygon](http://en.wikipedia.org/wiki/Point_in_polygon)算法，但我不确定在某个范围内获取所有点并测试它们是否属于多边形是一个好主意。我想找到一种方法让我测试比 (max(x)-min(x))*(max(y)-min(y)) 更少的点，理想情况下是一种知道哪些点的方法做我的迭代。

编辑：在第二部分我迭代图像中的所有点（像素），我想做的只是迭代黄色字段中的点。

你有铅吗？

Ps：如果有任何帮助，我正在用 C++ 编码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-18T19:47:53.007

您正在查看的绿线称为点集的**[凸包](http://en.wikipedia.org/wiki/Convex_hull)**，并且有[许多好的、有效的算法可以计算它](http://en.wikipedia.org/wiki/Convex_hull_algorithms)。它们中最好的运行时间为 O(n log h)，其中 h 是在船体上找到的点数，n 是点的总数。作为一种完全无耻的自我推销，我在我的个人网站上提供**[了其中一种算法的 C++ 实现。](http://www.keithschwarz.com/interesting/code/?dir=graham-scan)**

至于你的第二个问题——一旦你有了凸包，就很容易确定哪些点纯粹在多边形内部，而不是在凸包上。只需制作所有点的哈希表，然后遍历凸包并删除包中包含的所有点。哈希表中剩下的是包含在多边形内但不在边界上的点集。

希望这可以帮助！

# php - PHP中的静态函数有时会返回错误（非法偏移类型）？

> ID：11089930
> 
> 赞同：0
> 
> 时间：2012-06-18T19:45:14.243
> 
> 标签：php, function

这是一个我稍作修改的函数来解码编码文件。

```
# decode a bencoded string
public static function decode($s, &$pos = 0) {
    if($pos >= strlen($s)) {
        return false;
    }
    switch($s[$pos]) {
        case 'd':
            ++$pos;
            $retval = array();
            while(isset($s[$pos]) && $s[$pos] != 'e') {
                $key = self::decode($s, $pos);
                $val = self::decode($s, $pos);
                if($key == false || $val == false) {
                    break;
                }
                $retval[$key] = $val; // ERROR OCCURES HERE
            }
            $retval['isDct'] = true;
            ++$pos;
            return $retval;
        case 'l':
            ++$pos;
            $retval = array();
            while(isset($s[$pos]) && $s[$pos] != 'e') {
                $val = self::decode($s, $pos);
                if($val == false) {
                    break;
                }
                $retval[] = $val;
            }
            ++$pos;
            return $retval;
        case 'i':
            ++$pos;
            $digits = strpos($s, 'e', $pos) - $pos;
            $val = (int)substr($s, $pos, $digits);
            $pos += $digits + 1;
            return $val;
        default:
            $digits = strpos($s, ':', $pos) - $pos;
            if($digits < 0 || $digits > 20) {
                return false;
            }
            $len = (int)substr($s, $pos, $digits);
            $pos += $digits + 1;
            $str = substr($s, $pos, $len);
            $pos += $len;
            return (string)$str;
    }
    return false;
} 
```

您会注意到我已经评论了错误发生的位置；

`Illegal offset type`

我不知道这是怎么发生的，尽管在分配之前`$retval[$key] = $val`我先检查其中一个值是否为假，然后是否从 switch 语句中中断。

就像我说的那样，这可能每 50 次尝试解码编码字符串时才会发生一次。

有谁知道我该如何解决这个问题或者是什么原因造成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:48:29.680

`$key`必须是一个字符串（或能够被杂耍成一个）。任何其他类型，它都会抛出该错误。您正在检查 bool`false`是好的，但它也可能是`true, null, object, array`，等等。

# audio - 如何通过 J2ME 中的扬声器播放音频

> ID：11089934
> 
> 赞同：-1
> 
> 时间：2012-06-18T19:45:23.180
> 
> 标签：audio, java-me, playback, mmapi, speaker

我正在使用 JSR 135 播放音频文件。这就是我的做法。

```
InputStream is = getClass().getResourceAsStream("/tone.mp3");
Player p = Manager.createPlayer(is, "audio/mp3");             
p.start();

// get volume control for player and set volume to max
VolumeControl vc = (VolumeControl) p.getControl("VolumeControl");
if (vc != null) {
    vc.setLevel(100);
}
p.close();
p = null;
is.close();
is = null; 
```

但我需要音频始终通过手机的扬声器播放。此时，如果我插入耳机，声音只会在听筒中播放。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:08:56.060

不，没有办法做到这一点，海事组织也是如此。

# php - _SESSION 在验证码文件中不可见

> ID：11089937
> 
> 赞同：2
> 
> 时间：2012-06-18T19:45:41.750
> 
> 标签：php, session, captcha

我想使用验证码生成器，女巫的工作方式如下：

1）在 $_SESSION 变量中保存一些安全文本 2）显示验证码图像。

```
<img src="http://www.website.ro/captcha/captcha_source.php"> 
```

验证码图像是一个 php 文件，它读取 $_SESSION["security_text"] 并通过将 it-s 标头设置为图像来生成图像：

```
header(&quot;Content-type:image/jpeg&quot;);
header(&quot;Content-Disposition:inline ; filename=secure.jpg&quot;); 
```

3）将提交的文本与存储在_SESSION中的文本进行比较

问题：-我设置 $_SESSION["outside"]="outside"; 在图像标记之前，但在 captcha_source.php 内部，$_SESSION 变量为空。

- 如果我在 captcha_source.php 的开头给它 session_start()，则 session_id 与站点的其余部分相同，但 _SESSION 仍然为空。

- 如果我设置 $_SESSION["inside"]="inside"; 在 captcha_source.php 中，当我在 captcha_source.php 之外读取 SESSION 时（在 img 标签之后），SESSION 只包含 ["outside"]="outside"。（并且在 captcha_source 内部，会话打印为 inside=>inside）

- 如果我删除带有 img src=captcha_source.php 的行，并将 SESSION 设置为“test”并在表单中写入“test”，则提交后一切正常（但我没有图像，因为它不包括在内）。

- 如果不是将文件包含在图像标记中，而是将其包含为包含“/captcha/captcha_source.php”，它将设置会话正常，但我需要图像，而不是垃圾文本。

所以会话从一个页面到另一个页面工作，但不知何故不在 captcha_soruce.php 内。即使 id-s 相同，会话也完全独立。

一种预感是问题出在 htaccess （但相同的会话 id-s 很奇怪），可能来自以下几行：（验证码文件夹的处理方式不同，但基地址应保持不变）

```
RewriteCond $1 !^(index_ro|imagini|extra|fisiere|slider|tinymce|captcha)
RewriteRule ^(.*)/ index_ro.php?$1/ 
```

也许相同的会话与我读取文件的方式有关：从 captcha_source.php 中删除标题并打开文件 www.site.ro/captcha/captcah_source.php 使用相同的浏览器（firefox）。我看到了我打印的垃圾文本、会话 ID 和会话变量。使用同一站点打开多个选项卡，保持相同的 ID。

我希望它不会太长，但是自从我遇到这个问题以来已经有 2 天了。如果它不起作用，我将使用 sql 执行此操作，但我想知道问题出在哪里，这样它就不会在其他情况下再次出现。

谢谢 ：）

这是一个剥离代码来显示发生了什么：

```
//the form part

<?php
    session_start();

    echo session_id();  //prints the same as on all pages

    //the form was not submittted
    if(!$_POST["mail_form_captcha"])
    {
        unset($_SESSION); //just to be sure nothing remains from older sessions

    //generate form that has a field "mail_form_captcha"
    [...]

        //generate a random text for captcha and put it in security_text
        InitCaptcha();

        $_SESSION["before"]="before";

        ?>       
    <img src="<?php echo "./captcha/image.php"; ?>" />
        <?php

        //include "./captcha/image.php"; //if uncoment this line, everything works, but the image is included as garbage text

        $_SESSION["after"]="after";

        print_r($_SESSION); //this prints [security_text] => 10 [before] => before [after] => after

    }
    else //interpret the submission
    {
        print_r($_SESSION); //this is empty if session_start() is at the beginning of captcha_source.php, otherwise only contains before after and security_text
    }

?>

//the captcha part
<?php
    session_start();    //if included, it erases the session from the other files, otherwise it leaves it intact :-/

    $_SESSION["inside"]="inside";

    print_r($_SESSION); //this prints [inside] => inside

    echo session_id();  //this prints the same session id as on the rest of the pages

[...]

    imagettftext([...] $_SESSION["security_text"]); //this draws a blank image

[...]

    header("Content-type:image/jpeg");

    header("Content-Disposition:inline ; filename=secure.jpg");

    imagejpeg($img);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:55:06.243

正如我所说我不会尝试使用此验证码进行任何其他操作，我尝试将所有文​​件移动到与调用它的文件相同的目录中（它位于文件 ./captcha 中），它现在可以工作了！！！它在不同的目录中有什么问题？

# c# - “指定的转换无效”转换 ExecuteScalar 的结果

> ID：11089939
> 
> 赞同：4
> 
> 时间：2012-06-18T19:45:55.630
> 
> 标签：c#, asp.net

我正在尝试为一个项目编写代码，但无效的特定转换错误不断出现。任何人都可以帮助我，因为我很难过。提前致谢。

```
Server Error in '/c#project' Application.

Specified cast is not valid.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.InvalidCastException: Specified cast is not valid.

Source Error: 

Line 39:         cmd.Parameters.Add("@ProductId", OleDbType.Char).Value = strProductId;
Line 40:         object oQty = cmd.ExecuteScalar();
Line 41:         int intQuantityOnHand = (int)oQty;
Line 42:         mDB.Close();
Line 43:         int intBuyQuantity = int.Parse(ddlQty.Items[ddlQty.SelectedIndex].ToString());

Source File: c:\Users\jacob\Desktop\c#project\ProductDetails.aspx.cs    Line: 41 

Stack Trace: 

[InvalidCastException: Specified cast is not valid.]
   ProductDetails.btnBuy_Click(Object sender, EventArgs e) in c:\Users\jacob\Desktop\c#project\ProductDetails.aspx.cs:41
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +118
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +112
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T19:52:44.403

第 41 行：显然`oQty`不能转换为`Int32`. 尝试

```
int intQuantityOnHand = Convert.ToInt32(oQty); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T22:58:17.027

尝试这个：

```
object oQty = cmd.ExecuteScalar();
int? intQuantityOnHand = (oQty as int); 
```

然后检查`if(intQuantityOnHand !=null)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-12T19:35:04.447

`ExecuteScalar`返回[结果集中第一行的第一列，或空引用](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)。这可以是任何东西；整数、null、字符串、varbinary。您必须检查查询的第一列的类型并分配给该类型的变量。

另外，你为什么这样做：

```
int intBuyQuantity = int.Parse(ddlQty.Items[ddlQty.SelectedIndex].ToString()); 
```

您正在将某些内容转换为字符串，然后将字符串转换为整数。为什么？它是一个字符串吗？那么这可能会引发异常。是整数吗？然后将其读取为整数。你在用`System.Data.SqlClient`吗？其中包含`GetInt32`返回正确类型数据的方法；你不需要强制转换、解析或其他任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T20:02:18.410

如果您的结果集为空，您应该进行一次空检查。

```
if(oQty!=null){
  int intQuantityOnHand = (int)oQty;
} 
```

那，或者默认你的价值......

```
 int intQuantityOnHand = (oQty==null) ? 0 : (int)oQty; 
```

根据 MSDN，[ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)返回

> [t]结果集中第一行的第一列，如果结果集为空，则为空引用（在 Visual Basic 中为 Nothing）。返回最多 2033 个字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T19:53:42.313

我相信错误在第 41 行。在第 41 行设置断点，看看 oQty 的值是多少。它可能为空。

# bash - Bash 中的加法赋值

> ID：11089940
> 
> 赞同：0
> 
> 时间：2012-06-18T19:46:00.580
> 
> 标签：bash, addition

在 C++ 中，如果您有两个变量 a 和 b，您可以这样做将 b 添加到 a：

```
a += b; 
```

你怎么能在 bash 中做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T19:50:51.037

将表达式括在双括号中，如下所示：

```
a=$(($a + $b)) 
```

或者，您可以执行以下操作：

```
(( a+= $b )) 
```

甚至：

```
let a+=$b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:52:55.687

```
#!/bin/bash
echo "enter two numbers:"
read a b
let a+=$b
echo $a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T20:08:45.147

如果您使用`(( ... ))`语法，则根本不需要`$`在大多数（简单）变量之前使用，因此您可以这样做：

```
a=$((a + b)) 
```

或者

```
((a += b)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T19:50:30.557

嗯，`a +=b`只是`a = a + b`。

在 bash 中，您可以使用以下语法：

`a=$(($a+ $b))`

# algorithm - 使用链接填充哈希表的最坏情况和最佳情况时间？

> ID：11089941
> 
> 赞同：2
> 
> 时间：2012-06-18T19:46:01.343
> 
> 标签：algorithm, data-structures, hashtable, complexity-theory, big-o

显然最好的情况是 O(n)，但显然最坏的情况是 O(n ² )，我不明白。如果您将哈希表实现为链表数组，我假设最坏的情况是每个哈希都到同一个地方。

所以不是把每个项目仍然是 O(1)，因为将项目添加到链表只是在末端/前面粘贴一个节点的问题？在最坏的情况下，你最终会得到一个空桶数组 + 一个大小为 n 的桶？我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T20:06:33.997

我猜他们假设一个实现会在插入之前检查哈希表中是否存在元素（这是典型的，因为哈希表通常在理论上代表集合）。该实现必须在插入新元素之前检查列表的每个元素。

# c# - 带有自引用表的 EF 和 Linq

> ID：11089942
> 
> 赞同：3
> 
> 时间：2012-06-18T19:46:14.107
> 
> 标签：c#, linq, entity-framework

![样品表](../Images/dfda208f2099e58822ee2e4c05de2c82.png)

我的数据库中有一个类似于上面的自引用表。基本上它的设置方式是每行都有一个唯一的 ID（身份 PK）和一个 DependentID，以指示它所依赖的集合中的任何其他记录。它与您经常在 SQL 教科书中看到的父子类型示例非常相似，但我的案例在某种意义上是微妙的独特，因为给定的记录也可以依赖于自身（参见上面的第 1 行）

两个问题：

1.  可以使 EF 正确地表示这种关系吗？我在这里阅读了几篇文章，表明它不能优雅地处理这种情况，所以我最初的想法是它甚至可能不值得，我最好把它当作普通表并编写业务逻辑以确保数据被正确插入/更新。在我的场景中，我永远不会通过 EF 查询这些实体，该应用程序基本上会在启动时将它们全部加载，然后我将在运行时对它们运行 linq 查询以根据需要进行过滤

2.  假设我无法让它与 EF 一起使用，并且正如我在 #1 中指出的那样，我只是在启动时将它们全部加载到内存中（只有 50-100 左右），那么最有效的加入方式是什么这是通过linq？我希望能够传入一个 DependentId 并获取与其关联的所有记录及其属性......所以在这个例子中我想传入 '1' 并返回：

1 - 约翰 - 10

2 - 迈克 - 25

3 - 鲍勃 - 5

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T20:01:56.100

事实上，实体框架不能表示这样的关系，当然不能以递归查询的形式。

但是您不是在要求递归查询，因此您可以将 DependentId 视为另一个数据列。这样做，构建和执行对数据库的问题二查询将是微不足道的。

更新：

该查询看起来像

```
int dependentIdToSearch = 1;

var q = from something in db.mytable
        where something.DependentId == dependentIdToSearch
        select new { something.Id, something.Name, something.Value }; 
```

结束更新

如果您确实需要递归查询（所有直接和间接依赖项），则需要一个具有公共表表达式的表值函数。实体框架也不能处理这个问题，至少在当前版本中是这样。如果您需要这种支持，您可以等待 EF 5 或使用 Linq to SQL（从几年前的第一个版本开始就支持表值函数）。

您确实也可以读取内存中的整个表，前提是它是只读的，或者只有“一个内存”（单个服务器，不是负载平衡的或具有本地数据库的客户端应用程序）。

如果它是只读的，您可以选择在加载时构建一次对象图，以便以后高效执行。例如，您可以定义一个类，其中包含依赖于每个对象的对象集合。然后，您的查询将成为对该集合的微不足道的迭代。

# css - IE8 的 CSS 问题

> ID：11089945
> 
> 赞同：0
> 
> 时间：2012-06-18T19:46:15.957
> 
> 标签：css, internet-explorer, header

创建一个新站点，但在 IE8 中发生了一些事情。社交栏向下对齐，而不是像在所有其他浏览器中那样向右浮动，因此它会将导航栏和搜索栏向下推到幻灯片下方。我也已经有 html5 shiv 了。

```
#header-right { width: 560px; height: 400px; margin-top: 30px; float: right; height: 189px;}
.social-widget { width: 100%; height: 46px; display: block;}
.social-widget p {float: right;}
.social-widget img {margin: 0 5px 0 5px; float: left;}
.search-widget { width: 400px; float: right;}

#banner { margin-top: 240px; clear: both; width: 1003px; margin: 0px auto;} 
```

HTML

```
<div id="header-right">

    <span class="social-widget"><?php dynamic_sidebar( 'social-media-widget' ); ?></span>

    <nav id="access" role="navigation">
        <?php wp_nav_menu( array( 'theme_location' => 'primary' ) ); ?>
    </nav><!-- #access -->

    <span class="search-widget"><?php dynamic_sidebar( 'search-widget' ); ?></span>
</div><!-- #header-right -->

</header><!-- header --> 
```

IE8 我缺少什么？任何帮助表示赞赏.c

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:57:02.120

我认为对于某些版本的 IE 来正确布局浮动（我似乎记得这确实适用于 v8），它们必须在 html 中的其他元素之前。

```
<div>
  <p>Paragraph floated right</p>
  <p>Unfloated content</p>
</div> 
```

现代浏览器不关心浮动是在其余内容之前还是之后，但 IE 首先想要它。

我经常发现 inline-blocks + text-align 属性对于这类事情比浮动更有用。像这样的东西可能更符合您的要求：

[http://jsfiddle.net/euNa5/17/](http://jsfiddle.net/euNa5/17/)

这两个 50% 宽的内联块的诀窍是将标签混合在一起`</span><span>`——没有空格。空白将使它们换行到单独的行上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T07:23:19.273

在此您使用**HTML5**即`<header></header>`标记，尝试使用 div 代替标题...

[http://jsfiddle.net/LL7YV/5/](http://jsfiddle.net/LL7YV/5/)

查看它在 IE8 中的工作...

# macos - 如何检查窗口是否相交？

> ID：11089946
> 
> 赞同：0
> 
> 时间：2012-06-18T19:46:16.703
> 
> 标签：macos, cocoa, nswindow, appkit

我有一个 open 数组`NSWindow`。我如何检查这些是否相交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:03:13.933

除了详尽的搜索之外，我不确定是否有办法做到这一点。您可以使用 2 个角（参考角，通过检查窗口位置和对角返回，或参考角加上窗口的尺寸），并且对于每个窗口，检查其他窗口的任何角是否位于在当前窗口的角落之间。这种详尽的方法是 O(n^2)，但除非您处理数千个窗口，否则仍然应该很快。

一些伪代码：

```
inside (point, window):
    if  point.x less than window.corner1.x and point.x greater than window.corner2.x
    and point.y less than window.corner1.y and point.y greater than window.corner2.y,
        true.
    false.

check_for_collision (window1, window2):
    if (window1.corner1 inside window2) or (window1.corner2 inside window2), true.
    else if window2.corner1 inside window1 or window2.corner2 inside window1, true.
    otherwise, false.

check_group_of_windows (windowlist):
    loop:
        if size of windowlist is 1 or less, stop looping
        let window be windowlist.pop
        for each otherwindow in windowlist:
            if check_for_collision(window, otherwindow), true.
    false. 
```

我希望这有点道理。

# mysql - MySQL 等价于 MSSQL 地理函数

> ID：11089948
> 
> 赞同：1
> 
> 时间：2012-06-18T19:46:17.287
> 
> 标签：mysql, geospatial

我在这方面找不到任何东西，因此是新线程。我们有一个应用程序，其中数据存储在 SQL Server 中。某些表具有“地理”类型的列。我们使用 SQL-Server 函数 STDistance 过滤掉指定距离内的数据。现在我们正在研究一些关于将应用程序转换为 PHP 的不同原因。最重要的原因之一是 ASP.Net 和 SQL-Server 的成本。现在我似乎找不到任何关于 MySQL 如何处理地理数据类型的信息，我说得对吗？它不存在吗？

不能在 MySQL 中创建自己的函数吗？我想我可以创建一个简单的函数来计算一个位置是否在所需的半径内。这样做最有效的方法是什么？当然，如果坐标在半径内，我可以计算每一行，但这感觉效率低下，不像一个非常可扩展的解决方案。我在想我首先会选择**x1>lat>x2**和**y1>lon>y2**的所有行，然后进行“繁重的计算”。

这样做的最佳方法是什么？

# c# - 重建 SQL Server 全文索引

> ID：11089950
> 
> 赞同：2
> 
> 时间：2012-06-18T19:46:47.333
> 
> 标签：c#, sql-server, full-text-indexing

我有一个客户在他们的应用程序中使用全文索引。他们通过应用程序重建索引。当他们这样做时，从目录中手动删除所有列。然后他们将它们全部添加回来。之后，他们开始一个新的增量人口。

在此过程之后，它们通常以损坏的索引告终。当他们执行应该返回数据的搜索时，什么都没有返回；即使在人口完成之后。所以索引是损坏的。他们可以取回它的唯一方法是在 SQL Server 管理工具中重建索引。

它们在目录中有许多（20-50 或更多）列和表。目录中的次数是否有推荐的限制？他们应该把它分解成更小的目录吗？

他们是否应该通过删除所有列并将它们重新添加来重建索引？或者，还有更好的方法？或者只是发送一个 ALTER REBUILD 命令是更好的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T11:06:10.237

无需删除列，您只需重新创建全文索引即可在此处找到解决方案 [http://msdn.microsoft.com/en-us/library/bb326034(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/bb326034(v=sql.105).aspx)

# objective-c - webview中上一个/下一个按钮的Rubymotion实现

> ID：11089954
> 
> 赞同：1
> 
> 时间：2012-06-18T19:46:59.603
> 
> 标签：objective-c, ruby, rubymotion

我是 iOS 开发的新手，最近开始使用 ruby​​motion。

我目前正在开发一种“起始页”类型的应用程序，该应用程序在 web 视图中加载应用程序中的 html/css/js 文件。然后，“起始页”链接到[http://hiof.no](http://hiof.no)响应式设计版本（即将发布）上的不同部分/页面。

我当前构建的应用程序基于 PaintHTML 示例： [https ://github.com/HipByte/RubyMotionSamples/tree/master/PaintHTML](https://github.com/HipByte/RubyMotionSamples/tree/master/PaintHTML)

我目前坚持的功能是上一页/下一页导航，以在 webview 历史记录中来回导航。

导航功能的想法是将上一个/前进按钮固定在应用程序的左下方，类似于路径应用程序的“新内容”按钮。

任何想法如何使用“本机”rubymotion 代码实现对 webview 历史记录的访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:05:58.947

UIWebView 必须使用**UIWebView#goBack**和**UIWebView#goForward**方法，

创建两个按钮并将操作设置为**@webView.goBack**和**@webView.goForward**；您可以使用 [UIWebView#canGoForward 和 UIWebView#canGoBack] 方法启用按钮

[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)

# php - 搜索结果每页按 10 分组

> ID：11089958
> 
> 赞同：1
> 
> 时间：2012-06-18T19:47:12.603
> 
> 标签：php, search

我一直在寻找一种编写 php 搜索脚本的方法，该脚本将对结果进行分组，例如每页 10 个。

例如页面

```
 ______________________________
|           ________           |
| search:  |________| submit   |
|                              |
|                              |
|  ________________________    |
| |                      <-|---|------------<div id=results></div>
| |________________________|   |                         |
|______________________________|                         |
                                                         v
                                                      div which shows the results grouped  
                                                      by 10 
```

例如：假设我按标签搜索图像，标签“爱”有 20 张图像。我怎样才能在一页上显示前 10 个结果，在另一页上显示最后 10 个结果。（第一页有指向第二页的链接，反之亦然）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T21:19:36.293

一个提示是模运算符对于分页非常方便。它检查除法操作的剩余部分，当使用它进行分页时，它对应于新页面的零。

这是一个快速而肮脏的分页示例：

```
<?php

$arr = array();
for ( $x = 0; $x < 100; $x += 1 ) {
    $arr[] = $x;
};

$page = 7;
$per_page = 7;
$current_page = 1;
for ( $z = 0; $z < count( $arr ); $z += 1 ) {
    if ( 0 === ( $z % $per_page ) ) {
        $current_page += 1;
    }
    if ( $current_page === $page ) {
        echo "value $z on page $page\n";
    }
}

?>

~$ php pagination.php 
value 35 on page 7
value 36 on page 7
value 37 on page 7
value 38 on page 7
value 39 on page 7
value 40 on page 7
value 41 on page 7 
```

# wpf - 按下回车时使用默认按钮，但粘贴值使用多行

> ID：11089962
> 
> 赞同：0
> 
> 时间：2012-06-18T19:47:19.477
> 
> 标签：wpf

在我的 WPF xaml 文件中，如何使我的文本框在我按下返回键时使用默认按钮，但是如果我粘贴超过 1 行的内容，它会将其全部粘贴进去。AcceptsReturn 参数不让我使用默认按钮。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:00:00.267

WPF 没有与 WinForms`DialogResult`属性类似的支持。如果你想在有人按下回车时做某事，那么你应该覆盖`OnKeyUp`事件或`OnPreviewKeyUp`事件。

该类的`AcceptsReturn`属性`TextBox`只是意味着它将允许用户按回车键并在文本框中注册一个 CRLF（否则它会忽略它们）。

# accelerometer - 如何使用陀螺仪仅从加速度计获得线性加速度？

> ID：11089967
> 
> 赞同：4
> 
> 时间：2012-06-18T19:47:36.477
> 
> 标签：accelerometer, gyroscope

我有一辆小型遥控车在房间地板上行驶。为简单起见，让我们假设它沿着 x 轴移动。现在，地板看起来很平，但每个表面都有非常微小的不均匀凸起。因此，只要汽车不完全平坦（如在起始位置），或者换句话说，只要汽车有最轻微的倾斜，从加速度计获得的总加速度 = 线性加速度 + 倾斜引起的加速度

我的问题是如何消除由于倾斜引起的加速度，以便我只获得线性加速度？我可以以某种方式使用陀螺仪来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T21:10:07.293

我已经根据这篇手稿为[Shimmer 平台](http://www.shimmer-research.com/products-2/shimmer-revisions)实现了传感器融合，它基本上是一个教程：

[方向余弦矩阵 IMU：理论](https://drive.google.com/open?id=0B9rLLz1XQKmaZTlQdV81QjNoZTA)

这份手稿几乎回答了你的问题。

这些也有很大帮助：

[惯性导航简介](http://www.cl.cam.ac.uk//techreports/UCAM-CL-TR-696.pdf)

[卡尔曼滤波器简介](http://www.cs.unc.edu/~tracker/media/pdf/SIGGRAPH2001_CoursePack_08.pdf)

[室内环境的行人定位](http://www.cl.cam.ac.uk/research/dtg/www/files/publications/public/abr28/ojw28_thesis.pdf)

[结合陀螺仪和加速度计数据](https://stackoverflow.com/a/1590385/341970)

**只是向我保证你不会尝试对线性加速度进行双重积分，**因为[它不起作用](https://stackoverflow.com/a/7835988/341970)，我怀疑这是[你想要做的。](https://stackoverflow.com/q/11087076/341970)

# ios - NSPredicate 没有响应

> ID：11089968
> 
> 赞同：0
> 
> 时间：2012-06-18T19:47:48.193
> 
> 标签：ios, xcode, core-data, nspredicate, nsfetchedresultscontroller

我正在使用斯坦福大学`UICoreDataTableViewController`对数据库进行提取。

在我的主要观点中，用户在 searchBar 上输入一个浮点数，然后通过点击搜索，谓词使它只获取最大值和最小值之间的值（即 3 到 10 之间的浮点数）。

在主视图中，我构建了一个带有实体的字符串，一个带有必须执行搜索的属性的字符串，最后是一个带有谓词（大于 x 且小于 y）的数组。我将字符串和数组传递给`prepareForSegue`. 它工作得很好。

如果他/她没有输入任何数字，我希望用户能够看到所有的值。所以在`prepareForSegue`我添加了一个根据 NSLog 正确调用的条件。

问题是，在属性上，一些值只是零（我确定了这一点）。如果`prepareForeSegue`我通过以下谓词数组：

```
prepredicateArrayToPass=[NSArray arrayWithObject:[NSPredicate predicateWithFormat:@"%@ !=nil", attributeToPass]]; 
```

提取完成，将 nil 值解释为 0，因此被显示。不好。

但是，如果我复制谓词并将其直接粘贴到它的`setupFetchedResultsController`方法上，`UICoreDataTableViewController`它就可以完美地工作，并且不会显示 nil 值。

如果我直接在 上添加条件`UICoredataTableViewController`，它也不起作用。

我真的不知道如何更进一步。任何帮助将非常感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:13:56.883

因此，我在发布问题后的几分钟内找到了答案。

问题是谓词字符串的简单语法。与其使用 %@ 来指定属性，不如使用 %K。一切都在[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795)中进行了解释。

所以，谓词数组应该是：

```
prepredicateArrayToPass=[NSArray arrayWithObject:[NSPredicate predicateWithFormat:@"%K !=nil", attributeToPass]]; 
```

现在作为一个魅力。

# asp.net - 如何将其转换为 asp.net？

> ID：11089971
> 
> 赞同：2
> 
> 时间：2012-06-18T19:47:53.810
> 
> 标签：asp.net, vb.net

在我的经典 asp 应用程序中，我有一个带有一堆复选框的标记页面。复选框控件 ID 是 bscv。

一旦用户选中一个框并单击提交，就会在名为 next.asp 的下一页处理该值。

根据复选框的值，我显示正确的下拉菜单。

我在 next.asp 上使用以下代码来显示正确的下拉菜单。

```
If bsvc = "master" Then
    ' only master was checked
    ' "If the user checks only master checkbox, ...txtmaster with 2 options... is displayed."

%>
<select id="txtmaster" name="txtmaster">
        <option value="">-Select a service-</option>
        <option value="1">1</option>
        <option value="2">2</option>
     </select>
<%
Elseif InStr(bsvc, "master") > 0 Then
    ' Master was checked, but something else was also checked
    ' display txtmaster with all 7 options dropdowon 1 and 2       

%>
 <select id="txtmaster" name="txtmaster">
        <option value="">-Select a service-</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
     </select>
<%
Elseif Len(bsvc) > 0 Then
    ' something was checked, but not master
    ' " display only dropdown with 3 to 7 ."

%>
<select id="txtmaster" name="txtmaster">
          <option value="">-Select a service-</option>
           <option value="3">3</option>
          <option value="4">4</option>
          <option value="4">5</option>
          <option value="5">5</option>
          <option value="6">6</option>
              <option value="7">7</option>
  </select>

<%
Else
    Response.Write "Error: You did not check any business serviced"
End If
%> 
```

这很好用。

现在，在 asp.net 上，我正在使用多视图并且我正在尝试完成相同的操作。

在 view1 上，我有复选框。当我单击下一步时，我想根据复选框的值显示正确的下拉列表。

我怎样才能完成与上面的代码类似的事情？

提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T20:38:14.440

一种方法与你所拥有的非常相似......

`<asp:checkboxlist>`在您的标记中使用一个。

然后，对于提交按钮的单击事件，您可以根据在复选框列表中找到的选中值将下拉列表的“可见”属性设置为 true 或 false。

或者，您可以声明一些`listitem`对象，只有一个`dropdownlist`，然后`listitem`根据您的`checkboxlist`.

```
For each myItem as listitem in myCheckboxlist
if ctype(myItem, checkox).checked then... 
```

无论如何，沿着那个思路

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T22:54:30.897

我从来没有使用过Multiview，所以如果我完全脱离基地，请原谅我。但看起来视图 1 上的控件应该可以直接使用。由于您使用的是多视图，因此您实际上永远不会离开页面，只是发回并更改活动视图。因此，视图 1（或任何其他视图）上的每个控件仍然可以访问。

如果您不能直接引用复选框，例如复选框是动态的（如数据绑定或其他），您应该能够使用 View1.FindControl 或类似的东西。

我错过了什么吗？

```
'View1 contains three CheckBoxes and ButtonNext.
'View2 contains three DropDownLists and ButtonBack.

Protected Sub ButtonNext_Click(sender As Object, e As EventArgs) Handles ButtonNext.Click
    SetListVisibility()
    MultiView1.SetActiveView(View2)
End Sub

Protected Sub ButtonBack_Click(sender As Object, e As EventArgs) Handles ButtonBack.Click
    MultiView1.SetActiveView(View1)
End Sub

Private Sub SetListVisibility()
    If CheckBox1.Checked Then
        If CheckBox2.Checked Or CheckBox3.Checked Then
            DropDownList1.Visible = False
            DropDownList2.Visible = False
            DropDownList3.Visible = True
        Else
            DropDownList1.Visible = True
            DropDownList2.Visible = False
            DropDownList3.Visible = False
        End If
    Else
        DropDownList1.Visible = False
        DropDownList2.Visible = True
        DropDownList3.Visible = False
    End If
End Sub 
```

# android - 在 Android 中 - 如何按特定百分比填充视图或绘图？

> ID：11089972
> 
> 赞同：2
> 
> 时间：2012-06-18T19:47:55.067
> 
> 标签：android, android-layout, android-ui

如何在 Android 中填充具有特定背景的位图，并且只覆盖其中的一部分，如下所示？

中间也会有一个图标，所以填充必须在绘制的后面。我尝试使用渐变，但效果不佳。

![半圈](../Images/5baecc208e3a4f31bc8604e404a1c2ae.png)

* * *

编辑：另一张图片：

![在此处输入图像描述](../Images/7d4b7f97d2b48c0a0ad1eeb40475b5a0.png)

假设处理 67% 是一个文本视图，绿色是填充该文本视图 67% 的背景，你将如何在 Android 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:46:55.957

您可以尝试使用 Arc，这是参考[Arc Android Developers](http://developer.android.com/reference/android/graphics/Path.html#addArc%28android.graphics.RectF,%20float,%20float%29) ，这里有一个很棒的教程，可能对您有所帮助：[如何在 Android Canvas 上绘制半圆](http://blog.mwrobel.eu/howt-draw-semicircle-android-canvasenhow-draw-semicircle-android-canvas/)。

除此之外，需要更多的代码来帮助你。

# jquery - 向 Facebook 发布操作出现异常

> ID：11089974
> 
> 赞同：0
> 
> 时间：2012-06-18T19:48:04.427
> 
> 标签：jquery, asp.net-mvc-3, facebook-graph-api

当我尝试向 facebook 发布操作时出现异常。

```
Exception :
{"error":{"message":"(#3502) Object at URL localhost/XXX has og:type of 'website'. The property 'myobject' requires an object of og:type 'mynamespace:myobject'. ","type":"OAuthException","code":3502}} 

FB.api(
            '/me/mynamespace:myaction',
            'post',
            { myobject: url,
                access_token: accessToken
            },
            function (response) {
                if (!response || response.error) {
                    Alert(JSON.stringify(response));
                }
            }); 
```

我的网址从后端的模型生成：我的网址：`http://localhost/post/og/`

```
public ActionResult og(int id)
        {
            return View(new OGModel(id));
        } 
```

看法 ：

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"
      xmlns:fb="https://www.facebook.com/2008/fbml">
    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# @Model.NameSpace: http://ogp.me/ns/fb/@Model.NameSpace#">
        <title>@Model.Title</title>
        <meta property="fb:app_id" content="@Model.AppId" /> 
        <meta property="og:type" content="@Model.NameSpace:myobject" /> 
        <meta property="og:url" content="@Model.SharingLink">
        <meta property="og:title" content="@Model.Title" /> 
        <meta property="og:image" content="@Model.Image" /> 
    </head>
    <body>
        <div>

        </div>
    </body>
</html> 
```

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T20:12:03.433

您不能在 localhost 上发布对象 URL 的 OG 操作，因为 Facebook 的爬虫将无法访问它们并读取元标记。所有对象的 URL 都需要可从 Internet 访问；特别是通过 Facebook 的爬虫。

[您可以使用Facebook 的调试工具](https://developers.facebook.com/tools/debug)检查 Facebook 在您的 URL 上检测到的内容（如果有的话）

# bash - bash `find` 转义

> ID：11089980
> 
> 赞同：0
> 
> 时间：2012-06-18T19:48:38.473
> 
> 标签：bash, escaping, find

我需要递归地在一个目录中找到所有 TIFF，但忽略一些也恰好以“ `.tif`”结尾的工件（基本上所有隐藏文件）。这个命令：

```
find . -type f -name '*.tif' ! -name '.*' 
```

在命令行上完全按照我想要的方式工作，但是在 bash 脚本中它找不到任何东西。我已经尝试用`!`and--`-and -not`我认为--几乎所有我能想到和/或由googleshpere推荐的转义排列替换，例如 `.\*`，省略单引号等。显然我遗漏了一些东西，感谢任何帮助.

编辑：这是脚本的重要部分；它正在查找的目录是参数化的，但我一直在用硬编码进行调试；没有什么不同的：

```
#!/bin/bash
RECURSIVE=1
DIR=$1

#get the absolute path to $DIR
DIR=$(cd $DIR; pwd)

FIND_CMD="find $DIR -type f -name '*.tif' ! -name '.*'"
if [ $RECURSIVE == 1 ]; then
    FIND_CMD="$FIND_CMD -maxdepth 1"
fi

for in_img in $($FIND_CMD | sort); do
    echo $in_img # for debugging
    #stuff
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T22:36:33.253

它与将表达式存储在变量中有关。解决方案是使用`eval`，这当然是正确的做法。除了 for 循环的开头之外，一切都与上面相同：

```
for in_img in $(eval $FIND_CMD | sort); do
    #stuff
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T21:43:40.107

要找不到隐藏文件，您可以使用以下命令：

```
 find . \( ! -regex '.*/\..*' \) -type f -name "*.tif" 
```

它检查文件名并且不显示（括号中的！）以点开头的文件，这些文件是隐藏文件。

# c++ - SFML 2.0 - 绘制星空

> ID：11089982
> 
> 赞同：1
> 
> 时间：2012-06-18T19:48:42.257
> 
> 标签：c++, performance, optimization, sfml

我正在使用 sfml 2.0 制作游戏。背景将是一个星空。与其使用图像，我认为每次游戏启动时随机生成一个星空可能会很整洁，因此每次背景看起来都*略有不同。*问题是，我目前的做法会大大降低我的游戏速度。有谁知道是什么原因导致速度下降？我浏览了文档以查看内容，但我没有找到任何东西...

这是我的代码：

```
#include <SFML/Graphics.hpp>
#include "sfml helper/initialization_helpers.h"
#include "sfml helper/cursor_functions.h"
#include "sfml helper/global_event_handler.h"
#include "sfml helper/globals.h"
#include <cstdio>

int main(int argc, char* argv[])
{
    try {
        // some non-related preparations...
        PrepareApplication(argv[0]);
        float width = 640, height = 480;
        sf::RenderWindow window(sf::VideoMode(width, height), "SFML Test", sf::Style::Close);
        window.setFramerateLimit(60);

        // Textures is a global object that has an internal std::map<string, sf::Texture>
        Textures.add("ball.png", "ball");
        sf::Sprite sprite;
        sprite.setTexture(Textures.get("ball"));

        // This is the snippet that generates the starfield
        srand(time(NULL));
        sf::Image starsImg;
        starsImg.create(width, height, sf::Color::Black);
        int numStars = rand() % 20 + 490;
        for (int i = 0; i < numStars; i++) {
            int x = rand() % (int)width;
            int y = rand() % (int)height;
            sf::Color color(255, 255, 255, rand() % 75 + 25);
            starsImg.setPixel(x, y, color);
        }
        sf::Texture starsTexture;
        starsTexture.loadFromImage(starsImg);
        sf::Sprite stars;
        stars.setTexture(starsTexture);

        // main loop
        while (window.isOpen()) {
            if (Flags.isActive && Flags.inFocus) {
                confineCursorToWindow(window);
            } else {
                freeCursor();
            }
            sf::Event event;
            while (window.pollEvent(event)) {
                if (event.type == sf::Event::KeyPressed) {
                    if (event.key.code == sf::Keyboard::Escape) {
                        Flags.isActive = (!Flags.isActive);
                    }
                }
                if (event.type == sf::Event::MouseMoved) {
                    sprite.setPosition(event.mouseMove.x, event.mouseMove.y);
               }
                // handles default events like sf::Event::WindowClosed
                handleDefaultEventsForWindow(event, window);
            }
            window.clear();
            window.draw(stars); // here's where I draw the stars
            window.draw(sprite);
            window.display();
        }
    } catch (const char* error) {
        printf("%s\n", error);
        exit(1);
    }

    return 0;
} 
```

**编辑**

我尝试加载星空的图像并尝试绘制它，游戏仍然运行缓慢！

另外，慢，我的意思是被称为“精灵”的精灵在跟随鼠标时会滞后。这*真的*是速度问题吗？

# c++ - 如果 new 失败，是否需要检查指针的有效性？

> ID：11089986
> 
> 赞同：1
> 
> 时间：2012-06-18T19:48:59.860
> 
> 标签：c++, pointers

正如标题所说，我知道 new 抛出一个可以被捕获的异常，但是指针到底发生了什么？它变成NULL？我检查了一些关于 SO 的答案，但没有人解释它。检查下面的示例，指针保持在堆上？请提供有关此模式的完整信息

```
#include <windows.h>
#include <cstdlib>
#include <iostream>

using namespace std;

enum eReadMode
{
 //    READ_ONLY,
     READ_WRITE,
    // CREATE_FILE,
   //  CREATE_WRITE_FILE,
};

class CFileStatic
{
private:
    FILE *m_File;
public:
    CFileStatic( LPCTSTR szFileName, eReadMode eMode );
    virtual ~CFileStatic() {};

    bool IsValidFile() const { return( m_File != NULL ); };
    void PrintFile( unsigned int uLine = 0 );
};

CFileStatic::CFileStatic( LPCTSTR szFileName, eReadMode eMode )
{
    if( szFileName )
    {
        if( eMode == READ_WRITE )
            m_File = fopen( szFileName, "r+" );
        else
            printf( "Valid usage of: READ_WRITE only" );
    }
    else
        m_File = NULL;
}     

void CFileStatic::PrintFile( unsigned int uLine )
{
    static unsigned uFindNumber;
    if( uLine == 0 )
    {
        char szBuffer[1024];
        while( fgets( szBuffer, 1024, m_File ) )
        {
               std::cout << szBuffer;
        }
    }
    else
    {
        char szBuffer[1024];
        while( fgets( szBuffer, 1024, m_File ) )
        {
               uFindNumber++;
               if( uFindNumber == uLine )
               {
                   std::cout << szBuffer;
               }
        }
    }

}     

int main( int argc, char *argv[] )
{
    //if new fails, what 'pFile' turns out to be? and do I need to delete
    //it later?
    CFileStatic *pFile = new CFileStatic( "Console.h", READ_WRITE );
    if( pFile->IsValidFile() )
    {
        pFile->PrintFile(2);
    }

    CFileStatic *pConsoleCpp = new CFileStatic( "Console.cpp", READ_WRITE );
    if( pConsoleCpp->IsValidFile() )
    {
        pConsoleCpp->PrintFile();
    }

    system("pause>nul");
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T19:52:07.183

假设您使用的是默认全局`new`运算符，并且没有使用以下`nothrow`版本`new`：

```
int main( int argc, char *argv[] )
{
  //if new fails, what 'pFile' turns out to be? and do I need to delete
  //it later?
  CFileStatic *pFile = new CFileStatic( "Console.h", READ_WRITE );
  /* ... */
} 
```

没有“以后”。在这段代码中，如果`new`失败，它会抛出一个`std::bad_alloc`异常，你的程序会立即终止。

现在，如果您要尝试处理这种情况，则需要捕获该异常。或许是这样的：

```
int main( int argc, char *argv[] )
{
  //if new fails, what 'pFile' turns out to be? and do I need to delete
  //it later?
  try
  {
    CFileStatic *pFile = new CFileStatic( "Console.h", READ_WRITE );
  }
  catch( const std::bad_alloc& ex )
  {
    cout << "whoops! out of memory." << ex.what() <<  endl;
  }
  /* ... */
} 
```

`pFile`存在于块所包围的范围内`try`，因此不再存在。移出一层：

```
 CFileStatic * pFile = 0;
  try
  {
    pFile = new CFileStatic( "Console.h", READ_WRITE );
  }
  catch( const std::bad_alloc& ex )
  {
    cout << "whoops! out of memory." << ex.what() <<  endl;
  }

  // pFile is still 0 
```

`pFile`永远不会被修改，所以值是不变的。

* * *

关于`delete`指针的问题。标准说（C++03 5.3.5/2）：

> [...] 如果 delete 的操作数的值是空指针，则操作无效。

您不必删除 NULL 指针，因为没有 to `delete`，但这样做不会有任何效果。你可以安全地这样做：

```
CFileStatic * pFile = 0;
try
{
  pFile = new CFileStatic( "Console.h", READ_WRITE );
}
catch( const std::bad_alloc& ex )
{
  cout << "whoops! out of memory." << ex.what() <<  endl;
}

delete pFile;  // regardless of the success of new, this is OK 
```

请注意，在执行此操作时，初始化`pFile`为空指针尤为重要，正如我在此处所做的那样。如果您不这样做：

```
CFileStatic* pFile; // NO INIT
/* ... */
delete pFile; // if new threw, this is undefined behavior 
```

`pFile`仍然是一个垃圾指针。它不是空指针，所以`delete`会尝试删除它，导致未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-18T19:53:47.270

当函数抛出异常时，该函数没有完成并且不返回任何内容，同时控制流跳转到异常处理程序，即使函数返回，也不会执行对接收指针的赋值。

的抛出版本也是`new`如此，如果它抛出，那么指针将保持它在表达式之前的相同值，它可能是 NULL 或任何其他值。

另一方面，如果您使用`new (std::nothrow) X;`then 调用`new`将不会抛出，并且失败将由返回的 NULL 值指示（并假设分配给指针）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T19:53:12.363

如果抛出异常，则不会为指针分配新值。如果您的指针位于`try`您进行分配的块内，或者不在任何`try`块内，则异常将导致范围更改，从而您无法再访问指针。因此，无需测试指针。

另一方面，如果指针以在分配失败后仍然存在的方式声明，那么您需要检查该值。例如：

```
T* ptr = NULL;
try {
    ptr = new T();
} catch (std::bad_alloc& ) {
    /* ... handle error */
}
// Have to test ptr here, since it could still be NULL. 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T19:51:27.163

如果`new`失败，则抛出`std::bad_alloc`异常，除非您使用该`nothrow`版本。这意味着存储返回指针的变量的值将保持不变。

如果您捕获异常，则值`pFile`保持未初始化，否则您的应用程序将终止（如`main`已退出）

# php - 如何使用 PHP 提交网页？

> ID：11089987
> 
> 赞同：0
> 
> 时间：2012-06-18T19:49:07.840
> 
> 标签：php, forms, email

我创建了一个三步订单表格，我需要第三步的帮助。1\. 表格由商家填写并点击“预览订单” 2\. 商家查看他们的订单并点击“确认”（应该在“bizform.php”但我没有尝试过，因为我不知道如何去做。） 3\. 点击“确认”，将“网页”或“bizform.php”中的数据发送给企业和我自己。

问题：有可能吗？如果是这样，你能指出我正确的方向吗？TYVM

我的表格：

```
 <div class="span4 diff">
    <h3>Business Information</h3>
    <br/>
    <form action="bizform.php" method="post">
    <label for="bizName" class="control-label">
    Business:</label>
    <input type="text" id="bizName" name="bizName" class="input-large">

    <label for="bizAddress" class="control-label">
    Business Address:</label>
    <input type="text" id="bizAddress" name="bizAddress" class="input-large">

    <label for="bizCity" class="control-label">
    City:</label>
    <input type="text" id="bizCity" name="bizCity" class="input-large">

    <label for="bizState" class="control-label">
    State:</label>
    <input type="text" id="bizState" name="bizState" class="input-large">

    <label for="bizZip" class="control-label">
    Zip code:</label>
    <input type="text" id="bizZip" name="bizZip" class="input-large">

    <label for="fullName" class="control-label">
    Full Name:</label>
    <input type="text" id="fullName" name="fullName" class="input-large">

    <label for="bizEmail" class="control-label">
    E-mail:</label>
    <input type="text" id="bizEmail" name="bizEmail" class="input-large">
    </div>
    <div class="span7">
    <h3>Choose Products</h3>
    <br/>
    <table class="table table-bordered table-striped">
    <thead>
    <tr class="diffhead">
    <th>Product</th>
    <th>Price</th>
    <th>Training</th>
    <th>Total</th>
    <th>Qty</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>Product One</td>
    <td>$1000.00</td>
    <td>$100.00</td>
    <td>$1100.00</td>
    <td>
    <label class="input" for="productOne"></label>
    <input type="text" class="input-mini" value="0" id="productOne" name="productOne">
    </td>
    </tr>
    <tr>
    <td>Product Two</td>
    <td>$1000.00</td>
    <td>$100.00</td>
    <td>$1100.00</td>
    <td>
    <label class="input" for="productTwo"></label>
    <input type="text" class="input-mini" value="0" id="productTwo" name="productTwo">
    </td>
    </tr>
    <tr>
    <td>Product Three</td>
    <td>$1000.00</td>
    <td>$100.00</td>
    <td>$1100.00</td>
    <td>
    <label class="input" for="productThree"></label>
    <input type="text" class="input-mini" value="0" id="productThree" name="productThree">
    </td>
    </tr>
    </tbody>
    </table>
    </div>
    </div>
    <div class="form-actions">
    <button class="btn btn-danger" type="reset" style="float:left">
    <i class="icon-remove-sign icon-white"></i> Cancel Order</button>
    <button class="btn btn-primary" type="submit" style="float:right">Preview Order 
    <i class="icon-circle-arrow-right icon-white"></i></button>
    </form>
    <?php
    include '_inc/footer.html';
    ?> 
```

我的表单处理器：

```
 <?php
    include '_inc/header.html';
    ?>
    <?php 

    $bizName = $_POST['bizName'];
    $bizAddress = $_POST['bizAddress'];
    $bizCity = $_POST['bizCity'];
    $bizState = $_POST['bizState'];
    $bizZip = $_POST['bizZip'];
    $fullName = $_POST['fullName'];
    $bizEmail = $_POST['bizEmail'];

    $productOne = $_POST['productOne'];
    $productTwo = $_POST['productTwo'];
    $productThree = $_POST['productThree'];

    $moneyOff = '';

    $totalPro = $productOne + $productTwo + $productThree;

    define('PRODPRICE', 1100);

    $totalMoney = $productOne * PRODPRICE
    + $productTwo * PRODPRICE
    + $productThree * PRODPRICE;

    if ( $totalMoney == 2200 )
    {
    echo '<div class="alert alert-success">Go Back! You can get a product for free!</div>';
    }

    if ( $totalMoney == 3300 )
    {
    $moneyOff = 1100;
    }
    else
    {
    $moneyOff = 0;
    }

    define('STOCKFEE', 10);
    $stockFee = $productOne * STOCKFEE
    + $productTwo * STOCKFEE
    + $productThree * STOCKFEE;

    ?>
    <h1 align="center">Order Agreement</h1>
    <br/>
    <?php 
    echo '<strong>' .$bizName. '</strong> is purchasing the following products and services from CBE:</p>';
    echo '<div class="well">
    <table cellspacing="0" cellpadding="0" width="800px">
    <thead>
    <th>Qty</th>
    <th>Product</th>
    <th>Price</th>
    </thead>
    <tbody>
    <tr>
    <td align="center">'. $productOne .'</td>
    <td align="center">Product One</td>
    <td align="center">$1,100.00</td>
    </tr>
    <tr>
    <td align="center">'. $productTwo .'</td>
    <td align="center">Product Two</td>
    <td align="center">$1,100.00</td>
    </tr>
    <tr>
    <td align="center">'. $productThree .'</td>
    <td align="center">Product Three</td>
    <td align="center">$1,100.00</td>
    </tr>
    <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
    <tr>
    <td>&nbsp;</td>
    <td align="right">Sub Total:</td>
    <td align="center">'.number_format($totalMoney,2).'</td>
    </tr>
    <tr>
    <td>&nbsp;</td>
    <td align="right">Discount:</td>
    <td align="center">'.number_format($moneyOff,2).'</td>
    </tr>
    <tr>
    <td>&nbsp;</td>
    <td align="right">Grand Total:</td>
    <td align="center">'.number_format($totalMoney - $moneyOff,2).'</td>
    </tr>
    </tbody>
    </table>
    </div>';
    echo '<p>Business agrees to pay <strong> '.number_format($totalMoney - $moneyOff,2).' </strong>for these products and services. In addition, Business will pay an additional <strong> '.number_format($stockFee,2).' </strong>to cover stock fee.</p>';
    ?>
    <div class="row">&nbsp;</div>
    <div class="row">
    <div align="left">
    <table cellspacing="10" cellpadding="10" width="850px">
    <tbody>
    <tr><td>&nbsp;</td></tr>
    <tr>
    <td valign="top">
    <?php 
    echo '<strong>' .$bizName. '</strong> <br/>';
    echo $bizAddress.'<br/>';
    echo $bizCity.', ';
    echo $bizState.' ';
    echo $bizZip.'';
    ?>
    </td>
    <td valign="top">
    <strong>CBE</strong><br/>
    Corporate Headquarters<br/>
    555 Main Street<br/>
    PHPLAND, DB 78987-3849<br/>
    888-098-3049
    </td>
    </tr>
    </tbody>
    </table>
    </div>
    </div>
    <?php
    include '_inc/footer.html';
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:54:25.277

当您将表单提交到 bizform.php 时，将您发布的变量存储在隐藏的输入字段中，然后在第 3 步将这些变量提交给您的表单处理器。

编辑：

换句话说，让您的确认流程将您的隐藏字段发布到另一个处理器，该处理器从 POST 创建您的电子邮件内容，然后发送给企业，并将您自己作为 CC 或 BCC 标头。

```
<input name="AID" type="hidden" id="AID" value="<?php echo $_POST['AID']; ?>" size="32" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:55:49.003

由于您可以通过 $_POST 数组轻松访问数据，因此要将所有这些信息发送给相应的收件人，请使用`mail()`php 的功能来创建电子邮件并将其发送给您想要的任何人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:58:33.313

要跨多个表单存储数据：

```
<?php
  session_start(); // Initiates the session, and loads the _SESSION variable

  var_dump($_SESSION); // Show the data in the _SESSION variable

  // Load data into the sessions
  $_SESSION['a'] = 1;
  $_SESSION['b'] = 'hello world';

  if (!isset($_SESSION['c'])) $_SESSION['c'] = 0;
  else $_SESSION['c'] += 2; 
```

首先，您应该看到一个空数组。然后，刷新，您将看到您的会话数据。

[http://php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php) - 供参考和进修...

# ruby-on-rails - 将 ActiveAdmin 应用程序推送到 Heroku 后，数据库为空

> ID：11089989
> 
> 赞同：0
> 
> 时间：2012-06-18T19:49:10.727
> 
> 标签：ruby-on-rails, database, heroku, activeadmin

我的本地服务器上有一个有效的 Active Admin 应用程序，但是在推送到 Heroku 之后，我的所有数据库表都是空的。我试着跑步`heroku run rake db:migrate`，`heroku restart`但这些都没有完成。桌子在那里，但它们是空的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:54:29.130

如果您想让 Heroku 应用程序具有与本地相同的数据库，那么您需要将本地数据库通过推`heroku db:push`送到 Heroku。这将用您的本地副本替换 Heroku 上表格的内容，因此请谨慎使用。

编辑：`heroku db:push`现在`heroku pg:push`是，不推荐使用前者。

# r - 在 R 中更改 Tor 身份

> ID：11089993
> 
> 赞同：20
> 
> 时间：2012-06-18T19:49:22.723
> 
> 标签：r, ip, tor, rcurl

我将 Tor 与 R 结合使用，并希望为每个新请求更改我的 IP。我的代码如下：

```
library(RCurl)
opts <- list(proxy="127.0.0.1", proxyport=8118)
for (i in 1:10)
  {
  con <- socketConnection(host="127.0.0.1",port=9051)  # DOES NOT WORK
  writeLines("signal newnym", con=con)                 # DOES NOT WORK
  ip <- getURL("http://ifconfig.me/ip", .opts = opts)  
  print(ip)
  Sys.sleep(1)
  } 
```

我可以通过 Tor 进行连接，但是标记为“不工作”的两条线似乎无法将正确的信号传递到 Tor，因此 IP 保持不变。

问候！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T18:56:59.667

[我遇到了类似的问题，但是在将 Privoxy 安装为 http-proxy 并按照此处](http://www.privoxy.org/faq/misc.html#TOR)的说明进行设置后，设法使其工作。然后，这是我在 R 中使用的代码：

```
library(RCurl)
# check current IP address
print(getURL("http://ifconfig.me/ip"))
# proxy options
opts <- list(proxy="127.0.0.1", proxyport=8118)
# opening connection with TOR
con <- socketConnection(host="127.0.0.1",port=9051)
print(getURL("http://ifconfig.me/ip", .opts = opts))  

for (i in 1:10)
    {
    writeLines('AUTHENTICATE \"password\"\r\nSIGNAL NEWNYM\r\n', con=con)
    Sys.sleep(5)
    print(getURL("http://ifconfig.me/ip", .opts = opts)) 
    Sys.sleep(5)
    } 
```

确保您使用手动设置 TCP 连接，地址为 127.0.0.1:9051，身份验证方法为“密码”，将上面代码中双引号之间的密码替换为您设置的密码。

# php - Magento：在非对象上调用成员函数 insert() (1.5.1)

> ID：11089994
> 
> 赞同：1
> 
> 时间：2012-06-18T19:49:24.970
> 
> 标签：php, mysql, magento, magento-1.5

我正在尝试访问我的 Magento Store 之一（版本 1.5.1），当我尝试访问它时出现以下错误：致命错误：调用 /home4/ 中非对象上的成员函数 insert() wisestor/public_html/app/code/core/Mage/Core/Model/Resource/Resource.php 在第 133 行。

```
Line 133 of Resource.php is:            
 return $this->_getWriteAdapter()->insert($this->getMainTable(), $dbModuleInfo); 
```

# php - 使用 implode 函数读取复选框值

> ID：11089996
> 
> 赞同：0
> 
> 时间：2012-06-18T19:49:35.797
> 
> 标签：php, mysql

我已经插入了这个带有多个复选框项目的表单，这些复选框项目收集了一些值，我需要做的是将此值作为用逗号分隔的字符串回显，但是我在 implode 函数中遇到错误，它说传递了无效的参数。

你能看看代码吗？

```
if(isset($_POST['Submit'])) {
    echo "<pre>"; print_r($_POST);
    $checked = mysql_real_escape_string(implode(',', $_POST['checkbox'])); 
    echo $checked;
}
?> 
```

HTML 表单

```
<form action="checkbox.php" method="post">
<input type="checkbox" name="checkbox[]" value="hostess_name">
<input type="checkbox" name="checkbox[]" value="hostess_familyname_en">
<input type="checkbox" name="checkbox[]" value="hostess_id">
<input type="checkbox" name="checkbox[]" value="hostess_firstname_en">
<br>
<br>
<input type="submit" name="Submit" value="Submit">
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T19:58:41.767

尝试这个

```
if(isset($_POST['Submit'])) {
    echo "<pre>"; print_r($_POST);
    $checked = implode(',', $_POST['checkbox']); 
    echo $checked;
} 
```

这是我放入的确切内容`test.php`

```
<?php
if(isset($_POST['Submit'])) {
    echo "<pre>";
    $checked = implode(',', $_POST['checkbox']);
    echo $checked;
}

?>
<form action="test.php" method="post">
<input type="checkbox" name="checkbox[]" value="hostess_name">
<input type="checkbox" name="checkbox[]" value="hostess_familyname_en">
<input type="checkbox" name="checkbox[]" value="hostess_id">
<input type="checkbox" name="checkbox[]" value="hostess_firstname_en">
<br>
<br>
<input type="submit" name="Submit" value="Submit">
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T20:17:17.943

Adnan 的代码也适用于我。对于 OP，您能否发布`print_r`声明的结果，以便我们验证是否为复选框发布了某些内容？您的`isset`代码检查表单是否已提交，但我想确保复选框也提交了某些内容。

但是，基于我注意到的几件事，我对 OP 的问题还有其他一些评论。A）您使用`echo "<pre>"`但您从不使用 echo 结束标记`echo "</pre>"`。也许您只是关闭了此代码，但是如果您关闭结束标记，则可能会使您的输出出现乱码。

B) 请不要`mysql_*`对新代码使用函数。它们不再被维护，社区已经开始[弃用过程](http://news.php.net/php.internals/53799)（见[红框](http://uk.php.net/manual/en/function.mysql-connect.php)）。相反，您应该了解[准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。如果你不能决定哪个，[这篇文章](http://php.net/manual/en/mysqlinfo.api.choosing.php)会帮助你。如果您想学习，[这是一个很好的 PDO 教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

您会发现使用准备好的语句不仅使您的代码更安全，而且在代码中实现起来也更加简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T20:01:35.430

使用 foreach 循环执行。

例如：

```
$result = $_POST['checkbox'];
foreach($result as $i)
{
//your code goes here
} 
```

# xcode - “未找到有效的签名身份”错误

> ID：11089998
> 
> 赞同：1
> 
> 时间：2012-06-18T19:49:42.467
> 
> 标签：xcode, identity, signing, provisioning-profile

每次我尝试构建我的归档应用程序时，我都会收到此错误“未找到包含任何钥匙串签名证书的未过期配置文件”所以我进入 Organizer-Devices 并选择配置文件并注意到有一个警告简介

如果我有足够的积分，我会添加一张照片......

我整天都在处理这个错误，但我没有进一步

如果您知道如何解决此问题，请回复

谢谢