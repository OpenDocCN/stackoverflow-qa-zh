# StackOverflow 问答 10290000-10290999

# ruby-on-rails-3 - 我应该承诺测试仍然通过（失败）吗？

> ID：10290000
> 
> 赞同：0
> 
> 时间：2012-04-24T00:02:27.123
> 
> 标签：ruby-on-rails-3, continuous-integration

我们的 Rails 开发团队尝试遵循持续集成。我们决定采用仅提交测试通过的功能的政策。这是继续下去的好方法吗？我是否应该延迟与其他功能的集成，直到我的测试通过（即使该功能的部分功能正常）？提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T00:07:09.730

测试应该通过——如果你正在运行一个 CI 服务器，它只会向人们发送垃圾邮件，直到他们通过。如果没有 CI 服务器，*其他人*将不得不弄清楚这些测试是否“应该”失败。嘘。

另一种选择是只检查实际编写的功能的测试；如果您将测试用作可执行规范，则在整个应用程序完成之前它们不会全部通过，并且没有人能够检查任何内容。

您可能还可以将测试标记为“待处理”或指示它们应该被跳过，但记住*取消*- 挂起/跳过它们通常是有问题的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:24:33.777

测试应该通过这就是您首先编写它们的原因，如果由于某种原因一个或多个测试未通过，则表明出现问题（显然）并且您和您的团队应该致力于解决方案。

如果代码在测试失败的情况下提交，垃圾邮件会指责程序员这样做，这样下次他在提交代码之前会更加注意

我听说过一种避免提交测试失败代码的方法，但我没有亲自测试过，它涉及拥有两个存储库（它可能是一个分支），背后的理论是：

1.  开发人员提交将针对一个分支，该分支的目的只是为了保证所有测试通过，您应该配置您的 CI 服务器以从该分支构建和运行测试

2.  当所有测试在分支中通过时，应该对主干进行合并，因为每个人都应该在这个分支上工作，合并应该是透明和自动的

我再说一遍，我没有测试过这种方法，我认为它涉及的问题多于解决的问题

另一种选择是在 VCS 中的提交事件中添加一个钩子并强制运行所有测试，但这可能仅执行一次提交就很耗时

作为附加信息，您可以查看此回复

[https://stackoverflow.com/a/7110774/1268570](https://stackoverflow.com/a/7110774/1268570)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:05:06.170

在集成其他功能之前，我会亲自等待测试通过。

# java - 为 Android 应用程序创建视觉设计

> ID：10290002
> 
> 赞同：-1
> 
> 时间：2012-04-24T00:02:59.120
> 
> 标签：java, android

我一直在使用 Android 开发，但让我感到困惑的一件事是你如何做自定义界面？我不确定要查找哪些术语或如何完成。我也没有找到任何工作示例。

我应该寻找哪些术语来了解如何做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-24T00:11:12.083

[http://www.androidhive.info/2011/12/android-dashboard-design-tutorial/](http://www.androidhive.info/2011/12/android-dashboard-design-tutorial/)

看看那个网站应该让你开始，有基础知识

# android - GetAndroid 联系信息（电话、姓名等...）

> ID：10290010
> 
> 赞同：0
> 
> 时间：2012-04-24T00:04:38.527
> 
> 标签：android

我知道你可能会认为这个主题已经被处理了好几次，但这次是不同的！

我的应用程序应该从选定的联系人那里获取联系信息（姓名、号码），但我只得到姓名而无法得到号码。

```
@Override
public void onClick(View v) {
   // Opening Contacts Window as a Window
   Intent contactPickerIntent = new Intent(Intent.ACTION_PICK, 
                                     ContactsContract.Contacts.CONTENT_URI);  
       // calling OnActivityResult with intent And Some contact for Identifie
   startActivityForResult(contactPickerIntent, PICK);  
}

@Override
public void onActivityResult(int reqCode, int resultCode, Intent data) {
  super.onActivityResult(reqCode, resultCode, data);
  switch (reqCode) {
    case (PICK) :
      if (resultCode == Activity.RESULT_OK) {
         Uri contactData = data.getData(); 
         Cursor c =  managedQuery(contactData, null, null, null, null);
         if (c.moveToFirst()) {

            int indexName = c.getColumnIndex(
                        ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
            int indexNumber = c.getColumnIndex(
                        ContactsContract.CommonDataKinds.Phone.NUMBER);
            nom   = c.getString(indexName);
            numero = c.getString(indexNumber);

           //Visual confirm
           Toast.makeText(this, "Contact " + nom +" enregistré!",
                          Toast.LENGTH_LONG).show();

           //Save in prefs:
           SharedPreferences manager = 
                         PreferenceManager.getDefaultSharedPreferences(this);
           Editor editor = manager.edit();
           editor.putString("num", numero);             
           editor.putString("nom", nom);
           editor.commit(); 
```

名称是正确的，但数字会导致强制关闭。

但是如果我用下面的替换它不再强制关闭，但数字仍然不正确（0或1）。

```
int indexNumber = c.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)+1; 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:14:16.457

```
private void getDetails(){
        Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
        ContentResolver cr = getContentResolver();
        Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, null);
        String[] projection    = new String[] {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
                        ContactsContract.CommonDataKinds.Phone.NUMBER };
        Cursor names = getContentResolver().query(uri, projection, null, null, null);

        int indexName = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
        int indexNumber = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);
        names.moveToFirst();
        do {

            String name   = names.getString(indexName);
            Log.e("Name new:", name);
            String number = names.getString(indexNumber);
            Log.e("Number new:","::"+number);

        } while (names.moveToNext());
    } 
```

以上从您的联系人数据库中重新运行所有姓名和号码。

如果您甚至需要电子邮件 ID，您还可以添加这些行:::

```
while (cur.moveToNext()) {
            String id = cur.getString(cur.getColumnIndex(ContactsContract.Contacts._ID));
            Cursor email = cr.query( 
                    ContactsContract.CommonDataKinds.Email.CONTENT_URI, null,
                    ContactsContract.CommonDataKinds.Email.CONTACT_ID + " = ?", 
                            new String[]{id}, null); 
            while (email.moveToNext()) { 
                //to get the contact names
                // if the email addresses were stored in an array
                String emailid = email.getString(email.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
                Log.e("Email id ::", emailid);
                String emailType = email.getString(email.getColumnIndex(ContactsContract.CommonDataKinds.Email.TYPE)); 
                Log.e("Email Type ::", emailType);

            } 
            email.close();
        } 
```

# javascript - 如果 ID 以前缀开头，则 JQuery 替换 html 元素内容

> ID：10290019
> 
> 赞同：1
> 
> 时间：2012-04-24T00:05:32.687
> 
> 标签：javascript, jquery, html, replace, innerhtml

我正在寻找移动或复制 HTML 元素的内容。之前有人问过这个问题，我可以让 innerHTML() 或 Jquery 的 html() 方法工作，但我正在尝试自动化它。

如果元素的 ID 以 'rep_' 开头，则在下划线之后替换元素的内容。

所以，

```
<div id="rep_target">
Hello World.
</div> 
```

将替换：

```
<div id="target">
Hrm it doesn't seem to work..
</div>​ 
```

我试过了：

```
$(document).ready(function() {
    $('[id^="rep_"]').html(function() {
        $(this).replaceAll($(this).replace('rep_', ''));
    });
});​ 
```

-和-

```
$(document).ready(function() {
    $('[id^="rep_"]').each(function() {
        $(this).replace('rep_', '').html($(this));
    });
​});​ 
```

两者似乎都不起作用，但是，这确实有效，只有手动：

```
var target = document.getElementById('rep_target').innerHTML;
document.getElementById('target').innerHTML = target; 
```

相关，但这只是文字。 [JQuery替换id中包含字符串的元素的所有文本](https://stackoverflow.com/questions/4239444/jquery-replace-all-text-for-element-containing-string-in-id)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:09:40.063

第一部分有两个基本选项：替换为 HTML 字符串，或替换为实际元素。

选项 #1：HTML

```
$('#target').html($('#rep_target').html()); 
```

选项#2：元素

```
$('#target').empty().append($('#rep_target').children()); 
```

如果您没有偏好，则后一种选择更好，因为浏览器不必重新构建所有 DOM 位（每当浏览器将 HTML 转换为元素时，它需要工作并因此影响性能；选项 #2 避免了这种情况通过不让浏览器创建任何新元素来工作）。

那应该包括更换内部。您还想更改元素的 ID，并且只有一种方法（我知道）

```
var $this = $(this)
$this.attr($this.attr('id').replace('rep_', '')); 
```

所以，把它们放在一起，就像：

```
$('[id^="rep_"]').each(function() {
    var $this = $(this)
    // Get the ID without the "rep_" part
    var nonRepId = $this.attr('id').replace('rep_', '');
    // Clear the nonRep element, then add all of the rep element's children to it
    $('#' + nonRepId).empty().append($this.children());

    // Alternatively you could also do:
    // $('#' + nonRepId).html($this.html());

    // Change the ID
    $this.attr(nonRepId);

    // If you're done with with the repId element, you may want to delete it:
    // $this.remove();
}); 
```

应该做的伎俩。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:19:43.043

使用方法获取 id `attr`，移除前缀，从中创建选择器，从元素中获取 HTML 代码，并从函数中返回：

```
$('[id^="rep_"]').html(function() {
  var id = $(this).attr('id');
  id = id.replace('rep_', '');
  var selector = '#' + id;
  return $(selector).html();
}); 
```

或者简单地说：

```
$('[id^="rep_"]').html(function() {
  return $('#' + $(this).attr('id').replace('rep_', '')).html();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:20:44.587

根据我的问题，我的理解是您想通过删除 re-_ 前缀来替换 id，然后更改该 div 的内容。这个脚本会做到这一点。

```
$(document).ready(function() {
    var items= $('[id^="rep_"]');
    $.each(items,function(){
       var item=$(this);
       var currentid=item.attr("id");
       var newId= currentid.substring(4,currentid.length);
        item.attr("id",newId).html("This does not work");        
        alert("newid : "+newId);
    });    

}); 
```

工作示例：http: [//jsfiddle.net/eh3RL/13/](http://jsfiddle.net/eh3RL/13/)

# java - 建立一个测试类？

> ID：10290029
> 
> 赞同：0
> 
> 时间：2012-04-24T00:06:25.150
> 
> 标签：java, testing

我是一个非常新的 java 用户，我在测试我的程序时总是遇到麻烦。在这里，我实现了一个基本的布尔数组接口。我想测试它购买添加几个值，然后运行每个接口方法。请善待我在这方面不是很擅长，但我想变得更好。

```
package booleanmatrix;

import java.util.Arrays;

/**
 *
 * @author David
 */
public class ArrayMatrix implements BooleanMatrixs {

    private boolean a[][];
    public int Rows;
    public int Cols;
    public int capacityr = 1;
    public int capacityc = 1;
    public int pT=0;
    public int pF=0;

    public ArrayMatrix() {
        a = new boolean[capacityr][capacityc];
    }

    @Override
    public int getNumberRows() {
        return capacityr;
    }

    @Override
    public int getNumberCols() {
        return capacityc;

    }

    @Override
    public void set(int row, int col) throws IndexOutOfBoundsException {

        if (row > capacityr) {
            capacityr = row;
            boolean B[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    B[k][j] = a[k][j];
                }
            }
            a = B;
        }
        if (col > capacityc) {
            capacityc = col;
            boolean C[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    C[k][j] = a[k][j];
                }
            }
            a = C;
        }

        a[row][col] = true;
        pT++;

    }

    @Override
    public void clear(int row, int col) throws IndexOutOfBoundsException {
        if (row > capacityr) {
            capacityr = row;
            boolean B[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    B[k][j] = a[k][j];
                }
            }
            a = B;
        }
        if (col > capacityc) {
            capacityc = col;
            boolean C[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    C[k][j] = a[k][j];
                }
            }
            a = C;
        }

        a[row][col] = false;

    }

    @Override
    public void set(int row, int col, boolean value) throws IndexOutOfBoundsException {
        if (row > capacityr) {
            capacityr = row;
            boolean B[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    B[k][j] = a[k][j];
                }
            }
            a = B;
        }
        if (col > capacityc) {
            capacityc = col;
            boolean C[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    C[k][j] = a[k][j];
                }
            }
            a = C;
        }

        a[row][col] = value;
        if(value==true){
            pT++;
        }

    }

    @Override
    public void toggle(int row, int col) throws IndexOutOfBoundsException {
        if (row > capacityr) {
            capacityr = row;
            boolean B[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    B[k][j] = a[k][j];
                }
            }
            a = B;
        }
        if (col > capacityc) {
            capacityc = col;
            boolean C[][] = new boolean[capacityr][capacityc];
            for (int k = 0; k < capacityr; k++) {
                for (int j = 0; j < capacityc; j++) {
                    C[k][j] = a[k][j];
                }
            }
            a = C;
        }

        if (a[row][col] == true) {
            a[row][col] = false;
            pT--;
        } else {
            a[row][col] = true;
            pT++;

        }

    }

    @Override
    public void setAll() {
        Arrays.fill(a, Boolean.TRUE);
        pT=(capacityr*capacityc);

    }

    @Override
    public void clearAll() {
        Arrays.fill(a, Boolean.FALSE);
        pT=0;

    }

    @Override
    public void setAll(boolean value) {
        if (value == false) {
            Arrays.fill(a, Boolean.FALSE);
        } else {
            Arrays.fill(a, Boolean.TRUE);
             pT=(capacityr*capacityc);

        }

    }

    @Override
    public boolean get(int row, int col) throws IndexOutOfBoundsException {
        boolean x;
        x = a[row][col];
        return x;
    }

    @Override
    public int[][] getTruePositions() {

        int count = 0;

        int ret[][] = new int[pT][2];

        for (int k = 0; k < capacityr; k++) {
            for (int j = 0; j < capacityc; j++) {
                if (a[k][j] == true) {
                    ret[count][0] = k;
                    ret[count][1] = j;
                    count++;
                }

            }
        }
        return ret;
    }

    @Override
    public int[][] getFalsePositions() {
             int total = (capacityr*capacityc);
             int P=(total-pT);
             int count=0;

        int ret[][] = new int[P][2];

        for (int k = 0; k < capacityr; k++) {
            for (int j = 0; j < capacityc; j++) {
                if (a[k][j] == false) {
                    ret[count][0] = k;
                    ret[count][1] = j;
                    count++;
                }
            }
        }
        return ret;

    }

    @Override
    public int[][] getPositions(boolean value) {
               int total = (capacityr*capacityc);
             int P=(total-pT);
             int count=0;

if(value==false){
        int retf[][] = new int[P][2];

        for (int k = 0; k < capacityr; k++) {
            for (int j = 0; j < capacityc; j++) {
                if (a[k][j] == false) {
                    retf[count][0] = k;
                    retf[count][1] = j;
                    count++;
                }
            }
        }
        return retf;}
else{ 
    int count2 = 0;

        int ret[][] = new int[pT][2];

        for (int k = 0; k < capacityr; k++) {
            for (int j = 0; j < capacityc; j++) {
                if (a[k][j] == true) {
                    ret[count2][0] = k;
                    ret[count2][1] = j;
                    count2++;
                }

            }
        }
        return ret;

    }}

    @Override
    public int getNumberTrueValues() {
        return pT;

    }

    @Override
    public int getNumberFalseValues() {
          int total = (capacityr*capacityc);
             int P=(total-pT);
             return P;

    }

    @Override
    public int getNumberValues(boolean value) {
        if (value==false){
             int total = (capacityr*capacityc);
             int P=(total-pT);
             return P;
        }
        else{return pT;}}
    @Override
    public String toString(){
        String X= "1)The number of rows"+capacityr+"\n 2)The number of Columns"+capacityc+"\n 3)The number of True Values"+pT+"\n 4)The number of false values"+(capacityc*capacityr-pT);
        return X;
    }

     public static void main(String[] args) {

     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:12:07.163

看看这个[JUnit 教程](http://code.google.com/p/t2framework/wiki/JUnitQuickTutorial)。这可能有点矫枉过正，但一个好的单元测试框架通常是在这个级别测试代码的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:08:52.433

添加一个具有 Main 方法的新类（如果您使用的是 eclipse，则有一个自动单击按钮可以为您执行此操作），然后从您的类中实例化一个新变量。

```
ArrayMatrix arrayVar = new ArrayMatrix(); 
```

然后您将能够访问所有方法，例如：

```
arrayVar.getNumberCols(); 
```

# c - 编译 PHP 扩展

> ID：10290030
> 
> 赞同：1
> 
> 时间：2012-04-24T00:06:32.507
> 
> 标签：c, makefile, php-extension

我在系统上安装了两个版本的 PHP，一个在`/opt/local`(API=20090626)，另一个在`/opt/php54`(API=20100525)。我正在尝试为该`/opt/php54`版本编译扩展，所以我`/opt/php54/bin/phpize`在扩展目录中运行，然后`./configure --enable-<ext> && make && sudo make install`. 但问题是编译后的扩展不是针对 API=20100525，而是针对 API=20090626（中的那个`/opt/local`）。即使在运行时`make install`，它也会尝试将其安装`/opt/local`在`/opt/php54`.

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:20:24.530

添加`--with-php-config=/opt/php54/bin/php-config`到配置字符串。

# html - 播放框架获取表单值

> ID：10290037
> 
> 赞同：0
> 
> 时间：2012-04-24T00:07:18.167
> 
> 标签：html, forms, playframework-1.x

我有一个带有接受按钮和拒绝按钮的表单。当用户按下接受按钮时，我希望我的数据库中接受的值包含值 true。如果用户按下拒绝，那么我希望我的数据库中接受的值包含值 false。我下面的代码不起作用。有什么建议可以让我正常工作吗？

```
public static void acceptOrRejectResponseForm(Long id,String accept,String reject) {

      Response responseForm = Response.findById(id);

      if(accept != null && !accept.isEmpty()){
          responseForm.accepted = true;
      }
      else if(reject != null && !reject.isEmpty()){
          responseForm.accepted = false;
      }
      accepted.save();
} 
```

这是我的 html

```
<form action="@Admin.acceptOrRejectResponseForm(response.id)" method="GET">                      
   <input type="submit" value="accept"  name="accept">
   <input type="submit" value="reject"  name="reject"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T06:56:10.807

不要创建两个提交按钮。

创建两个默认值为 0 的隐藏字段。调用名称接受和拒绝。比创建两个带有 onclick 动作的按钮。如果您使用 onclick 操作单击接受按钮，您只需将隐藏字段设置为接受 1 并拒绝为 0。当您单击拒绝按钮时，您将隐藏的接受字段设置为 0 并拒绝为 1。比您在 js 中提交表单. 在代码中获取这两个字段并检查女巫一设置为1，女巫一设置为0。这样你可以在db中设置它

# raphael - Raphael JS-沿路径拖动

> ID：10290038
> 
> 赞同：1
> 
> 时间：2012-04-24T00:07:21.643
> 
> 标签：raphael

我正在使用 raphael js，当我单击“运行”按钮时，形状会沿着路径移动。我怎样才能使形状可拖动，以便用户可以选择拖动或单击运行？谢谢。这是我的代码：

```
Raphael("holder", 500,500, function () {
        var r = this,
            p = r.path ('M 215.2 448 L 215.2 405.2 L 189.8 401.5 L 161.8 393.5 L 134.3 380.8 L 112.1 363.9 L 90.9 345.4 L 73.4 321.6 L 63.9 304.6 L 56 286.1 L 47 251.7 L 47 213.1 L 49.6 196.7 L 54.4 174.5 L 58.6 159.1 L 68.2 140.6 L 78.2 123.7 L 90.9 107.8 L 103.6 95.1 L 120.5 85 L 133.2 74.5 L 154.4 63.4 L 170.8 56.5 L 191.4 50.7 L 210 47.5 L 232.7 48 L 252.3 50.7 L 269.7 55.4 L 287.2 60.2 L 306.2 70.2 L 320.5 79.8 L 338.5 93 L 351.8 105.2 L 364.4 121 L 375.6 135.3 L 385.6 154.4 L 391.4 170.8 L 396.2 188.8 L 400.4 204.6 L 400.4 223.1 L 400.4 241.1 L 396.2 263.4 L 392.5 280.8 L 384.6 299.3 L 376.1 315.7 L 363.9 333.2 L 352.3 348 L 338 364.4 L 321.1 375.5 L 296.2 387.7 L 268.7 398.8 L 268.7 378.7 L 289.3 370.2 L 298.8 364.9 L 314.7 355.4 L 328.5 343.8 L 340.6 332.7 L 353.3 318.9 L 361.8 303.6 L 370.8 286.1 L 375 271.8 L 379.8 253.8 L 381.4 238 L 381.4 218.4 L 378.2 190.9 L 372.4 175 L 365.5 156.5 L 359.2 144.8 L 347.5 129.5 L 336.4 117.9 L 323.2 103.6 L 311 95.1 L 294.6 86.1 L 279.3 77.6 L 260.7 72.4 L 245.4 69.2 L 227.4 67.1 L 211 68.1 L 192 70.8 L 176.1 75 L 157.6 81.9 L 144.3 89.8 L 129.5 99.3 L 115.8 109.9 L 102.5 124.2 L 92.5 137.4 L 82.4 154.4 L 76.6 168.1 L 70.3 183.5 L 66.6 200.4 L 65.5 218.4 L 65 232.7 L 68.2 251.7 L 70.3 266.5 L 74 281.3 L 80.9 297.2 L 90.4 313.1 L 98.3 326.3 L 111 339.5 L 118.9 347 L 132.7 356.5 L 146.5 364.9 L 162.9 373.4 L 178.2 378.7 L 189.8 382.4 L 214.2 386.1 L 213.7 292.5 L 201.5 289.3 L 191.4 283.5 L 175.6 269.7 L 164.4 254.9 L 158.1 237.4 L 158.1 219.4 L 163.4 200.4 L 171.9 185 L 183.5 175 L 195.1 167.6 L 210 162.8 L 227.4 162.3 L 241.7 164.9 L 253.9 170.2 L 267.1 179.8 L 278.7 195.1 L 285.6 213.6 L 286.7 235.3 L 283 252.8 L 272.4 267.6 L 258.6 280.3 L 248.6 287.2 L 249.1 307.8 L 267.1 299.3 L 279.8 287.7 L 294.1 272.4 L 299.9 261.8 L 305.2 243.8 L 307.3 226.2 L 306.2 212 L 301 193.5 L 292 178.7 L 281.4 166.5 L 268.2 154.9 L 253.9 148 L 235.3 142.2 L 223.7 141.1 L 206.2 143.8 L 193 147.5 L 175.6 155.4 L 165 163.9 L 154.4 178.2 L 145.9 190.9 L 142.2 209.4 L 139.1 220 L 140.6 238.5 L 142.8 248 L 149.6 267.1 L 158.1 277.1 L 169.2 291.4 L 183 299.9 L 195.7 307.3 L 194.1 364.4 L 172.4 358.1 L 157 350.7 L 141.2 337.4 L 126.4 326.3 L 112.6 310.4 L 102.5 298.3 L 94.6 279.8 L 87.7 262.8 L 84 242.2 L 83 226.2 L 85.1 208.3 L 88.3 189.8 L 95.7 170.2 L 103.1 153.8 L 115.8 137.4 L 129.5 121.6 L 146.5 108.9 L 165 99.9 L 184.6 91.9 L 201.5 87.7 L 222.6 86.6 L 241.7 87.7 L 261.8 91.4 L 278.7 97.2 L 298.8 108.9 L 313.7 119.4 L 330.1 136.9 L 341.7 152.2 L 350.7 171.3 L 357.6 187.2 L 362.3 204.1 L 362.9 221.6 L 361.3 242.2 L 357.6 261.8 L 350.2 282.9 L 343.8 297.7 L 332.7 312.6 L 312.6 330 L 299.9 343.3 L 285.6 351.2 L 262.9 361.8 L 250.7 363.9 L 249.6 421.6 L 268.7 419.4 L 287.2 413.6 L 306.2 405.2 L 326.4 393.5 L 341.7 382.9 L 353.9 371.8 L 366 360.2 L 387.7 333.7 L 396.2 318.9 L 403.6 302 L 410 285.6 L 416.8 253.8 L 419.5 226.2 L 418.4 196.7 L 414.2 180.8 L 409.4 162.3 L 401 145.9 L 392.5 129.5 L 374 100.9 L 362.3 87.7 L 348 76.1 L 336.9 65.5 L 321.1 55.4 L 304.7 48 L 289.3 40.6 L 272.9 35.3 L 254.4 31.1 L 236.9 27.9 L 218.4 27.9 L 202.5 30.6 L 183 33.2 L 168.2 35.8 L 149.1 43.2 L 134.8 50.7 L 117.4 61.2 L 107.3 69.2 L 93 79.8 L 79.8 93 L 67.6 106.2 L 56.5 121.6 L 47 138 L 40.6 151.2 L 35.9 168.1 L 31.1 184.5 L 28.5 199.3 L 28.5 216.3 L 28.5 235.3 L 28.5 251.2 L 31.6 269.2 L 34.3 284 L 40.1 299.3 L 48 315.7 L 57 333.2 L 66 345.4 L 78.2 360.7 L 90.4 373.4 L 104.7 384 L 118.4 393.5 L 135.3 403 L 150.7 409.4 L 169.2 416.3 L 186.1 420.5 L 195.7 421.6 L 196.7 441.1 L 178.2 438.5 L 158.6 432.7 L 140.1 426.3 L 121.6 416.8 L 105.7 407.8 L 90.4 394.6 L 76.6 384 L 62.3 370.2 L 50.7 354.4 L 39.1 339.5 L 31.1 323.7 L 23.2 304.1 L 17.4 288.2 L 12.6 268.1 L 9.4 250.7 L 9.4 229 L 9.4 213.1 L 9.4 194 L 12.6 177.6 L 17.9 157.5 L 23.7 142.2 L 32.2 125.3 L 41.7 108.9 L 56.5 90.9 L 68.2 78.7 L 84 63.9 L 96.7 52.2 L 113.7 42.2 L 127.4 34.3 L 146.5 25.3 L 163.9 19.4 L 183 14.7 L 199.9 11.5 L 222.6 11.5 L 241.7 11.5 L 262.9 15.2 L 278.7 19.4 L 299.9 25.8 L 314.7 33.7 L 334.8 42.2 L 348 51.7 L 366 66.5 L 378.2 78.2 L 389.8 90.3 L 401.5 105.2 L 411.5 122.6 L 420.5 139.5 L 429.5 160.7 L 433.2 176.6 L 436.9 201.1 L 439.6 217.3 L 439.6 235.8 L 436.4 258.1 L 431.1 278.2 L 426.4 295.6 L 417.9 316.3 L 409.4 332.7 L 401 347 L 391.4 361.8 L 376.1 376.1 L 362.9 389.3 L 349.6 399.9 L 333.8 411.5 L 314.7 421 L 298.3 428.4 L 277.1 435.3 L 259.7 438.5 L 231.1 441.7 L 230.1 348 L 243.3 346.4 L 260.2 341.7 L 278.2 333.7 L 291.4 326.3 L 304.1 314.7 L 317.9 301.5 L 329 286.1 L 337.5 269.2 L 342.8 252.8 L 344.3 235.3 L 343.3 220 L 341.2 201.5 L 339.6 190.3 L 332.7 175 L 325.3 159.7 L 313.1 144.8 L 301 132.7 L 286.1 123.1 L 272.4 114.7 L 254.4 109.4 L 239.6 106.2 L 220 105.2 L 205.2 105.7 L 187.7 110.4 L 168.7 117.3 L 153.9 127.4 L 138.5 137.4 L 127.9 151.7 L 118.4 164.4 L 110.5 180.3 L 105.2 197.2 L 102.5 214.7 L 101 226.2 L 103.1 242.7 L 105.7 258.6 L 111.5 275.5 L 117.4 287.7 L 128.5 302.5 L 138.5 315.7 L 154.9 329 L 164.4 333.2 L 174.5 336.9 L 176.6 316.8 L 165.4 312.4 L 153.3 300.4 L 141.2 288.2 L 132.2 270.2 L 124.2 255.9 L 122.1 238 L 120.5 217.9 L 125.8 198.3 L 130.6 181.3 L 143.8 162.8 L 154.4 149.6 L 168.7 138 L 186.1 131.6 L 207.8 126.3 L 222.9 124.2 L 245.4 127.4 L 261.8 131.1 L 280.9 142.2 L 295.7 153.8 L 308.4 172.9 L 317.4 190.9 L 324.2 214.1 L 324.8 232.1 L 321.6 253.3 L 316.3 271.3 L 302.5 289.8 L 288.8 302.5 L 274 315.7 L 256 322.6 L 231.6 329.5 L 225.8 222.6 L 215.2').attr({stroke: "#fff", opacity: .0, "stroke-width": 10}),
    len = p.getTotalLength(),
    e = r.ellipse(0, 0, 6, 6).attr({stroke: "none", fill: "#fef506"}).onAnimation(function () {
    var t = this.attr("transform");
            over.attr({path: "M238,376L" + t[0][1] + "," + t[0][2] + "z"});
            });
     r.circle(516, 248, 5).attr({stroke: "none", fill: "#", opacity: 0}).click(function () {
 e.attr({rx: 5, ry: 3}).animateAlong(p, 4000, true, function () {
 e.attr({rx: 4, ry: 4});
        });
    });

 r.customAttributes.along = function (v) {

     var point = p.getPointAtLength(v * len);
         return {
            transform: "t" + [point.x, point.y] + "r" + point.alpha
            };
        };
  e.attr({along: 0});
     var rotateAlongThePath = true;
     run=document.getElementById('run'),
     run.onclick= function() {
        e.animate({along:3},2000000, function () {
        e.attr({along: 0});
        e.animate(anim.delay(500));
                setTimeout(run);
            });
        }
        run();
    }); 
```

# javascript - 图片有时不显示

> ID：10290051
> 
> 赞同：1
> 
> 时间：2012-04-24T00:09:46.010
> 
> 标签：javascript, ios, image, web-applications, browser-cache

我有一个使用应用程序缓存的 WebApp。它使用的所有文件，包括图像，都在清单文件中。有时缓存的图像在未连接到 Internet 时不会显示。有时他们会这样做。这主要发生在IOS上。

我还发现，如果我只是声明一个文件，那么我使用 drawImage 插入到画布中的某些图像不会在第一次使用时出现。它将显示在后续使用中。我终于不得不把它变成一个数据网址。

有什么想法吗？

# javascript - 使用 jQuery 的 each() 方法创建 javascript 对象

> ID：10290052
> 
> 赞同：1
> 
> 时间：2012-04-24T00:09:50.723
> 
> 标签：javascript, jquery, ajax

我很好奇什么可能是一个比我想象的更大的问题。

我正在使用以下代码在一组文本输入字段上侦听“keyup”。如果用户在给定的时间内停止输入，我会使用 AJAX 将数据发送到控制器。

我决定在 JavaScript 中尝试 OOP 来实现这一点。这是因为我想要每个输入字段的计时器方法的新实例。（绝对清楚，我对 javascript 中的 OOP 非常陌生，所以这可能很可怕。让我知道。）

这是带有方法的主类：

```
 function FieldListener(entity){
      t = this;

      t.typingTimer;                // Timer identifier
      t.doneTypingInterval = 1000;  // Time in ms. e.g.; 5000 = 5secs        
      t.entity = entity;

      entity.bind("keyup", function(){t.setTimer();});
    }

    FieldListener.prototype.setTimer = function(){
      t = this;

      // User is still typing, so clear the timer.
      clearTimeout(t.typingTimer);

      // Get the field name, e.g.; 'username'
      t.entityType = t.entity.attr("name");
      // If the value is empty, set it to a single space.
      if(!(t.val = t.entity.val())){
         t.val = ' ';
      }
      t.noticeSpan = t.entity.siblings("span");
      // Display 'waiting' notice to user.
      t.noticeSpan.html('...')

      t.typingTimer = setTimeout(function(){t.doneTyping();},t.doneTypingInterval);
    }

    FieldListener.prototype.doneTyping = function(){
       // Encode for passing to ajax route.
      t = this;

      valueType = encodeURIComponent(t.entityType);
      value = encodeURIComponent(t.val);

      $.ajax({
        url: '/check/'+valueType+'/'+value,
        type: 'GET',
        processData: false
      })
      .done(function(validationMessage){
        t.noticeSpan.html(validationMessage);
      })
      .fail(function(){
        t.noticeSpan.html("Something went wrong. Please try again.");
      });       
    } 
```

所以从这里我希望能够为每个输入字段创建一个 FieldListener 类的对象。

我知道我可以很容易地做到这一点，如果我有每个这样的 id：

```
 var fieldListener = new FieldListener($("#someFieldID")); 
```

但我想用给定的类名迭代每个字段。也许接近这个？：

```
 i = 0;
   $(".info-field").each(function(){
      i = new FieldListener($(this));
   }); 
```

但这不起作用（而且看起来不太好）。

有什么想法吗？（我也对类/方法代码的批评/改进感到好奇。）

编辑：根据@ChrisHerring 的问题：问题在于它似乎创建了对象，但仅针对 each() 方法中的最后一个元素。因此，与“.info-field”类的最后一个输入字段关联的跨度显示从 AJAX 返回的validationMessage，无论我输入的是哪个字段。

更新：

创建新对象似乎有问题。例如，如果不是遍历 each() 方法，而是简单地跟随一个类启动另一个类，如下所示：

```
 var fieldListener1 = new FieldListener($("#someFieldID"));
   var fieldListener2 = new FieldListener($("#someOtherFieldID")); 
```

fieldListener2 会覆盖在启动 fieldListener1 时保存的变量。这意味着当我在 ID 为“#someFieldID”的输入字段中键入时，它的行为就像我在 ID 为“#someOtherFieldID”的输入字段中键入一样。想法？

更新＃2（现在解决）：

看来我现在已经解决了这个问题。我需要在 't = this;' 之前添加 'var' 在 FieldListener 类中。当然，仍然欢迎任何评论/批评。;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:48:56.920

我认为您应该使用 jquery`.on()`来处理绑定。

```
$(body).on({

   keyup: function () { HandleKeyUpEvent($(this)); },
   keydown: function () { HandleKeyDownEvent($(this)); }

  }, ".info-field"); 
```

我意识到这与您最初的编码想法（使用原型）背道而驰，但如果您打算这样做，它仍然是 OOP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:49:32.103

我想你想要一个对象数组`FieldListener`。

```
var myListeners = [];
i = 0;
$(".info-field").each(function(){
    myListeners[i] = new FieldListener($(this));
    i++
}); 
```

这会给你一个列表，页面上第一个的侦听器在`FieldListeners`哪里，第二个的侦听器在哪里，等等。`myListeners[0]``.info-field``myListeners[1]`

* * *

编辑：看来你已经解决了这个问题。不过，这个答案以后可能仍然会派上用场，所以我不会删除它。=)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T00:58:29.140

t 变量是全局变量。“keyup”事件的函数是动态评估的，这意味着它会获取 t 的最后一个值。

改变

```
 t = this; 
```

到

```
 var t = this; 
```

# jsf - 带有日期的 selectOneMenu 对值和标签使用不同的模式

> ID：10290069
> 
> 赞同：2
> 
> 时间：2012-04-24T00:11:52.043
> 
> 标签：jsf, date, converter, selectonemenu

我想建立一个工作日选择菜单。工作日初始化为 1970 年的第一个工作日。

转换器将值转换为日期。但我想使用 java 日期模式“EEEE”显示全文工作日。

```
<h:selectOneMenu id="day" label="#{msg.day_u}" required="true" value="#{date}">
    <f:convertDateTime pattern="dd/mm/yyyy"/>
    <f:selectItem itemValue="05/01/1970" itemLabel="display Monday using pattern"/>
    <!-- other weekdays -->
</h:selectOneMenu> 
```

这是行不通的。现在我正在使用自定义 EL 函数来检索标签属性中的本地化工作日。

有没有办法将它与日期模式一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T03:34:18.477

转换器确实不会应用在选项标签上。它仅适用于期权价值。它应该可以与 EL 函数一起正常工作。假设您有一个`List<Date>`可用项目和`Date`选定项目，那么应该这样做：

```
<f:selectItems value="#{bean.weekdays}" var="day" 
    itemValue="#{day}" itemLabel="#{util:formatDate(day, 'EEEEE')}" /> 
```

`formatDate()`看起来像这样

```
public static String formatDate(Date date, String pattern) {
    if (date == null) {
        return null;
    }

    if (pattern == null) {
        throw new NullPointerException("pattern");
    }

    Locale locale = FacesContext.getCurrentInstance().getViewRoot().getLocale();
    return new SimpleDateFormat(pattern, locale).format(date);
} 
```

[OmniFaces](http://omnifaces.org)[正好有](http://omnifaces.org/docs/vdldoc/current/of/formatDate.fn.html)这个功能。

# java - 带有 MATCH_PARENT 的 RelativeLayout 不起作用

> ID：10290072
> 
> 赞同：4
> 
> 时间：2012-04-24T00:12:09.810
> 
> 标签：java, android, android-relativelayout

这就是我想要实现的目标：我有很多表格行。每行应该有两个文本视图，产品标题和副标题相互重叠（副标题尚未实现）。应该左对齐。在右边，我想要一个微调器来选择数量。

文本来自数据库，当然长度不同。

到目前为止，这是我想出的：

```
<ScrollView android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="1">

   <TableLayout 
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:id="@+id/barmenu"
      android:background="#99ffff"
      android:scrollbars="vertical">

      <TableRow 
         android:layout_height="wrap_content" 
         android:background="#ffff99"
         android:layout_width="match_parent">

         <RelativeLayout
            android:layout_width="match_parent"
            android:background="#0000ff">

            <TextView
               android:id="@+id/productTitle"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:background="#88ffff"
               android:ellipsize="end"
               android:padding="2dp"
               android:singleLine="true"
               android:text="Product name"
               android:textColor="#000000"
               android:gravity="left" 
               android:textSize="13sp"
               android:textStyle="bold" />

            <Spinner
               android:gravity="right" 
               android:layout_height="40dp"
               android:layout_toRightOf="@id/productTitle"
               android:width="100dp"
               android:layout_width="wrap_content" /> 
         </RelativeLayout>
      </TableRow>
      <TableRow 
         android:layout_height="wrap_content" 
         android:background="#ffff99"
         android:layout_width="match_parent">

         <RelativeLayout
            android:layout_width="match_parent"
            android:background="#0000ff">

            <TextView
               android:id="@+id/productTitle2"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:background="#88ffff"
               android:ellipsize="end"
               android:padding="2dp"
               android:singleLine="true"
               android:text="Some long long long long name"
               android:textColor="#000000"
               android:gravity="left" 
               android:textSize="13sp"
               android:textStyle="bold" />

            <Spinner
              android:gravity="right" 
              android:layout_height="40dp"
              android:layout_toRightOf="@id/productTitle2"
              android:width="100dp"
              android:layout_width="wrap_content" /> 
         </RelativeLayout>
      </TableRow>
   </TableLayout>
</ScrollView> 
```

屏幕转储：

![在此处输入图像描述](../Images/9a8451dbfa16a09dcc3c05d5c366416d.png)

第一个问题是RelativeLayout 没有填写表格行的宽度。第二个问题：微调器没有正确对齐。

我错过了什么？

最好的问候艾伦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-16T16:45:02.840

> 机器人：fillViewport="真"

将此行添加到您的 ScollView 属性中，您就完成了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T02:03:50.187

我会让它更简单更轻。只需`RelativeLayout`用于所有这 4 个视图。对齐两个微调器并使用 - 制作 textview`match_parent`并添加`toLeftOf`相对微调器。我想你会看到你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-15T16:11:51.670

添加`android:layout_weight="1"`到您的相对布局

# javascript - httplib (python) 可以与页面及其 javascript 交互吗？

> ID：10290074
> 
> 赞同：1
> 
> 时间：2012-04-24T00:12:22.183
> 
> 标签：javascript, python, web, httplib

我想编写一个 python 脚本，它会询问 reddit 帖子的 url，转到页面，使用指定的帐户登录，然后投票赞成帖子和注销。

A）这可以用python完成吗？

B) 我该怎么做？如果您可以提供很棒的代码，但不要自杀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:17:46.257

你真的需要与 JavaScript 交互吗？

您可以通过查看使用 Firebug 或任何其他调试器发出的 AJAX 请求、检查 cookie、请求参数等来对 Reddit 代码进行逆向工程。

在此之后，您可以使用 Python 的 urllib 通过设置相同的请求类型（GET 与 POST）、请求参数和 cookie 来模拟此请求。

还要检查这篇文章[web-scraping-with-python](https://stackoverflow.com/questions/2081586/web-scraping-with-python)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:24:06.203

除了上面@Maksym 的好建议之外，您还可以使用像[Selenium](http://seleniumhq.org/)（具有 python 绑定）这样的浏览器测试工具来编写脚本以直接与 Reddit 页面交互。缺点是每次运行时它都会打开您的浏览器的副本，我不确定这对您来说是否是个问题。

# matlab - 在 MATLAB R2009b 中创建符号矩阵

> ID：10290077
> 
> 赞同：1
> 
> 时间：2012-04-24T00:12:56.973
> 
> 标签：matlab, symbols

如何在 MATLAB R2009b 中创建由符号元素组成的矩阵？

这样做的乏味方法是：

```
syms a11 a12 a21 a22
A = [a11 a12; a21 a22] 
```

但如果我想要一个 10x10 矩阵，我需要更好的东西。

[在这里](http://www.mathworks.com/matlabcentral/answers/2521-creating-vector-of-symbols)，我找到了以下命令：

```
A = sym('A%d', [2 2]); 
```

但当我使用 R2009b 时，它似乎只适用于最新版本的 MATLAB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:37:07.967

一种不太有效的方法是编写一个脚本来创建一个字符串并使用[`eval`](http://www.mathworks.com/help/techdoc/ref/eval.html).

```
cmd_var = 'syms';
cmd_mat = 'A=[';
for i = 1:3
    for j = 1:3
        var = sprintf(' a_%d_%d ',i,j);
        cmd_var = [cmd_var var];
        cmd_mat = [cmd_mat var];
    end
    cmd_mat = [cmd_mat ';'];
end
cmd_var = [cmd_var ';'];
cmd_mat = [cmd_mat '];']; 
```

因此，命令字符串如下所示：

```
cmd_var =
syms a_1_1  a_1_2  a_1_3  a_2_1  a_2_2  a_2_3  a_3_1  a_3_2  a_3_3 ;

cmd_mat =
A=[ a_1_1  a_1_2  a_1_3 ; a_2_1  a_2_2  a_2_3 ; a_3_1  a_3_2  a_3_3 ;]; 
```

现在执行命令字符串：

```
eval(cmd_var)
eval(cmd_mat) 
```

# java - 生成 HttpResponse

> ID：10290081
> 
> 赞同：3
> 
> 时间：2012-04-24T00:13:42.917
> 
> 标签：java, httpresponse

手动创建 HTTP 响应时，如何获取`Server`和`ETag`

```
 * HTTP/1.1 200 OK
     * Date: Mon, 23 Apr 2012 23:44:52 GMT
     * Server: Apache/2.2.3 (Red Hat)                  <-----
     * Last-Modified: Fri, 16 Sep 2005 18:08:50 GMT
     * ETag: "421142-2f-400e77c517080"                 <-----
     * Accept-Ranges: bytes
     * Content-Length: 47
     * Content-Type: text/plain
     * Connection: close 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:18:09.080

“服务器”是您的 HTTP 服务器想要命名/标识自己的任何内容。即“Zumgto Surver 4.5”。

[“ETag”](http://en.wikipedia.org/wiki/HTTP_ETag)标识特定项目的“版本”，因此只要您的服务器可以合理地说“此 ETag 对应于当前版本”，您几乎可以发送任何内容。即“v3345”或项目的哈希...如果您不支持请求中的“If-None-Match”标头，则完全可选。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:22:04.083

两者都不是必需的。您可以使用与上述相同的格式制作自己的服务器标签。省略 eTag 或只生成您自己的。您可以使用当前时间戳或常量。以下格式应该可以工作。

```
Server: Program/version (O/S)
ETag:  "Timestamp" 
```

# objective-c - 使用 LLDB 进行 IOS 调试类成员变量 NSArray

> ID：10290082
> 
> 赞同：0
> 
> 时间：2012-04-24T00:13:50.273
> 
> 标签：objective-c, ios, xcode, lldb

有谁知道如何在 IOS 中获取类成员变量的值？

我尝试使用 LLDB 在类成员变量中调试 NSArray。

在我运行这个之后

```
__cellDataShadowArray2D = [[NSArray alloc] initWithObjects:[NSArray arrayWithObjects:obj1, obj2, nil], nil]; 
```

当我使用 LLDB（打印对象）检查值时，我总是得到这个。

```
(lldb) po __cellDataShadowArray2D
(NSArray *) $66 = 0x001e8894 <object returned empty description>

(lldb) p __cellDataShadowArray2D
(NSArray *) $67 = 0x001e8894

(lldb) po [__cellDataShadowArray2D count]
2012-04-24 10:10:38.535 SOME [61985:15803] -[__NSCFConstantString count]: unrecognized selector sent to instance 0x1e8894
(id) $68 = 0x00000000 <nil>

(lldb) po [__cellDataShadowArray2D retainCount]
(id) $69 = 0xffffffff [no Objective-C description available]

(lldb) p (int) [__cellDataShadowArray2D retainCount]
(int) $70 = -1

(lldb) p (int) [__cellDataShadowArray2D count]
2012-04-24 10:11:31.333 SOME [61985:15803] -[__NSCFConstantString count]: unrecognized selector sent to instance 0x1e8894
(int) $71 = 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:47:12.737

*   确保在进行测试之前实际评估了代码行。

很明显 __cellDataShadowArray2D 指向一个已编译常量字符串的空实例；@""。这意味着它不能是过度释放或类似的东西；这意味着分配尚未发生（或者您正在尝试调试优化的代码并且调试器由于优化而感到困惑）。

*   非对象类型的 po 没有意义

*   `retainCount`没用。不要叫它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:56:22.907

这可能会有所帮助：[https ://devforums.apple.com/thread/142235?start=0&tstart=0](https://devforums.apple.com/thread/142235?start=0&tstart=0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T11:34:55.860

这绝对是一个 LLDB 问题。我也有同样的情况，根本无法调试。我切换回GDB，没问题

# qt - Qt：Quazip 的简单示例

> ID：10290083
> 
> 赞同：8
> 
> 时间：2012-04-24T00:14:19.513
> 
> 标签：qt, quazip

我建立了quazip库。我需要一个简单的示例来说明如何解压缩 zip 文件。例如。

```
Quazip zipFile( QFile("test.zip") );
zipFile.unzip(); 
```

quazip 中显示的测试有点令人困惑。我搜索了很短的时间来找到一个例子，但我找不到一个。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T14:24:36.667

这是一个显示如何读取文件的快速示例。您需要对循环中的代码进行一些修改，以将数据写入文件或执行应用程序所需的任何操作：

```
QuaZip zip("zipFile.zip");
zip.open(QuaZip::mdUnzip);

QuaZipFile file(&zip);

for(bool f=zip.goToFirstFile(); f; f=zip.goToNextFile()) {
    file.open(QIODevice::ReadOnly);
    //same functionality as QIODevice::readData() -- data is a char*, maxSize is qint64
    file.readData(data,maxSize);
    //do something with the data
    file.close();
}

zip.close(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-06-21T04:11:02.050

您可以使用 JlCompress 类的静态函数。它非常易于使用。

**静态公共成员函数**

```
static bool     compressFile (QString fileCompressed, QString file)
static bool     compressFiles (QString fileCompressed, QStringList files)
static bool     compressDir (QString fileCompressed, QString dir=QString(), bool recursive=true)
static QString  extractFile (QString fileCompressed, QString fileName, QString fileDest=QString())
static QStringList  extractFiles (QString fileCompressed, QStringList files, QString dir=QString())
static QStringList  extractDir (QString fileCompressed, QString dir=QString()) 
static QStringList  getFileList (QString fileCompressed) 
```

来源：http: [//quazip.sourceforge.net/classJlCompress.html](http://quazip.sourceforge.net/classJlCompress.html)

# css - * { 颜色：继承 } 和 * { 字体：继承 } 是 CSS 重置的好主意吗？

> ID：10290085
> 
> 赞同：0
> 
> 时间：2012-04-24T00:14:27.147
> 
> 标签：css, css-reset

您认为以下内容是对 CSS 重置的明智补充吗？

```
* {
    color: inherit;
    font: inherit;
}​ 
```

这是一个演示：http: [//jsfiddle.net/Daniel_Hug/QZWV6/](http://jsfiddle.net/Daniel_Hug/QZWV6/)

# c# - 在 ASP.NET 中添加事件处理程序

> ID：10290089
> 
> 赞同：0
> 
> 时间：2012-04-24T00:15:00.637
> 
> 标签：c#, asp.net, event-handling, imagebutton

如何将事件处理程序添加到 ASP.NET 中的图像按钮？是否可以像在 WPF 中那样添加事件处理程序？请帮忙 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:33:38.843

简单的方法：只需双击您的图像按钮。

几乎同样简单的方法：右键单击您的图像按钮，选择属性。从属性单击顶部的闪电图标。在这里您可以访问所有事件，双击您要处理的事件，它会自动创建一个事件处理程序方法供您自定义。

# javascript - jquery 设置上一个 div 类

> ID：10290093
> 
> 赞同：0
> 
> 时间：2012-04-24T00:16:07.457
> 
> 标签：javascript, jquery

我有一些 jQuery 将图像设置为星级系统的单选按钮。我希望包含一个功能，当用户单击单选按钮时，图像更改为选中，并且之前的收音机也更改为选中。

我设法更改了选中按钮的类，并且我有一些代码也可以更改先前按钮上的类，但使用更简单的 div 结构。我已经能够将两者结合起来。

更改单选按钮类的代码

```
$(function() {
    $('input:radio').each(function() {
        $(this).hide();
        $('<a title=" check me " class="radio-fx '+this.name+'" href="#"><div class="radio"></div></a>').insertAfter(this);
    });
    $('.radio-fx').live('click',function(e) {
        e.preventDefault();
        $check = $(this).prev('input');
        var unique = '.'+this.className.split(' ')[1]+' div';
        $(unique).attr('class', 'radio');
        $(this).find('div').attr('class', 'radio-checked');
        $check.attr('checked', true);
    });

}); 
```

**html:**

```
 <div class="voteGroup">
                        <input type="radio" id="price_0" value="1" name="price" style="display: none;" checked="checked">
                        <a href="#" class="radio-fx price" title=" check me ">
                            <div class="radio-checked"></div>
                        </a>
                        <input type="radio" id="price_1" value="2" name="price" style="display: none;" checked="checked">
                        <a href="#" class="radio-fx price" title=" check me ">
                             <div class="radio"></div>
                        </a>
                        <input type="radio" id="price_2" value="3" name="price" style="display: none;" checked="checked">
                        <a href="#" class="radio-fx price" title=" check me ">
                              <div class="radio"></div>
                        </a>

                    </div> 
```

我尝试集成以将以前的代码设置为在悬停时检查的代码：

```
 $('.radio-fx').hover(
            // Handles the mouseover
            function() {
                $(this).prevAll().andSelf().addClass('radio-checked');
                $(this).nextAll().removeClass('radio');
            },
            // Handles the mouseout
            function() {
                $(this).prevAll().andSelf().removeClass('radio');
            }
        ); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:52:15.617

```
<div class="voteGroup">
    <input type="radio" id="price_0" value="1" name="price" style="display: none;" checked="checked">
    <a href="#" class="radio-fx price" title=" check me ">
        <div class="radio"></div>
    </a>
    <input type="radio" id="price_1" value="2" name="price" style="display: none;" checked="checked">
    <a href="#" class="radio-fx price" title=" check me ">
         <div class="radio"></div>
    </a>
    <input type="radio" id="price_2" value="3" name="price" style="display: none;" checked="checked">
    <a href="#" class="radio-fx price" title=" check me ">
          <div class="radio"></div>
    </a>
</div>
<style type="text/css">
    .radio-fx { float:left;margin:10px;}
    .radio-fx .radio{ background:#ff0; width:20px; height:20px;}
    .radio-checked .radio{ background:#f0f;}
</style>
<script type="text/javascript" src="../share/libs/jquery-1.7.min.js"></script>
<script type="text/javascript">
$(function() {
    $('.radio-fx').live( "mouseenter", function() { // Handles the mouseover
            var $self = $(this);
            $self.addClass('radio-checked').prevAll().addClass('radio-checked');
            $self.nextAll().removeClass('radio-checked');
    }).live ( "mouseout", function() { // Handles the mouseout
            $(this).removeClass('radio').prevAll().removeClass('radio'); // what is this for?
    });
});
</script> 
```

完整的测试代码在这里，试一试

# iphone - 如何在 NSOperationQueue 中设置优先级以执行下一个操作，直到上一个操作完成？

> ID：10290094
> 
> 赞同：0
> 
> 时间：2012-04-24T00:16:35.410
> 
> 标签：iphone, cocoa-touch, ipad, nsoperation, nsoperationqueue

如何在 NSOperationQueue 中设置优先级以在上一个操作完成之前不执行下一个操作？

```
 NSOperationQueue *operationQueue = [[NSOperationQueue alloc] init];
  [operationQueue setMaxConcurrentOperationCount:1];
   NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(addPhotoWithButton:) object:button];
  [operationQueue addOperation:operation];
  [operation release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:51:24.277

假设您的意思是您想要连续执行操作或一次执行一个操作，那么我认为您的问题是您使用 1 调用 setMaxConcurrentOperationCount: ，然后通过用另一个操作队列覆盖它来丢失对该操作队列的引用。所以你所做的是正确的，你只需要将操作添加到具有所需操作计数的队列中。您可能不是故意这样做的，事实上，我认为您会看到编译器警告。试试这个代码：

```
NSOperationQueue *operationQueue = [[NSOperationQueue alloc] init];
[operationQueue setMaxConcurrentOperationCount:1];
NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(addPhotoWithButton:) object:button];
[operationQueue addOperation:operation];
[operation release]; 
```

# node.js - 玉中元素的动态宽度

> ID：10290096
> 
> 赞同：2
> 
> 时间：2012-04-24T00:17:03.493
> 
> 标签：node.js, express, pug

我正在尝试设计一个进度条，并且我想尝试根据一些数学计算来设置进度条的宽度。

下面工作正常，因为我将宽度硬编码为 60%

```
.pledged(style="width:60%") 
```

我想做这样的事情：

```
.pledged(style="width:((totalVotes - votesRemaining)*100)%") 
```

我想要达到的目标有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T22:49:08.607

请务必添加`#{}`以访问您的变量：

```
.pledged(style="width:#{totalVotes - votesRemaining)*100}%") 
```

# gwt - LESS css or SCSS in GWT

> ID：10290098
> 
> 赞同：11
> 
> 时间：2012-04-24T00:17:17.613
> 
> 标签：gwt, less

Has anyone been able to integrate the wonderful shorthanded syntax of LESS with the awesomely module, re-factor friendly and type-safe CSS of GWT UiBinder?

```
<ui:style with="com.lesscss.gwt">
    .selector{
        /* Can I haz LESS in here? */
     }
</ui:style> 
```

Naturally, you can use LESS with GWT -- You just have to use non-compiled css. I want my css to go through the LESS compiler, and then the GWT compiler.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T18:27:15.463

There are no direct libraries for that, no.

LESS doesn't even have a java compiler, so I really don't think it's ever going to happen.

Suppose you could write a pre-compile routine that will go through your ui.xml files, compile contents of ui:style nodes and put the compiled versions back. Then you will run into continuous problems with your IDE complaining about improper CSS code.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-20T14:20:00.920

As said before, there was no libraries to do that directly. But there is now ;) !

I recently wrote and published a library ([HexaCss](http://lteconsulting.fr/hexacss/) for GWT) which allows to bind a GWT application to external CSS files, while keeping type-safety and optimizations like pruning and css name obfuscation.

You use it like the traditionnal CssResource (so typesafely), but instead of binding to a CSS file Inside your GWT project, it binds to any external CSS file that you want (you can even bind multiple CSS files to the same application which gives you themes for your GWT application).

So in your case, the external CSS file would have been generated with HexaCss. That's what I do on many projects.

You can even use Sass, GSS and so on. You can also use the already written bindings for Bootstrap and Skeleton.

A sample which resembles to your question is this one, where the CSS is generated with Less, and used in GWT with HexaCss, which is then usable from UiBinder or Java directly.

Link to the sample : [http://lteconsulting.fr/hexacss/demo/sample3/index.html](http://lteconsulting.fr/hexacss/demo/sample3/index.html) - This is a very ugly demo showing only the idea. You can switch between themes with the listbox on the top.

Hope this helps !

# solr - Solr 高亮设置

> ID：10290099
> 
> 赞同：1
> 
> 时间：2012-04-24T00:17:18.750
> 
> 标签：solr, lucene, solrj

我错过了[Solr 中突出显示的内容](https://stackoverflow.com/questions/4058913/how-to-highlighting-search-results-using-apache-solr-with-php-code)吗？我无法让它在我的 Solr xml 结果页面中工作。

```
http://localhost:8080/solr/select?q=book&hl=true 
```

以上是我希望在结果中突出显示的术语书的基本查询。

我的 solrconfig 中也有默认设置：

```
<searchComponent class="solr.HighlightComponent" name="highlight">
    <highlighting>
      <!-- Configure the standard fragmenter -->
      <!-- This could most likely be commented out in the "default" case -->
      <fragmenter name="gap" 
                  default="true"
                  class="solr.highlight.GapFragmenter">
        <lst name="defaults">
          <int name="hl.fragsize">100</int>
        </lst>
      </fragmenter> 
```

我需要在架构的“内容”字段中设置什么吗？先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:48:37.207

您还需要设置要突出显示返回结果的字段：

`http://localhost:8080/solr/select?q=book&hl=true&hl.fl=content`

您也可以在您的部分中设置它。

**编辑：** 您还需要`<requestHandler name="/select" class="solr.SearchHandler">`在您的 solrconfig.xml 文件中启用突出显示组件。假设您使用的是标准的 /select 请求处理程序。为此，您需要取消注释并修改该`<arr name="components">`部分底部的`<requestHandler>`部分，如下所示：

```
 <arr name="components">
   <str>highlight</str>
 </arr> 
```

这应该在您的搜索中启用突出显示组件。

# ruby-on-rails - 将 ActiveAdmin 的选择类型过滤器更改为没有“任何”选项

> ID：10290101
> 
> 赞同：1
> 
> 时间：2012-04-24T00:17:39.157
> 
> 标签：ruby-on-rails, ruby, filter, activeadmin

如何从选择类型过滤器中删除“任何”选项？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T19:02:19.467

这是一个为所有选择过滤器禁用它的猴子补丁。贴进去`initializers/active_admin.rb`。

```
module ActiveAdmin
  module Inputs
    class FilterSelectInput < ::Formtastic::Inputs::SelectInput

     def input_options
       super.merge(:include_blank => false)
     end
    end
  end
end 
```

# android - 如何从服务中停止服务

> ID：10290104
> 
> 赞同：0
> 
> 时间：2012-04-24T00:17:46.473
> 
> 标签：android, android-service

我在服务中使用位置侦听器，并且我已经覆盖了`onLocationChanged(Location)`方法。现在我希望每当第一次调用此方法时，我都想停止服务。所以请告诉我该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:35:11.137

[`stopSelf`](http://developer.android.com/reference/android/app/Service.html#stopSelf%28%29)从方法调用`onLocationChanged`（假设服务本身实现了该接口）。

# android - 如何追踪 Android 应用程序中的错误？

> ID：10290113
> 
> 赞同：0
> 
> 时间：2012-04-24T00:19:45.100
> 
> 标签：android, exception

我最近在google play上放了一个应用程序，有些人报告了错误。我从来没有遇到过这个应用程序错误，我不知道是什么原因造成的。这是它说的错误：

```
 android.content.ActivityNotFoundException: No Activity found to handle Intent {act=android.intent.action.VIEW dat=http://a47.video2.blip.tv/12990004359402/RoosterTeeth-RedVsBlueEpisode1933.flv?brs=1011&bri=1.4 typ=video/flv }
 at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1408)
 at android.app.Instrumentation.execStartActivity(Instrumentation.java:1378)
 at android.app.Activity.startActivityForResult(Activity.java:2817)
 at android.app.Activity.startActivity(Activity.java:2923)
 at red.vs.blue.videos.SeasonOneListView.onListItemClick(SeasonOneListView.java:157)
 at android.app.ListActivity$2.onItemClick(ListActivity.java:321)
 at android.widget.AdapterView.performItemClick(AdapterView.java:284)
 at android.widget.ListView.performItemClick(ListView.java:3382)
 at android.widget.AbsListView$PerformClick.run(AbsListView.java:1696)
 at android.os.Handler.handleCallback(Handler.java:587)
 at android.os.Handler.dispatchMessage(Handler.java:92)
 at android.os.Looper.loop(Looper.java:123)
 at android.app.ActivityThread.main(ActivityThread.java:4627)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:521)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
 at dalvik.system.NativeStart.main(Native Method) 
```

我真的很想得到一些帮助。我是菜鸟，所以如果您需要有关此问题的更多信息来帮助我，请随时提问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:47:08.537

很可能有些用户的手机中没有原生视频播放器。很奇怪，但可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:47:03.643

是的。出现错误的用户可能没有安装视频播放器，无法处理文件类型为`video/flv`.

# ruby - 如何解析 Nokogiri 在 Ruby 中返回的数据结构？

> ID：10290115
> 
> 赞同：-1
> 
> 时间：2012-04-24T00:19:49.543
> 
> 标签：ruby, nokogiri

所以我在一个数组元素中循环，这是返回的结果：

```
[nil, [#<Nokogiri::XML::Element:0x835386d4 name="a" attributes=[#<Nokogiri::XML::Attr:0x835385f8 name="href" value="http://bham.craigslist.org/web/2961573018.html">] children=[#<Nokogiri::XML::Text:0x835381c0 "Web Designer Full time">]> 
```

我想做的是访问`href`价值，然后是`text`价值。我怎么做？

我试过这个：

```
puts i[:href] 
```

但这会产生此错误：

```
TypeError: Symbol as array index 
```

顺便说一句，我`i`通过这样的每个元素作为数组中的元素访问：

```
contents.each do |i|
    puts i.inspect
    puts i[:href]
end 
```

**编辑1：**

这就是我生成`contents`数组的方式。没有必要重命名它，因为它会让人困惑:)

```
contents = {}
first_items.each do |link|
    content_url = link
    content_page = Nokogiri::HTML(open(content_url))
    contents[link[:href]] = content_page.css("p a")
end

puts contents.inspect 
```

这是得到的输出：

```
{nil=>[#<Nokogiri::XML::Element:0x85fee914 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fee838 name="href" value="http://bham.craigslist.org/web/2961573018.html">] children=[#<Nokogiri::XML::Text:0x85fee400 "Web Designer Full time">]>, #<Nokogiri::XML::Element:0x85fee298 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fee1bc name="href" value="http://bham.craigslist.org/web/2959813303.html">] children=[#<Nokogiri::XML::Text:0x85fedd84 "Once in a lifetime opportunity...">]>, #<Nokogiri::XML::Element:0x85fedc1c name="a" attributes=[#<Nokogiri::XML::Attr:0x85fedb40 name="href" value="http://bham.craigslist.org/web/2925485723.html">] children=[#<Nokogiri::XML::Text:0x85fed708 "Website Designer and Blogging Internship!">]>, #<Nokogiri::XML::Element:0x85fed5a0 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fed4c4 name="href" value="http://bham.craigslist.org/web/2918424652.html">] children=[#<Nokogiri::XML::Text:0x85fed08c "Excellent Java Developer Opportunity!">]>, #<Nokogiri::XML::Element:0x85fecf24 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fece48 name="href" value="http://bham.craigslist.org/web/2888669703.html">] children=[#<Nokogiri::XML::Text:0x85feca10 "Freelance Graphic Design">]>, #<Nokogiri::XML::Element:0x85fec8a8 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fec7cc name="href" value="http://bham.craigslist.org/web/2900256461.html">] children=[#<Nokogiri::XML::Text:0x85fec394 "GWT/GXT Developer">]>, #<Nokogiri::XML::Element:0x85fec22c name="a" attributes=[#<Nokogiri::XML::Attr:0x85fec150 name="href" value="http://bham.craigslist.org/web/2897641463.html">] children=[#<Nokogiri::XML::Text:0x85febd18 "Website hiring!">]>]} 
```

这是输出的完整值`i`：

```
--------------------
This is the value of i: 
[nil, [#<Nokogiri::XML::Element:0x85fee914 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fee838 name="href" value="http://bham.craigslist.org/web/2961573018.html">] children=[#<Nokogiri::XML::Text:0x85fee400 "Web Designer Full time">]>, #<Nokogiri::XML::Element:0x85fee298 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fee1bc name="href" value="http://bham.craigslist.org/web/2959813303.html">] children=[#<Nokogiri::XML::Text:0x85fedd84 "Once in a lifetime opportunity...">]>, #<Nokogiri::XML::Element:0x85fedc1c name="a" attributes=[#<Nokogiri::XML::Attr:0x85fedb40 name="href" value="http://bham.craigslist.org/web/2925485723.html">] children=[#<Nokogiri::XML::Text:0x85fed708 "Website Designer and Blogging Internship!">]>, #<Nokogiri::XML::Element:0x85fed5a0 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fed4c4 name="href" value="http://bham.craigslist.org/web/2918424652.html">] children=[#<Nokogiri::XML::Text:0x85fed08c "Excellent Java Developer Opportunity!">]>, #<Nokogiri::XML::Element:0x85fecf24 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fece48 name="href" value="http://bham.craigslist.org/web/2888669703.html">] children=[#<Nokogiri::XML::Text:0x85feca10 "Freelance Graphic Design">]>, #<Nokogiri::XML::Element:0x85fec8a8 name="a" attributes=[#<Nokogiri::XML::Attr:0x85fec7cc name="href" value="http://bham.craigslist.org/web/2900256461.html">] children=[#<Nokogiri::XML::Text:0x85fec394 "GWT/GXT Developer">]>, #<Nokogiri::XML::Element:0x85fec22c name="a" attributes=[#<Nokogiri::XML::Attr:0x85fec150 name="href" value="http://bham.craigslist.org/web/2897641463.html">] children=[#<Nokogiri::XML::Text:0x85febd18 "Website hiring!">]>]]
--------------------
This is the value of i.href: 
```

**编辑2：**

顺便说一句，这就是实际的 HTML 输出的样子……我这样做了：

```
builder = Nokogiri::HTML::Builder.new do |doc|
    doc.html {
        doc.body {
            contents.each do |el|
                if !el.nil?
                    puts "-" * 20
                    puts "This is the value of el: "
                puts el.inspect

                    puts "-" * 20
                    puts "This is the value of el.href: "           
                 puts el[:href]
                end

                doc.p {
                    doc.a el, :href => el
                    } 
            end     
            }           
        }
end

puts "*" * 50
puts "This is the HTML generated"

puts builder.to_html 
```

这是它的外观：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><p><a href="&lt;a%20href=%22http://bham.craigslist.org/web/2961573018.html%22&gt;Web%20Designer%20Full%20time&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2959813303.html%22&gt;Once%20in%20a%20lifetime%20opportunity...&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2925485723.html%22&gt;Website%20Designer%20and%20Blogging%20Internship!&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2918424652.html%22&gt;Excellent%20Java%20Developer%20Opportunity!&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2888669703.html%22&gt;Freelance%20Graphic%20Design&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2900256461.html%22&gt;GWT/GXT%20Developer&lt;/a&gt;&lt;a%20href=%22http://bham.craigslist.org/web/2897641463.html%22&gt;Website%20hiring!&lt;/a&gt;">&lt;a href="http://bham.craigslist.org/web/2961573018.html"&gt;Web Designer Full time&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2959813303.html"&gt;Once in a lifetime opportunity...&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2925485723.html"&gt;Website Designer and Blogging Internship!&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2918424652.html"&gt;Excellent Java Developer Opportunity!&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2888669703.html"&gt;Freelance Graphic Design&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2900256461.html"&gt;GWT/GXT Developer&lt;/a&gt;&lt;a href="http://bham.craigslist.org/web/2897641463.html"&gt;Website hiring!&lt;/a&gt;</a></p></body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T11:49:00.243

我认为它可以简单得多。Nokogiri 已经解析了文档并提供了访问内容的便捷方式。与其循环、存储 Nokogiri 对象，然后尝试提取它们，为什么不尝试更直接的方法呢？

试试这个代码：

```
content_page.search(//a[@href]).map{ |el| [el[:href], el.text] } 
```

这将为文档中的每个链接创建包含文本和 href 的 2d 数组，这就是您在实际正在努力的后续评论中所说的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:40:31.437

您可以使用 compact 删除 nil：

```
nodes.compact.each do |node|
  puts node[:href], node.text
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:30:02.513

也许是这样，因为你的数组中有一个奇怪的 nil 。

```
contents.each do |i|
  if !i.nil?
    puts i.inspect
    puts i[:href]
  end
end 
```

**Edit1**：其实我认为你只需要这样做`contents = contents[1]`。

```
contents = contents[1]
contents.each do |i|
    puts i.inspect
    puts i[:href]
end 
```

# php - 从 iOS 到 PHP 脚本的 SOAP 调用

> ID：10290116
> 
> 赞同：0
> 
> 时间：2012-04-24T00:19:53.343
> 
> 标签：php, objective-c, ios, soap

我目前正在构建一个简单的 iOS，它在我的服务器上调用一个名为“SoapTest.php”的 php 页面。我目前有一个测试函数，它接收一个名为“$x”的变量。我正在向这个函数发送一个请求，它可以接受一个变量。但是我遇到的问题是让函数接收一个以上的变量或发回一个或多个变量。

我知道这个 PHP 函数只能与一个变量 ($x) 一起使用，但它如何让它与多个变量一起使用。

这是我的 PHP 函数：

```
function test($x)
{
  return $x;
{ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:28:18.077

如果您只是想向函数添加变量，请执行以下操作：

```
function test($x, $y, $z)
{
  /*Do stuff here*/
  return $x;
{ 
```

这将接受 3 个变量，`$x`, `$y`, `$z`。然后，您将可以访问所有 3

# tinymce - 如何防止tinymce从输入元素中剥离'style'属性？

> ID：10290121
> 
> 赞同：6
> 
> 时间：2012-04-24T00:20:20.987
> 
> 标签：tinymce

我一直在阅读官方文档和博客文章以及 SO 几个小时，肯定会在某个地方发布答案......但没有运气。

似乎没有多少摆弄任何配置。阻止 tinymce 在我的输入/提交`<p>`元素上剥离内联“样式”属性。我需要所有输入元素的“样式”属性..但我只是从测试开始，`<p>`甚至让它工作。

*   tinymce 版本 3.5b3

这是我的配置的最新迭代。（在许多变化/尝试中）：

```
tinyMCE.init({
    mode : "textareas",
    theme : "advanced",

    plugins : "emotions,spellchecker,advhr,insertdatetime,preview,paste,table,media,directionality,style,xhtmlxtras,nonbreaking,pagebreak", 

    theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,formatselect,fontselect,fontsizeselect",
    theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
    theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,ltr,rtl",
    theme_advanced_buttons4 : "styleprops,|,cite,abbr,acronym,del,ins,attribs,|,nonbreaking,pagebreak",

    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom",
    theme_advanced_resizing : true,

    doctype : "<!DOCTYPE html>",

    convert_urls : false,

    //template_external_list_url : "gen4tinymce/lists/template_list.js",
    external_link_list_url : "gen4tinymce/lists/link_list.js",
    //media_external_list_url : "gen4tinymce/lists/media_list.js",

    valid_elements : "@[id|class|style|title|dir<ltr?rtl|lang|xml::lang],"
    + "a[rel|rev|charset|hreflang|tabindex|accesskey|type|"
    + "name|href|target|title|class],strong/b,em/i,strike,u,"
    + "#p[style],-ol[type|compact],-ul[type|compact],-li,br,img[longdesc|usemap|"
    + "src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,"
    + "-blockquote,-table[border=0|cellspacing|cellpadding|width|frame|rules|"
    + "height|align|summary|bgcolor|background|bordercolor],-tr[rowspan|width|"
    + "height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,"
    + "#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor"
    + "|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,-div,"
    + "-span,-code,-pre,address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face"
    + "|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],"
    + "object[classid|width|height|codebase|*],param[name|value|_value],embed[type|width"
    + "|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,"
    + "button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|"
    + "valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],"
    + "input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],"
    + "kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],"
    + "q[cite],samp,select[disabled|multiple|name|size],small,"
    + "textarea[cols|rows|disabled|name|readonly],tt,var,big",

    extended_valid_elements : "p[style]",
    inline_styles : true,
    verify_html : false
}); 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T03:07:05.787

正如 Thariama 所指出的，tinymce 没有错……但我不知道所有 CodeIgniter`$config['global_xss_filtering'] = TRUE;`在做什么。如果您发现您遇到同样的问题，这就是我的解决方法；请在此处查看： [Codeigniter - 基于帖子禁用 XSS 过滤](https://stackoverflow.com/questions/3788476/codeigniter-disable-xss-filtering-on-a-post-basis)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T07:20:18.557

[这个小提琴](http://fiddle.tinymce.com/Zvbaab/2)表明您的 tinymce 配置绝对完美：所有元素都允许样式属性，它不会被剥离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T00:45:02.110

你可以尝试一个ajax请求，像这样

```
$("#submit").click(function(e) {
    ie8SafePreventEvent(e);
    var form_data = $("#form").serialize();
    var content = $.base64.encode(tinyMCE.activeEditor.getContent());
    $.ajax({
        type: "POST",
        url: "/your/post/processor",
        data: form_data + "&coded_content=" + content,
        success: function(return_msg){
            do_something
            },
        error: function(){
            alert("Sorry, we got an error, try later");
            }
        });
    }); 
```

显然在你的控制器中你必须base64decode ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-25T11:26:04.723

我也在使用 CodeIgniter，虽然我确实设置`$config['global_xss_filtering'] = false;`了样式属性，但我仍然遇到了问题。因此，如果没有一个解决方案适合您，您可以尝试在提交时将 tinyMCE 数据编码为 base64 并使用 Javascript 将其放置在隐藏字段中：

```
$('#hiddenField').val(window.btoa(tinyMCE.get('tinyMCEtextareaID').getContent())); 
```

这样您就可以保留原始字符串，并且可以使用以下方法在 PHP 中轻松解码：

```
$htmlstring = base64_decode($_POST['hiddenField']); 
```

# jsf - 带有 Glassfish 3.1 的 MyFaces JSF impl 无法正常工作

> ID：10290123
> 
> 赞同：3
> 
> 时间：2012-04-24T00:20:27.187
> 
> 标签：jsf, jsf-2, glassfish, myfaces

我尝试使用 Glassfish 使用 JSF 2 的 MyFaces impl，但我无法这样做。我在项目中添加了以下 jar：

*   commons-beautils-1.8.3.jar
*   commos-codec-1.3.jar
*   commons-collections-3.2.jar
*   commons-digester-1.8.jar
*   commons-logging-1.1.1.jar
*   myfaces-api-2.1.7.jar
*   myfaces-bundle-2.1.7.jar **编辑**根据 BalusC 的回答删除了这个 jar
*   myfaces-impl-2.1.7.jar

我还将文件 glassfish-web.xml 添加到 WEB-INF 中，内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE glassfish-web-app PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN" "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd">
<glassfish-web-app error-url="">
  <class-loader delegate="true"/>
  <property name="useBundledJsf" value="true"/>
  <jsp-config>
    <property name="keepgenerated" value="true">
      <description>Keep a copy of the generated servlet class' java code.</description>
    </property>
  </jsp-config>
</glassfish-web-app> 
```

**编辑**
根据 BalusC 的回答，我删除了 myfaces-bundle-2.1.7.jar，现在我得到以下异常：

```
GRAVE: PWC1305: Exception during cleanup after start failed
org.apache.catalina.LifecycleException: PWC2769: Manager has not yet been started
    at org.apache.catalina.session.StandardManager.stop(StandardManager.java:873)
    at org.apache.catalina.core.StandardContext.stop(StandardContext.java:5571)
    at com.sun.enterprise.web.WebModule.stop(WebModule.java:527)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5384)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2018)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)

GRAVE: ContainerBase.addChild: start: 
org.apache.catalina.LifecycleException: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5389)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2018)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
    at javax.faces.FactoryFinder$FactoryManager.getFactory(FactoryFinder.java:1008)
    at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:343)
    at org.apache.myfaces.context.servlet.FacesContextImplBase.getApplication(FacesContextImplBase.java:159)
    at org.apache.myfaces.context.servlet.FacesContextImplBase.getELContext(FacesContextImplBase.java:210)
    at javax.faces.component.UIViewRoot.setLocale(UIViewRoot.java:1463)
    at org.apache.myfaces.webapp.AbstractFacesInitializer._createFacesContext(AbstractFacesInitializer.java:462)
    at org.apache.myfaces.webapp.AbstractFacesInitializer.initStartupFacesContext(AbstractFacesInitializer.java:434)
    at org.apache.myfaces.webapp.StartupServletContextListener.contextInitialized(StartupServletContextListener.java:113)
    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:4750)
    at com.sun.enterprise.web.WebModule.contextListenerStart(WebModule.java:550)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5366)
    ... 39 more

ADVERTENCIA: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:921)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2018)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)

GRAVE: Exception while invoking class com.sun.enterprise.web.WebApplication start method
java.lang.Exception: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:138)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)

GRAVE: Exception while loading the app
GRAVE: Exception while loading the app : java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T15:27:37.243

问题来自 glassfish-web.xml 中的这一行：

```
<class-loader delegate="true"/> 
```

该属性应该是**false**。改完之后就开始工作了。glassfish-web.xml 应该是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE glassfish-web-app PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN" "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd">
<glassfish-web-app error-url="">
  <class-loader delegate="false"/>
  <property name="useBundledJsf" value="true"/>
</glassfish-web-app> 
```

这对于 Web 应用程序来说似乎已经足够了。然后我尝试将其与企业应用程序一起使用。在那种情况下，我仍然遇到同样的异常。然后我意识到在对项目进行了清理和构建之后；myfaces jar 不包含在 WEB-INF/lib 文件夹中。仅包含 myfaces-impl-2.1.7（其他 6 个罐子丢失）。我不知道为什么会这样。
我可以通过在 WEB-INF 中手动添加一个“lib”文件夹并将所有 myfaces jar 放在那里来修复它；而不是使用 Properties -> Libraries 添加它们

关于 BalusC 的答案，如果 myfaces-impl 和 myfaces-api 也包含在内，则不应包含 myfaces-bundle-2.1.7.jar 是正确的（感谢提示）；但它不会导致描述的异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T02:51:19.560

不完全确定这是否是您的具体问题的原因，但您的 web 应用程序中有重复的 MyFaces API/impl 库。它可能彼此冲突。

JAR`myfaces-bundle`文件同时**包含**和.`myfaces-api``myfaces-impl`

您应该只使用一个 JAR 文件，*或者*只使用两个 JAR 文件*和*. *因此，*您需要删除捆绑 JAR 文件*或*两个松散的 JAR 文件。`myfaces-bundle`*`myfaces-api``myfaces-impl`*

# dropbox - 如何在不离开网页的情况下验证 Dropbox 应用并使用 API？

> ID：10290125
> 
> 赞同：5
> 
> 时间：2012-04-24T00:20:45.990
> 
> 标签：dropbox, dropbox-api, authentication

我需要用户授予我的应用访问他们的 Dropbox 的权限，但我非常希望他们不必离开我的网站然后再回来。我知道的身份验证 API 要求用户登录到他们的 Dropbox 帐户，并且他们在 Dropbox 网站上对应用程序进行身份验证。

有没有办法解决这个问题？

- 编辑 -

所以我知道我们可以使用 Google/Facebook 的身份验证 API，以便提示用户在同一窗口内允许/拒绝该应用程序（这样做）。如果我们可以用 Dropbox API 做这样的事情，那就太棒了。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:56:37.610

Dropbox API 目前确实要求通过 Dropbox 站点使用 OAuth 处理授权。您可以使用“oauth_callback”参数在授权后将用户重定向回您的站点。此处的文档： [https ://www.dropbox.com/developers/reference/api#authorize](https://www.dropbox.com/developers/reference/api#authorize)

您甚至可以在整个过程的单个选项卡中使用它（这就是 StackOverflow 与 Google 登录似乎所做的事情。）也就是说，将用户的当前页面重定向到授权页面，并使用 'oauth_callback' 参数和必要的操作/信息返回到您的站点并指示用户从授权中返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T08:40:23.857

使用 iframe。

在 iframe 中打开 Oauth。将重定向设置为 iframe_done.html

当 iframe_done.html 加载时，它将与您的主页是同一个域，因此它可以在 iframe 之外进行通信，只需获取您刚刚收到的密钥并将其传递给父级，父级将使用该密钥并关闭iframe，给人的印象是这一切都发生在那里。

# javascript - 用它的宽度替换div高度（jquery）

> ID：10290127
> 
> 赞同：0
> 
> 时间：2012-04-24T00:21:18.117
> 
> 标签：javascript, jquery, css

我正在使用一个脚本来自动创建我的 div 的宽度，以使它们适合页面的宽度。我想要身高匹配。

我希望有一个 jquery 解决方案可以读取宽度并使其成为高度。

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:22:52.960

对于单个 div：

```
$("#mydiv").css("height", $("#mydiv").css("width")); 
```

对于多个 div：

```
$("div").each(function() {
    $(this).css("height", $(this).css("width"));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:29:10.130

使用[css](http://api.jquery.com/css)：

```
​$("my_selector").css("height", function() { 
    return $(this).width();
}); 
```

**示例：http:** [//jsfiddle.net/REsfs/](http://jsfiddle.net/REsfs/)

# ruby-on-rails - 基准旧铁轨应用 2.3.5

> ID：10290128
> 
> 赞同：1
> 
> 时间：2012-04-24T00:21:24.460
> 
> 标签：ruby-on-rails

是否有可以基准测试或检查哪些页面使我的应用程序变慢并导致 CPU 使用率高的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:29:53.630

试试[子弹](https://github.com/flyerhzm/bullet)。这是一个用于杀死 N+1 查询和未使用的急切加载的 Rails 插件/宝石。

# ios - 删除适当的图像

> ID：10290138
> 
> 赞同：1
> 
> 时间：2012-04-24T00:22:35.940
> 
> 标签：ios, objective-c, uiimageview

所以我几乎完成了一个应该表现得像照片库的应用程序。尽管尝试正确删除照片，但我遇到了新手问题。所以，我有 3 个 UIImageViews。图像存储在 NSMutableArray 中，并在启动时从其中加载。他们删除并完美保存。但是，如果我要删除 UIImageView #2 中的图像，然后关闭并重新启动应用程序，则 UIImageView #3 中的图像会滑入 #2 的位置。一切都很好，直到我尝试删除 #2 位置的图像或 #2 之上的任何图像。

我根据名称删除照片，因此如果我尝试删除 UIImageView #2 中的照片，我的代码将搜索 Image2.png 并将其删除。但是，现在当我重新启动应用程序时，UIImageView #3 位于 #2 的位置，所以当我尝试删除 UIImageView #3 时，它不会删除，因为它正在寻找不再存在的 Image2.png。该位置的文件名为 Image3.png。所以，我有点不知所措，不知道如何编辑我的代码来解决这个问题。这是我正在使用的当前代码，这里的罪魁祸首是`NSString *filePath = [documentsPath stringByAppendingPathComponent:[NSString stringWithFormat:@"Image%i.png",view.tag]];`. （我已经标记了每个 UIImageView 并基于此删除）：

```
- (IBAction)deleteButtonPressed:(id)sender {
    UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                              message:@"Are you sure you want to delete this photo?"
                                                             delegate:self
                                                    cancelButtonTitle:@"No"
                                                    otherButtonTitles:@"Yes", nil];
    [deleteAlertView show];

    int imageIndex = ((UIButton *)sender).tag;
    deleteAlertView.tag = imageIndex;
}

- (UIImageView *)viewForTag:(NSInteger)tag {
    UIImageView *found = nil;
    for (UIImageView *view in self.array) {
        if (tag == view.tag) {
            found = view;
            break;
        }
    }
    return found;
}

- (void)alertView: (UIAlertView *) alertView 
clickedButtonAtIndex: (NSInteger) buttonIndex
{

    if (buttonIndex != [alertView cancelButtonIndex]) {

        UIImageView *view = [self viewForTag:alertView.tag];
        if (view) {

            [self.array removeObject:view];

            NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);  
            NSString *documentsPath = [paths objectAtIndex:0];
            NSString *filePath = [documentsPath stringByAppendingPathComponent:[NSString stringWithFormat:@"Image%i.png",view.tag]];
            NSFileManager *fileManager = [NSFileManager defaultManager];

            NSError *error;

            [fileManager removeItemAtPath:filePath error:&error];

            if (error)
                NSLog(@"Error: %@",error);

        }
        ((UIImageView *)[self.view viewWithTag:alertView.tag]).image =nil;
    }   
    [self.user setObject:self.array forKey:@"images"];
} 
```

这是我的完整 .m 文件仅供参考： [https ://github.com/Joey502/Test-Thing/wiki/.m-Class-File](https://github.com/Joey502/Test-Thing/wiki/.m-Class-File)

如果有人知道如何解决这个问题，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:37:16.090

您想要做的是创建另一个`NSMutableArray`，调用它`fileNamesArray`来存储与`UIImageView`存储在您的`self.array`.

启动应用程序时，您应该在将s添加到的同时存储每个文件名 ( `NSString`s) 。然后，在您的删除功能中，当您从目录中删除对象并将其删除时，您还应该从. 因此，一旦从两个数组中删除了对象，它们都将移动相同的数量，并且每个文件名将对应于正确的图像视图。`self.fileNamesArray``UIImageView``self.array``UIImageView``self.array``self.fileNamesArray`

补充一点：删除图像时，您应该使用 的`tag`从中`sender`检索文件名，`self.fileNamesArray`然后使用该文件名删除物理文件，然后将其从阵列中删除（与图像视图一起）。这是您的删除功能应该是什么样的示例：

```
if (view) {
    [self.array removeObject:view]; //or you could do [self.array removeObjectAtIndex:alertView.tag];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);  
    NSString *documentsPath = [paths objectAtIndex:0];

    NSString *filePath = [documentsPath stringByAppendingPathComponent:[self.fileNamesArray objectAtIndex:alertView.tag]];
    NSFileManager *fileManager = [NSFileManager defaultManager];

    NSError *error;

    [fileManager removeItemAtPath:filePath error:&error];

    if (error)
        NSLog(@"Error: %@",error);

    [self.fileNamesArray removeObjectAtIndex: alertView.tag];
} 
```

**更新以解决评论中提出的问题：**

1.  在您的`applicationDidEnterBackground`方法中，您将`self.array`再次添加所有图像视图。如果数组不为空怎么办？然后你只是添加不需要的项目。在这个方法中你唯一需要的就是最后两行。

2.  在您的`viewDidLoad`方法中，您应该将`fileName`字符串添加到`self.fileNamesArray`，但您已经添加了`imageView`. 删除将图像视图添加到此数组的所有行，然后`UIImage *loadedImage = [UIImage imageWithContentsOfFile:fullPath];`添加此行`[self.fileNamesArray addObject:fileName];`

3.  在您的删除函数中，此行缺少两个括号：`NSString *filePath = [documentsPath stringByAppendingPathComponent:[self.fileNamesArray objectAtIndex:alertView.tag;`. 应该是`NSString *filePath = [documentsPath stringByAppendingPathComponent:[self.fileNamesArray objectAtIndex:alertView.tag]];`。我想知道这是否是您的整个目录被删除的原因。

4.  不要忘记，当您使用图像选择器添加图像时，您还应该将文件名添加到`fileNamesArray`您的选择器委托方法中（以正确的顺序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:25:14.603

检查您对 self.array 的使用。有时您使用它来存储/检索 UIImageView，其他地方您正在存储/检索图像视图中的图像。

如果您尝试将 self.array 用于两个不同的目的，那么您需要在切换目的时释放并分配一个新的，或者在切换到另一个目的之前删除所有当前内容。

# .net - VB.NET 应用程序无法执行 SSIS 包，出现 COM 错误

> ID：10290143
> 
> 赞同：1
> 
> 时间：2012-04-24T00:23:26.407
> 
> 标签：.net, sql-server-2008, ssis

我在尝试执行 SSIS 包的 VB.NET 应用程序时遇到问题。我有一个数据库服务器和一个应用程序服务器。两者都在同一个域中，彼此完全可见，网络明智。DB 正在运行 SQL2008 R2，应用程序安装了 SSIS 2008 R2。两台服务器都应用了 SQL2008 R2 SP1。

我的应用程序（自然会在我的开发工具箱上运行）包含一个 SSIS 包，该包作为 .dtsx 文件包含在与可执行文件相同的文件夹中。在运行时，使用作为参数传入的连接字符串来加载和执行包。我已经毫无疑问地验证了这个连接字符串。

错误如下：

> 由于以下错误，检索具有 CLSID {E80FE1DB-D1AA-4D6B-BA7E-040D424A925C} 的组件的 COM 类工厂失败：80040154。

数据库和应用服务器都安装了客户端连接和向后兼容工具。我的一些研究建议在 \binn 文件夹中的 DTS.DLL 文件上运行 REGSVR32。成功注册文件，但它没有改变结果。

我真的被这个难住了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T13:30:56.300

事实证明，该应用程序已根据 SQL2005 ManagedDTS.dll 的引用进行编译，并且正在部署到 SQL 2008 环境中。类 ID 不同。如果您在 .NET 应用程序中遇到此问题，请检查引用并确认您对 ManagedDTS.DLL 的引用使用的是与您的生产环境匹配的 DLL 版本。

# css - 有菜单按钮居中的 CSS 下拉菜单

> ID：10290145
> 
> 赞同：0
> 
> 时间：2012-04-24T00:23:35.433
> 
> 标签：css, css-float, center

我正在使用这个 css 来设置我的菜单样式。menu`li`的当前设置为`float: left`显然将它们定位在左侧，但是我真的希望它们位于中间。

**有人可以帮我修改这个吗？**

```
.menu{

border:none;
border:0px;
margin:0px;
padding:0px;
font: 67.5% "Lucida Sans Unicode", "Bitstream Vera Sans", "Trebuchet Unicode MS", "Lucida Grande", Verdana, Helvetica, sans-serif;
font-size:14px;
font-weight:bold;
}
.menu ul{

background:#6991B7;
height:35px;
list-style:none;
margin:0;
padding:0;

}
.menu li{

    float:left;
    padding:0px;

    }
.menu li a{
    background:#6991B7 url("images/seperator.gif") bottom right no-repeat;
    color:#FFF;
    display:block;
    font-weight:normal;
    line-height:35px;
    margin:0px;
    padding:0px 25px;
    text-align:center;
    text-decoration:none;
    }
    .menu li a:hover, .menu ul li:hover a{
        background: #2580a2 url("images/hover.gif") bottom center no-repeat;
        color:#FFFFFF;
        text-decoration:none;
        }
.menu li ul{
    background:#333333;
    display:none;
    height:auto;
    padding:0px;
    margin:0px;
    border:0px;
    position:absolute;
    width:225px;
    z-index:200;
    /*top:1em;
    /*left:0;*/
    }
.menu li:hover ul{
    display:block;

    }
.menu li li {
    background:url('images/sub_sep.gif') bottom left no-repeat;
    display:block;
    float:none;
    margin:0px;
    padding:0px;
    width:225px;
    }
.menu li:hover li a{
    background:none;

    }
.menu li ul a{
    display:block;
    height:35px;
    font-size:12px;
    font-style:normal;
    margin:0px;
    padding:0px 10px 0px 15px;
    text-align:left;
    }
    .menu li ul a:hover, .menu li ul li:hover a{
        background:#2580a2 url('images/hover_sub.gif') center left no-repeat;
        border:0px;
        color:#ffffff;
        text-decoration:none;
        }
.menu p{
    clear:left;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T07:07:30.520

嘿，我认为您希望您的导航显示中心检查此代码我在您的 css 代码中进行了一些修改

```
1\. text-align:center put to .menu css
2\. .menu li, .menu li a define to display:inline-block;
3\. .menu ul define margin: 0 auto; and overflow:hidden; 
```

**CSS**

```
 .menu{

border:none;
border:0px;
margin:0px auto;
padding:0px;
font: 67.5% "Lucida Sans Unicode", "Bitstream Vera Sans", "Trebuchet Unicode MS", "Lucida Grande", Verdana, Helvetica, sans-serif;
font-size:14px;
font-weight:bold;
    text-align:center;
}
.menu ul{

background:#6991B7;
height:35px;
list-style:none;
margin:0 auto;
padding:0;
    overflow:hidden;

}
.menu li{

    display:inline-block;
    padding:0px;

    }
.menu li a{
    background:#6991B7 url("images/seperator.gif") bottom right no-repeat;
    color:#FFF;
    display:inline-block;
    font-weight:normal;
    line-height:35px;
    margin:0px;
    padding:0px 25px;
    text-decoration:none;
    }
    .menu li a:hover, .menu ul li:hover a{
        background: #2580a2 url("images/hover.gif") bottom center no-repeat;
        color:#FFFFFF;
        text-decoration:none;
        }
.menu li ul{
    background:#333333;
    display:none;
    height:auto;
    padding:0px;
    margin:0px;
    border:0px;
    position:absolute;
    width:225px;
    z-index:200;
    /*top:1em;
    /*left:0;*/
    }
.menu li:hover ul{
    display:block;

    }
.menu li li {
    background:url('images/sub_sep.gif') bottom left no-repeat;
    display:block;
    float:none;
    margin:0px;
    padding:0px;
    width:225px;
    }
.menu li:hover li a{
    background:none;

    }
.menu li ul a{
    display:block;
    height:35px;
    font-size:12px;
    font-style:normal;
    margin:0px;
    padding:0px 10px 0px 15px;
    text-align:left;
    }
    .menu li ul a:hover, .menu li ul li:hover a{
        background:#2580a2 url('images/hover_sub.gif') center left no-repeat;
        border:0px;
        color:#ffffff;
        text-decoration:none;
        }
.menu p{
    clear:left;
    } 
```

**HTML**

```
<div class="menu">
<ul>
    <li><a href="#">Demo link</a></li>
    <li><a href="#">Demo link</a></li>
    <li><a href="#">Demo link</a></li>
    <li><a href="#">Demo link</a></li>
    <li><a href="#">Demo link</a></li>
    <li><a href="#">Demo link</a></li>
</ul>
</div> 
```

现场演示[http://jsfiddle.net/rohitazad/g3hLK/1/](http://jsfiddle.net/rohitazad/g3hLK/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:38:38.890

尝试设置`margin: 0 auto;`。`.menu li a`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:44:33.890

您可以改为声明您的菜单`li`元素`display:inline-block`，然后使用如下`text-align:center`属性让您的菜单容器自动居中它们：

```
.menu{
    border:none;
    border:0px;
    margin:0px;
    padding:0px;
    font: 67.5% "Lucida Sans Unicode", "Bitstream Vera Sans", "Trebuchet Unicode MS", "Lucida Grande", Verdana, Helvetica, sans-serif;
    font-size:14px;
    font-weight:bold;
    text-align:center;
}

.menu li{
    display:inline-block;
    *display:inline; /* ie7 fix */
    padding:0px;
} 
```

# ruby-on-rails - Rails：有没有干的方法来定义影响嵌套资源/模型的方法？

> ID：10290146
> 
> 赞同：0
> 
> 时间：2012-04-24T00:23:38.263
> 
> 标签：ruby-on-rails, methods, dry, nested-resources

只是想知道是否有更好的方法来执行以下操作：

用户 has_many 项目

项目 has_many 列表

列出 has_many 项

某些用户只能访问某些项目。但是，如果用户有权访问某个项目，则该用户可以访问属于该项目的所有列表和项目。

这是我要清理的方法：

```
def check_for_user_access(resource, resource_class, user)
  case resource_class
    when 'Project'
      if resource.user == user
        return true
      end
    when 'List'
      if resource.project.user == user
        return true
      end
    when 'Item'
      if resource.list.project.user == user
        return true
      end
    else
      return false
  end
end 
```

我不想要 List 和 Item 中的 user_id 属性，因为访问实际上只是与 Project 相关联。

有没有比使用 switch 语句来环绕略有不同的比较更好的方法呢？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:41:55.187

也许更简单的方法是定义一个allow_access？每个资源类的方法——那么控制器所要做的就是询问资源是否允许用户进入。例如：

```
class Project < ActiveRecord::Base #I assume
  def allow_access?(user)
    return self.user == user
  end
end

class List < ActiveRecord::Base
  def allow_access?(user)
    return self.project.user == user
  end
end

class Item < ActiveRecord::Base
  def allow_access?(user)
    return self.list.project.user == user
  end
end 
```

并且，可以选择在您的用户模型中放置一个包装器：

```
class User < ActiveRecord::Base
  def can_access?(resource)
    resource.allow_access?(self)
  end
end 
```

然后你的方法可以替换为

```
user.can_access?(resource) 
```

如果您想稍微收紧一点，您的用户模型可以检查资源是否响应 allow_access？如果没有，则做出适当的反应……</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:40:50.113

两件事情：

1）鉴于您的情况，我会考虑`belongs_to :user`在列表和项目上添加一个，因为看起来它们只能属于一个用户。

在您的列表和项目模型中复制此内容不会有任何损害，并且它会为您提供一种非常简单的方法来查看应用程序中的任何给定对象属于谁。

2）你应该看看[CanCan](https://github.com/ryanb/cancan)。这是一个非常简单且轻量级的授权库，旨在规范对您正在处理的事物的访问。

# asp.net-mvc - 实体一对多数据库

> ID：10290147
> 
> 赞同：0
> 
> 时间：2012-04-24T00:23:39.503
> 
> 标签：asp.net-mvc, entity-framework, one-to-many

我有一个关于第一个对多个数据库实现实体代码的基本问题。我有两个模型，文章和评论是这样的：

```
public class Article
    {
    public int Id { get; set; }

    public virtual ICollection<Comment> Comments { get; set; }
....

 public class Comment
{
    public int Id { get; set; }

    public virtual Article CommentForArticle { get; set; }

    public DateTime TimeStamp { get; set; 
.... 
```

如果我尝试将评论添加到数据库（使用包含文章的 Comment.CommentForArticle）评论被添加到数据库中，但文章的评论集合中不包含评论。

但是，如果我创建评论并将其添加到文章中，一切正常。我不必将评论添加到数据库中，它是自动添加的（我猜。）

我在尝试实现此问题后遇到问题（错误，例如：违反多重性约束）所以我的问题是，我现在这样做是否正确，为什么必须这样做，而不是将注释添加到 Db 而是添加到包含评论的文章。您能否分享任何可以帮助我更好地理解实体框架如何处理一对多和多对多关系的链接。

谢谢，加勒特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:28:24.523

如果存在“有”关系，我更愿意将新项目添加到所有者的收藏中。在你的情况下，`Article` *有* `Comment`s，所以我会在 article.Comments 中添加一个新的评论。

除了继承之外，“是”关系也是可能的。假设你有`ArticleType`实体和属性`article.ArticleType`。在这种情况下，我宁愿设置属性。我什`ArticleType`至不想拥有`Articles`导航属性。

在“纯”多对多的情况下（即当连接表未映射为其自己的实体类型时），除了将项目添加到所有者的集合中之外，别无选择。

目前尚不清楚你为什么有*问题后出现问题*。是因为你混合了这两种方法吗？（向数据库添加评论并在文章中添加相同的评论）。

作为参考：一系列精彩的文章从[这里](http://weblogs.asp.net/manavi/archive/2011/03/27/associations-in-ef-4-1-code-first-part-1-introduction-and-basic-concepts.aspx)开始。它专注于更复杂的场景，但不难找到对常规案例的引用。

# python - google appengine (python) 的基本 html 映射或 url 重写

> ID：10290149
> 
> 赞同：3
> 
> 时间：2012-04-24T00:23:59.247
> 
> 标签：python, google-app-engine, url-rewriting, url-routing, friendly-url

我正在尝试为 Google Appengine 上的静态网站重写网址。我只想要 [http://www.abc.com/about](http://www.abc.com/about)对于[http://www.abc.com/about.html](http://www.abc.com/about.html) 我不需要重写 abc.com/page?=1 之类的东西。我只是想弄清楚如何显式地重写 html 页面的 url。

我目前正在使用的代码（不起作用） -

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp import util
from google.appengine.ext.webapp import template
import os

class MainHandler(webapp.RequestHandler):
    def get(self):
        template_values = {}

        path = os.path.join(os.path.dirname(__file__), 'index.html')
        self.response.out.write(template.render(path, template_values))

class PostHandler(webapp.RequestHandler):
    def get(self, slug):
        template_values = {}
        post_list =  { 
            'home' : 'index.html',
            'portfolio' : 'portfolio.html',            
            'contact' : 'contact.html',
            'about' : 'about.html'
        }

        if slug in post_list:
            self.response.out.write('Slugs not handled by C-Dan yet')
        else:
            self.response.out.write('no post with this slug')

def main():
    application = webapp.WSGIApplication([('/', MainHandler),('/(.*)', PostHandler)], debug=True)
    util.run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:16:27.153

对于您的构造函数，您需要：

```
def main():
  application = webapp.WSGIApplication([
    ('/', MainHandler),
    ('/portfolio/', Portfolio),
    ('/contact/', Contant),
    ('/about/', About)
    ])
  util.run_wsgi_app(application) 
```

这意味着任何时候有人访问[http://www.abc.com/about/](http://www.abc.com/about/)，他们都会被“路由”到您的 About 处理程序。

然后你必须制作一个 About 处理程序。

```
class About(webapp.RequestHandler):
  def get(self):
    self.response.out.write(template.render('about.html', None)) 
```

我不熟悉您的编码风格，但我向您展示的内容在我所有的项目中都为我工作。

# python - Django 对象日志

> ID：10290151
> 
> 赞同：0
> 
> 时间：2012-04-24T00:24:08.540
> 
> 标签：python, django

我有一个 Django 应用程序，我正在向它添加一个 Django 日志对象。基于此文档：

[https://code.osuosl.org/projects/django-object-log/wiki/Usage#Registering-Action-Types](https://code.osuosl.org/projects/django-object-log/wiki/Usage#Registering-Action-Types)

[http://pypi.python.org/pypi/django-object-log/0.6#downloads](http://pypi.python.org/pypi/django-object-log/0.6#downloads)

我正在为动作类型创建模板。我应该在哪里插入以下 html 代码？

```
 {# sample template for MY_EVENT #}
 {{log_item.user.username}} did something interesting to {{log_item.object1}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:55:48.260

它适用于您提供的模板`LogAction.objects.register`

# c# - Mono 和 appdomain 安全/权限集

> ID：10290154
> 
> 赞同：2
> 
> 时间：2012-04-24T00:24:25.900
> 
> 标签：c#, .net, mono, appdomain

我正在尝试了解 AppDomains - 和安全策略，但是我遇到了问题。

Mono 似乎没有服从我的权限，我正在尝试对 AppDomain 进行沙箱处理。

使用 .NET 它按预期运行 - 我收到安全权限错误，因为我完全没有设置权限。

在 Mono 下，它不会这样做。我尝试了 Mono-2.6 和 Mono-2.10.8，mono 只是运行程序而没有任何错误。

我用于 .NET 和单声道的 C# 代码：

```
namespace AppDomainTest
{
    class Program
    {
        private static AppDomain _domain;
        static void Main(string[] args)
        {
            AppDomainSetup info = new AppDomainSetup
            {
                ApplicationName = "AppDomainTest",
                ApplicationBase = Environment.CurrentDirectory,
            };

            PermissionSet permSet = new PermissionSet(PermissionState.None);
            //permSet.AddPermission(new SecurityPermission(SecurityPermissionFlag.Execution));
            // permSet.AddPermission(new FileIOPermission(PermissionState.Unrestricted));

            _domain = AppDomain.CreateDomain("TestDomain", null, info, permSet);

            TestObj o = (TestObj)_domain.CreateInstanceAndUnwrap(typeof(TestObj).Assembly.FullName, "AppDomainTest.TestObj");

            Console.WriteLine(o.GetDomainName());

        }
    }

    public class TestObj : MarshalByRefObject
    {
        public string GetDomainName()
        {
            return AppDomain.CurrentDomain.FriendlyName;
        }
    }
} 
```

我在这里做的事情有什么本质上的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T04:34:28.033

Mono 没有完全实现代码访问安全，

[http://www.mono-project.com/Todo](http://www.mono-project.com/Todo)

[http://tirania.org/blog/archive/2012/Apr-04.html](http://tirania.org/blog/archive/2012/Apr-04.html)

所以你不应该期望它在这方面像 .NET 一样工作。

# c# - 等待一个可观察的

> ID：10290156
> 
> 赞同：24
> 
> 时间：2012-04-24T00:24:53.883
> 
> 标签：c#, system.reactive, async-await, .net-4.5, c#-5.0

因此，在 C# 4.0 的悲惨日子里，我创建了以下“WorkflowExecutor”类，该类通过侵入 IEnumerable 的“yield return”延续以等待 observables 来允许 GUI 线程中的异步工作流。因此，以下代码将在 button1Click 处启动一个简单的工作流程，更新文本，等待您单击 button2，并在 1 秒后循环。

```
public sealed partial class Form1 : Form {
    readonly Subject<Unit> _button2Subject = new Subject<Unit>();
    readonly WorkflowExecutor _workflowExecutor = new WorkflowExecutor();

    public Form1() {
        InitializeComponent();
    }

    IEnumerable<IObservable<Unit>> CreateAsyncHandler() {
        Text = "Initializing";
        var scheduler = new ControlScheduler(this);
        while (true) {
            yield return scheduler.WaitTimer(1000);
            Text = "Waiting for Click";
            yield return _button2Subject;
            Text = "Click Detected!";
            yield return scheduler.WaitTimer(1000);
            Text = "Restarting";
        }
    }

    void button1_Click(object sender, EventArgs e) {
        _workflowExecutor.Run(CreateAsyncHandler());
    }

    void button2_Click(object sender, EventArgs e) {
        _button2Subject.OnNext(Unit.Default);
    }

    void button3_Click(object sender, EventArgs e) {
        _workflowExecutor.Stop();
    }
}

public static class TimerHelper {
    public static IObservable<Unit> WaitTimer(this IScheduler scheduler, double ms) {
        return Observable.Timer(TimeSpan.FromMilliseconds(ms), scheduler).Select(_ => Unit.Default);
    }
}

public sealed class WorkflowExecutor {
    IEnumerator<IObservable<Unit>> _observables;
    IDisposable _subscription;

    public void Run(IEnumerable<IObservable<Unit>> actions) {
        _observables = (actions ?? new IObservable<Unit>[0]).GetEnumerator();
        Continue();
    }

    void Continue() {
        if (_subscription != null) {
            _subscription.Dispose();
        }
        if (_observables.MoveNext()) {
            _subscription = _observables.Current.Subscribe(_ => Continue());
        }
    }

    public void Stop() {
        Run(null);
    }
} 
```

这个想法的聪明部分，使用“yield”延续来做异步工作，取自 Daniel Earwicker 的 AsyncIOPipe 想法：[http ://smellegantcode.wordpress.com/2008/12/05/asynchronous-sockets-with-yield- return-of-lambdas/](http://smellegantcode.wordpress.com/2008/12/05/asynchronous-sockets-with-yield-return-of-lambdas/)，然后我在其上添加了响应式框架。

现在我在使用 C# 5.0 中的异步功能重写它时遇到了麻烦，但它似乎应该是简单的事情。当我将 observables 转换为任务时，它们只运行一次，而 while 循环第二次崩溃。任何帮助解决这个问题都会很棒。

所有这些说/问，异步/等待机制给了我什么 WorkflowExecutor 没有？有什么我可以用 async/await 做的，而我不能用 WorkflowExecutor 做（给定类似数量的代码）？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-24T17:08:21.807

正如 James 所提到的，您可以等待从 Rx v2.0 Beta 开始的 IObservable<T> 序列。行为是返回最后一个元素（在 OnCompleted 之前），或者抛出观察到的 OnError。如果序列不包含任何元素，您将获得 InvalidOperationException。

请注意，使用它，您可以获得所有其他所需的行为：

*   通过等待 xs.FirstAsync() 获取第一个元素
*   通过等待 xs.SingleAsync() 确保只有一个值
*   当您对空序列没问题时，等待 xs.DefaultIfEmpty()
*   要获取所有元素，请等待 xs.ToArray() 或等待 xs.ToList()

您可以做更多花哨的事情，例如计算聚合结果，但使用 Do 和 Scan 观察中间值：

```
var xs = Observable.Range(0, 10, Scheduler.Default);

var res = xs.Scan((x, y) => x + y)
            .Do(x => { Console.WriteLine("Busy. Current sum is {0}", x); });

Console.WriteLine("Done! The sum is {0}", await res); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-24T02:19:32.907

正如您所注意到的，与 Observable 的“事件流”相反，Task 是一种一次性使用的东西。一个很好的思考方式（恕我直言）是[Rx 团队关于 2.0 Beta 的帖子](http://blogs.msdn.com/b/rxteam/archive/2012/03/12/reactive-extensions-v2-0-beta-available-now.aspx)上的 2x2 图表：

![任务与可观察的 2x2 图表](../Images/f9ec9e1c0264203f1b3fe28d4072bb9d.png)

根据情况（一次性与“事件流”），保持 Observable 可能更有意义。

如果您可以升级到 Reactive 2.0 Beta，那么您可以使用它来“等待”observables。例如，我自己对代码的“异步/等待”（近似）版本的尝试是：

```
public sealed partial class Form1 : Form
{
    readonly Subject<Unit> _button2Subject = new Subject<Unit>();

    private bool shouldRun = false;

    public Form1()
    {
        InitializeComponent();
    }

    async Task CreateAsyncHandler()
    {
        Text = "Initializing";
        while (shouldRun)
        {
            await Task.Delay(1000);
            Text = "Waiting for Click";
            await _button2Subject.FirstAsync();
            Text = "Click Detected!";
            await Task.Delay(1000);
            Text = "Restarting";
        }
    }

    async void button1_Click(object sender, EventArgs e)
    {
        shouldRun = true;
        await CreateAsyncHandler();
    }

    void button2_Click(object sender, EventArgs e)
    {
        _button2Subject.OnNext(Unit.Default);
    }

    void button3_Click(object sender, EventArgs e)
    {
        shouldRun = false;
    }
} 
```

# python - 简单的。*调用* python中的函数。如何解决退货问题？

> ID：10290157
> 
> 赞同：1
> 
> 时间：2012-04-24T00:24:57.970
> 
> 标签：python, function, return, call

看这个简单的代码：

```
$ python
>>> from subprocess import *  
>>> call(['echo','Hi'])
Hi
0 
```

我的问题看起来很简单。我不希望在通话结束时出现这个**0 。****call 调用**的每个函数都会出现 this ，这会弄乱条件测试的内容。

就像是：

```
if int(call(['function', 'parameter']))>10:
    print 'yes' 
```

那么我怎样才能收到只有

```
Hi 
```

在这个例子中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:27:25.163

您看到的值是`echo`进程的返回值。因为你在一个活跃的解释器中，所以这个返回值被打印到终端。您可以通过将其分配给虚拟变量来忽略它：

```
_ = call(['echo','Hi']) 
```

* * *

只要确保，你知道你可以写`print("Hi")`，对吧？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:35:58.553

您想将 Popen 与 一起使用`communicate`，如文档中所述：

```
>>> from subprocess import *
>>> Popen(['echo', 'Hi'], stdout=PIPE).communicate()[0]
'Hi\n' 
```

# data-binding - Grails 与命令对象的数据绑定

> ID：10290158
> 
> 赞同：2
> 
> 时间：2012-04-24T00:25:16.290
> 
> 标签：data-binding, grails, command

谁能向我解释 grails 中的数据如何以及哪些特定类与命令对象绑定？

在 JSON 发布请求的情况下，我看到了一些奇怪的行为。例如，我有使用自定义属性编辑器注册的嵌套命令对象。我的自定义属性编辑器仅在我收集了内部命令时才被使用，即在这种情况下我看到 setValue(Object obj) 被调用。例如，

```
class TestCommand
{
  List<InnerCommand> innerCommands = ListUtils.lazyList([], FactoryUtils.instantiateFactory(InnerCommand))
} 
```

但是当我有一个简单的嵌套命令时，我的属性编辑器不会被调用，这是我不想要的。例如，

```
class TestCommand
{
  InnerCommand cmd = new InnerCommand
} 
```

在这种情况下，我的自定义编辑器的 setValue(Object obj) 和 setAsString(String text) 都不会被调用。

我正在使用带有 JSON 输入的发布请求。如果有人理解这种行为，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-02T11:05:33.253

在 Grails 中有两种实现命令对象的方法

1) 在控制器中创建命令对象 2) 在 src/groovy 目录中创建命令对象

两种方式都必须在类开始之前定义注释**“@grails.validation.Validateable”**

1) 类型 1 LoginController.groovy

```
class LoginController{

       def login(){
            LoginCommand loginCommand=new LoginCommand()
            bindData(loginCommand, params)
           if(loginCommand.validate()){
             render 'login success'
           }else{
             render 'invalid user name or password'
           }
       }
    }

@grails.validation.Validateable
class LoginCommand {

        String emailId
        String password

        static constraints = {
        emailId blank:false,nullable:false,email:true
        password blank:false,nullable:false
    }

} 
```

2) 输入 2 LoginCommand.groovy

```
@grails.validation.Validateable
class LoginCommand {

    String emailId
    String password

    static constraints = {
        emailId blank:false,nullable:false,email:true
        password blank:false,nullable:false
    }

} 
```

**注意：您需要从您的 .gsp 页面传递 'emailId' 和 'password' 值。**

# javascript - 这个 Javascript 创建了什么样的对象？

> ID：10290159
> 
> 赞同：0
> 
> 时间：2012-04-24T00:25:19.843
> 
> 标签：javascript

我正在努力修复生产错误，我**不是**JS 开发人员。在我的分析可以进一步进行之前，我需要绝对确信我对以下代码行做出了一些正确的假设：

```
var iVO = {
    "images":{}
};
var thisImage = $(this).data("data");

iVO["images"][thisImage.fileKey] = thisImage;
iVO["images"][thisImage.imageType] = imageType;
iVO["images"][thisImage.uploadReason] = uploadReason; 
```

这是我的假设。如果有任何正确或误导，请纠正我：

*   `iVO`是 JSON 对象的数组
*   然后，这些 JSON 对象中的每一个都被赋予了 3 个属性`fileKey`（`imageType`和`uploadReason`）

我没有得到的是`"images"`索引的意义，它的价值/意义是`iVO["images"]`什么？这个第一个/外部数组代表什么信息/对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:27:18.583

`iVO`是一个对象字面量。它的功能类似于哈希。

`iVO["images"]`看起来像数组访问，但在这种情况下，代码正在`images`访问`iVO`. 最后，它返回`images`指向的对象，即`{}`另一个对象字面量。

`var thisImage = $(this).data("data")`正在使用 jquery 函数。 [jQuery.data 的文档在这里](http://api.jquery.com/jQuery.data/)。 `thisImage`是对调用返回的数据的引用`data`

`iVO["images"][thisImage.fileKey] = thisImage;`

只是设置一个值。第一次访问是访问`images`属性 on `iVO`，它是一个对象文字。从该对象文字中，代码为属性`thisImage.fileKey`（无论如何，它来自上一行的数据调用）分配`thisImage`.

所以，当你说

> iVO 是一个 JSON 对象数组

`iVO`是**单个**对象字面量，它在属性下包含另一个对象字面量`images`。

**该**对象文字中填充了 3 个值。键（属性的名称）取决于`data`调用返回的内容。这些值取决于`thisImage`（数据调用的结果）和变量`imageType`, 和`uploadReason`。

您可以使用调试器单步执行此代码并查看每一步的值。

注意 JSON 在这里没有发挥作用。来自 json.org，“JSON 是一种完全独立于语言的文本格式......”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:27:44.983

`iVO`是一个对象。这个对象有一个名为的属性`images`，它本身也是一个对象。该对象有 3 个属性，其名称包含在 中`thisImage`，我无法根据发布的代码确定其内容。

要回答你的最后一个问题，`iVO["images"]`相当于`iVO.images`。它是 的`images`财产`iVO`。

# google-chrome - chrome.tabs.executeScript 仅在开发者控制台打开时触发

> ID：10290160
> 
> 赞同：2
> 
> 时间：2012-04-24T00:25:23.807
> 
> 标签：google-chrome, google-chrome-extension

我正在尝试为 chrome 制作一个自动登录按钮扩展。我的代码如下：

选项.html：

```
function gotoAdmin(){
    chrome.tabs.create({'url': "http://www."+currentTabDomain+"/admin"}, function(tabId,changeInfo,tab) {
        chrome.tabs.executeScript(null, {file: "login.js"});
    });
}

...

<img src="admin.png" onClick="gotoAdmin()"> 
```

登录.js：

```
$(document).ready(function(){
    $('input[name=username]').val('foo');
    $('input[name=password]').val('bar');
    $('#form').submit();
}); 
```

清单.json：

```
"permissions": [
    "tabs", "http://*/*", "https://*/*"
],
"content_scripts": [
    {
        "matches": ["<all_urls>"],
        "js": ["jquery-1.7.2.min.js"],
        "run_at": "document_start"
    }
],
"background": {
    "scripts": ["background.js"]
} 
```

我的问题是，当我通过开发人员控制台打开选项选项卡并启动 gotoAdmin() 时，jQuery 事件运行良好并且自动登录工作正常，但是当我在没有打开开发人员控制台的情况下单击图像时，它不会做login.js 中的任何内容（甚至没有打开警报）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-30T14:18:41.703

我知道，我加入聚会为时已晚，但是 - 以防有人在寻找类似问题的答案时遇到这个问题（就像我一样） - 这是我使用的解决方案：

## 首先，事情第一：

问题是，一旦打开新选项卡，弹出窗口就会关闭，这会导致其中执行的任何 JS 也停止。因此，由于`chrome.tabs.create(<specs>, <callback>)`在弹出窗口中，回调函数永远不会执行。

## 解决方案：

解决方案是让背景页面（或更好的**[事件页面](http://developer.chrome.com/extensions/event_pages.html)**）为您处理选项卡创建过程。然后，您必须通过通知背景/事件页面来启动该过程。

第 1 步：
在弹出窗口中，使用

```
// Add whatever arguments you need to pass, in <msg>
chrome.runtime.sendMessage(msg); 
```

第 2 步：
让后台/事件页面接收消息并采取行动：

```
// a. Listen for a message, adding a listener.
chrome.runtime.onMessage.addListener((msg, sender, sendResponse) => {
  // I got the message, let's parse it.
    ...

  // b. Act upon it, creating the tab etc.
  chrome.tabs.create(<specs>, <callback>);
  ...
}); 
```

还请查看文档以获取有关**[消息传递](http://developer.chrome.com/extensions/messaging.html)**的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:37:07.073

您必须将`tab.id`而不是传递`null`给 executeScript 函数，并且`chrome.tabs.create`仅将`tab`参数传递给回调函数， no `tabId,changeInfo,tab`​​：

```
 chrome.tabs.create({'url': "http://www."+currentTabDomain+"/admin"}, function(tab) {
        chrome.tabs.executeScript(tab.id, {file: "login.js"});
    }); 
```

# php - 如何让 php json_encode($array) 进入 android 来操作它的数据？

> ID：10290165
> 
> 赞同：0
> 
> 时间：2012-04-24T00:26:36.213
> 
> 标签：php, android, json

如何让 php`json_encode($array)`进入 android 来操作它的数据？

我有一个在 json_encode($array); 中编码数组的 php 当我

```
echo json_encode($array); 
```

我得到：

`[{"id":"1","name":"player1","score":"20","quarter":"Q - 1"},{"id":"2","name":"player2","score":"18","quarter":"http:\/\/localhost\/win.jpg"}]`

现在在 android 中，我想从 php 中获取该数组并将其放入一个数组中，例如，让我从索引 0 中获取其包含的字符串值，然后将该字符串设置为 textView 文本。在 iphone 我只做这个代码：

```
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error]; 
```

（数据是我的本地网址“http://localhost/my.php”）

然后我可以轻松地从字典中获取数据`valueForKey:name`并将`objectAtIndex:0`其字符串放入文本字​​段。

请用java完成代码实现，以便我理解。因为我是 Java 新手，而且我因为很多错误和时间试图以不同的方式做到这一点而失去了理智。

感谢解决我问题的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:32:34.547

使用 org.apache.http.client.HttpClient 接收对字符串的响应。

```
HttpClient httpclient = new DefaultHttpClient();
try {
    HttpPost httppost = new HttpPost(this.getURL());
    // attach the request with post data
    List<NameValuePair> pairs = new ArrayList<NameValuePair>(); 
    pairs.add(new BasicNameValuePair("username", username)); 
    pairs.add(new BasicNameValuePair("password", password));        
    httppost.setEntity(new UrlEncodedFormEntity(pairs));
    //send request to server
    HttpResponse response = httpclient.execute(httppost);
    //trace response
    InputStream is = response.getEntity().getContent();
    //convert response to string
    BufferedReader myReader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"));
    StringBuilder sb = new StringBuilder();
    sb.append(myReader.readLine() + "\n");
    String line="";
    while ((line = myReader.readLine()) != null) {
        sb.append(line + "\n");
    }
    result = sb.toString();
} catch (Exception e) {
    e.printStackTrace();
} 
```

然后你可以使用 org.json.JSONObject 或 org.json.JSONArray。

```
JSONObject json_data= new JSONObject(result);
int userId = Integer.parseInt(json_data.getString("user_id"));
JSONArray arrJson = json_data.getJSONArray("data"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-04T10:33:05.977

发生此错误是因为您发送的 json 数组没有其名称。

存储 json 数组后，请执行以下操作：

```
echo json_encode(array('acdata'=>$acdata));

eg:
while($row = $stmt->fetch ()){
 $acdata[] = array(
     'acid' => $acid,
     'address' => $address,
     'companyname' => $companyname,
     'dateofpurchase' => $dateofpurchase,
     'ac_type' => $ac_type
);
}
header('Content-type: application/json');
echo json_encode(array('acdata'=>$acdata)); 
```

然后在android中通过以下方式检索它：

```
JSONObject jsonRootObject = new JSONObject(result);
JSONArray jsonArray = jsonRootObject.optJSONArray("acdata");
JSONObject jsonObject = jsonArray.getJSONObject(1);
name = jsonObject.optString("acid"); 
```

//acid是json中key的名字

//将其放入循环以获取所有值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-20T03:11:17.843

有许多第三方类可以自动完成大部分工作。我们不需要发明轮子。轻松使用 Retrofit 或 Volley。在我的项目中运行良好。他们代表您处理许多事情。定义一个类以将每个播放器对象的所有属性打包在一个对象中，然后使用改造 API：也许以下提示会对您有所帮助：

```
public interface QuestionAPI {
    @GET("player.php")//you can call php file directly
    public void getFeed(Callback <List<PlayerObject>> playerobject);
} 
```

# r - 如何以类似热图的样式在ggplot2中的地图顶部绘制样方计数

> ID：10290168
> 
> 赞同：5
> 
> 时间：2012-04-24T00:26:48.990
> 
> 标签：r, ggplot2

我正在尝试获取 shapefile 和其中包含的点，并最终得到 shapefile、点的图，然后最终在顶部进行样方分析，并带有一定量的 alpha 透明度。

我尝试并提出了这个应该服务的示例：

```
library(ggplot2)
library(maps)
library(maptools)
library(spatstat)
library(plyr)

# generate polygons
usa <- map('usa', plot=F)
IDs <- sapply(strsplit(usa$names, ':'), function(x) x[1])
crs <- CRS('+proj=longlat +ellps=WGS84')
usa.sp <-map2SpatialPolygons(usa, IDs=usa$names, proj4string=crs)
usa.pts <- fortify(usa.sp, region="id")

base.plot <- ggplot(usa.pts, aes(x=long, y=lat)) +
              geom_path(aes(group=id)) +
              coord_equal()

# generate point process
lon <- runif(5000, min(usa.pts$long, na.rm=TRUE), max(usa.pts$long, na.rm=TRUE))
lat <- rnorm(5000, mean(usa.pts$lat, na.rm=TRUE), sd=sd(usa.pts$lat, na.rm=TRUE)/2)
points <- data.frame(lon, lat)
points.sp <- SpatialPoints(points, proj4string=crs)
points <- points[which(!is.na(over(points.sp, usa.sp))),]

# the first plot
base.plot +
  geom_point(data=points, aes(x=lon, y=lat), color="red", alpha=I(0.5)) 
```

那么我的 shapefile 和数据大致如下： ![在此处输入图像描述](../Images/7e7cd45cc757bc499fb97bf6929d76ee.png)

我想采取的下一步是对各种像元大小进行样方分析，并用点将结果绘制在图上。假设我成功获得了一个 quadratcount 对象（现在将数据转换为正确的格式），我将如何将其绘制为类似热图的叠加层？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T17:32:03.123

要在 ggplot 中添加热图，您可以使用`geom_tile`或其默认统计信息`stat_bin2d`：

```
library(mapproj)
base.plot +
  stat_bin2d(data=points, aes(x=lon, y=lat), bins=100) +
  coord_map() 
```

我还建议您在安装软件包后使用`coord_map`而不是, 以启用不同的地图投影。`coord_equal``mapproj`

![在此处输入图像描述](../Images/9f947fe7e6eb5a1b317c905c4df8ce39.png)

# cuda - cuCtxCreate 失败并显示 CUDA_ERROR_INVALID_DEVICE

> ID：10290175
> 
> 赞同：0
> 
> 时间：2012-04-24T00:27:25.533
> 
> 标签：cuda, cuda-context

通过 cuCtxCreate 创建 cuda 上下文时出现 CUDA_ERROR_INVALID_DEVICE 错误。

我的代码正在创建一个上下文并从中获取设备并创建一个新的上下文。

知道为什么我不能创建另一个上下文吗？

```
#include<cuda.h>
#include<assert.h>

int main(){
        cuInit(0);
        CUcontext ctx;
        CUdevice device;

        CUdevice dev2;
        CUcontext c2;

        assert(cuDeviceGet(&device,0) == 0 );
        assert(cuCtxCreate(&ctx, 0, device) == 0);
        assert(cuCtxGetDevice(&dev2) == 0);
        assert(cuCtxCreate(&c2,0,dev2) == 0);
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T02:56:09.493

问题是用户让设备处于独占模式，这禁止在单个设备上创建两个上下文。

# c++ - 多图只显示两个第一个元素

> ID：10290177
> 
> 赞同：1
> 
> 时间：2012-04-24T00:27:35.287
> 
> 标签：c++, iterator, multimap

我正在尝试遍历我的多重映射中的每个元素，但由于某种原因，它在遍历前两个元素后停止工作。

这是我用来迭代的代码：

```
 for(noteIT = trackIT->noteList.begin(); noteIT != trackIT->noteList.end(); noteIT++){
        cout << "noteList size is: " << (int) trackIT->noteList.size() << endl;
        cout << "---" << noteIT->second.getName() << endl;
    } 
```

这是我得到的输出：

```
noteList size is: 3
---note1
noteList size is: 3
---note2 
```

但是我的多重地图中有两个以上的元素，我在这里添加它们：

```
// create notes
Note note1(440, 100, 8, 1, 1);
note1.setName("note1");
Note note2(220, 100, 8, 1, 9);
note2.setName("note2");
Note note3(880, 100, 8, 1, 17);
note3.setName("note3");

synthTrack.addNote(note1);
synthTrack.addNote(note2);
synthTrack.addNote(note3); 
```

这是 addNote 方法的样子：

```
void Track::addNote(Note &note) {
//  long key = note.getMeasureNumber() * 1000000 + note.getStartTime();
    long key = 1000009;
    this->noteList.insert(make_pair(key, note));
} 
```

多图可以多次使用相同的键，因此现在每个键都是相等的，但这无关紧要。有什么想法我可能做错了吗？

**编辑**

[这是一个正在运行的示例](http://codepad.org/IVQ2d5G5)。遗憾的是，这个示例按原样工作，并显示了添加到 noteList 的三个注释。然而，上面的代码不起作用，我不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:36:53.060

从键盘示例中，您的问题在于您在循环中调用的`getTracklist()`方式`for`。

每次调用时，它*都会*`getTracklist()`返回. 因此，通过在循环内部进行操作，您可以将迭代器从带有迭代器的一个副本与.*`tracklist``trackIT < playlist.getTracklist().end()``for``tracklist``tracklist`*

 *摆脱这种情况的安全方法是`tracklist`在循环之前复制到局部变量`for`并使用它：

```
vector<Track> tracklist(playlist.getTracklist());
for(trackIT = tracklist.begin(); trackIT != tracklist.end(); ++trackIT){ 
```

另一种方法是保持`for`循环不变，但将 getter 更改为`tracklist`：

```
vector<Track>& getTracklist() { return tracklist; } 
```

通过返回对 的引用`tracklist`，您将迭代器与相同的实际对象进行比较。但是，这种方式风险更大，可能只能作为最后的手段使用。

`<`顺便说一句，使用, prefer 比较迭代器通常不是一个好计划`!=`。这在这里有效，因为容器是 a `std::vector`，但是如果您将来更改为不同的容器类型，这可能会导致未定义的行为。*

# javascript - 拉斐尔动画的工具提示 - 为什么它不起作用？

> ID：10290178
> 
> 赞同：1
> 
> 时间：2012-04-24T00:27:36.150
> 
> 标签：javascript, jquery, animation, tooltip, raphael

所以我有一个用 Raphael 绘制的饼图，我正在尝试创建一个工具提示，当我将鼠标悬停在饼图的一段上时显示 Raphael 文本。事件处理程序悬停工作正常，但我无法更改工具提示文本的坐标以匹配光标坐标。请在此处查看代码：

[http://jsfiddle.net/p7U2K/1/](http://jsfiddle.net/p7U2K/1/)

我试过了

```
posx = e.pageX - $(document).scrollLeft() - $('#holder').offset().left; 
```

对于我的 x 坐标，但它会以未定义的形式返回。我究竟做错了什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T12:16:15.220

我可以指出你做错的几件事：

*   `e`未定义，因为您没有将其传递给`.hover`回调
*   `$`也是未定义的，因为您没有在脚本中加载 jquery。但你不需要它。您可以使用`e.offsetX`which 为您提供与父元素的相对位置。您不需要那些滚动偏移：

    posx = e.offsetX;

*   由于动画功能，您在绘制标签后立即隐藏标签

*   您正在每个悬停事件中创建一个新标签。这将立即用元素堵塞你的画布（即使你通过隐藏它们`opacity`）。看看这个看看我的意思：http: [//jsfiddle.net/mihaifm/wdzPG/5/](http://jsfiddle.net/mihaifm/wdzPG/5/)

# build - “-D”（定义）宏是否与已经预处理的 C/C++ 上的编译器相关？

> ID：10290180
> 
> 赞同：1
> 
> 时间：2012-04-24T00:28:17.220
> 
> 标签：build, compiler-construction, c-preprocessor

是否有任何 C/C++**编译器**（不是预处理器）将命令行定义的宏视为重要的宏？这个问题包括用户定义的宏和众所周知的（编译器或系统特定的）宏。

（我不是在询问编译器开关，而是在命令行中只询问 SINGLE switch-to-define-macros。）

`myfile.cpp`例如，如果您已经对 a 进行了“预处理” `myfile.i`，然后想将其编译`myfile.i`为 a ，那么必须在命令行中为==>定义一些“宏”`myfile.obj/myfile.o`是否有意义？`-Dmacro``myfile.i``myfile.obj/myfile.o`

同样，**链接器**是否曾经考虑过重要的宏（在任何地方定义）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:30:46.200

是的。

一些调试格式将记录预处理器定义，以便可以从调试器中访问它们。

（但我知道没有接受预处理器标志的链接器。）

# php - 使用 MySQL 日期时间比较 PHP 中的时间

> ID：10290182
> 
> 赞同：0
> 
> 时间：2012-04-24T00:28:54.840
> 
> 标签：php, mysql, datetime

我的 mysql 数据库中存储了活动日志，每个日志都有一个注册的日期时间。我正在尝试编写一个简短的 php 脚本来删除所有超过 60 天的日志。我在尝试比较日期时间格式的时间时遇到了麻烦。

这是我所拥有的：

```
$sixty_days_past = strtotime("-60 days");

$earliest_time = date("Y-m-d H:i:s", $sixty_days_past);

$logs_result = mysql_query("SELECT id FROM df_logs WHERE date < '$earliest_time'");

    while($logs_row = mysql_fetch_array($logs_result)) { 

        $oldentry = $logs_row['id'];

        mysql_query("DELETE FROM df_logs WHERE id='$oldentry'");    

    } 
```

这个查询有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:30:32.757

一切。

```
DELETE FROM `df_logs` WHERE `date` < DATE_ADD(NOW(),INTERVAL -60 DAY) 
```

完毕。

* * *

详细说明：

*   当 MySQL 完全能够进行正确的计算时，您正在使用 PHP
*   您没有将字段名称包含在反引号中，这是一个问题，因为`date`它是一个关键字。
*   您一次删除一行，这会导致查询数量可能不受限制，而不是一次全部删除（例如使用`IN`列出要删除的 ID）

# php - 使用 PHP 在聊天实现中查看消息

> ID：10290183
> 
> 赞同：0
> 
> 时间：2012-04-24T00:28:57.990
> 
> 标签：php, mysql, html, ajax

我正在使用 PHP、SQL、JavaScript 实现聊天。我正在通过使用 window.location.replace('chatlog.php') 重新加载相同的文件来检查新消息，因此页面在每个间隔后都会重定向到自身。当消息数量更多时，我会在侧面看到一个滚动条，并且当​​页面重新加载时，我必须滚动它才能看到每次刷新时最后发布的消息，这很难做到。如何编写代码以便即使页面重新加载也能显示最后发布的消息？

```
Some part of the chat.php file is as below

while($record=$mysql_fetch_array($sql))
{
print "<font color="brown">$record[firstname]:</font><font color="black">$record[message]</font>";
}
<script>
setTimeout("window.location.replace('chatlog.php')",2000);
</script> 
```

可以使用 AJAX 来解决这个问题吗？如果是这样，我们该怎么做？

我有另一个问题。我在 sql 表中将时间戳存储为年-月（数字）-日期小时：分钟：秒我想在上午/下午时间以月份日期显示它（例如，2012 年 4 月 23 日下午 5 点）我如何转换为这个? 有没有要转换的php函数？请帮忙 ！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:46:56.477

最简单的解决方案是在每条消息上放置一个`<a name="msgID_$id">...</a>`名称锚点，例如：

```
<a name="msgID_1">msg 1</a> ...
<a name="msgID_2">msg 2</a> ...
etc...
<a name="msgID_20">msg 20</a> ... 
```

然后嵌入一个刷新，其锚点对应于您在页面上列出的 LAST msg ID：

```
example.com/msgs.php#msgID_20 
```

当页面刷新时，浏览器将自动滚动到该消息，并且新刷新的锚点将具有最新消息的 ID（例如 #msgID_25）。

# c# - 如何比较日期时间的时间部分

> ID：10290187
> 
> 赞同：44
> 
> 时间：2012-04-24T00:29:30.543
> 
> 标签：c#, .net, datetime, compare

假设我们有

```
DateTime t1 = DateTime.Parse("2012/12/12 15:00:00.000"); 
```

和

```
DateTime t2 = DateTime.Parse("2012/12/12 15:03:00.000"); 
```

如何在 C# 中比较它并说出哪个时间“晚于”？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-24T00:34:01.667

您可以使用[TimeOfDay](http://msdn.microsoft.com/en-us/library/system.datetime.timeofday.aspx)属性并对其使用[Compare](http://msdn.microsoft.com/en-us/library/system.timespan.compare.aspx)。

```
TimeSpan.Compare(t1.TimeOfDay, t2.TimeOfDay) 
```

根据文档：

```
-1  if  t1 is shorter than t2.
0   if  t1 is equal to t2.
1   if  t1 is longer than t2. 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-24T00:33:32.620

, `<`, `<=`, `>`,运算`>=`符`==`都直接作用于`DateTime`和`TimeSpan`对象。所以像这样的工作：

```
DateTime t1 = DateTime.Parse("2012/12/12 15:00:00.000");
DateTime t2 = DateTime.Parse("2012/12/12 15:03:00.000");

if(t1.TimeOfDay > t2.TimeOfDay) {
    //something
}
else {
    //something else
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T00:32:11.807

使用方法[：`DateTime.Compare`](http://msdn.microsoft.com/en-us/library/system.datetime.compare.aspx)

```
DateTime date1 = new DateTime(2009, 8, 1, 0, 0, 0);
DateTime date2 = new DateTime(2009, 8, 1, 12, 0, 0);
int result = DateTime.Compare(date1, date2);
string relationship;

if (result < 0)
   relationship = "is earlier than";
else if (result == 0)
   relationship = "is the same time as";         
else
   relationship = "is later than";

Console.WriteLine("{0} {1} {2}", date1, relationship, date2); 
```

**编辑：**如果您只想比较时间，而忽略日期，您可以`TimeOfDay`按照其他人的建议使用。如果你需要一些不那么细粒度的东西，你也可以使用`Hour`and`Minute`属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-15T08:05:50.287

请参阅这些示例，这些示例解释了 C# 中的时区转换。

```
var startTime = new System.TimeSpan(23,0,0);
var endTime = new System.TimeSpan(02,0,0);

var startDateTime = new DateTime(DateTime.UtcNow.Date.Year, DateTime.UtcNow.Date.Month, DateTime.UtcNow.Date.Day, startTime.Hours, startTime.Minutes, startTime.Seconds);
var endDateTime = new DateTime(DateTime.UtcNow.Date.Year, DateTime.UtcNow.Date.Month, DateTime.UtcNow.Date.Day, endTime.Hours, endTime.Minutes, endTime.Seconds);

var cetTimeZone = TimeZoneInfo.FindSystemTimeZoneById("Central European Standard Time");
var startConvertedTime = TimeZoneInfo.ConvertTimeFromUtc(startDateTime, cetTimeZone);
var endConvertedTime = TimeZoneInfo.ConvertTimeFromUtc(endDateTime, cetTimeZone);

Console.WriteLine(startConvertedTime.TimeOfDay);
Console.WriteLine(endConvertedTime.TimeOfDay);

var currentTime = new TimeSpan(03,0,0);
Console.WriteLine(currentTime);

Console.WriteLine(currentTime >= startConvertedTime.TimeOfDay && currentTime <= endConvertedTime.TimeOfDay); 
```

# scala - 如何在Scala中使这个递归方法尾递归？

> ID：10290189
> 
> 赞同：3
> 
> 时间：2012-04-24T00:30:05.150
> 
> 标签：scala, functional-programming, tail-recursion

我[找到了](http://anders.janmyr.com/2009/10/lists-in-scala.html)一个从 Scala 中的列表列表中创建笛卡尔积的函数。但是，它不是尾递归的，并且不适用于大型列表。不幸的是，在设计时我不知道需要组合多少个列表，所以我认为递归函数是必要的。我正在努力使其尾递归，以便编译器对其进行优化：

```
def product[T](listOfLists: List[List[T]]): List[List[T]] = listOfLists match {
    case Nil => List(List())
    case xs :: xss => for (y <- xs; ys <- product(xss)) yield y :: ys
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T00:51:03.313

这种方法类似于您的原始方法，除了不是开始和前面并递归下降直到您到达末尾并追加备份，我已经引入了一个累加器，我可以向后移动列表，累积作为我去。

```
import annotation.tailrec

def product[T](listOfLists: List[List[T]]): List[List[T]] = {
  @tailrec def innerProduct[T](listOfLists: List[List[T]], accum: List[List[T]]): List[List[T]] =
    listOfLists match {
      case Nil => accum
      case xs :: xss => innerProduct(xss, for (y <- xs; a <- accum) yield y :: a)
    }

  innerProduct(listOfLists.reverse, List(Nil))
} 
```

然后：

```
scala> product(List(List(1,2),List(3,4)))
res0: List[List[Int]] = List(List(1, 3), List(1, 4), List(2, 3), List(2, 4)) 
```

# ajax - 当在 jsp 页面上按下事件按钮时，它不会转发到请求的 jsp 页面

> ID：10290190
> 
> 赞同：0
> 
> 时间：2012-04-24T00:30:14.687
> 
> 标签：ajax, jsp, recordset

下面的代码是带有 JavaScript 按钮事件的表单：

## 阿贾克斯搜索

```
<form>
<b>Enter Search Keyword</b>
<table border = "0">
    <tr>
        <td><input type="text" id="search" name="search" onkeyup="searchText()" autocomplete="on" /></td>
    </tr>
    <tr>
        <td><div id="result"></div></td>                    
    </tr>
    <tr>
        <td><div id="close" align="right" style="display: none;"><a href="" onclick="hide_divs(); return false">close</a></div></td>
    </tr>
    <tr>
        <td><input type="button" value="View Data" onclick="showData();"></td>
    </tr>
</table>
</form> 
```

下一部分显示 JavaScript 函数 onclick=showData(); 和处理函数：

```
function showData(){ 
    xmlHttp=GetXmlHttpObject()
    var keyword_name=document.getElementById("search").value;
    var url="GetResults.jsp";
    url=url+"?keyword_name="+keyword_name;
    xmlHttp.onreadystatechange=stateChanged
    xmlHttp.open("GET",url,true)
    xmlHttp.send(null)
}
function stateChanged(){ 
    if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){ 
         document.getElementById("tab").innerHTML=xmlHttp.responseText;   
    } 
} 
```

showData() 函数有效，它传递关键字参数但不显示结果集：

```
ResultSet rs = stmt.executeQuery("Select keyword_name, description from keywords where keyword_name='"+keyword_name+"'");  
while(rs.next()){
    buffer=buffer+"<tr><td>"+rs.getString("keyword_name")+"</td> <td>"+rs.getString("description")+"</td></tr>";  
} 
```

当我在 eclipse TCP/IP Monitor 上时，会显示该表，但浏览器上的页面保持不变。

更多信息 - 请求正在端口 7657 上处理，响应在 8080 上。

# python - 覆盖图像时改变pylab子图边界

> ID：10290194
> 
> 赞同：2
> 
> 时间：2012-04-24T00:30:32.423
> 
> 标签：python, matplotlib

我正在尝试将图像粘贴在一些使用 pylab 的 subplot() 函数排列的简单线图之上。但是，当我调用 imshow 时，似乎子图的边界已更改，即使使用 set_position 函数我也无法更改这些边界。

基本上，我希望顶部子图的宽度与[此图像](https://i.imgur.com/Ve2tW.png)中的底部相同。

[我已经尝试按照这篇文章](https://stackoverflow.com/questions/9120749/matplotlib-limits-when-using-plot-and-imshow-in-same-axes)关闭自动缩放，但没有任何区别。

这是我的来源：

```
import pylab as pl

#Plotting results
F=pl.figure()

#First plot the unzoomed plot
ax1=pl.subplot(211)
ax2=pl.subplot(212)

#Not relevant to problem... ax1.plot() & ax2.plot() commands
for bl in range(len(bondLengths)):
    ls=styles[bl]
    lw=widths[bl]
    for cf in range(len(chgcarfiles)):
        c=colors[cf]
        avgi=avgIBLs[cf][bl]
        L=len(avgi)
        ax1.plot([bondLengths[bl]*(x+0.5)/L for x in range(-1,L/2,1)],avgi[len(avgi)/2-1:],c=c,ls=ls,lw=lw)
        ax2.plot([bondLengths[bl]*(x+0.5)/L for x in range(-1,L/2,1)],avgi[len(avgi)/2-1:],c=c,ls=ls,lw=lw)

ax1.set_xlim([0,2.5])
ax1.set_ylim([0.5,4.9])
ax2.set_xlim([0,1.2])
ax2.set_ylim([0.88,0.96])

#Load up & insert an image
slice=pl.loadtxt("somedata1")
ax1.autoscale(False)
ax1.imshow(slice,extent=[0.05,0.75,3.4,4.1])    

pl.figtext(0.45,0.03,r"Distance ($\AA$)")
pl.figtext(0.05,0.65,r"Partial Charge Density ($\rho / rho_{avg}$)",rotation='vertical')

pl.show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:07:45.500

您可以在 ax1 之上创建另一个 ax：

```
import pylab as pl

F=pl.figure()

ax1=pl.subplot(211)
ax2=pl.subplot(212)

ax1.plot(pl.randn(100))
ax2.plot(pl.randn(100))

img = pl.randn(100, 100)
ax3 = pl.axes([0.2, 0.65, 0.2, 0.2])
ax3.imshow(img)

pl.show() 
```

![在此处输入图像描述](../Images/5b631c90f0a240021534103d330f6128.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:21:58.257

只需`aspect='auto'`指定`imshow`.

默认情况下，`imshow`将轴的纵横比设置为 1（如果您在`imshow`.

例如

```
import matplotlib.pyplot as plt
import numpy as np

fig, axes = plt.subplots(nrows=2)

for ax in axes:
    ax.plot(np.random.random(100))

axes[1].autoscale(False)
imdata = np.random.random((10,10))
axes[1].imshow(imdata, aspect='auto', extent=[5, 20, 0.3, 0.8])

plt.show() 
```

![在此处输入图像描述](../Images/ce98399dd9711aaa67f7fb67bfec98d0.png)

# iphone - ZBarReaderViewController，视图控制器层次结构和其他

> ID：10290196
> 
> 赞同：1
> 
> 时间：2012-04-24T00:30:33.537
> 
> 标签：iphone, objective-c, ios, uiviewcontroller, barcode-scanner

我正面临这个无法解决的问题，很乐意得到您的帮助。

我有一个使用 ZBar 条形码扫描仪的 iphone 应用程序。我有一个主视图控制器，它在按下 UIButton 时调用 ZBar 扫描仪。一旦扫描仪启动并检测到条形码编号，它就会自行关闭，我调用结果视图控制器来显示一些扫描结果。我的问题是关闭结果视图控制器 - 由于某种原因，我无法关闭它并以干净的方式返回主视图控制器。我的工作是创建一个主视图控制器的新对象并调用它，这是一个非常糟糕的设计。

这是我的代码-感谢任何帮助！

在主视图控制器中的某处调用扫描仪（UIButton 操作方法）：

```
ZBarReaderViewController *reader = [ZBarReaderViewController new];
UINavigationController *navCntrl1 = [[UINavigationController alloc] initWithRootViewController:reader];
reader.readerDelegate = self;
reader.title = @"Scan Barcode";
reader.supportedOrientationsMask = ZBarOrientationMaskAll;
ZBarImageScanner *scanner1 = reader.scanner;
[scanner1 setSymbology: ZBAR_I25 config: ZBAR_CFG_ENABLE to: 0];
[scanner1 setSymbology: ZBAR_QRCODE config: ZBAR_CFG_ENABLE to: 0];
[self presentModalViewController:navCntrl1 animated:YES]; 
```

主 ViewController 中的 Scanner Delegate 方法：

```
//ZBarSDK Finish Scanning
- (void) imagePickerController: (UIImagePickerController*) reader didFinishPickingMediaWithInfo: (NSDictionary*) info
{
  id<NSFastEnumeration> results = [info objectForKey: ZBarReaderControllerResults];
ZBarSymbol *symbol = nil;
for(symbol in results)
    break;

// EXAMPLE: do something useful with the barcode data

[self dismissModalViewControllerAnimated: YES];

//Calling the Results view controller
Results *resultsViewController = [[Results alloc] initWithNibName:nil bundle:nil];
resultsViewController.tempBarcode = barcode;

UINavigationController *resultsNavigationController = [[UINavigationController alloc] initWithRootViewController:resultsViewController];
resultsNavigationController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;

[[[UIApplication sharedApplication]delegate].window setRootViewController:resultsNavigationController];

 } 
```

这里有一个地方说我试图替换：

```
[[[UIApplication sharedApplication]delegate].window setRootViewController:resultsNavigationController]; 
```

和：

```
[self presentModalViewController:resultsViewController animated:YES]; 
```

但如果我这样做，什么也不会发生。

从结果视图控制器中，我这样做是为了返回主视图控制器：

```
ViewController *mainViewController = [[ViewController alloc] initWithNibName:nil bundle:nil];
UINavigationController *mainNavigationController = [[UINavigationController alloc] initWithRootViewController:mainViewController];
mainNavigationController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;    
[self presentModalViewController:mainNavigationController animated:YES]; 
```

而不仅仅是这个，它不起作用：

```
[self dismissModalViewControllerAnimated:YES]; 
```

谢谢你的耐心！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:22:55.253

我有一个使用 ZBar 的类似应用程序。这是我的 UIButton 方法的模拟：

```
- (void)scanButtonTapped{
    ZBarReaderViewController *reader = [ZBarReaderViewController new];
    reader.readerDelegate = self;
    reader.supportedOrientationsMask = ZBarOrientationMaskAll;

    ZBarImageScanner *scanner = reader.scanner;

    // I need to scan only QR-codes
    [scanner setSymbology:0 config:ZBAR_CFG_ENABLE to:0];
    [scanner setSymbology:ZBAR_QRCODE config:ZBAR_CFG_ENABLE to:1];
    reader.readerView.zoom = 1.0;

    [self presentModalViewController:reader animated:YES];
    [reader release];
} 
```

这是我的 imagePickerController:didFinishPickingMediaWithInfo:

```
- (void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    id<NSFastEnumeration> results = [info objectForKey:ZBarReaderControllerResults];
    ZBarSymbol *symbol = nil;

    for (symbol in results) 
        break;

    // Here I get the QR-code text
    self.qrText = symbol.data;
    NSLog(@"QR-code text = %@",self.qrText);

    // Here I hide scanning View Controller from user
    [picker dismissModalViewControllerAnimated:YES];

    // Here I call QR-code text processing logic
    [self ticketCheckOutLogic];
} 
```

对于调用另一个 UIViewController 我可以建议在您的 [picker dismissModalViewControllerAnimated:YES]; 之后发布通知 到您的 AppDelegate 例如：

```
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:self.barcodeText, @"barcodeText", nil];
[[NSNotificationCenter defaultCenter] postNotificationName:@"newBarcodeScanned" object:nil userInfo:options]; 
```

在 application:didFinishLaunchingWithOptions: 你可以这样写：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(showResultView:)name:@"newBarcodeScanned" object:nil]; 
```

...而您的 showResultView: 可以是这样的：

```
- (void)showResultView:(NSNotification *)notification {
     //Calling the Results view controller
     Results *resultsViewController = [[Results alloc] initWithNibName:@"ResultsView" bundle:nil];
     NSDictionary *dict = [notification userInfo];
     resultsViewController.tempBarcode = [dict objectForKey:@"barcodeText"];
     [self presentModalViewController:resultsViewController animated:YES];
} 
```

希望有帮助:)

# c# - 静态或实例方法在 .NET 中的扩展性更好吗？

> ID：10290205
> 
> 赞同：-1
> 
> 时间：2012-04-24T00:31:24.273
> 
> 标签：c#, .net

在 .NET 中，静态类中的静态方法和常规类中的实例方法之间是否存在关于可伸缩性的问题？

如果对类中的静态方法进行多次调用，是否会出现“日志堵塞”？或者这不是问题。如果是这样，使用实例方法会更好吗？

类似于调用 GetCustomers() 来检索客户数据的方法。

编辑：问题不在于调用其他问题/答案中已解决的每种方法的性能，而是关于可伸缩性。如果您每秒对静态方法与实例方法进行 10K 调用，那么静态方法会出现问题吗？或者没关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:35:48.283

不; 它不会有任何真正的区别。

方法应该是`static`如果它们不依赖于实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:39:17.827

如果方法依赖于特定的对象实例，那么静态方法和实例方法在性能上应该没有区别。如果不需要实例，静态方法可能会稍微快一些。

这样做的原因是，在内部，实例方法的处理方式几乎与采用实例参数的静态方法相同。因此，应该没有可测量的差异。

不需要实例的静态方法几乎肯定会更快，尽管很少。如果一个实例方法和一个具有相同参数的静态方法被调用，实例方法将需要一个额外的参数压入堆栈：要操作的实例。

将非实例特定方法设为静态通常是个好主意，尽管这样做带来的速度收益非常小。如果您需要知道差异，您可以对其进行分析，尽管我猜信噪比会很小，并且您可能不会学到任何有用的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T01:34:35.010

真的没关系 重要的是该方法是否需要访问该类的特定实例的状态。如果没有，您可以将其设为静态，否则您不能。如果您在理论上严格要求，然后假设该方法不需要访问实例状态数据，那么显然静态方法有一个小优势，因为您不必在堆上创建无用的对象按顺序使用它...如果您将其设为实例方法，则必须创建一个实例（只有一个实例，因为它不需要任何状态数据，哪个实例或实例的状态无关紧要） - 无论您需要调用多少次，都只有一个实例......

但是一个典型大小的类上的一个实例并不是一个沉重的打击......假设这个类（类型）不占用 3 GB 的堆空间！

# android - 如何使用 ORMLite 正确注释继承类？

> ID：10290207
> 
> 赞同：6
> 
> 时间：2012-04-24T00:31:33.070
> 
> 标签：android, sqlite, inheritance, ormlite

我正在尝试将继承与 ORMLite 一起使用，但通过查看文档和谷歌搜索，我无法确定它是否受支持。

我想做的是拥有

```
public abstract class Person{
   public int id;
   public String name;
}

public class Student extends Person{
   public String school;
    public String year;
    //  other student stuff
}

public class Teacher extends Person{
   public String title;
    // other teacher stuff
} 
```

我无法解决（假设它受支持）是如何为 ORMLite 注释 3 个类。

我只需要注释具体类`@DatabaseTable(tableName = "Student")`还是还需要抽象类？

我不断收到以下错误：

> 04-24 10:18:30.857: E/AndroidRuntime(30495): 由: java.lang.RuntimeException: java.sql.SQLException: Android sqlite 游标中的未知字段“名称”，不在：[年份，学校]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T12:24:06.577

`@DatabaseTable`注释仅在`Student`or表上是必需的，如果它在基类`Teacher`上则不会使用。`Person`

您需要`@DatabaseField`的`id`是`name`在`Person`. 例如：

```
public abstract class Person{
    @DatabaseField(generatedId = true)
    public int id;
    @DatabaseField
    public String name;
} 
```

[ORMLite](http://ormlite.com/)应该遍历类层次结构，并且基类中的任何字段都应该包含在`Student`和`Teacher`表中。如果您编辑问题以显示`@DatabaseField`注释或其他注释，我可以发表更多评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T16:25:41.870

好的，但是现在，在该示例中，如何实现包含`List<AbstractPerson>`?

我明确了我的问题：

```
public class ClassRoom {
    @ForeignCollectionField(foreignFieldName="asYouWant")
    public Collection<Person>   peoples;
}

peoples.add(new Student());
peoples.add(new Teacher());
peoples.add(new Student()); 
```

因为当 ormlite 将尝试访问以下人员时：

```
for (Person person : classRoom.peoples)
{
    if (person.getType() == Student)
        //do stuff
    else if (person.getType() == Student)
        //do other stuff
} 
```

它将无法获得 personDAO，因为它不存在（抽象）......我得到了具有良好 ID 和关系的所有数据库功能，这只是一个数据访问问题？

# c# - 将循环的所有结果存储在单个字符串中

> ID：10290209
> 
> 赞同：1
> 
> 时间：2012-04-24T00:31:42.340
> 
> 标签：c#

我正在尝试将生成的字符串一起存储（组合它们）到一个字符串中。

```
for (int i = 0; i < dataGridView1.Rows.Count; ++i)
{
    string pedido = dataGridView1.Rows[i].Cells[2].Value.ToString();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T00:35:31.683

我会为此使用 a`StringBuilder`而不是 a `String`。

```
StringBuilder sb = new StringBuilder();
for (int i = 0; i < dataGridView1.Rows.Count; ++i){
    sb.Append(dataGridView1.Rows[i].Cells[2].Value.ToString());
 }

string pedido = sb.ToString(); 
```

字符串是不可变的，因此无法更改。如果您一直将值附加到同一个字符串，您可能会遇到一些性能问题，始终创建和销毁这些值。`StringBuilder`将让您在没有所有开销的情况下继续追加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:45:05.313

像这样的 Linq 可能会起作用：

```
String.Join(",", (from a in dataGridView1.AsEnumerable() select a.Cells[2].Value.ToString()).ToList()) 
```

# wcf - 无法使用 Fiddler 将 JSON 发布数据传递到 WCF REST 服务

> ID：10290210
> 
> 赞同：3
> 
> 时间：2012-04-24T00:31:48.903
> 
> 标签：wcf, fiddler, wcf-rest

我正在尝试调用 WCF 休息服务，如下所示：

```
[WebInvoke(UriTemplate = "Login", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
public string Process(string AuthenticationInfo)
{ 
```

我正在尝试在 Fiddler 2 中使用以下内容调用它：

```
User-Agent: Fiddler
Host: localhost
content-type: application/json;charset=utf-8
content-length: 0
data: {"AuthenticationInfo": "data"} 
```

我在方法中有一个断点，它确实到达了断点，但 AuthenticationInfo 的值始终为空，而不是“数据”。

我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T03:11:16.280

该`[WebInvoke]`属性的默认“正文样式”是“Bare”，这意味着输入（在您的情况下，`"data"`）必须“按原样”发送。您发送的是输入的*包装*版本（即，包装在其键是参数名称的对象中。

有两种方法可以使这项工作：更改`WebInvoke`声明以包含 BodyStyle 参数：

```
[WebInvoke(
    UriTemplate = "Login", 
    RequestFormat = WebMessageFormat.Json,
    ResponseFormat = WebMessageFormat.Json,
    BodyStyle = WebMessageBodyStyle.WrappedRequest)]
public string Process(string AuthenticationInfo) 
```

或者您可以更改请求以发送参数“bare”：

```
POST .../Login HTTP/1.1
User-Agent: Fiddler
Host: localhost
Content-Type: application/json;charset=utf-8
Content-Length: 6

"data" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:39:49.470

您是否在 Fiddler 中将 HTTP 方法设置为 POST？默认情况下，WCF REST 操作是 POST，如果你想获取你需要`Method="GET"`在`WebInvoke`属性上设置。顺便说一句，在你的情况下，我认为 GET 没有意义，因为你正在发送数据，所以只要确保你在 Fiddler 中使用 POST。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T13:26:37.917

您将 Content-Length 发送为 0，但它应该是您的 POST-Data 的长度。

# java - Java Generics Silly Thing（为什么我不能推断类型？）

> ID：10290218
> 
> 赞同：3
> 
> 时间：2012-04-24T00:33:21.050
> 
> 标签：java, generics, types, inference

我会尽量简短，因为这个问题没有得到很好的回答。对于详细的解释，请阅读本简报。

我会展示我想要做什么。像这样的东西（从构造函数推断传入类型，以便在另一个方法 getLeaderHerd 作为返回类型中使用它）...：

```
public class ZooCage{

    private CageFamily<T> inhabitants;  

    public <T>ZooCage(CageFamily<T> herd) {
        this.inhabitants=herd;      
    }

    public T getHerdLeader() {
        return inhabitants.getLeader();
    }   
} 
```

或这个

```
public class ZooCage{

    private (Type) T;   

    public ZooCage(CageFamily<T> herd) {
        this.T=T;       
    }

    public T getHerdLeader() {
        return inhabitants.getLeader();
    }   
} 
```

所以我可以从 Main 调用类似的东西：

```
ZooCage cage = new ZooCage(new CageFamily<Lion>()); //Imagine new CageFamily its not empty
Lion leader = cage.getHerdLeader(); 
```

即使不可能，我为什么要认为那是不合理的？如果编译器是智能的并且比典型的 ZooCage 类冗余更少，那么它的类型是安全的，这不是必需的

我正在评估将泛型用于特定行为。我设法让它工作，但我不明白为什么我不能从 arg 推断类型。所以我创建了这个例子，它运行良好，没有警告，目的是简化实际架构。

（直接查看最后 2 行片段以获得快速简报）

假设我有这两个课程。目标一：

```
package Zoo;
import Zoo.Main.CageFamily;
import Zoo.Main.Vertebrate;

public class ZooCage<T extends Vertebrate>{

    private CageFamily<T> inhabitants;  

    public ZooCage(CageFamily<T> herd) {
        this.inhabitants=herd;      
    }

    public T getHerdLeader() {
        return inhabitants.getLeader();
    }   
} 
```

想象一下，笼子里只能有脊椎动物（昆虫/蛛形纲动物不至于大猩猩/章鱼需要水生介质）

另一个类 Main.java

```
package Zoo;
import java.util.ArrayList;

public class Main {

    public static void main(String[] args){
        new Main().test();
    }

    public void test(){
        CageFamily<Lion> lionsHerd = new CageFamily<Lion>();
        lionsHerd.add(new Lion("Simba"));
        lionsHerd.add(new Lion("Nala"));

        CageFamily<Bear> bearsHerd = new CageFamily<Bear>();
        bearsHerd.add(new Bear("Yogi"));
        bearsHerd.add(new Bear("Boo-boo"));

        ZooCage<Lion> cageLions = new ZooCage<Lion>(lionsHerd);     
        ZooCage<Bear> cageBears = new ZooCage<Bear>(bearsHerd);

        for (ZooCage<?> cage : new ZooCage[]{cageLions,cageBears} ) 
           System.out.println("The leader is "+ cage.getHerdLeader());

    }

    public interface Vertebrate{
        public String toString();
        public int numBones();
    }
    public class Lion implements Vertebrate{
        private String name;
        public Lion (String name){this.name=name;}
        public String toString(){return name + " (who has "+numBones()+" bones)";}
        public int numBones(){return 345;}
    }
    public class Bear implements Vertebrate{
        private String name;
        public Bear (String name){this.name=name;}      
        public String toString(){return name + " (who has "+numBones()+" bones)";}
        public int numBones(){return 658;}
    }
    public class CageFamily<E extends Vertebrate> extends ArrayList<E>{
        final static long serialVersionUID = 1L;
        public E getLeader(){
             return get(0); //Let,s assume the first added is the leader
        }
    }
} 
```

这编译OK并打印

```
The leader is Simba (who has bones)
The leader is Yogi (who has bones) 
```

我想知道的是：有什么方法（只使用类型/泛型而不使用 supressingWarnings 或铸件）来避免整个 ZooCage 类的典型化？我尝试了数千种方法来从 ZooCage 的构造函数 arg 中推断出类型到 getHerdLeader 的返回值。当他的构造函数带有预期的类型时，应该没有必要指定 ZooCage。似乎多余，让您必须事先知道类型！

非常感谢所有可以提供帮助的人！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T00:49:35.603

Java 7 让您可以做到`ZooCage<Type> = new ZooCage<>(argument)`。不过，该功能在 Java 7 中是新的，并且在 Java 的早期版本中不可用。

或者，解决 Java 6 缺乏类型推断的传统方法是编写工厂方法

```
public static <T> ZooCage<T> newZooCage() {
  return new ZooCage<T>();
} 
```

然后`newZooCage()`自动推断它的类型，因为即使 Java 5 也有*方法*的类型推断——只是没有构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:50:34.313

Java 不支持类型推断。

如果你对此感兴趣，你应该看看 Scala。

在 Java 7 中，您可以省略右侧 < > 之间的类型。[在 Java 6 中，您可以使用带有 Guava 的静态方法来做到这一点](https://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained)。Java 8 可能/将有文字（或至少上次检查），因此这也可能有所帮助。

**我不同意这些都是真正的类型推断** *（见下面的评论）*。

# java - HBase java.lang.NoClassDefFoundError 类路径错误

> ID：10290223
> 
> 赞同：0
> 
> 时间：2012-04-24T00:34:06.440
> 
> 标签：java, hbase

更新：这不是自制问题，我可以确认这一点，因为从 apache 源运行 HBase 时出现完全相同的错误。

一直在努力在我的笔记本电脑上安装 HBase 进行测试。基本上我通过使用在我的 Mac 上安装 HBase： `brew install hbase` 但是当我进入 hbase shell 并发出命令时，我收到此错误：

> 线程“主”java.lang.NoClassDefFoundError 中的异常：org/apache/zookeeper/KeeperException

我试图安装 zookeeper( `brew install zookeeper`) 但仍然没有运气。读入消息后发现 hbase 有自己的类路径，并且需要其中包含的 zookeeper jar。我一直在努力解决这个问题，因为我使用 eclipse 并将我所有的 jar 放在构建路径中，我从来没有真正处理过命令行。我进行了搜索，jar 位于 directory( `/usr/local/Cellar/hbase//0.92.0/libexec/lib/zookeeper-3.4.2.jar`) 中，但不知道如何添加它。

我一直在尝试所有`export CLASSPATH=/usr/local/Cellar/hbase/0.92.0/libexec/lib/zookeeper-3.4.2.jar:$CLASSPATH`我能想到的（得到这个想法[这里] [1]）的变体，但仍然没有运气，我一直遇到同样的错误。

我想知道我是否正确分配了类路径？或者如果 HBase 有自己的分配类路径？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T17:32:38.383

我在尝试启动 hbase 0.94.1 时遇到了同样的问题。

我通过编辑文件“/usr/local/hbase-0.94.1/conf/hbase-env.sh”并添加元素“export HBASE_CLASSPATH=/usr/local/hbase-0.94.1/lib”来解决这个问题。

zookeeper JAR 位于“/usr/local/hbase-0.94.1/lib”的 HBase 安装中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T05:11:23.283

或者确保将 HBASE_HOME 添加到环境变量（带有 hbase 文件夹的路径）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T10:18:15.320

这对我不起作用。我在 github 上创建了一个小型批量导入项目。你可以在 lib/ 文件夹下找到 zookeeper jar，以及其他使用的 jar。不确定不需要哪些 jar 文件。

在 Eclipse 中添加 jar 文件：

```
Project/Properties/Add Jars../ go to libs folder and select all jars 
```

链接：[HBase 批量加载示例](https://github.com/Paschalis/HBase-Bulk-Load-Example)

# iphone - Xcode“此类不符合键 pageControl 的键值编码。”

> ID：10290224
> 
> 赞同：0
> 
> 时间：2012-04-24T00:34:09.963
> 
> 标签：iphone, ios, xcode, pagecontrol

请有人帮助我！我整天都在这。我已经看到几个不同的stackoverflow问题得到了这个问题的回答，但我已经尝试了一切，但我就是想不通。这是我的整个项目，所以我不必在这里粘贴多个文件的代码。问题是当我尝试运行我的应用程序时，Xcode 在控制台中给了我这个错误。

```
2012-04-23 17:28:33.638 KMLViewer[96646:11603] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<UIApplication 0x6d8d5e0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key pageControl.'
*** First throw call stack:
(0x114c022 0x12ddcd6 0x114bee1 0xc5022 0x36f6b 0x36edb 0x51d50 0x59771a 0x114ddea 0x10b77f1 0x59626e 0x597eb7 0x374ce1 0x374ff8 0x37417f 0x383183 0x383c38 0x377634 0x1d46ef5 0x1120195 0x1084ff2 0x10838da 0x1082d84 0x1082c9b 0x373c65 0x375626 0x27bd 0x2735)
terminate called throwing an exception 
```

谢谢你的帮助！这是下载它的链接：[http ://www.mediafire.com/?4rd4xy8of1yv4ea](http://www.mediafire.com/?4rd4xy8of1yv4ea)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:17:56.630

The error shows that the pageControl setter is being called on a UIApplication object but it is defined on your UIScrolView_... class. This indicates a mixup between two class names; one place where this is common is in nib files. It turns out that your 'Main nib file base name' (located in the Info settings for the KMLViewer target) is wrong - it should be MainWindow. Once you fix that - the application runs a bit further but runs into a 'map' setter problem (which is probably fixed by @obuseme's response).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:51:36.573

您在 OneTranquille.xib 中的类定义是错误的。它显示“KMLViewerViewController”，但应该是“OneTranquille”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T14:25:44.553

另一个错误可能是名为 pagecontrol 的错误或不必要的 Outlet。查看连接检查器中的插座。

# data-binding - 动态 PLSQL 中的错误绑定变量

> ID：10290226
> 
> 赞同：1
> 
> 时间：2012-04-24T00:34:26.393
> 
> 标签：data-binding, plsql, oracle10g, dynamic-sql

我的 sqlQuery 是这样的：

```
sqlQuery := 'SELECT sa.nombre_archivo, sha.registrosok, sha.registroserroneos,'||
            ' sha.registrosinconsistentes,'||
            ' (sha.registrosok+sha.registroserroneos+sha.registrosinconsistentes),'||
            ' sha.fechaprocesamiento'||
              ' FROM src_historialarchivo sha, src_archivo sa, src_usuario su'||
            ' WHERE sa.idarchivo = sha.idarchivo'||
              ' AND sa.nombre_archivo LIKE ''%:1%'''||
              ' AND sa.idusuario = su.idusuario'||
              ' AND isvalidrange(sha.fechaprocesamiento,:2,:3) = ''T'''||
            ' ORDER BY to_date(sha.fechaprocesamiento, ''DD/MM/YYYY'')'; 
```

但是 binding-variable 似乎有问题`:1`，如何解决？抛出的错误是`java.sql.SQLException: ORA-01006`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T05:59:35.527

试试这样：

```
sqlQuery := 'SELECT sa.nombre_archivo, sha.registrosok, sha.registroserroneos,'||
            ' sha.registrosinconsistentes,'||
            ' (sha.registrosok+sha.registroserroneos+sha.registrosinconsistentes),'||
            ' sha.fechaprocesamiento'||
              ' FROM src_historialarchivo sha, src_archivo sa, src_usuario su'||
            ' WHERE sa.idarchivo = sha.idarchivo'||
              ' AND sa.nombre_archivo LIKE :1'||
              ' AND sa.idusuario = su.idusuario'||
              ' AND isvalidrange(sha.fechaprocesamiento,:2,:3) = ''T'''||
            ' ORDER BY to_date(sha.fechaprocesamiento, ''DD/MM/YYYY'')';

execute immediate sqlQuery using '%abc%'; 
```

# java - Java Linux 64 位 PermGen 选项？

> ID：10290230
> 
> 赞同：0
> 
> 时间：2012-04-24T00:35:10.790
> 
> 标签：java, linux, 64-bit

使用 jruby 运行 rake 构建，使用：

```
$ java -version
java version "1.7.0_03"
Java(TM) SE Runtime Environment (build 1.7.0_03-b04)
Java HotSpot(TM) 64-Bit Server VM (build 22.1-b02, mixed mode) 
```

虽然我已经有了`-XX:MaxPermSize=256m`，但我仍然`PermGen space`失败了。

是否有其他命令行选项可用于增加 PermGen 可用空间？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T04:08:08.007

使用内存分析器或堆分析工具来准确检查 PermGen 中的内容。需要大量 PermGen 是不寻常的，除非您确切知道要做什么以及为什么要这样做，否则它可能是一个错误。

您需要发布您的代码，更好地描述应用程序，或者自己进行一些基本的堆分析。几乎没有足够的信息来提供帮助。

# google-chrome - 捕获用户在页面上单击的链接

> ID：10290232
> 
> 赞同：1
> 
> 时间：2012-04-24T00:35:17.937
> 
> 标签：google-chrome, google-chrome-extension

我正在玩扩展。如果用户安装了扩展程序，我想捕获他们在网页上单击的链接。不太确定如何执行此操作，但看起来很简单。我可能会补充一点，只要安装并启用了插件，我希望这种情况发生，但不希望用户必须在工具栏中执行任何操作来“激活”它。

不知道如何开始。而且我认为我有一个太多的 JS 文件，但只是试图让其中一个登录到控制台。也不行。我的最终目标是，如果他们去某些地方，我想将他们重定向到 Intranet 页面。

**背景.js**

```
var redirectedSites = ["https://www.facebook.com/profile.php?id=<SOMEPROFILEID>"];
// when the browser tries to get to a page, check it against a list
chrome.webRequest.onBeforeRequest.addListener(
    function(details) {
        console.log('is this even getting hit?');
        for(var i=0; i < redirectedSites.length; ++i) {
            // if the attempt is to a listed site, redirect the request
            if( details.url == redirectedSites[i] )
               return {redirectUrl: "http://intranet/landing?from=" + details.url };
         }
    },
    {urls: ["*://www.facebook.com/*"]},
    ["blocking"]
); 
```

**清单.json**

```
{
 "name": "Capture Click",
 "version": "0.1",
 "description": "Simple tool that logs clicked links.",
 "permissions": [
"tabs",
"webRequest",
"webRequestBlocking",
    "https://*.facebook.com/*"
 ],
"background": {
   "scripts": ["background.js"]
 },
 "manifest_version": 2
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:31:56.810

我在评论中给出了一些建议，但解决实际更大问题的最佳方法是使用[webRequest](http://code.google.com/chrome/extensions/webRequest.html)处理程序：

```
var redirectedSites = ["http://www.google.com/foobar", ...];
// when the browser tries to get to a page, check it against a list
chrome.webRequest.onBeforeRequest.addListener(
    function(details) {
        for(var i=0; i < redirectedSites.length; ++i) {
            // if the attempt is to a listed site, redirect the request
            if( details.url == redirectedSites[i] )
                return {redirectUrl: "http://intranet/landing?from=" + details.url };
        }
    },
    {urls: ["*://www.google.com/*"]},
    ["blocking"]); 
```

这是一个非常简单的例子，但我希望你能明白。在这里，`details.url`是用户尝试访问的页面，并且返回的对象具有`redirectUrl`重定向访问该页面的尝试的属性。我的示例检查`details.url`目标站点列表；您可以使用正则表达式或其他更强大的东西。

请注意，这不仅会影响单击的链接和输入的 URL，还会影响资源（脚本、图像）和 Ajax 请求。

# ruby - 使用 Post 请求的 Ruby 抓取网站

> ID：10290237
> 
> 赞同：1
> 
> 时间：2012-04-24T00:35:51.663
> 
> 标签：ruby, forms, post, get, screen-scraping

我的主要任务是使用发布请求抓取网站。我一直在寻找 ruby​​ 中的“net/http”，帖子示例看起来很简单。问题是如果我想使用邮政编码查找连锁店（连锁网站使用邮政来查找商店），我该怎么做？我尝试了一些东西，但都没有奏效。下面是我正在使用的代码示例：

```
 url = ARGV[0]
    zipcode = ARGV[1]  

 params = {"q" => "#{zipcode}"}
 result = Net::HTTP.post_form(URI.parse("#{url}"),params) 
```

我从命令行传递 url 和 zipcode 作为参数，其中 url 是链的存储定位器 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:54:36.477

考虑改用机械化。

[http://mechanize.rubyforge.org/](http://mechanize.rubyforge.org/)

# scheme - 生成二进制值的所有组合

> ID：10290240
> 
> 赞同：1
> 
> 时间：2012-04-24T00:36:30.450
> 
> 标签：scheme

基本上，给定 n，例如 3，我如何创建 T 和 F 的所有组合的值列表

例如。对于 n = 3，(make-bools 3) 应该返回 ((TTT), (TTF), ... (FFF))

这类似于问题[Function to return all combination of n booleans?](https://stackoverflow.com/questions/8777342) 但要在计划中实施

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:53:15.023

这适用于球拍：

```
#lang racket

(define (generate-binary-combinations n)
  (if (zero? n)
      '(())
      (for*/list ((y (in-list (generate-binary-combinations (sub1 n))))
                  (x (in-list '(T F))))
        (cons x y))))

(generate-binary-combinations 3)
> '((T T T) (F T T) (T F T) (F F T) (T T F) (F T F) (T F F) (F F F))

(generate-binary-combinations 0)
> '(()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:49:44.010

不是最有效的：

```
(define (make-bools n)
  (if (= n 0)
    '()
    (append (addhead 'T (make-bools (- n 1)))
            (addhead 'F (make-bools (- n 1))))))

; Yield copy of l with h added on to head of each list in l
(define (addhead h l)
  (if (null? l)
      l
      (cons (cons h (car l)) (addhead h (cdr l))))) 
```

# c++ - 比较字符串 C++

> ID：10290241
> 
> 赞同：-1
> 
> 时间：2012-04-24T00:36:31.547
> 
> 标签：c++, string, compare

```
string Foo(string letter)
 {

      for (int j = 0; j < (int)alphabet.length(); j++)
     {

            if (letter[0] == (alphabet[j]));
                 return "SUCCESS";
      }

      return "FAILURE";

 }

alphabet = "Test";

cout << Foo("f") << endl; 
```

这会打印 SUCCESS 甚至认为它不应该。我的比较运算符有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T00:39:28.520

```
if (letter[0] == (alphabet[j])); // Note the semicolon at the end 
```

你有一个空的`if`紧接着`return "SUCCESS";`

删除该分号：

```
if (letter[0] == alphabet[j])
    return "SUCCESS"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:41:31.673

你在末尾有一个分号

```
 if (letter[0] == (alphabet[j])); 
```

在第 10 行。

意外的分号？:-)

# iphone - iPhone iOS如何将地理标记信息添加到PNG文件？

> ID：10290242
> 
> 赞同：1
> 
> 时间：2012-04-24T00:36:32.630
> 
> 标签：iphone, ios, uiimage, cllocation, geotagging

我正在构建一个相机效果应用程序，并希望能够将地理标记添加到我捕获的屏幕截图中。我正在从 AVCaptureSession 帧缓冲区中获取相机图像，并在经过一些处理后将它们显示给用户。最终结果是 PNG 屏幕截图。如何获取`CLLocation`对象并将其添加到 PNG 图像中？

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection
{
    //how to add geotagging to this method?
       [self performImageCaptureFrom:sampleBuffer];

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:00:25.967

您可以按照这篇文章将 exif 数据添加到 png 图像中。[如何将 exif 元数据写入图像（不是相机胶卷，只是 UIImage 或 JPEG）](https://stackoverflow.com/questions/9006759/how-to-write-exif-metadata-to-an-image-not-the-camera-roll-just-a-uiimage-or-j) 请注意，用户必须已经允许您的应用程序的位置服务。如果您正在处理图像或让用户这样做，您可能会发现在最终保存之前添加元数据更容易（这将允许您通过不重新打开图像两次而不会消耗双倍内存，而且因为我不知道您正在进行什么样的处理，地理标记不会在此过程中丢失）。

# dojo - dojo jax-rs 调用问题

> ID：10290244
> 
> 赞同：0
> 
> 时间：2012-04-24T00:36:39.160
> 
> 标签：dojo, jax-rs

我正在尝试使用 dojo 工具包调用 REST web 服务，似乎调用遇到了一些问题，这是使用 dojo 的调用

```
 dojo.xhrGet({
  url: 'http://localhost:9080/TestJMSWeb/jaxrs/categories/all',
  handleAs: 'json',
  timeout: 2000,
  load: callback
});
var callback = dojo.hitch(this, function(data) {
  var massagedData = {
    label: 'categorie',
    identifier: 'id',
    items: data
  }
  this.store = new dojo.data.ItemFileReadStore({data: massagedData});
  }); 
```

网络服务代码在这里

```
@GET
    @Path("/all")
@Produces("application/json")
public JSONArray getAllCategories() throws IOException {
    final List<Categorie> allCategories = manager.getCategories();
    if (allCategories == null || allCategories.isEmpty())
        throw new WebApplicationException(ErrorUtil.jSONArrayResponse(Status.NO_CONTENT, "No category found"));
    JSONArray jsonArray = jsonCustomerArray(allCategories);
    return jsonArray;

} 
```

当我调用网络服务时，我收到一条错误消息

```
ResourceRegis I org.apache.wink.server.internal.registry.ResourceRegistry filterDispatchMethods The system cannot find any method in the ressources.CategorieRessouce class that supports OPTIONS. Verify that a method exists.
[4/24/12 1:23:41:531 GMT] 0000002f SystemErr     R 0  TestJMSWeb  INFO   [WebContainer : 0] openjpa.Runtime - OpenJPA dynamically loaded a validation provider. 
```

似乎在我使用 .xhrGet 函数时尝试使用 OPTIONS 方法调用资源有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:55:14.380

这是描述问题的链接： http: [//engin.bzzzzt.biz/2010/01/22/first-dojo-impression/](http://engin.bzzzt.biz/2010/01/22/first-dojo-impression/)

这家伙谈到如果它是一个跨域请求（我相信你的请求是，因为端口），并且请求包含一些 Access-Control-* HTTP 标头，那么浏览器将如何将请求作为 OPTIONS 而不是 GET 发送。

Dojo 在确定您正在发出跨域请求时会添加 Access-Control-* 标头。您可以尝试通过转到 dojo/_base/xhr.js 并注释掉以下行（723 到 729）来自己解决此问题：

```
// FIXME: is this appropriate for all content types?
if(args.contentType !== false){
    xhr.setRequestHeader("Content-Type", args.contentType || _defaultContentType);
}
if(!args.headers || !("X-Requested-With" in args.headers)){
    xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
} 
```

我还没有尝试过这个修复，所以请让我知道它是否有效！

# android - 如何仅滚动小部件（内容）而不滚动android中的背景

> ID：10290245
> 
> 赞同：0
> 
> 时间：2012-04-24T00:36:54.700
> 
> 标签：android, scrollview

我定义了 ScrollView 并放入了一些按钮。我有两个问题：

1.  如果我有一点按钮，那么背景太小并且不能覆盖整个屏幕。

2.  我只想在滚动时移动按钮而不是背景。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T05:21:52.470

对于您的第一个问题，滚动视图的 layout_width 和 layout_height 值是多少？我猜它是wrap_content。尝试将其更改为 match_parent 或 fill_parent。

对于您的第二个问题，blessenm 的回复对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T04:08:17.133

将滚动视图放在线性布局或框架布局内，并将背景添加到外部布局。因此，只有滚动视图中的项目才会移动。

还可以尝试将背景直接添加到滚动视图而不是其子元素，这可能不需要像我上面提到的那样添加额外的布局。

# mobile - 现实生活中成功的移动跨平台/混合应用程序示例？

> ID：10290246
> 
> 赞同：8
> 
> 时间：2012-04-24T00:36:58.450
> 
> 标签：mobile, cross-platform, sample, hybrid

我在这里或谷歌上没有找到任何东西。

你知道移动跨平台应用程序的任何（好的/成功的/最畅销的/下载最多的）示例吗？如果是这样，它们建立在哪些框架（jQuery Mobile、Sensa、PhoneGap 等）之上？

我想了解是否有可能创建成功的移动跨平台应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:41:59.153

您的应用程序的成功不取决于平台或框架:))

首先，您必须决定是否要开发游戏/社交/金融应用程序，因为游戏通常是按平台实现的，但这不是规则，因为 appMobi GameDev XDK 可用于创建跨平台游戏。

appMobi 应用程序库：[http ://www.appmobi.com/index.php?q=content/built-appmobi](http://www.appmobi.com/index.php?q=content/built-appmobi)

PhoneGap 应用程序库： http: [//phonegap.com/apps](http://phonegap.com/apps)

Sencha 演示应用程序：[http ://www.sencha.com/products/touch/demos/](http://www.sencha.com/products/touch/demos/)

Appcelerator 应用程序：http: [//www.appcelerator.com/thinkmobile/showcase](http://www.appcelerator.com/thinkmobile/showcase)

我建议你找出你想要开发什么样的应用程序。稍后，您可以评估平台/框架。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T12:23:33.383

LinkedIN Engineering 发布了一系列关于他们在为 iPad 开发混合移动应用程序时的经验和发现的出色案例研究：-

[http://engineering.linkedin.com/mobile/linkedin-ipad-nativeweb-messaging-bridge-and-websockets](http://engineering.linkedin.com/mobile/linkedin-ipad-nativeweb-messaging-bridge-and-websockets)

请参考我在同一主题上开始的另一个线程：-

[是否有任何类似于 LinkedIn Engineering 发布的案例研究？](https://stackoverflow.com/questions/11815740/are-there-any-case-studies-similar-to-the-ones-published-by-linkedln-engineering)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T05:17:03.003

QtWebkit 你可以使用 html 和本机代码。著名的应用程序使用了这种方法。

# c# - 刷新网格的计时器控件

> ID：10290247
> 
> 赞同：1
> 
> 时间：2012-04-24T00:37:01.167
> 
> 标签：c#, .net, timer, grid

我有一个网格，我以这种方式将 Page_Load 中的数据绑定到该网格：

```
List<ProductEventCheck> ruleset = (from s in (this.Page as BasePage).DbContext.ProductEventChecks
                                  where s.Sequence != 0
                                  orderby s.Sequence
                                  select s).ToList<ProductEventCheck>();
rulesGrid.DataSource = ruleset;
rulesGrid.DataBind(); 
```

所以，我有 3 列名称、描述和状态，其中名称和描述来自数据库，而状态取决于存储过程的运行。基本上，名称字段是一个过程名称。所以，我有 21 个运行的存储过程。所以，我想运行一个计时器，以便我可以每 3 秒显示一次状态字段处理，但我编写的代码只有在所有程序运行后才会刷新。你能帮助我了解我一直在做的问题或错误吗？

```
protected void Timer1_Tick(object sender, EventArgs e)
{

    string proc = "";
    int result = 0;
    GridItemCollection gridRows = rulesGrid.Items;
    foreach (GridDataItem data in gridRows)
    {
        proc = Convert.ToString(data["Name"].Text);

        RunProcedure(proc, out result);
        if (Convert.ToInt32(result) == 0)
        {
            data["statusResult"].Text = "Failure";
            RadButtonContinue.Enabled = false;

            break;
        }
        else
        {
            data["statusResult"].Text = "Completed";
            continue;
        }
    } 
```

# android-layout - HTC Evo 3d 使用什么 Android 布局文件？

> ID：10290252
> 
> 赞同：2
> 
> 时间：2012-04-24T00:37:12.867
> 
> 标签：android-layout

我认为手机使用 layout-hdpi 文件，但这似乎不对，主要是因为它的尺寸（540 x 960）不是我习惯看到的 layout-hdpi 手机的尺寸（480 x 800）。那么实际使用的布局文件是什么？另外，如果是 layout-hdpi 手机，我该如何拉伸宽度为 480 到 540 的图标？我是否必须以编程方式测试手机的尺寸，然后扩展 drawable-hdpi 文件以适应各种设备尺寸？我查看[了此链接](https://stackoverflow.com/questions/9988574/android-layout-issue-for-htc-evo-3d)，但他们从未指定使用的布局文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:04:49.030

是的，HTC Evo 3d 使用 drawable-hdpi 图像。您还应该放置布局文件。将相同的文件放入 layout-hdpi。

现在创建分辨率为 540 X 960 的模拟器。并在其中测试应用程序。普通 hdpi 和 HTC Evo 屏幕分辨率之间应该有细微差别。手动测试它。

几天前我遇到了同样的麻烦。我所做的是：我将在运行时检查设备屏幕尺寸的分辨率。如果将分辨率与 HTC Evo 3d 进行比较，那么它将在运行时设置适合 HTC 屏幕分辨率的所有图像的高度和宽度。

这是迄今为止我找到的为 HTC Evo 3d 制作应用程序的最佳解决方案。

要在运行时检查分辨率，您可以使用以下命令：

```
Display display = getWindowManager().getDefaultDisplay();
DisplayMetrics dm = new DisplayMetrics();
display.getMetrics(dm);

int width = display.getWidth();
int height = display.getHeight();
if((height==960) && (width == 540)){
         // Do change the Image Height or Width  or position
} 
```

享受。:)

# ruby-on-rails - rails - 已安装 rails 但无法创建应用程序“无法加载此类文件 - active_support”

> ID：10290256
> 
> 赞同：3
> 
> 时间：2012-04-24T00:37:36.673
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activesupport

我做到了`sudo apt-get install rails`，一切看起来都很好。

```
Reading package lists... Done
Building dependency tree       
Reading state information...
...
Setting up ruby-actionmailer-2.3 (2.3.14-2) ...
Setting up ruby-activeresource-2.3 (2.3.14-1) ...
Setting up ruby-rails-2.3 (2.3.14-2) ...
Setting up rails (2.3.14.1) ...
Setting up ruby1.8-dev (1.8.7.352-2ubuntu0.1) ... 
```

但是现在当我尝试做

轨道新测试

我明白了`cannot load such file -- active_support (LoadError)`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T00:44:21.597

我不建议尝试通过 aptitude 加载 rails，我会使用[RubyGems](http://docs.rubygems.org/read/chapter/3)。然后只需运行`gem install rails`，并在需要时传递特定版本。

举个例子，aptitude 正试图为您提供 Rails 2.3，而 Rails 目前是 3.2 版。您运行的命令`rails new test`是 rails 3 版本。在 Rails 2 中，它会是`script/rails ...`一些东西。

具体来说，您可以尝试：

```
$ sudo apt-get remove rails  # remove the previous install attempt of 2.3  
$ gem install rails          # Install rails version 3+ (3.2 in this case). 
```

# php - 使用 PHP 检测图像中的主要颜色

> ID：10290259
> 
> 赞同：40
> 
> 时间：2012-04-24T00:37:44.217
> 
> 标签：php, image-processing, imagemagick, gd

我正在尝试复制 Dribbble.com 检测图像中主要颜色的功能。在下图中，您可以看到来自 Dribbble.com 的屏幕截图，其中显示了左侧图像中的 8 种主要颜色。这是图像中的实际页面[http://dribbble.com/shots/528033-Fresh-Easy?list=following](http://dribbble.com/shots/528033-Fresh-Easy?list=following)

我需要能够在 PHP 中执行此操作，一旦获得所需的颜色，我会将它们保存到数据库中，因此不需要在每次加载页面时都运行处理。

在对如何从图像中获取这些颜色进行一些研究之后，有人说您只需逐个像素地检查图像，然后保存出现最多的颜色。其他人说还有更多，并且获得最常见的颜色不会产生预期的效果。他们说您需要量化图像/颜色（此时我迷路了）。

在下面的 Dribble 截图中是一个 Javascript 库，它做同样的事情，该页面可以在这里查看[http://lokeshdhakar.com/projects/color-thief/](http://lokeshdhakar.com/projects/color-thief/)

查看该页面的源代码，我可以看到有一个名为 Javascript 的文件`quantize.js`，结果非常好。所以我希望能够做那个 Javascript 库所做的事情，但使用 PHP 和 GD/ImageMagick

![在此处输入图像描述](../Images/9d227e714272b9a605a58cf055d165f4.png)

* * *

我发现这个函数可以用 PHP 返回图像中的颜色和计数，但结果与上面的 Javascript 版本和 Dribble 结果不同

```
/**
 * Returns the colors of the image in an array, ordered in descending order, where the keys are the colors, and the values are the count of the color.
 *
 * @return array
 */
function Get_Color()
{
    if (isset($this->image))
    {
        $PREVIEW_WIDTH    = 150;  //WE HAVE TO RESIZE THE IMAGE, BECAUSE WE ONLY NEED THE MOST SIGNIFICANT COLORS.
        $PREVIEW_HEIGHT   = 150;
        $size = GetImageSize($this->image);
        $scale=1;
        if ($size[0]>0)
        $scale = min($PREVIEW_WIDTH/$size[0], $PREVIEW_HEIGHT/$size[1]);
        if ($scale < 1)
        {
            $width = floor($scale*$size[0]);
            $height = floor($scale*$size[1]);
        }
        else
        {
            $width = $size[0];
            $height = $size[1];
        }
        $image_resized = imagecreatetruecolor($width, $height);
        if ($size[2]==1)
        $image_orig=imagecreatefromgif($this->image);
        if ($size[2]==2)
        $image_orig=imagecreatefromjpeg($this->image);
        if ($size[2]==3)
        $image_orig=imagecreatefrompng($this->image);
        imagecopyresampled($image_resized, $image_orig, 0, 0, 0, 0, $width, $height, $size[0], $size[1]); //WE NEED NEAREST NEIGHBOR RESIZING, BECAUSE IT DOESN'T ALTER THE COLORS
        $im = $image_resized;
        $imgWidth = imagesx($im);
        $imgHeight = imagesy($im);
        for ($y=0; $y < $imgHeight; $y++)
        {
            for ($x=0; $x < $imgWidth; $x++)
            {
                $index = imagecolorat($im,$x,$y);
                $Colors = imagecolorsforindex($im,$index);
                $Colors['red']=intval((($Colors['red'])+15)/32)*32;    //ROUND THE COLORS, TO REDUCE THE NUMBER OF COLORS, SO THE WON'T BE ANY NEARLY DUPLICATE COLORS!
                $Colors['green']=intval((($Colors['green'])+15)/32)*32;
                $Colors['blue']=intval((($Colors['blue'])+15)/32)*32;
                if ($Colors['red']>=256)
                $Colors['red']=240;
                if ($Colors['green']>=256)
                $Colors['green']=240;
                if ($Colors['blue']>=256)
                $Colors['blue']=240;
                $hexarray[]=substr("0".dechex($Colors['red']),-2).substr("0".dechex($Colors['green']),-2).substr("0".dechex($Colors['blue']),-2);
            }
        }
        $hexarray=array_count_values($hexarray);
        natsort($hexarray);
        $hexarray=array_reverse($hexarray,true);
        return $hexarray;

    }
    else die("You must enter a filename! (\$image parameter)");
} 
```

所以我问是否有人知道我如何用 PHP 完成这样的任务？可能已经存在您知道的某些东西，或者任何让我更接近这样做的提示，将不胜感激

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-02-18T07:30:44.213

这正是您在 PHP 中寻找的内容：[https ://github.com/thephpleague/color-extractor](https://github.com/thephpleague/color-extractor)

例子 ：

```
use League\ColorExtractor\Palette;

$palette = Palette::fromFilename('some/image.png');

$topEightColors = $palette->getMostUsedColors(8); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-03-30T23:44:17.467

这是我获取图像主要颜色的简单方法

```
$image=imagecreatefromjpeg('image.jpg');
$thumb=imagecreatetruecolor(1,1);
imagecopyresampled($thumb,$image,0,0,0,0,1,1,imagesx($image),imagesy($image));
$mainColor=strtoupper(dechex(imagecolorat($thumb,0,0)));
echo $mainColor; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-12-08T16:38:02.830

您需要按比例缩小图片，您将获得图片的主要颜色。如果您需要托盘中的 4 种颜色，请将其缩小到大约`8x8`6 种颜色到大约 `12x8`等等......

`imagecopyresized`对于按比例缩小的图像，然后检查每个像素并将它们存储在数组中`imagecolorat($image,px,py)`

试试这个

```
<?php

// EXAMPLE PICTURE
$url='https://www.nordoff-robbins.org.uk/sites/default/files/google.jpg';

//var_dump(getColorPallet($url));

echoColors(getColorPallet($url));

function echoColors($pallet){ // OUTPUT COLORSBAR
    foreach ($pallet as $key=>$val)
        echo '<div style="display:inline-block;width:50px;height:20px;background:#'.$val.'"> </div>';
}

function getColorPallet($imageURL, $palletSize=[16,8]){ // GET PALLET FROM IMAGE PLAY WITH INPUT PALLET SIZE
    // SIMPLE CHECK INPUT VALUES
    if(!$imageURL) return false;

    // IN THIS EXEMPLE WE CREATE PALLET FROM JPG IMAGE
    $img = imagecreatefromjpeg($imageURL);

    // SCALE DOWN IMAGE
    $imgSizes=getimagesize($imageURL);

    $resizedImg=imagecreatetruecolor($palletSize[0],$palletSize[1]);

    imagecopyresized($resizedImg, $img , 0, 0 , 0, 0, $palletSize[0], $palletSize[1], $imgSizes[0], $imgSizes[1]);

    imagedestroy($img);

    //CHECK IMAGE
    /*header("Content-type: image/png");
    imagepng($resizedImg);
    die();*/

    //GET COLORS IN ARRAY
    $colors=[];

    for($i=0;$i<$palletSize[1];$i++)
        for($j=0;$j<$palletSize[0];$j++)
            $colors[]=dechex(imagecolorat($resizedImg,$j,$i));

    imagedestroy($resizedImg);

    //REMOVE DUPLICATES
    $colors= array_unique($colors);

    return $colors;

}
?> 
```

非常适合我。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-24T03:16:03.023

你链接到的页面有一个指向 GitHub 上源代码的链接，所以如果你想确切地知道他们是如何做的，你可以在 PHP 中复制他们的源代码。

他们如何做和你如何做之间的最大区别在于他们使用聚类来查找颜色。他们不是在存储颜色时四舍五入，而是将所有原始颜色存储在一个数组中。然后他们遍历这个数组，直到他们找到一个集群中的点与集群中颜色数量的比率最高的集群。这个中心点是最常见的颜色。然后调色板由下一个最高的集群集定义，并使用一些逻辑来防止集群几乎完全重叠。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-03-10T08:35:14.673

试试这个： http: [//www.coolphptools.com/color_extract](http://www.coolphptools.com/color_extract)

适用于 JPEG 和 PNG。

最好的！：不需要作曲家，只需 require_once

```
require_once 'colorextract/colors.inc.php';
$ex=new GetMostCommonColors();
$num_results=20;
$reduce_brightness=1;
$reduce_gradients=1;
$delta=24;
$colors=$ex->Get_Color( 'image.png', $num_results, $reduce_brightness, $reduce_gradients, $delta);
print_r($colors); 
```

给你这样的东西：

> 阵列（[3060a8] => 0.55827380952381 [f0a848] => 0.19791666666667 [000000] => 0.069642857142857 [483018] => 0.02047619047619 [786018] => 0.01827380952381 [183060] => 0.01797619047619 [4878a8] => 0.016011904761905 [181800] => 0.015119047619048 [a87830] => 0.014345238095238 [a8c0d8] => 0.011904761904762 [6090c0] => 0.01172619047619 [d89030] => 0.011011904761905 [90a8d8] => 0.0071428571428571 [FFFFFF] => 0.0070238095238095 [604830] => 0.006547619047619 [F0F0F0] => 0.0063095238095238 [d8d8f0 ] => 0.005297619047619 [c0d8d8] => 0.0044047619047619 [f0f0ff] => 0.00041666666666667 [181830] => 0.00011904761904762）

我尝试了不同的图像，它似乎可靠。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-09T07:23:44.777

获取图像的主要颜色的想法有点棘手，因为例如，最常见的像素颜色可能在图像中分散得非常广泛，以至于根本不会被视为主要颜色。

我认为像[颜色相干向量](https://www.cs.cornell.edu/~rdz/Papers/PZM-MM96.pdf)这样的算法足以克服这个问题，因为它将颜色聚集成连贯和不连贯（这很直观），然后你可以使用它们来丢弃那些误报的主要颜色。

我认为这是一个易于实现的算法，本教程[图像检索：颜色相干向量描述](https://owlcation.com/stem/Image-Retrieval-Color-Coherence-Vector)了它的步骤，并举例说明了它是如何工作的，甚至在它的末尾还提到了一个[matlab实现。](https://github.com/TarekVito/ColorCoherenceVector)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-09T18:42:00.977

我有一个名为dominantcolor 的带有ImageMagick 的Unix bash shell 脚本，它可以做你想做的事。请参阅我的脚本网站[http://www.fmwconcepts.com/imagemagick/index.php](http://www.fmwconcepts.com/imagemagick/index.php)。你从 PHP exec() 运行它。在我的主页上查看我的使用指南。

输入：

[![在此处输入图像描述](../Images/819882e1146b1ba8f3b0a361da8b657d.png)](https://i.stack.imgur.com/OC1Fi.png)

```
dominantcolor -n 6 -p all -s save plate.png

count,hexcolor
586,#5ECADC
520,#AFA85D
469,#3C3126
462,#B9C8BB
258,#488A70
205,#B06928 
```

-n 6 是颜色量化中所需的颜色数。-p all 表示打印结果 6 种颜色的所有计数和颜色。-s save 表示保存样本图像。

根据上面的列表，下面的颜色显示为左侧的主色和向右递减的计数颜色。

[![在此处输入图像描述](../Images/e29c575d8dd896e3ea517fb0e8c9bb24.png)](https://i.stack.imgur.com/bCcFl.gif)

# orchardcms - Orchard 1.4 中的 HTML 编辑器

> ID：10290260
> 
> 赞同：0
> 
> 时间：2012-04-24T00:38:05.043
> 
> 标签：orchardcms

我在 SO 上环顾四周，看看是否有人以前问过这个问题，但找不到任何帖子。如果这是一个重复的问题，我很抱歉。

在 Orchard 1.3 中，有一个可以使用的 HTML 字段模块......但在 Orchard 1.4 中没有任何内容。如何创建具有多个 HTML 字段的内容类型？（只需在 UI 中添加它而不是编码）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T03:24:07.713

恰恰相反。1.3 中没有开箱即用的，您必须从库中下载一个，而 1.4 是内置的。

# javascript - jQuery Mobile 和 MVC3 自动提交

> ID：10290267
> 
> 赞同：0
> 
> 时间：2012-04-24T00:39:22.487
> 
> 标签：javascript, asp.net-mvc, jquery-mobile

如果我将 jQuery Mobile 排除在外，则以下代码可以完美运行！

**表格：**

```
@using (Html.BeginForm("SearchTown", "Home", FormMethod.Post, new { id = "TheForm1" }))
{
    @Html.DropDownList("TownID", (SelectList)ViewBag.TownId, "Select a Town")
} 
```

**Javascript：**

```
<script type="text/javascript">
    $(function () {
        $("#TownID").live('change', function () {
            //$("#TownID").change(function () {
            var actionUrl = $('#TheForm1').attr('action') + '/' + $('#TownID').val();
            $('#TheForm1').attr('action', actionUrl);
            $('#TheForm1').submit();
        });
    });
</script> 
```

但是，如果我将 jQuery Mobile 包裹在网站周围，那么每次我提交表单时，在我的日志中，它只会一次又一次地将 ID 字段添加到 URL 字符串的末尾。这只会发生在我的日志中，不会发生在浏览器中。在浏览器中，它**看起来**仍然在做正确的事情！例如。

**www.mysite.com/Home/SearchTown/2**第一次

**www.mysite.com/Home/SearchTown/2/2**第二次

**www.mysite.com/Home/SearchTown/2/2/2**第三次

但在浏览器中它看起来仍然正确 www.mysite.com/Home/SearchTown/2

为什么 jQuery Mobile 会这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T10:05:12.437

我已经把这个留了足够长的时间，没有人有答案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:23:04.513

这很可能会发生，因为每次发布表单时，它都会使用 AJAX 加载响应，并且加载的页面中有重复的元素 ID。

我在这里猜测，但根据您的描述，您的表单听起来像是回帖到具有相同表单标记的页面。每次您的表单发布呈现下一页时，您都会在 DOM 中添加*另一个* `#TheForm1`页面（因为 jQuery Mobile 将先前加载的页面保留在 DOM 中并在活动`data-role="page"`元素之间简单地交换）。`#TheForm1`由于这种行为，一旦页面上有多个元素，选择器`$('#TheForm')`将只返回 DOM 中与该 ID 匹配的第一个元素——这将是您第一次发布的表单。因此，每次您发布时，您的代码都会使用您最初修改的表单元素的 action 属性——这就是为什么您会看到 URL 附加了多个值的原因。

在 jQuery Mobile 中，使用类名和活动页面作为容器来识别元素几乎总是更好，因为您永远不知道一个 ID 在 DOM 中可能在多个页面更改中重复多少次。因此，不要使用 ，而是`$('#TheForm1')`分配一个类名并将其与`$.mobile.activePage`:结合使用`$('.Form1', $.mobile.activePage)`。（您的选择框也是如此）。

作为替代方案，您可以告诉 jQuery Mobile 不要通过添加`data-ajax="false"`到表单标签来增强您的表单。这将使其表现得像没有任何 AJAX 的普通整页回发。

**编辑**

我在第 3 段中要说明的一点是，您需要确保始终为当前可见页面选择正确的表单元素，而不是无意中返回隐藏在视图之外的表单元素。全局变量将为您提供当前可见页面的`$.mobile.activePage`上下文，然后基于类的选择器（而不是基于 Id）将确保在更改处理程序中检索到正确的表单元素。像这样的东西：

```
<form class="town-form" action="#">
    <select class="town-selector">
        <option value="1">Town A</option>
        <option value="2">Town B</option>
        <option value="3">Town C</option>
    </select>
</form>

<script type="text/javascript">
    $(function () {
        $(".town-selector").live('change', function () {
            var form = $('.town-form', $.mobile.activePage);
            var actionUrl = form.attr('action') + '/' + $(this).val();
            form.attr('action', actionUrl);
            alert('submitting to: ' + form.attr('action'));
            form.submit();
        });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T19:09:09.727

因为您正在提交漏洞页面，而 jQuery mobile 不喜欢这样的东西，并且每次`POST`它只是将 ID 附加到`document.location`......我在一些移动项目中了解到......

而不是这条线`$('#TheForm1').submit();`做这样的事情：

```
var url = $('#TheForm1').attr('action') + '/' + $('#TownID').val();

$.post(url, $('#TheForm1').serialize(), function(data) {
    // do something with data if you send back something...
    // or just change page with jQuery Mobile API
});

return false; 
```

# css - TableCell javafx 2中的边框不能左右或上下不同

> ID：10290275
> 
> 赞同：18
> 
> 时间：2012-04-24T00:40:39.867
> 
> 标签：css, tableview, javafx-2, tablecell

我正在尝试在 javafx 2+ 中创建一个计划界面，但我无法让 TableView 包含看起来像连体组件的 TableCell。

我尝试的第一件事是使用背景颜色和边框，但是，我无法让边框在顶部和底部之间有所不同。

`-fx-border-width: 1px, 0px, 0px, 0px;`顶部

`-fx-border-width: 0px, 0px, 1px, 0px;`为底部

理想情况下，我将能够跨越列或行，但我知道它不适合控件的模型。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-26T08:42:23.437

只需从您的代码中删除逗号。例如：

```
-fx-border-width: 1 2 3 4; -fx-border-color: red blue green yellow; 
```

# php - 将变量从 php 转移到 js

> ID：10290278
> 
> 赞同：0
> 
> 时间：2012-04-24T00:41:02.423
> 
> 标签：php, javascript, variables

当我尝试将变量从 php 传输到 js 时，我真的很困惑。当我尝试使用 id 获取价值时，一切都很好
，例如：

```
var name = $("#name").val(); 
```

但我的问题是，如果我想转换例如这个变量：

```
$id = 182938; //the id of the user 
```

到这个变量：

```
var id; 
```

这个问题可能很愚蠢......也许对你来说很容易，但对我来说不是：p
我已经查过了，只在我寻找的任何地方发现了这样的东西：

```
<?php
$number = rand();
?>

<script language="javascript">
var num = <?php echo $number ?>
</script> 
```

它是否与传递值具有相同的影响？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:42:46.730

不完全的。编码为 JSON 将确保它是有效的 JavaScript 文字。

```
var num = <?php echo json_encode($number) ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:43:46.507

代码的作用是：

```
<?php
    $number = rand();  //assign random number to $number. let's say it's "3"
?>

//then these are printed on the page normally
<script language="javascript">
    var num = <?php echo $number ?> //the $number is echoed at this position
</script> 
```

然后浏览器收到：

```
<script language="javascript">
    var num = 3;
</script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T00:51:06.613

您必须生成语法上有效的 javascript。PHP 可以将文本回显到它生成的页面的任何部分，但这并不一定意味着它实际上是可用的文本。在您的情况下，您忘记了 a `;`，因此您生成的 javascript 实际上是语法错误：

```
var num = <?php echo $number ?>;
                               ^--- missing 
```

当您输出文本时，也会发生同样的事情。考虑将某人的姓名存储到变量中的位置：

```
<?php
   $name = "Miles O'Brien"; // <-- note the single quote
?>
<script>
   var name = <? php echo $name ?>;
</script> 
```

这**看起来**不错，但实际上会产生另一个语法错误：

```
 var name = Miles O'Brien; 
```

整个字符串周围没有引号，嵌入的引号将在 javascript 中启动一个字符串，导致 JS 解释器抱怨未定义的变量“Miles”、未定义的变量“O”和未终止的字符串文字。

相反，PHP 应该是：

```
 var name = <? echo json_encode($name) ?>; 
```

The JSON encapsulation guarantees that you're embedding syntactically valid Javascript values.

# javascript - javascript/jquery 代码不起作用 - 限制在一个页面中可以进行多少次调用？

> ID：10290283
> 
> 赞同：0
> 
> 时间：2012-04-24T00:41:57.103
> 
> 标签：javascript, jquery, html

这是我在 jquery ui 选项卡中使用的代码：

```
<script>
    $(function(){
        // Tabs
        $('#tabs1').tabs();
        $('#tabs2').tabs();
        $('#tabs3').tabs();

        //hover states on the static widgets
        $('#dialog_link, ul#icons li').hover(function(){
            $(this).addClass('ui-state-hover');
        },function() {
            $(this).removeClass('ui-state-hover');
        });
    });
</script> 
```

在此页面中：[http ://sekhu.net/charlie/index.php](http://sekhu.net/charlie/index.php)

现在大多数 jquery 调用都可以正常工作，但这个尤其只取决于我将它放在其他 init 中的位置。我正在使用 Sudo Slider jQuery 插件和 jquery 选项卡将选项卡包含在幻灯片中。这是不可能的，还是我在某处犯了错误？也许缺少一个 ; 或者其他的东西？

我是 jquery/script 的新手，所以我不知道出了什么问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:52:47.617

我认为最后`});`应该是`})();`

但我可能会将它与自动执行的匿名函数混淆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:24:40.860

你做事的顺序在 JavaScript 中通常很重要，尤其是当你向动态加载的锚点添加事件时。您需要按以下顺序执行操作：

1.  使用动态 AJAX 调用检索数据

2.  处理数据并显示结果，其中可能包括锚点列表

3.  为事件安装侦听器，例如单击并悬停在 #2 中显示的锚点上。

如果您在显示数据之前尝试安装监听器，它们将不会监听。所以不要将监听器安装在 document.ready() 或 init() 函数中，将它们安装在加载监听器应用的动态数据的函数的回调中。像这样的东西

```
$.get('myUrl',function(data){         // get dynamic data
    var anchorList = myProcess(data); // create a menu from the dynamic data
    $('#myTarget').html(anchorList);  // display the menu
    $('#myTarget a').hover( ... );    //  *now* install the listeners
    $('#myTarget a').click( ... );
}); 
```

# testing - google-analytics.com 阻止我本地的测试用例

> ID：10290284
> 
> 赞同：0
> 
> 时间：2012-04-24T00:42:01.607
> 
> 标签：testing, web-applications, selenium, web

我在本地开发环境中运行 selenium 测试用例...有时一些测试用例会失败，因为它们一直在等待响应...查看 Firefox 底部的状态栏 ..它一直在说

```
waiting for www.google-analytics.com.... 
```

因为我在本地运行所有东西，所以我不明白 google-analytics.com 在哪里发挥作用，谁能告诉我发生了什么，我该如何关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:30:48.217

如果您使用的是 Windows 并且“**您不关心 www.google-analytics.com 在您的站点中所做的事情”** - 您可以在**C:\Windows\System32\drivers\etc\hosts 文件中添加以下行**

```
127.0.0.1 www.google-analytics.com 
```

这实际上会将所有 google-analytics.com 调用重定向到您的本地计算机。分析团队通常使用谷歌分析来跟踪网站上的统计数据，例如最常查看的页面等。

我觉得如果你在做自动化，你的请求不应该算作自然流量。因此不应该去谷歌分析

# ruby-on-rails-3 - FactoryGirl：为什么 attributes_for 省略了一些属性？

> ID：10290286
> 
> 赞同：16
> 
> 时间：2012-04-24T00:42:17.387
> 
> 标签：ruby-on-rails-3, factory-bot

我想在控制器测试中使用 FactoryGirl.attributes_for，如：

```
it "raise error creating a new PremiseGroup for this user" do
  expect {
    post :create, {:premise_group => FactoryGirl.attributes_for(:premise_group)}
  }.to raise_error(CanCan::AccessDenied)
end 
```

...但这不起作用，因为 #attributes_for 省略了 :user_id 属性。`#create`这是和之间的区别`#attributes_for`：

```
>> FactoryGirl.create(:premise_group)
=> #<PremiseGroup id: 3, name: "PremiseGroup_4", user_id: 6, is_visible: false, is_open: false)
>> FactoryGirl.attributes_for(:premise_group)
=> {:name=>"PremiseGroup_5", :is_visible=>false, :is_open=>false} 
```

请注意， :user_id 不存在于`#attributes_for`. 这是预期的行为吗？

FWIW，我的工厂文件包括对`:premise_group`和的定义`:user`：

```
FactoryGirl.define do
  ...
  factory :premise_group do
    sequence(:name) {|n| "PremiseGroup_#{n}"}
    user
    is_visible false
    is_open false
  end
  factory :user do
    ...
  end
end 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-24T08:26:44.540

## 简短的回答：

按照设计，FactoryGirl`attribues_for`故意省略了会触发数据库事务的事情，以便测试能够快速运行。`build_attributes`但是，如果您愿意花点时间，您可以编写一个方法（如下）来对所有属性进行建模。

## 原始答案

Digging deep into the FactoryGirl documentation, e.g. [this wiki page](https://github.com/thoughtbot/factory_girl/wiki/Usage), you will find mentions that `attributes_for` ignores associations -- see update below. As a workaround, I've wrapped a helper method around `FactoryGirl.build(...).attributes` that strips `id`, `created_at`, and `updated_at`:

```
def build_attributes(*args)
  FactoryGirl.build(*args).attributes.delete_if do |k, v| 
    ["id", "created_at", "updated_at"].member?(k)
  end
end 
```

So now:

```
>> build_attributes(:premise_group)
=> {"name"=>"PremiseGroup_21", "user_id"=>29, "is_visible"=>false, "is_open"=>false} 
```

... which is exactly what's expected.

### update

Having absorbed the comments from the creators of FactoryGirl, I understand why `attributes_for` ignores associations: referencing an association generates a call to the db which can greatly slow down tests in some cases. But if you need associations, the `build_attributes` approach shown above should work.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:40:01.160

I think this is a slight improvement over fearless_fool's answer, although it depends on your desired result.

Easiest to explain with an example. Say you have lat and long attributes in your model. On your form, you don't have lat and long fields, but rather lat degree, lat minute, lat second, etc. These later can converted to the decimal lat long form.

Say your factory is like so:

```
factory :something
  lat_d 12
  lat_m 32
  ..
  long_d 23
  long_m 23.2
end 
```

fearless's `build_attributes` would return `{ lat: nil, long: nil}`. While the `build_attributes` below will return `{ lat_d: 12, lat_m: 32..., lat: nil...}`

```
def build_attributes
  ba = FactoryGirl.build(*args).attributes.delete_if do |k, v| 
    ["id", "created_at", "updated_at"].member?(k)
  end
  af = FactoryGirl.attributes_for(*args)
  ba.symbolize_keys.merge(af)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T15:04:34.730

To further elaborate on the given `build_attributes` solution, I modified it to only add the accessible associations:

```
def build_attributes(*args)
    obj = FactoryGirl.build(*args)
    associations = obj.class.reflect_on_all_associations(:belongs_to).map { |a| "#{a.name}_id" }
    accessible = obj.class.accessible_attributes

    accessible_associations = obj.attributes.delete_if do |k, v| 
        !associations.member?(k) or !accessible.include?(k)
    end

    FactoryGirl.attributes_for(*args).merge(accessible_associations.symbolize_keys)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-03T20:32:18.610

Here is another way:

`FactoryGirl.build(:car).attributes.except('id', 'created_at', 'updated_at').symbolize_keys`

Limitations:

*   It does not generate attributes for HMT and HABTM associations (as these associations are stored in a join table, not an actual attribute).
*   Association strategy in the factory must be `create`, as in `association :user, strategy: :create`. This strategy can make your factory very slow if you don't use it wisely.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-09T07:42:32.027

The accepted answer seems outdated as it did not work for me, after digging through the web & especially [this Github issue](https://github.com/thoughtbot/factory_bot/issues/359), I present you:

### A clean version for the most basic functionality for Rails 5+

This **creates** `:belongs_to` associations and adds their `id` (and `type` if `:polymorphic`) to the attributes. It also includes the code through `FactoryBot::Syntax::Methods` [instead of an own module limited to controllers](https://github.com/thoughtbot/factory_bot/issues/359#issuecomment-395706569).

**spec/support/factory_bot_macros.rb**

```
module FactoryBot::Syntax::Methods
  def nested_attributes_for(*args)
    attributes = attributes_for(*args)
    klass = args.first.to_s.camelize.constantize

    klass.reflect_on_all_associations(:belongs_to).each do |r|
      association = FactoryBot.create(r.class_name.underscore)
      attributes["#{r.name}_id"] = association.id
      attributes["#{r.name}_type"] = association.class.name if r.options[:polymorphic]
    end

    attributes
  end
end 
```

* * *

this is an adapted version [of jamesst20 on the github issue](https://github.com/thoughtbot/factory_bot/issues/359#issuecomment-509216228) - kudos to him

# bash - 从 2 个不同的行中剪切命令

> ID：10290287
> 
> 赞同：0
> 
> 时间：2012-04-24T00:42:18.527
> 
> 标签：bash

我下面的代码提取了“国家”，但我如何在第二行中提取“城市”？

```
geoiplookup 212.58.246.82 | grep Country | cut -c 28-45 
```

* * *

```
GeoIP Country Edition: GB, United Kingdom
GeoIP City Edition, Rev 1: GB, N7, Tadworth, N/A, 51.283298, -0.233300, 0, 0
GeoIP City Edition, Rev 0: GB, N7, Tadworth, N/A, 51.283298, -0.233300 
```

我希望我的输出看起来像这样 -> city, Country

例如：英国塔德沃思

我的代码目前只给了我英国

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:58:16.093

`geoiplookup`正在产生逗号分隔的输出。正如您对`cut`命令所做的那样，尝试按列号提取数据将非常脆弱。 `cut`使用字段分隔符 - or`awk`或高级脚本语言 - 将更加灵活。例如，以下`awk`脚本将大致执行您想要的操作：

```
 BEGIN {FS=":"}

  /GeoIP Country Edition/ {
          split($2, parts, ", ")
          country_code=parts[1]
          country_name=parts[2]
          }

  /GeoIP City Edition/ {
          split($2, parts, ", ")
          city_name=parts[3]

          printf "%s, %s\n", city_name, country_name
          } 
```

我们首先将每一行拆分为一个标签和一个以 . 分隔的数据`:`。然后在数据中，我们拆分`,`并提取相关字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T19:55:46.340

尝试这个

```
geoiplookup 212.58.246.82 | cut -d' ' -f2 | tr "\n" "," 
```

# cmake - 构建 cppblog 时出现 cmake 错误

> ID：10290291
> 
> 赞同：0
> 
> 时间：2012-04-24T00:42:41.613
> 
> 标签：cmake, cppcms

我在`~/progs/cppcms/cppcms-1.0.1/build`. 我安装了 cppblog 的所有先决条件并尝试安装博客，但出现错误：

```
~/progs/cppcms/cppblog_0.1.0/build 
> cmake ..
CMake Error: The following variables are used in this project, but they are set to NOTFOUND.
Please set them or make sure they are set and tested correctly in the CMake files:
INC_CPPDB
   used as include directory in directory /home/kirill/progs/cppcms/cppblog_0.1.0
INC_MARKDOWN
   used as include directory in directory /home/kirill/progs/cppcms/cppblog_0.1.0
LIB_CPPDB
    linked by target "cppblog" in directory /home/kirill/progs/cppcms/cppblog_0.1.0
    linked by target "cppblog_migrate" in directory /home/kirill/progs/cppcms/cppblog_0.1.0
LIB_MARKDOWN
    linked by target "cppblog" in directory /home/kirill/progs/cppcms/cppblog_0.1.0

-- Configuring incomplete, errors occurred! 
```

我尝试了几件事，但无法让它工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:33:39.887

它无法找到 CppDB 和 Markdown 的库或包含文件。

假设这些已经安装，您应该能够使用以下参数运行 CMake：

```
-DCMAKE_LIBRARY_PATH:PATH=<path to CppDB lib>;<path to Markdown lib> -DCMAKE_INCLUDE_PATH:PATH=<path to CppDB includes>;<path to Markdown includes> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T04:55:33.287

提出此类问题的最佳地点是 cppcms 邮件列表： [https ://lists.sourceforge.net/lists/listinfo/cppcms-users](https://lists.sourceforge.net/lists/listinfo/cppcms-users)

cppcms 创建者非常积极地支持那里的用户，您一定会得到最合适的答案。

# django - 如何使用 django 和 selenium/grid 模拟并行多用户可用性测试？

> ID：10290294
> 
> 赞同：1
> 
> 时间：2012-04-24T00:43:00.770
> 
> 标签：django, testing, selenium, selenium-grid

我可以使用[LiveServerTestCase](https://docs.djangoproject.com/en/dev/topics/testing/#django.test.LiveServerTestCase)在 Django 1.4 上为一个用户/按顺序运行我的 Selenium 测试，但我想模拟并行多用户测试。我认为我不需要真正的负载测试，因为我的应用程序大多是中等/低流量的网站和内部网络应用程序，所以我宁愿避免使用 JMeter 等额外的工具。

我已经开始设置[Selenium Grid](http://selenium-grid.seleniumhq.org/)，但不知道如何让我的测试保持独立并仍然与多个用户一起运行多个测试。我假设测试用例应该同时在同一个数据库上为不同的用户运行——但是每个测试都会删除并创建一个新的数据库，所以我不明白这是怎么可能的。

而且我不想注册像[BrowserMob](http://browsermob.com)这样的服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T20:32:58.763

出于几个不同的原因，我建议使用 JMeter 之类的工具：

1.  如果您想在多个用户同时访问服务时测试没有错误，则不能保证会同时运行两个或多个自动化 selenium 测试，因为这可能需要相当长的时间在请求实际发送到服务器之前执行任何操作。当使用像 jmeter 这样可以同时发送多个请求而请求之间几乎没有延迟的工具时，您更有可能遇到这类错误。您还可以轻松地同时执行比 Selenium 更多的 jmeter 线程。
2.  如果你真的想测试你的网站的性能，或者你的网站在超过正常负载下的行为，你可以使用 jmeter 等工具更容易地做到这一点。

话虽如此，如果您真的想为此使用 Selenium，我知道 Selenium2/Webdriver 相当简单，但是我对 Selenium Grid 不够熟悉，无法提供有关那里需要什么的指导。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:44:16.480

我想我明白了这一点，但欢迎更多（可能更优雅）的解决方案。

我正在运行“干净”和“脏”测试。“干净”测试只是普通的 Selenium 测试，每次测试后都会设置和拆除数据库。“脏”测试是通过将选项传递给我的子类 DjangoTestSuiteRunner 来运行的，该选项告诉它是否设置或拆除数据库，并传入用户 ID，如下所示：

```
python manage.py test myapp --testrunner=testrunner.MySeleniumTestRunner \ 
    --no_setup_db --no_teardown_db --user=1234 --liveserver=localhost:8081 
```

然后，我在一个 shell 脚本中将大约 10 个这些命令串在一起并记录输出。

唯一棘手的部分是以同时考虑这两种测试的方式编写测试。因此，例如，如果我只是在干净测试中将产品添加到购物车并检查购物车中的商品以表明成功，那么我还需要添加一个条件来检查产品可用性等内容。因此，当我运行我的脏测试时，如果只有四个产品可用，那么前四个用户是成功的，因为该产品可用并且我验证该产品已添加到他们的购物车 - 但第五个用户*也*通过了测试，因为当产品不可用我检查是否有正确的错误处理等。

我知道这不是很像单元测试，甚至可能是功能测试的非标准测试，但我认为它很好地模拟了并行多用户测试，而不会影响测试独立性。

# opengl-es - 存储动画网格的总体策略

> ID：10290295
> 
> 赞同：0
> 
> 时间：2012-04-24T00:43:03.987
> 
> 标签：opengl-es, opengl-es-2.0

我一直在尝试弄清楚如何将在 3ds max 之类的程序中生成的网格用动画、纹理等带入你的游戏中。

我看过 FBX 和 Collada，但根据我的阅读，它们被用作建模软件和可能为游戏定制的一些最终格式之间的中间步骤。我正在寻找的是一本书或教程，它将以一般方式介绍您将在自定义文件中存储的内容、如何存储动画数据等。

现在我真的没有一个总体的攻击计划，我见过的所有指南都坚持渲染几个三角形。

它不必是特定于 OpenGL 的实现，尽管这是我将使用的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T11:11:38.630

是的 Collada 是一种交换格式。这意味着它非常通用。如果我是对的，那正是您要找的！

您可以使用诸如 Assimp 之类的库将 collada 加载到通用场景图中，然后让您的游戏/渲染器直接使用它，或者预处理然后使用它。

# jquery - 图片下拉框

> ID：10290297
> 
> 赞同：0
> 
> 时间：2012-04-24T00:43:09.680
> 
> 标签：jquery, button, drop-down-menu

我需要在我网站的左上角创建一个图片链接，当我点击它时，我会在该图片下打开一个具有预配置大小的下拉框。我如何在 JQUERY 中执行此操作。

```
> image_link______________________________________________              
> |000000000000000000000000000000000000000000000000000000|           
> |000000000000000000000000000000000000000000000000000000| 
> |000000000000000000000000000000000000000000000000000000| 
> |______________________________________________________| 
```

如上;-)。提前致谢。`enter code here`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:56:16.640

您可以像这样使用 jQuery 切换功能：http: [//jsfiddle.net/kKGyc/](http://jsfiddle.net/kKGyc/)

# actionscript-3 - Actionscript 3：self 事件侦听器是否会阻止对象被垃圾收集？

> ID：10290298
> 
> 赞同：1
> 
> 时间：2012-04-24T00:43:25.700
> 
> 标签：actionscript-3, garbage-collection, event-listener

我知道事件侦听器和对对象的引用会阻止垃圾收集器处理对象。我的问题是，放置在对象上的事件侦听器是否会侦听同一对象，以防止该对象被垃圾收集？

我问是因为这似乎发生在我身上。我打破了我对一个对象的所有引用，但是当它的计时器关闭时我仍然看到痕迹。同时，这似乎不应该阻止集合，因为它会创建已分配但不可引用的内存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:09:35.270

## 不是，但。

AVM2 垃圾收集器*应该*找到无法访问的对象。但是因为垃圾收集是非确定性的，所以很难依赖甚至测试这种行为——可能是垃圾收集器工作得很好，但是因为你有足够的可用 RAM，所以不需要运行标记和清除.

**使用完对象后删除事件侦听**器是个好主意，即使它们来自对象本身（即循环引用）。为什么这是个好主意？因为**你永远不知道垃圾收集器什么时候运行**。如果您想要确定的行为，请始终以确定的方式删除侦听器，*尤其是*对于时间敏感的事件，例如 TIMER 和 ENTER_FRAME，否则您正在运行的侦听器和运行的垃圾收集器之间创建竞争条件。垃圾收集器仅定期运行。

通常，如果您想在不创建对对象的附加引用的情况下附加事件侦听器，请将 true 传递`useWeakReference`给`addEventListener()`. 但是，如果您想立即停止接收事件，您仍然需要在完成对象后立即手动分离事件侦听器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:57:42.590

是的，这将阻止 GC 清理您的对象。尝试防止这种情况的一种hacky方法是在添加侦听器时使用弱引用。

```
 myobj.addEventListener(Event.EVENT, eventHandler, false, 0, true); 
```

最后一个 true 标志将设置侦听器以使用弱对象引用。

最佳实践是跟踪并始终在使对象为空之前删除任何活动的侦听器。

查看这篇很棒的博客文章以获取有关此主题的更多信息

[http://gskinner.com/blog/archives/2006/06/as3_resource_ma.html](http://gskinner.com/blog/archives/2006/06/as3_resource_ma.html)

# drupal - drupal 6主题问题（'用户名'，...）

> ID：10290310
> 
> 赞同：0
> 
> 时间：2012-04-24T00:45:06.153
> 
> 标签：drupal, drupal-6, drupal-theming

我正在尝试打印用户的全名而不是用户名使用`theme('username',$name);` 显示全名但作为`<a>..</a>`链接到用户个人资料页面的超链接（在两者之间）。我只想`theme()`将全名输出为纯文本。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:00:41.887

请你说你试图从哪里打印用户名。

如果您在 template.php 中执行此操作，您可以从 node_preprocess 或 page_preprocess 中使用：

```
print $vars['user']->name; 
```

或者，如果您在 .tpl 文件中，您可以使用

```
<?php print $user->name; ?> 
```

User 是一个全局变量，因此您可以从中获取各种信息。如果您想查看可用信息，请尝试将其放在 template.php 中，例如在 page_preprocess 函数/（钩子）中

```
print_r ($vars['user']); 
```

# android - Android SDK 地图视图。获取地图缩放级别/位置

> ID：10290312
> 
> 赞同：2
> 
> 时间：2012-04-24T00:45:31.923
> 
> 标签：android, overriding, android-2.2-froyo, android-mapview

我有地图在 android 上工作，并且能够用覆盖来填充它。

但是叠加能力也只有这么好。如果我添加太多叠加层并过于频繁地刷新，我可以创建一个非常难处理（无用）的应用程序。

我想要做的只是加载地图缩放级别内的叠加层。

如何使用 Google APIS、叠加层、逐项和地理点来缩放地图的级别？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:50:43.687

您可以在 MapView 上使用[`getZoomLevel`](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView#getZoomLevel%28%29)和方法。[`getMapCenter`](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView#getMapCenter%28%29)您还可以通读[MapView 类文档](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-29T04:35:28.143

您可以直接从类中获取，无需任何方法。

```
 map.getCameraPosition().zoom 
```

# ruby-on-rails - 使用 Capistrano 部署到 rbenv 时出错

> ID：10290313
> 
> 赞同：0
> 
> 时间：2012-04-24T00:45:38.870
> 
> 标签：ruby-on-rails, capistrano, rbenv

我是 Capistrano 的新手，无法调试错误。搜索表明此错误可能是选择错误版本的 ruby​​ 的环境问题（它几乎可以肯定不是引用的文件，因为它在测试中工作正常）。使用 Capistrano 任务转储 ruby​​ 版本一切看起来都很好。直接在服务器上运行命令也可以正常工作。我在服务器上使用 rbenv。

错误：

```
 * executing `deploy:assets:precompile'
 * executing "cd /home/deployer/apps/happenate/releases/20120424002545 && bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile"
   servers: ["happenate.com"]
   [happenate.com] executing command
** [out :: happenate.com] rake aborted!
** [out :: happenate.com] /home/deployer/apps/happenate/releases/20120424002545/config/initializers/session_store.rb:3: syntax error, unexpected ':', expecting $end
** [out :: happenate.com] ...sion_store :cookie_store, key: '_happenate_session'
** [out :: happenate.com] ^ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T21:50:00.183

绝对是某种红宝石环境问题。使用适当的 rbenv 环境清理所有内容后，错误就消失了。

# java - 三角区，Java

> ID：10290316
> 
> 赞同：6
> 
> 时间：2012-04-24T00:45:51.877
> 
> 标签：java, area

根据我的家庭作业，我正在尝试构建一个计算三角形面积的应用程序。不太确定我哪里出错了，但我输入了三角形的长度，并希望根据 Heron 的公式显示正确的区域`sqrt (s(s-a) (s-b) (s-c))`：我得到的只是输出`-0.0`。这是代码：

```
import java.lang.Math;
public class Formula
{
    double area; double s;
    public double findArea(double sideA, double sideB, double sideC)
    { 
        s = 1/2 * (sideA + sideB + sideC);
        area = Math.sqrt(s*(s-sideA)*(s-sideB)*(s-sideC));
        System.out.println("The area of the triangle is " + area);
        return area;
    }
} 
```

然后我有另一个主要参数的文件

```
import java.util.Scanner;

public class findTriangleArea {

    /**
     * @param args
     */

    public static void main(String[] args) {

        // TODO Auto-generated method stub
        Formula triangle = new Formula();
        double a,b,c;

        // input triangle lengths a, b, c 
        Scanner inputTriangle = new Scanner(System.in);
        System.out.println("Please enter triangle side a");
        a = inputTriangle.nextDouble();
        System.out.println("Please enter triangle side b");
        b = inputTriangle.nextDouble();
        System.out.println("Please enter triangle side c");
        c = inputTriangle.nextDouble();
        triangle.findArea(a, b, c);
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T00:48:11.517

`1/2`以整数算术计算，因此与所有整数除法一样，它被截断——在这种情况下，为`0`. 只要写`0.5`，你会没事的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-29T04:30:51.483

公共类 AreaOfTriangle {

```
public static void main(String[] args) {
    Scanner scanner=new Scanner(System.in);
    System.out.print("Enter the height: ");
    double height=scanner.nextDouble();

    System.out.print("Enter the base: ");
    double base=scanner.nextDouble();

    scanner.close();

    double area=(base*height)/2;

    System.out.println("---------------------------");
    System.out.println("Area of Triangle is: "+area);
} 
```

}

# android - Android - 在单击/禁用 SINGLE_CHOICE 模式时未检查 listView 中的自定义 CheckedTextView

> ID：10290318
> 
> 赞同：1
> 
> 时间：2012-04-24T00:46:05.840
> 
> 标签：android, listview, checkbox, checkedtextview

*   当我使用 :`android.R.layout.simple_list_item_single_choice`作为列表项的布局时，单击时会选中复选框，一切都很好。

*   但是，当我使用布局时：

```
<CheckedTextView android:id="@+id/choice_item"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="CheckedTextView"
    android:clickable="true"
    android:focusable="true"
    android:gravity="center_vertical"
    android:checkMark="?android:attr/listChoiceIndicatorMultiple" 
    android:textSize="@dimen/text_size_medium"/> 
```

复选框不会被切换。

*   如果我`onClickListener`在列表中实现这样的`adapter`：

```
((CheckedTextView) convertView.findViewById(R.id.dp_quiz_answer_choice_item)).setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        ((CheckedTextView) v).toggle();
    }
}); 
```

`SINGLE_CHOICE`模式被禁用（可以启用任意数量的复选框）。

*   如果我`setOnItemClickListener`在列表视图中实现，复选框将不会被切换。

```
mChoiceList.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int item,
                    long id) {
        mChoiceList.setItemChecked(item, true);
    }
}); 
```

有没有办法为`SINGLE_CHOICE`mode自定义布局`ListView`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T14:39:46.767

您正在使用SINGLE_CHOICE`?android:attr/listChoiceIndicatorMultiple`应该在的位置`?android:attr/listChoiceIndicatorSingle`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:21:01.143

这对我来说有点奇怪，经过许多其他实验后，我了解到拥有与用于我`id`的`CheckedTextView`相同的那个对我有用`android.R.layout.simple_list_item_single_choice`。标识是`@android:id/text1`.

# node.js - 为什么 Heroku 不接受我的 Node.js 版本？

> ID：10290326
> 
> 赞同：2
> 
> 时间：2012-04-24T00:47:28.853
> 
> 标签：node.js, heroku

使用以下 package.json

```
{
  "name": "...",
  "version": "0.1.1",
  "engines": {
    "node": "0.6.14",
    "npm":  "1.1.4"
  },
  "private": true,
  "scripts": {
    "start": "node app"
  },
  "dependencies": {
    "connect-assets": "2.1.9",
    "ejs": "0.7.1",
    "everyauth": "0.2.32",
    "express": "2.5.9",
    "less-middleware": "0.1.4",
    "mocha": "1.0.1",
    "should": "0.6.1",
    "socket.io": "0.9.6",
    "underscore": "1.3.3"
  }
} 
```

我得到以下

```
WARNING: No version of Node.js specified in package.json, see:
       https://devcenter.heroku.com/articles/nodejs-versions 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T14:33:21.450

尝试将节点版本更改为这样的

```
{
  "engines": {
    "node": "0.6.x",
    "npm":  "1.0.x"
  }
} 
```

这将尝试附加“主要”版本应该仍然可以正常工作。

# jquery - jQuery Regex 忽略周围的 JS 标签

> ID：10290328
> 
> 赞同：0
> 
> 时间：2012-04-24T00:47:32.347
> 
> 标签：jquery, html, regex

我在 jQuery 中对随机 HTML 页面执行简单的文本搜索/替换，但我在忽略出现在属性中的术语时遇到问题，即如果我的术语是`jquery`，我想忽略所有术语，`<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> jquery` 同时仍然点击外部. 现在我的代码看起来有点像这样：

```
$("div#content").html($("div#content").text().replace(/(jquery)/g, "stuff")); 
```

我一直在看正面/负面的前瞻/后视，但我无法正确理解。除了 jQuery，我无法使用任何外部库，而且我已经看过[这篇文章](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。

我想一种解决方案可能是使用一些 indexOf 魔法来搜索我想要的部分，但我不知道这对于快速文本搜索是否有效或可行。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:13:47.817

除非该术语以其他方式出现在属性中，否则`(?<=[^\/])jquery`搜索所有`jquery`前面没有...的内容怎么样？`/``jquery`

[http://regexr.com?30o8n](http://regexr.com?30o8n)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:51:03.190

这是使用手动编码解析器的好例子。这几乎是唯一可以让您可靠地处理您想要处理的所有案例的方法。

基本上，将解析器视为状态机。它需要一次读取一个字符，并根据该字符及其当前解析状态为每个字符执行适当的操作。该模型使得在处理其他所有内容时忽略 HTML 标记中出现的任何文本变得相对简单。

这是一个简单的示例，可以帮助您入门：http: [//jsfiddle.net/8BeEv/](http://jsfiddle.net/8BeEv/)

请注意，示例代码当前不处理 HTML 标记内的转义序列（例如，标记`\>`内的序列会破坏它）、格式错误的 HTML 或其他可能但通常很少见的错误情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:34:03.993

刚刚偶然发现这一点，几乎可以通过仅查看文本节点来解决我之前遇到的问题： [https ://stackoverflow.com/a/4515063/660036](https://stackoverflow.com/a/4515063/660036)

我认为这个解决方案不会处理跨越多个文本节点的文本，即在

```
the <strong>qui</strong>ck brown fox 
```

但是解决这些情况所需的复杂性比我现在需要的要高得多=P

# c# - 使用存储库、数据转换和数学公式的设计原则/模式

> ID：10290332
> 
> 赞同：0
> 
> 时间：2012-04-24T00:48:14.637
> 
> 标签：c#, asp.net-mvc, design-patterns

**更新**

我有一个 RiskReport 类型，它从 IReportRepository 获取数据，操作数据，并根据预定义的公式计算风险。

有人可能会争辩说，RiskReport 类型应该以准确的格式获取数据，而不是执行数据操作。RiskReport 应该只关心如何根据公式计算数据，而 IReportRepository 应该只返回 RiskReport 类所需的数据。

是否应该在 IReportRepository 和 RiskReport 之间引入一个新类？因为，目前，从 IReportRepository 返回的数据被处理为计算风险所需的格式。

```
class RiskReport 
{
    private IReportRepository reportRepository;

    public RiskReport(IReportRepository reportRepository)
    {
        this.reportRepository = reportRepository;
    }

    public decimal CalculateDataBasedOnFormula()
    {
        var result = from d in reportRepository.GetReportRelatedData()
                     group d by d.Id into dgp   //potentially complex grouping
                     select new
                                {
                                    TotalPage = dgp.Sum(x=>x.Pages)  //potentially complex projection
                                };

        decimal risk=  //use the result variable to calculate data based on complex formula not shown here

        return risk;

    }
}

interface IReportRepository
{
    IEnumerable<ReportRelatedData> GetReportRelatedData();
}

public class ReportRepository: IReportRepository
{

    public IEnumerable<ReportRelatedData> GetReportRelatedData()
    {
       //return data from underlying data source
        return new BindingList<ReportRelatedData>();
    }
}

public class ReportRelatedData
{
    public int Id { get; set; }
    public int Name { get; set; }
    public int Pages { get; set; }
    //... more properties here
} 
```

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:05:49.427

> I have a Report type, which gets data from IReportRepository, manipulates the data, and calculates rate according to predefined formula.

I think the answer is in your first sentence. If you want the code to be good, make it [SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29). "S" stands for Single Responsibility Principle. In other words, if you describe what a class does, don't use the word "and". Change your design accordingly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:54:44.010

我认为这是其中一个问题，如果你问 1000 个开发人员，你可以获得 1000 个答案，但是是的，我会说应该使用另一个类。这是我的理由：

1.  可以独立测试“数学”类
2.  可以重用一个单独的类，保持代码的其余部分 DRY
3.  如果公式发生变化，重构将不会嵌入到您的报告代码中

如果我必须继承代码库，我希望在这里看到三个类，所以如果我正在开发它，我想留给下一个开发者。

干杯。

# regex - 正则表达式模型验证（数字或空字符串）

> ID：10290333
> 
> 赞同：0
> 
> 时间：2012-04-24T00:48:29.353
> 
> 标签：regex, asp.net-mvc-3

我需要匹配多个 1-5 位数字或空字符串以进行模型验证：
模型：

```
[RegularExpression(@"\d{0,5}", ErrorMessage = "Error")]
public string ServiceNumber { get; set; } 
```

看法：

```
@Html.TextBoxFor(m => m.ServiceNumber) 
```

这不会让我把输入留空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:15:16.380

Have you tried `\d{1,5}|^$`? The `^$` is an empty string because `^` is the start of the string and `$` is the end of the string in regex so `^$` means start and end string with nothing inside. The `|` means OR, either match 1-5 digits OR empty string.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:15:45.393

Have you tried `@"(\d{1,5})?"` ?

# ruby-on-rails - 如何在 Rails 中使用“_blank”或“_new”

> ID：10290335
> 
> 赞同：20
> 
> 时间：2012-04-24T00:48:58.667
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在 HTML 中，如果我想在新窗口中打开一个链接，我会像这样采用**target="_blank"**：

```
<a href="http://www.website.com/" target="_blank"><img src="/img.png" /></a> 
```

如何将**“_blank”**添加到导轨？这是我到目前为止的链接代码（但它目前在同一个选项卡/窗口中打开）：

```
<%= link_to image_tag("img.png"), 'http://www.website.com/' %> 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-24T01:02:37.783

我想是这样的

```
<%= link_to image_tag('img.png'), 'http://www.website.com', target: '_blank' %> 
```

见[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-19T10:17:43.100

对于任何想知道在传递块时如何实现这一点的人：

`<%= link_to(product.link, target: '_blank') do %>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T12:44:33.280

您可以将 js 中链接的默认操作删除为

```
$('#button-id').click(function(e){
  e.preventDefault();      
}); 
```

preventDefault() 函数防止事件的默认动作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-23T23:34:41.500

`target: :_blank`如果您更喜欢使用符号，您也可以这样做

# sms - SMS 文本消息 - 换行符算作字符吗？

> ID：10290337
> 
> 赞同：4
> 
> 时间：2012-04-24T00:49:16.210
> 
> 标签：sms

我正在开发一个与 SMS API 集成的系统，我想知道换行符是否计入字符限制，我找不到任何关于此的文档。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T00:53:30.093

是的，它确实。**您在消息中嵌入的任何**字符都计入限制，无论它是否“可见”。即使它不是可打印的字符，您仍然通过蜂窝网络发送该字符并导致蜂窝网络耗尽（正如他们声称的那样）大量带宽，而这些带宽要收取可笑的费率来处理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T00:53:44.900

任何字符都计入您的 SMS 限制。包括换行符。

我实际上找不到标准或任何东西。但我知道消息大小限制为 160 个 7 位字符、140 个 8 位字符或 70 个 16 位字符，具体取决于使用的字母表。

对不起，我不能给你任何消息来源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T00:53:55.240

我刚刚在我的手机上测试了它。是的，换行很重要

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-20T06:16:27.113

是的，每个换行符、空格和回车都会增加您的字符数。

1 个空格 = 1 个字符

1 个换行符 = 2 个字符

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T01:03:06.683

是的，它确实。另外作为旁注，我注意到如果文本中有任何 unicode 字符，则整个消息将被视为 unicode，并且消息的长度乘以 3。

# php - PHP，围绕链接的javascript

> ID：10290342
> 
> 赞同：0
> 
> 时间：2012-04-24T00:49:33.013
> 
> 标签：php, javascript, html

我有一小段 javascript 让用户确认我网站上的内容。我有一个链接，我还要求他们在继续之前确认。我已经使用带有按钮的“onclick”功能没问题，但是如何在链接上使用它？

这是我的链接：

```
echo"<a href=\"$urlHTML\">Delete</a>"; 
```

这是我的“点击”：

```
onclick="return confirm('Please confirm you wish to edit these details')"/> 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:52:20.840

嗯……

```
<?php ?>
<a href="<?php echo $urlHTML ?>" onclick="return confirm(blah blah blah)">Delete</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:52:35.143

您可能要考虑使用[addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)和[attachEvent](http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx) (IE) 而不是使用内联 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:57:47.523

您可以在锚标记上使用 onclick，就像在按钮上使用它一样：

```
<a href="<?php echo $urlHTML; ?>" onclick="return confirm('Please confirm you wish to edit these details');">Delete</a> 
```

但是，您最好使用事件处理程序：

```
<script type="text/javascript">
    function myClickHandler() {
        return confirm("Really?");
    }

    document.getElementById("my_link").onclick = myClickHandler;
</script>

<a id="my_link" href="<?php echo $urlHTML; ?>">Delete</a> 
```

我建议您也阅读[jQuery](http://jquery.com/)。它会为你节省很多时间。

# java - 多线程概念

> ID：10290356
> 
> 赞同：0
> 
> 时间：2012-04-24T00:51:35.053
> 
> 标签：java

我试图理解几个 Java 概念：

*   当线程包含开始值和结束值时，如何为线程创建名称？
*   如何打印出范围内的线程？IE。Name_1_10、Name_11_20 等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:58:48.827

你可以这样做：

```
public String makeName(String prefix, int min, int max) {
    return prefix + "_" + min + "_" + max;
} 
```

然后你可以调用它：

```
String firstName = makeName("Name", 1, 10);
// etc. 
```

# xml - 在 ColdFusion 中显示部分 XML 提要

> ID：10290358
> 
> 赞同：0
> 
> 时间：2012-04-24T00:51:41.580
> 
> 标签：xml, coldfusion

我正在使用 ColdFusion/XML，并希望在我的应用程序中显示餐厅名称。问题是餐厅名称是关键字字段的一部分，并且包含在餐厅供应的食物列表中。

```
<cfxml variable="eating">
<catalog>
<food id="bk101">
  <author>Burgers</author>
  <keywords>Burger King, pie, hamburgers, fries, milkshakes</keywords>
</food>
<food id="bk102">
  <author>Mexican</author>
  <keywords>Taco Bell, tacos, churros, burrito, gorditas</keywords>
</food>
<food id="bk103">
  <author>Pizza</author>
  <keywords>Pizza Hut, pizza, cheese, garlic bread</keywords>
</food>
<food id="bk104">
  <author>Chicken</author>
  <keywords>Chick-Fil-A, chicken, chicken wrap, sauce, Bananas Pudding Milkshake</keywords>
</food>
</catalog>
</cfxml> 
```

我想从提要中提取餐厅名称并以列表格式显示

*   汉堡王
*   塔可钟
*   必胜客
*   福来鸡

上面的 XML 提要被简化了，我有几百个这样的数据要显示。幸运的是，餐厅名称总是列在关键字字段的首位，然后是食物。如何仅从上面的 XML 提要中提取和显示餐厅名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T02:00:21.640

```
<cfset data = xmlSearch(eating,"//food") />
<cfloop array="#data#" index="i" >
        <cfoutput>#listFirst(xmlSearch(i,"keywords")[1].xmlText)#</cfoutput><br/>
</cfloop> 
```

应该这样做。

# php - 根据两个变量生成一定范围内的int

> ID：10290359
> 
> 赞同：0
> 
> 时间：2012-04-24T00:51:49.310
> 
> 标签：php, math

我正在为我的博客制作一个匿名评论系统。我需要用户从我制作的数组中随机选择一个用户名，它有 600 个用户名。我不能只是让它随机，因为那样人们就不会知道它是否是同一个人发布回复，所以我给每个帖子一个随机生成的 1-9999 之间的密钥，使用密钥和我想要的用户 ID进行某种计算，以便该数字在该特定帖子中保持一致。结果必须在 1-600 之间。

就像是：

```
user_id x foo(1-9999) = bar(1-600) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:13:57.170

您可能正在寻找的是[哈希函数](http://en.wikipedia.org/wiki/Hash_function)。引用维基百科：

> 散列函数是任何算法或子程序，可将可变长度的大型数据集（称为键）映射到固定长度的较小数据集。

因此，您可以使用标准哈希函数，加上模块化算法，进一步将该哈希函数的输出映射到您的用户名范围，如下所示：

```
function anonymise($username, $post_key) {
    $hash = hash("adler32", "$username/$post_key");
    $hash_decimal = base_convert($hash, 16, 10);
    $anonymised_id = $hash_decimal % 600;

    return $usernames[$anonymised_id];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:06:46.533

那么，您真正想要的是每张海报的唯一标识符吗？

为什么不使用[http://php.net/ip2long](http://php.net/ip2long) modded 600？

当然，您也必须对此进行一些碰撞检测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T01:07:17.303

您可以尝试在连接的 id 和 post 键上使用 md5。它为您提供了一致的 32 字节散列。它实际上是一个十六进制字符串，因此您实际上可以通过将十六进制转换为整数来轻松地将其转换为数字。

编辑：根据您的反馈。您可以将生成的 int 取模并取模 600。

# matlab - 自动标记子图

> ID：10290360
> 
> 赞同：3
> 
> 时间：2012-04-24T00:51:53.950
> 
> 标签：matlab

我在一个图中有 4 个子图，想将它们标记为 a、b、c 和 d。我希望字母自动放置在每个子图的左上角。我知道我可以手动添加文本，但有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T02:04:56.753

您可以将这些内容放入脚本中：

```
subplot(2,2,1)
text(0.02,0.98,'a','Units', 'Normalized', 'VerticalAlignment', 'Top')
subplot(2,2,2)
text(0.02,0.98,'b','Units', 'Normalized', 'VerticalAlignment', 'Top')
subplot(2,2,3)
text(0.02,0.98,'c','Units', 'Normalized', 'VerticalAlignment', 'Top')
subplot(2,2,4)
text(0.02,0.98,'d','Units', 'Normalized', 'VerticalAlignment', 'Top') 
```

请注意，我假设您的子图排列在 2x2 网格中，并且它们都是 2D 图。如果这些假设不成立，请修改 subplot 的前两个参数和/或将 az 坐标添加到文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T12:35:17.603

您还可以在子图中指定所需的行数并使用函数 char 增加字母：

```
% data:
myTriangle=(triang(100));
amplitudeFactor=[1 0.7 0.6  0.4 0.2];

% Plot, specifying number of lines in subplot:
nLine=2;
nPlot=length(amplitudeFactor);
for ind=1:nPlot
    subplot(nLine, ceil(nPlot/nLine),ind)
    plot(myTriangle*amplitudeFactor(ind))
    set(gca,'YLim',[0 1])
    text(0.02,0.98,char('a' + ind - 1),'Units', 'Normalized', 'VerticalAlignment', 'Top')
end 
```

# php - pcntl_wait 未被 SIGTERM 中断

> ID：10290366
> 
> 赞同：5
> 
> 时间：2012-04-24T00:52:41.500
> 
> 标签：php, sigterm, pcntl

根据[pcntl_wait](http://www.php.net/manual/en/function.pcntl-wait.php)的 PHP 文档，

> 等待函数暂停当前进程的执行，直到一个子进程退出，或者直到一个信号被传递，其动作是终止当前进程或调用一个信号处理函数。

但是，当我运行以下代码并将 SIGTERM 发送到父进程时，仅在子进程退出*后才*`kill -s SIGTERM [pid]`调用信号处理程序（即我必须等待睡眠完成。不应该被 SIGTERM 中断吗？*`pcntl_wait()`*

 *fork_test.php：

```
<?php
  declare(ticks = 1);

  function sig_handler($signo) {
    switch ($signo) {
      case SIGTERM:
        echo 'SIGTERM' . PHP_EOL;
        break;
      default:
    }
  }

  pcntl_signal(SIGTERM, 'sig_handler');

  $pid = pcntl_fork();

  if ($pid == -1) {
     die('could not fork');
  }
  else if ($pid) {
    echo 'parent' . PHP_EOL;

    pcntl_wait($status);
  }
  else {
    echo 'child' . PHP_EOL;
    sleep(30);
  }
?> 
```

输出（SIGTERM 仅在等待 30 秒后出现）：

```
$ php fork_test.php
child
parent
SIGTERM 
```

**PHP 版本 => 5.3.3**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:03:36.720

您的呼叫`pcntl_signal`指定应重新启动呼叫。检查[文档](http://www.php.net/manual/en/function.pcntl-signal.php)，默认情况下`restart_syscalls`。`true`因此，在孩子终止之前，您的电话`pcntl_signal`不会返回。

您无需调用[flush](http://php.net/manual/en/function.flush.php)。所以 PHP 可以将 的输出保存`echo`在缓冲区中。

因此，您看到的行为正是您要求的行为。重新启动系统调用并缓冲输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-22T15:48:55.053

`pcntl_wait`呼叫不能被信号中断，除非`restart_syscalls=false`孩子死了。

从`wait`系统调用的文档（这是什么`pcntl_wait`调用）：

> ...它们会阻塞，直到子更改状态或**信号处理程序中断调用（假设系统调用不会**使用 sigaction(2) 的 SA_RESTART 标志自动重新启动）。

最后一部分非常重要。只有当系统调用没有自动重启时，调用才会被中断（`restart_syscalls=false`）。

有趣的是，当进程接收到信号时，并非所有系统调用的行为都相同。例如，`sleep`系统调用将等待几秒或等待任何信号，然后再继续。`sleep`即使您通过，也不会在中断的地方重新启动`restart_syscalls=true`。从`sleep`手册：

> sleep() 导致调用线程休眠，直到经过以秒为单位指定的实时秒数，或者**直到没有被忽略的信号到达。**

**TL;博士; pcntl_wait 不能被打断，除非你通过`restart_syscalls=false`.***

# google-chrome - Chrome 使用哪种软件在打印时显示来自 html 的 PDF？

> ID：10290368
> 
> 赞同：2
> 
> 时间：2012-04-24T00:53:10.323
> 
> 标签：google-chrome, pdf-generation

Chrome 使用哪种软件在打印时显示来自 html 的 PDF？是否有任何包装器可以从 .net 框架等中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:17:44.650

I am not very familiar with the chromium [codebase](http://code.google.com/searchframe#OAMlx_jo-ck/src/third_party/skia/src/pdf/), but it appears that they are using [skia](http://code.google.com/p/skia/) a C++ library. I couldn't find any C# wrappers for it.

# jquery - Jquery - 在数组中的每个新行之前添加 html

> ID：10290370
> 
> 赞同：0
> 
> 时间：2012-04-24T00:53:34.167
> 
> 标签：jquery, html, split, append, newline

我一直在尝试通过在其内容顶部添加一个有序列表，然后在每个新行之前添加一个 LI 和一个 P 来设置 html CODE 元素的样式，并将它们的结束标记添加到每行的末尾。

这就是我所拥有的：

```
 $("#mydiv code").each(function(){
        var oldcontent = $(this).html();
        $(this).html("<span class='olnumbers'></span><ol class='code'>" + oldcontent + "</ol>");
        var lines = oldcontent.split(/[\n\r]/g);
        $.each(lines, function(e){
                $(this).html("<li><p>" + lines + "</p></li>");
        });

 }); 
```

这根本行不通。我没有错误，我不知道出了什么问题。有人知道如何解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:57:21.107

您不能在每个功能中使用它。

[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

> jQuery.each（集合，回调（indexInArray，valueOfElement））
> 
> collection 要迭代的对象或数组。
> 
> callback(indexInArray, valueOfElement) 将在每个对象上执行的函数。

试试这个：

```
var html = [];
$.each(lines, function(i, val){
                html.push("<li><p>" + val + "</p></li>");
        });
$(this).html(html.join('')); 
```

# actionscript-3 - 在 Flash 中加载 FlashXML Elite Gallery 三次

> ID：10290372
> 
> 赞同：0
> 
> 时间：2012-04-24T00:53:47.070
> 
> 标签：actionscript-3, flash, flash-cs5

我试图在我的闪存文件上使用精英画廊三次。

一个用于游戏链接，一个用于应用程序和原型。

我正在使用免费版本，所以我正在使用 URLRequest 和 Loader 类来加载每个精英画廊 swf。

我已将“应用程序”精英图库放入另一个文件夹，即“精英应用程序”文件夹，以便区分。

当我尝试在elite_apps 文件夹中运行精英画廊的swf 时，它会打开正确的图像......但是当我尝试将“elite_apps”文件夹的swf 加载到主类中时，它似乎加载了相同的swf , (或至少相同的图像和 xml 设置), '游戏' 精英画廊 swf。“游戏”精英画廊 swf 在我的网站打开时加载，因此它是第一个加载的画廊。

要加载“应用程序”精英图库（位于“精英应用程序”文件夹内），我需要单击“应用程序库”按钮链接。

有人有任何提示吗？

如果我在目录“elite_apps”上打开应用程序精英库，它会打开正确的图像，但是当应用程序精英库 swf 加载到我网站的主类上时，它会加载游戏精英库的图像。也许，我应该尝试更改一些 xml，因为当我尝试加载应用程序库 swf 时，我猜精英库没有加载“elite_apps”文件夹的“settings.xml”。我想正在加载用于“游戏”“settings.xml”的相同的精英画廊。

你认为呢？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T02:40:42.817

我已经向 FlashXML 支持发送了一封关于它的电子邮件。他们说我只能使用画廊 swf，如果我购买了组件。

# javascript - 将点击函数转换为调用函数

> ID：10290373
> 
> 赞同：0
> 
> 时间：2012-04-24T00:53:50.463
> 
> 标签：javascript

我知道这个话题之前被问过，但他们不是关于 jqueryui 的。因此，我不能确定他们会在我的代码上工作。我有一个从不同组件调用的弹出窗口。但是我必须为每个调用编写一个点击函数。我想将它转换为我可以调用它的 ca 函数。我的脚本是：

```
 <script type="text/javascript">
        $(document).ready(function () {
            $('a#popup').live('click', function (e) {

                var page = $(this).attr("href")

                var $dialog = $('<div id="silmeIframe"></div>')
                .html('<iframe  style="border: 0px; " src="' + page + '" width="500px" height="500px"></iframe>')
                .dialog({
                    autoOpen: false,
                    modal: true,
                    height: 'auto',
                    resizable: 'false',
                    width: 'auto',
                    title: "Silmeyi onaylıyor musunuz?",
                    close: function (event, ui) {

                        __doPostBack('<%= btnRefresh.ClientID %>', '');
                    }
                });
                $dialog.dialog('open');
                e.preventDefault();

            });

        });
    </script> 
```

现在，我希望它像

```
<a onclick="NewFunctionName(parameter1,parameter2,,parameter3)">click<a/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:11:29.910

[单个处理程序，多个目标附件](http://jsfiddle.net/8JRRr/)

```
$(function () {

    function handler(e,param1,param2...) {
        var page = $(this).attr("href")
        ...
        $dialog.dialog('open');
        e.preventDefault();
    }

    //write attachments
    $('a#popup1').on('click',function(e){
        handler(e,param1,param2...);
    });
    $('a#popup2').on('click',function(e){
        handler(e,param1,param2...);
    });
    $('a#popup3').on('click',function(e){
        handler(e,param1,param2...);
    });
}); 
```

[或单个处理程序，一个查询中的多个目标](http://jsfiddle.net/wHDsD/)

```
$(function () {
    $('a#popup1, a#popup2, a#popup3').on('click',function (e) {
        var page = $(this).attr("href")
        ...
        $dialog.dialog('open');
        e.preventDefault();
    });
}); 
```

# ruby-on-rails - Gmaps4rails - 模型中的通用信息窗口，但在控制器中被覆盖

> ID：10290381
> 
> 赞同：1
> 
> 时间：2012-04-24T00:55:14.587
> 
> 标签：ruby-on-rails, view, partial, gmaps4rails

我有一个名为 store 的模型，它定义了这个：

```
def gmaps4rails_infowindow
 html_window = ''
 html_window = "<b>#{self.location_name}"
end 
```

我想要这个窗口用于我渲染的所有地图，除了我想从模板创建信息窗口的地图。

我的控制器中有这段代码：

```
@list_of_stores = Store.all.to_gmaps4rails do |store,marker|
 marker.infowindow render_to_string(:partial => 'store_window', :locals => {:store => store}
end 
```

如果我摆脱`gmaps4rails_infowindow`模型中的 ，我可以用局部渲染窗口。否则，窗口的内容始终是模型中设置的内容。

我怎样才能覆盖它？我想在模型中使用该方法，但在某些情况下我想避免使用它，而只使用我部分拥有的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:09:35.090

现在在 v1.5.1 中可用，尽情享受吧！

# facebook-opengraph - 在 OpenGraph 的 ActionImage[] 部分中放入什么？

> ID：10290385
> 
> 赞同：0
> 
> 时间：2012-04-24T00:55:59.933
> 
> 标签：facebook-opengraph

我想集成一个应用程序，用户在我的网站上发布照片并将该照片与他们被邀请的特定组相关联。

我正在查看 Facebook 上的这个 Opengraph 控制台，上面写着 ActionImage[]。我是在此处链接我网站上的照片的实际样本，还是只写照片的模拟网址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T17:11:55.503

例如，在您的参数中执行 image[0][user_generated]=true&image[0][url]=imageurl ...

# c# - 我可以在 C# 中从字符串映射到构造函数吗？

> ID：10290386
> 
> 赞同：1
> 
> 时间：2012-04-24T00:56:06.227
> 
> 标签：c#, constructor

我有字符串输入，根据该输入的值，我想调用特定对象的构造函数（**new Object1(int)、new Object2(string)、new Object3(int, int)**等都实现了IObject 接口）。

而不是这样做链接 if/else 语句的明显（和缓慢）的方式，我想做一些事情，比如有一个从字符串到构造函数的字典（例如 {"object1" -> new Object1(int) })

有什么方法可以在 C# 中做这样的事情，也许是通过将“typeof”与构造函数结合起来？我想避免使用工厂，因为那需要并行代码结构，而我想避免这种情况。

先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T01:04:23.817

你可以这样做：

```
var d = new Dictionary<string, Func<IObject>>();
d.Add("Object1", () => new Object1());
d.Add("Object2", () => new Object2());
d.Add("Object3", () => new Object3());
string typename = GetAStringFromSomewhere();
IObject foo = d[typename](); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:08:32.903

通常的方法是使用[反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.100%29.aspx)

特别是，[Assembly.CreateInstance](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.createinstance.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T01:40:46.230

如何定义一个静态方法来为您想要的每个类创建一个对象，然后使用字典映射字符串到静态生产者方法的委托类型？好吧，我知道这不是您的问题想要的，但我现在无法评论您的问题。

```
class Program
{
    delegate object GetObjDelegate();
    static Dictionary<string, GetObjDelegate> Dic = new Dictionary<string, GetObjDelegate>();

    static void Main(string[] args)
    {
        Dic.Add("aaa", A.GetObj);
        Dic.Add("bbb", B.GetObj);

        object a = Dic["aaa"]();
        object b = Dic["bbb"]();
    }
}

class A
{
    public A()
    {
    }

    public static A GetObj()
    {
        return new A();
    }
}

class B
{
    public B()
    {
    }

    public static B GetObj()
    {
        return new B();
    }
} 
```

# session - session_is_registered 和 register_session 替换

> ID：10290389
> 
> 赞同：0
> 
> 时间：2012-04-24T00:57:07.827
> 
> 标签：session, php

目前，我的网站有一个仅供会员使用的网站。每个页面都会检查一个已注册的会话 check_login.php：

```
// Register $myusername, $mypassword and redirect to Members' Area homepage
session_register("myusername");
session_register("mypassword");
header("location:Members_Area.php"); 
```

成员_区域.php：

```
<?php 
session_start();
if (!session_is_registered(myusername)) {
    header("location:main_login.php"); //main_login.php is the login page
} 
```

但是，在 PHP 5.4.0 中不推荐使用 session_register 和 session_is_registered。我怎样才能让这个代码工作，以便它可以与 5.4.0 一起工作？我见过使用：

```
$_SESSION['name'] = $myusername; 
```

但我不知道如何执行我目前使用的验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:03:48.937

`session_register`基本上是将一个键和一个值设置为一个名为`$_SESSION`. 这就是它所做的一切。

以前你可能做过：

```
$mykey = "myvalue";
session_register('mykey'); 
```

现在，做：

```
$_SESSION['mykey'] = 'myvalue' 
```

使用您的用例：

```
$_SESSION['name'] = $username;

<?    
session_start();   
if(!isset($_SESSION['name'))
    header("location:main_login.php"); //main_login.php is the login page   
}else{
    header("location:Members_area.php");
}
?> 
```

# javascript - 如何在 Javascript 中提取 URL 的结尾？

> ID：10290402
> 
> 赞同：6
> 
> 时间：2012-04-24T00:58:24.260
> 
> 标签：javascript

我有以下形式的网址：

> 服务器名称/应用程序/图像/缩略图/2012/4/23/1335228884300/bb65efd50ade4b3591dcf7f4c693042b

`serverName`服务器的域名在哪里。

我想编写一个接受这些 URL 之一并返回最后一个（最右边）正斜杠分隔字符串的 JS 函数。因此，如果将上面的 URL 传递给函数，它将返回“ `bb65efd50ade4b3591dcf7f4c693042b`”；。

```
function getImageDirectoryByFullURL(url) {
    // ... Not sure how to define regexp to delimit on forward slashes,
    // or how to start searching from end of string.
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T00:59:47.370

[用斜线分割`/`，弹出最后一个并返回它](http://jsfiddle.net/H2GE6/)

```
function getImageDirectoryByFullURL(url){
    return url.split('/').pop()
}

//a step by step breakdown
function getImageDirectoryByFullURL(url){
    url = url.split('/'); //url = ["serverName","app",...,"bb65efd50ade4b3591dcf7f4c693042b"]
    url = url.pop();      //url = "bb65efd50ade4b3591dcf7f4c693042b"
    return url;           //return "bb65efd50ade4b3591dcf7f4c693042b"
} 
```

这样做是拆分每个 url`/`并返回一个介于斜杠之间但不包括斜杠的值数组。然后，由于返回的`split()`是一个数组，我们可以使用`pop()`弹出最后一项并返回它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T01:01:25.903

在这种情况下，`substr()` *可能*比`split()`. 不是100%确定。

```
function getImageDirectoryByFullURL(url){
    return url.substr(url.lastIndexOf("/")+1);
} 
```

* * *

编辑：我忘了，你不需要包含额外的长度参数。如果不传递它，您只需将 a`substr`放在字符串的末尾，这是所需要的。虽然这个解决方案无疑比约瑟夫的答案有点丑，但它在 Chrome 中的速度是 Chrome 的两倍，在 Firefox 中的速度是它的五倍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T01:37:24.053

为了使它更健壮一点，并允许在 URL 上可能存在尾部斜杠、哈希标签或查询参数：

```
function getImageDirectoryByFullURL(url){
    url = url.replace(/#[^#]+$/, "").replace(/\?[^\?]+$/, "").replace(/\/$/, "");
    return url.substr(url.lastIndexOf("/") + 1);
} 
```

还有一个带有一堆测试用例的工作演示：http: [//jsfiddle.net/jfriend00/akVVf/](http://jsfiddle.net/jfriend00/akVVf/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T04:02:08.277

由于没有合理的正则表达式版本，请考虑：

```
return url.replace(/^.*\//,''); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T01:10:02.557

你也可以尝试这样的事情，得到相同的结果。

```
function getImageUrl( url){
    var result = url.substring(url.lastIndexOf("/") + 1);
    return result;
} 
```

# javascript - HTML5 和 Javascript 字符保存

> ID：10290405
> 
> 赞同：1
> 
> 时间：2012-04-24T00:58:41.593
> 
> 标签：javascript, html, local-storage

我正在尝试更新我的探路者字符生成器，​​以便能够使用 HTML5 的网络存储来保存字符。我有一个用于生成字符的 JavaScript 文件。

但是，我遇到了一些问题。当点击我的“更新角色”按钮时，我怎样才能做到只有已经更新的内容发生了变化？其次，展示结果的最佳方式是什么？

这是我当前的代码：

```
function SaveCharacter() {
    makeCharacter();
    if (typeof(Storage) !== "undefined") {
        if (localStorage.used) {
            alert("used was true.");
            localStorage.name = name;
        }
        else {
            localStorage.used = true;
            localStorage.name = name;
            localStorage.skill_points = num_skill_points;
            localStorage.spells = num_spells;
            localStorage.feats = num_feats;
            localStorage.hitdie = hit_die;
            localStorage.wealth = wealth;
            localStorage.Class = Class;
         // localStorage.Scores = new Array();
         // for (var i = 0; i < n; i++) {
         //         localStorage.Scores[i] = ability_scores[i];
         //         }
            }
            document.getElementById("result").innerHTML="Character Name: " + localStorage.name;
        }
        else {
            document.getElementById("result").innerHTML = "Sorry, your browser does not support web storage...";
    }
}

function DeleteCharacter() {
        localStorage.clear();
} 
```

使用它时，无论我是否删除了角色，它都会更改名称。此外，`document.getElementById("result").innerHTML="Character Name: " + localStorage.name;`不允许我一次更新多个字段。有什么更好的方法来做到这一点？

[编辑] -[这是生成器的链接](http://orca.st.usm.edu/~tbonnet2/pcgen/backup/j_pcgen.html)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:33:32.270

首先对您所做的事情有一些想法：

1.  我建议您使用 Modernizr 库，而不是`typeof(Storage) !== "undefined"`知道是否支持 localStorage。它将更加健壮。
2.  与其处理一堆变量，不如创建一个 Character 对象之类的东西，该对象将保存到 localStorage using`JSON.stringify()`并通过 using 检索`JSON.parse()`。它还将使您的代码更具可读性。
3.  不要使用像“类”这样的变量名，这样很容易出错。改用“类别”或“类型”之类的东西。

当我查看您的页面时，出现此错误：“未定义表单”。所以你的 makeCharacter() 函数不起作用。

关于您关于显示结果的问题，您可以在“结果”div 中生成更多信息。你不限于一个文本。
我认为更好的选择是设置“结果”元素，以便您可以轻松地显示数据。例如：

```
<table id="result">
  <tr>
    <td>Name :</td>
    <td id="name"></td>
  </tr>
  ... Other characteristics
</table> 
```

这样你就可以做一些简单的事情`document.getElementById('name') = character.name` ，当然，这个表会在字符生成之前被隐藏（使用'display' css 属性）

# ios - 使用 Storyboard (NSInvalidArgumentException) 在控制器之间传递信息

> ID：10290407
> 
> 赞同：0
> 
> 时间：2012-04-24T00:59:00.480
> 
> 标签：ios, storyboard

我想使用 Storyboard 在 ViewControllers 之间传递信息，但出现错误...我的代码如下

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([[segue identifier] isEqualToString:@"ToAssistance"])
    {
        NSLog(@"To assistance");
    }
    else if([[segue identifier] isEqualToString:@"ToMap"])
    {
        UINavigationController * navController = (UINavigationController *)[segue destinationViewController];
        EventMapViewController * eventMapViewController = (EventMapViewController *)[navController topViewController];
    }
} 
```

但在一线

```
EventMapViewController * eventMapViewController = (EventMapViewController *)[navController topViewController]; 
```

我得到以下异常

```
2012-04-23 19:49:00.369 StoryboardAssistance[9916:11603]
-[EventMapViewController topViewController]: unrecognized selector sent to instance 0x6e86380 2012-04-23 19:49:00.370 StoryboardAssistance[9916:11603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[EventMapViewController topViewController]: unrecognized selector sent to instance 0x6e86380'
*** First throw call stack: (0x135b022 0x2037cd6 0x135ccbd 0x12c1ed0 0x12c1cb2 0x546a 0x5424be 0x135ce99 0x11a14e 0x11a0e6 0x1c0ade 0x1c0fa7 0x1c0266 0x13f3c0 0x13f5e6 0x125dc4 0x119634 0x15fdef5 0x132f195 0x1293ff2 0x12928da 0x1291d84 0x1291c9b 0x15fc7d8 0x15fc88a 0x117626 0x218d 0x20f5) terminate called throwing an exception(lldb) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:12:47.423

According to your exception it seems that you are asking the "eventMapViewController" for its topviewontroller, which clearly doesnt exists since it is not a navigation controller. IF you check where you ask for it you can see here

```
[navController topViewController]; 
```

that navcontroller is in fact a controller of type "EventMapViewController", which would mean that this

```
UINavigationController * navController = (UINavigationController *)[segue destinationViewController]; 
```

is not giving you a uinavigationcontroller but in fact the "EventMapViewController" you want. so just remove those 2 lines and add

```
EventMapViewController * eventMapViewController = (EventMapViewController *)[segue destinationViewController]; 
```

if this doesnt work, then please comment this line

```
EventMapViewController * eventMapViewController = (EventMapViewController *)[navController topViewController]; 
```

and add a

```
NSLog(@"%@",navController); 
```

and tell me the output.

# c# - XMLRead.Create(new StringReader) 是否提供读取非 unicode (BIG5) 的功能？

> ID：10290408
> 
> 赞同：2
> 
> 时间：2012-04-24T00:59:18.827
> 
> 标签：c#, xml, windows-phone-7, unicode, big5

我正在尝试访问具有 BIG5 编码段落的网页。检索 xml 数据后，我使用 XMLRead.Create(new StringReader(xmldata)) 并从 XmlNodeType.Text 类型的 reader.Value 中获取 big5 个字符。在 WP 运行时，它不支持 BIG5 编码，所以我必须获取每个字节并转换为 unicode 以便在 WP7 上显示。但是，我从 reader.Value 获得的字节似乎不是我所期望的。例如，第一个汉字是 B5E1。但我得到了FDFD。那是怎么回事？

```
using (XmlReader reader = XmlReader.Create(new StringReader(xmldata)))  
while (reader.Read())  
    switch (reader.NodeType)  
        case XmlNodeType.Text:
            string s = reader.Value;  
            foreach (byte input in s)  
                # the input gives unexpected result 
```

要加载的网页是[http://feeds.feedburner.com/nownews/politic](http://feeds.feedburner.com/nownews/politic)

我正在使用 VS2010 进行 WP7 开发工作。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T10:23:22.467

编码定义如何将字节流转换为 .Net 字符串。由于您无法应用 BIG5 编码，.Net 将选择默认编码或 XML 文件中给定的编码。

结果是，当您解析 XmlReader 时，翻译 bytes=>string 已经发生，并且 foreach(byte in string) 迭代错误翻译字符串的 .Net 表示。

我没有使用 API 的这些部分，但似乎[这里提到的 XmlReader 方法](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.canreadbinarycontent.aspx)是用于检索 XML 节点后面的原始字节流的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T09:10:26.547

Windows Phone SDK 不支持 BIG5 编码，但如果您需要，请继续使用[Silverlight 编码生成器](http://www.hardcodet.net/2010/03/silverlight-text-encoding-class-generator)生成编码类。

# git - 如何使用“git config”命令配置带有名称的部分？

> ID：10290409
> 
> 赞同：6
> 
> 时间：2012-04-24T00:59:27.737
> 
> 标签：git, git-config

我如何使用“git config”命令来实现这样的配置：

```
[diff "odf"]
  textconv=odt2txt 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T01:41:25.137

像这样：

```
git config diff.odf.textconv odt2txt 
```

这将导致：

```
[diff "odf"]
        textconv = odt2txt 
```

# c# - 测试 WPF 应用程序

> ID：10290412
> 
> 赞同：0
> 
> 时间：2012-04-24T00:59:48.737
> 
> 标签：c#, wpf, visual-studio-2010, testing

我目前正在为我的第三年学位项目写文章。我使用 C# 创建了一个系统，该系统使用 Microsoft Access 作为后端数据库。该系统不连接到互联网，也不使用本地网络进行任何连接。

我要求最好的方法来测试这样的应用程序，以便它能够进行足够的测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:09:48.950

You should impelement the [Repository Pattern](http://martinfowler.com/eaaCatalog/repository.html), which will abstract the database code so that you can test the business logic, while faking out the database calls.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T07:04:39.103

我不知道您到底在寻找什么以及您的应用程序有多松散耦合，但在我的情况下，大部分代码（大约 90%）都是这样编写的，以便可以在单元测试中对其进行测试，而无需运行用户界面。MVVM 模式是一个很好的开端，因为它强制您将代码从 UI 移到单独的类中，例如 ViewModels、Commands，这些类可以进行单元测试。

这已经保证了很多，如果您需要进行自动化 UI 测试，请查看 Visual Studio 2010（仅限高级版和旗舰版）中提供的编码 UI 测试。它们允许您完全自动化/模拟用户交互。在模拟中，您可以执行 Justin 建议的操作：将您的应用程序与数据库分离并使用存储库。

您必须记住，为了编写真正可测试的代码，您必须设计可测试的代码。以我的经验，几乎不可能为从一开始就没有测试意图的代码编写单元测试。在这种情况下，您可以做的最好的事情就是编写集成测试。

但为了给出更明确的建议，我们需要更多的输入。干杯

# c++ - OpenGL 的纹理坐标

> ID：10290413
> 
> 赞同：1
> 
> 时间：2012-04-24T00:59:56.173
> 
> 标签：c++, opengl

我将 Tilesheet 作为纹理加载，我正在尝试从纹理中渲染单个图块

```
glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);
glBindTexture(GL_TEXTURE_2D, TileSheet);
float TY = (Tile / 16) * 0.0625;
float TX = (Tile % 16) * 0.0625;

glBegin(GL_QUADS);
    glTexCoord2f(TX, TY); glTexCoord2f(0, 0); glVertex3f(X, Y, 0);
    glTexCoord2f(TX + 0.0625, TY); glVertex3f(X + TILE_SIZE, Y, 0);
    glTexCoord2f(TX + 0.0625, TY + 0.0625); glVertex3f(X + TILE_SIZE, Y + TILE_SIZE, 0);
    glTexCoord2f(TX, TY + 0.0625); glVertex3f(X, Y + TILE_SIZE, 0);
glEnd(); 
```

`Tile`是一个`int`并且表示要在 tilesheet 上呈现的 tile `0.0625`是我的 Tilesheet 的宽度和高度 / 每行有多少个瓦片`(512 / 16)`

所以在 tilesheet 中它是 16 块宽，所以如果`Tile`是 16 块，它将是左边的块和从块表顶部开始的块。但这就是我得到的![在此处输入图像描述](../Images/1c3fb7a5aa4d337dbdb4b8272f5b83bf.png)

所以左上角是`[0][0]`右下角是`[1][0]`我不知道我做错了什么。任何帮助将不胜感激。

谢谢。

我还应该提到，如果`Tile == 0`它呈现正确的瓷砖，但只要`Tile > 0`瓷砖像上面那样结束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:05:35.410

在你打电话`glTexCoord2f`之前你打了两次电话`glVertex3f`。那看起来不对。

它看起来像这一行：

`glTexCoord2f(TX, TY); glTexCoord2f(0, 0); glVertex3f(X, Y, 0);`

应该：

`glTexCoord2f(TX, TY); glVertex3f(X, Y, 0);`

# asp.net-mvc-3 - ViewModel 未在 POST 上更新

> ID：10290417
> 
> 赞同：1
> 
> 时间：2012-04-24T01:00:47.437
> 
> 标签：asp.net-mvc-3, entity-framework, viewmodel

我有一个控制器和视图，允许用户“结帐”购物车的内容。

当我的 CheckoutController 将 Order 模型返回到 Checkout 视图时，一切正常。但是，我现在还想在 Checkout 视图上显示购物车的内容，因此修改了 Controller 和 View 以使用包含 Order 和 CartItems 的视图模型。

我创建了一个 CheckoutViewModel 并修改了 GET: 和 POST: ActionResults 以使用这个 viewmodel。

问题是在 POST 期间未正确填充 CheckOutViewModel：

我在“checkoutViewModel.Order.Username = User.Identity.Name;”这一行收到“对象引用未设置为对象实例”错误 在 POST: ActionResult 但我不确定到底是什么没有被实例化。

如果需要，我可以发布使用 Oreder 模型而不是 CheckoutViewModel 的原始工作代码。

我确定我有一些简单的结构或语法问题，我只是不知道它是什么，因为我仍在努力了解在 MVC 中做事的最佳方式。

**获取：操作结果**

```
 //GET: /Checkout/AddressAndPayment
    public ActionResult AddressAndPayment()
    {
        //To pre-populate the form, create a new Order object and get the ShoppingCart, populate the ViewModel and pass it to the view
        var order = new Order();
        order.Username = User.Identity.Name;
        MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
        storeDB.SaveChanges();

        var cart = ShoppingCart.GetCart(this.HttpContext);

        // Set up our ViewModel
        var viewModel = new CheckoutViewModel
        {
            CartItems = cart.GetCartItems(),
            CartTotal = cart.GetTotal(),
            Order = order
        };

        // Return the view
        return View(viewModel);
    } 
```

**POST：动作结果**

```
 //POST: /Checkout/AddressAndPayment
    [HttpPost]
    public ActionResult AddressAndPayment(FormCollection values)
    {
        var checkoutViewModel = new CheckoutViewModel();
        TryValidateModel(checkoutViewModel);

        try
        {
            checkoutViewModel.Order.Username = User.Identity.Name;
            checkoutViewModel.Order.OrderDate = DateTime.Now;
            //Save Order
            storeDB.Orders.Add(checkoutViewModel.Order);
            storeDB.SaveChanges();
            //Process the order
            var cart = ShoppingCart.GetCart(this.HttpContext);
            cart.CreateOrder(checkoutViewModel.Order);
            storeDB.SaveChanges();
            //Send 'Order Confirmation' email
            ViewData["order"] = checkoutViewModel.Order;
            UserMailer.OrderConfirmation(checkoutViewModel.Order).SendAsync();

            return RedirectToAction("Complete", new { id = checkoutViewModel.Order.OrderID });
        }
        catch
        {
            //Invalid - redisplay with errors
            return View(checkoutViewModel);
        }
   } 
```

**看法**

```
@model OrderUp.ViewModels.CheckoutViewModel
@{
    ViewBag.Title = "AddressAndPayment";
}
<script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) { 
@Html.ValidationSummary(true)
<h2>Pick Up Details</h2>
<fieldset>
    <legend>When are you gonna be hungry?</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Order.Phone)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Order.Phone)
        @Html.ValidationMessageFor(model => model.Order.Phone)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Order.PickUpDateTime)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Order.PickUpDateTime)
        @Html.ValidationMessageFor(model => model.Order.PickUpDateTime)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Order.Notes)
    </div>
    <div class="editor-multiline-field">
        @Html.EditorFor(model => model.Order.Notes)
        @Html.ValidationMessageFor(model => model.Order.Notes)
    </div>
</fieldset>
<input type="submit" value="Submit Order" />
}
<div style="height:30px;"></div>
<h3>
    <em>Review</em> your cart:
 </h3>
<table>
<tr>
    <th>
        Menu Item
    </th>

    <th>
        Price (each)
    </th>
    <th>
        Notes
    </th>
    <th>
        Quantity
    </th>
    <th></th>
</tr>
@foreach (var item in Model.CartItems)
{
    <tr id="row-@item.RecordID">
        <td>
            @Html.ActionLink(item.MenuItem.Name, "Details", "Store", new { id = item.MenuItemID }, null)
        </td>

        <td>
            @Html.DisplayFor(modelItem => item.MenuItem.Price)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Notes )
        </td>
        <td id="item-count-@item.RecordID">
            @item.Count
        </td>
        <td>
        </td>
    </tr>
}
<tr>
    <td >
        Total
    </td>
    <td  id="cart-total">
        @String.Format("${0:F2}", Model.CartTotal)
    </td>
    <td>
    </td>
    <td>
    </td>
    <td>
    </td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:04:25.550

您应该使用 CheckoutViewModel 作为 HttpPost 方法的输入参数，然后尝试调试并查看在表单发布后是否仍然没有填充该模型。

```
[HttpPost]
    public ActionResult AddressAndPayment(CheckOutViewModel checkoutViewModel)
    {
        TryValidateModel(checkoutViewModel);

        try
        {
            checkoutViewModel.Order.Username = User.Identity.Name;
            checkoutViewModel.Order.OrderDate = DateTime.Now;
            //Save Order
            storeDB.Orders.Add(checkoutViewModel.Order);
            storeDB.SaveChanges();
            //Process the order
            var cart = ShoppingCart.GetCart(this.HttpContext);
            cart.CreateOrder(checkoutViewModel.Order);
            storeDB.SaveChanges();
            //Send 'Order Confirmation' email
            ViewData["order"] = checkoutViewModel.Order;
            UserMailer.OrderConfirmation(checkoutViewModel.Order).SendAsync();

            return RedirectToAction("Complete", new { id = checkoutViewModel.Order.OrderID });
        }
        catch
        {
            //Invalid - redisplay with errors
            return View(checkoutViewModel);
        }
   } 
```

# javascript - Jquery & OpenLayers - 动态 Javascript 变量？

> ID：10290427
> 
> 赞同：0
> 
> 时间：2012-04-24T01:02:26.923
> 
> 标签：javascript, jquery, variables, openlayers

我试图让 JQuery 和 OpenLayers 一起玩得很好。作为一个 javascript 新手，我无法使用与给定图层关联的 jQuery 生成不透明度滑块和可见性复选框。

在此之前，我不知道有多少层可用。此信息通过 python 脚本加载，该脚本向 Geoserver 执行 WMS 请求。

我来自python，发现我真正想要的是一个字典来存储层对象和一个键。这是我尝试使用哈希来做到这一点。我正在寻找任何建议，从“不要使用哈希，看” ***_* ___** ”到“你错过了 '()'。

下面的代码将图层添加到地图、将其名称添加到内容列表、不透明度栏和设置可见性的复选框。它非常适合单层。每个后续图层都会覆盖先前图层的不透明度滑块和复选框。

```
//If the thumbnail is clicked load the layer.
$('table').on('click','.thumbnail',function(event){
var layer = {};

//This info is placed into the img tag via jQuery   
var name = ($(this).attr("layername_id"));
var title = ($(this).attr("titlename_id"));

//OpenLayers creates the layer here
layer[i] = new OpenLayers.Layer.WMS(title, "geoserver/wms?",{LAYERS: name,FORMAT: 'image/png',TRANSPARENT: 'true',PROJECTION:'EPSG:30100',BBOX: '-180,-60,180,60'},{OPACTIY: 0.1, isBaseLayer: false, tiled:true} );

//Do not add the same layer multiple times
if (map.getLayersByName(name) == false) {
        map.addLayers([layer[i]]);  
}

//Defined just to make life easier in this part of the code.
var name = layer[i].name;

//Check box for visibility in a table of contents DIV tag.
$('.toc').append('<div><input class="toc_inline" id="check'+i+'" type="checkbox" checked="checked"></div>');
    $("[id^=check]").click(function(){
    var $input = $(this);
    if($input.prop('checked') == true){
        layer[i].setVisibility(true);
    }
    else {
        layer[i].setVisibility(false);
    }
    });

//Layer name in the TOC and slider to handle transparency.
    $('.toc').append('<div class="toc_inline" unique_id="'+name+'">'+name+'</div>');

//Slider for transparency
$('.toc').append('<div id="slider-'+i+'"><div class="ui-slider-handle"></div></div>');

    $("[id^=slider]").slider({
    value: 100,
    slide: function(e, ui) {
        layer[i].setOpacity(ui.value / 100);
        }
    });
//My attempt to step to the next integer
i++;

}); 
```

# c# - 如何将皮肤应用于 devExpress 中的用户控件

> ID：10290428
> 
> 赞同：1
> 
> 时间：2012-04-24T01:02:27.830
> 
> 标签：c#, winforms, devexpress

我已将 DevExpress.XtraEditors.XtraForm 替换为我的普通窗口窗体和注册的用户皮肤。到目前为止，一切都很好。（我可以看到皮肤并将它们应用于所有表单。）但是我的应用程序也使用用户控件，所以我也将它替换为 DevExpress.XtraEditors.XtraUserControl。但是我看不到应用于我的用户控件的皮肤。我错过了一些参考..？

附加信息：

1.  我的参考文件夹中有正确的 dll。
2.  我在 usercontrol 类中提到过（使用 DevExpress.XtraEditors；）
3.  我已将 System.Windows.Forms.UserControl 更改为 DevExpress.XtraEditors.XtraUserControl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T04:59:31.973

关注 DevExpress 论坛链接：[Apply LookAndFeel style to custom UserControl](http://www.devexpress.com/Support/Center/p/Q261630.aspx)

参考：
[如何获取与当前使用的皮肤对应的颜色如何在使用皮肤](http://www.devexpress.com/Support/Center/p/AK9476.aspx)
[时获取特定控件元素的颜色](http://www.devexpress.com/Support/Center/p/A2967.aspx)

# mysql - symfony2 查询构建器以一种复杂的方式

> ID：10290431
> 
> 赞同：0
> 
> 时间：2012-04-24T01:02:59.430
> 
> 标签：mysql, symfony, doctrine, query-builder

我需要知道执行此操作的最佳方法...我的数据库中有一个表，对于这篇文章，我们将其称为 TC，它只有几个我感兴趣的字段：

`id, daydate, noteBy_id, and totaltime`

noteBy_id 被分配给用户表，该表再次只有我正在寻找的几个项目......

`id, first_name, last_name, user_name, department, parentcompany`

部门参考了第三个表，该表仅在字段中具有`id`和`departmentName`...

到目前为止，我使用查询生成器创建了这个：

```
$query = $qb->select('t', 'u')
->leftJoin('t.noteBy', 'u', 'WITH', 'u.id = 't.noteBy')
->where('t.daydate BETWEEN :start AND :end')
->andWhere('u.parentcompany = :pid')
->andWhere('u.department = :dep)
->groupBy('u.id')
->setParameter('start', $start)
->setParameter('end', $end)
->setParameter('dep', $department)
->getQuery(); 
```

现在，这个查询按原样工作，但它返回：

```
Array
(
    [0] => Array
        (
            [id] => 6
            [in1] => DateTime Object
                (
                    [date] => 2012-04-17 09:10:00
                    [timezone_type] => 3
                    [timezone] => America/Denver
                )

            [out1] => 
            [in2] => 
            [out2] => 
            [in3] => 
            [out3] => 
            [totaltime] => 0.00
            [daydate] => DateTime Object
                (
                    [date] => 2012-04-17 09:10:00
                    [timezone_type] => 3
                    [timezone] => America/Denver
                )

            [noteBy] => Array
                (
                    [username] => j
                    [usernameCanonical] => j
                    [email] => me@me.me
                    [emailCanonical] => me@me.me
                    [enabled] => 1
                    [salt] => 
                    [password] =>     
                    [credentialsExpired] => 
                    [credentialsExpireAt] => 
                    [id] => 124
                    [full_name] => 
                    [first_name] => J
                    [last_name] => B
                    [socialsecurity] => 
                    [phone] => 
                    [phone2] => 
                    [address1] => 
                    [address2] => 
                    [city] => 
                    [state] => 
                    [zip] => 
                    [startdate] => 
                    [notes] => 
                )

        )

) 
```

这是错误的，因为它只有 1 个项目，在运行的查询中它应该在数据库中有 2 个。

它应该是这样的：

```
[0]
  (
  [id] => '1'
  [first_name] => 'j'
  [last_name] => 'b'
  [username] => 'jb'
  [department] => 'some department'
  [total_time] => SUM of all records in TC.total_time for user id 1
)
[1]
  (
  [id] => '2'
  [first_name] => 'frank'
  [last_name] => 'blew'
  [username] => 'fb'
  [department] => 'some department'
  [total_time] => SUM of all records in TC.total_time for user id 2
) 
```

但是，如果用户 id 在 TC 表中至少有 1 个匹配项，则结果数组中应该只有条目......任何关于弄清楚这个查询的帮助表示赞赏..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:49:43.037

我最终放弃了 QueryBuilder 并使用常规查询...

该函数现在看起来像这样：

```
public function indexAction($start = null, $end = null) {
        $request = $this->get('request');
        /**
         * The following 4 lines, are to default the date to Sunday through Saturday of PREVIOUS WEEK
         */
        $department = null;
        $em = $this->getDoctrine()->getEntityManager();
        $user = $this->get('security.context')->getToken()->getUser();

        $dateRangeForm = $this->createForm(new TimeClockReportType());
        if ($request->getMethod() == "POST") {
            $dateRangeForm->bindRequest($request);
            $formData1 = $dateRangeForm->getData();

        }
        if ($request->getMethod() == "POST" && $formData1['salesCompany']->getDepartmentName() != NULL ) {
            $formData = $dateRangeForm->getData();
            $start = $formData['dateRange']['startDate'];
            $end = $formData['dateRange']['endDate'];
            $department = $formData['salesCompany']->getDepartmentName();
            $query = "SELECT SUM(t.totaltime) AS total_time, u.id, u.first_name, u.last_name, u.username, d.departmentName
                     FROM EcsCrmBundle:TimeClock t
                     LEFT JOIN t.noteBy AS u
                     LEFT JOIN u.employeeDepartment AS d
                     WHERE t.noteBy = u.id
                     AND u.employeeDepartment = :dep
                     AND t.daydate BETWEEN :start AND :end
                     AND u.parentcompany = :pid
                     HAVING total_time > 0";
            $query = $em->createQuery($query)
                ->setParameter('start', $start)
                ->setParameter('end', $end)
                ->setParameter('pid', $user->getParentcompany())
                ->setParameter('dep', $department);
        } else {
            if ($request->getMethod() == "POST") {
                $formData = $dateRangeForm->getData();
                $start = $formData['dateRange']['startDate'];
                $end = $formData['dateRange']['endDate'];
            } else {
                $today = strtotime('-7 day', time());
                $end = date("Y-m-d 23:59:59", strtotime('next saturday', $today));
                $start = date("Y-m-d 00:00:00", strtotime('last sunday', $today));
            }

            $query = "SELECT SUM(t.totaltime) AS total_time, u.id, u.first_name, u.last_name, u.username, d.departmentName
                     FROM EcsCrmBundle:TimeClock t
                     LEFT JOIN t.noteBy AS u
                     LEFT JOIN u.employeeDepartment AS d
                     WHERE t.noteBy = u.id
                     AND t.daydate BETWEEN :start AND :end
                     AND u.parentcompany = :pid
                     GROUP BY u.id
                     HAVING total_time > 0";
            $query = $em->createQuery($query)
                        ->setParameter('start', $start)
                        ->setParameter('end', $end)
                        ->setParameter('pid', $user->getParentcompany());

        }
        $entity = $query->getResult();
        return $this->render('EcsCrmBundle:Reports:TimeClockReport.html.twig', array(
            'entity' => $entity,
           'start' => $start,
            'end' => $end,
            'dep'  => $department,
            'form' => $dateRangeForm->createView(),
        ));
    } 
```

这不是世界上最漂亮的功能，但它现在可以工作，我稍后会对其进行修饰以清理它......

# asp.net-mvc-3 - 实体框架将浮点数据类型映射为双精度

> ID：10290432
> 
> 赞同：18
> 
> 时间：2012-04-24T01:03:06.153
> 
> 标签：asp.net-mvc-3, entity-framework

我正在使用数据库优先方法开发一个 asp.net mvc 3 Web 应用程序。

我有一个名为的表`Results`，其中包含两个`min & max`类型的列 () `float`，但是当我使用实体框架将现有数据库映射到模型类时，EF 创建一个具有字段`Results`数据类型的类，而不是现有数据库。`min & max``double``float`

那么为什么会发生这种行为呢？它会引起任何问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-24T12:58:46.203

根据[MSDN](http://msdn.microsoft.com/en-us/library/bb896344%28v=vs.100%29.aspx) ，这是正常行为。

甚至 SQL-server 的`real`数据类型也映射到`double`，尽管`float`那里肯定就足够了。

但是这里的类型名称非常混乱。实际上[`float`(t-SQL)](http://msdn.microsoft.com/en-us/library/ms173773.aspx)与[`double`(.Net)](http://msdn.microsoft.com/en-us/library/system.double.aspx)相同：精度为 15 位，范围为负 1.79769313486232e308 到正 1.79769313486232e308。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:46:58.357

我不确定您的问题是否与此相同：

[http://forums.asp.net/p/1606916/4100117.aspx](http://forums.asp.net/p/1606916/4100117.aspx)

但这似乎不会引起任何问题。您的数字从双精度数变为浮点数可能会丢失精度，但除非您需要额外的数字，否则它仍然可以工作。

# c - 何时在 C 的嵌套结构中使用指向另一个结构的指针

> ID：10290434
> 
> 赞同：1
> 
> 时间：2012-04-24T01:03:14.190
> 
> 标签：c, pointers, struct

我很困惑何时应该使用指向另一个结构的指针或包含副本。例如，我应该使用Inventory`Products *prods;`还是`Products prods;`在 Inventory 中？我该怎么做`malloc`？

```
typedef struct Products Products;
struct Products
{
    int  id;
    char *cat;
    char *name
};

typedef struct Inventory Inventory;
struct Inventory
{
    char* currency;
    int size;
    Products prods; // or Products *prods;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:42:41.883

补充凯尔的回答，关于是否使用指针的决定`Products`，您必须考虑以下几点：

如果你不知道你会有多少元素，你的`Inventory`结构至少应该有：

```
typedef struct Inventory Inventory;
struct Inventory
{
    char *currency;
    int size, count;
    Products* prods;
    ... // other elements you should need
}; 
```

并且指针应定义为（实例化`Inventory`元素时）：

```
...
Inventory inv;
inv.size = _total_elems_you_will_need_
inv.prods = (Products *)malloc(inv.size * sizeof(Products));
... 
```

另一方面，如果这个数量总是固定的，那么你可以`Inventory`用这样的东西定义你的结构（而不​​是上面定义的指针）：

```
Products prods;      // if you'll need only one element.
Products prods[10];  // if you'll need only ten. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:28:08.317

当编译时数组的大小未知时，您应该使用指针。如果您知道每个 Inventory 结构将只包含一个 Products 结构或 10 或 100，那么只需声明`Products prods[100]`. 但是，如果您在运行时读取任意记录并且在编译时无法知道 Inventory 结构将包含多少 Products 记录，则使用`Products *prods`. 您还需要`size`和`count`struct 元素来跟踪您已经 malloc'd 或 realloc'd 以及您用 Products 结构填充了多少内存。

# c++ - 矩阵类的重载运算符*

> ID：10290436
> 
> 赞同：2
> 
> 时间：2012-04-24T01:03:33.283
> 
> 标签：c++, matrix, operator-overloading

我有一个矩阵：

```
#ifndef MATRIX_H
#define MATRIX_H

class Matrix
{   
    public:
        Matrix(int rows, int columns);
        Matrix(int, int, int** matrix); 
        Matrix(Matrix* copy);
        ~Matrix();

        void Set(int, int, int);
        void SetMatrix(int, int, int** matrix);             
        void Print();
        void ZeroMatrix(int,int,int** matrix);      
        void Add(Matrix* B);
        void Subtract(Matrix* B);
        void Copy(Matrix* B);

        int** Multiply(Matrix* B);
        int** Create(int,int);
        int** Get();
        int** Transpose();
        int** Scalar(int);

        int Get(int,int);
        int Rows();
        int Columns();

        Matrix operator*(int);

    private:
        int** _matrix;
        int _rows;
        int _columns;
};

#endif 
```

这是实现：

```
Matrix Matrix::operator*(int scale)
{
    return Matrix(_rows, _columns, Scalar(scale));
} 
```

对于学校作业，我们必须重载多重运算符以使用整数标量。问题是我不断收到此错误：

main.cpp：在函数'int main（int，char * *）'中：main.cpp：18:15：错误：'4 * B'中的'operator'不匹配*</p>

破解代码：

```
#include "Matrix.h"
#include <fstream>
#include <iostream>

int main(int argc, char *argv[])
{   
    Matrix* A = new Matrix(4,2);

    A->Set(0,0,1);  
    A->Set(0,1,2);
    A->Set(1,0,3);
    A->Set(1,1,4);  
    A->Print();

    Matrix B(A);
    B.Print();

    Matrix C(4 * B); //this line
    C.Print();

    delete A;

    return 0;
} 
```

有任何想法吗？

编辑＃1：

编码：

```
Matrix operator*(int); 
        Matrix operator* (int, const Matrix &); 
```

生成：

```
In file included from main.cpp:1:0:
Matrix.h:31:40: error: ‘Matrix Matrix::operator*(int, const Matrix&)’ must take either zero or one argument
In file included from matrix.cpp:1:0:
Matrix.h:31:40: error: ‘Matrix Matrix::operator*(int, const Matrix&)’ must take either zero or one argument
matrix.cpp:207:50: error: ‘Matrix Matrix::operator*(int, const Matrix&)’ must take either zero or one argument 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:04:35.787

当你指定你的成员函数时，你的类必须在左边。

`B * 4`相当于`B.operator* (4)`。当您说 时`4 * B`，这是行不通的。

要解决这个问题，只需使用`B * 4`而不是`4 * B`，或提供外部重载

```
Matrix operator* (int, const Matrix &); 
```

然后，`4 * B`将匹配这个重载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T05:06:07.813

这将在任何一个方向上工作......

```
#include <iostream>

class Matrix
{
public:
  Matrix(int x) // This works as a convert constructor
    : _x(x) { } // if you don't use the explicit keyword

  friend Matrix operator*(const Matrix& left, const Matrix& right);

  int _x;
};

Matrix operator*(const Matrix& left, const Matrix& right)
{
  return Matrix(left._x * right._x);
}

int main()
{
  Matrix m(3);
  int a = 4;

  Matrix m1(m * a);
  Matrix m2(a * m);

  std::cout << m._x  << endl  // 3
            << a     << endl  // 4
            << m1._x << endl  // 12
            << m2._x << endl; // 12
} 
```

# shoutcast - 喊话 v2 和 whmsonic

> ID：10290439
> 
> 赞同：0
> 
> 时间：2012-04-24T01:04:00.083
> 
> 标签：shoutcast

所以这是我面临的问题，当前的 WHMSonic 仅支持第 1 版的喊声，因为你们中的许多人都知道喊声已经转移到一个更好的系统并且现在是 2.0 版我想使用 WHMSonic 并将电台发送到 Shoutcast V2 但是看起来这是不允许的。

那么是否可以解决这个问题，或者是否有另一个 WHMSonic 将提供对喊声版本 2 的支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-27T18:19:47.703

正如您在此处看到的，它确实支持 Shoutcast 2：

[![WHMSonic](../Images/31a3dab4b2379e5ff513d9ad1c0ff6f4.png)](https://i.stack.imgur.com/bxe5d.png)

试试这个：List Manage my radio--->Change Radio system to throwcast 2 然后点击这里： [![进入服务器登录](../Images/ba020bc7e09a26d96dec9395667e46cb.png)](https://i.stack.imgur.com/ae4kN.png)

在为 Shoutcast v2 服务器创建“Authhash”之后，使用本教程公开广播：[Authhash 教程](https://www.internet-radio.com/community/threads/creating-the-%E2%80%9Cauthhash%E2%80%9D-for-shoutcast-v2-servers.21409/)

注意：我现在才注意到问题的日期，但我认为答案仍然有用，因为我需要很多时间才能找到这些信息。

# sql - XNA Windows 游戏简单数据库访问 - .mdb 不起作用 [非常基本]

> ID：10290451
> 
> 赞同：1
> 
> 时间：2012-04-24T01:06:44.740
> 
> 标签：sql, database, windows, ms-access, xna

我正在为一个班级开发一个游戏项目，我们可以在 XNA 和 Java 之间进行选择。选择使用 XNA 的团队是少数，而且很多讲座都以 Java 内容为中心——然而，讲座中的主要理论主题之一是我们使用数据库来访问数据，但这在理论上仅适用于各种软件工程实现选项，实际上并不是 XNA 的实际实现。

所以我们已经制作了我们的游戏，现在想要包含一个数据库 - 但是我发现 XNA 对 .mdb 或 .msaccess 文件不满意？特别是当我不断得到这样的事情时：

“无法自动检测要用于“Test.mdb”的导入器。没有处理此文件类型的导入器。请在项目中指定处理此文件类型的导入器。”

这让我完全陷入困境 - 很多在线解决方案都建议使用 SQL Server 数据库，但我什至不知道如何从非常基础的层面创建其中一个 - 我们中有 5 个人正在研究这个游戏并让每个人在我们剩下的时间内顺利安装 SQL Server 并不是最现实的选择。

还有其他基于 XNA 非服务器的数据库选项吗？如果不是，那么在我们的游戏中实现一个 SQL Server 数据库的最佳方法是什么，五个不同的人可以完美运行，他们可能都预装了不同的现有 SQL Server 版本？那还重要吗？我这样说是因为它在 ASP.NET 类中造成了相当大的影响。

在此先感谢，对于Access以外的数据库真的一无所知，认为这将是“使用System.Data.OleDb;”，导入文件并设置连接字符串的问题。

编辑：通过数据 > 添加新数据源，并按照说明，我已经能够尝试添加 MSACCESS 和 SQL Compact 数据库！呼呼，又近了一步。但是，我总是收到“无法获取 .dataset 的类型信息”错误：/ 好消息是至少生成了一个 NameDataSet.xsd 文件 - 这如何与查询字符串一起使用？我需要手动输入连接字符串吗？在没有先验知识的情况下开始并不多:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:19:57.427

以这种方式使用访问确实是一个坏主意，它已经过时并且在现代设计、unicode 和在 64 位操作系统上工作时存在许多问题。

SQL server 也不是一个好主意，它只是一个错误的工具，你必须考虑为每个使用你的代码的人获取许可证。

在这一点上，我建议您考虑查看进程内数据库，例如 SqlLite 或 Firebird；但我认为目前更相关的事情是询问您希望数据库实际做什么？

如果你纯粹是用它来存储游戏的配置数据，那么它就太过分了。

最后，这本身不是 XNA 问题——如果数据库可以在 .Net 中使用，那么它将起作用。

# php - 联系表格不起作用

> ID：10290453
> 
> 赞同：0
> 
> 时间：2012-04-24T01:06:52.390
> 
> 标签：php, html, contact-form

我对网络编程很陌生，正在尝试建立一个个人网站并运行。我有一个联系表格，似乎没有执行任何操作。我已经在网上寻找代码中的错误，但我碰壁了。

标题中的脚本

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://html5form.googlecode.com/svn/trunk/jquery.html5form-1.5-min.js"></script> 
```

html5表单

```
<form action="message.php" method="post" id="message_form">
    <fieldset>
        <input type="email" name="email" id="email" title="Email address" maxlength="40" placeholder="Email Address" autocomplete="off" required />
        <br />
        <input type="text" name="subject" id="subject" title="Subject" maxlength="60" placeholder="Subject" autocomplete="off" required />
        <br />
        <textarea name="message" id="message" title="Message" cols="30" rows="5" maxlength="1000" placeholder="Message" required></textarea>
        <br />
        <input type="submit" value="Send" id="submit" name="submit"/>
    </fieldset>
</form> 
```

正文中的脚本（链接）

```
$('#message_form').html5form({
    allBrowsers : true,
    responseDiv : '#response',
    messages: 'en',
    messages: 'es',
    method : 'GET',
    colorOn :'#0d85a5',
    colorOff :'#d2d2d2'
}); 
```

消息.php

```
<?php
if ('POST' === $_SERVER['REQUEST_METHOD']) {
$to = "rbblakeley@gmail.com";
$from = "r.blakeley@yahoo.com";
$subject = "test subject";
$message = "test message";

$body = "$from\n $message";

echo "Your message has been sent!";
mail($to, $subject, $body);
} else {
echo "Rapscallions! Please try again.";
}
?> 
```

在本地 MAMP 服务器上进行测试并上传到我的远程主机（bluehost），当我点击“发送”时没有任何反应，除了表单重置为占位符值。帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:14:43.910

您忘记为提交按钮命名

```
<input type="submit" name="Submit" value="Send" id="submit"/> 
```

一个更好的方法可能是而不是

```
if(isset($_POST["submit"])){ 
```

采用：

```
if ('POST' === $_SERVER['REQUEST_METHOD']) { 
```

此方法不检查特定变量。它检查请求方法，如果它是 POST 则表单已提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:15:02.963

`$_POST`包含键的关联数组（来自`name`输入）及其各自的值。

由于没有输入 has `name='submit'`，您的`if`陈述将永远是错误的。

无论如何，您可能想要使用这样的东西（最好检查一下事情是否正确）：

```
if(empty($_POST['subject']) || empty($_POST['email'] || empty($_POST['message'])){
    echo "Rapscallions! Please try again.";
} else {
    // do your thing
} 
```

# sql-server - t-sql时间逻辑

> ID：10290455
> 
> 赞同：1
> 
> 时间：2012-04-24T01:07:11.450
> 
> 标签：sql-server, tsql

我有 3 列数据，例如

```
storeID  starttime  endtime
   A       1:00AM    4:00PM
   B       7:30PM    6:00AM
   C       2:00AM    4:00AM 
```

我必须检查两个时间间隔之间的给定时间。

您能为该逻辑建议一个 T-SQL 语句吗？

如果假设我想获得凌晨 1:00 开门的商店，我必须得到`A, B`结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:14:59.440

```
declare @testTime time
select @testTime = '01:00'
select storeId from openinghours 
    where (startTime<=endTime and @testTime >=startTime and @testTime <=endTime) 
        OR (startTime>endTime and (@testTime <startTime OR @testTime > endTime)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T08:38:41.327

```
declare @testTime time 
select @testTime = '01:00' 
select storeId from openinghours where @testime between starttime and endtime 
```

# r - geom_raster 没有颜色渐变

> ID：10290456
> 
> 赞同：3
> 
> 时间：2012-04-24T01:07:12.587
> 
> 标签：r, ggplot2

我正在尝试使用 geom_raster 绘制光栅图像（海洋测深），但我很难破解代码。我将不胜感激任何帮助。

我已经下载了以下[xyz 文件](https://www.dropbox.com/s/umv70ze4hoym915/SF_bath.txt)（Dropbox 链接）。

```
SF.bath <- read.table("SF_bath.txt", header=F,col.names=c("lon","lat","z"))
> head(SF.bath)
       lon     lat   z
1 -67.9917 50.9968 757
2 -67.9750 50.9968 693
3 -67.9583 50.9968 673
4 -67.9417 50.9968 769
5 -67.9250 50.9968 761
6 -67.9084 50.9968 733 
```

当我尝试以下代码时，我的地图上没有显示颜色？

```
v <- ggplot(SF.bath, aes(lon, lat,z=z))
print(v + geom_raster(aes(fill=z)) + stat_contour(size=0.2) + scale_fill_gradient("z")) 
```

![地图](../Images/60f81208e0e3ccd649c6510c8922d5a1.png)

我收到以下消息：`Using alpha as value column: use value_var to override.`关于可能是什么问题的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T01:59:42.397

**编辑以强调关键答案**

问题中的代码与提供的数据集实现了预期的结果：

![SF_bath 图](../Images/1e451015b4df3ae1bc1c5d24df2ddbe3.png)

在评论中的讨论之后，关键的教训原来是一个建议，即当系统行为异常时，`update.packages()`作为故障排除的一部分可能是明智的。

# ruby - Mongodb 查询不使用索引

> ID：10290458
> 
> 赞同：1
> 
> 时间：2012-04-24T01:07:41.257
> 
> 标签：ruby, mongodb, mongoid

我正在使用带有 ruby​​ (1.9.3) 应用程序的 MongoDB 2.0.3（通过 Mongoid）。

我有一个看起来像这样的复合索引：

```
index [
  [:attr1, Mongo::ASCENDING],
  [:attr2, Mongo::ASCENDING],
  [:attr3, Mongo::ASCENDING],
  [:attr4, Mongo::ASCENDING]
] 
```

一个看起来像这样的查询：

```
Model.where(:attr3.ne => true, :attr4.ne => true).
      extras(:hint => { :attr1 => Mongo::ASCENDING,
                        :attr2 => Mongo::ASCENDING,
                        :attr3 => Mongo::ASCENDING,
                        :attr4 => Mongo::ASCENDING }) 
```

然后我的代码修改结果并更新它们。我有几个运行上述 ruby​​ 应用程序的进程，所有进程都在保存 mongodb 服务器。我有一个相当大的数据库（超过 3000 万条记录，大小为 95gb），并且我的应用程序不断地对其进行读取/写入。

我看到一个问题，有时查询会使用索引，有时不会（通过 mongo shell 的 db.currentOp() ）。为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T14:40:53.487

创建多键索引时，顺序很重要——如果您的查询中没有包含索引的第一个键（attr1 和 attr2），那么 MongoDB 将无法使用该索引。想象一下，如果你有一本物理字典，并且你想查找第三个字母是“a”而第四个字母是“b”的单词——字典的字母顺序并没有多大帮助。

要根据 attr3 和 attr4 查找文档，您需要一个多键索引，其中 attr3 和 attr4 是索引中的第一个键。

# jquery - jquery cakephp：post方法在本地警告正确的结果字符串，但在远程服务器上不起作用

> ID：10290460
> 
> 赞同：0
> 
> 时间：2012-04-24T01:08:04.133
> 
> 标签：jquery, cakephp, remote-server

以下 jquery 和 cakephp 代码在我的本地主机上运行完美，提示正确的 result_str，但它在远程服务器上不起作用。我在最后包含了本地主机和远程服务器的输出。

post 方法有效，但无法远程显示正确的输出。

我已经验证了我输入的电子邮件 ID 存在于远程数据库中。

merry_parent 模型中的 debug($merryparent_info) 在本地和远程都没有显示。

请看一下[我网站的链接](http://www.merryflowers.com/students/add)

当用户输入父信息email id并按下tab按钮时，会弹出2个警告框。第一个显示在 post 方法中传递的 email_id，第二个警报显示 result_str。

有人可以告诉我哪里出错了。在过去的 4 天里，我一直在努力解决这个问题。谢谢你。

```
<script type="text/javascript">
      $(document).ready(function(){
          $("#MerryParentEmail").change(function(){
            //txt=$("#MerryParentEmail").val();
            email_id=$("#MerryParentEmail").serialize();
            $.post("/students/get_parent_info",email_id,function(result_str){
                                 alert("result_str: "+result_str);
            });
          });
  </script> 
```

student_controller.php

```
function get_parent_info(){
//$this->layout=false;
 if (!empty($this->data)){

    $merryparent_info=$this->Student->MerryParent->getMerryParents($this->data['MerryParent']['email']);
    print_r($merryparent_info);
    echo $merryparent_info['MerryParent']['initial'].'*****';
    echo $merryparent_info['MerryParent']['name'].'*****';
    echo $merryparent_info['MerryParent']['landline'].'*****';
    echo $merryparent_info['MerryParent']['mobile'].'*****';
    echo $merryparent_info['MerryParent']['address'].'*****';
    echo $merryparent_info['MerryParent']['state_id'].'*****';
    echo $merryparent_info['MerryParent']['city_id'].'*****';
    echo $merryparent_info['MerryParent']['postal_code'].'*****';
    }
} 
```

merry_parent.php 模型

```
function getMerryParents($field_value){
    if (is_int($field_value))
        $conditions=array('merryParent.id'=>$field_value);
    else
        $conditions=array('merryParent.email'=>$field_value);

    //debug($conditions);

    $merryparent_info=$this->find('first',array(
                                'conditions'=>$conditions,
                                'recursive'=>-1   //fetches merry_parents table data only not the associated data
                                ));
          debug($merryparent_info);
    return $merryparent_info;
} 
```

本地主机输出：

第一次警报

```
 email_id: data%5BMerryParent%5D%5Bemail%5D=banana8%40gmail.com 
```

第二次警报

```
 result_str: Array
  (
    [MerryParent] => Array
        (
            [id] => 38
            [initial] => Ms
            [name] => banana kaur
            [username] => banana8
            [email] => banana8@gmail.com
            [password] => 7b311dc3e6d4862caf024b65410c793adfc530bc
            [landline] => 
            [mobile] => 8487234783
            [address] => 99 fruits road
            [state_id] => 14
            [city_id] => 81
            [postal_code] => 877979
            [created] => 2012-02-08 05:24:49
            [modified] => 2012-02-15 15:46:05
        )
  )
  Ms*****banana kaur**********8487234783*****99 fruits road*****14*****81*****877979***** 
```

远程服务器输出：

第一次警报

```
 email_id: data%5BMerryParent%5D%5Bemail%5D=banana8%40gmail.com 
```

第二次警报

```
result_str: **************************************** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:29:41.620

好的，问题出在代码 MerryParent 模型上。我的 jquery 代码没有任何问题。

在 MerryParent 模型中，

```
function getMerryParents($field_value){         
if (is_int($field_value))         
    $conditions=array('merryParent.id'=>$field_value);         
else         
    $conditions=array('merryParent.email'=>$field_value);         

//debug($conditions);         

$merryparent_info=$this->find('first',array(         
                            'conditions'=>$conditions,         
                            'recursive'=>-1   //fetches merry_parents table data only not the associated data         
                            ));         
      debug($merryparent_info);         
return $merryparent_info;         
} 
```

我将 merryParent.id 更改为 MerryParent.id 并将 merryParent.email 更改为 MerryParent.email ，它现在可以在远程服务器上运行。

# django - 注册表单未在 Django 中提交

> ID：10290461
> 
> 赞同：1
> 
> 时间：2012-04-24T01:08:05.247
> 
> 标签：django, django-models, django-forms, django-users

我正在使用具有覆盖保存方法的表单在 django 中进行注册。我没有任何错误，但没有提交表格。以下是我的代码：Models.py：

```
from django.db import models
from django.contrib.auth.models import User 
class UserProfile(models.Model):
    user=models.OneToOneField(User) 
    meta_keywords=models.CharField("Meta Keywords",max_length=255,
            help_text="Comma delimited set of keywords of meta tag")
    meta_description=models.CharField("Meta Description",max_length=255,
            help_text='Content for description meta tag')

    def __unicode__(self):
        return "User Profile for: "+self.username

    class Meta:
        ordering=['-id'] 
```

表格.py

```
from django.contrib.auth.forms import UserCreationForm
from django import forms
from django.contrib.auth.models import User
from accounts.models import UserProfile
from pprint import pprint

class RegisterationForm(UserCreationForm):
    email = forms.EmailField(label = "Email")
    fullname = forms.CharField(label = "Full name")

    class Meta:
        model = User
        fields = ("username", "fullname", "email", )

    def save(self, commit=True):
        user = super(RegisterationForm, self).save(commit=False)
        first_name, last_name = self.cleaned_data["fullname"].split()
        user.first_name = first_name
        user.last_name = last_name
        user.email = self.cleaned_data["email"]
        if commit:
            user.save()
        return user 
```

视图.py

```
from django.contrib.auth.forms import UserCreationForm
from django.template import RequestContext
from django.shortcuts import render_to_response,get_object_or_404
from django.core import urlresolvers
from django.http import HttpResponseRedirect
from django.contrib.auth.decorators import login_required
from accounts.forms import RegisterationForm
#from accounts.forms import UserProfile

def register(request,template_name="account/register.html"):
    if request.method=='POST':
        postdata=request.POST.copy()
        form=RegisterationForm(postdata)
        if form.is_valid():
            form.save
            un=postdata.get('username','')
            pw=postdata.get('password','')
            from django.contrib.auth import login,authenticate
            new_user=authenticate(username=un,password=pw)
            if new_user and new_user.is_active:
                login(request,new_user)
                url=urlresolvers.reverse('dashboard')
                return HttpResponseRedirect(url)            
    else:
        form=RegisterationForm()
    page_title="User Registration"
    return render_to_response(template_name,locals(),context_instance=RequestContext(request))

@login_required
def dashboard(request):
    pass

@login_required
def settings(request):
    pass 
```

模板文件（register.html）：

```
 <div class="register_form">
    <form method="post" action="." class="cart"> 
        {% csrf_token %}
    {{form.as_p}}
    <input type="submit" value="Register" name="submit" alt="Register" />
    </form>
</div> 
```

提交表单后，它不再显示除了表单之外的任何内容。在 db 中没有插入新记录，我还从管理面板中检查了它。

我想知道可能是什么问题，因为每件事看起来都很好。有什么好的方法来调试问题吗？诸如 pprint 之类的东西，但是在这种情况下在哪里以及如何调试？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T01:11:55.107

让我大胆猜测

```
form.save 
```

到

```
form.save() 
```

我很紧张！证明我是对的！！！（或部分正确）

不管我是对是错，我通常使用 Python 的`traceback`模块。使用起来真的很简单。

[http://docs.python.org/library/traceback.html](http://docs.python.org/library/traceback.html)

# java - 我应该为简单的报告系统使用什么设计模式

> ID：10290463
> 
> 赞同：0
> 
> 时间：2012-04-24T01:08:09.907
> 
> 标签：java, design-patterns, servlets, struts2

我正在为基于 Web 的报告系统开发 Java 应用程序。该应用程序当前使用 struts2 来处理某些报告，而使用基本 servlet 来处理其他报告。代码到处都是，我想对代码进行一些整理。

从外到内的工作流程如下：

1.  用户点击报告导航中的链接
2.  报告的搜索页面（包含与登录用户相关的 5 到 6 个字段）出现
3.  用户选择参数
4.  表单被提交到 Servlet/Struts2Controller
    *   Servlet/Struts2Controller 收集参数，根据一些逻辑，调用DAO，获取数据，转发到下一页
5.  根据参数显示最终报告

综上所述，所有报告的第 2 点基本相同。因此，我制作了一个`GenericSearchClass`包含显示某些报告的初始搜索页面所需的所有方法。

**我的问题是：**

*   从提交表单到显示最终页面时，我可以使用哪种模式？
*   我应该使用模板方法，抽象类和具体类都有自己的模板方法实现。
*   如果是这样，我的模板方法应该是什么。对于此类问题，是否有更好的模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:38:30.640

我也和你一样。我使用 hibernate、struts2 和 jasper 进行报告。IReport 中的报表和图表设计。在hibernate中使用本机查询的查询然后使用struts 2将列表对象传递给jasper。

您在 jsp 中的步骤 1-3。您的第 4 步创建 DAO 依赖于休眠中的查询（如果必须加入您使用本机查询）。您的步骤 5\. 获取对象列表（struts 2 操作）并使用 ireport 中的 struts2(struts2 xml) 设计发送到 jasper 您只需将该字段命名为与您传递的对象列表上的属性相同

或者您只是在 jasper 中查询并传递参数（用户输入）和连接（jdbc）-> 您可以详细研究 hibernate->struts2->ireport(jasper,jfreechart) 的简单方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:18:16.073

您可以查看在 struts 中使用模型视图控制器模式 [我从谷歌搜索[http://www.vaannila.com/](http://www.vaannila.com/)找到的教程]

如果您有长时间运行的报告，我建议您在前端使用一些 AJAX 异步运行报告，以防止用户多次请求相同的长时间运行的报告。需要半分钟以上才能填写的报告属于这一类。

希望这可以帮助。

# iphone - 体积变化不会改变应用体积

> ID：10290466
> 
> 赞同：1
> 
> 时间：2012-04-24T01:09:20.587
> 
> 标签：iphone, objective-c, xcode, avaudiosession

我们正在使用下面的代码并通过应用程序多次调用此代码来播放按钮和应用程序声音。目前我们遇到的问题是设备上的音量控制不会改变内部应用程序的音量。我们可以将音量一直关闭，应用程序仍会播放声音。有没有办法检测硬件音量控制何时发生变化并相应地更新音量？我们不想更新滑块只是让音频会话响应新设置的音量。非常感谢您提前。

```
AudioSessionInitialize(NULL, NULL, NULL, self);
UInt32 category = kAudioSessionCategory_AmbientSound;
AudioSessionSetProperty(kAudioSessionProperty_AudioCategory,
                        sizeof(category),
                        &category);
AudioSessionSetActive(YES);

NSString *path = [NSString stringWithFormat:@"%@/%@.wav",
                                            [[NSBundle mainBundle] resourcePath],
                                            sound];
SystemSoundID soundID;
NSURL *filePath = [NSURL fileURLWithPath:path isDirectory:NO];

AudioServicesCreateSystemSoundID((CFURLRef)filePath, &soundID);
AudioServicesPlaySystemSound(soundID); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T06:55:22.340

我已经在同一问题上进行了研发，您可以通过使用更改外部设备音量来更改音量滑块

```
MPMusicPlayerController *_musicController = [MPMusicPlayerController iPodMusicPlayer]; 
```

下面有几个链接，也许这些对你有帮助。

1.  `http://stackoverflow.com/questions/9227435/changing-device-volume`

2.  `http://oleb.net/blog/2009/07/the-music-player-framework-in-the-iphone-sdk/`

# ruby-on-rails - Rails : Send email via Gmail in production

> ID：10290470
> 
> 赞同：8
> 
> 时间：2012-04-24T01:09:56.543
> 
> 标签：ruby-on-rails, smtp, gmail, host

I want to send email via my gmail account in PRODUCTION. It works great in local host.

In my environment.rb I have :

```
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
 :address             => "smtp.gmail.com",
 :port                => 587,
 :domain              => "myhost.com",
 :authentication      => "plain",
 :user_name           => "name@myhost.com",
 :password            => "mypassword",
 :enable_starttls_auto => true 
```

}

And in my production.rb file :

```
config.action_mailer.raise_delivery_errors = true
config.action_mailer.default_url_options = { :host => 'gmail.com' } 
```

But it doesn't work and I have that error :

```
Errno::ECONNREFUSED (Connection refused - connect(2)): 
```

Any ideas ? My app is deployed on Heroku. For the `host` what do I have to put ?

Thanks !

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:19:12.687

主机应该是`www.yourapp.com`。我在 Heroku 上的 gmail 设置如下所示，它们可以正常工作：

```
config.action_mailer.default_url_options = { :host => 'www.myapp.com' }
config.action_mailer.raise_delivery_errors = true
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
    :enable_starttls_auto => true,
    :address => "smtp.gmail.com",
    :port => 587,
    :domain => "gmail.com",
    :authentication => :login,
    :user_name => "user@myapp.com",
    :password => "mypassword"
} 
```

# c# - 更新每个记录的结构未知且不同的xml

> ID：10290472
> 
> 赞同：0
> 
> 时间：2012-04-24T01:10:17.513
> 
> 标签：c#, xml, wcf, xelement

我需要更新一些结构未知的 xml，我不太确定从哪里开始。我在数据库表中有一个带有一些 xml 的字段，每条记录可以是不同的 xml。关联的模式也存储在数据库中。

我正在创建一个 Web 服务，其中更新作为 XElement 发送。我需要找到正确的节点并更新它们（可以在更新中发送任意数量的节点）。我有一个单独的方法来处理添加新节点，因为我可以合并 XD​​ocuments 来做到这一点。

关于从哪里开始的任何指示？

谢谢，

安妮莉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:18:24.230

您将必须想出一个可以理解您发送的内容的结构。

一种想法是，在传入的根节点中有一个路径属性，它将指向接收 xml 文档中的路径，该路径是传入节点的位置。

二，或者单独调用服务，该服务只接收一种类型的响应，因此知道如何处理响应。对每种不同响应类型的单独调用。

所以要么知道你正在发送/接收什么，要么嵌入到传入的 xml 中如何处理它。

**编辑** 正如你的标题所说，你不知道结构，你仍然必须有某种理解方式（又名结构），或者你不可能知道在哪里存储传入的数据。

# matlab - reading formatted input in matlab

> ID：10290474
> 
> 赞同：0
> 
> 时间：2012-04-24T01:10:32.373
> 
> 标签：matlab, io

I am trying to read a file with 5 entries for each line, two of which are float and the others are integers. However, fscanf function of matlab only reads two rows, and I guess it's a memory problem (for just 5k lines of data?).

Do you know how to fix this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T10:08:30.617

我怀疑它是一个内存问题。也许您的输入文件中有一些意想不到的字符？你能重现以下内容吗？

# 输入.txt

```
3.4E-5 4.2E14 1475 381 998877
3.4E-5 4.2E14 1475 381 998877
3.4E-5 4.2E14 1475 381 998877
3.4E-5 4.2E14 1475 381 998877
3.4E-5 4.2E14 1475 381 998877 
```

# 结束输入.txt

```
filename='input.txt';
fid = fopen(filename);
A = fscanf(fid, '%f %f %d %d %d', [5 inf])';
fclose(fid);

>> A(:,1)

ans =

  1.0e-004 *

    0.3400
    0.3400
    0.3400
    0.3400
    0.3400

>> A(:,5)

ans =

    998877
    998877
    998877
    998877
    998877 
```

请小心，因为我很确定在使用具有多种数字类型的 fscanf 时，所有数字都会被翻倍。

```
>> class(A(:,5))

ans =

 double 
```

# c - 文件结束原因

> ID：10290482
> 
> 赞同：-1
> 
> 时间：2012-04-24T01:12:33.520
> 
> 标签：c, file

对于一个项目，我必须将组成的汇编语言翻译成内存位置和操作码。我需要解析文件两次，我使用 strtok() 来执行此操作。但是，我的程序没有到达第二个循环。（我在开头放了一个打印语句，所以我很确定它没有到达它。）我的想法是指针在文件的末尾，所以我试着把 rewind(filename) 和 fseek(filename, 0 , SEEK_SET)，但似乎都没有解决问题。有什么想法吗？谢谢。

编辑：这是一些代码（第二遍代码）

```
j=1, i=0;
/*SECOND PASS*/
fseek(opcode,0,SEEK_SET);
char string[5];
while((fgets(str, buffer, file))!=NULL){/*getting line*/
printf("it got here. yup.");
fputs(memLoc(j-1), opcode); /*inserts the location in memory to file*/
fputs(" ", opcode);/*puts a space in the file*/ 

int state=0; /*state to see if on first or second part of code*/

for(i=0; i<buffer; i++){ /*gets rid of extra new line chars*/
    if(str[i]=='\n'){
    str[i]= '\0';
    break;
    }
}
cp = xerox(str);
token = strtok(cp, delimiters);
printf("%s ",token);
/*if it's not a label, find corresponding opcode and insert into file,
switch state, if it's a label, don't switch state*/
    if((token!=NULL)&&token[strlen(token)-1]!=':'){
        fputs(findOpCode(token), opcode);
        state=1;
    }
    else state=0;

/*if it should be an opcode, insert corresponding opcode into file,
if it should be a location, find and insert where it should be*/
    for (;token = strtok(NULL, delimiters);){
    printf("%s ",token);
        if(token!=NULL)
            if(state==0){
            fputs(findOpCode(token), opcode);
            }

            else if(state==1){
            fputs(locate(token, fIndex), opcode);
            }
        }
    j++;
    fputc('\n', opcode);/*next line*/
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:27:15.587

我要做的第一件事是为您的 fseek 添加错误检查：

```
if (fseek(opcode,0,SEEK_SET) == -1) {
    perror("fseek");
    exit(1);
} 
```

这应该会给你更多的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T03:21:50.070

你不是倒带错误的文件吗？您不想倒带正在读取和解析的文件吗？如果是这样，它应该是：

```
fseek(file,0,SEEK_SET); 
```

# c - 尝试为结构中的字符串分配内存时出现分段错误

> ID：10290483
> 
> 赞同：1
> 
> 时间：2012-04-24T01:12:36.223
> 
> 标签：c, pointers, struct, segmentation-fault, malloc

解决我必须将文件中的数据读取到结构中的问题。

该文件被组织成有一个名称、几行以# 结尾的ASCII 艺术和一个等级。这是一个例子

```
Sample Name
( S )
( S )
# 5 
```

我的结构设置如下：

```
typedef struct
 {
   char* name;
   char* art;
   int rating;
 }CASE; 
```

`segmentation fault`我的问题是，当我尝试在下面的代码中为名称字符串动态分配内存时，我一直得到一个：

```
/*FPin is file pointer to the txt file and all is the array of structs*/
void readFile(FILE* FPin, CASE** all)
{ 
  CASE* walker = *all;
  int count = 0;
  char buffer[160];
  char* bufferPtr = buffer;
  char nameBuffer[100];

  /*Reads in the name*/

  while(fscanf(FPin, "%[^\n]", nameBuffer))
  {
    printf("string is %s\n", nameBuffer);
    walker->name = (char*)malloc(sizeof(char)*(strlen(nameBuffer+1)));  /*ERROR*/  
    strcpy(walker->name, nameBuffer);
  } 

  return;
  } 
```

我记下了我认为错误在上面的代码中的位置，因为一旦我添加了该行，我就开始得到它。

我基本上是将文本中的名称读入 nameBuffer （数组），然后使用 strcpy 将此名称复制到结构中。关于如何解决这个问题的任何建议？

感谢您的关注。

我将在下面包括我的其余来源：

```
int main (void)
{
  CASE* all;
  FILE* FPin;

  if((FPin = fopen("art.txt", "r")) == NULL)
  {
    printf("Error opening file.");
    exit(100);  
  }

  allocateStructMem(&all);
  readFile(FPin, &all);

  fclose(FPin);
  return 0;
}

void allocateStructMem (CASE** all)
{
  if((*all = (CASE*)malloc(sizeof(CASE)*1000)) == NULL)
    {
      printf("Fatal memory error!\n");
      exit(1);
   }

  return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:18:00.130

~~strlen(nameBuffer+1)~~

```
strlen(nameBuffer)+1 
```

当您 malloc 时，您还必须执行以下操作`all`：

```
int allocateStructMem(CASE **all)
{
    /*  +----- Note. And no need to cast as malloc returns (void *)
        |                                           */
    if((*all = malloc(sizeof(CASE*) * 1000)) == NULL) 
```

为防止溢出，您必须限制 的长度`fscanf`，即：

```
while (fscanf(FPin, "%99[^\n]", nameBuffer) == 1) { 
```

确保您实际上已将某些内容`1`读入 nameBuffer。

也不`strcpy`填充——但你可能知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T01:16:53.503

将 +1 移到括号外有帮助吗？

```
walker->name = (char*)malloc(sizeof(char)*(strlen(nameBuffer)+1));  /*ERROR*/ 
```

# django - How to truncate text in Django template loop

> ID：10290490
> 
> 赞同：1
> 
> 时间：2012-04-24T01:13:56.873
> 
> 标签：django, django-templates

I am spitting out some values with a for loop and want to make sure that it only displays X characters. I'm relatively new to Django.

For example:

```
 <div class="bookauthor">
    by 
    {% for author in book.volumeInfo.authors %}
      {% if not forloop.first %}&amp;{% endif %}
      {{author}}
    {% endfor %} 
  </div> 
```

Would produce a list of book authors, e.g.:

> by Lennart Berggren & Jonathan M. Borwein & Peter B. Borwein

and I'd only like 30 characters, since sometimes the list of authors can be long.

I understand that I can use truncatechars ([new in Django 1.4](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#truncatechars)) to do this on a single value like `{{author|truncatechars:9}}`, but I'm wondering if there is an elegant way to apply to the for loop, or the resulting text from the for loop. Please let me know if this isn't clear.

**EDIT**

truncatechars does not seem to work properly when used in a {% filter %}. All it produces is "...". I'll test some more, could be a bug. truncatewords works well, and I may be more suitable for this situation anyhow.

```
 <div class="bookauthor">
        by 
        {% filter truncatechars:30 %}
          {% for author in book.volumeInfo.authors %}
          {% if not forloop.first %}&amp;{% endif %}
            {{author}}
          {% endfor %}  
        {% endfilter %}  
     </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:16:03.650

[`{% filter %}`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#filter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-27T02:38:26.153

使用自定义过滤器（[此处](https://docs.djangoproject.com/en/4.0/howto/custom-template-tags/)的文档）

```
@register.filter
def queryset_as_list(queryset, attr=None):
    query_list = []
    for param in queryset:
        query_list.append(getattr(param, attr) if attr else str(param))

    return query_list

@register.filter
def str_list(list):
    return ', '.join(list) 
```

我使用过滤器将查询集转换为列表，使用另一个过滤器将列表转换为字符串，最后使用 django 的 truncatechars 过滤器在模板中仅显示 50 个字符，如下所示

```
{{ book.volumeInfo.authors|queryset_as_list|str_list|truncatechars:50 }} 
```

# java - Insert data object in a timestamp table

> ID：10290497
> 
> 赞同：0
> 
> 时间：2012-04-24T01:15:04.670
> 
> 标签：java, parsing, date, timestamp

my program has a field to insert hours manually. My mysql table has two timestamp fields - one to register when a employee arrive at work and the other when leaves. What I am doing so far is: convert the Strings to date and format it properly -> than I convert this data object into timestamp. The problem is that I am getting the year of 2007. Is there a way when I do that to automatically insert the actual date whith the manual hours inserted?

Cheers

# .net - .net 中的字符串不变性和实习

> ID：10290499
> 
> 赞同：1
> 
> 时间：2012-04-24T01:15:33.017
> 
> 标签：.net, string, string-interning

我打算就[这个其他 SO 问题](https://stackoverflow.com/questions/10290209/store-all-the-results-of-a-loop-in-a-single-string)发表一个答案，但有人在我前面使用 StringBuilder 类，无论如何，离题了......

我知道 .NET 中的字符串是不可变的，因此创建字符串并对其进行修改实际上会在内存中创建两个不同的字符串，这与`StringBuilder Class`维护内部缓冲区并仅在`ToString()`调用时创建最终字符串相反。我也知道 .NET 实习生每个字符串，所以只会为应用程序中使用过的每个字符串创建一个副本。

当您将一个字符串附加到另一个字符串时，它们都在应用程序中使用，因此它们都被实习了（不是吗？），不使用连接运算符附加字符串的主要原因是因为您最终会得到一个完成后内存中的一整串字符串，每个都比前一个大。

我知道连接`01234`with`56789`会导致内存中出现以下两个字符串：

> 01234
> 0123456789

在使用`StringBuilder`will only 时，由于实习：

> 01234
> 56789

显然第二种方法对性能更好，但实际上有多好？我的意思是，如果您要从一小部分值列表中创建一个更大的字符串，我为什么要考虑`StringBuilder`（本身占用内存空间）？**总是**好用吗？或者对于何时[不]使用它有什么好的经验法则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:33:25.140

> 我也知道 .NET 实习生每个字符串

不，你对实习有错误的想法。例如，当您通过连接创建新字符串时，运行时不会*搜索*内部字符串表以查看是否存在匹配项。这将是非常低效的，过多的 cpu 周期对于 GC 堆空间的非常适度的节省。

在常规 .NET 应用程序中实习的唯一字符串是从一开始就作为实习生的字符串。编译器从源代码中的文字创建并添加到程序集元数据中的字符串表中的那些。您可以使用 String.Intern() 方法显式地实习字符串，但这是非常罕见的事情。

您使用 StringBuilder 来避免生成太多寿命很短的临时字符串。

# django - Django 视图 单一表单处理

> ID：10290500
> 
> 赞同：-1
> 
> 时间：2012-04-24T01:15:41.960
> 
> 标签：django

我是 Django 的新手，想澄清一下下面的代码，我在 views.py 中看到了代码，想知道它是如何工作的。通常在视图中，我用变量 tha 调用我的 hmtl

```
sfp = SimpleFormProcessing(
    form_class=VolunteerSignupForm,
    form_2_model=volunteersignupform_2_model,
    form_template='signups/create_contact_form.dmpl',
    email_template='signups/response_email.dmpl',
    email_html_template='signups/response_email_html.dmpl',
    email_subject='Vibha Volunteer Signup',
    email_sender='volunteer@vibha.org',
    redirect_url='/signups/thanks/',
    do_captcha=True) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:45:22.720

我不知道的目的`SimpleFormProcessing`，但每次你看到

`something(....)`我们很可能将一些参数传递给函数/类的构造函数。

在这种情况下，我的猜测是它`SimpleFormProcessing`只是一个包装器（无论是类还是函数，在这里都无关紧要），它处理所有注册过程。

换句话说，它通常是一个包装函数或类（将其视为用户的 API），它接收一堆参数，然后分派作业。

例如，假设它是一个函数。

```
def SimpleFormProcessing(*args, **kwargs):
  form_class = kwargs.get('form_class', None)
   ...... # get all the parameters from kwargs (a dictionary) .....

  # now let's do something
  add_user_to_volunteer_list(form)
  email_user(email_subject, email_sender....)
  ... and more .... 
```

如果那是一个类（调用类构造函数），那么它可能会使用传入的这些参数分配属性（成员属性）。因此可能会有一些类方法可以稍后调用。

```
#sfp is now a class object. We might have....
sfp.email_user()
sfp.get_sender()
and etc 
```

当然，您需要找到它`SimpleFormProcessing`并查看代码。我找不到它作为 Django 的一部分。

它可能是一个具有自定义管理器、中间件等的应用程序？例如，在 Django 中，我们有

```
RequestContext(request, { 'foo': 'bar', }) 
```

RequestContext 是一个内置的 Django 类。

# python - 为什么这个回文测试不起作用？

> ID：10290503
> 
> 赞同：3
> 
> 时间：2012-04-24T01:16:11.780
> 
> 标签：python

回文是一个向前和向后读取相同的字符串。回文的例子包括“lol”、“abba”、“radar”和“pickle elkci​​p”。指示它是否在以下文档字符串中描述的所有情况下都有效：'''如果字符串 s 是回文则返回 True，否则返回 False。'''

```
def palindrome2(s):
    n = len(s)
    pal = True
    for i in range(n/2):
        if s[i] == s[n-i-1]:
            pal = True
        else:
            pal = False
    return pal 
```

我不明白为什么这个功能不起作用。对我来说，似乎该功能有效。显然，布尔值被滥用了，但我不明白上面的布尔值是如何没有正确使用的。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T01:22:16.197

为了好玩，您还可以尝试更简单的方法：

```
def palindrome(s):
  return s[::-1] == s 
```

（关于它如何工作的练习留给读者）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T01:17:48.193

循环体的编码方式`pal`可能会反复变化`True`，`False`具体取决于在特定迭代期间给定的字符对是否碰巧匹配。

最好检查不等式，然后将您的布尔变量设置`pal`为`False`并立即退出循环。

像这样的东西：

```
def palindrome2(s):
    n = len(s)
    pal = True

    for i in range(n/2)
        if s[i] != s[n-i-1]: # the moment it's false
           pal = False       # set pal and
           break             # drop out of the loop

    return pal 
```

或者，不使用布尔变量：

```
 ...
    for i in range(n/2)
        if s[i] != s[n-i-1]: # the moment it's false
           return False      # exit the function by returning False

    return True  # otherwise return True 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T01:17:29.893

你总是检查*每一个字符*。您需要在明确知道结果后立即返回。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-24T01:42:27.997

@ulmangt 的解决方案非常聪明，但我会选择一个不那么神秘的：

```
def palindrome(s):
    return all(( s[i] == s[-(i+1)] for i in range(len(s)/2) )) 
```

至少它做了一半的比较;-)

# wpf - 单击时WPF弹出窗口不会导致应用程序聚焦

> ID：10290504
> 
> 赞同：11
> 
> 时间：2012-04-24T01:16:23.700
> 
> 标签：wpf, popup

我有一个控件正在使用一个弹出窗口，其中包含一些 WPF 控件，并且 StaysOpen="True"。问题是当应用程序没有焦点时单击弹出窗口时，应用程序没有获得焦点。我做了一些研究，似乎这可能是因为弹出窗口是用于菜单的，所以它们没有连接所有正确的 Windows 消息处理程序。这是演示问题的准系统示例：

```
<Window x:Class="TestWindowPopupBehavior.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:TestWindowPopupBehavior="clr-namespace:TestWindowPopupBehavior" Title="MainWindow" Height="350" Width="525">
<Grid>
    <Popup StaysOpen="True" IsOpen="True" Placement="Center">
        <ListBox>
            <TextBlock>123</TextBlock>
            <TextBlock>123</TextBlock>
            <TextBlock>123</TextBlock>
            <TextBlock>123</TextBlock>
            <TextBlock>123</TextBlock>
            <TextBlock>123</TextBlock>
        </ListBox>
    </Popup>

</Grid>
</Window> 
```

1.  运行应用程序。
2.  与列表框交互，应该可以正常工作。
3.  切换到另一个应用程序。
4.  在应用程序未激活时单击列表框。没发生什么事
5.  单击列表框外的应用程序。
6.  单击列表框。它现在正在工作。

我希望在第 4 步中发生的事情是应用程序将获得焦点，并且列表框将选择新项目。

这个问题是否有任何解决方法，或者我缺少什么明显的东西？我正在考虑用成熟的窗口重写整个弹出代码，并重新实现我们的行为，但这似乎真的很复杂，只是为了解决这样的一个小问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T08:37:33.867

如果你处理`MouseLeftButtonDown`事件，你可以调用`Window.Activate()`方法。但是您应该为每个元素编写它 -`Popup`以及所有`TextBlock`s。

您可能遇到的问题是，在 Windows 上，您可以交换鼠标按钮，从左到右，反之亦然（但我不知道这是如何工作的），因此，您可能必须处理`MouseRightButtonDown`事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-15T09:52:45.623

今天我自己也遇到了这个问题。

如果需要，可以通过在 app.xaml.cs 中的 Popup 类本身上注册一个类处理程序来全局修复它：

C＃：

```
/// <inheritdoc />
protected override void OnStartup(StartupEventArgs e)
{
    EventManager.RegisterClassHandler(typeof(Popup), UIElement.PreviewMouseDownEvent, new RoutedEventHandler(Popup_PreviewMouseDownEvent));
}

/// <summary>
/// Ensures that the application is activated before the <see cref="UIElement.MouseDownEvent"/> is invoked on the Popup.
/// This solves an issue where the Popup seemed to be frozen if you focused out to another application and clicked back in the Popup itself.
/// </summary>
/// <param name="_"></param>
/// <param name="__"></param>
private void Popup_PreviewMouseDownEvent(object _, RoutedEventArgs __)
{
    Current?.MainWindow?.Activate();
} 
```

# python - 抓取 tag with lxml's iterparse

I'm running into a problem with using lxml's `iterparse` on my HTML. I'm trying to get the `<title></code>'s text but this simple f</h1> <blockquote> <p>ID：10290507</p> <p>赞同：3</p> <p>时间：2012-04-24T01:16:58.927</p> <p>标签：python, dom, web-scraping, lxml, iterparse</p> </blockquote> <hr/> <h2>回答 #1</h2> <blockquote> <p>赞同：2</p> <p>时间：2012-04-24T01:40:07.603</p> </blockquote> <p>您可能希望至少发布您实际尝试解析的数据的一部分。没有这些信息，这里是一个猜测。如果 <code><html></code>元素定义了默认的 XML 命名空间，则在查找元素时需要使用它。例如，看看这个简单的文档：</p> <pre><code><?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd" xml:lang="en"> <head> <title>Document Title</title> </head> <body> </body> </html> </code></pre> <p>鉴于此输入，以下将不返回任何结果：</p> <pre><code>>>> doc = etree.parse(open('foo.html')) >>> doc.xpath('//title') [] </code></pre> <p>这失败了，因为我们正在寻找一个<code><title></code>没有指定命名空间的元素......并且没有命名空间，解析器不会找到匹配项（因为<code>foo:title</code>不同于 <code>bar:title</code>，假设<code>foo:</code>和<code>bar:</code>是定义的 XML 命名空间）。</p> <p>您可以使用 ElementTree 接口显式使用命名空间，如下所示：</p> <pre><code>>>> doc.xpath('//html:title', ... namespaces={'html': 'http://www.w3.org/1999/xhtml'}) [<Element {http://www.w3.org/1999/xhtml}title at 0x1087910>] </code></pre> <p>还有我们的比赛。</p> <p>您也可以将命名空间前缀传递给<code>tag</code>iterparse 的参数：</p> <pre><code>>>> titleIter = etree.iterparse(StringIO(str), ... tag='{http://www.w3.org/1999/xhtml}title') >>> list(titleIter) [(u'end', <Element {http://www.w3.org/1999/xhtml}title at 0x7fddb7c4b8c0>)] </code></pre> <p>如果这不能解决您的问题，请发布一些示例输入，我们将从那里开始工作。</p> </body> </html></title>`

# jquery - Jquery Sortable - Replacing Items rather than swapping items

> ID：10290510
> 
> 赞同：1
> 
> 时间：2012-04-24T01:17:23.813
> 
> 标签：jquery, jquery-ui-sortable

Is there any configurable option to achieve the feature like replacing the list items rather than swapping items in JQuery Sortable UI. Current feature is like Item1 Swaps with Item2 and vice versa. I need a feature like, If item2 is dragged and dropped on Item1, item2 should replace Item1 and Item2 position will be empty. Any help? thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T04:06:02.933

您可以使用以下代码执行此操作：

```
$('#container').sortable({
  connectWith: '#container',
  items: '.children', //#container > .children
  cursor: 'move',
  receive: function(event, ui) {
    var item = $(ui.item);
    var sender = $(ui.sender);
    sender.append(item.siblings('.children'));
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T04:39:48.337

Hiya**演示** [http://jsfiddle.net/CZm9C/2/](http://jsfiddle.net/CZm9C/2/)

现在从第一个框拖动到第二个。希望这会有所帮助，如果我错过了什么，请告诉我，:)

**jQuery**

```
$(document).ready(function(){
    $(".leftDiv .item").draggable({
        helper: function(ev, ui) {
            return "<span class='helperPick'>"+$(this).html()+"</span>";
        },
        connectToSortable: ".rightDiv"
    });

    $(".rightDiv").sortable({
        'items': ".item",
        'receive': function(event, ui){
            // find the class of the dropped ui, look for the one with the integer suffix.
            var clazz = getClassNameWithNumberSuffix(ui.item);
            $('.leftDiv .' + clazz).draggable( "option", "revert", true )
            if($('.rightDiv .' + clazz).length > 1){
                $('.rightDiv .' + clazz + ':not(:first)').remove();    

            }
            $('.leftDiv .' + clazz).remove();
        }
    });

});

function getClassNameWithNumberSuffix(el) {
  var className = null;
  var regexp = /\w+\d+/;
  $($(el).attr('class').split(' ')).each(function() {
    if (regexp.test(this)) {
      className = this;
      return false;
    }
  });

  return className;
} 
```

**HTML**

```
<div class="leftDiv"> drag to ==>
    <div class="item item1">Item 1</div>
    <div class="item item2">Item 2</div>
    <div class="item item3">Item 3</div>
    <div class="item item4">Item 4</div>
    <div class="item item5">Item 5</div>
    <div class="item item6">Item 6</div>
</div>
<div class="rightDiv"> ==> To this
     <div class="item item1">Item 1</div>
    <div class="item item2">Item 2</div>
    <div class="item item3">Item 3</div>
    <div class="item item4">Item 4</div>
    <div class="item item5">Item 5</div>
    <div class="item item6">Item 6</div>
</div> 
```

**CSS**

```
.leftDiv, .rightDiv {width:120px; float:left; border:1px solid #000; padding:5px; margin:10px; min-height:130px}
.rightDiv {margin-left:40px}

.item {height:20px; line-height:20px; text-align:center; border:1px solid #EEE; background-color:#FFF}

.helperPick {border:1px dashed red; height:20px; line-height:20px; text-align:center; width:120px} 
```

# ruby - Ruby 数据结构 - 最大队列

> ID：10290512
> 
> 赞同：1
> 
> 时间：2012-04-24T01:17:33.013
> 
> 标签：ruby, data-structures

我正在寻找具有以下特征的 Ruby 数据结构，并且希望不必自己动手：

1.  先进先出（即队列）
2.  允许指定最大长度
3.  当队列达到容量时，新的项目被推入，最旧的项目被丢弃。

我认为[SizedQueue](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/thread/rdoc/SizedQueue.html)可能已经完成了这项工作，但它不满足标准#3，因为它在达到最大长度时会阻止推送。

有人知道在维护良好的图书馆里有这样的野兽吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:38:27.510

听起来您正在寻找循环队列或环形缓冲区。

[cbuffer](http://rubygems.org/gems/cbuffer "cbuffer 宝石")已关闭，但如果超出可用空间仍会抛出。

我发现了一些其他实现作为示例代码，但到目前为止，还没有打包为 gem。一个是[这个 RingBuffer 片段](https://rubyforge.org/snippet/detail.php?type=snippet&id=78)。这可能是一个相当简约的实现，可能需要做一些工作。

[这个位置](http://www.koders.com/ruby/fid4567E39C011F7064117A60EEC2625B6B345EB77B.aspx)似乎包含一个相当完整的 RingBuffer 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-19T22:25:54.803

JasonTrue 答案中的最后两个链接现在已经死了，但我在这里找到了（可能相同的）RingBuffer 片段：[https ://gist.github.com/eerohele/1904422](https://gist.github.com/eerohele/1904422)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-15T21:37:21.213

你可以试试这个[https://gist.github.com/julik/a4c0b88abc17922f4f2a1a01a6bba530](https://gist.github.com/julik/a4c0b88abc17922f4f2a1a01a6bba530)

像这样使用它：

```
ring = Ring.new(4)
ring.pos #=> 0
ring << :a # fills first element
ring.pos #=> 1
ring << :b << :c << :d # fills the rest
ring.to_a # [:a, :b, :c, :d] - Array of elements from the current position
ring.next #=> :a 
ring.to_a # [:b, :c, :d, :e] - Position shifted
ring << :z #=> overwrites :b and advances position
ring.to_a #=> [:c, :d, :a, :z] 
```

# html - How should I write an "archive page" or "category index" with html5?

> ID：10290520
> 
> 赞同：6
> 
> 时间：2012-04-23T09:14:35.420
> 
> 标签：html, seo

I have a link list, where every item is associated with a short description and some meta info such as pubdate, author etc. How should I markup this in html5?

```
<ul>
    <li>
        <section>    .... OR ARTICLE?
           <header>
               <h1>title</h1>
               pubdate, author, etc
           </header>
           shortdesc
        </section>
    </li>
    .... repeat
</ul> 
```

Do you think it is a good idea to use sections/article?

Or are plain `<li>`s better?

Article or section?

IMPORTANT NOTE: every item does not contain full content (article), just a short description and the link to the page that actually contains the article.

I'm also interested in a SEO point-of-view!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:31:13.520

我建议`article`在这里使用，因为每个项目本身都是一个单独的实体，并且可以联合起来（例如在 RSS 提要中）。前段时间我写了一点：[HTML5：Section or Article？](http://www.iandevlin.com/blog/2011/04/html5/html5-section-or-article).

您也不需要在这里使用列表，因为每个`article`都可以视为列表项。

我还建议使用该`time`元素来附上每个条目的发布日期。

至于我建议的 SEO，就像您发布的示例代码一样。

# image - android：带有图像的多自动完成文本视图下拉项

> ID：10290525
> 
> 赞同：2
> 
> 时间：2012-04-24T01:19:07.573
> 
> 标签：image, autocomplete, favorites

我已经实现了由从数据库中获取的字符串驱动的 MultiAutoComplete，一切正常。现在我正在尝试向我的应用程序添加“收藏夹”功能，因此当我将项目设置为收藏时，自动完成的下拉菜单将显示图像。我可以向所有项目显示图像，但这不是我想要的（仅显示图像以收藏）。

我想我只会设置可见性，但是如何为一个项目做到这一点？请帮忙。谢谢

# c# - 为什么静态变量不允许递归？

> ID：10290527
> 
> 赞同：7
> 
> 时间：2012-04-24T01:19:19.377
> 
> 标签：c#, c, recursion

正如 Sebesta 在《编程语言概念》一书中提到的：

*   静态变量提供全局访问，可以在子程序调用之间保留值（历史敏感），并且是有效的。
*   静态变量不支持递归

为什么静态变量不支持递归？这是因为如果发生递归，它会浪费大量内存，因为它是`static`，这意味着它不会从内存中释放，直到整个程序终止？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T04:43:41.387

使静态字段难以在递归算法中使用的原因不是它们是*静态*的，而是它们*与激活无关*。非静态字段同样难以在递归算法中有效使用。

此外，问题不在于*递归*算法难以使用字段，而更普遍的是，*重入*算法或将在多个线程上调用相同代码的算法难以使用字段。

使局部变量和形式参数在递归和其他重入场景中有用的原因是它们*与激活相关联*。

简而言之：这本书令人困惑，因为它*太具体了*。这就像说在白色的桌子上很难平衡一个棕色的鸡蛋；这是真的，但棕色和白色与它有什么关系？很难平衡*任何*桌子上的*任何*鸡蛋。在递归调用中很难正确使用静态字段，因为在*任何重入场景中都很难正确使用**任何*字段。

 **** * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-24T01:34:30.233

每个递归调用都将访问同一个静态变量，并覆盖其他调用存储在变量中的值。除非静态变量用于某些纯粹的迭代目的，例如计算函数被调用的次数，否则在进行递归时通常不需要这样做。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T02:42:21.427

也许一些示例代码可以说明使用递归时如何管理内存。以及如何在递归例程中使用静态变量是不可能的（一个可能的例外是当您想要一个全局计数器来计算函数被调用的次数时，无论该方法是如何被调用的（例如从多线程或连续称呼））

鉴于此 C 代码：

```
#include <iostream>
using namespace std;

void callMe(int j) {

        static int i = 0;

        ++i;
        ++j;
        printf("Loop: %d\n", i);

        printf("i memory location: %p\n", &i);
        printf("j memory location: %p\n", &j);            
        printf("\n");

        // change i to j ,
        // so the other next method invocations
        // or simultaneous(e.g. multi-threaded) method invocations
        // of this method can work independently from 
        // other method invocations / simultaneous method invocations
        if ( i < 10 ) 
            callMe(j);

        printf("Returning from loop %d\n", j);        
}

int main() {     
        callMe(0);
        printf("Next\n");
        callMe(0);     
        return 0;     
} 
```

输出：

```
Loop: 1
i memory location: 0x804a038
j memory location: 0xbf8b69c0

Loop: 2
i memory location: 0x804a038
j memory location: 0xbf8b69b0

Loop: 3
i memory location: 0x804a038
j memory location: 0xbf8b69a0

Loop: 4
i memory location: 0x804a038
j memory location: 0xbf8b6990

Loop: 5
i memory location: 0x804a038
j memory location: 0xbf8b6980

Loop: 6
i memory location: 0x804a038
j memory location: 0xbf8b6970

Loop: 7
i memory location: 0x804a038
j memory location: 0xbf8b6960

Loop: 8
i memory location: 0x804a038
j memory location: 0xbf8b6950

Loop: 9
i memory location: 0x804a038
j memory location: 0xbf8b6940

Loop: 10
i memory location: 0x804a038
j memory location: 0xbf8b6930

Returning from loop 10
Returning from loop 9
Returning from loop 8
Returning from loop 7
Returning from loop 6
Returning from loop 5
Returning from loop 4
Returning from loop 3
Returning from loop 2
Returning from loop 1
Next
Loop: 11
i memory location: 0x804a038
j memory location: 0xbf8b69c0

Returning from loop 1 
```

正如我们所见，`static i`变量在内存中只有一个位置；因此，这些值可以在调用之间存在。如果您想分治一个给定的问题，尤其是在多线程方法调用上，这是不可取的。如果两个同时调用一个`callMe`方法，另一个 callMe 可能无法完成它的任务，因为这些方法调用只是使用相同的变量实例（静态变量），这些方法调用会相互产生副作用，这些方法不能彼此独立工作，因为它们没有独立的变量副本。

上面的代码即使不是多线程的，下一个方法调用也无法完成它的任务，因为第二次调用访问相同的变量（静态变量）并接收已经被先前方法调用污染的值

简单来说，静态变量即使在函数内部，仍然是全局变量。函数内的静态变量只是防止名称冲突，但出于所有意图和目的，静态变量是**全局变量**

要使代码按预期执行，`if (i < 10)`请将`if (j < 10)`

顺便说一句，非静态变量分配了自己的内存，它分配在堆栈上。如果我们没有停止条件，在多次递归调用之后，上面的代码会产生堆栈溢出错误，这就是 stackoverflow 得名的地方。可以说，程序员都喜欢[递归](https://stackoverflow.com/a/10291083/11432)ツ</p>

现场测试：http: [//ideone.com/Xl86q](http://ideone.com/Xl86q)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T01:35:24.487

递归将对象的多个实例分层，每个实例保留自己的数据。静态变量在所有实例之间共享。我确信静态变量可以被递归过程使用，并且在用作常量时是合适的，但在动态使用时会使调试变得困难。***

# emacs - emacs 针对缓冲区文件名运行 shell 命令

> ID：10290528
> 
> 赞同：1
> 
> 时间：2012-04-24T01:19:26.543
> 
> 标签：emacs

在 emacs 中，我总是需要运行命令来验证文件。

我想对缓冲区中正在编辑的文件运行 shell 命令，我应该怎么做？

shell 命令（我使用 python 编写）只接受文件名作为参数。所以可能有两种解决方案：

1.  如何将迷你缓冲区中的文件名传递给命令？
2.  如何更改脚本以便它可以接受缓冲区作为输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:41:26.347

1.  是完全重复的。见上面的链接。

2.  您可以使用`M-|`将区域作为输入传递给任何 shell 脚本。假设您的脚本可以从标准输入读取，那应该解决该选项。（如果不能，解决这个问题肯定需要一个单独的问题。）

# mysql - 创建新的唯一索引时，键“user_image”的错误条目“1-11”重复

> ID：10290529
> 
> 赞同：7
> 
> 时间：2012-04-24T01:19:30.257
> 
> 标签：mysql, indexing, unique, mysql-error-1062

我的表结构：

```
CREATE TABLE `userimageview` (
  `user_id` int(11) unsigned NOT NULL,
  `image_id` int(11) unsigned NOT NULL,
  `thumbnail_view` int(10) unsigned NOT NULL,
  `fullsize_view` int(10) unsigned NOT NULL,
  `point` int(10) unsigned NOT NULL,
  KEY `everything` (`user_id`,`image_id`,`thumbnail_view`,`fullsize_view`,`point`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

我要添加的索引：

```
ALTER TABLE `userimageview` ADD UNIQUE `user_image` (`user_id` , `image_id`) 
```

结果：

```
#1062 - Duplicate entry '1-11' for key 'user_image' 
```

我应该如何添加我的`UNIQUE`索引？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T01:27:38.177

您新添加`UNIQUE`的约束失败，因为您的表已经包含违反它的重复行。使用如下查询找到约束违反者。`UNIQUE`只要这些行存在，您就无法添加索引。

```
SELECT
  user_id, 
  image_id, 
  COUNT(*) AS dupes
FROM userimageview
GROUP BY user_id, image_id
HAVING dupes > 1
ORDER BY dupes DESC 
```

# java - 为特定项目选择哪种语言？

> ID：10290532
> 
> 赞同：-1
> 
> 时间：2012-04-24T01:19:50.643
> 
> 标签：java, python

对于我的高级项目，我正在制作一个将在 Windows 计算机上运行的家庭自动化程序（如果 linux 是更好的选择，可以更改）。这个想法是让一个程序一直运行，通过语音命令与用户交互。它会听取要说的关键字，一旦触发，用户就可以提供方向，无论是问题、控制硬件等。这个想法与 Siri/Google 语音命令基本相似，但更进一步，更专注于控制各种家用过程（恒温器、门锁等）

因此，该语言必须是一种具有良好的开放软件文本到语音和语音到文本可用的语言。该程序将使用 ardunio 和 AVR 微控制器用于项目的不同硬件应用程序（不确定这是否有用，但我想我会分享它。）我还将把 wolframalpha [api](http://products.wolframalpha.com/api/libraries.html)集成到应用程序中，数量有限支持的语言。

我对任何可以使这项任务运行最顺利的语言持开放态度，但我的大部分经验是：

1.  爪哇
2.  Python（少量）
3.  PHP（认为这里不适用）

哪种语言最适合这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:25:55.423

*   由于 Java 最初是为运行家庭应用程序而开发的（或者神话如此），它可能是您的程序的最佳候选者。

*   如果没有至少一种其他语言来完成繁重的工作，PHP 是不可能的。

*   Python 可能会做到这一点，但看起来你在 Java 方面有更多经验。

在您提出的三种语言中，我建议使用 Java。“java Speech to text”的快速谷歌返回 1900 万条结果；“python 语音转文本”返回 500,000；有趣的是，PHP 返回了 800 万个结果。仅基于这些数据，我会说 Java 是最佳候选者。另一件需要注意的是，您可能会获得对 Java 的最多支持，因为在这三种语言中，它是最古老的。

正如其他人所指出的那样，MATLAB 是另一个可行的选择，所以请对我的回答持保留态度。我只是根据你所说的你已经知道的内容提供建议。

# java - 无法写入超过特定大小的 DataOutputStream - OutOfMemoryError

> ID：10290535
> 
> 赞同：5
> 
> 时间：2012-04-24T01:20:05.250
> 
> 标签：java, out-of-memory, dataoutputstream

我有以下代码会产生 OutOfMemory 异常：

```
byte[] buf = new byte[10240];
int len = 0;
DataOutputStream dataOS = new DataOutputStream(conn.getOutputStream());
while ((len = _inputStream.read(buf)) > 0) {
    System.out.println("len : " + len);
    System.out.println("Going to write buf into dataOS : " + buf.length);
    dataOS.write(buf, 0, len);
    System.out.println("dataOS.size() : " + dataOS.size());
}
_inputStream.close(); 
```

以下是调试输出的最后几行：

```
len : 10240
Going to write buf into dataOS : 10240
dataOS.size() : 342804702
len : 10240
Going to write buf into dataOS : 10240
dataOS.size() : 342814942
len : 10240
Going to write buf into dataOS : 10240 
```

当我尝试写入超过 342814942 的 dataOS 时发生异常。

有人可以帮我处理这个吗？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T01:32:50.240

它与 DataOutputStream （不维护任何数据）无关，与您的底层流无关`conn.getOutputStream()`。现在，您还没有在那里显示相关代码，但我猜“conn”是 HttpURLConnection 的一个实例。我相信 HttpURLConnection 的输出流缓冲输出，以便它可以确定输出长度（除非您明确设置它）。如果您知道输出长度，您可以直接使用设置`HttpURLConnection.setFixedLengthStreamingMode`，或者您可以调用`HttpURLConnection.setChunkedStreamMode`以允许数据以块的形式发送，而不是完全缓冲在内存中。

将来，当您遇到 OOME 时，您应该*始终*生成堆转储并在内存分析器中打开它。这几乎总是会立即向您显示问题出在哪里（例如在底层流中，*而不是*在 DataOutputStream 中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:30:25.330

根据 OutputStream 的实现，写入可能会在内存中缓冲内容，而不是实际发送。如果你缓冲足够的内容，你当然会耗尽内存。

在某个时间间隔，也许每次通过你的循环，你应该调用[`OutputStream.flush()`](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStream.html#flush%28%29). 如果有缓冲区正在使用，那将清除它。

# python - 添加元素的新实例

> ID：10290541
> 
> 赞同：0
> 
> 时间：2012-04-24T01:20:32.387
> 
> 标签：python, xml, instance

我想有五个元素“post”的实例及其所有子元素。当我这样做时，它只会覆盖前四个并留下第 5 号帖子。如何以唯一标识它们的方式添加新元素，以便如果我再次运行脚本，则用不同的标题发布第 1 号会被覆盖到第 1 号帖子吗？

```
#!usr/bin/env python
import xml.etree.ElementTree as xml
#root name and name of the xml file
dasub = 'therootname'
#open the xml file
file = open("/class/myname/"+dasub+".xml", 'w')
valid = 0
#I want 5 instances of 'post' using the number = valid to identify them
while(valid <= 5):
    root = xml.Element(dasub)
    post = xml.Element('post')
    root.append(post)
    post.attrib['number'] = str(valid)
    title = xml.Element('title')
    title.text = "a diffent text for each one here"
    post.append(title)
    valid = valid + 1
#write it to file
xml.ElementTree(root).write(file)
#close the file
file.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:46:25.407

您的问题是您`root`每次都通过循环覆盖变量，丢弃您在上一次循环迭代中所做的工作。向上`root = xml.Element(dasub)`移出循环，它将按您的预期工作。

# node.js - 无法使用 mongoose 通过节点脚本保存 mongodb 记录

> ID：10290542
> 
> 赞同：1
> 
> 时间：2012-04-24T01:20:57.837
> 
> 标签：node.js, mongodb, mongoose

这是我的 js 文件，描述了不起作用的架构和 API。当我通过命令行工具执行此操作时...架构非常简单，我已经实现了一些简单的查找命令。

```
'use strict'

var util    = require('util');
var bcrypt  = require('bcrypt');
var mongoose = require('mongoose');
var Schema   = mongoose.Schema;

var validatePresenceOf = function(value){
  return value && value.length; 
};

var toLower = function(string){
  return string.toLowerCase();
};

var SportsStandings = new Schema({
  'sport' : { type : String, 
              validate : [validatePresenceOf, 'a sport is required'],
              set : toLower
            },
  'league' : { type : String, 
              validate : [validatePresenceOf, 'a league is required'],
              set : toLower
            },
  'division' : { type : String, 
              validate : [validatePresenceOf, 'a division is required'],
              set : toLower
            },
  'teamName' : { type : String, 
              validate : [validatePresenceOf, 'a teamName is required'],
              set : toLower
            },
   'wins' : { type : Number, min: 0, 
              validate : [validatePresenceOf, 'wins is required'],
            },
   'losses' : { type : Number, min: 0, 
              validate : [validatePresenceOf, 'losses is required'],
            }
});

SportsStandings.statics.findTeamRecord = function(sport, league, 
                                                  division, teamName,
                                              cb) {
  return  this.find({'sport' : sport, 'league' : league, 
                     'division' : division, 'teamName': teamName}, cb);
};

SportsStandings.statics.findBySport = function(sport, cb) {
  return  this.find({'sport' : sport}, cb);
};

module.exports = mongoose.model('SportsStanding' , SportsStandings); 
```

* * *

这是一个简单的节点脚本，它实例化上面导出的对象并尝试在模型上执行保存命令.....

```
'use strict'

var util = require('util');
var mongoose = require('mongoose');
var db = mongoose.connect('mongodb://localhost/mydb');
var SportsStanding  = require('../schemas/SportsStandings');

var record = new SportsStanding({ 
          'sport' : 'mlb',
          'league' : 'AL',
          'divison' : 'east',
          'teamName' : 'New York Yankees',
          'wins' : 10,
          'losses' : 1});

record.save(function(err) {
    console.log('error: ' + err);
    SportsStandings.find().all(function(arr) {
    console.log(arr); 
    console.log('length='+arr.length);
    });
});

process.exit(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T06:59:24.813

请记住，在使用 node.js 进行编程时，您必须非常小心事件驱动的编程风格。您的代码的问题似乎是您`process.exit()`在外部执行级别调用。当您调用`record.save(...)`它时，它将立即将控制权返回到该外部执行级别，并且不允许执行保存或保存回调中的任何代码。

为了解决这个问题，您需要将您的回调函数移到`process.exit()`最里面的回调函数的末尾，然后您应该会看到您期望的结果。

运行您的示例，我发现了您需要纠正的其他几个错别字和错误。检查`SportStanding(s)`模型变量的拼写并确保它在任何地方都匹配。此外，`find()`模型上的 需要回调，它返回数据库中的所有记录（作为第二个参数 - 错误标志是第一个），因此不需要链式`all()`调用。你想要的保存功能最终应该看起来像：

```
record.save(function(err) {
  console.log('error: ' + err);
  SportsStandings.find(function(err, arr) {
      console.log(arr);
      console.log('length='+arr.length);
      process.exit();
  });
}); 
```

# android - Android 的 MediaPlayer prepareAsync() 超时？

> ID：10290547
> 
> 赞同：3
> 
> 时间：2012-04-24T01:21:43.703
> 
> 标签：android, android-mediaplayer, android-music-player

我正在使用`MediaPlayer`的`prepareAsync()`功能。

我的代码如下所示：

```
try {
  mediaPlayer.setDataSource(stream_url);
  mediaPlayer.prepareAsync();
} catch (Exception e) {
  e.printStackTrace();
}

mediaPlayer.setOnPreparedListener(new OnPreparedListener() {
    @Override
    public void onPrepared(MediaPlayer mp) {
        mp.start();
    }
}); 
```

问题是有时`stream_url`播放音乐，有时`stream_url`不播放音乐。`stream_url`如果没有播放音乐，如何通知用户？是否有某种超时或我可以捕捉到的错误？当前没有抛出任何东西，它只是调用 asycn 然后如果没有流则什么都不做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:26:55.167

如果您查看文档，则有可供侦听器使用的子设置器，并且有一个设置器可让您检查异步操作的错误。

```
MediaPlayer.OnErrorListener 
```

*异步操作期间发生错误时要调用的回调的接口定义（其他错误将在方法调用时抛出异常）。*

# c++ - 算法效率：查找数组中最大的 5 个元素

> ID：10290548
> 
> 赞同：-1
> 
> 时间：2012-04-24T01:21:46.477
> 
> 标签：c++, stl, stdmap

```
typedef std::map<uint16_t, uint32_t> TSrcMap;
TPSrcMap sp;
TSrcMap::iterator its;
/*Code to populate the array_start.*/

/*Code to populate the array_end.*/

typedef struct port_count
{
        uint32_t port_number;
        uint32_t port_count;
}port_count_t;

port_count_t pcount[5];
memset(pcount,0,sizeof(pcount));
size_t structs_len = sizeof(pcount)/sizeof(port_count_t);
for(its = stcp.begin(); its != stcp.end();its++)
{
      if(pcount[smallest_index].port_count < (*its).second)
      {
            pcount[smallest_index].port_count = (*its).second;
            pcount[smallest_index].port_number = (*its).first;
#ifdef USEQSORT
            qsort(pcount, structs_len, sizeof(port_count_t), struct_cmp_by_port_count);
#else
            std::sort(pcount,(pcount+structs_len),cmp_by_port_count);
#endif
      }
}

#ifdef USEQSORT
/* qsort struct comparision function compare port frequency*/
int struct_cmp_by_port_count(const void *a, const void *b)
{
        port_count_t *ia = (port_count_t *)a;
        port_count_t *ib = (port_count_t *)b;
        return (ia->port_count - ib->port_count);
}
#else
/* qsort struct comparision function compare port frequency*/
int cmp_by_port_count(const port_count_t& a, const port_count_t& b)
{
        return (a.port_count < b.port_count);
}
#endif 
```

我有一个大的std :: map结构，它将port_count映射到port_number。我必须根据port_count找到最大的5个元素。（其中key是port_number）。我上面给出了一个解析循环，它调用排序算法（ qsort 或 std::sort) 在大小为 5 的数组上。这是实现这一目标的最有效方法吗？就排序函数的调用次数而言。就计算效率而言，有更好的方法吗？我还尝试了 qsort 和 std::sort ，它们的性能似乎都差不多。这是因为我正在排序的数组的大小太小而无法产生重大影响。我试图理解这个算法就其复杂性而言。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:40:19.703

从最初为空的结果双端队列开始，并将在算法期间保持排序：

1.  遍历元素。
2.  对于当前元素：
    *   将其插入到生成的双端队列中的正确位置，以便保留顺序。
    *   如果生成的双端队列包含超过 5 个元素，则删除最小元素。由于双端队列已排序，因此它始终是第一个元素（或最后一个，取决于排序“方向”）。

最后，生成的双端队列包含（最多）5 个最大的元素。这本质上是 O(n) 算法。

除了双端队列，您可以使用带有降序元素的向量并从末尾删除，甚至可以使用链表（尽管指针追逐对性能没有好处）。

* * *

或者，您可以简单地创建额外的地图，即原始地图的“反向”（即价值现在是键，反之亦然）并始终向两者添加元素。这样，替代地图将始终在其末端附近包含 5 个最大的元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T01:41:18.993

你为什么要排序？你让它变得比它需要的更复杂。

创建一个包含 5 个元素的树 - 这是您最大的 5 个元素。（使用 std::set）只需循环内容，每次找到大于树中最小数字的数字时，将其添加到树中并删除任何溢出（前 5 个中的数字一次，不再存在)

这是我在记事本中用两分钟写的东西，没有编译保证：

```
#include <set>
#include <iostream>

using namespace std;

int main(int argc, char **argv)
{
    int unordered[] = {7, 12, 11, 19, 88, 42, 3, 1, 22};

    set<int> biggest5;
    int smallest = -1;

    for(int i = 0; i < sizeof(unordered)/sizeof(int); ++i)
    {
        if (unordered[i] >= smallest)
        {
            biggest5.insert(unordered[i]);

            if(biggest5.size() > 5)
                biggest5.erase(biggest5.begin());

            smallest = *biggest5.begin();
        }
    }

    //All done
    cout << "Set: ";
    for (set<int>::reverse_iterator i = biggest5.rbegin(); i != biggest5.rend(); ++i)
    {
        cout << *i << " ";
    }
    cout << endl;

    return 0;
} 
```

这应该打印

```
Set: 88 42 22 19 12 
```

您还可以在遍历后修剪`biggest5`集合以获得最佳性能，但会消耗更多内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T01:45:59.837

你应该研究一下我最喜欢但经常被忽视的 STL 算法之一：( `nth_element`ref [)](http://www.sgi.com/tech/stl/nth_element.html)。**它对O(N)**中的数据进行部分排序**排序，使得枢轴（第 n 个元素）大于一侧的所有元素而小于另一侧的所有元素. 对于大输入，与快速排序相比的加速可能非常显着。**

 **编辑：如果你想对某个范围进行排序，例如 5 个最大的元素，你可以使用`partial_sort`（[ref](http://www.sgi.com/tech/stl/partial_sort.html)）：

```
std::partial_sort(large_container.begin(), large_container.begin() + 5, large_container.end(), comparison_function); 
```

*将在O(n + 5*log(5))*中对 large_container 进行部分排序，使得前五个元素是 large_container 降序排列的最大元素（或升序排列的最小元素，具体取决于比较函数）。这可能会替换上面代码的重要部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T01:36:21.977

我认为 5 元素数组可能足够小，可以手动处理，通过将最小元素与地图中的每个项目进行比较并相应地调整数组，因此无需调用排序函数。如果需要维护更大的数组，堆可能是更好的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T15:40:32.147

我想到的另一个解决方案是使用 priority_queue，考虑到您正在寻找的是具有更高优先级的元素，这很有意义。

```
 #include <queue>

    int main(){
       priority_queue<int> q;
       int a[] = {7, 12, 11, 19, 88, 42, 3, 1, 22};
       for(int i=0;i<sizeof(a)/sizeof(int);i++){
                q.push(a[i]);
       }
       for(int i=0;i<5;i++){
         cout<<q.top()<<endl;
         q.pop();
       }
       return 0;
    } 
```

请注意，priority_queue 内部实现为堆，pop_heap 以对数时间运行

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-24T01:34:06.597

std::sort 最有可能使用 QuickSort，或者至少是 QuickSort 的一种变体，称为 IntroSort，当递归太深时，它会“退化”为 HeapSort。所以两者都将在 O(nlogn) 时间内运行。因此，您选择哪一个并不重要（如果您自己的快速排序正确实施）。**

# java - 资产未加载到小程序的 jar 文件中

> ID：10290550
> 
> 赞同：0
> 
> 时间：2012-04-24T01:21:57.460
> 
> 标签：java, jar, applet, assets

我有一个带有小程序的 jar 文件。这个小程序运行完美，除了一件事：当我运行小程序时，程序加载但图像没有。我知道这是唯一的错误。jar 中的清单文件指定了我在其中使用的另一个 jar，并且我知道它已正确导入。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:24:28.897

图像在哪里？

-> 如果部署在 jar 中，则需要从类路径中将它们作为资源访问。

就像是，

```
ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
InputStream input = classLoader.getResourceAsStream("/resources/image.jpg");
Image logo = ImageIO.read(input); 
```

小程序通常有限制，它们只能连接到为其提供服务的服务器。

# php - 使用 mootools Request 检索和发送数据

> ID：10290552
> 
> 赞同：1
> 
> 时间：2012-04-24T01:22:21.910
> 
> 标签：php, json, mootools, request

我正在使用 Request 检索带有 moo 的数据并且工作正常，但同时我需要将一些数据发送到我从中获取请求的同一个文件，

工作代码是

```
 var myRequest =  new Request({
          url: 'json.php',
          onComplete: function (response) {
              var jresponse = JSON.decode(response);
              alert(jresponse.count)
          }
      }).get(); 
```

在我的 json.php 我有

```
echo '{"count":5, "times":1}'; 
```

没关系，我会收到有关计数和次数的警报，

但是 json.php 中的代码需要改进，我需要检查存储在标签 data-fileid="123" 中的文件 ID

所以我需要发送 data-fileid="123" 到 json.php 并在给出之前检查条件

```
 echo '{"count":5, "times":1}'; 
```

我试图在我的请求结束时这样做

```
myRequest.send('fileid=' + el.get('data-fileid')); 
```

但我不知道如何检索它，或者它是否被发送到 json.php。

请指教。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:11:08.530

你这样做是对的：当你需要向服务器端的脚本发送数据时，你使用`send`类的方法`Request`。

从[文档](http://mootools.net/docs/core/Request/Request#Request%3asend)中，我们可以分析这个例子：

```
var myRequest = new Request({
    url: 'http://localhost/some_url'
}).send('save=username&name=John'); 
```

当这被执行时，脚本`http://localhost/some_url`——如果是 PHP 像你的——将能够访问变量：

```
$_REQUEST['save']     // with a value of "username"
$_REQUEST['name']     // with a value of "John" 
```

因此，在您的示例中，`json.php`将可以访问该变量：

```
$_REQUEST['fileid'] 
```

* * *

顺便说一句，您是否验证了以下给出的值：

```
el.get('data-fileid') 
```

是对的吗？

# ruby-on-rails - bundle exec rake 路由不起作用

> ID：10290553
> 
> 赞同：0
> 
> 时间：2012-04-24T01:22:23.330
> 
> 标签：ruby-on-rails, ruby, rake, twitter-bootstrap, rake-task

当我运行时`bundle exec rake routes`，它会打印以下消息：

```
法拉第：您可能需要安装 system_timer 以获得可靠的超时
耙中止！
ActionView::Base:Class 的未定义方法 `debug_rjs='

任务：TOP => 路线 => 环境
（通过使用 --trace 运行任务查看完整跟踪）

```

当我安装 gem 时，这开始发生`twitter-bootstrap-rails`

欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T04:33:25.743

评论这一行`config/environments/development.rb` （如果从事开发工作）

```
# config.action_view.debug_rjs             = true 
```

这是因为较新的 rails 版本删除了 debug_rjs，您更新了 rails 但没有更新您的`development.rb`

[https://github.com/rails/rails/commit/d8f23ca627df85b33fe8db87db5483c10b62bfe6](https://github.com/rails/rails/commit/d8f23ca627df85b33fe8db87db5483c10b62bfe6)

将此添加到您的`Gemfile`

```
 gem "system_timer", "~> 1.2.4" 
```

并运行

```
 bundle install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:47:58.063

尝试安装 system_timer gem，然后重试您正在做的事情。

安装 system_timer gem

```
gem install system_timer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T04:25:47.070

我只是卸载了引导程序，一切都恢复了正常 XD

# google-play - 为什么 Google Play 的活跃设备安装量不等于每日总设备安装量减去每日总设备卸载量？

> ID：10290555
> 
> 赞同：12
> 
> 时间：2012-04-24T01:22:30.833
> 
> 标签：google-play

Google Play 统计数据（以前的 Android 市场）上的 Active Device Installs 和总安装量之间的差异很容易通过用户卸载来解释。但是，我希望活动设备安装量等于总设备安装量减去总卸载量。但是看看我的几个应用程序的日常设备安装和卸载情况似乎并非如此。

我所看到的：

1.  转到 Google Play 上的统计信息页面，将应用程序导出为 CSV
2.  在 excel 中打开并创建一个名为 daily_device_installs - daily_device_uninstalls 的列。这应该是每日净安装量。
3.  由于数据发送时间的差异，您可能不会期望此列等于随后几天之间的 active_device_installs 差异。但在很长一段时间内，活跃安装的差异应该接近净安装列的总和。它不是。

在几个月的一个极端情况下，active_device_installs 显示仅增加了 40k，而净安装的总和为 100k。

Google Play 帮助对此没有多大用处：http: [//support.google.com/googleplay/android-developer/bin/answer.py ?hl=en&answer=139628](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=139628)

其他人看到同样的事情吗？我们应该信任哪个统计数据，或者我错过了什么并且它们是一致的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-04T07:11:49.303

我在我的开发者帐户中遇到了同样的问题。30 天内的（每日活跃安装 - 每日活跃卸载）数量是（第 1 天活跃安装 - 第 30 天活跃安装）数量的 3 倍

谷歌播放文档说：

“有关您的应用程序当前安装人口的数据，请参阅“活跃”或“总”指标，而不是试图总结每日指标。每日指标旨在提供有关您的应用程序最近安装的即时反馈。“总”和“活跃”指标将为您提供最准确的图片——它们考虑了应用程序的重新安装、生成每日报告后收到的数据、不再活跃的设备等等。”

但是数字上的 3 倍差异非常大，最重要的是非常令人困惑

有什么其他的经验吗？

# ruby-on-rails - $ bundle exec rake db:reset 命令提升无法删除 db/development.sqlite3

> ID：10290557
> 
> 赞同：20
> 
> 时间：2012-04-24T01:23:04.367
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sqlite, railstutorial.org

我尝试运行`$ bundle exec rake db:reset`并在控制台上找到以下内容

```
Couldn't drop db/development.sqlite3 : #<Errno::EACCES: Permission denied - c:/sample_app/db/development.sqlite3>
db/development.sqlite3 already exists
-- create_table("users", {:force=>true})
   -> 0.3940s
-- add_index("users", ["email"], {:name=>"index_users_on_email", :unique=>true})

   -> 0.1280s
-- initialize_schema_migrations_table()
   -> 0.0010s
-- assume_migrated_upto_version(20120419034627, ["c:/sample_app/db/migrate
"])
   -> 0.0040s 
```

我该如何解决？

**编辑**我正在关注一个教程，它告诉我运行上述命令以安全地从数据库中删除所有数据。而且我也在使用管理员帐户。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-24T04:29:36.620

当你这样做时，[`db:reset`](https://github.com/rails/rails/blob/v3.1.4/activerecord/lib/active_record/railties/databases.rake#L244)它会按顺序运行。您的[错误消息](https://github.com/rails/rails/blob/v3.1.4/activerecord/lib/active_record/railties/databases.rake#L145)表明无法删除。`db:drop``db:setup``db/development.sqlite`

如果您使用的是 Windows，则可能需要停止 Rails 服务器和控制台。否则，找出是什么阻止了文件被删除。可能是权限问题。重新启动也可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-09T01:51:28.683

我知道这是一篇旧帖子，但我刚刚遇到了这个问题（Windows 的 sqlite3 问题继续），并且在重新启动、关闭命令行和停止服务器时不起作用，我确实通过实际运行每个来解决它上面提到的命令 htanta 依次为： 1\. bundle exec rake db:drop 2\. bundle exec rake db:create 3\. bundle exec rake db:migrate

如果 db:reset 无论如何只是这些命令，我​​不明白为什么它不起作用，但个别命令呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-13T20:57:45.387

一直在尝试解决同样的问题。在 Windows 上停止 Rails Server 并没有帮助，但是重新启动整个环境就可以了，bundle exec rake db:reset 完成了，但请确保在此之前不要启动服务器，因为它会调用相同的错误。继续

```
$ bundle exec rake db:reset
$ bundle exec rake db:populate
$ bundle exec rake test:prepare 
```

然后启动 Rails Server。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-09T09:55:26.990

另一个可能的答案是您打开了一个数据库文件。关闭这些文件并停止您的服务器，它应该可以工作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-02-18T06:47:08.173

对于删除整个数据库，只需提供 rake db:setup 它会删除并再次为您创建数据库

# wordpress - WP 高级自定义字段中继器分页

> ID：10290558
> 
> 赞同：1
> 
> 时间：2012-04-24T01:23:19.287
> 
> 标签：wordpress, loops, pagination, repeater

我对 PHP 相当陌生，并且在 Wordpress 中做了很多工作。我安装了 ACF 插件并在正确的参数内自定义了我的循环。我想知道是否有办法在一定数量的条目后进行分页。我尝试对 have_posts 区域使用自定义循环进行分页，但这似乎没有奏效，并且还删除了页面的 Repeater 循环。我还尝试在 ACF 论坛本身及其尚未解决的问题上寻求支持。我觉得这可能是一件容易的事情，但我是新手，并不真正了解将它放入哪个循环（？）。我想在 4 个条目后分页。非常感谢您提前输入！

这是我在 wp 的自定义页面模板上使用的代码

```
<?php if(have_posts() ) : while (have_posts()) : the_post(); ?>

<!--- START LOOP --->   

<?php $columns = get_field( 'events' ); ?>
<?php if($columns): ?>
        <?php foreach( $columns as $column ): ?>
            <div id="event">
            <?php if($column['events_items']): ?>

            <?php foreach($column['events_items'] as $item ): ?>

<div id="presents"><?php echo $item['presented_by']; ?></div>
            <div id="date"><?php echo $item['date']; ?></div>
<div id="location">AT <?php echo $item['venue']; ?></div>
<div id="city"><?php echo $item['city_state']; ?></div>
<div id="flier"><a class="inline" href="#<?php echo $item['id']; ?>"><img src="<?php echo $item['flyer']; ?>" alt="" border="0" /></a></div>
<div id="headliner"><?php echo $item['headliner']; ?></div>
<div id="artist2"><?php echo $item['support1']; ?> - <?php echo $item['support2']; ?><br>
& <?php echo $item['support3']; ?></div>

<div style="display:none"><div id="<?php echo $item['id']; ?>" class="event_popup"><div id="event_detail">
<div id="event_left">
<div id="event_headliner">
<div id="event_headlinername">&nbsp;<?php echo $item['headliner']; ?></div>
<div id="event_headlinerpic"><a href="<?php echo $item['headliner_url']; ?>" target="_blank"><img src="<?php echo $item['headliner_image']; ?>" alt="" border=0/></a></div>
</div>
<div id="event_videobio">
<div id="event_video"><iframe src="http://www.youtube.com/embed/<?php echo $item['video_url']; ?>?rel=0" frameborder="0" width="250" height="200"></iframe></div>
<div id="event_bio"><?php echo $item['headliner_bio']; ?></div>
</div>
</div>
<div id="event_right">

<div id="event_support">
<div id="event_supportname">&nbsp;<?php echo $item['support1']; ?></div>
<div id="event_supportpic"><a href="<?php echo $item['support1_url']; ?>" target="_blank"><img src="<?php echo $item['support1_image']; ?>" alt="" border=0/></a></div>
</div>

<div id="event_support">
<div id="event_supportname">&nbsp;<?php echo $item['support2']; ?></div>
<div id="event_supportpic"><a href="<?php echo $item['support2_url']; ?>" target="_blank"><img src="<?php echo $item['support2_image']; ?>" alt="" border=0/></a></div>
</div>

<div id="event_support">
<div id="event_supportname">&nbsp;<?php echo $item['support3']; ?></div>
<div id="event_supportpic"><a href="<?php echo $item['support3_url']; ?>" target="_blank"><img src="<?php echo $item['support3_image']; ?>" alt="" border=0/></a></div>
</div></div></div>

<div id="event_bottom">sdoifjsoafjdaiosfjdasoifj oosdafja</div>

            </div>
        </div>

            <?php endforeach; ?>
            <?php endif; ?>
            </div>
        <?php endforeach; ?>
<?php endif; ?>

<!--- END LOOP --->

 <?php endwhile; endif;  ?> 
```

# sql - CoffeeScript，寻找类似 SQL 的模块

> ID：10290560
> 
> 赞同：1
> 
> 时间：2012-04-24T01:23:51.093
> 
> 标签：sql, sqlite, node.js, coffeescript

我试图让 CoffeeScript 允许 SQL 语句以及它的正常语法。这需要一个像样的 SQLite/MySQL/SimilarDB 模块添加到 CoffeeScript 以允许我对语法进行更改。有人知道有什么好的模块可以做我需要的吗？

我已经用谷歌搜索了这个并找到了以下（损坏的）解决方案：

[https://github.com/orlandov/node-sqlite](https://github.com/orlandov/node-sqlite)

[https://github.com/grumdrig/node-sqlite](https://github.com/grumdrig/node-sqlite)

[http://coffeescriptcookbook.com/chapters/databases/sqlite](http://coffeescriptcookbook.com/chapters/databases/sqlite)

如果您确实发表评论，请确保您所指的模块有效。有很多旧模块不再适用于最新的 NodeJS 版本。以下 github 项目是我从中分叉并尝试修改的项目。

[https://github.com/jashkenas/coffee-script](https://github.com/jashkenas/coffee-script)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:13:16.563

在无休止的谷歌搜索一些有用的信息之后，遇到了一些正在进行的用于 CoffeeScript 的 SQL 模块项目，如下所示。

[https://github.com/developmentseed/node-sqlite3](https://github.com/developmentseed/node-sqlite3) 包含有效的 SQLite 支持。

[https://github.com/sdepold/sequelize](https://github.com/sdepold/sequelize) 包含有效的 SQLite 和 MySQL 支持。仅适用于以下版本的 NodeJS：0.4.12、0.5.10、0.6.6。

[https://github.com/nearinfinity/node-persist](https://github.com/nearinfinity/node-persist) 包含有效的 SQLite、MySQL、PostgreSQL 和 Oracle 支持。

# c# - 使用 ASP.NET 和 C# 的 MediCare 卡加密

> ID：10290561
> 
> 赞同：1
> 
> 时间：2012-04-24T01:24:09.597
> 
> 标签：c#, asp.net, security, encryption

我正在为一个非营利组织提供免费咨询，他们想要一个简单的系统来管理具有日程组件等的多个组，并管理孩子的医疗信息。它都在一个excel文件上，但这个问题对护士来说不是很方便。所以我正在构建这个 asp.net 应用程序，当它涉及敏感数据的加密时，我碰壁了。我根据本网站的书籍和建议编写了这个 c# 代码。我做得对吗？

```
 using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Web.UI.WebControls;

public partial class SymmetricEncryptionWithPassword : System.Web.UI.Page
{

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Encrypt_OnClick(object sender, EventArgs e)
    {
        // Initialize the algorithm from the values on the page.
        SymmetricAlgorithm symmetricAlgorithm = new AesManaged();

        byte[] generatedKey = null;
        byte[] generatedIV = null;

        TextBox salt = (TextBox)DetailsView1.FindControl("TextBox2");
        TextBox ssn = (TextBox)DetailsView1.FindControl("TextBox1");

        salt.Text = Convert.ToBase64String(GenerateSalt());

        GetKeyAndIVFromPasswordAndSalt(this.password.Text, Convert.FromBase64String(salt.Text), symmetricAlgorithm, ref generatedKey, ref generatedIV);

        symmetricAlgorithm.Key = generatedKey;
        symmetricAlgorithm.IV = generatedIV;

        ICryptoTransform encryptor = symmetricAlgorithm.CreateEncryptor(symmetricAlgorithm.Key, symmetricAlgorithm.IV);

        // Create the streams used for encryption.
        MemoryStream memoryStream = new MemoryStream();
        using (CryptoStream cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write))
        {
            byte[] plainTextAsBytes = new UTF8Encoding(false).GetBytes(ssn.Text);
            cryptoStream.Write(plainTextAsBytes, 0, plainTextAsBytes.Length);
        }

        symmetricAlgorithm.Clear();

        byte[] encryptedData = memoryStream.ToArray();
        ssn.Text = Convert.ToBase64String(encryptedData);

    }

    protected void Decrypt_OnClick(object sender, EventArgs e)
    {
        // Initialize the algorithm from the values on the page.
        SymmetricAlgorithm symmetricAlgorithm = new AesManaged();

        byte[] generatedKey = null;
        byte[] generatedIV = null;

        TextBox txt = (TextBox)DetailsView1.FindControl("TextBox2");
        TextBox txt1 = (TextBox)DetailsView1.FindControl("TextBox1");
        GetKeyAndIVFromPasswordAndSalt(this.password.Text, Convert.FromBase64String(txt.Text), symmetricAlgorithm, ref generatedKey, ref generatedIV);

        symmetricAlgorithm.Key = generatedKey;
        symmetricAlgorithm.IV = generatedIV;

        ICryptoTransform decryptor = symmetricAlgorithm.CreateDecryptor(symmetricAlgorithm.Key, symmetricAlgorithm.IV);

        // Create the streams used for encryption.
        MemoryStream memoryStream = new MemoryStream();
        using (CryptoStream cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Write))
        {
            byte[] encryptedDataAsBytes = Convert.FromBase64String(txt1.Text);
            cryptoStream.Write(encryptedDataAsBytes, 0, encryptedDataAsBytes.Length);
        }

        symmetricAlgorithm.Clear();

        byte[] decryptedData = memoryStream.ToArray();

        txt1.Text = Encoding.UTF8.GetString(decryptedData);

               }

    private static byte[] GenerateSalt()
    {
        const int MinSaltSize = 8;
        const int MaxSaltSize = 16;

        // Generate a random number to determine the salt size.
        Random random = new Random();
        int saltSize = random.Next(MinSaltSize, MaxSaltSize);

        // Allocate a byte array, to hold the salt.
        byte[] saltBytes = new byte[saltSize];

        // Initialize the cryptographically secure random number generator.
        RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();

        // Fill the salt with cryptographically strong byte values.
        rng.GetNonZeroBytes(saltBytes);

        return saltBytes;
    }

    private static void GetKeyAndIVFromPasswordAndSalt(string password, byte[] salt, SymmetricAlgorithm symmetricAlgorithm, ref byte[] key, ref byte[] iv)
    {
        Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(password, salt);
        key = rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.KeySize / 8);
        iv = rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.BlockSize / 8);
    }
}
} 
```

该代码有效，当我输入数据时，它在数据库中加密，并且正确的 Salt 与值一起存储。例如，当我希望它在文本框中解密时，它可以正常工作。

我的想法是：护士在表格中输入数据，她用密码对其进行加密，服务器生成加密的医疗保险号码和盐值，然后发送到 SQL 服务器，医疗保险在看起来像这样的表中加密.

Medicare_ID - int（主键）
Medicar_Number - (varchar(MAX))
Medicare_SALT - (varchar(MAX))

解密密码没有存储在数据库中，我是故意这样做的。

**我只是不确定我是否遵循这里的最佳实践，如果物理服务器被盗，我的信息是否可以轻松解密？他们仍然需要密码才能解密数据吗？我们有时需要在紧急情况下对其进行解密。我的解密方法安全吗？**另一个问题是我使用 1and1 共​​享虚拟主机。

我已经设置了一些更多的安全措施，例如将在网站上激活 SSL，以便对信息进行加密并防止掉眼。

我将确保对连接字符串和输入进行清理以防万一，但理论上只有 1-2 名经理或护士会操纵数据。

网站访问受到用户名密码的保护，该用户名密码带有我从 Visual Studio 2010 借来的登录控件。

感谢您抽时间阅读

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:24:50.273

要回答主要问题：

> 我只是不确定我是否遵循这里的最佳实践，如果物理服务器被盗，我的信息是否可以轻松解密？

关于被盗服务器：无论你做什么，你都会被盗用。没有已知的安全措施可以完美防止被盗硬件。即使是笔记本电脑中的加密硬盘驱动器也可能被破坏，有时比提供加密服务的公司所相信的要快。哪一个，如果他们已经走上了物理获取硬件的路线，那么他们将做两件事之一：擦除它并转售零件或破解数据。在道德上（有时是合法的），无论最终发生什么，您都应该通知所有客户他们的数据被盗。

我想重点是：加密并不意味着坏人*不能*窃取数据。它只是意味着它需要一段时间。你加密东西来赢得时间。换锁的时间，通知客户的时间，*更改*密码的时间；并且，在处理 SSN 和其他有价值的数据时，是时候锁定信用账户了。

> 他们仍然需要密码才能解密数据吗？

不必要。没关系，您必须将密码存储在*某个地方*。如果他们窃取了您的数据库服务器，那么他们很可能也带走了 Web 服务器（这将具有凭据）。

> 我们有时需要在紧急情况下对其进行解密。

关于“紧急”解密：有两种处理方法。要么将该密码的副本存储在您可以访问的地方，要么破解它。

> 我的解密方法安全吗？

我会称你的方法是浪费时间。有关更多信息，请参见下文。

* * *

此时，您应该了解对机器的物理访问等同于对其数据的完全访问。因此，除非您认为您已将其存放在一个真正安全且配备武装警卫的位置，否则您无能为力。典型的数据中心安全性（例如亚马逊云）通常足够好。然而，对于政府数据，一些公司（同样是亚马逊）拥有专门的服务器，专门用于保存您认为需要额外安全性的数据。我怀疑 1 和 1 托管会这样做。

那么，让我们看看有哪些更好的选择。因为你提到了 varchar(max) 我假设你有一个 MS SQL Server。SQL Server 为数据库内置了加密功能。打开这个。如果有人获得了数据库文件的副本（不是服务器，只是文件），那么他们将不得不破解 SQL 的加密来获取数据。我向您保证，您无能为力，而且您不必过多担心密钥管理。这将处理您的“静态数据”。您当然可以再次对其进行加密，但我建议阅读 MS SQL Server 内置的安全性会更好地利用您的时间。

对于“动态数据”，您应该为 Web 服务器和数据库服务器之间的通信打开 kerberos。（即：不要相信有人没有尝试监听网络和数据库服务器之间的连接。也不要相信路由器配置正确。他们很少这样做。）阅读如何正确配置配置您的 AD 环境。您还应该为 Web 服务器和客户端桌面之间的通信打开 SSL。

超越加密，您需要关注两个主要问题。首先是网站对数据库的访问级别。该用户帐户是否基本上具有 SA 级别的权限？如果是这样，你做错了。站点使用的帐户应极其限于仅执行那些绝对必要的项目。换句话说，它不应该允许某人删除或更改表，甚至不应该对他们不应该访问的数据进行全选。这是绝大多数 Web 应用程序失败的地方。程序员认为，唯一能直接进入他们的数据库的就是网络应用程序。现实情况是，将页面等注入现有应用程序有时太容易了。作为旁注，这是我对大多数 ORM、EF 和 L2S 的主要关注。他们需要太多的访问权限。

我过去常说在网络配置中加密你的连接字符串，但这通常是浪费时间。毕竟，如果他们可以阅读 web.config，那么他们就有足够的访问权限让应用程序吐出它的未加密内容。这使我们回到了网站对数据库的访问级别。坚信除非被证明是无辜的，否则每个人都是有罪的，这是最好的政策。

如果出于某种原因，Web 服务器和数据库服务器在同一个物理机器上：更改此设置。这是一个坏主意，一旦网站被破解，获得对数据库服务器的 sa 级别访问就变得微不足道了（由于大多数网站的构建方式）。

接下来，打开日志记录。在数据库中，您应该*至少*记录登录失败和成功。在网站上，记录所有内容。另外，关闭从外部对数据库服务器的直接访问。在此期间，继续切换数据库服务器以使用非标准端口（即：非 1433/2433）进行通信。确保数据库服务器防火墙已正确配置为仅允许来自该网络服务器的连接。

用细齿梳检查您的代码。阅读[OWASP](https://www.owasp.org/index.php/Main_Page)。清理您的输入。所有这些。确保所有数据库查询都传递参数并且您没有动态构造任何东西。禁用 SA 帐户。

这有点长；但我希望它具有教育意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:59:32.267

这是如何使用 RijndaelManaged CryptoServiceProvider 加密和解密敏感信息的一个很好的例子。

[Rijndael托管加密](https://stackoverflow.com/questions/9980884/rijndaelmanaged-can-not-decrypt/9983319#9983319)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T05:36:56.763

我不知道确切的答案，但我可以与您分享一些关于如何保护系统的想法。现在任何现有的加密都将在未来被破解。这不是是否的问题，而是何时的问题。话虽如此，您可能想问自己以下问题：

*   您希望数据安全多长时间？如果您要存储持续 10 年或更短时间的信息，AES-128 就足够了。但如果您将它们存储超过 20 年，请考虑至少使用 AES-256。

*   如果坏人破解了密码，他们会得到什么？除了加密之外，您还可以使用“隐匿安全”来添加额外的挂锁，例如将加密的字符串/信息保存在两个或多个位置。

*   从内部保障。您的用户的安全意识如何？他们是否将密码存储在键盘下、共享登录信息或在屏幕未锁定时走开。如果其中任何一项是肯定的，您可能需要对 UI 设计进行一些思考。链条的强度取决于其最薄弱的环节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T06:33:36.090

*   **共享主机**：检查政府要求，我不在医疗保健领域，但如果没有管理敏感个人信息存储的规则/法律，我会感到非常惊讶。如果信用卡/电子商务有 PCI DSS 要求，我认为医疗保健数据将至少具有相同级别（可能更严格）的数据保护规则（例如[**HIPAA**](http://www.hhs.gov/ocr/privacy/hipaa/understanding/index.html)？）

*   我对 1&1 了解不多，但“在哪里”也可能是一个问题（？） -**服务器**（1&1）的物理位置在哪里？

*   还有一个想法：不要让用户生成 salt/pwd（它们应该多长时间/安全？）也许看看[SQL server 加密选项](http://technet.microsoft.com/en-us/library/bb510663%28v=sql.100%29.aspx)，将工作转移到 SQL 而不是用户和/或代码。

*   决定数据是否应该加密或散列（存储/检索与查找） - 重新：密码 = 散列，SSN - 取决于我猜的用法。[哈希也可以在 SQL Server 中完成](http://technet.microsoft.com/en-us/library/ms174415%28v=sql.100%29.aspx)....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T21:32:48.870

此功能是一个不好的做法，IV 需要是随机的以确保安全，相同的 IV 不应该用于相同的密钥。这总是为给定的密钥提供相同的 IV，使其不安全：

```
private static void GetKeyAndIVFromPasswordAndSalt(string password, byte[] salt, SymmetricAlgorithm symmetricAlgorithm, ref byte[] key, ref byte[] iv)
{
    Rfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(password, salt);
    key = rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.KeySize / 8);
    iv = rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.BlockSize / 8);
} 
```

# iphone - iPhone UIStoryBoard 是否可以以编程方式创建具有在情节提要中定义的接口的控制器？

> ID：10290563
> 
> 赞同：3
> 
> 时间：2012-04-24T01:24:20.923
> 
> 标签：iphone, ios5, uiviewcontroller, uistoryboard

我在 UIStoryBoard 中定义了一堆视图控制器。我喜欢将它们都放在一个地方以便于访问。但是，我遇到了一个问题，我需要在应用程序的其他位置实例化视图控制器的副本。**是否可以使用故事板中定义的接口以编程方式创建 UIViewController？**

否则，我将不得不将该控制器的情节提要视图复制到单独的 .xib 文件中并手动加载视图。

谢谢你的澄清！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:32:10.250

是的，而且一点也不坏！ `-instantiateInitialViewController`就是你要找的。

我倾向于使用的助手是：

```
- (void) loadStoryboard:(NSString *)storyboardName animated:(BOOL)animated
{
  if ([_currentStoryboard isEqual:storyboardName])
  {
    return;
  }

  _currentStoryboard = storyboardName;

  UIStoryboard* storyboard = [UIStoryboard storyboardWithName:storyboardName bundle:nil];
  UIViewController* newRootController = [storyboard instantiateInitialViewController];

  if (!animated)
  {
    self.window.rootViewController = rootController;
    return;
  }

  newRootController.view.alpha = 0.0;
  [self.window addSubview:newRootController.view];

  [UIView animateWithDuration:0.5 animations:^{
    newRootController.view.alpha = 1.0;
  } completion:^(BOOL finished) {
    self.window.rootViewController = newRootController;
  }];
} 
```

这个变体是为你的垃圾场设置的`AppDelegate`——不过，应该很容易适应大多数情况。

# mysql - Django中不同类型图片的数据库设计

> ID：10290569
> 
> 赞同：1
> 
> 时间：2012-04-24T01:25:13.450
> 
> 标签：mysql, django, database-design, django-models, django-contenttypes

下午好，

我正在设计一个应用程序，但我似乎无法解决这个问题。我的应用程序将有不同类型的图片：公司、个人资料、机器等……我们期待有很多图片。现在，由于我们将有很多不同类型的图片，我正在考虑在 Django 中创建一个名为“图片”的基类，然后从中创建所有子类。这将在我的数据库中提供 n 个表。因此查询会更快，因为我不会有一个包含所有图片的巨型表，并且当我想要某种类型的图片时必须在类别表上执行 JOINS。

为此，我将不得不在 Django 中使用通用外键。这是好习惯吗？我的设计是不是一个好的实践？有人告诉我通用外键不是一个好主意……为什么？

谢谢！

编辑：我不会将图像本身存储在表中，只是 AWS S3 存储桶中的路径！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:28:05.400

您确定要并且需要将图像存储在数据库中吗？在许多情况下，您可以通过将图像存储在文件系统而不是数据库上来显着提高效率。

## 将图像存储在数据库之外

当您将图像存储在文件系统上时，您可以直接从您的网络服务器或云主机（如 Amazon S3 或内容分发网络或 memcached 等）提供它们。

## 元数据

在您自己的数据库中，要存储的好信息（恕我直言）是有关图像的元数据，例如可搜索的文件名（如果您的用户将使用这种方式进行搜索）、像素尺寸（如果您想按大小搜索或提供图像的高度和宽度）在您的 HTML 中）、mime 内容类型（如果这对您有用）等。

对于您对不同类型图片的描述，取决于您要存储的每种类型的不同信息类型。

## sti 还是多个表？

你的图像种类基本相同吗？[按种类，我的意思是像 Company、Profile、Machine 等。] 如果是这样，我会为所有这些（即元数据）使用一个带有枚举类型字段的表。根据您的数据库，您可以使用字符串名称（例如“company”、“profile”等）或使用 int 常量（例如 1 代表公司、2 代表个人资料等）来执行此操作。Django 有几种继承方式. 其模式名称是单表继承 (STI)。我相信 Django 并不完全支持这一点，但是如果您搜索它，您将获得正确的实现方法。

你的图像种类有本质上的不同吗？如果您的各种图像具有非常不同类型的数据，那么可以，使用单独的表。

据我所知，使用一个带有索引的表与使用单独的表之间的速度差异应该是相似的，因为在这两种情况下，每个请求基本上都有一个查找来找出图像行的范围。您可以确定基准。

## 干草堆的教训

在您编写一些代码之前，请阅读 Facebook 是如何实现这一点的——这是一个很好的概述。

[http://www.facebook.com/note.php?note_id=76191543919](http://www.facebook.com/note.php?note_id=76191543919)

# php - Zend 框架中的新控制器上的 404

> ID：10290570
> 
> 赞同：0
> 
> 时间：2012-04-24T01:25:15.477
> 
> 标签：php, zend-framework

我使用创建了一个新控制器

```
zf Create Controller About 
```

但是当我尝试导航到路径时（http://mysite.com/about）我得到一个 404。下面是详细信息

站点设置在 C:\apache\htdocs\mysite.com\public

我已经修改了 vhosts 文件（C:\apache\conf\extra\httpd-vhosts.conf）来添加虚拟主机，比如

```
<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.localhost
    DocumentRoot "C:/apache/htdocs/mysite.com/public"
    ServerName mysite.com
    ServerAlias mysite.com
    ErrorLog "logs/mysite-error.log"
    CustomLog "logs/mysite-access.log" common
</VirtualHost> 
```

还添加了到 Windows 主机文件的映射，例如 127.0.0.1 mysite.com

这是我来自公共文件夹的 .htaccess 文件

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

我可以访问[http://mysite.com](http://mysite.com)，但是当我尝试访问[http://mysite.com/about](http://mysite.com/about)时，我得到了 404。

在我的 httpd.conf 我有以下

```
<Directory />
Options FollowSymLinks
AllowOverride All
Order deny,allow
Deny from all
</Directory>

<Directory "C:/apache/htdocs">
    Options Indexes FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
</Directory> 
```

我缺少什么来完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:43:44.800

感谢您发布如此详细的配置信息。

您需要更改`AllowOverride None`为块`AllowOverride All`内`<Directory "C:/apache/htdocs">`。

当 AllowOverride 为 时`None`，这意味着 .htaccess 文件未被处理，因此您的 URL 重写到 Zend 应用程序的前端控制器不会发生。

另请参阅：[如何在 zend 框架中配置 htaccess](https://stackoverflow.com/questions/10260795/how-to-configure-htaccess-in-zend-framework/10264503#10264503)

# ruby - 没有 ORM 的 MongoDB Ruby 边界查询

> ID：10290571
> 
> 赞同：0
> 
> 时间：2012-04-24T01:25:33.747
> 
> 标签：ruby, mongodb, geospatial

我试图弄清楚如何使用没有像 Mongoid 或 MongoMapper 这样的 ORM 包装器的 ruby​​ 驱动程序向 mongodb 发出边界框地理查询。

我可以执行附近的命令没问题，但我似乎无法弄清楚 find with a inside 的语法。

所以如果我想在半径范围内查询，这就像一个魅力

```
conn = Mongo::Connection.from_uri('my DB')
  db = conn.db('my_sites')
  coll = db.command({'geoNear' => "sites",
             'near'=>[lng,lat],
             'spherical' => true,
             'maxDistance' => distance_in_radians,
             'num' => limit})
  render :json => coll['results'].to_a 
```

但是我很难获得正确的查询：

```
box = [[34.05,-118.24],[35.80,116.44]]
coll = db.command({'within' => "sites", 'box' => box} 
```

或者

```
db['my_sites']
coll = db.find({"box" => box}) 
```

我可以直接在 mongo 客户端中发出查询，但我只是在理解 ruby​​ 驱动程序语法时被绊倒了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:56:55.837

AFAIK，MongoDB shell 版本看起来像这样：

```
db.my_sites.find(loc: { $within: { $box: box } }) 
```

低级 Ruby 接口通常反映 JavaScript 接口，所以我认为你想要：

```
db['my_sites'].find(:loc => { :$within => { :$box => box } }) 
```

我手边没有地理就绪的集合，所以我无法对其进行测试以确保。

# opencl - OpenCL 内核语言：使用不带花括号的 if 语句时可能出现的错误

> ID：10290573
> 
> 赞同：1
> 
> 时间：2012-04-24T01:25:45.160
> 
> 标签：opencl

这是opencl内核代码。这不起作用：

```
__kernel void testKernel(__global const int* srcA, 
                        __global const int* srcB, 
                        __global int* res, 
                        const int num)
{
        const int idx = get_global_id(0);

        if (idx < num)
            res[idx] = srcA[idx] * srcB[idx];
} 
```

上面代码的日志是“:12:2: error: expected identifier or '(' } ^"

但是，如果您包含大括号，那么它可以工作。这是工作代码：

```
__kernel void testKernel(__global const int* srcA, 
                        __global const int* srcB, 
                        __global int* res, 
                        const int num)
{
        const int idx = get_global_id(0);

        if (idx < num)
        {
            res[idx] = srcA[idx] * srcB[idx];
        }
} 
```

我了解 opencl 内核语言遵循 C99，但如果我正确理解 C99，则仅当 if 语句下有多行代码时才需要大括号。有谁知道我为什么会收到这些错误？

更新：重写 if 语句后，错误不再出现。我无法重现该错误。

更新：错误再次出现，但如果我使用空格键而不是制表符来缩进 if 语句下方的一行代码，它会再次消失

更新：重写后，现在可以编译内核了。这不是标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T14:25:36.177

如果您正在从文件中读取内核，请确保在存储它的数组的末尾添加一个 '\0' 字符，否则编译器会变得混乱并看起来以不确定的方式运行。

添加括号和空格通常会使内核工作，但这不是问题的根源。

我知道这是一篇旧帖子，但请对其进行测试，因为在这个问题上，interwebz 周围有多个未答复的论坛帖子。

# javascript - 带有 .load 的 jQuery .html 函数

> ID：10290578
> 
> 赞同：1
> 
> 时间：2012-04-24T01:26:20.783
> 
> 标签：javascript, jquery, css, html

我正在使用 jQuery 的`.html()`函数加载 HTML 内容。我尝试加载的部分 HTML 内容是图像，需要一些时间才能加载。我所做的是 onclick 事件，

```
$('div').on('click',function() {
    $('html').fadeOut(1000)
        .html(content)
        .load(function() {
            $('html').fadeIn(1000)
        });
}); 
```

我想要发生的是，当 DOM 完成加载时，我希望它淡入。如果它还没有完成，我希望它保持隐藏，因此在 html 加载之前的 fadeOut 函数。

这可能吗？这种方法似乎对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:50:59.880

首先，如果您要替换整个 HTML 元素，您不妨执行一个完整的请求周期。这基本上就是您最终要得到的结果，使用完整请求挂接到窗口加载事件比使用 AJAX 处理更容易。如果您没有替换整个页面，那么您的选择器错误。

其次，如果您只是加载 DIV，那么您可以尝试隐藏 DIV，将加载事件绑定到它，然后将其与内容一起加载。[有关更多信息，请参阅http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)方法的注意事项。

```
$('div').on('click',function() {
    var $this = $(this); // save reference for future use
    $this.fadeOut(1000) // hide
         .load(function() { // hook up handler
             $this.fadeIn(1000)
         })
         .html(content);  // load content
}); 
```

# algorithm - 如何根据另一个数组对数组进行排序？

> ID：10290580
> 
> 赞同：1
> 
> 时间：2012-04-24T01:26:27.950
> 
> 标签：algorithm

假设A={1,2,3,4}，p={36,3,97,19}，使用p作为排序键对A进行排序。你可以得到{2,4,1,3}。

这是《算法导论》一书中的一个例子。它说它可以在nlogn中完成。

谁能给我一些关于如何完成的想法？我的想法是您需要跟踪 p 中的每个元素以找到它的结束位置，例如 p[1] 结束于 p[3] 然后 A[1] 结束于 A[3]。任何人都可以使用合并排序或其他 nlogn 排序来完成这项工作吗？

我是算法新手，发现它有点吓人:(感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:33:12.550

构造一个索引数组：

`i = { 0, 1, 2, 3 }`

现在，在您进行排序`p`时，对索引数组进行相同的更改`i`。

完成后，您将拥有：

`i = { 1, 3, 0, 2 }`

对两个数组进行排序最多需要对一个数组进行排序的时间的两倍（实际上，如果您只计算比较，则无需进行任何额外的比较，只需在两个数组中交换数据而不是一个），所以这不会改变整体排序的 Big-O 复杂度，因为`O( 2n log n ) = O(n log n)`.

现在，您可以使用这些索引`A`在线性时间内构造排序数组，方法是简单地遍历排序索引数组并查找`A`该索引处的元素。这需要`O( n )`时间。

整个算法的运行时复杂度是最坏的：`O( n + 2n log n ) = O( n log n )`

当然，您也可以完全跳过索引数组，并`A`以相同的方式简单地处理数组，将其沿边排序`p`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:33:53.913

我认为这并不困难，因为排序算法的*复杂性*通常是根据所需的比较次数来衡量的，您只需要`A`根据`B`. 除了已经需要排序的比较之外，您不需要进行任何比较，`B`因此复杂性是相同的。

每次移动元素时，只需在两个数组中移动它即可。

# html - 如何制作一个填满整个页面的表格

> ID：10290586
> 
> 赞同：-2
> 
> 时间：2012-04-24T01:27:17.427
> 
> 标签：html, css

我想创建一个流体布局，如下所示，填充整个页面（宽度：100%；高度：100%）。

```
+----+----+----+----+
|    |    |    |    |
+----+----+----|    |
|    |    |    |    |
+----+----+----|    |
|    |    |    |    |
+----+----+----+----+ 
```

在每个单元格内部，我希望有一个 div 宽度的圆形边框，并希望在单元格之间有单元格间距。每个单元格都需要固定大小（溢出：隐藏）。

关于最好的方法的任何想法？

（更新）

我试过做一个表格，但无法控制行和/或单元格的高度不成比例地增长，即使其中的 td 和 div 具有固定的百分比高度并且隐藏了溢出。

我也尝试过 9 个 div 向左浮动和 1 个 div 向右浮动。如果没有设置边距或填充，则效果很好。一旦设置了填充和边距（以百分比表示）并补偿宽度和高度（也以百分比表示）。一切似乎都没有对齐。

我应该继续进一步发展这两个中的哪一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:18:34.720

```
<style>
    html, body, table { width:100%; height:100%; }
    td { width:25%; height:33%; }
    div.round { width:100%; height:100%; background:blue; border-radius:5px; overflow:hidden; }
</style>

<table>
    <tr>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
        <td rowspan="3"><div class="round"></div></td>
    </tr>
    <tr>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
    </tr>
    <tr>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
        <td><div class="round"></div></td>
    </tr>
</table> 
```

# matlab - 将参数传递给内部函数 Matlab

> ID：10290587
> 
> 赞同：1
> 
> 时间：2012-04-24T01:27:20.150
> 
> 标签：matlab

所以我正在尝试为三重积分编写一个函数，该函数最终取决于变量 q ，它是积分的最终限制，还有一个变量 b ，它有助于函数参数化。但是，此代码不起作用，我不完全确定该怎么做。我认为它可能涉及将 b 的值传递给嵌套函数，但我在 matlab 上很新，任何帮助表示赞赏。

```
function [r] = test1(q,u)
b = u;
r = quad(@(k)Inner(k),-0.5.*(1-b)-b-1,q);

function [w] = Inner(k)
w = zeros(1);
for i = 1 : length(k);
    w(i) = quad(@(n)InnerIntegral(n,b).*unifpdf(k(i)-n,-1,1),0,k(i)-1,k(i)+1);
end;

function [y] = InnerIntegral(n)
y = zeros(1);
for i = 1 : length(n);
    y(i) = quad(@(m)unifpdf(n(i)-m, -b, b).*unifpdf(m,-0.5.*b,0.5.*b), n(i)-b,n(i)+b);
end;
end
end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:58:44.737

查看编辑器右侧的橙色小刻度线。在我的副本中，将鼠标悬停在一个上面会说“外部循环索引 'i' 设置在子函数中。”

我不知道这个函数的输入或预期输出应该是什么，但你应该尽量避免混淆 MATLAB。它有奇怪的范围规则。在第二个嵌套函数中使用不同的变量，也许`j`代替`i`.

# arrays - Excel VBA中的数组函数

> ID：10290591
> 
> 赞同：8
> 
> 时间：2012-04-24T01:27:40.110
> 
> 标签：arrays, excel, vba, user-defined-functions

我在 VBA 中有一个生成字符串数组的函数。从另一个 VBA 函数调用时它工作正常，但从工作表调用时却不行。

以下是它应该如何使用：

*   选择 A1:A3
*   写在公式栏中`=Test()`，然后点击`Ctrl-Shift-Enter`使其成为数组函数
*   A1 应该包含`A`， A2 应该包含`B`， A3 应该包含`C`

当我实际尝试这个时，它会放入`A`数组的所有三个单元格。如何将返回的数据`Test`放入数组的不同单元格中？

* * *

对于那些想看到它的人，这里是函数的代码。请记住，从其他函数调用该函数时可以正常工作。

```
Function Test() As String()
    Dim a(1 To 3) As String
    a(1) = "A"
    a(2) = "B"
    a(3) = "C"
    Test = a
End Function 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T01:57:01.970

如果您转置数据，您的功能可以正常工作。为此，您需要`Variant()`代替`String()`：

```
Function Test() As Variant()
    Dim a(1 To 3) As Variant
    a(1) = "A"
    a(2) = "B"
    a(3) = "C"
    Test = Application.Transpose(a)
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T02:00:07.927

您可能想查看[Chip Pearson 关于从 UDF 返回数组的建议](http://www.cpearson.com/excel/ReturningArraysFromVBA.aspx "从 VBA 用户定义函数返回数组")。

这是我在这里的第一反应。我希望这不是不合适的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T07:33:01.007

我发现总是使用二维数组最简单，然后你不需要转置等

```
Function Test() As String()
    Dim a(1 To 3, 1) As String
    a(1, 1) = "A"
    a(2, 1) = "B"
    a(3, 1) = "C"
    Test = a
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T01:57:00.923

刚刚发现了问题——从 VBA 到 Excel 的数组的第一个维度是**水平**的，而不是垂直的。要查看 的输出`Test`，请将数组函数`=Test()`放在**A1:C1**（不是 A1:A3）中。

# ios - 如何让 XCode 4.2 识别自定义属性列表结构定义？

> ID：10290592
> 
> 赞同：2
> 
> 时间：2012-04-24T01:27:43.707
> 
> 标签：ios, xcode, plist, structure, definition

我已经下载并安装了 PlistEdit Pro 来帮助创建自定义属性列表结构定义文件，这样我就可以预定义一个可能的下拉选择列表，以使编辑 plist 的人更容易，也不容易出错。

我已经成功地制作了一个结构定义文件，但目前，我可以使用 def 文件编辑 plist 的唯一方法是通过 PlistEdit Pro。

有没有办法让 Xcode 识别 def 文件，以便我可以通过 XCode 使用我的自定义下拉菜单编辑 plist？（类似于 XCode 如何识别 info.plist xcodeplugin 定义文件）

我已将文件放在整个 Mac 上的许多不同的插件文件夹下，但似乎没有一个可以工作：

/Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/Plug-ins

/Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/PrivatePlugIns

~/Library/Application Support/Developer/Shared/Xcode/Plug-ins

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T21:43:45.930

经过一番挖掘，我找到了一个与 XCode 4.5.x 兼容的好答案。PListEdit Pro 功能存在双重问题：插件目录已更改，插件文件格式已更改。值得庆幸的是，github 和 AliSoftware 提供了帮助：

[https://github.com/AliSoftware/xcodeplugin](https://github.com/AliSoftware/xcodeplugin)

这是一个从 .xcodeplugin 到 .dvtplugin（新格式）的 xslt 转换实用程序。所以基本上你可以在 PListEdit Pro 中创作你的属性列表定义并保存到 .xcodeplugin，然后运行 ​​xcpc 来转换和安装插件。

请注意，PListEdit Pro 添加的至少一两个不兼容的扩展会破坏 xcpc - 但基本功能很好。

另一个注意事项：xcodeplugin 的文档忽略了如何将属性列表类型与文件格式相关联。PListEdit Pro 似乎不支持这样做，但您可以手动将以下内容添加到您的 .xcodeplugin：

```
<plugin ...>
  <extension ...>
    <filename pattern="*cases.plist" />
    ... 
```

# android - ItemizedOverlays Android地图不起作用

> ID：10290596
> 
> 赞同：0
> 
> 时间：2012-04-24T01:28:37.377
> 
> 标签：android, itemizedoverlay

我正在尝试在地图视图上添加多个标记，但我无法使其工作，
当我评论调用 LoadMarkers() 的方法时，它似乎甚至没有加载地图视图。你能告诉我我的代码有什么问题吗？

```
public class MyATMLocatorActivity extends MapActivity {
    /** Called when the activity is first created. */

    private MapView mapView;
    private MapController myMapController;
    private GeoPoint myGeoPoint;
    private LocationManager myLocationManager;
    private LocationListener myLocationListener;

    public static Context context;
    private MyItemizedOverlay myItemizedOverlay = null;
    private MyLocationOverlay myLocationOverlay = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        context = getApplicationContext();
        setContentView(R.layout.main);

        mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);

        myMapController = mapView.getController();

        this.LoadMarkers();

    } 
```

这是加载标记的方法..

```
private void LoadMArkers() {

        mapView.getOverlays().clear();
        mapView.postInvalidate();

        OverlayItem overlayItem = null;

        Drawable myATMPic = getResources().getDrawable(R.drawable.atmicon);
        myATMPic.setBounds(0, 0, myATMPic.getIntrinsicWidth(), myATMPic.getIntrinsicHeight());

        // Super España
        myItemizedOverlay = new MyItemizedOverlay(myATMPic);
        myGeoPoint = new GeoPoint((int) (-25.353043), (int) (-57.444495));
        overlayItem = new OverlayItem(myGeoPoint, "Supermercado Espana","Capiatá");
        myItemizedOverlay.addOverlay(overlayItem);
        mapView.getOverlays().add(myItemizedOverlay);

        // Martín Ledesma
        myItemizedOverlay = new MyItemizedOverlay(myATMPic);
        myGeoPoint = new GeoPoint((int) (-25.353974), (int) (-57.445214));
        overlayItem = new OverlayItem(myGeoPoint, "Martín Ledesma", "Capiatá");
        myItemizedOverlay.addOverlay(overlayItem);
        mapView.getOverlays().add(myItemizedOverlay);               

        mapView.postInvalidate();
    } 
```

这是我的 ItemizedOverlay() 类

```
public class MyItemizedOverlay extends com.google.android.maps.ItemizedOverlay<OverlayItem> {

    private Context mContext;   
    private ArrayList<OverlayItem> myOverlaysArray = new ArrayList<OverlayItem>();;

    private GeoPoint geoPoint = null;

    public MyItemizedOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));        
    }

     public MyItemizedOverlay(Drawable defaultMarker, Context context) {
         super(boundCenterBottom(defaultMarker));
         mContext = context;
   }

    public void addOverlay(OverlayItem overlay) {
        myOverlaysArray.add(overlay);
        populate();
    }

    @Override
    protected OverlayItem createItem(int i) {
        return myOverlaysArray.get(i);
    }

    // Removes overlay item i
    public void removeItem(int i) {
        myOverlaysArray.remove(i);
        populate();
    }

    // Returns present number of items in list
    @Override
    public int size() {
        return myOverlaysArray.size();
    }

    public void addOverlayItem(OverlayItem overlayItem) {
        myOverlaysArray.add(overlayItem);
        populate();
    }

    public void addOverlayItem(int lat, int lon, String title) {
        try {
            geoPoint = new GeoPoint(lat, lon);
            OverlayItem overlayItem = new OverlayItem(geoPoint, title, null);
            addOverlayItem(overlayItem);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    protected boolean onTap(int index) {
        OverlayItem item = myOverlaysArray.get(index);
        AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);
        dialog.setTitle(item.getTitle());
        dialog.setMessage(item.getSnippet());
        dialog.show();
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:44:26.840

您是否在 android manifest.xml 中添加了正确的代码？使用 MapView 将 com.google.android.maps 作为子元素添加到应用程序元素。

```
<uses-library android:name="com.google.android.maps" /> 
```

将 INTERNET 作为子元素添加到该元素。

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

您不需要创建 2 个逐项叠加。此外，您需要将所有 GPS 坐标乘以 1e6，然后再将它们转换为整数。在您之前的代码中，两个 GPS 坐标都将转换为相同的整数对值，并且标记将放置在地图上的同一位置（-25，-57），只有最后一个是可触摸的。另外，不要忘记将应用程序的上下文传递给逐项叠加。

MyATMLocatorActivity.java

```
package maps.test;

import java.util.List;

import android.content.Context;
import android.graphics.drawable.Drawable;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class MyATMLocatorActivity extends MapActivity {
    /** Called when the activity is first created. */

    private MapView mapView;
    private MapController myMapController;
    private GeoPoint myGeoPoint;
    private GeoPoint myGeoPoint2;
    private LocationManager myLocationManager;
    private LocationListener myLocationListener;

    public static Context context;
    private MyItemizedOverlay myItemizedOverlay = null;
    private final MyLocationOverlay myLocationOverlay = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        context = getApplicationContext();
        setContentView(R.layout.main);

        mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);

        myMapController = mapView.getController();

        this.LoadMarkers();

    }

    private void LoadMarkers() {

        List<Overlay> overlays = mapView.getOverlays();
        mapView.postInvalidate();

        OverlayItem overlayItem = null;

        Drawable myATMPic = getResources().getDrawable(R.drawable.ic_launcher);
        myATMPic.setBounds(0, 0, myATMPic.getIntrinsicWidth(), myATMPic.getIntrinsicHeight());
        myItemizedOverlay = new MyItemizedOverlay(myATMPic, this);

        // Super España
        myGeoPoint = new GeoPoint((int) (-25.353043*1e6), (int) (-57.444495*1e6));
        overlayItem = new OverlayItem(myGeoPoint, "Supermercado Espana","Capiatá");
        myItemizedOverlay.addOverlay(overlayItem);

        // Martín Ledesma
        myGeoPoint = new GeoPoint((int) (25.353974*1e6), (int) (-57.445214*1e6));
        overlayItem = new OverlayItem(myGeoPoint2, "Martín Ledesma", "Capiatá");
        myItemizedOverlay.addOverlay(overlayItem);

        overlays.add(myItemizedOverlay);
        mapView.postInvalidate();
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

MyItemizedOverlay.java

```
package maps.test;

import java.util.ArrayList;

import android.app.AlertDialog;
import android.content.Context;
import android.graphics.drawable.Drawable;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.OverlayItem;

public class MyItemizedOverlay extends com.google.android.maps.ItemizedOverlay<OverlayItem> {

    private Context mContext;
    private final ArrayList<OverlayItem> myOverlaysArray = new ArrayList<OverlayItem>();
    private GeoPoint geoPoint = null;
    public MyItemizedOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));
    }

    public MyItemizedOverlay(Drawable defaultMarker, Context context) {
        super(boundCenterBottom(defaultMarker));
        mContext = context;
    }

    public void addOverlay(OverlayItem overlay) {
        myOverlaysArray.add(overlay);
        populate();
    }

    @Override
    protected OverlayItem createItem(int i) {
        return myOverlaysArray.get(i);
    }

    // Removes overlay item i
    public void removeItem(int i) {
        myOverlaysArray.remove(i);
        populate();
    }

    // Returns present number of items in list
    @Override
    public int size() {
        return myOverlaysArray.size();
    }

    public void addOverlayItem(OverlayItem overlayItem) {
        myOverlaysArray.add(overlayItem);
        populate();
    }

    public void addOverlayItem(int lat, int lon, String title) {
        try {
            geoPoint = new GeoPoint(lat, lon);
            OverlayItem overlayItem = new OverlayItem(geoPoint, title, null);
            addOverlayItem(overlayItem);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    protected boolean onTap(int index) {
        OverlayItem item = myOverlaysArray.get(index);
        AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);
        dialog.setTitle(item.getTitle());
        dialog.setMessage(item.getSnippet());
        dialog.show();
        return true;
    }
} 
```

我已经在示例应用程序中测试了代码，这是我的 android 清单，将其与您自己的进行比较。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="maps.test"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.INTERNET" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <uses-library android:name="com.google.android.maps" />
        <activity
            android:name=".MyATMLocatorActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

这是我的 Main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<com.google.android.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:clickable="true"
    android:apiKey="Your Maps API Key goes here"
/> 
```

# ruby-on-rails - 在 environment.rb 中的 Rails 未定义方法“初始化”

> ID：10290597
> 
> 赞同：0
> 
> 时间：2012-04-24T01:28:50.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试将 twitter/bootstrap 集成到我的第一个 rails 应用程序中（按照这篇文章[http://www.opinionatedprogrammer.com/2011/11/twitter-bootstrap-on-rails/](http://www.opinionatedprogrammer.com/2011/11/twitter-bootstrap-on-rails/)），现在我收到了这个错误无法理解/解决。

```
 new-host:Talker Talker$ rails s
=> Booting Thin
=> Rails 3.2.3 application starting in development on [http://0.0.0.0:3000](http://0.0.0.0:3000)
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/Projects/Talker/config/environment.rb:4:in `<top (required)>': undefined method`Initialize' for Rails:Module (NoMethodError)
    from /Projects/Talker/config.ru:4:in `require'
    from /Projects/Talker/config.ru:4:in`block in '
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in`initialize'
    from /Projects/Talker/config.ru:1:in `new'
    from /Projects/Talker/config.ru:1:in`'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in`parse_file'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
    from /.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:46:in`app'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
    from /.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:252:in`start'
    from /.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:70:in `start'
    from /.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:55:in`block in '
    from /.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'
    from /.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in`'
    from script/rails:6:in `require'
    from script/rails:6:in`' 
```

这就是我的环境.rb 的样子

```
 require File.expand_path('../application', **FILE**)
Rails.Initialize.run do |config|
config.gem 'mongo'
config.gem "mongo_mapper"
end
Talker::Application.initialize! 
```

我对 Rails 很陌生，因此非常感谢任何帮助/指导！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:55:39.337

我认为您不需要在 Rails.Initialize 中指定 config.gem。在项目根目录下的 Gemfile 中指定 gems。您可以删除以上内容

```
gem "mongo"
gem "mongo_mapper" 
```

然后使用 bundle install 安装 gems。现在你应该拥有宝石

请在删除 Rails.Initialize 块后尝试重新启动

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T15:36:25.940

遵循[naren](https://stackoverflow.com/users/444721/naren)的指示时，您是否`Rails.Initialize.run`从文件中删除了该块`environment.rb`？我知道这可能听起来很傻:)

此外，从第二个错误中，我推测您可能正在使用 Mongo HQ，如果它托管在 Heroku 上，他们有一个非常详细的说明手册来配置您的数据库。[Heroku MongoHQ 开发中心](https://devcenter.heroku.com/articles/mongohq)。在您的应用程序中检查两件事：

1.  MongoDB url（Mongo HQ 的 url）是否配置正确？这是因为，第二个错误表明链接本身可能存在问题。

2.  较新版本的 rails（3 及更高版本）不允许`config.gem`环境块中的语法。相反，您需要在`config/initializers`. 有关[Rails 3 的 MongoDB 文档](http://www.mongodb.org/display/DOCS/Rails+3+-+Getting+Started#Rails3-GettingStarted-Initializing)部分的更多信息。

希望这可以帮助。

# php - 显示 .json 文件中的正确数据

> ID：10290601
> 
> 赞同：0
> 
> 时间：2012-04-24T01:29:08.453
> 
> 标签：php, json

如果这含糊不清，我提前道歉，我已经为此奋斗了将近 10 个小时，但一无所获......

我的客户被他们的 SEO 公司搞砸了，我正在努力帮助挽救他们的业务。我们遇到的一个主要问题是他们的网站内容依赖于托管在他们的 SEO 公司网站上的数据馈送。主要城镇周围不同区域的内容由该脚本自动生成。部分脚本托管在客户端服务器上，并与提要进行通信。

我找到了一个 JSON 文件，其中包含提要使用的所有数据，但我正在努力让脚本改为从该文件中读取。

似乎有 2 个函数我应该对 generateContentFromFeed 和 generateTextFromFile 感兴趣。目前它似乎正在使用generateContentFromFeed（但可能正在使用generateTextFromFile elsehwere，但我很确定它不是。我相信如果你不想从外部获取数据，这个函数就在那里）。

我尝试过交换功能，并在配置文件中更改提要的来源，但没有任何乐趣。所有这一切都是输出 json 文件的全部内容。

文件如下：

内容类.php

```
<?php

/**
 * This class manipulates content from files / JSON into an array
 * Also includes helpful functions for formatting content
 */

class Content {

public $links = array();
public $replacements = array();

private function stripslashes_gpc($string) {

    if (get_magic_quotes_gpc()) {

        return stripslashes($string);

    } else {

        return $string;

    }

}

private function sourceContentToArray($source) {

    // array
    if (is_array($source)) {

        $array = $source;

    // json
    } elseif (json_decode($source) != FALSE || json_decode($source) != NULL) {

        $array = json_decode($source, 1);

    // file
    } elseif (file_exists($source)) {

        if (!$array = json_decode(file_get_contents($source), 1)) {

            echo "File empty or corrupt";
            return false;

        }

    } else {

        echo 'Source content not recognised';
        return false;

    }

    return $array;

}

public function generateContent($source, $type="paragraph", $label="", $subject, $num=0, $randomize_order=false) {

    if (!$array = $this->sourceContentToArray($source))
        return false;

    $array = empty($this->links) ? $this->loadLinks($array, $subject) : $array;
    $this->loadGlobalReplacements($array, $subject);

    $ca = array();
    foreach ($array['content'] as $c) {

        if ($c['type'] == $type) {

            if (empty($label) || (!empty($label) && $c['label'] == $label)) {

                $ca[] = $c;

            }

        }

    }

    $rc = array();
    foreach ($ca as $k => $a) {

        $rc[] = $this->randomizeContent($a, $subject.$k);

    }

    if ((!is_array($num) && $num >= 1) || (is_array($num) && $num[0] >= 1)) {

        $rc = $this->arraySliceByInteger($rc, $subject, $num);

    } else if ((!is_array($num) && $num > 0 && $num < 1) || (is_array($num) && $num[0] > 0 && $num[0] < 1)) {

        $rc = $this->arraySliceByPercentage($rc, $subject, $num);

    } else {

        if ($randomize_order == true)
            $rc = $this->arraySliceByPercentage($rc, $subject, 1);

    }

    return $rc; 

}

public function formatContent($source, $type, $subject, $find_replace=array()) {

    $c = "";

    foreach ($source as $k => $s) {

        $text = "";
        if ($type == "list" || $type == "paragraph") {

            $text .= "<h3>";
            foreach ($s['title'] as $t) { 

                $text .= $t." ";

            }
            $text .= "</h3>";

        }

        if ($type == "list") {

            $text .= "<ul>";

        } else if ($type == "paragraph") {

            $text .= "<p>";

        }

        foreach ($s['parts'] as $b) { 

            if ($type == "list")
                $text .= "<li>";

            $text .= $b." ";

            if ($type == "list")
                $text .= "</li>";

        }

        if ($type == "list") {

            $text .= "</ul>";

        } else if ($type == "paragraph") {

            $text .= "</p>";

        }

        $text = $this->findReplace($s['replacements'], $text, $subject.$k."1");
        $text = $this->injectLinks($this->links, $text, $subject.$k."2");
        $text = $this->findReplace($this->replacements, $text, $subject.$k."3");
        $text = $this->findReplace($find_replace, $text, $subject.$k."4");
        $text = $this->aAnReplacement($text);
        $text = $this->capitaliseFirstLetterOfSentences($text);

        $c .= $this->stripslashes_gpc($text);

    }

    return $c;

}

public function injectLinks($links, $text, $subject) {

    global $randomizer;

    if (empty($links))
        return $text;

    foreach ($links as $k => $link) {

        $_link = array();
        if (preg_match("/\{L".($k+1)."\}/", $text)) {

            preg_match_all("/\{L".($k+1)."\}/", $text, $vars);

            foreach ($vars[0] as $vark => $varv) {

                $_link['link'] = empty($_link['link']) ? $this->links[$k]['link'] : $_link['link'];
                $l_link = $randomizer->fetchEncryptedRandomPhrase($_link['link'], 1, $subject.$k.$vark);
                unset($_link['link'][array_search($l_link, $_link['link'])]);
                $_link['link'] = array_values($_link['link']);

                $_link['text'] = empty($_link['text']) ? $this->links[$k]['text'] : $_link['text'];
                $l_text = $randomizer->fetchEncryptedRandomPhrase($_link['text'], 2, $subject.$k.$vark);
                unset($_link['text'][array_search($l_text, $_link['text'])]);
                $_link['text'] = array_values($_link['text']);

                $link_html = empty($l_link) ? $l_text : "<a href=\"".$l_link."\">".$l_text."</a>";
                $text = preg_replace("/\{L".($k+1)."\}/", $link_html, $text, 1);
                $this->removeUsedLinksFromPool($l_link);

            }

        }

    }

    return $text;

}

private function loadLinks($source, $subject) {

    global $randomizer;

    if (!empty($source['links'])) { 

        foreach ($source['links'] as $k => $l) {

            $source['links'][$k]['link'] = preg_split("/\r?\n/", trim($l['link']));
            $source['links'][$k]['text'] = preg_split("/\r?\n/", trim($l['text']));

        }

        $this->links = $source['links'];

    }

    return $source;

}

private function loadGlobalReplacements($source, $subject) {

    global $randomizer;

    $source['replacements'] = $this->removeEmptyIndexes($source['replacements']);
    foreach ($source['replacements'] as $k => $l) {

        $source['replacements'][$k] = preg_split("/\r?\n/", trim($l));

    }

    $this->replacements = $source['replacements'];
    return $source;

}

private function removeUsedLinksFromPool($link) {

    foreach ($this->links as $key => $links) {

        foreach ($links['link'] as $k => $l) {

            if ($l == $link) {

                unset($this->links[$key]['link'][$k]);

            }   

        }

    }

}

private function randomizeContent($source, $subject) {

    global $randomizer;

    $source['title'] = $this->removeEmptyIndexes($source['title']);
    foreach ($source['title'] as $k => $t) {

        $source['title'][$k] = trim($randomizer->fetchEncryptedRandomPhrase(preg_split("/\r?\n/", trim($t)), 1, $subject.$k));

    }

    $source['parts'] = $this->removeEmptyIndexes($source['parts']);
    foreach ($source['parts'] as $k => $b) {

        $source['parts'][$k] = trim($randomizer->fetchEncryptedRandomPhrase(preg_split("/\r?\n/", trim($b)), 2, $subject.$k));

    }

    $source['structure'] = trim($source['structure']);
    if ($source['type'] == "list") {

        $source['parts'] = array_values($source['parts']);
        $source['parts'] = $randomizer->randomShuffle($source['parts'], $subject."9");

    } else if ($source['structure'] != "") {

        $source['structure'] = $randomizer->fetchEncryptedRandomPhrase(preg_split("/\r?\n/", $source['structure']), 3, $subject);
        preg_match_all("/(\{[0-9]{1,2}\})/", $source['structure'], $matches);

        $sc = array();
        foreach ($matches[0] as $match) {

            $sc[] = str_replace(array("{", "}"), "", $match);

        }

        $bs = array();
        foreach ($sc as $s) {

            $bs[] = $source['parts'][$s];

        }

        $source['parts'] = $bs;

    }   

    $source['replacements'] = $this->removeEmptyIndexes($source['replacements']);
    foreach ($source['replacements'] as $k => $r) {

        $source['replacements'][$k] = preg_split("/\r?\n/", trim($r));

    }

    return $source;

}

private function removeEmptyIndexes($array, $reset_keys=false) {

    foreach($array as $key => $value) {

        if ($value == "") {

            unset($array[$key]);

        }

    }

    if (!empty($reset_keys))
        $array = array_values($array);

    return $array;

}

private function arraySliceByPercentage($array, $subject, $decimal=0.6) {

    global $randomizer;

    $array = $randomizer->randomShuffle($array, $subject);

    if (is_array($decimal))
        $decimal = $randomizer->fetchEncryptedRandomPhrase(range($decimal[0], $decimal[1], 0.1), 1, $subject);

    $ac = count($array);
    $n = ceil($ac * $decimal);

    $new_array = array_slice($array, 0, $n);

    return $new_array;

}

private function arraySliceByInteger($array, $subject, $number=10) {

    global $randomizer;

    $array = $randomizer->randomShuffle($array, $subject);

    if (is_array($number))
        $number = $randomizer->fetchEncryptedRandomPhrase(range($number[0], $number[1]), 1, $subject);

    $new_array = array_slice($array, 0, $number);

    return $new_array;

}

private function aAnReplacement($text) {

    $irregular = array(

        "hour"      => "an",
        "europe"    => "a",
        "unique"    => "a",
        "honest"    => "an",
        "one"       => "a"

    );

    $text = preg_replace("/(^|\W)([aA])n ([^aAeEiIoOuU])/", "$1$2"." "."$3", $text);
    $text = preg_replace("/(^|\W)([aA]) ([aAeEiIoOuU])/", "$1$2"."n "."$3", $text);

    foreach ($irregular as $k => $v) {

        if (preg_match("/(^|\W)an? ".$k."/i", $text)) {

            $text = preg_replace("/(^|\W)an? (".$k.")/i", "$1".$v." "."$2", $text);

        }

    }

    return $text;

}

private function capitaliseFirstLetterOfSentences($text) {

    $text = preg_replace("/(<p>|<li>|^|[\n\t]|[\.\?\!]+\s)(<a.*?>)?(?!%)([a-z]{1})/se", "'$1$2'.strtoupper('$3')", $text);  
    return $text;

}

public function findReplace($find_replace, $input, $subject) {

    global $randomizer;
    if (!empty($find_replace)) {

        foreach ($find_replace as $key => $val) {

            if (is_array($val)) {

                $fr = $val;
                $pattern = "/".preg_quote($key)."/i";
                preg_match_all($pattern, $input, $vars);

                foreach ($vars[0] as $vark => $varv) {

                    $fr = empty($fr) ? $val : $fr;
                    $new_val = $randomizer->fetchEncryptedRandomPhrase($fr, 1, $subject.$key.$vark);
                    unset($fr[array_search($new_val, $fr)]);
                    $fr = array_values($fr);

                    $input = preg_replace($pattern, $new_val, $input, 1);

                }

            } else {

                $pattern = "/".preg_quote($key)."/i";
                $input = preg_replace($pattern, $val, $input);

            }

        }

    }

    return $input;

}

public function generateTextFromFile($file, $subject, $find_replace=array()) {

    global $randomizer;

    $content = trim(file_get_contents($file));
    $lines = preg_split("/\r?\n/s", $content);

    $text = $randomizer->fetchEncryptedRandomPhrase($lines, 4, $subject);
    $text = $this->findReplace($find_replace, $text, $subject);

    return $text;

}

public function generateContentFromFeed($file, $type, $label="", $subject, $num=0, $find_replace=array()) {

    global $cfg;

    $vars = array ( "api_key"       => $cfg['feed']['api_key'],
                    "subject"       => $subject,
                    "file"          => $file,
                    "type"          => $type,
                    "label"         => $label,
                    "num"           => $num,
                    "find_replace"  => json_encode($find_replace));

    $encoded_vars = http_build_query($vars);

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,"http://feeds.redsauce.com/example/index.php");
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $encoded_vars);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

    $content = curl_exec($ch);

    curl_close($ch);

    return $content;

}

}

?> 
```

配置文件

```
<?php

// LOCAL SERVER
// Paths
$cfg['basedir'] = "public_html/directory/"; // change this for inlcudes and requires.
$cfg['baseurl'] = "/directory/"; // change this for relative links and linking to images, media etc.
$cfg['fullbaseurl'] = "http://customerssite.com/directory/"; // change this for absolute links and linking to pages

/*
// Database - local
$cfg['database']['host'] = "127.0.0.1";
$cfg['database']['name'] = "username";
$cfg['database']['user'] = 'root'; // change this to the database user
$cfg['database']['password'] = ''; // change this to the database password
*/

// Database - web
$cfg['database']['host'] = "localhost";
$cfg['database']['name'] = "db";
$cfg['database']['user'] = 'user'; // change this to the database user
$cfg['database']['password'] = 'pass'; // change this to the database password

// Errors
$cfg['errors']['display'] = 1; // change this to display errors on or off (on for testing, off for production)
$cfg['errors']['log'] = 0; // change this to log errors to /log/error.log

// Caching
$cfg['caching']['status'] = 0; // determines whether the cache is enabled. 1 for enabled, 0 for disabled 
$cfg['caching']['expiry_time'] = 604800; // determines expiry time of cached items (604800 = 14 days)
$cfg['caching']['directory'] = $cfg['basedir']."public_html/_cache/"; // directory in which cached files are stored

// Analytics
$cfg['analytics']['status'] = 1;
$cfg['analytics']['tracking_id'] = "UA-21030138-1";

// Javascript
$cfg['maps']['status'] = 0; // load google maps javascript
$cfg['jquery_ui']['status'] = 0; // load jquery ui javascript + css

// Site defaults
$cfg['site_name'] = "Customer"; // change this to the site name
$cfg['default']['page_title'] = "Customer"; // change this to the default title of all pages
$cfg['default']['page_description'] = "Customer"; // change this to the default meta-description of all pages
$cfg['default']['email'] = "Customer"; // change this to the administrators email for receiving messages when users signup etc
$cfg['default']['category']['id'] = 130;

// Email
$cfg['email']['address'] = "Customer"; // change this to the administrators email for receiving messages when users signup etc
$cfg['email']['from'] = $cfg['site_name']." <Customer>"; // email will appear to have come from this address
$cfg['email']['subject'] = "Enquiry from ".$cfg['site_name']; // subject of the email
$cfg['email']['success_message'] = "Thank you for your enquiry. Someone will be in touch with you shortly."; // message to display if the email is sent successfully
$cfg['email']['failure_message'] = "There was an error processing your enquiry. <a href=\"".$_SERVER['REQUEST_URI']."\">Please try again</a>."; // message to display if the email is not sent successfully

// Content feed
$cfg['feed']['api_key'] = "Customer"; // enter the unique content feed api key here
$cfg['feed']['url'] = "http://feeds.customersseocompany.com/customer/index.php"; // URL to connect to to pull the content feed

// Dates
date_default_timezone_set('Europe/London');
$cfg['default']['date_format'] = "d/m/Y H:i:s";

// Options
$cfg['listings']['type'] = "ajax"; // options are none (to display no listings), page (to display the listings on the page) or ajax (to load the listings via AJAX)
$cfg['listings']['num_per_page'] = 10; // maximum number of listings to show per page

// Routing
$cfg['routes'] = array(

'category' => array(

    "(?P<category>.+?)-category",
    "_pages/category.php"

),

't1' => array(

    "(?P<category>.+?)-in-(?P<t1_name>.+?)_(?P<county>.+)",
    "_pages/tier1.php"

),

't1_map' => array(

    "t1-map-data-(?P<t1_name>.+)-(?P<page_num>[0-9]+)",
    "_ajax/map-data.php"

),

't2_map' => array(

    "t2-map-data-(?P<t2_name>.+)-(?P<t1_name>.+)-(?P<page_num>[0-9]+)",
    "_ajax/map-data.php"

),

'ajax_listings' => array(

    "ajax-listings-(?P<category>.+?)-(?P<t2_id>.+)-(?P<page_num>[0-9]+)",
    "_ajax/listings.php"

),

'search' => array(

    "^search\/?$",
    "_pages/search.php"

),

'single' => array(

    ".*?-(?P<listing_id>[0-9]+)",
    "_pages/single.php"

)

);

// Site specific

// Encoding
header('Content-type: text/html; charset=UTF-8');

?> 
```

tier1.php 中使用的部分代码（用于生成每个位置和关键字页面的文件）生成段落文本：

```
<?php

$randParas = array(1, 2, 3);

$numParas = $randomizer -> fetchEncryptedRandomPhrase($randParas, 1, $_SERVER['REQUEST_URI']);

$content = $content->generateContentFromFeed(

// file
"categories/".$category[0]['category_slug']."/paragraphs",

// type
"paragraph",

// label
"",

// subject
$_SERVER['REQUEST_URI']."7",

// num
$numParas,

// find_ replace
array(

    "XX" => $t1_location[0]['definitive_name'],
    "YY" => $cfg['site_name']

)

);

?> 
```

来自其中一个 json 文件的片段（我知道我粘贴的代码提前终止，我只是想把它的一部分放在这里，因为文件很大！）：

```
{"filename":" xx keywords","content":[{"title":{"1":"xx example\r\nexample in xx\r\nexample in the xx region\r\nexample in the xx area","2":"","3":"","4":""},"type":"paragraph","label":"","structure":"","parts":{"1":"Stylish and practical, a xx keyword \r\nPractical and stylish, a xx keyword \r\nUseful and pragmatic, a xx keyword \r\nPragmatic and useful, a xx keyword \r\nModern and convenient, a xx keyword ", 
```

如果您需要更多信息，请告诉我您需要什么。我真的很感谢提前的帮助，因为我真的很想帮助这个客户。他们是伟大的人，不应该受到负面 SEO 公司的打击。

如果有人知道这个脚本是什么，那将是最有帮助的！然后我可以购买/下载它并使用数据生成我自己的提要。

如果您可以帮助生成提要的代码，或者我应该如何从 json 文件中获取数据并正确过滤它，那就太好了！

非常感谢，

凯文

附言。对不起所有的代码，我之前被告知没有发布足够的代码！

编辑：这是我现在在以下建议之后使用的代码：

```
<?php

$randParas = array(1, 2, 3);

$numParas = $randomizer -> fetchEncryptedRandomPhrase($randParas, 1, $_SERVER['REQUEST_URI']);

$content = $content->generateContent(

// file
"content/categories/".$category[0]['category_slug']."/paragraphs.json",

// type
"paragraph",

// label
"",

// subject
$_SERVER['REQUEST_URI']."7",

// num
$numParas,

// find_ replace
array(

    "XX" => $t1_location[0]['definitive_name'],
    "YY" => $cfg['site_name']

)

);

?>

        <?php

            if($numParas == '3'){

                $divClass = 'vertiCol';

            }

            elseif($numParas == '2'){

                $divClass = 'vertiColDub';

            }

            else {

                $divClass = 'horizCol';

            }

            $randImages = glob('_images/categories/'.$category[0]['category_slug'].'/*.jpg');
            $randImages = $randomizer->randomShuffle($randImages, $_SERVER['REQUEST_URI']);

                $fc = preg_replace("/<h3>.*?<\/h3>/", "$0", $content);              
                $fc = preg_replace("/<h3>.*?<\/h3><p>.*?<\/p>/", "<div class=\"contCol ".$divClass."\">$0$1</div>", $content);

            $fca = preg_split("/(\.|\?|\!)/", $fc, -1, PREG_SPLIT_DELIM_CAPTURE);

            $prStr = '';

            foreach ($fca as $fck => $fcv) {

                if ($fck % 3 == 0 && $fck != 0 && !in_array($fcv, array(".", "?", "!"))) 
                    $prStr .= "</p>\n<p>";

                    $prStr .= $fcv;

            }

            preg_match_all('/<div class="contCol '.$divClass.'"><h3>.*?<\/h3>.*?<\/div>/s', $prStr, $matches);

            $randAlign = array(

                array('topleft'),
                array('topright'),
                #array('bottomleft'),
            #   array('bottomright')

            );

            $i=0;                   

                $randSelectAlign = $randomizer->fetchEncryptedRandomPhrase($randAlign, 0, $_SERVER['REQUEST_URI']);             
                $randSelectAlign = $randSelectAlign[0];

            foreach($matches[0] as $newPar){

                $i++;

                if($randSelectAlign=='topleft'){

                    echo str_replace('</h3><p>', '</h3><p><span class="imgWrap" style="float:left"><img src="'.$cfg['baseurl'].$randImages[$i].'" width="170" /></span>', $newPar);

                }   

                elseif($randSelectAlign=='topright'){

                    echo str_replace('</h3><p>', '</h3><p><span class="imgWrap" style="float:right"><img src="'.$cfg['baseurl'].$randImages[$i].'" width="170" /></span>', $newPar);

                }

                elseif($randSelectAlign=='bottomleft'){

                    echo str_replace('</p></div>', '<span class="imgWrap" style="float:left"><img src="'.$cfg['baseurl'].$randImages[$i].'" width="170" /></span></div>', $newPar);

                }

                elseif($randSelectAlign=='bottomright'){

                    echo str_replace('</p></div>', '<span class="imgWrap" style="float:right"><img src="'.$cfg['baseurl'].$randImages[$i].'" width="170" /></span></div>', $newPar);

                }

                else {

                }

                //randomly from float array based on server uri!

                //randomly select a way to display the images here etc      
                #

            }

    ?> 
```

这给了我以下错误消息：

注意：第 230 行 /home/account/public_html/subdomain/directory/_pages/tier1.php 中的数组到字符串转换

注意：第 231 行 /home/account/public_html/subdomain/directory/_pages/tier1.php 中的数组到字符串转换

警告：preg_split() 期望参数 2 是字符串，数组在 /home/account/public_html/subdomain/directory/_pages/tier1.php 第 233 行给出

警告：在第 237 行的 /home/account/public_html/subdomain/directory/_pages/tier1.php 中为 foreach() 提供的参数无效

这些代码行是：

```
230  $fc = preg_replace("/<h3>.*?<\/h3>/", "$0", $content);             
231  $fc = preg_replace("/<h3>.*?<\/h3><p>.*?<\/p>/", "<div class=\"contCol ".$divClass."\">$0$1</div>", $content);
233  $fca = preg_split("/(\.|\?|\!)/", $fc, -1, PREG_SPLIT_DELIM_CAPTURE);
235  $prStr = '';
237  foreach ($fca as $fck => $fcv) {

       if ($fck % 3 == 0 && $fck != 0 && !in_array($fcv, array(".", "?", "!"))) 
           $prStr .= "</p>\n<p>";

           $prStr .= $fcv;

    } 
```

我认为这是因为它将内容作为数组吐出？我需要对数据做些什么才能使其正确输出吗？

非常感谢，

凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:35:04.940

浏览了代码后，我想我知道它应该做什么，尽管我仍然对随机化器的东西感到困惑；-)

您可以将 JSON 数据作为字符串`generateContent()`作为第一个参数 ( `$source`) 传递给方法。

返回一个数组，`generateContent()`所以你必须运行它`formatContent()`（我认为）。

# php - PHP 会话丢失：子域和 https（SSL 到非 SSL）

> ID：10290602
> 
> 赞同：2
> 
> 时间：2012-04-24T01:29:38.367
> 
> 标签：php, https, subdomain, session-cookies

我想我在 stackoverflow 上阅读并尝试了有关“会话、跨域和 ssl”的所有相关主题。不幸的是，没有任何效果。

我的情况：

> loginForm.html（非 SSL）-> authUser.php（SSL）-> showAccount.php（非 SSL）

问题是，这些文件被放置在不同的子域中，并由 SSL 或非 SSL 提供服务。

> loginForm.html -> [http://dev.domain.com](http://dev.domain.com)
> authUser.php -> [https://ssl.domain.com](https://ssl.domain.com)
> showAccount.php -> [http://dev.domain.com](http://dev.domain.com)

如果用户凭据正确，`authUser.php`则应创建由`showAccount.php`.

如前所述，我尝试了所有发布的解决方案。作为参考，让我们看一下：[Session lost whenswitching from HTTP to HTTPS in PHP](https://stackoverflow.com/questions/441496/session-lost-when-switching-from-http-to-https-in-php)。
我还尝试使用[PHP Sessions](https://stackoverflow.com/questions/1064243/php-sessions-across-sub-domains/1457582#1457582)`session_set_cookie_params`中提到的跨子域扩展此代码段，但这都不起作用。 我也试过
`ini_set('session.cookie_domain', '.domain.com');`

**编辑：正如所要求的答案，这里是使用的代码**（最初由 Jacob 在这里发布：[Session lost whenswitching from HTTP to HTTPS in PHP](https://stackoverflow.com/questions/441496/session-lost-when-switching-from-http-to-https-in-php/441775#441775)）

**[https://ssl.domain.com/user/authUser.php](https://ssl.domain.com/user/authUser.php)**

```
<?php

// auth with database was successful, so create the session

session_set_cookie_params(0, '/', '.domain.com'); 
session_start();

$currentSessionID = session_id();
$_SESSION['testvariable'] = 'It worked';
$InsecureServerDomain = 'dev.domain.com';
$pagePath = '/showAccount.php';

echo '<a href="http://' . $InsecureServerDomain . $pagePath . '?session=' . $currentSessionID . '">Transfer Cookie from secure to insecure </a>';

?> 
```

**[http://dev.domain.com/showAccount.php](http://dev.domain.com/showAccount.php)**

```
<?php

$currentSessionID = filter_input(GET, "session");
session_set_cookie_params(0, '/', '.domain.com'); 

session_id($currentSessionID);

session_start();

if (!empty($_SESSION['testvariable'])) {
      echo $_SESSION['testvariable'];
} else {
      echo 'It did not work.';
}

?> 
```

`$_SESSION`总是空的。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:07:31.980

*仅*保护您的登录/授权是没有意义的。查看网络流量的攻击者可以窃取您在每次请求时传递给服务器的登录 cookie/会话令牌，然后以该用户身份登录。当然，*密码*是安全的，但它实际上并不能保护您的用户会话不被中间人攻击劫持，例如，在不安全的 WiFi 网络上。

有关其工作原理的示例，请参见 Firesheep。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:58:51.087

与往常一样，查看一些代码会有所帮助。也许是您存储会话的部分以及您如何使用 cookie/数据库。这是一个关于如何进行[跨域授权](https://stackoverflow.com/questions/263010/whats-your-favorite-cross-domain-cookie-sharing-approach)的很棒的教程，给这个家伙更多的支持！

# c++ - 在运行时更改变量而不使用 C/C++ 中的钩子？

> ID：10290603
> 
> 赞同：1
> 
> 时间：2012-04-24T01:29:39.203
> 
> 标签：c++, c, hook

我希望能够在 C/C++ 中执行以下操作（如果可能的话）。

我有一个像这样的文件：

> *Initialvariables.txt*
> a = 5
> b = 2
> c = 8

和看起来像这样的代码：

`int main(int argc char *argv[])
{
int a;
int b;
int c;

LoadInitialVariables("Initialvariables.txt");
}`

 `其中 a、b、c 是变量，文件“Initialvariables.txt”包含编译后可以更改的初始值。

**是否可以创建 LoadInitialVariables，这样如果有新人来更改代码，他们可以简单地添加一个新的 int 并在“initialvariables.txt”中添加一个新行，然后代码将完成其余的设置来设置初始值多变的？**

目的不是硬编码钩子，而是使 LoadInitialVariables 尽可能通用。

对我来说，困难似乎来自编译器去除符号的事实，因此如果没有适当的钩子，可执行文件将不知道 a、b、c 等是什么。如果可能的话，我宁愿不必指定钩子（除非它只是简单地装饰 int）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:38:10.323

为什么不使用一个`std::map<string, int>`？

如果不使用矢量或地图并稍后对其进行迭代，您的提议就没有多大意义。如果用户只是在 main 中添加了一个变量并添加了代码来解析并在您的加载函数中分配它......如果没有进一步的更改，现有代码将无法了解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T01:40:11.840

您可以`LoadInitialVariables()`将文本文件加载到 a中，然后您可以在需要时按名称`std::map<std::string, int>`引用值，例如：`int`

```
void LoadInitialVariables(const std::string &fileName, std::map<std::string, int> &variables)
{
    variables.clear();

    char name[256];
    int value;

    for (each line in the file)
    {
        std::string line = ...;
        if (sscanf(line.c_str(), "%s = %d", name, &value) == 2)
            variables[name] = value;
    }
    ...
}

int main(int argc char *argv[])
{
    std::map<std::string, int> variables;
    LoadInitialVariables("Initialvariables.txt", variables);

    int a = variables["a"];
    int b = variables["b"];
    int c = variables["c"];
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T01:41:46.697

> 是否可以创建 LoadInitialVariables，这样如果有新人来更改代码，他们可以简单地添加一个新的 int 并在“initialvariables.txt”中添加一个新行，然后代码将完成其余的设置来设置初始值多变的？

不。

但是构建一个支持层并不难，程序员可以使用该支持层注册变量，然后文件解析器可以设置这些变量。`std::map<std::string, int>`最简单的方法是[VBRonPaulFan 建议](https://stackoverflow.com/a/10290664/2509)的 c++ 。在 c 中您必须编写更多代码，但仍然可以在几十行中完成（如果您只需要支持一种类型：几百行即可支持合理但固定的一组类型）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T01:50:40.197

你要求[反思](http://en.wikipedia.org/wiki/Reflection_%28computer_programming%29)吗？它在 C++ 中不可用，至少不是开箱即用的。你总是可以做一些可怕的 C 风格的宏......

```
#define READ_FROM_FILE(X) X = some_function_that_greps_file_for(#X)

int a, b, c;
READ_FROM_FILE(a);
READ_FROM_FILE(b);
READ_FROM_FILE(c); 
```

但是使用`map<string, int>`.`

# android - 从另一个线程更新 UI

> ID：10290606
> 
> 赞同：0
> 
> 时间：2012-04-24T01:30:23.773
> 
> 标签：android

我知道从另一个线程更新 UI 是被禁止的，所以我试着看看我将从应用程序中得到什么结果。是的，更新 UI 组件时应用程序会崩溃，但有一种情况我不明白，应用程序运行正常。

**1)**

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        tv = (TextView)findViewById(R.id.textView1);
        bt = (Button)findViewById(R.id.button1);

        new Thread(){ //1                       
            public void run() {                             
                tv.setText("changed");                      
        }}.start(); //1  }  
    } 
```

**2)**

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        tv = (TextView)findViewById(R.id.textView1);
        bt = (Button)findViewById(R.id.button1);

        bt.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View arg0) {
                 new Thread(){ //1                       
                        public void run() {                             
                            tv.setText("changed");                      
                    }}.start(); //1  }  
            }

        });

    } 
```

很抱歉我之前对我的问题的描述，我认为大多数人都误解了它，所以我重新提出这个问题。上面有两种情况，它们应该给我崩溃错误，因为它们都创建新线程和更新 UI 组件，但实际上，只有第二种情况崩溃，但第一个场景没有崩溃。有人知道原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T03:23:33.030

检查此异常

```
E/AndroidRuntime( 7652): FATAL EXCEPTION: Thread-19449
E/AndroidRuntime( 7652): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
E/AndroidRuntime( 7652):    at android.view.ViewRootImpl.checkThread(ViewRootImpl.java:4357)
E/AndroidRuntime( 7652):    at android.view.ViewRootImpl.invalidateChild(ViewRootImpl.java:802)
E/AndroidRuntime( 7652):    at android.view.ViewRootImpl.invalidateChildInParent(ViewRootImpl.java:851)
E/AndroidRuntime( 7652):    at android.view.ViewGroup.invalidateChild(ViewGroup.java:4312)
E/AndroidRuntime( 7652):    at android.view.View.invalidate(View.java:8603)
E/AndroidRuntime( 7652):    at android.view.View.invalidate(View.java:8554) 
```

UI 线程检查仅在无效（渲染）时间进行检查。
所以在创建时间（onCreate），是没有问题的。

您可以在 setText 之前添加 Thread.sleep(5000) 并且会发生上述异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T03:08:57.997

看一下这个

```
private void startthread() {
anihandler = new Handler() {

@Override
public void handleMessage(Message msg) {
    super.handleMessage(msg);

     tv.setText("changed");
}

};

aniThread = new Thread() {
  public void run() {
 sleep(1000);
                 anihandler.sendMessage(anihandler
                        .obtainMessage());

}
};

aniThread.start();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T03:13:21.983

代替 Threading，使用 asynctask 进行这种操作。这一切都[在此处](http://developer.android.com/resources/articles/painless-threading.html)进行了描述，并且非常易于使用。

# android - 是否可以使用安卓来控制继电器？

> ID：10290608
> 
> 赞同：1
> 
> 时间：2012-04-24T01:30:27.347
> 
> 标签：android, driver, hardware

这不是一个高度技术性（或具体）的问题。我只是想知道是否可以使用 android 应用程序来控制 12V 继电器。

我想使用这个正在运行的 android： http: [//www.mini-box.com/pico-SAM9G45-X](http://www.mini-box.com/pico-SAM9G45-X)

附带此触摸屏：http: [//www.mini-box.com/INNOLUX-7-TFT-with-touchscreen](http://www.mini-box.com/INNOLUX-7-TFT-with-touchscreen)

我想将它安装在我的车上并编写一个简单的 android 应用程序，可用于控制我的车内照明（通过几个 12V 继电器）。我有很多不同语言的后台编程，所以我不担心应用程序部分。但是，我很少有使用软件来控制硬件的经验。

对此的任何想法都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:57:11.083

首先，您需要在您的 Pico 板上运行 Android。有几个 Android 版本移植到 Pico 供您在此处使用：[http ://arm.mini-box.com/index.php?title=Releases](http://arm.mini-box.com/index.php?title=Releases)

完成此操作后，我建议将 ADK 板连接到 pico，并使用它与继电器连接。[http://developer.android.com/guide/topics/usb/adk.html](http://developer.android.com/guide/topics/usb/adk.html)最流行和广泛记录的 ADK 板设计是基于 Arduino 或 PIC 芯片，所以如果你有经验，我认为不会太多麻烦了。编写应用程序需要在 ADK 上编写一个程序，该程序侦听来自您也创建的 Android 应用程序的输入并做出相应的反应。您可以通过谷歌搜索找到一些有用的信息来帮助您，还有一些专门的讨论组。

或者，也可以使用 Pico 上剩余的未使用引脚与您的继电器通​​信。我不确定 Android 端口是否支持此功能。

这应该是一个有趣的项目，可以让你忙碌几个星期。祝你好运，如果你让它工作，一定要写一些关于它的信息！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-30T21:58:19.160

你可以找到很多带有 wifi 的继电器板，它们有自己的应用程序。您可以将其安装在您的 Android 手机或 PC 或 iphone 中（您可以找到同一板的 ios 应用程序）。您还可以根据自己的选择修改应用程序，并且有些产品还带有输入引脚，因此您可以使用这些输入控制灯光或其他任何东西。你可以检查这个产品检查这个[Android 控件真的](https://www.controlanything.co.in/Relay/Device/R8xPL_Web-i_Androi)有很多可用的产品。

# c - 用 ANSI C 编写的套接字客户端和套接字服务器中的字符数组

> ID：10290609
> 
> 赞同：1
> 
> 时间：2012-04-24T01:30:28.410
> 
> 标签：c, arrays, sockets, char

我正在尝试基于 C 中的套接字编写简单的客户端和服务器。客户端发送字符数组的大小（包括 '\0' 的最后一个单元格），然后发送字符数组。服务器获取大小并尝试为来自客户端的字符数组分配内存。之后，服务器查找空格并将索引 0 中的字符复制到空格，将其粘贴到数组的末尾并将其发送回客户端（如果没有空格，则服务器发送双倍数组）。

我注意到有时我会得到-- |00| |02| -- 从服务器接收到的数组末尾的字符。我已经使用 valgrind 运行了服务器和客户端，它表明问题出在服务器上。

代码如下。

客户：

```
#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <string.h>

int
main ()
{
    int sockfd;
    socklen_t len;
    struct sockaddr_in address;
    int result;

    char ch;
    char *string;
    int i;

    sockfd = socket (AF_INET, SOCK_STREAM, 0);

    address.sin_family = AF_INET;
    address.sin_addr.s_addr = inet_addr ("127.0.0.1"); 
    address.sin_port = htons (9734);
    len = sizeof (address);

    result = connect (sockfd, (struct sockaddr *) &address, len);

    if (result == -1)
    {
        perror ("oops: netclient");
        exit (1);
    }

    string = (char*)malloc(sizeof(char));

    for (i =0; ch = getchar(); i++)
    {
        string = (char*)realloc(string, (i+1)*sizeof(char));

        if(ch != '\n')
            string[i] = ch;
        else if (ch == '\n')
        {
            string[i]='\0';
            break;
        }
    }

    printf("%s\n", string);
    printf("%d\n", i);
    i=i+1;

    write (sockfd, &i, 4);

    write (sockfd, string, i);

    read (sockfd, &i, 4);

    string = (char*)realloc(string, i*sizeof(char));

    read (sockfd, string, i); 

    printf("String recieved: %s\n", string);

    close (sockfd);

    free(string);

    exit (0);
} 
```

和服务器：

```
#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <netinet/in.h>
#include <signal.h>
#include <unistd.h>
#include <string.h>

int
main ()
{
    int server_sockfd, client_sockfd; 
    socklen_t server_len, client_len; 
    struct sockaddr_in server_address; 
    struct sockaddr_in client_address; 

    server_sockfd = socket (AF_INET, SOCK_STREAM, 0); 
    server_address.sin_family = AF_INET; /*ipv4*/
    server_address.sin_addr.s_addr = htonl (INADDR_ANY); 
    server_address.sin_port = htons (9734);
    server_len = sizeof (server_address);
    bind (server_sockfd, (struct sockaddr *) &server_address, server_len); 

    listen (server_sockfd, 5); 
    signal (SIGCHLD, SIG_IGN);

    while (1)
    {
        char *string;
        int i, j, k, l=0; /*variables to iteration*/
        printf ("server waiting\n");

        client_len = sizeof (client_address);
        client_sockfd = accept (server_sockfd,
                (struct sockaddr *) &client_address,
                &client_len); 

        if (fork () == 0)
        {

            read (client_sockfd, &i, 4);
            printf("recieved int %d\n", i);
            string = (char*)malloc(sizeof(char) * (i));
            read (client_sockfd, string, i);
            printf("\nSTRING recieved: %s \n", string);

            for(j=0; string[j]!='\0'; j++)
            {
                if(string[j] == ' ')
                {
                    i = i+j; /*size to enlarge*/
                    break;
                }
            }

            /*sending new size*/
            write(client_sockfd, &i, 4);

            /*enlarge the string*/
            string = (char*)realloc(string, i*sizeof(char));

            for (k = i-j-1; k < i-1 ; k ++)
            {
                string[k] = string[l];
                l++;
            }
            string[k+1] = '\0';

            write(client_sockfd, string, i);

            close (client_sockfd);

            free(string);

            exit (0);
        }

        else
        {
            close (client_sockfd);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:36:43.160

您的代码忽略以下返回值`read()`：

```
 read (client_sockfd, &i, 4); 
```

您*不能*忽略此值。套接字接口不保证仅仅因为您请求了 4 个字节，您实际上会得到 4 个字节。套接字接口仅保证您将*至少获得一个*字节。您必须继续调用`read()`，直到获得所需的所有字节。

当您在几行之后读取字符串时也是如此。

即使您的程序现在看起来可以工作，但这种问题会在不可预知的情况下突然出现，例如繁忙的机器或网络，您将无法重现它，并且您的程序将变得不可靠。

# c - 如何找到数组中元素的数量？

> ID：10290610
> 
> 赞同：70
> 
> 时间：2012-04-24T01:30:51.697
> 
> 标签：c, arrays, sizeof

我有一个`int`数组，我需要找到其中的元素数。我知道它与它有关，`sizeof`但我不确定如何准确使用它。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-04-24T01:52:13.427

如果您的数组在范围内，您可以使用`sizeof`它来确定它的大小（以字节为单位）并使用除法来计算元素的数量：

```
#define NUM_OF_ELEMS 10
int arr[NUM_OF_ELEMS];
size_t NumberOfElements = sizeof(arr)/sizeof(arr[0]); 
```

如果您收到一个数组作为函数参数或在堆中分配一个数组，则无法使用`sizeof`. 您必须以某种方式存储/传递尺寸信息才能使用它：

```
void DoSomethingWithArray(int* arr, int NumOfElems)
{
    for(int i = 0; i < NumOfElems; ++i) {
        arr[i] = /*...*/
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-24T01:41:03.133

```
int a[20];
int length;
length = sizeof(a) / sizeof(int); 
```

并且您可以使用另一种方法使您的代码不会被硬编码为`int`

说如果你有一个数组`array`

你只需要：

```
int len = sizeof(array) / sizeof(array[0]); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-24T02:19:42.870

我个人认为 sizeof(a) / sizeof(*a) 看起来更干净。

我也更喜欢将其定义为宏：

```
#define NUM(a) (sizeof(a) / sizeof(*a)) 
```

然后你可以在for循环中使用它，因此：

```
for (i = 0; i < NUM(a); i++) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-04-30T10:51:04.367

除非它是字符数组，否则不可能找到数组中元素的数量。考虑下面的例子：

```
int main()
{
    int arr[100]={1,2,3,4,5};
    int size = sizeof(arr)/sizeof(arr[0]);
    printf("%d", size);
    return 1;
} 
```

即使元素的数量是五个，上面的值也给我们值 100。如果它是一个字符数组，您可以在数组末尾线性搜索空字符串，并在遍历时增加计数器。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-08-11T17:00:53.440

# **实际上，我们无法计算数组中存储了多少元素**

但是您可以使用 sizeof 运算符找到数组长度或大小。

## **但是为什么我们找不到我的数组中有多少元素。**

因为当我们初始化一个数组编译器时，我们会在我们的程序上提供内存，比如 a[10]（10 个大小为 4 的块），如果我们将某个值放在某个索引中，例如 a[0]=1,a[1]，那么每个块都有垃圾值=2,a[3]=8; 并且其他块具有垃圾**值没有人可以分辨哪个值是垃圾，哪个值不是垃圾** *，这就是我们无法计算数组中有多少元素的原因*。我希望这能帮助你理解。小概念

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-05-12T06:15:48.457

超级容易。

只需将分配的字节数除以数组数据类型的字节数，使用`sizeof()`.

例如，给定一个名为`myArray`

```
int numArrElements = sizeof(myArray) / sizeof(int); 
```

现在，如果您的数组的数据类型不是常量并且可能会改变，那么让等式中的除数使用第一个值*的*大小作为数据类型的大小。

例如：

```
int numArrElements = sizeof(myArray) / sizeof(myArray[0]); 
```

这样，代码与类型无关，无论数组的数据类型如何，都可以正常运行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-20T02:57:05.870

我使用上面建议的以下代码来评估二维数组中的元素数量：

```
#include <stdio.h>
#include <string.h>

void main(void)
{
    char strs[3][20] =
    {
        {"January"},
        {"February"},
        {""}
    };

    int arraysize = sizeof(strs)/sizeof(strs[0]);

    for (int i = 0; i < arraysize; i++)
    {
        printf("Month %d is: %s\n", i, strs[i]);
    }

} 
```

它工作得很好。据我所知，您不能在 C 数组中混合不同的数据类型，并且所有数组元素的大小应该相同（如果我是对的），因此您可以通过这个小技巧来利用它：

1.  使用 sizeof() 函数从整个二维数组中计算字节数（在本例中为 3*20 = 60 字节）
2.  使用 sizeof() 函数从第一个数组元素 strs[0] 计算字节数（在本例中为 20 个字节）
3.  将整个大小除以一个元素的大小什么会给你元素的数量

这个片段应该可以移植到 C 中的二维数组，但是在其他编程语言中它不能工作，因为你可以在不同大小的数组中使用不同的数据类型（比如在 JAVA 中）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-02-14T02:13:31.930

问题很简单：给定一个 C++ 数组（例如`x`）`int x[10]`，您将如何获得其中的元素数量？

一个明显的解决方案是以下宏**（定义 1）**：

```
#define countof( array ) ( sizeof( array )/sizeof( array[0] ) ) 
```

我不能说这是不正确的，因为当你给它一个数组时它确实给出了正确的答案。但是，当您提供不是数组的东西时，相同的表达式会给您一些虚假的东西。例如，如果您有

```
int * p; 
```

然后`countof( p )`总是在 int 指针和 int 大小相同的机器上给你 1 （例如在 Win32 平台上）。

该宏还错误地接受具有成员函数 operator[] 的类的任何对象。例如，假设你写

```
class IntArray {
private:
    int * p;
    size_t size;
public:
    int & operator [] ( size_t i );
} x; 
```

然后`sizeof( x )`将是 x 对象的大小，而不是指向的缓冲区的大小`x.p`。因此，您不会得到正确的答案`countof( x )`。

因此我们得出结论，定义 1 不好，因为编译器不会阻止您滥用它。它无法强制只能传入一个数组。

什么是更好的选择？

好吧，如果我们希望编译器确保 countof 的参数始终是一个数组，我们必须找到一个只允许使用数组的上下文。相同的上下文应该拒绝任何非数组表达式。

一些初学者可能会尝试这个**（定义2）**：

```
template <typename T, size_t N>
size_t countof( T array[N] )
{
   return N;
} 
```

他们认为，这个模板函数将接受一个包含 N 个元素的数组并返回 N。

不幸的是，这不能编译，因为 C++ 将数组参数视为指针参数，即上面的定义等价于：

```
template <typename T, size_t N>
size_t countof( T * array )
{
    return N;
} 
```

现在很明显，函数体无法知道 N 是什么。

但是，如果一个函数需要一个**数组引用**，那么编译器会确保实际参数的大小与声明相匹配。这意味着我们可以通过小修改**（定义 3）**使定义 2 工作：

```
template <typename T, size_t N>
size_t countof( T (&array)[N] )
{
    return N;
} 
```

这个 countof 工作得很好，你不能通过给它一个指针来欺骗它。但是，它是一个函数，而不是宏。这意味着您不能在需要编译时间常数的地方使用它。特别是，您不能编写如下内容：

```
int x[10];

int y[ 2*countof(x) ]; // twice as big as x 
```

我们能做些什么吗？

有人（我不知道它是谁——我只是在不知名作者的一段代码中看到它）想出了一个聪明的主意：将 N 从函数体移动到返回类型（例如让函数返回） N 个元素的数组），那么我们可以在不实际调用函数的情况下获得 N 的值。

准确地说，我们必须让函数返回一个数组引用，因为 C++ 不允许你直接返回一个数组。

这个的实现是：

```
template <typename T, size_t N>
char ( &_ArraySizeHelper( T (&array)[N] ))[N];

#define countof( array ) (sizeof( _ArraySizeHelper( array ) )) 
```

不可否认，语法看起来很糟糕。确实，需要一些解释。

一、顶层的东西

```
char ( &_ArraySizeHelper( ... ))[N]; 
```

say`_ArraySizeHelper`是一个函数，它返回对 N 个元素的 char 数组的引用（注意 &）。

接下来，函数参数为

```
T (&array)[N] 
```

这是对 N 个元素的 T 数组的引用。

最后，`countof`定义为函数结果的大小`_ArraySizeHelper`。请注意，我们甚至不需要定义`_ArraySizeHelper()`, -- 一个声明就足够了。

有了这个新定义，

```
int x[10];

int y[ 2*countof(x) ]; // twice as big as x 
```

变得有效，正如我们所愿。

我现在快乐吗？嗯，我认为这个定义肯定比我们访问过的其他定义要好，但它仍然不是我想要的。一方面，它不适用于函数内部定义的类型。这是因为模板函数`_ArraySizeHelper`需要在全局范围内可访问的类型。

我没有更好的解决方案。如果你知道一个，请告诉我。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-03-02T19:14:31.303

```
#include<stdio.h>
int main()
{
    int arr[]={10,20,30,40,50,60};
    int *p;
    int count=0;

    for(p=arr;p<&arr+1;p++)
        count++;

    printf("The no of elements in array=%d",count);

    return 0;
} 
```

> 输出=6

**解释**

`p`是一个指向一维数组的指针，在循环中`for(p=arr,p<&arr+1;p++)` 我`p`指向基地址。假设它的基地址是1000；如果我们递增`p`，那么它指向 1002，依此类推。现在来到这个概念`&arr`- 它基本上代表整个数组，如果我们将 1 添加到整个数组 ie `&arr+1`，它会给出地址 1012 ，即下一个一维数组的地址（在我们的例子中 int 的大小是 2） ，因此条件变为 1000<1012。

所以，基本上条件变成了

```
for(p=1000;p<1012;p++) 
```

现在让我们检查条件并计算值

*   第一次`p=1000`和`p<1012`条件是`true`：进入循环，将值递增`count`到 1。
*   第二次`p=1002`和`p<1012`条件是`true`：进入循环，将值`count`增加到2。
*   ...
*   第 6 次`p=1010`和`p<1012`条件是`true`：进入循环，将值`count`增加到 6。
*   上次`p=1012`和`p<1012`条件为假：打印`count=6`in`printf`语句的值。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-02-26T11:03:39.170

```
void numel(int array1[100][100])
{
    int count=0;
    for(int i=0;i<100;i++)
    {
        for(int j=0;j<100;j++)
        {
            if(array1[i][j]!='\0') 
            {
                count++;
                //printf("\n%d-%d",array1[i][j],count);
            }
            else 
                break;
        }
    }
    printf("Number of elements=%d",count);
}
int main()
{   
    int r,arr[100][100]={0},c;
    printf("Enter the no. of rows: ");
    scanf("%d",&r);
    printf("\nEnter the no. of columns: ");
    scanf("%d",&c);
    printf("\nEnter the elements: ");
    for(int i=0;i<r;i++)
    {
        for(int j=0;j<c;j++)
        {
            scanf("%d",&arr[i][j]);
        }
    }
    numel(arr);
} 
```

这显示了矩阵中元素的确切数量，而与您在初始化时提到的数组大小无关（如果这就是您的意思）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-07-03T14:11:29.750

只有以这种格式声明数组时，我们才能找到数组中的元素数量

```
int a[]={1,2,3,4,5,6}; 
```

数组中的元素数是

```
 n=sizeof(a) / sizeof(a[0]); 
```

如果这样声明，我们应该无法计算数组大小`int a[10]={1,2,3,4,5,6}`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-08-31T02:03:49.037

我主要找到了一种简单的方法来执行循环内的数组长度，就像那样

```
 int array[] = {10, 20, 30, 40};
 int i;
 for (i = 0; i < array[i]; i++) {
    printf("%d\n", array[i]);
 } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-05-12T10:43:07.333

`sizeof`返回其参数的字节大小。这不是你想要的，但它可以提供帮助。

假设您有一个数组：

```
int array[4]; 
```

如果您应用`sizeof`到数组 ( `sizeof(array)`)，它将返回其大小（以字节为单位），在这种情况下是 4 * 的大小`int`，因此总共可能是 16 个字节（取决于您的实现）。

如果您应用`sizeof`到数组 ( `sizeof(array[0])`) 的一个元素，它将返回其大小（以字节为单位），在这种情况下是 an 的大小`int`，因此总共可能是 4 个字节（取决于您的实现）。

如果将第一个除以第二个，它将是： (4 * an 的大小`int`) / (an 的大小`int`) = 4; 这正是你想要的。

所以这应该这样做：

```
sizeof(array) / sizeof(array[0]) 
```

现在您可能希望有一个宏来封装此逻辑，而不必再考虑应该如何完成：

```
#define ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0])) 
```

您需要像在任何其他复杂宏中一样将所有宏括起来，并且还需要将每个变量括起来，以避免与运算符优先级相关的意外错误。

现在您可以在任何数组上使用它，如下所示：

```
int array[6];
ptrdiff_t nmemb;

nmemb = ARRAY_SIZE(array);
/* nmemb == 6 */ 
```

请记住，声明为数组的函数的参数并不是真正的数组，而是指向数组第一个元素的指针，因此这对它们不起作用：

```
void foo(int false_array[6])
{
        ptrdiff_t nmemb;

        nmemb = ARRAY_SIZE(false_array);
        /* nmemb == sizeof(int *) / sizeof(int) */
        /* (maybe  ==2) */
} 
```

但是，如果您将指针传递给数组而不只是数组，则它可以在函数中使用：

```
void bar(int (*arrptr)[7])
{
        ptrdiff_t nmemb;

        nmemb = ARRAY_SIZE(*arrptr);
        /* nmemb == 7 */
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-07-02T19:52:05.987

假设您有一个包含 elements 的数组`1,3,4`。要知道它的长度，您需要使用`sizeof`如下函数：

```
int myArray[] = {1,3,4};
int len = sizeof(myArray) / sizeof(myArray[0]); 
```

您可以通过打印输出来检查元素的数量，如下所示：

```
cout<<"This array has " << len << " elements"; 
```

完整的程序如下：

```
#include <iostream>

using namespace std;

int main()
{

    int myArray[] = {1,3,4};
    int len = sizeof(myArray) / sizeof(myArray[0]);

    cout<<"The array has " << len << "elements";
    return 0;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-07T17:00:43.577

如果我们不知道数组中的元素数量以及用户在运行时何时给出输入。然后我们可以把代码写成

C代码：

```
while(scanf("%d",&array[count])==1) { 
  count++;
} 
```

C++代码：

```
while(cin>>a[count]) {
  count++;
} 
```

现在计数将具有输入的数组元素的数量。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2016-07-06T07:32:18.310

实际上，没有合适的方法来计算动态整数数组中的元素。但是，sizeof 命令在 Linux 中可以正常工作，但在 Windows 中不能正常工作。从程序员的角度来看，不建议使用 sizeof 来取动态数组中的元素个数。在制作数组时，我们应该跟踪元素的数量。

# objective-c - 对象（如 UIButton、UIView、NSString、NSDictionary）上的 NSLog，使用 %@ 进行描述

> ID：10290612
> 
> 赞同：1
> 
> 时间：2012-04-24T01:31:29.140
> 
> 标签：objective-c, ios

对不起，如果这个问题太简单了，但这是我一直想知道的，我想听听专家的意见。

我一直使用**NSLog(@"%@",object);** 检查**NSString**的字符串，或者查看**NSDictionary**里面有什么。所以我真的很好奇你是否可以使用这种技术来**NSLog**目标 C 中的所有对象。

根据我的经验，一个没有类似内容的文本的对象的**NSLog只会给你实例描述，这将是我认为的对象类和实例编号（如****UIView**或**UIButton**）。

有没有什么情况我会得到一个**EXE_BAD_ACCESS**来记录一个对象（不是结构/原始变量）？或者我可以像目前一样继续这样做吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T01:38:01.647

您可以安全地`NSLog`从任何继承自`NSObject`. 该[`description`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)方法将被调用以产生输出。默认实现返回类的名称，但您可以自由地覆盖`description`您自己的对象以生成您认为在调试期间可能对您有帮助的任何文本。

# android - 自定义 Listadapter 可过滤无结果

> ID：10290614
> 
> 赞同：0
> 
> 时间：2012-04-24T01:31:34.180
> 
> 标签：android, filter, arraylist, hashmap, custom-adapter

我现在正在努力解决这个问题。我正在用edittext构建一个可过滤的列表。该列表最初填充得很好，但是一旦我在编辑文本字段中输入了一些内容。整个列表都消失了，并且没有返回任何结果。以下是我的代码。

注意：我的代码主要基于 sacoskun 的[帖子](http://www.sacoskun.com/2008/08/autocompletetextview-with-simpleadapter.html)。

ThreedListViewActivity.java

```
public class ThreedListViewActivity extends ActionBarActivity
{
// All static variables
static final String URL = "http://api.androidhive.info/music/music.xml";
// XML node keys
static final String KEY_SONG = "song"; // parent node
static final String KEY_ID = "id";
static final String KEY_TITLE = "title";
static final String KEY_ARTIST = "artist";
static final String KEY_DURATION = "duration";
static final String KEY_THUMB_URL = "thumb_url";

ListView list;
ThreedListAdapterFilterable adapter;
ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();
EditText filterText = null;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.threed_listview);
    setTitle(R.string.view_3d);
    list=(ListView)findViewById(R.id.list);
    adapter = new ThreedListAdapterFilterable(this, songsList);

    new MyAsyncTask().execute();

    filterText = (EditText) findViewById(R.id.search_box);
    filterText.addTextChangedListener(filterTextWatcher);

    // Click event for single list row
    list.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

        }
    });
}

private TextWatcher filterTextWatcher = new TextWatcher() {

    public void afterTextChanged(Editable s) {
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        adapter.getFilter().filter(s.toString());
    }

};

public class MyAsyncTask extends AsyncTask<Void,Void,Void>{

    private final ProgressDialog dialog=new ProgressDialog(ThreedListViewActivity.this);

    @Override
    protected Void doInBackground(Void... params) {

        XMLParser parser = new XMLParser();
        String xml = parser.getXmlFromUrl(URL); // getting XML from URL
        Document doc = parser.getDomElement(xml); // getting DOM element

        NodeList nl = doc.getElementsByTagName(KEY_SONG);
        // looping through all song nodes <song>
        for (int i = 0; i < nl.getLength(); i++) {
            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();
            Element e = (Element) nl.item(i);
            // adding each child node to HashMap key => value
            map.put(KEY_ID, parser.getValue(e, KEY_ID));
            map.put(KEY_TITLE, parser.getValue(e, KEY_TITLE));
            map.put(KEY_ARTIST, parser.getValue(e, KEY_ARTIST));
            map.put(KEY_DURATION, parser.getValue(e, KEY_DURATION));
            map.put(KEY_THUMB_URL, parser.getValue(e, KEY_THUMB_URL));

            // adding HashList to ArrayList
            songsList.add(map);
        }
        return null;
    }

    @Override
    protected void onPreExecute()
    {
        dialog.setMessage("Loading ...");
        dialog.show();
        dialog.setCancelable(false);
    }

    @Override
    protected void onPostExecute(Void result)
    {
        if(dialog.isShowing() == true)
        {
            dialog.dismiss();
        }
         // Getting adapter by passing xml data ArrayList

        list.setAdapter(adapter);

    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {

    MenuInflater inflater = getMenuInflater();

    inflater.inflate(R.menu.action_items, menu);

    return true;
}

} 
```

ThreedListAdapterFilterable.java

```
public class ThreedListAdapterFilterable extends BaseAdapter implements Filterable {

private Activity activity;
ArrayList<HashMap<String, String>> mDataShown;
ArrayList<HashMap<String, String>> mAllData;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 

public ThreedListAdapterFilterable(Activity a, ArrayList<HashMap<String, String>> d) {
    activity = a;
    mDataShown= (ArrayList<HashMap<String, String>>) d;
    mAllData = (ArrayList<HashMap<String, String>>) mDataShown.clone();
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader=new ImageLoader(activity.getApplicationContext());
}

public int getCount() {
    return mDataShown.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {

        View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.threed_listrow, null);

        TextView title = (TextView)vi.findViewById(R.id.title); // title
        TextView artist = (TextView)vi.findViewById(R.id.artist); // artist name
        TextView duration = (TextView)vi.findViewById(R.id.duration); // duration
        ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

        HashMap<String, String> song = new HashMap<String, String>();
        song = mDataShown.get(position);

        // Setting all values in listview
        title.setText(song.get(ThreedListViewActivity.KEY_TITLE));
        artist.setText(song.get(ThreedListViewActivity.KEY_ARTIST));
        duration.setText(song.get(ThreedListViewActivity.KEY_DURATION));
        imageLoader.DisplayImage(song.get(ThreedListViewActivity.KEY_THUMB_URL), thumb_image);
        return vi;
}

public Filter getFilter() {
     Filter nameFilter = new Filter() {

            @SuppressWarnings("unchecked")
            @Override
           public String convertResultToString(Object resultValue) {
                return ((HashMap<String, String>)(resultValue)).get(ThreedListViewActivity.KEY_TITLE);
           }

            @Override
            protected FilterResults performFiltering(CharSequence s) {

                 if(s != null)
                    {
                     ArrayList<HashMap<String, String>> tmpAllData = mAllData;
                     ArrayList<HashMap<String, String>> tmpDataShown = mDataShown;
                     tmpDataShown.clear();  
                     for(int i = 0; i < tmpAllData.size(); i++)
                     {
                      if(tmpAllData.get(i).get(ThreedListViewActivity.KEY_TITLE).toLowerCase().startsWith(s.toString().toLowerCase()))
                      {
                       tmpDataShown.add(tmpAllData.get(i));
                      }
                     }

                     FilterResults filterResults = new FilterResults();
                     filterResults.values = tmpDataShown;
                     filterResults.count = tmpDataShown.size();
                     return filterResults;
                    }
                    else
                    {
                     return new FilterResults();
                    }
            }

            @Override
               protected void publishResults(CharSequence s,
                 FilterResults results) {
                if(results != null && results.count > 0)
                {
                 notifyDataSetChanged();
                }
               }};
               return nameFilter;
    }
} 
```

**编辑：** 这是一个更新的适配器，将过滤我的列表。但是，当我退格输入文本中的文本时，它不会更新我的列表。

```
public class ProjectListAdapter extends BaseAdapter implements Filterable{

private Activity activity;
ArrayList<HashMap<String, String>> mDataShown;
ArrayList<HashMap<String, String>> mAllData;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 
HashMap<String, String> song = new HashMap<String, String>();
ArrayList<HashMap<String, String>> filteredItems;

public ProjectListAdapter(Activity a, ArrayList<HashMap<String, String>> d) {

    activity = a;
    mDataShown= (ArrayList<HashMap<String, String>>) d;
    mAllData = (ArrayList<HashMap<String, String>>) mDataShown.clone();
    filteredItems = mDataShown;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader=new ImageLoader(activity.getApplicationContext());
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return mDataShown.size();
}

@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return position;
}

@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View vi;

    if(convertView==null){
        vi=new View(activity);
        vi = inflater.inflate(R.layout.recents_listrow, null);
    }else{
        vi = (View)convertView;
    }
    TextView title = (TextView)vi.findViewById(R.id.title); // title
    TextView artist = (TextView)vi.findViewById(R.id.company); // artist name
    ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image
    title.setText(filteredItems.get(position).get(RecentsFragment.KEY_TITLE));
    artist.setText(filteredItems.get(position).get(RecentsFragment.KEY_COMPANY));
    imageLoader.DisplayImage(filteredItems.get(position).get(RecentsFragment.KEY_THUMB_URL), thumb_image);

    return vi;

}

public Filter getFilter() {
     Filter nameFilter = new Filter() {

            @Override
            protected FilterResults performFiltering(CharSequence constraint) {

                if(constraint != null && constraint.toString().length() > 0) {
                    constraint = constraint.toString().toUpperCase();
                    ArrayList<HashMap<String, String>> filt = mDataShown;
                    ArrayList<HashMap<String, String>> tmpItems = mAllData;
                    filt.clear();
                                    for(int i = 0; i < tmpItems.size(); i++) {

                                      if(tmpItems.get(i).get(RecentsFragment.KEY_TITLE).toLowerCase().startsWith(constraint.toString().toLowerCase()))
                                      {
                                          filt.add(tmpItems.get(i));
                                      }
                                    }
                                    FilterResults filterResults = new FilterResults();
                                    filterResults.count = filt.size();
                                    filterResults.values = filt;
                                    return filterResults;
                               }else{
                                   return new FilterResults();
                                  }

            }

            @Override
               protected void publishResults(CharSequence constraint,
                 FilterResults results) {

                mDataShown = (ArrayList<HashMap<String, String>>)results.values;

                if (results.count > 0) {
                    notifyDataSetChanged();
                } else {
                    notifyDataSetInvalidated();
                }

               }
            };

               return nameFilter;
 }

} 
```

我正在尝试实现的列表片段：RecentsFragment

```
public class RecentsFragment extends ListFragment {

// All static variables
static final String URL = "http://www.sundancepost.com/ivue/projects.xml";
// XML node keys
static final String KEY_PROJECT = "project"; // parent node
static final String KEY_TITLE = "title";
static final String KEY_COMPANY = "company";
static final String KEY_THUMB_URL = "thumb_url";
int mCurCheckPosition = 0;

ListView list;
ProjectListAdapter adapter;
ArrayList<HashMap<String, String>> projectsList = new ArrayList<HashMap<String, String>>();
EditText filterText = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRetainInstance(true);

}

 @Override
 public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) { 
     View view = inflater.inflate(R.layout.recents_list, container, false);
     list = (ListView)view.findViewById(android.R.id.list);
     filterText = (EditText)view.findViewById(R.id.filter_box);

     return view;
 }

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    if(null == savedInstanceState){

        ConnectivityManager cMgr = (ConnectivityManager)getActivity().getSystemService(Context.CONNECTIVITY_SERVICE);
        if (cMgr.getActiveNetworkInfo() != null && cMgr.getActiveNetworkInfo().isConnectedOrConnecting()) {

            new MyAsyncTask().execute();

        } else {
             AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
             builder.setMessage("Please check your internet connection");
             builder.setTitle("Failed to download resources");
             builder.setCancelable(false);
             builder.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {
                           return;
                       }
                   });
            AlertDialog alert = builder.create();
            alert.show();
        }
    }

    adapter = new ProjectListAdapter(getActivity(), projectsList);
    list.requestFocus();
    list.setTextFilterEnabled(true);
    filterText.addTextChangedListener(filterTextWatcher);

    list.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            Intent intent = new Intent(getActivity(), DetailsActivity.class);
            intent.putExtra("title",projectsList.get(position).get(KEY_TITLE));
            intent.putExtra("company", projectsList.get(position).get(KEY_COMPANY));

            startActivity(intent);

        }
    });

}

@Override
public void onSaveInstanceState(Bundle outState){
    super.onSaveInstanceState(outState);
    outState.putInt("workaround", mCurCheckPosition);
}

private TextWatcher filterTextWatcher = new TextWatcher() {

    public void afterTextChanged(Editable s) {
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        adapter.getFilter().filter(s);
    }

};

@Override
public void onDestroy() {
    super.onDestroy();
    filterText.removeTextChangedListener(filterTextWatcher);
}

public class MyAsyncTask extends AsyncTask<Void,Void,Void>{

    private final ProgressDialog recents_dialog = new ProgressDialog(getActivity());

    @Override
    protected Void doInBackground(Void... params) {

        XMLParser parser = new XMLParser();
        String xml = parser.getXmlFromUrl(URL); // getting XML from URL
        Document doc = parser.getDomElement(xml); // getting DOM element

        NodeList nl = doc.getElementsByTagName(KEY_PROJECT);
        // looping through all song nodes <song>
        for (int i = 0; i < nl.getLength(); i++) {
            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();
            Element e = (Element) nl.item(i);
            // adding each child node to HashMap key => value
            map.put(KEY_TITLE, parser.getValue(e, KEY_TITLE));
            map.put(KEY_COMPANY, parser.getValue(e, KEY_COMPANY));
            map.put(KEY_THUMB_URL, parser.getValue(e, KEY_THUMB_URL));

            // adding HashList to ArrayList
            projectsList.add(map);
        }
        return null;
    }

    @Override
    protected void onPreExecute()
    {
        projectsList.clear();
        recents_dialog.setMessage("Loading ...");
        recents_dialog.show();
        recents_dialog.setCancelable(false);
    }

    @Override
    protected void onPostExecute(Void result)
    {
        if(recents_dialog.isShowing() == true)
        {
            recents_dialog.dismiss();
        }
         // Getting adapter by passing xml data ArrayList

        list.setAdapter(adapter);

    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T09:06:43.200

公共类 FriendsListActivity 扩展 Activity 实现 OnClickListener { private Handler mHandler; 静态最终字符串 KEY_ID = "id"; 静态最终字符串 KEY_NAME = "名称"; 静态最终字符串 KEY_INSTALLED = "已安装"; 静态最终字符串 KEY_THUMB_URL = "图片"; 受保护的 ListView 好友列表；受保护的静态 JSONArray jsonArray; FriendsListAdapter 适配器；ArrayList>好友列表；编辑文本过滤器文本；字符串 apiResponse；按键播放、邀请；

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.friends_list);
    friendslist = new ArrayList<HashMap<String, String>>();
    mHandler = new Handler();
    ActionBar actionBar = (ActionBar) findViewById(R.id.actionbar);
    actionBar.setTitle("Facebook Friends");
    actionBar.setHomeAction(new IntentAction(this, TruthorDareActivity
            .createIntent(this), R.drawable.ic_home));
    friendsList = (ListView) findViewById(R.id.friendsList);
    filterText = (EditText) findViewById(R.id.searchBox);
    filterText.addTextChangedListener(filterTextWatcher);
    friendsList.setTextFilterEnabled(true);
    friendsList.requestFocus();
    play = (Button) findViewById(R.id.play);
    invite = (Button) findViewById(R.id.invite);
    play.setOnClickListener(this);
    invite.setOnClickListener(this);
    Bundle extras = getIntent().getExtras();
    apiResponse = extras.getString("API_RESPONSE");
    callPlayList();
}

@Override
public void onBackPressed() {
    super.onBackPressed();
    this.finish();
}

@Override
protected void onResume() {
    super.onResume();
    friendsList.requestFocus();
}

public void callPlayList() {
    try {
        jsonArray = new JSONObject(apiResponse).getJSONArray("data");
        for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject json_data = jsonArray.getJSONObject(i);
            if (json_data.has("installed")
                    && json_data.getBoolean("installed") == true) {
                HashMap<String, String> map = new HashMap<String, String>();
                map.put(KEY_ID, json_data.getString("id"));
                map.put(KEY_NAME, json_data.getString("name"));
                map.put(KEY_THUMB_URL, json_data.getString("picture"));
                map.put(KEY_INSTALLED, json_data.getString("installed"));
                friendslist.add(map);
            }
        }

    } catch (JSONException e) {
        showToast("Error: " + e.getMessage());
        return;
    }
    adapter = new FriendsListAdapter(FriendsListActivity.this, friendslist);
    friendsList.setAdapter(adapter);

}

public void callInviteList() {
    try {
        jsonArray = new JSONObject(apiResponse).getJSONArray("data");
        for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject json_data = jsonArray.getJSONObject(i);
            if (!json_data.has("installed")) {
                HashMap<String, String> map = new HashMap<String, String>();
                map.put(KEY_ID, json_data.getString("id"));
                map.put(KEY_NAME, json_data.getString("name"));
                map.put(KEY_THUMB_URL, json_data.getString("picture"));
                map.put(KEY_INSTALLED, "false");
                friendslist.add(map);
            }
        }

    } catch (JSONException e) {
        showToast("Error: " + e.getMessage());
        return;
    }
    adapter = new FriendsListAdapter(FriendsListActivity.this, friendslist);
    friendsList.setAdapter(adapter);
}

public void clearAdapter(String params) {
    friendslist.clear();
    adapter.notifyDataSetChanged();
    adapter.notifyDataSetInvalidated();
    if (params.equals("invite")) {
        callInviteList();
    } else {
        callPlayList();
    }

}

public class PostDialogListener extends BaseDialogListener {
    @Override
    public void onComplete(Bundle values) {
        final String postId = values.getString("post_id");
        if (postId != null) {
            showToast("Message posted on the wall.");
        } else {
            showToast("No message posted on the wall.");
        }
    }
}

public void showToast(final String msg) {
    mHandler.post(new Runnable() {
        @Override
        public void run() {
            Toast toast = Toast.makeText(FriendsListActivity.this, msg,
                    Toast.LENGTH_LONG);
            toast.show();
        }
    });
}

private TextWatcher filterTextWatcher = new TextWatcher() {

    public void afterTextChanged(Editable s) {
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        adapter.getFilter().filter(s);
    }

};

@Override
protected void onDestroy() {
    super.onDestroy();
    filterText.removeTextChangedListener(filterTextWatcher);
}

@Override
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.play:
        clearAdapter("play");
        break;
    case R.id.invite:
        clearAdapter("invite");
        break;
    default:
        break;
    }

} 
```

}

> 下一部分是我在单独的类文件中使用的适配器类。

```
public class FriendsListAdapter extends BaseAdapter implements Filterable {

private Activity activity;
public ArrayList<HashMap<String, String>> data;
public ArrayList<HashMap<String, String>> allData;
public HashMap<String, String> friends;
private static LayoutInflater inflater = null;
public ImageLoader imageLoader;
private ItemsFilter mFilter;
static SharedPreferences TODLoginPrefs;

@SuppressWarnings({ "unchecked", "static-access" })
public FriendsListAdapter(Activity a, ArrayList<HashMap<String, String>> d) {
    activity = a;
    data = (ArrayList<HashMap<String, String>>) d;
    allData = (ArrayList<HashMap<String, String>>) data.clone();
    inflater = (LayoutInflater) activity
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader = new ImageLoader(activity.getApplicationContext());
    TODLoginPrefs = activity.getSharedPreferences("LogInSession",
            activity.MODE_PRIVATE);

}

public int getCount() {
    return data.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;
    if (convertView == null)
        vi = inflater.inflate(R.layout.friends_list_row, null);

    TextView user = (TextView) vi.findViewById(R.id.gname);
    Button play = (Button) vi.findViewById(R.id.btnPlay);
    Button invite = (Button) vi.findViewById(R.id.btnInvite);
    ImageView thumb_image = (ImageView) vi.findViewById(R.id.list_image);

    friends = new HashMap<String, String>();
    friends = data.get(position);

    user.setText(friends.get(FriendsListActivity.KEY_NAME));
    imageLoader.DisplayImage(
            friends.get(FriendsListActivity.KEY_THUMB_URL), thumb_image);
    final String friendrId = (friends.get(FriendsListActivity.KEY_ID));
    final String name = (friends.get(FriendsListActivity.KEY_NAME));
    final String installed = (friends
            .get(FriendsListActivity.KEY_INSTALLED));
    if (installed.equals("false")) {
        play.setVisibility(View.GONE);
        invite.setVisibility(View.VISIBLE);
    }
    play.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            new AlertDialog.Builder(activity)
                    .setTitle("Create game with " + name + "?")
                    .setPositiveButton(R.string.yes,
                            new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog,
                                        int which) {
                                    UserFunction userFunction = new UserFunction();
                                    JSONObject json_game = userFunction
                                            .newGame(
                                                    activity,
                                                    "Facebook",
                                                    TODLoginPrefs
                                                            .getString(
                                                                    "UserID",
                                                                    ""),
                                                    friendrId, null, null);
                                    if (json_game.has("success")) {
                                        activity.startActivity(new Intent(
                                                activity,
                                                TruthorDareActivity.class));
                                    } else {
                                        try {
                                            Toast.makeText(
                                                    activity,
                                                    json_game
                                                            .getString("error_msg"),
                                                    Toast.LENGTH_SHORT)
                                                    .show();
                                        } catch (JSONException e) {
                                            e.printStackTrace();
                                        }
                                    }
                                }

                            }).setNegativeButton(R.string.no, null).show();

        }
    });
    invite.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            new AlertDialog.Builder(activity)
                    .setTitle("Invite " + name + "?")
                    .setPositiveButton(R.string.yes,
                            new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog,
                                        int which) {
                                    UserFunction userFunction = new UserFunction();
                                    JSONObject json_game = userFunction
                                            .newInvite(
                                                    activity,
                                                    "Facebook",
                                                    TODLoginPrefs
                                                            .getString(
                                                                    "UserID",
                                                                    ""),
                                                    friendrId, null, null);
                                    if (json_game.has("success")) {
                                        Bundle params = new Bundle();
                                        params.putString("to", friendrId);
                                        params.putString(
                                                "message",
                                                activity.getResources()
                                                        .getString(
                                                                R.string.app_request_message));
                                        Utilities.facebook.dialog(activity,
                                                "apprequests", params,
                                                new AppRequestsListener());
                                    } else {
                                        try {
                                            Toast.makeText(
                                                    activity,
                                                    json_game
                                                            .getString("error_msg"),
                                                    Toast.LENGTH_SHORT)
                                                    .show();
                                        } catch (JSONException e) {
                                            e.printStackTrace();
                                        }
                                    }
                                }

                            }).setNegativeButton(R.string.no, null).show();

        }
    });
    return vi;
}

@Override
public Filter getFilter() {
    if (mFilter == null) {
        mFilter = new ItemsFilter();
    }
    return mFilter;
}

private class ItemsFilter extends Filter {
    @SuppressWarnings("unchecked")
    @Override
    public String convertResultToString(Object resultValue) {
        return ((HashMap<String, String>) (resultValue))
                .get(FriendsListActivity.KEY_NAME);
    }

    @Override
    protected FilterResults performFiltering(CharSequence s) {

        if (s != null) {
            ArrayList<HashMap<String, String>> tmpAllData = allData;
            ArrayList<HashMap<String, String>> tmpDataShown = data;
            tmpDataShown.clear();
            for (int i = 0; i < tmpAllData.size(); i++) {
                if (tmpAllData.get(i).get(FriendsListActivity.KEY_NAME)
                        .toLowerCase()
                        .startsWith(s.toString().toLowerCase())) {
                    tmpDataShown.add(tmpAllData.get(i));
                }
            }

            FilterResults filterResults = new FilterResults();
            filterResults.values = tmpDataShown;
            filterResults.count = tmpDataShown.size();
            return filterResults;
        } else {
            return new FilterResults();
        }
    }

    @SuppressWarnings("unchecked")
    protected void publishResults(CharSequence prefix, FilterResults results) {
        data = (ArrayList<HashMap<String, String>>) results.values;
        if (results.count > 0) {
            notifyDataSetChanged();
        } else {
            notifyDataSetInvalidated();
        }
    }
}

public class AppRequestsListener extends BaseDialogListener {
    @Override
    public void onComplete(Bundle values) {
        Toast.makeText(activity, "App request sent", Toast.LENGTH_SHORT)
                .show();
        activity.startActivity(new Intent(activity,
                TruthorDareActivity.class));
    }

    @Override
    public void onFacebookError(FacebookError error) {
        Toast.makeText(activity, "Facebook Error: " + error.getMessage(),
                Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onCancel() {
        Toast.makeText(activity, "App request cancelled",
                Toast.LENGTH_SHORT).show();
    }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T13:22:46.013

在 getFilter() 方法中试试这个

@Override protected void publishResults(CharSequence 约束，FilterResults 结果) {

```
 mDataShown = (ArrayList<HashMap<String, String>>)results.values;
            ProjectListAdapter.this.setListData(mDataShown);
            ProjectListAdapter.this.notifyDataSetChanged();
        }; 
```

并在退格上刷新列表

私有 TextWatcher filterTextWatcher = new TextWatcher() {

```
public void afterTextChanged(Editable s) {
}

public void beforeTextChanged(CharSequence s, int start, int count,
        int after) {
}

public void onTextChanged(CharSequence s, int start, int before,
        int count) {
    if(s.toString().equalsIgnoreCase(""))
    {
     adapter.setListData(projectListdata)
     adapter.notifyDataSetChanged();
    }
    else
     adapter.getFilter().filter(s);
} 
```

};

# pmd - 最重要的 PMD 违规行为是什么？

> ID：10290616
> 
> 赞同：1
> 
> 时间：2012-04-24T01:32:13.320
> 
> 标签：pmd

我正在将 PMD 推广到我的项目中，第一次运行已获得超过 4000 次违规。我想对违规行为进行优先排序，因此我希望筛选出我的团队可以关注的 100 个最不可接受的违规行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:58:38.113

您可以查看规则名称并决定哪个是最关键的。或者您可以浏览可用的规则，只打开最关键的。在不了解您的项目或触发什么规则的情况下，无法说出最重要的是什么。另外，这是主观的。许多规则对应用程序同样致命。

在 Eclipse 中，您可以让它运行最高严重性规则，这是您尝试完成的一个很好的代理。

# php - 使用 zend 的 Blogger 类型虚荣 url

> ID：10290620
> 
> 赞同：1
> 
> 时间：2012-04-24T01:32:52.347
> 
> 标签：php, zend-framework, blogger

如果有人向我解释如何在 zend 中生成虚 url，那就太好了。我打算编写一个博客，我希望它的帖子具有[http://www.example.com/2012/6/24 格式的链接。博客标题](http://www.example.com/2012/6/24.blog-title)。我对 zend 很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:13:09.530

首先，您将创建一个控制器，比如说 dateAction，它接受日期作为输入参数并根据这些日期列出文章。假设您在文章控制器中创建了 dateAction。

所以让这个网址完成工作`www.example.com/article/date/year/2012/month/06/day/24/title/abcdef`

第一的

但是现在你想把它变成漂亮的东西所以使用 Zend_Router

之后，您将希望在引导程序中创建一条路线

```
$route = new Zend_Controller_Router_Route_Regex(
    '(\d+)/(\d+)/(\d+)/([a-z0-9]+)',
    array(
        'controller' => 'article',
        'action' => 'date'
    ),
    array(
        1 => 'year',
        2 =>'month',
        3 => 'day',
        4 =>'title'
    )
);

Zend_Controller_Front::getInstance->getRouter()->addRoute('article',$route); 
```

现在 url`http://www.example.com/2012/6/24/blog-title`将与 `www.example.com/article/date/year/2012/month/06/day/24/title/abcdef`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T03:06:09.597

你想要创造的东西通常被称为蛞蝓。我不知道 Zend 框架中内置了任何用于生成 slug 的内容，因此您需要自己生成一个。这是一个非常简单的生成 slug 的方法。

```
$slug = preg_replace("/[^a-zA-Z0-9 ]/", "", $title);
$slug = str_replace(" ", "-", $slug); 
```

为了使其更健壮，您应该检查您生成的 slug 是否已存在于数据库中。如果是这样，您可以自动在末尾添加一个数字。例如，如果“this-blog-post”已经存在，请尝试“this-blog-post-1”。

除了生成 slug 之外，您还需要遵循 zerkms 的评论并在 Zend 配置中添加一个路由，该路由会将这个 slug 传递给您的控制器。

# mongodb - 如何部分更新 MongoDB 中的对象，以便新对象与现有对象重叠/合并

> ID：10290621
> 
> 赞同：238
> 
> 时间：2012-04-24T01:33:01.960
> 
> 标签：mongodb, mongodb-java

鉴于此文档保存在 MongoDB

```
{
   _id : ...,
   some_key: { 
        param1 : "val1",
        param2 : "val2",
        param3 : "val3"
   }
} 
```

需要保存具有来自外部世界的新信息的`param2`对象`param3`

```
var new_info = {
    param2 : "val2_new",
    param3 : "val3_new"
}; 
```

我想在对象的现有状态上合并/覆盖新字段，这样 param1 就不会被删除

这样做

```
db.collection.update(  { _id:...} , { $set: { some_key : new_info  } } 
```

将导致 MongoDB 完全按照要求执行，并将 some_key 设置为该值。更换旧的。

```
{
   _id : ...,
   some_key: { 
      param2 : "val2_new",
      param3 : "val3_new"
   }
} 
```

让 MongoDB 只更新新字段的方法是什么（没有明确地一一说明）？得到这个：

```
{
   _id : ...,
   some_key: { 
        param1 : "val1",
        param2 : "val2_new",
        param3 : "val3_new"
   }
} 
```

我正在使用 Java 客户端，但任何示例都将不胜感激

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-04-20T10:14:32.387

我用自己的功能解决了它。如果您想更新文档中的指定字段，您需要清楚地解决它。

例子：

```
{
    _id : ...,
    some_key: { 
        param1 : "val1",
        param2 : "val2",
        param3 : "val3"
    }
} 
```

如果您只想更新 param2，则这样做是错误的：

```
db.collection.update(  { _id:...} , { $set: { some_key : new_info  } }  //WRONG 
```

您必须使用：

```
db.collection.update(  { _id:...} , { $set: { some_key.param2 : new_info  } } 
```

* * *

所以我写了一个类似的函数：

```
function _update($id, $data, $options=array()){

    $temp = array();
    foreach($data as $key => $value)
    {
        $temp["some_key.".$key] = $value;
    } 

    $collection->update(
        array('_id' => $id),
        array('$set' => $temp)
    );

}

_update('1', array('param2' => 'some data')); 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2012-04-24T01:37:18.550

如果我正确理解了这个问题，您想用另一个文档的内容更新一个文档，但只更新尚未存在的字段，并完全忽略已经设置的字段（即使是另一个值）。

没有办法在单个命令中做到这一点。

您必须首先查询文档，找出您想要的内容`$set`，然后更新它（使用旧值作为匹配过滤器，以确保您不会在两者之间获得并发更新）。

* * *

您的问题的另一种解读是您对 感到满意`$set`，但不想明确设置所有字段。那么你将如何传递数据呢？

您知道您可以执行以下操作：

```
db.collection.update(  { _id:...} , { $set: someObjectWithNewData } 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2015-11-14T17:33:13.447

您可以使用点符号来访问和设置对象深处的字段，而不会影响这些对象的其他属性。

鉴于您在上面指定的对象：

```
> db.test.insert({"id": "test_object", "some_key": {"param1": "val1", "param2": "val2", "param3": "val3"}})
WriteResult({ "nInserted" : 1 }) 
```

我们可以只更新`some_key.param2`和`some_key.param3`：

```
> db.test.findAndModify({
... query: {"id": "test_object"},
... update: {"$set": {"some_key.param2": "val2_new", "some_key.param3": "val3_new"}},
... new: true
... })
{
    "_id" : ObjectId("56476e04e5f19d86ece5b81d"),
    "id" : "test_object",
    "some_key" : {
        "param1" : "val1",
        "param2" : "val2_new",
        "param3" : "val3_new"
    }
} 
```

您可以随心所欲地深入研究。这对于在不影响现有属性的情况下向对象添加新属性也很有用。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2016-09-06T20:43:02.490

最好的解决方案是从对象中提取属性并使其成为平面点符号键值对。例如，您可以使用这个库：

[https://www.npmjs.com/package/mongo-dot-notation](https://www.npmjs.com/package/mongo-dot-notation)

它具有`.flatten`允许您将对象更改为一组平面属性的功能，然后可以将其赋予 $set 修饰符，而不必担心现有数据库对象的任何属性都将被删除/覆盖而无需担心。

取自`mongo-dot-notation`文档：

```
var person = {
  firstName: 'John',
  lastName: 'Doe',
  address: {
    city: 'NY',
    street: 'Eighth Avenu',
    number: 123
  }
};

var instructions = dot.flatten(person)
console.log(instructions);
/* 
{
  $set: {
    'firstName': 'John',
    'lastName': 'Doe',
    'address.city': 'NY',
    'address.street': 'Eighth Avenu',
    'address.number': 123
  }
}
*/ 
```

然后它形成完美的选择器——它只会更新给定的属性。编辑：有时我喜欢成为考古学家；）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-04-24T01:40:12.720

Mongo 允许您使用`.`约定更新嵌套文档。看一看：[更新 mongodb 中的嵌套文档](https://stackoverflow.com/questions/1145956/updating-nested-documents-in-mongodb)。这是过去关于合并更新的另一个问题，就像我相信的那样：[MongoDB atomic update via 'merge' document](https://stackoverflow.com/questions/5965181/mongodb-atomic-update-via-merge-document)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2019-06-14T19:35:43.373

从`Mongo 4.2`, [`db.collection.updateMany()`](https://docs.mongodb.com/v5.0/reference/method/db.collection.updateMany/)(或[`db.collection.update()`](https://docs.mongodb.com/master/reference/method/db.collection.update/index.html#db.collection.update)) 开始可以接受一个聚合管道，它允许使用聚合运算符，例如[`$addFields`](https://docs.mongodb.com/master/reference/operator/aggregation/addFields/index.html)，它输出输入文档中的所有现有字段和新添加的字段：

```
var new_info = { param2: "val2_new", param3: "val3_new" }

// { some_key: { param1: "val1", param2: "val2", param3: "val3" } }
// { some_key: { param1: "val1", param2: "val2"                 } }
db.collection.updateMany({}, [{ $addFields: { some_key: new_info } }])
// { some_key: { param1: "val1", param2: "val2_new", param3: "val3_new" } }
// { some_key: { param1: "val1", param2: "val2_new", param3: "val3_new" } } 
```

*   第一部分`{}`是匹配查询，过滤要更新的文档（在本例中为所有文档）。

*   第二部分`[{ $addFields: { some_key: new_info } }]`是更新聚合管道：

    *   请注意表示使用聚合管道的方括号。
    *   由于这是一个聚合管道，我们可以使用[`$addFields`](https://docs.mongodb.com/master/reference/operator/aggregation/addFields/index.html).
    *   `$addFields`完全执行您需要的操作：更新对象，以便新对象将与现有对象重叠/合并：
    *   在这种情况下，`{ param2: "val2_new", param3: "val3_new" }`将`some_key`通过保持`param1`不变并添加或替换两者来合并到现有的`param2`和`param3`。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-07-24T16:48:52.507

我以这种方式成功地做到了：

```
db.collection.update(  { _id:...} , { $set: { 'key.another_key' : new_info  } } ); 
```

我有一个动态处理我的**个人资料**更新的功能

```
function update(prop, newVal) {
  const str = `profile.${prop}`;
  db.collection.update( { _id:...}, { $set: { [str]: newVal } } );
} 
```

注意：'profile' 特定于我的实现，它只是您要修改的键的字符串。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-12-09T21:58:47.110

你可以做一个 upsert，MongoDB 中的这个操作用于将文档保存到集合中。如果文档匹配查询条件，那么它将执行更新操作，否则它将插入一个新文档到集合中。

类似于下面的东西

```
db.employees.update(
    {type:"FT"},
    {$set:{salary:200000}},
    {upsert : true}
 ) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-07-28T16:42:38.240

```
 // where clause DBObject
    DBObject query = new BasicDBObject("_id", new ObjectId(id));

    // modifications to be applied
    DBObject update = new BasicDBObject();

    // set new values
    update.put("$set", new BasicDBObject("param2","value2"));

   // update the document
    collection.update(query, update, true, false); //3rd param->upsertFlag, 4th param->updateMultiFlag 
```

如果您有多个字段要更新

```
 Document doc = new Document();
        doc.put("param2","value2");
        doc.put("param3","value3");
        update.put("$set", doc); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-11-25T15:03:08.370

您可以`$mergeObjects`在基于聚合的更新中使用。就像是

```
db.collection.update(
   { _id:...},
   [{"$set":{
      "some_key":{
        "$mergeObjects":[
          "$some_key",
          new info or { param2 : "val2_new", param3 : "val3_new"}
       ]
      }
   }}]
) 
```

更多示例[`here`](https://docs.mongodb.com/master/reference/command/update/index.html#update-command-example-agg)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-04-24T01:41:52.503

看起来你可以设置[isPartialObject](http://api.mongodb.org/java/2.6/com/mongodb/DBObject.html#isPartialObject%28%29)这可能会完成你想要的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-11-23T03:44:10.537

```
db.collection.update(  { _id:...} , { $set: { some_key : new_info  } } 
```

到

```
db.collection.update( { _id: ..} , { $set: { some_key: { param1: newValue} } } ); 
```

希望这有帮助！

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-01-31T03:11:35.467

您必须使用嵌入式文档（对路径对象进行字符串化）

```
let update = {}
Object.getOwnPropertyNames(new_info).forEach(param => {
   update['some_key.' + param] = new_info[param]
}) 
```

因此，在 JavaScript 中，您可以使用扩展运算符 (...) 来更新

```
db.collection.update(  { _id:...} , { $set: { ...update  } } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-01T19:37:01.803

是的，最好的方法是将对象表示法转换为平面键值字符串表示，如此评论中所述：[https ://stackoverflow.com/a/39357531/2529199](https://stackoverflow.com/a/39357531/2529199)

我想强调一个使用这个 NPM 库的替代方法：[https](https://www.npmjs.com/package/dot-object) ://www.npmjs.com/package/dot-object ，它可以让你使用点符号来操作不同的对象。

当接受键值作为函数变量时，我使用此模式以编程方式创建嵌套对象属性，如下所示：

```
const dot = require('dot-object');

function(docid, varname, varvalue){
  let doc = dot.dot({
      [varname]: varvalue 
  });

  Mongo.update({_id:docid},{$set:doc});
} 
```

这种模式让我可以交替使用嵌套属性和单级属性，并将它们干净地插入到 Mongo 中。

如果您需要在 Mongo 之外使用 JS 对象，尤其是在客户端，但在使用 Mongo 时要保持一致性，那么这个库为您提供了比前面提到的`mongo-dot-notation`NPM 模块更多的选项。

*PS 我最初只是想将其作为评论提及，但显然我的 S/O 代表还不够高，无法发表评论。因此，不想强加 SzybkiSasza 的评论，只是想强调提供替代模块。*

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-01-14T23:06:32.680

我试图`findAndModify()`更新预先存在的对象中的特定字段。

[https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/](https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-03T12:19:15.030

使用 $set 做这个过程

```
.update({"_id": args.dashboardId, "viewData._id": widgetId}, {$set: {"viewData.$.widgetData": widgetDoc.widgetData}})
.exec()
.then(dashboardDoc => {
    return {
        result: dashboardDoc
    };
}); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-06-08T23:23:17.757

使用属性名称创建一个更新对象，包括必要的点路径。（“somekey.”+ 来自 OP 的示例），然后使用它进行更新。

```
//the modification that's requested
updateReq = { 
   param2 : "val2_new",
   param3 : "val3_new"   
}

//build a renamed version of the update request
var update = {};
for(var field in updateReq){
    update["somekey."+field] = updateReq[field];
}

//apply the update without modifying fields not originally in the update
db.collection.update({._id:...},{$set:update},{upsert:true},function(err,result){...}); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-09-15T12:46:57.440

您应该考虑交替更新对象，然后简单地将对象与更新的字段一起存储。像下面做的事情

```
function update(_id) {
    return new Promise((resolve, reject) => {

        ObjModel.findOne({_id}).exec((err, obj) => {

            if(err) return reject(err)

            obj = updateObject(obj, { 
                some_key: {
                    param2 : "val2_new",
                    param3 : "val3_new"
                }
            })

            obj.save((err, obj) => {
                if(err) return reject(err)
                resolve(obj)
            })
        })
    })
}

function updateObject(obj, data) {

    let keys = Object.keys(data)

    keys.forEach(key => {

        if(!obj[key]) obj[key] = data[key]

        if(typeof data[key] == 'object') 
            obj[key] = updateObject(obj[key], data[key])
        else
            obj[key] = data[key]
    })

    return obj
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-23T15:08:57.087

如果你想更新一个对象的多个字段，你可以试试这个：-

```
 let fieldsToUpdate = {};
 for (const key in allFields) {
 const fieldName = `flags.${key}`;   // define field as string literal
     fieldsToUpdate[fieldName] = allFields[key];
 }
 db.collection.updateOne(query, { $set: { ...fieldsToUpdate } } ); 
```

# nlp - NLP - 提高模糊字符串匹配的运行时间和召回率

> ID：10290626
> 
> 赞同：0
> 
> 时间：2012-04-24T01:33:28.577
> 
> 标签：nlp, fuzzy-search, tf-idf, jaro-winkler

我已经制定了一个有效的算法，但运行时间非常可怕。是的，我从一开始就知道这将是可怕的，但不是那么多。对于仅 200000 条记录，程序运行了一个多小时。

基本上我正在做的是：

```
for each searchfield in search fields
    for each sample in samples
        do a q-gram matching
    if there are matches then return it
    else
        split the searchfield into uniwords
        for each sample in samples
            split sample into uniwords
            for each uniword in samples
                if the uniword is a known abbreviation
                    then search the dictionary for its full word or other known abbr
                else do a jaro-winkler matching
            average the distances of all the uniwords
            if the average is above threshold then make it as a match and break
        end for
        if there is a match make a comment that it matched one of the samples partially
    end else
end for 
```

是的，这段代码非常循环愉快。我正在使用蛮力，因为召回非常重要。所以，我想知道如何让它更快，因为我不仅要为数百万数据运行 200000 个数据，而且客户端的计算机不是高端的（1GB-2GB 的 Ram Pentium 4 或双核，我测试该程序的计算机是具有 4GB 内存的双核）。我遇到了 TF/IDF，但我不知道它是否足够。我想知道谷歌如何进行实时搜索。

提前致谢！

编辑：这个程序是一个数据过滤器。从200,000个虚拟数据（实际数据大约12M）中，我必须过滤与样本无关的数据（500个虚拟样本，我仍然不知道实际样本量有多少）。

使用给定的虚拟数据和样本，运行时间大约为 1 小时，但经过四处修补后，我成功地将其缩短到 10-15 分钟。我通过对以相同字符开头的字段和样本进行分组（不包括特殊和无意义的词，例如 the、a、an）并将字段与具有相同第一个字符的样本进行匹配来减少它。我知道那里有问题。如果该字段在第一个字符处拼写错误怎么办？但我认为这些数量可以忽略不计。样本拼写正确，因为它始终保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:43:11.480

你的编程语言是什么？我想使用 q=2 或 3 就足够了。我还建议从uni gram获得更高的学位。

# php - 添加数据后刷新页面？PHP

> ID：10290637
> 
> 赞同：0
> 
> 时间：2012-04-24T01:34:36.573
> 
> 标签：php, html, refresh

点击提交按钮后有什么方法可以刷新数据吗？目前，当我单击 PHP 页面上的提交按钮时，数据库发生了变化。但是，我将不得不刷新页面本身才能看到更新的结果，我认为这是非常无能的。

另外，我正在做的是在表格上。例如，

1) 14 条狗。

因此，在我将 14 条狗编辑为 13 条狗并提交后，更改成功，如数据库中所示，但除非我刷新页面，否则该值不会更改。谢谢你们。

附加信息：

我正在使用 XAMPP，Microsoft Access。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:40:25.963

在你的脚本中，而不是

```
code that outputs data from database
code that updates database 
```

做

```
code that updates database
code that outputs data from database 
```

我只是改变了顺序。希望其显而易见的原因。

我假设您使用的是常规形式，没有 ajax 或框架。

# google-chrome - github chrome无法加载资源

> ID：10290639
> 
> 赞同：1
> 
> 时间：2012-04-24T01:35:07.333
> 
> 标签：google-chrome, github

不久前，我使用 github 页面做了一个待办事项列表应用程序。它在 safari 下工作正常，但 js 在 chrome 下无法加载。为什么？这是代码：[https ://github.com/randomor/todoingdone](https://github.com/randomor/tododoingdone)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T05:55:10.663

我在 Chrome 控制台中看到的是：

```
Application Cache Cached event
http://ametopia.com/tododoingdone/border.pngFailed to load resource
http://themes.googleusercontent.com/static/fonts/deliusunicase/v6/b2sKujV3Q48RV2PQ0k1vqiiT6GQZqXe56UwGtNcbg_g.woffFailed to load resource 
```

![第一个错误](../Images/b4f7e3573db0b9f1703fc653c5e9703f.png)

这让我想起了“[无法在 Chrome 下加载资源](https://stackoverflow.com/questions/4390134/failed-to-load-resource-under-chrome)”的问题：
这可能是由扩展程序引起的（例如 AdBlock）。

停用 AdBlock（甚至是所有的扩展程序）会导致其他 javascript 加载错误：

![第二个错误](../Images/b1ee201a176249e9ede3e7b186058763.png)

这些由控制台显示为“其他”（而不是“脚本”）错误。
这可能是其他一些查询未能正确返回并阻止所有后续脚本的结果：
例如参见“ [jquery ajax problem in chrome](https://stackoverflow.com/questions/1742049/jquery-ajax-problem-in-chrome) ”。
不过，请检查您的资源，例如您的图像（请参阅“[可调整大小：Chrome 开发工具控制台显示 GET data: undefined (undefined)](http://bugs.jqueryui.com/ticket/7293) ”）。

# ruby-on-rails - Rails - 从字符串数组中下拉

> ID：10290640
> 
> 赞同：12
> 
> 时间：2012-04-24T01:35:12.527
> 
> 标签：ruby-on-rails, forms, drop-down-menu

我有一个这样的数组：

```
['New York', 'Los Angeles'] 
```

我希望能够以如下形式生成具有这些值的选择/选项：

```
<%= form_tag filter_city_path, :method=> get do %>
  <%= select_tag "city", @list_of_cities %>
<% end %> 
```

但这不起作用。如您所见，我想在 url中将选择作为**城市传递。**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-24T01:45:14.510

您需要使用 options_for_select 帮助器，例如

```
<%= select_tag "city", options_for_select([['New York' ,'New york'], ['Los Angeles', 'Los Angeles']]) %> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-08-16T22:16:59.233

我的方法是将数组构建为模型中的常量，强制确认常量中列出的选项，然后从视图中调用它

```
class Show < ApplicationRecord

  DAYS = [ "monday", "tuesday", "wednesday", "thursday","friday", "saturday","sunday"]

  validates :day, inclusion: DAYS

end 
```

如果您希望在没有内容的情况下提交该字段的选项，您还必须在验证中调用 `allow_blank: true'。设置完成后，您可以调用常量来填充表单中的视图，如下所示：

```
<%= select_tag "day", options_for_select(Show::DAYS) %> 
```

或者

```
<%= select_tag "day", options_for_select(Show::DAYS.sort) %> 
```

如果你想要它预先排序（这对于一周中的几天没有意义......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T01:40:54.730

看起来您的数组没有足够的参数。请参阅[本指南](http://guides.rubyonrails.org/form_helpers.html#making-select-boxes-with-ease)。

选项通常需要以这种方式格式化：

```
[['Lisbon', 1], ['Madrid', 2], ...] 
```

记下值`1`,`2`等。

# opengl - OpenGL着色器问题

> ID：10290647
> 
> 赞同：0
> 
> 时间：2012-04-24T01:35:56.937
> 
> 标签：opengl, glsl

我试图加入衰减，但它失败了，什么也没做。

我有漫反射、环境和镜面照明工作。当碎片离光线越来越远时，我只需要调暗光线。

另外，我的灯有衰减参数：

glLightf(GL_LIGHT0, GL_QUADRATIC_ATTENUATION, 0.0004f);

这是地板照明，灯光位于立方体后面：

[http://oi43.tinypic.com/i39fuo.jpg](http://oi43.tinypic.com/i39fuo.jpg)

**.vert**

```
varying vec3 N;
varying vec3 v;
varying vec3 c;
varying float dist;

void main(void)  
{
vec4 ecPos;
vec3 aux;

ecPos = gl_ModelViewMatrix * gl_Vertex;
aux = vec3(gl_LightSource[0].position-ecPos);
dist = length(aux);

c = vec3(gl_Color);
v = vec3(gl_ModelViewMatrix * gl_Vertex);       
N = normalize(gl_NormalMatrix * gl_Normal);
gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;  
} 
```

**.frag**

```
varying vec3 N;
varying vec3 v;
varying vec3 c;    
varying float dist;

void main (void)  
{  
float att;

att = 1.0 / (gl_LightSource[0].constantAttenuation +
            gl_LightSource[0].linearAttenuation * dist +
            gl_LightSource[0].quadraticAttenuation * dist * dist);

vec3 L = normalize(gl_LightSource[0].position.xyz - v);   
vec3 E = normalize(-v); // we are in Eye Coordinates, so EyePos is (0,0,0)  
vec3 R = normalize(-reflect(L,N));      

float nDotL = max(dot(N,L), 0.0);
float rDotE = max(dot(R,E),0.0);
float power = pow(rDotE, gl_FrontMaterial.shininess);

//calculate Ambient Term:  
vec4 Iamb = gl_FrontLightProduct[0].ambient * att;        

//calculate Diffuse Term:  
vec4 Idiff = gl_FrontLightProduct[0].diffuse * nDotL * att;
Idiff = clamp(Idiff, 0.0, 1.0);     

// calculate Specular Term:
vec4 Ispec = gl_FrontLightProduct[0].specular * power * att;
Ispec = clamp(Ispec, 0.0, 1.0); 

// write Total Color:  
gl_FragColor = Iamb + Idiff + Ispec + c;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:45:29.660

从这张图片中，我真的看不到任何东西。将一个小物体设置为光源怎么样？

哪个对象使用这个着色器？

我想到的一些事情：

1.  您在顶点着色器中标准化了您的法线，这是一个不必要的步骤。
    从顶点传递到片段着色器的向量必须在片段着色器内部进行归一化，因为它们将被插值。
    只要您不在顶点着色器中进行任何基于长度的计算，在顶点着色器中就不需要进行标准化。

    您应该标准化片段着色器中的法线，然后您不需要标准化您的反射向量。

2.  衰减不基于在着色器中计算的任何“复杂”。所以输出它，然后检查其余部分。你的漫反射词看起来如何？

3.  进一步提示：
    您可以将光矢量和衰减计算放在顶点着色器中，并将其作为片段着色器传递（将其打包在 4 vec 组件中）以保存插值器。

4.  最终的镜面钳位是不必要的，值应自动在 [0, 1] 范围内。如果不是你有问题。

# database - 浏览实体框架代码优先数据库 + Azure Dev Fabric

> ID：10290648
> 
> 赞同：0
> 
> 时间：2012-04-24T01:35:59.460
> 
> 标签：database, entity-framework, azure, entity-framework-4.1, ef-code-first

我有一个针对 SQL Server Express 使用代码优先方法创建的数据库。我正在尝试在 Management Studio 中查看数据库，但找不到该数据库。VS Database Explorer 似乎也找不到它。

我搜索过但找不到任何关于我所追求的东西的参考。是否可以浏览在开发结构中运行的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:08:26.620

查看 Scott Gu 关于 EF Code First 和 DB 生成的博客文章：[http://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with-entity-framework-4。 aspx](http://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with-entity-framework-4.aspx)

Azure Dev Fabric 与 DB 层无关，连接字符串为您处理所有这些，即当您部署到 SQL Azure 时，您的 DB 将到达那里，唯一需要更改的是连接字符串...来自 localhost (开发机器）到 SQL Azure 连接字符串

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T07:59:53.130

通常如果我们在 Visual Studio 中创建一个新数据库，它会给我们一个数据库文件，但它不会在 SQL Server Management Studio 中注册数据库。所以请手动将数据库文件附加到 SQL Server Management Studio。首先请找到数据库文件，一般在我们项目的AppData文件夹下。然后我建议您查看 [http://msdn.microsoft.com/en-us/library/ms190209.aspx](http://msdn.microsoft.com/en-us/library/ms190209.aspx)以获取有关如何附加数据库的说明。

最好的祝福，

明旭。

# java - 节点树 解释

> ID：10290649
> 
> 赞同：5
> 
> 时间：2012-04-24T01:36:05.410
> 
> 标签：java, tree

不知道我是否可以根据网站的规则这样做...但我会抓住机会...请多多包涵，我只是一名学生... :-)

我有一个大学作业......我很难理解课程应该做什么......我在三个不同的场合去找我的老师，我从他那里得到的答案根本没有帮助。无论如何，分配细节如下......

创建一个名为的类，该类`Tree`充当节点的容器。树类应支持以下方法。

> **public void add(Node parent, Node child){}** -- 向父节点添加一个新的子节点
> 
> **public void removeChild(Nodeparent, Node child){}** -- 从父节点中删除子节点。
> 
> **public Node getRootNode(){}** -- 返回树的根
> 
> **public void setRoot(Node root){}** -- 设置树的根节点
> 
> **public boolean contains(T data){}** -- 在树中搜索给定类型
> 
> **public void dfs(Node child){}** -- 执行树的深度优先搜索并输出每个节点（缩进）
> 
> **public void bfs(Node child){}** -- 执行树的广度优先搜索并输出每个节点（缩进）

1.  应该对树类进行参数化以处理泛型类型 T，从而允许创建字符串树、文件树等...，例如`Tree<String> tree = new Tree<String>()`
2.  树类应使用邻接表实现树结构，并按以下方式定义：`Map<Node<T>, List<Node<T>>> tree = new HashMap<Node<T>, List<Node<T>>();`

节点类也应该被参数化以处理泛型类型 T 并公开几个方法......

现在我已经编写了运行良好的 Node 类......老实说，我确信我已经编写了一个正在创建树的 Node 类。但是在阅读了 Tree 类描述后，我很困惑。我应该存储在树图中的内容。我很难想象整个事情。

也许有人可以解释老师想要什么，并把我引向正确的方向。我**不是**在寻找代码本身......只是想了解我应该做什么。

我的节点类

```
public class Node<T> 
{
    private Node<T> root; // a T type variable to store the root of the list
    private Node<T> parent; // a T type variable to store the parent of the list
    private T child;
    private List<Node<T>> children = new ArrayList<Node<T>>(); // a T type list to store the children of the list

    // default constructor
    public Node(T child)
    {
        setParent(null);
        setRoot(null);
        setItem(child);
    }

    // constructor overloading to set the parent
    public Node(Node<T> parent)
    {
        this.setParent(parent);
        //this.addChild(parent);
    }

    // constructor overloading to set the parent of the list  
    public Node(Node<T> parent, Node<T> child)
    {
        this(parent);
        this.children.add(child);
    }

    /**
    * This method doesn't return anything and takes a parameter of 
    * the object type you are trying to store in the node 
    * 
    * @param  Obj  an object
    * @param 
    **/
    public void addChild(Node<T> child)
    {
        child.root = null;
        child.setParent((Node<T>)this);
        this.children.add(child); // add this child to the list
    }

    public void removeChild(Node<T> child)
    {
        this.children.remove(child); // remove this child from the list
    }

    public Node<T> getRoot() {
        return root;
    }

    public boolean isRoot()
    {
        // check to see if the root is null if yes then return true else return false
        return this.root != null;     
    }

    public void setRoot(Node<T> root) {
        this.root = root;
    }

    public Node<T> getParent() {
        return parent;
    }

    public void setParent(Node<T> parent) {
        this.parent = parent;
    }

    public T getItem() {
        return child;
    }

    public void setItem(T child) {
        this.child = child;
    }

    public boolean hasChildren()
    {
        return this.children.size()>0;
    }

    @SuppressWarnings("unchecked")
    public Node<T>[] children()
    {
        return (Node<T>[]) children.toArray(new Node[children.size()]);
    }

    @SuppressWarnings({ "unchecked"})
    public Node<T>[] getSiblings()
    {
        if(this.isRoot()!=false && parent==null)
        {
            System.out.println("this is root or there are no siblings");
            return null;
        }
        else{
            List<Node<T>> siblings = new ArrayList<Node<T>>((Collection<? extends Node<T>>) Arrays.asList(new Node[this.parent.children.size()]));  
            Collections.copy(siblings, this.parent.children);  
            siblings.remove(this);
            return siblings.toArray(new Node[siblings.size()]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T01:41:02.860

您将地图用于以下事情：

hashmap 的键是给定节点，hashmap 的值是给定节点的子节点。

```
public class Tree<T> {
    private Node<T> rootNode;
    private HashMap<Node<T>, List<Node<T>> tree;

    //and then some kind of function to go through the tree.
    public void expandNode(Node<T> node) {
        if (tree.get(node) == null) {
            System.out.println(node);
            return;
        }
        for(Node<T> n : tree.get(node)) {
            System.out.println(node);
            expandNode(n);
        }
    }
} 
```

我能说清楚树是如何工作的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:44:21.623

查看列表中的 2 点，我猜第 1 点最让您困惑。

树本身可以参数化。树类的类型参数可以在用于创建节点的内部类中使用。也就是说，为了您的赋值，节点类可能应该在 Tree 类中，以便它可以使用赋予 Tree 类的 T 类型参数。

这样一来，树就可以存储任何东西（字符串、文件、双精度等）。Node 类只是作为存储任何类型 T 对象的好方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T01:49:32.520

这有点奇怪。如果我这样做并且作业没有另外说明，我可能根本不会编写 Tree 类；我只是将 Node 用作递归数据结构，并让树的根节点代表整个树。

由于看起来您不应该这样做，因此您可以只创建`Tree<T>`一个包含对单个`Node<T>`对象的引用的包装类。您可以将所需方法的逻辑放在任一类中。

代码的开头可能如下所示：

```
public class Tree<T> {

    private Node<T> root;

    public Tree(Node<T> root) {
        this.root = root;
    }

} 
```

# php - 如果 mysql 查询不返回任何 PEAR PHP，则难以回显错误消息

> ID：10290650
> 
> 赞同：0
> 
> 时间：2012-04-24T01:36:09.397
> 
> 标签：php, mysql, pear, mdb2

当我的 mysql 查询没有返回任何内容时，我正在努力回显一条错误消息，指出“没有结果”。我正在使用梨。这是我目前所拥有的。

```
while($rows =& $output->fetchRow()) {
if (numRows($query)== 0){
   echo 'No results';
}
else {
 echo 'data found';
}

} 
```

任何帮助将不胜感激，感谢您查看我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:43:35.240

如果没有结果，`fetchRow`则不会返回任何内容，这意味着循环根本不会执行，这意味着循环内的代码也不会执行。逻辑是：

```
if numRows == 0
    echo error
else
    while fetchRow
        echo result 
```

# php - MySQL 中的 BIGINT 更改我的号码？为什么这样做？

> ID：10290651
> 
> 赞同：3
> 
> 时间：2012-04-24T01:36:09.587
> 
> 标签：php, mysql, biginteger, bigint

我会尽量保持这个简单。我在 MySQL 数据库表上使用 BIGINT 数据类型。我有一个函数可以生成一个唯一的随机数，该随机数的长度可以从 12 位到 13 位不等。

当我用一个长度为 12 位的数字插入数据库时​​，它输入得很好，

但是当我使用一个 13 位或更长的值时，它似乎是四舍五入之类的。这里是

php

```
$defaultText = 'some string'; //just some string
$web_id = 12;
$element_id = 23112182735363; //case 1 (doesn't work)
//$element_id = 2311218333205; //case 2, does work ()
  mysql_query("INSERT INTO tableName (web_id, element_id, content)
  VALUES ($web_id, $element_id, '".mysql_real_escape_string($defaultText)."')"); 
```

结果：在第一种情况下，它插入一个略有不同的数字，通常由于某种原因四舍五入。

在第二种情况下，它插入数字就好了！也许有人可以帮助解开这个谜团！再次感谢！

大 int 数据类型：

```
bigint(200) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T01:44:08.100

数字从 PHP_INT_MAX 开始失去精度。另见：[http ://www.php.net/manual/en/reserved.constants.php#constant.php-int-max](http://www.php.net/manual/en/reserved.constants.php#constant.php-int-max)

之后，它们变成了精度有限并导致奇怪的舍入问题的浮点数。在 PHP 中支持 BIGINT 的唯一方法是使用字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-26T17:12:36.070

我假设您在谈论 32 位服务器。但在我的服务器中，PHP 似乎并没有失去精度。 `echo(PHP_INT_MAX . "<br/>"); $big_int = -6174803190685607000; echo($big_int . '<br/>');` 输出 `9223372036854775807<br/>-6174803190685607000<br/>`

可悲的是，我仍然失去了精度。我猜这可能是因为我在 mysqli 的准备语句中使用了“i”，但我无法证明这一点。

# parameter-passing - copy-in-copy-out 参数（值-结果参数传递）

> ID：10290654
> 
> 赞同：2
> 
> 时间：2012-04-24T01:36:48.650
> 
> 标签：parameter-passing, ada

如果参数传递机制是copy-in-copy-out，如Ada中的in out，那么下面的类C程序会产生什么结果？执行过程中`swap(v, list[v])`，`v`会更新为3。复制出来的时候，第二个参数的结果是复制到`list[3]`，还是`list[1]`？

```
swap(int x, int y){
    int t = x;
    x = y;
    y = t;
}

main(){
    v = 1;
    int list[5] = {1,3,5,7,9};
    swap(v, list[v]);
    print v, list[0...4];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:01:37.697

**Ada 的参数传递机制*不是*copy-in-copy out**。Ada 不像 C，其机制是明确的，编译器会遵循它，即使这样做很愚蠢。

在某些特定情况下，语言指定事物是通过引用传递的。否则，这实际上取决于编译器，并且不允许您依赖正在使用的一种机制而不是另一种机制。在实践中，**编译器会做一些明智的事情**，如果对象适合机器寄存器，通常归结为复制，否则引用。

您列出的 C 代码的 Ada 版本中发生的情况取决于您将其转换为 Ada 的方式。我怀疑当你这样做时你会发现在 C 中可能会导致令人惊讶的行为的事情，Ada 编译器要么不会让你这样做，要么它会迫使你以不再看起来的方式记录奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:38:17.253

参数是在调用执行之前绑定的，所以 x 绑定到 v，y 绑定到 list[1]。

# backbone.js - 骨干模型结构

> ID：10290660
> 
> 赞同：1
> 
> 时间：2012-04-24T01:37:40.100
> 
> 标签：backbone.js

我正在制作一个杂货清单应用程序，它与待办事项列表非常相似。我有几年的 Rails 开发经验，但在从所有示例中找出要放入集合中的内容以及制作模型的内容时遇到了麻烦。

我用 Sinatra 和 Redis 作为后端模拟了这个应用程序。我的目标是让 Sinatra 成为简单的 API，并让主干管理所有视图。

现在，Grocery 列表只是一个复杂的 ID，其中包含一组字符串项。所以像：

```
/lists/asdfasdf34asdf => ["eggs", "bacon", "milk"] 
```

转到主干，我会将模型设为“项目”，然后集合将成为“列表”，还是其他？

我想我的路线不是经典的休息，所以也许这就是为什么我很难弄清楚在哪里做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:53:47.617

如果只有一个购物清单，a `Collection`of item `Model`s 可能是合适的。Backbone 对事物的组织方式没有太多规定，但您肯定希望以`url`合乎逻辑的方式设置每个模型/集合的属性。你可能会做这样的事情：

```
var app = {
  item: Backbone.Model.extend({
    // define an item model to go in the itemCollection
  }),
  itemCollection: Backbone.Collection.extend({
    initialize: function (key) {
      this.key = key;
    },
    model: app.item,
    url: function () {
      return 'lists/' + this.key + '/items/'
    }
  })
} 
```

然后按照以下几行实例化每个版本的应用程序：

```
var userListKey = 'foobar',
    userCollection = new app.itemCollection(foobar);

// proceed with app. Requests for userCollection will now be
// directed to /lists/foobar/items 
```

还有很多其他方法可以做到这一点，但希望这是一个开始。

# iphone - 使用 indexPath.row 从 NSArray 填充 UITableView

> ID：10290663
> 
> 赞同：0
> 
> 时间：2012-04-24T01:38:02.760
> 
> 标签：iphone, objective-c, ios, uitableview

我正在尝试 `UITableView in - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`使用在 viewDidLoad 方法中初始化的数组填充方法。

```
self.questionsArray = [NSArray arrayWithObjects:@"Q1",@"Q2",@"Q3",@"Q4",@"Q5",@"Q6",@"Q7",@"Q8",@"Q9",@"Q7",@"Q8",@"Q9",@"Q10",@"Q11"]; 
```

我了解如何实现各个部分并重用带有标识符的单元格。正如我见过的大多数例子一样，我尝试过 `question.text = [NSString stringWithFormat:@"%d. %@", indexPath.row ,[self.questionsArray objectAtIndex:indexPath.row]];`

但我越来越喜欢 0\. Q1 1\. Q2 2\. Q3 3\. Q4 4\. Q5 5\. Q6 0\. Q1 2\. Q2 ....

请帮助将所有问题（NSString）加载到我的 TableView。我搞砸了 indexPath.row。它非常难以理解。有关有效处理 indexPath 的最佳实践的任何提示。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    switch (section) {
        case 0:
            return [self.questionsArray count];
        case 1:
            return 1;
        default:
            return 0;
    }
}    
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{        
    if (indexPath.section == 0) {           
        static NSString *QuestionCellIdentifier = @"QuestionCellIdentifier";

        UITableViewCell *cell =  [tableView dequeueReusableCellWithIdentifier:QuestionCellIdentifier];

        if (cell == nil) {
                [[NSBundle mainBundle] loadNibNamed:@"QuestionCell" owner:self options:nil];
            }
            cell = questionCell; // IBoutlet    
            self.questionCell = nil;              
        }

           question.text = [NSString stringWithFormat:@"%d.  %@", indexPath.row ,[self.questionsArray objectAtIndex:indexPath.row]];

        return cell;    
    }       
    else if (indexPath.section == 1){

        static NSString *CustomCellIdentifierMore = @"CustomCellIdentifierMore";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CustomCellIdentifierMore];

        if (cell == nil) {
            cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CustomCellIdentifierMore] autorelease];
            cell.accessoryType = UITableViewCellAccessoryCheckmark;
            switch (indexPath.row) {

                case 0:
                    cell.textLabel.text=@"Select";
                    break;                

                default:
                    break;
            }
        }   

        return cell;
    } 
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:44:27.327

cellForRowAtIndexPath 不能保证按顺序加载单元格，并且会被调用来更新某些单元格。您还需要提供 numberOfRowsInSection 方法，例如：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return [self.tableData count];
} 
```

您的单元格是否正确显示，还是只是 nslog 产生了令人困惑的输出？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:54:35.280

在 viewDidLoad 中创建 questionsArray 后，尝试在 tableView 上调用 reloadData，如下所示：

```
self.questionsArray = [NSArray arrayWithObjects:@"Q1",@"Q2",@"Q3",@"Q4",@"Q5",@"Q6",@"Q7",@"Q8",@"Q9",@"Q7",@"Q8",@"Q9",@"Q10",@"Q11"];
//or whatever your property for the tableview is called.
[self.tableView reloadData]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T03:50:24.717

您的 cellForRowAtIndexPath 实现有点古怪。首先， indexPath.section == 0 条件的大括号不匹配。其次，我看不到您在哪里为要返回的单元格设置文本。无论您分配给 question.text 什么，都应该分配给 cell.textLabel.text。第三，对于 indexPath.section == 1 条件，您仅在单元​​格为 nil 时设置文本。表格视图在单元管理方面非常聪明。当一个单元格由于滚动而超出视野时，它将重新使用该单元格，而不是完全创建一个新单元格。所以，每当你对一个单元进行出队时，它可能并不总是为零。因此，您应该在 if (cell == nil) 循环之外设置单元格文本。

# php - PHP SQL 截断

> ID：10290665
> 
> 赞同：1
> 
> 时间：2012-04-24T01:38:21.430
> 
> 标签：php, sql, database, truncate

我在尝试从请求表中截断“requestID”字段时遇到问题。

这是我的代码。

```
<?php
        include 'mysql_connect.php';
     USE fypmysqldb;
     TRUNCATE TABLE requestID;
     echo "Request ID table has been truncated";     
?> 
```

我正在使用服务器端脚本，所以不知道会出现什么错误。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:41:37.063

您没有执行查询，您只是将 SQL 代码放入无效的 PHP 中。这假设您使用的是`mysql_*()`api（在查看您之前的一个问题后我有点怀疑），但如果您使用的是 MySQLi 或 PDO，则可以进行调整。

```
 // Assuming a successful connection was made in this inclusion:
 include 'mysql_connect.php';
 // Select the database
 mysql_select_db('fypmysqldb');
 // Execute the query.
 $result = mysql_query('TRUNCATE TABLE requestID');

 if ($result) {
   echo "Request ID table has been truncated";  
 }
 else echo "Something went wrong: " . mysql_error(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:41:42.880

[`mysql_query`](http://us2.php.net/manual/en/function.mysql-query.php)查看执行查询执行的函数。执行查询的代码应如下所示。

```
$link = mysql_connect('host', 'username', 'password') or die(mysql_error());
mysql_select_db("fypmysqldb", $link) or die(mysql_error());
mysql_query("TRUNCATE TABLE requestID", $link) or die(mysql_error());
mysql_close($link); 
```

# ruby - Ruby 冒号哈希语法高亮

> ID：10290668
> 
> 赞同：5
> 
> 时间：2012-04-24T01:38:58.653
> 
> 标签：ruby, eclipse, aptana, syntax-highlighting

我是冒号哈希的重度用户，但默认的 Aptana Studio Ruby 没有为它们提供任何突出显示。

这是 Ruby 1.9 中的冒号哈希：

```
{ animal: "duck" } 
```

有谁知道我需要打什么位才能使“动物：”部分以另一种颜色显示？

**更新：**

从阅读源代码来看，Aptana 没有使用 PLists 文件，并且该功能目前不完整。 [https://github.com/textmate/ruby.tmbundle/issues/17](https://github.com/textmate/ruby.tmbundle/issues/17)

我已经尝试更改源中的范围，但它似乎没有为我更新。

找到 Aptana 试图强调的范围

1.  *命令*->*捆绑开发*->*显示范围和匹配主题规则*（或者默认快捷键是**Ctrl+Alt+P**）
2.  阅读盒子。它可能会列出几个范围。

添加范围的方式：

1.  *窗口*->*首选项*
2.  选择*Aptana Studio*，然后选择*主题*选项。
3.  按*Scope Selector*文本框旁边的**+**按钮。
**   添加您的范围并设置颜色。*   应用并单击*确定**

 *我完全没主意了。希望这将帮助某人更接近。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T18:47:19.587

Aptana Studio 3 使用 TextMate 主题进行语法高亮，因此您只需要找到支持它的 TextMate 主题即可。*

# android - 位置：固定在 Android HTC Incredible 2 中？

> ID：10290671
> 
> 赞同：1
> 
> 时间：2012-04-24T01:39:28.467
> 
> 标签：android, css, mobile

`position:fixed`适用于 iPhone / iOS，但我的粘性页脚刚刚开始在页面中间挂出，而不是为 android / htc 保持固定？

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:42:25.190

在您的 html 中输入此代码。

```
<meta name="viewport" content="user-scalable=no" /> 
```

# jquery - 在Jquery中选择除父母之外的所有内容

> ID：10290672
> 
> 赞同：2
> 
> 时间：2012-04-24T01:39:48.433
> 
> 标签：jquery

我有以下代码：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
        $("#ThisClick").anycommand();
    </script>
</head>
<body>
<ul id="TopUl">
    <li>First<ul>
        <li>One<ul>
            <li>liA1</li>
            <li>liA2</li>
        </ul>
        </li>
        <li>Two<ul>
            <li id="ThisClick">liB1</li>
            <li>liB2</li>
        </ul>
        </li>
    </ul>
    </li>
    <li>Second<ul>
        <li>li1<ul>
            <li>liF1</li>
            <li>liF2</li>
        </ul>
        </li>
        <li>li2</li>
    </ul>
    </li>
</ul>
</body>
</html> 
```

单击时，我需要折叠所有不是 lib1 (#ThisClick) 父级的 UL。换句话说，通过单击 liB1 我想要以下代码：

```
<ul id="TopUl">
    <li>First<ul>
        <li>One<ul style="display:none">
            <li>liA1</li>
            <li>liA2</li>
        </ul>
        </li>
        <li>Two<ul>
            <li id="ThisClick">liB1</li>
            <li>liB2</li>
        </ul>
        </li>
    </ul>
    </li>
    <li>Second<ul style="display:none">
        <li>li1<ul style="display:none">
            <li>liF1</li>
            <li>liF2</li>
        </ul>
        </li>
        <li>li2</li>
    </ul>
    </li>
</ul> 
```

然后 Jquery 可能会折叠所有没有父级的 UL 标记。解决办法是什么？我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:47:10.577

这个看起来很恶心的选择器应该可以工作：

```
$("ul :not(:has(#ThisClick))").hide(); 
```

参考资料：[`:not()`](http://api.jquery.com/not-selector/)和[`:has()`](http://api.jquery.com/has-selector/)

* * *

因此，这段代码将使所有不是您单击的元素的父元素的元素都隐藏起来。根据需要更改第一个选择器 ( `$("#ThisClick")`)，现在它仅适用于`<li>`您指定`ThisClick`ID 的那个，并且您只能使用一次 ID。

```
$("#ThisClick").click(function() {
    $("ul :not(:has(this))").hide();
}); 
```

要在您的 s 中的*所有* `<li>`s 上进行此`<ul>`操作，您可以执行以下操作：

```
$("#TopUl li").click(function() {
    $("ul :not(:has(this))").hide();
}); 
```

这会将 click 事件添加到`<li>`列表中的所有 s 中。

# facebook - facebook上的heroku应用程序重命名

> ID：10290678
> 
> 赞同：1
> 
> 时间：2012-04-24T01:40:23.167
> 
> 标签：facebook, heroku, rename

我在用 heroku 重命名刚刚发布的 facebook 应用程序时遇到了问题。我已经删除了旧的工作应用程序，在 heroku 中创建了一个具有不同名称的新应用程序，并尝试使用已删除应用程序的旧名称重命名这个新应用程序。使用旧名称（heroku 提供的奇怪标准名称）测试我的应用程序，两者都登录 facebook，而不是直接登录 heroku 域，我发现没有问题。当我重命名并尝试在 facebook 上更新应用程序时，应用程序无法识别我已登录，要求我使用 facebook 按钮登录，但当我尝试登录时，facebook 日志记录过程中出现错误，我'我不能让它工作。怎么样？我怀疑我必须上传一些链接...或者它可能是 Facebook 的传播延迟时间？

提前致谢

是的，我看起来并不完全正常，但我刚刚解决了，我认为分享可能是个好主意。当为应用程序使用另一个名称时，有必要在 heroku 中重新加载 FACEBOOK_APP_ID 和 FACEBOOK_SECRET 只需将自己放在项目文件夹中并键入 heroku config:add FACEBOOK_APP_ID=12345 FACEBOOK_SECRET=abcde 使用您正在使用的应用程序的正确值工作！

# matlab - 在多维数组中索引第 3 维或更高维时如何获取线性数组

> ID：10290679
> 
> 赞同：2
> 
> 时间：2012-04-24T01:40:24.997
> 
> 标签：matlab

考虑具有以下多维数组：

A = [1 2;3 4]; B = [5 6;7 8]; C = 猫（3，A，B）；

嗯，它就像一个立方体，我想切第一行，切第一列，就是这样。当我做：

```
C(1,1,:) 
```

我得到两个不同的答案：

```
C(1,1,1) = 1
C(1,1,2) = 5 
```

如果我这样做

```
D = C(1,1,:) 
```

我得到 D 是一个多维的。

我要这个

```
D = [1 5]; 
```

就是这样，如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:09:01.763

使用`squeeze()`函数删除额外的维度：

```
>> squeeze(C(1,1,:))'

ans =

     1     5 
```

# jquery-mobile - 防止放大Phonegap + JQuery Mobile

> ID：10290681
> 
> 赞同：6
> 
> 时间：2012-04-24T01:40:30.317
> 
> 标签：jquery-mobile, cordova, touch, zooming

我正在构建一个 PhoneGap + JQuery Mobile 应用程序，但我似乎无法阻止它通过双击放大。[我遵循了http://www.tricedesigns.com/2012/01/17/mobile-web-phonegap-html-dev-tips/](http://www.tricedesigns.com/2012/01/17/mobile-web-phonegap-html-dev-tips/)中列出的提示，特别是添加：

```
<meta name="viewport" content="width=device-width, user-scalable=no" /> 
```

有谁知道缩放的解决方案？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T02:30:29.447

尝试：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" /> 
```

这就是我使用的，我没有得到任何缩放行为。

这是`viewport`元标记的 Apple 文档：[https ://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-09T13:39:40.823

将“user-scalable=no”放入您的元标记

像这样

```
 <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
```

这是停止放大手机的最佳方法，它在 phonegap 中对我有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-08T21:03:54.873

接受的解决方案似乎在 iOS10 中不起作用，这确实：

```
// stop ios bounce and zoom 
document.ontouchmove = event => {
  event.preventDefault();
}; 
```

这将停止移动事件到达根元素/浏览器

# r - 在逻辑运算符旁边使用 R 函数名称

> ID：10290682
> 
> 赞同：0
> 
> 时间：2012-04-24T01:40:31.583
> 
> 标签：r

在 R 中，我有一个函数，它将另一个函数的名称作为参数。我在父函数中构造了一个 if 语句来检查输入函数名称是否与名称 strategy_function 的现有函数的名称相同。

```
function_parent <- function(function_name){
    if(function_name == strategy_function){...}
} 
```

但是，R 不喜欢这种表示法。是否可以以这种方式使用函数的名称，即使可以，是否有更好的方法？这似乎有点草率。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:45:46.247

尝试引用`strategy_function`：

```
function_parent <- function(function_name){
    if(function_name == "strategy_function"){...}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:49:39.067

`deparse(substitute(strategy_function))`在比较中使用就可以了。

# ruby-on-rails - 大虾pdf组、事务和回滚方法问题

> ID：10290686
> 
> 赞同：3
> 
> 时间：2012-04-24T01:40:49.510
> 
> 标签：ruby-on-rails, pdf, prawn

我正在尝试在 rails 应用程序中使用 prawn 创建一个 pdf 报告。有很多部分包含用户生成的内容，我想尝试将它们组合在一起。有时这会超过一页，从而导致无法分组错误。然后我尝试使用事务，以便在发生错误时可以回滚，然后在不使用 group 方法的情况下输出内容。

**问题是回滚填满了页面。**它从 pdf 中删除了多余的页面，但当我尝试重做它时，仍然有错误的页数和重叠内容输出。**根据大虾文档，我在回滚后重置了 y 位置，但我仍然遇到问题。**

**例如。以下测试代码写入 2 页数字，回滚到开头，然后再次尝试写入相同的数字。它会产生一个单页 pdf，其中第二页数字与第一页重叠，页数为 2。即使我使用的是 prawn number_pages 方法，页面底部的页数也相互重叠**

```
class TestReport < Prawn::Document 
  def to_pdf   
    font('Helvetica')
  bounding_box([bounds.left, bounds.top - 50], :width  => bounds.width, :height => bounds.height - 100) do   

text 'begin'
  y_pos = y
  transaction do
    begin
      group do
        64.times do|i|
          text i.to_s
        end
      end
    rescue
      rollback
    end
  end
  self.y = y_pos

  64.times do|i|
    text i.to_s
  end

  text 'end'
  text page_number.to_s
end

    page_numbers(1)
    #render
  end

 def page_numbers(start)
    string = "page <page> of <total>"
    options = { :at => [bounds.right - 150, 40],
              :width => 150,
              :align => :right,
              :start_count_at => start,
              :color => "000000" }
    number_pages string, options
 end
end

 def test_report
    pdf = TestReport.new()
     pdf.to_pdf
     send_data pdf.render, filename: "test.pdf",
                      type: "application/pdf",
                      disposition: "inline"
 end 
```

**问题似乎与事务回滚有关。**我想要的主要是能够使用 group 方法。还有其他方法吗？

我的代码错了吗？我是否遗漏了某些东西或当前无法进行交易。

我目前在 ruby​​ on rails 应用程序中使用 master prawn 分支（ gem 'prawn', :git => 'git://github.com/prawnpdf/prawn.git', :branch => 'master'）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-14T12:35:17.227

这个问题现在已经很老了，但我会发布一个答案，因为它是谷歌搜索异常时最先出现的问题之一。

事务仍然不适用于分页符（v 1.0.0.rc2），所以我创建了一个帮助方法，它首先尝试使用分组，然后如果发生异常，它只是重试而不分组，使内容跨越一页以上。

```
def group_if_possible(pdf, &block)
  begin
    pdf.group { block.call }
  rescue Prawn::Errors::CannotGroup
    block.call
  end
end 
```

示例：在创建表时使用它：

```
group_if_possible(pdf) do
  pdf.table(rows)
end 
```

编辑：
分组已从 Prawn 1.x 中删除，但有一个非官方的分组 gem 适用于 Prawn 2： [https ://github.com/ddengler/prawn-grouping](https://github.com/ddengler/prawn-grouping)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T13:33:17.070

看起来 Brad Ediger 在 Google 网上论坛上回答了您的问题，但为了其他寻求帮助的人的利益，以下是他的回复：

遗憾的是，事务在开始新页面或更改页面集合时还不能正常工作。这是一个已知问题：

[https://github.com/prawnpdf/prawn/issues/268](https://github.com/prawnpdf/prawn/issues/268)

-是

# class - 嵌套类导致模板问题

> ID：10290690
> 
> 赞同：1
> 
> 时间：2012-04-24T01:41:06.383
> 
> 标签：class, templates, map, nested, red-black-tree

对于我的数据结构类，我们被要求采用先前实现的平衡树（来自先前的项目）并使用它来实现 C++ 标准映射类的部分内容。

[http://cplusplus.com/reference/stl/map/](http://cplusplus.com/reference/stl/map/)

我认为最明显的第一步是模板化整个类，允许单独的键和存储类型。当然，我遇到了模板问题。通常，我的模板一直有效，直到我尝试对使用本地嵌套数据类型“rbNode”的函数进行模板化。如果我在函数定义中包含模板参数，则会出现语法错误。如果我将它们排除在外，我会收到“不包括模板参数”错误。

这是在 Visual Studio 2010 中给我错误的类实现（下面列出的错误）：

```
#include <cstdlib>
#include <iostream>
template <class key_type, class T>
class myMap
{
private:
    //typedef pair<const key_type, T> value_type;
    struct rbNode
    {
        //value_type ref;
        int element;
        rbNode * left;
        rbNode * right;
        bool red;
        rbNode(int key)
        {
            left = NULL;
            right = NULL;
            //ref.first = key;
            //ref.second = element;
            element = key;
            red = true;
        }
    };
    rbNode * root;
    bool search(int , rbNode *);
    rbNode * LL_Rotation(rbNode *);
};

template <class key_type, class T>
myMap<key_type,T>::rbNode* myMap<key_type,T>::LL_Rotation(rbNode * curr) // errors occur on this line
{
    rbNode * temp = curr->right;
    curr->right = temp->left;
    temp->left = curr;

    curr->red = 1;
    temp->red = 0;

    return temp;
} 
```

然而，这个函数编译得很好，上面的函数被注释掉了：

```
template <class key_type,class T> 
bool myMap<key_type,T>::search(int key,rbNode * tree)
{
    if(tree!=NULL)
        if(tree->element==key)
            return true;
        else
            if(key< tree->element)
                return search(key,tree->left);
            else
                return search(key,tree->right);
    else
        return false;
} 
```

特别是，我得到

`missing ';' before '*'` 并且 `missing type specifier - int assumed. Note: C++ does not support default-int` 在线上实现了“LLRotation”的名称（在评​​论中指出）。我对模板不是很有经验，所以我觉得我犯了一个非常愚蠢的错误。无论如何，如果您需要更多我的代码或更多信息，请告诉我。任何帮助是极大的赞赏。

***注意：我确信我的代码中有很多不好的做法，等等。我还在学习。随意指出它们，但我最关心的是模板问题。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:45:11.110

您只是缺少一个`typename`从属名称：

```
template <class key_type, class T>
typename myMap<key_type,T>::rbNode* myMap<key_type,T>::LL_Rotation(rbNode * curr)
^^^^^^^^ 
```

# matlab - 用虚线/点线打印到 TIFF 的图

> ID：10290700
> 
> 赞同：2
> 
> 时间：2012-04-24T01:42:17.653
> 
> 标签：matlab

我正在尝试将 MATLAB 线图打印到 TIFF 文件。但是，当我这样做时，虚线和虚线显示为实线。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:21:58.090

试试`painters`渲染器，它通常可以解决这个问题。此外，一般来说，您可能会喜欢[`export_fig()`](http://www.mathworks.com/matlabcentral/fileexchange/23629)FileExchange 中的功能。

# biztalk - SAP 接收适配器高可用性

> ID：10290707
> 
> 赞同：0
> 
> 时间：2012-04-24T01:43:27.850
> 
> 标签：biztalk

我们有一个主动-主动 BizTalk 集群，其中 Windows 服务器作为软件负载平衡器。该解决方案包括一个接受入站 rfc 调用的 SAP 接收适配器。目标是使 SAP 适配器具有高可用性。

阅读文档 ()，它确实说“您必须始终集群 SAP 接收适配器以适应两阶段提交方案。” 和“运行 FTP、MSMQ、POP3、SQL 和 SAP 的接收处理程序的主机需要集群机制来提供高可用性。”

我们目前在 BizTalk 的主动-主动节点中所做的，我们启用了一个主机实例。参考上述文档，是否意味着我们做错了？我们应该采用集群主机实例而不是主动-主动部署吗？

感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:33:53.663

您需要集群处理 SAP 接收的主机。这意味着您将始终只有一个适配器实例在任何给定时间运行，并且如果其中一个服务器出现故障，另一个将启动。

将此与您只有两个（非集群）实例同时运行的场景进行比较：是的，这为您提供了高可用性 - 但也有死锁！两者会相互独立运行... 有了上面的集群场景，他们会同时运行一个

要集群 SAP 接收主机：打开管理控制台，找到主机，右键单击并集群。

# bash - Getting more familiar with bash

> ID：10290718
> 
> 赞同：1
> 
> 时间：2012-04-24T01:44:36.573
> 
> 标签：bash

I am trying to understand what `-e /sudoers.tmp -o "$(pidof visudo)"` does in the following code snippet.

```
#!/bin/bash

if [ -e /etc/sudoers.tmp -o "$(pidof visudo)" ]; then 
  echo "/etc/sudoers busy, try again later"
  exit 1
fi

cp /etc/sudoers /etc/sudoers.bak
cp /etc/sudoers /etc/sudoers.tmp

chmod 0640 /etc/sudoers.tmp
echo "whatever" >> /etc/sudoers.tmp
chmod 0440 /etc/sudoers.tmp

mv /etc/sudoers.tmp /etc/sudoers

exit 0 
```

Appreciate an elaboration on that specific condition.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:48:14.587

This:

```
if [ -e /etc/sudoers.tmp -o "$(pidof visudo)" ]; then 
```

is using the `test` command. To see what the `-e` test does, you can run `help test` and look at the output:

```
Evaluate conditional expression.

Exits with a status of 0 (true) or 1 (false) depending on
the evaluation of EXPR.  Expressions may be unary or binary.  Unary
expressions are often used to examine the status of a file.  There
are string operators and numeric comparison operators as well.

The behavior of test depends on the number of arguments.  Read the
bash manual page for the complete specification.

File operators:

  [...]
  -e FILE        True if file exists. 
```

So, `-e /etc/sudoers.tmp` is checking to see if that file exists.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:55:46.070

`[ -e /etc/sudoers.tmp -o "$(pidof visudo)" ]` says if the file `/etc/sudoers.tmp` exists or the return state of the command `pidof visudo` is not 0, which means `visudo` is running.

# java - 每次我运行此方法时，我的数组都会重置

> ID：10290720
> 
> 赞同：1
> 
> 时间：2012-04-24T01:44:57.537
> 
> 标签：java, arrays, multidimensional-array

每次我调用 set() 时，它都会将数组中的所有值重置为 false，除了 int row int col 是什么，因为我在方法结束之前将其设置为 true。为什么会发生这种情况？我以为我正在复制数组 B，然后将 A 中的值设置为 B 中的值？还是我在这里弄错了。

```
public void set(int row, int col) throws IndexOutOfBoundsException {
    if (row >capacityr) {            
        boolean B[][] = new boolean[row+1][capacityc+1];
        for (int k = 0; k < capacityr; k++) 
            for (int j = 0; j < capacityc; j++) 
                B[k][j] = a[k][j];                

        capacityr=row;
        a = B;
    }

    if (col >capacityc) {            
        boolean C[][] = new boolean[capacityr+1][col+1];
        for (int k = 0; k <capacityr; k++) 
            for (int j = 0; j < capacityc; j++) 
                C[k][j] = a[k][j];                

        capacityc=col;
        a = C;
    }       

    a[row][col] = true;
    pT++;                   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:15:25.387

它应该更容易使用，`ArrayList`但我认为这会解决你的问题。

```
public void set(int row, int col) throws IndexOutOfBoundsException {
   if(row > capacityr) {
      if(col > capacityc) {
         //both row and col are too big
         boolean temp[][] = new boolean[row+1][col+1];

         //copy a
         for(int i = 0; i <= capacityr; i++) {
           for(int j = 0; j <= capacityc; j++) {
              temp[i][j] = a[i][j];
           }
         }

         //set all the new elements to false
         for(int i = capacityr+1; i <= row; i++) {
           for(int j = capacityc+1; j <= col; j++) {
              temp[i][j] = false;
           }
         }

         //set row and col and a to temp
         temp[row][col] = true;
         a = temp;

         //update capacity
         capacityr = row;
         capacityc = col;
      }
      else {
         //just row is too big
         boolean temp[][] = new boolean[row+1][capacityc+1];
         for(int i = 0; i <= capacityr; i++) {
           for(int j = 0; j <= capacityc; j++) {
              temp[i][j] = a[i][j];
           }
         }

         for(int i = capacityr+1; i <= row; i++) {
             temp[i][capacityc] = false;
         }
         temp[row][col] = true;
         a = temp;
         capacityr = row;
      }
  }
  else {
     if(col > capacityc) {
        //just col is too big
        boolean temp[][] = new boolean[capacityr+1][col+1];
        for(int i = 0; i <= capacityr; i++) {
           for(int j = 0; j <= capacityc; j++) {
               temp[i][j] = a[i][j];
           }
        }

        for(int j = capacityc+1; j <= col; j++) {
             temp[capacityr][j] = false;
        }
        temp[row][col] = true;
        a = temp;
        capacityc = col;
     }
     else {
        //neither are too big
        a[row][col] = true;
     }
  }
} 
```

# ios - 侧面带有可点击区域的 3D 可旋转立方体

> ID：10290721
> 
> 赞同：1
> 
> 时间：2012-04-24T01:44:59.367
> 
> 标签：ios, ipad, opengl-es, 3d

我想要完成的是一个带有 3D 可旋转立方体的 iPad 应用程序，并且在立方体的每一侧我想定义多个区域，一旦单击这些区域就会进入另一个视图或显示一个弹出窗口。

1.  这可以通过在 Xcode 中从头开始使用 OpenGL ES 来实现吗，或者我应该使用 3D 框架，如果可以的话，什么是最简单的框架？（我只听说过 Unity，而且很贵）

2.  有没有人有一个很好的教程让我学习如何做到这一点？

我已经尝试过 3D CSS3 转换，但我想保留它作为最后的手段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-06T07:11:20.430

试试这个代码

```
CATransition *transition = [CATransition animation];
transition.delegate = self;
transition.duration = 0.8;
transition.timingFunction = [CAMediaTimingFunction     functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
NSString *types[4] = {@"cube", @"rippleEffect", @"cube", @"alignedCube"};
NSString *subtypes[4] = {kCATransitionFromTop, kCATransitionFromLeft, kCATransitionFromRight, kCATransitionFromBottom};
transition.type = types[0];
transition.subtype = subtypes[1];
[self.view.layer addAnimation:transition forKey:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:04:46.397

如果你想要的只是一个文字 3D 立方体，你可以使用 Core Animation。查看[CATransformLayer](http://developer.apple.com/documentation/GraphicsImaging/Reference/CATransformLayer_class/Reference/Reference.html)。您可以使用`CATransformLayer`. Joe Ricioppo 有[一篇关于此的很酷的文章](http://tumbljack.com/post/176535888/3d-objects-in-objective-c-with-catransformlayer)，以及一些示例代码和视频。它类似于 3D CSS3 变换，不同之处在于它更容易操作表示 3D 层次结构的单个层，而不是单独变换每个子层。最初只需旋转所有立方体面并定位它们，使它们形成一个立方体。然后你可以将变换应用到变换层本身，它会做所有花哨的数学来自动变换你的子层。

最大的问题是触摸处理将如何工作。您*不能*使用`-hitTest:`on `CATransformLayer`，因为它无法将 2D 触摸映射到它自己的 3D 层次结构。你也许可以通过自己的`hitTest:`实现来解决这个问题，但这几乎感觉像是比它的价值更多的工作。我不知道 OpenGL 为 2D 到 3D 触摸转换提供了哪些条款，但这可能是您唯一的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-18T17:46:57.180

也许不完全是您正在寻找的，但我们已经生成了一些功能上可能对您有所帮助的代码：http: [//www.chupamobile.com/products/details/2106/Cube+Selector/](http://www.chupamobile.com/products/details/2106/Cube+Selector/)

它功能齐全，开箱即用

# c++ - 优化声明重复变量？

> ID：10290722
> 
> 赞同：0
> 
> 时间：2012-04-24T01:44:59.680
> 
> 标签：c++

无论如何，有没有可以避免做这样的事情：

```
std::queue<myStruct>  part1, part2, part3, part4, part5, part6, part7, part8, part9, part10;

void setup(){
myVector.push_back(part1);
myVector.push_back(part2);
myVector.push_back(part3);
myVector.push_back(part4);
myVector.push_back(part5);
myVector.push_back(part6);
myVector.push_back(part7);
myVector.push_back(part8);
myVector.push_back(part9);
myVector.push_back(part10);
} 
```

虽然这仅上升到第 10 部分，但我可能会上升到 50 或更多。它只是编码的一部分，它必须在某个地方声明，还是有一种动态的方式我可以声明这些队列并将它们分配给 myVector 这些队列，而无需像这样编写它？

TIA

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T01:49:42.800

一种简单的方法：

```
std::vector<std::queue<myStruct>> myVector(10); 
```

完毕！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T05:11:39.260

假设您的结构如下所示：

```
struct myStruct{

    //random variables that your struct may contain
    int num;
    std::string str;
    char ch;

    //Default Constructor
    //This allows your to create your structs without specifying any values;
    myStruct():
    num{999},str{"default"},ch{'z'}{}

    //Parameterized Constructor
    //This allows you to create your structs with specified values during initialization
    myStruct(int const numIn, std::string const& strIn, char const chIn):
    num{numIn},str{strIn},ch{chIn}{}

}; 
```

这将允许您通过以下方式创建实例：

```
//calling default constructor
myStruct part1, part2, part3;

//calling parameterized constructor
myStruct part4{4,"4",'4'}, part5{5,"5",'5'}, part6{6,"6",'6'}; 
```

现在您想将每个容器放入一个容器中，然后将这些容器放入另一个容器中？

```
//this is a vector holding one deque holding 6 structs
vector<deque<myStruct>> vec{{part1,part2,part3,part4,part5,part6}};
+-------+
|  vec  |
|       |
|  [0]  |
+-------+
    |
   \'/
+-------+
|  deq  |
|       |-> part1
|  [0]  |
+-------+
|  deq  |
|       |-> part2
|  [1]  |
+-------+
|  deq  |
|       |-> part3
|  [2]  |
+-------+
|  deq  |
|       |-> part4
|  [3]  |
+-------+
|  deq  |
|       |-> part5
|  [4]  |
+-------+
|  deq  |
|       |-> part6
|  [5]  |
+-------+

//this is a vector holding 6 deques each holding 1 struct
vector<deque<myStruct>> vec2{{part1},{part2},{part3},{part4},{part5},{part6}};
+-------++-------++-------++-------++-------++-------+
|  vec  ||  vec  ||  vec  ||  vec  ||  vec  ||  vec  |
|       ||       ||       ||       ||       ||       |
|  [0]  ||  [1]  ||  [2]  ||  [3]  ||  [4]  ||  [5]  |
+-------++-------++-------++-------++-------++-------+
    |        |        |        |        |        |
   \'/      \'/      \'/      \'/      \'/      \'/
+-------++-------++-------++-------++-------++-------+
|  deq  ||  deq  ||  deq  ||  deq  ||  deq  ||  deq  |
|       ||       ||       ||       ||       ||       |
|  [0]  ||  [0]  ||  [0]  ||  [0]  ||  [0]  ||  [0]  |
+-------++-------++-------++-------++-------++-------+
    |        |        |        |        |        |
   \'/      \'/      \'/      \'/      \'/      \'/
  part1    part2    part3    part4    part5    part6 
```

不过，我们可以做得更好。让我们初始化您的结构，同时将它们推入双端队列，同时将双端队列推入向量。

```
//this is a vector holding one deque holding 6 structs
vector<deque<myStruct>> vec{{{1,"1",'1'},{2,"2",'2'},{3,"3",'3'},{4,"4",'4'},{5,"5",'5'},{6,"6",'6'}}};

//this is a vector holding 6 deques each holding 1 struct
vector<deque<myStruct>> vec2{{{1,"1",'1'}},{{2,"2",'2'}},{{3,"3",'3'}},{{4,"4",'4'}},{{5,"5",'5'}},{{6,"6",'6'}}}; 
```

但请记住，这是所有 C++11 初始化功能。我建议你阅读这篇文章来习惯。 [http://www.informit.com/articles/article.aspx?p=1852519](http://www.informit.com/articles/article.aspx?p=1852519)

要编译这样的代码，请确保您的编译器是最新的并且您拥有适当的库文件。如果您使用 gcc，请使用以下标志进行编译：

> g++ -std=c++0x -o main main.cpp

# c++ - 成员函数的模板化类和类型返回类型

> ID：10290725
> 
> 赞同：0
> 
> 时间：2012-04-24T01:45:18.903
> 
> 标签：c++, templates, generics, design-patterns

如果可能的话，我希望在返回模板类的类中有一个函数，其中类和类模板值是模板参数。例如，

```
class AClass
{
public:
    template<typename ClassType, typename ClassTemplateType>
    ClassType<ClassTemplateType>* TestFunction() { return NULL; }
}; 
```

但是，如果我要做这样的事情，我会得到诸如

> 错误 C2988：无法识别的模板声明/定义
> 
> 错误 C2059：语法错误：'<'
> 
> 错误 C2143：语法错误：缺少“；” 前 '}'
> 
> 错误 C2238：';' 前面的意外标记

是否可以按照我提供的方式做某事，如果可以，怎么做？如果不是，为什么不呢？还有其他可以建议的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:48:11.193

模板模板参数的语法是

```
template<template<typename> class ClassType, typename ClassTemplateType>
ClassType<ClassTemplateType>* TestFunction() { return NULL; } 
```

# php - 在 MySQL 中对多个表中的数据进行排序的最佳方法

> ID：10290727
> 
> 赞同：2
> 
> 时间：2012-04-24T01:45:28.077
> 
> 标签：php, mysql, sql, database, sorting

根据可能来自多个表的字段值对 MySQL 中的结果集进行排序的最佳方法是什么？

为简单起见，假设数据库中有四个表。主表包含许多字段，但特别是它包含具有另一个表的名称的列和该表中记录的外键。三个外部表中的每一个都包含一个名称列，我想在主表中对结果进行排序。

```
Example primary table:

+----+---------------+------------+-------------+
| id | foreign_table | foreign_id | more_fields |
+----+---------------+------------+-------------+
|  1 | students      |       9182 | blah, blah  |
|  2 | students      |       1008 | blah, blah  |
|  3 | parents       |       3827 | blah, blah  |
|  4 | teachers      |       4523 | blah, blah  | 
|  5 | teachers      |       1092 | blah, blah  | 
+----+---------------+------------+-------------+

Example foreign (students) table:

+-------+--------------+-------------+
| id    | name         | more_fields |
+-------+--------------+-------------+
|  9182 | Joe          |  blah, blah | 
|  1008 | Sally        |  blah, blah | 
+-------+--------------+-------------+ 
```

这在 MySQL 中可能吗？或者我是否需要遍历 PHP 中的结果并创建一个数组进行排序，然后使用类似 array_multisort() 的东西？如果使用数组，循环数千行只是为了对结果进行排序是否有效？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:58:17.210

如果您将其他三个表中的名称放在一起，则使用三个`LEFT JOIN`s（学生、父母、教师）并在`ORDER BY`应该做的工作中列出每个：`COALESCE()`

```
SELECT
  primary_table.*,
  COALESCE(students.name, parents.name, teachers.name) AS name
FROM 
  primary_table
  LEFT JOIN students ON (foreign_table = 'students' AND foreign_id = students.id)
  LEFT JOIN parents ON (foreign_table = 'parents' AND foreign_id = parents.id)
  LEFT JOIN teachers ON (foreign_table = 'teachers' AND foreign_id = teachers.id)
ORDER BY name 
```

从长远来看，我建议更改此模式以将所有不同类型的名称存储在一个表中，并在该表中使用标识符指示它是学生、教师还是家长。

# youtube - 嵌套资源在依赖销毁时未正确销毁

> ID：10290737
> 
> 赞同：0
> 
> 时间：2012-04-24T01:47:18.420
> 
> 标签：youtube, youtube-api, ruby-on-rails-3.2, nested-resources, dependent-destroy

在使用 :dependent => :destroy 时，我遇到了一个 youtube 视频在布道与其布道视频之间嵌套的 belongs_to has_one 关系中被正确销毁的问题。

我正在使用 youtube_it gem 并且有一个相当普通的设置。

以下相关位：

视频控制器——

```
def destroy
  @sermon = Sermon.find(params[:sermon_id])
  @sermon_video = @sermon.sermon_video

  if SermonVideo.delete_video(@sermon_video)
    flash[:notice] = "video successfully deleted"
  else
    flash[:error] = "video unsuccessfully deleted"
  end
  redirect_to dashboard_path
end 
```

视频模型——

```
belongs_to :sermon

def self.yt_session
  @yt_session ||= YouTubeIt::Client.new(:username => YouTubeITConfig.username , :password => YouTubeITConfig.password , :dev_key => YouTubeITConfig.dev_key)
end

def self.delete_video(video)
  yt_session.video_delete(video.yt_video_id)
  video.destroy
    rescue
      video.destroy
end 
```

讲道模式——

```
has_one :sermon_video, :dependent => :destroy

accepts_nested_attributes_for :sermon_video, :allow_destroy => true 
```

在上面的设置中，所有本地数据都被成功删除；但是，youtube上的视频不是。

我试图用模型中的方法覆盖销毁操作，但可能由于我的理解失败，只能从 youtube 中删除视频，或者在本地删除记录，而不能同时获得两者（我发布了下面的两个变体及其结果）。

这只会破坏本地记录——

```
def self.destroy
  @yt_session ||= YouTubeIt::Client.new(:username => YouTubeITConfig.username , :password => YouTubeITConfig.password , :dev_key => YouTubeITConfig.dev_key)
  @yt_session.video_delete(self.yt_video_id)

  @sermon_video.destory
end 
```

这只会破坏 youtube 上的视频，但不会破坏本地资源——

```
def self.destroy
  @yt_session ||= YouTubeIt::Client.new(:username => YouTubeITConfig.username , :password => YouTubeITConfig.password , :dev_key => YouTubeITConfig.dev_key)
  @yt_session.video_delete(self.yt_video_id)
end 
```

最后，我用来销毁布道的链接，以防万一——

```
<%= link_to "Delete", [@sermon.church, @sermon], :method => :delete %> 
```

感谢您的帮助，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:22:08.807

看起来我刚刚解决了这个问题；但是，如果有人有更优雅/更合适的解决方案，我会暂时打开它。

在我添加的讲道视频模型中——

```
before_destroy :kill_everything

def kill_everything
  @yt_session ||= YouTubeIt::Client.new(:username => YouTubeITConfig.username , :password => YouTubeITConfig.password , :dev_key => YouTubeITConfig.dev_key)
  @yt_session.video_delete(self.yt_video_id)
end 
```

我相信，在讲道模型中添加的关键是——

```
accepts_nested_attributes_for :sermon_video, :allow_destroy => true 
```

# c# - 如何按日期时间值对字典进行排序

> ID：10290741
> 
> 赞同：3
> 
> 时间：2012-04-24T01:47:56.483
> 
> 标签：c#, .net, linq, dictionary

我有这本**词典**

```
Dictionary<Guid, DateTime> myDic = new Dictionary<Guid, DateTime>(); 
```

按***DateTime*****对DESC**进行排序的最佳方法是什么？是LINQ吗？

 *如何在代码中完成？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T01:54:21.400

`Dictionary`如果不依赖当前实现的详细信息，您无法对 a 进行排序，但您可以使用 LINQ 的排序功能以任何特定顺序处理其条目：

```
foreach (KeyValuePair<Guid,DateTime> pair in myDict.OrderByDescending(p => p.Value)) {
    // do some processing
} 
```

纯粹出于好奇，您*可以*将有序的键值对传递给`Dictionary`的构造函数，生成的字典将按照在枚举中提供给构造函数的项目的顺序进行枚举。然而，依赖这个功能是非常危险的；你不应该在你的代码中这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T01:57:17.053

你有错误的数据结构来实现你想要的。字典的目的是通过键提供快速访问。存在对自己的键进行排序的 SortedDictionary，但没有对其值进行排序的字典，因为这没有意义。

假设您只需要 myDic 中包含的 DateTimes 降序排序，您可以这样做：

```
var dateTimesDescending = myDic.Values.OrderByDescending(d => d); 
```

这将允许您按降序枚举值，但不会*对字典进行排序*。*

# c# - Wpf Listview 未填充 sqlite

> ID：10290746
> 
> 赞同：1
> 
> 时间：2012-04-24T01:48:05.937
> 
> 标签：c#, wpf, sqlite

我正在尝试从 sqlite 数据库填充列表视图。我的代码是

```
using (SQLiteConnection connection = new SQLiteConnection(@"Data Source=c:\MyProjects\SqliteTest\TestData.db"))
        {
            connection.Open();
            SQLiteDataAdapter ad = new SQLiteDataAdapter();
            SQLiteCommand cmd = new SQLiteCommand();
            String str = "SELECT Name,Email FROM tblInfo";
            cmd.CommandText = str;
            ad.SelectCommand = cmd;
            cmd.Connection = connection;
            DataSet ds = new DataSet();
            ad.Fill(ds);
            myList.DataContext = ds.Tables[0].DefaultView;
            connection.Close();
        } 
```

xaml 代码就像

```
<Grid>
    <ListView x:Name="myList" 
              Height="100" 
              HorizontalAlignment="Left" 
              Margin="10,10,0,0" 
              VerticalAlignment="Top"
              Width="300">
        <ListView.View>
            <GridView>
                <GridViewColumn Width="100" Header="Name"  DisplayMemberBinding="{Binding Path=Name}"></GridViewColumn>
                <GridViewColumn Width="100" Header="Email" DisplayMemberBinding="{Binding Path=Email}"></GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
</Grid> 
```

没有错误，但列表为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T07:29:02.410

您正在将控件的 DataContext 设置为您的 DataSet。您要么需要将 ListView 的 ItemSource 设置为 DataSet，要么将 ItemSource 绑定到 DataContext，例如

```
<ListView ItemsSource={Binding}  ... /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T08:00:01.943

菲尔是对的，但你也可以改变

```
 myList.DataContext = ds.Tables[0].DefaultView; 
```

到

```
 myList.ItemsSource= ds.Tables[0].DefaultView; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T05:46:09.827

数据集没有接口 INotifyCollectionChanged 和 INotifyPropertyChanged。所以 UI 不知道数据集已被填充。

如果数据集更改一次，您只能在填充数据集后绑定（初始化）。

否则，您可以创建一个集合并实现接口。

# php - json数据对象不会追加

> ID：10290749
> 
> 赞同：0
> 
> 时间：2012-04-24T01:48:22.170
> 
> 标签：php, jquery, ajax, json

我是新手，所以轻松一点：

我不明白为什么这个 $.ajax 函数不会将我的 xhr 数据附加到正确的位置。

```
 // gets the cache data from our php file
function getcaches() {
    $.ajax({
        method: 'get',
        url: "php/findcache.php",
        dataType: "json", // return type data is json
        success: function(data){ // <-- data is in json format
            //parse the json data
            $('#caches').append($('<p>' + data[0].name + '</p>'));
        },
        error: function(data) {
            console.log('error');
        }
    });
    return false;   
} 
```

那是相关的javascript。我知道数据已正确存储在对象中，因为我可以在萤火虫中看到它...

```
[OU0397] => stdClass Object
    (
        [code] => OU0397
        [name] => A Mighty Oak in the Open
        [location] => 28.527633|-81.125167
        [type] => Virtual
        [status] => Available
    ) 
```

我只是不明白我做错了什么。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:20:06.603

该代码示例存在 XSS 漏洞（如果名称中包含“<”字符怎么办？）。

不要在没有正确 HTML 编码的情况下将文本值添加到 HTML。您可以使用 jQuery 的 text() 方法来设置元素文本，而不是连接字符串。

```
$('#caches').append($('<p/>').text(data[0].name)); 
```

这可能是您的输出不正确的原因之一。

您可以通过执行 $('#caches') 从 Firebug 或使用 Chrome 开发人员工具调试 jQuery CSS 选择器，它将返回匹配元素的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:12:06.730

如果您有 Firebug，请在此处设置断点：

```
$('#caches').append($('<p>' + data[0].name + '</p>')); 
```

然后你检查`data`. 您的调试数据显示`OU0397`为关键；由于 PHP 的原因`json_encode`，这意味着您可能会得到一本字典。字典以不同的方式遍历（例如`for i in data { ... }`）。

您还可以考虑更改您的 PHP 以仅返回第一个结果；这简化了您的 JavaScript 并减少了网络开销（例如 use `json_encode(current($data))`）。

# asp.net-mvc - 通过 jQuery ajax 将自定义对象发布到 MVC3 操作方法

> ID：10290750
> 
> 赞同：2
> 
> 时间：2012-04-24T01:48:31.113
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery

我有 3 个具有以下定义的类

```
 public class UserRole
    {
        public User User { get; set; }
        public IEnumerable<Role> Role { get; set; }
    }
public class Role
{
   public int Id{ get; set; }
   public string RoleName{ get; set; }
}
public class User
{
   public int Id{ get; set; }
   public string UserName{ get; set; }
} 
```

这是动作方法：

```
 // GET: /Admin/UserManagement/Create
        [HttpPost]
        [Transaction]
        public ActionResult Save(UserRole userrole)
        {
        } 
```

在 Jquery 中有没有办法将一些 JavaScript 变量序列化为类 Obj，然后通过 AJAX 帖子将其发送到 MVC 控制器操作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T06:00:38.803

您可以发送 JSON 请求：

```
var data = {
    user: {
        id: 5,
        userName: 'john'
    },
    role : [
        { id: 1, roleName: 'role 1' },
        { id: 2, roleName: 'role 2' },
        { id: 3, roleName: 'role 3' }
    ]
};

$.ajax({
    url: '@Url.Action("Save")',
    type: 'POST',
    contentType: 'application/json',
    data: JSON.stringify(data),
    success: function(result) {
        alert('success');
    }
}); 
```

该`JSON.stringify`方法本机内置于现代浏览器中，但如果您需要支持旧版浏览器，您可以包含[json2.js](https://github.com/douglascrockford/JSON-js)脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T04:21:01.333

开箱即用且所有部分都满意的最简单方法（jQuery、MVC 框架）是将对象图序列化为客户端上的 JSON 数据并将其传递到 POST。MVC 框架实际上非常擅长为您整理模型绑定。

这里有一个带有类似复杂对象的可下载示例：http: [//theycallmemrjames.blogspot.ca/2010/05/aspnet-mvc-and-jquery-part-4-advanced.html](http://theycallmemrjames.blogspot.ca/2010/05/aspnet-mvc-and-jquery-part-4-advanced.html)

它处理许多不同场景中的模型绑定。根据您的需要查看手提箱示例。免责声明：这是我的博客，希望不要冒犯。

干杯。

# ruby-on-rails - 如何在 Rails 的“where”查询中只选择关联的对象？

> ID：10290751
> 
> 赞同：0
> 
> 时间：2012-04-24T01:48:31.770
> 
> 标签：ruby-on-rails, activerecord

我有一个模型类别，其中有_many 产品，而产品又是 has_many 类别。当用户搜索类别时，我想返回匹配类别的产品而不会丢失我的 Arel 对象。这是我到目前为止所拥有的：

```
Category.where("upper(title) like ?", search_term.upcase).map {|category| category.products}.flatten 
```

这是退回产品的诀窍，但当然我拥有的是一个数组而不是 Arel。我可以添加一个`:includes(:products)`子句，所以我确实可以取回产品，但我仍然将它们附加到它们的类别中。如何调整我的查询，以便我得到的只是一个仅针对产品的 Arel？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:23:07.730

如果是您想要的产品，那么您可能应该在搜索时从 Product 对象开始。例如，你可以这样做：

```
Product.joins(:categories).where("upper(categories.title) like ?", search_term.upcase) 
```

我使用 not 的原因`joins`是`includes`join 将执行 INNER JOIN 而不是 LEFT OUTER JOIN，这是您只需要返回与找到的类别实际关联的产品。

为了使它更优雅一点，您可以将它全部包装在 Product 模型的范围中，如下所示：

```
# In Product.rb
scope :in_categories_like, Proc.new{ |search_term|
  joins(:categories).where("upper(categories.title) like ?", search_term.upcase) 
}

# In use
@products = Product.in_categories_like(params[:search_term]) 
```

# mysql - MySQL CodeIgniter 中的数据库结构 Phpadmin

> ID：10290754
> 
> 赞同：0
> 
> 时间：2012-04-24T01:48:39.780
> 
> 标签：mysql, database, codeigniter, phpmyadmin

想象一下，我们有一个 phpadmin 数据库，我们有一个学生表，student_music 和 student_friend student_friend_music。有四个表在性能上有意义吗？还是您认为我们需要为学生 student_friends student_music 和音乐表提供三个表。facebook如何在它的数据库中存储朋友关系？

另一件事是我为两者设计了数据库。我不知道我是否看到任何区别，但我认为一旦用户增加，一个会击败其他性能明智？

所以我的问题涉及查询的性能：拥有更多表更好还是我们可以重复。

你知道我可以学习的任何好书、教程或参考资料，以了解 Php my admin 和 mysql 中的关系数据库。

更新：Table Student 可以与自身有多对多的关系。餐桌音乐也与学生有多对多。

```
Student id Student_friend  Music id     STUDENT_MUSIC     
  A      1      1-3         YT    1          1  3
  B      2      2-3         RU    2          2  3
  C      3                  PI    3          3  1
                                             3  2 
```

所以我在代码点火器中使用了一个叫做 Data Mapper 的东西，这让我很头疼，但这听起来像是我现在正在考虑的结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:05:12.663

表建议：

table_students（包括学生信息等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:13:47.140

查看此[链接](http://www.tizag.com/mysqlTutorial/)以获取 mysql 介绍和有关关系数据库的[wikipedia](http://en.wikipedia.org/wiki/Relational_database)文章。阅读有关表、主键和外键的信息。在担心性能之前，您需要解决数据库的结构。

尝试（[一对多](http://www.tomjewett.com/dbdesign/dbdesign.php?page=association.php)：一个学生可以拥有多首音乐并有一个朋友）：

```
CREATE TABLE Student(
    id INT NOT NULL AUTO_INCREMENT, 
    PRIMARY KEY(id),
    first_name VARCHAR(30),
    last_name VARCHAR(30),
    friend_id INT)

CREATE TABLE Music(
    id INT NOT NULL AUTO_INCREMENT, 
    PRIMARY KEY(id),
    music_title VARCHAR(30),
    music_student_id INT)
    FOREIGN KEY (music_student_id) REFERENCES Student(id)
                  ON DELETE CASCADE 
```

或者尝试（[多对多](http://www.tomjewett.com/dbdesign/dbdesign.php?page=manymany.php)：很多学生可以拥有很多音乐并有很多朋友）：

```
CREATE TABLE Student(
    id INT NOT NULL AUTO_INCREMENT, 
    PRIMARY KEY(id),
    first_name VARCHAR(30),
    last_name VARCHAR(30))
    FOREIGN KEY (id) 
    REFERENCES StudentMusic (Student_id)
    ON DELETE CASCADE

CREATE TABLE Music(
    id INT NOT NULL AUTO_INCREMENT, 
    PRIMARY KEY(id),
    music_title VARCHAR(30),
    FOREIGN KEY (id) 
    REFERENCES StudentMusic (Music_id)
    ON DELETE CASCADE

CREATE TABLE StudentMusic (
    Student_id INT NOT NULL AUTO_INCREMENT, 
    Music_id INT NOT NULL AUTO_INCREMENT, 
    PRIMARY KEY  (Student_id,Music_id)

CREATE TABLE Friendships(
    student_A_id INT,
    student_B_id INT)
    PRIMARY KEY  (student_A_id,student_B_id) 
```

可以使用 Select 语句显示处理关系的数据视图。在一对多设计中，查找学生的音乐使用以下查询：

```
Select Student.first_name,Student.last_name,Music.music_title 
FROM Student 
LEFT JOIN Music on (Student.ID=Music.music_student_id) 
```

设计数据库的一部分是弄清楚您需要查询哪些关系。

还研究[规范化数据库](http://en.wikipedia.org/wiki/Database_normalization)。

# iphone - 如何使用界面生成器在 tableView 中添加视图

> ID：10290757
> 
> 赞同：1
> 
> 时间：2012-04-24T01:49:44.003
> 
> 标签：iphone, objective-c, ios, xcode, interface-builder

嗨，我正在学习 iOS 编程。

我想知道使用界面生成器。

我制作了一个 tableViewController 并制作了 .xib 文件

现在我可以在界面生成器中看到 UITableView。

我必须添加一个名为 myView 的视图，其中包含按钮、标签等。

我想将 myView 设置在 tableView 区域的顶部，例如 tableview 的标题。

所以我制作了一个 myView，并添加了按钮、标签等。

然后我将该视图拖到 UITableView 中。好的，这很好。

我可以看到 myView 在界面生成器中设置在 UITableView 的顶部。

但我运行程序，myView 没有出现。

当然使用 IBOutlet 连接，并声明属性和综合。

但我像这样使用 NSLog

```
if(self.myView == nil)
   NSLog(@"omg it's nil!!!"); 
```

我无法理解 NSLog 打印在我的提示区域。

因为我在界面生成器中制作了那个视图！

我可以看到tableView，当然可以看到单元格。

为什么 myView 没有出现？

我该如何解决？

我想知道如何使用界面生成器修复它。

请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:01:06.537

不确定这是否可以使用界面生成器，我通常手动创建一个视图并将其添加到 viewWillAppear 方法中的 tableview 标题中，如下所示：

```
 UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.tableView.bounds.size.width, 60)];  
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 10,self.tableView.bounds.size.width, 50)];
    label.text = [person getFullName];
    label.textAlignment = UITextAlignmentCenter;
    label.backgroundColor = [UIColor clearColor];
    label.font = [UIFont boldSystemFontOfSize:25];
    label.shadowColor = [UIColor whiteColor];
    label.shadowOffset = CGSizeMake(0,1);
    [headerView addSubview:label];

    self.tableView.tableHeaderView = headerView; 
```

更简单的方法是在单独的 nib 文件中创建一个视图，然后在加载 tableview 时将其加载到表头中，如下所示：

```
UIViewController *aViewController = [[UIViewController alloc] initWithNibName:@"MYXIBFILEHERE" bundle:nil];
self.tableView.tableHeaderView = aViewController.view; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T15:03:50.520

我对 XCode 4.3 的体验：

您必须首先将 UITableView 和 UIView 放在同一个超级 UIView 上。然后，当将 UIView 拖到 UITableView 的顶部时，您会注意到 XCode 突出显示了将视图作为页脚插入的选项。

完成后，您可以从 superview 中分离 UITableView 并将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-12T12:33:30.953

我能够让它工作的唯一方法如下：

1.  将新的 nib 文件添加到项目中。按照您希望表格页脚/页眉的外观布置 nib 文件中的视图。
2.  将 nib 中文件所有者的类设置为 UITableViewController 的类。这样我们就可以将这个 nib 中的视图连接到 UITableViewController 类中的 IBOutlet。
3.  在您的 UITableViewController 中设置一个 UIView IBOutlet 以指向新笔尖中的视图。
4.  在您的 UITableViewController 类中，在 viewDidLoad 中执行以下操作：

（显然，如果代码直接位于编号列表之后，则其格式将不正确。）

```
[[NSBundle mainBundle] loadNibNamed:@"statsFooterView" owner:self options:nil];
self.tableView.tableFooterView = myFooterView; 
```

# winapi - 找出哪台计算机/用户在网络共享文件夹中创建、更改或删除了文件

> ID：10290761
> 
> 赞同：0
> 
> 时间：2012-04-24T01:50:54.763
> 
> 标签：winapi, filesystems, filesystemwatcher, shared-directory

通过`FileSystemWatcher`在其事件中使用 , 我想知道触发该事件的计算机名称或 IP 或用户。

我知道直接使用 是不可能的`FileSystemWatcher`，但我想知道 Windows 是否为文件系统存储了该信息。

那么，你能至少指出我从哪里开始寻找它吗？如果有任何 Win Api 可以做这样的事情或类似的事情，即使在非常低的级别？

**编辑：**

进一步澄清：

我不想使用低级 API 或类似的东西给我最后一个修改相关文件的用户。

# php - 转换 NSArray -> JSON -> NSData -> PHP 服务器 -> JSON 表示

> ID：10290767
> 
> 赞同：12
> 
> 时间：2012-04-24T01:51:24.253
> 
> 标签：php, objective-c, ios, json, asiformdatarequest

我正在使用以下内容将 NSDictionaries 数组转换为 JSON 数据...

创建我的数据...

```
NSMutableArray *arrayOfDicts = [[NSMutableArray alloc] init];

for (int i = 0; i < 2; i++) {
    NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:
                                  @"MySong", @"title",
                                  @"MyArtist", @"artist",
                                  nil];
    [arrayOfDicts addObject:dict];         
}
 NSArray *info = [NSArray arrayWithArray:arrayOfDicts];
 NSData* jsonData = [NSJSONSerialization dataWithJSONObject:info 
      options:NSJSONWritingPrettyPrinted error:&error]; 
```

然后像这样发送...

```
NSURL *url = [NSURL URLWithString:@"http://www.mywebsite.com/index.php"];
    ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
    [request setPostValue:jsonData forKey:@"songs"];
    [request setDelegate:self];
    request.tag = TAG_LOAD_SONGS;
    [request startAsynchronous]; 
```

这是将 NSData 发送到我的服务器，但是我如何在 php 中使用它......如果我从我的服务器打印它，它实际上只是一堆随机数，我尝试使用 json_encode 但我不认为这意味着原始数据...

任何帮助都会很棒！

编辑：这是 php 的响应...

```
echo $_POST['songs'];

<5b0a2020 7b0a2020 20202274 69746c65 22203a20 224d7953 6f6e6722 2c0a2020 20202261 72746973 7422203a 20224d79 41727469 7374220a 20207d2c 0a20207b 0a202020 20227469 746c6522 203a2022 4d79536f 6e67222c 0a202020 20226172 74697374 22203a20 224d7941 72746973 74220a20 207d0a5d> 
```

这是对 Xcode 中 NSLoging 的响应...

```
NSLog(@"Info: %@", info); 
```

信息：（{艺术家=我的艺术家；标题=我的歌曲；}，{艺术家=我的艺术家；标题=我的歌曲；}）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-25T20:53:02.573

原来我需要这样做：

创建我的数据：

```
NSMutableArray *arrayOfDicts = [[NSMutableArray alloc] init];

for (int i = 0; i < 2; i++) {
    NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:
                                  @"MySong", @"title",
                                  @"MyArtist", @"artist",
                                  nil];
    [arrayOfDicts addObject:dict];         
}
 NSArray *info = [NSArray arrayWithArray:arrayOfDicts]; 
```

并像这样发送：

```
NSData *jsonData = [NSJSONSerialization dataWithJSONObject:info 
          options:NSJSONWritingPrettyPrinted error:&error];
NSString *jsonString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];

    // Start request
    NSURL *url = [NSURL URLWithString:@"http://www.mywebsite.com/index.php"];
    ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
    [request setPostValue:jsonString forKey:@"songs"];
    [request setDelegate:self];
    [request startAsynchronous]; 
```

关键是将信息转换为`NSData`，然后转换为我发送到服务器的 JSON 字符串，而不仅仅是发送原始的`NSData`.

感谢大家的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:55:06.730

`<?php $array = json_decode($_POST['songs']); ?>`应该管用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T03:43:36.270

你不能这样发送。NSJSONSerialization 供 iOS 使用。它基本上是一个plist。您将需要一种在 PHP 上对其进行解码的方法，我怀疑它是否存在。相反，您需要发送一个 JSON 字符串。我不确定您所说的“在标题周围留下引号”是什么意思。他们首先在那里做什么？您可以在这里验证您的原始 JSON 字符串[吗](http://jsonlint.com/)？

# java - 如何从 Java Servlet 中的多个表 (PostgreSQL) 中检索数据？

> ID：10290768
> 
> 赞同：0
> 
> 时间：2012-04-24T01:51:38.107
> 
> 标签：java, postgresql, servlets

我在从多个表中检索数据时遇到困难。它将是一个搜索表单及其关系数据库。

**问题1：**我现在如何从多个表中检索数据？

**问题2：**同时我面临的另一个问题是，如果我尝试仅按姓名或姓氏进行搜索，我将无法获得任何结果。只有当我使用出生日期时才能得到结果。为什么？

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        java.io.PrintWriter out = response.getWriter();
        Connection conn = null;{ // while there is no connections, proceed to the next step
        try {
            Class.forName("org.postgresql.Driver"); // importing the driver to use the getConnection method
            conn = DriverManager.getConnection(
                    "jdbc:postgresql://localhost:5432/caglar", "postgres", //?searchpath=cag
                    "abracadabra");
            System.out.println("Connected to the database"); // console message
            String  agent_name  = request.getParameter("givenname"); // variable - reads from user input
            String  agent_lastname  = request.getParameter("familyname"); // variable - reads from user input
            String  dob  = request.getParameter("birthyear"); // variable - reads from user input

            ArrayList al=null;
            ArrayList agent_list =new ArrayList();

            //Problem 1: If dob is not given, it is not searching by name or lastname.

            //String query = "select * from agent where givenname='"+agent_name+"' or familyname='"+agent_lastname+"' or birthyear='"+dob+"' order by givenname";

            String query = "select * from agent where givenname='"+agent_name+"' or familyname='"+agent_lastname+"' ";
            if(dob!=null && !"".equals(dob)) // if date of birth fiel is left blank, it will still proceed to the results page
              query = query + " or birthyear='"+dob+"'"; // if date of birth exists, it will take it into account as well

            query = query+  "order by givenname"; // ordering by first name

            System.out.println("query" + query); // console message
            Statement st = conn.createStatement(); // connection statement
            ResultSet  rs = st.executeQuery(query); // executing our query

            while(rs.next())
            {
                al  = new ArrayList();

              al.add(rs.getString(1));//id
              al.add(rs.getString(2));//dob
              al.add(rs.getString(3));//name
              al.add(rs.getString(4));//lastname
              System.out.println("al :: "+al);
              agent_list.add(al);
            }

            request.setAttribute("agentList",agent_list); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T06:55:04.703

重申其他人在上面指出的内容，这是“危险”代码。如果不使用 PreparedStatements，您就会向 SQL 注入攻击敞开心扉——恶意用户可以通过这种攻击制作 SQL 语句来删除表中的所有数据。正如上面@craig-ringer 指出的那样，提交数据会从数据库中删除表是微不足道的。

指出了这一点，在它下面划了几次下划线并用荧光黄色标记突出显示，让我们继续尝试回答你的问题：

1）您可以使用SQL Joins从多个表中查询数据。[这是关于 JOINS 的 PostgreSQL 教程](http://www.postgresqlguide.com/retrieving-data-from-multiple-tables-by-using-sql-join.aspx)——还有很多其他的，我只是选择了我找到的第一个。

2）如果没有数据库中的确切数据，并且没有提供确切的参数，很难回答 - 但是，我认为问题是区分大小写。PostgreSQL 中的比较区分大小写 - 因此如果数据库中的姓氏是“Smith”且参数是“smith”，则不会找到任何数据。因此，为简单起见，您需要将参数和数据都转换为相同的情况，例如更低。例如 SELECT * FROM agent where LOWER(familyname)='smith'

我还要指出，您可能会遇到日期格式问题 - 再次，这将使用准备好的语句来解决。

看来您对 java、SQL 和 JDBC 还很陌生；我建议您尝试遵循一些教程并阅读一些书籍。有很多事情要处理 - 祝你好运！

# c - 创建静态库

> ID：10290771
> 
> 赞同：4
> 
> 时间：2012-04-24T01:52:29.803
> 
> 标签：c, gcc, static-libraries, static-linking, php-extension

我正在尝试创建一个静态库以在我的 PHP 扩展中使用。为此，我正在`.c`使用`gcc -c file.c -o file.o`和获取文件来编译我的`.o`文件。然后我使用`ar rcs lib.a *.o`将所有编译的对象归档到一个`.a`文件中。

这样做之后，我`.a`在编译我的 PHP 扩展时引用了这个文件，但是我得到了以下错误：

```
*** Warning: Linking the shared library <extension>.la against the
*** static library lib.a is not portable! 
```

如果我使用`.o`文件而不是`.a`文件，我会得到：

```
*** Warning: Linking the shared library <extension>.la against the non-libtool
*** objects  file1.o file2.o is not portable! 
```

我做错了什么，正确的做法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T02:30:52.857

简短的回答：共享库（PHP 扩展是一种特殊情况）不能依赖于静态库。

实际上，这并不完全正确。只要您的静态库是作为位置无关代码 (PIC) 构建的，就可以从共享库中使用它；需要存档中的任何`.o`文件来满足`.o`您明确链接的文件中的未定义符号，以使它们`.so`被拉入并成为共享库文件的一部分。

将非 PIC`.o`文件链接到共享库也适用于*某些*拱门（如 i386），但它不可移植（并且不适用于 x86_64）。

至于你应该做什么，如果可能的话，我会忘记中间`.a`文件并将所有`.o`文件显式链接到`.so`扩展文件中。这是干净和简单的。或者，只要您确定所有文件都构建为 PIC（即带有`-fPIC`选项），您就可以继续按照您的方式进行操作。

我不会做的是制作并安装一个额外`.so`的文件，然后扩展的主`.so`文件将依赖它。所有这些都会造成膨胀，增加加载时间，并在部署/集成方面造成很多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T04:47:36.187

将共享库链接到静态库是不可能的（除非您真的非常清楚自己在做什么）。不要这样做。

第一个警告来自 libtool。它告诉你，你要求的操作将在不同的系统上做不同的事情，其中​​一些事情可能不是你想要的。通常它会以各种惊人的方式失败，因为共享和静态库中的代码需要使用不同的编译器标志进行编译。

我曾经遇到过同样的问题，但我已经通过在make文件中纠正一些链接标志来解决它，你可以看到

[“警告：将共享库与静态库链接起来不可移植”是什么意思？](https://stackoverflow.com/questions/8352617/what-is-the-meaning-of-warning-linking-the-shared-library-against-static-libra)

# apache-pig - 如何将元组中的多个字段乘以元组的给定字段

> ID：10290772
> 
> 赞同：1
> 
> 时间：2012-04-24T01:52:32.823
> 
> 标签：apache-pig

对于每一行数据，我想将字段 1 到 N 乘以字段 0。数据每行可能有数百个字段（或就此而言可变数量的字段），因此写出每一对是不可行的。有没有办法指定一系列字段，有点像下面的（不正确的）片段？

```
A = LOAD 'foo.csv' USING PigStorage(','); 
B = FOREACH A GENERATE $0*($1,..); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T11:04:03.253

[UDF](http://wiki.apache.org/pig/UDFManual)可以在这里派上用场。

实现 exec(Tuple input) 并迭代元组的所有字段，如下所示（未测试）：

```
public class MultiplyField extends EvalFunc<Long> {
    public Long exec(Tuple input) throws IOException {
        if (input == null || input.size() == 0) {
            return null;
        }
        try {
        Long retVal = 1;
        for (int i = 0; i < input.size(); i++) {
            Long j = (Long)input.get(i);
            retVal *= j;
        }
        return retVal;
        } catch(Exception e) {
            throw WrappedIOException.wrap("Caught exception processing input row ", e);
        }
    }
} 
```

然后注册您的 UDF 并从您的 FOREACH 调用它。

# windows - 如何使用 VBScript/JScript（独立）发送带有 IE cookie 的 HTTPS 请求？

> ID：10290774
> 
> 赞同：0
> 
> 时间：2012-04-24T01:53:35.467
> 
> 标签：windows, internet-explorer, cookies, https, jscript

如何使用 JScript/VBScript（在独立的 JS 或 VBS 文件中——**而不是**在浏览器中）使用 Internet Explorer 的当前 cookie 向服务器发送 HTTPS GET 请求？

# java - java 程序如何知道它是否已由 eclipse 的“调试”而不是“运行”启动？

> ID：10290776
> 
> 赞同：3
> 
> 时间：2012-04-24T01:53:42.193
> 
> 标签：java, eclipse, debugging

> **可能重复：**
> [确定 java 应用程序是否在 Eclipse 中处于调试模式](https://stackoverflow.com/questions/1109019/determine-if-a-java-application-is-in-debug-mode-in-eclipse)

`run as`我可以在 Eclipse 中通过或启动一个 java 程序`debug as`。

java代码中有什么方法可以检查它是否由`run`or启动`debug`？我只想在它存在时做一些事情（例如重新加载资源）`debug mode`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:00:46.733

真的是 eclipse 谁在做魔术，通过在调试模式下启动 jvm 打开一个 tcp 端口来附加一个调试器，所以，如果你想检查你是否处于调试模式，你可能想检查那个端口是否正在占用连接，至少是我能想到的一种方式。

# hibernate - grails - 复合键，休眠映射异常

> ID：10290778
> 
> 赞同：0
> 
> 时间：2012-04-24T01:53:53.550
> 
> 标签：hibernate, grails, grails-orm, composite-key

以下 Domain 类在启动时提供此映射异常：

> *创建名为“sessionFactory”的 bean 时出错：调用 init 方法失败；嵌套* *异常是 org.hibernate.MappingException:Foreignkey* (FKA9FB5C607D60EAE9:person_examschedule [testingcenter_examschedule_id dummy_table,testing_center_exam_schedule_testing_center_id,testing_center_exam_schedule_exam_schedule_id]) 必须具有与引用的主键相同的列数 (testingcenter_examschedule_test])

```
class TestingCenterExamSchedule implements Serializable{

Long testingCenterId
ExamSchedule examSchedule
TestingCenter testingCenter   
int bufferedSlots

static transients = ['testingCenter']

static constraints = {
    examSchedule nullable: false
    testingCenter nullable: false
    testingCenterId nullable: false
    bufferedSlots nullable:false
}

static mapping = {
    table 'testingcenter_examschedule'
    version false
    id composite: ['testingCenterId','examSchedule']
    testingCenterId column: 'testingcenter_id'
    examSchedule column: 'examschedule_id'
    bufferedSlots column: 'buffered_slots'

} 
```

这是我的另一个域类，它也有一个复合键

```
class RegistrantTestingCenterExamSchedule implements Serializable {

Registrant registrant
TestingCenterExamSchedule testingCenterExamSchedule

static constraints = {
    registrant nullable: false
    testingCenterExamSchedule nullable: false
}

static mapping = {
    table 'person_examschedule'
    version: false
    id composite: ['registrant', 'testingCenterExamSchedule']
    columns {
        registrant column: 'person_id'
        testingCenterExamSchedule column: ['testingcenter_examschedule_id', 'dummy_table']
    }
} 
```

我很难解决这个问题，由于我现有的架构，我想完成这项工作，谁能告诉我问题是什么以及如何解决它？

感谢您分享您的知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T15:00:26.887

在 TestingCenterExamSchedule 中，您已将 testingCenter 声明为瞬态属性，我想知道这是否不会导致 GORM 映射出现问题？无论如何，您似乎在不必要地映射列，即使您正在映射到现有/旧表模式，您定义的许多列也应该自动创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-22T02:10:14.717

我相信这是[我面临的同样问题](https://stackoverflow.com/questions/35563283/gorm-doesnt-handle-mapping-of-associations-which-have-a-further-association-in)。

Brass tacks：很确定这是 GORM-Hibernate 的一个错误，[我已经在这里记录了](https://github.com/grails/grails-data-mapping/issues/660)。

解决方法是剥离关联映射并创建为您手动加载关联的 getter 和 setter。这不一定对所有用例都足够。

¯\_(ツ)_/¯

# c# - c# 上下移动列表框中的项目

> ID：10290780
> 
> 赞同：0
> 
> 时间：2012-04-24T01:54:12.953
> 
> 标签：c#, .net, c#-4.0

我有一个带有显示内容的列表框的 Windows 窗体应用程序，我希望能够在单击按钮时上下移动列表框中的项目。目前列表框中的项目存储在文本文件中，该文件在应用程序启动时加载到配置类中。我将如何向上/向下移动项目并更改文本文件中的顺序？

我的主要申请表格代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace company1
{
    public partial class Form1 : Form
    {
        List<Configuration> lines = new List<Configuration>();

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.listBox1.Items.Clear();
            //Read in every line in the file
            using (StreamReader reader = new StreamReader("file.txt"))
            {
                string line = reader.ReadLine();
                while (line != null)
                {
                    string[] array = new string[] { "\\n" };
                    string[] parts = new string[3];
                    parts = line.Split(array, StringSplitOptions.RemoveEmptyEntries);
                    lines.Add(new Configuration(parts[0], int.Parse(parts[1]), int.Parse(parts[2])));
                    line = reader.ReadLine();
                }

            }
            listBox1.DataSource = lines;
            listBox1.DisplayMember = "CompanyName";
        }
    }
} 
```

配置类文件

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace company1
{
    class Configuration
    {
        string _CompanyName;
        int _Employees;
        int _Half;

        public Configuration(string companyname, int number_of_Employees, int half)
        {
            _CompanyName = companyname;
            _Employees = number_of_Employees;
            _Half = half;
        }

        //program properties and validation
        public string CompanyName
        {
            set
            {
                _CompanyName = value;
            }
            get
            {
                return _CompanyName;
            }
        }// End of levelname validation

        //program properties and validation
        public int EmployeesNumber
        {
            set
            {
                _Employees = value;
            }
            get
            {
                return _Employees;
            }
        }// End of levelname validation

        //program properties and validation
        public int Half
        {
            set
            {
                _Half = value;
            }
            get
            {
                return _Half;
            }
        }// End of levelname validation
    }

} 
```

任何帮助表示赞赏，几天来一直在努力让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:02:46.490

```
// change the items in source list
var tmpLine = lines[10];
lines[10] = lines[9];
lines[9] = tmpLine;

// refresh datasource of listbox
listBox1.DataSource = null;
listBox1.DataSource = lines; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T04:33:55.430

您可以为列表定义扩展方法以根据索引移动项目：

```
public static class ExtensionClass
{
    public static void Move<T>(this List<T> list, int index1, bool moveDown = true)
    {
        if (moveDown)
        {
            T temp = list[index1];
            list[index1] = list[index1 + 1];
            list[index1 + 1] = temp;
        }
        else
        {
            T temp = list[index1];
            list[index1] = list[index1 - 1];
            list[index1 - 1] = temp;

        }
    }
} 
```

然后在代码中你可以：

```
List<int> list = new List<int> { 1, 2, 3, 4, 5, 6, 7 };
            Console.WriteLine("Original List");
            foreach (int i in list)
            {
                Console.Write(i + ",");
            }
            Console.WriteLine(Environment.NewLine + "Move Index 2 Down");
            list.Move(2);
            foreach (int i in list)
            {
                Console.Write(i + ",");
            }
            Console.WriteLine(Environment.NewLine + "Move Index 3 Up");
            list.Move(3, false);
            foreach (int i in list)
            {
                Console.Write(i + ",");
            } 
```

输出将是：

```
Original List
1,2,3,4,5,6,7,
Move Index 2 Down
1,2,4,3,5,6,7,
Move Index 3 Up
1,2,3,4,5,6,7, 
```

# javascript - Twitter 的 UI 如何在其 HTML5 iPhone 移动网站上如此快速地响应？

> ID：10290786
> 
> 赞同：0
> 
> 时间：2012-04-24T01:55:30.413
> 
> 标签：javascript, iphone, performance, html, mobile

Twitter 在 iPhone 上的新 HTML5 移动网站在移动浏览器中的速度非常快。他们使用什么技术为他们的网站创造接近原生的体验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:26:53.657

它的速度非常快，并且有很多技术可以实现这一目标。让我们介绍其中的一些：

**最小化 HTTP 请求**

因此，从简单开始并查看源代码，您将一团糟……一切。他们正在做一些服务器端的幻想，以在 HTML 页面上包含所有的 CSS 和 Javascript。这样做的好处是单个请求可以为您提供所有初始布局代码。这就是为什么页面在第一次加载时是黑色的。最小化 HTTP 请求是提高站点性能的最佳方法之一，并且有许多与之相关的技术（CSS 压缩、Javascript 压缩、创建 spritemap..）

这使我们：

**创建一个精灵图**。

查看网络流量中包含的 sprite.png。它有所有的图标。一个单独的列表很好地解释了它是如何工作的：

[http://www.alistapart.com/articles/sprites](http://www.alistapart.com/articles/sprites)

简单的解释是您有一个大图形，并使用 CSS 创建一个窗口，只查看其中的一个特定部分。再次使用单个图形可以最大限度地减少 HTTP 请求。

**使用 CSS3**

特别感兴趣的是，您可以使用[twitter bootstrap](http://twitter.github.com/bootstrap/)进一步研究这些按钮。按钮不是图形；它们是 CSS3 渐变（顶部有一个图形图标）。此页面提供的任何设备都应支持 CSS3 渐变，因此这是一种创建漂亮界面的安全且轻便的方式。

**延迟加载**

背景图像需要一秒钟才能出现，因为它是在事后通过 Javascript 请求的。这是最后的幻想——只有在页面准备好使用时才请求像大图像这样的重物。

希望对你有帮助，有问题可以追问！

# javascript - 将结果添加到对象

> ID：10290799
> 
> 赞同：0
> 
> 时间：2012-04-24T01:57:46.533
> 
> 标签：javascript

我有一个小函数，可以将返回的结果添加到对象列表中，但我遇到的问题是，如果有某个重复，它将不允许它 - 但有些方面会发生重复，而其他方面则不会......

我将通过示例更好地解释：

```
var data = {"24":{"16":["172"],"15":["160"]}} 
```

此数据列表转换为：

```
var data = {"X":{"Y":["id"],"Y":["id"]}}; 
```

现在我试图插入这样的新数据：

```
 for(var key in result){              
      if(result.hasOwnProperty(key)){  
      data[key] = result[key];     
        }
    } 
```

如果考虑网格坐标，在我的对象列表中，Y 不能在同一个 X 中复制，X 根本不能复制。

这是我试图插入的“结果”示例数据：

```
{24: {13:[187]}} 
```

从而将 var 数据转换为：

```
var data = {"24":{"16":["172"],"15":["160"],"13":["187"]}}; 
```

有谁知道我如何为我的循环实施重复检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:10:42.327

```
// Declare this temporary object we'll use later
var obj = {}

for ( var key in result ){              
    if ( result.hasOwnProperty( key ) ) {
        // If the key already exists
        if ( data[ key ] === result[ key ] ) {

            // Empty the temporary object
            obj = {}
            // Loop through the subkeys
            for ( var subkey in result[ key ] ) {              
                if ( result[ key ].hasOwnProperty( [ subkey ] ) ) {

                    // Fill in the temporary object
                    obj[ subkey ] = result[ key ][ subkey ]
                }
            }

            // Add the new object to the original object
            data[ key ] = obj
        }

        // If the key doesn't exist, do it normally
        else {
            data[ key ] = result[ key ]
        }
    }
}

// Now, to be tedious, let's free up the memory of the temporary object!
obj = null 
```

像这样的东西应该工作。如果发生冲突，我会重建内联对象，以便可以将其与所有原始和新键/值一起添加回来。

PS：最后一行纯属娱乐。

# r - 获取在矩阵的行中保存最大值的列名，在数组中保存单独的最大值

> ID：10290801
> 
> 赞同：12
> 
> 时间：2012-04-24T01:57:56.683
> 
> 标签：r, indexing, max

例如给出：

```
dim1 <- c("P","PO","C","T")
dim2 <- c("LL","RR","R","Y")
dim3 <- c("Jerry1", "Jerry2", "Jerry3")
Q <- array(1:48, c(4, 4, 3), dimnames = list(dim1, dim2, dim3)) 
```

我想在这个数组中引用在（第 3 行，第 4 列）位置具有最大 dim3 值的矩阵。

在确定该矩阵后，我想返回在矩阵（第 3 行，第 1 列）到（第 3 行，第 3 列）范围内具有最大值的列名。

所以我希望发生的是 Jerry3 被引用，因为数字 47 存储在它的第 3 行第 4 列中，然后在 Jerry3 中，我希望第 3 行中的最大数字被引用，即 43，并且最终，我需要返回的（我需要的唯一值）是列名，即“R”。

这就是我需要知道如何做的，获得那个“R”并将它分配给一个变量，即“column_ref”，这样column_ref <-“R”。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-24T02:24:07.700

这应该这样做 - 如果我理解正确：

```
Q <- array(1:48, c(4,4,3), dimnames=list(
  c("P","PO","C","T"), c("LL","RR","R","Y"), c("Jerry1", "Jerry2", "Jerry3")))

column_ref <- names(which.max(Q[3,1:3, which.max(Q[3,4,])]))[1] # "R" 
```

一些解释：

```
which.max(Q[3,4,]) # return the index of the "Jerry3" slice (3)
which.max(Q[3,1:3, 3]) # returns the index of the "R" column (3) 
```

...然后`names`返回索引的名称（“R”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-20T20:24:46.423

这里有一个简单的解决方法：

```
 mxCol=function(df, colIni, colFim){ #201609
  if(missing(colIni)) colIni=1
  if(missing(colFim)) colFim=ncol(df)
  if(colIni>=colFim) { print('colIni>=ColFim'); return(NULL)}
  dfm=cbind(mxC=apply(df[colIni:colFim], 1, function(x) colnames(df)[which.max(x)+(colIni-1)])
           ,df)
  dfm=cbind(mxVal=as.numeric(apply(dfm,1,function(x) x[x[1]]))
           ,dfm)
  returndfm
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-13T14:36:48.813

这篇文章帮助我解决了一个 data.frame 的一般问题。
我对组重复测量，`G1`e `G2`。

```
> str(df)
'data.frame':   6 obs. of  15 variables:
$ G1       : num  0 0 2 2 8 8
$ G2       : logi  FALSE TRUE FALSE TRUE FALSE TRUE
$ e.10.100 : num  26.41 -11.71 27.78 3.17 26.07 ...
$ e.10.250 : num  27.27 -12.79 29.16 3.19 26.91 ...
$ e.20.100 : num  29.96 -12.19 26.19 3.44 27.32 ...
$ e.20.100d: num  26.42 -13.16 28.26 4.18 25.43 ...
$ e.20.200 : num  24.244 -18.364 29.047 0.553 25.851 ...
$ e.20.50  : num  26.55 -13.28 29.65 4.34 27.26 ...
$ e.20.500 : num  27.94 -13.92 27.59 2.47 25.54 ...
$ e.20.500d: num  24.4 -15.63 26.78 4.86 25.39 ...
$ e.30.100d: num  26.543 -15.698 31.849 0.572 29.484 ...
$ e.30.250 : num  26.776 -16.532 28.961 0.813 25.407 ...
$ e.50.100 : num  25.995 -14.249 28.697 0.803 27.852 ...
$ e.50.100d: num  26.1 -12.7 27.1 2.5 27.4 ...
$ e.50.500 : num  28.78 -9.39 25.77 2.73 23.73 .. 
```

我需要知道哪个度量（列）具有最佳（最大）结果。而且我需要不考虑分组列。
我最终得到了这个功能

```
apply(df[colIni:colFim], 1, function(x) colnames(df)[which.max(x)+(colIni-1)] 
#colIni: first column to consider; colFim: last column to consider 
```

有了列名后，另一个小函数来获取最大值

```
apply(dfm,1,function(x) x[x[1]]) 
```

以及解决类似问题的函数，即返回列和最大值

```
mxCol=function(df, colIni, colFim){ #201609
  if(missing(colIni)) colIni=1
  if(missing(colFim)) colFim=ncol(df)
  if(colIni>=colFim) { print('colIni>=ColFim'); return(NULL)}
  dfm=cbind(mxCol=apply(df[colIni:colFim], 1, function(x) colnames(df)[which.max(x)+(colIni-1)])
           ,df)
  dfm=cbind(mxVal=as.numeric(apply(dfm,1,function(x) x[x[1]]))
           ,dfm)
  return(dfm)
} 
```

在这种情况下，

```
> mxCol(df,3)[1:11]
   mxVal     mxCol G1    G2 e.10.100 e.10.250 e.20.100 e.20.100d e.20.200 e.20.50 e.20.500
1 29.958  e.20.100  0 FALSE   26.408   27.268   29.958    26.418   24.244  26.553   27.942
2 -9.395  e.50.500  0  TRUE  -11.708  -12.789  -12.189   -13.162  -18.364 -13.284  -13.923
3 31.849 e.30.100d  2 FALSE   27.782   29.158   26.190    28.257   29.047  29.650   27.586
4  4.862 e.20.500d  2  TRUE    3.175    3.190    3.439     4.182    0.553   4.337    2.467
5 29.484 e.30.100d  8 FALSE   26.069   26.909   27.319    25.430   25.851  27.262   25.535
6 -9.962  e.30.250  8  TRUE  -11.362  -12.432  -15.960   -11.760  -12.832 -12.771  -12.810 
```

# jquery-mobile - 从页面dom中获取页眉和页脚

> ID：10290803
> 
> 赞同：1
> 
> 时间：2012-04-24T01:58:10.807
> 
> 标签：jquery-mobile, backbone.js

我正在使用 Cordova、用于 MVC 结构的 Backbone 和用于 UI 的 jQuery Mobile 构建一个移动应用程序。

除了加载新页面时的用户体验外，这很好用。实际上，一个新页面是动态创建的，当它准备好时，jquery mobile 会处理到该页面的页面转换。在移动浏览器中，这种转换比在经典浏览器中要慢，因此当页面加载时，用户会看到一个空白屏幕，然后出现新页面。

问题是关于我的页眉/页脚栏。我希望它在内容加载时继续显示，因此用户将在转换期间看到页眉/页脚和只有空白/白色内容。

所以这是一个经典的页面结构：

```
<div data-role="page">
    <div data-role="header"></div>
    <div data-role="content"></div>
    <div data-role="footer"></div>
</div> 
```

对我来说，最简单的方法是这样的：

```
<div data-role="header"></div>
<div data-role="page">
    <div data-role="content"></div>
</div>
<div data-role="footer"></div> 
```

并使用 CSS 定位修复内容。

但我想找到更聪明的东西。

您如何看待拥有一个 JQM 页面，而 Backbone 只是更新`<div data-role="content">`每条路由的页面？JQM 渲染呢？那么过渡呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:36:01.303

文档：http: [//jquerymobile.com/demos/1.1.0/docs/toolbars/footer-persist-d.html](http://jquerymobile.com/demos/1.1.0/docs/toolbars/footer-persist-d.html)

基本上，您`data-role="footer"`在每个页面中放置一个元素，如下所示：

```
<div data-role="footer" data-id="foo-footer" data-position="fixed">
    <div data-role="navbar">
        <ul>
            <li><a href="a.html">Friends</a></li>
            <li><a href="b.html">Albums</a></li>
            <li><a href="c.html">Emails</a></li>
            <li><a href="d.html" >Info</a></li>
        </ul>
    </div><!-- /navbar -->
</div><!-- /footer --> 
```

请注意`data-id`，它必须在所有`data-role="footer"`元素上都相同才能利用持久工具栏选项。该`data-role="footer"`元素还必须具有该`data-position="fixed"`属性。

这是一个演示：http: [//jsfiddle.net/SpRAA/](http://jsfiddle.net/SpRAA/)

# objective-c - 从 cellForRowAtIndexPath 返回一个自定义单元格：

> ID：10290808
> 
> 赞同：3
> 
> 时间：2012-04-24T01:58:45.013
> 
> 标签：objective-c, uitableview

我遇到了麻烦，我正在寻求帮助。

我需要在一个单元格中保存一个标识符，所以我做了一个 UITableViewCell 的子类并将标识符属性添加到它。在我的视图控制器中，我创建单元格如下：

```
- (SidebarCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell* tableViewCell = [super tableView:tableView cellForRowAtIndexPath:indexPath];
    SidebarCell * cell = (SidebarCell *)tableViewCell;
    Category *category = [categoryDataController.categories objectAtIndex:indexPath.row];
    cell.textLabel.text = category.name;

    if (category.checked == 1) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    } else {
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

    return cell;
} 
```

问题是当我选择其中一个单元格时，方法 cellForRowAtIndexPath: 返回一个 UTableViewCell 对象而不是 SidebarCell，因此我无权访问标识符属性：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:[tableView indexPathForSelectedRow] animated:NO];
    SidebarCell *cell = (SidebarCell *)[tableView cellForRowAtIndexPath:indexPath]; // Trying to cast from UITableViewCell to SidebarCell

    if (cell.accessoryType == UITableViewCellAccessoryNone) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
        [CategoryDataController updateRow:cell.identifier status:1]; // Here the app crashes
    } else if (cell.accessoryType == UITableViewCellAccessoryCheckmark) {
        cell.accessoryType = UITableViewCellAccessoryNone;
        [CategoryDataController updateRow:cell.identifier status:0];
    }    
} 
```

有没有办法让 cellForRowAtIndexPath: 返回 Sidebarcell 对象？

预先感谢。

**编辑**

SidebarCell.h

```
#import <UIKit/UIKit.h>

@interface SidebarCell : UITableViewCell

@property (nonatomic) NSInteger identifier;

@end 
```

SidebarCell.m：

```
#import "SidebarCell.h"

@implementation SidebarCell

@synthesize identifier;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

@end 
```

错误：

```
2012-04-24 09:21:08.543 Dongo[2993:11603] -[UITableViewCell identifier]: unrecognized selector sent to instance 0x6d87d50
2012-04-24 09:21:08.571 Dongo[2993:11603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UITableViewCell identifier]: unrecognized selector sent to instance 0x6d87d50'
*** First throw call stack:
(0x14b1052 0x1a65d0a 0x14b2ced 0x1417f00 0x1417ce2 0x116bc 0x48e71d 0x48e952 0xd1686d 0x1485966 0x1485407 0x13e87c0 0x13e7db4 0x13e7ccb 0x239d879 0x239d93e 0x3fea9b 0x2e85 0x2715 0x1)
terminate called throwing an exception(lldb) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T14:17:12.983

您应该`tableView:cellForRowAtIndexPath:`保持方法签名完整：它应该返回 (UITableViewCell *) 而不是您的自定义单元格类。由于您`SidebarCell`是 的子类`UITableViewCell`，因此它应该都“正常工作”。无需致电`super`或其中任何一项：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    SidebarCell *cell = [tableView dequeueReusableCellWithIdentifier:@"CellIdentifier"];
    if (cell == nil) {
        cell = [[SidebarCell alloc] initWithStyle:UITableViewCellStyleDefault
                                  reuseIdentifier:@"CellIdentifier@"];
    }
    // ... set up the cell here ...
    return cell;
} 
```

在其他方法中，演员应该像你一样工作：

```
SidebarCell *cell = (SidebarCell *)[tableView cellForRowAtIndexPath:indexPath]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T03:37:00.400

```
UITableViewCell* tableViewCell = [super tableView:tableView cellForRowAtIndexPath:indexPath]; 
```

上面的代码行必须返回 a`UITableViewCell`而不是 a `SidebarCell`。

```
SidebarCell * cell = (SidebarCell *)tableViewCell; 
```

然后在您的第二行中，您将单元格转换为 a `SidebarCell`，但您只是在对编译器撒谎并告诉它它应该是 a`SidebarCell`而实际上不是。当您投射某些东西时，它需要以正确的类型开始。

您应该创建一个实际的 SidebarCell，而不是这两行。你如何做到这一点取决于你如何定义它。

让我知道它是在故事板、xib 中还是在代码中创建的，如果需要，我可以提供一个示例。

**编辑** 由于您在代码中创建单元格，您只需将前两行替换为`cellForRowAtIndexPath`：

```
SidebarCell * cell = [[SidebarCell alloc] init]; 
```

其他一切看起来都应该按原样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-02T04:20:23.933

*就我而言，我使用了 tempTableViewcell 类的自定义单元格*

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *identifier = @"cellidentifier";

    tempTableViewcell *cell = [tableView dequeueReusableCellWithIdentifier:identifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:identifier];
    }

    cell.textLabel.text = @"abc";
    return cell;
} 
```

# objective-c - 使用 Afnetworking 获取 UIImageView 并将其放入数组中

> ID：10290810
> 
> 赞同：0
> 
> 时间：2012-04-24T01:59:22.027
> 
> 标签：objective-c, ios, uiimageview, afnetworking, icarousel

正如标题所说，我需要获取图像并将其放入数组中。

```
UIImageView *myImage = [[UIImageView alloc] init];
[myImage setImageWithURL:[NSURL URLWithString:@"http://host.com/images/1/1.png"] placeholderImage:[UIImage imageNamed:@"page3.png"]];
[items addObject:myImage]; 
```

问题是，在加载图像时，代码继续运行，没有任何东西放入数组中，实际上我猜是插入了一个空的 UIImageView。

我该如何解决这个问题？

在旁注中，我使用 iCarousel 来显示图像，在数据源中它获取图像数组并显示它们。我可以以某种方式修改 iCarousel 吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:25:51.800

您可以使用 setImageWithURLRequest 方法发送成功消息或在完成后执行 UI 更新，例如使用以下方法：

```
- (void)setImageWithURLRequest:(NSURLRequest *)urlRequest 
          placeholderImage:(UIImage *)placeholderImage 
                   success:(void (^)(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image))success
                   failure:(void (^)(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error))failure; 
```

这是一个例子（未测试）

```
[image setImageWithURLRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"host.com/images/1/1.png"]] placeholderImage:[UIImage imageNamed:@"page3.png"] 
                   success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image){ 
                             //reload data here
                   }
                   failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error){
                             //handle errors here
                   } 
```

# django - TemplateDoesNotExist 错误，但模板确实存在

> ID：10290812
> 
> 赞同：1
> 
> 时间：2012-04-24T01:59:32.793
> 
> 标签：django, ubuntu, django-haystack

*重要数据：* Ubuntu 11.04 Django 1.3.1

我正在运行由 Whoosh 支持的 Haystack。该站点的其余部分功能正常，但是当我尝试搜索时，我得到一个`TemplateDoesNotExist`包含在`templates/search/search.html`. 模板加载器显然能够读取 search.html，或者它不知道尝试获取包含。包含的文件`_resultPage.html`位于同一目录中，具有相同的权限和相同的所有者和组`search.html`。而且，它不仅包括这个。如果我将其注释掉，它只会在下一个包含的文件中出错。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:58:49.360

`include`标签依赖于以`django.template.loader.get_template`正常方式而不是相对路径搜索模板。你使用`"_resultPage.html"`或`"search/_resultPage.html"`。如果使用第一种形式，则绝对路径`'template/search/search'`必须在`TEMPLATE_DIRS`. 您可以通过执行以下操作进行检查：

```
>>> from django.template.loader import get_template
>>> get_template('_resultPage.html') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T15:31:38.563

我时间紧迫，所以我只是将所有包含的模板直接放入 search.html 并结束了一天。

# ruby-on-rails - 如何更改查看辅助方法？

> ID：10290815
> 
> 赞同：1
> 
> 时间：2012-04-24T01:59:52.120
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在开发一个可以添加任务等的应用程序。我知道这有点奇怪，但我只是想看看其他人将如何实现这一点。您将如何将以下代码更改为辅助方法并使用它？

原始代码

```
<h2>My Tasks</h2>
<% task = @work.tasks %>
<% if task.empty? %>
  <%= link_to 'Create a new task', new_task_path %>
<% else %>
  <%= render :partial => 'notes/note', :locals => {:note => @note} %>
<% end %> 
```

我做辅助方法的方式

```
def task_check
  task = @work.tasks 
  if task.empty? 
    link_to 'Create a new task', new_task_path
  else 
    render :partial => 'notes/note', :locals => {:note => @note} 
  end 
end 
```

在我看来

```
<%= @work.task_check %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T03:34:37.653

就个人而言，我根本不会提取它，这是视图逻辑，它属于视图。它绝对不属于模型，但可以说它可以被提取到帮助器中。我会稍微改变一下：

```
<h2>My Tasks</h2>
<% if @work.tasks.blank? %>
  <%= link_to 'Create a new task', new_task_path %>
<% else %>
  <%= render :partial => 'notes/note', :locals => {:note => @note} %>
<% end %> 
```

即使is调用`blank?`而不是也会起作用`empty?``@work.tasks``nil`

.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:37:39.580

您不能在模型中定义助手。它无权访问`render`，`link_to`或任何其他控制器或视图方法。因此，只需几乎完全按照目录中的文件定义您的方法`helpers`，也许是`application_helpers.rb`或`work_helpers.rb`：

```
def task_check(work, note)
  task = work.tasks 
  if task.empty? 
    link_to 'Create a new task', new_task_path
  else 
    render :partial => 'notes/note', :locals => {:note => note} 
  end 
end 
```

然后在您的视图中调用它，如下所示：

```
<%= task_check(work, note) %> 
```

# java - 使用 LinkedList 实现下一个和上一个按钮

> ID：10290817
> 
> 赞同：3
> 
> 时间：2012-04-24T01:59:52.547
> 
> 标签：java, swing, linked-list, jbutton, actionlistener

这可能是一个愚蠢的问题，但我很难考虑清楚。

我编写了一个使用 LinkedList 在加载的 MIDI 乐器中移动的方法。我想制作一个下一个和一个上一个按钮，以便每次单击该按钮时都会遍历 LinkedList。

如果我硬编码`itr.next();`或`itr.previous();`多次，我可以遍历 LinkedList

```
public void setInsturment(Synthesizer start,MidiChannel currentChannel[])
{
    try
    {
        start.open();

        Soundbank bank = start.getDefaultSoundbank();

        start.loadAllInstruments(bank);

        LinkedList<Instrument> currentInstrument = new LinkedList<Instrument>();

        Instrument instrs[] = start.getLoadedInstruments();

        currentInstrument.add(instrs[0]);
        currentInstrument.add(instrs[1]);
        currentInstrument.add(instrs[2]);
        currentInstrument.add(instrs[3]);
        currentInstrument.add(instrs[4]);

        ListIterator itr = currentInstrument.listIterator();
        itr.next();
        itr.next();
        itr.next();
     // nextInstrument();

        currentChannel[1].programChange(0,itr.nextIndex());

    }

    catch(MidiUnavailableException e)
    {
        System.out.print("error");
    }

} 
```

我在制作一个可以遍历列表的按钮时遇到了很多麻烦。有没有一种有效的方法来做到这一点？我尝试了这样的事情但没有成功。

```
public void actionPerformed(ActionEvent e)
{
    if (e.getSource() == nextButton)
    {
        sound.nextInstrument();
    }

public void nextInstrument()
{
    itr.next();
} 
```

提前谢谢各位！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:02:46.410

该`ListIterator#next()`方法返回感兴趣的对象。如果它是我的项目，我将从该方法返回的内容分配给类字段，然后通知 GUI 更改。

```
someInstrument = itr.next();
// fire notify observers method. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T02:32:45.887

> MIDI 乐器 .. 下一个和上一个按钮

使用数组（例如`Instrument[]`）。它可能显示在 a `JComboBox`、 a`JList`或 a`JSpinner`中，以允许用户选择仪器。这是一个使用带有渲染器的组合的示例。

![在此处输入图像描述](../Images/9855cd5e3319dcea2ecc8aeae2932d4a.png)

```
import java.awt.Component;
import javax.swing.plaf.basic.BasicComboBoxRenderer;
import javax.swing.*;
import javax.sound.midi.*;

class InstrumentSelector {

    public static void main(String[] args) throws MidiUnavailableException {
        Synthesizer synthesizer = MidiSystem.getSynthesizer();
        synthesizer.open();
        final Instrument[] orchestra = synthesizer.getAvailableInstruments();
        SwingUtilities.invokeLater(new Runnable(){
            public void run() {
                JComboBox orchestraSelector = new JComboBox(orchestra);
                orchestraSelector.setRenderer(new InstrumentRenderer());

                JOptionPane.showMessageDialog(null, orchestraSelector);
            }
        });
    }
}

class InstrumentRenderer extends BasicComboBoxRenderer {

    @Override
    public Component getListCellRendererComponent(
        JList list,
        Object value,
        int index,
        boolean isSelected,
        boolean cellHasFocus) {
        Component c = super.getListCellRendererComponent(
            list, value, index, isSelected, cellHasFocus);
        if (c instanceof JLabel && value instanceof Instrument) {
            JLabel l = (JLabel)c;
            Instrument i = (Instrument)value;
            l.setText(i.getName());
        }
        return c;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-24T02:04:40.087

嗯，链表是一个列表，它的项目可以通过索引访问，这不是按索引访问项目的最佳结构，但我真的不知道你是否可以在那种集合上使用光标，但你可以将当前索引存储在实例变量上。

如果你真的想要随机访问，那么你应该考虑使用 ArrayList 而不是链表。

例子：

```
class NextPrevList {
    private int index = 0;
    private List currentList; //initialize it with some list

    public Object next() {
        return list.get(++index);
    }
    public Object prev() {
        //maybe add a check for out of bounds
        if (index == 0) return null;
        return list.get(--index);
    }
} 
```

就我个人而言，我认为使用 ArrayList 而不是 LinkedList 会更高效

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-24T02:06:39.573

接口代码：`List<Instrument>`. 此相关[示例](https://sites.google.com/site/drjohnbmatthews/googleolympiad)导航 a `List<ImageIcon>`，但可以根据需要更改实现。

# c# - 如何在 Windows 8 中使用 StreamWriter 写入文件？

> ID：10290820
> 
> 赞同：18
> 
> 时间：2012-04-24T02:00:08.720
> 
> 标签：c#, windows-8, windows-runtime

在 windows-8 中创建对象时遇到问题`StreamWriter`，通常我只是创建一个实例，只是将字符串作为参数传递，但在 Windows 8 中，我收到一个错误，表明它应该接收一个 Stream，但我注意到 Stream是一个抽象类，有人知道如何编写 xml 文件的代码吗？顺便说一句，我使用 .xml 是因为我想保存序列化对象，或者有人知道如何将序列化对象保存到文件中视窗 8？

有任何想法吗？

目前使用的是 Windows 8 Consumer Preview

代码：

`StreamWriter sw = new StreamWriter("person.xml");`

错误：

`The best overloaded method match for 'System.IO.StreamWriter.StreamWriter(System.IO.Stream)' has some invalid arguments`

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-24T07:46:39.483

而不是 StreamWriter 你会使用这样的东西：

```
StorageFolder folder = ApplicationData.Current.LocalFolder;
StorageFile file = await folder.CreateFileAsync();

using (IRandomAccessStream fileStream = await file.OpenAsync(FileAccessMode.ReadWrite))
{
    using (IOutputStream outputStream = fileStream.GetOutputStreamAt(0))
    {
        using (DataWriter dataWriter = new DataWriter(outputStream))
        {
            //TODO: Replace "Bytes" with the type you want to write.
            dataWriter.WriteBytes(bytes);
            await dataWriter.StoreAsync();
            dataWriter.DetachStream();
        }

        await outputStream.FlushAsync();
    }
} 
```

您可以查看 WinRTXamlToolkit 库中的[StringIOExtensions](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/12598#235918)[类](http://winrtxamltoolkit.codeplex.com/)以供示例使用。

编辑*

虽然以上所有内容都应该有效 - 它们是在[`FileIO`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.fileio.aspx)类在 WinRT 中可用之前编写的，这简化了上述解决方案解决的大多数常见场景，因为您现在可以调用[`await FileIO.WriteTextAsync(file, contents)`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.fileio.writetextasync.aspx)将文本写入文件，并且还有类似的读取方法，写入或附加字符串、字节、字符串列表或`IBuffers`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-09T14:48:52.257

您可以创建一个通用的静态方法，您可以像这样在整个应用程序中使用它

```
 private async Task<T> ReadXml<T>(StorageFile xmldata)
    {
        XmlSerializer xmlser = new XmlSerializer(typeof(List<myclass>));
        T data;
        using (var strm = await xmldata.OpenStreamForReadAsync())
        {
            TextReader Reader = new StreamReader(strm);
            data = (T)xmlser.Deserialize(Reader);
        }
        return data;
    }

    private async Task writeXml<T>(T Data, StorageFile file)
    {
        try
        {
            StringWriter sw = new StringWriter();
            XmlSerializer xmlser = new XmlSerializer(typeof(T));
            xmlser.Serialize(sw, Data);

            using (IRandomAccessStream fileStream = await file.OpenAsync(FileAccessMode.ReadWrite))
            {
                using (IOutputStream outputStream = fileStream.GetOutputStreamAt(0))
                {
                    using (DataWriter dataWriter = new DataWriter(outputStream))
                    {
                        dataWriter.WriteString(sw.ToString());
                        await dataWriter.StoreAsync();
                        dataWriter.DetachStream();
                    }

                    await outputStream.FlushAsync();
                }
            }

        }
        catch (Exception e)
        {
            throw new NotImplementedException(e.Message.ToString());

        }

    } 
```

编写 xml 只需使用

```
 StorageFile file = await ApplicationData.Current.LocalFolder.CreateFileAsync("data.xml",CreationCollisionOption.ReplaceExisting);
        await  writeXml(Data,file); 
```

并阅读 xml 使用

```
 StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync("data.xml");
      Data =  await  ReadXml<List<myclass>>(file); 
```

# python - wxPython 的 MVC 框架

> ID：10290823
> 
> 赞同：1
> 
> 时间：2012-04-24T02:00:28.100
> 
> 标签：python, model-view-controller, wxpython

我是一名电气工程师，在 python 中有一个正在进行的大型项目。这是我第一次编程 GUI，我首先选择了 wxPython 并继续使用它，因为它很容易学习。我总是担心将我的数据与演示文稿分开我刚刚了解到这是 MVC 框架:) 现在我想更改我的代码以遵循 MVC 规则，但我找不到 wxPython 的任何内容。有 pyQt 有这个，但我希望这是我的最后一个解决方案，因为我没有时间坐下来学习。

你碰巧知道要使用的 wxPython MVC 框架吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T14:54:05.560

本身没有框架，尽管我认为 Dabo 可能是您的选择，因为它抽象了数据库内容和 GUI 内容：[http ://dabodev.com/](http://dabodev.com/)

另一方面，也有关于 MVC 和 wxPython 的文章：

*   [http://wiki.wxpython.org/ModelViewController](http://wiki.wxpython.org/ModelViewController)
*   [http://wiki.wxpython.org/wxPython%20Patterns](http://wiki.wxpython.org/wxPython%20Patterns)
*   [http://www.blog.pythonlibrary.org/2011/11/10/wxpython-and-sqlalchemy-an-intro-to-mvc-and-crud/](http://www.blog.pythonlibrary.org/2011/11/10/wxpython-and-sqlalchemy-an-intro-to-mvc-and-crud/)
*   [http://www.blog.pythonlibrary.org/2011/11/30/improving-medialocker-wxpython-sqlalchemy-and-mvc/](http://www.blog.pythonlibrary.org/2011/11/30/improving-medialocker-wxpython-sqlalchemy-and-mvc/)

希望其中之一能帮助你。你也可以在 wxPython Google Group 上提问。他们可能有其他建议。

# emacs - emacs 向上滚动其他窗口

> ID：10290828
> 
> 赞同：41
> 
> 时间：2012-04-24T02:01:24.043
> 
> 标签：emacs

在 Emacs 中，我们可以使用某些命令滚动非活动窗口

但手册中并未列出所有详细信息。

CMv 可以向下滚动另一个窗口

我的意图是向上滚动另一个窗口，我该怎么做？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-24T02:17:52.333

试试看`C-M-S-v`，就是`scroll-other-window-down`。

`C-h b`您可以通过执行( )来找到此类键绑定，它使用当前缓冲区的所有键绑定和相关命令的列表`describe-bindings`填充`*Help*`缓冲区。快速搜索`scroll-other`显示您提到的绑定以及我列出的绑定。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-01-10T07:19:57.823

`M-PageUp`在许多终端上，您可以`M-PageDn`滚动另一个窗口。如果您已经习惯使用`PageUp/PageDn`滚动，那就太好了。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-24T02:48:52.097

您也可以对`C-M-v`. 几乎任何修饰符组合都可以给出否定参数。在这种情况下，您可以键入`C-M-- C-M-v`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-28T02:35:34.820

我用这个（每天）：

```
(define-key global-map [(meta up)] '(lambda() (interactive) (scroll-other-window -1)))
(define-key global-map [(meta down)] '(lambda() (interactive) (scroll-other-window 1))) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-08-13T00:23:42.520

向下滚动，（滚动其他窗口）

向上滚动，（滚动其他窗口'-）

scroll-other-window 是 Emacs 的原生 C API，所以它应该可以开箱即用。检查其文档。

随意为他们分配热键

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-02T22:47:33.490

如果(ie ) 对您不起作用，您可以这样做`C-u - C-M-v`（即`scroll-other-window`使用 ARG ），就像在终端中使用 Emacs 时可能发生的那样。`-``C-M-S-v``scroll-other-window-down`

摘自`C-h f scroll-other-window`：

> 负 ARG 表示向下滚动。如果 ARG 是原子“-”，则向下滚动几乎全屏。

# c# - 在 C# 中获取子字符串？

> ID：10290833
> 
> 赞同：0
> 
> 时间：2012-04-24T02:02:34.847
> 
> 标签：c#

这是一个简单的新手问题。我可能可以使用一些复杂的字符串方法（如子字符串和其他方法）来解决这个问题，但我想知道是否有更好的方法来做到这一点。

假设我在 C# 中有一个字符串：

```
string foo = "&deg;F"; 
```

将它分成两个不同的字符串的最佳方法是什么，我有“deg”和“F”？

我明白发生了什么。stackflow 正在解释 HTML。它实际上是（和号）度（分号）F。

对不起各位，我昨晚发的时候已经晚了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T02:09:18.523

我不知道它是否“复杂”，但是：

```
string degree = foo[0].ToString();
string f = foo[1].ToString(); 
```

我觉得你选择了一个过于简单的例子。您是真的在处理两个字符串，还是在尝试做一些更有趣的事情？

*更新*：好吧，我仍然认为您必须在这里尝试做一些更难的事情。但这是另一种方式：（帽子提示：@James Didzun）

```
string f = foo.Replace("&deg;","");
string deg = foo.Replace("F", ""); 
```

或者你可以这样做：

```
string deg = foo.Substring(0, 5);
string f = foo.Substring(5,1); 
```

或者：

```
 var deg =  new string(foo.TakeWhile(c => c != 'F').ToArray());
 var f = foo.SkipWhile(c => c != 'F').First().ToString(); 
```

或者：

```
string[] x = foo.Split(';');
string deg = x[0] + ";";
string f = x[1]; 
```

或者：

```
string deg = "&deg;"
string f = "F"; 
```

就个人而言，我更喜欢最后一种方法。为什么要拆分一个您知道其确切内容的字符串？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T04:42:53.300

这个怎么样 ：-）

```
char[] foo = "°F".ToCharArray();

char c1 = foo.First();
char c2 = foo.Last(); 
```

# objective-c - 如何使用大型核心数据集实现更快的搜索

> ID：10290834
> 
> 赞同：1
> 
> 时间：2012-04-24T02:02:36.333
> 
> 标签：objective-c, ios

我正在开发应用程序，我想显示一个 10k+ 的 tableview 我正在使用来自 cs193p 的 fetchedresultcontroller，它运行良好。加载和滚动非常快。我希望能够搜索每个字母。
我设置了搜索栏和委托，并让 searchbar textdidchange 方法为每个字母重新加载 fetchresults 控制器。它可以工作，但无论如何都会有延迟以使其更快。这是我的 textdidchange 方法

```
-(void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText {

//NSLog(@"%@",searchText);
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"People"];
request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"fullname" ascending:YES]];
[NSFetchedResultsController deleteCacheWithName:@"peopleCache"];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(firstname contains[c] %@)",searchText];
 request.predicate = predicate;

self.fetchedResultsController = [[NSFetchedResultsController alloc]initWithFetchRequest:request managedObjectContext:self.peopleDatabase.managedObjectContext sectionNameKeyPath:nil cacheName:@"actorCache"]; 
```

}

有什么方法可以过滤现有查询而不实际重新获取数据？

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:44:38.217

[“优化 iPhone OS 上的核心数据性能](https://developer.apple.com/videos/wwdc/2010/?id=137)”WWDC 会议中提到了优化文本搜索的技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:55:16.227

您可以使用谓词搜索现有数组，但它可能会在您正在搜索的所有字段中出现错误......这取决于应用程序可能是一件坏事（即重新获取更慢且使用更多内存） .

# vb.net - 保存动态创建的表单

> ID：10290837
> 
> 赞同：1
> 
> 时间：2012-04-24T02:02:46.663
> 
> 标签：vb.net, winforms

我创建了一个示例表单

```
 Dim obj_CommonForm As New Form
 Dim btn_Create As New Button
 btn_Create.Location = New System.Drawing.Point(30, 200)
 btn_Create.Size = New System.Drawing.Size(60, 15)
 btn_Create.Text = "MyCommand"
 obj_CommonForm.Controls.Add(btn_Create)
 obj_CommonForm.Show() 
```

现在我想将此表单保存为 .vb 文件并将其包含在我的项目中。

类似的，我在 PHP 中创建了输出 html 并保存为 .php 文件很容易。当我开始做一些已经创建数据库的项目时，我将其用作初始化函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:58:01.780

你的问题我不清楚……所以我试着猜测。

如果您想要一个 .vb 文件，那么您只需获取由 Visual Studio 或您的应用程序创建的 .vb 并在编译时将其包含在项目中。

相反，如果您谈论的是由程序创建并在运行时加载它的通用表单，则您必须了解有关序列化的知识。

在后一种情况下，我前段时间遇到了同样的问题，以下文章是一个很好的起点：

[http://community.visual-basic.it/lucianob/archive/2007/10/14/20711.aspx](http://community.visual-basic.it/lucianob/archive/2007/10/14/20711.aspx)

它是意大利语的，但我认为您可以通过某些工具进行翻译（显然，代码示例除外）:-)

# c# - 如何从字典中获取 MAX 值？

> ID：10290838
> 
> 赞同：46
> 
> 时间：2012-04-24T02:02:58.937
> 
> 标签：c#, .net, linq, dictionary

我有

```
Dictionary<Guid, DateTime> d = new Dictionary<Guid, DateTime>(); 
```

我怎样才能得到一个`Guid`有价值的`MAX`东西？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-04-24T02:06:28.547

由于这是公认的答案，我将尝试涵盖该问题的所有可能含义：

```
var dict = new Dictionary<string, int> { { "b", 3 }, { "a", 4 } };

// greatest key
var maxKey = dict.Keys.Max(); // "b"

// greatest value
var maxValue = dict.Values.Max(); // 4

// key of the greatest value
// 4 is the greatest value, and its key is "a", so "a" is the answer.
var keyOfMaxValue = dict.Aggregate((x, y) => x.Value > y.Value ? x : y).Key; // "a" 
```

注意：问题具有`System.Guid`作为关键类型。问“什么是最大的 GUID”可能没有意义，因为它们只是为了成为唯一值，而不是代表任何可排序的概念。尽管如此，上面的代码将适用于任何支持`>`运算符的类型，为了简洁起见，这里选择它`string`。`int`

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-09-19T14:22:30.983

这很好用。它将返回 MAX 日期的 GUID。

```
Dictionary<Guid, DateTime> d = new Dictionary<Guid, DateTime>(); 
var guidForMaxDate = d.FirstOrDefault(x => x.Value == d.Values.Max()).Key; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-24T02:11:49.763

```
 var maxGuid = Guid.Empty;
            var maxDateTime = DateTime.MinValue;
            foreach (var kvp in d)
            {
                if (kvp.Value > maxDateTime)
                {
                    maxGuid = kvp.Key;
                    maxDateTime = kvp.Value;
                }
            }
            Console.WriteLine("Guid of max date is: " + maxGuid.ToString()); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-03-04T00:27:48.277

首先订购数据可能是一种解决方案。

```
var maxGuid = d.OrderByDescending(x => x.Value).FirstOrDefault().Key; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-24T02:07:39.330

Guid 实现了 IComparable，因此：

```
d.Keys.Max() 
```

也不清楚为什么要这样做......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-06-19T19:49:00.267

通过在字典上使用 LINQ。

```
var MaximumValue = dict.FirstOrDefault(x => x.Value.Equals(dict.Values.Max())); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-20T16:07:56.030

接受的答案对我不起作用。以下代码（使用 MoreLinq）完成了这项工作：

```
var fooDict = new Dictionary<string, int>();
var keyForBiggest = fooDict.MaxBy(kvp => kvp.Value).Key;
var biggestInt = fooDict[keyForBiggest]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-27T17:15:39.947

**另一种方法可能有助于获得 Single KeyValuePair。**

```
KeyValuePair<char, int> GuidKeyPair = guidDict.FirstOrDefault( MaxGuid => MaxGuid.Value == guidDict.Values.Max()); 
```

# php - 如何删除多个 UTF-8 BOM 序列

> ID：10290849
> 
> 赞同：68
> 
> 时间：2012-04-24T02:04:55.327
> 
> 标签：php, utf-8, byte-order-mark

使用 PHP5 (cgi) 从文件系统输出模板文件，并且在输出原始 HTML 时遇到问题。

```
private function fetch($name) {
    $path = $this->j->config['template_path'] . $name . '.html';
    if (!file_exists($path)) {
        dbgerror('Could not find the template "' . $name . '" in ' . $path);
    }
    $f = fopen($path, 'r');
    $t = fread($f, filesize($path));
    fclose($f);
    if (substr($t, 0, 3) == b'\xef\xbb\xbf') {
        $t = substr($t, 3);
    }
    return $t;
} 
```

即使我已经添加了 BOM 修复程序，我仍然在 Firefox 接受它时遇到问题。您可以在此处查看实时副本：http: [//ircb.in/jisti/ （以及我在](http://ircb.in/jisti/)[http://ircb.in/jisti/home.html](http://ircb.in/jisti/home.html)投掷的模板文件，如果您想查看的话）

知道如何解决这个问题吗？o_o

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-03-15T02:55:00.910

您将使用以下代码删除 utf8 bom

```
//Remove UTF8 Bom

function remove_utf8_bom($text)
{
    $bom = pack('H*','EFBBBF');
    $text = preg_replace("/^$bom/", '', $text);
    return $text;
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-09-18T11:19:03.210

尝试：

```
// -------- read the file-content ----
$str = file_get_contents($source_file); 

// -------- remove the utf-8 BOM ----
$str = str_replace("\xEF\xBB\xBF",'',$str); 

// -------- get the Object from JSON ---- 
$obj = json_decode($str); 
```

:)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-06-19T17:03:45.840

删除 BOM 的另一种方法，即 Unicode 代码点 U+FEFF

```
$str = preg_replace('/\x{FEFF}/u', '', $file); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-24T02:07:43.993

`b'\xef\xbb\xbf'`代表文字字符串“\xef\xbb\xbf”。如果要检查 BOM，则需要使用双引号，因此`\x`序列实际上被解释为字节：

```
"\xef\xbb\xbf" 
```

您的文件似乎还包含比单个前导 BOM 更多的垃圾：

```
$ curl http://ircb.in/jisti/ | xxd

0000000: efbb bfef bbbf efbb bfef bbbf efbb bfef  ................
0000010: bbbf efbb bf3c 2144 4f43 5459 5045 2068  .....<!DOCTYPE h
0000020: 746d 6c3e 0a3c 6874 6d6c 3e0a 3c68 6561  tml>.<html>.<hea
... 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-07-18T06:10:13.320

如果有人使用 csv 导入，那么下面的代码很有用

```
$header = fgetcsv($handle);
foreach($header as $key=> $val) {
     $bom = pack('H*','EFBBBF');
     $val = preg_replace("/^$bom/", '', $val);
     $header[$key] = $val;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-22T15:13:22.137

此全局函数解析为 UTF-8 系统基本字符集。坦克！

```
function prepareCharset($str) {

    // set default encode
    mb_internal_encoding('UTF-8');

    // pre filter
    if (empty($str)) {
        return $str;
    }

    // get charset
    $charset = mb_detect_encoding($str, array('ISO-8859-1', 'UTF-8', 'ASCII'));

    if (stristr($charset, 'utf') || stristr($charset, 'iso')) {
        $str = iconv('ISO-8859-1', 'UTF-8//TRANSLIT', utf8_decode($str));
    } else {
        $str = mb_convert_encoding($str, 'UTF-8', 'UTF-8');
    }

    // remove BOM
    $str = urldecode(str_replace("%C2%81", '', urlencode($str)));

    // prepare string
    return $str;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-02-18T09:06:50.633

没有`pack`功能的解决方案：

```
$a = "1";
var_dump($a); // string(4) "1"

function deleteBom($text)
{
    return preg_replace("/^\xEF\xBB\xBF/", '', $text);
}

var_dump(deleteBom($a)); // string(1) "1" 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-11-07T04:53:40.233

完成相同工作的额外方法：

```
function remove_utf8_bom_head($text) {
    if(substr(bin2hex($text), 0, 6) === 'efbbbf') {
        $text = substr($text, 3);
    }
    return $text;
} 
```

我发现的其他方法不适用于我的情况。

希望它在某些特殊情况下有所帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-12T17:14:29.080

如果您正在使用 阅读某些 API`file_get_contents`并得到一个莫名其妙`NULL`的 from `json_decode`，请检查`json_last_error()`: 的值有时返回的值`file_get_contents`会有一个无关的 BOM，当您检查字符串时几乎不可见，但会`json_last_error()`返回 `JSON_ERROR_SYNTAX`(4)。

```
>>> $json = file_get_contents("http://api-guiaserv.seade.gov.br/v1/orgao/all");
=> "﻿\t{"orgao":[{"Nome":"Tribunal de Justi\u00e7a","ID_Orgao":"59","Condicao":"1"}, ...]}"
>>> json_decode($json);
=> null
>>> 
```

在这种情况下，检查前 3 个字节 - 回显它们不是很有用，因为 BOM 在大多数设置中是不可见的：

```
>>> substr($json, 0, 3)
=> "  ﻿"
>>> substr($json, 0, 3) == pack('H*','EFBBBF');
=> true
>>> 
```

如果上面的行为您返回 TRUE，那么一个简单的测试可能会解决问题：

```
>>> json_decode($json[0] == "{" ? $json : substr($json, 3))
=> {#204
     +"orgao": [
       {#203
         +"Nome": "Tribunal de Justiça",
         +"ID_Orgao": "59",
         +"Condicao": "1",
       },
     ],
     ...
   } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-07-05T08:59:41.677

我不太喜欢使用`preg_replace`或`preg_match`执行简单的任务。这种检测和删除 BOM 的替代方法怎么样？

```
function remove_utf8_bom(string $text): string
{
    $bomStart = mb_substr($text, 0, 1);
    return ($bomStart == pack('H*','EFBBBF')) ?
        mb_substr($text, 1) :
        $text;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-06-09T08:49:02.670

当使用有缺陷的软件时，BOM 部分会随着每次节省而成倍增加。

所以我用它来摆脱它。

```
function remove_utf8_bom($text) {
    $bom = pack('H*','EFBBBF');
    while (preg_match("/^$bom/", $text)) {
        $text = preg_replace("/^$bom/", '', $text);
    }
    return $text;
} 
```

# ruby-on-rails - 这些错误信息是什么意思？

> ID：10290856
> 
> 赞同：3
> 
> 时间：2012-04-24T02:06:11.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, railstutorial.org

我在 hartl rails 教程的第 9 节中，这个 def 没有意义。想法？

```
1) User pages index 
 Failure/Error: visit users_path
 ActionView::Template::Error:
   wrong number of arguments (2 for 1)
 # ./app/helpers/users_helper.rb:3:in `gravatar_for'
 # ./app/views/users/index.html.erb:7:in `block in _app_views_users_index_html_erb__3004047397113020476_70255017945740'
 # ./app/views/users/index.html.erb:5:in `each'
 # ./app/views/users/index.html.erb:5:in `_app_views_users_index_html_erb__3004047397113020476_70255017945740'
 # ./spec/requests/user_pages_spec.rb:12:in `block (3 levels) in <top (required)>'

2) User pages index should list each user
 Failure/Error: visit users_path
 ActionView::Template::Error:
   wrong number of arguments (2 for 1)
 # ./app/helpers/users_helper.rb:3:in `gravatar_for'
 # ./app/views/users/index.html.erb:7:in `block in _app_views_users_index_html_erb__3004047397113020476_70255017945740'
 # ./app/views/users/index.html.erb:5:in `each'
 # ./app/views/users/index.html.erb:5:in `_app_views_users_index_html_erb__3004047397113020476_70255017945740'
 # ./spec/requests/user_pages_spec.rb:12:in `block (3 levels) in <top (required)>' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T02:15:07.297

[第 7 章的第一个练习](http://ruby.railstutorial.org/chapters/sign-up#sec%3asignup_exercises)指定您扩展该`gravatar_for`方法以包含一个新的可选参数，用于包含大小。你可能没有做这个练习，所以它只期望原始的 1 参数而不是两个参数。完成练习，您应该可以通过此代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:31:12.483

在 helper 文件夹中的 user_helper.rb 文件中，您为**gravatar_for**方法传递 2 个参数而不是 1 个参数。如果你把它的代码，它会更容易解决。

# algorithm - 通过反转时域信号的极性，我可以取消源音频吗？

> ID：10290862
> 
> 赞同：0
> 
> 时间：2012-04-24T02:07:19.627
> 
> 标签：algorithm, math, audio, fft, noise-reduction

我在时域中有一个输入信号（即每秒离散 14100 个有符号整数）。

如果我反转每个值的极性（有符号），我不会产生破坏性的源音频消除信号吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:42:38.297

仅当从输入信号到输出信号到消除点的总软件/硬件/系统/换能器延迟时间为零（或最高频率周期的很小百分比）时，才会发生通过简单地反转极性的破坏性消除)，破坏性换能器的频率和相位响应绝对平坦。

例如，仅可能在虚构/理论模型中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:42:38.320

是的，相位反转（并将两者相加）将取消信号，导致静音。当然，您必须注意数字限制。

# php - 如何雕刻半个感恩节火鸡？

> ID：10290863
> 
> 赞同：9
> 
> 时间：2012-04-24T02:07:23.337
> 
> 标签：php, image-processing

我有一个很酷的问题。我试图突出显示这只火鸡 50% 的质量。实际上，它不会是 50%，但如果我能得到 50%，我可以算出其余的。

我目前的想法是：扫描每个像素以找出火鸡的质量，以像素为单位。然后，当我想要 50% 的火鸡时，从左到右突出显示像素，直到突出显示 50% 的像素。

有没有人有更好的想法？这是最慢的、蛮​​力的想法，需要遍历每个像素一次以计算像素，然后再次突出显示其中的 50%。

请注意，垂直分割图片不会留下 50% 的火鸡，因为火鸡的身体比它的脖子要多肉。

![这是一只火鸡](../Images/16f31d719caa1bf829e77e16a4234840.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:13:18.940

你说百分比会改变，但我会在这里冒险并假设火鸡本身不会。

所以你不需要循环两次。你只需要做一次，将数据映射成某种形式的结构，你可以参考，然后每次你需要突出显示时才参考它，以确定你需要走多远。

例如，制作一个关联数组`<percentage of mass (integer out of a hundred) => vertical column number (int)>`

这样，当您需要对 x 百分比进行着色时，您只需要遍历 cached_data[percent_to_highlight] 像素列，将它们全部着色，然后在到达它时完全退出循环。

* * *

要获得更高的性能，请准备两张图片 - 一张完全着色，一张正常。关联数组应该映射`percentage => byte_offset`

对于您希望生成的每个图像，只需 memcpy 或任何 PHP 等价物，从`0 -> byte_offset`阴影图片到非阴影图片的快速、范围复制并保存。不再循环。你不能比这更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:25:32.010

这个问题看起来并没有一个聪明的算法来解决这个问题。但是我也不是 CG 方面的专家，所以我可能错了。

如果你最终在 n 上使用嵌套循环，那么尝试寻找这样的解决方案可以很好地增加时间复杂度（而不是 O(n)），其中 n 是火鸡使用的像素总数。

相反，执行两遍方式很容易实现（实现的时间/精力非常少），并且忽略常数 2 也是 O(n)，这不是一个糟糕的解决方案。根据您编写此解决方案的目的、硬件、空间限制等；走两条路可能会更有意义。

# java - Java 小程序在 JRE7 下无法运行，控制台不显示错误

> ID：10290867
> 
> 赞同：3
> 
> 时间：2012-04-24T02:07:51.120
> 
> 标签：java, windows-7, applet, java-7

在Windows 7, 64-bit下，自从升级到JRE-7 32-bit，在IE9 32-bit或Chrome下，我无法运行像[这样](http://profs.etsmtl.ca/mmcguffin/learn/java/01-drawingLines/)的小程序。在 Applet 矩形内，我看到消息“错误。单击以获取详细信息”

单击小程序框（空白）会导致一个对话框：

```
Application Error 
DrawingLines.class
There was an error while executing the application. Click "Details" for more information. 
```

单击“详细信息”按钮打开 Java 控制台，但没有错误，只是

```
Java 插件 10.3.0.5
使用 JRE 版本 1.7.0_03-b05 Java HotSpot(TM) 客户端虚拟机
用户主目录 = C:\Users\Blah
-------------------------------------------------- --
c: 清除控制台窗口
f：在终结队列中终结对象
g：垃圾收集
h：显示此帮助信息
l：转储类加载器列表
m：打印内存使用情况
o：触发日志记录
问：隐藏控制台
r：重载策略配置
s：转储系统和部署属性
t：转储线程列表
v: 转储线程堆栈
x：清除类加载器缓存
0-5：将跟踪级别设置为
-------------------------------------------------- --

```

开发人员的工具控制台在两个浏览器中都是空白的。

如果我重新加载页面，我最终会遇到一种死锁，浏览器停止响应。

知道为什么控制台中没有显示错误吗？

**（编辑）** 因为我的 JRE 是 32 位的，所以 64 位版本的 IE9 不运行小程序。这是有道理的，浏览器会报告消息“您的浏览器正在忽略 APPLET 标记”或等效消息。我正在使用 32 位 JRE，因为我开发了一些基于 JMF 的软件（仅与 32 位 JRE 兼容）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:52:37.480

首先测试浏览器插件的 Java 版本：[http ://www.java.com/en/download/testjava.jsp](http://www.java.com/en/download/testjava.jsp)

我在 Windows 64 位上安装了 Java 6 和 7。我的浏览器插件仍然是 6 版本。我还没有更新 7 版本的插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:16:04.033

这是我为解决问题所做的工作：

**Java 控制面板 -> Java 选项卡 -> 查看...（并管理 Java 运行时版本和 Java 应用程序和小程序的设置...）-> 查找**

将搜索指向 Program Files 中的 Java 文件夹（以进行更有效的搜索）。就我而言，控制面板还发现了 JDK（我也安装了）。它已经知道我在上面的问题中提到的两个 JRE。

我接受了新发现，并且小程序现在可以在 Chrome 和 IE9 中运行。

我的*理论*是将浏览器链接到 JRE 的东西是不正确的（浏览器正在启动 JRE，因此我在小程序矩形中收到了一个控制台和一条错误消息，但不知何故它不正确）。再次扫描 JRE 以某种方式修复了故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-30T20:13:17.140

视窗 7 32 位

转到开始/所有程序/java/configure java Temporary Internet Files/Settings 设置从无到中

# cakephp - cakephp 2.1.x - MeioUpload 错误

> ID：10290868
> 
> 赞同：0
> 
> 时间：2012-04-24T02:08:17.683
> 
> 标签：cakephp, meio-upload

在蛋糕 2.1.x 上使用 MeioUpload (https://github.com/jrbasso/MeioUpload) -

模型/行为/MeioUploadBehavior.php 插件：MeioUpload/ 语言环境模型

抛出错误 - 错误：应用程序正在尝试从 MeioUpload 插件加载文件错误：确保您的插件 MeioUpload 位于 app/Plugin 目录中并且已加载

模型：

```
var $actsAs = array(
    'MeioUpload.MeioUpload' => array(
        'filename' => array(
            'dir' => 'images',
            'create_directory' => true,
            'max_size'=>'10 Mb',
            'allowed_mime' => array('image/jpeg', 'image/pjpeg', 'image/png'),
            'allowed_ext' => array('.jpg', '.jpeg', '.png'),
            'thumbsizes' => array(
                'normal' => array('width'=>200, 'height'=>200),
            ),
            'default' => 'default.jpg',
        )
    )
); 
```

如果我只指定 'MeioUpload' => array(); 图片没有上传。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:53:05.410

你加载插件了吗？您可以像这样从引导文件中执行此操作。
引导文件可以在`app\Config`目录中找到。

`CakePlugin::load('MeioUpload');`
或者
`CakePlugin::loadAll();`

# string - 基于解析字符串的变量名

> ID：10290871
> 
> 赞同：1
> 
> 时间：2012-04-24T02:08:32.150
> 
> 标签：string, python-3.x, variable-assignment, naming-conventions, symbol-table

我想根据解析的字符串命名我的变量。

例如：如果在字符串中解析 == 'dog'：我的变量名应该等于 dog 并且它的值是字符串 'dog'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:52:39.030

[这个](https://stackoverflow.com/a/9085562/923794)关于python中符号表的答案有助于直接回答这个问题：

```
>>> varname = 'spam'
>>> value = 'eggs'
>>> locals()
{'__builtins__': <module 'builtins' (built-in)>, 'varname': 'spam', 'value': 'eggs', '__package__': None, '__name__': '__main__', '__doc__': None}
>>> locals()[varname] = value
>>> locals()
{'__builtins__': <module 'builtins' (built-in)>, 'varname': 'spam', 'spam': 'eggs', 'value': 'eggs', '__package__': None, '__name__': '__main__', '__doc__': None}
>>> print(spam)
some value 
```

`locals()`提供了一个`dict`局部可见的变量。并且通过修改 dict，您可以更改和创建新变量。[Python 文档在这里](http://docs.python.org/release/3.1.2/library/functions.html#locals)

还有一个对应[`globals()`](http://docs.python.org/release/3.1.2/library/functions.html#globals)的访问全局可见变量。请参阅[python 文档的这一部分](http://docs.python.org/release/3.1.2/reference/executionmodel.html#index-795)以了解变量的范围。

在上面的上下文中`globals()`产生`dict`具有相同内容的 a 因为在这种情况下本地范围是全局的。在一个类中，您会看到不同的内容，您必须决定是要破坏本地范围还是全局范围。

但是，除非您知道自己在做什么，否则做这种事情可能不是一个好主意。您可以创建具有 name 属性的自定义类的对象 - 取决于您打算做什么

# jenkins - Jenkins 自己的作业保留节点

> ID：10290873
> 
> 赞同：4
> 
> 时间：2012-04-24T02:08:56.080
> 
> 标签：jenkins, distributed

我正在使用带有多个从节点的詹金斯。我有两个基准测试工作。当其中一个基准测试作业正在运行时，我希望基准测试作业成为当时在该节点上运行的唯一作业。但是当基准测试作业没有运行时，我可以在单个节点上同时运行多个其他作业。

我已经研究过使用 Throttle Concurrent Jobs，但这些类别似乎不足以实现我的目标。我目前正在使用[Jenkins Heavy Jobs](https://wiki.jenkins-ci.org/display/JENKINS/Heavy+Job+Plugin)插件并手动将作业权重设置为奴隶拥有的执行者数量，但这是次优的。如果 Heavy Job 插件支持仅使用所有可用执行器的设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T07:08:52.293

[锁和闩锁插件](https://wiki.jenkins-ci.org/display/JENKINS/Locks+and+Latches+plugin)。一个潜在的严重缺点：您需要为每个可以并行运行的作业定义一个锁。因此，如果这些工作的数量很大，等等。

# java - 通过计时器设置 JDialog 不透明度

> ID：10290878
> 
> 赞同：5
> 
> 时间：2012-04-24T02:09:12.497
> 
> 标签：java, swing, fadein, jdialog, javax.swing.timer

我正在使用以下代码来*淡入*a ：`JDialog``javax.swing.Timer`

```
 float i = 0.0F;
    final Timer timer = new Timer(50, null);
    timer.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            if (i == 0.8F){
                timer.stop();
            }
            i = i + 0.1F;
            setOpacity(i);
        }
    });
    timer.start(); 
```

`Dialog`很好地淡入了预期的效果，但最后，一个Occurs`IllegalArgumentException`说：

```
 The value of opacity should be in the range [0.0f .. 1.0f] 
```

但问题是我不会走得太远`i = 0.8F`，那怎么可能是非法的争论呢？
异常发生在行：`setOpacity(i);`

有什么建议么？解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T02:14:50.360

您的问题是您正在处理浮点数并且`==`不能很好地处理它们，因为您无法准确地用浮点数描述 0.8，因此您的 Timer 永远不会停止。

使用`>=`. 或者更好的是，只使用 int。

IE，

```
int timerDelay = 50; // msec
new Timer(timerDelay, new ActionListener() {
    private int counter = 0;

    @Override
    public void actionPerformed(ActionEvent e) {
        counter++;
        if (counter == 10){
            ((Timer)e.getSource()).stop();
        }
        setOpacity(counter * 0.1F);
    }
}).start(); 
```

# algorithm - Lowe 如何计算他的 SIFT 算法的“可重复性”？

> ID：10290885
> 
> 赞同：5
> 
> 时间：2012-04-24T02:10:02.050
> 
> 标签：algorithm, image-processing, computer-vision, sift

在他 2004 年的论文“Distinctive Image Features from Scale-Invariant Keypoints”中，他给出了许多“可重复性”作为 XXX 的函数的图形，例如图 3,4 和 6，但他没有详细说明如何计算“可重复性”。

他实际上在第 8 页的图 3 中对“可重复性”进行了简单的解释，即“在转换后的图像中，在相同位置和尺度上可重复检测到的关键点的百分比”。

然而，**1）**我们如何知道在转换后的图像中检测到关键点的天气，只需逐个检查关键点？我不认为这是实用的，因为有成千上万的关键点。

**2）**我们可以认为在相同位置重复检测到的关键点有多近？3像素，6像素？还是根本不按像素？

我不知道如何上传论文“Distinctive Image Features from Scale-Invariant Keypoints”。这是链接： [http ://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf](http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:35:13.763

如果您在第 9 页的第一段中注意到，作者会更详细地说明在同一位置检测到关键点的容差。首先，“相同比例”被给出为在`sqrt(2)`正确比例的一个因子之内，这必须是操作员知道的或在数据集中手工标记的。其次，“相同位置”被定义为在 x 和 y 方向上的 σ 个像素内，其中“σ 是关键点的尺度（由等式（1）定义为差分中使用的最小高斯的标准偏差 -高斯函数)"

至于您更一般的问题，不幸的是，答案是确实必须彻底检查关键点。您收集了检测器在转换后的图像上触发的所有位置/比例对，并将它们与原始图像中的真实位置进行比较。您需要手动记录关键点位置，或者首先运行一个简单的算法（例如使用基本的 KLT 关键点检测器，并仅存储它找到的关键点的坐标列表并假装这些是“基本事实”...... ' 会以这种方式受到一定的准确性，但您将更能够自动化该过程）。

像这样的大规模繁重的工作（编写代码以详尽地检查大量关键点）通常是外包给研究生的东西。布勒格。

# c# - 我将部分代码移到了课堂上。现在我得到运行时错误

> ID：10290886
> 
> 赞同：0
> 
> 时间：2012-04-24T02:10:04.780
> 
> 标签：c#, asp.net

我有一个可用的 C# 2010 WEB 应用程序。
我将部分代码移至一个新类，如下所示：

```
namespace ShowDiagram1
{
    public class MyDraw : WebForm1
    {
        public void DrawPicture () {
            ...
            bitmap.Save(Server.MapPath("pic1.jpg"), ImageFormat.Jpeg);
            Image1.ImageUrl = this.ResolveUrl("pic1.jpg");
             ...
        }
    }
} 
```

错误信息如下：

> 你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。
> 
> 源错误：
> 
> 第 85 行：Image1.ImageUrl = ResolveUrl("pic1.jpg");

pic1.jpg 在上一行中创建得很好。

Image1 是 WebForm1 上的元素

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:44:59.057

Image1 变量未初始化。如果这是从网络表单复制的代码，您可能会在原始网络表单的“.designer”文件中找到初始化代码。只需搜索该变量的解决方案，您就会找到必要的代码。

# css - jQuery mobile 选择标签显示样式更改

> ID：10290887
> 
> 赞同：1
> 
> 时间：2012-04-24T02:10:09.330
> 
> 标签：css, select, jquery-mobile, option

如果选择标签的选项太多，jQuery 会创建一个新的全屏、非透明页面，其中包含所有要选择的元素。我希望这个新页面是 50% 透明的，这样用户就可以在背景中看到带有 select 标记的页面 - 类似于灯箱的效果（[http://lokeshdhakar.com/projects/lightbox/](http://lokeshdhakar.com/projects/lightbox/)）无论如何要改变这个 jQuery 列表的默认格式还是我需要手动构建选择页面？

```
<select id="sourceLanguages" data-native-menu="false" data-mini="true">
    <option value="1" data-placeholder="true">Choose language</option>
    <option value="1" data-placeholder="true">Choose language</option>
    <option value="1" data-placeholder="true">Choose language</option>
    ....
</select> 
```

## 编辑：

使用以下代码可以随意编辑所有对话框：

```
$("div:jqmData(role='dialog')") 
```

这是我的问题的解决方案：

```
$("div:jqmData(role='dialog')").live('pageshow',function(event, ui){
    // Set some styles
    $('#home').show();
}); 
```

再次感谢 jasper 为我指明了正确的方向。

～守吾。

# android - 拉动 NFC 设备 #2 时打开 NFC 模拟器挂起

> ID：10290889
> 
> 赞同：1
> 
> 时间：2012-04-24T02:10:50.913
> 
> 标签：android, android-emulator, nfc, open-nfc

我目前正在使用 android 模拟器和 Open NFC 试验 NFC。[我已经使用 Open NFC virtual device 在 Android 中](https://stackoverflow.com/questions/9405601/p2p-in-android-using-open-nfc-virtual-device)设置了 OpenNFC，如P2P 所述，运行 2 个模拟器实例，然后单击“NFC Device #2”以模拟设备触摸。它按预期工作，标签被发送到其他设备。问题是当我双击“NFC Device #2”模拟拉动时，NFC 模拟器总是挂起。还有其他人有这个问题吗？

# javascript - 使用 FB.ui 将预定义消息添加到 Facebook“发布到您的墙上”对话框

> ID：10290894
> 
> 赞同：2
> 
> 时间：2012-04-24T02:11:27.047
> 
> 标签：javascript, facebook, facebook-graph-api

我正在使用`FB.ui`（https://developers.facebook.com/docs/reference/javascript/FB.ui/）在我的网站上创建“发布到您的墙上”功能：

```
var new_post = {
    method: 'feed',
    link: '/path/to/my/site',
    picture: '/path/to/image.jpg',
    name: 'My Site',
    caption: 'Lorem',
    description: 'Ipsum',
    message: 'Check out this link, guys!' //this does not work
};
FB.ui(new_post, callback_defined_somewhere); 
```

如何在帖子中添加预定义消息，例如“查看此链接，伙计们！”

我尝试将`message`参数添加到`new_post`对象中，但这似乎不起作用。

显示对话框时，焦点在文本框上，`Say something about this...`而不是`Check out this link, guys!`消息。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T02:24:04.017

自 2012 年 1 月 1 日以来，它已从 FB API 中删除，并在 2012 年 7 月 5 日之后完全删除。请参阅[http://developers.facebook.com/docs/fbjs/](http://developers.facebook.com/docs/fbjs/)

所以现在你不能以任何方式指定消息的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-17T10:09:56.453

您可以使用开放图协议。

将此添加到您的 html 标记中：`<html xmlns:og="http://opengraphprotocol.org/schema/">`

并将其包含在您的`<head>`标签中。

```
<meta property="og:title" content="Link title text!"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="http://example.com/"/>
<meta property="og:site_name" content="Link title text!"/>
<meta property="og:description" content="Link description text!"/>
<meta property="og:image" content="http://example.com/fbshare.png"/> 
```

如果您想要多个消息用于相同的 url，您可以使用`?something`，`isset($_GET['something'])`然后根据需要更改 og 标签。

# php - 下载文件时，我可以用数据“标记”一个 .zip 文件吗？

> ID：10290896
> 
> 赞同：-1
> 
> 时间：2012-04-24T02:11:37.800
> 
> 标签：php, zip, traceability

有没有一种方法可以在每次下载 .zip 时使用某种类型的隐藏数据（例如买家/下载者的电子邮件地址）“标记”我的 .zip 文件？

出于跟踪/安全原因，基本上尝试将某种类型的唯一变量注入 .zip。

我什至不确定我是否可以修改这样的 .zip，但我认为我应该问，因为我一直在四处寻找，但找不到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:16:45.650

您将如何“跟踪”这个 zip 文件？

您是否会要求用户将 zip 文件发送给您，以便您查看它是否合法？不知道你在这里做什么。

话说回来。一些想法：

将 zip 文件的内容与买家/下载者的电子邮件地址 + 一些只有您知道的密钥连接起来。取其中的 MD5 并将压缩文件命名为 {THATMD5}.zip。或者，您可以将 Key.txt 之类的内容放入 zip 文件中，并且 key.txt 可以包含 {THATMD5}。同样，不确定您打算如何“跟踪”这一点。

# c - GDB 输入文件等

> ID：10290898
> 
> 赞同：3
> 
> 时间：2012-04-24T02:11:48.217
> 
> 标签：c, file, gdb

我正在尝试调试一个程序，但是我需要一个 txt 文件作为输入。我不确定如何让文本文件与程序一起玩。我编译为
gcc -g filename.c filename1.c
a < text.txt
并且在调试器中已经做了一些。程序一直退出，因为文件为 NULL。如何将txt文件输入到程序中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T03:52:08.183

编辑：

或者，您是否尝试在`fopen`程序中打开“textfile.txt”？

*   [标准流](http://en.wikipedia.org/wiki/Standard_streams)
*   [重定向](http://en.wikipedia.org/wiki/Redirection_%28computing%29)

* * *

仅举一个例子/清楚：

首先; 这是一个糟糕的编译行，当你遇到问题时更糟，但你可能会再次为我们简化它。

使用类似的东西：

```
$ gcc -Wall -Wextra -pedantic -ggdb -o myprog mycode.c
```

```
#include <stdio.h>

int main(void)
{
    int i;

    while((i = getchar()) != EOF)
        putchar(i);
    return 1; /* Normally you would use 0, 1 indicate some error. */
} 
```

在终端：

```
$ gdb ./my_prog
(gdb) r < textfile.txt
Starting program: /home/xm/devel/ext/so/my_prog < textfile.txt
Text text text
Text text text
Text text text
Text text text

[Inferior 1 (process 17678) exited with code 01]
(gdb) q 
```

* * *

线程（错误的代码，但是......）：

```
#include <pthread.h>
#include <stdio.h>

void *say_hello(void *threadid)
{
    printf("Helllu!\n");
    pthread_exit(NULL);
}

void *read_stdin(void *threadid)
{
    int i;

    while((i = getchar()) != EOF)
        putchar(i);
    pthread_exit(NULL);
}

int main(void)
{
    pthread_t threads[2];
    pthread_create(&threads[0], NULL, read_stdin, (void*)0);
    pthread_create(&threads[1], NULL, say_hello,  (void*)1);
    pthread_exit(NULL);
} 
```

在终端：

```
$ gdb ./my_prog
(gdb) r < textfile.txt
Starting program: /home/xm/devel/ext/so/my_prog < textfile.txt
[Thread debugging using libthread_db enabled]
[New Thread 0xb7fd9b70 (LWP 17843)]
Text text text
Text text text
Text text text
Text text text

[New Thread 0xb77d8b70 (LWP 17844)]
Helllu!
[Thread 0xb77d8b70 (LWP 17844) exited]
[Thread 0xb7fd9b70 (LWP 17843) exited]
[Inferior 1 (process 17840) exited normally] 
```

# java - 范围内的随机（双值）数字生成器

> ID：10290900
> 
> 赞同：0
> 
> 时间：2012-04-24T02:11:52.650
> 
> 标签：java, random, double

Java api 有一种方法可以生成 0（含）和 n（不含）之间的整数，但没有一种方法可以在给定一定范围（例如 2.0 到 3.0）的情况下生成双精度值的随机数。如何才能做到这一点？

* * *

```
 double x = 0.7 + Double.valueOf(Math.random()*(9.0-0.7)).intValue(); 
```

结果只有少数 0.7 类型

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:30:48.963

你非常接近，但`intValue()`调用是不必要的，`Double.valueOf( String )`调用甚至不应该编译。

```
public double random( double min, double max )
{
  double diff = max - min;
  return min + Math.random( ) * diff;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-06T01:15:13.940

标记的答案不包括最大值（nextDouble 的最大值为 0.9）。作为旁注，我想提出我的答案，包括最大值。

```
public double randomDouble(double min, double max) {
    double divider = 1.1111111111111111111111111111111; 
    double num = min + (random.nextDouble() * ((max - min) * divider)); 
    return num2; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T02:47:50.790

您是否尝试过 Random 类？ [http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html) 有浮点、双精度的方法...

# javascript - 从两个常规数组创建一个关联数组

> ID：10290908
> 
> 赞同：2
> 
> 时间：2012-04-24T02:13:29.700
> 
> 标签：javascript, associative-array

我想将两个常规数组绑定到一个关联数组中。第一个的值是键，第二个的值是元素。

```
var array1=new Array("key1","Key2","Key3");
var array2=new Array("Value1","Value2","Value3");

var associative_array=new Array();
for(var i=0;i<3;i++){

associative_array[array1[i]]=array2[i];
} 
```

但是当我尝试获取新关联数组的长度时，我注意到它是空的：

```
alert(associative_array.length);//always 0 
```

请问做错了什么？提前谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T02:32:34.987

在 Javascript 中，将对象用于关联数组。有很多方法可以重写它，但使用您的示例只需将“new Array()”替换为“new Object()”：

```
var array1=new Array("key1","Key2","Key3");
var array2=new Array("Value1","Value2","Value3");

var associative_array=new Object();
for(var i=0;i<3;i++){
  associative_array[array1[i]]=array2[i];
} 
```

您需要实现一些东西来获取对象的大小。以下应该是函数或方法的一部分，但应该说明这个想法：

```
var o_size = 0;
for (key in associative_array) {
  o_size++;
}
alert(o_size); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T02:16:52.420

### 我这样做的方式：

```
function createAssociativeArray(arr1, arr2) {
    var arr = {};
    for(var i = 0, ii = arr1.length; i<ii; i++) {
        arr[arr1[i]] = arr2[i];
    }
    return arr;
}

var array1 = ["key1", "Key2", "Key3"];
var array2 = ["Value1", "Value2", "Value3"];
var associativeArray = createAssociativeArray(array1, array2); 
```

这（与您的方法不同）将返回一个没有`length`属性的对象，因为它的每个值都不被视为索引，而是一个属性。如果您迫切需要获取对象属性的长度，可以执行以下操作：

```
function getObjectPropertiesLength(obj) {
    var propNum = 0;
    for(prop in obj) {
        if(obj.hasOwnProperty(prop)) propNum++;
    }
    return propNum;
}

var values = getObjectPropertiesLength(associativeArray); 
```

请注意，如果您向对象添加函数，这些函数将被视为对象的属性，因此会影响对象的属性长度。

### 你的方法是做什么的：

您的方法失败的原因是您正在向 Array 对象添加属性。是的，从技术上讲，数组是 Javascript 中的对象，这意味着您可以为它们分配属性。但是，这并没有按照预期的方式使用数组，这可能会产生意想不到的结果。这些结果之一是该`length`值将突然失效。

这是因为 Array 对象希望它们的属性用数字索引。如果将属性分配给带有字符串的对象，则返回数组长度的函数实际上无法看到该属性，因此它不会影响数组的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T02:18:51.077

在 JavaScript 中，关联数组只是一个对象。它没有长度属性。事实上，将 Array() 用作关联数组并不是一个好主意。您生成对象的代码在其他方面是可以的，除了可能将大小硬编码为 3。

# windows - 如何让 GNU Unifont 或 Free Mono 在 gvim windows 上工作？

> ID：10290912
> 
> 赞同：8
> 
> 时间：2012-04-24T02:13:58.810
> 
> 标签：windows, vim, fonts, monospace

我试图在 Windows 7 上的 gvim 中获得对符文字符的支持。我的字体目录中安装了 Free Mono 和 GNU Unifont 字体（它们都支持这个范围），但它们没有出现在字体菜单中，并且 gvim 给出我以下行的字体无效消息：

```
set guifont=unifont:h12:cANSI
set guifont=GNU_Unifont:h12:cANSI
set guifont=Free_Mono:h12:cANSI
set guifont=Free_Monospaced:h12:cANSI
set guifont=FreeMono:h12:cANSI

etc... 
```

我怎样才能让它工作？我注意到这两种字体都是字体系列“Medium”的一部分，而可以使用的 Ubuntu Mono 被标记为“Regular”。这有什么区别吗？一般来说，在 gvim 上更改字体，甚至是等宽字体，我都没有太多运气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T01:41:54.153

你让我很好奇为什么这不起作用，所以我安装`fontforge`了在字体内部窥探。事实证明，您对字体本身存在问题的看法是正确的：[PANOSE 比例代码](http://www.monotypeimaging.com/productsservices/pan2.aspx)是“均匀宽度”（4），而不是“等宽”（9）。由于 vim 过滤掉了非等宽字体，这就解释了为什么它们没有出现在对话框中。

如果你有兴趣，我通过[这个日本人](http://www.geocities.jp/meir000/fontforge/)`fontforge`准备的独立 cygwin/X 构建获得了 Windows ，通过[这个页面](http://www.useragentman.com/blog/2011/02/27/installing-cygwin-and-fontforge-for-windows/#mingw)用英文讨论。安装后，打开字体并查看 Element->Font Info->OS/2->Panose。

我尝试更改设置并保存文件，但 1) 保存的字体文件比原始文件大 10 倍，保存文件需要几分钟，所以可能出了问题，然后 2) Windows 拒绝加载它，抱怨它不是一个有效的字体文件。我的好奇心已经到了尽头，但也许你可以让它发挥作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T03:16:41.970

对于 Win32、GTK、Motif、Mac OS 和 Photon：

```
:set guifont=* 
```

将弹出一个字体请求器，您可以在其中选择所需的字体。

键入`:set guifont?`以获取设置，并将其放入您的`.vimrc`. 当您将其放入 .vimrc 文件时，如果有空格，则必须转义空格。例如，如果 ':set guifont?' 输出 'Gnu Unifont 10'，需要在 .vimrc 中设置为：

```
set guifont=Gnu\ Unifont\ 10 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-01T11:40:24.233

我最近遇到了同样的问题并用`fontforge`. 以下是生成工作`unifontmono.ttf`字体的工作流程：

*   启动`fontforge`并打开`unifont.ttf`字体。在 Debian 上，它安装在

> /usr/share/fonts/truetype/unifont/unifont.ttf

*   转到`Element`->`Font Info...`
    *   下`PS Names`变化`Fontname`，`Family Name`和`Name for Humans`，例如成`UnifontMono`。
    *   在`OS/2`->`Panose`更改`Proportion`为`Monospaced`.
*   单击`Save`。在弹出的选择`Change`中。
*   `File`-> `Generate Fonts...`。`TrueType`在左侧请求者中选择，选择，`No Bitmap Fonts`禁用`Validate Before Saving`。
*   `Save`

这应该会保存一个可以在 Windows 下安装的 TTF 文件。

`gvim`要在 Windows 上使用字体：

1.  通过双击安装字体并选择`Install`.
2.  `gvim`以管理员身份开始：

    *   转到`Edit`-> `Startup Settings`。
    *   添加以下行：

> 设置 guifont=UnifontMono:h12:cANSI

3.  restart `gvim`，它现在应该使用转换后的字体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-11T17:25:53.550

问题是 Unifont 声称是固定宽度的，但包含双宽字符（例如组合的双波浪号，U+0360）。根据构建 Gvim 的工具包，可能不接受 TTF 字体，只接受位图。因此这个答案。

## 位图 (PCF) 字体的解决方案

将字体副本复制到您有权限的目录中，然后在 Fontforge 中打开它。

使用 Ctrl+A 选择所有元素（它们将突出显示）。去

*   工具栏 > 度量 > 设置宽度
*   将宽度设置为：8 {最初设置的数字的一半}
*   单击确定并等待，这将需要几分钟

操作完成后，

*   工具栏 > 元素 > 其他信息 > BDF 信息
*   在 FONT 字段中，将“Unifont”更改为“Unifix”（或您喜欢的其他名称）
*   向下滚动并单击 New > FONT ASCENT（一个数字是自动设置的，不要管它）
*   向下滚动并单击 New > FONT DESCENT（一个数字是自动设置的，不要管它）
*   点击确定

现在将 BDF 字体保存在 File > Generate Fonts 菜单 (Ctrl+Shift+G) 中。选择您喜欢的名称，否则使用默认设置。

### 在 Linux 中为 X11 设置字体

`unifix.bdf`我将假设您在上一步中命名了字体。退出 Fontforge，返回终端并发出

```
bdftopcf unifix.bdf > unifix.pcf
gzip unifix.pcf 
```

此时可以删除留下的两个PCF和BDF文件。现在选择一条路线。

*   拥有root权限，

    ```
    mv unifix.pcf.gz /usr/share/fonts/X11/misc
    mkfontdir /usr/share/fonts/X11/misc
    xset fp rehash 
    ```

*   如果您没有 root 权限或不想在主目录中对系统范围的目录大惊小怪，

    ```
    mkdir .fonts
    mv unifix.pcf.gz .fonts
    mkfontdir .fonts
    xset +fp $HOME/.fonts/
    xset fp rehash 
    ```

    每次重新启动后都需要重复这两个 Xset 命令。

现在应该列出字体是`xfontsel`并且`xlsfonts`你终于可以在 Gvim 中使用它了 `:set gfn=-*-unifix-*`。

# ajax - 使用 ajax/json 检查 URL 的状态

> ID：10290913
> 
> 赞同：1
> 
> 时间：2012-04-24T02:14:19.277
> 
> 标签：ajax, json

我需要定期从 URL 检索 JSON 数据，并相应地更新我的页面。

我有一张桌子。每行都有一个链接，我将链接以测试其状态，例如每 20 秒。

这可以使用页面刷新元标记来实现，但我认为 ajax 会是一个更好的解决方案。

我应该使用 $.getJSON 吗？（我对 ajax/json 很陌生）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:39:27.677

你基本上在那里。首先，这`$.getJSON()`只是一个方便的方法`$.ajax()`，`datatype: 'json'`它是始终坚持使用的最佳实践`$.ajax()`。您想`setTimeout`在要异步加载的函数中调用 - 因此您将在此处使用递归。好处是您可以重复进行 AJAX 调用，但只有在前一个方法完成时，才能正常运行。一个简单的例子如下：

```
$(function() {
    var myFunction = function() {
        $.ajax({ 
            url: '/place-for-cool-stuff', 
            datatype: 'json',
            data: { ... data you need to send, e.g. method arguments ... }
         }).done(function (data) {
             ... do stuff with the data you get back ...
         }).fail(function (jqXHR) {
             ... be smart and handle failures ...
         }).always(function () {
             ... no matter what happens do this stuff ...
             setTimeout(myFunction, 20000);
         });
     };
}); 
```

# java - 可以重定向到 pages.xml 中的两个不同页面吗？

> ID：10290916
> 
> 赞同：1
> 
> 时间：2012-04-24T02:15:22.803
> 
> 标签：java, jsf, seam

mi question 基于根据 SEAM 中 URL 传递的值重定向到一个页面或另一个页面。例如：我有这个链接在 URL 中传递一些参数：

[http://localhost:8080/Refund/home.seam?user=012012&name=john&auth_level=4](http://localhost:8080/Refund/home.seam?user=012012&name=john&auth_level=4)

在接缝 pages.xml 文件中，我有这样的配置：

```
<page view-id="/home.xhtml" >
    <action if="#{authenticator.limpiar}" execute="#{identity.login}"  />
                <param name="user" value="#{user.number}" />
                <param name="name" value="#{user.name}" />
                <param name="auth_level" value="#{user.authLevel}" />

    <navigation from-action="#{identity.login}" >
            <rule if="#{identity.loggedIn}" >
                    <redirect view-id="/pages/page1.xhtml" />
            </rule>
            <rule if="#{not identity.loggedIn}">
                    <redirect view-id="/errorLogin.xhtml"/>
            </rule>
    </navigation>
</page> 
```

但现在我有另一个参数要添加到这个 URL。这个参数是“emp_id”，可以取值 1 或 15。所以现在的 url 是：

[http://localhost:8080/Refund/home.seam?user=012012&name=john&auth_level=4&emp_id=X](http://localhost:8080/Refund/home.seam?user=012012&name=john&auth_level=4&emp_id=X) 其中 X 可以取 1 或 15。

根据需要的数字，它必须重定向到一个页面或另一个页面（page1.xhtml 或 page2.xhtml），但我不知道如何在 pages.xml 文件中执行此操作。

请任何人都可以给一些技巧来做到这一点？或其他解决方案？

谢谢！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T10:37:42.183

You can always execute a custom action (es. execute="#{redirectAction.go}") and manually redirect users. In seam way:

```
 Redirect redirect = Redirect.getInstance();
 redirect.setViewId("...") 
```

In standard way:

```
FacesContext.getCurrentInstance().getExternalContext().redirect("..."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:19:42.733

如果您首先将参数分配给参数，这应该是可能的。尝试这个：

```
<page view-id="/home.xhtml" >
    <action if="#{authenticator.limpiar}" execute="#{identity.login}"  />
                <param name="user" value="#{user.number}" />
                <param name="name" value="#{user.name}" />
                <param name="auth_level" value="#{user.authLevel}" />
    <param name="emp_id" value="#{somebean.emp_id}"/>
    <navigation from-action="#{identity.login}" >
            <rule if="#{identity.loggedIn}" >
                    <redirect view-id="/pages/page1.xhtml" />
            </rule>
            <rule if="#{not identity.loggedIn}">
                    <redirect view-id="/errorLogin.xhtml"/>
            </rule>
            <rule if="#{somebean.emp_id eq '1'}"><!-- use eq if emp_id is a string -->
                    <redirect view-id="/yourview.xhtml"/>
            </rule>
    </navigation>
</page> 
```

我想我曾经使用过类似的东西，但现在没有设置来测试它。但是，我确实认为您应该考虑其他事情，例如重定向到视图，将 emp_id 作为参数传递，然后使用重写规则来创建一个不错的 url。

# repository-pattern - 没有用于检索标量值的域对象的存储库模式

> ID：10290918
> 
> 赞同：4
> 
> 时间：2012-04-24T02:15:40.910
> 
> 标签：repository-pattern, separation-of-concerns, service-layer, domain-model, scalar

最近，我一直在努力弄清楚我的架构中的某些方法、功能是否合适；在正确的层。我想按照[Martin Fowler 的存储库模式](http://martinfowler.com/eaaCatalog/repository.html)将我的服务层与数据库分离。

Martin Fowler 在他的网站上解释的定义说：

> 存储库在域和数据映射层之间进行调解，就像内存中的域对象集合一样。

问题是我有很多要求，例如所有发票的总和。如您所知，所有发票的总和是一个标量值。如果我遵循 Martin Fowler 的定义，我应该做的是创建一个函数，该函数从我的存储库层返回域对象列表，该列表由服务层接收，该服务层循环抛出对象以计算总数。也有可能我不明白这种模式意味着什么的本质......

我知道在设计应用程序时性能不应该是一个问题，因为可维护性更好，但在这种情况下，在我看来**，不在存储库层中创建**一个返回十进制值的函数完全浪费了开发和性能时间对应于发票总数，并从服务层返回相同的值。即使您可以使用 ORM 添加一些延迟加载策略，实现对象列表然后仅使用单个属性也是一种过度杀伤力。

从存储库层返回标量值是否正确，还是我应该抵制诱惑并始终从该层返回域对象并处理服务层中的所有业务逻辑？

我也有很多地方，我的演示者直接调用我的存储库，而不是调用服务层，然后再调用存储库层。它是正确的; 可以在服务层之外调用此存储库模式吗？

请注意，我不想从我的存储库层返回 IQueryable 结果，因为这将与[Demeter 法则](http://en.wikipedia.org/wiki/Law_of_Demeter)完全矛盾。

另外，我不想直接在我的服务层中设置查询，因为我希望能够对这一层进行完全的单元测试；不做集成测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:12:54.873

这个问题很容易用 CQRS（作为一个概念）解决。有一个专门用于查询的存储库，可供 UI 使用（或在使用 MVC 时由控制器使用）。该 repo 可以直接查询 db（它并不重要的 ORM 实体）并返回您需要的内容。

仅在更新模型时保留“重”域对象和相应的存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T06:05:01.517

I had similar issues and I ended up having a base and derived repository interfaces. The base would have standard methods: Fetch, Update, etc. while the derived interface would have specific methods (get the scalar value, in your case).

```
public interface IRepository { ... } 
```

and

```
public interface IInvoiceRepository : IRepository 
{ 
  int GetTotal(); 
} 
```

You then create an InvoiceRepository class which implements the interface. Is better to implement the business logic in a separate class, say InvoiceBusinessObject which gets a dependency injection of type IInvoiceRepository (use a parameter in the constructor). Never use the implementation in your business layer.

```
public class InvoiceBusinessObject
{
  private IInvoiceRepository rep;

  public InvoiceBusinessObject(IInvoiceRepository rep)
  {
    this.rep = rep;
  }

  public int GetTotal()
  {
    return rep.GetTotal();
  }
} 
```

The service layer can instantiate the InvoiceRepository class and inject the instance into the business object class:

```
public int GetTotalFromService()
{
  IInvoiceRepository rep = new InvoiceRepository();
  InvoiceBusinessObject bizObj = new InvoiceBusinessObject(rep);
  return bizObj.GetTotal();
} 
```

# javascript - 在 jQuery 中，如何在 for 循环中正确使用选择器作为 var？

> ID：10290919
> 
> 赞同：0
> 
> 时间：2012-04-24T02:15:47.493
> 
> 标签：javascript, jquery

当应用于 for 循环中动态创建的 div（来自 XML 文件）时，我试图在我的选择器中使用一个变量。previewDialog 仅在我单击最后一个 div 时打开。当我单击每个概览 div 时，如何打开 previewDialog？

```
<script type="text/javascript">
if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp = new XMLHttpRequest();
} else { // code for IE6, IE5
  xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET", "Library.xml", false);
xmlhttp.send();
xmlDoc = xmlhttp.responseXML;

var f = xmlDoc.getElementsByTagName("FeaturedEntry");
var x = xmlDoc.getElementsByTagName("BookEntry");
for (b = 0; b < x.length; b++) {

  var bToString = b.toString();
  var overviewOpener = "#overview" + bToString;
  var previewDialog = "#preview" + bToString;

  // increase the default animation speed to exaggerate the effect
  $.fx.speeds._default = 1000;
  $(function () {
    $(previewDialog).dialog({
      autoOpen : false,
      show : "blind",
      hide : "explode"
    });

    $(overviewOpener).click(function () {
      $(previewDialog).dialog("open");
      return false;
    });

  });

  document.write(overviewOpener + " " + b.value + " " + bToString);
  document.write("<div id='overview");
  document.write(b);
  document.write("'><img id='cover' src='/ClientBin/");
  icon = x[b].getAttribute("Icon");
  document.write(icon);
  document.write("'/><br><strong><a href='http://www.google.com'>");
  title = x[b].getAttribute("Title");
  document.write(title);
  document.write("</a></strong><br>");
  author = x[b].getAttribute("Author");
  document.write(author);
  document.write("<br>");
  document.write("Rating:");
  rating = x[b].getAttribute("Rating");
  numStars = Math.round(rating * 5);
  for (n = 0; n < numStars; n++) {
    document.write("<img src='/Media/star.png'/>");
  }
  document.write("<br><a><img id='button' src='Media/Small_iBookstore_Badge.gif' /></a>");
  document.write("</div>");

  document.write("<div id='preview");
  document.write(b);
  document.write("'>This is a test ");
  document.write(b);
  document.write("</div>");

}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:29:48.560

关闭我的朋友。关闭。问题是它 `$(function () {`不像你想象的那样内联执行，它是在 DOM 加载时执行的。但是你`var b`在`$(function)`调用之外，这意味着当调用这个函数时，它会选择*当前*版本的 b，这就是为什么你看到它只适用于最后一个。您需要将您的 $(function) 完全放在 for 循环之外，然后执行以下操作：

```
$(function () {
  //add the for loop here 
    for (var b = 0; b < x.length; b++) {
        $("#preview" + b).dialog({
            autoOpen: false,
            show: "blind",
            hide: "explode"
        });

        $("#overview" + b).click(function () {
            $("#preview" + b).dialog("open");
            return false;
        });
    }); 
```

话说回来。你仍然以错误的方式做事。像这样的循环也不是正确的方法。你真正应该做的不是这个：

```
document.write("<div id='preview");
    document.write(b);
    document.write("'>This is a test ");
    document.write(b);
    document.write("</div>"); 
```

做这个：

```
document.write("<div class='preview'>This is a test ");
    document.write(b);
    document.write("</div>"); 
```

看看我们如何为每个 div 赋予相同的“预览”类？

现在你可以这样做：

```
$(function () {
      //no for loop needed now
            $(".preview").dialog({
                autoOpen: false,
                show: "blind",
                hide: "explode"
            }); 
```

*编辑*：你是对的，你*确实*需要为每个 div 有一个唯一的名称，但不完全是你认为的原因。原因是 jQuery UI Dialog 将元素移动到 DOM 的顶部。最初，我以为您会执行以下操作：

`$(".overview").closest(".SomeContainerDiv").find(".preview")`.... 但不幸的是，在这种情况下（因为 div 被移动了），你不能这样做。看看这个jsfiddle：

[http://jsfiddle.net/ehs4K/](http://jsfiddle.net/ehs4K/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:31:43.763

我无法浏览整个代码，但据我所知，概述 div 是动态创建的。对于动态创建的元素，您必须使用

```
$(overviewOpener).live("click",function(){
//hanfle click function}); 
```

# android - 准确获取 GPS 位置

> ID：10290925
> 
> 赞同：3
> 
> 时间：2012-04-24T02:16:57.607
> 
> 标签：android, gps

`私人无效getLocation（）{

```
 String context = Context.LOCATION_SERVICE;
        LocationManager locationManager = (LocationManager)getSystemService(context);
        Criteria criteria = new Criteria();
        criteria.setAccuracy(Criteria.ACCURACY_COARSE);
        criteria.setAltitudeRequired(false);
        criteria.setBearingRequired(false);
        criteria.setCostAllowed(true);
        criteria.setPowerRequirement(Criteria.POWER_LOW);

        String provider = locationManager.getBestProvider(criteria, true);
        Location location = locationManager.getLastKnownLocation(provider);
        updateWithNewLocation(location);

        locationManager.requestLocationUpdates(provider, 2000, 5, locationListener);

    }

    private final LocationListener locationListener=new LocationListener()
    {
        public void onLocationChanged(Location location)
        {
            updateWithNewLocation(location);
        }
        public void onProviderDisabled(String provider)
        {
            updateWithNewLocation(null);
        }
        public void onProviderEnabled(String provider)
        {

        }
        public void onStatusChanged(String provider,int status,Bundle extras)
        {

        }
    }` 
```

我在上面获取位置的代码。但我申请的结果并不准确。我想准确地获得我的位置。还有其他方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T03:27:52.153

获得准确的定位取决于信号是否可用。例如。gps 信号是否存在。如果 GPS 不存在，手机使用 wifi 或服务提供商跟踪，这不太准确。因此，请尝试使用谷歌地图并查看您的位置，如果您使用谷歌地图获得更准确的位置修复，那么您的代码中缺少某些内容。

我可以看到的一个错误是您正在使用 ACCURACY_COARSE，请尝试使用 ACCURACY_FINE。如果您还没有，您还必须在清单中添加这些权限。

# c++ - C多线程程序中的文件输入和输出（windows）

> ID：10290926
> 
> 赞同：1
> 
> 时间：2012-04-24T02:17:10.337
> 
> 标签：c++, multithreading, file

我在尝试在多线程中打开单独的txt文件时遇到了一个问题，即每个线程打开一个txt文件并读取内容，代码如下。

```
#include<stdlib.h>
#include<windows.h>
#include<process.h>

DWORD WINAPI lookup1(LPVOID lpParamter){
 char x[10];
 int y;
 FILE* fin1 = fopen("D:\\1.txt", "r");
 fscanf(fin1, "%s %d", x, &y);
 printf("%s %d", x, y);
 fclose(fin1);
 return 0;
}

DWORD WINAPI lookup2(LPVOID lpParamter){
 char x[10];
 int y;
 FILE* fin2 = fopen("D:\\2.txt", "r");
 fscanf(fin2, "%s %d", x, &y);
 printf("%s %d", x, y);
 fclose(fin2);
 return 0;
}

int main(){
    CreateThread(NULL, 0, lookup1, NULL, 0, NULL);
    CreateThread(NULL, 0, lookup2, NULL, 0, NULL);
    return 0;
} 
```

我认为这是一个非常简单的程序，每个线程打开一个单独的文件并从中读取。没有涉及文件共享等复杂情况，但是我发现每个线程都没有成功打开文件，fopen之后的其余代码都跳过了，没有任何信息提示。当我调试这个程序时，它甚至卡在 fopen 或 fscanf 语句中，并且永远无法恢复（Windows 操作系统崩溃）。不知道为什么，请帮帮我，谢谢！！！

编辑：通过将主要功能更改为以下代码，问题得到解决，非常感谢！

```
int main(){
    HANDLE hThread1 = CreateThread(NULL, 0, lookup1, NULL, 0, NULL);
    HANDLE hThread2 = CreateThread(NULL, 0, lookup2, NULL, 0, NULL);

    WaitForSingleObject(hThread1, INFINITE);
    WaitForSingleObject(hThread2, INFINITE);

    CloseHandle(hThread1);
    CloseHandle(hThread2);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:31:27.463

该应用程序产生两个线程，然后在线程有机会做任何事情之前退出。 `CreateThread`返回一个`HANDLE`。这些 HANDLE 是可以传递给的等待对象`WaitForSingleObject`。

# objective-c - 以编程方式实现导航控制器

> ID：10290927
> 
> 赞同：0
> 
> 时间：2012-04-24T02:17:23.630
> 
> 标签：objective-c, ios, uinavigationcontroller

我通过以下方式创建了 6 个视图控制器：

```
Truck_Tracker_AppAppDelegate *delegate = (Truck_Tracker_AppAppDelegate *)UIApplication.sharedApplication.delegate;
UIViewController *viewController1 = [[TrucksViewController alloc] initWithNibName:@"TrucksView" bundle:nil];
UIViewController *viewController2 = [[MapViewController alloc] initWithNibName:@"MapView" bundle:nil];
UIViewController *viewController3 = [[BlockPartyViewController alloc] initWithNibName:@"BlockPartyView" bundle:nil];
UIViewController *viewController4 = [[FavoritesViewController alloc] initWithNibName:@"FavoritesView" bundle:nil];
UIViewController *viewController5 = [[UserSettingsViewController alloc] initWithNibName:@"UserSettingsView" bundle:nil];
UIViewController *viewController6 = [[TOSettingsViewController alloc] initWithNibName:@"TOSettingsView" bundle:nil]; 
```

我需要 viewController1、3 和 4 以编程方式包装在导航控制器中。我在 Apple Developer 的网站上找到了这个：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application
{
UIViewController *myViewController = [[MyViewController alloc] init];
navigationController = [[UINavigationController alloc]
                            initWithRootViewController:myViewController];

window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
window.rootViewController = navigationController;
[window makeKeyAndVisible];
} 
```

但我需要在创建视图控制器的地方进行。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:17:01.510

好吧，关于 UINavigationController，你必须先了解一些事情。通过使用`UINavigationController * navigationController = [[UINavigationController alloc]initWithRootViewController:myViewController];`，您实际上是在为 myViewController 类创建导航控制器，它会自动授予它一个默认的 UIToolBar 和一个默认的 UINavigationBar。并且因为 UINavigationController 是 UIViewController 的子类，所以它可以在任何将所述类作为参数的函数中自由使用。

我假设您希望在 UITabbar 中使用它，因此为每个视图控制器创建一个单独的 UINavigationController 实例，将它们收集到一个 NSArray* 并将它们设置为等于您的 UITabbar 上的“viewControllers”属性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T02:51:41.923

您创建一个包含指向视图控制器的指针的 N​​SArray，并将 NSArray 分配给导航控制器的 viewControllers 属性。

# wpf - 用 WPF RichTextBox 中的超链接替换文本

> ID：10290928
> 
> 赞同：0
> 
> 时间：2012-04-24T02:17:29.660
> 
> 标签：wpf, vb.net

我想用我的 RichTextBox 中的超链接替换常规链接，所有信息都是通过外部库 (LinkEntity) 提供给我的。但我不知道如何实际替换文本。

我有这个，但它不能正常工作，有时它会抛出一个 value cannot be null 异常，有时它只是替换了链接的错误部分。

```
 Dim Start As TextPointer = TweetText.Document.ContentStart
        Dim StartPos As TextPointer = Start.GetPositionAtOffset(LinkEntity.StartIndex)
        Dim EndPos As TextPointer = Start.GetPositionAtOffset(LinkEntity.EndIndex)
        Dim h As New Hyperlink(StartPos, EndPos)
        AddHandler h.MouseLeftButtonDown, AddressOf Hyperclick_Link
        h.NavigateUri = New Uri(LinkEntity.Url)
        h.Cursor = Cursors.Hand 
```

抛出异常是因为 StartPos 和 EndPos 什么都不是，即使 Start 和 End 索引具有有效值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T21:45:05.207

我发现了问题，当我在声明 StartPos 和 EndPos 时调用它时，TweetText.Document 没有值。我的最终代码如下所示：

```
Dim FlowDocument As New FlowDocument
Dim Paragraph As New Paragraph
Paragraph.Inlines.Add(myfireactions.FormatTweet(Tweet))
FlowDocument.Blocks.Add(Paragraph)

Dim Start As TextPointer = FlowDocument.ContentStart
Dim StartPos As TextPointer = Start.GetPositionAtOffset(LinkEntity.StartIndex + 2)
Dim EndIndexInt As Integer = LinkEntity.StartIndex + LinkEntity.DisplayUrl.Length + 2
Dim EndPos As TextPointer = Start.GetPositionAtOffset(EndIndexInt, LogicalDirection.Backward)
Dim h As New Hyperlink(StartPos, EndPos)
AddHandler h.MouseLeftButtonDown, AddressOf Hyperclick_Link
h.NavigateUri = New Uri(LinkEntity.Url)
h.Cursor = Cursors.Hand

TweetText.Document = FlowDocument 
```

# java - 将文本文件中的名称和数字放入数组中

> ID：10290936
> 
> 赞同：0
> 
> 时间：2012-04-24T02:18:31.783
> 
> 标签：java, arrays, file, text

有一个排名、姓名和受欢迎程度的列表 1 Jake 21021（排名、实际姓名、当年有多少婴儿获得了这个名字）我试图将这三个独立的东西分成数组。这样，如果用户搜索“Jake”排名：1 会弹出，21021 也会弹出。这就是我目前所拥有的......

```
import java.util.*;
import java.io.*;

public class Test
{
    public static void main(String[] args)

    {
        Scanner inputStream = null;
        try
        {
            inputStream = new Scanner(new FileInputStream("src/boynames.txt"));
        }
        catch (FileNotFoundException e)
        {
            System.out.println("Sorry we couldn't find the requested file...");
            System.out.println("Exiting...");
            System.exit(0);
        }
        //Initializing the BOY Variables
        int[] counter = new int[1];
        String[] name = new String[1];
        int[] popularity = new int[1];
        //End of initializing BOY variables
        for (int i=0; i <1000;i++)
        {
            counter[0] = 1;
            name[i] = inputStream.next();
            popularity[i]=inputStream.nextInt();
            System.out.print(counter[i] + " " + name[i] + " " + popularity[i] );
            counter[i] = counter[i] + 1 ;
        }
    }
} 
```

我不断收到错误

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 1
    at Test.main(Test.java:27) 
```

任何帮助都是极好的！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:22:54.873

由于 name 数组的长度为 1，因此 name 的最大索引为 0。因此在 i=1 时的下一次循环迭代期间，该行将超出范围。

```
name[i] = inputStream.next(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:23:27.377

乍一看，您正在创建大小为 1 的数组（`new int[1]`等），然后尝试在 for 循环中访问索引 0-999。如果您希望一个数组中有 1000 个位置，就像您的 for 循环所要求的那样，那么您应该创建一个数组，例如`new int[1000]`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T02:24:20.400

您已初始化`name`为大小为 1 的数组，但随后您引用`name[i]`，其中`i`计数最多为 1000。 `name[0]`有效，但一旦达到`name[1]`，您就会得到异常。

您应该初始化`name`为`String[1000]`. 或者（更好）使用 ArrayList，它会随着您向其中添加项目而扩展。

# python - 在类中嵌套自定义异常类？（Python）

> ID：10290942
> 
> 赞同：4
> 
> 时间：2012-04-24T02:19:31.000
> 
> 标签：python, class, scope, nested, nested-class

我想在我自己的类中嵌套一个 Exception 子类，如下所示：

```
class Foo(object):

    def bar(self):
        #does something that raises MyException

    class MyException(Exception):
        pass 
```

这样，当从另一个模块调用 bar() 时，我只需要导入 Foo（而不是 MyException）。但是我下面的内容不起作用：

```
from foo_module import Foo

foo = Foo()

try:
    foo.bar()
except Foo.MyException as e:
    print e 
```

Python给出了这个错误：

> 类型对象“Foo”没有属性“MyException”

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T02:26:52.080

鉴于以下内容`t.py`：

```
class Foo():
  def RaiseBar(self):
    raise Foo.Bar("hi")
  class Bar(Exception):
    pass 
```

并在 python 终端上运行它：

```
>>> import t
>>> x = t.Foo()
>>> try:
...     x.RaiseBar()
... except t.Foo.Bar as e:
...     print e
... 
hi 
```

这不正是您要找的吗？

不知道你做错了什么，我建议你更仔细地重新检查代码。

# c# - 正确使用UDP DatagramSocket

> ID：10290945
> 
> 赞同：2
> 
> 时间：2012-04-24T02:19:37.333
> 
> 标签：c#, sockets, networking, udp, windows-runtime

我的基类中有以下代码（下面提供的片段）用于处理 UDP 套接字。我正在添加对 WinRT 的支持（由 WINRT 的#define 控制）。我的一切都适用于 .Net，但我的 WinRT 实现出了点问题。当我发送数据时，服务器端没有收到它。知道出了什么问题吗？我在客户端没有看到任何错误，服务器上没有任何显示。我已经成功地让我的 TCP 套接字类工作，以类似的方式使用 DataWriter。

```
 public UdpSocketClient(IPEndPoint remoteEndPoint, int localPort)
        {
            this.remoteEndPoint = remoteEndPoint;
#if WINRT
            this.socket = new DatagramSocket();
            this.socket.MessageReceived += ReceiveCallback;

            // Bind to any port
            Logger.Debug("{0}: UdpSocketClient created. Binding to port {1}.", this, (localPort == 0) ? "[any]" : localPort.ToString());
            IAsyncAction bindAction = this.socket.BindEndpointAsync(new HostName("localhost"), localPort == 0 ? "0" : localPort.ToString());
            bindAction.AsTask().Wait();
            Logger.Trace("{0}: Bind Complete to port {1}", this, this.socket.Information.LocalServiceName);

            // Get IOutputStream
            Logger.Trace("{0}: Getting output stream to {1}.", this, remoteEndPoint);
            IAsyncOperation<IOutputStream> asyncOutput = this.socket.GetOutputStreamAsync(remoteEndPoint.address, remoteEndPoint.port.ToString());
            asyncOutput.AsTask().Wait();
            Logger.Trace("{0}: Got output stream.", this);

            // Create DataWriter
            dataWriter = new DataWriter(asyncOutput.GetResults());
#else
            ...
#endif
        }

        public void SendBuffer(ByteBuffer buffer, int wait = 0)
        {
#if WINRT
            Logger.Trace("{0}: Sending buffer. Wait = {1}", this, wait);
            for (int i = 0; i < buffer.WriteSize(); i++)
                dataWriter.WriteByte(buffer.Buffer()[i]);
            DataWriterStoreOperation op = dataWriter.StoreAsync();
            if (wait != 0) op.AsTask().Wait(wait);
            else op.AsTask().Wait();
            Logger.Trace("{0}: Sending complete.", this);
#else
        ...
#endif
        } 
```

一些相关日志：

```
04/23 19:08:57.504 DEBUG: Area Sync: UdpSocketClient created. Binding to port [any].
04/23 19:08:57.505 TRACE: Area Sync: Bind Complete to port 59518
04/23 19:08:57.506 TRACE: Area Sync: Getting output stream to 71.227.179.128:1302.
04/23 19:08:57.507 TRACE: Area Sync: Got output stream.

04/23 19:08:57.604 TRACE: Area Sync: Sending contact packet.
04/23 19:08:57.604 TRACE: Area Sync: Sending buffer. Wait = 0
04/23 19:08:57.605 TRACE: Area Sync: Sending complete. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:12:30.787

我想到了。显然它不喜欢我的绑定代码。文档说你应该能够将 null 传递给绑定，但我总是有一个例外。因此，如果我使用 ConnectAsync API，它就可以工作：

```
 public UdpSocketClient(IPEndPoint remoteEndPoint, int localPort)
        {
            this.remoteEndPoint = remoteEndPoint;
#if WINRT
            this.socket = new DatagramSocket();
            this.socket.MessageReceived += ReceiveCallback;

            Logger.Trace("{0}: Connecting to {1}.", this, remoteEndPoint);
            IAsyncAction connectAction = this.socket.ConnectAsync(remoteEndPoint.address, remoteEndPoint.port.ToString());
            connectAction.AsTask().Wait();
            Logger.Trace("{0}: Connect Complete. Status {1}, ErrorCode {2}", this, connectAction.Status, 
                connectAction.ErrorCode != null ? connectAction.ErrorCode.Message : "None");

            dataWriter = new DataWriter(this.socket.OutputStream);
#else
            ...
#endif
        } 
```

# mvvm - 请 RIA MVVM 指导

> ID：10290948
> 
> 赞同：1
> 
> 时间：2012-04-24T02:19:56.197
> 
> 标签：mvvm, telerik, wcf-ria-services, domainservices

我一直在尝试实现 MVVM，而且大部分情况下我真的很喜欢它。我已经能够找到大多数问题的答案，但有一件事我完全错过了，或者真的没有得到。这是关于通过 RIA 服务从服务器发送的数据。

在大多数用于在 ViewModel 中公开模型数据的示例中，似乎采用两种方式之一，将整个模型公开为一个属性（我不喜欢这种方法）：

```
public class MyViewModel : [SomeBaseClass]
{
    private MyModel _model;

    public MyModel Model
    {
        get { return _model; }
        set
        {
            if(_model == value)
                return;
            _model = value;
            PropertyChanged("MyModel");
        }
    }
} 
```

或者，实现您希望从模型公开到视图的各个属性。这是我一直这样做的方式，但这是相当多的额外工作。

许多使用对象列表的示例显示代码公开一个`ObservableCollection<TEntity>`（或某个通用集合的版本），其中 TEntity 是由 RIA 生成的类，然后将其绑定到控件 ItemsSource 等。好的，到目前为止一切都很好。但是当我需要处理基于该绑定对象的命令时会发生什么？到目前为止，为了处理这个我绑定到一个`ObservableCollection<CustomViewModel>`. 当我从服务器取回数据时，我会遍历返回的集合并将其“转换”为我的 CustomViewModel 并将其放入我的集合中。像这样：

```
LoadOperation load = Context.Load(Context.GetTasksForUserQuery(userId));
load.Completed += (s, e) =>
{
    if (!load.HasError)
    {
        _userTasks = new ObservableCollection<TaskItemViewModel>();

        foreach (Task entity in load.Entities)
            _userTasks.Add(new TaskItemViewModel(entity, Context));
    }
} 
```

现在我可以根据需要向 TaskItemViewModel 类添加命令等。但这并不理想。

一个很好的例子（现在已经过时了）可以在这里找到：[An MVVM Approach to Telerik Domain Services for Silverlight](http://blogs.telerik.com/blogs/posts/10-12-31/an-mvvm-approach-to-telerik-domain-services-for-silverlight.aspx) 该示例支持服务器端分页、过滤、分组等，并且运行良好。它再次绑定到 RIA 对象的集合，在本例中为客户列表。如果我想/需要在绑定项目级别处理一些命令怎么办？

我错过了什么？我知道您可以拥有元类以及共享代码，但从我的游戏/尝试来看，它似乎不符合要求。能够绑定到`<RIAObject>`. 有没有办法做到这一点并拥有我的“附加”命令？任何帮助/想法/输入都会很棒！

谢谢你，克里斯

# javascript - if... else 语句和数组

> ID：10290949
> 
> 赞同：-1
> 
> 时间：2012-04-24T02:19:59.570
> 
> 标签：javascript

我正在尝试使用 if... else 语句并通过数组元素的值将值分配给变量 stateCode。有些东西不工作，也许阵列不正确。这是代码：

```
<!DOCTYPE html>
<html>
<head>
   <title>if...else</title>
<script type="text/javascript">

function choices() {
   var stateCode = document.getElementById("x").value;
   var taxes = new Array(10; 7.5; 3.2);
     if ("x" === "OR") {
     document.writeln(taxes[0]);
   } else if ("x" === "CA") {
     document.writeln(taxes[1]);
   } else if ("x" === "MO") {
     document.writeln(taxes[2]);
   }

}
</script>
</head>
<body>
<p>
   <select id="x" onchange="choices(this.value);">
     <option value = "">---Reset---</option>
     <option value = "MO">MO</option>
     <option value = "OR">OR</option>
     <option value = "CA">CA</option>
   </select>

</p>       
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:28:18.660

好吧，我不确定所有的仇恨来自哪里。但是，您有一系列问题。

1.  document.writeln 在 javascript 中从来都不是很好。它会覆盖文档。这意味着您的选择框将消失。
2.  你一定有一个错字，因为你的字符串比较只是愚蠢的。但是，使用 === 做得很好
3.  内联方法处理程序，`onchange="choices(this.value);"`并不是最糟糕的事情。但应该避免它们。使用 javascript，您可以更轻松地处理浏览器之间的不同怪癖。
4.  现代浏览器将具有调试此代码的方法。Firebug for firefox、Internet Explorer 中的 F12 (PC) 和 webkit 浏览器中的调试控制台。这些将告诉您行号，并允许您以致命的精度查明问题。
5.  您当前正在内联处理程序中发送选择的值，所以我猜就使用它。
6.  `new Array`语法很麻烦。我避免它并使用括号，`[10, 3.2, 3]`.

* * *

至于你的问题：

添加 HTML

```
<div id="results"></div> 
```

...

```
function choices(stateCode) {
    var results = document.getElementById("results");
    var taxes = [10, 7.5, 3.2];

     switch(stateCode) {
        case "OR": 
            results.innerHTML = taxes[0];
            break;
        case "CA":
            results.innerHTML = taxes[1];
            break;
        case "MO":
            results.innerHTML = taxes[2];
            break;
        default:
            results.innerHTML = "No tax records for entry: " + stateCode;
            break;
     }
} 
```

[**例子**](http://jsfiddle.net/vF73T/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:23:11.223

```
 if ("x" === "OR") {
     document.writeln(taxes[0]);
   } else if ("x" === "CA") {
     document.writeln(taxes[1]);
   } else if ("x" === "MO") { 
```

替换`"x"`为并重`stateCode`试

并替换`var taxes = new Array(10; 7.5; 3.2);`为：

```
var taxes = new Array(10, 7.5, 3.2); 
```

它应该工作，它对我有用。

那么这个怎么样：用这个替换你的整个函数：

```
function choices() {
    var stateCode = document.getElementById("x");
    var taxes = new Array(10, 7.5, 3.2);
    if (stateCode.value != "") {
        document.getElementById("taxes").innerHTML = taxes[stateCode.selectedIndex - 1];
    }
} 
```

`<div id="taxes"></div>`并在页面上的某处添加。

# python - Python multi-loop failed when with generator and iterator

> ID：10290951
> 
> 赞同：1
> 
> 时间：2012-04-24T02:20:57.920
> 
> 标签：python, loops, iterator, generator

I need a 2D loop of which the first loop uses an iterator and the second uses a generator, but this simple function failed to work, can anyone help to check?

```
def alphabet(begin, end):
    for number in xrange(ord(begin), ord(end)+1):
        yield chr(number)

def test(a, b):
    for i in a:
        for j in b:
            print i, j

test(xrange(8, 10), alphabet('A', 'C'))

The result shows:
>>> 8 A
>>> 8 B
>>> 8 c 
```

don't know why? thanks in advance if any one can help.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:22:52.953

The first iteration over `b` consumes the generator.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:46:44.253

Since you've asked for clarification, I'll say a bit more; but really [Ignacio](https://stackoverflow.com/a/10290961/577088)'s answer sums it up pretty well: you can only iterate over a generator once. The code in your example tries to iterate over it three times, once for each value in `a`.

To see what I mean, consider this simplistic example:

```
>>> def mygen(x):
...     i = 0
...     while i < x:
...         yield i
...         i += 1
... 
>>> mg = mygen(4)
>>> list(mg)
[0, 1, 2, 3]
>>> list(mg)
[] 
```

When `mygen` is called, it creates an object which can be iterated over exactly once. When you try to iterate over it again, you get an empty iterable.

This means you have to call `mygen` anew, *every* time you want to iterate over it`. So in other words (using a rather verbose style)...

```
>>> def make_n_lists(gen, gen_args, n):
...     list_of_lists = []
...     for _ in range(n):
...         list_of_lists.append(list(gen(*gen_args)))
...     return list_of_lists
... 
>>> make_n_lists(mygen, (3,), 3)
[[0, 1, 2], [0, 1, 2], [0, 1, 2]] 
```

If you wanted to bind your arguments to your generator and pass that as an argumentless function, you could do this (using a more terse style):

```
>>> def make_n_lists(gen_func, n):
...     return [list(gen_func()) for _ in range(n)]
... 
>>> make_n_lists(lambda: mygen(3), 3)
[[0, 1, 2], [0, 1, 2], [0, 1, 2]] 
```

The `lambda` just defines an anonymous function; the above is identical to this:

```
>>> def call_mygen_with_3():
...     return mygen(3)
... 
>>> make_n_lists(call_mygen_with_3, 3)
[[0, 1, 2], [0, 1, 2], [0, 1, 2]] 
```

# python - 当用户是 ndb.expando 时如何指示所有权

> ID：10290953
> 
> 赞同：0
> 
> 时间：2012-04-24T02:21:48.430
> 
> 标签：python, google-app-engine, python-2.7, webapp2

我有一个创建的非 ndb 实体和一个拥有该对象的 webapp2 用户。是否可以将密钥保留为实例变量？我尝试执行此操作时遇到异常：

```
'Ad' object has no attribute '_values'
Traceback (most recent call last):
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1511, in __call__
    rv = self.handle_exception(request, response, e)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1505, in __call__
    rv = self.router.dispatch(request, response)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1253, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1077, in __call__
    return handler.dispatch()
  File "/base/data/home/apps/s~montaoproject/sessions.358423846858516313/authhandlers.py", line 21, in dispatch
    webapp2.RequestHandler.dispatch(self)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 547, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 545, in dispatch
    return method(*args, **kwargs)
  File "/base/data/home/apps/s~montaoproject/sessions.358423846858516313/main.py", line 3004, in post
    ad.usr = self.current_user.key
  File "/base/data/home/apps/s~montaoproject/sessions.358423846858516313/ndb/model.py", line 1039, in __set__
    self._set_value(entity, value)
  File "/base/data/home/apps/s~montaoproject/sessions.358423846858516313/ndb/model.py", line 801, in _set_value
    self._store_value(entity, value)
  File "/base/data/home/apps/s~montaoproject/sessions.358423846858516313/ndb/model.py", line 785, in _store_value
    entity._values[self._name] = value
AttributeError: 'Ad' object has no attribute '_values' 
```

违规代码

```
if self.current_user:
    logging.info('user:'+str(self.current_user))
    ad.usr = self.current_user.key
    ad.put 
```

模型

```
class Ad(GeoModel, search.SearchableModel):

    primary_image = blobstore.BlobReferenceProperty()
    usr = ndb_model.KeyProperty()
    ... 
```

有没有推荐的方法来做我想做的事情？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T05:01:07.440

NDB 和 db 中的 Key 类型不同。您必须将 NDB Key (self.current_user.key) 转换为 db.Key 实例，如下所示：

```
ad.usr = self.current_user.key.to_old_key() 
```

请参阅[https://developers.google.com/appengine/docs/python/ndb/keyclass#Key_to_old_key](https://developers.google.com/appengine/docs/python/ndb/keyclass#Key_to_old_key)

# model-view-controller - 我的应用程序有多少层？

> ID：10290954
> 
> 赞同：0
> 
> 时间：2012-04-24T02:21:51.190
> 
> 标签：model-view-controller, n-tier-architecture, 3-tier, architectural-patterns

我对不同类型的架构进行了研究，但我仍然不太习惯在 3 层和 4 层之间进行选择。

什么构成了 4 层系统？

我的申请如下：

客户端基于使用 MVC 模式的 iOS iPhone 应用程序。

该服务器也基于使用 MVC 模式的 Ruby on Rails。（如果请求不是来自 iPhone，某些视图会以 HTML 格式呈现）

数据库是 MySQL2 Gem 访问的 MySQL。

客户端和服务器都从 Google 的 API 和其他网络服务访问网络服务。

我的系统架构是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T06:54:56.637

这是服务器端好友的 4 层

*   模型
*   看法
*   控制器
*   数据库 - 带有表格和例程

您是否创建了一个单独的层来处理服务器端的 Web 服务工作，然后是另一个层，您可以自豪地称之为 n 层；只要你的层在某种意义上不会相互干扰，一个层正在做另一层应该做的事情，你就可以开始了。

# java - 是否有与 Java 的“next[type]”扫描器等效的红宝石？具体来说，一个停止照顾该类型的第一个实例的人？

> ID：10290958
> 
> 赞同：2
> 
> 时间：2012-04-24T02:22:20.757
> 
> 标签：java, ruby, file-io, java.util.scanner, equivalent

我正在尝试将我制作的 Java 程序重新编程为 Ruby，以帮助我学习这门语言。但是，我很难找到一种方法来用 Ruby 编写这段特定的 Java 代码部分：

```
/* read the data from the input file and store the weights in the 
array list */
Scanner readFile = new Scanner(new FileReader(inFileName));
ArrayList<Weight> listOfWeights = new ArrayList<Weight>();
while (readFile.hasNext()) {
    int pounds = readFile.nextInt();
    int ounces = readFile.nextInt();
    Weight thisWeight = new Weight(pounds, ounces);
    listOfWeights.add(thisWeight);
} 
```

此代码采用一个文件，该文件在两列中包含整数列表（第一列是磅，第二列是盎司），如下所示：

```
120  2
195 15
200  5
112 11
252  0
140  9 
```

，并使用每行中的数字制作一堆重量对象。然后它将它们添加到列表中。有没有简单的方法在 Ruby 中做到这一点？到目前为止，这是我的 Ruby 程序的样子：

```
begin
  puts "Enter the name of the input file > "
  in_file_name = gets
  puts \n

  list_of_weights = []
  File.open(in_file_name, "r") do |infile|
    while (line = infile.gets) 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:40:38.567

不像你问的那样等价，但由于 ruby​​ 是一种动态语言，我认为没有必要这样想。所以这就是你如何做到的

```
 while (line = infile.gets)
    pounds, ounces = line.split(' ')
    p "-#{pounds}- -#{ounces}-"
  end 
```

输出

```
-120- -2-
-195- -15-
-200- -5-
-112- -11-
-252- -0-
-140- -9- 
```

或者更红宝石的方式（我认为）

```
File.open(in_file_name, "r").each_line do |line|
  pounds, ounces = line.split(' ')
  p "-#{pounds}- -#{ounces}-"
end 
```

# javascript - 如何在网站代码的现有导航之外添加箭头键导航（类似于facebook上的图片导航）

> ID：10290959
> 
> 赞同：0
> 
> 时间：2012-04-24T02:22:32.423
> 
> 标签：javascript, keyboard, navigation

> **可能重复：**
> [jQuery 事件按键：按下了哪个键？](https://stackoverflow.com/questions/302122/jquery-event-keypress-which-key-was-pressed)

我正在尝试将箭头键导航添加到我的网站代码并遇到一些问题。我不认为这可以用 html..maybe javascript 来完成......我对编写代码很陌生，在这里有点迷失，因为我不知道这种类型的导航支持多少。我希望能够滚动浏览我的网站 ( [http://www.williameadon.com](http://www.williameadon.com) ) 中的图片，就像浏览 facebook 和其他博客上的图片一样。我已经有两种导航方式，一种是您只需单击屏幕左侧、右侧的索引图标，另一种是您可以直接单击图像前进。我想拥有所有三个选项以便于使用。我真的很感激帮助。谢谢你。

这是我正在尝试增强的代码示例。

```
<html>

    <title>AWE MAGAZINE - "SHE HAS EYES IN THE BACK OF YOUR HEAD"</title>
    <meta name="keywords" content="art wednesday, Rebecca Dayan, James Penfold, Max Bergius, Annabel Tollman, Sloane Sera, Eric Hauck, Tracy Alfajora, Manny Norena, Zach Vella, Bumble & Bumble, Nars Cosmetics, william eadon"/>

    <body bgcolor="#FFFFFF" alink="#000000" vlink="#000000" link="#000000">
        <table border="0" cellpadding="0" cellspacing="0" width="1095" bgcolor="white" height="0" align="left">
            <tr height="10" bgcolor="#FFFFFF">
                <td bgcolor="#FFFFFF" valign="top" align="left" width="20" height="10">&nbsp;</td>
                <td valign="top" align="left" nowrap bgcolor="#FFFFFF" width="1067" height="10">
                    <p>&nbsp;</p>
                </td>
                <td height="10" bgcolor="#FFFFFF"><font color="#f5f5f5">&nbsp;&nbsp;</font></td>
            </tr>
            <tr valign="top" align="left" height="500" bgcolor="#FFFFFF">
                <td width="20" bgcolor="#FFFFFF" height="500">&nbsp;</td>
                <td valign="top" align="left" width="700" height="500" bgcolor="#FFFFFF">
                    <font color="#000000" face="Times New Roman,Georgia,Times" size="2"><b><a href="http://www.williameadon.com">Index</a> &nbsp;&nbsp; &#60; &nbsp; <a href="awe2.html">&#62;</a> </b></font></p>
                    <p></p>
                    <p></p>
                    <p></p>

                    <p><a href="awe2.html"><img src="awe01.jpg" alt="" width="462" height="693" border="0">

                    </p>
                </td>
            </tr>
            <tr height="50" bgcolor="#FFFFFF">
                <td width="20" bgcolor="#FFFFFF" height="50"></td>
                <td width="1067" height="50" bgcolor="#FFFFFF">
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                </td>
                <td bgcolor="#FFFFFF" height="50">&nbsp;</td>
            </tr>
        </table>
        <p></p>

        <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-12830353-1");
pageTracker._trackPageview();
} catch(err) {}</script>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:38:03.553

一种方法是使用预制的“画廊”插件，例如其中之一： [http ://designmodo.com/jquery-image-sliders/](http://designmodo.com/jquery-image-sliders/)

或者，如果你想使用你所拥有的，只听按键，你可以使用 jQuery：http: [//jquery.com/](http://jquery.com/)

然后执行以下操作：

```
$(function() {
    $("body").keyup(function(ev) {
        if (ev.which==37) $(".left-link").click();
        if (ev.which==39) $(".right-link").click();
    });
}); 
```

这是假设你有这样的事情：

```
<a href="awe2.html" class="right-link"><img src="next.jpg"></a> 
```

解释：它监听按键，并检查按下按钮的“代码”；37是左箭头键，39是右箭头键。如果是其中之一，它会模拟相应链接上的“点击”。

# android - 将值从片段传递到另一个活动

> ID：10290963
> 
> 赞同：0
> 
> 时间：2012-04-24T02:22:55.280
> 
> 标签：android, android-intent

我有一个在对话框中显示列表的框架。在对话框中，我有一个 clickListener 打开一个 Activity。这个Activity不是FragmentActivity。

当我尝试获取此值时，他为空。帮助...

我的片段课

```
package br.com.test.fragments;

import java.util.List;

import android.app.Dialog;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.Toast;
import br.com.test.controllers.CorredoresController;
import br.com.test.R;
import br.com.test.SPAndroidConstantes;
import br.com.test.activity.ListaCorredoresActivity;
import br.com.test.adapter.ListaCorredoresAdapter;
import br.com.test.util.Utilities;
import br.com.spparser.beans.corredores.NomeCorredor;
import br.com.spparser.exception.SPException;

public class PesquisaFragment extends Fragment implements SPAndroidConstantes,     OnItemClickListener {

private ProgressDialog dialog;
private Handler handler = new Handler();
List<NomeCorredor> p;
private Exception ex;
private ListaCorredoresAdapter lcAdapter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //fillAdMod();
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstance)
{
    LinearLayout linearLayout = (LinearLayout) inflater.inflate(R.layout.pesquisa, container, false);
    EditText edit = (EditText) linearLayout.findViewById(R.id.editPesquisa);
    Button btnLinhas = (Button) linearLayout.findViewById(R.id.btnLinhas);
    Button btnPontos = (Button) linearLayout.findViewById(R.id.btnPontos);

    Button btnCorredor = (Button)linearLayout.findViewById(R.id.btnCorredores);
    btnCorredor.setOnClickListener(buttonCorredorListener);

    return linearLayout;
}

private void downloadInfo() {
    new Thread() {
        @Override
        public void run() {
            try {
                p = CorredoresController.getInstance().getCorredores();
                atualizaTela();
            } catch (Exception e) {
                ex = e;
                atualizaTelaExcecao();
            }
        }
    }.start();
}

/**
 * Thread para fechar dialog e apresentar informações
 */
private void atualizaTela() {
    handler.post(new Runnable() {
        @Override
        public void run() {
            dialog.dismiss();
            preencheTela();
        }
    });
}

/**
 * Thread para fechar dialog e apresentar exceção
 */
private void atualizaTelaExcecao() {
    handler.post(new Runnable() {
        @Override
        public void run() {
            dialog.dismiss();
            preencheTelaExcecao();
        }
    });
}

/**
 * Preenche informações da tela
 */
private void preencheTela() {
    // Criando e setando o adaptador personalizado para Lista 1
    lcAdapter = new ListaCorredoresAdapter(this.getActivity(),
            p);

    if (p.size() == 0) {
        Toast.makeText(PesquisaFragment.this.getActivity(), MSG_SEM_CORREDOR,
                MSG_TIME_MILIS).show();
        //this.getActivity().finish();
    }

    Dialog dialogCorredor = new Dialog(PesquisaFragment.this.getActivity());
    dialogCorredor.setTitle("Selecione o corredor");
    LayoutInflater li = (LayoutInflater) PesquisaFragment.this.getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View v = li.inflate(R.layout.teste_list, null, false);
    ListView lista = (ListView) v.findViewById(R.id.listTeste);
    lista.setAdapter(lcAdapter);
    dialogCorredor.setContentView(v);
    dialogCorredor.setCancelable(true);
    dialogCorredor.show();

    lista.setOnItemClickListener(this);
}

/**
 * Apresenta mensagem em caso de exceção
 */
private void preencheTelaExcecao() {
    if (ex instanceof SPException) {
        Toast.makeText(PesquisaFragment.this.getActivity(),
                ((SPException) ex).getMessage(), MSG_TIME_MILIS).show();
        //PesquisaFragment.this.getActivity().finish();
    } else {
        Toast.makeText(PesquisaFragment.this.getActivity(),
                getString(R.string.msg_ErroSistema), MSG_TIME_MILIS).show();
        //PesquisaFragment.this.getActivity().finish();
    }
}

private OnClickListener buttonCorredorListener = new OnClickListener() {

    @Override
    public void onClick(View arg0) {
        dialog = ProgressDialog.show(PesquisaFragment.this.getActivity(), "",
                "Aguarde...", true);
        if (!Utilities.chkStatus(PesquisaFragment.this.getActivity()))
            return;

        downloadInfo();
    }
};

@Override
public void onItemClick(AdapterView parent, View v, int position, long id) {
    if (!Utilities.chkStatus(PesquisaFragment.this.getActivity()))
        return;
    NomeCorredor corredor = (NomeCorredor) parent.getAdapter().getItem(position);

    Bundle bundle = new Bundle();
    bundle.putInt("Cod", corredor.getCodigoCorredor());
    bundle.putString("Desc", corredor.getNomeCorredor());

    Intent listaCorreIntent = new Intent(PesquisaFragment.this.getActivity(), ListaCorredoresActivity.class);
    listaCorreIntent.putExtras(bundle);
    startActivity(listaCorreIntent);
}

} 
```

我的活动课

```
package br.com.test.activity;

import br.com.test.R;
import android.app.Activity;
import android.os.Bundle;
import android.widget.Toast;

public class ListaCorredoresActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.item_corredor);
    String texto = String.valueOf(savedInstanceState.getInt("Cod")) + " - " + savedInstanceState.getString("Desc");
    Toast.makeText(this, texto, Toast.LENGTH_LONG);
} 
```

当我尝试获取 savedInstanceState.getInt("Cod") 他来 null

为什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:02:32.593

Bundle 通常用于在各种活动之间传递数据。这取决于您要传递什么类型的值，但 bundle 可以保存所有类型的值并传递给新活动。您还可以找到有关[android-using-bundle-for-sharing-variables](http://miragemiko.wordpress.com/2010/03/20/android-using-bundle-for-sharing-variables/)和[Passing-Bundles-Around-Activities 的更多信息](http://www.remwebdevelopment.com/dev/a33/Passing-Bundles-Around-Activities.html)

```
String texto = String.valueOf(savedInstanceState.getInt("Cod")) + " - " + savedInstanceState.getString("Desc"); 
```

用这一行替换上面的行

```
 Bundle extras = intent.getExtras();
 String texto  = extras.getInt("Cod")+"-"+extras.getString("Desc"); 
```

# android - 安卓jar目录

> ID：10290970
> 
> 赞同：2
> 
> 时间：2012-04-24T02:24:01.690
> 
> 标签：android, netbeans

我不断收到引用 jsoup 的 NoClassDefFoundError。我在 libs 目录中有 jar，但在 Android Manifest 文件中没有引用我的 jar 文件。这可能是问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:31:58.823

jsoup 是外部 jar 对吗？你有没有把这个 jar 添加到你的项目中？选择构建路径->配置构建路径->选择库选项卡->添加外部 Jars。你把 jsoup 放在 libs 目录中，它仍然没有链接到你的项目，直到你将其添加为外部 jar。对不起，如果我误解了您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T02:45:47.207

要在您的 android 项目中添加外部 jar，请参阅使用这些帖子：

[在 Netbeans 中将外部 JAR 添加到 Android 项目](http://www.jondev.net/articles/Adding_external_JARs_to_Android_Projects_in_Netbeans_%28nbandroid_-_kenai%29)

[android：将外部 JAR 文件添加到 android](http://android:%20Adding%20external%20JAR%20file%20in%20to%20android)

如在[这篇](https://stackoverflow.com/questions/2057804/how-can-i-use-an-external-jar-in-an-android-project-in-netbeans)文章中：到目前为止我采取的步骤是：

1）创建库项目，包含android.jar以访问Android类（该库使用android.util.Log和其他Android类）。

2）将库编译为jar。

3）将库的jar添加到Android应用程序中（右键单击项目节点下的Libraries并添加jar）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T02:46:38.513

正如乔恩西蒙在[这篇博文中所写：](http://www.jondev.net/articles/Adding_external_JARs_to_Android_Projects_in_Netbeans_%28nbandroid_-_kenai%29)

> 我注意到 NBAndroid Netbeans 插件的一个非常烦人的问题是，它不知道如何正确地将外部 JAR 文件附加到 Android 项目。如果您右键单击库（在您的项目文件夹下），然后单击“添加 JAR/文件夹”，它将添加对该库/JAR 文件的引用，它将在代码中识别（检测所有类等） ）。问题出在您尝试编译项目时——此时，它实际上并没有将 JAR 添加到项目中，这反过来又会在运行时给您带来错误。
> 
> 实际上，我花了很长时间才找到解决方案，而且很烦人。为了更正此问题，您必须打开 build.xml 文件（位于项目文件夹下，但隐藏在 netbeans 环境中）。我必须打开我的文件资源管理器（我的 mac 上的 Finder :-)），然后转到项目文件夹并从那里打开它。在您的导入文件标签下添加以下位：
> 
> ```
> <target name="-pre-jar"> 
>   <copy todir="${build.classes.dir}"> 
>     <fileset dir="/path/to/your/jar/directory" /> 
>   </copy> 
> </target> 
> ```
> 
> 因此，如果您的 JAR 在 /home/bla/myjars/lala.jar 中，那么您的路径应该是“/home/bla/myjars”。
> 
> 现在，尝试重新编译它，它应该可以正常工作。

# java - 一个简单的用于 MS word 文件的 java 加密/解密应用程序

> ID：10290975
> 
> 赞同：0
> 
> 时间：2012-04-24T02:24:25.963
> 
> 标签：java, eclipse, swing, encryption, aes

我正在努力为这个小项目进行设置。我无法找到执行以下操作的确切工具和设置。我对java有点陌生。请给我一些建议

创建一个简单的 java 应用程序，您只需在应用程序中选择一个文件文件，然后加密/解密文件（MS 字）。

我计划将 AES 算法用于上述目的。目前我的设置如下

1.  操作系统 - Windows 7
2.  IDE - Eclipse 靛蓝
3.  已安装 Java
4.  出于 GUI 目的，我计划使用 java swing
5.  对于 AES 加密，我不知道 java 中有哪个库

任何人都可以帮助我为 java swing GUI 设计器和 AES 加密库选择一些最好的工具，我可以添加到 eclipse 中。我知道如何为 Eclipse 添加插件。但我不知道如何将外部库添加到 Eclipse。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:35:24.310

对于加密，您可以通过[JCE/JCA](http://docs.oracle.com/javase/7/docs/technotes/guides/security/crypto/CryptoSpec.html)接口使用[BouncyCastle](http://www.bouncycastle.org/java.html)库。

# filter - 如何制作破坏性过滤器！在计划中？

> ID：10290977
> 
> 赞同：1
> 
> 时间：2012-04-24T02:25:03.873
> 
> 标签：filter, scheme, reverse

我可以让过滤器工作，但它不会破坏性地做到这一点。以下是起始代码和测试用例：

```
(define (filter! f s)
;;Your solution 
```

测试用例：

```
(define (big x) (> x 5))

(define ints (list 1 10 3 8 4 7)) 
(define ints1 (cdr ints))

(define filtered-ints (filter! big ints))  
filtered-ints 
; expect (10 8 7) 

(eq? filtered-ints ints1) ; expect #t 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:54:54.523

这应该有效：

```
(define (filter! f lst)
  (let loop ((ans lst))
    (cond ((null? ans)
           ans)
          ((not (f (car ans)))
           (loop (cdr ans)))
          (else
           (scan-in f ans (cdr ans))
           ans))))

(define (scan-in f prev lst)
  (if (pair? lst)
    (if (f (car lst))
        (scan-in  f lst  (cdr lst))
        (scan-out f prev (cdr lst)))))

(define (scan-out f prev lst)
  (let loop ((lst lst))
    (if (pair? lst)
        (if (f (car lst))
            (begin (set-cdr! prev lst)
                   (scan-in  f lst (cdr lst)))
            (loop (cdr lst)))
        (set-cdr! prev lst)))) 
```

[`filter!`](http://srfi.schemers.org/srfi-1/srfi-1.html#filter!)我从SRFI 1: List Library 中的过程改编了上述内容。请注意，如果您使用的是 Racket，则需要修改一两件事以使上述代码正常工作。例如，Racket 不再支持`set-cdr!`，您必须使用它`set-mcdr!`。

# gwt - 根据模块属性使用不同的 UiBinder @UiTemplate 文件

> ID：10290978
> 
> 赞同：2
> 
> 时间：2012-04-24T02:25:14.370
> 
> 标签：gwt, uibinder

我可以`<replace-with>`根据 GWT 模块文件中设置的属性使用标签来换出类的不同实现。太好了——我喜欢它。

但是：我的观点`formfactor="mobile"`和`formfactor="desktop"`我使用的 ui.xml 文件之间的所有不同之处 - 甚至 java 文件都是相同的。所以，类交换是不够的——我不想复制 Java 文件来获得不同的类。

如何使用属性来影响作为 UiBinder 模板加载的 ui.xml 文件？

**注意**：我目前正在使用一种解决方法来计算 Java 中的模块属性*应该*是什么，并在加载适当的 ui.xml 文件的 switch 语句中使用该属性。这是不可取的，因为：

*   代码重复 - 我必须计算模块文件和 java 代码中的属性
*   每个排列都必须编译每个 ui.xml 文件，以便在运行时选择正确的文件。我更喜欢编译时解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T18:33:18.247

我认为，您必须编写自己的[生成器](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsDeferred#generator-implementation)，它将为不同的 ui 活页夹模板提供服务。可能您可以[在 UiBinderGenerator 中重载方法 deduceTemplateFile()](http://code.google.com/p/google-web-toolkit/source/browse/trunk/user/src/com/google/gwt/uibinder/rebind/UiBinderGenerator.java?r=10717#61)。

# apache - 使用 apache mod_rewrite 的方向

> ID：10290979
> 
> 赞同：0
> 
> 时间：2012-04-24T02:25:16.620
> 
> 标签：apache, .htaccess, mod-rewrite

我不太擅长使用 mod_rewrite 或正则表达式，但我最终需要对要移动的站点使用 301 重定向。旧址的结构是这样的

[http://www.mywebsite.com/FF_Supersneaker_Black_Metallica_p/155-157.htm](http://www.mywebsite.com/FF_Supersneaker_Black_Metallica_p/155-157.htm)

同一产品的新网站也是如此

[https://www.mywebsite.com/FF_Supersneaker_Black_Metallica_p.html](https://www.mywebsite.com/FF_Supersneaker_Black_Metallica_p.html)

我需要做的是提取并删除“/ 155-157”并将扩展名更改为.html而不是.htm

所以逻辑上我想我需要找到最后一次出现的“/”和最后一次出现的“。” 并将其间所有内容的值更改为“”。那么文件扩展名的更改在互联网上无处不在，但我不知道如何将其与其余部分合并。

**编辑：** 这是我的 .htaccess 文件：

```
<IfModule mod_rewrite.c>  
RewriteEngine On    
RewriteRule /(.*)/(.*)/[^/]*.htm$ /$1$2.html
</IfModule> 
```

当我尝试使用它时，这是我的重写日志中的相关条目。（我只是更改了ip和域名。我使用tail并复制了我尝试进入页面时弹出的条目。

```
255.255.255.255 - - [25/Apr/2012:11:57:24 --0400] [www.mywebsite.com/sid#9b25ed8][rid#9e3cc48/initial] (1) [perdir /var/www/test/] pass through /var/www/test/FF_Supersneaker_Black_Metallica_p/155-157.htm 
```

我添加了额外的 /(.*) 因为我的测试页面上有一个额外的目录。其结构是 [http://www.mywebsite.com/test/FF_Supersneaker_Black_Metallica_p/155-157.htm](http://www.mywebsite.com/test/FF_Supersneaker_Black_Metallica_p/155-157.htm) 重定向到 [http://www.mywebsite.com/test/FF_Supersneaker_Black_Metallica_p.html](http://www.mywebsite.com/test/FF_Supersneaker_Black_Metallica_p.html)

抱歉问了这么多问题，您也只能启用重写日志购买进入 apache.conf 或 httpd.conf 文件并重新启动服务器，对吗？如果是这种情况，那么我没有权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:41:28.247

您在这里所做的只是剥离最后一个路径组件，然后添加“.html”。所以也许是这样的：

```
RewriteRule /(.*)/[^/]*.htm$ /$1.html 
```

该序列`[^/]`表示“任何不是 a 的字符`/`”，并且`*`表示“前一个模式 0 次或更多次”，因此`[^/]*.htm`匹配字符串末尾的任何非`/`字符`.htm`字符串。我们丢弃这些，使用其他所有内容，然后添加`.html`.

[URL 重写指南](http://httpd.apache.org/docs/2.2/rewrite/)有很多信息和示例。

# python - Python XML 绑定

> ID：10290981
> 
> 赞同：1
> 
> 时间：2012-04-24T02:25:34.357
> 
> 标签：python, xml, binding

我正在为 Python 中的 EmotionML（W3C 用于机器表示情绪的语言）设计一个参考实现，我想要一些关于 XML 绑定的数据类型的设计建议（我想你可以说我正在众包一些设计理念）。

我想对可能已经做过类似的人的一些设计和代码提出建议和指示。我的倾向是只使用我熟悉的 Java 路径来创建与 XML 结构相对应的对象并将它们翻译成 DOM。

OO 给了我多态性，但创建了一个更复杂的对象结构，其中 Python 非常擅长集合表示和内置集合的使用。

我正在寻找可能更优雅的方法。我可以定义自己的非对象结构并询问这些结构并转换为 DOM 吗？

我将如何使用列表和字典来表示可选的、强制的属性、元素？

这些都是我的设计思路和困境，并不是说求救。

我可以自己解决这些问题，所以我真的在向经验丰富的 Python 设计人员和开发人员征求成熟、仁慈的建议。

在此先感谢，埃德蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T11:59:29.027

或者，您可以使用[generateDS.py](http://cutter.rexx.com/~dkuhlman/generateds_tutorial.html)，它的目的是成为 Python 的 XML 绑定器。给定一个方案定义，它会在 python 中自动生成数据类，并生成 xml 导出/导入方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T03:52:06.270

与 Java 或 C# 相比，数据绑定在 Python 世界中并不常见。我认为这是因为 Python 有很多更好的 XML API 正在使用，而不是可怕的怪物 DOM。

调查这些 API 以查看它们是否满足您的需求：

*   ElementTree（在标准库和[lxml](http://lxml.de/)中找到）
*   Objectify（在 lxml、[Amara](http://wiki.xml3k.org/Amara)、[4Suite](http://sourceforge.net/projects/foursuite/)和[Gnosis utils](http://freecode.com/projects/gnosisxml)中找到）。

# c# - 将列表框中的字符串转换为单独的文本字段

> ID：10290983
> 
> 赞同：1
> 
> 时间：2012-04-24T02:25:50.083
> 
> 标签：c#, winforms

我正在构建一个程序，该程序允许我通过从一组旅行中选择数据来提取数据，并将所有找到的项目作为该旅行的一部分填充到列表框中。当我从列表框中选择一个项目时，我希望它填充一系列允许我编辑每个字段的文本框。

这是我的问题代码在表单中的位置（tripChoose 是组合框，listExpenses 是列表框）：

```
private void tripChoose_SelectedIndexChanged(object sender, EventArgs e)
{
    IEnumerable<TripExpense> selectedExpenses = roster.ToFind((string)tripChoose.SelectedItem);
    foreach (TripExpense item in selectedExpenses)
        listExpenses.Items.Add(item);
}

private void listExpenses_SelectedIndexChanged(object sender, EventArgs e)
{
    specificExpenses = (TripExpense)roster.TripFind((string)listExpenses.SelectedItem);
    tripTextBox.Text = specificExpenses.Trip;
    tripTextBox.Enabled = false;
    descriptionTextBox.Text = specificExpenses.Description;
    amountTextBox.Text = specificExpenses.Amount.ToString();
    paymentMethodTextBox.Text = specificExpenses.PaymentMethod;
    dateExpenseTimePicker.Value = specificExpenses.Date;
    dateExpenseTimePicker.Enabled = true;
    noteTextBox.Text = specificExpenses.Note;
} 
```

JIT 调试器让我知道我将对象隐式转换为字符串

我试过使用这样的 ToString 方法：

```
private void tripChoose_SelectedIndexChanged(object sender, EventArgs e)
{
    IEnumerable<TripExpense> selectedExpenses = roster.ToFind((string)tripChoose.SelectedItem);
    foreach (TripExpense item in selectedExpenses)
    listExpenses.Items.Add(item.ToString());
} 
```

我认为我在正确的轨道上，因为我收到一个错误，告诉我对象引用未设置为对象的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:09:55.890

我相信问题是`ToString()`在`TripExpense`. 当您使用其中的字符串并将其输入时，`FindTrip`它再也找不到它了。

您可以做的是拥有组合项目的原始设置并`SelectedIndexChanged`修改

```
private void tripChoose_SelectedIndexChanged(object sender, EventArgs e)
{
    IEnumerable<TripExpense> selectedExpenses = roster.ToFind((string)tripChoose.SelectedItem);
    foreach (TripExpense item in selectedExpenses)
        listExpenses.Items.Add(item);
}

private void listExpenses_SelectedIndexChanged(object sender, EventArgs e)
{
    specificExpenses = (TripExpense)listExpenses.SelectedItem;
    ... 
} 
```

这样，ComboBox 文本仍将获取对象的`ToString()`，`TripExpense`但您仍然可以从 中获取实际对象`SelectedItem`以进行使用，而不是尝试重新查询该对象。

# c# - .Max() 与 OrderByDescending().First()

> ID：10290986
> 
> 赞同：13
> 
> 时间：2012-04-24T02:26:04.033
> 
> 标签：c#, linq, compiler-optimization

这纯粹是为了我自己的知识，如果我要编写我会使用的代码`.Max()`。

起初认为`.Max()`只需要一次通过`numbers`即可找到最大值，而第二种方法必须对整个可枚举事物进行排序，然后找到第一个。所以它是`O(n)`vs `O(n lg n)`。但后来我在想，也许它知道它只需要最高的，然后抓住它。

**问题：** LINQ 和/或编译器是否足够聪明，可以发现它不需要对整个可枚举项进行排序并将代码归结为与 .Max() 基本相同？有没有可量化的方法来找出答案？

```
IEnumerable<int> numbers = Enumerable.Range(1, 1000);

int max  = numbers.Max();
int max2 = numbers.OrderByDescending(x => x).First(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T02:34:44.023

*LINQ 和/或编译器是否足够聪明，可以发现它不需要对整个可枚举进行排序并将代码归结为与 .Max() 基本相同？*

不。

*有没有可量化的方法来找出答案？*

秒表的简单基准测试：

```
 var numbers = Enumerable.Range(1, 10000000);
    var sw = Stopwatch.StartNew();
    int max = numbers.Max();
    Console.WriteLine(sw.ElapsedMilliseconds);
    sw.Restart();
    int max2 = numbers.OrderByDescending(x => x).First();
    Console.WriteLine(sw.ElapsedMilliseconds); 
```

最大（）：70毫秒

OrderBy() : 2066 毫秒

此外，如果您将计数增加太多，OrderBy() 会失败并出现 OutOfMemoryException，Max() 不会。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-24T02:29:20.380

`.Max()`是 O(n)，而您的`OrderByDescending`解决方案不是 - 根据排序，它可能是 O(nlog(n))。

我显然没有在编译器内部挖掘知道，但是你所要求的（实现排序然后只抓取一个项目的优化与.max 相同）来自编译器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-24T02:29:41.537

如果您正在谈论直接 LINQ to Objects，那么不，它不会为此进行优化。

据推测，另一个 LINQ 提供程序可以做到，但这取决于实现的细节。

对于 Enumerable，Reflector 给我的实现是：

```
public static IOrderedEnumerable<TSource> OrderBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector)
{
    return new OrderedEnumerable<TSource, TKey>(source, keySelector, null, false);
} 
```

并且对于`First()`

```
public static TSource First<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    IList<TSource> list = source as IList<TSource>;
    if (list != null)
    {
        if (list.Count > 0)
        {
            return list[0];
        }
    }
    else
    {
        using (IEnumerator<TSource> enumerator = source.GetEnumerator())
        {
            if (enumerator.MoveNext())
            {
                return enumerator.Current;
            }
        }
    }
    throw Error.NoElements();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-12-05T09:44:40.683

看来 OrderedEnumerable 现在足够聪明，可以确定它不需要对 First 和 Last() 的列表进行排序。

请注意第 223 行附近的代码 TryGetFirst() [https://github.com/dotnet/corefx/blob/ed0ee133ac49cee86f10ca4692b1d72e337bc012/src/System.Linq/src/System/Linq/OrderedEnumerable.cs](https://github.com/dotnet/corefx/blob/ed0ee133ac49cee86f10ca4692b1d72e337bc012/src/System.Linq/src/System/Linq/OrderedEnumerable.cs)

# python - 子进程 Popen 不适用于 pythonw.exe

> ID：10290990
> 
> 赞同：12
> 
> 时间：2012-04-24T02:26:47.167
> 
> 标签：python, subprocess

当我使用 pythonw.exe 在 Windows 上运行以下脚本时，我希望能够获取 stdout 和 stderr 的内容：

```
import subprocess
import sys
import os
import string
import time

tmpdir = 'c:/temp'
cmd = 'dir c:'

tmpfile = "tmp_%f" % (time.time())
tmpfile = os.path.normpath(os.path.join(tmpdir,tmpfile))
tmpfile2 = tmpfile+".bat"
tmpfile3 = tmpfile+".txt"

fa = open(tmpfile2,'w')
fa.write("@ECHO OFF > NUL\n")
fa.write('call '+cmd+"\n")
fa.close()

wcmd = []
wcmd.append(tmpfile2)

startupinfo = subprocess.STARTUPINFO()
startupinfo.dwFlags |= subprocess._subprocess.STARTF_USESHOWWINDOW

fb = open(tmpfile3,'w')
fb.write("\n")
fb.write(tmpfile2+"\n")

try:
    procval = subprocess.Popen(wcmd, startupinfo=startupinfo, stdout=subprocess.PIPE, stderr=subprocess.STDOUT).communicate()
    fb.write(str(procval)+"\n")
    fb.write("Sucess")
    fb.close()
except:
    fb.write(str(procval)+"\n")
    fb.write("Failure")
    fb.close() 
```

当我使用 python.exe 执行它时，我得到了预期的输出。当我使用 pythonw.exe 运行它时，我最终会出现异常。如果我只使用命令和 startupinfo 标志运行 popen，则命令将成功完成，但无法访问子进程中的数据。我读到的所有内容都表明这应该有效，但必须遗漏一些东西。任何帮助将不胜感激。

谢谢，兰迪

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-26T17:51:45.900

这可能是使用 pythonw.exe 时的错误

pythonw.exe 启动一个不能正常访问标准文件描述符的守护进程。您在脚本中唯一需要做的就是专门为 stdin 设置第 3 个 fd：

```
p = subprocess.Popen(wcmd,
                     startupinfo=startupinfo,
                     stdout=subprocess.PIPE,
                     stderr=subprocess.STDOUT,
                     stdin=subprocess.PIPE)
procval = p.communicate() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-10T23:43:24.640

（这个答案晚了几年......）我遇到了同样的问题，发现你应该替换这个：

> 标准输出=子进程.PIPE

有了这个：

> 标准输入=子进程.PIPE

这是我对潜在问题的猜测：pythonw 启动没有标准输入的进程（有道理，因为没有控制台）。子进程尝试访问标准输入，这会导致错误。

另一种方法是将 /dev/null 用于标准输入，有关如何执行此操作的讨论，请参见此线程：[忽略 subprocess.Popen 的输出](https://stackoverflow.com/questions/14735001/ignoring-output-from-subprocess-popen)（除非您希望在标准输入上使用 devnull）。

# llvm - LLVM 和 Clang 中的优化级别

> ID：10290993
> 
> 赞同：11
> 
> 时间：2012-04-24T02:26:55.543
> 
> 标签：llvm, clang, llvm-gcc

我正在开发一个使用 LLVM 2.6 和 llvm-gcc 前端编译的项目。我正在尝试使用 LLVM 3.1 和 clang 测试编译它。当我这样做时，我收到以下关于 -O5 优化级别的错误消息：

```
error: invalid value '5' in '-O5' 
```

但是，LLVM 2.6 和 llvm-gcc 可以正常使用该`-O5`标志。我看到了有关 Clang 优化级别的以下文档：

```
-O0 -O1 -O2 -Os -O3 -O4
       Specify which optimization level to use.  -O0 means "no optimization": this level compiles the
       fastest and generates the most debuggable code.  -O2 is a moderate level of optimization which
       enables most optimizations.  -Os is like -O2 with extra optimizations to reduce code size.  -O3
       is like -O2, except that it enables optimizations that take longer to perform or that may
       generate larger code (in an attempt to make the program run faster).  On supported platforms, -O4
       enables link-time optimization; object files are stored in the LLVM bitcode file format and whole
       program optimization is done at link time. -O1 is somewhere between -O0 and -O2. 
```

所以我试图弄清楚`-O5`我正在使用的 Makefile 中首先在做什么（我没有编写 Makefile）。这是改变并曾经与 LLVM 一起使用的东西吗？或者它仍然是一个有用的功能，我只需要以其他方式激活它。

另外，如果它有用，我正在运行的给出错误的命令基本上是：

```
/bin/clang -g -c -mcmodel=medium -fstrict-aliasing -Wstrict-aliasing -O5 -emit-llvm -fkeep-inline-functions -fno-stack-protector -c -o foo.bc foo.cpp 
```

另外，如果我在 Linux (Ubuntu 10.04) x86_64 系统上运行很重要。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T21:23:46.590

Gcc 将任何`-On`n >= 4[视为`-O3`](http://www.mailinglistarchive.com/gcc-help@gcc.gnu.org/msg06116.html)：

> -O 标志将接受 0 到 9 之间的任何数字，但只实现了 0 到 3，而且我认为没有人计划在短期内实现 4 到 9。人们使用这个 -O9 习惯用法的事实有点令人不安，因为这意味着他们想要 gcc 可能提供的所有可能的优化，即使它使编译需要数周时间而没有任何收获。

不应该使用更大的级别，你只有低质量的 Makefile。

> 所以指定 -O9 有点“但是这个到 11 点！”类型的废话

因此，当使用 gcc 编译器时，您有 -O: 的有效变体`-O0, -O1, -O2, -O3`。但是驱动程序会默默地将任何 -On 转换为 -O3。

LLVM（clang 和 llvm-gcc 驱动程序变体）仅支持最高级别`-O4`（`-O4`与 相同`-O3 -flto`）。所以你不应该在没有测试的情况下使用 -O4 ，因为 lto 速度较慢并且可能会破坏你的程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:14:52.680

llvm-gcc 没有将其识别为错误但 clang 识别为错误可能是 Makefile 中的错误。

# cassandra - 清理操作是否会删除过期的列？

> ID：10290995
> 
> 赞同：2
> 
> 时间：2012-04-24T02:27:41.833
> 
> 标签：cassandra

我知道 nodetool scrub 删除了超过 gc_grace 秒的墓碑。

我很好奇：当遇到具有过期 TTL 的数据时，nodetool 擦洗是否也会删除或插入墓碑？如果是这样，与主要压缩相比，进行清理似乎是删除过期数据的更有效方法。

# scala - 用状态拉皮条我的图书馆

> ID：10290996
> 
> 赞同：2
> 
> 时间：2012-04-24T02:28:00.237
> 
> 标签：scala

我希望能够将 pimp-my-library 模式应用于状态，而不是行为。具体来说，如果你在隐式 def 中定义了一个 var，设置它，然后尝试读取它，状态就会丢失。我整理了一个人为的例子：

```
class Planet(val name: String)

object SolarSystem {
  val Mercury = new Planet("Mercury")
  val Venus = new Planet("Venus")
  val Earth = new Planet("Earth")
  val Mars = new Planet("Mars")
  val Jupiter = new Planet("Jupiter")
  val Saturn = new Planet("Saturn")
  val Uranus = new Planet("Uranus")
  val Neptune = new Planet("Neptune")
  val Pluto = new Planet("Pluto")
}

object Pimper {
  implicit def pimpPlanet(planet: Planet) = {
    new {
      var distanceFromSun: Int = 0
    }
  }

  import SolarSystem._

  Jupiter.distanceFromSun = 5 // AU
}

object Main {
  def main(args: Array[String]) {
    import SolarSystem._
    import Pimper._

    println(Jupiter.distanceFromSun)
  }
} 
```

自然，这将打印 0，但我希望它打印 5。我考虑了一些解决方案，包括扩展 SolarSystem 和覆盖 Jupiter 是什么，或者在外部有一个由 getter & setter 填充/读取的地图。

我对 Scala 很陌生，我希望有一种更优雅的方式来做这样的事情。也是的，冥王星是一颗行星:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T02:58:19.880

```
object Pimper { 

  var planets = Map.empty[Planet, EnhancedPlanet]
  class EnhancedPlanet(var distance: Int)

  implicit def pimpPlanet(planet: Planet) = planets.get(planet).getOrElse {
    planets += planet -> new EnhancedPlanet(0)
    planets(planet)
  }

}

object Main {
  def main(args: Array[String]) {
    import SolarSystem._
    import Pimper._

    println(Jupiter.distance) //0
    Jupiter.distance = 5
    println(Jupiter.distance) //5
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T02:54:47.597

使其成为`val`您拥有的星球上的模式匹配：

```
implicit def pimpPlanet(planet: Planet) = {
  new {
    var distanceFromSun: Int = planet match {
      case Planet("Earth") => 1
      case Planet("Jupiter") => 5
    }
  }
} 
```

等等

# c# - C# Try-Catch 和异常处理

> ID：10290997
> 
> 赞同：0
> 
> 时间：2012-04-24T02:28:01.213
> 
> 标签：c#, asp.net, .net, exception-handling, try-catch

在当前项目的各个代码部分中，经常使用

```
try
{
    //code
}
catch(Exception e)
{
    //display nicely formatted error message
} 
```

我的问题是，假设代码处理所有已知/假定的错误（例如检查对象是否为空等），是否应该在以应用程序全局格式显示错误的代码周围放置一个 try-catch？

还是让错误引发异常并让应用程序自然崩溃是更好的做法？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T02:39:58.527

像这样捕获所有异常*不是*一个好习惯，除非在应用程序的顶层，您会在其中显示一个很好的错误消息。做得对，它可以保持最终用户对您的程序的看法，即*稍微有*问题，但总体上是合理的。相比之下，让您的应用程序崩溃是让您的最终用户相信您的应用程序已经无法修复的最简单方法。

就异常预防而言，主要有两种异常——编程错误（空指针、类转换、超出范围等）和环境错误（找不到文件、网络路径不可用、用户输入错误等）。 ) 你可以而且应该避免第一种，并准备好处理第二种。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T02:37:35.237

```
class PerformTask
{
    public void ConnectToDB(requiredParams)
    {

    }
}

class PerformTaskConsumer
{
   public void SomeMethod()
   {
      try
      {
         PerformTask obj = new PerformTask();
      }

      catch(RelaventExceptions)
      {

      }
   } 

} 
```

如果可以，请避免异常。如果发生异常，将它留给调用者他想对异常做什么。调用者可能决定显示有关异常的格式正确的消息，或者决定崩溃或其他任何情况。

Eric Lippert 有一篇关于异常的好文章。[这里](http://blogs.msdn.com/b/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T03:11:29.453

这里有两种截然不同的思想流派，两者的支持者常常对任何人都可能相信另一种方式感到震惊和惊讶。最后，这是一个偏好问题，以及您的目标用户群期望和/或愿意接受什么，更重要的是，您对应用程序功能的了解程度如何。（您的问题意味着您没有编写所有涉及的代码，因此最后一点可能比您想象的要棘手。）

首先，我假设您在这里谈论的是最终用户应用程序，而不是类库。几乎没有充分的理由在您没有明确处理的类库中捕获异常。你总是把决定权留给来电者。

但是，在最终用户应用程序中，最终决定权在您手中，因为调用链上没有任何人。在这种情况下，您有两个广泛的选择：

### 快速失败

有些人认为，当遇到错误时，最好让应用程序在物理上尽快崩溃。虽然这似乎有点适得其反，但请记住遇到未处理的异常意味着什么：您实际上*不知道出*了什么问题；甚至像您的错误记录代码这样简单的事情也可能以您不期望的方式运行。

如果您在调用站点正确处理异常，则只有在发生非常非常糟糕的事情时才会收到这种“意外”错误：内存不足、堆栈损坏等。那种你无法真正恢复的事情，无论如何，所以尝试没有意义。

### 优雅地失败

其他人认为您应该尽可能地隔离错误，以防止您的用户丢失信息。如果您的应用程序足够模块化，那么一个区域的完全故障可能对另一个区域的数据完全没有影响。

这是一个风险更大的提议：您必须非常小心，不要让自己处于不一致的状态。它要求您确定地知道，失败代码中的任何内容都不会从代码的其他部分改变状态。

### 综上所述

像往常一样，“正确”的答案可能在中间的某个地方。一般来说，在不一致的状态下运行的风险几乎总是让应用程序死掉的好理由。当然，您可能仍希望在此处进行某种程度的日志记录，您可以通过多种方式完成。我的偏好不是为此使用异常，而是挂钩到顶层的各种“未处理异常”事件，例如[this](http://msdn.microsoft.com/en-us/library/system.windows.application.dispatcherunhandledexception.aspx)、[this](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)或[this](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)。在这些事件处理程序中记录您的异常，可能会显示一个“更友好”的错误对话框，然后让您的应用程序关闭。例如，我们在我们生成的 WPF 应用程序中放置了类似的内容：

```
<Application xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             DispatcherUnhandledException="UnhandledException">

private void UnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)
{
    logger.FatalException("OH NOES! Bad stuff happened, bailing out.", e.Exception);
    MessageBox.Show("holy cow something bad happened:\r\n" + e.Exception.Message);
} 
```

但是，有些地方捕获*所有*异常可能是安全的；这主要限于无论如何都会丢弃所有数据的地方。例如，打印或导出已完成操作的结果可能会“安全地”失败，而不会对应用程序的其余部分产生不良影响。您可能不希望您的应用程序因为用户没有打印机而崩溃。（我什至遇到过一个第三方打印库明确抛出`System.Exception`错误的案例......）但是您必须非常小心，您知道自己在做什么，并且您的数据真正与其他数据隔离系统的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T02:48:17.480

提示您知道在哪里放置 try ... catch 块。

放置一个全局异常处理程序，以捕获所有未处理的异常。记录堆栈跟踪和异常，向最终用户道歉并关闭程序（永远不要尝试在此处继续）。

让应用程序运行，当它崩溃时，检查原因并使用最具体的异常正确处理异常。

**请记住：** *异常是针对异常，而不是针对正常的程序行为。*

# windows - CreateMutex() 和 OpenMutex() 返回不同的句柄

> ID：10290999
> 
> 赞同：2
> 
> 时间：2012-04-24T02:28:36.880
> 
> 标签：windows

我认为这两个函数将返回相同的内核句柄。我编写了一个测试程序来证明我的观点：

在我的程序中，我创建了一个名为“_MYTEST”的内核句柄

```
hHandle1 = CreateMutex(NULL, false, _T("_MYTEST")); 
```

然后我启动一个线程并使用以下代码在该线程中打开上面的句柄：

```
hHandle2 = OpenMutex(MUTEX_ALL_ACCESS, false, _T("_MYTEST")); 
```

当我运行程序时，我发现两个返回值不相等！hHandle2 的值比 hHandle1 的值大 4。为什么？我的代码有问题吗？如果没有，为什么这两个值不相等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:45:59.717

句柄不是对象，它是存储在内核中的描述符，将仅在程序地址空间中有效的值映射到内核对象。

这就是说的很长的方式：互斥锁的句柄不是互斥锁本身。仅仅因为句柄不同并不意味着下面的互斥锁是不同的。

这就像在 C 中创建指向一个对象的两个不同指针，然后比较指针的*地址*（与指针的内容）以错误地推断出对象不相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:46:17.483

这是按设计工作的。信号量的“连接点”低于`CreateMutex`or返回的句柄`OpenMutex`。

换句话说，*任何一个*句柄都将引用相同的底层互斥体，由名称（您的第三个参数）指定。

如果您让每个线程锁定其各自的句柄，打印一条消息，等待十秒钟然后解锁它，您会看到这一点。

一个线程不会打印任何东西，直到另一个线程解锁它的句柄并且允许第二个锁继续进行。