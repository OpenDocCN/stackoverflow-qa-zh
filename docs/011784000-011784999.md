# StackOverflow 问答 11784000-11784999

# javascript - DOM 对象优于其他 DOM 对象

> ID：11784003
> 
> 赞同：0
> 
> 时间：2012-08-02T18:56:44.337
> 
> 标签：javascript, html, css, dom

我在放置 DOM 元素时遇到问题。

在这个 HTML ( [http://bluecodestudio.com/scripts/](http://bluecodestudio.com/scripts/) ) 中，出现了一个弹出窗口，感谢 javascript 的动画。按“Enter”按钮后，我希望将“欢迎”消息放在中心。

但它与其他元素“碰撞”，我找不到让它在元素上“浮动/流动”的方法。对我的 style.css 进行任何更改以修复它吗？谢谢！

PS：我对脚本和样式表的 [链接] 使用绝对路径路由，因为我使用了一个 Nodejs 模块，这种模块“迫使”我这样做，或者至少是使其工作的最简单方法。

编辑：CSS 直接链接：[http ://bluecodestudio.com/scripts/style.css](http://bluecodestudio.com/scripts/style.css)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:11:36.293

给你的白色 div a`position: relative;` 然后给你的欢迎 p 以下css：

```
position: absolute;
text-align: center;
line-height: #px; // same as the white div 
```

我认为这应该可以解决问题

编辑：

我以前没有深入研究。我刚刚在 chrome 检查器中尝试过，你应该用这个替换你的 css：

```
#welcomContent {
position: absolute;
padding: 88px 0;
text-align: center;
height: 200px;
width: 400px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:23:58.167

你可以这样做：

```
 #welcomeContent
 {
       width: 100%;
       height: 100%;
       z-index: 1; /*For overlapping divs*/
       opacity: 0; /*Not visible on load*/
 }

 #welcomeMessage
 {
      width: 100%;
      text-align: center;
      vertical-align:middle;
  } 
```

这在理论上应该把你的信息放在父 div 的中心。你需要一个 z-index 因为这会重叠 div

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:15:22.297

好的，所以这是一个伪 jQuery 解决方案：

```
var welcome = $(welcome);
var popupMsg = $(popupMsg);
var popup = $(popup);
var enter = $(enterButton);

enter.click(function () {
    var pOff = popup.offset();
    var newLeft = pOff.Left + ((popup.width() - welcome.width()) / 2);
    var newTop = pOff.Top + ((popup.height() - welcome.height()) / 2);

    welcome.css({ left: newLeft, top: newTop });
    popupMsg.fadeOut();
    welcome.fadeIn();
}); 
```

如果您有任何问题，请告诉我。

请记住，这只是假的 - 您必须填写它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:22:05.843

首先，当它完成淡出时，您将要`#loginContent`使用 display: none 隐藏 div，然后在确定布局时将不再考虑它。

然后将欢迎文本水平居中`float: left`取下`#welcomeContent`div。

如果您还想将文本垂直居中，有多种方法可以做到这一点，其中一些在此处进行了描述：[http](http://www.vanseodesign.com/css/vertical-centering/) ://www.vanseodesign.com/css/vertical-centering/ 。如果您只需要一个单词 Welcome!，那么 line-height 方法可能是最简单的。

# sharepoint - 解析带有嵌入图像的 Outlook 电子邮件，作为附件添加到 Sharepoint 列表项

> ID：11784013
> 
> 赞同：2
> 
> 时间：2012-08-02T18:57:38.380
> 
> 标签：sharepoint, sharepoint-2010, outlook, outlook-2010

是的，与以下问题非常相似：[Python: parsing emails with embedded images](https://stackoverflow.com/questions/4332400/python-parsing-emails-with-embedded-images)

，但我想提出一个与 Outlook 电子邮件有关的更具体的问题。

我收到一封带有嵌入图像的 Outlook 电子邮件，该图像嵌入为：

`img width="277" height="588" id="Picture_x0020_1" src="cid:image001.png@01CD708B.77509FF0" alt="Description: cid:image001.png@01CD7089.09DE0C70">`

我没有看到 base64 编码，只是`src="cid:image001.png@01CD708B.77509FF0"`，如何解析它并将其作为附件添加到 Sharepoint 列表项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:40:08.293

看起来您的答案可能在这里：[Outlook 嵌入图像到 HTML 与内联图像](https://stackoverflow.com/questions/10090608/outlook-embedded-image-to-html-with-inline-image)

他推荐 Quiksoft 的 EasyMail。

[http://www.quiksoft.com/emdotnet/](http://www.quiksoft.com/emdotnet/)

# c# - 处理几列更新的最佳方法是什么

> ID：11784016
> 
> 赞同：0
> 
> 时间：2012-08-02T18:57:46.263
> 
> 标签：c#, asp.net, sql

如果我有一个包含 20 个字段的个人资料表单，用户可以在页面上更新。如果用户只更改了两个字段，那么运行更新每一列的更新语句似乎是一种浪费。

我想知道什么是最好的方法来处理这个以获得最佳性能。

由于我只有 20 个字段，这并不是一个真正的问题，但我只是想知道未来的发展可能会更多。

其他人都做什么，您是否只更新该行的每一列？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:01:59.227

您的平均网络数据包长度为 1500 字节。这可能很容易包含您的 20 个字段。因此，您可以通过更新少于 20 个字段来节省网络负载。

SQL Server 将数据存储在 8000 字节的页面中。如果更新 1 位，SQL Server 会将其写为完全更改的页面：8000 字节的数据。因此，通过更新少于 20 个字段，您不会节省任何磁盘活动。

优化性能通常是一个错误。这些天数据库非常快。而是针对简单明了的代码进行优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:03:48.583

实体框架（或其他 ORM 工具）之类的工具将为您“免费”处理这个问题。

他们跟踪您的对象中发生了什么变化，并且他们将发布一个量身定制的`UPDATE`声明，只更新那些实际发生变化的列。

您无需再担心任何这些细节。都为你照顾。尝试一下！

资源：

*   [MSDN 数据开发人员中心中的实体框架](http://msdn.microsoft.com/en-us/data/ef.aspx)- 大量文档、白皮书、代码示例、视频等

*   [实体框架绝对初学者指南](http://blogs.msdn.com/b/adonet/archive/2010/07/19/absolue-beginners-guide-to-entity-framework.aspx)

*   [MSDN 库 - 实体框架概述 (.NET 4)](http://msdn.microsoft.com/en-us/library/bb399567.aspx)

*   [ASP.NET 站点 - 实体框架](http://www.asp.net/entity-framework)，包含大量关于如何将 EF 与 ASP.NET（Webforms 和 MVC）应用程序一起使用的教程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:02:35.490

我只能想象获取当前的数据库记录，逐个字段与用户输入进行比较，然后只更新更改的字段。

这将比仅在单个更新语句中更新所有字段更昂贵，因此我会选择单个更新选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:21:19.577

```
CREATE PROC [dbo].[UpdateMe]
(
    @pkey int,
    @Col1 int = null,
    @Col2 int = null,
    ...,
    @Col20 int = null
)
AS BEGIN

    UPDATE [Table]
           SET Col1 = ISNULL(@Col1,Col1),
           Col2 = ISNULL(@Col2,Col2),
           ...
           Col20 = ISNULL(@Col20,Col20)
    WHERE pkey = @pkey

END 
```

跟踪客户端发生的变化并相应地发送内容。如果您担心通过网络发送太多内容，请使用命名参数并仅发送已更改的内容。由于该程序有默认设置，因此不会花费您任何费用。sql 中的查找时间是成本所在，因此将列更新为自身应该非常便宜。

# jmeter - 如何使用访问日志中的 cookie 进行负载测试

> ID：11784019
> 
> 赞同：2
> 
> 时间：2012-08-02T18:57:52.460
> 
> 标签：jmeter

我有 apache 访问日志，其中包含每个请求的 cookie 信息。我可以将这些 cookie 值输入到 jmeter 的负载测试中吗？

我在 apache 中的日志格式是：

```
"%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" \"%{Cookie}i\"" combined 
```

我看到了访问日志采样器，我已经让它在我的访问日志中读取并生成请求，但它似乎不包括来自日志行的 cookie。我已经使用过 HTTPCookieManager 并且已经让它工作到它将在下一次调用中使用从一个调用返回的 cookie，但它不使用访问日志中的 cookie 值。我是在尝试做一些不可能的事情，还是我错过了什么？

示例日志行：

> 1.2.3.4 - - [31/​​Jul/2012:23:04:06 -0400] "GET /someurl/ HTTP/1.1" 200 28 "http:/domain/endpoint?params" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11" "cookie1=value1;cookie2=value2"

我的访问日志包含许多行，例如上面的行，当然每行都有不同的 cookie 值。我想创建一个负载测试，在其中重播该访问日志文件，包括记录的 cookie。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:28:52.390

Access Log Sampler 的当前实现确实完全分析了日志：

*   [http://jmeter.apache.org/usermanual/component_reference.html#Access_Log_Sampler](http://jmeter.apache.org/usermanual/component_reference.html#Access_Log_Sampler)

文档说：

```
*127.0.0.1 - - [21/Oct/2003:05:37:21 -0500] "GET /index.jsp?%2Findex.jsp= HTTP/1.1" 200 8343 
```

解析器的当前实现只查看引号内的文本。其他所有内容都被剥离和忽略。*

您可以使用采样器访问日志文件打开增强请求。

# unit-testing - 如何测试 Salesforce 安装处理程序？

> ID：11784024
> 
> 赞同：1
> 
> 时间：2012-08-02T18:58:37.203
> 
> 标签：unit-testing, salesforce

在我们的托管包上，我们有一个实现[InstallHandler](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_install_handler.htm)接口的 PostInstallClass。我们使用它在以后的版本中添加新字段时填充它们，或者在模型更改时修复数据。

但是，我们很难找到测试这种迁移的方法。例如：我们添加了一个在触发器中使用的新字段。我们想插入一些该字段为空的记录（就像创建字段时一样），但**不**触发触发器，这将失败。

我们有什么办法可以做这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T23:04:59.357

我建议实现一个受保护的自定义设置对象（受保护，因为您不希望您的订阅者能够修改它）。这是你可以*禁用*你的触发器，例如

```
trigger <name> on Account (<events>) {
    Configuration_Options__c options = Configuration_Options__c.getOrgDefaults();
    if(options.Trigger_Enabled__c) {
        //perform all the actions in the trigger
    }
} 
```

然后在单元测试中你可以控制触发器是否执行它的动作

```
private static testMethod void testPostInstallClass() {
    PostInstallClass postinstall = new PostInstallClass();
    Configuration_Options__c options = Configuration_Options__c.getOrgDefaults();

    //disable the trigger
    options.Trigger_Enabled__c = false;
    update options;

    //insert your legacy records here

    //re-enable the trigger
    options.Trigger_Enabled__c = true;
    update options;

    //run the install script
    Test.testInstall(postinstall, null);
} 
```

# model-view-controller - Html.DropDownListFor - 在枚举基本模型时填充与模型属性对应的列表？

> ID：11784025
> 
> 赞同：0
> 
> 时间：2012-08-02T18:58:39.083
> 
> 标签：model-view-controller, drop-down-menu, model, enumeration

我试图在一个视图中填充一个下拉列表，这导致我：

[具有 List<string> 类型模型的 ASP.NET MVC DropDownListFor](https://stackoverflow.com/questions/5688910/asp-net-mvc-dropdownlistfor-with-model-of-type-liststring)

那里的解决方案效果很好。所以现在我有一个“创建新项目”视图，它接受一个“项目”模型，我的模型除其他外还有：

```
 public int projectPrimaryEmployeeID
    {
        get
        { return _projectPrimaryEmployeeID; }
        set
        {
            _projectPrimaryEmployeeID = value;
        }
    }

    public IEnumerable<SelectListItem> employeeList { get; set; } 
```

在我的 GET 操作结果中，我使用数据库中的项目填充了employeeList，并且下拉列表填充得很好。

但是现在我有一个枚举我的模型（所有项目的列表）的视图，对于每个项目，我需要显示下拉列表，一遍又一遍地显示员工列表。

我的“显示所有项目”视图有：

```
@model IEnumerable<MVCCodeProject.Models.project> 
```

..我说的是：

```
@Html.DropDownListFor(modelItem => item.projectPrimaryEmployeeID, new     SelectList(Model.employeeList, "Value", "Text")) 
```

但我收到一个错误：

```
'System.Collections.Generic.IEnumerable<MVCCodeProject.Models.project>' does not contain a definition for 'employeeList' and no extension method 'employeeList' accepting a first argument of type 'System.Collections.Generic.IEnumerable<MVCCodeProject.Models.project>' could be found (are you missing a using directive or an assembly reference?) 
```

所以似乎在枚举模型时，显示下拉列表的路径可能有点不同，有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:36:52.377

因此，首先您需要将模型更改为 IList：

```
@model IList<MVCCodeProject.Models.project> 
```

然后您将能够迭代列表并使用索引绑定到该列表中的每个项目：

```
@for (int i = 0; i < Model.Count(); i++)
{
    Html.DropDownListFor(proj => proj[i], new SelectList(proj.employeeList, "Value", "Text"));
} 
```

还有其他策略可以做到这一点，比如使用模板。在此处阅读更多信息：http: [//haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

# python - 我在哪里把中断放在我的代码中？

> ID：11784028
> 
> 赞同：-3
> 
> 时间：2012-08-02T18:58:44.917
> 
> 标签：python, loops, break

```
print'Personal information, journal and more to come'

while True:

    x = raw_input()
    if x =="personal information": 
         print' Edward , Height: 5,10 , EYES: brown , STATE: IL TOWN:  , SS:'
    elif x =="journal":
       print'would you like  you open a journal or create a new one? open or create'
if x =='createfile':
           name_of_file = raw_input("What is the name of the file: ")
           completeName = "C:\\python\\" + name_of_file + ".txt"
           file1 = open(completeName , "w")
           toFile = raw_input("Write what you want into the field")
           file1.write(toFile)
           file1.close()
elif x =='openfile':
       print'what file would you like to open' 
       y = raw_input()
       read = open(y , 'r')
       name = read.readline()
       print (name)
       break 
```

每次我尝试运行程序时，它都会不断告诉我中断已超出循环，但我不知道我还能在哪里设置中断。还有什么是记住在循环末尾放置中断的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:01:57.323

坦率地说：你`break` *在循环之外*。您有一个不在 while 循环内的 if 语句。

方式`if x =='createfile':` 是缩进的，它在while循环运行之后运行。

我猜你想重新缩进你的代码，以便它们都包含在循环中。我也将其更改为`if`，`elif`因为这在这里看起来更合适：

```
print 'Personal information, journal and more to come'

while True:

    x = raw_input()
    if x =="personal information": 
         print' Edward , Height: 5,10 , EYES: brown , STATE: IL TOWN:  , SS:'
    elif x =="journal":
         print'would you like  you open a journal or create a new one? open or create'
    elif x =='createfile':
         name_of_file = raw_input("What is the name of the file: ")
         completeName = "C:\\python\\" + name_of_file + ".txt"
         file1 = open(completeName , "w")
         toFile = raw_input("Write what you want into the field")
         file1.write(toFile)
         file1.close()
    elif x =='openfile':
         print'what file would you like to open' 
         y = raw_input()
         read = open(y , 'r')
         name = read.readline()
         print (name)
         break 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:01:04.923

您的语句是循环之外的`break`语句的一部分。Python 对空格敏感。您应该将所有的and语句缩进到循环内。`if``elif``if``elif`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:01:08.957

你的缩进是错误的。似乎您正试图摆脱 while 循环，但您的 while 循环在

```
if x == 'createfile' 
```

陈述。

您必须修复 if 和 elif 语句的缩进，以便它们位于 while 循环内，然后您的 break 语句将起作用。

# java - Java 中的日志文件解析器

> ID：11784032
> 
> 赞同：0
> 
> 时间：2012-08-02T18:59:03.660
> 
> 标签：java, database, performance, parsing, design-patterns

我正在尝试为我的应用程序设计日志文件解析器。我有数千个具有相同数据模式的日志文件，我的目标是首先解析数据并将其存储在数据库中。
日志文件具有以下模式-

```
a=some_value_1 b=some_value_2 c=some_value_3 d=some_value_4
a=some_value_5 b=some_value_6 c=some_value_7 d=some_value_8
a=some_value_9 b=some_value_10 c=some_value_11 d=some_value_12
a=some_value_13 b=some_value_14 c=some_value_15 d=some_value_16 
```

我最初的想法是逐行读取所有文件，`InputStreamReader`并为每一行中的每个文件选择数据并将其提取到 db。对某些文件来说似乎不错，但在性能方面我需要改进我的设计。有人可以建议一些更好的设计模型/架构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:01:42.847

我建议最好使用`BufferedReader`而不是`InputStreamReader`. 现在，您的任务的解析部分似乎并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:10:14.860

模式很棒，但只有在有意义时才应该使用它们。这里不需要特殊模式：只需遍历文件即可；对于每个文件，阅读它，并根据需要进行插入。该程序不应在具有 main[] 方法的单个文件/类中占用超过 50 行。小而干净的代码比复杂的大代码要好得多。

# html - 将容器大小调整为图像

> ID：11784038
> 
> 赞同：-1
> 
> 时间：2012-08-02T18:59:23.793
> 
> 标签：html, css, size, position

我有一个高度为 100% 的图像容器和一个适合高度的图像（使用 display:inline 制作）。我现在想做的是使容器宽度缩小以适应调整大小的图像。

问题：容器缩小到图像的原始大小，而不是调整大小的版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:06:45.647

您可以向图像添加“onLoad”操作，例如`onload="sizeCont();`

```
function sizeCont() {
  document.getElementById("containerID").style.width = 
    document.getElementById("imageID").style.width;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:33:44.867

你为什么不直接使用`<img src.....`和设置`width: 100%`. 试试看，看看效果如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T19:27:56.727

我找到了解决方案。现在容器按照我想要的方式运行。图片根据给定的高度动态调整大小。容器根据所有图片的宽度调整大小。唯一剩下的就是如果用户改变了窗口大小，必须重新加载站点（可以用 js 完成）。如果有人有更好的解决方案，请告诉我。

[http://jsfiddle.net/EdgKr/9/](http://jsfiddle.net/EdgKr/9/)

# ssis - 2012 年使用脚本部署 SSIS 包

> ID：11784042
> 
> 赞同：1
> 
> 时间：2012-08-02T18:59:37.353
> 
> 标签：ssis, sql-server-2012

包含脚本的包是使用 VS 2008 创建的，但它所在的服务器只有 VS 2010 PowerShell。我能够毫无错误地构建脚本，并且在本地进行了测试并且运行良好。错误是：

> ```
> 数据流任务 [脚本组件 [111]] 出错：找不到脚本的二进制代码。请通过单击编辑脚本按钮在设计器中打开脚本并确保其构建成功。
> 数据流任务 [SSIS.Pipeline] 出错：“脚本组件”验证失败并返回验证状态“VS_ISBROKEN”。
> 数据流任务 [SSIS.Pipeline] 出错：一个或多个组件验证失败。
> 数据流任务出错：任务验证期间出现错误。
> 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T15:21:09.527

SSIS 包部署在 SQL Server 2012 中发生了变化。有一篇精心编写的分步[博客](http://www.mssqltips.com/sqlservertip/2450/ssis-package-deployment-model-in-sql-server-denali-part-1-of-2/)文章向您展示了如何将 SSIS 包部署到 Integration Services 服务器。[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb522534%28SQL.110%29.aspx)中也有关于 SSIS 部署更改的摘要。

SSDT 是 SQL Server 2012 中的开发工具（而不是以前版本中的 BIDS），用于创建 SSIS 包。我也写过关于 SSDT 的[博客。](http://lynnlangit.wordpress.com/?s=SSDT)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:00:00.690

我终于解决了这个问题。

打开项目后，我将菜单工具栏下的 Build 下拉菜单从 Debug 更改为 Release。当我选择构建时出现错误：

> 任务无法使用 SdkToolsPath“”或注册表项“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v7.0A”找到“sgen.exe”。确保设置了 SdkToolsPath，并且该工具存在于 SdkToolsPath 下的正确处理器特定位置，并且安装了 Microsoft Windows SDK

虽然我安装了正确的 SDK，但缺少 sgen.exe 文件。我尝试安装适用于 Windows 7 和 .NET Framework 4（版本 7.1）的 Microsoft Windows SDK，但在 2008 服务器上失败。我将它安装在我的 Windows 7 PC 上并将 sgen.exe 从我的 PC 复制到构建服务器到

`\\vpdr1\c$\Program Files\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools`

我打开了项目，编辑了脚本，设置为发布，并且能够构建和保存。没有红色 X 并且 SSIS 包现在可以工作了！

# twitter-bootstrap - Twitter Bootstrap 2.0.4 Typeahead 基本设置如何？

> ID：11784045
> 
> 赞同：0
> 
> 时间：2012-08-02T18:59:42.937
> 
> 标签：twitter-bootstrap, typeahead

我是一个有抱负的网页设计师，我正在自学和自己练习。现在我正在创建分类主题设计。

我想应用类型化的 twitter bootstrap js 插件，我想要完成的只是设置插件并放置一些虚拟源数据。

 ``This is my html markup below:

```
<form class="well form-horizontal">
    <input class="city span3" type="text" data-provide="typeahead"/>
</form> 
````  ````
    这就是我为脚本键入的内容……顺便说一下，我对 jQuery 或 javascript 还没有深入的了解。

    $(function() {$(".city").typeahead({
            来源：[“Youtube”，“Facebook”，“雅虎”]
            })
        });

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:29:10.383

试试这个：

```
$('.city').typeahead({
    source: ['Youtube', 'Facebook', 'Yahoo']
}); 
`````

# php - 将产品添加到购物车时出现系统错误 - Magento

> ID：11784048
> 
> 赞同：0
> 
> 时间：2012-08-02T18:59:47.040
> 
> 标签：php, session, magento, shopping-cart, system-error

客户在将产品添加到购物车时收到系统错误。我认为那是会话问题，因为当客户注销并重新签名时，浏览器上不再出现“系统错误”。这是屏幕截图：[http ://screencast.com/t/7HmL1rtQvvs](http://screencast.com/t/7HmL1rtQvvs)

此问题仅在使用特定付款方式后发生。

注意：我们使用的是 Magento

谢谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:06:26.583

将产品添加到购物车或选择付款方式后会发生这种情况吗？

# java - NoSuchMethodError：org.codehaus.jackson.type.JavaType

> ID：11784051
> 
> 赞同：6
> 
> 时间：2012-08-02T19:00:14.683
> 
> 标签：java, spring, google-app-engine, jackson

我的应用程序抛出了下面的错误，尽管我的应用程序中有`jackson-core-asl-1.4.2`and`jackson-mapper-asl-1.4.2`

```
Caused by: java.lang.NoSuchMethodError: org.codehaus.jackson.type.JavaType.<init>(Ljava/lang/Class;)V
    at org.codehaus.jackson.map.type.SimpleType.<init>(SimpleType.java:32)
    at org.codehaus.jackson.map.type.TypeFactory._fromClass(TypeFactory.java:254)
    at org.codehaus.jackson.map.type.TypeFactory._fromType(TypeFactory.java:266)
    at org.codehaus.jackson.map.type.TypeFactory.type(TypeFactory.java:57)
    at org.codehaus.jackson.map.ObjectMapper.<clinit>(ObjectMapper.java:49)
    at org.springframework.web.servlet.view.json.MappingJacksonJsonView.<init>(MappingJacksonJsonView.java:59)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance_(Runtime.java:126)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance(Runtime.java:134)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
    ... 48 more
.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance_(Runtime.java:126)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance(Runtime.java:134)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
    ... 48 more 
```

可能是什么原因？应用程序之前工作并将代码提交给 SVN 真的很奇怪，然后当我签出并重新运行所有内容时，我得到了这个错误......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-03T17:43:15.767

这看起来几乎可以肯定是由于 'core' 和 'mapper' jar 的版本不兼容。您可能通过类路径使用了不兼容的版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-11T21:42:05.403

您遇到的问题是由于 Google App Engine SDK 的更新（我认为是 1.6.1？）。

我遇到了同样的问题，所以我运行了 TattleTale 来查看是否存在一些依赖问题。瞧，`org.codehaus.*`与以下 2 个库存在冲突：

*   google_sql.jar
*   杰克逊核心asl-1.6.3.jar

虽然您的杰克逊库与我的略有不同，但问题仍然存在。此问题有 2 个修复：

*   从 war/webinf/lib 目录中删除 google_sql.jar。这将导致 SDK 验证检查失败，但如果您忽略红色 x，您的代码应该可以正常运行。
*   将您的 GAE SDK 更新到 1.6.2 或更高版本。我认为他们在后来的 SDK 中解决了这个问题，但更新还引入了一些编译器警告，所以在你跳跃之前先看看。

# android - 为什么谷歌地图网站在 webview Android 上表现得很奇怪？

> ID：11784052
> 
> 赞同：2
> 
> 时间：2012-08-02T19:00:16.483
> 
> 标签：android, google-maps, android-webview

当用户单击带有此网址的按钮时，我正在尝试加载 maps.google.com

[http://maps.google.com/maps?saddr=40.702297,-73.796015&daddr=40.73682,-73.989937&mrsp=0,1](http://maps.google.com/maps?saddr=40.702297,-73.796015&daddr=40.73682,-73.989937&mrsp=0,1)

![在此处输入图像描述](../Images/17c3fd18770a1084d50bb67e6e18b8e3.png)

它按我的预期工作，但是当我单击![在此处输入图像描述](../Images/4cd1df981f5898492fe996a43564ce50.png) 它时，它只加载部分屏幕（不覆盖我的所有屏幕）。

![在此处输入图像描述](../Images/4eaa6c44f1fd8ce0ccdd69f4730075b7.png)

注意：我尝试在模拟器的浏览器中加载相同的 url，一切正常。

这是我用来加载网页的网页视图的设置：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);

    setContentView(R.layout.webview_layout);

    this.webview = (WebView)findViewById(R.id.myWebview);

    WebSettings settings = webview.getSettings();

    settings.setJavaScriptEnabled(true);
    settings.setBuiltInZoomControls(true);
    settings.setSupportZoom(true);

    webview.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
    webview.getSettings().setLoadWithOverviewMode(true);
    webview.getSettings().setUseWideViewPort(true);

    //....follow by normal setup of webview.setWebViewClient
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:05:28.233

我找到了解决这个问题的方法。在我的 webview 中，我使用了一行代码来加载 Twitter 网站（没有这一行，它只会加载一个白屏）

webSettings.setUserAgentString("Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543a Safari/419.3");

# asp.net - 如何在 GridviewRow 中选择选中的行并在 VB.net 的下一页中显示它

> ID：11784056
> 
> 赞同：0
> 
> 时间：2012-08-02T19:00:37.750
> 
> 标签：asp.net, vb.net, gridview

我正在尝试从 gridviewrow 获取行并将其显示在下一页的详细视图中。我正在使用带有 VB 的 Asp.net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:12:45.437

只需迭代集合并检查状态。然后，您可以将选定的行放入会话对象或其他内容中以传递到下一页。

```
For Each Row As GridViewRow In MyGrid.Rows

   Dim SelectCheck As CheckBox = DirectCast(Row.FindControl("chkSelectForDetail"), CheckBox)

   If SelectCheck.Checked
      ' Add your logic here to save the data or passing on to the detail page.    
   End If

Next 
```

# objective-c - 从 UIViewController 绘制虚线

> ID：11784057
> 
> 赞同：2
> 
> 时间：2012-08-02T19:00:41.480
> 
> 标签：objective-c, ios, cocoa-touch, cgcontext

我有一个 UIViewController，里面有一个 UIView，我想在上面画一条直线。执行此操作的最简单和高效的方法是什么？我该怎么做呢？它只是一条宽度为 150 的灰色水平虚线。我环顾四周，似乎使用 CGContextSetLineDash 是解决方案，这就是我到目前为止所拥有的：

```
-(void) drawRect:(CGRect) rect
{
  CGContextRef context = UIGraphicsGetCurrentContext();
  CGContextSetLineWidth(context, 100);
  CGFloat dashes[] = {1,1};
  CGContextSetLineDash(context, 2.0, dashes, 2);
  CGContextStrokePath(context);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:30:13.083

`CGContextStrokePath`绘制*当前*路径，但是，您永远不会向上下文添加任何路径，因此不会绘制任何内容。

在调用之前添加以下两行`CGContextStrokePath`，您应该会看到一些内容：

```
CGContextMoveToPoint(context, 0, self.bounds.size.height * 0.5);
CGContextAddLineToPoint(context, self.bounds.size.width, self.bounds.size.height * 0.5); 
```

如果您还没有设置描边颜色，您还应该添加类似这样的内容（50% 灰色）：

```
CGContextSetRGBStrokeColor(context, 0.5, 0.5, 0.5, 1.0); 
```

我不确定结果是否真的是您想要的，带有 {1, 1} 图案的 100 点虚线看起来更像是带有细条纹图案的矩形，而不是虚线。如果你希望你的点是圆圈，你将不得不在某种循环中手动绘制它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-01T14:28:25.750

试试这个：

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor);
CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
CGContextSetStrokeColorWithColor(context, color.CGColor);

CGContextSetLineWidth(context, 2.0);

CGFloat lengths[] = {0, 8};
CGContextSetLineCap(context, kCGLineCapRound);
CGContextSetLineDash(context, 0.0f, lengths, 2);

CGContextMoveToPoint(context, 10,  10);
CGContextAddLineToPoint(context, 200, 10);

CGContextStrokePath(context);
CGColorSpaceRelease(colorspace); 
```

# java - BeanValidation：来自 ValidationMessages.properties 的消息

> ID：11784058
> 
> 赞同：1
> 
> 时间：2012-08-02T19:00:46.020
> 
> 标签：java, jakarta-ee, jboss, java-ee-6, bean-validation

我在正确设置我的自定义 bean 验证消息时有点卡住了。我添加了以下约束定义并将其放在一些 bean 上更好地说属性。

```
@Constraint(validatedBy = NobleValidator.class)
@Documented
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
public @interface Noble {
    String message() default "NOT_NOBLE";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
} 
```

好的，现在我刚刚实现了自定义验证器“NobleValidator”。这一切都是直截了当的。但是我的问题来了。如果我试图通过运行这样的验证来验证 bean

```
// ... 
Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
Set<ConstraintViolation<Person>> s = validator.validate(p, new Class[]{});
if (s == null || s.isEmpty()) {
     // Do some suff
} else {
     for (ConstraintViolation<Person> cv : s) {
         LOGGER.error(String.format("Constraint violation: %s", cv.getMessage()));
     }
}
// ... 
```

好的，验证有效，但结果不如预期。我得到“约束违规：NOT_NOBLE”。所以我猜验证器能够查找我的属性文件，因此它不能用正确的消息文本替换密钥。ValidatorMessages.properties 看起来像这样：

NOT_NOBLE=Foo Bar 不高贵

规范（JSR303）说我必须将 ValidationMessages.properties 放到我的类路径根目录中，我希望它应该是 MyDeploymentUnit.war/WEB-INF/classes/ValidationMessages.properties，这就是我的应用程序的构建和部署方式。出于调试原因，我将此添加到我的自定义验证器中，以确保文件存在并正确设置

```
@Override
public boolean isValid(String value, ConstraintValidatorContext context) {
InputStream is = getClass().getClassLoader().getResourceAsStream("ValidationMessages.properties");
BufferedReader br = new BufferedReader(new InputStreamReader(is));
String l = null;
try {
    while ((l = br.readLine()) != null) {
        LOGGER.info(String.format("Line: %s", l));
    }
} catch (IOException ex) {
    LOGGER.error(ex.getMessage());
}
 // Validation logic goes here 
```

上面的代码工作得很好。我得到了 ValidationMessages.properties 中指定的所有行

目前我正在使用 JBossAS7.0.2，所以我的任何人都给我一些建议如何修复它并接收解析的文本而不是密钥？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T08:23:02.760

将您的消息密钥包裹在大括号中：

```
@Constraint(validatedBy = NobleValidator.class)
@Documented
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
public @interface Noble {
    String message() default "{NOT_NOBLE}";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
} 
```

# mysql - 如何在一对多关系中执行此 sql 查询以聚合计数

> ID：11784061
> 
> 赞同：0
> 
> 时间：2012-08-02T19:00:57.580
> 
> 标签：mysql, sql

我有两个表，列表和 globals_lists。globals_lists 基本上将 list_id 与 global_id 值相关联。我想为每个用户获取关联列表类型的 global_ids 计数（即 globals_lists 表中的“manys”数）。

就像是：

```
select l.id, l.user_id, count(gl.global_id) as gl_count 
from   lists l, globals_lists gl 
where  l.list_type_id=10 and l.id=gl.list_id; 
```

但这给了我错误的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:03:14.190

添加：

```
GROUP BY l.id, l.user_id 
```

在你的`where`条款之后。

如果没有`GROUP BY`，您基本上只是计算所有满足`WHERE`和连接条件的行，而不考虑设置分组。`GROUP BY`将确保您正在执行***每个***用户的计数聚合 -> 列表组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:05:41.213

```
select l.id, l.user_id, count(gl.global_id) as gl_count 
from   lists l, globals_lists gl 
where  l.list_type_id=10 and l.id=gl.list_id
GROUP BY l.id, l.user_id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:06:27.370

当您使用像 之类的聚合函数`count`时，您应该指定聚合应该在其上运行的组。MySQL 不需要这个，但如果你这样做总是会更清楚。

在您的情况下，您要查找的组是`(user_id, list_id)`. 您可以编写如下查询：

```
select  l.user_id
,       l.id
,       count(gl.global_id) as gl_count 
from    lists l
join    globals_lists gl 
on      l.id = gl.list_id
where   l.list_type_id = 10
group by
        l.user_id
,       l.id 
```

# windows - 获取 Windows Phone 8 设备中的电池电量？

> ID：11784065
> 
> 赞同：6
> 
> 时间：2012-08-02T19:01:06.747
> 
> 标签：windows, microsoft-metro, windows-runtime, windows-phone-8

如何以编程方式从 Windows Phone 8 设备获取电池电量？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-12T17:56:39.120

以下对我有用

*Windows.Phone.Devices.Power.Battery.GetDefault().RemainingChargePercent*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T21:20:02.860

快速查看[此](http://www.youtube.com/watch?v=ZttM0QX93mc)视频。它遍历了您提到的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T09:54:10.603

您可以使用 Windows.Phone.Devices.Power 命名空间中定义的 Battery 类检索 Windows Phone 8 设备电池的电池电量和剩余时间。以下是其用法的一些示例。

1.  [使用 C# 以编程方式检索 Windows Phone 8 设备电池的剩余时间](http://mobileosgeek.com/retreiving-the-remaining-time-of-the-windows-phone-8-device-battery-programatically-using-c/)
2.  [如何在 Windows Phone 8 中以编程方式检索电池电量？](http://mobileosgeek.com/how-to-retreive-the-battery-level-programatically-in-windows-phone-8/)

# ios - 核心数据关系错误

> ID：11784067
> 
> 赞同：1
> 
> 时间：2012-08-02T19:01:14.427
> 
> 标签：ios, cocoa-touch, core-data

我想保存一个目标和一个演员。这两个实体与责任关系相关：

```
Goal *addgoal = (Goal*)[NSEntityDescription insertNewObjectForEntityForName:@"Goal" inManagedObjectContext:context];

    addgoal.goalNaam = nameTextField.text;
    addgoal.goalId = idField.text;
    addgoal.goalBeschrijving = beschrijvingField.text;

    Actor *addactor = (Actor*)[NSEntityDescription insertNewObjectForEntityForName:@"Actor" inManagedObjectContext:context];

    addactor.actorNaam = responsibleField.text;

    [addgoal addResponsibilityObject:addactor]; 
```

上面的行 ([addgoal addResponsibility:addactor]) 导致错误，出了什么问题？

在目标.h 中：

```
@interface Goal (CoreDataGeneratedAccessors)
- (void)addResponsibilityObject:(Actor *)value;
@end 
```

错误：

2012-08-02 20:57:11.838 Choose3[7434:fb03]-[__NSCFSet entity]：无法识别的选择器发送到实例 0x8877810 2012-08-02 20:57:11.840 Choose3[7434:fb03] ***由于未捕获而终止应用程序异常“NSInvalidArgumentException”，原因：“-[__NSCFSet 实体]：无法识别的选择器发送到实例 0x8877810”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-18T09:36:12.220

我刚刚遇到了同样的问题。这里的解决方案是，我忘记检查模型检查器中关系选项中的“To-Many”选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:54:24.683

Core Data 似乎对责任关系的性质感到困惑。我建议创建`NSManagedObject`与数据模型的当前状态相匹配的子类。

创建此错误的一种方法是将一对多关系更改为一对一关系，而无需重新生成实体类文件。

# php - 将两个数字相加时总是得到错误的值

> ID：11784070
> 
> 赞同：0
> 
> 时间：2012-08-02T19:01:22.680
> 
> 标签：php, math

这是迄今为止我遇到的最奇怪的问题之一，我有两个数字，我试图在 php 中相加，但由于某种原因，php 没有给我正确的结果。

我正在尝试添加应该给我`$itemPrice`的`$shipPrice`，但我得到了。`3.50 + 2.80``6.30``5`

我尝试过使用，`floatVal() function`但这没有区别，有人有什么想法吗？

下面是代码示例

**php代码**

```
foreach($resp->ListOrderItemsResult->OrderItems->OrderItem as $order){
   $itemPrice =  $order->ItemPrice->Amount;
   $shipPrice = $order->ShippingPrice->Amount;
   $total = $itemPrice + $shipPrice;

   $arr[] = array(
      'sku' => $order->SellerSKU,
      'isbn' => $order->ASIN,
      'title' => $order->Title,
      'item_price' => $itemPrice,
      'ship_price' => $shipPrice,
      'total' => $total,
      'quantity_shipped' => $order->QuantityShipped,
   );
} 
```

**输出**

```
sku             isbn         title  item_price  ship_price  total   quantity_shipped
VM-F5TU-BN0K    1844831531   xxxxx  3.50        2.80            5   1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:05:05.337

我的猜测是 $itemPrice 和 $shipPrice 是字符串，当您尝试将它们加在一起时，您会得到 5 的值。如果您的对象中存储为字符串，请确保您专门将 $itemPrice 和 $shipPrice 转换为浮点数.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:08:34.880

检查数据库中的金额数据类型输出和价格字段的数据类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:10:57.890

```
$total = (float) $itemPrice + (float) $shipPrice; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T19:11:25.187

我知道很多程序员不会处理小数，而是将价格以美分表示，然后将美分转换为美元金额。您可以通过查看“PHP 虚拟属性”找到更多相关信息。

这防止了舍入误差等。加号整数由计算机处理得更好。

# apache - Apache 重写规则将所有请求重定向到包含另一个 .htaccess 和重写规则的子目录

> ID：11784073
> 
> 赞同：7
> 
> 时间：2012-08-02T19:01:32.163
> 
> 标签：apache, mod-rewrite

我的网络服务器上有公共和私人项目。我将所有公开的内容都放入了网络服务器根目录，并且我在`private`那里有一个只能从本地网络访问的文件夹（由 .htaccess 在那里设置）。

我想简单地将每个私有项目放在`private`文件夹中并自动处理请求，但希望 URL 看起来像是从 webroot 提供的。
例如，如果`private/project1`我想使用 URL [http://example.com/project1](http://example.com/project1)来提供该文件夹并且不想更改 URL。

这个简单的重写：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ private/$1 
```

有效，但是当我有`private/project2`另一个时`.htaccess`：

```
Options +FollowSymLinks
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /project2/

<Files .*>
       Order Deny,Allow
       Deny From All
</Files>

# Allow asset folders through
RewriteRule ^(assets/.+) - [L]

# Protect files from being viewed
RewriteRule ^(uploads.+) - [F,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php/$1 [L]

</IfModule>
Options -Indexes 
```

然后会出现静态内容，但链接已损坏。我应该修改什么才能工作？

此外，如果我有一个`private/project3`并浏览到`http://example.com/project3/`没有问题，但是当我浏览到`http://example.com/project3`（没有尾随 /）时，URL 将像`http://example.com/private/project3/`在浏览器中一样可见。为什么 ？我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T00:17:02.617

在您的情况下，您只需要 mod_alias。

然后为您的私人项目提供服务，例如：

```
Alias /project3 /apache/htdocs/private/project3 
```

使用 .htaccess，您将控制访问权限。

如果你想在不重启服务器的情况下控制它，你可以尝试使用以下配置来实现这一点，可以放在 .htaccess 文件中：

```
RewriteRule ^/(project1)$ /private/$1/index.html
RewriteRule ^/(project1/)(.*)$ /private/$1$2 
```

index.html - 项目的任何索引文件。这样，除了您用于私有项目的路径之外，URL 的公共部分将完全可以访问。您还可以添加 RewriteCond 以检查 IP 并仅为您的本地网络启用重写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T00:50:33.857

实际上，查看您的问题，这似乎是 mod_dir 干扰路径管道的问题。具体来说，`DirectorySlash`默认情况下打开，当它认为浏览器正在请求目录并且缺少尾部斜杠时，将 301 重定向浏览器。您可以尝试转动`DirectorySlash Off`，但有一个[与之相关的安全警告](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash)：

> 关闭尾部斜杠重定向可能会导致信息泄露。考虑 mod_autoindex 处于活动状态（选项 +Indexes）并且 DirectoryIndex 设置为有效资源（例如 index.html）并且没有为该 URL 定义其他特殊处理程序的情况。在这种情况下，带有斜杠的请求将显示 index.html 文件。但是没有斜杠的请求会列出目录内容。

这可能适用于您的设置，也可能不适用于您的设置。您还可以尝试修改重写规则以考虑尾部斜杠：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)/$ private/$1/     

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*[^/])$ private/$1/ 
```

但是我试图让 mod_rewrite 和 mod_dir 总是能很好地相互配合，结果好坏参半。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T08:52:19.460

虚拟域还不够吗？

您可以将一个域用于私人项目，另一个用于公共项目。

[http://httpd.apache.org/docs/2.2/vhosts/examples.html](http://httpd.apache.org/docs/2.2/vhosts/examples.html)

# php - 如何将选择添加到主题选项

> ID：11784079
> 
> 赞同：0
> 
> 时间：2012-08-02T19:01:54.410
> 
> 标签：php, wordpress, wordpress-theming

我设置了一个自定义模板，为管理员处理选项，我想添加一个组合框来选择一个类别。类似于：编辑精选类别：[]

我已经知道如何向面板添加选项，但不是来自 wordpress 本身的类别。

感谢您的任何提示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:55:03.803

要添加带有预填充字段的选择选项，您首先要从博客中获取所有类别，然后将其存储在一个数组中。

```
// Grabs Categories from Wordpress
$tt_categories = array();  
$tt_categories_obj = get_categories('hide_empty=0');
foreach ($tt_categories_obj as $tt_cat) {
$tt_categories[$tt_cat->cat_ID] = $tt_cat->cat_name;}
$categories_tmp = array_unshift($tt_categories, "Select a category:"); 
```

然后你会在你的主题选项中这样称呼它

```
//shows a select box in theme options page
$options[] = array( "name" => __('Wordpress Category','framework_localize'),
        "desc" => __('Select a category','framework_localize'),
        "id" => "wp_category",
        "std" => "1",
        "type" => "select",
        "options" => $tt_categories); 
```

# android - Android 空白位图

> ID：11784085
> 
> 赞同：1
> 
> 时间：2012-08-02T19:02:06.643
> 
> 标签：android, memory, bitmap, resolution, rescale

我正在使用 inSampleSize 创建位图。我遇到了一个不寻常的问题。在某些图像上，重新缩放的图像是空白的。

示例 1：

原始：**4288x2848** inSampleSize = **2**；重新缩放：**2144x1424**

*结果是空白图像*

原始：**4288x2848** inSampleSize = **4**；重新缩放：**1072x712**

*结果是正确的图像*

示例 2：

原始：**4752x3168 inSampleSize** = **4**；重新缩放：**1188x792**

*结果是正确的图像*

这个在 inSampleSize = 2 也失败了。

现在没有任何故障会引发明显的 OOM 错误。但是，当我接近 3MB 图像大小时，BitmapFactory.decodeFile(..) 似乎确实无法创建图像。

我可以收紧内存限制，但我真的很想知道是什么导致了这个工件；感谢任何见解。谢谢！

# mongodb - 来自 Grails 的 MongoDB 'upsert'

> ID：11784087
> 
> 赞同：2
> 
> 时间：2012-08-02T19:02:07.033
> 
> 标签：mongodb, grails, grails-orm, upsert

我正在尝试在 Grails / GORM / mongodb 插件 / MongoDB 中实现一个简单的“插入或更新”（所谓的“upsert”）方法。

我与 Hibernate 一起使用的方法（使用合并）失败并出现重复键错误。我认为可能 merge() 不是 mongodb GORM 中支持的操作，并试图通过 GMongo 获取本机 upsert 方法。

我终于有了一个可以工作的版本（如下所示），但这可能不是最好的方法，因为向正在保存的对象添加任何字段都会默默地破坏代码。

```
 public void upsertPrefix(p) {
    def o = new BasicDBObject()
    o.put("_id", p.id)
    o.put("someValue", p.someValue)
    o.put("otherValue", p.otherValue)

    // DBObject o = p as DBObject // No signature of method: mypackage.Prefix.keySet() is applicable for argument types: () values: []

    db.prefix.update([_id : p.id], o, true, false)
    // I actually would want to pass p instead of o here, but that fails with:
    // No signature of method: com.gmongo.internal.DBCollectionPatcher$__clinit__closure2.doCall() is applicable for argument types: (java.util.ArrayList) values: [[[_id:keyvalue], mypackage.Prefix : keyvalue, ...]]

    /* All of these other more "Hibernatesque" approaches fail:
    def existing = Prefix.get(p.id)
    if (existing != null) {
        p.merge(flush:true) // E11000 duplicate key error
        // existing.merge(p) // Invocation failed: Message: null
        // Prefix.merge(p) // Invocation failed: Message: null

    } else {
        p.save(flush:true)
    } 
    */
} 
```

我想我可以在混合中引入另一个 POJO-DbObject 映射框架，但这会使事情变得更加复杂，重复 GORM 已经在做的事情，并且可能会引入额外的元数据。

任何想法如何以最简单的方式解决这个问题？

编辑#1：我现在尝试了别的东西：

```
 def existing = Prefix.get(p.id)
    if (existing != null) {
//      existing.properties = p.properties // E11000 duplicate key error...
        existing.someValue = p.someValue    
        existing.otherValue = p.otherValue  
        existing.save(flush:true)
    } else {
        p.save(flush:true)
    } 
```

未注释的版本再次起作用，但维护性不好。我想做的评论版本失败了。

编辑#2：

**有效的版本**：

```
public void upsertPrefix(p) {
    def o = new BasicDBObject()

    p.properties.each {
        if (! (it.key in ['dbo'])) {
            o[it.key] = p.properties[it.key]
        }
    } 
    o['_id'] = p.id

    db.prefix.update([_id : p.id], o, true, false)
} 
```

似乎从不插入任何东西的版本：

```
def upsertPrefix(Prefix updatedPrefix) {
     Prefix existingPrefix = Prefix.findOrCreateById(updatedPrefix.id)
     updatedPrefix.properties.each { prop ->
          if (! prop.key in ['dbo', 'id']) { // You don't want to re-set the id, and dbo is r/o
                existingPrefix.properties[prop.key] = prop.value
          }
    }
    existingPrefix.save() // Never seems to insert anything
} 
```

仍然因重复键错误而失败的版本：

```
def upsertPrefix(p) {
    def existing = Prefix.get(p.id)
    if (existing != null) {
        p.properties.each { prop ->
            print prop.key
            if (! prop.key in ['dbo', 'id']) { 
                existingPrefix.properties[prop.key] = prop.value
            }
        }
        existing.save(flush:true) // Still fails with duplicate key error
    } else {
        p.save(flush:true)
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:04:46.590

假设您有对象的更新版本，或者需要使用新值更新的属性映射，您可以遍历这些并为每个属性应用更新。

像这样的东西：

```
def upsert(Prefix updatedPrefix) {
    Prefix existingPrefix = Prefix .findOrCreateById(updatedPrefix.id)
    updatedPrefix.properties.each { prop ->
        if (prop.key != 'id') { // You don't want to re-set the id
            existingPrefix.properties[prop.key] = prop.value
        }
    }
    existingPrefix.save()
} 
```

如何排除更新 ID 可能不太正确，因此您可能需要尝试一下。如果相应的新值与现有值不同，您也可以考虑仅更新属性，但这本质上只是一种优化。

如果您有地图，您也可以考虑按照默认控制器脚手架的方式进行更新：

```
prefixInstance.properties = params 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:35:41.223

MongoDB 原生支持 upsert。请参阅带有 upsert 参数 true的[findAndModify 命令。](http://www.mongodb.org/display/DOCS/findAndModify+Command)

# ios - ios - 在 segueys 上使用 UINavigationController 有什么影响？

> ID：11784089
> 
> 赞同：0
> 
> 时间：2012-08-02T19:02:20.997
> 
> 标签：ios, ios5

我有一个几乎所有事情都使用 UIViewControllers 的应用程序。到目前为止，当有按钮点击或某些逻辑之后我必须显示一个新屏幕时，我一直在使用 push segueys。

有时它可以工作，有时我会出现奇怪的行为，即下一页加载并卡住，并且其导航栏区域未加载。

我使用这段代码：

```
BusinessController *businessController = [[UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil] instantiateViewControllerWithIdentifier:@"BusinessController"];
[self presentModalViewController:businessController animated:YES]; 
```

我一直在阅读我可能应该使用模态 seguey，但我不确定哪个更好。

此外，我一直在阅读，如果我想推送，我需要将我的控制器嵌入 NavigationConroller，但我不确定这会对我的应用程序的其余部分产生什么影响。

请帮助我了解对我来说正确的方法是什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:38:23.743

For the record....

If you're creating segues you ought to use them, either by linking them to a control so that they activate automatically or by calling `performSegueWithIdentifier:sender:`. (As a general statement, modal controllers are an interruption of program flow while pushed controllers are like a stack you move though back and forth.)

# php - 让 Netbeans 识别 PHP HEREDOC 中的 HTML 标签

> ID：11784090
> 
> 赞同：2
> 
> 时间：2012-08-02T19:02:22.463
> 
> 标签：php, netbeans, heredoc

我试过用谷歌搜索这个，但我找不到任何关于它的信息。有没有办法让 Netbeans 将 HEREDOC 中的 HTML 标签识别为 HTML 标签？例如，如果我这样做：

```
echo <<<EOHTML
<table>
  <tr></tr>
EOHTML; 
```

Netbeans 没有抱怨这一点，也没有说您可能想像在 HTML 编辑器中那样关闭 table 标记。有没有办法启用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:20:15.863

这是 NetBeans 中记录的错误：http: //netbeans.org/bugzilla/show_bug.cgi?id= [125684](http://netbeans.org/bugzilla/show_bug.cgi?id=125684)

# jquery - 在附加后立即获取 jquery .append 元素的属性

> ID：11784091
> 
> 赞同：0
> 
> 时间：2012-08-02T19:02:33.907
> 
> 标签：jquery

这就是我所拥有的

```
var path = $('#sprite').css('background-image').replace('url', '').replace('(', '').replace(')', '').replace('"', '').replace('"', '')
var tempImg = '<img id="tempImg" src="' + path + ' "/>';
$('body').append(tempImg); 
alert($('#tempImg').width()); 
```

结果是`0`，但是如果我进入控制台并输入`$('#tempImg').width()`，我们会得到正确的宽度。

那么，看起来附加只是在执行代码后“加载”，我需要在附加项目后使用我的代码，有没有办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:05:36.990

您必须等到图像加载完毕。

```
var path = $('#sprite').css('background-image').replace('url', '').replace('(', '').replace(')', '').replace('"', '').replace('"', '');
var tempImg = new Image();
tempImg.id = "tempImg";
$(tempImg).load(function(){
    $('body').append(tempImg);
    alert($(tempImg).width());
});
tempImg.src = path; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:35:39.600

感谢这里的一些评论和答案，我成功实现了我的目标

```
 frame_width = $('#sprite').width();

var path = $('#sprite').css('background-image').replace('url', '').replace('(', '').replace(')', '').replace('"', '').replace('"', '')
var tempImg = '<img id="tempImg" src="' + path + ' "/>';
    $('body').append(tempImg); 
    $('#tempImg').load(function(){
        alert($("#tempImg").width());
    }); 
```

这有效并提醒了正确的价值谢谢大家

# perl - 包应该全局“使用”还是从需要它们的函数中“使用”？

> ID：11784096
> 
> 赞同：3
> 
> 时间：2012-08-02T19:03:08.160
> 
> 标签：perl

如果这个问题不适合 StackOverflow，我们深表歉意。我怀疑答案主要是见仁见智（除非其中一个风格指南有推荐）。

我有看起来像这样的代码

```
use File::Temp;

sub foo {
    ...
}
sub bar {
    ...
}
sub baz {
    my $fh = tempfile();
    ...
} 
```

`baz`是唯一使用的子程序，`File::Temp`我没有使用 AutoLoader。`use`将声明放在里面是否合理`baz`，还是应该将其放在脚本的顶部？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:14:56.340

由于（正如 chepner 所说），技术上没有区别，这确实是风格问题。

将所有内容放在首位的优点：

*   乍一看清楚所有直接模块依赖项是什么

*   更易于维护 - 如果您需要使用库移动代码，则无需记住移动库。

    请注意，相同的确切逻辑也适用于变量声明，但在这种情况下，范围问题严重胜过“记住移动声明”问题，因此您应该在最内部可能的范围内声明变量，尽可能靠近它们的使用位置尽可能。

*   对于您自己的代码在块中包含复杂逻辑的深奥情况，这些逻辑`BEGIN{}`取决于所有正在加载的库（例如，从所有加载的库中调用一个特别命名的方法 - 我已经这样做了） - 如果某个库的`use`调用是 AFTER那个`BEGIN{}`街区

将它们全部放在首位的缺点：

*   有人可能会争辩说，这会降低代码的可读性，因为您需要查找文件的开头以查看从模块中导入的内容。坦率地说，我不相信这一点，但我听说过它，它至少有一些优点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:05:26.507

`use`本质上与将`require`语句放在`BEGIN`块中相同，因此将它们放在哪里并不重要；它们在您的任何其他代码之前进行评估。

# java - 如何使用 java 为测验系统制作秒表

> ID：11784099
> 
> 赞同：-4
> 
> 时间：2012-08-02T19:03:17.303
> 
> 标签：java, applet, keyevent

我真的很困，感谢我的大学。我需要 Java 中的代码来`Stopwatch`显示时间的`00:00:00(mm:ss:msms)`格式。我想使用 Key 事件来运行、暂停和重置计时器。就像我按 S 秒表开始，P 暂停，R 重置一样。问题是我还想在团队的数字上添加关键事件，比如如果我按 1，“团队 1”会闪烁，最好是哔哔声，依此类推`2` `3` `4` `5`。我无法理解如何做到这一点。

我写这个是为了在第二个打印时间只是为了尝试......

```
import java.awt.event.*;
import javax.swing.*;

public class StopWatch2 extends JLabel
            implements KeyListener, ActionListener {

   private long startTime;                           

   private boolean running;  
   private Timer timer;  
   public StopWatch2() {
             super("  Press S  ", JLabel.CENTER);
      addKeyListener(this);
   }

   public void actionPerformed(ActionEvent evt) {

       long time = (System.currentTimeMillis() - startTime) / 1000;
       setText(Long.toString(time));
   }

   public void keyPressed(KeyEvent e) {

          int keyCode=e.getKeyCode();
      if (keyCode==KeyEvent.VK_S) {
                     running = true;
         startTime = e.getWhen(); 
         setText("Running:  0 seconds");
         if (timer == null) {
            timer = new Timer(100,this);
            timer.start();
         }
         else
            timer.restart();
      }
      if(keyCode==KeyEvent.VK_P)
      {

         timer.stop();
         running = false;
         long endTime = e.getWhen();
         double seconds = (endTime - startTime) / 1000.0;
         setText("Time: " + seconds + " sec.");
      }
   }
   public void keyTyped(KeyEvent e)
   {}
   public void keyReleased(KeyEvent e)
   {}

} 

import java.awt.*;
import javax.swing.*;

public class Test2 extends JApplet {

   public void init() {

      StopWatch2 watch = new StopWatch2();
      watch.setFont( new Font("SansSerif", Font.BOLD, 24) );
      watch.setBackground(Color.white);
      watch.setForeground( new Color(180,0,0) );
      watch.setOpaque(true);
      getContentPane().add(watch, BorderLayout.CENTER);

   }

} 
```

我在自己的 nm 上尝试一些东西，几乎是自学的，所以我无法理解出了什么问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:39:47.913

你的意思是这样的：

```
/**
 * Stopwatch is a simple timer.
 */
public class Stopwatch {

    /**
     * Stopwatch() Initialises a stopwatch.
     */
    public Stopwatch() {
        // Your code here.
    }

    /**
     * elapsed() The elapsed time in milliseconds shown on the stopwatch.
     *
     * @return double  The elapsed time in milliseconds as a double.  Returns -1.0 if no meaningful
     * value is available, i.e. if the watch is reset or has been started and not stopped.
     */
    public double elapsed() {
        // Your code here.
    }

    /**
     * start() Starts the stopwatch and clears the previous elapsed time.
     */
    public void start() {
        // Your code here.
    }

    /**
     * stop() If the stopwatch has been started this stops the stopwatch and calculates the
     * elapsed time.  Otherwise it does nothing.
     */
    public void stop() {
        // Your code here.
    }

    /**
     * reset() Resets the stopwatch and clears the elapsed time.
     */
    public void reset() {
        // Your code here.
    }

    @Override
    public String toString() {
        // Your code here.
    }

} // end class Stopwatch 
```

# java - ZipInputStream.getNextEntry() 是如何工作的？

> ID：11784102
> 
> 赞同：18
> 
> 时间：2012-08-02T19:03:44.257
> 
> 标签：java, zip

假设我们有如下代码：

```
File file = new File("zip1.zip");
ZipInputStream zis = new ZipInputStream(new FileInputStream(file)); 
```

假设您有一个包含以下内容的 .zip 文件：

*   zip1.zip
    *   你好ç
    *   世界.java
    *   文件夹1
        *   foo.c
        *   酒吧.java
    *   foob​​ar.c

zis.getNextEntry() 将如何迭代呢？

它会返回 hello.c、world.java、folder1、foobar.c 并完全忽略 folder1 中的文件吗？

或者它会返回 hello.c、world.java、folder1、foo.c、bar.java，然后是 foobar.c？

它甚至会返回 folder1，因为它在技术上是一个文件夹而不是一个文件？

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-02T19:19:07.027

走着瞧：

```
 ZipInputStream zis = new ZipInputStream(new FileInputStream("C:\\New Folder.zip"));
        try
        {
            ZipEntry temp = null;
            while ( (temp = zis.getNextEntry()) != null ) 
            {
             System.out.println( temp.getName());
            }
        } 
```

输出：

> 新建文件夹/
> 
> 新建文件夹/folder1/
> 
> 新建文件夹/folder1/bar.java
> 
> 新建文件夹/folder1/foo.c
> 
> 新建文件夹/foobar.c
> 
> 新建文件夹/hello.c
> 
> 新文件夹/world.java

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-02T19:13:21.553

是的。它也会打印文件夹名称，因为它也是 zip 中的一个条目。它还将按照在 zip 中显示的顺序打印。您可以使用以下测试来验证您的输出。

```
public class TestZipOrder {
    @Test
    public void testZipOrder() throws Exception {
        File file = new File("/Project/test.zip");
        ZipInputStream zis = new ZipInputStream(new FileInputStream(file));
        ZipEntry entry = null;
        while ( (entry = zis.getNextEntry()) != null ) {
         System.out.println( entry.getName());
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:13:30.967

摘自：[https ://blogs.oracle.com/CoreJavaTechTips/entry/creating_zip_and_jar_files](https://blogs.oracle.com/CoreJavaTechTips/entry/creating_zip_and_jar_files)

java.util.zip 库为 ZipOutputStream 添加的条目提供了某种程度的控制。

首先，**将条目添加到 ZipOutputStream 的顺序是它们在 .zip 文件中的物理位置顺序**。

**您可以操作 ZipFile 的 entries() 方法返回的条目枚举，以按字母顺序或大小顺序生成列表，但条目仍按写入输出流的顺序存储。**

所以我相信你必须使用 entry() 方法来查看迭代的顺序。

```
 ZipFile zf = new ZipFile("your file path with file name");
    for (Enumeration<? extends ZipEntry> e = zf.entries();
    e.hasMoreElements();) {
      System.out.println(e.nextElement().getName());
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T19:19:09.243

zip 文件内部目录是 zip 中所有文件和目录的“平面”列表。 `getNextEntry`将遍历列表并按顺序识别 zip 文件中的每个文件和目录。

zip 文件格式的一种变体没有中央目录，在这种情况下（如果它被处理的话）我怀疑你会遍历 zip 中的所有实际文件，跳过目录（但不跳过目录中的文件）。

# java - 在 Servlet 中创建会话并在 JSP 页面中使用？

> ID：11784108
> 
> 赞同：0
> 
> 时间：2012-08-02T19:04:06.957
> 
> 标签：java, session, servlets

我想在 CheckForLogin Servlet 中创建会话并在所有 JSP 页面中使用它（用于检查）。应该在我的 JSP 页面中写什么，而不是在 Sevlet 中写……。如何在 Servlet 中定义会话？

```
public void service(ServletRequest request,
                    ServletResponse response) throws ServletException, IOException {

    String email = request.getParameter("email");
    String password = request.getParameter("password");
    if (email.equals("") || password.equals("") || email == null || password == null) {
        request.getRequestDispatcher("Error.jsp?err=enterdata").forward(request,response);
    } else {
        UserBl userBl = new UserBl();
        if (userBl.checkUser(email, password)) {
            ..........................
             request.getRequestDispatcher("Home.jsp").forward(request, response);
        } else {
            request.getRequestDispatcher("Error.jsp?err=nulluser").forward(request, response);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T09:48:31.840

我应该在方法参数中编写 HttpServletRequest 而不是 ServletRequest 和 HttpServletResponse 而不是 ServletResponse 然后创建会话并访问会话

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:08:21.760

`session`是 jsp 隐式变量，您可以使用它在 JSP 页面中获取会话。

例子：

```
 <%
      String temp=session.getAttribute( "tvName");
    %> 
```

或使用 EL

```
<c:out value="${session.getAttribute("name")}"/> 
```

注意：在 JSP 页面中使用 scriptlet 不是好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:10:28.173

实际上你可以使用`<%= request.getSession() %>`例如。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T06:42:37.660

你应该使用这条线

```
Session httpsession = request.getSession(); 
```

如果该对象不存在，此行将为您创建一个新的会话对象，否则它将返回与同一客户端关联的现有会话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T19:29:06.853

`${sessionScope.sessionAttributeName}`在 JSP 代码中的表达式语言中使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-02T19:32:58.253

我建议你使用`include`而不是`forward`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-12T05:52:47.110

获取现有会话使用

`HttpSession session=request.getSession(false);`

# ruby - 在 Ruby 中检测操作系统

> ID：11784109
> 
> 赞同：48
> 
> 时间：2012-08-02T19:04:08.737
> 
> 标签：ruby, operating-system, detection, sketchup

有没有办法在 ruby​​ 中检测操作系统？我正在开发一个需要检测 Mac 与 Windows 的 SketchUp 工具。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-12-14T04:38:36.350

您可以使用`os`宝石：

```
gem install os 
```

接着

```
require 'os'
OS.linux?   #=> true or false
OS.windows? #=> true or false
OS.java?    #=> true or false
OS.bsd?     #=> true or false
OS.mac?     #=> true or false
# and so on. 
```

见：[https ://github.com/rdp/os](https://github.com/rdp/os)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-11-27T14:13:10.627

这是我最近看到的最好的一个。它来自硒。我认为它是最好的原因是它使用了 rbconfig host_os 字段，该字段具有在 MRI 和 JRuby 上工作的优势。RUBY_PLATFORM 将在 JRuby 上显示“java”，而不管它运行的主机操作系统如何。您将需要稍微调整此方法：

```
 require 'rbconfig'

  def os
    @os ||= (
      host_os = RbConfig::CONFIG['host_os']
      case host_os
      when /mswin|msys|mingw|cygwin|bccwin|wince|emc/
        :windows
      when /darwin|mac os/
        :macosx
      when /linux/
        :linux
      when /solaris|bsd/
        :unix
      else
        raise Error::WebDriverError, "unknown os: #{host_os.inspect}"
      end
    )
  end 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-08-02T19:07:45.223

您可以使用

`puts RUBY_PLATFORM`

```
irb(main):001:0> RUBY_PLATFORM
=> "i686-linux" 
```

但是@Pete 是对的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-02T19:11:10.790

您可以检查**RUBY_PLATFORM**常量，但已知在某些情况下这是不可靠的，例如在运行 JRuby 时。其他选项包括在 POSIX 系统上捕获`uname -a`命令的输出，或使用检测 gem，例如[sys-uname](https://github.com/djberg96/sys-uname)。

# javascript - “未捕获的 ReferenceError：未定义自动调整大小”

> ID：11784113
> 
> 赞同：0
> 
> 时间：2012-08-02T19:04:18.217
> 
> 标签：javascript

下面是我的 Javascript 文档，它在`$(document).ready()`. Javascript 是从我网站的页脚加载的。为简化起见，我`[...]`替换了不相关的代码。

```
// When the document is ready, run the display scripts
$(document).ready(function() {

// Define the frame height functions
function getDocHeight(doc) {
    [...]
}
document.domain = 'mysite.com';

function resizeIframe() {setIframeHeight('date-price-book');}

function setIframeHeight(ifrm) {
    [...]
}

function AutoResize() {
    resizeIframe();
    resizeIframe();
    setTimeout("AutoResize()", 500);
}

AutoResize();

[... more Javascript code...] 
```

当我运行页面时，我收到错误：`Uncaught ReferenceError: AutoResize() is not defined`.

我可以通过注释掉该行`AutoResize();`（上面示例代码中的最后一行）来阻止此错误的发生。但是为什么会抛出这个错误呢？肯定 AutoResize() 函数刚刚在它上面的行中定义了吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:10:19.297

```
setTimeout("AutoResize()", 500); 
```

执行上面的 setTimeout 时，它会在全局范围内评估字符串。AutoResize() 隐藏在闭包内，因此找不到。

使用名称分配对函数的引用。

```
setTimeout(AutoResize, 500); 
```

另一个选项是闭包

```
setTimeout(function() { AutoResize(); }, 500); 
```

如果要向函数发送参数，可以使用闭包方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:10:37.550

因为您在闭包`AutoResize`内部定义`$(document).ready(function () { ... } );`，所以它在全局范围内不可用（这很好）。

当您在调用时使用字符串而不是函数引用`setTimeout`（这很糟糕）时，假设该字符串将解析为的函数调用是全局可用的（因为`setTimeout`在`window`/global 范围内运行）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-02T19:20:00.427

我不知道。当我尝试这部分时它会起作用。

```
function AutoResize(){      
    console.log('test');
    setTimeout('AutoResize()',1000);
}
AutoResize(); 
```

也许是在其他地方出了问题。

# sql - PROC SQL 和 sqldf 的区别

> ID：11784115
> 
> 赞同：5
> 
> 时间：2012-08-02T19:04:30.437
> 
> 标签：sql, r, sas, sqldf

我正在将我通常使用的 SAS 程序重写到 R 中。SAS 程序中的许多语句都是用 proc sql 编写的，所以为了便于编程，我在 R 中使用 sqldf 复制这些语句。所有的 sql 代码sqldf 的工作方式与 SAS 相同，但以下语句除外：

SAS：

```
proc sql;
create table merged32 as
select max(ctf) as ctf,
       max(ctms) as ctms,
       max(site_name) as site_name,
       provider_id, npi,
       first_name, middle_name, last_name, specialty,
       address_1, city, state, site_ct, zip, site_key
    from merged2
    group by 9,10,11,12,14,15;
quit;
run; 
```

sqldf：

```
sqldf("select max(ctf) as ctf,
              max(ctms) as ctms,
              max(site_name) as site_name,
              provider_id, npi,
              first_name, middle_name, last_name, specialty,
              address_1, city, state, site_ct, zip, site_key
       from merged2
       group by 9,10,11,12,14,15") 
```

在 SAS 中，它返回一个有 1878 行的数据集；在 sqldf 中，一个 1375 的数据框。

proc sql 和 sqldf 之间是否存在任何可能导致此问题的主要差异，或者通常需要考虑这些差异？我没有提供数据，因为 1）数据集很大，2）我更感兴趣的是了解两个 sql 系统之间的差异。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:43:01.770

不确定 sqldf，但为了获得有意义的结果，您应该按 SQL 中的所有关键变量进行分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T18:03:23.030

SAS 中的结果可能有重复记录，而 R 中的结果没有

# sql - VS中表的属性用C#编码

> ID：11784117
> 
> 赞同：0
> 
> 时间：2012-08-02T19:04:38.817
> 
> 标签：sql, key

我有这张桌子：

![在此处输入图像描述](../Images/f97202ff10e57f7ab6c206d8bdbdfea8.png)

请不要介意，因为它是我的母语，没关系..

这些都是表中的所有属性，但是当我去 Visual StudioS 并尝试使用其中的一些时，我得到了这个：

![在此处输入图像描述](../Images/d78e2f843c91fbbae703201548a5d2ab.png) ![在此处输入图像描述](../Images/3c2ffdb670197ef1d9d858cb346826cc.png) ![在此处输入图像描述](../Images/c268e8e3ebdb6a1d139b62b203f1f89a.png)

我在 VS 中看到所有“正常”属性，但那些 FK 属性在哪里？我需要他们比较几个并获得价值吗？

我不能从其他表的名称 [dot] 属性等中使用它......例如：

我需要这个： `table1.ID == table2.ID` 而不是这个： `table1.ID == table1.table2.ID`

SQL表中显示的VS中的FK属性在哪里或是什么？

```
public void setParametri(int desID)
    {

        foreach (desavanje d in DM_Class.dc.desavanje)
           if (d.desavanjeID == desID)
            {

                //THIS FIRST 4 LINES WORKS PERFECTLY
                this.naziv_des = d.naziv_des;
                this.datum_po = d.datum_pocetka.ToString();
                this.datum_zav = d.datum_kraja.ToString();
                this.cijena = d.cijena_des;

                //foreach (klijenti k in DM_Class.dc.klijenti)
                //{
                //    if(k.klijentID == //WHAT TO PUT HERE TO COMPARE VALUE klijentID from tables klijenti with FK value in table desavanje)
                //        this.klijent = k.Ime + ' ' + k.Prezime;
                //}

               //ON THIS LINE I'M GETTING ERROR - Object reference not set to an instance of an object. but why? 
               //I have data on that field in DB ? 
                 //this.grad = d.mjesto_desavanja.gradovi.naziv_grada.ToString();              
                //this.mjesto = d.mjesto_desavanja.naziv_objekta;
                //this.organizator = d.organizator.Ime + ' ' + d.organizator.Prezime;
                //this.tip = d.tip_desavanja.vrsta_des;
                this.klijent = d.klijenti.Ime + ' ' + d.klijenti.Prezime;
                //this.status = d.status_desavanja.naziv_statusa;
                //this.br_gost = d.specifikacija_desavanja.br_osoba;

            }
        } 
```

如果有其他解决方案来获取属性值我愿意在不使用另一个 foreach 循环的情况下尝试它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T19:11:26.983

好的，我管理了这个。我使用了一个 linq 查询来生成我需要的数据，并且在这些查询中我比较了所需的 ID，最后得到了一些工作的东西。

# c# - 使用不同页面处理选项卡内的子选项卡-asp .net mvc 3

> ID：11784119
> 
> 赞同：0
> 
> 时间：2012-08-02T19:04:44.710
> 
> 标签：c#, asp.net-mvc-3, tabs

我正在自学asp .net mvc3。我想创建一个用户帐户页面，其中包含 3 个选项卡 - 例如 YourAddress、YourPhotos 和 YourProfile。

第三个选项卡（YourProfile）还有 2 个子选项卡... ChangeDetails 和 DeactiaveAccount。

它们都是动态页面，因此我想将它们保留为单独的页面。

基本上，网址是：

```
localhost/MyHome/YourAddress
localhost/MyHome/YourPhotos
localhost/MyHome/YourProfile/ChangePassword
localhost/MyHome/YourProfile/DeactivateAccount 
```

（根据要求，我已将通用 tab1、tab2 等更改为真实场景中的内容）

我打算做这样的事情：

```
public class MyHomeController : Controller
    {
        //
        // GET: /MyHome/Tab1

        public ActionResult Tab1()
        {
            return View();
        }

        //
        // GET: /MyHome/Tab2

        public ActionResult Tab2()
        {
            return View();
        }

        //
        // GET: /MyHome/Tab3

        public ActionResult Tab3()
        {
            return View();
        }
    } 
```

如何处理 YourProfile 的子选项卡？如何在控制器中调用控制器？

实现这一目标的最佳方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:28:04.543

对控制器中的每个选项卡项都有单独的操作方法。

```
public class MyHomeController : Controller
{
  public ActionResult YourAddress()
  {
     return View();
  }
  public ActionResult YourPhotos()
  {
     return View();
  }
  public ActionResult YouProfile()
  {
     return VieW();
  }
  public ActionResult ChangePassword()
  {
     return View();
  }
  public ActionResult DeActivate()
  {
     return View();
  }
} 
```

对于子选项卡内容，在 global.asax 中定义该路由

```
routes.MapRoute("ChangePass","YourProfile/ChangePassword", 
                      new { controller="MyHome", action="ChangePassword" });
routes.MapRoute("DeActivate","YourProfile/DeActivate", 
                      new { controller="MyHome", action="DeActivate" });
routes.MapRoute(
           "Default", 
           "{controller}/{action}/{id}", 
           new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

始终使用`Url.Action`Html Helper 方法来呈现操作方法的路径。

```
<div id="tabs"> 
    <ul> 
        <li><a href="@Url.Action("YourAddress","MyHome")">Address</a></li>
        <li><a href="@Url.Action("YourPhotos","MyHome")">Photos</a></li>
    </ul>
</div> 
```

# r - 如何更改箱线图的边界颜色？

> ID：11784120
> 
> 赞同：8
> 
> 时间：2012-08-02T19:04:46.783
> 
> 标签：r, boxplot

我想像这样创建箱线图：![在此处输入图像描述](../Images/c6fbb032c86932aa928f259888d0c5fc.png)

该图由 lattice 包中的 bwplot 创建。而不是使用这个功能，我希望使用箱线图来绘制类似的东西。

我注意到在箱线图中我们只能改变箱体的颜色，如何通过箱线图函数改变箱体的边界颜色？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-02T19:18:32.060

查看`?boxplot`以发现有一个参数`border=`可以满足您的要求。例如：

```
boxplot(count ~ spray, data = InsectSprays, col = "lightgray",
        border=c("blue", "green", "blue", "green", "blue", "green")) 
```

![在此处输入图像描述](../Images/2b2da665aca01b8e5117a6c8b114163b.png)

# c - 我的 fget 有分段错误？

> ID：11784124
> 
> 赞同：0
> 
> 时间：2012-08-02T19:05:06.267
> 
> 标签：c, segmentation-fault

看来我的程序有问题导致错误，并且在尝试调用 fgets 后立即卡住。我可能是错的，但这似乎停止了，所以有人知道问题是什么吗？

该文件有我的标题，其中包含定义和结构，主要用于对完整列表进行排序。

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#include"compare.h"
#define BLOCK 2

int input_record(record *rec, record_list *list);
void list_init(record_list *list);
void list_destroy(record_list *list);
void list_print(record_list *list);
int check_args(const char arg1[], const char arg2[], record_list *list);

int main(int argc, char *argv[]){
record_list list;
record rec;
char arg1[3];
char arg2[3];

/*check for proper number of arguments*/
if(argc > 3 || argc < 1){
    return 0;
}
/*run default if no switches*/
if(argc == 1){
    input_record(&rec, &list);
} else {

    strcpy(arg1, argv[1]);
    strcpy(arg2, argv[2]);
    arg1[3] = '\0';
    arg2[3] = '\0';

    input_record(&rec, &list);
    if(check_args(arg1, arg2, &list) == 0){
        printf("error");
    }
}

list_print(&list);
list_destroy(&list);

return 0;
}

int input_record(record *rec, record_list *list){
    int score;
    int min = -1;
    int max = 101;
    int count = 0;
    char first_name[NAMESIZE];
    char last_name[NAMESIZE];
    char temp[LINESIZE];
    record *nrec;

    list_init(list);

    for(count = 0; count < NLINES; count++){
        printf("Enter first name, last name, score\n");
/* !! seg fault occurs once i enter the data !! */
        if(fgets(temp, LINESIZE, stdin) == 0){
            break;
        }
        printf("222222");
        if(sscanf(temp, "%s %s %d", first_name, last_name, &score) == 3){
            if(strlen(first_name) >= NAMESIZE || strlen(last_name) >= NAMESIZE){
                printf("error");
                continue;
            }              
            if(score < min || score > max){
                printf("error");
                continue;
            }
        }

record *tempRec;

        if(list->nalloc == 0){
            tempRec = malloc(sizeof(record));
            if(tempRec == 0){
                return 0;
            }
            #ifdef DEBUG
                fprintf(stderr, "#\n");
            #endif
            list->nalloc = 1;
            list->data = tempRec;

            }else if(list->nalloc == list->nused){
                tempRec = realloc(list->data, (list->nalloc*BLOCK) * sizeof(record));
                if(tempRec == 0){
                    return 0;
                }
            list->data = tempRec;
            list->nalloc *= BLOCK;  
        }

        list->data[list->nused] = *rec;
        strcpy(rec->name.first, first_name);
        strcpy(rec->name.last, last_name);
        rec->score = score;
        list->nused++;    
    }
return 1;
}

void list_init(record_list *list){
list->nused = 0;
list->nalloc = 0;
list->data = 0;
}

void list_destroy(record_list *list){
free(list->data);
list->nalloc = 0;
list->nused = 0;
}

void list_print(record_list *list){
int count;
int listsize = sizeof(list);

for (count = 0; count < listsize; count++){
    printf("%s %s %d", list->data[count].name.last, list->data[count].name.first, list->data[count].score);
}
}

int check_args(const char arg1[], const char arg2[], record_list *list){
char nameDown[] = "-n";
char nameUp[] = "+n";
char scoreDown[] = "-s";
char scoreUp[] = "+s";

/*if either argument is not one of the valid switches, kill function*/
if((strcmp(arg1, nameDown) != 0) || (strcmp(arg1, nameUp) != 0) || (strcmp(arg1, scoreDown) != 0) || (strcmp(arg1, scoreUp) != 0)){
    return 0;
}

if((strcmp(arg2, nameDown) != 0) || (strcmp(arg2, nameUp) != 0) || (strcmp(arg2, scoreDown) != 0) || (strcmp(arg2, scoreUp) != 0)){
    return 0;
}

/*if the arguments are the same, kill function*/
if (strcmp(arg1, arg2) == 0){
        return 0;
/*otherwise look for all combinations of valid switches*/
} else if (strcmp(arg1, nameDown) == 0){
    if (strcmp(arg2, scoreDown) == 0){
        sort_desc_name_desc_score(list->data);
    } else if (strcmp(arg2, scoreUp) == 0){
        sort_desc_name_asc_score(list->data);
    /*if same lettered switches are detected, kill function*/
    } else if (strcmp(arg2, nameUp) == 0){
        return 0;
    } else {
        /*the ps and qs are supposed to be records to be sorted*/
        sort_desc_name(list->data);
    }
} else if (strcmp(arg1, nameUp) == 0){
    if (strcmp(arg2, scoreDown) == 0){
        sort_asc_name_desc_score(list->data);
    } else if (strcmp(arg2, scoreUp) == 0){
        sort_asc_name_asc_score(list->data);
    } else if (strcmp(arg2, nameDown) == 0){
        return 0;
    } else {
        sort_asc_name(list->data);
    }

} else if (strcmp(arg1, scoreDown) == 0){
    if (strcmp(arg2, nameDown) == 0){
        sort_desc_score_desc_name(list->data);
    } else if (strcmp(arg2, nameUp) == 0){
        sort_desc_score_asc_name(list->data);
    } else if (strcmp(arg2, scoreUp) == 0){
        return 0;
    } else {
        sort_desc_score(list->data);
    }

} else if (strcmp(arg1, scoreUp) == 0){
    if (strcmp(arg2, nameDown) == 0){
        sort_asc_score_desc_name(list->data);
    } else if (strcmp(arg2, nameUp) == 0){
        sort_asc_score_asc_name(list->data);
    } else if (strcmp(arg2, scoreDown) == 0){
        return 0;
    } else {
        sort_asc_score(list->data);
    }
/*and in case anything else got through*/
} else {
    return 0;
}

return 1;
} 
```

这就是整个程序，在 input_record 函数中发生了段错误。任何因为这个我还没有能够测试我的代码的其他功能......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:09:13.180

你呼吁`realloc()`过`nrec`，但你从来没有做过`malloc`或做过`calloc`任何事情。

```
nrec = realloc(list->data, (list->nalloc + 1) * sizeof(record)); 
```

您有对 的引用`list`，但您也没有与之关联的内存。因此，一旦您尝试通过`realloc()`.

由于可能存在内存泄漏，如果它没有分配任何内容，则永远不应将任何内存分配的结果直接存储到引用中。更安全的解决方案如下：

```
temp = malloc(SIZE OF DATA);
if(temp == NULL)
{
    priontf("Malloc returned null!\n");
    return -1;
}
nrec = temp; 
```

# sql-server - 在存储过程中使用多个视图

> ID：11784125
> 
> 赞同：0
> 
> 时间：2012-08-02T19:05:10.210
> 
> 标签：sql-server, stored-procedures, views

是否可以从存储过程中的多个视图中进行选择？我试过了，但没有用。b我觉得好像是因为我的实现是错误的。如果有人想看看，这是我的代码。当我将此 sp 添加到 linq 设计器并生成一个结果类时，它只有从 savearticle_v 视图中选择的字段，而不是 tag_v。

```
 ALTER PROCEDURE [dbo].[mobile_GetSavedArticlesAR] 
  -- Add the parameters for the stored procedure here
  @UserID int , 

  @keyword1 varchar(50)='',
  @keyword2 varchar(50)='',
  @keyword3 varchar(50)='',
  @keyword4 varchar(50)='',
  @keyword5 varchar(50)='',
  @Page int=1,
  @PageLen int=20

AS
BEGIN
  -- SET NOCOUNT ON added to prevent extra result sets from
  -- interfering with SELECT statements.
  SET NOCOUNT ON;

    -- Insert statements for procedure here
  declare @RowStart int
  declare @RowEnd int
  IF (@Page=1)
    Begin

      set @RowStart=(@Page-1)*(@PageLen)
      set @RowEnd=(@RowStart+@PageLen);
    END
  ELSE
    BEGIN

      set @RowStart=((@Page-1)*(@PageLen))+1
      set @RowEnd=((@RowStart+@PageLen))-1
    END;
    With myArticles as 
(select ROW_NUMBER() over (ORDER BY userID DESC) as 'RowNumber',*

From savedarticle_v
where UserID=@UserID and
title like '%'+@keyword1+'%' and
title like '%'+@keyword2+'%' and
title like '%'+@keyword3+'%' and
title like '%'+@keyword4+'%' and
title like '%'+@keyword5+'%' 
)

    select 
      rownumber,journalID,journalname,articleID,title,publicationdate,likes,aviews,comments ,medabbr
      from  myArticles where RowNumber Between @RowStart  and @RowEnd;

With myTags as
(select ROW_NUMBER() over (ORDER BY userID DESC) as 'RowNumber',*

From tags_v
where userID=@UserID
)
    select tagtext from myTags where RowNumber Between @RowStart and @RowEnd
END

GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:14:31.080

这与视图无关，而是与您拥有多个结果集存储过程这一事实有关。

[此博客文章](http://blogs.msdn.com/b/swiss_dpe_team/archive/2008/02/04/linq-to-sql-returning-multiple-result-sets.aspx)中描述了一种处理来自 Linq-to-Sql 的多个结果集的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:16:40.660

LINQ 设计器本身并不支持多个行集。

读取多个结果集的可靠方法是常规 ADO.NET`SqlDataReader`及其`NextResult`方法。

比 LINQ 更好的 ORM 是[Dapper](http://code.google.com/p/dapper-dot-net/)。它支持使用该`QueryMultiple`方法的多个结果集。

# c# - 满足我需求的数据访问框架

> ID：11784132
> 
> 赞同：-1
> 
> 时间：2012-08-02T19:05:58.487
> 
> 标签：c#, .net, sql-server, entity-framework, linq-to-sql

我在选择合适的数据访问框架时遇到了麻烦，部分原因是我对自己的偏好非常挑剔，主要是因为我对它们中的大多数都没有太多经验:-)

我需要一个框架，让我可以轻松地在数据库表（SQL Server）和我的实体之间进行映射，并为我处理 CRUD 操作（大部分情况下）。

*   我希望我的实体驻留在与我的 DAL 不同的程序集中。
*   我更喜欢在 XML 等外部文件上使用属性进行映射。
*   它不一定是 ORM，我想自己编码我的实体。
*   我不介意编写存储过程。
*   该项目的数据库不会很大。不到50张桌子。
*   我希望我的一些实体对应于两个表的内部连接 ​​- 一个用于在开发期间手动输入的静态数据，另一个用于在运行时填充的数据 - 不使用相互引用的两个实体（此连接的结果将是一个单一的实体）。
*   Entity Framework 听起来很完美，直到我意识到它不支持 Enums（但是 - 我等不及 EF 5.0）。
*   我希望这些实体包含枚举，并计划使用枚举的查找表 + 枚举的代码生成，以使其与数据库保持同步。
*   Linq-to-SQL 似乎是一个不错的选择，但我不知道它是否能很好地满足我之前的需求。
*   将 Enterprise Library 5.0 DAAB 与它的 RowMapper 一起使用，并扩展其执行更新和插入的能力也是一种选择（但我需要更多的编码）。
*   我计划实施存储库模式。
*   NHibernate 怎么样？会吗？那里也没有经验。

我很高兴听到所有的建议……越多越好！提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:14:02.540

我认为 nHibernate 是要走的路，尽管它的一些主要优势（ORM、存储过程生成等）是您列为非要求的东西。无论如何，nHibernate 会做你想做的一切。从技术上讲，它确实使用了 xml 映射，但是这些可以很容易地使用流畅的属性映射自动生成。我喜欢这个，因为它是为您完成的，但是您也可以进行自定义以防万一。祝你好运！

# ios - 使用音频单元播放音频文件？

> ID：11784133
> 
> 赞同：1
> 
> 时间：2012-08-02T19:05:59.937
> 
> 标签：ios, audio, core-audio, audiounit

[在openframeworks](http://www.openframeworks.cc)和本网站[http://atastypixel.com/blog/using-remoteio-audio-unit](http://atastypixel.com/blog/using-remoteio-audio-unit)的帮助下，我使用音频单元成功地将麦克风中的音频录制到音频文件中。

我希望能够将文件流式传输回音频单元并播放音频。根据[Play an audio file using RemoteIO and Audio Unit](https://stackoverflow.com/questions/2575651/play-an-audio-file-using-remoteio-and-audio-unit)我可以使用 ExtAudioFileOpenURL 和 ExtAudioFileRead。但是，如何在缓冲区中播放音频数据？

这是我目前拥有的：

```
static OSStatus setupAudioFileRead() {
    //construct the file destination URL
    CFURLRef destinationURL = audioSystemFileURL();
    OSStatus status = ExtAudioFileOpenURL(destinationURL, &audioFileRef);
    CFRelease(destinationURL);

    if (checkStatus(status)) { ofLog(OF_LOG_ERROR, "ofxiPhoneSoundStream: Couldn't open file to read"); return status; }

    while( TRUE ) {
        // Try to fill the buffer to capacity.
        UInt32 framesRead = 8000;
        status = ExtAudioFileRead( audioFileRef, &framesRead, &inputBufferList );

        // error check
        if( checkStatus(status) ) { break; }

        // 0 frames read means EOF.
        if( framesRead == 0 ) { break; }

        //play audio???
    }

    return noErr;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-16T02:05:24.837

基本上，1.创建一个RemoteIO单元（参见关于如何创建RemoteIO的参考资料）；

1.  创建一个 FilePlayer 音频单元，它是一个专用的音频单元，用于读取音频文件并将文件中的音频数据提供给输出单元，例如步骤 1 中创建的 RemoteIO 单元。要实际使用 FilePlayer，需要进行很多设置（指定播放哪个文件，播放文件的哪一部分等等）都需要在上面完成；

2.  设置 RemoteIO 单元的 kAudioUnitProperty_SetRenderCallback 和 kAudioUnitProperty_StreamFormat 属性。第一个属性本质上是一个回调函数，RemoteIO 单元从中提取音频数据并播放它。第二个属性必须按照 FilePlayer 支持的 StreamFormat 设置。它可以从 FilePlayer 上调用的 get-property 函数派生。

3.  在步骤 3 中定义回调集，其中最重要的事情是要求 FilePlayer 渲染到回调提供的缓冲区中，您需要在 FilePlayer 上调用 AudioUnitRender()。

4.  最后启动 RemoteIO 单元来播放文件。

以上只是在 iOS 上使用音频单元播放文件的基本操作的初步概述。详情可以参考 Chris Adamson 和 Kevin Avila 的*Learning Core Audio*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:49:34.323

来自作者：[http](http://atastypixel.com/blog/using-remoteio-audio-unit/) ://atastypixel.com/blog/using-remoteio-audio-unit/ ，如果您向下滚动到播放部分，请尝试以下操作：

```
static OSStatus playbackCallback(void *inRefCon, 
                                  AudioUnitRenderActionFlags *ioActionFlags, 
                                  const AudioTimeStamp *inTimeStamp, 
                                  UInt32 inBusNumber, 
                                  UInt32 inNumberFrames, 
                                  AudioBufferList *ioData) {    
    // Notes: ioData contains buffers (may be more than one!)
    // Fill them up as much as you can. Remember to set the size value in each buffer to match how
    // much data is in the buffer.

for (int i=0; i < ioData->mNumberBuffers; i++) 
{ 
    AudioBuffer buffer = ioData->mBuffers[i];
    // copy from your whatever buffer data to output buffer
    UInt32 size = min(buffer.mDataByteSize, your buffer.size); 
    memcpy(buffer.mData, your buffer, size);
    buffer.mDataByteSize = size; // indicate how much data we wrote in the buffer

    // To test if your Audio Unit setup is working - comment out the three 
    // lines above and uncomment the for loop below to hear random noise  
    /*
    UInt16 *frameBuffer = buffer.mData;
    for (int j = 0; j < inNumberFrames; j++) {
        frameBuffer[j] = rand();
    }
    */
}
return noErr;
} 
```

如果您只是寻找从 MIC 录制到文件并播放它，Apple 的[Speakhere](http://developer.apple.com/library/ios/#samplecode/SpeakHere/Introduction/Intro.html)样本可能更适合使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-14T00:57:21.930

这是一种相对简单的方法，它利用了 Tasty Pixel 博客中提到的音频单元。在录音回调中，您可以使用 ExtAudioFileRead 用文件中的数据填充缓冲区，而不是使用来自麦克风的数据填充缓冲区。我将尝试在下面粘贴一个示例。请注意，这仅适用于 .caf 文件。

在 start 方法中调用 readAudio 或 initAudioFile 函数，它只是获取有关文件的所有信息。

```
- (void) start {
readAudio();
OSStatus status = AudioOutputUnitStart(audioUnit);
checkStatus(status);
} 
```

现在在 readAudio 方法中初始化音频文件引用。

```
ExtAudioFileRef fileRef;

void readAudio() {
NSString * name = @"AudioFile";
NSString * source = [[NSBundle mainBundle] pathForResource:name ofType:@"caf"];
const char * cString = [source cStringUsingEncoding:NSASCIIStringEncoding];
CFStringRef str = CFStringCreateWithCString(NULL, cString, kCFStringEncodingMacRoman);
CFURLRef inputFileURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, str, kCFURLPOSIXPathStyle, false);

AudioFileID fileID;
OSStatus err = AudioFileOpenURL(inputFileURL, kAudioFileReadPermission, 0, &fileID);
CheckError(err, "AudioFileOpenURL");

err = ExtAudioFileOpenURL(inputFileURL, &fileRef);
CheckError(err, "ExtAudioFileOpenURL");

err = ExtAudioFileSetProperty(fileRef, kExtAudioFileProperty_ClientDataFormat, sizeof(AudioStreamBasicDescription), &audioFormat);
CheckError(err, "ExtAudioFileSetProperty");
} 
```

既然您手头有音频数据，下一步就很容易了。在recordingCallback 中从文件而不是从麦克风中读取数据。

```
static OSStatus recordingCallback(void *inRefCon,
                              AudioUnitRenderActionFlags *ioActionFlags,
                              const AudioTimeStamp *inTimeStamp,
                              UInt32 inBusNumber,
                              UInt32 inNumberFrames,
                              AudioBufferList *ioData) {

// Because of the way our audio format (setup below) is chosen:
// we only need 1 buffer, since it is mono
// Samples are 16 bits = 2 bytes.
// 1 frame includes only 1 sample

AudioBuffer buffer;

buffer.mNumberChannels = 1;
buffer.mDataByteSize = inNumberFrames * 2;
buffer.mData = malloc( inNumberFrames * 2 );

// Put buffer in a AudioBufferList
AudioBufferList bufferList;
bufferList.mNumberBuffers = 1;
bufferList.mBuffers[0] = buffer;

// Then:
// Obtain recorded samples
OSStatus err = ExtAudioFileRead(fileRef, &inNumberFrames, &bufferList);

// Now, we have the samples we just read sitting in buffers in bufferList
// Process the new data
[iosAudio processAudio:&bufferList];

// release the malloc'ed data in the buffer we created earlier
free(bufferList.mBuffers[0].mData);

return noErr;
} 
```

这对我有用。

# c# - 为什么 C# .NET SortedList 没有 居然有ElementAt？

> ID：11784134
> 
> 赞同：4
> 
> 时间：2012-08-02T19:06:03.787
> 
> 标签：c#, .net, sortedlist

[.NET 3.5 Collections.Generic.SortedList 文档](http://msdn.microsoft.com/en-us/library/ms132320%28v=vs.90%29.aspx)

在文档中，它明确指出“ElementAt”是`SortedList`成员的扩展方法。好吧，我有一个，这样宣布：

```
private SortedList<int, ChainLink> linksByLevel = new SortedList<int, ChainLink>(); 
```

我尝试获取最后一个元素：

```
ChainLink lastLink = linksByLevel.ElementAt(linksByLevel.Count - 1); 
```

编译器会抛出非常有用的*消息*：

> 错误 1 ​​'System.Collections.Generic.SortedList' 不包含 'ElementAt' 的定义，并且找不到接受类型 ' 的第一个参数的扩展方法 'ElementAt' `System.Collections.Generic.SortedList<int,ChainLink>'`（您是否缺少 using 指令或程序集引用？）

我对 Microsoft 的文档和我的编译器缺乏连贯性感到非常沮丧，并且很想吐槽 and 的 API 之间的不一致`SortedList`，`SortedList<T1, T2>`但我怀疑这会给我的问题增加很多价值。相信我，这很令人沮丧：-\

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-02T19:08:25.893

尝试将导入添加到代码文件的顶部：

```
using System.Linq; 
```

您需要指定您正在*使用*包含扩展方法的命名空间，然后才能实际使用扩展方法。因此，正如错误所解释的那样，您缺少 -`using`指令。

如果您确实知道该方法是扩展方法，但您不知道它位于哪个命名空间中，那么您可能需要在线搜索才能找到它。默认情况下，Visual Studio 2012 无法为您解决它。您所说的扩展方法[`Enumerable.ElementAt`](http://msdn.microsoft.com/en-us/library/bb299233.aspx)在`System.Linq`System.Core.dll 的命名空间中。

在 Visual Studio 中，当你创建一个新的类文件时，你会`using System.Linq`自动插入到顶部。[该命名空间](http://msdn.microsoft.com/en-us/library/system.linq.aspx)包含用于处理各种集合（包括列表、字典和数组）的所有[LINQ 扩展方法。](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:08:20.290

你加了吗

```
using System.Linq; 
```

在文件的顶部？

WRT 文档不一致，如果您查看 SortedList 文档，然后单击到 ElementAt，您会在页面顶部清楚地看到您需要包含 System.Linq。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T19:32:36.210

`SortedList`并且`SortedList<K,V>`是非常不同的野兽。

较旧的 SortedList 在幕后使用数组，因此它可以提供高效的索引器。

Beware that when you use the extension method `ElementAt()` it will probably do a 'tablescan', don't use it for something time-critical.

# php - 通过 web 服务上的 php 会话识别 android httpclient

> ID：11784136
> 
> 赞同：0
> 
> 时间：2012-08-02T19:06:08.310
> 
> 标签：php, android, mysql, session

我正在构建一个使用 Web 服务（只是 php 脚本）来查询 mysql 数据库的 android 应用程序。目前没有任何身份验证系统，但我想在用户使用用户名和密码登录 mysqldatabase 后创建 php 会话......问题是目前我与脚本的所有连接都像这样工作：

```
public static long getOnlineAlarm(long taskID) {

    long alarm = -1;

    String result = null;
    InputStream is = null;

    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

    nameValuePairs.add(new BasicNameValuePair("taskID", String.valueOf(taskID)));

    try {
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(
                "http://192.168.1.13/spotnshare/getOnlineAlarm.php");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);

        HttpEntity entity = response.getEntity();
        is = entity.getContent();

    } catch (Exception e) {
        Log.i("taghttppost", "" + e.toString());

    }

    // conversion de la réponse en chaine de caractère
    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "UTF-8"));

        StringBuilder sb = new StringBuilder();

        String line = null;

        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }

        is.close();

        result = sb.toString();
    } catch (Exception e) {
        Log.i("tagconvertstr", "" + e.toString());
    }
    // recuperation des donnees json
    try {
        Log.i("tagconvertstr", "[" + result + "]");

        JSONObject jObj = new JSONObject(result);

        alarm = jObj.getLong("alarm");
        return alarm;

    } catch (JSONException e) {
        Log.i("tagjsonexp", "" + e.toString());
    } catch (ParseException e) {
        Log.i("tagjsonpars", "" + e.toString());
    }

    return alarm;
} 
```

所以我创建了一个新的 DefaultHttpClient(); 每次我使用脚本时，这会成为 php 会话的问题吗？或者服务器可以识别客户端吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:24:32.040

您可以做的是为每个会话使用某种形式的唯一标识符。

基本上，当您登录时对数据库的第一次调用将返回一个 sessionID。然后每次调用都将 sessionID 传递给 php 脚本（在每个 php 脚本上）。这是我见过的用于此类事情的最常见的方法。

# iphone - 在 iPhone 上将多行插入 sqlite db 的最快方法

> ID：11784143
> 
> 赞同：14
> 
> 时间：2012-08-02T19:06:51.633
> 
> 标签：iphone, fmdb

有人能解释一下使用 FMDB 在 iPhone 上插入大量数据的最佳方法是什么吗？我看到了使用 beginTransaction 命令之类的东西。老实说，我不确定 this 或 setShouldCacheStatements 是做什么的。到目前为止，我遵循了我的同事所做的代码，这就是它的样子：

```
BOOL oldshouldcachestatements = _db.shouldCacheStatements;
[_db setShouldCacheStatements:YES];
[_db beginTransaction];
NSString *insertQuery = [[NSString alloc] initWithFormat:@"INSERT INTO %@ values(null, ?, ?, ?, ?, ?, ?, ?);", tableName];
[tableName release];
BOOL success;

bPtr += 2;
int *iPtr = (int *)bPtr;
int numRecords = *iPtr++;

for (NSInteger record = 0; record < numRecords; record++) {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    // Some business logic to read the binary stream  

    NSNumber *freq = aFreq > 0 ? [NSNumber numberWithDouble:100 * aFreq / 32768]: [NSNumber numberWithDouble:-1.0];

    // these fields were calculated in the business logic section
    success = [_db executeUpdate:insertQuery,
               cID,                                                                                                   
               [NSNumber numberWithInt:position],                                                                       
               [NSString stringWithFormat:@"%@%@", [self stringForTypeA:typeA], [self stringForTypeB:typeB]],     // methods are switch statements that look up the decimal number and return a string
               [NSString stringWithFormat:@"r%i", rID],                                                               
               [self stringForOriginal:original],                                                                    
               [self stringForModified:modified],                                                                    
               freq];

    [pool drain];
}
[outerPool drain];

[_db commit];
[_db setShouldCacheStatements:oldshouldcachestatements]; 
```

这是我能做到的最快速度吗？写是sqlite的限制吗？我看到了这个：[http](http://www.sqlite.org/faq.html#q19) ://www.sqlite.org/faq.html#q19并且不确定这个实现是否是最好的 fmdb，或者我是否可以做任何其他事情。其他一些同事提到了一些关于批量插入和优化的事情，但我不确定这意味着什么，因为这是我第一次遇到 sqlite。有什么想法或方向我可以研究吗？谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-07T19:28:11.340

首先，在大多数情况下，如果您没有完全错误地使用 sqlite3，您不必担心它的性能。

以下内容可提高`INSERT`语句的性能：

**交易**

正如您已经提到的，交易是最重要的功能。特别是如果您有大量查询，事务将使**您的 s 加速`INSERT`~10 倍**。

**杂注配置**

Sqlite3 提供了几种机制，可以在最坏的情况下避免数据库损坏。在某些情况下，这不是必需的。在其他情况下，这是绝对必要的。以下 sqlite3 命令可能会加快您的`INSERT`语句速度。您的应用程序的正常崩溃不会损坏数据库，但操作系统崩溃可能会。

```
PRAGMA synchronous=OFF -- may cause corruption if the OS fails
PRAGMA journal_mode=MEMORY -- Insert statements will be written to the disk at the end of the transaction
PRAGMA cache_size = 4000 -- If your SELECTs are really big, you may need to increase the cache
PRAGMA temp_store=MEMORY -- Attention: increases RAM use 
```

**停用指标**

任何 SQL 索引都会减慢`INSERT`语句的速度。检查您的表是否有一些索引：

```
.indices <table_name> 
```

如果是，则在事务后DROP`INDEX`和它。`CREATE`

**一选一**

当您生成新数据时，我看不到使用 BULK 插入的方法。但是，您可以收集数据并只执行一条`INSERT`语句。这可能会显着提高您的性能，但也会增加失败的可能性（例如语法）。一个 hack 遇到另一个 hack：由于 sqlite3 不直接支持这一点，因此您必须使用 UNION 命令相应地收集所有插入语句。

```
INSERT INTO 'tablename'
      SELECT 'data1' AS 'column1', 'data2' AS 'column2'
UNION SELECT 'data3', 'data4'
UNION SELECT 'data5', 'data6'
UNION SELECT 'data7', 'data8' 
```

**语句缓存**

我建议避免使用语句缓存，因为此功能存在[未解决的问题](https://github.com/ccgus/fmdb/issues/6)（据我所知，它不会显着影响性能）。

**内存管理**

我想提的最后一点是关于 ObjC。与基本操作相比，内存管理需要非常非常多的时间。也许你可以避免一些`stringWithFormat:`或`numberWithDouble:`通过在循环外准备这些变量。

**概括**

**总而言之，如果你简单地使用transactions**，我认为你不会对 sqlite3 的速度有问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-02-02T10:16:05.453

我发现很难找到一个关于如何快速插入多行的具体代码示例。在对 FMDB 进行了大量实验并得到上述答案的帮助之后，这就是我目前正在使用的：

```
[_objectController.dbQueue inDatabase:^(FMDatabase *db)
{
    [db open];
    [db setShouldCacheStatements:YES];

    NSArray *documentsJSONStream = responseObject[@"details"][@"stream"];

    static NSString *insertSQLStatment = @"INSERT INTO documents (`isShared`,`thumbnailURLString`,`userID`,`version`,`timestamp`,`tags`,`title`,`UDID`,`username`,`documentURLString`,`shareURLString`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
    [db beginTransaction];
    for (NSDictionary *dJ in documentsJSONStream)
    {
        [db executeUpdate:insertSQLStatment withArgumentsInArray:@[dJ[@"isShared"],dJ[@"thumbnailURLString"],dJ[@"userID"],dJ[@"version"],dJ[@"timestamp"],dJ[@"tags"],dJ[@"title"],dJ[@"UDID"],dJ[@"username"],dJ[@"documentURLString"],dJ[@"shareURLString"]]];
    }
    [db commit];
    [db close];
 }]; 
```

使用 inTransaction 给了我奇怪的 FMDB is not open 错误。如果有任何关于如何改进这一点的建议，请告诉我。

# perl - 如何打印出 HTML：TableExtract 结果？

> ID：11784144
> 
> 赞同：0
> 
> 时间：2012-08-02T19:06:54.503
> 
> 标签：perl

这里是一个愚蠢的问题。我是 Perl 的新手，正在尝试使用 HTML: TableExtract 在线提取一些数据。我从网页上获得了数字，但不知道如何将它们打印到 txt 文件中。我试图打开一个文件但没有成功。这是我使用的代码。谢谢。

```
#!/usr/bin/perl
use Encode qw(decode);
use Encode;
use Encode::HanExtra;
use Encode::HanConvert;
use strict;
use warnings;

chdir("C:/perlfiles/test") || die "cannot cd ($!)";

my $file = "tokyo.html";
use HTML::TableExtract;
open my $outfile, '>', "tokyo.txt" or die 'Unable to create file';

my $label = 'by headers';
 my $te = HTML::TableExtract->new(headers => [qw(number city)]);

$te->parse_file($file);

foreach my $ts ($te->tables) {
   print "Table (", join(',', $ts->coords), "):\n";
   foreach my $row ($ts->rows) {
      print $outfile join(",", @$row),"\n";
   }
}

close $outfile; 
```

怎么了？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:58:16.950

使用`>>`而不是`>`. `>`每次都会覆盖最后一个文件，所以如果你结束 for 循环迭代没有返回值，你最终会得到一个空白文件。`>>`附加到`EOF`现有文件的，从而保留先前写入的数据。

```
open (OUT,'>>tokyo.txt') or die 'Unable to create file'; 
```

所以这样的事情可能会奏效。

```
open (OUT,'>>tokyo.txt') or die 'Unable to create file';
....
....
foreach my $row ($ts->rows) {
      print OUT join(",", @$row) . "\n";
   }
....
close OUT; 
```

此外，您的文件句柄不太正确`my $outfile`。文件句柄应该使用使用的文件句柄“标记”与外部文件的连接。在您的情况下`$outfile`是一个变量并且不包含任何值！因此没有标签，因此文件不会打开。您必须使用类似`OUT`（如我所做的）或`OUTFILE`等之类的东西突出地标记 perl 与外部文件的连接，并在代码中使用此文件句柄来编写、读取关闭文件等。

# c# - 如何防止或从工作线程上的堆栈溢出中恢复？

> ID：11784149
> 
> 赞同：5
> 
> 时间：2012-08-02T19:07:04.520
> 
> 标签：c#, .net, multithreading, stack-overflow

我遇到了一种情况，根据小型转储，某些文件导致递归下降解析器中的堆栈溢出。不幸的是，我无法获得一个这样做的文件示例以重现问题（客户有保密问题），这让我目前在诊断真正的问题时有点手足无措。

显然解析器需要一些关注，但现在我的首要任务是保持程序运行。作为权宜之计，我能做些什么来防止这导致整个程序崩溃？

我的第一选择是找到某种方法来预测我的堆栈空间不足，这样我就可以在溢出发生之前优雅地中止解析器。无法解析文件是可接受的选项。第二种选择是让它发生，捕获错误并记录它，然后继续处理其余数据。

解析是在`Parallel.ForEach()`循环中发生的。如果有帮助，我愿意将其换成其他方法。

**编辑：** 如果我能得到当前线程堆栈的大小和堆栈指针的位置，那将是真正的杀手。这可能吗？

**编辑 2：** 我终于设法从某人身上提取了一个示例文件，并在调试器中捕获了错误。事实证明，它根本不是属于我们的代码——异常发生在[HtmlAgilityPack](http://html-agility-pack.net/?z=codeplex)的某个地方。所以看起来我将不得不尝试找到一个完全不同的策略。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:13:03.000

Stack 在桌面 CLR 上默认有 1 MB 的限制，但您[可以增加它](http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/22/increasing-the-size-of-your-stack-net-memory-management-part-3.aspx)。

您可以使用[延续传递样式](http://en.wikipedia.org/wiki/Continuation-passing_style)来使用堆而不是堆栈。

在 C# 5.0 中，编译器提供了异步机制来自动执行此过程。我还没有在最新版本中尝试过这个。正如 Alex 所提到的，C# 中不支持尾调用优化，这可能是采用 F# 来解析问题的一个足够大的理由。这是[一些关于使用 F# 进行词法分析和解析的材料。](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lexing_and_Parsing) YMMV，如[本文所示。](http://lookingsharp.wordpress.com/2010/03/08/tail-recursion-in-csharp-and-fsharp/)

您还需要图形周期检测以使您的程序在[存在错误输入](http://en.wikipedia.org/wiki/Cycle_detection)的情况下保持稳定。

作为收集更多信息的一种方式，您可以通过一个累加器整数来跟踪调用堆栈的深度。这不会直接转化为所述调用堆栈消耗的内存，但它会给你一个大致的概念。例如，当该数字大于某个用户可配置或预定义的阈值时，您可以抛出并捕获您自己的异常。

```
public void Recursive(int acc)
{
    if (acc > myLimit)
       throw new MyOverflowException(acc); 

    Recursive(acc+1);
} 
```

然后在呼叫站点：

```
try { Recursive(0); } catch (MyOverflowException) { /* handle it*/ } 
```

根据要求，我会将您链接到 Eric Lippert 关于[这个主题的精彩博客。](http://blogs.msdn.com/b/ericlippert/archive/2010/10/21/continuation-passing-style-revisited-part-one.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:55:17.893

由于 SOE 导致的线程崩溃将导致整个过程中断，您对此无能为力。

作为恢复措施，您可以将解析器作为单独的进程启动，并设置 IPC 机制与子进程通信。这样，子进程可以在不影响主进程的情况下自由死亡。

# php - 将 PHP 函数参数组合成一个字符串

> ID：11784151
> 
> 赞同：1
> 
> 时间：2012-08-02T19:07:07.640
> 
> 标签：php, function, arguments

我有几个对函数的调用，这些`getContent()`函数的参数使用`func_get_args()`. 有几个参数保持不变，我想将它们设置为一个变量，以防止在所有这些函数调用中重复重复的参数。

以下是带有完整参数的函数调用示例：

```
<? getContent(
    "article",
    "display:list",
    "find_series:team",
    "find_category:pastors-team",
    "order:series",
    "find_parent_category:team",
    "show:<div class='box box_stories'>",
    "show:<div class='box_pad box_img bwWrapper'>",
    "show:<div class='box_inner_pad'>",
    "show:<h3><a href='/staff-detail/__slug__'>__authorX__</a></h3>",
    "show:<p class='teamsummary'>__summary__</p>",
    "show:<p class='phone_icon'>__authorXworkphone__</p>",
    "show:</div>",
    "show:</div>",
    "show:</div>"
); 
?> 
```

理想情况下，我可以做这样的事情：

```
<? $myStyle = 
    "show:<div class='box box_stories'>",
    "show:<div class='box_pad box_img bwWrapper'>",
    "show:<div class='box_inner_pad'>",
    "show:<h3><a href='/staff-detail/__slug__'>__authorX__</a></h3>",
    "show:<p class='teamsummary'>__summary__</p>",
    "show:<p class='phone_icon'>__authorXworkphone__</p>",
    "show:</div>",
    "show:</div>",
    "show:</div>";

getContent(
    "article",
    "display:list",
    "find_series:team",
    "find_category:leadership-team",
    "order:series",
    "find_parent_category:team",
    $myStyle
);

getContent(
    "article",
    "display:list",
    "find_series:team",
    "find_category:executive-team",
    "order:series",
    "find_parent_category:team",
    $myStyle
); ?> 
```

这可能吗？解决这个问题的最佳方法是什么？

*注意：我不能更改 getContent() 函数，它是 CMS 的核心函数*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:10:36.887

不幸的是，这是不可能的。您现在拥有的是传递`article`,`display`等和`$myStyle`（应该是一个数组）。你会得到错误，因为你没有传递足够的参数。

如果可以，请检查并查看是否`getContent()`有默认参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:11:16.830

这是我能想到的最简单的一个：

```
call_user_func_array('getContent',array_merge(array(
    "article",
    "display:list",
    "find_series:team",
    "find_category:executive-team",
    "order:series",
    "find_parent_category:team",
    ),$myStyle)
); 
```

编辑：Yazmat 的解决方案可能会更好。
您可以将它与可变数量的参数一起使用，如下所示：

```
<?php
function myGetContent() {
    $defaults = array(
        "show:<div class='box box_stories'>",
        "show:<div class='box_pad box_img bwWrapper'>",
        "show:<div class='box_inner_pad'>",
        "show:<h3><a href='/staff-detail/__slug__'>__authorX__</a></h3>",
        "show:<p class='teamsummary'>__summary__</p>",
        "show:<p class='phone_icon'>__authorXworkphone__</p>",
        "show:</div>",
        "show:</div>",
        "show:</div>"
    );
    return call_user_func_array('getContent',array_merge(func_get_args(), $defaults));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:12:53.813

您可以创建自己的函数，该函数只接受您需要的参数，并使用这些参数加上默认值调用 getContent() 函数。并使用这个新函数而不是 getContent()

**编辑 ：**

你做这样的事情：

```
<?php
function myGetContent($param1,$param2,$param3,$param4,$param5,$param6){
  return getContent(
    $param1,
    $param2,
    $param3,
    $param4,
    $param5,
    $param6,
    "show:<div class='box box_stories'>",
    "show:<div class='box_pad box_img bwWrapper'>",
    "show:<div class='box_inner_pad'>",
    "show:<h3><a href='/staff-detail/__slug__'>__authorX__</a></h3>",
    "show:<p class='teamsummary'>__summary__</p>",
    "show:<p class='phone_icon'>__authorXworkphone__</p>",
    "show:</div>",
    "show:</div>",
    "show:</div>"
  );
} 
```

然后你打电话：

```
myGetContent(
    "article",
    "display:list",
    "find_series:team",
    "find_category:leadership-team",
    "order:series",
    "find_parent_category:team"
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:34:14.577

你需要这个？

```
<?php

getContent(
    array(
        'type'                  => 'article',
        'display'               => 'list',
        'find_series'           => 'team',
        'find_category'         => 'leadership-team',
        'order'                 => 'series',
        'find_parent_category'  => 'team'
    ),
    array(
        '<div class="box box_stories">',
        '<div class="box_pad box_img bwWrapper">',
        '<div class="box_inner_pad">',
        '<h3><a href="/staff-detail/__slug__">__authorX__</a></h3>',
        '<p class="teamsummary">__summary__</p>',
        '<p class="phone_icon">__authorXworkphone__</p>',
        '</div>',
        '</div>',
        '</div>'
    )
);

function getContent($argv, $shows){
    echo '<p>'.$argv['type'].'</p>';
    echo '<p>'.$argv['list'].'</p>';
    /* ... etc ... */

    echo '<pre>'.htmlspecialchars(print_r($argv, true), ENT_QUOTES).'</pre>';
    echo '<pre>'.htmlspecialchars(print_r($shows, true), ENT_QUOTES).'</pre>';
} 
```

# jquery - Jquery根据其ID显示/隐藏DIV，使用复选框

> ID：11784152
> 
> 赞同：0
> 
> 时间：2012-08-02T19:07:11.303
> 
> 标签：jquery, forms, checkbox, items

我正在尝试根据是否选中复选框来隐藏/显示 DIV。

我的站点中显示了多个项目，每个项目都位于名为 .itemBox 的 DIV 下。复选框中显示了一些颜色，我想隐藏除用户选择的颜色之外的所有项目（取决于所选的复选框）。

我的 javascript 应该检查每个 .itemBox 项目的 ID（这是一种颜色），然后隐藏/显示。

到目前为止，我有我的表单和 javascript，但是当我选中复选框时没有任何反应。

形式：

```
div class="colors">
<?php
$colors = mysql_query("SELECT DISTINCT color_base1 FROM item_descr ORDER BY color_base1");
while ($colorBoxes = mysql_fetch_array($colors))
{
echo "<input type='checkbox' class='regularCheckbox' name='color' value='".$colorBoxes[color_base1]."' /><font class='similarItemsText'>   ".$colorBoxes[color_base1]."</font><br />";
}
?>
</div> 
```

JAVASCRIPT：

```
<script>
    $('.colors').delegate('input:checkbox', 'change', function() { 
         if ($(this).attr('checked')) {
            $(".itemBox not(#" + $(this).val()  + ")").hide();
            $(".itemBox #" + $(this).val()).show();
        }
    })
</script> 
```

输出：

```
<td><div name='item' id='".$info[color_base1]."' class='itemBox'> ..... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:33:42.220

这是我的做法：

```
$(":checkbox").bind("click", function (event) {
     if($(this).is(':checked')) {
          $(".itemBox:not(#" + $(this).val()  + ")").hide();
          $(".itemBox[id='" + $(this).val() + "']").show();
     }else {
           //maybe you should do smth if checkbox is unchecked
     }
}); 
```

我认为你的错误是 :not 之前的空格，第二个选择器应该像 $(".itemBox[name='value']") 在 [.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:20:18.897

假设基于您的代码`$info[color_base1]`并且`$colorBoxes[color_base1]`是相同的，可能是这样的，因为我并没有真正阅读 PHP 输出和数据库值，所以很难说？

```
$('input[type="checkbox"]').on('change', function() { 
    if (this.checked) {
        $(".itemBox").hide();
        $("#" + this.value).show();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:23:23.810

有几件事，您`color`在 jQuery 选择中使用作为类，但在您的 html 中，它定义为名称：

```
<input type='checkbox' class='regularCheckbox' name='color' value='".$colorBoxes[color_base1]."' /><font class='similarItemsText'>   ".$colorBoxes[color_base1]."</font> 
```

如果你想使用复选框名称，你可以使用这样的选择器：

```
$('input[name=color]').... 
```

记住`.`符号描述了一个类。

看看这个 jsFiddle：http: [//jsfiddle.net/ufomammut66/h6m4H/](http://jsfiddle.net/ufomammut66/h6m4H/)

它非常简单，但您可以看到切换显示隐藏了下一个 itemBox div。您的 html 很可能不同，因此对您不起作用，但由于您没有全部发布，我无法使用正确的 html 路径。

# c++ - 在 g++ 中是在后台使用 pthreads 的 C++ 11 线程模型吗？

> ID：11784153
> 
> 赞同：14
> 
> 时间：2012-08-02T19:07:15.023
> 
> 标签：c++, c++11, g++, pthreads

我只是在尝试我的手`g++ 4.6`和`C++11`功能。每次我使用`-std=c++0x`标志编译一个简单的线程代码时，它要么因分段错误而崩溃，要么只是抛出一些奇怪的异常。

我阅读了一些与`C++11`线程相关的问题，我意识到，我还需要使用`-pthread`标志来正确编译代码。使用`-pthread`工作正常，我能够运行线程代码。

我的问题是，`C++11`多线程模型是否`Pthreads`在后台使用？还是从头开始写的？

我不知道是否有任何成员是`gcc`贡献者，但我只是好奇。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-02T19:15:08.053

如果你运行`g++ -v`它，它会给你一堆关于它是如何配置的信息。其中之一通常是一条看起来像的线

```
Thread model: posix 
```

这意味着它被配置为将 pthreads 用于其线程库（libstdc++ 中的 std::thread），这意味着您还需要使用系统上 pthreads 可能需要的任何标志（`-pthread`在 Linux 上）。

这与标准无关，它只是 g++ 如何实现标准的细节

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-02T19:16:02.417

C++ 没有指定线程是如何实现的。在实践中，C++ 线程通常被实现为对预先存在的系统线程库（如 pthread 或 windows 线程）的瘦包装器。甚至可以使用 std::thread::native_handle() 访问底层线程对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-12T23:05:42.530

它崩溃的原因是，如果您不指定`-pthreads`or `-lpthreads`，则链接了许多弱定义的 pthreads 存根函数`libc`。这些存根函数足以让您的程序无错误地链接。但是，实际创建 pthread 需要完整的 libpthread.a 库，并且当动态链接器 ( `dl`) 尝试解决这些缺失的函数时，您会遇到分段违规。

# php - 使用 PHP 从 office 文件（.doc .ppt 等）生成 JPG

> ID：11784155
> 
> 赞同：7
> 
> 时间：2012-08-02T19:07:44.380
> 
> 标签：php, ms-office, jpeg

我正在构建一个应用程序，人们可以在其中上传文件并与其他人共享。我们希望做的部分工作是允许人们在线预览文件。

是否有一种直截了当的方式来为文档中的前 X 个页面生成 jpgs？然后我们可以将这些 jpg 文件放在允许用户预览的网页中。

我看过在服务器上安装开放式办公室，但希望在某处有一个 php 库可以完成同样的工作。

有人可以帮忙吗？

干杯

* * *

顺便说一句，不必是 jpg，任何图像文件都可以（实际上即使是 pdf 也可以）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:16:58.990

用 com 类试试这个：

您可以使用 com 类将 office 文件转换为 jpg

COM 类参考：-

[http://us2.php.net/manual/en/class.com.php](http://us2.php.net/manual/en/class.com.php)

或下面的代码是将ppt转换为jpg格式

```
<html>
<head>
<title>ShotDev.Com Tutorial</title>
</head>
<body>
<?
    $ppApp = new COM("PowerPoint.Application");
    $ppApp->Visible = True;

    $strPath = realpath(basename(getenv($_SERVER["SCRIPT_NAME"]))); // C:/AppServ/www/myphp

    $ppName = "MySlides.ppt";
    $FileName = "MyPP";

    //*** Open Document ***//
    $ppApp->Presentations->Open(realpath($ppName));

    //*** Save Document ***//
    $ppApp->ActivePresentation->SaveAs($strPath."/".$FileName,17);  //'*** 18=PNG, 19=BMP **'
    //$ppApp->ActivePresentation->SaveAs(realpath($FileName),17);

    $ppApp->Quit;
    $ppApp = null;
?>
PowerPoint Created to Folder <b><?=$FileName?></b>
</body>
</html>

---------------------------

Or try this :-

$powerpnt = new COM("powerpoint.application") or die("Unable to instantiate Powerpoint");

$presentation = $powerpnt->Presentations->Open(realpath($file), false, false, false) or die("Unable to open presentation");

foreach($presentation->Slides as $slide)

{

    $slideName = "Slide_" . $slide->SlideNumber;

    $exportFolder = realpath($uploadsFolder);

    $slide->Export($exportFolder."\\".$slideName.".jpg", "jpg", "600", "400");

}

$powerpnt->quit(); 
```

?>

或将word转换为jpg

```
<?php
// starting word
$word = new COM("word.application") or die("Unable to instantiate Word");
echo "Loaded Word, version {$word->Version}\n";

//bring it to front
$word->Visible = 1;

//open an empty document
$word->Documents->Add();

//do some weird stuff
$word->Selection->TypeText("This is a test...");
$word->Documents[1]->SaveAs("Useless test.doc");

//closing word
$word->Quit();

//free the object
$word = null;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-06T18:42:01.010

您不能使用 Office 互操作来自动执行此类任务，请参阅此处的 Microsoft 原因：

[https://support.microsoft.com/en-us/kb/257757](https://support.microsoft.com/en-us/kb/257757)

最好的方法是使用功能强大的库，例如 Aspose.Slides（与 ppt、pptx 兼容，强大的操作），旨在用作 API。

您可以通过 NetPhp 库从 PHP 中使用 Aspose.Slides。这里有一个例子：

[http://www.drupalonwindows.com/en/blog/powerpoint-presentation-images-php-drupal-example](http://www.drupalonwindows.com/en/blog/powerpoint-presentation-images-php-drupal-example)

相关的代码是这个，它有一些 Drupal 特定的东西，但你可以看到它是如何运行的，并使它在其他地方工作：

```
protected function processFilePowerpoint(array $file, array &$files) {
    /** @var \Drupal\wincachedrupal\NetPhp */
    $netphp = \Drupal::service('netphp');

    $runtime = $netphp->getRuntime();

    $runtime->RegisterAssemblyFromFile("libraries/_bin/aspose/Aspose.Slides.dll", "Aspose.Slides");
    $runtime->RegisterAssemblyFromFullQualifiedName("System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing");

    $destination = strtr(PresentacionSlide::UPLOAD_LOCATION, ['[envivo_presentacion:id]' => $this->entity->id()]);
    file_prepare_directory($destination, FILE_CREATE_DIRECTORY | FILE_MODIFY_PERMISSIONS);

    $sourcefile = drupal_realpath($file['tmppath']);

    $presentation = $runtime->TypeFromName("Aspose.Slides.Presentation")->Instantiate($sourcefile);
    $format = $runtime->TypeFromName("System.Drawing.Imaging.ImageFormat")->Png;

    $x = 0;

    /** @var \NetPhp\Core\NetProxyCollection */
    $slides = $presentation->Slides->AsIterator();

    foreach ($slides as $slide) {
      $x++;
      $bitmap = $slide->GetThumbnail(1, 1);
      $destinationfile = $destination . "\\slide_{$x}.png";
      $bitmap->Save(drupal_realpath($destinationfile), $format);
      $files[] = PresentacionSlide::fromFile($destinationfile);
    }

    $presentation->Dispose();
  } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-11-03T23:16:40.413

对于特定于 PHP 的选项，您可以使用[PHPWord](https://github.com/PHPOffice/PHPWord) - 这个库是用 PHP 编写的，并提供类来读取和写入不同的文档文件格式（包括`.doc`和`.docx`），但它不会让您能够从全范围转换Office 文件。

要在任何平台上转换任何 Office 文件，您可以使用像[Zamzar](https://developers.zamzar.com)这样的文件转换 API 。它可以从所有 Office 格式（DOC / DOCX / PPT / PPTX / XLS / XLSX）转换为图像（JPG、PNG、GIF 等）和 PDF。

从 PHP 调用的代码如下（更多信息[在 docs 中](https://developers.zamzar.com/docs#section-Start_a_conversion_job)）。

```
<?php
// Build request
$endpoint = "https://api.zamzar.com/v1/jobs";
$apiKey = "YOUR_KEY";
$sourceFilePath = "/tmp/my.doc"; // Or DOCX/PPT/PPTX/XLS/XLSX
$targetFormat = "jpg";

$sourceFile = curl_file_create($sourceFilePath);    
$postData = array(
  "source_file" => $sourceFile,
  "target_format" => $targetFormat
);

// Send request
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $endpoint);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');
curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
curl_setopt($ch, CURLOPT_SAFE_UPLOAD, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERPWD, $apiKey . ":");
$body = curl_exec($ch);
curl_close($ch);

// Process response (with link to converted files)
$response = json_decode($body, true);
print_r($response);
?> 
```

# delphi - 将 Codesite 与记录类型一起使用

> ID：11784157
> 
> 赞同：3
> 
> 时间：2012-08-02T19:07:46.113
> 
> 标签：delphi, object, dynamic, creation

在 Delphi XE 中，我想使用 codesite 来生成有关记录类型的信息。我知道可以强制记录[发出 RTTI](http://alex.ciobanu.org/?p=55)，但我想知道是否有办法反过来使用这些信息来使用 Codesight 的 .send 方法？

例如，CodeSite.send('Hello World', self); 之所以有效，是因为 self 是一个 TObject。但如果 self 是记录类型，这将不起作用。

我想做的事情可能是不可能的，但我想我还是会抓住机会的。我真正想做的是将记录类型动态转换为简单对象。然后我可以将此对象传递给上面的调用。

# jquery - jQuery：是否可以暂时禁用/防止某些 dom 元素被选择/操作？

> ID：11784160
> 
> 赞同：0
> 
> 时间：2012-08-02T19:08:16.890
> 
> 标签：jquery

这有点难以解释，但我必须尽力而为。我有 3 个隐藏容器，其中有 3 个链接，通过 ID 与 3 个容器中的每一个关联。当我单击每个链接时，它将打开关联的容器。

但现在有一个转折点。还有其他 JS 将执行我无法控制的其他操作，并且他们没有在他们的脚本中使用任何范围，因此这意味着它正在一次操作我的所有 3 个容器，这不是想要的行为。我希望它只影响我点击的容器。所以我的第一个假设是以某种方式禁用未打开的容器进行修改，并在它关闭或我选择另一个容器时重新启用它们。迷茫了吗？这是一个示例链接，应该说明设置：

[http://jsfiddle.net/UxRkZ/1/](http://jsfiddle.net/UxRkZ/1/)

总而言之，我想以某种方式防止其他隐藏的容器在其中一个容器可见/打开时被操纵。请记住，还有其他脚本会触发，并且这些脚本没有作用域，因为它认为应该只有一个容器......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:09:55.457

你可以给你不想被选中的元素一个类。然后根据您不想包含的特定类过滤掉结果。

以下是如何过滤的示例

```
var elems = $('selector').filter(function() {
    return !$(this).hasClass('noselect');
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:57:46.257

好的，我最终做的是遍历所有 div 并从每个 div 中删除类，然后仅将它们重新应用于当前选定的容器。这样其他 JS 脚本将无法操作这些元素。

# google-maps - 融合表地图入门

> ID：11784163
> 
> 赞同：0
> 
> 时间：2012-08-02T19:08:21.620
> 
> 标签：google-maps, google-maps-api-3, google-fusion-tables

我创建了一个包含县数数据的融合表。此数据如下所示：

```
County  Boundary    Democrat    Republican  PercentageMen   AverageAge
1       kml         41          46          53              55
2       ... 
```

你会如何建议我根据这些数据制作地图？

例如，我想要一个显示百分比投票民主党人的渐变阴影图。我还想要一张地图，显示平均年龄在 45 岁以下的那些投票给共和党的县，等等。

然后我希望在一个网页上显示所有这些地图。

请引导我查看相关文档和任何相关的在线示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:53:16.787

要在地图上显示数据，我会使用[FusionTablesLayers](https://developers.google.com/maps/documentation/javascript/layers?#FusionTables)。它们是 Google Maps API 的一部分，旨在在 Google Maps 上显示来自 Fusion Tables 的数据。

要获得基本概念，您可以使用[FusionTablesLayer 向导](http://fusion-tables-api-samples.googlecode.com/svn/trunk/FusionTablesLayerWizard/src/index.html)，它为您提供了一个可以使用的骨架。在地图上获得数据后，您就可以开始对其进行样式设置了。有[多种选项可用于更改](https://developers.google.com/maps/documentation/javascript/layers?#fusion_table_styles)多边形/线条/标记的外观（[参见此示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-fusiontables-styling)）。通过指定`where`样式的 -Clause，您可以根据您的数据（例如平均年龄）更改样式。

请记住，Fusion Tables 对 5 个样式规则有限制。

# jquery - 动画 div 滑入容器

> ID：11784169
> 
> 赞同：0
> 
> 时间：2012-08-02T19:08:53.130
> 
> 标签：jquery, jquery-ui, jquery-animate

我有我在下面的小提琴上发布的代码；[http://jsfiddle.net/eE2Xn/2/](http://jsfiddle.net/eE2Xn/2/)

它的基本意图是在单击按钮时，将红色的 div 向下滑动到灰色的 div 上，成为`#container`.

的其他孩子`#container`应该为红色盒子腾出空间。另一个红色框（希望具有相同的绑定，因此深度克隆）应该代替它出现。

它似乎就在那里（我的实际代码似乎比这个通用小提琴版本好一点），但是动画很突出，我想不通。

我怎样才能达到这个效果？我在两者中都使用了 jQuery 和 jQuery UI edge。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:52:19.887

您需要将所有内容都包含在回调函数中，或者`.delay()`在下一个完成之前将其包含在内。

回调函数的工作方式如下：

```
$('#thing').fadeIn('3000', function () {
    // Have your next animation here
}); 
```

有关信息`.delay()`，请在此处阅读更多信息：http: [//api.jquery.com/delay/](http://api.jquery.com/delay/)

# java - onActivityResult() 没有从 Activity 调用

> ID：11784170
> 
> 赞同：0
> 
> 时间：2012-08-02T19:08:53.850
> 
> 标签：java, android

我可以从一个 Activity(EditActivity.java) 编辑和保存数据，但是当单击 Save 按钮时，更新的数据不会显示（或结转）到下一个 Activity(ViewActivity.java)。如果返回 EditActivity 页面，我可以看到 EditText 字段上的更改。

编辑活动.java

```
btnSave.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
            // starting background task to update request
            new SaveRequestDetails().execute();
        }
    });

    class SaveRequestDetails extends AsyncTask<String, String, String> {

    protected String doInBackground(String... args) {

        // getting updated data from EditTexts
        String request_title = txtTitle.getText().toString();
        String request_date = txtSdate.getText().toString();
        String reqEndDate = txtEdate.getText().toString();
        String hours = txtHours.getText().toString();
        String reason = txtReason.getText().toString();
        String explanation = txtExp.getText().toString();

        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair(TAG_ID, request_id));
        params.add(new BasicNameValuePair(TAG_TITLE, request_title));
        params.add(new BasicNameValuePair(TAG_SDATE, request_date));
        params.add(new BasicNameValuePair(TAG_EDATE, reqEndDate));
        params.add(new BasicNameValuePair(TAG_HOURS, hours));
        params.add(new BasicNameValuePair(TAG_REASON, reason));
        params.add(new BasicNameValuePair(TAG_EXP, explanation));

        JSONObject json = jsonParser.makeHttpRequest(url_update_request,
                "POST", params);

        try {
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) {

                Intent i = getIntent();
                // send result code 100 to notify about request update
                setResult(100, i);
                finish();
            } else {

            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    } 
```

ViewActivity.java

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.view_request);

        Intent i = getIntent();

        // getting request id (rid) from intent
        request_id = i.getStringExtra(TAG_ID);

        // Getting complete request details in background thread
        new GetRequestDetails().execute();

        btnEdit = (Button) findViewById(R.id.btnEdit);

        btnEdit.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                // Starting new intent
                Intent in = new Intent(getApplicationContext(), EditActivity.class);
                // sending rid to next activity
                in.putExtra(TAG_ID, request_id);
                startActivity(in);

            }
        });

    }

    // Response from Edit Activity
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        // if result code 100
        if (resultCode == 100) {
            // if result code 100 is received 
            // means user edited/deleted request
            // reload this screen again
            Intent intent = getIntent();
            finish();
            startActivity(intent);
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:14:00.007

您的标题说， onActivityResult() 没有被调用。

使用 `startActivityForResult(in, 55)`代替`startActivity(in)`

//编辑：顺便说一下，检查结果代码应该使用 RESULT_OK / RESULT_CANCELED 常量来完成。您也可以考虑检查请求代码（在我的示例代码中为 55）

# android - 在哪里正确释放 Android View 上的位图？

> ID：11784171
> 
> 赞同：6
> 
> 时间：2012-08-02T19:08:55.380
> 
> 标签：android, view, bitmap, android-custom-view

我有一个自定义视图，它绘制了很多东西，包括位图。我想将此绘图缓存到位图上，这样我只需要在 onDraw 中绘制一个位图，而不是重复这些绘图任务和计算。

位图在我们不再使用后需要回收。我在 View 类中看不到 onDestroy() 或任何类似的东西。有没有我可以重写的回调方法来实现这一点？

```
public void <insert_callback_here>() {
    cachedBitmap.recycle();
} 
```

没有动画。这是一张静态图片。绘制图像需要进行大量计算，所以我宁愿在 onMeasure() 上执行一次。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T23:49:22.547

我将在这里回答我自己的问题。覆盖的正确方法是`onDetachedFromWindow`. 我在里面释放了我的位图，如果宽度或高度发生了变化，我在里面`onDetachedFromWindow`重新分配它们。`onMeasure`

```
@Override
protected void onDetachedFromWindow() {
    super.onDetachedFromWindow();
    if (cachedBitmap != null && !cachedBitmap.isRecycled()) {
        cachedBitmap.recycle();
        cachedBitmap = null;
        cachedBitmapWidth = -1;
        cachedBitmapHeight = -1;
    }
}

protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    int viewWidth = MeasureSpec.getSize(widthMeasureSpec);;
    int viewHeight = MeasureSpec.getSize(heightMeasureSpec);;

    if (cachedBitmapWidth != viewWidth || cachedBitmapHeight != viewHeight) {
        if (cachedBitmap != null) {
            cachedBitmap.recycle();
        }
        cachedBitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
        cachedBitmapWidth = viewWidth;
        cachedBitmapHeight = viewHeight;
        Canvas canvas = new Canvas(cachedBitmap);
        // do drawings here..
    }

    setMeasuredDimension(viewWidth, viewHeight);
} 
```

# node.js - NodeJS ReadStream一次不读取bufferSize字节

> ID：11784172
> 
> 赞同：5
> 
> 时间：2012-08-02T19:08:56.763
> 
> 标签：node.js, stream, buffer

我有一个代码，NodeJS 服务器读取文件并将其流式传输以响应，它看起来像：

```
var fStream = fs.createReadStream(filePath, {'bufferSize': 128 * 1024});
fStream.pipe(response); 
```

问题是，Node 每次准确读取文件 40960 个字节。但是，如果我的应用程序一次读取 131072 (128 * 1024) 个字节，它的效率会高得多（由于不适用于此问题的原因）。

有没有办法强制 Node 一次读取 128 * 1024 字节？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-04-13T03:43:34.537

接受的答案是错误的。**您可以使用highWaterMark**选项 强制 Node 一次读取*(128*1024)*个字节。

 **`var fStream = fs.createReadStream('/foo/bar', { highWaterMark: 128 * 1024 });`

[文档](https://nodejs.org/api/stream.html#stream_buffering)特别指出“*可能缓冲的数据量取决于传递给流构造函数的 highWaterMark 选项。对于普通流，highWaterMark 选项指定总字节数。对于在对象模式下运行的流，highWaterMark 指定对象的总数。*

另外，请参阅[此](https://github.com/nodejs/node-v0.x-archive/blob/523929c9272a53c9429616564a45f2af59670e47/lib/fs.js#L1461-L1463)。默认缓冲区大小为 64 KiloBytes

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:53:35.863

我是新来的，所以请耐心等待......

我在节点的来源中找到了这个：

```
var toRead = Math.min(pool.length - pool.used, ~~this.bufferSize); 
```

和：

```
var kPoolSize = 40 * 1024; 
```

因此，无论您提供什么，似乎缓冲区大小都限制为 40kb。您可以尝试更改代码中的值并重建节点。不过，这可能不是一个非常可维护的解决方案......**

# android - PhoneGap APK 运行良好，但在 Google Play 部署后每次运行都会崩溃

> ID：11784176
> 
> 赞同：1
> 
> 时间：2012-08-02T19:09:24.460
> 
> 标签：android, eclipse, cordova

我为周六开始的我所在城市的大型多元文化节构建了一个应用程序。我已经在 iPhone 版本中调整了很多错误，我们正在等待 Apple 批准。我把那个完善的版本作为安卓版本的基础。

Android 版本的外观和效果都很好。我可以在我的三星 Galaxy S II 上运行它，方法是在 Eclipse 中“作为 Android 应用程序运行”，或者将它上传到服务器并下载到手机中。我也可以将应用程序通过电子邮件发送给自己，它也可以使用。我将它提交到 Google Play 商店，一旦它进入野外（这在广告牌、公共汽车和任何地方都有广告），它一打开就崩溃了。

我不确定如何在发布前在设备上正常工作时解决此问题。我读到了它与 MainActivity 活动名称的关系，但一切看起来都像是在排队。

错误 1 ​​[PathClassLoader.findClass() 中的 ClassNotFoundException]：

```
java.lang.RuntimeException: Unable to instantiate activity 
ComponentInfo{com.honestapi.folk2011/com.honestapi.folk2011.Folklorama}: 
java.lang.ClassNotFoundException: com.honestapi.folk2011.Folklorama in loader 
dalvik.system.PathClassLoader[/data/app/com.honestapi.folk2011-1.apk]
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1660)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1752)
at android.app.ActivityThread.access$1500(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:993)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:126)
at android.app.ActivityThread.main(ActivityThread.java:3997)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:491)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassNotFoundException: com.honestapi.folk2011.Folklorama in loader dalvik.system.PathClassLoader[/data/app/com.honestapi.folk2011-1.apk]
at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
at java.lang.ClassLoader.loadClass(ClassLoader.java:548)
at java.lang.ClassLoader.loadClass(ClassLoader.java:508)
at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651) 
```

错误 2 [BaseDexClassLoader.findClass() 中的 ClassNotFoundException]：

```
java.lang.RuntimeException: Unable to instantiate activity    
ComponentInfo{com.honestapi.folk2011/com.honestapi.folk2011.Folklorama}:        
java.lang.ClassNotFoundException: com.honestapi.folk2011.Folklorama
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1894)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
at android.app.ActivityThread.access$600(ActivityThread.java:128)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4514)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassNotFoundException: com.honestapi.folk2011.Folklorama
at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
at android.app.Instrumentation.newActivity(Instrumentation.java:1027)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1885) 
```

任何帮助将不胜感激！我很喜欢泡菜。

编辑 - 这是 bin 文件夹中的 AndroidManifest.xml

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15" />

<supports-screens android:largeScreens="true" android:normalScreens="true"   android:smallScreens="true" android:resizeable="false" android:anyDensity="true" />

<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />
<uses-permission android:name="android.permission.CAMERA" />

<application android:icon="@drawable/ic_launcher"       android:label="@string/app_name" android:theme="@style/AppTheme">
<activity android:name=".MainActivity"           android:label="@string/title_activity_main">

<intent-filter>
    <action android:name="android.intent.action.MAIN" />

    <category android:name="android.intent.category.LAUNCHER" />
</intent-filter>
</activity>

<activity android:name="com.google.zxing.client.android.CaptureActivity"              android:screenOrientation="landscape"               android:configChanges="orientation|keyboardHidden"              android:theme="@android:style/Theme.NoTitleBar.Fullscreen"               android:windowSoftInputMode="stateAlwaysHidden">
<intent-filter>
    <action android:name="com.phonegap.plugins.barcodescanner.SCAN"/>
    <category android:name="android.intent.category.DEFAULT"/>
</intent-filter>
</activity>
<activity android:name="com.google.zxing.client.android.encode.EncodeActivity" android:label="@string/share_name">
  <intent-filter>
    <action android:name="com.phonegap.plugins.barcodescanner.ENCODE"/>
    <category android:name="android.intent.category.DEFAULT"/>
  </intent-filter>
</activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T19:44:13.477

原来我的主要 Java 文件被命名为“MainActivity.java”，但在整个项目文件中它被称为“Folklorama.java”。我将文件重命名为 Folklorama.java。

# javascript - 调用停止时jquery动画队列承诺会发生什么

> ID：11784179
> 
> 赞同：3
> 
> 时间：2012-08-02T19:09:34.380
> 
> 标签：javascript, jquery, jquery-animate, promise

我想知道当调用 .stop() 函数时动画队列承诺状态会发生什么。

例如：

```
$('.my-elem')
    .stop(true, true)
    .animate({})
    .promise()
    .always(function() {
        // do something
    }) 
```

如果`.stop()`函数在任何时候被调用，之前返回的 Promise 会发生什么？

现在，我感觉到承诺的回报只是永远等待着。对此有任何线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:16:54.093

停止动画解决了承诺。

```
//start the anim and alert 'done' on deferred resolution
$('div').animate({height: 500}, 3000).promise().done(function() {
    alert('deferred resolved');
});

//interrupt it after 1 second
setTimeout(function() { $('div').stop(); }, 1000); 
```

# mysql - mySQL UPDATE 另一个表中对应列的所有列

> ID：11784185
> 
> 赞同：4
> 
> 时间：2012-08-02T19:09:57.783
> 
> 标签：mysql, shortcut

我有两个具有相同架构的表。还有很多专栏！

我可以通过执行更新相应表中的记录

```
update t1 
join t2 on t2.id=t1.id 
set t1.column1=t2.column1,
    t1.column2=t2.column2... 
where t2.columnx > 123; 
```

但是我有很多字段，而且我天生就是一个懒惰的混蛋，他宁愿刮牦牛毛并在 SE 上发帖，也不愿输入列列表（可能缺少 1 个）。

除了一些将列列表写入文本文件等的时髦解决方案之外，是否有有效的 mySQL 语法可以跳过所有列的显式列表并且更像 INSERT...SELECT？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:16:51.503

```
REPLACE INTO t1 SELECT * FROM t2 WHERE columnx>123; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:21:20.053

尝试使用`REPLACE INTO ... SELECT ...`语法[http://dev.mysql.com/doc/refman/5.0/en/replace.html](http://dev.mysql.com/doc/refman/5.0/en/replace.html)

```
REPLACE INTO t1 SELECT t2.* FROM t2, t1 WHERE t1.columnx>123 AND t1.id=t2.id; 
```

警告！未测试！

`id`仅当表在列上具有唯一索引时，此代码才有效。

# html - 表单输入元素和宽度

> ID：11784189
> 
> 赞同：0
> 
> 时间：2012-08-02T19:10:09.593
> 
> 标签：html, css, forms

一段时间以来，我一直在通过使用封闭元素的宽度（例如 div 标签）在表单等上布置输入元素，然后将 % 宽度应用于所有表单元素（例如输入和文本区域）。

一些示例标记可能是：

```
<div class="span4">
    <label>Form Label</label>
    <input type="text" value="My Value"/>
</div> 
```

然后CSS将包括：

```
form input, form textarea {
    width: 95%;
} 
```

我最初提出这个方法是为了避免在表单元素和块元素上额外指定大小信息。无论如何，使用这种方法，我似乎不断地遇到这种便利破坏其他事情的情况，例如当我在元素旁边放置一个按钮时。

我的问题是，是否有任何好的替代方法可以直接在其他人一直在使用的表单元素上放置宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:14:57.333

您可以使用属性选择器：

```
form input[type="text"], form textarea {
    width: 95%;
} 
```

或者

```
form input, form textarea {
    width: 95%;
}
form input[type="button"]{
    width:auto;
} 
```

但是您这样做是正确的：CSS 旨在定义样式，而宽度是一种样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:21:02.093

您是否考虑过尝试一些响应式设计框架？如果您在尝试为元素提供可扩展的味道时已经使用百分比作为宽度，您应该尝试使用 twitter bootstrap。（有可能做流体和列式网格）。之后，您可以专注于个性化您的网站和编程核心功能 - 无需考虑那么多次要/基本布局问题 :)

# django - Django auth - 添加用户字段 - 在管理员中显示

> ID：11784191
> 
> 赞同：5
> 
> 时间：2012-08-02T19:10:13.190
> 
> 标签：django, django-models, django-admin, django-authentication

我是 django 和 python 的完整 n00b。我来自 PHP 背景，所以你必须接受我的道歉：p。

我正在尝试使用 django 中的管理面板功能向不同的人显示不同的选项。

系统应该允许管理员将“项目”添加到列表中。然后，“开发人员”应该能够仅查看分配给他们的项目，并且只能更改某些字段。

所以我想这个问题有两个方面：

1) 允许“开发人员”登录管理系统是最好的方法吗？

1.a) 如果是这样，我如何在管理员的用户表单上显示一个布尔字段？我只想标记 is_developer。我已将其添加为 userProfile 但不明白如何使其显示在表单上

2）我是否应该禁止他们登录（到管理面板）并制作“前端”，他们只能看到他们被允许的内容？

我希望这是有道理的。我现在有点不知所措，因为这完全背离了我的习惯！

提前感谢您可以为我提供的任何帮助:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-02T20:13:05.183

这里发生了很多事情，所以我将零碎地回答。

**允许“开发人员”登录管理系统是最好的方法吗？**

这取决于您的设置。通常，管理员应该只对“员工”可用：受雇于您的组织或与您的组织直接相关的人。事实上，为了登录管理员，用户必须拥有`is_staff=True`. 如果所有用户都属于您的组织（因此可以被认为是“受信任的”），那么是的，允许他们全部访问管理员是可以的。否则，这不是一个好主意，因为您将面临安全风险。

**如果是这样，我如何获得一个布尔字段以显示在管理员的用户表单上？**

在最简单的意义上，您可以通过将字段添加到表单类中来将字段添加到表单中，即使它是`ModelForm`从模型上的字段中预填充其字段的一个字段。

```
class MyModelForm(forms.ModelForm):
    class Meta:
        model = MyModel

    is_developer = forms.BooleanField(default=False) 
```

**我已将其添加为 userProfile 但不明白如何使其显示在表单上**

`UserProfile`显然，它是一个不同的模型，因此它的字段在 a 的表单上不可用`User`。但是，Django 确实提供了添加/编辑相关模型的能力，这些模型与另一个模型的编辑表单内联。这是通过内联表单集完成的。在管理员中，这些只是称为“内联”。

```
class UserProfileInlineAdmin(admin.StackedInline):
    model = UserProfile
    max_num = 1
    can_delete = False

class UserAdmin(admin.ModelAdmin):
    inlines = [UserProfileInlineAdmin] 
```

但是，您从内联管理员获得的视图明显不同于主表单（在本例中为 of `User`）。你可以试试看我的意思。这并不可怕，但它仍然是形式上的明显中断。我之前提到如何向表单添加字段的原因是，如果您愿意，您可以让它看起来像一个表单，但有点巧妙的误导。

```
class UserAdminForm(forms.ModelForm):
    class Meta:
        model = User

    is_developer = forms.BooleanField(default=False)

    def save(self, commit=True):
        user = super(UserAdminForm, self).save(commit=commit)
        if user.pk:
            profile = user.get_profile()
            profile.is_developer = self.cleaned_data.get('is_developer')
            profile.save() 
```

这是一个简单的示例，但想法是您手动将字段添加到表单中，然后在保存正在编辑的主要对象时使用它们实际手动更新另一个对象。

**相关的特别说明`User`**

现在，由于您在`User`这里处理，因此有很多棘手的细节。首先，`User`已经有了 a`UserAdmin`和它自己的形式——是的，复数形式。如果您想添加新功能，您需要确保在此过程中保留现有的 Django 功能。

```
from django.contrib.auth.admin import UserAdmin
form django.contrib.auth.models import User
from django.contrib.auth.forms import UserCreationForm, UserChangeForm

class CustomUserCreationForm(UserCreationForm):
    # do stuff

class CustomUserChangeForm(UserChangeForm):
    # do stuff

class CustomUserAdmin(UserAdmin):
    form = CustomUserChangeForm
    add_form = CustomUserCreationForm

admin.site.unregister(User)
admin.site.register(User, CustomUserAdmin) 
```

此外，`UserAdmin`还定义了自己的一组字段集。默认值为：

```
fieldsets = (
    (None, {'fields': ('username', 'password')}),
    (_('Personal info'), {'fields': ('first_name', 'last_name', 'email')}),
    (_('Permissions'), {'fields': ('is_active', 'is_staff', 'is_superuser', 'user_permissions')}),
    (_('Important dates'), {'fields': ('last_login', 'date_joined')}),
    (_('Groups'), {'fields': ('groups',)}),
)
add_fieldsets = (
    (None, {
        'classes': ('wide',),
        'fields': ('username', 'password1', 'password2')}
    ),
) 
```

如果要添加一个或多个字段，则需要重新定义这两个属性，并将字段添加到您想要的位置。

# xml - 如何访问 Extjs 嵌套模型（从 Xml 加载）？

> ID：11784192
> 
> 赞同：2
> 
> 时间：2012-08-02T19:10:12.647
> 
> 标签：xml, model, extjs4

很难理解模型的“关联”功能以及开发人员如何通过关联访问嵌套数据。

这是我们试图解析的一个简单的 XML 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<contacts>
    <contact>
        <id>1</id>
        <name>Bob Jones</name>
        <emails>
            <email>
                <addr>bjones1@dom.com</addr>
                <display>B. Jones 1</display>
            </email>
            <email>
                <addr>bjones2@dom.com</addr>
                <display>B. Jones 2</display>
            </email>
        </emails>
    </contact>
    <contact>
        <id>2</id>
        <name>John Rodeo</name>
        <emails>
            <email>
                <addr>jrodeo1@dom.com</addr>
                <display>J. Rodeo 1</display>
            </email>
            <email>
                <addr>jrodeos2@dom.com</addr>
                <display>J. Rodeo 2</display>
            </email>
        </emails>
    </contact>
</contacts> 
```

这是相关的模型

```
Ext.define('MyApp.model.Contact', {
    extend: 'Ext.data.Model',
    uses: [
        'MyApp.model.Emails'
    ],

    fields: [
        {
            name: 'id'
        },
        {
            name: 'name'
        }
    ],

    hasMany: {
        model: 'MyApp.model.Emails',
        autoLoad: true,
        foreignKey: 'addr',
        name: 'emailAddresses'
    }
});

Ext.define('MyApp.model.Emails', {
    extend: 'Ext.data.Model',
    uses: [
        'MyApp.model.Contact'
    ],

    idProperty: 'addr',

    fields: [
        {
            name: 'addr'
        },
        {
            name: 'display'
        }
    ],

    belongsTo: {
        model: 'MyApp.model.Contact'
    }
}); 
```

最后，这是商店：

```
Ext.define('MyApp.store.MyXmlStore', {
    extend: 'Ext.data.Store',
    requires: [
        'MyApp.model.Contact'
    ],

    constructor: function(cfg) {
        var me = this;
        cfg = cfg || {};
        me.callParent([Ext.apply({
            autoLoad: true,
            storeId: 'MyXmlStore',
            model: 'MyApp.model.Contact',
            proxy: {
                type: 'ajax',
                url: 'data/data.xml',
                reader: {
                    type: 'xml',
                    record: 'contact'
                }
            }
        }, cfg)]);
    }
}); 
```

我们创建了一个简单的 Grid 并将其链接到 Store ......然后，它显示了联系人（快速 ascii 渲染）

```
+---------------------------+
| My Grid Panel             |
+-----+---------------------+
| Id  | Name                |
+-----+---------------------+
|  1  | Bob Jones           |
|  2  | John Rodeo          | 
```

但是我们完全不知道如何检索相关的电子邮件记录。

我读过 GridPanel 可能无法正确呈现关联数据。这对我们来说没问题——我们只是想弄清楚如何使用这个模型数据以编程方式访问它。

例如，假设我们想创建一个附加到商店的简单 onXmlstoreLoad 事件，并且我们只想在加载后 console.log() 电子邮件地址——正确的语法是什么？

我们已经尝试了推荐的方法：

```
onXmlstoreLoad: function(store, records, successful, operation, options) {
    console.log(store.emailAddresses.getAt(0));
} 
```

但这会导致未定义的引用。

我承认这可能归结为我们错误地描述了我们的模型，但是我们已经尝试了几十种不同的配置，并且无法弄清楚问题是否是数据没有进入存储......或者我们是否可以't reference 在语法上是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T20:33:59.450

终于弄清楚了能够正确读取嵌套模型所缺少的东西。一旦我们正确地填充了我们的存储，访问嵌套数据记录就很简单了。

我们缺少的关键部分与代理/阅读器有关。每个模型都需要有自己的代理阅读器，因此您可以指定“记录”和“根”参数。

我建议任何偶然发现此线程的人查看由 Neil McGuigan 维护的优秀网站 - [http://extjs-tutorials.blogspot.com/2012_05_01_archive.html](http://extjs-tutorials.blogspot.com/2012_05_01_archive.html)。您应该遵循大量重要的提示和最佳实践。

Neil 为我们的解决方案提供的一个重要线索是，开发人员应该将 Proxy 和 Readers 挂在模型上，而不是挂在商店之外。这使得管理 Xml 特定记录/根参数变得简单。

唷，这是一个艰难的...对于任何第一次进入 Extjs 深层的人，我强烈建议您与 Firebug 亲密接触。步入 extjs 源代码开始回答许多关于如何将各个部分组合在一起的重要问题。

extjs 代码库有很好的文档记录。尽管开发人员显然是 Javascript 的黑带，这有时会让人难以跟上他们的前进方向，但最终的结果是值得付出努力的。

如果您正在寻找工作代码...

我们的商店

```
Ext.define('MyApp.store.MyXmlStore', {
    extend: 'Ext.data.Store',
    requires: [
        'MyApp.model.Contact'
    ],

    constructor: function(cfg) {
        var me = this;
        cfg = cfg || {};
        me.callParent([Ext.apply({
            autoLoad: true,
            storeId: 'MyXmlStore',
            model: 'MyApp.model.Contact',
            listeners: {
                load: {
                    fn: me.onXmlstoreLoad,
                    scope: me
                }
            }
        }, cfg)]);
    },

    onXmlstoreLoad: function(store, records, successful, operation, options) {
        console.log("onXmlstoreLoad:"+ successful);
        console.log(s.getAt(0).emailAddressesStore.getAt(0));

    }

}); 
```

还有我们的模特

```
Ext.define('MyApp.model.Contact', {
    extend: 'Ext.data.Model',
    uses: [
        'MyApp.model.Emails'
    ],

    fields: [
        {
            mapping: 'id',
            name: 'id',
            type: 'int'
        },
        {
            mapping: 'name',
            name: 'name',
            type: 'string'
        }
    ],

    hasMany: {
        associationKey: 'emails',
        model: 'MyApp.model.Emails',
        name: 'emailAddresses'
    },

    proxy: {
        type: 'ajax',
        url: 'data/data.xml',
        reader: {
            type: 'xml',
            root: 'contacts',
            record: 'contact'
        }
    }
});
Ext.define('MyApp.model.Emails', {
    extend: 'Ext.data.Model',
    uses: [
        'MyApp.model.Contact'
    ],

    fields: [
        {
            mapping: 'addr',
            name: 'addr',
            type: 'string'
        },
        {
            mapping: 'display',
            name: 'display',
            type: 'string'
        }
    ],

    proxy: {
        type: 'ajax',
        url: 'data/data.xml',
        reader: {
            type: 'xml',
            root: 'emails',
            record: 'email'
        }
    },

    belongsTo: {
        model: 'MyApp.model.Contact'
    }
}); 
```

# atk4 - ATK4 - addTotals() 导致总数为 0.00

> ID：11784194
> 
> 赞同：0
> 
> 时间：2012-08-02T19:10:18.727
> 
> 标签：atk4

我正在使用 ATK4.2.1 并试图让 addTotals() 功能在我的网格上工作。我尝试使用 setModel 和 setSource 方法将数据设置为网格。我的网格正确显示了所有数据，并且显示了 addTotals() 行，但在我尝试设置为“金钱”类型的任何字段上，结果始终为 0.00。

方法#1-

```
class page_showStats extends Page {
    function init(){
    parent::init();

        $grid=$this->add('Grid');
        $grid->setModel('aggrStats');
        $grid->addTotals();

    }
}

class Model_aggrStats extends Model_Table {
    public $table='aggrReports';
    function init(){
        parent::init();
        $this->addField('date')->type('date');
        $sitename = $this->join('websites','websiteID');
        $sitename->addField('sitename','name')->caption('Client');
        $sitetype = $this->join('adTypes','typeID');
        $sitetype->addField('typename','name')->caption('Product');
        $siteorigin = $this->join('origins','originID');
        $siteorigin->addField('originname','name')->caption('Origin');
        $this->addField('impressionsTotal')->Caption('Imp Opps')->sortable(true);
        $this->addField('impressionsFilled')->caption('Imps Filled')->sortable(true);
        $this->addField('fillPercent')->sortable(true)->caption('Fill %');
        $this->addField('grossRevenue')->type('money')->sortable(true);
        $this->addField('grossCPM')->sortable(true);
        $this->addField('netRevenue')->type('money')->sortable(true);
        $this->addField('netCPM')->sortable(true);
    }   
} 
```

方法#2 -

```
class page_slicer extends Page {
    function init(){
    parent::init();

        $g=$this->add('Grid');
        $g->addColumn('date','date');
        $g->addColumn('text','impressionsTotal');
        $g->addColumn('text','impressionsFilled');
        $g->addColumn('text','fillPercent');
        $g->addColumn('text','grossRevenue');
        $g->addColumn('text','grossCPM');
        $g->addColumn('money','netRevenue');
        $g->addColumn('text','netCPM');

        $g->setSource('aggrReports');

        $g->addTotals();

    }
} 
```

两种方法都生成带有空总计行的网格（第二种方法不包括第一种方法所做的一些识别部分，因为我专注于试图让一个货币列求和。）

!Grid 与零和总计[1](http://i.stack.imgur.com/Jgvh0.jpg)

关于我可能会错过的任何想法？谢谢。

# html - 有什么方法可以请求页面而不显示它？

> ID：11784199
> 
> 赞同：1
> 
> 时间：2012-08-02T19:10:28.900
> 
> 标签：html, http

如果您使用简单`<a href`的 链接到可下载的内容，用户将在停留在当前页面时下载文件。您可以使用浏览器没有插件的文件（如 .bin）来获得此行为，或者通过发送 content-disposition 标头来强制下载。

是否有任何方法或标题可以让用户在当前页面上同时仍然请求页面？这个想法是用户单击链接，发出请求，但页面不会改变 - 就像下载文件时一样。

我猜这可以用一个 iframe 来完成，它不是很漂亮，并且在加载页面时会发出另一个请求。Javascript 是另一个明显的答案，但这实际上是提出这个问题的原因：与无 JS 客户端的兼容性。

将方法设置为 HEAD 的表单是另一种丑陋的解决方案，但无论如何都不起作用。Chromium 忽略该方法并简单地执行一个 GET 请求......

还有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:39:00.777

您可以在隐藏的页面上放置一个 iframe。然后，给那个 iframe 和 id。

将此 id 用作指向要下拉的文件的链接的目标。

我在[http://jsfiddle.net/dancrumb/N87nL/](http://jsfiddle.net/dancrumb/N87nL/)创建了一个演示，向您展示它是如何工作的。只需将 iframe 设置为不可见就可以了

该页面将在 iframe 中加载，您将留在您的页面上，它不需要 JS。好家伙！

请注意，iFrame 没有 的初始值`src`，因此在页面加载时不会发出请求。

# language-agnostic - 文件中的随机行

> ID：11784213
> 
> 赞同：5
> 
> 时间：2012-08-02T19:11:13.830
> 
> 标签：language-agnostic

这个问题是在面试的时候问我的。面试已经结束了，但我仍在思考 hte 问题及其困扰我：

您拥有一种包含以下工具的语言：`rand()`函数、`while`循环`for`、`if`语句和`readline()`方法（类似于 python 的[`readline()`](http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files)）。给定这些工具，编写一个在文件中返回随机行的算法。你不知道文件的大小，你只能循环文件的内容一次。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:19:38.890

我不知道想要的答案，但我的解决方案如下：

```
chosen_line = ""
lines = 0

while (current_line = readline()):
    if (rand(0, lines) == 0):
        chosen_line = current_line

    lines++

return chosen_line 
```

编辑：一个很好的解释为什么这个作品发布在[这个评论](https://stackoverflow.com/questions/11784213/random-line-in-file/11784334#comment15653945_11784334)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:19:30.487

一种方法，保证均匀分布：

(1) 将文件逐行读入一个数组（或类似的，例如 python `list`）

(2)`rand()`用于选择一个介于 0 和数组中最大索引之间的数字。

另一个，不保证均匀分布：

阅读每一行。在每次读取时，还要调用 rand()。如果超过阈值，则返回该行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-02T19:34:22.857

虽然类似于 Marcin 的第三个选项，但 Luc 的实现总是返回第一行，同时解析整个文件。

它应该是这样的：

```
chosen_line = ""
treshold = 90 
max = 100

while chosen_line == "":
    current_line = readline()
    if (rand(0, max) > treshold):
        chosen_line = current_line

print chosen_line 
```

如果没有选择任何行并且您阅读了整个文件，您也可以返回 current_line。

# java - 使用 Java (OSX) 在终端中调用命令

> ID：11784217
> 
> 赞同：0
> 
> 时间：2012-08-02T19:11:24.490
> 
> 标签：java, macos, terminal, wget, osx-mountain-lion

我正在尝试编写 Java 代码来运行 wget 从服务器检索图像

我相信我已经正确安装了 wget。如果我输入：

```
wget http://insitu.fruitfly.org/insitu_image_storage/img_dir_38/insitu38795.jpe 
```

我在我的用户帐户文件夹中找到该图像。

以下 Java 代码在 Ubuntu 上正常运行，但我不得不将项目移至 OSX（Mountain Lion）

```
import java.io.*;
import java.io.IOException;

public class runWget
{

  public static void main (String args[])
  {
    String whatToRun = "wget     http://insitu.fruitfly.org/insitu_image_storage/img_dir_38/insitu38795.jpe";
   try
   {
     Runtime rt = Runtime.getRuntime();
     Process proc = rt.exec(whatToRun);
     int exitVal = proc.waitFor();
     System.out.println("Process exitValue:" + exitVal);
   } catch (Throwable t)
     {
       t.printStackTrace();
     }
  }
} 
```

当我尝试在 OSX 上运行它时，出现运行时错误：

> java.io.IOException：无法运行程序“wget”：错误=2，没有这样的文件或目录

如果有人能告诉我我做错了什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:21:50.247

如果`wget`确实安装在您的 OS X 系统上，则尝试指定它的完整路径。

尝试：

> 哪个wget

从命令行，然后在您的 Java 应用程序中使用该完全限定路径。

```
String whatToRun = "/usr/local/bin/wget http://insitu.fruitfly.org/insitu_image_storage/img_dir_38/insitu38795.jpe"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:13:43.453

很明显，`wget`在 OS X 中默认没有安装。

更有趣的是编写自己的 wget 之类的功能。

```
URL url = new URL("http://insitu.fruitfly.org/insitu_image_storage/img_dir_38/insitu38795.jpe");
InputStream in = url.openStream();
OutputStream os = new FileOutputStream(new File("picture.jpe"));
byte byffer[] = new byte[1024];
int nBytesRead;
while ((nBytesRead = in.read(buffer)) != -1)
{
    os.write(buffer, 0, nBytesRead);
}
os.flush();
os.close();
in.close(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T01:04:25.880

这些答案都没有解释你的实际问题是什么。

Java 失败的原因是 /usr/local/bin 不在您的 PATH 中。

显然，它位于您在终端中运行的 bash shell 的路径上。并且可能是您在终端中启动的任何新 bash shell（或通过 ssh 或其他方式）。这可能是因为您`export PATH=$PATH:/usr/local/bin`在 ~/.profile、~/.bash_profile、~/.bashrc 或 /etc 等价物中的某处有一行。

在 linux 上，你所有的 GUI 东西都是登录 shell 的子对象，所以在其中一个文件中放入一些东西（只要你选择正确的文件）意味着 Java 最终将继承该 PATH ，无论它如何启动。但是在 Mac 上，你所有的 GUI 东西都是 launchd 的子级，你运行的任何 shell 只是你的 GUI 应用程序的兄弟，而不是父级。因此，在 bash 的启动中设置 PATH 不会影响从 Finder 或 IDE 或其他任何东西启动的东西。

一旦你理解了问题，你就可以理解所有不同的解决方案——你可以[设置默认环境 launchd 给用户进程](http://developer.apple.com/library/mac/#qa/qa1067/_index.html)，或者在系统范围内做同样的事情，或者修改 /etc/paths 等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:14:06.940

看起来`wget`没有安装在那个 OSX 系统上。（它也不在我的身上，尽管它比我老了几代。）要么安装它，要么找到另一种下载图片的方法；毕竟，Java 确实具有内置的 HTTP 支持（参见`java.net.URL`类）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-06T07:23:45.177

如果您再次收到此错误，请执行如下命令：

> 哪个wget

```
Runtime.getRuntime().exec(new String[]{ "/bin/sh" , "-c" ,"/usr/local/bin/wget http://insitu.fruitfly.org/insitu_image_storage/img_dir_38/insitu38795.jpe" }) 
```

# java - “反向”XSLT（解析和构建 XML DOM 的语言）

> ID：11784219
> 
> 赞同：4
> 
> 时间：2012-08-02T19:11:32.990
> 
> 标签：java, parsing, xslt, lex, ebnf

我使用 XSLT 来转换它：

1)

```
<fruit>
  <apple count="2"/>
  <banana count="3"/>
</fruit> 
```

进入这个：

2)

```
Apple: 2
Banana: 3 
```

是否有一个库用作文本数据的解析器，它允许对预期标记进行描述性声明（想想扩展的 Backus–Naur 形式 |EBNF| 和基于 Lex/Yacc 正则表达式的提示）并从中构建 XML DOM？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T03:17:30.067

> 是否有一个库用作文本数据的解析器，它允许对预期标记进行描述性声明（想想扩展的 Backus–Naur 形式 |EBNF| 和基于 Lex/Yacc 正则表达式的提示）并从中构建 XML DOM？

**是的。[FXSL 2.0](http://sourceforge.net/projects/fxsl/)有一个功能[`f:lr-parse()`](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/func-lrParse.xsl?revision=1.7&view=markup)可以做到这一点**。这是用纯 XSLT 2.0 编写的，并实现了一个通用的（表驱动的）**[LR-1 解析器](http://en.wikipedia.org/wiki/LR_parser)**，它接受一个包含解析表的 XML 文件和一个包含要解析的“句子”的文本文件作为输入。

我已经将这个函数用于许多解析器，从玩具算术表达式到中型——JSON，再到非常大的——XPath 2.0——语言。

**例如，请参阅我博客中的这篇文章**：*[**转换 JSON**](http://dnovatchev.wordpress.com/2007/07/05/transforming-json/)*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:19:36.693

不要认为您会找到任何语言的库来直接实现将任何形式的任何文本编译成 XML 等广泛目标。

尽管可能并不完全符合您的要求，但了解 XSLT 2.0 可以从文本文件中获取输入、根据某些规则标记字符数据并输出 XML 可能很有用。有关证据，请参见我的[博客条目](http://pascaliburnus.seanbdurkin.id.au/index.php?/archives/17-A-Generalised-and-Comprehensive-Solution-to-CSV-to-XML-and-XML-to-CSV-Transformations.html)，其中显示了一个 XSLT 2.0 通用解决方案，用于解决 csv 到 xml 转换的问题。

# ms-access - MS Access 表单字段中的拼写检查代码 - 接受更改时抛出错误

> ID：11784221
> 
> 赞同：4
> 
> 时间：2012-08-02T19:11:38.867
> 
> 标签：ms-access, vba, ms-access-2003, ms-access-2000

我在 MS Access 表单的文本框的 AfterUpdate 事件中添加了以下代码：

```
Private Sub txtComments_AfterUpdate()
With Me!txtComments
    .SetFocus
    If Len(.Value) > 0 Then
        DoCmd.SetWarnings False
        .SelStart = 1
        .SelLength = Len(.Value)
        DoCmd.RunCommand acCmdSpelling
        .SelLength = 0
        DoCmd.SetWarnings True
    End If
End With
End Sub 
```

这会在用户退出该字段时运行拼写检查。它部分有效。它打开拼写检查对话框，并找到第一个错误。问题是，当您单击忽略、更改等来处理/修复拼写错误时，代码失败并出现以下错误框：

“为此字段设置为 BeforeUpdate 或 ValidationRule 属性的宏或函数正在阻止 Microsoft Office Access 保存该字段中的数据。”

我尝试在拼写检查代码之前添加记录保存代码：

DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord, , acMenuVer70 DoCmd.DoMenuItem acFormBar, acRecordsMenu, 5, , acMenuVer70

但这并没有解决它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T20:32:36.743

此代码用作 On Exit 事件（而不是 After Update）。

```
Private Sub txtComments_Exit(Cancel As Integer)
With Me!txtComments
    .SetFocus
    If Len(.value) > 0 Then
        .SelStart = 1
        .SelLength = Len(.value)
        DoCmd.RunCommand acCmdSpelling
        .SelLength = 0
    End If
End With
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T19:15:53.487

使用与控件关联的更新事件是行不通的，因为每次更改都会再次触发该事件。您需要一个按钮，或类似：

```
Private Sub Spell_Click()
    With Me!txtComments
        .SetFocus
        .SelStart = 0
        .SelLength = Len(Me!txtComments)
    End With
    DoCmd.RunCommand acCmdSpelling
End Sub 
```

通过添加一行可以避免 On Exit 事件的一些问题：

```
 If Me.txtComments.Value <> Me.txtComments.OldValue Then
       With Me!txtComments
           .SetFocus
           .SelStart = 0
          .SelLength = Len(Me!txtComments)
       End With
    <...> 
```

至少这只会在您通过控件直到保存记录时才会运行，而不是每次都运行，无论 txtComments 是否更改。

# jquery - 使用 jQuery 的选项卡视图

> ID：11784225
> 
> 赞同：1
> 
> 时间：2012-08-02T19:12:07.493
> 
> 标签：jquery, html, css

由于某种原因，以下选项卡视图未切换窗格。我确信我在这里所做的没有错，但是无论我单击哪个选项卡，内容窗格都保持不变。

这是代码

**HTML**

```
<!-- the tabs -->
<ul class="tabs">
  <li><a href="#first">Tab 1</a></li>
  <li><a href="#second">Tab 2</a></li>
  <li><a href="#third">Tab 3</a></li>
</ul>

 <!-- tab "panes" -->
 <div class="panes">
   <div><a href="#first">
    First pane.</a>
   </div>
   <div><a href="#second">
     Second pane. You can open other tabs with normal
     </a>
    </div>
    <div><a href="#third">
     Third tab content</a>
    </div>
  </div> 
```

**CSS**

```
ul.tabs {
margin:0 !important;
padding:0;
height:30px;
border-bottom:1px solid #666;
 }

 /* single tab */
 ul.tabs li {
    float:left;
     padding:0;
     margin:0;
     list-style-type:none;
  }

 /* link inside the tab. uses a background image */
 ul.tabs a {
float:left;
font-size:13px;
display:block;
padding:5px 30px;
text-decoration:none;
border:1px solid #666;
border-bottom:0px;
height:18px;
background-color:#efefef;
color:#777;
margin-right:2px;
position:relative;
top:1px;
outline:0;
-moz-border-radius:4px 4px 0 0;
}

 ul.tabs a:hover {
     background-color:#F7F7F7;
    color:#333;
 }

 /* selected tab */
 ul.tabs a.current {
     background-color:#ddd;
     border-bottom:1px solid #ddd;
     color:#000;
     cursor:default;
  } 

  /* tab pane */
       .panes {

          border:1px solid #666;
           border-width:0 1px 1px 1px;
           min-height:150px;
           padding:15px 20px;
           background-color:#ddd;
      } 
```

**jQuery**

```
 $("ul.tabs").tabs("div.panes > div"); (include the jquery tools lib also) 
```

此选项卡来自[此](http://www.jquerytools.org)网站，因此所有代码几乎没有变化。我所做的只是我刚刚`display:none`从`.pane`课堂上删除了，其余的都是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:25:32.857

试试这个。

```
<ul class="tabs">
    <ul>
        <li><a href="#first">Tab 1</a></li>
        <li><a href="#second">Tab 2</a></li>
        <li><a href="#third">Tab 3</a></li>
    </ul>

    <div id="first">First pane.</div>
    <div id="second">Second pane.</div>
    <div id="third">Third tab content</div>
</ul>

<script language="javascript">
    $(document).ready(function(e) {
        $('.tabs').tabs();
    });
</script> 
```

# node.js - 使用 PassportJS，如何将额外的表单字段传递给本地身份验证策略？

> ID：11784233
> 
> 赞同：105
> 
> 时间：2012-08-02T19:12:46.987
> 
> 标签：node.js, authentication, express, callback, passport.js

`req.body.username`我正在使用passportJS ，我想提供的不仅仅是`req.body.password`我的身份验证策略（passport-local）。

我有 3 个表单域：`username`, `password`, &`foo`

如何`req.body.foo`从我的本地策略访问，如下所示：

```
passport.use(new LocalStrategy(
  {usernameField: 'email'},
    function(email, password, done) {
      User.findOne({ email: email }, function(err, user) {
        if (err) { return done(err); }
        if (!user) {
          return done(null, false, { message: 'Unknown user' });
        }
        if (password != 1212) {
          return done(null, false, { message: 'Invalid password' });
        }
        console.log('I just wanna see foo! ' + req.body.foo); // this fails!
        return done(null, user, aToken);

      });
    }
)); 
```

我在我的路由（而不是路由中间件）中调用它，如下所示：

```
 app.post('/api/auth', function(req, res, next) {
    passport.authenticate('local', {session:false}, function(err, user, token_record) {
      if (err) { return next(err) }
      res.json({access_token:token_record.access_token});
   })(req, res, next);

  }); 
```

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-08-02T19:49:21.593

您可以启用一个`passReqToCallback`选项，如下所示：

```
passport.use(new LocalStrategy(
  {usernameField: 'email', passReqToCallback: true},
  function(req, email, password, done) {
    // now you can check req.body.foo
  }
)); 
```

当 set`req`成为验证回调的第一个参数时，您可以根据需要对其进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-14T10:18:44.583

在最常见的情况下，我们需要提供 2 个登录选项

*   带电子邮件
*   带手机

很简单，我们可以使用常用的用户名和查询 $ 或通过两个选项，我发布了以下片段，如果有人有同样的问题。

我们也可以使用 'passReqToCallback' 也是最好的选择，谢谢@Jared Hanson

```
passport.use(new LocalStrategy({
    usernameField: 'username', passReqToCallback: true
}, async (req, username, password, done) => {
    try {
        //find user with email or mobile
        const user = await Users.findOne({ $or: [{ email: username }, { mobile: username }] });

        //if not handle it
        if (!user) {
            return done(null, {
                status: false,
                message: "That e-mail address or mobile doesn't have an associated user account. Are you sure you've registered?"
            });
        }

        //match password
        const isMatch = await user.isValidPassword(password);
        debugger
        if (!isMatch) {
            return done(null, {
                status: false,
                message: "Invalid username and password."
            })
        }

        //otherwise return user
        done(null, {
            status: true,
            data: user
        });
    } catch (error) {
        done(error, {
            status: false,
            message: error
        });
    }
})); 
```

# php - 将值从一种方法返回到另一种方法

> ID：11784239
> 
> 赞同：0
> 
> 时间：2012-08-02T19:13:25.330
> 
> 标签：php, validation

我不知道为什么这根本不起作用。我的理解可能有误，这就是原因。

这是情况。

1.  MVC 模式
2.  表单验证的东西

这是代码

```
public function userExist($data) 
{
    $string = "SELECT student_number FROM users WHERE student_number = :user";
    $sth = $this->db->prepare($string);
    $sth->execute(array(
        ':user' => $data['user']
    ));
    return $sth->rowCount() == 0 ? true : false;
}

public function validate($data) {
    $this->userExist($data);
} 
```

我想要的是返回一个字符串，上面写着“用户存在”，如果`userExist`方法是假的......但是这段代码不起作用：

```
if($sth->rowCount() == 0) {
    return true;
} else {
    return "User Already Exists";
} 
```

这就是我如何在控制器中调用它们：

```
if ($this->model->validate($data) == true) {
    $this->model->create($data);
    header('Location: '.URL.'users');
} else {
    echo $this->model->validate($data);
    die();
} 
```

你认为最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T04:49:58.457

首先，您需要返回 validate 的值：

```
public function validate($data) {
    $this->userExist($data);
} 
```

但这里还有一些其他问题。您不需要在控制器中调用 $this->model->validate($data) 两次。您可以执行以下操作：

```
$result = false;
$result = $this->model->validate($data);
if ( true === $result {
    $this->model->create($data);
    header('Location: '.URL.'users');
} else {
    die($result);
} 
```

# ruby-on-rails - RnR：rails_admin，多态关联，没有类

> ID：11784243
> 
> 赞同：1
> 
> 时间：2012-08-02T19:13:30.990
> 
> 标签：ruby-on-rails, ruby-on-rails-3, polymorphic-associations, rails-admin

好的，我从这个问题开始： [RnR: Database normalization, rails models and associations](https://stackoverflow.com/questions/11673050/rnr-database-normalization-rails-models-and-associations)

我已经按照概述设置了模型。我正在尝试使用[Rails_admin](https://github.com/sferik/rails_admin) gem 进行数据维护。问题是每个多态子表都会出现以下错误：

```
 undefined method `klass' for nil:NilClass 
```

但是显示了位置的父记录，列表中包含关联字段，但我无法编辑它们。我在想也许种子数据会有所帮助，但我不确定 object_type 的格式应该是什么？区分大小写、单数还是复数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T18:16:16.380

想通了，为两个不同的多态关联之间的关联使用相同的名称......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:08:59.457

`object_type`格式与模型名称完全相同。

假设您有可以属于文章或帖子的评论，并且我们的多态关联是可评论的（因此，`commentable_type`和`commentable_id`）。

对 ID 为 1 的文章的评论将是

`commentable_type = 'Article'`

`commentable_id = 1`

# ruby-on-rails - Ruby 中的 MongoDb 排序

> ID：11784245
> 
> 赞同：1
> 
> 时间：2012-08-02T19:13:39.843
> 
> 标签：ruby-on-rails, ruby, mongodb

我必须通过 mongodb 驱动程序对 ruby​​ 中的 mongodb 集合进行排序。当我直接使用

```
db.zipper.find().sort({"value":-1}) 
```

但是当我在 ruby​​ 中做同样的事情时，集合没有得到排序。我正在使用

```
coll = db.collection('zipper')
coll.find().sort({"value":-1}) 
```

告诉我哪里出错了。我试过了

```
coll.find.sort(:value,:desc) 
```

但这也是徒劳的。告诉我哪里出错了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T21:37:20.910

您需要将排序选项作为键值对数组传递，例如：

```
 coll.find({}, :sort => ['value',-1]) 
```

使用 Ruby 驱动程序，您还可以使用`desc`或`descending`作为`-1`反向排序顺序的语义等价物：

```
 coll.find({}, :sort => ['value','desc'])
 coll.find({}, :sort => ['value','descending']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-30T11:48:47.090

使用较新的 Ruby 和 Mongo 驱动程序，您可以像这样使用哈希语法：

```
coll.find({}, sort: {value: -1}) 
```

# macos - Mac OS 模拟到 /dev/ttyUSBxx

> ID：11784248
> 
> 赞同：11
> 
> 时间：2012-08-02T19:13:46.027
> 
> 标签：macos, usb, tty

我曾经使用 linux USB 端口命名，即 /dev/ttyUSBxx，目前正在尝试编写一些测试软件来读取/写入 iMac 上的 USB 端口的原始数据，但我发现很难检测到我的 USB 硬件连接到哪个端口。我已经尝试过使用 /dev/ttys"x" 但没有运气。

在系统信息中，我看到附加在 Location ID: 0xfa120000 / 6 的硬件，也许这能有所帮助？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-03T00:05:24.427

OS X 不会为对 USB 设备的原始访问创建 /dev 条目，并且无法将它们作为 TTY 设备进行访问。

部分原因是 Linux 和 BSD 之间的哲学不同，部分原因是驱动程序编写技术的不同，部分原因是已经有一个必须映射到 /dev 的明确定义的层次结构（IOKit 注册表）以某种复杂的方式进行层次结构。

无论如何，如果您想了解如何*在*Mac 上访问 USB 设备，请从[QA1370](https://developer.apple.com/library/mac/#qa/qa1370/_index.html)开始。如果你想在没有真正学习 IOKit/IOUSB 的情况下快速移植一些 linux 代码，那可能是不可能的。如果您正在寻找其他内容，则需要提供有关您正在尝试做的事情的更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:32:24.293

我有一个用作 USB 串行设备的 SheevaPlug，它显示为`/dev/tty.usbserial-XXXX`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-27T16:11:27.970

如果您的 USB 设备内部有 FTDI 芯片，[则从 FTDI 安装 VCP 驱动程序](http://www.ftdichip.com/FTDrivers.htm)可能会有所帮助。

# jquery - JQuery Unbind 然后绑定

> ID：11784257
> 
> 赞同：1
> 
> 时间：2012-08-02T19:14:20.587
> 
> 标签：jquery, bind

我找到了很多关于这个主题的例子..但是，我并不完全理解。我的逻辑看起来正确吗？我有一个 div 作为按钮（.myClass 类），除非 myCount >= 1，否则我不希望它可点击。

```
// I want to unbind if myCount == 0
if ( myCount == 0) {
 $('.myClass').unbind().css("opacity","0.5");
} else {
 // **would this rebind?**
 $('.myClass').click(callMyFunction);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:21:23.033

我不确定您要实现的确切目标，但是`.unbind()`在不带参数调用时会删除所有附加到元素的处理程序。因此，`$('.myClass').unbind()`删除所有附加到具有 . 类的元素的事件处理程序`.myClass`。由于您似乎只添加了一个事件处理程序，`click`因此最好只取消绑定处理程序，如下所示`click`：`$('.myClass').unbind('click')`这样，如果您稍后添加其他事件，您就不会混淆为什么其他事件被解除绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:23:34.880

`click(callMyFunction)`是`.bind("click", callMyFunction)`or的简写`.on("click", callMyFunction)`。

将 use`on()`绑定到 unbind use `off()`。这些是自 jQuery 1.7 以来的首选方法。如果您使用的是旧版本，请使用`bind()`,`unbind()`或`delegate()`and`undelegate()`

```
$('.myClass').off('click') 
```

并绑定

```
$('.myClass').on('click', function(){}); 
```

正如另一篇文章中提到的，使用命名空间是对事件进行分类的另一种方法`click.mynamespace`，例如。

有关不同可用绑定方法的更多详细信息，请参阅[**这篇文章，以及何时引入以及替换了什么以及为什么。**](https://stackoverflow.com/a/11148053/448144)

更多资源：

*   [**点击（）**](http://api.jquery.com/click/)
*   [**解绑（）**](http://api.jquery.com/unbind/)
*   [**在（）**](http://api.jquery.com/on/)
*   [**离开（）**](http://api.jquery.com/off/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T19:23:56.043

您可以使用命名空间事件，与`on()`. `bind()`已被弃用。

```
var foo = function () { ... }

if (myCount)
  $('.myclass').on('click.foo', foo)
else
  $('.myclass').off('.foo') 
```

# sql-server - 审计 SQL Azure

> ID：11784259
> 
> 赞同：1
> 
> 时间：2012-08-02T19:14:24.177
> 
> 标签：sql-server, azure, azure-sql-database

据我了解，无法将安全事件日志复制到 WAD 诊断存储，并且 SQL Server 审核不适用于 SQL Azure。

您提出了哪些解决方案来审核对 SQL Azure 数据库的访问？

至少应该是登录名、IP 和时间；但最好也执行实际的 SQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T20:29:07.243

最近，Azure SQL 团队引入了一些新的系统视图，这些视图至少公开了登录信息。

宣布：Windows Azure SQL 数据库的新系统视图：http: [//azure.microsoft.com/blog/2012/11/05/announcing-new-system-views-for-windows-azure-sql-database/](http://azure.microsoft.com/blog/2012/11/05/announcing-new-system-views-for-windows-azure-sql-database/)

# objective-c - 在 iOS CFStreams 上设置代理不起作用

> ID：11784260
> 
> 赞同：2
> 
> 时间：2012-08-02T19:14:29.820
> 
> 标签：objective-c, ios, proxy, asyncsocket

我已经在我的 Mac 上设置了一个 squid http 代理，并且我已经设置了我的 Mac 以共享它的无线连接。在我手机上的 wifi 连接信息中，我设置了我的 HTTP 代理设置：

```
Server: 10.0.2.1
Port:   3128
Authentication: off 
```

在我的 iOS 应用程序中，我有两种访问网络的方式。对于 http 请求，我使用 NSURLRequest，对于其他 TCP 连接，我使用 AsyncSocket 库。

所有使用 NSURLRequest 的请求都使用代理没有问题（对于 SSL，代理充当 HTTP CONNECT 隧道）。但是，我似乎无法获得用于 AsyncSocket 连接的代理。

每当创建 CFStreams 时，我确实更新了 AsyncSocket 库以调用以下内容，例如：

```
//for printing out the proxy settings
static void printEntry (const void* key, const void* value, void* context) {
    CFShow(key);
    CFShow(value);
}

- (BOOL)createStreamsFromNative:(CFSocketNativeHandle)native error:(NSError **)errPtr
{
    // Create the socket & streams.
    CFStreamCreatePairWithSocket(kCFAllocatorDefault, native, &theReadStream, &theWriteStream);
    .
    .
    .
    CFDictionaryRef proxyDict = CFNetworkCopySystemProxySettings();
    CFDictionaryApplyFunction(proxyDict, printEntry, NULL); // I see the proxy settings are correct here

    CFReadStreamSetProperty(theReadStream, kCFStreamPropertyHTTPProxy, proxyDict);
    CFWriteStreamSetProperty(theWriteStream, kCFStreamPropertyHTTPProxy, proxyDict);

    CFRelease(proxyDict);
    return YES;
} 
```

我在这里错过了什么明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T04:42:05.327

您没有创建`CFHTTPRead`或编写流，因此套接字流正在忽略 `kCFStreamPropertyHTTPProxy`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:30:38.977

从苹果文档：

[https://developer.apple.com/library/ios/#DOCUMENTATION/Networking/Conceptual/CFNetwork/CFStreamTasks/CFStreamTasks.html#//apple_ref/doc/uid/TP30001132-CH6-DontLinkElementID_16](https://developer.apple.com/library/ios/#DOCUMENTATION/Networking/Conceptual/CFNetwork/CFStreamTasks/CFStreamTasks.html#//apple_ref/doc/uid/TP30001132-CH6-DontLinkElementID_16)

没有任何迹象表明这不应该工作。文档提到使用 CFStreams，而不是 CFHTTPStreams。

由于我无法让它按照文档所述工作并且我的时间不多了，所以我实现了自己的 HTTP 代理代码，这最终并不太难。如果配置表明设置了 HTTP 代理，我将初始连接重定向到代理并使用以下标头发起 HTTP 请求：

```
CONNECT <real host>:<real port> HTTP/1.1
Host: <real host>
Proxy-Connection: keep-alive
Connection: keep-alive 
```

在收到带有 200 响应代码的完整 http 响应后，我开始套接字通信，就好像直接与服务器通信一样（例如，调用 startTLS 来开始 SSL）。

# msbuild - 从 Nuget 包中引用 MSBuildTasks

> ID：11784268
> 
> 赞同：11
> 
> 时间：2012-08-02T19:15:15.557
> 
> 标签：msbuild, nuget

我正在尝试从 MSBuild 文件中引用 MSBuildTasks，但我不确定在将 NuGet 用于 MSBuildTasks 时如何执行此操作。

参考说使用

```
<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/> 
```

当您使用 msi 文件安装 MSBuildTasks 时。但是，从 NuGet 安装时，它会将其放在包含版本的子文件夹中，因此如果我升级 MSBuildTasks，它将破坏构建文件中的路径。通过 NuGet 安装 MSBuildTasks 时，引用它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-16T11:57:11.067

我最近使用 MSBuildTasks 版本 1.4.0.45为[resourcelib](https://github.com/dblock/resourcelib)设置了这个。在这个版本中，将它添加到项目中会导致 DLL 被放置在“构建”子目录中，看起来你需要签入。我试图让它自动下载，但如果它在项目文件中被引用，它需要从一开始就在那里。

要将其添加到项目中，我使用了以下代码：

```
 <PropertyGroup>
  <MSBuildCommunityTasksPath>$(MSBuildProjectDirectory)\Build</MSBuildCommunityTasksPath>
 </PropertyGroup>
 <Import Project="$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.Targets"/> 
```

这里`MSBuildProjectDirectory`正在使用，因此可以在命令行上使用 MSBuild 构建它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T08:37:00.433

只是把它扔在这里，以防其他人再次面临这个问题。貌似在通过NuGet安装MSBuildCommunityTasks的时候，解决方案中增加了一个.build文件夹，建议用源码签入。但是，MSBuild.Community.Tasks.targets 文件有一个`<MSBuildCommunityTasksPath>`元素指向 c:\Program Files(x86) 文件夹，这是不正确的。当您使用 MSI 安装 MsBuildCommunityTasks 时，此文件夹有效。这在 Nuget 的情况下无效，它将 MsBuildCommunityTasks 安装在解决方案的包文件夹中。所以我最终修改了 .targets 文件，并改为`MSBuildCommunityTasksPath`指向：

```
<MSBuildCommunityTasksPath>$(SolutionDir)\packages\MSBuildTasks.1.4.0.56\tools</MSBuildCommunityTasksPath> 
```

还是没有骰子。所以最后，我只是通过 web 项目文件进行编辑，并将 MSBuildCommunityTasks 的 Import 元素更改为：

```
<Import Project="$(SolutionDir)\packages\MSBuildTasks.1.4.0.56\tools\MSBuild.Community.Tasks.Targets"/> 
```

这是可行的，因为它直接告诉项目在包文件夹中查找 .Targets 文件。请注意，如果升级 MSBuildTasks 版本，则必须更改 Import 元素。我是一个 MsBuild 菜鸟，所以如果有人能告诉我如何自动化这个，那就太好了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-28T19:40:07.750

目前，1.4.0.128 在解决方案目录中创建 .build 文件夹（用于框架项目）。nuget 包未正确安装到 .Net Core 3.1 项目。我在我的解决方案中创建了一个 MsBuild.Community.Tasks 4.7.2 框架项目，并在那里部署了 nuget 包。现在我应该能够从我的 .NetCore 项目中调用它，如自述文件中所述：

```
<PropertyGroup>
    <MSBuildCommunityTasksPath>$(SolutionDir)\.build</MSBuildCommunityTasksPath>
</PropertyGroup>  

<Import Project="$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.Targets" /> 
```

# c# - MarshalDirectiveException at (wrapper managed-to-native)

> ID：11784273
> 
> 赞同：0
> 
> 时间：2012-08-02T19:15:44.153
> 
> 标签：c#, c, mono, xamarin.ios, wrapper

我在使用 c# 为 iPhone 构建应用程序时发现了这个错误错误。这个应用程序有一个将 System.Object 实例传递给 c 的插件我得到了这个，我不确定缺少什么部分！

这是 C# 代码：

```
public static void Call( System.IntPtr L, System.Delegate pDelegate)
{   
    MonoDelegateToPtr( L, 0, pDelegate.Method.Target, pDelegate.Method.Name, pDelegate.Method.GetParameters().Length);
}

[System.Runtime.InteropServices.DllImport("__Internal")]
static extern void MonoDelegateToPtr( System.IntPtr L, int pN, System.Object pObj, string pMethod, int pParamCount); 
```

* * *

这是C代码：

```
extern "C" void MonoDelegateToPtr( lua_State* L, int pN, MonoObject* pObj, const char* pMethod, int pParamCount)
{
   MonoMethod *method;

   MonoObject *pObject;
   method = GetCSMethod( pObject, pMethod, pParamCount);
   lua_CFunction func = (lua_CFunction)[MonoUtility MonoDelToPtr: method];
   if( func==0)
   {
      printf("****ERROR DELEGATE TO FUNCTION PTR IS NULL%s\n", pMethod);
      return;
   }

   lua_pushcclosure( L, func, pN);
}

MonoMethod* GetCSMethod( MonoObject *pObj, const char* pMethod, int pParamsTotal)
{
   MonoClass *class = mono_object_get_class( pObj);
   MonoMethod   *methodDef = mono_class_get_method_from_name(  class, pMethod,   pParamsTotal);

   return mono_object_get_virtual_method((MonoObject*)objectInstance, methodDef);
} 
```

这是错误消息：

```
MarshalDirectiveException 
```

在（包装器托管到本机）CSharpToMonoClass:MonoDelegateToPtr (intptr,int,object,string,int)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:52:24.520

问题是编组器不知道如何编组 System.Object。

我相信您可以使用 IntPtr，以及将 System.Object 转换为 IntPtr 的以下技巧：

```
struct ObjWr {
    [FieldOffset (0)] IntPtr ptr;
    [FieldOffset (0)] object obj;
} 
```

然后将对象存储在 obj 字段中并从 ptr 字段中读回指针。

但是，我不完全确定这是您尝试做的正确方法，但是我不清楚您实际上要做什么，所以也许您可以更好地解释一下？

# java - 从迭代中返回值列表

> ID：11784274
> 
> 赞同：0
> 
> 时间：2012-08-02T19:15:46.230
> 
> 标签：java, hashmap

当我用下面的代码遍历我的 hashmap 列表时，我得到的键和值是

```
 System.out.println( "   (" + key + "," + value + ")" ) 
```

但我希望我的值返回为

键 1：值 1

键 1：值 2

键 2：值 1

键 2：值 2... 以此类推。有人可以帮我吗。

```
 public static void main(String[] args)  {
    Map<String, List<String>> conceptMap = new HashMap<String, List<String>>();
    Map<String, List<String>> PropertyMap = new HashMap<String, List<String>>();
    try{
    Scanner scanner = new Scanner(new   FileReader("C:/"));

        while (scanner.hasNextLine()){
        String nextLine = scanner.nextLine();
        String [] column = nextLine.split(":");
        if (column[0].equals ("Property")){
        if (column.length == 4) {
        PropertyMap.put(column [1], Arrays.asList(column[2], column[3]));   
            }
        else {
        conceptMap.put (column [1], Arrays.asList (column[2], column[3]));
            }
        }
        }
        Set<Entry<String, List<String>>> entries =PropertyMap.entrySet();
          Iterator<Entry<String, List<String>>> entryIter = entries.iterator();
          System.out.println("The map contains the following associations:");
          while (entryIter.hasNext()) {
             Map.Entry entry = (Map.Entry)entryIter.next();
             Object key = entry.getKey();  // Get the key from the entry.
             Object value = entry.getValue();  // Get the value.
             System.out.println( "   (" + key + "," + value + ")" );
          }
        scanner.close();

        }   

        catch (Exception e) {
        e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:20:57.757

替换这个：

```
 System.out.println( "   (" + key + "," + value + ")" ); 
```

和

```
for (Object listItem : (List)value) {
    System.out.println(key + ":" + listItem);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:18:42.237

使用 a`LinkedHashMap`并且您`put`在地图中输入的顺序将与您遍历它们的顺序相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:23:19.573

```
while (entryIter.hasNext()) {

      //...
      String key = entry.getKey();  // Get the key from the entry.
      List<String> value = entry.getValue();  // Get the value.

      for(int i = 0; i < value.size(); i++) {
          System.out.println( "   (" + key + "," + value.get(i) + ")" );
      }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:23:55.390

所以你想打印出列表中的值？代替：

```
Object value = entry.getValue();  // Get the value.
System.out.println( "   (" + key + "," + value + ")" ); 
```

有了这个：

```
List<String> value = entry.getValue();
for(String s : value) {
    System.out.println(key + ": " + s);
} 
```

# stored-procedures - OpenJPA：存储过程的结果映射到对象时如何控制并发？

> ID：11784275
> 
> 赞同：0
> 
> 时间：2012-08-02T19:15:46.383
> 
> 标签：stored-procedures, concurrency, openjpa

我刚刚开始研究 OpenJPA，试图了解它是否满足我的需求。我已经阅读了一些有关 OpenJPA 并发控制的内容，并且知道如何创建命名存储过程 (@NamedStoredProcedureQuery) 并将其结果集映射到 POJO 实例列表。但是，我不明白这个组合，也找不到任何具体的文档......

如果我不通过 JPA 执行 SELECT/UPDATE/DELETE/INSERT 操作，而只是使用它将存储过程的结果映射到我的 POJO，它仍然能够处理并发吗？

问题是，我将使用存储过程来选择对象，然后当我更改它们时，我使用不同的存储过程来更新这些对象。它如何知道另一个存储过程是否在我这样做之前更新了同一个表？它是否跟踪我的 POJO 对象的状态（假设它由@Entity 标记）？它是否在调用映射到它的任何存储过程之前查询该表（假设我告诉 JPA 该对象可以映射到哪个表）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T15:44:47.493

我没有使用过 OpenJPA，但分析它的方法很少。

第一种方法是在 OpenJPA 中查找 Hibernate 的类似 showsql 的配置。

您可以尝试的下一件事是查找任何查询日志。MySQL 提供查询日志。

像 Hibernate 这样的 JPA 提供程序通常会生成一对一的查询。即对于更新，它不会先选择表。JPA 还定义了 JPA 提供者实现的锁定机制。

[https://blogs.oracle.com/carolmcdonald/entry/jpa_2_0_concurrency_and](https://blogs.oracle.com/carolmcdonald/entry/jpa_2_0_concurrency_and)

这与隔离级别相结合可以帮助您调整行为。

此外，您可以使用检查和更新。以下查询的效果。

```
UPDATE some_table SET column_a = 456 where column_a = 123 and id = 1 
```

最后，反对使用存储过程的建议。JPA 的实用程序是独立于供应商的，这通过使用存储过程而减少。

# php - 重复行输出 PHP - 连接的 fgets

> ID：11784285
> 
> 赞同：3
> 
> 时间：2012-08-02T19:16:08.947
> 
> 标签：php

我正在一个测试站点上工作，该站点提供房地产之类的搜索信息。除了房屋的图像外，还有通过目录访问引入的描述。我的所有行都正常工作，除了“描述：”行。在文本文件中，每个类别都由行分隔，除了“描述：”类别在标题行之后运行并分成多行直到文件末尾。我正在使用串联的 fgets 来获取信息，但在我的结果中，输出正确显示了完整的房屋信息，包括“描述：”行，但是在每个后​​续结果中，房屋信息都会重复之前打印的内容，然后是其余部分下一个文件。如果我摆脱串联并做一个常规：

```
$pos = stripos($line, 'Description:');

if($pos !== false)
{
$description = substr($line, 12);
$description = trim($description);
} 
```

然后我最终只打印“描述：”而没有描述部分的文本。

这是导入的文本文件的示例：

城市：OceanCove
价格：950,000 美元
卧室：5
浴室：3
影片：3000 平方英尺
房地产经纪人：Shirley Urkiddeng
Grabber：美景之家！
描述：
您永远不会厌倦在客厅沙发上观看日落或在后门廊欣赏日出，俯瞰美丽的珊瑚峡谷。千载难逢的机会！

这是我的代码（在“描述”部分有一些注释掉了我所做的其他试验：

```
 <?php
$findhome = $_POST['findhome'];

$header = getHeader($findhome);
print $header;

getResults($findhome);

    function getHeader($findhome)
    {
if (empty($findhome))
    {
        $header = "<h3>Current Listings: <br />";
    }
    else
    {
        $header = "<h3>Current Listings that match: $findhome </h3><br />";
    }

    return $header;

    }

    function getResults($findhome)
    { 

if (empty($findhome))
{
    $findhome ='ALL';
}

$dirname = 'images';

$dirhandle = opendir($dirname);

if ($dirhandle)
{
    $houseimagesarray = array();

    while (false !== ($file = readdir($dirhandle)))
    {
        if ($file !='.' && $file !='..')
        {
            $first_6 = substr($file,0,6);

            if($first_6 =='house_')
            {
                array_push($houseimagesarray, $file);
            }
        }
    }
}

sort($houseimagesarray);

    $description = '';

foreach ($houseimagesarray as $image_filename)
{

//***************************************************
//** Function Definitions
//***************************************************

    //Get Image Files

            $imagename ='images/'.$image_filename; //.jpg files
            $house_img = "<p><img src='".$imagename."'></p>";

            $houseinfo_filename = str_replace ('.jpg', '.txt',           $image_filename);

            $filename = 'data/'.$houseinfo_filename; //.txt file

            $fp = fopen($filename, 'r');

    //Get Image House Information

    $show_house = 'Y';  //Set default value

    while(true)
    {
        $line = fgets($fp);

        if (feof($fp))
        {
            break;
        }

        $pos = stripos($line, 'City:');

        if ($pos !== false)
        {
            $city = substr($line, 5);
            $city = trim($city);

            if ($findhome != 'ALL')
            {
                $subpos = stripos($city, $findhome);

                if($subpos === false)
                {
                    $show_house = 'N';
                    break;
                }
            }
        }

        $pos = stripos($line, 'Price:');

        if ($pos !==false)
        {
            $price = substr($line, 6);
            $price = trim($price);
        }

        $pos = stripos($line, 'Bedrooms:');

        if ($pos !== false)
        {
            $bedrooms = substr($line, 9);
            $bedrooms = trim($bedrooms);
        }

        $pos = stripos($line, 'Baths:');

        if ($pos !== false)
        {
            $baths = substr($line, 6);
            $baths = trim($baths);
        }

        $pos = stripos($line, 'Footage:');

        if($pos !== false)
        {
            $footage = substr($line, 8);
            $footage = trim($footage);
        }

        $pos = stripos($line, 'Realtor:');

        if($pos !== false)
        {
            $realtor = substr($line, 8);
            $realtor = trim($realtor);
        }

        $pos = stripos($line, 'Grabber:');

        if($pos !== false)
        {
            $grabber = substr($line, 8);
            $grabber = trim($grabber);
        }

        $pos = stripos($line, 'Description:');

        if($pos !== false)
        {
            $descriptionFlag = "Y";
        }
        if($descriptionFlag=='Y')
        {
            $description .=$line."<br />\n";
            //$description =$line."<br />";
            //$description = $description.$line."<br />";
        } 
    }

    if ($show_house == 'Y')
    {
        print $house_img;

        print "<h3>".$grabber."</h3><br />";
        print "City: ".$city."<br />";
        print "Bedrooms: ".$bedrooms."<br />";
        print "Baths: ".$baths."<br />";
        print "Price: ".$price."<br />";
        print "Footage: ".$footage."<br />";
        print "Realtor: ".$realtor."<br />";

        print $description;

      }

      }
     }  
    ?> 
```

新代码：

```
 $pos = stripos($line, 'Description:');

        if($pos !== false)
        {
            $descriptionFlag = "Y";
        }
        if($descriptionFlag=='Y')
        {
            if(!feof($fp))
            {
                $description .=$line."<br />\n";

                if(feof($fp))
                {
                    break;
                }

            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:30:19.597

由于`Description`可能包含多行，因此您必须遍历这些行，直到完成该`Description`字段。如果您在同一个文件中有多个项目，您可能需要搜索下一个项目`City`以进行救助。就像是：

```
if($descriptionFlag=='Y') {
  while ($line = fgets($handle, 8192)) {
      $line = trim($line);
      if($line === 'City')
        break;
      $description = $description . " " . $line;
  }
  $description = $description . "<br />\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:30:34.227

尝试

```
if($descriptionFlag=='Y') {
  while ($line = fgets($handle, 8192)) {
      $line = trim($line);
      if(substr($line,0,4) === 'City')
        break;
      $description = $description . " " . $line;
  }
  $description = $description . "<br />\n";
} 
```

# mysql - 在查询“SELECT 1 ...”中使用“LIMIT 1”是否有意义？

> ID：11784289
> 
> 赞同：12
> 
> 时间：2012-08-02T19:16:37.263
> 
> 标签：mysql, sql, database

这个问题应该足够清楚，但是使用它来代替有什么好处吗？

`SELECT 1 FROM table ...`

`SELECT 1 FROM table ... LIMIT 1`?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-02T19:18:49.820

假设您的表有一百万行...

```
SELECT 1 FROM table ... 
```

将返回值`1`，一百万次...

```
SELECT 1 FROM table ... LIMIT 1 
```

将返回值`1`，一次。

* * *

**编辑**

您提到您对`EXISTS`支票特别感兴趣。 `EXISTS`在找到第一行后停止处理（这就是为什么`EXISTS`比`IN`这种情况更有效的原因），因此考虑到这一点，这两个查询之间没有功能差异：

```
SELECT *
FROM tableA ta
WHERE EXISTS (
    SELECT 1
    FROM TableB tb
    WHERE tb.ID = ta.ID
); 
```

和

```
SELECT *
FROM tableA ta
WHERE EXISTS (
    SELECT 1
    FROM TableB tb
    WHERE tb.ID = ta.ID
    LIMIT 1
); 
```

# css - 如何为 UI 小部件使用绝对或固定动态定位

> ID：11784291
> 
> 赞同：1
> 
> 时间：2012-08-02T19:16:45.570
> 
> 标签：css, positioning

我即将在 javascript 中创作这个客户端小部件滑块。

当用户回答问题时，滑块会增加。

我可以让滑块背景变大和缩小，但我不太确定的是让“65%”指示器“粘”到蓝色 div 的末尾，并作为滑块背景自动移动增长和缩小。

由于这是 javascript，我很喜欢动态设置指标的绝对位置。好的，我还没有真正尝试过任何东西，因为我猜有很多方法可以实现这一点，所以想得到一些意见。我什至在考虑使用 qTip ......但是很高兴看到这与 css 作为一个浮动框锚定到另一个框

我正在想象改变两个并排 div 的宽度（完成与未完成），并让指示器相对于其容器绝对定位，以便它随着宽度的变化而移动。

可能的？

这就是我所说的：

![在此处输入图像描述](../Images/3dda2d3db22634f1044106ae3777a244.png)

**工作示例**（感谢菲利普的回答）

[http://jsfiddle.net/HP7V9/](http://jsfiddle.net/HP7V9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:30:53.997

我可能只是使用 jQuery 将其锚定在加载的 div 的右侧和它的高度的中间点。

所以假设我们有这个 DOM：

然后，假设您已经有调整栏大小的逻辑，这个 jQuery 就可以了：

```
$("#loaded").resize(function(){
    var loadedDiv = $("#loaded");
    var loadedPosition = loadedDiv.position();
    var percentXPos = loadedPosition.left + loadedDiv.width() - $("#percent").width()/2;
    var percentYPos = loadedPosition.top + loadedDiv.height() / 2 - loadedDiv.height() / 2;

    $("#percent").css({
        position: "absolute",
        top: percentYPos.toString() + "px",
        left: percentXPos.toString() + "px"
    });
}); 
```

另外，我认为没有任何理由为未加载的部分设置 div。你应该为整个栏创建一个 div 并给它一个黑色背景，然后给加载的 div 一个更高的 z-index 和不同的背景颜色。

请记住，它可能需要根据元素的边距、填充等进行细微调整。

# php - joomla 2.5：ajax登录，检查用户名和密码是否正确

> ID：11784296
> 
> 赞同：0
> 
> 时间：2012-08-02T19:16:59.783
> 
> 标签：php, ajax, hash, joomla

我正在为**joomla 2.5**开发 AJAX 登录表单。一切正常，我需要实现的最后一件事是密码检查。这段代码正在接收密码：

```
$password = $_POST['password']; 
```

在数据库中，密码看起来像这样

```
0c7aca777a2fec9c962a0e3938b8cb0f:7Zv9CyiSiIzFYDS7RtqrzsxuenjmmOgi 
```

这就是查询（暂时不要介意安全）

```
$mysqli->query("SELECT username FROM q4jli_users WHERE username='$username' AND password='$password'"); 
```

散列密码的第二部分是随机盐，所以我认为无法检查，也许我应该只检查散列密码的第一部分。

有任何想法吗？非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:28:03.140

查看[Joomla API 文档](http://docs.joomla.org/Plugin)。如果您在那里没有找到您需要的东西，请查看默认的 joomla authenticationatin 插件`plugins\authentication\joomla\joomla.php`，它是随 Joomla 一起安装的一些其他身份验证插件。

最后，这个问题：[Custom PHP function to verify correct password in Joomla](https://stackoverflow.com/questions/8015106/custom-php-function-to-verify-correct-password-in-joomla)也可能有所帮助。

# sql - 如何在 SQL 中组织问题和答案？

> ID：11784297
> 
> 赞同：0
> 
> 时间：2012-08-02T19:17:18.130
> 
> 标签：sql, sql-server, database

我需要在我的 SQL (Azure) 服务器中构建一个良好的“问答”结构。我正在考虑这样做：

```
table question
    id float (we could have lots of questions, so that's why float and don't int)
    nvarchar question (question can vary in size of characters)
    id_answer float

table answer
    id float
    nvarchar answer 
```

您认为这是一个好方法吗？我必须考虑不同类型的问题，我可能会有这样的问题：

```
question: Who invented the lamp ?
answer:   Thomas Edson

question: Thomas Edson invested the lamp ?
answer: No. (true or false) 
```

你们知道其他一些好的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:02:08.037

上次我做一个问答系统时，它处理了由多页问题组成的调查。答案可以是复选框、单选按钮或用于多项选择的选择框，或文本输入（可选地限制为整数值）。

这些表看起来像这样：

```
-- There are pages of questions.

CREATE TABLE [dbo].[Pages] (
    [PageId] [int] IDENTITY (1, 1) NOT NULL ,
    [Name] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Description] [varchar] (1024) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [PageTypeId] [int] NOT NULL 
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[PageTypes] (
    [PageTypeId] [int] IDENTITY (1, 1) NOT NULL ,
    [Name] [varchar] (32) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Description] [varchar] (1024) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[TargetPages] (
    [QuestionId] [int] NOT NULL ,
    [PageId] [int] NOT NULL ,
    [Rank] [int] NOT NULL 
) ON [PRIMARY]
GO

-- Questions have input fields.  Perhaps a text entry, perhaps several multiple-guess choices.

CREATE TABLE [dbo].[Questions] (
    [QuestionId] [int] IDENTITY (1, 1) NOT NULL ,
    [StartDate] [datetime] NOT NULL ,
    [EndDate] [datetime] NOT NULL ,
    [Description] [varchar] (1024) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Filespec] [varchar] (128) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Fields] (
    [QuestionId] [int] NOT NULL ,
    [FieldId] [int] IDENTITY (1, 1) NOT NULL ,
    [FieldName] [varchar] (64) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [InputTypeId] [int] NOT NULL ,
    [Description] [varchar] (256) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[InputTypes] ( -- Roughly: checkbox, radio button, text, textarea or select list.
    [InputTypeId] [int] IDENTITY (1, 1) NOT NULL ,
    [InputTypeName] [varchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Choices] [bit] NOT NULL ,
    [NumericValue] [bit] NOT NULL
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Choices] ( -- Defines radio button or select list choices for multiple choice questions.
    [FieldId] [int] NOT NULL ,
    [cName] [varchar] (64) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [cValue] [varchar] (64) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
    [Rank] [int] NOT NULL 
) ON [PRIMARY]
GO

-- Then we have the answers supplied by users.

CREATE TABLE [dbo].[Inquiries] ( 
    [InquiryId] [int] IDENTITY (1, 1) NOT NULL ,
    [UserId] [int] NOT NULL ,
    [QuestionId] [int] NOT NULL ,
    [dTimestamp] [datetime] NOT NULL ,
    [ResponseSequence] [int] NOT NULL
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Users] (
    [UserId] [int] IDENTITY (1, 1) NOT NULL ,
    [Username] [varchar] (16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Responses] ( -- Multiple choice.
    [InquiryId] [int] NOT NULL ,
    [FieldId] [int] NOT NULL ,
    [FieldValue] [varchar] (1024) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[IntegerResponses] ( -- User supplied integer or multiple choice value.
-- NB: Checkbox values are handled thusly: a row here indicates the box was checked, no row is unchecked.  The value is meaningless.
    [InquiryId] [int] NOT NULL ,
    [FieldId] [int] NOT NULL ,
    [FieldValue] [int] NOT NULL 
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[TextResponses] ( -- User supplied text.
    [InquiryId] [int] NOT NULL ,
    [FieldId] [int] NOT NULL ,
    [FieldValue] [varchar] (1024) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
) ON [PRIMARY]
GO
exec sp_addextendedproperty N'MS_Description', N'1 ==> Values are in the   Choices   table.', N'user', N'dbo', N'table', N'InputTypes', N'column', N'Choices'
GO
exec sp_addextendedproperty N'MS_Description', N'1 ==> Values are numeric.', N'user', N'dbo', N'table', N'InputTypes', N'column', N'NumericValue'
GO 
```

查询一直在限制 a 中允许的表数`SELECT`，256 左右。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T09:38:28.567

我绝对不会选择浮点数，因为它是一种非精确和非确定性的数据类型。尝试改用 bigint。据我所知，浮点数很难放入索引中。不知道 sql 数据库 (azure) 和/或 sql server 2012 虽然

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:22:00.520

这取决于您的问题将如何构建。

如果您有自由文本输入，并且只有一个正确答案，那么将问题与答案分开是没有意义的，因此在问题表中有一个答案字段。但是你依赖正确的拼写等。

如果您计划对一个问题提供多项选择答案，那么您希望在 Answers 表中拥有 QuestionID，而不是上面的设置。

您还可以在问题和答案之间设置一个表格，以便一个答案可以是多个问题的答案。

而且您的 ID 想要是整数，而不是浮点数；如果超出整数范围，请使用唯一标识符。*浮点数*不精确

# target - SCons：将目标链接到 SConscript

> ID：11784298
> 
> 赞同：0
> 
> 时间：2012-08-02T19:17:19.230
> 
> 标签：target, scons

我对**SCons**的目标功能有点困惑。我目前正在尝试创建一个简单的目标`check`来启动`Boost.Test`位于我的`tests`文件夹中的套件。为了启动所有测试，我有一个文件，我只需调用该方法`tests/SConscript`即可在其中注册包含我的测试的 cpp 文件。`Program`

我只想告诉**SCons**，如果请求目标，他需要调用该`tests/SConscript`文件`check`，否则，只需通过调用来构建程序`src/SConscript`

```
$> scons check 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T08:17:41.557

`scons`正如您在回答中提到的，您可以使用 SCons Alias() 函数为一个或多个目标分配名称，但是如果您只是执行而不指定目标，这不会告诉 SCons 何时构建目标。当您不指定任何目标时，您会注意到将构建和/或执行单元测试。

要告诉 SCons 应该构建什么，您可以使用[SCons Default() 函数](http://www.scons.org/doc/2.2.0/HTML/scons-user/x2810.html#AEN2829)。当您不使用此功能时，默认情况下会构建每个目标：显然只有那些需要构建的目标，根据依赖关系等。

要仅在默认情况下构建目标`src/SConscript`，然后假设它是一个库，您可以执行以下操作：

```
libTarget = env.Library('yourLib', theSourceFiles)
env.Default(libTarget) 
```

您可以对几个不同的目标使用 Default() 函数。

现在，当您在`scons`没有任何目标的情况下执行时，只会构建那些使用 Default() 函数设置的目标。如果您执行`scons check`，则将构建检查目标及其依赖项（假设您使用检查目标调用 Alias() 并且还没有使用检查目标调用 Default() ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:56:51.507

我要回答我自己的问题。根据我所见，您可以使用 SCons 中的别名将**Builder**绑定到`rule`.

我在这个地址阅读了 Chris Foster 的一篇文章：[http](http://www.scons.org/wiki/UnitTests) ://www.scons.org/wiki/UnitTests提出了以下想法：

对于我们要添加的每个测试，我们将其添加到`check`目标中，如下所示：

```
prog = env.Program(...)
env.Alias('check', prog)
env.Alias(nameOfTheTest, prog) 
```

这样，我可以通过两种不同的方式调用我的测试：

```
$> scons check             # Calls all the tests of the suite
$> scons nameOfTheTest     # Only calls the test we added 
```

希望有帮助。谢谢

# iphone - 如何将 UITableView 与从互联网上解析的数据分离？

> ID：11784299
> 
> 赞同：0
> 
> 时间：2012-08-02T19:17:18.633
> 
> 标签：iphone, cocoa-touch, uitableview, uiviewcontroller, xml-parsing

我有一个`UITableView`填充了来自 Internet 的已解析 XML 元素。

一切正常，但我想将解析 XLM 元素的代码与`UIViewController`负责填充 this的代码分开`UITableView`。

我试过 sublassing `UIViewController`，但它似乎会导致许多耦合问题。

分离此 XML 异步解析器代码，然后将其结果提供给`UIViewController`包含`UITableView`?

我不太了解代表，但这是要走的路吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:41:51.173

编写一个处理解析的对象，在视图控制器中创建它的一个实例，然后调用它来加载数据：

```
@protocol SomeXMLParserHandler <NSObject>

- (void) handleData:(NSArray *)data;

@end

@interface SomeXMLParser : NSObject<NSXMLParserDelegate>

@property (strong, nonatomic) id<SomeXMLParserHandler> handler;

- (void) parseSomeXMLFromURL:(NSString *)url
            andPassToHandler:(id<SomeXMLParserHandler>)handler;

@end 
```

在此示例中，**SomeXMLParser**将完成所有繁重的工作，并在完成后将数组传回**SomeXMLParserHandler**。因此，在您的视图控制器中，您可以执行类似的操作：

```
- (void) viewDidLoad
{
    [super viewDidLoad];

    SomeXMLParser *parser = [[SomeXMLParser alloc] init];

    [parser parseSomeXMLFromURL:@"http://someurl"
               andPassToHandler:self];
}

- (void) handleData:(NSArray *)data
{
    self.tableViewData = data;
} 
```

这不是工作代码，但它应该让你朝着正确的方向前进，特别是如果你已经让解析代码工作了。此外，如果您进入 Blocks ......您可以在解析完成后将协议替换为 Block 引用来完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:33:55.320

您的模型应该处理数据的获取和解析，然后当它完成后，您可以使用 NSNotificationCenter 通知您的视图控制器有关新数据的信息。
例如，您可以执行以下操作：

在您的模型中定义一些`MyModelDidFinishFetchingDataNotification`并在您完成获取和解析数据时调用它

然后当你创建你的 viewController 时，将它作为观察者添加到你的模型通知中

```
- (id)init
{
    self = [super init];
    if (self) {
        //
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(handleMyModelDidFinishFetchingDataNotification:)
                                                     name:MyModelDidFinishFetchingDataNotification
                                                   object:nil];
    }
    return self;
} 
```

在 viewDidLoad 告诉你的模型去获取数据

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [self.myModel fetchNewDataFromServer];
} 
```

实现处理新数据的方法

```
- (void)handleMyModelDidFinishFetchingDataNotification:(NSNotification *)not
{
    NSArray *newData = [[not userInfo] objectForKey:@"someNewData"];

    // set the new data to the viewController data property
    self.myData = newData

    // update the UI
    [self.tableView reloadData];
} 
```

# html - 过时与不推荐使用的 HTML

> ID：11784301
> 
> 赞同：12
> 
> 时间：2012-08-02T19:17:30.880
> 
> 标签：html

关于 HTML，术语“过时”和“弃用”之间有什么区别？我似乎看到很多元素在 HTML5 中被标记为“过时”......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T20:14:44.027

在 HTML 4.01 规范中，第[4.1 节定义](http://www.w3.org/TR/html401/conform.html#h-4.1)将“弃用”和“过时”定义为技术术语。简而言之，不推荐使用的功能是您不应该使用的，但浏览器应该继续支持它。过时的功能只是出于历史目的而列出，未定义，并且不需要浏览器支持（尽管实际上它通常仍然存在）。HTML 4.01 声明大多数旧的表示元素和属性已弃用。只有少数非常不重要的元素在那里被宣布为过时的。

在 W3C HTML5 草案中，术语是不同的。它根本没有使用“弃用”这个词（除非在 HTML 4.01 中提到使用这个词）。它没有将“过时”定义为技术术语（适用于 HTML 的功能），但它大量使用了这个词。该词在[11 个过时的功能](http://www.w3.org/TR/html5/obsolete.html#obsolete)部分中隐含定义。该草案告诉，根据功能的不同，语气和专业有所不同，作者不要使用过时的功能，但希望浏览器继续支持它们。它还包含对其语法和语义的详细描述，部分甚至比旧规范更详细。

在 HTML5 草案中，大部分过时的特性也被归类为“不合格”，并声明它们“不得被作者使用”。这些功能涵盖了 HTML 4.01 中已弃用的大部分功能，以及更多功能，包括 HTML 4.01 中根本没有的功能。

例如，该`font`元素在 HTML 4.01 中已弃用，在 HTML5 中已过时。所以原则上，你不应该使用 HTML 4.01，HTML5 说你不应该使用它（并且 HTML5 验证器被告知发出错误消息，而不仅仅是警告）。在实践中，差异较小，主要只是原则问题。浏览器仍然需要解析元素并将其添加到文档树中，并且它们应该像以前一样实现它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-02T19:19:48.130

字典很好地讲述了这个故事：

**[已弃用](http://oxforddictionaries.com/us/definition/american_english/deprecate?q=deprecated)**：表示不赞成。

**[过时](http://oxforddictionaries.com/us/definition/american_english/obsolete?q=obsolete)**的：不再生产或使用；过时了。

*建议*您不要使用不[推荐使用的元素](http://www.w3.org/TR/html401/conform.html#deprecated)，因为它们将来可能不会被支持，而*[过时](http://www.w3.org/TR/html401/conform.html#didx-obsolete)*的元素已经停止使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:19:16.387

过时通常意味着它已被其他东西取代。

已弃用意味着未来的发展可能不支持它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:22:04.230

在您的问题中，您引用了一篇博客文章，该文章随后链接到有关过时元素的 W3 规范。

[http://www.w3.org/TR/html5/obsolete.html#obsolete](http://www.w3.org/TR/html5/obsolete.html#obsolete)

因此，由于您链接到的博客回避，永远不应使用过时的元素，有可用的替代品。对于不推荐使用的元素，浏览器通常仍会支持并呈现它们以实现向后兼容性，但您的页面不会通过一致性验证。

# html - 如何使用浮动内容使 div 可扩展

> ID：11784304
> 
> 赞同：0
> 
> 时间：2012-08-02T19:17:49.313
> 
> 标签：html, css, css-float, css-position

我想设计一个可扩展的`div`，它应该根据里面的内容进行扩展。内容有两个`div`s，向左浮动，每个都有固定的宽度。这些`div`s 本身可以根据其文本内容进行扩展。最后，它们是`div`父级中的一个，`div`这些`div`s 意味着两个清除两个浮点数。然而，父级`div`并没有扩展到包含子`div`级，尽管我认为应该这样做，因为所有元素都是相对定位的，而不是绝对定位的。如何实现扩展？小提琴位于[http://jsfiddle.net/Cupidvogel/y79NS/1/](http://jsfiddle.net/Cupidvogel/y79NS/1/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:25:45.333

如果我理解你可以尝试添加`overflow: hidden;`类`.main`风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:25:47.407

将 float:left 添加到您的主 div ".main" （这样做您将不再需要 clear:both div，因为现在所有元素都是浮动的）

[http://jsfiddle.net/y79NS/4/](http://jsfiddle.net/y79NS/4/)

您仍然可以像在示例中一样使用 clear:both 属性，这样您就不需要将 float:left 添加到主 div 中，但是您将 clear div 放在错误的位置。这应该放在浮动右侧 div 内，或者您可以删除 .clear div 并使用 ":after" 清除 div：

[http://jsfiddle.net/y79NS/5/](http://jsfiddle.net/y79NS/5/)

这是一个[链接](http://www.positioniseverything.net/easyclearing.html/)，可以解释为什么会这样。

# javascript - 撤消简单的 javascript 事件 - 从文本框中删除花括号

> ID：11784305
> 
> 赞同：2
> 
> 时间：2012-08-02T19:17:51.457
> 
> 标签：javascript, textbox

`textbox`我正在尝试使用 javascript添加和删除值周围的花括号。

到目前为止，我所做的是正确添加它们，但我无法在`uncheck`. 这是我的代码：

```
 <script>

 Toggle();
 function Toggle(){
 if (document.form1.icd.checked){
 document.form1.amln.value= "{" + document.form1.amln.value + "}";
 } 

 }
 </script>

<input type="checkbox" name="icd" value="icd" onClick="Toggle();" /> 

<input type="text" name="amln" id="amln" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:29:32.577

**比赛开始和结束**

```
var tb = document.form1.amln;
tb.value = tb.value.replace(/[{}]/g,"") 
```

**删除任何 { 和 }**

```
var tb = document.form1.amln;
tb.value = tb.value.replace(/[{}]/g,""); 
```

**将其与支票结合起来**

```
function addBraces() {
    var fm = document.form1,
        tb = fm.amln;
    tb.value = tb.value.replace(/[{}]/g,"");  //doing it here in case {} already exist
    if (fm.icd.checked) {
        tb.value = "{" + tb.value + "}";
    } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:21:05.397

您是否还想摆脱用户输入的任何花括号（或者不必担心）？如果是这样，一些简单的正则表达式应该可以工作：

```
var tb = document.form1.amln;
tb.value = tb.value.replace(/\{/g).replace(/\}/g); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:28:01.653

要移除大括号，请使用：

```
function Toggle() {
    var form = document.form1;
    var field = form.amln;

    if (form.icd.checked) {
        field.value = "{" + field.value + "}";
    } else {
        field.value = field.value.replace(/(^\{|\}*$)/g, '');
    }
} 
```

如果只想删除每个前大括号或尾大括号中的第一个，您可能需要做一些更复杂的事情。

```
field.replace(/\{/, '').split('').reverse().join('').replace(/\}/, '').split('').reverse().join(''); 
```

这种操作的效率可能不是最好的，但如果您使用的是小字符串，它可能并不重要。

# c# - 如何连接两个 List 类型的 C# 列表 >。我有一些重复的值，我需要那些重复的值

> ID：11784306
> 
> 赞同：3
> 
> 时间：2012-08-02T19:17:52.840
> 
> 标签：c#, .net, list, generics, concatenation

任何 LINQ 解决方案（最好）将不胜感激。在连接两者时我需要重复的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:19:40.520

如果要找出两个列表中都有哪些项目，则需要使用该[`Enumerable.Intersect()`](http://msdn.microsoft.com/en-us/library/bb460136.aspx)方法。

```
 var list1 = new List<KeyValuePair<string,string>>();
    var list2 = new List<KeyValuePair<string,string>>();

    list1.Add(new KeyValuePair<string,string>("key1", "value1"));
    list1.Add(new KeyValuePair<string,string>("key2", "value2"));
    list2.Add(new KeyValuePair<string,string>("key1", "value1"));
    list2.Add(new KeyValuePair<string,string>("key3", "value3"));

    var inBothLists = list1.Intersect(list2); // contains only key1,value1 
```

有两种重载，一种是[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)这样，如果默认的没有按照您想要的方式执行比较，您可以编写并提供您自己的。

# r - 使用 maps 和 ggplot2 包，您可以将 latlong 对关联到一个状态吗

> ID：11784307
> 
> 赞同：1
> 
> 时间：2012-08-02T19:17:57.790
> 
> 标签：r, maps, ggplot2

例如，假设我有美国每家麦当劳餐厅的 latlong 对，没有别的。我可以使用 maps/ggplot2 包，即在每个州的中心放置一个圆，其半径与麦当劳的数量成正比吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:46:15.547

应该查看地图参考指南。函数 map.where 很好地解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:12:22.167

查看空间任务视图，链接在 CRAN 主站点的文档中。此功能位于 sp 包和 rgeos 包中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-20T15:45:48.373

另一种更快的方法是使用 package.json 的功能`over`。`sp`事实上，数据库`map.where`已经相当过时了（看看欧洲！）。您需要一个`SpatialPolygonsDataFrame`带有美国边界的数据框和一个带有 latlong 对的数据框，然后您需要将数据框转换为`SpatialPoints`最终可以使用该`over`函数。下面的代码可以用在 package.json 提供的世界地图上`maptools`。

```
require(sp)
require(maptools)
data(wrld_simpl)
pts = SpatialPoints(my_lat_long_pairs_data_frame, CRS(proj4string(wrld_simpl)))
my_countries = over(pts, wrld_simpl)$NAME 
```

# playframework-2.0 - Play 2.0.2 Futures 在 [5000] 毫秒后超时

> ID：11784309
> 
> 赞同：0
> 
> 时间：2012-08-02T19:18:03.110
> 
> 标签：playframework-2.0, akka

使用的是什么版本的 Akka Play 2.0.2？似乎 Akka 已经在这个问题中删除了未来的超时。[https://www.assembla.com/spaces/akka/tickets/1433](https://www.assembla.com/spaces/akka/tickets/1433)

为什么我仍然收到超时异常？

```
2012-08-02T18:51:59+00:00 app[web.1]: play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[TimeoutException: Futures timed out after [5000] milliseconds]]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [play_2.9.1-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [play_2.9.1-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]: Caused by: java.util.concurrent.TimeoutException: Futures timed out after [5000] milliseconds
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.dispatch.DefaultPromise.ready(Future.scala:870) ~[akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.dispatch.DefaultPromise.result(Future.scala:874) ~[akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at akka.dispatch.Await$.result(Future.scala:74) ~[akka-actor-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.api.libs.concurrent.AkkaPromise.await(Akka.scala:43) ~[play_2.9.1-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.api.libs.concurrent.Promise$class.await(Promise.scala:55) ~[play_2.9.1-2.0.2.jar:2.0.2]
2012-08-02T18:51:59+00:00 app[web.1]:   at play.api.libs.concurrent.AkkaPromise.await(Akka.scala:28) ~[play_2.9.1-2.0.2.jar:2.0.2] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:18:50.293

为了回答您的第一个问题，从 2.0.2 标签开始，Play 使用 Akka 2.0.2

你可以[在这里查看](https://github.com/playframework/Play20/blob/2.0.2/framework/project/Build.scala#L186)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-15T02:24:23.077

对于任何对 Play 2.2 中的新 status() 方法感兴趣的人，这就是我在测试期间增加超时的方法。

```
status(resp)(akka.util.Timeout(200000)) must equalTo(OK) 
```

# plugins - 如何使用页面 ID 获得 Facebook Like 框

> ID：11784313
> 
> 赞同：0
> 
> 时间：2012-08-02T19:18:12.350
> 
> 标签：plugins, facebook-likebox

我正在尝试为不同的页面创建 Facebook Like Box。我只有 facebook 页面 ID。当我在像 www.facebook.com/39399781765 这样的浏览器中输入时，我会得到 RedSox 页面，但是当我在 Like Box 中使用与 pageid www.facebook.com/39399781765 相同的 url 时，它会给出错误“无法检索指定的页面。请确认正确的href被传入。"

有人可以帮我弄这个吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:21:37.033

如果您使用 Facebook URL 作为赞框，您可以使用文本 url (https://www.facebook.com/RedSox) 或 ID (39399781765)。只是不要混搭。如果您只输入`39399781765`它请求的 Facebook 页面 URL，它将起作用。

# sql - 如何在 SQL 中向重复数据集添加计数器？

> ID：11784316
> 
> 赞同：2
> 
> 时间：2012-08-02T19:18:30.007
> 
> 标签：sql, sql-server, database

我有一个有重复字段的表。我需要一个函数来计算并说出第 n 行中的重复次数。IE;

如果表格如下；

```
ID  NAME  CLASS
---------------
 1  Tom    a
 2  Dick   b
 3  Harry  c  
 4  Marry  b
 5  Bob    c
 6  Mat    c
 7  Mandi  a 
```

像这样的函数`COUNT(class)`可以计算每个类值出现了多少次。但我需要一个函数来输出如下结果；

```
ID  NAME  CLASS (I_NEED) COUNT
--------------------------------
 1  Tom     a      1       2
 2  Dick    b      1       2
 3  Harry   c      1       3
 4  Marry   b      2       2
 5  Bob     c      2       3
 6  Mat     c      3       3
 7  Mandi   a      2       2 
```

我正在使用 SQL Server 2010R2

任何想法都会有很大帮助..提前谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:26:44.003

我认为这就是你要找的：

```
select id, 
       name, 
       class,
       row_number() over (partition by class order by id) as i_need,
       count(*) over (partition by class) as cnt
from the_table
order by id 
```

# java - 在 catch 中抛出新异常如何工作？

> ID：11784320
> 
> 赞同：3
> 
> 时间：2012-08-02T19:18:40.327
> 
> 标签：java, exception-handling, try-catch

我有一个片段如下：

```
try
{
   //blah!!
} 
catch(IOException e)
{
   throw new RuntimeException(e);
} 
```

我不明白上面的工作原理是什么？它`catch`会吗？什么`IOException`时候会？在那种情况下，将没有任何意义吧？一些例子会有所帮助。`throw``RuntimeException``IOException`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:23:06.933

你对一些假设是正确的，但你应该更深入一点。在你的`try`块内，假设你的类的一个方法抛出了这种异常`IOException`。因此，catch 将作为您处理这种特殊情况的方式。基本上就是这样。如果您只是使用 RuntimeException 将您的异常丢弃，但正如您所做的那样，将您的异常包含`IOException`在`RuntimeException`您将不会丢失它。

一个正常的使用是在更高的层次上对待你的异常。这是一个关于异常处理的好教程，请查看：[异常处理的最佳实践](http://onjava.com/pub/a/onjava/2003/11/19/exceptions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:21:53.027

在此代码中，已检查的 IOException 变为有效未检查。通过将 IOException 传递给 RuntimeException，您将 2 链接在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:21:56.997

是的，你的理解是正确的。这在您想要显示应用程序特定异常而不是 java 提供的异常的情况下可能很有用（IOException 可能不是理解这一点的完美案例）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T19:21:57.480

检查`Exceptions`必须被捕获或声明为抛出。 `RuntimeExceptions`不要，所以捕获和重新抛出`RuntimeException`是避免必须声明的方法：

```
public void myMethod() throws IOException 
```

当`throw new RuntimeException(e);`被调用时，会创建一个抛出的新异常，但原始异常被包装在其中。所以堆栈跟踪将如下所示：

```
Exception in thread "main" java.lang.RuntimeException: java.io.IOException: Some error.
    at com...main(SomeClass.java:36)
Caused by: java.io.IOException: Some error. 
```

因此，调用堆栈上的实际异常是 a`RuntimeException`但原始异常`IOException`作为根本原因保留在消息中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-02T19:22:13.313

你的理解是正确的。如果`IOException`抛出 an ，`catch`处理程序将捕获它，然后立即抛出它自己的`RuntimeException`。这个异常可能在程序的其他地方被捕获，在这种情况下，控制将在处理程序处获得，或者它将未被捕获并终止当前线程。

考虑这里发生的事情的一种方法如下 -`IOException`已检查异常，这意味着它必须被捕获。如果它没有被捕获，那么程序将无法编译。上面的代码说，只要它捕获到一个`IOException`，它就会抛出一个`RuntimeException`，这是一个未经检查的异常。如果程序员不想捕获此异常，则不必捕获它。请注意，这`RuntimeException`是使用 catch`IOException`作为参数构造的。这意味着如果`RuntimeException`后来被捕获，任何捕获它的人都可以注意到根本原因是 an`IOException`并且可以相应地处理它。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-02T19:22:28.820

不，RuntimeException 有一些特别之处。当你想抛出一个 RuntimeException 时，你不需要`throws RuntimeException`方法签名中的 a。这称为未经检查的异常。此代码将 IOException 包装为 RuntimeException 并将其重新抛出给调用者，恕我直言，在大多数情况下，这是一种不好的方法。

RuntimeException 的所有子类都未选中，例如 IllegalArgumentException、NullPointerException 等...

# mysql - 当有可能的键时，为什么 MySQL 不使用键

> ID：11784322
> 
> 赞同：2
> 
> 时间：2012-08-02T19:18:42.480
> 
> 标签：mysql, sql, indexing, primary-key

所以每当我解释我的查询时，我经常会得到一些实例，其中它将某些字段声明为可能的键，但是键表将为空......

为什么 MySQL 会这样做并决定不使用任何键，而实际上它可以使用可能的键？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T19:22:20.787

优化器可以合理地计算出使用索引会导致比全表扫描更差的性能。

我给你举个例子：

假设您有一个已编入索引的性别字段，但 90% 的记录是女性。优化器可以使用索引，但由于数据的分布是倾斜的，因此进行全表扫描可能更有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T19:23:30.157

它不能总是使用密钥，例如：

```
SELECT * FROM A, B where A.id = B.id; 
```

虽然`id`它是两个查找的可能键，但不能同时*用于*这两个查找。其中一张表必须进行全面扫描。

# python - numpy 数组的 Python 内存使用情况

> ID：11784329
> 
> 赞同：199
> 
> 时间：2012-08-02T19:19:22.970
> 
> 标签：python, numpy, sys

我正在使用 python 来分析一些大文件并且遇到了内存问题，所以我一直在使用 sys.getsizeof() 来尝试跟踪使用情况，但是 numpy 数组的行为很奇怪。这是一个涉及我必须打开的反照率地图的示例：

```
>>> import numpy as np
>>> import struct
>>> from sys import getsizeof
>>> f = open('Albedo_map.assoc', 'rb')
>>> getsizeof(f)
144
>>> albedo = struct.unpack('%df' % (7200*3600), f.read(7200*3600*4))
>>> getsizeof(albedo)
207360056
>>> albedo = np.array(albedo).reshape(3600,7200)
>>> getsizeof(albedo)
80 
```

好吧，数据仍然存在，但对象的大小（3600x7200 像素图）已从 ~200 Mb 变为 80 字节。我希望我的记忆问题已经结束，只是将所有内容都转换为 numpy 数组，但我觉得这种行为，如果是真的，会在某种程度上违反信息论或热力学的某些定律，所以我倾向于相信 getsizeof() 不适用于 numpy 数组。有任何想法吗？

* * *

## 回答 #1

> 赞同：302
> 
> 时间：2012-08-02T19:24:14.747

您可以[`array.nbytes`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.nbytes.html)用于 numpy 数组，例如：

```
>>> import numpy as np
>>> from sys import getsizeof
>>> a = [0] * 1024
>>> b = np.array(a)
>>> getsizeof(a)
8264
>>> b.nbytes
8192 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2018-03-07T02:03:09.593

字段[nbytes](https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.ndarray.nbytes.html)将为您提供 a 中数组所有元素的大小（以字节为单位）`numpy.array`：

```
size_in_bytes = my_numpy_array.nbytes 
```

请注意，这不会测量“数组对象的非元素属性”，因此以字节为单位的实际大小可能比这大几个字节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-09-09T11:58:40.647

在 python 笔记本中，我经常想过滤掉“悬空”`numpy.ndarray`的，特别是那些存储在`_1`,`_2`等中的那些从来没有真正打算活着的。

我使用此代码来获取所有它们及其大小的列表。

不确定这里`locals()`是否`globals()`更好。

```
import sys
import numpy
from humanize import naturalsize

for size, name in sorted(
    (value.nbytes, name)
    for name, value in locals().items()
    if isinstance(value, numpy.ndarray)):
  print("{:>30}: {:>8}".format(name, naturalsize(size))) 
```

# c# - 关于 OO 和库设计的几个问题

> ID：11784331
> 
> 赞同：4
> 
> 时间：2012-08-02T19:19:29.690
> 
> 标签：c#, oop, library-design

好的。我对 OO 和库设计的某些方面有一些疑问。

1.  图书馆应该自给自足吗？例如，它可以使用外部依赖注入框架，还是应该以更轻量级的方式实现它自己？

2.  Liskov 的替换原则如何适用于*不*知道方法或类行为的多态性？您只是期望它按应有的方式工作吗？

3.  在源代码部分，将接口与实现分开放置在一个单独的文件夹（例如，`/interfaces`）中是一个坏习惯吗？

4.  `where T : type`在接口上而不是在它们的实现中分隔泛型类型 () 也是一个坏习惯？（这个我不这么认为，只是为了确认一下）。

5.  当对象关系是“可以做”和“是”时，接口是否优于抽象类，并且不需要方法等的默认实现？

而已。谢谢你的时间=）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:29:09.980

**1.图书馆应该自给自足吗？**

库当然可以使用，例如，依赖注入框架。但是，是否要将 DI 框架强加于库的用户是[有争议的。](https://stackoverflow.com/q/1831455/146622)

**2\. Liskov 的替换原则如何适用于多态性？**

Liskov 的替换原则是关于能够将一种实现与另一种实现互换（替换），并且*无论行为如何，*用户遵守合同时都不应出现错误。例如，如果您只使用类中的方法，将 a 换成`CanonPrinter`an`EpsonPrinter`仍然应该允许您打印`Printer`。调用某些东西`Printer`但有一个特定的实现（佳能，爱普生）是多态性。

**3\. 将接口与实现分开放在一个文件夹中是一个坏习惯吗？**

您是否希望将接口与其实现分开，这是个人偏好。我不这样做；我什至没有每个实现的接口。我认为只有为您的项目增加价值的实现接口才有意义。

**4\. 在接口上限制泛型类型而不仅仅是在它们的实现中也是一个坏习惯吗？**

如果您认为泛型类型应该限制为特定类型，那么您应该在有意义的地方这样做（因此，这可能在接口上）。例如，拥有 a`IPrintableDocument<TPrinter>`并且不限`TPrinter`于`Printer`对象是*没有*意义的，所以我会这样做。

**5\. 当对象关系既是“can do”又是“is a”时，接口是否优于抽象类？**

确实，大多数人使用抽象类来*表示*可做关系，而接口则表示*可以做*关系。原因：一个类只能从一个基类继承，但可以从多个接口继承。从本质上讲，这意味着一个类*只能是*一件事（a`Employee` *是 a* `Person`），但*可以做*多个（它可能`ICopyDocuments`、、、`IWalkAbout`）`IMakeCoffee`。当一个界面同时存在时，无论您做什么都取决于您的偏好。

* * *

您的大多数问题都与类（或接口）的*契约*有关：契约指定用户（另一个类，其他人的代码）*可以*对类及其成员做什么和*不能做*什么，并且它指定用户做什么可能期望类*会做*和*不会做*。

例如：用户只有在匹配参数类型时*才能*将对象作为参数传递给方法。该类*只会*将对象作为与返回类型匹配的返回值返回。用户*只能*调用类中定义的成员，并且类*将*确保这些方法按照约定行事（即不抛出错误、无副作用、永不返回 null）。

泛型类型约束也是契约的一部分。我什至考虑合同的文档部分：当它声明一个方法*永远不会*抛出异常时，那么任何实现都不应该抛出异常。没有强制执行它的语法或编译器规则，但它是合同的一部分。合同的某些部分由编译器或运行时强制执行，而其他部分则不是。

当一个类或接口有一个特定的契约时，任何子类或实现都可以代替它，并且*当该子类或实现遵守契约时*它仍然可以工作。如果它遵守合同，那就是 Liskov 的替代原则 (LSP)。并且很容易偏离它，许多程序员都会这样做。有时你别无选择。

.NET Framework 中违反 LSP 的一个明显示例是[`ReadOnlyCollection<T>`类](http://msdn.microsoft.com/en-us/library/ms132474.aspx)。它实现了[`IList<T>`](http://msdn.microsoft.com/en-us/library/ms132474.aspx)接口，但它的许多方法没有实际实现。因此，如果您传递一个期望 a`IList<T>`的`ReadOnlyCollection<T>`用户并且该用户尝试调用`list.Add`，那么将引发异常。因此，您不能总是替换`IList<T>`，`ReadOnlyCollection<T>`因此它违反了 LSP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:26:10.847

我将尝试按顺序回答这些问题：

1.  这取决于。承担外部依赖可能会限制库的有用性和范围，因为它仅在该依赖可用的情况下可用。但是，这可能很好，并且优先于尝试解决依赖关系。如果您知道您的库的用户将始终使用特定的 DI 框架，我会围绕它构建库，而不是实现需要“适应”才能工作的东西。

2.  “你不知道方法或类的行为？” 您应该知道您正在使用的任何类型的合同。LSP 基本上说，无论你得到什么*具体*类型，基类/接口契约总是有效的。这意味着您可以只“使用类型”并期望它能够工作。

3.  不——但这是一个私有的实现细节。*然而，分离命名空间*通常是个坏主意，而且保持源代码树与命名空间匹配通常是件好事。

4.  不，如果一个接口真的打算只用于特定类型，它应该在接口上有约束。

5.  一般来说，一份合同应该只提供关系的一个方面。如果合约建议“is-a”**和**“can-do”，它可能应该分成两个合约，也许是一个实现“can-do”接口的抽象类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:40:07.063

在 #1 - [http://jeviathon.com/2012/03/05/roll-your-own-syndrome/](http://jeviathon.com/2012/03/05/roll-your-own-syndrome/)

基本上，关键是，当有人可能已经创建了功能强大、经过测试和支持的软件来做同样的事情时，为什么还要“推出你自己的”xyz 框架。

花时间研究选择要使用的“正确”外部库和框架，而不是重新发明轮子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:40:49.487

1.  “这取决于”。但是重新发明自己的轮子没有什么价值，尤其是在像 DI 和 ORM 这样人口密集（且难以实施）的领域。尤其是当您可以（a）bin-deploy 您的依赖项或（b）将您的依赖项指定为 nuget 包时，如果您的库是 nuget 包（当然应该如此）

2.  LSP 与多态性关系不大。它指出类（或方法）应该按照约定行事，这实际上是您唯一知道的关于实现者行为的事情。

3.  文件夹应与命名空间相对应。您是否将接口放在单独的命名空间中？我没有，而且我认为没有人应该这样做。当我只有一个实现的接口时（例如，单元测试诱导的），我更喜欢将它的实现保存在一个文件中。

4.  不，这不对。为什么应该这样？

5.  如果不需要默认实现，请获取接口。接口更容易模拟，也更容易实现，因为它不会干扰你的实现的继承。实际上，您甚至可以在一个类上实现多个接口，如果这以某种方式突出了您的意图（例如，如果您有处理安全性的特定服务，那么实现`IAuthentication`和的情况并不少见`IAuthorization`）。最近我只在明确需要抽象类时才选择它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T19:25:45.637

我会在5点刺伤。

抽象类和接口之间的唯一区别是抽象类可以具有类变量。如果抽象类仅由虚拟方法组成，我会选择一个接口。

# php - Facebook“登录”按钮在点击后退按钮登录后可见

> ID：11784333
> 
> 赞同：0
> 
> 时间：2012-08-02T19:19:30.250
> 
> 标签：php, facebook, login

我`Facebook connect`用来让用户登录我的网站，该网站是用 PHP 开发的。

对于登录，我完美地获得了“使用 Facebook 登录”，一旦通过他们的 Facebook 帐户登录，用户就会被带到另一个页面，该页面显示一些数据。但是，如果有人按下浏览器上的后退按钮，它会将他带到上一页（基本上是登录页面）并且他可以再次看到一个“登录”按钮，旁边有一个 facebook 符号，即使用户已经登录在。我不知道如何摆脱这个。

谁能告诉我如何解决这个问题？我不希望用户按下浏览器上的后退按钮并再次看到“登录”按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:36:13.423

也许是因为当您单击后退按钮时，浏览器确实从其缓存中重新加载页面，而不是从服务器中。您可以使用“Cache-Control”http 响应标头来控制此缓存。前任 ：

```
<?php
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // Date in the past
?> 
```

类似问题：[Force Firefox to Reload Page on Back Button](https://stackoverflow.com/q/3536822/233495)

php 头文件：http: [//php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

# mysql - 如何在 MySql 中按包含 utf8 编码数据的列正确排序？

> ID：11784336
> 
> 赞同：0
> 
> 时间：2012-08-02T19:19:42.790
> 
> 标签：mysql, encoding

我有一个名称编码为 utf8 的表。显示它们是没有问题的，因为我可以在 php 中调用 utf8_decode 但是当我有 mysql 按该列排序时，名称的顺序是错误的。

例如：我在“A”和“B”名称之间有一个以“Ö”开头的名称。

编辑1：列类型是VARCHAR，列和表的排序规则（现在）是ut8_general_ci，因为它们是多语言的。如果重要的话，以前它们是 latin1_swedish_ci。

编辑2：我发现了另一个问题。当我填写表格时，我错误地将 utf8_encode 应用于数据，即使它已经是 utf8。我已经纠正了它，但问题仍然存在。但是当我在我的网站上输出它时，我不必调用 utf8_decode ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:23:04.370

您必须为表中存储 UTF8 内容的列定义 UTF8 字符集和排序规则。然后 MySQL 排序将根据您选择的排序规则正常工作。

[http://dev.mysql.com/doc/refman/5.0/en/charset.html](http://dev.mysql.com/doc/refman/5.0/en/charset.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:25:22.030

在 mysql 中，排序基于列的排序规则。自然语言通常有 utf8 排序规则，如果您的数据使用一种语言，您应该尝试使用该排序规则。如果您需要在查询级别更改使用的排序规则，请按 caluse 的顺序使用[COLLATE](http://dev.mysql.com/doc/refman/5.5/en/charset-collate.html)关键字，例如：

```
SELECT k FROM t1 ORDER BY k COLLATE utf8_hungarian_ci; 
```

如果您不知道该选择什么，请使用`utf8_general_ci`排序规则 ( [demo](http://sqlfiddle.com/#!2/c1119/7) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T08:27:58.240

如果您对任何内置排序规则对数据的排序方式不满意，那么您可以创建自己的排序规则：

[http://dev.mysql.com/doc/refman/5.0/en/adding-collat​​ion.html](http://dev.mysql.com/doc/refman/5.0/en/adding-collation.html)

# asp.net - Facebook C# SDK 发布到页面墙问题

> ID：11784343
> 
> 赞同：2
> 
> 时间：2012-08-02T19:20:26.357
> 
> 标签：asp.net, facebook-c#-sdk

很长一段时间以来，我们的 asp.net 4.0 应用程序一直运行良好，并按预期发布到我们的 facebook 页面墙上，事实上已经有一年多了。四个星期前，它停止抛出 OAuthException，我刚刚开始调查。我们得到的错误是：

```
Facebook.FacebookOAuthException: (OAuthException - #1) An unknown error has occurred 
```

那么发生了什么变化 - 简而言之，我不知道，但我已经调查并设法通过应用程序发布，缺少一个关键信息 - 链接是帖子的重要部分。

```
var args = new Dictionary<String, object>();
args["message"] = "test message";
args["link"] = "http://www.google.co.uk";
args["picture"] = "http://mylogo";

Facebook.FacebookClient app = new Facebook.FacebookClient(app_token);

var result = app.Post("/ID/feed", args);

return result.ToString().Replace("\"", "").Replace("{id:", "").Replace("}", ""); 
```

这是原始代码，它工作得很好，突然停止了。

如果我注释掉`args["link"] = "http://www.google.co.uk";`问题得到解决并且不再抛出异常并且该项目被发布到墙上减去 hyperling。这是最奇怪的，更令人沮丧的是试图诊断。

任何帮助或指针表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T06:32:14.620

所以仍然不确定发生了什么，但将其切换为使用 expandoobject 并添加以下内容

```
parameters.actions = new
            {
                name = "title",
                link = "http://website.com",
            }; 
```

删除它会产生相同的错误，所以除非其他人有任何其他建议，否则请保留它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T02:21:02.753

我有一个类似的问题似乎链接和名称一起工作尝试添加

```
args["name"] = "Google UK"; 
```

就我而言，当只有链接存在时，Facebook 试图从该站点获取图像。

但是没有链接的名称根本不起作用

干杯

# java - 从枚举名称的字符串文字返回枚举值列表

> ID：11784353
> 
> 赞同：2
> 
> 时间：2012-08-02T19:21:04.117
> 
> 标签：java, reflection, enums

假设我有一个带有值的字符串

```
'Language' 
```

我有一个名为 Language 的枚举

```
enum Language{
    English,
    Spanish,
    French
} 
```

有没有办法使用字符串“语言”并返回枚举语言的值。我基本上想知道是否有一种方法可以通过传入字符串来获取枚举语言的实例。有一些像

```
Class.forName() 
```

但对于枚举。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:27:33.890

枚举是一个类，因此使用完全限定名称（例如`"com.mydomain.myapp.Language"`），您可以从`Class.forName`. 从那里，您可以在 Class 对象上使用反射：[getEnumConstants](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getEnumConstants%28%29)为您提供所有枚举值，如果您想要名称，您可以在枚举对象上使用[.name 。](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Enum.html#name%28%29)

# php - PHP - bindValue() 的 PDO 问题

> ID：11784355
> 
> 赞同：1
> 
> 时间：2012-08-02T19:21:16.233
> 
> 标签：php, postgresql, pdo, prepared-statement, bindvalue

我正在编写一个类，它以编程方式创建一个给定特定列名的表。我正在使用 PDO 准备好的语句，这似乎会导致一些问题。

这是基本程序：

```
// create a query string to be sent to $pdo->prepare
$sql =
'CREATE TEMP TABLE :tmp_table_name (
  :person_id bigint,
  :encntr_id bigint,
  :prsnl_id bigint,
  :program_detail text,
  :program_name text
);';
$stmt = $pdo->prepare($sql);

// Bind table name
$stmt->bindValue(':tmp_table_name', 'tmp_patients', PDO::PARAM_STR);

// Bind column names
$columnNames = [
  'person_id',
  'encnt_id',
  'prsnl_id',
  'program_detail',
  'program_name',
];
foreach($columnNames as $name) {
    $stmt->bindValue(':'.$name, $name, PDO::PARAM_STR);
}

$ret = $stmt->execute();
// $ret is false! The statement fails. 
```

这是`$stmt->errorInfo()[2]`显示的内容：

```
ERROR:  syntax error at or near "$1"
LINE 1: CREATE TEMP TABLE $1 ($2 bigint,
$3 bigint,
$4 bigint,
$5 text,
$6 te... 
```

为什么 $1、$2、$3 等会出现在查询中？您对如何进一步调试此 PDO 语句有任何提示吗？

**更新** 我正在尝试一种不同的方法，不使用 bindParam，只是将参数数组传递给 $stmt->execute()。不过，我仍然遇到同样的错误......

```
$stmt = $this->pdo->prepare($this->createSql);

$keys = [];
// Bind column names
foreach($this->columnNames as $name) {
    $keys[] = ':'.$name;
}
$params = array_combine($keys, $this->columnNames);

// Bind table name
$params[':tmp_table_name'] = 'tmp_'.$this->objName;

$ret = $stmt->execute($params);
if (!$ret) {
    throw new Exception('execSchema() failed! '. $stmt->errorInfo()[2]);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T20:24:11.910

在我看来，好像您正在尝试绑定到表名/列，而使用 PDO 无法做到这一点 - 您只能将值绑定到占位符。

如您的代码所示：

```
// Bind table name
$stmt->bindValue(':tmp_table_name', 'tmp_patients', PDO::PARAM_STR); 
```

感觉好像它应该工作，但它没有。

例如，这将*不起作用*：

```
$sql = "insert into mytable (:thing1) values (:thing2);
$stmt->bindValue(':thing1', 'column_name' ); // this would not
$stmt->bindValue(':thing2', 'column_value' ); // this would have (on its own) 
```

但是，这样的事情会起作用，它应该提供您的解决方案或类似的东西：

```
// imagine an incoming POST load like this:
$cols = ['fname','lname'];

$array_cnt = count($cols);  // 2
$sql = 'INSERT INTO mytable ('.join(',', $cols).') ';

// and then that number of placeholders used 
$sql .= 'VALUES (' . join( array_fill( 0, $array_cnt, '?' ), ', ' ) . ')'; 

echo $sql; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:42:41.410

`bindParam()`并`bindValue()`通过引用处理值，这意味着您将一个对变量的引用传递给它`$value`，而不是它在您调用它时的值。当循环结束并且您调用`query()`,`$value`将是最后一个`$array`。

使用对数组中项目的引用：

```
$stmt->bindValue(":".$array[$param], $array[$param]);
$stmt->bindParam($param, $array[$param]); 
```

# android - android Activity上的地图未显示

> ID：11784359
> 
> 赞同：0
> 
> 时间：2012-08-02T19:21:33.480
> 
> 标签：android, google-maps, logcat

我正在尝试在 Activity 上显示地图，但它没有显示，即使我在清单中声明了所有权限并添加了谷歌库。

这是 logcat 错误

```
 08-02 18:44:44.568: E/ActivityThread(2482): Failed to find provider info for com.google.settings
    08-02 18:44:44.579: E/ActivityThread(2482): Failed to find provider info for com.google.settings
    08-02 18:44:44.609: E/ActivityThread(2482): Failed to find provider info for com.google.settings
    08-02 18:44:46.229: E/MapActivity(2482): Couldn't get connection factory client
    08-02 18:44:47.468: W/IInputConnectionWrapper(2482): finishComposingText on inactive InputConnection 
```

# css - 修复 IE7 div overflow-y: 从隐藏内容滚动到滚动条后面

> ID：11784361
> 
> 赞同：1
> 
> 时间：2012-08-02T19:21:45.567
> 
> 标签：css, internet-explorer, google-chrome, vertical-scrolling

根据下面的 jsfildde，我在 div( `#body`) 中有一个沿 y 轴滚动的表格。我的问题是，在 IE 中，滚动条将最后一个表格单元格的一部分隐藏在其后面，从而改变了表格列的布局。在 Chome 中没有这样的问题，我必须同时支持这两个浏览器。我相信问题出在 IE 上，并且 Chrome 正在正确呈现 CSS。如何让 IE 以与 Chrome 相同的方式显示我的列？

如果在两个浏览器中都查看 fiddle，将会看到不同之处在于表头没有与相应的列对齐。

[http://jsfiddle.net/5DD5b/3/](http://jsfiddle.net/5DD5b/3/)

感谢您提供的任何建议。

编辑：它适用于 IE9，但不适用于需要支持的 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:49:30.390

由于这个问题似乎只发生在 IE7 中，所以我决定根据 ihake 的建议检测 userAgent 并相应地进行。这并不理想，但它有效。

```
var IE7 = false;

$(document).ready(function(){

    if($.browser.msie) {
        var userAgent = $.browser.version;
        if(userAgent.substring(0,userAgent.indexOf('.')) == 7) IE7 = true;
    }

    ... 
```

如果 IE7 为真，我在文件的更下方设置 css 一种方式，如果它为假，则另一种方式。很简单。

# c# - 如何在 DateTimePicker 中设置当前时间

> ID：11784362
> 
> 赞同：7
> 
> 时间：2012-08-02T19:21:45.087
> 
> 标签：c#, winforms, datetimepicker

我正在尝试将当前时间设置为 DateTimePicker（带格式时间），例如

```
this.myDateTimePicker.Value = DateTime.Now; 
```

但是在执行我的代码时出现异常

```
Object reference not set to an instance of an object 
```

我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T19:28:12.703

您需要在`InitializeComponent()`拨打电话后输入该代码。在此之前没有任何实例`myDateTimePicker`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-02T19:31:37.663

声明你的`DateTimePicker`并尝试一下。

`DateTimePicker myPicker = new DateTimePicker;`
`myPicker.Value = DateTime.Now;`

就像有人指出的那样，将您的代码放在之前，因为它在您被初始化`InitializeComponent()`的那部分。`DateTimePicker`

1 - 删除你的控制
2 - 重新添加它。
3 - 注意你把代码放在哪里。

应该在那之后工作，因为你在代码部分做对了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-13T19:17:36.053

如果您使用 WPF，而不是 WinForms，请添加此参考：

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

然后在 XAML DatePicker 的代码中添加：

```
SelectedDate="{x:Static sys:DateTime.Now}" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-22T08:55:29.900

如果您使用 Forms 只需从 Toolbox 添加 DateTimePicker 对象，然后首先调用 InitializeComponent() 或者只是在您的代码中创建新实例

```
 this.dateTimePicker1 = new System.Windows.Forms.DateTimePicker(); 
```

只有在创建 DateTimePicker 的实例之后，您才能使用它：

```
this.dateTimePicker1 .Value = DateTime.Now; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-20T10:31:20.457

在您的“form1_Load”事件中设置此代码

```
DateTimePicker dtpPurDate = new DateTimePicker;
dtpPurDate.Text = DateTime.Now.ToShortTimeString();

private void form1_Load(object sender, EventArgs e)
{
     DateTimePicker dtpPurDate = new DateTimePicker;
     dtpPurDate.Text = DateTime.Now.ToShortTimeString();
} 
```

# java - org.eclipse.swt.widgets.Group，这个类真的可以滚动吗

> ID：11784363
> 
> 赞同：3
> 
> 时间：2012-08-02T19:21:48.030
> 
> 标签：java, swt, scrollable

继承自的类`org.eclipse.swt.widgets.Group`继承`Composite`自`Scrollable`。但是，当我调用继承的方法`getVerticalScrollBar()`时，它总是返回`null`.

是否可以制作`Group`可滚动的？如果可能，怎么做？

顺便说一句，`Group`包含许多`org.eclipse.swt.widgets.Button.Button`样式为`SWT.CHECK`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:34:48.587

我不认为你可以得到`Group`滚动本身。但是，我设法通过添加 a[`ScrolledComposite`](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/custom/ScrolledComposite.html)来达到相同的效果`Group`：

```
group = new Group(parent, SWT.NONE);
group.setText("Images: ");
group.setLayout(new FillLayout());

ScrolledComposite comp = new ScrolledComposite(group, SWT.V_SCROLL | SWT.H_SCROLL);
comp.setLayout(new FillLayout());

Composite innerComp = new Composite(comp, SWT.NONE);
innerComp.setLayout(new FillLayout());

comp.setContent(innerComp);
comp.setExpandHorizontal(true);
comp.setExpandVertical(true); 
```

之后，您可以将您`Button`的 s 添加到`Composite` `innerComp`. 可能需要`setMinHeight(int height)`在`setMinWidth(int width)`.`ScrolledComposite`

**编辑**

这是一个小的工作示例。如果您减小窗口的大小，您会看到滚动条会出现：

```
public static void main(String[] args)
{
    Display display = Display.getDefault();
    Shell shell = new Shell(display);

    shell.setLayout(new FillLayout());

    Group imageGroup = new Group(shell, SWT.V_SCROLL | SWT.H_SCROLL);
    imageGroup.setText("Images: ");
    imageGroup.setLayout(new FillLayout());

    ScrolledComposite frontComp = new ScrolledComposite(imageGroup, SWT.V_SCROLL | SWT.H_SCROLL);
    Composite innerFrontComp = new Composite(frontComp, SWT.NONE);
    frontComp.setLayout(new FillLayout());

    innerFrontComp.setLayout(new FillLayout());

    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");
    new Button(innerFrontComp, SWT.CHECK).setText("Button");

    frontComp.setMinHeight(innerFrontComp.computeSize(SWT.DEFAULT, SWT.DEFAULT).y);
    frontComp.setMinWidth(innerFrontComp.computeSize(SWT.DEFAULT, SWT.DEFAULT).x);
    frontComp.setContent(innerFrontComp);
    frontComp.setExpandHorizontal(true);
    frontComp.setExpandVertical(true);

    shell.pack();
    shell.open();

    while(!shell.isDisposed())
    {
        if(!display.readAndDispatch())
            display.sleep();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:45:53.007

SWT的[Javadoc说：](http://www.eclipse.org/swt/javadoc.php)

> 如果有，则返回接收者的垂直滚动条，如果没有则返回 null。

如果用户使窗口/对话框变小，则出现滚动条。只有这样，这些方法才会`getVerticalScrollBar()`返回`getHorizontalScrollBar()`一个非空值。您必须始终检查`null`何时涉及此问题。这就是 SWT 的构建方式。

编辑：尝试在 a或 a上调​​用该`getVerticalScrollBar()`方法。`Composite``Shell`

# perl - 如何用一些字符串替换 CSV 中的特定列？

> ID：11784364
> 
> 赞同：2
> 
> 时间：2012-08-02T19:21:48.333
> 
> 标签：perl, bash, shell, sed, awk

对不起一个非常基本的问题。如何用一些字符串替换**制表符分隔**文件中的特定列，比如“xyz”？

例如

**输入：**

```
abc\t  def\t   \t   xyz
pqr\t  ert\t   \t   yut 
```

**输出：**

```
abc\t  def\t   new_str\t   xyz
pqr\t  ert\t   new_str\t   yut 
```

简而言之，我文件中的第 3 列是空的，我想用字符串替换它。

我绑了这样的东西：

```
awk '{$3="new_str"}1' test1.csv > test1_op.csv 
```

但看起来它不维护标签。另请注意，该文件有 400 列，因此编写一个类似这样的 awk 命令：

```
awk -F, '{OFS=",";print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,...,$400}' in.csv > outfile.csv 
```

我想避免。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:46:02.057

`awk`由于它是制表符分隔的，因此通过在制表符上拆分，而不是在任何空格（空格、制表符和可能其他更深奥的类型的任何组合）上拆分的默认值，您处于正确的轨道上。完成此操作后，您可以直接分配给要更改的列，然后再次打印 $0。

```
awk -F$'\t' 'BEGIN {OFS="\t"} {$3="new_str"; print}' in.csv > outfile.csv 
```

`awk`还可以处理出现在其输入文件列表中的变量赋值，因此看起来更简洁：

```
awk '{$3="new_str"; print}' FS=$'\t' OFS=$'\t' in.csv > outfile.csv 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:46:23.330

这可能对你有用（GUN sed）：

```
sed -i 's/\t/new_str&/3' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:28:03.810

目前尚不清楚您想如何处理空格，但也许您只想：

```
awk '{$3="new_str"}1' FS=\\t OFS=\\t 
```

请注意，这会丢弃最初在`$3`. 你可以保留它：

```
awk '{$3=$3"new_str"}1' FS=\\t OFS=\\t 
```

或者

```
awk '{$3="   new_str"}1' FS=\\t OFS=\\t 
```

取决于你的需要。

# javascript - XMLHttpRequest setRequestHeader() --> 有没有办法设置标头值，而不是附加到它上面？

> ID：11784372
> 
> 赞同：3
> 
> 时间：2012-08-02T19:22:03.920
> 
> 标签：javascript, jquery, django, xmlhttprequest

来自： [http ://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader-method](http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader-method)

```
client.setRequestHeader() 
    Appends an header to the list of author request headers, or if
    header is already in the list of author request headers, combines 
    its value with value. 
```

问：有没有办法只*设置*一个标题而不是附加到现有的？

我正在使用的代码如下，基本上是从[https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax)复制和粘贴的：

```
jQuery(document).ajaxSend(function(event, xhr, settings) {
     ...

     // xhr is an XMLHttpRequest object
     xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
} 
```

# session - PHP：致命错误：无法重新声明类会话

> ID：11784378
> 
> 赞同：0
> 
> 时间：2012-08-02T19:22:36.927
> 
> 标签：session, php

将我的 PHP 版本更新到 5.4 (xampp 1.8.0) 时，我看到一个*致命错误*：

> 致命错误：无法在第 5 行的 C:\xampp\htdocs\vs\classes\session.class.php 中重新声明类 Session

这个问题与更新`PHP`版本有关吗？

*session.class.php：*

```
<?php
defined('_VALID') or die('Restricted Access!');

class Session
{   // <-- This Is Line 5 
    private static $_sess_db;

    public static function open() {
        global $config;    

        if (self::$_sess_db = mysql_connect($config['db_host'], $config['db_user'], $config['db_pass'])) {
            return mysql_select_db($config['db_name'], self::$_sess_db);
        }

        return false;
    }

    public static function close() {
        return mysql_close(self::$_sess_db);
    }

    public static function read($session_id) {
        $sql = sprintf("SELECT `session_data` FROM `sessions` WHERE `session_id` = '%s'", mysql_real_escape_string($session_id));
        if ($result = mysql_query($sql, self::$_sess_db)) {
            if (mysql_num_rows($result)) {
                $record = mysql_fetch_assoc($result);
                return $record['session_data'];
            }
        }

        return '';
    }

    public static function write($session_id, $session_data)
    {
        $sql = sprintf("REPLACE INTO `sessions` VALUES('%s', '%s', '%s')", mysql_real_escape_string($session_id),
                        mysql_real_escape_string(time()), mysql_real_escape_string($session_data) );

        return mysql_query($sql, self::$_sess_db);
    }

    public static function destroy( $session_id )
    {
        $sql = sprintf("DELETE FROM `sessions` WHERE `session` = '%s'", $session_id);
        return mysql_query($sql, self::$_sess_db);
    }

    public static function gc($max) {
        $sql = sprintf("DELETE FROM `sessions` WHERE `session_expires` < '%s'", mysql_real_escape_string(time() - $max));
        return mysql_query($sql, self::$_sess_db);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:25:17.230

似乎您不止一次包含 session.class.php ......或者您在包含的另一个文件中声明类 Session 。

正如@cegfault 所说：`include_once`并且`require_once`可以用来防止这种情况。

但最好确保只包含一次文件（更少的内存使用）。`include_once`并且`require_once`只是失败的保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:30:25.760

尝试用这样的`if`语句包装你的类：

```
if (class_exists('Session') != true) {

    class Session { ... }

} 
```

如果您的代码结构复杂/大，这将防止错误

请参阅[**`class_exists()`**文档](http://php.net/manual/en/function.class-exists.php)

# javascript - 在 Safari iOS 中使用加速度计

> ID：11784390
> 
> 赞同：4
> 
> 时间：2012-08-02T19:23:32.270
> 
> 标签：javascript, ios, webkit, accelerometer

我刚开始玩它，我想知道是否有一种方法可以基于 1:1 手势移动页面中的元素，比如框/div：

让我更好地解释一下：我在网上看到的示例它们具有惯性等...

当我向上倾斜 iphone 时，我只想将一个框移到页面顶部，反之亦然.. 直接运动，不需要惯性

有没有与我所说的内容接近的演示？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2019-04-09T13:04:48.433

出于隐私考虑，从 iOS 12.2 开始，Apple 将限制 Safari 访问加速度计。Settings > Safari > Motion & Orientation Access 中有一个新开关，默认为“OFF”。

有人要求通过询问用户的许可来控制该功能，但目前看来这不可能。

此举将破坏 Safari 的大多数 AR 和 VR 体验，大多数人不知道它为什么会破坏。

进一步阅读：

*   [https://www.macrumors.com/2019/02/04/ios-12-2-safari-motion-orientation-access-toggle/](https://www.macrumors.com/2019/02/04/ios-12-2-safari-motion-orientation-access-toggle/)
*   [https://www.fastcompany.com/90302260/in-another-privacy-move-apple-will-limit-websites-access-to-your-iphones-motion-data](https://www.fastcompany.com/90302260/in-another-privacy-move-apple-will-limit-websites-access-to-your-iphones-motion-data)
*   [https://www.cultofmac.com/604562/apple-plans-to-limit-accelerometer-and-gyroscope-access-in-safari-on-ios/](https://www.cultofmac.com/604562/apple-plans-to-limit-accelerometer-and-gyroscope-access-in-safari-on-ios/)

迄今为止我发现的最佳解决方法： [https ://github.com/w3c/deviceorientation/issues/57#issuecomment-481039307](https://github.com/w3c/deviceorientation/issues/57#issuecomment-481039307)

*** 更新 ***

Safari 13 Beta 在 iOS 上为 DeviceMotionEvent 和 DeviceOrientationEvent 添加了权限 API：[https ://developer.apple.com/documentation/safari_release_notes/safari_13_beta_3_release_notes#3314664](https://developer.apple.com/documentation/safari_release_notes/safari_13_beta_3_release_notes#3314664)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:44:52.697

据我所知，Safari 可以通过以下方式检测陀螺仪/加速度计事件：

```
window.ondevicemotion = function(event) {
// event.accelerationIncludingGravity.x
// event.accelerationIncludingGravity.y
// event.accelerationIncludingGravity.z
} 
```

我知道有一个带有一些弹跳球的演示，但我找不到它。但是，您可以访问 Apple 网站上的文档来为 Safari 浏览器开发此文档以获取更多信息。请参阅以下链接：

[https://developer.apple.com/library/safari/#documentation/SafariDOMAdditions/Reference/DeviceMotionEventClassRef/DeviceMotionEvent/DeviceMotionEvent.html](https://developer.apple.com/library/safari/#documentation/SafariDOMAdditions/Reference/DeviceMotionEventClassRef/DeviceMotionEvent/DeviceMotionEvent.html)

[https://developer.apple.com/library/safari/#documentation/SafariDOMAdditions/Reference/DeviceOrientationEventClassRef/DeviceOrientationEvent/DeviceOrientationEvent.html](https://developer.apple.com/library/safari/#documentation/SafariDOMAdditions/Reference/DeviceOrientationEventClassRef/DeviceOrientationEvent/DeviceOrientationEvent.html)

更新：我知道我在某处见过它......这是演示，适用于 iPhone、Android 和 Mac（带加速度计）： [http ://mrdoob.com/projects/chromeexperiments/ball_pool/](http://mrdoob.com/projects/chromeexperiments/ball_pool/)

# shell - Shell 脚本 - 权限被拒绝

> ID：11784393
> 
> 赞同：2
> 
> 时间：2012-08-02T19:23:43.857
> 
> 标签：shell

我正在尝试一个非常小的脚本

```
#!/bin/sh

test="$(/home/dell/case3.3/private.key)"

echo $test 
```

我称这个文件`test1.sh`

我尝试访问一个名为`private.key` Here is the permission set for the file`private.key` `-rw-rw-r--`

这是文件的权限集`test1.sh` `-rwxrwxrwx`

我也尝试过

`chmod u+x test1.sh`

和

`chmod 755 test1.sh`

在我的痛苦中，我也尝试过 `chmod 777 test1.sh`

我相信`777`应该像它一样给予它所有的权限..

我不明白问题是什么，为什么会有一个`permission denied`

我充当`super user`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:33:05.723

`/home/dell/case3.3/private.key`不是脚本，也不是可执行文件。 `$(/home/dell/case3.3/private.key)`尝试执行该文件。目前尚不清楚您要做什么，但也许您想要的是：

```
test="$(cat /home/dell/case3.3/private.key)"
echo "$test" 
```

* * *

^(根据OP的评论进行编辑)

您无需将整个文件保存到变量中即可简单地显示其内容。相反，使用：

```
cat /home/dell/case3.3/private.key 
```

但是，如果您*确实*想保存文件的某些*部分*，请使用`sed`、`grep`或`awk`. 例如

```
test="$(grep 'somethingInTheFile' /home/dell/case3.3/private.key)"
echo "$test" 
```

或者，您可以逐行处理文件：

```
while read line; do
  echo $line
done < /home/dell/case3.3/private.key 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:43:51.970

```
test="$(/home/dell/case3.3/private.key)" 
```

在将文件 /home/dell/case3.3/private.key 分配给变量 $test 之前执行它。由于 /home/dell/case3.3/private.key 没有设置可执行位，您会收到权限被拒绝消息。

例如在我的 linux 系统上：

```
david@david-Mate ~ $ touch xxx
david@david-Mate ~ $ ls -l xxx
-rw-r--r-- 1 david david 0 Aug  2 12:42 xxx
david@david-Mate ~ $ test="$(./xxx)"
bash: ./xxx: Permission denied 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:27:19.147

尝试像这样使用 sudo 运行它：

```
sudo test1.sh 
```

那可能行得通...

# c# - 打开对话框后将 JQuery 对话框的大小调整为内容高度

> ID：11784400
> 
> 赞同：3
> 
> 时间：2012-08-02T19:24:17.133
> 
> 标签：c#, javascript, jquery, asp.net, .net-3.5

我在早上的大部分时间里都浏览了 SO，但我没有发现任何东西可以帮助我做到这一点。

### 目标

我试图在 JQuery 对话框中复制 maxHeight 选项的行为。此选项仅在调整对话框大小后适用，我希望在打开对话框时应用此属性，而不是在调整大小时应用。

除非发布新版本的补丁，否则我能做的最好的就是解决方法。

### 我的项目信息

C# 中的 ASP .NET 3.5

### 细节

我必须打开一个包含 gridview 的对话框（在对话框使用的 div 中），正常使用可以显示从 1 或 2 行到数十行的任何内容。

1.  我在 SO 上找到了一个解决方案，它暗示在我的 div 上设置“max-height”属性，但是调整对话框的大小有一个奇怪的效果，我试图摆脱：

2.  如果内容足够小（通常只有几行的列表），则对话框很小，可以调整为更大的大小。asp:gridview 不会移动并使对话框变大只会在其下方和右侧添加空白。

3.  但是，一旦您再次拖动窗口边缘以使其更小，白色区域将保持相同大小，向上滑动并减小 gridview 区域，最终将其减小到零。

4.  将 gridview 设置为 100% 可以解决这个问题，但随后只用几行使窗口变大会使每行都有几十个像素高。

5.  所以我决定使用一个不可调整大小的对话框来固定高度，这样就不会发生不应该发生的变化，但小内容会在其下方填充空白区域，我们希望窗口可以调整。

最后，我决定尝试将对话框打开到固定高度，然后调整它的大小以适合我的内容，如果内容 div在同一功能中的**高度小于 500 像素。**

我的代码不起作用，我不知道如何得到它，或者即使有可能。

### 这是我的 JS：

```
function ShowReferedTasks(title, s) {

        // On affiche la div qui constitue le popup dialog
        document.getElementById('litReferedTasks').style.display = '';

        //On crée le dialog à partir de la même div       
        $('#litReferedTasks').dialog({
            autoOpen: true,
            modal: true,
            resizable: true,
            show: 'drop',
            hide: 'drop',
            width: 800,
            minHeight: 0,
            height: 500,
            title: 'Tâche' + s + ' référée' + s + ' de ' + title            
        });
        /*option 1 (used):*/ var heightDiv = document.getElementById('litReferedTasks').style.height;
        /*option 2:*/ //var heightDiv = $(this).height($('#litReferedTasks').height());
        if (heightDiv < 500)
        {
            $('#litReferedTasks').dialog('option', 'height', heightDiv);
            /*alternative I tried*/ //$("#dialog").dialog('option', 'height', heightDiv);
        }
    } 
```

### 这是我的 div：

```
<div id="litReferedTasks" style="background-color: White; display: none; height:95%;">
    <asp:GridView ID="gvReferedTasks" runat="server" OnRowDataBound="gvReferedTasks_RowDataBound" Width="97.5%" Visible="false">        
    </asp:GridView>
    <asp:Label ID="lblNoReferedTasks" runat="server" Visible="false" Width="100%"></asp:Label>
</div> 
```

如您所见，我希望我的函数打开对话框，然后确定包含 gridview 的 div 的大小，如果大小低于 500 像素，我希望对话框高度调整为 gridview，否则对于大型内容我只需使用滚动条将其保持在 500 像素高。

感谢您对此的任何帮助。

# 更新 2：

下面的代码有效，但如果关闭我的对话框并重新打开它，则在大内容上调整大小失败。知道为什么吗？基本上它只工作一次，直到我刷新页面并刷新缓存（Ctrl+F5）

# 更新 1：

我结合了我的 js 脚本和@Paul Graffam 给我的东西：

将 div 设置为`inline-block`似乎有效，但随后 js 完成了大部分工作：

```
function ShowReferedTasks(title, s) {

    //On crée le dialog à partir de la même div       
    $('#litReferedTasks').dialog({
        autoOpen: true,
        modal: true,
        resizable: true,
        show: 'drop',
        hide: 'drop',
        width: 800,
        minHeight: 0,
        open: function(event, ui) {
            $(this).css({ 'overflow-y': 'auto' });
        },
        title: 'Tâche' + s + ' référée' + s + ' de ' + title
    });
    // Resizes the dialog to fit the content up to 500px, after which it overflows automatically.
    var heightDiv = $('#litReferedTasks').height();
    if (heightDiv > 450) $('#litReferedTasks').dialog('option', 'height', 500);
} 
```

然后 div 填充整个对话框并在它变得大于它时溢出。对话框首先打开以适应 div，无论它有多大，然后查看 div 的大小，如果大于 500 像素，则将对话框的大小调整为 500px。

看起来它成功地做了我想做的事，没有调整大小限制和`max-height`在 div 上使用带来的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:02:47.050

我想出让这个工作的一个简单方法是将对话 div 的 css`max-height`设置为 500px，然后您可以删除对话框内的高度设置。这样，任何超过 500 像素的东西都将被设置为溢出，而任何小于该值的东西都会自动调整大小，因为高度现在默认为自动。

由于 gridview 使用表格，我认为将 div 的显示设置为`display: inline-block;`并删除将显示设置为空的行很重要。

我在这里用你的一些代码设置了一个例子：http: [//jsfiddle.net/rrAJM/1/](http://jsfiddle.net/rrAJM/1/)

另外，我注意到您一直在使用`document.getElementById`，但由于您使用的是 jQuery，因此没有必要这样做。相反，您可以通过执行以下操作来选择您的元素：`$('#litReferedTasks')`

例如`document.getElementById('litReferedTasks').style.height;`变成`$('#litReferedTasks').height();`

# c++ - 使用扩展功能在整个系统中搜索文件

> ID：11784403
> 
> 赞同：1
> 
> 时间：2012-08-02T19:24:19.907
> 
> 标签：c++, windows, winapi, filesystems

以下代码产生运行时错误：

> Window File Search.exe 中 0x773315de 处未处理的异常：0xC0000005：访问冲突。

我不知道是什么原因造成的。你能指出我的错误吗？

这是可能包含罪魁祸首的函数：

```
int fileSearcher::findFilesRecursivelly(const TCHAR* curDir,const TCHAR* fileName,bool caseSensitive,TCHAR* output)
{
    HANDLE hFoundFile;
    WIN32_FIND_DATA foundFileData;

    TCHAR nextDirBuffer[MAX_PATH]=TEXT("");

    SetCurrentDirectory(curDir);
    //Fetch inside current directory
    hFoundFile = FindFirstFileEx(fileName,FINDEX_INFO_LEVELS::FindExInfoBasic,&foundFileData ,FINDEX_SEARCH_OPS::FindExSearchNameMatch ,NULL , FIND_FIRST_EX_LARGE_FETCH);

    if(hFoundFile != INVALID_HANDLE_VALUE)
    {       
        do
        {
            nothingFound = false;

            wcscat(output,curDir);
            wcscat(output,TEXT("\\"));
            wcscat(output,foundFileData.cFileName);
            wcscat(output,TEXT("\n"));
        }   
        while(FindNextFile(hFoundFile,&foundFileData));
    }

    //Go to the subdirs
    hFoundFile = FindFirstFileEx(TEXT("*"),FINDEX_INFO_LEVELS::FindExInfoBasic,&foundFileData ,FINDEX_SEARCH_OPS::FindExSearchLimitToDirectories ,NULL , FIND_FIRST_EX_LARGE_FETCH); //This line of code was on the call stack

    if(hFoundFile != INVALID_HANDLE_VALUE)
    {
        do
        {
            wcscat(nextDirBuffer,curDir);
            wcscat(nextDirBuffer,TEXT("\\"));
            wcscat(nextDirBuffer,foundFileData.cFileName);
            findFilesRecursivelly(nextDirBuffer,fileName,caseSensitive,outputBuffer);
        }
        while(FindNextFile(hFoundFile,&foundFileData));
    } 

    return 0;

} 
```

不太重要的代码：

文件搜索.h

```
#ifndef UNICODE
#define UNICODE
#endif

#include <Windows.h>

namespace fileSearch
{
class fileSearcher
{
public: 
    fileSearcher();

    void getAllPaths(const TCHAR* fileName,bool caseSensitive,TCHAR* output);   
    /*Returns all matching pathes at the current local system. Format:
    [A-Z]:\[FirstPath\foo1...\fileName]
    [A-Z]:\[SecondPath\foo2...\fileName]
    [A-Z]:\[ThirdPath\foo3...\fileName]
    ...
    [A-Z]:\[FourthPath\foo4...\fileName]
    Also an asterisk sign is supported, as in regular expressions.

    This functions uses WinApi methods.
    */

    int findFilesRecursivelly(const TCHAR* curDir,const TCHAR* fileName,bool caseSensitive,TCHAR* output);
    //Searches for the file in the current and in sub directories. NOT IN PARENT!!!!!!!!!!!!!!!!!!!!! Returns true if the file is found.

private:
    static const int MAX_NUMBER_OF_FILES = 100;
    static const int MAX_OUTPUT_SIZE = 2000;

    bool nothingFound;

    TCHAR outputBuffer[MAX_OUTPUT_SIZE];
};
} 
```

...以及 FileSeach.cpp 的其余部分

```
#ifndef UNICODE
#define UNICODE
#endif

#include "File Search.h"

using namespace fileSearch;

fileSearcher::fileSearcher()
{
    nothingFound = true;
}

void fileSearcher::getAllPaths(const TCHAR* fileName,bool caseSensitive, TCHAR* output)
{
    TCHAR localDrives[50];
    TCHAR currentDrive;
    int voluminesChecked=0;

    TCHAR searchedVolumine[5];

    GetLogicalDriveStrings(sizeof(localDrives)/sizeof(TCHAR),localDrives);

    //For all drives:
    for(int i=0; i < sizeof(localDrives)/sizeof(TCHAR); i++)
    {       
            if(localDrives[i] >= 65 && localDrives[i] <= 90)
            {   
                currentDrive = localDrives[i];
                voluminesChecked++;
            }
            else continue;

    searchedVolumine[0] = currentDrive;
    searchedVolumine[1] = L':';
    searchedVolumine[2] = 0;

    outputBuffer[0]=0;
    findFilesRecursivelly(searchedVolumine,fileName,caseSensitive,outputBuffer);

    (nothingFound) ? wcscpy(output,L"File not found") : wcscpy(output,outputBuffer);

    }

} 
```

**编辑**

经过一些迭代后 curDir 的值是 -

> ```
> + curDir 0x003df234 "C:\.\$Recycle.Bin\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\ .\.\.\.\.\.\.\.\.\." 常量 wchar_t *
> ```

但我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:15:15.913

看起来像缓冲区溢出。在通过目录树进行递归时，您忘记了每个目录都包含对其自身的引用（名称为'.'）和对其父目录的引用（名称为'..'），您必须从递归中排除这些。所以这样做

```
 do
    {
        if (wcscmp(foundFileData.cFileName, TEXT(".") == 0 ||
            wcscmp(foundFileData.cFileName, TEXT("..") == 0)
        {
            continue;
        }
        wcscat(nextDirBuffer,curDir);
        wcscat(nextDirBuffer,TEXT("\\"));
        wcscat(nextDirBuffer,foundFileData.cFileName);
        findFilesRecursivelly(nextDirBuffer,fileName,caseSensitive,outputBuffer);
    }
    while(FindNextFile(hFoundFile,&foundFileData)); 
```

您编写它的方式只是在同一个目录中循环和循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T20:15:37.443

每个非根目录都包含它自己（“.”）和它的父目录（“..”）。您需要从递归搜索中明确排除那些：

```
if (wcscmp(foundFileData.cFileName, L".") != 0 
     && wcscmp(foundFileData.cFileName, L"..") != 0) 
{
  wcscat(nextDirBuffer,curDir);
  wcscat(nextDirBuffer,TEXT("\\"));
  wcscat(nextDirBuffer,foundFileData.cFileName);
  findFilesRecursivelly(nextDirBuffer,fileName,caseSensitive,outputBuffer);
} 
```

# opengl - Java OpenGL仅绘制可见纹理

> ID：11784406
> 
> 赞同：0
> 
> 时间：2012-08-02T19:24:31.410
> 
> 标签：opengl, render, tile

我正在尝试在 LWJGL 中创建一个小型 2D 游戏，但是，大型地图将帧速率从大约 3000 下降到大约 15。我知道这主要是因为它在屏幕上绘制每个图块，即使你只能看到一小部分其中。我想知道如何找到哪些瓷砖是可见的，并且只将它们打印到屏幕上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:30:59.120

这称为[剔除](https://en.wikipedia.org/wiki/Hidden_surface_determination#Culling_and_VSD)，最著名的技术之一是`frustum culling`. 通常，您定义一个包围体并测试一个对象是否位于其中。

例如，在 2D 中，您可以定义一个矩形（与您的窗口/视口相同）并为每个对象（平铺/精灵/其他）定义一个边界框。圆形是一个易于测试的边界框，但矩形也可以。

然后您只需测试对象的边界框和视口矩形是否相交。如果是，请绘制它，否则，不要。

有关 2d 剔除的更多详细信息，另请参阅另一个 SE 站点上的[此答案。](https://gamedev.stackexchange.com/questions/14713/culling-for-a-2d-platformer-game)

# vim - 像 sublimetext 中的 Vim 多行编辑？

> ID：11784408
> 
> 赞同：166
> 
> 时间：2012-08-02T19:24:40.557
> 
> 标签：vim, sublimetext, text-editor

我开始使用 gvim，我不太明白多行编辑在 gvim 中是如何工作的。

例如：

原文：

```
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd; 
```

ctrl+q, jjjjjj , $ 一切都被选中，然后我按 I 进行多行插入。

我的意图是在第一行中插入引号，然后按 Esc：

```
asd "asd asd" asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd;
asd asd asd asd asd; 
```

发生了什么？我期望一种类似于 sublimetext 的行为：

![在此处输入图像描述](../Images/d1f96f8c7ba8c09458f9d248210ad713.png)

如果您不知道它是如何工作的，它只会对每一行重复这些操作。怎样才能做到这一点？vim 在这里做什么？

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-08-03T06:32:41.940

通过删除 Windows 兼容层来帮自己一个忙。

进入可视块模式的正常快捷方式是`<C-v>`.

其他人处理过录制宏，这里有一些其他的想法：

**仅使用*视觉块*模式。**

1.  将光标放在第二个单词上：

    ```
    asd |a|sd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd; 
    ```

2.  点击`<C-v>`进入*视觉块*模式并将您的选择扩展到底部：

    ```
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd;
    asd [a]sd asd asd asd; 
    ```

3.  点击`I"<Esc>`获得：

    ```
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd; 
    ```

4.  将光标放在第三个单词的最后一个字符上：

    ```
    asd "asd as|d| asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd;
    asd "asd asd asd asd; 
    ```

5.  点击`<C-v>`进入*视觉块*模式并将您的选择扩展到底部：

    ```
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd;
    asd "asd as[d] asd asd; 
    ```

6.  点击`A"<Esc>`获得：

    ```
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd; 
    ```

**使用*可视块*模式和[Surround.vim](http://www.vim.org/scripts/script.php?script_id=1697)。**

1.  将光标放在第二个单词上：

    ```
    asd |a|sd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd;
    asd asd asd asd asd; 
    ```

2.  点击`<C-v>`进入*视觉块*模式并将您的选择扩展到底部和右侧：

    ```
    asd [asd asd] asd asd;
    asd [asd asd] asd asd;
    asd [asd asd] asd asd;
    asd [asd asd] asd asd;
    asd [asd asd] asd asd;
    asd [asd asd] asd asd;
    asd [asd asd] asd asd; 
    ```

3.  点击`S"`以围绕您的选择“：

    ```
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd; 
    ```

**具有*视觉线*模式和`:normal`.**

1.  点击`V`以选择整行并将其向底部展开：

    ```
    [asd asd asd asd asd;]
    [asd asd asd asd asd;]
    [asd asd asd asd asd;]
    [asd asd asd asd asd;]
    [asd asd asd asd asd;]
    [asd asd asd asd asd;]
    [asd asd asd asd asd;] 
    ```

2.  执行此命令：`:'<,'>norm ^wi"<C-v><Esc>eea"<CR>`以获得：

    ```
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd;
    asd "asd asd" asd asd; 
    ```

    *   `:norm[al]`允许您在一系列行上执行*普通*`'<,'>`模式命令（该部分由 Vim 自动添加，意思是“作用于选定区域”）

    *   `^`将光标放在该行的第一个字符上

    *   `w`移动到下一个单词

    *   `i"``"`在光标前插入 a

    *   `<C-v><Esc>`是Vim在这个上下文中输入控制字符的方式，这里`<Esc>`用来退出*插入*模式

    *   `ee`移动到下一个单词的末尾

    *   `a"``"`在光标后附加 a

    *   `<CR>`执行命令

    使用 Surround.vim，上面的命令变成

    ```
    :'<,'>norm ^wvees"<CR> 
    ```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-06-13T10:46:46.330

这些是上面给出的一些很好的开箱即用的解决方案，但我们也可以尝试一些提供多个光标的插件，如 Sublime。

我认为这个看起来很有希望：

*   [https://github.com/terryma/vim-multiple-cursors](https://github.com/terryma/vim-multiple-cursors)

它似乎被遗弃了一段时间，但在 2014 年有了一些贡献。

它非常强大，虽然我花了一点时间来适应流程（这很像 Sublime，但仍然像 Vim 一样模态）。

根据我的经验，如果您安装了很多其他插件，您可能会遇到一些冲突！

此功能还有其他一些尝试：

*   [https://github.com/osyo-manga/vim-over](https://github.com/osyo-manga/vim-over)（仅限搜索替换，但带有实时预览）
*   [https://github.com/paradigm/vim-multicursor](https://github.com/paradigm/vim-multicursor)
*   [https://github.com/felixr/vim-multiedit](https://github.com/felixr/vim-multiedit)
*   [https://github.com/hlissner/vim-multiedit](https://github.com/hlissner/vim-multiedit)（基于前文）
*   [https://github.com/adinapoli/vim-markmultiple](https://github.com/adinapoli/vim-markmultiple)
*   [https://github.com/AndrewRadev/multichange.vim](https://github.com/AndrewRadev/multichange.vim)

如果您发现其中任何一项正在改进，请随时进行编辑。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-08-02T20:12:21.413

在 Vim 中有几种方法可以实现这一点。我不知道哪些与 Sublime Text 最相似。

* * *

第一个是通过*多行插入模式*。将光标放在第一行的第二个“a”上，按`Ctrl-V`，选择所有行，然后按`I`，然后加上双引号。按`<esc>`将在每一行重复操作。

* * *

第二个是通过宏。将光标放在第一个字符上，然后使用 开始录制宏`qa`。使用 向右移动`llll`，使用 进入插入模式 `a`，放下双引号，退出插入模式，然后使用`<home>`（或等效项）返回行的开头。按下`j`可向下移动一排。停止录制`q`。然后用 重播宏`@a`。几次。

* * *

上述任何方法对您有用吗？

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-08-02T19:33:48.050

如果您使用“全局”命令，您可以在一个在线的任意行数上重复您可以执行的操作。

```
:g/<search>/.<your ex command> 
```

例子：

```
:g/foo/.s/bar/baz/g 
```

上面的命令查找所有具有 foo 的行，并将该行上所有出现的 bar 替换为 baz。

```
:g/.*/ 
```

会在每一行做

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2017-09-15T18:04:23.340

```
Ctrl-v ................ start visual block selection
6j .................... go down 6 lines
I" .................... inserts " at the beginning
<Esc><Esc> ............ finishes start
2fdl. ................. second 'd' l (goes right) . (repeats insertion) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-08-02T20:29:21.723

我不确定`vim`在做什么，但这是一个有趣的效果。您描述所需内容的方式听起来更像是宏的工作方式（`:help macro`）。像这样的东西可以用宏做你想做的事情（从正常模式开始）：

1.  `qa`：录制宏进行`a`注册。
2.  `0w`:`0`转到行首，`w`跳一个字。
3.  `i"<Esc>`: 进入insert-mode，插入a `"`，返回normal-mode。
4.  `2e`: 跳转到第二个单词的末尾。
5.  `a"<Esc>`: 附加一个`"`.
6.  `jq`移至下一行并结束宏录制。

综合起来： `qa0wi"<Esc>2ea"<Esc>`

现在您可以使用 执行宏`@a`，使用 重复上一个宏`@@`。要应用于文件的其余部分，请执行类似`99@a`假设您没有超过 99 行的操作，宏执行将在到达文件末尾时结束。

以下是如何实现您想要的`visual-block-mode`（从正常模式开始）：

1.  导航到您想要第一个报价的位置。
2.  输入`visual-block-mode`，选择要影响的行，`G`以转到文件底部。
3.  打`I"<Esc>`。
4.  移动到下一个要插入`"`.
5.  你想重复你刚刚做的，所以一个简单的`.`就足够了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-15T07:20:43.130

我的解决方案是使用这两个映射：

```
map <leader>n <Esc><Esc>0qq
map <leader>m q:'<,'>-1normal!@q<CR><Down> 
```

* * *

**如何使用它们：**

1.  选择您的线路。如果我想选择接下来的 12 行，我只需按`V12j`
2.  按`<leader>n`
3.  对行进行更改
4.  确保您处于正常模式，然后按`<leader>m`

要进行另一次编辑，您无需再次进行选择。只需按`<leader>n`，进行编辑，然后按`<leader>m`即可应用。

* * *

**这是如何工作的：**

*   `<Esc><Esc>0qq`退出视觉选择，转到行首并开始录制宏。

*   `q`停止录制宏。

*   `:'<,'>-1normal!@q<CR>`从视觉选择的开始到结束前的行，在每一行上播放宏。

*   `<Down>`回到最后一行。

* * *

您也可以只映射相同的键但用于不同的模式：

```
vmap <leader>m <Esc><Esc>0qq
nmap <leader>m q:'<,'>-1normal!@q<CR><Down> 
```

尽管这会破坏您进行另一次编辑的能力。您必须重新选择您的线路。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-01T08:58:29.310

如果有人喜欢我发现了这个老话题：

一个很棒的插件： [https ://github.com/mg979/vim-visual-multi/](https://github.com/mg979/vim-visual-multi/)

它真的很接近 SublimeText 的多行编辑体验并且效果很好。

# css - Firefox 奇怪的百分比高度绝对定位 div

> ID：11784410
> 
> 赞同：0
> 
> 时间：2012-08-02T19:24:46.080
> 
> 标签：css, modal-dialog

我有一个像这样设置的纯 CSS 模式对话框

```
div {
  position:fixed;
  top:50%;
  left:50%;
  margin:-26% 0 0 -26%;
  width:46%;
  height:46%;
  padding:3%;
} 
```

这个 div 在 webkit 浏览器中居中显示。然而，在 FF 中，它几乎触及屏幕顶部。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:31:37.837

您可以执行以下操作，而不是使用边距：

```
top: 25%;
left: 25%; 
```

[http://jsfiddle.net/wwRUT/2/](http://jsfiddle.net/wwRUT/2/)

我不认为我会结合利润和固定定位。

# grails - grails test-app 单元测试类没有找到被测类的最新版本（找不到符号）

> ID：11784412
> 
> 赞同：2
> 
> 时间：2012-08-02T19:24:55.160
> 
> 标签：grails, sts-springsourcetoolsuite

我有一个使用 Groovy/Grails Tool Suite 版本 3.0.0M3 创建的 Grails 项目，它在带有 JDK 1.7 的 Windows 7 上运行。Grails 版本是 2.0.4。

有一个单元测试类运行良好，直到我通过更改方法名称和添加新方法来重构被测类。被测类位于 src/java 下的一个包中。单元测试类已更新以反映重构更改，但现在当 grails test-app 执行时，单元测试报告编译错误，指出它“找不到符号”所有这些错误都与重命名的方法或新方法有关我补充说。请注意，工具套件不会在项目浏览器窗格中显示任何错误标记。

我已经从命令行和 Tool Suite 以及 Tool Suite project->clean 命令运行 grails clean。我的 BuildConfig.groovy 为 grails.project.class.dir 设置了正确的目录，并且我验证了该位置中的类文件在编译后正在更新。这是报告的错误消息之一

> XMLUtilTest.java:73：错误：找不到符号
> 
> ```
>  Package pkg = u.unmarshalPackage(packageRefXml);
>                 ^ 
> ```
> 
> 符号：方法 unmarshalPackage(String) 位置：XMLUtil 类型的变量 u

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T17:57:53.260

尝试以下操作：

1.  在您的项目上运行刷新依赖项。（选择项目时 Alt+GR）再次运行测试。在职的？
2.  尝试在命令行上运行 test-app。它有效吗？
3.  您也可以尝试右键单击测试 Run As -> JUnit test

我的猜测是 STS 内部的 grails 正在使用一些旧类。Eclipse 项目将`target-eclipse/classes`用于其输出文件夹，但 Grails 默认情况下将`target/classes`用于其输出文件夹。

我会在项目内部的命令行上为调用的文件执行 grep，`XMLUtil*.class`您可能会找到重复项所在的位置。

# objective-c - 为什么我的 NSString 导致 NSLog 只显示字符串的一部分？

> ID：11784414
> 
> 赞同：0
> 
> 时间：2012-08-02T19:25:08.287
> 
> 标签：objective-c

假设我正在尝试打印出这样的字符串：

```
NSLog(@"*** DOWNLOAD START ***\n%@\n*** DOWNLOAD END ***", bufString); 
```

bufString 是一个 NSString。bufString 包含什么会导致输出在其第一个字符后被截断？我的猜测是它与将换行表示转换为字符串终止字符有关。

此语句日志的完整读数：

```
2012-08-02 12:20:02.595 MyApp[18863:710f] *** DOWNLOAD START ***
{ 
```

[bufString length] 的结果是 15914。它试图显示的数据是多行 JSON。

我该怎么做才能打印出整个字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T16:18:35.090

在我的例子中，我从字节创建了 NSString，但只有每四个字节包含字符信息。底线——如果你从字节创建一个 NSString 确保你知道那个内存中有什么！一次遍历 NSString 字符并打印结果（由封面建议）揭示了问题。

# networking - 用于出站丢包的简单网络监控

> ID：11784415
> 
> 赞同：1
> 
> 时间：2012-08-02T19:25:11.873
> 
> 标签：networking, ping

我的家庭网络有一些问题，它们似乎都与康卡斯特的吸吮有关。我想要一些方法来监控我的出站流量 - ping 命令很好。我想要保留细节并生成精美统计数据的东西。

我知道我可以编写一些脚本，但我的要求更多的是一些已经存在的东西，或者如果有人已经编写了我可以使用的脚本。

我有一个 mikrotik 路由器，在那里没有找到太多帮助。我还有一个运行 linux 的 QNAP 文件服务器。

感谢您提出任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:12:04.737

[Bro](http://www.bro-ids.org)监控您的网络并生成大量日志以供日后分析。正如您在问题中提到的，它还捕获 ICMP 流量。安装后，给它一个嗅探的接口：

```
bro -i en0 
```

并且 Bro 开始在您开始的同一目录中生成日志。还有一个交互式 shell 来配置和运行 Bro，称为[BroControl](http://www.bro-ids.org/documentation/components/broctl/README.html)。

# php - 连接表但产生嵌套结果的更有效方法？

> ID：11784416
> 
> 赞同：0
> 
> 时间：2012-08-02T19:25:11.387
> 
> 标签：php, mysql, codeigniter

在 PHP 中使用 codeigniter 活动记录实现这样的结果集的最有效方法是什么？

```
[2] => stdClass Object
    (
        [id] => 12
        [title] => 2 sections
        [layout_id] => 1
        [layout] => stdClass Object
            (
                [id] => 1
                [file] => 3_column.php
                [title] => 3 Column
            )

        [sections] => Array
            (
                [0] => stdClass Object
                    (
                        [module_id] => 12
                        [section_id] => 1
                    )

                [1] => stdClass Object
                    (
                        [module_id] => 12
                        [section_id] => 2
                    )

            )

    ) 
```

这里有一些东西可以给我想要的嵌套结果，但我发现这种方法效率很低（忽略`select *`每个查询的）

```
public function all()
{
  $rows = $this->db->get('modules')->result();

  foreach($rows as &$row)
  {
    $row->layout = $this->db->get_where('layouts', array('id' => $row->layout_id), 1)->first_row();
    $row->sections = $this->db->get_where('modules_sections', array('module_id' => $row->id))->result();
  }

  return $rows;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:55:23.037

您可以使用一些连接和 GROUP_BY 子句轻松地将这几个查询转换为一个查询。这种方法最大的缺点是它需要对数据进行一点分组和定界，但 PHP 擅长“爆炸”定界数据。试试这个：

```
function all()
{

    $this->db->select("`modules`.*, CONCAT(`layouts`.`id`,'".DATA_SUBDELIMITER."',`layouts`.`title`,'".DATA_SUBDELIMITER."',`layouts`.`file`) AS layout, CAST(GROUP_CONCAT(`sections`.`id`,'".DATA_SUBDELIMITER."',`sections`.`title` SEPARATOR '".DATA_DELIMITER."') AS CHAR) AS sections", false);
    $this->db->from('modules');
    $this->db->join('layouts', 'layouts.id = modules.layout_id');
    $this->db->join('modules_sections', 'modules_sections.module_id = modules.id');
    $this->db->join('sections', 'sections.id = modules_sections.section_id');
    $this->db->group_by('modules.id');

    $rows = $this->db->get()->result_array();
    foreach($rows as &$row)
    {
        foreach($row as $k=>&$r)
        {
            if($k=='layout' || $k=='sections')
            {
                $new_r = explode(DATA_DELIMITER, $r);
                foreach($new_r as &$c)
                {
                    $e = explode(DATA_SUBDELIMITER,$c);
                    $c = array();
                    list($c['id'],$c['title']) = $e;
                    if(!empty($e[2])) $c['file'] = $e[2];
                }
                if($k=='layout') $new_r = $new_r[0];
                $r = $new_r;
            }
        }
    }

    return $rows;
} 
```

此示例使用 DATA_DELIMITER 和 DATA_SUBDELIMITER 作为分隔数据的字符。如果您使用这些常量，那么您可能应该在您的 application/config/constants.php 文件中定义它们。或许是这样的：

```
define('DATA_DELIMITER','||');
define('DATA_SUBDELIMITER','##'); 
```

测试此代码以产生如下结果：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [title] => Module 1
            [layout_id] => 1
            [layout] => Array
                (
                    [title] => 3 Column
                    [id] => 1
                    [file] => 3_column.php
                )

            [sections] => Array
                (
                    [0] => Array
                        (
                            [title] => Section 1
                            [id] => 1
                        )

                    [1] => Array
                        (
                            [title] => Section 2
                            [id] => 2
                        )

                )

        )

    [1] => Array
        (
            [id] => 2
            [title] => Module 2
            [layout_id] => 2
            [layout] => Array
                (
                    [title] => 2 Column
                    [id] => 2
                    [file] => 2_column.php
                )

            [sections] => Array
                (
                    [0] => Array
                        (
                            [title] => Section 1
                            [id] => 1
                        )

                    [1] => Array
                        (
                            [title] => Section 3
                            [id] => 3
                        )

                )

        )

    [2] => Array
        (
            [id] => 3
            [title] => Module 3
            [layout_id] => 1
            [layout] => Array
                (
                    [title] => 3 Column
                    [id] => 1
                    [file] => 3_column.php
                )

            [sections] => Array
                (
                    [0] => Array
                        (
                            [title] => Section 3
                            [id] => 3
                        )

                )

        )

    [3] => Array
        (
            [id] => 4
            [title] => Module 4
            [layout_id] => 2
            [layout] => Array
                (
                    [title] => 2 Column
                    [id] => 2
                    [file] => 2_column.php
                )

            [sections] => Array
                (
                    [0] => Array
                        (
                            [title] => Section 1
                            [id] => 1
                        )

                    [1] => Array
                        (
                            [title] => Section 2
                            [id] => 2
                        )

                    [2] => Array
                        (
                            [title] => Section 3
                            [id] => 3
                        )

                    [3] => Array
                        (
                            [title] => Section 4
                            [id] => 4
                        )

                )

        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:26:56.593

高效在这里是一个相对的术语。

如果您正在考虑最小化 sql server 上的查询，您总是可以序列化您的对象并将它们存储在缓存表中，那么您只有一个查找，但您必须在任何类型的写入操作中维护这些对象。除此之外，您可能只需要加载测试并查看瓶颈在哪里。有时，多个查询可能比一个巨大的多表连接更快。

# c# - 在代码背后的基础设施 webdropdown 上的项目模板中查找控件

> ID：11784423
> 
> 赞同：0
> 
> 时间：2012-08-02T19:25:37.837
> 
> 标签：c#, infragistics

我在 ItemTemplate 中创建了一个带有 WebDataGrid 的 Infragistics WebDropDown。问题是在后面的代码中，它说 wddAddresses 没有控件也没有任何模板，并且 ItemTemplate 为空。如何在后面的代码中“找到” WebDataGrid？控件的标记如下。

谢谢，丹

```
<ig:WebDropDown 
  ID="wddAddresses" 
  runat="server" 
  Width="200px" 
  DropDownContainerWidth="500px" 
  ClientEvents-ValueChanging="wddAddresses_ValueChanging">
  <DropDownItemBinding TextField="city" ValueField="addressID" />
  <ItemTemplate>
    <ig:WebDataGrid ID="gridAddresses" runat="server" AutoGenerateColumns="False" 
      Height="350px" Width="400px" >
      <Columns>
        <ig:BoundDataField 
          DataFieldName="street1" 
          Key="street1">
          <Header Text="Street" />
        </ig:BoundDataField>
      </Columns>
      <Behaviors>
        <ig:Selection 
          CellClickAction="Row" 
          RowSelectType="Single" 
          SelectionClientEvents-RowSelectionChanged="gridAddresses_RowSelectionChanged">
        </ig:Selection>
      </Behaviors>
    </ig:WebDataGrid>
  </ItemTemplate>
</ig:WebDropDown> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:27:34.070

答：来自 Infragistics 支持的 Petar。

可以通过 WebDropDown 的项目访问模板化控件。下面的例子；

```
(WebDropDown1.Items[0].FindControl("Button1") as Button).Text = "new text"; 
```

# mysql - 根据两个表中的数据选择行

> ID：11784427
> 
> 赞同：1
> 
> 时间：2012-08-02T19:25:54.870
> 
> 标签：mysql

我正在尝试学习如何将一个表中的数据与另一个表相关联。

假设我有一个名为“car ids”的表，其中只包含存储在单独表中的汽车的 id。这个“单独的”表称为“汽车”，包含汽车 ID 和品牌和型号。

我试图提出一个mysql语句，通过将汽车ID表中的ID与汽车表相关联来从汽车表中选择行。

就像是：

mysql_select("SELECT * FROM cars WHERE id=["SELECT id FROM car_id"]");

我很感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:28:58.077

我不知道为什么你会有一个只有汽车 ID 的表，然后是一个包含这些汽车信息的表，但这是你需要的那种查询

```
SELECT cars.* FROM cars JOIN ids on cars.id = ids.car_id 
```

关键是使用 JOIN

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:28:20.033

```
Select * FROM cars,ids where cars.id=ids.id and ids.id={something} 
```

其中 {something} 是 id 的一些条件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:29:28.830

试试这个...

```
SELECT cars.*, cars_id.*
FROM cars
LEFT JOIN cars_id
ON cars_id.id = cars.id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T19:29:50.197

你必须使用[JOIN](http://en.wikipedia.org/wiki/Join_%28SQL%29)

```
SELECT * FROM cars INNER JOIN car_id on cars.id=car_id.id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T19:30:01.517

您正在寻找一个`JOIN`. 对于您的示例，如下所示：

```
SELECT * FROM `cars` C
JOIN `ids` I ON C.id=C.car_id 
```

请注意，连接两个表有很多不同的方法；您将需要更好地指定您需要什么，或者开始阅读连接。

# javascript - javascript中的HMAC SHA256十六进制摘要

> ID：11784432
> 
> 赞同：3
> 
> 时间：2012-08-02T19:26:18.823
> 
> 标签：javascript, sha256, hmac

我正在尝试编写一个 javascript 库来将事件推送到 Pusher。

在我使用的环境中，我不能使用 nodejs，所以不需要 require('crypto') ...或者至少我不知道在 node 之外使用它的方法。

我在这里遵循示例指南：http: [//pusher.com/docs/rest_api](http://pusher.com/docs/rest_api)；我被困在它说我应该生成 HMAC SHA256 十六进制摘要的部分。

我正在使用这个库[http://code.google.com/p/crypto-js/#HMAC](http://code.google.com/p/crypto-js/#HMAC)

所以，按照我写的 Pusher 上的说明

```
CryptoJS.HmacSHA256(
  'POST\n/apps/3/channels/project-3/events\nauth_key=278d425bdf160c739803&auth_timestamp=1272044395&auth_version=1.0&body_md5=7b3d404f5cde4a0b9b8fb4789a0098cb&name=foo',
  '7ad3773142a6692b25b8'
); 
```

但这给了我`20b132baa2aaf44ea1fab814f0788aaa44eed23a2d252c72e4dc2aaea0d6ac24`而不是`b3152b2bb5a5b0bae66435a498797aa763e9b74f86cc97c9175424f8308b2f80`.

困扰我的是我没有做“十六进制摘要”部分，所以也许这就是我所缺少的，但我找不到合适的库来在 javascript 中执行此操作。你发现我所做的任何错误吗？你有推荐的图书馆吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-13T06:37:03.987

我正在努力做同样的事情。Pusher 的文档应该对这个问题更加清楚。事实证明这不是加密方法。这是您列出参数的顺序。您的邮件正文必须完全按照以下格式进行格式化：

```
{"data":"{\\"message\\":\\"hello world\\"}","name":"my_event","channel":"test_channel"} 
```

必须首先是数据，然后是消息，然后是名称，最后是通道名称。

然后，当您创建身份验证签名时，您必须按如下方式列出您的参数：

```
POST\n/apps/3/events\nauth_key=278d425bdf160c739803&auth_timestamp=1353088179&auth_version=1.0&body_md5=ec365a775a4cd0599faeb73354201b6f 
```

所以首先是身份验证密钥，然后是时间戳，然后是身份验证版本，最后是正文 md5。

一旦我遵循了这个确切的模式，我就让它工作了。希望这会有所帮助！

# python - 如果 elif else 不工作

> ID：11784436
> 
> 赞同：3
> 
> 时间：2012-08-02T19:26:36.343
> 
> 标签：python

我有以下用于 if、elif、else 语句的 python 代码：

```
 if line_num == 151:
            if self.run_count == 1:
                print(values[self.run_count-1])
        elif line_num == 129:
            if self.run_count == 2:
                print(values[self.run_count-1])
        elif line_num == 129:
            if self.run_count == 3:
                print("here")
        else:
            print(line_num)
        f.write(line) 
```

第一个 if 和 elif 语句的代码正确执行。但是，您可以通过此[输出](http://pastebin.com/2pKcxmBd)看到，当语句进入第三个 elif 语句（其中运行计数为 3）时，代码的第三次运行它执行该语句但不打印任何内容，并且不执行 else 语句. 我已经检查了 run_count 是否确实是 3 并且它根本没有把我的程序扔掉。

当前一个工作正常并且满足所有条件时，是否有人知道它可能会进入该 elif 语句但从不打印任何内容？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-02T19:28:23.120

两条`elif line_num == 129`语句都不会被执行，因为它们具有相同的条件。相反，尝试这样的事情：

```
 if line_num == 151:
        if self.run_count == 1:
            print(values[self.run_count-1])
    elif line_num == 129:
        if self.run_count == 2:
            print(values[self.run_count-1])
        elif self.run_count == 3:
            print("here")
    else:
        print(line_num)
    f.write(line) 
```

# extjs - 您如何为不同的 JSP 调用不同的 Ext JS 4.1 控制器？

> ID：11784437
> 
> 赞同：1
> 
> 时间：2012-08-02T19:26:39.220
> 
> 标签：extjs

在尝试使用 Ext JS 4.1、JSP 和 Spring MVC 3.1 实现我的应用程序时，我遇到了一个基本问题。我的问题在于 Ext JS 4.1，因为我非常擅长 Spring。

我有一个 app.js 类型文件，根据其他帖子似乎是惯例。我有多个 JSP，它们都有不同的小部件布局。说我应该每 1 个 JSP 有 1 个 Ext JS 控制器是否正确？如果是这样，我该怎么做？如果没有，我错过了什么。

在我的 JSP 文件中，我引用了当前具有单个控制器的 app.js 文件。我不明白我将如何让第二个 JSP 引用相同的 app.js 文件并要求/告诉它使用不同的 Ext JS 控制器。任何人都可以帮助我理解这一点吗？

是的，我已经阅读了 Ext JS 的文档，但除了使用 1 个控制器之外，我什么也没看到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T01:34:36.413

快速回答：

您可能希望在一页中包含所有脚本标签。然后使用带有卡片布局的面板作为您的主容器，其中包含您的管理和用户面板等子项。然后，您可以切换卡片布局以在任何给定时间将要显示的项目设置为活动卡片。这些子组件中的每一个都可以具有所需的布局和其他组件的任意组合。

当您进入暂存或生产环境时，可以将所有文件合并到一个 app.js 中。对于开发环境来说，拥有一个用于开发的 app.js 文件通常并不理想，因为它会减慢您的速度并使调试变得更加困难。将文件组合到单个 app.js 中非常适合生产环境，以提高浏览器的性能。

更长的答案：

您可以拥有多个 jsp 视图页面，这正是您想要的，但您可能想要移动到“Sencha 方式”并为主应用程序使用单个视图。

Ext JS 的一个常见用途是单页应用程序，这意味着您对主应用程序有一个单一的 jsp 视图。通常，您可能使用的唯一其他页面是另一个 jsp 上的登录表单。

从通过 jsp 视图从服务器请求每个页面视图切换到使用单页应用程序时，通常需要一些时间来适应，但是一旦完成转换，在单页应用程序中工作对于用户和开发来说都是一种很好的体验， 也。

在单页应用程序中，主 jsp 页面将包含所有 Ext JS 视图的所有脚本以及通过 script 标签包含在其中的所有 Ext JS 控制器。在生产环境中，您将希望使用 JAWR 或 jsbuilder3，但在早期开发阶段，您可能只包含每个脚本标签以最大程度地减少工作量。

我现在正在使用的一个非常大的应用程序是一个带有 login.jsp 和 home.jsp 的 Spring MVC 应用程序。Login.jsp 使用 Spring Security，其中包含零 Ext JS。成功登录会将用户带到 home.jsp，其中包含所有脚本。

这是您可能想要尝试设置的配置。这与我经常设置的类似。其中一些信息可能已经很熟悉，但以防万一。

Ext JS 视图。您可以使用带有边框布局的视口。视口组件使用完整的浏览器区域。边框布局为您提供五个区域来放置组件，分别是北、东、南、西和中心。您只需要使用一个中心区域，然后使用任何其他想要的区域。您可以像往常一样在东部和北部地区包括导航面板和按钮。您可以在中心区域包含一个带有卡片布局的面板。卡片布局应该将您的管理员视图、用户视图等作为该面板的子项。由于使用了卡片布局，因此在任何时候都只能看到其中一项。

然后可以使用布局和组件的任意组合来配置这些视图中的每一个。

Ext JS 控制器 配置好视图后，包括一个绑定到导航项（如按钮）的导航控制器。单击导航按钮时，必须切换卡片布局 activeItem，以便将管理员、用户或其他面板项设置为活动状态。对用户来说，“页面”似乎已经改变。

从这里您可以为该主卡布局中的每个主视图创建一个控制器 - 用户控制器、管理控制器等。

如果你还没有读过这些，它们值得一读：

[http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture](http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture) [http://docs.sencha.com/ext-js/4-1/#!/guide/mvc_pt1](http://docs.sencha.com/ext-js/4-1/#!/guide/mvc_pt1)

# joomla - VirtueMart 2 自定义结帐步骤

> ID：11784439
> 
> 赞同：2
> 
> 时间：2012-08-02T19:26:40.330
> 
> 标签：joomla, virtuemart

我需要更改 VirtueMart 默认执行结帐的方式。默认情况下，它是这样的：

1) 带有登录/注册、地址和东西、项目列表
的购物车页面 2) 确认订单

我需要的：

1）只有项目列表
2）登录/注册，地址和东西
最好没有确认页面，填写表格后立即结帐。

最好/最简单的方法是什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-02T19:31:12.950

对于 VM 2.0，这些都是 Virtuemart 管理控制面板中的所有可配置选项。与大多数 VM 配置的情况一样，它并不总是特别直观，但新版本比旧版本要好得多。

花一些时间查看 VM 配置和商店选项卡，看看如何让它表现出你想要的样子。在我看来，您的列表中没有任何内容无法配置。

# perl - 如何打开电子邮件文件，使用前 2 个字母动态创建文件夹和文件，然后附加匹配电子邮件的文件？

> ID：11784447
> 
> 赞同：1
> 
> 时间：2012-08-02T19:27:14.990
> 
> 标签：perl, file

这是一个很长的问题，我无法全部了解。但是，我正在尝试在没有 MySQL 的情况下做一些事情并使用文件。不是首选方法，但我需要弄清楚。

1 - 我想打开一个单列中的电子邮件文件。

```
email1@email.com
evail2@email.com
etail3@email.com 
```

可能是 100k 行！

2- 然后我想去掉电子邮件的前两个字符并创建文件夹。（“e/em”“e/ev”或“e/et”每个例子*1（如果！存在自然））

3- 创建一个 txt 文件，命名为两个字母 *1（如果！存在）。（路径示例 = e/em/em.txt e/ev/ev.txt 和 e/et/et.txt）

4- 使用以上述前两个字母开头的唯一电子邮件附加这些文件。（因此，e/em/em.txt 将包含 email1@email.com，e/ev/ev.txt 将包含 evail2@email.com 等）

我知道这很疯狂。但这就是我需要做的。（我被 MySQL 宠坏了）。

我这样做的尝试是如此痛苦和耗时......我只需要来这里寻求指导。

如果有帮助，我很乐意安装文件处理模块。

*1 如果每次都避免目录和文件检查是有益的，我想运行一个脚本来创建所有可能的文件夹，并提前用每个文件夹的空文件填充它们。创建 26 个文件夹 (az)，每个文件夹包含 26 种可能的组合 (/aa /ab /ac)，所有文件夹都包含创建的适当的两个字母的空白文件。

我需要一些关于如何做这一切的课程。虽然很傻，但我仍然需要知道如何。

添加：

目录和文件名实际上可以以 - 或 _ 开头

仍然需要调整，但感谢您的帮助：

```
#!/usr/bin/perl -w
use strict;
use warnings;
use CGI;
use CGI ':standard';
print CGI::header();
use File::Basename;
use File::Path qw/make_path/;
use CGI::Carp qw(fatalsToBrowser warningsToBrowser);
my $path='/home/xxxx/public_html/some/directory';
my $file='1.txt';
my %EmailAddresses;
  open my $IN, '<', $path.'/'.$file or die $!;
   while (<$IN>) {
   chomp;                
   $_=~ s/\s//g;
   undef $EmailAddresses{$_};
  }
for my $EmailAddress(keys %EmailAddresses) {
 ## need to sanitize substr here for use below
  my $filename= join '/', substr($EmailAddress,0,1), substr($EmailAddress,0,2), substr($EmailAddress,0,2) . '.txt';
  $filename = $path.'/'.$filename;
  my $dir = dirname($filename);
   make_path($dir) unless -d "$dir";
     open (OUT, '>>', $filename) || die $!;
     #need to check for dupes and remove other possible issues!
     print OUT $EmailAddress, "\n";
     close OUT;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:54:20.487

我使用哈希来获取唯一的电子邮件。但是，您的结构中有很多多余的步骤 - 我会删除二级目录，它的名称与文件名相同，无论如何。

```
#!/usr/bin/perl
use warnings;
use strict;

my %emails;
open my $IN, '<', '1.txt' or die $!;
while (<$IN>) {
    chomp;
    undef $emails{$_};
}

for my $email (keys %emails) {
    open my $OUT, '>>', join '/', substr($email,0,1), substr($email,0,2),
        substr($email,0,2) . '.txt' or die $!;
    print {$OUT} $email, "\n";
} 
```

首先将电子邮件分组在哈希中，然后逐个文件打印更快：

```
#!/usr/bin/perl
use warnings;
use strict;

my %emails;
open my $IN, '<', '1.txt' or die $!;
while (<$IN>) {
    chomp;
    undef $emails{substr($_, 0, 1)}{substr($_, 0, 2)}{$_};
}

for my $one (keys %emails) {
    for my $two (keys %{ $emails{$one} }) {
        open my $OUT, '>', join '/', $one, $two, $two . '.txt' or die $!;
        print {$OUT} "$_\n" for keys %{ $emails{$one}{$two} };
    }
} 
```

# java - spring 在表单中显示错误的用户输入：输入

> ID：11784449
> 
> 赞同：1
> 
> 时间：2012-08-02T19:27:25.763
> 
> 标签：java, spring

我的控制器中有一个模型对象。

比方说

```
Class person{
    Date birthDay;
} 
```

当它以表单形式显示时：输入，如果用户输入“aaaaa”，当然它会失败，我只是将用户引导到同一页面并通过再次将人重新建模来向他们显示错误。但是有没有办法让用户在输入字段中输入错误？

```
<form:input path="birthday"/> 
```

只会显示为空，因为绑定失败。我是否必须使用 DTO 对象并将所有内容都设为字符串，以便仍然可以显示错误的输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:34:13.620

我无法复制你的情况。你能提供更多代码吗？我的 exapme 显示错误的输入：

```
public class Person {

private Date birthDay;

public void setBirthDay(Date birthDay) {
    this.birthDay = birthDay;
}

public Date getBirthDay() {
    return birthDay;
}
} 
```

控制器：

```
@Controller
@RequestMapping("/person")
public class PersonController {

@RequestMapping(value ="/edit", method=RequestMethod.GET)
public String edit(Person person, BindingResult result){

    return "person/edit";       
}

@RequestMapping(value ="/edit", method=RequestMethod.POST)
public String submit(Person person, BindingResult result){
    if(result.hasErrors()){
        return "person/edit";   
    } else {
        return "redirect:person/edit.ss";
    }
} 
```

jsp：

```
<%@ page language="java" contentType="text/html; charset=UTF-8"
pageEncoding="UTF-8"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %> 
<form:form method="POST" modelAttribute="person">
Birth day: <form:input path="birthDay" /><form:errors path="birthDay" />
<br />
<input type="submit" value="Submit" />
</form:form> 
```

# asp.net - 使用 IE8 浏览到我的 VisualBasic2010 创建的 Web 应用程序的 URL 不会保留 cookie

> ID：11784471
> 
> 赞同：0
> 
> 时间：2012-08-02T19:28:32.810
> 
> 标签：asp.net, vb.net, security, internet-explorer, cookies

所有其他浏览器（FireFox、Chrome 等）cookie 都可以正常保存。注意：使用 IE8 通过使用 Web 应用程序的 IP 地址而不是 URL 浏览到我的 Web 应用程序将保持 cookie 正常。

我的 IE8 浏览器选项设置为接受所有 Cookie。

这在多台计算机上的 IE8 上失败。

我可以在 IE8 > 中看到`Dev Tools > Cache > View Cookie Info`cookie 没有被存储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T14:38:45.423

解决方案：在我重新修改了存储 cookie 的方法后，问题就消失了……

```
sub update_cookie_string( cookie_string, cookie_subkey  )

    dim cookie_object as HttpCookie     
    if request.cookies( PROGRAM_COOKIE_NAME ) is nothing then   ' PROGRAM_COOKIE_NAME not at browser?
        cookie_object = new httpcookie( PROGRAM_COOKIE_NAME )           ' init cookie object as cookie named: PROGRAM_COOKIE_NAME
    else
        cookie_object = request.cookies( PROGRAM_COOKIE_NAME )          ' Read cookie named PROGRAM_COOKIE_NAME from page from browser
    End If

    cookie_object.Values( cookie_subkey ) = cookie_string       ' Update cookie_subkey with new value cookie_string
    cookie_object.Expires = DateTime.Now.AddDays(365)           ' set expiration for a long time
    response.Cookies.add( cookie_object )                   ' Send it back to browser for storage there.
end sub

' Retrieve stored cookie_subkey.
function get_cookie_string( byval cookie_subkey  ) 
    dim cookie_object as HttpCookie     
    if  request.cookies( PROGRAM_COOKIE_NAME ) is nothing then  ' PROGRAM_COOKIE_NAME not at browser?
        get_cookie_string = ""
    else
        get_cookie_string = Request.Cookies( PROGRAM_COOKIE_NAME )( cookie_subkey )  ' Return string value of cookie_subkey 
    End If 
```

# ssis - 在维度表中生成默认值

> ID：11784472
> 
> 赞同：2
> 
> 时间：2012-08-02T19:28:41.220
> 
> 标签：ssis, data-warehouse, etl, dimensional-modeling

关于维度模型中的默认值，如此[处所示，](http://www.kimballgroup.com/html/designtipsPDF/DesignTips2003/KimballDT43DealingWith.pdf?TrkID=DT128_DT43) 是否有人对生成这些值的最佳实践有建议？

您是否看到它们与数据仓库数据库或 ETL 流程相关？

假设我们有一个 MS 解决方案，您会将它们作为 DW Sql Server 数据库项目中的部署后脚本，或者如何将它们添加到 ETL 集成服务项目中的维度表中？如果是后者，如何在运行时生成行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:38:59.313

通常，默认值根本*不会*自动生成。当我对将具有“未知”值或“无”值的维度进行建模时，由于我的键几乎总是正大整数，我只使用“-1”作为“未知”的 id，使用“0”作为“没有任何”。您甚至可以为“数据尚不可用”等添加“-2”。

我通常将这些插入作为新维度表的 DDL 安装脚本的一部分包含在内，并且只需确保我的自动编号系统（无论我们使用哪个 DBMS）从 1 开始。

在分配维度键的事实的 ETL 过程中，如果您读取源表并找到指示值是“未知”的条件，则将 -1 分配给该维度值。如果您找到指示值为“无”的条件，则分配 0。

# r - 使物体消失的功能

> ID：11784475
> 
> 赞同：4
> 
> 时间：2012-08-02T19:29:04.527
> 
> 标签：r, function, variables, object, spatstat

这是我遇到的一个非常奇怪的情况。基本上，我试图将累积分布函数拟合到我的数据的 G 函数中。这样做之后，我想绘制模型和原始数据，并将其输出为 PDF。我将允许代码解释（只需复制和粘贴）：

```
library(spatstat)

data(swedishpines)

mydata <- swedishpines

mydata.Gest <- Gest(mydata)

Gvalues <- mydata.Gest$rs

count <- (which(Gvalues == 1))[1]

new_r <- seq(1/count, length(Gvalues)/count, by = 1/count)

GvsR_dataframe <- data.frame(G <- Gvalues, R <- new_r)

themodel <- suppressWarnings(nls(G ~ pnorm(R, mean, sd), data = GvsR_dataframe, start = list(mean=0.4, sd=0.2), trace = FALSE))

pdf(file = "ModelPlot.pdf")

plot(mydata.Gest, cbind(rs, theo) ~ new_r, lty = c(1, 2), col = c("black", "red"), xlim = c(0, max(new_r)), ylim = c(0,1), main = paste("Model-fitting for G Function \n Mean = ",as.numeric(coef(themodel)[1]),"\n Standard Deviation = ",as.numeric(coef(themodel)[2]), sep=''), ylab = "G(r)", xlab = "Distance Between Particles (r)", legend = NULL)
lines(new_r, predict(themodel), lty = 2, col = "blue")
legend("bottomright", c("CSR", "Swedish Pines", "Normal Probability \n Density Function"), lty = c(2, 4, 1, 2), col = c("red", "black", "blue"), bg = 'grey', border = 'black')

graphics.off() 
```

上面的代码完美运行。

现在是奇怪的部分。

当我将所有命令封装`mydata <- swedishpines`为一个函数并`mydata`成为该函数的输入时，它不再起作用。下面的代码*应该*像最后一段代码一样执行，但事实并非如此。

```
library(spatstat)

data(swedishpines)

mydata <- swedishpines

ModelFit <- function(mydata) {

mydata.Gest <- Gest(mydata)

Gvalues <- mydata.Gest$rs

count <- (which(Gvalues == 1))[1]

new_r <- seq(1/count, length(Gvalues)/count, by = 1/count)

GvsR_dataframe <- data.frame(G <- Gvalues, R <- new_r)

themodel <- suppressWarnings(nls(G ~ pnorm(R, mean, sd), data = GvsR_dataframe, start = list(mean=0.4, sd=0.2), trace = FALSE))

pdf(file = "ModelPlot.pdf")

plot(mydata.Gest, cbind(rs, theo) ~ new_r, lty = c(1, 2), col = c("black", "red"), xlim = c(0, max(new_r)), ylim = c(0,1), main = paste("Model-fitting for G Function \n Mean = ",as.numeric(coef(themodel)[1]),"\n Standard Deviation = ",as.numeric(coef(themodel)[2]), sep=''), ylab = "G(r)", xlab = "Distance Between Particles (r)", legend = NULL)
lines(new_r, predict(themodel), lty = 2, col = "blue")
legend("bottomright", c("CSR", "Swedish Pines", "Normal Probability \n Density Function"), lty = c(2, 4, 1, 2), col = c("red", "black", "blue"), bg = 'grey', border = 'black')

graphics.off()

}

ModelFit(mydata) 
```

出现以下错误：

```
Error in eval(expr, envir, enclos) : object 'new_r' not found 
```

我很困惑。我已经为此工作了很长时间，只是无法想出解决这个问题的方法。PDF 已输出，但已损坏，无法打开。我不知道为什么`new_r`“消失”，但这样做会导致所有绘图操作停止。显然`new_r`是函数的局部`ModelFit`，但它似乎也似乎是函数中某些区域的局部。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:47:25.827

你在那里做了很多隐含的东西......我建议更明确地写东西。

具体来说，`mydata.Gest$r <- new_r`然后在您的绘图公式中替换`new_r`为. 这对我行得通。不知道为什么它在函数外部而不是内部起作用，但是依赖于在 for的本地范围之外寻找是有风险的。 `r``plot(..., cbind(rs, theo) ~ r, ...)``plot``mydata.Gest``new_r`

此外，用于`=`将事物分配给数据框中的列，而不是`<-`

从干净的会话中：

```
data.frame(x<-1:10, y<- 1:10)
ls() 
```

相对

```
data.frame(x=1:10, y=1:10)
ls() 
```

# c - 字符串说明符（ %d ， %f 等...）

> ID：11784481
> 
> 赞同：2
> 
> 时间：2012-08-02T19:29:29.350
> 
> 标签：c, specifier

```
#include <stdio.h>
#define Type int

int main()
{
        Type x=3;
        printf("%d",x);
        return 0;

} 
```

代码很简单，工作正常。我的问题是，如果我更改 `#define Type int`为 `#define Type float`so ，我也必须更改`%d`为`%f`。有没有办法拥有一个通用的说明符，它适用于所有`int`, `float`, `char`,`string`等等......所以，如果我改变了，`#define Type int`那么我不必在`printf()`函数中更改格式说明符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:40:01.270

这就是我的建议：

```
#include <stdio.h>

#define TYPE int
#define TYPE_FORMAT "%d"

int main()
{
    TYPE x=3;
    printf("Value of x is: " TYPE_FORMAT "\n", x);
    return 0;
} 
```

在 C中无法`printf()`自动检测类型。在 C++ 中，您可以使用重载`<<`运算符，它*会*自动识别类型，但 C 没有这样的功能。

但是您可以`#define`使用格式和类型，并且如果您将多个字符串文字彼此相邻放置，C 编译器会将它们自动合并为单个字符串常量。

PS 而不是使用`#define`类型，你应该`typedef`像这样使用：

```
typedef int TYPE; 
```

这意味着在调试器中，你可以看到你的变量`x`是 type `TYPE`，而`#define`你会看到它是 type `int`。

在一个完美的世界里，你会像这样声明格式字符串：

```
static char const * const TYPE_FORMAT = "%d"; 
```

但我们并不生活在一个完美的世界中。如果您对 进行上述声明`TYPE_FORMAT`，编译器可能不够聪明，无法将字符串与其他字符串文字合并。（我用 GCC 尝试过，正如我所料，我收到了一条错误消息。）所以`TYPE_FORMAT`你绝对应该使用#define。

总结：使用`typedef`for 类型但使用`#define`for 格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T20:18:53.163

使用新的 C 标准 C11，您可以使用像这样的类型泛型表达式

```
#define MYFORMAT(X) \
_Generic(+(X)       \
   int: "%d",       \
   float: "%g",     \
   double: "%g",    \
   ... whatever ... \
) 
```

然后将其用作

```
printf("the value is " MYFORMAT(x), x); 
```

最新版本的 clang 编译器`_Generic`已经实现，所以没有理由不再使用它。

# math - 通过在 N 个顺时针点中形成三角形来查找配置的总数

> ID：11784482
> 
> 赞同：1
> 
> 时间：2012-08-02T19:29:29.807
> 
> 标签：math, geometry, combinations

有固定的 N 个点，编号为 1 到 N，按顺时针方向在圆周上。我们想通过选择任意三个点来创建三角形。

我们可以创建尽可能多的三角形，但没有两个三角形应该相互交叉，一个点只能共享一个三角形。那么**有多少这样的配置是可能的呢？**

例如，假设有 10 个点：

*   点 1,2,3 可以创建一个三角形，如果只有这个三角形存在，它将是一种配置。
*   只有三角形 (2,3,4) 将是其他配置。
*   三角形 (1,2,3) 和 (4,5,6) 将形成其他配置。
*   (2,4,5) 也可以是三角形
*   (2,4,5) 和 (1,3,6)**不能**是一个配置，因为两个圆圈会相互交叉。

我可以部分解决：

*   对于只有一个三角形，我们可以以 nC3 方式选择任意三个点并创建一个三角形。
*   对于两个三角形，我们可以用 nC6 方式选择任意六个点，并且可以用 3 种方式形成两个三角形

我无法解决更多数量的三角形。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:09:58.787

出于以下考虑，我也想将“根本没有三角形”视为有效配置。你可以在最后减去一个来摆脱它。

所以递归地考虑这个。给定*n*个点，你有两个选择：要么选择“根本没有三角形”并返回，要么选择三个点形成一个三角形，然后递归。如果您有三个角，它们会将您的圆圈分成三个范围。所有后续三角形都必须具有来自单个范围的角，否则它们会重叠。如果您将它们限制在其中一个范围内，它们将不会与您的第一个三角形相交。对于递归，您可以将这些范围中的每一个视为一个小圆圈（自己检查关于交叉点的陈述在那里仍然有效）。

好的，上面将生成所有可能的三角形*有序*序列。如果您不关心顺序，则必须以某种方式消除它。一种可能性是将每个计数除以*n！*其中*n*是最终生成的三角形的数量。另一种方法是固定三角形的完整顺序（即按最小角索引排序），并确保递归永远不会生成*小于*之前选择的三角形。

有了这些想法，您应该能够编写一个小脚本来枚举几个点的三角形配置。您甚至可以手动检查一些案例。也许拥有该脚本就足够了。如果没有，您可以将该序列（由于“根本没有三角形”而带有或不带有偏移）提供给[整数序列在线百科全书™</a>，并查看它们是否有适合您的公式。或者自己找一个，可能在](http://oeis.org/)[生成函数](http://en.wikipedia.org/wiki/Generating_function)的帮助下。如果一切都失败了，你可能想把它带到[Math SE](https://math.stackexchange.com/)上。

**编辑：**
除非我在实现自己的小脚本时出错，否则您要求的序列，包括“根本没有三角形”实例，是[OEIS A071879](https://oeis.org/A071879)。还有一个公式。我使用以下 python 代码生成了该序列：

```
c = [1, 1, 1]
for n in range(3, 30):
    s = 1
    for i1 in range(0, n - 2):
        for i2 in range(i1 + 1, n - 1):
            for i3 in range(i2 + 1, n):
                s += c[i2 - i1 - 1]*c[i3 - i2 - 1]*c[n - i3 - 1]
    assert len(c) == n
    c.append(s)
    print(s) 
```

# asp.net - 从子对象返回 chartdirector 图像

> ID：11784489
> 
> 赞同：0
> 
> 时间：2012-08-02T19:29:38.257
> 
> 标签：asp.net, .net, vb.net, charts

您好，我正在尝试使用`chartdirector`vb.net 创建一个图表，我真正想做的是创建一个`sub`将图像作为对象类返回的图表，然后`sub`在我的页面中附加从 to image 标记返回的内容

这是我到目前为止所做的：

```
 Private Sub createChart(ByVal sender As System.Object, ByVal e As 
    _System.EventArgs)
    Dim cd As Integer = CreateObject("ChartDirector.API")
    Dim chart As XYChart = New XYChart(700, 170)
    Dim values As Double() = {25, 18, 15, 12, 8, 30, 35}
    Dim labels As String() = {"Labor", "Licenses", "Taxes", "Legal", 
    "Insurance", "Facilities", "Production"}
    chart.setPlotArea(30, 20, 200, 200)
    chart.addBarLayer(values)
    chart.xAxis().setLabels(labels)
    HttpContext.Current.Response.ContentType = "image/png"
    Dim mina As BinaryWriter = chart.makeChart2()
    HttpContext.Current.Response.End()

End Sub 
```

这一行的代码中断

```
 Dim mina As BinaryWriter = chart.makeChart2() 
```

出现以下错误`Argument not specified for parameter format of public overridable function makechart2(format as integer ) As Byte()`

任何想法如何解决这个问题都会很棒谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:34:35.903

根据错误，`makeChart2`需要一个整数参数，而且它看起来也返回一个数组`Byte`，而不是一个`BinaryWriter`。

我不熟悉`chartdirector`，所以我不知道是否有替代方案，或者您是否必须重构您的代码，但如果是后者，您需要 new up a`BinaryWriter`和`Write`返回值从`makeChart2`它。

# c - 如何从另一个函数中释放分配的内存

> ID：11784490
> 
> 赞同：2
> 
> 时间：2012-08-02T19:29:45.080
> 
> 标签：c, function, pointers, char, free

我今天写了下面的代码来试验返回分配内存的指针。该程序运行良好，但我确实有几个问题：

1.  为`rmch`我使用的返回值分配内存`realloc`。我了解该功能以及它在大多数情况下的作用我只是不太确定我理解的将分配的内存大小调整为#c 字符`(char *)`的那一行的意义是什么，但该部分有什么作用？`ret = (char *) realloc(ret, c * sizeof(char));``realloc(ret, c * sizeof(char));``(char *)`

2.  我不释放`ret`指向任何地方的分配内存，但我释放了一个`ret`在我的`main`函数中调用的指针。分配的内存发生了什么？如果它没有被释放，我将如何去释放它？

代码

```
#include <stdio.h>
#include <stdlib.h>
char* rmch(char *str, char ch)
{
    char *ret = NULL;
    int c = 0, i;

    for(i = 0; str[i] != '\0'; i++)
    {
        if(str[i] != ch)
        {
            c++;
            ret = (char *) realloc(ret, c * sizeof(char));
            ret[c - 1] = str[i];
        }
    }
    ret[c] = '\0';
    return ret;
}

int main(void)
{
    char *foo = rmch("f o o", ' ');

    printf("%s", foo);
    free(foo);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:31:39.270

在 main 中释放 Foo 将释放您在 rmch 中重新分配的 ret。

原因是 free() 转到由 rmch 返回的指针指定的地址。

此外，由于您使用“C”标签标记了这篇文章，因此您永远不应该转换分配的返回值。`void *'s`只要在分配期间为它们提供了正确的字节大小，它们就会自动、隐式地提升为它们存储的任何内容。

顺便说一句，您永远不应该将任何分配的内存直接存储到您正在使用/将要使用的指针中，因为如果返回的指针为 NULL 并且您仍然指向旧内存，这可能会导致内存泄漏。

最好这样做：

```
temp = realloc();
if( temp == NULL)
{
     printf("realloc failed to reallocated memory!");
     return NULL;
}
ret = temp; 
```

然后您还需要检查 main 中的 NULL 返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:55:06.090

你的代码还有一个问题，当你用 valgrind 运行它时，你会得到这样的东西：

```
toc@UnixServer:~$valgrind --leak-check=full --show-reachable=yes ./realloc_pb
==17077== Memcheck, a memory error detector
==17077== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==17077== Using Valgrind-3.6.1-Debian and LibVEX; rerun with -h for copyright info
==17077== Command: ./realloc_pb
==17077== 
==17077== Invalid write of size 1
==17077==    at 0x80484BF: rmch (realloc_pb.c:19)
==17077==    by 0x80484E3: main (realloc_pb.c:25)
==17077==  Address 0x41b709b is 0 bytes after a block of size 3 alloc'd
==17077==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==17077==    by 0x804848A: rmch (realloc_pb.c:14)
==17077==    by 0x80484E3: main (realloc_pb.c:25)
==17077== 
==17077== Invalid read of size 1
==17077==    at 0x402903D: __GI_strlen (mc_replace_strmem.c:284)
==17077==    by 0x4098739: puts (ioputs.c:37)
==17077==    by 0x4050112: (below main) (libc-start.c:226)
==17077==  Address 0x41b709b is 0 bytes after a block of size 3 alloc'd
==17077==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==17077==    by 0x804848A: rmch (realloc_pb.c:14)
==17077==    by 0x80484E3: main (realloc_pb.c:25)
==17077== 
foo
==17077== 
==17077== HEAP SUMMARY:
==17077==     in use at exit: 0 bytes in 0 blocks
==17077==   total heap usage: 3 allocs, 3 frees, 6 bytes allocated
==17077== 
==17077== All heap blocks were freed -- no leaks are possible
==17077== 
==17077== For counts of detected and suppressed errors, rerun with: -v
==17077== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 11 from 6) 
```

因为您需要为空终止字符分配更多空间，所以也修改它：

```
temp = (char *) realloc(ret, (c + 1) * sizeof(char)); // It's better to use temp pointer as suggested by ardent sonata 
```

最后一件事是关于强制转换的 malloc 或 realloc 函数，它并不是真正必要的，它对编译器很有用，以防你忘记添加正确的头文件（stdlib.h），所以他可以警告你（[http://c-faq. com/malloc/mallocnocast.html](http://c-faq.com/malloc/mallocnocast.html)）。

希望这有帮助。

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T04:42:31.797

`malloc`或`calloc`将为您提到的大小分配内存。`realloc`将调整已分配内存的大小，它可以缩小或扩展现有的堆缓冲区。

例如，如果我们将现有的堆缓冲区从`n`字节扩展到`n+1`字节，则意味着我们必须调用 realloc 之类的`realloc(existing_bufPtr, n+1)`。现在操作系统必须将现有缓冲区增加一个字节，因此它将检查第一个`n+1`字节`existing_bufPtr`是否未分配给任何其他用途。如果是这样，它只会将现有缓冲区的大小扩大到`n+1`，否则它将在单独的位置分配新缓冲区，并将值从现有缓冲区移动到新缓冲区。然后它将返回新分配的缓冲区的起始地址。

所以我们必须检查返回地址是否与我们传递的地址相同，如果它不一样，我们必须释放前一个缓冲区。所以改变你的代码如下

```
if(str[i] != ch)
{
   c++;
   ret_new = (char *) realloc(ret, c * sizeof(char));
   if (NULL == ret_new)     
   {
       return NULL;
   }
   else if (ret_new != ret)
   {
       free(ret);
       ret = ret_new;
   }

   ret[c - 1] = str[i];
} 
```

使用缩小现有堆缓冲区`realloc`不会返回新地址。但扩展可能会返回新地址。

`realloc`将返回指针类型`void *`，我们必须将它类型化为我们的指针类型`char *`。

内存分配函数 ( `malloc`,`calloc`或`realloc`) 对于操作系统来说始终是一项代价高昂的操作。因此，与其调用`realloc`时间`n`，不如只使用一次分配内存`malloc(sizeof(str))`，这样性能会很好。

# sql-server-2008 - 如何获取共享点服务器 2010 的远程 BLOB 存储

> ID：11784492
> 
> 赞同：0
> 
> 时间：2012-08-02T19:29:51.237
> 
> 标签：sql-server-2008, sharepoint-2010

我被要求将远程 BLOB 存储放入 SharePoint 服务器。根据我的研究，它是 SQL Server 2008 r2 的附加功能。

一些安装过程需要完成[http://technet.microsoft.com/en-us/library/ee748631%28office.14%29.aspx](http://technet.microsoft.com/en-us/library/ee748631%28office.14%29.aspx)。

我想知道我是走在正确的道路上还是在 SharePoint 中做的事情很简单？

# jpa - 如何知道数据库何时准备就绪？

> ID：11784496
> 
> 赞同：0
> 
> 时间：2012-08-02T19:30:06.403
> 
> 标签：jpa, lifecycle, flyway

有时 createEntitymanagerFactory 可能需要一段时间，特别是在需要创建数据库时。

我正在为我的数据库使用 Flyway，并开始在迁移过程中发现问题。查看日志似乎我正在尝试在创建表之前进行迁移。例如

```
Table "XINCO_CORE_USER" not found; SQL statement:
INSERT INTO `xinco_core_user` (`id`, `username`, `userpassword`, `last_name`, `first_name`, `email`, `status_number`, `attempts`, `last_modified`) VALUES (1, 'admin', '21232f297a57a5a743894a0e4a801fc3', 'Administrator', 'Xinco', 'admin@xinco.org', 1, 0, now()) [42102-168] 
```

JPA 设置为创建表。当我在 JPA 中启用日志时，它显示上述错误发生在 JPA 完成创建数据库之前。

有没有办法监听 JPA 数据库以知道它何时准备就绪？我只找到实体本身的侦听器，但没有找到 PersistenceManager 生命周期的侦听器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:33:46.973

我相信最好的解决方案是让 Flyway 也创建表，而不是与 JPA 共享工作。

看看[这个问题及其选择的解决方案](https://stackoverflow.com/questions/11071821/cdi-extension-for-flyway)。在那里你可以看到如何干净地将 Flyway 与 Hibernate 生命周期联系起来。

话虽如此，我可能还没有意识到更好的方法。

# h2 - h2.db 文件不断增长

> ID：11784497
> 
> 赞同：1
> 
> 时间：2012-08-02T19:30:11.317
> 
> 标签：h2

我们正在使用嵌入在我们的应用程序中的 H2 数据库（持久）。

即使我们删除了这些表，h2.db 文件仍在不断增长。

我们尝试禁用事务隔离（LOCK_MODE=0），禁用查询日志（TRACE_LEVE_FILE=0），禁用撤消日志，但没有任何帮助。

[压缩](http://www.h2database.com/html/features.html#compacting)是唯一的选择吗？压缩将需要重新启动我们无法执行的数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T09:59:15.303

使用`TRACE_LEVE_FILE=0`只会影响文件`{databaseName}.trace.db`，我建议不要使用禁用跟踪。该文件`{databaseName}.trace.db`包含人类可读的错误消息和警告，通常应该为空。如果它不为空，则您的应用程序中可能存在错误。

数据库文件增长的最常见原因是未提交的事务。你提交了所有交易吗？使用最新版本的 H2 (1.3.168)，将消息“无法截断事务日志”写入`{databaseName}.trace.db`文件。但这要求你不要使用`TRACE_LEVE_FILE=0`.

请注意，文件中的空白空间被重复使用，但在数据库打开时文件不会缩小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T12:31:04.223

这个问题得到了解决。问题是我们使用存储在[servlet 上下文](http://www.h2database.com/html/tutorial.html#web_applications)中的连接。此连接从未关闭。我们更改了代码以自己管理连接并在删除表（并重新打开）后关闭连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-01T11:09:59.953

我能够缩小 H2 数据库的最有效和最简单的方法是执行以下语句**SHUTDOWN COMPACT**，然后执行**SHUTDOWN DEFRAG**。它清理任何删除记录后留下的未使用空间。

```
 DatasourceConfig datasourceConfig = springContext.getBean(DatasourceConfig.class);
        System.out.println("H2 DB shutdown hook");
        Connection con = null;
        try {
            con = DriverManager.getConnection(datasourceConfig.getDatasourceUrl(), datasourceConfig.getUsername(), "");
            con.createStatement().execute("SHUTDOWN DEFRAG");
        } catch (SQLException var13) {
            System.out.println("Could not shut down embedded database" + var13);
        } finally {
            if(con != null) {
                try {
                    con.close();
                } catch (Throwable var12) {
                    System.out.println("Could not close JDBC Connection on shutdown" + var12);
                }
            }
        } 
```

您可以找到有关 SHUTDOWN 语句的更多详细信息。[https://www.h2database.com/html/commands.html#shutdown](https://www.h2database.com/html/commands.html#shutdown)

# ios - 如何修复由于未捕获的异常'NSRangeException'导致的tableview崩溃，原因：'*** - [__NSArrayM objectAtIndex：]：索引1超出范围[0 .. 0]'

> ID：11784500
> 
> 赞同：0
> 
> 时间：2012-08-02T19:30:20.067
> 
> 标签：ios, xcode4, tableview

我正在尝试按照书中的示例代码创建一个表格视图。但它总是崩溃。调试器向我显示信息：

```
2012-08-03 02:51:09.854 TableView[652:c07] *** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0]'
*** First throw call stack:
(0x1794022 0x1194cd6 0x1780d88 0xfdd1b7 0x3b24 0x2e62 0xb2c54 0xb33ce 0x9ecbd 0xad6f1 0x56d21 0x1795e42 0x2065679 0x206f579 0x1ff44f7 0x1ff63f6 0x2083160 0x16e84 0x17767 0x26183 0x26c38 0x1a634 0x167eef5 0x1768195 0x16ccff2 0x16cb8da 0x16cad84 0x16cac9b 0x16c65 0x18626 0x1eb2 0x1e25)
terminate called throwing an exception(lldb) 
```

我不知道这是什么意思。再次抱歉长代码....如有必要，我可以发送整个代码。

网上有人说问题是plist引起的，http://p2p.wrox.com/271591-post2.html 但我无法在Xcode 4.4中修改plist。Xcode在此代码处显示绿色指针

```
- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = [[object valueForKey:@"timeStamp"] description];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:12:56.823

您的表视图数据源方法（`numberOfSectionsInTableView:`和`tableView:numberOfRowsInSection:`）`tableView:cellForRowAtIndexPath:`用作`self.years`数据源。

另一方面，您有一个 fetched results 控制器，它在向您的核心数据存储添加或删除新的“事件”实体时`insertRowsAtIndexPaths:...`调用。`deleteRowsAtIndexPaths:...`

所以你在这里混合了两种不适合的东西。发生崩溃是因为您添加了表视图行，但数据源没有相应更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:01:47.500

这意味着您正在尝试访问具有 0 个元素的数组的第一个元素。我的猜测是错误出现在您调用的行之一上`objectAtIndex`。

请记住，数组索引从 0 开始！！！

# jquery - TinyMCE 是否有拖放/粘贴图像插入（上传）插件或类似插件？

> ID：11784505
> 
> 赞同：5
> 
> 时间：2012-08-02T19:30:44.697
> 
> 标签：jquery, html, tinymce

在 Gmail 中，只需从本地文件浏览器（不是 url）拖放图像或将复制的图像粘贴到其中，即可在新消息/回复窗口中上传内嵌图像。

有没有一种简单的方法可以将此功能添加到 TinyMCE 编辑器？如果没有，关于如何以最好和/或最简单的方式做到这一点的任何想法？

更多信息/需求：

*   定义的“拖放区”不可用，因为拖放/粘贴的图像必须准确地出现在用户在 TinyMCE 窗口中拖放/粘贴的位置（即在两段文本之间）。
*   在上传时或上传后处理/调整图像大小，即最大值。500kb 会更好。
*   出于与上述相同的原因 - 并且出于易于使用的原因 - 不应向用户显示任何对话框，就像 Gmail 刚开始上传图片一样，不提出任何问题。
*   任何拖放/粘贴到 TinyMCE 的图像都将使用 Amazon Simple Storage Service (S3) 进行存储。来自 Tiny 的文本将存储在我们的数据库中。将粘贴的图像存储在数据库中而不是 Amazon S3 中可能是一种选择（将 Heroku 与 PostgreSQL 一起使用）。
*   文本和图像 - 以正确的顺序/上下文 - 应在稍后的计时器再次呈现给用户，因此在拖放/粘贴图像时，或保存 TinyMCE 表单时，必须使用占位符或类似的图像信息被写入 TinyMCE 以便我们知道在未来某个时间需要检索时要在文本中显示哪个图像和位置。
*   网站使用的是 Rails 3.1.3，即将升级到 3.2。
*   只有 HTML5 很好，即 HTML4 兼容性并不重要。

非常感谢！:-)

PS。我用谷歌搜索+在 SO 上查看了类似的问题，但没有找到正确的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:48:35.237

我已经使用了很多 plupload，发现它非常有用，适用于 html4，这是当浏览器没有 flash、silverlight 或 html5 时的要求。你看过了吗？我记得在Amazon 和 S3 上看到过[这个。](http://www.plupload.com/punbb/viewtopic.php?id=133)祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T13:30:27.520

您可以尝试支持拖放的**[jQuery File Upload 。](http://blueimp.github.com/jQuery-File-Upload/)**

你也可以通过[**25+ jQuery Drag and Drop Plugins**](http://www.tripwiremagazine.com/2012/04/jquery-drag-drop-plugins.html) （或改编其中之一） 。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T13:28:48.157

好吧，这有点奇怪。甚至编辑器也使用了使用 base64 进行编码的技巧：

```
<img alt="" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQ.. 
```

我想这没问题，但是查看帖子时 4-5 张合理大小的照片会导致服务器负载跳到疯狂的水平.. http 占用 100% 等.. 如果超过一两个人在查看帖子，它会让我们关闭. 有趣的是，它们在编辑器中显示得很好——当你保存并发布时，痛苦就来了。不太清楚为什么这个 apache 如此难以显示帖子（在编辑器中看起来不错）

# ember.js - 按名称定位视图类

> ID：11784508
> 
> 赞同：0
> 
> 时间：2012-08-02T19:30:55.163
> 
> 标签：ember.js

我知道`Ember.View.views[someId]`要找到视图的“实例”。是否有类似的方法通过字符串值查找视图“类”？我有一种情况，列表中项目的值决定了哪个视图类被实例化并填充到容器视图中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T08:59:37.387

您是否真的需要切换视图类，因为渲染肯定会基于项目的状态？

我宁愿使*视图的模板*有条件，如下所示：

```
App.ItemView = Ember.View.extend({

  itemBinding: 'controller.content',

  templateName: function () {
    var kind = this.get('item.kind');
    return '%@_item_view'.fmt(kind);
  }.property('item.kind')
}); 
```

*（在这里，为了更清楚，我在视图中对项目进行了别名）*

然后，您需要与`kind`s 一样多的模板。例如：如果你有`kind`' 值 in `[valid, invalid]`，你将有两个模板：`valid_item_view.handlebars`& `invalid_item_view.handlebars`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:59:56.933

```
App = Ember.Application.create();

App.TestView = Ember.View.extend({ ... });

App["TestView"].create(); 
```

​</p>

# powershell - 如何使用 Powershell 获取本地 NT 服务 SID？

> ID：11784516
> 
> 赞同：2
> 
> 时间：2012-08-02T19:31:15.120
> 
> 标签：powershell, windows-7

我在 SO 上找到了这个片段：

[从登录 ID 获取用户 SID（Windows XP 及以上）](https://stackoverflow.com/questions/2727393/get-user-sid-from-logon-id-windows-xp-and-up)

```
Function GetSIDfromAcctName()
{
$myacct = Get-WmiObject Win32_UserAccount -filter "Name = '$env:USERNAME " 
write-host Name: $myacct.name
Write-Host SID : $myacct.sid
} 
```

但它并没有显示一切。

例如，我只想要“nt service\dhcp”的 sid。我怎么能得到那个？当我手动运行我的powershell时

获取 WmiObject Win32_UserAccont

我得到了所有用户，但只有三个“普通”用户。没有“特殊” nt 服务用户。

感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T06:50:51.413

要获得内置帐户，您需要另一个 WMI 类：`Win32_Account`.

```
gwmi -class win32_account -Filter 'name="LOCAL SERVICE"' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:17:55.960

如果您想知道启动服务的帐户名称，您可以使用：

```
gwmi Win32_service -Filter "name='dhcp'" | % {return $_.startname} 
```

结果是`"NT Authority\LocalService"`一个众所周知的 SID，如[默认 Windows NT 安装的 SID 值](http://support.microsoft.com/kb/163846/en)中所述，您将[在 Windows 操作系统的知名安全标识符中](http://support.microsoft.com/kb/243330/en)找到更多 SID 。

* * *

已编辑：正如您在以下屏幕截图中看到的那样，是的，dhcp 客户端正在以`"NT Authority\LocalService"`

![在此处输入图像描述](../Images/fd67e24f65aa6e1e2deabfa712d9fcc4.png)

# html - Flex 3 RichTextEditor HTML 使用不推荐使用的标签

> ID：11784520
> 
> 赞同：1
> 
> 时间：2012-08-02T19:31:28.350
> 
> 标签：html, apache-flex, flex3, rich-text-editor

我正在开发一个项目，该项目有一个用 Flex 3 编写的管理 Web 应用程序，以及一个使用 PHP 构建的公共网站。管理应用程序有一个部分，管理员可以在其中编写文档以显示在公共网站上。该应用程序使用 RichTextEditor 组件让管理员执行此操作。

当 RichTextEditor 生成的 html 文本显示在网站上时，问题就出现了。它以正确的颜色、对齐方式等正确显示文本，但文本的大小不正确。它以相同的大小显示所有文本，而且很大。

作为 Flex 的新手，我查看了它生成的 HTML 类型。它广泛使用标签，我发现它已被弃用/不可靠/每个人都建议不要使用它。

所以我的问题是：有谁知道我可以以某种方式告诉 flex 在 span 或 div 上使用样式属性，而不是在它生成的 HTML 中使用字体标签？

如果没有，您是否知道某种现有工具可以将字体标签转换为更好的格式？我还没有找到解决这两个问题的方法，但我会继续寻找。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T03:11:07.247

发现以下，可能值得一试。

[Flex mx:RichTextEditor 到 HTML](http://cesaric.com/?p=10)

# iphone - 固定位置 div 下方的链接可在 iPhone 上点击

> ID：11784524
> 
> 赞同：1
> 
> 时间：2012-08-02T19:31:40.553
> 
> 标签：iphone, html, css, positioning, z-index

在我们的移动网站上，我有一个固定位置的页脚和一个在其下方滚动的提要。我观察到的问题是提要上的链接可以从页脚区域单击，因为这两个 div 重叠。

页脚：

```
.footer {
position: fixed;
bottom: 0;
right: 0;
left: 0;
z-index: 1030;
height:45px;
.background-image-gradient (@topFooterColor, @bottomFooterColor);
box-shadow: 1px 0px 1px 1px rgba(0, 0, 0, 0.45);
background-repeat: repeat-x;
text-align:center;
border-top: 1px solid @topFooterBorder;
} 
```

提要包含在一个名为 status_updates 的 div 中：

```
.status_updates {
border-left:0px;
margin-top:0px;
margin-bottom:10px;
} 
```

在状态更新 div 中，有指向站点上其他位置的链接（人员资料、状态更新等）。我观察到的问题是这些链接仍然可以通过页脚（在屏幕底部 45 像素处）单击。

我尝试过使用 .status_updates 的 z-index，甚至将其设置为 z-index:-1，但这仍然不起作用。我的理解是页脚的 z-index 被忽略，因为它具有固定的定位。

我知道如果我将 .status_updates div 设为绝对值，顶部：40px（我的固定位置页眉的高度）和底部：45px（我的固定位置页脚的高度），并且我的页脚绝对值低于 .status_udpates div将解决问题，因为 div 不再重叠。但是，此解决方案将需要我重组网站上的许多其他页面。

有没有一种解决方案可以让 .footer div 保持固定定位，而 .status_updates div 保持相对定位，这样 .status_udpates 中包含的链接不能通过页脚点击？

这是一张可能有助于可视化我的问题的图片： ![可滚动提要上的链接可通过页脚点击](../Images/502abd5cf70db62824c97f66467eb413.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:02:39.783

正如 Torsten 上面提到的，这是一个已知的浏览器问题。我有类似的情况并解决如下。

如果您在滚动内容中添加一个边距底部，即页脚的高度（例如，页脚的高度是 45px，`margin-bottom: 45px`在滚动内容上），那么内容*看起来*会滚动到页脚后面，但实际上只是滚动*到*页脚。这样，由于链接在技术上永远不会位于页脚*后面*，因此它永远不会出现点击问题。

当然，这仅在您的页脚不是透明/半透明或以其他方式设计以使您可以“看穿”下面的内容时才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:01:04.857

这是一个已知的错误。如果滚动以编程方式发生，则可以单击固定元素。

Remy Sharp 有一篇关于这个问题的[好文章。](http://remysharp.com/2012/05/24/issues-with-position-fixed-scrolling-on-ios/)

# java - XML解析成对象列表

> ID：11784525
> 
> 赞同：0
> 
> 时间：2012-08-02T19:31:45.267
> 
> 标签：java, xml, parsing, saxparser

我想使用“SAXParser”将任何 XML 文件解析为“XMLNode”类的对象列表

XMLNode 类

```
public class XMLNode {

    private String nodeName;
    private String nodeValue;
    private List<XMLNodeAttribute> attributes;
    private boolean isParentNode;
    private List<XMLNode> childNodes;

    //.... getters and setters ....
} 
```

XMLNodeAttribute 类

```
public class XMLNodeAttribute {

    private String name;
    private String value;

    //.... getters and setters ....

} 
```

请帮助我编写可以将输入作为 XML 文件并输出列表的解析器类。

先感谢您。

我可以写一些代码..

```
public class XmlProcesser extends DefaultHandler {

    XMLResponse xmlResponse = null;
    List<XMLNode> resplist  = new ArrayList();
    List<XMLNode> temp  = new ArrayList();
    boolean endtag = false;

    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {

         String elementName = localName;
            if ("".equals(elementName)) {
                elementName = qName;
            }
        System.out.println(" Start Ele - " + elementName  );

        //Each attribute

        if (elementName!=null) {
            if (attributes!=null) {
                    for (int pos=0; pos<attributes.getLength(); pos++) {
                        String name = attributes.getLocalName(pos)==null || attributes.getLocalName(pos).trim().length()==0 ? attributes.getQName(pos) : attributes.getLocalName(pos);
                        String value= attributes.getValue(pos);
                        System.out.println(" name - " + name  + "   value - "  + value  );
                    }
                }
        }

    }

    @Override
    public void characters(char ch[], int start, int length) throws SAXException {

        String s = new String(ch, start, length);
        System.out.println(" value - " + s   );

        endtag = false;
    }

    @Override
    public void endElement(String uri, String localName,
            String qName) throws SAXException {
        endtag = true;

        String elementName = localName;
            if ("".equals(elementName)) {
                elementName = qName;
            }
        System.out.println(" End Ele - " + elementName  );

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:42:08.353

您可以使用 JAXB`UnmarshallerHandler`来实现这个用例：

```
 JAXBContext jc = JAXBContext.newInstance(XmlNode.clas);
    Unmarshaller unmarshaller = jc.createUnmarshaller();
    UnmarshallerHandler handler = unmarshaller.getUnmarshallerHandler();

    SAXParserFactory spf = SAXParserFactory.newInstance();
    SAXParser sp = spf.newSAXParser();
    XMLReader xr = sp.getXMLReader();
    xr.setContentHandler(handler);
    xr.parse(xml);
    XmlNode xmlNode = (XmlNode) handler.getResult(); 
```

**完整示例**

*   [http://blog.bdoughan.com/2011/05/jaxb-and-dtd.html](http://blog.bdoughan.com/2011/05/jaxb-and-dtd.html)

# oracle - Grails 2.0 数据库连接超时，SockectException

> ID：11784526
> 
> 赞同：1
> 
> 时间：2012-08-02T19:32:02.937
> 
> 标签：oracle, hibernate, grails

环境 - Grails 2.0.4，Oracle 11G

在几个小时不活动后，从数据库读取会导致**java.net.SocketException: Connection timed out**。根据其他人关于解决此问题的建议，我使用属性更新数据源以保持数据库连接处于活动状态。这是我看过的几个解决方案-

[一种解决方案](http://java.dzone.com/news/database-connection-pooling)
[另一种解决方案](https://stackoverflow.com/questions/2740987/mysql-connection-timeout-issue-grails-application-on-tomcat-using-hibernate-an)

看来解决方案涉及在数据源上设置适当的值。就我而言，涉及 2 个数据源。我正在尝试进行会话保持活动，以避免连接超时。这似乎是通过设置 validationQuery 属性和 testXXX 属性来完成的。当需要测试时，将运行验证查询。我认为下面的配置会给我想要的结果，但我仍然看到超时。我启动了调试

```
debug 'org.hibernate'
debug 'jdbc.sqlonly' 
```

我本来希望在某个时间间隔看到validationQuery 运行。根据指定的“6000”毫秒值，我希望每 6 秒看到一次验证查询。这是数据源规范。我尝试了这两种方法。在“properties”闭包中指定它们并将它们指定在与“pooled”相同的级别。

```
dataSource_secondary {
    logSql = true
    pooled = true
    properties {
        maxActive = 5
        maxIdle = 5
        minIdle = 3
        initialSize = 5
        minEvictableIdleTimeMillis = 6000
        timeBetweenEvictionRunsMillis = 6000
        maxWait = 1000
        testOnBorrow = true
        testWhileIdle = true
        testOnReturn = false
        validationQuery = "select 1 from dual"
    }
} 
```

I also ran this in the debugger and added some code to BootStrap.groovy to get the context.

```
def ctx = servletContext.getAttribute(ApplicationAttributes.APPLICATION_CONTEXT)
println 'Added a println allowing me to set a break point and inspect the context.' 
```

"ctx" did have the expected values as specified in dataSource_secondary. Any ideas why I'm still getting the socket exception?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T13:36:42.950

Figured out the problem. Brain dead developer. I neglected to check-in the fix and it didn't make it into the war created by our build environment. Once I checked in the Datasource.groovy, all was groovy and I didn't see the timeout exception this morning. The above solution works.

I'm still confused why I didn't see debug message when the validationQuery ran. Does anyone know the proper log4j entry to see the validationQuery in the logs?

# .net - 没有 WebAPI 的 MVC4 页面

> ID：11784547
> 
> 赞同：0
> 
> 时间：2012-08-02T19:33:36.103
> 
> 标签：.net, razor, asp.net-mvc-4, asp.net-web-api

有谁知道在不包含所有 WebAPI 垃圾的情况下启动 ASP.NET MVC 4 项目的方法？我想用 Razor 做一些实验，你知道制作一个简单的页面，而不必让我的源代码控制/服务器膨胀，而没有一堆我不关心的废话。我找了一些模板等，但没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:38:47.467

我会先使用现有的模板来创建一个项目。然后我会删除我不需要的组件，并[创建一个新模板](http://msdn.microsoft.com/en-us/library/xkh1wxd8.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T03:40:13.483

您只需创建一个 ASP.NET MVC 4 的空项目，然后：

1.  使用 nuget 删除包：“Microsoft ASP.NET Web API (RC)”。
2.  移除 Web API 的默认路由。

    ```
     routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        ); 
    ```

3.  再次编译项目并删除一些对 web api 的使用错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-05T01:33:58.463

真正空的[ASPNetMVCTemplate](http://haacked.com/archive/2012/01/10/a-really-empty-asp-net-mvc-3-project-template.aspx/)也不错，只需将其设为MVC4 而不是MVC3。

# cuda - Cuda 并行执行

> ID：11784549
> 
> 赞同：0
> 
> 时间：2012-08-02T19:33:42.407
> 
> 标签：cuda

有人可以启发我：块在CUDA中并行/并发执行吗？换句话说，如果两个不同的块尝试写入同一个全局地址，即 globalPtr[12]，是否存在丢失更新问题？

（我在问这个问题，因为我已经读到 CUDA 中的并行执行单元是 warp=32 线程。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T03:41:56.307

是的，如果 CUDA 设备有多个 warp 调度程序，您可以在多个块之间并行执行。

具有计算能力 2.1 的 CUDA 设备具有两个 warp 调度程序，因此来自两个不同 warp（来自同一块或来自不同块，无关紧要）的指令可以同时执行。

具有计算能力 3.0 的 CUDA 设备具有四个 warp 调度程序，并且可以为每个准备执行的 warp 发出两条独立的指令。

请注意，即使 warp 之间没有并发执行，调度程序也可以使用多个块，这样如果一个 warp 被阻塞以等待内存操作完成，调度程序可以切换到另一个 warp 执行，这样核心就不会闲着。

可以驻留在准备好调度程序切换到的核心上的扭曲数量因计算能力而异。

如果您只定义与调度程序一样多的块，您将无法充分发挥设备的计算潜力。如果您的代码具有大量内存 I/O，则尤其如此——“隐藏”内存延迟的一种方法是确保有足够的块/warp 可用，以便调度程序始终有一个准备好的 warp 切换到何时其中一个经线空闲等待内存 I/O。

每当您有多个 warp 读取和写入相同的内存地址时，您应该使用原子 I/O 或锁定，无论您当前的硬件是否可以同时执行多个 warp。写入后写入工件（“丢失的更新”）甚至可以在任务切换的单核执行中显现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:42:18.500

是的，多个块并行执行，因此如果多个线程需要访问同一个地址，则对全局内存的访问需要是原子的。无论是同一块中的两个线程还是不同块中的两个线程，这都适用。

# e-commerce - 仅在 Magento 中运送到美国

> ID：11784555
> 
> 赞同：1
> 
> 时间：2012-08-02T19:34:08.160
> 
> 标签：e-commerce, magento

我有一个客户只想向美国境内的客户销售/运送他们的商品。如何在 Magneto 社区版上限制仅在美国境内发货？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:38:29.477

`System > Configuration > General > "Allow Countries"`

![Magento 允许的国家](../Images/8c511e50eafeb7dce067abbf8aa7ab6e.png)

# php - Wordpress Contact Form 7 与我的 jQuery 代码冲突

> ID：11784556
> 
> 赞同：0
> 
> 时间：2012-08-02T19:34:12.360
> 
> 标签：php, wordpress, contact-form-7

我已经在我的 Wordpress 网站上安装了这个插件，但是它立即与我的自定义 javascript 冲突。

我知道您在插件中禁用 AJAX 的解决方法，并且我也知道您在特定页面上加载 Contact form 7 JS 的解决方法。但是，这两种方法都不可行。我需要插件和我自己的 JS 一起工作。

我在控制台中遇到的错误（一旦激活插件并且我自己的 JS 停止工作）是：

```
Uncaught TypeError: Object [object Object] has no method 'isotope' main.js:17 
```

第 17 行：

```
 var $container = $('.gallery');
$container.isotope({
    resizable: false, // disable normal resizing

    filter: '*',
    animationOptions: {
        duration: 750,
        easing: 'linear',
        queue: false,
    }
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:19:48.563

这可能是一个 DOM 计时问题，您是否尝试过像这样将这段代码包装在一个 doc-ready 块中？

```
$(function() {
    var $container = $('.gallery');
    $container.isotope({
        resizable: false, // disable normal resizing

        filter: '*',
        animationOptions: {
            duration: 750,
            easing: 'linear',
            queue: false,
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T11:04:27.233

固定的。这绝对是一个 jQuery 冲突。

我打开了我的自定义 JS 文件并将准备好的文档从 $ 更改为 jQuery。然后，我将文件中的每个 $ 实例更改为 jQuery，现在一切正常。

# c# - if 子句使用？

> ID：11784559
> 
> 赞同：1
> 
> 时间：2012-08-02T19:34:23.307
> 
> 标签：c#, if-statement

```
if (statement)
     base.Database.AddInParameter(command, "ColumnX", DbType.String, "StackOverflow");
 else
     base.Database.AddInParameter(command, "ColumnX", DbType.String, DBNull.Value); 
```

我想通过使用在一行中执行此语句

```
? "true" : "false" 
```

例如：

```
if(statement) ? base.Database.AddInParameter(command, "ColumnX", DbType.String, "StackOverflow") : base.Database.AddInParameter(command, "ColumnX", DbType.String, DBNull.Value); 
```

但是这是错误的。Visual Studio 说“：”的意外标记

任何的想法？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:36:59.280

为什么不这样做（我将它包裹在很多行中）？

```
 base.Database.AddInParameter(
    command, 
    "ColumnX", 
    DbType.String, 
    statement ? "StackOverflow" : (Object)DBNull.Value); 
```

您的尝试不是有效的 C#。如果您*真的*想按照自己的方式进行操作并`if...else`在一条线上使用它，则需要像：

```
if(statement) base.Database.AddInParameter(command, "ColumnX", DbType.String, "StackOverflow"); else base.Database.AddInParameter(command, "ColumnX", DbType.String, DBNull.Value); 
```

但这很难阅读。

即使很短：`if (true) DoOne(); else DoTwo();`也不是那么容易。

```
if (true) 
    DoOne(); 
else 
    DoTwo(); 
```

更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T19:38:22.183

首先，[条件运算符](http://msdn.microsoft.com/en-us/library/ty67wk28.aspx)不需要`if`before 。`(statement)`

其次，您不能使用它，因为条件的双方都需要是相同的类型或一个可以隐式转换为另一个的类型 -`string`并且`DBNull.Value`不是这样的类型。

如果您将or转换为，则*可以*使用它：`string``DBNull.Value``object`

```
base.Database.AddInParameter(
                             command, 
                             "ColumnX", 
                             DbType.String, 
                             statement ? "StackOverflow" : (object)DBNull.Value); 
```

但是，如果我必须在一行中阅读此内容，我会发现它*的*可读性不如您发布的原始版本 - 将这种逻辑放在一行中没有任何价值，特别是如果它降低了可读性并使代码不易阅读理解。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-02T19:40:05.933

[三元运算符](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.100%29.aspx)仅适用于赋值。

你可以做的是：

```
var value = statement ? (object)"StackOverflow" : DBNull.Value;
base.Database.AddInParameter(command, "Column X", DbType.String, value); 
```

当然，你也可以将它组合成一个语句（但如果你格式化它实际上是更多的行）：

```
base.Database.AddInParameter(
    command,
    "Column X",
    DbType.String,
    statement ? (object)"StackOverflow" : DBNull.Value); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-02T19:38:37.057

把开头的 if 去掉，这样就可以读取了。

```
statement ? base.Database.AddInParameter(command, "ColumnX", DbType.String,"StackOverflow") : base.Database.AddInParameter(command,"ColumnX", DbType.String, DBNull.Value); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-02T19:39:07.220

如果您只是为 DBNull 切换字符串，则应该按照以下方式替换该 var：

```
var theReplacement = (statement ? (object)"StackOverflow" : DBNull.Value);

base.Database.AddInParameter(command, "ColumnX", DbType.String, theReplacement); 
```

# expressionengine - 表达式引擎 - 如何根据自定义字段内容显示内容？

> ID：11784568
> 
> 赞同：0
> 
> 时间：2012-08-02T19:35:04.277
> 
> 标签：expressionengine

我正在开发一个表达式引擎站点，我正在尝试从两个不同的渠道获取内容，以便根据条件在同一部分显示。

主页有一个链接到各种内容的滑块。我为此创建了一个包含四个字段的频道。文章部分有独立的内容，但有时需要在主页的滑块中突出显示。

为了满足这一需求，我添加了一个带有 NO/YES 选项的“在滑块中显示”字段，后跟包含类似于滑块内容但具有唯一名称的内容的字段。

这是挑战：如何编写条件以仅显示“在滑块中显示”字段设置为“是”的条目。以下代码有一个缺陷：它仍然显示“在滑块中显示”设置为 NO 的条目中的部分内容，因为它满足 if:else 选项的条件。

这是代码：

```
<div id="slider">
{exp:channel:entries channel="slider|garden_advice" disable="categories|category_fields|member_data|pagination"}
{if display_in_slider == "YES"}
<div class="slider-content">    
<div class="slider-image">
<img src="{slider_photo_ga}" alt="{title}" >
</div>
<h3>{title}</h3>
<span class="sub-title">{sub_title_ga}</span>
<p>{slider_text_ga}</p>
<div class="link-box">
<a href="{site_url}garden-advice/article/{url_title}">{link_text_ga}</a>
</div>
</div><!-- end .slider-content -->
{if:else}
<div class="slider-content">    
<div class="slider-image">
<img src="{slider_photo}" alt="{title}" >
</div>
<h3>{title}</h3>
<span class="sub-title">{sub_title}</span>
<p>{slider_text}</p>

{if entry_id != 5014}
<div class="link-box">
{link_text}
</div>
{if:else}
{link_text}
{/if}
</div><!-- end .slider-content -->
{/if}
{/exp:channel:entries}
</div><!-- end .slider --> 
```

我的问题是：如何修改条件，以便在第一个 if 语句中只考虑 garden_advice 通道，而在第二个语句中只考虑滑块通道？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T21:14:32.997

只需`channel_short_name`在条件中包含：

```
{if channel_short_name == "garden_advice" && display_in_slider == "YES"} 
```

等等。

您也可以尝试添加`search:display_in_slider="YES"`到您的频道条目标签...我不确定这将如何与`channel`参数中的两个频道一起使用（EE 可能会看到该字段不在“滑块”频道中并且只是忽略该参数，或者它可能会完全忽略该频道的所有条目），但值得一试。

# reportviewer - ReportViewer VS 2010：仅显示 2 行

> ID：11784569
> 
> 赞同：1
> 
> 时间：2012-08-02T19:35:06.300
> 
> 标签：reportviewer, report-viewer2010

我在 VS 2010 中使用 ReportViewer。

我有一个显示以下数据的表：

11(2009)
13(2009)
16(2010)
21(2009)
3(2010)
4(2009)
6(2009)
8(2009)
9(2010)

但是它应该显示以下内容：

11 (2009) 16 (2010) 3 (2010) 6 (2009) 9 (2010)
13 (2009) 21 (2009) 4 (2009) 8 (2009)

我该怎么做呢？请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:50:21.110

试试这个可能有效

```
 System.Environment.NewLine 
```

替换 System.Environment.NewLine 而不是 \n

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:54:31.483

这可能与您设置报告以显示实际信息的方式有关。你能提供更多关于你的报告格式的信息吗？

# java - 从哈希图中打印出坐标

> ID：11784570
> 
> 赞同：0
> 
> 时间：2012-08-02T19:35:06.183
> 
> 标签：java, hashmap, coordinates, println

嗨，我有工作代码，但我想打印出坐标。有一个包含坐标和字符串的哈希图。有一个坐标类可以让我把坐标放进去，但是当我尝试打印出来时，它会变得很困惑，我显然没有做正确的事情。感谢您的关注

```
public class XYTest {
static class Coords {
    int x;
    int y;

    public boolean equals(Object o) {
        Coords c = (Coords) o;
        return c.x == x && c.y == y;
    }

    public Coords(int x, int y) {
        super();
        this.x = x;
        this.y = y;
    }

    public int hashCode() {
        return new Integer(x + "0" + y);
    }
}

public static void main(String args[]) {

    HashMap<Coords, String> map = new HashMap<Coords, String>();

    map.put(new Coords(65, 72), "Dan");

    map.put(new Coords(68, 78), "Amn");
    map.put(new Coords(675, 89), "Ann");

    System.out.println(map.size());
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:37:00.083

你必须`toString()`在你的 Coords 类中覆盖。

```
static class Coords {
    int x;
    int y;

    public boolean equals(Object o) {
        Coords c = (Coords) o;
        return c.x == x && c.y == y;
    }

    public Coords(int x, int y) {
        super();
        this.x = x;
        this.y = y;
    }

    public int hashCode() {
        return new Integer(x + "0" + y);
    }

    public String toString()
    {
        return x + ";" + y;
    }
} 
```

让你感到困惑的是这样的：

```
XYTest.Coords@3e25a5 
```

这是什么？这是原始`toString()`方法的结果。这是它的作用：

```
return getClass().getName() + '@' + Integer.toHexString(hashCode()); 
```

所以，用你自己的代码覆盖它会摆脱令人困惑的输出:)

* * *

请注意，您的哈希冲突很大。一个更好的 hashCode() 实现将是：

```
public int hashCode()
{
    return (x << 16) ^ y;
} 
```

为了证明您的错误哈希码：一些冲突：

*   (0,101) 和 (1,1)
*   (44,120) 和 (44012,0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:44:23.970

正如 Martijn 所说，覆盖 toString()

```
class Coords {
....

public String toString(){
   return this.x + "-" + this.y;
 }
.... 
```

}

...和

```
 public static void main(String []args){ 
```

……

```
 map.put(new Coords(65, 72).toString(), "Dan"); 
```

……

```
 } 
```

# ruby-on-rails - 将助手添加到 ActiveAdmin 仪表板

> ID：11784571
> 
> 赞同：1
> 
> 时间：2012-08-02T19:35:08.363
> 
> 标签：ruby-on-rails, activeadmin, dashboard

有谁知道如何将助手添加到仪表板？我已向仪表板添加了一个过滤器，但需要从 URL 获取过滤器参数。我不想重复代码来去除参数的 url，而是将它发送到一个方法来让它解析 URL，然后将这些变量发送回每个部分。

当前代码

```
section do
  div :id =>"dashboardText" do
    range=params()
    fromDate=range[:fromDate].to_i
    toDate=range[:toDate].to_i
    fromDate = (fromDate>0) ? fromDate: nil || 30
    toDate = (toDate==0) ? -1: toDate || -1
    table do 
```

我已经尝试将该方法放在应用程序帮助程序中并将其包含在内，以及应用程序控制器本身中。有人对仪表板有任何解决方法吗？

# objective-c - 尝试从 UITableView 中删除单元格时出错

> ID：11784579
> 
> 赞同：0
> 
> 时间：2012-08-02T19:36:08.320
> 
> 标签：objective-c, ios

当我尝试从我的单元格中删除一个单元格时，`UITableView`它给了我这个错误：

`*** Assertion failure in -[UITableView _endCellAnimationsWithContext:], /SourceCache/UIKit_Sim/UIKit-1912.3/UITableView.m:1046 2012-08-02 16:35:13.941 jsontest2[1551:f803] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Invalid update: invalid number of rows in section 0\. The number of rows contained in an existing section after the update (4) must be equal to the number of rows contained in that section before the update (4), plus or minus the number of rows inserted or deleted from that section (0 inserted, 1 deleted) and plus or minus the number of rows moved into or out of that section (0 moved in, 0 moved out).' *** First throw call stack: (0x13e0052 0x1571d0a 0x1388a78 0x9c02db 0xbb518 0xc6211 0xc623f 0x2ce9 0xd289d 0x226d70 0x13e1ec9 0x3a5c2 0x3a55a 0xdfb76 0xe003f 0xdf2fe 0x5fa30 0x5fc56 0x46384 0x39aa9 0x12cafa9 0x13b41c5 0x1319022 0x131790a 0x1316db4 0x1316ccb 0x12c9879 0x12c993e 0x37a9b 0x1c22 0x1b95) terminate called throwing an exception**`

这是我的代码：

```
- (void)tableView:(UITableView *)tableView
commitEditingStyle:(UITableViewCellEditingStyle)editingStyle 
forRowAtIndexPath:(NSIndexPath *)indexPath 
{
    [tabela beginUpdates]; 
    if (editingStyle == UITableViewCellEditingStyleDelete) 
    {
        // Get the TAG and ID of Bill to delete
        //UITableViewCell * cell = [self tableView:tabela cellForRowAtIndexPath:indexPath];
        //NSLog(@"%d", cell.tag);

        [tabela deleteRowsAtIndexPaths:[NSArray arrayWithObjects:indexPath, nil] withRowAnimation:YES];      

    }   

    [tabela endUpdates];
    [tabela reloadData];

} 
```

谢谢您的帮助！

**编辑**

`self.billsArray = [[NSMutableArray alloc] init];
self.billsArray = [resultsDictionary objectForKey:@"bills"];`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:58:13.763

在您的 billsArray 中，确保并删除正在删除的相应对象。

```
[billsArray removeObjectAtIndex:indexPath.row]; 
```

以下是输出的提示：

> 更新后现有节中包含的行数 (4) 必须等于更新前该节中包含的行数 (4)，加上或减去从该节中插入或删除的行数（0 插入, 1 已删除）并加上或减去移入或移出该部分的行数

所以你的 UITableView 几乎是在说：

> “好的，我有 20 行（来自 [billsArray 计数]。现在我想删除一行，这意味着我应该总共有 19 行......但我的代表说我应该有 20 行......哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇

因此，每当您删除一行时，请确保并从您的数据数组中删除该对象。**或者**，如果您添加一行，请确保将其添加到您的数据数组中。

编辑：（响应 OP 编辑​​）。

有你的问题。

```
self.billsArray = [resultsDictionary objectForKey:@"bills"]; 
```

这将创建一个只读数组。

你需要做的是：

```
self.billsArray = [[NSMutableArray alloc] initWithArray:[resultsDictionary objectForKey:@"bills"]]; 
```

或者

```
self.billsArray = [NSMutableArray arrayWithArray:[resultsDictionary objectForKey:@"bills"]]; 
```

或者你可以这样做（不是一个干净的方法）：

```
NSMutableArray *temp = [resultsDictionary objectForKey:@"bills"];
self.billsArray = [temp mutableCopy]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:58:02.513

如果你的表只有一个部分，你可以`[billsArray removeObjectAtIndex:[indexPath row]]`在方法中的某个地方调用，假设 billsArray 是一个`NSMutableArray`，而不是一个`NSArray`。如果不是，您可以将其更改为一个，或者将其内容复制到一个新的`NSMutableArray`中，然后将该数组用作表数据源。

# ios - UITableView 在 heightForRowAtIndexPath 和 cellForRowAtIndexPath 之间挂起 5 秒

> ID：11784582
> 
> 赞同：0
> 
> 时间：2012-08-02T19:36:17.287
> 
> 标签：ios, uitableview, reloaddata

我在这里有一个非常奇怪的行为。我正在使用 RSSKit 下载和解析 XML-Feed。到现在为止还挺好。这发生在几毫秒内。完成后，我在 TableView 上调用 reloadData。紧接着 numberOfRowsInSection 和 heightForRowAtIndexPath 调用。然后大约 5 秒没有发生任何事情。只有在那 5 秒之后 cellForRowAtIndexPath 才会被调用。

它变得更加奇怪！在这段时间什么都没有发生的时候，tableView 已经完全响应了。当与 UI 交互时 cellForRowAtIndexPath 会立即被调用。

在 reloadData 之后直接在 tableview 上放置 setNeedsDisplay 不会改变任何内容。我认为这个问题似乎与 iOS 的 Window-Server 有关？

一个小总结现在对我来说是这样的：当手机什么都不做时，UI 的更新过程似乎在大约 5 秒内没有反​​应。

有人知道如何追踪到原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:04:21.380

我的失败！dispatch_sync(dispatch_get_main_queue() ...回到主线程，一切正常...

# javascript - javascript和grep替换变量

> ID：11784591
> 
> 赞同：0
> 
> 时间：2012-08-02T19:37:24.590
> 
> 标签：javascript, regex, grep

我有一些我经常需要手动更改的数字列表，当它运行时，现在在 var str（下面的#1）中列出了一个小样本，它给出了（#2）作为输出。我想要发生的是 var xyz 每次遇到新部分时都会更改，并继续用新的 var 标记它们，直到它进入下一个部分。(#3) 我希望我的问题很清楚。（显然不是......）我知道我做错了什么，而且这可能不是一开始就以最好的方式编写的。因此，任何提示将不胜感激。

（19.32 规格 03 20.56 2 20.84 3 39.32 规格 04 30.56 2 30.84 3）

（19.32 规格 03 20.56 规格 06 20.84 规格 06 39.32 规格 04 30.56 规格 06 30.84 规格 06）

( **19.32 spec03** 20.56 spec03 20.84 spec03 **39.32 spec04** 30.56 spec04 30.84 spec04) [粗体值是新部分的第一个实例]

```
var xyz = 'spec06';
var str = '19.32    spec03 20.56    2 20.84 3';
var patt1 = /([0-9]+\.[0-9]+\t)([0-9]+)/;
var patt2 = /([0-9]+\.[0-9]+\t)(spec[0-9]+)/;
function cleaner() {
for (i = 1; i <= 150; i++) {
    //xyz = str.replace(patt2, '$1') <-- this crashes the program...?
    str = str.replace(patt1, '$1' + xyz)

    }

} 
```

[实时版本](http://jsfiddle.net/wyE2x/3/)注意：您需要一些制表符分隔的输入才能响应...

这里是一些输入的样品，我将使用：278.091182 spec35 279.300274 2 279.842670 3 280.204268 281.006563 4 5 6 281.503759 282.339954 7 282.532053 8 282.690252 9 283.300448 10 285.357034 11 285.718632 12 286.407927 287.809118ëspec36 288.747012 2 288.927811 3 289.266809 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:09:47.270

我不会在这里使用循环，而是使用带有[for 函数`replace`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_function_as_a_parameter)的全局正则表达式。它确实匹配整个组（数字加规范，或数字和整数）并将其替换为数字加规范。如果规格号匹配，它将更新`spec`变量并使用它：

```
var str = '19.32    spec03 20.56    2 20.84 3';
var spec = "06"; // initial spec number
return str.replace(/(\d+\.\d+)\s+(spec)?(\d+)/g, function(whole, num, sp, spn) {
    if (sp) // second group matched "spec"
        spec = spn; // set new spec number
    return num + "\tspec" + spec;
}); 
```

（[在 jsfiddle.net 上的演示](http://jsfiddle.net/wyE2x/4/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:05:07.227

我完全修改了您的代码，但这应该可以做到：

```
var str = '19.32    spec03 20.56    2 20.84 3';
var items = str.split(/\s+/);   // break up at whitespace

var xyz = "spec06"; // spec number
items = items.map(function(item) {    // cycle through and modify each item
    if(item.indexOf("spec") != -1) {    
        xyz = item; // keep track of spec number
        return item;
    } else {
        return item+xyz;    // append spec number
    }
});
str = items.join("    ");    // join with whitespace again 
```

现场版：http: [//jsfiddle.net/Tys95/](http://jsfiddle.net/Tys95/)

# java - 使用泛型避免在这个抽象工厂中沮丧

> ID：11784593
> 
> 赞同：1
> 
> 时间：2012-08-02T19:37:32.117
> 
> 标签：java, design-patterns, generics, refactoring

我有以下对象

```
interface Adapter<T> {
      T fromXml(XML xml);
      XML toXml(T obj); //ignoring this in implementations
}

abstract class AbstractAdapter<T> implements Adapter<T>{
       T fromXml(XML xml) { //template method
         validate(xml);
         return parse(xml);
       }
       abstract void validate(Xml xml);
       abstract T parse(Xml xml);
}

class MyObjectAdapter extends AbstractAdapter<MyObject> {
       MyObject parse(XMl xml) {return null;}
       void validate(Xml xml) {}
}

class AnotherObjectAdapter extends AbstractAdapter<AnotherObject> {
       AnotherObject parse(XMl xml) {return null;}
       void validate(Xml xml) {}
}

class AdapterFactory {
      Adapter<?> createAdapter(String objectType) {
         if (objectType == "MyObject") return new MyObjectAdapter();
         if (objectType == "AnotherObject") return new AnotherObjectAdapter();
}

public static void main(String args[]) {
      AdapterFactory factory = new AdapterFactory();
      //********
      Adapter<MyObject> myobjectAdapter = (Adapater<MyObject>) factory.createAdapter("MyObject");
      MyObject obj = myobjectAdapter.fromXml(getXml(args)); 
} 
```

如何避免在上面标有***** ***的行中进行向下转换？需要适配器的对象之间没有任何关系，它们是通用数据对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:41:52.103

您在 a 中有一个类名，`String`并且您正试图从该类名转到实际类型。那总是会涉及演员表。如果您删除`AdapterFactory`，因此删除`String`，则没有问题。

（通常注意`==`on `String`s 通常不是您想要的。）

# vim - 仅*完全*在 .vimrc 文件中工作的日光着色，其他文件有语法着色问题

> ID：11784594
> 
> 赞同：2
> 
> 时间：2012-08-02T19:37:36.423
> 
> 标签：vim

我的 .vimrc 文件包含：

```
syntax on
set background=light
let g:solarized_termcolors=16
se t_Co=16
colorscheme solarized 
```

*   我已将 solarized.clr 文件放入我的 ~/Library/Colors/ 文件夹中

所以这是我的 .vimrc 文件中的一些代码：http: [//i.imgur.com/WGqMy.png](http://i.imgur.com/WGqMy.png)

这是 ~/ 中的测试文件中的一些代码：http: [//i.imgur.com/fJLIh.png](http://i.imgur.com/fJLIh.png)

我已经为此工作了一段时间......让我发疯了。不过，我对所有这些 vim 配置都是新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:02:45.140

从您的屏幕截图来看，您似乎没有在终端模拟器中安装过曝晒颜色（例如，背景应该与[晒晒主页](http://ethanschoonover.com/solarized)的背景颜色相同，而不是白色）。vim 日晒配色方案[仅](http://ethanschoonover.com/solarized/vim-colors-solarized#important-note-for-terminal-users)在您将终端仿真器设置为使用日晒颜色时才有效。所以它实际上并不完全适用于任何文件。

你的终端模拟器是 Mac OS X Terminal.App 吗？在这种情况下，请按照[这些说明进行操作（否则，请在学术主页和](https://github.com/altercation/solarized/tree/c350650cb74eed91895272d4b9d0fde8a335d223/osx-terminal.app-colors-solarized)[git 存储库](https://github.com/altercation/solarized)中查找您的终端模拟器的说明）。

# c++ - 如何编译用于 .net 应用程序的 c++ 程序？

> ID：11784595
> 
> 赞同：0
> 
> 时间：2012-08-02T19:37:37.783
> 
> 标签：c++, .net, dll, clr

我正在尝试编译一个用 C++ 编写的程序（SuitSparse，进行稀疏矩阵计算）。我需要编译它以供 csharp.net 应用程序使用。最好的方法是什么？

1) 编译它并像任何其他 c++ dll 一样引用它？2）是否有任何程序可以将其转换为 clr （或 .net 会更好理解的东西） 3）？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:46:13.720

您不能在 C# 程序中使用 C++ DLL，但可以在 C# 程序中使用 C++/CLI DLL。[为 C++ 项目创建 C++/CLI 包装器并将其构建到 DLL](https://stackoverflow.com/questions/569603/using-c-class-dll-in-c-sharp-application)中。

正如 Ed S. 所指出的，另一种选择是使用 COM 接口，但我认为这并没有提供非常 C#-ish 库的感觉。这真的取决于你觉得最舒服的，我会假设 C# dll。

# ruby - Assertions with storing/retrieving floating point numbers

> ID：11784597
> 
> 赞同：-1
> 
> 时间：2012-08-02T19:37:41.763
> 
> 标签：ruby, ruby-on-rails-3, unit-testing, testing

(This question is asked in a Ruby context, but I wouldn't be upset if it were answered in a more general way.)

So (just about) everyone knows that comparing floating point numbers involved in math computations for equality is a no-go, and you have to test for range (in Ruby, like so):

```
assert_in_delta 5.0, 3.5+1.5, 0.0001 
```

However, is this still necessary when sanity checking a floating point number for equality when it is passed from one subsystem to another, say (in a Ruby context) like so?

```
json={:foo => 0.5}.to_json
# POST the JSON to a Rails controller, that puts it in a Mongo database
found_obj=pull_obj_out_of_Mongo # details not important here
assert_in_delta 0.5, found_obj[:foo], 0.0001 
```

I personally argue is that assert_in_delta is still a good idea here, because I don't know, and perhaps many people don't know, whether the conceptual floating point value 0.5 is passed along in a way that would enable it to be compared with the floating point literal 0.5 with equals. Is that actually the case, or am I being too paranoid about how floating point numbers are stored and passed along? How much does the answer depend on what language is being used?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:33:24.663

This depends a lot on what the subsystem does with the Float. In Ruby (1.8 and 1.9 at least), Floats simply wrap an double precision number (literally a `double` in C, which is stored as an [IEEE 754 double-precision number](http://en.wikipedia.org/wiki/Double-precision_floating-point_format) on most modern architectures). The bits don't change when you pass the number around or copy it in that representation.

However, when you pass the Float into a subsystem, it may change the underlying representation. In the example you give, you're serializing the number with JSON, which involves converting the float to a string, and then converting it back. There's no guarantee that you'll recover more than 15-16 digits of accuracy (assuming you converted it with that degree of accuracy). That seems like a lot, but it's not enough to ensure strict equality for all possible floating point values.

# mysql - 返回每行的行组总和

> ID：11784600
> 
> 赞同：5
> 
> 时间：2012-08-02T19:37:45.917
> 
> 标签：mysql, sql

满足选择条件的行的列值的总和是否不仅可以返回每个单独的行，还可以返回多个满足相同条件的组？

例如，考虑：

```
id  order_id    quantity
1   1           1
2   1           3
3   1           5
4   2           2
5   2           4 
```

MySQL SELECT 查询可以返回以下结果：

```
id  order_id    quantity    order_sum
1   1           1           9
2   1           3           9
3   1           5           9
4   2           2           6
5   2           4           6 
```

编辑：后续问题：假设结果是从具有多个条件的查询中产生的，那么在最终查询中如何处理这些条件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T20:18:37.160

您可以在“from”子句中使用子查询：

```
select  t.*, tsum.sumquantity
from t join
     (select t.orderid, sum(quantity) as sumquantity
      from t
      group by t.order_id
     ) tsum
     on t.orderid = tsum.orderid 
```

将它放在“from”子句中的好处是可以有多个变量。例如，您可以添加订单数量、最大数量、恰好 1 个数量出现的次数等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:40:09.270

您可以使用子查询：

```
select  *
,       (
        select  sum(quantity)
        from    YourTable yt2
        where   yt2.order_id = yt1.order_id
        ) as order_sum
from    YourTable yt1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T08:41:18.377

你需要有一个子查询来`SUM`计算`quantity`每个`Order_ID`

```
SELECT  a.*, b.order_sum
FROM    myTable a INNER JOIN
            (
                SELECT order_ID, 
                       SUM(quantity) order_sum
                FROM    myTable
                GROUP BY order_ID
            ) b on a.order_ID = b.order_ID 
```

# wpf - 什么时候应该使用 ComponentResourceKey 而不是字符串作为资源键？

> ID：11784605
> 
> 赞同：6
> 
> 时间：2012-08-02T19:38:28.733
> 
> 标签：wpf

ComponentResourceKey 上的帮助主题页面并未就您何时希望从基于字符串的键移动到 ComponentResourceKey 以从 ResourceDictionary 放置和/或检索资源提供很好的指导。是否有人对您何时希望在字符串上使用 ComponentResourceKey 有任何见解？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T23:32:44.860

根据我对 ComponentResourceKeys 的了解，它们通过定义自己的类型来建立全局唯一性，并且是引用通用或主题字典中定义的资源所必需的。

您存储在主题字典（例如 generic.xaml）中的资源只能通过 ComponentResourceKey 而不是普通的 x:Key 访问，除非您将 generic.xaml 显式引用到 Resources 集合的 MergedDictionaries 集合中（例如在 App 或 Window 或元素level) 但您不应该这样做，因为这不是 generic.xaml 的意图

# mysql - PHP中的这个mysql查询有什么问题？

> ID：11784610
> 
> 赞同：-3
> 
> 时间：2012-08-02T19:38:45.587
> 
> 标签：mysql

如果我回显它，我会得到这个：

INSERT INTO stockk（公司、适应症、股票代码、mkt_cap、价格、变化）价值（'辉瑞公司'、'蛋白质替代疗法/血液疾病/等'、'PFE'、'178.6B'、'23.85'、'- 0.38%')

这是代码：

```
$quer1 = "INSERT INTO stockk (company, indications, ticker, mkt_cap, price, change) VALUES ('".addslashes($value['fullname'])."', '".addslashes($value['indic'])."', '".addslashes($value['symbol'])."', '".addslashes($mkt)."', '".addslashes($round)."', '".addslashes($value['PercentChange'])."')"; 
```

它抛出一个mysql语法错误......

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在“更改”附近使用的正确语法）值（“辉瑞公司”，“蛋白质替代疗法 / 血液疾病 / e”在第 1 行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:42:36.580

问题是这`change`是 MySQL 中的保留字 - 您在列列表中使用它。如果将它用 SQL 引号括起来，语法错误就会消失。

```
INSERT INTO stockk (company, indications, ticker, mkt_cap, price, `change`) VALUES [...] 
```

# json - Nodejs：从文件中读取时清理 json（比如评论）的任何库？

> ID：11784612
> 
> 赞同：3
> 
> 时间：2012-08-02T19:38:52.813
> 
> 标签：json, node.js

我正在使用 Node.js 读取 json 文件`require("fs")`。

就像是：

```
var readJsonFromFile= function(fileLocation, callback){
      fs.readFile(fileLocation, 'utf8', function (err, data) {
          if (err) {
            return callback(err);
          }

          data = JSON.parse(data);
          callback(null,data);
    });
} 
```

但是，我注意到`JSON.parse`：

*   不允许评论`// bla`或`/* blaa */`
*   需要引用键。

尽管我意识到这在技术上是正确的，但我想知道是否存在任何小型库来清理我经常带注释的 json 文件以保证上述内容。（不，这不是完全微不足道的 DIY，认为`//`是有效值的一部分，等等。）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:43:24.050

是的！为此，我使用 Kyle Simpson 的 JSON.minify：

[https://github.com/getify/JSON.minify](https://github.com/getify/JSON.minify)

它不是一个成熟的 Node 模块，但它非常适合加载类似 JSON 的配置文件等。请注意，您仍然必须引用您的密钥，但它确实允许评论。

```
var config = JSON.parse(JSON.minify(fs.readFileSync(configFileName, 'utf8'))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-16T12:29:45.350

[HJSON](https://www.npmjs.com/package/hjson)满足所有这些要求。

*   这是一个 NPM 包
*   它可以处理`//`评论
*   它可以处理`/* */`评论
*   它可以处理不带引号的键。

[你可以在网上试试](http://hjson.org/try.html)。

示例文本：

```
{
  # specify rate in requests/second (because comments are helpful!)
  rate: 1000

  // prefer c-style comments?
  /* feeling old fashioned? */

  # did you notice that rate doesn't need quotes?
  hey: look ma, no quotes for strings either!

  # best of all
  notice: []
  anything: ?

  # yes, commas are optional!
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T07:24:02.933

只需使用[JS-YAML](https://github.com/nodeca/js-yaml)来解析您的 JSON 文件。YAML 是 JSON 的超集，支持您想要的功能。

如果您不想，则不需要在配置文件中实际使用任何 YAML 特定的东西；只需将 YAML 解析器用作 JSON 解析器即可修复 3 个烦人的问题（注释、引用和尾随逗号）。

它甚至带有一个将 YAML 转换为纯 JSON 的命令行工具：

```
~> echo "{ foo: 10, bar: [20, 30], }" | js-yaml -j /dev/stdin
{
  "foo": 10,
  "bar": [
    20,
    30
  ]
} 
```

# objective-c - 带有 CATransaction 的 CALayer 动画在视图调整大小之前表现不同

> ID：11784617
> 
> 赞同：4
> 
> 时间：2012-08-02T19:39:27.153
> 
> 标签：objective-c, cocoa-touch, core-animation, calayer

（iOS 5.1，XCode 4.4）

**编辑：**目前（在 iOS 7.0 上），该图层似乎始终忽略第一个非动画更改，并且始终从原始值设置动画。我无法再重现对视图调整大小的依赖。

我有一个 CALayer，它的位置首先用 [CATransaction setDisableActions:YES] 更改（所以没有动画），然后直接用 [CATransaction setDisableActions:NO] （动画）更改。通常，这会导致动画从第一次更改中设置的位置到第二次更改中设置的位置。但是，我发现我的代码从初始位置动画到第二次更改的位置。

经过大量的测试和调试，我发现它依赖于包含在更改之前调整大小的图层的 UIView。代码重现（iphone单视图模板，添加QuartzCore.framework）：

```
#import <QuartzCore/QuartzCore.h>
#import "TAViewController.h"

@interface TAViewController ()

@property (nonatomic, strong) UIView *viewA;
@property (nonatomic, strong) CALayer *layerA;

@end

@implementation TAViewController

- (IBAction)buttonPressed
{
    self.viewA.frame = CGRectMake(0, 30, 320, 250);
    [self setPosition:CGPointMake(0, 100) animated:NO];
    [self setPosition:CGPointMake(0, 150) animated:YES];
}

- (void)setPosition:(CGPoint)position animated:(BOOL)animated
{
    [CATransaction begin];
    if(animated) {
        [CATransaction setDisableActions:NO];
        [CATransaction setAnimationDuration:5];
    } else {
        [CATransaction setDisableActions:YES];
    }
    self.layerA.position = position;
    [CATransaction commit];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.viewA = [[UIView alloc] init];
    self.viewA.backgroundColor = [UIColor darkGrayColor];
    self.viewA.frame = CGRectMake(0, 30, 320, 300);
    [self.view addSubview:self.viewA];
    self.layerA = [CALayer layer];
    self.layerA.backgroundColor = [UIColor redColor].CGColor;
    self.layerA.anchorPoint = CGPointZero;
    self.layerA.frame = CGRectMake(0, 0, 320, 100);
    [self.viewA.layer addSublayer:self.layerA];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T18:24:22.960

我遇到了类似的问题，并通过延迟动画属性更改来解决它，这可能具有将它们推入下一个运行循环的效果，从而确保先前的属性更改在隐式动画开始之前生效。

我通过使用 GCD 的 dispatch_after() 以非常小的延迟做到了这一点。

您还可以通过使用从非动画属性值开始的显式动画来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:49:53.193

您在 setPostion:Animated: 的两次调用中都添加了 animated:YES 因此，该方法两次都在使用

```
[CATransaction setDisableAction:NO] 
```

代替

```
[CATransaction setDisableAction:YES] 
```

我认为您的按钮按下方法应更改为

```
[self setPosition:CGPointMake(0, 100) animated:NO];
[self setPosition:CGPointMake(0, 150) animated:YES]; 
```

# wpf - RibbonComboBox 的 SelectedValue 属性问题

> ID：11784629
> 
> 赞同：1
> 
> 时间：2012-08-02T19:40:16.530
> 
> 标签：wpf, ribbon-control

我刚开始使用功能区栏在 WPF 项目中工作，但我被 RibbonComboBox 卡住了。

我需要添加 3 个项目，所以到目前为止我所做的是：

```
<RibbonComboBox Name="phaseComboBox">
                    <RibbonGallery>
                        <RibbonGalleryCategory>
                            <RibbonGalleryItem>
                                Phase 1
                            </rb:RibbonGalleryItem>
                            <RibbonGalleryItem>
                                Phase 2
                            </RibbonGalleryItem>
                            <RibbonGalleryItem>
                                Phase 3
                            </RibbonGalleryItem>
                        </RibbonGalleryCategory>
                    <RibbonGallery>
</RibbonComboBox> 
```

但是我需要首先选择第一个元素，所以，我将`RibbonGalleryCategory`'`SelectedValue`属性设置为`Phase 1`，但它永远不会被选中。

我究竟做错了什么？这可能是一个非常简单的问题，但这是我第一次开发 Ribbon Bar。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:18:55.753

我已经解决了我的问题：

我只需要在元素中设置`IsSelected`属性：`True`

```
<RibbonGalleryItem Content="Phase 1" IsSelected="True" /> 
```

# collision-detection - 用于哈希冲突的冲突生成器或数据集（如 MD5、SHA-1 ...）

> ID：11784635
> 
> 赞同：-1
> 
> 时间：2012-08-02T19:41:14.407
> 
> 标签：collision-detection, checksum, redundancy, hash-collision

我想测试第 3 方（包括“闭源”）工具（如同步、重复数据删除......）在存在具有相同大小和摘要校验和的文件（流行的 CRC32、MD5、SHA-1 .. 。 ETC）。其中一些散列方法具有已知的漏洞，因此存在产生冲突的方法。

您是否知道此类数据集的来源（除了蛮力尝试创建一些:)）或用于创建此类数据集的生成器吗？

为了明确这一点：我对具有相同校验和、文件大小但内容不同的文件集感兴趣！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:28:06.780

我们知道 md5 的弱点：

> 2005 年，研究人员能够创建具有相同散列的 PostScript 文档 [24] 和 X.509 证书 [25] 对。那年晚些时候，MD5 的设计师 Ron Rivest 写道，“md5 和 sha1 都明显坏了（就抗碰撞性而言）。”[26]

来源：[http ://en.wikipedia.org/wiki/MD5](http://en.wikipedia.org/wiki/MD5)

我们可以在那里（在维基百科上）和以下 SO 主题中找到：

[创建您自己的 MD5 碰撞](https://stackoverflow.com/questions/933497/create-your-own-md5-collisions)

示例对。

问题仍然存在 -> 关于好的数据集，还有更多示例。（或不错的发电机）。

# c# - 从 Web 查询集合中可观察到的响应式扩展

> ID：11784637
> 
> 赞同：0
> 
> 时间：2012-08-02T19:41:20.957
> 
> 标签：c#, .net, system.reactive, async-await, c#-5.0

相关： [列表上的异步函数](https://stackoverflow.com/questions/11783479/async-function-over-a-list)

我有一个看起来像这样的函数：

```
public async Task<decimal> GoToWeb(string Sym){} 
```

我想每分钟一次通过字符串列表定期调用它。如何将其转换为反应式扩展 Observable？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:51:38.970

由于反应式框架可以为您处理异步，您可以尝试以下操作：

```
var syms = new List<string>() { "ANZ", "BHP", };

var query =
    from i in Observable.Interval(TimeSpan.FromSeconds(1.0))
    from sym in syms.ToObservable()
    from d in GoToWeb(sym).ToObservable()
    select new
    {
        Symbol = sym,
        Value = d,
    }; 
```

您需要添加对命名空间的引用以`System.Reactive.Threading.Tasks`获取`ToObservable()`任务的扩展。

这是否满足您的需求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:26:01.933

我是一个 Rx 菜鸟，所以可能有更好的选择，但是在不知道您希望为每批完成的网络调用发生什么的情况下，我避免使用 linq 语法（尽管我更喜欢在可能的情况下使用它）。

我在 LINQPad 中使用 Rx-Main(Prerelease) 的 NuGet 包进行了此操作

![在此处输入图像描述](../Images/0ec65aab6556620b7f98508c15db986f.png)

```
void Main()
{
    var eachMinuteSequence = Observable.Timer(TimeSpan.Zero, TimeSpan.FromMinutes(1));

    var symbols = new[] { "GOOG", "MSFT", "AAPL" };

    Action<long> eachMinuteAction = async _ =>
    {
        var tasks = StartWebCalls(symbols);
        var results = await Task.WhenAll(tasks);
        // do something with the results
    };
    eachMinuteSequence.Subscribe(eachMinuteAction);
}

// Define other methods and classes here
public Task<decimal>[] StartWebCalls(IEnumerable<string> stockSymbols)
{
    return (
        from symbol in stockSymbols
        select GoToWeb(symbol)
    ).ToArray();
}

public async Task<decimal> GoToWeb(string Sym){throw new NotImplementedException();} 
```

# android - 从另一个应用程序恢复后隐藏软件键盘

> ID：11784641
> 
> 赞同：2
> 
> 时间：2012-08-02T19:41:49.427
> 
> 标签：android, hide, android-activity, android-softkeyboard

我的应用程序将数据发送到其他应用程序。有时其他应用程序会打开软键盘，但不会关闭它。问题是，恢复到我的应用程序后，我无法像在我的应用程序中的正常情况下那样关闭该软件键盘：

```
((InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE)).hideSoftInputFromWindow(view.getWindowToken(), 0); 
```

我还尝试了 view.getApplicationWindowToken() 和各种标志，但没有成功。如何关闭由其他应用程序打开的软键盘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:31:10.693

这只是一个猜测，但你能做一些事情，比如获取 ActivityManager，找到最后一个运行的 Activity，然后找出它是 Window Token 吗？

老实说，我不知道这是否可能，但希望它能让你走上正确的道路。

活动管理器代码（我知道这几乎没有帮助）：

```
// get the ActivityManager
ActivityManager result = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE); 
```

编辑：

我应该注意到，这真的不是 ActivityManager 的用途......所以它可能最终成为一种挖掘另一个活动窗口的黑客解决方案......

# javascript - 变量递增两次而不是一次

> ID：11784647
> 
> 赞同：0
> 
> 时间：2012-08-02T19:42:08.907
> 
> 标签：javascript

在我的程序结束时，我在 evalSeqResults() 中增加“级别”，然后显示结果（尽管稍后我将在此方法中添加不同的要求）

当 resultStr 出现在屏幕上时，它具有正确的级别，但几秒钟后，“级别”又增加了一次，其他 2 个依赖它的变量也增加了一次

有人知道为什么是这样吗？

这里有更多代码： http: [//pastebin.com/RuKLadmK](http://pastebin.com/RuKLadmK)

```
function endSequence() {     
    evalSeqResults(); 
    displaySeqResults();
 }

function evalSeqResults() {
    level++;
}

function displaySeqResults() {
    var resultStr = "You scored " + correctCount + " out of " + (NUM_OF_STACKS + 20) +
    "<br/>";
    resultStr += "Your next level is: " + level + "<br/>";
    resultStr += "There will be " + LEVELS[level].numDecks + " decks and you are looking for " + LEVELS[level].nBack + " back. <br/>";
    resultStr += "Press START to continue";
    $('#resultspara').html(resultStr);
    $('#resultspara').show(0);
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:14:08.777

您的`level`变量在任何地方都没有定义。但是，我在您的代码中发现了一个小故障，在该处`endSequence`被调用：

```
function doNext() {
     if (cardNum < maxCard) {
          cardNum++;
          fixate();
     }
     if (cardNum == maxCard) {
          endSequence();
     }
} 
```

比方说，`cardNum`是`4`和`maxCard`是`5`。第一次`doNext`被调用，第一个条件为真。`cardNum`增加到`5`并被`fixate`调用。之后，第二个条件也为真 ( `5==5`) -`endSequence`被调用。第二次`doNext`被调用，只有第二个条件匹配并被`endSequence`再次执行。

我猜你想要：

```
function doNext() {
     if (cardNum < maxCard) {
          cardNum++;
          fixate();
     } else if (cardNum == maxCard) {
//     ^^^^
          endSequence();
     }
} 
```

# javascript - Javascript 只调用一次带有 setInterval() 的子函数

> ID：11784648
> 
> 赞同：0
> 
> 时间：2012-08-02T19:42:12.093
> 
> 标签：javascript, jquery

我只想用 setInterval 调用 myfun1 一次。我想避免使用全局变量。阅读[此](https://stackoverflow.com/questions/3332265/how-to-detect-a-function-was-called-with-javascript)内容，但它不起作用（仅每 2000 毫秒调用一次该函数）。自然，我需要每 2000 毫秒调用一次 main() 。

```
(function($){         
    setinterval(main,2000);  

     function main (){            
        if(/*condition*/) return;

        function callItOnce(fn) {
            var called = false;
            return function() {
                if (!called) {
                    called = true;
                    return fn();
                }
                return;
            }
        }

        myfun1 = callITOnce(myfun1);
        myfun1();

        function myfun1(){/*code*/};
        function myfun2(){/*code*/};
        function myfun3(){/*code*/};
})(jquery); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T19:45:09.147

使用标志：

```
(function($){ 
    var timer = setInterval(main,2000), ran=true;

    function main() {
        if(/*condition*/) return;

        if (ran) { //runs when ran=true, which is only the first time
            myfun1();
            ran = false;  //since it's set to false here
        }

        function myfun1(){/*code*/};
        function myfun2(){/*code*/};
        function myfun3(){/*code*/};

})(jquery);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:52:12.443

`callItOnce`您编写的功能应该可以工作。您只需要在调用之外声明该函数`setInterval`。否则每次都会重新定义。

```
(function () {

function myfun1(){/*code*/};
function myfun2(){/*code*/};
function myfun3(){/*code*/};

function callItOnce(fn) {
    var called = false;
    return function() {
        if (!called) {
            called = true;
            return fn();
        }
        return;
    }
}

myfun1 = callItOnce(myfun1);

function main() {
    if(/*condition*/) return;
    myfun1();
}

setInterval(main, 2000);

}()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T21:09:35.070

解决此问题的一种简单方法是在函数本身上使用变量。

```
function myFunc1(){

if(arguments.callee.done){return;}

arguments.callee.done = true;    

} 
```

这样，方法 myFunc1 上的“done”变量将确保该方法只执行一次。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-02T19:47:17.777

setInterval 返回一个值，您可以将其传递给 clearInterval 以停止调用回调。

```
var i = 0;
var timeout_id = setTimeout(function(){
    console.log(i);
    if(i >= 5){ clearTimeout(timeout_id) }
    i++;
}) 
```

# regex - 如何让 perl 识别一个包含多个 | 的字符串 是作为一个单一的字符串？

> ID：11784649
> 
> 赞同：1
> 
> 时间：2012-08-02T19:42:15.347
> 
> 标签：regex, string, perl, replace, large-files

我是 perl 的一个完全的业余爱好者，我想问一个问题来帮助我查找和替换我试图应用来更改 SAM 文件上的引用名称的功能，以便我可以通过 FindPeaks 运行它。这些文件非常大（从 5 到 17 个演出），我能够在文本编辑器中打开它们并在不使用编程语言的情况下运行比赛。

基本上，我希望 perl 匹配整个字符串，例如“gi|149288852|ref|NC_000067.5|NC_000067”，并且只用“chr1”替换整个字符串。

但是，到目前为止，我似乎只能将其替换为“chr1|chr1|chr1|chr1|chr1”或“gi|chr1|ref|NC000067.g|NC_000067”

谁能帮我吗？

编辑：

我尝试了一些不同的事情，但我想做的是修改我的主管从某人那里得到的程序以正确执行此操作，我将在下面发布：

```
#!/usr/bin/perl

use strict;
use warnings;

my %Chr = (

    "gi|149288852|ref|NC_000067.5|NC_000067" => "chr1",
    "gi|149288869|ref|NC_000076.5|NC_000076" => "chr10",
    "gi|149288871|ref|NC_000077.5|NC_000077" => "chr11",
    "gi|149292731|ref|NC_000078.5|NC_000078" => "chr12",
    "gi|149292733|ref|NC_000079.5|NC_000079" => "chr13",
    "gi|149292735|ref|NC_000080.5|NC_000080" => "chr14",
    "gi|149301884|ref|NC_000081.5|NC_000081" => "chr15",
    "gi|149304713|ref|NC_000082.5|NC_000082" => "chr16",
    "gi|149313536|ref|NC_000083.5|NC_000083" => "chr17",
    "gi|149321426|ref|NC_000084.5|NC_000084" => "chr18",
    "gi|149323268|ref|NC_000085.5|NC_000085" => "chr19",
    "gi|149338249|ref|NC_000068.6|NC_000068" => "chr2",
    "gi|149352351|ref|NC_000069.5|NC_000069" => "chr3",
    "gi|149354223|ref|NC_000070.5|NC_000070" => "chr4",
    "gi|149354224|ref|NC_000071.5|NC_000071" => "chr5",
    "gi|149361431|ref|NC_000072.5|NC_000072" => "chr6",
    "gi|149361432|ref|NC_000073.5|NC_000073" => "chr7",
    "gi|149361523|ref|NC_000074.5|NC_000074" => "chr8",
    "gi|149361524|ref|NC_000075.5|NC_000075" => "chr9",
    "gi|149361525|ref|NC_000086.6|NC_000086" => "chrX",
    "gi|149361526|ref|NC_000087.6|NC_000087" => "chrY", 
    );

my $usage = "\n\n\tUsage: convert.pl <SAM file>\n\nThis script converts NCBI ref#s to chr #s\n\n";

die $usage unless ( @ARGV == 1);

my $file = $ARGV[0];

open (IN, "$file") or die "Can't open file: $file\n";

while (<IN>){

    if (/\S+\s+\d+\s+(gi\S+)/){

    my $tag = $1;
    if (exists $Chr{$tag}){
        my $line = $_;
        $line =~ s/'$tag'/$Chr{$tag}/;
        print $line;
    }
    else {
        die "\n\n\nHash value doesn't exist for $tag $_\n\n";
    }
    }
    else {

    print $_;
    }
} 
```

结果是：“gi|chr1|ref|NC000067.g|NC_000067”

我也试过这个：

```
perl -pi -w -e 's/gi|149288852|ref|NC_000067.5|NC_000067/chr1/g;' *.sam 
```

看看我是否可以一个一个地做，但结果是“chr1|ch1|chr1|chr1|chr1”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:01:57.100

一个问题是：

```
$line =~ s/'$tag'/$Chr{$tag}/; 
```

您`$tag`仍然包含元字符。

采用：

```
$line =~ s/\Q$tag/$Chr{$tag}/; 
```

# angularjs - AngularJS $location 不改变路径

> ID：11784656
> 
> 赞同：129
> 
> 时间：2012-08-02T19:42:55.643
> 
> 标签：angularjs

我在提交表单后更改页面的 URL 时遇到问题。

这是我的应用程序的流程：

1.  路由已设置，URL 被某些表单页面识别。
2.  页面加载，控制器设置变量，指令被触发。
3.  触发一个特殊的表单指令，该指令使用 AJAX 执行特殊的表单提交。
4.  在执行 AJAX 之后（Angular 不处理 AJAX）然后触发回调并且指令调用`$scope.onAfterSubmit`设置位置的函数。

问题是在设置位置后什么都没有发生。我也尝试将位置参数设置`/`为......不。我也试过不提交表格。没有任何效果。

我已经测试过代码是否到达了`onAfterSubmit`函数（确实如此）。

我唯一的想法是函数的范围以某种方式改变了（因为它是从指令中调用的），但是`onAfterSubmit`如果范围改变了它又怎么能调用呢？

这是我的代码

```
var Ctrl = function($scope, $location, $http) {
  $http.get('/resources/' + $params.id + '/edit.json').success(function(data) {
    $scope.resource = data;
  });

  $scope.onAfterSubmit = function() {
    $location.path('/').replace();
  };
}
Ctrl.$inject = ['$scope','$location','$http']; 
```

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2012-08-13T10:16:47.920

几天前我遇到了类似的问题。在我的情况下，问题是我使用 3rd 方库（准确地说是 jQuery）改变了一些东西，在这种情况下，即使调用函数和设置变量工作 Angular 并不总是认识到有变化，因此它永远不会消化。

> $apply() 用于从 Angular 框架外部执行 Angular 表达式。（例如来自浏览器 DOM 事件、setTimeout、XHR 或第三方库）。

尝试`$scope.$apply()`在更改位置后立即使用并调用`replace()`以让 Angular 知道事情发生了变化。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2015-01-27T14:25:49.927

`$location.path(...)`我没有更改或刷新页面，而是使用了服务[`$window`](https://docs.angularjs.org/api/ng/service/$window)。在 Angular 中，此服务用作对象的接口`window`，并且该`window`对象包含一个属性[`location`](https://developer.mozilla.org/en-US/docs/Web/API/Window.location)，使您能够处理与位置或 URL 内容相关的操作。

例如，`window.location`您可以分配一个新页面，如下所示：

```
$window.location.assign('/'); 
```

或者刷新它，像这样：

```
$window.location.reload(); 
```

它对我有用。它与您的预期略有不同，但适用于给定的目标。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-04-03T16:03:57.767

我遇到了同样的问题，但我对 $location 的调用已经在摘要中。调用 $apply() 只是给出了一个 $digest already in process 错误。

这个技巧有效（并确保注入`$location`您的控制器）：

```
$timeout(function(){ 
   $location...
},1); 
```

虽然不知道为什么这是必要的......

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-08-07T19:21:03.733

我不得不`$location.path()`像这样嵌入我的声明，因为我的摘要仍在运行：

```
 function routeMe(data) {                
            var waitForRender = function () {
                if ($http.pendingRequests.length > 0) {
                    $timeout(waitForRender);
                } else {
                    $location.path(data);
                }
            };
            $timeout(waitForRender);
        } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-12T19:54:53.590

就我而言，问题是我的模板配置中缺少可选参数指示符（'？'）。

例如：

```
.when('/abc/:id?', {
    templateUrl: 'views/abc.html',
    controller: 'abcControl'
})

$location.path('/abc'); 
```

如果没有询问字符，路由显然不会改变抑制路由参数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-26T19:40:23.423

如果你们中的任何人使用 Angular-ui / ui-router，请使用:`$state.go('yourstate')`而不是`$location`. 它对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-16T02:42:52.897

这对我有用（在 CoffeeScript 中）

```
 $location.path '/url/path'
 $scope.$apply() if (!$scope.$$phase) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-30T10:27:00.820

在我看来，这里的许多答案似乎有点老套（例如 $apply() 或 $timeout），因为搞乱 $apply() 会导致不必要的错误。

通常，当 $location 不起作用时，这意味着某些东西没有以角度方式实现。

在这个特定的问题中，问题似乎出在非角度 AJAX 部分。我有一个类似的问题，使用 $location 的重定向应该在承诺解决后进行。我想说明这个例子的问题。

旧代码：

```
taskService.createTask(data).then(function(code){
            $location.path("task/" + code);
        }, function(error){}); 
```

注意：taskService.createTask 返回一个承诺。

$q - 使用 Promise 的角度方式：

```
let dataPromises = [taskService.createTask(data)];
        $q.all(dataPromises).then(function(response) {
                let code = response[0];
                $location.path("task/" + code);
            }, 
            function(error){}); 
```

使用 $q 来解决 promise 解决了重定向问题。

有关 $q 服务的更多信息：[https](https://docs.angularjs.org/api/ng/service/) ://docs.angularjs.org/api/ng/service/ $q

* * *

## 回答 #9

> 赞同：-8
> 
> 时间：2014-08-30T19:58:12.923

```
setTimeout(function() { $location.path("/abc"); },0); 
```

它应该可以解决您的问题。

# java - xwiki java.lang.OutOfMemoryError: PermGen 空间

> ID：11784658
> 
> 赞同：1
> 
> 时间：2012-08-02T19:43:03.577
> 
> 标签：java, tomcat, xwiki

我刚刚使用war文件在我的本地机器上下载并设置[了xwiki 。](http://www.xwiki.org/xwiki/bin/view/Main/WebHome)我正在使用 hsql 通过 tomcat 6 运行它。我已经启动并运行它，但每次我使用它并进入我正在做的任何事情的第 5 或第 6 页时，我都会收到错误消息`java.lang.OutOfMemoryError: PermGen space`

我已将此行添加到我的 catalina.bat 文件`set JAVA_OPTS="-Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms1536m -Xmx1536m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=1024m -XX:MaxPermSize=1024m -XX:+DisableExplicitGC -XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled -XX:UseConcMarkSweepGC"`中，但它似乎没有解决问题。

任何帮助表示赞赏。

**编辑**

完整的 catalina.bat 文件：

```
@echo off
rem Licensed to the Apache Software Foundation (ASF) under one or more
rem contributor license agreements.  See the NOTICE file distributed with
rem this work for additional information regarding copyright ownership.
rem The ASF licenses this file to You under the Apache License, Version 2.0
rem (the "License"); you may not use this file except in compliance with
rem the License.  You may obtain a copy of the License at
rem
rem     http://www.apache.org/licenses/LICENSE-2.0
rem
rem Unless required by applicable law or agreed to in writing, software
rem distributed under the License is distributed on an "AS IS" BASIS,
rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
rem See the License for the specific language governing permissions and
rem limitations under the License.

if "%OS%" == "Windows_NT" setlocal
rem ---------------------------------------------------------------------------
rem Start/Stop Script for the CATALINA Server
rem
rem Environment Variable Prerequisites
rem
rem   CATALINA_HOME   May point at your Catalina "build" directory.
rem
rem   CATALINA_BASE   (Optional) Base directory for resolving dynamic portions
rem                   of a Catalina installation.  If not present, resolves to
rem                   the same directory that CATALINA_HOME points to.
rem
rem   CATALINA_OPTS   (Optional) Java runtime options used when the "start",
rem                   or "run" command is executed.
rem
rem   CATALINA_TMPDIR (Optional) Directory path location of temporary directory
rem                   the JVM should use (java.io.tmpdir).  Defaults to
rem                   %CATALINA_BASE%\temp.
rem
rem   JAVA_HOME       Must point at your Java Development Kit installation.
rem                   Required to run the with the "debug" argument.
rem
rem   JRE_HOME        Must point at your Java Runtime installation.
rem                   Defaults to JAVA_HOME if empty.
rem
rem   JAVA_OPTS       (Optional) Java runtime options used when the "start",
rem                   "stop", or "run" command is executed.
rem
rem   JAVA_ENDORSED_DIRS (Optional) Lists of of semi-colon separated directories
rem                   containing some jars in order to allow replacement of APIs 
rem                   created outside of the JCP (i.e. DOM and SAX from W3C). 
rem                   It can also be used to update the XML parser implementation.
rem                   Defaults to $CATALINA_HOME/endorsed.
rem
rem   JPDA_TRANSPORT  (Optional) JPDA transport used when the "jpda start"
rem                   command is executed. The default is "dt_socket".
rem
rem   JPDA_ADDRESS    (Optional) Java runtime options used when the "jpda start"
rem                   command is executed. The default is 8000.
rem
rem   JPDA_SUSPEND    (Optional) Java runtime options used when the "jpda start"
rem                   command is executed. Specifies whether JVM should suspend
rem                   execution immediately after startup. Default is "n".
rem
rem   JPDA_OPTS       (Optional) Java runtime options used when the "jpda start"
rem                   command is executed. If used, JPDA_TRANSPORT, JPDA_ADDRESS,
rem                   and JPDA_SUSPEND are ignored. Thus, all required jpda
rem                   options MUST be specified. The default is:
rem
rem                   -agentlib:jdwp=transport=%JPDA_TRANSPORT%,
rem                       address=%JPDA_ADDRESS%,server=y,suspend=%JPDA_SUSPEND%
rem
rem   LOGGING_CONFIG  (Optional) Override Tomcat's logging config file
rem                   Example (all one line)
rem                   set LOGGING_CONFIG="-Djava.util.logging.config.file=%CATALINA_BASE%\conf\logging.properties"
rem
rem   LOGGING_MANAGER (Optional) Override Tomcat's logging manager 
rem                   Example (all one line)
rem                   set LOGGING_MANAGER="-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager"
rem
rem   TITLE           (Optional) Specify the title of Tomcat window. The default
rem                   TITLE is Tomcat if it's not specified.
rem                   Example (all one line)
rem                   set TITLE=Tomcat.Cluster#1.Server#1 [%DATE% %TIME%]
rem
rem
rem
rem $Id: catalina.bat 1146097 2011-07-13 15:25:05Z markt $
rem ---------------------------------------------------------------------------

set CATALINA_OPTS="-Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms1536m -Xmx1536m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=1024m -XX:MaxPermSize=1024m -XX:+DisableExplicitGC -XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled"

rem Guess CATALINA_HOME if not defined
set "CURRENT_DIR=%cd%"
if not "%CATALINA_HOME%" == "" goto gotHome
set "CATALINA_HOME=%CURRENT_DIR%"
if exist "%CATALINA_HOME%\bin\catalina.bat" goto okHome
cd ..
set "CATALINA_HOME=%cd%"
cd "%CURRENT_DIR%"
:gotHome
if exist "%CATALINA_HOME%\bin\catalina.bat" goto okHome
echo The CATALINA_HOME environment variable is not defined correctly
echo This environment variable is needed to run this program
goto end
:okHome

rem Copy CATALINA_BASE from CATALINA_HOME if not defined
if not "%CATALINA_BASE%" == "" goto gotBase
set "CATALINA_BASE=%CATALINA_HOME%"
:gotBase

rem Ensure that any user defined CLASSPATH variables are not used on startup,
rem but allow them to be specified in setenv.bat, in rare case when it is needed.
set CLASSPATH=

rem Get standard environment variables
if not exist "%CATALINA_BASE%\bin\setenv.bat" goto checkSetenvHome
call "%CATALINA_BASE%\bin\setenv.bat"
goto setenvDone
:checkSetenvHome
if exist "%CATALINA_HOME%\bin\setenv.bat" call "%CATALINA_HOME%\bin\setenv.bat"
:setenvDone

rem Get standard Java environment variables
if exist "%CATALINA_HOME%\bin\setclasspath.bat" goto okSetclasspath
echo Cannot find "%CATALINA_HOME%\bin\setclasspath.bat"
echo This file is needed to run this program
goto end
:okSetclasspath
set "BASEDIR=%CATALINA_HOME%"
call "%CATALINA_HOME%\bin\setclasspath.bat" %1
if errorlevel 1 goto end

if not "%CATALINA_TMPDIR%" == "" goto gotTmpdir
set "CATALINA_TMPDIR=%CATALINA_BASE%\temp"
:gotTmpdir

rem Add tomcat-juli.jar and bootstrap.jar to classpath
rem tomcat-juli.jar can be over-ridden per instance
rem Note that there are no quotes as we do not want to introduce random
rem quotes into the CLASSPATH
if "%CLASSPATH%" == "" goto emptyClasspath
set "CLASSPATH=%CLASSPATH%;"
:emptyClasspath
if "%CATALINA_BASE%" == "%CATALINA_HOME%" goto juliClasspathHome
if not exist "%CATALINA_BASE%\bin\tomcat-juli.jar" goto juliClasspathHome
set "CLASSPATH=%CLASSPATH%%CATALINA_BASE%\bin\tomcat-juli.jar;%CATALINA_HOME%\bin\bootstrap.jar"
goto juliClasspathDone
:juliClasspathHome
set "CLASSPATH=%CLASSPATH%%CATALINA_HOME%\bin\bootstrap.jar"
:juliClasspathDone

if not "%LOGGING_CONFIG%" == "" goto noJuliConfig
set LOGGING_CONFIG=-Dnop
if not exist "%CATALINA_BASE%\conf\logging.properties" goto noJuliConfig
set LOGGING_CONFIG=-Djava.util.logging.config.file="%CATALINA_BASE%\conf\logging.properties"
:noJuliConfig
set JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%

if not "%LOGGING_MANAGER%" == "" goto noJuliManager
set LOGGING_MANAGER=-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager
:noJuliManager
set JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%

rem ----- Execute The Requested Command ---------------------------------------

echo Using CATALINA_BASE:   "%CATALINA_BASE%"
echo Using CATALINA_HOME:   "%CATALINA_HOME%"
echo Using CATALINA_TMPDIR: "%CATALINA_TMPDIR%"
if ""%1"" == ""debug"" goto use_jdk
echo Using JRE_HOME:        "%JRE_HOME%"
goto java_dir_displayed
:use_jdk
echo Using JAVA_HOME:       "%JAVA_HOME%"
:java_dir_displayed
echo Using CLASSPATH:       "%CLASSPATH%"

set _EXECJAVA=%_RUNJAVA%
set MAINCLASS=org.apache.catalina.startup.Bootstrap
set ACTION=start
set SECURITY_POLICY_FILE=
set DEBUG_OPTS=
set JPDA=

if not ""%1"" == ""jpda"" goto noJpda
set JPDA=jpda
if not "%JPDA_TRANSPORT%" == "" goto gotJpdaTransport
set JPDA_TRANSPORT=dt_socket
:gotJpdaTransport
if not "%JPDA_ADDRESS%" == "" goto gotJpdaAddress
set JPDA_ADDRESS=8000
:gotJpdaAddress
if not "%JPDA_SUSPEND%" == "" goto gotJpdaSuspend
set JPDA_SUSPEND=n
:gotJpdaSuspend
if not "%JPDA_OPTS%" == "" goto gotJpdaOpts
set JPDA_OPTS=-agentlib:jdwp=transport=%JPDA_TRANSPORT%,address=%JPDA_ADDRESS%,server=y,suspend=%JPDA_SUSPEND%
:gotJpdaOpts
shift
:noJpda

if ""%1"" == ""debug"" goto doDebug
if ""%1"" == ""run"" goto doRun
if ""%1"" == ""start"" goto doStart
if ""%1"" == ""stop"" goto doStop
if ""%1"" == ""version"" goto doVersion

echo Usage:  catalina ( commands ... )
echo commands:
echo   debug             Start Catalina in a debugger
echo   debug -security   Debug Catalina with a security manager
echo   jpda start        Start Catalina under JPDA debugger
echo   run               Start Catalina in the current window
echo   run -security     Start in the current window with security manager
echo   start             Start Catalina in a separate window
echo   start -security   Start in a separate window with security manager
echo   stop              Stop Catalina
echo   version           What version of tomcat are you running?
goto end

:doDebug
shift
set _EXECJAVA=%_RUNJDB%
set DEBUG_OPTS=-sourcepath "%CATALINA_HOME%\..\..\java"
if not ""%1"" == ""-security"" goto execCmd
shift
echo Using Security Manager
set "SECURITY_POLICY_FILE=%CATALINA_BASE%\conf\catalina.policy"
goto execCmd

:doRun
shift
if not ""%1"" == ""-security"" goto execCmd
shift
echo Using Security Manager
set "SECURITY_POLICY_FILE=%CATALINA_BASE%\conf\catalina.policy"
goto execCmd

:doStart
shift
if not "%OS%" == "Windows_NT" goto noTitle
if "%TITLE%" == "" set TITLE=Tomcat
set _EXECJAVA=start "%TITLE%" %_RUNJAVA%
goto gotTitle
:noTitle
set _EXECJAVA=start %_RUNJAVA%
:gotTitle
if not ""%1"" == ""-security"" goto execCmd
shift
echo Using Security Manager
set "SECURITY_POLICY_FILE=%CATALINA_BASE%\conf\catalina.policy"
goto execCmd

:doStop
shift
set ACTION=stop
set CATALINA_OPTS=
goto execCmd

:doVersion
%_EXECJAVA% -classpath "%CATALINA_HOME%\lib\catalina.jar" org.apache.catalina.util.ServerInfo
goto end

:execCmd
rem Get remaining unshifted command line arguments and save them in the
set CMD_LINE_ARGS=
:setArgs
if ""%1""=="""" goto doneSetArgs
set CMD_LINE_ARGS=%CMD_LINE_ARGS% %1
shift
goto setArgs
:doneSetArgs

rem Execute Java with the applicable properties
if not "%JPDA%" == "" goto doJpda
if not "%SECURITY_POLICY_FILE%" == "" goto doSecurity
%_EXECJAVA% %JAVA_OPTS% %CATALINA_OPTS% %DEBUG_OPTS% -Djava.endorsed.dirs="%JAVA_ENDORSED_DIRS%" -classpath "%CLASSPATH%" -Dcatalina.base="%CATALINA_BASE%" -Dcatalina.home="%CATALINA_HOME%" -Djava.io.tmpdir="%CATALINA_TMPDIR%" %MAINCLASS% %CMD_LINE_ARGS% %ACTION%
goto end
:doSecurity
%_EXECJAVA% %JAVA_OPTS% %CATALINA_OPTS% %DEBUG_OPTS% -Djava.endorsed.dirs="%JAVA_ENDORSED_DIRS%" -classpath "%CLASSPATH%" -Djava.security.manager -Djava.security.policy=="%SECURITY_POLICY_FILE%" -Dcatalina.base="%CATALINA_BASE%" -Dcatalina.home="%CATALINA_HOME%" -Djava.io.tmpdir="%CATALINA_TMPDIR%" %MAINCLASS% %CMD_LINE_ARGS% %ACTION%
goto end
:doJpda
if not "%SECURITY_POLICY_FILE%" == "" goto doSecurityJpda
%_EXECJAVA% %JAVA_OPTS% %CATALINA_OPTS% %JPDA_OPTS% %DEBUG_OPTS% -Djava.endorsed.dirs="%JAVA_ENDORSED_DIRS%" -classpath "%CLASSPATH%" -Dcatalina.base="%CATALINA_BASE%" -Dcatalina.home="%CATALINA_HOME%" -Djava.io.tmpdir="%CATALINA_TMPDIR%" %MAINCLASS% %CMD_LINE_ARGS% %ACTION%
goto end
:doSecurityJpda
%_EXECJAVA% %JAVA_OPTS% %CATALINA_OPTS% %JPDA_OPTS% %DEBUG_OPTS% -Djava.endorsed.dirs="%JAVA_ENDORSED_DIRS%" -classpath "%CLASSPATH%" -Djava.security.manager -Djava.security.policy=="%SECURITY_POLICY_FILE%" -Dcatalina.base="%CATALINA_BASE%" -Dcatalina.home="%CATALINA_HOME%" -Djava.io.tmpdir="%CATALINA_TMPDIR%" %MAINCLASS% %CMD_LINE_ARGS% %ACTION%
goto end

:end 
```

bin\setclasspath.bat

```
@echo off
rem Licensed to the Apache Software Foundation (ASF) under one or more
rem contributor license agreements.  See the NOTICE file distributed with
rem this work for additional information regarding copyright ownership.
rem The ASF licenses this file to You under the Apache License, Version 2.0
rem (the "License"); you may not use this file except in compliance with
rem the License.  You may obtain a copy of the License at
rem
rem     http://www.apache.org/licenses/LICENSE-2.0
rem
rem Unless required by applicable law or agreed to in writing, software
rem distributed under the License is distributed on an "AS IS" BASIS,
rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
rem See the License for the specific language governing permissions and
rem limitations under the License.

rem ---------------------------------------------------------------------------
rem Set CLASSPATH and Java options
rem
rem $Id: setclasspath.bat 908749 2010-02-10 23:26:42Z markt $
rem ---------------------------------------------------------------------------

rem Make sure prerequisite environment variables are set
if not "%JAVA_HOME%" == "" goto gotJdkHome
if not "%JRE_HOME%" == "" goto gotJreHome
echo Neither the JAVA_HOME nor the JRE_HOME environment variable is defined
echo At least one of these environment variable is needed to run this program
goto exit

:gotJreHome
if not exist "%JRE_HOME%\bin\java.exe" goto noJavaHome
if not exist "%JRE_HOME%\bin\javaw.exe" goto noJavaHome
if not ""%1"" == ""debug"" goto okJavaHome
echo JAVA_HOME should point to a JDK in order to run in debug mode.
goto exit

:gotJdkHome
if not exist "%JAVA_HOME%\bin\java.exe" goto noJavaHome
if not exist "%JAVA_HOME%\bin\javaw.exe" goto noJavaHome
if not exist "%JAVA_HOME%\bin\jdb.exe" goto noJavaHome
if not exist "%JAVA_HOME%\bin\javac.exe" goto noJavaHome
if not "%JRE_HOME%" == "" goto okJavaHome
set "JRE_HOME=%JAVA_HOME%"
goto okJavaHome

:noJavaHome
echo The JAVA_HOME environment variable is not defined correctly
echo This environment variable is needed to run this program
echo NB: JAVA_HOME should point to a JDK not a JRE
goto exit
:okJavaHome

if not "%BASEDIR%" == "" goto gotBasedir
echo The BASEDIR environment variable is not defined
echo This environment variable is needed to run this program
goto exit
:gotBasedir
if exist "%BASEDIR%\bin\setclasspath.bat" goto okBasedir
echo The BASEDIR environment variable is not defined correctly
echo This environment variable is needed to run this program
goto exit
:okBasedir

rem Don't override the endorsed dir if the user has set it previously
if not "%JAVA_ENDORSED_DIRS%" == "" goto gotEndorseddir
rem Set the default -Djava.endorsed.dirs argument
set "JAVA_ENDORSED_DIRS=%BASEDIR%\endorsed"
:gotEndorseddir

rem Set standard command for invoking Java.
rem Note that NT requires a window name argument when using start.
rem Also note the quoting as JAVA_HOME may contain spaces.
set _RUNJAVA="%JRE_HOME%\bin\java"
set _RUNJDB="%JAVA_HOME%\bin\jdb"

goto end

:exit
exit /b 1

:end
exit /b 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T16:12:44.023

xwiki 论坛中的某个人发布了他们的 setenv.bat 文件，我不得不对其进行一些调整，但这似乎解决了我的问题。

```
REM # Set the Environment (32-bit/64-bit) 

SET JAVA_32_64=64 

REM # Recommended memory settings for 32-bit Java; Default Test, Default Prod 

SET "MCK_MEM_32_OPTS=-server -Xms1024m -Xmx1024m -Xmn256m -XX:MaxPermSize=200m" 

REM # Recommended memory settings for 64-bit Java; Default Test, Default Prod 

SET "MCK_MEM_64_OPTS=-server -Xms2048m -Xmx2048m -Xmn512m -XX:MaxPermSize=300m 

REM # Configure Specific JVM Settings 

SET "MCK_GC_OPTS=-XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:%CATALINA_HOME%/logs/gclog.log -verbose:gc -Xbatch -XX:HeapDumpPath=%CATALINA_HOME%/logs -XX:ErrorFile=%CATALINA_HOME%/logs -XX:+TraceClassLoading -XX:+TraceClassUnloading -Djava.awt.headless=true" 

REM # Configure Application Home Directories 

SET "JDK_HOME=C:\Program Files\Java" 

SET "JAVA_32_HOME=%JDK_HOME%\jdk1.6.0_32" 

SET "JAVA_64_HOME=%JDK_HOME%\jdk1.6.0_32" 

SET "JRE_32_HOME=%JAVA_32_HOME%\jre" 

SET "JRE_64_HOME=%JAVA_64_HOME%\jre" 

:64BIT 

SET "MCK_MEM_OPTS=%MCK_MEM_64_OPTS%" 

SET "JAVA_HOME=%JAVA_64_HOME%" 

SET "JRE_HOME=%JRE_64_HOME%" 

goto :CONTINUE 

:CONTINUE 

REM # Specify Memory Options for JBoss JVM 

SET "JAVA_OPTS=%JAVA_OPTS% %MCK_MEM_OPTS% " 

ECHO. 

ECHO =============================================================================== 

ECHO SETENV.BAT 

ECHO =============================================================================== 

ECHO. 

ECHO Running with the following Environment variables: 

ECHO. 

ECHO MCK_MEM_OPTS = %MCK_MEM_OPTS% 

ECHO JAVA_HOME = %JAVA_HOME% 

ECHO JRE_HOME = %JRE_HOME% 

ECHO JAVA_OPTS = %JAVA_OPTS% 

ECHO. 

ECHO =============================================================================== 

ECHO. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:44:48.723

解决方案确实是增加`-XX:MaxPermSize`价值，并且`1024m`应该足够了（实际上它相当大）。您仍然收到错误的事实表明该值被忽略，很可能它在其他地方被覆盖。

据我所知，有一个`CATALINA_OPTS`覆盖了`JAVA_OPTS`. 在文件中进一步查找定义设置`catalina.bat`的另一个位置。`MaxPermSize`

# data-structures - 我可以测试指针的数据类型吗？

> ID：11784659
> 
> 赞同：0
> 
> 时间：2012-08-02T19:43:06.093
> 
> 标签：data-structures, if-statement, casting, compare, gstreamer

我有一个带有两个输入的 gstreamer 插件，并且只有一个函数可以处理它们。其中一个输入是 char*，另一个是结构

有没有办法测试输入缓冲区的数据类型？

就像是：

```
chain_function(GstBuffer)
{
   if(GST_BUFFER_DATA(buffer) is mystruct)
      do something... 
   elseif(GST_BUFFER_DATA(buffer) is char*)
      do something else
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:47:16.657

如果它是 c++，如果它们共享一个共同的层次结构，你可以使用**[dynamic_cast 。](http://www.cprogramming.com/reference/typecasting/dynamiccast.html)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:57:59.743

我从未真正使用过 gstreamer；但是从[GstBuffer 的文档中](http://developer.gnome.org/gstreamer/unstable/gstreamer-GstBuffer.html)，我猜想使用的功能是设置`gst_buffer_set_qdata()`和`gst_buffer_get_qdata()`获取 GstBuffer 上的元数据。然后，您将在表示该类型的每个相应 GstBuffer 上分配元数据，然后在您的函数中检索元数据并将它们匹配为各自的数据类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T20:02:24.280

您向插件提供什么样的数据？无论如何，正如已经指出的那样，您将在输入（焊盘）上收到 GstBuffer 对象。每个 GstBuffer 都有实际的数据 + 元数据。元数据是时间戳和持续时间，还有上限。大写字母描述了数据格式。您可以检查上限以了解如何处理发送的数据。

如果您想发送不是已定义格式之一的内容（如音频/视频/文本），则需要设置自己的大写字母，例如“application/x-”。描述您想要做什么可能是一个好主意，因为这很少需要。

# r - 为向量条目分配名称而不为向量分配变量名称？

> ID：11784660
> 
> 赞同：25
> 
> 时间：2012-08-02T19:43:08.677
> 
> 标签：r, variables, variable-assignment

在 R 中，是否可以在不首先将该向量分配给变量名称的情况下为向量的组件分配名称？正常的方式显然是：

```
z <- 1:3
names(z) <- c("a", "b", "c") #normal way
names(1:3) <- c("a", "b", "c") #throws an error 
```

第二种方式抛出“名称错误（1：3）<- c（“a”，“b”，“c”）：赋值目标扩展为非语言对象”

根据文档，表达式被评估为

```
 z <- "names<-"(z,
     "[<-"(names(z), 3, "c2"))’. 
```

所以不要惊讶它不起作用，我只是想知道是否有解决方法。

理想情况下，最好有类似的东西：

```
names(z <- 1:3) <- c("a", "b", "c")
> z
a b c 
1 2 3 
```

把它放在两条不同的线上似乎是浪费空间。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-02T19:47:54.550

使用`setNames()`看起来比你建议的理想更干净/更清晰的使用怎么样？

```
z <- setNames(1:3, c("a", "b", "c"))
# z
# a b c 
# 1 2 3 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-07T16:04:28.087

一直认为这更干净一些，也不需要额外的包：

```
z <- c(a=1, b=2, c=3)
# z
# a b c 
# 1 2 3 
```

# ruby-on-rails - 使用 API 密钥时如何跳过设计身份验证？

> ID：11784661
> 
> 赞同：12
> 
> 时间：2012-08-02T19:43:13.243
> 
> 标签：ruby-on-rails, json, api, authentication, devise

我在我的应用程序上使用 Devise，并希望创建一个全局 API 密钥，无需登录即可访问任何人帐户的 JSON 数据。

例如，假设我的 API Key 是`1234`，我有两个用户创建了两个不同的餐厅。

*   用户 1 - 餐厅 1 (/restaurants/1)
*   用户 2 - 餐厅 2 (/restaurants/2)

我打开了一个全新的浏览器并且没有登录任何东西，然后我传入了我的 URL `.../restaurants/2.json?api_key=1234`，我应该能够访问该餐厅的 JSON 数据，而无需以*用户 2身份登录*

最好的方法是什么？

我遵循了[Railscast #352 Securing an API](http://railscasts.com/episodes/352-securing-an-api)，因此我可以通过传入 API 密钥来访问 JSON 内容，但我必须登录才能看到任何内容。

### 编辑 1：使用 CanCan

我应该提到我也在使用 CanCan 作为角色，但不确定在这种情况下它是否会扮演任何角色（双关语不是有意的）。

### 编辑 2：使用 API 版本控制实现

我遵循了 Railscast #350 和 #352，它们教你如何创建 REST API 版本控制以及如何使用 API 密钥保护它。

这是我的控制器/api/v1/restaurants/restaurants_controller.rb 的样子：

```
module Api
  module V1
    class RestaurantsController < ApplicationController
      before_filter :restrict_access

      respond_to :json

      def index
        respond_with Restaurant.all
      end

      def show
        respond_with Restaurant.find(params[:id])
      end

    private

      def restrict_access
        api_key = ApiKey.find_by_access_token(params[:api_key])
        head :unauthorized unless api_key        
      end
    end
  end
end 
```

我的`application_controller.rb`仍然有`before_filter :authenticate_user!`代码。

# 解决方案

我首先遵循[Railscast #350 on REST API Versioning](http://railscasts.com/episodes/350-rest-api-versioning)并将所有 JSON API 调用移至`/apps/api/v1/...`

然后，按照下面史蒂夫乔根森的解决方案，确保我的 API 模块继承自`ActionController::Base`而不是，`ApplicationController`这样它就绕过`before_filter :authenticate_user!`了`ApplicationController`.

所以，我的编辑 2 代码看起来像这样：

```
module Api
  module V1
    class RestaurantsController < ApplicationController
    ... 
```

到

```
module Api
  module V1
    #Replace 'ApplicationController' with 'ActionController::Base'
    class RestaurantsController < ActionController::Base
    ... 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-03-03T20:39:05.457

我知道自从有人问这个问题以来已经有一段时间了，但我想我会再提供一个我过去使用过的选项

```
class Api::ApplicationController < ApplicationController

skip_before_filter :authenticate_user! 
```

这假设您的 API 目录中有一个应用程序控制器，您的所有 api 控制器都从该控制器继承。如果没有，您可以将跳过放在每个控制器中。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-02T20:43:59.497

您可以`before_filter`在 Controller 中执行此操作。

目前，您可能有类似的东西：

```
class SomeController < ApplicationController
  before_filter :authenticate_user!
end 
```

您可以定义一个不同的方法（最好在 ApplicationController 中）而不是调用它

```
class ApplicationController < ActionController::Base
  before_filter :authenticate_or_token

  private
  def authenticate_or_token
    if params[:api_key] == 1234
      @current_user = User.new(:admin => true, :any => "other", :required => "fields")
      return current_user
    end
    authenticate_user!
  end 
```

我建议使用更强大的身份验证方法，例如 OAuth，但这应该适用于简单的基于 1 键的身份验证。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-03T06:40:50.943

没有人提到的一个选项是为 API 提供一组完全独立的控制器，这些控制器不继承自`ApplicationController`.

我已经看到了 API 控制器存在于文件中的模式，`/app/controllers/api/v1/somethings.rb`并且可以通过`/api/v1/somethings`. 每个特定的 API 控制器都从继承自 的基本 API 控制器继承`ActionController::Base`，因此不包括在 上定义的任何过滤器`ApplicationController`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-03T06:15:35.897

Gazler 的替代方法是使用 except：

```
class ApplicationController < ActionController::Base
  before_filter :authenticate_user!, except: :some_json_method

  def some_json_method
    render :nothing unless params[:api_key] == '1234'

    render :json
  end
end 
```

这样您就不会向密钥持有者打开整个应用程序（取决于您的需要，是否需要）。如果您需要为密钥打开多种方法，您可能还可以使用以下方法：

```
class ApplicationController < ActionController::Base
  JSON_METHODS = [method_1, method2]
  before_filter :authenticate_user!, except: JSON_METHODS
  before_filter :authenticate_token, only: JSON_METHODS

  private
  def authenticate_token
    params[:api_key] == '1234'
  end
end 
```

# c - 使外部变量在 sln 文件中的所有项目中全局可见

> ID：11784662
> 
> 赞同：0
> 
> 时间：2012-08-02T19:43:16.857
> 
> 标签：c, global

project_1.vcproj 包含： header_1.h 有“extern int flag;” 被宣布。source_1.c 已初始化“int flag = 0”

project_2.vcproj 包含： source_2.c 具有修改标志值的功能。

```
#include "header_1.h"
 void setFlag() {
    flag = 1;
} 
```

当我尝试编译时，我得到链接错误：错误 LNK2001：未解析的外部符号“int flag”

我想要实现的是我希望 flag 的值在全球范围内可见。因为在 flag 设置为 1 之后，source_1.c 使用此信息做其他事情。

请让我知道如何实现我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:50:22.940

你必须`#include "header_1.h"`在顶部`source_2.c`。

还要确保`source_1.c`包含在 project_2 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:53:34.297

Project_2 必须包含 header_1.h 或 Project_2 必须声明`extern int flag`。无论哪种方式，您都需要将 Project_2 与`int flag`. 否则，project_2 不会操纵`int flag`位于 Project_1 中的 in 的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:17:20.140

提取`int flag = 0`到单独的 .c 文件中并将该源文件添加到两个项目中

# twitter-bootstrap - 在窄版页面中隐藏按钮的标签

> ID：11784665
> 
> 赞同：1
> 
> 时间：2012-08-02T19:43:36.567
> 
> 标签：twitter-bootstrap, responsive-design

我正在开发新应用程序的响应版本，并认识到当页面显示在窄版本上时，按钮和下拉菜单`top navbar`会移动到其他项目下。

在这种情况下，我梦寐以求的情况只是替换即：

```
<a href="#"><i class="icon-flag"></i> Very long label of this button</a> 
```

和

```
<a href="#"><i class="icon-flag"></i></a> 
```

我可以使用“原始”引导程序实现这一目标吗？

我现在唯一的想法是将`jQuery`链接标签的可见性（即用跨度包装后）与`resize()`事件合并并切换

```
<a href="#">
  <i class="icon-flag"></i> <span>Very long label of this button</span></a> 
```

### 评论和结论的答案

虽然我之前没有指定它，但我的意图是保持自定义设置断点的可能性。这就是为什么我询问`narrow version`而不是询问`phone`,`tablet`和`desktop`选择器的原因。当然，在大多数情况下默认选择器是可以的，但是`media queries`给了我额外的灵活性，这是我需要的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:46:44.173

它可以通过默认[Bootstrap 的响应类](http://getbootstrap.com/2.3.2/scaffolding.html#responsive)来实现：

```
<a href="#"><i class="icon-flag"></i>
      <span class="hidden-phone">Very long label of this button</span></a> 
```

如果这不能满足您的需求，您可以根据需要`media queries`将标签设置`display:none;`为

```
<a class="target_el" href="#"><i class="icon-flag">
      </i><span>Very long label of this button</span></a>

@media only screen and (min-width:0px) and (max-width:320px)
{
    .target_el span { display:none; }
} 
```

否则你将不得不走 jQuery 路线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T22:26:21.063

您可以使用类`.hidden-phone`或`.visible-desktop`或`.visible-tablet`（查看[文档](http://twitter.github.com/bootstrap/scaffolding.html#responsive)）在特定分辨率下隐藏或显示任何元素。

`@media`由于提供了这些类，因此您真的不应该为此使用查询。

# javascript - 成功时的 AJAX 重定向覆盖其他逻辑

> ID：11784669
> 
> 赞同：0
> 
> 时间：2012-08-02T19:43:50.830
> 
> 标签：javascript, jquery, ajax, redirect

执行 AJAX 成功后，我似乎无法重定向到新页面（这是在 jQuery Mobile 的脚本中）。在以下代码中，如果我执行重定向以外的其他功能，则 sessionStorage 将按预期设置。进行重定向时，不会执行 sessionStorage 代码。建议？？

```
$("#register").click(function () {

    var formData = $("#registerUser").serialize();

    $.ajax({
        type: "POST",
        url: "file.php",
        //dataType:'json',
        cache: false,
        data: formData,
        //success: onSuccess,
        success: function (data) {
            if (data.status == 'success') {

                //execute some code here
                var someValue = (data.id);
                sessionStorage.setItem('someValue', someValue);

            } else if (data.status == 'error') $("#notification").text(data.message);
        },

        complete: function () {
            window.location.replace('newPage.html');
        }
    });

    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:47:29.023

你的成功和完成是矛盾的。两者都将在完成时执行。一会重定向。将重定向代码移动到成功状态以使其在执行其他操作后重定向。

```
success: function (data) {
    if (data.status == 'success') {

        //execute some code here
        var someValue = (data.id);
        sessionStorage.setItem('someValue', someValue);

        // redirect after success
        window.location.replace('newPage.html');

    } else if (data.status == 'error') {
        $("#notification").text(data.message);
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T15:12:48.810

我自己想出了这个——你必须使用 JQM 重定向：`$.mobile.changePage('newPage.html');`

```
success: function (data) {
    if (data.status == 'success') {

        //execute some code here
        var someValue = (data.id);
        sessionStorage.setItem('someValue', someValue);

        // redirect after success
        $.mobile.changePage('newPage.html');

    } else if (data.status == 'error') {
        $("#notification").text(data.message);
    }
} 
```

# java - Spring + c3p0 + postgres

> ID：11784674
> 
> 赞同：-1
> 
> 时间：2012-08-02T19:44:21.450
> 
> 标签：java, spring, hibernate, postgresql, c3p0

我正在使用 Spring 3.0.5.RELEASE 和 Postgres 9.1。我将最大连接数限制为 17：

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
  <property name="driverClass" value="${database.driver}" />
  <property name="jdbcUrl" value="${database.url}" />
  <property name="user" value="${database.username}" />
  <property name="password" value="${database.password}" />
  <property name="initialPoolSize" value="3" />
  <property name="minPoolSize" value="1" />
  <property name="maxPoolSize" value="17" />
</bean> 
```

当我的应用程序占用所有连接时，它只是挂起，不会取消或接受更多事务。Postgres 中的所有进程都处于“idle in transaction”状态。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:25:19.103

“事务中的空闲”意味着您启动了事务但从未提交或回滚它。确保在使用完所有语句后关闭它们。如果您打开的语句不明显，请修改您的 postgresql.conf 文件以使用以下设置记录查询的进程 ID：

```
log_line_prefix = '%p'
log_statement = 'all' 
```

当您重新加载 PostgreSQL 并检查日志文件时，您将能够看到挂在“事务中空闲”状态的连接发出的所有查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T22:21:22.930

您描述的症状与您的应用程序的泄漏连接一致。也就是说，您的应用程序正在签出连接，但未能将它们重新签入 [即，未能调用 close()]。

您是否一直在使用强大的资源清理习语？参见例如

[http://old.nabble.com/Re:-My-connections-are-all-idle...-p27691635.html](http://old.nabble.com/Re:-My-connections-are-all-idle...-p27691635.html)

正如该链接中所建议的，尝试临时设置一个 unreturnedConnectionTimeout 并使用
debugUnreturnedConnectionStackTraces 来追踪泄漏。看

[http://www.mchange.com/projects/c3p0/index.html#unreturnedConnectionTimeout](http://www.mchange.com/projects/c3p0/index.html#unreturnedConnectionTimeout)

[http://www.mchange.com/projects/c3p0/index.html#debugUnreturnedConnectionStackTraces](http://www.mchange.com/projects/c3p0/index.html#debugUnreturnedConnectionStackTraces)

我希望这有帮助！

# node.js - 使用 node.js 加载 index.html 并在 AngularJS 中从客户端接收数据

> ID：11784677
> 
> 赞同：0
> 
> 时间：2012-08-02T19:44:29.167
> 
> 标签：node.js, angularjs

好的，首先，我正在使用 AngularJS 和 node.js 构建一个 Web 应用程序。我的 AngularJS 部分非常好，但我似乎无法让服务器端按我想要的方式工作。我正在为我的项目使用 github ( [https://github.com/angular/angular-seed ) 的 angular-seed。](https://github.com/angular/angular-seed)该项目设置为 web-server.js 位于脚本文件夹中，而 index.html 位于 app 文件夹中。如果您需要查看 web-server.js 代码的外观，只需转到[https://github.com/angular/angular-seed/blob/master/scripts/web-server.js](https://github.com/angular/angular-seed/blob/master/scripts/web-server.js)

*   如何使用 node.js 获取 web-server.js 以使用 localhost:3000 处的 index.html 文件而不是 Web 应用程序的根目录？
*   我如何在服务器端向角度端发送和接收数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T15:54:53.807

这是一个 github 项目，专门为和你一样的人创建。

[https://github.com/ganarajpr/express-angular](https://github.com/ganarajpr/express-angular)

如果您不想要所有这些东西（ Bootstrap / OAuth ），您可以使用更简单的东西，例如[https://github.com/btford/angular-express-seed](https://github.com/btford/angular-express-seed)（这是 express-angular 的灵感）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:36:46.010

本例中的洛克：

[https://github.com/dalcib/angular-phonecat-mongodb-rest](https://github.com/dalcib/angular-phonecat-mongodb-rest)

# esb - 如何使用 Mule 显示和存储 HTTP 流的内容

> ID：11784678
> 
> 赞同：1
> 
> 时间：2012-08-02T19:44:29.370
> 
> 标签：esb, mule

我正在使用 MuleStudio 1.30，并且我有一个服务器（实际上是 gnip4j 附带的模拟服务器），它只流式传输具有以下模式的消息

> message_id
> 
> JSON 消息

并且 message_id 在自己的行上，而 JSON 在自己的行上。

基本上它是在模拟来自 Twitter 的流。

我做了教程，但我找不到任何关于如何从 HTTP 流中读取的文档。

我尝试使用 HTTP 和 Echo，但我认为这不起作用，因为 HTTP 响应实际上并没有完成，因为这是一个流。

我想做的是将消息回显到控制台并能够将其存储到磁盘。

# html - 为什么#wrapper 不是其中内容的全部高度？

> ID：11784680
> 
> 赞同：0
> 
> 时间：2012-08-02T19:44:35.050
> 
> 标签：html, css, wrapper

我似乎找不到此页面中缺少的内容以使包装器正确包装内容，由于某种原因，它只有 332px 高，而它应该是内容的高度。它导致页脚拉到顶部页面的...我错过了一个关闭的div还是什么，我需要新鲜的眼睛...

[http://tsdexter.com/tests/georgianhome/index.php](http://tsdexter.com/tests/georgianhome/index.php)

谢谢，托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:05:32.487

我相信您正在使用一些带浮动的 div 和一些没有浮动的 div，这可能会导致您看到的问题。

尝试放置这个：

```
<p style="clear: both; height: 1px;"><!-- --></p> 
```

就在包装器 div 关闭之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:02:14.753

更令人担忧的是您的页脚的行为方式。而且，我也无法确定您指的是哪个包装器。

# apache - 来自 Apache/OpenSSL 的 SSL 的间歇性 Firefox 和 Python 问题

> ID：11784683
> 
> 赞同：0
> 
> 时间：2012-08-02T19:44:50.153
> 
> 标签：apache, firefox, ssl, openssl

我们在 Windows 2008 R2 Enterprise 上使用 Apache 2.2.22。

我们的应用程序使用 SSL (OpenSSL) 并得到一个[有据可查的](https://groups.google.com/forum/?fromgroups#!topic/google-appengine-python/7gKkhhcLb7E) [错误](http://support.mozilla.org/en-US/questions/863107)，我还找不到修复程序[。](http://support.mozilla.org/en-US/questions/878171) 错误是有时仅在 Firefox 中，会发生这种情况：

![从 Firefox 看到的错误](../Images/b7df20c9ac965748c563792cac64a42e.png)

刷新（或点击“重试”）可修复错误，但这只是一种解决方法。

此外，尝试使用 Python 3 urllib.request 库进行连接会出现错误

```
urllib.error.URLError: <urlopen error [Errno 1] _ssl.c:392: error:1408E0F4:SSL routines:SSL3_GET_MESSAGE:unexpected message> 
```

我最好的猜测是这些是同一个问题，但我无法确定。

一个网站推荐了[nginx 的修复程序，](http://code.google.com/p/googleappengine/issues/detail?id=5075)但我不知道如何将其转换为 apache 的修复程序。我不是服务器管理专家，但我想我可以在这里找到一个。

很多人都有这个错误，所以我相信解决这个问题的人将成为互联网英雄！

编辑：

我在复制错误时遇到了问题，但我终于找到了运行 FF 13 的人。我没有得到任何好的调试信息，但我点击了“再试一次”大约 10 次，突然我得到了 200 OK 并且网站出现了。

同时，我在我的机器上运行 FF 13 和 FF 14（都尝试过），但它们都没有遇到问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:30:37.727

看起来[其他人已经找到了答案](http://www.anomalousanomaly.com/2009/05/15/firefox-3-openssl-woes/)，而我的 google-fu 让我失望了。

从网站：

“我终于发现 Firefox 在使用 TLS 1.0 协议时搞砸了。所以我所要做的就是编辑我的 Apache 2.2 httpd.conf 以拥有这一行：

```
SSLProtocol -SSLv2 +SSLv3 -TLSv1 
```

我不喜欢这个解决方案。Mozilla Firefox 团队应该发布一个静态链接到不受此错误影响的较新版本的 OpenSSL 库的 Firefox 构建。我更喜欢 TLS，因为它提供了额外的安全性，所以我最终选择了安全性而不是损坏的 SSL 库兼容性：

```
SSLProtocol -SSLv2 -SSLv3 +TLSv1 
```

另请注意，我也禁用了 SSL v2，因为众所周知它存在固有缺陷。”

编辑：我已将以下内容添加到我的 httpd-ssl.conf 文件中，并正在检查它是否有效：

```
BrowserMatch ^Mozilla SSLProtocol -SSLv2 +SSLv3 -TLSv1 
```

# javascript - 有没有办法判断图像 src 是否在 javascript 中返回 null？

> ID：11784687
> 
> 赞同：0
> 
> 时间：2012-08-02T19:44:59.447
> 
> 标签：javascript, image, dom

无论如何，javascript中是否有测试图像的src是否真的击中了真实文件？

我的想法是，在 DOM 构造的某个时刻，浏览器必须意识到文件位置没有返回真实文件，因为它默认为损坏的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:46:28.200

是的，您可以将[`onerror`](http://www.w3schools.com/jsref/event_img_onerror.asp)事件用于图像元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:48:25.097

我在我的库中为此事件使用的函数：

```
function onImageError (source) {
    //NOTE: Image Error function 
    //Useage: <img src="" onerror="onImgError(this)" />

    source.src = "/public/images/global/backup_product.jpg"; // location of sample/error image
    source.onerror = ""; // disable onerror to prevent endless loop
    return true;
} 
```

# ibm-mq - WebSphere MQ 创建远程队列

> ID：11784689
> 
> 赞同：3
> 
> 时间：2012-08-02T19:45:07.063
> 
> 标签：ibm-mq

为什么以下不创建本地队列定义？我看到一个名为 REMOTE_QUEUE 的远程队列定义？我是否需要为 LOCAL_QUEUE 创建另一个 DEFINE QLOCAL？

> 定义 QREMOTE (LOCAL_QUEUE) RNAME (REMOTE_QUEUE) RQMNAME(REMOTE_QUEUE_MANAGER) XMITQ(REMOTE_QUEUE_MANAGER) 替换

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:56:12.027

当您发出时，`DEFINE QREMOTE(LOCAL_QUEUE)`您正在创建一个路由条目，告诉 WMQ“任何时候*此*QMgr 上的某人打开一个名为`LOCAL_QUEUE`then 的队列，使用*这些*值作为队列名称、QMgr 名称，如果指定，则解析到此 XMitQ”。当您列出所有已定义的队列时会显示此条目，但它不是可以保存消息的队列。创建可以保存消息的队列的唯一方法是`DEFINE QLOCAL`.

下一步是定义消息可以到达的实际目标队列。在本地 QMgr 上定义 QRemote 不会同时在目标 QMgr 上定义 QLocal。为此，您需要使用 Explorer 登录目标 QMgr，或者在命令行上使用连接`runmqsc`并发出`DEFINE QLOCAL(REMOTE_QUEUE)`。

不幸的是，您的示例使用了类似的名称，`REMOTE_QUEUE`因为`REMOTE_QUEUE_MANAGER`它实际上是 QLocal。

仅供参考 - 完全不相关，但您可能需要考虑使用点作为名称分隔符，`REMOTE.QUEUE`而不是`REMOTE_QUEUE`因为 WMQ 将它们识别为节点分隔符并且授权通配符尊重它们。

# c++ - 两个参数都是默认的？

> ID：11784691
> 
> 赞同：-1
> 
> 时间：2012-08-02T19:45:10.787
> 
> 标签：c++

```
 void method( double code = 0, CQueue* = NULL). 
```

我在“.h”文件中定义了这个方法。在 .cpp 文件中，我在 ont 方法中分配代码的值（我希望队列在此处为空）并在另一种方法中为队列分配空值（此处代码必须为 0）具有两个参数的默认类型它在 C++ 中有效吗？有什么替代方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:46:11.523

这是完全有效的。这意味着 that`method();`等同于`method(0, NULL);`, 并且`method(x);`等同于`method(x, NULL);`and finally`method(x, y);`只是它自己。

要单独传递队列，您需要重载该函数（即拥有另一个同名但参数不同的函数）。像这样的东西：

```
void method(queue q)
{
    method(some-default-value, q);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:49:29.463

这是有效的。

一个问题：您可能希望将第一个参数用作默认值，将第二个参数用作非默认值。
在这种情况下，您需要手动提供第一个参数或使用重载

```
void method(queue x){
    method(0, x);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:50:30.143

在 C++ 中，您可以在一种情况下拥有尽可能多的默认参数：具有默认值的参数必须排在所有其他参数之后。

当您分配值时，它们将按照在函数原型中声明参数的顺序进行分配。

# c# - 插入时列表框项目消失/不显示

> ID：11784692
> 
> 赞同：1
> 
> 时间：2012-08-02T19:45:25.313
> 
> 标签：c#, winforms, visual-studio-2008, telerik

我正在两个列表框之间创建一个数据传输控件。我在两个框中都显示了项目，其中包含数据的文本和属性值。但是，当我从一个转移到另一个时，我可以访问转移的项目（使用调试）并查看 text 属性（不是 value 属性），但它没有显示在我发送到的列表框中。我什至尝试过刷新对象，但没有运气。

谁能告诉我我做错了什么？

```
private void btnToLeft_Click(object sender, EventArgs e)
    {
            Telerik.WinControls.UI.RadListDataItem item = new Telerik.WinControls.UI.RadListDataItem(lstRight.SelectedItem.DisplayValue.ToString(), lstRight.SelectedItem.Value);
            lstLeft.Items.Add(item);
            lstRight.Items.RemoveAt(lstRight.SelectedItem.RowIndex);
            lstLeft.Refresh();
            lstRight.Refresh();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:55:27.737

这是我用于类似情况的代码。

```
private void btnToLeft_Click(object sender, EventArgs e)
{
      if (lstRight.Items.Count == 0) { return; }
      if (lstRight.SelectedItem == null) { return; }

      RadListDataItem item = lstRight.SelectedItem;
      lstRight.Items.Remove(item);
      lstLeft.Items.Add(item);
} 
```

你可以像这样使它更通用一点。

```
private void MoveToTargetListBox(RadListControl sourceListBox, RadListControl targetListBox)
{
  try
  {
    if (sourceListBox.Items.Count == 0) { return; }
    if (sourceListBox.SelectedItem == null) { return; }

    RadListDataItem item = sourceListBox.SelectedItem;
    sourceListBox.Items.Remove(item);
    targetListBox.Items.Add(item);
  }
  catch (Exception ex)
  {
    //handle Exception
  }
}

private void btnToLeft_Click(object sender, EventArgs e)
{
  MoveToTargetListBox(lstRight, lstLeft);
}

private void btnToRight_Click(object sender, EventArgs e)
{
  MoveToTargetListBox(lstLeft, lstRight);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T13:13:57.363

我想我想通了。. . 我引用了 lstRight.SelectedItem.DisplayValue.ToString() 而不是文本值 - lstRight.SelectedItem.Text

似乎现在可以工作了。... ！

# macos - Mac OS X 上的 DBD::Pg - 没有找到任何方法

> ID：11784694
> 
> 赞同：0
> 
> 时间：2012-08-02T19:45:47.573
> 
> 标签：macos, perl, cgi-bin, dbd-pg

从命令行执行 .cgi （作为有权访问数据库的用户），我得到

> install_driver(Pg) 失败：在@INC 中找不到 DBD/Pg.pm（@INC 包含：/Library/Perl/5.12/darwin-thread-multi-2level /Library/Perl/5.12 /Network/Library/Perl/ 5.12/darwin-thread-multi-2level /Network/Library/Perl/5.12 /Library/Perl/Updates/5.12.4 /System/Library/Perl/5.12/darwin-thread-multi-2level /System/Library/Perl/ 5.12 /System/Library/Perl/Extras/5.12/darwin-thread-multi-2level /System/Library/Perl/Extras/5.12 .) at (eval 4) line 3\. 也许 DBD::Pg perl 模块没有已完全安装，或者“Pg”的大小写不正确。

cpan -D DBD::Pg 显示

> ## DBD::Pg
> 
> 已安装 DBI T/TU/TURNSTEP/DBD-Pg-2.19.2.tar.gz /opt/local/lib/perl5/site_perl/5.12.4/darwin-thread-multi-2level/DBD/Pg.pm 的 Postgres 驱动程序: 2.19.2 CPAN: 2.19.2 最新 DBD::Pg 开发人员 (DBDPG) dbd-pg@perl.org

尝试通过 PERL5LIB 或 PERLLIB 导出上述路径没有不同的结果。

.cgi 引用 /usr/bin/perl，它告诉

> 这是为 darwin-thread-multi-2level 构建的 perl 5，版本 12，subversion 4 (v5.12.4)（带有 2 个注册补丁，有关更多详细信息，请参见 perl -V）

我喜欢将模块路径永久设置为安装 DBD::Pg 的路径 (/opt/...)。我想知道为什么错误输出目录列表中没有提到这一点。

我通过 cpanm 安装了 DBD::Pg。

我使用 Mac OS X 山狮。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T21:21:51.757

您似乎安装了两个不同版本的 Perl。用于运行脚本的脚本与用于运行脚本的脚本不同`cpan`。要使用正确的 Perl 安装 DBD::Pg，请使用

```
perl -MCPAN -e'install DBD::Pg' 
```

如有必要，替换`perl`为用于运行脚本的 Perl 的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T20:13:03.027

/opt/... 表示“第 3 方”Perl。"which perl", "which cpan" 表明运行 capn 使用了第 3 方 Perl。那是MacPort的。当我使用 cpan 和 cpanm 安装时，第 3 方 Perl 得到了更新。以不同的用户身份执行并且 /usr/bin/perl shebang 指示要使用 Mac OS X perl。因为我必须使用 shebang 和不同的用户，所以我必须使用 Mac OS X perl。通过 /usr/bin/cpan DBD::Pg 显式添加模块会将模块安装到 Mac OS X Perl。现在我的 .cgi 运行了。切换到第 3 方 Perl 的替代方法是将 shebang 更改为“.../env perl”或在文件系统中使用别名。

# html - div的位置

> ID：11784698
> 
> 赞同：0
> 
> 时间：2012-08-02T19:46:04.547
> 
> 标签：html, css

嗨，这是我的 css 和 html 代码。有几个div。当浏览器大小最大时没有问题，但是当我将浏览器大小更改为较小时，div 位置发生了变化。例如：`<div id="cnrht"> id "cnrht" İçeriği Buraya Gelecek</div>`位于页面右侧，但当浏览器变小时，它将位于其他 div 下方和左侧。我该如何编辑它。

```
 <html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Başlıksız Belge</title>
<style type="text/css">

* {
margin: 0;
padding: 0;
}
html { height:100%;
width:100%;}
body {
font-family: Arial,Helvetica,sans-serif;
font-size: 75%;
line-height: 1.5em;
height:100%;
width:100%;

}
#wrapper {
    height: 100%;
    width: 100%;
    border: thin solid #F00;
    position: relative;
    visibility: visible;
    z-index: 1;
}
#container {
    border: thin dotted #006;
    z-index: 2;
    width: 100%;
}
#header {
    background-color: #993;
    clear: both;
    height: 100px;
    width: 100%;
}

#contain {
    background-color: #9F6;

    width: 100%;

}
#cnlft {
    background-color: #C69;
    padding: 10px;
    height: auto;
    width: 180px;
    float:left;
}
#cncnt {
    background-color: #F00;
    padding: 10px;
    width: 700px;
    height: auto;
    float:left;
}

#cnrht {
    background-color: #0FF;
    padding: 10px;
    float: left;
    width: 180px;
    height: auto;
}

.clr {clear:both;}
</style>
</head>

<body>
<div id="wrapper">
  <div id="container">
    <div id="header">id "wrapper" İçeriği Buraya Gelecek</div>
    <div id="contain">
      <div id="cnlft">id "contain" İçeriği Buraya Gelecek</div>
      <div id="cncnt"> id "cncnt" İçeriği Buraya Gelecek</div>
      <div id="cnrht"> id "cnrht" İçeriği Buraya Gelecek</div>
<div class="clr"></div>
    </div>
  </div>
</div>  
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:55:55.047

如何为包含元素添加最小宽度

```
#contain {
    background-color: #9F6;
    min-width: 1120px;/*sum of all the widths of its children*/
    width: 100%;
} 
```

[小提琴](http://jsfiddle.net/mowglisanu/E5MFm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:57:53.377

您必须以 px 为单位设置容器的宽度，或者以 % 为单位设置子元素的宽度。因为，当用户将浏览器窗口变小（或显示器分辨率）时，如果容器宽度用%表示，容器会减小，如果容器宽度用px表示，容器宽度不变，只会添加滑块窗口，因此用户现在必须滑动才能查看所有内容。

如果您希望一个元素自适应用户窗口（分辨率），则所有其他元素也必须自适应。

有 min-width CSS 属性，但它也会添加滑块，如果用户浏览器窗口（或分辨率）小于 min-width 值:)

# javascript - 设置 doctype 会破坏我的 css 和 javascript

> ID：11784702
> 
> 赞同：2
> 
> 时间：2012-08-02T19:46:17.040
> 
> 标签：javascript, html, css, doctype

它可以是任何 doctype、html5 或任何 html4。

具体来说，如果我不设置文档类型，一切都很好。如果我设置一个文档类型，颜色设置如下：

```
 #Engine {
    color:Sienna;
  }

  #Gameplay {
    color:Green;
  }

  #Art {
    color:Chocolate;
  } 
```

被忽略。其他一些标签也被忽略了，我认为主要与 id 有关。我可以将字体大小设置为与屏幕一样大，但没有任何反应。

css 使用 css 验证器通过了 ok，html 使用 html 验证器也是如此（*当*我插入 doctype 时，而不是之前）。

此外，通常运行顺利的 javascript，未能找到 jquery 节点的“偏移”方法......

在 chrome 和 firefox（最新版本）中效果相同。无论有没有文档类型，都不会在 Internet Explorer 中加载，但这是一个单独的主题......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:27:39.600

可能的原因是在您的标记中，您对`id`值的拼写与`id`选择器的拼写不同。如果您有标记，则该元素与“标准模式”`id="engine"`中的选择器不匹配。`#Engine`在怪癖模式下，它显然是。（这似乎适用于最新发布的 Chrome、Firefox 和 IE 版本。）

解决方案是确保在每次出现由`id`属性定义的标识符时使用完全相同的拼写。HTML 4.01 规范中的[定义`id`](http://www.w3.org/TR/html401/struct/global.html#adef-id)明确将其指定为区分大小写。

# javascript - 从字符串中删除 HTML（在 JSON 响应中）

> ID：11784703
> 
> 赞同：5
> 
> 时间：2012-08-02T19:46:17.547
> 
> 标签：javascript

```
var json = {
    "Item": {
        "Items": {
         "Body": "<SPAN style=\"LINE-HEIGHT: 115%; FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 11pt; mso-fareast-font-family: Calibri; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA\">\"We have all been inoculated with Christianity, and are never likely to take it seriously now! You put some of the virus of some dreadful illness into a man's arm, and there is a little itchiness, some scratchiness, a slight discomfort, disagreeable, no doubt, but not the fever of the real disease, the turning and the tossing, and the ebbing strength. And we have all been inoculated with Christianity, more or less. We are on Christ's side, we wish him well, we hope that He will win, and we are even prepared to do something for Him, provided, of course, that He is reasonable, and does not make too much of an upset among our cozy comforts and our customary ways. But there is not the passion of zeal, and the burning enthusiasm, and the eagerness of self-sacrifice, of the real faith that changes character and wins the world.\"<B>A.J. Gossip<\/B><\/SPAN>",
        },

    }
};
var someString = json.Item.Body.replace(/<br\s*\/?\s*>/g,"\n");   
alert(someString);
​ 
```

我`HTML`在回复中收到标签，我应该删除或解析它。我该怎么办呢。我为`BR`标签做了，但现在似乎还有其他标签也进来了。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-02T20:09:28.607

我认为您只需要一个简单的正则表达式即可从内容中去除 html 样式标签。尝试这个。

```
str.replace(/<\/?[^>]+>/gi, '') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:14:09.143

这应该有魔力[http://jsfiddle.net/Ygfvp/](http://jsfiddle.net/Ygfvp/) 无论如何它不会剥离 html 评论

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-23T02:25:11.027

如果您使用 React 映射 Json，那么您可以留下 html 标签并使用它们。

**代替：**

```
<div>{el.content.rendered}</div> 
```

**做这个：**

```
<div dangerouslySetInnerHTML={{__html: el.content.rendered}}></div> 
```

# drop-down-menu - webdriver 无法从 jQuery 选择菜单下拉菜单中进行选择

> ID：11784712
> 
> 赞同：0
> 
> 时间：2012-08-02T19:46:49.480
> 
> 标签：drop-down-menu, selenium, webdriver

我正在尝试从与 jQuery 插件调用 selectmenu 分层的下拉菜单中进行选择。我正在尝试使用 webdriver 从该下拉菜单中选择可见文本。

以下是页面来源

```
<body>
<form action="#">
<ul id="speedAa-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all ui-selectmenu-menu-popup" aria-labelledby="speedAa-button" role="listbox" aria-hidden="true" style="width: 147px; height: 150px; left: 107.65px; top: -74.6px;" aria-activedescendant="ui-selectmenu-item-106">
<ul id="speedB-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all ui-selectmenu-menu-popup" aria-labelledby="speedB-button" role="listbox" aria-hidden="true" style="width: 274px; left: 122.733px; top: 241.85px;" aria-activedescendant="ui-selectmenu-item-338">
<ul id="speedD-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-bottom ui-selectmenu-menu-dropdown" aria-labelledby="speedD-button" role="listbox" aria-hidden="true" style="width: 400px; left: 122.733px; top: 557.75px;" aria-activedescendant="ui-selectmenu-item-970">
<ul id="files-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all ui-selectmenu-menu-popup" aria-labelledby="files-button" role="listbox" aria-hidden="true" style="width: 147px; left: 93.65px; top: 571.2px;" aria-activedescendant="ui-selectmenu-item-310">
<ul id="filesC-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all ui-selectmenu-menu-popup" aria-labelledby="filesC-button" role="listbox" aria-hidden="true" style="width: 147px; left: 93.65px; top: 779.1px;" aria-activedescendant="ui-selectmenu-item-343">
<ul id="filesB-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all customicons ui-selectmenu-menu-popup" aria-labelledby="filesB-button" role="listbox" aria-hidden="true" style="width: 147px; left: 93.65px; top: 750.65px;" aria-activedescendant="ui-selectmenu-item-376">
<div style="position: absolute; top: 20px; right: 10px;">
<div style="position: absolute; float: left; font-family: Trebuchet MS,Verdana,sans-serif; font-size: 12px; background: none repeat scroll 0% 0% rgb(0, 0, 0); color: rgb(255, 255, 255); padding: 8px 3px 3px; border-width: 0px 1px 1px; border-style: none solid solid; border-color: -moz-use-text-color rgb(204, 204, 204) rgb(204, 204, 204); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; -moz-border-image: none; z-index: 999999; width: 144px; display: none;">
<ul id="speedA-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-all ui-selectmenu-menu-popup" aria-labelledby="speedA-button" role="listbox" aria-hidden="true" style="width: 147px; left: 107.65px; top: 105.95px;" aria-activedescendant="ui-selectmenu-item-35">
<ul id="speedC-menu" class="ui-selectmenu-menu ui-widget ui-widget-content ui-corner-bottom ui-selectmenu-menu-dropdown ui-selectmenu-open" aria-labelledby="speedC-button" role="listbox" aria-hidden="false" style="width: 173px; left: 107.65px; top: 450.3px;" aria-activedescendant="ui-selectmenu-item-391">
<li class="whoo" role="presentation">
<li class="" role="presentation">
<li class="ui-selectmenu-item-selected ui-selectmenu-item-focus ui-state-hover" role="presentation">
**<a id="ui-selectmenu-item-391" aria-selected="true" role="option" tabindex="-1" href="#">Medium</a>**
</li>
<li class="" role="presentation">
<li class="ui-corner-bottom" role="presentation"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T04:09:55.243

您可以使用 chrome 开发工具并尝试获取 xpath，或者右键单击您想要的元素并检查它，您将看到它在 DOM 上的位置。

# php - DOT 验证器使用 if (eregi

> ID：11784715
> 
> 赞同：0
> 
> 时间：2012-08-02T19:47:03.030
> 
> 标签：php, forms, eregi

是否可以在电子邮件表单中使用点`.`检查器，这样如果特定字段有一个点，那么这将告诉用户不要在这些字段中放置点。我试过这个但不起作用：

```
if (eregi('.', $notes)) {
    die ("Do NOT PUT DOT HERE");
} 
```

那么，知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:54:50.050

正如手册所说：

> 提示：如果您只想检查一个字符串是否包含在另一个字符串中，请不要使用 preg_match()。请改用 strpos() 或 strstr() ，因为它们会更快。

这是 strpos() 方法：

```
<?php

$findme   = '.';
$pos = strpos($notes, $findme);

if ($pos !== false) {
     echo "Do NOT PUT DOT HERE";
} else {
     //other
}

?> 
```

在大多数情况下，我不会推荐 die\exit 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:51:08.840

```
if (preg_match('~\.~', $notes)) {
  // Do something useful
} 
```

# cocoa - 本地化编辑菜单和其他标准菜单

> ID：11784716
> 
> 赞同：11
> 
> 时间：2012-08-02T19:47:07.530
> 
> 标签：cocoa, localization

我正在尝试将我的 Mac 应用程序翻译成几种不同的语言。有大量菜单项，特别是在编辑菜单中，由 OS X 提供并自动运行。我认为这些项目也会自动翻译，但似乎没有。正如您在下面的屏幕截图中看到的那样，我得到了已翻译和未翻译项目的混合。

![编辑菜单，部分本地化](../Images/e86c792cced2c575917296aa74e50cc1.png)

奇怪的是，当它们出现在上下文菜单中时，相同的菜单项会被翻译，例如在 NSTextView 中。在这种情况下，除了底部的两个服务之外，所有内容都会自动翻译。

![上下文菜单，自动翻译](../Images/64703256091f163dbb34132d8463fb13.png)

所以我很困惑：我真的必须自己翻译编辑菜单吗？我显然希望我的翻译与苹果的翻译相匹配，所以我会做大量的复制和粘贴。或者有什么秘诀可以让本地化发挥作用？我的应用程序需要 10.7 或更高版本，所以如果有任何新的东西可以让这更容易，那应该不是问题。

**附录：**假设没有更简单的方法可以做到这一点，是否至少有一种简单的方法可以复制 Apple 翻译的文本，以便我可以将它们粘贴到我的应用程序中？我在想我可以从他们的一个应用程序中打开一个 NIB，但它们都已编译，无法在 Xcode 中打开。我可以在文本编辑器中打开它们，但尝试以这种方式找到合适的字符串似乎并不比重新键入所有内容更快。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-12-04T18:09:14.560

[本地化 Nibs](http://mattgemmell.com/source/)包含*MainMenu.nib*文件，菜单栏预先本地化为各种语言。所有项目都与适当的操作相关联，并且包括一些附加资源（例如标志图形、ISO 语言表等）。

[localize-mainmenu](https://github.com/maremmle/localize-mainmenu) - 自动本地化 OS X 应用程序的常用主菜单项的命令行工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T18:53:19.433

**更新：**

感谢[Douglas Hill 的这篇有用的帖子，](https://douglashill.co/localisation-using-apples-glossaries/)我了解到实际上有一个适当的解决方案。[Apple 维护了一个词汇表列表，](https://developer.apple.com/download/more/?=Glossaries)其中包含大量使用的字符串。它们是为名为 AppleGlot 的命令行工具设计的，但它们也可以在文本编辑器中打开。[Apple 的国际化页面](https://developer.apple.com/internationalization/)包含这些工具的链接。[使用 AppleGlot 本地化字符串文件](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPInternational/MaintaingYourOwnStringsFiles/MaintaingYourOwnStringsFiles.html)包括一些关于如何使用 AppleGlot 的信息——尽管目前该应用程序的安装程序有一个过期的证书，而且无论如何它似乎与 Catalina 不兼容。Douglas Hill 的帖子提供了一些关于如何自动化翻译过程的替代想法。

* * *

**原答案：**

据我所知，确实没有简单的方法可以做到这一点。特别是对于日语，我最终使用了这样的过程：

1.  在 Finder 中，右键单击现有应用程序，例如 TextEdit，然后选择“显示包内容”

2.  在包内，转到 Contents/Resources，您将看到本地化文件夹，如 en.lproj 和 Japanese.lproj

3.  在这些文件夹中，您将看到 NIB 文件。使用纯文本编辑（如 BBEdit），打开您的主要语言和您想要翻译的语言的主 NIB 文件。在许多情况下，您想要的文件将命名为 MainMenu.nib。使用 TextEdit，文件被命名为 Edit.nib。这些文件是 XML，所以它们的结构清晰，但是有很多东西你并不关心。打开这两个文件会更容易。

4.  在英文文件中，您可以搜索“立即检查文档”之类的内容。紧随其后的是键盘快捷键 (;) 和菜单项调用的方法 ( `checkSpelling:`)。现在您可以在日文文件中搜索 checkSpelling，您需要的翻译就在它的正上方。这听起来很乏味，但我发现它大部分时间都很快，特别是因为你很少需要完全输入所有内容来找到你需要的东西。许多方法名称也很明显——比如`cut:` `paste:` `copy:`等等，所以你可以先跳过检查英文文件。

5.  子菜单的菜单项有点棘手，因为方法只是`submenuAction:`. 您可以使用周围的 XML 来帮助验证您在两个 NIB 中查看的是相同的内容，或者您​​可以检查应用程序本身以确保您查看的是正确的文本。当我想确保我复制了正确的东西时，谷歌翻译也很有帮助。您甚至可以先尝试使用 Google 翻译，然后验证它是否与 Apple 使用的相匹配。

显然，您需要非常小心，或者让会说该语言的人验证一切是否按预期工作。最好让翻译完成所有工作。就我而言，我已经让人们自愿进行翻译，并且我的应用程序独有的所有文本都已翻译。我不想打扰他们翻译一堆其他人已经翻译过的文本的繁琐工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-03-08T12:05:04.993

我发现 Martin Stemmel 的 git 项目很有用（仅供参考：我与作者有联系）。它是免费的，您可以简单地浏览各种语言文件以获取您需要的标准主菜单字符串或使用该项目。

[https://github.com/martnst/localize-mainmenu](https://github.com/martnst/localize-mainmenu)

# regex - 正则表达式：在 EOL 忽略 +（加号）？

> ID：11784718
> 
> 赞同：2
> 
> 时间：2012-08-02T19:47:16.090
> 
> 标签：regex, grep, code-analysis

我正在尝试通过*大量*旧 AS/400 代码（CL、COBOL 等）进行 grep。在某些情况下，命令会用`+`符号“包装”到下一行。您实际上可以在标识符中间有一个中断，然后在下一行继续。

例如：

```
SELECT * FROM LIBR+
ARY/FILE 
```

但是同样的代码可以这样写（这个中断可以在任何地方）：

```
SELECT * FROM LI+
BRARY/FILE 
```

在这种情况下，我希望使用 grep`'LIBRARY\/'`来查找该标识符。

使用正则表达式忽略换行符很容易，但是我该如何忽略`+`呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T22:56:00.963

`sed`使用and的一种方法`grep`：

```
< file.txt sed ':a;N;$!ba; s/+\n//g' | grep "LIBRARY/" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:57:29.290

如果您可以忽略新行，则可以忽略加号后跟新行；）考虑将加号转义为正则表达式字符。

# php - PayPal 定期付款 - 模拟登录以进行测试

> ID：11784725
> 
> 赞同：0
> 
> 时间：2012-08-02T19:47:48.233
> 
> 标签：php, paypal, recurring

我正在使用 PayPal 定期付款 API。我想知道是否可以在沙箱上进行“模拟”登录以进行测试，以便在“SetExpressCheckoutDetails”和“GetExpressCheckoutDetails”API 调用之后进行测试例程。我正在使用 PHP SDK。

TIA

# mongodb - Mongoid 3 - 访问 map_reduce 结果

> ID：11784727
> 
> 赞同：2
> 
> 时间：2012-08-02T19:47:56.373
> 
> 标签：mongodb, mongoid, ruby-on-rails-3.2

在 mongoid 2 中，这曾经有效：

```
mr_collection = self.collection.map_reduce(map, reduce, {
  :query => query,
  :finalize => finalize,
  :out => {:replace => 'mr_results'}
})

limit = (options[:limit] || 10)
skip = (options[:skip].to_i || nil)
page = if skip >= limit
  ((skip+limit) / limit)
else
  1
end

sort = if options[:sort_by_vintage]
  [['value.vy', :desc], ['value.s', (options[:sort] || :desc)], ['value.pml', :asc]]
elsif options[:sort_by_sDate]
  [['value.sDate', :desc], ['value.s', (options[:sort] || :desc)], ['value.pml', :asc]]
else
  [['value.s', (options[:sort] || :desc)], ['value.pml', :asc]]
end
paginator = WillPaginate::Collection.new(page, limit, collection_count)
collection = mr_collection.find({},{
    :sort => sort,
    :limit => limit,
    :skip => skip
  }
).to_a 
```

我已将 map_reduce 调用更新为：

```
mr_collection = self.where(query).map_reduce(map, reduce).finalize(finalize).out({:replace => 'mr_results'}) 
```

这不再产生任何错误，但是无论我尝试什么， collection = mr_collection.find.... 总是失败。以下是一些尝试：

```
(rdb:1) mr_collection.find.sort(sort) 
```

这会产生 .rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/debug.rb:130:in `eval': 参数数量错误（1 代表 0）

我可以看到 (rdb:1) mr_collection.class Mongoid::Contextual::MapReduce

```
(rdb:1) mr_collection.find.class
Enumerator 
```

尝试： (rdb:1) mr_collection.sort(sort) .rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/debug.rb:130:in `eval': 参数数量错误（ 1 为 0) 所以同样的错误

谢谢你的帮助

## 更新

通过使用修复它：

```
collection = mr_collection.find(
    :sort => sort,
    :limit => limit,
    :skip => skip
 ) 
```

我现在的问题是使用 collection.to_a，我知道它适用于常规哈希，但集合中的结果是 Moped::BSON::Document 类型。在集合上调用任何 Enumerator 方法，都会导致此错误：

```
undefined method `call' for #<Hash: 
```

我要疯了。请帮忙！！

所以我尝试过的事情包括：

```
collection = collection.each {|c| c.to_hash}.to_a 
```

和

```
collection = collection.collect {|c| c.to_hash}.to_a 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T21:39:02.120

多亏了 Mongoid google 小组，终于弄明白了。详细信息：[https ://groups.google.com/d/topic/mongoid/T6XhqLtofTE/discussion](https://groups.google.com/d/topic/mongoid/T6XhqLtofTE/discussion)

一个班轮修复是：

```
collection = mr_collection.send(:documents).sort(sort).limit(limit).skip(skip).to_a 
```

在即将发布的 mongoid 版本中，Mongoid::Contextual::MapReduce#documents 将从私有方法更改为公共方法，并且不再需要 .send(:documents)。

# java - Hadoop：java.lang.ClassCastException：org.apache.hadoop.io.LongWritable 不能转换为 org.apache.hadoop.io.Text

> ID：11784729
> 
> 赞同：25
> 
> 时间：2012-08-02T19:48:04.487
> 
> 标签：java, hadoop, mapreduce

我的程序看起来像

```
public class TopKRecord extends Configured implements Tool {

    public static class MapClass extends Mapper<Text, Text, Text, Text> {

        public void map(Text key, Text value, Context context) throws IOException, InterruptedException {
            // your map code goes here
            String[] fields = value.toString().split(",");
            String year = fields[1];
            String claims = fields[8];

            if (claims.length() > 0 && (!claims.startsWith("\""))) {
                context.write(new Text(year.toString()), new Text(claims.toString()));
            }
        }
    }
   public int run(String args[]) throws Exception {
        Job job = new Job();
        job.setJarByClass(TopKRecord.class);

        job.setMapperClass(MapClass.class);

        FileInputFormat.setInputPaths(job, new Path(args[0]));
        FileOutputFormat.setOutputPath(job, new Path(args[1]));

        job.setJobName("TopKRecord");
        job.setMapOutputValueClass(Text.class);
        job.setNumReduceTasks(0);
        boolean success = job.waitForCompletion(true);
        return success ? 0 : 1;
    }

    public static void main(String args[]) throws Exception {
        int ret = ToolRunner.run(new TopKRecord(), args);
        System.exit(ret);
    }
} 
```

数据看起来像

```
"PATENT","GYEAR","GDATE","APPYEAR","COUNTRY","POSTATE","ASSIGNEE","ASSCODE","CLAIMS","NCLASS","CAT","SUBCAT","CMADE","CRECEIVE","RATIOCIT","GENERAL","ORIGINAL","FWDAPLAG","BCKGTLAG","SELFCTUB","SELFCTLB","SECDUPBD","SECDLWBD"
3070801,1963,1096,,"BE","",,1,,269,6,69,,1,,0,,,,,,,
3070802,1963,1096,,"US","TX",,1,,2,6,63,,0,,,,,,,,,
3070803,1963,1096,,"US","IL",,1,,2,6,63,,9,,0.3704,,,,,,,
3070804,1963,1096,,"US","OH",,1,,2,6,63,,3,,0.6667,,,,,,, 
```

在运行此程序时，我在控制台上看到以下内容

```
12/08/02 12:43:34 INFO mapred.JobClient: Task Id : attempt_201208021025_0007_m_000000_0, Status : FAILED
java.lang.ClassCastException: org.apache.hadoop.io.LongWritable cannot be cast to org.apache.hadoop.io.Text
    at com.hadoop.programs.TopKRecord$MapClass.map(TopKRecord.java:26)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:764)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:370)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
    at org.apache.hadoop.mapred.Child.main(Child.java:249) 
```

我相信类类型映射正确， [类映射器](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapreduce/Mapper.html)，

请让我知道我在这里做错了什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-02T20:21:01.287

当您使用 M/R 程序读取文件时，映射器的输入键应该是**文件中行的索引**，而输入值将是整行。

所以这里发生的事情是你试图将行索引作为一个`Text`错误的对象，你需要一个`LongWritable`相反的对象，这样 Hadoop 就不会抱怨类型。

试试这个：

```
public class TopKRecord extends Configured implements Tool {

    public static class MapClass extends Mapper<LongWritable, Text, Text, Text> {

        public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
            // your map code goes here
            String[] fields = value.toString().split(",");
            String year = fields[1];
            String claims = fields[8];

            if (claims.length() > 0 && (!claims.startsWith("\""))) {
                context.write(new Text(year.toString()), new Text(claims.toString()));
            }
        }
    }

    ...
} 
```

您可能还需要重新考虑代码中的一件事，即您正在`Text`为正在处理的每条记录创建 2 个对象。您应该只在开始时创建这两个对象，然后在您的映射器中使用该`set`方法设置它们的值。如果您正在处理大量数据，这将为您节省大量时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-30T05:18:29.203

你需要设置输入格式类

```
job.setInputFormatClass(KeyValueTextInputFormat.class);
job.setOutputFormatClass(TextOutputFormat.class); 
```

# asp.net - 在 Web.Config 外部的文件中加密 AppSettings

> ID：11784730
> 
> 赞同：12
> 
> 时间：2012-08-02T19:48:07.587
> 
> 标签：asp.net, web-config

我目前使用这种方法来加密我的应用程序 web.config 文件的 AppSettings 部分：`aspnet_regiis.exe -pe "appSettings" -site "MySite" -app "/"`

但是现在我已经使用该元素将一些设置移到另一个文件中

```
<appSettings file="IndividualAppSettings.config" > 
```

我仍然可以加密 web.config 中的应用程序设置，但是有什么方法可以加密附加的 IndividualAppSettings.config 文件的内容吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T19:56:39.097

当我们为每个环境使用外部文件时，我们一直这样做。

首先，您的`appSettings`元素需要如下所示：

```
<appSettings configSource="IndividualAppSettings.config" /> 
```

接下来，我们使用以下命令从 cmdline 调用加密：

```
aspnet_regiis -pe "appSettings" -prov "{0}" -site {1} -app "/" 
```

在哪里：

*   `{0}`是在 web.config 中指定的加密提供程序的名称。
*   `{1}`是您的站点在 IIS 中的 ID

# ruby-on-rails - Rails 用“<<<<<< HEAD”弄乱了我的代码

> ID：11784734
> 
> 赞同：2
> 
> 时间：2012-08-02T19:48:40.570
> 
> 标签：ruby-on-rails, git

我最近发现 rails 或其他一些实体通过将“<<<<<<< HEAD”放在整个地方弄乱了我的代码。这是它的外观示例：

```
Class ExampleController
  def foo
    bar = 1
<<<<<<< HEAD
    if bar == 1
      puts "bar is one"   
    else
      puts "bar is not one"
    end
=======
  if bar == 2
    puts "bar is two"
  else
    puts "bar is not two"
  end
>>>>>>> 17fb60436a4de2e0...
  end
end 
```

有谁知道它为什么会这样？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T19:50:43.767

是的，您或其他人正在使用 GIT 对这些源进行版本控制，这很好。

现在你必须知道如何解决冲突！

[如何解决 Git 中的合并冲突？](https://stackoverflow.com/questions/161813/how-do-i-fix-merge-conflicts-in-git)

如果您是使用 git 的人，请在拉取代码时小心。如果某处写有 CONFLICT，请停止！然后使用`git mergetool`或浏览与冲突有关的每个文件的列表并手动编辑它们。

冲突代码用`<<<<<<`和标记。你必须合并它`========``>>>>>>>`

# c++ - C++：搜索并写入文件以替换字符串

> ID：11784735
> 
> 赞同：0
> 
> 时间：2012-08-02T19:48:43.450
> 
> 标签：c++, file, io

所以我创建了一个简单的测试应用程序。它的目的是读取或写入文本文件。它正在寻找字符串“固件：”。这个想法是设备将有一个包传输到它并存储，然后激活。我想存储该包的名称（例如：Update1），当我需要时，查询它并取回包名（从文件中读取）。

**问题 1：**它似乎没有写入文件。 **问题2：**当我让它写入文件时，如果存在“Firmware：pkgName”行，我如何将pkgName替换为新的包名？

该程序可以运行和编译，因此请随意将其放入 IDE 或文本编辑器中，但它并不能完全满足我的要求。我使用 log.txt 作为我的示例文件来读取。我确信有一种更简单的方法可以做到这一点。我已经有一段时间了，我已经被难住了。

谢谢您的帮助！

```
#include <cstdlib>
#include <iostream>
#include <string>
#include <fstream>

using namespace std;

int writeFile(string filename, string pkgName);
int readFile(string filename);

int main(void) {
    string filename = "log.txt", userInput, pkgName;
    system("touch log.txt");

    while (true) {
        cout << "Write or Read?\n>>>";
        cin >> userInput;

        if (userInput == "Write") {
            cout << "What's your package name?\n>>>";
            cin >> pkgName;
            writeFile(filename, pkgName);
        } else if (userInput == "Read") {
            readFile(filename);
        } else {
            cout << "Invalid Input";
        }
    }
}

int writeFile(string filename, string pkgName) {
    bool found, exists = true;
    string line, word;
    fstream firmwareFile;
    int pos, size, num = 1;
    firmwareFile.open(filename.c_str(), ios::in | ios::out | ios::app);
    //firmwareFile << "This is a test.";
    if (firmwareFile.is_open()) {
        while (!found) {
            getline(firmwareFile, line);
            pos = line.find("Firmware: ");
            if (pos != string::npos) {
                //Found It
                found = true;
                exists = true;
                size = line.size();
                word = line.substr(10, ((size - pos) + 10));
                cout << word << " is the old package name" << endl;
                //TODO - Replace that with the new package name
                firmwareFile.close();
            } else if (firmwareFile.eof()) {
                //Doesn't Exist
                found = true;
                exists = false;
                cout << "No last firmware package available.\n";
            } else {
                //Still Looking
                found = false;
                cout << "Searching line #" << num <<  endl;
            }
            num++;
            if (!exists) {
                firmwareFile << endl << "Firmware: " << pkgName << endl;
                cout << "Wrote package name to file\n" << endl;
            }
            firmwareFile.close();
        }   
    } else {
        cout << "Unable to open file";
    }
}

int readFile(string filename) {
    bool found;
    string line, word;
    fstream firmwareFile;
    int pos, size, num = 1;
    firmwareFile.open(filename.c_str(), ios::in | ios::out | ios::app);
    if (firmwareFile.is_open()) {
        while (!found) {
            getline(firmwareFile, line);
            pos = line.find("Firmware: ");
            if (pos != string::npos) {
                found = true;
                size = line.size();
                word = line.substr(10, ((size - pos) + 10));
                cout << word << endl;
            } else if (firmwareFile.eof()) {
                found = true;
                cout << "No last firmware package available.\n";
                firmwareFile << endl << "Firmware: ";
            } else {
                cout << "Searching line #" << num << endl;
            }
            num++;
        }
        firmwareFile.close();
    } else {
        cout << "Unable to open file";
        firmwareFile.close();
    }
    firmwareFile.close();
} 
```

这是我的 log.txt 文件的内容（除了包含“固件：”的行之外的所有内容都是微不足道的）

```
You
Think
It's
Here
But
It's
Not
So
That
Sucks
Doesn't
It
?
Firmware: Update1
I
Hope
You
Caught
It
! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:57:03.997

出色地。第一个问题，在您的函数写入文件中，您有一个变量`found`，您可以在一段时间内对其进行测试`while (!found) { ... }`。问题是当你第一次测试这个变量时，你还没有将它设置为任何值。所以你在那里有未定义的行为。查看其余代码，我认为您应该使用 do while 循环而`do { ... } while (!found);`不是 while 循环。看起来你在 readFile 中也有同样的问题。

第二个问题恐怕是坏消息。您不能替换文件中的字符串，除非您使用长度完全相同的字符串进行替换。这只是文件在磁盘上组织方式的限制。实现替换的唯一方法是将整个文件读入内存，在内存中进行替换，然后将整个文件写回磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:58:10.483

@jrok 回答了您的问题 2，但我怀疑您的代码并非每次都编写，因为 found 未初始化，因此未定义，因此一半时间（大约）您的 while 循环根本不会执行。您需要初始化 found 和 exists ，例如：`bool found = false, exists = true;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:12:12.310

如果您编写另一个仅更改相关行的文件，则可以简化事情：

```
std::ifstream cfg("log.txt");
std::ofstream tmp("log.tmp");
std::string line;
std::string pkgName;

while(std::getline(cfg, line)) {
    if (line.find("Firmware:") != std::string::npos) {
        line = "Firmware: " + pkgName; 
    }
    tmp << line << '\n';
} 
```

现在，重命名和删除文件是特定于平台的。如果您想要一个可移植的解决方案，我建议您查看 Boost Filesystem 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T20:05:44.253

如果您必须替换文件的内容（不删除另一个文件并将其重命名为其名称），那么您需要读入整个文件，对内存中的文件进行必要的更改，然后写出内存文件的全部内容到磁盘文件，覆盖它。

如果允许您删除源文件，则执行这些转换会容易得多。你只需要读入你的源文件，打开一个临时文件并写出它，随时进行你需要的任何更改。处理完源文件后，将其删除，并将新文件重命名为与原始源文件相同的名称。

# java - 在服务器上更新 java

> ID：11784737
> 
> 赞同：0
> 
> 时间：2012-08-02T19:49:04.580
> 
> 标签：java

如果网站是用 Java 编写的，服务器如何处理 Java 更新，管理员是否需要在更新期间使网站脱机。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:52:18.867

通常的做法是所谓的滚动更新。该站点由负载平衡器后面的多个服务器处理。在更新一个系统时，其他系统必须分担负载。

默认情况下更新不是自动的，但肯定可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:52:02.020

更新不是自动的，也不是必需的。如果这样做，在更新期间停止应用程序服务器可能更安全。

# jquery - jQuery动画回调按顺序触发

> ID：11784744
> 
> 赞同：0
> 
> 时间：2012-08-02T19:49:26.683
> 
> 标签：jquery, jquery-animate, jquery-callback

我正在创建一个 UI 组件，其中的目标元素在单击时会触发一系列动画。动画应该是按顺序发生的：点击目标元素（targetEl），一个透明的覆盖层淡入目标元素（覆盖层），另一个div在覆盖层（slideover）上向下滑动，slideover有一个关闭图标，当关闭单击图标 上一个动画反向发生（幻灯片向上滑动，叠加淡出）。

我的问题是：我正在使用嵌套的 .on("click") 和动画调用。动画在最初的几次点击中完美运行，但在第 3 次或第 4 次点击时表现异常。覆盖将快速淡入/淡出，您根本看不到幻灯片动画。我认为正在发生的事情是动画以某种方式失序。

这是我的 JS/jQuery：

```
$(targetEl).on("click", function() {

     $(overlay).on("click", function(e){e.stopPropagation();});

     $(overlay).fadeIn("slow", function(){
         $(slideover).animate({"top":targetEl.height()/3}, 1000);
     });

     $("#close").on("click", function(e){
          e.stopPropagation();

          $(slideover).animate( {
                "top":'-'+targetEl.height()/3}, 1000, function({
                         $(overlay).fadeOut("slow");
                });
          });
      }); 
```

我使用 stopPropagation 是因为 slideover 是 overlay 的子元素，它是 targetEl 的子元素，我不希望对子元素的点击“落入”父元素。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:16:19.633

每次基于（targetEL）单击制作动画时，您都将新事件绑定到覆盖单击和#close 元素。

这可能是它看起来如此奇怪的原因。

在 targetEL 单击触发**之前**执行这些绑定。

# jquery - 为复选框标签设置颜色

> ID：11784751
> 
> 赞同：2
> 
> 时间：2012-08-02T19:49:53.910
> 
> 标签：jquery, checkbox, colors, label

我想为“结帐时包括上述项目”这句话做上述主题。当我通过 Firebug 进行调试时，脚本中的正确行被命中，但颜色永远不会改变。

有人可以告诉我有什么问题吗？

**HTML**

```
<td colspan="7" valign="middle" align="left" class="underline" style="line-height: 20px;padding: 0; color: #fff;">
    <span class="eg_checkbox" style="font-weight:bold;">
        <input id="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit" type="checkbox" name="ctl00$mainContentPlaceHolder$datalistDTO$ctl01$chkShiptoSubmit" checked="checked" onclick="javascript:setTimeout('__doPostBack(\'ctl00$mainContentPlaceHolder$datalistDTO$ctl01$chkShiptoSubmit\',\'\')', 0)"/>
        <label for="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit">Include items above during check out</label>
    </span>
</td> 
```

JS

```
$(document).ready(function () {
    if ($('#ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit').is(':checked')) {
        $('label[for=#ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit]').css('color', 'red');
    }
    else {
        $('label[for=#ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit]').css('color', 'blue');
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:59:48.643

您不应该`#`在属性选择器中使用符号，而不是多次选择元素，您可以缓存选择器并使用`next()`选择下一个元素的方法。尝试以下操作：

```
$(document).ready(function () {
    var $checkbox = $('#ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit'); 
    if ($checkbox.is(':checked')) {
        $checkbox.next('label').css('color', 'red');
    }
    else {
        $checkbox.next('label').css('color', 'blue');
    }
}); 
```

[演示](http://jsfiddle.net/fCc9C/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T19:58:12.843

您的 jquery 中的“for”选择器错误：

```
$(document).ready(function() {
    if ($('#ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit').is(':checked')) {
        $('label[for="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit"]').css('color', 'red');
    }
    else {
        $('label[for="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit"]').css('color', 'blue');
    }
});​ 
```

[**演示**](http://jsfiddle.net/Daedalus/zAVG5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T20:13:59.650

是你的`#`。检查这个[jsFiddle](http://jsfiddle.net/jjay225/EtZYt/17/)

注意`for=ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T20:02:31.533

[http://jsfiddle.net/NbVUm/](http://jsfiddle.net/NbVUm/)

html:

```
<table><tr>
<td colspan="7" valign="middle" align="left" class="underline"
    style="line-height: 20px; padding: 0; color: #fff;">
  <span class="eg_checkbox" style="font-weight:bold;">
    <input id="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit"
      type="checkbox"
      name="ctl00$mainContentPlaceHolder$datalistDTO$ctl01$chkShiptoSubmit"
      checked="checked" />
    <label for="ctl00_mainContentPlaceHolder_datalistDTO_ctl01_chkShiptoSubmit">
      Include items above during check out
    </label>
  </span>
</td>

</tr></table> 
```

js：

```
$(function()
{
  var cb = $(':checkbox');
  cb.change(on_cb_changed);

  on_cb_changed();

  function on_cb_changed()
  {
    var label = cb.next('label');

    label.css('color', cb.is(':checked') ? 'red' : 'blue');
  }
}); 
```

# php - 使用 CodeIgniter 的 BDD/TDD

> ID：11784752
> 
> 赞同：1
> 
> 时间：2012-08-02T19:50:00.163
> 
> 标签：php, unit-testing, tdd, bdd, codeigniter-2

我最近加入了一家使用 codeigniter 的公司。我一直在使用 nodejs 和 rails，所以我觉得我缺少 BDD 之类的工具（rspec/jasmine/mocha）。PHP 和/或 CodeIgniter 是否有任何类型的基于 CLI 的测试套件。如果是这样，我应该如何构建我的应用程序？有什么好的约定可以遵循吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:00:10.033

有一个名为 CIUnit 的项目，它将 phpunit 集成[到](http://www.phpunit.de/manual/3.6/en/writing-tests-for-phpunit.html)codeigniter 并提供了一些有用的功能，并使其成为一种普遍愉快的体验。不幸的是，[官方分支](http://www.knollet.com/foostack/)在 CI 版本 1.7.2 停止，但[有一个 fork](https://bitbucket.org/kenjis/my-ciunit/)，我一直在使用 2.1.2。

这为您提供了通常的 xUnit 样式测试套件、代码覆盖率报告生成器、selenium 集成、模拟和存根对象等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T15:41:07.570

两个最流行的 PHP BDD 框架应该适用于任何 PHP 项目：

*   [贝哈特](http://behat.org/)(StoryBDD)
*   [PHPSpec](https://github.com/phpspec/phpspec) (SpecBDD)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-05T17:08:18.707

今天最好的解决方案是 PHPUnit 和 Selenium。我在这里写了关于用法的文章：

*   在 PHPUnit 上： http: [//taiar.github.io/php/2013/11/08/testing-codeigniter-applications-with-phpunit/](http://taiar.github.io/php/2013/11/08/testing-codeigniter-applications-with-phpunit/)
*   在带有 Selenium 的 PHPUnit 上：http: [//taiar.github.io/php/2014/04/21/acceptance-tests-on-codeigniter-with-phpunit-and-selenium/](http://taiar.github.io/php/2014/04/21/acceptance-tests-on-codeigniter-with-phpunit-and-selenium/)

# javascript - Safari iOS 陀螺仪光标

> ID：11784758
> 
> 赞同：0
> 
> 时间：2012-08-02T19:50:26.750
> 
> 标签：javascript, ios, safari, webkit

给定

```
 var pointer = document.getElementById("pointer");

    window.ondeviceorientation = function(event) {
      ax = Math.round(event.alpha);
      ay = Math.round(event.beta);
      az = Math.round(event.gamma);
    }

    setInterval(function() {

            // ???

            pointer.style.left = x + "px"; 
            pointer.style.top = y + "px"; 
    }, 25); 
```

什么是移动“指针”的正确功能，以便它可以相应地移动到 iphone 方向？

# backwards-compatibility - websphere 7 向后兼容性

> ID：11784766
> 
> 赞同：1
> 
> 时间：2012-08-02T19:51:05.637
> 
> 标签：backwards-compatibility, weblogic-10.x, websphere-7, websphere-6.1

我正在将 JSF 应用程序从 WebSphere(WAS) 6.1 迁移到 WAS 7.0，并且由于我使用 WAS 7.0 提供的 JSP 2.1 API 而不是 WAS 6.1 提供的 JSP 2.0 API，因此我遇到了 html 弃用问题。Weblogic 提供了在 weblogic 应用程序部署描述符中启用向后兼容性的能力 (http://docs.oracle.com/cd/E21764_01/web.1111/e13754/compat.htm#i1111538)。WAS 7.0 中是否有类似的解决方案？有没有办法在部署描述符中启用向后兼容性，以便应用程序可以使用 JSF 2.0 API 而不会面临已弃用的 html 问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T01:09:26.537

WebSphere Application Server 7.0 文档中对此没有任何结论，因此我相信这里使用了典型的 IBM 策略：您使用 WAS 7.0 获得的 JSP 引擎与 JSP 2.1 兼容。您不能替换它，也不能指示 WAS 使用较旧的规范级别。

# iphone - iphone的屏幕分辨率是320x460还是320x480？

> ID：11784767
> 
> 赞同：2
> 
> 时间：2012-08-02T19:51:07.023
> 
> 标签：iphone, xcode, size

我很混乱。我没有状态栏，也不知道如何设置滚动视图的尺寸。是 320 x 480 还是 320 x 460？因为当我将它拖到情节提要上并填满整个屏幕时，它说它是 320 x 460，但是当我向其中添加子视图时，它们的位置会很奇怪，就像视图短 20 像素之类的一样。

编辑：我只是有点困惑，因为当我的状态栏消失时，它不会重新调整视图大小，它只会使视图缩短 20 像素，这真的没有意义，对吧？它不应该让它长 20 像素而不是仅仅切断 20 像素吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:52:53.450

iPhone屏幕绝对是320x480。

您在故事板中遇到问题的原因是有多个地方可以告诉它您没有状态栏。您需要追踪所有这些（3？）并确保它说没有状态栏。

最常见的问题是，当您在嵌套的 viewController 中将其专门设置为关闭时，您的状态栏要么打开，要么在早期的 viewController 中推断出来。这导致它没有状态栏，但显示为 460 像素高。正如您在图像中看到的那样，它明显短了 20 个像素。那是因为 segue 告诉它，当它出现时，即使它本身没有状态栏，也要在状态栏“下方”呈现它。如果我要改变模态的segue来推动问题就消失了。或者，如果我将第一个 viewController 设置为没有 statusBar，问题就会消失。另请注意，在某些情况下，Xcode 可能需要重新启动才能正确更新其图形故事板。

![在此处输入图像描述](../Images/5aa13c4df02e22ddcda7ab981d41deef.png)

**还有一件事**

此外，在代码或情节提要中设置隐藏状态栏与在 .info 文件中设置`UIStatusBarHidden`为不同。`YES`如果您在将其隐藏在其他任何地方时将其设置为 no，则您的 default.png 将被剪切并在加载时显示状态栏，然后一旦应用程序完成启动，它将消失。因此，请务必将其隐藏在那里以获得一致的用户体验。

**代码**

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.

    [application setStatusBarHidden:YES];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T20:01:10.383

它是 320 x 480，你看到的 20 像素是状态栏，如果你打算隐藏状态栏并想在 Interface Builder 中匹配大小，你可以去 IB 到 Simulated Metrics -> Status Bar 并选择没有任何。

这不会影响视图控制器中视图的实际大小，尽管即使您将视图设置为 320 x 480，它也会自行调整大小以适应大小，如果存在，视图控制器将自行调整大小为 320 x 460是状态栏，如果还有导航栏，则为 320 x 418。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:53:20.130

我有点不擅长 iPhone 编程，但这 20px 应该是上边框，在那里你可以看到载体和强度等。

# python - Python scapy：pcap 文件读取、操作和写入 pcap

> ID：11784776
> 
> 赞同：2
> 
> 时间：2012-08-02T19:52:13.810
> 
> 标签：python, pcap, scapy

我想使用 python scapy 读取 pcap 文件，操作 TCP 有效负载（例如删除当前有效负载并将其替换为 0）并将操作的数据包写入新的 pcap 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T11:58:47.490

这是使用[pypcap](http://code.google.com/p/pypcap/)和 dpkt 的解决方案。它假定 IP 是 L2 协议。

```
import dpkt
from dpkt.ip import IP
from dpkt.tcp import TCP

for ts, raw_pkt in pcap.pcap(file_path):
    ip = IP(raw_pkt[14:])
    if(type(ip) != IP):
        continue
    tcp = ip.data
    if(type(tcp) != TCP):
        continue
    do_something_with(tcp.data) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-24T21:44:09.720

FTR，回答操作问题，

```
from scapy.all import *
with PcapWriter("output.pcap", sync=True) as outs:
    with PcapReader("input.pcap") as ins:
        for pkt in ins:
            if TCP in pkt:
                pkt[TCP].remove_payload()
            outs.write(pkt) 
```

# jquery - Chrome 和 IE 中的选项卡视图

> ID：11784783
> 
> 赞同：0
> 
> 时间：2012-08-02T19:52:39.613
> 
> 标签：jquery, html, css

我为选项卡视图设置了以下 jsfiddle，它可以工作。但由于某种原因，它不会在 Chrome 和 IE 中切换窗格。

我真的需要知道为什么。

[http://jsfiddle.net/RYYGu/](http://jsfiddle.net/RYYGu/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:58:57.720

看起来对我来说工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:35:26.693

对我来说，这些标签在 Chrome 和 IE 中运行良好。

如果您指的超链接不起作用，则您正在链接到每个选项卡上的**当前**选项卡。例如，尝试`#second`从第一个选项卡链接到。

如果您希望在更改选项卡时更改 URL 哈希，您可以挂钩[`show`](http://jqueryui.com/demos/tabs/#event-show)事件，然后将 window.location.hash 更改为选项卡 ID。

# winapi - 为什么当鼠标悬停在卡巴斯基反病毒工具等应用程序上时，SendInput windows API 调用失败？

> ID：11784785
> 
> 赞同：0
> 
> 时间：2012-08-02T19:52:42.327
> 
> 标签：winapi

我的应用程序是基于服务的，它安装在 Virtual machine(VM) 中。此服务（SYSTEM a/c）创建另一个进程（SYSTEM a/c），用于处理鼠标操作以支持 VM 来宾的多显示器。

将卡巴斯基反病毒工具安装到 VM 中。Kaspersky 服务（SYSTEM a/c）使用登录用户和“中”完整性级别创建进程（处理 UI）。

当我在卡巴斯基工具上进行鼠标悬停时，没有鼠标操作（鼠标移动、鼠标单击）起作用。最初认为这可能是 UIPI 问题并检查了两个进程的完整性级别。

不明白为什么即使我的应用程序具有比 Kaspersky 工具更高的完整性级别，SendInput Windows API 也会失败？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T22:19:51.797

我认为这种软件会从内核模式阻止这些功能，例如挂钩 NtUserSendInput 功能。但这只是我的意见。:-)

# asp.net - 如何编写匹配不包含所有大写字母的文本的正则表达式？

> ID：11784787
> 
> 赞同：0
> 
> 时间：2012-08-02T19:52:53.163
> 
> 标签：asp.net, regex, forms, validation

我正在使用 ASP.NET RegularExpressionValidator

我需要一个正则表达式来防止填写表格的用户使用全部大写。

例如，如果他们写下自己的名字：

Bob JONES 或 BOB JONES 或 BOB JONES 或其他什么，它不会匹配。

我可以用这个正则表达式匹配所有大写字母：

`[A-Z]{2,10}`

但是 RegularExpressionValidator 要求我匹配有效文本，而不是无效文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:02:20.320

如果您的目标是让每个单词一次不超过 1 个大写字母，并且假设可以限制为 ASCII 字母，请尝试以下操作：

```
^(?:[a-z]|[A-Z](?![A-Z])|['-])+$ 
```

换句话说，字符串必须完全由小写字母组成，或者由大写字母组成，后跟另一个大写字母。

这适用于单个单词。对于多个单词（如全名、名字和姓氏），只需在交替中添加一个空格：

```
^(?:[a-z]|[A-Z](?![A-Z])|[\s'-])+$ 
```

*（编辑以允许使用撇号和连字符标点符号）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:57:43.200

使用这个正则表达式：@"^[^AZ]*$" 它将匹配不包含大写字符的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:00:58.657

`^[a-z ]+$` 如果你想像使用这个一样捕获名称，请`Bob Jones`使用这个正则表达式`^([A-Z][a-z ]+)+$`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T02:03:51.093

也许我只是在陈述显而易见的事情，但在进行比较之前你不能只到 myVar.string.toLower 吗？

# c# - 使用 C# 对 PHP Web 服务进行身份验证

> ID：11784792
> 
> 赞同：0
> 
> 时间：2012-08-02T19:53:42.843
> 
> 标签：c#, .net, web-services, authentication, soap

这是适用于 PHP Webservice 客户端的示例代码：

```
 $options = array();
 $options['trace'] = 1;   
 $options['login'] = 'username';
 $options['password'] = 'password';    
 $client = new SoapClient("http://wsurl.com/pt/wsdl", $options); 
```

我想使用 c# 访问此 Web 服务，但很难进行身份验证。我是否需要显式设置soap标头或者有一种内置的方式在.NET中发送凭据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:10:03.620

有两种方法可以做到这一点，因为服务器处理身份验证的方式不同。首先你可以使用这样的东西：

```
var req = WebRequest.Create(<your url>);
NetworkCredential creds = new NetworkCredential(<username>, <password>);
req.Credentials = creds;

var rep = req.GetResponse(); 
```

但是，如果您需要一个实际的授权标头，您将需要使用[此代码](http://blog.kowalczyk.info/article/Forcing-basic-http-authentication-for-HttpWebReq.html)

```
public void SetBasicAuthHeader(WebRequest req, String userName, String userPassword)
{
 string authInfo = userName + ":" + userPassword;
 authInfo = Convert.ToBase64String(Encoding.Default.GetBytes(authInfo));
 req.Headers["Authorization"] = "Basic " + authInfo;
} 
```

然后您的请求代码变为

```
var req = WebRequest.Create(<your url>);
SetBasicAuthHeader(req, username, password);
rep = req.GetResponse(); 
```

如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:13:18.173

如果您在 C# 项目中添加服务引用，则可以像这样调用您的服务：

```
var proxy = new YourServiceClient();
proxy.ClientCredentials.UserName.UserName = "username";
proxy.ClientCredentials.UserName.Password = "password"; 
```

更多信息可以在这里找到：http: [//msdn.microsoft.com/en-us/library/ms733775.aspx](http://msdn.microsoft.com/en-us/library/ms733775.aspx)。

# windows - perl 使用 open3 写入 STDIN 并捕获 STDOUT 和 STDERR

> ID：11784797
> 
> 赞同：0
> 
> 时间：2012-08-02T19:54:18.710
> 
> 标签：windows, perl, stream

我正在使用 Windows x64 机器并试图从命令中捕获 STDOUT 和 STDERR 流。我还必须写入命令的 STDIN。我正在尝试为此使用 perl 的 IPC::Open3，但没有运气。我正在使用[这里](http://www.perlmonks.org/?abspart=1;displaytype=displaycode;node_id=150775;part=1)发布的脚本和命令作为这里的[脚本](http://www.perlmonks.org/?abspart=1;displaytype=displaycode;node_id=150748;part=3)。我当然用 Windows 的“perl test.pl”替换了 $cmd 变量。

它应该打印“StdOut！” 和'StdErr！'，以及pid，但我只得到PID。我不知道是因为我的操作系统，还是因为线程已经使用了 10 年（没什么大不了的，Perl 5 快 18 年了，对吧？）。另一个僧侣发布了[这个](http://www.perlmonks.org/?node_id=151886)脚本来解决另一个问题，但在我的电脑上它永远不会退出。

谁能给我一个使用 open3 在 perl 中启动命令、写入其 STDIN 并捕获其 STDERR 和 STDOUT 的工作示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:03:41.293

`select`仅适用于 Windows 中的套接字；它不适用于管道。您可以改为创建套接字并将它们传递给`open3`而不是让它为您创建管道（如此处所示[）](http://www.perlmonks.org/index.pl?node_id=811650)，但我建议您改用[IPC::Run](http://search.cpan.org/perldoc?IPC%3a%3aRun)等更高级别的模块。`open3`是一个相当低级的功能。

# design-patterns - 使用服务的 DDD 实施细节

> ID：11784799
> 
> 赞同：0
> 
> 时间：2012-08-02T19:54:23.067
> 
> 标签：design-patterns, repository, domain-driven-design

我有两个不同的存储库，我将在整个应用程序中同时使用它们。

在某些情况下，我需要从一个（REST WS）读取然后转而写入另一个（SQLite DB）。

这应该在“域服务”中完成，还是可以在表示/应用层中完成？

**注意：**为了提供一些上下文，我有一个单独的服务进程，它从远程 WS 获取新记录，然后通过写入本地数据库使它们可用于另一个进程，然后它又从该数据库加载。

一个进程是处理在本地和远程数据库之间获取和更新数据的服务。另一个进程是仅在本地数据库之外运行的实际应用程序，并通过请求队列表向服务进程发出请求）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:06:41.530

我可能会为 REST 读取提供一项服务，为 SQLite 写入提供一项服务，以及将它们绑定在一起的一项（Facade）。这里的模式是[外观模式。](http://en.wikipedia.org/wiki/Facade_pattern)

# c# - 从 OpenHardwareMonitor 获取硬件温度

> ID：11784801
> 
> 赞同：3
> 
> 时间：2012-08-02T19:54:27.137
> 
> 标签：c#, hardware, monitor

我正在尝试使用 OpenHardwareMonitor 来读取我的硬件诊断信息。如果您曾经尝试过使用 OHM，那么您就会知道关于它的文档非常少，据我所知，没有其他开源库能够如此准确和健壮。

我已经能够从 CPU 获得负载和时钟速度，但不能获得温度。我也没有收到有关硬盘驱动器的任何信息（我最关心的是温度）。

这是我的实现，它应该返回它所拥有的所有内容，但到目前为止，我只获得了有关 RAM（无临时）、CPU（无临时）和 GPU 的有限信息。

CPU 温度是我要跟踪的最重要的统计数据。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using OpenHardwareMonitor.Hardware;

namespace OHMWrapper
{
    public class MySettings : ISettings
    {
        private IDictionary<string, string> settings = new Dictionary<string, string>();

        public MySettings(IDictionary<string, string> settings)
        {
            this.settings = settings;
        }

        public bool Contains(string name)
        {
            return settings.ContainsKey(name);
        }

        public string GetValue(string name, string value)
        {
            string result;
            if (settings.TryGetValue(name, out result))
                return result;
            else
                return value;
        }

        public void Remove(string name)
        {
            settings.Remove(name);
        }

        public void SetValue(string name, string value)
        {
            settings[name] = value;
        }
    }

    public class OHW
    {
        private static OHW m_Instance;
        public static OHW Instance
        {
            get
            {
                if (m_Instance == null)
                    m_Instance = new OHW();

                return m_Instance;
            }
        }
        private OHW()
        {
            m_Instance = this;
        }

        public void GetCPUTemp()
        {
            MySettings settings = new MySettings(new Dictionary<string, string>
            {
                { "/intelcpu/0/temperature/0/values", "H4sIAAAAAAAEAOy9B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Iu6//MH37x79i9/+NX6N3/TJm9/5f/01fw1+fosnv+A/+OlfS37/jZ/s/Lpv9fff6Ml/NTef/yZPnozc5679b+i193//TQZ+/w2Dd+P9/sZeX/67v/GTf/b3iP3u4/ObBL//73+i+f039+D8Zk/+xz/e/P6beu2TQZju8yH8f6OgzcvPv/U3/Rb8+z/0f/9b/+yfaOn8079X6fr6Cws7ln/iHzNwflPv99/wyS/+xY4+v/evcJ+733+jJ5//Cw7/4ndy9Im3+U2e/Fbnrk31C93vrt/fyPvdb+N//hsF7/4/AQAA//9NLZZ8WAIAAA==" },
                { "/intelcpu/0/load/0/values", "H4sIAAAAAAAEAOy9B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Iu6//MH37x79i9++mpwcv/md/9df89egZ/xX/ym/5y/4D37618Lv7ya//u+58+u+5d9/z7/5t/w9/6u5fP5bH/6av+eTkXyefXxp26ONaf/v/dG/sf39D/rvnv4e5vc/0IP56/waK/vuHzf5I38P8/tv+mv8Rbb9f0pwTF9/zr/1X9vP/8I//+/6Pf7Z30N+/zdf/HX29zd/859q4aCNP5b//U+U3/+7f+zXOjZwfqvDX/V7/o9/vPz+a1G/pv0f+fGlhfk7eZ//N3/0v28//5X0u/n8Cxq7+f1X/tHft20A5x8a/W5/02+BP36Nf+j/nv8XfzrT+c2//Ob4p3+vktvUhNs/+xcWikP6e/4T/5jS5M8/sL8vP/5ff49f/Ivl9//sHzv6PX/vXyG//9R/94/9HuZ34P/5vyC//3W/5e/1exa/k+Bw4bUBnU2bP4Xg/1bn0uafeTH6PatfKL//N3/0t2y/gG9+/8+IzqYNxmU+/+jwX7afY67/nwAAAP//GYSA31gCAAA=" },
            });

            Computer myComputer = new Computer(settings)
            {
                MainboardEnabled = true,
                CPUEnabled = true,
                RAMEnabled = true,
                GPUEnabled = true,
                FanControllerEnabled = true,
                HDDEnabled = true
            };

            myComputer.Open();

            foreach (var hardwareItem in myComputer.Hardware)
            {
                hardwareItem.Update();

                if (hardwareItem.SubHardware.Length > 0)
                {
                    foreach (IHardware subHardware in hardwareItem.SubHardware)
                    {
                        subHardware.Update();

                        foreach (var sensor in subHardware.Sensors)
                        {

                            Console.WriteLine(String.Format("{0} {1} = {2}", sensor.Name, sensor.Hardware, sensor.Value.HasValue ? sensor.Value.Value.ToString() : "no value"));
                        }
                    }
                }
                else
                {
                    foreach (var sensor in hardwareItem.Sensors)
                    {

                        Console.WriteLine(String.Format("{0} {1} = {2}", sensor.Identifier, sensor.Hardware, sensor.Value.HasValue ? sensor.Value.Value.ToString() : "no value"));
                    }
                }
            }
        }
    }
} 
```

我一直在查看源代码，因为它是获取任何信息的唯一方法。这是一个缓慢的过程，但我非常感谢任何帮助。

OpenHardwareMonitor 源代码：[http ://code.google.com/p/open-hardware-monitor/source/browse/](http://code.google.com/p/open-hardware-monitor/source/browse/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T14:20:26.720

我必须以管理权限运行此代码才能获得我想要的所有信息。我添加了一个清单文件，该文件需要代码与这些文件一起运行。感谢您所有有用的帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-08T13:53:07.467

我也被这个困住了，我只是想分享我的经验......

因此，以管理权限运行它是强制性的。尽管如此，从网络共享运行时它仍然可能无法正常工作。

设置的东西（MySettings）和cpu字符串不是必需的......我只是用过

```
myComputer = new Computer() { CPUEnabled = true }; 
```

就这样 ;）

干杯，斯蒂芬

# hadoop - 描述 Hive 中的扩展表

> ID：11784802
> 
> 赞同：4
> 
> 时间：2012-08-02T19:54:32.007
> 
> 标签：hadoop, mapreduce, hive, lzo

我将表存储为 SequenceFile 格式，并设置以下命令以启用带有块压缩的序列-

```
set mapred.output.compress=true;
set mapred.output.compression.type=BLOCK;
set mapred.output.compression.codec=org.apache.hadoop.io.compress.LzoCodec; 
```

但是当我尝试像这样查看表格时-

```
describe extended lip_table 
```

我得到以下信息，其中有一个名为的字段`compressed`设置为`false`，这意味着我的数据没有通过设置上述三个命令得到压缩？

```
Detailed Table Information      Table(tableName:lip_table, dbName:default, owner:uname, 
createTime:1343931235, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:
[FieldSchema(name:buyer_id, type:bigint, comment:null), FieldSchema(name:total_chkout, 
type:bigint, comment:null), FieldSchema(name:total_errpds, type:bigint, comment:null)], 
location:hdfs://ares-nn/apps/hdmi/uname/lip-data, 
inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, 
outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, 
**compressed:false**, numBuckets:-1, serdeInfo:SerDeInfo(name:null, 
serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:
{serialization.format=   , field.delim= 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T08:01:51.930

我发现[这篇文章](http://www.mrbalky.com/2011/02/24/hive-tables-partitions-and-lzo-compression/)我认为可以解决您的问题。您应该尝试在表定义级别指定压缩编解码器的使用，无论是在创建表时还是通过使用 ALTER 语句。

创建时：

```
 CREATE EXTERNAL TABLE lip_table (
                                    column1 string
                                  , column2 string 
                                 )
PARTITIONED BY (date string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY "\t"
STORED AS INPUTFORMAT "com.hadoop.mapred.DeprecatedLzoTextInputFormat"
          OUTPUTFORMAT "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"
LOCATION '/path/to/hive/tables/lip'; 
```

使用 ALTER（仅影响随后创建的分区）：

```
ALTER TABLE lip_table
SET FILEFORMAT
    INPUTFORMAT "com.hadoop.mapred.DeprecatedLzoTextInputFormat"
    OUTPUTFORMAT "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"; 
```

[http://www.mrbalky.com/2011/02/24/hive-tables-partitions-and-lzo-compression/](http://www.mrbalky.com/2011/02/24/hive-tables-partitions-and-lzo-compression/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-25T04:25:26.107

为了避免`serde`异常`serde`也使用类。

```
ALTER TABLE <<table name>>
SET FILEFORMAT
INPUTFORMAT "<<Input format class>>"
OUTPUTFORMAT
"<<Output format class>>" SERDE "<<Serde class>>"; 
```

# javascript - D3.js 从圆形到三角形的可视化

> ID：11784805
> 
> 赞同：4
> 
> 时间：2012-08-02T19:54:43.327
> 
> 标签：javascript, svg, d3.js, transitions, bubble-chart

有谁知道我如何将这个图中的圆圈[http://bost.ocks.org/mike/nations/](http://bost.ocks.org/mike/nations/)更改为三角形并且仍然动态增长和缩小？

![在此处输入图像描述](../Images/856b1ec3eb32681a89e427dbfcd7bd43.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T03:29:10.343

有多种方法可以创建三角形；一种不需要自己做任何几何的方法是使用[d3.svg.symbol](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-symbol)类型为“triangle-up”。像这样：

*   [http://bl.ocks.org/3244058](http://bl.ocks.org/3244058)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:01:51.923

我认为代码几乎相同，但是您需要计算具有三个边的多边形的顶点，而不是绘制圆。重要的是，三角形的面积与它所代表的值成比例。查看多边形文档[https://github.com/mbostock/d3/wiki/SVG-Shapes](https://github.com/mbostock/d3/wiki/SVG-Shapes)

# magento - 检查配置 XML 树 magento 生成

> ID：11784811
> 
> 赞同：5
> 
> 时间：2012-08-02T19:55:20.317
> 
> 标签：magento

正如标题所暗示的，我想检查 Magento 生成的完整配置 XML 树。

我查看了配置对象，但看不到这样做的方法。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-02T19:59:40.240

要完整地获取配置 xml（作为我假设您所指的 xml）...

```
Mage::app()->getConfig()->getXmlString(); 
```

如果将其保存到文件中，检查会容易得多。以下将保存到 var/tmp/configxml.xml 的文件中...

```
file_put_contents(Mage::getBaseDir('tmp').DS.'configxml.xml', Mage::app()->getConfig()->getXmlString()); 
```

显然，Magento 必须首先被引导。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-26T19:13:13.100

我认为这会派上用场，所以我构建了一个小型 Magento 模块，如果您将 ?showConfig=1 添加到 URL，它将显示配置。为 Drew Hunter 提供初始代码的道具。

[https://github.com/siliconrockstar/showconfig](https://github.com/siliconrockstar/showconfig)

# json - 在 Freebase 中获取某个对象的所有别名

> ID：11784814
> 
> 赞同：1
> 
> 时间：2012-08-02T19:55:24.017
> 
> 标签：json, freebase, mql

我有一个庞大的公司列表，我正在尝试使用 Freebase 摆脱重复但略有不同的同一家公司。我的想法是获取给定名称的所有 id，然后使用第一个 id 获取该公司所有不同名称的列表。问题是，当我查询所有 id 的名称时，我收到一个错误，因为有多个结果。我正在尝试使用方法 mysqlread(query)，但是是否有另一种方法可以允许多个结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:59:17.497

如果您提供失败的查询会有所帮助。我假设您实际上使用的是 mqlread，而不是 mysqlread。

作为猜测，您可能正在使用类似的东西

```
[{
  "id":"/en/general_motors",
  "/common/topic/alias": null
}] 
```

​你应该在哪里使用

```
[{
  "id":"/en/general_motors",
  "/common/topic/alias": []
}]​ 
```

数组表示法允许多个值。

顺便说一句，如果您使用 Google Refine，它将完成所有与 Freebase 协调和排名匹配的工作，然后您可以根据已协调主题的 Freebase ID 进行重复数据删除。

# jquery - 每个外部的jquery模板索引

> ID：11784816
> 
> 赞同：0
> 
> 时间：2012-08-02T19:55:30.847
> 
> 标签：jquery, jquery-templates

这是我正在使用的代码

```
<script id="templateGroups" type="text/html">
    <li>
        {{ChildList.Id}}
        <a href="#t${Id}" class="tab-sub-link tab_link ">${Tag}</a>
            <ul>
                {{each ChildList}}
                ${( $data.TagSlug = Tag.replace(/[^a-zA-Z0-9_]/g,'-') ),''}
                <li>
                    <a id="${ParentTag}-${TagSlug}" onclick="_NewsManager.NewsListCall(${Id})"></a>
                    <a href="#${ParentTag}-${TagSlug}" >${Tag}</a>
                </li>
                {{/each}}
            </ul>
    </li>
</script> 
```

所以基本上我想把第一个孩子的身份证放在外面和之前`{{each}}`；我用过的地方`{{ChildList.Id}}`

任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:04:52.933

嗯，好的，我找到了代码，`{{each ChildList}}`将遍历列表`ChildList`

`${ChildList[0].Id}`将获得第一个对象，然后是它的属性`Id`并打印它

# ruby-on-rails - 将 CSV 导入 Rails 时用户选择的行

> ID：11784819
> 
> 赞同：2
> 
> 时间：2012-08-02T19:55:40.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, parsing, csv, import

在 Ruby on Rails 中导入 CSV 文件时，是否存在允许用户选择与列关联的行的公认最佳实践？

这样他们上传文件 -> 得到一个带有列标题列表的确认屏幕，并为每个输入选择输入（填充模型的可写属性） -> 将每个 CSV 行保存到模型中，并选择列在上一步中。

基本上，我想要这里显示的功能：

[http://youtu.be/5Ddnu_NK_-o?t=50s](http://youtu.be/5Ddnu_NK_-o?t=50s)

如果没有更好的方法，我会这样做的方式是这样的：

1.  用户上传文件
2.  解析 CSV
3.  显示前几行
4.  显示一个表单，每个列都有选择输入，由可写属性和缓存文件填充
5.  对于每个 POST 列名参数，将它们与列匹配（同时验证没有使用两次列名）
6.  为每一行创建一个新记录

我承认，作为 RoR 的新手，第 4 步和第 5 步对我来说相当令人生畏，而且似乎必须经常遇到这种情况，但我还没有找到任何运气来找到有关该主题的宝石或教程。

# google-app-engine - DataNucleus 增强器不起作用

> ID：11784820
> 
> 赞同：0
> 
> 时间：2012-08-02T19:55:54.197
> 
> 标签：google-app-engine, datanucleus

我正在使用 Google AppEngine 和 Spring MVC 编写一个网络应用程序。我按照以下步骤小心地升级到 DataNucleus 插件的 v2：[http](http://code.google.com/p/datanucleus-appengine/wiki/UpgradingToVersionTwo) ://code.google.com/p/datanucleus-appengine/wiki/UpgradingToVersionTwo （我使用 Eclipse）。

当我尝试运行 Enhancer Tool 时，出现以下错误：

```
Exception in thread "main" Plugin (Bundle) "org.datanucleus" is already registered. Ensure you dont have multiple JAR versions of the same plugin in the classpath. The URL 
"file:/.../eclipse/plugins/com.google.appengine.eclipse.sdkbundle_1.6.4.v201203300216r37/appengine-java-sdk-1.6.4/lib/opt/user/datanucleus/v2/datanucleus-core-3.0.6.jar" is already registered, and you are trying to register an identical plugin located at URL 
"file:/.../eclipse/plugins/com.google.appengine.eclipse.sdkbundle_1.6.4.v201203300216r37/appengine-java-sdk-1.6.4/lib/opt/tools/datanucleus/v2/datanucleus-core-3.0.6.jar." 
```

我对消息进行了格式化，以便您可以看到微小的差异，一个 jar 是从“user”目录加载的，另一个是从“tools”目录加载的。我不明白为什么。在项目构建路径中，只有一个来自“用户”和 DataNucleus 配置，我从“工具”添加了一个，就像上面建议的方法一样。

在其他情况下，我看到这条消息主要是由 datanucleus 插件的版本冲突引起的，但它不适用于我。我想这对我来说只是一些愚蠢的事情......那我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T08:42:26.373

所以毕竟，我并没有像我想象的那样仔细阅读说明。问题实际上是 jar 存在两次，一次在项目构建路径中，一次在 datanucleus 配置中。它不应该在项目构建路径中（或者实际上，它不应该在其中之一中，无论哪个都无所谓）。当我将库复制到 war 目录时，我自动将它添加到那里，并且我认为它必须完成。但说明清楚地表明**只有 jdo-api**需要在项目构建路径中。

不过有一件事我不明白。在说明的一个步骤中，我必须在 DataNuclues 配置中取消选中*“运行工具时使用项目类路径” 。*那么插件怎么可能还在使用项目构建路径中配置的库呢？

# jquery - 将 Microsoft 的 Metro Style Api 用于非 Windows 8 网页

> ID：11784824
> 
> 赞同：0
> 
> 时间：2012-08-02T19:56:20.797
> 
> 标签：jquery, windows-runtime, windows-store-apps, winjs, tiles

有没有人使用过微软的 Metro Style Api 来开发所有主流浏览器都支持的网页，而不是 Windows 8？我对此有点陌生（jquery，Metro 样式），并且需要制作一个非常像 Metro 风格应用程序的网页，带有动态磁贴和所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:59:23.377

（旧答案不再有效）API 是 Windows 8 的一部分。不能在非 Windows 8 环境中使用它们。

WinJS 现在是开源的，可以在任何地方使用。[从http://try.buildwinjs.com](http://try.buildwinjs.com)获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:40:47.210

Metro API 允许您与系统交互并执行其他在 web 应用程序中无法执行的操作。

您想使用 CSS 和 Javascript 制作一个使用与 Metro 风格应用程序相同的设计技术的网页。（大量彩色矩形，仔细使用排版）

# java - 按代码计算 jBoss AS7 会话

> ID：11784829
> 
> 赞同：1
> 
> 时间：2012-08-02T19:56:52.140
> 
> 标签：java, jboss, amazon-ec2, amazon-web-services, jboss7.x

我正在 Amazon Web Services 基础设施上的 jBoss AS7 中使用 Seam 开发 Web 应用程序。我已经实现了自动扩展基础设施，但我需要了解有关 AS7 配置的两件事：

1) 如何配置 AS7 在不同的服务器上共享用户会话？我需要像这个链接一样配置一个集群 [https://docs.jboss.org/author/display/AS71/AS7+Cluster+Howto](https://docs.jboss.org/author/display/AS71/AS7+Cluster+Howto)

2) 有没有办法通过代码计算单个 AS7 中的打开会话？我需要创建 AWS 基础设施的自动缩减规模以在不中断用户工作的情况下关闭 EC2 机器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T21:52:25.740

我认为您可以使用 HttpSessionListener 并在 sessionCreated 上的外部数据库中增加一个计数器，并在 sessionDestroyed 上从同一数据库中减少。

```
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;
import javax.servlet.http.HttpSession;

public class SessionCounter implements HttpSessionListener {

    public SessionCounter() {
    }

    public void sessionCreated(HttpSessionEvent event) {
        //@TODO increment database value
    }

    public void sessionDestroyed(HttpSessionEvent event) {
        //@TODO decrement database value
    }

    public int getActiveSessionNumber() {
        //@TODO return database value
    }
} 
```

# heroku - 为客户提供域别名

> ID：11784830
> 
> 赞同：1
> 
> 时间：2012-08-02T19:56:57.850
> 
> 标签：heroku, dns, domain-aliasing

目前我有一个应用程序，它为我的用户提供了一个自定义子域。

整洁的coolapp.com

但是，我希望我的用户能够将他们的个人域 CNAME 到该网站。
前任。嘿.neat.com -> 整洁的.coolapp.com

这在heroku上可能吗？

提前感谢您的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T15:49:27.350

您需要将客户想要使用的任何域添加到您的应用程序中，以便 Heroku 上的正确应用程序响应 - 您可以手动执行此操作（通过 heroku 控制面板）或使用应用程序中的 heroku gem 将域添加到如果客户能够添加自己的域，您的应用程序可以通过某种控制面板进行。

关于 cname - 我建议设置类似`proxy.yourwebsite.com`CNAME之类的东西`yourapp.heroku.com`，然后让您的客户`proxy.yourwebsite.com`在他们的 DNS 配置中将他们的域命名为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T07:12:30.743

当您注册 Heroku 时，您将获得一个子域，例如

`asdf.heroku.com`

如果您有一个`mywebsite.com`可以命名的域，则需要添加`mywebsite.com`到Heroku 的自定义域命令。`asdf.heroku.com``mywebsite.com`

从那里我不确定，如果您想添加`mywebsite2.com`而不必使用自定义域命令添加它，您可以尝试将其命名为`mywebsite.com`，如果您有两个域，您可以尝试一下。

# jquery - CSS3 - 添加类以触发动画并在完成时删除类

> ID：11784831
> 
> 赞同：4
> 
> 时间：2012-08-02T19:57:00.260
> 
> 标签：jquery, animation, css, addclass, removeclass

我有一个 div，当我单击它时，jquery 添加了一个开始运行动画的类。当动画停止时（3 秒后），我希望删除该类，这样当再次单击 div 时，动画将重新开始。

这只是测试，目前只有 Chrome 浏览器。

这是我的 CSS3：

```
.spin360
{
    -webkit-animation-name: spin;
    -webkit-animation-duration: 3s;
    -webkit-animation-iteration-count: 1;
    -webkit-animation-timing-function: ease;
    -webkit-animation-fill-mode: forwards;
}

@-webkit-keyframes spin 
{
    0% { -webkit-transform: rotateX(0); }
    100%   { -webkit-transform: rotateX(-360deg); }
} 
```

这是我的脚本：

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#spinButton').click(function () {
            $('#shape').addClass('spin360');
        });
    });
</script> 
```

这是我尝试过的：

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#spinButton').click(function () {
            $('#shape').addClass('spin360').on('webkitAnimationEnd', function () {
                $('#shape').removeClass('spin360');
            });
        });
    });
</script> 
```

和

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#spinButton').click(function () {
            $('#shape').addClass('spin360');
        });

        $('#spinButton').addEventListener('webkitAnimationEnd', function (e) {
            $('#shape').removeClass('spin360');
        });
    });
</script> 
```

在所有情况下 - 我的动画在第一次点击时运行，而不是后续点击。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T10:31:24.050

您也可以使用跨浏览器的方式进行操作：

```
$('#spinButton').bind('animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd', function (e) {
    $('#shape').removeClass('spin360');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T18:43:03.630

我使用的是旧版本的 jquery。

我更新到 1.8.0 并且可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-11T22:52:44.033

// 工作正常，但是你确实离开了我们的标准声明 //所以你的代码只能在 Chrome、Safari、Opera 上运行

> /* Chrome、Safari、Opera */
> @-webkit-keyframes spin { 0% { -webkit-transform: rotateX(0); } 100% { -webkit-transform: rotateX(-360deg); } }
> 
> /* 标准语法 */
> @keyframes spin { 0% { -webkit-transform: rotateX(0); } 100% { -webkit-transform: rotateX(-360deg); } }

# iphone - 这段代码中是否同时执行了 dispatch_after 方法？

> ID：11784832
> 
> 赞同：4
> 
> 时间：2012-08-02T19:57:00.397
> 
> 标签：iphone, objective-c, ios, concurrency, timer

```
int total = 0;            // these are globals..
BOOL dispatchCalled = NO; //

-(void) callDispatch
{
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 0.3 * NSEC_PER_SEC), dispatch_get_current_queue(), ^{
        dispatchCalled = YES;
        NSLog(@"Total, after 300ms, is %i", total);
    });
}

-(void)play // this is my "main" method..
{
    NSLog(@"app starts running");

    [self callDispatch];

    while(!dispatchCalled)
    {
        total++;
    }

    [self callDispatch];
 } 
```

安慰 ：

```
 2012-08-02 20:36:05.357 MyProject[8245:1a07] app starts running
   2012-08-02 20:36:05.693 MyProject[8245:3d03] Total, after 300ms, is 11513522
   2012-08-02 20:36:05.993 MyProject[8245:3d03] Total, after 300ms, is 11513523 
```

当 callDispatch 中包含的方法第一次执行时，while 循环有时间执行 11513522 次。此时，while 循环的条件设置为`YES`，while 循环不再执行。但是，它会在确认由调度方法条件更新之前再执行一次。这是为什么？

是不是因为 callDispatch 中包含的方法将*与while 循环***同时/并行** 执行，这可以解释为什么 while 循环需要多一个周期才能确认更新的条件？

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:23:17.993

是的，它正在同时运行。这意味着您的块可以在 while 循环期间的任何给定时刻执行，例如在通过条件之后，但在增加全局之前，或者在增加全局之后。如果您多次运行代码，您会注意到有时`total`计数匹配，有时则不匹配。*（编辑：这意味着您的代码在同时运行时是“不确定的”。）*

如果您尝试在串行队列中运行上述代码，则 while 循环将无限运行，并且不会打印任何总数。在串行队列中，您在 callDispatch 中安排的块确实会添加到队列中以供下一个调用，但鉴于无限循环永远不会退出，该队列中的任何其他内容都不会被调用。

Apple Doc 中的更多信息：[GCD 提供三种不同类型的队列](https://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:58:35.160

鉴于您有效地锁定了主事件循环，那么正在执行块的队列不能是主队列。

因此，您肯定有两个线程在运行，因此，并不能真正保证在第一个块和第二个块执行之间可能经过多少时间。同样，如果 dispatch_get_current_queue() 碰巧检索到一个异步队列，您不能假设其中的任何块同时执行。

或者，更坦率地说：你无法推理并发代码中的执行和调度模式；你不能“玩电脑”，只能想出一种情况下发生的近似值。*

# sql - SQL 错误 1016 - 内部连接

> ID：11784835
> 
> 赞同：1
> 
> 时间：2012-08-02T19:57:16.913
> 
> 标签：sql, sql-server, inner-join

我正在尝试将内部连接添加到旧 SQL 代码中，以使其更有效地运行。但是当我添加它们并尝试执行时，我得到了这个错误：

```
1016, Line 12 Outer join operators cannot be specified in a query containing joined tables 
```

这是查询：

```
select a.s_purchase_order as order_id, 
a.order_type, 
a.nobackorder, 
a.order_note, 
a.note, 
a.rqst_dlvry_date, 
b.customer_name ,
c.store_name,
(c.store_name + ',' + isnull(c.address1 + ',', ' ') +  isnull(c.city + ',', ' ') +  isnull(c.state_cd+ ',', ' ')  + isnull( c.zipcode, ' ')) as store_info, 
d.supplier_account
from VW_CustomerOrder a, Customer b, Store c, eligible_supplier d
where a.customer = c.customer
and a.store = c.store
and a.customer = b.customer
and c.customer *= d.customer
and c.store *= d.store
and a.supplier *= d.supplier
and a.purchase_order = @order_id
and a.customer = @customer_id
and a.store=@store_id
and a.supplier = @supplier_id 
```

知道是什么原因造成的吗？我猜它与isnull有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:05:11.053

你试过这个吗？它将表格之间的逗号替换为`INNER JOIN`and`LEFT JOIN`

```
select a.s_purchase_order as order_id, 
    a.order_type, 
    a.nobackorder, 
    a.order_note, 
    a.note, 
    a.rqst_dlvry_date, 
    b.customer_name ,
    c.store_name,
    (c.store_name + ',' + isnull(c.address1 + ',', ' ') +  isnull(c.city + ',', ' ') +  isnull(c.state_cd+ ',', ' ')  + isnull( c.zipcode, ' ')) as store_info, 
    d.supplier_account
from VW_CustomerOrder a
INNER JOIN Customer b
    ON a.customer = b.customer
INNER JOIN Store c
    ON a.customer = c.customer
    and a.store = c.store
LEFT JOIN eligible_supplier d
    ON c.customer = d.customer
    and c.store = d.store
    and a.supplier = d.supplier
where a.purchase_order = @order_id
    and a.customer = @customer_id
    and a.store=@store_id
    and a.supplier = @supplier_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:50:29.950

如果在将代码转换为 ANSI 语法后将 "*=" 连接运算符留在代码中，则可以解释您的错误。使用 ANSI 语法时，对所有相等测试使用 = —— 你的类型`JOIN`应该在`JOIN`声明本身中明确（`INNER`, `LEFT`,`RIGHT`等）

# unit-testing - SRP 使类难以测试

> ID：11784836
> 
> 赞同：3
> 
> 时间：2012-08-02T19:57:17.193
> 
> 标签：unit-testing, mocking, single-responsibility-principle

在重构一些旧的遗留代码时，我尝试尽可能多地应用单一职责原则，所以我最终得到了许多只有一个目的的类。这很好，但是当我尝试为这些新类编写单元测试时问题就来了。有些类真的很难测试，因为测试很难设置。我需要创建 4-5 个模拟/存根来编写一个测试用例，如果我想覆盖我的所有代码，我需要编写几个测试用例，所以这只是一个麻烦。

难以设置测试（因为它依赖于许多其他类）是代码异味吗？你如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:50:16.610

以下是[鲍勃叔叔对 SRP](http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)的评价：

> 一个班级应该有一个，而且只有一个改变的理由。

请注意，它并没有说“一个类只做一件事，而且只做一件事”。换句话说，如果除了其中一个职责之外的所有职责都是不变的，或者如果它们都将一起改变，那么一个类拥有多个职责是完全有效的。

Bob 大叔在他的[《敏捷模式、原则和实践](https://rads.stackoverflow.com/amzn/click/com/0131857258)》一书中说：

> 在 SRP 的背景下，我们将责任定义*为变更的原因*(117)。

和：

> 另一方面，如果应用程序没有以导致[多个]职责在不同时间发生变化的方式发生变化，则无需将它们分开。事实上，将它们分开会散发出不必要的复杂性。(118)

也就是说，一个有太多合作者的类是一种气味，应该仔细检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:34:29.737

*   您不需要涵盖所有代码，请使用常识
*   对于小类，应该很容易确定不变量，因此用断言填充它们并让代码自行测试
*   将您的系统拆分为多个层，并定义您可以在何处插入模拟刺激以使这些断言发挥作用并验证输出

# android - Android：动态按钮名称

> ID：11784837
> 
> 赞同：1
> 
> 时间：2012-08-02T19:57:22.803
> 
> 标签：android, json, button

我想动态更改某些按钮上的文本。所有必要的文本都保存在 strings.xml 中，引用名称保存在 Json 对象中。

任何人都知道我如何从 strings.xml 为我的 setText 函数获取数据？

```
JSONObject e = Options.getJSONObject(i); 
//The Name for strings.xml
String name = e.getString("name");

Resources res = getResources();
button1.setText(String.format(res.getString(R.string. ??????????? ))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:02:44.477

使用这样的东西

```
getResources().getIdentifier(name, "string", “com.main.package”)); 
```

或更好：

```
getResources().getIdentifier(name, "string", getPackageName())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:03:05.577

您可以通过以下方式从 String.xml 获取任何字符串

```
 getString(R.string.string_name); 
```

# delphi - Delphi中如何有效地使用接口进行内存管理

> ID：11784840
> 
> 赞同：5
> 
> 时间：2012-08-02T19:57:31.080
> 
> 标签：delphi, delphi-xe

我对 Delphi 相当陌生，并且一直在手动进行所有内存管理，但听说过 Delphi 能够使用接口进行引用计数并以这种方式提供一些内存管理的引用。我想开始，但有几个问题。

1.  只是一般情况下，我该如何使用它。创建接口和实现它的类。那么每当我需要该对象时，变量实际上是否属于接口类型，但实例化对象并立即执行？不用考虑释放它吗？没有更多的尝试？

2.  为真正不需要的类创建一堆接口似乎很麻烦。关于自动生成这些的任何提示？我如何最好地组织它？接口和类在同一个文件中？

3.  哪些常见的陷阱可能会让我感到悲伤？例如：将接口对象转换为其类的对象会破坏我的引用计数吗？还是有任何不明显的方式 Delphi 会创建参考循环？（意思是除了 A 使用 B 使用 C 使用 A）

如果有涵盖任何这些的教程，那就太好了，但我在搜索中没有提出任何内容。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T20:53:52.947

导致 Delphi 中“自动垃圾收集”的最常见抱怨是，即使是短暂的临时对象也必须手动处理，并且您必须编写大量“样板”代码以确保发生异常时会发生这种情况。

例如，在过程中为某些临时排序或其他算法目的创建**TStringList ：**

```
procedure SomeStringsOperation(const aStrings: TStrings);
var
  list: TStringList;
begin
  list := TStringList.Create;
  try
      :
     // do some work with "list"
      :
  finally
    list.Free;
  end;
end; 
```

正如您所提到的，实现引用计数生命周期管理的 COM 协议的对象通过在释放对它们的所有引用时清理自己来避免这种情况。

但由于**TStringList**不是 COM 对象，您无法享受它提供的便利。

幸运的是，有一种方法可以使用 COM 引用计数来处理这些事情，而无需创建您希望使用的类的所有新 COM 版本。您甚至不需要切换到完全基于 COM 的模型。

我创建了一个非常简单的实用程序类，允许我将任何对象“包装”在一个轻量级 COM 容器中，专门用于获得这种自动清理行为。使用此技术，您可以将上面的示例替换为：

```
procedure SomeStringsOperation(const aStrings: TStrings);
var
  list: TStringList;
begin
  AutoFree(@list);

  list := TStringList.Create;

    :
  // do some work with "list"
    :
end; 
```

AutoFree **()**函数调用在编译器为该过程生成的退出代码中创建了一个“匿名”接口对象，该对象是**Release() 。**这个自动释放对象被传递一个指向变量的指针，该变量引用您希望被释放的对象。除此之外，这允许我们将**AutoFree()**函数用作伪“声明”，将任何和所有 AutoFree() 调用放在方法的顶部，尽可能靠近它们引用的变量声明，然后我们甚至创建了任何对象。

实现的全部细节，包括源代码和更多示例，都在我的这篇博文[中](http://www.deltics.co.nz/blog/?p=391)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-02T20:28:05.683

我目前正在处理一个非常大的项目，该项目利用接口引用计数的“副作用”来进行内存管理。

我个人的结论是，您最终会得到很多过于复杂的代码，没有比“我不必担心免费调用”更好的理由

出于一些非常基本的原因，我强烈建议不要采取这种行动：

1) 您正在使用出于 COM 兼容性目的而存在的副作用。

2）您正在使您的对象占用空间和效率更重。接口是指向指针列表的指针..或类似的东西。

3）就像你说的......你现在必须为了避免自己释放内存的唯一目的而制作成堆的接口......在我看来，这会带来更多的麻烦而不是它的价值。

4) 当一个对象被释放时，在它被引用之前，最常见的错误将成为一个巨大的调试痛苦。我们在自己的引用计数中有特殊的代码，可以在软件推出之前尝试测试这个问题。

**现在回答你的问题。**

1）给定 TFoo 和接口 IFoo 你可以有一个类似下面的方法

```
function GetFoo: IFoo;
begin
  Result := (TFoo.Create as IFoo);
end; 
```

...而且 presto，你不需要 finally 来释放它。

2) 是的，就像我说的，你认为这是个好主意，但它变成了布基斯的巨大痛苦

3）2个问题。

A) 你有 Object1.Interface2 和 Object2.Interface1...由于循环引用，这些对象永远不会被释放

B）在所有引用被释放之前释放对象，我不能强调这些错误是多么难以追踪......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-03T06:51:17.150

接口的内存管理是通过[TInterfacedObject实现的](http://docwiki.embarcadero.com/Libraries/en/System.TInterfacedObject)[_AddRef](http://docwiki.embarcadero.com/Libraries/en/System.IInterface._AddRef)和[_Release](http://docwiki.embarcadero.com/Libraries/en/System.IInterface._Release)实现的。

一般来说，使用接口来减少内存管理的麻烦可能是一个好主意，但您需要注意以下事项：

*   确保实现接口的类派生自`TInterfacedObject`或滚动您自己的祖先类，该类为`_AddRef`和`_Release`
*   使用非此即彼：所以无论是用户界面引用，还是使用对象实例引用，都不要混合使用。在组件中实现接口时可能会出现问题（因为这些接口源自`TComponent`，而不是`TInterfacedObject`）
*   不要采用[TInterfacedComponent](https://www.google.com/search?q=TInterfacedComponent)方式，因为它混合了基于[Owner](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TComponent.Owner)的内存管理和`_AddRef`/`_Release`基于内存的管理
*   观看循环接口引用（您可以到处实现[此处](http://www.finalbuilder.com/Resources/Blogs/PostId/410/WeakRefence-in-Delphi-solving-circular-interfac.aspx)提到并在[此处](http://delphisorcery.blogspot.nl/2012/06/weak-interface-references.html)实现的“弱接口引用” ）
*   您需要维护额外的代码，因为您需要为要公开的类的部分定义接口，并使这两者保持同步（您可以为此使用[Model Maker Code Explorer](http://www.modelmakertools.com/code-explorer/index.html)；它允许您提取接口并总体上提升您的开发，因为它以单一动作管理代码的接口/实现部分）
*   您需要一些额外的管道来创建底层类的实例。您可以[为此使用工厂模式](http://delphipatterns.blog.com/2011/03/23/abstract-factory/)。

这并不总是*有效*的，但确实回答了您的一些基本问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T00:19:05.140

最短的可能答案：默认的 delphi 内存模型是所有者释放他们拥有的对象。所有其他引用都是弱引用，必须在所有者之前放手。很少会“共享”一个生命周期短于应用程序整个生命周期的对象。引用计数很少进行，并且当它完成时，它只能由专家完成，否则它会增加比它解决的更多的错误和崩溃。

学习惯用的 delphi 风格并尝试模仿它，不要争吵。可悲的是，人们认为“针对接口而不是实现的程序”意味着“到处使用 IUnknown”。这不是真的。我建议您不要使用 COM IUnknown 接口，而是使用抽象基类。您唯一不能做的就是在一个类中实现两个抽象基类，这种需求很少见。

更新：我最近发现使用 COM 接口（基于 IUnknown）帮助我从 UI 类中分离出我的模型和控制器实现很有帮助。所以我确实发现使用基于 IUnknown 的接口很有用。但是没有很多文档和现有技术可以作为您努力的基础。我希望看到一个“食谱”风格的食谱，它为人们列出了所有这些，这样他们就可以在没有结合界面和基于非界面的生命周期管理的常见问题的情况下工作，以及在你习惯时遇到的所有麻烦额外的复杂性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-12T08:32:24.187

仅仅为了避免手动Free而切换到界面是没有意义的。Free/try-finally 行的经济性几乎无法弥补在接口中同时声明 g/setter 和属性的必要性，更不用说保持 intf/class 声明同步的必要性了。由于隐式完成代码和引用计数，接口也会带来性能损失。如果性能不是重点，而您想要实现的只是自动释放，我建议使用一些通用接口包装器，如 Deltics 建议的那种。

# javascript - 关于在 extjs 窗口组件中检测拖动

> ID：11784841
> 
> 赞同：2
> 
> 时间：2012-08-02T19:57:40.230
> 
> 标签：javascript, extjs

我使用此代码

```
 win = Ext.create('widget.window', {
            title: 'Layout Window',
            closable: true,
            closeAction: 'hide',
            width: 600,
            minWidth: 350,
            height: 350,
            layout: {
                type: 'border',
                padding: 5
            },
            listeners : {
                render : function(){
                    alert("render");
                },
                beforerender : function(){
                    alert("beforerender");
                },
                afterrender : function(){
                    alert("afterrender");
                }
            },

            items: [...

            ]
        });
    win.on('move',function(){
        alert("ddd");
    }); 
```

检测 extjs 中窗口组件的移动。它工作得很好，即它会提醒“ddd”，但是在我移动窗口并停止拖动它之后会发生这种情况。

我想检测窗口的拖动何时开始，即当我用光标按下窗口标题栏并开始拖动时。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:43:06.413

如果要点击每个拖动动作，则要绑定的事件是“拖动”。

```
win.on('move',function(){
    console.log("ddd", arguments);
}); 
```

其他可用的拖动事件包括 dragstart 和 dragend。

有关更多详细信息，请参阅： [http ://docs.sencha.com/ext-js/4-1/#!/api/Ext.dd.DragTracker-event-drag](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.dd.DragTracker-event-drag)

# ruby - 计算 Ruby 中的第 95 个百分位数？

> ID：11784843
> 
> 赞同：24
> 
> 时间：2012-08-02T19:57:51.873
> 
> 标签：ruby, ruby-on-rails-3, algorithm, math

这里的这个问题似乎没有帮助：[Calculating Percentiles (Ruby)](https://stackoverflow.com/questions/2609597/calculating-percentiles-ruby)

我想从一组数字中计算第 95 个百分位（或者，实际上，任何其他所需的百分位）。最终，这将在 Rails 中应用，以针对大量记录计算分布。

但是，如果我能确定如何从一组数字中准确地确定给定的百分位数，我就可以从那里得到它。

坦率地说，我很惊讶我还没有找到某种具有这种功能的宝石——我还没有找到。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-08-02T20:41:05.827

如果要复制 Excel 的 PERCENTILE 函数，请尝试以下操作：

```
def percentile(values, percentile)
    values_sorted = values.sort
    k = (percentile*(values_sorted.length-1)+1).floor - 1
    f = (percentile*(values_sorted.length-1)+1).modulo(1)

    return values_sorted[k] + (f * (values_sorted[k+1] - values_sorted[k]))
end

values = [1, 2, 3, 4]
p = 0.95
puts percentile(values, p)
#=> 3.85 
```

该公式基于 QUARTILE 方法，它实际上只是一个特定的百分位数 - [https://support.microsoft.com/en-us/office/quartile-inc-function-1bbacc80-5075-42f1-aed6-47d735c4819d](https://support.microsoft.com/en-us/office/quartile-inc-function-1bbacc80-5075-42f1-aed6-47d735c4819d)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-04-04T10:05:11.813

如果您对现有的 gem 感兴趣，[`descriptive_statistics`](https://github.com/thirtysixthspan/descriptive_statistics)那么到目前为止我发现 gem 是最好的`percentile`功能。

**内部审查委员会会议**

```
> require 'descriptive_statistics'
=> true
irb(main):009:0> data = [1, 2, 3, 4]
=> [1, 2, 3, 4]
irb(main):010:0> data.percentile(95)
=> 3.8499999999999996
irb(main):011:0> data.percentile(95).round(2)
=> 3.85 
```

gem 的优点在于它描述“我想要 95% 的数据”的优雅方式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-02T20:18:16.923

### 基于项目数的百分位数

```
a = [1,2,3,4,5,6,10,11,12,13,14,15,20,30,40,50,60,61,91,99,120]

def percentile_by_count(array,percentile)
  count = (array.length * (1.0-percentile)).floor
  array.sort[-count..-1]
end

# 80th percentile (21 items*80% == 16.8 items are below; pick the top 4)
p percentile_by_count(a,0.8) #=> [61, 91, 99, 120] 
```

### 基于值范围的百分位数

```
def percentile_by_value(array,percentile)
  min, max = array.minmax
  range = max - min
  min_value = (max-min)*percentile + min
  array.select{ |v| v >= min_value }
end

# 80th percentile (119 * 80% = 95.2; pick values above this)
p percentile_by_value(a,0.8) #=> [99, 120] 
```

* * *

^(有趣的是，Excel 的[`PERCENTILE`](http://office.microsoft.com/en-us/excel-help/percentile-HP005209211.aspx)函数返回`60`第 80 个百分位数的第一个值。如果你想要这个结果——如果你想要包含一个落在限制尖端的项目——那么将`.floor`上面的内容更改为`.ceil`.)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-05T16:04:58.273

这是我在自己的统计库中开发的方法：

```
def quantiles(data, probs=[0.25, 0.50, 0.75])
  values = data.sort

  probs.map do |prob|
    h = 1 + (values.count - 1) * prob
    mod = h % 1
    (1 - mod) * values[h.floor - 1] + (mod) * values[h.ceil - 1]
  end
end 
```

如果您只想要一个分位数，请执行`quantiles(data, [0.95])`.

# sql - 树视图查询

> ID：11784846
> 
> 赞同：0
> 
> 时间：2012-08-02T19:58:00.237
> 
> 标签：sql, sql-server, sql-server-2008, treeview, telerik

我创建了一个查询以获取市政（父）中的所有地址（子），但它返回为空/感谢任何帮助。

```
drop table #tmp1
go

WITH Emp_CTE AS (
SELECT tablesysID, MunicNo, StreetName       
FROM table1
UNION ALL
SELECT e.tablesysID,e.MunicNo,e.StreetName
FROM table1 e
INNER JOIN Emp_CTE ecte ON ecte.MunicNo = e.MunicNo
)
SELECT *  into  #tmp1
FROM Emp_CTE

select * from #tmp1 
```

它将用于 asp.net 树视图控件。

**感谢 Andomar 的回答，这是正确的，但我只想分享我如何解决这个问题，如下所示：**

# 1：将查询作为存储过程返回 xml 数据类型作为响应，如：

```
create PROCEDURE [dbo].[sp_someproc]
    @XmlResponse xml output

AS
BEGIN
    --
    -- Insert statements for procedure here
set @XmlResponse=(SELECT DISTINCT 
               table1.MunicNo + ' ' + table1.StreetName + ' ' + table1.City AS firstRow, table1.MunicNo, table1.StreetName, table1.City, 
                table1.XPOS, table1.YPOS, table1.RollID, table2.Asset_ID, table2.Feature_ID, table2.FeatureName + ',' + table2.Feature_ID + ' ' + table2.[DESC] AS secondRow,
               table2.FeatureName, table2.xxxID, table2.[DESC],table3.WONOs, table3.WONOs + ', ' + table3.AssetType + ', ' +table3.Feature_ID AS workONumber
FROM  table4 INNER JOIN
               table3 ON table4.xxxxID = table3.xxxxID INNER JOIN
               table2 ON table4.Asset_ID = table2.xxx_ID INNER JOIN
               table1 ON table2.StreetName = table1.StreetName AND table3.MunicNo = table1.MunicNo
            for xml auto,root('xml'))
END
select @XmlResponse 
```

# 2：aspx页面代码：

```
<telerik:RadTreeView ID="rtrvxxxxx" runat="server" >
          <DataBindings>
                        <telerik:RadTreeNodeBinding DataMember="table1" TextField="firstRow" ValueField="firstRow" />
                        <telerik:RadTreeNodeBinding DataMember="table2" TextField="secondRow"  />
                         <telerik:RadTreeNodeBinding DataMember="table3" TextField="workONumber"  />

          </DataBindings>               

        </telerik:RadTreeView> 
```

# 3：C#代码：

```
private void loadXmlDocument()
        {
            try
            {
                #region Load and Bind xml to treeview

                XmlDataSource xDS = new XmlDataSource();
                XmlDocument xmlDoc = new XmlDocument();

                xmlDoc = callingdatalayerclass.list_XML();
                xDS.Data = xmlDoc.InnerXml;
                xDS.XPath = "/xml/table1";
                xDS.EnableCaching = false;

                //bind to treeview
                rtrvxxxx.DataSource = xDS;
                rtrvxxxx.DataBind();

                #endregion
            }
            catch (Exception ex)
            {
               ex.Message()}
            }
        } 
```

# 4：数据访问层代码：

```
public static XmlDocument List_XML()
                    {

                            XmlDocument xmlDoc = new XmlDocument();
                            SqlConnection SQLConn = new SqlConnection();
                            SQLConn.ConnectionString = someclass.someotherclass.GetConnectionString();
                            try
                           {
                            SQLConn.Open();
                            SqlCommand custCMD = new SqlCommand("sp_someproc", SQLConn);

                            custCMD.CommandType = CommandType.StoredProcedure;
                            custCMD.Parameters.Add("@XmlResponse", SqlDbType.Xml).Direction = ParameterDirection.Output;
                            custCMD.ExecuteNonQuery();

                            if (custCMD.Parameters["@XmlResponse"].Value != null)
                            {
                                string xml = custCMD.Parameters["@XmlResponse"].Value.ToString();

                                xmlDoc.LoadXml(xml);
                            }
                            return xmlDoc;

                        }
                        catch (Exception exGEN)
                        {
                            throw exGEN;
                        }
                        finally
                        {
                            SQLConn.Close();

                        }

                    } 
```

**注意：**如果你看到查询有行，那些是树视图的第一层，第二行是第一行的内行，或者可以称它为父节点的子节点，第三行是第二行的内行或子行，所以如果第一行有一些记录它会输出那个，如果第二行有一些记录，它会输出那个。如果您看到树视图数据成员中的数据绑定部分是表名，而 textfiled 是第一行，则值字段可能是其他一些字段。没有使用过 asp.net 原始树视图，所以不知道它是如何工作的，这是用于 Telerik 树视图控制的。我还发现如果数据选择为 xml，速度会更快。"DS.XPath = "/xml/table1";" <= 此代码正在选择 xml 元素或根元素，然后在该元素中使用数据排序的第一个元素（第一行记录的表）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:00:22.157

看看你的递归条件：

```
INNER JOIN Emp_CTE ecte ON ecte.MunicNo = e.MunicNo 
```

这递归到同一个自治市。（除了当`MinicNo is null`。）

您没有发布足够的信息来找到合适的条件，但它可能看起来像：

```
INNER JOIN Emp_CTE ecte ON ecte.tablesysID = e.MunicNo 
```

# php - PHP：自定义会话处理程序

> ID：11784852
> 
> 赞同：-3
> 
> 时间：2012-08-02T19:58:21.493
> 
> 标签：php, session, handler

只是关于 php 会话处理程序的一个小问题，假设我想将会话存储在数据库中，因为我有多个服务器应该可以访问会话，我会使用[http://中描述的接口编写我自己的会话处理程序php.net/manual/en/class.sessionhandler.php](http://php.net/manual/en/class.sessionhandler.php)，但我该如何使用它？如果我做

```
session_set_save_handler(....);
session_start();
$_SESSION['key'] = 'value'; 
```

它会使用我的处理程序保存数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:11:35.010

您在 set_save_handler() 中定义和设置的类应该具有要定义的会话生命周期中所需的所有功能。其中包括 read()、write()、destroy() 等。

一旦正确定义，您仍然可以按照正常方式操作会话，但在后台，您定义的函数将根据您正在执行的会话事件执行。

例如 $_SESSION['key'] = 'value' 将执行 write() 函数（您可能在其中编写了数据库保存例程）

您可以在以下网址了解更多信息：[http ://us3.php.net/manual/en/function.session-set-save-handler.php](http://us3.php.net/manual/en/function.session-set-save-handler.php)

# jquery - asp.net c#添加和删除类jquery问题

> ID：11784855
> 
> 赞同：2
> 
> 时间：2012-08-02T19:58:31.110
> 
> 标签：jquery, asp.net, html, css

我添加了 JQuery，但失去了遍历导航网站不同部分的能力。这是切换类的工作[JFiddle](http://jsfiddle.net/QkVEA/12/)。

我的代码导航代码：

```
<form runat="server">
        <div id="new_menu" class="new_menu_header" runat="server">
            <ul>
                <li >
                    <a class="selected" href="Default.aspx">Home</a>
                </li>
                <li>
                    <a href="The_Team.aspx">The Team</a>
                </li>
                <li>
                    <a href="Advisory_Board.aspx">Advisory Board</a>
                </li>
                <li>
                    <a href="Contact.aspx">Contact</a>
                </li>
            </ul>
        </div>
</form> 
```

我放置此表单的主要原因是向你们展示我的 href 似乎被 onClick 覆盖（调用 JQuery 并忽略 Href）。

有人可以帮帮我吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:02:38.020

如果您`return false`从您的处理程序过程中，那么它将停止点击事件。这意味着，没有导航（这是默认行为）。

取出`return false`，它会尝试导航到`href`您在`a`.

# c# - AForge.net 的填充孔不起作用

> ID：11784859
> 
> 赞同：1
> 
> 时间：2012-08-02T19:59:07.790
> 
> 标签：c#, image-processing, computer-vision, gesture-recognition, aforge

我正在尝试平滑形态学操作。我已经在图像[1](https://i.stack.imgur.com/wPhXN.jpg)上完成了 4*4 腐蚀和 4*4 膨胀（我尽我所能在腐蚀和膨胀方面达到最佳效果） 。然后我检测到最大的斑点来滤除噪音。然后我的下一步是平滑图像[2的形态学运算，](https://i.stack.imgur.com/OjKg7.jpg) *以便我可以填充图像轮廓内的间隙*。**我使用以下代码段来填补使用 aforge 的空白。但是这个方法什么也不返回**。

```
public Bitmap fillGap(Bitmap image)
        {

            FillHoles filter = new FillHoles();
            filter.MaxHoleHeight = 5;
            filter.MaxHoleWidth = 5;
            filter.CoupledSizeFiltering = false;
            filter.Apply(image);
            return image;
        } 
```

我下一步要纠正什么？

![皮肤检测图像](../Images/c701b3e364d520da2706f93664190878.png) ![形态图像](../Images/32294be69b4ede5ace0197636922bb47.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:10:38.673

根据[API 文档](http://www.aforgenet.com/framework/docs/)，该`Apply`方法保持源图像不变。将方法中的最后两行替换为：

```
return filter.Apply(image); 
```

或使用该`ApplyInPlace`方法代替`Apply`：

```
filter.ApplyInPlace(image);
return image; 
```

顺便说一句，是否`MaxHoleHeight`设置`MaxHoleWidth`为足够大的值？

# python - 为什么这个 python 字典使用 setdefault() 乱序创建？

> ID：11784860
> 
> 赞同：7
> 
> 时间：2012-08-02T19:59:15.673
> 
> 标签：python, dictionary, for-loop, setdefault

我刚开始玩 Python（VBA 背景）。为什么这本字典会乱序创建？不应该是a：1，b：2 ...等吗？

```
class Card:
def county(self):
    c = 0
    l = 0
    groupL = {}  # groupL for Loop
    for n in range(0,13):
        c += 1
        l = chr(n+97)
        groupL.setdefault(l,c)
    return groupL

pick_card = Card()
group = pick_card.county()
print group 
```

这是输出：

```
{'a': 1, 'c': 3, 'b': 2, 'e': 5, 'd': 4, 'g': 7, 'f': 6, 'i': 9, 'h': 8, 'k': 11, 'j': 10, 'm': 13, 'l': 12} 
```

或者，它是否只是乱序打印？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-02T19:59:39.970

字典在 python 中没有顺序。换句话说，当您遍历字典时，键/项目“产生”的顺序​​不是您将它们放入字典的顺序。（在不同版本的 python 上尝试您的代码，您可能会得到不同顺序的输出）。如果你想要一个有序的字典，你需要一个`collections.OrderedDict`直到 python 2.7 才引入的字典。`ActiveState`如果您使用的是旧版本的 python，您可以找到等效的食谱。但是，通常只对项目进行排序就足够了（例如`sorted(mydict.items())`.

**根据要求进行编辑**，一个 OrderedDict 示例：

```
from collections import OrderedDict
groupL = OrderedDict()  # groupL for Loop
c = 0
for n in range(0,13):
    c += 1
    l = chr(n+97)
    groupL.setdefault(l,c)

print (groupL) 
```

# jquery - 清除文本区域元素

> ID：11784862
> 
> 赞同：1
> 
> 时间：2012-08-02T19:59:21.120
> 
> 标签：jquery, textarea, element

我很好奇是否可以在单击 div 元素时清除 textarea 元素。

我从这个标记开始：

```
jQuery('.hoverbgpfthnailiface').click(function(e){
    var target = e.target;

    while (target.nodeType != 1) target = target.parentNode;
    if(target.tagName != 'TEXTAREA'){
        jQuery('.header-search-form').css({ 'display' : 'none' });
        jQuery('*').show();
    }

});​ 
```

我的问题是如何在单击特定 div 时清除 textarea 元素？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-02T20:01:45.977

只需将值设置为`''`

```
$('#id_of_your_textarea').val(''); 
```

# progress-4gl - Progress ABL / 4GL 中的输出清理

> ID：11784868
> 
> 赞同：0
> 
> 时间：2012-08-02T19:59:43.313
> 
> 标签：progress-4gl, openedge

对于 Progress 4GL / ABL的 php 的[http://php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)是否有类似的程序或在 Progress 社区中遵循用于编写净化文本的最佳实践到外部和不受信任的实体（网站、mysql 服务器和 API）？

QUOTE 或 QUERY-PREPARE 函数将不起作用，因为它们会为 Progress 的动态查询而不是外部实体清理文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:23:20.563

听起来你自己滚是唯一的方法。出于我的目的，我模拟了 mysql_real_escape_string 函数

```
/* TODO progress auto changes all ASC(0) characters to space or ASC(20) in a non db string. */
/* the backslash needs to go first */
/* there is no concept of static vars in progress (non class) so global variables */
DEFINE VARIABLE cEscape AS CHARACTER EXTENT INITIAL [
 "~\",
 /*"~000",*/
 "~n",
 "~r",
 "'",
 "~""
 ]
 .
DEFINE VARIABLE cReplace AS CHARACTER EXTENT INITIAL [
 "\\",
 /*"\0",*/
 "\n",
 "\r",
 "\'",
 '\"'
 ]
 .

FUNCTION mysql_real_escape_string RETURNS CHARACTER (INPUT pcString AS CHAR):
    DEF VAR ii AS INTEGER NO-UNDO.

    MESSAGE pcString '->'.

    DO ii = 1 TO EXTENT(cEscape):
         ASSIGN pcString = REPLACE (pcString, cEscape[ii], cReplace[ii]).
    END.

    MESSAGE pcString.

    RETURN pcString.
END. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:34:19.333

与您引用的示例最接近的类似物是编写一个执行此操作的函数：

```
 DEFINE VARIABLE ch-escape-chars AS CHARACTER    NO-UNDO.
 DEFINE VARIABLE ch-string       AS CHARACTER    NO-UNDO.
 DEFINE VARIABLE i-cnt           AS INTEGER      NO-UNDO.

 DO i-cnt = 1 TO LENGTH(ch-escape-char):

     ch-string = REPLACE(ch-string,
                         SUBSTRING(ch-escape-char, i-cnt, 1),
                         "~~" + SUBSTRING(ch-escape-char, i-cnt, 1)).

 END. 
```

在哪里

```
 ch-escape-chars are the characters you want escape'd. 
 ch-string is the incoming string.
 "~~" is the esacap'd escape character. 
```

# php - 链接到根 PHP 之上的文件

> ID：11784874
> 
> 赞同：0
> 
> 时间：2012-08-02T20:00:09.440
> 
> 标签：php, download, webserver, hosting

我最近换了服务器。从带控制面板的共享到 VPS

在我的旧服务器上，这个 PHP 工作：

```
header("Content-disposition: attachment; filename= 'welcome.doc'");
header('Content-type: application/msword');
readfile("/home/abcme/aboveroot/admin/welcome.doc"); 
```

新服务中存在相同的文件夹结构。home 上方有一个名为 aboveroot 的文件夹，其中有一个名为 admin 的文件夹和一个名为 welcome.doc 的文件

我更改了 /home/abcme 以便“abcme”是正确的新帐户名

现在我收到一条错误消息，说找不到文件。是否需要在我的服务器中启用某些功能，或者还有什么可以解释这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:06:58.270

根据你所说的结构是这样的：

```
>aboveroot 
  -home
  -admin
    -welcome.doc 
```

所以你的标题会说（假设 /aboveroot 是你的 webroot，这似乎不是给定名称的情况）：

```
header("Content-disposition: attachment; filename= 'welcome.doc'");
header('Content-type: application/msword');
readfile("/aboveroot/admin/welcome.doc"); 
```

# c# - 在构造之前发送对象的引用

> ID：11784878
> 
> 赞同：63
> 
> 时间：2012-08-02T20:00:34.300
> 
> 标签：c#, reference, constructor

我在我们的一个应用程序中看到了以下代码：

```
public class First()
{
      private Second _second;

      public First()
      {
          _second = new Second(this);
          // Doing some other initialization stuff,
      }

}

public class Second
{
    public Second(First f)
    {
    }
} 
```

在构造函数中，我们在完全构造*之前*`First()`发送类的引用不是很糟糕吗？我认为只有在控制逻辑离开构造函数后才完全构造对象。`First()`

 *或者这样可以吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-08-02T20:05:30.610

> 我的问题是，在 First() 构造函数中，在它完全构造之前发送类 First() 的引用不是很糟糕吗？

有些。当然，这*可能*是一个问题。

如果`Second`构造函数*只是*保留一个引用以供以后使用，那还不错。另一方面，如果`Second`构造函数回调`First`：

```
public Second(First f)
{
    f.DoSomethingUsingState();
} 
```

......而且状态还没有建立，那当然是一件非常糟糕的事情。如果你调用一个*虚*方法，`First`那么它可能会更糟——你最终可能会调用一些甚至没有机会运行它的*任何*构造函数主体的代码（尽管它的变量初始化器将被执行）。

特别是，`readonly`字段可能首先以一个值出现，然后以另一个值出现......

不久前我[在博客上写过这个](https://codeblog.jonskeet.uk/2010/09/02/don-t-let-this-get-away/)，它可能会提供更多信息。

当然，*如果不做*这种事情，很难创建两个相互引用的不可变对象......

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-02T20:09:24.167

如果您遇到这种模式，您可能会检查它是否可以重构为：

```
public class First()
{
      private Second _second;

      public First()
      {
          _second = new Second(this);
          // Doing some other initialization stuff,
      }

      private class Second
      {
          public Second(First f)
          {
          }
      }
} 
```

将依赖项传递给构造函数意味着两个类之间存在一种紧密耦合，因为 First 必须相信 Second 知道它在做什么，并且不会尝试依赖 First 的未初始化状态。当 Second 是一个私有的嵌套子类（因此是一个清晰的实现细节）或者可能是一个内部类时，这种强耦合更合适。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-02T20:05:15.113

答案是，这取决于。但是，一般来说，由于潜在的后果，这将被认为是一个坏主意。

不过，更具体地说，只要在构建之前`Second`没有实际使用任何东西`First`，那么你应该没问题。如果你不能以某种方式保证，你肯定会遇到问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-02T20:05:19.497

是的，这有点糟糕。`First`有可能在完全初始化之前对字段做一些事情，这会导致不希望的或未定义的行为。

当您从构造函数调用虚拟方法时，也会发生同样的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-02T20:10:40.220

与例如 C++ 相比，CLR 没有完全构造或不完全构造的对象的概念。一旦内存分配器返回一个归零的对象并且在构造函数运行之前，它就可以使用（从 CLR 的角度来看）。它有它的最终类型，对虚拟方法的调用调用最派生的覆盖等。您可以`this`在构造函数的主体中使用，调用虚拟方法等。这确实可能导致初始化顺序问题，但 CLR 中没有任何东西可以阻止它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-02T20:07:08.200

确实，这可能会导致您所描述的问题。因此，通常建议`_second = new Second(this);`仅在您的评论暗示的其他初始化内容之后运行命令。

很多时候，这种模式是存储两个对象之间相互引用的唯一解决方案。然而，在许多情况下，这发生在接收可能未完全初始化的实例的类与引用的类紧密耦合（例如，由同一作者编写；同一应用程序的一部分；或嵌套类，可能是私人的）。在这种情况下，可以避免负面影响，因为作者`Second`知道（或者甚至可能写过）`First`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-02T20:10:03.010

这取决于场景，但可能导致难以预测行为。如果在构造函数`Second`中做任何事情，`First`一旦你改变`First`. 其他构造函数指南还建议您不应在构造函数中调用虚拟或抽象方法（在构造的类上），因为它可能会导致类似的后果，其中行为可能难以推理。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-02T20:13:38.770

这个问题的答案取决于 和 之间关系的`First`性质`Second`。

想想什么样的对象可能由*另一个*对象组成，另一个对象本身由（或需要其初始化）类型的对象组成`First`。在这种情况下，您应该警惕创建带有循环的对象图。

然而，在很多合理的情况下，对象图中应该出现循环。如果`First`依赖状态`Second`来执行其初始化，那么您应该保持方法不变，这通常是可以的。如果`Second`依赖于状态`First`来执行自己的初始化，那么您可能应该重新排列构造函数：

```
 public First()
  {

      // Doing some other initialization stuff,
      _second = new Second(this);
  } 
```

如果上述两个陈述都是正确的（`Second`取决于 的状态`First`，并且`First`取决于 的状态`Second`），那么您几乎可以肯定地重新审视您的设计，并更准确地弄清楚 和 之间关系的`First`性质`Second`。（也许应该有一些对象`Third`包含对和的引用`First`，`Second`并且后两者之间的关系应该由 仲裁`Third`。）*

# ios - -[__NSCFSet _isNaturallyRTL]- 错误

> ID：11784883
> 
> 赞同：-1
> 
> 时间：2012-08-02T20:01:11.293
> 
> 标签：ios, cocoa-touch, nsstring, uitextfield

。H

```
@property (strong, nonatomic) IBOutlet UITextField *responsibleField; 
```

.m

```
@synthesize responsibleField;

responsibleField.text = [goal valueForKeyPath:@"responsibility.actorNaam"]; 
```

并且 actorNaam 在我的数据模型中属于 String 类型 .. 并且我的文本字段已正确连接

错误：

***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFSet _isNaturallyRTL]：无法识别的选择器发送到实例 0x6e8e9d0”

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:08:26.943

`[goal valueForKeyPath:@"responsibility.actorNaam"];`正在返回一个类型的对象，`NSSet` `responsibleField.text`期待一个`NSString`. 检查您设置 key path 值的代码`responsibility.actorNaam`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T21:25:33.080

at 的对象`goal.responsibility`是一个 NSSet，在 NSSet 上调用会`valueForKeyPath:`返回指定 keypath 处的值的 NSSet。

如果您只想从集合中“选择一个”，请使用以下命令：

```
[ [ goal valueForKeyPath:@"responsibility.actorNaam" ] anyObject ] ; 
```

即问题是你想要**什么**责任？

# javascript - 在创建视图期间使用 javascript - mvc.net

> ID：11784884
> 
> 赞同：0
> 
> 时间：2012-08-02T20:01:14.870
> 
> 标签：javascript, jquery, asp.net-mvc

我正在为 .net 使用 MVC 模式，并且我有以下代码：

```
<ol class='TextBoxesGroup'>
    @foreach (Employee e in rm.employees)
    {
         <script type="text/javascript">addPrefRow($(this),@Html.Raw(Json.Encode(e.LanId)), @Html.Raw(Json.Encode(e.FirstName+" "+e.LastName)));</script>
    }
</ol> 
```

问题是，在函数“addPrefRow”中，第一个参数为空。我希望它是一个代表有序列表的 JQuery 对象。

函数“addPrefRow”创建了一些 html。我会把html直接放在上面的代码中，但是还有其他时候调用这个函数，我不想在两个地方维护html。

有没有办法做到这一点？

谢谢！

注意：如果我执行 javascript`alert('test');`它可以工作。那么为什么我不能在这里执行其他javascript呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:07:38.660

```
 @{
     // use this var to store the current list id.
     var listId = "";
  } 
```

然后为每个列表提供唯一的 id：

```
 @{
      listId = Guid.NewGuid().ToString("N");
  } 
```

...并使用它来获取列表元素：

```
<ol class='TextBoxesGroup' id="@listId"> 
```

您还需要将对 addPrefRow() 的调用放入 jQuery.domready() 事件中：

```
<script type="text/javascript">$(function(){addPrefRow($("#@listId"), ...;});</script> 
```

# excel - SQL中将列分别转换为行

> ID：11784887
> 
> 赞同：0
> 
> 时间：2012-08-02T20:01:34.133
> 
> 标签：excel, vba, ms-access, rows

我真的一直在努力寻找答案，但仍然找不到。请帮忙！

我有一个 Excel 工作簿，我想使用 VBA 或 SQL 在 Access 中进行操作。

我目前面临的问题是我有一个电子表格，其中每一行都基于一张发票（2500 行）。每行由“发票编号”“采购订单编号”“发票日期”“发票总计”组成。我们可以称之为发票数据

然后在该行中有基于行项目信息的单元格，“项目编号”“项目成本”“项目数量”。行项目数据

并且行项目数据重复，直到涵盖发票中的每个行项目（即，如果有 70 个行项目，将有 70 个不同的行项目数据和一堆列）

我需要一种方法来使每一行都基于行项目信息，而不是发票信息，而每一行仍保留项目各自的发票信息（“发票编号”“采购订单编号”“发票日期”“发票总计”）。

此外，代码需要足够简单，以至于我不需要告诉它复制第 1 行项目数据然后第 2 行项目数据等，直到第 70 行数据。（也许它可以理解每 3 列是一个新项目，并且它所在的行具有它将采用的发票信息）。当第 1 行有空白列时，它也不能停止，因为第 30 行可能有 50 个项目。（发票 1 有 3 个行项目，发票 30 有 50 个行项目）

我将继续寻找答案，如果我找到答案，我会在这里发布.. 提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:40:03.067

```
Sub UnPivot()

Const INV_COLS As Integer = 4   'how many columns in the invoice info
Const ITEM_COLS As Integer = 3  'columns in each set of line item info

Dim shtIn As Worksheet, shtOut As Worksheet
Dim c As Range
Dim rOut As Long, col As Long

    Set shtIn = ThisWorkbook.Sheets("Data")
    Set shtOut = ThisWorkbook.Sheets("Output")

    Set c = shtIn.Range("A2") 'first cell in invoice info
    rOut = 2                  'start row on output sheet

    'while the invoice cell is non-blank...
    Do While Len(c.Value) > 0
        col = INV_COLS + 1   'column for first line item
        'while there's info in the line item cell 
        Do While Application.CountA(shtIn.Cells(c.Row, col).Resize(1, ITEM_COLS)) > 0

            'copy the invoice info (four cells)
            c.Resize(1, INV_COLS).Copy shtOut.Cells(rOut, 1)

            'copy the line item info (3 cells)
            shtIn.Cells(c.Row, col).Resize(1, ITEM_COLS).Copy _
                             shtOut.Cells(rOut, INV_COLS + 1)

            rOut = rOut + 1           'next output row
            col = col + ITEM_COLS     'move over to next line item
        Loop
        Set c = c.Offset(1, 0) 'move down one cell on input sheet
    Loop

    shtOut.Activate
End Sub 
```

# flash - Kinect - 使用深度将（x，y）像素坐标映射到“真实世界”坐标

> ID：11784888
> 
> 赞同：3
> 
> 时间：2012-08-02T20:01:40.810
> 
> 标签：flash, coordinates, kinect

我正在开发一个使用 Kinect 和 OpenCV 将 fintertip 坐标导出到 Flash 以用于游戏和其他程序的项目。目前，我们的设置基于颜色工作，并以 (x, y, z) 格式将指尖点导出到 Flash，其中 x 和 y 以像素为单位，z 以毫米为单位。

但是，我们希望使用 Flash 中的 z 深度值将这些 (x, y) 坐标映射到“真实世界”值，例如毫米。

据我了解，Kinect 3D 深度是通过沿相机水平投影 X 轴、沿相机垂直投影 Y 轴以及直接从相机镜头向前伸出的 Z 轴来获得的。深度值是从任何给定对象到 XY 平面的垂线长度。请参阅以下链接中的图片（从微软网站获得）。

[Microsoft 深度坐标系示例](http://i.msdn.microsoft.com/dynimg/IC568991.png)

此外，我们知道 Kinect 的水平视野以 117 度角投射。

使用这些信息，我想我可以将任何给定点的深度值投影到 x=0, y=0 线上，并在该点绘制一条平行于 XY 平面的水平线，与相机的视野相交。我最终得到一个三角形，分成两半，高度与所讨论物体的深度相同。然后我可以使用一点三角函数来求解视野的宽度。我的等式是：

W = tan(theta / 2) * h * 2

在哪里：

*   W = 视野宽度
*   theta = 水平视场角（117 度）
*   h = 深度值

（对不起，我不能发图片，如果可以的话我会）

现在，求解 1000 毫米（1 米）的深度值，得到的值约为 3264 毫米。

但是，当实际查看生成的相机图像时，我得到了不同的值。即，我在距离相机 1 米的地方放置了一个米棒，注意到框架的宽度最多为 1.6 米，而不是计算中估计的 3.264 米。

我在这里缺少什么吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T20:52:13.263

深度流是正确的。您确实应该获取深度值，然后通过 Kinect 传感器，您可以轻松地定位现实世界中相对于 Kinect 的点。这是通过简单的三角函数完成的，但是您必须记住，深度值是从 Kinect“眼睛”到测量点的距离，因此它是长方体的对角线。

实际上，请点击此链接[How to get real world coordinates (x, y, z) from a distinct object using a Kinect](https://stackoverflow.com/questions/10417495/kinect-how-to-get-real-world-coordinates-x-y-z-from-a-distinct-object)

重写是没有用的，你有正确的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T20:08:28.687

一些东西：

A) 我知道你从 Kinect 传感器的一个功能中获得了 117 度 FOV，但我仍然不相信这是正确的。那是一个巨大的FOV。当我在我的 Kinect 上运行该功能时，我实际上得到了相同的数字，但我仍然不相信。虽然 57（或某些来源的 58.5）看起来很低，但它绝对更合理。尝试将 Kinect 放在平坦的表面上，并将对象放在其视野内，然后测量 FOV。不精确，但我认为您不会发现它超过 100 度。

B) 我看到一篇文章展示了实际距离与 Kinect 报告的深度；它不是线性的。这实际上不会影响您的 1.6 米三角问题，但在未来需要牢记这一点。

C）我强烈建议更改您的代码以接受来自 Kinect 的真实世界点。更好的是，如果可能的话，只需发送更多数据。您可以继续提供当前数据，并将真实世界的坐标数据添加到该数据上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-20T02:28:33.240

矢量减法应该可以得到 Kinect 给出的任意两点之间的距离。您必须查找在您的特定环境中执行矢量减法的最佳方法，但我希望这无论如何都会有所帮助。在我使用的 Processing 中，有一个 PVector 类，在哪里减去你只需去 PVector difference = PVector.sub(vector1, vector2)，其中 vector1 和 vector2 是代表你的两个点的向量，而差异是两者之间的新向量两点。然后，您需要差异向量的大小。同样，在处理中，这可以通过幅度 = 差异.mag() 简单地找到。这个量级应该是你想要的距离。

这是处理中的两个向量和一般向量的一个很好的概要：[https ://processing.org/tutorials/pvector/](https://processing.org/tutorials/pvector/)

# visual-studio-2010 - 在 .net windows 应用程序中修改 html 文件

> ID：11784893
> 
> 赞同：1
> 
> 时间：2012-08-02T20:01:46.900
> 
> 标签：visual-studio-2010, google-maps, webbrowser-control, html-editor, windows-applications

我有一个 map.html 文件，其中包含一个用于 google maps api v3 的脚本，我之前一直在尝试使用 webbrowser1.DocumentText 和 Webbrower1.Document.InvokeScript 运行这个脚本，但没有成功。

这次我将 map.html 托管在一个网站上，我的目标是能够修改这个 html 文件，然后在我的 Windows 应用程序上运行它以显示所需的地址。

以下是托管的 map.html 的代码：http: [//url.com/map.html](http://url.com/map.html)

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<script type="text/javascript" src="http://maps.google.com.mx/maps/api/js?sensor=true&language=es"></script>
<script type="text/javascript">

    var geocoder;
    var map;

    function initialize() {

        geocoder = new google.maps.Geocoder();
        //var latlng = new google.maps.LatLng(-34.397, 150.644);
        var myOptions = {
            zoom: 16,
            //center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        //var address = document.getElementById("address").value;
        var address = "Miami Beach, Flordia" //Address to modify in order to display

        geocoder.geocode({ 'address': address }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });
            } else {
                alert("Geocode was not successful for the following reason: " + status);
            }
        });

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    }

    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>

  </body>
</html> 
```

如果您将此代码复制并粘贴到 html 中，它应该显示 Miami Beach, FL

现在在我的 Windows 应用程序上，我想编辑托管在一个网站上的这个 html，我想将佛罗里达州迈阿密海滩更改为佛罗里达州那不勒斯作为示例。

然后在我的 Windows 应用程序上使用网络浏览器并将其显示为 Webbrowser1.Navigate("http://url.com/map.html")

非常感谢您的帮助。

我确实发现了如何在将 html 本地保存在我的计算机上时对其进行修改，但对于我真正需要的，这不是一种可行的方法。

谢谢你，

里奥·P。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T10:32:29.570

我不会尝试修改 html 代码。由于谷歌地图代码都是 JS，我会编写一个 JS 函数来将地图移动到新位置。您可以从您的应用程序中调用该函数（甚至从那里插入它）。

```
using mshtml;

//First, navigate to your page:
Webbrowser1.Navigate("http://url.com/map.html")

void Webbrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
        //Then call your move function with the new target:
        mshtml.IHTMLDocument2 doc = (mshtml.IHTMLDocument2)Webbrowser1.Document.DomDocument;
        mshtml.IHTMLWindow2 window = (mshtml.IHTMLWindow2)doc.parentWindow;
        window.execScript("yourMapMoveFunction('Naples,Florida');");
} 
```

顺便说一句，您的链接不显示地图...

# java - 将 Java ENUM 转换为 XML

> ID：11784897
> 
> 赞同：3
> 
> 时间：2012-08-02T20:02:09.657
> 
> 标签：java, xml, jaxb

我想从带有参数的枚举类型中创建一个 xml。

例如：

```
@XmlRootElement(name="category")  
@XmlAccessorType(XmlAccessType.NONE)  
public enum category{  
     FOOD(2, "egg"),  

     private final double value;  

     @XmlElement  
     private final String description;  

    private Category(double value, String name){  

       this.value = value;  
       this.description = name;  
    }  
} 
```

我希望生成的 XML 是这样的

```
 <category>  
 FOOD
 <description>Egg</description>  
 </category> 
```

但是，这就是我所拥有的：

```
<category>FOOD</category> 
```

javax.xml.bind.annotation 中的任何注释都可以做到这一点吗？

对不起，我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T17:28:41.017

你可能想要这个

```
marshaller.marshal(new Root(), writer); 
```

输出`<root><category description="egg">FOOD</category></root>`

因为@XmlValue 和@XmlElement 不允许在同一个类中，所以我将其更改为属性

```
@XmlJavaTypeAdapter(CategoryAdapter.class)
enum Category {
    FOOD(2D, "egg");

    private double value;

    @XmlAttribute
    String description;

    Category(double value, String name) {
        this.value = value;
        this.description = name;
    }
}

@XmlRootElement(name = "root")
@XmlAccessorType(XmlAccessType.FIELD)
class Root {
    @XmlElementRef
    Category c = Category.FOOD;
}

@XmlRootElement(name = "category")
@XmlAccessorType(XmlAccessType.NONE)
class PrintableCategory {

    @XmlAttribute
    //@XmlElement
    String description;

    @XmlValue
    String c;
}

class CategoryAdapter extends XmlAdapter<PrintableCategory, Category> {

    @Override
    public Category unmarshal(PrintableCategory v) throws Exception {
        return Category.valueOf(v.c);
    }

    @Override
    public PrintableCategory marshal(Category v) throws Exception {
        PrintableCategory printableCategory = new PrintableCategory();
        printableCategory.description = v.description;
        printableCategory.c = v.name();
        return printableCategory;
    }

} 
```

# mapping - 关于与核函数和支持向量机相关的术语的具体查询

> ID：11784903
> 
> 赞同：2
> 
> 时间：2012-08-02T20:02:33.830
> 
> 标签：mapping, kernel, machine-learning, svm

我目前正在阅读 Nello Cristianini 所著的《支持向量机和其他基于内核的方法的介绍》一书，我无法理解他在第 2 章以及稍后在第 2 章中讨论的线性学习机器的双重表示概念。在第 3.2 节“隐式映射到特征空间”中的第 3 章，我不知道这种对偶表示是否是一个一般概念，或者它是否是本书特有的命名约定。所以这就是为什么我特别引用这本书和如果有人已经读过它的部分。如果这是一个一般概念，但是如果有人能澄清线性学习机的双重表示意味着什么以及这种双重表示的优点是什么，我将不胜感激？

我希望这不是一个太模糊的问题，但不幸的是，我没有这些概念的背景或理解来进一步阐述我的查询。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:29:30.023

这是一个笼统的概念，它不是特定于本书的。

对偶问题的主要好处是数据点只出现在点积内。每对数据点的点积通常用核矩阵表示。如果您使用不同类型的内核，您将获得不同类型的分类器（点：线性、rbf、：rbf 网络等）。这被称为内核技巧（或者就像您正在阅读的书籍似乎将其称为特征空间的隐式映射），这是过去十年机器学习中最重要的突破之一。

不过，并非所有东西都可以是内核。核矩阵需要是半正定的。维基百科上有一篇很棒的关于[内核技巧的文章。](http://en.wikipedia.org/wiki/Kernel_trick)此外，不仅可以对 L2 正则化二进制分类器 (SVM) 进行内核化，还有内核感知器、内核 PCA、内核一切。

# regex - 为什么这个数字正则表达式（带有交替）不符合预期？

> ID：11784904
> 
> 赞同：1
> 
> 时间：2012-08-02T20:02:34.930
> 
> 标签：regex

我正在尝试匹配以下字符串：

```
9
9.
9.5
.5 
```

到目前为止，这是我为实现此目的而制作的：

```
(?<acreage>(?(\d+)((\.\d*)?)|(\.\d+))) 
```

当我传入 9.5 时，它返回 NULL 和 .5 表示面积。我需要它传回 9.5。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:05:10.870

所以你有四种情况：

1.  匹配类似的东西`x`
2.  匹配类似的东西`x.y`
3.  匹配类似的东西`x.`
4.  匹配类似的东西`.y`

所以你去：

```
\d+\.\d+|\d+\.?|\.d+ 
```

您可以通过将第一组中的数字设为可选来摆脱后两种可能性中的任何一种，*但不能同时使用两者*。例如：

```
\d*\.\d+|\d+\.? 
```

或者，使用匹配组：

```
(?<acreage>\d*\.\d+|\d+\.?) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:08:06.343

使用这个正则表达式

`^(?=\.?\d+\.?\d*)\d*\.?\d*$`

或者

`^(\d+\.\d*)|(\d*\.\d+)|(\d+)$`

# javascript - 将元素添加到 dom 并使用 jquery 应用类不应用 css3 转换

> ID：11784912
> 
> 赞同：4
> 
> 时间：2012-08-02T20:03:33.353
> 
> 标签：javascript, jquery, css, css-transitions

首先，我的演示在这里：[JsFiddle](http://jsfiddle.net/jeschafe/cUQtq/11/)。

我正在尝试使用 jquery 向 dom 添加一个元素，然后让它做一些 css3 过渡动画。我不确定为什么它在第一次附加时不起作用。我单击按钮并附加，但是当我将类添加到 div 时，它不会为它设置动画。它只是应用没有动画的 css。

`div.addClass('test')`知道为什么在附加元素后这对右边不起作用吗？

可能[与使用 Jquery 添加类来触发 CSS3 转换相同](https://stackoverflow.com/questions/7715039/trigering-a-css3-transition-with-adding-a-class-with-jquery)

但我很好奇是否有任何新的解决方案。那一个似乎并没有真正得到回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:51:47.470

您文章中的建议似乎有些奏效，我看到您注释掉的代码，看起来超时需要更低，或者需要与类选择器而不是变量/ div 一起应用。真的不知道它为什么起作用，我只是摆弄。

我在您的小提琴中更改了一行以反映该文章的建议。

```
setTimeout(function(){$('.article').addClass('test').removeClass('test2');}, 0) 
```

# jquery - 如何仅使用 jQuery/javascript 定位索引页面？

> ID：11784916
> 
> 赞同：0
> 
> 时间：2012-08-02T20:03:50.077
> 
> 标签：jquery

我所做的实际上是我使用 css3 为几个 div 添加了一些淡入淡出效果。起初它看起来不错，但是当您开始浏览该站点时，看到这种效果会变得很烦人，因此我决定不摆脱动画，而仅将其保留在主页上。所以，实际上我有这个 jQuery 代码：

```
if (it is www.mydomain.com, but not www.mydomain.com/aaaa (or anything) ) {
$("#header").addClass("class1 class2 class3");

} else {
$("#header").removeClass("class1 class2 class3");
} 
```

如何检查 mydomain.com/... 之后是否有任何内容，或者您​​可以提出更好的解决方案？

我不能用 css 做到这一点，因为我将向 header.php 文件添加内容，这是所有页面所必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:06:35.743

假设您的索引页面的路径名为`/`，并且其他页面的路径名长于一个字母，您可以这样做：

```
if (document.location.pathname.length > 1) {
     //do something
} 
```

或者，如果您的索引页面具有其他页面没有的某个元素，您可以执行以下操作：

```
if ($("#elementID").length) {
     //do something
} 
```

或者如果你这样做：

```
<body class="index"> 
```

在您的 html 中，您可以执行以下操作：

```
if ($('body').is('.index'))  {
     //do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:06:19.483

你可以检查 URI

或者

为该 javascript 创建一个索引特定的包含。

第二种选择方式更清洁 IMO。

# modularity - 如何解决避免常见传递 Xcode 依赖项中的重复符号？

> ID：11784917
> 
> 赞同：3
> 
> 时间：2012-08-02T20:03:50.357
> 
> 标签：modularity, dll, xcode4.4

我有以下 Xcode 项目依赖项：

```
A -> C
B -> C 
```

当我单独构建这些时，一切正常。

但是，我想将`A`和添加`B`到同一个 Xcode 项目，创建以下依赖关系图：

```
 / -> A -> C
D-<
    \ -> B -> C 
```

这会导致重复符号错误，基本上是 DLL 地狱。在允许项目独立的同时解决这个问题的好方法是什么？我意识到我可以分解`A`和`B`对 的依赖`C`，然后在 中重新制作该依赖`D`，但我希望`A`并且`B`可以独立构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:46:54.933

在 A 和 B 的项目文件中，从“将二进制文件与库链接”中删除 C，同时将其保留在目标依赖项中。这允许您在 A 和 B 中使用 C，但不能在 D 中使用 C。要在 D 中使用 C，请将其直接添加到 D（不要指望 A 或 B 将其传递下去）。

# .net - 在一个类中只使用共享函数/方法是一个好习惯吗？

> ID：11784918
> 
> 赞同：1
> 
> 时间：2012-08-02T20:03:51.653
> 
> 标签：.net, vb.net, winforms

抱歉标题太长了。这是我在使用 Windows 窗体应用程序时经常遇到的示例情况。我的应用程序中的大部分代码都以 UI 为中心，所以碰巧我的大部分代码都在主类 (MainWindow) 中。这是我计划如何分解代码的类比。当用户执行操作时，我必须将压缩文件写入磁盘。所以它看起来像这样。这是一个好习惯吗。这只是试图更好地组织我的代码。

```
Public class MainForm

    Private Sub TempButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TempButton.Click
         Compression.CompressFile(fileStream)
    End Sub

End Class

Public Class Compression

     Private Sub New
          'Private constructor
     End Sub

     Public Shared Sub CompressFile(ByVal inFile as stream)

     End Sub

     Public Shared Sub DeCompressFile(ByVal inFile as stream)

     End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:06:12.250

这是一种常见的模式。

但是，这些函数应该放在一个`Module`（或`static class`C# 中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:09:10.407

如果类的方法不需要类对象的实例，那么最好将方法设为共享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:11:00.890

> **在一个类中只使用**共享函数/方法是一个好习惯吗？

不，通常开发人员调用这些帮助类。刚开始可能看起来没问题，但很快这些助手类就会像疯了一样成长并且包含很多责任。这些助手类本质上是静态的。这些违反了面向对象设计的 SRP（单一责任原则）。我称它们为上帝班。他们什么都知道:)

您应该更喜欢使用公共基类或抽象类。

# vba - 图表不在 MS Access 表单中呈现

> ID：11784923
> 
> 赞同：1
> 
> 时间：2012-08-02T20:04:39.407
> 
> 标签：vba, ms-access, charts, ms-access-2003, repaint

我创建了一个包含 5 个图表的表单。打开时，光标变化了5次，显然查询到了数据，但图表没有渲染，留空。但是，当将表单移出屏幕并移回时，会显示部分图表，因此似乎只是缺少重绘。

我尝试执行`me.chart1.repaint`几个事件，但我没有找到合适的事件，我不确定是否`me.chart1.repaint`真的有必要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T20:49:43.197

```
Private Sub chart1_Updated(Code as integer)
    me!chart1.Visible = True
End Sub 
```

如果可见已经是真的，请不要担心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:46:56.360

我正在使用此代码作为解决方法：

```
 Private Sub chart1_Updated(Code As Integer)
      DoCmd.Minimize
      [Forms]![myform].SetFocus
      DoCmd.Restore
 End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-20T16:00:52.203

有时表单在渲染图形时做了太多的事情，而实际的绘画在处理下一个对象之前没有时间完成。您可以像这样强制访问“喘口气”：

```
Private Sub Detail_Paint()

    DoEvents

End Sub 
```

由于表单的详细信息部分正在执行实际渲染，因此它有机会在继续下一个之前完成每个对象。

# ruby - 如何使用 ruby 从 Instagram API 获取 JSON

> ID：11784928
> 
> 赞同：1
> 
> 时间：2012-08-02T20:05:11.390
> 
> 标签：ruby, ruby-on-rails-3, instagram

我正在尽我所能从 instagram API 中获取 JSON。这是我在 Rails 中的 rake 任务中尝试的代码。

```
require 'net/http'

url = "https://api.instagram.com/v1/tags/snow/media/recent?access_token=522219.f59def8.95be7b2656ec42c08bff8a159a43d06f"
resp = Net::HTTP.get_response(URI.parse(url))
puts resp.body 
```

我最终在终端中得到的只是“rake 中止！到达文件结尾”

如果您查看 instagram 文档[http://instagram.com/developer/endpoints/tags/](http://instagram.com/developer/endpoints/tags/)并将以下 URL 粘贴到浏览器中，您将获得 JSON，所以我确定我做错了什么。

[https://api.instagram.com/v1/tags/snow/media/recent?access_token=522219.f59def8.95be7b2656ec42c08bff8a159a43d06f](https://api.instagram.com/v1/tags/snow/media/recent?access_token=522219.f59def8.95be7b2656ec42c08bff8a159a43d06f)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:18:24.537

它与 HTTPS url 有关，您需要修改代码以包含 SSL

```
require "net/https"
require "uri"

uri = URI.parse("https://api.instagram.com/v1/tags/snow/media/recent?access_token=522219.f59def8.95be7b2656ec42c08bff8a159a43d06f")
http = Net::HTTP.new(uri.host, uri.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Get.new(uri.request_uri)

response = http.request(request)
puts response.body 
```

或者，您可以使用诸如[https://github.com/jnunemaker/httparty](https://github.com/jnunemaker/httparty)之类的东西 来使用 3rd 方服务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:18:10.163

看起来您需要配置 net/http 以使用 SSL，因为您使用的是 https。

替代方案：将它与 Rails 一起使用，它也会动态解析 json：

`ActiveSupport::JSON.decode(open(URI.encode(url)))`

返回要使用的哈希

# jquery - 转动 .animate({"left": "+=50px"}, "slow"); 左-右切换功能

> ID：11784937
> 
> 赞同：0
> 
> 时间：2012-08-02T20:05:32.873
> 
> 标签：jquery, jquery-ui, jquery-animate, toggle

我在弄清楚如何将 .animate left 函数转换为切换动画函数时遇到了一点麻烦，即单击一次动画左，再次单击动画右。

我现在使用的 jquery 是

```
$("#right").click(function(){
  $("#img-slider").animate({"left": "+=50px"}, "slow");
}); 
```

我尝试将 .animate 更改为 .toggle，但它似乎不起作用，我不知道为什么，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:09:22.153

尝试类似：

```
var goRight = true;
$("#right").click(function () {
    $("#img-slider").animate({left: goRight ? "+=50px" : "-=50px"}, "slow");
    goRight = !goRight;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:13:45.637

A`.toggle`可以代替`.click`，而不是`.animate`。不过，这有点冗长。

```
$("#right").toggle(function () {
  $("#img-slider").animate({"left": "+=50px"}, "slow");
}, function () {
  $("#img-slider").animate({"left": "-=50px"}, "slow");
}); 
```

`#right`另外，请注意在动画运行时单击时会发生什么；根据所需的行为，[`.stop`](http://api.jquery.com/stop/)可能需要 a 。

# android - 无法阻止 META_LEFT KeyEvent - 这是 Android 错误还是我？

> ID：11784944
> 
> 赞同：1
> 
> 时间：2012-08-02T20:05:57.967
> 
> 标签：android

我已经研究了好几天，并提出了这个问题的变体。我一直在简化问题，希望得到答案。我有一个蓝牙遥控器，它发送一个 META-LEFT 的 keyCode 117，它会导致平板电脑进入音乐播放器。这是不可取的，因为它退出了我的应用程序。

作为测试，我插入了以下代码：

```
public boolean dispatchKeyEvent(KeyEvent e){
        return true;
} 
```

这会阻止我的遥控器和平板电脑本身的所有键。平板电脑 BackArrow 被阻止，遥控器和平板电脑上的音量增大和音量减小被阻止（什么都不做）。但是 META_LEFT 正在弹出音乐播放器。它在我的 Galzxy Tab-2 和 Nexus-S 上都执行此操作。两者都是Android 4.0.4

有谁知道如何阻止这种情况发生？如果用户按下这个按钮，应用程序基本上已经崩溃了。

据此[，](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/KeyEventDispatcher.html) “回归真”；应防止发生任何动作。这是Android错误吗？我错过了什么吗？

# c++ - 当我安装了多个 Visual Studio 版本时，如何使用 Visual Studio 2008 构建 boost？

> ID：11784948
> 
> 赞同：10
> 
> 时间：2012-08-02T20:06:14.007
> 
> 标签：c++, visual-studio-2008, visual-c++, boost, bjam

我知道如何在我的机器上使用最新的视觉工作室来构建提升（[例如这个问题](https://stackoverflow.com/questions/3977555/build-boost-library)）

但是，我需要为 Visual Studio 2008 (vc9) 构建库

我尝试使用 toolset=vc9 但我遇到问题/没有成功。

如何为 vc9 构建库？

运行 boostrap 后，我尝试运行

```
b2 toolset=vc9 
```

但输出是：

> C:/Development/boost 50/boost_1_50_0/boost_1_50_0/tools/build/v2/build\toolset.jam:39: 在工具集中使用规则 vc9.init 在模块工具集中未知
> 
> C:/Development/boost 50/boost_1_50_0/boost_1_50_0/tools/build/v2\build-system.jam:481: 在进程显式工具集请求
> 
> C:/Development/boost 50/boost_1_50_0/boost_1_50_0/tools/build/v2\build-system.jam:562: 加载中
> 
> C:\Development\boost 50\boost_1_50_0\boost_1_50_0\tools\build\v2/kernel\modules.jam:283：在导入
> 
> C:\Development\boost 50\boost_1_50_0\boost_1_50_0\tools\build\v2/kernel/bootstrap.jam:142: 在 boost-build
> 
> C:\Development\boost 50\boost_1_50_0\boost_1_50_0\boost-build.jam:17：在模块范围内

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-27T19:38:02.757

工具集=msvc-9.0

我安装了 VS2008-Pro 和 VS2010-Express。默认使用 VS2010 运行。设置 toolset=msvc-9.0 会导致构建与 VS2008 一起运行。使用升压 1.51.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:57:16.607

您需要深入研究 How-To-Build-Boost 文档，尤其是查看[此](http://www.boost.org/doc/libs/1_50_0/more/getting_started/windows.html#id44)文档；[但是这里](http://www.boost.org/boost-build2/doc/html/bbv2/overview/configuration.html)指出了您需要指定特定 MSVC 版本的部分。这建议创建一个`user-config.jam`，这可能会起作用，但我创建了一个`project-config.jam`文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T01:25:42.220

我似乎可以通过从不同的 VC 命令行运行顶级 boost 构建（或元构建）脚本来做到这一点。例如，要使用 VC2012 构建，请使用 vc 2012 vars 启动命令行。对于 2010 年，同样如此。自动生成的构建脚本似乎做了正确的事情。

我确信有办法通过自己编辑构建脚本或设置工具集来做到这一点，但我没有成功。

# ajax - Telerik 网格在删除命令后显示一个空列

> ID：11784950
> 
> 赞同：2
> 
> 时间：2012-08-02T20:06:29.007
> 
> 标签：ajax, asp.net-mvc-3, asp.net-ajax, telerik

我正在使用带有 AJAX 绑定的 Telerik MVC Extensions Grid 控件，并运行删除命令。删除按预期工作，并且网格会更新，因此它不会显示已删除的行。

但是，删除其中一个网格列（第一个）后显示为空。第二列也有区别 - 'false'而不是未选中的框。任何想法为什么，我该如何解决？

我可以刷新屏幕，从而修复视图。但这是一个沉重的页面，我宁愿不进行第二次刷新。

![删除第一行：](../Images/cd2d0fc35f1e5edbf427e77a48ef47b0.png)

删除后，第一列显示为空： ![现在第一列是空的：](../Images/6c0700e821ac4c7081d940c964970dfb.png)

我的网格：

```
Html.Telerik()
    .Grid(Model)
    .Name("scenarioGrid")
    .DataBinding(dataBinding => dataBinding.Ajax()
                                    .Delete("Delete", "Scenario"))
    .DataKeys(keys => keys.Add(c => c.Id))
    .Columns(columns =>
        {
            columns.Template(o => Html.ActionLink(o.Name, "Index", new {id = o.Name})).Title("Scenario")
                .FooterTemplate(@<text>Total @Model.Count() </text>);
            columns.Bound(o => o.IsLocked);
            columns.Bound(o => o.ContractMonth);
            columns.Bound(o => o.CreateDate);
            columns.Command(commands => commands.Delete().ButtonType(GridButtonType.Image)).Title("Delete");
        }
    )
    .Sortable()
    .Scrollable(scroll => scroll.Height(200))
    .ClientEvents(events => events.OnDelete("onDelete").OnComplete("afterDelete")) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:38:50.013

您不应该使用`columns.Template`Ajax 绑定。它适用于服务器端绑定网格。你应该使用

```
columns.Bound(o => 0.whatever).ClientTemplate("convert your link to a string here"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:41:19.197

看起来您正在使用服务器绑定来加载网格，但使用 ajax 绑定来更新它。columns.Template 用于服务器绑定。您应该使用 ClientTemplate 进行 ajax 绑定。

# jquery - 使用 jQuery、jqGrid 运行 AJAX 查询时 IE8 浏览器冻结

> ID：11784952
> 
> 赞同：1
> 
> 时间：2012-08-02T20:06:37.723
> 
> 标签：jquery, jqgrid, internet-explorer-8, fiddler

我正在使用 jQuery 的 jqGrid 插件来显示数据库查询的结果（通过 AJAX 提交）。在 Firefox、Chrome 和 IE9 中一切正常，但**在 IE8 中有奇怪的行为**。似乎正在发生的事情是，当发起 AJAX 请求时，**浏览器冻结了大约 30 秒**——页面上没有控件可以选择或单击，甚至浏览器窗口也无法移动。

我刚刚开始调试并找到了[Fiddler2](http://www.fiddler2.com/)工具（对我来说是新的），这似乎表明实际的 AJAX 查询运行良好，但在那之后，Fiddler 显示了与`www.w3.org/TR/html4/loose.dtd`with的连接`result code 304`。当我查看该连接的时间线时，我发现**它需要 30 秒才能完成**。为什么会发生这种情况？

如果有帮助，这里有一些更详细的信息：

初始页面是`reports.php`. 此页面包含启动 AJAX 请求的按钮。

在 Fiddler 中，我看到了与 的连接`/xml/lsql_results_xml.php?[various parameters]`，然后我看到了一个 XML 响应，其中返回了正确的数据。这一切都按我的预期工作。

Fiddler 列表中的下一个连接是返回原始页面的连接： `/clients/reports.php`?[各种参数，包括一些似乎是由 jqGrid 添加的]。当我在 Fiddler 中查看返回的内容时，它似乎是由 reports.php 生成的整个 html 页面。

Fiddler 中的下一个连接是到 www.w3.org 的奇怪连接，长度为 30 秒。这似乎冻结了浏览器。

**什么解释了 AJAX 查询后 30 秒连接到松散.dtd 的这种奇怪行为？对进一步调试有什么建议吗？** *（显然，在某些时候我可能需要发布一个更详细的失败代码示例，但这需要创建这个专有系统的简化版本，所以目前，我只是在寻找更一般的指导，以防万一我我错过了一些非常基本的东西。）*

谢谢！——杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:40:50.123

我刚刚将该链接输入到我的浏览器中，它也几乎在 30 秒内返回。这个dtd和你的项目有关系吗，能拿出来或者下载到本地引用吗？看来这个网站不会更快地返回请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T19:10:41.563

事实证明，这个问题似乎是由于 jqGrid 的配置问题造成的。我在“主/详细信息”设置中使用 jqGrid，并且我的详细信息网格是在没有定义 url 的情况下定义的（因为在主网格中选择一行时将构造 url）。这在其他浏览器中似乎不是问题，但在 IE8 中，它似乎会导致 IE8 尝试从 DOCTYPE 加载 .dtd，这会导致整个浏览器冻结。为 mastergrid 指定一个虚拟 url（我刚刚使用“http://www.google.com”）解决了这个问题。（实际的虚拟 url 无关紧要，因为当在主网格中选择一行时，它会被实际的替代。

# c# - 如何使用 TreeView.Tag = 对象？

> ID：11784956
> 
> 赞同：1
> 
> 时间：2012-08-02T20:06:54.000
> 
> 标签：c#, .net, winforms, treeview

像这样的东西：

```
Dictionary<int, string> myData = new Dictionary<int, string>();
myData.Add(1, "England");
myData.Add(2, "Canada");
myData.Add(3, "Australia");
myTreeView.Node[0].Tag = myData; 
```

那我想得到这个对象，我该怎么做呢？像：

```
string str = new string();
str = myTreeView.Node[0].Tag[2]; // "str" should be equal to "Canada"
myTreeView.Node[0].Tag[1] = "Spain";
str = myTreeView.Node[0].Tag[1]; // now "str" is equal to "Spain" 
```

第二个问题 - 什么会返回这个表达式：

```
Dictionary<int, string> myData = new Dictionary<int, string>();
myData.Add(1, "England");
myData.Add(2, "Canada");
myData.Add(3, "Australia");

string str1 = new string();
str = myData[4]; // there isn't such a key as 4 
```

异常还是空？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:10:43.323

`Control.Tag`输入为，`object`因此您需要将其转换为`Dictionary<int, string>`：

```
Dictionary<int, string> dict = (Dictionary<int, string>)myTreeView.Node[0].Tag;
string str = dict[2]; 
```

同样设置一个值：

```
var dict = (Dictionary<int, string>)myTreeView.Node[0].Tag;
dict[1] = "Spain"; 
```

如果您尝试访问不存在的密钥，`KeyNotFoundException`则会抛出 a。`TryGetValue`您可以使用or来检查字典是否包含给定的键`ContainsKey`：

```
if(dict.ContainsKey(key))
{
    var value = dict[key];
}
else
{
} 
```

TryGetValue 在一次调用中进行查找并将给定变量设置为值（它存在），因此通常是首选。

```
string value;
if(dict.TryGetValue(key, out value))
{
    //use value
}
else { ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:09:48.160

> 异常还是空？

好吧，您可以自己尝试一下或[阅读文档](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)（它会引发异常）。

此外，您的代码不会像发布的那样编译。 `Tag`是一种将任意数据与对象相关联的方法。因此，它的类型是`object`，因此您需要在使用它之前对其进行转换。

如果您的代码由于过度使用该属性而变得笨拙，`Tag`我建议创建您自己的节点类型，该节点类型继承自默认值`TreeNode`（或任何它），并使用该类型的对象填充您的树视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-03T17:16:01.540

处理节点标签属性的最严格方法是：

```
((TagType)node_identity.Tag).TagProperty = value; 
```

*因此，父*节点的标签属性可以这样处理：

```
((TagType)node_identity.Parent.Tag).TagProperty = value; 
```

*子*节点的标签属性可以这样处理：

```
((TagType)node_identity.Nodes[index_of_child].Tag).TagProperty = value; 
```

并且随着每个*Nodes[index_identifier]*解析为一个节点，更多远程子节点的标签属性可以这样处理：

```
((TagType)node_identity.Nodes[index_of_child].Nodes[index_of_further_child].Tag).TagProperty = value; 
```

等等。

就标记您的字典的假定对象而言......假设您的目的需要在任何地方都使用相同的整数字符串关联，我会简单地将整数键值存储到您的 Tag 字段，并从可能的全局中提取关联的字符串List<string> DictionaryStrings 对象。然后你可以只将整数索引值存储到你的标签中；并且只有您的 List<string> 的字符串值。

然后，您将按如下方式读取您的标签值：

```
((int)node_identity.Tag) 
```

鉴于这些假设，您将改为填充您的基础架构，以便：

```
List<string> DictionaryStrings = new List<string>;
DictionaryStrings.Add("Canada"); // etc. 
```

然后，您将读取标签以从存储到标签的索引值中提取 DictionaryString，如下所示：

```
string DictionaryString = DictionaryStrings[((int)node_identity.Tag)]; 
```

您的错误消息是寻址您尚未添加（在该执行点）到您的字典的字典的潜在成员的结果。首先完全填充列表或字典；然后只处理*属于*列表/字典的*有效*索引。

# crystal-reports - Crystal Reports 运行时和可再分发

> ID：11784962
> 
> 赞同：1
> 
> 时间：2012-08-02T20:07:09.173
> 
> 标签：crystal-reports, asp.net-2.0

这两件事有区别吗。我正在尝试将一些报告从本地服务器移动到开发服务器，并且我知道我们已经在开发服务器上安装了 redist，但在运行报告时仍然遇到问题。运行时是否分开？

*编辑 - 发布代码以查看 dotjoe 是否建议我错误地标记了我的报告路径。数据库连接从一个方法返回到一个字符串数组reportString，这就是那个数组。

```
 <CR:CrystalReportViewer ID="CrystalReportViewer2" runat="server" 
    AutoDataBind="True" Height="50px" Width="350px" ReuseParameterValuesOnRefresh="True"                                                                         ToolbarImagesFolderUrl="~/images/reportViwerImages"/>

    ConnectionInfo myConnectionInfo = new ConnectionInfo();
            myConnectionInfo.ServerName = reportString[1];
            myConnectionInfo.DatabaseName = reportString[0];
            myConnectionInfo.UserID = reportString[2];
            myConnectionInfo.Password = reportString[3];

            string ReportPath = Server.MapPath("../../mdReports/CrystalReport.rpt");
            CrystalReportViewer2.ReportSource = ReportPath;

            ParameterField field1 = new ParameterField();
            ParameterDiscreteValue val1 = new ParameterDiscreteValue();
            val1.Value = hiddenFieldReportNumber.ToString();
            field1.CurrentValues.Add(val1);
            SetDBLogonForReport(myConnectionInfo);

    private void SetDBLogonForReport(ConnectionInfo myConnectionInfo)
    {
        TableLogOnInfos myTableLogOnInfos = CrystalReportViewer2.LogOnInfo;
        foreach (TableLogOnInfo myTableLogOnInfo in myTableLogOnInfos)
        {
            myTableLogOnInfo.ConnectionInfo = myConnectionInfo;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:38:17.027

您尚未从给定路径加载报告。

请看下面[的链接](http://msdn.microsoft.com/en-us/library/aa691450%28v=vs.71%29.aspx)

# jquery - 使用 jquery 设置选定的 mvc3 组合框

> ID：11784963
> 
> 赞同：0
> 
> 时间：2012-08-02T20:07:32.230
> 
> 标签：jquery, asp.net-mvc-3

我正在使用 MVC3 构建一个组合框。我想在来自 webgrid 的单击事件的组合框中设置选定的值。我正在使用设置值

```
$("#trainingCenterString").val($(this).find('td:eq(1)').text()); 
```

MVC 将空格放在组合框值中，并且选择不起作用的空格。当空格被删除时，选择工作。jQuery 是否有“like”、“trim”之类的东西可以用来设置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:20:25.983

如果您只想修剪空格，则可以尝试以下操作：

```
 var item='hello there again'.replace(/[' ']/g,'');
  alert(item);​ 
```

**编辑**

这是一个[jsFiddle](http://jsfiddle.net/jjay225/XrDY4/5/)，其中包含一个单击事件来设置应该对您有所帮助的选定索引。

# java - 休眠保存或更新覆盖旧数据

> ID：11784966
> 
> 赞同：0
> 
> 时间：2012-08-02T20:07:40.093
> 
> 标签：java, hibernate, hibernate-mapping

我正在做，`saveOrUpdate`但我面临的问题是它正在覆盖表中已经存在的旧数据。

我有一个表，其中有一个correlationID 作为键，并且针对该ID，我首先保留一些数据，然后再次针对相同的ID，稍后在同一表的另一列中传递确认消息。但这会覆盖我在表中的旧数据，我得到的是一个带有 id 和消息的空表，其他列无效。

我正在使用休眠映射文件 (.hbm.xml)

关于如何保留旧数据并仅更新一列的建议？

**更新：**

我在尝试加载持久性实例时得到这个：

```
SEVERE: IllegalArgumentException in class: common.entity.AbstractDetailsKey, getter method of property: correlationId
...
org.hibernate.PropertyAccessException: IllegalArgumentException occurred calling getter of common.entity.AbstractDetailsKey.correlationId
...
Caused by: java.lang.IllegalArgumentException: 666 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:13:01.870

您是在更新和保存之前先加载实体吗？还是您只是创建一个实体实例，在其中添加您想要的 id，然后在空实例上更改一个属性？那会很糟糕，因为您刚刚告诉您的 ORM 具有 id X 的实体现在只有一个具有值的属性，所以它当然会清空所有其他列的值。

听起来你需要

1）加载行，**然后**进行修改，然后保存
或更新 2）使用 hql 仅更新一列。

# javascript - 用three.js和CSG设置位置

> ID：11784967
> 
> 赞同：1
> 
> 时间：2012-08-02T20:07:48.443
> 
> 标签：javascript, three.js, csg

当我使用它作为一个立方体和一个球体的代码时，它会切掉这个立方体的某些部分：

```
 <!DOCTYPE html>

<html>

<head>

<script type="text/javascript" src="csg.js"></script>
<script type="text/javascript" src="http://chandler.prallfamily.com/threebuilds/builds/r46/ThreeMin.js"></script>
<script type="text/javascript" src="ThreeCSG.js"></script>

<script type="text/javascript">

window.onload = function() {

var projector = new THREE.Projector( );
var renderer = new THREE.WebGLRenderer({antialias: false});
renderer.setSize(800, 640);

document.getElementById('viewport').appendChild(renderer.domElement);

var scene = new THREE.Scene();

var camera = new THREE.PerspectiveCamera(
    35,
    800 / 640,
    1,
    10000
);
camera.position.set(5, 1.8, 5);
camera.lookAt(scene.position);

var cube = THREE.CSG.toCSG(
    new THREE.CubeGeometry( 2, 2, 2 ),
    new THREE.Vector3(-1, 0, 0)
);
var sphere = THREE.CSG.toCSG(new THREE.SphereGeometry(1.4, 16, 16));
var geometry = cube.subtract(sphere);
var mesh = new THREE.Mesh(
    THREE.CSG.fromCSG( geometry ),
    new THREE.MeshNormalMaterial()
);
scene.add( mesh );

renderer.render(scene, camera);

}

</script>

</head>

<body>

<div id="viewport"></div>

</body>

</html> 
```

我现在如何设置立方体的位置？我需要像 cube.CSG.position.set 这样的东西还是 CSG 库有一个特殊的方法可以使用？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:14:57.673

您需要在设置渲染器后调用一个函数，例如：

```
animate(); 
```

像这样定义它：

```
function animate()
{
    requestAnimationFrame(animate);
    cube.position.x = your_value;
} 
```

# asp.net-mvc - SignalR 与 Flot

> ID：11784969
> 
> 赞同：0
> 
> 时间：2012-08-02T20:08:04.697
> 
> 标签：asp.net-mvc, asp.net-mvc-3, charts, flot, signalr

我正在考虑在需要更新客户端图的项目中使用 SignalR 与我的 .Net 服务器保持持久（COMET）连接。我正在考虑绘图部分的 Flot，但很好奇以这种方式显示“实时图表”的可能性有多大。Flot 是一个不错的选择吗？我希望服务器能够将新数据推送到图表并将其附加到现有数据，因为它变得可用。

我还没有找到任何这样做的例子，所以我想知道这样做是否有一些我没有预料到的困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T15:39:50.367

Flot 和 Highcharts，我最熟悉的两个，只要坐标轴和网格保持不变，就可以重绘数据。在这种情况下，它们非常有效。

要使用 flot 将数据附加到连续图，您最终只会一直重绘整个图。在任何现代浏览器（见鬼，甚至 IE7）中，只要您保持合理的点数，性能将完全可以接受。我的页面有 4-6 个浮点图，每秒更新一次，每个页面每秒有约 3-5 个数据点，最多可保存 5 分钟的数据（因此每个图约 1000 个数据点，页面上总共有 4000 个点）。即使在低功率机器上，也可以毫无延迟地实现这一点。

我还没有看到任何库可以在 flot 之上管理这种类型的东西，所以我最终做了自己的缓存。

我认为你会遇到的唯一“问题”是确保你不会让你的内存使用失控。我在这方面进行的前几次尝试，如果你让图表在一夜之间运行，你会回到使用的 4GB 内存。确保正确删除旧数据，并且不要保留对替换图形和 AJAX 请求的引用。

# c# - 显示打印预览对话框后何时/如何处理 Web 浏览器控件

> ID：11784973
> 
> 赞同：0
> 
> 时间：2012-08-02T20:08:13.190
> 
> 标签：c#, winforms

我正在我的 windows 窗体项目中创建一个新的 Web 浏览器控件来打印一些格式化的 HTML。用户不需要查看控件，因为它只是打印他们所在页面的特殊格式版本。

这是我目前正在使用的打印过程。

```
 internal void PrintQuestion(SessionPart SessionPart)
    {
        WebBrowser wbForPrinting = new WebBrowser(); //<-- Undisposed local
        wbForPrinting.Parent = this;
        wbForPrinting.DocumentCompleted += wbForPrinting_DocumentCompleted;
        wbForPrinting.DocumentText = string.Format(DOCUMENT_HTML, SessionPart.Session.Course.Product.Name, HtmlFormatter.GetPrintableQuestion(SessionPart));
    }

    void wbForPrinting_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        // Print the document now that it is fully loaded.
        ((WebBrowser)sender).ShowPrintPreviewDialog();
    } 
```

我无法在显示打印预览对话框之后立即处理 WebBrowser，因为这会破坏我尝试打印的对象。似乎没有事件或方法可以确定用户是否已使用 WebBrowser（通过完成打印或取消预览）。这是这个项目的最后一部分，我的时间不多了，我不想离开一个闲散的当地人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:16:40.780

你试过这个吗

```
void wbForPrinting_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    // Print the document now that it is fully loaded.
    ((WebBrowser)sender).ShowPrintPreviewDialog();
    // Dispose the WebBrowser now that the task is complete. 
    ((WebBrowser)sender).Dispose();
} 
```

[使用 Web 浏览器控件进行打印并随后进行处理](http://msdn.microsoft.com/en-us/library/b0wes9a3.aspx)

# cuda - 本地、全局、常量和共享内存

> ID：11784975
> 
> 赞同：2
> 
> 时间：2012-08-02T20:08:23.163
> 
> 标签：cuda, gpu-shared-memory, gpu-constant-memory, gpu-local-memory

我阅读了一些引用**本地**内存的 CUDA 文档。（主要是早期文档。）设备属性报告本地内存大小（每个线程）。“本地”内存是什么意思？什么是“本地”内存？“本地”内存在哪里？如何访问“本地”内存？是`__device__`记忆，不是吗？

设备属性还报告：全局、共享和恒定的内存大小。这些陈述是否正确： **全局**内存就是`__device__`内存。它具有网格范围和网格（内核）的生命周期。 **不变**的记忆就是`__device__ __constant__`记忆。它具有网格范围和网格（内核）的生命周期。 **共享**内存就是`__device__ __shared__`内存。它具有单个块范围和该块（线程）的生命周期。

我认为共享内存是 SM 内存。即只有那个单一的SM可以直接访问的内存。相当有限的资源。SM不是一次分配一堆块吗？这是否意味着 SM 可以交错执行不同的块（或不能）？即运行块* *A* * 线程，直到它们停止。然后运行 ​​block* *B* * 线程直到它们停止。然后再换回 block* *A* * 线程。或 SM 是否为 block* *A* * 运行一组线程，直到它们停止。然后换入另一组块* *A* * 线程。此交换继续进行，直到块* *A* * 用尽。然后才开始在块* *B上工作**。我问是因为共享内存。如果单个 SM 正在从 2 个不同的块交换代码，那么 SM 如何快速换入/换出共享内存块？（我认为后面的 senerio 是真的，并且没有换入/换出共享内存空间。块 * *A* * 运行直到完成，然后块 * *B* * 开始执行。注意：块 * *A* * 可能是不同的内核比块* *B* *。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T20:30:40.313

从 CUDA C 编程指南第 5.3.2.2 节中，我们看到在几种情况下使用本地内存：

*   当每个线程都有一些数组但它们的大小在编译时未知时（因此它们可能不适合寄存器）
*   当数组的大小在编译时已知，并且这个大小对于寄存器内存来说太大（这也可能发生在大结构中）
*   当内核已经用完所有寄存器内存时（所以如果我们用`n` `int`s 填充寄存器，`n+1`th`int`将进入本地内存） - 最后一种情况是寄存器溢出，应该避免，因为：

“本地”内存实际上存在于全局内存空间中，这意味着与寄存器和共享内存相比，对它的读写速度相对较慢。每次您在内核中使用一些不适合寄存器、不是共享内存并且没有作为全局内存传递的变量、数组等时，您都会访问本地内存。你不需要做任何明确的事情来使用它——事实上你应该尽量减少它的使用，因为寄存器和共享内存要快得多。

编辑：回复：共享内存，你不能有两个块交换共享内存或查看彼此的共享内存。由于无法保证块的执行顺序，如果您尝试这样做，您可能会占用 SMP 数小时等待另一个块执行。同样，同时在设备上运行的两个内核无法看到彼此的内存，除非它是全局内存，即使那样你也在玩火（竞争条件）。据我所知，块/内核不能真正相互发送“消息”。您的场景并没有真正意义，因为块的执行顺序每次都会不同，并且停止等待另一个块是不好的做法。

# c# - LINQ 查询语法

> ID：11784977
> 
> 赞同：0
> 
> 时间：2012-08-02T20:08:27.443
> 
> 标签：c#, linq

我有两个不同的列表，其中一个是一堆 ID，如 a `List<int> idsList`，另一个是对象列表，例如`List<MyObject> myObjectList`对象如下所示：

```
class MyObject{
    private List<int> ids;

     public MyObject(List<int> ids){
      this.ids = ids;
     }

     public List<int> Ids{
       get{
          return ids;
       }
     }
} 
```

如您所见，每个对象可以包含一个或多个 ID（绝不是零或空 ID）。所以最后我需要知道 myObjectList 中的哪些对象具有来自我的 idsList 的任何 id。到目前为止，如果我这样做：

```
var ids = from g in onScreen where g.Ids.Contains(myIntVariable) select g; 
```

它会给我一个包含 myIntVariable 的对象列表。我不知道该怎么做是将 idsList 的内容与 MyObject 中的列表进行匹配。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:13:47.863

一种方法：

```
var listOfMyObjectsContainingAnIdFromIdsList = myObjectList.Where(myObject => myObject.Ids.Any(id => idsList.Contains(id))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:16:23.223

假设`g`是您的对象列表并且`idsList`是您的 int 列表：

```
foreach (var myObject in g.Where( obj => obj.Ids.Any( itemId => idsList.Contains(itemId) ) )) {
     //Use your myObject here
} 
```

希望有效，

# r - 如何使用 igraph 包从数据框中构建图形？

> ID：11784980
> 
> 赞同：8
> 
> 时间：2012-08-02T20:08:41.167
> 
> 标签：r, dataframe, igraph

有什么方法可以从 R 中的数据框构建图形（igraph 包）？

数据框包含节点关系。

```
 df = data.frame ( 
A = c("Berlin", "Amsterdam", "New York") , 
B = c("Munich", "Utrecht", "Chicago") 
) 
```

边缘是：

```
Berlin -> Munich
Amsteram -> Utrecht
New York -> Chicago 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-02T23:26:12.577

igraph 非常灵活，我相信有很多方法可以实现这一点。[我发现网站](http://igraph.sourceforge.net/documentation.html)上提供的教程非常有帮助。

这是从 data.frame 创建网络图的一种简单方法：

```
library(igraph)

df <- data.frame(
  A = c("Berlin", "Amsterdam", "New York") , 
  B = c("Munich", "Utrecht", "Chicago"))

df.g <- graph.data.frame(d = df, directed = FALSE)

plot(df.g, vertex.label = V(df.g)$name) 
```

![在此处输入图像描述](../Images/52329a859e9c9f6f84658c9b81c54d44.png)

**注意：**对于当前版本`igraph`（从版本 1.2.1 开始），该`graph.data.frame()`函数更改为`graph_from_data_frame()`，这是这两个函数中唯一出现[在文档中的](http://igraph.org/r/doc/)函数。不过，该`graph.data.frame()`功能仍然有效。

# c# - 许多秒后自动隐藏 C# 中的一个表单并显示另一个表单

> ID：11784985
> 
> 赞同：0
> 
> 时间：2012-08-02T20:09:09.060
> 
> 标签：c#, winforms, c#-4.0

我需要在几秒钟后隐藏当前表单，然后显示任何表单

我正在编写此代码，但它不起作用。

```
namespace tempprj
{
    public partial class ProfileFrm : Telerik.WinControls.UI.RadForm
    {
       public ProfileFrm()
       {
           InitializeComponent();
       }

       private void ProfileFrm_Load(object sender, EventArgs e)
       {
            Frm2 child = new Frm2();
            Thread.Sleep(3000);
            this.Hide();
            child.ShowDialog();
       }
   } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:12:27.893

```
Thread.Sleep(3000); 
```

将阻止您的项目在 3 秒内执行任何操作（不包括其他线程）并冻结 UI。我建议使用标准的 .NET 计时器。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:40:33.197

这是我的问题的解决方案：

```
 private void ProfileFrm_Load(object sender, EventArgs e)
    {
        timer1.Tick += new EventHandler(timer1_Tick);

        timer1.Enabled = true;
        timer1.Interval = 4000;
        timer1.Start();

    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        timer1.Stop();

        this.Hide();
        Frm2 f = new Frm2();

        f.ShowDialog();
    } 
```

# java - 使用 maven-jetty、tomcat 部署多场战争？

> ID：11784990
> 
> 赞同：1
> 
> 时间：2012-08-02T20:09:34.163
> 
> 标签：java, web-applications, maven, jetty

我想部署多个 webapps 并运行 maven jetty 插件或 tomcat 插件。但我似乎无法让他们工作。我的主要目标是启动所有 webapps 的服务器，因为它们相互依赖。我如何实现这一目标？我尝试使用 maven jetty 插件 - 创建了一个带有多个 contextHandlers 的单独项目

```
<plugin>
        <groupId>org.mortbay.jetty</groupId>    
        <artifactId>jetty-maven-plugin</artifactId>
        <version>8.1.2.v20120308</version>
        <configuration>
            <contextHandlers>
                <contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
                    <contextPath>/data-emulator</contextPath>
                    <resourceBase>${basedir}/../data-emulator/target/</resourceBase>

                </contextHandler>

                <contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
                    <contextPath>/service</contextPath>
                    <resourceBase>${basedir}/../service/target/</resourceBase>

                </contextHandler>

                <contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
                    <contextPath>/client</contextPath>
                    <resourceBase>${basedir}/../client/target/</resourceBase>

                </contextHandler>
            </contextHandlers>
            <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector"> 
                <port>8080</port>
                <maxIdleTime>60000</maxIdleTime>
            </connector>

        </configuration>
    </plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:32:25.130

您的**resourceBase**参数不正确。**目标**文件夹不包含您的网页和 WEB-INF 文件夹（除非您有特殊的构建后任务来复制输出文件）。

您应该改用**war**参数。下面的例子：

```
<contextHandler implementation="org.eclipse.jetty.webapp.WebAppContext">
    <contextPath>/data-emulator</contextPath>
    <war>${basedir}/../data-emulator/target/data-emulator.war</war>    
</contextHandler> 
```

# c++ - 为什么一元减法执行积分提升？

> ID：11784992
> 
> 赞同：6
> 
> 时间：2012-08-02T20:09:46.990
> 
> 标签：c++, auto, integer-promotion

```
const auto min = -std::numeric_limits<T>::max();
T x = min; // conversion from 'const int' to 'short', possible loss of data 
```

T 是一个模板参数，`short`在这种情况下是 a。一元减号显然执行积分提升。

*   为什么一元减法执行积分提升？
*   如果`auto`更改为`T`不生成警告，但应该将 int 分配给 short。为什么没有警告（可能是 VS 很花哨）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T20:37:56.780

Short answer: (now long because people want to be excessively pedantic about English which by its very nature is not exact).

Its not explicitly (as in the unary minus `mathematical`). But as part of any operation (this includes unary minus `operation`) on POD data there is an implicit check on input parameters (the smallest integer type that can be used in and operation is `int`) so there is integral promotion on the input before the unary minus (the `mathematical` part not the operation part). The output of all operations on POD is the same as the input parameters (after integral promotion is applied). Thus here the output is also an `int`.

Long answer:

In C (and thus C++) the smallest type that POD operations happen on is `int`. So before the unary minus is applied the value is converted to int. Then the unary minus is applied. The result of the expression is thus `int`.

See here: [Implicit type conversion rules in C++ operators](https://stackoverflow.com/questions/5563000/implicit-type-conversion-rules-in-c-operators/5563131#5563131)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T22:53:04.243

一元减号执行整数提升，因为整数类型上的所有算术运算符都这样做。建立这个约定可能是出于性能原因（通常 int 是最适合硬件上的整数运算的大小），也许是因为有时不限于较小的整数类型的范围很有用。

我见过人们做的错误：

```
uint64_t i = 1 << 33; // use 64-bit type to ensure enough bits to hold the result 
```

但这是一个错误，因为结果`1 << 33`不取决于分配给什么。（今天我们对此有警告）。丑陋的解决方案是手动强制其中一个操作数足够大：`uint64_t i = static_cast<uint64_t>(1) << 33`

整体提升恰好避免了具有较小类型的相同类型的错误，这在 C 以这种方式设计时很常见：

```
short a = 30000, b = 20000
int i = a + b; 
```

无论如何，“它不必是合乎逻辑的。这是法律。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:22:11.167

我认为这是为了解释 C/C++ 假设的理想计算机模型。计算在寄存器中执行，这意味着结果的大小将是机器字。因此“自动”扩展

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T20:41:25.453

我相信这是（部分）因为 a 的否定`short`可能无法表示为 a `short`。
（-2 ^(15)可能需要提升到`int`if`short`是 16 位并且`int`更大。）

当然，不能保证`int`更大，但它（通常？）无论如何都是机器的最佳数据类型，因此尝试将其提升为有意义的，`int`因为无论如何可能没有性能成本。

# python - 在 Python 中获取字符串和 csv 文件的正确编码

> ID：11784996
> 
> 赞同：7
> 
> 时间：2012-08-02T20:09:49.953
> 
> 标签：python, encoding, csv

我在 Python 中使用 mechanize 从网站获取一些数据并发送新数据。

问题是该网站是法语的，所以我得到了菱形 (�) 的问号，而不是各种字符，例如 éÉÀàùÙîû 等。

我尝试在 Google 和 StackOverflow 上环顾四周，发现各种答案都无法解决我的问题。我已经看到建议尝试以下行之一的答案：

```
myString = éÀî

myString.encode('latin-1')
myString.encode('iso-8859-1')

unicode(myString, 'iso-8859-1') 
```

但这些似乎都不起作用。

我需要这个的两种情况是当我读取带有重音符号和硬编码字符串包含重音符号的 csv 文件时。例如，下面是 csv 文件中的一行（实际上 ';' 是分隔符）：

```
Adam Guérin;myemail@mail.com;555-5555;2011-02-05 
```

'é' 看起来不错，但是当我尝试用 mechanize 填充网站上的 textField 并提交时，'é' 现在在实际网站上看起来像 '''。

**编辑：**

这是我读取 csv 文件中数据的代码：

```
subscriberReader = csv.reader(open(path, 'rb'), delimiter=';')
subscribers = []

for row in subscriberReader:
    subscribers.append(Subscriber(row[0], row[1], row[2])) 
```

然后我使用 mechanize 将其发送到网站：

```
self.br.select_form('aspnetForm')

self.br.form['fldEmail'] = subscriber.email
self.br.form['fldName'] = subscriber.name
self.br.form['fldPhoneNum'] = subscriber.phoneNum

self.br.submit() 
```

我尝试了各种方法来对字符进行编码，但我想我做得不对。我很乐意尝试答案/评论中建议的任何内容。

至于网站，它没有指定它在标题中使用的编码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:42:58.097

首先，您提到要在代码中放置文字。为此，您需要告诉 Python 您的脚本文件具有什么编码。您可以在文件开头使用注释声明来执行此操作（我假设您使用的是`latin-1`）。

```
# -*- coding: latin-1 -*-
myString = u'éÀî' 
```

其次，您需要能够使用字符串。这不是特定于机械化的，但涵盖一些基础知识应该是有用的：首先，`myString`最终成为一个 unicode 对象（因为声明文字的方式，使用`u''`）。因此，要将其用作 Latin-1 编码，您需要调用`.encode()`，例如：

```
with open('test.txt', 'w') as f:
    f.write(myString.encode('latin-1')) 
```

最后，当读入一个编码的字符串时（例如，从远程网站），您可以使用`.decode()`它来将其解码为一个 unicode 对象，并从那里使用它。

```
with open('test.txt', 'r') as f:
    myString = f.read().decode('latin-1') 
```

# c# - 是否可以在 C# 中调用基于 combobox.selecteditem.tostring() 的方法？

> ID：11784997
> 
> 赞同：0
> 
> 时间：2012-08-02T20:09:52.223
> 
> 标签：c#, object, methods, invoke

是否可以调用基于文本值的方法？

如果可能，我不想使用“if”或“switch”语句。

如果是这样，我需要看什么才能做到这一点？

这只是为了尝试清理界面。

if 语句示例：

```
 if (cmb_Motor.SelectedItem.ToString() == "OutPortA")
             NXT_Brick.OutPortA.SetOutputState();
    else if (cmb_Motor.SelectedItem.ToString() == "OutPortB")
             NXT_Brick.OutPortB.SetOutputState();
    else if (cmb_Motor.SelectedItem.ToString() == "OutPortC")
             NXT_Brick.OutPortC.SetOutputState(); 
```

我想在“NXT_Brick”之后更改“OutPortA、B、C”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:15:26.457

我能想到的最干净的方法是为您的组合框项目创建一个类，如下所示：

```
class Item
{
  public string Name{get;set;}
  public Action Action{get;set;}

  public override string ToString() { return Name; }
} 
```

然后将此类的实例添加到组合框中：

```
cmbItems.Add(new Item{Name="Item1", Action=()=>{ /*action 1*/ });
cmbItems.Add(new Item{Name="Item2", Action=()=>{ /*action 2*/ });
cmbItems.Add(new Item{Name="Item3", Action=()=>{ /*action 3*/ }); 
```

并且在您选择的项目更改事件中（或在您的确定按钮按下，无论在哪里），您将您的`SelectedItem`属性转换为`Item`然后调用它的`Action`属性来运行代码。

```
((Item)cmbItems.SelectedItem).Action(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T20:16:38.670

`if`并且`switch`语句可以隐藏在*字典*中，例如：

```
private IDictionary<string, OutPort> ports = new Dictionary<string, OutPort>{
  {"OutPortA", NXT_Brick.OutPortA},
  {"OutPortB", NXT_Brick.OutPortB},
  {"OutPortC", NXT_Brick.OutPortC}
} 
```

用法：

```
if(ports.Contains(key))
{
 ports[key].SetOutputState();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T20:35:34.100

组合框包含列表项。根据 MSDN，您可以将 ANYTHING 存储在组合框中，尽管它通常用于存储文本字符串。所以选择正确解决问题的最简单的解决方案。

```
public class FiringComboItem
{
   public string Text { get; set; }
   public Action OnClick { get; set; }
   override public ToString() { return Text; }
} 
```

像这样将项目添加到组合中：

```
myCombo.Add ( new FiringComboItem 
    { 
        Text = "About", 
        OnClick = () => new AboutDialog.ShowDialog()
    }); 
```

在您的下拉处理程序中：

```
private void myCombo_OnSelectedIndexChanged(object sender, EventArgs e)
{
    (myCombo.SelectedItem As FiringComboItem).OnClick();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T20:15:18.583

委托是指向函数/方法的指针，因此您可能想要使用它。例如，创建一个指向具有委托签名（参数及其类型）的方法的指针数组，并通过索引该数组来调用该方法。一个例子：

```
public delegate void SelectState();

public class Test
{
    SelectState[] stateMethods = new SelectState[]
    {
        new SelectState(SelectA),
        new SelectState(SelectC),
        new SelectState(SelectB),
        new SelectState(SelectB)
    };

    void SelectA() { /* ... */ }
    void SelectB() { /* ... */ }
    void SelectC() { /* ... */ }

    void DoSomething()
    {
        int index = cmb_Motor.SelectedIndex;
        // Get the method pointer.
        var method = stateMethods[index];
        // Call the method, one of the State*() methods.
        method();
    }
} 
```

或者，如果您不想使用索引而是字符串，例如您的示例，您可能想要使用字典：

```
Dictionary<string, SelectState> stateMethods = new Dictionary<string, SelectState>
{
    {"OutPortA", new SelectState(SelectA)},
    {"OutPortB", new SelectState(SelectB)},
    {"OutPortC", new SelectState(SelectC)},
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T20:18:43.697

一个好的解决方案（一般来说 - 在您的特殊情况下可能不是最好的方法，但要判断这一点，我们需要更多信息）似乎将对象存储在 ComboBox 中，而不仅仅是字符串。这些对象应提供 ComboBox 中可见的文本以及运行您要调用的方法的方法。

在您的示例中，您似乎总是在调用实例的`SetOutputState`方法`OutPort`（假设此处的类名），因此您的 ComboBox 项目对象可能如下所示：

```
public class ComboItem
{
    public ComboItem(string displayName, OutPort outPort)
    {
        this.displayName = displayName;
        this.outPort = outPort;
    }

    private readonly string displayName;

    private readonly OutPort outPort;

    public override string ToString()
    {
        return displayName;
    }

    public OutPort OutPort {
        get {
            return outPort;
        }
    }
} 
```

请注意，该`ToString`方法的结果将是 ComboBox 中用户可见的字符串。

您必须像这样填充 ComboBox：

```
cmb_Motor.Items.Add(new ComboItem("OutPortA", NXT_Brick.OutPortA);
cmb_Motor.Items.Add(new ComboItem("OutPortB", NXT_Brick.OutPortB);
cmb_Motor.Items.Add(new ComboItem("OutPortC", NXT_Brick.OutPortC); 
```

然后，您可以像这样评估所选项目：

```
ComboItem selectedItem = cmb_Motor.SelectedItem as ComboItem;
if (selectedItem != null) {
    selectedItem.OutPort.SetOutputState();
} 
```

如果您需要对所选项目执行的操作有更多变化，请将要执行的操作也移到`ComboItem`类中：

```
public class ComboItem
{
    public ComboItem(string displayName, OutPort outPort)
    {
        this.displayName = displayName;
        this.outPort = outPort;
    }

    private readonly string displayName;

    private readonly OutPort outPort;

    protected OutPort OutPort {
        get {
            return outPort;
        }
    }

    public override string ToString()
    {
        return displayName;
    }

    public virtual void DoWork()
    {
        outPort.SetOutputState();
    }
} 
```

该`OutPort`物业现在不再需要公开；您可以简单地调用`DoWork`所选项目。因此，评估代码可以更改为：

```
ComboItem selectedItem = cmb_Motor.SelectedItem as ComboItem;
if (selectedItem != null) {
    selectedItem.DoWork();
} 
```

对于需要不同操作的任何事情，您现在可以派生一个新类，该类`ComboItem`会覆盖该`DoWork`方法以执行不同的操作。

# internet-explorer-9 - 尽管在 IE 及更早版本中应用了边框半径，为什么还要显示角落？

> ID：11784998
> 
> 赞同：0
> 
> 时间：2012-08-02T20:09:57.423
> 
> 标签：internet-explorer-9, css

我有一个问题，但不完全是边界半径，但我不知道如何解释，但我放了 2 张在 chrome、firefox 等中看到的图像，以及在 IE9 和更早版本中看到的另一张图像。

**CHROME 和其他浏览器**

![在此处输入图像描述](../Images/48ec3636902bc8b80689d34d81b4d6a0.png)

**IE9 及更早版本**

![在此处输入图像描述](../Images/9dd82b5f6caf235cce8f86317abd5df1.png)

似乎尽管应用了边界半径，但仍然显示那些角落。

```
aside#sidebar ul {
    margin-top: 15px;
    width: 100%;
    height: 200px;
    background: transparent;
}
aside#sidebar ul li {
    font-size: 14px;
    list-style-type: none;
    margin-bottom: 5px;
    background: transparent;
    //border: 3px solid white;
}
aside#sidebar ul li a {
    display: block;
    padding: 5px;
    color: white;
    border-left: 10px solid white;
    border-radius: 12px;
    -webkit-border-radius: 12px;
    -moz-border-radius: 12px;
    behavior: url(PIE.htc);
    background: transparent;
} 
```

**编辑**

这部分有什么关系吗？列表中每个项目使用的背景，这是第一个的背景

```
aside#sidebar #itemLinea1 {
    //border-color: #DE9E26;
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZjZWFiYiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjUwJSIgc3RvcC1jb2xvcj0iI2ZjY2Q0ZCIgc3RvcC1vcGFjaXR5PSIwLjc1Ii8+CiAgICA8c3RvcCBvZmZzZXQ9IjUxJSIgc3RvcC1jb2xvcj0iI2Y4YjUwMCIgc3RvcC1vcGFjaXR5PSIwLjc1Ii8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNmYmRmOTMiIHN0b3Atb3BhY2l0eT0iMC41Ii8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);
    background: -moz-linear-gradient(top, rgba(252,234,187,1) 0%, rgba(252,205,77,0.75) 50%, rgba(248,181,0,0.75) 51%, rgba(251,223,147,0.5) 100%);
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(252,234,187,1)), color-stop(50%,rgba(252,205,77,0.75)), color-stop(51%,rgba(248,181,0,0.75)), color-stop(100%,rgba(251,223,147,0.5)));
    background: -webkit-linear-gradient(top, rgba(252,234,187,1) 0%,rgba(252,205,77,0.75) 50%,rgba(248,181,0,0.75) 51%,rgba(251,223,147,0.5) 100%);
    background: -o-linear-gradient(top, rgba(252,234,187,1) 0%,rgba(252,205,77,0.75) 50%,rgba(248,181,0,0.75) 51%,rgba(251,223,147,0.5) 100%);
    background: -ms-linear-gradient(top, rgba(252,234,187,1) 0%,rgba(252,205,77,0.75) 50%,rgba(248,181,0,0.75) 51%,rgba(251,223,147,0.5) 100%);
    background: linear-gradient(to bottom, rgba(252,234,187,1) 0%,rgba(252,205,77,0.75) 50%,rgba(248,181,0,0.75) 51%,rgba(251,223,147,0.5) 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fceabb', endColorstr='#80fbdf93',GradientType=0 );
    transition: border 0.3s linear;
    -webkit-transition: border 0.3s linear;
    -moz-transition: border 0.3s linear;
    -o-transition: border 0.3s linear;
} 
```

应该在什么位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:33:31.437

您正在使用 IE 过滤器将渐变应用到您的元素。不幸的是，这些过滤器不会被剪裁，`border-radius`因为它们没有绘制在框的背景上，无论您是应用于`border-radius`相同的元素还是它们的容器。

如果您需要应用渐变背景，最好的办法是使用背景图像。如果你只需要支持 IE9，就去掉滤镜，保留 SVG 背景图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:13:14.533

尝试只使用border-radius，你需要核心的，而不仅仅是针对firefox和webkite，否则是因为那些早期的浏览器要么不支持border-radius，要么你没有使用正确的前缀，-ms- for微软

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:33:41.550

问题是您正在对元素应用圆角`a`，但将背景颜色分配给底层`li`元素。所以你有一个圆角矩形，它位于一个带有彩色背景的非圆角矩形之上。因此，非圆角矩形的角突出。

比较这两个小提琴：

损坏： http: [//jsfiddle.net/87R5b/2/](http://jsfiddle.net/87R5b/2/) 修复：http: [//jsfiddle.net/87R5b/3/](http://jsfiddle.net/87R5b/3/)

在第二个中，我将黄色渐变应用于`a`元素。这只是一种可能的解决方案，但它应该适合你。

希望这可以帮助！