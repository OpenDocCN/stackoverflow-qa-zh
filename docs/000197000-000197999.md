# StackOverflow 问答 000197000-000197999

# c# - ILGenerator 有一个好的包装器吗？

> ID：197005
> 
> 赞同：8
> 
> 时间：2008-10-13T08:26:03.750
> 
> 标签：c#, .net, cil, ilgenerator

我现在使用 System.Reflection.Emit 有一段时间了，发现它（谁没有？）和容易出错一样痛苦。

你知道 IL 生成器周围是否有一个很好的包装器，我可以依靠它以比直接使用 SRE 更安全、更容易的方式发出 IL？

**编辑：**

我知道操作表达式树肯定比直接发出 IL 更容易、更安全，但它们现在也有一些限制。我不能创建代码块、使用循环、声明和使用几个本地人等等。我们需要等到 .NET 4 出来:)

此外，我正在处理一个已经依赖于 SRE 的代码库。

显然，ILGenerator 做了我需要的一切。但是在操作它时，我会很感激更多的帮助。当我提到 ILGenerator 包装器时，它仍然处于相当低的级别，我想到了一些可以提供以下方法的方法：

```
// Performs a virtual or direct call on the method, depending if it is a 
// virtual or a static one.
Call(MethodInfo methodInfo)

// Pushes the default value of the type on the stack, then emit 
// the Ret opcode.
ReturnDefault(Type type)

// Test the object type to emit the corresponding push 
// opcode (Ldstr, Ldc_I*, Ldc_R*, etc.)
LoadConstant(object o) 
```

这确实是 3 个幼稚的例子，但足以证明我的期望。我们可以将其视为一组扩展方法，但最好支持条件语句和循环，如[RunSharp](http://www.codeproject.com/KB/dotnet/runsharp.aspx)。事实上，RunSharp 与我想要的非常接近，但它过多地抽象了 ILGenerator 并且没有公开其所有功能。

我不记得在哪里了，但是我已经在一个开源项目中看到过这样的助手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T08:32:24.203

如果您使用的是 .NET 3.5，您可能会发现使用表达式树更合理。这完全取决于你在做什么——它仍然会很痛苦——但这肯定是另一个需要注意的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T08:33:16.370

[更新]：我想到了名字[;-p RunSharp](http://www.codeproject.com/KB/dotnet/runsharp.aspx)。我不能保证它，但它可能是你需要的。

然而; 你需要生成什么？[CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)是一种选择。[对于创建方法，您可能会发现使用 .NET 3.5 中的Expression](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx)类可以做的比预期的要多得多（在通过 Expression.Lambda/Compile 将其编译为类型化委托之后。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T08:37:37.063

尝试使用[Mono.Cecil](http://www.mono-project.com/Cecil)

> Cecil 是由[Jb Evain](http://evain.net/blog/)编写的库， 用于生成和检查 ECMA CIL 格式的程序和库。它完全支持泛型，并支持一些调试符号格式。

# javascript - 当您了解 JavaScript 时，学习 ActionScript 的最简单方法是什么？

> ID：197008
> 
> 赞同：7
> 
> 时间：2008-10-13T08:27:05.150
> 
> 标签：javascript, actionscript-3

我是一名 Ajax 开发人员，我想构建一个 Flash 应用程序。鉴于我以前使用 JavaScript 的经验，你认为学习 ActionScript 最简单的方法是什么，我可能会遇到哪些障碍？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T08:30:27.173

不要从购买 Flash Pro 开始做任何事情。它是一个设计器工具，对于开发代码来说真的很垃圾。无论如何，以后再投资它，但它是编码人员进入 ActionScript 的障碍；不是帮助。如果您负担得起的话，我建议您自己购买[Flex Builder ，或者如果没有的话，请购买像](http://www.adobe.com/products/flex/features/flex_builder/)[FlashDevelop](http://www.flashdevelop.org/community/)这样的开源 ActionScript IDE 。

然后拿几本关于 ActionScript 和/或 Flex 的书开始阅读。此外，值得下载您可以找到包含代码的简单 Flash 应用程序的任何示例，以了解其他人是如何做事的。

从 JavaScript 迁移到 ActionScript 时要记住的一点是，AS1 非常类似于 JavaScript，而 AS2 则不太像，而且 JavaScript 和 AS3 之间几乎没有相似之处。因此，如果您有时间和兴趣，请尝试拿起一本廉价的 AS1 和 AS2 书籍，并首先浏览它们以了解该语言的历史。你可能会以这种方式更快地进入 AS3。当然，如果您了解 ECMAScript v4（现在可能永远不会看到曙光），那么您可以自信地直接跳到 AS3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-30T23:14:19.770

我的建议是下载一份 FlexBuilder 并坚持使用 AS3。AS1 和 AS2 现在无关紧要，不再用于开发“Flash 应用程序”。不要浪费时间阅读它，它可能会让你感到困惑。

有很多资源可用于学习 Flex，只需 google 即可。关于这个主题，我读过的最好的书是Colin Moock 的[Essential ActionScript](https://rads.stackoverflow.com/amzn/click/com/0596526946)。这是一个参考

但最重要的是，代码、代码和代码。

您可以尝试移植一些以前的项目作为一个很好的学习练习。

祝你学习顺利。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-06T12:23:26.213

学习动作脚本的最好方法只能通过视频教程。更好的试用视频教程，它可以帮助你一步一步地教你（非常容易理解），非常容易理解。您还可以访问[http://www.infoclassi.do.am](http://www.infoclassi.do.am)查看所有视频教程。如果您需要与其他具有相同质量的教程相比成本更低的任何其他教程，您也可以订购它们。

# python - 如何找出subversion工作目录是否被svn锁定？

> ID：197009
> 
> 赞同：2
> 
> 时间：2008-10-13T08:29:20.030
> 
> 标签：python, svn

一个 python 脚本正在运行两个并行的 python 进程（通过 os.fork() 创建），每个进程最终都会尝试将一个 subversion 存储库叶子检出到同一个工作副本目录中。

在子进程（通过 python 子进程模块）中运行“svn co ...”命令之前，父 python 代码检查工作副本目录是否已经存在。

```
 if os.path.isdir(checkout_dir):
     # working copy dir already exists
     return checkout_dir 
```

因此，如果确实如此，则不应运行任何“ svn co”，而是立即从父函数返回。

尽管如此，还是发生了一些冲突，其中一个 python 进程在 'svn co ..' 上失败，并出现以下错误。

```
checked-out failed: svn: Working copy '/tmp/qm_23683' locked
svn: run 'svn cleanup' to remove locks (type 'svn help cleanup' for details)** 
```

所以第一个问题是为什么工作副本目录存在检查不起作用，第二个问题 - 有没有办法找出工作副本目录被 svn 锁定并循环直到它被解锁？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T08:39:52.007

在目录中，应该有一个名为“.svn”的目录。其中，名为“locked”的文件表示该目录已锁定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T02:09:48.423

这听起来像是一个潜在的竞争条件，因为可能会发生以下情况：

1.  进程 A 检查目录是否存在（尚不存在）。
2.  进程 B 检查目录是否存在（尚不存在）。
3.  进程 A 调用`svn`创建目录。
4.  进程 B 调用`svn`，随后失败。

避免这种情况的一种简单方法是让每个进程都尝试*创建*目录，而不是检查它的存在。如果其他进程已经创建了目录，则可以保证其他进程在各种平台和文件系统下都能获得明确定义的错误代码。例如，这是在 NFS 的许多实现上进行同步的唯一可靠方法之一。幸运`svn`的是，不会关心工作目录是否已经存在。

Python 代码看起来像这样：

```
import os, errno

# ...

try:
  os.mkdir(dirName)
except OSError, e:
  if e.errno != errno.EEXIST: raise # some other error
  print 'Directory already exists.'
else:
  print 'Successfully created new directory.' 
```

这种技术易于实现、非常可靠并且在各种情况下都非常有用。

# asp.net-mvc - 如何在视图中声明下拉框以在 ASP.NET MVC 中为模型设置值？

> ID：197027
> 
> 赞同：10
> 
> 时间：2008-10-13T08:42:00.440
> 
> 标签：asp.net-mvc

我想在 ASP.NET MVC 应用程序的视图中声明一个下拉框，让用户选择查找值。我知道如何声明纯文本框，但是是否有声明下拉框（日期时间选择器和其他）的官方助手？

我也不知道应该将什么结构传递给我的视图以将值提供给下拉框。我假设我需要一个 id 和一个描述。

最后，如何将下拉框中的选定 id 传递回控制器中的操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T22:19:05.310

如果您有一个产品类型表，其中包含要映射到下拉列表的描述和值 (id)，则在控制器的操作中执行以下操作。

```
//Lets assume you retrieve your product types somehow here
ViewData["ProductTypes"] =  new List<ProductType>(); 
```

然后在您的视图中键入以下内容

```
<%= Html.DropDownList("productType",
    new SelectList((IEnumerable)ViewData["ProductTypes"],
    "TypeID", "Description"))%> 
```

TypeID 和 Description 是指您的 ProductType 类型对象的属性

此外，如果您安装了旧版本的 MVC，您可能找不到 Html.DropDownList，请在尝试之前确保您拥有 Beta+ 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T13:14:52.713

您可以查看 Scott Guthrie 的这篇关于[处理表单编辑帖子场景](http://weblogs.asp.net/scottgu/archive/2007/12/09/asp-net-mvc-framework-part-4-handling-form-edit-and-post-scenarios.aspx)的博客文章。他在他的示例中使用了一个下拉列表。

您也可以在下拉列表中提供复杂对象的列表（Scott Guthrie 的示例没有显示这一点，但它暗示了这一点）。

你可以做这样的事情......

```
<%= Html.DropDownList("Select One", "CategoryId", ViewData.Model.Categories, "Id", "Name", ViewData.Model.SelectedCategoryId)) %> 
```

“Id”和“Name”指的是 ViewData.Model.Categories 对象列表中的属性。

如果 SelectedCategoryId 有一个值，那么它将默认下拉列表。

# php - system('php file.php'); 不起作用，为什么？

> ID：197028
> 
> 赞同：0
> 
> 时间：2008-10-13T08:42:48.287
> 
> 标签：php, system, execute

两者都不

```
<?php system('php file.php'); ?> 
```

也不

```
<?php system('/usr/bin/php file.php'); ?> 
```

工作。为什么？

我试过 with `-q`， with`!#/usr/bin/php`等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T08:49:59.503

你应该用 -f 调用它，但没有它它也应该工作：

```
<?php system('/usr/bin/php -f file.php'); ?> 
```

“它不起作用”是什么意思？

您是否希望内容像来自您的脚本一样被输出？使用[include](http://php.net/include)或[require](http://php.net/require)。

你想要变量中的内容吗？使用[反引号运算符](http://www.php.net/manual/en/language.operators.execution.php)。

您可以通过使用反引号运算符而不是系统来查看从命令中返回的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T08:51:29.547

可能是因为安全模式。

> ```
> Note: When safe mode is enabled, you can only execute files within the safe_mode_exec_dir. For practical reasons, it is currently not allowed to have .. components in the path to the executable. 
> ```
> 
> [http://www.php.net/system](http://www.php.net/system)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T08:49:46.867

没有更多信息......它可能是 PHP 可执行文件的路径、file.php 的路径或文件权限问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T08:50:36.990

当您将完整路径传递给“file.php”时会发生什么？

此外，尝试将输出（但 stdout 和 stderr）重定向到文件，以便您可以看到生成的错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T09:21:03.403

谢谢大家的回答！！

对于“不起作用”，我的意思是：它不会返回或打印任何东西。

我有两个文件 a.php && b.php （具有所有权限）并且安全模式已关闭

b.php

```
<?php
$a = system('/usr/bin/php -f /Applications/MAMP/htdocs/a.php',$b);
print_r($a);
echo '-'; # for separation
print_r($b); ?> 
```

和一个.php

```
<?php echo 'hello world'; ?> 
```

当我从浏览器（localhost/b.php）运行 b.php 时，它会打印：

> 字符串（0）“”-int（5）

这意味着 $b 变量是 5 但是... 5 什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T09:23:49.263

当您打开错误报告时它会说什么？

```
<?php
error_reporting(E_ALL);
ini_set("display_errors", 1);
$a = system('/usr/bin/php -f /Applications/MAMP/htdocs/a.php',$b);
print_r($a);
echo '-'; # for separation
print_r($b); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T23:44:13.600

}} 对于“不起作用”，我的意思是：它不会返回或打印任何东西。

尝试在您的服务器上获取终端/shell 并尝试您的系统命令。如果您的操作系统是 unixy，您可以使用**which php**之类的东西来找到 php cli 的正确路径。

您确实安装了 php cli 对吗？默认情况下通常不安装它。

您的网络服务器是否执行 chroot 或其他操作？在您尝试使用 system() 的环境中，可能不存在 php cli。

与其尝试调用脚本，不如尝试做一个简单的**system('php -v')**。一旦你得到正确输出 php 版本号，然后将调用添加到你的脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T10:59:32.877

当我改变

```
system('/usr/bin/php -f /Applications/MAMP/htdocs/a.php',$b); 
```

为了

```
('/bin/php -f /Applications/MAMP/htdocs/a.php',$b); 
```

然后它说 127 而不是 5，我猜这些是错误代码

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T11:16:49.193

尝试：

```
$output = array();
$returnCode = 0;
exec('/usr/bin/php -f /Applications/MAMP/htdocs/a.php 2>&1', $output, $returnCode);
print_r($output); 
```

将`2>&1`标准错误重定向到标准输出，因此任何错误消息都将被捕获`$output`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T11:26:22.747

等等……你到底想在这里实现什么？只需运行 a.php 并将输出返回到浏览器？在这种情况下，[包括](http://www.php.net/include)它。从您发布的 a.php ( <?php echo 'hello world'; ?> ) 内容的外观来看，这似乎是您想要的。

如果 a.php 的内容还有更多内容，请回帖并说明您真正想做的事情。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-13T15:06:38.073

尝试：

```
$fp = popen('/usr/bin/php -f file.php', 'r');

if(false === $fp)
{
   // something bad happened: error handle
}

$contents = '';

while(false === feof($fp))
{
  $contents .= fgets($fp);
}

fclose($fp);    
echo $contents; 
```

这将允许您捕获子shell 的输出并捕获错误。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-13T11:04:18.033

您显然不了解*系统*功能的工作原理。你真正需要的可能是[popen](http://www.php.net/popen)。*使用popen*启动进程，然后使用*fgets*读取其输出。

或者，您可以使用其他人已经建议的反引号运算符。

# linux - Oracle 事件日志位于何处？

> ID：197033
> 
> 赞同：16
> 
> 时间：2008-10-13T08:49:49.647
> 
> 标签：linux, oracle, logging

我的 oracle 事件日志的位置在哪里（在默认 Linux 安装上）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-13T09:35:29.240

```
select value from v$parameter where name = 'background_dump_dest' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T09:40:49.137

使用[@cagcowboy 的回答](https://stackoverflow.com/questions/197033/where-is-the-oracle-event-log-located#197108)，Linux 上的默认[Oracle XE](http://www.oracle.com/technology/products/database/xe/index.html)安装会写出：

```
/usr/lib/oracle/xe/app/oracle/admin/XE/bdump 
```

# captcha - 消除博客或评论垃圾邮件的最佳方案是什么

> ID：197041
> 
> 赞同：0
> 
> 时间：2008-10-13T08:53:26.550
> 
> 标签：captcha

如何结合以下内容来对抗垃圾邮件，同时尽量减少对用户造成的烦恼？

1.  在注册页面，发送电子邮件以验证电子邮件地址
2.  在注册页面，使用 CAPTCHA
3.  在每个帖子页面中，使用 CAPTCHA

随意添加新项目到列表中，请用布尔表达式告诉您建议的方案，例如：（1和3）或2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T09:04:52.377

尝试使用 javascript 在隐藏字段中提交带有时间限制变量的表单。这将意味着机器人目前无法发送任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T09:23:51.807

您还可以使用[贝叶斯过滤](http://en.wikipedia.org/wiki/Bayesian_spam_filtering)来删除或以其他方式处理通过的垃圾邮件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T15:55:28.723

编辑：这个建议在 2008 年*可能*很好，但今天我建议使用 Google 的 ReCAPTCHA。

原帖如下：

使用 CAPTCHA 的最佳建议是自己滚动，或者只是伪造它。

这是一篇关于验证码的好文章：

[http://www.codinghorror.com/blog/archives/001067.html](http://www.codinghorror.com/blog/archives/001067.html)

现在向下滚动到底部。它要求您输入一个单词。没有花哨的生成或混淆。验证码之所以有效，是因为与大人物相比，编码恐怖是小菜一碟。您的网站也可能是小土豆。

如果您使用的软件已经包含验证码，那么您可以更改验证码的工作方式。例如，phpbb3 论坛有一个验证码供注册。所以你可以把页面上的文字改成“忽略图片，请在方框中输入天空的颜色”，然后替换验证码只勾选“蓝色”即可。这还有一个额外的好处，即任何发生的机器人都会尝试解决 CAPTCHA 并无法通过身份验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T21:58:20.467

使用 IP 黑名单。阻止[垃圾邮件发送者拥有的网络](http://www.spamhaus.org/drop/drop.lasso)、[具有静态 IP 的已知机器人](http://sblam.com/blacklist.txt)等。它们不足以提供完整的保护（您无法有效地对抗具有动态 IP 的 Windows 僵尸），但可以显着减少垃圾邮件的数量。

至于其余的，让那些看起来完全无辜的帖子，例如

*   您检测到用户的浏览器支持 JavaScript
*   帖子不包含链接
*   用户未从您收到的垃圾邮件多于访问者的国家/地区/ISP 进行连接
*   这个IP没有提交很多可疑的帖子

并在所有其他情况下要求 CAPTCHA。

如果您想为此付出更多努力，您应该对文本实施贝叶斯过滤并跟踪喜欢域的声誉。

我已经实现了一个[非常全面的过滤器——Sblam！](http://code.google.com/p/sblam/)它实现了各种反垃圾邮件技术并连接了几个外部黑名单。它是开源的，所以看看并复制代码！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T11:41:44.463

我使用[Commentor](http://rtur.net/blog/post/2009/02/16/Commentor-e28093-new-version.aspx)，但它只适用于[BlogEngine.net](http://www.dotnetblogengine.net/)，虽然它的源是可用的，你可以从中得到一些想法来实现

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T16:03:27.570

响应您对列表中新项目的请求...

一种打击垃圾邮件的建议方法是对电子邮件收取“虚拟邮资”费用。每封电子邮件大约只有几分之一。这对普通用户来说只是很小的不便，但对于发送数百万封电子邮件的大量垃圾邮件发送者来说，成本将变得过高。

这个主题的一个变体是每封电子邮件都有一个链接，如果单击该链接，则表明它是否是垃圾邮件。如果点击，发件人将被收取邮资。如果没有，电子邮件是免费的。

这两种方法的问题在于它是一个[煮沸海洋的问题](http://www.joelonsoftware.com/articles/fog0000000054.html)。您需要有一个电子邮件服务器网络来强制邮资并使其在系统上成为可取的。如果您是唯一一个收取邮费的服务器，其他人都会找到另一个提供商。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-31T17:41:44.437

其中大部分是由搜索引擎优化人员完成的，他们试图将更多链接返回到客户的网站。这使他们在谷歌中的排名更高。客户获得更高的排名，并认为 SEO 做得很好。

所以我捕获了假帖子的图像并圈出了状态栏中显示的链接。然后我通过他们的网站或通过 GoDaddy.com 找到客户的电子邮件地址。然后我通过电子邮件将图像发送给他们，告诉他们它是如何工作的，并要求他们告诉他们的 SEO 将其关闭。客户震惊地得知他们的 SEO 已将他们变成垃圾邮件发送者。有些人甚至打电话给我了解更多信息，大多数人（回应）说他们会跟进 SEO。在给一位客户发送电子邮件后，我实际上从垃圾邮件发送者那里收到了这封电子邮件：

**你好吉姆
我们正在为斯科特进行营销。我认为我的竞争对手用我的客户列表向您的网站发送了垃圾邮件。我会和你一起检查。

请不要联系任何其他网络所有者，我会立即检查。
问候**

我在他的网站上找到了“我们保证在 Google 上的首页展示位置”。当然，他的评论被禁用了......

不，这并没有让它停止 - 但它让我感觉更好。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-19T11:56:30.073

评论垃圾邮件通常由僵尸网络完成，因此任何依赖 IP 黑名单的行为最终都会阻止合法用户。

专注于使用[Akismet](http://akismet.com/)或使用经过验证的可访问 CAPTCHA 解决方案（如[reCAPTCHA](http://recaptcha.net/) ）分析消息内容。

库和插件可用于大多数语言和应用程序。

# qa - 软件质量的定义？

> ID：197042
> 
> 赞同：2
> 
> 时间：2008-10-13T08:55:38.587
> 
> 标签：qa

这里有很多关于测量和证明软件质量的问题，但是，到目前为止，Stackoverflow 上还没有对软件质量本身的正式定义：

**请给出正式的、包罗万象的软件产品质量定义。**

[由于这个问题相当笼统，我很乐意在每次提交时继续接受更好的定义。只要您可以添加一些有价值的东西，复制之前提交的答案的要点是可以的。]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T09:06:53.153

以下是 Wikipedia 对[软件质量](http://en.wikipedia.org/wiki/Software_quality)的评价。

文章列出了关于软件质量的几个定义和观点。最接近*软件产品质量*的是

> 符合要求或程序规范；与可靠性有关。

可靠性是“计算机程序在特定环境中特定时间内无故障运行的概率”。

除了产品质量，它还列出了：

*   可扩展性
*   正确性
*   完整性
*   没有错误
*   容错
*   可扩展性
*   可维护性
*   文档

质量因素被定义为“软件程序的非功能性需求，客户合同未提出，但仍然是提高软件程序质量的理想需求”。这是列表：

*   易懂
*   完整性
*   简明
*   可移植性
*   一致性
*   可维护性
*   可测试性
*   可用性
*   可靠性
*   结构化
*   效率
*   安全

编辑：澄清了质量因素的含义。

我曾经听说质量就像氧气。当它在那里时，你认为它是理所当然的。当它不存在时，您会注意到它并抱怨。因此，从什么是“劣质”软件的角度来定义质量可能更容易。例如，不安全的在线银行网站将是“低质量”产品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T09:27:48.820

软件质量的正式定义实际上以 ISO-9126 的形式提供，正如维基百科文章所引用的那样：[http ://en.wikipedia.org/wiki/ISO_9126](http://en.wikipedia.org/wiki/ISO_9126)

[http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=22749](http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=22749)定义了质量模型

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T08:58:55.460

优质的软件产品必须

*   做它应该做的，只有这个（没有副作用，没有错误）
*   可用于目标受众
*   对于打算这样做的程序员来说是可维护的
*   不会降低运行它的系统的安全性

*编辑：（文档、可移植性、效率等都是可取的奖励值，但不需要使其成为“质量”，而是使其具有可比性，恕我直言）*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T09:34:25.950

[![](https://i.stack.imgur.com/rMCOQ.gif)](https://i.stack.imgur.com/rMCOQ.gif)
[（来源：[codinghorror.com](http://www.codinghorror.com/blog/images/beagle_bros_certificate.gif)）]

我们的程序使用起来很有趣。

我们的说明清晰而完整。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T09:13:38.177

软件产品质量是发现软件产品缺陷的速度的倒数。

这并不意味着如果没有报告错误，您就具有良好的质量，因为您可能使报告问题变得过于困难。此外，如果问题存在，但没有被积极注意，它不会对质量产生太大影响，但如果经常被注意，则会对质量产生重大影响。严重错位的按钮会严重降低质量，即使它不会影响功能。

由于通常是用户注意到缺陷，因此根据开发人员的说法，某事是错误还是功能也无关紧要。如果用户认为某些东西是缺陷，那么它就是缺陷，无论是在用户培训、用户文档、用户界面还是实际功能中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T09:16:22.167

对此没有一个答案，许多公认的答案直接相互矛盾。一些流行的包括；

“质量对某些人或某些人来说很有价值” - Jerry Weinberg，质量软件和测试，2006 年 4 月

“质量就是符合标准”——菲利普·克罗斯比

“质量是维持业务的能力”——戴明

我们在 SQAforums 上对此进行了很好的[讨论](http://www.sqaforums.com/showflat.php?Cat=0&Number=434579)。广泛的共识是质量在很大程度上是主观的。就个人而言，我和杰里温伯格一起去。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T09:36:59.893

产品质量是其所有功能性和非功能性特征的集合。质量衡量标准取决于实际产品使用的环境。

软件产品可以具有以下特征：

*   功能属性（或产品执行的工作）

*   非功能属性（产品属性，而不是它执行的工作）

    a) 外观和感觉

    b) 可用性和人性化

    c) 性能

    d) 运营

    e) 可维护性和支持

    f) 安全

    g) 文化和政治

    h) 法律

[James 和 Suzanne Robertson 建议的功能性和非功能性属性分类 [http://www.volere.co.uk](http://www.volere.co.uk)]

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T09:51:58.350

我最喜欢的关于质量的报价是：

*质量绝不是意外；它始终是高度意图、真诚效果、明智的方向和熟练的执行的结果；它代表了许多替代方案的明智选择。*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T18:44:08.633

如果我要为质量打一个衡量标准，我认为最好的外部衡量标准是“人们愿意为此付出多少”。没有人愿意为糟糕的产品买单。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-17T14:59:32.423

温思罗普大学有一个很好的[PowerPoint 演示文稿](http://faculty.winthrop.edu/dannellys/csci626/02_Definition.ppt)，其中包含一些很好的示例和定义。你可能会发现它很有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-21T12:13:03.420

软件质量可能取决于两个标准，例如：

1.  与外部用户交互的结果
2.  与内部利益相关者互动的结果

以上两者都具有可用于确定软件整体质量的特征。简而言之，提供软件质量的通用定义可能不是一个好主意。不同的软件服务于不同的目的，可能有不同的质量要求。例如，作为搜索引擎的谷歌，从搜索的相关性、获得搜索结果的速度等方面，可以说是一款质量非常高的软件。但是，如果以外观和感觉作为标准，它并不是最漂亮的设计。

[您可能想在此页面](http://vitalflux.com/what-is-the-definition-of-software-quality/)上查看有关软件质量定义的详细信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-04T05:43:50.430

软件质量被定义为符合明确规定的功能和非功能要求、明确记录的开发标准以及所有专业开发软件所期望的隐含特征

# java - 在 JPA 中设置列 的默认值

> ID：197045
> 
> 赞同：279
> 
> 时间：2008-10-13T08:55:50.117
> 
> 标签：java, jpa, annotations

是否可以为 JPA 中的列设置默认值，如果使用注释，它是如何完成的？

* * *

## 回答 #1

> 赞同：343
> 
> 时间：2009-06-18T15:54:25.530

您可以执行以下操作：

```
@Column(name="price")
private double price = 0.0; 
```

那里！您刚刚使用零作为默认值。

请注意，如果您仅从此应用程序访问数据库，这将为您服务。如果其他应用程序也使用数据库，那么您应该使用[Cameron 的](https://stackoverflow.com/questions/197045/setting-default-values-for-columns-in-jpa/375202#375202) *columnDefinition*注释属性或其他方式从数据库中进行此检查。

* * *

## 回答 #2

> 赞同：259
> 
> 时间：2008-12-17T16:44:06.493

`columnDefinition`实际上，在 JPA 中是可能的，尽管使用注释的属性有点小技巧`@Column`，例如：

```
@Column(name="Price", columnDefinition="Decimal(10,2) default '100.00'") 
```

* * *

## 回答 #3

> 赞同：122
> 
> 时间：2012-11-17T16:02:31.543

另一种方法是使用 javax.persistence.PrePersist

```
@PrePersist
void preInsert() {
   if (this.createdTime == null)
       this.createdTime = new Date();
} 
```

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2017-02-10T03:21:58.160

在 2017 年，JPA 2.1 仍然只有`@Column(columnDefinition='...')`您在其中放置列的文字 SQL 定义。这是非常不灵活的，并迫使您还声明类型等其他方面，从而缩短了 JPA 实现对此事的看法。

休眠虽然，有这个：

```
@Column(length = 4096, nullable = false)
@org.hibernate.annotations.ColumnDefault("")
private String description; 
```

> 标识通过 DDL 应用于关联列的 DEFAULT 值。

*   [Hibernate 4.3 文档](https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/annotations/ColumnDefault.html)（4.3 表明它已经存在了很长一段时间）
*   [关于数据库列的默认值的](https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#schema-generation-column-default-value)休眠手册

对此有两点说明：

1）不要害怕不标准。作为一名 JBoss 开发人员，我见过不少规范流程。该规范基本上是给定领域的大玩家愿意承诺在未来十年左右提供支持的基线。对于安全来说确实如此，对于消息传递来说，ORM 没有区别（尽管 JPA 涵盖了很多内容）。我作为开发人员的经验是，在一个复杂的应用程序中，迟早你会需要一个非标准的 API。并且`@ColumnDefault`是一个例子，它超过了使用非标准解决方案的负面影响。

2）每个人都如何挥动@PrePersist 或构造函数成员初始化，这很好。但这不一样。批量 SQL 更新怎么样？不设置列的语句怎么样？`DEFAULT`有它的作用，并且不能通过初始化 Java 类成员来替代。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-04-12T12:38:17.453

JPA 不支持这一点，如果支持它会很有用。使用 columnDefinition 是特定于数据库的，在许多情况下是不可接受的。当您检索具有空值的记录时，在类中设置默认值是不够的（这通常发生在您重新运行旧的 DBUnit 测试时）。我要做的是：

```
public class MyObject
{
    int attrib = 0;

    /** Default is 0 */
    @Column ( nullable = true )
    public int getAttrib()

    /** Falls to default = 0 when null */
    public void setAttrib ( Integer attrib ) {
       this.attrib = attrib == null ? 0 : attrib;
    }
} 
```

Java 自动装箱在这方面有很大帮助。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-03-31T16:45:16.547

```
@Column(columnDefinition="tinyint(1) default 1") 
```

我刚刚测试了这个问题。**它工作得很好。**感谢您的提示。

* * *

关于评论：

```
@Column(name="price") 
private double price = 0.0; 
```

这个**没有**设置数据库中的默认列值（当然）。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2010-11-12T17:37:45.287

看到我在尝试解决同样的问题时从谷歌偶然发现了这个，我只是将我准备好的解决方案扔进去，以防有人发现它有用。

从我的角度来看，这个问题实际上只有 1 个解决方案——@PrePersist。如果您在@PrePersist 中执行此操作，则必须检查该值是否已经设置。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2016-04-05T10:02:47.607

你可以使用java反射api：

```
 @PrePersist
    void preInsert() {
       PrePersistUtil.pre(this);
    } 
```

这很常见：

```
 public class PrePersistUtil {

        private static SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");

        public static void pre(Object object){
            try {
                Field[] fields = object.getClass().getDeclaredFields();
                for(Field field : fields){
                    field.setAccessible(true);
                    if (field.getType().getName().equals("java.lang.Long")
                            && field.get(object) == null){
                        field.set(object,0L);
                    }else if    (field.getType().getName().equals("java.lang.String")
                            && field.get(object) == null){
                        field.set(object,"");
                    }else if (field.getType().getName().equals("java.util.Date")
                            && field.get(object) == null){
                        field.set(object,sdf.parse("1900-01-01"));
                    }else if (field.getType().getName().equals("java.lang.Double")
                            && field.get(object) == null){
                        field.set(object,0.0d);
                    }else if (field.getType().getName().equals("java.lang.Integer")
                            && field.get(object) == null){
                        field.set(object,0);
                    }else if (field.getType().getName().equals("java.lang.Float")
                            && field.get(object) == null){
                        field.set(object,0.0f);
                    }
                }
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            } catch (ParseException e) {
                e.printStackTrace();
            }
        }
    } 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-01-05T21:49:12.027

我用过`columnDefinition`，效果很好

```
@Column(columnDefinition="TIMESTAMP DEFAULT CURRENT_TIMESTAMP")

private Date createdDate; 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-12-06T22:08:23.863

您不能使用列注释来执行此操作。我认为唯一的方法是在创建对象时设置默认值。也许默认构造函数是这样做的正确位置。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-12-21T05:34:11.593

就我而言，我修改了 hibernate-core 源代码，引入了一个新的注解`@DefaultValue`：

```
commit 34199cba96b6b1dc42d0d19c066bd4d119b553d5
Author: Lenik <xjl at 99jsj.com>
Date:   Wed Dec 21 13:28:33 2011 +0800

    Add default-value ddl support with annotation @DefaultValue.

diff --git a/hibernate-core/src/main/java/org/hibernate/annotations/DefaultValue.java b/hibernate-core/src/main/java/org/hibernate/annotations/DefaultValue.java
new file mode 100644
index 0000000..b3e605e
--- /dev/null
+++ b/hibernate-core/src/main/java/org/hibernate/annotations/DefaultValue.java
@@ -0,0 +1,35 @@
+package org.hibernate.annotations;
+
+import static java.lang.annotation.ElementType.FIELD;
+import static java.lang.annotation.ElementType.METHOD;
+import static java.lang.annotation.RetentionPolicy.RUNTIME;
+
+import java.lang.annotation.Retention;
+
+/**
+ * Specify a default value for the column.
+ *
+ * This is used to generate the auto DDL.
+ *
+ * WARNING: This is not part of JPA 2.0 specification.
+ *
+ * @author 谢继雷
+ */
+@java.lang.annotation.Target({ FIELD, METHOD })
+@Retention(RUNTIME)
+public @interface DefaultValue {
+
+    /**
+     * The default value sql fragment.
+     *
+     * For string values, you need to quote the value like 'foo'.
+     *
+     * Because different database implementation may use different 
+     * quoting format, so this is not portable. But for simple values
+     * like number and strings, this is generally enough for use.
+     */
+    String value();
+
+}
diff --git a/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3Column.java b/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3Column.java
index b289b1e..ac57f1a 100644
--- a/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3Column.java
+++ b/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3Column.java
@@ -29,6 +29,7 @@ import org.hibernate.AnnotationException;
 import org.hibernate.AssertionFailure;
 import org.hibernate.annotations.ColumnTransformer;
 import org.hibernate.annotations.ColumnTransformers;
+import org.hibernate.annotations.DefaultValue;
 import org.hibernate.annotations.common.reflection.XProperty;
 import org.hibernate.cfg.annotations.Nullability;
 import org.hibernate.mapping.Column;
@@ -65,6 +66,7 @@ public class Ejb3Column {
    private String propertyName;
    private boolean unique;
    private boolean nullable = true;
+   private String defaultValue;
    private String formulaString;
    private Formula formula;
    private Table table;
@@ -175,7 +177,15 @@ public class Ejb3Column {
        return mappingColumn.isNullable();
    }

-   public Ejb3Column() {
+   public String getDefaultValue() {
+        return defaultValue;
+    }
+
+    public void setDefaultValue(String defaultValue) {
+        this.defaultValue = defaultValue;
+    }
+
+    public Ejb3Column() {
    }

    public void bind() {
@@ -186,7 +196,7 @@ public class Ejb3Column {
        }
        else {
            initMappingColumn(
-                   logicalColumnName, propertyName, length, precision, scale, nullable, sqlType, unique, true
+                   logicalColumnName, propertyName, length, precision, scale, nullable, sqlType, unique, defaultValue, true
            );
            log.debug( "Binding column: " + toString());
        }
@@ -201,6 +211,7 @@ public class Ejb3Column {
            boolean nullable,
            String sqlType,
            boolean unique,
+           String defaultValue,
            boolean applyNamingStrategy) {
        if ( StringHelper.isNotEmpty( formulaString ) ) {
            this.formula = new Formula();
@@ -217,6 +228,7 @@ public class Ejb3Column {
            this.mappingColumn.setNullable( nullable );
            this.mappingColumn.setSqlType( sqlType );
            this.mappingColumn.setUnique( unique );
+           this.mappingColumn.setDefaultValue(defaultValue);

            if(writeExpression != null && !writeExpression.matches("[^?]*\\?[^?]*")) {
                throw new AnnotationException(
@@ -454,6 +466,11 @@ public class Ejb3Column {
                    else {
                        column.setLogicalColumnName( columnName );
                    }
+                   DefaultValue _defaultValue = inferredData.getProperty().getAnnotation(DefaultValue.class);
+                   if (_defaultValue != null) {
+                       String defaultValue = _defaultValue.value();
+                       column.setDefaultValue(defaultValue);
+                   }

                    column.setPropertyName(
                            BinderHelper.getRelativePath( propertyHolder, inferredData.getPropertyName() )
diff --git a/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3JoinColumn.java b/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3JoinColumn.java
index e57636a..3d871f7 100644
--- a/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3JoinColumn.java
+++ b/hibernate-core/src/main/java/org/hibernate/cfg/Ejb3JoinColumn.java
@@ -423,6 +424,7 @@ public class Ejb3JoinColumn extends Ejb3Column {
                getMappingColumn() != null ? getMappingColumn().isNullable() : false,
                referencedColumn.getSqlType(),
                getMappingColumn() != null ? getMappingColumn().isUnique() : false,
+               null, // default-value
                false
        );
        linkWithValue( value );
@@ -502,6 +504,7 @@ public class Ejb3JoinColumn extends Ejb3Column {
                getMappingColumn().isNullable(),
                column.getSqlType(),
                getMappingColumn().isUnique(),
+               null, // default-value
                false //We do copy no strategy here
        );
        linkWithValue( value ); 
```

好吧，这是一个仅限休眠的解决方案。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-06-27T22:40:51.107

1.  `@Column(columnDefinition='...')`插入数据时在数据库中设置默认约束时不起作用。
2.  您需要从注释中创建`insertable = false`和删除`columnDefinition='...'`，然后数据库将自动从数据库中插入默认值。
3.  例如，当您在数据库中设置 varchar 时，性别默认为男性。
4.  您只需要添加`insertable = false`Hibernate/JPA 即可。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-10-11T12:43:54.783

```
@PrePersist
void preInsert() {
    if (this.dateOfConsent == null)
        this.dateOfConsent = LocalDateTime.now();
    if(this.consentExpiry==null)
        this.consentExpiry = this.dateOfConsent.plusMonths(3);
} 
```

在我的情况下，由于字段是 LocalDateTime 我使用了这个，由于供应商独立性，建议使用它

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-13T09:10:06.483

这在 JPA 中是不可能的。

以下是您*可以*使用 Column 注释执行的操作：http: [//java.sun.com/javaee/5/docs/api/javax/persistence/Column.html](http://java.sun.com/javaee/5/docs/api/javax/persistence/Column.html)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-02-08T10:24:18.333

如果您使用的是双打，您可以使用以下内容：

```
@Column(columnDefinition="double precision default '96'")

private Double grolsh; 
```

是的，它是特定于数据库的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-08-03T20:13:29.807

JPA 和 Hibernate 注释都不支持默认列值的概念。作为此限制的解决方法，请在调用 Hibernate 之前`save()`或`update()`在会话上设置所有默认值。这尽可能地（没有 Hibernate 设置默认值）模仿数据库的行为，当它在表中保存一行时设置默认值。

与此[替代答案](https://stackoverflow.com/questions/197045/setting-default-values-for-columns-in-jpa/1013520#1013520)所建议的在模型类中设置默认值不同，此方法还确保使用`Example`对象作为搜索原型的条件查询将继续像以前一样工作。当您在模型类中设置可空属性（具有非原始类型的属性）的默认值时，Hibernate 示例查询将不再忽略之前因为它为空而忽略它的关联列。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-03-03T00:41:23.753

您可以在数据库设计器中定义默认值，也可以在创建表时定义。例如，在 SQL Server 中，您可以将 Date 字段的默认 Vault 设置为 ( `getDate()`)。`insertable=false`按照列定义中的说明使用。JPA 不会在插入时指定该列，数据库将为您生成值。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-19T19:57:28.763

我找到了解决相同问题的另一种方法，因为当我创建自己的对象并保存在数据库中并且不尊重具有默认值的 DDL 时。

所以我查看了我的控制台，生成了 SQL，并看到 insert 带有所有字段，但我的对象中只有一个属性的值发生了变化。

所以我在模型类中放了这个注解。

`@DynamicInsert`

插入数据时，框架不插入空值或未修改的值，使插入时间更短。

还有`@DynamicUpdate`注释。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-10-22T01:06:32.567

我尝试了几种 JPA/Hiberate 方法，但似乎没有一种效果很好。由于我使用的是 Oracle，因此我在触发器中创建了一个“前触发器”，对 null 进行简单测试，然后根据需要设置 null

# asp.net - <% %> 和 <%=%> 有什么区别？

> ID：197047
> 
> 赞同：15
> 
> 时间：2008-10-13T08:56:54.420
> 
> 标签：asp.net, asp.net-mvc

`<% %>`和`<%= %>`ASP.NET MVC有什么区别？什么时候用哪个？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-13T09:25:53.830

另请参阅[此问题](https://stackoverflow.com/questions/115159)。MVC 并没有改变这些蜂刺的工作方式，只是改变了它们的使用频率。

基本上：

*   `<%`- 执行代码
*   `<%@`- 页面指令
*   `<%$`- 资源访问
*   `<%=`- 显式输出到页面
*   `<%#`- 数据绑定
*   `<%--`- 服务器端评论块

ASP.Net 4 中的新功能：

*   `<%:`- 写入页面，但使用 HTML 编码

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-13T08:58:33.090

<%= %> 写入输出流（通常是 html），而 <% %> 用于执行任意脚本代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-13T09:03:25.843

假设您的页面上有一个名为“SayHello”的方法：

```
protected string SayHello()
{
    return "Hello!";
} 
```

在您的页面上，您有以下声明：

```
first: <%= SayHello() %>
second: <% SayHello() %> 
```

您的输出将是：

```
first: Hello!
second: 
```

当您使用 <%= %> 时，您放入的内容将插入到该位置的 html 中。如果你使用 <% %>，你只是在你的页面中插入一些代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T09:03:41.473

<%= 回显该语句。

<% 只是运行它。

# c++ - 惯用 std::auto_ptr 还是只使用 shared_ptr？

> ID：197048
> 
> 赞同：19
> 
> 时间：2008-10-13T08:56:56.480
> 
> 标签：c++, coding-style, smart-pointers, tr1

现在`shared_ptr`在 tr1 中，您认为使用 应该发生`std::auto_ptr`什么？它们都有不同的用例，但`auto_ptr`也可以用 解决所有用例`shared_ptr`。`auto_ptr`如果您想明确表示在任何给定点上只有一个类拥有所有权，您会放弃还是继续使用它？

我的看法是，使用`auto_ptr`可以增加代码的清晰度，正是通过增加细微差别和代码设计的指示，但另一方面，它在培训新程序员时增加了另一个微妙的问题：他们需要理解智能指针和它们如何工作的详细信息。当您在任何地方只使用一个智能指针时，您只需制定一条规则“将所有指针包装在`shared_ptr`”中并完成它。

你对此有何看法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-13T09:34:03.223

auto_ptr 在签名方面也很好。当一个函数接受一个`auto_ptr<T>`值时，这意味着它将消耗`T`. 如果一个函数返回一个`auto_ptr<T>`，很明显它放弃了所有权。这可以传达您关于生命周期的意图。

另一方面， using`scoped_ptr<T>`意味着您不想关心`T`. 这也意味着您可以在更多地方使用它。两个智能指针都是有效的选择，你当然可以在一个程序中同时拥有它们。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-13T15:52:00.837

`std::auto_ptr`为“避免”阵营 提供更多弹药：`auto_ptr`在下一个标准（C++0x）中被弃用。我认为仅此一项就足以让任何论点使用其他东西。

但是，正如[Konrad Rudolph](https://stackoverflow.com/questions/197048/idiomatic-use-of-stdautoptr-or-only-use-sharedptr#197083)所提到的，默认替换`auto_ptr`可能应该是`boost::scoped_ptr`. 的语义与 的语义`scoped_ptr`更接近，`auto_ptr`并且旨在用于类似的用途。下一个 C++09 标准将有类似的东西，称为 unique_ptr。

However, using `shared_ptr` anywhere that `scoped_ptr` should be used will not break anything, it'll just add a very slight bit of inefficiency to deal with the reference count if the object is never actually going to be shared. So for private member pointers that will never be handed out to another object - use `scoped_ptr`. If the pointer will be handed out to something else (this includes using them in containers or if all you want to do is transfer ownership and not keep or share it) - use `shared_ptr`.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T09:33:56.123

“`shared_ptr`到处使用”是一个很好的默认规则，当然也是教人们负责任地使用智能指针的一个很好的起点。然而，它并不总是最好的选择。

如果您不需要共享所有权，`shared_ptr`那就大材小用了：它必须为引用计数分配一个单独的内存块，这会影响性能，而且在文档方面不太清楚。

就个人而言，我`std::auto_ptr`在许多地方使用`boost::scoped_ptr`也足够了：例如，在所有权转移到其他地方之前持有一个堆分配的对象，干预操作可能会抛出。

C++0x`std::unique_ptr`必须`std::shared_ptr`作为`std::auto_ptr`. 当它变得广泛可用时，我将开始使用它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T09:20:24.483

我认为，*如果*您不介意使用 Boost ，则最好的做法是用`std::auto_ptr`by 的所有用途替换，[`boost::scoped_ptr`](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/scoped_ptr.htm)除非`std::tr1::shared_ptr`更好地满足要求。另一方面，它肯定是故意的，没有包含在 TR1 中。*`scoped_ptr`*

 ** * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-13T09:02:41.537

我相信“包装所有指针`shared_ptr`”确实应该是默认模式，并且是给初级程序员的合适建议。但是，在您提到的特殊所有权情况下，`auto_ptr`确实更合适，应鼓励在这种情况下使用。

# java - javac.exe AST 编程访问示例

> ID：197057
> 
> 赞同：10
> 
> 时间：2008-10-13T09:03:28.633
> 
> 标签：java, javac, abstract-syntax-tree

是否可以通过编程方式访问 javac.exe 中的抽象语法树（AST）？你能举个例子吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T12:53:50.527

是的，这是可能的，但只是从 Java 6 开始[。Peter von der Ahé在](http://java.sun.com/developer/Meet-Eng/vonderahe/)[这次采访](http://www.artima.com/lejava/articles/compiler_api.html)中谈到了这两个 JSR 。JSR 199：

> JSR 199 Compiler API 由三部分组成：第一部分基本上允许您通过 API 调用编译器。其次，API 允许您自定义编译器查找和写出文件的方式。我的意思是抽象意义上的文件，因为编译器处理的文件不一定在文件系统上。例如，JSR 199 的文件抽象允许您在数据库中拥有文件，并直接生成输出到内存。最后，JSR 199 API 允许您以结构化的方式从编译器收集诊断信息，以便您可以轻松地将错误消息转换为例如 IDE 编辑器中的行。

JSR 269 是注释处理 API。

[本文对访问](http://today.java.net/pub/a/today/2008/04/10/source-code-analysis-using-java-6-compiler-apis.html)[Compiler Tree API](http://java.sun.com/javase/6/docs/jdk/api/javac/tree/index.html)进行了出色的概述。“[访问抽象语法树：编译器树 API](https://web.archive.org/web/20151023040328/http://today.java.net/pub/a/today/2008/04/10/source-code-analysis-using-java-6-compiler-apis.html#accessing-the-abstract-syntax-tree-the-compiler-tree-api) ”部分似乎特别适合您的问题。

根据您正在做的事情，您可能还想查看[Jackpot Rule Language](http://jackpot.netbeans.org/docs/rule-language.html)，它是一个独立的重构引擎，可以插入到编译器树中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T13:33:48.947

编译并运行它（显然`-cp tools.jar`你必须指定你的位置）。`tools.jar`

```
import com.sun.source.util.Trees;
import javax.tools.JavaCompiler;
import javax.tools.StandardJavaFileManager;
import javax.tools.ToolProvider;

public class JCTreeTest {
    private static final JavaCompiler javac
            = ToolProvider.getSystemJavaCompiler();

    public static void main(String[] args) {
        final StandardJavaFileManager jfm
                = javac.getStandardFileManager(null, null, null);
        final JavaCompiler.CompilationTask task
                = javac.getTask(null, jfm, null, null, null,
                  jfm.getJavaFileObjects(args));
        final Trees trees = Trees.instance(task);
        // Do stuff with "trees"
    }
} 
```

它为我编译和运行，虽然我自己没有玩过树的东西，所以你必须自己[阅读 javadoc](http://java.sun.com/javase/6/docs/jdk/api/javac/tree/)。：-） 祝你好运！

# c# - 将字典值转换为数组

> ID：197059
> 
> 赞同：85
> 
> 时间：2008-10-13T09:04:00.740
> 
> 标签：c#, .net, arrays, generics, dictionary

将字典的值列表转换为数组的最有效方法是什么？

例如，如果我有`Dictionary`where `Key`is`String`和`Value`is `Foo`，我想得到`Foo[]`

我正在使用 VS 2005，C# 2.0

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-10-13T09:05:08.490

```
// dict is Dictionary<string, Foo>

Foo[] foos = new Foo[dict.Count];
dict.Values.CopyTo(foos, 0);

// or in C# 3.0:
var foos = dict.Values.ToArray(); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-03-29T15:20:07.320

将其存储在列表中。它更容易；

```
List<Foo> arr = new List<Foo>(dict.Values); 
```

当然，如果你特别想要它在一个数组中；

```
Foo[] arr = (new List<Foo>(dict.Values)).ToArray(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T09:09:43.457

Values 上有一个 ToArray() 函数：

```
Foo[] arr = new Foo[dict.Count];    
dict.Values.CopyTo(arr, 0); 
```

但我认为它效率不高（我还没有真正尝试过，但我猜它会将所有这些值复制到数组中）。你真的需要一个数组吗？如果没有，我会尝试通过 IEnumerable：

```
IEnumerable<Foo> foos = dict.Values; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-21T13:49:16.577

如果您想使用 linq，那么您可以尝试以下操作：

```
Dictionary<string, object> dict = new Dictionary<string, object>();
var arr = dict.Select(z => z.Value).ToArray(); 
```

我不知道哪个更快或更好。两者都为我工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-18T23:06:16.893

如今，一旦有了 LINQ，就可以将字典键及其值转换为单个字符串。

您可以使用以下代码：

```
// convert the dictionary to an array of strings
string[] strArray = dict.Select(x => ("Key: " + x.Key + ", Value: " + x.Value)).ToArray();

// convert a string array to a single string
string result = String.Join(", ", strArray); 
```

# java - Eclipse 抽象语法树编程访问

> ID：197070
> 
> 赞同：3
> 
> 时间：2008-10-13T09:09:28.233
> 
> 标签：java, eclipse, abstract-syntax-tree

您能否提供一个以编程方式访问给定代码的 Eclipse 抽象语法树的示例？

例如获取 AST 用于：

* * *

## Class1.java

```
package parseable;

public class Class1 {

/**
 * @param args
 */
public static void main(String[] args) {
    System.out.println("Hello world!");
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T09:15:02.073

这不是一个*确切的*答案，可能会给您一个开始的地方：

正如在这个[问题](https://stackoverflow.com/questions/160382/extract-all-string-from-a-java-project#161145)中所说，

此[Eclipse 角文章](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html)中提供了完整示例，更多详细信息请参见[Eclipse 帮助](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/dom/ASTParser.html)。在[本演示文稿](http://www1.cs.columbia.edu/~aho/cs4117/lectures/Static%20Analysis%20for%20Java%20in%20Eclipse.pdf)的幻灯片 59 中，您将了解如何将更改应用到您的源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-03T20:08:05.250

```
// get an ICompilationUnit by some means
// you might drill down from an IJavaProject, for instance 
ICompilationUnit iunit = ...

// create a new parser for the latest Java Language Spec
ASTParser parser = ASTParser.newParser(AST.JLS3);

// tell the parser you are going to pass it some code where the type level is a source file
// you might also just want to parse a block, or a method ("class body declaration"), etc
parser.setKind(ASTParser.K_COMPILATION_UNIT);

// set the source to be parsed to the ICompilationUnit
// we could also use a character array
parser.setSource(iunit);

// parse it.
// the output will be a CompilationUnit (also an ASTNode)
// the null is because we're not using a progress monitor
CompilationUnit unit = (CompilationUnit) parser.createAST(null); 
```

不要被 ICompilationUnit 与 CompilationUnit 的区别所迷惑，这似乎只是他们的非创造性命名的结果。CompilationUnit 是一种 ASTNode。在这种情况下，ICompilationUnit 类似于文件句柄。有关区别的更多信息，请参见此处：[http ://wiki.eclipse.org/FAQ_How_do_I_manipulate_Java_code%3F](http://wiki.eclipse.org/FAQ_How_do_I_manipulate_Java_code%3F)

# open-source - 您会推荐哪些开源 comet/reverse-ajax 库与 Tomcat 5.5 一起使用？为什么？

> ID：197077
> 
> 赞同：-1
> 
> 时间：2008-10-13T09:12:48.600
> 
> 标签：open-source, comet, tomcat5.5, reverse-ajax

我在 Jetty 6.0 中看到了解决 Comet/reverse-ajax 应用程序扩展的问题。

是否有任何其他库/框架可用于 Tomcat 5.5？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T21:40:07.907

我会检查 DWR（直接 Web 远程处理）。它有相当不错的文档和受人尊敬的用户群。

[DWR](http://directwebremoting.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-17T14:26:37.013

[ItsNat Comet](http://www.innowhere.com:8080/itsnat/feashow_servlet?itsnat_doc_name=feashow.main&feature=feashow.core.listeners.cometNotifier.ex)适用于 Java 1.4 JVM，包括带有此 JVM 的 Tomcat 5.5，当然支持更高版本的 Java 和 servlet 容器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T16:46:38.467

[气氛](https://atmosphere.dev.java.net/)是我一直在寻找的那种东西。

# c# - 在 C# 中展平 Ruby 方法

> ID：197081
> 
> 赞同：6
> 
> 时间：2008-10-13T09:17:38.340
> 
> 标签：c#, ruby, arrays

如何在 C# 中执行 Ruby 方法[“Flatten”Ruby 方法。](http://www.ruby-doc.org/core/classes/Array.html#M002241)此方法将锯齿状数组展平为一维数组。

例如：

```
s = [ 1, 2, 3 ]           #=> [1, 2, 3]
t = [ 4, 5, 6, [7, 8] ]   #=> [4, 5, 6, [7, 8]]
a = [ s, t, 9, 10 ]       #=> [[1, 2, 3], [4, 5, 6, [7, 8]], 9, 10]
a.flatten                 #=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T09:24:48.857

递归解决方案：

```
IEnumerable Flatten(IEnumerable array)
{
    foreach(var item in array)
    {
        if(item is IEnumerable)
        {
            foreach(var subitem in Flatten((IEnumerable)item))
            {
                yield return subitem;
            }
        }
        else
        {
            yield return item;
        }
    }
} 
```

编辑1：

[Jon](https://stackoverflow.com/users/22656/jon-skeet)在评论中解释了为什么它不能是通用方法，看看吧！

编辑2：

[Matt](https://stackoverflow.com/users/615/matt-hamilton)建议将其作为扩展方法。在这里，只需将第一行替换为：

```
public static IEnumerable Flatten(this IEnumerable array) 
```

你可以像这样使用它：

```
foreach(var item in myArray.Flatten()) { ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T06:07:28.833

我会在评论中回复，但我需要超过 300 个字符。

@Alexander 的解决方案很棒，但它遇到了字符串数组的问题。由于字符串实现了 IEnumerable，我认为它最终会返回每个字符串中的每个字符。您可以使用通用参数告诉它您希望在这些情况下返回什么样的东西，例如：

```
public static IEnumerable Flatten<T>(IEnumerable e)
{
    if (e == null) yield break;
    foreach (var item in e)
    {
        if (item is T)
           yield return (T)item;
        else if (item is IEnumerable)
        {
            foreach (var subitem in Flatten<T>((IEnumerable)item))
                yield return subitem;
        }
        else
           yield return item;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-03T18:58:49.707

你不能只使用 IEnumerable#SelectMany 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-19T09:15:15.903

我也同意 SelectMany 这样做。

```
var s = new[] { 1, 2, 3 };
var t = new[] { 4, 5, 6 };
var a = new[] { s, t, new[] {7, 8} };

a.SelectMany(e => e); 
// IEnumerable<int> {1,2,3,4,5,6,7,8} 
```

我标准化了数组。s 和 t 是 int 数组。a 是一个数组数组。你没有混合数组与 int 和数组，就像你可以在 ruby​​ 中那样。

但反之亦然。flatten 是我在 C# 中寻找 SelectMany 的红宝石等价物

# .net - Keyboard.Focus(item) 和 item.Focus() 有什么区别？

> ID：197088
> 
> 赞同：15
> 
> 时间：2008-10-13T09:25:12.647
> 
> 标签：.net, wpf

在 WPF 中，有两种方法可以将焦点设置到元素。
您可以调用输入元素的 .Focus() 方法，也可以使用输入元素作为参数调用 Keyboard.Focus()。

```
// first way:
item.Focus();
// alternate way:
Keyboard.Focus(item); 
```

这两者有什么区别？在某些情况下是否有特殊原因使用其中一个而不是另一个？
到目前为止，我没有注意到任何区别——无论我使用什么方法，该项目总是得到逻辑焦点和键盘焦点。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-13T13:31:31.370

首先要做的事情之一`item.Focus()`是调用`Keyboard.Focus( this )`. 如果失败，那么它会调用`FocusManager`，因为 decasteljau 已回答。

以下内容是从[Reflector](http://reflector.red-gate.com/)的 disassambler 视图中复制而来的。

这是来自`UIElement`（`UIElement3D`相同）：

```
public bool Focus()
{
    if (Keyboard.Focus(this) == this)
    {
        return true;
    }
    if (this.Focusable && this.IsEnabled)
    {
        DependencyObject focusScope = FocusManager.GetFocusScope(this);
        if (FocusManager.GetFocusedElement(focusScope) == null)
        {
            FocusManager.SetFocusedElement(focusScope, this);
        }
    }
    return false;
} 
```

这是来自`ContentElement`：

```
public bool Focus()
{
    return (Keyboard.Focus(this) == this);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T09:32:20.620

根据[MSDN 上的 WPF 文档](http://msdn.microsoft.com/en-us/library/aa969768.aspx)：

> 在 WPF 中有两个与焦点相关的主要概念：键盘焦点和逻辑焦点。键盘焦点是指接收键盘输入的元素，逻辑焦点是指焦点范围内具有焦点的元素。

和

> 具有键盘焦点的元素也将具有逻辑焦点，但具有逻辑焦点的元素不一定具有键盘焦点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T11:37:49.463

此外，您可能想知道 item.Focus() 相当于调用：

```
DependencyObject focusScope = FocusManager.GetFocusScope(item);
if (FocusManager.GetFocusedElement(focusScope) == null)
{
   FocusManager.SetFocusedElement(focusScope, item);
} 
```

# wpf - WPF 与 StringFormat 的绑定在 ToolTips 上不起作用

> ID：197095
> 
> 赞同：91
> 
> 时间：2008-10-13T09:31:11.357
> 
> 标签：wpf, binding

下面的代码有一个简单的绑定，它使用完全相同的绑定表示法将名为 MyTextBlock 的 TextBlock 的 Text 绑定到 TextBox 的 Text 和 ToolTip 属性：

```
<StackPanel>
    <TextBlock x:Name="MyTextBlock">Foo Bar</TextBlock>
    <TextBox    Text="{Binding ElementName=MyTextBlock, Path=Text, StringFormat='It is: \{0\}'}"
             ToolTip="{Binding ElementName=MyTextBlock, Path=Text, StringFormat='It is: \{0\}'}" />
</StackPanel> 
```

该绑定还使用[.NET 3.5 SP1 引入的 StringFormat 属性，](http://blogs.msdn.com/llobo/archive/2008/05/19/wpf-3-5-sp1-feature-stringformat.aspx)该属性对于上述 Text 属性工作正常，但对于 ToolTip 似乎已损坏。预期的结果是“它是：Foo Bar”，但是当您将鼠标悬停在 TextBox 上时，工具提示仅显示绑定值，而不是字符串格式的值。有任何想法吗？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2008-10-13T09:45:41.297

WPF 中的工具提示可以包含任何内容，而不仅仅是文本，因此它们为您只需要文本的时间提供 ContentStringFormat 属性。据我所知，您需要使用扩展语法：

```
<TextBox ...>
  <TextBox.ToolTip>
    <ToolTip 
      Content="{Binding ElementName=myTextBlock,Path=Text}"
      ContentStringFormat="{}It is: {0}"
      />
  </TextBox.ToolTip>
</TextBox> 
```

我不能 100% 确定使用嵌套属性中的 ElementName 语法进行绑定的有效性，但 ContentStringFormat 属性正是您要寻找的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-07-31T09:54:28.083

这可能是一个错误。当您对工具提示使用简短语法时：

```
<TextBox ToolTip="{Binding WhatEverYouWant StringFormat='It is: \{0\}'}" /> 
```

StringFormat 被忽略，但是当您使用扩展语法时：

```
<TextBox Text="text">
   <TextBox.ToolTip>
      <TextBlock Text="{Binding WhatEverYouWant StringFormat='It is: \{0\}'}"/>
   </TextBox.ToolTip>
</TextBox> 
```

它按预期工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-13T16:31:06.550

正如马特所说，工具提示可以包含任何内容，因此您可以在工具提示中绑定一个 TextBox.Text。

```
<StackPanel>
    <TextBlock x:Name="MyTextBlock">Foo Bar</TextBlock>
    <TextBox Text="{Binding ElementName=MyTextBlock, Path=Text, StringFormat='It is: \{0\}'}">
        <TextBox.ToolTip>
            <TextBlock>
                <TextBlock.Text>
                    <Binding ElementName=MyTextBlock Path="Text" StringFormat="It is: {0}" />
                </TextBlock.Text>
            </TextBlock>
        </TextBox.ToolTip>
    </TextBox>
</StackPanel> 
```

甚至您也可以在 ToolTip 内堆叠一个网格并根据需要布置您的文本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-25T22:01:07.100

你的代码可以这么短：

```
<TextBlock ToolTip="{Binding PrideLands.YearsTillSimbaReturns,
    Converter={StaticResource convStringFormat},
    ConverterParameter='Rejoice! Just {0} years left!'}" Text="Hakuna Matata"/> 
```

与 StringFormat 不同，我们将使用永远不会忽略转换器这一事实。

将其放入**StringFormatConverter.cs**：

```
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace TLKiaWOL
{
    [ValueConversion (typeof(object), typeof(string))]
    public class StringFormatConverter : IValueConverter
    {
        public object Convert (object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (ReferenceEquals(value, DependencyProperty.UnsetValue))
                return DependencyProperty.UnsetValue;
            return string.Format(culture, (string)parameter, value);
        }

        public object ConvertBack (object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotSupportedException();
        }
    }
} 
```

将其放入您的**ResourceDictionary.xaml**：

```
<conv:StringFormatConverter x:Key="convStringFormat"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-10T20:14:07.810

在这种情况下，您可以使用相对绑定：

```
<StackPanel>
    <TextBlock x:Name="MyTextBlock">Foo Bar</TextBlock>
    <TextBox Text="{Binding ElementName=MyTextBlock, Path=Text, StringFormat='It is: \{0\}'}"
             ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}" />
</StackPanel> 
```

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2008-10-13T12:18:28.180

以下是一个冗长的解决方案，但它有效。

```
<StackPanel>
  <TextBox Text="{Binding Path=., StringFormat='The answer is: {0}'}">
    <TextBox.DataContext>
      <sys:Int32>42</sys:Int32>
    </TextBox.DataContext>
    <TextBox.ToolTip>
      <ToolTip Content="{Binding}" ContentStringFormat="{}The answer is: {0}" />
    </TextBox.ToolTip>
  </TextBox>
</StackPanel> 
```

我更喜欢更简单的语法，就像我原来的问题中的语法一样。

# sql - 如何在 SQL 中将秒数转换为人类可读的持续时间？

> ID：197096
> 
> 赞同：2
> 
> 时间：2008-10-13T09:31:17.923
> 
> 标签：sql, int, duration

在 SQL 数据库中，我进行了一些选择，以秒为单位获得持续时间（作为两个日期之间减法的结果）作为 int。但我想将此结果格式化为人类可读的形式，如“hh:mm”或“dd:hh”。这在 SQL 中是可能的吗？我怎样才能实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T09:47:52.820

在 SQL 2005 中，您可以使用以下内容：

```
 select convert(varchar(8), dateadd(second, [SecondsColumn], 0),  108) 
```

它首先将秒转换为 1900-01-01 之后的日期，然后获取 hh:mm:ss 部分。

如果该列超过 24 小时，这将翻转，如果你想要几天然后几个小时在这种情况下，只需执行以下操作：

```
case when SecondsColumn> (24*60*60) 
        then 
            cast(datepart(day,datediff(dd, 0, dateadd(second, SecondsColumn, 0))) as varchar(4))
        +   'd' + convert(varchar(2), dateadd(second, SecondsColumn, 0), 108) 
    else
            convert(varchar(8), dateadd(second, SecondsColumn, 0), 108) 
    end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T09:52:26.010

每个数据库的做法都不同。我使用 PostgreSQL，它是这样的：

```
select to_char(my_date - my_other_date, 'HH:MM:SS'); 
```

您必须查阅您正在使用的数据库的手册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T09:55:58.310

假设你有几秒钟：

```
DECLARE @DurationSeconds INT

-- 25h 45m 14s
SET @DurationSeconds = (25 * 3600) + (45 * 60) + (14)

SELECT 
  @DurationSeconds, 
  @DurationSeconds / 3600 hours, 
  @DurationSeconds % 3600 / 60 minutes,
  @DurationSeconds % (3600 / 60) seconds 
```

我会把格式化的任务交给你。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T13:08:55.783

尽管许多 DBMS 都有自己的自定义语法，但没有标准。

一般来说，最好在应用程序的表示层而不是数据库附近的任何地方进行格式化以供人类阅读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-07T23:35:03.727

在 Oracle SQL 中：

```
 -- 86,400 seconds in a  day
   --  3,600 seconds in an hour
   --     60 seconds in a  minute
   select duration, -- seconds
    trunc((duration)/86400) || ':' || -- dd
    trunc(mod(duration,86400)/3600) || ':' || -- hh
    trunc(mod(mod(duration,86400),3600)/60) || ':' || -- mm
    mod(mod(mod(duration,86400),3600),60) -- ss
   as human_readable
   from dual
   ; 
```

# oracle - Oracle 10g - UTL_MAIL 包

> ID：197097
> 
> 赞同：4
> 
> 时间：2008-10-13T09:31:37.407
> 
> 标签：oracle, email

我在使用 Oracle 10g 中的 UTL_MAIL 包时遇到了一些问题，想知道是否有人有任何解决方案？

我以 SYSMAN 身份连接到我的数据库并加载以下两个脚本；

**@C:\oracle\product\10.2.0\db_1\rdbms\admin\utlmail.sql**

**@C:\oracle\product\10.2.0\db_1\rdbms\admin\prvtmail.plb**

我设置了 SMTP 服务器；

**ALTER SYSTEM SET smtp_out_server='mymailserver.fake:25' SCOPE=BOTH;**

我授予用户所需的权限；

**GRANT 对 utl_mail TO MYUSER 执行；**

但是，如果我连接到“MYTABLESPACE”（MYUSER 存在的地方），如果我引用 UTL_MAIL.SEND，则会收到以下错误；

**PLS-00201：必须声明标识符“UTL_MAIL.SEND”**

如果我用 SYSMAN 作为前缀（SYSMAN.UTL_MAIL.SEND），它可以工作，但我不想这样做，因为包含此调用的这个过程不知道安装脚本的表空间。

有没有办法安装这些脚本，以便它们可以普遍访问，并且不需要 SYSMAN 前缀来执行？

干杯，

克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T10:24:35.880

我很确定公共同义词将是唯一的区别。

```
SELECT * FROM ALL_SYNONYMS WHERE OWNER = 'PUBLIC' and table_name LIKE 'UTL%' 
```

将确认或否认

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T09:33:11.493

听起来你需要为包创建一个公共同义词..

```
CREATE PUBLIC SYNONYM UTL_MAIL FOR SYSMAN.UTL_MAIL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-13T10:31:45.787

尝试`ALTER SYSTEM SET smtp_out_server='mymailserver.fake:25' SCOPE=BOTH;`以您正在运行该过程的用户身份而不是 sys.

IE。连接`MYTABLESPACE as MYUSER`并运行alter session 希望很清楚

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-09-30T02:36:54.993

以 sys 身份登录并运行脚本

# sql-server - 选择具有 SQL Server XML 列类型的特定行

> ID：197099
> 
> 赞同：2
> 
> 时间：2008-10-13T09:32:20.090
> 
> 标签：sql-server, xml, tsql, select

我正在尝试从类似于以下定义的表中选择数据：

```
Column     |    Data Type
-------------------------
Id         |    Int
DataType   |    Int
LoggedData |    XML 
```

但我只想选择那些具有特定 DataType 值的行，并且在 LoggedData 列中包含一个字符串（或评估一段 XPath）。

快速的谷歌搜索没有任何用处，我有点急于得到答案......我会继续搜索，但如果有人能同时帮助我解决这个问题，我真的欣赏它。

**编辑**_澄清

所以，我所追求的是这样的，但格式正确......

```
select Id, LoggedData from myTable where DataType = 29 and LoggedData.query('RootNode/ns1:ChildNode[@value="searchterm"]'); 
```

可能还是不太清楚...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T03:40:28.443

如果您想按*搜索项*（如 SQL 变量）进行过滤，您可能需要使用以下内容：

```
Select Id, LoggedData From myTable Where DataType = 29 And 
LoggedData.exist('RootNode/ns1:ChildNode[@value=sql:variable("@searchterm")]')=1 
```

其中@searchterm 是您的SQL 变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T09:34:17.543

这不是对你有用吗？

```
SELECT
  Id, 
  LoggedData 
FROM
  myTable 
WHERE
  DataType = 29 
  AND LoggedData.exist('RootNode/ns1:ChildNode[@value="searchterm"]') = 1 
```

# sql - Fastest "Get Duplicates" SQL script

> ID：197111
> 
> 赞同：43
> 
> 时间：2008-10-13T09:36:18.333
> 
> 标签：sql, scripting, duplicates, performance

What is an example of a fast SQL to get duplicates in datasets with hundreds of thousands of records. I typically use something like:

```
SELECT afield1, afield2 FROM afile a 
WHERE 1 < (SELECT count(afield1) FROM afile b WHERE a.afield1 = b.afield1); 
```

But this is quite slow.

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-13T09:38:27.877

This is the more direct way:

```
select afield1,count(afield1) from atable 
group by afield1 having count(afield1) > 1 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-13T09:39:11.777

You could try:

```
select afield1, afield2 from afile a
where afield1 in
( select afield1
  from afile
  group by afield1
  having count(*) > 1
); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T12:50:35.667

A similar question was asked last week. There are some good answers there.

[SQL to find duplicate entries (within a group)](https://stackoverflow.com/questions/182544/sql-to-find-duplicate-entries-within-a-group)

In that question, the OP was interested in all the columns (fields) in the table (file), but rows belonged in the same group if they had the same key value (afield1).

There are three kinds of answers:

subqueries in the where clause, like some of the other answers in here.

an inner join between the table and the groups viewed as a table (my answer)

and analytic queries (something that's new to me).

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-01-20T21:57:05.180

By the way, if anyone wants to remove the duplicates, I have used this:

```
delete from MyTable where MyTableID in (
  select max(MyTableID)
  from MyTable
  group by Thing1, Thing2, Thing3
  having count(*) > 1
) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-21T05:39:16.453

This should be reasonably fast (even faster if the dupeFields are indexed).

```
SELECT DISTINCT a.id, a.dupeField1, a.dupeField2
FROM TableX a
JOIN TableX b
ON a.dupeField1 = b.dupeField2
AND a.dupeField2 = b.dupeField2
AND a.id != b.id 
```

I guess the only downside to this query is that because you're not doing a `COUNT(*)` you can't check for the *number of times* it is duplicated, only that it appears more than once.

# php - PHP静态变量未按预期工作

> ID：197112
> 
> 赞同：0
> 
> 时间：2008-10-13T09:36:19.927
> 
> 标签：php, javascript

这个[例子](http://my.php.net/static)来自 php.net：

```
<?php
function Test()
{
    static $a = 0;
    echo $a;
    $a++;
}
?> 
```

这是我的代码：

```
function getNextQuestionID()
{
    static $idx = 0;
    return $idx++;
} 
```

我在 JavaScript 中使用它：

```
'quizID=' + "<?php echo getNextQuestionID(); ?>" 
```

每次返回 0。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T09:42:13.470

我相信您误解了静态变量的作用。试试这段代码，你可能会更好地理解：

```
echo getNextQuestionID() . ", " getNextQuestionID() . ", " getNextQuestionID(); 
```

你会明白我的意思。

静态变量的生命周期与脚本一样长。

它在第一次运行时返回 0 而不是 1 的原因是因为您使用的是后缀运算符 $var++ 而不是前缀版本 - ++$var。不同之处在于，只有在函数返回后使用后缀运算符时才会应用增量 - 但如果使用前缀运算符，它会在函数返回之前应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T10:18:25.910

如果您希望数据在多个页面中持久存在，则需要使用[会话](http://www.php.net/session)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T13:37:00.453

```
session_start();
function getNextQuestionID()
{
    if (!isset($_SESSION['qNo'])) {
        $_SESSION['qNo'] = 0;
    } else {
        $_SESSION['qNo']++;
    }

    return $_SESSION['qNo'];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-18T14:24:41.700

```
function getNextQuestionID()
{
    if (!isset($idx)) {
        static $idx = 0; // OR -1, if you want to start with 0 (ZERO);
    }
    $idx++;
    return $idx;
}

echo getNextQuestionID().'<br />';
echo getNextQuestionID().'<br />';
echo getNextQuestionID().'<br />';
echo getNextQuestionID().'<br />'; 
```

返回 1,2,3,4

“静态”意味着，只要您的脚本正在运行，变量的值就会保持（一个网站调用！要在多个网站调用中保持它，您需要 SESSIONS）。如果函数被多次调用，则该值将被保留并且不会一直重新初始化，因此是可递增的。

# c++ - 如何编写一个迭代 CAtlMap 的 for 循环，有选择地删除元素？

> ID：197121
> 
> 赞同：0
> 
> 时间：2008-10-13T09:40:54.083
> 
> 标签：c++, atl

我正在尝试在没有太多特殊情况代码的情况下执行以下操作来处理无效的 POSITION 等：

填空的最佳方法是什么？

```
void DeleteUnreferencedRecords(CAtlMap<Record>& records)
{
   for(____;____;____)
   {
      if( NotReferencedElsewhere(record) )
      {
        // Delete record
        _______;
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:31:21.483

根据这个：

[http://msdn.microsoft.com/en-us/library/0h4c3zkw(VS.80).aspx](http://msdn.microsoft.com/en-us/library/0h4c3zkw(VS.80).aspx)

RemoveAtPos 具有这些语义

> 删除存储在指定位置的键/值对。用于存储元素的内存被释放。pos 引用的 POSITION 变得无效，虽然 map 中任何其他元素的 POSITION 仍然有效，但它们不一定保持相同的顺序。

问题是顺序可以改变——这意味着 GetNext() 不会真正继续迭代。看起来您需要一次收集要删除的 POSITION，然后在下一次删除它们。删除一个 POSITION 不会使其他 POSITION 对象无效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T10:35:04.597

我的第一个想法是在调用之前保存当前位置`GetNext`，然后，如果你删除元素，你可以重置它。但是，也许最安全的方法是创建一个包含您要保留的元素的新地图，否则您可能依赖于 POSITION 的内部实现如何工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T15:47:33.827

我不太熟悉`CAtlMap`，但如果它类似于 STL 的`map`类型，那么[Rob 的“第一个想法”](https://stackoverflow.com/questions/197121/how-do-i-write-a-for-loop-that-iterates-over-a-catlmap-selectively-deleting-ele#197209)是安全的——删除一个项目不会影响任何迭代器，除了指向被删除项目的迭代器。

# wpf - 如何开发支持数据绑定的 WPF 数据网格控件？

> ID：197122
> 
> 赞同：3
> 
> 时间：2008-10-13T09:40:54.363
> 
> 标签：wpf, data-binding

我对 WPF 相当陌生。我想开发一个支持数据绑定的数据网格控件。

有很多关于数据绑定到现有控件的信息，但我找不到任何信息如何从头开始开发支持数据绑定的控件。

我不希望这个问题有一个简单的答案，让我开始的链接会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T09:47:00.420

您是否打算构建一个 DatGrid 控件？这里有一个[http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14963](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14963)

绑定是WPF的重要特性之一，Dependancyproperty实际上赋予了控件绑定和监听数据变化事件的能力（Data Binding）。当你开发你的控件时，你不需要做任何特别的事情来使 DataBinding 工作，只需要为控件定义适当的 Dependency 属性，

您可以在此处阅读有关 DataBinding 的更多信息**[http://msdn.microsoft.com/en-us/library/ms752347.aspx](http://msdn.microsoft.com/en-us/library/ms752347.aspx)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T02:05:13.253

以下学习路径将让您踏上坚实的道路

1.  了解依赖属性
2.  编写一个简单的堆栈面板控件 - 熟悉**Arrange**和**Measure**覆盖
3.  使用 DP**`AffectsArrange`**设置方向
4.  编写一个 SimpleListBox 控件 - 绑定到一个标量列表（比如`List<string>`）
5.  更新 SimpleListBox 控件以支持`INotifyCollectionChanged`
6.  更新 SimpleListBox 控件以支持绑定到列表的属性（比如`FirstName`on `List<Person>`）
7.  IWeakEventListener
8.  您可能想要支持绑定到`DataTable`s，因此添加对 IListSource、ITypedList、IBindingListView 和 IBindingList 的支持
9.  为了获得良好的响应能力，您可能需要实现自己的虚拟化面板
10.  添加对模板的支持

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T13:25:53.910

微软几天前发布了一个 DataGrid 作为 WPF 工具包的一部分：

[请参阅 2008 年 10 月在 codeplex 上的 WPF 工具包](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=15598)

您可以使用数据绑定和验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T11:26:20.080

感谢你的回答。

是的，当我说“网格”时，我的意思是“数据网格”。我编辑了问题以使其更清楚。

MSDN 上的文章主要介绍了如何使用数据绑定，如果要开发支持数据绑定的 WPF 控件需要做什么，并没有过多说明。

# eclipse - 在 Eclipse 中重命名访问器/修改器方法？

> ID：197123
> 
> 赞同：10
> 
> 时间：2008-10-13T09:41:11.850
> 
> 标签：eclipse, refactoring, eclipse-3.4

当他们获取/设置的变量被重构->重命名（Eclipse 3.4）时，有什么方法可以自动重命名访问器/修改器？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-13T10:20:23.877

1 - 当您在变量上选择 Refactor->Rename 时，Eclipse 会提示您在“内联”框中输入新名称。在它的正下方，有一条帮助消息，旁边有一个小图标（向下的箭头）。单击该箭头，然后选择“打开重命名对话框”。将出现一个新的弹出窗口，其中包含您需要的复选框。

2 - 或者，选择要更改的变量并按***两次***Alt+Shift+R。再次检查 getter/setter 复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-12T11:32:34.743

默认情况下，当使用“内联”重命名变量时，eclipse 不会重命名 getter 和 setter。但是，您可以通过使用“重命名字段”对话框重命名一次，然后选择“重命名 getter”和“重命名设置器”来更改此行为。（有关如何打开此窗口的详细信息，请参见[idrosid 的答案）。](https://stackoverflow.com/a/197188/137369)

在此之后，“内联”重命名还将更新该字段的 getter 和 setter（但不是 setter 中的参数）。

注意，我已经用 Eclipse 4.5 测试过了

# asp.net - 在 SQL Reporting Services 2005 中导出到 Excel 时数据中断

> ID：197124
> 
> 赞同：0
> 
> 时间：2008-10-13T09:41:44.737
> 
> 标签：asp.net, sql-server, reporting-services

我有可以容纳在文本框中的大量行数据。

当我导出到 excel 时，会发生数据包装并且数据被切断。

当我手动更改文本框高度时，我可以看到完整的数据，但我需要第一次显示完整的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T13:54:40.603

在报表布局中，将Textbox的**CanGrow属性设置为****True**。

# .net - .NET 中的免费错误跟踪器

> ID：197125
> 
> 赞同：22
> 
> 时间：2008-10-13T09:42:01.163
> 
> 标签：.net, bug-tracking

有没有免费的基于 .NET 的好的错误跟踪器？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-13T09:46:38.267

我知道的两个错误跟踪器：

*   [错误跟踪器.NET](http://www.ifdefined.com/bugtrackernet.html)

> BugTracker.NET 是一个免费的、开源的、基于 Web 的错误跟踪器或客户支持问题跟踪器，使用 ASP.NET、C# 和 Microsoft SQL Server（或其免费表亲 SQL Server Express）编写。

*   [虫网](http://www.bugnetproject.com/)

> BugNET 是使用 ASP.NET Web 应用程序框架构建的问题跟踪和项目问题管理解决方案。电子邮件通知、报告和每个项目的字段和值配置允许有效管理任何规模项目的错误、功能请求和其他问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T22:33:22.873

[Countersoft](http://countersoft.com/)为其产品[Gemini](http://countersoft.com/)提供最多 5 位用户的免费许可证。我认为他们也有开源项目的免费许可证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T09:53:18.317

ASP.Net 问题跟踪器是一个简单的替代方案。
您可以从[http://www.asp.net/downloads/archived/starter-kits/issue-tracker/下载它](http://www.asp.net/downloads/archived/starter-kits/issue-tracker/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T22:27:26.227

如果您只是一名开发人员，一些商业的将让您免费使用它们。[Axosoft](http://www.axosoft.com)将为您提供其 OnTime 软件的免费单用户许可证。（虽然我个人觉得这有点过头了。）[SourceGear 的 Fortress](http://www.sourcegear.com/fortress/)问题跟踪软件对单用户也是[免费的](http://www.sourcegear.com/faq.html#singleuser)。

# c# - 防止异常消息被翻译成用户的语言？

> ID：197127
> 
> 赞同：34
> 
> 时间：2008-10-13T09:43:13.967
> 
> 标签：c#, .net, exception, globalization

如何让我的应用程序在显示 win32/.net 异常消息时始终使用英文？

我收到了这条消息，看起来有人用 babelfish 来翻译它（它是瑞典语）：“System.ComponentModel.Win32Exception: Programmet kunde inte starta eftersom programts sida-vid-sidakonfiguration är felaktig。”

非常无用，谷歌获得了高达 4 次点击，但都没有帮助。所以我必须猜测原始消息是什么，然后用谷歌搜索。（它是：“应用程序无法启动，因为它的并排配置不正确。”）

这次很容易找出最初的错误消息是什么，从一开始就用英文显示消息当然可以节省我的时间。

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-13T09:50:22.113

您可以尝试设置和`Thread.CurrentThread.CurrentUICulture`/或.`.CurrentCulture``CultureInfo("en-US")`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T08:15:58.797

更多的理由是为什么不应该（糟糕地）翻译异常。记录异常时，使用单一语言更有意义。我不敢相信微软没有想到除了 UICulture 之外的其他方法，这基本上是一个不可选项:(

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T11:06:19.883

如果是 ASP.NET 应用程序，您可以在 web.config (*) 中设置 UI 语言：

```
<system.web>
    <globalization ... uiCulture="en-US" ... />
</system.web> 
```

对于其他应用程序，默认使用当前用户的区域设置，您必须明确覆盖它 - 例如 Thread.CurrentUICulture = new CultureInfo("en-US")。

(*) 警告 - 如果配置文件中的错误导致在处理元素之前引发异常，您将获得默认的 uiCulture。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T11:50:15.380

强制异常以不同的语言显示对用户来说似乎有点苛刻......你能在消息中显示错误代码吗？然后用户会得到他们能理解的东西，你可以查找翻译版本的错误代码。

我不是.net 人，所以我不知道这是否可能，只是一个想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T12:39:15.220

> 如何让我的应用程序在显示 win32/.net 异常消息时始终使用英文？

首先，*不要向用户显示 win32/.net 异常消息*。您应该处理异常而不是向用户显示它们。

默认情况下，异常消息将以当前的 UI 语言显示（如果安装了适当的语言包，否则它们会回退到英语）。您可以通过更改[Thread.CurrentThread.CurrentUICulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture.aspx)属性更改异常消息，但它会影响您应用程序的整个 GUI。

# asp.net - 如何保持会话干净？

> ID：197132
> 
> 赞同：1
> 
> 时间：2008-10-13T09:45:54.383
> 
> 标签：asp.net, session

这是关于 Session 用于存储一些临时数据的情况 - 一个示例是在多步骤注册过程中输入的信息。

如果一个网站有许多这样的部分 - 它希望将会话用作该部分中页面的临时数据存储，那么当不再需要数据时清理会话的好方法是什么，考虑到用户可能只是简单地离开该部分，因此页面本身不能用于清理。

[编辑] 就我而言，主要驱动力是减少网络流量，因为会话存储在 proc 之外，但同样的问题通常适用于内存绑定应用程序和性能。Session 中的意外数据也很容易导致难以跟踪的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T10:06:59.007

时间应该保持会议清洁。会话*应该*过期，这样做会删除所有数据。这是默认行为。

我同意在会话中存储太多数据对于服务器资源来说不是一件好事，但正如您所知，它有时是必要的邪恶。如果您真的很烦恼，请考虑将您的会话转移到 SQL Server。它会增加一点延迟，但您将能够处理更多的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T10:00:40.487

如果要存储批量数据，您有以下选择：

1.  缓存
2.  数据库

不建议在会话中存储大量数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T10:55:26.070

为什么不将所有内容都存储在数据库中？那只是更清洁。

为什么？好吧，大多数现代 Web 应用程序在每次浏览量中都会访问数据库十几次，因此一些额外的简单查询不会显着影响性能。

话虽如此，在会话中存储大量用户生成的数据并没有错，尤其是在您使用基于文件的会话时。

为什么？一个人可以在注册表中输入多少文本，真的吗？任何小于 4000 字节的内容都将占用相同数量的空间：一个操作系统页面！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T11:18:42.060

您可以设计一个多步骤的注册过程，而无需使用会话存储或使用数据库来存储临时数据。您可以设计一个包含多个面板的 .aspx 页面，一次显示一个面板。当用户完成最后一个面板时，您仍然可以访问所有之前填写的控件。

# c++ - 当用户尝试发送短信时收到通知

> ID：197135
> 
> 赞同：0
> 
> 时间：2008-10-13T09:46:57.033
> 
> 标签：c++, windows-mobile, embedded

我的应用程序作为服务实现（在 services.exe 下运行）。我正在添加一项新功能，该功能需要在用户发送 SMS 时得到通知。

我曾尝试使用`IMAPIAdviseSink`、 注册`IMAPISession`和`IMsgStore`，但我没有收到任何通知。

我可以看到的其他选项是创建一个短消息服务提供者或实现`IFormProviderEx`接口，但我不确定这可能对 SMS 功能和用户体验产生什么影响。

有什么方法可以让我的应用程序可靠地获取在发件箱中创建的 SMS 通知？

编辑：该应用程序是用本机 C++ 编写的。我研究了 RIL 和其他几个 API，但我只能找到有关收到传入 SMS 通知的信息。

好的，更多信息：`IMAPIAdviseSink`在独立应用程序中注册我的作品的相同代码。它只是无法在服务中获得通知。

反正有没有在我的服务中获得通知？还是我需要一个单独的流程来监控 SMS 事件并通知我的服务？

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T08:39:28.010

您不能`IMAPIAdviseSink`从服务中使用。

您需要从单独的进程中使用它，并将您感兴趣的事件通知服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T13:04:59.880

编辑：哎呀，错过了创建消息的用户，而不是传入的消息。

您的目标是 windows mobile 5+ 吗？

我认为您正在寻找的是 Microsoft.WindowsMo​​bile.PocketOutlook.MessageInterception 命名空间中的 MessageInterceptor 类。

这是一些示例代码的链接： [http ://www.knowdotnet.com/articles/smartphonesms.html](http://www.knowdotnet.com/articles/smartphonesms.html)

Peter Foot 在 His In the Hand 库中包含了类似的功能，它们可能允许您在早期版本的袖珍电脑上执行相同的操作。

# c++ - VS2005 的 STL 最佳实现是什么？

> ID：197140
> 
> 赞同：3
> 
> 时间：2008-10-13T09:50:13.283
> 
> 标签：c++, visual-studio-2005, stl

我目前正在为 VS2005 使用 STL 的默认实现，但我对它并[不满意](https://stackoverflow.com/questions/186494/ifstr1str2-versus-ifstr1lengthstr2length-str1str2)。也许有更好的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T10:58:30.057

Dinkumware STL 实现（随 VS2005 提供）实际上相当不错。STL 是一个通用库，因此几乎总是可以为非常具体的用例编写更好的东西。

我知道以下替代实现，但我从未将它们与 VS2005 一起使用：

SGI 标准模板库 3.3： [http ://www.sgi.com/tech/stl/](http://www.sgi.com/tech/stl/)

STLport 5.1.6（源自 SGI 实现）： http: [//www.stlport.org/](http://www.stlport.org/)

SGI 和 STLport 都将大小/长度检查作为 operator== 中的第一个测试来实现，因此您可能会喜欢它。它们也都可以免费下载和使用。

理论上，从一种 STL 实现更改为另一种实现应该很容易。但是，我从一些同事那里听说并非总是如此。他们遇到了编译器错误，发现他们无意中使用了非标准功能，或者在不知不觉中依赖于特定于特定 STL 实现的某些行为。

关于 Dinkumware STL 实现的一件好事是它已经通过 VS2005 C++ 编译器进行了很好的测试。

如果您决定尝试这些替代方案，祝您好运！让我们知道进展如何。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T10:28:52.113

STLPort 怎么样？

[http://www.stlport.org/](http://www.stlport.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T10:52:15.140

[Dinkumware](http://www.dinkumware.com/)据说是 C++ 标准库最符合标准的实现之一。您可以花 200 美元获得 VS2005的[二进制许可证。](http://www.dinkumware.com/BinaryEdition.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T13:22:38.627

还有[Apache STL](http://stdcxx.apache.org/)，但正如其他人所指出的，我相信 Dinkumware 是您最好的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T19:33:30.123

根据您的限制，您可能会发现 Electronic Arts 的 STL 实现很有趣：[EASTL](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html)

# unix - 跳过文件行直到找到匹配项，然后输出其余行

> ID：197150
> 
> 赞同：16
> 
> 时间：2008-10-13T09:55:58.030
> 
> 标签：unix, text-processing

我可以编写一个简单的脚本来执行此操作，但在我不断寻求更熟悉 unix 的过程中，我想学习使用内置命令的有效方法。

我需要处理具有可变数量的标题行的非常大的文件。最后一个标题行由文本“LastHeaderLine”组成。我希望在此行之后输出所有内容。（我不担心误报匹配。）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-13T10:19:30.667

类似于[Avi](https://stackoverflow.com/questions/197150/skip-file-lines-until-a-match-is-found-then-output-the-rest#197169)的答案，但不包括带有“LastHeaderLine”的行。

```
sed -e '1,/LastHeaderLine/d' 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-13T10:12:37.607

为什么不为此尝试 awk 呢？它看起来像这样：

```
awk 'NR == 1, /LastHeaderLine/ { next } { print }' myinputfile > myoutputfile 
```

其中**NR == 1**对于第一行是正确的，**/LastHeaderLine/**匹配您的最后一个标题行。逗号运算符让以下函数**{ next }**为两个正则表达式范围内的所有句子触发。在这种情况下，它将跳到下一行输入，无需进一步操作。对于所有其他输入行，它会将这些行打印到标准输出，您可以使用 > 重定向。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T10:09:47.377

使用 sed：

```
sed -ne '/LastHeaderLine/,$p' <inputfile 
```

将匹配从正则表达式匹配到文件末尾的所有内容。'p' 打印匹配的行。

编辑：

再三考虑，您不想打印匹配 LastHeaderLine 的行。sed 很难做到这一点。在 perl 中，您可以执行以下操作：

```
perl -ne 'if ($flag) {print;} if (/LastHeaderFile/) {$flag=1;}' <inputfile 
```

这将仅打印严格遵循正则表达式匹配的行。

# java - 找不到时的异常

> ID：197155
> 
> 赞同：2
> 
> 时间：2008-10-13T09:57:17.497
> 
> 标签：java, exception, jpa

当找不到某些东西时，在 JPA 中抛出异常的理由是什么？
*补充：* 此行为在 EJB2 中可见，并且已从 EJB3 中删除 - 但是...在调用抛出 NoResultException 的[Query#getSingleResult()](http://java.sun.com/javaee/5/docs/api/javax/persistence/Query.html#getSingleResult())时仍然存在。

通常我不认为找不到某些东西是一个例外。实际上，在某些情况下，这可能是我的默认情况，并且在大多数其他情况下至少是预期的情况。这让我想起了一句老话，您不应该将异常用作业务逻辑的一部分，而只能将异常用作您不知道或不想处理的特殊情况。

有谁知道为什么它在 JPA 中以这种方式实现？找不到东西时返回 null 有什么缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T10:03:03.820

你在调用 getReference(class, primaryKey) 吗？如果主键不存在，则会抛出异常；如果您希望返回 null 对象，请改用 find(class, primaryKey)。getReference() 允许延迟加载，而 find() 则不允许，但这样做的副作用是，要允许延迟加载，您需要引用一个真实的对象，这意味着您必须传递一个有效的 PK。

# javascript - 你如何优化你的Javascript？

> ID：197160
> 
> 赞同：6
> 
> 时间：2008-10-13T10:00:54.027
> 
> 标签：javascript, performance

嗯...简单的问题，对吧？但是没有这么简单的答案。在 firefox 中，我使用 firebug 控制台（配置文件）但是......在其他浏览器中该怎么办？像 Internet Explorer / Opera / Safari（在 Windows 上）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T10:31:17.960

随着时间的推移，这个特殊问题会自行解决。;-)

Internet Explorer 的第 8 版（目前为 beta 2）附带一个内置的 JavaScript 分析器。下一个 Safari 版本可能还会包含一个，因为它的渲染引擎 WebKit 现在有一个作为其[Web Inspector](http://webkit.org/blog/148/web-inspector-update/)的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T10:06:51.953

您可以使用 JavaScript 优化器

*   [http://js-optimizer.sourceforge.net/](http://js-optimizer.sourceforge.net/)
*   [http://www.xtreeme.com/javascript-optimizer/](http://www.xtreeme.com/javascript-optimizer/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T12:09:46.917

此页面包含一些建议：

[http://www.newearthonline.co.uk/index.php?page=article&article=338&pagenum=2](http://www.newearthonline.co.uk/index.php?page=article&article=338&pagenum=2)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T12:42:06.713

Yahoo 提供了一个[Javascript profiler](http://developer.yahoo.com/yui/profiler/)，你可能想看看那个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T10:11:18.093

这可能不是一个简单的问题。但是在使用或使用 javascript 时必须牢记某些事情。没有硬性规定，但我可以想到一些我以前做过的事情。避免循环引用 javascript对象。这对于避免内存泄漏尤为重要。另一件重要的事情是当对象不再被引用时进行垃圾收集。你可以谷歌优化一些有效的方法！！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T10:57:10.870

试用 Firebug Lite。我不确定它是否会完全解决您的目的。

[http://getfirebug.com/lite.html](http://getfirebug.com/lite.html)

# windows - NTFS 性能和大量文件和目录

> ID：197162
> 
> 赞同：196
> 
> 时间：2008-10-13T10:01:43.493
> 
> 标签：windows, performance, filesystems, ntfs

带有 NTFS 的 Windows 如何处理大量文件和目录？

在遇到性能问题或其他问题之前，是否有关于可以放置在单个目录中的文件或目录限制的任何指导？

例如，有一个包含 100,000 个文件夹的文件夹是否可行？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2008-11-14T20:27:10.173

这里有一些来自环境中的人的一些建议，我们有包含数千万个文件的文件夹。

1.  文件夹将索引信息（指向子文件和子文件夹的链接）存储在索引文件中。当你有很多孩子时，这个文件会变得非常大。请注意，它不区分作为文件夹的子对象和作为文件的子对象。唯一的区别实际上是该孩子的内容是孩子的文件夹索引或孩子的文件数据。注意：我在某种程度上简化了这一点，但这说明了重点。
2.  索引文件将变得碎片化。当它变得过于碎片化时，您将无法将文件添加到该文件夹​​。这是因为允许的片段数有限制。这是设计使然。我已在支持事件电话中与 Microsoft 确认了这一点。因此，尽管理论上一个文件夹中可以拥有的文件数量限制为数十亿，但当您开始处理数千万个文件时，祝您好运，因为您将首先达到碎片限制。
3.  然而，这并不全是坏事。您可以使用工具：[contig.exe](http://technet.microsoft.com/en-us/sysinternals/bb897428)对该索引进行碎片整理。它不会减少索引的大小（对于数千万个文件，它可以达到几个 Gig），但您可以减少片段的数量。注意：磁盘碎片整理工具不会对文件夹的索引进行碎片整理。它将对文件数据进行碎片整理。只有 contig.exe 工具会对索引进行碎片整理。仅供参考：您还可以使用它对单个文件的数据进行碎片整理。
4.  如果您进行碎片整理，请不要等到达到最大片段限制。我有一个文件夹无法进行碎片整理，因为我等到为时已晚。我的下一个测试是尝试将该文件夹中的一些文件移到另一个文件夹中，看看我是否可以对其进行碎片整理。如果这失败了，那么我要做的是 1）创建一个新文件夹。2）将一批文件移动到新文件夹。3）对新文件夹进行碎片整理。重复 #2 和 #3 直到完成，然后 4) 删除旧文件夹并重命名新文件夹以匹配旧文件夹。

更直接地回答您的问题：如果您正在查看 100K 条目，请不要担心。去把自己打晕。如果您正在查看数以千万计的条目，那么：

a) 制定计划将它们细分为子文件夹（例如，假设您有 100M 个文件。最好将它们存储在 1000 个文件夹中，这样每个文件夹只有 100,000 个文件，而不是将它们存储在 1 个大文件夹中。这将创建 1000 个文件夹索引，而不是一个更有可能达到最大片段数限制的大索引或

b) 制定计划定期运行 contig.exe 以保持大文件夹的索引碎片整理。

**仅当您感到无聊时阅读以下内容。**

实际限制不是片段的数量，而是存储指向片段的指针的数据段的记录数。

所以你所拥有的是一个数据段，它存储指向目录数据片段的指针。目录数据存储有关该目录应该存储的子目录和子文件的信息。实际上，目录不会“存储”任何东西。由于存储介质本身是线性的，因此它只是一种跟踪和呈现功能，向用户呈现层次结构的错觉。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-03-25T20:51:07.293

短文件名的创建也存在性能问题，这会减慢速度。如果文件夹中的文件超过 300k，Microsoft 建议关闭短文件名创建 [1]。前 6 个字符的唯一性越少，问题就越大。

[1] [NTFS 工作原理](http://technet.microsoft.com/en-us/library/cc781134.aspx)来自[http://technet.microsoft.com](http://technet.microsoft.com)，搜索“300,000”

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2014-10-05T18:19:15.867

我正在构建一个文件结构来托管多达 20 亿 (2^32) 个文件并执行以下测试，这些测试显示在固态驱动器上每个 NTFS 目录大约 250 个文件或 120 个目录时，导航 + 读取性能急剧下降（固态硬盘）：

*   文件性能在 250 到 1000 个文件之间下降 50%。
*   目录性能在 120 到 1000 个目录之间下降 60%。
*   Numbers > 1000 的值保持相对稳定

有趣的是，目录和文件的数量并没有显着干扰。

所以教训是：

*   超过 250 的文件号的成本是 2 倍
*   超过 120 个目录的成本是 2.5 倍
*   Windows 7 中的文件资源管理器可以处理大的#Files 或#Dirs，但可用性仍然很差。
*   引入子目录并不昂贵

这是数据（每个文件和目录的 2 个测量值）：

```
(FOPS = File Operations per Second)
(DOPS = Directory Operations per Second)

#Files  lg(#)   FOPS    FOPS2   DOPS    DOPS2
   10   1.00    16692   16692   16421   16312
  100   2.00    16425   15943   15738   16031
  120   2.08    15716   16024   15878   16122
  130   2.11    15883   16124   14328   14347
  160   2.20    15978   16184   11325   11128
  200   2.30    16364   16052   9866    9678
  210   2.32    16143   15977   9348    9547
  220   2.34    16290   15909   9094    9038
  230   2.36    16048   15930   9010    9094
  240   2.38    15096   15725   8654    9143
  250   2.40    15453   15548   8872    8472
  260   2.41    14454   15053   8577    8720
  300   2.48    12565   13245   8368    8361
  400   2.60    11159   11462   7671    7574
  500   2.70    10536   10560   7149    7331
 1000   3.00    9092    9509    6569    6693
 2000   3.30    8797    8810    6375    6292
10000   4.00    8084    8228    6210    6194
20000   4.30    8049    8343    5536    6100
50000   4.70    7468    7607    5364    5365 
```

这是测试代码：

```
[TestCase(50000, false, Result = 50000)]
[TestCase(50000, true, Result = 50000)]
public static int TestDirPerformance(int numFilesInDir, bool testDirs) {
    var files = new List<string>();
    var dir = Path.GetTempPath() + "\\Sub\\" + Guid.NewGuid() + "\\";
    Directory.CreateDirectory(dir);
    Console.WriteLine("prepare...");
    const string FILE_NAME = "\\file.txt";
    for (int i = 0; i < numFilesInDir; i++) {
        string filename = dir + Guid.NewGuid();
        if (testDirs) {
            var dirName = filename + "D";
            Directory.CreateDirectory(dirName);
            using (File.Create(dirName + FILE_NAME)) { }
        } else {
            using (File.Create(filename)) { }
        }
        files.Add(filename);
    }
    //Adding 1000 Directories didn't change File Performance
    /*for (int i = 0; i < 1000; i++) {
        string filename = dir + Guid.NewGuid();
        Directory.CreateDirectory(filename + "D");
    }*/
    Console.WriteLine("measure...");
    var r = new Random();
    var sw = new Stopwatch();
    sw.Start();
    int len = 0;
    int count = 0;
    while (sw.ElapsedMilliseconds < 5000) {
        string filename = files[r.Next(files.Count)];
        string text = File.ReadAllText(testDirs ? filename + "D" + FILE_NAME : filename);
        len += text.Length;
        count++;
    }
    Console.WriteLine("{0} File Ops/sec ", count / 5);
    return numFilesInDir; 
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-13T10:14:24.297

10万应该没问题。

我（轶事）看到人们遇到数百万个文件的问题，我自己也遇到过资源管理器的问题，只是不知道如何计算过去 60 到千个文件，但 NTFS 应该适合您所说的卷。

如果您想知道，技术（我希望是*理论上*的）最大文件数是：4,294,967,295

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-13T11:57:11.140

对于本地访问，大量目录/文件似乎不是问题。但是，如果您通过网络访问它，几百次之后性能就会明显下降（尤其是从 Vista 机器访问时（XP 到 Windows Server w/NTFS 在这方面似乎运行得更快））。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T14:56:05.583

当您创建一个包含 N 个条目的文件夹时，您会在文件系统级别创建一个包含 N 个项目的列表。此列表是系统范围的共享数据结构。如果您随后开始通过添加/删除条目来不断地修改此列表，我预计至少会有一些共享数据的锁争用。这种争论 - 从*理论上讲*- 会对性能产生负面影响。

对于只读场景，我无法想象具有大量条目的目录性能下降的任何原因。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-14T16:12:06.437

在复制一个在线库时，我在一个目录中的 NTFS 上拥有大约 100 000 个文件（每个文件数 MB）的真实经验。

使用 Explorer 或 7-zip 打开目录大约需要 15 分钟。

一段时间后，编写站点副本`winhttrack`总是会卡住。它还处理目录，包含大约 1 000 000 个文件。我认为最糟糕的是 MFT 只能通过顺序遍历。

在 ext3 上的 ext2fsd 下打开相同的时间几乎相同。可能迁移到 reiserfs（不是 reiser4fs）会有所帮助。

尽量避免这种情况可能是最好的。

对于您自己的程序，使用不带任何 fs 的 blob 可能是有益的。这就是 Facebook 存储照片的方式。

# ruby-on-rails - 如何使用 rSpec 测试 Rails 块助手

> ID：197164
> 
> 赞同：3
> 
> 时间：2008-10-13T10:05:10.617
> 
> 标签：ruby-on-rails, rspec, helper

在我看来，我使用了一个将任意 HTML 作为块的助手：

```
<% some_block_helper do %>
  Some arbitrary HTML and ERB variables here.
  More HTML here.
<% end %> 
```

我的助手在将传递的 HTML 块渲染回视图（Markdown 和其他格式）之前对它做了很多事情。我想知道在 rSpec 中测试助手调用结果的最干净的方法是什么，如果有的话。我发现了一些与 ERB 的私有方法有关的示例，但这似乎有点脆弱且难以阅读。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T04:43:15.260

补充一点詹姆斯所说的话，我认为这样的事情应该可以正常工作：

```
describe SomeHelper do
  it 'should do something' do
    helper.some_block_helper { the_block_code }.should XXXX
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T23:19:01.933

1.  对于功能测试，编写普通[视图规范](http://rspec.info/documentation/rails/writing/views.html)并测试结果。
2.  [要对您的助手](http://rspec.info/documentation/rails/writing/helpers.html)进行单元测试，请直接将任意 html 输入字符串传递给它。

如果还有其他我遗漏的困难，请发表评论？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-30T08:18:34.827

这是扩展卡梅伦答案的另一个例子

```
describe SomeHelper do
  it 'should do something' do
    content = lambda { "blah" }                                
    result  = helper.some_block_helper(&content)

    result.should include("blah")
    result.should XXX
  end
end 
```

# keyboard-shortcuts - VMWare ctrl-z 键绑定，如何删除

> ID：197170
> 
> 赞同：11
> 
> 时间：2008-10-13T10:10:30.997
> 
> 标签：keyboard-shortcuts, vmware-server

当我从我的主机`Alt`+`Tab`到我的虚拟机时，虚拟机在我单击它之前不会获得键盘输入。这给我带来了一个问题，因为看起来 VM 可以控制输入（因为光标正在闪烁）。如果在这种状态下，VMWare 服务器拥有焦点而不是其中的应用程序，如果您执行`ctrl`+ `Z`（通常用于撤消）它会**挂起**VM。

这让我很生气。我查看了 VMWare Server 中的所有选项和首选项，但无论如何都找不到禁用它。

有人知道如何禁用此功能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T10:35:46.763

这不会从 VmWare 中删除键绑定，但您可以在 VmWare 首选项中将选项设置为“在按键时抓取键盘和鼠标输入”。VmWare 帮助明确指出这将禁用系统加速键序列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T10:20:18.480

您可以使用资源编辑器`vmware.exe`来删除`Ctrl`+的键绑定`Z`。显然不适合胆小的人。

# visual-studio - 如何将 Visual Studio 设置为默认的事后调试器？

> ID：197171
> 
> 赞同：15
> 
> 时间：2008-10-13T10:11:00.433
> 
> 标签：visual-studio

不久前，我遇到了一个问题，需要我[将 WinDbg.exe 设置为默认的事后调试器](https://stackoverflow.com/questions/186237/program-only-crashes-as-release-build-how-to-debug)。既然我已经解决了这个问题并重新开始正常工作，如果我可以将 VS 设置为我的默认事后调试器，那就太好了。如何做到这一点？

另外，如何使 VS 附加到已经存在的会话？也就是说，我在一个窗口中打开了我的 VS 项目，并打开了一个命令行，我从中启动我的程序。如果程序崩溃，我如何让 VS 确定将调试器附加到已打开项目中的活动行？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-13T14:45:11.753

您可以从 Visual Studio 中重新启用 Visual Studio 以进行即时调试：

转到**工具 | 选项**| **调试 | 即时**对话框。然后确保检查所有本**机**和**托管**（如果您正在调试 .NET 应用程序）。下次发生崩溃时，Visual Studio 即时调试器将出现。

Visual Studio 即时调试器让您可以选择是要打开 Visual Studio 的新实例还是使用当前打开的解决方案开始调试。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-13T10:34:41.477

来自[Microsoft 支持页面](http://support.microsoft.com/kb/121434)：

```
1\.  Start Registry Editor and locate the following Registry subkey in the HKEY_LOCAL_MACHINE subtree:

\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\AEDEBUG
2\.  Select the Debugger value.
3\.  On the Edit menu, click String.

•   To use the Windows debugger, type windbg -p %ld -e %ld.
•   To use Visual C++ 4.2 or earlier, type msvc -p %ld -e %ld.
•   To use Visual C++ 5.0 or later, type msdev.exe -p %ld -e %ld.
•   To use Dr. Watson, type drwtsn32.exe -p %ld -e %ld. You can also make Dr. Watson the default debugger by running this command:drwtsn32.exe -i.
4\.  Choose OK and exit Registry Editor. 
```

# java - 没有 HashCode 的错误，等于 Eclipse

> ID：197174
> 
> 赞同：4
> 
> 时间：2008-10-13T10:12:12.053
> 
> 标签：java, eclipse, plugins, equals, hashcode

我正在寻找一个非常具体的 eclipse 插件，它会告诉我我的项目中的一个类是否没有实现 hashCode 或/和 equals 方法。

有人知道这样的插件吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T10:20:21.443

或者你可以使用[findbugs](http://findbugs.sourceforge.net/)

规则[HE_EQUALS_NO_HASHCODE](http://findbugs.sourceforge.net/downloads.html)做你想做的事，并且有一个[eclipse 插件](http://findbugs.sourceforge.net/downloads.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T10:15:50.300

不能不用[Checkstyle插件](http://eclipse-cs.sourceforge.net/)，自己写Checkstyle规则吗？（有一个 Checkstyle 规则用于覆盖 equals 但不是 hashCode，但没有什么可以确保所有类都实现了两者，AFAIK。）

# c# - Windows Forms 应用程序，例如具有多个进程的 Google Chrome

> ID：197182
> 
> 赞同：25
> 
> 时间：2008-10-13T10:15:58.787
> 
> 标签：c#, winforms, process

有什么方法可以使用 C# 构建一个容器应用程序，其中每个选项卡实际上都是它自己的进程，就像 Google chrome 一样？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-13T10:21:59.723

您可以使用[SetParent](http://pinvoke.net/default.aspx/user32/SetParent.html) Win32 调用来执行此操作，但它确实充满了问题。我在使用来自不同 AppDomains 的窗口时遇到了很多麻烦 - 整个额外进程会遇到更多困难。

基本上，这两个进程之间可能需要大量的通信 - 调整大小等事情可能会变得非常痛苦，以及如果子应用程序想要退出会发生什么等。这一切都是可行的，但我会在做之前仔细考虑。对于浏览器来说，这很有意义（免责声明：我为 Google 工作），但对于大多数其他应用程序来说，这真的不值得。

（“选项卡”是您要创建实际的 .NET 应用程序吗？如果是这样，正如我所说，这将变得容易得多 - 我可以给您一个重要提示，即每个 UI 应该从其自己的 AppDomain 中运行自己的 UI 线程. 如果你不这样做，你会得到非常奇怪的效果！）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-01-20T01:23:24.840

对于那些对多进程应用程序的实际实现感兴趣的人，我在我的网站上写了一篇关于它的文章：**[Multi-process C# app like Google Chrome](http://wyday.com/blog/2010/multi-process-c-sharp-application-like-google-chrome-using-named-pipes/)**。

我已经包含了工作 C# 代码。它已经过测试，可与 .NET 2.0、.NET 3.0 和 .NET 3.5 一起使用。

## 命名管道：进程如何相互通信

由于您的问题专门询问了 Google Chrome，您应该知道[Chrome 使用命名管道](http://dev.chromium.org/developers/design-documents/inter-process-communication)在进程之间进行通信。

在我上面提到的 C# 源代码中，有 2 个文件：PipeServer.cs 和 PipeClient.cs。这 2 个文件是命名管道 Windows API 的瘦包装器。它经过了很好的测试，因为成千上万的人使用我们的产品。所以稳定性和鲁棒性是一个要求。

## 我们如何使用多流程设计

现在您已经掌握了所有的拼图，让我告诉您我们如何在我们的应用程序中使用多进程设计。

我们的产品是一个完整的更新程序解决方案。也就是说，有一个[构建更新补丁](http://wyday.com/wybuild/)的程序（与讨论无关），一个独立的更新程序（[wyUpdate - 也是开源](http://wyday.com/wyupdate/)的），以及我们的用户在他们的 C# 或 VB.NET 表单上放置的[自动更新程序控件。](http://wyday.com/wybuild/help/automatic-updates/)

我们使用命名管道在独立更新程序 (wyUpdate) 和位于程序窗体上的自动更新程序控件之间进行通信。wyUpdate 向 Automatic Updater 报告进度，Automatic Updater 可以告诉 wyUpdate 取消进度、开始下载、开始解压等。

事实上，我们使用的确切命名管道代码包含在我上面提到的文章中：**[Multi-process C# app like Google Chrome](http://wyday.com/blog/2010/multi-process-c-sharp-application-like-google-chrome-using-named-pipes/)**。

## 为什么你不应该使用多进程设计

正如上面提到的 Jon Skeet，您应该对多进程模型有特定的需求。在我们的例子中，我们希望将更新程序与您的程序完全分开。这样，如果更新程序以某种方式崩溃，您的程序将毫发无损。我们也不想在 2 个地方重复我们的代码。

话虽如此，即使使用我们经过良好测试的命名管道包装器，进程间通信也很困难。所以小心行事。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-13T10:20:38.557

查看Chromium 博客上的[这篇文章。](http://blog.chromium.org/2008/10/responsiveness-for-plugins-and-renderer.html)只有一个进程负责实际渲染到屏幕上。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T18:01:20.920

.NET 3.5 中引入的 System.AddIn API 允许您在单独的**AppDomains**中使用 UI 控件。通过一些箍跳，您也可以使其在单独的进程中工作。

这在 WPF 中得到原生支持。请参阅 MSDN 示例[Add-In Returns a UI](http://msdn.microsoft.com/en-us/library/bb913903.aspx)。

使用 Windows 窗体，使用 System.AddIn API 似乎无法实现。请参阅System.AddIn 架构师 Jack Gudenkauf 的[这篇文章](http://blogs.msdn.com/jackg/archive/2007/03/02/winforms-and-system-addin.aspx)。

但是，WinForms 有一个解决方法。您可以通过一些小技巧来完成这项工作：请参阅 BCL 团队的博客[Support for Windows Forms in System.AddIn Hosts and Add-ins](http://blogs.msdn.com/clraddins/archive/2008/01/03/support-for-windows-forms-in-hosts-and-add-ins.aspx)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-29T15:23:36.800

我的产品[WindowTabs.com](http://windowtabs.com)就是这样做的。您需要使用 Win32 - 我建议您避免使用 SetParent，因为您最终会附加线程输入。相反，在窗口上方绘制选项卡并使用 SetWindowPos 将窗口作为一个组移动。此外，如果您在 Win32 级别作为窗体的父级，某些第三方控件（如 Infragistic）将无法正常工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T10:22:08.757

是的。[您可以使用System.Diagnostics.Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)生成新进程。使用某种形式的[进程间通信](http://en.wikipedia.org/wiki/Inter-process_communication)(IPC)，例如[.NET Remoting](http://en.wikipedia.org/wiki/.NET_Remoting)，您可以在进程之间进行通信。然后您可以将新进程的窗口/表单的父级设置为您的第一个进程的窗口（选项卡），以便它出现在那里。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T11:07:10.507

无需深入研究可扩展性堆栈，您就可以使用[System.Addin](http://msdn.microsoft.com/en-us/library/system.addin.hosting.addinprocess.aspx)命名空间来构建一个应用程序，该应用程序本质上可以将插件创建为可视的单个选项卡，并将每个选项卡/插件设置为输出进程，这是一种开箱即用的行为。

它将具有与 chrome 选项卡相同的功能。

# java - 为什么我不能在具有多个边界的类型参数中使用类型参数？

> ID：197190
> 
> 赞同：57
> 
> 时间：2008-10-13T10:21:58.290
> 
> 标签：java, generics, constraints

所以，我知道*以下*不起作用，但*为什么*不起作用？

```
interface Adapter<E> {}

class Adaptulator<I> {
    <E, A extends I & Adapter<E>> void add(Class<E> extl, Class<A> intl) {
        addAdapterFactory(new AdapterFactory<E, A>(extl, intl));
    }
} 
```

该`add()`方法给了我一个编译错误，“当第一个绑定是类型参数时，不能指定任何额外的绑定 Adapter<E>”（在 Eclipse 中），或者“类型参数不能被其他边界跟随”（在 IDEA 中），请选择.

显然，您只是不允许在`I`之前使用 type 参数，仅`&`此而已。（在你问之前，如果你切换它们是行不通的，因为不能保证这`I`不是一个具体的类。）但为什么不呢？我浏览了 Angelika Langer 的常见问题解答，但找不到答案。

通常，当某些泛型限制看起来是任意的时，这是因为您已经创建了类型系统实际上无法强制正确性的情况。但我不知道什么情况会破坏我在这里尝试做的事情。我会说也许它与类型擦除后的方法调度有关，但只有一种`add()`方法，所以它不像有任何歧义......

有人可以为我演示这个问题吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-13T12:25:15.343

我也不确定为什么会有限制。您可以尝试向 Java 5 泛型的设计者（主要是 Gilad Bracha 和 Neal Gafter）发送一封友好的电子邮件。

我的猜测是，他们只想支持绝对最小的[交集类型](https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.9)（本质上就是多重边界），以使语言不会比需要的更复杂。交集不能用作类型注解；当交集作为类型变量的上界出现时，程序员只能表达交集。

为什么这个案子甚至得到支持？答案是多个边界允许您控制擦除，这允许在生成现有类时保持二进制兼容性。正如Naftalin 和 Wadler在[书中](http://java-generics-book.dev.java.net/)`max`第 17.4 节中所解释的那样，一个方法在逻辑上应该具有以下签名：

```
public static <T extends Comparable<? super T>> T max(Collection<? extends T> coll) 
```

但是，这会删除：

```
public static Comparable max(Collection coll) 
```

这与 的历史签名不匹配`max`，并导致旧客户端中断。对于多个边界，只有最左边的边界被考虑用于擦除，因此 if`max`被赋予以下签名：

```
public static <T extends Object & Comparable<? super T>> T max(Collection<? extends T> coll) 
```

那么其签名的擦除就变成了：

```
public static Object max(Collection coll) 
```

这等于`max`泛型之前的签名。

Java 设计者只关心这个简单的案例并限制交集类型的其他（更高级）使用似乎是合理的，因为他们只是不确定它可能带来的复杂性。所以这个设计决定的原因不一定是一个可能的安全问题（正如问题所暗示的那样）。

[在即将发布的 OOPSLA 论文](http://www.cs.rice.edu/~javaplt/papers/oopsla2008.pdf)中对泛型的交叉类型和限制进行更多讨论。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-17T03:16:31.610

取缔此行为的两个可能原因：

1.  复杂。 [JDK-4899305](https://bugs.openjdk.java.net/browse/JDK-4899305)建议包含类型参数和其他参数化类型的边界将允许比现有的更复杂的相互递归类型。简而言之，[布鲁诺的回答](https://stackoverflow.com/questions/197190/why-cant-i-use-a-type-argument-in-a-type-parameter-with-multiple-bounds#197391)。

2.  指定非法类型的可能性。具体来说，[使用不同的参数扩展一个通用接口两次](http://forums.sun.com/thread.jspa?messageID=2731375#2731541)。我想不出一个非人为的例子，但是：

    ```
    /** 包含一个也实现给定类型 T 的 Comparator<String>。 */
    类 StringComparatorHolder<T, C 扩展 T & Comparator<String>> {
      私有最终 C 比较器；
      // ...
    }

    void foo(StringComparatorHolder<Comparator<Integer>, ?> holder) { ... }
    ```

现在`holder.comparator`是 a`Comparator<Integer>`和 a `Comparator<String>`。我不清楚这会给编译器带来多少麻烦，但这显然不好。特别假设`Comparator`有这样的方法：

```
无效排序（列表<？扩展 T> 列表）；
```

我们的`Comparator<Integer>`/ `Comparator<String>`hybrid 现在有两种相同擦除的方法：

```
void sort(List<? extends Integer> list);
无效排序（列表<？扩展字符串>列表）；
```

正是由于这些原因，您不能直接指定这样的类型：

```
<T extends Comparator<Integer> & Comparator<String>> void bar() { ... }
```

```
java.util.Comparator 不能被不同的参数继承：
    <java.lang.Integer> 和 <java.lang.String>
```

由于`<A extends I & Adapter<E>>`允许您间接地做同样的事情，它也被淘汰了。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-13T15:55:25.183

[这是JLS](https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.9)的另一句话：

> 边界的形式受到限制（只有第一个元素可以是类或类型变量，并且边界中只能出现一个类型变量）以**排除某些尴尬情况的出现**。

那些尴尬的情况到底是什么，我不知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T11:33:49.737

这可能没有回答根本问题，而只是想指出规范明确禁止它。谷歌搜索错误消息将我带到[这个博客条目](http://blogs.oracle.com/vr/entry/a_type_variable_may_not "此博客条目")，进一步指向[jls 4.4](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#108850)：

> 边界由一个类型变量，或者一个类或接口类型 T 可能后跟进一步的接口类型 I1 ，...，In 组成。

因此，如果您使用类型参数作为绑定，则不能使用任何其他绑定，正如错误消息所述。

为什么要限制？我不知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-06T22:05:54.363

我遇到了同样的问题，并找到了一个可行的解决方案：

```
 interface Adapter<E>
    {}

    interface Adaptulator<I>
    {
        void add(Container<?, ? extends I> container);
    }

    static final class Container<E, I extends Adapter<E>>
    {
        public final Class<E> extl;
        public final Class<I> intl;

        public Container(Class<E> extl, Class<I> intl)
        {
            this.extl = extl;
            this.intl = intl;
        }
    } 
```

### 为什么它有效

为了理解这一点，我们需要说明我们的要求：

1.  保持两个不同的泛型在某些东西上同步。在您的情况下，这是**E**。
2.  两个泛型之一需要有一些额外的继承，这里是**I**。

创建一个额外的类允许通过创建一个紧密的上下文来满足这两个要求。

3.  一个额外的要求（但可能是最重要的）是需要一个泛型方法（不要过多地绑定到我们的类）。

这是通过 permissive 参数解决的`Container<?, ? extends I>`。

**笔记**

这只是一个猜测，但在这种用法中，一般来说，你很快就需要 a`? super A`或`? super I`某处。

# ruby-on-rails - 代理选择：mod_proxy_balancer、nginx + 代理平衡器、haproxy？

> ID：197199
> 
> 赞同：4
> 
> 时间：2008-10-13T10:26:54.973
> 
> 标签：ruby-on-rails, apache, proxy, solaris, mongrel

我们在一个专用的加速器上运行一个 Rails 站点[http://hansard.millbanksystems.com 。](http://hansard.millbanksystems.com)我们目前有带有 mod-proxy-balancer 的 Apache 设置，代理到运行应用程序的四个 mongrel。

有些请求相当慢，为了防止出现其他请求在它们后面排队的情况，我们正在考虑代理选项，如果有一个空闲的杂种，它将把请求定向到一个空闲的杂种。

选项似乎包括：

*   如[http://labs.reevoo.com/所述，为 Apache 重新编译 mod_proxy_balancer](http://labs.reevoo.com/2008/7/30/fixing-uneven-load-balancing-between-apache-and-mongrel-for-ruby-on-rails-applications)

*   使用 Solaris 的公平代理平衡器编译 nginx

*   为 Open Solaris 编译 haproxy（尽管这可能不适用于 SMF）

这些是合理的选择吗？我们错过了什么明显的东西吗？我们将非常感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T10:32:47.753

Apache 是一种用于平衡的奇怪野兽。它当然有能力，但就像使用坦克购物一样。

Haproxy/Nginx 更专为这项工作量身定制。您应该获得更高的吞吐量并同时使用更少的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-26T00:40:21.670

HAProxy 提供了比`mod_proxy_balancer`Nginx 和几乎所有其他软件更丰富的负载平衡功能。

特别是对于您的情况，日志输出是高度可定制的，因此应该更容易识别缓慢请求发生的时间、地点和原因。

此外，还有一些不同的负载分配算法可用，也具有很好的自动故障转移功能。

37Signals 在这里有一篇关于 Rails 和 HAProxy 的帖子（最初[在这里](https://stackoverflow.com/questions/172394/what-load-balancing-system-do-you-use-in-production-what-do-you-think-of-it)[看到](http://www.37signals.com/svn/posts/1073-nuts-bolts-haproxy)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T11:12:33.490

如果你想避免使用 Apache，可以部署一个 Mongrel 集群，它带有一个替代的 Web 服务器，比如 nginx 或 lighttpd，以及一个负载均衡器，比如 Pound 或基于硬件的解决方案。

磅（[http://www.apsis.ch/pound/](http://www.apsis.ch/pound/)）对我来说效果很好！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T20:23:02.747

haproxy 和 SMF 的唯一问题是您不能使用它的软重启功能来实现“刷新”操作，除非您编写包装脚本。[我在这里](http://blogs.warwick.ac.uk/chrismay/entry/solaris_smf_and)写得更详细一点

但是，IME haproxy 在 solaris 上绝对是防弹的，我强烈推荐它。我们通过 solaris 10 上的单个 haproxy 实例每天发送从几百 GB 到几 TB 的任何内容，到目前为止（触摸木头）在 2 年以上的运行中我们没有遇到任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-30T03:26:29.027

[Pound](http://www.apsis.ch/pound/)是我过去成功使用的 HTTP 负载均衡器。它包括一个动态缩放功能，可以帮助您解决特定问题：

> DynScale (0|1)：启用或禁用动态重新缩放代码（默认值：0）。如果启用，Pound 将定期尝试修改后端优先级，以平衡各个后端的响应时间。可以针对特定服务覆盖此值。

Pound 很小，有据可查，并且易于配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T10:43:09.697

我已经成功使用了 mod_proxy_balancer + mongrel_cluster（小流量网站）。

# c++ - 使用矢量作为私有/公共成员的类设计？

> ID：197211
> 
> 赞同：2
> 
> 时间：2008-10-13T10:35:49.073
> 
> 标签：c++, class-design, encapsulation

将容器类或其他类作为私有或公共成员放入类中的最佳方法是什么？

要求：

1.Vector< someclass> 在我的班级里

2.需要向量的添加和计数接口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T10:39:29.657

成员是声明为 Private 还是 Public 完全取决于您的应用程序。你能提供更多细节吗？

声明成员时要记住的重要一点是，如果您提供“getter”来检索它，那么您将不再封装该对象。相反，最好编写只公开您希望公开的功能的包装器方法。

例如，对于 Vector 成员，您可以编写 AddItem 和 Clear 方法，如果这是您希望公开的所有功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T10:57:23.257

既然你在谈论一个类，我认为它应该是私有的。如果您希望它公开，请创建一个结构 - 以明确您希望使用*成员*变量。

公开`vector`成员的可行替代方法是创建访问者函数（或内部迭代器）。这样你就能更好地遵守得墨忒耳定律：

```
class ContWrapper {
    std::vector<int> _ints;
public:
    class Action {
    public: 
        virtual void accept( int i ) = 0;
    };
    void each_int( Action& a );
}; 
```

在从库中导出例如 an 时也要非常小心`std::vector<T>`：客户端代码可能与您使用的 STL 实现不同，因此这些成员变量的布局可能不同！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T12:48:57.447

如果容器的状态是类不变量的一部分，那么如果可能的话，它应该是私有的。

例如，如果容器表示一个三维向量，那么不变量的一部分可能是它总是包含正好 3 个数字。将其公开为公共成员将允许类外部的代码更改容器大小，这反过来可能会导致任何需要容器大小保持不变的例程出现问题。保持容器私有会限制软件中容器大小可以修改为类的成员函数的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T10:44:18.027

将所有成员设为私有并使用访问器方法，这允许您稍后更改实现。只有在非常不寻常的情况下，我才会公开任何数据成员。

请记住，更改实现的频率比您想象的要多，这不仅是更改容器类型的情况，还可能是您想更改机制。假设您将名称存储在列表中，一段时间后您可能会选择使用散列索引此列表，并希望每次添加新名称时都更新散列。如果您的实现被适当地封装，这样做很容易，如果您刚刚公开了向量，则需要进行更改以调整界面（因此更改会产生涟漪）。

如果这是新手，您可以阅读：[http://en.wikipedia.org/wiki/Encapsulation_(classes_-_computers)](http://en.wikipedia.org/wiki/Encapsulation_(classes_-_computers))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T10:44:25.060

还有第三种方法 - 有时最好从容器继承并覆盖它的方法以实现您的目标（例如线程安全）。无论如何，将其公开几乎总是不是一个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T10:44:41.020

考虑到您要将容器封装在另一个类中意味着它不能是公共的，并且您的类的公共方法也不应该公开任何特定于容器的实现。这样，您的类（即容器）的实现可以在不更改其接口的情况下进行更改。

# apache - 主动反向代理

> ID：197215
> 
> 赞同：1
> 
> 时间：2008-10-13T10:38:41.687
> 
> 标签：apache, proxy, reverse, reverse-proxy

有谁知道任何允许 HTTP 响应的内容/数据在中继到请求客户端之前直接修改的反向代理解决方案？

举个例子：

代理将客户端对 pdf 文档的请求中继到另一台服务器，代理收到响应，将水印添加到 pdf 页面，带水印的 pdf 返回给客户端。

问候，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T11:15:16.467

Apache 有[`mod_proxy`](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)and [`mod_proxy_html`](http://apache.webthing.com/mod_proxy_html/)，用于重写链接、标题等。我只见过 HTML 或 XML 过滤器，但您应该能够为您的 PDF 需求编写自己的二进制文件。我可以看到的可能困难是 Apache 将网页视为流，而不是文件。我不确定如何为 PDF 文档添加水印，但如果您需要访问整个文件来执行此操作，它可能会很快变得复杂。

请注意，对我来说，在您可以访问文件的服务器上添加水印似乎要容易得多，而不是代理。如果服务器负载是一个问题，批处理或单独的服务器可能是一种替代解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T11:04:55.317

我在[Pound](http://www.apsis.ch/pound/)上取得了成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:51:48.120

我想我可能会走 Squid/ICAP 路线。

这是针对企业级系统的，在这种情况下，有人对这两种方法有任何经验吗？

[http://wiki.squid-cache.org/Features/ICAP](http://wiki.squid-cache.org/Features/ICAP)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T15:53:11.333

我在 python 标签上找到了关于[Deliverance](http://www.openplans.org/projects/deliverance/introduction)的描述，它可能对您正在寻找的内容有用。我自己没有这方面的经验，所以一粒盐等等。

[http://www.openplans.org/projects/deliverance/introduction](http://www.openplans.org/projects/deliverance/introduction)

# windows - 在 MSVC 6.0 中获取系统日期

> ID：197218
> 
> 赞同：1
> 
> 时间：2008-10-13T10:39:41.420
> 
> 标签：windows, date, system

我正在尝试在 MSVC++ 6.0 编译器上的 C 程序中获取系统日期。我正在使用系统调用：

**system("date /T")** （输出例如 08 年 10 月 13 日，这是我系统上的日期，采用我设置的格式）

但这会将日期打印到 i/o 控制台。

我如何将上述系统调用返回的日期作为字符串值存储到我的代码中定义的字符串中？或者

是否有任何其他 API 可以用来获取上述格式的日期（08 年 13 月 8 日或 08 年 13 月 10 日）？

-广告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T10:46:31.970

```
#include <windows.h>
#include <iostream>

int main() {

  SYSTEMTIME systmDateTime = {};
  ::GetLocalTime(&systmDateTime);

  wchar_t wszDate[64] = {};
  int const result = ::GetDateFormatW(
    LOCALE_USER_DEFAULT, DATE_SHORTDATE,
    &systmDateTime, 0, wszDate, _countof(wszDate));

  if (result) {
    std::wcout << wszDate;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T10:45:37.243

使用 API 函数有几种方法可以做到这一点，其中有两种方法是[strftime](http://msdn.microsoft.com/en-us/library/aa272978(VS.60).aspx)和[GetDateFormat](http://msdn.microsoft.com/en-us/library/ms776293.aspx)。

我想提供一些示例，但恐怕我目前手边没有 Win32 编译器。希望上述文档中的示例就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T10:49:32.993

阅读[Win32 Time 函数](http://msdn.microsoft.com/en-us/library/ms725473(VS.85).aspx)；GetLocalTime 可能是你的朋友。还有标准的 C 时间函数 time 和 strftime。

为了将来参考，在 C 程序中，调用外部实用程序并捕获它的 STDOUT 几乎总是错误的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T11:28:27.407

感谢您的指点。

我使用了它，它达到了我的目的：

```
#include <time.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/timeb.h>
#include <string.h>
    int main()

    {  

        char tmpbuf[128];

        time_t ltime;

        struct tm *today;

        _strdate( tmpbuf );
        printf("\n before formatting date is %s",tmpbuf);  

        time(&ltime);
        today = localtime( &ltime );

        strftime(tmpbuf,128,"%d-%m-%y",today);
        printf( "\nafter formatting date is %s\n", tmpbuf );

    } 
```

-广告

# c# - SqlDataReader.HasRows 自 SQL 2008 升级以来返回 false

> ID：197220
> 
> 赞同：6
> 
> 时间：2008-10-13T10:43:18.997
> 
> 标签：c#, asp.net, sql, sql-server-2008

我有一个连接到 SQL 数据库的 ASP.NET 2.0 网站。我已将 SQL 服务器从 2000 年升级到 2008 年，从那时起，一页无法正常工作。

我已经解决的问题是，即使数据集不为空，对 SqlDataReader.HasRows 的调用也会返回 false 并且删除检查允许通过 reader.Read() 的循环访问预期的数据。

```
 _connectionString = WebConfigurationManager.ConnectionStrings["SQLServer"].ConnectionString;
    SqlConnection connection = new SqlConnection(_connectionString);
    SqlCommand command = new SqlCommand(searchtype, connection);
    SqlParameter _parSeachTerm = new SqlParameter("@searchterm", SqlDbType.VarChar, 255);
    _parSeachTerm.Value = searchterm;
    command.Parameters.Add(_parSeachTerm);
    command.CommandType = CommandType.StoredProcedure;
    try
    {
        connection.Open();
        SqlDataReader reader = command.ExecuteReader();
        if (reader.HasRows) //this always returns false!?
        {
            while (reader.Read())
            {... 
```

有人知道发生了什么吗？HasRows 返回正确值的其他页面上有类似的代码块。

编辑-为了澄清，存储过程确实返回了我已经确认的结果，因为如果我删除 HasRows 检查，循环运行良好。只需将连接字符串中的 SQL 服务器名称更改为在 SQL 2000 上运行的相同数据库即可解决问题。我已经检查过 NOCOUNT 是否关闭，那么如果不是这种情况，还有什么可以让 HasRows 返回 false 呢？

EDIT2- 这是 SP

```
CREATE PROCEDURE StaffEnquirySurnameSearch

@searchterm varchar(255)

AS

SELECT  AD.Name, AD.Company, AD.telephoneNumber, AD.manager, CVS.Position, CVS.CompanyArea, CVS.Location, CVS.Title, AD.guid AS guid,
AD.firstname, AD.surname
FROM ADCVS AD
LEFT OUTER JOIN CVS ON
AD.Guid=CVS.Guid 
WHERE AD.SurName LIKE @searchterm
ORDER BY AD.Surname, AD.Firstname
GO 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T11:26:45.287

如果您直接调用存储过程（例如在 SSMS 中），存储过程是否有效？我会首先确保它确实如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T15:19:54.553

`HasRows`需要一个可滚动的光标。

您带回的行是否包含任何大`image/BLOB`数据？

正如其他人所建议的那样，我认为发布`Stored Procedure`可能会对此事有所了解......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T22:17:12.510

我认为你有 NOCOUNT 倒退。我相信 NOCOUNT 需要启用才能使其正常工作。

在您的存储过程中，在 AS 之后和任何代码之前添加 SET NOCOUNT ON。否则返回两个结果集。一个带有计数，一个带有实际数据。您只需要包含实际数据的结果集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T16:10:42.203

我又在猜测了。
您是否有机会打开多个数据读取器？

添加 MARS_Connection=yes; 或 MultipleActiveResultSets=true 连接字符串，如果有帮助的话。
此外，您不推荐使用连接和数据读取器

一种更简单的编写方法可能是

```
 using (connection cnn = new Connection(...)
{
using (SqlDataReader rdr = ....
{
//some code which deals with datareader
}
} 

```

操作完成后，这将关闭连接和数据读取器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T11:30:55.623

首先，按照@tvanfosson 的说明检查程序。其次，在代码片段中实际上不需要检查 HasRows()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T15:10:07.240

您不是偶然使用 RAISEERROR 吗？我们使用与上述相同的模式发现了一些问题（检查 HasRows，然后是 reader.Read()），并发现如果 RAISEERROR 与某个错误代码一起使用（我相信大于 16），那么 HasRows 将返回 false **，**我们会捕获异常的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T15:11:22.043

它可能是您的连接字符串、存储过程或 sql 驱动程序中的错误。大多数人都在猜测存储过程。所以给我们看代码。当您使用它时，向我们展示连接字符串和 searchtype 变量内容。

# svn - 什么是 SVN 中的 pre-revprop-change 钩子，我如何创建它？

> ID：197224
> 
> 赞同：177
> 
> 时间：2008-10-13T10:44:49.367
> 
> 标签：svn, svn-hooks

我想在存储库浏览器中编辑日志注释并收到一条错误消息，指出存储库不存在 pre-revprop-change 挂钩。除了有一个可怕的名字之外，什么是 pre-revprop-change 钩子，我如何创建它？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-01-22T08:59:56.610

对于 Windows，这是一个示例批处理文件的链接，该文件只允许更改日志消息（而不是其他属性）：

[http://ayria.livejournal.com/33438.html](http://ayria.livejournal.com/33438.html)

基本上将下面的代码复制到一个文本文件中并命名它`pre-revprop-change.bat`并将其保存在`\hooks`存储库的子目录中。

```
@ECHO OFF
:: Set all parameters. Even though most are not used, in case you want to add
:: changes that allow, for example, editing of the author or addition of log messages.
set repository=%1
set revision=%2
set userName=%3
set propertyName=%4
set action=%5

:: Only allow the log message to be changed, but not author, etc.
if /I not "%propertyName%" == "svn:log" goto ERROR_PROPNAME

:: Only allow modification of a log message, not addition or deletion.
if /I not "%action%" == "M" goto ERROR_ACTION

:: Make sure that the new svn:log message is not empty.
set bIsEmpty=true
for /f "tokens=*" %%g in ('find /V ""') do (
set bIsEmpty=false
)
if "%bIsEmpty%" == "true" goto ERROR_EMPTY

goto :eof

:ERROR_EMPTY
echo Empty svn:log messages are not allowed. >&2
goto ERROR_EXIT

:ERROR_PROPNAME
echo Only changes to svn:log messages are allowed. >&2
goto ERROR_EXIT

:ERROR_ACTION
echo Only modifications to svn:log revision properties are allowed. >&2
goto ERROR_EXIT

:ERROR_EXIT
exit /b 1 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-10-13T10:54:16.227

基本上，它是在存储库上修改未版本化属性之前启动的脚本，因此您可以更精确地管理存储库中发生的事情。

SVN 发行版中有用于不同挂钩的模板，位于 /hooks 子目录（*.tmpl，您必须根据您的操作系统编辑和重命名才能激活）。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-09-15T09:12:42.230

对于 Linux 允许编辑日志注释，

*   `pre-revprop-change.tmpl`在`hooks`您的存储库目录中找到该文件
*   将文件复制到同一目录，将其重命名为`pre-revprop-change`
*   授予文件执行权限（对于服务器用户，例如`www-data`）

**编辑：（**感谢林德斯）

*   之后，您可能必须编辑脚本以返回`0`您想要允许的编辑类型的退出值。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-02-02T15:58:00.393

这是堆栈溢出问题的链接，其中包含许多常见挂钩[Common Types of Subversion Hooks](https://stackoverflow.com/questions/6155/common-types-of-subversion-hooks/68850#68850)`pre-revprop-change` ，包括此处交叉发布的 Windows 挂钩的原始来源。

您应该参考那里，因为它们可能会随着时间的推移而得到改善。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-11-09T08:47:33.940

谢谢#patmortech

我添加了您的代码，“只有同一个用户可以更改他的代码”。

```
:: Only allow editing of the same user.
for /f "tokens=*" %%a in ( 
'"%VISUALSVN_SERVER%\bin\svnlook.exe" author -r %revision% %repository%') do ( 
set orgAuthor=%%a
)
if /I not "%userName%" == "%orgAuthor%" goto ERROR_SAME_USER 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-12-05T09:57:35.910

如果您设法破译它，钩子脚本的名称并不那么可怕：它是**预修订属性更改钩子**。简而言之，[`pre-revprop-change`](http://svnbook.red-bean.com/en/1.8/svn.ref.reposhooks.pre-revprop-change.html)钩子脚本的目的是控制未版本化（修订）属性的更改并发送通知（例如，当修订属性更改时发送电子邮件）。

Subversion 中有两种类型的属性：

*   可以在文件和目录上设置的版本化属性（例如`svn:needs-lock`和），`svn:mime-type`
*   *在存储库修订*上设置的未版本化（修订）属性（例如`svn:log`和） 。`svn:date`

 *版本化属性具有历史记录，可以由对存储库具有读/写访问权限的普通用户操作。另一方面，未版本化的属性没有任何历史记录，主要用于维护目的。例如，如果您提交一个修订，它会立即获得`svn:date`您提交的 UTC 时间、`svn:author`您的用户名和`svn:log`您的提交日志消息（如果您指定的话）。

正如我已经指定的，`pre-revprop-change`挂钩脚本的目的是控制修订属性的更改。您不希望有权访问存储库的每个人都能够修改所有修订属性，因此默认情况下禁止更改修订属性。要允许用户更改属性，您必须创建`pre-revprop-change`钩子。

最简单的钩子只能包含一行：`exit 0`. 它将允许任何经过身份验证的用户更改任何修订属性，并且不应在实际环境中使用。在 Windows 上，您可以使用批处理脚本或基于 PowerShell 的脚本在`pre-revprop-change`hook 中实现一些逻辑。

此 PowerShell 脚本只允许更改`svn:log`属性并拒绝空日志消息。

```
# Store hook arguments into variables with mnemonic names
$repos    = $args[0]
$rev      = $args[1]
$user     = $args[2]
$propname = $args[3]
$action   = $args[4]

# Only allow changes to svn:log. The author, date and other revision
# properties cannot be changed
if ($propname -ne "svn:log")
{
  [Console]::Error.WriteLine("Only changes to 'svn:log' revision properties are allowed.")
  exit 1
}

# Only allow modifications to svn:log (no addition/overwrite or deletion)
if ($action -ne "M")
{
  [Console]::Error.WriteLine("Only modifications to 'svn:log' revision properties are allowed.")
  exit 2
}

# Read from the standard input while the first non-white-space characters
$datalines = ($input | where {$_.trim() -ne ""})
if ($datalines.length -lt 25)
{
  # Log message is empty. Show the error.
  [Console]::Error.WriteLine("Empty 'svn:log' properties are not allowed.")
  exit 3
}

exit 0 
```

此批处理脚本仅允许“svnmgr”用户更改修订属性：

```
IF "%3" == "svnmgr" (goto :label1) else (echo "Only the svnmgr user may change revision properties" >&2 )

exit 1
goto :eof

:label1
exit 0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-12T15:11:48.933

对于 PC 用户：.bat 扩展名在 Windows Server 上使用时对我不起作用。我按照 Django Reinhardt 的建议使用 VisualSvn，它创建了一个带有 .cmd 扩展名的钩子。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-02-25T10:42:33.727

如果要保存对日志消息的更改，请使用来自@patmortech ( [https://stackoverflow.com/a/468475](https://stackoverflow.com/a/468475) )的上述答案中的批处理脚本，该脚本从[https://stackoverflow.com/](https://stackoverflow.com/a/68850)
复制了脚本[a/68850](https://stackoverflow.com/a/68850)，并在和
之间添加这些行：`if "%bIsEmpty%" == "true" goto ERROR_EMPTY``goto :eofbefore`

```
set outputFile=%repos%\log-change-history.txt

echo User '%user%' changes log message in rev %rev% on %date% %time%.>>%outputFile%
echo ----- Old message: ----->>%outputFile%
svnlook propget --revprop %repos% svn:log -r %rev% >>%outputFile%
echo.>>%outputFile%
echo ----- New message: ----->>%outputFile%
for /f "tokens=*" %%g in ('find /V ""') do (echo %%g >>%outputFile%)
echo ---------->>%outputFile%
echo.>>%outputFile% 
```

它将`log-change-history.txt`在服务器上的 repo 文件夹中创建一个文本文件，并附加每个日志更改通知。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-01T01:26:59.243

这对我来说在 Windows Server 上是最简单的：在 VisualSVN 中，右键单击您的存储库，然后选择**Properties...**， 然后选择**Hooks**选项卡。

选择**Pre-revision property change hook**，单击**Edit**。

我需要能够更改作者 - 它经常发生在多人使用的远程计算机上，我们错误地使用其他人存储的凭据签入。

这是要粘贴的修改后的社区 wiki 脚本：

```
@ECHO OFF
:: Set all parameters. Even though most are not used, in case you want to add
:: changes that allow, for example, editing of the author or addition of log messages.
set repository=%1
set revision=%2
set userName=%3
set propertyName=%4
set action=%5

:: Only allow the author to be changed, but not message ("svn:log"), etc.
if /I not "%propertyName%" == "svn:author" goto ERROR_PROPNAME

:: Only allow modification of a log message, not addition or deletion.
if /I not "%action%" == "M" goto ERROR_ACTION

:: Make sure that the new svn:log message is not empty.
set bIsEmpty=true
for /f "tokens=*" %%g in ('find /V ""') do (
set bIsEmpty=false
)
if "%bIsEmpty%" == "true" goto ERROR_EMPTY

goto :eof

:ERROR_EMPTY
echo Empty svn:author messages are not allowed. >&2
goto ERROR_EXIT

:ERROR_PROPNAME
echo Only changes to svn:author messages are allowed. >&2
goto ERROR_EXIT

:ERROR_ACTION
echo Only modifications to svn:author revision properties are allowed. >&2
goto ERROR_EXIT

:ERROR_EXIT
exit /b 1 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-29T17:40:51.470

1.  转到 SVN repo 目录到子文件夹“hooks”，例如“D:\SVN\hooks\”
2.  在那里创建空文件“pre-revprop-change.bat”
3.  在文件中写入“exit 0”（不带“”）并保存
4.  请享用 ：）

（这个解决方案肯定有缺点，因为没有检查/禁止任何内容。但就我而言 - 只有我正在使用的本地仓库 - 它似乎有效。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-21T15:14:49.127

正如 Alois Helmer 之前回答的那样，您需要在 SVN 存储库内`pre-revprop-change.tmpl`的目录中找到要允许修订评论版本的文件。`hooks`

对我来说，创建一个副本`pre-revprop-change name`就足够了，尽管您可以对其进行编辑以仅允许某些用户修改您的评论或其他一些需求。

然后您必须使用授予常规读取和执行权限`chmod 755 pre-revprop-change`

但是**常规的执行权限是不够的**。您需要像这样**在 SELinux 中为该脚本授予 Apache/HTTPD 执行授权。**

```
chcon -t httpd_exec_t pre-revprop-change 
```

否则，您将收到以下错误信息，该错误信息很少，并且很难与 SELinux conf 关联。

```
svnrdump: E175008: Revprop change blocked by pre-revprop-change hook (exit code 255) with no output. 
```

# jquery - 如何检查文件是否存在于javascript中？

> ID：197228
> 
> 赞同：3
> 
> 时间：2008-10-13T10:46:07.210
> 
> 标签：jquery, file, exists

我正在使用 jquery 库来加载 html 文件的内容。像这样的东西：

$("#Main").load("login.html")

如果文件（在本例中为“login.html”）不存在，我想检测它，以便可以将用户重定向到错误页面。有什么想法可以检测到要加载的文件是否存在？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T10:52:01.270

您可以使用 ajaxComplete 事件，whis 让您可以访问 xhr 对象，您可以查询请求的状态，例如状态 404 将意味着文件不存在。

文档中的更多信息[http://docs.jquery.com/Ajax/ajaxComplete#callback](http://docs.jquery.com/Ajax/ajaxComplete#callback)

在这里测试[http://pastebin.me/48f32a74927bb](http://pastebin.me/48f32a74927bb)

例如

```
$("#someDivId").ajaxComplete(function(request, settings){
    if (settings.status===404){
        //redirect here
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T09:32:40.603

@PConroy 的解决方案有效，但它对所有失败的 ajax 请求执行相同的操作。

如果您在每个请求的基础上都需要这个 - 即，如果第一个请求失败它会转到 X 页，如果第二个请求失败转到 Y，那么您需要使用 $.ajax 函数中的错误句柄来执行此操作：

[http://jsbin.com/iwume](http://jsbin.com/iwume)

（编辑：http: [//jsbin.com/iwume/edit](http://jsbin.com/iwume/edit)）

# iis-7 - x64 Windows 2008/IIS 7.0 上的 BizTalk Server BAM 门户

> ID：197229
> 
> 赞同：1
> 
> 时间：2008-10-13T10:46:08.583
> 
> 标签：iis-7, 64-bit, biztalk, biztalk2006r2

我们正在尝试在具有 x64 Windows 2008 的全新服务器上安装 BizTalk Server 2006 R2。基本配置抱怨我们为 BAM 门户安装选择的“默认网站”未验证，因为“IIS 未启用 32 位” 。” 尽管将 appPool（经典模式）32 位属性设置为 True，但 BizTalk 配置向导仍在抱怨。

有人在 64 位 IIS 7.0 中成功安装了 BAM Portal 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T08:37:21.980

微软的官方声明似乎是 Biztalk Server 2006 R2 with Windows 2008 is "not supported"。BizTalk Server 2009 是一款旨在与 Windows 2008 结合的产品。

**更新，MOFE 信息**

需要补充说明的是，[为BizTalk Group设置多台服务器](http://go.microsoft.com/fwlink/?LinkId=83322)的过程需要配置网络COM+和DTC访问，其中Windows 2008这样做的界面与Windows 2003不同。其实我还没有找到如何配置BizTalk 2006 要求的 Windows 2008 中的 MSDTC。未能正确配置此设置将阻止由于事务失败而在远程 SQL Server 中正确创建某些数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T02:53:24.230

BizTalk 2006 R2 在 Windows 2008 上将不受支持，并且今后也不会改变，如果您希望此配置正常工作，您将需要 BizTalk 2009。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T12:19:37.087

我已经成功地在 W2008/x64 中安装/配置了 BAM，没有任何问题。然而，我似乎无法让 BAM 门户工作。如果在应用程序池中未启用 x32 兼容，我会收到预期的程序集加载错误。启用 x32 应用程序兼容性后，即使在网站上添加静态 .html 页面，我也只会在网络上看到空白页面。

# .net - .net 发布

> ID：197232
> 
> 赞同：1
> 
> 时间：2008-10-13T10:47:31.983
> 
> 标签：.net, winforms, deployment, clickonce

我有一个 .net 应用程序，并在本地位置发布。从发布的位置安装时，应用程序需要安装在“c:\temp”中，我如何在 clickonce 方法中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T11:27:09.250

ClickOnce 安装程序**不会安装**到“程序文件”或任何特定目录 (C:\temp)。出于安全目的，您的 WinForms 应用程序位于**ClickOnce 缓存**中，这是一个混淆目录，每个 ClickOnce 应用程序都不同。

它记录在此 MSDN 库主题中：[ClickOnce 缓存概述](http://msdn.microsoft.com/en-us/library/267k390a.aspx)（MSDN 文章）。

如果要以编程方式获取**数据目录**，可以使用 System.Deployment 命名空间：[ApplicationDeployment：DataDirectory 属性](http://msdn.microsoft.com/en-us/library/system.deployment.application.applicationdeployment.datadirectory.aspx)（MSDN 文档）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T10:49:35.783

ClickOnce 安装始终安装在预定义的用户文件夹中，即 ClickOnce 缓存中。

无法在其他地方安装 ClickOnce 程序。您也不能决定创建 ClickOnce 包的不同位置，安装程序的人也不能决定不同的位置。

这不是遗漏，也不是错误，这是设计使然，并且注定要如此。

如果要安装在特定位置，则需要使用其他一些安装方法。

# regex - 如何用正则表达式解析命令行？

> ID：197233
> 
> 赞同：10
> 
> 时间：2008-10-13T10:48:45.693
> 
> 标签：regex, parsing

我想在单个字符串参数中拆分像字符串这样的命令行。如何看待它的正则表达式。问题是可以引用参数。例如像：

“参数 1” 参数 2 “参数 3”

应该导致：

参数 1、参数 2、参数 3

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-13T11:35:17.470

您不应该为此使用正则表达式。改为编写解析器，或使用您的语言提供的解析器。

我不明白为什么我会因此而被否决。这就是它可以在 Python 中完成的方式：

```
>>> import shlex
>>> shlex.split('"param 1" param2 "param 3"')
['param 1', 'param2', 'param 3']
>>> shlex.split('"param 1" param2 "param 3')
Traceback (most recent call last):
    [...]
ValueError: No closing quotation
>>> shlex.split('"param 1" param2 "param 3\\""')
['param 1', 'param2', 'param 3"'] 
```

现在告诉我，为了正则表达式如何解决这个问题而破坏你的大脑是值得的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T10:54:56.570

不考虑实现语言，您的正则表达式可能如下所示：

```
("[^"]*"|[^"]+)(\s+|$) 
```

第一部分`"[^"]*"`查找不包含嵌入引号的带引号的字符串，第二部分`[^"]+`查找一系列非引号字符。`\s+`匹配一个分隔的空格序列，并匹配`$`字符串的结尾。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-13T10:58:48.153

我倾向于使用 regexlib 来解决这类问题。如果您访问：[http](http://regexlib.com/) ://regexlib.com/并搜索“命令行”，您会发现三个看起来他们正在尝试解决此问题或类似问题的结果 - 应该是一个好的开始。

这可能有效： [http ://regexlib.com/Search.aspx?k=command+line&c=-1&m=-1&ps=20](http://regexlib.com/Search.aspx?k=command+line&c=-1&m=-1&ps=20)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-11-08T10:21:45.720

```
("[^"]+"|[^\s"]+) 
```

我用什么 C++

```
#include <iostream>
#include <iterator>
#include <string>
#include <regex>

void foo()
{
    std::string strArg = " \"par   1\"  par2 par3 \"par 4\""; 

    std::regex word_regex( "(\"[^\"]+\"|[^\\s\"]+)" );
    auto words_begin = 
        std::sregex_iterator(strArg.begin(), strArg.end(), word_regex);
    auto words_end = std::sregex_iterator();
    for (std::sregex_iterator i = words_begin; i != words_end; ++i)
    {
        std::smatch match = *i;
        std::string match_str = match.str();
        std::cout << match_str << '\n';
    }
} 
```

输出：

```
"par   1"
par2
par3
"par 4" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-07T14:44:17.157

正则表达式：`/[\/-]?((\w+)(?:[=:]("[^"]+"|[^\s"]+))?)(?:\s+|$)/g`

样本：`/P1="Long value" /P2=3 /P3=short PwithoutSwitch1=any PwithoutSwitch2`

这样的正则表达式可以解析由规则构建的参数列表：

*   参数由空格（一个或多个）分隔。
*   参数可以包含开关符号（`/`或`-`）。
*   参数由名称和值组成，除以符号`=`或`:`。
*   名称可以由字母数字和下划线组成。
*   价值可以缺席。
*   如果 value 存在，它可以是任何符号的集合，但如果它有空格，那么 value 应该被引用。

这个正则表达式有三组：

*   第一组包含没有开关符号的整个参数，
*   第二组仅包含名称，
*   第三组仅包含值（如果存在）。

对于上面的示例：

1.  全场比赛：`/P1="Long value"`
    *   第 1 组：`P1="Long value"`,
    *   组#2: `P1`,
    *   第 3 组：`"Long value"`.
2.  全场比赛：`/P2=3`
    *   第 1 组：`P2=3`,
    *   组#2: `P2`,
    *   第 3 组：`3`.
3.  全场比赛：`/P3=short`
    *   第 1 组：`P3=short`,
    *   组#2: `P3`,
    *   第 3 组：`short`.
4.  全场比赛：`PwithoutSwitch1=any`
    *   第 1 组：`PwithoutSwitch1=any`,
    *   组#2: `PwithoutSwitch1`,
    *   第 3 组：`any`.
5.  全场比赛：`PwithoutSwitch2`
    *   第 1 组：`PwithoutSwitch2`,
    *   组#2: `PwithoutSwitch2`,
    *   第 3 组：缺席。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T11:19:20.873

大多数语言都有其他功能（内置或由标准库提供），它们解析命令行比构建您自己的正则表达式要容易得多，而且您知道它们会开箱即用地准确完成。如果您编辑您的帖子以识别您正在使用的语言，我相信这里的某人将能够为您指出以该语言使用的语言。

正则表达式是非常强大的工具，对很多事情都很有用，但也有很多问题，它们不是最好的解决方案。这是其中之一。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-03-06T06:03:16.753

这将从它的参数中拆分一个exe；从 exe 中去除括号；假设干净的数据：

```
^(?:"([^"]+(?="))|([^\s]+))["]{0,1} +(.+)$ 
```

您一次将有两场比赛，三个比赛组：

1.  exe如果它被包裹在括号中
2.  如果 exe 没有用括号括起来
3.  参数集

**例子：**

```
"C:\WINDOWS\system32\cmd.exe" /c echo this 
```

第一场比赛：`C:\WINDOWS\system32\cmd.exe`

匹配 2：$null

第 3 场比赛：`/c echo this`

```
C:\WINDOWS\system32\cmd.exe /c echo this 
```

匹配 1：$null

比赛2：`C:\WINDOWS\system32\cmd.exe`

第 3 场比赛：`/c echo this`

```
"C:\Program Files\foo\bar.exe" /run 
```

第一场比赛：`C:\Program Files\foo\bar.exe`

匹配 2：$null

第 3 场比赛：`/run`

**想法：**

我很确定您需要创建一个循环来捕获可能无限数量的参数。

这个正则表达式可以很容易地循环到它的第三场比赛，直到比赛失败；没有更多的参数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-11T17:46:14.230

有一个 python 答案，因此我们也将有一个 ruby​​ 答案:)

```
require 'shellwords'
Shellwords.shellsplit '"param 1" param2 "param 3"'
#=> ["param 1", "param2", "param 3"] or :
'"param 1" param2 "param 3"'.shellsplit 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T10:58:59.900

就像是：

```
"(?:(?<=")([^"]+)"\s*)|\s*([^"\s]+) 
```

或更简单的：

```
"([^"]+)"|\s*([^"\s]+) 
```

（只是为了找到一个正则表达式；））

应用几次，n°1 组就会给你参数，不管它是否被双引号括起来。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T18:29:16.357

如果它只是您担心的引号，那么只需编写一个简单的循环将字符逐个转储到忽略引号的字符串。

或者，如果您正在使用一些字符串操作库，您可以使用它来删除所有引号，然后将它们连接起来。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-16T22:12:57.310

如果您要解析命令和参数，我使用以下内容（在换行符处匹配 ^$ 也就是多行）：

```
(?<cmd>^"[^"]*"|\S*) *(?<prm>.*)? 
```

如果您想在 C# 代码中使用它，请在此处正确转义：

```
try {
    Regex RegexObj = new Regex("(?<cmd>^\\\"[^\\\"]*\\\"|\\S*) *(?<prm>.*)?");

} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

它将解析以下内容并知道命令与参数是什么：

```
"c:\program files\myapp\app.exe" p1 p2 "p3 with space"
app.exe p1 p2 "p3 with space"
app.exe 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-07-25T07:24:07.867

```
\s*("[^"]+"|[^\s"]+) 
```

就是这样

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-10-13T11:48:50.220

（再次阅读您的问题，就在发布之前，我注意到您说命令行 LIKE 字符串，因此这些信息可能对您没有用，但正如我所写的那样，我无论如何都会发布 - 如果我误解了您的问题，请忽略。）

如果您澄清您的问题，我会尽力提供帮助，但从您所做的一般性评论中我会说不要那样做:-)，您要求使用正则表达式将一系列参数拆分为一个数组。我强烈建议您考虑使用 getopt，而不是自己这样做，大多数编程语言都有这个库的版本。如果您将来需要，Getopt 将按照您的要求进行扩展，以管理更复杂的参数处理。

如果您让我知道您使用的是什么语言，我会尝试为您发布示例。

以下是主页示例：

[http://www.codeplex.com/getopt](http://www.codeplex.com/getopt) (.NET)

[http://www.urbanophile.com/arenn/hacking/download.html](http://www.urbanophile.com/arenn/hacking/download.html) (java)

一个示例（来自上面的 java 页面）

```
 Getopt g = new Getopt("testprog", argv, "ab:c::d");
 //
 int c;
 String arg;
 while ((c = g.getopt()) != -1)
   {
     switch(c)
       {
          case 'a':
          case 'd':
            System.out.print("You picked " + (char)c + "\n");
            break;
            //
          case 'b':
          case 'c':
            arg = g.getOptarg();
            System.out.print("You picked " + (char)c + 
                             " with an argument of " +
                             ((arg != null) ? arg : "null") + "\n");
            break;
            //
          case '?':
            break; // getopt() already printed an error
            //
          default:
            System.out.print("getopt() returned " + c + "\n");
       }
   } 
```

# sharepoint - 删除 PlaceHolderPageTitleInTitleArea 的内容

> ID：197236
> 
> 赞同：3
> 
> 时间：2008-10-13T10:51:15.953
> 
> 标签：sharepoint

在 sharepoint 中有一个名为 PlaceHolderPageTitlteInTitleArea 的内容占位符。我正在尝试从我放置在 CONTROLTEMPLATES 中的自定义 RenderingTemplate 中删除其中的所有内容。那么是否可以通过使用内联代码或其他方式来实现这一点。

现在我已经在我的 SharePoint:RenderingTemplate 控件中使用此代码修复了它

```
 <script type="text/javascript">
        var tableArea = document.getElementById('onetidPageTitleAreaFrame');
        if (tableArea != null) {
            tableArea.style.height = '25px';
        }

        var titleArea = document.getElementById('onetidPageTitle');
        if (titleArea != null) {
            titleArea.style.display = 'none';
        }
    </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T21:55:31.180

如果您创建自定义母版页并修改

```
<asp:ContentPlaceHolder id="PlaceHolderPageTitleInTitleArea" runat="server" /> 
```

阅读的标签

```
<asp:ContentPlaceHolder id="PlaceHolderPageTitleInTitleArea" runat="server" Visible="false" /> 
```

相反，您可以获得相同的结果。您可以通过以下方式创建自定义母版页：使用 SharePoint Designer 打开网站，创建新母版页，将 Default.master 的内容复制到其中，然后修改占位符标记，并将新母版页设置为自定义母版页。

您还可以创建一个 Panel 控件，将其可见性设置为 false，然后放入您不希望在屏幕上呈现的所有占位符：

```
<asp:Panel visible="false" runat="server">
 <asp:ContentPlaceHolder id="PlaceHolderPageTitleInTitleArea" runat="server" />
</asp:Panel> 
```

希望这可以帮助。

# c# - 关于 System.Linq.Lookup 类

> ID：197241
> 
> 赞同：15
> 
> 时间：2008-10-13T10:53:13.313
> 
> 标签：c#, linq

我在阅读 C# 书籍时遇到了这门课，并有一些问题。

*   为什么将其添加到 System.Linq 命名空间而不是通常的 Collections 命名空间？
*   这门课背后的意图是什么
*   为什么这个类不用于直接实例化？这只能通过 ToLookup 扩展获得，对吧？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-13T10:56:45.660

类的目的：一个键可以映射到多个值的字典。将其视为用于分组而不是一对一映射。

仅通过 ToLookup 决定：通过。再一次，对我来说似乎是个坏电话。另一方面，这意味着结果对于外界来说是不可变的，这非常好。当然，编写自己的支持这一点的集合很容易 - 但如果“正确”地将它放在集合中会非常好。我的猜测是，MS 没有时间/金钱来进行非常严格的设计/测试，使其成为一流的收藏决定。

命名空间决策：可能与上述有关。在 System.Collections.Generic 中有一个您自己无法创建的版本会有点奇怪。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T12:10:42.297

顺便说一句，请注意[MiscUtil](http://www.pobox.com/~skeet/csharp/miscutil/)还包括一个`MiscUtil.Linq.EditableLookup<,>`类似的类；它实现了常规`ILookup<,>`接口，但完全可变——因此您可以创建它并添加您自己的值。

# c++ - 调用 C++ STL 容器的 value_type 的静态成员函数

> ID：197258
> 
> 赞同：2
> 
> 时间：2008-10-13T11:03:06.850
> 
> 标签：c++, stl

我试图弄清楚为什么以下不起作用。我有一个 std::vector ，我想调用它的静态成员函数，它包含 value_type ，如下所示：

```
std::vector<Vector> v;
unsigned u = v.value_type::Dim(); 
```

其中 Vector 实际上是模板类型的 typedef：

```
template <typename T, unsigned U> class SVector; 
typedef SVector<double, 2> Vector; //two-dimensional SVector containing doubles 
```

而静态成员函数 Dim() 实际上内联了 Vector 的维数 U。

现在编译器返回一条错误消息说：

```
 error: ‘SVector<double, 2u>’ is not a base of 
 ‘std::vector<SVector<double, 2u>, std::allocator<SVector<double, 2u> > > 
```

这让我很困惑。我可以将明显有问题的行替换为

```
unsigned u = Vector::Dim(); 
```

这有效，但显然很难看，因为它硬编码了关于 v 的 value_type 的假设......谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-13T11:15:34.093

您正在通过变量实例而不是变量类型访问 value_type。

**方法1** - 这有效：

```
typedef std::vector<Vector> MyVector;
MyVector v;
unsigned u = MyVector::value_type::Dim(); 
```

**方法2** - 或者这个：

```
std::vector<Vector> v;
unsigned u = std::vector<Vector>::value_type::Dim(); 
```

如果您像方法 1 中的 typedef 一样，您不会对向量模板参数的假设进行硬编码，而是编写干净的代码。

* * *

**编辑：**根据问题所有者的要求扩展以解释此问题的行为：

范围解析运算符的[优先级](http://www.cppreference.com/wiki/operator_precedence)`::`高于任何其他 C++ 运算符。这包括来自对象操作员的成员访问。因此，当您编写以下内容时：`.`

```
unsigned u= v.value_type::Dim(); 
```

这将解析为以下 C++ 代码：

```
unsigned u = v.SVector<double, 2>::Dim(); 
```

最终首先解决的是`SVector<double, 2>::Dim()`零件。这将强制声明槽变量的向量实例`v`具有一个名为 SVector 的模板化内部类。因为这不会发生，所以会导致错误：

```
error C2039: 'SVector<double,2>' : is not a member of 'std::vector<_Ty>' 
```

对于此模式的每次使用， STL`vector`都必须“扩展”（通过变量实例而不是变量类型访问 value_type）。这不是一个好的解决方案，因为它会导致大量样板文件和**不必要且不可维护的代码**。通过遵循上述解决方案，您可以避免所有这些，并且可以轻松地做您想做的事情。

# html - Table layout wrong in IE(7)

> ID：197266
> 
> 赞同：4
> 
> 时间：2008-10-13T11:10:54.057
> 
> 标签：html, layout, internet-explorer-7, html-table

Below is the code of a simple html with a table layout. In FF it's looking as I think it should look like, in IE7 it doesn't. what am I doing wrong?

And how can I fix it?

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <TITLE>test</TITLE>
    </head>
    <body>
        <table  id="MainTable" cellspacing="0" cellpadding="0" border="1">
        <tbody>
            <tr>
                <td colspan="4">
                    <div style='width:769; height:192;'>192
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2" valign="top">
                    <div style='width:383; height:100;'>100
                    </div>
                </td>
                <td rowspan="2" valign="top">
                    <div style='width:190; height:200;'>200
                    </div>
                </td>
                <td rowspan="2" valign="top">
                    <div style='width:190; height:200;'>200
                    </div>
                </td>
            </tr>
            <tr>
                <td  valign="top" rowspan="2">
                    <div style='width:190; height:200;'>200
                    </div>
                </td>
                <td  valign="top" rowspan="2">
                    <div style='width:190; height:200;'>200
                    </div>
                </td>
            </tr>
            <tr>
                <td valign="top">
                    <div style='width:190; height:100;'>100
                    </div>
                </td>
                <td valign="top" >
                    <div style='width:190; height:100;'>100
                    </div>
                </td>                           
            </tr>
            <tr>
                <td colspan="2">
                    <div style='width:383; height:100;'>100
                    </div>
                </td>
                <td colspan="2">
                    <div style='width:383; height:100;'>100
                    </div>
                </td>
            </tr>

            <tr>
                <td>
                    <div style='width:190; height:100;'>100
                    </div>
                </td>
                <td>
                    <div style='width:190; height:100;'>100
                    </div>
                </td>
                <td colspan="2">
                    <div style='width:383; height:100;'>100
                    </div>
                </td>
            </tr>
        </tbody>
        </table>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T11:42:16.270

I assume you are complaining about the minimal height of the middle row (the one containing only rowspanned cells), and the enlarged height of the adjacent rows to compensate, leaving gaps between the divs.

IE cannot calculate optimal row heights when the row contains only rowspanned cells. The usual solution when you absolutely cannot rejig it to get rid of the rowspan is to add a 1px 'dummy' column to one side of the table, containing empty cells, each with the 'height' set to how high the row should be.

But yes, depending on what you're planning to do with this, a CSS layout may well be more appropriate. If it's really a fixed-pixels-for-everything layout like this example, absolute positioning for each div will be a lot, lot easier.

Other bits: CSS width/height values require units (presumably 'px'); valign/cellspacing/etc. can be more easily done in a stylesheet even if you are using table layouts; a standards-mode DOCTYPE may prevent some of the worse IE bugs (although, not this old, non-CSS-related one).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T11:23:23.907

For a start, your CSS values should have units, e.g. `width:190;` should be `width: 190px;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T11:22:48.883

completely agree, you can have a look at blueprint CSS or other CSS frameworks for some help

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T11:42:15.833

At first sight it looks like IE7 has some broken support for this kind of formatting. At first I was going to propose to get rid of the divs and move the formatting (width and height) directly on the TD, but I tried that and doesn't seem to solve the problem.

I guess this is not a nice solution, but would it be possible to replace the rowspan cells with more cells with an invisible border between them? However this solution fails if the text is larger than the size of the upper cell.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T12:31:48.387

The choice of Doctype (4.01 Transitional with no system identifier (url)) triggers Quirks mode in IE which makes it highly inconsistent with other browsers.

Switch to:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
```

Or at least:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
```

(and, of course, [validate](http://validator.w3.org/) but the HTML and CSS (which would pick the the missing units on your length values)).

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-13T12:00:19.137

You should definitely go with CSS. Tables should NEVER be used for layout.

# wcf - 具有传输安全性的 WCF 自托管服务（身份验证失败，因为远程方已关闭传输流。）

> ID：197268
> 
> 赞同：3
> 
> 时间：2008-10-13T11:13:18.780
> 
> 标签：wcf, security, self-hosting, netsh

我有一个要添加传输安全性的自托管服务。我已将 WSHttpBinding.SecurityMode 设置为 Transport 并将 ClientCredentialType 设置为 HttpClientCredentialType.None。我已经创建了一个证书并使用 ServiceHost.Credentials.ServiceCertificate.SetCertificate() 将其设置到我的主机我还使用 netsh http add sslcert ipport=127.0.0.1:80 certhash=[MyCertHash] certstorename=MY appid= 注册了它[TheGuidOfTheAppTahtRunsTheService] verifyclientcertrevocation=disable

每当我尝试调用该服务时，都会收到以下错误消息：“身份验证失败，因为远程方已关闭传输流。”

这是否意味着客户端和服务器尝试相互验证？我怎样才能禁用它？为了清楚起见，我不想在客户端安装证书，我不是在寻找任何身份验证 atm，只是保护消息内容，如果可能的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T14:18:51.947

这个 MSDN[帖子](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/ca954f2c-4015-41b9-bc6b-81a6c901b6c2/)可能有助于解决您的问题。帖子中的初始请求是配置与您的安全模式不同的安全模式，但它们会切换到传输模式以进行故障排除，并且该信息应适用于您的情况。

如果您所描述的是您为安装证书所做的一切，那么您缺少几个步骤。该帖子概述了安装有效证书的过程。祝你好运！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T14:58:30.400

证书有时会让人头疼。您应该始终使用 WCF 做的第一件事是打开跟踪：

[http://msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

然后，您可以使用 SVCTraceViewer 查看您的服务在后台生成的异常，并了解正在发生的事情，这是许多 WCF 问题所必须的。10 次中有 9 次，跟踪会告诉你你需要知道的一切。

另外，请确保客户端和服务器都配置了证书，因为证书需要安装在两台机器上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-15T18:07:19.403

我试图追查同样的错误，并遇到了这篇文章。WCF 跟踪没有帮助，因为错误出现在 HTTP 堆栈中的客户端，而在服务器端，请求在到达 WCF 层之前被拒绝。

我发现我不够彻底。确保满足以下所有条件。我有一些但不是所有这些都正确设置：

1.  服务器的证书颁发者在同一台机器上有一个有效且匹配的颁发可信根 CA。

2.  服务器证书主题名称与机器名称完全匹配，客户端访问的机器名称也匹配（“localhost”与服务器的`Environment.MachineName`值）

3.  服务器证书的指纹已由管理员使用以下命令设置（ `netsh`对较新版本的 Windows 使用等效）

    ```
    httpcfg set ssl -i 0.0.0.0:{port} -h {thumbprint} 
    ```

4.  此客户端在客户端计算机上也具有相同的有效颁发根 CA 证书。

这是一个很好的参考：[SSL with Self-hosted WCF Service](http://www.codeproject.com/KB/WCF/WCFSSL.aspx)。

# c# - 在 Castle Windsor 组件注册的上下文中，什么是“ForwardedTypes”？

> ID：197274
> 
> 赞同：16
> 
> 时间：2008-10-13T11:16:02.003
> 
> 标签：c#, inversion-of-control, castle-windsor

正如题主所说，真的！他们在做什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-23T18:48:32.893

转发类型允许您通过单个实现实现多个服务，例如，我们有两个接口用于处理某种树节点：

```
public interface INodeAlterationProvider { ... }
public interface IChildNodeListProvider { ... } 
```

并且各种组件依赖于这些接口中的一个或两个。然而，在实现这些接口中的每一个时，您会发现它们有很多共享功能，并且希望将实现与其他一些功能合并到一个类中，例如：

```
public class NodeFactory : INodeAlterationProvider, IChildNodeListProvider { ... } 
```

您可以注册两个 NodeFactory 实例，一个用于它们实现的每个服务：

```
container.Register(Component.For<INodeAlterationProvider>().ImplementedBy<NodeFactory>());
container.Register(Component.For<IChildNodeListProvider>().ImplementedBy<NodeFactory>()); 
```

但这可能意味着存在两个 NodeFactory 的单例实例 - 并不理想，尤其是在构建成本高昂的情况下 - 并且可能使调试等更难理解，尤其是在实现两个以上接口的情况下。

这是转发类型介入的地方，允许您将多个服务转发到同一个实现，这是一个这样做的例子：

```
container.Register(Component.For<INodeAlterationProvider>().Forward<IChildNodeListProvider>().ImplementedBy<NodeFactory>()); 
```

注意：此处显示的组件注册码仅在中继上可用。

# mysql - 我是否应该将带有 latin1_swedish_ci 排序规则的 MySQL 数据库迁移到 utf-8，如果是，如何迁移？

> ID：197275
> 
> 赞同：7
> 
> 时间：2008-10-13T11:16:19.053
> 
> 标签：mysql, ruby-on-rails, character-encoding

我的 Rails 应用程序使用的 MySQL 数据库当前具有默认排序规则`latin1_swedish_ci`. `utf8_general_ci`由于 Rails 应用程序（包括我的）的默认字符集是 UTF-8，因此在数据库中使用排序规则对我来说似乎是明智的。

我的想法正确吗？

假设是，将排序规则*和数据库中的所有数据*迁移到新编码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T15:24:19.380

UTF-8 以及任何其他 Unicode 编码方案可以存储任何语言的字符，因此它是数据库代码页的绝佳选择。

另一方面，排序规则设置是与编码方案完全不同的问题。它涉及排序顺序、大写/小写转换、字符串相等比较以及诸如特定于语言的内容。排序规则设置应与数据库中使用的语言相匹配。

UTF-8 通用排序规则（我在这里假设——我特别不熟悉 MySQL）用于语言未知且需要一些简单的默认排序的情况。它可能对应于 Unicode 代码点顺序，如果您存储瑞典语，这几乎肯定不是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:52:04.937

转换为 UTF-8 作为字符集。

排序规则设置仅用于排序和类似的东西。选择大多数用户期望的排序规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T20:14:31.540

提供数据库中的现有数据以 latin1 正确编码，将表转换为 utf8（使用 ALTER TABLE，如文档中所述）应该可以正常工作。

然后你的应用程序需要做的就是继续做它以前做过的任何事情。如果你的应用程序想要使用 unicode 字符，它应该将其连接编码设置为 utf8 并使用 utf8，但这是它自己的问题。

* * *

问题是，历史上大量的垃圾网络应用程序将utf8数据发送到mysql并告诉它把它当作latin1。MySQL 将完全遵守这一点，并按照指示将垃圾保存到表中。

将表格从 latin1 转换为 utf8 将无法修复此错误，因为您确实确实有垃圾。修复它们并非易事，尤其是在应用程序的生命周期中，它一直在向数据库发送不同类型的垃圾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-26T11:57:14.400

使用下面的 mysql 查询来转换您的列：

```
ALTER TABLE users MODIFY description VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci; 
```

要查看有关您的表的完整详细信息：

```
SHOW FULL COLUMNS FROM users; 
```

# c# - 当还有专门的服务类型时，使用 Castle Windsor 的流畅接口在装饰器链中注册组件？

> ID：197278
> 
> 赞同：2
> 
> 时间：2008-10-13T11:18:25.273
> 
> 标签：c#, generics, inversion-of-control, castle-windsor

我正在尝试为基于 IRepository 的数据访问实现装饰器链。我有一个进行数据访问的存储库（目前只是内存列表）{1}，我有一个进行验证的存储库 {2}。最重要的是，我有一个专门的存储库 IUsersRepository {3}，它在基本接口上定义了另一个方法。我正在运行最新的主干修订版 5376。

我希望能够使用流利的接口注册我的组件 - 是否可以通过 XML 指定用作 innerRepo 的服务键？如果是这样，怎么做？（有关 XML 配置示例，请参阅[Bitter Coder Decorator 教程）。](http://blog.bittercoder.com/PermaLink,guid,4863e460-2985-475c-9266-80b4895e80de.aspx)我宁愿不需要依赖注册的顺序，除此之外。

我正在关注[这篇博文](http://blog.bittercoder.com/PermaLink,guid,63653be2-d0d4-4a0b-b3e5-a1572aad5c8b.aspx)。

如果我向容器询问 IRepository {4}，我已经能够让装饰器链工作；我看到我的 ValidatingRepository 方法在我的数据访问之前被调用。但是，如果我向容器询问 IUserRepository （我得到一个 InvalidCastException - 我想这是预期的，但它可以解决吗？），我无法让它工作。

我想避免在我的服务中使用一个装饰存储库和一个专用方法存储库；这让我觉得很容易出错。目前，我的专门方法都与通过不同标准获取实体有关 - 我想我可以让我的 Get 方法采用分离标准 - 这将允许我在我的界面上只有一个，并消除对专门的接口。除了我不允许，因为我们还没有决定绝对使用 NHibernate。也许如果我让 IRepo.Get 接受委托或 IQueryable？有任何想法吗？我整个早上都在努力解决这个问题，如果我有狭隘的视野也不会感到惊讶，而且还有一种不同的、更好的方法；欢迎任何建议！

{1} - {4} 可以在[utilitybase](http://utilitybase.com/paste/9003)的复制/粘贴工具中看到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T02:30:37.647

[在这里](http://groups.google.com/group/castle-project-users/browse_thread/thread/35d6543b3519a2d3)交叉发布（带有解决方案）。

# php - 虚拟 360º，拼接和演示软件，用于 PHP 驱动的网站？

> ID：197290
> 
> 赞同：2
> 
> 时间：2008-10-13T11:27:40.857
> 
> 标签：php, flash, lamp, java-3d, vrml

**编辑（在第一个答案之后）：**

任何人都可以通过指向在网站上创建和演示 3D 环境（真实房间）的一些好的参考资料来提供帮助。

理想情况下，它不会涉及太多费用或太高的学习曲线，因为这是一个小型项目的一次性要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T11:31:41.457

[VRML](http://en.wikipedia.org/wiki/VRML)、[Java3D](https://java3d.dev.java.net/)或 Flash 取决于您的冒险精神。

请参阅[Papervision3D](http://www.papervision3d.org/)（[全景演示](http://www.papervision3d.org/demos/panorama/)）和[360 度自由度](http://www.360dof.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T12:26:14.530

嗯...我不确定我是否明白你到底想知道什么。但是，既然我做了一个类似的网站（[panoye](http://www.panoye.com)和[ela](http://www.gallery-ela-porec.com)），我会尽量回应......

有许多不同的方法可以显示全景，java 小程序（ptviewer，非常简单，但它是 java），javascript（不适合球形图像，因为它不能处理等角全景图失真）和 flash。我使用 javascript 和 flashpanoramas flash 查看器。使用 flashpanoramas，您的 php 脚本必须为所有全景图创建 XML 文件。

对于球形全景图 - 我认为闪光灯是一种方式。但是，您的全景图应该是立方的，而不是等矩形的。

无论如何，我不确定是否有一种快速简便的方法......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T12:26:33.687

如果您正在寻找免费工具， panotools ，尤其是 hugin 套件非常[好](http://wiki.panotools.org/)[。](http://hugin.sourceforge.net/)观众也可以在[这里找到](http://wiki.panotools.org/Panorama_Viewers)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T06:20:02.230

Check the stores and gallery i'm operating at [enjoy3d.com](http://enjoy3d.com) .. They use various implementations of Papervision3D. I have developed a toolset and art-pipeline that allows me to create a rich immersive environment in less than a week. And I am currently working on new tech that can handle an 'endless' world with unbounded quantities of content.

I'd also take a look at [Alternativa3D](http://blog.alternativaplatform.com/en/) if you don't mind paying for licensing

# sql - 按间隔分组

> ID：197291
> 
> 赞同：17
> 
> 时间：2008-10-13T11:28:06.067
> 
> 标签：sql, mysql

给定一个包含数字字段 (mynum) 的表 (mytable)，如何编写一个 SQL 查询，根据该字段中的值范围而不是每个不同的值来汇总表的数据？

为了一个更具体的例子，让我们把它设为 3 的间隔，并用一个 count(*) 来“总结”，这样结果就会告诉 mynum 为 0-2.99 的行数，它是 3 的行数-5.99，它是 6-8.99，等等。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-13T11:33:20.877

这个想法是计算在你想要的每个组中具有恒定值的字段的一些函数：

```
select count(*), round(mynum/3.0) foo from mytable group by foo; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T11:46:06.030

我不知道这是否适用于 mySql，无论如何在 SQL Server 中，我认为您可以在选择列表和 group by 列表中“简单地”使用 group by。

就像是：

```
select 
    CASE 
        WHEN id <= 20 THEN 'lessthan20' 
        WHEN id >  20 and id <= 30 THEN '20and30' ELSE 'morethan30' END,
    count(*) 
from Profiles 
where 1=1 
group by 
    CASE 
        WHEN id <= 20 THEN 'lessthan20' 
        WHEN id >  20 and id <= 30 THEN '20and30' ELSE 'morethan30' END 
```

返回类似的东西

```
 column1     column2    
 ----------  ---------- 
 20and30     3          
 lessthan20  3          
 morethan30  13 
```

# c# - LINQ 问题：无法将“System.Reflection.Module”类型的对象转换为“System.Reflection.Emit.ModuleBuilder”类型

> ID：197294
> 
> 赞同：4
> 
> 时间：2008-10-13T11:28:51.087
> 
> 标签：c#, linq

我有一个简单的 lambda 表达式，它作为 UNIT 测试运行良好，当我将代码复制到应用程序的 Main 方法中时也运行良好。但是，当我在回调方法中（通过 JMS courier）运行相同的代码时，我得到了上述错误。有没有人遇到过这个？

示例代码失败：

```
Expression<Func<JupiterDividend, bool>> expr = v => true;
expr.Compile();  // This is what fails 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T12:05:50.670

当 ModuleBuilder 已经“编译”或 TypeBuilder 已经“编译”时，通常会出现这种错误。

我会检查这些事情发生在哪里。此外，在这种情况下，堆栈跟踪可能会很方便。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-16T08:25:49.833

[这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=338242)有一个错误报告，但不确定是否与您遇到的问题相同。显然，这已在 .NET 3.5 SP1 中得到修复。

# c# - 你如何设计一个返回（理论上）无限数量的项目的枚举器？

> ID：197297
> 
> 赞同：6
> 
> 时间：2008-10-13T11:31:39.507
> 
> 标签：c#, enumerator

我正在编写类似于此的代码：

```
public IEnumerable<T> Unfold<T>(this T seed)
{
    while (true)
    {
        yield return [next (T)object in custom sequence];
    }
} 
```

显然，这种方法永远不会返回。（C# 编译器默默地允许这样做，而 R# 给我警告*“函数永远不会返回”*。）

一般来说，提供一个返回无限数量项目的枚举器，而不提供停止枚举的方法，是不是*糟糕的设计？*

这种情况有什么特殊的考虑吗？内存？性能？其他陷阱？

如果我们总是提供退出条件，有哪些选项？例如：

*   表示包含或排除边界的 T 类型对象
*   一个`Predicate<T> continue`（一样`TakeWhile`）
*   一个计数（就像`Take`这样）
*   ...

我们应该依赖用户调用`Take(...)`/ `TakeWhile(...)`after`Unfold(...)`吗？（也许是首选选项，因为它利用了现有的 Linq 知识。）

如果代码将按原样（通用）或作为此模式的特定实现在公共 API 中发布，您会以不同的方式回答这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T11:33:20.017

只要您非常清楚地记录该方法永远不会完成迭代（当然，该方法本身返回得非常快），那么我认为这很好。事实上，它可以使一些算法更加整洁。我不相信有任何显着的内存/性能影响 - 尽管如果您在迭代器中引用“昂贵”对象，该引用将被捕获。

总是有滥用 API 的方法：只要您的文档清晰，我认为没问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T11:47:18.337

> “一般来说，提供一个返回无限数量项目的枚举器，而不提供停止枚举的方法是不是很糟糕？”

代码的使用者**总是**可以停止枚举（例如使用 break 或其他方式）。如果您的枚举器返回并且无限序列，这并不意味着枚举器的客户端以某种方式被迫永远不会破坏枚举，实际上您无法创建一个保证由客户端完全枚举的枚举器。

> 我们应该依赖用户在 Unfold(...) 之后调用 Take(...) / TakeWhile(...) 吗？（也许是首选选项，因为它利用了现有的 Linq 知识。）

是的，只要您在文档中明确指定枚举器返回并且无限序列和枚举中断是调用者的责任，一切都应该没问题。

返回无限序列并不是一个坏主意，函数式编程语言已经这样做了很长时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T12:03:17.273

我同意乔恩的观点。编译器将您的方法转换为实现简单状态机的类，该状态机保持对当前值的引用（即，将通过 Current 属性返回的值）。我多次使用这种方法来简化代码。如果您清楚地记录方法的行为，它应该可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T12:15:20.713

I would not use an infinite enumerator in a public API. C# programmers, myself included, are too used to the foreach loop. This would also be consistent with the .NET Framework; notice how the Enumerable.Range and Enumerable.Repeat methods take an argument to limit the number of items in the Enumerable. Microsoft chose to use Enumerable.Repeat(" ", 10) instead of Enumerable.Repeat(" ").Take(10) to avoid the infinite enumeration and I would adhere to their design choices.

# c# - 如何在 C# 中取消设置变量？

> ID：197302
> 
> 赞同：26
> 
> 时间：2008-10-13T11:33:54.867
> 
> 标签：c#

如何取消设置变量？例如，PHP 有一个`unset($var)`函数。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-13T11:47:06.027

没有真正等同于“未设置”的东西。

我所知道的最接近的匹配是使用[默认](http://msdn.microsoft.com/en-us/library/xwth0h0d(VS.80).aspx)关键字。

例如：

```
MyType myvar = default(MyType);
string a = default(string); 
```

该变量仍将被“设置”，但将具有其默认值。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-13T11:35:29.000

你不能。没有“取消设置”变量的概念。您可以将其设置为不同的值 - 0、null 或任何合适的值。实例/静态变量甚至没有变量是否设置/取消设置的概念，局部变量只有“确定分配”或“未确定分配”。

你想达到什么目的？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-13T11:47:09.100

通常将其设置为 null 可以完成这项工作（对于像 int 这样的类型的变量，您必须将其设为可为空的版本 int？）。

如果您只想在较大的函数中短时间使用该变量，则可以将其作用域，如下所示：

```
{
    int i = 2;
} 
```

该变量只会持续到右大括号。

如果这些不涵盖您的情况，那么您能否详细说明您需要在哪里执行此操作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-13T11:40:07.257

也许您想释放变量引用的*对象*：

```
MyVar = null; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-13T11:56:55.867

值类型变量不需要取消设置。它们是永久分配的。

对于引用类型的变量，您只需将它们设置为*null*，垃圾收集器就会销毁关联的对象（并释放内存）。但请注意，变量本身将在其范围内继续存在（代码块、方法、对象生命......）

如果您想使用它来释放内存，那么只需将所有不需要的对象设置为 null 并等待垃圾收集器完成其工作。

**编辑**：正如评论中所指出的，我说垃圾收集器不会立即开始收集。这通常会在框架尝试分配内存但找不到足够的空闲空间时发生。可以“手动”启动垃圾收集，但这是不可取的，并且可能会恶化程序的行为。大多数情况下，GC 的默认行为就足够了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-19T14:02:01.477

要取消设置环境变量，请使用相同的 Environment.SetEnvironmentVariable 方法，但将 null 或 string.Empty 作为值传递[http://msdn.microsoft.com/en-us/library/96xafkes(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/96xafkes(v=vs.110).aspx)

> “如果value为空且变量命名的环境变量存在，则删除该环境变量。”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T11:59:25.970

对于对象，您可以将其设置为 null，最好将字符串设置为 String.Empty，或者您可以将变量声明为可为空，例如：

```
int? i = null; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T13:46:53.117

您可以为该变量定义一个范围。当范围退出时，将不再定义变量：

```
System.Console.WriteLine("let's give this a try: ");
{
    int j = 0;
    System.Console.WriteLine(j);
}
//Won't compile with the following line.
//System.Console.WriteLine(j); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-06T10:56:37.837

我个人只是去

**变量 = 无**

这似乎可以释放资源，尤其是在使用手机时！

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-01-11T21:12:31.217

我认为你需要做到这一点`null`，并这样做：

```
int? Foo = 5;
Foo = null; 
```

# mysql - Mac OSX 上的本地 Rails 失去与 mysql 的连接

> ID：197304
> 
> 赞同：3
> 
> 时间：2008-10-13T11:34:54.867
> 
> 标签：mysql, ruby-on-rails, macos

有时，我的本地 Rails 应用程序会失去与 MySQL 的连接。我收到一些连接失败的错误，但如果我只是刷新页面，它就可以正常工作。这在我的 STAGE 或 PROD 环境（我部署到 Ubuntu）中从未发生过，所以这没什么大不了的。
这会发生在其他人身上吗？有什么我可以解决的吗？是 MySQL 还是 Ruby？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T12:46:52.630

看起来最好的解决方案是安装平台特定的 mysql 驱动程序。
`sudo gem install mysql`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:34:01.120

我记得不久前遇到过这个问题（在我升级到 Leopard 之前？）。它们很难诊断，但请查看日志文件，并尝试将“wait_timeout”设置更长的时间（您不必弄乱“max_connections”。请参阅：

[http://www.mysqlperformanceblog.com/2008/08/23/how-to-track-down-the-source-of-aborted_connects/](http://www.mysqlperformanceblog.com/2008/08/23/how-to-track-down-the-source-of-aborted_connects/)

[http://dev.mysql.com/doc/refman/5.0/en/communication-errors.html](http://dev.mysql.com/doc/refman/5.0/en/communication-errors.html)

[http://www.softwareprojects.com/resources/programming/t-how-to-fix-mysql-database-myisam-innodb-1634.html](http://www.softwareprojects.com/resources/programming/t-how-to-fix-mysql-database-myisam-innodb-1634.html)

我*想*我跟着 Dan Benjamin 的 MySql 安装博客没有问题：

[http://hivelogic.com/articles/installing-mysql-on-mac-os-x/](http://hivelogic.com/articles/installing-mysql-on-mac-os-x/)

# sql-server - 在 sql server 中搜索 varchar 列的最佳方法

> ID：197307
> 
> 赞同：5
> 
> 时间：2008-10-13T11:37:02.600
> 
> 标签：sql-server, search

您会建议在 sql server 表（varchar(max) 列）中搜索一个术语吗？

比方说，就像在 ebay 中一样，如果您搜索“wii 全新”，您会得到“全新 Nintendo Wii Fit 游戏 + 平衡板捆绑包”、“Wii Fit (Wii) 全新 WII FIT 游戏 + 平衡板”等结果。

我认为它基本上搜索每个单词并返回包含所有单词的单词，你会推荐什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T11:40:13.747

您正在寻找全文索引，它允许您进行比正则表达式等更高级的查询。

查看[这篇](http://www.developer.com/db/article.php/3446891)文章以获得快速介绍，这些说明适用于 SQL Server 2000，与 2005 或 2008 相比，它的设置要困难一些。

相关报价：

```
通过全文搜索，您可以执行许多其他类型的搜索：

 *彼此靠近的两个词
 * 任何源自特定词根的词（例如 run、ran 或 running）
 *具有不同权重的多个单词
 * 接近搜索词或词组的词或词组

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T11:40:42.077

取决于你想要做什么。对于一个简单的搜索，你可以这样做 `select * from table where field like '%word%'`。但如果这是某种应用程序功能，您需要查看完整的春节搜索应用程序。它可以将出现在该字段中的单词存储为索引，然后搜索这些单词而不是使用该字段。

# language-agnostic - 设计问题：如何透明地访问 IPC 机制？

> ID：197310
> 
> 赞同：0
> 
> 时间：2008-10-13T11:38:30.100
> 
> 标签：language-agnostic, design-patterns, ipc, soa, rpc

我想这样做（没有特定的语言）：

```
print(foo.objects.bookdb.books[12].title); 
```

或这个：

```
book = foo.objects.bookdb.book.new();
book.title = 'RPC for Dummies';
book.save(); 
```

foo 实际上是一个通过 IPC 连接到我的程序的服务，为了访问它的方法和对象，某些层实际上通过网络发送和接收消息。

现在，我并不是真的在寻找 IPC 机制，因为有很多可供选择。它可能不是基于 XML，而是基于 s. th。像 Google 的协议缓冲区、dbus 或 CORBA。我不确定的是如何构建应用程序，以便我可以像访问任何对象一样访问 IPC。

换句话说，我怎样才能拥有透明地映射到进程边界的 OOP？

并不是说这是一个设计问题，我仍然在整体架构的一个相当高的水平上工作。所以我对这将使用哪种语言非常不可知。不过，C#、Java 和 Python 都可能会被使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T11:44:24.677

我认为做你所要求的方法是将所有对象通信视为消息传递。这就是在 ruby​​ 和 smalltalk 等中处理对象方法的方式。

使用消息传递（而不是方法调用）作为您的对象通信机制，然后调用诸如在您编写代码时不存在的方法之类的操作变得明智，因为对象无论如何都可以对消息做一些明智的事情（检查远程过程，从数据库中返回具有相同名称的字段的值等，或抛出“未找到方法”异常，或您能想到的任何其他内容）。

重要的是要注意，对于不使用它作为默认机制的语言，无论如何您都可以进行消息传递（每个对象都有一个 'handleMessage' 方法），但您不会获得语法细节，而且您不会无需您付出额外努力即可获得 IDE 帮助，以使 IDE 解析您的 handleMessage 方法以检查有效输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T02:15:03.917

阅读 Java 的[RMI——](http://java.sun.com/docs/books/tutorial/rmi/overview.html)介绍性材料展示了如何对远程对象进行本地定义。

诀窍是让两个类具有相同的方法签名。该类的本地版本是某些网络协议的外观。远程版本通过网络接收请求并执行对象的实际工作。

您可以定义一对类，以便客户端可以拥有

```
foo= NonLocalFoo( "http://host:port" )
foo.this= "that"
foo.save() 
```

服务器从客户端连接接收 set_this() 和 save() 方法请求。服务器端（通常）很重要，因为您有一堆发现和实例管理问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-13T12:22:41.760

你不应该这样做！程序员在代码中看到和感受 IPC/RPC 和本地方法调用之间的区别是非常重要的。如果你这样做，他们就不必考虑它，他们就不会考虑它，这将导致代码性能很差。

考虑到：

```
foreach o, o.isGreen in someList { 
   o.makeBlue; 
} 
```

程序员假设循环需要几纳秒才能完成，相反，如果 someList 恰好是远程的，则需要接近一秒。

# php - Kohana PHP、ORM 和 MySQL BLOB

> ID：197319
> 
> 赞同：3
> 
> 时间：2008-10-13T11:43:28.327
> 
> 标签：php, mysql, orm, kohana, blob

我正在尝试通过 Kohana 的 ORM 库在 MySQL 表中创建和检索 BLOB。

代码看起来像：

```
$attachment = new Attachment_Model();
$attachment->name = $info['FileName'];
$attachment->size = strlen($info['Data']);
$attachment->data = $info['Data'];
$attachment->mime_type = $info['content-type'];
$attachment->save(); 
```

我已经通过将数据输出到文件来验证此时数据是否正常。但是，当我检索数据时，它会损坏。我已经设法进一步缩小范围 - 我使用 MySQL 查询工具来提取数据库中保存的数据，并且我可以验证数据库中的数据是否已损坏，因此问题一定出在 INSERT .

此外，输入的文件并不总是损坏 - 较小的文件（例如图像）往往没问题。

有人有想法么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T12:09:24.283

事实证明，在这种情况下，我使用的是 BLOB 数据类型。

BLOB 数据类型在 65535 个字符处截断数据（静默，不会抛出错误！）

我已经将它提升到 MEDIUMBLOB（最大长度为 16777215 个字符），它似乎工作正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T12:05:12.667

胡乱猜测，但是：可能是因为 kohana 模型层将所有数据作为字符数据而不是二进制数据插入，这会给您在保存/检索 BLOB 对象时带来麻烦。

# windows - 在 Windows 上获取 DNS 服务器

> ID：197344
> 
> 赞同：2
> 
> 时间：2008-10-13T12:03:42.123
> 
> 标签：windows, winapi, dns

我正在使用 DnsQueryConfig Win32 函数来获取 Windows 使用的 DNS 服务器。这适用于 IPv4 地址，但如果 DNS 服务器有 IPv6 地址怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-28T05:18:15.470

我在 MSDN 中找不到 API，但我确实找到了这一行命令：

> [IPv6 dp6dns](http://msdn.microsoft.com/en-us/library/aa916844.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T13:59:03.187

你指的是哪个版本的Windows？

至少在 Windows XP 中，不支持通过 IPv6 传输查询 DNS 服务器，所以这个问题没有实际意义。

我不知道这是否已在 Vista 中修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T15:25:46.137

我不熟悉那个 Win32 功能。如果您想要 IPv6 地址，则需要查找“AAAA”DNS 记录与“A”记录。希望这可以帮助一些...

# javascript - Flash 组织结构图

> ID：197345
> 
> 赞同：2
> 
> 时间：2008-10-13T12:03:45.620
> 
> 标签：javascript, jquery, flash, charts

我一直在寻找一个可以在 flash 和/或 javascript（最好是 jQuery）中呈现组织结构图的库。我知道几个 javascript 和/或 flash 图表库，但似乎没有一个能够呈现这样的组织结构图：[http ://www.fsai.ie/images/org_chart.gif](http://www.fsai.ie/images/org_chart.gif)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T12:57:08.787

[iLog Elixir](http://www.adobe.com/products/flex/ilogelixir/)似乎在 Flash/Flex 中具有您正在寻找的东西。不过，这是一种商业产品，而且相当昂贵。我还发现了[这些博客文章](http://blogs.ilog.com/elixir/category/ilog-elixir/org-chart/)（显然是他们开发团队的人写的），您可以在其中看到一些组织结构图是如何在他们的产品中实现的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-15T01:21:08.040

我试过[Google Org Chart](http://code.google.com/apis/chart/interactive/docs/gallery/orgchart.html)。它是免费的，而且使用起来非常简单。我用它在 SharePoint 中创建了一个动态组织结构图。它有一些[问题](http://code.google.com/p/google-visualization-api-issues/issues/list?can=2&q=org%20chart&sort=-stars&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary%20Stars)。但总的来说我对它很满意。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-13T15:10:25.977

你有没有考虑过嵌入像 gliffy 这样的东西？它有自己的版本控制和编辑。您是否需要只渲染已经创建的内容或启用 visio 创建？

# php - 如何将 PHPList 与现有站点集成

> ID：197353
> 
> 赞同：2
> 
> 时间：2008-10-13T12:06:39.107
> 
> 标签：php, integrate, phplist

现有站点在数据库中有自己的“用户”表。我想知道如何将 PHPList 与现有站点集成，以便用户可以在注册期间查看时事通讯。我通过 cpanel 安装了 phplist。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T12:21:49.140

PHPList 允许您定义表前缀以避免名称冲突

请参阅“使用数据库前缀”：[http ://docs.phplist.com/PhpListConfigDatabase](http://docs.phplist.com/PhpListConfigDatabase)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-13T22:50:35.227

我的解决方案是通过每日运行脚本和在主站点中修改用户帐户时按需手动保持两个表同步。我不会将更改从 phplist 传播到主应用程序。

# asp.net - 仅使用用户名的 ASP.NET 表单身份验证

> ID：197357
> 
> 赞同：0
> 
> 时间：2008-10-13T12:09:31.740
> 
> 标签：asp.net, security, asp.net-membership, membership

我手头有点混合情况。我正在编写一个 Intranet asp.net Web 应用程序。我不想使用完整的 Windows 身份验证，因为我没有在 Active Directory 中设置适当的组，无法仅根据用户所在的组对用户进行身份验证。到目前为止，我已经创建了一个成员数据库，并根据用户的 NT 登录名手动验证用户。该应用程序变得越来越复杂，我正在考虑使用 Membership 和 Roles 提供程序来验证用户身份。这是我的问题：我希望能够仅基于 NT 对用户进行身份验证，但我不想使用 Windows 身份验证。我想编写自己的提供程序以插入成员资格和角色提供程序，并使用表单身份验证，但使其透明。基于用户表，我希望能够仅根据他们的 NT 对用户进行身份验证或重定向他们。这是可能的，还是我坚持编写自己的小框架来完成这个？如果可能的话，我想利用提供者框架。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T20:18:01.660

将您的 web.config 设置为使用表单身份验证。
确保在 IIS 中打开了集成身份验证（您可能还需要禁用匿名）。这将允许您获取用户的 NT 名称。

您可以通过以下方式获取用户的 NT 名称：

```
 Request.ServerVariables["LOGON_USER"] 
```

您可以使用以下命令登录用户，无需密码：

```
 FormsAuthentication.RedirectFromLoginPage( userName, false ); 
```

# sql - 选择类别属于层次结构中任何类别的产品

> ID：197362
> 
> 赞同：8
> 
> 时间：2008-10-13T12:10:41.393
> 
> 标签：sql, sql-server, select, hierarchy

我有一个产品表，其中包含一个类别的 FK，类别表的创建方式是每个类别都可以有一个父类别，例如：

```
Computers
    Processors
        Intel
            Pentium
            Core 2 Duo
        AMD
            Athlon 
```

我需要进行选择查询，如果选择的类别是处理器，它将返回英特尔、奔腾、酷睿 2 双核、AMD 等的产品...

我考虑创建某种“缓存”，它将为数据库中的每个类别存储层次结构中的所有类别，并在 where 子句中包含“IN”。这是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T13:35:55.573

最好的解决方案是在数据库设计阶段。您的类别表需要是一个*嵌套集*。这篇文章[在 MySQL 中管理层次结构数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)并不是 MySQL 特有的（尽管有标题），它很好地概述了在数据库表中存储层次结构的不同方法。

# 执行摘要：

## 嵌套集

*   任何深度的选择都很容易
*   插入和删除很难

## 基于标准 parent_id 的层次结构

*   选择是基于内部连接的（所以很快就会变得毛茸茸的）
*   插入和删除很容易

因此，根据您的示例，如果您的层次结构表是嵌套集，您的查询将如下所示：

```
SELECT * FROM products 
   INNER JOIN categories ON categories.id = products.category_id 
WHERE categories.lft > 2 and categories.rgt < 11 
```

2 和 11 分别是`Processors`记录的左侧和右侧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T13:35:16.120

看起来像是公共表表达式的工作.. 类似于：

```
with catCTE (catid, parentid)
as
(
select cat.catid, cat.catparentid from cat where cat.name = 'Processors'
UNION ALL
select cat.catid, cat.catparentid from cat inner join catCTE on cat.catparentid=catcte.catid
)
select distinct * from catCTE 
```

这应该选择名称为“处理器”的类别及其任何后代，应该能够在 IN 子句中使用它来拉回产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T12:20:13.137

我过去做过类似的事情，首先查询类别 id，然后查询这些类别的产品“IN”。获得类别是困难的，你有几个选择：

*   如果类别的嵌套级别是已知的，或者您可以找到一个上限：构建一个包含大量 JOIN 的看起来很糟糕的 SELECT。这很快，但很难看，您需要对层次结构的级别设置限制。
*   如果您的总类别数量相对较少，请全部查询（仅 ids、parents），收集您关心的类别的 id，然后为产品执行 SELECT....IN。这对我来说是合适的选择。
*   使用一系列 SELECT 向上/向下查询层次结构。简单，但相对较慢。
*   我相信最新版本的 SQLServer 对递归查询有一些支持，但我自己并没有使用它们。

如果您不想在应用程序端执行此操作，存储过程可以提供帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T12:24:08.900

您要找到的是类别“父”关系的传递闭包。我想类别层次结构深度没有限制，因此您无法制定一个查找所有类别的 SQL 查询。我会做的（在伪代码中）是这样的：

```
categoriesSet = empty set
while new.size > 0:
  new = select * from categories where parent in categoriesSet
  categoriesSet = categoriesSet+new 
```

因此，请继续查询孩子，直到找不到更多孩子。这在速度方面表现良好，除非您有退化的层次结构（例如，1000 个类别，每个类别都是另一个的子类别）或大量的总类别。在第二种情况下，您始终可以使用临时表来保持应用程序和数据库之间的数据传输较小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T12:28:13.620

也许是这样的：

```
select *
from products
where products.category_id IN
  (select c2.category_id 
   from categories c1 inner join categories c2 on c1.category_id = c2.parent_id
   where c1.category = 'Processors'
   group by c2.category_id) 
```

[编辑] 如果类别深度大于一，这将形成您最里面的查询。我怀疑您可以设计一个存储过程，该过程将在表中向下钻取，直到内部查询返回的 id 没有子级 - 最好有一个属性将类别标记为层次结构中的终端节点 - 然后对这些 id 执行外部查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T12:56:45.620

```
CREATE TABLE #categories (id INT NOT NULL, parentId INT, [name] NVARCHAR(100))
INSERT INTO #categories
    SELECT 1, NULL, 'Computers'
    UNION
SELECT 2, 1, 'Processors'
    UNION
SELECT 3, 2, 'Intel'
    UNION
SELECT 4, 2, 'AMD'
    UNION
SELECT 5, 3, 'Pentium'
    UNION
SELECT 6, 3, 'Core 2 Duo'
    UNION
SELECT 7, 4, 'Athlon'
SELECT * 
    FROM #categories
DECLARE @id INT
    SET @id = 2
            ; WITH r(id, parentid, [name]) AS (
    SELECT id, parentid, [name] 
        FROM #categories c 
        WHERE id = @id
        UNION ALL
    SELECT c.id, c.parentid, c.[name] 
        FROM #categories c  JOIN r ON c.parentid=r.id
    )
SELECT * 
    FROM products 
    WHERE p.productd IN
(SELECT id 
    FROM r)
DROP TABLE #categories 
```

如果您像这样直接运行该示例的最后一部分，则实际上并不能正常工作。只需从产品中删除选择并用简单的 SELECT * FROM r 替换

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T13:40:41.867

这应该从给定类别开始递归所有“子”类别。

```
DECLARE @startingCatagoryId int
DECLARE @current int
SET @startingCatagoryId = 13813 -- or whatever the CatagoryId is for 'Processors'

CREATE TABLE #CatagoriesToFindChildrenFor
(CatagoryId int)

CREATE TABLE #CatagoryTree
(CatagoryId int)

INSERT INTO #CatagoriesToFindChildrenFor VALUES (@startingCatagoryId)

WHILE (SELECT count(*) FROM #CatagoriesToFindChildrenFor) > 0
BEGIN
    SET @current = (SELECT TOP 1 * FROM #CatagoriesToFindChildrenFor)

    INSERT INTO #CatagoriesToFindChildrenFor
    SELECT ID FROM Catagory WHERE ParentCatagoryId = @current AND Deleted = 0

    INSERT INTO #CatagoryTree VALUES (@current)
    DELETE #CatagoriesToFindChildrenFor WHERE CatagoryId = @current
END

SELECT * FROM #CatagoryTree ORDER BY CatagoryId

DROP TABLE #CatagoriesToFindChildrenFor
DROP TABLE #CatagoryTree 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T21:56:23.707

我喜欢使用堆栈临时表来存储分层数据。这是一个粗略的例子 -

```
-- create a categories table and fill it with 10 rows (with random parentIds)
CREATE TABLE Categories ( Id uniqueidentifier, ParentId uniqueidentifier )
GO

INSERT
INTO   Categories
SELECT NEWID(),
       NULL 
GO

INSERT
INTO   Categories
SELECT   TOP(1)NEWID(),
         Id
FROM     Categories
ORDER BY Id
GO 9

DECLARE  @lvl INT,            -- holds onto the level as we move throught the hierarchy
         @Id Uniqueidentifier -- the id of the current item in the stack

SET @lvl = 1

CREATE TABLE #stack (item UNIQUEIDENTIFIER, [lvl] INT)
-- we fill fill this table with the ids we want
CREATE TABLE #tmpCategories (Id UNIQUEIDENTIFIER)

-- for this example we’ll just select all the ids 
-- if we want all the children of a specific parent we would include it’s id in
-- this where clause
INSERT INTO #stack SELECT Id, @lvl FROM Categories WHERE ParentId IS NULL

WHILE @lvl > 0
BEGIN -- begin 1

      IF EXISTS ( SELECT * FROM #stack WHERE lvl = @lvl )
      BEGIN -- begin 2

      SELECT @Id = [item]
      FROM #stack
      WHERE lvl = @lvl

      INSERT INTO #tmpCategories
      SELECT @Id

      DELETE FROM #stack
      WHERE lvl = @lvl
      AND item = @Id

      INSERT INTO #stack
      SELECT Id, @lvl + 1
      FROM   Categories
      WHERE  ParentId = @Id

      IF @@ROWCOUNT > 0
      BEGIN -- begin 3
         SELECT @lvl = @lvl + 1
      END -- end 3
   END -- end 2
   ELSE
   SELECT @lvl = @lvl - 1

END -- end 1

DROP TABLE #stack

SELECT * FROM #tmpCategories
DROP TABLE #tmpCategories
DROP TABLE Categories 
```

这里有一个很好的解释[链接文本](http://msdn.microsoft.com/en-us/library/aa172799(SQL.80).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-15T22:08:24.103

几天前我对另一个问题的回答在这里适用... [SQL 中的递归](https://stackoverflow.com/questions/191208/is-recursion-good-in-sql-server#191635)

我已经链接了书中的一些方法，它们应该很好地涵盖您的情况。

# visual-studio-2005 - VS 安装项目：在安装时卸载其他组件

> ID：197365
> 
> 赞同：6
> 
> 时间：2008-10-13T12:13:33.103
> 
> 标签：visual-studio-2005, windows-installer, setup-project

我正在创建一个 Visual Studio 安装项目。我想从我的组件安装中卸载系统中的另一个组件。另一个组件是从我自己使用 Visual Studio 创建的设置中安装的。

目前，当我从组件的安装操作中调用其他组件的卸载时，我收到错误代码：`1618 (another MSI already running)`.

谁能建议我另一种方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T12:32:23.440

如果您不需要实际运行其他组件的卸载，您可以使用自定义操作来删除您打算替换的文件/文件夹。

使用自定义操作将强制您执行卸载程序将为您执行的所有清理操作。

是您正在更换某些东西，还是只是因为安装了完全不同的东西而试图卸载某些东西？

[MSDN 自定义操作演练](http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx "MSDN 自定义操作演练")

我还阅读了 Phil Wilson 的一些文章，这些文章对自定义操作很有帮助：
[Phil Wilson on Custom Actions](http://www.simple-talk.com/dotnet/visual-studio/visual-studio-setup---projects-and-custom-actions/ "Phil Wilson 谈自定义操作")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T17:56:01.243

我遇到了一个类似的问题，需要多个安装一起运行，并且找不到递归运行 MsiExec 的方法。我使用的解决方案是将安装程序与一个脚本捆绑在一起，该脚本将运行 MsiExec 一次以安装/卸载旧软件包，然后再次运行新的安装程序。客户端必须运行脚本才能安装。

如果你找到更好的方法，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T03:55:36.143

我认为您可以`uninst.exe`在安装程序开始时通过 shell 命令运行该程序.....

# sql - 有用（困难）的 SQL 脚本库

> ID：197369
> 
> 赞同：68
> 
> 时间：2008-10-13T12:18:23.843
> 
> 标签：sql, scripting

有谁知道我在哪里可以找到一个常见但困难（不同寻常）的 SQL 脚本示例库。我说的是那些您在文档中找不到但确实需要经常完成诸如查找重复项等任务的示例。

拥有这样方便的东西会大大节省时间。

编辑：谢谢大家，我认为这正在变成一个很好的快速参考。描述性越强，效果就越好，所以如果您看到自己的方式打开，请编辑并添加一些可以找到的描述。非常感谢那些已经这样做的人！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-13T12:37:23.430

您可能会发现[LessThanDot 上的这个 wiki](http://wiki.lessthandot.com/index.php/Category:Microsoft_SQL_Server)很有用，在大多数情况下，它是由 Microsoft SQL MVP Denis Gobo 编写的。

编辑：该 wiki 包含**100 多个 SQL Server Programming Hacks**，我认为该列表太长，无法包含在此处，但是，有一个[综合索引](http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List)。

也可从同一站点获得：[SQL Server Admin Hacks](http://wiki.lessthandot.com/index.php/SQL_Server_Admin_Hacks)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-13T12:22:01.043

这里有一些我觉得非常有用的：

*   [SQL Server 最佳实践](http://technet.microsoft.com/en-us/sqlserver/bb331794.aspx)- Microsoft SQL Server 白皮书和最佳实践
*   [vyaskn](http://vyaskn.tripod.com/) - 从 DBA 到开发人员的各种文章
*   [备份、完整性检查和索引优化](http://blog.ola.hallengren.com/blog/_archives/2008/1/1/3440068.html)
*   [SQLServerCentral Scripts](http://www.sqlservercentral.com/Scripts/) - 大多数 DBA 任务的脚本等等
*   [脚本存储库：SQL Server 2005](http://www.microsoft.com/technet/scriptcenter/scripts/sql/sql2005/default.mspx?mfr=true) - TechNet 脚本中心
*   [用于 SQL Server 2005 性能调整和故障排除的脚本和工具](http://sqlcat.com/toolbox/archive/2008/02/21/scripts-and-tools-for-performance-tuning-and-troubleshooting-sql-server-2005.aspx)
*   [SQL Server 查询处理团队](http://blogs.msdn.com/sqlqueryprocessing/default.aspx)- 来自 MS SQL 优化团队的核心建议
*   [T-SQL 问题的常见解决方案](http://code.msdn.microsoft.com/SQLExamples)
*   [Davide Mauri 的索引脚本](http://www.davidemauri.it/SqlScripts.aspx)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-13T12:40:57.917

## 一些管理的东西

Glenn Berry：[SQL Server 2005 的五个非常有用的索引选择查询](http://glennberrysqlperformance.spaces.live.com/blog/cns!45041418ECCAA960!715.entry)

*   查找整个 SQL Server 实例的“缺失”索引
*   查找单个表的“缺失”索引
*   检查单个表的当前索引结构
*   查看单个表的索引使用情况
*   在整个当前数据库中寻找可能的坏索引
*   深入了解您的工作量（奖励）

SQL Server Central：[七个监控脚本](http://www.sqlservercentral.com/articles/Administering/sevenmonitoringscripts/1024/)

*   失败的作业报告
*   驱动器可用空间
*   残疾人工作
*   运行作业
*   服务器角色成员
*   上次备份日期
*   SQL 日志

最后但并非最不重要的资源：[SQL Server Programming Hacks - 100+ List](http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-13T13:28:20.533

[Joe Celko 的 SQL 谜题和答案](https://rads.stackoverflow.com/amzn/click/com/0123735963)

[SQL 的艺术（轻微的 Oracle 偏见）](https://rads.stackoverflow.com/amzn/click/com/0596008945)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-10-13T13:36:50.050

[Sql Cookbook](http://oreilly.com/catalog/9780596009762/#top)有各种有趣的示例，尽管您选择的 RDBMS 无疑不支持其中一些示例。O'Reilly 也有一本[T-SQL Cookbook](http://oreilly.com/catalog/9781565927568/#top)，但我从未亲自阅读过。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-10T14:23:11.477

直接来自 MS 脚本存储库：SQL Server 2005： [http ://www.microsoft.com/technet/scriptcenter/scripts/sql/sql2005/default.mspx?mfr=true](http://www.microsoft.com/technet/scriptcenter/scripts/sql/sql2005/default.mspx?mfr=true)

奈杰尔非常有用的东西： [http ://www.nigelrivett.net/#TransactSQL](http://www.nigelrivett.net/#TransactSQL)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-13T12:50:38.160

原谅我的自我广告，但我在我的博客 ( [http://progblog.wordpress.com](http://progblog.wordpress.com) ) 上发布了一些，因为我在 SQL 方面很垃圾，它是存储我知道我需要的东西的好地方未来 :-) 如果有人有更实质性的东西，请发帖，我和任何人一样渴望得到这样的东西！

我想“SQL Cookbook”的副本也会有所帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-13T19:54:15.000

我已经为 Oracle 使用过这些 SQL“hacks”了几次。

[连接为分组函数](http://www.oracle.com/technology/oramag/code/tips2006/101606.html)

[在用于连接目的的查询数据生成中](http://www.dba-oracle.com/t_test_data_date_generation_sql.htm)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-16T12:28:17.940

这是 SQL Server 的另一个链接：最佳实践 - 数十个脚本示例

[**http://www.sqlusa.com/bestpractices2005/**](http://www.sqlusa.com/bestpractices2005/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-28T00:03:32.463

[查看 SQLCAT.com（MS SQL 最佳实践团队）](http://www.sqlcat.com "SQL 客户咨询团队最佳实践博客")

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-23T14:51:19.470

引用 Celko 的答案： [SQL For Smarties](https://rads.stackoverflow.com/amzn/click/com/0123693799)。这有很多深入的章节，将增加 SQL Puzzles 书的内容。还有另一本我刚学过的 Celko 书，名为 [Joe Celko's Trees and Hierarchies in SQL for Smarties](https://rads.stackoverflow.com/amzn/click/com/1558609202)。

# java - JUnit 3.x 中的参数化测试用例类

> ID：197372
> 
> 赞同：5
> 
> 时间：2008-10-13T12:18:43.280
> 
> 标签：java, junit

我有一个 JUnit 3.x TestCase，我希望能够对其进行参数化。我想参数化整个`TestCase`（包括夹具）。但是，该`TestSuite.addTestSuite()`方法不允许传递一个`TestCase`对象，只传递一个类：

```
 TestSuite suite = new TestSuite("suite");
   suite.addTestSuite(MyTestCase.class); 
```

我希望能够将参数（字符串）传递给测试运行时创建的 MyTestCase 实例。就像现在一样，我必须为每个参数值设置一个单独的类。

我尝试将它传递给一个任意子类：

```
 MyTestCase testCase = new MyTestCase() {
       String getOption() {
           return "some value";
       }
   }

   suite.addTestSuite(testCase.getClass()); 
```

但是，这会因断言而失败：

```
 ... MyTestSuite$1 has no public constructor TestCase(String name) or TestCase()` 
```

有任何想法吗？我是否以错误的方式解决问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T12:21:06.410

如果这是 Java 5 或更高版本，您可能需要考虑切换到 JUnit 4，它支持内置的参数化测试用例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T14:00:54.790

我不会为您要测试的多个/不同后端创建参数化测试用例，而是考虑让我的测试用例抽象化。API 的每个新实现都需要提供一个实现的 TestCase 类。

如果您目前有一个看起来像的测试方法

```
public void testSomething() {
   API myAPI = new BlahAPI();
   assertNotNull(myAPI.something());
} 
```

只需向返回要使用的特定 API 对象的 TestCase 添加一个抽象方法。

```
public abstract class AbstractTestCase extends TestCase {
    public abstract API getAPIToTest();

    public void testSomething() {
       API myAPI = getAPIToTest();
       assertNotNull(myAPI.something());
    }

    public void testSomethingElse() {
       API myAPI = getAPIToTest();
       assertNotNull(myAPI.somethingElse());
    }
} 
```

然后，您要测试的新实现的 TestCase 只需实现您的 AbstractTestCase 并提供 API 类的具体实现：

```
public class ImplementationXTestCase extends AbstractTestCase{

    public API getAPIToTest() {
        return new ImplementationX();
    }
} 
```

然后在抽象类中测试 API 的所有测试方法都会自动运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T18:42:36.163

好的，这是 JUnit 4 如何运行参数化测试的快速模型，但在 JUnit 3.8.2 中完成。

基本上，我正在继承并严重劫持 TestSuite 类，以根据 testMethods 和参数的叉积填充测试列表。

不幸的是，我不得不从 TestSuite 本身复制几个辅助方法，并且一些细节并不完美，例如 IDE 中的测试名称在参数集之间是相同的（JUnit 4.x 附加`[0]`, `[1]`, .. .)。

尽管如此，这似乎在`TestRunner`JUnit 以及 Eclipse 附带的文本和 AWT 中运行良好。

这是 ParameterizedTestSuite，以及使用它的参数化测试的（愚蠢的）示例。

（最后一点：我在写这个时考虑到了 Java 5，如果需要的话适应 1.4*应该很简单）*

*参数化TestSuite.java：*

```
package junit.parameterized;

import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;
import java.util.ArrayList;
import java.util.Collection;

import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

public class ParameterizedTestSuite extends TestSuite {

    public ParameterizedTestSuite(
            final Class<? extends TestCase> testCaseClass,
            final Collection<Object[]> parameters) {

        setName(testCaseClass.getName());

        final Constructor<?>[] constructors = testCaseClass.getConstructors();
        if (constructors.length != 1) {
            addTest(warning(testCaseClass.getName()
                    + " must have a single public constructor."));
            return;
        }

        final Collection<String> names = getTestMethods(testCaseClass);

        final Constructor<?> constructor = constructors[0];
        final Collection<TestCase> testCaseInstances = new ArrayList<TestCase>();
        try {
            for (final Object[] objects : parameters) {
                for (final String name : names) {
                    TestCase testCase = (TestCase) constructor.newInstance(objects);
                    testCase.setName(name);
                    testCaseInstances.add(testCase);
                }
            }
        } catch (IllegalArgumentException e) {
            addConstructionException(e);
            return;
        } catch (InstantiationException e) {
            addConstructionException(e);
            return;
        } catch (IllegalAccessException e) {
            addConstructionException(e);
            return;
        } catch (InvocationTargetException e) {
            addConstructionException(e);
            return;
        }

        for (final TestCase testCase : testCaseInstances) {
            addTest(testCase);
        }       
    }
    private Collection<String> getTestMethods(
            final Class<? extends TestCase> testCaseClass) {
        Class<?> superClass= testCaseClass;
        final Collection<String> names= new ArrayList<String>();
        while (Test.class.isAssignableFrom(superClass)) {
            Method[] methods= superClass.getDeclaredMethods();
            for (int i= 0; i < methods.length; i++) {
                addTestMethod(methods[i], names, testCaseClass);
            }
            superClass = superClass.getSuperclass();
        }
        return names;
    }
    private void addTestMethod(Method m, Collection<String> names, Class<?> theClass) {
        String name= m.getName();
        if (names.contains(name))
            return;
        if (! isPublicTestMethod(m)) {
            if (isTestMethod(m))
                addTest(warning("Test method isn't public: "+m.getName()));
            return;
        }
        names.add(name);
    }

    private boolean isPublicTestMethod(Method m) {
        return isTestMethod(m) && Modifier.isPublic(m.getModifiers());
     }

    private boolean isTestMethod(Method m) {
        String name= m.getName();
        Class<?>[] parameters= m.getParameterTypes();
        Class<?> returnType= m.getReturnType();
        return parameters.length == 0 && name.startsWith("test") && returnType.equals(Void.TYPE);
     }

    private void addConstructionException(Exception e) {
        addTest(warning("Instantiation of a testCase failed "
                + e.getClass().getName() + " " + e.getMessage()));
    }

} 
```

*参数化测试.java：*

```
package junit.parameterized;
import java.util.Arrays;
import java.util.Collection;

import junit.framework.Test;
import junit.framework.TestCase;
import junit.parameterized.ParameterizedTestSuite;

public class ParameterizedTest extends TestCase {

    private final int value;
    private int evilState;

    public static Collection<Object[]> parameters() {
        return Arrays.asList(
                new Object[] { 1 },
                new Object[] { 2 },
                new Object[] { -2 }
                );
    }

    public ParameterizedTest(final int value) {
        this.value = value;
    }

    public void testMathPow() {
        final int square = value * value;
        final int powSquare = (int) Math.pow(value, 2) + evilState;
        assertEquals(square, powSquare);
        evilState++;
    }

    public void testIntDiv() {
        final int div = value / value;
        assertEquals(1, div);
    }

    public static Test suite() {
        return new ParameterizedTestSuite(ParameterizedTest.class, parameters());
    }
} 
```

注意：`evilState`这里的变量只是为了表明所有测试实例都应该是不同的，并且它们之间没有共享状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-21T07:26:03.680

> 一些细节并不完美，例如 IDE 中的测试名称在参数集之间是相同的（JUnit 4.x 附加 [0]、[1]、...）。

要解决这个问题，您只需要覆盖 getName() 并更改测试用例类中的构造函数：

```
 private String displayName;

 public ParameterizedTest(final int value) {
     this.value = value;
     this.displayName = Integer.toString(value);
 }

 @Override
 public String getName() {
     return super.getName() + "[" + displayName + "]";
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-21T17:42:08.070

对于 Android 项目，我们编写了一个名为[Burst](https://github.com/square/burst)的库，用于测试参数化。例如

```
public class ParameterizedTest extends TestCase {
  enum Drink { COKE, PEPSI, RC_COLA }

  private final Drink drink;

  // Nullary constructor required by Android test framework
  public ConstructorTest() {
    this(null);
  }

  public ConstructorTest(Drink drink) {
    this.drink = drink;
  }

  public void testSomething() {
    assertNotNull(drink);
  }
} 
```

由于您没有使用 Android，因此不能真正回答您的问题，但是许多仍然使用 JUnit 3 的项目都这样做，因为 Android 的测试框架需要它，所以我希望其他读者会觉得这很有帮助。

# c++ - Visual c++“为每个”可移植性

> ID：197375
> 
> 赞同：23
> 
> 时间：2008-10-13T12:21:29.343
> 
> 标签：c++, visual-c++, stl, foreach

我最近才发现 Visual C++ 2008（也许还有更早的版本？）支持`for each`stl 列表等语法以促进迭代。例如：

```
list<Object> myList;

for each (Object o in myList)
{
  o.foo();
} 
```

我很高兴发现它，但是当有人决定我需要能够在 gcc 或其他编译器中编译我的代码时，我担心可移植性。这种语法是否得到广泛支持，我可以在不担心可移植性问题的情况下使用它吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-13T14:24:38.317

我不会用那个。虽然这是一个诱人的功能，但其语法与即将推出的 C++0x 标准不兼容，该标准使用：

```
list<Object> myList;

for (Object o : myList)
{
   o.foo();
} 
```

做同样的事情。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-13T12:23:03.100

For each 不是标准的 C 或 C++ 语法。如果您希望能够在 gcc 或 g++ 中编译此代码，则需要创建一个迭代器并使用标准 for 循环。

量子皮特

[编辑] 这似乎是 MS Visual C++ 中引入的一个新特性，所以这绝对不是可移植的。参考： http: [//msdn.microsoft.com/en-us/library/xey702bw%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/xey702bw%28VS.80%29.aspx) [/edit]

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-13T12:31:05.843

有一个很好的便携式替代品：[Boost.Foreach](http://engineering.meta-comm.com/resources/cs-win32_metacomm/doc/html/foreach.html)。只需将此标头转储到您的项目中，您就可以按如下方式编写循环：

```
list<Object> myList;

BOOST_FOREACH(Object o, myList)
    o.foo(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-13T15:11:03.463

如果您想使用 foreach 并且同时又不想添加额外的依赖项（例如 Boost） - 此宏将帮助您：

```
#define VAR(V,init) __typeof(init) V=(init)
#define FOREACH(I,C) for(VAR(I,(C).begin());I!=(C).end();I++)

std::vector<int> numbers;

FOREACH(I, numbers)
{
    std::cout << *I << std::endl;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-13T12:36:44.227

Visual C++“for each”不是标准的 C++，这意味着您将无法在其他编译器（例如 g++）上编译您的代码。然而，STL 提出了[std::for_each](http://www.sgi.com/tech/stl/for_each.html)，但它的语法不那么直观。这是它的原型：

```
template <class InputIterator, class UnaryFunction>
UnaryFunction for_each(InputIterator first, InputIterator last, UnaryFunction f); 
```

它需要两个定义有效范围的迭代器，并将一元函数（或函子） f 应用于该范围内的每个对象。您可以像这样使用 std::for_each 重写您的示例：

```
void foo(Object o)
{
  o.foo();
}
...
list<Object> myList;

std::for_each(myList.begin(), myList.end(), foo); 
```

但是，如果您想接近 for each 构造的经典语法，并且您可以使用 Boost，则可以使用[BOOST.FOREACH](http://engineering.meta-comm.com/resources/cs-win32_metacomm/doc/html/foreach.html)，它可以让您编写

```
list<Object> myList;

BOOST_FOREACH(Object o, myList)
{
    o.foo();
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T12:29:44.117

Boost 库有一个可移植的[ForEach 实现](http://engineering.meta-comm.com/resources/cs-win32_metacomm/doc/html/foreach.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-03T15:33:17.200

您的代码确实不可移植。

以下适用于 C++ 0x 标准和 Visual C++ 2010（据我所知，它不支持新的“ranged for”语法）。

```
#define for_each(_ITER_, _COLL_) for (auto _ITER_ = _COLL_.begin(); \
    _ITER_ != _COLL_.end(); _ITER_++) 
```

现在你可以写：

```
list<Object> myList;

for_each (o, myList)
{
  o.foo();
} 
```

[将此与http://www.boost.org/doc/libs/1_48_0/boost/foreach.hpp](http://www.boost.org/doc/libs/1_48_0/boost/foreach.hpp)上的 BOOST_FOREACH 宏代码进行比较，这不仅复杂，而且还对其他 boost 库有许多依赖关系。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T13:56:44.987

我还推荐 BOOST_FOREACH。我通常按​​照以下方式创建一个宏：

```
#define _foreach(x,y) BOOST_FOREACH(x,y) 
```

这往往会增加可读性。不过，您必须小心与其他 foreach 实现的冲突。例如，Qt 提供了一个“foreach”，还有 std::for_each。

我发现 std::for_each 实际上并没有节省太多时间，因为您最终会制作大量一次性函数对象来提供给 for_each 调用。使用 STL 迭代器制作标准 for 循环通常同样快。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-13T13:39:27.017

我投票给卢克，

坚持标准的 STL 算法，到目前为止你会做得更好。STL 算法可以让您的生活变得非常轻松、高效和安全。看看现成的算法，如 find_if、count、count_if、sort、transform 等......

第 5 点以后... [http://www.sgi.com/tech/stl/table_of_contents.html](http://www.sgi.com/tech/stl/table_of_contents.html)

Boost 很酷，但如果你只将它用于 FOR_EACH 宏，那么在开发/构建环境设置方面就太麻烦了。

当标准 c++ / stl 无法以“简单”的方式解决问题时，请使用 boost。

# knowledge-management - 你如何存储所有你学到的东西和你想保留的信息？

> ID：197376
> 
> 赞同：7
> 
> 时间：2008-10-13T12:21:33.663
> 
> 标签：knowledge-management

授予的知识在付诸实践时最好保留，但作为程序员，我确信信息太多了。除了为您的书籍添加注释外，您还为自己的个人知识库使用了哪些其他方法，以便您可以轻松访问参考？

您是否创建自己的 wiki 或使用[wikidpad 之](http://groups.google.com/group/wikidpad/web/home)类的软件，或将它们保存为纯文本、书签、pdf、网页等？还是您只是将 google/SO 视为您的巨大知识库并仅在需要时进行搜索？

您可能会发现类似 的[https://stackoverflow.com/questions/10961/have-you-used-a-wiki-in-your-project-or-group](https://stackoverflow.com/questions/10961/have-you-used-a-wiki-in-your-project-or-group)，当然这个问题也很容易与非程序员相关.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T12:38:00.120

关于它的博客。这样，无论您身在何处，您都将始终拥有它，并且该信息会与他人共享。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T12:49:02.643

我使用[Tiddlywiki](http://tiddlywiki.com)将我所有的开发笔记放在一起，除了我可能在会议上得到的想要保留的笔记或讲义。那些进入特定项目的文件夹，我在我的 Tiddlywiki 中添加对它们的引用，这样它们就不会在随机播放中迷失。我用一组有限的标签标记所有内容（而不是过度使用标签，我有一组 15 个标签，涵盖了我需要的项目和类别），所以我可以快速回复它们。

为我工作。

否则，我会根据需要撰写有关它们的博客，使用驱动器索引对大量内容进行大规模搜索，并保留简短的每日活动摘要（1 或 2 行）以便更好地回忆。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T13:20:37.757

我看到人们成功使用了几种解决方案：

*   关于它的博客（正如其他人在这里指出的那样）
*   维护 Wiki（本地或托管）
*   将其保存在纯文本文件中
*   使用[背包](http://www.backpackit.com)
*   使用托管办公解决方案（[谷歌文档](http://docs.google.com)、[Zoho](http://www.zoho.com)）
*   [在Gmail](http://mail.google.com)中通过电子邮件将其通过电子邮件发送给自己（是的，真的 :) 好吧，让内容易于搜索）

我个人使用一个[TiddlyWiki](http://www.tiddlywiki.com)（易于使用；非常好的搜索），我随身携带在 USB 笔式驱动器中，并且也签入到我的 SVN 存储库；和一个小“笔记本”（从[这里](http://www.pocketmod.com)创建），它可以整齐地放在钱包里，当我不在电脑附近时记下东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T12:29:15.600

启动一个维基。 我使用的是[ScrewTurn 。](https://docs.microsoft.com/en-us/iis/publish/deploying-application-packages/screwturn-wiki)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T12:26:39.350

我一直在 Google 文档 (google.com/docs) 中存储我的笔记。我已经尝试过 wiki，但设置和维护的成本尚未得到证明。随着我的笔记集越来越大，我可能需要进一步研究这个选项。

另一件要考虑的事情是老程序员的物理笔记本。在这个数字时代，永远不应低估纸和铅笔。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T12:45:09.607

就个人 Wiki 软件而言，我一直是OSX版[VoodooPad](http://www.flyingmeat.com/voodoopad/)的忠实粉丝。这是一个很好的自包含 Wiki 应用程序。无需维护网络服务器或将您的 Wiki 托管在您的计算机以外的任何地方。另外，您可以导出为多种格式。它使用起来非常直观，几乎可以存储您想要的任何东西。

如果您要提取代码示例，它还应该保留语法着色（我面前没有它，所以我无法确认）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T13:35:17.823

我喜欢[Treepad](http://www.treepad.com/)来组织笔记。它基于树形结构，每个节点可以包含一个文本文档，并且有子节点。

它不是专门为编程而设计的，但它非常易于使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-07T13:52:08.753

[Emacs的组织模式](http://orgmode.org/)。我用它来规划工作（短期和长期）、TODO 项目、随机操作说明（带有指向源文件和 URL 的可点击链接）——所有这些都在一个平面文件中。它有独角兽！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T12:34:52.873

我使用 codekeep 来存储我的代码片段有时我也会在谷歌笔记上存储一些笔记

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T12:36:56.300

主要是闪存驱动器上的纯文本，与家里的钥匙一起在钥匙圈中。加上最终在网站上进行备份。这使得它可以在任何平台和任何地方，无论我走到哪里。你知道，仍有一些地方无法上网。

# c++ - 如何在 Windows Vista 中创建符号链接？

> ID：197379
> 
> 赞同：6
> 
> 时间：2008-10-13T12:22:27.983
> 
> 标签：c++, c, windows, java-native-interface, symlink

我希望在 Windows Vista/2008 机器上从 Java 创建符号链接（软链接）。我很高兴我需要调用 JNI 来执行此操作。不过，我正在寻求实际 C 代码的帮助。创建链接的适当系统调用是什么？非常感谢有关此主题的一些好的文档的指针。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-13T12:38:15.830

Windows 中的符号链接是使用[CreateSymbolicLink API 函数创建的，该函数采用](http://msdn.microsoft.com/en-us/library/aa363866.aspx)[与 Mklink 命令行实用程序](http://technet.microsoft.com/en-us/library/cc753194.aspx)接受的命令行参数非常相似的参数。

假设您正确引用了 JNI 和 Win32 SDK 标头，那么您的代码可能很简单：

```
JNIEXPORT jboolean JNICALL Java_ClassName_MethodName
    (JNIEnv *env, jstring symLinkName, jstring targetName)
{
    const char *nativeSymLinkName = env->GetStringUTFChars(symLinkName, 0);
    const char *nativeTargetName = env->GetStringUTFChars(targetName, 0);

    jboolean success = (CreateSymbolicLink(nativeSymLinkName, nativeTargetName, 0) != 0);

    env->ReleaseStringUTFChars(symLinkName, nativeSymLinkName);
    env->ReleaseStringUTFChars(targetName, nativeTargetName);

    return success;
} 
```

请注意，这只是我的想法，而且我已经很久没有处理过 JNI 了，所以我可能忽略了使这项工作的一些更好的点......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T12:34:21.703

从我的笔记中，这一直在我的尝试清单上：

API：

[http://msdn.microsoft.com/en-us/library/aa363866(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363866(VS.85).aspx)

```
BOOLEAN WINAPI CreateSymbolicLink(
  __in  LPTSTR lpSymlinkFileName,
  __in  LPTSTR lpTargetFileName,
  __in  DWORD dwFlags
); 
```

一些 C# 示例：

[http://community.bartdesmet.net/blogs/bart/archive/2006/10/24/Windows-Vista-2D00-Creating-symbolic-links-with-C_2300_.aspx *_* _](http://community.bartdesmet.net/blogs/bart/archive/2006/10/24/Windows-Vista-_2D00_-Creating-symbolic-links-with-C_2300_.aspx)

一个 C++ 示例，这是我正在阅读的另一篇文章中的 cnp。我没有测试过，所以请谨慎使用。

```
typedef BOOL (WINAPI* CreateSymbolicLinkProc) (LPCSTR, LPCSTR, DWORD);

void main(int argc, char *argv[]) 
{
  HMODULE h;
  CreateSymbolicLinkProc CreateSymbolicLink_func;
  LPCSTR link = argv[1];
  LPCSTR target = argv[2];
  DWORD flags = 0;

  h = LoadLibrary("kernel32");
  CreateSymbolicLink_func =
    (CreateSymbolicLinkProc)GetProcAddress(h,
  if (CreateSymbolicLink_func == NULL) 
  {
     fprintf(stderr, "CreateSymbolicLinkA not available\n");
  } else 
  {
     if ((*CreateSymbolicLink_func)(link, target, flags) == 0) 
     {
        fprintf(stderr, "CreateSymbolicLink failed: %d\n",
        GetLastError());

  } else 
  {
     printf("Symbolic link created.");
  }
} 
```

}

话虽如此，我不会使用这段代码 :-) 我要么倾向于 fork mklink，要么从 jruby/jpython 中查看本机库（抱歉，我无法在 atm 上查找它，因为我的网络连接很不稳定）。我似乎记得 jruby 已经编写了一个库，它将各种 posix apis 包装到 java 中（就像 chown 一样，它是 ruby​​ 合规性所必需的，但不是跨平台的）。jpython 人正在使用这个库，他们似乎对此非常满意。如果这个库不提供符号链接支持，我会感到惊讶。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T12:23:56.373

您不能直接调用命令行并使用**mklink**吗？

# mysql - 优化 MySQL 中大表的单行查询

> ID：197381
> 
> 赞同：2
> 
> 时间：2008-10-13T12:22:51.213
> 
> 标签：mysql, optimization

我正在处理 MySQL 表，这些表本质上是在带有单个百叶窗的模拟办公室上进行光线跟踪模拟的结果。我通常需要检索模拟结果以获取时间和盲人设置的独特组合。所以我最终做了很多

```
SELECT result FROM results WHERE timestamp='2005-05-05 12:30:25' \
         AND opening=40 AND slatangle=60 
```

这看起来值得优化，因为这个查询永远不会返回超过一行。在唯一标识每一行的三列上定义索引是否有意义？还是我可以使用其他技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T12:30:37.670

答案肯定是肯定的。如果您在时间戳上定义唯一索引，则打开和 slatangle MySQL 应该能够以很少的磁盘搜索找到您的行。

您可以尝试在时间戳、开头、slateangle 和结果上创建索引。MySQL 可能完全不接触数据文件就可以从索引中获取您的数据。

MySQL 手册有一[节关于优化查询](http://dev.mysql.com/doc/refman/5.0/en/query-speed.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T07:08:08.553

我建议添加 LIMIT 1；到查询结束。

威廉

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T12:33:04.047

我不建议添加 3 个索引。使用所有三列的索引可能会更好，甚至在该组合上设置唯一的主键也是最好的 - 前提是您确定它是唯一的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T18:00:05.190

是的，创建多列索引会有所帮助。您还应该测试不同列顺序的性能，即*O(c1, c2, c3) != O(c2, c1, c3)*

看一看

[http://joekuan.wordpress.com/2009/01/23/mysql-optimize-your-query-to-be-more-scalable-part-12/](http://joekuan.wordpress.com/2009/01/23/mysql-optimize-your-query-to-be-more-scalable-part-12/) [http://joekuan.wordpress.com/2009/01/ 23/mysql-optimize-your-query-to-be-more-scalable-part-22/](http://joekuan.wordpress.com/2009/01/23/mysql-optimize-your-query-to-be-more-scalable-part-22/)

# cocoa - 按标识符定位捆绑包

> ID：197383
> 
> 赞同：6
> 
> 时间：2008-10-13T12:23:03.413
> 
> 标签：cocoa, macos

我想从任意包标识符创建一个包，
例如`com.apple.iokit.IOStorageFamily`

这不是不合理的事情，因为捆绑 ID 应该
是唯一的，但是明显的代码不起作用：

```
NSString* bID = @"com.apple.iokit.IOStorageFamily";
NSBundle* bundle = [NSBundle bundleWithIdentifier:bID]; 
```

这段代码只适用于你已经加载的包
（你好，鸡和蛋的问题），事实上，在你做任何事情之前，你必须
比你想知道的标识符多
一点。对于上面的 ID 样式，
我 grep 出最终组件并将其转换为
`/System/Library/Extensions/IOStorageFamily.kext`
然后通过路径加载。

这是最先进的技术还是有更通用的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T16:35:28.380

用这个

```
NSString *path = [[NSWorkspace sharedWorkspace] absolutePathForAppBundleWithIdentifier:@"com.apple.TextEdit"]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T00:41:58.033

我认为 Mac OS X 不会在任何地方都保留所有捆绑 ID 的全球数据库。

如前所述，您可以使用 NSWorkspace 以非常简单的方式找到应用程序。

此外，由于您在示例中使用了 kext，因此在 Leopard (10.5) 上有一个名为“kextfind”的工具，您可以运行它来搜索系统 Exensions 文件夹中的 kext（除非您指向其他地方的工具）。kextfind 有很多选项——有关详细信息，请参见手册页——但要通过捆绑 ID 查找 kext，您可以这样做：

```
kextfind -bundle-id com.apple.iokit.IOStorageFamily 
```

我们目前没有用于通过捆绑 ID 查找 kexts 的 C 级 API。

至于从捆绑 ID 的最后一个组件中破解路径：不要那样做。没有什么要求包装器名称与包 ID 的最后一个组件匹配，而且我见过 kexts（更不用说其他包），两者不匹配。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-17T20:40:37.920

就在最近，Andrew Myrick在 darwin-dev 邮件列表上[回答了一个类似的问题：](http://lists.apple.com/archives/darwin-dev/2009/Oct/msg00088.html)

> `KextManagerCreateURLForBundleIdentifier()` in`<IOKit/kext/KextManager.h>`可能有用，但我相信它只适用于 1) 已加载或 2) 在 /S/L/E/ 中的 kext。这是雪豹头文件：
> 
> ```
> /*!
>  * @function KextManagerCreateURLForBundleIdentifier
>  * @abstract Create a URL locating a kext with a given bundle identifier.
>  *
>  * @param    allocator
>  *           The allocator to use to allocate memory for the new object.
>  *           Pass <code>NULL</code> or <code>kCFAllocatorDefault</code>
>  *           to use the current default allocator.
>  * @param    kextIdentifier
>  *           The bundle identifier to look up.
>  *
>  * @result
>  * A CFURLRef locating a kext with the requested bundle identifier.
>  * Returns <code>NULL</code> if the kext cannot be found, or on error.
>  *
>  * @discussion
>  * Kexts are looked up first by whether they are loaded, second by version.
>  * Specifically, if <code>kextIdentifier</code> identifies a kext
>  * that is currently loaded,
>  * the returned URL will locate that kext if it's still present on disk.
>  * If the requested kext is not loaded,
>  * or if its bundle is not at the location it was originally loaded from,
>  * the returned URL will locate the latest version of the desired kext,
>  * if one can be found within the system extensions folder.
>  * If no version of the kext can be found, <code>NULL</code> is returned.
>  */
> CFURLRef KextManagerCreateURLForBundleIdentifier(
>     CFAllocatorRef allocator,
>     CFStringRef    kextIdentifier); 
> ```
> 
> 请注意，在 Snow Leopard 之前，它可能仅适用于 /S/L/E 中的 kext；API 存在，但没有描述其行为的 headerdoc。

对我来说，这在 Mac OS X 10.5 上运行得非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T22:04:16.420

如果您要查找的绝对是 kext，那么您可以查看 /S/L/Es/ 文件夹中每个捆绑包的信息字典，直到找到您的。除了应用程序（LaunchServices 将在其中执行此操作）之外，没有按标识符搜索包，并加载了您已经找到的包。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T00:51:09.387

为了回答这个问题，我认为真的需要知道“你为什么要以这种方式查看捆绑标识符？” 如果总是有 kexts 你可以在一些相当合理的地方搜索，如果它们是你可以使用 LS 的应用程序，我看不到你想要两者都做的情况，所以我认为没有必要常见的方法。

应该注意的是，您可以在一个卷上拥有多个相同捆绑标识符的实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-08T16:15:33.070

[`kMDItemCFBundleIdentifier`](https://developer.apple.com/library/mac/documentation/Carbon/Reference/MDItemRef/Reference/reference.html#//apple_ref/c/data/kMDItemCFBundleIdentifier)为了完整起见，我应该提到您可以使用Spotlight/元数据键搜索具有给定包标识符的所有包（不仅仅是 KEXT） ；当然，您必须准备好处理不止一个（通常它们应该有不同的版本）。

# python - 数据的文档字符串？

> ID：197387
> 
> 赞同：21
> 
> 时间：2008-10-13T12:24:04.160
> 
> 标签：python, docstring

有没有办法以类似于文档字符串描述模块或功能的方式来描述模块的数据？

```
class MyClass(object):
    def my_function():
        """This docstring works!"""
        return True
    my_list = []
    """This docstring does not work!""" 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T12:55:53.813

据我所知，不可能将文档字符串分配给模块数据成员。

[PEP 224](http://www.python.org/dev/peps/pep-0224/)建议使用此功能，但 PEP 被拒绝。

我建议您在模块的文档字符串中记录模块的数据成员：

```
# module.py:
"""About the module.

module.data: contains the word "spam"

"""

data = "spam" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-13T13:23:42.260

可以**使用**[epydoc](http://epydoc.sourceforge.net/)语法制作模块数据的文档。Epydoc 是 Python 最常用的文档工具之一。

记录的语法`#:`在变量初始化行的上方，如下所示：

```
# module.py:

#: Very important data.
#: Use with caution.
#: @type: C{str}
data = "important data" 
```

现在，当您生成文档时，`data`将被描述为具有给定描述和类型的模块变量`str`。您可以省略该`@type`行。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-13T22:08:20.173

正如 codeape 解释的那样，不可能记录一般数据成员。

但是，*可以*记录`property`数据成员：

```
class Foo:
  def get_foo(self): ...

  def set_foo(self, val): ...

  def del_foo(self): ...

  foo = property(get_foo, set_foo, del_foo, '''Doc string here''') 
```

显然，这将为`foo`属性提供一个文档字符串。

# c# - 生成用户特定的 1 次优惠券代码

> ID：197388
> 
> 赞同：8
> 
> 时间：2008-10-13T12:24:04.783
> 
> 标签：c#, language-agnostic, encoding, cryptography

因此，我需要生成一个代码，该代码可以与特定用户/潜在客户相关联，并内置美元金额。它需要是可逆的，以便客户端应用程序可以确认代码的有效性并应用经理想要的折扣。

我想让代码尽可能短，但它需要被很好地混淆，这样销售人员就不能自己开始弄乱它。

我可以自己想出一些数字，除以 pi 并转换为十六进制等等，但我会对社区的想法或最佳实践非常感兴趣。

我在 C# 中执行此操作，但我希望可以翻译任何语言的方法。

编辑：澄清。我不能提前存储这些东西，代码必须即时构建并携带所有信息。

例如。推销员 14 打电话给客户 773，希望给他们 500 美元的订单折扣。14、773 和 500 必须在优惠券代码中，并且能够在销售人员键入代码后在客户端应用程序中提取。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T12:36:52.057

生成用于签名的公钥/私钥对。使用私钥对用户 ID 和优惠券价值的组合进行数字签名。将优惠券价值 + 签名作为优惠券代码发布，例如使用字母和数字进行编码。客户端应用程序将通过重新创建最初签名的数据组合来验证代码（例如，将用户 ID 附加到优惠券值），然后验证数字签名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T12:34:40.080

听起来像是非对称加密的案例。您可以将公钥分发给所有人，从而为他们提供验证优惠券的信息，但创建 Cupon 的能力将取决于私钥的所有者（= 您）。

我将创建一个序列化为 xml 的优惠券类，然后加密 xml 字符串。验证将是解密字符串并查看它是否是有效的 xml（我建议不要反序列化对象而不先检查它）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T12:30:55.050

我会使用客户代码和优惠券到期日期。至于验证，您可以将有效的优惠券存储在您的数据库中并进行验证。您可以每天扫描一次优惠券表以清除过期代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T12:33:32.580

你的推销员（或女性）有多聪明？您可以仅对值进行 base 64 编码吗？

在此处查看如何进行 base64 编码和解码：

[http://arcanecode.wordpress.com/2007/03/21/encoding-strings-to-base64-in-c/](http://arcanecode.wordpress.com/2007/03/21/encoding-strings-to-base64-in-c/)

除此之外，我会使用您和客户端应用程序已知的密钥来加密该值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T12:37:45.380

我猜你已经表达了你不想将代码存储在数据库中的问题（如果你这样做了，你可以简单地根据数据库验证每个代码）

因此，您可以做的是获取有关优惠券中内容的所有相关信息，然后将其与秘密盐一起散列以防止篡改。

因此，假设您想要一张价值 200 美元的用户 23 的优惠券，您可能会构建一个类似“23_200”的字符串，并使用“BillTheLizard”的秘密盐计算 MD5 哈希，得到 2671519131e974ee6fc746151e98f4a8，因此您给客户的完整代码是200_23_2671519131e974ee6fc746151e98f4a8

现在，当您收到代码时，将其拆分，并检查 md5("200_23"+secret) = 2671519131e974ee6fc746151e98f4a8 以验证值

*编辑：如果 32 个字符的哈希值太长，您可以随时将其截断，例如将其切成 8 个字符仍然会给您 4294967296 个不同的哈希值。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T13:07:30.780

这只是总结到目前为止的答案。生成此类优惠券代码有两种主要不同的方式：

1.  集中式解决方案：每张优惠券的信息都存储在您的数据库中。然后可以随机生成优惠券代码并且很短——它只是对数据库中记录的引用，其中包含所有必要信息，例如优惠券价值、客户 ID、代表 ID。验证此类代码需要在线访问您的服务器。

2.  去中心化解决方案：优惠券是一条独立的信息，可以在离线模式下验证，无需访问您的任何服务器。因此，优惠券代码必须包含部分（甚至全部）信息。最安全的方法是使用非对称加密或[消息验证码](https://en.wikipedia.org/wiki/Message_authentication_code)，这样除了私钥持有者（您）之外，没有人可以生成优惠券。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T18:37:57.923

Steve Gibson 在他的网站上谈到一次性密码，但没有理由不能使用它来创建一次性优惠券代码： http: [//grc.com/ppp](http://grc.com/ppp)

# sas - 通过过滤度量值在 MDX 中定义计算成员

> ID：197407
> 
> 赞同：3
> 
> 时间：2008-10-13T12:30:32.757
> 
> 标签：sas, olap, mdx

我需要在 MDX 中定义一个计算成员（这是 SAS OLAP，但我很感谢那些使用不同 OLAP 实现的人的回答）。

新度量的值应通过应用附加过滤条件从现有度量计算。我想举个例子会更清楚：

*   现有度量：“总流量”
*   现有维度：“方向”（“In”或“Out”）
*   我需要创建一个计算成员“传入流量”，它等于带有附加过滤器的“总流量”（Direction = “In”）

问题是我不了解 MDX，而且我的日程安排非常紧张（对于新手问题，我深表歉意）。我能想到的最好的是：

```
([Measures].[Total traffic], [Direction].[(All)].[In]) 
```

这几乎可以工作，除了具有特定方向的单元格：

![例子](https://i.stack.imgur.com/z3BxZ.png)

所以看起来方向上的“内在”过滤器被我自己的过滤器覆盖）。我需要“内在”过滤器和我自己的过滤器的交集。我的直觉是，它与`[Direction].[(All)].[In]`与被评估单元格的内在坐标相交有关，但如果不先阅读该主题，就很难知道我需要什么:)

**[更新]**我结束了

```
IIF([Direction].currentMember = [Direction].[(All)].[Out],
    0,
    ([Measures].[Total traffic], [Direction].[(All)].[In])
) 
```

..但至少在 SAS OLAP 中，这会导致对基础数据集执行额外的查询（以计算 [in] 的值），所以我最终没有使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T12:16:59.803

首先，您可以在 MDX 中定义一个新的计算度量，并告诉它使用另一个度量的值，但应用了一个过滤器：

```
WITH MEMBER [Measures].[Incoming Traffic] AS
'([Measures].[Total traffic], [Direction].[(All)].[In])' 
```

每当您在报表上显示新度量时，无论是否使用了“方向”维度，它都会表现得好像它有一个“方向 > 在”过滤器。

但是在您的情况下，您希望在使用时优先使用方向维度......所以事情变得有点混乱。您必须检测此维度是否正在使用中，并采取相应措施：

```
WITH MEMBER [Measures].[Incoming Traffic] AS
'IIF([Direction].currentMember = [Direction].[(All)].[Out],
    ([Measures].[Total traffic]),
    ([Measures].[Total traffic], [Directon].[(All)].[In])
)' 
```

要查看 Dimension 是否正在使用，我们检查当前单元格是否正在使用 OUT。如果是这样，我们可以按原样返回 Total Traffic。如果没有，我们可以告诉它在我们的元组中使用 IN。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-12T09:55:55.757

我认为您应该在总流量事实表中放置一列以指示输入/输出，并为输入和输出值创建一个 Dim 表。然后，您可以根据 IN & Out 分析您的数据。

# enterprise-library - 企业图书馆数据库跟踪监听器？

> ID：197410
> 
> 赞同：5
> 
> 时间：2008-10-13T12:30:57.000
> 
> 标签：enterprise-library

我正在使用 EntLib v4 进行日志记录，目前我正在将事件保存到默认的文本文件侦听器。

我想使用 MS SQL 数据库作为我的事件接收器，我看到数据库侦听器已经提供，但我不知道如何创建日志数据库和存储过程？

在谷歌搜索之后，我看到在 v3 中数据库创建脚本与 EntLib 一起提供，但我在 v4 中找不到它们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T13:31:45.300

我刚刚检查了它的安装源。在我的机器上它在`C:\EntLib4Src\Blocks\Logging\Src\DatabaseTraceListener\Scripts`.

您可以使用 createloggingdb.cmd 文件或自己解析 loggingdatabase.sql 以获得相关命令。

# c# - 使用 ErrorController 而不是直接视图处理错误

> ID：197414
> 
> 赞同：6
> 
> 时间：2008-10-13T12:32:02.987
> 
> 标签：c#, asp.net-mvc, error-handling, error-logging

我试图了解 MVC 中的错误处理。我正在寻找的是一种集中的方式来捕获错误，记录它们，如果可能的话解决它们，如果需要采取其他措施并最终向用户显示正确的视图。

我想我可以为此使用 [HandleError] 过滤器，但我没有看到任何将其路由到控制器/操作的方法。我看到的唯一选择是将其直接指向一个视图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T12:41:57.307

MVC 附带的 HandleErrorAttribute 是一个非常基本的 IExceptionFilter [。](http://www.codeplex.com/aspnet/SourceControl/FileView.aspx?itemId=266465&changeSetId=16503)

你有几个选择来实现我认为你想要的。

您可以在操作/控制器上使用 [HandleError (Type=typeof(MyException),View="ErrorView")] 或实现自己的

[HandleErrorAttribute](http://www.codeplex.com/aspnet/SourceControl/FileView.aspx?itemId=266465&changeSetId=16503)不是很复杂。我认为 MS 建议您复制此代码并进行修改以满足您的要求。

OnException 覆盖使您可以通过 ExceptionContext 访问您可能需要的所有信息 - 控制器、操作、路由数据等。

记得设置 ExceptionHandled。然后您可以将 filterContext.Result 设置为一个新的 RedirectToAction 实例，该实例重定向到您的 ErrorController 和操作 - 显然您可以使用属性公开特定的控制器和操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T14:40:07.977

Leppi，如果要发送到 Action Result，可以定义 Action 和 Controller 以在错误时重定向。这是一个很好的例子，但我个人不喜欢不使用自定义页面或 http 代码来编码

这是我的 IExtenptionFilter 的示例。我的基本控制器有一个默认的 IExceptionFilter 来处理所有不受控制的错误。

```
[SuppressMessage("Microsoft.Performance", "CA1813:AvoidUnsealedAttributes",
    Justification = "This attribute is AllowMultiple = true and users might want to override behavior.")]
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = true)]
public class GenericExceptionHandlerFilter : ActionFilterAttribute, IExceptionFilter
{

    public Type ExceptionType { get; set;}
    public string RedirectToAction { get; set;}
    public string RedirectToController { get; set;}

    protected bool ApplyFilter(ExceptionContext filterContext)
    {
        Type lExceptionType = filterContext.Exception.GetType();
        return (ExceptionType == null ||
                lExceptionType.Equals(ExceptionType));
    }

    #region IExceptionFilter Members
    public void OnException(ExceptionContext filterContext)
    {

        if (ApplyFilter(filterContext))
        {
            IbfControllerLogger.Log(filterContext.Exception);

            filterContext.ExceptionHandled = true;

            #region Calculate Action Controller Error
            RouteValueDictionary lRoutes = new RouteValueDictionary(new
                {
                    action = RedirectToAction,
                    controller = String.IsNullOrEmpty(RedirectToController) ? (string)filterContext.RouteData.Values["controller"] : RedirectToController
                });
            UrlReWriterUtils.UrlReWriter(filterContext.Controller.ViewData, lRoutes);
            #endregion

            filterContext.Controller.TempData[TempDataName.C_TEMPDATA_EXCEPTIONERROR] = filterContext.Exception;
            filterContext.Result = new RedirectToRouteResult(lRoutes);
        }
    }
    #endregion 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T12:34:43.873

为什么不创建您自己的从 ActionResult 派生的 ErrorResult？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T13:26:55.233

我正在做的（这可能是也可能不是一个好习惯）是这样的：

发生错误时：

*   如果我期望它并且可以处理它，我会这样做（用 ELMAH 记录它）
*   如果我期望它并且无法处理它，我将它记录到 ELMAH 并返回一个 ViewResult 这是我的错误页面
    *   包括错误描述、标准消息和返回我正在做的事情的链接
*   如果我没想到的话，我在基控制器类中对 OnError 的覆盖会执行上一步
*   所有其他无法处理的错误都由 ELMAH 自动记录，并且请求黄屏

我的大多数通用错误处理都放在我所有控制器的基类中。唯一的问题是我必须在基类中手动设置控制器和操作值，以便它可以为错误页面中的重定向生成 ActionLink。

# php - 更改php中的上传限制

> ID：197419
> 
> 赞同：1
> 
> 时间：2008-10-13T12:33:40.287
> 
> 标签：php

我正在开发一个 CMS，客户需要上传大于 2mb 的文件 - 至少最多 10mb。我已更改 php.ini 文件中的详细信息，但在其他任何地方都看不到问题可能出在哪里。有什么帮助吗？

干杯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T12:43:14.573

这是我建议更改的内容（假设 Apache 和 PHP）：

我发现这适用于最多约 30mb 的附件

## PHP 设置

*   最大`_execution`_时间 = 120
*   最大`_input`_时间 = 120
*   memory_limit = 30M
*   帖子`_max`_size = 30M
*   上传`_max`_filesize 30M
*   file_uploads = On *（虽然听起来你已经打开了这个）*

## 阿帕奇设置

*   限制请求体 31457280

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T12:40:19.570

您需要适当地设置upload_max_filesize、post_max_size 和memory_limit。post_max_size 必须大于 upload_max_filesize，因为需要为请求标头和文件负载分配内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T12:41:16.463

在你的`php.ini`：

```
; Maximum allowed size for uploaded files.
upload_max_filesize = 50M

; Maximum size of POST data that PHP will accept.
post_max_size = 50M 
```

完成这些操作后，您的错误日志中会出现哪些错误？您上传的文件是否可能违反脚本的内存限制？

您可以通过在脚本中包含以下行来将此特定脚本的内存限制设置得更高：

```
ini_set("memory_limit","75M"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T12:40:37.090

确保你改变了`upload_max_filesize`并且`post_max_size`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T12:39:41.427

只要您重新启动了您的 Web 服务（即 apache），那么更改就会生效，但是如果您正在为自己以外的任何人开发，那么我不会更改 php.ini，而是将其添加到上传脚本中：

```
ini_set('upload_max_filesize', '10M'); 
```

因为有些人可能无法修改 php.ini，这只会针对它所在的页面进行更改。

# java - 我应该什么时候调用 Naming.unbind()？

> ID：197421
> 
> 赞同：1
> 
> 时间：2008-10-13T12:34:30.177
> 
> 标签：java, rmi

我有一些通过 RMI 提供的代码。

如果我的程序异常终止，我将不会调用 Naming.unbind()，并且对该对象的引用可能会挂在 RMI 注册表中，随后对具有相同名称的 Naming.bind() 的调用将失败。

如何确保清除恶意引用？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-10-13T13:33:48.153

有一种叫做分布式垃圾收集器（DGC）的东西。它使用租约来跟踪陈旧的绑定，并在它们不使用时收集它们。设置导出JVM 的[leaseValue](http://java.sun.com/j2se/1.4.2/docs/guide/rmi/javarmiproperties.html)系统属性以确定绑定何时到期。

将该值设置得太低会导致网络流量增加。将其设置得太高会导致过时的引用被持有太久。您可以在客户端查找后调用幂等方法，以确保对象处于活动状态（或使用 Weblogic 智能存根之类的东西）。在服务器端，您可以检查注册表，如果存在绑定，请取消注册（以防它过时），处置远程对象并导出一个新对象，或者直接保留它（如果它是活动的）。

# function - MATLAB 错误：“double”类型的输入参数的未定义函数或方法 X

> ID：197441
> 
> 赞同：20
> 
> 时间：2008-10-13T12:38:38.107
> 
> 标签：function, matlab

我是 Matlab 的新用户，请您帮忙：
我在 .M 文件中有以下代码：

```
function f = divrat(w, C)
S=sqrt(diag(diag(C)));
s=diag(S);
f=sqrt(w'*C*w)/(w'*s); 
```

我已将此文件 (divrat.M) 存储在正常的 Matlab 路径中，因此我假设 Matlab 在启动时会读取该函数，因此该函数应该可以使用。

但是，当我输入

```
>> divrat(w, C) 
```

我收到以下错误

> ？？？“double”类型的输入参数的未定义函数或方法“divrat”。

错误消息告诉我要做什么，我在代码或函数调用中看不到任何错误？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-21T15:38:10.800

当函数不在 MATLAB 路径或 pwd 中时，您会收到此错误。

首先，确保您能够使用以下方法找到该函数：

```
>> which divrat
c:\work\divrat\divrat.m 
```

如果返回：

```
>> which divrat
'divrat' not found. 
```

它不在 MATLAB 路径或 PWD 中。

其次，使用命令确保包含的目录`divrat`位于 MATLAB 路径上`PATH`。可能是您认为在路径上的目录实际上不在路径上。

最后，确保您没有使用“私人”目录。如果`divrat`位于名为 private 的目录中，则父目录中的函数可以访问它，但不能从 MATLAB 命令行访问：

```
>> foo

ans =

     1

>> divrat(1,1)
??? Undefined function or method 'divrat' for input arguments of type 'double'.

>> which -all divrat
c:\work\divrat\private\divrat.m  % Private to divrat 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-20T18:35:17.183

正如其他人所指出的，这很可能是函数文件的路径不在 Matlab 的“路径”中的问题。

验证这一点的一种简单方法是在编辑器中打开您的函数并按下`F5`键。这将使编辑器尝试运行该文件，并且如果该文件不在路径中，它将通过一个消息框提示您。选择`Add to Path`那个，你一定没问题。

附带说明：在上述过程结束时，Matlab 命令窗口会给出一个错误，提示缺少参数：显然，当我们尝试从编辑器运行时，我们没有提供任何参数。但是从现在开始，您可以使用命令行中的函数给出正确的参数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-20T18:45:52.480

此问题的最常见原因是 Matlab 在其搜索路径中找不到该文件。基本上，Matlab 在以下位置查找文件：

1.  当前目录（`pwd`）；
2.  直接在路径上的目录中（要查看路径，`path`在命令行输入）
3.  在上面任何目录中的一个名为的`@(whatever the class of the first argument is)`目录中。

    正如其他人建议的那样，您可以使用 command `which`，但这在这种情况下通常没有帮助 - 它告诉您 Matlab 找不到您已经知道的文件。

    所以首先要做的是确保文件在路径上是可定位的。

    接下来要做的是确保 matlab 正在查找（使用哪个）的文件需要与您实际传递的第一个参数相同的类型。I.el, If`w`应该是不同的类，并且那里有一个`divrat`函数，但`w`实际上是空的`[]`，所以 matlab 正在寻找`Double/divrat`，当只有 a`@(yourclass)/divrat.` 这只是我的猜测，但这经常咬我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T13:11:21.020

错误代码表示找不到函数定义。确保您从`divrat.m`存储文件的同一工作区调用该函数。并确保`divrat`函数不是子函数，它应该是文件中的第一个函数声明。您还可以尝试从同一个`divrat.m`文件中调用该函数，以查看问题是否与工作区选择或函数有关。

顺便说一句，你为什么不简单地说

```
s = sqrt(diag(C)); 
```

会不会一样？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T00:41:03.467

该函数本身是有效的 matlab 代码。问题一定是别的。
尝试从它所在的目录中调用该函数，或者使用`addpath('pathname')`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T13:40:18.327

另外，命名它`divrat.m`，而不是`divrat.M`。这在大多数操作系统上应该无关紧要，但谁知道......

也可以通过`which`命令测试matlab是否能找到函数，即

```
which divrat 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-19T11:38:26.603

我很确定出现这个问题的原因是因为这个函数所属的工具箱（包）的许可证。写`which divrat`看看会是什么结果。如果它返回函数的路径和注释`Has no license available`，则问题与许可证有关。这意味着，软件包的许可证设置不正确。大多数情况下，如果这个功能的包（工具箱）是后来添加的，即在安装原始`matlab`. 请检查并解决许可证问题，然后它将正常工作。

# winapi - 在 Windows 上构建带有 SSL 支持的 libcurl

> ID：197444
> 
> 赞同：44
> 
> 时间：2008-10-13T12:39:40.117
> 
> 标签：winapi, ssl, curl, openssl, libcurl

我在 Win32 C++ 应用程序中使用 libcurl。

我将 curllib.vcproj 项目添加到我的解决方案中，并将我的其他项目设置为依赖它。

如何在启用 SSL 支持的情况下构建它？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-13T21:14:15.430

好吧，由于这篇文章失败了，我不得不自己深入研究这个问题。

***另请查看其他答案和评论，以获取有关其他版本等的更多信息。***

**编辑：自从我发布了这个 Q 之后，curl 主页似乎提供了现成的二进制文件。看看[詹姆斯的回答](https://stackoverflow.com/questions/197444/building-libcurl-with-ssl-support-on-windows/5129202#5129202)。**

## 所以这里是：

-

**预处理器**

需要将以下两个符号提供给预处理器以启用 libcurl 的 SSL：

```
USE_SSLEAY
USE_OPENSSL 
```

（libcurl 使用 OpenSSL 来支持 SSL）

或者，可以将符号直接添加到 libcurl 中名为 setup.h 的文件中，但除非我真的必须这样做，否则我对修改 3rd 方发行版中的代码不太满意。

重建 libcurl 库，我现在收到一些关于 OpenSSL 包含文件未找到的错误。当然，因为我还没有正确设置 OpenSSL 发行版。

**编译 OpenSSL 二进制文件**

我下载了 OpenSSL 0.9.8 源代码发行版并解压。

在源代码分发的根目录中有一个名为 INSTALL.W32 的文件，它描述了如何编译 OpenSSL 二进制文件。构建链需要 perl，所以我安装了最新版本的 ActivePerl。

我在构建时遇到了一些问题，这可能不适用于所有系统，但我会在这里进行介绍，以防有人遇到同样的情况。

根据 INSTALL.W32：

运行以下命令行任务，当前目录设置为源分发根目录：

```
1> perl Configure VC-WIN32 --prefix=c:/some/openssl/dir 
```

（其中“c:/some/openssl/dir”应替换为应安装 OpenSSL 的目录。请勿在此路径中使用空格。在这种情况下，进一步的编译将失败）

```
2> ms\do_ms 
```

对我来说，这一步起初是不成功的，因为我缺少环境变量 OSVERSION 和 TARGETCPU。我将它们分别设置为*5.1.2600*和*x86*。你可能会抱怨 OSVERSION 是“疯狂的”，但仔细观察，这个错误是针对 WinCE 的，不会影响 Win32 设置。要获取您的操作系统版本，请从命令提示符运行“ver”命令或运行 winver.exe。

```
3> nmake -f ms\nt.mak (for static library) 
```

或者

```
3> nmake -f ms\ntdll.mak (for DLL) 
```

源现在编译。在我的笔记本电脑上花了大约 5 分钟。

编译完成后，库或二进制文件已放置在：

*distroot/out32* - 用于静态库构建

或者

*distroot/out32dll* - 用于 DLL 构建

**构建和链接**

现在，回到 Visual Studio 并指出头文件的库和包含路径。包含文件位于**distroot/inc32/openssl**。

请记住添加*libeay32.lib*和*ssleay32.lib*作为链接器输入。

重建 libcurl 项目。

**错误！**

至少对我来说这个版本的 OpenSSL。它抱怨 OpenSSL 标头之一中的 struct typedef。我找不到这方面的任何信息。经过一个小时的谷歌搜索，我打破了自己的原则，并从 OpenSSL 标头中注释掉了 typedef，幸运的是 libcurl 没有使用该符号，因此它构建得很好。

*更新：正如 Jason 所指出的，从 1.0.0a 版本开始，这个问题似乎已经消失。*

现在，为了确认为 libcurl 启用 SSL 支持，运行以下代码：

```
curl_version_info_data * vinfo = curl_version_info( CURLVERSION_NOW );
if( vinfo->features & CURL_VERSION_SSL )
    // SSL support enabled
else
    // No SSL 
```

* * *

就那么简单。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-02-26T19:28:02.503

也许这不是任何人都在寻找的答案，但我只是从 http://curl.haxx.se/download.html 的这个链接下载了预编译[的](http://curl.haxx.se/download.html)[DLL](http://www.gknw.net/mirror/curl/win32/curl-7.21.4-ssl-sspi-zlib-static-bin-w32.zip)

我运行了sharkin提供的测试，`if( vinfo->features & CURL_VERSION_SSL )`结果证明是真的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-09T08:23:38.420

按照 Robert Oschler 的建议，以下是我对作为答案的问题的评论：

您可以使用预处理器符号（USE_WINDOWS_SSPI 和 USE_SCHANNEL 而不是 OpenSSL 的）构建最近的 libcurl (2012)，并为 Windows 提供原生 SSL 支持。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-05-16T11:29:07.657

在 Windows 上使用 Visual Studio 2010 编译 OpenSSL 1.0.0 时，最终抛出 0x2 错误：

> NMAKE：致命错误 U1077：'"C:\Program Files (x86)\Microsoft Visual Studio 10.0 \VC\BIN\cl.EXE"'：返回代码 '0x2'
> 
> 停止。

看来这个错误会因为perl配置文件中的一个标志，即-WX而抛出。正如 MSDN 文档所述：

> 将所有编译器警告视为错误。对于一个新项目，最好在所有编译中使用 /WX；解决所有警告将确保尽可能少的难以发现的代码缺陷。

在配置文件中删除 -WX 出现并重新输入[此处](https://stackoverflow.com/questions/197444/building-libcurl-with-ssl-support-on-windows/199052#199052)所述的命令后，它构建良好并通过了所有测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-05T10:54:48.447

在我的情况下，遵循 curl README 文件就足够了。
我的配置如下：

*   视觉工作室 2015 (VC14)
*   静态库
*   Win64
*   卷曲版本 7.57.0
*   OpenSSL 1.0.2

## libCurl 的编译

1.  在那里下载 libcurl 源：[https ://curl.haxx.se/download.html](https://curl.haxx.se/download.html)
2.  解压文件并进入文件夹`curl-7.57.0\projects`
3.  打开 README 文件并按照说明进行操作，这将引导我执行以下操作：
    *   下载[的 OpenSSL](https://www.openssl.org/source/)
    *   将其解压缩并重命名为`openssl`，**将其放在 curl 文件夹旁边**，这很重要，因为您将打开希望在那里找到 openssl 的 VS 项目。
    *   安装[Perl](https://www.activestate.com/activeperl)
    *   执行实用程序`build-openssl.bat`以执行 openSSL 的编译。使用我的设置，这变成了以下内容：
        `.\build-openssl.bat vc14 x64 release ..\..\openssl\`
        只需运行`.\build-openssl.bat -help`以了解有关参数的更多信息。
        之后，您可以看到 OpenSSL 已编译，因为您在此处获得了一个新文件夹：`openssl\build\Win64`
4.  打开 Visual Studio 项目`curl-7.57.0\projects\Windows\VC14\curl-all.sln`
5.  请务必将 Visual Studio 项目设置为您需要的构建配置（`LIB Release - LIB OpenSSL`在我的情况下）
6.  构建所有
7.  图书馆位于`curl-7.57.0\build\Win64\VC14\LIB Release - LIB OpenSSL\libcurl.lib`

# 评论

*   不要忘记`CURL_STATICLIB`在自己的项目中定义预处理器
*   使用静态库，您必须链接 libcurl 的依赖项，请参阅[此答案](https://stackoverflow.com/a/3419935/519376)
*   您可能不想依赖*LDAP* ，在这种情况下，您可以通过在编译 libcurl`CURL_DISABLE_LDAP` *之前*设置预处理器来禁用它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-16T08:05:02.237

如果您使用 Visual Studio IDE 构建并收到 58 个奇怪的警告，例如

“不一致的 dll 链接 curl_global_init / curl_msnprintf /...”

您应该将 CURL_STATICLIB 添加到预处理器定义中。

所以整个定义行应该是这样的：

USE_SSLEAY；USE_OPENSSL；CURL_STATICLIB。

有了这个，所有的警告都会消失。

有些人会忽略警告并继续使用库，但随后会得到相应的 *error*s，例如 curl_global_init / curl_msnprintf。这可能很烦人。

希望它可以帮助某人。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-17T14:10:07.470

```
\ fatal error C1083: Cannot open include
file: 'stdlib.h': No such file or directory
NMAKE: fatal error U1077::return code 
```

该错误可以通过在 Visual Studio 中执行 vcvarsall.bat 来解决。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-09T07:42:33.090

# 如何在 Windows 上使用 OpenSSL（SSL 支持）构建 libcurl C/C++

1.  安装 libcurl
2.  安装 OpenSSL
3.  使用 OpenSSL 构建 libcurl

* * *

## 安装 libcurl

转到[libcurl 的下载页面并下载](https://curl.haxx.se/download.html)**Source Archives**下的 ZIP 文件。*在我的情况下，它被称为[`curl-7.58.0.zip`](https://curl.haxx.se/download/curl-7.58.0.zip)*

提取存档并`projects/Windows/VC15/curl_all.sln`使用 Visual Studio 打开。

## 安装 OpenSSL

下载 OpenSSL 的 windows 二进制文件。就我而言，我[`Win32 OpenSSL v1.1.0g`](https://slproweb.com/download/Win32OpenSSL-1_1_0g.exe)从[Shining Light Productions 发行版](https://slproweb.com/products/Win32OpenSSL.html)下载了 Windows 安装程序文件。

*我的安装文件夹是`C:\OpenSSL-Win32`.*

## 使用 OpenSSL 构建 libcurl

在`curl_all.sln`Visual Studio 解决方案文件中，将生成配置更改为`DLL Debug - DLL OpenSSL`.

在解决方案资源管理器中，右键单击项目`curl`并转到属性。

在`Linker -> General`修改`Additional Library Directories`并添加路径到您的`OpenSSL directory + \lib`. 就我而言，这是`C:\OpenSSL-Win32\lib`.

应用并关闭属性窗口。

右键单击项目`libcurl`并执行与上一步相同的操作，添加`OpenSSL directory + \lib`到`Additional Library Directories`.`Linker -> General`

在 下`C/C++ -> General`，添加`C:\OpenSSL-Win32\include`到`Additional Include Directories`.

最后去`Linker -> Input`修改`Additional Dependencies`。将所有 lib 文件替换为以下内容：

```
ws2_32.lib
wldap32.lib
openssl.lib
libssl.lib
libcrypto.lib 
```

应用并关闭属性窗口。

在`DLL Debug - DLL OpenSSL`仍然选择构建配置的情况下，转到`Build -> Build Solution`.

将这两个 dll 文件从 OpenSSL bin 目录*(* *)*`libcrypto-1_1.dll`复制到刚刚创建的构建目录。`libssl-1_1.dll`*`C:\OpenSSL-Win32\bin`*`curl-7.58.0\build\Win32\VC15\DLL Debug - DLL OpenSSL`

## 验证构建

在构建目录中，运行`curld.exe`. 如果它运行时没有错误（缺少 dll 等），那么您的构建成功。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-09T06:08:57.253

我为 Windows 7 rc7100 做了“do_nt.bat”，不要忘记“nmake -f ms\nt.mak install”正确复制标题

谢谢这确实有很大帮助

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-19T22:09:19.337

回应和/或补充上述内容的几个注释。

首先，如果你不想弄乱 ActivePerl，[Strawberry Perl](http://win32.perl.org/wiki/index.php?title=Strawberry_Perl)非常棒，并且非常适合这个。

其次，如果可能的话，我建议不要使用**do_ms** .bat，因为根据 INSTALL.W32，我建议使用**do_masm ，**

> 这是值得做的，因为它会产生更快的代码：例如，它通常会导致 RSA 例程的 2 倍加速。

此外，构建*0.9.8l* (L) 的 OpenSSL 是一场噩梦，所以我最终放弃并恢复到*0.9.8k*，它与 libcurl 1.9 构建和链接（静态）没有问题。

# .net - 如何查找 .NET 项目的所有依赖项？

> ID：197447
> 
> 赞同：21
> 
> 时间：2008-10-13T12:39:49.010
> 
> 标签：.net, dependencies

基本上，我需要的是[Dependecy Walker](http://www.dependencywalker.com/)之类的东西，但它应该适用于 .NET 应用程序。有没有这样的工具？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T12:42:28.333

[反射器](http://www.red-gate.com/products/reflector/index.htm)- 以前来自 Lutz Roeder，现在来自 Red-Gate 软件。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-11-15T12:14:36.953

对于 .NET 4，请查看我们的 CheckAsm：[http ://www.amberfish.net/](http://www.amberfish.net/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-07-02T00:56:09.510

我更喜欢[ILSpy](http://ilspy.net)。它是一个开源的 .NET 程序集浏览器和反编译器。是的，它显示了依赖关系。

[反射器](http://www.red-gate.com/products/dotnet-development/reflector/)的体面替代品，不再免费。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-21T09:50:55.523

NDepend 是专门用于依赖管理和可视化的 .NET 工具。该工具提出了一个[依赖图](http://www.ndepend.com/Doc_VS_Arch.aspx)和一个[依赖矩阵](http://www.ndepend.com/Doc_Matrix.aspx)。可[在此处](http://www.ndepend.com/NDependDownload.aspx)免费试用该工具。这是依赖图的 2 个屏幕截图，后面是依赖矩阵：

![NDepend 依赖图](https://i.stack.imgur.com/Yqwup.png) ![NDepend 依赖矩阵](https://i.stack.imgur.com/HuuCA.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T19:37:39.183

在运行时[Systernals](http://www.systernals.com)的[ProcessExplorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)可能有助于查看程序集依赖项。

[NDepend](http://www.ndepend.com/)还可以显示依赖关系以及组件耦合的紧密程度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-18T21:39:49.817

反射器不是免费的，另一个也不是免费的，只是试用。我遇到了同样的问题，发现了这个优秀的工具：

[http://www.codeproject.com/Articles/246858/Depends4Net-Part-1](http://www.codeproject.com/Articles/246858/Depends4Net-Part-1)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-13T16:37:36.360

[`ildasm.exe`](https://docs.microsoft.com/en-us/dotnet/framework/tools/ildasm-exe-il-disassembler)也适用于此目的。

> 此工具随 Visual Studio 自动安装。要运行该工具，请使用开发人员命令提示符（或 Windows 7 中的 Visual Studio 命令提示符）。

`ildasm.exe`在加载程序集时列出命名空间、类型、方法等的树。

[![伊尔达斯曼](https://i.stack.imgur.com/6bslo.png)](https://i.stack.imgur.com/6bslo.png)

您可以**通过双击*MANIFEST*并搜索以 . 开头的行`.assembly extern`**来查看程序集的所有依赖项。

[![IL DASM 清单](https://i.stack.imgur.com/o4VXv.png)](https://i.stack.imgur.com/o4VXv.png)

`ildasm.exe`附带 Visual Studio 或 .NET SDK 安装，因此您很可能已经在您的计算机上安装了它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T12:43:00.563

Dependency Walker 也可以与 .Net 一起使用。

> .Net 层仍然需要调用诸如 LoadLibrary 和 GetProcAddress 之类的核心 Windows 函数来完成实际工作。Dependency Walker 正是在这个核心级别上了解正在发生的事情。因此，虽然 Dependency Walker 可能无法理解应用程序的所有语言特定复杂性，但它仍然能够在核心 Windows API 级别跟踪所有模块活动。

[参考](http://www.dependencywalker.com/faq.html)

# statistics - 为什么 Wemf 和 Google Analytics 告诉我的事情如此不同？

> ID：197459
> 
> 赞同：1
> 
> 时间：2008-10-13T12:44:15.257
> 
> 标签：statistics, count, google-analytics

该网站与 Wemf 和 Google Analytics 一起使用，但它们给了我非常不同的结果；WEMF 的页面浏览量比 Google Analytics（分析）多 10 - 30%... 为什么会这样？

谷歌分析只能在启用 JavaScript 的情况下工作，是的 - 但我认为这不是造成这种差异的原因。应该算的站点是瑞士著名的报纸。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T12:47:07.497

对WEMF了解不多。难道谷歌分析在检测和不计算搜索引擎蜘蛛流量方面做得更好吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T12:53:04.287

是的！！！我在谷歌上搜索了一些“谷歌分析搜索引擎蜘蛛”，看起来谷歌分析并没有计算那些......

非常感谢您提供的信息，帮助很大！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T18:08:07.220

请记住，除了蜘蛛流量之外，一个或其他服务实际上也可能基于页面内的 javascript 丢失跟踪。为什么数字关闭有一百种不同的可能性。我从未见过分析包 100% 匹配，通常如果它们之间的误差在 5% 以内，你就做得很好。

...顺便说一句，我曾在几家大型分析公司工作过，这是众所周知的情况。我之所以说情况，是因为人们也承认没有人对数字有 100% 的正确性——太多的变量无法弥补这种 sigma 水平。

# winforms - 您会选择在您的应用程序中使用哪种导航控件？

> ID：197460
> 
> 赞同：0
> 
> 时间：2008-10-13T12:44:26.693
> 
> 标签：winforms, ribbon, toolstrip, menustrip

带有 MenuStrip 或 RibbonBar 的 ToolStrip？

* * *

它结合了这两个控件。它还有一个 TabPages 导航、上下文选项卡等。但是 RibbonBar 是一个非常复杂的控件，当您在例如 Word2007 中打开一个新文档时，您会看到一个 Ribbon Bar。这并不酷。当您拥有 toolStrips 时，您可以将它们布局到上、下、左、右，并更好地控制 UI 外观。我们还可以隐藏我们不想看到的工具条，它们不再占用任何屏幕空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T12:49:10.177

丝带酒吧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T13:05:51.237

它归结为您要导航的内容以及您希望导航工作的复杂程度。

我更喜欢使用简单的现有应用程序来构建我的程序。

因此，在大多数情况下，我使用 MenuStrip + X ToolStrips 或仅使用简单的 ToolStrip，如果菜单涉及的内容比完成任务所需的更多。

但我不得不猜测很多人喜欢 Ribbon Bar，因为它将 Menu 和 ToolStrips 的功能结合到一个控件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T13:23:18.110

丝带看起来更现代，并有助于为您的应用程序提供现代和当前的外观。

至于可用性，我更喜欢体验，只要您不熟悉该应用程序。

对于习惯了菜单栏的应用来说，这是一个艰难的改变，但对于新应用或新用户来说，这是一个很好的改进。

# c++ - “VC++”和“C++”有什么区别？

> ID：197461
> 
> 赞同：56
> 
> 时间：2008-10-13T12:44:35.943
> 
> 标签：c++, visual-c++

有人问我对 VC++ 有多熟悉，对 C++ 有多熟悉。有什么不同？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-10-13T12:46:20.137

C++ 是实际语言，VC++ 是 Microsoft 的 Visual C++，一个用于 C++ 开发的 IDE。

来自[stason.org](http://stason.org/TULARC/webmaster/lang/c-cpp-faq/20-What-is-the-difference-between-C-and-Visual-C.html)：

> C++ 是编程语言，Visual C++ 是微软的实现。
> 
> 当人们谈论学习 Visual C++ 时，它通常更多地与学习如何使用编程环境以及如何使用 Microsoft 基础类 (MFC) for Windows 相关，而不是任何语言问题。Visual C++ 可以并且将直接编译 C 和 C++。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-13T12:47:25.360

C++ 是一种已被国际标准委员会 (ANSI/ISO) 批准的编程语言的名称。

VC++（“Visual C++”）是微软 C++ 编译器的产品名称，有时，但不是正式的，它附带的 IDE（“Visual Studio”）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T12:47:25.937

嗯，Visual C++ 曾经代表 Microsoft C++ 编译器和 MFC 库。语言本身基本上没有区别，但 VC++ 包含一个库和一些 IDE 支持，用于轻松构建 GUI。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-21T08:56:47.380

vc++是开发环境，c++是语言

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T12:48:45.013

VC++ 对不同的人意味着不同的东西。您可以使用 Visual Studio 环境来构建（几乎）标准的 C++ 应用程序。您还可以将它用于特定于 Micrososft 的添加 - 因版本而异。例如，用于 Windows 应用程序的 MFC 组件，或用于 .NET 应用程序的较新的 C++/CLI

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-13T12:46:27.217

VC++是Visual C++的简称，是微软开发的IDE（集成开发环境），包含在Visual Studio中。C++ 是一种语言。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-13T12:47:24.313

C++ 是一门语言，VC++（Visual C++）是微软的开发环境，它是帮助你编写 C++ 的 Visual Studio 的先驱。

您可以了解有关 C++ 的所有知识，但从未见过 VC++。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-09-30T10:56:38.287

VC++是微软使用微软c++编译器开发的IDE。而C++是编程语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-09T12:25:59.743

在某些情况下，它们指的是其相应的**C++**实现及其编译器。

> **C++**是指标准头文件/函数及其**GCC C++**编译器。
> 
> **VC++**是指 Microsoft 实现的**C++**标准及其**VC++** 编译器。

它们彼此不兼容。Linux 网络/线程函数，数字数据类型与其 Windows 对应物不同。如果不使用 Cygwin/MinGW 等第三方 GCC 端口，则无法直接在 Windows 中编译 Linux **C++代码。**

大多数学术/研究工具和库都是用**C++ (GCC)**编写的，很难用**VC++**编译它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-01T05:56:31.013

Visual C++ 和 C++ 是两个完全不同的东西。不过，它们是相关的。

C++ 是一种高级编程语言，编译器将其翻译成计算机可以理解和执行的机器代码。

Visual C++ 是 Microsoft 创建的一个工具，用于简化 C++ 源代码的编写、编译和调试。Visual C++ 是一个集成开发环境 (IDE)。

[http://www.cplusplus.com/forum/beginner/172353/](http://www.cplusplus.com/forum/beginner/172353/)

# php - 什么是 PHP 的好模板系统？

> ID：197466
> 
> 赞同：5
> 
> 时间：2008-10-13T12:46:45.860
> 
> 标签：php, templates

什么是最好的/最容易集成 PHP 模板系统，使用一个模板系统有什么好处？

我目前根本不使用一个，并且我认为这可能有助于将内容与演示文稿分开一点。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T14:47:07.630

PHP 本身就是一种很好的模板语言。由于这个原因，大多数领先的 PHP 框架不使用单独的模板语言。

只要确保您使用（类似的东西）MVC，并且不要在您的视图文件中执行任何数据访问或业务逻辑。

我也广泛使用 Smarty，但发现它与直接 PHP 相比没有什么优势，除了强迫你保持你的观点愚蠢。对设计师来说，它可能看起来也更好一些，但对你来说，它的缺点是灵活性，模板实现者。循环三重嵌套数组之类的事情比直接使用 PHP 更难。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-13T12:47:49.993

# [聪明的](http://www.smarty.net)

* * *

我发现它快速、易于使用且易于安装（即使在共享主机环境中）。它也不需要您使用验证 XHTML，这有时很方便（尽管我认为**确实**需要有效 XHTML 的模板引擎可能更快。）

将您的内容放在一个地方并在其他地方编写代码真是太好了。

另外，您不仅限于 HTML。我使用 Smarty 生成**XML**甚至**SQL**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T14:51:36.200

要跟进 Alex 所说的话，我建议看一下 Rasmus Lerdorf 的文章[The no-framework PHP MVC framework](http://toys.lerdorf.com/archives/38-The-no-framework-PHP-MVC-framework.html)。

Rasmus Lerdorf 是创建 PHP 的人。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T19:40:07.180

我赌[PHPTAL](http://phptal.motion-twin.com/)。

它检查文件语法并确保输出是格式正确的 XML *，并带有适当的转义*。这确保了页面**对 XSS**攻击是安全的，而程序员不必每次都担心它。

Smarty 和原始 PHP 不会自动处理转义，这意味着每个`echo $foo`or `${foo}`（没有`|escape}`or `htmlspecialchars()`）都可能是 HTML 注入漏洞，或者至少会破坏格式良好。

PHPTAL 有很好的语法，适合 HTML/XML 的工作方式，例如，当您想有条件地将某些内容包装在标签中时，您不必重复自己：

```
<strong tal:omit-tag="condition">
  xxx
</strong> 
```

而不是：

```
{if condition}<strong>{/if}
  xxx
{if condition-again!}</strong>{/if} 
```

并且语法是 XML，但不会过于冗长（大多数情况下只添加了属性）。没有难看的 HTML 和自定义标记类结构的混合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T12:50:42.857

除了 Mark 的经验，我发现 Smarty 非常适合扩展。我已经构建了一个（企业）MVC 框架，它带有基于 Smarty 的内置视图，既简单又灵活。大量可用的模板帮助函数也可以很容易地扩展。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T20:54:32.323

使用模板引擎最令人信服的原因可能是默认输出转义，它可以减少或消除 xss 漏洞。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T13:01:49.607

这取决于您的关注点：不同的模板引擎可以更好地处理不同的事情。[与某些相比， Smarty](http://www.smarty.net/)相对较重，并且定义了一种比 PHP 更简单但更受限制的语法。使用不像编程语言的语法有很多好处，例如，如果您要请图形设计师构建您的模板。

诸如[Savant3 之](http://phpsavant.com/yawiki/index.php?area=savant3)类的模板引擎，或[Zend 框架的](http://framework.zend.com/)[Zend_View](http://framework.zend.com/manual/en/zend.view.html)组件中使用的模板引擎是轻量级的，并且使用 PHP 作为其语法。这为您的模板提供了更多的功能和灵活性，但要求您遵守规则，将业务逻辑排除在模板之外。此外，如果您的设计师要构建模板，PHP 语法可能过于复杂。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T17:21:27.133

我个人喜欢只使用单独的 PHP/HTML 文件的想法。如果我愿意，它允许我使用其他 HTML 编辑器（例如 DreamWeaver），并且还可以允许不了解 PHP 但了解 HTML 的人编辑模板，而无需学习另一种语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T17:40:11.727

我已经使用 Smarty 很多年了，但是因为特殊的 smarty 语法阻碍了我的使用而感到沮丧，在这种情况下，一些简单的 php 会更容易。PHP 本身就是一种模板语言！我了解到 php api 足够适合所有表示逻辑。

因此，Savant3 及其后代 Zend_View 是出色的解决方案。就像在 Smarty 中一样，您可以轻松地为重复性任务编写插件。

# c++ - ATL/WTL 是否仍需要使用全局 _Module 变量？

> ID：197468
> 
> 赞同：5
> 
> 时间：2008-10-13T12:46:55.970
> 
> 标签：c++, atl, wtl

我刚刚开始一个新的 ATL/WTL 项目，我想知道是否仍然需要全局 _Module 变量？

几年前，当我开始使用 WTL 时，需要（至少对于 ATL 3.0）定义一个全局变量，例如：

```
CAppModule _Module; 
```

让 ATL 正常工作。但最近我在某处读到这可能不再需要（但向导生成的代码仍然使用它）。我还通过 Visual C++ 包含目录进行了搜索，它只在几个地方找到了 _Module - 最值得注意的是 ATL COM 注册表的东西。

那么这些天我还需要定义一个全局变量来使用 ATL 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T15:16:18.333

从技术上讲，自 ATL/WTL 版本 7 以来，您不需要全局`_Module`实例。早期的 ATL/WTL 代码`_Module`由该特定名称引用，并希望您声明该对象的单个实例。这已被一个名为的单个实例对象所取代，该对象`_AtlBaseModule`在 atlcore.h 中为您自动声明。

尽管如此，一些最好的 WTL 特性包含在 CAppModule 及其基类 CComModule 中。自动 COM 注册、消息循环处理等。因此，大多数基于 WTL 的重要应用程序仍然需要 CComModule 基类的单例实例。但是，它不需要命名`_Module`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T06:58:15.440

在最新的 WTL 版本的示例项目中，仍然使用这个。

在 stdafx.h 中：

```
extern CAppModule _Module; 
```

在实现文件中：

```
CAppModule _Module; 
```

# java - JPA 和 Hibernate - 标准与 JPQL 或 HQL

> ID：197474
> 
> 赞同：309
> 
> 时间：2008-10-13T12:47:33.067
> 
> 标签：java, hibernate, hql, criteria, hibernate-criteria

[使用Criteria](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch17.html)或[HQL](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch16.html)的优缺点是什么？Criteria API 是在 Hibernate 中表达查询的一种很好的面向对象的方式，但有时 Criteria Queries 比 HQL 更难理解/构建。

您什么时候使用 Criteria，什么时候使用 HQL？在哪些用例中你更喜欢什么？还是只是口味问题？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-10-13T12:54:37.357

我最喜欢动态查询的条件查询。例如，根据某些参数动态添加一些排序或保留一些部分（例如限制）要容易得多。

另一方面，我将 HQL 用于静态和复杂查询，因为它更容易理解/阅读 HQL。此外，我认为 HQL 更强大一些，例如对于不同的连接类型。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2008-12-04T17:30:58.353

HQL 和criteriaQuery 在性能方面存在差异，每次使用criteriaQuery 触发查询时，它都会为表名创建一个新别名，该别名不会反映在任何数据库的最后查询缓存中。这会导致编译生成的 SQL 的开销，需要更多时间来执行。

关于获取策略[[http://www.hibernate.org/315.html]](http://www.hibernate.org/315.html)

> *   Criteria 尊重映射中的惰性设置，并保证加载您想要加载的内容。这意味着一个 Criteria 查询可能会导致几个 SQL 立即 SELECT 语句来获取具有所有非延迟映射关联和集合的子图。如果您想更改“如何”甚至“什么”，请使用 setFetchMode() 启用或禁用特定集合或关联的外连接获取。条件查询也完全尊重获取策略（join vs select vs subselect）。
> *   HQL 尊重映射中的惰性设置，并保证加载您想要加载的内容。这意味着一个 HQL 查询可能会导致几个 SQL 立即 SELECT 语句来获取具有所有非延迟映射关联和集合的子图。如果要更改“如何”甚至“什么”，请使用 LEFT JOIN FETCH 为特定集合或可为空的多对一或一对一关联启用外连接获取，或使用 JOIN FETCH 启用内部连接获取不可为空的多对一或一对一关联。HQL 查询不尊重映射文档中定义的任何 fetch="join"。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2008-10-13T14:42:18.013

Criteria 是面向对象的 API，而 HQL 表示字符串连接。这意味着面向对象的所有好处都适用：

1.  在其他条件相同的情况下，OO 版本不太容易出错。任何旧字符串都可以附加到 HQL 查询中，而只有有效的 Criteria 对象才能将其添加到 Criteria 树中。实际上，Criteria 类受到更多限制。
2.  通过自动完成，OO 更容易被发现（因此更容易使用，至少对我而言）。您不一定需要记住查询的哪些部分在哪里；IDE 可以帮助您
3.  你也不需要记住语法的细节（比如哪些符号去哪里）。您只需要知道如何调用方法和创建对象。

由于 HQL 非常类似于 SQL（大多数开发人员已经非常了解），因此这些“不必记住”的论点就没有那么重要了。如果 HQL 更不同，那么这将更重要。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-13T22:07:33.123

当我不知道哪些输入将用于哪些数据时，我通常使用 Criteria。就像在用户可以输入 1 到 50 个项目中的任何一个的搜索表单上一样，我不知道他们将要搜索什么。当我检查用户正在搜索的内容时，很容易将更多内容附加到标准中。我认为在这种情况下放置 HQL 查询会有点麻烦。当我确切地知道我想要什么时，HQL 很棒。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-10-13T15:28:07.767

HQL 更易于阅读，更易于使用 Eclipse Hibernate 插件等工具进行调试，并且更易于记录。标准查询更适合构建动态查询，其中很多行为是在运行时确定的。如果你不懂 SQL，我可以理解使用 Criteria 查询，但总的来说，如果我知道我想要什么，我更喜欢 HQL。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-07-10T07:21:51.140

条件是指定利用二级查询缓存中的特殊优化的自然键查找的唯一方法。HQL 没有任何方法来指定必要的提示。

您可以在此处找到更多信息：

*   [http://tech.puredanger.com/2009/07/10/hibernate-query-cache/](http://tech.puredanger.com/2009/07/10/hibernate-query-cache/)

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2013-05-08T07:48:57.777

Criteria Api 是 Hibernate 的优秀概念之一。根据我的观点，这些是我们可以在**HQL**和**Criteria Api之间有所不同的几点**

1.  HQL 是对数据进行选择和非选择操作，但 Criteria 仅用于选择数据，我们不能使用条件进行非选择操作。
2.  HQL 适合执行静态查询，而 Criteria 适合执行动态查询
3.  HQL 不支持**分页**概念，但是我们可以通过 Criteria 实现分页。
4.  标准过去比 HQL 需要更多的时间来执行。
5.  使用 Criteria，我们可以安全使用**SQL 注入**，因为它会生成动态查询，但在 HQL 中，因为您的查询要么是固定的，要么是参数化的，因此 SQL 注入是不安全的

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2014-11-09T07:22:50.563

## 标准 API

Criteria API 更适合动态生成的查询。因此，如果您想添加 WHERE 子句过滤器、JOIN 子句或改变 ORDER BY 子句或投影列，那么 Criteria API 可以帮助您以一种同时防止 SQL 注入攻击的方式动态生成查询。

另一方面，Criteria 查询的表达能力较差，甚至会导致非常复杂和低效的 SQL 查询。

## JPQL 和 HQL

JPQL 是 JPA 标准实体查询语言，而 HQL 扩展了 JPQL 并添加了一些特定于 Hibernate 的特性。

JPQL 和 HQL 非常具有表现力，并且类似于 SQL。与 Criteria API 不同，JPQL 和 HQL 可以轻松预测 JPA 提供程序生成的底层 SQL 查询。审查 HQL 查询也比 Criteria 查询容易得多。

值得注意的是，如果您需要修改它们，那么使用 JPQL 或 Criteria API 选择实体是有意义的。否则，DTO 投影是更好的选择。

## 结论

如果您不需要改变实体查询结构，则使用 JPQL 或 HQL。如果您需要更改过滤或排序标准或更改投影，请使用 Criteria API。

但是，仅仅因为您使用的是 JPA 或 Hibernate，并不意味着您不应该使用本机 SQL。SQL 查询非常有用，JPQL 和 Criteria API 不能替代 SQL。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2010-01-11T21:01:56.540

要使用两全其美，HQL 的表现力和简洁性以及 Criteria 的动态特性考虑使用[Querydsl](http://www.querydsl.com)。

Querydsl 支持 JPA/Hibernate、JDO、SQL 和集合。

我是Querydsl的维护者，所以这个答案是有偏见的。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2009-07-06T12:09:05.183

对我来说，Criteria 是一个很容易理解和进行动态查询的方法。但到目前为止我说的缺陷是它加载了所有多一等关系，因为我们只有三种类型的 FetchMode，即选择、代理和默认，并且在所有这些情况下它加载多一（如果有帮助，我可能错了我出去:))

Criteria 的第二个问题是它加载了完整的对象，即如果我只想加载员工的 EmpName，它不会想出这个 insted 它会提供完整的 Employee 对象，因此我可以从中获取 EmpName，因为**它真的很糟糕报告**。HQL 只是加载（没有加载关联/关系）你想要的东西，所以性能会提高很多倍。

Criteria 的一个特点是它可以保护你免受 SQL 注入的影响，因为它的动态查询生成方式与在 HQL 中一样，因为你的查询要么是固定的，要么是参数化的，因此对 SQL 注入不安全。

此外，如果您在您的 aspx.cs 文件中编写 HQL，那么您将与您的 DAL 紧密耦合。

总的来说，我的结论是，有些地方没有 HQL 之类的报告就无法生存，因此请使用它们，否则标准更易于管理。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2008-10-14T12:56:33.423

对我来说，Criteria 的最大胜利是 Example API，您可以在其中传递一个对象，hibernate 将基于这些对象属性构建一个查询。

除此之外，标准 API 有其怪癖（我相信 hibernate 团队正在重新设计 api），例如：

*   一个 criteria.createAlias("obj") 强制内部联接而不是可能的外部联接
*   您不能两次创建相同的别名
*   一些 sql 子句没有简单的条件对应项（如子选择）
*   等等

当我想要类似于 sql 的查询（从用户中删除 status='blocked'）时，我倾向于使用 HQL，而当我不想使用字符串附加时，我倾向于使用条件。

HQL 的另一个优点是您可以预先定义所有查询，甚至可以将它们外部化到一个文件左右。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2012-01-09T22:43:00.107

我们一开始在我们的应用程序中主要使用 Criteria，但后来由于性能问题将其替换为 HQL。
主要是我们使用具有多个连接的非常复杂的查询，这会导致 Criteria 中的多个查询，但在 HQL 中非常优化。
情况是我们只在特定对象上使用了几个属性，而不是完整的对象。对于 Criteria，问题也是字符串连接。
假设您需要在 HQL 中显示用户的姓名和姓氏，这很容易`(name || ' ' || surname)`，但在 Crteria 中这是不可能的。
为了克服这个问题，我们使用了 ResultTransormers，其中有一些方法可以实现这种连接以获得所需的结果。
今天我们主要是这样使用HQL：

```
String hql = "select " +
            "c.uuid as uuid," +
            "c.name as name," +
            "c.objective as objective," +
            "c.startDate as startDate," +
            "c.endDate as endDate," +
            "c.description as description," +
            "s.status as status," +
            "t.type as type " +
            "from " + Campaign.class.getName() + " c " +
            "left join c.type t " +
            "left join c.status s";

Query query =  hibernateTemplate.getSessionFactory().getCurrentSession().getSession(EntityMode.MAP).createQuery(hql);
query.setResultTransformer(Transformers.ALIAS_TO_ENTITY_MAP);
return query.list(); 
```

所以在我们的例子中，返回的记录是所需属性的映射。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2012-01-23T17:12:14.237

Criteria api 提供了 SQL 或 HQL 都没有提供的一项独特功能。IE。它允许对查询进行编译时检查。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2015-12-05T01:14:13.663

*   HQL是对数据进行select和non-select操作，但是Criteria只是对数据进行选择，我们不能使用criteria进行non-select操作
*   HQL 适合执行静态查询，而 Criteria 适合执行动态查询
*   HQL不支持分页概念，但是我们可以用Criteria实现分页
*   标准过去比 HQL 需要更多时间来执行
*   使用 Criteria，我们可以安全地使用 SQL 注入，因为它会生成动态查询，但在 HQL 中，由于您的查询是固定的或参数化的，因此 SQL 注入没有安全性。

[来源](http://www.java4s.com/hibernate/difference-between-hql-and-criteria-query-in-hibernate/)

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2013-01-25T06:54:06.053

动态的条件查询我们可以根据我们的输入构造查询。如果 Hql 查询是静态查询，一旦我们构造我们就不能改变查询的结构。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2016-09-14T08:48:21.913

我不想在这里踢死马，但重要的是要提到现在不推荐使用 Criteria 查询。使用 HQL。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-06-18T09:36:06.270

对于动态查询，我也更喜欢 Criteria Queries。但是我更喜欢使用 hql 进行删除查询，例如，如果从子表中删除父 id 'xyz' 的所有记录，这很容易通过 HQL 实现，但是对于标准 API，我们必须首先触发 n 个删除查询，其中 n 是子表的数量表记录。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-07-18T23:51:50.150

这里的大多数答案都具有误导性，并提到`Criteria Queries`比 慢`HQL`，实际上并非如此。

如果您深入研究并执行一些测试，您会发现***Criteria Queries 比常规 HQL 执行得更好***。

此外，使用**Criteria Query**您可以获得**HQL**所没有的*面向对象控制*。

 **有关更多信息，请[在此处](https://stackoverflow.com/a/4770549/1475228)阅读此答案。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-01-12T19:00:38.133

还有另一种方法。我最终创建了一个基于 hibernate 原始语法的 HQL 解析器，因此它首先解析 HQL，然后它可以动态注入动态参数或为 HQL 查询自动添加一些常用过滤器。效果很好！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-25T03:45:25.023

这个帖子很老了。大多数答案都是关于 Hibernate 标准，而不是 JPA 标准。JPA 2.1 添加了 CriteriaDelete/CriteriaUpdate 和 EntityGraph 来控制要获取的确切内容。Criteria API 更好，因为 Java 是 OO。这就是创建 JPA 的原因。JPQL 在编译时会先翻译成 AST 树（OO 模型），然后再翻译成 SQL。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-05-18T21:46:14.030

另一点是，我认为 Criteria 更适合在它之上构建，而不是在最终代码中单独使用。

它比使用 jpql 或 hql 更适合使用它来构建库。

例如，我使用 Criteria API 构建[了 spring-data-jpa-mongodb-expressions](https://github.com/mhewedy/spring-data-jpa-mongodb-expressions)（与 spring data QBE 一样）。

> 我认为 spring 数据查询生成使用 jpaql 而不是我不明白为什么的标准。

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2013-05-06T05:57:45.940

HQL 可能会导致SQL 注入等**安全问题。**

# .net - 何时使用新的异常类型

> ID：197482
> 
> 赞同：15
> 
> 时间：2008-10-13T12:50:08.210
> 
> 标签：.net, wcf, exception

何时创建新的异常类型而不是使用 .Net 中的内置异常之一的准则是什么？

让我思考的问题是这个。我有一个 WCF 服务，它是一个基本的输入输出服务。如果服务无法创建输出，因为输入无效，我想抛出异常，但是哪个？

现在我只是抛出system.Exception，但这对我来说感觉不对，我不知道为什么，只是感觉不对。如果我用单元测试对其进行测试并且我希望 system.Exception 被抛出，那么我会感到烦恼的一件事。异常也可以由框架或其他代码引发，而不是由我例外抛出的代码引发。然后测试将通过，因为我得到了预期的异常，但它应该失败了。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-13T12:51:25.883

避免投掷`System.Exception`或`System.ApplicationException`自己，因为它们太笼统了。

对于 WCF 服务，有故障契约 - 您可以告诉订阅者处理的通用异常。

使用以下命令标记接口：

```
[FaultContract( typeof( LogInFault ) )]
void LogIn( string userName, string password, bool auditLogin ); 
```

然后，如果有异常，你可以抛出这个特定的错误：

```
throw new FaultException<LogInFault>( new LogInFault(), "message" ); 
```

对您的错误使用`[DataContract]`序列化 - 这使您不必处理异常通常需要的所有序列化内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-13T12:52:19.220

绝对避免为一次性代码以外的任何内容抛出 System.Exception。

如果方法的参数无效，则抛出[ArgumentException](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)（或一些派生的、更具体的异常）。在创建自己的异常之前，请查阅文档以了解现有异常 - 但这样做通常很有用。（当然，您可以从 ArgumentException 派生您自己的异常类型 - 如果您想从多个位置指示某种特定类型的条件，则创建新类型会提供更多信息，而不仅仅是将其放入错误消息中。 )

现在，WCF 中的错误处理很可能与“正常”框架中的错误处理不同——我建议您参考 WCF 特定的文档/书籍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T12:55:48.620

抛出 System.Exception 不是一个好主意。最大的原因是它对调用代码的影响。他们应该如何处理异常？如果调用代码要处理异常，那么他们必须捕获每个异常，这对他们来说可能不是最好的事情。

如果一种情况未包含在标准异常之一中，则如果异常是调用代码应作为特殊情况处理的异常，则应创建一个新的异常对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T12:56:44.093

System.Exception 只能用作 Exceptions 的基类，切勿直接抛出。

该框架已经提供了很多有效的异常类，如 ArgumentException、ArgumentNullException、InvalidOperationException、FormatException、OverflowException 等......

你说你正在做 I/O 的事情，所以一个好主意是查看框架中的类似操作（如 int.Parse）并为类似的错误抛出相同的异常。

或者，如果它们都不符合您的需求，则从现有异常类派生您自己的异常类。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T15:21:02.540

如果抛出 System.Exception，则调用者必须捕获 System.Exception。这两个方面都是禁止的，因为它让我们告诉用户“这不起作用”，而不是更有用的东西。

如果调用者传入了无效参数，则 ArgumentException 很有用。如果您的函数有一个需要为偶数的 int 参数，那么您将抛出 ArgumentException 并告诉调用者哪个参数无效以及原因。但是，如果所有参数都有效但仍然存在问题，您可能需要自定义异常。这样，调用者可以明确地告诉用户出了什么问题。

对我来说，测试真的是在召唤方面。如果我有十几个都做同样事情的 catch，那么我真的只需要一个例外。但是，如果我有一个 catch 并且有一个语句告诉用户三件事中的一件出错了，那么我真的需要三个独特的异常。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T13:00:19.547

> 何时创建新的异常类型而不是使用 .Net 中的内置异常之一的准则是什么？

当没有合适的预定义异常类时。
.NET FW 非常丰富，经常可以找到预定义的异常。

> 如果服务无法创建输出，因为输入无效

[ArgumentException 类（系统）](http://msdn.microsoft.com/en-us/library/system.argumentexception(VS.80).aspx)

> 当提供给方法的参数之一无效时引发的异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T12:53:22.900

总是创建一个新的异常类型（或者如果它适合你，可以使用一个标准类型）。

在这种情况下，您可以将异常作为一个组来处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T13:04:29.927

正如之前的海报所说，您不应该抛出 System.Exception。事实上，如果您在代码上运行 FxCop，它会将其标记为违反规则。

我建议查看 Applied .NET Framework Programming 的第 18 章，或通过 C#（第 2 版）更新的 CLR 的第 19 章以获得详细指导。Richter 在纠正许多开发人员对异常的误解方面做得非常出色。

这两本书都包含框架类库定义的异常列表。查看列表并找出您的代码可能抛出的最具体的异常。如果您可以从异常中恢复，请在该 catch 块中执行此操作。如果您需要多个 catch 块，请将它们从最具体到最不具体进行组织。如果在现有列表中找不到适合该情况的异常，请创建自定义异常。

# javascript - jQuery拖放 - 如何获取被拖动的元素

> ID：197489
> 
> 赞同：37
> 
> 时间：2008-10-13T12:51:32.573
> 
> 标签：javascript, jquery, drag-and-drop

我正在使用 jQuery 库来实现拖放。

如何在拖放时获取正在拖动的元素？

我想在 div 中获取图像的 id。拖动以下元素：

```
<div class="block">
    <asp:Image ID="Image9" AlternateText="10/12/2008 - Retina" Width=81 Height=84 ImageUrl="~/uploads/ImageModifier/retina.jpg" runat=server />
</div> 
```

我有他们示例中的标准删除功能：

```
$(".drop").droppable({
                 accept: ".block",
                 activeClass: 'droppable-active',
                 hoverClass: 'droppable-hover',
                 drop: function(ev, ui) { }
}); 
```

我尝试了各种`ui.id`似乎不起作用的方法。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-13T12:57:00.253

它不是 ui.draggable 吗？

如果你去这里（在 Firefox 中并假设你有 firebug）并查看 firebug 控制台，你会看到我正在做一个 ui.draggable 对象的 console.dir，它是被拖动的 div

[http://jsbin.com/ixizi](http://jsbin.com/ixizi)

因此，您在 drop 函数中需要的代码是

```
 drop: function(ev, ui) {
                 //to get the id
                 //ui.draggable.attr('id') or ui.draggable.get(0).id or ui.draggable[0].id
                 console.dir(ui.draggable)  
       } 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-18T23:11:42.623

```
$(ui.draggable).attr("id") 
```

...

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-04-12T11:17:24.243

ui.draggable() 似乎不再起作用。要获取 id 可以使用

```
$(event.target).attr("id"); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-04T19:24:53.440

**答案在 2017 年有效**

很多时间过去了，我发现当前接受的答案不再有效。

目前有效的解决方案：

```
$('#someDraggableGroup').draggable({
                helper: 'clone',
                start: function( event, ui ) {
                    console.log(ui.helper.context)
                    console.log(ui.helper.clone())
                }
            }) 
```

在这里，`ui.helper.context`指的是您尝试拖动的原始对象，并`clone()`指的是克隆版本。

编辑

以上也是使用该`draggable()`功能查看您正在拖动的对象。为了检测`draggable`在 a 中丢弃了什么对象`droppable()`，以下工作：

```
$('#myDroppable').droppable({
    drop: function(event, ui){
        console.log(ui.draggable.context)
                 OR
        console.log(ui.draggable.clone() )
    }
}) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-02-08T15:24:24.437

我尝试了上述大部分方法，但最后只

```
event.target.id 
```

为我工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-13T13:09:04.537

redquare 是对的，在你的函数里面是指`ui.draggable`：

```
$(".drop").droppable({ accept: ".block", 
                       activeClass: 'droppable-active', 
                       hoverClass: 'droppable-hover', 
                       drop: function(ev, ui) { 
                           //do something with ui.draggable here
                       }
}); 
```

该属性指向被拖动的东西。

请注意，如果您使用克隆的“助手”，则可拖动对象将是克隆副本，而不是原始副本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-20T05:58:22.920

我有

```
drop: function( event, ui ) {alert(ui.draggable.attr("productid"));} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-16T06:54:06.283

**如何在任何 jquery ui 操作中操作克隆对象？**

只需针对 ui 外部 html 并使用普通的 html jquery 选择器

```
var target_ui_object_html=$(ui.item.context).attr("your attributes"); 
```

> attributes => id ,class ,rel,alt ,title 或自定义属性，如 data-name , data-user

# windows - 如何确定应用程序正在使用的窗口句柄数？

> ID：197497
> 
> 赞同：5
> 
> 时间：2008-10-13T12:55:27.653
> 
> 标签：windows, winapi

确定应用程序正在使用多少窗口句柄的最佳方法是什么？是否有我可以使用的工具或 WMI 性能计数器？

我想运行一个应用程序并观察某种计数器，看看窗口句柄的数量正在增加。

```
for (int i=0; i < 1000; i++)
{
    System.Threading.Thread.Sleep(1000);
    RichTextBox rt = new RichTextBox();
    rt.Text = "hi";
    this.Controls.Add(rt);
} 
```

我正在运行上面的代码并观察进程上的“Handle Count”计数器，它似乎并没有增加。有什么我看错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-13T12:56:55.467

您的计算机附带的 Perfmon 可以做到这一点。您还可以在任务管理器进程选项卡（句柄计数）中添加一列。

Perfmon 使用说明

1.  添加计数器（单击 +）
2.  在 Performance 对象下选择 Process
3.  在计数器列表下选择 Handle Count
4.  从实例列表中选择您的流程
5.  点击添加，点击关闭

要使图表处于范围内，您必须在列表中右键单击它，选择属性，然后选择正确的比例（.1 或 .01 可能是正确的）

编辑（响应添加的信息）：我认为您刚刚证明创建 RichTextBoxes 不会导致分配句柄。我认为在您编辑控件之前它并不真正需要它，并且它可能足够聪明地做到这一点，因为为不活动的控件分配太多资源会使得很难在一个控件上拥有很多控件表单（例如，想想 Excel）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T13:31:16.583

[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)在交互式监视 Windows 进程使用的各种资源方面非常方便。

> Process Monitor 是用于 Windows 的高级监控工具，可显示实时文件系统、注册表和进程/线程活动。

注意 - 如果您的意思是以编程方式查找信息，*.Net*提供对所有性能计数器的访问。您可以像这样使用[System.Diagnostics.PerformanceCounter](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter(VS.71).aspx)类：

```
PerformanceCounter PC=new PerformanceCounter();
PC.CategoryName="Process";
PC.CounterName="Handles";
PC.InstanceName="MyProc";
MessageBox.Show(PC.NextValue().ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T17:44:10.767

taskmanager 显示的句柄计数与 PerfMon 显示的相同

sysinternals 的 ProcessExplorer 工具可以列出进程使用的不同类型的句柄 + 它们的名称，您可以通过浏览该列表来了解程序使用的句柄的组成。

但恐怕它不会为您总结这些句柄类型计数。

使用 ProcessExplorer 查看实际句柄及其类型 - 查看 - 显示下部窗格视图 - 句柄。

您还可以使用某种窗口间谍工具来显示系统中的所有窗口，例如 Microsoft spy++ 或 Managed Spy++ ( [http://msdn.microsoft.com/en-us/magazine/cc163617.aspx](http://msdn.microsoft.com/en-us/magazine/cc163617.aspx) )

这将允许您查看是否正在创建您的窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-30T08:31:45.043

Perfmon 或任务管理器无法为您提供进程使用的 WINDOW 句柄数，而只能提供所有类型（文件、线程等）句柄的总数。

我能找到的关于该主题的最佳信息是[这篇](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/1d4e53a7-5697-49b4-913b-d1d4606eb372)文章，它表明进程的窗口句柄计数可以通过枚举主进程窗口的所有子窗口来确定。

# php - PHP mime_content_type() 在 Windows 上失败

> ID：197508
> 
> 赞同：3
> 
> 时间：2008-10-13T12:58:49.487
> 
> 标签：php, windows, apache, xampp, mime-types

我知道 mime_content_type() 已被弃用，但在我看来，目前的替代方案更糟。`Finfo`似乎需要在 Windows 上添加文件和更改 ini 方向；我不想为我正在制作的脚本要求这个。

我需要找到文件的 mimetype，但是`mime_content_type($filename)`在 windows 上调用时它失败了。mime_magic.magicfile 指向正确的文件，但是在 ini 文件中启用 mime_magic.debug 时，我收到以下错误消息：

`**Warning:** mime_content_type()[[http://www.php.net/mime_magic]](http://www.php.net/mime_magic]): mime_magic not initialized in **C:\xampp\htdocs\test.php** on line **2**`

我不确定这是否是一个问题，或者当我禁用调试时它是否仍然发生并且它只是没有告诉我。

我检查了，并`extension=php_mime_magic.dll`在 ini 文件中启用，httpd.conf 指定

```
LoadModule mime_module modules/mod_mime.so
#LoadModule mime_magic_module modules/mod_mime_magic.so
```

我正在使用 XAMPP 1.6.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T13:08:43.960

这可能与[此错误报告](http://bugs.php.net/bug.php?id=38235)有关。当您按照以下方式调用脚本时，您的错误日志中是否有任何错误`'FOO' is not a valid mimetype, entry skipped`？

不幸的是，该特定线程中的最终响应是继续使用`[Fileinfo](http://pecl.php.net/package/Fileinfo)`..

阅读描述相同问题的[另一个线程](http://www.daniweb.com/forums/post537410.html)- 当您打开调试时，您是否将其设置为“开”或 1？不应该有所作为，但在上面链接的线程中，这似乎是这种情况下解决方案的一部分。

* * *

> 我不确定这是否是一个问题，或者当我禁用调试时它是否仍然发生并且它只是没有告诉我。

`mime_content_type`当您在关闭调试的情况下回显 的值时，您会得到什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T21:32:32.587

> Finfo 似乎需要在 windows 上添加文件和更改 ini 方向；我不想为我正在制作的脚本要求这个。

你试过[`finfo_buffer`](http://docs.php.net/manual/en/function.finfo-buffer.php)吗？这允许您将文件用作字符串，因此您可以执行以下操作：

```
$finfo = new finfo;
$filename = $_GET['filename'];
var_dump($finfo->buffer(file_get_contents($filename))); 
```

该错误报告中还有一个问题是 mime 数据库已过时 - 您是否尝试过使用不同的副本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-10T20:04:28.770

Fileinfo 可能是在 Windows 上运行的一个技巧。此处的说明：http: //forums.zend.com/viewtopic.php?f=8& [t=337#p14681](http://forums.zend.com/viewtopic.php?f=8&t=337#p14681)

# c++ - 如何使用数据访问对象进行序列化和关系数据库数据访问

> ID：197509
> 
> 赞同：1
> 
> 时间：2008-10-13T12:59:19.640
> 
> 标签：c++, design-patterns, serialization, persistence, data-access-layer

我正在开发一个 C++ 域模型类库，它应该提供一些设施或框架（即接口类等），用于向二进制文件和 RDBMS 写入/读取类实例数据。这个库的基础是一个使用 RDBMS 的应用程序，并且有几个方法通过执行一系列数据库检索和更新调用来获取成员数据的集合来实例化一个类。序列化数据访问具有不同的数据组织方式，因此我希望域模型完全不知道主键/外键、ID 等。

为了解决这个问题，我考虑使用[数据访问对象](http://en.wikipedia.org/wiki/Data_Access_Object)(DAO) 模式，并希望对 DAO 对象的“粒度”、生命周期和使用提供一些建议（在您的回复中，请注意我将使用 C++ ，而不是 Java，并且域类不能保存来自 RDBMS 或二进制文件存储的任何 ID/密钥信息）：

1.  域对象的每个 Foo 实例是否都有自己的 FooDAO 实例，或者 Foo 类的所有实例是否都有一个 FooDAO 实例？
2.  FooDAO 是为每个 Foo 实例创建一次，还是仅在需要访问数据时才创建 FooDAO 实例，然后立即销毁？
3.  DAO 上的[J2EE](http://java.sun.com/blueprints/corej2eepatterns/Patterns/DataAccessObject.html)页面除了 DAO 之外还引入了 DTO。为什么 DAO 不能传输数据？
4.  对于具有其他域类 Bar 的实例的复杂域类 Foo，FooDAO 类似乎不可避免地使用 BarDAO 类来检索数据。这将导致域类结构和 DAO 类结构中的并行层次结构/依赖关系。如何最好地管理它？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:35:15.373

我没有给你一个好的解决方案，但我可以告诉你我有什么，以及一些想法和经验。基于我之前看到的模型，我构建了一些非常相似的东西，作为 C++ 库。

一些想法，没有特别的顺序：

*   为数据库中的每个实例拥有一个单独的 DAO 对象实例。如果你有一个共享实例，线程同步可能是个问题，你会被迫做很多副本。
*   出于几个原因，我的库 DAO 类使用与 RDBMS 类型密切相关的类型。首先，该库支持在底层数据存储中自动创建和更新存储，因此类需要有足够的信息来创建表。其次，它使数据转换更加容易，并且可优化（例如，您可以使用本机接口直接进行 ODBC/OLEDB 数据复制）。缺点是你不能在 DAO 对象中拥有“好的”类类型（例如：比实际字符串缓冲区具有更多数据的字符串抽象）。
*   当然，我是按需创建的，因为存储中的数据可能比实际放入内存中的数据要多得多。
*   我尽量保持 DAO 类简单，访问器功能最少，并且“接近”底层数据结构。这意味着没有从其他 DAO 类继承，实例具有关键变量成员等。

在 DAO 类之上，我构建了更易于访问的类，这些类代表我的应用程序中的数据，并且可能会或可能不会将 1-1 映射到 DAO 类。这些允许具有任何类型的成员和结构，应该是应用程序使用的，并且具有将数据复制到/从作为它们基础的 DAO 类的方法。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T21:31:35.747

我不知道最好的实现，但这是我所看到的：

1.  为每个实例分开。
2.  在需要它之前创建并在之后立即销毁。
3.  不知道。
4.  合并 DAO 实例之外的数据，从而避免耦合。

免责声明：这正是我所看到的。

# com - 我可以创建一个带有多个控件的 VB6 OCX 吗？

> ID：197518
> 
> 赞同：1
> 
> 时间：2008-10-13T13:00:56.237
> 
> 标签：com, vb6, ocx

我继承了一大堆 VB6 代码，其中包含大量单独的 OCX 文件，每个文件都包含一个控件。我有两个问题：

首先，是否可以重构它们，以便我可以拥有一个包含所有 OCX 的 OCX 文件？

其次，如果可能的话，我该怎么做？

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T00:50:27.227

是的，这是可能的。

您可以通过从现有 ActiveX 用户控件项目中选择**项目->添加用户控件来完成此操作。**从这里您可以选择向项目添加新控件或添加现有用户控件。

此外，将相关控件组合到一个项目中当然是有意义的，只要您根据某种逻辑对控件进行分组。例如，Forms 2.0 库将“常用”控件（文本框、复选框、组合框、标签等）组合到一个库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T00:51:05.740

虽然您可以在单个 OCX 中拥有多个控件，但请务必使用一些远见。您不想让您在 VB 项目中很少使用的控件弄乱您的工具箱，而只使用您经常使用的控件。

此外，如果您不使用所有这些控件，则在单个 .ocx 中捆绑多个控件可能会增加应用程序大小和加载时间方面的开销。也许这些在单独的文件中是出于这些和其他值得考虑的原因，然后再进行重新考虑。您可能希望咨询前编码员（如果可行）以确定他们这样做的理由。

# c# - 使用列表的最佳方式 并暴露 Collection

> ID：197521
> 
> 赞同：8
> 
> 时间：2008-10-13T13:01:43.567
> 
> 标签：c#, web-services, generics, fxcop

我必须实现一个 Web 服务，它公开一个值列表（整数、自定义类等）。我的工作解决方案返回 a `List<T>`，根据 FxCop 最好返回 a `Collection<T>`or `ReadOnlyCollection<T>`。

如果我选择返回 a `ReadOnlyCollection<T>`，Web 服务会显示如下错误：

> 为了 XML 可序列化，继承自的类型`ICollection`必须`Add(System.Int32)`在其继承层次结构的所有级别上都有实现。 `System.Collections.ObjectModel.ReadOnlyCollection` `1` `[[System.Int32, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]`不执行`Add(System.Int32)`。

您最喜欢在内部使用 a`List<T>`和公开 a 的方式是`Collection<T>`什么？（使用 C#，最好只使用 framework 2.0）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T13:05:46.587

List<T> 或 Collection<T> 在这种情况下很好。

就原始问题而言，您可以非常简单地将 List<T> 包装在 Collection<T> 中：

```
List<Foo> list = new List<Foo>();
// ...
Collection<Foo> col = new Collection<Foo>(list); 
```

这是一个真正的包装器；将一个项目添加到包装器（col），它被添加到列表中。这可能有点令人困惑，因为许多这样的构造函数使用参数来进行初始填充，但不链接到原始列表。Collection<T> 是一个例外；-p

由于您处于 Web 服务边界，因此 FxCop 的建议不适用。这对于防止调用者踩踏被调用者的内存很有用（与[Eric Lippert 最近的博客](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)一致） - 但在 Web 服务分布式场景中根本不适用。事实上，由于 web 服务在某些通用场景中存在一些有据可查的问题，因此可以说简单的数组在 web 服务边界上是非常有用和实用的。在 Eric 博客的上下文中 - 在这种情况下，调用者/被调用者问题没有问题，因为两者之间存在强制障碍。

就 WSDL/mex 而言，我怀疑所有 3 个（列表/集合/数组）都将成为一个元素块 - 所以你可以选择最方便的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:06:56.057

I usually return IList<T> from a WCF web service: FxCop is happy enough with this. Not sure if this works with ASMX web services.

# .net - 通过互联网收费的最简单方法是什么？

> ID：197525
> 
> 赞同：14
> 
> 时间：2008-10-13T13:04:18.850
> 
> 标签：.net, asp.net-2.0, payment

我有一个 .Net 2.0/3.5 WebApplication。

我希望能够通过互联网为我的服务赚钱。

我的每个客户都会有一个 AccountNo。

我希望提供几种产品，每种产品都有固定的价格。

我需要我的客户登录到我的系统并选择为他们选择的产品付款，并且我的应用程序需要在完成时意识到这一点，以便我可以调整他们的帐户以反映这一点。

拿他们钱的最简单（最简单的编码）方式是什么？

贝宝、NoChex、谷歌结账，还有别的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T13:06:00.330

[贝宝](https://www.paypal.com/)是相当直接和**安全**的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-13T13:19:08.807

我已经使用 2checkout.com 多年，发现它是一个很好的解决方案。我最终改用了 regnow，但这只是因为我想利用他们的联盟网络。

以下是一些选项：

*   [2checkout.com](http://2checkout.com)
*   [regnow](http://regnow.com)（也有附属网络）
*   [贝宝](https://www.paypal.com/)- 与大多数人的想法相反，您不需要贝宝帐户即可向您购买。
*   [谷歌结帐](http://checkout.google.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T13:09:45.953

[亚马逊灵活支付服务](http://aws.amazon.com/fps/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T13:07:43.073

谷歌和雅虎都提供体面的服务，他们不要求你的客户创建一个帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T13:23:10.607

选择提供商时要记住的一件事是您是否需要定期付款模式。您的产品是作为一次性费用收取的，还是按照订阅模式收取的更多费用？像 Paypal 这样的东西对定期付款的支持有限。 [1]

[1] 至少，当我不久前调查它时，他们做到了。现在可能变了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T13:53:20.407

我在 PlugNPay 方面有很好的经验。他们的支持人员反应迅速，API 易于使用。

[http://www.plugnpay.com/](http://www.plugnpay.com/)

# coding-style - 您会建议将哪些实际项目作为代码示例进行研究？

> ID：197571
> 
> 赞同：5
> 
> 时间：2008-10-13T13:27:08.680
> 
> 标签：coding-style

你会建议查看哪些真实世界的项目？

在我学习 Java Swing 时，[mucommander](http://mucommander.com)似乎是一个不错的例子。虽然代码被过度注释。

编辑：没有无耻的插头 plz :)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T13:30:54.977

[通过查看GoGrinder](http://gogrinder.sourceforge.net/)的源代码，我学到了很多东西。它经过深思熟虑，正确使用 MVC，并且评论很有帮助（不，我没有写它）。如果您想学习如何下[围棋](http://en.wikipedia.org/wiki/Weiqi)，它也是一个有趣的程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T13:33:26.483

对于 Gui 设计、模式和一般的好建议，我强烈推荐 Jeremey Miller 关于构建更好的 CAB 的系列文章。对于 C#，但同样适用于 Java。还使用 Stackoverflow 遵循的 MVC 样式，以及 Apple 用于 Interface Builder。

[建立自己的驾驶室](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)

[Jeremy 的文章/想法在他自己的项目中得到遵循，您可以在http://storyteller.tigris.org/](http://storyteller.tigris.org/)下载和查看

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T13:36:04.170

这些年来我为学习一些新技术所做的就是寻找既符合您正在寻找的标准又让您感兴趣的开源项目。

我不是 Swing 人，但我建议找一个使用 Java Swing 的项目，看起来不太复杂，然后开始挖掘源代码。好消息是，您可以在开始浏览之前查看该应用程序，然后您可以看到更改内容时会发生什么。

选择你感兴趣的东西背后的想法是它会让你保持参与。我对内容管理系统很感兴趣，所以我可能会下载一个 CMS，然后我可以看到这些东西是如何工作的，我之所以参与是因为项目的问题域符合兴趣。

当我不得不加快 C# 的速度时，我已经这样做了一次或两次，我认为它会奏效。YMMV....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T13:44:09.503

看看 Windows 版本的 truecrypt。这是我见过的组织得最好的开源项目之一。你几乎可以从目录和文件布局中看出整个事情是如何工作的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T13:56:35.393

我在开源项目中看到的一些经过深思熟虑的源代码 (c++) 是 Ogre3D 图形引擎，仅通过查看结构和阅读评论，我就学到了很多关于 OOA&D 的知识。它也维护得很好，社区非常活跃.. [http://ogre3d.org](http://ogre3d.org)

# design-patterns - 开发 VSX 包或独立 Shell 包时使用哪些最合适的模式？

> ID：197589
> 
> 赞同：2
> 
> 时间：2008-10-13T13:33:57.963
> 
> 标签：design-patterns, vsx

当我开发一堆设计器/工具时，与 VSX 包和/或 VSX 隔离外壳包一起使用的一些最适合的模式是什么？

任何样本，链接都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:41:24.077

如果您正在寻找通用设计模式，我建议您查看[演示模型模式](http://msdn.microsoft.com/en-us/library/cc707885.aspx)（也称为 MVP 和 MVVM）来编写自定义设计器。

一般来说，所有的 VSPackages（无论是哪种工具）都使用[服务定位器模式](http://msdn.microsoft.com/en-us/library/cc707905.aspx)（即 IServiceProvider）与 IDE 和其他 VSPackages 进行通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-12T11:33:38.190

除了 IoC 和 DI（服务定位器），我在较大的包中“替换” IServiceProvider 为我自己的服务等的 Castle（搜索 Castle 项目）。然后是 MVP/MVC 或者只是 PresentationModel。

我倾向于使用命令模式来绑定 vsct 文件中定义的菜单项。

除此之外，我使用我认为合适的任何模式或实践，就像在常规 .NET 解决方案、工厂、构建器、观察者等中一样。

我还倾向于使用面向方面的编程来处理其他横切关注点中的异常策略（请参阅[PostSharp](http://www.postsharp.org/)）

# c# - 异常处理实践

> ID：197593
> 
> 赞同：10
> 
> 时间：2008-10-13T13:35:15.670
> 
> 标签：c#, exception

无论如何，我对何时传播异常以及何时包装它以及它们之间的区别有点困惑。

目前，我的理解告诉我，包装异常将涉及采取像 DriveNotFound（在 IO 中）这样的异常，然后用一般的 IOException 包装它。

但是对于传播异常的概念，这是否只有在我有一个空的 catch 子句时才会发生？因此，在 ASP.NET Web 应用程序中，它会传播到 global.asax。或者在最近部署的 Web 应用程序的情况下，未处理的 HTTPException 导致黄屏死机并将日志写入 Windows Server（这是我正在重写的 Web 应用程序）。因此异常发生在方法中，可以在类级别处理，显示在页面中，然后上到 global.asax 或 Windows Server。

为什么我想用更通用的异常来包装异常？规则是处理具有最特定类型的异常（因此 DriveNotFound 显然是未找到驱动器）。另外，我将如何在包装和替换异常之间进行选择？

异常处理链只是 try 和 catch（或 catches）子句吗？我从措辞上假设，是的。

最后，为什么以及如何让异常传播到调用堆栈？

我确实阅读了关于异常处理的 MS PandP 指南，但我想这些示例并没有让我充分理解所有内容。

这个问题来自企业库包装/传播异常等的能力。这是我不确定的传播，以及替换/包装异常的差异。

此外，是否可以在 catch 块中插入复杂的错误处理逻辑（例如 ifs/elses 和类似的东西）。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-14T00:23:05.097

不少于6个问题:-)

> > 但是对于传播异常的概念，这是否只有在我有一个空的 catch 子句时才会发生？

异常将向上传播，直到它被调用堆栈中更上层的 catch 块捕获，该调用堆栈处理该特定异常的类型或更接近该异常层次结构的基类型的异常类型。因此，例如，所有托管异常都派生自 System.Exception，因此拦截 System.Exception 的 catch 块将捕获每个托管异常。

> > 为什么我想用更通用的异常来包装异常？

我不确定您所说的“包装”是什么意思。您的意思是捕获一个异常，将其替换为另一个异常，然后将原始异常添加为新异常的 InnerException 属性？或者是其他东西？

我认为很少有充分的理由用更通用的异常替换异常。但是您当然可以将一个异常替换为另一个异常，原因有 3 个中的一个或多个：

*   向调用者隐藏实现细节。
*   提高抽象级别，使其对调用者更有意义。
*   抛出一个非常特定于手头问题的自定义异常。

> > 另外，我将如何在包装和替换异常之间进行选择？

对不起，但我仍然不明白你是如何将这两者定义为不同的。

> > 异常处理链只是 try 和 catch（或 catches）子句吗？

以下是抛出异常时发生的基本情况：

*   CLR 依次遍历本地 Try...End Try 块中的 Catch 块列表，查找具有与引发的异常匹配的异常过滤器的本地 Catch 块。

*   如果本地 Catch 块的异常过滤器与所引发的确切异常匹配，则执行该 Catch 块中的代码，然后执行 finally 块中的代码。然后在 End Try 之后的第一条语句处继续执行。

*   或者，如果抛出的异常源自本地 Catch 块指定的异常，则会发生与第二步中所述相同的操作。例如，捕获 ArgumentException 的异常过滤器还将捕获从 ArgumentException 派生的异常，例如 ArgumentNullException、InvalidEnumArgumentException、DuplicateWaitObjectException 和 ArgumentOutOfRangeException。

*   如果没有本地 Catch 块与引发的异常匹配，CLR 会逐个方法返回调用堆栈，寻找想要响应异常的 Catch 块。如果在调用堆栈中没有找到匹配的 Catch 块，则认为该异常未处理。

*   或者，如果在调用堆栈的某处找到匹配的 Catch 块，则执行 throw 和 catch 之间的每个 finally 块中的代码。这从属于抛出异常的 Try 块的 finally 开始，并以在捕获异常的方法下方的方法中的 finally 结束。

*   在对下面捕获异常的所有方法完成此清理后，控制将转移到捕获异常的 Catch 块，并执行此代码。接下来要运行的是 Try 的 finally 块，在该块中捕获了异常。现在调用堆栈已经展开并且错误清理已经完成，最后一步是在捕获异常的 End Try 之后的第一条语句处继续执行。

*   如果 Catch 块中的代码导致引发另一个异常，则使用 InnerException 属性将原始异常自动附加到新异常。通过这种方式，可以堆叠异常而不会丢失任何信息。

*   您应该避免将清理代码放在可能引发异常的 finally 块中，除非该代码位于其自己的 Try 块中。如果没有这种额外的保护，CLR 的行为就好像新异常是在 finally 块之后的 end 之后抛出的，并在调用堆栈中查找想要响应新异常的远程 Catch 块。除非原始 Catch 块保存原始异常，否则它将丢失。

> > 最后，为什么以及如何让异常传播到调用堆栈？

为什么：当你没有特别理解异常并且知道如何从中恢复时，你应该让它向上传播。

如何：仅捕获您理解并知道如何处理的异常类型。有时您需要任何异常的详细信息才能进行适当的恢复。在这种情况下，您可以接住它，进行恢复，然后使用投掷重新**投掷；**陈述。

> > 此外，是否可以在 catch 块中插入复杂的错误处理逻辑（例如 ifs/elses 和类似的东西）。

通常是的，因为由 Catch 块中的代码引起的任何新异常都会通过 InnerException 属性自动附加旧异常。但是如果你能避免它，那么激发这个机制是不明智的，所以你拥有的代码越简单越好。保持 Catch 代码简单的另一个好理由是，它通常不会像您的主线代码那样经过相同程度的测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T13:37:36.927

这一切都是为了向您的来电者传达正确的含义。我怀疑是否有理由将特定异常包装在更通用的异常中 - 这对任何人都没有帮助。

考虑一个与文件访问无关但在后台访问配置文件的 API。如果配置文件不存在，您可以将其包装`FileNotFoundException`在 a 中`ConfigurationException`，以便将正确的问题传达给调用者。

> 为什么以及如何让异常传播到调用堆栈？

如果你不能处理它，你会让异常传播。就是这么简单。如果您的代码无法或应该做任何事情来解决异常，那么让它传播。传播时，请注意如何进行：

```
throw ex; 
```

不同于：

```
throw; 
```

前者丢弃旧的堆栈跟踪并从引发异常的点创建另一个。后者保留原始堆栈跟踪。

当然，如果您无法处理异常，那么您可能一开始就不会费心去捕捉它（也许您想记录一下）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T13:47:46.657

已经有一个相当好的问题，有很多好的答案和讨论。看这里：

[Windows 窗体应用程序中异常处理的最佳实践？](https://stackoverflow.com/questions/183589/c-windows-forms-best-practice-exception-handling#183626)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T14:00:34.213

我通常这样做：

*   除非完全理解，否则业务逻辑程序集 (dll) 不会处理异常
*   预期但无法处理的异常被包装在单个异常类型中，并允许汇总调用堆栈（即，在数据库交互期间可能发生的所有不同异常都被包装在单个 RepositoryException 中并抛出）
*   允许传播意外的异常（永远不要`catch(Exception ex)`在 dll 中包含 a）
*   仅在最后可能的时刻（即 UI 控制器）处理异常

它通常只在调用堆栈的最深处，您确切地知道自己在做什么（当前的业务流程是什么）以及如何正确处理异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T14:33:18.107

这是我找到的在 .NET 中实现连贯异常处理策略的最佳资源

[http://msdn.microsoft.com/en-us/library/cc511522.aspx](http://msdn.microsoft.com/en-us/library/cc511522.aspx)

# c# - 使用 WebRequest 和 Sockets 上传和下载比较

> ID：197603
> 
> 赞同：1
> 
> 时间：2008-10-13T13:39:04.820
> 
> 标签：c#, networking, ftp

嗨，我正在开发一个 FTP 客户端，有人可以告诉我使用`WebRequest`套接字（直接网络流）在 FTP 服务器上下载和上传文件的速度和效率的差异。（我们的文件将是视频流。）我使用的是 C#3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T13:56:53.877

这没有广泛测试的好处，但我过去使用过这两种方法。WebRequest 做了一些从 Stream 类的继承，实际上只是一个方便的包装器，用于完成您需要的工作。我认为，您可能面临的任何损失都可以忽略不计。在最坏的情况下，也许只有少量的 RAM。享受额外的功能，这就是它被创建的原因。

# c# - 将 C# 方法转换为 C++ 方法

> ID：197606
> 
> 赞同：3
> 
> 时间：2008-10-13T13:40:30.947
> 
> 标签：c#, c++, interop, cuda, gpgpu

我正在探索将常见 C# 代码构造映射到 C++ CUDA 代码以在 GPU 上运行的各种选项。系统结构如下（箭头代表方法调用）：

C# 程序 -> C# GPU 库 -> C++ CUDA 实现库

GPU 库中的方法可能如下所示：

```
public static void Map<T>(this ICollection<T> c, Func<T,T> f)
{
   //Call 'f' on each element of 'c'
} 
```

这是 ICollection<> 类型的扩展方法，它在每个元素上运行一个函数。但是，我想做的是调用 C++ 库并让它在 GPU 上运行方法。这将要求函数以某种方式翻译成 C++ 代码。这可能吗？

详细地说，如果我的库的用户执行一个方法（在 C# 中），其中包含一些任意代码，我想将此代码转换为 C++ 等效项，以便我可以在 CUDA 上运行它。我觉得没有简单的方法可以做到这一点，但我想知道是否有任何方法可以做到这一点或达到一些相同的效果。

我想知道的一件事是捕获要在表达式中翻译的函数，并使用它来将其映射到 C++ 等价物。有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T13:51:35.947

如果您想了解如何在 GPU 上运行 C#，可以参考[CUDA.Net 。](http://www.gass-ltd.co.il/en/products/cuda.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T13:57:13.613

老实说，我不确定我是否完全理解您的意思。但是，您可能对这个项目感兴趣，该项目将 .Net 应用程序/库转换为直接的 C++，无需任何 .Net 框架。 [http://www.codeplex.com/crossnet](http://www.codeplex.com/crossnet)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-10T12:18:43.757

我建议使用以下过程来加速您在 C# 程序中使用 CUDA 的一些计算：

*   首先，创建一个***非托管***C++ 库，您可以为要加速的函数 P/Invoke。这将或多或少地限制您可以在 CUDA 中轻松使用的数据类型。
*   将非托管库与 C# 应用程序集成。如果你做的事情正确，你应该已经注意到某种加速。如果没有，你可能应该放弃。
*   替换库中的 C++ 函数（不更改其接口）以使用 CUDA 内核在 GPU 上执行计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T22:38:55.677

有趣的问题。我不是 C# 方面的专家，但我认为 ICollection 是*objects*的容器。例如，如果 c 的每个元素都是一个像素，则您必须进行大量编组才能将其转换为 CUDA 可以使用的字节缓冲区或浮点数缓冲区。我怀疑这会使一切都减慢到足以抵消在 gpu 上做任何事情的优势。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T22:50:19.350

您可以做的是编写自己的[`IQueryable`LINQ 提供程序](http://msdn.microsoft.com/en-us/library/bb546158.aspx)，就像[LINQ to SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)将 LINQ 查询转换为 SQL 一样。

但是，我在这种方法中看到的一个问题是 LINQ 查询通常是延迟评估的。为了从流水线中受益，这可能不是一个可行的解决方案。

可能还值得研究如何为 C# 和 CUDA 实现 Google 的[MapReduce API](http://labs.google.com/papers/mapreduce.html)，然后使用类似于[PyCuda](http://mathema.tician.de/software/pycuda)的方法将逻辑传送到 GPU。在这种情况下，看看[CUDA 中已经存在的 MapReduce 实现](http://www.nvidia.com/object/cuda_home.html#state=detailsOpen;aid=f6a4e7d4-7f25-41f8-aa92-83305b61867d)可能也很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-09T13:47:23.180

这是一个非常有趣的问题，我不知道该怎么做。

然而，[Brahma 库](http://brahma.ananthonline.net/)似乎做了一些非常相似的事情。您可以使用 LINQ 定义函数，然后将其编译为 GLSL 着色器以在 GPU 上高效运行。查看他们的[代码](http://sourceforge.net/projects/brahma-fx/)，尤其是[Game of Life](http://brahma-fx.svn.sourceforge.net/viewvc/brahma-fx/trunk/Source/Samples/OpenGL/GameOfLife/Form1.cs?view=markup)示例。

# c - 需要帮助理解 K&R C 第 2 章中的“getbits()”方法

> ID：197614
> 
> 赞同：32
> 
> 时间：2008-10-13T13:46:05.087
> 
> 标签：c, operators, bit-manipulation, bit-shift, complement

在第 2 章，关于按位运算符的部分（第 2.9 节）中，我无法理解其中一种示例方法的工作原理。

这是提供的方法：

```
unsigned int getbits(unsigned int x, int p, int n) {
    return (x >> (p + 1 - n)) & ~(~0 << n);
} 
```

这个想法是，对于给定的数字*x*，它将返回从位置*p开始的**n*位，从右侧开始计数（最右边的位是位置 0）。给定以下方法：*`main()`*

 *```
int main(void) {
    int x = 0xF994, p = 4, n = 3;
    int z = getbits(x, p, n);
    printf("getbits(%u (%x), %d, %d) = %u (%X)\n", x, x, p, n, z, z);

    return 0;
} 
```

输出是：

> `getbits(63892 (f994), 4, 3) = 5 (5)`

我得到了其中的一部分，但在“大图”方面遇到了麻烦，主要是因为我不理解的位（不是双关语）。

我特别有问题的部分是补充部分：`~(~0 << n)`. 我想我得到了第一部分，处理*x*；这是我正在努力解决的部分（然后是掩码）——以及它们是如何结合在一起来实际检索这些位的。（我已经验证了它正在做的事情，包括代码和使用 calc.exe 检查我的结果——感谢上帝，它有一个二进制视图！）

有什么帮助吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-13T13:59:08.803

让我们在示例中使用 16 位。在这种情况下，`~0`等于

```
1111111111111111 
```

当我们左移此`n`位（在您的情况下为 3）时，我们得到：

```
1111111111111000 
```

因为`1`左边的 s 被丢弃，`0`右边的 s 被输入。然后重新补充它给出：

```
0000000000000111 
```

`n`所以这只是在数字的最不重要部分获得 1 位的聪明方法。

您描述的“x 位”已将给定数字 ( `f994 = 1111 1001 1001 0100`) 移动得足够远，因此最低有效 3 位是您想要的。在此示例中，您请求的输入位在那里，所有其他输入位都被标记`.`，因为它们对最终结果并不重要：

```
ff94             ...........101..  # original number
>> p+1-n     [2] .............101  # shift desired bits to right
& ~(~0 << n) [7] 0000000000000101  # clear all the other (left) bits 
```

如您所见，您现在在最右边的位位置拥有相关位。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-13T14:57:26.313

我想说最好的办法是手工解决问题，这样你就会明白它是如何工作的。

这是我使用 8 位无符号整数所做的。

1.  我们的数字是 75，我们想要从位置 6 开始的 4 位。函数的调用是 getbits(75,6,4)；

2.  二进制的 75 是 0100 1011

3.  所以我们创建了一个 4 位长的掩码，从最低位开始，就这样完成了。

~0 = 1111 1111
<<4 = 1111 0000
~ = 0000 1111

好的，我们得到了我们的面具。

4.  现在，我们将我们想要的位从数字中推入最低位，因此我们将二进制 75 移动 6+1-4=3。

0100 1011 >>3 0000 1001

现在我们有了一个掩码，其中包含正确的低位位数和我们想要的低位原始位数中的位。

4.  所以我们和他们

```
  0000 1001

& 0000 1111
=============

  0000 1001

```

所以答案是十进制的 9。

**注意：**高阶半字节恰好全为零，在这种情况下使掩码变得多余，但它可能是任何东西，具体取决于我们开始的数字的值。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-13T14:02:19.687

`~(~0 << n)`创建一个将`n`打开最右边的位的掩码。

```
0
   0000000000000000
~0
   1111111111111111
~0 << 4
   1111111111110000
~(~0 << 4)
   0000000000001111 
```

将结果与其他内容相加将返回这些`n`位中的内容。

编辑：我想指出我一直在使用的这个程序员的计算器：[AnalogX PCalc](http://www.analogx.com/contents/download/Programming/pcalc/Freeware.htm)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-05-11T13:26:39.137

还没有人提到它，但在 ANSI C`~0 << n`中会导致未定义的行为。

这是因为`~0`是一个负数并且左移负数是未定义的。

参考：C11 6.5.7/4（早期版本有类似文字）

> 的结果`E1 << E2`是`E1`左移的`E2`位位置；空出的位用零填充。[...] 如果 E1 具有有符号类型和非负值，并且`E1`×`2`^(`E2`)在结果类型中是可表示的，那么这就是结果值；否则，行为未定义。

在 K&R C 中，此代码将依赖于 K&R 开发的特定类系统，`1`在执行有符号数的左移时天真地向左移位位（并且此代码也依赖于 2 的补码表示），但其他一些系统不要共享这些属性，因此 C 标准化过程没有定义这种行为。

所以这个例子真的只是作为一个历史好奇而有趣，它不应该在 1989 年以来的任何实际代码中使用（如果不是更早的话）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T14:00:48.970

使用示例：int x = 0xF994，p = 4，n = 3；int z = getbits(x, p, n);

并专注于这组操作~(~0 << n)

对于任何位集（10010011 等），您想要生成一个“掩码”，它只提取您想要查看的位。所以10010011或0x03，我对xxxxx011感兴趣。将提取该集合的掩码是什么？00000111 现在我想要 sizeof int 独立，我会让机器完成工作，即从 0 开始对于字节机器它是 0x00 对于字机器它是 0x0000 等。64 位机器将代表 64 位或 0x0000000000000000

现在申请“ not" (~0) 并得到 11111111
右移 (<<) n 得到 11111000
和“not”得到 00000111

所以 10010011 & 00000111 = 00000011
你还记得布尔运算是如何工作的吗？

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2018-02-23T00:36:49.460

In`ANSI C ~0 >> n`导致未定义的行为

// 关于左移导致问题的帖子是错误的。

无符号字符 m,l;

m = ~0 >> 4; 正在产生 255 并且它等于 ~0 但是，

米=〜0；l = m >> 4; 正在产生正确的值 15 与：

m = 255 >> 4;

左移负数没有`~0 <<`问题

# security - 如何安全地允许网络服务器写入自己的 docroot？

> ID：197621
> 
> 赞同：0
> 
> 时间：2008-10-13T13:48:26.703
> 
> 标签：security, apache, webserver

[作为对吸引了全零答案的早期问题](https://stackoverflow.com/questions/186900/tool-for-web-server-redirect-management)的后续行动，我想知道允许 Web 服务器（apache）写入其自己的文档根目录（Linux）以动态创建元重定向文件的可能性.

当然，这听起来非常危险，而且我对全力以赴并授予网络服务器用户对其自己的 docroot 的完全写入访问权持谨慎态度。有没有更合适的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:09:38.500

使用 mod-rewrite，映射到您编写的程序，以便根据数据库记录或其他机制进行重写。

这里的说明：

[http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)

查找：页面上的“外部重写程序”

编辑（来自评论中的 Vinko，2.2 文档）

[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T14:03:59.387

通常所做的是只允许写入子目录，希望位于 noexec 挂载的分区中。

也就是说，在我看来，您应该只创建一组[RewriteMap](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)指令来进行动态重定向，无需在文档根目录中写入文件即可完成此操作。

[我在另一个问题](https://stackoverflow.com/questions/186900/tool-for-web-server-redirect-management#197688)中的回答类似，只是为了完整性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T14:05:05.453

如果你试图达到你之前的问题的目的，这是非常危险的。

如果您打算走这条路，您将需要进行大量测试以防止人们将网络服务器指令强制写入 htaccess 文件。

# c# - Visual Studio 的常用剪辑？

> ID：197622
> 
> 赞同：2
> 
> 时间：2008-10-13T13:48:47.093
> 
> 标签：c#, visual-studio

是否有适用于 .NET 的 Visual Studio 插件/工具/片段，它类似于 java eclipse 平台的 commonclipse，它会自动为您生成 ToString()、Equals()、GetHashCode() 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T13:52:19.097

[Resharper](http://www.jetbrains.com/resharper/)会做到的。（不幸的是不是免费工具）

这是有关该特定功能的[博客文章：](http://blog.excastle.com/2007/02/22/resharper-day-22-generating-code-with-altins/)

# php - PHP + Quickbook 在线版（API 集成）？

> ID：197624
> 
> 赞同：10
> 
> 时间：2008-10-13T13:50:01.800
> 
> 标签：php, api, integration, quickbooks, intuit

是否可以将我的 PHP 基于 Web 的电子商务应用程序与 Quickbook Online Edition 集成？

当我在我的网站上进行销售时，我希望能够在我的会计账簿中进行相应的日记帐分录。

请注意，我指的是 Quickbook **Online Edition**，**而不是**桌面软件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T14:03:49.343

我现在已经构建了一组便于与 QuickBooks Online Edition 通信的 PHP 类。它使与 QuickBooks Online Edition 的通信变得如此简单：

```
// Create the connection to QuickBooks
$API = new QuickBooks_API(...);

// Build the Customer object
$Customer = new QuickBooks_Object_Customer();
$Customer->setName($name);
$Customer->setShipAddress('134 Stonemill Road', '', '', '', '', 'Storrs', 'CT', '', '06268');

// Send the request to QuickBooks
$API->addCustomer($Customer, '_add_customer_callback', 15);

// The framework also supports processing raw qbXML requests
$API->qbxml('
    <CustomerQueryRq>
        <FullName>Keith Palmer Jr.</FullName>
    </CustomerQueryRq>', '_raw_qbxml_callback'); 
```

您可以在此处从我的线程下载该框架： [QuickBooks Online Edition PHP Package](https://idnforums.intuit.com/messageview.aspx?catid=56&threadid=9164)

我已经开始在此处编写一些关于如何将 Web 应用程序与 QuickBooks Online Edition 集成的文档/提示： [QuickBooks Integration wiki](http://wiki.consolibyte.com/wiki/doku.php/quickbooks_online_edition)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T23:10:22.290

是的，您可以将 qbXML 请求发送到 QuickBooks Online Edition，就像您可以将 qbXML 请求发送到 QuickBooks 的常规桌面版本一样。

下载 QuickBooks SDK 了解更多详情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T14:49:54.253

看起来 Quickbooks OE 有一个基于 XML 的 SDK，可在以下位置获得：

[http://developer.intuit.com/technical_resources/default.aspx?id=1492](http://developer.intuit.com/technical_resources/default.aspx?id=1492)

# wpf - WPF 应用程序的帧速率限制？

> ID：197629
> 
> 赞同：7
> 
> 时间：2008-10-13T13:51:22.780
> 
> 标签：wpf, performance, frame-rate

我想知道是否有办法限制进程内的 WPF 帧速率？即我不想限制单个动画的帧率，而是我的整个应用程序的全局帧率。

我想我以前见过这样的东西，但我再也找不到了。

# asp.net - Microsoft MVC“回显/打印/输出”等

> ID：197634
> 
> 赞同：7
> 
> 时间：2008-10-13T13:53:42.370
> 
> 标签：asp.net, asp.net-mvc

使用 ASP.NET 的视图引擎/模板 aspx/ashx 页面，吐到屏幕上的方式似乎是：

```
<%= Person.Name %> 
```

这对网络表单来说很好，因为很多模型数据都以编程方式绑定到控件。但是对于 MVC，我们现在更频繁地使用这种语法。

我遇到的问题非常琐碎，但无论哪种方式都很烦人。这是它似乎打破了标记，即：

```
<% foreach(var Person in People) { %>
    <%= Person.Name %>
<% } %> 
```

这对我来说似乎有很多开始和结束标签！

MVC contrib 中的其他视图引擎可以使用标准关键字（例如“print、out、echo”）在不打开和关闭脚本标签的情况下向屏幕发送内容，即（brail 示例）：

```
<% 
for element in list:
      output "<li>${element}</li>" 
end
%> 
```

现在，我说这可能看起来微不足道，但这样似乎更具可读性。那么 MS 拥有这种语法而不提供输出方法的优点是什么？

干杯，克里斯。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T13:55:28.093

考虑这样的事情，而不是：

```
<% foreach(var Person in People) { 
    Response.Write(Person.Name); 
} %> 
```

我相信这会奏效。（虽然我还没有测试过它；我才刚刚开始使用 MVC，而且办公室里没有工具集。）

编辑：我显然错过了实际的问题...... :)

微软确实提供了一种输出方法，但没有提供像你描述的那样的语法。输出方法是`Response.Write()`。我无法直接回答这个问题（我相信您需要与 MS 的 Scott Hanselmann 核实一下 :)），但我认为他们不想通过添加另一种语言让我们学习来使脚本编写复杂化；我认为他们想利用开发人员已经知道的语言（C#、VB 等）。

编辑＃2：我将以下内容放在评论中，回想起来（为了完整性），它应该是答案的一部分。

如果您前往[ASP.NET 上的 Learn MVC 站点](http://www.asp.net/learn/mvc/tutorial-04-cs.aspx)，在查看教程（即链接）中，您将看到以下段落：

> 由于您`Response.Write()`经常调用，Microsoft 为您提供了调用该 `Response.Write()`方法的快捷方式。清单 3 中的视图使用分隔符`<%=`并 `%>`作为调用 `Response.Write()`.

本质上，`<%= %>`是公认的快捷方式`Response.Write`，因此您可以在任何需要使用的`Response.Write`地方使用完整的方法`<%= %>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-10T00:10:08.757

我的回答是基于个人 XP 和 MVC4 cshtml - 你可以使用： `@Html.Raw("SomeStringDirectlyInsideTheBrowserPageHTMLCode")`

这会在其位置呈现（动态）字符串，`Response.Write(MyString)`这与我注意到的总是在浏览器页面的开头呈现字符串不同。

请注意，`@Html.Raw(MyString)`编译器无法检查由 渲染的 HTML 标记。我的意思是：@Html.Raw("<div ....>") 不能仅仅被 </div> 关闭，因为你会得到一个错误（<div ....> 没有被编译器检测到）所以你必须用 @Html.Raw("</div>") 关闭标签

PS
在某些情况下这不起作用（例如它在 DevExpress 中失败） - 使用`ViewContext.Writer.Write()`or`ViewContext.Writer.WriteLine()`代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:02:00.297

您正在寻找的可能是一个不同的视图引擎——它们每个都以自己的方式处理这样的嵌入式代码。查看[NHaml](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)，这是 Rails 的[Haml](http://haml.hamptoncatlin.com/)引擎的 ASP.Net 端口。

更多查看引擎：[Brail](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=Brail&referringTitle=Documentation)、 [NVelocity](http://nvelocity.sourceforge.net/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T14:03:56.827

谢谢大家，我不想特别切换视图引擎，但我会花时间看看其他可用的。我相信您可以理解大多数 MS 开发公司只涉及 MS 品牌技术，所以我只是想知道是否有办法使用默认视图引擎来做到这一点。或者如果不是，为什么不呢？有没有理由，如果没有，我可以在哪里建议默认视图编译器添加这样的关键工作。

John- 我相信 Response.Write(Person.Name) 只会在任何其他输出之前将字符串呈现到页面顶部。不过，这不是 100%，我给它一个 bash。

编辑：

显然， Response.Write(Person.Name) 按建议工作。那很容易。谢谢 :-) 约翰。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T14:13:36.870

我听说他们正在通过客户端模板为 ASP.Net 4 改进这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T14:23:54.340

除了 Response.Write 之外的另一种选择是使用[XSL 转换编写 XHtml](http://weblogs.asp.net/jigardesai/archive/2008/02/08/xslt-transformation-in-asp-net-mvc-framework.aspx)

# java - Hibernate @ManyToMany 映射与复合键

> ID：197635
> 
> 赞同：1
> 
> 时间：2008-10-13T13:54:17.410
> 
> 标签：java, hibernate, jakarta-ee

我正在尝试在 2 个表之间映射多对多关系，这两个表都具有复合主键

```
LSFOCTB which primary key is composed of : LSFOC_CODSOC,LSFOC_CODLSC,LSFOC_CODFOC

LSFORTB which primary key is composed of : LSFOR_CODSOC,LSFOR_CODLSC,LSFOC_CODFOR

The table in charge of the ManyToMany relationship is :

LSFCFTB, with : LSFCF_CODSOC,LSFCF_CODLSC,LSFCF_CODFOC,LSFCF_CODFOR 
```

因此，在休眠模型映射 LSFOCTB 中，我尝试了：

```
@ManyToMany(targetEntity = package.LSFOCTB.class, cascade = { CascadeType.PERSIST,
            CascadeType.MERGE })
    @JoinTable(name = "LSFCFTB", joinColumns = {
            @JoinColumn(name = "LSFCF_CODLSC", referencedColumnName = "LSFOC_CODLSC"),
            @JoinColumn(name = "LSFCF_CODFOC", referencedColumnName = "LSFOC_CODFOC"),
            @JoinColumn(name = "LSFCF_CODSOC", referencedColumnName = "LSFOC_CODSOC") }, 
    inverseJoinColumns = { @JoinColumn(name = "LSFCF_CODLSC", referencedColumnName = "LSFOR_CODLSC"),
            @JoinColumn(name = "LSFCF_CODFOR", referencedColumnName = "LSFOR_CODFOR"),
            @JoinColumn(name = "LSFCF_CODSOC", referencedColumnName = "LSFOR_CODSOC") }) 
```

在吸气剂之前。但它不起作用......尝试访问远程集合时的错误是：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [beans-dao.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Repeated column in mapping for collection: package.LSFOCTB.distantCollection column: LSFCF_CODLSC 
```

是否已经设法为 ManyToMany 关系制作休眠映射？如果是这样，我的映射有什么问题？感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T15:40:53.030

问题似乎是您正在创建一个包含 6 列的连接表，并且您的列有重复的名称。您实际上正在创建 2 个名为 LSFCF_CODLSC 的列和 2 个名为**LSFCF_CODFOR****的列和 2 个名为****LSFCF_CODSOC**的列。

 ****我建议你试试这个：

```
@JoinTable(name = "LSFCFTB", joinColumns = {
                    @JoinColumn(name = "LSFOC_LSFCF_CODLSC", referencedColumnName = "LSFOC_CODLSC"),
                    @JoinColumn(name = "LSFOC_LSFCF_CODFOC", referencedColumnName = "LSFOC_CODFOC"),
                    @JoinColumn(name = "LSFOC_LSFCF_CODSOC", referencedColumnName = "LSFOC_CODSOC") }, 
        inverseJoinColumns = { @JoinColumn(name = "LSFOR_LSFCF_CODLSC", referencedColumnName = "LSFOR_CODLSC"),
                    @JoinColumn(name = "LSFOR_LSFCF_CODFOR", referencedColumnName = "LSFOR_CODFOR"),
                    @JoinColumn(name = "LSFOR_LSFCF_CODSOC", referencedColumnName = "LSFOR_CODSOC") }) 
```

或类似的东西（根据您的命名约定）给每一列一个唯一的名称。

# .net - 升级到 W2K3 和 IIS6 时出现“无法加载类型...”

> ID：197639
> 
> 赞同：0
> 
> 时间：2008-10-13T13:55:10.480
> 
> 标签：.net, asp.net, iis

我的 ac# .NET 2.0 应用程序已经在 W2K/IIS5 上运行了好几年。系统管理员团队目前正在为该应用程序设置一个 W2K3 框，使用相同的安装文件，但遇到了可怕的“无法加载类型...”错误。所讨论的类型是被请求页面的类（即代码隐藏）。

我已经读过将 .NET 版本切换到 1.1 并返回到 2.0 可以解决问题，但我们尝试过这个没有运气。

有任何想法吗？我能找到的大部分信息都是关于在开发过程中解决问题，从 Visual Studio 运行应用程序。

谢谢，乔恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T08:58:39.380

找出程序集未加载原因的最佳选择是程序集绑定日志查看器。[http://msdn.microsoft.com/en-us/library/e74a18c4(VS.71).aspx](http://msdn.microsoft.com/en-us/library/e74a18c4(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T14:02:44.490

我想我以前有过这个，它需要在应用程序文件夹中更改权限或重置 IIS Web 应用程序文件夹设置。

阅读您的错误消息，我认为我们发现的另一个原因是当 JIT 尝试编译页面时，它没有对临时文件夹的权限。

# math - 如何通过两个点和半径大小计算椭圆的中心

> ID：197649
> 
> 赞同：21
> 
> 时间：2008-10-13T13:57:04.877
> 
> 标签：math, geometry, svg, vml, ellipse

在为 Internet Explorer 开发基于其自己的 VML 格式的 SVG 实现时，我遇到了将 SVG 椭圆弧转换为 VML 椭圆弧的问题。

在 VML 中，圆弧由以下公式给出：椭圆上两点的两个角度和半径长度；在 SVG 中，圆弧由以下公式给出：椭圆上两点的两对坐标和椭圆边界框的大小

所以，问题是：如何将椭圆上两点的角度表示为两对坐标。一个中间问题可能是：如何通过椭圆曲线上一对点的坐标找到椭圆的中心。

**更新**：让我们有一个前提条件，即通常放置一个椭圆（其半径平行于线性坐标系轴），因此不应用旋转。

**更新**：这个问题与 svg:ellipse 元素无关，而是与 svg:path 元素中的“a”椭圆弧命令有关（[SVG 路径：椭圆弧曲线命令](http://www.w3.org/TR/SVG/paths.html#PathDataEllipticalArcCommands)）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-13T16:13:34.883

所以解决方案在这里：

椭圆的参数化公式：

```
x = x0 + a * cos(t)
y = y0 + b * sin(t)

```

让我们将两个点的已知坐标放入它：

```
x1 = x0 + a * cos(t1)
x2 = x0 + a * cos(t2)
y1 = y0 + b * sin(t1)
y2 = y0 + b * sin(t2)

```

现在我们有一个具有 4 个变量的方程组：椭圆中心 (x0/y0) 和两个角度 t1、t2

让我们减去方程以消除中心坐标：

```
x1 - x2 = a * (cos(t1) - cos(t2))
y1 - y2 = b * (sin(t1) - sin(t2))

```

这可以重写（使用积到和恒等式）为：

```
(x1 - x2) / (2 * a) = sin((t1 + t2) / 2) * sin((t1 - t2) / 2)
(y2 - y1) / (2 * b) = cos((t1 + t2) / 2) * sin((t1 - t2) / 2)

```

让我们替换一些方程式：

```
r1: (x1 - x2) / (2 * a)
r2: (y2 - y1) / (2 * b)
a1: (t1 + t2) / 2
a2: (t1 - t2) / 2

```

然后我们得到简单的方程组：

```
r1 = sin(a1) * sin(a2)
r2 = cos(a1) * sin(a2)

```

将第一个方程除以第二个产生：

```
a1 = arctan(r1/r2)

```

将此结果添加到第一个方程得到：

```
a2 = arcsin(r2 / cos(arctan(r1/r2)))

```

或者，简单（使用三角函数和反三角函数的组合）：

```
a2 = arcsin(r2 / (1 / sqrt(1 + (r1/r2)^2)))

```

甚至更简单：

```
a2 = arcsin(sqrt(r1^2 + r2^2))

```

现在可以很容易地求解初始的四方程系统，并且可以找到所有角度以及日食中心坐标。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-13T08:55:19.200

您发布的椭圆曲线弧链接包括[椭圆弧实施说明](http://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes)的链接。

[在那里，您将找到从端点参数化到中心参数化](http://www.w3.org/TR/SVG/implnote.html#ArcConversionEndpointToCenter)的转换方程。

这是我对这些方程的 JavaScript 实现，取自[椭圆弧路径的交互式演示](http://users.ecs.soton.ac.uk/rfp07r/interactive-svg-examples/arc.html)，使用[Sylvester.js](http://sylvester.jcoglan.com/)执行矩阵和向量计算。

```
// Calculate the centre of the ellipse
// Based on http://www.w3.org/TR/SVG/implnote.html#ArcConversionEndpointToCenter
var x1 = 150;  // Starting x-point of the arc
var y1 = 150;  // Starting y-point of the arc
var x2 = 400;  // End x-point of the arc
var y2 = 300;  // End y-point of the arc
var fA = 1;    // Large arc flag
var fS = 1;    // Sweep flag
var rx = 100;  // Horizontal radius of ellipse
var ry =  50;  // Vertical radius of ellipse
var phi = 0;   // Angle between co-ord system and ellipse x-axes

var Cx, Cy;

// Step 1: Compute (x1′, y1′)
var M = $M([
               [ Math.cos(phi), Math.sin(phi)],
               [-Math.sin(phi), Math.cos(phi)]
            ]);
var V = $V( [ (x1-x2)/2, (y1-y2)/2 ] );
var P = M.multiply(V);

var x1p = P.e(1);  // x1 prime
var y1p = P.e(2);  // y1 prime

// Ensure radii are large enough
// Based on http://www.w3.org/TR/SVG/implnote.html#ArcOutOfRangeParameters
// Step (a): Ensure radii are non-zero
// Step (b): Ensure radii are positive
rx = Math.abs(rx);
ry = Math.abs(ry);
// Step (c): Ensure radii are large enough
var lambda = ( (x1p * x1p) / (rx * rx) ) + ( (y1p * y1p) / (ry * ry) );
if(lambda > 1)
{
    rx = Math.sqrt(lambda) * rx;
    ry = Math.sqrt(lambda) * ry;
}

// Step 2: Compute (cx′, cy′)
var sign = (fA == fS)? -1 : 1;
// Bit of a hack, as presumably rounding errors were making his negative inside the square root!
if((( (rx*rx*ry*ry) - (rx*rx*y1p*y1p) - (ry*ry*x1p*x1p) ) / ( (rx*rx*y1p*y1p) + (ry*ry*x1p*x1p) )) < 1e-7)
    var co = 0;
else
    var co = sign * Math.sqrt( ( (rx*rx*ry*ry) - (rx*rx*y1p*y1p) - (ry*ry*x1p*x1p) ) / ( (rx*rx*y1p*y1p) + (ry*ry*x1p*x1p) ) );
var V = $V( [rx*y1p/ry, -ry*x1p/rx] );
var Cp = V.multiply(co);

// Step 3: Compute (cx, cy) from (cx′, cy′)
var M = $M([
               [ Math.cos(phi), -Math.sin(phi)],
               [ Math.sin(phi),  Math.cos(phi)]
            ]);
var V = $V( [ (x1+x2)/2, (y1+y2)/2 ] );
var C = M.multiply(Cp).add(V);

Cx = C.e(1);
Cy = C.e(2); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T14:03:50.353

椭圆不能仅由两点定义。甚至一个圆（一个特殊的椭圆）也由三个点定义。

即使有三个点，你也会有无限的椭圆穿过这三个点（想想：旋转）。

请注意，边界框表示椭圆的中心，并且很可能假设其长轴和短轴平行于 x,y（或 y,x）轴。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T14:05:34.063

中间问题相当简单......你没有。您从边界框计算出椭圆的中心（即，只要椭圆在框内居中，框的中心就是椭圆的中心）。

对于您的第一个问题，我将查看[Wikipedia](http://en.wikipedia.org/wiki/Ellipse)上提供的椭圆方程的极坐标形式。您还需要计算椭圆的偏心率。

或者你可以从边界框中暴力破解值......如果一个点位于椭圆上并匹配角度，并遍历边界框中的每个点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-12T09:08:16.200

基于 Rikki 回答的 TypeScript 实现。

默认 DOMMatrix 和 DOMPoint 用于计算（在最新的 Chrome v.80 中测试）而不是外部库。

```
 ellipseCenter(
    x1: number,
    y1: number,
    rx: number,
    ry: number,
    rotateDeg: number,
    fa: number,
    fs: number,
    x2: number,
    y2: number
  ): DOMPoint {
    const phi = ((rotateDeg % 360) * Math.PI) / 180;
    const m = new DOMMatrix([
      Math.cos(phi),
      -Math.sin(phi),
      Math.sin(phi),
      Math.cos(phi),
      0,
      0,
    ]);
    let v = new DOMPoint((x1 - x2) / 2, (y1 - y2) / 2).matrixTransform(m);
    const x1p = v.x;
    const y1p = v.y;
    rx = Math.abs(rx);
    ry = Math.abs(ry);
    const lambda = (x1p * x1p) / (rx * rx) + (y1p * y1p) / (ry * ry);
    if (lambda > 1) {
      rx = Math.sqrt(lambda) * rx;
      ry = Math.sqrt(lambda) * ry;
    }
    const sign = fa === fs ? -1 : 1;
    const div =
      (rx * rx * ry * ry - rx * rx * y1p * y1p - ry * ry * x1p * x1p) /
      (rx * rx * y1p * y1p + ry * ry * x1p * x1p);

    const co = sign * Math.sqrt(Math.abs(div));

    // inverse matrix b and c
    m.b *= -1;
    m.c *= -1;
    v = new DOMPoint(
      ((rx * y1p) / ry) * co,
      ((-ry * x1p) / rx) * co
    ).matrixTransform(m);
    v.x += (x1 + x2) / 2;
    v.y += (y1 + y2) / 2;
    return v;
  }
```

# c++ - delete[] 如何“知道”操作数数组的大小？

> ID：197675
> 
> 赞同：282
> 
> 时间：2008-10-13T14:06:08.197
> 
> 标签：c++

```
Foo* set = new Foo[100];
// ...
delete [] set; 
```

您不会将数组的边界传递给`delete[]`. 但是这些信息存储在哪里？是否标准化？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2008-10-13T14:10:52.070

当您在堆上分配内存时，您的分配器将跟踪您分配了多少内存。这通常存储在您分配的内存之前的“头”段中。这样，当需要释放内存时，解除分配器确切地知道要释放多少内存。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-02-24T10:01:14.463

编译器的一种方法是分配更多内存并将元素计数存储在头元素中。

示例如何完成：

这里

```
int* i = new int[4]; 
```

编译器将分配`sizeof(int)*5`字节。

```
int *temp = malloc(sizeof(int)*5) 
```

`sizeof(int)`将在第一个字节中存储“4”

```
*temp = 4; 
```

并设置`i`

```
i = temp + 1; 
```

所以`i`将指向一个由 4 个元素组成的数组，而不是 5 个。

并删除

```
delete[] i; 
```

将按以下方式处理：

```
int *temp = i - 1;
int numbers_of_element = *temp; // = 4
... call destructor for numbers_of_element elements
... that are stored in temp + 1, temp + 2, ... temp + 4 if needed
free (temp) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T14:15:23.793

信息不规范。然而，在我处理过的平台中，这些信息存储在内存中，就在第一个元素之前。因此，理论上您可以访问并检查它，但这并不值得。

这也是为什么在使用 new [] 分配内存时必须使用 delete [] 的原因，因为 delete 的数组版本知道（以及在哪里）它需要寻找释放适量的内存 - 并调用适当数量的析构函数为对象。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-15T20:37:43.897

它在 C++ 标准中定义为特定于编译器。这意味着编译器魔术。它可以在至少一个主要平台上打破非平凡的对齐限制。

您可以通过意识到`delete[]`仅针对`new[]`由`operator new[]`. 一个普遍的实现是将数组计数存储在返回的第一个 int 中`operator new[]`，并`new[]`返回一个指针偏移量。（这就是为什么非平凡的对齐会破坏`new[]`。）

请记住`operator new[]/operator delete[]`!= `new[]/delete[]`。

另外，这与 C 如何知道分配的内存大小是正交的`malloc`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T20:48:28.197

基本上它在内存中排列为：

[信息] [你要求的内存...]

其中 info 是编译器用来存储分配的内存量的结构，而不是什么。

不过，这取决于实现。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-13T14:09:28.673

这不是规范中的内容——它依赖于实现。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T14:10:45.597

因为要“删除”的数组应该是使用一次“new”运算符创建的。“新”操作应该将该信息放在堆上。否则，new 的其他用途如何知道堆在哪里结束？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-14T12:09:35.267

这是一个比你最初想象的更有趣的问题。这个回复是关于一种可能的实现。

首先，虽然在某种程度上您的系统必须知道如何“释放”内存块，但底层的 malloc/free（通常称为 new/delete/new[]/delete[]）并不总是准确地记住多少内存你要求，它可以被四舍五入（例如，一旦你超过 4K，它通常被四舍五入到下一个 4K 大小的块）。

因此，即使可以获得内存块的大小，也不能告诉我们 new[]ed 内存中有多少值，因为它可以更小。因此，我们必须存储一个额外的整数，告诉我们有多少个值。

除了，如果正在构造的类型没有析构函数，那么 delete[] 除了释放内存块之外不需要做任何事情，因此不需要存储任何东西！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T14:12:49.227

它没有标准化。在 Microsoft 的运行时中，new 运算符使用 malloc()，而 delete 运算符使用 free()。因此，在此设置中，您的问题等同于以下问题：free() 如何知道块的大小？

在幕后进行一些簿记，即在 C 运行时中。

# c - 嵌入式 C：什么是 var = 0xFF; 做？

> ID：197676
> 
> 赞同：19
> 
> 时间：2008-10-13T14:06:16.013
> 
> 标签：c, embedded

我第一次使用嵌入式 C。虽然我的 C 语言生锈了，但我可以阅读代码，但我并不真正了解为什么某些行是这样的。例如，我想知道一个变量是真还是假，并将其发送回另一个应用程序。最初的实现者没有将变量设置为 1 或 0，而是选择了 0xFF。

他是否试图将其设置为地址空间？否则为什么将布尔变量设置为 255？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-13T14:08:17.177

`0xFF`设置 char 中的所有位。

最初的实现者可能认为该标准不够好，并认为如果所有位`0`都*为*假*，*那么所有位*都*为*真*。`1`

 ***这是有效的，因为在 C 中，除 0 之外的任何值都是 true。尽管这会将所有字节设置为 char，但它也适用于任何其他变量类型，因为在变量中设置的任何一位都使其成立。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-13T17:12:57.820

如果您迫切需要内存，您可能希望将 8 个布尔值存储在一个字节中（或 32 个长字节，或其他）

这可以通过使用标志掩码轻松完成：

```
 // FLAGMASK = ..1<<n for n in 0..7...
  FLAGMASK = 0x10;    // e.g. n=4

  flags &= ~FLAGMASK; // clear bit
  flags |= FLAGMASK;  // set bit
  flags ^= FLAGMASK;  // flip bit
  flags = (flags & ~FLAGMASK) | (booleanFunction() & FLAGMASK); // clear, then maybe set 
```

这仅在 booleanFunction() 返回 0（所有位清除）或 -1（所有位设置）时有效。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-13T14:10:04.787

0xFF 是 ~0 的十六进制表示（即 11111111）

例如，在 VB 和 Access 中，-1 用作 True。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-26T18:22:03.967

这些年轻人，他们懂什么？

在其中一种原始嵌入式语言中 - PL/M（-51 是，如 8051、-85、-86、-286、-386） - 逻辑运算符（C 中的!、&&、||）和按位（~、&、|、^）。相反，PL/M 没有、AND、OR 和 XOR 处理这两个类别。我们最好有两个类别吗？我不确定。不过，我想念 C 中的逻辑 ^^ 运算符（xor）。不过，我想在 C 中构建程序而不涉及逻辑类别是可能的。

在 PL/M 中，False 定义为 0。布尔值通常以字节变量表示。True 被定义为 NOT False，它将为您提供 0ffh（PL/M-ese 用于 C 的 0xff）。

要查看状态标志进位的转换是如何在存储在字节（布尔值不能作为类型）变量之前发生的，PL/M 可以在存储之前使用汇编指令“sbb al,al”。如果设置了进位，al 将包含 0ff，否则将包含 0h。如果需要相反的值，PL/M 将在 sbb 之前插入一个“cmc”或在之后附加一个“not al”（实际上是异或 - 一个或另一个）。

所以 TRUE 的 0xff 是来自 PL/M 的直接兼容端口。必要的？可能不会，除非您不确定自己的技能（在 C 中）并且玩起来超级安全。

就像我会的那样。

PL/M-80（用于 8080、8085 和 Z80）不支持整数或浮点数，我怀疑 PL/M-51 也一样。PL/M-86（用于 8086、8088、80188 和 80186）添加了整数、单精度浮点、segment:offset 指针和标准内存模型小、中、紧凑和大。对于那些如此倾向于创建自己动手的混合内存模型的特殊指令。微软的大内存模型相当于英特尔的大内存。MS 还推出了微型、小型、紧凑型、中型和大型型号。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T17:48:07.000

通常在嵌入式系统中，只有一名程序员编写所有代码，并且他/她的特质贯穿整个源代码。许多嵌入式程序员都是硬件工程师，必须让系统尽可能地运行。没有“可移植性”的要求或概念。嵌入式系统的另一个考虑因素是编译器特定于 CPU 硬件。请参阅此 CPU 的 ISA 并检查“布尔值”的所有用法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-13T14:12:50.290

正如其他人所说，它将所有位设置为 1。由于这是嵌入式 C，您可能会将其存储到一个寄存器中，其中每个位对某些东西都很重要，因此您想将它们全部设置为 1。我知道我做到了用汇编程序编写时类似。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-13T18:01:20.343

了解这个问题真正重要的是“var”的类型。您说“布尔值”，但它是 C++/C99 的布尔值，还是（很可能是嵌入式 C 应用程序），是被用作布尔值的完全不同类型的东西？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-15T14:27:01.587

还将 1 添加到 0xff 将其设置为 0（假设为 unsigned char），并且检查可能处于循环中，并且增量要中断。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T18:39:21.077

这里有一个可能的原因：`0xff`是`0`. 可能在您的嵌入式架构上，存储`0xff`到变量中比存储更有效，例如，`1`这可能需要额外的指令或存储在内存中的常量。

或者，检查架构中寄存器“真值”的最有效方法可能是使用“检查位设置”指令。使用TRUE 值，检查*哪个*`0xff`位都没有关系……它们都已设置。

 *当然，以上只是推测，不知道您使用的是哪种嵌入式处理器。8 位、16 位、32 位？PIC、AVR、ARM、x86？？？

（正如其他人指出的那样，对于 C 中的布尔表达式，除零之外的任何整数值都被视为 TRUE。）

# ruby - Ruby 访问器有没有办法返回 set 变量以外的东西？

> ID：197678
> 
> 赞同：4
> 
> 时间：2008-10-13T14:06:34.170
> 
> 标签：ruby, class, accessor

我想做一些检查作家访问器。我的第一个想法是返回一个布尔值。

```
class MyClass
  def var=(var)
    @var = var
    # some checking
    return true
  end
end

m = MyClass.new
retval = (m.var = 'foo')

=> "foo" 
```

我可以在写入器访问器中设置返回值吗？如果是，我怎样才能得到这个值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T14:11:39.590

我会使用 set_var(var) 而不是您尝试做的事情，假设属性编写器可以正常工作。您正在尝试做的事情对于下一个使用您的代码的穷人来说是非标准且不明显的。（可能只是你自己）如果发送了错误的输入或发生了相当异常的事情，我会抛出异常。

你想要这种行为

```
Correct
>>temp = object.var = 7
=> 7 

Wrong
>>temp = object.var = 7
=> false 
```

= 运算符应始终返回传递给它的值。Ruby 使用隐式返回，这在编程语言中并不常见。使用时仔细检查退货`method=()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T14:41:04.850

```
class Test
  def var=(var)
    @var = var
    return true
  end
end

t1, t2 = Test.new, Test.new

t1.var = 123 # evaluates to 123

# Why is it impossible to return something else:
t1.var = t2.var = 456 
```

如评论中所述：我相信不可能更改返回值以允许链式分配。无论如何，大多数 Ruby 程序员可能都不会改变返回值。

免责声明：我测试了上面的代码，但没有发现明确的引用来验证我的陈述。

**更新**

```
class Test
  def method_missing(method, *args)
    if method == :var=
      # check something
      @var = args[0]
      return true
    else
      super(method, *args)
    end
  end

  def var
    @var
  end
end

t = Test.new
t.var = 123 # evaluates to 123
t.does_not_exists # NoMethodError 
```

这似乎真的不可能！上面的示例表明返回值**根本与`var=`方法**无关。你无法改变这种行为——这是 Ruby 赋值的基本方式。

**更新 2：找到解决方案**

你可以提出一个例外！

```
class Test
  def var=(var)
    raise ArgumentError if var < 100 # or some other condition
    @var = var
  end
  def var
    @var
  end
end

t = Test.new
t.var = 123 # 123
t.var = 1 # ArgumentError raised
t.var # 123 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T14:17:14.353

此外，根据您的示例，要清理内容，您可以执行以下操作：

```
class MyClass
  attr_accessor :var
end

m = MyClass.new
m.var = "Test"
puts m.var # => "Test" 
```

不过，关于您的问题，您是否在问是否可以返回您为对象的值设置的值以外的值？

**更新**

看看这个项目：[Validatable](http://validatable.rubyforge.org/)。它将类似于 ActiveRecord 的验证添加到您的类属性中。

快速场景：

```
class Person
  include Validatable
  validates_presence_of :name
  attr_accessor :name
end

class PersonPresenter
  include Validatable
  include_validations_for :person
  attr_accessor :person

  def initialize(person)
    @person = person
  end
end

presenter = PersonPresenter.new(Person.new)
presenter.valid? #=> false
presenter.errors.on(:name) #=> "can't be blank" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-16T02:45:16.550

*我知道这是对派对的迟到回应...*

很难知道你在课堂上试图做什么。您提到要在保存...到数据库之前对其进行检查？文件？

如果属性值不正确，您希望发生什么？

通过使用布尔返回，您可以有效地“隐藏”错误（因为您*会*忘记必须检查 setter 的返回值的奇怪事情）。

虽然你可以按照别人的建议去做

*   使用验证器插件
*   引发错误

你也可以考虑一个isValid？像许多最终被持久化的类一样的方法。然后保存可以检查对象的状态并抛出错误。

**底线：**

*   不要做你发布的事情
*   抛出错误（通过任何已发布的解决方案）

帮助推动解决方案的一种方法是考虑首先编写您正在寻找的行为（即**BDD**）。然后，通过**TDD**进一步研究类应该做什么，使用**RSpec**获得所需的类“合同”，该合同需要出现以支持所需的行为。

# wcf - WCF - Binding.RecieveTimeout 和 Binding.ReliableSession.InactivityTimeout 有什么区别？

> ID：197682
> 
> 赞同：3
> 
> 时间：2008-10-13T14:07:32.267
> 
> 标签：wcf

在 WCF 中，Binding.RecieveTimeout 和 Binding.ReliableSession.InactivityTimeout 有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T15:57:00.937

来自[http://blogs.msdn.com/drnick/archive/2007/06/26/session-lifetime-on-the-server.aspx](http://blogs.msdn.com/drnick/archive/2007/06/26/session-lifetime-on-the-server.aspx)

*使用可靠会话时，必须满足两个不同的不活动计时器才能使连接保持活动状态。如果任一不活动计时器关闭，则连接被终止。第一个不活动计时器在可靠会话上，称为 InactivityTimeout。如果在超时期限内没有收到任何消息，无论是应用程序还是基础设施，都会触发此不活动计时器。基础结构消息是为通道堆栈中的协议之一（例如保持活动或确认）而生成的消息，而不是包含应用程序数据。第二个不活动计时器在服务上，并使用绑定的 ReceiveTimeout 设置。如果在超时期限内没有收到应用程序消息，则此不活动计时器会触发。*

# ajax - Ajax keep=alive 是个好主意吗？

> ID：197695
> 
> 赞同：0
> 
> 时间：2008-10-13T14:10:28.080
> 
> 标签：ajax, locking, record, keep-alive

我目前正在开发一个简单的 CRUD 应用程序。一项要求是防止用户同时编辑内容。为了做到这一点，我“锁定”记录以查看它们是否正在被编辑，以防止其他用户同时编辑。我在想实现这个的一个好方法可能是使用 AJAX 保持活动来查看用户会话是否已过期，如果是，则解锁记录以进行编辑。以前有人用过这种技术吗？如果工作站被锁定几分钟或没有，它会工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:20:22.677

我认为这种做法实施起来有点棘手，并且可能容易出错。

通常，当我遇到这样的情况时，我的客户已经接受了一种方法，即在返回更新时，首先检查记录是否有更改，然后提交更新，否则，他们会看到合并操作。

我对超时和保活的感觉是，会发生很多事情会阻止快速解锁，这对大多数用户来说是令人沮丧的。

# silverlight - Silverlight 的替代 IDE

> ID：197703
> 
> 赞同：4
> 
> 时间：2008-10-13T14:11:24.253
> 
> 标签：silverlight, ide

我想在无需购买 Visual Studio 2008 许可证的情况下使用 silverlight。
我已经在 Visual Studio 中使用了试用时间，因此我正在尝试寻找另一个解决方案。

外面有什么吗？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T15:08:06.340

RC0 及更高版本支持 Visual Web Developer Express SP1。先安装，再安装工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:16:59.500

据我所知，您可以将 VS Express SP1 与 Silverlight 一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T18:32:59.687

使用**Eclipse**

**[Microsoft Silverlight 的 Eclipse 工具](http://www.eclipse4sl.org/)** 请查看[http://www.eclipse4sl.org/](http://www.eclipse4sl.org/)

# ruby-on-rails - Rails 中富文本编辑的最佳选择是什么？

> ID：197708
> 
> 赞同：21
> 
> 时间：2008-10-13T14:13:00.787
> 
> 标签：ruby-on-rails, text-editor, in-place

我想在表单上使用富文本编辑，以便管理员更改说明。这样做的最佳选择是什么？

[更清楚一点-管理员不是技术人员，但可能希望在不使用标记或尽可能少的标记的情况下控制某些格式。我希望他们能够使用具有一些格式控制的 RTE 编辑所有 AJAXy 内联，然后提交并能够在不更改页面的情况下查看最终用户的说明。

关于插件，我想知道哪些 Rich Test Editing 插件最适合在 Rails 中使用。最容易实现、最清晰的 API、最容易内联使用等...]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T17:07:18.737

我们从[TinyMCE](http://tinymce.moxiecode.com/)开始，但我们正在切换到 Yahoo 的[富文本编辑器](http://developer.yahoo.com/yui/editor/)，因为 TinyMCE 的工作方式存在一些奇怪的问题，并且富文本编辑器文档和默认外观更出色。

两者都非常容易与 Rails 集成（毕竟它们只是 JavaScript）。有插件，但你真的不需要一个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-15T03:08:20.007

我过去也经历过类似的挣扎，最终选择了 YUI。不幸的是，YUI 结果（至少对我来说，诚然，我匆忙通过并且从未重构），在糟糕的 html 中。

然后今晚，当我偶然发现这篇文章时，我发现了 PunyMCE。它有 2 个很棒的东西：1) 它非常轻巧（顾名思义），2) 已经为它创建了一个 rails 插件：github 上的 puny_mce。

文档已经足够好了，除了一些我忽略/让我摸不着头脑的事情：

1.  “Usage”下有一个错字，<% yield :head %> 应该是 <%= yield :head %>
2.  `include_puny_mce`如果您想使用的不仅仅是基本工具栏，您需要在调用和调用中包含 a) 预设置配置文件或 b) 工具栏项目和这些项目所需的插件`puny_mce`。这是有道理的——它`include_puny_mce`是在指示页面上它需要哪些 javascript，而 `puny_mce`调用实际上是在构建生成富编辑器所需的 javascript 输出。

这是我放在一起演示的示例：

```
<% content_for :head do %>
  <%= include_puny_mce :profiles => [:full] %>
<% end %>

<h1>New post</h1>

<% form_for(@post) do |f| %>
 <%= f.error_messages %>
 <%= f.label :title, "Title" %><br />
 <%= f.text_field :title %><br />
 <%= f.label :content, "Post Content" %><br />
 <%= f.text_area :content, :cols => 100 %>
 <%= puny_mce 'post_content', 'post_content', :profile => :full %>
 <p>
     <%= f.submit 'Create' %>
 </p>
<% end %> 
```

我希望这有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T14:28:18.853

我不确定我是否完全理解这个问题，但如果你只是问要使用哪个编辑器，有很多选项，它们都不是 Rails 的问题 - 你可以通过添加一点点来使用它们中的任何一个javascript 到您的标记中。可以在这里找到不错的最新概述：http: [//bulletproofbox.com/web-based-rich-text-editors-compared/](https://web.archive.org/web/20081012054026/http://bulletproofbox.com:80/web-based-rich-text-editors-compared/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T14:38:57.880

Rails 实现了许多模板语言，它们为标记提供了相对简单的语法。我以前使用过 RedCloth，这是 Textile ( [http://redcloth.org/](http://redcloth.org/) ) 的 gem 实现，它非常好。像 Liquid ( [http://www.liquidmarkup.org/](http://www.liquidmarkup.org/) ) 这样的东西更强大一些，它允许模板实际上内联包含数据库信息。根据您项目的需求，两者都可能很合适。

单独使用这些解决方案都不会提供就地富文本编辑器，但对于可能是插入式解决方案的后端来说，这是一个很好的起点。如果您只让管理员输入信息，我想他们不会害怕一点纯文本输入。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T02:51:11.193

米兰答案中的链接已损坏。值得庆幸的是，Ajaxian.com 对这篇文章做了一个很好的总结，并附上了文章中所有各种 RTE 的链接及其评论。

链接：[http ://ajaxian.com/archives/richtexteditors-compared](http://ajaxian.com/archives/richtexteditors-compared)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-26T10:53:44.413

从 Rails 6开始， Rails 原生支持[Trix 编辑器。](https://trix-editor.org/)

您可以在模型中使用简单的`rich_text_area`表单助手`has_rich_text`。

Rails guide here: [https://edgeguides.rubyonrails.org/action_text_overview.html](https://edgeguides.rubyonrails.org/action_text_overview.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-30T17:31:14.787

我知道这个威胁已经很老了，但几周前我发现了一些好的选择，所以如果其他人像我一样面临同样的问题，我会给出更不满的回应。所以我最喜欢的编辑器是[Froala](https://www.froala.com/)（如果您使用的是 rails，则为[所见即所得的编辑器](https://github.com/froala/wysiwyg-rails)），它看起来很干净，易于处理并支持嵌入式视频、图片上传、文件上传，并且完全可定制到您甚至可以简化后端的程度没有任何响应式开发知识的用户将项目正确放置在页面上以使其完全响应。我们现在已经将此编辑器用于多个项目，并且客户喜欢它。

该文档令人满意，但如果您将它与 Rails 和 Django 等框架一起使用（就像我们所做的那样），它可能会更好。但我认为它每月都在改善。

另一个非常有前途的编辑器是[Quill](http://quilljs.com/)（如果您使用的是 rails，则为[quill- rails）。](https://github.com/the-robear/quill-rails)我们还没有将它用于项目，但正在试验。一旦我们有更多的经验，我们将在这里和[SSC](https://sciencesupercrew.com/en)上发布一些注释。

最后，如果你想做或提供响应式前端编辑，你可能想看看[x-editable](https://github.com/bootstrap-ruby/bootstrap-editable-rails)。查看演示 - 它非常整洁！

# php - JavaScript 警报框与 PHP 相结合

> ID：197712
> 
> 赞同：2
> 
> 时间：2008-10-13T14:13:53.127
> 
> 标签：php, javascript

```
echo "<td><a href='delete.php?id=$row[id]&&category=$a' onclick='return confirm(\'are you sure you wish to delete this record\');'>delete</a></td>"; 
```

以上是我尝试使用的代码。每次它什么都不做，我看不到如何使用“正确”的 JavaScript 方法。是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:22:18.927

使用 GET 方法更改状态也是一个坏主意 - 查看有关何时使用 GET 和何时使用 POST 的指南（[http://www.w3.org/2001/tag/doc/whenToUseGet.html #核对清单](http://www.w3.org/2001/tag/doc/whenToUseGet.html#checklist)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T14:23:51.500

我认为 $row[id] 在您的 echo 语句中没有正确评估。尝试这个：

```
echo "<td><a href='delete.php?id={$row[id]}&&category=$a'... 
```

注意波浪形的括号。

但这更容易阅读：

```
?><td><a href="delete.php?id=<?=$row[id];?>&amp;category=<?=$a;?>" onclick="return confirm('are you sure you wish to delete this record');">delete</a></td><? 
```

顺便说一句，在你的 js 中添加一个函数来处理确认：

```
function confirm_delete() {
    return confirm('Are you sure you want to delete this record?');
} 
```

那么你的 onclick 方法就可以了`return confirm_delete()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T00:32:46.323

您应该尽量将 JavaScript 与 HTML 分开。最初输出原版 HTML，然后将事件添加到链接中。

```
printf('<td><a id="deleteLink" href="delete.php?id=%d&amp;category=%s">Delete</a></td>', $row["id"], $a); 
```

然后是页面某处的一些 JavaScript 代码：

```
document.getElementById('deleteLink').onclick = function() {
    return confirm("Are you sure you wish to delete?");
}; 
```

但是，从您的示例看来，您可能有一个包含多行的表，每行都有自己的删除链接。这使得使用这种风格更具吸引力，因为您不会`confirm(...)`一遍又一遍地输出文本。

如果是这种情况，您显然不能`id`在链接上使用 an，因此使用类可能会更好。`<a class="deleteLink" ...`

如果您使用的是 JavaScript 库，例如 jQuery，这很容易：

```
$('.deleteLink').click(function() {
    return confirm("...");
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T00:14:15.037

只是一个建议，您是否使用框架？

我使用 MooTools 然后简单地在 HTML 中包含这个脚本

确认删除.js

```
window.addEvent('domready', function(){
    $$('a.confirm_delete').each(function(item, index){
        item.addEvent('click', function(){
            var confirm_result = confirm('Sure you want to delete');
            if(confirm_result){
                this.setProperty('href', this.getProperty('href') + '&confirm');
                return true;
            }else{
                return false;
            }
        });     
    });
}); 
```

它所做的只是找到任何带有 class="confirm_delete" 的“a”标签，并附加与您的脚本相同的代码，但我发现它更易于使用。它还向地址添加了一个确认变量，因此如果 JavaScript 被关闭，您仍然可以将它们发送到带有确认提示的屏幕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T14:17:09.640

```
echo "<td><a href='delete.php?id=$row[id]&&category=$a' onclick='return confirm(&quot;are you sure you wish to delete this record&quot;);'>delete</a></td>"; 
```

使用 Firefox 的 HTML 语法突出显示对您有利。:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T17:18:51.117

另一种解决方案：

```
echo '<td><a href="delete.php?id=' . $row[id] . '&category=' . $a . '" onclick="return confirm(\'are you sure you wish to delete this record?\');'>delete</a></td>'; 
```

我将双引号更改为单引号，反之亦然。然后我连接了变量，因此 PHP 不需要评估。

另外，我不确定当用户单击否时，onclick 上的返回是否真的会阻止链接被“点击”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-13T22:57:23.333

这是我用于相同类型的东西。

我不回显/打印它，我会将 html 放在 ?> html 之间

```
?> <td><a href="?mode=upd&id=<?= $row[id] ?>&table=<?= $table ?>">Upd</a> / <a href="?mode=del&id=<?= $row[id] ?>&table=<?= $table ?>" onclick="return confirm('Are you sure you want to delete?')">Del</a></td> <?php 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-13T15:18:53.900

如果你坚持使用 echo-thing：

```
echo "<td><a href='delete.php?id=$row[id]&&category=$a' onclick='return confirm(\\'are you sure you wish to delete this record\\');'>delete</a></td>"; 
```

-- 因为转义是从 php-interpretator 处理的！-)

# javascript - 使表格行可点击

> ID：197713
> 
> 赞同：27
> 
> 时间：2008-10-13T14:13:53.580
> 
> 标签：javascript, html

我想知道使整个 tr 可点击的最佳方法是什么？

最常见的（也是唯一的？）解决方案似乎是使用 JavaScript，通过使用 onclick="javascript:document.location.href('bla.htm');" （不要忘记：使用 onmouseover/onmouseout 设置正确的光标）。

虽然这样可行，但遗憾的是目标 URL 在浏览器的状态栏中不可见，这与普通链接不同。

所以我只是想知道是否有任何优化空间？是否可以在浏览器的状态栏中显示将导航到的 URL？或者甚至有一种非 JavaScript 方法可以使 tr 可点击？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-04-01T12:45:21.477

如果您不想使用 javascript，您可以按照 Chris Porter 的建议，将每个 td 元素的内容包装在匹配的锚标记中。然后将锚标签`display: block`设置为并将and设置为`height`与`line-height`td的高度相同。然后你应该会发现 td 的触摸是无缝的，效果是整行都是可点击的。注意 td 上的填充，这会导致可点击区域出现间隙。相反，将填充应用于锚标记，因为如果这样做，它将构成可点击区域的一部分。

我还喜欢通过在 tr:hover 上应用不同的背景颜色来设置行以具有突出显示效果。

### 例子

对于最新的 Bootstrap（版本 3.0.2），这里有一些快速的 CSS 来展示如何做到这一点：

```
table.row-clickable tbody tr td {
    padding: 0;
}

table.row-clickable tbody tr td a {
    display: block;
    padding: 8px;
} 
```

这是一个可以使用的示例表：

```
<table class="table table-hover row-clickable">
    <tbody>
        <tr>
            <td><a href="#">Column 1</a></td>
            <td><a href="#">Column 2</a></td>
            <td><a href="#">Column 3</a></td>
        </tr>
    </tbody>
</table> 
```

这是一个显示此操作[的示例。](http://jsbin.com/AgosUpe/1)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-13T14:21:13.143

使用 jQuery，您可以执行以下操作：

```
$('tr').click(function () {
  $(this).toggleClass('highlight_row');
}); 
```

然后将 highlight_row 添加到您的 CSS 文件中，该行将其类更改为 highlight_row。您可以在该行中换掉您想做的任何事情（以及更改 $('tr') 以适合您的特定行。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-08-17T12:10:41.757

我发现这个解决方案效果很好：

```
$(document).ready(function() {
    $('#example tr').click(function() {
        var href = $(this).find("a").attr("href");

        if(href) {
            window.location = href;
        }
    });
}); 
```

只是不要忘记将光标设置为指针`tr:hover`

```
#table tr:hover {cursor: pointer;} 
```

来源：[http ://www.electrictoolbox.com/jquey-make-entire-table-row-clickable/](http://www.electrictoolbox.com/jquey-make-entire-table-row-clickable/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-13T15:07:54.500

"

*最常见的（也是唯一的？）解决方案似乎是使用 JavaScript，通过使用`onclick="javascript:document.location.href('bla.htm');"`（不要忘记：使用 onmouseover/onmouseout 设置适当的光标）。*

"

onclick 命令应如下所示：

```
onclick="window.location.href='bla.html';" 
```

并且没有必要对光标执行任何 onmouseover/-out 操作，因为光标属性仅在鼠标悬停在元素上时才有效：

```
style="cursor:pointer;" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-13T14:18:10.153

另一种方法是实际链接每个单元格的内容。如有必要，您可以更改样式，使它们看起来不像传统链接。

请注意，您正在尝试做的事情确实会稍微破坏直观的用户体验。需要清楚的是，单击一行会有所作为。我通常更喜欢在每一行的边缘放置一个图标（放大镜等），它可以钻入一个新页面。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-13T14:17:42.853

幸运或不幸的是，由于欺诈意图，大多数现代浏览器不再让您控制状态栏（这在当时是可能的并且很流行）。

您最好的选择是 title 属性或[javascript tooltip](http://www.google.com/search?q=javascript+tooltip)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-13T16:04:35.477

如果您的表格内部没有链接，则以下技巧应该有效。

将整个表格放入链接中，并在鼠标悬停事件中更改链接的 href 属性。

演示代码：

```
<script type="text/javascript">
function setLink(elRow) {
var elLink = document.getElementById('link');
elLink.href = elRow.rowIndex + ".com";
}
</script>
...
<a id=link>
<table>
    <tr onMouseOver="setLink(this);"><td>first row</td></tr>
    <tr onMouseOver="setLink(this);"><td>second row</td></tr>
</table>
</a> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-12-06T16:09:48.073

我意识到这是一个旧线程，在 Alice 的回答中具有完全合法的解决方案。然而，还有一种方法可以在不使用 javascript 且不复制链接 * 列数并保持标记/CSS 有效的情况下执行此操作。我花了一段时间才弄明白，所以我想我会把它贴在这里给其他也碰巧像我一样最终出现在这个线程上的人。

将链接放在第一列：

```
<table class="search_results">
    <tr>
        <td><a href="#">Some text</a></td>
        <td>more text</td>
        <td>more text</td>
    </tr>
</table> 
```

这是非常好的标记，因此您唯一真正的问题是让该链接跨越表格的宽度。我使用非常标准的 CSS 做到了这一点：

```
table.search_results a {position:absolute;display:block;width:98%;} 
```

将宽度更改为您想要的任何宽度，原则上您已完成并撒满灰尘。所以这一切都相对容易，但是如果你像我一样有一个流畅/响应式布局，并且你的链接上有一些标准样式以及表格上的一些填充，你将需要这些规则（从上面复制并添加额外的）。

```
table.search_results td:first-child {padding:0;}
table.search_results a {position:absolute;display:block;width:98%;max-width:1272px;font-weight:normal;color:#000;padding:.5em;}
table.search_results a:hover {background:none;}
table.search_results tr:hover {border-color:#25505b;background:#b5d6dd;} 
```

解释一下：第一条规则仅删除我的第一个 td 上的所有填充。默认情况下，我的 td 上的填充是 0.5em。第二条规则在链接上添加相同的填充，否则最终会出现未对齐的单元格内容。它还纠正了我在 a 上的一些标准样式，以确保所有列看起来都一样。你也可以反过来做（将链接样式添加到你的 td）。通过最后两条规则，我摆脱了链接上的默认悬停效果，然后将其放在任何具有正确类的表的 tr 上。

这适用于我关心的浏览器，但您当然应该在您关心的浏览器中进行测试:) 希望我能帮助某人节省几分钟的这篇文章！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T14:18:57.670

这是一个 hack，但您可以将其添加到您的`tr`：

```
onmouseover="window.status='http://bla.com/bla.htm'" 
```

不要忘记为您的虚假链接设置样式：

```
tr.clickable {
    cursor: hand; 
    cursor: pointer;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T14:37:24.560

您也可以尝试将行单元格的内容包装在 href 中，并使用 CSS 将 href 高度/宽度推送到每个单元格的内部边界。该行本身不可点击（除非您向该行添加了额外的 html），但该行的大部分内容空间将像一个普通链接（光标、状态栏等）。我不记得我之前是如何做到这一点的，但我相当成功地让它发挥作用。

编辑：一条评论要求提供更多详细信息，后来另一位用户的帖子涵盖了它们，但直到我进一步研究了这个建议并对其进行了测试，我才意识到这一点。

如果您将“显示：块”CSS 样式标签添加到您希望可点击的单元格中的锚对象，它将使整个单元格（减去任何填充）就像一个按钮。光标正确显示，并在状态栏中预览链接目标。这一切都是用零 javascript 完成的。祝你好运。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-06-30T10:09:26.257

我有同样的问题，我只使用 CSS 解决了它。我认为这对我来说是最好的解决方案，因为我也在 JSF 中使用它。

只需将样式类分配给表格，您就可以开始了....

它是这样的：

CSS：

```
.myDataTable {
    background: 444;
    width: 100%;
}

.myDataTable thead tr {
    background-image: url('../img/tableHeader.jpg');
}

.myDataTable thead tr th {
    height: 28px;
    font-size: 14px;
    font-family: tahoma, helvetica, arial, sans-serif;
    padding-left: 5px;
}

.myDataTable thead tr th img {
    padding-right: 5px;
    padding-top: 1px;
}

.myDataTable thead tr td {
    height: 15px;
    font-size: 11px;
    font-weight: bold;
    font-family: tahoma, helvetica, arial, sans-serif;
    padding-left: 5px;
}

.myDataTable tbody {
    background: #f2f5f9;
}

.myDataTable tbody tr:nth-child(even) td,tbody tr.even td {
    background: #e2ebf4;
    font-size: 12px;
    padding-left: 5px;
    height: 14px;
}

.myDataTable tbody tr:nth-child(odd) td,tbody tr.odd td {
    background: #f7faff;
    font-size: 12px;
    padding-left: 5px;
    height: 14px;
}

.myDataTable tbody tr:hover td {
    background-color: #e7e7e7;
}

.myDataTable tbody tr td {
    height: 14px;
    padding-left: 5px;
    font-size: 12px;
}

.myDataTable tbody tr td a {
    color: black;
    text-decoration: none;
    font-size: 12px;
    display: block;
}

.myDataTable thead tr th a {
    color: black;
    text-decoration: none;
    font-size: 12px;
    display: inline;
} 
```

你的表结构应该是：

```
<table class="myDataTable">
 <thead>
  <tr>
   <th>Heading 1</th>
   <th>Heading 2</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><a href="#">Data    1 </a></td>
   <td><a href="#">Data    2 </a></td>
  </tr>
 </tbody>
</table> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-03-02T02:55:09.197

如果您的目标浏览器都支持[CSS 表格显示样式](http://caniuse.com/#feat=css-table)，您可以使用 Javascript 将每一行包装在一个`<a>`标签中，该标签的样式可用作`<tbody>`.

这是一些使用 jQuery 实现它的 JS 代码：[(jsfiddle)](http://jsfiddle.net/q2jkY/)

```
$(function() {
  $('.table-linked').each(function() {
    var table, tbody;
    table = this;
    tbody = $('tbody', this);
    tbody.children().each(function() {
      var href, row;
      row = $(this);
      href = row.attr('data-href');
      $('<a href="' + href + '" style="display: table-row-group" />').append(row).appendTo(table);
    });
    tbody.remove();
  });
}); 
```

此代码将转换如下所示的表：

```
<table class="table-linked">
    <tbody>
        <tr data-href="/a"><td>a</td><td>1</td></tr>
        <tr data-href="/b"><td>b</td><td>2</td></tr>
    </tbody>
</table> 
```

在浏览器中进入这个 DOM 结构：

```
<table>
    <a href="/a" style="display: table-row-group">
        <tr><td>a</td><td>1</td></tr>
    </a>
    <a href="/b" style="display: table-row-group">
        <tr><td>b</td><td>1</td></tr>
    </a>
</table> 
```

*浏览器似乎无法将这种结构解析为 HTML 代码（不用说它不会验证），它需要使用 JS 构建*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-13T14:31:30.843

Marko Dugonjic 在他的博客[maratz.com](http://maratz.com)中解释了如何使用 Javascript 检测表行索引。在他的示例中，当您将鼠标悬停在一行中的任何单元格上时，整行都会突出显示。

参见示例， [http://webdesign.maratz.com/lab/row_index/](http://webdesign.maratz.com/lab/row_index/)

和他的文章， [http://www.maratz.com/blog/archives/2005/05/18/detect-table-row-index-with-javascript/](http://www.maratz.com/blog/archives/2005/05/18/detect-table-row-index-with-javascript/)

通过更改，您可以通过放置 onclick 操作来进一步调整它。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-10-13T14:17:48.360

如果您已经依赖 javascript 进行点击，那么您还可以使用 javascript 在状态区域显示 url、更改光标或执行其他操作，使其看起来更像一个链接。当然，浏览器可能会忽略设置状态区的代码。

# c# - 通过指针使用 P/Invoke 在 C# 中实例化 C++ 类

> ID：197720
> 
> 赞同：1
> 
> 时间：2008-10-13T14:16:33.247
> 
> 标签：c#, .net, pinvoke

我正在从 C# 应用程序中的非托管 DLL mscorpe.dll 导入 CreateICeeFileGen() 函数，以生成 PE 文件。此函数返回指向[此处定义](http://msdn.microsoft.com/en-us/library/ms404463.aspx)的 C++ 对象的指针，有什么方法可以通过 C# 访问此类中的字段，还是需要编写非托管包装 DLL？

我目前使用的代码如下：-

```
[DllImport(@"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorpe.dll", EntryPoint = "CreateICeeFileGen")]
static extern void CreateICeeFileGen(out IntPtr iceeFileGenPointer);
...
IntPtr filePtr;
CreateICeeFileGen(out filePtr); 
```

**注意**：我知道你可以用 .net 库做类似的事情，但我需要使用非托管库来实现我的目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T14:19:39.760

您需要一个包装库才能使用 C# 中的类。

最好的办法是使用 C++/CLI 创建包装器，它可以直接调用非托管函数并使用托管类公开细节。这将消除对任何事情使用 P/Invoke 的需要。

（好吧，从技术上讲，如果您知道类布局，则可以使用指针算法来访问字段，但这将非常脆弱和混乱，并且尝试以这种方式调用虚函数将非常难看）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T14:24:07.787

它看起来像 COM 类/接口。你不能只使用 COM 代替吗？

# c# - 在 C# 中以编程方式设置浏览器代理设置

> ID：197725
> 
> 赞同：36
> 
> 时间：2008-10-13T14:17:41.170
> 
> 标签：c#, proxy, registry

我正在编写一个 winforms 应用程序，它需要设置 Internet Explorer 的代理设置，然后打开一个新的浏览器窗口。目前，我通过进入注册表来应用代理设置：

```
RegistryKey registry = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings", true);
registry.SetValue("ProxyEnable", 1);
registry.SetValue("ProxyServer", "127.0.0.1:8080"); 
```

进入注册表是*最好*的方法，还是有更推荐的方法？如果有替代解决方案，我想避免更改注册表。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-16T15:34:34.427

这在某种程度上取决于您的确切需求。如果您正在编写 C# 应用程序并且只想设置您的应用程序将使用的默认代理设置，请使用类 System.Net.GlobalProxySelection ( [http://msdn.microsoft.com/en-us/library/system.net .globalproxyselection.aspx](http://msdn.microsoft.com/en-us/library/system.net.globalproxyselection.aspx)）。您还可以使用 System.Net.WebProxy ( [http://msdn.microsoft.com/en-us/library/system.net.webproxy.aspx](http://msdn.microsoft.com/en-us/library/system.net.webproxy.aspx) ) 为任何特定连接设置代理。

如果您真的想更新注册表中的代理设置，我相信您需要使用 P/Invoke 来调用 WinAPI 函数 WinHttpSetDefaultProxyConfiguration ( [http://msdn.microsoft.com/en-us/library/aa384113\. .aspx](http://msdn.microsoft.com/en-us/library/aa384113.aspx)）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-12-20T20:20:52.607

来自：[http ://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/19517edf-8348-438a-a3da-5fbe7a46b61a](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/19517edf-8348-438a-a3da-5fbe7a46b61a)

在代码的开头添加这些行：

使用 System.Runtime.InteropServices；使用 Microsoft.Win32；

```
 [DllImport("wininet.dll")]
    public static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);
    public const int INTERNET_OPTION_SETTINGS_CHANGED = 39;
    public const int INTERNET_OPTION_REFRESH = 37;
    bool settingsReturn, refreshReturn; 
```

并暗示代码：

```
 RegKey.SetValue("ProxyServer", YOURPROXY);
        RegKey.SetValue("ProxyEnable", 1);

        // These lines implement the Interface in the beginning of program 
        // They cause the OS to refresh the settings, causing IP to realy update
        settingsReturn = InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SETTINGS_CHANGED, IntPtr.Zero, 0);
        refreshReturn = InternetSetOption(IntPtr.Zero, INTERNET_OPTION_REFRESH, IntPtr.Zero, 0); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-10-09T07:52:33.010

我写了一个 10 行的程序来做到这一点，请随意尝试[https://github.com/131/proxytoggle](https://github.com/131/proxytoggle)

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;
using Microsoft.Win32;

namespace ProxyToggle
{

    class Program
    {

        [DllImport("wininet.dll")]
        public static extern bool InternetSetOption(IntPtr hInternet, int dwOption, IntPtr lpBuffer, int dwBufferLength);
        public const int INTERNET_OPTION_SETTINGS_CHANGED = 39;
        public const int INTERNET_OPTION_REFRESH = 37;

        static void setProxy(string proxyhost, bool proxyEnabled)
        {
            const string userRoot = "HKEY_CURRENT_USER";
            const string subkey = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings";
            const string keyName = userRoot + "\\" + subkey;

            Registry.SetValue(keyName, "ProxyServer", proxyhost);
            Registry.SetValue(keyName, "ProxyEnable", proxyEnabled?"1": "0");

            // These lines implement the Interface in the beginning of program 
            // They cause the OS to refresh the settings, causing IP to realy update
            InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SETTINGS_CHANGED, IntPtr.Zero, 0);
            InternetSetOption(IntPtr.Zero, INTERNET_OPTION_REFRESH, IntPtr.Zero, 0);
        }

        static void Main(string[] args)
        {
            if (args.Length == 0)
            {
                setProxy("", false);
                return;
            }

            setProxy(args[0], true);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-13T15:27:06.940

查看这篇专门标记为您正在尝试做什么的知识库文章。

[http://support.microsoft.com/kb/226473](http://support.microsoft.com/kb/226473)

简短的版本是您想使用 InternetOpen、InternetSetOption API 来更新代理设置。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-22T09:17:46.490

您可以使用自 FW 2.0 以来存在的这种有用的方法：（我刚刚发现，我现在是另一个人......）

[http://msdn.microsoft.com/en-us/library/system.net.webrequest.getsystemwebproxy.aspx](http://msdn.microsoft.com/en-us/library/system.net.webrequest.getsystemwebproxy.aspx)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-01-04T08:50:06.410

快速代码示例（来自 msdn）：

```
WebProxy proxyObject = new WebProxy("http://proxyserver:80/",true);
WebRequest req = WebRequest.Create("http://www.contoso.com");
req.Proxy = proxyObject; 
```

# delphi - Delphi 中的 AOP 支持

> ID：197731
> 
> 赞同：12
> 
> 时间：2008-10-13T14:18:47.343
> 
> 标签：delphi, aop

是否可以在 Delphi 中进行面向方面的编程？我会对本机支持以及第三方解决方案感兴趣。

我没有想用 AOP 解决的具体问题，只是对学习 AOP 感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-04-21T16:45:26.010

AOP 依赖于两件事：

*   将附加代码注入现有代码单元的能力
*   一种对应注入代码的位置设置条件的机制。

这通常称为代码编织。它是更大范围的程​​序转换研究中的一个专业。

JIT 编译语言比静态编译程序有更多的代码编织选项，因为更多信息保留在字节码/IL 中。它们还支持反射，它提供了在运行时操作代码的能力。

Delphi.NET 和 Prism 与任何其他 .NET 语言一样可以访问这些功能。

我知道有两个用于 Delphi Win32 的 AOP 框架。第一个是[MeAOP](http://code.google.com/p/meaop/)，已经提到过。第二个是[基础设施](http://code.google.com/p/infra/)。这两个项目都采用了与 AOP 类似的方法。它们结合使用 RTTI 和巧妙的指针操作来拦截方法调用，因此您可以在方法调用之前或之后运行其他代码。您将横切功能定义为框架的 AOP 类的子类。您通过将方法名称作为字符串参数传递给 AOP 框架来注册要拦截的方法。

这两个框架仍在积极开发中，实际上范围比 AOP 更大。不幸的是，文档有些稀疏（在 Infra 的情况下，主要是葡萄牙语）

另一个项目在 2004 年通过源代码编织尝试 AOP，并取得了一些成功。基本上，他们在一个名为 DMS 的通用程序转换工具之上构建了一个方面编织器，并在编译之前用它来将代码注入到 delphi 源文件中。他们面向方面的语言主要受 AspectJ 的影响。

[http://www.gray-area.org/Research/GenAWeave/](http://www.gray-area.org/Research/GenAWeave/)有原始论文和演示文稿的链接，以及一些转换过程的视频。

也可以使用运行时代码检测来完成此操作。它是一些分析器使用的一种技术，用于在不修改原始源代码的情况下将计数器和堆栈跟踪注入正在运行的代码中。可以使用类似的技术将横切关注点注入静态编译的可执行文件。PinTool项目就是一个很好的[例子](http://www.pintool.org/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-10T18:21:32.793

The DSharp library features AOP:
[https://bitbucket.org/sglienke/dsharp](https://bitbucket.org/sglienke/dsharp)
More info can be found at: [https://bitbucket.org/sglienke/dsharp](https://bitbucket.org/sglienke/dsharp)

Also have a look at [TVirtualMethodInterceptor](http://docwiki.embarcadero.com/RADStudio/XE4/en/Using_Virtual_Method_Interceptors).
It's in the RTL since Delphi 2010 and allows you to do OnBefore, OnAfter, etc. calls on all virtual methods on a class.
This call alone should cover must of what you need using [Rtti](http://docwiki.embarcadero.com/Libraries/XE4/en/System.Rtti), not weaving which is much faster than run-time weaving.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T16:48:57.430

Delphi 后期版本中的 ClassHelper 允许一些非常有限级别的 AOP 类型行为。您可以使用 ClassHelpers 将行为注入其他类，而无需从它们继承。它允许覆盖现有方法，然后可选地调用该现有方法。

限制是您必须为特定类及其后代声明 ClassHelper。此外，一个类只能有一个 ClassHelper。

这些类似于 C# 中的扩展方法。

# php - 如何调整 PHP 真实路径缓存？

> ID：197734
> 
> 赞同：5
> 
> 时间：2008-10-13T14:19:09.073
> 
> 标签：php, optimization, require-once, realpath

最新版本的 PHP 有一个文件名缓存，用于了解文件的真实路径，`require_once()`并且`include_once()`可以利用它。

您可以在*php.ini*中设置一个值来设置缓存的大小，但我不知道如何判断大小应该是多少。默认值为 16k，但我看不出我们正在使用多少缓存。文档含糊不清：

[确定 PHP 使用的真实路径缓存的大小。在 PHP 打开许多文件的系统上应该增加这个值，以反映执行的文件操作的数量。](http://us2.php.net/manual/en/ini.core.php#ini.realpath-cache-size)

是的，我可以增加允许的缓存数量，并使用`ab`其他测试或其他测试来运行测试，但我想要一些更内省的东西，而不仅仅是从远处计时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T23:46:09.890

您可能已经发现了这一点，但是对于遇到此问题的人，您可以使用 realpath_cache_size() 和 realpath_cache_get() 来确定您的站点上使用了多少 realpath 缓存并相应地调整设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T14:58:17.983

尽管我无法针对您的情况提供任何具体信息，但我的理解是，对于大多数大型 PHP 应用程序（尤其是使用[Zend Framework](http://framework.zend.com)之类的框架的应用程序）来说，16k 相当低。如果您的应用程序使用大量包含并查看从那里去哪里，我会说至少将缓存大小增加一倍。只要您的目录结构非常一致，您可能还想增加 TTL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-03T16:41:09.840

要扩展 Noodles 提供的答案，您可以使用以下代码创建一个小 test.php：

```
<?php

echo "<br>cache size: ".realpath_cache_size();
echo "<br>";
echo "<br>cache: ".print_r(realpath_cache_get(););

?> 
```

将此上传到您的站点并导航到它。它将显示您的缓存当前使用的字节数，以及缓存中的实际内容。该值一直在变化，因此请继续按 F5 按钮以更好地了解您所在的位置。在高峰时段进行测试也是一个好主意。

如果您看到该值经常达到 php.ini 中定义的最大缓存大小，那么是时候增加该值了。

请记住，默认的 PHP 设置是 16K，即 16384 字节。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-12-27T20:00:40.110

16K 是不活动的文件数。

大多数网站设置为 1k。与 APC、xcache ea 等中的设置非常相似。

# c# - 处理许多商家网关的信用卡处理库？

> ID：197741
> 
> 赞同：9
> 
> 时间：2008-10-13T14:21:24.047
> 
> 标签：c#, .net, e-commerce, credit-card

寻找与多个商家网关接口的 ac# 库。至少应该能够处理 PayPal 和授权。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:32:31.217

我已经成功使用[了 dotnetcharge](http://www.dotnetcharge.com/)。他们支持 50 个支付处理器，加上（最重要的是）信用卡信息的数据存储加密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:42:23.660

考虑到使用网关本身非常简单，为您的应用程序添加对每个网关的支持应该不难。

也就是说，这是一个声称拥有您想要的支持的人：

[http://www.componentsource.com/products/ibiz-e-payment-integrator-net/index.html](http://www.componentsource.com/products/ibiz-e-payment-integrator-net/index.html)

请注意，Payflow 链接和 payflow pro 是由 PayPal 从威瑞信购买的。

# .net - 使用 Castle ActiveRecord (.net) 时生成默认的 CRUD UI

> ID：197742
> 
> 赞同：2
> 
> 时间：2008-10-13T14:21:41.753
> 
> 标签：.net, castle-activerecord, crud

是否有任何简单的方法可以使用 activerecord（城堡实现）或类似的 NET 生成默认 crud（给定实体）？

RoR 有类似的东西（它认为它称为 activescaffold）谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T15:15:43.720

有一个默认的脚手架支持

您可以在[http://www.castleproject.org/monorail/gettingstarted/scaffolding.html](http://www.castleproject.org/monorail/gettingstarted/scaffolding.html)看到 它对于开发的初始阶段很有用，但如果您有复杂的映射，您将不得不对其进行扩展。

# windows - 我可以确定何时在 Windows 上设置了默认打印机

> ID：197744
> 
> 赞同：0
> 
> 时间：2008-10-13T14:21:52.300
> 
> 标签：windows, printing

我们正在尝试追踪 Windows 默认打印机的更改时间以及更改者或更改者。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T09:58:30.863

我认为这不会在任何地方被追踪。对于过去的更改，您可能不走运。

对于未来的更改，您可以尝试设置安全审核（通过 regedit：Permissions->Acvanced->Auditing）`HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows`并在安全事件日志中观察对该键的更改。但是，安全事件消息的数量可能会使跟踪变得困难。

# asp.net-mvc - 如何使用实体框架创建外键关系？

> ID：197747
> 
> 赞同：5
> 
> 时间：2008-10-13T14:23:09.533
> 
> 标签：asp.net-mvc, entity-framework, foreign-key-relationship

我想在我的数据库中在具有几个外键关系的表上创建一个新行，但我无法处理需要进行的顺序和调用。这是我到目前为止所拥有的：

```
db.Models.Order order = DB.Models.Order.CreateOrder( apple );
order.CustomerReference.Attach( ( from c in db.Customer where c.Id == custId select c ).First() );
db.SaveChanges(); 
```

代码在第二行失败，说：

> 当与此相关端关联的源对象处于添加、删除或分离状态时，附加不是有效操作。使用 NoTracking 合并选项加载的对象始终是分离的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T14:51:45.187

*（感谢约翰的语法修复）*

所以我想通了。这是你必须做的：

```
db.Models.Order order = DB.Models.Order.CreateOrder( apple );
order.Customer = (from c in db.Customer where c.Id == custId select c).First();
db.SaveChanges(); 
```

我希望这对人们有所帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-15T16:12:15.390

为什么不使用实体引用？您的方法将导致额外的`SELECT`语句。

一个更好的方法是使用`CustomerReference`类和一个`EntityKey`.

```
order.CustomerReference = new System.Data.Objects.DataClasses.EntityReference<Customers>();
order.CustomerReference.EntityKey = new EntityKey("ModelsEntities.Customers", "Id", custId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-14T14:24:13.637

对于更新这里是一些示例代码：

```
using (var ctx = new DataModelEntities())
{

       var result = (from p in ctx.UserRole.Where(o => o.UserRoleId == userRole.UserRoleId)
                              select p).First();

       result.RolesReference.EntityKey = new EntityKey("DataModelEntities.Roles",
                                       "RoleId", userRole.RoleId);

       result.UserRoleDescription = userRole.UserRoleDescription;      
       ctx.SaveChanges();
} 
```

# javascript - 如何使用 JavaScript 更改背景颜色？

> ID：197748
> 
> 赞同：158
> 
> 时间：2008-10-13T14:23:39.470
> 
> 标签：javascript, css

有人知道使用 JavaScript 交换网页背景颜色的简单方法吗？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-10-13T14:27:01.773

修改 JavaScript 属性`document.body.style.background`。

例如：

```
function changeBackground(color) {
   document.body.style.background = color;
}

window.addEventListener("load",function() { changeBackground('red') }); 
```

注意：这确实取决于页面的组合方式，例如，如果您使用具有不同背景颜色的 DIV 容器，则需要修改其背景颜色而不是文档正文。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-10-13T14:27:56.560

您不需要 AJAX，只需一些普通的 java 脚本设置 body 元素的 background-color 属性，如下所示：

```
document.body.style.backgroundColor = "#AA0000"; 
```

如果您想将其视为由服务器启动，则必须轮询服务器，然后相应地更改颜色。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-13T15:03:17.130

我同意之前的海报，即改变颜色`className`是一种更漂亮的方法。然而，我的论点是 a`className`可以被视为“为什么你希望背景是这种或那种颜色”的定义。

例如，将其设为红色不仅是因为您想要将其设为红色，还因为您希望将错误通知用户。因此，`AnErrorHasOccured`在 body 上设置 className 将是我的首选实现。

在 CSS 中

```
body.AnErrorHasOccured
{
  background: #f00;
} 
```

在 JavaScript 中：

```
document.body.className = "AnErrorHasOccured"; 
```

这使您可以选择根据 this 设置更多元素的样式`className`。因此，通过设置一个`className`你可以给页面一个特定的状态。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-13T14:30:23.187

AJAX 使用 Javascript 和 XML 以异步方式从服务器获取数据。除非您想从服务器下载颜色代码，否则这不是您真正的目标！

但除此之外，您可以使用 Javascript 设置 CSS 背景。如果你使用像 jQuery 这样的框架，它会是这样的：

```
$('body').css('background', '#ccc'); 
```

否则，这应该工作：

```
document.body.style.background = "#ccc"; 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-02-26T05:10:11.937

您可以通过以下方式进行 **步骤 1**

```
 var imageUrl= "URL OF THE IMAGE HERE";
   var BackgroundColor="RED"; // what ever color you want 
```

用于改变**BODY的背景**

```
document.body.style.backgroundImage=imageUrl  //changing bg image
document.body.style.backgroundColor=BackgroundColor //changing bg color 
```

**更改具有 ID 的元素**

```
document.getElementById("ElementId").style.backgroundImage=imageUrl
document.getElementById("ElementId").style.backgroundColor=BackgroundColor 
```

**对于具有相同类的元素**

```
 var elements = document.getElementsByClassName("ClassName")
        for (var i = 0; i < elements.length; i++) {
            elements[i].style.background=imageUrl;
        } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-13T14:27:50.460

我不会真的把它归类为“AJAX”。无论如何，像下面这样的东西应该可以解决问题：

```
document.body.style.backgroundColor = 'pink'; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-11-02T11:27:23.403

您可以通过简单地使用来更改页面的背景：

```
document.body.style.background = #000000; //I used black as color code 
```

然而，下面的脚本将使用 setTimeout() 函数每 3 秒改变一次页面的背景：

```
$(function() {
            var colors = ["#0099cc","#c0c0c0","#587b2e","#990000","#000000","#1C8200","#987baa","#981890","#AA8971","#1987FC","#99081E"];

            setInterval(function() { 
                var bodybgarrayno = Math.floor(Math.random() * colors.length);
                var selectedcolor = colors[bodybgarrayno];
                $("body").css("background",selectedcolor);
            }, 3000);
        }) 
```

[**阅读更多**](http://codeforbrowser.com/blog/changing-background-color-using-javascript-and-jquery/)

[**演示**](http://jsfiddle.net/refhat/gJWFR/1/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-04T09:16:28.297

CSS方法：

如果您想看到连续的颜色，请使用以下代码：

```
body{
    background-color:black;
    animation: image 10s infinite alternate;
    animation:image 10s infinite alternate;
    animation:image 10s infinite alternate;
}

@keyframes image{
    0%{
background-color:blue;
}
25%/{
    background-color:red;
}
50%{
    background-color:green;
}
75%{

    background-color:pink;
}
100%{
    background-color:yellow;
    }
  } 
```

如果您想更快或更慢地看到它，请将 10 秒更改为 5 秒等。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-13T14:48:57.673

我希望在这里看到 css 类的使用。它避免了在 javascript 中难以阅读颜色/十六进制代码。

```
document.body.className = className; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-03-25T11:39:22.393

这将根据从下拉菜单中选择的用户选择更改背景颜色：

```
function changeBG() {
  var selectedBGColor = document.getElementById("bgchoice").value;
  document.body.style.backgroundColor = selectedBGColor;
}
```

```
<select id="bgchoice" onchange="changeBG()">
    <option></option>
    <option value="red">Red</option>
    <option value="ivory">Ivory</option>
    <option value="pink">Pink</option>
</select>
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-02-22T11:14:57.940

如果您想使用按钮或其他事件，只需在 JS 中使用：

```
document.querySelector("button").addEventListener("click", function() {
document.body.style.backgroundColor = "red";
}); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-11-12T05:13:38.393

或者，如果您希望以 rgb 表示法指定背景颜色值，请尝试

```
document.getElementById("yourid").style.backgroundColor = `rgb(${a}, ${b}, ${c})`; 
```

其中 a,b,c 是颜色值

例子：

```
document.getElementById("yourid").style.backgroundColor = 'rgb(224,224,224)'; 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-04-01T15:10:51.597

```
<!DOCTYPE html>
<html>
<body>
<select name="" id="select" onClick="hello();">
    <option>Select</option>
    <option style="background-color: #CD5C5C;">#CD5C5C</option>
    <option style="background-color: #F08080;">#F08080</option>
    <option style="background-color: #FA8072;">#FA8072</option>
    <option style="background-color: #E9967A;">#E9967A</option>
    <option style="background-color: #FFA07A;">#FFA07A</option>
</select>
<script>
function hello(){
let d = document.getElementById("select");
let text = d.options[d.selectedIndex].value;
document.body.style.backgroundColor=text;
}
</script>
</body>
</html> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-02-01T17:41:54.513

将此脚本元素添加到您的 body 元素中，根据需要更改颜色：

```
<body>
  <p>Hello, World!</p>
  <script type="text/javascript">
     document.body.style.backgroundColor = "#ff0000";  // red
  </script>
</body>
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-09-29T06:55:42.307

所以你可以很容易地通过调用一个函数来完成

```
 function changeBg()
    {
      document.body.style.color.backgroundColor="#ffffff";

    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-01-22T07:14:07.070

我建议使用以下代码：

```
<div id="example" onClick="colorize()">Click on this text to change the
background color</div>
<script type='text/javascript'>
function colorize() {
var element = document.getElementById("example");
element.style.backgroundColor='#800';
element.style.color='white';
element.style.textAlign='center';
}
</script> 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-28T05:11:38.267

您可以通过简单地使用来更改页面的背景：

```
function changeBodyBg(color){
    document.body.style.background = color;
} 
```

阅读更多@[更改背景颜色](http://www.jquerypot.com/how-to-change-the-background-color-of-a-web-page-dynamically-in-javascript/)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-08-16T09:49:07.380

# 这是使用 Javascript 更改背景颜色的 2 种方法

1.  要使用 javascript 更改背景颜色，您可以应用 **`style.background`**或应用于**`style.backgroundColor`**要更改背景的元素。

    下面的示例在您使用`style.background`属性单击元素时更改正文的背景颜色。

```
function pink(){ document.body.style.background = "pink"; }
function sky(){ document.body.style.background = "skyblue"; }
```

```
<p onclick="pink()" style="padding:10px;background:pink">Pink</p>
<p onclick="sky()" style="padding:10px;background:skyblue">Sky</p>
```

* * *

2.  另一种方法是[使用 javascript 添加一个 CSS 类](https://www.tutorialstonight.com/javascript-add-class.php) ，为它附加的元素提供背景。

    您可以看到更多使用 javascript 添加类的方法，但在这里您可以简单地使用`classList.add()`属性。

    ```
     function addClass(yourClass){
            document.body.classList.remove("sky", "pink");
            document.body.classList.add(yourClass);
        }
    ```

    ```
     .pink {
            background: pink;
        }

        .sky {
            background: skyblue;
        }
    ```

    ```
     <p onclick="addClass('pink')" style="padding:10px;background:pink">Pink</p>
        <p onclick="addClass('sky')" style="padding:10px;background:skyblue">Sky</p>
    ```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-10-02T19:27:02.540

`<body>`但是您可能希望在元素存在之前配置主体颜色。这样，它从一开始就具有正确的颜色。

```
<script>
    var myColor = "#AAAAAA";
    document.write('\
        <style>\
            body{\
                background-color: '+myColor+';\
            }\
        </style>\
    ');
</script> 
```

您可以将其放入`<head>`文档或 js 文件中。

这是一个很好的颜色。

```
var myColor = '#'+(Math.random()*0xFFFFFF<<0).toString(16); 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2021-02-12T14:55:33.140

此代码每秒为背景生成随机颜色。

```
setInterval(changeColor,1000);
function changeColor(){
  let r = Math.random() * 255 ;
  let g = Math.random() * 255 ;
  let b = Math.random() * 255 ;

  document.body.style.backgroundColor = `rgb( ${r}, ${g}, ${b} )`;
}
```

我希望对某人有所帮助。❤</p>

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2021-05-03T18:41:51.387

```
 <p id="p1">Hello, Moazzam!</p>
 <p >Hello, Moazzam!</p>
 <p >Hello, Moazzam!</p>
 <script type="text/javascript">
 document.getElementById("p1").style.color= "#ff0000";  // red
 </script> 
```

# c# - 如何更改关联字段的值

> ID：197753
> 
> 赞同：6
> 
> 时间：2008-10-13T14:24:27.677
> 
> 标签：c#, linq, linq-to-sql, associations

我有 2 个类，它们之间有 LINQ 关联，即：

```
Table1:       Table2:
ID            ID
Name          Description
              ForiegnID 
```

这里的关联是在**Table1.ID -> Table2.ForiegnID之间**

我需要能够更改 Table2.ForiegnID 的值，但是我不能并且认为这是因为关联（当我删除它时，它可以工作）。

因此，有谁知道如何更改关联字段 Table2.ForiegnID 的值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T14:44:52.393

查看designer.cs 文件。这是钥匙的属性

```
[Column(Storage="_ParentKey", DbType="Int")]
public System.Nullable<int> ParentKey
{
    get
    {
        return this._ParentKey;
    }
    set
    {
        if ((this._ParentKey != value))
        {
            //This code is added by the association
            if (this._Parent.HasLoadedOrAssignedValue)
            {
                throw new System.Data.Linq.ForeignKeyReferenceAlreadyHasValueException();
            }
            //This code is present regardless of association
            this.OnParentKeyChanging(value);
            this.SendPropertyChanging();
            this._ParentKey = value;
            this.SendPropertyChanged("ParentKey");
            this.OnServiceAddrIDChanged();
        }
    }
} 
```

这是关联属性。

```
[Association(Name="Parent_Child", Storage="_Parent", ThisKey="ParentKey", IsForeignKey=true, DeleteRule="CASCADE")]
public Parent Parent
{
    get
    {
        return this._Parent.Entity;
    }
    set
    {
        Parent previousValue = this._Parent.Entity;
        if (((previousValue != value) 
                    || (this._Parent.HasLoadedOrAssignedValue == false)))
        {
            this.SendPropertyChanging();
            if ((previousValue != null))
            {
                this._Parent.Entity = null;
                previousValue.Exemptions.Remove(this);
            }
            this._Parent.Entity = value;
            if ((value != null))
            {
                value.Exemptions.Add(this);
                this._ParentKey = value.ParentKey;
            }
            else
            {
                this._ParentKey = default(Nullable<int>);
            }
            this.SendPropertyChanged("Parent");
        }
    }
} 
```

最好通过关联而不是键来分配更改。这样，您不必担心是否加载了父级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:56:48.557

```
Table1:       Table2:
ID            ID
Name          Description
              ForeignID 
```

有了这个 ：

Table2.ForeignID = 2

你收到一个错误............

例子 ：

您可以更改表 2 中的 ForeignID 字段：

```
 Table2 table = dataContext.Table2.single(d => d.ID == Id)

   table.Table1 = dataContext.Table1.single(d => d.ID == newId); 
```

其中变量`newId`是表 2 中记录的 ID，您希望将其与表 1 中的记录关联

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:41:13.990

您想与 table1 中的另一条记录关联或更改 table1.id？如果是选项 1，则需要删除该关联并设置一个新关联。如果选项 2，请检查您的 db 并查看是否为此 fk 启用了更新级联是，然后获取记录并更改 id 的值。

# c - 在 C 中打印指针

> ID：197757
> 
> 赞同：55
> 
> 时间：2008-10-13T14:25:38.530
> 
> 标签：c, pointers

我试图用指针来理解一些东西，所以我写了这段代码：

```
#include <stdio.h>

int main(void)
{
    char s[] = "asd";
    char **p = &s;

    printf("The value of s is: %p\n", s);
    printf("The direction of s is: %p\n", &s);

    printf("The value of p is: %p\n", p);
    printf("The direction of p is: %p\n", &p);

    printf("The direction of s[0] is: %p\n", &s[0]);
    printf("The direction of s[1] is: %p\n", &s[1]);
    printf("The direction of s[2] is: %p\n", &s[2]);

    return 0;
} 
```

使用 gcc 编译时，我收到以下警告：

```
$ gcc main.c -o main-bin -ansi -pedantic -Wall -lm
main.c: In function ‘main’:
main.c:6: warning: initialization from incompatible pointer type
main.c:9: warning: format ‘%p’ expects type ‘void *’, but argument 2 has type ‘char (*)[4]’
main.c:11: warning: format ‘%p’ expects type ‘void *’, but argument 2 has type ‘char **’
main.c:12: warning: format ‘%p’ expects type ‘void *’, but argument 2 has type ‘char ***’ 
```

（gcc 的标志是因​​为我必须是 C89）

为什么指针类型不兼容？数组的名称不是指向它的第一个元素的指针吗？因此，如果 s 是指向“a”的指针，则`&s`必须是 a `char **`，不是吗？为什么我会收到其他警告？我是否必须使用 ( `void *`) 转换指针才能打印它们？

运行时我得到这样的东西：

```
$ ./main-bin
The value of s is: 0xbfb7c860
The direction of s is: 0xbfb7c860
The value of p is: 0xbfb7c860
The direction of p is: 0xbfb7c85c
The direction of s[0] is: 0xbfb7c860
The direction of s[1] is: 0xbfb7c861
The direction of s[2] is: 0xbfb7c862 
```

s 的值和它的方向（当然还有 的值`p`）怎么能一样呢？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-13T14:44:10.723

“s”不是“char*”，而是“char[4]”。因此，“&s”不是“char**”，而是“指向 4 个字符数组的指针”。您的编译器可能会将“&s”视为您编写了“&s[0]”，这大致相同，但它是一个“char*”。

当你写“char** p = &s;” 您试图说“我希望将 p 设置为当前指向“asd”的事物的地址。但目前没有任何内容*指向*“asd”。只有一个*包含*“asd”的数组；

```
char s[] = "asd";
char *p = &s[0];  // alternately you could use the shorthand char*p = s;
char **pp = &p; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-13T14:31:38.973

是的，您的编译器期望 void *。只需将它们转换为 void *.

```
/* for instance... */
printf("The value of s is: %p\n", (void *) s);
printf("The direction of s is: %p\n", (void *) &s); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T14:37:57.507

如果将数组的名称作为参数传递给函数，则将其视为已传递数组的地址。所以 &s 和 s 是相同的参数。参见 K&R 5.3。&s[0] 与 &s 相同，因为它获取数组的第一个元素的地址，这与获取数组本身的地址相同。

对于所有其他指针，尽管所有指针本质上都是内存位置，但它们仍然是类型化的，编译器会警告将一种类型的指针分配给另一种类型的指针。

*   `void* p;`说 p 是内存地址，但我不知道内存中有什么
*   `char* s;`说s是内存地址，第一个字节包含一个字符
*   `char** ps;`说 ps 是一个内存地址，那里的四个字节（对于 32 位系统）包含一个 char* 类型的指针。

cf [http://www.oberon2005.ru/paper/kr_c.pdf（K&R](http://www.oberon2005.ru/paper/kr_c.pdf)的电子书版）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-15T01:42:51.760

它不是指向字符`char*`的指针，而是指向 4 个字符数组的指针： `char* [4]`. 使用 g++ 它不会编译：

> main.cpp：在函数'int main（int，char**）'中：main.cpp：126：错误：初始化时无法将'char（*）[4]'转换为'char**'

此外，linux手册页[说](http://linux.die.net/man/3/printf)：

> p
> 
> void * 指针参数以十六进制打印（就像通过 %#x 或 %#lx 一样）。它应该是指向无效的指针。

您可以将代码更改为：

```
char* s = "asd";
char** p = &s;

printf("The value of s is: %p\n", s);
printf("The address of s is: %p\n", &s);

printf("The value of p is: %p\n", p);
printf("The address of p is: %p\n", &p);

printf("The address of s[0] is: %p\n", &s[0]);
printf("The address of s[1] is: %p\n", &s[1]);
printf("The address of s[2] is: %p\n", &s[2]); 
```

结果：

s的值为：0x403f00

s的地址是：0x7fff2df9d588

p的值为：0x7fff2df9d588

p的地址是：0x7fff2df9d580

s[0]的地址是：0x403f00

s[1]的地址是：0x403f01

s[2]的地址为：0x403f02

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T14:34:39.887

换行：

```
char s[] = "asd"; 
```

到：

```
char *s = "asd"; 
```

事情会变得更清楚

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T14:38:15.980

您不能更改静态数组的值（即地址）。用技术术语来说，数组的左值是它的第一个元素的地址。因此`s == &s`。这只是语言的一个怪癖。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T17:20:20.160

通常，不必要地将指针强制转换为 (void*) 被认为是一种糟糕的风格。但是，在这里，您需要在 printf 参数上强制转换为 (void*)，因为 printf 是可变参数。原型没有告诉编译器在调用站点将指针转换为什么类型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T14:28:28.587

您使用过：

```
char s[] = "asd"; 
```

这里 s 实际上指向字节“asd”。s 的地址也将指向这个位置。

如果您使用：

```
char *s = "asd"; 
```

s 和 &s 的值会有所不同，因为 s 实际上是指向字节“asd”的指针。

你用过：

```
char s[] = "asd";
char **p = &s; 
```

这里 s 指向字节“asd”。p 是一个指向字符的指针，并且已经被设置为一个字符的地址。换句话说，您在 p 中有太多间接。如果你使用 char *s = "asd"，你可以使用这个额外的间接。

# regex - 帮助在其他东西之前或之后匹配某物的正则表达式

> ID：197758
> 
> 赞同：4
> 
> 时间：2008-10-13T14:26:07.097
> 
> 标签：regex

我有一堆看起来像这样的行的 XML

```
<_char font_name="/ITC Stone Serif Std Bold" italic="true" /> 
```

但有时看起来像这样

```
<_char font_size="88175" italic="true" font_name="/ITC Stone Serif Std Bold" /> 
```

这是我需要做的

*   对于包含**ITC Stone Serif Std Bold的每一行，将****italic="true"**替换为**italic="false**，无论它是在**斜体**部分之前还是之后。

 ****这可以用一个正则表达式来完成吗？

我不是在寻找实时解决方案。我只有大量的 XML 文件，其中包含这个“错误”，我正在尝试使用 PowerGrep 进行全局搜索和替换，这需要一个正则表达式。如果脚本是唯一的方法，那就这样吧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:38:50.470

'|'的简单使用 运营商满意吗？

```
name="/ITC Stone Sans Std Bold"[^>]italic="(true)"|italic="(true)"[^>]font_name="/ITC Stone Serif Std Bold" 
```

这应该检测到属性名称之前或之后属性斜体且值为 true 的任何行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:38:41.267

好吧，一般来说，使用 RE 进行 XML 解析并不是一个好主意。但是，如果您真的想要，最简单的方法就是分两行完成：

```
if (/ITC Stone Serif Std Bold/) {
   s/italic="true"/italic="false"/g;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:41:11.323

在 Perl - 未经测试：

```
while (<>)
{
    s/italic="true"/italic="false"/ if m%font_name="/ITC Stone Sans Std Bold" italic="true"|italic="true" font_name="/ITC Stone Serif Std Bold"%;
    print;
} 
```

非常简单 - 可能需要一个全局限定符，如果同一行的其他部分可能包含斜体选项，则可能需要一个更复杂的替代品。

另外 - 一个想法 - 你应该借此机会使符号统一，所以总是把斜体放在字体名称的前面（或后面）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T16:02:16.510

```
Pattern: /(<_char(?=(?:\s+\w+="[^"]*")*?\s+font_name="[^"]*?ITC Stone Serif Std Bold[^"]*")(?:\s+\w+="[^"]*")*?\s+italic=")true(?=")/
Replacement: '$1false' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T04:09:56.183

### Perl 5.10

使用 Perl 5.10 的新特性。

```
s(
 <_char \s* [^>]*? \K (?: (?&font) \s+ (?&italic) | (?&italic) \s+ (?&font) )
 (?(DEFINE)
  (?<font>font_name="/ITC[ ]Stone[ ]Serif[ ]Std[ ]Bold")
  (?<italic>italic="true")
 )
){
 $+{font} . 'italic="false"'
}xge 
```

*警告：未经测试。*

# python - 处理包含多个字符编码的字符串

> ID：197759
> 
> 赞同：9
> 
> 时间：2008-10-13T14:26:10.293
> 
> 标签：python, string, unicode, encoding

我不确定如何真正问这个问题，而且我离找到答案还很遥远，所以我希望有人能帮助我。

我正在编写一个 Python 应用程序，它连接到远程主机并接收返回的字节数据，我使用 Python 的内置 struct 模块对其进行解包。我的问题是字符串，因为它们包含多个字符编码。以下是此类字符串的示例：

"^L这是一个示例 ^Gstring 具有多个 ^J 字符编码"

使用特殊转义字符标记不同编码开始和结束的位置：

*   ^L - 拉丁语1
*   ^E - 中欧
*   ^T - 土耳其语
*   ^B - 波罗的海
*   ^J - 日语
*   ^C - 西里尔字母
*   ^G - 希腊语

等等......我需要一种将这种字符串转换为 Unicode 的方法，但我真的不知道该怎么做。我已经阅读了 Python 的编解码器和 string.encode/decode，但我真的一点也不聪明。我还应该提到，我无法控制主机如何输出字符串。

我希望有人可以帮助我了解如何开始。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T15:29:10.557

这是一个相对简单的示例，说明如何操作...

```
# -*- coding: utf-8 -*-
import re

# Test Data
ENCODING_RAW_DATA = (
    ('latin_1',    'L', u'Hello'),        # Latin 1
    ('iso8859_2',  'E', u'dobrý večer'),  # Central Europe
    ('iso8859_9',  'T', u'İyi akşamlar'), # Turkish
    ('iso8859_13', 'B', u'Į sveikatą!'),  # Baltic
    ('shift_jis',  'J', u'今日は'),        # Japanese
    ('iso8859_5',  'C', u'Здравствуйте'), # Cyrillic
    ('iso8859_7',  'G', u'Γειά σου'),   # Greek
)

CODE_TO_ENCODING = dict([(chr(ord(code)-64), encoding) for encoding, code, text in ENCODING_RAW_DATA])
EXPECTED_RESULT = u''.join([line[2] for line in ENCODING_RAW_DATA])
ENCODED_DATA = ''.join([chr(ord(code)-64) + text.encode(encoding) for encoding, code, text in ENCODING_RAW_DATA])

FIND_RE = re.compile('[\x00-\x1A][^\x00-\x1A]*')

def decode_single(bytes):
    return bytes[1:].decode(CODE_TO_ENCODING[bytes[0]])

result = u''.join([decode_single(bytes) for bytes in FIND_RE.findall(ENCODED_DATA)])

assert result==EXPECTED_RESULT, u"Expected %s, but got %s" % (EXPECTED_RESULT, result) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T14:52:14.907

没有用于解码这样的字符串的内置功能，因为它实际上是它自己的自定义编解码器。您只需在这些控制字符上拆分字符串并相应地对其进行解码。

这是处理 latin1 和 shift-JIS 的此类函数的（非常慢的）示例：

```
latin1 = "latin-1"
japanese = "Shift-JIS"

control_l = "\x0c"
control_j = "\n"

encodingMap = {
    control_l: latin1,
    control_j: japanese}

def funkyDecode(s, initialCodec=latin1):
    output = u""
    accum = ""
    currentCodec = initialCodec
    for ch in s:
        if ch in encodingMap:
            output += accum.decode(currentCodec)
            currentCodec = encodingMap[ch]
            accum = ""
        else:
            accum += ch
    output += accum.decode(currentCodec)
    return output 
```

更快的版本可能会使用 str.split 或正则表达式。

（另外，正如你在这个例子中看到的，“^J”是“换行符”的控制字符，所以你的输入数据会有一些有趣的限制。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T14:32:48.970

我会编写一个编解码器，增量扫描字符串并在字节出现时对其进行解码。本质上，您必须将字符串分成具有一致编码的块，然后对它们进行解码并将它们附加到它们后面的字符串中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T15:24:45.543

您必须首先将字符串拆分为具有不同编码的子字符串，然后分别解码每个子字符串。只是为了好玩，强制性的“单行”版本：

```
import re

encs = {
    'L': 'latin1',
    'G': 'iso8859-7',
    ...
}

decoded = ''.join(substr[2:].decode(encs[substr[1]])
             for substr in re.findall('\^[%s][^^]*' % ''.join(encs.keys()), st)) 
```

（没有错误检查，您还需要决定如何处理子字符串中的 '^' 字符）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T14:55:31.810

我认为您没有任何方法可以说服托管另一台机器的人切换到 unicode？

毕竟，这是发明 Unicode 的原因之一。

# svn - 豆茎类功能

> ID：197760
> 
> 赞同：0
> 
> 时间：2008-10-13T14:26:27.203
> 
> 标签：svn, version-control, beanstalk-svn

我终于让我的团队接受源代码管理，因为我们正在处理多个开发人员接触相同代码库的项目，并且我在 Beanstalk 上为托管 Subversion 设置了一个免费/试用帐户，以便人们可以体验一下它是如何工作的。

也就是说，我们已经讨论了一个雄心勃勃的计划，将许多需要/想要的功能放入我们可以自己运行的单个服务器中，虽然我认为这很好，但随着这些计划的缓慢形成，我们仍在没有 SCM 的情况下工作。

在此期间，我想设置一个临时 SVN 服务器，但想知道是否有任何我们可以设置的 F/OSS 包可以提供类似 Beanstalk 的功能（即漂亮的 Web 界面/管理设置）。我不太关心包的核心语言，除非我需要修改系统本身的代码，在这种情况下，我对 PHP、Perl 和 .NET 相当满意，尽管我可能会根据需要选择（一种）其他语言。也就是说，我想避开 .NET 或任何其他需要 Windows 许可证的技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T19:41:34.213

Stack Overflow 上可能有很多人对 Subversion 了解很多，但从未听说过 Beanstalk，因此无法帮助您。具体来说，您在寻找什么 Web 前端功能？

我的团队只需要通过网络浏览器浏览我们的 SVN 存储库（并比较修订版），为此我们使用[WebSVN](http://websvn.tigris.org/)。它很简单，而且不是特别全功能，但它为我们完成了这项工作。您不能使用 WebSVN 创建存储库，但由于这是一项非常简单的工作，而且相对不频繁地完成，这可能不是问题，是吗？

# excel - 在 Excel 2007 中是否可以看到超过 65536 行？

> ID：197762
> 
> 赞同：16
> 
> 时间：2008-10-13T14:27:30.617
> 
> 标签：excel

我有一个超过 65536 行的 excel 文件。但是，我只能看到其中的前 65536 个。是否可以在 Excel 2007 中查看所有这些？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-13T14:32:25.897

这是一篇关于 Excel 2007 的数字/限制的有趣[博客条目](http://blogs.msdn.com/excel/archive/2005/09/26/474258.aspx)。根据作者的说法，新的限制大约是**一百万行**。

听起来您**在 Excel 2007 中以兼容模式打开了 Excel 2007 之前的工作簿**（查看标题栏中是否显示兼容模式）。如果是这样，则工作簿有 65,536 行，而不是 1,048,576 行。您可以将工作簿保存为 Excel 2007 格式的 Excel 工作簿，关闭工作簿并重新打开它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-13T14:30:56.727

根据[此 MSDN 条目](http://blogs.msdn.com/excel/archive/2005/09/26/474258.aspx)，限制为 100 万行。您可以在兼容模式下运行，这会将您限制为 65k 的旧标准。你的 excel 标题中是否说明了兼容模式？如果是这样，您可以在“另存为”菜单下将文件另存为新样式文件，或者将默认设置更改为始终使用 2007 文件标准。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T14:53:30.427

我发现 65536 限制仍然适用于数据透视表，即使在 Excel 2007 中也是如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T20:56:51.050

我不是 100% 确定所有其他建议都试图去哪里，但问题基本上与您在文件中的扩展名有关。如果您将文件保存为 Excel 97/2003 工作簿，它将不允许您查看所有百万行。创建一个新工作表并将其保存为工作簿，您将看到全部百万。注意：扩展名将是 .xlsx

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-25T15:51:39.940

Excel 2003，不包括 1M 行功能，从 2007 年开始引入。

在 Excel2007 中，另存为“普通”Excel 文件，而不是向后兼容的文件。

您可能必须关闭并重新打开 Excel 才能获得完整的 1M 行

蒂利普

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T14:32:08.737

是的，新的限制大约是 100 万行。

[http://blogs.msdn.com/excel/archive/2005/09/26/474258.aspx](http://blogs.msdn.com/excel/archive/2005/09/26/474258.aspx)

# javascript - JavaScript 的 eval() 什么时候不是邪恶的？

> ID：197769
> 
> 赞同：288
> 
> 时间：2008-10-13T14:28:28.683
> 
> 标签：javascript, coding-style, eval

我正在编写一些 JavaScript 代码来解析用户输入的函数（用于类似电子表格的功能）。解析公式后，我*可以*将其转换为 JavaScript 并在其上运行`eval()`以产生结果。

但是，如果我可以避免使用它，我总是回避使用`eval()`它，因为它是邪恶的（无论对错，我一直认为它在 JavaScript 中更加邪恶，因为要评估的代码可能会被用户更改）。

那么，什么时候可以使用呢？

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2008-10-13T15:40:39.707

我想花点时间来解决您问题的前提- eval() 是“*邪恶*的”。编程语言人们使用的“*邪恶*”一词通常意味着“危险”，或者更准确地说是“能够用一个看起来很简单的命令造成很多伤害”。那么，什么时候可以使用危险的东西呢？当您知道危险是什么并采取适当的预防措施时。

言归正传，让我们看看使用 eval() 的危险。和其他所有事情一样，可能存在许多小的隐患，但两大风险 - eval() 被认为是邪恶的原因 - 是性能和代码注入。

*   性能 - eval() 运行解释器/编译器。如果您的代码被编译，那么这是一个很大的打击，因为您需要在运行时调用一个可能很重的编译器。然而，JavaScript 仍然主要是一种解释性语言，这意味着调用 eval() 在一般情况下不会对性能造成很大影响（但请参阅下面的具体说明）。
*   代码注入 - eval() 可能在提升的权限下运行一串代码。例如，以管理员/root 身份运行的程序永远不会想要 eval() 用户输入，因为该输入可能是“rm -rf /etc/important-file”或更糟。同样，浏览器中的 JavaScript 不存在这个问题，因为该程序无论如何都在用户自己的帐户中运行。服务器端 JavaScript 可能有这个问题。

关于你的具体情况。据我了解，您是自己生成字符串，所以假设您小心不允许生成像“rm -rf something-important”这样的字符串，没有代码注入风险（但请记住，它*非常非常在一般情况下很难*确保这一点）。另外，如果你在浏览器中运行，那么代码注入风险很小，我相信。

至于性能，您必须权衡它与编码的易用性。我认为，如果您正在解析公式，您不妨在解析期间计算结果，而不是运行另一个解析器（eval() 中的那个）。但是使用 eval() 编码可能更容易，并且性能损失可能不明显。在这种情况下，看起来 eval() 并不比任何其他可能为您节省时间的函数更邪恶。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-10-13T14:44:03.970

`eval()`不是邪恶的。或者，如果是，它是邪恶的，就像反射、文件/网络 I/O、线程和 IPC 在其他语言中是“邪恶的”一样。

如果*出于您的目的*，`eval()`它比手动解释更快，或者使您的代码更简单或更清晰......那么您应该使用它。如果两者都不是，那么你不应该。就那么简单。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2008-10-13T14:34:37.687

当您信任来源时。

在 JSON 的情况下，篡改源或多或少是困难的，因为它来自您控制的 Web 服务器。只要 JSON 本身不包含用户上传的数据，使用 eval 就没有大的缺点。

在所有其他情况下，我会竭尽全力确保用户提供的数据符合我的规则，然后再将其提供给 eval()。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2010-04-13T20:49:38.817

让我们得到真正的人：

1.  现在每个主要浏览器都有一个内置控制台，你的潜在黑客可以大量使用它来调用具有任何值的任何函数——即使他们可以，他们为什么还要费心使用 eval 语句？

2.  如果编译 2000 行 JavaScript 需要 0.2 秒，如果我 eval 4 行 JSON，我的性能下降是多少？

甚至 Crockford 对“eval is evil”的解释也很薄弱。

> eval 是邪恶的，eval 函数是 JavaScript 中被滥用最多的特性。躲开它

正如克罗克福德自己可能会说的那样，“这种说法往往会产生非理性的神经症。不要买它。”

了解 eval 并知道它何时有用更为重要。例如，eval 是一个明智的工具，用于评估由您的软件生成的服务器响应。

顺便说一句：Prototype.js 直接调用 eval 五次（包括在 evalJSON() 和 evalResponse() 中）。jQuery 在 parseJSON 中使用它（通过 Function 构造函数）。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-10-13T14:36:50.647

我倾向于遵循[Crockford 的建议](http://javascript.crockford.com/code.html)，`eval()`并完全避免它。即使看起来需要它的方式也不需要。例如，`setTimeout()`允许您传递函数而不是 eval。

```
setTimeout(function() {
  alert('hi');
}, 1000); 
```

即使它是*受信任*的来源，我也不使用它，因为 JSON 返回的代码可能是乱码，这充其量可能会做一些不可靠的事情，最坏的情况是会暴露一些不好的东西。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-04-19T10:18:08.900

Eval 是对用于模板化代码的编译的补充。我所说的模板是指您编写一个简化的模板生成器，该生成器可以生成有用的模板代码，从而提高开发速度。

我编写了一个框架，开发人员不使用 EVAL，但他们使用我们的框架，而该框架又必须使用 EVAL 来生成模板。

可以使用以下方法提高 EVAL 的性能；您必须返回一个函数，而不是执行脚本。

```
var a = eval("3 + 5"); 
```

它应该组织为

```
var f = eval("(function(a,b) { return a + b; })");

var a = f(3,5); 
```

缓存 f 肯定会提高速度。

Chrome 也可以很容易地调试这些功能。

关于安全性，是否使用 eval 几乎没有任何区别，

1.  首先，浏览器在沙箱中调用整个脚本。
2.  **任何在 EVAL 中邪恶的代码，在浏览器本身都是邪恶的。攻击者或任何人都可以轻松地在 DOM 中注入一个脚本节点，如果他/她可以评估任何东西，就可以做任何事情。不使用 EVAL 不会有任何区别。**
3.  有害的主要是服务器端安全性差。服务器上糟糕的 cookie 验证或糟糕的 ACL 实施会导致大多数攻击。
4.  Java的本机代码中存在最近的Java漏洞等。JavaScript 被设计为在沙箱中运行，而小程序被设计为在带有证书等的沙箱之外运行，这会导致漏洞和许多其他事情。
5.  编写模仿浏览器的代码并不难。您所要做的就是使用您喜欢的用户代理字符串向服务器发出 HTTP 请求。无论如何，所有测试工具都会模拟浏览器；如果攻击者想伤害你，EVAL 是他们最后的手段。他们有许多其他方法来处理您的服务器端安全性。
6.  浏览器 DOM 无权访问文件，也无权访问用户名。事实上，eval 可以访问的机器上没有任何东西。

**如果您的服务器端安全性足够稳固，任何人都可以从任何地方进行攻击，那么您不必担心 EVAL。正如我所提到的，如果 EVAL 不存在，攻击者有许多工具可以侵入您的服务器，而不管您的浏览器的 EVAL 功能如何。**

eval 只适用于生成一些模板，根据事先没有使用的东西进行复杂的字符串处理。例如，我更喜欢

```
"FirstName + ' ' + LastName" 
```

相对于

```
"LastName + ' ' + FirstName" 
```

作为我的显示名称，它可以来自数据库并且不是硬编码的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-07-23T12:03:40.710

在 Chrome (v28.0.1500.72) 中调试时，我发现如果变量没有在生成闭包的嵌套函数中使用，则它们不会绑定到闭包。我猜，这是对 JavaScript 引擎的优化。

**但是**：当`eval()`在导致闭包的函数内部使用时，外部函数的**所有**变量都绑定到闭包，即使它们根本没有使用。如果有人有时间测试是否会产生内存泄漏，请在下面给我留言。

这是我的测试代码：

```
(function () {
    var eval = function (arg) {
    };

    function evalTest() {
        var used = "used";
        var unused = "not used";

        (function () {
            used.toString();   // Variable "unused" is visible in debugger
            eval("1");
        })();
    }

    evalTest();
})();

(function () {
    var eval = function (arg) {
    };

    function evalTest() {
        var used = "used";
        var unused = "not used";

        (function () {
            used.toString();   // Variable "unused" is NOT visible in debugger
            var noval = eval;
            noval("1");
        })();
    }

    evalTest();
})();

(function () {
    var noval = function (arg) {
    };

    function evalTest() {
        var used = "used";
        var unused = "not used";

        (function () {
            used.toString();    // Variable "unused" is NOT visible in debugger
            noval("1");
        })();
    }

    evalTest();
})(); 
```

我想在这里指出的是， eval() 不一定要引用本机`eval()`函数。**这完全取决于函数的名称**。`eval()`因此，当使用别名调用本机时（例如`var noval = eval;`，然后在内部函数中），当它引用应该是闭包一部分但实际上不是的变量时，`noval(expression);`评估可能会失败。`expression`

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-08-13T19:59:40.407

# 底线

如果您创建或清理了您的代码`eval`，它永远不会是**邪恶**的。

# 稍微详细一点

`eval`**如果使用不是由开发人员创建**或**未经开发人员清理**的客户端提交的输入在服务器上运行，这是**邪恶**的。

 ****`eval`如果在客户端上运行，**即使使用客户端制作的未经处理的输入**也不是**邪恶**的。

 **显然，您*应该*始终清理输入，以便对您的代码消耗的内容进行一些控制。

# 推理

客户端可以运行任何他们想要的任意代码，即使开发人员没有编写代码；这不仅适用于被评估的*内容*，而且适用于对*自身的**调用`eval`*。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-13T17:24:09.700

我看到人们提倡不要使用 eval，因为它是*邪恶*的，但我看到同样的人动态使用 Function 和 setTimeout，所以他们*在幕后*使用 eval :D

顺便说一句，如果您的沙箱不够确定（例如，如果您在允许代码注入的站点上工作），那么 eval 是您的最后一个问题。安全的基本规则是*所有*输入都是邪恶的，但在 JavaScript 的情况下，*甚至*JavaScript 本身也可能是邪恶的，因为在 JavaScript 中你可以覆盖任何函数，但你不能确定你使用的是真实的，所以，如果恶意代码在您之前启动，则您不能信任任何 JavaScript 内置函数：D

现在这篇文章的结尾是：

如果您**真的**需要它（80% 的时间不需要 eval **）**并且您确定自己在做什么，只需使用 eval（或更好的 Function ;)），闭包和 OOP 涵盖了 80/90%在 eval 可以使用另一种逻辑替换的情况下，其余的是动态生成的代码（例如，如果您正在编写解释器）并且正如您已经说过评估 JSON（在这里您可以使用 Crockford 安全评估；））

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-13T14:35:22.100

您应该使用 eval() 的唯一实例是当您需要动态运行动态 JS 时。我说的是你从服务器异步下载的 JS ......

...而 10 的 9 倍，您可以通过重构轻松避免这样做。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-02-13T07:49:55.563

在服务器端 eval 在处理外部脚本（如 sql 或 influxdb 或 mongo）时很有用。无需重新部署服务即可在运行时进行自定义验证。

例如具有以下元数据的成就服务

```
{
  "568ff113-abcd-f123-84c5-871fe2007cf0": {
    "msg_enum": "quest/registration",
    "timely": "all_times",
    "scope": [
      "quest/daily-active"
    ],
    "query": "`SELECT COUNT(point) AS valid from \"${userId}/dump/quest/daily-active\" LIMIT 1`",
    "validator": "valid > 0",
    "reward_external": "ewallet",
    "reward_external_payload": "`{\"token\": \"${token}\", \"userId\": \"${userId}\", \"amountIn\": 1, \"conversionType\": \"quest/registration:silver\", \"exchangeProvider\":\"provider/achievement\",\"exchangeType\":\"payment/quest/registration\"}`"
  },
  "efdfb506-1234-abcd-9d4a-7d624c564332": {
    "msg_enum": "quest/daily-active",
    "timely": "daily",
    "scope": [
      "quest/daily-active"
    ],
    "query": "`SELECT COUNT(point) AS valid from \"${userId}/dump/quest/daily-active\" WHERE time >= '${today}' ${ENV.DAILY_OFFSET} LIMIT 1`",
    "validator": "valid > 0",
    "reward_external": "ewallet",
    "reward_external_payload": "`{\"token\": \"${token}\", \"userId\": \"${userId}\", \"amountIn\": 1, \"conversionType\": \"quest/daily-active:silver\", \"exchangeProvider\":\"provider/achievement\",\"exchangeType\":\"payment/quest/daily-active\"}`"
  }
}
```

然后允许，

*   通过 json 中的文字字符串直接注入对象/值，对于模板文本很有用

*   可以用作比较器，比如我们制定了如何在 CMS 中验证任务或事件的规则

缺点：

*   如果没有经过全面测试，可能是代码中的错误并破坏了服务中的内容。

*   如果黑客可以在您的系统上编写脚本，那么您就完蛋了。

*   验证脚本的一种方法是将脚本的哈希保存在安全的地方，以便在运行之前检查它们。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-01-17T18:02:01.680

eval 不是邪恶的，只是被滥用了。

如果您创建了进入其中的代码或可以信任它，那没关系。人们一直在谈论用户输入如何与 eval 无关。好样的~

如果有用户输入到服务器，然后返回到客户端，并且该代码在 eval 中使用而没有被清理。恭喜，您打开了潘多拉魔盒，可以将用户数据发送给任何人。

根据 eval 所在的位置，许多网站都使用 SPA，而 eval 可以让用户更轻松地访问应用程序内部，否则这将是不容易的。现在他们可以制作一个伪造的浏览器扩展程序，可以将其录入该评估并再次窃取数据。

只是要弄清楚你使用 eval 有什么意义。当您可以简单地创建方法来执行此类操作、使用对象等时，生成代码并不是很理想。

现在是使用 eval 的一个很好的例子。您的服务器正在读取您创建的 swagger 文件。许多 URL 参数都是以`{myParam}`. 因此，您希望读取 URL，然后将它们转换为模板字符串，而无需进行复杂的替换，因为您有许多端点。所以你可以做这样的事情。请注意，这是一个非常简单的示例。

```
const params = { id: 5 };

const route = '/api/user/{id}';
route.replace(/{/g, '${params.');

// use eval(route); to do something 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-11T13:06:49.723

`eval`很少是正确的选择。虽然可能有许多情况下您可以通过将脚本连接在一起并即时运行它来完成您需要完成的事情，但您通常可以使用更强大且可维护的技术：关联数组表示法（`obj["prop"]`与 相同`obj.prop`） 、闭包、面向对象的技术、函数式技术——改用它们。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-07-29T16:52:55.463

就客户端脚本而言，我认为安全问题是一个有争议的问题。加载到浏览器中的所有内容都受到操纵，应该被这样对待。当有更简单的方法来执行 JavaScript 代码和/或操作 DOM 中的对象（例如浏览器中的 URL 栏）时，使用 eval() 语句的风险为零。

```
javascript:alert("hello"); 
```

如果有人想操纵他们的 DOM，我会说摇摆不定。防止任何类型的攻击的安全性应始终是服务器应用程序的责任。

从务实的角度来看，在可以以其他方式完成事情的情况下使用 eval() 没有任何好处。但是，在某些特定情况下应该使用 eval。如果是这样，绝对可以在没有任何炸毁页面的风险的情况下完成。

```
<html>
    <body>
        <textarea id="output"></textarea><br/>
        <input type="text" id="input" />
        <button id="button" onclick="execute()">eval</button>

        <script type="text/javascript">
            var execute = function(){
                var inputEl = document.getElementById('input');
                var toEval = inputEl.value;
                var outputEl = document.getElementById('output');
                var output = "";

                try {
                    output = eval(toEval);
                }
                catch(err){
                    for(var key in err){
                        output += key + ": " + err[key] + "\r\n";
                    }
                }
                outputEl.value = output;
            }
        </script>
    <body>
</html> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-13T14:36:17.310

如果您可以完全控制传递给`eval`函数的代码，则可以使用它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-13T14:40:27.427

如果可能，仅在测试期间。另请注意， eval() 比其他专门的 JSON 等评估器慢得多。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-13T14:47:41.840

只要您可以确定代码的来源来自您或实际用户，就没有理由不使用 eval()。尽管他可以操纵发送到 eval() 函数的内容，但这不是安全问题，因为他能够操纵网站的源代码，因此可以更改 JavaScript 代码本身。

那么......什么时候不使用eval（）？仅当第三方有可能更改它时，才不应使用 Eval()。就像拦截客户端和服务器之间的连接一样（但如果这是一个问题，请使用 HTTPS）。您不应该 eval() 来解析其他人（例如在论坛中）编写的代码。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-20T18:50:23.520

如果真的需要 eval 不是邪恶的。但是我偶然发现的 eval 的 99.9% 的使用是**不需要**的（不包括 setTimeout 的东西）。

对我来说，邪恶不是性能，甚至不是安全问题（嗯，间接地两者兼而有之）。所有这些不必要的 eval 使用增加了维护地狱。重构工具被抛弃。搜索代码很困难。这些评估的意想不到的影响是军团。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-04-30T06:59:29.917

我的使用示例`eval`：*import*。

一般是怎么做的。

```
var components = require('components');
var Button = components.Button;
var ComboBox = components.ComboBox;
var CheckBox = components.CheckBox;
...
// That quickly gets very boring 
```

但是在`eval`一个小辅助函数的帮助下，它得到了更好的外观：

```
var components = require('components');
eval(importable('components', 'Button', 'ComboBox', 'CheckBox', ...)); 
```

`importable`可能看起来像（此版本不支持导入具体成员）。

```
function importable(path) {
    var name;
    var pkg = eval(path);
    var result = '\n';

    for (name in pkg) {
        result += 'if (name !== undefined) throw "import error: name already exists";\n'.replace(/name/g, name);
    }

    for (name in pkg) {
        result += 'var name = path.name;\n'.replace(/name/g, name).replace('path', path);
    }
    return result;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-03-19T05:22:06.353

我认为任何 eval 被证明是合理的情况都很少见。你更有可能使用它认为它是合理的，而不是你在它*实际上是*合理的时候使用它。

安全问题是最广为人知的。但也请注意，JavaScript 使用 JIT 编译，这与 eval 效果很差。Eval 有点像编译器的黑匣子，JavaScript 需要能够提前（在某种程度上）预测代码，以便安全、正确地应用性能优化和范围。在某些情况下，性能影响甚至会影响 eval 之外的其他代码。

如果您想了解更多信息： [https ://github.com/getify/You-Dont-Know-JS/blob/master/scope%20%26%20closures/ch2.md#eval](https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20%26%20closures/ch2.md#eval)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2022-01-21T21:04:40.210

既然还没有人提到它，让我补充一下`eval`，它对 Webassembly-Javascript 互操作非常有用。虽然将预制脚本包含在您的页面中以供您的 WASM 代码直接调用当然是理想的，但有时这是不切实际的，您需要从 C# 之类的 Web 汇编语言传入动态 Javascript 才能真正完成您需要做的事情。

在这种情况下它也是安全的，因为您可以完全控制传入的内容。好吧，我应该说，它的安全性不亚于使用 C# 编写 SQL 语句，也就是说它需要小心地完成（正确转义字符串等） .) 每当用户提供的数据用于生成脚本时。但是有了这个警告，它在互操作情况下有着明确的位置，并且远非“邪恶”。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-01-15T07:34:08.467

我的信念是 eval 是客户端 Web 应用程序的一个非常强大的功能，并且安全......与 JavaScript 一样安全，但不是。:-) 安全问题本质上是服务器端问题，因为现在使用 Firebug 之类的工具，您可以攻击任何 JavaScript 应用程序。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2012-04-25T23:43:03.113

*JavaScript 的 eval() 什么时候不是邪恶的？*

我总是试图[阻止使用 eval](https://stackoverflow.com/a/10279521)。几乎总是有一个更干净和可维护的解决方案可用。[即使是 JSON 解析也不需要](http://www.json.org/)Eval 。eval[增加了维护地狱](http://www.asiantravelhotel.com/javascript/when-is-javascript-39-s-eval-not-evil.html)。并非没有道理，像道格拉斯·克罗克福德这样的大师对此并不满意。

但我发现了一个*应该*使用它的例子：

## **当您需要传递表达式时。**

例如，我有一个[`google.maps.ImageMapType`](https://developers.google.com/maps/documentation/javascript/reference?hl=cs#ImageMapType)为我构造一个通用对象的函数，但我需要告诉它配方，它应该如何从`zoom`and`coord`参数构造磁贴 URL：

```
my_func({
    name: "OSM",
    tileURLexpr: '"http://tile.openstreetmap.org/"+b+"/"+a.x+"/"+a.y+".png"',
    ...
});

function my_func(opts)
{
    return new google.maps.ImageMapType({
        getTileUrl: function (coord, zoom) {
            var b = zoom;
            var a = coord;
            return eval(opts.tileURLexpr);
        },
        ....
    });
} 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2013-07-12T19:54:19.057

当您没有宏时，Eval 对代码生成很有用。

对于（一个愚蠢的）示例，如果您正在编写一个[Brainfuck](https://en.wikipedia.org/wiki/Brainfuck)编译器，您可能想要构造一个函数，将指令序列作为字符串执行，并对其进行 eval 以返回一个函数。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-11-28T10:59:39.990

代码生成。我最近编写了一个名为[Hyperbars的库，它弥补了](https://github.com/vincentracine/hyperbars)[virtual-dom](https://github.com/Matt-Esch/virtual-dom)和[handlebars](http://handlebarsjs.com/)之间的差距。它通过解析把手模板并将其转换为[hyperscript](https://github.com/dominictarr/hyperscript)来做到这一点。超脚本首先生成为字符串，然后在返回之前将`eval()`其转换为可执行代码。在这种特殊情况下，我发现`eval()`邪恶与邪恶完全相反。

基本上来自

```
<div>
    {{#each names}}
        <span>{{this}}</span>
    {{/each}}
</div> 
```

对此

```
(function (state) {
    var Runtime = Hyperbars.Runtime;
    var context = state;
    return h('div', {}, [Runtime.each(context['names'], context, function (context, parent, options) {
        return [h('span', {}, [options['@index'], context])]
    })])
}.bind({})) 
```

在这种情况下，性能`eval()`也不是问题，因为您只需要解释一次生成的字符串，然后多次重复使用可执行输出。

如果您对此感到好奇，可以查看代码生成是如何实现[的](https://github.com/vincentracine/hyperbars/blob/master/src/hyperbars.js#L111)。

* * *

## 回答 #26

> 赞同：-5
> 
> 时间：2012-05-17T23:00:22.590

当您使用解析函数（例如，jQuery.parseJSON）解析 JSON 结构时，它需要一个完美的 JSON 文件结构（每个属性名称都用双引号括起来）。但是，JavaScript 更灵活。因此，您可以使用 eval() 来避免它。

# crystal-reports - Crystal Reports XI 在打开报表时挂起

> ID：197782
> 
> 赞同：7
> 
> 时间：2008-10-13T14:31:57.863
> 
> 标签：crystal-reports, report

我试图在 Crystal Report 11 Designer（产品版本 11.5.8.826）中打开一个报表，但它似乎冻结了。该报告过去可以正常工作，但今天客户端无法加载该报告。

我还尝试在另一个开发人员的工作站上打开报告，结果相同。

这有发生在其他人身上吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-15T20:21:35.640

在页面设置菜单中，您可以选中无打印机复选框，它将不再有在网络上查找打印机的延迟。我发现针对 Microsoft XPS Document Writer Printer 或类似的东西开始报告通常很有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T07:10:06.227

我们找到了答案。我们使用了一个名为 Wireshark (www.wireshark.org) 的程序。

我们关闭了所有应用程序，只运行了 Wireshark 并尝试在水晶设计器中打开报告。

然后发现它正在尝试访问我们使用的一个盒子上的打印机后台处理程序服务，但最近更改为另一个盒子。所以刚刚在旧盒子上重新启动了服务，一切又好了

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T14:46:35.930

您确定报告中引用的所有服务器仍然在线吗？如果您更改了报表上的数据库连接，我已经看到 Crystal 存储了对旧连接的引用，即使没有活动使用也是如此。如果旧服务器离线，Crystal 在加载时仍然会尝试连接它，并且会挂很长时间。我们有一份报告，过去在旧的测试服务器关闭后，几秒钟内加载开始需要几分钟。重新启动它，它立即再次加载，即使与它的所有连接似乎都已删除。我们最终从头开始完全重建报告。

我使用 Sysinternals TDIMon 找到了它，它显示了来自 Crystal 的连接尝试和超时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-09T02:03:46.173

我有类似的问题同时打开报告和设计器。

当时，我没有 Internet 连接，设计师正在尝试（未成功）加载包含在“起始页”中的 Web 内容。最终，超过了超时并加载了报告。我取消选中“显示在线资源”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-11T17:32:26.733

我也遇到了这个问题，并尝试了这里列出的几个项目。没用。然后我尝试使用文件夹图标从 Crystal Reports 中打开我想要的文件。报告立即打开。但是，如果我使用 Windows 资源管理器并转到存储它们的文件夹，然后尝试打开水晶报表，则加载需要 5 分钟（加载设计器选项卡需要 3 分钟，然后再加载预览选项卡需要 2 分钟）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-03T07:01:06.320

**Crystal Reports 挂在所有 Windows 服务器 2008 R2 和 IIS 7.5 上**

解决方案：选择打印机“Microsoft XPS Document Writer”。为此，请转到设计器中的报告->设计->页面设置并选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-06T16:00:05.707

试试这个“C#代码”：

```
ReportDocument rpDoc = new ReportDocument()
rpDoc.Load(Server.MapPath(@"reportname.rpt")); 
```

希望能帮助到你

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-30T13:44:56.663

我在 Crystal Reports 2008 (XII) 上遇到了同样的问题！我试图在 CR 被冻结时停止 Windows 打印机假脱机服务，并立即得到一个 anwer freom CR（打印机不是 ..blah blah using default...blah）

之后，我删除了页面设置中的“打印机复选框”（上面的答案）。之后，我在 CR 设计器中加载此报告没有问题，并且 C# ReportDocument.Load(string filePath) 工作正常......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-19T10:06:25.040

我的情况也是如此。当我查看报告时，我的应用程序卡住了，但在水晶报告设计器中检查了“无打印机”选项后，它工作正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-18T13:38:15.673

我们也遇到了这个问题，并确定它与创建报告时连接到打印机的默认打印机有关。与 Pirmin Ruegg 遇到的问题和解决方案非常相似。将默认打印机设置为所有用户都拥有的打印机，或选择无打印机选项，更正了我们的问题。

# java - 在同一 Tomcat 实例中运行的 Web 应用程序之间传输文件

> ID：197784
> 
> 赞同：3
> 
> 时间：2008-10-13T14:32:22.027
> 
> 标签：java, tomcat

我有两个 Web 应用程序在同一个 Tomcat 实例中运行。在这些应用程序之一中，用户将能够上传图像和 pdf 文件等文件。我希望上传的文件可用于第二个应用程序。

这种情况是否有最佳实践？或者只是一个指向技术的指针就可以了。

我考虑过使用 Web 服务，但想知道这是否有点矫枉过正。

谢谢文森特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:39:33.247

便宜，糟糕的答案 - 将两个应用程序软链接到共享目录。这样做的好处是愚蠢-简单，但存在邪恶的事务类型问题。由于您说只有一个应用程序正在更改数据，而另一个是只读的，因此只要第二个应用程序无法观察处于部分创建状态的文件，您就可以摆脱它。

使用数据库在事务上是安全的，但随着文件变大，会变得非常不愉快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T14:38:22.373

我想说这取决于您需要文件存储的强大程度以及事务性。最简单的方法是两个应用程序的类路径上的共享目录。数据库将是一个更强大但更复杂的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:34:05.707

您可以将文件推送到共享数据库中……这也可以让您将元数据与它们一起存储。

# networking - 如何从 Virtual PC 映像中连接到主机

> ID：197792
> 
> 赞同：3
> 
> 时间：2008-10-13T14:34:48.823
> 
> 标签：networking, virtual-pc

我正在使用 WinXP Virtual PC 映像进行 SVN 演示，但无法从 VPC 来宾操作系统中看到我的主机。

此演示将在与我们的 LAN 断开连接时执行，因此我在笔记本电脑上安装了 Microsoft Loopback 适配器。在 TCP/IP 设置中，我手动将 IP 地址设置为 192.168.3.1 以避免与我们的内部网络发生冲突。在 VPC 映像设置中，我将网络类型设置为 Microsoft Loopback Adapter，并将 IP 地址设置为 192.168.3.2。

我无法从来宾操作系统 ping 我的主机，反之亦然。我已经浏览了有关此主题的几个不同的操作指南页面，但仍然无法确定为什么这不起作用。我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T18:17:56.190

这可能只是因为默认情况下 Windows XP 防火墙会阻止 ping 请求。

要启用 ping，请执行以下操作：

1.  在*控制面板*中打开*Windows 防火墙*
**   在*常规*选项卡上检查 Windows 防火墙是否打开。如果它关闭，您可能正在使用另一个防火墙，并且需要对其进行配置。*   在*Advanced选项卡上，单击**ICMP*下的 Settings 按钮。*   *勾选允许传入回显请求*旁边的框。*   在 ICMP 对话框上单击*确定。**   在“Windows 防火墙”对话框中单击“*确定”。**

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T18:08:03.527

所以你的主机环回设置为192.168.3.1（子网255.255.255.0，网关192.168.3.1），你的VM的网络适配器设置为192.168.3.2（子网255.255.255.0，网关192.168.3.1）？他们应该能够看到对方，这个设置没有什么其他的了。

我会动摇：

*   安装虚拟机添加，也许来宾操作系统附带的网络驱动程序没有削减它。
*   尝试不同的子网，可能是 192.168.22.1。
*   暂时禁用主机的其他网络适配器，可能数据包正在路由到其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T09:55:02.430

只需确保防火墙已关闭 无法 ping Microsoft 环回适配器的唯一原因是某些防病毒软件已过时，因此请对其进行更新，否则只需将其从添加/删除程序中删除，然后转到控制面板并选择防火墙，只需确保防火墙应该处于关闭状态，然后我们才能从虚拟 PC ping 到托管 Microsoft 环回适配器.....只需检查一下

# apache-flex - 直接访问组件中的函数

> ID：197793
> 
> 赞同：1
> 
> 时间：2008-10-13T14:35:01.913
> 
> 标签：apache-flex

我正在构建我的第一个 flex 应用程序，目前正忙于将其拆分为多个组件以使其可维护。我有一个屏幕，其中包含一个在成功登录尝试后显示和填充的列表：

主应用程序的一部分：

```
<mx:ViewStack id="vsAdmin" height="100%" width="100%">
   <mx:TabNavigator id="adminTabs" width="100%" height="100%" historyManagementEnabled="false">
      <myComp:compBeheerdersAdmin id="beheerdersViewstackA"/>
   </mx:TabNavigator>
</mx:ViewStack> 
```

在组件 compBeheerdersAdmin 中有一个函数 requestBeheerdersList() 从服务器获取数据并通过处理程序将其绑定到列表。

从主应用程序登录以下代码后：

```
mainViewstack.selectedChild = vsAdmin;
//beheerdersViewstackA.createComponentsFromDescriptors();
beheerdersViewstackA.requestBeheerdersList(); 
```

当我在重新加载 swf 后登录时，函数 requestBeheerdersList() 什么都不做（未达到，我在函数中的第一条语句中放置了一条警报，但未显示），但是当我注销并再次登录时，函数达到并显示警报，列表中填充了来自服务器的数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T15:41:46.617

在调用下一个函数之前，我会确保您正在调用的组件存在。这可以通过强制 creationPolicy=all 来完成。您还可以为 CreationComplete 添加一个事件侦听器来调用您想要的函数：

```
private function doThisFirst():void{
        mainViewstack.selectedChild = vsAdmin;
        vsAdmin.addEventListener(FlexEvent.CREATION_COMPLETE,doThis);
}

private function doThis():void{
        beheerdersViewstackA.requestBeheerdersList();
} 
```

这可能不完全正确，但我试图重新创建您的具体示例。如果您熟悉其子视图和事件监听器的视图堆栈创建，您应该能够满足您的特定需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T11:31:52.590

或者，您可以在 mxml 中定义 creationComplete

```
<mx:Canvas ... creationComplete="onCreationComplete()">

<mx:Script>
  <![CDATA[
    private function onCreationComplete():void {
      requestBeheerdersList()
    }
 ]]>
</mx:Script> 
```

或者可能

```
<mx:Canvas ... creationComplete="requestBeheerdersList()"> 
```

Flex 的难点在于理解mxml 组件如何映射等价的纯actionscript 类。当您在 mxml 代码中有类似 <local:Mycomponent id="myComponent"> 的内容时，这会将类的实例添加为子类。mxml 文件 Mycomponent.mxml 定义类。除非声明为静态，否则 <mx:Script> 标记中列出的函数是应用于实例的函数。没有可以显式定义的构造函数，但实例在实际创建之前不可用。因此，您必须依靠 creationComplete 来执行您将从严格的 AS3 类中的构造函数调用的任何函数。

# c# - 从 MS Access 数据库中提取源代码

> ID：197802
> 
> 赞同：3
> 
> 时间：2008-10-13T14:38:16.713
> 
> 标签：c#, ms-access, version-control, pia

我有一个 Access DB，我想从中提取源代码，以便将其放入源代码控制中。

我尝试使用主互操作程序集（PIA）提取数据，但我遇到了问题，因为它没有提取所有模块和表单。

代码中有 140 个表单和模块（别问，这是我继承的遗留系统），但 PIA 代码只提取了其中的 91 个。

这是我正在使用的代码。

```
using System;
using Microsoft.Office.Interop.Access;

namespace GetAccesSourceFiles
{
    class Program
    {
        static void Main(string[] args)
        {
            ApplicationClass appClass = new ApplicationClass();
            try
            {
                appClass.OpenCurrentDatabase("C:\\svn\\projects\\db.mdb",false,"");

                Console.WriteLine(appClass.Version);
                Console.WriteLine(appClass.Modules.Count.ToString());
                Console.WriteLine(appClass.Modules.Parent.ToString());

                int NumOfLines = 0;
                for (int i = 0; i < appClass.Modules.Count; i++)
                {
                    Console.WriteLine(appClass.Modules[i].Name + " : " + appClass.Modules[i].CountOfLines);
                    NumOfLines += appClass.Modules[i].CountOfLines;
                }

                Console.WriteLine("Number of Lines : " + NumOfLines);
                Console.ReadKey();
            }
            catch(Exception ex)
            {
                Console.WriteLine(ex.Message + "\r\n" +ex.StackTrace);
            }
            finally
            {
                appClass.CloseCurrentDatabase();
                appClass.Quit(AcQuitOption.acQuitSaveNone);
            }

        }
    }
} 
```

关于该代码可能缺少什么的任何建议？还是在可以为我做这件事的产品/工具上？

编辑：我还应该提到这需要将脚本写入磁盘，与 VSS 集成不是一个选项，因为我们的源系统是 SVN。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T09:01:51.910

您可以使用未记录的**Application.SaveAsText**和**Application.LoadFromText**函数。SaveAsText 适用于模块、表单和报告；当您将表单或报告另存为文本时，其模块代码将出现在生成的文本文件的底部。

您可以编写一个例程，将 Access MDB（或 ADP）中的所有非数据对象保存为文本，将其放入模块中，然后将该模块保留在 Access DB 的开发版本中。然后您可以运行例程并检查 VSS 中的转储代码。

它可能不如 Mitch Wheat 描述的 Visual SourceSafe 方法那么优雅，但这取决于您想对源代码做什么。我倾向于使用 MDB 的多个版本，并使用这种方法使用差异工具（例如 WinMerge）比较它们之间的源代码。它有利于在开发分支之间移植功能。

它还可以很好地定位对字段或控件的所有引用，无论它们在哪里。将 Access 对象视为文本定义使得查找这些引用变得非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:44:13.597

有个更好的方法。您可以使用 Visual Sourcesafe（可能还有其他 SCC）来对代码和对象进行版本控制：请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms181088(VS.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T14:57:42.290

这可能会有所帮助：

```
 Sub AllCodeToDesktop()
       'The reference for the FileSystemObject Object is Windows Script Host Object Model
       'but it not necessary to add the reference for this procedure.

       Dim fs As Object
       Dim f As Object
       Dim strMod As String
       Dim mdl As Object
       Dim i As Integer

       Set fs = CreateObject("Scripting.FileSystemObject")

       'Set up the file.
       Set f = fs.CreateTextFile(SpFolder("Desktop") & "\" _
         & Replace(CurrentProject.Name, ".", "") & ".txt")

       'For each component in the project ...
       For Each mdl In VBE.ActiveVBProject.VBComponents
           'using the count of lines ...
           i = VBE.ActiveVBProject.VBComponents(mdl.Name).CodeModule.CountOfLines
           'put the code in a string ...
           If VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.CountOfLines > 0 Then
              strMod = VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.Lines(1, i)
           End If
           'and then write it to a file, first marking the start with
           'some equal signs and the component name.
           f.writeline String(15, "=") & vbCrLf & mdl.Name _
               & vbCrLf & String(15, "=") & vbCrLf & strMod
       Next

       'Close eveything
       f.Close
       Set fs = Nothing
   End Sub

   Function SpFolder(SpName As String)
   'Special folders
       SpFolder = CreateObject("WScript.Shell").SpecialFolders(SpName)
   End Function 
```

来自：[http ://wiki.lessthandot.com/index.php/Code_and_Code_Windows](http://wiki.lessthandot.com/index.php/Code_and_Code_Windows)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T05:30:44.020

您可能还想看看他的问答：

[在 MS Access 上与多个程序员合作](https://stackoverflow.com/questions/247292/working-with-multiple-programmers-on-ms-access)

# .net - .NET 代码安全审查工具

> ID：197819
> 
> 赞同：7
> 
> 时间：2008-10-13T14:43:02.973
> 
> 标签：.net

我正在寻找一个可用于 .NET 程序集的实用程序，以根据最佳实践验证代码，最重要的是可以检查代码是否存在安全性、注入和跨站点脚本漏洞。我知道这不是一门精确的科学，但我正在寻找任何人的经验/建议，以找到至少会设定基线标准的解决方案的最佳方式。我知道没有什么比做个人评论更好的了，但我正在寻找高水平。

我一直在对[Fortify](http://www.fortify.com/products/detect/in_development.jsp)进行一些研究，到目前为止，它看起来像是一个很好的工具，据我所知，它提供了非常详细的响应。我知道 FXCop 也在那里，但我不知道它是否深入。

**编辑** 我发现关于 Fortify 的一件很有吸引力的事情是安全审查和 .NET 最佳实践审查的结合，这在工具中会很不错。IE fortify 检查潜在的未关闭连接，建议使用 Using 语句等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T14:54:01.733

[FxCop](http://msdn.microsoft.com/en-us/library/bb429476(VS.80).aspx)是一个静态代码分析工具，虽然不是专门针对安全性的，但它会发现很多常见错误（请务必关闭您不感兴趣的命名规则）。

[另外，我在这里](http://blogs.msdn.com/alikl/archive/2008/01/21/performance-code-review-tool-practices-checker.aspx)遇到了“性能代码审查工具 - 实践检查器” 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T14:50:11.603

我们有用于开发方面的 Ounce 许可证[，](http://www.ouncelabs.com/)我听说过 SpiDynamics 在开发后测试应用程序方面的好消息。

# javascript - Internet Explorer 挂起问题

> ID：197821
> 
> 赞同：3
> 
> 时间：2008-10-13T14:43:41.520
> 
> 标签：javascript, internet-explorer

我目前遇到一些继承的客户端 javascript 的中间问题。每隔一段时间，用户会体验到浏览器挂起，光标变成一个鸡蛋计时器，然后浏览器无法响应。

我很难确定问题出在哪里。除了一次禁用大块 javascript 之外，是否有任何方法可以检测 Internet Explorer 中的挂起，然后检查堆栈跟踪以确定为定位问题而调用的最后几个函数？

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T14:47:48.597

**更新**：您可以使用[Web Development Helper](http://projects.nikhilk.net/WebDevHelper/)或[IE Dev Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)来跟踪您的 Javascript 调用。[Fiddler](http://www.fiddler2.com/fiddler2/)也是一个强大的 Web 调试代理。

如果您想消除 IE 部分的问题，请先禁用 Internet Explorer 中加载的所有不必要的插件。我在使用 Skype 插件时遇到了一个大问题。

如果要进行低级监控，则必须使用 Process Explorer 和 Process Monitor 等工具。它们具有显示堆栈跟踪、从 IE 访问文件和注册表的跟踪等功能。

对于 javascript 分析，您可以使用[firebug 之](http://www.ddj.com/architect/196802787)类的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T14:56:21.823

该应用程序仅支持 IE，与 Firefox 不兼容，因为公司基础架构不支持 Firefox。此外，这也发生在没有安装插件或工具栏的精简虚拟机上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T14:56:58.203

您真的不知道哪个特定脚本可能导致问题吗？IE8 beta 2 有一些很好的调试/配置文件功能，我倾向于寻找可能的资源罪魁祸首（例如 google maps、ajax 调用、dom 操作表附加等）并使用调试器设置断点并以这种方式监视事物。此外，我还会使用 firebug profiler 检查哪些方法被调用最多并花费最多时间，您可能会在这些结果中获得答案，或者至少为您提供一个起点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:22:14.347

我可以多次重复相同的步骤并且没有错误，但似乎随机我会遇到浏览器挂起。我想我要的是一个很好的策略来跟踪错误并在我无法轻松复制它时消除它。我希望有一种方法可以捕获全球即挂起。

# .net - 当您收到“无法识别的配置部分运行时”配置异常时出现什么问题

> ID：197834
> 
> 赞同：2
> 
> 时间：2008-10-13T14:49:18.733
> 
> 标签：.net, exception, configuration

特别是来自这个 web.config：

```
<configuration>
  <configSections>
    <section name="RStrace" type="Microsoft.ReportingServices.Diagnostics.RSTraceSectionHandler,Microsoft.ReportingServices.Diagnostics" />
  </configSections>
  <system.diagnostics>
    <switches>
      <add name="DefaultTraceSwitch" value="3" />
    </switches>
  </system.diagnostics>
  <RStrace>
    <add name="FileName" value="ReportServerService_" />
    <add name="FileSizeLimitMb" value="32" />
    <add name="KeepFilesForDays" value="14" />
    <add name="Prefix" value="appdomain, tid, time" />
    <add name="TraceListeners" value="file" />
    <add name="TraceFileMode" value="unique" />
    <add name="Components" value="all:3" />
  </RStrace>
  <runtime>
    <alwaysFlowImpersonationPolicy enabled="true"/>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.ReportingServices.Interfaces"
              publicKeyToken="89845dcd8080cc91"
              culture="neutral" />
        <bindingRedirect oldVersion="8.0.242.0"
             newVersion="10.0.0.0"/>
        <bindingRedirect oldVersion="9.0.242.0"
             newVersion="10.0.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
    <gcServer enabled="true" />
  </runtime>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-05-22T07:26:16.700

就我而言，我发现该`machine.config`文件丢失了。它应该位于`C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config`我的机器上。`machine.config.defaults`在同一目录中存在一个。我在同一目录中复制了该文件并将其重命名为`machine.config`. 之后为我正常加载应用程序。

`machine.config`我通过使用[.NET Framework Setup Verification Tool](https://blogs.msdn.microsoft.com/astebner/2008/10/13/net-framework-setup-verification-tool-users-guide/)发现了该文件的缺失。为 .NET 框架 4.7.1 运行它后，会`%temp%`显示一个日志文件，其名称以`setupverifier_errors`. 它包含丢失的文件列表，并且`machine.config`位于列表顶部。如果还原`machine.config`没有为您修复它，那么检查日志文件中列出的其他文件可能是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T15:06:35.530

当您缺少 configSections 区域中的条目时，您会收到此错误。在上面的示例中，您可能需要添加与此类似的一行：

```
<section name="runtime" type="your-datatype"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T10:02:52.233

看起来 .NET 是使用公司重新打包技术安装的，但并非所有部分都在那里。我们从原始 Microsoft 映像安装，一切都很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:07:23.253

意思是它在您的文件中找到 <runtime> 标记，但不知道如何处理它。它可能在错误的部分。

由于 <runtime> 是标准的 web.config 元素，因此发生了一些棘手的事情。尝试删除 RTrace 部分。如果可行，请在运行时部分之后恢复 Rtrace 部分。

# .net - 如何摆脱安全异常？

> ID：197835
> 
> 赞同：0
> 
> 时间：2008-10-13T14:49:33.367
> 
> 标签：.net, security, exception, full-trust

我在本地工作站上启动了一个 .Net 服务器端程序，但很快它就会引发安全异常。我在网上搜索答案，但没有找到/工作的快速修复。我只想运行我的程序。如何摆脱异常？我完全相信这个程序，因为它是我的。

编辑：哦，是的，为了清楚文件夹结构，我确实从映射到我自己的本地驱动器的映射文件夹运行程序。感谢您的回答，我明天尝试直接从我的驱动器运行它。

编辑：当我直接使用我的驱动器时，它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T14:54:14.480

[.NET 3.5 SP1 更好地支持在本地 Intranet 上运行应用程序。](http://blogs.msdn.com/shawnfa/archive/2008/05/12/fulltrust-on-the-localintranet.aspx)

如果您无法以 3.5 SP1 为目标，则可以将运行应用程序的共享映射到本地驱动器，并[使用 CasPol 将该映射驱动器设置为完全受信任的位置。](http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T15:16:52.267

作为临时措施，您可以键入...

```
caspol -s off 
```

...并且所有 .NET 代码访问安全性都被暂停（直到您点击 < enter >）。

# c++ - 以编程方式确定 C++ 数组的大小？

> ID：197839
> 
> 赞同：62
> 
> 时间：2008-10-13T14:50:36.593
> 
> 标签：c++, arrays, pointers, memory-management

这个问题的灵感来自一个类似的问题：[delete[] 如何“知道”操作数数组的大小？](https://stackoverflow.com/questions/197675/how-does-delete-know-the-size-of-the-operand-array)

我的问题有点不同： **有没有办法以编程方式确定 C++ 数组的大小？如果不是，为什么？** 我见过的每个接受数组的函数也需要一个整数参数来给它大小。但是正如链接的问题所指出的那样，`delete[]`必须知道要释放的内存的大小。

考虑这个 C++ 代码：

```
int* arr = new int[256];
printf("Size of arr: %d\n", sizeof(arr)); 
```

这将打印“ `Size of arr: 4`”，这只是指针的大小。有一些打印 256 的函数会很好，但我认为 C++ 中不存在这样的函数。（同样，问题的一部分是为什么它不存在。）

**澄清**：我知道如果我在堆栈而不是堆上声明数组（即“ `int arr[256];`”），则`sizeof`运算符将返回 1024（数组长度 * sizeof(int)）。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-13T15:03:26.007

`delete []`确实知道分配的大小。但是，该知识存在于运行时或操作系统的内存管理器中，这意味着编译器在编译期间无法使用它。并且`sizeof()`不是一个真正的函数，它实际上由编译器评估为一个常量，这对于动态分配的数组是无法做到的，其大小在编译期间是未知的。

另外，考虑这个例子：

```
 int *arr = new int[256];
int *p = &arr[100];
printf("Size: %d\n", sizeof(p)); 
```

编译器如何知道大小`p`是多少？问题的根源在于 C 和 C++ 中的数组不是一流的对象。它们衰减为指针，编译器或程序本身无法知道指针是指向由 分配的内存块的开头`new`，还是指向单个对象，还是指向块中间的某个位置分配的内存`new`。

原因之一是 C 和 C++ 将内存管理留给程序员和操作系统，这也是它们没有垃圾收集的原因。实现`new`并且`delete`不是 C++ 标准的一部分，因为 C++ 旨在用于各种平台，这些平台可能以非常不同的方式管理它们的内存。如果您正在为在最新 Intel CPU 上运行的 windows 机器编写文字处理器，则可能让 C++ 跟踪所有分配的数组及其大小，但是当您编写运行在一个数字信号处理器。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-13T16:07:26.983

好吧，实际上有一种方法可以确定大小，但它不是“安全的”，并且会因编译器而异......**所以根本不应该使用它**。

当你这样做时： int* arr = new int[256];

256 无关紧要，假设这种情况为 1024，您将获得 256*sizeof(int)，该值可能存储在 (arr - 4)

所以给你“项目”的数量

int* p_iToSize = arr - 4;

printf("项目数 %d", *p_iToSize / sizeof(int));

对于每个 malloc，new，无论在您收到的连续内存块之前的任何内容，都会分配一个保留空间，其中包含有关您获得的内存块的一些信息。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-13T14:58:18.280

不，在标准 C++ 中没有办法做到这一点。

我不知道没有什么很好的理由。可能，大小被认为是实现细节，最好不要暴露。请注意，当您说 malloc(1000) 时，不能保证返回的块是 1000 字节 --- 只有它*至少*是1000 字节。很可能大约是 1020（1K 减去 4 字节的开销）。在这种情况下，“1020”大小是运行时库要记住的重要大小。当然，这会在实现之间发生变化。

这就是标准委员会添加 std:vector<> 的原因，它确实跟踪它的确切大小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T14:56:13.570

处理此问题的常用方法是使用向量

```
int main()
{
   std::vector<int> v(256);
   printf("size of v is %i capacity is %i\n", sizeof(int) * v.size(), sizeof(int) * v.capacity());
} 
```

或预定义尺寸

```
const int arrSize = 256;
int main()
{
    int array[arrSize];
    printf("Size of array is %i", sizeof(int) * arrSize);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T15:37:13.583

C++ 决定添加 new 来做一个类型安全的 malloc，而不是 new 必须知道两个大小为 e 的元素来调用 ctors，所以 delete 来调用 dtors。在早期，您必须通过实际传递来删除您传递给新对象的数字。

```
string* p = new string[5];
delete[5] p; 
```

但是他们认为如果使用 new<type>[] 数字的开销很小。所以他们决定 new[n] 必须记住 n 并将其传递给删除。实现它的方式主要有三种。

1.  保持一个指向大小的哈希表
2.  直接写在向量附近
3.  做一些完全不同的事情

也许有可能获得这样的大小：

```
size_t* p = new size_t[10];
cout << p[-1] << endl;
// Or
cout << p[11] << endl; 
```

或者地狱没有这些。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-15T15:15:22.797

根据您的应用程序，您可以在数组末尾创建一个“哨兵值”。

哨兵值必须具有一些独特的属性。

然后，您可以处理数组（或进行线性搜索）以查找标记值，并在进行时计数。一旦达到哨兵值，您就有了数组计数。

对于简单的 C 字符串，终止符 \0 是标记值的示例。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-09T22:29:27.630

一些魔法：

```
template <typename T, size_t S>
inline
size_t array_size(const T (&v)[S]) 
{ 
    return S; 
} 
```

这就是我们在 C++11 中的做法：

```
template<typename T, size_t S>
constexpr 
auto array_size(const T (&)[S]) -> size_t
{ 
    return S; 
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-13T14:56:22.527

那是因为您的变量 arr 只是一个指针。它保存着内存中特定位置的地址，但对它一无所知。您将其声明为 int*，这为编译器提供了一些指示，说明当您增加指针时要执行的操作。除此之外，您可能指向数组的开头或结尾，或者指向堆栈或无效内存。但我同意你的看法，不能调用 sizeof 很烦人:)

量子皮特

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-13T15:06:36.903

在 C++ 中没有可移植的方法来确定仅给定指针的动态分配数组的大小。C++ 变得非常灵活并赋予用户权力。例如，该标准没有定义内存分配器必须如何工作，例如通过添加所需的大小标头。不需要标头可以提供更大的灵活性。

作为一个例子，考虑一个实现为 char * 数组的字符串。通常使用指向数组中间的指针来挑选子字符串。例如，请参阅标准 C 库中的 strtok 函数。如果需要在每个数组之前嵌入一些标头，则需要在子字符串之前删除数组的某些部分。

处理标头的另一种方法是将数组标头放在一个内存块中，并让它们指向其他地方的原始数组内存。在许多情况下，这将需要对每个引用进行两次指针查找，这将对性能造成很大的拖累。有一些方法可以克服这些缺陷，但它们增加了复杂性并降低了实施的灵活性。

std::vector 模板是我最喜欢的保持数组大小绑定到数组本身的方法。

C 是具有更好语法的可移植汇编语言。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-12-07T02:12:35.173

现在有[std::array](http://en.cppreference.com/w/cpp/container/array)，一个围绕常量大小数组的高效编译时包装器：

```
#include <array>

int main (int argc, char** argv)
{
    std::array<int, 256> arr;
    printf("Size of arr: %ld\n", arr.size());
} 
```

参数是`<type, #elements>`。

您还可以获得其他一些细节，例如迭代器、empty() 和 max_size()。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-13T14:57:23.507

不，没有任何方法可以做到这一点，您必须跟踪它在外部有多大。像这样的课程`std::vector`为你做这件事。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-13T15:03:48.097

你不能，从根本上说：

```
void foo(int* arr);

int arr[100] = {0};

foo(arr+1); // Calls foo with a pointer to 100-1 elements. 
```

C++ 数组只不过是存储在连续内存区域中的对象的集合。由于它们之间没有空洞（填充*在*对象内部），因此您可以通过简单地递增指针来找到数组的下一个元素。在 CPU 级别，这是一个简单的调整。C++ 只插入一个 sizeof(element) 乘数。

请注意，实现可以选择实现包含数组边界的“胖指针”。它们需要两倍大，因为您需要链接到某种“数组绑定描述符”。作为副作用，在这样的实现中，您可以调用`delete [] (1+new int[5]);`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-13T15:06:25.313

不幸的是，这是不可能的。在 C 和 C++ 中，程序员有责任记住数组的长度，因为数组长度不会存储在任何地方。Delete[] 和 free() 确实记住了已分配块的大小，但它们分配的内存可能比请求的多，因此它们存储已分配内存块大小的内部数据结构可能无法为您提供数组的确切大小。

请注意，C++ STL 向量（基本上是包含在具有一些辅助函数的类中的数组）确实存储了数组的长度，因此如果您真的需要此功能，您可以只使用向量。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-13T15:08:00.363

一般来说，没有。C 和 C++ 中的数组只是没有附加簿记信息的内存块。如果不将数组的长度存储在内存中，并为此增加开销，在一般情况下是不可能的。

静态分配的数组有一个例外。例如，如果您声明：`int a[50]`then`sizeof(a)`将起作用。这是可能的，因为 [50] 是数组的静态类型的一部分：编译器知道它。sizeof 在编译时被解释。

但是，如果您创建一个指针：`int *p = a`，那么`sizeof(p)`将返回您提到的指针的大小，而不是数组的大小，因为编译器不知道 p 指向什么。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-15T20:40:56.650

> 有没有办法以编程方式确定 C++ 数组的大小？如果不是，为什么？

1.  不，除非您自己跟踪它。
2.  因为如果编译器不必将这些信息告诉除自己之外的任何人，它对编译器的约束就会更少。这是否可取还有待商榷。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-15T20:42:53.307

@迪玛，

> 编译器如何知道 p 的大小是多少？

编译器必须知道 p 的大小；否则无法实现`delete[]`。编译器不需要告诉其他人它是如何计算出来的。

为了验证这一点的有趣方式，将返回的`operator new[]`指针与返回的指针进行比较`new[]`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-07T11:16:05.707

编译器无法知道

```
char *ar = new char[100] 
```

是一个 100 个字符的数组，因为它不会在内存中创建一个实际的数组，它只是在内存中创建一个指向 100 个未初始化字节的指针。

如果您想知道给定数组的大小，只需使用 std::vector。std::vector 只是一个更好的数组。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-19T20:32:01.363

当您创建数组指针（使用指向指针的模板创建包装器）时，您不能，但是当您创建对象数组时，您可以像这样获得数组的大小：

```
char* chars=new char[100];
printf("%d",*((int*)chars-1)); 
```

该`delete[]`函数需要解构其中的所有对象。为此，`new[]`关键字将元素的数量放在所有数组的后面。

数组的主体是这样的：

```
int count;
ObjectType* data; //This value is returned when using new[] 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-01-12T02:58:27.277

我这样做的方法是将数组的大小除以第一个元素的大小

```
int intarray[100];
printf ("Size of the array %d\n", (sizeof(intarray) / sizeof(intarray[0])); 
```

它打印 100

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-10-26T15:13:20.257

您可以只创建一个额外的数组元素，然后应用将存储在数组中的最不可能的数字。然后，您可以通过传递该数字通过某个函数确定元素的数量。

在创建时声明和初始化数组的情况下，您可以对其进行扫描，然后生成一个与数组的任何元素都不匹配的数字。但是，如果您随后修改其中一个元素，您将不知道该元素是否存储与最后一个元素相同的值，因此您必须生成一个新数字来存储在最后一个元素中。通过所有这些，您不妨将创建时的元素总数存储在变量中。如果您仅在函数中使用数组，则可能会出现这种情况。

# actionscript - 范围问题 - 使用动作脚本控制按钮内的影片剪辑

> ID：197845
> 
> 赞同：2
> 
> 时间：2008-10-13T14:52:10.740
> 
> 标签：actionscript, scope, actionscript-2

我正在尝试使用 actionscript 2 显示/隐藏按钮符号图层上的影片剪辑（或图形）符号。这是我尝试过的

在按钮的操作中：

```
on (release) {
 this.button_name.movieclip_name._alpha = 0;
 trace(this.button_name.movieclip_name);
} 
```

并且跟踪返回***undefined*** ...所以我认为我在理解如何处理子元素时遇到了问题。但是我不是闪存程序员......目前只是为了一个侧面项目而破解它，所以我可能只是不明白它是如何工作的。

谢谢，吉姆：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T03:58:53.757

对于 AS2，将 MovieClips 放在按钮中并不是一个好主意。最简单和最直接的方法是重组事物，使您的按钮和其中的影片剪辑处于同一级别，也许在为包含它们而创建的新 MC 中。您应该将 Button 符号视为仅提供可点击点击状态的事物，而不是其他事物的容器。

至于您的后续行动，是的，您确实可以将 MovieClips 用作按钮。如果你给你的 MC 函数来处理类似按钮的事件（onPress、onRelease、onReleaseOutside 等等），这些函数将像在按钮上一样被调用。您还可以控制更精细的细节 - 请参阅 MovieClip.hitArea 和 MovieClip.useHandCursor 上的文档。

我经常做的一件事是在 MC 中创建名为“show”和“hide”的帧，然后是短动画和“stop()”命令，然后执行以下操作：

```
myMC.onRollOver = function() { gotoAndPlay("show"); }
myMC.onRollOut = myMC.onReleaseOutside = function() { gotoAndPlay("hide"); }
myMC.onRelease = function() {
    // do something....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T15:45:15.733

发现：[这个](http://www.actionscript.org/forums/archive/index.php3/t-99018.html)...

他们谈论一些“其他方式”（除了使用按钮符号之外？）也许您可以使用电影剪辑符号作为按钮？

# svn - 子剪辑替代

> ID：197853
> 
> 赞同：3
> 
> 时间：2008-10-13T14:55:18.800
> 
> 标签：svn, tortoisesvn, eclipse-plugin, subclipse

> **可能重复：**
> [Eclipse 的 SVN 插件 - Subclipse vs. Subversive](https://stackoverflow.com/questions/61320/svn-plugins-for-eclipse-subclipse-vs-subversive)

我使用 Subclipse（Eclipse 的 SVN 插件）已经有一段时间了，但对它越来越不满意。我注意到 Tortoise SVN 可以作为 Eclipse 插件使用，并且正在考虑在 Eclipse 中使用它（我在 Eclipse 之外访问 SVN 时已经使用它）。

在我进行切换之前，是否有人有使用 Tortoise SVN Eclipse 插件的经验，或者是否有任何其他推荐的 Eclipse SVN 插件（Subclipse 除外）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T15:00:31.863

[**Eclipse 的 SVN 插件 - Subclipse vs. Subversive**](https://stackoverflow.com/questions/61320/svn-plugins-for-eclipse-subclipse-vs-subversive#61328)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T15:00:26.260

您是否尝试过 Eclipse 的 Subversive 插件？ [http://www.eclipse.org/subversive/](http://www.eclipse.org/subversive/)

也许你可以解释一下为什么你对 Subclipse 不满意，看看其他工具能不能满足你……

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T15:02:30.110

我对 Totoise SVN 插件没有任何经验，因为我所有的机器都运行 Linux，而上次我检查 tortoise SVN 插件只是 Windows。

然而，另一个好的 SVN 插件是 Subversive： http: [//www.eclipse.org/subversive/downloads.php](http://www.eclipse.org/subversive/downloads.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:03:00.717

我使用tortiseSVN，除了积极的体验之外什么都没有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-29T15:01:43.473

如果您使用 tortoiseSVN 并考虑使用 Eclipse 插件，请坚持使用 Subclipse。

只要您使用不同的工具（包括命令行）访问 SVN 服务器一次，Subversive 就会简单地销毁其缓存。

# wpf - 在 WPF 中，有没有人为 Grid 设置动画？

> ID：197855
> 
> 赞同：21
> 
> 时间：2008-10-13T14:55:42.013
> 
> 标签：wpf, animation, grid

我在网格中有 2 列。当我单击一个按钮时，我希望第一列从它的当前位置向左移动到 0。因此，实际上，它折叠了，我只剩下查看一个列。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-13T15:13:27.857

应该不会太难。您需要创建一个 EventTrigger，它有一个 BeginStoryboard 以网格为目标，并使用 DoubleAnimation 来缩小列宽。 [此处的示例具有类似的设置。](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.doubleanimation.aspx) EventTrigger 将在按钮上运行，而 DoubleAnimation 的[StoryBoard.Target](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard.target.aspx)将指向您希望缩小的 ColumnDefinition。

好的，所以效果不太好。不能直接收缩列，但是可以设置收缩列填充(width="*")，设置Grid和非收缩列的宽度，然后收缩整个网格。这确实有效。以下示例有效：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      WindowTitle="Opacity Animation Example" 
      Background="White">
   <StackPanel Margin="20">
      <Grid Name="MyGrid" Width="200" HorizontalAlignment="Left">
         <Grid.RowDefinitions>
            <RowDefinition Height="100"/>
         </Grid.RowDefinitions>
         <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="100"/>
         </Grid.ColumnDefinitions>
         <Rectangle HorizontalAlignment="Stretch"  
                    VerticalAlignment="Stretch" 
                    Grid.Column="0" Fill="Red"/>
         <Rectangle HorizontalAlignment="Stretch"  
                    VerticalAlignment="Stretch" 
                    Grid.Column="1" Fill="Blue"/>
      </Grid>

      <Button Name="hideButton">
         <Button.Triggers>
            <EventTrigger RoutedEvent="Button.Click">
               <BeginStoryboard>
                  <Storyboard>
                     <DoubleAnimation 
                         Storyboard.TargetName="MyGrid"
                         Storyboard.TargetProperty="(Grid.Width)" 
                         From="200" To="100" 
                         Duration="0:0:2" 
                         AutoReverse="True"  /> 
                  </Storyboard>
               </BeginStoryboard>
            </EventTrigger>
         </Button.Triggers>
      </Button>
   </StackPanel>
</Page> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-27T20:36:12.710

您需要创建一个 GridLengthAnimation 类（代码来自：[http](http://windowsclient.net/learn/video.aspx?v=70654) ://windowsclient.net/learn/video.aspx?v=70654 ）

```
public class GridLengthAnimation : AnimationTimeline
{
    public GridLengthAnimation()
    {
        // no-op
    }

    public GridLength From
    {
        get { return (GridLength)GetValue(FromProperty); }
        set { SetValue(FromProperty, value); }
    }

    public static readonly DependencyProperty FromProperty =
      DependencyProperty.Register("From", typeof(GridLength), typeof(GridLengthAnimation));

    public GridLength To
    {
        get { return (GridLength)GetValue(ToProperty); }
        set { SetValue(ToProperty, value); }
    }

    public static readonly DependencyProperty ToProperty =
        DependencyProperty.Register("To", typeof(GridLength), typeof(GridLengthAnimation));

    public override Type TargetPropertyType
    {
        get { return typeof(GridLength); }
    }

    protected override Freezable CreateInstanceCore()
    {
        return new GridLengthAnimation();
    }

    public override object GetCurrentValue(object defaultOriginValue, object defaultDestinationValue, AnimationClock animationClock)
    {
        double fromValue = this.From.Value;
        double toValue = this.To.Value;

        if (fromValue > toValue)
        {
            return new GridLength((1 - animationClock.CurrentProgress.Value) * (fromValue - toValue) + toValue, this.To.IsStar ? GridUnitType.Star : GridUnitType.Pixel);
        }
        else
        {
            return new GridLength((animationClock.CurrentProgress.Value) * (toValue - fromValue) + fromValue, this.To.IsStar ? GridUnitType.Star : GridUnitType.Pixel);
        }
    }
} 
```

以及 RowDefinition/ColumnDefinition 的情节提要。

```
<Window.Resources>
    <Storyboard x:Key="ColumnAnimation">
        <Animations:GridLengthAnimation
            BeginTime="0:0:0"
            Duration="0:0:0.1"
            From="0*"
            Storyboard.TargetName="ColumnToAnimate"
            Storyboard.TargetProperty="Width"
            To="10*" />
    </Storyboard>

</Window.Resources>

<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="10*" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition x:Name="ColumnToAnimate" Width="0*" />
    </Grid.ColumnDefinitions>
</Grid> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T13:56:25.327

查看来自 Todd Miranda 的[此](http://windowsclient.net/learn/video.aspx?v=70654)视频培训链接，该链接向您展示如何为网格控件的高度设置动画。我认为您可以轻松地使其适用于您的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T17:00:50.247

您可以做的另一件事是为内容设置动画并将 Grid 设置为自动调整内容，当内容更改大小时它会顺利完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T18:27:39.090

您也可以使用 GridLength 动画来实现这一点，请参阅此处的示例[http://marlongrech.wordpress.com/2007/08/20/gridlength-animation/](http://marlongrech.wordpress.com/2007/08/20/gridlength-animation/) 使用这种方法，您可以操作任何给定的 Grid.Column 或 Grid.Row 大小。

对于您的特殊需要，只需将第一列与 Width="Auto" 放在一起，将第二列与 * 放在一起，为第一列内的内容设置动画 - 这样就可以了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-09T11:16:58.953

我采用了 Todd Miranda 的 C# 源代码并对其进行了修改，以演示如何动画 DataGrid 列宽收缩和扩展。

这是源代码...

[http://www.pocketpctoolkit.com/WPF/DataGridColumnWidthAnimation.zip](http://www.pocketpctoolkit.com/WPF/DataGridColumnWidthAnimation.zip)

基本上，您单击 CheckBox，并且将“MinWidth”值设置为 0 的 DataGrid 列将缩小到零宽度。再次单击 CheckBox，列将动画回其原始宽度。

此 WPF 代码还演示了如何在后面的代码中创建动画/故事板。

# firefox - 可以导出 FireFox 扩展和设置吗？

> ID：197858
> 
> 赞同：2
> 
> 时间：2008-10-13T14:56:18.173
> 
> 标签：firefox

希望我工作中的 FireFox 与我家中的 FireFox 同步。有没有办法简单地导出所有扩展和设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T14:59:02.083

试试[MozBackup](http://mozbackup.jasnapaka.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T14:59:38.090

只需从您的 FireFox/Profiles 文件夹中复制文件即可获取设置/保存的密码等。

其中包含设置和密码。我相信你也可以为扩展做类似的过程

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T15:00:00.443

看看[Mozilla Weave](http://labs.mozilla.com/projects/weave/)。另一种选择是[Foxmarks](http://www.foxmarks.com)，尽管我认为这仅限于书签。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T20:31:35.220

FEBE / CLEO 用于插件导出/导入

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T15:00:01.893

由于扩展程序存储在您的个人资料中，您可以将其复制到闪存驱动器或其他东西。

# ruby-on-rails - 如何最好地编写 RSpec 自定义匹配器来测试 Rails 应用程序中的访问控制

> ID：197864
> 
> 赞同：2
> 
> 时间：2008-10-13T14:57:19.090
> 
> 标签：ruby-on-rails, testing, rspec

好的，所以我没有编写一大堆访问控制规范，并将它们复制到我的许多规范文件中，而是希望创建一个自定义匹配器。所以代替这个：

```
describe "access control" do
  it "should prevent access by non-logged-in users"
  it "should prevent access by normal users"
  it "should prevent access by editor users"
  it "should prevent access by admin users"
  it "should allow access by super admin users"
end 
```

我想做这样的事情：

```
lambda do
  get :index
end.should have_access_control(:allowed => [:super_admin], :disallowed => [:admin, :editor, :user]) 
```

有什么例子或建议可以说明我如何去做这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T10:03:37.217

好的，[我找到了实现这一点的方法](http://matthall.wordpress.com/2008/10/14/a-helper-for-testing-access-control-with-rspec/)，尽管它不使用自定义匹配器。在您的 spec_helper.rb 中包含以下代码：

```
def access_control (code, options={})
  options = {:allow => [], :disallow => []}.merge(options)

  options[:allow].each do |user|
    it "#{code} should allow #{user.to_s}" do
      login_as(user)
      eval code
      response.should_not redirect_to(login_path)
    end
  end

  options[:disallow].each do |user|
    it "#{code} should disallow #{user.to_s}" do
      login_as(user)
      eval code
      response.should redirect_to(login_path)
    end
  end
end 
```

并调用如下：

```
access_control("get :index", {:allow => [:super_admin], :disallow => [:quentin, :admin]}) 
```

然后，您可以使用它来构建应受限制的方法的完整列表，以及它们被限制的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T23:27:58.600

我不同意你的解决方案。测试不应该是一个像这样排除重复的领域。它使测试更难阅读和更难维护。此外，肯定有一个论点，即[测试中的重复可以为您的设计提供信息](http://evang.eli.st/blog/2008/7/23/when-duplication-in-tests-informs-design)。

在您列出的初始示例中，有 5 种不同的上下文应单独进行测试，并且一目了然。您的解决方案虽然简洁，但会损害这两个目标。

# vb.net - 通过 Linq 从 VB 中的分组数据表中获取计数

> ID：197867
> 
> 赞同：2
> 
> 时间：2008-10-13T14:57:36.657
> 
> 标签：vb.net, linq, datatable

我在这里遇到了精神障碍，我希望我错过了一些明显的东西。

无论如何，假设我有一个如下所示的表：

```
ID 查找值排序顺序
============================================
1 个 1000
2 B 2000
3 B 2000
4 C 3000
5℃ 4000

```

我正在尝试使用 Linq 查找`LookupValue`相同但排序顺序不同的位置（这`ID`是我的数据库表上的 PK，与本练习无关）。

我认为最简单的方法是按`LookupValue`和分组`SortOrder`，然后找到`LookupValue`结果中出现两次以上的地方。

现在，我获取分组表的代码如下所示：

```
Dim KeySortPairs = From d In MyDataTable _
            Group By Key = d(LookupValue).ToString(), SortOrder = d(SortOrder).ToString() _
            Into Group _
            Select Key, SortOrder 
```

查看调试输出，上面的代码产生了这个结果（这是正确的）：

```
键排序顺序
=================
一个1000
B 2000
C 3000
C 4000

```

为了得到重复`Key`的，我正在查看这样的结果：

```
For Each Entry In KeySortPairs.Where(Function(t) t.Key.Count() > 1)
    'Multiple Sort Orders!!'
Next 
```

但是，在此代码中，返回分组结果中的*每个条目。*我是否遗漏了什么，或者不应该只给我`Key`出现不止一次的条目？我认为由于我对VB.NET 的舒适度较低，我犯了`Count()`一个小错误，但我无法弄清楚——我尝试将`WHERE`一样的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T15:12:03.260

键是一个字符串。

Key.Count 对字符串中的字符进行计数。

* * *

更改选择以包括组

```
Select Key, SortOrder, Group 
```

并更改 where 子句以计算组

```
KeySortPairs.Where(Function(t) t.Group.Count() > 1) 
```

或者，计算该组可能是矫枉过正。“任何”可以通过进行简短的枚举来节省时间。

```
KeySortPairs.Where(Function(t) t.Group.Skip(1).Any()) 
```

（语法可能不完美，我不知道 vb.linq）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T15:12:19.357

我认为您的每个语句都需要一个 groupby 。

尝试类似的东西

```
For Each Entry in KeySortPairs.GroupBy(expression).Where( 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-02T15:49:53.403

这真是个老问题。我只是在尝试。最初用 C# 编写解决方案，并通过一些在线转换器转换为 VB.NET。希望不要冒犯任何人。

```
 Dim tests As New List(Of test)() From { _
            New test() With { _
                Key.LookUp = "A", _
                Key.SortOrder1 = 1000 _
            }, _
            New test() With { _
                Key.LookUp = "B", _
                Key.SortOrder1 = 2000 _
            }, _
            New test() With { _
                Key.LookUp = "B", _
                Key.SortOrder1 = 2000 _
            }, _
            New test() With { _
                Key.LookUp = "C", _
                Key.SortOrder1 = 3000 _
            }, _
            New test() With { _
                Key.LookUp = "C", _
                Key.SortOrder1 = 4000 _
            } _
        }

  Dim query = From g In From t In testsGroup t By t.LookUpLet firstsortorder = g.First() Where g.Count() > 1 AndAlso g.Any(Function(t1) firstsortorder.SortOrder1 <> t1.SortOrder1)New With { _
  g.Key, _
  Key .result = g _
}

    For Each item As var In query
        Console.WriteLine("key " + item.Key)
        For Each item1 As var In item.result
            Console.WriteLine(vbTab & vbTab & "sort order " + item1.SortOrder1)
        Next
    Next 
```

# windows - 如果文件不再存在，如何卸载 Windows 服务？

> ID：197876
> 
> 赞同：603
> 
> 时间：2008-10-13T14:59:03.923
> 
> 标签：windows, windows-services, installation

如果服务文件不再存在，如何卸载 .NET Windows 服务？

我使用 InstallUtil 安装了一个 .NET Windows 服务。我已经删除了文件但忘记运行

```
 InstallUtil /u 
```

第一的。因此该服务仍列在服务 MMC 中。

我必须进入注册表吗？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：1185
> 
> 时间：2008-10-13T15:14:12.770

你至少有三个选择。我已经按照使用偏好的顺序介绍了它们。

**方法 1** - 您可以使用资源工具包中包含的[SC 工具](http://support.microsoft.com/kb/251192)(Sc.exe)。（包含在 Windows 7/8 中）

打开命令提示符并输入

```
sc delete <service-name> 
```

工具帮助片段如下：

```
DESCRIPTION:
        SC is a command line program used for communicating with the
        NT Service Controller and services.

delete----------Deletes a service (from the registry). 
```

**方法 2** - 使用 delserv

[下载](http://support.microsoft.com/kb/927229)并使用 delserv 命令行实用程序。这是为 Windows 2000 开发的遗留工具。在当前的 Window XP 机器中，这已被方法 1 中描述的 sc 所取代。

**方法 3** - 手动删除注册表项**（注意这在 Windows 7/8 中适得其反）**

Windows 服务在以下注册表项下注册。

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services 
```

在referred key下搜索服务名的子key，删除。（并且您可能需要重新启动才能从服务列表中完全删除该服务）

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2008-10-13T15:00:42.767

在命令提示符下，使用 Windows“sc.exe”实用程序。您将运行如下内容：

```
sc delete <service-name> 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2013-06-20T16:16:55.933

在 Windows 8 中使用“sc delete”的注意事项：

1) 使用提升的权限打开 CMD 窗口。[Windows Key-X 调出带有选项的菜单；选择“命令提示符（管理员）”。]
2）使用服务列表中的括号名称[例如，我使用“sc delete gupdate”，而在服务中，它显示为“Google 更新（gupdate）”]

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-09-23T15:11:08.337

有人提到`sc delete`作为答案。我就是这样做的，但是我花了一段时间才找到`<service-name>`参数。

该命令`sc query type= service`（注意，它的格式非常特殊，“服务”之前的空格是必需的）将输出已安装的 Windows 服务列表，并附上它们的限定名称以与`sc delete <service-name>`命令一起使用。

该列表很长，因此您可以考虑将输出通过管道传输到文本文件（即`>> C:\test.txt`），然后通过该文件进行搜索。

这`SERVICE_NAME`是与`sc delete <service-name>`命令一起使用的。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-09-23T16:46:51.133

**通过注册表删除 Windows 服务**

如果您知道正确的路径，从注册表中删除服务非常容易。我是这样做的：

1.  运行**Regedit**或**Regedt32**

2.  转到注册表项“HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services”

3.  查找您要删除的服务并将其删除。您可以查看密钥以了解服务正在使用哪些文件并删除它们（如有必要）。

**通过命令行窗口删除 Windows 服务**

或者，您也可以使用命令提示符并使用以下命令删除服务：

**sc 删除**

您还可以使用以下命令创建服务

sc create "MorganTechService" binpath= "C:\Program Files\MorganTechSPace\myservice.exe"

注意：您可能必须重新启动系统才能在服务管理器中更新列表。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-02-21T06:13:56.220

如果你想使用一个工具，你可以使用[Process Hacker](http://processhacker.sourceforge.net/)

创建服务的表单：

![流程黑客创建服务](https://i.stack.imgur.com/nHjyr.png)

服务上的上下文菜单以将其删除：

![进程黑客删除服务](https://i.stack.imgur.com/O1IU2.png)

我发现 Process Hacker 是一个比 Windows 自己的 Taskmgr.exe 更方便管理 Windows 进程和服务的工具。特别是在 Windows XP 上，您根本无法从任务管理器访问服务。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-06-16T07:55:37.193

我需要重新安装我的 tomcat 服务，这意味着首先删除它。这对我有用：

```
Start a command prompt window using run as administrator

sc query type= service >t.txt 
```

（编辑文件t.txt，在列表中搜索找到tomcat服务。它叫Tomcat7）

```
sc delete Tomcat7 
```

但是，第一次查询命令不起作用，因为 tomcat 服务没有运行。它似乎只列出正在运行的服务。我不得不启动服务并再次运行查询命令。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-02-12T16:54:23.747

如果原来的 Service .InstallLog 和 .InstallState 文件还在文件夹中，您可以尝试重新安装可执行文件以替换文件，然后使用 InstallUtil /u，然后卸载程序。这有点令人费解，但对我来说在特定情况下有效。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-03-25T13:43:49.193

您可以尝试运行[Autoruns](https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)，这样您就不必手动编辑注册表。当您没有所需的权限时，这尤其有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-09T07:54:56.350

您可以通过命令提示符卸载您的 Windows 服务，也只需编写这条命令

```
cd\                                                                   

cd C:\Windows\Microsoft.NET\Framework\v4.0.30319(or version in which you developed your service)                                           

installutil c:\\xxx.exe(physical path of your service) -d 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-15T20:39:34.220

第一步：移动到您的服务所在的目录

命令：cd c:\xxx\yyy\service

第二步：输入以下命令

命令：C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil.exe service.exe \u

这里 service.exe 是您的服务 exe，\u 将卸载该服务。您将看到“卸载已完成”消息。

如果您想安装服务，请在上面的命令中删除 \u，这将安装您的服务

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-08T20:27:59.613

我们发现，即使您运行`sc_delete`，注册表中仍可能为您的服务保留一个条目，因此重新安装服务会导致一组损坏的注册表条目（它们不匹配）。我们所做的是`regedit`手动删除并删除此剩余条目。

[![](https://i.stack.imgur.com/IDg4u.png)](https://i.stack.imgur.com/IDg4u.png) 注意：ShipmunkService 在 sc_delete 之后仍然出现！

然后您可以重新安装，您的服务将正常运行。祝大家好运，愿原力与你们同在。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-02-27T06:42:47.210

`-Windows+r`打开cmd。

`-sc YourSeviceName`此代码删除您的服务。

`-Uninstal "YourService Path"`此代码卸载您的服务。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-01T12:35:27.947

最简单的方法是使用[Sys Internals Autoruns](https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns)

[![在此处输入图像描述](https://i.stack.imgur.com/ecdF2.png)](https://i.stack.imgur.com/ecdF2.png)

以管理员模式启动它，然后您可以通过删除键删除过时的服务

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-07T19:16:18.313

很多很棒的答案，这真的帮助了我，但是缺少一件事。提到了通过 cmd 查找服务，`sc query type= service`但问题是我正在寻找的服务没有运行，并且此命令仅显示正在运行的服务（这可能是 OP 时不存在的新功能回答）。

您必须将服务的状态传递给这样的命令，`sc query state= all`或者`sc query state= inactive` *不需要传递 type= 服务，因为这是默认的*。

并且，如上所述，将其推送到文本文件中，以便更容易搜索`sc query state= inactive > C:\servicesStopped.txt`

来源：[https ://docs.microsoft.com/en-us/windows-server/administration/windows-commands/sc-query](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/sc-query)

# workflow - Windows 工作流程

> ID：197880
> 
> 赞同：0
> 
> 时间：2008-10-13T14:59:54.593
> 
> 标签：workflow, workflow-foundation

只想从基础开始学习 .net 中的“Windows 工作流程”设计器，任何人都可以建议一个好的链接

谢谢桑迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-25T14:05:14.560

OdeToCode 有几篇由 Scott Allen 撰写的关于 WWF 的深入文章，特别是对应该使用[状态机](http://www.odetocode.com/Articles/460.aspx)来简化复杂工作流逻辑的实例进行了很好的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T13:55:27.890

C# 和 VB.NET 中的 Windows® Workflow Foundation 动手实验室 [http://www.microsoft.com/downloads/details.aspx?familyid=2e575633-e357-4ee7-aaff-34138f00e830&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=2e575633-e357-4ee7-aaff-34138f00e830&displaylang=en)

非常好的第一步指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T15:01:42.670

[这是](http://msdn.microsoft.com/en-us/library/ms735927(VS.85).aspx)一些不错的初学者级 WF 教程的链接：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:02:06.180

你读过 MSDN 部分了吗？

[http://msdn.microsoft.com/en-us/library/ms735967.aspx](http://msdn.microsoft.com/en-us/library/ms735967.aspx)

编辑：呵呵——有人在我写作的时候发布了链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T15:39:14.297

除了明显的 MSDN 链接外，您可能会发现以下有用：

*   [Screencast：您的第一个连续工作流程](http://www.pluralsight.com/community/blogs/matt/archive/2008/09/23/screeencast-your-first-sequential-workflow.aspx)和
*   [截屏视频：您的第一个状态机工作流程](http://www.pluralsight.com/community/blogs/matt/archive/2008/09/23/screencast-your-first-state-machine-workflow.aspx)，作者：Matt Millner

# java - java标准库中是否有文本换行功能？

> ID：197891
> 
> 赞同：4
> 
> 时间：2008-10-13T15:02:03.777
> 
> 标签：java

Python 标准库附带`textwrap`提供简单文本换行功能的模块。java标准库中有可比的东西吗？

在 Python 中是这样的：

```
>>> t = "a really really long string with lots of characters"
>>> import textwrap
>>> textwrap.wrap(t, 20)
['a really really long', 'string with lots of', 'characters'] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T16:17:05.310

标准 Java 库中没有，但 Apache Commons 中有：

[WordUtils.wrap](http://commons.apache.org/lang/api-2.6/org/apache/commons/lang/WordUtils.html)

# java - 为什么实现接口的抽象类可能会错过接口方法之一的声明/实现？

> ID：197893
> 
> 赞同：134
> 
> 时间：2008-10-13T15:02:04.387
> 
> 标签：java, interface, abstract-class

当您使用抽象类来实现接口时，Java 中会发生一件奇怪的事情：接口的某些方法可能完全丢失（即既不存在抽象声明，也不存在实际实现），但编译器不会抱怨。

例如，给定接口：

```
public interface IAnything {
  void m1();
  void m2();
  void m3();
} 
```

以下抽象类在没有警告或错误的情况下被愉快地编译：

```
public abstract class AbstractThing implements IAnything {
  public void m1() {}
  public void m3() {}
} 
```

你能解释一下为什么吗？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2008-10-13T15:04:48.110

那是因为如果一个类是抽象的，那么根据定义，您需要创建它的子类来实例化。子类将需要（编译器）实现抽象类遗漏的任何接口方法。

按照您的示例代码，尝试在`AbstractThing`不实现该`m2`方法的情况下创建一个子类，并查看编译器给您带来的错误。它会强制你实现这个方法。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-13T15:19:19.500

完全没问题。
**你不能实例化抽象类。但抽象类可用于容纳 m1() 和 m3() 的常见实现。**
因此*，如果*每个实现的 m2() 实现不同，但 m1 和 m3 则不同。您可以使用不同的 m2 实现创建不同的具体 IAnything 实现，并从 AbstractThing 派生——尊重 DRY 原则。验证接口是否为抽象类完全实现是徒劳的。

**更新**：有趣的是，我发现 C# 将其强制为编译错误。在这种情况下，您被迫复制方法签名并在抽象基类中为它们加上“abstract public”前缀..（每天都有新的东西：）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-09T02:46:49.350

没关系。要理解上述内容，您必须首先了解抽象类的本质。它们在这方面类似于接口。这就是 Oracle[在这里](https://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)所说的。

> 抽象类类似于接口。您不能实例化它们，它们可能包含声明的带有或不带有实现的方法的混合。

所以你必须考虑当一个接口扩展另一个接口时会发生什么。例如 ...

```
//Filename: Sports.java
public interface Sports
{
   public void setHomeTeam(String name);
   public void setVisitingTeam(String name);
}

//Filename: Football.java
public interface Football extends Sports
{
   public void homeTeamScored(int points);
   public void visitingTeamScored(int points);
   public void endOfQuarter(int quarter);
} 
```

...如您所见，这也可以很好地编译。很简单，就像抽象类一样，接口不能被实例化。因此，不需要明确提及其“父级”中的方法。但是，所有父方法签名都隐含地成为扩展接口或实现抽象类的一部分。因此，一旦适当的类（可以实例化的类）扩展了上述内容，就需要确保实现每一个抽象方法。

希望这会有所帮助......和Allahu'alam！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-08T01:20:40.583

接口是指没有实现其方法但只有声明的类。
另一方面，抽象类是一个可以实现某些方法以及某些方法的类，只有声明，没有实现。
当我们实现一个抽象类的接口时，意味着抽象类继承了该接口的所有方法。因为，在抽象类中实现所有方法并不重要，但是它涉及到抽象类（也通过继承），因此抽象类可以将接口中的一些方法留在此处而无需实现。但是，当这个抽象类将被某个具体类继承时，他们必须在抽象类中实现所有那些未实现的方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-12T03:49:44.133

给定接口：

```
public interface IAnything {
  int i;
  void m1();
  void m2();
  void m3();
} 
```

这就是 Java 实际看到的方式：

```
public interface IAnything {
  public static final int i;
  public abstract void m1();
  public abstract void m2();
  public abstract void m3();
} 
```

因此，您可以保留这些`abstract`方法中的一些（或全部）未实现，就像在`abstract`类扩展另一个`abstract`类的情况下所做的那样。

当您`implement`使用`interface`时，所有`interface`方法都必须在派生中实现的规则`class`仅适用于具体`class`实现（即，它本身不是`abstract`）。

如果您确实打算从中创建一个`abstract class`，那么没有规则说您拥有`implement`所有`interface`方法（请注意，在这种情况下，必须将派生声明`class`为`abstract`）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-29T15:43:49.810

> 当抽象类实现接口时
> 
> 在接口部分中，注意到实现接口的类必须实现接口的所有方法。但是，可以定义一个不实现所有接口方法的类，前提是该类被声明为抽象类。例如，

```
abstract class X implements Y {   
    // implements all but one method of Y
} 
```

```
class XX extends X {   
    // implements the remaining method in Y 
} 
```

> 在这种情况下，类 X 必须是抽象的，因为它没有完全实现 Y，但类 XX 实际上实现了 Y。

参考：[http ://docs.oracle.com/javase/tutorial/java/IandI/abstract.html](http://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T15:21:39.590

实现这些方法不需要抽象类。所以即使它实现了一个接口，接口的抽象方法也可以保持抽象。如果您尝试在具体类（即非抽象类）中实现接口并且您没有实现抽象方法，编译器会告诉您：要么实现抽象方法，要么将类声明为抽象类。

# java - Java 工作流

> ID：197896
> 
> 赞同：4
> 
> 时间：2008-10-13T15:02:19.363
> 
> 标签：java, workflow

有没有人有实施任何可用的开源解决方案的经验？如果是这样，您会推荐哪种解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T21:47:57.810

[Alfresco](http://www.alfresco.org)只需很少的定制就可以满足您的需求（以及更多）。不简单，但易于设置。

[OpenWFE](http://www.openwfe.org/)是一个简单的工作流程，但在这种情况下，您需要了解更多概念才能实现目标。

如果您不需要工作流管理功能并计划编写自己的前端，[Syrup会更简单。](http://syrup.sourceforge.net/)

另一个值得一看的工作流引擎是[jBPM](https://www.jboss.org/jbossjbpm/)、[Bonita](http://wiki.bonita.objectweb.org)和[Shark](http://www.enhydra.org/workflow/shark/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T17:58:59.770

Carlos E. Perez 总结了许多[用 Java 编写的不同开源工作流引擎](http://www.manageability.org/blog/stuff/workflow_in_java)。

这篇文章有点老了（2007 年 3 月），但仍然充满了有用的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T23:03:42.027

OpenWFE 转向 Ruby，因此留下了 ddimitrov（欢呼）和[osworkflow](http://www.opensymphony.com/osworkflow/)引用的引擎。IIRC，您可以在 jamesh 引用的 Carlos E. Perez 报告中找到它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T16:28:12.373

也许是问题跟踪器？[http://jtrac.info](http://jtrac.info) <先看看这里，如果不是这个作为解决方案，然后谷歌：开源问题跟踪器：还有很多我不知道从哪里开始。

至于批准/不批准，这将是一个创建任务的问题，然后将任务分配给授权人员池，如果获得批准，让他们将其返回到开发人员池。

根据经验，当分配给工作池的每项任务的工作量发生变化时，事情就会变得棘手。我们在 Eternal Downward Spiral 使用了 PeopleSoft 系统。这没有注意所需的工作量，我认为他们为那个糟糕的“解决方案”付出了很多！

我选择的任何工作负载分配系统至少会考虑每个任务的工作负载。这是因为如果您根据执行和清除的任务总数而不是量化工作量来计算每日工作配额；您可以并且将会有一些人一头扎进简单的任务中，他们随后因完成千斤顶而受到称赞。

我不能保证我提供了一个链接的第一个选项，但我很快就将它作为最佳建议进行了交叉引用；就Java问题跟踪系统而言。

您可能还需要质量保证的第三步，但我需要更多背景才能提供任何进一步的价值建议。

# c# - 如何检测应用程序激活

> ID：197903
> 
> 赞同：2
> 
> 时间：2008-10-13T15:05:20.870
> 
> 标签：c#, winforms

当我的应用程序获得焦点时，我需要执行一些操作。

我已经尝试挂钩 GotFocus 和 Enter 事件，但它们仅在我的应用程序中焦点发生变化时触发。

场景是我的应用程序检测到一些必须在其他地方解决的问题，当用户返回我的应用程序时，我想再次进行检查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T15:07:38.230

我会尝试在您的申请表中覆盖[Form.OnActivated](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onactivated(VS.85).aspx)（或处理[Form.Activated](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activated(VS.85).aspx)事件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T15:09:37.477

尝试挂钩 Activated 事件。

# networking - 如何在企业防火墙后面使用 cygwin

> ID：197904
> 
> 赞同：52
> 
> 时间：2008-10-13T15:06:11.913
> 
> 标签：networking, proxy, cygwin

我在 Microsoft IE 环境中，但我想使用 cygwin 执行一些快速脚本任务。

我将如何配置它以使用我的 Windows 代理信息？Ruby gems、ping 等都在尝试建立直接连接。如何让他们尊重 IE 和 firefox 使用的代理信息？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-04-27T16:03:30.640

如果您需要对代理进行身份验证，仅作记录使用：

```
export http_proxy=http://username:password@host:port/ 
```

取自：[http ://samueldotj.blogspot.com/2008/06/configuring-cygwin-to-use-proxy-server.html](http://samueldotj.blogspot.com/2008/06/configuring-cygwin-to-use-proxy-server.html)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-13T15:15:46.323

大多数应用程序会检查以下环境变量之一（`gem` [甚至同时检查两者](http://docs.rubygems.org/read/chapter/12)），因此请尝试将此代码放入您的`.bashrc`：

```
proxy=http://host.com:port/
export http_proxy=$proxy
export HTTP_PROXY=$proxy 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T15:13:14.253

我怀疑您的公司防火墙是否允许 PING，但其他防火墙似乎都是一种 http 或另一种形式。在 Linux 系统上，您可以将 HTTP 代理设置为环境变量，因此在 bash 中，键入：

```
export http_proxy=http://www.myproxy.com:3128 
```

FTP (ftp_proxy) 有一个类似的环境变量。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-04T20:23:11.140

您还可以在 Windows 环境变量上设置它，[cygwin 将](https://cygwin.com/cygwin-ug-net/setup-env.html)在启动时加载它（小红利：Windows 上的任何命令提示符也会设置它）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-25T17:50:23.233

如果我只使用 Vlax 和 Mohsen Nosratinia 建议的 ( `export http_proxy=http://yourusername:yourpassword@host:port/`)，它只会为我的公司运行一半的程序（一些安装会运行，但不是全部）。

通过添加另一行，至少在我的情况下，它将适用于所有人（也许是大多数人）。

```
export http_proxy=http://yourusername:yourpassword@host:port/
export https_proxy=$http_proxy 
```

# ajax - JAR 文件中的组件信息可能吗？

> ID：197927
> 
> 赞同：2
> 
> 时间：2008-10-13T15:11:21.467
> 
> 标签：ajax, frameworks, jar, toolkit, modularity

我想建立一个具有良好模块化的 Web 应用程序，并想`AJAX Toolkit/Framework`为其 VIEW 使用类似的 GWT 或 ZK。组件信息应该从各种模块-JAR 中加载。

哪个`AJAX Toolkit/Framework`能够做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T09:37:04.790

看看[http://www.ztemplates.org](http://www.ztemplates.org)，它简单易学。这个允许您将所有相关的模板、javascript 和 css 放入一个 jar 中并透明地使用它。意味着您甚至不必关心在使用提供的组件时在页面中声明所需的 javascript，因为框架会为您完成。

# language-agnostic - 在文件级别更精细地保存代码有什么优点和缺点？

> ID：197929
> 
> 赞同：0
> 
> 时间：2008-10-13T15:11:44.290
> 
> 标签：language-agnostic, version-control

您如何看待这种代码到文件的映射？

```
~/proj/MyClass.ext  
~/proj/MyClass:constructors.ext  
~/proj/MyClass:properties.ext  
~/proj/MyClass:method-one.ext  
~/proj/MyClass:method-two:int.ext
~/proj/MyClass:method-two:string.ext 
```

在更面向功能的语言中：

```
~/proj/definitions.ext  
~/proj/function-one.ext  
~/proj/function-two:int.ext  
~/proj/function-two:string.ext  
... 
```

关键是，当我们处理我们的项目时，我们看*不到*这种文件的多样性。

我们可能有某种守护进程来保持镜像`MyClass.ext`文件与这堆文件完美同步，或者我们最喜欢的代码编辑器看到它们但将它们显示为它们的逻辑聚合，或者这种转换只发生在一组提交前+提交后挂钩。

现在，既然我们不会对这个想法的实现感兴趣，如果它不是一个好主意，让我们不要为它的实现细节（如何）而烦恼；假设我们已经有了完美的实现，可以使这个想法对我们*很好*。

***我希望我们一起找到一份关于这种方法*的优缺点的很好的清单，无论是在高层次上还是在你关注的更具体的低层次上。**

当我们完成头脑风暴并看到每个答案的投票时，我们应该很容易看出这是否是一个好主意。 **因此，请为每个答案写一个赞成/反对。**

**编辑**

从所有答案，尤其是 Scott 的答案中，我得出**我的想法可能有用的唯一真正方法是能够`class:method`在每个 commit-to-vcs 消息的详细部分中自动列出已更改的夫妻。**这可以通过在提交之前运行的小脚本来更容易地实现，以相应地更新消息模板。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T15:48:53.043

也许更好的回答是：你希望用这种方法解决什么问题？

.NET 语言通过部分类支持某种程度的这种想法，尽管我从未见过它达到如此极端，并且编辑体验并不像您在“完美实现”中描述的那样无缝。

我真的看不出这种情况的用处。是的，拥有多个文件意味着更改影响代码其他部分的**潜在**风险较小，但我认为这不会超过解析文件以将其显示为一个可编辑文件的性能影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T19:59:05.207

### CON

Class-per-file 让您可以将您的大脑作为一个整体包裹在整个课程中。如果您的类大到成为许多多页怪物的地步，您可能需要将方法拆分为单独的文件，但您也可以重构并省去一些维护上的麻烦。这也是反对的论据之一`#region`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T16:22:54.100

我认为就像所有事情一样，它必须是一种平衡——而且框架似乎经常处于光谱的任何一边。

又名 Camping vs. Rails 等。

您在上面绘制的粒度级别对我来说似乎有点过头了。我预见重构是一场噩梦。即使在像 ASP.net 和 Ruby on Rails 这样的框架中，我也发现自己经常清理我的工作区，因为我打开的文件太多，这会导致生产力问题。

*   缺点：开发时打开的文件很多
*   缺点：重构会很复杂而且会让人迷失方向
*   缺点：更容易出现文件违反命名约定并干扰实际语法错误
*   缺点：对于解释型语言，测试工具必须包含更多文件——必须有一些聪明的包含方法来获取解释类所需的一切。
*   缺点：文件系统不太能代表面向对象 - 有时能够轻松确定给定文件夹中的类是件好事。

抱歉 - 我想在这里提供一个专业人士，但它只是没有来找我

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T16:39:26.327

硬盘空间。

在默认的 Windows 安装中，每个文件至少占用 4k。其他文件系统可以或多或少地占用，但几乎总是有一个最小大小。我可以看到一个大型软件项目突然占用了这个系统的大量磁盘空间。这在开发人员的机器上可能不是一个大问题，但我会担心源代码控制服务器，因为服务器似乎永远没有足够的磁盘空间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T19:50:13.667

我同意，这太细化了。

但是，我考虑过按范围分离成员：

```
ClassA-interface.cs（公共成员）
ClassA-implementation.cs（非公共成员）

```

当然，您可以走得更远，但即使是这种分叉也不能“解决我的问题”。虽然这会让我更加意识到可能会影响客户端代码的更改，但我最好通过测试来了解这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T20:07:28.483

亲：

我注意到许多 GNU C 库将它们的源代码拆分为每个翻译单元文件的 1 个函数。据我所知，这是为了在将库静态链接到二进制文件时提供帮助。显然，在搜索符号时，链接器将包括符号所在的整个翻译单元（这是有道理的，因为符号所依赖的单元中可能存在静态函数和数据）。因此，如果您将代码拆分为粒度文件，您可以将静态链接文件的大小保持在最低限度。

我想在 C++ 中没有什么好处，特别是对于具有虚拟成员的类，因为虚拟表会引入多个符号依赖项。

* * *

缺点：

除非您对该映射具有内置的 IDE 支持，否则在人们对类进行大规模更改时，在方法的粒度级别上维护任何东西似乎都是有问题的。在我从事的项目中，函数 get 偶尔会被重命名，以更准确地反映它们不断变化的行为。在函数重命名之上添加文件重命名只是人们搞砸的又一步。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T20:28:52.450

一些版本控制系统，特别是 Git（可能还有 BitKeeper），在设计上在这个级别上工作，而不是在文件级别上工作。

**Pro：**特别是在重构时（在分支上），这可能会非常方便（能够指定单个方法已从一个类移动到另一个类，或者类的一部分已被移动）。在比文件更低的粒度级别上工作的系统可以更容易地解决合并冲突（因为它可以跟踪方法移动的位置，并可以相应地将更改应用于多个文件）。

* * *

**缺点：**我认为你真的需要一个通过设计支持它的 VCS，而不是试图将它粘贴在基于文件的 VCS 上（Git 在 Windows 上不能很好地工作，而 BitKeeper 是商业软件）。另一个缺点是您可能无法以与语言无关的方式进行操作。AFAIK，Git 采用一些高级启发式方法来跟踪文件中的各个内容，但它并非绝对可靠，并且可能存在一些具有非标准（非 C 类）函数/方法语法的语言，传统的启发式方法可能会失败（Prolog 谓词） .

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T15:16:52.453

就我个人而言，我会发现这种类型的分离虽然在某些语言中是可能的，但维护起来将是一场噩梦，并且会使遵循代码变得非常困难。我个人发现使用 .NET 语言的代码区域更有帮助。

我会担心文件数量庞大的大型项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T15:17:40.267

**Pro** Commit 变更集应该包含更多关于这个提交真正发生了什么的信息，而不必显示差异：

*   为同一类列出的许多文件表明它已被重构；
*   相反，只有一个为类列出的文件更改表明它的行为只做了轻微的修改。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T15:19:43.180

**缺点** 从性能的角度来看，所有这些文件 I/O 在大型工作树中可能会花费很多。

# perl - 在 Perl 中清除屏幕的最佳方法是什么？

> ID：197933
> 
> 赞同：14
> 
> 时间：2008-10-13T15:13:10.183
> 
> 标签：perl

理想情况下，跨平台的东西。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-30T19:32:42.233

```
print "\033[2J";    #clear the screen
print "\033[0;0H"; #jump to 0,0 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-13T15:17:18.117

CPAN 可能是最好的方法。看看[Term::Screen:Uni](http://search.cpan.org/~tpaba/Term-Screen-Uni-0.04/lib/Term/Screen/Uni.pm)：

```
require Term::Screen::Uni;
my $scr = new Term::Screen::Uni;

$scr->clrscr() 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T15:26:44.133

我通常使用CPAN 中的[Term::ANSIScreen](http://search.cpan.org/perldoc?Term::ANSIScreen)，它为我提供了各种有用的与控制台相关的功能。

```
use Term::ANSIScreen qw(cls);
cls(); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-01-07T14:05:53.270

从[perlfaq8](http://faq.perl.org/perlfaq8.html)对[How do I clear the screen](http://faq.perl.org/perlfaq8.html#How_do_I_clear_the_s)的回答：

* * *

要清除屏幕，您只需打印告诉终端清除屏幕的特殊序列。一旦你有了那个序列，当你想清除屏幕时输出它。

您可以使用 Term::ANSIScreen 模块来获取特殊序列。导入 cls 函数（或 :screen 标签）：

```
use Term::ANSIScreen qw(cls);
my $clear_screen = cls();

print $clear_screen; 
```

如果要处理终端控制的低级细节，Term::Cap 模块也可以获取特殊序列。Tputs 方法返回给定功能的字符串：

```
use Term::Cap;

$terminal = Term::Cap->Tgetent( { OSPEED => 9600 } );
$clear_string = $terminal->Tputs('cl');

print $clear_screen; 
```

在 Windows 上，您可以使用 Win32::Console 模块。在为要影响的输出文件句柄创建对象后，调用 Cls 方法：

```
use Win32::Console;

$OUT = Win32::Console->new(STD_OUTPUT_HANDLE);
$OUT->Cls; 
```

如果你有一个命令行程序来完成这项工作，你可以在反引号中调用它来捕获它输出的任何内容，以便以后使用它：

```
$clear_string = `clear`;

print $clear_string; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-07-30T03:47:19.107

在 OS X 和 Linux 下，您可以使用以下 Perl 命令：

```
system("clear"); 
```

~~不知道Windows下的等价物是什么。~~

编辑：Windows 等价物是：

```
system("cls"); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-13T15:17:45.370

如果您在谈论终端，我会使用 Curses lib 之类的东西来完成它。

有一个很好的 Curses 模块可以访问它，你可以像这样使用它：

```
perl -MCurses -e '$win=new Curses;$win->clear()' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-17T12:20:08.177

**我不同意上述观点**

1.  连接额外的模块 = 增加攻击面。
2.  减少运行代码的数量。
3.  代码重构。

* * *

```
#!/usr/bin/perl -w
use strict;

my
( $over, $cleaning );
( $cleaning ) = qq([J\033[H\033[J);
( $over ) = <<EOF;
 1\. Connecting additional modules = Increase the attack surface.
 2\. Reduce the Amount of Running Code.
 3\. Code refactoring.
EOF

print ($cleaning.$over);

__END__ 
```

| 食品 | 酒吧 |
| --- | --- |
| \033 | 代表 ESC ANSI 值 27 |
| [J | 从当前行向下屏幕擦除屏幕 |
| [H | 将光标移动到起始位置 |

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-05-20T10:28:53.127

支持Linux和Windows：

```
system($^O eq 'MSWin32'?'cls':'clear'); 
```

# django - 使用自定义的非 SQL 服务来存储模型的 Django？

> ID：197938
> 
> 赞同：5
> 
> 时间：2008-10-13T15:13:41.773
> 
> 标签：django, django-models

我可以有一个自定义服务来存储我在 Django 中使用的模型吗？该服务不会说 SQL。

我想为一个系统构建一个 Web 前端，该系统由多个与基于网络的 IPC 链接的服务组成，其中一个为常用的持久对象（存储在数据库中）提供接口。

这里真正的问题不是它是否可能，而是它是否有意义。例如，如果我最终继承了 models.Model 并覆盖了每一个方法，跳过了 django.db 的所有其余部分，我猜它不会。

对象服务甚至可能最终也在 Django 中实现，但它与 Web 前端之间的通信不会使用 SQL。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T15:42:13.260

你可以看看[An Introduction to using couchdb with django](http://lethain.com/entry/2008/aug/18/an-introduction-to-using-couchdb-with-django/)。不知道是否直接连接到 CouchDB 是您感兴趣的事情，但这是一个很好的示例，说明了如何使用 django 连接到 RESTful Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T15:38:19.540

我认为您想编写一个自定义数据库后端，然后通过 DATABASE_ENGINE 设置使用它。然后模型会自动拾取它。

我找不到好的文档，但我会从这里开始：

[http://djangoapi.matee.net/django.db-module.html](http://djangoapi.matee.net/django.db-module.html)

Django 源代码非常易读。

# php - MVC中数据访问层和模型的区别

> ID：197939
> 
> 赞同：17
> 
> 时间：2008-10-13T15:13:45.160
> 
> 标签：php, model-view-controller, data-access-layer

我已经在几个 Web 应用程序中实现了我认为是 MVC 的一个相当不错的表示，但是自从加入了crackoverflow，我发现我最初的定义可能有点简单，因此我真的很想澄清一下两者之间的差异数据访问层和 Web 应用程序的模型或领域层。

对于上下文，我目前使用的数据访问对象为该对象表示的表中的单个记录实现 CRUD 函数，以及返回一个对象的 get() 函数，该对象允许我遍历所有满足get() 函数的标准。

这些数据访问对象直接从包含我的业务逻辑的控制器脚本中引用。

如果重要的话，我正在使用 PHP 和 MySQL，但对可能用其他语言编码的建议感兴趣。

**更新：**举一个更具体的例子，我有一个名为 user 的表（这里的约定是单数表名），其中包含电子邮件地址、活动状态、用户名、密码、他们所属的公司等信息。这个基本对象将在代码中看起来像这样：

```
class User implements DataAccessObject
{
     protected $user_id;
     protected $email;
     protected $username;
     protected $password;
     protected $company_id;
     protected $active // Bool that holds either a 0 or 1

     public function __construct ( $user_id ) // Uses Primary Key to know which record to construct
     {
          $sql = //Sql to get this information from the database.

          // Code necessary to assign member variables their values from the query.
     }

     public function insert(){}
     public function update(){}
     public function delete(){}
     public static function get($filters, $orderVals, $limit){}

     // An object such as user might also contain the following function definition
     public static function login($username, $password){}
} 
```

听起来我可能已经将 DAO 层和模型层混为一谈了，它结合了任何现实世界类型的功能（例如用户登录）和数据访问功能。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-13T15:40:50.283

**模型**类独立作为真实世界实体的良好、干净、高保真模型。如果它是一个业务领域，他们可能是客户、计划、产品、付款，所有这些东西。您的应用程序使用这些类。这个想法是您的应用程序是域对象的真实处理模型。您的应用程序可以具有看起来像人们真正做的动词的方法函数，并且这些方法函数的实现看起来像是对真实世界对象的真实描述。

重要提示：这（理想情况下）独立于大多数技术考虑因素。这是您可以定义的最纯粹的领域对象模型。[是的，你确实有外键查找问题，是的，你必须让你的模型对象知道一些数据访问组件，以便模型对象可以找到只给定外键而不是实际对象的其他对象。一个好的 ORM 层会为您处理这个导航问题。]

一个充满 SQL 的模型不是一个好的模型。现实世界也不全是 SQL。发票是包含一些名称、地址和物品，以及发货日期以及诸如此类的一堆东西的文件。

**访问**类处理持久存储。这通常包括将模型对象映射到关系数据库表。面向 SQL 的数据访问层将从关系数据库中重建您的模型，并将您的模型保存在关系数据库中。YAML 数据访问层将从您的模型中读取和写入 YAML 文件。

有时，对象关系映射 (ORM) 设计模式用于在 SQL 的世界和您的模型之间进行清晰的分离。有时，数据访问对象 (DAO) 会处理 SQL 和模型之间的这种分离。ORM 或 DAO 对象可以装满 SQL。

实际上，当您更改数据库产品时，*唯一*的更改是在 DAO 或 ORM 中。模型永远不会改变，因为它独立于 SQL、YAML、JSON、XML 或其他一些序列化技术。

如果您的 DAO 创建并保留模型对象，我认为您已经很好地实现了 MVC 的模型部分。您可以查看 ORM 包以获取有关最新技术的更多想法。我自己是[iBatis](http://ibatis.apache.org/)的粉丝。

但这只是整个 MVC 世界观的 1/3。而且——当然——纯粹主义者会告诉你，MVC 只是桌面或只是 Smalltalk，或者与 MVC 的常见 Web 实现不同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-13T15:43:01.807

这只是更高抽象的问题。如果您考虑您将要解决的某个业务问题，您希望根据该业务的概念（实体、关系、流程等）来考虑它，而不是根据数据库对象或更详细的级别来考虑它，在某些特定数据库系统（例如 MySQL）的内部术语。这样，您可以根据您用于实现的特定技术独立地对域（即业务及其规则）进行建模。

换句话说，当您谈论“数据访问分层”时，您谈论的是表、行、数据类型，甚至是访问这些数据的方法（例如，通过使用活动记录模式），而当您谈论域时，您谈论业务对象、业务规则和业务流程。

而且，顺便说一句，当使用 MVC 模式时，您应该将业务逻辑封装在模型（域）级别（如上所述），而不是控制器中 - 他们应该只是触发这些规则，可以这么说。

# .net - 显示一个值并将另一个值存储在.net 组合框上的最佳方法是什么？

> ID：197940
> 
> 赞同：2
> 
> 时间：2008-10-13T15:13:56.280
> 
> 标签：.net, winforms

我似乎找不到一种易于使用的 .net 本机方式来获取 .net winforms 上的组合框以显示一个值并根据选择返回另一个值，而无需创建我自己的帮助器类，并且知道 winforms 将显示您放入其中的对象的 ToString 方法。

这就是我现在的做法，非常笼统。首先，创建助手类。

```
 Public Class ListItem
     Public Value As Object
     Public DisplayString As String

     Public Sub New(ByVal NewValue As Object, ByVal NewDisplayString As String)
         Value = NewValue
         DisplayString = NewDisplayString
     End Sub

     Public Overrides Function ToString() As String
         Return DisplayString
     End Function
 End Class 
```

然后，从集合或其他任何内容中加载组合框。

```
 For Each o as WhateverObject In CollectionIwantToaddItemsFrom
        li = New ListItem(o.ValueToReturn, o.ValueToDisplay)
        Me.ComboBox1.Items.Add(li)
    Next 
```

最后，使用对象

```
Private Sub ComboBox1_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles ComboBox1.SelectedIndexChanged
if me.combobox1.selecteditem is nothing then exit sub
Dim li As ListItem = me.ComboBox1.SelectedItem
Dim o as object = li.value 
'do stuff with o.
end sub 
```

我敢肯定，在我正在寻找的框架中，我最好使用一些东西。它是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T15:36:32.007

这有点小技巧，但这意味着您不必编写自己的名称-值对类 - 没什么大不了的（框架中可能已经有更好的东西了）。但是你可以做的是使用 DictionaryEntry 类——它实际上是一个名称值对。将项目添加到列表中，然后使用组合框上的 DataMember 和 ValueMember 属性绑定到 DictionaryEntry 类的键和值属性。像这样：

```
 var list = new List<System.Collections.DictionaryEntry>();
    list.Add(new System.Collections.DictionaryEntry("one", 1));
    list.Add(new System.Collections.DictionaryEntry("two", 2));
    list.Add(new System.Collections.DictionaryEntry("three", 3));

    comboBox1.DataSource = list;
    comboBox1.DisplayMember = "Key";
    comboBox1.ValueMember = "Value"; 
```

刚刚意识到你更喜欢 vb 方言。下面对VB做同样的事情:-)

```
Dim list As List(Of DictionaryEntry)

list = New List(Of DictionaryEntry)
list.Add(New DictionaryEntry("One", 1))
list.Add(New DictionaryEntry("Two", 2))
list.Add(New DictionaryEntry("Three", 3))

ComboBox1.DataSource = list
ComboBox1.DisplayMember = "Key"
ComboBox1.ValueMember = "Value" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T15:20:29.467

由于对您的应用程序架构缺乏更好的理解，您可能正在采取一种好的方法。

通常，我将组合框绑定到 .ToString() 方法被覆盖的 DAL 对象。这提供了基本相同的功能，尽管我必须将组合中选择的任何内容重新转换为其原始类型以获得“值”（通常是与实体的 PK 对应的属性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T15:20:41.370

好吧，通常情况下，您放置在 Items 集合中的对象将具有自己的 ToString() ，它以可呈现的形式呈现对象。

但是，如果您想为您的对象显示一个完全不相关的字符串，那么您将不得不以您正确的方式进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:24:11.847

我通常最终创建一个数据表并将这个数据表设置为组合框的数据源。然后我将 DisplayMember 设置为我想要显示的列，并将 ValueMember 设置为我想要返回的值。除了数据表之外，可能还有更好的东西，但是当我需要这个功能时，我会使用这些。

# c++ - 使用 GDI+ 和 C++ 减少闪烁

> ID：197948
> 
> 赞同：21
> 
> 时间：2008-10-13T15:16:16.353
> 
> 标签：c++, windows, gdi+

我在 C++/MFC 应用程序中使用 GDI+，我似乎无法在调整窗口大小时避免闪烁。

我已经尝试了这些步骤：

*   返回 TRUE `OnEraseBkGnd()`;
*   返回 NULL `OnCtlColor()`；
*   根据此代码使用双缓冲：

```
void vwView::OnDraw(CDC* pDC) 
{
   CRect rcClient;
   GetClientRect(rcClient);

   Bitmap bmp(rcClient.Width(), rcClient.Height());
   Graphics graphics(&bmp);

   graphics.DrawImage(m_image, rcClient.left, rcClient.top);

   Graphics grph(pDC->m_hDC);
   grph.DrawImage(&bmp, 0, 0);
} 
```

难道我做错了什么？还是有另一种方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-14T00:13:16.693

为了完全避免闪烁，您需要在屏幕更新之间完成*所有绘图。*对于普通的窗口绘制，Windows 没有提供任何简单的方法来完成此操作（Vista 通过[DWM](https://en.wikipedia.org/wiki/Desktop_Window_Manager)提供复合绘制，但即使在运行 Vista 的系统上也不能依赖它）。因此，尽量减少闪烁的最佳方法是尽可能快地绘制所有内容（通过增加在刷新周期内完成所有绘制的机会来*减少*撕裂），并避免过度绘制（绘制屏幕的一部分，然后再绘制其他内容）顶部：存在向用户展示部分绘制屏幕的风险）。

让我们讨论一下到目前为止这里介绍的技术：

*   **Do-nothing *OnEraseBkgnd()***：通过防止窗口的无效区域被窗口的背景颜色填充，有助于避免过度绘制。*无论如何，当您在**WM_PAINT*处理期间再次绘制整个区域时很有用，例如在双缓冲绘图的情况下......但请参阅有关通过在WM_PAINT*方法**之后防止绘图来避免过度绘制的注意事项*。

****   **返回 NULL 为*OnCtlColor()***：这实际上不应该做*任何事情*......除非您的表单上有子控件。在这种情况下，请参阅通过在WM_PAINT*方法**之后防止绘图来避免过度绘制的注意事项*。

    **   **双缓冲绘图：通过将实际的屏幕绘图减少到单个**[BitBLT](https://en.wikipedia.org/wiki/Bit_blit)来帮助避免撕裂（以及潜在的过度绘制）。但是可能会影响绘图所需的时间：不能使用硬件加速（尽管使用 GDI+，使用任何硬件辅助绘图的机会都很渺茫），必须为每次重绘创建和填充屏幕外位图，并且每次重绘都必须重绘整个窗口。请参阅*关于高效双缓冲的说明*。

    *   **对 BitBlt 使用 GDI 调用而不是 GDI+**：这通常是个好主意 -`Graphics::DrawImage()`可能会非常慢。我什至发现[`BitBlt()`](https://msdn.microsoft.com/en-us/library/dd183370.aspx)在某些系统上正常的 GDI 调用速度更快。玩这个，但只有在先尝试了一些其他建议之后。

    *   **避免在每次调整大小时强制完全重绘的窗口类样式（*CS_VREDRAW*，*CS_HREDRAW*）**：这将有所帮助，但前提是您不需要*在*大小更改时重绘整个窗口。**** 

 ***### *通过在WM_PAINT*方法之前防止绘制来避免过度绘制的注意事项

当一个窗口的全部或部分失效时，它将被擦除并重新绘制。如前所述，如果您打算重新绘制整个无效区域，则可以跳过擦除。**但是**，如果您正在使用子窗口，则必须确保父窗口不会同时擦除您的屏幕区域。应该在所有父窗口上设置*WS_CLIPCHILDREN*样式 -这将防止子窗口（包括您的视图）占用的区域被绘制。

### *通过在WM_PAINT*方法之后防止绘图来避免过度绘制的注意事项

如果您的表单上托管了*任何子*控件，您将希望使用*WS_CLIPCHILDREN*样式来避免在它们之上绘制（并随后被它们过度绘制。请注意，这将在一定程度上影响 BitBlt 例程的速度。

### 高效双缓冲注意事项

现在，每次视图绘制自己时，您都会创建一个新的后台缓冲区图像。对于较大的窗口，这可能表示正在分配和释放大量内存，并*会*导致严重的性能问题。我建议在视图对象中保留一个动态分配的位图，根据需要重新分配它以匹配视图的大小。

请注意，在调整窗口大小时，这将导致与当前系统一样多的分配，因为每个新大小都需要分配一个新的后台缓冲区位图来匹配它 - 您可以通过向上舍入尺寸来减轻痛苦到 4、8、16 等的下一个最大倍数，让您避免对每个微小的大小变化进行重新分配。

请注意，如果自上次渲染到后台缓冲区后窗口的大小没有更改，则在窗口无效时不需要重新渲染它 - 只需将已经渲染的图像 Blt out 到屏幕。

此外，分配与屏幕的位深度匹配的位图。`Bitmap`您当前使用的构造函数将默认为 32bpp，ARGB 布局；如果这与屏幕不匹配，则必须对其进行转换。考虑使用 GDI 方法[`CreateCompatibleBitmap()`](https://msdn.microsoft.com/en-us/library/dd183488.aspx)来获取匹配的位图。

最后......我假设您的示例代码就是这样，一个说明性的片段。但是，如果您实际上除了将现有图像渲染到屏幕上之外什么都不做，那么您根本不需要维护后台缓冲区 - 只需直接从图像中 Blt（并提前将图像的格式转换为匹配屏幕）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T15:53:24.423

您可以尝试使用老式 GDI 而不是 GDI+ 来写入 DC，尤其是因为您已经在缓冲图像。使用 Bitmap::LockBits 访问原始位图数据，创建 BITMAPINFO 结构，并使用 SetDIBitsToDevice 显示位图。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T16:30:20.713

确保窗口的窗口类在其样式中不包含 CS_VREDRAW 和 CS_HREDRAW 标志。

请参阅[http://msdn.microsoft.com/en-us/library/ms633574(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms633574(VS.85).aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-09T14:38:40.300

[您可能会通过使用Direct3D](http://en.wikipedia.org/wiki/Microsoft_Direct3D)来“告诉”您何时发生 vsync 等，从而获得一些牵引力，这样您就可以适时进行 BitBlt/更新。请参阅*[GDI vsync 以避免撕裂](http://betterlogic.com/roger/2012/05/gdi-vsync-to-avoid-tearing/)*（尽管在某些情况下将事情归结为一个小的 BitBlt 可能“足够好”）。

另请注意，GDI BitBlt 似乎与屏幕垂直同步不同步。请参阅 *[比 BitBlt 更快](http://www.itlisting.org/4-windows-ce-embedded/7752b5a1dabede5f.aspx)*。

另请注意，如果使用 CAPTUREBLT（允许您捕获透明窗口），则会导致鼠标闪烁（如果未使用 aero）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-30T09:55:20.257

此链接包含一些有用的信息： http: [//www.catch22.net/tuts/flicker-free-drawing](http://www.catch22.net/tuts/flicker-free-drawing)

(I know this is a very late addition to the thread, but this is for anyone (like me) who found it when looking to reduce flicker in my Win32 app...)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T15:58:23.507

表单上有子窗口吗？窗口管理器首先通过发送 WM_ERASEBKGND 消息让父窗口擦除其背景，然后发送 wM_PAINT 消息 - 大概这映射到您的 wx::OnDraw 方法。然后它遍历每个子控件并让它们自己绘制。

如果这是您的情况...使用 Vistas 新的 aero 外观将解决您的问题，因为 aero 桌面窗口管理器会自动进行窗口合成。对于较旧的窗口管理器，它是一个皮塔饼。

# c# - 如何确定可执行文件是为哪个平台编译的？

> ID：197951
> 
> 赞同：55
> 
> 时间：2008-10-13T15:16:55.060
> 
> 标签：c#, powershell, cpu-architecture

我需要使用为 x86、x64 和 IA64 制作的 Windows 可执行文件。我想通过检查文件本身以编程方式找出平台。

我的目标语言是 PowerShell，但可以使用 C# 示例。如果您知道所需的逻辑，那么其中任何一个都失败了，那就太好了。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2011-01-18T01:04:14.860

如果您安装了 Visual Studio，则可以使用`dumpbin.exe`. [PowerShell 社区扩展](http://pscx.codeplex.com)中还有可用于测试可执行映像的`Get-PEHeader`cmdlet 。

Dumpbin 会将 DLL 报告为`machine (x86)`或`machine (x64)`

`PE32`Get- PEHeader将 DLL 报告为`PE32+`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-19T23:11:09.110

（来自另一个 Q，已删除）

机器类型：这是我基于一些获取链接器时间戳的快速代码。这是在同一个头文件中，它似乎工作 - 它在编译时返回 I386 -any cpu-，而在使用它作为目标平台编译时返回 x64。

正如另一个响应指出的那样，Exploring PE Headers (K. Stanton,MSDN) 博客条目向我展示了偏移量。

```
public enum MachineType {
    Native = 0, I386 = 0x014c, Itanium = 0x0200, x64 = 0x8664
}

public static MachineType GetMachineType(string fileName)
{
    const int PE_POINTER_OFFSET = 60;            
    const int MACHINE_OFFSET = 4;
    byte[] data = new byte[4096];
    using (Stream s = new FileStream(fileName, FileMode.Open, FileAccess.Read)) {
        s.Read(data, 0, 4096);
    }
    // dos header is 64 bytes, last element, long (4 bytes) is the address of the PE header
    int PE_HEADER_ADDR = BitConverter.ToInt32(data, PE_POINTER_OFFSET);
    int machineUint = BitConverter.ToUInt16(data, PE_HEADER_ADDR + MACHINE_OFFSET);
    return (MachineType)machineUint;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T15:34:14.243

您需要 GetBinaryType win32 函数。这将返回 PE 格式可执行文件的相关部分。

通常，您会在 BinaryType 字段中获得 SCS_32BIT_BINARY 或 SCS_64BIT_BINARY，

或者，您可以检查 PE 格式本身以查看可执行文件编译的架构。

IMAGE_FILE_HEADER.Machine 字段将为 IA64 二进制文件设置“IMAGE_FILE_MACHINE_IA64”，为 32 位设置 IMAGE_FILE_MACHINE_I386，为 64 位设置 IMAGE_FILE_MACHINE_AMD64（即 x86_64）。

有一篇[MSDN 杂志文章](http://msdn.microsoft.com/en-gb/magazine/cc301805.aspx)可以帮助您开始。

附录：[这](http://webster.cs.ucr.edu/Page_TechDocs/pe.txt)可能会对您有所帮助。您将二进制文件作为文件读取：检查前 2 个字节说“MZ”，然后跳过接下来的 58 个字节，并将 60 个字节的神奇 32 位值读取到图像中（对于 PE 可执行文件，等于 0x00004550）。以下字节是[此标头](http://msdn.microsoft.com/en-us/library/ms680313(VS.85).aspx)，其中的前 2 个字节告诉您二进制文件是为哪台机器设计的（0x8664 = x86_64, 0x0200 = IA64, 0x014c = i386）。

（执行摘要：读取文件的第 65 和 66 字节获取图像类型）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-13T15:33:03.043

```
Assembly assembly = Assembly.LoadFile(Path.GetFullPath("ConsoleApplication1.exe"));
Module manifestModule = assembly.ManifestModule;
PortableExecutableKinds peKind;
ImageFileMachine machine;
manifestModule.GetPEKind(out peKind, out machine); 
```

然后目标机器应该在机器中。

不过，这只适用于 .NET 程序集。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-03-05T12:05:55.920

根据this [post](https://www.raymond.cc/blog/determine-application-compiled-32-64-bit/)，您可以通过用**记事本**打开DLL或EXE并在开头查找“PE”来检查DLL或EXE是32还是64，如果下一个字母是“L”则平台是32位，它是字母是“D”平台是64位。

我在我的 dll 上尝试过它，它似乎是准确的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-07-11T05:55:39.183

`dumpbin.exe``bin`在Visual Studio 目录下可用，适用于`.lib`和`.dll`

```
 dumpbin.exe /headers *.dll |findstr machine
 dumpbin.exe /headers *.lib |findstr machine 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T16:37:45.050

我可以提供[一些用于访问 IMAGE_FILE_HEADER 的 C# 代码的链接](http://blogs.msdn.com/kstanton/archive/2004/03/31/105060.aspx)，我认为可以（很容易）将其编译成 PowerShell cmdlet。我有理由确定您不能直接在 PowerShell 脚本中使用该方法，因为它缺少指针和 PInvoke 功能。

但是，您现在应该能够使用您对 PE 标头格式的广泛了解；-) 直接“直接”找到正确的字节并找出答案。这*将*在 PowerShell 脚本中工作，您应该能够将[Tasos 博客中的此 C# 代码](http://anastasiosyal.com/archive/2007/04/17/3.aspx)转换为脚本。我不会在这里重复代码，因为它不是我的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-09T14:31:33.520

这是一个写出文件头信息的 C++ MFC 控制台应用程序。您可以检查机器类型（IMAGE_FILE_HEADER 机器成员）或特性中的 IMAGE_FILE_32BIT_MACHINE 标志，以查看文件是为哪个平台构建的。有关结构的更多信息，请参见 WinNT.h。

```
#include "stdafx.h"

int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
  int nRetCode = 0;
  int nrd;

  IMAGE_DOS_HEADER idh;
  IMAGE_NT_HEADERS inth;
  IMAGE_FILE_HEADER ifh;

  // initialize MFC and print and error on failure
  if (!AfxWinInit(::GetModuleHandle(NULL), NULL, ::GetCommandLine(), 0))
  {
    _tprintf(_T("Fatal Error: MFC initialization failed\n"));
    nRetCode = 1;
    return 1;
  }
  if (argc != 2) {
    _ftprintf(stderr, _T("Usage: %s filename\n"), argv[0]);
    return 1;
  }
  // Try to open the file
  CFile ckf;
  CFileException ex;
  DWORD flags = CFile::modeRead | CFile::shareDenyNone;

  if (!ckf.Open(argv[1], flags, &ex)) {
    TCHAR szError[1024];
    ex.GetErrorMessage(szError, 1024);
    _tprintf_s(_T("Couldn't open file: %1024s"), szError);
    return 2;
  }

  // The following is adapted from:
  // https://stackoverflow.com/questions/495244/how-can-i-test-a-windows-dll-file-to-determine-if-it-is-32-bit-or-64-bit
  // https://stackoverflow.com/questions/46024914/how-to-parse-exe-file-and-get-data-from-image-dos-header-structure-using-c-and
  // Seek to beginning of file
  ckf.Seek(0, CFile::begin);

  // Read DOS header
  int nbytes = sizeof(IMAGE_DOS_HEADER);
  nrd = ckf.Read(&idh, nbytes);

  // The idh.e_lfanew member is the offset to the NT_HEADERS structure
  ckf.Seek(idh.e_lfanew, CFile::begin);

  // Read NT headers
  nbytes = sizeof(IMAGE_NT_HEADERS);
  nrd = ckf.Read(&inth, nbytes);

  ifh = inth.FileHeader;

  _ftprintf(stdout, _T("File machine type: "));
  switch (ifh.Machine) {
     case IMAGE_FILE_MACHINE_I386:
       _ftprintf(stdout, _T("I386\n"));
       break;
     case IMAGE_FILE_MACHINE_IA64:
       _ftprintf(stdout, _T("IA64\n"));
       break;
     case IMAGE_FILE_MACHINE_AMD64:
       _ftprintf(stdout, _T("AMD64\n"));
       break;
     default:
       _ftprintf(stdout, _T("Unknown (%d = %X)\n"), ifh.Machine, ifh.Machine);
       break;
  }

  // Write characteristics (see WinNT.h)
  _ftprintf(stdout, _T("Characteristics:\n"));
  _ftprintf(stdout, _T("RELOCS_STRIPPED Relocation info stripped from file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_RELOCS_STRIPPED ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("EXECUTABLE_IMAGE File is executable  (i.e. no unresolved externel references): %c\n"),
    (ifh.Characteristics & IMAGE_FILE_EXECUTABLE_IMAGE ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("LINE_NUMS_STRIPPED Line nunbers stripped from file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_LINE_NUMS_STRIPPED ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("LOCAL_SYMS_STRIPPED Local symbols stripped from file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_LOCAL_SYMS_STRIPPED ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("AGGRESIVE_WS_TRIM Agressively trim working set: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_AGGRESIVE_WS_TRIM ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("LARGE_ADDRESS_AWARE App can handle >2gb addresses: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_LARGE_ADDRESS_AWARE ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("BYTES_REVERSED_LO Bytes of machine word are reversed: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_BYTES_REVERSED_LO ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("32BIT_MACHINE 32 bit word machine: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_32BIT_MACHINE ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("DEBUG_STRIPPED Debugging info stripped from file in .DBG file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_DEBUG_STRIPPED ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("REMOVABLE_RUN_FROM_SWAP If Image is on removable media, copy and run from the swap file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("NET_RUN_FROM_SWAP If Image is on Net, copy and run from the swap file: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_NET_RUN_FROM_SWAP ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("SYSTEM System File: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_SYSTEM ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("DLL File is a DLL: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_DLL ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("UP_SYSTEM_ONLY File should only be run on a UP machine: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_UP_SYSTEM_ONLY ? _T('Y') : _T('N')));
  _ftprintf(stdout, _T("BYTES_REVERSED_HI Bytes of machine word are reversed: %c\n"),
    (ifh.Characteristics & IMAGE_FILE_BYTES_REVERSED_HI ? _T('Y') : _T('N')));

  ckf.Close();

  return nRetCode;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T15:23:16.310

Unix OS 有一个名为“file”的实用程序，用于识别文件。识别规则保存在一个名为“magic”的描述文件中。您可以尝试 file 以查看它是否能够正确识别您的文件并从魔术文件中获取适当的规则。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-06T16:58:58.890

这是我自己的实现，它有更多的检查并总是返回一个结果。

```
// the enum of known pe file types
public enum FilePEType : ushort
{
    IMAGE_FILE_MACHINE_UNKNOWN = 0x0,
    IMAGE_FILE_MACHINE_AM33 = 0x1d3,
    IMAGE_FILE_MACHINE_AMD64 = 0x8664,
    IMAGE_FILE_MACHINE_ARM = 0x1c0,
    IMAGE_FILE_MACHINE_EBC = 0xebc,
    IMAGE_FILE_MACHINE_I386 = 0x14c,
    IMAGE_FILE_MACHINE_IA64 = 0x200,
    IMAGE_FILE_MACHINE_M32R = 0x9041,
    IMAGE_FILE_MACHINE_MIPS16 = 0x266,
    IMAGE_FILE_MACHINE_MIPSFPU = 0x366,
    IMAGE_FILE_MACHINE_MIPSFPU16 = 0x466,
    IMAGE_FILE_MACHINE_POWERPC = 0x1f0,
    IMAGE_FILE_MACHINE_POWERPCFP = 0x1f1,
    IMAGE_FILE_MACHINE_R4000 = 0x166,
    IMAGE_FILE_MACHINE_SH3 = 0x1a2,
    IMAGE_FILE_MACHINE_SH3DSP = 0x1a3,
    IMAGE_FILE_MACHINE_SH4 = 0x1a6,
    IMAGE_FILE_MACHINE_SH5 = 0x1a8,
    IMAGE_FILE_MACHINE_THUMB = 0x1c2,
    IMAGE_FILE_MACHINE_WCEMIPSV2 = 0x169,
}

// pass the path to the file and check the return
public static FilePEType GetFilePE(string path)
{
    FilePEType pe = new FilePEType();
    pe = FilePEType.IMAGE_FILE_MACHINE_UNKNOWN;
    if(File.Exists(path))
    {
        using (var fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        {
            byte[] data = new byte[4096];
            fs.Read(data, 0, 4096);
            ushort result = BitConverter.ToUInt16(data, BitConverter.ToInt32(data, 60) + 4);
            try
            {
                pe = (FilePEType)result;
            } catch (Exception)
            {
                pe = FilePEType.IMAGE_FILE_MACHINE_UNKNOWN;
            }
        }
    }
    return pe;
} 
```

如何使用 ：

```
string myfile = @"c:\windows\explorer.exe"; // the file
FilePEType pe = GetFilePE( myfile );

System.Diagnostics.WriteLine( pe.ToString() ); 
```

对于此处使用的枚举值，它们是从[pe.go](https://golang.org/src/debug/pe/pe.go)获得的。这样做的原因是，对于“go”的每个二进制分发，程序集中必须有正确的标志，以让它通过操作系统“你可以在这里运行吗？” 查看。由于“go”是跨平台的（所有平台），因此它是获取此信息的良好基础。此信息可能还有其他来源，但它们似乎嵌套在 google ca-ca 的膝盖深处，需要 Google-fu 中的第 10 段黑带才能定位。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-05-22T15:50:22.013

这是 C 中的一个实现。

```
// Determines if DLL is 32-bit or 64-bit.
#include <stdio.h>

int sGetDllType(const char *dll_name);

int main()
{
  int ret;
  const char *fname = "sample_32.dll";
  //const char *fname = "sample_64.dll";
  ret = sGetDllType(fname);
}

static int sGetDllType(const char *dll_name) {
  const int PE_POINTER_OFFSET = 60;
  const int MACHINE_TYPE_OFFSET = 4;
  FILE *fp;
  unsigned int ret = 0;
  int peoffset;
  unsigned short machine;

  fp = fopen(dll_name, "rb");
  unsigned char data[4096];
  ret = fread(data, sizeof(char), 4096, fp);
  fclose(fp);
  if (ret == 0)
    return -1;

  if ( (data[0] == 'M') && (data[1] == 'Z') ) {
    // Initial magic header is good
    peoffset = data[PE_POINTER_OFFSET + 3];
    peoffset = (peoffset << 8) + data[PE_POINTER_OFFSET + 2];
    peoffset = (peoffset << 8) + data[PE_POINTER_OFFSET + 1];
    peoffset = (peoffset << 8) + data[PE_POINTER_OFFSET];

    // Check second header
    if ((data[peoffset] == 'P') && (data[peoffset + 1] == 'E')) {
      machine = data[peoffset + MACHINE_TYPE_OFFSET];
      machine = (machine)+(data[peoffset + MACHINE_TYPE_OFFSET + 1] << 8);

      if (machine == 0x014c)
        return 32;
      if (machine == 0x8664)
        return 64;

      return -1;
    }
    return -1;
  }
  else
    return -1;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-28T13:10:10.537

这是另一个使用 C/C++ 作为独立工具的解决方案，可以随时适应您的需要：

```
// Fri May 28, 2021 -two

#include <stdio.h>
#include <io.h>
#include <stdint.h>
#include <iostream.h>
using namespace std;

bool queryExeMachineType( const char *filename )
{
    FILE *fp = fopen( filename, "rb" );

    if (fp == NULL)
        return false;

    // DOS header is 64 bytes
    const uint32_t fsize = filelength( fileno( fp ) );
    char magic[ 2 ] = { 0 };
    uint32_t offset = 0;
    uint16_t machine = 0;

    if (fread( magic, 1, 2, fp ) != 2 || magic[ 0 ] != 'M' || magic[ 1 ] != 'Z')
    {
        cerr << "not an executable file" << endl;
        fclose( fp );
        return false;
    }
    fseek( fp, 60, SEEK_SET );
    fread( &offset, 1, 4, fp );

    if (offset >= fsize)
    {
        cerr << "invalid pe offset" << endl;
        fclose( fp );
        return false;
    }
    fseek( fp, offset, SEEK_SET );

    if (fread( magic, 1, 2, fp ) != 2 || magic[ 0 ] != 'P' || magic[ 1 ] != 'E')
    {
        cerr << "not a pe executable" << endl;
        fclose( fp );
        return false;
    }
    fread( magic, 1, 2, fp );
    fread( &machine, 1, 2, fp );

    switch (machine)
    {
        case 0x014c:
            cout << "i386" << endl;  // x86
            break;

        case 0x8664:
            cout << "amd64" << endl; // x86_64
            break;

       case 0x0200:
            cout << "ia64" << endl;  // itanium
            break;

        default:
            cerr << "unknown machine 0x" << hex << machine << endl;
            break;
    }
    fclose( fp );
    return true;
}

int main( int argc, char *argv[] )
{
    const char *fn = (argc > 1) ? argv[ 1 ] : "test.dll";

    if (queryExeMachineType( fn ))
        cerr << "succeeded" << endl;
    else
        cerr << "failed" << endl;

    return 0;
} 
```

# php - 表单和无 Cookie - 提交表单的优雅方式

> ID：197957
> 
> 赞同：0
> 
> 时间：2008-10-13T15:17:52.247
> 
> 标签：php, javascript, html, session

喂！

我有一个想要提交的表单，但我需要添加 PHPSESSID，因为有些客户端不允许使用 cookie。

我的页面上有几个显示用户列表（搜索、排序、打开详细信息）的 javascript 函数，该页面是由 PHP 生成的。

现在我正在寻找一种优雅的方式来让 PHPSESSID 包含在我的表单的每次提交中——这需要在几个页面上完成，所以我希望有一个简单的解决方案。将 PHPSESSID 添加到操作或隐藏字段中无法正常工作。

或者这个问题是否在其他地方？可能是客户端位于限制性太强的防火墙或其他东西后面。也欢迎朝这个方向提出任何想法（尤其是解决方案；-)）！

示例代码（极其简化）：

```
<form name="userlist" method="POST" action="./myuserlist.php">
[...some formfields and stuff..]
</form>

<script>
//one example function, there are several on my page
function next_page()
{
  //set some hidden field to get the next page
  document.forms[0].submit();
}
</script> 
```

提前致谢！

再见，巴斯蒂

**[编辑]** session.use_trans_sid 设置为 true

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T15:21:47.653

使用隐藏字段应该可以工作 - 如果没有，那么 session.use_trans_sid 可能在你的 php.ini 中关闭

您可以将其添加到隐藏字段然后说

```
if (!empty($_POST['PHPSESSID']))
   session_start($_POST['PHPSESSID']);
else
    session_start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T15:30:41.707

当您说将其放入隐藏字段不起作用时，您能详细说明什么不起作用吗？

当面临每个（或很多）表单提交都需要传递一些状态信息的情况时，输入 type=hidden 字段是执行此操作的规范方法。

只是在这里在黑暗中猜测。您是否正在使用 style="display:none" 或类似的方式进行输入？如果是这样，请将其更改为真正的 <input type="hidden"> 标记。许多浏览器不会提交通过 display:none 隐藏的表单字段。

黑暗中的另一个刺：您是否通过javascript将隐藏表单添加到页面？像 foo.innerHTML 调用一样？同样，某些浏览器无法正确处理以这种方式添加到页面的表单字段。您要么需要从一开始就有 sessionid，要么重写处理从服务器返回的数据的 ajax 方法，以通过 dom 操作而不是 innerHTML 插入输入字段。

# flash - Flash 中的 onMouseUp/Down 和 onPress/Release 事件有什么区别？

> ID：197958
> 
> 赞同：3
> 
> 时间：2008-10-13T15:17:52.297
> 
> 标签：flash, events, actionscript, mouse, actionscript-2

在 Flash 中，似乎有两组鼠标点击事件：

*   onMouseUp, onMouseDown
*   onPress, onRelease

这些事件之间有什么实际区别吗？我无法从文档中看出，也没有注意到实际使用中的任何内容，但是对于相同的基本事件有两组不同的名称似乎很奇怪。我错过了什么吗？它们之间有区别吗？

澄清：这是针对 Flash 8 的 ActionScript 2 代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T15:59:43.007

onMouseDown 和 onMouseUp 是任何东西都可以通过 Mouse.addListener() 监听的通用事件。无论在何处单击鼠标，它们都会被触发。

onPress 和 onRelease 特定于特定的 MovieClip。只有当鼠标在该 MovieClip 上被按下或释放时，它们才会被触发。onReleaseOutside 也很重要...对于您在 MovieClip 上单击，然后将鼠标拖动到外部，然后释放鼠标的情况。在这种情况下，不会有 onRelease 事件，只有 onReleaseOutside 事件，所以如果你不听后者，你的程序会认为鼠标按钮卡住了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T01:52:21.813

Press/Release 是*交互*事件，而不是鼠标事件。如果您使用键盘激活按钮或 MC（通过 Tab 键和按空格键），它将触发 Press 事件但不会触发 MouseDown。同样，如果您单击禁用的按钮，则会触发 MouseDown 事件，但不会触发 Press（因为没有发生按钮交互）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T15:21:30.040

不是 Flash 开发人员，但在普通的 Windows 应用程序中，您可以使用空格键按下按钮，然后通过 Enter 键激活它。

此外，MouseUp/Down 可以在任何地方发生，并且可能不暗示任何事情。因此，特定控件上的 Press/Release 具有更大的意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T16:01:12.630

我在谷歌搜索问题时发现了这一点：

[http://www.gogoat.com/2006/07/27/onpress-vs-onmousedown/](http://www.gogoat.com/2006/07/27/onpress-vs-onmousedown/)

看起来即使鼠标在影片剪辑之外，mouseUp/mouseDown 事件*也会*触发，而 onPress/Release 会在处理之前自动检查鼠标是否在剪辑内。我本可以发誓我对此进行了测试，但我只是验证了它，所以我一定没有。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T15:46:10.833

onPress 和 onRelease 是 AS2 代码的保留，它们已被 AS3 中的 onMouseDown 和 onMouseUp 取代，您可以在[AS2 迁移指南](http://livedocs.adobe.com/flex/2/langref/migration.html)中阅读。

# windows - 从 Windows cmd 脚本执行多个命令

> ID：197976
> 
> 赞同：140
> 
> 时间：2008-10-13T15:23:54.747
> 
> 标签：windows, batch-file, scripting, cmd

我正在尝试编写一个 Windows cmd 脚本来连续执行多个任务。但是，它总是在脚本中的第一个命令之后停止。

它停止后的命令是一个 Maven 构建（不确定这是否相关）。

请问如何让它继续运行并依次运行每个任务？

安装任何软件或配置注册表等都是完全不可能的——恐怕它必须在普通的 Windows XP 安装上工作。

理想情况下，如果任何命令失败，我希望脚本中止，但这是“很高兴拥有”，不是必需的。

谢谢。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-10-13T15:31:36.183

当您调用另一个 .bat 文件时，我认为您需要在调用前“调用”：

```
call otherCommand.bat 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-13T15:35:29.483

只有当第一个命令成功时，您才能在命令之间使用 && 符号来执行第二个命令。更多信息在这里[http://commandwindows.com/command1.htm](http://commandwindows.com/command1.htm)

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-13T15:44:42.133

不知道为什么第一个命令正在停止。如果你可以让它平行，你可以尝试类似的东西

```
start cmd.exe /C 1.bat      
start cmd.exe /C 2.bat 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2011-10-21T10:21:16.437

我刚刚做了完全相同的（ish）任务，即创建一个批处理脚本来运行 Maven 测试脚本。问题是使用 mvn clean install 调用 maven scrips ... 本身就是一个脚本，因此需要使用 call mvn clean install 来完成。

可以工作的代码

```
rem run a maven clean install
cd C:\rbe-ui-test-suite 
call mvn clean install
rem now run through all the test scripts
call mvn clean install -Prun-integration-tests -Dpattern=tc-login
call mvn clean install -Prun-integration-tests -Dpattern=login-1 
```

请注意调用的使用。这将允许在批处理文件中使用连续的 Maven 脚本。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-09-23T22:57:16.900

仅当第一个命令成功时，使用双 & 号将运行第二个命令：

```
cd Desktop/project-directory && atom . 
```

其中，即使第一个命令失败，仅使用一个 & 号也会尝试运行这两个命令：

```
cd Desktop/project-directory & atom . 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T15:32:25.667

我不知道你的问题的直接答案，但如果你做了很多这些脚本，可能值得学习一种更强大的语言，比如 perl。Windows 存在免费实现（例如 activestate、cygwin）。我发现为自己的任务付出最初的努力是值得的。

**编辑：**

正如@Ferruccio 所建议的，如果您无法安装额外的软件，请考虑使用 vbscript 和/或 javascript。它们内置于 Windows 脚本主机中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-14T07:55:19.520

如果您在 Windows 中运行，则可以使用以下命令。

驾驶：

```
cd "Script location"
schtasks /run /tn "TASK1"
schtasks /run /tn "TASK2"
schtasks /run /tn "TASK3"
exit 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-25T08:32:48.643

请注意，批处理文件中不需要分号。而需要使用call的原因是mvn本身是一个批处理文件，批处理文件之间需要用call相互调用，否则控制权不会返回给调用者。

# ncover - NCover 没有获取 Web 应用程序 dll

> ID：197977
> 
> 赞同：0
> 
> 时间：2008-10-13T15:24:02.173
> 
> 标签：ncover

我使用的是 NCover 1.5.8，它似乎没有产生与我的网站应用程序相关的指标。ncover 输出表明与网站相关的测试已经运行。

我需要为网站 dll 做些什么特别的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T15:29:18.730

NCover 要求 PDB 文件存在，否则它只是简单地忽略它。

# c++ - 什么是 C++ 中“低级”多线程的基本示例？

> ID：197983
> 
> 赞同：5
> 
> 时间：2008-10-13T15:24:48.147
> 
> 标签：c++, multithreading

我是一个有几年经验的新手开发人员。最近在一家游戏公司面试，被问到“你做过多线程吗？” 我告诉他们有一个带有几个线程的 C# 应用程序......然后我说了一些关于 Sql 中的事务和锁定等。面试官礼貌地告诉我这太高级了，他们正在寻找有C++多线程经验的人。

那么 C++ 中“低级”多线程的基本示例是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T15:28:15.177

“低级线程”的规范实现是[pthreads](http://en.wikipedia.org/wiki/POSIX_Threads)。通常与 pthread 一起教授的线程问题的最基本示例是某种形式的[读写器问题](http://en.wikipedia.org/wiki/Readers-writers_problem)。该页面还链接到更经典的线程问题，例如生产者/消费者和餐饮哲学家。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T17:32:42.243

他可能指的是您对 C# 的使用，而不是您的线程经验。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T02:12:17.840

如果是游戏公司，那么他们可能想要这样的答案：

“我实现了一个多线程 AI 例程，在可用 CPU 资源中为 NPC 分配决策树计算。正确锁定，尤其是在将代码与应用程序的其余部分集成时，是很困难的。我们还花了一些时间跟踪每个线程的资源使用情况因此，当 AI 处理威胁到主 UI 响应时，我们可以限制它。”

（所有这些都是我编造的，我个人实际上并没有做过任何事情。 *咧嘴笑*）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T16:04:33.637

这是一个使用 pthread 的快速示例，基于我们的一些测试代码。它产生两个线程，并等待它们完成。

```
int main( void )
{
  pthread_t reader, writer;
  void *arg;

  // [... initialisation ...]

  // Spawn threads
  if( pthread_create( &reader, NULL, reader_func, arg ) ||
      pthread_create( &writer, NULL, writer_func, arg ) )
    {
      perror( "pthread_create" );
      return EX_OSERR;
    }

  // Wait while threads run
  pthread_join( reader, &arg );
  pthread_join( writer, &arg );

  return EX_OK;
}

void *reader_func( void *arg )
{
  // [... do some stuff ...]
  return NULL;
}

void *writer_func( void *arg )
{
  // [... do some different stuff ...]
  return NULL;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T15:29:30.697

我会看一下[http://zthread.sourceforge.net/](http://zthread.sourceforge.net/)，它是 PThreads 库的优秀包装器。这是一个非常快速和稳定的，可以是相当低级的库。写得很好，有据可查。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T15:37:42.210

老实说，我认为您一直在做的事情和使用 pthreads 之间没有太大区别。如果您已经使用线程完成了大量工作，那么您将遇到锁定、同步等所有问题，并且可以轻松地直接使用 pthreads 调用。你可能已经被隔离的一件有点棘手的事情是终止，从线程中获取退出代码等。

（当然，pthreads 的级别并不低；如果您使用的是 linux，请查看 clone() 以了解它在系统调用级别上的实际工作方式。但除非他们真正使用它，否则没有人真正使用它重新实现 pthreads。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T17:12:06.760

好吧，如果您真的想将这个想法发挥到“最大”，并且愿意用线程弄脏您的手。我建议尝试实现一个用户空间线程库。

查看 uconext.h 及其各种过程（setcontext、swapcontext 和 makecontext）并尝试用它们编写一个简单的协作线程库。实现锁、条件变量线程创建/销毁和合作让步。它不会特别花哨（即实际上没有并行性（因为你需要深入研究克隆系统调用或内核）但如果你能做到，没有人会说你没有低水平经验。

只是为了了解项目的规模。我用大约 500 行 C++ 编写了这么一个简单的线程库，并且考虑到其中至少 20% 是用于调试目的的注释、断言语句和日志记录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T21:17:05.753

此外， [Boost Threads](http://www.boost.org/doc/libs/1_36_0/doc/html/thread.html)是 pthreads 和 Windows 线程的相当便携的包装器……据我所知，许多游戏开发商店都使用 C++，并且喜欢一些 Boost 库。

# java - 是什么导致 javac 发出“使用未经检查或不安全的操作”警告

> ID：197986
> 
> 赞同：327
> 
> 时间：2008-10-13T15:27:28.920
> 
> 标签：java, generics, warnings

例如：

```
javac Foo.java
Note: Foo.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details. 
```

* * *

## 回答 #1

> 赞同：427
> 
> 时间：2008-10-13T15:29:56.403

如果您使用没有类型说明符的集合（例如，`Arraylist()`而不是`ArrayList<String>()`），这会出现在 Java 5 及更高版本中。这意味着编译器无法检查您是否使用[泛型](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)以类型安全的方式使用集合。

要消除警告，只需具体说明您在集合中存储的对象类型。所以，而不是

```
List myList = new ArrayList(); 
```

采用

```
List<String> myList = new ArrayList<String>(); 
```

* * *

[在 Java 7 中，您可以使用Type Inference](http://docs.oracle.com/javase/7/docs/technotes/guides/language/type-inference-generic-instance-creation.html)来缩短泛型实例化。

```
List<String> myList = new ArrayList<>(); 
```

* * *

## 回答 #2

> 赞同：219
> 
> 时间：2008-10-13T15:48:36.883

如果您按照它的建议进行操作并使用“-Xlint:unchecked”开关重新编译，它将为您提供更详细的信息。

除了使用原始类型（如其他答案所述）外，未经检查的强制转换也可能导致警告。

使用 -Xlint 编译后，您应该能够重新编写代码以避免出现警告。这并不总是可行的，尤其是当您与无法更改的遗留代码集成时。在这种情况下，您可以决定在您知道代码正确的地方取消警告：

```
@SuppressWarnings("unchecked")
public void myMethod()
{
    //...
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2018-11-12T15:21:18.980

对于 Android Studio，您需要添加：

```
allprojects {

    gradle.projectsEvaluated {
        tasks.withType(JavaCompile) {
            options.compilerArgs << "-Xlint:unchecked"
        }
    }

    // ...
} 
```

在项目的 build.gradle 文件中了解此错误的产生位置。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-05-28T10:19:34.050

此警告意味着您的代码在原始类型上运行，请使用

```
-Xlint:unchecked 
```

获取详细信息

像这样：

```
javac YourFile.java -Xlint:unchecked

Main.java:7: warning: [unchecked] unchecked cast
        clone.mylist = (ArrayList<String>)this.mylist.clone();
                                                           ^
  required: ArrayList<String>
  found:    Object
1 warning 
```

docs.oracle.com 在这里谈论它：http: [//docs.oracle.com/javase/tutorial/java/generics/rawTypes.html](http://docs.oracle.com/javase/tutorial/java/generics/rawTypes.html)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-09-25T12:54:10.953

我有 2 年的旧课程和一些新课程。我在Android Studio中解决了如下：

```
allprojects {

    gradle.projectsEvaluated {
        tasks.withType(JavaCompile) {
            options.compilerArgs << "-Xlint:unchecked"
        }
    }

} 
```

在我的项目 build.gradle 文件中（[Borzh 解决方案](https://stackoverflow.com/users/1223728/borzh)）

然后如果留下一些方法：

```
@SuppressWarnings("unchecked")
public void myMethod()
{
    //...
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-13T15:31:37.073

例如，当您调用返回泛型集合的函数并且您自己没有指定泛型参数时。

对于一个函数

```
List<String> getNames()

List names = obj.getNames(); 
```

会产生这个错误。

要解决它，您只需添加参数

```
List<String> names = obj.getNames(); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-13T15:31:54.683

如果我没记错的话，当 java 添加[Generics时添加了“未经检查或不安全的操作”警告。](http://java.sun.com/docs/books/tutorial/java/generics/index.html)它通常要求您以一种或另一种方式更明确地说明类型。

例如。该代码`ArrayList foo = new ArrayList();`触发了该警告，因为 javac 正在寻找`ArrayList<String> foo = new ArrayList<String>();`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-04-07T22:12:12.810

我只想添加一个我经常看到的未经检查的警告示例。如果您使用实现像 Serializable 这样的接口的类，您通常会调用返回接口对象的方法，而不是实际的类。如果返回的类必须转换为基于泛型的类型，您会收到此警告。

这是一个简短（有点愚蠢）的示例来演示：

```
import java.io.Serializable;

public class SimpleGenericClass<T> implements Serializable {

    public Serializable getInstance() {
        return this;
    }

    // @SuppressWarnings("unchecked")
    public static void main() {

        SimpleGenericClass<String> original = new SimpleGenericClass<String>();

        //  java: unchecked cast
        //    required: SimpleGenericClass<java.lang.String>
        //    found:    java.io.Serializable
        SimpleGenericClass<String> returned =
                (SimpleGenericClass<String>) original.getInstance();
    }
} 
```

getInstance() 返回一个实现 Serializable 的对象。这必须转换为实际类型，但这是未经检查的转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-18T12:48:52.140

解决方案是在`<>`like中使用特定类型`ArrayList<File>`。

例子：

```
File curfolder = new File( "C:\\Users\\username\\Desktop");
File[] file = curfolder.listFiles();
ArrayList filename = Arrays.asList(file); 
```

上面的代码生成警告，因为`ArrayList`不是特定类型。

```
File curfolder = new File( "C:\\Users\\username\\Desktop");
File[] file = curfolder.listFiles();
ArrayList<File> filename = Arrays.asList(file); 
```

上面的代码会很好。唯一的变化是在第三行之后`ArrayList`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-19T07:06:41.037

您可以将其保留为通用形式并将其写为：

```
// list 2 is made generic and can store any type of Object
        ArrayList<Object> list2 = new ArrayList<Object>(); 
```

将 ArrayList 的类型设置为 Object 使我们能够存储任何类型的数据。您不需要使用 -Xlint 或其他任何东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-05T05:05:06.070

此警告也可能因

**泛型类型的new HashMap()** 或 new ArrayList() 必须是特定的，否则编译器将生成警告。

请确保如果您的代码包含以下内容，则必须进行相应更改

```
new HashMap() => Map<String,Object> map = new HashMap<String,Object>()
new HashMap() => Map<String,Object> map = new HashMap<>()

new ArrayList() => List<String,Object> map = new ArrayList<String,Object>()
new ArrayList() => List<String,Object> map = new ArrayList<>() 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-23T09:55:48.913

我有`ArrayList<Map<String, Object>> items = (ArrayList<Map<String, Object>>) value;`。因为`value`是一个复杂的结构（我想[清理 JSON](https://stackoverflow.com/a/54709501/2914140)），所以可以在数字、布尔值、字符串、数组上发生任何组合。所以，我使用了@Dan Dyer 的解决方案：

```
@SuppressWarnings("unchecked")
ArrayList<Map<String, Object>> items = (ArrayList<Map<String, Object>>) value; 
```

# c++ - 多个可互换视图 (MFC/C++)

> ID：197987
> 
> 赞同：1
> 
> 时间：2008-10-13T15:27:37.610
> 
> 标签：c++, view, mfc, document, csplitterwnd

我有一个带分离器的主框架。在左边我有我的（想象地命名）CAppView_Left，在右边我有 CAppView_Right_1 和 CAppView_Right_2。通过以下代码，我正确初始化了两个主要视图：

```
if (!m_wndSplitter.CreateStatic(this, 1, 2))
{
    TRACE0("Failed to CreateStaticSplitter\n");
    return FALSE;
}
else 
if (!m_wndSplitter.CreateView(0, 0, RUNTIME_CLASS(CAppView_Left), CSize(300, 200), pContext))
{
    TRACE0("Failed to create left pane\n");
    return FALSE;
}
else 
if (!m_wndSplitter.CreateView(0, 1, RUNTIME_CLASS(CAppView_Right_1), CSize(375, 200), pContext))
{
    TRACE0("Failed to create first right pane\n");
    return FALSE;
} 
```

...

我想做的是在右框架内创建第二个视图，但是当我尝试添加这个时：

```
if (!m_wndSplitter.CreateView(0, 1, RUNTIME_CLASS(CAppView_Right_2), CSize(375, 200), pContext))
{
    TRACE0("Failed to create first right pane\n");
    return FALSE;
} 
```

VS 编译但无法运行应用程序，引发异常，告诉我我已经定义了视图。

有人可以建议我怎么做吗？另外，如何在视图或文档类的视图之间进行更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:14:48.160

有一篇 CodeProject 文章可以帮助你实现你想要的：

[http://www.codeproject.com/KB/splitter/usefulsplitter.aspx](http://www.codeproject.com/KB/splitter/usefulsplitter.aspx)

我之前已经在拆分器中替换了视图，所以如果上面没有帮助，我会发布一些我自己的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T16:14:22.273

您无法创建第二个右手视图，因为您的

```
m_wndSplitter.CreateStatic(this, 1, 2) 
```

只创建了两列。您可以将其更改为

```
m_wndSplitter.CreateStatic(this, 1, 3) 
```

并将您的第二个右视图更改为

```
if (!m_wndSplitter.CreateView(0, 2, RUNTIME_CLASS(CAppView_Right_2), CSize(375, 200), pContext))
{    
TRACE0("Failed to create first right pane\n");   
 return FALSE;
} 
```

这会产生三列，每列都有一个单独的视图。您还可以创建一个额外的拆分器窗口来拆分现有视图之一，例如

```
m_wndSplitter2.CreateStatic(m_View2, 2, 1) 
```

m_view2 是您的第二个视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T17:32:14.053

要在视图之间切换，您需要在创建另一个视图之前显式删除视图。

如果需要保留可互换视图的状态，最好让视图能够从文档中初始化它们的状态。小心使用需要在删除和重新创建其中一个视图之间停留的任何状态来更新文档。

# c++ - 需要关于实施限时试验的建议

> ID：197999
> 
> 赞同：22
> 
> 时间：2008-10-13T15:31:41.487
> 
> 标签：c++, desktop, shareware, trialware, time-trial

我正在开发一个共享软件桌面应用程序。我到了需要实施试用/激活代码的地步。你如何处理这样的事情？我有自己的想法，但我想看看stackoverflow社区是怎么想的。

我正在使用 C++/Qt 进行开发。预期平台是 Windows/Mac/Linux。

谢谢你的建议！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-13T15:38:48.227

**什么可以预防和什么不可以预防：**

请记住，人们总会想办法绕过您的试用期。因此，您想让该人不得不绕过您的试用期而烦恼，但如果无法绕过您的试用期也没关系。

如果有一个简单的机制，大多数人会认为尝试绕过试用期的工作量太大。例如，人们总是可以使用 filemon/regmon 来查看安装软件时哪些文件和注册表项发生了变化。

话虽如此，一个简单的机制是最好的，因为它浪费的时间更少。

**这里有一些想法：**

*   您可以在注册表中的某处为运行的每个独特日期进行滴答计数。如果滴答计数 > 30，则向他们显示过期消息。
*   您可以存储安装日期，但请检查他们是否有比您的试用期更多的可用天数，然后告诉他们它们已过期。这将防止人们在安装到未来日期之前更改日期。
*   我建议您进行卸载，删除您的“运行天数”计数。这是因为人们可能会在几个月后重新评估您的产品并最终购买。但如果他们无法评估它，他们就不会购买。没有认真的用户有时间卸载/重新安装只是为了额外使用您的产品。

**延长试验：**

对我们来说，当客户请求延期试用时，我们会向他们发送一封自动电子邮件，其中包含程序“TrialExtend.exe”和试用延期代码。该程序使用试用扩展代码与我们的服务器联系以对其进行验证。如果代码通过验证，则其试用期将被重置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T15:35:54.630

无论您做什么，请密切关注系统日期。书中最古老的技巧是在未来的某个时间安装应用程序，然后在应用程序在首次运行时存储愚蠢的日期后返回实际日期。也许将密钥与在线存储库同步？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T23:59:06.743

布赖恩的回答很好，但我想补充一点。

Linux 用户通常不习惯为软件付费，他们往往更精通技术，甚至可能在开源问题上“信奉宗教”。

出于这个原因，我真的建议保持简单 - 这实际上只是一个小障碍，让购买软件至少像窃取它一样容易。

我建议它在试用期后唠叨或禁用某些功能（例如保存），而不是完全死掉。只是一个观察，但基于功能的限制在 linux 世界中似乎更常见。

顺便说一句，使 linux 版本成为“一流”版本 - 体面的安装程序等会有所帮助。

如果您相对较小，或者您的程序相对小众，那么任何人都会费心破解它的可能性很小 - 所以一旦时间到了，只需专注于制作一个简单的好产品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:37:27.310

如果您 [相当] 可能有网络连接，您可以让安装程序在您的网站上注册，然后在每次启动时检查它。

如果这不可行，则将值写入文件系统上的全局可修改点（注册表项、/etc conf 文件中的项等）可能是可行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T01:15:14.700

也许真正的问题是限时试用。我工作的公司做了大量的 Active Directory 工作，我们通常将我们的软件限制在少数用户的试用版中。我觉得以某种方式限制功能有时会更好，更容易实现，并且当用户只是更改计算机上的日期时不会失败。
有一种平衡行为，你不能太严格地限制功能，否则用户在试用中什么也得不到。同时，过于宽松的限制也不会激励购买。***************************