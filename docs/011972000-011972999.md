# StackOverflow 问答 11972000-11972999

# jquery - jQuery color picker does not pop up after any server-side event is raised

> ID：11972007
> 
> 赞同：0
> 
> 时间：2012-08-15T15:12:13.880
> 
> 标签：jquery, asp.net

I am working with a jQuery color picker.

```
var colorCode = '<%=ConfigurationManager.AppSettings["colorCode"]%>';

$(function () {
    $('#color3').colorPicker({ 
        pickerDefault: "ffffff", 
        colors: [colorCode], 
        transparency: true 
    });
}); 
```

There is an input text control. Whenever the focus is on that control, a color palette will get displayed and the color can be selected. This was working fine.

I had a checkbox in the same page, and when I check that, a checked changed event will get raised. After this event, the jQuery color picker is not working, i.e. whenever the server side event raised the jQuery color picker is not working.

How can I fix this?

# .net - Passing encrypted IDs in query strings

> ID：11972008
> 
> 赞同：0
> 
> 时间：2012-08-15T15:12:15.243
> 
> 标签：.net, url, aes

I am building a .Net app that effectively has news articles, some of which are available publicly and some of which are only available when you're logged in.

The URL to each article needs to include the article's ID in some way and until now I've been using AES to encrypt the article ID, using the user's ID as the 'shared secret' and an 8 digit string as salt.

e.g. /article.aspx?id=EvEAAAACtp2iEc7lKyJSu6382Ryl4k571L5/PQrJYY1JJfeq4F

The problem is that if the user views an article while logged in, they won't be able to copy the URL and send it on to anyone else as it won't work with another user's ID or with a non-logged-in user.

What's the right approach for including IDs in query strings (or anywhere else for that matter) when they need to be shared among known/unknown users?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:17:16.657

以明文形式传递查询字符串上的 id 并让 Web 服务器检查客户端是否有足够的凭据来阅读该文章并做出适当的反应不是更安全吗？它甚至可以返回相关的 HTTP 状态码 (401) 表示您需要登录，或者返回 403 表示您看不到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:15:14.130

执行此操作的一种常见方法是使用“链接”或“共享”按钮生成某人可以通过电子邮件发送的链接。

# matlab - 如何将.txt文件中的字符串与Matlab中的工作区进行比较

> ID：11972013
> 
> 赞同：0
> 
> 时间：2012-08-15T15:12:30.483
> 
> 标签：matlab, text-files, workspace

我有一个这样的 .txt 文件：

```
structure
a = title
c1 = A.B.C
endstructure 
```

我想把它读到matlab，然后检查我的工作区中是否已经存在一个名为ABC的结构，如果存在，那么我想把这个结构中的数据保存到变量c1中。我在正确解析行 c1 = ABC 然后将其与工作区进行比较时遇到问题。任何帮助表示赞赏。

*   *   *   *   *   *   *   解释 - - - - - - 在我的工作空间中有一个结构 ABC = [0 1 2 3 5 8] 在我的 txt 文件中我写了 c1 = ABC，这就是名字。我想在我的程序中检查此名称是否与工作区中具有此名称的一些现有数据匹配。如果是这样，则将此数据分配给变量 c1 并将 c1 留在工作区中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:31:24.603

要确定您的变量是否已存在于 Matlab 工作区中，您可以使用 matlab 的[存在](http://www.mathworks.com/help/techdoc/ref/exist.html)函数。在您的情况下会有点尴尬，因为您只能检查变量“A”是否存在。然后您可以进一步嵌套它并查看变量是否具有指定的字段。它可能看起来像这样：

```
if( exist('A','var') && isfield(A,'B') && isfield(A.B,'C') )
     %do something
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:42:06.387

您可以在“=”符号的右侧使用带有表达式的[`evalin`](http://www-rohan.sdsu.edu/doc/matlab/techdoc/ref/evalin.html)语法。`evalin('base',expression,catch_expr)`它不是很有效，但它避免了你必须解析结构名称。在`catch_expr`你可以设置一个标志告诉不要做任务。

之后使用`assignin`它来分配'c1'中的值。'c1' 是此处的字符串，因此很容易将其放入具有不同名称的循环中。

# jquery - 如何动态添加另一个人

> ID：11972018
> 
> 赞同：1
> 
> 时间：2012-08-15T15:12:39.827
> 
> 标签：jquery, html

我正在开发一个注册网站，其中有一部分我需要添加人员。我所做的是，当他们单击该人的姓名和姓氏下方的文本时，会出现另外两个字段（再次询问姓名和该人，因此它是上述字段的副本）。这是我使用`clone()`方法来做的。因此，假设姓名和姓氏在一个 div 中，其中有一个名为“信息”的类。并且在`<p>`包含时添加额外 div 的 id 称为：“add”。像这样：

```
<div class="information">
<label for="name">Name</label>
<input type="text" name="name[]"> //it's an array because there's gonna be probably more than one (if they click the "add" text)
<label for="last_name">Last Name</label>
<input type="text" name="last_name[]">
</div>
<p id="add">Add another person</p> 
```

我的 javascript (jquery) 如下：

```
$('#add').click(function(){
    $('.information').clone().insertAfter('.information');
}); 
```

这样做的问题是，当您单击添加文本时，它会复制第一个 div（如果您在上面写了一些东西，它也会复制它）。那我该如何解决。还有其他方法吗？另外，是否有任何简单的方法可以让按钮消失“信息”div（以防用户后悔他想添加多少人）。

任何建议都会受到好评。提前致谢。

**编辑**：对不起，伙计们。有件很重要的事我忘了说。仅当用户单击复选框时才会显示信息类（因为他们可能不希望添加任何其他人。因此，这里是复选框的代码：

HTML（在信息类之上）：

```
<input type="checkbox" id="companion" />Companion 
```

查询：

```
$("#companion").click(function() {
     $(".information").toggle();
     if ($('#companion').is(":checked")) {
        $('#add').show();
     }
     else {
        $('.companion').hide();
        $('.companion').removeAttr('checked');
    }
}); 
```

我澄清这一点是因为我尝试了你们向我展示的示例，但是当我单击复选框时，信息 div 不显示。我应该在我的原始帖子中提到这一点。真的很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:17:55.673

您可以使用`:last`and`:first`选择器，尝试以下操作：

```
$('#add').click(function(){
    $('.information:first').clone().insertAfter('.information:last');
    $('.information:last').find('input').val('');
});

$('#remove').click(function(){
    if ($('.information').length > 1) {
       $('.information:last').remove()
    }
}) 
```

```
<p id='remove'>remove<p> 
```

[小提琴](http://jsfiddle.net/SnE6Y/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:18:39.200

我会稍微改变它，并像这个**[jsFiddle 示例](http://jsfiddle.net/j08691/dDHML/2/)**那样做。

这允许您添加人员并删除您添加的任何新人员，同时始终只留下第一个人。

**HTML**

```
<div id="information">
<label for="name">Name</label>
<input type="text" name="name[]"> 
<label for="last_name">Last Name</label>
<input type="text" name="last_name[]">
</div>
<p id="add">Add another person</p>​ 
```

**jQuery**

```
$('#add').click(function() {
    $('#information').clone().find("input:text").val("").end().append('<span class="remove">remove</span>').removeAttr('id').insertBefore('#add');

});
$('body').on('click', '.remove', function() {
    $(this).parent('div').remove();
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:12:41.533

与其克隆最后一个 div（因为里面有内容），我认为最好将 .information 的内容存储在一个变量中（称之为“内容”）。然后在页面加载时，您可以调用您的“内容”，在添加时，您可以调用“内容”。

如果你愿意，你可以在 .information div 中创建一个按钮，并给它一个点击函数来删除 .information div 的这个实例。

# asp.net-mvc - 具有跨应用程序的表单身份验证的 ServiceStack 失败...为什么？

> ID：11972020
> 
> 赞同：5
> 
> 时间：2012-08-15T15:12:43.117
> 
> 标签：asp.net-mvc, forms-authentication, servicestack

我有一个在 api.mydomain.com 上运行 API 的 ServiceStack 项目。同一解决方案中的管理项目托管在 admin.mydomain.com。登录/注销已由管理应用程序处理，但我想确保用户在我的 api 调用中经过身份验证（有时还要检查权限）。我正在[跨项目使用表单身份验证，](http://msdn.microsoft.com/en-us/library/eb0zx8fc.aspx)因此身份验证 cookie 可用于我的 api 项目。

这是我在 api 项目中的 web.config 身份验证标签：

```
<authentication mode="Forms">
  <forms protection="All" loginUrl="home/denied" slidingExpiration="true" timeout="60" defaultUrl="home/denied" path="/" domain="mydomain.com" name=".myAuth"></forms>
</authentication> 
```

基于此[Authentication and authorization post](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)，我向服务方法添加了一个 [Authenticate] 属性，期望它根据 IsAuthenticated 的值通过/失败。但是，它每次都重定向到“home/denied”，无论是否存在 auth cookie。（我通过继承 AuthenticateAttribute 并检查 OriginalRequest 确认了这一点......当我使用管理应用程序登录时设置的 cookie 存在并且 req.OriginalRequest.IsAuthenticated 为真。）

为什么我的请求被重定向，以及如何正确利用管理应用程序中设置的现有身份验证凭据？

**编辑：**这是我想出的解决方案。它只需要一个 IPrincipal 身份来通过身份验证。

```
public class AuthenticateAspNetAttribute : RequestFilterAttribute
{
    public override void Execute(IHttpRequest req, IHttpResponse res, object requestDto)
    {
        SessionFeature.AddSessionIdToRequestFilter(req, res, null); //Required to get req.GetSessionId()

        using (var cache = req.GetCacheClient())
        {
            var sessionId = req.GetSessionId();
            var session = sessionId != null ? cache.GetSession(sessionId) : null;
            var originalRequest = (System.Web.HttpRequest) req.OriginalRequest;
            var identity = originalRequest.RequestContext.HttpContext.User.Identity;
            if (!identity.IsAuthenticated)
                AuthProvider.HandleFailedAuth(new BasicAuthProvider(), session, req, res);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:51:55.013

在您引用的[身份验证和自动化帖子上，它显示为：](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)

> ServiceStack 的身份验证、缓存和会话提供程序是全新的、干净的、无依赖关系的可测试 API，不依赖也没有 ASP.NET 现有的成员资格、缓存或会话提供程序模型。

这意味着它是完全独立的，与 ASP.NET 现有的身份验证提供程序无关。即客户端需要对服务进行显式调用以`/auth`使用 ServiceStack Web 服务进行身份验证。

有关在 MVC 控制器和 ServiceStack Web 服务之间使用和共享 ServiceStack 身份验证提供程序的 MVC 网站示例，请参阅[SocialBootstrapApi](https://github.com/ServiceStack/SocialBootstrapApi)示例演示项目。

# c# - how to create an unbound column relate to a foreign key inside a grid

> ID：11972021
> 
> 赞同：0
> 
> 时间：2012-08-15T15:12:44.227
> 
> 标签：c#, winforms, devexpress, xtragrid

i would like to create dynamically an unbound column in an Xtragrid control devexpress ; there is the scenario : i have a grid bound with data from Payment Datatable , fields are " Payment_ID , Customer_ID " so on and so forth , what i would like to do is , instead of having Customer_ID which is the foreign in this table , i want to have in it ,Customer_Name related to Customer_ID , to avoid confusion . someone Help Thanks(using winforms C#). below code used ; to populate the grid

```
 using System;
          using System.Collections.Generic;
          using System.ComponentModel;
          using System.Drawing;
          using System.Data;
          using System.Linq;
          using System.Text;
          using System.Windows.Forms;
          using System.Data.SqlClient;

          namespace YoungWoman
            {
               public partial class Payment2 : UserControl
                   {
                          DataSet ds3 = new DataSet();
                          SqlDataAdapter dapayment = new SqlDataAdapter();
                          SqlConnection conne = SqlCoonectionSEtup.GetConnection;
                          BindingSource PaymentBinding = new BindingSource();

               public Payment2()
                {
                   InitializeComponent();
                }

               private void AddPayment_Click(object sender, EventArgs e)
            {
               Paymentfrm payent = new Paymentfrm(Utils.Formtype.add, 0);
               payent.PaymentEvent += new EventHandler(RefreshingGrid);
               payent.PayentlabelsEvent += new EventHandler(RefresHlabels);

               payent.ShowDialog();

            }

               private void EditPayment_Click(object sender, EventArgs e)
              {
                 Paymentfrm pyt = new Paymentfrm(Utils.Formtype.edit, 1);
               pyt.ShowDialog();
              }
                   void RefreshingGrid(object sender, EventArgs e)
             {
                  ds3.Tables["tblPaymentYW"].Clear();
                  SqlCommand cmd = new SqlCommand("SELECT * FROM PaymentYW", conne);

                       dapayment.SelectCommand = cmd;
                        dapayment.Fill(ds3, "tblPaymentYW");
                        DgPaymentYW.DataSource = ds3.Tables["tblPaymentYW"];
                        DgPaymentYW.RefreshDataSource();
             }
    void RefresHlabels(object sender, EventArgs e)
    {
        LoadData();
    }

    private void Payment2_Load(object sender, EventArgs e)
    {
        LoadData();

    }

    private void LoadData()
    {
        SqlCommand cmd = new SqlCommand("SELECT *FROM PaymentYW ORDER BY PaymentId ", conne);
        dapayment.SelectCommand = cmd;
        ds3.Clear();
        dapayment.Fill(ds3, "tblPaymentYW");
        PaymentBinding.DataSource = ds3.Tables["tblPaymentYW"];
        DgPaymentYW.DataSource = PaymentBinding;

        this.PaymentIdlabelContro.DataBindings.Clear();
        this.PaymentIdlabelContro.DataBindings.Add(new Binding("Text", PaymentBinding, "PaymentId"));
        ReservationIdlabelControl.DataBindings.Clear();
        this.ReservationIdlabelControl.DataBindings.Add(new Binding("Text", PaymentBinding, "ReservationId"));
        LesseeIdlabelControl.DataBindings.Clear();
        this.LesseeIdlabelControl.DataBindings.Add(new Binding("Text", PaymentBinding, "LesseeId"));

        DatelabelControl.DataBindings.Clear();

        this.DatelabelControl.DataBindings.Add(new Binding("Text", PaymentBinding, "PaymentDate"));
        AmountlabelControl.DataBindings.Clear();
        this.AmountlabelControl.DataBindings.Add(new Binding("Text", PaymentBinding, "AmountPaid"));
        BalancelabelControl.DataBindings.Clear();
        this.BalancelabelControl.DataBindings.Add(new Binding("Text", PaymentBinding, "Balance"));
        gridView1.Columns[1].Visible = false;
        gridView1.Columns[6].Visible = false;

        DevExpress.Utils.FormatInfo fi = new DevExpress.Utils.FormatInfo();
        fi.FormatType = DevExpress.Utils.FormatType.Numeric;
        fi.FormatString = "c2";
        gridView1.Columns[5].DisplayFormat.Assign(fi);
        gridView1.Columns[4].DisplayFormat.Assign(fi);
        Rowcount();
        Priveleges();

    }

    void Rowcount()
    {
        RecordlabelControl.Text = " Records : " + (gridView1.RowCount);

    }
    void Priveleges()
    {
        if (SqlCoonectionSEtup.Priveleges == "User")
        {
            AddPayment.Enabled = false;
            EditPayment.Enabled = false;
            CancelBtn.Enabled = false;
        }
        else
        {

            AddPayment.Enabled = true;
            EditPayment.Enabled = true;
            CancelBtn.Enabled = true;

        }
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:22:56.160

在您的 Select 语句中，您能否将 PaymentYW 表与 customer_ID 字段上的 Customer 表连接起来？然后所有客户字段都将可用，您可以在 DataGrid 中包含 Customer_Name 列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T06:58:07.197

如果我的理解是正确的，您希望显示等效的 customer_name 来代替 customner_id。您可以通过使用**RepositoryItemLookUpEdit**来实现此行为。

首先将 repositoryItemLookUpEdit 作为列编辑器添加到使用“Customer_ID”映射的列

从客户表中获取客户信息并将其分配给 repositoryItemLookUpEdit 数据源。

`"Select Customer_ID,Customer_Name from Customers"`- 像这样您可以获得您的客户详细信息。

为 id(Customer_ID) 和 name(Customer_Name) 将两列添加到 repositoryItemLookUpEdit，并为它们提供适当的字段名称。将“Customer_ID”字段作为**值成员**，将“Customer_name”字段作为**显示成员**分配给 repositoryItemLookUpEdit。这将满足您的要求。

为了获得更好的展示效果，您可以在 repositoryItemLookUpEdit 中将 id 列的可见性设为 false。

# javascript - Delaying AngularJS route change until model loaded to prevent flicker

> ID：11972026
> 
> 赞同：321
> 
> 时间：2012-08-15T15:12:59.057
> 
> 标签：javascript, angularjs, angularjs-routing

I am wondering if there is a way (similar to Gmail) for AngularJS to **delay showing a new route until after each model and its data has been fetched** using its respective services.

For example, if there were a `ProjectsController` that listed all Projects and `project_index.html` which was the template that showed these Projects, `Project.query()` would be fetched completely before showing the new page.

Until then, the old page would still continue to show (for example, if I were browsing another page and then decided to see this Project index).

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2012-08-15T15:12:59.057

[$routeProvider](http://docs.angularjs.org/api/ngRoute.$routeProvider) [resolve](http://docs.angularjs.org/api/ngRoute.$routeProvider) property allows delaying of route change until data is loaded.

First define a route with `resolve` attribute like this.

```
angular.module('phonecat', ['phonecatFilters', 'phonecatServices', 'phonecatDirectives']).
  config(['$routeProvider', function($routeProvider) {
    $routeProvider.
      when('/phones', {
        templateUrl: 'partials/phone-list.html', 
        controller: PhoneListCtrl, 
        resolve: PhoneListCtrl.resolve}).
      when('/phones/:phoneId', {
        templateUrl: 'partials/phone-detail.html', 
        controller: PhoneDetailCtrl, 
        resolve: PhoneDetailCtrl.resolve}).
      otherwise({redirectTo: '/phones'});
}]); 
```

notice that the `resolve` property is defined on route.

```
function PhoneListCtrl($scope, phones) {
  $scope.phones = phones;
  $scope.orderProp = 'age';
}

PhoneListCtrl.resolve = {
  phones: function(Phone, $q) {
    // see: https://groups.google.com/forum/?fromgroups=#!topic/angular/DGf7yyD4Oc4
    var deferred = $q.defer();
    Phone.query(function(successData) {
            deferred.resolve(successData); 
    }, function(errorData) {
            deferred.reject(); // you could optionally pass error data here
    });
    return deferred.promise;
  },
  delay: function($q, $defer) {
    var delay = $q.defer();
    $defer(delay.resolve, 1000);
    return delay.promise;
  }
} 
```

Notice that the controller definition contains a resolve object which declares things which should be available to the controller constructor. Here the `phones` is injected into the controller and it is defined in the `resolve` property.

The `resolve.phones` function is responsible for returning a promise. All of the promises are collected and the route change is delayed until after all of the promises are resolved.

Working demo: [http://mhevery.github.com/angular-phonecat/app/#/phones](http://mhevery.github.com/angular-phonecat/app/#/phones) Source: [https://github.com/mhevery/angular-phonecat/commit/ba33d3ec2d01b70eb5d3d531619bf90153496831](https://github.com/mhevery/angular-phonecat/commit/ba33d3ec2d01b70eb5d3d531619bf90153496831)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-09-10T23:43:56.440

这是一个适用于 Angular 1.0.2 的最小工作示例

模板：

```
<script type="text/ng-template" id="/editor-tpl.html">
    Editor Template {{datasets}}
</script>

<div ng-view>

</div> 
```

JavaScript：

```
function MyCtrl($scope, datasets) {    
    $scope.datasets = datasets;
}

MyCtrl.resolve = {
    datasets : function($q, $http) {
        var deferred = $q.defer();

        $http({method: 'GET', url: '/someUrl'})
            .success(function(data) {
                deferred.resolve(data)
            })
            .error(function(data){
                //actually you'd want deffered.reject(data) here
                //but to show what would happen on success..
                deferred.resolve("error value");
            });

        return deferred.promise;
    }
};

var myApp = angular.module('myApp', [], function($routeProvider) {
    $routeProvider.when('/', {
        templateUrl: '/editor-tpl.html',
        controller: MyCtrl,
        resolve: MyCtrl.resolve
    });
});​
​ 
```

[http://jsfiddle.net/dTJ9N/3/](http://jsfiddle.net/dTJ9N/3/)

**精简版：**

由于 $http() 已经返回了一个 promise（又名 deferred），我们实际上不需要创建我们自己的。所以我们可以简化MyCtrl。决心：

```
MyCtrl.resolve = {
    datasets : function($http) {
        return $http({
            method: 'GET', 
            url: 'http://fiddle.jshell.net/'
        });
    }
}; 
```

$http() 的结果包含*data*、*status*、*headers*和*config*对象，所以我们需要将 MyCtrl 的 body 更改为：

```
$scope.datasets = datasets.data; 
```

[http://jsfiddle.net/dTJ9N/5/](http://jsfiddle.net/dTJ9N/5/)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-03-14T19:11:38.267

我看到有人问如何使用 angular.controller 方法和缩小友好的依赖注入来做到这一点。由于我刚刚开始这项工作，我觉得有必要回来提供帮助。这是我的解决方案（取自原始问题和米斯科的回答）：

```
angular.module('phonecat', ['phonecatFilters', 'phonecatServices', 'phonecatDirectives']).
  config(['$routeProvider', function($routeProvider) {
    $routeProvider.
      when('/phones', {
        templateUrl: 'partials/phone-list.html', 
        controller: PhoneListCtrl, 
        resolve: { 
            phones: ["Phone", "$q", function(Phone, $q) {
                var deferred = $q.defer();
                Phone.query(function(successData) {
                  deferred.resolve(successData); 
                }, function(errorData) {
                  deferred.reject(); // you could optionally pass error data here
                });
                return deferred.promise;
             ]
            },
            delay: ["$q","$defer", function($q, $defer) {
               var delay = $q.defer();
               $defer(delay.resolve, 1000);
               return delay.promise;
              }
            ]
        },

        }).
      when('/phones/:phoneId', {
        templateUrl: 'partials/phone-detail.html', 
        controller: PhoneDetailCtrl, 
        resolve: PhoneDetailCtrl.resolve}).
      otherwise({redirectTo: '/phones'});
}]);

angular.controller("PhoneListCtrl", [ "$scope", "phones", ($scope, phones) {
  $scope.phones = phones;
  $scope.orderProp = 'age';
}]); 
```

由于此代码源自问题/最流行的答案，因此未经测试，但如果您已经了解如何制作缩小友好的角度代码，它应该会向您发送正确的方向。我自己的代码不需要的一个部分是将“电话”注入到“电话”的解析函数中，我也根本没有使用任何“延迟”对象。

我还推荐这个 youtube 视频[http://www.youtube.com/watch?v=P6KITGRQujQ&list=UUKW92i7iQFuNILqQOUOCrFw&index=4&feature=plcp](http://www.youtube.com/watch?v=P6KITGRQujQ&list=UUKW92i7iQFuNILqQOUOCrFw&index=4&feature=plcp)，这对我帮助很大

如果你感兴趣，我决定也粘贴我自己的代码（用咖啡脚本编写），这样你就可以看到我是如何让它工作的。

仅供参考，我提前使用了一个通用控制器来帮助我在几个模型上进行 CRUD：

```
appModule.config ['$routeProvider', ($routeProvider) ->
  genericControllers = ["boards","teachers","classrooms","students"]
  for controllerName in genericControllers
    $routeProvider
      .when "/#{controllerName}/",
        action: 'confirmLogin'
        controller: 'GenericController'
        controllerName: controllerName
        templateUrl: "/static/templates/#{controllerName}.html"
        resolve:
          items : ["$q", "$route", "$http", ($q, $route, $http) ->
             deferred = $q.defer()
             controllerName = $route.current.controllerName
             $http(
               method: "GET"
               url: "/api/#{controllerName}/"
             )
             .success (response) ->
               deferred.resolve(response.payload)
             .error (response) ->
               deferred.reject(response.message)

             return deferred.promise
          ]

  $routeProvider
    .otherwise
      redirectTo: '/'
      action: 'checkStatus'
]

appModule.controller "GenericController", ["$scope", "$route", "$http", "$cookies", "items", ($scope, $route, $http, $cookies, items) ->

  $scope.items = items
      #etc ....
    ] 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-05-26T12:06:31.400

[此提交](https://github.com/vojtajina/angular.js/commit/05772e15fbecfdc63d4977e2e8839d8b95d6a92d)是 1.1.5 及更高版本的一部分，它公开`$promise`了`$resource`. 包含此提交的 ngResource 版本允许解析如下资源：

**$routeProvider**

```
resolve: {
    data: function(Resource) {
        return Resource.get().$promise;
    }
} 
```

**控制器**

```
app.controller('ResourceCtrl', ['$scope', 'data', function($scope, data) {

    $scope.data = data;

}]); 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-10-06T21:01:13.670

这个片段是*依赖注入*友好的（我什至将它结合使用**ngmin**和**uglify**），它是一个更优雅的基于*域驱动*的解决方案。

下面的示例注册了一个**电话** *资源*和一个*常量* **phoneRoutes**，其中包含该（电话）域的所有路由信息。在提供的答案中我不喜欢的是*解析*逻辑的位置——*主*模块不应该*知道*任何事情，或者对资源参数提供给控制器的方式感到困扰。这样逻辑就保持在同一个域中。

*注意：如果您使用的是[ngmin](https://github.com/btford/grunt-ngmin)（如果您不使用：您应该），您只需要使用 DI 数组约定编写解析函数。*

```
angular.module('myApp').factory('Phone',function ($resource) {
  return $resource('/api/phone/:id', {id: '@id'});
}).constant('phoneRoutes', {
    '/phone': {
      templateUrl: 'app/phone/index.tmpl.html',
      controller: 'PhoneIndexController'
    },
    '/phone/create': {
      templateUrl: 'app/phone/edit.tmpl.html',
      controller: 'PhoneEditController',
      resolve: {
        phone: ['$route', 'Phone', function ($route, Phone) {
          return new Phone();
        }]
      }
    },
    '/phone/edit/:id': {
      templateUrl: 'app/phone/edit.tmpl.html',
      controller: 'PhoneEditController',
      resolve: {
        form: ['$route', 'Phone', function ($route, Phone) {
          return Phone.get({ id: $route.current.params.id }).$promise;
        }]
      }
    }
  }); 
```

下一部分是在模块处于配置状态时注入路由数据并将其应用于**$routeProvider**。

```
angular.module('myApp').config(function ($routeProvider, 
                                         phoneRoutes, 
                                         /* ... otherRoutes ... */) {

  $routeProvider.when('/', { templateUrl: 'app/main/index.tmpl.html' });

  // Loop through all paths provided by the injected route data.

  angular.forEach(phoneRoutes, function(routeData, path) {
    $routeProvider.when(path, routeData);
  });

  $routeProvider.otherwise({ redirectTo: '/' });

}); 
```

使用此设置测试路由配置也非常简单：

```
describe('phoneRoutes', function() {

  it('should match route configuration', function() {

    module('myApp');

    // Mock the Phone resource
    function PhoneMock() {}
    PhoneMock.get = function() { return {}; };

    module(function($provide) {
      $provide.value('Phone', FormMock);
    });

    inject(function($route, $location, $rootScope, phoneRoutes) {
      angular.forEach(phoneRoutes, function (routeData, path) {

        $location.path(path);
        $rootScope.$digest();

        expect($route.current.templateUrl).toBe(routeData.templateUrl);
        expect($route.current.controller).toBe(routeData.controller);
      });
    });
  });
}); 
```

[你可以在我最新的（即将到来的）实验](https://github.com/McNull/angular-febworms)中看到它的全部荣耀。虽然这种方法对我来说很好，但我真的很想知道为什么 $injector在检测到*任何***承诺**对象的注入时没有延迟*任何东西*的构造；它会让事情变得更容易。

 ****编辑：使用 Angular v1.2(rc2)*

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-09-03T17:59:53.767

延迟显示路线肯定会导致异步纠缠......为什么不简单地跟踪主实体的加载状态并在视图中使用它。例如，在您的控制器中，您可能会在 ngResource 上同时使用成功和错误回调：

```
$scope.httpStatus = 0; // in progress
$scope.projects = $resource.query('/projects', function() {
    $scope.httpStatus = 200;
  }, function(response) {
    $scope.httpStatus = response.status;
  }); 
```

然后在视图中你可以做任何事情：

```
<div ng-show="httpStatus == 0">
    Loading
</div>
<div ng-show="httpStatus == 200">
    Real stuff
    <div ng-repeat="project in projects">
         ...
    </div>
</div>
<div ng-show="httpStatus >= 400">
    Error, not found, etc. Could distinguish 4xx not found from 
    5xx server error even.
</div> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-09-07T05:04:46.757

我在上面的 Misko 代码中工作，这就是我所做的。这是一个更新的解决方案，因为`$defer`已更改为`$timeout`. 然而，替换`$timeout`将等待超时时间（在 Misko 的代码中，1 秒），然后返回数据，希望它及时解决。通过这种方式，它会尽快返回。

```
function PhoneListCtrl($scope, phones) {
  $scope.phones = phones;
  $scope.orderProp = 'age';
}

PhoneListCtrl.resolve = {

  phones: function($q, Phone) {
    var deferred = $q.defer();

    Phone.query(function(phones) {
        deferred.resolve(phones);
    });

    return deferred.promise;
  }
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-07-28T07:03:39.200

## 使用 AngularJS 1.1.5

**使用AngularJS 1.1.5**语法更新 Justen 回答中的“电话”功能。

原来的：

```
phones: function($q, Phone) {
    var deferred = $q.defer();

    Phone.query(function(phones) {
        deferred.resolve(phones);
    });

    return deferred.promise;
} 
```

更新：

```
phones: function(Phone) {
    return Phone.query().$promise;
} 
```

多亏了 Angular 团队和贡献者，时间缩短了。:)

这也是马克西米利安霍夫曼的答案。显然，该提交进入了 1.1.5。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-11-14T12:04:21.357

您可以使用[$routeProvider 解析](https://docs.angularjs.org/api/auto/service/$provide#constant)属性来延迟路由更改，直到加载数据。

```
angular.module('app', ['ngRoute']).
  config(['$routeProvider', function($routeProvider, EntitiesCtrlResolve, EntityCtrlResolve) {
    $routeProvider.
      when('/entities', {
        templateUrl: 'entities.html', 
        controller: 'EntitiesCtrl', 
        resolve: EntitiesCtrlResolve
      }).
      when('/entity/:entityId', {
        templateUrl: 'entity.html', 
        controller: 'EntityCtrl', 
        resolve: EntityCtrlResolve
      }).
      otherwise({redirectTo: '/entities'});
}]); 
```

请注意，该`resolve`属性是在路由上定义的。

`EntitiesCtrlResolve`并且`EntityCtrlResolve`是在与控制器相同的文件中定义的[常量对象。](https://docs.angularjs.org/api/auto/service/$provide#constant)`EntitiesCtrl``EntityCtrl`

```
// EntitiesCtrl.js

angular.module('app').constant('EntitiesCtrlResolve', {
  Entities: function(EntitiesService) {
    return EntitiesService.getAll();
  }
});

angular.module('app').controller('EntitiesCtrl', function(Entities) {
  $scope.entities = Entities;

  // some code..
});

// EntityCtrl.js

angular.module('app').constant('EntityCtrlResolve', {
  Entity: function($route, EntitiesService) {
    return EntitiesService.getById($route.current.params.projectId);
  }
});

angular.module('app').controller('EntityCtrl', function(Entity) {
  $scope.entity = Entity;

  // some code..
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-02-27T18:51:03.957

我喜欢 darkporter 的想法，因为对于一个刚接触 AngularJS 的开发团队来说，它很容易理解并立即工作。

我创建了这个适配，它使用 2 个 div，一个用于加载栏，另一个用于加载数据后显示的实际内容。错误处理将在其他地方进行。

向 $scope 添加一个“就绪”标志：

```
$http({method: 'GET', url: '...'}).
    success(function(data, status, headers, config) {
        $scope.dataForView = data;      
        $scope.ready = true;  // <-- set true after loaded
    })
}); 
```

在 html 视图中：

```
<div ng-show="!ready">

    <!-- Show loading graphic, e.g. Twitter Boostrap progress bar -->
    <div class="progress progress-striped active">
        <div class="bar" style="width: 100%;"></div>
    </div>

</div>

<div ng-show="ready">

    <!-- Real content goes here and will appear after loading -->

</div> 
```

另请参阅：[Boostrap 进度条文档](http://twitter.github.com/bootstrap/components.html#progress)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-12T10:39:34.717

我喜欢上面的答案并从他们那里学到了很多东西，但是上面的大多数答案都缺少一些东西。

我被困在一个类似的场景中，我正在使用从服务器的第一个请求中获取的一些数据来解析 url。**我面临的问题是，如果承诺是`rejected`.**

我正在使用一个自定义提供程序，该提供程序用于返回一个在配置阶段`Promise`由`resolve`of解决的。`$routeProvider`

我想在这里强调的是`when`它的概念是这样的。

它在 url 栏中看到 url，然后`when`在被调用的控制器中看到相应的块，并且视图到目前为止被引用得很好。

可以说我有以下配置阶段代码。

```
App.when('/', {
   templateUrl: '/assets/campaigns/index.html',
   controller: 'CampaignListCtr',
   resolve : {
      Auth : function(){
         return AuthServiceProvider.auth('campaign');
      }
   }
})
// Default route
.otherwise({
   redirectTo: '/segments'
}); 
```

在浏览器的根 url 上，第一个运行块被调用，否则`otherwise`被调用。

让我们想象一下我在地址栏中点击 rootUrl`AuthServicePrivider.auth()`函数被调用的场景。

假设返回的 Promise 处于**拒绝**状态 ***，然后呢？？？***

根本没有渲染任何东西。

`Otherwise`块将不会被执行，因为它对于任何未在配置块中定义且 angularJs 配置阶段未知的 url。

当这个promise没有解决时，我们将不得不处理被触发的事件。失败`$routeChangeErorr`时被解雇`$rootScope`。

它可以被捕获，如下面的代码所示。

```
$rootScope.$on('$routeChangeError', function(event, current, previous, rejection){
    // Use params in redirection logic.
    // event is the routeChangeEvent
    // current is the current url
    // previous is the previous url
    $location.path($rootScope.rootPath);
}); 
```

IMO 将事件跟踪代码放在应用程序的运行块中通常是一个好主意。此代码在应用程序的配置阶段之后运行。

```
App.run(['$routeParams', '$rootScope', '$location', function($routeParams, $rootScope, $location){
   $rootScope.rootPath = "my custom path";
   // Event to listen to all the routeChangeErrors raised
   // by the resolve in config part of application
   $rootScope.$on('$routeChangeError', function(event, current, previous, rejection){
       // I am redirecting to rootPath I have set above.
       $location.path($rootScope.rootPath);
   });
}]); 
```

这样我们就可以在配置阶段处理 Promise 失败。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-08T01:51:23.603

我有一个复杂的多级滑动面板界面，禁用屏幕层。在禁用屏幕层上创建指令，该指令将创建单击事件以执行状态，例如

```
$state.go('account.stream.social.view'); 
```

正在产生闪烁的效果。history.back() 而不是它工作正常，但在我的情况下它并不总是回到历史。所以我发现如果我只是在我的禁用屏幕上创建属性 href 而不是 state.go ，就像一个魅力。

```
<a class="disable-screen" back></a> 
```

指令“返回”

```
app.directive('back', [ '$rootScope', function($rootScope) {

    return {
        restrict : 'A',
        link : function(scope, element, attrs) {
            element.attr('href', $rootScope.previousState.replace(/\./gi, '/'));
        }
    };

} ]); 
```

app.js 我只是保存以前的状态

```
app.run(function($rootScope, $state) {      

    $rootScope.$on("$stateChangeStart", function(event, toState, toParams, fromState, fromParams) {         

        $rootScope.previousState = fromState.name;
        $rootScope.currentState = toState.name;

    });
}); 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2014-10-03T18:08:34.100

一种可能的解决方案可能是将 ng-cloak 指令与我们使用模型的元素一起使用，例如

```
<div ng-cloak="">
  Value in  myModel is: {{myModel}}
</div> 
```

我认为这需要最少的努力。***

# c# - 在 asp.net mvc 3 和 jquery 中记录帖子

> ID：11972037
> 
> 赞同：2
> 
> 时间：2012-08-15T15:13:31.433
> 
> 标签：c#, jquery, asp.net-mvc-3, http-post

嗨，我对 ASP 和 jQuery 很陌生，可以提供一些帮助。我想使用 Ajax 请求来记录发送请求的次数，但不知道从哪里开始。我认为这可能与 jQuery.ajaxSetup 有关，但我不确定。

如果有人可以提供帮助或至少为我指明正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:32:34.400

您可以使用 cookie 在客户端执行此操作。否则，您可以使用会话变量来执行此服务器端。

这里有两者的例子。

[如何使用 jQuery 在 ASP.NET MVC 3 中设置会话变量？](https://stackoverflow.com/questions/8711998/how-set-session-variables-in-asp-net-mvc-3-with-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:34:58.227

您可以使用 beforeSend 回调：

```
var count = 0;

$.ajaxSetup({
    beforeSend: function(jqXHR, settings) {
        if (settings.type == 'POST') {
            count++;
        }

        // Allow only 3 POST AJAX requests for this page 
        // and if there are more abort them
        if (count > 3) {
            return false;
        }
    }
}); 
```

# html - 如何在无序列表中换行文本行？

> ID：11972048
> 
> 赞同：1
> 
> 时间：2012-08-15T15:14:04.443
> 
> 标签：html, css, textarea

我在包含“列”表中有一些嵌套表。底部表格只包含一个多行文本区域，用户可以在其中发表评论。当用户保存页面时，我想将每一行单独的注释捕获为无序列表中的一个元素。这是HTML：

```
<td><strong>Key Messages:</strong><asp:Label runat="server" ID="messagesLabel"></asp:Label>
    <div id="messagesDiv" runat="server">
        <asp:TextBox runat="server" ID="MessagesTextbox" Width="100%" TextMode="MultiLine" Height="100" Columns="10"></asp:TextBox>
        <asp:Button runat="server" ID="clearMessages" Text="Clear Messages" OnClick="ClearMessages_Click" />
    </div>
</td> 
```

我的问题是，当无序列表被发布回页面时，很长的行会将表格拉伸超出所需的宽度。我希望在某个时间点包含更长的评论，同时在列表中仍然只保留一个元素——即一个项目符号。我尝试设置 MaxLength 和 Columns 属性，但没有成功。

编辑：

我尝试了第一个建议：

```
ul
{
    width: 50px;
}
li
{
    width: 50px;
} 
```

但它对布局没有影响。任何宽度值的布局都没有改变。

我尝试使用第二种解决方案，但我的编辑器中没有可用的 CSS 属性“自动换行”。我正在使用支持 CSS 2.1 的 Visual Web Developer Express 2010 进行编程，所以据我所知，我应该能够设置此属性，但我不能。无论如何我都试过了，它对布局没有影响。

编辑：

这是我创建列表的方式：

```
XmlDocument xdoc2 = new XmlDocument();
    xdoc2.Load(messagesFileLocation);
    XmlNodeList messagesList = xdoc2.GetElementsByTagName("message");
    if (messagesList.Count > 0)
    {
        string unorderedList = "<ul>";
        for (int i = 0; i < messagesList.Count; i++)
        {
            XmlNode node = messagesList.Item(i);
            string message = node.InnerText.ToString();
            unorderedList += "<li>" + message.ToString() + "</li>";
        }
        unorderedList += "</ul>";
        messagesDiv.InnerHtml = unorderedList;
    } 
```

用户编辑实际上是先保存到一个 XML 文件，然后再发回页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:19:05.457

指定 ul 和 li 元素的宽度，您的内容应该换行。还将父元素设置为 height:auto; 所以高度会随着内容大小的增加而变化。

如果您发布更多代码，我可以给您一个更好的主意。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-15T15:42:11.077

是的，我认为它可能检查这个

[http://www.w3schools.com/cssref/css3_pr_word-wrap.asp](http://www.w3schools.com/cssref/css3_pr_word-wrap.asp)

还有这个

[http://webdesignerwall.com/tutorials/word-wrap-force-text-to-wrap](http://webdesignerwall.com/tutorials/word-wrap-force-text-to-wrap)

# ios - Opening files from iPad in Excel?

> ID：11972050
> 
> 赞同：1
> 
> 时间：2012-08-15T15:14:08.313
> 
> 标签：ios, windows, ipad, itunes

I have an iPad app that creates XML files and saves them to the iPad's Documents Directory. I would like to get these files to excel, but I am fairly certain I cannot just launch excel > open > then navigate through the iPads directory.

What's the best way to get these files? Are there any windows applications that allow you to access the iPad's directories ? Or will I have to use iTunes ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:23:19.680

您可能想查看“CloudOn”：

*   [我的 iPad 上的 Excel](http://blogs.computerworld.com/20102/excel_on_my_ipad_free)

*   [http://site.cloudon.com/](http://site.cloudon.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T14:29:19.790

For your needs, I have the habit of going through the Beesy application: [http://www.beesapps.com/management-productivity/import-excel-files-on-ipad/](http://www.beesapps.com/management-productivity/import-excel-files-on-ipad/). I can import/export such a file in my iPad and if I need to make changes, I can make notes in the margins of the doc to complete thereafter.

# php - 以正确的方式使用 PHP 路由页面请求

> ID：11972057
> 
> 赞同：3
> 
> 时间：2012-08-15T15:14:27.393
> 
> 标签：php, apache, mod-rewrite, url-routing

我需要知道“正确”执行站点导航的术语和最佳实践吗？方式，类似于当您通过 url 提问时 stackoverflow 如何路由您：

“http://stackoverflow.com/questions/ask”

就我的 PHP 编程知识而言，我可能会像这样编写代码：

“http://stackoverflow.com/index.php?p=questions&act=ask”

希望你明白我的意思。我想知道这种页面导航和请求/响应处理方法的术语，以及在使用这种标准/方法设计 Web 应用程序时我需要记住的最佳实践、限制或其他任何内容。我什至不知道这一切是否都是用 PHP 或一些用 ASP 或 Ruby 编码的 Web 后端完成的，或者你有什么，所以我用我的猜测填充了标签。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T15:43:12.073

大多数 MVC 框架使用的模式是调用路由器的[前端控制器。](http://en.wikipedia.org/wiki/Front_Controller_pattern)前端控制器通常`index.php`位于您的 Web 根目录中。接下来，所有不针对现有文件（如 js、css 和图像资产）的请求都需要发送到此控制器。在 apache 中，您可以使用[mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)执行此操作：

```
RewriteRule ^index\.php$ - [F]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . /index.php [L,QSA] 
```

但是，Apache 2.5 中推荐的方法是使用[FallbackResource](http://httpd.apache.org/docs/trunk/mod/mod_dir.html#fallbackresource)：

```
FallbackResource index.php 
```

如果您使用的是[IIS，它具有类似的功能。](https://stackoverflow.com/questions/60857/mod-rewrite-equivalent-for-iis-7-0)

在`index.php`中，您可以访问最初使用 请求的 URL `$_SERVER['REQUEST_URI']`。您应该包括您的路由器（它应该在 Web 根目录之外）并使用请求 URI 调用它。例子：

```
require '../router.php';

$router = new Router();
$router->process($_SERVER['HTTP_METHOD'], $_SERVER['REQUEST_URI'], $_GET, $_POST); 
```

然后你的路由器可以找到合适的控制器来路由请求。阅读有关[MVC 框架](http://oreilly.com/php/archive/mvc-intro.html)的更多信息，并研究[一些](http://codeigniter.com/) [示例](http://kohanaframework.org/)以更好地了解其他人是如何实现它的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:20:48.543

他们很可能使用您在 URL 中描述的相同方法（嵌入导航变量），但它是在“幕后”完成的。

允许您呈现此类 URL 的机制称为 MOD 重写。它使用 URL 中的变量和正则表达式的组合，以更加用户友好的方式向最终用户重新表示 URL。

更多信息：[http ://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

编辑：当然这适用于在 apache 网络服务器上运行的代码。其他 Web 服务器（例如 IIS）可能也有类似的模块。

另外，请注意 mod_rewrite 超出了 php.ini 的范围。相反，它实际上是 apache 服务器指令，甚至在 php 发挥作用之前就被调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-09T07:03:27.730

我目前正在开发一个针对**极高性能**的 php 路由器。你可能想看看：

[https://github.com/c9s/Pux](https://github.com/c9s/Pux)

Pux 在静态路由调度方面比 symfony 路由器快 48.5 倍，在正则表达式调度方面快 31 倍。（安装了 pux 扩展）

Pux 尽量不消耗计算时间来动态构建所有路由（如 Symfony/Routing）。相反，Pux 将您的路由编译为普通的 PHP 数组进行缓存，编译后的路由可以非常快速地从缓存中加载。

借助 Pux PHP 扩展支持，您可以比纯 PHP Pux 快 1.5~2 倍地加载和调度路由。

# javascript - javascript 函数返回的语法（空格）是否会影响结果？

> ID：11972059
> 
> 赞同：4
> 
> 时间：2012-08-15T15:14:38.923
> 
> 标签：javascript, debugging, parsing

在编写一个 javascript 函数来评估多变量条件时，我遇到了 Javascript 中的解析器错误。如果我忘记了什么，或者这是适当的行为，请告诉我。

在我的函数中，我返回了`AND`几个变量的结果，如下所示：

```
return
// a comment, for kicks
a1 && a2
&&
b1 && b2
&&
// another comment
c1 && c2
&&
d1 && d2
; 
```

但是，即使所有这些变量都具有显式值`true`，该函数也会返回`undefined`而不是预期的`true`。

我尝试了几种返回此表达式的变体，我发现：

1.  多行表达式——**失败**
2.  单行表达式——**有效**
3.  用括号括起来的表达式——**有效**
4.  将多行表达式设置为*变量*，然后返回*变量*--**有效**

请参阅工作示例：http: [//jsfiddle.net/drzaus/38DgX/](http://jsfiddle.net/drzaus/38DgX/)

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:19:20.277

您遇到的是 Javascript 中称为“分号插入”的奇怪行为。长话短说，当行尾可以解释为语句的结尾而不会引入语法错误时，Javascript 会这样做。语句后的换行符`return`符合条件 - 为了防止这种情况发生，您可以将返回的值括在括号中，如下所示：

```
return (
  a1 && a2
  ...
  d1 && d2
); 
```

在以下位置有更多详细信息（以及规范中的引用）：[Trouble understands semicolon injection](https://stackoverflow.com/questions/8393677/trouble-understanding-semicolon-insertion)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T15:17:52.677

这是正确的行为。放入`return;`一个函数会导致它返回`undefined`。在您的示例中，后的换行符`return`使解析器认为这是语句的结尾，因此它返回`undefined`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T15:18:11.543

啊哈——相关链接万岁： [JavaScript 空白语法错误](https://stackoverflow.com/questions/1549936/javascript-whitespace-syntax-error)

解析器似乎看到了一个换行符，`return`并自动将其视为分号。在它起作用的情况下，有一个括号向解析器表明它实际上是一个多行子句，或者它在单行上（因此否定自动插入），或者在*变量*的情况下它被解析器以不同的方式处理。

# objective-c - 在运行时复制 NSView

> ID：11972060
> 
> 赞同：0
> 
> 时间：2012-08-15T15:14:45.037
> 
> 标签：objective-c, nsview, nspopover

是否可以在运行时复制 NSView？我将它用作显示文本消息的弹出窗口，并且我想同时显示它“两次”（带有不同的消息）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:17:45.110

如果您以`NSPopover`编程方式创建实例，那么您可以`NSView`在它自己的 nib 中定义（这是最简单的创建方法`NSPopover`），然后`NSViewControllers`使用相同的 nib 文件实例化两个不同的实例。

# c# - 具有类型约束的方法重载

> ID：11972062
> 
> 赞同：1
> 
> 时间：2012-08-15T15:14:50.743
> 
> 标签：c#, generics, constraints

我有更新函数，我想根据输入参数重载（无论是值类型还是引用类型）

```
public void Update<T>(T item) where T : ValueType 
```

编译器有错误，它坚持我不能使用值类型（并且更多地作为约束）。我应该放弃还是有一种巧妙的方法可以根据我想要的类型重载方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:15:56.630

如果您想要一个值类型（不可为空），请使用结构：

`public void Update<T>(T item) where T : struct`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:18:21.163

您可以使用它`where T : struct`来强制它`T`是一个不可为空的值类型（这*不适*用于`Nullable<T>`，尽管它是一个值类型）。

但是，这不会帮助您实现更大的目标，因为您不能通过类型约束重载 - 所以这是无效的：

```
// Invalid overloading
void Foo<T>(T item) where T : class
void Foo<T>(T item) where T : struct 
```

基本上，尽管类型参数的*数量*是方法签名的一部分（就重载而言），但名称和约束却不是。

有一些[可怕的方法可以解决这个问题](http://msmvps.com/blogs/jon_skeet/archive/2010/11/02/evil-code-overload-resolution-workaround.aspx)，但我建议使用不同的方法名称。

# python - 为什么我的 QThread 正在使主线程挨饿？

> ID：11972063
> 
> 赞同：0
> 
> 时间：2012-08-15T15:14:51.183
> 
> 标签：python, multithreading, qt, pyside

这是我基于 QThread 编写的可爱线程。您会注意到它有一个事件队列。4 秒后，一个事件触发并在`doWork`. `doWork`应该在所有打印之间休眠并给其他线程一个运行的机会。可以说，所有打印和睡眠`doWork`运行的时间足够长，以至于另一个线程确实应该有一些时间来执行。

```
from PySide.QtCore import *
from PySide.QtGui import *

class DoStuffPeriodically(QThread):
    def __init__(self):
        super(DoStuffPeriodically, self).__init__()

    def doWork(self):
        #... do work, post signal to consumer
        print "Start work"
        for i in range(0,100):
            print "work %i" % i
            QThread.msleep(10)
        print "Done work"
        return

    def run(self):
        """ Setup "pullFiles" to be called once a second"""
        self.timer= QTimer()
        self.timer.setSingleShot(True)
        self.timer.timeout.connect(self.doWork)
        self.timer.start(4000)
        self.exec_() 
```

这是我用来控制线程的顶级 QT 小部件。它基本上只是一个启动/停止线程的按钮。

```
class Widg(QWidget):
    def __init__(self):
        super(Widg, self).__init__()
        self.thread = DoStuffPeriodically()
        self.startStopButton = QPushButton()
        hBoxLayout = QHBoxLayout()
        hBoxLayout.addWidget(self.startStopButton)
        self.startStopButton.pressed.connect(self.startStopThread)
        self.setLayout(hBoxLayout)
        self.threadRunning = False

    def startStopThread(self):
        if self.threadRunning:
            print "Stopping..."
            self.thread.exit(0)
            self.threadRunning = False
            print "Stopped"
        else:
            print "Starting..."
            self.thread.start()
            self.threadRunning = True
            print "Started"

if __name__ == "__main__":
    from sys import argv
    qApp = QApplication(argv)    
    widg = Widg()
    widg.show()
    qApp.exec_() 
```

如果我单击 startStopButton，我希望看到线程开始打印

```
开始...
开始...
开始工作
工作 0
工作 1
...
工作 99
完成工作

```

但我想做的是能够在线程工作时停止线程。我期待一些类似的东西

```
开始...
开始...
开始工作
工作 0
工作 1
...
工作N
停止...
工作 99
完成工作
停...

```

相反，**工作线程似乎正在阻止主线程执行？**我必须等待工作完成，然后才能单击 startStopButton，给我

```
开始...
开始...
开始工作
工作 0
工作 1
...
工作 99
完成工作
停止...
停...

```

`doWork`跑多长时间都没关系。我已经将它提高到循环 10000 次。**它似乎从来没有给主线程时间，并且小部件没有响应。**我是否在做一些阻止真正线程实际工作的事情？

（我使用的是 python 2.7 和 pyside 1.10。）

### 更新

如果我修改`run`为直接完成工作，而不是基于`QTimer`线程似乎可以正常工作。即更改`run`为：

```
def run(self):
    self.doWork()
    return 
```

这并不能解决我的问题，因为我想使用事件队列运行。因此，我怀疑这是某种信号/插槽问题，其中`QTimer`信号与错误的线程相关联。

**请注意，在工作完成之前，我不会体验`exit`或阻止。`quit`我只是遇到线程根本不起作用。即主窗口被阻止，我什至无法单击按钮甚至启动退出线程**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:05:19.940

问题是该`QThread`方法正在发挥作用。的线程亲和性`QThread`始终[是创建](http://qt-project.org/wiki/Threads_Events_QObjects#64a093776750c691afdeb133a80f55e2)QThread 的线程。因此，信号告诉`QThread`' 拥有线程执行`doWork`——在这种情况下是主线程。所以即使`doWork`是在这个 QThread 中定义的，工作也是由主线程完成的。我知道一种心灵扭曲。为了解释，让我首先引用文档

> QThread 对象存在于另一个线程中，即创建它的那个线程。

所以当这个信号/插槽连接建立时

```
 self.timer.timeout.connect(self.doWork) 
```

它，默认情况下是一个[AutoConnection](http://qt-project.org/doc/qt-4.8/qt.html#ConnectionType-enum)：

> （默认）如果信号是从与接收对象不同的线程发出的，则信号被排队，表现为 Qt::QueuedConnection。否则，槽被直接调用，表现为 Qt::DirectConnection。连接类型在信号发出时确定。

信号的来源是我的QThread，因为QTimer是在`run`方法中创建的，但目的地是主线程。它正在主线程的事件队列中排队！解决方案是创建第二个工作 QObject，它将具有当前线程的亲和性：

```
class Worker(QObject):
    def __init__(self, parent):
        super(Worker, self).__init__(parent=parent)

    def doWork(self):
        #... do work, post signal to consumer
        print "Start work"
        for i in range(0,1000):
            print "work %i" % i
            QThread.msleep(100)
        print "Done work"
        return 
```

然后运行变为：

```
def run(self):
    """ Setup "pullFiles" to be called once a second"""
    print "Running..."       
    self.worker = Worker(parent=None) #affinity = this thread
    self.timer= QTimer() #affinity = this thread
    print self.timer.thread()
    self.timer.setSingleShot(True)
    self.timer.timeout.connect(self.worker.doWork)
    self.timer.start(4000)
    self.exec_()
    print "Exec_ done" 
```

这有效。信号的来源和目的地都在一个线程中，不会遍历回主线程。瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:54:00.100

来自[QThread::exit()](http://doc.qt.nokia.com/4.7-snapshot/qthread.html#exit)文档：

```
Tells the thread's event loop to exit with a return code. 
```

您`doWork`是事件循环中的单个事件。事件循环调用了您的事件，因此它等待它完成。`exit`是另一个事件，在事件循环中排队等待`doWork`完成。这`msleep`有助于您的 GUI 的响应能力（给它时间重新绘制和执行按钮处理程序），但它确实不会使`exit`事件以某种方式潜入。

如果您希望您`doWork`随时可以被打断，您必须改变您的逻辑。使计时器更频繁地触发，并且只增加一。exit 然后可以在两者之间随时采取行动。

# python - 带有 apache+mod_wsgi 的单域上的 Django-CMS 和 LFS（带有 ubuntu 的亚马逊 ec2 服务器）

> ID：11972064
> 
> 赞同：0
> 
> 时间：2012-08-15T15:14:51.103
> 
> 标签：python, django, apache, django-lfs

我很难在一个域上安装多个项目 Django。我想在同一个域上运行 Django-CMS 和 LFS：

*   **mydomain.com (django-cms)**
*   **mydomain.com/store (LFS)**

目前，我可以毫无问题地使用正确的 django-project 访问两个域，但是在 LFS 项目中，所有商店的链接都重定向到第一个域。例如，购物车链接重定向到**mydomain.com/cart**而不是**mydomain.com/store/cart**。

我试图通过在所有 url 模式中添加“store/”来更改 url.py 文件，但它不起作用。我想我必须在 LFS 项目的 settings.py 中添加一个配置，但我不知道是什么。

你有什么想法吗？谢谢 ！:)

PS：这里是我的 httpd.conf

```
Alias /store/static /home/ubuntu/lfs-installer/lfs_project/sitestatic/

<Directory /home/ubuntu/lfs-installer/lfs_project/sitestatic>
Order deny,allow
Allow from all
</Directory>

WSGIScriptAlias /store /home/ubuntu/lfs-installer/apache/django.wsgi

Alias /static /home/ubuntu/lfs-installer/selmyrtech/static/

<Directory /home/ubuntu/lfs-installer/selmyrtech/static>
Order deny,allow
Allow from all
</Directory>

WSGIScriptAlias / /home/ubuntu/lfs-installer/selmyrtech/apache/django.wsgi 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:01:03.063

Django 在子目录中并不总是能很好地发挥作用——即使在它是域中唯一的 Django 项目的情况下也是如此。我曾认为文档建议不要这样做，但在快速搜索后我无法找到该页面

问题之一可能在这里：

```
WSGIScriptAlias / /home/ubuntu/lfs-installer/selmyrtech/apache/django.wsgi 
```

看起来这个指令可能会将所有 URI 段映射`/`到这个特定的 WSGI 脚本，覆盖`/store`别名。颠倒你的脚本别名的顺序可能会也可能不会解决这个问题。

是否可以重新考虑您的 URL 约定以提供来自子域的“商店”区域，例如 store.mydomain.com/cart？

如果是这样，这可能是一个更好的支持结构，并且两个项目可以有独立的 Apache 进程和 WSGI 脚本。

另一种解决方案是查看将两个项目集成到一个 Django 项目中。我不知道您的特定用例是什么可能会阻止您走这条路，或者这可能会带来哪些独特的挑战，但如果两个项目都使用身份验证，这可能对用户特别有帮助。

# jquery - 当 Jquery hide() 和 show() 用于包含 div 时，div 内的链接不可点击

> ID：11972074
> 
> 赞同：3
> 
> 时间：2012-08-15T15:15:26.797
> 
> 标签：jquery, hyperlink, show-hide, clickable

我的页面上 div 内的链接有问题。目前，当点击链接时，没有任何反应。我不明白为什么，但我想这与在包含的 div 上使用 hide() 和 show() 有关，我将在下面解释。

div 是自定义“手风琴”的一部分，它使用以下 Jquery 在单击标题时打开/关闭正确的 div：

```
 $('.accordion .head').click(function () {
     $('.accordion .head').next().hide();
     $('.accordion .head').removeClass("active");

     $(this).next().show('fast');
     $(this).addClass("active");
     return false;
}); 
```

我知道有更好的方法来实现“手风琴”行为，但是因为我们的网站都使用了这种方法，所以我没有选择更新手风琴来使用实际的 Jquery 手风琴（）方法，而不需要做很多额外的工作我。

那么，鉴于下面的示例代码，任何人都可以帮助我理解这里的问题是什么，或者如何克服它？

```
<div class="accordion">
  <div class="head active"><a href="#">Heading 1</a></div>
  <div class="accordion-content first">
      <p>
           Some text here
      </p>
      <div class="accordion-logos"> 
      </div>
  </div>            
  <div class="head"><a href="#">Heading 2</a></div>
  <div class="accordion-content">
      <p>
          Some other text here 
      </p>
      <p>
          <a href="http://www.google.com">http://www.google.com</a>                                    
      </p>
  </div>            
</div> 
```

当我专门处理它时，我什至无法点击注册，当点击链接时，下面代码中的警报永远不会触发：

```
 $('.accordion .accordion-content #thelink').click(function () {
    alert();
  }); 
```

谢谢你，

玫瑰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-11T10:05:37.173

我遇到了链接不可点击的问题，我看到这篇文章试图找到答案。问题是，在我的标题下方的 div 元素上触发 jquery hide() 后，我的标题中的链接不可点击。我将代码更改为 slideUp() 而不是 hide() 并且链接是可点击的。我不确定这是否能解决你在这篇文章中指定的问题，但鉴于它是相关的，我想我会分享它，因为它可能会帮助遇到这篇文章的任何人。它不像 .hide() 那样合适，而是一个可用的解决方法。

```
$('#mydiv').slideUp(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:37:09.213

看来我第一次误会你了。

如果谷歌链接没有触发，那么要么有东西阻止了链接，覆盖了链接的href，或者甚至有另一个元素在它前面，你不能点击链接。

如果有人想阻止链接工作，他们可以这样做：

```
$('.accordion .accordion-content a').click(function(){
    return false;
}); 
```

如果您想检查是否是这种情况，您可以尝试取消绑定所有内容并检查是否可以单击链接然后：

```
$('.accordion .accordion-content a').unbind('click'); 
```

还要检查您的 html 输出以查看`href`设置的值，也许有人已经覆盖了它。

只需转到呈现的页面并右键单击并选择查看源。搜索谷歌链接并检查`href`值。

​</p>

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T15:37:30.243

你为什么使用#thelink？如果我只是用它替换它就`a`可以了。

```
$(function(){
   $('.accordion .head').click(function () {
    $('.accordion .head').next().hide();
    $('.accordion .head').removeClass("active");

    $(this).next().show('fast');
    $(this).addClass("active");
    return false;
  });

  $('.accordion .accordion-content a').click(function () {
   alert();
  });
}) 
```

​</p>

# perl - 不确定如何继续创建 ec2-consisten-snapshot

> ID：11972080
> 
> 赞同：1
> 
> 时间：2012-08-15T15:15:38.107
> 
> 标签：perl, amazon-ec2, amazon-web-services, sh

我刚刚接到了一项任务，尝试调试并找出我们的 ec2-consistent-snapshot 脚本不工作的原因。

我们的首席程序员关注了这篇[博文](http://www.thatsgeeky.com/2011/05/ec2-consistent-snapshot-on-amazons-linux-ami/)。

我们有一个`.sh`要拍摄快照的脚本，它看起来像这样：

```
#!/bin/sh
/opt/aws/bin/ec2-consistent-snapshot --aws-access-key-id MYACCESSKEY --aws-secret-access-key MYSECRETKEY --freeze-filesystem /vol --mysql --mysql-host localhost --mysql-socket /var/lib/mysql/mysql.sock --mysql-username USERNAME --mysql-password PASSWORD --description "Demo MySQL data volume: $(date +%c)" vol-MYVOL 
```

如果我这样做，`sudo ./snapshot_script.sh`我会得到一个错误：

`ec2-consistent-snapshot: ERROR: create_snapshot: File does not exist: at /usr/share/perl5/vendor_perl/Net/Amazon/EC2.pm line 232`

我当然遵循了这个错误，第 232 行`EC2.pm`是这样的：

`my $ref = $xs->XMLin($xml);`

我有 0 perl 经验，但我不知道这可以做什么。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:51:56.030

我在 CPAN 上查看的[Net::Amazon::EC2](https://metacpan.org/source/MALLEN/Net-Amazon-EC2-0.20/lib/Net/Amazon/EC2.pm)的那条线是 252，而不是 232，所以也许你不在最新版本上。在该行上方，该程序已尝试使用许多安全参数进行“签名查询”。我怀疑您使用的身份验证密钥有问题。有一个调试标志，您可能希望打开它以生成更多消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:24:35.453

如果你去[这个页面](http://search.cpan.org/~grantm/XML-Simple-2.20/lib/XML/Simple.pm#XMLin%28%29)，你会看到这`XMLin()`是一个 XML::Simple 的函数，它接受一个文件作为参数。所以，`$xml`大概是一个包含xml文件名的变量。该文件不存在。

下一步是将错误追溯到 ec2-consistent-snapshot 的源代码，以查看它是如何调用 XML::Simple 以及错误值在何处传入的。

# javascript - 如何在 http.ServerResponse 对象上调用 end()？

> ID：11972081
> 
> 赞同：0
> 
> 时间：2012-08-15T15:15:39.637
> 
> 标签：javascript, http, node.js, error-handling

我在这个问题中找到了接受的[答案](https://stackoverflow.com/questions/5999373/how-do-i-prevent-node-js-from-crashing-try-catch-doesnt-work)来回答我遇到的错误处理问题。

但是请注意注释 - 需要完成 http.ServerResponse 以便应用程序最终不会耗尽内存 - 这是一个问题。

一个人将如何实现这样的东西呢？回调函数如何访问所述对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:09:58.373

[正如这篇文章](https://stackoverflow.com/questions/8114977/recover-from-uncaught-exception-in-node-js)的答案中提到的那样——如果你有一个未捕获的异常，你最好的方法是让进程终止并从那里恢复——否则你不知道应用程序的当前状态是什么。

因为您没有捕获异常，所以它表明应用程序不知道发生了什么。为了解决这个问题 - 你设计你的应用程序在许多小块中，而不是在一个过程中。

这会对性能产生轻微影响（RPC 与进程内通信），但这意味着您可以轻松入睡，而小块出错，重新启动并且一切都很好，因为它们从不维护自己的状态（为此使用 Redis）......

如果您真的想在请求中捕获异常，然后在请求上调用 end() ，则必须使用可以访问响应的闭包，如下所示：

```
// a method that will catch an error and close the response
var runFunctionSafely = function(res, tryFunction){
  try{
    tryFunction();
  }
  catch(error){
    console.log('there was an error, closing the response...');
    console.log(error);
    res.end();
  }
}

app.get('/test', function(req, res, next) {
  runFunctionSafely(res, function(){
    throw new Error('this is a problem');
  })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:04:14.773

`'uncaughtException'`处理程序无权访问响应对象，因此它无法*结束*响应。评论的假定点是，您不应该依赖`'uncaughtException'`所有错误处理需求，因为在许多情况下（如提到的情况），您不在正确处理错误的正确范围内。

# css - 如何防止 Less 尝试编译 CSS calc() 属性？

> ID：11972084
> 
> 赞同：348
> 
> 时间：2012-08-15T15:15:43.867
> 
> 标签：css, compilation, less, css-calc

我正在使用的[Less编译器（](https://en.wikipedia.org/wiki/Less_%28stylesheet_language%29) [OrangeBits](https://github.com/JustinBeckwith/OrangeBits)和[dotless 1.3.0.5](https://github.com/dotless/dotless)）正在积极翻译

```
body { width: calc(100% - 250px - 1.5em); } 
```

进入

```
body { width: calc(-151.5%); } 
```

这显然是不希望的。我想知道是否有办法向 Less 编译器发出信号，以便在编译期间基本上忽略该属性。我搜索了 Less 文档和两个编译器的文档，但找不到任何东西。

Less 或 Less 编译器是否支持这一点？

如果没有，是否有 CSS 扩展器可以做到？

* * *

## 回答 #1

> 赞同：548
> 
> 时间：2012-08-15T16:35:34.543

默认情况下， Less 不再计算内部`calc`的表达式，因为[`v3.00`](https://github.com/less/less.js/blob/master/CHANGELOG.md#300).

* * *

***原答案（`Less v1.x...2.x`）：***

做这个：

```
body { width: calc(~"100% - 250px - 1.5em"); } 
```

在 Less 1.4.0 中，我们将有一个`strictMaths`选项要求所有 Less 计算都在括号内，因此`calc`它将“开箱即用”。这是一个选项，因为它是一个重大的突破性变化。1.4.0 的早期测试版默认启用此选项。发行版默认关闭。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-06-11T15:24:51.177

calc 的一个非常常见的用例是采用 100% 的宽度并在元素周围添加一些边距。

可以这样做：

```
@someMarginVariable = 15px;

margin: @someMarginVariable;
width: calc(~"100% - "@someMarginVariable*2);
width: -moz-calc(~"100% - "@someMarginVariable*2);
width: -webkit-calc(~"100% - "@someMarginVariable*2); 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2015-10-19T20:30:23.823

有几个转义选项具有相同的结果：

```
body { width: ~"calc(100% - 250px - 1.5em)"; }
body { width: calc(~"100% - 250px - 1.5em"); }
body { width: calc(100% ~"-" 250px ~"-" 1.5em); } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-12-19T20:39:19.437

有一种更简洁的方法可以在转义的 calc 中包含变量，如本文所述：*[CSS3 calc() function doesn't work with Less #974](https://github.com/less/less.js/issues/974)*

```
@variable: 2em;

body{ width: calc(~"100% - @{variable} * 2");} 
```

通过使用大括号，您无需关闭并重新打开转义引号。

# tomcat - Coldfusion 10 Servlet 问题

> ID：11972086
> 
> 赞同：1
> 
> 时间：2012-08-15T15:15:45.877
> 
> 标签：tomcat, servlets, coldfusion, web.xml, coldfusion-10

我目前在*ColdFusion*查找我的 servlet 时遇到问题。在*ColdFusion 9*中，我只需将其放在`wwwroot/WEB-INF/classes/`目录下，*ColdFusion*就会在请求时提供服务。

在*ColdFusion 10*中，我在`cfusion/wwwroot/WEB-INF/classes`目录中添加了相同的 Servlet（之后重新启动），并且在显式调用时找不到它。我在以下位置添加了它的描述符`web.xml`：

```
<servlet>
    <servlet-name>myServlet</servlet-name>
    <servlet-class>servlet.myServlet</servlet-class>
</servlet> 
```

我仍然无法调用它。有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-02T10:42:53.467

应该是你的 Java 类是用比 ColdFusion 的 JRE 更高版本的 JRE 编译的。假设您的 ColdFusion 10 在 Java 1.6 上运行，并且您在 Java1.7 上编译了 Java 类，ColdFusion 无法加载这些类。要加载它，您应该在 Java1.6 本身上编译它们或在 Java1.7 上运行 ColdFusion

# jquery - jQuery Validate 插件 - 显示验证消息

> ID：11972087
> 
> 赞同：0
> 
> 时间：2012-08-15T15:15:47.890
> 
> 标签：jquery, jquery-validate

我正在使用上面的内容来验证一个简单的联系表单，基于此处找到的示例：http: [//alittlecode.com/files/jQuery-Validate-Demo/](http://alittlecode.com/files/jQuery-Validate-Demo/)

控制标签“名称”有两条规则——“最小长度”和“必需”：

```
$(document).ready(function(){
    $('#contact-form').validate({
    rules: {
      name: {
        minlength: 2,
        required: true
                ... 
```

如果不满足其中任何一个规则，我可以获得一条要显示的通用消息：

```
 ...
messages: {
    name: "This field is mandatory"
    }
  }); 
```

});

我将如何为每个表单项的规则获取自定义消息？即，如果输入了 1 个字符，则应显示“需要最少 2 个字符”，如果在必需部分中未输入任何内容，则应显示“强制”。我对javascript不太熟悉——像这样的东西？（我知道这可能是错误的，但它给出了我正在尝试做的事情的想法）

```
 ...
messages: {
    name(minlength): "min 2 characters needed",
    name(required): "mandatory"
    }
  }); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:37:02.460

```
$(document).ready(function () {
$('#contact-form').validate({
    rules : {
        MySuperMessage : {
            required : true,
            MySuperMessage : true
        }
    },
    messages : {
        MySuperMessage : "TEST!"
    }
});
});

<input type="text" name="MySuperMessage" id="MySuperMessage"> 
```

# wpf - RelayCommand 参数和绑定

> ID：11972092
> 
> 赞同：0
> 
> 时间：2012-08-15T15:15:56.983
> 
> 标签：wpf, mvvm, binding, relaycommand

**看法：**

使用 WPF(MVVM) 玩一个基本的计算器。我有 1 个文本框用于第一个数字，1 个文本框用于第二个数字，1 个文本块用于结果和 1 个按钮来执行 AddCommand 并返回结果。将这些控件绑定到正确数据的正确 XAML 语法是什么。

**模型：**

```
public class Operation : INotifyPropertyChanged
{
    private double _result;
    public Operation()
    {
        _result = 0;
    }

    public double Result
    {
        get { return _result; }
        set
        {
            if (value != _result)
            {
                _result = value;
                RaisePropertyChanged("Result");
            }
        }
    }

    public double DoAdd(double first, double second)
    {
        _result = first + second;
        return _result;
    }
} 
```

**视图模型：**

```
public class CalcViewModel
{
    private Operation _operation;
    public RelayCommand AddCommand { get; set; }

    public CalcViewModel()
    {
        _operation = new Operation();

        // This is not correct, how to define the AddCommand here so it takes two params
        // The first and second nums to work with.
        AddCommand = new RelayCommand(first, second => ExecuteAddCommand(first, second));
    }

    private void ExecuteAddCommand(double first, double second)
    {

        // How to bind this returned double to the TextBlock in View
        _oepration.DoAdd(first, second);
    }
} 
```

**应 Vlad 的要求编辑新版本的代码**

**模型：**

```
public class Operation
    {
        private double _result;

        public Operation()
        {
            _result = 0;
        }

        public double Result
        {
            get { return _result; }
        }

        public void PerformAdd(double leftNum, double rightNum)
        {
            _result = leftNum + rightNum;
        }
    } 
```

**视图模型：**

```
 public class CalcViewModel
    {
        private Operation _operation;
        public double LeftNumber { get; set; }
        public double RightNumber { get; set; }
        public double Result { get; set; }

        public RelayCommand AddCommand { get; set; }

        public CalcViewModel()
        {
            AddCommand = new RelayCommand(a => ExecuteAddCommand());
            _operation = new Operation();
        }

        private void ExecuteAddCommand()
        {
            _operation.PerformAdd(LeftNumber, RightNumber);
            Result = _operation.Result;
        } 
```

**查看 XAML：**

```
<TextBox Text="{Binding LeftNumber}" />
<TextBox Text="{Binding RightNumber}" />
<TextBox Text="{Binding Result}" />
<Button Content="Add" Command="{Binding AddCommand}" /> 
```

**查看后面的代码：**

```
public partial class CalcUserControl : UserControl
{
    CalcViewModel vm;

    public CalcUserControl()
    {
        InitializeComponent();
        vm = new CalcViewModel();
        this.DataContext = vm;
    }
} 
```

我尝试了所有绑定模式，但没有任何结果。我这里还有一个问题，在这种情况下，默认绑定模式是什么？

我什至认为它与计算的数据类型有关，所以我从 double 切换到 int，但仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:27:22.107

好吧，让我们看看能做些什么。

1) 模型。该模型不需要任何花哨的东西。我会保持简单，让它只返回值而不是使用`NotifyPropertyChanged`. 毕竟，它是一个模型。

```
public class BinaryOperation
{
    double _l, _r, _result = 0.0;
    public Operation(double l, double r)
    {
        _l = l; _r = r;
    }

    public double Result
    {
        get { return _result; }
    }

    public PerformAdd()
    {
        _result = _l + _r;
    }
} 
```

2）视图模型。在这里，你`RelayCommand`真的不需要任何论据。但是您需要将操作数的值存储在您的 VM 中，以便您的视图可以绑定到它们，而不是在命令中发送它们。请记住，业务逻辑不属于视图，视图只是盲目地绑定到虚拟机！因此，您的 VM 中需要 3 个 DP（左加数、右加数、结果）。

3）当命令到达时，你只需从 VM 获取加数，要求模型执行操作，检索结果并将其分配给 VM 的结果 DP。（现在，您的模型操作很快，因此您不需要以异步方式进行。但也许将来......）

4）查看。您需要将 Window/UserControl 绑定到 VM 的属性。它会很简单：

```
<TextBox Text="{Binding LeftAddend}"/>
<TextBox Text="{Binding RightAddend}"/>
<TextBox Text="{Binding Result}"/>
<Button Command="{Binding AddCommand}">Add</Button> 
```

（不要忘记设置`DataContext`正确的。）

编辑：
VM 类必须是依赖对象！并且属性应该被定义为依赖属性。像这样的东西：

```
public class CalcViewModel : DependencyObject
{
    private Operation _operation;

    public double LeftNumber
    {
        get { return (double)GetValue(LeftNumberProperty); }
        set { SetValue(LeftNumberProperty, value); }
    }

    public static readonly DependencyProperty LeftNumberProperty = 
        DependencyProperty.Register("LeftNumber", typeof(double), typeof(CalcViewModel));

    public double RightNumber
    {
        get { return (double)GetValue(RightNumberProperty); }
        set { SetValue(RightNumberProperty, value); }
    }

    public static readonly DependencyProperty RightNumberProperty = 
        DependencyProperty.Register("RightNumber", typeof(double), typeof(CalcViewModel));

    public double Result
    {
        get { return (double)GetValue(ResultProperty); }
        set { SetValue(ResultProperty, value); }
    }

    public static readonly DependencyProperty ResultProperty = 
        DependencyProperty.Register("Result", typeof(double), typeof(CalcViewModel));

    public RelayCommand AddCommand { get; set; }

    public CalcViewModel()
    {
        AddCommand = new RelayCommand(a => ExecuteAddCommand());
        _operation = new Operation();
    }

    private void ExecuteAddCommand()
    {
        _operation.PerformAdd(LeftNumber, RightNumber);
        Result = _operation.Result;
    }
} 
```

或者，如果您想`INotifyPropertyChanged`使用 .NET 4.5

```
public class CalcViewModel : INotifyPropertyChanged
{
    private Operation _operation;

    public event PropertyChangedEventHandler PropertyChanged;

    void NotifyPropertyChanged([CallerMemberName] string propertyName = "")
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    double _leftNumber;
    public double LeftNumber
    {
        get { return _leftNumber; }
        set
        {
            if (value == _leftNumber) return;
            _leftNumber = value;
            NotifyPropertyChanged();
        }
    }

    double _rightNumber;
    public double RightNumber
    {
        get { return _rightNumber; }
        set
        {
            if (value == _rightNumber) return;
            _rightNumber = value;
            NotifyPropertyChanged();
        }
    }

    double _result;
    public double Result
    {
        get { return _result; }
        set
        {
            if (value == _result) return;
            _result = value;
            NotifyPropertyChanged();
        }
    }

    public RelayCommand AddCommand { get; set; }

    public CalcViewModel()
    {
        AddCommand = new RelayCommand(a => ExecuteAddCommand());
        _operation = new Operation();
    }

    private void ExecuteAddCommand()
    {
        _operation.PerformAdd(LeftNumber, RightNumber);
        Result = _operation.Result;
    }
} 
```

与旧的 .NET 版本相同：

```
 void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    double _leftNumber;
    public double LeftNumber
    {
        get { return _leftNumber; }
        set
        {
            if (value == _leftNumber) return;
            _leftNumber = value;
            NotifyPropertyChanged("LeftNumber");
        }
    } 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T15:16:15.543

谢谢大家，尤其是@Vlad。`Result`只是一个小错误，你已经在上两次声明了该属性`class CalcViewModel : DependencyObject`。

它现在工作正常:)

# java - java.sql.SQLException：用户'root'@'localhost'的访问被拒绝（使用密码：否）

> ID：11972095
> 
> 赞同：2
> 
> 时间：2012-08-15T15:16:10.290
> 
> 标签：java, mysql, jdbc, passwords, localhost

我的项目有问题，它涉及`JDBC`和`Mysql`连接。

当我执行以下操作时：

```
private Statement m_statement = null;               // statement 
private Connection m_connection = null;             //  connection

/**
 * Constructor #1 of the Database class
 * @throws ClassNotFoundException
 */
public Database() throws ClassNotFoundException
{
    try
    {
        Class.forName("com.mysql.jdbc.Driver");
        MysqlDataSource ds = new MysqlConnectionPoolDataSource();
        ds.setServerName("localhost");
        ds.setPort(3306);
        ds.setUser("root");
        ds.setPassword("");
        this.m_connection = ds.getConnection();
        this.m_statement = this.m_connection.createStatement();
    }

    catch (SQLException s)
    {
        System.out.println("SQL statement is not executed! 2!");
    }

} 
```

当我尝试使用上面的代码连接时，连接不起作用，这是堆栈跟踪：

```
java.sql.SQLException: Access denied for user 'root'@'localhost' (using password: NO)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1074)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4074)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4006)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:919)
    at com.mysql.jdbc.MysqlIO.proceedHandshakeWithPluggableAuthentication(MysqlIO.java:1694)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1244)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2397)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2430)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2215)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:813)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:399)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:334)
    at com.mysql.jdbc.jdbc2.optional.MysqlDataSource.getConnection(MysqlDataSource.java:443)
    at com.mysql.jdbc.jdbc2.optional.MysqlDataSource.getConnection(MysqlDataSource.java:141)
    at com.mysql.jdbc.jdbc2.optional.MysqlDataSource.getConnection(MysqlDataSource.java:111)
    at db.Database.<init>(Database.java:99)
    at controller.LoginPage.doGet(LoginPage.java:61)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

我该如何解决？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-06T17:49:18.273

我遇到了同样的错误，这就是我修复它的方法：

我像这样使用 DriverManager 类：

```
 Class.forName("com.mysql.jdbc.Driver");
    Connection Hello = DriverManager.getConnection("jdbc:mysql://YOUR-URL-HERE", "USERNAME", "PASSWORD"); 
```

就是这样。此外，在选择表时，请记住将数据库名称放在首位，例如：

```
 "DB_NAME.TABLE_NAME". 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:29:02.923

要检查 mysql 是否有密码，请转到安装 mysql 的目录，然后在 bin 目录中尝试使用 mysql 提示符

./mysql –u root mysql

如果登录没有任何问题，则表示没有设置密码。
您可以使用 mysqadmin 脚本来设置/重置密码。

./mysqladmin –u root 密码“密码字符串”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T16:10:08.200

看起来你刚刚安装了mysql。运行`mysql_secure_installation`。它会提示您输入 root 密码等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-10T10:06:02.217

我有同样的问题。您需要为用户设置密码。转到 mysql 控制台。

```
$ mysqladmin -u root password myFirstpassword 
```

然后在java程序中修改密码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-20T20:01:24.107

用户名/密码错误或用户缺少访问架构/表的权限。使用授予权限

授予所有特权*。*TO 'root'@'localhost' WITH GRANT 选项

# python - matplotlib 对数刻度导致缺失点

> ID：11972096
> 
> 赞同：4
> 
> 时间：2012-08-15T15:16:13.617
> 
> 标签：python, matplotlib

我对 matplotlib 有一个非常奇怪的问题。绘制一些点如下所示：

![正则图](../Images/3da670295ad0b3d84e92ae3e0776e267.png)

当我在 y 轴上切换到对数刻度时，一些点未连接：

![对数刻度](../Images/6fdad7160a62018a58b7d3353c87aa90.png)

这是一个错误吗？我错过了什么吗？代码如下。注释掉对数刻度线以查看第一张图。

```
import matplotlib.pyplot as plt

fig = plt.figure()
ax1 = fig.add_subplot(111)

x = [1.0, 2.0, 3.01, 4.01, 5.01, 6.01, 7.04, 8.04, 9.04, 10.05,
     11.05, 12.09, 13.17, 14.18, 15.73, 16.74, 17.74, 18.9, 19.91,
     20.94, 22.05, 23.15, 24.33, 25.48, 26.51, 27.58, 28.86, 29.93,
     30.93, 32.23, 33.25, 34.26, 35.27, 36.29, 37.33, 38.35, 39.36,
     40.37, 41.37]
y = [552427, 464338, 446687, 201960, 227238, 265140, 148903, 134851,
     172234, 120263, 115385, 100671, 164542, 171176, 28, 356, 0, 0,
     195, 313, 9, 0, 132, 0, 249, 242, 81, 217, 159, 140, 203, 215,
     171, 141, 154, 114, 99, 97, 97]

ax1.plot(x, y, c='b', marker='o')

ax1.set_yscale('log')
plt.ylim((-50000, 600000))
plt.show() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:22:05.843

`log(0)`未定义。我猜 matplotlib 只是忽略`NaN`了这里出现的 s 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-08-18T09:32:49.227

你可以尝试使用`ax1.set_yscale('symlog')`

![使用 symlog 比例绘制数据](../Images/2a755ca500f91e220dd6546e1428f80b.png)

# jquery - jquery form .submit() 仅适用于 Chrome

> ID：11972097
> 
> 赞同：1
> 
> 时间：2012-08-15T15:16:14.833
> 
> 标签：jquery, forms, google-chrome, submit

我正在尝试发布动态创建的表单，并在新窗口中查看结果，它仅适用于 Chrome。FF 和 IE 在点击该代码时什么都不做。

```
$('<form>').attr({ method: 'POST', action: data.Url, target: '_blank' })
    .append($('<input>').attr({ type: 'hidden', name: 'Field1', value: data.field1Data }))
    .append($('<input>').attr({ type: 'hidden', name: 'Field2', value: data.field2Data }))
    .submit(); 
```

什么会导致这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:18:24.097

表单至少需要在 IE 中的文档中，也可能在 Firefox 中：

```
$('<form>').attr({ method: 'POST', action: data.Url, target: '_blank' })
    .append($('<input>').attr({ type: 'hidden', name: 'Field1', value: data.field1Data }))
    .append($('<input>').attr({ type: 'hidden', name: 'Field2', value: data.field2Data }))
    .appendTo("body")
    .submit()
    .remove(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:18:59.167

尝试先将表单附加到您的 html 中，然后在调用 submit() 之前添加到末尾，例如：

```
.appendTo('body').submit(); 
```

# python - 有没有办法用 numpy 有效地反转矩阵数组？

> ID：11972102
> 
> 赞同：15
> 
> 时间：2012-08-15T15:16:32.507
> 
> 标签：python, numpy, linear-algebra, matrix-inverse

通常我会在一个循环中反转一个 3x3 矩阵的数组，`for`如下例所示。不幸的是`for`循环很慢。有没有更快、更有效的方法来做到这一点？

```
import numpy as np
A = np.random.rand(3,3,100)
Ainv = np.zeros_like(A)
for i in range(100):
    Ainv[:,:,i] = np.linalg.inv(A[:,:,i]) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-17T02:34:07.770

事实证明，您在 numpy.linalg 代码中被烧毁了两个级别。如果您查看 numpy.linalg.inv，您会发现它只是对 numpy.linalg.solve(A, inv(A.shape[0]) 的调用。这具有在您的每次迭代中重新创建单位矩阵的效果for 循环。由于所有数组的大小相同，因此这是浪费时间。通过预分配单位矩阵跳过此步骤可节省约 20% 的时间（fast_inverse）。我的测试表明预分配数组或分配它从结果列表中没有太大的区别。

再深入一层，您会发现对 lapack 例程的调用，但它包含在几个健全性检查中。如果你把所有这些都去掉，然后在你的 for 循环中调用 lapack（因为你已经知道矩阵的维度，并且可能知道它是真实的，而不是复杂的），事情运行得更快**（请注意，我已经让我的数组更大了）**：

```
import numpy as np
A = np.random.rand(1000,3,3)
def slow_inverse(A): 
    Ainv = np.zeros_like(A)

    for i in range(A.shape[0]):
        Ainv[i] = np.linalg.inv(A[i])
    return Ainv

def fast_inverse(A):
    identity = np.identity(A.shape[2], dtype=A.dtype)
    Ainv = np.zeros_like(A)

    for i in range(A.shape[0]):
        Ainv[i] = np.linalg.solve(A[i], identity)
    return Ainv

def fast_inverse2(A):
    identity = np.identity(A.shape[2], dtype=A.dtype)

    return array([np.linalg.solve(x, identity) for x in A])

from numpy.linalg import lapack_lite
lapack_routine = lapack_lite.dgesv
# Looking one step deeper, we see that solve performs many sanity checks.  
# Stripping these, we have:
def faster_inverse(A):
    b = np.identity(A.shape[2], dtype=A.dtype)

    n_eq = A.shape[1]
    n_rhs = A.shape[2]
    pivots = zeros(n_eq, np.intc)
    identity  = np.eye(n_eq)
    def lapack_inverse(a):
        b = np.copy(identity)
        pivots = zeros(n_eq, np.intc)
        results = lapack_lite.dgesv(n_eq, n_rhs, a, n_eq, pivots, b, n_eq, 0)
        if results['info'] > 0:
            raise LinAlgError('Singular matrix')
        return b

    return array([lapack_inverse(a) for a in A])

%timeit -n 20 aI11 = slow_inverse(A)
%timeit -n 20 aI12 = fast_inverse(A)
%timeit -n 20 aI13 = fast_inverse2(A)
%timeit -n 20 aI14 = faster_inverse(A) 
```

结果令人印象深刻：

```
20 loops, best of 3: 45.1 ms per loop
20 loops, best of 3: 38.1 ms per loop
20 loops, best of 3: 38.9 ms per loop
20 loops, best of 3: 13.8 ms per loop 
```

**编辑：**我没有仔细研究解决方案中返回的内容。事实证明，“b”矩阵被覆盖并最终包含结果。这段代码现在给出了一致的结果。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-03-30T23:44:05.057

自从提出并回答了这个问题以来，一些事情发生了变化，现在[`numpy.linalg.inv`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.inv.html)支持多维数组，将它们作为矩阵堆栈处理，矩阵索引在最后（换句话说，数组 shape `(...,M,N,N)`）。这似乎是[在 numpy 1.8.0 中引入的](https://docs.scipy.org/doc/numpy-1.14.0/release.html#support-for-linear-algebra-on-stacked-arrays)。不出所料，这是迄今为止性能方面的最佳选择：

```
import numpy as np

A = np.random.rand(3,3,1000)

def slow_inverse(A):
    """Looping solution for comparison"""
    Ainv = np.zeros_like(A)

    for i in range(A.shape[-1]):
        Ainv[...,i] = np.linalg.inv(A[...,i])
    return Ainv

def direct_inverse(A):
    """Compute the inverse of matrices in an array of shape (N,N,M)"""
    return np.linalg.inv(A.transpose(2,0,1)).transpose(1,2,0) 
```

请注意后一个函数中的两个转置：必须将 shape 的输入`(N,N,M)`转置为 shape`(M,N,N)`才能`np.linalg.inv`工作，然后必须将结果置换回 shape `(M,N,N)`。

在 python 3.6 和 numpy 1.14.0 上使用 IPython 进行检查和计时结果：

```
In [5]: np.allclose(slow_inverse(A),direct_inverse(A))
Out[5]: True

In [6]: %timeit slow_inverse(A)
19 ms ± 138 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

In [7]: %timeit direct_inverse(A)
1.3 ms ± 6.39 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-17T01:10:49.573

for 循环确实不一定比替代方案慢很多，而且在这种情况下，它对你没有多大帮助。但这里有一个建议：

```
import numpy as np
A = np.random.rand(100,3,3) #this is to makes it 
                            #possible to index 
                            #the matrices as A[i]
Ainv = np.array(map(np.linalg.inv, A)) 
```

计时此解决方案与您的解决方案会产生一个小但明显的差异：

```
# The for loop:
100 loops, best of 3: 6.38 ms per loop
# The map:
100 loops, best of 3: 5.81 ms per loop 
```

我尝试使用 numpy 例程“矢量化”，希望创建一个更清洁的解决方案，但我必须重新考虑一下。数组 A 中排序的变化可能是最显着的变化，因为它利用了 numpy 数组按列排序的事实，因此数据的线性读出以这种方式稍微快一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-02T15:11:40.840

**Numpy-Blas 调用并不总是最快的可能性**

在您必须计算大量逆数、特征值、小型 3x3 矩阵或类似情况的点积的问题上，我使用的 numpy-MKL 通常会以相当大的优势胜过。

这个外部 Blas 例程通常用于解决较大矩阵的问题，对于较小的矩阵，您可以编写标准算法或查看例如。英特尔 IPP。

请记住，Numpy 默认使用 C 排序数组（最后一个维度变化最快）。对于此示例，我从[Matrix inversion (3,3) python - hard coded vs numpy.linalg.inv 中获取代码](https://stackoverflow.com/q/42489310/4045774)并对其进行了一些修改。

```
import numpy as np
import numba as nb
import time

@nb.njit(fastmath=True)
def inversion(m):
    minv=np.empty(m.shape,dtype=m.dtype)
    for i in range(m.shape[0]):
        determinant_inv = 1./(m[i,0]*m[i,4]*m[i,8] + m[i,3]*m[i,7]*m[i,2] + m[i,6]*m[i,1]*m[i,5] - m[i,0]*m[i,5]*m[i,7] - m[i,2]*m[i,4]*m[i,6] - m[i,1]*m[i,3]*m[i,8])
        minv[i,0]=(m[i,4]*m[i,8]-m[i,5]*m[i,7])*determinant_inv
        minv[i,1]=(m[i,2]*m[i,7]-m[i,1]*m[i,8])*determinant_inv
        minv[i,2]=(m[i,1]*m[i,5]-m[i,2]*m[i,4])*determinant_inv
        minv[i,3]=(m[i,5]*m[i,6]-m[i,3]*m[i,8])*determinant_inv
        minv[i,4]=(m[i,0]*m[i,8]-m[i,2]*m[i,6])*determinant_inv
        minv[i,5]=(m[i,2]*m[i,3]-m[i,0]*m[i,5])*determinant_inv
        minv[i,6]=(m[i,3]*m[i,7]-m[i,4]*m[i,6])*determinant_inv
        minv[i,7]=(m[i,1]*m[i,6]-m[i,0]*m[i,7])*determinant_inv
        minv[i,8]=(m[i,0]*m[i,4]-m[i,1]*m[i,3])*determinant_inv

    return minv

#I was to lazy to modify the code from the link above more thoroughly
def inversion_3x3(m):
    m_TMP=m.reshape(m.shape[0],9)
    minv=inversion(m_TMP)
    return minv.reshape(minv.shape[0],3,3)

#Testing
A = np.random.rand(1000000,3,3)

#Warmup to not measure compilation overhead on the first call
#You may also use @nb.njit(fastmath=True,cache=True) but this has also about 0.2s 
#overhead on fist call

Ainv = inversion_3x3(A)

t1=time.time()
Ainv = inversion_3x3(A)
print(time.time()-t1)

t1=time.time()
Ainv2 = np.linalg.inv(A)
print(time.time()-t1)

print(np.allclose(Ainv2,Ainv)) 
```

**表现**

```
np.linalg.inv: 0.36  s
inversion_3x3: 0.031 s 
```

# android - 当我尝试在设备上运行我的应用程序时，为什么目标下方会出现 X？

> ID：11972104
> 
> 赞同：0
> 
> 时间：2012-08-15T15:16:38.220
> 
> 标签：android, eclipse, target

我在 Windows 上运行 Eclipse，并试图在手机上放置一个稍微更新的程序版本，但是设备的目标下有一个 X，看起来像“X 2.3.5”。我将程序重置为在进行任何更新之前它仍然无法正常工作，即使我今天早上使用了完全相同的程序的旧版本，是否有我错过的更新或我需要更新的东西？任何和所有的帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:27:25.947

确保中`android:minSdkVersion=`声明`AndroidManifest`的版本不大于手机 SDK 的版本。

在这种情况下，应用程序检测到手机的 sdk 版本低于应用程序所需的最低 sdk 版本，并阻止安装它。

# java - 在 Maven 项目中管理 JAXB 生成的类

> ID：11972107
> 
> 赞同：10
> 
> 时间：2012-08-15T15:16:47.047
> 
> 标签：java, jakarta-ee, maven, jaxb, spring-oxm

我有一个基于 Maven 的项目，我尝试添加一些由“jaxb2-maven-plugin”Maven 插件自动生成的 JAXB 类。但是，我的第一次剪辑让我处于循环依赖循环中：

*   因为这些 JAXB 类尚未生成，所以我引用它们的其他来源有编译错误。
*   因为那些其他源有编译错误，所以不会生成这些 JAXB 类。

似乎有两种明显的可能性可以解决这个问题：

1.  注释掉损坏的引用，以便项目构建和 JAXB 类自动生成。然后将这些生成的源代码从 复制`/target`到`/src/main/java`中，这样对它们的引用就不会导致编译错误。
2.  创建一个完全独立的项目，只包含 JAXB 的东西。将其作为依赖项包含在我的主项目中。

我在这里错过了什么吗？选项#1 似乎完全荒谬......这***不可能***是人们使用 JAXB 的方式。选项#2 似乎更合理，但仍然相当低效和麻烦。为了使用 JAXB，我真的必须承担一个完全独立的项目的开销吗？

开发人员是否可以使用更优雅的方法在 Maven 插件生成它们的同一项目中引用 JAXB 生成的类？

**更新：** 根据要求，这是我的 POM 的相关部分：

```
<build>
    <plugins>
        <plugin>
            <!-- configure the compiler to compile to Java 1.6 -->
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>       
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jaxb2-maven-plugin</artifactId>
            <version>1.4</version>
            <executions>
                <execution>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>xjc</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <!-- The name of your generated source package -->
                <packageName>com.mypackage</packageName> 
            </configuration>
        </plugin>
    </plugins>  
</build> 
```

当我运行时，我确实看到在子目录`mvn clean package`下生成了我的 JAXB 源。`/target`但是，这些生成的源不会自动添加到编译阶段的类路径中。

**解决后更新：** 事实证明，我的编译问题更多地与我在 Eclipse 中运行的事实有关，并且它的 Maven 集成与“jaxb2-maven-plugin”有一些问题。有关该问题及其解决方案的更多详细信息，请参阅[此 StackOverflow 问题。](https://stackoverflow.com/questions/10387610/maven-jaxb2-xjc-plugin-m2e-plugin-execution-not-covered/12010610#12010610)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T15:21:20.803

你是如何配置你的 jaxb maven 插件的？通常它在生成源生命周期中运行，该生命周期在编译生命周期之前。因此，当您自己的代码被编译时，您的 JAXB 生成的类应该已经存在，Maven 将它们放在目标/生成源中，并将该文件夹放在类路径中。

**编辑**：这是我在工作中使用的代码（并且按预期工作）：

```
<plugin>
            <groupId>com.sun.tools.xjc.maven2</groupId>
            <artifactId>maven-jaxb-plugin</artifactId>
            <executions>
                <execution>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>generate</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <schemaDirectory>src/main/resources/<companyname>/xsd</schemaDirectory>
                <includeSchemas>
                    <includeSchema>retrieval.xsd</includeSchema>
                    <includeSchema>storage.xsd</includeSchema>
                </includeSchemas>
            </configuration>
        </plugin> 
```

显然我们使用了另一个 jaxb 插件......（另请参阅此线程：[Difference of Maven JAXB plugins](https://stackoverflow.com/questions/2432859/difference-of-maven-jaxb-plugins?rq=1)）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T19:15:21.897

我建议您将 jaxb 生成的类（api）和您的 BL 类（实现）拆分为 2 个 maven 项目，每个项目具有单独的 pom.xml，主根 pom.xml 具有编译顺序。这样，您将能够构建 api.jar，然后 maven 将其安装在本地 repo 中，然后您可以将其用作实现的依赖项。所以它看起来像：

```
-API\
--pom.xml - for api, jaxb generation
-IMPL\
--pom.xml - for impl, api dependency is here
pom.xml - main pom.xml with references to the projects above 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T18:21:39.727

也许尝试使用[`maven-jaxb2-plugin`](http://java.net/projects/maven-jaxb2-plugin/pages/Home)：

```
<plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb2-plugin</artifactId>
    <version>0.8.2</version>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

不过，dfuse 的答案是正确的。任何一个插件都应该在编译之前生成源代码，源代码生成的结果将在类路径中。我用两个插件对此进行了测试。您是否可以发布您的架构，或者至少发布您的代码未能在类路径上获取的类型的架构？

# google-apps-script - 如何登录网站，读取数据？

> ID：11972109
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:16:53.740
> 
> 标签：google-apps-script

我想编写一个访问网站的 GoogleApps 脚本，使用我的凭据登录，从下拉菜单中进行选择并复制显示的值以将它们粘贴到我的活动电子表格中。

这是可能的还是我应该以不同的方式去做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:03:41.387

绝对有可能。捕获您需要为身份验证执行的操作。使用 Google Apps 脚本重复此操作。使用下拉菜单捕获您需要做的事情。使用 Google Apps 脚本重复此操作。

相当通用的说明，但您没有对您的问题提供更多具体信息。使用像 Firefox 的 TamperData 插件来捕获/查看 Google Apps 脚本需要来回传递到服务器的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:56:27.763

直接，这是不可能的。但是，如果网站提供 API 或者网站使用 URL 参数来传递有关您选择的内容的信息，那么网站也*可能*使用 HTTP 身份验证。

# c++ - 删除字符串中紧跟两个元音的所有字符

> ID：11972114
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:17:16.343
> 
> 标签：c++, string

可以删除紧跟两个元音的字符串中的所有字符，而无需借助 char 数组，而只使用“字符串”库 ?

例如：

```
priamo -> iamo 
```

算法应该是：

1.  循环字符串，使 for 循环 from `0`to`string.length()-2`以防止溢出
2.  将字符对与包含所有元音的 char 数组进行比较
3.  使用字符串库中的“擦除”功能删除元音之前的位置

但我不知道如何在没有字符数组的帮助下实现第二点。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:51:58.630

我建议使用[`std::adjacent_find`](http://en.cppreference.com/w/cpp/algorithm/adjacent_find)：

```
std::string s{"priamo"};
auto is_vowel = [](char c) -> bool {
    static const char vowels[] = "aeiou";
    return std::any_of(std::begin(vowels), std::prev(std::end(vowels)),
        [c](char d) { return c == d; } );
};
auto it = std::adjacent_find(s.crbegin(), s.crend(),
    [&](char c, char d) { return is_vowel(c) && is_vowel(d); }).base();
if (it != s.cbegin())
    s.erase(s.cbegin(), std::prev(it, 2)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:57:52.580

他们所说的**没有 char 数组的帮助**可能意味着你不能做任何缓冲。你当然可以使用`const char vowels[]="aeiou";`。

好吧，这可能是错误的，但应该为您提供想法和其他人纠正的基础：

```
string str="priamo";
const char vowels[]="aeiou";
size_t pos=0;
size_t vowels_piled_up=0;
while((pos=str.find_first_of(&vowels[0], pos+vowels_piled_up))!=string::npos)
{
  if((pos+1)+1 >= str.size())//break if it is on the last 2
     break;
  if((strchr(&vowels[0], str[pos+1]))!=NULL)
  {
     str.erase(vowels_piled_up, pos-1-vowels_piled_up);
     pos=0;
     vowels_piled_up+=2;
  }
  else
     ++pos;
} 
```

# iphone - MKMapKit 获得可见的注解视图

> ID：11972116
> 
> 赞同：0
> 
> 时间：2012-08-15T15:17:23.707
> 
> 标签：iphone, objective-c, ios, mkmapview, mkannotationview

我怎样才能得到所有可见的 MKAnnotationViews

```
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)clickedview 
```

基本上我想进行一些计算以使所有视图（级联）触摸clickedview

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:34:01.217

您可以使用`annotationsInMapRect:`来获取地图矩形内的所有注释。`visibleMapRect`将为您提供当前要使用的地图矩形。

# php - 无法通过 Laravel SQLSTATE [08006] [7] FATAL 连接到 PgSQL

> ID：11972121
> 
> 赞同：5
> 
> 时间：2012-08-15T15:17:42.477
> 
> 标签：php, postgresql, centos, sysadmin, laravel

我正在尝试通过 laravel 连接到 pgsql，最后完成了所有设置（运行 pgsql 服务器，安装了 pdo，安装了所有库）。我在通过 CPanel/WHM 管理的 VPS (CentOS) 上运行。

这就是我正在做的事情：我正在尝试使用 migrate:install 通过 artisan（Laravel 的命令行）创建一个用户数据库。

对于不使用 Laravel 的，artisan 使用 php 的 PDO 进行 pgsql 连接。这是我的设置：

```
 'pgsql' => array(
        'driver'   => 'pgsql',
        'host'     => 'localhost',
        'database' => 'dbname',
        'username' => 'username',
        'password' => 'password',
        'charset'  => 'utf8',
        'prefix'   => '',
    ), 
```

我还设置了一个 test.php 文件：

```
$dbconn = pg_connect("host=localhost port=5432 dbname=dbname user=username password=password"); 
```

这也失败了。我使用 phpPgAdmin 来查看发生了什么，并且所有权限都设置正确，数据库显示，用户名正确，密码相同。我检查了 postgre（版本 8.4.12 btw）在哪里运行，phpPgAdmin 告诉我“localhost:5432”。

我通过命令行得到的错误如下：

```
SQLSTATE[08006] [7] FATAL: no pg_hba.conf entry for host "::1", user "myusername", database "my_database", SSL OFF 
```

现在，我试图找到 pg_hba.conf 文件，但我不完全确定在哪里可以找到它。pg 的错误/访问日志也是如此，就这一点而言，谷歌没有任何帮助。

知道我能做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:28:34.010

I was able to install/configure everything correctly. I changed the "host" to 127.0.0.1, not sure why that made a difference but it did :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T15:47:11.830

localhost 指向您系统上的 IPV6 ::1 地址。Postgresql 在处理访问列表时会区分 ipv6 和 ipv4 地址。

# php - php中三元运算符的使用

> ID：11972125
> 
> 赞同：3
> 
> 时间：2012-08-15T15:17:45.893
> 
> 标签：php

我是 PHP 新手，正在尝试学习。

是否可以避免使用临时变量？

```
<?php

    function get_name()
    {
        // assume that this function return 3 
        // values on different conditions "name0" "name1" or "name2";
    }

    $result =  ( get_name() == "name0" || get_name() == "name1") ? "Primary" : "Secondary" ;
    echo $result;

?> 
```

在上面我调用了`get_name()`两次函数，这意味着对同一个函数的两次调用。

是否可以通过一次调用来实现相同的目标而不将其保存到临时变量中？

常用的做法是什么？

**更新：我将问题编辑得更具体。几乎所有答案都令人满意，希望此更新对新读者有所帮助。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T15:21:05.717

我会这样做：

```
$result =  in_array(get_value(), array(0, NULL), true) ? "Zero" : "One" ; 
```

文档：[in_array](http://php.net/in_array)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T15:20:51.537

这个怎么样？

```
$result = get_value() ? "One" : "Zero"; 
```

这会导致`get_value()`类型转换为布尔值。 变成变成变成. `null`_`0``false``1``true`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:22:52.650

由于使用了运算符，该函数被调用了两次`===`，并且仅当返回值恰好是`0`or时才会输出零`null`，但如果它是 false 或空字符串则不会。

一种常见的方法是

```
$result =  ( get_value() ) ? "Zero" : "One" ; 
```

这也将输出零`false`和空字符串。

如果您需要严格检查，并假设 get_value() 是一个昂贵的函数，您可以这样做：

```
$result =  ( in_array(get_value(), array(0, null), true ) ? "Zero" : "One" ; 
```

还有 2 个函数调用，但一个是函数调用`in_array`。

如果您只是将结果保存在临时变量中，它会更具可读性。

更好的是，不要从 get_value() 函数返回混合结果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T15:21:38.593

尝试

```
<? echo (get_value())?"One":"Zero";?> 
```

# json - 用于验证 json 模式的 jmeter 断言

> ID：11972130
> 
> 赞同：4
> 
> 时间：2012-08-15T15:17:55.410
> 
> 标签：json, jmeter, assertions

我目前正在测试一个输出 json 的 Web 应用程序。我想确保 JSON 是有效的。我不想验证它的内容。如何在 jmeter 中实现断言以确保 json 响应有效？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T20:04:49.357

如果要使用 groovy，请使用 beanshell 断言、jsr223 断言或 bsf 断言：

*   [BeanShell 断言](http://jmeter.apache.org/usermanual/component_reference.html#BeanShell_Assertion)
*   [JSR223 断言](http://jmeter.apache.org/usermanual/component_reference.html#JSR223_Assertion)
*   [BSF 断言](http://jmeter.apache.org/usermanual/component_reference.html#BSF_Assertion)

并使用一些 json 解析器解析响应：

*   [如何使用 groovy 解析 json](https://stackoverflow.com/questions/6688090/how-to-parse-json-using-groovy)

*   [http://mrhaki.blogspot.com/2011/04/groovy-goodness-parse-json-with.html](http://mrhaki.blogspot.com/2011/04/groovy-goodness-parse-json-with.html)

Jmeter 会将先前的采样器响应作为脚本变量提供给您的脚本。

请注意，这可能会影响测试计划的性能，因为它的成本相当高。

问候

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-25T03:29:48.233

我通常使用[javascript BSF Assertion](http://fabiouechi.blogspot.com.br/2012/04/jmeter-using-bsf-assertion-to-fail.html)。由于 JSON 是 javascript 对象，您可以尝试在 try-catch 块中评估响应，如果它失败，您可以显式地使先前的 SampleResult 失败。

```
try {
   eval('var response = ' + prev.getResponseDataAsString());
} catch(e) {
      prev.setSuccessful(false);
      prev.setResponseMessage("Invalid response. Expected a valid JSON.");
} 
```

# c++ - ptr_vector 未正确释放

> ID：11972133
> 
> 赞同：1
> 
> 时间：2012-08-15T15:18:06.750
> 
> 标签：c++, boost, ptr-vector, boost-ptr-container

我正在尝试使用 ptr_vector 来存储一些指针，但是一旦我的 main 方法出现错误。这是我的代码：

```
int main(void)
{
    boost::ptr_vector<string> temp;
    string s1 = "hi";
    string s2 = "hello";
    temp.push_back(&s1);
    temp.push_back(&s2);
    return 0;
} 
```

这是我收到的错误消息：

```
Critical error detected c0000374
Windows has triggered a breakpoint in Path_Tree.exe.

This may be due to a corruption of the heap, which indicates a bug in Path_Tree.exe or     any of the DLLs it has loaded.

This may also be due to the user pressing F12 while Path_Tree.exe has focus.

The output window may have more diagnostic information.
The program '[7344] Path_Tree.exe: Native' has exited with code 0 (0x0). 
```

我究竟做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T15:20:46.080

`ptr_vector`获取您给它的指针所指向的对象的所有权（这意味着它`delete`在完成这些指针时会调用它们）。如果您只想要一个指针向量，请使用：

```
int main()
{
    std::vector<string*> temp;
    //s1 and s2 manage their own lifetimes
    //(and will be destructed at the end of the scope)
    string s1 = "hi";
    string s2 = "hello";
    //temp[0] and temp[1] point to s1 and s2 respectively
    temp.push_back(&s1);
    temp.push_back(&s2);
    return 0;
} 
```

否则，您应该使用 new 分配字符串，然后 push_back 结果指针：

```
int main()
{
    boost::ptr_vector<string> temp;
    temp.push_back(new string("hi"));
    temp.push_back(new string("hello"));
    return 0;
} 
```

如果您只想要一个字符串容器，通常的做法是字符串向量：

```
int main()
{
    std::vector<string> temp;
    //s1 and s2 manage their own lifetimes
    //(and will be destructed at the end of the scope)
    string s1 = "hi";
    string s2 = "hello";
    //temp[0] and temp[1] refer to copies of s1 and s2.
    //The vector manages the lifetimes of these copies,
    //and will destroy them when it goes out of scope.
    temp.push_back(s1);
    temp.push_back(s2);
    return 0;
} 
```

`ptr_vector`旨在使具有值语义的多态对象更容易。如果您的字符串首先不是多态的，那么`ptr_vector`完全没有必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:20:02.960

`ptr_vector`旨在存储指向动态分配对象的指针。然后它取得它们的所有权并在其生命周期结束时删除它们。如果将指针传递给无法删除的对象，则会得到未定义的行为。

```
int main(void)
{
    boost::ptr_vector<std::string> temp;
    temp.push_back(new std::string("hi"));
    temp.push_back(new std::string("hello"));
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:21:34.533

如果您不打算将指针推回它，那么使用 ptr_vector 是没有意义的。

使用 std::vector 或推回使用 new 关键字分配的字符串。

# saml-2.0 - 为身份提供者场景设置 OpenSSO (OpenAM)

> ID：11972136
> 
> 赞同：0
> 
> 时间：2012-08-15T15:18:14.440
> 
> 标签：saml-2.0, openam

我们在最后设置了一个 OpenSSO (OpenAM) 实例，以作为服务提供商 (SP) 工作。到目前为止，它在 SP 发起的 SSO 场景中运行良好，但是，我最近不得不为 IDP 发起的场景设置它，但无法让它成功运行。解释一下，在这种情况下，IDP 想将 SAMLResponse 直接发送到我端的 Assertion 消费者服务，我们的 OpenAM 实例应该能够成功消化响应并将用户发送到我们的底层应用程序。我的问题是：

1.  除了在 IDP 和我们 (SP) 之间交换/上传元数据之外，在这种情况下是否需要任何其他配置？

2.  我可以将 iDP 的元数据上传到与当前在 SP 启动方案中工作的其他 IDP 相同的 COT 中吗？还是每个 IDP 提供者都应该有一个新的 COT？

3.  我应该向 IDP 提供哪个 URL 以将 SAMLResponse 发送到？是我们元数据中的 AssertionConsumerService index="1" isDefault="true" Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" 吗？几天前我尝试了这个，OpenAM 报告了一个错误——“这不是这个请求的正确消费者服务”或其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T18:28:26.827

我在 OpenAM 论坛上得到了答案——

```
http://lists.forgerock.org/pipermail/openam/2012-August/007872.html 
```

# internet-explorer-7 - IE7 中不显示 inline-block 元素

> ID：11972142
> 
> 赞同：2
> 
> 时间：2012-08-15T15:18:29.807
> 
> 标签：internet-explorer-7, css

所以，这是一个奇怪的...

我有基本的分页代码：

```
<div class="pagination">
    <a href="#" class="prev">&lt;</a> <a href="#">1</a> <a class="current">2</a> <a href="#">3</a> <a href="#" class="next">&gt;</a>
</div> 
```

我希望它全部居中，所以我在锚标签上使用 inline-block。很简单，精简了 CSS 代码：

```
.pagination{text-align:center; margin-bottom:20px;}
.pagination > a{display:inline-block; vertical-align:middle; margin:0 2px 0 1px;}
.ie7 .pagination > a{zoom:1;}
.pagination .next,
.pagination .prev{width:26px; height:38px; text-indent:-9999px; overflow:hidden;
background:url(../images/page-arrows.png) no-repeat;}
.pagination a{width:37px; height:31px; line-height:32px; font-size:15px; font-weight:bold; color:#7e7e7e;
background:url(../images/page-numbers.png) left top no-repeat;} 
```

问题是，IE7 中没有显示任何内容（至少 IE9 的 IE7 模式）。我很清楚 IE7 的显示内联错误，但这些错误仅适用于默认情况下不是内联的元素。无论如何，我已经添加了 zoom:1 以进行良好的衡量。

如果我在 .pagination 包装器上放置背景颜色，该包装器确实会显示背景颜色，但里面的元素没有显示！

我已经在任何元素上尝试了通常的 IE 'fixes' ...position:relative, zoom:1, height:1% ，但不是运气。

我错过了什么？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:43:18.287

在 JSFiddle 中进行了一些实验后，我设法发现问题与这个特定规则有关

```
.pagination .prev {text-indent:-9999px; } 
```

禁用此功能可以解决问题，但并不理想，因为您会让文本字符出现在背景图像的顶部。

有趣的是，您`.next`不会导致同样的问题。考虑到这一点，在您的分页控件的任一侧添加了一个`&nbsp;`（因此您的中心对齐不会倾斜），它似乎解决了这个问题。

```
<div class="pagination"> 
    &nbsp; 
    <a href="#" class="prev">&lt;</a> <a href="#">1</a> <a class="current">2</a> <a href="#">3</a> <a href="#" class="next">&gt;</a> 
    &nbsp;
</div> 
```

[JSFiddle 可在此处获得](http://jsfiddle.net/t9QA2/)（背景图片替换为纯色，原因很明显）

# cloudbees - 如何为部署在 RUN@Cloud 上的应用程序设置时区

> ID：11972149
> 
> 赞同：1
> 
> 时间：2012-08-15T15:18:56.140
> 
> 标签：cloudbees

我正在使用云蜜蜂来运行我们的应用程序。但时间以格林威治标准时间显示。我们想要的是 IST 吗？

这是示例代码：

```
Calendar cal = Calendar.getInstance(); 
TimeZone istTime = TimeZone.getTimeZone("IST"); 
cal.setTimeZone(istTime); 
Date chkOut = cal.getTime(); 
startTripMapperObj.setRentalStartTime(chkOut); 
Date chkOut2 = startTripMapperObj.getRentalStartTime(); 
RentalTrip r = new RentalTrip(); 
```

这是输出：

```
Trip Check In   Wed Aug 15 14:34:20 GMT 2012 
Trip Check Out  Wed Aug 15 14:12:00 GMT 2012 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:18:56.140

默认情况下，时区是 GMT - 对于 java 应用程序，您可以自己设置时区（我看到有些人在 servlet 上下文侦听器中这样做，因此它在应用程序启动时运行）。

如果您使用的是 cloudbees SDK，您还可以设置 jvmTimeZone=XXX 参数，该参数将从那时起为该应用程序的所有实例设置它。

# c - RECV 动态内存分配

> ID：11972157
> 
> 赞同：2
> 
> 时间：2012-08-15T15:19:20.070
> 
> 标签：c, sockets, dynamic, recv

在 CI 中，我希望读取页面的 html，但我希望保存数据的缓冲区是动态的。我知道我将不得不通过循环和使用来做到这一点，`realloc`但我不太确定我将如何去做。假设我的套接字 ( `sock`) 已经打开，请考虑以下事项：

```
char *buffer = ???, *tmp;  //just my guess I'm fairly certain buffer cannot be NULL considering my recv loop...
int q = 0, c;
int i = 1;       //buffer size

    while(q < i)
{
    c == recv(sock, buffer + q, i - q, 0);
    if(c == SOCKET_ERROR) break;
    i += c;
    tmp = realloc(buffer, i * sizeof(char));
    //if(!tmp) /*not important right now I can add error handling later*/;
    buffer = tmp;      
    q += c;
} 
```

这将是我对如何实现目标的最佳猜测，但我非常怀疑这会奏效，我只需要一些见解或纠正。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:35:26.910

代码中的一些严重错误：

```
c == recv(... 
```

`==`是比较，而不是分配，您将永远得到`0`or `1`。然后：

```
tmp = realloc(buffer, i * sizeof(char)); 
```

`sizeof(char)`根据定义`1`，您必须对照 . 检查返回值`NULL`。此外，将变量命名为有意义的名称 - 以后会为您节省很多痛苦。

现在，您正在尝试执行诸如“后分配”之类的操作-读入缓冲区，然后将其扩展到您刚刚获得的大小-有点倒退。

简单的解决方案（众多之一）：

*   预先分配缓冲区，
*   在循环中读入它，跟踪累积的大小（以及偏移量），
*   如果缓冲区空间不足 - 将其重新分配为前一个**大小的两倍**，然后继续。

这*在大部分时间都有效^(TM)*。如果对方不断向您提供数据，您可能需要添加一些健全性检查，以免吞噬您的所有内存。

希望这可以帮助。

# sql - 使用临时列更新 Oracle 表中的条目

> ID：11972160
> 
> 赞同：1
> 
> 时间：2012-08-15T15:19:26.813
> 
> 标签：sql, oracle

对于以下查询获得的所有结果，如何将 a.age 和 b.age 更新为 32。临时列是“CID”，如下例所示

```
select * 
  from (SELECT ROW_NUMBER() 
               OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
          FROM (select CUST_NAME,AGE,CITY,COLUMNB
                  from SOMETABLE 
                 where date = '26-jULY-2012'))a 
  RIGHT join (select * 
                from (SELECT ROW_NUMBER() 
                             OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
                       FROM (select CUST_NAME,AGE,CITY,COLUMNB
                               from SOMETABLE2 
                              where date = '26-jULY-2012')))b 
         on a.CID=b.CID 
   and a.CUST_NAME=b.CUST_NAME  
 ORDER BY a.CUST_NAME,A.CID,a.COLUMNB; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:24:00.127

```
update sometable
set age = 32
where cid in (
select a.cid
  from (SELECT ROW_NUMBER() 
               OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
          FROM (select CUST_NAME,AGE,CITY,COLUMNB
                  from SOMETABLE 
                 where date = '26-jULY-2012'))a 
  RIGHT join (select * 
                from (SELECT ROW_NUMBER() 
                             OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
                       FROM (select CUST_NAME,AGE,CITY,COLUMNB
                               from SOMETABLE2 
                              where date = '26-jULY-2012')))b 
         on a.CID=b.CID 
   and a.CUST_NAME=b.CUST_NAME  
)
;

update sometable2
set age = 32
where cid in (
select b.cid
  from (SELECT ROW_NUMBER() 
               OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
          FROM (select CUST_NAME,AGE,CITY,COLUMNB
                  from SOMETABLE 
                 where date = '26-jULY-2012'))a 
  RIGHT join (select * 
                from (SELECT ROW_NUMBER() 
                             OVER (PARTITION BY CUST_NAME ORDER BY CUST_NAME) AS CID,CUST_NAME,AGE,CITY,COLUMNB 
                       FROM (select CUST_NAME,AGE,CITY,COLUMNB
                               from SOMETABLE2 
                              where date = '26-jULY-2012')))b 
         on a.CID=b.CID 
   and a.CUST_NAME=b.CUST_NAME  
)
; 
```

# vb.net - 在 Printer.Print 方法中使用分号 (;)

> ID：11972165
> 
> 赞同：1
> 
> 时间：2012-08-15T15:19:59.000
> 
> 标签：vb.net, vb6-migration

我正在将 VB3 迁移到 VB.Net，并且遇到了在 VB 3 中使用 Printer 对象的打印功能。通过使用 Vb.Net 电源包，我们也可以访问 Printer 对象。

现在的问题是如何传递一个“;” 打印方法的参数 *[VB3 中的代码]*

```
Sub Printer_Print (tabcol As Integer, detail As String, crlf As String)
    If crlf = ";" Then
            Printer.Print Tab(tabcol); detail;
    Else
            Printer.Print Tab(tabcol); detail
    End If
End Sub 
```

尝试使用 ControlChars.Tab，如下所示，但它不起作用 *[VB.Net 中的代码]*

```
Private Sub PrinterPrint(ByRef tabcol As Short, ByRef detail As String, ByRef crlf As String)

  If crlf = ";" Then
          objPrinter.Print(TAB(tabcol), detail, ControlChars.Tab)
  Else
          objPrinter.Print(TAB(tabcol), detail)
  End If
End Sub 
```

感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:53:35.847

[`Printer.Write`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.powerpacks.printing.compatibility.vb6.printer.write)如果您不想获得自动换行，请改用。

然而，这充其量应该是一个短暂的过渡解决方案。兼容性包并不是很好的 .NET 代码，并且它没有与其余代码进行逻辑集成。相反，从长远来看，[改用适当的 .NET 功能](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx)。它们的工作方式*完全*不同，但功能要强大得多，而且使用起来也稍微复杂一些。

# c# - 有效的 JSON 到 C# 中的对象

> ID：11972166
> 
> 赞同：3
> 
> 时间：2012-08-15T15:19:59.827
> 
> 标签：c#, json, object, literals

我正在尝试将一段 JSON 反序列化为 C# 对象，但到目前为止收效甚微。根据[http://jsonlint.com/](http://jsonlint.com/)，以下字符串是有效的 JSON。但是，其中似乎没有任何变量名称。我习惯于看到带有“objectID”、“objectName”等字符串的 JSON。在这种情况下，我可以创建一个带有 objectID 和 objectName 等字段的 C# 对象，然后像这样反序列化整个内容： `Quote deserializedProduct = JsonConvert.DeserializeObject<Product>(json);`

关于我如何做到这一点的任何建议？例如，我看不到它只会反序列化为一系列锯齿状或嵌套数组的方法。将不胜感激任何帮助。

```
{
"ABCXYZ": {
    "Wed, Aug 29|Wed|29 Aug 12": [
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 812~ ~~ABC~08/29/2012 06:35~XYZ~08/29/2012 07:45~",
            "No Taxes",
            "2012-08-29 06:35",
            "2012-08-29 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 816~ ~~ABC~08/29/2012 14:55~XYZ~08/29/2012 16:05~",
            "No Taxes",
            "2012-08-29 14:55",
            "2012-08-29 16:05",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~08/29/2012 19:50~XYZ~08/29/2012 20:55~",
            "No Taxes",
            "2012-08-29 19:50",
            "2012-08-29 20:55",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ]
    ],
    "Thu, Aug 30|Thu|30 Aug 12": [
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 812~ ~~ABC~08/30/2012 06:35~XYZ~08/30/2012 07:45~",
            "No Taxes",
            "2012-08-30 06:35",
            "2012-08-30 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 816~ ~~ABC~08/30/2012 08:30~XYZ~08/30/2012 09:40~",
            "No Taxes",
            "2012-08-30 08:30",
            "2012-08-30 09:40",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~08/30/2012 22:10~XYZ~08/30/2012 23:15~",
            "No Taxes",
            "2012-08-30 22:10",
            "2012-08-30 23:15",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ]
    ],
    "Fri, Aug 31|Fri|31 Aug 12": [
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 812~ ~~ABC~08/31/2012 06:35~XYZ~08/31/2012 07:45~",
            "No Taxes",
            "2012-08-31 06:35",
            "2012-08-31 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~C~C4LOW~BND4~~1~X",
            "FR~ 816~ ~~ABC~08/31/2012 13:20~XYZ~08/31/2012 14:30~",
            "No Taxes",
            "2012-08-31 13:20",
            "2012-08-31 14:30",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 32.74
                        }
                    ]
                }
            ],
            2,
            0,
            0,
            0
        ],
        [
            "0~C~C4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~08/31/2012 19:50~XYZ~08/31/2012 20:55~",
            "No Taxes",
            "2012-08-31 19:50",
            "2012-08-31 20:55",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 32.74
                        }
                    ]
                }
            ],
            3,
            0,
            0,
            0
        ]
    ],
    "Sat, Sep 01|Sat|01 Sep 12": [
        [
            "0~C~C4LOW~BND4~~1~X",
            "FR~ 812~ ~~ABC~09/01/2012 08:05~XYZ~09/01/2012 09:15~",
            "No Taxes",
            "2012-09-01 08:05",
            "2012-09-01 09:15",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 32.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~W~W4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~09/01/2012 17:00~XYZ~09/01/2012 18:05~",
            "No Taxes",
            "2012-09-01 17:00",
            "2012-09-01 18:05",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 11.74
                        }
                    ]
                }
            ],
            2,
            0,
            0,
            0
        ]
    ],
    "Sun, Sep 02|Sun|02 Sep 12": [
        [
            "0~N~N16SEP~FCCG~~3~X",
            "FR~ 812~ ~~ABC~09/02/2012 06:35~XYZ~09/02/2012 07:45~",
            "No Taxes",
            "2012-09-02 06:35",
            "2012-09-02 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 9.75
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~H~H4LOW~BND4~~1~X",
            "FR~ 816~ ~~ABC~09/02/2012 14:55~XYZ~09/02/2012 16:05~",
            "No Taxes",
            "2012-09-02 14:55",
            "2012-09-02 16:05",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 23.74
                        }
                    ]
                }
            ],
            1,
            0,
            0,
            0
        ],
        [
            "0~K~K4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~09/02/2012 20:25~XYZ~09/02/2012 21:30~",
            "Regular Fare",
            "2012-09-02 20:25",
            "2012-09-02 21:30",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "Tax": 36,
                            "FarePrice": 33.99
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ]
    ],
    "Mon, Sep 03|Mon|03 Sep 12": [
        [
            "0~N~N16SEP~FCCG~~3~X",
            "FR~ 812~ ~~ABC~09/03/2012 06:35~XYZ~09/03/2012 07:45~",
            "No Taxes",
            "2012-09-03 06:35",
            "2012-09-03 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 9.75
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~A~A4LOW~BND4~~1~X",
            "FR~ 818~ ~~ABC~09/03/2012 14:35~XYZ~09/03/2012 15:40~",
            "No Taxes",
            "2012-09-03 14:35",
            "2012-09-03 15:40",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "CANX": 2,
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 17.74
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~N~N16SEP~FCCG~~3~X",
            "FR~ 816~ ~~ABC~09/03/2012 22:55~XYZ~09/03/2012 23:59~",
            "No Taxes",
            "2012-09-03 22:55",
            "2012-09-03 23:59",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 9.75
                        }
                    ]
                }
            ],
            3,
            0,
            0,
            0
        ]
    ],
    "Tue, Sep 04|Tue|04 Sep 12": [
        [
            "0~N~N16SEP~FCCG~~3~X",
            "FR~ 812~ ~~ABC~09/04/2012 06:35~XYZ~09/04/2012 07:45~",
            "No Taxes",
            "2012-09-04 06:35",
            "2012-09-04 07:45",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 9.75
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ],
        [
            "0~N~N16SEP~FCCG~~3~X",
            "FR~ 818~ ~~ABC~09/04/2012 19:50~XYZ~09/04/2012 20:55~",
            "No Taxes",
            "2012-09-04 19:50",
            "2012-09-04 20:55",
            [
                {
                    "ADT": [
                        1,
                        "0.00",
                        "0",
                        {
                            "WC": 6,
                            "ETS": 0.25,
                            "FarePrice": 9.75
                        }
                    ]
                }
            ],
            -1,
            0,
            0,
            0
        ]
    ]
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:41:51.873

```
var obj = (JObject)JsonConvert.DeserializeObject(json);

foreach (JProperty item in obj["ABCXYZ"].Children())
{
    Console.WriteLine(item.Name);
    foreach (var x in item)
    {
        foreach (var y in x)
        {
            Console.WriteLine("\t==> " + y[0]);
        }
    }
} 
```

*PS：您的 json 很难阅读。[Json Viewer](http://jsonviewer.codeplex.com/)可以帮助轻松查看其结构。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-20T00:08:43.093

Newtonsoft 是我最喜欢在 C# 中处理 JSON 的方式，我经常使用不同编程语言的 JSON，使用它就像使用 Javascript 或 PHP 一样简单。

这是最简单的例子之一

```
string json_string = @"{
                  Firstname: ""Jane"",
                  Lastname: ""Doe"",
                  Age: 36,
                  IsEmployed: true,
                  IsMarried: true,
                  Children: 4
              }";

var person = Newtonsoft.Json.JsonConvert.DeserializeObject<dynamic>(json_string);

Console.WriteLine(person.Forename);
Console.WriteLine(person.Lastname);
Console.WriteLine(person.Age);
Console.WriteLine(person.IsEmployed);
Console.WriteLine(person.IsMarried);
Console.WriteLine(person.Children); 
```

无论结构如何，它都会动态生成对象！其他解决方案不适用于所有 .NET 版本。

我在这里写了一篇简单易懂的文章[https://turmanauli.medium.com/a-complete-guide-for-serializing-json-to-dynamic-objects-on-the-fly-in-c- 7ab4799f648d](https://turmanauli.medium.com/a-complete-guide-for-serializing-json-to-dynamic-objects-on-the-fly-in-c-7ab4799f648d) 关于如何在 Visual Studio 项目中通过 NuGet 包管理器安装和使用 Newtonsoft。

# sql-server - 使用 $ 的 SQL Server OpenQuery 到 Oracle 架构

> ID：11972172
> 
> 赞同：0
> 
> 时间：2012-08-15T15:20:14.597
> 
> 标签：sql-server, oracle, schema, linked-server, openquery

我正在尝试从 SQL Server 2008 R2 连接到 Oracle 链接服务器，但 Oracle 架构中有一个 $ 符号。不幸的是，我无法更改架构名称，但在尝试使用 OpenQuery 提取信息时，它似乎给我带来了问题。有可能逃脱这个角色吗？

```
select * 
FROM OPENQUERY(linksrv, 'SELECT * FROM [ABC$SCHEMA].[TABLE] where [ID] = ''ABCD0001'' ') oq 
```

以上给了我一条错误消息，如下所示：

```
OLE DB provider "OraOLEDB.Oracle" for linked server "linksrv" returned message "ORA-00903: invalid table name". 
```

下面的查询有效，但是在 Oracle 数据库上运行需要半秒钟的东西速度很慢，所以我希望 OPENQUERY 可能会给我更快的结果？

```
SELECT *
  FROM [linksrv]..[ABC$SCHEMA].[TABLE]
  where [ID] = 'ABCD0001'
GO

Version information:
Microsoft SQL Server Management Studio      10.50.2500.0
Microsoft Analysis Services Client Tools    10.50.2500.0
Microsoft Data Access Components (MDAC)     6.1.7601.17514
Microsoft MSXML             3.0 6.0 
Microsoft Internet Explorer         9.0.8112.16421
Microsoft .NET Framework            2.0.50727.5456
Operating System                6.1.7601

Oracle Database 10g Enterprise Edition Release 10.2.0.4.0 - 64bi 
```

任何帮助将不胜感激！！

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:01:31.397

根据评论，Oracle 的语法似乎应该不同，其中方括号实际上会导致问题而不是阻止问题：

```
SELECT * 
FROM OPENQUERY(linksrv, 'SELECT * FROM ABC$SCHEMA.TABLE ...') AS oq; 
```

# php - 可靠的方法来计算给定的年份和季度是否在另一个之前或之后？

> ID：11972174
> 
> 赞同：1
> 
> 时间：2012-08-15T15:20:23.020
> 
> 标签：php, date

例如给定：

```
$quarter1 = 4;
$year1 = 2011;

$quarter2 = 3;
$year2 = 2012; 
```

我需要知道第二组与第一组相比是未来的。

我确实认为这可以通过将季度附加到年份来完成。例如

```
$qy1 = 20114;
$qy2 = 20123;
// $qy1 < $qy2 
```

但我确信这不是比较两者的可靠方法。有没有更好、更可靠的方法？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:28:15.843

除了必须进行一些字符串连接并将类型转换回 int 之外，您的方法没有任何问题。但是，如果您未能将值强制恢复为整数，并且您正在比较具有不同字符串长度的年份，则它可能会失败，例如：

```
$date1 = '9994';  // year 999, q4
$date2 = '10011'; // year 1001, q1 
```

字符串 9994 将比字符串 10011 大。

纯粹作为替代方案，这也可以，保持纯数字：

```
$date1 = $year1 + (($quarter1 - 1) / 4);
$date2 = $year2 + (($quarter2 - 1) / 4);
if ($date1 < $date2) { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:25:53.957

是的，我确实认为这是最好、最简单、最快的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T15:26:10.097

```
if($year1<$year2 || $year1==$year2 && $quarter1<$quarter2)
    echo "Date1 is before Date2!";
else
    echo "Date1 is NOT before Date2!"; 
```

# html - 是否可以在 swf 文件中放置 iframe？

> ID：11972175
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:20:27.267
> 
> 标签：html, flash

我试图四处寻找，但什么也没找到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:22:40.667

你可以使用类似...

[http://code.google.com/p/htmlwrapper/](http://code.google.com/p/htmlwrapper/)

或者

[http://sourceforge.net/projects/as3htmlparser/](http://sourceforge.net/projects/as3htmlparser/)

* * *

这个我没试过，但是...

[https://github.com/flex-users/flex-iframe](https://github.com/flex-users/flex-iframe)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T05:43:03.870

这可用于在 Flex 应用程序中插入 iFrame。

[https://github.com/flex-users/flex-iframe](https://github.com/flex-users/flex-iframe)

# shell - 用于迭代文件的 Shell 脚本。第 3 行出现错误

> ID：11972176
> 
> 赞同：0
> 
> 时间：2012-08-15T15:20:36.250
> 
> 标签：shell

```
#!/bin/bash
for dir in /home/username/git/*/
do
    for file in "$dir"/*
    do
        if [[ -f $file ]]
        then
            echo   "$file"
        fi
    done
done 
```

当我尝试运行它时。我有

```
syntax error near unexpected toke' `do
'rocTest.sh: line 3: `do 
```

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-11T11:31:36.523

始终使用`"$file"`（带引号）来处理“有问题的”文件名；特别`if [[ -f $file ]]`应该是

`if [[ -f "$file" ]] ...`

请注意，bash 并不总是在 /bin 中（例如 FreeBSD 将它放在 /usr/local/bin 中）；为了更广泛的便携性，要么使用

`#!/usr/bin/env bash`

或者`#!/bin/sh`并确保**删除 bash-isms**（例如`checkbashisms`在 Debian/Ubuntu 上使用）。例如写`if test -f "$file"`而不是`[[ -f "$file" ]]`

# javascript - 使用 JavaScript 动态加载 CSS 文件

> ID：11972177
> 
> 赞同：0
> 
> 时间：2012-08-15T15:20:36.140
> 
> 标签：javascript, css

我正在一个站点上工作，我需要检查远程主机上的 CSS 文件是否存在，然后加载同一 CSS 文件的本地副本（如果不存在）。

我正在处理的代码，

```
<script>
function UrlExists(url)
{
    var http = new XMLHttpRequest();
    http.open('HEAD', url, false);
    http.send();
    return http.status!=404;
}
function AddLocalCss(){ document.write('<link rel="stylesheet" type="text/css"  href="css/html5-reset.min.css">') }
</script>
<script>!UrlExists('http://meyerweb.com/eric/tools/css/reset/reset.css') && AddLocalCss();</script> 
```

但这会引发错误，（在 Chrome 开发人员工具中检查时）

```
XMLHttpRequest cannot load http://meyerweb.com/eric/tools/css/reset/reset.css. Origin http://example.com is not allowed by Access-Control-Allow-Origin.
Uncaught Error: NETWORK_ERR: XMLHttpRequest Exception 101 
```

任何人都可以提出解决方案或解决方法来实现这一目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:28:42.403

you can use some of the functionality of this post: [Dynamically loading css file using javascript with callback without jQuery](https://stackoverflow.com/questions/5537622/dynamically-loading-css-file-using-javascript-with-callback-without-jquery), you can use straight that function.

I hope this would help

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:28:51.620

XHR is limited by [Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy) - you can't request resources from another domain/protocol without jumping extra hoops. You must either request remote server to set up [CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing) or don't use XHR at all.

Instead of it you can just generate a `link` element and watch either its state or state of other elements that loaded style would affect. Unfortunately this behavior is not standartized across browsers, but, fortunately, there are some libraries to simplify dealing with it. Check out [Ensure](http://labs.omaralzabir.com/ensure/).

# javascript - 从另一个（初学者里面）到达一个嵌套的javascript函数

> ID：11972180
> 
> 赞同：0
> 
> 时间：2012-08-15T15:20:43.533
> 
> 标签：javascript, jquery, function

我使用在互联网上找到的幻灯片系统，并尝试对其进行一些调整。那里有两个 js 文件，每个文件都由如下函数组成：

```
(function($) {
    $.file1 = function(data, vData) 
    {
       //function aaa
       //function bbb
       //function ccc
    }
})(jQuery);

(function($) {
    $.file2 = function(data, vData) 
    {
       //function eee
       //function fff
       //function gig
    }
})(jQuery); 
```

如何从函数 bbb 内部触发函数 eee？

我从 bbb 函数内部尝试了这些，但没有奏效：

```
eee();
$.file2.eee(); 
```

我不是要返回一个变量，我只需要触发函数。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:26:13.160

您需要将函数公开给其他范围：

```
(function($) {
    $.file1 = function(data, vData) {
       //function aaa
       //function bbb
       //function ccc
       return {
           aaa: aaa,
           bbb: bbb,
           ccc: ccc
       };
    }
})(jQuery);

$.file1().aaa();
$.file1().bbb();
$.file1().ccc(); 
```

请注意，这是定义函数的一种非常尴尬的模式。尚不完全清楚您要使用此模式完成什么。[使用IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)可能会更好：

```
var thing = (function($) {
    //function aaa
    //function bbb
    //function ccc

    return {
        aaa: aaa,
        bbb: bbb,
        ccc: ccc
    };
})(jQuery);

thing.aaa();
thing.bbb();
thing.ccc(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:10:17.143

我要感谢大家的帮助。

我所做的是：在调用函数 bbb（在文件 2 中）中，我添加了以下内容：

```
$.file1.triggerEee(); 
```

在文件 1 ($.file1) 的主函数中，我添加了这个：

```
$.file1.triggerEee=function(){eee();}; 
```

它成功了。

非常感谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:24:13.193

在这两个函数 jquery 调用中只引用方法，不要在那里实现它。如果您在其他地方实现它，它将非常容易参考。

# java - 如何在 GLES2.0 中翻译相机？

> ID：11972182
> 
> 赞同：1
> 
> 时间：2012-08-15T15:20:47.653
> 
> 标签：java, android, opengl-es-2.0

我想创建一个在平铺平面上方移动的相机。相机应该只在 XY 平面上移动，并且一直向下看。使用正交投影，我期望使用伪 2D 渲染器。我的问题是，我不知道如何翻译相机。经过一些研究，在我看来，OpenGL 中没有像“相机”这样的东西，我必须翻译整个世界。在 -function 中更改眼睛位置和视图中心坐标`Matrix.setLookAtM`只会导致结果失真。翻译整个 MVP-Matrix 也不起作用。

我现在没有想法了；我是否必须直接在顶点缓冲区中翻译每帧的每个顶点？这对我来说似乎不合理。

我派生`GLSurfaceView`并实现了以下功能来设置和更新场景：

```
public void onSurfaceChanged(GL10 unused, int width, int height) {

    GLES20.glViewport(0, 0, width, height);
    float ratio = (float) width / height;

    // Setup the projection Matrix for an orthogonal view
    Matrix.orthoM(mProjMatrix, 0, -ratio, ratio, -1, 1, 3, 7);

}

public void onDrawFrame(GL10 unused) {

    // Draw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

    //Setup the camera
    float[] camPos = {  0.0f,  0.0f, -3.0f }; //no matter what else I put in here the camera seems to point
    float[] lookAt = {  0.0f,  0.0f,  0.0f }; //  to the coordinate center and distorts the square

    // Set the camera position (View matrix)
    Matrix.setLookAtM( vMatrix, 0, camPos[0], camPos[1], camPos[2], lookAt[0], lookAt[1], lookAt[2], 0f, 1f, 0f);

    // Calculate the projection and view transformation
    Matrix.multiplyMM( mMVPMatrix, 0, projMatrix, 0, vMatrix, 0);

    //rotate the viewport
    Matrix.setRotateM(mRotationMatrix, 0, getRotationAngle(), 0, 0, -1.0f);
    Matrix.multiplyMM(mMVPMatrix, 0, mRotationMatrix, 0, mMVPMatrix, 0);

    //I also tried to translate the viewport here
    //  (and several other places), but I could not find any solution

    //draw the plane (actually a simple square right now)
    mPlane.draw(mMVPMatrix);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:44:49.503

> 在“LookAt”功能中更改眼睛位置和视图中心坐标只会导致结果失真。

如果你从 android 教程中得到这个，我认为他们的代码中有一个错误。[（在这里](https://stackoverflow.com/questions/11925647/is-googles-android-opengl-tutorial-teaching-incorrect-linear-algebra)发表了评论）

尝试以下修复：

1.  使用 setLookatM 指向您希望相机所在的位置。
2.  在着色器中，更改`gl_Position`线条

    从： `" gl_Position = vPosition * uMVPMatrix;"`
    到： `" gl_Position = uMVPMatrix * vPosition;"`

3.  我认为该`//rotate the viewport`部分也应该删除，因为这不能正确旋转相机。您可以在 setlookat 函数中更改相机的方向。

# iphone - iOS 将照片保存在特定应用的相册中

> ID：11972185
> 
> 赞同：14
> 
> 时间：2012-08-15T15:20:51.277
> 
> 标签：iphone, objective-c, ios, camera, alassetslibrary

我正在创建一个 iOS 5 应用程序。我想将照片保存到设备。

我想将照片保存到特定于我的应用程序的相册中，因此我需要创建相册，然后将照片保存到相册中。

我知道如何创建相册：

```
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
[library addAssetsGroupAlbumWithName:@"MY APP NAME" resultBlock:^(ALAssetsGroup *group) {
    //How to get the album URL?
} failureBlock:^(NSError *error) {
    //Handle the error
}]; 
```

我现在想将照片添加到新相册，我该怎么做？示例代码非常感谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-12-28T17:07:49.607

您可以使用以下代码更改专辑名称：

```
__weak ALAssetsLibrary *lib = self.library;

[self.library addAssetsGroupAlbumWithName:@"My Photo Album" resultBlock:^(ALAssetsGroup *group) {

    ///checks if group previously created
    if(group == nil){

        //enumerate albums
        [lib enumerateGroupsWithTypes:ALAssetsGroupAlbum
                           usingBlock:^(ALAssetsGroup *g, BOOL *stop)
         {
             //if the album is equal to our album
             if ([[g valueForProperty:ALAssetsGroupPropertyName] isEqualToString:@"My Photo Album"]) {

                 //save image
                 [lib writeImageDataToSavedPhotosAlbum:UIImagePNGRepresentation(image) metadata:nil
                                       completionBlock:^(NSURL *assetURL, NSError *error) {

                                           //then get the image asseturl
                                           [lib assetForURL:assetURL
                                                resultBlock:^(ALAsset *asset) {
                                                    //put it into our album
                                                    [g addAsset:asset];
                                                } failureBlock:^(NSError *error) {

                                                }];
                                       }];

             }
         }failureBlock:^(NSError *error){

         }];

    }else{
        // save image directly to library
        [lib writeImageDataToSavedPhotosAlbum:UIImagePNGRepresentation(image) metadata:nil
                              completionBlock:^(NSURL *assetURL, NSError *error) {

                                  [lib assetForURL:assetURL
                                       resultBlock:^(ALAsset *asset) {

                                           [group addAsset:asset];

                                       } failureBlock:^(NSError *error) {

                                       }];
                              }];
    }

} failureBlock:^(NSError *error) {

}]; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-11-19T03:41:10.160

对于任何希望从 iOS 9 开始执行此操作的人来说，由于 ALAssetsLibrary 已被弃用，取而代之的是新的照片库，因此事情变得有些复杂。

这是一些用于将 UIImages 添加到特定专辑名称的 Swift 代码（如果专辑不存在则创建专辑），您可能需要根据需要进行一些重构/优化：

```
func insertImage(image : UIImage, intoAlbumNamed albumName : String) {

    //Fetch a collection in the photos library that has the title "albumNmame"
    let collection = fetchAssetCollectionWithAlbumName(albumName)

    if collection == nil {
        //If we were unable to find a collection named "albumName" we'll create it before inserting the image
        PHPhotoLibrary.sharedPhotoLibrary().performChanges({
            PHAssetCollectionChangeRequest.creationRequestForAssetCollectionWithTitle(albumName)
            }, completionHandler: {(success : Bool, error : NSError?) in
                if error != nil {
                    print("Error: " + error!.description)
                }

                if success {
                    //Fetch the newly created collection (which we *assume* exists here)
                    let newCollection = self.fetchAssetCollectionWithAlbumName(albumName)
                    self.insertImage(image, intoAssetCollection: newCollection!)
                }
            }
        )
    } else {
        //If we found the existing AssetCollection with the title "albumName", insert into it
        self.insertImage(image, intoAssetCollection: collection!)
    }
}

func fetchAssetCollectionWithAlbumName(albumName : String) -> PHAssetCollection? {

    //Provide the predicate to match the title of the album.
    let fetchOption = PHFetchOptions()
    fetchOption.predicate = NSPredicate(format: "title == '" + albumName + "'")

    //Fetch the album using the fetch option
    let fetchResult = PHAssetCollection.fetchAssetCollectionsWithType(
        PHAssetCollectionType.Album,
        subtype: PHAssetCollectionSubtype.AlbumRegular,
        options: fetchOption)

    //Assuming the album exists and no album shares it's name, it should be the only result fetched
    let collection = fetchResult.firstObject as? PHAssetCollection

    return collection
}

func insertImage(image : UIImage, intoAssetCollection collection : PHAssetCollection) {

    //Changes for the Photos Library must be maded within the performChanges block
    PHPhotoLibrary.sharedPhotoLibrary().performChanges({

            //This will request a PHAsset be created for the UIImage
            let creationRequest = PHAssetCreationRequest.creationRequestForAssetFromImage(image)

            //Create a change request to insert the new PHAsset in the collection
            let request = PHAssetCollectionChangeRequest(forAssetCollection: collection)

            //Add the PHAsset placeholder into the creation request.
            //The placeholder is used because the actual PHAsset hasn't been created yet
            if request != nil && creationRequest.placeholderForCreatedAsset != nil {
                request!.addAssets([creationRequest.placeholderForCreatedAsset!])
            }

        },

        completionHandler: { (success : Bool, error : NSError?) in
            if error != nil {
                print("Error: " + error!.description)
            }
        }
    )
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-04-07T16:21:38.430

对于那些在寻找艾迪答案的人`Objective-C.`

`#import <Photos/Photos.h>`

```
- (void)insertImage:(UIImage *)image intoAlbumNamed:(NSString *)albumName {
    //Fetch a collection in the photos library that has the title "albumNmame"
    PHAssetCollection *collection = [self fetchAssetCollectionWithAlbumName: albumName];

    if (collection == nil) {
        //If we were unable to find a collection named "albumName" we'll create it before inserting the image
        [[PHPhotoLibrary sharedPhotoLibrary] performChanges:^{
            [PHAssetCollectionChangeRequest creationRequestForAssetCollectionWithTitle: albumName];
        } completionHandler:^(BOOL success, NSError * _Nullable error) {
            if (error != nil) {
                NSLog(@"Error inserting image into album: %@", error.localizedDescription);
            }

            if (success) {
                //Fetch the newly created collection (which we *assume* exists here)
                PHAssetCollection *newCollection = [self fetchAssetCollectionWithAlbumName:albumName];
                [self insertImage:image intoAssetCollection: newCollection];
            }
        }];
    } else {
        //If we found the existing AssetCollection with the title "albumName", insert into it
        [self insertImage:image intoAssetCollection: collection];
    }
}

- (PHAssetCollection *)fetchAssetCollectionWithAlbumName:(NSString *)albumName {
    PHFetchOptions *fetchOptions = [PHFetchOptions new];
    //Provide the predicate to match the title of the album.
    fetchOptions.predicate = [NSPredicate predicateWithFormat:[NSString stringWithFormat:@"title == '%@'", albumName]];

    //Fetch the album using the fetch option
    PHFetchResult *fetchResult = [PHAssetCollection fetchAssetCollectionsWithType:PHAssetCollectionTypeAlbum subtype:PHAssetCollectionSubtypeAlbumRegular options:fetchOptions];

    //Assuming the album exists and no album shares it's name, it should be the only result fetched
    return fetchResult.firstObject;
}

- (void)insertImage:(UIImage *)image intoAssetCollection:(PHAssetCollection *)collection {
    [[PHPhotoLibrary sharedPhotoLibrary] performChanges:^{

        //This will request a PHAsset be created for the UIImage
        PHAssetCreationRequest *creationRequest = [PHAssetCreationRequest creationRequestForAssetFromImage:image];

        //Create a change request to insert the new PHAsset in the collection
        PHAssetCollectionChangeRequest *request = [PHAssetCollectionChangeRequest changeRequestForAssetCollection:collection];

        //Add the PHAsset placeholder into the creation request.
        //The placeholder is used because the actual PHAsset hasn't been created yet
        if (request != nil && creationRequest.placeholderForCreatedAsset != nil) {
            [request addAssets: @[creationRequest.placeholderForCreatedAsset]];
        }
    } completionHandler:^(BOOL success, NSError * _Nullable error) {
        if (error != nil) {
            NSLog(@"Error inserting image into asset collection: %@", error.localizedDescription);
        }
    }];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-10T16:34:33.747

改编 Eddy 对 Swift 4 的回答：

```
 func saveImageToAlbum(_ image: UIImage, name: String) {

        if let collection = fetchAssetCollection(name) {
            self.saveImageToAssetCollection(image, collection: collection)
        } else {
            // Album does not exist, create it and attempt to save the image
            PHPhotoLibrary.shared().performChanges({
                PHAssetCollectionChangeRequest.creationRequestForAssetCollection(withTitle: name)
            }, completionHandler: { (success: Bool, error: Error?) in
                guard success == true && error == nil else {
                    NSLog("Could not create the album")
                    if let err = error {
                        NSLog("Error: \(err)")
                    }
                    return
                }

                if let newCollection = self.fetchAssetCollection(name) {
                    self.saveImageToAssetCollection(image, collection: newCollection)
                }
            })
        }
    }

    func fetchAssetCollection(_ name: String) -> PHAssetCollection? {

        let fetchOption = PHFetchOptions()
        fetchOption.predicate = NSPredicate(format: "title == '" + name + "'")

        let fetchResult = PHAssetCollection.fetchAssetCollections(
            with: PHAssetCollectionType.album,
            subtype: PHAssetCollectionSubtype.albumRegular,
            options: fetchOption)

        return fetchResult.firstObject
    }

    func saveImageToAssetCollection(_ image: UIImage, collection: PHAssetCollection) {

        PHPhotoLibrary.shared().performChanges({

            let creationRequest = PHAssetCreationRequest.creationRequestForAsset(from: image)
            if let request = PHAssetCollectionChangeRequest(for: collection),
                let placeHolder = creationRequest.placeholderForCreatedAsset {
                request.addAssets([placeHolder] as NSFastEnumeration)
            }
        }, completionHandler: { (success: Bool, error: Error?) in
            guard success == true && error == nil else {
                NSLog("Could not save the image")
                if let err = error {
                    NSLog("Error: " + err.localizedDescription)
                }
                return
            }
        })
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-29T16:29:40.193

Objective C 的改进版本，使用块。如果相册不存在，它会创建一个相册，然后保存三种类型的媒体项目——照片、GIF 和视频：

```
// Types of media, that can be saved to an album
typedef NS_ENUM(NSUInteger, AlbumMediaType) {
    AlbumMediaTypePhoto,
    AlbumMediaTypeGIF,
    AlbumMediaTypeVideo
};

/**
 Creates album if it doesn't exist and returns it in a block
 */
- (void)createCollectionOnComplete:(void (^ _Nonnull)(PHAssetCollection * _Nonnull collection))onComplete
{
    NSString *albumTitle = @"YOUR_ALBUM_TITLE";

    __block PHAssetCollection *collection;
    __block PHObjectPlaceholder *placeholder;

    // Searching for an existing album
    PHFetchOptions *fetchOptions = [[PHFetchOptions alloc] init];
    fetchOptions.predicate = [NSPredicate predicateWithFormat:@"title = %@", albumTitle];
    collection = [PHAssetCollection fetchAssetCollectionsWithType:PHAssetCollectionTypeAlbum
                                                          subtype:PHAssetCollectionSubtypeAny
                                                          options:fetchOptions].firstObject;
    // If album is not found, we create it
    if (!collection)
    {
        [[PHPhotoLibrary sharedPhotoLibrary] performChanges:^{
            PHAssetCollectionChangeRequest *createAlbum = [PHAssetCollectionChangeRequest creationRequestForAssetCollectionWithTitle:albumTitle];
            placeholder = [createAlbum placeholderForCreatedAssetCollection];
        } completionHandler:^(BOOL success, NSError *error) {
            if (success)
            {
                PHFetchResult *collectionFetchResult = [PHAssetCollection fetchAssetCollectionsWithLocalIdentifiers:@[placeholder.localIdentifier]
                                                                                                            options:nil];
                collection = collectionFetchResult.firstObject;
                // After creating album, we return it
                onComplete(collection);
            }
        }];
    } else {
        // If album already exists, we instantly return it
        onComplete(collection);
    }
}

/**
 Saves an item of a given mediatype, that is located in mediaURL
 */
- (void)saveToAlbumMediaItemFromURL:(NSURL *)mediaURL mediaType:(AlbumMediaType)mediaType
{
    NSData *mediaData = [NSData dataWithContentsOfURL:mediaURL];
    if (!mediaData) {
        OWSFail(@"%@ Could not load data: %@", self.logTag, [self.attachmentStream mediaURL]);
        return;
    }

    [self createCollectionOnComplete:^(PHAssetCollection * _Nonnull collection) {

        [[PHPhotoLibrary sharedPhotoLibrary] performChanges:^{

            // We create a PHAsset using creationRequest
            PHAssetCreationRequest *assetRequest;
            switch (mediaType) {
                case AlbumMediaTypePhoto: {
                    assetRequest = [PHAssetCreationRequest creationRequestForAssetFromImage:[UIImage imageWithData:mediaData]];
                    break;
                }
                case AlbumMediaTypeGIF: {
                    assetRequest = [PHAssetCreationRequest creationRequestForAsset];
                    PHAssetResourceCreationOptions *options = [[PHAssetResourceCreationOptions alloc] init];
                    [assetRequest addResourceWithType:PHAssetResourceTypePhoto data:mediaData options:options];
                    break;
                }
                case AlbumMediaTypeVideo: {
                    if ( !UIVideoAtPathIsCompatibleWithSavedPhotosAlbum(mediaURL.path) ) {
                        OWSFail(@"%@ Could not save incompatible video data.", self.logTag);
                        break;
                    }

                    NSString *videoPath = [[NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) objectAtIndex:0] stringByAppendingPathComponent:@"file.mov"];
                    [mediaData writeToFile:videoPath atomically:YES];
                    assetRequest = [PHAssetCreationRequest creationRequestForAssetFromVideoAtFileURL:[NSURL fileURLWithPath:videoPath]];
                    break;
                }
                default:
                    break;
            }

            // Creating a request to change an album
            PHAssetCollectionChangeRequest *albumChangeRequest = [PHAssetCollectionChangeRequest changeRequestForAssetCollection:collection];

            // PHAsset is not created yet, so we use a placeholder
            PHObjectPlaceholder *placeholder = [assetRequest placeholderForCreatedAsset];

            // We add a placeholder of a created item to the request of changing album
            if (albumChangeRequest != nil && placeholder != nil) {
                [albumChangeRequest addAssets: @[placeholder]];
            }

        } completionHandler:^(BOOL success, NSError *error) {

            if (success) {
                NSLog(@"Media item saved!");
            } else {
                NSLog(@"Error saving media item - %@", error ? error.localizedDescription : @"");
            }

        }];

    }];
} 
```

我们可以使用这些方法以这种方式保存媒体项：

```
[self saveToAlbumMediaItemFromURL:[self.attachmentStream mediaURL] mediaType:AlbumMediaTypeGIF]; 
```

# iphone - 未执行 iOS 转发地理编码

> ID：11972193
> 
> 赞同：1
> 
> 时间：2012-08-15T15:21:33.440
> 
> 标签：iphone, ipad, ios5, geocoding, core-location

谁能告诉我为什么这段代码没有被执行？我从我的另一个项目中复制并粘贴了它，它工作得很好。我还在我的其他应用程序中尝试使用与我在这里插入的相同地址字符串，它运行良好。但是如果我将地址直接传递给geocodeaddressstring，它只会在传递字符串变量时发生，它工作正常

```
NSString *addressString = @"2642 Broadway, New York, NY 10025, USA";
[forwardGeocoder1 geocodeAddressString:addressString
                          completionHandler:^(NSArray *placemarks, NSError *error){

                              // Make sure the geocoder did not produce an error
                              // before continuing
                              if(!error){

                                  // Iterate through all of the placemarks returned
                                  // and output them to the console
                                  for(CLPlacemark *placemark in placemarks){

                                NSLog(@"found");

                                  }
                              }
                              else{
                                  // Our geocoder had an error, output a message
                                  // to the console
                                  NSLog(@"There was a forward geocoding error\n%@",
                                        [error localizedDescription]);
                              }
                          }
       ]; 
```

错误：
kCLErrorDomain 错误 8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:34:41.503

请参考本[文档](https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CoreLocationConstantsRef/Reference/reference.html#//apple_ref/doc/uid/TP40010237-CH2-SW2)

根据文档，`kCLErrorDomain error 8`意味着：`kCLErrorGeocodeFoundNoResult`

# event-handling - 在鼠标移动处理程序中隐藏光标并在鼠标向上显示

> ID：11972196
> 
> 赞同：1
> 
> 时间：2012-08-15T15:21:42.150
> 
> 标签：event-handling, cursor, hide, show

我正在开发一个原理图编辑器，我需要在中键按下并移动时隐藏光标，并在鼠标向上事件发生时再次显示以实现用户友好的缩放系统。当从这些事件处理程序外部调用隐藏和显示方法时，它们工作正常，然后在事件处理程序内调用时，bud 不起作用！

# r - R中的特殊字符

> ID：11972203
> 
> 赞同：3
> 
> 时间：2012-08-15T15:22:27.203
> 
> 标签：r

我正在努力将对话的文字记录读入 R 中。但是我遇到了特殊字符，如弯引号 en 和 em 破折号等。通常，我首先将 Microsoft 产品中的这些特殊字符替换为`replace`. 通常我用纯文本替换特殊字符，但在某些情况下希望用其他字符替换它们（即我用 {} 替换“”）。这是乏味的，并不总是彻底的。如果我可以按原样将成绩单读入 R，然后使用 Encoding 将它们的编码转换为可识别的 unicode 格式，我可以将`gsub`它们取出并用纯文本版本替换它们。但是，该文件以某种我不理解的方式读入。这是我的数据可能看起来的 xlsx：

[http://dl.dropbox.com/u/61803503/test.xlsx](http://dl.dropbox.com/u/61803503/test.xlsx)

这是 .xlsx 文件中的内容

```
text                              num
“ ” curly quotes                    1
en dash (–) and the em dash (—)     2
‘ ’ curly apostrophe-ugg            3
…  ellipsis are uck in R            4 
```

这可以读入R：

```
URL <- "http://dl.dropbox.com/u/61803503/test.xlsx"
library(gdata) 
z <- read.xls(URL, stringsAsFactors = FALSE) 
```

结果是：

```
 text num
1                â€œ â€ curly quotes    1
2 en dash (â€“) and the em dash (â€”)   2
3        â€˜ â€™ curly apostrophe-ugg   3
4          â€¦  ellipsis are uck in R   4 
```

所以我尝试使用`Encoding`转换为Unicode：

```
iconv(z[, 1], "latin1", "UTF-8") 
```

这给出了：

```
[1] "â\u0080\u009c â\u0080\u009d curly quotes"                "en dash (â\u0080\u0093) and the em dash (â\u0080\u0094)"
[3] "â\u0080\u0098 â\u0080\u0099 curly apostrophe-ugg"        "â\u0080¦  ellipsis are uck in R" 
```

这使得 gsubing 不太有用。

我该怎么做才能将这些特殊字符转换为可区分的 unicode，以便我可以适当地将它们 gsub 出来？更明确地说，我希望`z[1, 1]`阅读：

```
\u201C 2\u01D curly quotes 
```

为了更清楚我想要的结果，我将从维基百科之类的页面中抓取表格：[http](http://en.wikipedia.org/wiki/Quotation_mark_glyphs) ://en.wikipedia.org/wiki/Quotation_mark_glyphs并使用 unicode 参考图表适当地替换字符。所以我需要字符是 unicode 或某种标准格式，我可以系统地检查并替换字符。也许它已经是，我想念它。

PS 我不将文件保存为 .csv 或纯文本，因为特殊字符被替换为，`?`因此如果您有更好的选择，`read.xls` 我不会附加到任何特定的文件读取方法（即） `read.xls`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T17:55:09.340

也许这会有所帮助（我明天可以使用 Windows 机器，如果 SO 没有先给你答案，我可能会在那时更多地使用它）。

在我的 Linux 系统上，当我执行以下操作时：

```
iconv(z$text, "", "cp1252") 
```

我得到：

```
[1] "\x93 \x94 curly quotes"                "en dash (\x96) and the em dash (\x97)"
[3] "\x91 \x92 curly apostrophe-ugg"        "\x85  ellipsis are uck in R" 
```

这不是 UTF，而是（我相信）ISO 十六进制实体。不过，如果您也能够达到这一点，那么您应该能够使用`gsub`您打算使用的方式。

有关转换，请参阅[此页面](https://web.archive.org/web/20120211205519/http://theorem.ca/~mvcorks/code/charsets/latin1.html)（特别是保留部分）。

## 更新

您也可以尝试转换为没有这些字符的编码，例如 ASCII 并设置`sub`为`"byte"`. 在我的机器上，这给了我：

```
iconv(z$text, "", "ASCII", "byte")
# [1] "<e2><80><9c> <e2><80><9d> curly quotes"               
# [2] "en dash (<e2><80><93>) and the em dash (<e2><80><94>)"
# [3] "<e2><80><98> <e2><80><99> curly apostrophe-ugg"       
# [4] "<e2><80><a6>  ellipsis are uck in R" 
```

它很丑，但它`UTF-8(e2, 80, 9c)`是一个正确的大引号（我相信每个字符都是一组用尖括号括起来的三个值）。[您可以在此站点](http://unicode-search.net/unicode-namesearch.pl?term=mark)上找到转换，您可以在其中按标点符号名称进行搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:57:55.760

尝试

```
> iconv(z, "UTF-8", "UTF-8") 
[1] "c(\"“—” curly quotes\", \"en dash (–) and the em dash (—)\", \"‘—’ curly apostrophe-ugg\", \"…  ellipsis are uck in R\")"
[2] "c(1, 2, 3, 4)" 
```

windows的编码问题很大。也许您可以查看[http://www.vmware.com/products/player/](http://www.vmware.com/products/player/)并运行 linux。

这适用于我的 Windows 盒子。最初的输入和你一样。你可能会有不一样的体验。

# pattern-matching - 从视频中提取关键帧以对带有一些查询的视频进行评分

> ID：11972205
> 
> 赞同：0
> 
> 时间：2012-08-15T15:22:35.283
> 
> 标签：pattern-matching, computer-vision, object-recognition

我正在做一个计算机视觉项目，我们需要根据包含的一些对象、动物或查询定义的对象对视频进行评分。但是对于这个任务，我们首先要从视频中检索一些关键帧来处理。你知道有什么方法可以提取吗？我是这个主题的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:05:48.823

你看过使用[ffmpeg](http://ffmepg.org)吗？对于各种视频处理来说，它是一个非常强大的实用程序。如果您对直接输入命令感到满意，您可以执行以下操作...

在视频中的特定时间（在本例中为 12 秒）提取*单个*帧（使用`-vframes 1`），键入：

```
ffmpeg -i trial.flv -ss 00:00:12 -vframes 1 -f image2 frame.png 
```

或者，要将整个视频转换为单独的帧 - 从 31 秒开始并以指定的帧速率（`-r 5`对于 5Hz）进行采样，请键入：

```
ffmpeg -i trial.flv -ss 00:00:31 -y -sameq -r 5 -f image2 frame%03d.png 
```

该标志`-y`将覆盖现有文件，并且该标志`-sameq`将强制每个图像文件具有相同的质量。最后的位是给出输出帧的名称（用 3 个零填充的十进制数字按顺序区分每个 - `%03d`）。

只要确保您有足够的空间来存储所有这些框架！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T12:44:21.760

我使用那里解释的方法 [https://www.quora.com/Computer-Vision/How-do-we-retrieve-key-frames-from-a-video-for-object-recognition](https://www.quora.com/Computer-Vision/How-do-we-retrieve-key-frames-from-a-video-for-object-recognition)

# parsing - 从文本文件中获取子字符串以供以后使用

> ID：11972206
> 
> 赞同：0
> 
> 时间：2012-08-15T15:22:36.827
> 
> 标签：parsing, ant

我有一个包含版本信息的文本文件。有多行，但我需要的特定行如下所示：

```
#define SW_VERSION "3.4.3.1 R3    08-06-12" 
```

我特别需要文本文件中的 3.4.3.1 R3。

我的第一个想法是执行一个简短的脚本，将这些数据抓取出来并使用一组供以后使用，尽管我在让它工作时遇到了很多麻烦。

我运行了这个：`Find /I "#define SW_VERSION" C:\SW\bin\SW_Version.txt` 它向我显示了我期望的文件中的行，但我不知道之后如何解析它。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:02:37.917

您可以为 Ant 编写[自定义任务](http://ant.apache.org/manual/develop.html)。

您的自定义任务将解析​​版本行并提取您需要的信息。

# multithreading - XCode Boost 线程示例编译错误

> ID：11972209
> 
> 赞同：1
> 
> 时间：2012-08-15T15:22:50.850
> 
> 标签：multithreading, boost, boost-thread, xcode4.4

这是我的基本提升代码

```
#include <iostream>
#include <boost/thread.hpp>

using namespace boost;
using namespace boost::this_thread;
using namespace std;
// Global function called by thread
void GlobalFunction()
{
    for (int i=0;i<10;++i)
    {
        cout << i << "Do something in parallel with main method." << endl;
        boost::this_thread::yield();
    }
}
void GlobalThreadTest()
{
    boost::thread t(&GlobalFunction);
    for (int i = 0; i<10; ++i) {
        cout << i << "Do something in main method. " << endl;
    }
}

int main(int argc, const char * argv[])
{
    GlobalThreadTest();
    return 0;
} 
```

我从 xcode 收到很多这样的错误

> (null): "boost::this_thread::yield()", 引用自: (null): "boost::detail::thread_data_base::~thread_data_base()", 引用自: (null): "boost:: system::system_category()"，引用自：(null):"boost::system::generic_category()"，引用自：(null):"boost::thread::start_thread()"，引用自：

我已经使用 macports 安装了 boost，并且 xcode 中的标头搜索路径设置为 /opt/local/include/ 这包含所有 .hpp 文件。

2 个问题

1.  如果是，boost 是否会创建 *.o 文件，它们存储在哪里？
2.  如何让 xcode 4.2 与这个 boost 线程示例一起工作？如果我必须设置一个标志，我应该在 xcode 4.2 中设置哪个参数？

谢谢。

# jvm - 如果堆大小为 2 GB，则 Glassfish 2.1.1 域在部署 jbi 服务时崩溃

> ID：11972215
> 
> 赞同：1
> 
> 时间：2012-08-15T15:23:02.023
> 
> 标签：jvm, glassfish, dns

我在 32 位 RHEL 4 上运行 glassfish 2.1.1，我需要经常部署和取消部署大约 30-40 个打包在 zip 文件中的 jbi 服务程序集。我使用一个 shell 脚本，其中“asadmin deploy-jbi-service-assembly”和“asadmin start-jbi-service-assembly”命令在一个循环中运行。我遇到的一个奇怪的事情是，当我通过 Xmx jvm 选项将域的堆大小设置为 2048m 时，取消部署正常，但在部署过程中，大约 6-7 次部署后，域崩溃。当我将堆大小从 2048m 减少到 1700m 左右时，我能够部署所有程序集而不会出现问题。但是在部署之后，我再次必须更改堆大小并重新启动域。服务器有大约 48GB 内存和 2 个四核 cpu，因此资源并不稀缺。这真是令人头疼。

# spring - Grails Spring 安全 ldap 插件

> ID：11972216
> 
> 赞同：2
> 
> 时间：2012-08-15T15:23:03.237
> 
> 标签：spring, grails, ldap, spring-ldap

我正在使用 Grails 和 Spring Security 编写一个项目。我想为此使用 LDAP。因此，我安装了`spring-security-core`和 `spring-security-LDAP`插件。我获得了登录名，以便为 Spring Security 工作。我还在 Grails 中运行和配置了 LDAP。我宁愿不发布该来源，但它具有所需的`springsecurity.ldap.contexts/search/authorities`.

问题是我无法让它停止本地搜索。如果我尝试使用 LDAP 中的名称，它会失败，但如果我使用引导程序中的名称，它会起作用。我知道以前有人问过这个问题，但我查看了答案并得到了一些重要部分的 404。[我的问题与此人的](https://stackoverflow.com/questions/4035402/how-to-use-ldap-plugin-on-grails)问题几乎相同，尽管他的问题似乎从未得到解决。

# mysql - 使用 UPDATE 时 MySQL 错误 1054 (42S22)

> ID：11972217
> 
> 赞同：-2
> 
> 时间：2012-08-15T15:23:04.153
> 
> 标签：mysql, mysql-error-1054

在使用 MySQL 命令行界面时，我输入以下命令：

```
UPDATE movies SET Title=Full WHERE ID=6; 
```

我收到以下错误：

```
ERROR 1054 (42S22): Unknown column 'Full' in 'field list' 
```

我已经验证我正在使用表“电影”并且存在“标题”列。此外，确实存在 ID=6 的条目。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:24:09.620

`UPDATE movies SET Title="Full" WHERE ID=6;`？？？

# git - 加密版本控制

> ID：11972219
> 
> 赞同：16
> 
> 时间：2012-08-15T15:23:09.153
> 
> 标签：git, version-control

我正在寻找一个远程版本控制系统，并且正在查看 github。他们明确表示他们不存储加密的数据，而是专注于服务器安全。

很公平，但我希望将我存储的数据加密作为我整个业务的基础。

您是否可以推荐其他存储加密数据的 git 托管服务提供商？

还是我只是偏执？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T15:28:51.143

"gitcrypt" is one option for saving encrypted data on github (and dropbox, etc):

*   [https://gist.github.com/873637](https://gist.github.com/873637)

*   [https://github.com/shadowhand/git-encrypt](https://github.com/shadowhand/git-encrypt)

There is controversy about client-side encryption:

*   [http://article.gmane.org/gmane.comp.version-control.git/113221](http://article.gmane.org/gmane.comp.version-control.git/113221)

*   [https://github.com/MrZYX/old_diaspora_wiki/blob/master/Why-client-side-encryption-is-a-bad-idea.md](https://github.com/MrZYX/old_diaspora_wiki/blob/master/Why-client-side-encryption-is-a-bad-idea.md)

# wpf - 将 Rectangle.Fill 链接到 TextBlock.Background

> ID：11972221
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:23:15.333
> 
> 标签：wpf, xaml, data-binding

我目前正在从 WinForms 迁移到 WPF，我真的在绑定方面苦苦挣扎。我需要做的就是将矩形的填充属性与 textblock.background 相匹配，并使它们保持同步。我知道我可以使用“经典”事件处理程序来做到这一点，但我有 24 个文本框和 24 个矩形，我更喜欢 WPF 解决方案。我玩弄了绑定属性，但我似乎无法获得任何类型的结果，因为我不知道我什至需要的绑定类型！我需要一个事件，还是使用转换器，或者可能是一个样式触发器？也许只是在屏幕上贴上透明胶带然后收工？

我知道以下内容不起作用，但这是我目前的理解水平。

```
<Rectangle Fill="{Binding Source="textBlock.Background"} /> 
```

我已经阅读了有关数据绑定的各种文章，但它们都更高级，并且通常处理数据。

有人可以对这个无助的n00b有所了解吗！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:40:34.283

```
<TextBlock x:Name="SomeTextBlock" Content="Hi"/>
<Rectangle Fill="{Binding ElementName=SomeTextBlock, Path=Background}"/> 
```

如果您在 XAML 中创建它们，这是一种简单的方法。

# jira - 找不到 RallyJiraCommentLinker 的类

> ID：11972224
> 
> 赞同：0
> 
> 时间：2012-08-15T15:23:34.390
> 
> 标签：jira, rally, jira-plugin

使用 RallyConnectorforJira-Ruby-2.7.4 我正在尝试配置连接器以在 Rally 和 JIRA 之间同步评论，如[http://www.rallydev.com/help/Jira-config-RallyJiraCommentLinker.pxml](http://www.rallydev.com/help/Jira-config-RallyJiraCommentLinker.pxml)中所述，但是当我添加以下是我的 jira_config.xml：

```
<RelatedObjectLinkers>
  <RallyJiraCommentLinker />
</RelatedObjectLinkers> 
```

连接器在启动后立即死亡，并出现“相关对象链接器找不到 RallyJiraCommentLinker 的类”错误（下面的日志内容）。

是我做错了什么还是不再支持 RallyJiraCommentLinker？

谢谢，

安德鲁。

--- 开始记录 ---

```
************************************************************************************************************

 rally2_jira_connector
     pid: 1234
     starting at: 2012-08-15 15:08:02 Z
     cwd: /opt/RallyConnectorforJira-Ruby-2.7.4
     configs: jira_config.xml
     interval: 15

************************************************************************************************************
[2012-08-15 15:08:02 Z]   ANY : ConnectorRunner.block in run - processing to commence using content from jira_config.xml
[2012-08-15 15:08:02 Z]  INFO : Class.read_config_file - jira_config.xml last modified 2012-08-15 15:06:45 UTC, size: 2665 chars
[2012-08-15 15:08:02 Z]  INFO : RallyConnection.initialize - Initializing Rally connection version 2.7.4
[2012-08-15 15:08:02 Z]  INFO : RallyConnection.initialize - Rally Web Services version 1.16
[2012-08-15 15:08:02 Z]  INFO : JiraConnection.initialize - Initializing JIRA connection version 2.7.4
[2012-08-15 15:08:02 Z]  INFO : Class.read_workflow_file - jira_workflow.xml
[2012-08-15 15:08:02 Z] ERROR : Connector.rescue in block in read_related_object_linkers - Related Object Linker could not find a class for RallyJiraCommentLinker
[2012-08-15 15:08:02 Z] ERROR : ConnectorRunner.initialize - uninitialized constant Kernel::RallyJiraCommentLinker
[2012-08-15 15:08:02 Z] ERROR : Object.exception - Message uninitialized constant Kernel::RallyJiraCommentLinker
[2012-08-15 15:08:02 Z] ERROR : Object.exception - Stack Trace
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector.rb:364:in `const_get'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector.rb:364:in `block in read_related_object_linkers'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:239:in `block in each'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `upto'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `each'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector.rb:362:in `read_related_object_linkers'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector.rb:54:in `read_config'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector.rb:37:in `initialize'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector_runner.rb:154:in `new'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector_runner.rb:154:in `block in run'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector_runner.rb:136:in `each'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/yeti-2.7.4/lib/yeti/connector_runner.rb:136:in `run'
[2012-08-15 15:08:02 Z] ERROR : Object.block in exception - rally2_jira_connector.rb:24:in `<main>' 
```

--- 结束日志 ---

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:42:30.433

实际上，我们最近在连接器的 2.8.1 版本中引入了它，所以它不在您拥有的版本中。希望有帮助。

# msbuild - 用于 SVN 和巡航控制的 ASP.NET 项目构建脚本

> ID：11972225
> 
> 赞同：1
> 
> 时间：2012-08-15T15:23:34.313
> 
> 标签：msbuild, cruisecontrol

我在 ASP.NET MVC 3 中有一个项目，解决方案文件总共包含 28 个项目。这一切都在一个配置有龟 SVN 的目录中，以始终从 SVN 获取最新更新。

我还在我的 VPS 盒子上安装了 curisecontrol，其中存在这些完整的解决方案。我还在我的 IIS 中创建了一个网站，现在一切正常。

任何人都可以指导我学习以下教程：

*   如何设置curise control web仪表板，以便我的客户可以查看构建及其报告

*   如何逐步使用 MSBuild 和 Cruise Control

*   任何具有以下功能的示例构建脚本

*   构建失败或成功构建的电子邮件通知

*   如果构建不成功则停止部署并创建构建报告

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T18:13:15.453

如何在某些步骤中将 MSBuild 与巡航控制一起使用 [http://www.codeproject.com/Articles/12985/Practical-NET2-and-C-2-An-introduction-to-MSBuild](http://www.codeproject.com/Articles/12985/Practical-NET2-and-C-2-An-introduction-to-MSBuild)

默认情况下，ccnet 的 Web 仪表板显示构建结果，而没有确切的错误消息。要在 Web 仪表板中显示错误，请转到“C:\Program Files\CruiseControl.NET\webdashboard”并打开文件“dashboard.config”。

在那里，您将找到以下代码：

折叠 | 语言：cxslheader.xsl xslmodifications.xsl xslunittests.xsl xslMsTestSummary.xsl xslfxcop-summary.xsl xslNCoverSummary.xsl xslSimianSummary.xsl xslfitnesse.xsl 现在在上面的代码：

折叠 | 语言：cxsl\compile-msbuild.xsl 因此代码将变为：

```
<buildReportBuildPlugin>
    <xslFileNames>
        <xslFile>xsl\header.xsl</xslFile>
        <xslFile>xsl\modifications.xsl</xslFile>
        <xslFile>xsl\compile-msbuild.xsl</xslFile>
        <xslFile>xsl\unittests.xsl</xslFile>
        <xslFile>xsl\MsTestSummary.xsl</xslFile>
        <xslFile>xsl\fxcop-summary.xsl</xslFile>
        <xslFile>xsl\NCoverSummary.xsl</xslFile>
        <xslFile>xsl\SimianSummary.xsl</xslFile>
        <xslFile>xsl\fitnesse.xsl</xslFile>
    </xslFileNames>
</buildReportBuildPlugin> 
```

如果构建失败，我们也可以向用户组发送电子邮件。

```
 <workingDirectory>D:\Projects\TheWorks\Applications\ProjectFolder</workingDirectory>
           <buildArgs>ProjectName.msbuild /p:Configuration=Debug</buildArgs>
            <timeout>1800</timeout>
            <!--  30 minutes -->
    <logger>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll
    </logger>
            </msbuild>
            </tasks>
            <publishers>
                <statistics />
                <xmllogger />
                <email from="EMAIL ADDRESS" mailhost="HOSTNAME" 
                mailhostPassword="PASSWORD" mailhostUsername="USERNAME" 
                includeDetails="true">
                    <users>
                    <user name="Jitendra Zaa" 
                        address=ilovenagpur@gmail.com 
                        group="AdminGroup" />
                        <user name="Santosh Karemore" 
                        address=santosh.karemore@gmail.com 
                        group="AdminGroup" />
                        <user name="Manoranjan sahoo"
                        address=manoranjan.sahoo@gmail.com 
                        group="AdminGroup" />
                        <user name="Minal Shirsikar" 
                        address="admin@shivasoft.in" group="Emul" />
                    </users>
                    <groups>
                        <group name="Emul" notification="failed" />
                        <group name="AdminGroup" 
                            notification="failed" />
                    </groups>
                </email>
            </publishers>
        </project> 
```

标签是不言自明的。

可能有以下类型的通知：

总是修复失败

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T20:43:47.887

如何设置curise control web仪表板，所以我的客户可以查看构建及其报告->您必须首先在仪表板配置文件和网页中设置pwd，设置pwd后，您将能够添加插件来制作报告如构建报告项目报告单元测试报告南特报告检查此网址[http://www.codeproject.com/Articles/70955/Set-up-the-Web-Dashboard-of-CCNet-to-Display-the-C](http://www.codeproject.com/Articles/70955/Set-up-the-Web-Dashboard-of-CCNet-to-Display-the-C) in ccnet 文档，您将看到所有示例和步骤： [http ://confluence.public.thoughtworks.org/display/CCNET/Documentation](http://confluence.public.thoughtworks.org/display/CCNET/Documentation)

# xcode - 加载视图控制器后如何加载 UIImageView

> ID：11972227
> 
> 赞同：0
> 
> 时间：2012-08-15T15:23:34.927
> 
> 标签：xcode, sqlite, uiimageview, blob, xcode4.3

我在特定的视图控制器上生成了一个（可能）非常缓慢且效率低下的拼贴画。加载需要很长时间，所以我正在寻找可以加快我的 SQLite 查询（它正在搜索已保存图像的 BLOB）或导致在视图控制器加载**后**调用 SQL 查询方法的建议，然后我将放置一个活动加载时的指示器。

这是代码片段。

`viewDidLoad`：

```
- (void)viewDidLoad
{
    //generate photo collage
    wineryName = theWineOfCurrentWinery.winery;
    [self obtainImagesForWines:wineryName];

    //lots of other stuff
} 
```

`obtainImagesForWines`功能。这是控制显示在 16 个 UIImageViews 之一中的照片，其中有一个 4x4 块：

```
- (void) obtainImagesForWines:(NSString *)theWineryName {

sqlite3_stmt *stmt=nil;
sqlite3 *cruddb;

//sql command
const char *sql = "SELECT photo FROM wines WHERE winery=? AND photo NOT NULL ORDER BY RANDOM() LIMIT 16";

//Open db
sqlite3_open([path UTF8String], &cruddb);

int j=0;
if(sqlite3_prepare_v2(cruddb, sql, -1, &stmt, NULL) == SQLITE_OK) { 
    sqlite3_bind_text(stmt, 1, [theWineryName UTF8String], -1, SQLITE_TRANSIENT);
    while(sqlite3_step(stmt) == SQLITE_ROW) {
        UIImage *winePhoto;

        NSData *data = [[NSData alloc] initWithBytes:sqlite3_column_blob(stmt, 0) length:sqlite3_column_bytes(stmt, 0)];            

        if (data) {
            winePhoto = [UIImage imageWithData:data];
        }

        switch (j) {
            case 0:
                image1.image = winePhoto;
                break;
            case 1:
                image2.image = winePhoto;
                break;
            case 2:
                image3.image = winePhoto;
                break;
            case 3:
                image4.image = winePhoto;
                break;
            case 4:
                image5.image = winePhoto;
                break;
            case 5:
                image6.image = winePhoto;
                break;
            case 6:
                image7.image = winePhoto;
                break;
            case 7:
                image8.image = winePhoto;
                break;
            case 8:
                image9.image = winePhoto;
                break;
            case 9:
                image10.image = winePhoto;
                break;
            case 10:
                image11.image = winePhoto;
                break;
            case 11:
                image12.image = winePhoto;
                break;
            case 12:
                image13.image = winePhoto;
                break;
            case 13:
                image14.image = winePhoto;
                break;
            case 14:
                image15.image = winePhoto;
                break;
            case 15:
                image16.image = winePhoto;
                break;
            default:
                NSLog(@"wtf?");
        }
        j++;
    }
}
else {
    printf("I can't get the wine photo by ID!!: %s\n", sqlite3_errmsg(cruddb));
}
sqlite3_finalize(stmt);
sqlite3_close(cruddb);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T13:44:14.610

您应该将需要一些时间的代码添加到另一个方法中，`ViewDidAppear` 或者请在后台运行它，这会在您尝试从后台线程更新 UI 时造成更多麻烦。所以我会选择第一个选项并将代码添加到`ViewDidAppear`函数中。

如果您愿意，我可以发布代码以在后台运行它，但我会误导您，因为我会将您推向一个轨道，这将迫使您对代码进行更多修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:36:13.917

您可以在显示/存储图像时尝试缩小图像尺寸。我不确定，但我认为你在你的图像视图中显示了一个相当大的图像。我相信您正在尝试显示 16 图像缩略图。如果是这样，请尝试压缩图像。

一个可能更好的选择是，当您存储图像时，您可以将实际图像与缩略图版本一起存储，因此当您显示较小的图像时，请使用较小的图像。等等。

```
UIImageJPEGRepresentation(image,compressionRatio); 
```

这应该允许您压缩图像。或者，如果您想像这样调整它们的大小：

```
UIImage *yourImage = [UIImage imageWithData:yourdata];
UIImageView *imageView = [[UIImageView alloc] initWithImage:yourImage];
UIImageView.frame = CGRectMake(0, 0, yourImage.size.width / 2, yourImage.size.height / 2); 
```

希望这有帮助！！

**更新：**

关于使用 sqlite BLOB 存储图像的 stackoverflow 似乎有很多争论，并且这里涉及到一个巨大的性能问题。[这里](https://stackoverflow.com/questions/10192945/to-reterive-blob-image-from-sqlite)有一个这样的例子。

我自己有多个场景，我必须保存图像。我所做的（我的所有解决方案）是将图像保存到文档文件夹，然后让核心数据（或 sqlite，如果您愿意）存储对图像位置和名称的引用。这样，从 DB 中读取的时间减少了，时间也减少了。

我使用以下函数作为获取文档位置的通用方法：

```
- (NSString *)getFileLocation {
    // Get all available file system paths for the user
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

    // Get the "Documents" directory path - it's the one and only on iPhone OS
    NSString *documentsPath = [paths objectAtIndex:0];

    // Specify the file name, appending it to documentsPath above
    NSString *savedFileName = [documentsPath stringByAppendingPathComponent:@"Location.plist"];

    // We're done
    return savedFileName;
} 
```

然后将文件位置作为字符串保存到数据库中。我建议使用 Core Data 以获得更好的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T23:45:24.550

为了在后台运行此方法（换句话说，“在视图加载后”），我使用了以下代码`viewDidLoad`：

```
[self performSelectorInBackground:@selector(obtainImagesForWines) withObject:nil]; 
```

# jsf - 具有表达式语言的 JSF Primefaces 组件的 id 被评估为空字符串

> ID：11972232
> 
> 赞同：1
> 
> 时间：2012-08-15T15:23:57.437
> 
> 标签：jsf, primefaces

具有以下 xhtml 代码：

```
<h:form id="COTreeForm">
            <p:tree value="#{COBean.root}" var="node" id="COTree" dynamic="true" selectionMode="single">
                <p:ajax event="select" update="@(.coDetailsPanel)" listener="#{COBean.onNodeSelect}" />

                <p:treeNode id="COtreeNode" type="customerOrder" icon="ui-icon-co">
                    <p:outputPanel  id="CO_#{node.key}"> CO: #{node.key} </p:outputPanel>
                    <!--  <p:draggable for="CO_#{node.key}" helper="clone" />  -->  
                </p:treeNode>

                <p:treeNode id="COItreeNode" type="customerOrderItem">
                    <p:outputPanel id="COI_#{node.key}" styleClass="ui-tree-node-label-coi"> COI: #{node.key} </p:outputPanel>
                    <!--  <p:draggable for="COI_#{node.key}" helper="clone" />  -->
                </p:treeNode>

            </p:tree>

    </h:form> 
```

被`<p:outputPanel id="CO_#{node.key}"> CO: #{node.key} </p:outputPanel>`评估为以下 HTML 代码：

```
<span id="COTreeForm:COTree:0:CO_"> CO: customer1_co1 </span> 
```

为什么`#{node.key}`id 属性被评估为空字符串？！请注意，它被正确评估为标签内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:29:00.267

(`id`和`binding`) 属性在视图构建时进行评估。但是，`#{node}`仅在视图渲染期间可用。有关更详细的解释，请阅读[JSF2 Facelets 中的 JSTL... 有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

只是不要`_#{node.key}`在所有你的`id`和`for`属性中使用。JSF/PrimeFaces 将根据当前迭代的树节点自动生成正确的唯一客户端 ID。

# javascript - 对 Javascript 对象进行排序

> ID：11972241
> 
> 赞同：0
> 
> 时间：2012-08-15T15:24:14.823
> 
> 标签：javascript, arrays, json, sorting

> **可能重复：**
> [按属性值](https://stackoverflow.com/questions/1069666/sorting-javascript-object-by-property-value)
> [对 JavaScript 对象进行排序 按键对 JavaScript 对象进行排序](https://stackoverflow.com/questions/5467129/sort-javascript-object-by-key)

我编写了一个名为的函数`frequency()`，它接受一个数组，计算在其中找到字符串的次数，然后根据这些结果返回一个对象。

代码：

```
var array = ["Diesel","Asos","Diesel","Paul Smith"];

function frequency(array) {
    var frequency = {}, value;
    for(var i = 0; i < array.length; i++) {
        value = array[i];
        if(value in frequency)
            frequency[value]++;
        else
            frequency[value] = 1;
    }
    return frequency;
}

ordered = frequency(array); 
```

样本输出：

```
{"Asos":1,"Diesel":2,"Paul Smith":1} 
```

我现在如何根据计数的频率值对这个输出的对象进行排序？

# r - 在 R 中应用以更改列名

> ID：11972242
> 
> 赞同：-2
> 
> 时间：2012-08-15T15:24:19.683
> 
> 标签：r, apply

我希望在每个文件中更改一个列名（第 14 列），但我不知道如何去做。我尝试了多种应用，但这种方法不起作用，我不知道从哪里开始寻找另一种方法。到目前为止，这是我的代码：

```
File.names<-(tk_choose.files(default="", caption="Files", multi=TRUE, filters=NULL, index=1))
Num.Files<-NROW(File.names)
test<-sapply(1:Num.Files,function(x){readLines(File.names[x])})
lapply(1:Num.Files, function(x){data<-read.table(header=TRUE, text=test)})
#This is the issue
names(data)[14]<-'column14'
names(data) 
```

正如我提到的，我尝试了不同类型的应用，但无济于事。有没有不同的方法来解决这个问题？欢迎大家提出意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:33:45.650

You have to call `names` another `lapply`. E.g.:

```
l <- list(x=c(a=1, b=1), y=c(a=1, b=1))
l2 <- lapply(l, function(x) {
  names(x)[2] <- "d"
  return(x)
})

l2
#$x
#a d 
#1 1 
#
#$y
#a d 
#1 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:32:53.427

Split the names out first, then alter, then assign as a group. Like,

```
new.names <- names( data )
new.names[[14]] <- `column14`
names( data ) <- new.names 
```

# javascript - 是否可以通过 CSS 或 JavaScript 抑制 Android 浏览器上的“长按”（又名“长按”）弹出对话框

> ID：11972243
> 
> 赞同：1
> 
> 时间：2012-08-15T15:24:25.660
> 
> 标签：javascript, android, css, long-press

我正在尝试寻找一种方法来使用***javascript***或***css***（不是 Java）来防止 Android 设备在长按网页中的图像或锚点等 html 元素时显示弹出对话框。

我正在尝试制作旋转木马，如果我在旋转木马上按住左箭头或右箭头，会弹出一个窗口，要求我在新标签中打开，保存图像等。我可以在 iOS/ 上轻松完成此操作带有 CSS 规则的 Safari。

![我试图抑制的对话框的屏幕截图](../Images/d99605b756d23629ba410972331b86b5.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:33:15.157

how are you setting your setOnLongClickListener and onTouch?

make sure it's similar to this

```
setOnLongClickListener(new View.OnLongClickListener() {

    public boolean onLongClick(View view) {

      activity.openContextMenu(view);  

     return true;  // avoid extra click events

    }

});

setOnTouch(new View.OnTouchListener(){

  public boolean onTouch(View v, MotionEvent e){

    switch(e.getAction & MotionEvent.ACTION_MASK){

      // do drag/gesture processing. 

    }

// you MUST return false for ACTION_DOWN and ACTION_UP, for long click to work
// you can return true for ACTION_MOVEs that you consume. 
// DOWN/UP are needed by the long click timer.
// if you want, you can consume the UP if you have made a drag - so that after 
// a long drag, no long-click is generated.

    return false;

  }

});

setLongClickable(true); 
```

code curtosy of Sanjay Manohar [Detect touch press vs long press vs movement?](https://stackoverflow.com/questions/4324362/detect-touch-press-vs-long-press-vs-movement)

# objective-c - Objective-C：Getter 不应该用于副作用编译器警告

> ID：11972248
> 
> 赞同：4
> 
> 时间：2012-08-15T15:24:37.540
> 
> 标签：objective-c, methods, nsarray, notation

有人可以澄清这里发生了什么。我有一个名为：brainModel 的类，它又有一个名为：operandStack 的 NSArray。我只是访问向它发送消息“removeAllObjects”的数组

```
self.brainModel.operandStack.removeAllObjects; 
```

但是使用点表示法它会给我一个警告“未使用的属性访问结果-getter 不应该用于副作用”这到底是什么意思？

使用这样的嵌套括号语法不会给出警告：

```
 [[[self brainModel]operandStack]removeAllObjects]; 
```

顺便说一句，两者都有效......这与错误使用点表示法有什么关系吗？或者在这样的消息传递对象时使用点表示法被认为是一种好习惯 - 向它发送像“removeAllObjects”这样的参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:28:27.140

`removeAllObjects` is not a property; it's a method.

Using property-access notation works because properties are usually accessed using a method of the same name. However, it is expected that getting a property's value will not change the object which contains the object (or make any other changes), which is not the case with `removeAllObjects`. These are the "side effects" that the compiler is referring to.

Probably, you would want to perform this call instead:

```
[self.brainModel.operandStack removeAllObjects]; 
```

This gets the `brainModel` property of `self`, then the `operandStack` property of `self.brainModel`, then calls `removeAllObjects` on it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:28:32.947

removeAllObjects is a method. You cannot access methods through dot notation; only properties.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:30:41.123

You don't need to declare each and every method as a property - especially not if they are modifying the object. Getters should be viewed as accessors to a property (without exposing the backing ivar directly). Methods that are 'actions', to say, are to be declared as such (i. e. declared without the `@property` keyword and called using brackets instead of the dot notation).

# batch-file - CLS（清除）单行？

> ID：11972249
> 
> 赞同：9
> 
> 时间：2012-08-15T15:24:40.260
> 
> 标签：batch-file, console, cmd

有什么办法可以`CLS`输出单行吗？我不相信有任何开关`CLS`，所以也许更好的问题是：

有没有办法

1.  保留所有以前的输出以供重复使用？
    **或者**
2.  捕获当前显示的输出（就像您可以通过标记和复制一样）？

我只是想通过实时反馈/信息来使我的脚本对用户更加友好，而不是多行稍作改动。不过，我能想到的唯一方法是这样的：

```
@echo off
goto Prep

:Prep
    SET count=5
    SET genericMessage=This window will close

    goto Output

:Output
    IF NOT %count% == -1 (
        cls
        IF %count% == 0 (
            echo %genericMessage% now.
        ) ELSE (
            echo %genericMessage% in %count% seconds.
        )
        SET /A count=%count% - 1
        ping localhost -n 2 >nul
        goto Output
    ) ELSE (
        exit
    ) 
```

所以，你得到这个：

![在此处输入图像描述](../Images/99011cf4772b2c2548cce9f2e457f589.png)

但是，问题在于，当我只想通过擦除并重新输出一行来刷新一行时，它`CLS`会擦除**​​所有输出。**

有人有想法么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T16:31:55.567

如果您只需要在一行中移动光标（如您的示例），
则可以使用回车符。

```
@echo off
setlocal EnableDelayedExpansion
for /f %%a in ('copy /Z "%~f0" nul') do set "CR=%%a"
for /L %%n in (5 -1 1) do (
  <nul set /P "=This window will close in %%n seconds!CR!"
  ping -n 2 localhost > nul
) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T15:29:05.460

尝试 ANSI 序列：[http ://www.robvanderwoude.com/ansi.php](http://www.robvanderwoude.com/ansi.php)

挖掘链接，[http://batch.xoo.it/t2238-BG-exe-Utility-for-Batch-Games.htm](http://batch.xoo.it/t2238-BG-exe-Utility-for-Batch-Games.htm)看起来最有希望。

这个页面听起来像是关于控制/设置控制台大小（以及其他显示和缓冲区大小设置）的有用讨论。[http://www.pcreview.co.uk/forums/change-buffer-size-console-window-can-runas-inherit-console-props-t1468842.html *_* _](http://www.pcreview.co.uk/forums/change-_buffer_-size-console-window-can-runas-inherit-console-props-t1468842.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T16:00:36.170

不幸的是，没有本机命令或实用程序可以在 Windows 命令行控制台中重新定位您的光标。

您将需要一个 3rd 方实用程序。

Aacini 在 DOSTips 上发布了一个免费的 CursorPos.exe 实用程序。CurorPos.exe [“源”](http://www.dostips.com/forum/viewtopic.php?p=17216#p17216)以十六进制数字形式给出。要使用源代码，您需要[HexToBin.bat "compiler"](http://www.dostips.com/forum/viewtopic.php?f=3&t=3202)。

浏览这两个线程，您会发现许多您可能会觉得有用的实用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-11T12:49:40.570

通过以下方式[移动光标](https://www.dostips.com/forum/viewtopic.php?t=6760)的另一种快速和肮脏的方法[`TIMEOUT`](https://docs.microsoft.com/zh-tw/windows-server/administration/windows-commands/timeout_1)：

```
@echo off
<nul set/p"=5 seconds till i close..."
timeout /t 5 /nobreak >con
echo(i'm closing now...[REPLACE this with lots of spaces]
exit /b 
```

[![](../Images/1d5d52a68b99c259689a6cbde078ea89.png)](https://i.stack.imgur.com/tQod4.gif)

# cucumber - 黄瓜 | 步骤定义的通用名称

> ID：11972252
> 
> 赞同：0
> 
> 时间：2012-08-15T15:24:44.503
> 
> 标签：cucumber

在 Cucumber 中定义一个步骤是否有任何通用名称？

例如，改为使用 Given、When、Then 等词：

```
Given /^I visit the home page$/

When /^I click on (.*?)$/

Then /^I should see (.*?)$/ 
```

我想使用唯一常见的词：

```
Step /^I visit the home page$/

Step /^I click on (.*?)$/

Step /^I should see (.*?)$/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:10:19.483

在 Gherkin 级别，您可以使用`*`：

```
* I have $50 in my account 
```

在步骤定义层没有特殊词。但是 Cucumber 在将步骤与步骤定义匹配时不会考虑关键字名称。所以你可以这样做：

```
Then /^I do some test$/ 
```

将匹配：

```
Given I do some test 
```

但我很好奇你为什么需要这个。

# perl - 操作数字

> ID：11972256
> 
> 赞同：0
> 
> 时间：2012-08-15T15:25:06.217
> 
> 标签：perl, pattern-matching, digits

这是一个抓取前两列中包含 $position 和 $amino 值的行的程序。

代码：

```
#!/usr/bin/perl

my $id = $ARGV[0];
my $position = $ARGV[1]; # POSITION OF THE RESIDUE
my $amino= $ARGV[2]; #THREE LETTER AMINO ACID CODE IN CAPITALS
my @grabbed;

open (FILE, $id.$amino.$position.".hb2");

#CREATES AN ARRAY WITH ONLY THE VALUES FROM THE HB2 FILE. REMOVES THE HEADER OF THE FILE.

while (<FILE>) {
    if (/^-/) {
            push @grabbed, $_;
            while (<FILE>) {
            last if /^$/;
            push @grabbed, $_;
            }

    }
}
close (FILE);

for ( @grabbed ) {
my @f = split;
if (( $f[2] == "-"."00".$position."-".$amino ) or ($f[0] == "-"."00".$position."-".$amino)) {
    push @line, $id.$amino.$position, " ",$_;
}
}
print @line; 
```

部分输入数据：

```
-0007-ARG NH2 -0009-GLN OE1 3.24 SS   2  6.00 143.3  2.38 105.9  95.8     1 #CASE 1
-0008-GLU N   -0008-GLU OE1 2.62 MS   0 -1.00 120.8  1.96 102.3 103.4     2
-0011-ILE N   -0117-ARG O   2.87 MM 106  4.90 144.0  2.00 127.5 139.0     3 
-0117-ARG N   -0011-ILE O   2.75 MM 106  4.90 160.4  1.79 153.2 148.6     4 #CASE 2
-0016-SER N   -0012-THR O   2.89 MM   4  6.00 156.2  1.95 149.8 154.8     5 #CASE 3
-0017-ALA N   -0013-LEU O   3.10 MM   4  6.24 152.8  2.17 143.4 149.7     6
-0018-GLU N   -0014-ARG O   3.04 MM   4  6.24 154.1  2.11 147.2 154.2     7
-0019-ILE N   -0015-GLY O   2.90 MM   4  6.16 155.8  1.96 150.7 156.2     8
-0016-SER OG  -0188-THR OG1 2.72 SS 172  5.92 172.0  1.73  98.9  99.6     9
-0188-THR OG1 -0016-SER OG  2.72 SS 172  5.92 163.7  1.75 116.4 115.1    10 
```

问题 ：

为了概括程序，我将匹配设置为：

```
( $f[2] == "-"."00".$position."-".$amino ) or ($f[0] == "-"."00".$position."-".$amino) 
```

格式总是在 $amino (-0188-THR) 之前的“-”之后的四位数字。我突然意识到如果 $position 输入是“一位数（如 CASE 1）”或“三位数（如 CASE 2，第 1 列）”，我的代码将不起作用。由于我将其硬编码为“-”格式，后跟两个零和 THEN 位置，因此它必须始终是两位数输入才能工作。

我很难概括这段代码，以便我可以输入 1/2/3 位数字。其余数字将始终被零替换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:32:47.597

You can format the string using [sprintf](http://perldoc.perl.org/functions/sprintf.html):

```
 my $mstring = sprintf("-%04d-%s", $position, $amino);
  if ( ($f[2] eq $mstring) or ($f[0] eq $mstring) ) {
    # ...
  } 
```

Here, `%04d` adds 0's to the left of position to make it 4 digits long.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:35:08.667

首先，`==`perl 中的运算符仅用于比较算术表达式 要比较字符串，您应该使用`eq`运算符
其次，要从数字格式化字符串，您可以使用 sprintf 函数。

```
if ($f[2] eq "-".sprintf("%04d", $position)."-".$amino ... 
```

# android - 更改后如何刷新列表？

> ID：11972259
> 
> 赞同：0
> 
> 时间：2012-08-15T15:25:31.087
> 
> 标签：android, refresh

我使用我的 ArrayAdapter 扩展的 getView 方法。我更改 CheckBox 但 ListView 不刷新

我的来源

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {

        // Planet to display
        UrlItem urlItem = (UrlItem) this.getItem(position);
        ViewHolder viewHolder = null;

        if (convertView == null) {

            convertView = inflater.inflate(R.layout.database_table_item, null);
            viewHolder = new ViewHolder();
            viewHolder.checkbox = (CheckBox) convertView
                    .findViewById(R.id.checkBox1);

            viewHolder.checkbox
                    .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                        public void onCheckedChanged(CompoundButton buttonView,
                                boolean isChecked) {

                            int getPosition = (Integer) buttonView.getTag();
                            DatabaseTable.setPosition(getPosition);

                            for (int i = 0; i < UrlItems.size(); i ++ ) {

                                UrlItems.get(i).setUse(false);

                            }

                            UrlItems.get(getPosition).setUse(isChecked);

                        }
                    }); 
```

**更改后如何刷新列表？**

在清单集中供您参考

```
<activity
            android:name=".DatabaseTable"
            android:label="database_table" android:windowSoftInputMode="adjustPan" > 
```

使用“selectAll”按钮查看升级链接我有完全相同的想法，但没有按钮 selectAll

[http://pastebin.com/PgNeDnXq](http://pastebin.com/PgNeDnXq)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:27:26.420

```
mAdapter.notifyDataSetChanged(); 
```

通知数据集已更改；)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:13:34.377

```
adapter.notifyDataSetChanged(); // to notify the adapter that your data has been updated 
```

**注意：**如果您在上面的行中遇到任何错误，您可以尝试以下代码（其中 mListView 是我的 ListView 对象的名称）

```
((BaseAdapter) mListView.getAdapter()).notifyDataSetChanged(); 
```

另一种方法是使列表无效，以便再次从更新的数据集重新绘制它。

```
mListView=(ListView) findViewById(R.id.MyListView);
mListView.invalidate(); 
```

# javascript - IE9 动态页面 JS 问题

> ID：11972262
> 
> 赞同：1
> 
> 时间：2012-08-15T15:25:36.643
> 
> 标签：javascript, jquery, html, css, dynamic-loading

我已经创建了一个利用 JS 动态页面加载的页面，它在 Safari、FF 和 Chrome 中运行良好——当然，臭名昭著的 Internet Explorer 表现不佳。

（我知道这个页面上还有其他问题，在“Cykler”部分下，这些对于这个问题并不重要，不应该关注）

[http://soegaardcykler.dk/beta](http://soegaardcykler.dk/beta)

尝试单击其中一个类别，Cykler、Info 等。

奇怪的是，如果我在 IE 中打开开发人员工具并将模式设置为 IE8 并返回 IE9 没有问题，它会像任何其他浏览器一样切换页面。

如果我再次关闭并打开 IE，问题又回来了 - 如果我去控制台检查发生了什么，它会要求我刷新页面 - 当我这样做时，问题又消失了。

我不知道到底发生了什么，我的两个朋友也进行了测试，他们都在第一次访问该页面时遇到了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:44:58.247

我注意到您正在登录控制台。这在 IE 中是有问题的。控制台对象仅在控制台实际打开时才会显示（我认为）。

有几种解决方案可以避免控制台问题；除了创建自己的记录器对象（无论如何这不是一个坏主意）之外，我不能推荐最佳实践。

只是一个侧节点：我不知道您是否使用 Windows 操作系统，但如果您熟悉 Fiddler2 HTTP 流量分析器，您可以非常轻松地搜索会话。我就是这样找到你错过的文件的。

最后一个编辑：这是一篇很好的相关文章：[在 IE 中写入脚本控制台 (console.log) 的正确方法是什么？](https://stackoverflow.com/questions/4324454/whats-the-correct-way-to-write-to-the-script-console-console-log-in-ie)

# javascript - 选择所有具有特定数据的 html 标签的最有效方法是什么？

> ID：11972263
> 
> 赞同：4
> 
> 时间：2012-08-15T15:25:38.863
> 
> 标签：javascript, jquery, html

我正在尝试为我的 require js 模块添加某种动态配置。我声明了一些这样的html标签：

```
 <header data-module='js/views/header'>

    </header>

    <section data-module='js/views/homepage' data-hash='/'>

    </section>

    <section data-module='js/views/statistics' data-hash='/statistics'>

    </section>

    <footer data-module='js/views/footer'>

    </footer> 
```

我用来获取所有将数据模块设置为不同于 null 的元素的 jQuery 查询是：

```
 var $viewModules = $('[data-module]'); 
```

有没有更有效的方法来选择这些元素？我从未在 jQuery 中使用过数据选择器。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T15:40:26.167

由于您没有真正的共同点`tagName`或`className`用于进一步减少搜索，因此您当前的方式将是最有效的方式。

```
var $viewModules = $('[data-module]'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T15:44:49.537

这是一个困难的问题，但是，看到您询问效率，在文档上使用[**find()**](http://api.jquery.com/find/)似乎稍微快一点，最多 10%。

```
var $viewModules = $(document).find('[data-module]'); 
```

查看[**测试结果**](http://jsperf.com/select-all-by-attribute)

如果我不得不猜测为什么它会更快，我会说 find 在幕后进行了优化，但这只是一个猜测。

# javascript - 如何在不使用外部库的情况下使用 JavaScript 绘制折线图

> ID：11972268
> 
> 赞同：5
> 
> 时间：2012-08-15T15:26:05.907
> 
> 标签：javascript, jquery, graphics, graph

简而言之：

我想在不使用（开源）库的情况下用 JavaScript 绘制折线图。我只使用 JavaScript 和 jQuery（无插件！）。

我该如何管理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:33:21.597

我认为您忽略[了一些非常强大的库](https://stackoverflow.com/questions/10632563/open-sourced-options-for-html5-chart-libraries)，但是如果您决定自己这样做，您将需要使用 HTML5 和 Canvas 对象。看看[这个伟大的教程](https://web.archive.org/web/20130407101311/http://www.worldwidewhat.net/2011/06/draw-a-line-graph-using-html5-canvas/)，让你开始。这是您需要掌握的内容的快照：

```
$(document).ready(function() {
    var graph = $('#graph'),
        c = graph[0].getContext('2d');

    c.lineWidth = 2;
    c.strokeStyle = '#333';
    c.font = 'italic 8pt sans-serif';
    c.textAlign = "center";

    c.beginPath();
    c.moveTo(xPadding, 0);
    c.lineTo(xPadding, graph.height() - yPadding);
    c.lineTo(graph.width(), graph.height() - yPadding);
    c.stroke();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:31:31.117

最好的解决方案（除了外部库）可能是`canvas`HTML5 中引入的 .

[这](https://developer.mozilla.org/en-US/docs/Canvas_tutorial)是一个教程，您可以通过 Google 找到更多信息。

# g++ - ICU Transliterator 不能在没有带有 g++ 的 -O2 标志的情况下工作

> ID：11972274
> 
> 赞同：1
> 
> 时间：2012-08-15T15:26:16.477
> 
> 标签：g++, icu

我一直在使用 ICU 的基于规则的 Transliterator 遇到问题，结果证明这是由`-O2`使用 g++ 4.7.1 的调试版本中缺少标志引起的。当我进行发布构建（具有`-O2`）时它工作正常，但是当我构建我的项目时没有该标志进行调试时，该`Transliterator`对象将永远无法正确创建。

```
Transliterator* t = Transliterator::createFromRules(id, rules, UTRANS_FORWARD, parseError, status); 
```

未经优化，`t`分配一个空指针并`status`设置为 32767，`BOGUS UErrorCode`当通过 ICU 运行时转换为`u_errorName()`.

我尝试的第一件事是`-g`从我的构建中删除调试标志，但这对`createFromRules()`返回的内容没有影响。只有当我添加`-O2`时它才创建`Transliterator`对象。

测试表明`-O1`,`-O2`并且`-O3`所有工作都按预期工作，并且只会`-O0`导致这种情况发生。

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T20:12:05.997

无论有/没有调试，您都不应该有不同的结果。你能创建一个包含规则的小测试用例，给出 ICU 版本和操作系统/平台，并提交工单吗？4.7.1 于 2 个月前发布。可能是编译器错误（ICU 有很**长**的发现这些错误的历史！！）或潜在错误。您可以将错误链接到此问题，反之亦然。

# php - Mysqli回滚不起作用

> ID：11972279
> 
> 赞同：3
> 
> 时间：2012-08-15T15:26:39.893
> 
> 标签：php, mysql, sql, transactions, mysqli

我有一个 MySQL 数据库，我正在使用`mysqli`.

由于某种原因，我无法让交易正常工作。如果我打电话`$mysqli->rollback()`，它不会回滚。

示例代码：

```
$mysqli->autocommit(false);

$sql = "INSERT INTO myTable (name , color) VALUES ('Dan' , 'red')";

$mysqli->query($sql);

$mysqli->rollback(); 
```

结果是另一行添加到 myTable。谁能想到一个原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T15:28:38.227

您使用的是 myIsam 还是 innodb？因为据我所知它只适用于innodb

# excel - Excel 使用宏格式化报表

> ID：11972280
> 
> 赞同：0
> 
> 时间：2012-08-15T15:26:45.177
> 
> 标签：excel, excel-formula, visual-studio-macros, vba

我正在研究格式化由第 3 方系统自动生成的报告。由于我们无法直接访问数据库，我想构建一个宏，将报告格式化为更易读的格式。

我最初考虑将这些原始数据提取到数据库中，因为我非常有能力编写 SQL 查询，但是我认为如果有人可以通过宏运行它会更容易。

初始报告显示哪些用户尝试了哪些培训模块及其完成状态。

Nb 一个用户可能已经多次完成一个模块，因此会出现多次。

下面的链接是带有两张表的电子表格，表 1 是原始数据，表 2 是我希望事情出现的方式。

[https://www.dropbox.com/s/p1hipx17q3mf3dm/Learning-Report.xlsx](https://www.dropbox.com/s/p1hipx17q3mf3dm/Learning-Report.xlsx)

任何帮助/想法将不胜感激，因为我对整个宏在 excel 中的东西都很陌生。

非常感谢

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:55:47.153

我以同样的方式回答问题，所以请多多包涵……

1.  识别所有唯一的员工（对于行）
2.  识别所有独特的课程（用于列）
3.  找出所有的尝试并计算 a。最高分 B. 地位
4.  把数据放在第二张纸上。

看看问题是否准确......答案也很重要。

# c# - 有没有办法让 C# 类处理自己的空引用异常

> ID：11972281
> 
> 赞同：25
> 
> 时间：2012-08-15T15:26:46.400
> 
> 标签：c#

**问题**

我想要一个能够处理自身空引用的类。我怎样才能做到这一点？扩展方法是我能想到的唯一方法，但我想我会问，以防有一些我不知道的关于 C# 的漂亮事情。

**例子**

我有一个名为的类`User`，其属性名为`IsAuthorized`.

正确`User`实例化的时间`IsAuthorized`有一个实现。但是，当我的`User`引用包含 null 时，我希望调用`IsAuthorized`返回 false 而不是爆炸。

* * *

**解决方案**

很多很好的答案。我最终使用其中三个来解决我的问题。

1.  我使用了 Zaid Masud 建议的 Null Object 设计模式。
2.  我将它与 Belmiris 的使用 struct 的建议结合起来，所以我不能有空引用
3.  并从 Jon Hanna 那里得到了一个很好的解释，解释了为什么 C# 以这种方式工作以及我如何才能真正解决它

不幸的是，我只能选择其中一个作为我接受的答案，因此如果您正在访问此页面，您应该花时间对所有这三个以及任何其他出色的答案进行投票。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-15T15:43:37.267

一个合适的面向对象的解决方案怎么样？这正是[空对象](http://en.wikipedia.org/wiki/Null_Object_pattern)设计模式的用途。

您可以提取一个 IUser 接口，让您的 User 对象实现此接口，然后创建一个 NullUser 对象（也实现 IUser）并始终在 IsAuthorized 属性上返回 false。

现在，修改消费代码以依赖 IUser 而不是 User。客户端代码将不再需要空检查。

下面的代码示例：

```
public interface IUser
{
    // ... other required User method/property signatures

    bool IsAuthorized { get; }
}

public class User : IUser
{
    // other method/property implementations

    public bool IsAuthorized
    {
        get { // implementation logic here }
    }
}

public class NullUser : IUser
{
    public bool IsAuthorized
    {
        get { return false; }
    }
} 
```

现在，您的代码将返回 IUser 而不是 User 并且客户端代码将仅依赖于 IUser：

```
public IUser GetUser()
{
    if (condition)
    {
        return new NullUser(); // never return null anymore, replace with NullUser instead
    }
    return new User(...);
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-15T15:31:23.190

> 但是，当我的用户引用包含 null 时，我希望 IsAuthorized 始终返回 false 而不是爆炸。

仅当`IsAuthorized`是静态方法时才能执行此操作，在这种情况下，您可以检查 null。这就是扩展方法可以做到这一点的原因——它们实际上只是调用静态方法的不同语法。

调用方法或属性，例如`IsAuthorized`实例方法需要实例。仅调用实例方法（包括属性 getter）的行为`null`就会触发异常。当您尝试使用 (null) 引用时，该异常不是由您的类引发，而是由运行时本身引发。在 C# 中没有办法解决这个问题。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-15T15:32:03.267

如果变量为空，则意味着它不引用任何对象，因此在类方法中处理空引用是没有意义的（而且我认为这在技术上是不可能的）。

您应该通过在调用“IsAuthorized”或之前的事件之前检查来保证它不为空。

编辑：找到一种解决方法来做到这一点将是一件坏事：有人理解这种行为会令人困惑，因为它不是编程语言的“预期”行为。它还可能导致您的代码隐藏一些问题（它应该是一个对象的空值）并创建一个很难找到的错误。也就是说：**这肯定是个坏主意。**

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-15T16:19:44.303

问题根本不在于创建这样的方法。它与**调用**方法有关。如果您`if(this == null)`在代码中进行测试，那是完全有效的。我想它可以被编译器优化掉，因为它“不可能”被击中，但幸运的是它不是。

但是，当您**调用**该方法时，它将通过 完成`callvirt`，因此它不会直接调用该方法，而是会找到该方法的版本以调用特定实例，就像使用虚拟方法一样。由于空引用将失败，因此您完美的自空测试方法将在它被调用之前失败。

C# 故意这样做。[根据 Eric Gunnerson](http://blogs.msdn.com/b/ericgu/archive/2008/07/02/why-does-c-always-use-callvirt.aspx)的说法，这是因为他们认为让你这样做会有点奇怪。

我一直不明白为什么让以 C++ 为模型的 .NET 语言在 .NET 和同一家公司生产的 C++ 编译器中完全允许做一些事情，* 被认为有点奇怪。我一直认为不允许这样做有点奇怪。

您可以从调用该类的另一种语言（F# 或 IL）中添加一些内容，或者使用它`Reflection.Emit`来生成执行此操作的委托，这样就可以正常工作。例如，以下代码将调用`GetHashCode`定义在的版本`object`（即，即使`GetHashCode`被覆盖，this 也不会调用覆盖），这是可以安全调用空实例的方法的示例：

```
DynamicMethod dynM = new DynamicMethod(string.Empty, typeof(int), new Type[]{typeof(object)}, typeof(object));
ILGenerator ilGen = dynM.GetILGenerator(7);
ilGen.Emit(OpCodes.Ldarg_0);
ilGen.Emit(OpCodes.Call, typeof(object).GetMethod("GetHashCode"));
ilGen.Emit(OpCodes.Ret);
Func<object, int> RootHashCode = (Func<object, int>)dynM.CreateDelegate(typeof(Func<object, int>));
Console.WriteLine(RootHashCode(null)); 
```

这样做的一个好处是你可以坚持，`RootHashCode`所以你只需要构建一次（比如在静态构造函数中），然后你就可以重复使用它。

*这对于让其他*代码通过空引用调用您的方法当然没有任何价值，因为您建议的扩展方法是您唯一的选择。

当然，同样值得注意的是，如果您使用的语言没有 C# 的这种怪癖，那么您应该提供一些替代方法来获取调用空引用的“默认”结果，因为 C# 人们可以'不明白。就像 C# 一样，人们应该避免公共名称之间仅区分大小写，因为某些语言无法处理这种情况。

编辑：您的问题`IsAuthorized`被调用的完整示例，因为投票表明有些人不相信可以做到（！）

```
using System;
using System.Reflection.Emit;
using System.Security;

/*We need to either have User allow partially-trusted
 callers, or we need to have Program be fully-trusted.
 The former is the quicker to do, though the latter is
 more likely to be what one would want for real*/ 
[assembly:AllowPartiallyTrustedCallers]

namespace AllowCallsOnNull
{
  public class User
  {
    public bool IsAuthorized
    {
      get
      {
        //Perverse because someone writing in C# should be expected to be friendly to
        //C#! This though doesn't apply to someone writing in another language who may
        //not know C# has difficulties calling this.
        //Still, don't do this:
        if(this == null)
        {
          Console.Error.WriteLine("I don't exist!");
          return false;
        }
        /*Real code to work out if the user is authorised
        would go here. We're just going to return true
        to demonstrate the point*/
        Console.Error.WriteLine("I'm a real boy! I mean, user!");
        return true;
      }
    }
  }
  class Program
  {
    public static void Main(string[] args)
    {
      //Set-up the helper that calls IsAuthorized on a
      //User, that may be null.
      DynamicMethod dynM = new DynamicMethod(string.Empty, typeof(bool), new Type[]{typeof(User)}, typeof(object));
      ILGenerator ilGen = dynM.GetILGenerator(7);
      ilGen.Emit(OpCodes.Ldarg_0);
      ilGen.Emit(OpCodes.Call, typeof(User).GetProperty("IsAuthorized").GetGetMethod());
      ilGen.Emit(OpCodes.Ret);
      Func<User, bool> CheckAuthorized = (Func<User, bool>)dynM.CreateDelegate(typeof(Func<User, bool>));

      //Now call it, first on null, then on an object
      Console.WriteLine(CheckAuthorized(null));    //false
      Console.WriteLine(CheckAuthorized(new User()));//true
      //Wait for input so the user will actually see this.
      Console.ReadKey(true);
    }
  }
} 
```

哦，还有一个现实生活中的实际问题。C# 行为的好处在于，它会导致对空引用的调用快速失败，因为它们访问中间某处的字段或虚拟，所以无论如何都会失败。这意味着我们在编写调用时不必担心我们是否处于空实例中。但是，如果您想在完全公共的方法（即公共类的公共方法）中防弹，那么您不能依赖于此。如果方法的第 1 步始终跟在第 2 步之后很重要，并且只有在空实例上调用第 2 步时才会失败，那么应该进行自空检查。这很少会发生，但它可能会导致非 C# 用户的错误，如果不使用上述技术，您将永远无法在 C# 中重现这些错误。

*虽然，这是特定于他们的编译器的 - 根据 C++ 标准 IIRC，它是未定义的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-15T15:37:42.933

你可以改用结构吗？那么它不应该为空。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-15T15:35:13.113

如果您没有有效的实例引用，则无法引用属性。如果您希望即使使用空引用也能够引用属性并且不将空检查的责任放在调用者身上，一种方法是使用静态方法`User`：

```
static bool IsAuthorized(User user)
{
    if(user!=null)
    {
        return user.IsAuthorized;
    }
    else
    {
        return false;
    }
} 
```

然后，当您要检查您的授权时，而不是：

`if(thisUser.IsAuthorized)`

做：

`if(User.IsAuthorized(thisUser))`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-15T17:43:52.237

唯一可行的方法是使用扩展方法或其他静态方法来处理空引用。

NullReferenceExceptions（Javaheads 的 NullPointerExceptions；大致同义）发生在代码被告知调用属于实际上不存在的对象实例的方法时。您必须记住的是 null 实际上不是任何对象。一个类型的变量可以设置为 null，但这仅仅意味着该变量不引用实例。

问题就在于此；如果一个变量，不管它的类型（只要它是一个可以为空的类型）都是空的，那么就没有一个可以调用该方法的实例，并且实例方法需要一个实例，因为这是程序如何确定该方法可访问的成员的状态。如果 MyClass 有一个 MyField 和 MyMethod()，并且您在 MyClass 的空引用上调用了 MyMethod，那么 MyField 的值是多少？

解决方案通常是移动到静态范围。静态成员（和类）保证具有状态，因为它们在运行时被实例化一次（通常是即时的，如在第一次引用之前）。因为它们总是有状态，所以它们总是可以被调用，因此可以做一些在实例级别可能无法完成的事情。这是您可以在 C# 中用于从对象成员链返回值的方法，否则可能会导致 NRE：

```
public static TOut ValueOrDefault<TIn, TOut>(this TIn input, Func<TIn, TOut> projection, 
       TOut defaultValue = default(TOut))
    {
        try
        {
            var result = projection(input);
            if (result == null) result = defaultValue;
            return result;
        }
        catch (NullReferenceException) //most nulls result in one of these.
        {
            return defaultValue;
        }
        catch (InvalidOperationException) //Nullable<T>s with no value throw these
        {
            return defaultValue;
        }
    } 
```

用法：

```
class MyClass {public MyClass2 MyField;}
class MyClass2 {public List<string> MyItems; public int? MyNullableField;}

...
var myClass = null;
//returns 0; myClass is null
var result = myClass.ValueOrDefault(x=>x.MyField.MyItems.Count);
myClass = new MyClass();
//returns 0; MyField is null
result = myClass.ValueOrDefault(x=>x.MyField.MyItems.Count);
myClass.MyField = new MyClass2();
//returns 0; MyItems is null
result = myClass.ValueOrDefault(x=>x.MyField.MyItems.Count);
myClass.MyField.MyItems = new List<string>();
//returns 0, but now that's the actual result of the Count property; 
//the entire chain is valid
result = myClass.ValueOrDefault(x=>x.MyField.MyItems.Count);
//returns null, because FirstOrDefault() returns null
var myString = myClass.ValueOrDefault(x=>x.MyField.MyItems.FirstOrDefault());
myClass.MyField.MyItems.Add("A string");
//returns "A string"
myString = myClass.ValueOrDefault(x=>x.MyField.MyItems.FirstOrDefault());
//returns 0, because MyNullableField is null; the exception caught here is not an NRE,
//but an InvalidOperationException
var myValue = myClass.ValueOrDefault(x=>x.MyField.MyNullableField.Value); 
```

虽然这种方法在需要长嵌套的三元运算符来生成某些东西（任何东西）以显示给用户或在计算中使用的情况下具有价值，但我不建议使用这种模式来执行操作（void 方法）。因为不会丢弃 NRE 或 IOE，所以您永远不会知道您要求它做的事情是否真的完成了。您可能能够使用返回 true 或 false 的“TryPerformAction()”方法，和/或具有包含抛出异常（如果有）的输出参数。但是，如果您要遇到那种麻烦，为什么不自己尝试/抓住它呢？

# css - 绝对位置将元素旋转到右上角

> ID：11972286
> 
> 赞同：20
> 
> 时间：2012-08-15T15:26:57.257
> 
> 标签：css, css-transitions

我试图弄清楚如何制作将位于右上角并旋转 90 度的购物车选项卡。旋转自然地混合了位置，但也许有一种解决方法可以包装到不同的包装器等......

如果不需要定义宽度，则加分。我不在乎旧的浏览器

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-15T16:59:17.670

怎么用[**`transform-origin`**](https://developer.mozilla.org/en-US/docs/CSS/transform-origin)？见[**演示**](http://dabblet.com/gist/3361555)。

相关CSS：

```
#box {
    position: relative;
}
.bg {
    right: 40px; /* same as height */
    height: 40px;
    transform: rotate(-90deg);
    transform-origin: 100% 0;
    position: absolute;
    line-height: 40px; /* same as height, for vertical centering */
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-04-01T12:58:54.300

[Ana 的回答](https://stackoverflow.com/a/11973680/988246)非常好，并为我指明了正确的方向，但我意识到您可以实现相同的效果，而无需显式设置要移动的元素的高度、行高和位置 - 相反，只需设置`translate(0, -100%)`：

```
body {
  margin: 0;
}

#box {
  position: relative;
}

.bg {
	right: 0;
	padding: 1em;
	transform: rotate(-90deg) translate(0, -100%);
	transform-origin: 100% 0;
	position: absolute;
	background: #FF1493;
}
```

```
<div id="box">
	<div class="bg">        
		<div class="txt">He's not the Messiah. He's a very naughty boy.</div>
	</div>
</div>
```

...和一个很好的衡量标准的[jsFiddle](https://jsfiddle.net/xvvvv15w/52/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-05-09T07:50:51.830

要使用 CSS 将文本旋转 90°，请考虑使用[`writing-mode`](https://developer.mozilla.org/en-US/docs/Web/CSS/writing-mode).

在父 div 上设置`position: relative;`，然后在旋转的元素上使用类似的东西：

```
#rot {
    position: absolute; /* only handy here because its parent is set to `position: relative;` */
    left: 0;
    top: 0px;
    /* writing-mode: sideways-lr;   /* Webkit browsers don't support `sideways-lr` yet */
    writing-mode: vertical-rl;  /* `vertical-rl` and a rotation will achieve the same effect */
    transform: scaleX(-1) scaleY(-1);
    height: 100%;

    background: rgba(0, 0, 0, 0.1);
    text-align: center;
    line-height: 2.85;
    color: white;
    font-weight: bold;
} 
```

您最终会在父 div 的一侧堆叠一个 div，文本呈 90° 角。

这样您就不必考虑旋转原点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-24T09:09:10.650

如果您需要定位包装器 div.并旋转子 div 使其始终垂直和水平居中，请尝试这样的事情！

```
.togglewrap{
position:relative;
float:left;left:20%;top:0;
width:30px; 
height:120px;
background-color: #ffde21;
}
.sbartoggle {
    background:#f5f5f5;
    position:absolute;
    left:0;
    top:0;
    right:0;
    bottom:0;
    margin:auto;
    width:100%; 
    height:30px;/*equal to parent width*/
    line-height:30px;/*center text*/
    transform: rotate(-90deg);
    background-size:10px 10px;
    } 
```

# ios - 在（越狱）iDevice 上从 XCode 无线安装应用程序

> ID：11972287
> 
> 赞同：1
> 
> 时间：2012-08-15T15:27:04.390
> 
> 标签：ios, xcode, installation, jailbreak, wireless

我为 iPhone 构建了我的应用程序（没有代码签名，在 Jailcoder 实用程序的帮助下）。如何通过 Wi-Fi 在我的越狱设备上安装它？我只需要安装它，而不需要从 XCode 运行/调试。

作为一种方法，我尝试将其打包`IPA`并下载`Installous`，但安装失败并`unexpected content`显示错误消息。

有工作方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:32:22.573

我在这里找到了通过 WiFi 将 IPA 传输到越狱 iPhone 的基本说明：[http ://www.ehow.com/how_12098417_send-ipa-ipod-touch.html](http://www.ehow.com/how_12098417_send-ipa-ipod-touch.html)

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:03:04.863

我通过`Installous`. 以前没有为我的设备配置构建，这就是出现错误的原因。

脚步：

*   存档内置`XCode`( `Product->Archive`)
*   在finder中显示存档文件夹，从中获取`app`文件夹
*   将`app`文件夹放入`Payload`文件夹并压缩这一切
*   将扩展名更改`.zip`为`.ipa`
*   在`Installous`获取设备 IP 地址，而不是在桌面浏览器中输入
*   上传`ipa`文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-25T12:24:37.507

您可以通过生成构建，使用 sftp 将其传输到您的设备，然后使用 installipa 将其安装到设备上来实现。[这是](http://highaltitudehacks.com/2013/07/25/ios-application-security-part-7-installing-and-running-custom-applications-on-device-without-a-registered-developer-account)我写的教程。

# java - “？”的类型擦除是什么？

> ID：11972297
> 
> 赞同：1
> 
> 时间：2012-08-15T15:27:31.857
> 
> 标签：java, generics

如果我有以下方法：

```
public <U extends Number> void doSomething(List<U> l){      
} 
```

然后由于`type erasure`编译器将使其变为`doSomething(List<Number> l)`. 对？
如果是这种情况，那么为什么不能同时声明以下内容：

```
public void doSomething(List<?> l){  
} 
```

这不是第二种方法`type erased`吗`doSomething(List<Object> l)`？为什么这两种方法会出现相同擦除的编译器错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T15:29:52.387

你的想法是错误的。擦除导致两种方法都具有此签名（`List`参数类型被擦除）：

```
public void doSomething(List l) {  
} 
```

因此，碰撞。你认为可以做的是：

```
public <U extends Number> void doSomething(U argument) {      
}  
public <U extends Object> void doSomething(U argument) {      
} 
```

在这种情况下，在擦除之后，方法签名将变成这个（在`U`被擦除之后）

```
public void doSomething(Number argument) {      
}  
public void doSomething(Object argument) {      
} 
```

在这种情况下，没有签名冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:28:13.910

[`?`](http://docs.oracle.com/javase/tutorial/java/generics/wildcards.html)在泛型中用作通配符。

它将被删除。

`U extends Number`告诉上限是数字

`List<?>`没有告诉什么是上限。

编辑：基于编辑的问题，编译后，字节码只包含。

```
public void doSomething(List argument) {      
}  
public void doSomething(List argument) {      
} 
```

[泛型](http://docs.oracle.com/javase/tutorial/java/generics/inheritance.html)中的继承与我们所知的 java 中的继承几乎没有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:31:58.947

**1.** `?`在泛型中用作通配符。

**例如：**

假设**Animal 是一个 Class**。

`ArrayList<? extends Animal>` 表示**扩展 Animal 的任何类的实例**

期间`Erasure`，**这是编译器在编译期间删除类和方法中的泛型的过程**，以使泛型代码与未引入泛型时编写的代码兼容。

所以`?`并且`U`将在`compilation`一段时间内被删除..所以**在运行时它将不存在**

# java - 用于将消息属性添加到字段上的现有 JSR-303 注释的注释处理

> ID：11972299
> 
> 赞同：0
> 
> 时间：2012-08-15T15:27:49.267
> 
> 标签：java, hibernate, annotations, bean-validation, annotation-processing

我有一个使用 JSR-303 约束注释的数据传输对象，例如...

```
public class AssetOwnedDailyLocatableId implements Serializable, AssetOwned, HasOperatingDay, Locatable {

private static final long serialVersionUID = 1L;

@NotEmpty
@Size(min = 1, max = 30)
private String locationName;

@NotEmpty
private String operatingDay;

@NotEmpty
@Size(min = 1, max = 30)
private String assetOwner; 
```

我正在尝试使用注释处理来丰富每个 JSR-303 约束，`message`其值将等于`constraint-name.class-name.member-name`.

例如，使用上面的方法，`locationName`字段注释的最终生成输出看起来像......

```
@NotEmpty(message="{NotEmpty.AssetOwnedDailyLocatableId.locationName}")
@Size(min = 1, max = 30, message="{Size.AssetOwnedDailyLocatableId.locationName}")
private String locationName; 
```

为什么？因为我想完全控制自定义验证消息。我有数百个数据传输对象，我想用类似的东西来处理......

```
/**
 * ViolationConstraint message processor. During compile time it scans all DTO
 * classes that have <code>javax.validation.constrants.*</code> or 
 * <code>org.hibernate.validator.constraints.*</code>annotated
 * fields, then enriches the annotation with a <code>message</code> attribute
 * where its value will be <code>constraint-name.class-name.field-name</code>.
 * 
 * @param <T>
 *            any JSR-303 annotation type
 * 
 */
@SupportedSourceVersion(SourceVersion.RELEASE_6)
@SupportedAnnotationTypes(value = { "javax.validation.constraints.*", "org.hibernate.validator.constraints.*" })
public class ValidationMessagesProcessor<T extends Annotation> extends AbstractProcessor {

private static final String JAVAX_PATH = "javax.validation.constraints.*";
private static final String HIBERNATE_PATH = "org.hibernate.validator.constraints/*";

private PackageUtil<T> util;

public ValidationMessagesProcessor() {
    super();
    util = new PackageUtil<T>();
}

/* (non-Javadoc)
 * @see javax.annotation.processing.AbstractProcessor#process(java.util.Set, javax.annotation.processing.RoundEnvironment)
 */
@Override
public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment roundEnvironment) {
    if (!roundEnvironment.processingOver()) {
        String message;
        message = ValidationMessagesProcessor.class.getName() + " will begin processing now...";
        processingEnv.getMessager().printMessage(Diagnostic.Kind.NOTE, message);
        try {
            final List<Class<T>> annotationTypes = new ArrayList<Class<T>>();
            final List<Class<T>> jxTypes = util.listMatchingClasses(JAVAX_PATH);
            final List<Class<T>> hibTypes = util.listMatchingClasses(HIBERNATE_PATH);
            annotationTypes.addAll(jxTypes);
            annotationTypes.addAll(hibTypes);

            for (final Element e : roundEnvironment.getRootElements()) {

                // TODO Do the real work!

                /*message = "... JSR-303 annotation '" + a.annotationType().getClass().getName() + "' found in "
                        + e.getSimpleName();
                processingEnv.getMessager().printMessage(Diagnostic.Kind.NOTE, message); */
            }
        } catch (final IOException ioe) {
            message = "Failed to locate javax.validation.constraints or org.hibernate.validator.constraints classes on classpath!";
            processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, message);
        }
    }
    return true; // no further processing of this annotation type
}

} 
```

我想知道上述方法是否可行，或者我是否应该尝试其他方法（这可能更简单）。此外，如果可行，请说明在上述处理器的 //TODO 部分中实现什么的方向。目前咨询过...

*   [http://today.java.net/pub/a/today/2008/04/10/source-code-analysis-using-java-6-compiler-apis.html#resources](http://today.java.net/pub/a/today/2008/04/10/source-code-analysis-using-java-6-compiler-apis.html#resources)
*   [http://blog.xebia.com/2009/07/21/testing-annotation-processors/](http://blog.xebia.com/2009/07/21/testing-annotation-processors/)
*   [Java中注解处理的弊端？](https://stackoverflow.com/questions/687553/the-drawbacks-of-annotation-processing-in-java)
*   [为 maven-processor-plugin 编写注释处理器](https://stackoverflow.com/questions/5300963/writing-an-annotation-processor-for-maven-processor-plugin)
*   [如何在 Maven 2 中使用自定义注释处理器？](https://stackoverflow.com/questions/11668055/how-to-use-custom-annotation-processor-with-maven-2?rq=1)
*   [我可以从 TypeVariable 或 VariableElement 获取基础类上的方法列表吗？在编译时的注释处理器中](https://stackoverflow.com/questions/6926632/can-i-get-from-a-typevariable-or-variableelement-to-a-list-of-methods-on-the-und?rq=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T03:40:02.670

所以我选择创作一个基于 Eclipse JDT 的实用程序。

我花了一段时间来寻找所有依赖库来完成这项工作。对于其他感兴趣的人，这里是 Maven 依赖项：

```
 <!-- Validation API and Impl -->
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>${validation-api.version}</version>
    </dependency>
    <!-- Hibernate validator impl -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
    </dependency>

    <!-- Required to power classpath scanning for JSR-303 classes within JAR packages -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${spring.framework.version}</version>
    </dependency>

    <!-- Required to employ all Eclipse JDT capabilities -->
    <!-- This specific collection of artifact versions is known to work together -->
    <!-- Take caution when upgrading versions! -->
    <dependency>
        <groupId>org.eclipse.tycho</groupId>
        <artifactId>org.eclipse.jdt.core</artifactId>
        <version>3.8.1.v20120502-0834</version>
    </dependency>
    <dependency>
        <groupId>org.eclipse.tycho</groupId>
        <artifactId>org.eclipse.osgi</artifactId>
        <version>3.8.0.v20120430-1750</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.core.resources</artifactId>
        <version>3.7.100.v20110510-0712</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.jdt.core</artifactId>
        <version>3.7.0.v_B61</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.core.runtime</artifactId>
        <version>3.7.0.v20110110</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.equinox.common</artifactId>
        <version>3.6.0.v20110523</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.text</artifactId>
        <version>3.5.100.v20110505-0800</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.core.jobs</artifactId>
        <version>3.5.100.v20110404</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.core.contenttype</artifactId>
        <version>3.4.100.v20110423-0524</version>
    </dependency>
    <dependency>
        <groupId>org.jibx.config.3rdparty.org.eclipse</groupId>
        <artifactId>org.eclipse.equinox.preferences</artifactId>
        <version>3.4.0.v20110502</version>
    </dependency> 
```

我编写了四个类，一个带有主线束，另一个是外观和实用程序。

**线束**：_

```
import java.io.File;
import java.io.IOException;
import java.lang.annotation.Annotation;
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.eclipse.jdt.core.dom.AST;
import org.eclipse.jdt.core.dom.AbstractTypeDeclaration;
import org.eclipse.jdt.core.dom.CompilationUnit;
import org.eclipse.jdt.core.dom.Expression;
import org.eclipse.jdt.core.dom.FieldDeclaration;
import org.eclipse.jdt.core.dom.IExtendedModifier;
import org.eclipse.jdt.core.dom.MemberValuePair;
import org.eclipse.jdt.core.dom.NormalAnnotation;
import org.eclipse.jdt.core.dom.StringLiteral;
import org.eclipse.jface.text.BadLocationException;
import org.eclipse.jface.text.Document;
import org.eclipse.text.edits.MalformedTreeException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.spp.im.mui.commons.jdt.JDTFacade;
import org.spp.im.mui.commons.util.FileUtil;
import org.spp.im.mui.commons.util.PackageUtil;
import org.springframework.util.CollectionUtils;

/**
 * A utility that scans all DTO classes that have
 * <code>javax.validation.constrants.*</code> or
 * <code>org.hibernate.validation.constraints.*</code> annotated fields, then
 * enriches the annotation with a <code>message</code> attribute where its value
 * will be <code>constraint-name.class-name.field-name</code>.
 * 
 * @author cphillipson
 * @param <T>
 *            any JSR-303 annotation type
 * 
 */
 public class ConstraintMessageUtil<T extends Annotation> {

private static Logger log = LoggerFactory.getLogger(ConstraintMessageUtil.class);

private static final String JAVAX_PATH = "/javax/validation/constraints/*";
private static final String HIBERNATE_PATH = "/org/hibernate/validator/constraints/*";

private PackageUtil<T> util;
private JDTFacade<T> facade;

public ConstraintMessageUtil() {
    util = new PackageUtil<T>();
    facade = new JDTFacade<T>();
}

public void process(String sourcePath) throws Exception {

    // step #1: build a set of JSR-303 constraint classes
    final Set<Class<T>> annotationTypes = new HashSet<Class<T>>();
    try {
        final List<Class<T>> jxTypes = util.listMatchingClasses(JAVAX_PATH);
        final List<Class<T>> hibTypes = util.listMatchingClasses(HIBERNATE_PATH);
        annotationTypes.addAll(jxTypes);
        annotationTypes.addAll(hibTypes);
        // remove @Valid from the mix
        annotationTypes.remove(Valid.class);
        Assert.isTrue(!annotationTypes.contains(Valid.class));
    } catch (final IOException ioe) {

    }

    // step #2: get all files recursively from source path
    final Collection<File> allJavaSourceInDirectory = FileUtil.getAllJavaSourceInDirectory(new File(sourcePath),
            true);

    // step #3: filter files to just the ones that contain annotations
    final List<File> annotatedSources = new ArrayList<File>();
    if (!CollectionUtils.isEmpty(allJavaSourceInDirectory)) {
        boolean containsJsr303Annotation;
        String typeName;
        for (final File f : allJavaSourceInDirectory) {
            for (final Class<T> annotationType : annotationTypes) {
                typeName = annotationType.getName();
                containsJsr303Annotation = FileUtil.isContentInFile(f, typeName);
                if (containsJsr303Annotation) {
                    annotatedSources.add(f);
                    break; // at least one annotation found, move along
                }
            }
        }
    }

    // step #4: for each annotated source file parse and rewrite with
    // enriched message for each JSR-303 annotation
    enrichJavaSourceFilesWithMessageAttributesForConstraintTypeAnnotatedFields(annotatedSources, annotationTypes);

}

// note: probably could have implemented an ASTVisitor, but...
protected void enrichJavaSourceFilesWithMessageAttributesForConstraintTypeAnnotatedFields(
        List<File> annotatedSources, Set<Class<T>> constraintTypes) throws IOException, MalformedTreeException,
        BadLocationException {
    if (!CollectionUtils.isEmpty(annotatedSources)) {
        // reusable local variables... a veritable cornucopia
        Set<FieldDeclaration> fieldCandidates;
        Document document;
        String contents;
        String constraintName;
        String className;
        String fieldName;
        StringBuilder sb;
        AbstractTypeDeclaration td;
        IExtendedModifier[] modifiers;
        CompilationUnit unit;
        AST ast;
        MemberValuePair mvp;
        Expression exp;
        NormalAnnotation na;

        // iterate over all java source containing jsr-303 annotated fields
        for (final File source : annotatedSources) {
            unit = facade.generateCompilationUnitForFile(source);
            ast = unit.getAST();
            // get the set of fields which are annotated
            fieldCandidates = facade.obtainAnnotatedFieldsFromClassInCompilationUnit(unit, constraintTypes);
            log.info(source.getName() + " contains " + fieldCandidates.size()
                    + " fields with constraint annotations.");
            // iterate over each annotated field
            for (final FieldDeclaration fd : fieldCandidates) {
                modifiers = (IExtendedModifier[]) fd.modifiers().toArray(
                        new IExtendedModifier[fd.modifiers().size()]);
                int i = 0;
                // iterate over modifiers for the field
                for (final IExtendedModifier modifier : modifiers) {
                    // interested in Eclipse JDT's DOM form of Annotation
                    if (modifier instanceof org.eclipse.jdt.core.dom.Annotation) {
                        // construct the key-value pair
                        sb = new StringBuilder();
                        constraintName = ((org.eclipse.jdt.core.dom.Annotation) modifier).getTypeName().toString();
                        // Ignore @Valid annotations
                        if (!constraintName.equals(Valid.class.getSimpleName())) {
                            td = (AbstractTypeDeclaration) fd.getParent();
                            className = td.getName().toString();
                            fieldName = fd.fragments().get(0).toString();
                            // field may have an assignment, so strip it
                            if (fieldName.contains("=")) {
                                final int end = fieldName.indexOf("=");
                                fieldName = fieldName.substring(0, end).trim();
                            }
                            sb.append("{");
                            sb.append(constraintName);
                            sb.append(".");
                            sb.append(className);
                            sb.append(".");
                            sb.append(fieldName);
                            sb.append("}");
                            // construct new properties, and instead of
                            // updating
                            // the existing annotation, replace it
                            mvp = ast.newMemberValuePair();
                            mvp.setName(ast.newSimpleName("message"));
                            exp = ast.newStringLiteral();
                            ((StringLiteral) exp).setLiteralValue(sb.toString());
                            mvp.setValue(exp);
                            na = ast.newNormalAnnotation();
                            na.setTypeName(ast.newSimpleName(constraintName));
                            na.values().add(mvp);
                            // don't forget to add the original annotation's
                            // member-value pairs to the new annotation
                            if (modifier instanceof NormalAnnotation) {
                                final NormalAnnotation ona = (NormalAnnotation) modifier;
                                final List<?> values = ona.values();
                                for (int j = 0; j < values.size(); j++) {
                                    final MemberValuePair omvp = (MemberValuePair) values.get(j);
                                    mvp = ast.newMemberValuePair();
                                    mvp.setName(ast.newSimpleName(omvp.getName().toString()));
                                    // a value can be a String, Number or
                                    // reference to a constant
                                    switch (omvp.getValue().getNodeType()) {
                                        case ASTNode.NUMBER_LITERAL:
                                            mvp.setValue(ast.newNumberLiteral(omvp.getValue().toString()));
                                            break;
                                        case ASTNode.STRING_LITERAL:
                                            exp = ast.newStringLiteral();
                                            ((StringLiteral) exp).setLiteralValue(omvp.getValue().toString());
                                            mvp.setValue(exp);
                                            break;
                                        case ASTNode.QUALIFIED_NAME:
                                            final QualifiedName oqn = (QualifiedName) omvp.getValue();
                                            exp = ast.newQualifiedName(ast.newName(oqn.getQualifier().toString()),
                                                    ast.newSimpleName(oqn.getName().toString()));
                                            mvp.setValue(exp);
                                            break;
                                    }
                                    na.values().add(mvp);
                                }
                            }
                            fd.modifiers().remove(i);
                            fd.modifiers().add(i, na);
                            log.info("@" + constraintName + " on " + fieldName + " in " + className
                                    + " has been enriched with a 'message' attribute whose value is now '"
                                    + sb.toString() + "'.");
                        }
                        i++;
                    }
                }
            }
            contents = FileUtil.toString(source);
            document = new Document(contents);
            facade.saveUpdatesToFile(unit, document, source);
        }
    }
}

public static void main(String args[]) {
    final ConstraintMessageUtil util = new ConstraintMessageUtil();
    try {
        // e.g., on Windows,
        // "D:\\workspaces\\alstom-grid\\SPP-MUI\\spp-im-mui-dto\\src\\main\\java\\org\\spp\\im\\mui\\dto"
        util.process(args[0]);
    } catch (final Exception e) {
        e.printStackTrace();
    }
}
} 
```

实用**程序**：

```
import java.io.IOException;
import java.util.LinkedList;
import java.util.List;

import org.springframework.core.io.Resource;
import org.springframework.core.io.support.PathMatchingResourcePatternResolver;
import org.springframework.util.AntPathMatcher;

/**
 * Package utility. Provides handy methods for finding classes (of a particular
 * type) within a package on the classpath.
 * 
 * @author cphillipson
 * 
 * @param <T>
 *            types of classes to be found in package
 */
class PackageUtil<T> {

public List<Class<T>> listMatchingClasses(String matchPattern) throws IOException {
    final List<Class<T>> classes = new LinkedList<Class<T>>();
    final PathMatchingResourcePatternResolver scanner = new PathMatchingResourcePatternResolver();
    scanner.setPathMatcher(new AntPathMatcher());
    final Resource[] resources = scanner.getResources("classpath:" + matchPattern);
    for (final Resource resource : resources) {
        final Class<T> clazz = getClassFromResource(resource);
        classes.add(clazz);
    }
    return classes;
}

public Class<T> getClassFromResource(Resource resource) {
    Class<T> result = null;
    try {
        String resourceUri = resource.getURI().toString();
        resourceUri = resourceUri.substring(0, resourceUri.indexOf(".class")).replace("/", ".");
        if (resourceUri.contains("!")) { // class was found in an archive
            resourceUri = resourceUri.substring(resourceUri.indexOf("!") + 2);
        }
        // try printing the resourceUri before calling forName, to see if it
        // is OK.
        result = (Class<T>) Class.forName(resourceUri);
    } catch (final Exception ex) {
        ex.printStackTrace();
    }
    return result;
}
}

/**
* A collection of special-purposed methods for working with files and
* directories. Wraps Apache Commons I/O.
* 
* @author cphillipson
* 
*/
public class FileUtil {

public static Collection<File> getAllJavaSourceInDirectory(File directory, boolean recursive) {
    // scans directory (and sub-directories if recursive flag is true) for
    // .java files, returns a collection of files
    return FileUtils.listFiles(directory, new String[] { "java" }, recursive);
}

public static boolean isContentInFile(File file, String fragment) throws IOException {
    boolean result = false;
    final String contents = toString(file);
    if (contents.contains(fragment)) { // does file contain fragment?
        result = true;
    }
    return result;
}

public static String toString(File file) throws IOException {
    final String result = FileUtils.readFileToString(file, "utf8");
    return result;
}

public static void toFile(File file, String content) throws IOException {
    FileUtils.writeStringToFile(file, content, "utf8");
}
} 
```

**门面**：_

```
import java.io.File;
import java.io.IOException;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.eclipse.jdt.core.dom.AST;
import org.eclipse.jdt.core.dom.ASTNode;
import org.eclipse.jdt.core.dom.ASTParser;
import org.eclipse.jdt.core.dom.AbstractTypeDeclaration;
import org.eclipse.jdt.core.dom.Annotation;
import org.eclipse.jdt.core.dom.BodyDeclaration;
import org.eclipse.jdt.core.dom.CompilationUnit;
import org.eclipse.jdt.core.dom.FieldDeclaration;
import org.eclipse.jdt.core.dom.IExtendedModifier;
import org.eclipse.jface.text.BadLocationException;
import org.eclipse.jface.text.Document;
import org.eclipse.text.edits.MalformedTreeException;
import org.eclipse.text.edits.TextEdit;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.spp.im.mui.commons.util.FileUtil;

/**
 * Abstract syntax tree facade. Backed by Eclipse JDT, this facade provides a
 * number of conveniences, like the ability to:
 * <ul>
 * <li>generate an {@link CompilationUnit} from a source {@File}</li>
 * <li>save updates in a {@link Document} managed by {@link CompilationUnit} to
 * a {@link File}</li>
 * </ul>
 * and much more. Credit goes to <a href=
 * "http://svn.apache.org/repos/asf/openejb/branches/eclipse-plugins-1.0.0.alpha/plugins/org.apache.openejb.devtools.core/src/main/java/org/apache/openejb/devtools/core/JDTFacade.java"
 * >Apache OpenEJB DevTools JDTFacade source</a> for providing much of the
 * inspiration for this implementation.
 * 
 * @author cphillipson
 * @param <T>
 *            any annotation type
 * 
 */
 public class JDTFacade<T extends java.lang.annotation.Annotation> {

private static Logger log = LoggerFactory.getLogger(JDTFacade.class);

public CompilationUnit generateCompilationUnitForFile(File file) throws IOException {
    final String source = FileUtil.toString(file);
    final Document document = new Document(source);
    final ASTParser parser = ASTParser.newParser(AST.JLS4);
    parser.setSource(document.get().toCharArray());
    final CompilationUnit unit = (CompilationUnit) parser.createAST(null /* no ProgressMonitor */);
    unit.recordModifications();
    return unit;
}

public void saveUpdatesToFile(CompilationUnit unit, Document document, File file) throws MalformedTreeException,
        IOException, BadLocationException {
    final TextEdit edits = unit.rewrite(document, null /* no options */);
    edits.apply(document);
    boolean writeable = true; // should always be able to write to file...
    if (!file.canWrite()) { // .. but just in case we cannot...
        writeable = file.setWritable(true);
    }
    if (writeable) {
        FileUtil.toFile(file, document.get());
        log.info("Successfully wrote updates to " + file.getName());
    } else {
        log.warn("Unable to write to " + file.getName());
    }
}

public Set<FieldDeclaration> obtainAnnotatedFieldsFromClassInCompilationUnit(CompilationUnit unit,
        Set<Class<T>> annotationTypes) {
    final Set<FieldDeclaration> fields = new HashSet<FieldDeclaration>();
    final List<AbstractTypeDeclaration> types = unit.types();
    IExtendedModifier[] modifiers;
    for (final AbstractTypeDeclaration type : types) {
        if (type.getNodeType() == ASTNode.TYPE_DECLARATION) {
            // Class def found
            final List<BodyDeclaration> bodies = type.bodyDeclarations();
            for (final BodyDeclaration body : bodies) {
                if (body.getNodeType() == ASTNode.FIELD_DECLARATION) {
                    final FieldDeclaration field = (FieldDeclaration) body;
                    modifiers = (IExtendedModifier[]) field.modifiers().toArray(new IExtendedModifier[0]);
                    for (final IExtendedModifier modifier : modifiers) {
                        if (!(modifier instanceof Annotation)) {
                            continue;
                        }
                        final Annotation annotationModifer = (Annotation) modifier;
                        for (final Class<T> clazz : annotationTypes) {
                            if (annotationModifer.getTypeName().toString().equals(clazz.getCanonicalName())
                                    || annotationModifer.getTypeName().toString().equals(clazz.getSimpleName())) {
                                fields.add(field);
                                break;
                            }
                        }
                    }
                }
            }
        }
    }
    return fields;
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:03:55.190

您不能使用注释处理来修改您的代码。但是，您可以创建新类，这些新类可以对您拥有的类进行子类化，并且它们可以包含其他注释。

如果你想修改你的代码，你需要一个在编译时或加载时修改你的代码的库（例如作为一个特殊的类加载器）。

我不知道哪个库最适合您的情况，但[BCEL](https://commons.apache.org/bcel/)似乎能够胜任这项任务。

也可以看看：

*   [汇编](http://asm.ow2.org/)
*   [cglib](http://cglib.sourceforge.net/)
*   [方面J](https://en.wikipedia.org/wiki/AspectJ)
*   [使用 ASM 字节码工具包创建和读取 J2SE 5.0 注释](http://asm.ow2.org/doc/tutorial-annotations.html)
*   [编译后从字节码中删除注释](https://stackoverflow.com/questions/11092573/post-compilation-removal-of-annotations-from-byte-code)
*   [如何使用 Java 1.6 Annotation Processing 执行编译时编织？](https://stackoverflow.com/questions/2727710/how-do-you-use-java-1-6-annotation-processing-to-perform-compile-time-weaving)
*   [使用 AspectJ 将一个注释变成多个注释](https://stackoverflow.com/questions/5901690/turning-one-annotation-into-many-annotations-with-aspectj)

# rest - REST 可以用来“调用”业务对象上的操作吗？

> ID：11972302
> 
> 赞同：1
> 
> 时间：2012-08-15T15:27:59.433
> 
> 标签：rest

我有一个新项目即将推出，并且受到 REST 的启发。但是，它似乎有一个非常有限的界面。REST 是否支持特定于对象的交互，还是仅限于简单的 CRUD？

示例：学校管理应用具有学生对象。它应该能够：

```
RegisterNewStudent (some data) 
```

每个学生对象都应该处理业务操作：

```
Student.FixName(name data)
Student.ChangeSchool(school data)
Student.Graduate(classrank data)
Student.ChangePassword(password data) 
```

我一直在用消息队列实现 CQRS，其中每一个都将是一个单独的命令。但是，在 REST 中，我似乎仅限于：

```
PUT Student (all data about student)
POST Student/id (update student record with any/all fields changed)
DELETE Student/id 
```

我在这里错过了什么吗？在 RESTful 解决方案中将在哪里实现生命周期/状态更改逻辑？更改学生的学校注册涉及与更改她的姓名不同的逻辑（可能还有不同的权限）。我是否必须让客户发布任何/所有字段的“更新”，然后必须推断他们打算进行哪些操作？

//编辑：

这是我正在努力的事情吗：

```
PUT /Students {data about new student}
POST /Students/314/School {data about different school}
POST /Students/314/Name {data to fix name, ie add middle name}
POST /Students/314/Password {data for new password} 
```

ETC？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:31:08.943

> Q: Can REST be used to “call” operations on business objects?

A: Yes, absolutely yes.

Just as you can invoke any operation on any servlet with GET or PUT, you can also invoke any operation in a REST-ful web service.

Including, but not limited to, CRUD operations :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:43:51.487

你会想要创建几个 web 服务来做你想做的事，但是如果我以你的一个例子为例：

```
Student.ChangePassword(password data) 
```

并有一个 POST 请求`/ChangePassword/{student_id}/{password}`

那么你唯一的技巧就是确保谁可以调用这个函数。您是使用会话 cookie 来控制访问，还是让他们传入用户名/密码然后是新密码？

您会发现 POST 和 PUT 将很有用，因为它们没有记录在网络服务器日志文件中。

# web-services - 对于支持 CRUD 操作的 RESTful API，我应该有一个还是多个复杂类型？

> ID：11972309
> 
> 赞同：2
> 
> 时间：2012-08-15T15:28:17.697
> 
> 标签：web-services, rest, xsd, schema

我有一个支持对实体进行 CRUD 操作的 RESTful API。我应该有一个 xsd 文件来定义所有 CRUD 操作的架构吗？

我问这个问题的原因是，我有一些仅与检索调用相关而不与创建或更新相关的字段。在这种情况下，我应该有一个 xsd 文件并忽略一些用于创建和更新的字段吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:09:14.233

您的问题似乎将字段使用与 XSD 文件的数量联系在一起，这让我认为您可能缺少一些基本的 XSD 概念。

假设您的问题是，对于给定的实体，您可能会检索到比您可以更新的***更多的***字段；在虚拟`Person`实体上进行说明，您可以**R**（获取）`Name`、`Address`和属性，但要`Date of Birth`C **（**重新创建）实体，您只允许,和- 您希望后端系统设置属性。要求是尽可能约束XSD，以提高模型的自描述性。`Registered Since`**`Name``Address``Date of Birth``Registered Since`**

 **您可以通过创建 XSD 基本类型来实现这些场景的分离，然后使用另一种类型对其进行扩展，然后该类型将包含您想要的额外字段。您可以在单个文件或两个或多个不同文件中执行此类操作。

```
<?xml version="1.0" encoding="utf-8" ?>
<!--XML Schema generated by QTAssistant/XML Schema Refactoring (XSR) Module (http://www.paschidev.com)-->
<xsd:schema targetNamespace="http://tempuri.org/XMLSchema.xsd" elementFormDefault="qualified" xmlns="http://tempuri.org/XMLSchema.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema">

    <xsd:complexType name="PersonBase">
        <xsd:sequence>
            <xsd:element name="Name"/>
            <xsd:element name="Address"/>
            <xsd:element name="DateOfBirth"/>
        </xsd:sequence>
    </xsd:complexType>

    <xsd:complexType name="PersonToRetrieve">
        <xsd:complexContent>
            <xsd:extension base="PersonBase">
                <xsd:sequence>
                    <xsd:element name="RegisteredSince"/>
                </xsd:sequence>
            </xsd:extension>
        </xsd:complexContent>
    </xsd:complexType>
</xsd:schema> 
```

**注意：上面的 XSD 并不是为了说明 XSD 最佳实践**

如果您的环境中不允许扩展/限制，您可以通过以下方式实现重用`xsd:group`- 它不会改变我的观点。所以，我基本上是说你问这个问题的原因 -*`I have some fields that are relevant only for Retrieve calls and not for Create or Update.`*与 XSD 文件的数量没有任何关系......除非你考虑更多的变量。我会尝试一些我想到的，但我不会提供详尽的清单：

*   **复杂性**：如果您要解决的问题很简单，那么请尽量使解决方案保持简单。如上所示，您仍然可以使用一个 XSD 文件解决您的“描述性”问题。如果您将工具视为问题空间的一部分，那么许多工具都存在 XSD 之间复杂关系的问题……有时甚至不支持 xsd:include，命令行变得更加复杂。
*   **XML 命名空间**：如果您像我或许多其他人一样希望将描述您的业务域的构造与支持您的 API 定义和消息传递的构造分开，那么使用不同的 XML 命名空间是一种常见的解决方案。您需要[至少](http://paschidev.com/Whitepapers/HowManyXSDs.html)与您决定使用的 XML 名称空间一样多的不同 XSD 文件。这将驱使您拥有多个 XSD 文件。
*   **可重用内容**：XSD 内容可以通过多种方式重用。如果您希望在许多项目/接口中强制实施一个基本类型系统，那么一个好的做法是将它们编写到一个或多个单独的 XSD 文件中，然后通过其他更具体的 XSD 包含/导入它们。
*   **XML Schema Refactoring**：如果您处于人们使用自动重构的环境中，答案将是：**谁在乎？**我第一手知道新手觉得这个答案很自命不凡。然而，在具有复杂系统的现实生活中，由于个人偏好（代码/模型审查等）和/或具有不同支持级别的各种工具/平台，您的问题的某些解决方案实际上很难处理， XSD 到代码包括在内，XSD 重构**很**可能是保持事情顺利运行的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T22:17:46.767

如果您对不同的调用有不同的字段，那么是的，您应该使用不同的 XSD 文件，但是如果您只根据 CRUD 操作将某些字段留空，那么您不需要创建不同的文件。未使用的字段将在那里，但它们将留空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T13:45:53.637

根据操作，它可能会以下列方式之一处理字段：

*   **必需**- 必须提供且有效。
*   **可选**- 此字段仅在提供且有效时使用。
*   **已忽略**- 服务器忽略此字段。例如，对于 create Customer 操作，ID 和 createdOn 字段不能由客户端设置，被服务器忽略。

对于简单的情况，我将使用单个模式元素来定义实体。我将解决文档中字段的实际用法。

当不同操作对实体的使用存在巨大差异时，单独的实体可能是合适的。例如，管理员的检索客户操作可能会返回比普通用户可用的更多的有关客户的信息。如果这种差异很大，那么定义单独的实体对每个人来说都会更容易。您可以使用模式扩展来扩展基本实体，或者简单地从基本实体复制和粘贴字段，无论在您的环境中是否有效。

PS。大多数 Web 服务堆栈，至少在 JAX-RS 和 JAX-WS 中，默认情况下不强制执行模式合规性。检查 Web 服务代码中字段的有效性是一个好主意。**

# apache - Apache htaccess to rewrite up one directory level

> ID：11972311
> 
> 赞同：2
> 
> 时间：2012-08-15T15:28:26.373
> 
> 标签：apache, .htaccess, mod-rewrite

I've seen this asked before and people provide answers, but none of them seem to work. I'm trying to rewrite the URL so any request to /whatever show as /. I don't want the location of the files to change, just the URL. For example, if someone types in:

```
Http://www.mysite.com/whatever ( the files are located at /docroot/whatever )
I want the URL to show http://www.mysite.com/ 
```

In my htaccess ( placed in /docroot , not /docroot/whatever ) I'm currently using:

```
RewriteEngine on
RewriteRule   ^whatever/(.+)$   /$1 [L] 
```

What's happening is the URL is staying , but the server is looking for the files /docroot .

That's the opposite of what I need, I need the URL to be , with the server looking for the files in /docroot/whatever .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:12:00.970

我认为你有它倒退。

*   如果您希望将根 URI 映射到 DOCROOT/whatever，那么您需要在 Apache 中进行内部重定向。
*   如果您收到外部请求`http://www.mysite.com/whatever`并希望客户端使用根 URI，那么您需要执行外部 (301) 重定向。
*   您还需要确保不会陷入无限循环。

以下几行将为您执行此操作：

```
RewriteEngine On
RewriteBase   /

RewriteCond   %{ENV:REDIRECT_END}  !^1 
RewriteRule   ^whatever/(.+)$  $1               [R=301,L]

RewriteCond   %{REQUEST_URI}   !^/whatever
RewriteRule   ^(.+)$           whatever/$1      [E=END:1,L] 
```

在第二条规则中，将`E=END:1`环境变量 END 设置为 1，并且在内部重定向之后，它变成了 REDIRECT_END。第一个条件停止，例如 /fred -> /whatever/fred -> (301) /fred - 这将导致浏览器出错。

也从 302s 开始，当你有规则工作时切换到 301s - 因为客户端浏览器将缓存 301s，这使得调试这些规则成为一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:34:35.130

尝试将其放入文档根目录的 htaccess 文件中：

```
RewriteEngine On

# change the browser's URL address bar
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /whatever($|\ )
RewriteRule ^whatever / [L,R=301]

# internally rewrite / back to whatever
RewriteRule ^$ /whatever [L] 
```

# facebook - Facebook Most Mutual Friends

> ID：11972313
> 
> 赞同：0
> 
> 时间：2012-08-15T15:28:32.063
> 
> 标签：facebook, facebook-fql

I am trying to find the friends with most mutual friends with me.

```
public function topThreeMutualFriends() {
    $count;
    $query='select uid1 from friend where uid1 in (select uid2 from friend where uid1=me()) and uid2 in (Select uid2 from friend where uid1=me()) and uid1!=uid2';
    $result = $this->api(array('query' => $query , 'method' => 'fql.query'));
    if(!$result)
        throw new exception("No Mutual Friends");
    else{
        foreach ($result as $uid)
            $count[$uid['uid1']]++;
        arsort($count, SORT_NUMERIC);
        $i=0;
        foreach($count as $key=>$uid){
            $topthree[$i++]=$key;
            if($i==3)break;
        }
    return array($topthree,$count);}
    } 
```

In the above code an exception is raised stating:"This API call could not be completed due to resource limits" I tried giving all the permissions, and the query works fine in the fql tester. What could be the possible reason??

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:38:22.810

这是相当复杂的代码。为什么不让 FQL 找到您的前三位朋友和最多的共同朋友呢？

```
$query = 'SELECT uid, name, mutual_friend_count 
          FROM user WHERE uid IN 
            (SELECT uid1 FROM friend WHERE uid2 = me()) 
          ORDER BY mutual_friend_count DESC LIMIT 3'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:38:11.143

可能的原因是您粘贴的错误消息，就 Facebook 方面所需的资源而言，您的查询过于昂贵。

将其分解为较小的查询并改为这样做。例如，在一次调用中获取朋友列表，将列表拆分为更小的块，并在单独的调用中检查批次的共同朋友计数。

# php - Symfony2 与 CSRF 令牌链接

> ID：11972318
> 
> 赞同：1
> 
> 时间：2012-08-15T15:28:38.753
> 
> 标签：php, symfony

我找不到有关如何使用 CSRF 令牌生成链接的文档，例如 Symfony 1.4：

```
link_to(__('Delete'), url_for('ntw-delete', $network), array('confirm' => 'Are you sure?', 'method' => 'delete')) 
```

**更新：**我为此创建了一个树枝扩展。也许它会对某人有所帮助

`src/UmbrellaWeb/Bundle/ExtraTwigBundle/Twig/LinkExtension.php`

```
<?php
namespace UmbrellaWeb\Bundle\ExtraTwigBundle\Twig;

use Twig_Extension;
use Twig_Function_Method;
use Twig_Environment;
use Symfony\Component\Form\Extension\Csrf\CsrfProvider\CsrfProviderInterface;

class LinkExtension extends Twig_Extension
{
    protected $csrfProvider;

    public function __construct(CsrfProviderInterface $csrfProvider)
    {
        $this->csrfProvider = $csrfProvider;
    }

    public function getFunctions()
    {
        return array(
            'link_to' => new Twig_Function_Method($this, 'linkToFunction', array(
                'is_safe' => array('html')
            ))
        );
    }

    /**
     * Build a link with anchor
     * 
     * @param string $path
     * @param string $title
     * @param array $options Available options: 
     *  string 'confirm' - Text for the popup
     *  string 'method' - HTTP Method: post, delete, put
     *  string 'csrfIntention' - CSRF intention. If empty then no CSRF. Not used for GET requests
     *  string 'csrfField' - CSRF field name. _token by default
     *  bool 'escape' - escape title, TRUE by default
     */
    public function linkToFunction($path,$title,array $options = array())
    {
        $default = array(
            'csrf_intention' => '',
            'csrf_field' => '_token',
            'escape' => TRUE
        );

        $options = array_merge($default,$options);

        $ecape = $options['escape'];
        unset($options['escape']);

        $return = '<a href="%s"%s>%s</a>';

        $return = sprintf($return,
            htmlspecialchars($path),
            $this->_tagOptions($this->_options2javascript($options)),
            ($ecape)?htmlspecialchars($title):$title
        );

        return $return;
    }

    function _options2javascript($options)
    {
        // confirm
        $confirm = isset($options['confirm']) ? $options['confirm'] : '';

        unset($options['confirm']);

        // method
        $method = isset($options['method']) ? $options['method'] : false;

        unset($options['method']);

        // CSRF Intention
        $csrfIntention = isset($options['csrf_intention']) ? $options['csrf_intention'] : false;

        unset($options['csrf_intention']);

        // CSRF field name
        $csrfField = isset($options['csrf_field']) ? $options['csrf_field'] : false;

        unset($options['csrf_field']);

        $onclick = isset($options['onclick']) ? $options['onclick'] : '';

        if ($confirm && $method)
        {
            $options['onclick'] = $onclick . 'if (' . $this->_confirmJsFunction($confirm) . ') { ' . $this->_methodJsFunction($method,$csrfIntention,$csrfField) . ' };return false;';
        } else 
            if ($confirm)
            {
                if ($onclick)
                {
                    $options['onclick'] = 'if (' . $this->_confirmJsFunction($confirm) . ') { return ' . $onclick . '} else return false;';
                } else
                {
                    $options['onclick'] = 'return ' . $this->_confirmJsFunction($confirm) . ';';
                }
            } else 
                if ($method)
                {
                    $options['onclick'] = $onclick . $this->_methodJsFunction($method,$csrfIntention,$csrfField) . 'return false;';
                }

        return $options;
    }

    function _confirmJsFunction($confirm)
    {
      return "confirm('".$this->_escapeJs($confirm)."')";
    }

    /**
     * Escape carrier returns and single and double quotes for Javascript segments.
     */
    function _escapeJs($javascript = '')
    {
        $javascript = preg_replace('/\r\n|\n|\r/', "\\n", $javascript);
        $javascript = preg_replace('/(["\'])/', '\\\\\1', $javascript);
        return $javascript;
    }

    function _methodJsFunction($method,$csrfIntention,$csrfField)
    {
        $function = "var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'post'; f.action = this.href;";

        //put, delete HTTP methods
        if ('post' != strtolower($method))
        {
            $function .= "var m = document.createElement('input'); m.setAttribute('type', 'hidden'); ";
            $function .= sprintf("m.setAttribute('name', '_method'); m.setAttribute('value', '%s'); f.appendChild(m);", strtolower($method));
        }

        // CSRF protection
        if ($csrfIntention)
        {
            /**
             * @todo isCsrfEnabled() - check a global config
             */
            if (TRUE)
            {
                $function .= "var m = document.createElement('input'); m.setAttribute('type', 'hidden'); ";
                $function .= sprintf("m.setAttribute('name', '%s'); m.setAttribute('value', '%s'); f.appendChild(m);", $csrfField, $this->csrfProvider->generateCsrfToken($csrfIntention));
            }
        }

        $function .= "f.submit();";
        return $function;
    }

    function _tagOptions(array $options = array())
    {
        $html = '';
        foreach ($options as $key => $value)
        {
            $html .= ' ' . $key . '="' . htmlspecialchars($value) . '"';
        }
        return $html;
    }

    public function getName()
    {
        return 'umbrellaweb_link';
    }
} 
```

`services.xml`

```
<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <service id="umbrellaweb.twig.link_extension" class="UmbrellaWeb\Bundle\ExtraTwigBundle\Twig\LinkExtension">
            <tag name="twig.extension" />
            <argument type="service" id="form.csrf_provider" />
        </service>
    </services>
</container> 
```

现在在树枝中你可以使用：

```
{{ link_to(path('jk_aa_admin_delete',{'id' : admin.id}),'<img src="del_icon.png"/>',
{'escape':false,'method':'delete','csrf_intention':'delete-admin',
'confirm':'Are you sure?'}) }} 
```

我控制器：

```
//check CSRF token
if (FALSE === $this->get('form.csrf_provider')->isCsrfTokenValid('delete-admin', $request->get('_token')))
{
throw new AccessDeniedHttpException('Invalid CSRF token.');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-12-31T16:37:55.520

**Symfony 4**的解决方案，来自[http://symfony.com/doc/current/security/csrf.html](http://symfony.com/doc/current/security/csrf.html)的文档：

树枝模板：

```
<a href="{{ path("remove", { "id" : 1, "csrf_token" : csrf_token('remove') }) }}">
{{ "remove" | trans }}
</a> 
```

控制器：

```
/**
 * @Route("/remove/{id}", name="dashboard_alert_remove")
 *
 * @ParamConverter("alert", class="App:Alert")
 *
 * @param Alert $alert
 */
public function doRemoveAction(Alert $alert, Request $request)
{
    $submittedToken = $request->get('csrf_token');

    if ($this->isCsrfTokenValid('remove', $submittedToken))
    {
        // Do the deletion stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T14:02:04.423

我有同样的问题。首先，我在 Controller 中生成令牌并传递给一个 twig 文件

```
 $intentions = 'unknown';  
 $csrfToken = $this->container->get('form.csrf_provider')->generateCsrfToken($intentions);

 return array('csrfToken'=>$csrfToken); 
```

比从树枝文件中您可以访问令牌为

```
var token = '{{csrfToken}}' 
```

# assembly - 将 MIPS 转换为机器码

> ID：11972320
> 
> 赞同：0
> 
> 时间：2012-08-15T15:28:45.967
> 
> 标签：assembly, mips, machine-code, nios

```
 .text
    .align 2
    .global main
    .equ val,0x4712         # 16-bit binary code for 0x4712: 0100 0111 0001 0010
                            # Program code starts now
main:                          
        movi r16,val
        movi r17,0
loop:   addi r17,r17,1
        subi r16,r16,1 
        bne  r16,r0,loop
stop:   br   stop 
```

我应该如何将上述内容翻译成机器代码？除了实际代码之外，我还需要知道如何进行翻译。我想我可以尝试获取指令的操作码，但 movi 是伪指令，我不知道在哪里可以得到它。我应该在 Nios II 手册中阅读它吗？

## 更新

前四个指令是立即类型，因此应该使用字段形式。movi 和 subi 都是在 addi 中实现的伪指令，因此将使用 addi 的操作码。我得到了帮助，我知道该指令`movi r16, val`将转化为

`00000100000100011100010010000100`

所以操作码是 000100 二进制，即 0x04 以十六进制为基数，手册还指出是 addi 的操作码。所以我认为我们有前四个操作码，它们都是 000100。

## 更新 2

我想我现在知道大多数指令的操作码和直接字段：

序列 0100011100010010 是 0x4712，它是用`val`声明的变量`.equ,` 所以前四个操作码应该是 000100，因为它们都是 addi 并且 addi 说它是 0x04。如何翻译我现在不知道但可以查看手册的寄存器的两个五位字段。它说'br bne'`has opcode 0x06 so it should say 000110 in the opcode for br.`有opkod 0x1E，二进制是011110 = 30（？）

这是一个正确的开始吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:40:36.683

首先，您为什么不至少尝试使用汇编程序来查看产生了什么？

您需要阅读 mips 指令集参考才能看到真正的 mips 指令，这些参考中通常描述了伪指令。就 movi 而言， load upper 对于控制高位有点明显，而 and or or or or 是设置低位的明显方法。如果该值是一个小数字，那么您只需要 and 或 or 并使用 r0 作为操作数之一（将高位归零）。

mips 中这些伪指令的问题在于，您必须小心不要在分支影子中使用伪指令（除非它转换为单个指令）。我建议先不使用任何伪指令学习汇编语言，然后再让你的生活更轻松，一旦你理解了指令集和规则，然后使用伪指令使代码更具可读性或可维护性等。我个人倾向于坚持纯指令，提供一对一的体验（asm 指令到机器指令）。

# c# - Benchmarking library usable from C#

> ID：11972329
> 
> 赞同：7
> 
> 时间：2012-08-15T15:29:26.467
> 
> 标签：c#, windows, benchmarking

I am wanting to conduct benchmark tests on a couple of servers that I manage and would like to be able to set up my own scenarios and order of events/ automation.

So I'm wondering if there are any libraries that can be used to perform benchmarking of different aspects of a windows computer such as CPU, Disk IO, and RAM.

**Update 1**: Since there seems to be no available libraries for doing this I'll also accept answers pointing to examples or guides of how one can test CPU, Disk and Memory performance with C#.

**Update 2** are there any good libraries for this in any language?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-16T21:53:24.090

您可以使用这个开源框架[BenchmarkDotNet](https://github.com/AndreyAkinshin/BenchmarkDotNet)进行 CPU 基准测试。它包括秒表使用、GC 预调用、预热、设置进程优先级、thred、ProcessorAffinity-mask、用于基准竞赛的 api 和带有结果的漂亮控制台输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:54:43.647

这可能超出了范围，但是我在单元测试级别寻找类似的东西，并找到[了这个关于创建和编辑负载测试的 MSDN 主题](http://msdn.microsoft.com/en-us/library/dd728098%28v=vs.100%29.aspx)。

# javascript - "google.maps.MapTypeId is undefined" when using GMAP3 in FF 14

> ID：11972331
> 
> 赞同：3
> 
> 时间：2012-08-15T15:29:40.467
> 
> 标签：javascript, firefox, google-chrome, jquery-gmap3

Testing the sample code from gmap3:

```
<html>    
  <head> 
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>        
    <script src="http://maps.google.com/maps/api/js?sensor=false&language=zh" type="text/javascript"></script>
    <script type="text/javascript" src="js/gmap3.js"></script> 
    <style>
      .gmap3{
        margin: 20px auto;
        border: 1px dashed #C0C0C0;
        width: 500px;
        height: 250px;
      }
    </style>
    <script type="text/javascript">
      $(function(){
        try{
            $('#geoTestDiv').gmap3(
              { action: 'addMarker',
                latLng : [46.578498,2.457275],
                map:{
                  center: true,
                  zoom: 14,
                  mapTypeId: google.maps.MapTypeId.TERRAIN
                }
              }
              );
        }catch(exception){
            alert(exception);
        }
      });
    </script>
  <body>
    <div id="geoTestDiv" class="gmap3"></div>
  </body>
</html> 
```

on FF 14.0.1, it gives the alert:

> TypeError: google.maps.MapTypeId is undefined

on Chrome 16.0.889.0, a div with image shows up.

Why is there such a difference?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-26T08:12:17.170

您可以尝试命名初始化地图的函数，然后将其作为回调放在加载 Google Maps api 的链接中。

像这样的东西：

```
<script src="http://maps.google.com/maps/api/js?sensor=false&language=zh&callback=initMainMap" type="text/javascript"></script>

<script type="text/javascript">
   function initMainMap(){
      //function body
   }
</script> 
```

来自这里的原始答案：[Google Maps API v3 - TypeError ... https://stackoverflow.com/a/8361021/1266136](https://stackoverflow.com/a/8361021/1266136)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T11:07:58.320

可能有点晚了，但对我来说它有助于添加这一行：

```
var myLatlng = new google.maps.LatLng(0.0, 0.0); 
```

在你打电话之前`mapTypeId: google.maps.MapTypeId.TERRAIN`

像这样：

```
 var myLatlng = new google.maps.LatLng(0.0, 0.0); // this will somehow initialize google.maps...
 $('#geoTestDiv').gmap3(
              { action: 'addMarker',
                latLng : [46.578498,2.457275],
                map:{
                  center: true,
                  zoom: 14,
                  mapTypeId: google.maps.MapTypeId.TERRAIN
                }
              }
              ); 
```

# c# - System.Collections.Generic.KeyNotFoundException：给定的键不在字典中

> ID：11972337
> 
> 赞同：6
> 
> 时间：2012-08-15T15:29:56.270
> 
> 标签：c#, linq-to-sql, linq-to-xml, idictionary

对方法执行单元测试时收到上述错误消息。我知道问题出在哪里，我只是不知道为什么它没有出现在字典中。

这是字典：

```
var nmDict = xelem.Descendants(plantNS + "Month").ToDictionary(
    k => new Tuple<int, int, string>(int.Parse(k.Ancestors(plantNS + "Year").First().Attribute("Year").Value), Int32.Parse(k.Attribute("Month1").Value), k.Ancestors(plantNS + "Report").First().Attribute("Location").Value.ToString()),
    v => { 
             var detail = v.Descendants(plantNS + "Details").First();
             return new HoursContainer
             {
                 BaseHours = detail.Attribute("BaseHours").Value,
                 OvertimeHours = detail.Attribute("OvertimeHours").Value,
                 TotalHours = float.Parse(detail.Attribute("BaseHours").Value) + float.Parse(detail.Attribute("OvertimeHours").Value)
             };
         });

var mergedDict = new Dictionary<Tuple<int, int, string>, HoursContainer>();

foreach (var item in nmDict)
{
    mergedDict.Add(Tuple.Create(item.Key.Item1, item.Key.Item2, "NM"), item.Value);
}

var thDict = xelem.Descendants(plantNS + "Month").ToDictionary(
    k => new Tuple<int, int, string>(int.Parse(k.Ancestors(plantNS + "Year").First().Attribute("Year").Value), Int32.Parse(k.Attribute("Month1").Value), k.Ancestors(plantNS + "Report").First().Attribute("Location").Value.ToString()),
    v => {
             var detail = v.Descendants(plantNS + "Details").First();
             return new HoursContainer
             {
                 BaseHours = detail.Attribute("BaseHours").Value,
                 OvertimeHours = detail.Attribute("OvertimeHours").Value,
                 TotalHours = float.Parse(detail.Attribute("BaseHours").Value) + float.Parse(detail.Attribute("OvertimeHours").Value)
             };
         });

foreach (var item in thDict)
{
    mergedDict.Add(Tuple.Create(item.Key.Item1, item.Key.Item2, "TH"), item.Value);
}
        return mergedDict; 
```

}

这是正在测试的方法：

```
protected IList<DataResults> QueryData(HarvestTargetTimeRangeUTC ranges,
        IDictionary<Tuple<int, int, string>, HoursContainer> mergedDict)
{            
    var startDate = new DateTime(ranges.StartTimeUTC.Year, ranges.StartTimeUTC.Month, 1);
    var endDate = new DateTime(ranges.EndTimeUTC.Year, ranges.EndTimeUTC.Month, 1);
    const string IndicatorName = "{6B5B57F6-A9FC-48AB-BA4C-9AB5A16F3745}";

    DataResults endItem = new DataResults();
    List<DataResults> ListOfResults = new List<DataResults>();                               

    var allData =

    (from vi in context.vDimIncidents
    where vi.IncidentDate >= startDate.AddYears(-3) && vi.IncidentDate <= endDate
        select new
        {
            vi.IncidentDate,
            LocationName = vi.LocationCode,
            GroupingName = vi.Location,
            vi.ThisIncidentIs, vi.Location
        });

    var finalResults = 

            (from a in allData
            group a by new { a.IncidentDate.Year, a.IncidentDate.Month, a.LocationName, a.GroupingName, a.ThisIncidentIs, a.Location }
                into groupItem
            select new 
            {
                Year = String.Format("{0}", groupItem.Key.Year),
                Month = String.Format("{0:00}", groupItem.Key.Month),
                groupItem.Key.LocationName,
                GroupingName = groupItem.Key.GroupingName,
                Numerator = groupItem.Count(),
                Denominator = mergedDict[Tuple.Create(groupItem.Key.Year, groupItem.Key.Month, groupItem.Key.LocationName)].TotalHours,  
                IndicatorName = IndicatorName,                        
            }).ToList();

    for (int counter = 0; counter < finalResults.Count; counter++)
    {
        var item = finalResults[counter];
        endItem = new DataResults();
        ListOfResults.Add(endItem);
        endItem.IndicatorName = item.IndicatorName;
        endItem.LocationName = item.LocationName;
        endItem.Year = item.Year;
        endItem.Month = item.Month;
        endItem.GroupingName = item.GroupingName;
        endItem.Numerator = item.Numerator;
        endItem.Denominator = item.Denominator;               
    }

    foreach(var item in mergedDict)
    {
        if(!ListOfResults.Exists(l=> l.Year == item.Key.Item1.ToString() && l.Month == item.Key.Item2.ToString()
                && l.LocationName == item.Key.Item3))
        {
            for (int counter = 0; counter < finalResults.Count; counter++)
            {
                var data = finalResults[counter];
                endItem = new DataResults();
                ListOfResults.Add(endItem);
                endItem.IndicatorName = data.IndicatorName; 
                endItem.LocationName = item.Key.Item3;
                endItem.Year = item.Key.Item1.ToString();
                endItem.Month = item.Key.Item2.ToString();
                endItem.GroupingName = data.GroupingName; 
                endItem.Numerator = 0;
                endItem.Denominator = item.Value.TotalHours;
            }
        }
    }
    return ListOfResults;
} 
```

错误发生在这里：

```
 Denominator = mergedDict[Tuple.Create(groupItem.Key.Year, groupItem.Key.Month, groupItem.Key.LocationName)].TotalHours, 
```

我不明白为什么它不存在于密钥中。密钥包含一个 int、int、string（年、月、位置），这就是我分配给它的。

我查看了有关此错误消息的所有其他线程，但没有看到任何适用于我的情况的内容。

我不确定要在上面放什么标签，但据我了解，字典是用 linq to xml 创建的，查询是 linq to sql，它都是 C# 的一部分，所以我使用了所有标签。如果这是不正确的，那么我提前道歉。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T15:55:29.107

问题在于您存储在 中`Dictionary`的密钥与您尝试查找的密钥之间的比较。

当您向 a 添加内容`Dictionary`或访问 a 的索引器时，`Dictionary`它使用该`GetHashCode()`方法获取键的哈希值。a 的哈希码对于 的`Tuple`该实例是唯一的`Tuple`。这意味着除非您将完全相同的`Tuple`类实例传递给索引器，否则它将找不到先前存储的值。您的使用`mergedDict[Tuple.Create(...`创建了一个全新的元组，其哈希码与存储在`Dictionary`.

我建议创建您自己的类以用作该类的键并实现`GetHashCode()`和 Equality 方法。这样，词典将能够找到您之前存储在那里的内容。

更多：这让很多人感到困惑的原因是，对于类似`String`or的东西`Int32`，`String.GetHashCode()`将为具有相同值的两个不同实例返回相同的哈希码。更专业的课程，例如`Tuple`并不总是一样的。的实现者`Tuple`可以得到每个输入的哈希码`Tuple`并将它们加在一起（或其他东西），但是通过反编译器运行 Tuple 你可以看到情况并非如此。

# scala - 如何访问 Scala REPL 中的最后一个结果？

> ID：11972339
> 
> 赞同：18
> 
> 时间：2012-08-15T15:30:17.080
> 
> 标签：scala, clojure, read-eval-print-loop

在 python REPL 中，我可以执行以下操作：

```
>>> [1,2,3,4]
[1, 2, 3, 4]
>>> sum(_)
10 
```

在 clojure REPL 我可以这样做：

```
user=> "Hello!"
"Hello!"

user=> *1
"Hello!" 
```

Scala REPL 中有这样的东西吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-15T15:30:17.080

是的，您可以使用点表示法来引用最后一个结果：

```
scala> List(1,2,3,4)
res0: List[Int] = List(1, 2, 3, 4)

scala> .sum
res1: Int = 10 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-15T18:27:52.537

对于 some ，您可以参考之前的输出。您可能已经注意到，在 Scala REPL 中，结果以以下形式打印：`res*N*``*N*``res*N*: *Type* = *value*`

```
Welcome to Scala version 2.9.1.final (Java HotSpot(TM) 64-Bit Server VM, Java 1.6.0_24).
Type in expressions to have them evaluated.
Type :help for more information.

scala> List(1,2,3,4)
res0: List[Int] = List(1, 2, 3, 4)

scala> "Hello!"
res1: java.lang.String = Hello! 
```

嗯，这是一个真正的变量名。在此示例中，只要 REPL 处于打开状态，您就可以引用列表 as和字符串 as （至少据我所知）：`res*N*``res0``res1`

```
scala> (res0.toString + res1) toLowerCase
res2: java.lang.String = list(1, 2, 3, 4)hello! 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T22:50:46.440

我通常只是打`↑</kbd> key to bring back the last line of code and carry on typing. This has the advantage of keeping the whole expression together for easy cutting-and-pasting or editing later.`

# c# - get comments in .xlsm files properties in c#

> ID：11972349
> 
> 赞同：1
> 
> 时间：2012-08-15T15:30:43.760
> 
> 标签：c#, c#-4.0, shell32.dll

Is there any way to get comments from .xlsm files using Shell32.dll?

This is code I am using

```
 public string getFileCommentsProperty(string FileName)
    {

            string file_version="";

            Shell32.Shell shell = new Shell32.Shell();

            Shell32.Folder objFolder;

            objFolder = shell.NameSpace(System.IO.Path.GetDirectoryName(FileName));

            foreach (Shell32.FolderItem2 item in objFolder.Items())
            {

                if (System.IO.Path.GetFileNameWithoutExtension(FileName).ToString() == System.IO.Path.GetFileNameWithoutExtension(objFolder.GetDetailsOf(item, 0).ToString()))
                { 

                    file_version = objFolder.GetDetailsOf(item, 24).ToString();
                    break;
                }
            }

            return file_version;                    
        } 
```

This code works if I create a standalone console application but if use this in a web application it just returns blank.I used the Microsoft Shell and Automation reference from the com components Tab.Has anyone come across this issue?

# sql - Crosstab multi columns

> ID：11972350
> 
> 赞同：2
> 
> 时间：2012-08-15T15:30:48.063
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

Hello I have a problem with SQL in SQL Server 2005.

Suppose that I have a table called myTable with data as below:

```
|   NAME | CREDIT | GRADE | YEAR | SEMESTER |
---------------------------------------------
|  Name1 |      1 |     A |    1 |        1 |
|  Name2 |      4 |     B |    1 |        1 |
|  Name3 |      2 |     E |    1 |        1 |
|  Name4 |      7 |     F |    1 |        1 |
|  Name5 |      4 |     A |    1 |        2 |
|  Name6 |      3 |     C |    1 |        2 |
|  Name7 |      6 |     D |    1 |        2 |
|  Name8 |      1 |     A |    1 |        2 |
|  Name9 |      1 |     A |    1 |        2 |
| Name10 |      1 |     A |    1 |        2 |
| Name11 |      3 |     C |    2 |        1 |
| Name12 |      6 |     E |    2 |        1 |
| Name13 |      4 |     C |    2 |        1 |
| Name14 |      2 |     B |    2 |        2 |
| Name15 |      1 |     A |    2 |        2 |
| Name16 |      1 |     A |    2 |        2 |
| Name17 |      1 |     A |    2 |        2 |
| Name18 |      5 |     D |    3 |        1 |
| Name19 |      1 |     A |    3 |        1 |
| Name20 |      1 |     A |    3 |        1 |
| Name18 |      5 |     D |    3 |        2 |
| Name19 |      1 |     A |    3 |        2 |
| Name20 |      1 |     A |    3 |        2 | 
```

I want to output the result as below:

```
|  NAM1 | CRDT1 | GRD1 | YEAR1 | SEMER1 | NAM2 | CRDT2 | GRD2 | YEAR2 | SEMES2 |
   -----------------------------------------------------------------------------
|  Name1|     1 |    A |     1 |      1 |Name5 |     4 |    A |     1 |      2 |
|  Name2|     4 |    B |     1 |      1 |Name6 |     3 |    C |     1 |      2 |
|  Name3|     2 |    E |     1 |      1 |Name7 |     6 |    D |     1 |      2 |
|  Name4|     7 |    F |     1 |      1 |Name8 |     1 |    A |     1 |      2 |
                                        |Name9 |     1 |    A |     1 |      2 |
                                        |Name10|     1 |    A |     1 |      2 |
| Name11|    3 |     C |     2 |      1 |Name14|     2 |    B |     2 |      2 |
| Name12|    6 |     E |     2 |      1 |Name15|     1 |    A |     2 |      2 |
| Name13|    4 |     C |     2 |      1 |Name16|     1 |    A |     2 |      2 |
                                        |Name17|     1 |    A |     2 |      2 | 
| Name18|    5 |     D |     3 |      1 |Name18|     5 |    D |     3 |      2 |
| Name19|    1 |     A |     3 |      1 |Name19|     1 |    A |     3 |      2 |
| Name20|    1 |     A |     3 |      1 |Name20|     1 |    A |     3 |      2 | 
```

Where

```
- Nam1= Name in Semester 1
- CRDT1= Credit in Semester 1
- GRD1= Grade in Semester 1
- Year1= Year in Semester 1 
- Semer1 = Semester in Semester 1

- Nam2= Name in Semester 2
- CRDT2= Credit in Semester 2
- GRD2= Grade in Semester 2
- Year2= Year in Semester 2 
- Semer2 = Semester in Semester 2 
```

Please go to this URL to test this SQL: [http://sqlfiddle.com/#!3/196c6/1](http://sqlfiddle.com/#!3/196c6/1)

How Can I create SQL to make output like this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:48:03.303

```
select
    s1.Name as nam1, s1.credit as crdt1, s1.Year as year1, s1.semester as semer1,
    s2.Name as nam2, s2.credit as crdt2, s2.Year as year2, s2.semester as semer2
from 
(select *, ROW_NUMBER() over (partition by year order by name) rn from myTable where semester=1 ) s1
    full outer join
(select *, ROW_NUMBER() over (partition by year order by name) rn from myTable where semester=2 ) s2
    on s1.year = s2.year
    and s1.rn = s2.rn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:28:31.037

当一个简单的 group by 就足够时，我不喜欢进行外部联接：

```
select max(case when semester = 1 then Name end) as name1,
       max(case when semester = 1 then credit end) as credit1,
       max(case when semester = 1 then year end) as year1,
       max(case when semester = 1 then semester end) as semester1,
       max(case when semester = 2 then Name end) as name2,
       max(case when semester = 2 then credit end) as credit2,
       max(case when semester = 2 then year end) as year2,
       max(case when semester = 2 then semester end) as semester2
from (select t.*,
             row_number() over (partition by semester order by name) as rownum
      from t
     ) t2
group by rownum
order by rownum 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:21:11.030

```
select Name,credit, grade, year,semester from myTable
group by semester,year, Name,credit, grade; 
```

现在我们必须使用前面的查询进行动态查询：创建临时表，因为有学期 首先动态创建一个选择查询，循环中所有学期表的所有字段：foreach 临时表在选择查询中连接该表的所有字段并使用该表的学期值添加构造标签字段，并使用联合添加临时表

'选择' + #tbls1.fieldName + ',' + ... + + #tbls2.fieldName +

# ios - Tutorial for Contacts-like UITableView look

> ID：11972351
> 
> 赞同：2
> 
> 时间：2012-08-15T15:30:55.923
> 
> 标签：ios, cocoa-touch

In my app, I would like to create a tableview where the users can fill in their contact data. I want it to look good and I was thinking to make a clone of the Contacts app on iPhone/iPad. The problem is that I don't know how to achieve that look. I want to find a tutorial that would explain to me how I can do it, but I couldn't find any.

Could anyone please suggest me one?

This is what I would like it to look like:

![enter image description here](../Images/de2bb9f75638b31c2c9adffc781c6f54.png)

# css - CSS keep footer at bottom , failed sticky footer

> ID：11972354
> 
> 赞同：1
> 
> 时间：2012-08-15T15:31:18.460
> 
> 标签：css, footer, sticky-footer

My footer will not stay at the bottom of my page. I tried the sticky footer trick, but no good.

Seems my footer has white space beneath it. Adjusting height on it has done no good.

Here is the HTML:

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
    <!-- <meta name="viewport" content="width=device-width; initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;">
    <link rel="stylesheet" type="text/css" href="style3.css" />
    <script type="text/javascript" src="jquery-1.7.2.js"></script>
    <script src="navigation.js"></script>
    </head><body>

<div id="top">

<header>
    <div id="topLeft">topleft</div>
    <nav id="nav-wrap">

    <ul id="nav">
        <li><a href="#">Home</a></li>
        <li><a href="#">Attendees</a><ul><li><a href="#">Sub Menu</a></li><li><a href="#">Sub Menu</a></li><li><a href="#">Sub Menu</a></li><li><a href="#">Sub Menu</a></li></ul></li>
        <li><a href="#">Exhibitors</a></li>
        <li><a href="#">Speakers</a></li>
        <li><a href="#">Program</a></li>

    </ul>

</nav>
<div id="topRight">topright</div>
</header>

</div>  

<div id="middle">
<div id="headerLeft"></div>
<div id="headerimage">
    <img src="header-2013.jpg"/>
    </div>

<div id="headerRight"></div>    
    <br style="clear: left;" />

</div>

<div id="pagewrap"> 

<div id="content">
        <!-- <h3>To see the mobile navigation, narrow your browser window or check with a mobile device.</h3>
        <p>Unholy is a new, upcoming raiding guild with goals of
successfully accomplishing Player versus Environment and Player versus Player
raiding content. If thou art seeking such guild then thou would consider joining
us on our quest to victory over the evils that lurk within the depths of
Karazhan and Zul'Aman. All are welcome that have experienced the foul beasts
that roam abroad the forsaken ground in the Outlands and whish to further
explore and cleanse such places. If this should be thy calling then we welcome
you to our quest for victory, For the Horde </p> -->
        </div>

</div>

<footer>
<div id="footer">
footer
</div>
</footer>
</body></html> 
```

And here is the CSS:

```
/************************************************************************************
GENERAL
*************************************************************************************/
html{
        height:auto;
    }

body {
    font: .9em/150% Arial, Helvetica, sans-serif;
    color: #666;
    overflow-x:hidden;

    /******extra Mike Clayton **/
    margin: 0;
    padding:0;  
    height:100%;
}
a {
    text-decoration: none;
    color: #39C;
}
h1, h2 {
    line-height: 120%;
    margin: 0 0 10px;
    color: #000;
}
header {
    content: " "; 
    display: table; 
}

/************************************************************************************
STRUCTURE
*************************************************************************************/
#pagewrap {
     width: 100%;
     max-width:650px;
    margin: 0px auto;

    /**Mike Clayton**/
    min-height:100%;
    height:100%;
}
#content {
    clear: both;
    border-top: solid 1px #ccc;
    padding-top: 20px;
    margin: 20px 0;
    width:100%;

    /**Mike clayton**/
    /* padding-bottom:250px; */
    padding-bottom:55%;
}

#top{
    width:100%;
    background-color:#002664;
    clear:both;
    }

#topLeft{
    float:left;
    background-color:#002664;
    width:20%;
    margin:0;
    }   

#topRight{
    float:left;
    background-color:#002664;
    width:20%;
    margin:0;
    }

#middle{
    width:100%;
    background-color:#AD1B30;
    overflow: hidden;

    }   
#headerLeft{
    float:left;
    background-color:#AD1B30;
    width:20%;
    margin:0;

}   

#headerimage{
        width:650px;
        align:center;
        margin:0 auto;

}

#headerimage img{
    width:100%;
    }

#headerRight{
    float:left;
    background-color:#AD1B30;
    width:20%;
    margin:0;
}   

#footer{
/*  background-color:#002664;
    width:100%;
    margin-top:-100;
    height:150px; */

    clear: both;
 position: relative;
 z-index: 10;
 height: 3em;
 margin-top: -3em;
 background-color:#002664;
    width:100%;
    margin-top:-100;

}
/************************************************************************************
NAV
*************************************************************************************/
#nav-wrap {
    margin-top: 20px;
}

/* menu icon */
#menu-icon {
    display: none; /* hide menu icon initially */
}

#nav, 
#nav li {
    margin: 0;
    padding: 0;
}
#nav li {
    list-style: none;
    float: left;
    margin-right: 5px;
}

/* nav link */
#nav a {
    padding: 4px 15px;
    display: block;
    color: #000;
    background: #ecebeb;
}
#nav a:hover {
    background: #f8f8f8;
}

/* nav dropdown */
#nav ul {
    background: #fff;
    padding: 2px;
    position: absolute;
    border: solid 1px #ccc;
    display: none; /* hide dropdown */
    width: 200px;
}
#nav ul li {
    float: none;
    margin: 0;
    padding: 0;
}
#nav li:hover > ul {
    display: block; /* show dropdown on hover */
}

/************************************************************************************
MOBILE
*************************************************************************************/
@media screen and (max-width: 600px) {

    /* nav-wrap */
    #nav-wrap {
        position: relative;
    }

    /* menu icon */
    #menu-icon {
        color: #000;
        width: 42px;
        height: 30px;
        background: #ecebeb url(menu-icon.png) no-repeat 10px center;
        padding: 8px 10px 0 42px;
        cursor: pointer;
        border: solid 1px #666;
        display: block; /* show menu icon */
    }
    #menu-icon:hover {
        background-color: #f8f8f8;
    }
    #menu-icon.active {
        background-color: #bbb;
    }

    /* main nav */
    #nav {
        clear: both;
        position: absolute;
        top: 38px;
        width: 160px;
        z-index: 10000;
        padding: 5px;
        background: #f8f8f8;
        border: solid 1px #999;
        display: none; /* visibility will be toggled with jquery */
    }
    #nav li {
        clear: both;
        float: none;
        margin: 5px 0 5px 10px;
    }
    #nav a, 
    #nav ul a {
        font: inherit;
        background: none;
        display: inline;
        padding: 0;
        color: #666;
        border: none;
    }
    #nav a:hover, 
    #nav ul a:hover {
        background: none;
        color: #000;
    }

    /* dropdown */
    #nav ul {
        width: auto;
        position: static;
        display: block;
        border: none;
        background: inherit;
    }
    #nav ul li {
        margin: 3px 0 3px 15px;
    }

    #headerimage {
        display: none;
    }

}

@media screen and (min-width: 600px) {

    /* ensure #nav is visible on desktop version */
    #nav {
        display: block !important;
    }

} 
```

* * *

So, that last post from Kakarott worked.

Also, I used position:relative for my Media Query mobile dev and it made that same CSS work for my Mobile site.

So, for desktop and tablet, I'm using position:absolute and for mobile:relative.

FYI, I'm using a responsive design.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:36:32.903

检查这个

[http://code.google.com/p/cleanstickyfooter/](http://code.google.com/p/cleanstickyfooter/)

和最好的解决方案

[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:40:37.963

将您的页脚 css 更改为：

```
#footer{

 clear: both;
 position: absolute;
 z-index: 10;
 height: 3em;
 bottom:0;
 background-color:#002664;
 width:100%;

} 
```

# objective-c - 如何将 UIToolbar 扩展到其他对象，如 safari

> ID：11972355
> 
> 赞同：0
> 
> 时间：2012-08-15T15:31:18.360
> 
> 标签：objective-c, user-interface, uiview, uitoolbar

我试图实现像 Mac 和 iPad 上的 Safari 一样的效果，带有选项卡，导航栏和当前选项卡是一个。我如何扩展 UINavigationBar/UIToolbar 以与 UIView 子类合并以显示为 1？

* * *

回答：

我创建了自己的 UIToolbar 子类，并使用该`drawRect:(CGRect)rect`方法使 UIToolbar 的颜色与我的 UIView 子类的颜色相同，即只有该颜色。

```
 - (void)drawRect:(CGRect)rect
{
    // Drawing code
    //// General Declarations
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = UIGraphicsGetCurrentContext();

    //// Color Declarations
    UIColor* gradientColor = [UIColor colorWithRed: 0.916 green: 0.916 blue: 0.916 alpha: 1];
    UIColor* gradientColor2 = [UIColor colorWithRed: 0.811 green: 0.811 blue: 0.811 alpha: 1];

    //// Gradient Declarations
    NSArray* gradientColors = [NSArray arrayWithObjects:
                               (id)gradientColor.CGColor,
                               (id)gradientColor2.CGColor, nil];
    CGFloat gradientLocations[] = {0, 1};
    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef)gradientColors, gradientLocations);

    //// Rectangle Drawing
    UIBezierPath* rectanglePath = [UIBezierPath bezierPathWithRect: CGRectMake(-1, 0, 769, 45)];
    CGContextSaveGState(context);
    [rectanglePath addClip];
    CGContextDrawLinearGradient(context, gradient, CGPointMake(383.5, -0), CGPointMake(383.5, 45), 0);
    CGContextRestoreGState(context);

    //// Cleanup
    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:33:50.340

这是一个具有自定义外观的自定义控件。将 UIImageViews 与可拉伸的 UIImages 一起使用，并在 PNG 图像中重新创建 GUI。或者使用 Core Graphics 来渲染选项卡的外观。（[PaintCode](http://www.google.ch/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&sqi=2&ved=0CDgQFjAA&url=http%3A%2F%2Fwww.paintcodeapp.com%2F&ei=RsErUKH5EIXc4QTo8YDwBA&usg=AFQjCNGsKi1YIN-n1uzAUIt2WJpdCKNCjA&sig2=31KkdKOuobvJlhoogyeplQ)可能对此有所帮助）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T01:52:46.613

我创建了自己的 UIToolbar 子类，并使用 drawRect:(CGRect)rect 方法使 UIToolbar 的颜色与我的 UIView 子类的颜色相同，只是那种颜色。

```
 - (void)drawRect:(CGRect)rect
{
    // Drawing code
    //// General Declarations
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = UIGraphicsGetCurrentContext();

    //// Color Declarations
    UIColor* gradientColor = [UIColor colorWithRed: 0.916 green: 0.916 blue: 0.916 alpha: 1];
    UIColor* gradientColor2 = [UIColor colorWithRed: 0.811 green: 0.811 blue: 0.811 alpha: 1];

    //// Gradient Declarations
    NSArray* gradientColors = [NSArray arrayWithObjects:
                               (id)gradientColor.CGColor,
                               (id)gradientColor2.CGColor, nil];
    CGFloat gradientLocations[] = {0, 1};
    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef)gradientColors, gradientLocations);

    //// Rectangle Drawing
    UIBezierPath* rectanglePath = [UIBezierPath bezierPathWithRect: CGRectMake(-1, 0, 769, 45)];
    CGContextSaveGState(context);
    [rectanglePath addClip];
    CGContextDrawLinearGradient(context, gradient, CGPointMake(383.5, -0), CGPointMake(383.5, 45), 0);
    CGContextRestoreGState(context);

    //// Cleanup
    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);
} 
```

# android - 使用 MapView 之外的站点线返回相对于用户的 GeoPoint(s)

> ID：11972356
> 
> 赞同：1
> 
> 时间：2012-08-15T15:31:18.460
> 
> 标签：android

我目前正在编写一个脚本来查找相对于用户最近的`GeoPoint`（从`GeoPoints`位于我们服务器上的列表中），但是我遇到了一个有趣的想法，即进一步限制结果。

我想知道是否有可能获取用户当前的站点行，也许使用`Compass`为了忽略`GeoPoint`可能或可能不靠近位于他们身后的用户的（S）。我不是在寻找为我编写的代码，只是在正确的方向上轻推或提出任何建议，我在过去的几天里一直在寻找，但现在都是空的。 *当我说“站点线”时，我并不是要指定如下所示的锥体，限制为 N、S、E 或 W 方向就可以了。*

在下面的示例图片中，我希望结果仅显示 GeoPoint(2)：

![](../Images/566b99852aa992c45d5fb728fea23143.png)

**使用说明：**用户到某个地点拍摄该地点的*几样东西*。在我的相机活动中，我正在编写一个脚本来显示现场其中一个元素相对于其位置的历史照片。所有特定站点的历史照片及其坐标均已使用 JSON 检索和解析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:44:47.590

看看[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)。它提供了许多示例，包括如何计算到某个点的方位和距离（经度、纬度）。

检查方位和距离是否在您的`acceptable`范围内，无论可能是什么（方向，视线......）。

# python - SQLAlchemy 和 UnicodeDecodeError

> ID：11972363
> 
> 赞同：13
> 
> 时间：2012-08-15T15:31:39.813
> 
> 标签：python, mysql, unicode, encoding, sqlalchemy

我越来越

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc2 in position 0: ordinal not in range(128) 
```

当我将来自我正在使用 SQLAlchemy 访问的 MySQL 数据库的文本传递给此函数时：

```
re.compile(ur"<([^>]+)>", flags=re.UNICODE).sub(u" ", s) 
```

数据库编码是 utf-8，我什至将编码传递给 SQLAlchemy 的 create_engine 函数。

**编辑：** 这就是我查询数据库的方式：

```
doc = session.query(Document).get(doc_id)
s = doc.title 
```

根据建议，我将 s.decode('utf-8') 传递给`sub`. 上面的错误消失了，但是对于不同的文档，我得到了不同的错误：

```
UnicodeDecodeError: 'utf8' codec can't decode byte 0xeb in position 449: invalid continuation byte 
```

数据库表定义如下：

```
CREATE TABLE `articles` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(255) DEFAULT NULL,
  `cdate` datetime DEFAULT NULL,
  `link` varchar(255) DEFAULT NULL,
  `content` text,
  UNIQUE KEY `id` (`id`),
  UNIQUE KEY `link_idx` (`link`)
) ENGINE=InnoDB AUTO_INCREMENT=4127834 DEFAULT CHARSET=utf8; 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-16T06:55:33.663

我已经解决了这个问题。该`title`列被 SQLAlchemy 返回为 a`str`而不是`Unicode`。我认为添加`encoding='utf8'`作为参数`create_engine`会解决这个问题，但是，正确的方法是将它传递到数据库 URI:`mysql://me@myserver/mydatabase?charset=utf8`中。

感谢您的所有回答！

# php - zend engine return object reference

> ID：11972365
> 
> 赞同：2
> 
> 时间：2012-08-15T15:31:51.353
> 
> 标签：php, c, php-internals

In php, it is valid to write something like this:

```
<?php
class Foo
{
    public function bar()
    {
        return $this;
    }
}
?> 
```

How can I do this inside zend engine? I want a method to execute some operations, then return the class instance reference.

Furthermore, I would like to store some objects (from other classes) and return them as result of some other methods, should i store it's `zval*`? What is the right way to return a reference to it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T16:03:52.713

没错，你需要退回`zval*`. 您需要使用`RETURN_ZVAL`它，它被声明为：

```
RETURN_ZVAL(zv, ctor, dtor) 
```

第一个论点，`zv`是你的`zval*`. 第二个`ctor`告诉 Zend 引擎使用复制构造函数（它用于维护`refcount`. 最后一个参数`dtor`告诉 Zend 引擎将析构函数应用于`zv`（与`refcount`太相关）。通常，除非您知道自己在做什么，否则最后两个参数应该分别是`1`和`0`。

要返回`$this`，例如：

```
PHP_METHOD(Foo, bar)
{
     RETURN_ZVAL(getThis(), 1, 0);
} 
```

在这里，`getThis()`返回一个`zval*`to `$this`。`zval*`如果您愿意，您可以传递任何其他包含 PHP 对象的对象。

# c++ - C ++通过输入日期获取哪一天

> ID：11972368
> 
> 赞同：3
> 
> 时间：2012-08-15T15:32:02.010
> 
> 标签：c++

如何通过输入日期获得哪一天？

输入日期示例：15-08-2012

我如何知道是星期一、星期二还是使用 C++ 的哪一天。

我试图从一个月的可用日期中省略周末，所以如果我输入例如 2012 年 8 月的月份，我想检查哪一天是星期六，哪一天是星期日，所以我可以从可用日期中省略它对于我的程序。

我尝试获取一个月天数的代码：

```
if (month == 4 || month == 6 || month == 9 || month == 11)
{
    maxDay = 30;
}
else if (month == 2)
//{
//  bool isLeapYear = (year% 4 == 0 && year % 100 != 0) || (year % 400 == 0);
//  if (isLeapYear)
//  { 
//   maxDay = 29;
//  }
//else
{
    maxDay = 28;
} 
```

我想知道的下一件事是在那个月，哪一天是周末，所以我可以从结果中省略它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:39:24.900

```
#include <ctime>

std::tm time_in = { 0, 0, 0, // second, minute, hour
        4, 9, 1984 - 1900 }; // 1-based day, 0-based month, year since 1900

std::time_t time_temp = std::mktime( & time_in );

// the return value from localtime is a static global - do not call
// this function from more than one thread!
std::tm const *time_out = std::localtime( & time_temp );

std::cout << "I was born on (Sunday = 0) D.O.W. " << time_out->tm_wday << '\n'; 
```

[日期到星期几算法？](https://stackoverflow.com/questions/5797814/date-to-day-of-the-week-algorithm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T15:49:25.693

我会用`mktime()`. 给定日、月和年，填写 a `tm`，然后调用`mktime`它：

```
tm timeStruct = {};
timeStruct.tm_year = year - 1900;
timeStruct.tm_mon = month - 1;
timeStruct.tm_mday = day;
timeStruct.tm_hour = 12;    //  To avoid any doubts about summer time, etc.
mktime( &timeStruct );
return timeStruct.tm_wday;  //  0...6 for Sunday...Saturday 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-10T19:48:07.370

这是一个更简单且可能更好的实现，因为它不需要任何额外的库导入。返回的结果是一个从 0 到 6 的整数（星期日、星期一、星期二...星期六）。

```
#include <iostream>

int dayofweek(int d, int m, int y){
    static int t[] = { 0, 3, 2, 5, 0, 3, 5, 1, 4, 6, 2, 4 };
    y -= m < 3;
    return ( y + y/4 - y/100 + y/400 + t[m-1] + d) % 7;
}

/* Driver function to test above function */
int main(){
    int day = dayofweek(23, 10, 2013); 
    // Above statement finds the week day for 10/23/2013
    //dayofweek(<day in month>,<month>,<year>)
    std::cout << day;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T15:40:01.770

您应该使用`mktime`和`ctime`提取结构的`tm_wday`字段`tm`。保证`mktime`不需要该字段，因此您可以填充骨架`tm`结构，对其进行处理并将其分解回完整的结构：

```
#include <ctime>

std::tm t = {};
t.tm_mday = 15;
t.tm_mon = 8;
t.tm_year = 2012;

std::tm * p = std::localtime(std::mktime(&t));

// result is p->tm_wday 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T15:42:53.623

```
#include <stdio.h>
#include <time.h>

int main ()
{
  char *str = "15-08-2012";
  struct tm tm; 
  if (strptime (str, "%d-%m-%Y", &tm) == NULL) {
    /* Bad format !! */
  }
  char buffer [80];
  strftime (buffer, 80, "Day is %a", &tm);
  puts (buffer);    
  return 0;
} 
```

# jquery - jQuery同时淡化图像

> ID：11972374
> 
> 赞同：4
> 
> 时间：2012-08-15T15:32:23.767
> 
> 标签：jquery, image

我正在使用 jQuery 交叉淡入淡出图像。

这是我正在使用的代码：

```
$('.' + currentimage).fadeOut('slow', function() {
    $('.' + selectedimage).fadeIn('slow');
}); 
```

这是在所选图像开始淡入之前将第一张图像淡出 100%。当第一张图像淡出 60-70% 时，是否有一种简单的方法可以开始淡入第二张图像？

编辑：所有好的答案。我认为还有一个问题。我的图像没有重叠显示 - 一次只能看到 1 张图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:34:45.720

尝试

```
$('.' + currentimage).fadeOut('slow');
$('.' + selectedimage).delay(100).fadeIn('slow'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T15:36:12.197

`slow`是 600 毫秒，所以 420 是 70%

```
$('.' + currentimage).fadeOut('slow');
$('.' + selectedimage).delay(420).fadeIn(600); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:37:43.190

您可以作弊并应用部分淡入淡出（使用[fadeTo](http://api.jquery.com/fadeTo/)，调用您的其他函数，然后继续。

```
$('.' + currentimage).fadeTo('slow', .6, function() {
    $('.' + selectedimage).fadeIn('slow');
    $(this).fadeOut('slow');
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-15T15:35:56.570

那是因为您在那里声明的函数`fadeOut()`是一个回调函数，只有在`fadeOut()`完成后才能调用。您应该能够简单地执行一个项目之后另一个项目以获得所需的效果。这不像从 X% 开始那样精确`fadeOut()`，但您可以调整`fadeOut`和`fadeIn`时间以获得所需的效果或`delay()`在`fadeIn`.

```
$('.' + currentimage).fadeOut('slow');
$('.' + selectedimage).fadeIn('slow'); 
```

# php - outputting array to a csv

> ID：11972379
> 
> 赞同：0
> 
> 时间：2012-08-15T15:32:37.647
> 
> 标签：php, zend-framework, csv, socialengine, fputcsv

I am trying to output data from an array to a csv and download it.

I am using social engine which is built on zend framework.

```
public function indexAction()
    {
        $this->outputCSV();
        //$this->view->navigation = $navigation = Engine_Api::_()->getApi('menus', 'core')->getNavigation('passport_admin_main', array(), 'passport_admin_main_outofarea');
        $this->_helper->layout()->disableLayout();
        $this->_helper->viewRenderer->setNoRender(true);

        header('Content-Disposition: attachment; filename="OutOfAreaReport.csv"');
        //content type
        header('Content-type: application/excel');
        //read from server and write to buffer
        readfile('spreadsheet/OutOfArea.csv');
    }

    public function outputCSV(){
        $list = array (
                    array('aaa', 'bbb', 'ccc', 'dddd'),
                    array('123', '456', '789'),
                    array('"aaa"', '"bbb"')
                );
        $fp = fopen('OutOfAreaReport.csv', 'w');

        foreach ($list as $fields) {
            fputcsv($fp, $fields);
        }

        fclose($fp);
    }
} 
```

At the moment it downloads the CSV but it has no values in the CSV it is empty.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:45:59.307

您正在使用两种不同的路径：

```
 readfile('spreadsheet/OutOfArea.csv');
              ^^^^^^^^^^^^

    $fp = fopen('OutOfAreaReport.csv', 'w');
                 ^----no path 
```

# git - Git push remote rejected {change ### closed}

> ID：11972384
> 
> 赞同：49
> 
> 时间：2012-08-15T15:32:52.887
> 
> 标签：git, gerrit

i am having problems pushing my changes from my local master to remote master because of this error:

```
remote: Processing changes: refs: 1, done
To ssh://xxxxx@gerrit.dev.xxxxx.net:29418/xxxxxx
 ! [remote rejected] HEAD -> refs/for/master (change 14823 closed)
error: failed to push some refs to 'ssh://xxxxx@gerrit.dev.xxxxx.net:29418/xxxxxx' 
```

any idea how i can fix this issue?

git status says my branch is ahead of origin/master by 5 commits.

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2014-04-02T12:40:17.043

我得到了同样的信息。这是因为我设法为两次提交获得了相同的 Change-Id。也许是由于我当地分支机构之间的一些樱桃采摘或类似的事情。通过从提交消息中删除 Change-Id 来解决，然后由提交挂钩添加一个新的 Id。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2016-08-09T09:41:09.403

您的 Commit Change ID 已过期，即 Review 14823 已关闭。你不能推动相同。

这样做可以解决问题：

1.  `git commit --amend`
2.  删除更改 ID
3.  保存并退出
4.  新的更改 ID 将添加到提交中。可以通过 git log 来验证。
5.  再推

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-15T15:39:35.390

我发现以下页面详细说明了为什么由于更改 XXXXX 关闭错误而无法将更改推送到原点：[https ://git.eclipse.org/r/Documentation/error-change-closed.html](https://git.eclipse.org/r/Documentation/error-change-closed.html)

干杯!

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-05-03T08:23:40.563

你有 5 个提交。

它们都有一个名为“Commit Message”的文件（由 Gerrit 使用）。
其中一个文件有一个错误的“Change-Id”，已被
Gerrit 接受并合并到主文件中，因此无法再次使用。

一种解决方法是将所有 5 个提交合并为一个，
并在此过程中
删除文件“提交消息”中的“更改 ID”。

就我而言，我有 3 次提交，所以我做了：
git rebase -i HEAD~3

还有其他合并多个提交的方法：
[使用 Git 将我的最后 X 个提交压缩在一起](https://stackoverflow.com/questions/5189560/squash-my-last-x-commits-together-using-git/5201642#5201642)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-11-25T17:28:46.703

如果您一直在重新定基并选择与同时已关闭（合并或放弃）的评论相关的提交，您可以简单地再次变基，而不是选择，放弃提交与审查有关。然后，您应该能够再次推送而不会出现任何问题。我强烈不同意播放/修改 Change-Ids 的建议。详细说明 git 命令，这将给出：

```
git fetch; git rebase origin/a_branch --interactive 
```

选择每个提交...修复冲突，然后 git add ...

```
git rebase --continue
git push origin HEAD:refs/for/refs/heads/a_branch 
```

-> 远程拒绝...更改 ### 关闭

然后执行以下操作：

```
git fetch; git rebase origin/a_branch --interactive 
```

挑选（pick）每个提交，除了那些与更改 ### 相关的提交，应该删除（drop）。您不应该有任何冲突并立即成功地获得 rebase（冲突已经在之前的 rebase 中解决）。然后：

```
git push origin HEAD:refs/for/refs/heads/a_branch 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-15T16:11:03.133

该`change 14823 closed`消息并非来自香草`git`。它表明维护该存储库的任何人都有一个更新或更新后挂钩，该挂钩正在评估您的推送并由于本地策略而拒绝它（我猜您正在向已标记为已标记为已完成/已关闭的问题添加额外提交）。您需要了解这些政策是什么，以及是否需要以某种方式重新打开更改以便向其添加提交，或者是否需要创建新的更改请求并（可能）重新调整您的工作它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-26T17:42:22.247

在我的情况下，我有 2 个提交，第一个提交是我的，但第二个不是，所以我这样修复它：

1.  找出在**更改 14823中提交了哪些文件**
2.  找到你最旧的提交并对其父项进行**软重置。**请注意，如果您进行硬重置，您可能会丢失所有提交。
3.  尝试再次提交您的更改，但这次没有**更改 14823中的文件**

我希望它会有所帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-28T09:47:08.343

> git status 说我的分支领先于 origin/master 5 次提交。
> 
> 我所做的只是获取最新的代码。做一些调整并推动它。

那 5 个提交是什么？它们都是你的吗？

更改 14823 是否对应于这 5 个提交之一？它在 Gerrit 的地位如何？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-10T12:51:20.900

尝试这个。git push --no-thin origin xxxxxx:refs/for/sprint/yyyyyy

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-15T18:15:09.477

您正在推送 gerrit，这是一个代码审查工具，如 url (ssh://xxxxx@gerrit.dev.xxxxx.net:29418/xxxxxx) 和“HEAD -> refs/for/master”所示“ 信息。您需要咨询维护您尝试推送到的存储库的人员，以找出更改被拒绝的原因。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-09-01T13:19:58.087

我也遇到了这个问题，当我推送我的提交并且终端说：

！[远程拒绝] HEAD -> refs/for/android_ui.lnx.1.2.c1-dev（更改 1692698 已关闭）

我去review站点查看对应1692698的更改，提交消息是：“第一次启用WiFi hostpot时提示USB tethering help”

然后在终端中显示提交日志：

*   b49c0f91744cb6f863616976c4fb4157c7af4b8c 连接 Wi-Fi 启用 USB 共享时提示不正确。
*   eb47ef919064aff516ced4bbd9d8ade0ed34b107 首次启用 WiFi 主机时提示 USB 网络共享帮助
*   753668be1207baa514be1bbd985f3db2d6317608 修复热点通知错误。

push 失败的原因是当前的 changID 和 eb47ef919064aff516ced4bbd9d8ade0ed34b107 commit 的一样。所以我备份当前更改并硬重置为 753668be1207baa514be1bbd985f3db2d6317608 然后应用备份更改，最后依次添加、提交和推送。

希望这可以解决您的问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-18T05:44:57.050

问题可能是多个，但如果问题是您的更改是在过时的提交之上（出于任何原因，它可能已被合并），您只需要：

第1步：找到要删除的提交之前的提交 git log

第 2 步：签出提交 git checkout

第 3 步：使用当前的 checkout commit git checkout -b 创建一个新分支

第 4 步：现在您需要在删除的提交 git cherry-pick 之后添加提交

现在将您的更改推送到 gerrit，它应该接受它们。

见：[https ://www.clock.co.uk/insight/deleting-a-git-commit](https://www.clock.co.uk/insight/deleting-a-git-commit)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-09-27T21:48:58.343

如果 gerrit 上已经存在已合并甚至放弃的更改，则可能会发生这种情况。如果放弃了，这是我的情况，请在 gerrit 上恢复该更改并将新更改应用到恢复的更改之上。

[https://gerrit-review.googlesource.com/Documentation/error-change-closed.html](https://gerrit-review.googlesource.com/Documentation/error-change-closed.html)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-31T11:21:45.220

EGit 用户解决方案：

1.  点击修改按钮 [![在此处输入图像描述](../Images/fe29f5bee17dd6ed06f198961a6c6840.png)](https://i.stack.imgur.com/zrqCq.png)

2.  使用退格按钮从提交消息区域删除 Change-Id（这将与此屏幕截图不同）
3.  单击“添加更改 ID”按钮[![在此处输入图像描述](../Images/7372f68280a24f14397e2194e9174fb7.png)](https://i.stack.imgur.com/x4zE1.png)

4.  提交您的更改并推送。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-08T09:04:30.703

如果你有多个提交。并且关闭的提交不是最新的。在这种情况下，你不能使用`--amend`修改change-Id。因为`--amend`只能修改最新的提交消息。

在这种情况下，使用`git rebase origin/master -i`并使用`reword`而不是`pick`在您需要修改change-Id的提交上。

当弹出请求编辑提交消息的编辑器时。只需删除更改 ID 行并保存。这将创建一个新的更改 ID。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-12-14T20:38:01.043

你有 5 个提交。

每个提交都有一个“提交消息”，其中可能包含一个“更改 ID：”字符串，该字符串标识该提交属于 Gerrit 的哪个更改请求（请参阅[https://git.eclipse.org/r/Documentation/user-changeid. html](https://git.eclipse.org/r/Documentation/user-changeid.html) )

在这种情况下，由 Change-Id 字符串标识的一个（或多个）变更请求已经被 Gerrit 合并或放弃，因此不能再次使用。

您需要在推送之前修改一个（或多个）提交的提交消息（请参阅[http://schacon.github.io/history.html](http://schacon.github.io/history.html)），**删除**它们以创建新的更改请求，或**修改**它们以便他们为每个提交确定正确的 Gerrit 变更请求。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-02-11T07:34:45.307

我和我的前辈工作了 1 个多小时才得到解决方案，所以我在下面尝试了，它对我有用

1.  备份 .git/logs/refs/heads/{{branch}} 文件夹中的所有分支并在 repo 中更新文件
2.  删除了导致错误的分支
3.  创建分支“git branch '{{new branch name}}'”
4.  将 repo 文件移回相关文件夹
5.  git commit -m "{{commit message}}"
6.  git push origin HEAD:refs/for/master

每件事都应该很好，做得很好

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2015-12-02T11:22:19.780

这应该这样做：

```
git commit --amend 
```

删除更改 ID，然后推送审核。

# sql - ：SQL如何计算具有多个共同if列的不同行的数量（从另一个表连接）

> ID：11972387
> 
> 赞同：1
> 
> 时间：2012-08-15T15:32:58.093
> 
> 标签：sql, join, count, distinct

好的，这是我的问题。也许我的大脑只是被炸了，但我正在努力解决这个问题

我有一个表（假设 TableA 有一组列，假设名称是：

pk1，Pk2，a，b，c，APPLE（有另一个表中的3个设置值）等（PK1和PK2是主键）

然后我有另一张桌子（比如说tableB）

PK1（与 TableA 上的 PK1 链接）、ag、DOG、sf、STAR（也有一组 nr 值）等

好的，所以现在我想加入这两张桌子，这很容易。PK1中的值可以重复，只要PK1和PK2的组合是唯一的，就是这样。

好的，棘手的部分来了。我想获得 PK1+PK2+a 不同组合的列表

但我也想知道每种类型的STAR有多少。

**好的，这部分是可选的（给你明亮的火花）：**

只是为了让它变得棘手，然后必须将每种类型的明星细分为苹果的类型

1）我该怎么做？2）是否可以只用 1 个查询来完成，我将不得不使用像游标这样的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:01:50.067

你试过什么？也许这可以帮助？

```
select distinct pk1,pk2,a from tableA 
```

,

```
select tableA.pk1,pk2,a,star,count(*)
from tableA join tableB on tableA.pk1 = tableB.pk1
group by tableA.pk1,pk2,a,star 
```

,

```
select tableA.pk1,pk2,a,star,apples,count(*)
from tableA join tableB on tableA.pk1 = tableB.pk1
group by tableA.pk1,pk2,a,star,apples 
```

# regex - Regex.Replace for IP address

> ID：11972390
> 
> 赞同：0
> 
> 时间：2012-08-15T15:33:36.857
> 
> 标签：regex, replace, ip

I've lifted a piece of code from somewhere on the internet it looks like this

```
 ip = Regex.Replace(ip, @"^(?<Prefix>(\d{1,3}\.){3})\d{1,3}$", "${Prefix}*"); 
```

What it does is takes an IP address and replaces the last section with a asterisk. For example `192.168.0.1` would become `192.168.0.*`

I'm useless with RegEx, I've tried to understand what the above is actually doing, but not having any success.

What I'm after is 2 more `Regex.Replace` code so that `192.168.0.1` becomes

*   `192.168.*.*`
*   `192.*.*.*`

Can anyone help me?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:42:12.520

192.168.*.* =`ip = Regex.Replace(ip, @"^(?<Prefix>(\d{1,3}\.){2})\d{1,3}\.\d{1,3}$", "${Prefix}*.*");`

192.*.*.* =`ip = Regex.Replace(ip, @"^(?<Prefix>(\d{1,3}\.))\d{1,3}\.\d{1,3}\.\d{1,3}$", "${Prefix}*.*.*");`

试一试，看看会发生什么。

# google-bigquery - BigQuery 中的同义词已停止工作

> ID：11972398
> 
> 赞同：0
> 
> 时间：2012-08-15T15:33:57.330
> 
> 标签：google-bigquery

突然之间，我无法获得在 BigQuery 中工作的表的同义词，因此类似以下的查询可以正常工作：

```
select id as id, value as value
from pos_dw_api.test 
```

但类似以下的查询失败：

```
select a.id as id, a.value as value
from pos_dw_api.test a 
```

返回的错误如下。我已经从 Web 控制台运行了它：

```
Query Failed
Error: Unknown field: a.id 
```

同义词上周工作得很好......我用于此选择的示例表是`387047224813.pos_dw_api.test`.

同义词的语法是否发生了变化？这是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:25:37.783

表同义词通常仅在您执行 JOIN 时才有效。我不知道有什么会导致这种情况发生变化。我意识到这有点奇怪，我已经提交了一个内部错误来修复它。

# mysql - MySql 使用嵌套查询根据当前记录检查最旧的记录

> ID：11972415
> 
> 赞同：0
> 
> 时间：2012-08-15T15:35:23.230
> 
> 标签：mysql, self-join, nested-queries

我头晕目眩，试图找出我需要使用的 SQL 查询。我尝试了各种嵌套查询和自连接，但一切都让我失望了。我想我想得太多了。

基本思想：我有一个表，我们称之为，表中`OrderTable`有四个（相关）字段：`OrderId`, `CustomerId`, `RestaurantId`,`OrderTime`

当客户下订单时，日期/时间戳会添加到该`OrderTime`字段。其他三个字段只是整数，`OrderId`字段作为主键（并且自动递增）。

我正在尝试编写一个查询，该查询将返回一个`CustomerId`记录列表，其中该客户的第一条记录（最早日期）是特定日期（比如“2012-03-14”），RestaurantId 是特定数字（比如29)。

目前，我只能假设这是一种过于复杂的方法。此外，当有多个记录与我的子查询匹配时，我目前收到错误“#1242 - 子查询返回超过 1 行”。

谁能帮我一个更优雅的解决方案？谢谢！

当前查询：

```
SELECT `CustomerId` 
FROM `OrderTable` 
WHERE `OrderTime` LIKE '%2012-03-14%' 
AND `RestaurantId`='29' 
AND `OrderId`=(SELECT `OrderId` 
   FROM `OrderTable` 
   WHERE `RestaurantId`='29' 
   GROUP BY `CustomerId` 
   ORDER BY `OrderTime` ASC
   ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:46:38.227

编辑：John Totet Woo 可能是对的，但仍然参考我帖子的第二部分以避免 LIKE 子句:)

我可能对您的要求有些困惑，但是如果您将子查询从 '=' 更改为 IN，您会得到您想要的吗？

```
SELECT `CustomerId` 
FROM `OrderTable` 
WHERE `OrderTime` LIKE '%2012-03-14%' 
AND `RestaurantId`='29' 
AND `OrderId` IN (SELECT `OrderId` 
    FROM `OrderTable` 
    WHERE `RestaurantId`='29' 
    GROUP BY `CustomerId` 
    ORDER BY `OrderTime` ASC
) 
```

不过，最困扰我的是，您可以使用

```
AND DATE(OrderTime) = '2012-03-14' 
```

而不是喜欢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:42:43.500

您的 current 可以返回多个值。该`=`符号只需要子查询中的一个值，为此，您需要使用`LIMIT`关键字来限制子查询的值。

```
SELECT `CustomerId` 
FROM   `OrderTable` 
WHERE  `OrderTime` LIKE '%2012-03-14%' AND 
       `RestaurantId`='29' AND 
       `OrderId`= (
                     SELECT `OrderId` 
                     FROM `OrderTable` 
                     WHERE `RestaurantId`='29' 
                     ORDER BY `OrderTime` ASC
                     LIMIT 1
                  ) 
```

你也可以这样做：

```
SELECT DISTINCT CustomerID
FROM OrderTable
WHERE OrderID IN
(
    SELECT  OrderID
    FROM    OrderTable 
    WHERE   RestaurantID = 29 AND
            DATE(OrderTime) = DATE(2012-03-14)
) b 
```

最**简单**的解决方案是：

```
 SELECT  DISTINCT CustomerID
    FROM    OrderTable 
    WHERE   RestaurantID = 29 AND
            DATE(OrderTime) = DATE(2012-03-14) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:47:25.977

我想我很困惑。为什么不能像这样选择与您的 OrderTime 和 Restaurant ID 相等的所有记录？

```
SELECT * FROM OrderTable WHERE OrderTime = "2012-03-14" AND RestaurantID = "29"; 
```

那不会给你你想要的清单吗？

# sharepoint - 有没有办法以编程方式在与特定列表关联的随机列表中获取查找字段？

> ID：11972418
> 
> 赞同：0
> 
> 时间：2012-08-15T15:35:34.140
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007, sharepoint-api, sharepoint-object-model

我有一个共享点列表，例如它被命名为 SourceList。我还有几个通过查找字段与 SourceList 关联的列表。我不知道这些列表的名称或数量\它们是动态创建和创建的。并且任何时候都可以创建与 SourceList 关联的新列表。

那么，如何通过 Sharepoint 对象模型以编程方式获取与 SourceList 关联的列表？我知道我可以遍历列表以及列表的字段以检查它是否是查找字段并与我的 SourceList 关联。出于性能考虑，我不想这样做，但如果我找不到更好的解决方案，这将是我最后的机会。而且我知道我可以直接查询 sharepoint db 来获取这些列表，但我永远不想这样做。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T01:16:52.860

您基本上只需要访问列表然后查找字段，当您拥有此对象时，该字段应该是类型 `SPFieldLookup`，源列表将是该`LookupList`字段上的属性。

他们在这个链接中有一个很好的例子：

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldlookup.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldlookup.aspx)

# validation - 跨字段 bean 验证 - 为什么你不工作

> ID：11972419
> 
> 赞同：0
> 
> 时间：2012-08-15T15:35:42.590
> 
> 标签：validation, jsf-2, bean-validation, managed-bean, hibernate-validator

我的应用程序在这里遇到了一个小问题。我想检查字段密码和确认密码是否匹配，所以我尝试像在这个问题的第一个答案中那样做：[Cross field validation with Hibernate Validator (JSR 303)](https://stackoverflow.com/questions/1972933/cross-field-validation-with-hibernate-validator-jsr-303)

问题是它实际上不起作用，我不知道为什么。请帮我！这是我在这里的第一篇文章，所以请不要对我太苛刻。

这是我的注释：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints;

import java.lang.annotation.*;
import javax.validation.Constraint;
import javax.validation.Payload;

/**
 *
 * @author lukasz
 */
@Documented
@Constraint(validatedBy = FieldMatchValidator.class)
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface FieldMatch {

String message() default "{pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints.FieldMatch}";

Class<?>[] groups() default {};

Class<? extends Payload>[] payload() default {};

String first();

String second();
} 
```

这是我的验证器类：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints;

import java.lang.reflect.InvocationTargetException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;
import org.apache.commons.beanutils.BeanUtils;

/**
 *
 * @author lukasz
 */
public class FieldMatchValidator implements ConstraintValidator<FieldMatch, Object> {

    private String firstFieldName;
    private String secondFieldName;

    @Override
    public void initialize(FieldMatch constraintAnnotation) {
        firstFieldName = constraintAnnotation.first();
        secondFieldName = constraintAnnotation.second();
    }

    @Override
    public boolean isValid(Object value, ConstraintValidatorContext context) {
        try {
            String sFirstField = BeanUtils.getProperty(value, firstFieldName);
            String sSecondField = BeanUtils.getProperty(value, secondFieldName);
            if(sFirstField.equals(sSecondField)){
                return true;
            }
        } catch (IllegalAccessException ex) {
            Logger.getLogger(FieldMatchValidator.class.getName()).log(Level.SEVERE, null, ex);
        } catch (InvocationTargetException ex) {
        Logger.getLogger(FieldMatchValidator.class.getName()).log(Level.SEVERE, null, ex);
        } catch (NoSuchMethodException ex) {
        Logger.getLogger(FieldMatchValidator.class.getName()).log(Level.SEVERE, null, ex);
        }
        return false;
    }
} 
```

这是我的豆子：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package pl.lodz.p.zsk.ssbd2012.ssbd12.Beans;

import javax.ejb.EJB;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
import javax.validation.constraints.Pattern;
import javax.validation.constraints.Size;
import pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints.CheckEmail;
import pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints.FieldMatch;
import pl.lodz.p.zsk.ssbd2012.ssbd12.entities.Account;
import pl.lodz.p.zsk.ssbd2012.ssbd12.mok.endpoint.MokEndpointLocal;

/**
 *
 * @author krzys
 * @author lukasz
 */

@ManagedBean
@RequestScoped
@FieldMatch(first = "password", second = "password2", message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.ValidationConstraints.FieldMatch}")
public class RegisterBean {

    /**
     * Creates a new instance of RegisterBean
     */

    @EJB
    MokEndpointLocal endpoint;

    @Size(min = 3, max = 16, message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.login.size}")
    @Pattern(regexp = "[a-zA-Z0-9]+", message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.login.invalid}")
    private String login;

    @Size(min = 6, max = 64, message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.password.size}")
    @Pattern(regexp = "[a-zA-Z0-9]+", message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.password.invalid}")
    private String password;

    private String password2;

    @Pattern(regexp = "[A-Ż][a-ż]+", message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.name.invalid}")
    private String name;

    @Pattern(regexp = "[A-Ż][a-ż]+", message = "{pl.lodz.p.zsk.ssbd2012.ssbd12.Beans.RegisterBean.surname.invalid}")
    private String surname;

    @CheckEmail
    private String email = "";

    /**
     * @return the login
     */
    public String getLogin() {
        return login;
    }

    /**
     * @param login the login to set
     */
    public void setLogin(String login) {
        this.login = login;
    }

    /**
     * @return the password
     */
    public String getPassword() {
        return password;
    }

    /**
     * @param password the password to set
     */
    public void setPassword(String password) {
        this.password = password;
    }

    public String getPassword2() {
        return password2;
    }

    public void setPassword2(String password2) {
        this.password2 = password2;
    }

    /**
     * @return the name
     */
    public String getName() {
        return name;
    }

    /**
     * @param name the name to set
     */
    public void setName(String name) {
        this.name = name;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String register ()
    {
//       Account account = new Account();
//       account.setLogin(login);
//       account.setHaslo(password);
//       account.setImie(name);
//       account.setNazwisko(surname);
//       account.setEmail(email);
//       endpoint.register(account);
       return "registerSucces";
    }

    /**
     * @return the surname
     */
    public String getSurname() {
        return surname;
    }

    /**
     * @param surname the surname to set
     */
    public void setSurname(String surname) {
        this.surname = surname;
    }
} 
```

这是JSF：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <h:outputStylesheet name="menu.css" library="css" />
    <title>#{messages.registration}</title>
</h:head>

<h:body>
    <ui:composition template="./../resources/mainTemplate.xhtml">

        <h4>#{messages.registration}</h4>
    <ui:define name="content">
        <h4>#{messages.registration}</h4>
        <h1>#{messages.registrationInfo1}</h1>
    #{messages.registrationInfo2}
    <h:form>
        <h2>
            <h:outputText value="#{messages.loginForm}"/>
            <h:inputText id="login" value="#{registerBean.login}" />  
        </h2>
        <h2>
            <h:outputText value="#{messages.passwordForm}" />
            <h:inputSecret id="password" value="#{registerBean.password}" />
        </h2>
        <h2>
            <h:outputText value="#{messages.repeatPasswordForm}"/> 
            <h:inputSecret id="confirm" value="#{registerBean.password2}" />
        </h2>
        <h2>
            <h:outputText value="#{messages.nameForm}"/>
            <h:inputText id="name" value="#{registerBean.name}" />
        </h2>
        <h2>
            <h:outputText value="#{messages.surnameForm}"/>
            <h:inputText id="surname" value="#{registerBean.surname}" />
        </h2>
        <h2>
            <h:outputText value="#{messages.emailForm}"/>
            <h:inputText id="email" value="#{registerBean.email}" />
        </h2>
        <h2>    
            <h:commandButton value="#{messages.send}" action="#{registerBean.register()}" />
        </h2>
    </h:form>
    </ui:define>
    </ui:composition>
</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T14:54:06.283

JSF 在验证阶段不会自动触发类级别的约束。您只能使用字段级别的约束（此外，并非所有字段都由 JSF 评估，而只是那些在您的 facelet 中的字段）。

如果要使用 bean 验证，可以手动执行验证：

```
Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
Set<ConstraintViolation<Test>> violations = validator.validate( this, Default.class ); 
```

您可以在 bean 的注册方法或更新模型阶段之后执行此操作（但我从未尝试过）。

无论如何，您可以使用 JSF 验证而不是 bean 验证或直接在注册方法中检查密码：

```
public String registration() {
    ...

    if ( !password.equals(password2) ) {
        FacesContext.getCurrentInstance().addMessage( null, new FacesMessage( "Passwords do not match" ) );
        return null;
    }

    ...
} 
```

# javascript - 更新脚本以针对具有递增 ID 的新创建的表行运行

> ID：11972420
> 
> 赞同：0
> 
> 时间：2012-08-15T15:35:49.103
> 
> 标签：javascript, jquery, forms, jquery-ui

我有一张带有 jQ​​uery UI 提前输入功能的表格。当只有 1 个表格行（初始视图）时，它正在使用我的表单。有一个按钮允许用户根据需要创建额外的表格行，这也增加了文本输入和选择菜单的 ID。

还有另一个脚本根据预先输入的选择将匹配值插入到选择菜单中。这两种方法都适用于第一行，但对于创建的任何其他行停止工作。

我已经设置了一个示例 JSFiddle：

[http://jsfiddle.net/fmdataweb/hxzME/1/](http://jsfiddle.net/fmdataweb/hxzME/1/)

 `我想我理解为什么它们只适用于第一行 - 它们与这些 ID 相关联：#lastYearSelect1 和 #nextYearSelect1 - 但我不确定如何更改它们，因此它们可以使用 #lastYearSelect2、#nextYearSelect2、#lastYearSelect3、 #nextYearSelect3 等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:15:18.223

剧本有一些问题。

首先，您是对的，您需要在克隆行后再次设置所有脚手架，该`clone`方法不会复制功能，只会复制 html 元素。

要找到正确的元素，您可以在对象上使用匹配属性名称开头的[JQuery ^=](http://api.jquery.com/attribute-starts-with-selector/)`clone`选择器来找到正确的子输入以变成自动完成字段。您可以在函数中执行相同的技巧将下拉列表更改为正确的函数。

最后，您的许多代码和变量都在错误的范围内，无法正确访问。我已经移动了很多变量，以便它们可以访问，主要是在全局范围内。当您更有经验时，您不会想要这样做，但现在这很好。

我还创建了一个新函数`setDropDown`，但这段代码几乎与之前的相同。

这是您的代码的工作版本：

[http://jsfiddle.net/hxzME/3/](http://jsfiddle.net/hxzME/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:40:01.847

在绑定事件处理程序时将类添加到元素并使用类选择器。`

# php - 单击时将PHP变量从div标签传递给jquery

> ID：11972422
> 
> 赞同：1
> 
> 时间：2012-08-15T15:35:50.413
> 
> 标签：php, javascript

当用户单击时，我需要将变量从 PHP 转换为 Javascript。我有一个查询返回的数据数组，我需要为单击的元素传递一个 ID 值，以便我可以使用另一个 PHP 页面通过 .load 填充额外的数据集。我不确定如何做到这一点？

页面中的 Javascript 代码：

```
<script type="text/javascript"> 
$(function () { 
 $("#pass_userid_div").click(function () {

    $("#another_div").load('remote_pages/get_info.php?userid=' + $GET_THE_USERID_AND_PASS_HERE);
  });
});
</script> 
```

页面中的 PHP 代码：

```
$query_str = "SELECT id, username, dateregistered FROM users";
$query = mysql_query($query_string) or die(mysql_error());

while ($results = mysql_fetch_array($query)) {
    print "<div id='pass_userid_div'>{$results['username']}</div>";
    print "<div>{$results['dateregistered']}</div>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:39:02.130

```
$("#another_div").load('remote_pages/get_info.php?userid=' + $GET_THE_USERID_AND_PASS_HERE, function(){
    $("#another_div #pass_userid_div").each(function(){
        var yourvar =$(this).text();
        // use your var
     })
}); 
```

请注意，您不应使用多个具有相同 ID 的 div。使用`class`instread

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:45:42.077

为什么它必须是一个div？使用[交互式元素](http://dev.w3.org/html5/pf-summary/interactive-elements.html#using-the-button-element-to-define-a-command)：

PHP：

```
while ($results = mysql_fetch_array($query)) {
    print "<button type='button' name='pass_userid_div' value='{$results['id']}'>{$results['username']}</button>";
    print "<div>{$results['dateregistered']}</div>";
} 
```

JavaScript：

```
<script type="text/javascript"> 
$(function () { 
 $("button[name='pass_userid_div']").click(function () {
    $("#another_div").load('remote_pages/get_info.php?userid=' + $(this).val());
  });
});
</script> 
```

更新：如果它*真的*必须是一个 div，请[使用一个`data-`属性](http://www.w3.org/TR/2010/WD-html5-20101019/elements.html#custom-data-attribute)：

```
<div class="pass_userid_div" data-userid='{$results['id']}'…

…$(this).data("userid") 
```

# sql-server-2008 - 将 Access 应用程序连接到不同服务器中的 SQL 服务器的可能方法？

> ID：11972426
> 
> 赞同：2
> 
> 时间：2012-08-15T15:36:08.037
> 
> 标签：sql-server-2008, ms-access, vba

假设 SQL Server 中有几个表。我的客户在他们自己的服务器上使用 Access 2003 数据库。SQL Server 2008 R2 位于差异服务器上。他们的 Access 前端是用 VBA 编写的。我知道我可以让他们使用 ADO 和 OLEDB 提供程序连接到我的 SQL 服务器。为此，他们必须添加来自

```
Tools-->References--> MS ActiveX objects 6.0 Library 
```

并使用提供的连接字符串：

```
Provider= SQLOLEDB.1; Integrated Security = SSPI; Initial catalog=DatabaseName; Data source =ServerNamethathostsSQLSeerver 
```

有没有其他方法可以让他们连接到 SQL Server？就性能而言，有哪些更好的方法可以做到这一点？

请分享您的意见。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:39:26.087

在 MS Access 2007 及更高版本中，推荐的方式是链接表，不需要引用，可以通过代码或菜单完成。Microsoft Access 2003 还支持链接表。

更多信息： http: [//office.microsoft.com/en-us/access-help/import-or-link-access-to-sql-server-data-HA010341762.aspx](http://office.microsoft.com/en-us/access-help/import-or-link-access-to-sql-server-data-HA010341762.aspx)

# ios - 设备方向：无用的方向

> ID：11972429
> 
> 赞同：-4
> 
> 时间：2012-08-15T15:36:20.193
> 
> 标签：ios, uiinterfaceorientation, uideviceorientation

我的一些课程订阅了设备方向更改时的通知。其他时候，我直接检查方向

```
[[UIDevice currentDevice] orientation] 
```

正如你们大多数人所知，在 iOS 中存在以下方向：

```
typedef enum {
   UIDeviceOrientationUnknown,
   UIDeviceOrientationPortrait,
   UIDeviceOrientationPortraitUpsideDown,
   UIDeviceOrientationLandscapeLeft,
   UIDeviceOrientationLandscapeRight,
   UIDeviceOrientationFaceUp,
   UIDeviceOrientationFaceDown
} UIDeviceOrientation; 
```

是否有一种应用程序范围的方法来禁止 FaceUp、FaceDown 和 Unknown 被报告？这些方向更新在 95% 的应用程序中无用，而 Unknown 在 99.9% 的应用程序中无用。

现在我只是忽略了这些方向（无论我是从直接检查方向还是从收到通知中看到它们），但它在某些情况下会引起烦恼。

无论如何，我猜没有办法阻止“无用”方向被报道，但我认为值得一问。我可能只需要继续处理它们，对吧？

编辑：
好的，基于我已经收到的反对票数量，显然不同意苹果是一种罪过。

但是，请向我解释一下收到通知您设备方向未知的通知会有什么帮助？这与根本没有收到任何通知有什么不同？与未发送任何通知相比，何时知道设备方向“未知”会有所帮助？如果我看到几个实际用例，其中知道方向未知并不是……没用，我愿意收回无用的声明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:45:10.940

他们在那里是有原因的。在 Apple，他们不会制造无用的东西（Xcode 除外）。

虽然不可能直接修改方法而不返回它们，但您可以忽略它们——这有什么问题？

如果你真的很生气并且真的希望 UIDevice 不返回这些值，你可以越狱你的 iPhone/iPad 并`- [UIDevice orientation]`使用 MobileSubstrate 进行挂钩。

# jquery - 使用 jquery 获取禁用文本框的值

> ID：11972431
> 
> 赞同：2
> 
> 时间：2012-08-15T15:36:26.147
> 
> 标签：jquery

无论如何我可以用jquery获取文本框的值吗？

我有一个表格，当它达到某个状态时，行被禁用，但我需要将鼠标悬停在某个字段上以在弹出窗口中显示该值的内容。

这是我的代码：

```
 $('.TariffName').mouseover(function (e) {
            x = e.pageX;
            y = e.pageY;
            var tr = $(this).closest('tr');
            var notes = tr.find('#txtTariffName').val();
            if (notes != "") {
                $("div#TariffWording").css('top', y).css('left', x);
                $("#TariffWording > p").text(notes);
                $('div#TariffWording').show()
            }
            else {
                $('div#TariffWording').hide()
            }

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-15T21:05:39.147

在文本输入上使用“只读”属性而不是“禁用”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-07T04:44:59.477

尝试使用`:disabled`

```
$("input:disabled").val() 
```

[https://jsfiddle.net/vigneshvdm/7227gzpk/](https://jsfiddle.net/vigneshvdm/7227gzpk/ "工作小提琴")

# sharepoint-2010 - 办公地点的 SharePoint 人员搜索

> ID：11972435
> 
> 赞同：0
> 
> 时间：2012-08-15T15:36:34.287
> 
> 标签：sharepoint-2010, sharepoint-search

我正在研究一种允许用户搜索其他用户的解决方案，因为我们使用 SharePoint 2010 并且可以访问 SharePoint 人员搜索，这似乎是一个简单的解决方案。在大多数情况下，它接近于需要的东西，但似乎缺少一些东西。

最重要的是能够按办公室/位置进行搜索。

搜索似乎返回了办公室位置，但我似乎无法搜索它。

我希望能够通过执行 BaseOfficeLocation:"Office Location To Search For" 来搜索它，因为 Department:"Department To Search for" 似乎可以工作。

我已经尝试过 Office 和 OfficeLocation，但它似乎不起作用。我发现一个博客说这似乎没有按预期工作，但没有更多细节。

是否有我需要启用的设置或者我需要在这里进行一些自定义开发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T13:42:55.690

这可能有点晚了，但这里有。

您基本上需要添加一个映射到用户个人资料上的办公室（或其他）字段的元数据属性。然后，您需要对其进行爬网。最后，您可以将办公室添加到搜索选项中。下面给你一个快速概述如何做到这一点。

**添加新的托管元数据属性**

*   转到中央管理。
*   转到管理服务应用程序
*   进入您的搜索服务应用程序
*   在“查询和结果”下的左侧，转到“托管元数据属性”
*   点击“新建托管属性”
*   给它起个名字，我叫我的“办公室”
*   单击“添加映射”并选择人员
*   选择“人员：办公室（文本）”（这取决于您用来放置办公室的个人资料中的哪个字段）
*   选择“根据指定的顺序包括来自单个已爬网属性的值”
*   点击确定

现在运行 FULL CRAWL。这很重要。如果它不是一个完整的爬行，它不会被捡起。

等待完整爬网完成。

**将字段添加到搜索**

*   您现在应该可以搜索 Office:"office name"
*   这对用户不是很有用
*   我们想要的是将其添加到搜索选项中
*   编辑页面并转到搜索框的 Web 部件属性
*   转到“杂项”并展开它
*   打开“属性”并复制出 XML。在这里，您现在需要添加新字段。
*   它看起来像这样：
*   <Property Name="Office" ManagedName="Office" ProfileURI="urn:schemas-microsoft-com:sharepoint:portal:profile:Office"/>
*   将其添加，然后将其保存回 Web 部件
*   单击搜索选项，在新办公室字段中输入办公室，然后单击搜索
*   繁荣！！办公室搜索。

除非我遗漏了某些内容，否则您将需要在初始人员搜索页面和结果页面上执行此操作。

这是我基于所有内容的链接。

[http://blogs.technet.com/b/meamcs/archive/2010/12/23/sharepoint-2010-people-search-using-metadata.aspx](http://blogs.technet.com/b/meamcs/archive/2010/12/23/sharepoint-2010-people-search-using-metadata.aspx)

# api - 使用带有 Twitter API 的 Rest Codeigniter 库

> ID：11972436
> 
> 赞同：1
> 
> 时间：2012-08-15T15:36:39.940
> 
> 标签：api, codeigniter, rest, twitter, rest-client

我已经设置了 Phil Sturgeon 的 Rest 库以连接到 Twitter API - 但是效果很好（见下文）

```
 $this->load->spark('restclient/2.1.0');
    $this->load->library('rest');
    $this->rest->initialize(array('server' => 'http://twitter.com/'));
    $username = 'my-username';
    // Pull in an array of tweets
    $tweets = $this->rest->get('statuses/user_timeline/'.$username.'.xml'); 
```

这段代码很好用——但是 Twitter API[文档](https://dev.twitter.com/docs/api/1/get/statuses/user_timeline)建议使用稍微不同的方法（见下文）——我将如何在这个库中使用下面的新方法？

```
https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=twitterapi&count=2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:46:10.063

这应该很简单，如下所示：

```
$this->load->spark('restclient/2.1.0');
$this->load->library('rest');
$this->rest->initialize(array('server' => 'http://api.twitter.com'));
$username = 'my-username';
// Pull in an array of tweets
$tweets = $this->rest->get('/1/statuses/user_timeline.xml?screen_name='.$username); 
```

除非我错过了什么。

您可以添加文档页面上列出的任何其他查询字符串参数。

# java - 如何使 Web 应用程序构建独立于 ant 版本

> ID：11972438
> 
> 赞同：0
> 
> 时间：2012-08-15T15:36:53.340
> 
> 标签：java, xml, linux, ant

我使用 Netbeans 7.0 开发了一个 Web 应用程序。构建（生成战争文件）在 netbeans 中工作，但如果我使用在另一台服务器（linux）上构建项目，`ant`我会得到以下信息：

```
[packwolf src]$ ant
Buildfile: build.xml

BUILD FAILED
/home/packwolf/Application/src/build.xml:12: The following error occurred while executing this line:
/home/packwolf/Application/src/nbproject/build-impl.xml:22: Class org.apache.tools.ant.taskdefs.condition.Not doesn't support the nested "antversion" element. 
```

当我检查 build-impl.xml 时，它有一个用于检查 ANT 版本 1.7 或更高版本的 XML 块。如何使构建独立于ant版本？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T10:29:46.287

A nested `antversion` task is allowed only 1.7 onwards so no way you can actually make this work with full functionality. This is what you can do as workaround though these are not solutions to the problem

1.  Comment out the ANT check in the build-impl.xml. Then run on an older version of ANT (say 1.6.5). This would stop the `antversion` check and the build will progress but without seeing the build.xml its not possible to comment where else it might fail.
2.  Install a newer version of ANT wherever the build is supposed to run.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:10:54.383

您可以将 ant 签入到存储库并在操作系统中使用它而不是默认值。但是要运行ant，你需要java。您可以将 JRE 签入您的存储库，但在这种情况下，您的存储库将非常大。

# model-view-controller - MVC - 模型/控制器/视图中的 HTML 转义？

> ID：11972440
> 
> 赞同：0
> 
> 时间：2012-08-15T15:36:56.720
> 
> 标签：model-view-controller, escaping

我应该在哪里逃避模型的输出。我也应该在模型中这样做吗？我想它应该在视图中，但我不确定。将其放入 View 似乎是逻辑，因此您可以将 HTML 更改为不同的输出（PDF 等）。

您在哪里将 HTML 输出（来自用户）转义到页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:16:10.770

有了您的澄清评论，答案就变得简单了；您要问的是[表示逻辑](http://en.wikipedia.org/wiki/Presentation_logic)，它仅在视图中处理。

# android - 不同设备中的 Android OutOfMemory ？

> ID：11972441
> 
> 赞同：0
> 
> 时间：2012-08-15T15:36:58.060
> 
> 标签：android, bitmap, logcat

我有一个处理图像的应用程序，它适用于某些设备前。HTC ONE X 和其他人没有。GALAXY NOTE，这个列表很大 IDK 这个问题完全是因为它在某些方面有效，而在其他方面则无效。它也不适用于模拟器默认的一个，但它确实可以工作的一个小模拟器

这是我得到的 logcat

```
08-15 18:30:39.070: I/dalvikvm-heap(334): Clamp target GC heap from 25.723MB to 24.000MB
08-15 18:30:39.090: D/dalvikvm(334): GC_FOR_MALLOC freed <1K, 51% free 2672K/5379K, external 19015K/19657K, paused 38ms
08-15 18:30:39.370: D/dalvikvm(334): GC_EXTERNAL_ALLOC freed <1K, 51% free 2672K/5379K, external 19015K/19657K, paused 45ms
08-15 18:30:39.400: E/dalvikvm-heap(334): 810000-byte external allocation too large for this process.
08-15 18:30:39.510: I/dalvikvm-heap(334): Clamp target GC heap from 25.724MB to 24.000MB
08-15 18:30:39.510: E/GraphicsJNI(334): VM won't let us allocate 810000 bytes
08-15 18:30:39.510: D/dalvikvm(334): GC_FOR_MALLOC freed 0K, 51% free 2672K/5379K, external 19015K/19657K, paused 36ms
08-15 18:30:39.532: D/AndroidRuntime(334): Shutting down VM
08-15 18:30:39.532: W/dalvikvm(334): threadid=1: thread exiting with uncaught exception (group=0x40015560)
08-15 18:30:39.600: E/AndroidRuntime(334): FATAL EXCEPTION: main
08-15 18:30:39.600: E/AndroidRuntime(334): java.lang.RuntimeException: Unable to start activity ComponentInfo{app.com.android.editor/app.com.android.editor.Option}: android.view.InflateException: Binary XML file line #317: Error inflating class <unknown>
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.os.Looper.loop(Looper.java:123)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-15 18:30:39.600: E/AndroidRuntime(334):  at java.lang.reflect.Method.invokeNative(Native Method)
08-15 18:30:39.600: E/AndroidRuntime(334):  at java.lang.reflect.Method.invoke(Method.java:507)
08-15 18:30:39.600: E/AndroidRuntime(334):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-15 18:30:39.600: E/AndroidRuntime(334):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-15 18:30:39.600: E/AndroidRuntime(334):  at dalvik.system.NativeStart.main(Native Method)
08-15 18:30:39.600: E/AndroidRuntime(334): Caused by: android.view.InflateException: Binary XML file line #317: Error inflating class <unknown>
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.createView(LayoutInflater.java:518)
08-15 18:30:39.600: E/AndroidRuntime(334):  at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
08-15 18:30:39.600: E/AndroidRuntime(334):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:207)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.Activity.setContentView(Activity.java:1657)
08-15 18:30:39.600: E/AndroidRuntime(334):  at app.com.android.editor.Option.onCreate(Option.java:40)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
08-15 18:30:39.600: E/AndroidRuntime(334):  ... 11 more
08-15 18:30:39.600: E/AndroidRuntime(334): Caused by: java.lang.reflect.InvocationTargetException
08-15 18:30:39.600: E/AndroidRuntime(334):  at java.lang.reflect.Constructor.constructNative(Native Method)
08-15 18:30:39.600: E/AndroidRuntime(334):  at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.LayoutInflater.createView(LayoutInflater.java:505)
08-15 18:30:39.600: E/AndroidRuntime(334):  ... 25 more
08-15 18:30:39.600: E/AndroidRuntime(334): Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.Bitmap.nativeCreate(Native Method)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.Bitmap.createBitmap(Bitmap.java:477)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.Bitmap.createBitmap(Bitmap.java:444)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:349)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:498)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:473)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:336)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:697)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.content.res.Resources.loadDrawable(Resources.java:1709)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.view.View.<init>(View.java:1951)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.widget.TextView.<init>(TextView.java:344)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.widget.Button.<init>(Button.java:108)
08-15 18:30:39.600: E/AndroidRuntime(334):  at android.widget.Button.<init>(Button.java:104)
08-15 18:30:39.600: E/AndroidRuntime(334):  ... 28 more
08-15 18:30:45.459: I/Process(334): Sending signal. PID: 334 SIG: 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:38:46.473

堆大小因设备而异。在应用程序具有大堆大小的设备上，与应用程序具有较小堆大小的设备相比，您遇到的问题更少，这是完全合理的。如果您支持较旧/较低分辨率的设备，您的堆可能低至 16MB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:39:08.667

大多数android的空间有限。通常为 16MB。我强烈建议查看您的图像大小。尽可能使用弱引用来确保图像仅在访问时使用内存。（弱引用将迫使收集的垃圾更快地清理它们。）

*   而且我对您的应用程序了解不多，只是您的 logcat 错误列表，但是如果您有多个活动，请杀死不需要的活动。似乎是显而易见的建议，也许不是，但它会释放空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T15:59:12.193

正如其他人所说，应用程序的堆大小是有限的。最小值为 16MB，并且因设备而异（这是虚拟机的设置）。

一些建议你可以做什么：

1.  如果不需要全分辨率，您可以加载较小版本的图像。这是如何做到的：http: [//developer.android.com/reference/android/graphics/BitmapFactory.Options.html](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html)
2.  检查是否有足够的空闲内存可用；如果内存不足，您可以立即释放不直接需要的图像，并在需要时再次加载它们。

以下是一些用于检查剩余可用内存量的代码：

```
long free = Runtime.getRuntime().freeMemory(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T15:39:22.100

```
 Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget 
```

那条线说明了一切。位图占用了某些设备（VM 堆栈限制较高的设备）的所有内存。您应该为这个应用程序寻找更好的内存管理，例如 LruCache、解码质量较低的位图等。

**编辑：** 不要像某些用户建议的那样使用 Wea​​kReference。检查这个问题[Android是否需要在采样之前从文件中加载完整的位图？](https://stackoverflow.com/questions/11969923/does-android-need-to-load-a-complete-bitmap-from-a-file-before-sampling-it-down/11970041#11970041)还有这个视频[http://www.youtube.com/watch?v=gbQb1PVjfqM](http://www.youtube.com/watch?v=gbQb1PVjfqM)

来自平台创建者的直接解释/教学/技术，并说不要使用 Wea​​kReference。

# scriptaculous - 在 2 个滑块手柄之间更改轨道颜色

> ID：11972442
> 
> 赞同：1
> 
> 时间：2012-08-15T15:36:58.573
> 
> 标签：scriptaculous

我正在使用 Script.aculo.us Slider.js 来显示双滑块。它工作得很好。我想要做的是更改颜色以仅在这两个滑块之间进行跟踪。

例如，如果第一个滑块的值为 5，第二个滑块的值为 8。我希望 5-8 的轨道为绿色，其余为灰色。模拟所选范围之王。

可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T09:07:03.003

我已经想通了，可以通过使用 2 个选项属性 startSpan 和 endSpan。

也许它对我在此处粘贴示例 HTML 片段和 javascript 的其他人有用

```
<div id="slider-week-track">
  <div id="span1" style="float:left;background-color: #B7C0CD; height: 11px;"></div>
  <div class="slider-week slider-min" id="slider-week-min-handle"></div>
  <div class="slider-week slider-max" id="slider-week-max-handle"></div>
  <div id="span2" style="float:right;background-color: #B7C0CD; height: 11px;"></div>
</div> 
```

和 javascript

```
new Control.Slider(this.options.handles, 'slider-week-track', {
                        range:$R(0,10, false),
                        sliderValue: [1,5],
                        values: [0,1,2,3,4,5,6,7,8,9,10],
                        restricted: true,
                        startSpan: 'span1',
                        endSpan: 'span2',
                        onChange:   function(val) { 
                            //your code here
                        }
        }); 
```

# facebook - 在 Facebook 页面选项卡应用程序上为未登录用户自动调用 FB.login

> ID：11972450
> 
> 赞同：2
> 
> 时间：2012-08-15T15:37:53.530
> 
> 标签：facebook, facebook-javascript-sdk, facebook-oauth

我有一个 Facebook 页面标签应用程序。对于未登录的用户，我想：

*   检测用户是否未登录
*   如果没有登录，自动引导用户登录

我目前的方法是使用 FB Javascript SDK（优先于服务器端身份验证流程）：

*   在页面加载时，运行`FB.getLoginStatus`以检查用户状态
*   如果用户未登录，则运行`FB.login`以调用 OAuth 对话框

问题：

*   `FB.login`创建一个弹出对话框（如果在 Page Tab iframe 中，则首选）
*   如果未从按钮调用此弹出对话框，则将被阻止`FB.login`（我真的很想避免让用户单击按钮；所以真的很想在找到未登录的用户时自动调用它）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:55:24.157

> 我真的很想避免让用户单击按钮

没有用户交互的 FB.login -> 阻止弹出窗口

> 如果在 Page Tab iframe 内，则更喜欢

Auth 对话框在 iframe 中不起作用，它就是这样*设计*的。

如果登录对话框的自动调用是您最重要的要求 - 然后使用 JavaScript 重定向到 Auth 对话框 URL，然后重定向回您的页面/应用 Facebook 地址。请参阅此处的“不使用 JS SDK 的客户端身份验证”部分：[https ://developers.facebook.com/docs/authentication/client-side/](https://developers.facebook.com/docs/authentication/client-side/)

# zend-framework - Zend 控制器路由器：定义变量以指向一个控制器中的不同操作

> ID：11972453
> 
> 赞同：0
> 
> 时间：2012-08-15T15:37:57.420
> 
> 标签：zend-framework, zend-controller-router

我是 Zend 的新手，我对 Zend 路由器有点麻烦。我已经搜索过它，但没有找到...

我希望能够在 uri 级别为每个定义的变量定义一个路由器，以指向一个控制器中的不同操作。

我正在使用语言和模块，所以我在引导应用程序中定义了下一个 initRoutes 函数：

```
protected function _initRoutes()
{
    $front = Zend_Controller_Front::getInstance();
    $router = $front->getRouter();

    $defaultRoute = new Zend_Controller_Router_Route(
        ':lang/:module/:controller/:action',
        array(
            'lang' => 'es',
            'module' => 'default',
            'controller' => 'index',
            'action' => 'index'
        ),
        array(
            'lang' => '^(en|es)$',
            'module' => '^(default|admin)$'
        )
    );

    $router->addRoute('defaultRoute', $defaultRoute);

    return $router;
} 
```

我希望能够通过他们定义的操作访问论坛部分和论坛主题。

就像是 ：

*   我的域名/论坛 -> 论坛/索引

*   mydomain/forum/section -> 论坛/sectionAction

*   mydomain/forum/section/topic -> 论坛/topicAction

以及在 uri 级别定义的语言和模块，例如：

*   我的域/语言/模块/论坛

*   mydomain/lang/module/forum/section

*   mydomain/lang/module/forum/section/topic

所以我有这个：

```
class ForumController extends Zend_Controller_Action
{

public function indexAction()
{
}

public function sectionAction()
{
}

public function topicAction()
{
} 
```

然后我在 Default_Bootstrap 中创建了下一个路由：

```
$forumRoutes = new Zend_Controller_Router_Route(
    ':lang/:module/forum',
    array(
        'lang' => 'es',
        'module' => 'default',
        'controller' => 'forum',
        'action' => 'index'
    )
);

$sectionRoutes = new Zend_Controller_Router_Route(
    ':lang/:module/forum/:section',
    array(
        'lang' => 'es',
        'module' => 'default',
        'controller' => 'forum',
        'action' => 'section',
        'section' => ''
    )
);

$topic = new Zend_Controller_Router_Route(
    ':lang/:module/forum/:section/:topic',
    array(
        'lang' => 'es',
        'module' => 'default',
        'controller' => 'forum',
        'action' => 'topic',
        'section' => '',
        'topic' => ''
    )
);

$router->addRoute('forumTopics', $topic);
$router->addRoute('forumSections', $section);
$router->addRoute('forum', $forumRoutes); 
```

现在，这仅在我在 uri 级别定义语言和模块时才有效，但如果我定义为 => mydomain/forum/section | 则不起作用 部分/主题。这也给我的导航->菜单带来了另一个问题。如果我在路由器定义中将“论坛”定义为静态变量，当我将鼠标悬停在 navigatoin.xml 中定义的任何标签上时，uri 级别对于每个标签都有相同的值。

我试图制作这样的链条：

```
 $forumRoutes = new Zend_Controller_Router_Route(
        ':lang/:module/forum',
        array(
            'lang' => 'es',
            'module' => 'default',
            'controller' => 'forum',
            'action' => 'index'
        )
    );

    $section = new Zend_Controller_Router_Route(
        ':section',
        array(
            'action' => 'section',
            'section' => ''
        )
    )

    $topic = new Zend_Controller_Router_Route(
        ':topic',
        array(
            'action' => 'topic',
            'topic' => ''
        )
    )

    $chainedRoute = new Zend_Controller_Router_Route_Chain();
    $chainedRoute->chain($topic)
                 ->chain($section)
                 ->chain($forumRoutes);
    $router->addRoute($chainedRoute); 
```

但这并不像我预期的那样工作。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:02:27.573

你是 Zend 的新手。你说的。所以这里有一些解释：

1.  理想情况下，Zend 应用程序上的 URL 是：

> example.com/controller/action/param-name/:param-value

所以在这种情况下，如果在UsersController下有一个名为Edit的动作，它将是：

> example.com/users/edit

如果添加操作，它将是：

> example.com/users/add

当您将第一个参数指定为变量时，它将与控制器请求发生冲突。示例：如果您说控制器是用户，但第一个参数接受一个值并将其放入员工中，那么 example.com/employees 和 example.com/user 的请求都将指向员工控制器，即使用户控制器存在！这又是一个理论！

您可能想要做的是，让路由只接受动态值而不是路由！您不希望用户路由您的应用程序，而是将用户路由到应用程序的不同部分。

关于语言，您需要使用[Zend_Locale](http://framework.zend.com/manual/en/zend.locale.html)它将检查 HTML 语言

`<html lang="nl"> or <html lang = "en">`

希望事情清楚！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T21:29:33.227

Here's a quick example which should help you work with routes like that in ZF.

If you are using a default project structure like the one you get when starting a new project using Zend Tool go into the Application folder.

In your Bootstrap.php set up something like this:

```
protected function _initRouteBind() {
        // get the front controller and get the router
        $front  = Zend_Controller_Front::getInstance();
        $router = $front->getRouter();
        // add each custom route like this giving them a descriptive name 
        $router->addRoute(
            'addTheDescriptiveRouteNameHere',
            new Zend_Controller_Router_Route(
                '/:controller/:id/:action/:somevar',
                array(
                    'module'     => 'default', 
                    'controller' => ':controller',
                    'action'     => ':action', 
                    'id'         => ':id',
                    'somevar'    => ':somevar'
                )
            )
        );   
} 
```

My example above is just to illustrate how you would use a route where the controller, the action and a couple of parameters are set in the url.

The controller and action should be resolved without any additional work however to get the 'id' or 'somevar' value you can do this in your controller:

```
public function yourAction()
{
    // How you get the parameters to pass in to a function
    $id = $this->getRequest()->getParam('id');
    $somevar = $this->getRequest()->getParam('somevar');

    // Using the parameters
    $dataYouWant = $this->yourAmazingMethod($id);
    $somethingElse = $this->yourOtherAmazingMethod($somevar);

    // Assign results to the view
    $this->view->data = $dataYouWant;
    $this->view->something = $somethingElse;
} 
```

So while you will want to make sure your methods handle the parameters being passed in with care (after all it is user supplied info) this is the principle behind making use of the route parameter binding. You can of course do things like '/site' as the route and have it direct to a CMS module or controller, then another for '/site/:id' where 'id' is a page identifier.

Also just to say a nice alternative to:

```
$id = $this->getRequest()->getParam('id');
$somevar = $this->getRequest()->getParam('somevar'); 
```

which wasn't that nice itself anyway since it was assuming a parameter was going to be passed, using shorthand conditional statement in conjunction with action helpers is:

```
$id = ($this->_hasParam('id')) ? $this->_getParam('id') : null;
$somevar = ($this->_hasParam('somevar')) ? $this->_getParam('somevar') : null; 
```

If you are not familiar with this, the

```
($this->_hasParam('id')) 
```

is the conditional test which if true assigns the value of whatever is on the left of the ':' and which if false assigns the value of whatever is on the right of the ':'.

So if true the value assigned would be

```
$this->_getParam('id') 
```

and null if false. Does that help? :-D

# c++ - 使用 OpenCV 进行激光线检测

> ID：11972457
> 
> 赞同：4
> 
> 时间：2012-08-15T15:38:11.950
> 
> 标签：c++, opencv

我正在做一个项目，我需要在图像中检测红色激光线。这是我心目中的策略。

1.  分离图像中的 R、G、B 通道。
2.  以高强度值阈值图像。
3.  使用生成的 3 个二进制图像，执行元素明智操作 r && !g && !b。（&& 是逻辑与，! 是逻辑非）。
4.  得到的矩阵是一个二值图像，在存在激光的区域上为 1。

这适用于 Matlab 上的一些测试图像。但我的问题是这需要在 C/C++ 中使用 OpenCV 来实现。

我已经尝试过大多数库函数，但似乎没有直观/简单的方法来处理二进制图像并对它们执行逻辑操作。

有人可以向我指出您认为我可能会发现有用的 OpenCV 功能/方法吗？我认为`cvThresholdImage`可以将其用于阈值，但仅此而已。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:25:58.907

那么你已经在 openCV 中弄清楚了步骤 1 和 2 了吗？如果您只是尝试使用逻辑运算符，openCV 可以让您访问原始数据，然后您可以使用逻辑运算符对其进行操作。假设您已经分成三个通道并设置了阈值

```
//three binary images in the format you specified above
cv::Mat g;
cv::Mat b;
cv::Mat r;
uchar* gptr = g.data();
uchar* bptr = b.data();
uchar* rptr = r.data();

//assuming the matrix data is continuous you can just iterate straight through the data
if(g.isContinuous()&&r.isContinuous()&&b.isContinuous())
{  
  for(int i = 0; i < g.rows*g.cols; i++)
  {
     rptr[i] = rptr[i]&&!bptr[i]&&!gptr[i];
  }
} 
```

r 现在包含您描述的输出。如果您不想覆盖 r，也可以将其复制到新矩阵中。

有几种方法可以遍历 cv::Mat 并访问所有数据点，C++ 提供了您可能需要的所有逻辑运算符。据我所知，openCV 不提供矩阵逻辑运算符函数，但您可以很容易地编写自己的函数，如上所示。

**编辑** 根据 QuentinGeissmann 的建议，您可以使用 bitwise_not 和 bitwise_and 函数完成同样的事情。我不知道它们的存在。我怀疑使用它们会更慢，因为必须迭代数据的次数，但它可以用更少的代码完成。

```
cv::bitwise_not(g,g);
cv::bitwise_not(b,b);
cv::bitwise_and(b,g,b);
cv::bitwise_and(r,b,r);
//r now contains r&&!b&&!g 
```

# python - Python将html插入MySQL

> ID：11972470
> 
> 赞同：2
> 
> 时间：2012-08-15T15:39:14.883
> 
> 标签：python, mysql, syntax-error

我正在尝试将 HTML 代码插入到 MySQL 数据库中的字段中。

我使用下面的代码来做到这一点

```
cur.execute("INSERT INTO `table1`(field1) VALUES("+ str(data) +")") 
```

但我收到以下错误：

```
_mysql_exceptions.ProgrammingError: (1064, 'You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right 
syntax to use near \'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 
Transitional//EN" "http://www.w3.or\' at line 3') 
```

我怎么解决这个问题？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:42:19.323

你应该转义你的字符串：

```
cur.execute("INSERT INTO `table1`(field1) VALUES('"+ conn.escape_string(str(data))+"')") 
```

`conn`你的连接在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:42:04.260

检查您的字符串 - 看起来您正在转义单引号但未转义双引号（并且由于您使用双引号括起来，因此字符串“提前”关闭）。

# jquery - sharepoint lists.asmx updatelistitems 从标签中删除 onclick 事件

> ID：11972471
> 
> 赞同：2
> 
> 时间：2012-08-15T15:39:20.977
> 
> 标签：jquery, sharepoint

我正在使用肥皂更新共享点列表中的列表项（基本上是 html 文章），这一切正常。它以这种方式完成，因为它从另一台服务器更新信息。这是通过 asp.net（在 VB 中）使用 Web 引用（以下称为 sharepointref）到 lists.asmx 服务来完成的

但是，当通过 lists.asmx 使用 updatelistitems 时，添加到 A 标签或任何标签的任何 onclick 事件都会被删除。我基本上想在列表项中的某些链接上的 onclick 事件中添加一些 JQUERY。

```
$('html,body').animate({scrollTop: $('#anchor').offset().top},'slow');return false; 
```

这只是平滑地滚动到文章中的锚点，而不是再次重新加载文章。

我假设这是 sharepoint 中的一个安全功能，但有没有办法解决这个问题？

一个基本的例子是：

```
Dim xmlDoc As XmlDocument = New System.Xml.XmlDocument()
Dim myUpdates as XmlNode= xmlDoc.CreateNode(XmlNodeType.Element, "Batch","")
myxml = "<Method ID='1' Cmd='Update'>"
myxml = myxml & "<Field Name='ID'>1</Field>"
myxml = myxml & "<Field Name='Content_Field'><![CDATA[<a name='anchor'></a><br><br><a href="&chr(34)&"#"&chr(34)&" onclick="&chr(34)&"$('html,body').animate({scrollTop: $('#anchor').offset().top},'slow');return false;"&chr(34)&">test</a>]]></Field>"
 myxml = myxml & "</Method>"
myUpdates.InnerXml =  myxml
Dim mysp As new sharepointref.Lists()
Dim ndLists As XmlNode = mysp.UpdateListItems("Articles",myUpdates) 
```

以上一切正常，除非您在 Sharepoint 中查看它丢失了 onclick 事件。

# java - 共享对象中是否存在竞争条件？

> ID：11972475
> 
> 赞同：1
> 
> 时间：2012-08-15T15:39:26.170
> 
> 标签：java, jakarta-ee, servlets

如果我有一个共享对象，它会保存在 httpsession 中。

如果我不时修改它而没有任何并发​​更改（例如，我的客户信息在会话中保存并且一次只能由同一个用户访问（此信息的所有者），是否有机会获得某种问题，与多线程等有关？

流程示例：对象保存在会话（线程 1）中。对象由线程修改，即服务请求1（用户更改了他的数据并将其保存在会话中）。对象由线程修改，即服务 request2（用户使用他的用户信息打开页面）。

是否有机会，由 request2 呈现的页面上的数据会过时（没有完成 ajax 或其他异步操作）？

**UPD：** 我的问题是，*感觉*它是对共享资源的顺序访问，它保存在 httpsession 中（绑定到具体的登录用户）。这是主要原因，我不想使用易失性的东西或同步。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T15:48:23.827

当然——任何时候多个线程可以访问相同的数据，都有可能出现问题。

用户可以打开多个选项卡/窗口并发出近乎同时的请求。这些请求将以不确定的时间和顺序进行处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T16:00:12.957

您没有在线程方面提供足够的相关信息来准确回答您的问题，但让我给您一些一般性警告。

1.  为了解决由数据竞争引起的问题，不需要真正的并发访问——来自多个线程的访问就足够了，即使有时相隔几秒或几分钟。

2.  您可能遇到的问题源于一个线程对其他线程的更改的**可见性。**在读取和写入之间没有`happens-before`关系的情况下，JVM 不需要将任何更改从本地缓存/线程本地存储传播到主内存，反之亦然：读取线程不需要从主内存中提取新数据.

3.  根据您拥有的确切代码，有时即时编译器甚至可以优化整个读取操作，注意到第一次读取并永久缓存该值就足够了（因为`happens-before`与该读取没有关系） .

总之，您肯定需要某种方法来确保`happens-before`从写入到读取的关系。这完全取决于您的代码的细节。

# java - 休眠标准

> ID：11972479
> 
> 赞同：1
> 
> 时间：2012-08-15T15:39:42.530
> 
> 标签：java, hibernate

假设我有一些类似于以下的类（为简洁起见，省略了 getters/setters）。

```
 public class Record{

        // ... properties
        private Metadata metadata;

        @OneToOne(cascade=CascadeType.ALL)
        @PrimaryKeyJoinColumn
        public Metadata getMetadata(){
            return metadata;
        }

    }

    public class Metadata {

       private Boolean enabled = false;

       private Record record;

       @OneToOne
       @PrimaryKeyJoinColumn
       public getRecord() {
           return record;
       }

       @Column("enabled")
       public Boolean getEnabled() {
           return enabled;
       }
    } 
```

使用休眠条件，我想运行一个查询，上面写着“给我所有具有空元数据或未启用元数据的记录”。目前我的代码执行以下操作：

```
List results = session().createCriteria(Record.class).list();

// iterate over results, pluck out the Records that match my criteria 
```

...但我们可以做得更好，对吧？

我尝试创建元数据的别名并尝试查看别名是否为空，或者 alias.property 是否符合我的条件，即 (Restrictions.eq("metadata.enabled", false) 但这不起作用。我还尝试使用析取来通过我正在寻找的两个条件过滤我的结果（元数据为空，或未启用元数据）。这些方法都不起作用；我认为这是因为我正在尝试使用标准没有以我期望的方式加入。如果可以的话，请为我阐明这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:01:00.117

也许是这样的：

```
Criteria crit = session().createCriteria(Record.class);
crit.add( Restrictions.disjunction()
        .add( Restrictions.isNull("metadata") )
        .add( Restrictions.eq("metadata.enabled",  false) )
);
List results = crit.list(); 
```

或这个：

```
List results = session().createCriteria(Record.class)
    .add( Restrictions.or(
        Restrictions.eq( "metadata.enabled", false ),
        Restrictions.isNull("metadata")
    )).list(); 
```

# ios - 保存/编辑重复日历事件的最佳方式

> ID：11972480
> 
> 赞同：0
> 
> 时间：2012-08-15T15:39:45.167
> 
> 标签：ios, sqlite, core-data, calendar

我有一个存储我所有日历事件的 SQLite 数据库，建模如下：

```
TimerEvent
 *Attributes
  -date
  -dateForMark
  -reminder
 *Relationships
  -eventInfo (<->)

EventInfo
 *Attributes
  -location
  -notes
  -recurringKey
  -reminderKey
  -title
 *Relationships
  -timerEvent (<->)
  -repeat (<->>)

Repeat
 *Attributes
  -repeatDate
 *Relationships
  -eventInfo(<->>) 
```

创建事件时，会创建 TimerEvent，并插入三个日期值。然后，创建与 EventInfo 实体的关系，插入事件的位置、标题、注释和提醒/重复键。如果如果重复键不是 -1，则根据 TimerEvent 日期和用户输入确定的日期之间的重复日期数创建重复实体。

我的日历比读取所有日期，显示它们，然后在我的 AgendaView 中可以显示来自“父”实体的所有信息（EventInfo 不是重复的父实体。它只是与可以创建的许多重复）。编辑时出现问题...如果我想编辑其中一个重复事件，仅编辑该事件（不是跟随者或之前的），我将重复对象追溯到 EventInfo 对象，更改该信息会更改每个事件的信息。我只能想象两种解决方案：

```
1\. Add extra NSString attributes to repeat events for when events are edited
2\. Create a new event JUST for that object, nullify the existing relationship, 
   and use the repeatDate as the main date. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:34:35.370

在使用重复表跟踪所有事件时，我会将重复事件提取到 EventInfo 表中的单个事件。因此，Repeat 表处理有关所有重复事件的公共信息，同时为重复事件的每个实例创建单独的 EventInfo 记录。比如下面

## 活动信息

*   第 1 项 - 不重复
*   项目 2 - 重复（重复 ID 1）
*   项目 3 - 重复（重复 ID 1）
*   项目 4 - 重复（重复 ID 2）
*   项目 5 - 重复（重复 ID 2）
*   第 6 项 - 不重复

## 重复

*   重复 1 - 重复公共信息
*   重复 2 - 重复公共信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T04:17:37.190

通过为每个重复事件创建一个`TimerEvent`具有它自己的个体来解决，向 's 添加一个属性，添加对 's 的搜索以获取与当前事件相关联的所有那些。ID 是从每次创建新的重复事件时分配和递增的新键生成的。`EventInfo``repeatID``TimerEvent``repeatID``NSUserDefault`

# emacs - minibuffer中的空白模式？

> ID：11972485
> 
> 赞同：1
> 
> 时间：2012-08-15T15:40:17.977
> 
> 标签：emacs, ido, minibuffer, icicles

有没有办法可以`whitespace-mode`在 minibuffer 中打开？我不确定我会坚持下去——但有时我需要它。我尝试了`add-hook`所有`M-x apropos RET minibuffer hook RET`：

```
(mapc
 (lambda (language-mode-hook)
   (add-hook language-mode-hook
             (lambda () (interactive) (whitespace-mode 1))))
 '(minibuffer-setup-hook
   icicle-minibuffer-setup-hook
   icomplete-minibuffer-setup-hook
   ido-minibuffer-setup-hook
   minibuffer-inactive-mode-hook)) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T23:05:46.480

看起来你有一些应该工作的东西，这对我有用：

```
(defun enable-ws-mode ()
  (whitespace-mode 1))
(add-hook 'minibuffer-inactive-mode-hook 'enable-ws-mode) 
```

就像您发布的代码一样。您是否尝试过在没有初始化文件的情况下运行 Emacs？

```
emacs -q
emacs -q --no-site-init 
```

并评估您拥有的代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-17T20:54:32.383

也许这只是因为已经六年了，但是。. . 使用 Emacs 26.3，我能够将常规空白模式命令添加到没有中间功能的钩子中：

(add-hook 'minibuffer-inactive-mode-hook '空白模式)

没有大惊小怪，没有混乱，在​​这里工作。

# ruby - Ruby 有原子变量吗？

> ID：11972487
> 
> 赞同：15
> 
> 时间：2012-08-15T15:40:27.573
> 
> 标签：ruby

Ruby 是否具有原子变量，例如Java`AtomicInteger`或`AtomicBoolean`Java？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T16:40:50.347

这是一个可以提供您需要[的宝石（](http://github.com/headius/ruby-atomic)[从此处找到链接](http://moonbase.rydia.net/mental/blog/programming/atomic-operations-in-ruby.html)）。[代码干净紧凑，足以快速理解](https://github.com/headius/ruby-atomic/blob/master/lib/atomic.rb)（它基本上是一个互斥锁，正如其他人所建议的那样），如果您想编写自己的互斥锁包装器，这应该为您提供一个很好的起点。

来自[github](http://github.com/headius/ruby-atomic)的一个稍作修改的示例：

```
require 'atomic'

my_atomic = Atomic.new('')

# set method 1:
my_atomic.update { |v| v + 'hello' }

# set method 2:
begin
  my_atomic.try_update { |v| v + 'world' }
rescue Atomic::ConcurrentUpdateError => cue
  # deal with it (retry, propagate, etc)
end

# access with:
puts my_atomic.value 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-20T01:15:33.090

应该注意的是，根据互斥体实现原子类型违背了使用“原子”抽象的目的。

适当的原子实现会发出利用 CPU 的比较和交换指令的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-30T18:27:31.807

按照建议使用互斥锁，如下所示：

```
i = 0
lock = Mutex.new

# Then whenever you want to modify it:
lock.synchronize do
  i += 1
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T15:43:58.797

我不认为Ruby有一个。但是，有一个[Mutex](http://www.ruby-doc.org/core-1.9.3/Mutex.html)可以用来模仿。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T15:44:43.790

不是本机的，但您可以使用[`Mutex`](http://www.ruby-doc.org/core-1.9.3/Mutex.html)该类获得一些原子性。

`AtomicString`例如，您可以实现自己的`Mutex`.

# jquery - 如何知道所有 AJAX 调用何时完成？

> ID：11972489
> 
> 赞同：3
> 
> 时间：2012-08-15T15:40:28.230
> 
> 标签：jquery

在页面加载时，我需要调用 API。当所有 AJAX 调用完成（完成）后，我想要解锁 UI。问题是我不知道我会调用多少次 API。可能是一次或十次。

我的代码：

```
$(document).ready(function () {

           callAPI(yourApiKey);
}); 
```

和功能：

```
function getRates(yourAPIKey, contractCode, startDate, endDate) {
// I did cut some code here
 $.ajax({   
     url: ratesEnquiry,
     type: 'GET',
     dataType: "jsonp",
     jsonp: "callback",
     complete: function (response, responseCode) {       
     },
     success: function (json) {
     $.each(json, function (index, value) {
             populateValues("rate", this.ContractCode, this.RoomTypeCode, this.Date.substr(0, 10), this.RoomPrice);
             populateValues("hrate", this.ContractCode, this.RoomTypeCode, this.Date.substr(0, 10), this.RoomPrice);

             });
         }
     });
 }

function getAvailability(yourAPIKey, contractCode, startDate, endDate) {
    // I've cut off some code here as well
    $.ajax({
    url: availabilityEnquiry,
    type: 'GET',
    dataType: "jsonp",
    jsonp: "callback",
    //jsonpCallback: "jsonpCallback",
    complete: function (json, responseCode) {
        //console.log(response); console.log(responseCode);
        //alert("complete");           
    },
    success: function (json) {

        $.each(json, function (index, value) {
             populateValues("avail", this.ContractCode, this.RoomTypeCode, this.Date.substr(0, 10), this.Quantity);
             populateValues("havail", this.ContractCode, this.RoomTypeCode, this.Date.substr(0, 10), this.Quantity);                      
            // alert(this.RoomPrice);
            });

        }
    });
}

function callAPI(yourAPIKey) {

     // I've cut off some code here

     $.blockUI({ message: '<span class="loader green" original-title="1Loading, please wait…"></span><h3> Please wait...</h3>' });
     $.ajax({
         url: enquiry,
         type: 'GET',
         dataType: "jsonp",
         jsonp: "callback",
         complete: function (response, responseCode) {
         },
         success: function (json) {
             $.each(json.Contracts, function (index, contract) {
                ContractsArray[Count] = contract.ContractCode;
                Count++;

             });
             for(var i = 0; i < Count; i++){

                 getAvailability(yourAPIKey, ContractsArray[i], startDate, endDate);
                 getRates(yourAPIKey, ContractsArray[i], startDate, endDate);

             }
         }
     });
    } 
```

我可以使用 ajaxStop 或 ajaxComplete 来解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:46:37.330

使用 counter 并检查是否每次调用都向该计数器添加 1 和每次完成减 1 到该计数器，如果计数器将为 0，则您知道所有 api 调用都已完成简单示例：

```
var calls = 0;
function makeCall(url) {
   calls++;
   $.ajax({
      complete: function(resp) {
          calls--;
      }
   });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:44:32.030

.ajaxComplete 应该可以工作 它为 ajax 请求何时完成注册一个处理程序。本质上，只要 ajax 请求完成，就会调用此处理程序。

为什么你会认为它不起作用？

[http://api.jquery.com/ajaxComplete/](http://api.jquery.com/ajaxComplete/)

# c# - 尝试插入 schema.table.ID 时出现 ORA-01400

> ID：11972490
> 
> 赞同：5
> 
> 时间：2012-08-15T15:40:34.747
> 
> 标签：c#, oracle, entity-framework, ora-01400

我有一张存储被拒绝的合同提案的表格。

```
CREATE TABLE "STATUS_CONTRATO" (
  "STC_ID" NUMBER NOT NULL,
  "CTB_CONTRATO" NUMBER NOT NULL,
  "STC_DATA" DATE NOT NULL,
  "STC_OBSERVACAO" VARCHAR2(200) NOT NULL,
  CONSTRAINT "STATUS_CONTRATO_PK" 
    PRIMARY KEY ( "STC_ID") 
    ENABLE 
    VALIDATE,
  CONSTRAINT "FK_CONTRATO" 
    FOREIGN KEY ( "CTB_CONTRATO")
       REFERENCES "CONTRATO" ( CTB_CONTRATO) 
       ON DELETE SET NULL 
    ENABLE 
    VALIDATE)
; 
```

（由 Visual Studio 2010 生成的脚本）

该表有一个简单的触发器，其中设置了 的值`STC_ID`：

```
TRIGGER "STATUS_CONTRATO_TRIGGER1"
  BEFORE
  INSERT
  ON "STATUS_CONTRATO"
  FOR EACH ROW

when (new.STC_ID = 0)
DECLARE
BEGIN 
  SELECT SEQ_STATUS_ID.NEXTVAL INTO :NEW.STC_ID FROM DUAL;
END; 
```

`SEQ_STATUS_ID`是一个简单的序列。

这是我的问题：

我可以在 VS2010 查询窗口中成功执行此插入：

```
insert into myschema.STATUS_CONTRATO s(
  s.STC_ID, s.CTB_CONTRATO, s.STC_DATA, s.STC_OBSERVACAO
)values(
  0, 10, SYSDATE, 'Inserting by hand works'
); 
```

但是，当我尝试使用 EF 插入时，我得到了这个异常：

```
System.Data.UpdateException: An error occurred while updating the entries. 
See the inner exception for details. ---> Oracle.DataAccess.Client.OracleException: 
ORA-01400: cannot insert NULL into ("MYSCHEMA"."STATUS_CONTRATO"."STC_ID")
ORA-06512: at line 4 
```

我正在使用此代码插入

```
STATUS_CONTRATO statusContrato = new STATUS_CONTRATO() {
    STC_ID = 0,
    CTB_CONTRATO = codContrato,
    STC_DATA = DateTime.Today,
    STC_OBSERVACAO = observacao
};
ent.STATUS_CONTRATO.AddObject(statusContrato);
ent.SaveChanges(); 
```

我正在使用 VS2010、Oracle 11g（CentOS 服务器）、ODP.NET 客户端 11.2.0.3.0 生产、.NET Framework 4.0、EF 4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:25:22.397

检查这个：[http ://www.oracle.com/technetwork/issue-archive/2011/11-sep/o51odt-453447.html](http://www.oracle.com/technetwork/issue-archive/2011/11-sep/o51odt-453447.html)

特别是“触发器和序列”部分

> 从工具菜单中，选择运行 SQL Plus 脚本。浏览到提取代码和脚本的位置，选择 triggers.sql 脚本，从列表中选择 HR 连接，然后单击 Run。每当为该值传入 NULL 时，脚本创建的 INSERTEMPLOYEES 触发器就会为 EMPLOYEE_ID 生成一个新序列........

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:25:45.257

你的代码有效，除了一个问题

```
ent.UNV_STATUS_CONTRATO.AddObject(statusContrato); 
```

是`UNV_STATUS_CONTRATO`另一张桌子吗？为什么不是

```
ent.STATUS_CONTRATO.AddObject(statusContrato); 
```

那应该工作得很好。

但是，您可能会发现最好从代码中获取序列值并将其应用到内存中的 ID 列，然后再保存更改。所以是这样的：

```
 public static int GetSequenceNextVal()
    {
        using (YourEntities entities = new YourEntities ())
        {
            var sql = "select myschema.SEQ_STATUS_ID.NEXTVAL from dual";
            var qry = entities.ExecuteStoreQuery<decimal>(sql);
            return (int)qry.First();
        }
    } 
```

然后你之前调用那个方法`SaveChanges()`。

就个人而言，我更喜欢以这种方式处理它，以便我的内存中实体也具有正确的 ID，而不是只有 0，或者必须立即查询它等等。

此外，[这里](http://www.oracle.com/technetwork/issue-archive/2011/11-sep/o51odt-453447.html)描述的触发器和序列下的方法可以将实体的 PK 连接到序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T11:50:08.097

您需要在 EF 映射中指定数据库不会为您生成密钥，并且 EF 应该使用您提供的密钥...

在以下线程中查看我的帖子： [https ://stackoverflow.com/a/18635325/1712367](https://stackoverflow.com/a/18635325/1712367)

# android - Android 服务错误“不幸的是服务已停止”但代码没有错误 LogCat 错误 = FATAL EXCEPTION: main

> ID：11972491
> 
> 赞同：0
> 
> 时间：2012-08-15T15:40:36.463
> 
> 标签：android, android-emulator, android-service, logcat, runtimeexception

我试图`Service`让它在使用代码中的 URI 启动时打开另一个应用程序。我的`BroadcastReciever`和 manifest 有正确的代码，所以我怀疑它是 this 中的东西`mainActivity`。

我正在使用 Eclipse 并且没有错误或警告，但是在手机上运行时出现以下错误：

> 不幸的是 anyConnectService 已停止

LogCat 的第一个错误如下：

```
FATAL EXCEPTION MAIN
java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.anyconnect/com.anyconnectservice,MainActivity} 
```

请查看以下代码并提供解决方案。

谢谢

```
public abstract class MainActivity extends Service
{
    @override
    public void onCreate()
    {
        super.onCreate();
        Toast.makeText(this, “Service created”,Toast.LENGTH_LONG).show();

        Uri anyConnectUri = Uri.parse(“anyconnect://connect/name= TestVPN”);
        Intent arg0 = new Intent(Intent.ACTION_VIEW, anyConnectUri);
        this.startActivity(arg0);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:09:39.217

那不应该是（否`abstract`）：

```
public class MainActivity extends Service
{
    @override
    public void onCreate()
    {
        super.onCreate();
        Toast.makeText(this, “Service created”,Toast.LENGTH_LONG).show();

        Uri anyConnectUri = Uri.parse(“anyconnect://connect/name= TestVPN”);
        Intent arg0 = new Intent(Intent.ACTION_VIEW, anyConnectUri);
        this.startActivity(arg0);
    }
} 
```

尽管您可能希望更改类的名称以更好地反映其用途，因为这是作为服务而不是活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:44:36.180

我想你应该设置组件：

```
intent.setComponent(new ComponentName("com.package.address","com.package.address.MainActivity")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:46:50.657

您正在调用一个 Activity，该 Activity 可以`VIEW`包含您放入 Intent 中的数据内容。

但是，如果您没有安装任何侦听类型消息`Intent.ACTION_VIEW`并接受 Uri 的应用程序，那么该应用程序很可能会抛出异常。

根据您的描述：`service to open **another app**`。
好吧，似乎找不到“另一个应用程序”。

# r - R使用system()将数据帧传递给另一个程序

> ID：11972496
> 
> 赞同：5
> 
> 时间：2012-08-15T15:40:42.610
> 
> 标签：r, input, stdin

我有一个数据框，我使用`system()`. 在当前设置中，我首先将数据框的内容写入文本文件，然后让`system()`命令查找创建的文本文件。

```
df1 <- runif(20)
write(df1, file="file1.txt")
system("myprogram file1.txt") 
```

我有两个问题：

1）有没有办法直接传递数据框而不编写文本文件？

2）如果没有，有没有办法将内存中的数据作为文本格式的实体传递而不将文件写入磁盘？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:55:17.433

您可以写入任何 R 调用的连接，包括网络套接字。

因此，进程 A 可以写入网络，而进程 B 可以在不涉及任何磁盘文件的情况下读取它，请参阅`help(connections)`“示例”部分中的工作示例。

您在这里的一般主题是序列化，而 R 会为您做到这一点。您还可以使用对有关数据结构的元数据进行编码的工具将数据以这种方式传递给其他程序，例如 Google 的协议缓冲区（[RProtoBuf](http://cran.r-project.org/package=RProtoBuf)包在 R 中支持）。

# cakephp - CAKEPHP 多模型字段条件

> ID：11972497
> 
> 赞同：0
> 
> 时间：2012-08-15T15:40:44.853
> 
> 标签：cakephp, find, cakephp-2.0, models

我有一个带有与之关联的标签和菜单项的文章模型。我想显示具有特定 MenuItem id 的文章。

当对模型执行查找操作时，它会返回（“字段列表”中的未知列“MenuItem.id”）错误。

我知道我做错了什么。

文章型号：

```
 public $hasAndBelongsToMany = array(
    'Tag' => array(
        'className' => 'Tag',
        'joinTable' => 'articles_tags',
        'foreignKey' => 'article_id',
        'associationForeignKey' => 'tag_id'
    ),
    'MenuItem' => array(
        'className' => 'MenuItem',
        'joinTable' => 'menu_items_articles',
        'foreignKey' => 'article_id',
        'associationForeignKey' => 'menu_item_id',
        'unique' => 'keepExisting'
    )
); 
```

文章控制者：

```
 $allArticles = $this->Article->find('all',
array(
     'fields' => array('MenuItem.id','Article.id','Article.name'),
     'conditions'=>array('Article.content_type'=>'blog','MenuItem.id'=>7),
     'recursive'=>2
 )
 );

 debug($allArticles); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:26:30.463

尝试这个 ：

```
$this->Article->Behaviors->attach('Containable');

$allArticles = $this->Article->find('all', 
    array('contain' => 'MenuItem.id'),
          'fields' => array('Article.id','Article.name'),
          'conditions'=>array('Article.id'=>4),
          )
     );                           

debug($allArticles); 
```

# java - Spring/AOP 建议随机失败

> ID：11972503
> 
> 赞同：0
> 
> 时间：2012-08-15T15:41:20.560
> 
> 标签：java, spring, aop, spring-aop

我从两个方面建议了一些方法，一个是使用 spring AOP 支持，另一个是`BeanPostProcessor`（`MethodValidationPostProcessor`特别）建议所有带有`@Validation`注释的方法。在我的单元测试中，我试图通过破坏方法契约来强制抛出错误，但有时验证已经到位（上述后处理器强加的建议），有时不起作用。有没有人经历过类似的事情。

这是我正在尝试做的一小部分：

方面代码：

```
@Aspect
@Component
public final class LoggingAspect {
    @Before(value = "execution(public * * (..)) && @annotation(loggable)",
    argNames = "joinPoint, loggable")
    public void before(JoinPoint joinPoint, Loggable loggable) {
         //logging here... 
    }
} 
```

注释（可记录代码）

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Loggable {...} 
```

使用@Validated 注解注解的接口（这里是相关信息的[链接）。](http://hillert.blogspot.com/2011/12/method-validation-with-hibernate.html)

```
@Validated
public interface Dao<T, K> {
    T findById(@NotNull K id);
    T persist(@NotNull T object);
} 
```

实现此接口的基类： public abstract class BaseDao implements DAO { @Loggable public T persist(T object){...} }

以及具有特定行为的子类： public final class UserDao extends BaseDao { @Loggable public T findById(User object){...} }

最后春天的背景是这样的

```
<aop:aspectj-autoproxy/>
<context:annotation-config/>
<context:component-scan base-package="com.my.package"/>
<bean id="validator"
  class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>
<bean class="org.springframework.validation.beanvalidation.MethodValidationPostProcessor"/> 
```

我正在通过以 null 作为参数调用这两种方法来进行测试，但在某些情况下，我收到了一个`IllegalArgumentException: attempt to create saveOrUpdate event with null entity`而不是`MethodConstraintViolationException`应该由 the instead 提出的，`MethodValidationInterceptor`它建议/拦截 @Validated 注释接口的所有公共方法。

**编辑**：我正在使用 spring 3.1、Hibernate Validator 4.2（根据 spring 的要求）和 aspectj 1.7。

**编辑 2**：我对测试代码进行了更多挖掘，发现与 MethodValidationPostProcessor 或 MethodValidationInterceptor 相关的一些奇怪的东西。我在测试期间禁用了 aop-autoproxy 并删除了 LoggerAspect，但仍然存在一些问题，即在某些情况下验证导致了我的预期，在其他一些情况下，即使它应该失败 MethodValidationInterceptor 或 MethodValidator 失败捕获调用中的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:00:56.607

挖掘我发现问题与我放置注释的位置有关。带来不便敬请谅解。

# webkit - 为什么（我的）WebKit 中没有“显示页面源代码”？

> ID：11972508
> 
> 赞同：8
> 
> 时间：2012-08-15T15:41:52.697
> 
> 标签：webkit

我已经为 Mac OS 下载了 v. 537.6+ 的 WebKit，并在 10.8 上运行它。（这里没有编程，只是作为一个寻找 WebKit 网络检查器的网络开发人员。）一切都很好，除了“开发”菜单中的“显示页面源”选项在我最常用的时候是灰色的，我不能找到任何方法来启用它。我很困惑——我还需要做些什么来启用它吗？还有其他事情发生吗？这是应该的吗？

### 开发者菜单

![在此处输入图像描述](../Images/57ad52559e448d5a77cc23a1bb7caf80.png)

### 上下文菜单：

![在此处输入图像描述](../Images/dc6421893965e9df1c51049ff3a40298.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T07:45:05.830

您可以启用[WebInspector](http://trac.webkit.org/wiki/WebInspector)来查看源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T14:27:47.383

WebKit 不是一个完整的浏览器——只是一个渲染引擎。通常，诸如“查看源代码”、后退/前进按钮、地址栏、首选项菜单等的东西是在 WebKit 之外的浏览器级别实现的。然而，WebKit 可能为测试目的提供了这些的最低实现，这可能不包括“视图源”（我可以想象这对于测试来说并不是真正必要的）。

如果你想玩一个完整的浏览器，你不能编译所有的 Safari，但你可以尝试编译 Chromium 来代替它提供所有这些东西。但是请注意，Chromium 现在使用 Blink 而不是 WebKit。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-18T14:52:01.210

您拥有的 webkit 是一个非常古老的 webkit。我已经尝试下载它来帮助您解决问题，但它甚至无法在 OSX 10.8.3 上运行。你总是可以在这里获得当前最新的 WebKit 版本：[http](http://www.webkit.org) ://www.webkit.org [编辑：我看到这个问题是在 2012 年提出的，所以这可以解释为什么它是一个旧版本。]

但是，您说您是“正在寻找 WebKit Web 检查器的 Web 开发人员”并且您正在运行 OSX 10.8。在这种情况下，您也许可以只使用 Mac 上已有的标准 Safari。您需要执行以下操作以显示“开发”菜单。然后你就有了你期望的“页面源”项目。

1.  启动 Safari。
2.  通过从菜单中选择“Safari，首选项”打开 Safari 的首选项。
3.  单击标有“高级”标签。
4.  在“在菜单栏中显示开发菜单”旁边打勾。</li>

# java - 解释数据字符串并将其插入到 Java 中正确列位置的 JTable 中

> ID：11972513
> 
> 赞同：3
> 
> 时间：2012-08-15T15:42:03.633
> 
> 标签：java, php, mysql, swing, jtable

由于可能发生的所有问题以及我认为它可能带来的安全风险，我担心我的 Java 客户端直接连接到 MySQL 服务器。例如有人能够反编译文件并获取数据库的登录详细信息。尽管它很漂亮，但我不敢冒险。我编写了一个 PHP 脚本来回显客户端可以解释的数据。PHP 脚本是连接到 MySQL 的。

很简单：Java->PHP->MySQL

我将提供 MySQL 结构的屏幕截图，以便您在尝试将其可视化时更好地理解。 ![在此处输入图像描述](../Images/0e0c21f42f41071eb7cd43a2d59d36c8.png) ![http://i.imgur.com/5EViC.png](../Images/1de8b9a06d8432e2e5f9cd85e3fe0df5.png) ![在此处输入图像描述](../Images/185ba13533f0fa9ead5de3b8b5178352.png) ![在此处输入图像描述](../Images/82652f4a5d88952ea1a465607de90f33.png)

> id：可能是 tid/sid
> 
> tid：教师ID，用于链接教师
> 
> sid：学生id，用于链接学生
> 
> gid：年级编号
> 
> 援助：作业编号
> 
> gp：获得积分
> 
> pp：可能的点

评分行是针对每个学生的每个作业。因此，例如，如果一位教师将 30 名学生分配给一项作业，那么评分选项卡中将有 30 行，而作业中将有 1 行。不允许重复的分配名称。

当客户端请求数据时，我只使用缓冲的阅读器和 URL 来下载字符串。这是客户端收到分配名称时的示例输出。

```
Test Assignment;Secondary Test Assignment; 
```

这是下载列名后客户端的样子： ![在此处输入图像描述](../Images/f364729063b603a2a01eb5c785aec42d.png)

如您所见，前两列默认情况下存在，最后两列是分配名称。

我希望表中的每一行都是学生。但是，这就是我的麻烦所在。我正在尝试从分级中接收正确的数据。我不知道我要怎么做。我有大约 3 个月的 Java 经验，所以你绝对可以称我为新手。

**这是我的想法，但我认为这不是一个好主意：** *搜索所有列名并将值插入到分配名称匹配的那一行中的正确列中。*

我不知道那会有多难。我猜开发swing的好人为此做了一些事情，但我找不到任何资源。

有人对在这种情况下该怎么做有任何建议吗？我感到失落。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T16:52:13.860

至于保护您的数据库，我建议创建一个只能执行存储过程的锁定用户 - 这样您就不必担心有人反编译您的代码。他们只能通过您的代码访问他们可以访问的内容。 这是有关如何执行此操作[的教程。](http://www.webdeveloper.com/forum/showthread.php?t=232496)

就您的主要问题而言，我建议您在 SQL 查询中完成所有数据收集/排序。如果您在 中这样做`JTable`，您最终会混合您的模型和视图（有关更多详细信息，请参阅[MVC](http://www.webdeveloper.com/forum/showthread.php?t=232496)）。

所以本质上你希望你的数据以这种形式从查询中返回：

`Student; Student Name; Test Assignment; Secondary Test Assignment`

意思是，

1.  您需要在成绩表和作业表之间添加关系（很可能添加`aid`到`grading`表中）
2.  你需要想出一个稍微复杂一点的 SQL 查询——像这样：

    `Select g.sid, g.name, a.name from ASSIGNMENTS a join GRADING g on a.aid = g.aid where g.tid = 123123 order by g.name`

3.  根据数据创建一个二维数组并将其放入表中（如果您仍在使用 PHP 界面，则需要拆分分隔符上的字符串以创建一个二维数组。）

    `((DefaultTableModel)table.getModel).setDataVector(data, columnNames);`

**编辑** 如果您确信您只想在行中搜索一个值，然后更新您找到的行中的一列 - 这应该会让您朝着正确的方向前进：

```
Integer searchStudentID = 123123;
int searchColumn = 0;
String updateValue = "Value";
int updateColumn = 3;

//Look through the table for the right row
Vector<Vector<Object>> data = ((DefaultTableModel)table.getModel()).getDataVector();
for(Vector<Object> row : data){
    // If on the right row, update it
    if(row.elementAt(searchColumn).equals(searchStudentID)){
        row.setElementAt(updateValue, updateColumn);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:45:23.740

让我们从 Java 客户端开始。这是一些从 php 页面读取并从中创建的代码`JTable`。（实际上它是从 a 中读取的`String`，但您可以轻松更改代码以匹配您的实际情况，请参阅代码中的注释）。

```
public static void main(String[] args) throws Exception {
    String receivedFromPHP = "Student ID;Student Name;Test Assignment;Secondary Test Assignment;\n"
            + "1;Luc;Test assignment 1;Secondary Test assignment 1;\n"
            + "2;Vador;Test assignment 2;Secondary Test assignment 2;";

    BufferedReader br = new BufferedReader(new StringReader(receivedFromPHP));
    // For real: br = new BufferedReader(new InputStreamReader(new URL("http://localhost/yourPhpPage.php").openStream()));

    DefaultTableModel dtm = new DefaultTableModel();

    String line;
    boolean headersReceived = false;
    while ((line = br.readLine()) != null) {
        String[] columns = line.split(";");
        if (!headersReceived) {

            dtm.setColumnIdentifiers(columns);
            headersReceived = true;
        } else {
            dtm.addRow(columns);
        }
    }

    JTable table = new JTable(dtm);
    JFrame f = new JFrame();
    f.add(new JScrollPane(table));
    f.pack();
    f.setLocationRelativeTo(null);
    f.setVisible(true);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
} 
```

直到现在都没有什么困难的。真正的事情是使用正确的查询编写 php 页面。显然，你更清楚你希望你的页面输出什么，但我想你会这样做：

```
<?php

$mysqli = new mysqli("localhost", "my_user", "my_password", "pinkfluf_dvonx");

/* check connection */
if ($mysqli->connect_errno) {
    printf("Connect failed: %s\n", $mysqli->connect_error);
    exit();
}

/* Select queries return a resultset */
if ($result = $mysqli->query("SELECT Name FROM City LIMIT 10")) {
    printf("Select returned %d rows.\n", $result->num_rows);

    /* free result set */
    $result->close();
}

/* If we have to retrieve large amount of data we use MYSQLI_USE_RESULT */
if ($result = $mysqli->query('SELECT u.id AS "Student ID", u.username AS "Student Name", ... FROM members u, grading g, assignments a WHERE ...')) {

    while($row = $result->fetch_array(MYSQLI_NUM)) {
        for ($i=0; $i<sizeof($row); $i++) {
            echo $row[$i] . ";";
        }
        echo "\n";
    }

    $result->close();
}

$mysqli->close();
?> 
```

当然，我在这里给出的代码是非常近似的（鉴于我可以从您的问题中提取的信息），所以可以肯定的是，您需要调整代码以使其按您的意愿工作，但我希望它可以帮助你开始了（继续前进:)）。

# regex - 如何使用 RegEx 查找文本并替换它们

> ID：11972529
> 
> 赞同：0
> 
> 时间：2012-08-15T15:42:50.347
> 
> 标签：regex, grep, wildcard, textwrangler

以下是我长文的摘录：

```
As a young researcher, he is required:
\n ÷ to read at least three theses\n ÷ to meet his tutor or supervisor 
once a week\n ÷ to join seminars\n 
```

现在我想找到任何以 开头`÷`和结尾的块，`\n`并替换`÷`为`÷<font color="blue">`和`\n`。`</font>\n`因此，例如，我上面的摘录将如下所示：

```
As a young researcher, he is required:
\n ÷<font color="blue"> to read at least three theses</font>\n ÷<font color="blue"> 
to meet his tutor or supervisor once a week</font>\n ÷<font color="blue"> to join seminars</font>\n 
```

到目前为止，我一直在 TextWrangler 中使用这些 Grep 来查找和替换：

```
(÷[^ \t/<>]*?).*?([^ \t/<>]*?\\n)

<font color="blue">\1\2</font>\3 
```

已成功找到所需的文本块，但替换不像我预期的那样工作。

我正在使用 TextWrangler，但可以访问 BBEdit 或 Notepad++。

你能帮我解决这个问题吗？非常感谢你。

* * *

**更新**

感谢 DesertEagle，我已经找到了解决方案。这是代码：

```
÷([^\\n]+)\\n
÷<font color="blue">\1</font>\\n 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:52:26.830

虽然我手头没有 textwrangler，但这应该适合你 [1]

*搜索* `/÷([^\n]+)\n/`

**编辑** textwrangler 的正确语法是 `÷([^\\n]+)\\n`

*代替* `÷<font color="blue">\1</font>\n`

[1] please ensure proper escaping for your engine

# php - php var_dump 未完成 XML

> ID：11972531
> 
> 赞同：1
> 
> 时间：2012-08-15T15:42:55.993
> 
> 标签：php, var-dump

所以我有一个作为 curl_exec 的返回值创建的 xml 文件。问题是它只输出前 2514 个字符，然后继续...

为什么是这样？我有什么办法可以告诉 var_dump() 给我一切吗？

这是我的代码片段：

```
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, "$xml_data");
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 0);
$file_contents = curl_exec($ch);
curl_close($ch);

var_dump($file_contents); 
```

谢谢大家

编辑：当我使用网络浏览器时，这甚至是真的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T15:44:01.483

如果您安装了 xdebug，它将截断您的 var_dumps（以帮助防止大量调试信息被打印到屏幕上......可能会使您的浏览器崩溃）。阅读[http://xdebug.org/docs/display](http://xdebug.org/docs/display)以了解会影响此的设置。

> 有许多设置可以控制 Xdebug 修改后的 var_dump() 函数的输出：xdebug.var_display_max_children、xdebug.var_display_max_data 和 xdebug.var_display_max_depth。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:45:21.843

在浏览器中使用“查看源代码”选项可以解决您的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:07:50.397

它不会。尝试使用 echo "".print_r($yourData);

甚至更好的是，将大数据的输出写入文件！

# if-statement - 在工作之前和之后设置标志

> ID：11972532
> 
> 赞同：2
> 
> 时间：2012-08-15T15:42:56.120
> 
> 标签：if-statement, refactoring

有时我发现自己在做以下事情：

```
if (some_condition)
    set_flag(true)

do_some_work();
// more work ...

if (some_condition)
    set_flag(false) 
```

它经常感觉被黑客攻击在一起。有没有办法可以重构它以使其更清洁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:05:01.313

在我看来，我认为建议的伪代码很好，原因如下：
**1.**检查标志而不是再次检查条件应该更有效
**2.**额外的抽象/重构可能只会导致更多的头痛似乎**是非增值**工作，可以更好地在其他地方使用
**3.****如果**标志具有有意义的名称（或在这种情况下为方法名称），则使用标志通常是可读的

# asp.net-mvc-4 - 当我尝试归档 Bing Search API 的结果时，为什么这个控制器会加倍插入？

> ID：11972536
> 
> 赞同：0
> 
> 时间：2012-08-15T15:43:19.723
> 
> 标签：asp.net-mvc-4, bing-api, asynccontroller

我正在尝试将我的搜索结果归档为一个字词

1.  在异步控制器中使用 Bing API
2.  使用实体框架将它们插入数据库

使用 Bing API 并将它们插入到使用实体框架的数据库中。无论出于何种原因，它都会返回 50 个结果，但随后会将 100 个结果输入数据库。

我的控制器代码：

```
public class DHWebServicesController : AsyncController
    {
        //
        // GET: /WebService/

        private DHContext context = new DHContext();

        [HttpPost]
        public void RunReportSetAsync(int id)
        {
            int iTotalCount = 1;
            AsyncManager.OutstandingOperations.Increment(iTotalCount);
            if (!context.DHSearchResults.Any(xx => xx.CityMarketComboRunID == id))
            {

                string strBingSearchUri = @ConfigurationManager.AppSettings["BingSearchURI"];
                string strBingAccountKey = @ConfigurationManager.AppSettings["BingAccountKey"];
                string strBingUserAccountKey = @ConfigurationManager.AppSettings["BingUserAccountKey"];
                CityMarketComboRun cityMarketComboRun = context.CityMarketComboRuns.Include(xx => xx.CityMarketCombo).Include(xx => xx.CityMarketCombo.City).First(xx => xx.CityMarketComboRunID == id);

                var bingContainer = new Bing.BingSearchContainer(new Uri(strBingSearchUri));
                bingContainer.Credentials = new NetworkCredential(strBingUserAccountKey, strBingAccountKey);
                // now we can build the query

                Keyword keyword = context.Keywords.First();
                var bingWebQuery = bingContainer.Web(keyword.Name, "en-US", "Moderate", cityMarketComboRun.CityMarketCombo.City.Latitude, cityMarketComboRun.CityMarketCombo.City.Longitude, null, null, null);
                var bingWebResults = bingWebQuery.Execute();

                context.Configuration.AutoDetectChangesEnabled = false;

                int i = 1;
                DHSearchResult dhSearchResult = new DHSearchResult();
                List<DHSearchResult> lst = new  List<DHSearchResult>();
                var webResults = bingWebResults.ToList();
                foreach (var  result in webResults)
                {
                    dhSearchResult = new DHSearchResult();
                    dhSearchResult.BingID = result.ID;
                    dhSearchResult.CityMarketComboRunID = id;
                    dhSearchResult.Description = result.Description;
                    dhSearchResult.DisplayUrl = result.DisplayUrl;
                    dhSearchResult.KeywordID = keyword.KeywordID;
                    dhSearchResult.Created = DateTime.Now;
                    dhSearchResult.Modified = DateTime.Now;
                    dhSearchResult.Title = result.Title;
                    dhSearchResult.Url = result.Url;
                    dhSearchResult.Ordinal = i;
                    lst.Add(dhSearchResult);
                    i++;
                }

                foreach (DHSearchResult c in lst)
                {
                    context.DHSearchResults.Add(c);
                    context.SaveChanges();

                }
                AsyncManager.Parameters["message"] = "The total number of results was "+lst.Count+".  And there are " + context.DHSearchResults.Count().ToString();
            }
            else
            {
                AsyncManager.Parameters["message"] = "You have already run this report";
            }
            AsyncManager.OutstandingOperations.Decrement(iTotalCount);
        }
        public string RunReportSetCompleted(string message)
        {
            string str = message;
            return str;
        }

    } 
```

这是我从我的 asp.net mvc 4 页面调用它的方式。

```
@Ajax.ActionLink("Run Report", "GatherKeywordsFromBing", "DHWebServices", 
                new { id=item.CityMarketComboRunID}, 
                new AjaxOptions { OnSuccess = "ShowNotifier();", UpdateTargetId = "TopNotifierMessage", HttpMethod = "POST", InsertionMode = InsertionMode.Replace, LoadingElementId = strCityMarketComboProgressID, LoadingElementDuration = 1000 }, 
                new { @class = "ViewLink" }) 
            <span class="ProgressIndicator" id="@strCityMarketComboProgressID"><img src="@Url.Content("~/Content/img/SmallBall.gif")" alt="loading" /></span> 
```

不管出于什么原因

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:49:53.167

尝试只保存一次：

```
foreach (DHSearchResult c in lst)
{
    context.DHSearchResults.Add(c);
}
context.SaveChanges(); 
```

此外，您的代码中没有任何异步内容，因此没有必要使用异步控制器。它不仅不会改善任何事情，而且可能会使事情变得更糟。

# c# - 如何将接口传递给接受 C# 中 ITestCase 类型接口的方法？

> ID：11972538
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:43:31.720
> 
> 标签：c#, visual-studio-2010, tfs, microsoft-test-manager

我有一个调用 add 方法的 TestSuite（TFS 对象）对象。此 add 方法接受 ITestCase 作为参数。此 ITestCase 接口具有以下链接中描述的不同方法和属性：

[http://msdn.microsoft.com/en-us/library/dd984690](http://msdn.microsoft.com/en-us/library/dd984690)

现在我想传递 ITestCase 对象，它实现了上面链接中提到的一些方法。

```
 var ts = testPlan.TestSuites[i];
   var testCase = ts.TestCases.Add(<ITestCase testcase>); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:56:35.593

假设您实际上想要创建一个真实的测试用例，而不是单元测试（或类似）中的模拟，那么这篇博客文章有一个代码示例，它创建了一个：[http ://www.ewaldhofman.nl/post/ 2009/12/11/TFS-SDK-2010-e28093-Part-5-e28093-Create-a-new-Test-Case-work-item.aspx](http://www.ewaldhofman.nl/post/2009/12/11/TFS-SDK-2010-e28093-Part-5-e28093-Create-a-new-Test-Case-work-item.aspx)。

以下是一些基于上述博客条目创建新测试用例的代码，然后将其添加到现有测试套件（称为“ExampleSuite2”，位于名为“TfsVersioning 测试计划”的测试计划中）：

```
var tfsUri = new Uri("http://localhost:8080/tfs/");
var tfsConfigServer = new TfsConfigurationServer(tfsUri, new UICredentialsProvider());
tfsConfigServer.EnsureAuthenticated();

var projCollectionNode = tfsConfigServer.CatalogNode.QueryChildren(new[] {CatalogResourceTypes.ProjectCollection}, false,                                                               CatalogQueryOptions.None).FirstOrDefault();
var collectionId = new Guid(projCollectionNode.Resource.Properties["InstanceId"]);
var projCollection = tfsConfigServer.GetTeamProjectCollection(collectionId);

ITestManagementService tms = projCollection.GetService<ITestManagementService>();
var project = tms.GetTeamProject("TfsVersioning");

var testCase = project.TestCases.Create();
testCase.Title = "Browse my blog";
var navigateToSiteStep = testCase.CreateTestStep();
navigateToSiteStep.Title = "Navigate to \"http://www.ewaldhofman.nl\"";
testCase.Actions.Add(navigateToSiteStep);

var clickOnFirstPostStep = testCase.CreateTestStep();
clickOnFirstPostStep.Title = "Click on the first post in the summary";
clickOnFirstPostStep.ExpectedResult = "The details of the post are visible";
testCase.Actions.Add(clickOnFirstPostStep);
testCase.Save();

//Add test case to an existing test suite
var plans = project.TestPlans.Query("SELECT * FROM TestPlan where PlanName = 'TfsVersioning Test Plan'");
var plan = plans.First();
var firstMatchingSuite = project.TestSuites.Query("SELECT * FROM TestSuite where Title = 'ExampleSuite2'").First();
((IStaticTestSuite)firstMatchingSuite).Entries.Add(testCase);
plan.Save(); 
```

运行此代码后，新的测试用例出现在 MTM 中，与目标测试套件相关联。

# javascript - JQuery将2个div的值添加到第三个div

> ID：11972541
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:43:49.953
> 
> 标签：javascript, jquery

我有 3 个 div，每个都有数字...

```
<div id="one">1</div>

<div id="two">5</div>

<div id="total">0</div> 
```

例如，我需要做的是：

如果单击#one，则添加#one 和#two 的值并在#total 上更新它

因此，在上述情况下，总数将如下所示：

```
<div id="total">6</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:48:59.513

HTML：

```
<div id="one">1</div>

<div id="two">5</div>

<div id="total">0</div>

<input id="btn-calculate" type="button" value="Calculate" /> 
```

JavaScript：

```
var one = document.getElementById('one'),
    two = document.getElementById('two'),
    total = document.getElementById('total');
document.getElementById('btn-calculate').onclick = function() {
    total.innerHTML = parseInt(one.innerHTML) + parseInt(two.innerHTML);
}; 
```

[**演示**](http://jsfiddle.net/f0t0n/3fB3R/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:46:41.727

试试这个，

**[现场演示](http://jsfiddle.net/rajaadil/jjVBW/1/)**

```
$("#one").click(function() {
   $('#total').text(parseFloat($('#one').text()) + parseFloat($('#two').text()));
});​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T15:47:29.557

```
​$("#one")​.click(function(){
    $("#total").html(parseInt($(this).text()) + parseInt($("#two").text()))
})​ 
```

[http://jsfiddle.net/daniilr/G4Snm/](http://jsfiddle.net/daniilr/G4Snm/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-15T15:48:35.337

```
$('#one').click(function(){
$("#total").text(
    parseFloat($(this).text()) + 
    parseFloat($("#two").text())
);
}); 
```

# javascript - 如何覆盖javascript对象数组中的元素

> ID：11972549
> 
> 赞同：1
> 
> 时间：2012-08-15T15:44:22.853
> 
> 标签：javascript, debugging, variables, object, syntax

我想在 javascript 中执行以下操作，但这里有一些我不理解的语法：

```
var theObj = { foo: val1, bar: val2 }
if ( condition ) {
  theObj[foo] = newVal
  return theObj // returns { foo: val1, bar: newVal } 
}
return theObj // returns { foo: val1, bar: val2 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:46:04.750

您拥有的不是*对象数组*，而是*对象字面*量。通常，它的属性将被访问为`theObj.property`，但 JavaScript 提供了一种替代语法，`theObj["property"]`当您需要对属性名称（如 ）执行字符串操作等操作时`theObj["property_" + numberVar]`，或对点表示法中无效的属性（如数字属性`theObj[12] = "twelve"`）进行操作时

如果您通过 访问属性`[]`，则需要引用字符串`["foo"]`，否则解析器将寻找一个名为的变量以`foo`插入其中。但是，使用点表示法可以更好地访问这个简单的字符串属性：

```
if ( condition ) {
  theObj.foo = newVal
  return theObj // returns { foo: val1, bar: newVal } 
} 
```

# jquery - 打开带有动态链接的 jQuery UI 对话框

> ID：11972551
> 
> 赞同：0
> 
> 时间：2012-08-15T15:44:34.617
> 
> 标签：jquery, jquery-ui

我有根据数据库中的内容动态生成的链接。

链接最终看起来像

```
<ul>
    <li><a href="/Updates/LoadArticle?NewsId=3" id="article">Article 3</a></li>
    <li><a href="/Updates/LoadArticle?NewsId=2" id="article">Article 2</a></li>
    <li><a href="/Updates/LoadArticle?NewsId=1" id="article">Article 1</a></li>
</ul> 
```

我拼凑的脚本是

```
$(document).ready(function () {

        $("#article").click(function (e) {
            InitializeDialog($("#news"), $(this).attr("href"));
            e.preventDefault();
            $("#news").dialog("open");
         });

        //Method to Initialize the DialogBox
        function InitializeDialog($element, page) {

            $element.dialog({
                                autoOpen: true,
                                width: 400,
                                resizable: false,
                                draggable: true,
                                title: "Update",
                                modal: true,
                                show: 'fold',
                                closeText: 'x',
                                dialogClass: 'alert',
                                closeOnEscape: true,
                                position: "center",
                                open: function (event, ui) {
                                    $element.load(page);
                                },

                                close: function () { 
                                    $(this).dialog('close');
                                }
              });
        }
    }); 
```

这适用于列表中的第一篇文章 - 对话框打开，但其他文章在单独的页面中打开。我假设这是因为 id 不是唯一的。

我的问题更多的是如何为任何 id（比如 article1、article2 等）创建一个通用的 jQuery 函数。

我已经接受了大约 20 分钟的 jQuery 培训，所以我一直在摸索着看哪里。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:47:08.453

> 这适用于列表中的第一篇文章 - 对话框打开，但其他文章在单独的页面中打开。我假设这是因为 id 不是唯一的。

你是对的，拥有 2 个或更多具有相同 ID 的元素是无效的 HTML，会导致你出现各种问题。

删除`id`属性并改用`class`属性：

```
<ul>
    <li><a href="/Updates/LoadArticle?NewsId=3" class="article">Article 3</a></li>
    <li><a href="/Updates/LoadArticle?NewsId=2" class="article">Article 2</a></li>
    <li><a href="/Updates/LoadArticle?NewsId=1" class="article">Article 1</a></li>
</ul> 
```

然后代替：

```
$("#article").click() 
```

采用：

```
$(".article").click() 
```

# emacs - 如何修复 Emacs sass-mode 中的奇怪缩进行为

> ID：11972553
> 
> 赞同：0
> 
> 时间：2012-08-15T15:44:36.583
> 
> 标签：emacs, sass

这个问题（[https://github.com/nex3/sass-mode/issues/5](https://github.com/nex3/sass-mode/issues/5) ）已经解释了我想说的，请看一下。有什么办法可以解决。

> 当我按下退格键时，例如在 cj 之后，它总是更深一层而不是同一层，除了控制缓冲区给出消息“标记集”之外，什么都没有发生。当我检查时，我看到它绑定到 haml-electric-backspace。因此，我可以创建新行并将光标移动到与最后一行相同的缩进级别的唯一两种方法是 ret tab tab 或 cj 后跟 cb cb 或 tab tab。我认为 cj 应该默认为相同的级别，并且退格应该具有默认的 emacs 行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-26T07:44:56.477

我发现了一堆 sass 模式的错误。

这是我保存在 .emacs 中的一些代码，可能会有所帮助：

```
(defconst sass-line-keywords
  '(("@\\(\\w+\\)"    0 font-lock-keyword-face sass-highlight-directive)
("/[/*].*"  0 font-lock-comment-face)
("[=+]\\w+" 0 font-lock-variable-name-face sass-highlight-script-after-match)
("!\\w+"    0 font-lock-variable-name-face sass-highlight-script-after-match)
(":\\w+"    0 font-lock-variable-name-face)
("\\w+\s*:" 0 font-lock-variable-name-face)
("\\(\\w+\\)\s*="  1 font-lock-variable-name-face sass-highlight-script-after-match)
("\\(:\\w+\\)\s*=" 1 font-lock-variable-name-face sass-highlight-script-after-match)
(".*"      sass-highlight-selector)))

(defconst sass-selector-font-lock-keywords
  '( ;; Attribute selectors (e.g. p[foo=bar])
("\\[\\([^]=]+\\)" (1 font-lock-variable-name-face)
 ("[~|$^*]?=\\([^]=]+\\)" nil nil (1 font-lock-string-face)))
("&"       0 font-lock-constant-face)
("\\.\\w+" 0 font-lock-type-face)
("#\\w+"   0 font-lock-keyword-face)
;; Pseudo-selectors, optionally with arguments (e.g. :first, :nth-child(12))
("\\(::?\\w+\\)" (1 font-lock-variable-name-face)
 ("(\\([^)]+\\))" nil nil (1 font-lock-string-face)))))
(defconst sass-non-block-openers
  '("^.*,$" ;; Continued selectors
"^ *@\\(extend\\|debug\\|warn\\|include\\|import\\)" ;; Single-line mixins
"^ *[$!]"     ;; Variables
".*[^\s-]+: [^\s-]" ;; a setting of some sort
)) 
```

我认为问题出在 sass-non-block-openers 上。对不起，我只是向你倾倒了一些代码。无论如何，希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:54:11.790

when finished, call RET, not C-j

backspace will step down level

everything okay AFAIS, no bug

# java - JSP内部函数打印

> ID：11972561
> 
> 赞同：0
> 
> 时间：2012-08-15T15:45:05.043
> 
> 标签：java, jsp, printing

JSP声明标签函数中的直接HTML打印应该合法吗？

```
<%! void recursivePaintLevels(List<String> things, int deepLevel){ %>
    <ul class="level-<%=deepLevel%>">   
         <% for (int i=0; i<things.size(); i++){ %>
             <li class="whatever">
                             //(...)
            </li>
         <% } %>
    </ul>
<% } %> 
```

然后在正常的 JSP 正文流中这样调用它：

```
 //(...)
 <% recursivePaintLevels(things, 1); %> 
```

我的意思是就像在一个方法中使用与隐式 out.println() 相同的普通 JSP 逻辑。对我来说它不起作用（Eclipse 说“语法错误，插入“最后”以完成 TryStatement'）但我不确定我的错误是否与它有关。

我也知道我应该使用 JSLT 和 EL，但这是我的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:01:49.213

不，这不合法。JSP 页面被有效地实现为一种执行页面内所有代码的大方法。在java中，你不能简单地插入嵌套在一个方法中的其他方法。

您的代码将生成如下内容：

```
public void _jspService(...) {
    ...
    void recursivePaintLevels(...) {
        ...    
    }
} 
```

这根本不是合法的java。

相反，您应该将代码推迟到与您的 Web 应用程序捆绑在一起的实用程序库类中。

您可能能够创建一个递归标记文件，我还没有尝试过。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-15T16:14:54.680

我相信这是非常合法和有效的，尽管这是一种不好的做法。我认为这里的问题是因为双引号`"level-<%=deepLevel%>"` 尝试使用

```
<% String str= "level-"+deepLevel; %> 
```

然后使用 `<ul class="<%=str%>">`.

或者干脆用 out.println 替换整行

**编辑**：

看来 jsp 中的方法体不应该有任何 scriptlet。我试图嵌入一个没有内容的scriptlet，并观察到生成的java文件在乞讨时添加了第一部分（从delcaration到scriptlet之前的内容），最后添加了方法的剩余部分（以及所有成员变量和其他方法声明成为此方法的一部分）。为提供错误答案而道歉（因为我注意到缓存 jsp 的行为）。

看起来 out.printltn 是这个问题的唯一解决方案

# windows - 如何让 Cygwin 准确读取我的 Windows 环境变量？

> ID：11972562
> 
> 赞同：12
> 
> 时间：2012-08-15T15:45:05.307
> 
> 标签：windows, cygwin, environment-variables

我正在使用带有最新版本 Cygwin 的 Windows XP。如果我在我的 Windows 系统中设置以下环境变量

```
JBOSS_HOME=C:/Program Files/jboss-4.2.3.GA 
```

然后启动 Cygwin，我无法切换到继承的 $JBOSS_HOME 目录。

```
$ cd $JBOSS_HOME
cygwin warning:
  MS-DOS style path detected: C:/Program
  Preferred POSIX equivalent is: /cygdrive/c/Program
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
-bash: cd: C:/Program: No such file or directory 
```

是否可以在 Windows 环境中定义我的系统变量一次，然后让 Cygwin 解释它，这样我就不会收到“没有这样的文件或目录”警告？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T17:41:11.587

你可以做两件事之一...

*   添加一个命令来转换 .bashrc 文件中的路径，就像这样......

`export JBOSS_HOME=$( cygpath "$JBOSS_HOME" )`

或者

*   引用时只需将变量放在引号之间，因为 Cygwin 理解 DOS 样式路径，即使它不喜欢它们。该命令对您失败的原因是路径中有一个空格，因此将其放在引号中将使路径被正确读取为一个参数...

`cd "$JBOSS_HOME"`

请注意，在这种情况下，您可能仍会收到相同的“cygwin 警告”。为了消除这种情况，您需要`nodosfilewarning`按照警告的建议添加到您的 CYGWIN var 中。你可以通过在你的 .bashrc 文件中添加它来做到这一点......

`export CYGWIN="${CYGWIN} nodosfilewarning"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-28T08:40:29.807

我正在使用带有 ShellED 插件的 Eclispse，

我得到了同样的通知，不知道准确的配置，

我只是将导出值添加到脚本中

```
'#!/bin/bash'

export CYGWIN="${CYGWIN} nodosfilewarning"

echo hello 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:50:19.293

这对我有用

```
$ SEVENZIP="C:/Program Files/7-Zip"

$ read < <(cd "$SEVENZIP"; pwd)

$ cd "$REPLY" 
```

# linux - Linux：死锁进程如何在顶部显示？

> ID：11972568
> 
> 赞同：1
> 
> 时间：2012-08-15T15:45:21.007
> 
> 标签：linux, process, deadlock

它是否会在列表的底部，因为它很可能会被阻止等待一些系统资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:01:32.453

这取决于阻塞死锁进程的方式。

假设它们被自旋锁阻塞，那么它们可能会出现在顶部输出的第一行。

另一方面，如果进程正在休眠（永远）等待资源，那么它们很可能不会出现在顶部输出的第一行中

# php - PHP&MySQL：合并更多行并将其放入数组中

> ID：11972569
> 
> 赞同：0
> 
> 时间：2012-08-15T15:45:22.967
> 
> 标签：php, mysql, arrays, lines

> **可能重复：**
> [带有逗号分隔值的 mysql](https://stackoverflow.com/questions/8075323/mysql-with-comma-separated-values)

我有两个包含更多行的表，如下所示：

```
1\. numberstable
    ---------------------------
    | number_id | number_name |
    ---------------------------
    |    1      |     one     |
    |    2      |     two     |
    |    3      |     three   |
    |    4      |     four    |
                .
                .
                .
    ---------------------------

2\. testtable
    -------------------------------
    | test_id | numbers | sthelse |
    -------------------------------
    |    1    | 2.4.5.6 | text1   |
    |    2    | 4.8.7.1 | text2   |
    |    3    | 2.7.8.5 | text3   |
    ------------------------------- 
```

首先，我想将表“testtable”中的所有三个“数字”行组合起来，得到如下结果：1.2.4.5.6.7.8，然后在下一个查询中排除它。此查询是“SELECT number_id, number_name FROM numberstable ORDER BY number_name”。排除后，我想只显示“testtable”中未使用的数字（9、10、11，...）。

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:55:05.967

如果您试图将 numberstable 与可测试相关联。我认为您最好添加另一个表，该表将这两个表与您具有类似模式的位置相关联

```
1\. numberstable
    ---------------------------
    | number_id | number_name |
    ---------------------------
    |    1      |     one     |
    |    2      |     two     |
    |    3      |     three   |
    |    4      |     four    |
                .
                .
                .
    ---------------------------

2\. testtable
    ---------------------
    | test_id | sthelse |
    ---------------------
    |    1    | text1   |
    |    2    | text2   |
    |    3    | text3   |
    --------------------

3\. numbersintesttable
    -----------------------
    | test_id | number_id |
    -----------------------
    |    1    | 2         |
    |    1    | 4         |
    |    1    | 5         |
    |    1    | 6         |
    |    2    | 4         |
    |    2    | 8         |
    |    2    | 7         |
    |    2    | 1         |
    ----------------------- 
```

因此，新表将是一个多对多连接表，您可以使用它通过使用您想要的连接类型（INNER、OUTER 等）在单个查询中获取所有需要的数据

# batch-file - 如何删除只有 4 个字符的文件？

> ID：11972572
> 
> 赞同：3
> 
> 时间：2012-08-15T15:45:28.050
> 
> 标签：batch-file, batch-processing

我使用 Windows 7，我想构建一个批处理文件来完成以下任务：

*`C:\images`删除目录中名称为4个字符的所有文件*。例如 1234.jpg 7123.jpg、8923.jpg、7812.jpg、1245.jpg、0067.jpg、0001.jpg、0010.jpg、0060.jpg 等。

那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:50:10.763

此解决方案将删除所有在点之前的名称部分有 4 个字符的文件，以及可能在点之前有较短部分的文件。

```
ERASE C:\images\????.* 
```

*   `?`代表任何字符（或有时根本没有字符，见下文）
*   `*`代表任何字符序列。

# 有哪些不同的 Windows 版本？

在 Windows 98 下（我有一种直觉，这对于不完全支持长 FAT 名称的“纯”DOS 版本也有效，包括 win95 和更早版本，可能还有 Windows Millennium），`?`仅代表一个字符。

根据@dbenham 的评论，我知道在更高版本的 Windows 中，它`?`代表 0 或 1 个字符。

# FAT 短名称呢？

现在是棘手的部分：带有前导点的名称（即第一个点之前的 0 个字符）呢？带有多个点的文件呢？

在执行任何操作之前，尾随点被剥离，因此扩展`abc.def.....`是`def`，其基是`abc`。

点位于短名称中的固定位置，即使对于没有扩展名的文件也存在。这就是`*.*`匹配所有文件的原因，即使是那些没有扩展名的文件。

前导点、多个点、超过 3 个字符的扩展和超过 8 个字符的基本（点之前）部分在短 FAT 名称（也称为 DOS 名称）中无效，因此长名称（在 Windows 下显示）的文件是其中一个将有一个虚构的短名称，看起来像`POBASE~N.POE`，其中：

*   `POBASE`是基础的一部分（通常是开头，去掉了不寻常的字符），
*   `~`是一个文字波浪字符，
*   `N`是一个或多个数字，通常是与现有名称不冲突的最小数字，
*   `POE`是扩展名的一部分（通常是开头，去掉不寻常的字符），其中扩展名是最后一个点之后的部分，
*   所有部分都是大写字母或数字。

我按顺序创建了以下文件：

*   `.ab`有简称`AB~1`
*   `a.b.c`有简称`AB~1.C`
*   `a.bcde`有简称`A~1.BCD`
*   `a.x y`（注意空格）有简称`a.xy`
*   `..ab`有短名称`AB~2`，因为`AB~1`已经存在（第一个示例）
*   `a.b`, `a.b.`, `a.b..`,`a.b...`都是同一个文件的等价名称（即如果存在，创建`a.b...`将覆盖）。`a.b`

在旧的 Windows 98 系统上运行命令`dir ????.*`时，将匹配以下文件：

*   `AB~1`, 名字长`.ab`
*   `AB~1.C`, 名字长`a.b.c`
*   `AB~2`, 名字长`..ab`

现在，虽然 Vista 和 7 已尝试将大多数 DOS 遗留系统扔出窗口（双关语），但仍有一些残余：如果您`C:\PROGRA~1`在资源管理器窗口的地址栏中键入，您将进入（半生不熟的) 的本地化变体`C:\Program files`，如果您插入 FAT 格式的 USB 密钥，文件将具有短名称。我不确定通配符是否会与这些短名称匹配，但这里有一些**“有趣”**的事实，表明它甚至不值得研究：

# 有趣的事实

*   在 Windows 7 的法语版本中，`C:\Program files`将在资源管理器中显示为`C:\Programmes`，但如果您尝试`cd C:\Programmes`，它将失败，因此命令行似乎不使用翻译后的名称。
*   在同一个 Windows 7 上，`????????.?`（8.1 问号）将匹配`a.b.c`（只有 5 个字符），但任何更短的内容（如`???????.?`7.1 问号）都不会匹配。
*   在同一个 Windows 7 上，`????????.?`将匹配`foo`，尽管`foo`.

# 结论

总而言之，如果您想编写一个可靠地删除第一个（或最后一个）点之前正好四个字符的文件的程序，请使用其他一些解决方案，不要使用通配符。

但是，请注意，旧的 Windows 版本不具备所有那些花哨的脚本功能来获取具有笨拙语法的字符串的长度（我的意思是，说真的，它几乎和[zsh globbing modifiers](http://grml.org/zsh/zsh-lovers.html#_recursive_globbing_examples)`if "!n:~3,1!" neq "" echo del "%%F"`一样糟糕。

如果 Windows 没有三层文件命名（FAT 短名称、“实际”文件名和翻译文件名），并且没有选择更改`?`.

*叹*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:02:24.090

这将删除名称正好为 4 个字符（不包括扩展名）和任何扩展名的任何文件。
例如：`del4chrs "C:\DATA\Junk Folder"`

```
@echo off
setlocal enabledelayedexpansion
if "%1" == "" (
  echo Usage del4chrs {folder}
  goto :eof
)
if not exist "%~1\nul" (
  echo Folder not found.
  goto :eof
)
pushd "%~1"
for %%F in (????.*) do (
  set n=%%~nF
  if "!n:~3,1!" neq "" echo del "%%F"
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:06:22.963

我相信这是删除所有文件的最简单的解决方案，其基本名称无视扩展名正好是 4 个字符：*编辑 - 我从 DIR 命令中删除了掩码，因为 FINDSTR 无论如何都在进行真正的过滤*

```
for /f "eol=: delims=" %%F in ('dir /b /a-d^|findstr /rx "....\.[^.]* ...."') do del "%%F" 
```

很容易修改解决方案，只删除由 4 个数字组成的文件（不考虑扩展名）

```
for /f "eol=: delims=" %%F in ('dir /b /a-d^|findstr /rx "[0-9][0-9][0-9][0-9]\.[^.]* [0-9][0-9][0-9][0-9]"') do del "%%F" 
```

# django - 具有事务支持的django doctests？

> ID：11972576
> 
> 赞同：1
> 
> 时间：2012-08-15T15:45:48.050
> 
> 标签：django

我想包括一些在数据库中创建对象的文档测试。我使用 doctests 而不是测试用例，因为我想在文档中向用户展示他们如何操作数据库。

有没有办法用事务包装文档测试？我想我可以尝试在每个类的开头插入一些东西，在最后插入一些东西，但是我怎么知道它们是否会按那个顺序执行？

谢谢。

# jquery - 更改 ListView 搜索字段输入类型

> ID：11972577
> 
> 赞同：1
> 
> 时间：2012-08-15T15:45:48.237
> 
> 标签：jquery, html, listview, jquery-mobile

我想知道如何将 listview-input 字段的类型更改为数字。我试过这个：

```
$("#list").find("input:first").attr("type","number");
$("#list").listview("refresh"); 
```

但结果并没有改变。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T20:28:00.210

您将无法更改`type`输入运行时的属性，但您可以克隆元素，更改克隆的属性，然后用克隆替换现有元素。您也没有选择任何内容，因为 jQuery Mobile 添加了一个带有过滤器输入的表单作为`listview`小部件的兄弟，而不是后代。​</p>

```
//run code when pseudo-pages initialize
$(document).on('pageinit', '.ui-page', function () {

    //find the filter input on this pseudo-page
    var $filterInput = $(this).find('.ui-listview').prev('.ui-listview-filter').find('input'),

        //create a clone of the filter input on this pseudo-page
        $clone       = $filterInput.clone(true);

    //replace the original input with the clone
    $filterInput.replaceWith($clone.attr('type', 'number'));
});​ 
```

这是一个演示：http: [//jsfiddle.net/XEEsL/](http://jsfiddle.net/XEEsL/)

这是一些示例 HTML，因此您可以查看`listview`小部件与其关联的过滤器输入之间的关系：

```
<form class="ui-listview-filter ui-bar-c" role="search">
    <div class="ui-input-search ui-shadow-inset ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-c">
        <input placeholder="Filter items..." data-type="search" class="ui-input-text ui-body-c" type="number">
        <a href="#" class="ui-input-clear ui-btn ui-btn-up-c ui-shadow ui-btn-corner-all ui-fullsize ui-btn-icon-notext ui-input-clear-hidden" title="clear text" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="delete" data-iconpos="notext" data-theme="c" data-mini="false">
            <span class="ui-btn-inner ui-btn-corner-all">
                <span class="ui-btn-text">clear text</span>
                <span class="ui-icon ui-icon-delete ui-icon-shadow">&nbsp;</span>
            </span>
        </a>
    </div>
</form>
<ul data-filter="true" data-role="listview" class="ui-listview">
    <li class="ui-li ui-li-static ui-body-c">1</li>
    <li class="ui-li ui-li-static ui-body-c">2</li>
    <li class="ui-li ui-li-static ui-body-c">3</li>
</ul> 
```

# testing - DbUnit 断言浮点数

> ID：11972579
> 
> 赞同：0
> 
> 时间：2012-08-15T15:45:57.553
> 
> 标签：testing, hsqldb, dbunit

我正在使用 DbUnit 测试我的 DAO 层。我正在从 XML 数据集预填充数据库，执行一些操作，然后针对已知结果进行断言。

`Assertion.assertEquals(expectedDataSet, actualDataSet);`

数据集包含带有浮点数的列。然后比较这些列，我得到：

`junit.framework.ComparisonFailure: value (table=OrderLine_T, row=2, col=price) expected:<2.99[]> but was:<2.99[0000009536743]>.`

值相等，但由于浮点数不能以二进制形式精确表示，因此断言失败。在 JUnit 中，我们有`assertEquals(double expected, double actual, double delta)`. 我们如何在 DbUnit 中设置一些增量来进行浮点数比较？

初始数据集：

```
<dataset>
    <Customer_T id="1" name="Anthony"/>
    <Customer_T id="2" name="John"/>

    <Order_T id="1" date="2012-06-07 14:30" customer_id="1" />
    <Order_T id="2" date="2012-06-07 15:31" customer_id="2" />

    <OrderLine_T id="1" order_id="1" product_id="1" price="2.99" quantity="5" />
    <OrderLine_T id="2" order_id="2" product_id="2" price="3.49" quantity="10" />
</dataset> 
```

预期结果：

```
<dataset>
    <Customer_T id="1" name="Anthony"/>
    <Customer_T id="2" name="John"/>

    <Order_T id="1" date="2012-06-07 14:30" customer_id="1" />
    <Order_T id="2" date="2012-06-07 15:31" customer_id="2" />

    <OrderLine_T id="1" order_id="1" product_id="1" price="2.99" quantity="5" />
    <OrderLine_T id="2" order_id="2" product_id="2" price="3.49" quantity="10" />

<!--     Below added -->
    <Order_T id="3" date="1987-06-07 9:15:10" customer_id="2" />
    <OrderLine_T id="3" order_id="3" product_id="1" price="2.99" quantity="2" />
    <OrderLine_T id="4" order_id="3" product_id="5" price="3.55" quantity="8" />
</dataset> 
```

代码：

```
/* Should save order correctly (including order lines) */
    @Test
    public void save() throws Exception {
        /* Create new order */
        Set<OrderLine> lines = new HashSet<OrderLine>();
        lines.add(new OrderLine(1, (float)2.99, 2));
        lines.add(new OrderLine(5, (float)3.55, 8));

        Calendar cal = Calendar.getInstance();
        cal.set(1987, 6, 7, 9, 15, 10);
        Date date = cal.getTime();

        Customer customer = customerDAO.findById(2); // John

        Order order = new Order(date, lines, customer);
        orderDAO.save(order);
        entityManager.flush();

        /* Assert order is saved */
        IDataSet expectedDataSet = new FlatXmlDataSetBuilder().build(Thread.currentThread()
                                                                           .getContextClassLoader()
                                                                           .getResourceAsStream("data-set-afterAddOrder.xml"));
        IDataSet actualDataSet = getDatabaseConnection().createDataSet();

        Assertion.assertEquals(expectedDataSet, actualDataSet);
    } 
```

编辑：

可能需要提及我正在使用的内存 HSQLDB。刚试了mysql，成功通过了。

尝试设置`ToleratedDelta`没有成功：

```
IDatabaseConnection connection = new DatabaseConnection(((SessionImpl) (entityManager.getDelegate())).connection());
HsqldbDataTypeFactory dataTypeFactory = new HsqldbDataTypeFactory();
dataTypeFactory.addToleratedDelta(new ToleratedDelta("OrderLine_T", "price", 0.01));
connection.getConfig().setProperty(DatabaseConfig.PROPERTY_DATATYPE_FACTORY, dataTypeFactory); 
```

编辑2：

我正在使用 hibernate.hbm2ddl.auto = create，将架构导出到数据库。从 **fredt**得到想法后，我将实体上的字段*价格*类型更改为 BigDecimal 并添加了额外的列精度和比例参数：

```
@Column(precision=10, scale=4)
private BigDecimal price; 
```

这被翻译成`PRICE NUMERIC(10,4)`. 问题解决了，感谢**fredt**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:10:35.397

如果将列定义为 DECIMAL 或 NUMERIC 并具有所需的精度和小数位数，则该值将具有小数点后的 exace 位数，可以避免此问题。

# php - Android：使用发送和接收调用 PHP 网络服务感到困惑/迷失

> ID：11972581
> 
> 赞同：0
> 
> 时间：2012-08-15T15:45:59.237
> 
> 标签：php, android, web-services

从我的 android 应用程序中，我想调用 php web 服务。有时，我只需要一些来自 php 的数据，有时会根据传递的一些参数获取数据。我更喜欢使用像 HttpClient 这样的 RAW Api。我还计划使用 mySql DB。

要调用 php 网络服务，我从[http://lukencode.com/2010/04/27/calling-web-services-in-android-using-httpclient/](http://lukencode.com/2010/04/27/calling-web-services-in-android-using-httpclient/)和[http://www.anddev.org/获得了参考做_http_post_with_android-t492.html](http://www.anddev.org/doing_http_post_with_android-t492.html)，[http: //www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/](http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/)

我被困在：例如：我使用我的 url “http://......php?src=SOURCE&dest=DEST REsult - 从 SOURCE 到 DEST 的方向（有时结果可能是字符串数组）传递 2 个参数, 物品等)

1.  如何在单个请求中发送和接收数据？
2.  如何编写相同的php？
3.  是否需要使用原始 aAPI 或 JSON 或 ksoap 完成上述操作？我已经读过，而不是使用 Jsoan 或 Soap，raw 是最好的方法。

请帮助我解决困惑并继续使用该应用程序。非常感谢任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T11:25:47.233

是的，

alfasin，通过你的帖子和其他网站，我让事情正常工作。

# java - 来自 BaseAdapter 的 Android 刷新 ListActivity

> ID：11972586
> 
> 赞同：3
> 
> 时间：2012-08-15T15:46:10.477
> 
> 标签：java, android, listview

我有一个 ListActivity 和一个扩展 BaseAdapter 的自定义适配器。

在 ListView 的每一行上，都有一个按钮和几个视图。onClickListener 在适配器中声明。

单击按钮后如何**刷新列表视图？**

这是代码

**列出活动：**

```
 .........
 super.onCreate(savedInstanceState);

here im reading content from a file and then creating adapter with that content

     adapter = new UvArrayAdapter(this, strarray3, strarray2, intarray);
    setListAdapter(adapter);
 .......... 
```

**适配器：**

```
.......

 public class UvArrayAdapter extends BaseAdapter {
 private Context mContext;
 private LayoutInflater linflater;
 private TextView txt_1, txt_2, txt_3;
 private ProgressBar pr1;
private String[] str1;
private String[] str2;
private String[] str3;
private Integer[] int1;

private class OnItemClickListener implements OnClickListener{       
    private int mPosition;
    OnItemClickListener(int position){
        mPosition = position;
    }
    @Override
    public void onClick(View arg0) {
        Log.v("TAG", "onItemClick at position" + mPosition);          
    }       
}

public UvArrayAdapter(Context context, String[] s1, String[] s2, Integer[] i1) {
mContext = context;
str1 = s1;
 str2 = s2;
int1 = i1;
linflater = LayoutInflater.from(context);
}

@Override
public int getCount() {
return str1.length;
}

@Override
public Object getItem(int arg0) {
return str1[arg0];
}

@Override
public long getItemId(int arg0) {
return arg0;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {

if (convertView == null) {

    convertView = linflater.inflate(R.layout.uv_rowlayout, null);

}
convertView.setOnClickListener(new OnItemClickListener(position));
txt_1 = (TextView) convertView.findViewById(R.id.textView1);
pr1 = (ProgressBar) convertView.findViewById(R.id.progressBar1);
pr1.setProgress(int1[position]);
txt_1.setText(str1[position]);

txt_2 = (TextView) convertView.findViewById(R.id.textView2);
txt_2.setText(str2[position]+"mV");
Button btn = (Button) convertView.findViewById(R.id.button1);
btn.setOnClickListener(new OnClickListener(){

    @Override
    public void onClick(View v) {
         Log.v("onClickListener", "button - clicked at position "             position);

        do some changes in mentioned file and after that i need to update the list view with new data
             }});

return convertView;

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T15:55:06.937

```
adapter.notifyDataSetChanged(); // to notify the adapter that your data has been updated 
```

**注意：**如果您在上面的行中遇到任何错误，您可以尝试以下代码（其中 mListView 是我的 ListView 对象的名称）

```
((BaseAdapter) mListView.getAdapter()).notifyDataSetChanged(); 
```

另一种方法是使列表无效，以便再次从更新的数据集重新绘制它。

```
mListView=(ListView) findViewById(R.id.MyListView);
mListView.invalidate(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:51:23.057

利用`notifyDataSetChanged()`

```
adapter = new UvArrayAdapter(this, strarray3, strarray2, intarray);
setListAdapter(adapter);
UvArrayAdapter.notifyDataSetChanged(); 

// To make the adapter aware of the changes 
```

# jquery - jQuery 幻灯片 - 连续循环

> ID：11972587
> 
> 赞同：0
> 
> 时间：2012-08-15T15:46:15.057
> 
> 标签：jquery, gallery, slideshow

我刚开始使用 jQuery 并开始使用此处找到的幻灯片图库教程：http: [//tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/](http://tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/)

最新版本的幻灯片添加了自动推进每张幻灯片的代码，但是当它到达结尾时，它会“倒回”到第一张幻灯片，而不是简单地推进。我认为这与定位和“动画”的使用有关，但我似乎无法解决。

```
$(document).ready(function(){
/* This code is executed after the DOM has been completely loaded */

var totWidth=0;
var positions = new Array();

$('#slides .slide').each(function(i){

    /* Traverse through all the slides and store their accumulative widths in totWidth */

    positions[i]= totWidth;
    totWidth += $(this).width();

    /* The positions array contains each slide's commulutative offset from the left part of the container */

    if(!$(this).width())
    {
        alert("Please, fill in width & height for all your images!");
        return false;
    }

});

$('#slides').width(totWidth);

/* Change the cotnainer div's width to the exact width of all the slides combined */

$('#nav ul li a').click(function(e,keepScroll){

        /* On a thumbnail click */

        $('li.navItem').removeClass('active').addClass('over');
        $(this).parent().addClass('active');

        var pos = $(this).parent().prevAll('.navItem').length;

        $('#slides').stop().animate({marginLeft:-positions[pos]+'px'},450);
        /* Start the sliding animation */

        e.preventDefault();
        /* Prevent the default action of the link */

        // Stopping the auto-advance if an icon has been clicked:
        if(!keepScroll) clearInterval(itvl);
});

$('#nav ul li.navItem:first').addClass('active').siblings().addClass('over');
/* On page load, mark the first thumbnail as active */

/*****
 *
 *  Enabling auto-advance.
 *
 ****/

var current=1;
function autoAdvance()
{
    if(current==-1) return false;

    $('#nav ul li a').eq(current%$('#nav ul li a').length).trigger('click',[true]); // [true] will be passed as the keepScroll parameter of the click function on line 28
    current++;
}

// The number of seconds that the slider will auto-advance in:

var changeEvery = 5;

var itvl = setInterval(function(){autoAdvance()},changeEvery*1000);

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:50:18.483

为什么要建立自己的？拥抱在其他人构建的基础上构建的力量。有一个不错且相当流行的滑块插件，名为[Coda Slider](http://kevinbatdorf.github.com/codaslider/)。如果您需要，它提供了大量有用的自定义选项。

# python - 学完 Python 基础后我该做什么？

> ID：11972592
> 
> 赞同：0
> 
> 时间：2012-08-15T15:46:29.960
> 
> 标签：python

如果有人现在学习 Python 的基础知识，那之后他应该做什么？有他必须阅读的特定书籍吗？或者，究竟是什么？

换句话说，掌握 Python 的途径是什么？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:47:47.177

编写*大量*代码（解决您自己的问题，和/或参与开源项目），在这里闲逛，从问题中学习，然后尝试做出贡献。

我在 SO 上学到*了很多*东西，有时这里有点苛刻，但到目前为止，这绝对是值得的。我已经意识到 Python 的一些我什至不知道存在的角落。

您获得的反馈（通常是建设性的）以及您看到的针对同一问题的*许多（许多！）替代*解决方案可能非常有用。

您还可以为自己设定一些具体目标（例如掌握正则表达式），然后通过阅读和练习（并遵循 SO 上的这些标签）深入了解这些目标。

=> 最后，没有什么可以替代实际编写代码。

ps：处理一些[欧拉项目](http://projecteuler.net)问题让我比以前更仔细地思考数据结构和算法的价值，因为这些问题可能很重要，并且可以抵抗蛮力方法。这也让我成为了一名更好的职业选手，并且充满挑战和乐趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:48:21.037

获得一个您感兴趣的项目，**开始 hacking**（即扩展它，修复您遇到的小错误）。那里有很多开源项目，您可以查看。

你需要经验，经验来自失败，失败是尝试的结果。这就是你要走的路。

如果您在某个地方遇到问题，请务必返回 SO 或 google - 这将帮助您解决 99.9% 的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:48:08.577

开始编写有用的代码。学习面向对象的 Python。学到足够的知识来回答关于 SO 的问题。

参加[Python 挑战赛](http://www.pythonchallenge.com)

# c# - c#中复杂的XML反序列化

> ID：11972601
> 
> 赞同：1
> 
> 时间：2012-08-15T15:47:01.040
> 
> 标签：c#, xml-deserialization

这是我的斑点：

```
<Attributes>
  <SomeStuff>...</SomeStuff>
  <Dimensions>
    <Weight units="lbs">123</Weight>
    <Height units="in">123</Height>
    <Width units="in">123</Width>
    <Length units="in">123</Length>
  </Dimensions>
</Attributes> 
```

我正在尝试使用我的班级成员的 xml 属性对其进行反序列化，但我遇到了麻烦。我正在尝试使用带有单位和值的“维度”类型。如何获取单位作为属性并将值获取到值？

这是我正在尝试的：

```
[Serializable]
public class Attributes
{
  public object SomeStuff { get; set; } // Not really...

  public Dimensions Dimensions { get; set; }
}

[Serializable]
public class Dimensions
{
    public Dimension Height { get; set; }

    public Dimension Weight { get; set; }

    public Dimension Length { get; set; }

    public Dimension Width { get; set; }
}

[Serializable]
public class Dimension 
{
    [XmlAttribute("units")]
    public string Units { get; set; }   

    [XmlElement]
    public decimal Value { get; set; }
} 
```

我知道这段代码期望维度内有一个实际的“值”元素。但是我在 .NET 库中找不到任何可以告诉它为此使用元素的实际文本的属性装饰器，除了 XmlText，但我想要一个小数......代理字段是唯一的选择吗？（例如

```
[XmlText] public string Text { get; set; }

[XmlIgnore]
public decimal Value
{
  get { return Decimal.Parse(this.Text); }
  set { this.Text = value.ToString("f2"); }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:48:54.597

您可以`XmlAttribute`用于属性和`XmlText`文本。所以试着改变你`public decimal Value`的装饰`[XmlText]`。

```
[Serializable]
public class Dimension 
{
    [XmlAttribute("units")]
    public string Units { get; set; }   

    [XmlText]
    public decimal Value { get; set; }
} 
```

# macos - OS X 10.8 上的 CMAKE、Clang 和 C++v11

> ID：11972603
> 
> 赞同：10
> 
> 时间：2012-08-15T15:47:07.253
> 
> 标签：macos, compiler-construction, c++11, compiler-errors, clang

操作系统 X 1.8

CMAKE 2.8.9

铛`$ clang -v Apple clang version 4.0 (tags/Apple/clang-421.10.60) (based on LLVM 3.1svn) Target: x86_64-apple-darwin12.0.0 Thread model: posix`

CMAKELists.txt：

```
cmake_minimum_required (VERSION 2.8.9)
project (Test)
add_executable(Test main.cpp) 
```

主文件

```
//Create a C++11 thread from the main program
#include <iostream>
#include <thread>

//This function will be called from a thread
void call_from_thread() {
    std::cout << "Hello, World!" << std::endl;
}

int main() {
    //Launch a thread
    std::thread t1(call_from_thread);

    //Join the thread with the main thread
    t1.join();

    return 0;
} 
```

我的错误：

```
$ make
Scanning dependencies of target Test
[100%] Building CXX object CMakeFiles/Test.dir/main.cpp.o
test/main.cpp:4:10: fatal error: 'thread' file not found
#include <thread>
     ^
1 error generated.
make[2]: *** [CMakeFiles/Test.dir/main.cpp.o] Error 1
make[1]: *** [CMakeFiles/Test.dir/all] Error 2
make: *** [all] Error 2 
```

那么 Clang 的版本不支持 C++v11 的特性吗？同样的程序在 OSX 10.8 上的 gcc-4.7.1 下编译

这个参考说它应该工作`http://www.cpprocks.com/a-comparison-of-c11-language-support-in-vs2012-g-4-7-and-clang-3-1/`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-15T15:56:24.343

您需要向编译器提供`-std=c++11`and`-stdlib=libc++`标志才能完全激活其 C++11 支持。这可以通过 ccmake（打开高级模式（使用`t`）并设置`CMAKE_CXX_FLAGS`为`-std=c++11 -stdlib=libc++`）或通过 CMakeLists.txt 中的等效指令来完成：

```
cmake_minimum_required(VERSION 2.8.9)
set(CMAKE_CXX_FLAGS "-std=c++11 -stdlib=libc++")
project(Test)
add_executable(Test main.cpp) 
```

# actionscript - 使用动作脚本文件编译 .SWF

> ID：11972615
> 
> 赞同：2
> 
> 时间：2012-08-15T15:47:48.273
> 
> 标签：actionscript, compilation, flash-builder, flash

这可能有点微不足道，但我正在尝试处理动作脚本/Flash 项目，需要对其进行一些更改并尝试重建与其关联的 .SWF 文件。

该项目本身相当简单，可以在 github 上**[找到](https://github.com/jwagener/recorder.js/tree/master/flash)**它是 jwagener 的 recorder.js，它由几个 Action Script 文件和一个编译的 .SWF 文件组成。

我对动作脚本的构建过程不是很熟悉，我确信我拥有所有必要的工具（Flash Builder、Adobe Flash Professional 等），但我不确定如何去做。

我试图简单地创建一个新的 ActionScript 项目并从他的存储库中添加所有必要的 ActionScript 文件，但是在构建 .SWF 时它根本不起作用，并且缺少我需要使用的所有外部接口元素。

任何可以为我指明正确方向的想法、演练或教程都会非常有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T19:13:33.453

您要编译的项目实际上包含一个[Make 文件](https://github.com/jwagener/recorder.js/blob/master/Makefile)。

```
MXMLC = "/Applications/Adobe Flash Builder 4.5/sdks/4.5.0/bin/mxmlc"

build:
    $(MXMLC) -debug=false -static-link-runtime-shared-libraries=true -optimize=true -o recorder.swf -file-specs flash/FlashRecorder.as

clean:
    rm recorder.swf 
```

它看起来为 osx 设置，但你明白了。如果您只需要进行微小的更改并且可以在没有显示错误/警告/等的 IDE 的情况下进行。你可以这样做：

1.  下载[FlexSDK](http://www.adobe.com/devnet/flex/flex-sdk-download.html)
2.  设置环境变量，以便您可以从系统上的任何位置访问 mxmlc 编译器
3.  导航到您的项目并从命令行编译

**第 1 步**很简单。 **第 2 步**取决于您的操作系统。在 Windows 上应该类似于我的电脑 > 属性 > 高级 > 环境变量（我记得这是在 XP 上，应该仍然在 Windows 7 上的计算机属性属性中的某个`PATH`位置）并将 FlexSDK 的 bin 文件夹的位置添加到变量中。在 unix 上，您应该在*~/.profile*或*~/.bash_profile*中添加类似的内容：`export PATH=/your/path/to/FlexSDK/bin:$PATH` 在此您应该能够从命令行`mxmlc -version`运行

**第 3 步**意味着导航到项目并运行：

```
mxmlc -warnings=false -debug=false -static-link-runtime-shared-libraries=true -optimize=true -o recorder.swf -file-specs flash/FlashRecorder.as 
```

简而言之，这就是命令行选项。

如果您有更多的编辑工作，您可以使用 IDE。如果您使用的是 Windows，我强烈推荐[FlashDevelop](http://flashdevelop.org/)：它是快速/轻量级/免费/开源的。它会下载 sdk 并为您设置一切。

如果您使用的是 OSX，您可以使用[FDT 5 Free或](http://fdt.powerflasher.com/buy-download/)[Flash Builder](https://www.adobe.com/cfusion/tdrc/index.cfm?product=flash_builder&loc=en_gb)的试用版（默认为 60 天）或[使用 actionscript 3 bundle 设置 TextMate](https://vimeo.com/9914327)。

# javascript - 根据表单输入显示/隐藏选项

> ID：11972616
> 
> 赞同：2
> 
> 时间：2012-08-15T15:47:48.913
> 
> 标签：javascript, jquery, select, option, chained

我有两个选择菜单。一个名为#c1，一个名为#c2。＃C2被隐藏，并且在选择C1中的选项（任何选项）时将显示。这很好用，但是我想要一个小的调整，由于我对 Javascript/jQuery 的了解有限，我似乎无法弄清楚。

When #c1's option "meta" is selected, i would like to show #c2 as with any other option, but i would like #c2 to have an aditional option.

例如

```
<select id="c1">
<option>Option 1</option>
<option>Option 2, etc.</option>
<option>Metadata</option>
</select>

<select id="c2">
<option>Option 1</option>
<option>Option 2, etc.</option>
<option>Metadata</option> // This should be shown only when "metadata" in #c1 is selected and hidden when not.
</select> 
```

我遇到的一个问题是，仅使用 CSS 很难隐藏选项，而且我的 JS 知识有限。[这里](https://stackoverflow.com/questions/2507240/jquery-show-a-textbox-when-an-option-is-selected)有一个解决方案，但我无法将它融入我想要的链式选择中。

我在这里创建了一个[Fiddle](http://jsfiddle.net/XkCsU/)，所以你可以看到所有的选择框和当前的 JS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T07:02:39.277

我不确定这是最好的方法，但我想它会起作用：

```
var optionsArray = [{'key':'1','value':'val1','text':'Option 1'},
           {'key':'2','value':'val2','text':'Option 2, etc.'},
           ]; // Array of the #2 Options without the metadata

$('select[name="c1"]').change( function() {

    // Put your show/hide code here

    $('select[name="c2"] option').remove();// remove all the c2 options (In case there is already metadata)
    $.each(optionsArray, function(i){ //add all the basic options
          $('select[name="c2"]').append($("<option></option>")
            .attr("value",optionsArray[i]['value'])
              .text(optionsArray[i]['text']));
    });

    var valSelect1 = $(this).val();
    if (valSelect1 == 'Metadata'){ // add metadata only if the c1 option is metadata
         $('select[name="c2"]').append('<option value="Metadata">Metadata</option>');
    }
}); 
```

希望它会有所帮助

# sql - 如何将多个 SQL 查询合二为一？

> ID：11972617
> 
> 赞同：1
> 
> 时间：2012-08-15T15:47:53.470
> 
> 标签：sql, ruby-on-rails, postgresql, activerecord

我有两个与这个问题相关的表格。

首先是`Company`哪个`has_many` `Taps`。每个 Tap 都有一个 Date 字段，说明它的创建日期（`created_at`与此处无关的原因不同）。

我想绘制`Taps`公司随时间变化的频率，按天分组。这意味着对于我的 30 天图表，我目前正在为`Date`我范围内的每个单独的 SQL 查询来获取应用程序点击 where `:tapped_time = {some date} and :company_id = {id of the company}`。

如何在不单独查询每天的情况下，在连续范围内获取公司每天的 Taps 数？

我正在使用 Ruby on Rails，所以我不需要原始 SQL，我只需要一些关于我的 ActiveRecord 魔法的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:54:02.503

在 SQL 中，如果要查询单个公司，则按日期分组，如果一次查询多个公司，则按日期和公司分组。

ActiveRecord 有一个[group 方法](http://guides.rubyonrails.org/active_record_querying.html#group)。

# sql-server-2008 - 使用 JPA 命名多列约束

> ID：11972621
> 
> 赞同：1
> 
> 时间：2012-08-15T15:48:14.453
> 
> 标签：sql-server-2008, hibernate, jpa-2.0, constraints

的`name`属性`@UniqueConstraint`似乎没有效果。

```
@Entity
@Table(name = "TAG", uniqueConstraints = @UniqueConstraint(columnNames = {
        "TAG_NAME", "USERS_ID" }, name="UQ_TAG_USER"))
public class Tag extends BaseEntity {

} 
```

我正在使用`SQL Server 2008`，`JPA 2.0`与`Hibernate 3.6`。

在 DB 端`UQ__TAG__6EF57B66`创建一个索引，而不是`UQ_TAG_USER`.

我错过了什么？有没有办法从java端强制执行给定的名称？并且必须求助于编辑模式文件？我们是一家没有 DBA 的小商店，我尝试在休眠模式工具的帮助下尽我所能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:25:39.487

我假设您正在使用休眠，因为您在此问题的标签中拥有它。这是休眠中的错误/缺失功能：

[https://hibernate.onjira.com/browse/HB-1245](https://hibernate.onjira.com/browse/HB-1245)

当方言支持在与 create table 相同的语句中创建约束时，它将简单地忽略唯一约束名称。我检查了 SqlServer 和 Oracle 方言，它们都支持这种创建约束的方式，这将导致您遇到的错误。

有两种方法可以解决此错误：

**1.快捷方式：**
只要扩展方言，方法返回false`supportsUniqueConstraintInCreateAlterTable()`即可：

```
public static class SQLServerDialectImproved extends SQLServerDialect {
    @Override
    public boolean supportsUniqueConstraintInCreateAlterTable() {
        return false;
    }
} 
```

并将此类设置为`hibernate.dialect`持久单元配置 ( `persistence.xml`) 的属性中的方言。

**2.正确的方法：**
修复hibernate代码并重新编译：
bug在`org.hibernate.mapping.UniqueKey`class，方法`sqlConstraintString()`会返回`unique (TAG_NAME, USERS_ID)`所有的方言，即使他们支持`constraint UQ_TAG_USER unique (TAG_NAME, USERS_ID)`.
但这可能是一个更大的变化（需要支持各种方言等）

**幕后：**
如果使用原始方言，将导致执行以下 sql 语句来创建表（添加 id 列）：

```
create table TAG (
    id bigint not null,
    TAG_NAME varchar(255),
    USERS_ID varchar(255),
    primary key (id),
    unique (TAG_NAME, USERS_ID)
) 
```

在您按照第一个选项中所述应用修复后，将执行以下 sql 语句：

```
create table TAG (
    id numeric(19,0) not null,
    TAG_NAME varchar(255),
    USERS_ID varchar(255),
    primary key (id)
)

create unique index UQ_TAG_USER on TAG (TAG_NAME, USERS_ID) 
```

其中包括在单独的语句中创建具有所选名称 (UQ_TAG_USER) 的唯一约束。

# mysql - 有没有办法在单个查询中选择不同的并与相关子查询相交？

> ID：11972622
> 
> 赞同：0
> 
> 时间：2012-08-15T15:48:18.423
> 
> 标签：mysql, subquery, distinct

我有一张表，其中包含与这样的 idpage 相关的产品：

```
+--------+-----------+-------------+-------------+
| idPage | idProduct | inputedName | inputedCode |
+--------+-----------+-------------+-------------+
|     25 |        60 | x           | 8924        |
|     26 |        65 | y           | 105555      |
|     26 |        70 | z           | 105555      |
|     27 |        33 | a           | 14151112    |
|     27 |        34 | a           | 14151112    |
|     27 |        22 | a           | 14151112    |
|     27 |        17 | b           | OS987456    |
|     27 |        18 | c           |             |
|     27 |        17 |             |             |
|     27 |        23 | a           | 14151112    |
+--------+-----------+-------------+-------------+ 
```

没有唯一的 id。

用户在表单上输入 InputedName 和 InputedCode。

我想在页面视图上做的是选择 InputedName x Inputed Code 的 DISTINCT 组合，并与所有相关项相交或内连接（或其他）以显示如下内容：

```
In idPage=27:
- a 141511112 (inputedName, inputedCode)
-- 33 (idProduct)
-- 34
-- 22
-- 23
- b OS987456
-- 17        
- c (null)
-- 18
- (null)(null)
-- 17 
```

有没有一种很好的方法可以做到这一点，或者基本的方法是最好的？基本方式，我的意思是，我正在使用 PHP。我将首先选择 inputedName 与 inputedCode 的不同组合（我仍然不知道如何处理我的表），然后进入 PHP 的 while 命令，我将执行另一个查询。在这种情况下，它将执行 5 次查询。我不认为这是一个优雅的解决方案，但我知道 mysql 很强大，也许还有另一种方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:13:34.707

我对您的要求感到困惑，但让我试一试：

```
SELECT  inputedName, inputedCode, GROUP_CONCAT(idProduct)
FROM    sampleTable
WHERE   idPage = 27
GROUP BY inputedName, inputedCode
order by COALESCE(inputedname, 'z'),   -- this part is optional
         COALESCE(inputedCode, 'z')    -- this part is optional 
```

# [SQLFiddle 演示（点击这里）](http://sqlfiddle.com/#!2/26a7f/4)

# symfony - security.yml 中的 acl 在 symfony 中是什么意思？

> ID：11972624
> 
> 赞同：0
> 
> 时间：2012-08-15T15:48:20.467
> 
> 标签：symfony

我在 security.yml 中遇到过这条线，但我不知道这意味着什么..

```
security:
    # ...
    access_control:
        - { path: ^/_internal, roles: IS_AUTHENTICATED_ANONYMOUSLY, ip: 127.0.0.1 } 
```

这些角色是什么意思，我如何在我的控制器类中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:57:19.563

安全配置的这一部分旨在按角色限制路径：

```
access_control:
    - { path: ^/_internal, roles: IS_AUTHENTICATED_ANONYMOUSLY, ip: 127.0.0.1 
```

它基本上意味着：所有与该模式匹配的 URL `^/_internal`都应该只能由具有该角色的用户`IS_AUTHENTICATED_ANONYMOUSLY`和来自 IP的用户访问`127.0.0.1`。它保护路线免受外部访问。`IS_AUTHENTICATED_ANONYMOUSLY`只要`anonymous`在以下部分中配置了身份验证提供程序，该角色就会授予匿名用户`firewall`：

```
firewalls:
    foobar:
        pattern:    ^/foobar
        anonymous:  ~ 
```

# actionscript-3 - 如何提取MovieClip的形状？

> ID：11972626
> 
> 赞同：0
> 
> 时间：2012-08-15T15:48:23.407
> 
> 标签：actionscript-3, flash, movieclip

我们有一个 Flash 应用程序，我们计划将其转换为 javascript。这是一个非常简单的地图应用程序，以图像为背景和一堆简单的多边形影片剪辑，代表地图上的目的地。

我想遍历每个影片剪辑并将形状提取到 x,y 点数组中，以使用外部 javascript 函数重绘多边形。

使用动作脚本可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:43:56.497

如果您想在作者时导出形状坐标，您可以尝试@strille 或[这个](http://ericlin2.tripod.com/bugwire/bugwiret.html)推荐的 JSFL 脚本或导出透明图像（如果这对您的应用程序来说不是太限制的话）。

如果您需要在运行时导出形状，可以使用很棒的[as3swf](https://github.com/claus/as3swf)库来反编译 swf 并导出形状。看看[ShapeExport wiki](https://github.com/claus/as3swf/wiki/Shape-Export)，因为有几个方便的 js 导出器，比如**JSCanvasShapeExporter**和更通用的**JSONShapeExporter**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:00:59.670

Flash Player 11.6 引入了[readGraphicsData()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Graphics.html#readGraphicsData%28%29)，它完全符合您的要求。

如果您需要针对早期版本，那么不幸的是，没有简单的方法可以在运行时使用 ActionScript 从显示对象中读取形状坐标。

如果您只想在有人[为 Flash CS3 编写了一个 jsfl 脚本](http://www.box2d.org/forum/viewtopic.php?f=8&t=463)后提取形状坐标，看起来它可能会帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T17:50:46.743

您可以通过多种方式从 SWF 中读取坐标。例如，我用 PHP ([链接](http://code.google.com/p/flaczki/source/browse/trunk/flaczki/SWFParser.php)) 编写了一个解析器。事实证明，获取数据并没有帮助。Flash 绘画模型与 HTML5 的不同之处足以使传输变得异常困难。我发现的主要障碍是，在 Flash 中，可以使用两种填充样式填充路径：一种用于路径包围的区域，另一种用于被奇偶规则视为“外部”的封闭区域（例如，五边形一颗星星的中间）。由于 HTML5 画布只允许您指定一种填充样式，因此您无法从 Flash 中准确地重绘形状。我试图创建一个将形状提取为 SVG 的工具，结果中出现了很多间隙和漏洞。

# backbone.js - 在 Backbone 中触发两个或多个事件后执行一个函数

> ID：11972633
> 
> 赞同：0
> 
> 时间：2012-08-15T15:48:50.827
> 
> 标签：backbone.js, backbone-events

我有两个按钮：

```
<button id="1">button 1</button>
<br>
<button id="2">button 2</button> 
```

我想仅在单击两个按钮后才显示警报消息，这是我正在使用 Backbone.js 的较大应用程序的一部分，到目前为止我有这个：

```
var test = {}; 

_.extend(test, Backbone.Events); //in order to use the backbone events feature

test.on("hello bye", function(){
    alert("works!");
});

$("#1").click(function() {
    test.trigger("hello");
});

$("#2").click(function() {
    test.trigger("bye");
}?); 
```

每当单击两个按钮之一时，这都会显示消息，但我需要它**仅在单击两个按钮后**才能工作。有没有办法使用 Backbone.Events 功能或使用 jQuery 来实现这一点？

小提琴：http: [//jsfiddle.net/ccgRN/](http://jsfiddle.net/ccgRN/)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:07:52.247

这是一个使用承诺的想法：http: [//jsfiddle.net/LFJGL/1/](http://jsfiddle.net/LFJGL/1/)

编辑：针对旧版浏览器修复：

```
var test = {};
var promises = [];
_.extend(test, Backbone.Events); //in order to use the backbone events feature

function GetAPromise() {
    var p = $.Deferred();
    promises.push(p);
    return p;
}

var events = "hello bye".split(" ");
_.each(events,function(event) {
    var p = GetAPromise();
    test.on(event, function() {
        p.resolveWith(event);
    });
});

$("#1").click(function() {
    test.trigger("hello");
});

$("#2").click(function() {
    test.trigger("bye");
});

$.when.apply($, promises).done(function() {
    alert('triggered');
    //might be nice to remove the event triggers here.
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:11:13.463

最简单的实现是创建几个变量来跟踪已触发的事件。

```
var helloClicked = false;
var byeClicked = false;
var test = {};

_.extend(test, Backbone.Events);

test.on('hello bye'), function() {
  if (helloClicked && byeClicked) {
    alert('works!');
  }
});

$('#1').click(function() {
  helloClicked = true;
  test.trigger('hello');
});

$('#2').click(function() {
  byeClicked = true;
  test.trigger('bye');
}); 
```

# ruby-on-rails - 在 Rails 控制器中将 GET 请求重定向到另一个应用程序的 POST 请求

> ID：11972636
> 
> 赞同：0
> 
> 时间：2012-08-15T15:48:58.317
> 
> 标签：ruby-on-rails, http, redirect

我有一个由 GET 路由触发的控制器操作，在某些情况下，我想重定向到另一个服务器上另一个应用程序的 POST 路由。

我知道，`redirect_to "http://somewhere.com/thing_to_post_to"`但似乎没有指定 http 方法的方法。这适用于 AJAX 请求而不是页面，因此返回 javascript 来引导浏览器是不可接受的。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:40:56.343

redirect_to 使用 HTTP 状态码进行重定向，所以很可能是 GET，这里是使用 307 状态码的另一个解释

[Response.Redirect 使用 POST 而不是 Get？](https://stackoverflow.com/questions/46582/response-redirect-with-post-instead-of-get)

但在所有浏览器中实现得不是很好，所以我建议使用会话变量在视图之间传递参数或类似的东西。

# php - Mod Rewrite - 导致内部重定向

> ID：11972637
> 
> 赞同：1
> 
> 时间：2012-08-15T15:48:59.037
> 
> 标签：php, apache, .htaccess

我正在尝试按如下方式创建 RewriteRule；

```
RewriteCond %{HTTP_HOST} ^dev$ [NC]
RewriteRule ^(.*)$ test/$1 [L] 
```

当有人输入时`http://dev/index.php`，实际上将检索到的文件是`http://dev/test/index.php`.

但是，这似乎会导致大量内部重定向。

有人帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:56:16.387

添加

```
RewriteCond %{REQUEST_URI} !^/?test 
```

...在第一个之前`RewriteCond`。

重写规则上的`[L]`标志（有点违反直觉）导致重写过程再次从顶部开始。您当前的规则将在每次迭代时匹配，并且 mod_rewrite 将进入无限循环。添加上述`RewriteCond`意味着它只会在第一次迭代时匹配。

如果您在 Apache 2.3.9 或更高版本上运行，您可以使用`[END]`重写规则上的标志而不是`[L]`- 这将导致 mod_rewrite 立即退出并避免问题。如果可用，这实际上是一个更好的解决方案，因为上述内容`RewriteCond`会阻止您的规则适用于合法以 . 开头的页面`test`。

# solr - Solr 在多值字段中进行模糊搜索，术语之间的距离最大

> ID：11972643
> 
> 赞同：3
> 
> 时间：2012-08-15T15:49:25.363
> 
> 标签：solr, lucene, fuzzy-search

你好 stackOverflowers

我在 Solr 文档集合中有一个名为 names_txt 的字段 - 这是一个 multiValue="true" 字段。

此字段包含与文档相关联的所有人员的姓名

我希望能够进行模糊搜索，同时限制匹配项之间的项数。

查询

```
names_txt:("markus foss"~2) 
```

将返回您找到术语*markus*和*foss*的所有文档，它们之间最多有 2 个术语。

但是，当我以模糊的方式搜索并且还想指定匹配项之间的最大术语数时，我无法获得正确的语法。

查询：

```
names_txt:(markus~0.7 foss~0.7) 
```

这确实有效，但会返回错误的结果，因为它将返回一个文档，其中一个值为“markus something”，另一个值为“foss somethingElse”。

我想写的是：

```
(markus~0.7 foss~0.7)~2 
```

*   但是这种语法在 solr 中是非法的。

有没有人可以解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-30T08:51:33.233

由于在一个查询词中 Solr 可以处理词距离限制或模糊搜索限制，因此我们需要两个词条：

```
names_txt:("markus foss"~2) AND names_txt:(markus~0.7 foss~0.7) 
```

请注意，不推荐使用浮点数来量化模糊性。在内部，lucene converts 将`float`数字转换为`int`0 到 2 之间的数字，因此我们应该在搜索词的开头使用这个整数 (Damereau Levenshtein) 编辑距离。所以我的最终提案指出：

```
names_txt:("markus foss"~2) AND names_txt:(markus~1 foss~1) 
```

（对于那些感兴趣的人：可以在[此代码文件](https://github.com/apache/lucene-solr/blob/b6fd1cf3fc4ac4ca0da08cdca62ba5b85fc958bd/lucene/core/src/java/org/apache/lucene/search/FuzzyQuery.java)`float`的末尾找到将相似度转换为编辑距离的已弃用的、有些古怪的函数。）`int`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:00:51.523

我认为您可以使用[SpanQuery](https://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/search/spans/SpanQuery.html)做到这一点问题是 Solr 中的常用查询解析器不支持它们。查看[这篇文章](http://searchhub.org/dev/2009/07/18/the-spanquery/)，其中提到了支持跨度的那些：Surround、Xml-Query-Parser 和 Qsol。但是检查当前 solr 版本中每个的状态。

# ubuntu - 如何在 Ubuntu 11.04 中安装 autoconf？

> ID：11972644
> 
> 赞同：7
> 
> 时间：2012-08-15T15:49:24.773
> 
> 标签：ubuntu, ubuntu-11.04

当我尝试通过以下命令在 Ubuntu 11.04 中安装 autoconf 时

```
sudo apt-get install autoconf 
```

这个错误来了

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Package autoconf is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

E: Package 'autoconf' has no installation candidate 
```

如何删除此错误并安装它？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-15T15:52:53.910

它对我有用。通过运行确保您已更新：

```
sudo apt-get update 
```

这可能是问题所在。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-11-14T19:38:18.497

如果有ufw活动。

```
sudo ufw disable
sudo apt-get update
sudo apt-get install autoconf
sudo ufw enable 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-12-03T16:17:38.297

在软件源选项卡中启用复选框（在系统设置下）

# jquery - jQuery 数据（）调用

> ID：11972645
> 
> 赞同：2
> 
> 时间：2012-08-15T15:49:32.837
> 
> 标签：jquery

谁能解释这之间的区别：

更新 1-还原短语

```
container.data("state", { test: 1 }); // works 
```

还有这个：

```
 container.data["state"] = { test: 1 }; // doesn't work 
```

我发现第一个建筑工作，而最后一个没有。该调用使用初始数据填充容器，即调用时“状态”为空白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:53:15.980

`data`是一个函数，而不是一个数组。您正在尝试访问第二个片段中的函数索引，这不起作用。

请参阅文档：[http ://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)

例如，在浏览器中打开开发控制台，然后输入如下内容：

```
$("a:eq(0)").data 
```

我得到一个很长的函数定义，而不是一个数组：

```
function (a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAt.... // continued 
```

# android - 有趣的小部件难题

> ID：11972646
> 
> 赞同：2
> 
> 时间：2012-08-15T15:49:39.900
> 
> 标签：android, android-intent, widget

我有一个小部件，它主要做我想做的事情（启动一个意图），但我想知道如何将多个意图压缩到一个小部件提供程序中。

我已经尝试了所有通常的方法来完成这项工作：

*   使用不止一个意图
*   使用具有相同主题设置的第二个小部件以及其他一些最终失败的小部件。

通用代码：

```
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
    for (int appWidgetId : appWidgetIds) {

        Intent startIntent = new Intent(context, myClass.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, startIntent, 0);

        // Get the layout for the App Widget and attach an on-click listener to the button
        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.MyWidget);
        views.setOnClickPendingIntent(R.id.startBtn, pendingIntent);

        // Tell the AppWidgetManager to perform an update on the current App Widget
        appWidgetManager.updateAppWidget(appWidgetId, views);
    }       
} 
```

所以我想弄清楚如何在小部件上获得一个以上的按钮。由于它设置为三个，我知道其中一个有效，所以我是那里的 1/3。

这是 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/startBtn"
    android:layout_width="150dp"
    android:layout_height="75dp"
    android:layout_marginBottom="5dp"
    android:background="@drawable/mybg"
    android:gravity="center"
    android:text="First Menu Item"
     />

<TextView
    android:id="@+id/startBtn2"
    android:layout_width="150dp"
    android:layout_height="75dp"
    android:layout_marginBottom="5dp"
    android:background="@drawable/mybg"
    android:gravity="center"
    android:text="Second menu item" />

<TextView
    android:id="@+id/startBtn3"
    android:layout_width="150dp"
    android:layout_height="75dp"
    android:layout_marginBottom="5dp"
    android:background="@drawable/mybg"
    android:gravity="center"
    android:text="Third menu item" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:26:41.313

好的，所以你几乎明白了！这个想法是创建 3 different`PendingIntents`和 3 different `Intents`，然后调用`setOnClickPendingIntent`3 次。每个动作和按钮一个。这是一个示例，假设三个活动是 myClass、myClass2 和 myClass3。使用下面的代码，每个按钮都会触发不同的意图。

```
for (int appWidgetId : appWidgetIds) {

    Intent startIntent = new Intent(context, myClass.class);
    PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, startIntent, 0);

    Intent startIntent2 = new Intent(context, myClass2.class);
    PendingIntent pendingIntent2 = PendingIntent.getActivity(context, 0, startIntent2, 0);

    Intent startIntent3 = new Intent(context, myClass3.class);
    PendingIntent pendingIntent3 = PendingIntent.getActivity(context, 0, startIntent3, 0);

    // Get the layout for the App Widget and attach an on-click listener to the button
    RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.MyWidget);
    views.setOnClickPendingIntent(R.id.startBtn, pendingIntent);
    views.setOnClickPendingIntent(R.id.startBtn2, pendingIntent2);
    views.setOnClickPendingIntent(R.id.startBtn3, pendingIntent3);

    // Tell the AppWidgetManager to perform an update on the current App Widget
    appWidgetManager.updateAppWidget(appWidgetId, views);
} 
```

# html - Ruby on Rails：博客文章不在 HTML 中呈现

> ID：11972649
> 
> 赞同：2
> 
> 时间：2012-08-15T15:49:49.603
> 
> 标签：html, ruby-on-rails, ruby, ruby-on-rails-3, rails-admin

我有一个帖子模型，用于在我的网站页面上发布博客文章。我希望帖子的内容是 HTML 格式的，但是在让它实际呈现为 HTML 时遇到了麻烦。它仅在博客页面上显示为纯文本。如果这有所作为，我正在使用 Rails_Admin。

* * *

`posts`看法：

```
#blog_page
- @posts_list.each do |post|
    %ul.post
        %li= post.created_at.strftime("%B %d, %Y")
        %li.title= post.title
        %li.author
            = 'By: '
            = post.author
        %li.content= RedCloth.new(post.content).to_html

= paginate @posts_list 
```

* * *

`post`模型：

```
class Post < ActiveRecord::Base
attr_accessible :content, :title, :author
has_many :comments

validates :title, :presence => true
validates :content, :presence => true

end 
```

* * *

`posts`控制器：

```
class PostsController < ApplicationController

before_filter :authenticate_user!, :only => [:new, :create]

# GET /posts
def index
    @posts_list = Post.order("created_at DESC").page(params[:page]).per(5)
    render 'blog'
end

# GET /posts/
def show
    @post = Post.find(params[:id])
    render 'show'
end

def new
    if !current_user.admin?
        redirect_to '/blog'
    end
    @post = Post.new
end

# POST /posts
def create
    @post = Post.new(params[:post])
        if current_user.admin?
          respond_to do |format|
            if @post.save
              format.html  { redirect_to('/posts', :notice => 'Post was successfully created.') }
              format.json  { render :json => @post, :status => :created, :location => @post }
        else
          flash[:notice] = 'Error creating post!<br/>'.html_safe
            @post.errors.full_messages.each do |msg|
              flash[:notice] << "<br/>".html_safe
              flash[:notice] << msg
            end
          format.html  { render :action => "new" }
          format.json  { render :json => @post.errors, :status => :unprocessable_entity }
        end
      end
    else
      redirect_to '/blog'
    end
end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:00:19.163

您的视图必须是这样的：

```
#blog_page
- @posts_list.each do |post|
    %ul.post
        %li= post.created_at.strftime("%B %d, %Y")
        %li.title= post.title
        %li.author
            = 'By: '
            = post.author
        %li.content= RedCloth.new(post.content).to_html.html_safe

= paginate @posts_list 
```

您还可以为此创建一个助手：

```
def post_content( post ) 
  RedCloth.new(post.content).to_html.html_safe
end 
```

只需在您的视图中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T22:17:47.563

在视图/帖子下创建一个名为“_post.html.haml”的部分

现在在您的帖子视图中，只需使用：

```
=render @posts_list 
```

在您的“_post.html.haml”部分中：

```
%ul.post
    %li= post.created_at.strftime("%B %d, %Y")
    %li.title= post.title
    %li.author By: #{post.author}
    %li.content
      != RedCloth.new(post.content).to_html 
```

# ruby-on-rails - PostgreSQL 上的 Active Record 联合分组查询

> ID：11972655
> 
> 赞同：1
> 
> 时间：2012-08-15T15:50:03.540
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord

我在 Rails 项目上工作了一段时间，但我遇到了（我认为是）一个小问题。

为了简单起见，我有 3 个这样的模型：

```
 class House < ActiveRecord::Base
  has_many :house_style_relationships
 end

 class HouseStyleRelationship < ActiveRecord::Base
  attr_accessible :percentage

  belongs_to :style
  belongs_to :house
 end

class Style < ActiveRecord::Base
  has_many :house_style_relationships
end 
```

所以 HouseStyleRelationship 模型只是让我们知道一个房子的风格百分比。例如，房子可以是 70% 的现代和 30% 的经典。

我需要做的是获得所有房屋的每种样式的平均值。为此，我在 SQLite 下使用了这个工作查询：

```
houses_count = Houses.count
HouseStyleRelationship.joins(:style).select("style.name, SUM(house_style_relationships.percentage)/#{houses_count} as percentage").group("styles.id") 
```

但是当我决定将所有这些东西都推送到 Heroku 上时，我遇到了 PostgreSQL 的问题。事实上，要创建一个 HouseStyleRelationship 对象（我什至不需要），ActiveRecord 会要求一个 HouseStyleRelationship.id ，这会使 Group By 崩溃（使用查询）。（PostgreSQL 不想对不同 id 的记录进行分组）

您是否有防止 ActiveRecord 生成模型实例作为答案并因此从查询中删除 HouseStyleRelationship.id 的解决方案？（我不能使用 SELECT DISTINCT 因为我需要 SUM() 计算）

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:47:24.577

您需要创建连接表，使其没有主键。迁移中的 create_table 语句应如下所示。

```
create_table :houses_style_relationships, :id => false do |t| 
```

# jquery - 这两个 jQuery 的不同之处以及直接和委托事件模型

> ID：11972657
> 
> 赞同：3
> 
> 时间：2012-08-15T15:50:13.330
> 
> 标签：jquery

所以，这可能是一个非常简单的问题，但我还是会问。这显然只是为了在我心中澄清这两个陈述是如何工作的。

场景我通过 Ajax 调用一些 JSON，然后将其插入到具有一些选择器的 html 中。像这样：

```
$.each(r, function(k,v){
  str+='location: <div class=\'loc-to-select\' data-location-id=\'' + v.id +  '\'>';
  str+= v.name + '</div>';
});
$('#event-search-locations').html(str); 
```

基本上写出来：

```
<div class='loc-to-select' data-location-id='2'>Joe's</div> 
```

我有这两个 jQuery：

```
// doesn't work
$('.loc-to-select').on('click',function(){
  alert('here you go');
});

// does work
$(document).on('click','.loc-to-select', function(){
  alert('here you go');
}); 
```

所有这一切都发生在 jQuery 的 $(document).ready 完成触发之后。据我了解，这是 jQuery 提供的主要功能。我熟悉事件冒泡的概念。我还阅读了此处的文档[http://api.jquery.com/on/](http://api.jquery.com/on/) ，其中讨论了委托事件。我在内部不了解 jQuery 是如何通过后代元素做到这一点的。其中一些讨论了它如何从用户空间 pov 处理：[Direct vs. Delegated - jQuery .on()](https://stackoverflow.com/questions/8110934/direct-vs-delegated-jquery-on)

此外，出于性能原因，似乎首选后代元素技术。后代元素模型基本上是说，如果我们在 DOM 中添加了一些新的东西，检查它是否符合“委托元素”模型，而直接事件会绕过这个？

在更简单的层面上，jQuery“运行时”本质上是监视 DOM 的更改然后检查还是在更早的时候检查例如 html 函数（本质上是通过 html 解析它知道的项目）？

最后，他们为什么不把第二种语法（委托语法）设为默认？它似乎提供了更大的特异性和更好的性能（如文档中所述）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:55:28.247

我不能 100% 确定您想知道什么，因为您链接到的问题（[直接与委托 - jQuery .on()](https://stackoverflow.com/questions/8110934/direct-vs-delegated-jquery-on)）似乎可以回答您的要求。

这里再次解释不同之处：

```
$('.loc-to-select').on('click',function(){
  alert('here you go');
}); 
```

将搜索当时存在的所有**元素**`.loc-to-select`并将事件处理程序绑定到每个元素。

 **使用 DOM API 的等价物是：

```
var elements = document.getElementsByClassName('loc-to-select');
for(var i = 0, l = elements.length; i < l; i++) {
    elements[i].onclick = handler;
} 
```

现在考虑

```
$(document).on('click','.loc-to-select', function(){
  alert('here you go');
}); 
```

**仅将一个**事件处理程序绑定到`document`. 它检查*每个*点击事件并测试它是否来自具有 class 的元素或内部`loc-to-select`。

同样，DOM 等价物（简化）：

```
document.body.onclick = function(event) {
    if(event.target.className === 'loc-to-select') {
         handler.call(this);
    }
} 
```

* * *

jQuery 不监视 DOM 的变化，它只是利用事件在树上冒泡的事实。

> 最后，他们为什么不把第二种语法（委托语法）设为默认？它似乎提供了更大的特异性和更好的性能（如文档中所述）

让我们再次回顾一下事件委托中发生的事情：单个事件处理程序绑定到一个元素以处理多个（相似）元素。这意味着您只需要搜索和触摸`x`元素来处理`y`元素，`x << y`即设置它的速度更快。

但它带来了一个折衷：由于事件首先遍历树并且必须评估原点，无论它是否匹配，当它发生时处理一个事件需要更多时间。
考虑一下如果您对页面上的*所有*单击事件使用事件委托并将处理程序绑定到`document`. 您最终会得到`n`绑定到 的事件处理程序`document`，并且它们中的每一个都将在单击时执行。但其中`n`只有**一个** *需要*被执行。这似乎不是很高效。

使用直接事件处理，设置会更慢，因为您必须找到所有元素并将事件处理程序绑定到每个元素。如果元素不多，那不是问题，但如果有很多，则可以。显然，绑定的事件处理程序越多，浏览器的性能就越差，但这可能会改变或已经改变。

这是在将许多事件处理程序绑定到许多执行较少次数的元素和将少数事件处理程序绑定到少数执行多次的元素之间进行权衡。**

# iis-7 - 带有经典 ASP 的 FileSystemObject 在 IIS7+ Win server 2008 上无法正常工作

> ID：11972660
> 
> 赞同：1
> 
> 时间：2012-08-15T15:50:40.663
> 
> 标签：iis-7, asp-classic, windows-server-2008, filesystemobject

最近我将我的经典 asp 应用程序从 Windows XP + IIS5 移动到 Windows Server 2008 + IIS7。除了一件事之外，几乎一切工作正常...... FileSystemObject 无法访问远程 PC 中共享文件夹上的文件或文件夹。以下代码总是导致“文件不存在”，相信我文件存在！

```
set fg=Server.CreateObject("Scripting.FileSystemObject")
if fg.FileExists("\\netapp1\CM\CompilationResults\6.6 Release\TCL\L6.50.001\alias.tcl") then
     response.write("File Exists")
else
     response.write("File Doesn't Exists")
end if 
```

在本地文件夹上尝试 FileExists 时，它可以正常工作。这工作正常：

```
if fg.FileExists(Server.MapPath ("Logs\Add pc\Status log\status_file.txt")) then ...... 
```

**有谁知道如何解决这个问题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:55:58.230

可能是与您对 inetpub 文件夹的权限有关的问题，

检查这个提示

[http://forums.iis.net/t/1149760.aspx](http://forums.iis.net/t/1149760.aspx)

[http://forums.iis.net/t/1154590.aspx](http://forums.iis.net/t/1154590.aspx)

[IIS7 权限被拒绝 - ASP 文件写入](https://stackoverflow.com/questions/4505634/iis7-permission-denied-asp-file-write)

[http://forums.iis.net/t/1182149.aspx](http://forums.iis.net/t/1182149.aspx)

# grails - grails查询不同的条目

> ID：11972665
> 
> 赞同：1
> 
> 时间：2012-08-15T15:51:01.153
> 
> 标签：grails

您好我正在尝试通过特定属性查询我的数据库。我的数据库中的多个条目可能具有相同的属性值，但我希望它只返回具有该属性不同值的第一个条目。

例如，如果我的域有一个`code`属性，那么可能有一个条目 where `"code" = "boy"`，可能还有另一个 where `"code" = "girl"`，可能还有另一个 where `"code" = "boy"`。我想查询它，所以我得到第一个条目 where`"code" = "boy"`和条目 where`"code" = girl"`但不是第三个条目 where`code`再次等于`boy`.

我能够`code`使用两者从数据库中获取不同的值，`createCriteria()`但是`namedQueries()`我无法获取整个对象，只是`code`. 我怎样才能得到实际的对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T19:57:31.423

想想我带来了一个 HQL 查询：

```
select d
  from Domain d
 where d.id = (select min(d1.id)
                 from Domain d1
                where d1.code = d.code) 
```

# c# - 在asp.net c#中使用下拉列表时，如何从gridview中的一行获取e.CommandArgument？

> ID：11972673
> 
> 赞同：1
> 
> 时间：2012-08-15T15:51:53.290
> 
> 标签：c#, asp.net, gridview, commandargument, html-select

最近我问了一个类似的问题，你可以在下面的链接中找到

[在gridview Asp.Net 中使用下拉列表？](https://stackoverflow.com/questions/11959430/using-dropdownlist-in-a-gridview-asp-net)

我有一个看起来像这样的gridview...

```
<asp:GridView ID="grdvEventosVendedor" runat="server" AllowPaging="True" 
                AutoGenerateColumns="False" CellPadding="4" DatakeyNames="idCita"
                EmptyDataText="No Hay Eventos Para Este Vendedor" ForeColor="#333333" 
                GridLines="None" AllowSorting="True"
                onpageindexchanging="grdvEventosVendedor_PageIndexChanging" 
                onrowcommand="grdvEventosVendedor_RowCommand" 
                onsorting="grdvEventosVendedor_Sorting" CellSpacing="1" 
                onrowdatabound="grdvEventosVendedor_RowDataBound" >
                <AlternatingRowStyle BackColor="White" ForeColor="#284775"/>

                <Columns>
                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnEdicEvento" runat="server" 
                                CommandArgument='<%# Eval("idCita")%>' CommandName="Edicion" 
                                Height="32px" ImageUrl="~/img/pencil_32.png" Width="32px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="" ItemStyle-Width="35px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnDelete" runat="server"
                                CommandName="Borrar" 
                                ImageUrl="~/img/1385_Disable_16x16_72.png" 
                                onclientclick="return confirm('¿Desea eliminar el registro?');" 
                                CommandArgument='<%# Eval("idCita")%>' />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="Cliente" HeaderText="Cliente" InsertVisible="False" ReadOnly="True" SortExpression="Cliente" ItemStyle-Width="50px" />
                    <asp:BoundField DataField="Empresa" HeaderText="Empresa" InsertVisible="False" ReadOnly="True" SortExpression="Empresa" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Telefono" HeaderText="Telefono" InsertVisible="False" ReadOnly="True" SortExpression="Telefono" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Nextel" HeaderText="Nextel" InsertVisible="False" ReadOnly="True" SortExpression="Nextel" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Tipo" HeaderText="Tipo" InsertVisible="False" ReadOnly="True" SortExpression="Tipo" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Descripcion" HeaderText="Descripcion" InsertVisible="False" ReadOnly="True" SortExpression="Descripcion" ItemStyle-Width="100px"/>

                    <asp:TemplateField HeaderText="Fecha" SortExpression="Fecha" ItemStyle-Width="50px">
                        <ItemTemplate>                                            
                            <%# DataBinder.Eval(Container.DataItem, "Fecha", "{0:dd/MM/yyyy}")%>
                        </ItemTemplate>

                        <EditItemTemplate>                                        
                            <asp:TextBox ID="tbxFecha"  runat="server" Text='<%#Bind("Fecha","{0:dd/MM/yyyy}") %>' ValidationGroup="gpEdicionAgenda">
                            </asp:TextBox>
                        </EditItemTemplate>
                    </asp:TemplateField>

                    <asp:BoundField DataField="HoraInicio" HeaderText="Hora" InsertVisible="False" ReadOnly="True" SortExpression="HoraInicio" ItemStyle-Width="50px"/>
                    <asp:BoundField DataField="Lugar" HeaderText="Lugar" InsertVisible="False" ReadOnly="True" SortExpression="Lugar" ItemStyle-Width="50px"/>
                    <%--<asp:BoundField DataField="Estado" HeaderText="Estado" InsertVisible="False" ReadOnly="True" SortExpression="Estado" ItemStyle-Width="50px"/>--%>

                    <asp:TemplateField HeaderText="Estado" ItemStyle-Width="50px">
                        <ItemTemplate>
                            <asp:DropDownList ID="dpdListEstado" runat="server" OnSelectedIndexChanged="dpdListEstado_SelectedIndexChanged" AutoPostBack="True">
                                <asp:ListItem>Pendiente</asp:ListItem>
                                <asp:ListItem>Atendido</asp:ListItem>
                            </asp:DropDownList>
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="CRM" ItemStyle-Width="25px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnCRM" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="CRM" 
                                ImageUrl="~/img/activar.png" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="VM" ItemStyle-Width="25px">
                        <ItemTemplate>
                            <asp:ImageButton ID="imgBtnVerMas" runat="server"
                                CommandArgument='<%# Eval("IdCliente")%>' CommandName="VerMas" 
                                ImageUrl="~/img/search.png" Width="16px" Height="16px" />
                        </ItemTemplate>
                    </asp:TemplateField>
                </Columns>

                <EditRowStyle BackColor="#999999" Font-Size="Small" />
                <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
                <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" Font-Size="Larger" />
                <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
                <RowStyle BackColor="#F7F6F3" ForeColor="#333333" HorizontalAlign="Center" Font-Size="Small" />
                <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
                <SortedAscendingCellStyle BackColor="#E9E7E2" />
                <SortedAscendingHeaderStyle BackColor="#506C8C" />
                <SortedDescendingCellStyle BackColor="#FFFDF8" />
                <SortedDescendingHeaderStyle BackColor="#6F8DAE" />
            </asp:GridView> 
```

如链接中所述，我必须手动添加一些代码，例如 OnSelectedIndexChanged="dpdListEstado_SelectedIndexChanged" AutoPostBack="True" 并将其添加到 cs 文件中...

```
 protected void dpdListEstado_SelectedIndexChanged(object sender, EventArgs e)
    {

    } 
```

我已经尝试过了，它确实有效，每当我更改 ddl 的值时，它确实会进入 cs 文件的 void int ......

但是现在我有一个问题...

我需要存储在特定行中的记录中的Id（idCita，就像我使用CommandArgument的按钮一样）......这样可以使用我拥有的另一个类，它将触发一个查询，该查询将编辑一个名为埃斯塔多……

但是，我注意到当我使用 CommandArguments 时，我使用了另一个名为...

```
protected void grdvEventosVendedor_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        int intIdCita = int.Parse(e.CommandArgument.ToString());

        if (e.CommandName == "Edicion")
        {
            //Some Code
        }

        else if (e.CommandName == "Borrar")
        {
           //More Code
        }

        else if (e.CommandName == "CRM")
        {
            //Even More Code
        }

        else if (e.CommandName == "VerMas")
        {
            //....
        }
    } 
```

有了这个我可以同时调用 e.CommandName 告诉我我按下了哪个按钮，以及 e.CommandArgument 是 idCita 的值......但是我注意到我之前向你展示的 ddl void 没有 GridViewCommandEventArgs e，而是它有一个 EventArgs e...

有没有一种方法可以让我从 gridview 中获取 idCita 的值，一直到 ddl void？

我需要在gridview代码和cs文件中添加什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:24:01.850

重构你的代码是这样的——它应该能让你大部分时间到达那里，另外考虑将 else if 语句转换为更具可读性的 switch case 语句......

```
protected void dpdListEstado_SelectedIndexChanged(object sender, EventArgs e)
{
    GridViewRow gvr = (GridViewRow)(((Control)sender).NamingContainer);   
    MeaningfulNameHere(int.Parse(grdvEventosVendedor.DataKeys[gvr.RowIndex]),"Estado");
}

protected void grdvEventosVendedor_RowCommand(object sender, GridViewCommandEventArgs e)
{
    MeaningfulNameHere(int.Parse(e.CommandArgument.ToString()),e.CommandName);
}

private void MeaningfulNameHere(int id, string commandName)
{

    if (commandName == "Edicion")
    {
        //Some Code
    }

    else if (commandName == "Borrar")
    {
       //More Code
    }

    else if (commandName == "CRM")
    {
        //Even More Code
    }

    else if (commandName == "VerMas")
    {
        //....
    }

    else if (commandName == "Estado")
    {

    }
} 
```

# php - 用PHP中的其他文本包围字符串的某种方式？

> ID：11972683
> 
> 赞同：1
> 
> 时间：2012-08-15T15:52:36.733
> 
> 标签：php, javascript, arrays, string, text

我有以下 PHP 函数：

```
 public function createOptions($options, $cfg=array()) {
        $cfg['methodKey'] = isset($cfg['methodKey']) ? $cfg['methodKey'] : 'getId';
        $cfg['methodValue'] = isset($cfg['methodValue']) ? $cfg['methodValue'] : 'getName';
        $cfg['beforeKey'] = isset($cfg['beforeKey']) ? $cfg['beforeKey'] : '';
        $cfg['beforeValue'] = isset($cfg['beforeValue']) ? $cfg['beforeValue'] : '';
        $cfg['afterKey'] = isset($cfg['afterKey']) ? $cfg['afterKey'] : '';
        $cfg['afterValue'] = isset($cfg['afterValue']) ? $cfg['afterValue'] : '';
        $array = array();
        foreach ($options as $obj) {
            $array[$cfg['beforeKey'] . $obj->$cfg['methodKey']() . $cfg['afterKey']] = $cfg['beforeValue'] . $obj->$cfg['methodValue']() . $cfg['afterValue'];
        }
        return $array;
} 
```

这是我在我的应用程序中用来从数组数据创建选择框的东西。我最近刚刚添加了 4 个新的 $cfg 变量，用于在选择框的键和值之前或之后添加字符串。例如，如果我的下拉列表默认看起来像“A、B、C”，我可以通过：

```
$cfg['beforeValue'] = 'Select ';
$cfg['afterValue'] = ' now!'; 
```

并获得“立即选择 A！，立即选择 B！，立即选择 C！”

所以这很好用，但我想知道 PHP 中是否有某种方法可以用一行而不是两行来实现这一点。我认为必须有一种特殊的方法来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T15:58:03.157

首先，用这个简化那个可怕的代码：

```
public function createOptions($options, array $cfg = array()) {
    $cfg += array(
        'methodKey'   => 'getId',
        'methodValue' => 'getName',
        ...
    ); 
```

不需要所有`isset`重复的键名，一个简单的数组联合就可以了。

其次，你可以使用类似的东西[`sprintf`](http://php.net/sprintf)：

```
$cfg['surroundingValue'] = 'Select %s now!';
echo sprintf($cfg['surroundingValue'], $valueInTheMiddle); 
```

# php - 为什么这个正则表达式 str_replace 不起作用？

> ID：11972695
> 
> 赞同：0
> 
> 时间：2012-08-15T15:53:21.087
> 
> 标签：php, regex

我正在尝试使用正则表达式将字符串中的任何域替换为另一个域，但它还没有工作。

我在 regexpal.com 上测试了 RegEx 部分，它似乎工作正常。

这是我的代码：

```
$itemdesc = str_replace("([a-z0-9\-]+).(com|net|org|co|cm|info|cc)\s\i","Example.com",$itemdesc); 
```

请帮忙！提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:54:59.197

您需要分隔符和 preg_replace：

```
$itemdesc = preg_replace("/([a-z0-9\-]+)\.(com|net|org|co|cm|info|cc)/si","Example.com",$itemdesc); 
```

注意两端的斜线 - 最后一个分隔符后面的修饰符

另请注意，分隔符可以是任何字符 - 尝试使用正则表达式中未使用的字符，否则需要在任何地方进行转义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:55:45.580

str_replace 不接受正则表达式作为参数，你必须使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)

# jenkins - jbehave 与 jenkins 的集成

> ID：11972696
> 
> 赞同：3
> 
> 时间：2012-08-15T15:53:24.600
> 
> 标签：jenkins, continuous-integration, jbehave

我必须将 jbehave 与 jenkins 集成。但我不知道如何做到这一点。我看到我必须在 Jenkins 中创建一个任务，但我不知道我应该在哪里连接 jbehave 这个任务。

有人可以帮助我吗？

谢谢，

萨朗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-02T04:22:24.193

所以我假设您已将 JBehave 与 Maven 集成，对吗？简单的构建环境可以设置如下：

1.  转到 Jenkins 并添加一个类型为“构建 maven2/3 项目”的新工作
2.  配置您的项目以从您使用的任何源存储库中签出您的项目。
3.  配置项目的构建阶段以运行您需要的任何 Maven 目标（“安装”可能会起作用）
4.  点击保存，您就有了一个工作项目，该项目将完全按照命令行执行。

如果您想看到 JBehave 测试输出在 Jenkins 中呈现得很好，您还应该按照以下说明配置 Jenkins/XUnit 插件：http: [//jbehave.org/reference/stable/hudson-plugin.html](http://jbehave.org/reference/stable/hudson-plugin.html)

您还需要确保您的项目配置为使用 StoryReporterBuilder 中的 XML 输出格式以使用插件（上述说明中未提及）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T10:41:23.287

您可以访问以下网站了解详情：

[http://jbehave.org/reference/stable/hudson-plugin.html](http://jbehave.org/reference/stable/hudson-plugin.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-06T05:46:20.373

根据您的评论，您希望在使用 Maven 插件时指定要通过 Jenkins 运行的故事。这是一种方法：

创建[StoryFinder](http://jbehave.org/reference/stable/javadoc/core/org/jbehave/core/io/StoryFinder.html)的子类并将其设置为[Maven 配置](http://jbehave.org/reference/stable/maven-goals.html)`storyFinderClass`中的属性。在 Jenkins 命令行启动器中，您可以将故事作为`-D`系统属性传入，然后可以从 StoryFinder 中读取该属性。

**命令行**

```
mvn ... -Dcom.sarang.stories="foo.story,bar.story" 
```

**马文**

```
<plugin>
    <groupId>org.jbehave</groupId>
    <artifactId>jbehave-maven-plugin</artifactId>
    <version>[version]</version>
    <executions>
        <execution>
            <id>run-stories-as-embeddables</id>
            <phase>integration-test</phase>
            <configuration>
                ...
                <systemProperties>
                    <property>
                      <name>com.sarang.stories</name>
                      <value>${com.sarang.stories}</value>
                    </property>
                </systemProperties>
                <storyFinderClass>com.sarang.MyStoryFinder</storyFinderClass>
            </configuration>
            <goals>
                <goal>run-stories-as-embeddables</goal>
                ...
            </goals>
        </execution>
    </executions>
</plugin> 
```

**故事查找器**

```
package com.sarang;

import org.jbehave.core.io.StoryFinder;
import java.util.*;

public class MyStoryFinder extends StoryFinder {
    @Override
    protected List<String> scan(String basedir, List<String> includes,
            List<String> excludes) {
        //List<String> defaultStories = super.scan(basedir, includes, excludes);
        String myStories = System.getProperty("com.sarang.stories");
        return Arrays.asList(myStories.split(","));
    }
} 
```

# matlab - 如何找到由光栅状物质产生的图像中仅有的两点之间的距离？

> ID：11972700
> 
> 赞同：0
> 
> 时间：2012-08-15T15:53:36.750
> 
> 标签：matlab, image-processing

我需要找到两点之间的距离。我可以通过图像处理工具箱中的像素到厘米转换器手动找到它们之间的距离。但我想要一个代码来检测图像中的点位置并计算距离。更准确地说，图像仅包含三个点，其中一个是中间，另外两个与它的距离大致相等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:49:46.437

可能有比这更好的方法，但我昨晚一起破解了类似的东西。

使用[bwboundaries](http://www.mathworks.com/help/toolbox/images/ref/bwboundaries.html "边界")查找图像中的对象（黑白图像中的连续区域）。

第二个返回的矩阵`L`是相同的图像，但区域编号。所以对于第一点，你想隔离所有与之相关的像素，

```
L2 = (L==1) 
```

现在找到该区域的中心（对于对象 1）。

```
x1 = (1:size(L2,2))*sum(L2,1)'/size(L2,2);

y1 = (1:size(L2,1))*sum(L2,2)/size(L2,1); 
```

对图像中的所有区域重复此操作。你应该有每个点**的质心。**我认为这应该为你做，但我还没有测试过。

# asp.net - 当谷歌机器人或其他爬虫发出请求时，asp.net 避免在线用户计数增加

> ID：11972701
> 
> 赞同：2
> 
> 时间：2012-08-15T15:53:39.897
> 
> 标签：asp.net, web-applications, statistics

我们正在做

```
 Appliation["OnlineUsers"] += 1 in Session Start, 
```

但是，每当 google bot 扫描我们的网站时，这个数字就会快速增加，我们通常希望避免这种情况。我们只想为真实用户增加这个数字。

让我们知道任何其他建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:11:59.593

如果您想要一个正则表达式，您可以使用它来匹配许多蜘蛛，并且匹配（我发现是）常见的攻击尝试：

```
 '' portions of the browser string which indicate a spider
    Dim re As New Regex("bot|spider|slurp|crawler|teoma|DMOZ|;1813|findlinks|tellbaby|ia_archiver|nutch|voyager|wwwster|3dir|scooter|appie|exactseek|feedfetcher|freedir|holmes|panscient|yandex|alef|cfnetwork|kalooga|Charlotte|isara|butterfly|kilomonkey|larbin|postrank|webcollage|netcraft|Netintelligence|baypup|dragonfly|EmailSiphon|ExactSearch|LucidMedia|Mail\.Ru|MSIndianWebcrawl|PycURL|Python-urllib|Qryos|Robozilla|SBIder|StackRambler|BoardReader|scoutjet|allrati|192\.comAgent|cizilla|dnsdigger|qwant", RegexOptions.Compiled Or RegexOptions.IgnoreCase)

    '' attacks
    Dim badRe As New Regex("morfeus|nv32ts|dragostea|zmeu|DataCha0s|GT::WWW|CZ32ts", RegexOptions.IgnoreCase Or RegexOptions.Compiled) 
```

然后

```
If re.IsMatch(userAgentString) Then ' it's a spider 
```

对于攻击尝试也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:56:29.680

我建议在您的代码中检查 USER AGENT，所有机器人都必须如此标识自己，以便您可以在这个意义上进行检查。

但是，您必须以其他方式进行计数，而不是检查会话开始。

# jsf-1.2 - Seam2：Page.xml 和 view-id

> ID：11972703
> 
> 赞同：2
> 
> 时间：2012-08-15T15:53:49.757
> 
> 标签：jsf-1.2, seam2

在搜索项目中的错误时，我发现了许多`page.xml`文件，其中“view-id”显示为完全错误的路径（旧结构），或者有些根本没有`view-id`！

据我了解Seam它是这样工作的：
我在浏览器中调用。`pages/index.xhtml`
然后Seam查看是否有`page.xml`一个`view-id`指向`pages/index.xhtml`

会发生什么，如果其中`page.xml`有一些导航规则和操作，但`view-id`指向`pages/foo/index.xhtml`

发生了什么`page.xml`，根本没有`view-id`？

导航规则和操作永远不应该被调用，因为它不是通过 连接的`view-id`，对吧？

# android - android listview 滚动后显示虚假数据（自定义适配器）

> ID：11972704
> 
> 赞同：9
> 
> 时间：2012-08-15T15:53:51.383
> 
> 标签：android, listview, scroll, adapter

我有一个奇怪的问题让我发疯。在我的 android 应用程序中，我定制了我自己的从 ArrayAdapter 扩展的适配器。我添加适配器的 ListView 的项目可以是标记文本（不可编辑）、可编辑文本或微调器。疯狂的是：当我滚动 ListView 时，有两个问题：

(1)微调器项目中显示的（选定的）**值有时会****发生变化**，尽管我只滚动了！！当我单击微调器时，仍然显示旧的选定值（应该由微调器显示的那个）（2）当我滚动时，ListViewItems的**顺序会****发生变化！**

=>但是**适配器中的数据没有改变**（数据本身和顺序都没有） - 所以它一定是视图本身的问题？！也许android在后台缓存并且没有尽快刷新ListViewItems或类似的东西？！

有人可以帮我吗？

多谢！

好的，我找到了一个不是很好的解决方案，但它确实有效。我只是不再使用 convertView 了，尽管这在内存和性能方面不是最理想的。在我的情况下应该没问题，因为我的 ListView 的最大项目数量是 15。这是我的适配器类：

```
 public class FinAdapter extends ArrayAdapter<Param>{
    public Param[] params;
    private boolean merkzettel;
    protected EditText pv;

    public FinAdapter(Context context, int textViewResourceId, Param[] items, boolean merkzettel) {
        super(context, textViewResourceId, items);
        this.params = items;
        this.merkzettel = merkzettel;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final Param p = params[position];
        if(p != null){
            if(merkzettel){
                if (convertView == null) {
                    LayoutInflater vi = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    convertView = vi.inflate(R.layout.merk_det_item, null);
                }
                TextView tvl = (TextView) convertView.findViewById(R.id.paramM);
                TextView edl = (TextView) convertView.findViewById(R.id.param_valueM);
                TextView pal = (TextView) convertView.findViewById(R.id.param_unitM);
                if (tvl != null) {
                    tvl.setText(p.getName());                            
                }
                if(pal != null){
                    pal.setText(p.getUnit());
                }
                if(edl != null){
                    edl.setText(p.getDefData());
                }
            }
            else{
                if(p.isSelect()){

                if (convertView == null) {
                    LayoutInflater vi = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    convertView = vi.inflate(R.layout.fin_prod_list_item_select, null);
                }            
                TextView tvs = (TextView) convertView.findViewById(R.id.paramS);
                Spinner sp = (Spinner) convertView.findViewById(R.id.spinner_kalk);
                TextView paU = (TextView) convertView.findViewById(R.id.param_unitS);

                if (tvs != null) {
                    tvs.setText(p.getName());                            
                }
                if(paU != null){
                    paU.setText(p.getUnit());
                }
                if(sp != null){
                    String[] values = new String[p.getData().size()];
                    for(int i=0; i<values.length; i++){
                        values[i] = p.getData().get(i);
                    }
                    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this.getContext(), android.R.layout.simple_spinner_item, values);
                    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
                    sp.setAdapter(adapter);
                    sp.setSelection(p.getData().indexOf(p.getDefData()));
                    sp.setOnItemSelectedListener(new OnItemSelectedListener(){
                        public void onItemSelected(AdapterView<?> parent,
                                View convertView, int pos, long id) {
                            p.setDefData(p.getData().get(pos));
                            p.setChanged(true);
                        }
                        public void onNothingSelected(AdapterView<?> arg0) {
                            // TODO Auto-generated method stub

                        }

                    });
                }
            }       
            else if(p.isEdit()){
                if (convertView == null) {
                    LayoutInflater vi = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    convertView = vi.inflate(R.layout.fin_prod_list_item_edit, null);
                }
                TextView pa = (TextView) convertView.findViewById(R.id.param);
                pv = (EditText) convertView.findViewById(R.id.param_value);
                TextView paE = (TextView) convertView.findViewById(R.id.param_unit);
                if (pa != null) {
                    pa.setText(p.getName());                            
                }
                if(paE != null){
                    paE.setText(p.getUnit());
                }
                if(pv != null){
                    pv.setText(p.getDefData());
                    pv.setOnEditorActionListener(new OnEditorActionListener(){
                        public boolean onEditorAction(TextView convertView, int actionId,
                                KeyEvent event) {
                            // TODO Auto-generated method stub
                            p.setDefData(pv.getText().toString());
                            p.setChanged(true);
                            return false;
                        }                   
                    }); 
                }

            }
            else if(p.isLabel()){
                if (convertView == null) {
                    LayoutInflater vi = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    convertView = vi.inflate(R.layout.fin_prod_list_item_label, null);
                }
                TextView tvl = (TextView) convertView.findViewById(R.id.paramL);
                TextView edl = (TextView) convertView.findViewById(R.id.param_valueL);
                TextView pal = (TextView) convertView.findViewById(R.id.param_unitL);
                if (tvl != null) {
                    tvl.setText(p.getName());                            
                }
                if(pal != null){
                    pal.setText(p.getUnit());
                }
                if(edl != null){
                    edl.setText(p.getDefData());
                }   
            }}
        }
        return convertView;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T08:33:58.523

我对列表中的多个项目类型有类似的问题。在我的情况下，列表项是一个部分（标签）项或一个常见的列表项。

要使用此类列表，您应该重写`getViewTypeCount`和`getItemViewType`方法。像这样的东西：

```
private static final int ITEM_VIEW_TYPE_ITEM = 0;
private static final int ITEM_VIEW_TYPE_SEPARATOR = 1;

@Override
public int getViewTypeCount() {
    return 2;
}

@Override
public int getItemViewType(int position) {
    return this.getItem(position).isSection() ? ITEM_VIEW_TYPE_SEPARATOR : ITEM_VIEW_TYPE_ITEM;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    final Item item = this.getItem(position);

    if (convertView == null) {
        convertView = mInflater.inflate(item.isSection() ? R.view1 : R.view2, null);
    }

    if(item.isSection()){
        //...
    }
    else{
        //...
    }

    return convertView;
} 
```

然后 convertView 参数将始终正确并包含您需要的类型。

还有一件事：`public Param[] params`当您已经在基类中拥有该字段时，您显式添加了该字段`ArrayAdapter<Param>`。

我建议从`BaseAdapter`类继承。

**编辑：** 这是您可以尝试使用的代码来完成您的`Spinner`工作：

```
sp.setTag(p);
sp.setOnItemSelectedListener(new OnItemSelectedListener(){
public void onItemSelected(AdapterView<?> parent, View convertView, int pos, long id) {
    Param currentItem = (Param)parent.getTag();
    currentItem.setDefData(currentItem.getData().get(pos));
    currentItem.setChanged(true);
}
//... 
```

尝试使用`getTag`和`setTag`方法的组合。我记得我在事件处理程序和最终变量方面也有类似的问题，但我完全忘记了它们的原因，所以我无法准确解释为什么会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:06:07.967

正如 Sam 所说，Android 系统总是尽可能地尝试回收以节省资源。这意味着，开发人员需要自己跟踪`View`。`ListView`对于实体，或所谓的表示数据结构，您可以有一些东西来跟踪选择/取消选择状态，例如：

```
class PresentationData {
    // other stuffs..
    boolean isSelected = false;
} 
```

将这些数据结构映射到`Adapter`，如果单击了任何项目，则将状态设置为 true：`listPresentationData.get(selected_position).isSelected = true`

好的，所以在`getView()`适配器中，为您的数据正确跟踪演示文稿。

```
if(listPresentationData.get(position).isSelected) 
{ 
    // set background color of the row layout..or something else 
} 
```

此外，值得一提的是，最好为每个视图都有一个内存缓存，通常也称为`ViewHolder`提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-08T16:05:57.823

正如大家所说，Android 回收视图。这意味着什么？想象一下，您的列表中有 10 个项目，但屏幕上只显示了 3 个项目。向下滚动时，第一个将消失，而第四个将出现。第四个项目已经在 Android 系统中，但第五个是从第一个项目创建的，使用相同的视图。就我而言，我有一个带有默认背景的 TextView。但是，如果满足某些条件，我会更改背景。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ...
    if (someCondition) {
        holder.textView.setBackground(R.drawable.different_background)
    }
    ...
} 
```

问题是如果不满足条件，我不会设置默认背景（因为我认为视图是为每个项目创建的）。当第一项条件为真时出现问题，因此回收视图与 different_background 一起使用，而不是默认背景。为了避免这个问题，我必须始终设置条件的两个分支并设置默认值，如下所示：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ...
    if (someCondition) {
        holder.textView.setBackground(R.drawable.different_background)
    } else {
        holder.textView.setBackground(R.drawable.default_background)
    }
    ...
} 
```

# ember.js - 在 Ember ArrayController 中查找项目

> ID：11972705
> 
> 赞同：2
> 
> 时间：2012-08-15T15:53:52.893
> 
> 标签：ember.js, controller, enumerable, ember-old-router

在 Ember.js 中查找项目的正确方法是什么`ArrayController`？我在控制器中有一组联系人：

```
App.contactsController = Em.ArrayController.create({
    content:[],
}); 
```

控制器中有对象，它们被显示并且一切正常。然后，我想用序列化/反序列化实现路由器：

```
...
deserialize:function (router, params) {
    var contact = App.contactsController.find(function(item) {
        return item.id == params.contact_id;
    });
},
... 
```

但是，find 函数似乎没有进行任何迭代。可能是什么原因？路由器是否有可能在应用程序调用其`ready`方法之前尝试进行路由？那是我用数据填充控制器的地方。

编辑：好吧，我发现路由器在我用数据填充我的arrayController之前尝试进行转换（在`Ember.Application.ready`方法中）。正确设置数据后是否可以“延迟”路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T14:27:04.770

```
var contact = App.contactsController.filter(function(item) {
    return item.id == params.contact_id;
}); 
```

我认为您可以在设置路由器后运行 Application.initialize() 。您可以使用观察者来检测数据集。

```
dataChanged: function() {
    console.log(this.get('content.length'));
    // before emberjs 1.0pre
    // console.log(this.getPath('content.length')); 
}.observes('content') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T14:34:03.440

该问题实际上是由 Router 进行反序列化后将数据插入 arrayController 引起的。把它放在 App.initialize() 之前解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T07:14:53.240

正确答案是：

```
var contact = App.contactsController.content.find(function(item) {
    return item.id == params.contact_id;
}); 
```

如果您不指向内容数组，它将不会返回项目。

# javascript - jquery：如何更改整个 CSS 类的属性？

> ID：11972708
> 
> 赞同：0
> 
> 时间：2012-08-15T15:53:55.923
> 
> 标签：javascript, jquery, css

> **可能重复：**
> [从 Javascript 更改 CSS 规则集](https://stackoverflow.com/questions/1409225/changing-a-css-rule-set-from-javascript)

我知道 CSS 中没有变量，但是如果可以使用 JQ 更改页面上的 CSS 列表主体 - 它可能会解决这个问题。另外，我知道 addClass/removeClass 和 css('blabla','blabla') JQ 方法，这不是我需要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:16:03.150

您可以使用 body 类，然后使用 CSS 仅操作 body 类，然后根据您的 body 类设置所有样式。

```
<body class="my-skin">
   <p>Lorem<p>
</body> 
```

在你的**CSS**中：

```
.my-skin p{color: red}
.my-skin img{border:2px solid #333;margin:5px}

.second-skin p{color:blue} 
```

jQuery：

```
$('body').addClass('my-skin');
//or
$('body').removeClass('my-skin').addClass('second-skin'); 
```

# opengl-es - opengl es 2.0 中 gldisable(gl_cull_face) 后的照明问题

> ID：11972713
> 
> 赞同：2
> 
> 时间：2012-08-15T15:54:05.017
> 
> 标签：opengl-es, opengl-es-2.0

我一直在使用 opengl es 2.0 处理头骨。骷髅出现了，没有一些面孔：

![在此处输入图像描述](../Images/dfd50e400f15aa314331d49ff81a3758.png)

之后我决定禁用 gl_cull_face。脸的问题是

解决了，但是头骨现在没有光出现，我没有更改着色器代码：

![在此处输入图像描述](../Images/15a4877c14f0e45a1c8a2216a9c15dd0.png)

我尝试了其他照明算法，头骨继续变黑。我不明白 gldisable(gl_cull_face) 和照明之间的关系是什么。着色器代码是这样的：

顶点着色器：

```
uniform mediump mat4 MODELVIEWMATRIX;
uniform mediump mat4 PROJECTIONMATRIX;
uniform mediump mat3 NORMALMATRIX;
uniform mediump vec3 LIGHTPOSITION;

varying lowp vec3 lightcolor;
attribute mediump vec3 POSITION;
attribute lowp vec3 NORMAL;
lowp vec3 normal;
attribute mediump vec2 TEXCOORD0;
varying mediump vec2 texcoord0;

void main( void ) {

   mediump vec3 position =  vec3( MODELVIEWMATRIX * vec4( POSITION, 1.0 ) );
   normal = normalize( NORMALMATRIX * NORMAL );
   mediump vec3 lightdirection = normalize( LIGHTPOSITION - position );
   lowp float ndotl = max( dot( normal, lightdirection ), 0.0 );
   lightcolor = ndotl * vec3( 1.0 );
   gl_Position = PROJECTIONMATRIX * vec4( position, 1.0 );
   texcoord0 = TEXCOORD0;
  } 
```

片段着色器：

```
 varying mediump vec2 texcoord0;
 uniform sampler2D DIFFUSE;
 varying lowp vec3 lightcolor;

 void main( void ) {
   gl_FragColor = texture2D( DIFFUSE, texcoord0 ) * vec4( lightcolor, 1.0 ) + vec4( 0.1);
 } 
```

谢谢你。

# jasper-reports - 输入控件上的日期格式

> ID：11972714
> 
> 赞同：2
> 
> 时间：2012-08-15T15:54:07.993
> 
> 标签：jasper-reports, jasperserver

我正在使用*iReport 4.6.0*和*JasperReports Server 4.5.0*。我创建了一个报告，我想将日期值传递给*MySQL*数据库。我创建了一个参数并使用了***java.util.Date***类。在输入控件上，我将其设置为单值类型和日期数据类型。在*iReport*中运行报告（使用**Preview**）时，系统会提示我选择一个日期，并使用指定的日期生成报告。将报告部署到*JasperReports Server*后，当系统提示我输入日期时，我得到一个空报告。我注意到服务器上的输入控件 ( *`YYYY-MM-DD`*) 上的日期格式与预览报表时的日期格式不同*iReport* ( *`MM/DD/YYYY`*)。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T13:23:07.423

我同意 mdahlman。输入控件的格式应该不是问题。它应该将有效的日期值传递给报告。

确保输入控件的名称（而不是标签）与您的参数名称完全匹配。它区分大小写。如果它们不相同，这可能是您的问题。

# asp.net-mvc-3 - 带有浮点数的 MVC 文本框，使用逗号：从剃刀视图到控制器。[全球化？]

> ID：11972717
> 
> 赞同：0
> 
> 时间：2012-08-15T15:54:22.877
> 
> 标签：asp.net-mvc-3, razor, textbox, globalization

我正在使用 MVC3 + Razor。

我正在将文本框上的参数发送到控制器。我正在使用“es-AR”全球化。
我希望浮点数具有以下格式：“9,99”（逗号作为小数分隔符）

当我在文本框中输入“逗号分隔符”数字时，控制器会在“权重”变量上收到 NULL。当我放置“点分隔符”时，权重浮动变量就可以了。

看法：

```
@Html.TextBox("weight") 
```

（基本上，这是一个搜索字段。）

控制器：

```
 public ActionResult UserQueryPage(float? weight ) 
```

网络配置：

```
 <system.web>
<globalization uiCulture="es" culture="es-AR" /> 
```

我还能做些什么吗？任何提示？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T14:32:57.657

默认模型绑定器不考虑语言环境，因此带有逗号的值永远不会正确绑定！您需要一个自定义的小数模型绑定器 [http://haacked.com/archive/2011/03/19/fixing-binding-to-decimals.aspx](http://haacked.com/archive/2011/03/19/fixing-binding-to-decimals.aspx)

# php - htaccess 重写和提交表单不能一起工作

> ID：11972718
> 
> 赞同：0
> 
> 时间：2012-08-15T15:54:56.607
> 
> 标签：php, jquery, ajax, .htaccess, rewrite

经过几次研究放弃并在这里发帖，如果有人可以澄清我的事情，那就太好了，谢谢

当我使用[http://site.com/file.php?url=2012/08/15/My-html-page](http://site.com/file.php?url=2012/08/15/My-html-page)一切正常时，ajax 将帖子发送到 file.php 并显示它，但是当我使用重写时通过 htaccess url [http://site.com/2012/08/15/My-html-page.html](http://site.com/2012/08/15/My-html-page.html)发布表单什么都不做，它不起作用

链接：

原文：[http ://site.com/file.php?url=2012/08/15/My-html-page](http://site.com/file.php?url=2012/08/15/My-html-page)

用 htaccess 重写：[http ://site.com/2012/08/15/My-html-page.html](http://site.com/2012/08/15/My-html-page.html)

数据库入口：2012/08/14/My-first-post

要添加我添加的 html 代理页面

```
$url=$url.'.html'; 
$url= $_GET["url"]; 
```

我在file.php中的ajax

```
<SCRIPT language="JavaScript">

$(function() {
$(".comment_button").click(function()
{

var element = $(this);
var note = $("#note").val();
var dataString = 'note='+note;

if(note=='')
{
$('#flash').fadeIn("fast");
}
else
{
 $.ajax({
 type: "POST",
 url: "file_post.php",
 data: dataString,
 cache: false,
 success: function(html){
 $('body').load('/<? echo $url ?>.html');
 }
 });
 }
return false;
});
});
</script> 
```

我在file.php中的表格

```
 <form name="comment" method="post" action>

 <button class="comment_button" type="submit"><span>Отправить</span></button>
 <textarea name="note" id="note"></textarea>
 </form> 
```

我在 file_post.php 中的 php 文件

```
if(isSet($_POST['note']))  {

$note=$_POST['note'];
$note = html_entity_decode($note);
$date=date("Y-m-d");
$time=date("H:i:s");

$table = "insert into comment (note, date, time) values ('$note', '$date', '$time');";
mysql_query($table);

} 
```

我的访问

```
 Options +FollowSymLinks
 Options -Indexes
 RewriteEngine On
 RewriteBase /

<Files inc/config.php>
deny from all
</Files>

RewriteRule ^([a-zA-Z0-9-/]+).html$ file.php?url=$1 [QSA,L]
RewriteRule ^([a-zA-Z0-9-/]+).html/$ file.php?url=$1 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

重写页面上的 $_SERVER['REQUEST_URI'] 给了我一个空输入，这正常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:54:40.213

尝试将您的 2 条规则更改为：

```
RewriteRule ^([a-zA-Z0-9-/]+).html$ file.php?url=$1.html [QSA,L]
RewriteRule ^([a-zA-Z0-9-/]+).html/$ file.php?url=$1.html [QSA,L] 
```

正在被剥离，`.html`因此您的 file.php 脚本被称为：

```
http://site.com/file.php?url=2012/08/15/My-html-page 
```

代替

```
http://site.com/file.php?url=2012/08/15/My-html-page.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T20:41:41.283

我不知道错误是什么，带有斜杠或数字和 htaccess 但我找到了解决方案

```
RewriteRule ^read/([A-Za-z0-9\-_]+]*)$ file.php?url=$1 [L] 
```

没有 html 或 php

# mysql - SQL 按日期查询

> ID：11972720
> 
> 赞同：2
> 
> 时间：2012-08-15T15:55:00.540
> 
> 标签：mysql, sql, aggregate-functions, greatest-n-per-group

mysql 5.5。

我有一个代表工作分配的表格：

```
 empId   jobNo   workDate   hours
     4      441    10/1/2012    10
     4      441     9/1/2012    22
     4      441     8/1/2012     6 
```

还有一个代表薪水：

```
 empId   effDate     rate
     4     10/1/2012    6.50
     4      9/1/2012    5.85
     4      6/1/2012    4.00 
```

工资适用于在生效日期或之后完成的所有工作。所以 6 月、7 月和 8 月的汇率是 4.00；sep 是 5.85，oct 是 6.50。

如果我天真地询问十月的工作：

```
 SELECT Work.empId, Work.jobNo, Work.workDate, Work.hours, Salary.effDate, Salary.rate
   FROM Work
   JOIN Salary ON Work.empId = Salary.empId
   WHERE Work.workDate <= '2012-10-01'
      AND Salary.effDate <= Work.workDate
   ORDER BY Work.jobNo ASC, Work.workDate DESC; 
```

我没有得到我想要的。我得到类似的东西

```
 4   441   10/1/2012   10   10/1/2012   6.50
   4   441   10/1/2012   10    9/1/2012   5.85
   4   441   10/1/2012   10    6/1/2012   4.00
   4   441    9/1/2012   22    9/1/2012   5.85
   4   441    9/1/2012   22    6/1/2012   4.00
   4   441    8/1/2012    6    6/1/2012   4.00 
```

当我想要

```
 4   441   10/1/2012   10   10/1/2012   6.50
   4   441    9/1/2012   22    9/1/2012   5.85
   4   441    8/1/2012    6    6/1/2012   4.00 
```

我无法完全理解如何创建我想要的查询。
显然，实际情况有多个员工，多个工作。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T16:12:51.283

这是您的实际问题：您希望能够根据工作日期 x 工资生效日期，对 Work 中的每条记录检测相应的有效率。当您只是`Salary.effDate <= WORK.workDate`在工作日期之前获得所有费率时。但你只想要最近的一个。

[这是每组最大 n](/questions/tagged/greatest-n-per-group "显示标记为“每组最大数”的问题")问题的一个稍微复杂的变体。有很多方法可以做到这一点，这里是一种：

```
SELECT sel.*, Salary.Rate
FROM
(
     SELECT Work.empId, Work.jobNo, Work.workDate, 
           Work.hours, Max(Salary.effDate) effDate
    FROM WORK
    JOIN Salary ON WORK.empId = Salary.empId
    WHERE WORK.workDate <= '2012-10-01'
       AND Salary.effDate <= WORK.workDate
    GROUP BY WORK.empId, WORK.jobNo, WORK.workDate, WORK.hours
    ORDER BY WORK.jobNo ASC, WORK.workDate DESC
) sel 
INNER JOIN Salary ON sel.empId = Salary.empId 
                  AND sel.EffDate = Salary.EffDate 
```

首先，内部查询检测每个工作记录的最近工资生效日期。然后，我们再次将其与薪水相结合。

请参阅工作[SQLFiddle](http://sqlfiddle.com/#!2/8647b/6)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:59:20.553

您正在使用所谓的 NATURAL JOIN。尝试将单词“JOIN”更改为“LEFT JOIN”，这应该将结果分组在左侧，从而为您提供所需的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T18:53:33.473

假设工资表有一个由列组成的主键或备用键（唯一索引）`empId`，`effDate`我会做这样的事情：

```
select w.empID                   as EMPLOYEE_ID   ,
       w.jobNo                   as JOB_NUMBER    ,
       w.workDate                as DATE_WORKED   ,
       w.hours                   as HOURS_WORKED  ,
       rate.HourlyWage           as HOURLY_WAGE   ,
       w.hours * rate.HourlyWage as WAGES_CHARGED ,
       rate.effDateFrom          as HOURLY_WAGE_EFFECTIVE_DATE
from work w
join ( select sfrom.EmpId   as EmpID ,
              sfrom.rate    as HourlyWage ,
              sfrom.EffDate as effDateFrom ,
              ( select min(Effdate) 
                from salary t
                where t.empId   = sfrom.EmpId
                  and t.effDate > sfrom.EffDate
              ) as effDateThru
              from salary sfrom
     ) rate on rate.empID = w.empID
           and rate.EffDateFrom <= w.workDate
           and (    rate.effDateThru is null      -- if rate has not end date, is the current period
                 or rate.effDateThru > w.workDate -- 'date-thru' represents the start date of the next period, so the this upper bound is EXCLUSIVE
               ) 
```

我们将工作表与一个虚拟`rate`表连接起来，该表为我们提供了每个员工的工资和有效的日期范围。每个员工的“当前”行将设置为截止/到期日期`null`。而且...由于截止/到期日期实际上是下一个工资条目的生效日期，因此上限是排他性的而不是包含性的。因此，范围测试必须测试 null 并且不能使用`between`.

# javascript - IE8中的jquery datepicker changeMonth下拉宽度

> ID：11972721
> 
> 赞同：0
> 
> 时间：2012-08-15T15:55:02.410
> 
> 标签：javascript, jquery, html, css, datepicker

```
<input type="text" id="txtDateTo1" size="7">

$('#myDatePicker').datepicker({changeMonth: true, changeYear: true, yearRange: '2010:2013'}); 
```

我的输入框包含在绝对定位的 DIV 中。

在 IE8 中，月份和年份的下拉菜单过于宽泛。在 chrome 中它看起来很好。

如何将两个下拉菜单强制设置为正确的宽度？或者甚至只是将像素设置为固定。

![在此处输入图像描述](../Images/f670f01d22fdbe0b5f270fa9d73aac35.png)

* * *

![在此处输入图像描述](../Images/343f0cd48689d7682d79bbd7f3401d10.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:05:55.153

只需将您的特定宽度添加到这两个 CSS 类。

```
select.ui-datepicker-month

select.ui-datepicker-year 
```

# java - java中的jdialog中隐藏/显示标签和按钮会产生噪音吗？

> ID：11972729
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:55:26.453
> 
> 标签：java, swing

我在 java 桌面应用程序中创建了一个对话框。但是，当我通过在复选框上应用条件来隐藏/显示标签和按钮时，它会通过显示后台应用程序部分的某些部分来产生图形噪声（例如标签和按钮上的红色框也会导致复选框布局出现问题）。我在复选框上写了这个条件。

```
 checkbox.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent arg0) {

            if (checkbox.isSelected()) {
                baisvalue.setVisible(true); //label
                plusbais.setVisible(true);  //button
                minisbais.setVisible(true); //button

            }
            if (!checkbox.isSelected()) {
                minisbais.setVisible(false); //label
                plusbais.setVisible(false);  //button
                baisvalue.setVisible(false); //button
            }

        }
    }); 
```

注意：我也调用 repaint(); ＆ 证实（）; 但同样的问题发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:08:45.270

我无法重现您的问题 - 我没有看到图形噪音。我附上了我尝试过的内容 - 你能用这个例子重现你的问题吗？如果是这样，您能否向我们提供有关您的 Java 版本/平台的更多信息？如果没有，您能否修改此示例以重新创建您的问题（并使用代码编辑您的问题）？

```
import java.awt.event.*;
import javax.swing.*;

public class MainPanel extends Box{

    JCheckBox checkbox = new JCheckBox("Select Me");
    JLabel baisvalue = new JLabel("baisvalue");
    JButton plusbais = new JButton("plusbais");
    JButton minisbais = new JButton("minisbais");

    public MainPanel(){
        super(BoxLayout.Y_AXIS);
        ActionListener l = new ActionListener() {

            public void actionPerformed(ActionEvent arg0) {

                if (checkbox.isSelected()) {
                    baisvalue.setVisible(true); //label
                    plusbais.setVisible(true);  //button
                    minisbais.setVisible(true); //button

                }
                if (!checkbox.isSelected()) {
                    minisbais.setVisible(false); //label
                    plusbais.setVisible(false);  //button
                    baisvalue.setVisible(false); //button
                }

            }
        };
        checkbox.addActionListener(l); 
        add(checkbox);
        add(baisvalue);
        add(plusbais);
        add(minisbais);

        //Performs the action on initialization
        l.actionPerformed(new ActionEvent(checkbox, ActionEvent.ACTION_PERFORMED, ""));
    }

    public static void main(String[] args){
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new MainPanel());
        frame.pack();
        frame.setSize(400, 300);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T16:06:12.667

尝试使用 this.setOpaque(false); 在构造函数中。

# iphone - Cocoa-Touch 中的 NStimer 问题

> ID：11972735
> 
> 赞同：0
> 
> 时间：2012-08-15T15:55:52.520
> 
> 标签：iphone, cocoa-touch, nsobject, nstimeinterval

我的应用程序需要显示一条临时消息，所以我自己创建了类似 android 的 Toast。它只适用于一个吐司。我正在使用 NSTimer 隐藏消息。如果我显示多个吐司，计时器就会成为问题。只有最后添加的 toast 会被隐藏，其他的不会被隐藏。我怎样才能隐藏所有的吐司？

代码：

删除功能：

```
-(void)removeToast
{
 NSLog(@"removed");
 [self.view removeFromSuperview];
} 
```

定时器启动：

```
timer = [NSTimer scheduledTimerWithTimeInterval:(4.0f) 
                                         target:self  
                                       selector:@selector(xxxx)
                                       userInfo:nil repeats:NO]; 
```

我在上面的单独`NSObject`类中写了这个并创建了一个对象。我需要澄清一下如何同时运行两个 NSTimer 或跟踪所有`NSObjects`.

视图控制器中的对象创建是 `@property(nonatomic,strong)Toast *toast;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:04:21.747

出于您的目的，无需将计时器的距离保留在 ivar 中。使用 userinfo: 参数在计时器触发时传递您要隐藏的视图，如下所示：

```
[NSTimer scheduledTimerWithTimeInterval:(4.0f) 
                                     target:self  
                                   selector:@selector(xxxx)
                                   userInfo:yourView repeats:NO]; 
```

然后在您的选择器中从 userInfo 检索视图并将其隐藏。[你可以在这里](https://github.com/andreamazz/UIView-Notify/blob/master/UIView+Notify/UIView+Notify.m)找到一个工作示例，第 37 行。

# objective-c - iOS - 通过地图上的视图禁用触摸

> ID：11972736
> 
> 赞同：0
> 
> 时间：2012-08-15T15:55:54.813
> 
> 标签：objective-c, ios

我正在尝试通过地图上的视图禁用触摸。现在，当我触摸视图时，它会将触摸传递到地图。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:00:07.120

您可以尝试在视图的所有子视图上禁用 userInteraction。

```
NSArray *subviews = yourView.subviews;

for (UIView *view in subviews) {
    [view setUserInteractionEnabled:NO];
} 
```

我没有用地图视图测试过，但我之前使用过这个设置来禁用整个视图的触摸，只是为我想要的几个项目重新启用触摸（基本上是只读模式）。希望这可以帮助。

# eclipse - java.lang.OutOfMemoryError：带有 Resin 和 EclipseLink 的 PermGen 空间

> ID：11972738
> 
> 赞同：1
> 
> 时间：2012-08-15T15:56:00.817
> 
> 标签：eclipse, jpa-2.0, eclipselink, resin, caucho

自从我将 EclipseLink 添加到我的设置中后，我每隔几分钟就会出现内存错误。这真的很糟糕，因为一旦发生这种情况，Eclipse (IDE) 甚至无法停止树脂，我必须去命令行杀死它。错误通常是这样的：

```
Unable to load class: java.lang.OutOfMemoryError: PermGen space 
```

在我的resin.xml中，我有以下内容希望能纠正这个问题，但它没有帮助：

```
<server-default>
    <jvm-arg>-Xmx512m</jvm-arg>
    <jvm-arg>-XX:MaxPermSize=1024m</jvm-arg>
    <jvm-arg>-Xss1m</jvm-arg>
    <jvm-arg>-XX:+CMSClassUnloadingEnabled</jvm-arg>
    <jvm-arg>-XX:+CMSPermGenSweepingEnabled</jvm-arg>
</server-default> 
```

最后两行是我尝试的最后一件事，但很快就失败了。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T19:46:24.897

到目前为止，我所做的更改有所帮助：我将 -XX:MaxPermSize=1024m 放入 Eclipse 服务器启动配置 - vm 参数中。

来自 Caucho 的人告诉我，在使用 Eclipse 时，resin.xml 中的 -X 参数没有被使用，所以这是有道理的。

# mysql - 计算值上的 MySQL 连接表

> ID：11972739
> 
> 赞同：1
> 
> 时间：2012-08-15T15:56:02.473
> 
> 标签：mysql

我不确定这是否可能，但这里有。

我正在使用 MySQL，需要完成一个产生如下输出的语句。

我有一个包含完成日期字段和查询日期字段的表。

我需要获取这些字段之间的时差数据，我有以下代码

```
SELECT DATE (completedate) - DATE (enqdate) AS `timediff`, COUNT(*) AS TotalCount
FROM cia_enquiry
WHERE (DATEDIFF(CURDATE(), enqdate) < 30) AND completedate > 1
GROUP BY `timediff`
ORDER BY `timediff` ASC 
```

上面的代码仅输出日期之间的天数和过去 30 天内的整体总数（不包括那些不完整的条目）

我现在需要针对另一个表引用“timediff”结果并从该表中提取另一个字段。

例如如果timediff = 1，那么我们需要在另一个表中找到1的id，并从这个表中返回描述字段。

最终我们应该得到类似的东西

* * *

timediff TotalCount 描述
0 52 24 小时内
1 13 24-48小时
等 ............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:08:16.823

可以办到; 你有两个选择

1.  使用查询结果创建一个临时表，然后将此表与您的第二个表连接起来
2.  将您的第一个查询用作子查询并将其与您的第二个表连接起来

**选项1**

```
create temporary table temp_tbl
select
   ...
;
# Important: create the indexes you need
alter table temp_tbl
   add index index1(field1), ... ;
# Now join your second table
select a.*, b.*
from temp_tbl as a join tbl2 as b on ...; 
```

**选项 2**

```
select a.*, b.*
from (
    select ... # here is your query
    ) as a join tbl2 as b on ... 
```

希望这可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:00:17.947

日期计算会给你一堆值的小数点......

你应该使用`ROUND()`

或查找`CEIL`和`FLOOR`功能。

# php - Ruby 等效于 PHP 的 utf8_encode 和 utf8_decode 函数

> ID：11972742
> 
> 赞同：0
> 
> 时间：2012-08-15T15:56:19.103
> 
> 标签：php, ruby, utf-8, utf8-decode

> **可能重复：**
> [如何在 Ruby 中将字符串从 windows-1252 转换为 utf-8？](https://stackoverflow.com/questions/951891/how-can-i-convert-a-string-from-windows-1252-to-utf-8-in-ruby)
> [如何将 utf8 字符转换为 iso8859-1](https://stackoverflow.com/questions/2735734/how-can-i-transform-the-utf8-chars-to-iso8859-1)

所以这是我的问题。我的工具分布在我的内部 LAN 中，我的外部 Web 服务器为内部 LAN 提供作业/数据。结果，我经常传递我宁愿窥探人们没有看到的数据。换句话说，如果有人看到我的 SQL 字符串，这不是世界末日，但我宁愿他们没有。我知道，这就像滑动玻璃门上的门闩。它不会让任何人真正下定决心，但它应该阻止随机好奇的脚本小子。

所以我有一组用 PHP 编写的简单密码。最近我确定我的工具集的下一个扩展需要使用 Ruby，但这些新工具需要与我之前构建的 PHP 工具集进行通信——我不想重新构建所有 PHP 工具。所以我需要我的 PHP 密码被我的 Ruby 代码完全复制，这样当 Ruby 加密一个字符串时，我的 PHP 工具会对其进行解密，然后将加密的字符串传回给我的 Ruby 工具进行解密。

我的简单密码只是修改后的凯撒密码。凯撒密码（对于那些不熟悉这个名字的人）是将所有字符移动一个已知数量的字母 - 即移动 3 将 A 变为 D，B 变为 E，C 变为 F，等等。真正的凯撒密码将需要包装，以便 3 的移位会将 Z 转换为 C。但是，我的并没有这样做，它只是将 3 添加到 Z 并使用 PHP 中的 utf8_encode 和 utf8_decode 函数。

现在我需要 Ruby 中的等价物。我以为我在

```
str.encode('utf-8') 
```

但这会返回此错误

> 未定义的方法“编码​​”#

我的谷歌搜索表明，出于某种原因，Ruby 中没有单一的解决方案。在将字符串编码为 UTF-8 之前，Ruby 需要知道字符串的当前编码。至少我是这样理解这个问题的。

因此传入的字符串将是 Ruby 1.8.7 默认的字符串。（如果这很有用......我正在使用 Ubuntu 12.04 桌面，美国，英语，我想我使用 apt-get 和默认存储库抓取了 Ruby。）我需要各种字符串，如 SQL 查询语句 - “SELECT *从表 WHERE id = ？” 和 PHP 的 md5() 输出产生的字符串。其他所有字符串都应属于美国英语中的大写字母、小写字母和数字类别。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:03:49.993

查看[编码](http://www.ruby-doc.org/core-1.9.3/Encoding.html)并查看您正在使用的[编码](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-encode)方法的文档。我相信这是您需要的第一种形式。

# c# - c# Xpath 具有多个命名空间

> ID：11972747
> 
> 赞同：1
> 
> 时间：2012-08-15T15:56:37.980
> 
> 标签：c#, xml, xpath

有人可以解释一下为什么这不起作用吗？

XmlDocument xmlDoc = new XmlDocument(); xmlDoc.Load("Bing2_ss.xml");

```
 //Instantiate an XmlNamespaceManager object. 
                    XmlNamespaceManager xmlnsManager = new XmlNamespaceManager(xmlDoc.NameTable);
                    //Add the namespaces used in feed to the XmlNamespaceManager.
                    //xmlnsManager.AddNamespace("base", "https://api.datamarket.azure.com/Data.ashx/Bing/Search/v1/Composite");
                    xmlnsManager.AddNamespace("m",   "http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
                    xmlnsManager.AddNamespace("d",   "http://schemas.microsoft.com/ado/2007/08/dataservices/");
                    xmlnsManager.AddNamespace(String.Empty, "http://www.w3.org/2005/Atom");

                    XmlNodeList nodeList;
                    XmlElement root = xmlDoc.DocumentElement;
                    nodeList = root.SelectNodes("//m:properties/d:WebTotal", xmlnsManager);
                    foreach (XmlNode nd in nodeList)
                    {
                        System.Console.WriteLine(nd.InnerText);
                    } 
```

这是原始 xml： http: [//gezond-afslanken.info/bing2_ss.xml](http://gezond-afslanken.info/bing2_ss.xml)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:12:16.213

您的一个命名空间上有一个额外的斜杠。尝试

```
xmlnsManager.AddNamespace("d","http://schemas.microsoft.com/ado/2007/08/dataservices"); 
```

# javascript - 与 javascript 相关的 HTTP 请求发生的顺序是什么？

> ID：11972751
> 
> 赞同：0
> 
> 时间：2012-08-15T15:57:11.740
> 
> 标签：javascript, jquery, performance, httprequest

我想延迟加载页面上的一些图像。因此我需要将图像 url 放入 data-url 属性中，但我的`<img>`标签是由 wordpress 生成的：

所以我正在考虑`<img>`在页面加载之前使用 js 来更改我的标签 -**但是**，在我的 js 脚本运行时，是否已经发出了对图像的 HTTP 请求[或放入队列中]？

（我知道它是一个相当黑客的解决方案，但我无法找到更好的方法来更改 wordpress 生成的`<img>`标签）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:08:02.450

渲染是同步的，所以是的，到那时你的图像已经被处理/请求了。我在这里找到了一个很好的资源来理解这一点：

[http://taligarsiel.com/Projects/howbrowserswork1.htm#The_order_of_processing_scripts_and_style_sheets](http://taligarsiel.com/Projects/howbrowserswork1.htm#The_order_of_processing_scripts_and_style_sheets)

我希望这会有所帮助。:)

# android - Android transfer 通过互联网查看并重新显示

> ID：11972753
> 
> 赞同：1
> 
> 时间：2012-08-15T15:57:21.240
> 
> 标签：android, serialization

可以通过互联网传输一个视图，例如一个 TextView，比如另一部运行 android 的手机，并让该手机重新显示原始 TextView 中的内容？如果是这样，怎么办？序列化是否适用于 View 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:15:36.410

> 可以通过互联网传输一个视图，例如一个 TextView，比如另一部运行 android 的手机，并让该手机重新显示原始 TextView 中的内容？

仅当您自己为此编写代码时。

> 因为你不能用按钮等其他东西真正做到这一点，除非你专门为每种类型的小部件/视图编写代码

正确的。

现在，如果您愿意将小部件的*图像*发送给另一方，那么您应该能够在一般基础上做到这一点，让小部件将自身绘制到`Bitmap`-backed `Canvas`。然后，您可以将其转换`Bitmap`为 PNG 或 JPEG，并通过 Internet 将其发送给另一方。

# asp.net-mvc - MVC 4 使用控制器操作更新视图

> ID：11972758
> 
> 赞同：1
> 
> 时间：2012-08-15T15:57:39.103
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我是 MVC 的新手。我希望能够在单击视图按钮时更改按钮/div/文本框文本。我在网上找到了一个教程，它向我展示了以下内容，但是当我单击按钮时，我被重定向到另一个页面。该页面改为显示文本。我没有碰过默认的 Global.aspx

看法

```
@using (Ajax.BeginForm("ExamineTextBox", new AjaxOptions { UpdateTargetId = "result" }))
{
    @Html.TextBox("textBox1")
    <input type="submit" value="Button" />
    <span id="result" />
} 
```

控制器

```
public string ExamineTextBox(string textBox1)
{
    if (textBox1 != "Initial Data")
    {
        return "This text is MVC different from before!";
    }
    return String.Empty;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:00:54.860

确保您已将`jquery.unobtrusive-ajax.js`脚本包含到您的页面中。

如果您使用的是默认捆绑包（看看`~/App_Start/BundleConfig.cs`- 您将看到一个`jqueryval`定义的捆绑包，它组合并缩小了所有`~/Scripts/jquery.unobtrusive*`文件`"~/Scripts/jquery.validate*"`）：

```
@Scripts.Render("~/bundles/jqueryval") 
```

如果不使用捆绑包，您可以单独包含此脚本：

```
<script type="text/javascript" src="~/scripts/jquery.unobtrusive-ajax.js"></script> 
```

`Ajax.*`助手工作需要这个脚本。顾名思义，它以不显眼的方式对它们进行 AJAX 化。它依赖于 jQuery，所以确保你也包含了那个。

旁注：在 ASP.NET 控制器中，操作应该返回 ActionResults，而不是字符串：

```
public ActionResult ExamineTextBox(string textBox1)
{
    if (textBox1 != "Initial Data")
    {
        return Content("This text is MVC different from before!");
    }
    return Content(String.Empty);
} 
```

以下是您的完整视图代码的外观：

```
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
        <meta name="viewport" content="width=device-width" />
    </head>
    <body>
        @using (Ajax.BeginForm("ExamineTextBox", new AjaxOptions { UpdateTargetId = "result" }))
        {
            @Html.TextBox("textBox1", "Initial Data")
            <input type="submit" value="Button" />
            <span id="result" />
        }
        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/jqueryval")
    </body>
</html> 
```

和控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult ExamineTextBox(string textBox1)
    {
        if (textBox1 != "Initial Data")
        {
            return Content("This text is MVC different from before!");
        }
        return Content(String.Empty);
    }
} 
```

# c# - 在 Windows 窗体中调用公共方法

> ID：11972759
> 
> 赞同：3
> 
> 时间：2012-08-15T15:57:45.670
> 
> 标签：c#, winforms, mdi, public-method

我有 1 个包含 1 个面板控件的 MDI 表单和 1 个带有 1 个按钮的表单，用于使 MDI 中的面板不可见。

MDI形式的代码：

```
 public void displayInit()
    {
        panel1.Visible = false;
    } 
```

Form1中的代码：

```
 private void button1_Click(object sender, EventArgs e)
    {
        displayInit();
    } 
```

错误是：当前上下文中不存在名称“displayInit”，请问有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:01:55.780

尝试引用父级（并转换它）：

```
((MyMDIForm)this.MDIParent).displayInit(); 
```

不过，这可能不是最好的方法。考虑让子窗体向 MDI 父窗体引发事件。关注点分离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:01:47.587

该方法`displayinit()`是一个**实例**方法，因此您需要一个实例来调用它

```
MyMDIForm.displayInit(); 
```

在构造 MDI 表单时保留对它的引用，并在调用它的方法时使用该引用。

# ios - 从应用程序中访问安装在设备上的客户端证书

> ID：11972761
> 
> 赞同：2
> 
> 时间：2012-08-15T15:57:48.697
> 
> 标签：ios, certificate, private-key

我想使用安装在我的 iOS 设备上的证书在我的 iOS 应用程序中加密一些数据（例如 NSData）。我可能只需要私钥来加密哈希，但是有没有办法从全局钥匙串中获取私钥.任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T14:21:45.867

最好（在我看来）您将要使用的私钥和证书放在钥匙串（或共享相同配置证书的其他第 3 方应用程序的钥匙串）上。

至于 p12 的实际加载，我们确实使用 openssl（我们确实围绕它编写了一个 obj-c 包装器）来解码我们发送给应用程序的 .p12。

# node.js - 如何使用事件将 mongodb 逻辑排除在 node.js 请求处理程序之外

> ID：11972763
> 
> 赞同：-1
> 
> 时间：2012-08-15T15:57:58.620
> 
> 标签：node.js, mongodb, express

我正在寻找一个包（或模式）来处理来自 mongodb 的事件，这样我就可以避免嵌套回调并将 mongodb 逻辑排除在我的请求处理程序之外。

现在我的代码看起来像这样：

***start-express.js（服务器）***

```
var express = require('express');
var Resource = require('express-resource');
var app = express.createServer();

// create express-resource handler  which essentially does app.get('things', ...)
var things = app.resource('things', require('./things.js'));

app.listen(port); 
```

***things.js（[快速资源](https://github.com/visionmedia/express-resource/)请求处理程序）***

```
require('./things-provider');

// handle request  'http://example.com/things'
exports.index = function(request, response) {
    sendThings(db, response);
}; 
```

***things-provider.js（处理 mongodb 查询）***

```
var mongodb = require('mongodb')

// create database connection
var server = new mongodb.Server(host, port, {auto_reconnect: true});
var db = new mongodb.Db(dbName, server);

db.open(function (err, db) {
    if (err) { }
    // auto_reconnect will reopen connection when needed
});

function sendThings(db, response) {            
    db.collection('things', function(err, collection) {
        collection.find(function(err, cursor) {
            cursor.toArray(function(err, things) {
                response.send(things);
            });
        });
    });
}

module.exports.sendThings = sendThings; 
```

我想避免将我的 http 响应对象传递给我的数据库处理程序，或者（更糟）在我的 http 响应处理程序中处理我的 db 请求。

我最近意识到我想要做的是创建一个事件处理程序，它注册一个 http 请求/响应并在处理和发送 http 响应之前等待来自数据库的响应（事件）。

这听起来像是 node.js 已经做的很多重复。是否存在处理此用例的现有框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:55:25.803

这是我想出的解决方案。

我使用[了 mongojs](https://github.com/gett/mongojs)，它极大地简化了 mongodb 接口——以配置灵活性为代价——但它隐藏了 mongodb 驱动程序所需的嵌套回调。它还使语法更像 mongo 客户端。

然后我将 HTTP Response 对象包装在一个闭包中，并将这个闭包传递给回调中的 mongodb 查询方法。

```
var MongoProvider = require('./MongoProvider');
MongoProvider.setCollection('things');

exports.index = function(request, response){
    function sendResponse(err, data) {
        if (err) { 
            response.send(500, err);
        }    
        response.send(data);
    };

    MongoProvider.fetchAll(things, sendResponse);
}; 
```

它本质上仍然只是将响应对象传递给数据库提供程序，但是通过将它包装在一个知道如何处理响应的闭包中，它可以将该逻辑排除在我的数据库模块之外。

一个小小的改进是使用一个函数在我的请求处理程序之外创建一个响应处理程序闭包：

```
function makeSendResponse(response){
    return function sendResponse(err, data) {
        if (err) {
            console.warn(err);
            response.send(500, {error: err});
            return;
        }

        response.send(data);
    };
} 
```

所以现在我的请求处理程序看起来像这样：

```
exports.index = function(request, response) {
    response.send(makeSendResponse(response));
} 
```

我的 MongoProvider 看起来像这样：

```
var mongojs = require('mongojs');

MongoProvider = function(config) {
this.configure(config);
    this.db = mongojs.connect(this.url, this.collections);
}

MongoProvider.prototype.configure = function(config) {
    this.url = config.host + "/" + config.name;
    this.collections = config.collections;
}

MongoProvider.prototype.connect = function(url, collections) {
    return mongojs.connect(this.url, this.collections);
}

MongoProvider.prototype.fetchAll = function fetchAll(collection, callback) {
    this.db(collection).find(callback);
}

MongoProvider.prototype.fetchById = function fetchById(id, collection, callback) {
    var objectId = collection.db.bson_serializer.ObjectID.createFromHexString(id.toString());

    this.db(collection).findOne({ "_id": objectId }, callback);
}

MongoProvider.prototype.fetchMatches = function fetchMatches(json, collection, callback) {
    this.db(collection).find(Json.parse(json), callback);
}

module.exports = MongoProvider; 
```

我还可以为特定集合扩展 MongoProvider 以简化 API 并进行额外的验证：

```
ThingsProvider = function(config) {
    this.collection = 'things';
    this.mongoProvider = new MongoProvider(config);
    things = mongoProvider.db.collection('things');
}

ThingsProvider.prototype.fetchAll = function(callback) {
    things.fetchAll(callback);
}

//etc...

module.exports = ThingsProvider; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T19:47:43.613

嗯，首先我发现 Mongoose 在结构良好的应用程序中比直接 mongo 更容易使用。所以这可能会对你有所帮助。

其次，我认为您尝试做的事情可以通过中间件（应用程序级别或路由级别）轻松完成，因为您已经在使用 express。或者，参数过滤，如果您的查询将根据参数而变化。我在上次看到的模式如下所示：

```
var User = mongoose.model("user'); // assumes your schema is previously defined

app.param('user_id', function(req,res,next, id){
   User.find(id, function(err,user){
      if(err) next(err);
      else { 
         req.user = user; 
         next();
      }
   });
}); 
```

它仍然有一些嵌套，但没有你的例子那么糟糕，更易于管理。然后，假设您有一个“/profile”端点，您可以这样做：

```
app.get('/profile/:user_id', function(req,res){ res.render('profile', req.user); } 
```

# java - 在java中重新抛出异常

> ID：11972765
> 
> 赞同：10
> 
> 时间：2012-08-15T15:58:02.037
> 
> 标签：java, exception, exception-handling

我有一个关于在 Java 中重新抛出异常的非常简单的问题。

这是代码片段：

```
public static void main(String[] args) throws FileNotFoundException {
    try {
        FileReader reader = new FileReader("java.pdf");
    } catch (FileNotFoundException ex) {
        throw ex;
    }
}

public static void main(String[] args) throws FileNotFoundException {        
        FileReader reader = new FileReader("java.pdf");        
} 
```

为什么我们需要`ex`在第一个版本中重新抛出，而第二个版本看起来更优雅？可能有什么好处以及哪个版本比另一个更受欢迎？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-15T16:01:25.543

你说的对。第二个版本更好。此外，第一个版本没有任何意义。除了异常的堆栈跟踪将是“错误的”之外，它的作用相同。

“重新抛出”异常有以下原因：

1.  如果你之前有事要做。
2.  如果您捕获一种类型的异常并抛出另一种类型的异常：

例子：

```
try {
   // do something
} catch (IOException ioe) {
    throw new IllegalStateException(ioe);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-15T15:59:58.710

在给出的示例中，重新抛出`Exception`没有任何意义。

如果捕获然后重新抛出异常的方法需要在看到 时采取一些额外的操作，并且还希望将传播给调用者，以便调用者可以看到并采取一些操作，那么这样做*会*很有用.`Exception``Exception``Exception`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-15T15:59:38.497

如果我想在 catch 块中做其他事情，我只会捕获/重新抛出一个异常（而不是仅仅抛出它）——例如，在重新抛出之前编写一个日志语句。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T16:04:11.910

除了想在退出之前对异常做一些事情——比如日志记录，另外一次你会做类似的事情是如果你想把它包装成一个不同的异常，比如：

```
try {
    FileReader reader = new FileReader("java.pdf");
} catch (FileNotFoundException ex) {
    throw new ServletException(ex);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-15T16:08:54.003

问题是为什么你认为你需要重新抛出异常。Eclipse 是否建议使用`try-catch`? 在实践中，我们很少重新抛出同一个异常，但经常捕获一个并抛出另一个*包装*第一个异常的异常，尤其是在未检查包装异常的情况下。每当您调用声明检查的异常时，都会发生这种情况，但是您编写这些调用的方法并未声明这些异常：

```
public int findId(String name) {
  try {
    return db.select("select id from person where name=?", name);
  } catch (SQLException e) {
    throw new RuntimeException(e);
  }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-05T17:23:55.977

`throw`执行流程在语句之后立即停止；不执行任何后续语句。检查最近的封闭`try`块以查看它是否具有`catch`与异常类型匹配的语句。

如果确实找到匹配项，则将控制权转移到该语句。如果不是，则检查下一个封闭`try`语句，依此类推。如果未`catch`找到匹配项，则默认异常处理程序会暂停程序并打印堆栈跟踪。

如果该方法能够导致它无法处理的异常，则它必须指定此行为，以便该方法的调用者可以保护自己免受该异常的影响。

可以通过在方法的声明中包含一个`throws`子句来做到这一点。子句列出了`throws`方法可能抛出的异常类型。这对于所有异常都是必需的，除了 or 类型的异常`Error`或其`RuntimeException`任何子类。方法可以抛出的所有其他异常必须在`throws`子句中声明。如果不是，则会导致编译时错误。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-30T09:35:16.747

两个版本都将输出相同的堆栈跟踪

## 没有尝试/捕获

```
import java.io.FileNotFoundException;
import java.io.FileReader;

public class Test {
    public static void main(String[] args) throws FileNotFoundException {
//        try {
            FileReader reader = new FileReader("java.pdf");
//        } catch (FileNotFoundException ex) {
//            throw ex;
//        }
    }
} 
```

将输出

```
Exception in thread "main" java.io.FileNotFoundException: java.pdf (The system cannot find the file specified)
    at java.io.FileInputStream.open0(Native Method)
    at java.io.FileInputStream.open(FileInputStream.java:195)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileInputStream.<init>(FileInputStream.java:93)
    at java.io.FileReader.<init>(FileReader.java:58)
    at Test.main(Test.java:7) 
```

## 尝试/捕获/抛出相同的异常

```
import java.io.FileNotFoundException;
import java.io.FileReader;

public class Test {
    public static void main(String[] args) throws FileNotFoundException {
        try {
            FileReader reader = new FileReader("java.pdf");
        } catch (FileNotFoundException ex) {
            throw ex;
        }
    }
} 
```

将输出与以前完全相同

```
Exception in thread "main" java.io.FileNotFoundException: java.pdf (The system cannot find the file specified)
    at java.io.FileInputStream.open0(Native Method)
    at java.io.FileInputStream.open(FileInputStream.java:195)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileInputStream.<init>(FileInputStream.java:93)
    at java.io.FileReader.<init>(FileReader.java:58)
    at Test.main(Test.java:7) 
```

## 尝试/捕获/抛出包装异常

一个可取的方法是抛出你自己的异常。如果您想提供根本原因的详细信息（可能需要或不需要），请将刚刚捕获的异常包装到其中

```
import java.io.FileNotFoundException;
import java.io.FileReader;

public class Test {
    public static void main(String[] args) {
        try {
            FileReader reader = new FileReader("java.pdf");
        } catch (FileNotFoundException ex) {
            throw new RuntimeException("Error while doing my process", ex);
        }
    }
} 
```

您可以清楚地看到顶层问题（我的过程没有完成），以及导致它的根本原因（找不到 java.pdf 文件）

```
Exception in thread "main" java.lang.RuntimeException: Error while doing my process
    at Test.main(Test.java:9)
Caused by: java.io.FileNotFoundException: java.pdf (The system cannot find the file specified)
    at java.io.FileInputStream.open0(Native Method)
    at java.io.FileInputStream.open(FileInputStream.java:195)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileInputStream.<init>(FileInputStream.java:93)
    at java.io.FileReader.<init>(FileReader.java:58)
    at Test.main(Test.java:7) 
```

# sql - 如何计算两个表的列值之间的差异

> ID：11972767
> 
> 赞同：2
> 
> 时间：2012-08-15T15:58:09.883
> 
> 标签：sql, ms-access

我有两张桌子：T_Guest，T_Table

在**T_Guest**我有一个客人名单。每个来宾都有一个 ID ( **g_no** ) 和一个与来宾相关的表的 ID ( **t_no** ) 。有可能同一张桌子上会有很多客人。

在**T_Table**我有一个表列表。每个表都有一个 ID ( **t_no** ) 和一个字段**n_places** ，该字段描述了该表有多少个地方。

问题： **我需要构建一个 SQL 查询（在 MS Access 中），它将显示一个表 ID 的列表，这些表 ID 仍然有一个空闲位置。**

* * *

我有一个想法，首先找到已满的表列表，而不仅仅是从整个可用表组中对该组实施 EXCEPTION 。

但是要计算有多少表确实有零空闲位置，我需要以某种方式计算每个表：

```
n_places - NUMBER_OF_GUESTS_ON_THAT_TABLE 
```

最后一个 ( `NUMBER_OF_GUESTS_ON_THAT_TABLE`) 它只是：

```
SELECT COUNT(*)
FROM T_Table INNER JOIN T_Guest ON T_Table.t_no = T_Guest.t_no
GROUP BY T_Table.t_no 
```

但我不知道如何实现 DIFFERENCE **n_places - NUMBER_OF_GUESTS_ON_THAT_TABLE**

有人可以帮我完成那种任务吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:04:52.410

您可以使用来宾计数作为派生表：

```
SELECT t.t_no, t.n_Places-Nz(g.Guests,0) As FreePlaces
FROM T_Table t
LEFT JOIN (
    SELECT t_no,COUNT(*) as Guests
    FROM T_Guest 
    GROUP BY t_no) g
ON t.t_no = g.t_no 
```

要获取带空格的表，您可以添加：

```
WHERE t.n_Places-Nz(g.Guests,0)>0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:09:46.643

```
SELECT [tt].[t_no]
FROM T_Table AS tt
WHERE (SELECT COUNT(*) FROM T_Guest AS tg WHERE tg.t_no = tt.t_no) < tt.n_places 
```

应该在访问中工作，使用子查询，但考虑到上下文，我认为这不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:17:21.370

这是 HAVING 子句的经典：

```
SELECT t_no FROM T_Guest GROUP BY t_no
HAVING COUNT(*)<(SELECT T_Table.n_Places FROM T_Table WHERE T_Table.t_no=T_Guest.t_no) 
```

# c++ - C++ 错误 LNK2001 问题

> ID：11972770
> 
> 赞同：0
> 
> 时间：2012-08-15T15:58:18.370
> 
> 标签：c++

我对 cpp 还很陌生，但在 c# 中已经有一段时间了。我正在尝试运行一个简单的控制台应用程序，但收到此 LNK2001 错误消息。

我有 main.cpp，并添加了另一个类 Zeus，其中包含文件 Zeus.h 和 Zeus.cpp。

这是main.cpp：

```
#include "Zeus.h"
#include <iostream>

int main()
{
    Zeus::tick = 25.0;
    using std::cout;
    cout << "nothing";
} 
```

这是宙斯.h：

```
static class Zeus
{
public:
    static void testing(void);
public:
    static double tick;
}; 
```

这是 Zeus.cpp：

```
void Zeus::testing(void)
{
 //Doesnt get this far
 //But eventually something like
 // cout << "test " << Zeus::tick;

} 
```

这是错误消息：

错误 20 错误 LNK2001：无法解析的外部符号“public：static double Zeus::tick”

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:00:12.550

您需要定义`Zeus::tick`，通常您会在`Zeus.cpp`文件中定义。你只是宣布了它。

```
double Zeus::tick = 0.0; 
```

此外，C++ 中也没有`static class`。

顺便说一句，自由函数可以放在命名空间中，而不是类的静态函数。这是 C++ 中的首选方式，除非有充分的理由让函数保持静态。

```
namespace Dionysus {
  void testing();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:01:23.627

正如错误消息所说：没有`Zeus::tick`. 将此添加到 Zeus.cpp：

```
double Zeus::tick; 
```

哦，在 Zeus.h 中删除`static`from

```
static class Zeus 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:08:50.823

在`main()`您拥有的功能中，声明是什么意思`Zeus::tick = 25.0;`？ `Zeus`是一类。因此，要访问它的各个元素，您需要创建它的实例。它就像一个结构，您首先创建它的实例来访问它的各个元素。

尝试以下操作：

```
int main() {
    Zeus myobject;

    myobject.tick = 25.0;
    /* Rest of the definition */ 
} 
```

# mysql - MySQL主从配置

> ID：11972772
> 
> 赞同：3
> 
> 时间：2012-08-15T15:58:22.783
> 
> 标签：mysql, replication, master, slave

关于 MySQL Master-Slave-Slave 设置的快速问题：

我目前有一个主从设置，我想添加另一个从属。是否有可能克隆运行从属服务器的服务器，然后使用来自从属服务器的映像启动一个新服务器，并让它从中断的地方继续运行？那么无论复制时的 binlog 是什么，它都会一直运行直到赶上主控？

理想情况下 - 我正在尝试启动另一个连接到主服务器的从服务器，而无需关闭主服务器进行备份。任何建议或指导都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:06:09.430

是的，您可以关闭从属实例，并将其所有数据复制到另一个从属实例（包括日志）。
不要忘记`my.cnf`在第二个从服务器上进行编辑（您应该更改`server-id`）
然后启动两个从服务器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T16:05:59.307

是的，这是可能的。最好的方法可能是暂时暂停从服务器上的复制，确定主二进制日志位置信息，然后在复制仍然暂停时从副本进行转储（并且副本上没有其他数据正在更改）。转储完成后，您可以重新启动副本。

在新服务器上，只需安装转储，设置 binlog 坐标并启动复制。不过要注意一点。确保清除主服务器上的二进制日志的设置将允许保留二进制日志足够长的时间，以便您执行此设置过程并在清除 bin 日志之前赶上新的从服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:12:20.223

这是一个关于如何为主服务器设置多个复制从属的很好的教程： [http ://arcib.dowling.edu/cgi-bin/info2html?%28mysql%29replication-howto](http://arcib.dowling.edu/cgi-bin/info2html?%28mysql%29replication-howto)

它没有解释你的场景，但给出了重要的提示：你必须为你的第二个从属分配一个唯一的服务器 ID。

关于您的问题：如果您的 master 二进制日志保留足够长的时间，您应该不会遇到麻烦。只需关闭您的从站片刻，将其克隆并记下：从站的 MASTER_LOG_FILE 和 MASTER_LOG_POS；然后重新启动原始从站并正确设置第二个从站：这意味着在 my.cnf 中设置了给定的 MASTER_LOG_POS 和 *_FILE 以及唯一的服务器 ID；

然后启动你的第二个奴隶。使用“START SLAVE”开始复制，然后查看“SHOW SLAVE STATUS;”

问候，斯特凡

PS：不能保证这会起作用，但我确定它应该这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-24T07:31:33.407

您可以使用现有的 mysql slave 新建一个，只需执行以下步骤，

1.  停止从属服务器上的复制。
2.  执行`show slave status;`并记下这些值`Master_Log_File: master-bin.000002`& `Read_Master_Log_Pos: 1307`
3.  在新的 mysql 从服务器上获取`mysqldump`并恢复它，您可以`my.cnf`从现有的 mysql 从服务器复制文件并更改`server-id`.
4.  在新的从服务器上执行`change master to`命令，提供 mysql 主服务器的详细信息以及我们从现有 mysql 从服务器获得的日志文件名和日志位置。
5.  `start slave;`在现有的 mysql slave 上执行。
6.  验证从属状态运行`show slave status`。

就是这样，你有一个新的 mysql 从服务器！

祝你好运 ！

# java - 上传后的原始文件名？

> ID：11972774
> 
> 赞同：0
> 
> 时间：2012-08-15T15:58:48.163
> 
> 标签：java, google-app-engine, blobstore

您如何获取在 GAE 上上传的原始文件名？

基于以下示例：

[https://developers.google.com/appengine/docs/java/blobstore/overview#Uploading_a_Blob](https://developers.google.com/appengine/docs/java/blobstore/overview#Uploading_a_Blob)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:55:13.807

Blobstore 上传处理程序重写请求（删除正文，添加 blobkey），但保留所有其他内容不变。

POST mimetype 是`multipart/form-data`，GAE/J 没有提供解析的 API。所以你需要使用 3rd 方库来解析参数 - [Apache Commons-FileUpload](http://commons.apache.org/fileupload/)（也作为[maven artifact](http://search.maven.org/#search%7Cga%7C1%7Cg%3a%22commons-fileupload%22)）。

在您的`post()`处理程序中使用它，如下所示：

```
 ServletFileUpload upload = new ServletFileUpload();

    FileItemIterator iterator = null;
    try {
        iterator = upload.getItemIterator(request);
        while (iterator.hasNext()) {
            FileItemStream item = iterator.next();
            String filename = item.getName();
        }

    } catch (FileUploadException e) {
        // handle the error here
    } 
```

由于可以一次上传多个文件，因此您需要遍历一组参数并取出您感兴趣的文件。

# android - 如何在android中的每个列表元素上添加按钮

> ID：11972782
> 
> 赞同：0
> 
> 时间：2012-08-15T15:59:54.967
> 
> 标签：android, motodev-studio

基本上，我有一个应用程序，您可以在其中单击一个按钮，它会将您带到另一个活动，您可以在其中输入内容并单击另一个按钮，然后将您带回第一个活动，并且您在第二个活动中编写的任何内容都会添加到第一个活动的arrayList，其值显示在 ListView 中。在那个 listView 中，我想为每一行添加一个按钮。怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:03:06.303

这是您想要的教程：[处理 ListView Row 中的按钮单击](http://androidforbeginners.blogspot.com/2010/03/clicking-buttons-in-listview-row.html)

（请记住，模糊的问题会得到模糊的答案，因为有*很多不同*的方法可以满足您的要求，我们无法猜测您使用的是哪种*特定*方法。始终包括：您正在尝试做什么，您尝试过什么（使用相关代码），以及为什么它在您的问题中不起作用（在适用时使用 LogCat）。）

# asp.net-mvc - ASP.NET MVC 页面上的提交按钮未禁用

> ID：11972785
> 
> 赞同：0
> 
> 时间：2012-08-15T15:59:59.943
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

我有 BackoutClaim 页面。单击提交按钮时，我必须禁用该按钮，并且从 POst 方法中，当响应返回时，我必须启用按钮返回。

在下面的代码中，按钮未禁用。感谢您的回复。

```
 <asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

   <script type="text/javascript">
       function TrimThatNameThenSubmit() {
           var tableName = $('#tableName').val().replace(/^\s+|\s+$/g, "");
           $('#tableName').val(tableName);
           **$('#Submit').attr('disabled', 'disabled');**
           $('form:eq(0)').submit();

       }
</script>

<% 
    var messages = ViewData["messages"];
%>
<% using (Html.BeginForm()) { %>
    <div>
        <div class="Spacer"></div>

        <div class="RevertCaseStateHeader" align="center">
            <%= Html.TextBox("tableName", "Enter tableName to Backout Claim", new { @style = "width: 400px;" })%>
            <input type="button" value="Submit" onclick="javascript:TrimThatNameThenSubmit()"/>
        </div>
             <div class="RevertCaseStateSummary" align="center">
             <% if (messages != null)
                { %>
                    <%= Html.Encode(messages)%>
             <% } %>
             </div>
    </div>
<% } %>

</asp:Content> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:04:31.710

您的 jQuery 正在选择不存在 id=Submit 的按钮，请将您的按钮定义更改为：

```
<input id="Submit" type="button" value="Submit" onclick="javascript:TrimThatNameThenSubmit()"/> 
```

# ios - UIDeviceOrientationUnknown 方向的目的是什么？

> ID：11972786
> 
> 赞同：0
> 
> 时间：2012-08-15T16:00:00.570
> 
> 标签：ios, uideviceorientation

UIDeviceOrientationUnknown Orientation 的目的是什么？订阅有关设备方向的通知时，何时收到此消息比根本不收到任何消息更有益？

我只是想了解为什么这个方向甚至包含在 Apple 的方向列表中。如果您在零重力环境中使用设备，是否会出现这种定向？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:19:07.847

**`UIDeviceOrientationUnknown`**是错误和硬件故障的全部捕获，因此至少在出现问题时您会收到通知。

# php - 在 autoLogin 上恢复用户状态

> ID：11972788
> 
> 赞同：0
> 
> 时间：2012-08-15T16:00:11.410
> 
> 标签：php, yii

我正在使用允许用户使用 yii 的“记住我”选项的登录表单。
在第一次登录期间，我正在设置一些用户->状态值，这些值在会话结束后当然会丢失。
现在，如果用户通过“记住我”cookie 再次自动登录，那么再次设置这些状态的最佳方法是什么。
到目前为止，在用户成功登录后，我一直在 UserIdentity 类（在组件文件夹中）中设置一些用户状态：

```
Yii::app()->user->setState('someKey', $someValue); 
```

一旦使用自动登录，最好恢复这些状态？
我不想将设置的用户状态存储在 cookie 中，因为它们可能包含过于安全的敏感数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:45:36.347

很抱歉快速回答，但这些是一些可能性：

1.  实现您自己的数据库，该数据库根据用户的登录用户名存储用户的状态。
2.  实现您自己的状态持久化版本并在您的 config.php 中引用它。实现您自己的基于数据库的 StatePersisteer 版本，如下所述： [http](http://www.yiiframework.com/doc/api/1.1/CStatePersister) ://www.yiiframework.com/doc/api/1.1/CStatePersister 。然后找到一种在登录时引用该状态的方法。

# sencha-touch-2 - Sencha Touch 2：生产版本无法在浏览器中打开

> ID：11972789
> 
> 赞同：1
> 
> 时间：2012-08-15T16:00:11.957
> 
> 标签：sencha-touch-2

我已经使用“sencha app build production”命令编译了我的项目。当我尝试在浏览器中加载它时，出现以下错误：

```
Error evaluating http://localhost:8888/RFN/build/production/app.js with message: Error: [Ext.Loader] Failed loading synchronously via XHR: 'src/form/Panel.js'; please verify that the file exists. XHR status code: 404 
```

我的生产版本中肯定没有“src”文件夹。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:33:16.023

原来我必须在我的 app.js 文件中声明“需要 Ext.form.Panel”。

# mule - cxf:proxy-client [java.lang.Exception: 没有这样的操作]

> ID：11972794
> 
> 赞同：0
> 
> 时间：2012-08-15T16:00:31.583
> 
> 标签：mule

当我尝试将 Web 服务用作 CXF 代理客户端时，我收到 No such Operation 异常。我没有正确配置 CXF 代理客户端吗？我会很感激任何反馈。

下面提到了我的流程和异常详细信息。

```
<flow name="XML121Order">
    <jms:inbound-endpoint queue="mviq.121.order" />
    <outbound-endpoint address="https://www.example.com/appsacord/acordwebs.asmx" 
                       exchange-pattern="request-response" >
        <cxf:proxy-client operation="AppsAcord" 
                          payload="body" 
                          enableMuleSoapHeaders="false" />
    </outbound-endpoint>

    <xm:object-to-xml-transformer />

    <logger message="File payload is #[payload]" level="INFO" />

    <file:outbound-endpoint path="/eip/mvi/output" 
                            outputPattern="apps_xml121-[function:dateStamp]" />
</flow> 
```

异常堆栈是：

1.  没有这样的操作：AppsAcord (java.lang.Exception) org.mule.module.cxf.CxfOutboundMessageProcessor:279 (null)
2.  没有这样的操作：AppsAcord (java.lang.Exception) (org.mule.api.DefaultMuleException) org.mule.module.cxf.CxfOutboundMessageProcessor:141 ( [http://www.mulesoft.org/docs/site/current3/apidocs /org/mule/api/DefaultMuleException.html](http://www.mulesoft.org/docs/site/current3/apidocs/org/mule/api/DefaultMuleException.html) )

* * *

根异常堆栈跟踪：

```
java.lang.Exception: No such operation: AppsAcord
    at org.mule.module.cxf.CxfOutboundMessageProcessor.getOperation(CxfOutboundMessageProcessor.java:279)
    at org.mule.module.cxf.CxfOutboundMessageProcessor.getOperation(CxfOutboundMessageProcessor.java:360)
    at org.mule.module.cxf.CxfOutboundMessageProcessor.doSendWithClient(CxfOutboundMessageProcessor.java:200)
    at org.mule.module.cxf.CxfOutboundMessageProcessor.process(CxfOutboundMessageProcessor.java:127)
    at org.mule.endpoint.outbound.OutboundResponsePropertiesMessageProcessor.process(OutboundResponsePropertiesMessageProcessor.java:39)
    at org.mule.processor.TransactionalInterceptingMessageProcessor$1.doInTransaction(TransactionalInterceptingMessageProcessor.java:49)
    at org.mule.processor.TransactionalInterceptingMessageProcessor$1.doInTransaction(TransactionalInterceptingMessageProcessor.java:46)
    at org.mule.transaction.TransactionTemplate.execute(TransactionTemplate.java:116)
    at org.mule.processor.TransactionalInterceptingMessageProcessor.process(TransactionalInterceptingMessageProcessor.java:55)
    at org.mule.processor.AbstractFilteringMessageProcessor.process(AbstractFilteringMessageProcessor.java:41)
    at org.mule.endpoint.DefaultOutboundEndpoint.process(DefaultOutboundEndpoint.java:96)
    at org.mule.interceptor.AbstractEnvelopeInterceptor.process(AbstractEnvelopeInterceptor.java:55)
    at org.mule.processor.AsyncInterceptingMessageProcessor.processNextTimed(AsyncInterceptingMessageProcessor.java:118)
    at org.mule.processor.AsyncInterceptingMessageProcessor$AsyncMessageProcessorWorker.doRun(AsyncInterceptingMessageProcessor.java:164)
    at org.mule.work.AbstractMuleEventWork.run(AbstractMuleEventWork.java:43)
    at org.mule.work.WorkerContext.run(WorkerContext.java:309)
    at edu.emory.mathcs.backport.java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1061)
    at edu.emory.mathcs.backport.java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:575)
    at java.lang.Thread.run(Unknown Source) 
```

# javascript - javascript在求和时返回NaN

> ID：11972798
> 
> 赞同：0
> 
> 时间：2012-08-15T16:00:42.220
> 
> 标签：javascript, math

我正在尝试使用 javascript 进行加法运算，以计算出将商品和运费加在一起时的用户总成本，但是我得到的只是 NaN，为什么会这样？这是我的代码的[小提琴](http://jsfiddle.net/zXF5k/)

### 从小提琴移植的代码：

```
 $("#country").change(function() {
    var shipping_cost = parseFloat($("#shipping").text().replace(pattern, ''));
    var total      = parseFloat($("#goods").text().replace(pattern, ''));
    var pattern = /[^0-9.-]+/g;
    var result = total + shipping_cost;
    console.log(result);

       if($(this).val() == "17") {
           $("#shipping").text("£0.00");
           $("#full_price").text("£"+result);
       } else {
           $("#shipping").text("£5.00");
           $("#full_price").text("£"+result);
       }
 });​ 
```

### 标记：

```
<select id="country">
    <option value=17>Option 1</option>
    <option value=18>Option 2</option>
    <option value=19>Option 3</option>
</select>

<p id=goods>£5.00</p>

<p id=shipping>£0.00<p> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T16:03:05.853

你的模式声明应该在你的解析之前，就像这样：

```
var pattern = /[^0-9.-]+/g;
var shipping_cost = parseFloat($("#shipping").text().replace(pattern, ''));
var total      = parseFloat($("#goods").text().replace(pattern, '')); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T16:03:05.153

向上移动`var pattern = /[^0-9.-]+/g;`，一切正常：

```
var pattern = /[^0-9.-]+/g;
var shipping_cost = parseFloat($("#shipping").text().replace(pattern, ''));
var total      = parseFloat($("#goods").text().replace(pattern, '')); 
```

# log4cxx - 如何强制 log4cxx 在日志文件顶部写入某些字符串？

> ID：11972800
> 
> 赞同：0
> 
> 时间：2012-08-15T16:00:47.950
> 
> 标签：log4cxx

我希望每次当 log4cxx 创建新的日志文件时，它都会在日志文件的顶部（作为第一条消息）写入特殊字符串。

我怎么能强迫它这样做？

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T20:25:31.190

您可以从创建布局`log4cxx::PatternLayout`并重新实现，创建文件时从（通过）`appendHeader()`调用此函数。`log4cxx::FileAppender::setFile()``log4cxx::WriterAppender::writeHeader()`

# android - 绘图未正确显示（Androidplot lib）

> ID：11972813
> 
> 赞同：2
> 
> 时间：2012-08-15T16:01:31.923
> 
> 标签：android, plot, androidplot

我使用 androidplot 实现了一个情节。以下是一些片段：

**.xml**

```
<com.androidplot.xy.XYPlot
        android:id="@+id/plot"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_marginBottom="5px"
        android:layout_marginLeft="5px"
        android:layout_marginRight="5px"
        android:layout_marginTop="10px"
        title="Dynamic Plot" /> 
```

**代码**

```
private XYPlot plot;
// DynamicSerie implements XYSerie
private DynamicSerie XSerie, YSerie;
...
// this thread is just for redrawing
private class PlotTimerTask extends TimerTask {
    @Override
    public void run() {
        try{
            plot.postRedraw();
        }catch(InterruptedException e){
            e.printStackTrace();
        }
    }
}
...
// most if this init looks just like in Androidplot.com tutorial 
```

[教程链接](http://androidplot.com/wiki/A_Dynamic_XYPlot)

```
plot = (XYPlot) findViewById(R.id.plot);
XSerie = new DynamicSerie(DataSeries.X_VEC, "X Axis Acc");
YSerie = new DynamicSerie(DataSeries.Y_VEC, "Y Axis Acc");
LineAndPointFormatter f1 = new LineAndPointFormatter(Color.rgb(0, 0, 200), null, Color.rgb(0, 0, 80));
f1.getFillPaint().setAlpha(220);
plot.addSeries(XSerie, f1);
plot.addSeries(YSerie, new LineAndPointFormatter(Color.rgb(0, 0, 0), null, Color.rgb(0, 80, 0)));
plot.setGridPadding(5, 0, 5, 0);
...
@Override
protected void onPause() {
    timerTask.cancel();
    timer.purge();
    super.onPause();
}
@Override
protected void onResume() {
    timerTask = new PlotTimerTask();
    timer.schedule(timerTask, 0, Constants.PLOT_REFRESH_RATE);
    super.onResume();
} 
```

这就是我最终得到的： ![输出图](../Images/605547a8a8010a623d63abc8ecbb5dea.png)

我尝试操作`XYPlot`'s 和`LineAndPointFormatter`' 选项（在 java 代码和 xml 中）——颜色、填充、绘画——我能想到的一切。由此产生的情节*总是*像这样是蓝色的。如果你看得足够近，你会看到它后面有一个格式正确的图 - 带有轴、图例、数据系列等。但我不知道如何摆脱这个蓝色覆盖！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T08:49:57.923

`plot.disableAllMarkup()`. 而已。

# javascript - 传单问题：使多段线的图层组不可点击

> ID：11972816
> 
> 赞同：2
> 
> 时间：2012-08-15T16:01:39.427
> 
> 标签：javascript, jquery, leaflet

我在我的图层组中制作折线时遇到问题...正如您在下面的代码中看到的那样，我使用传单的内置功能来遍历图层组（route.eachLayer），并尝试添加样式“可点击” : false' 但这似乎没有任何作用......

```
//route = layergroup with all polylines
function disableclicking(){
    route.eachLayer(function(layer){
        layer.setStyle({clickable: false});
    });
} 
```

当我尝试使用这段代码时，它似乎什么都没有改变（虽然它确实进入了循环），或者至少，它没有改变我想要的......

我想要的是折线的类'.leaflet-clickable'被删除......这似乎没有发生。当您将样式更改为不可点击或我的循环有问题时，此类不会改变吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-02-26T13:36:37.853

我有类似的需求，由于接受的答案与问题无关，我将发布我提出的解决方案（以防其他人从谷歌到达这里）。

```
function setClickable(target, value) {
    if(value && !target.options.clickable) {
        target.options.clickable = true;
        L.Path.prototype._initEvents.call(target);
        target._path.removeAttribute('pointer-events');
    } else if(!value && target.options.clickable) {
        target.options.clickable = false;

        // undoing actions done in L.Path.prototype._initEvents
        L.DomUtil.removeClass(target._path, 'leaflet-clickable');
        L.DomEvent.off(target._container, 'click', target._onMouseClick);
        ['dblclick', 'mousedown', 'mouseover', 'mouseout', 'mousemove', 'contextmenu'].forEach(function(evt) {
            L.DomEvent.off(target._container, evt, target._fireMouseEvent);
        });

        target._path.setAttribute('pointer-events', target.options.pointerEvents || 'none');
    }
}

setClickable(myLayer, false); 
```

# python - Heroku - Django：必须将每次提到的 `myproject` 更改为 `app` 才能使我的网站正常运行。将来如何最好地避免这种情况？

> ID：11972817
> 
> 赞同：2
> 
> 时间：2012-08-15T16:01:42.890
> 
> 标签：python, django, heroku, importerror

我刚刚在 Heroku 上运行了第一次使用 Django1.3 制作的网站。为了让我的网站`myproject`在没有.`app``import myproject.core.views``import app.core.views``urls.py``importError`

我认为要么：

*   我将 Heroku 目录（`$ heroku run pwd`输出`/app`）更改`/app`为`/myproject`. 我该怎么做呢？
*   使用通用前缀。我将如何以最好的方式做到这一点？
*   我应该从较低的目录推送我的项目吗？

**更新**

这是我本地和heroku目录的文件结构： [gist.github.com/3361637](http://gist.github.com/3361637 "gist.github.com/3361637")

这是我必须在 urls.py 中进行的更改的示例： [gist.github.com/3361686](http://gist.github.com/3361686 "gist.github.com/3361686")

其他文件的更改完全相同，只是更改了我的项目名称

**更新2**

致米帕迪：

在您提议的结构旁边，我更改了我的 .git 文件夹：

```
.
|-- myproject_django
    |-- core
        # etc.
    |-- manage.py
    |-- .git
    # etc
|-- requirements.txt 
```

对此：

```
.
|-- myproject_django
    |-- core
        # etc.
    |-- manage.py
    # etc
|-- requirements.txt
|-- .git 
```

并将更改推送到heroku。但是现在文件夹/文件与以前的结构混合在一起。我尝试使用删除这些文件，`heroku run rm file_name`但这不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:46:06.200

根据 Heroku 的说明（以及我设置的每个 Django/Heroku 项目），Django*项目*应该位于顶层，因此，在您的情况下，这是：

```
.
|-- pykaboo_django
    |-- core
        # etc.
    |-- manage.py
    # etc
|-- requirements.txt 
```

然后，您可以按应用名称导入：

```
from core.models import * 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T17:42:11.040

看起来您应该直接引用您的模块，`core`因为它位于项目的根目录中。所以，`urls.py`你应该像这样导入：

```
import core.views 
```

而不是`import app.core.views`或`import myproject.core.views`

# c++ - 将命令模式、工厂模式和模板混合在一起......

> ID：11972818
> 
> 赞同：0
> 
> 时间：2012-08-15T16:01:45.510
> 
> 标签：c++, templates, factory-pattern, command-pattern

我已经[在这里问了一个类似的问题](https://stackoverflow.com/questions/11955859/using-template-template-parameter-on-function-call)，但是我并没有真正得到我想要的答案，因为我的问题表述得很糟糕，而且例子也很糟糕。所以我再试一次，希望有更好的解释和更好的代码。

下面的代码已经去掉了不必要的细节，但它可以工作。问题是如果可能的话，我想使用模板参数推导来简化模板函数调用。

我有一个创建命令的工厂。要创建一个命令，我使用这样的调用：

```
mCommandFactory.createCommand<
                        DoSomeStuff, 
                        ParameterType1, 
                        ParameterType2, 
                        ParameterType3, 
                        ParameterType4
                        >
                        (std:string("some description"), 
                         parameter1, 
                         parameter2, 
                         parameter3, 
                         parameter4); 
```

您可能已经猜到，parameter1 的类型是 ParameterType1，依此类推...。

现在，如果我们看一下命令的定义 - DoSomeStuff- 本身：

```
class DoSomeStuff : public UndoableCommand< ParameterType1 , ParameterType2, ParameterType3 , ParameterType4 >
    {
    public:
      DoSomeStuff(... /* arguments which are needed for precessing the command and undoing it*/ );
      ~DoSomeStuff() throw();
      void executeImpl();
      void undoImpl();

    protected:
              ... /* members which are needed for precessing the command and undoing it*/ 
    }; 
```

如您所见，ParameterTypeN 信息已经在 DoSomeStuff 声明中。

我想知道是否有可能以某种更简单的方式替换上面的 createCommand 调用：

```
mCommandFactory.createCommand<DoSomeStuff>
                        (std:string("some description"), 
                         parameter1, 
                         parameter2, 
                         parameter3, 
                         parameter4); 
```

这是 CommandFactory 代码：

```
 class CommandFactory
    {
    private:
          // some stuff used to initialize objects created by this factory 

    public:
        CommandFactory(...) : ... /* members initialization */

        {  
        }

        template <class CommandType, typename P1, typename P2, typename P3, typename P4> 
        void createCommand(juce::String& description,P1 p1, P2 p2, P3 p3, P4 p4)
        {
            Undoable* cmdPtr = new CommandType(p1, p2, p3, p4);
            ...
            // init cmdPtr

            (*cmdPtr)();            
        } 
```

基本上，重点是移动CommandFactory 内部的复杂性，以使“客户端代码”（对createCommand 的调用）尽可能简单和简短。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T14:52:31.333

不确定我是否正确理解了这个问题，但这应该可以。

```
template<typename ParameterType1 , typename ParameterType2, typename ParameterType3 , typename ParameterType4>
class UndoableCommand
{
public:
    UndoableCommand(ParameterType1 p1, ParameterType2 p2, ParameterType3 p3, ParameterType4 p4)
    {}
};

class DoSomeStuff : public UndoableCommand< int ,double, std::string , int>
{
public:
    DoSomeStuff(int p1, double p2, std::string p3, int p4)
        :UndoableCommand(p1,p2,p3,p4)
    {}
};

class CommandFactory
{
public:
    CommandFactory()
    {}

    template <class CommandType, typename P1, typename P2, typename P3, typename P4> 
    void createCommand( std::string& description,P1 p1, P2 p2, P3 p3, P4 p4)
    {
        UndoableCommand<P1,P2,P3,P4> * cmdPtr = new CommandType(p1, p2, p3, p4);

    }
 }; 
```

这样使用

```
CommandFactory fact;
fact.createCommand<DoSomeStuff>(std::string("description"),1,2.0,std::string("3"),4); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:33:30.060

你在这里不需要什么特别的东西，你的方法`mCommandFactory.createCommand<DoSomeStuff>(...);`会奏效。编译器会自动从函数调用表达式中扣除给定参数的类型并`createCommand<>`正确实例化模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:08:34.467

是的，您可以用更简单的东西替换它。你考虑过`std::bind`吗？

一旦你使用 change it to use `<function>`，你的 DoSomeStuff 类将只是一个包含一对`std::function`s 的结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T19:21:31.240

您可以将 Parameter 类型的 typedef 设置为 Commandtype 类，从而在 createCommand 函数中解析参数类型，而无需将它们显式添加为模板参数。为了实现这一点，您可以在该类中将模板参数的 typedef 传递给 UndoableCommand。

# entity-framework - 实体框架和存储库模式

> ID：11972826
> 
> 赞同：4
> 
> 时间：2012-08-15T16:02:00.290
> 
> 标签：entity-framework

我想使用实体框架来持久化域实体。我的项目设置如下：-

*   UI：MVC（使用 Automapper 在域实体和视图模型之间进行映射）
*   领域：实体、服务、存储库接口
*   存储库：实体框架（实现领域层的接口）。使用 Automapper 在域实体和实体框架对象之间进行映射。

这很好用，除非在我的服务中，如果我通过检查存储库来验证项目，然后执行更新。这失败了，因为 Entity Frameworks 身份映射之前已经看到过该项目，我尝试再次附加它。

我可以使用如下代码解决这个问题（这将变得更通用）

```
 public void Update(Domain.Entities.Book entity)
    {
        Book newBook = _mapper.Map<Domain.Entities.Book, Book>(entity);
        ObjectStateEntry cacheEntry;
        if (_dataContext.ObjectStateManager.TryGetObjectStateEntry(_dataContext.CreateEntityKey("Books",newBook), out cacheEntry))
        {
            _dataContext.Books.ApplyCurrentValues(newBook);
        }
        else
        {
            _dataContext.Books.Attach(newBook);
            _dataContext.ObjectStateManager.ChangeObjectState(newBook, EntityState.Modified);
        }
        _dataContext.SaveChanges();
    } 
```

问题是我发现我自己必须为删除编写相同类型的代码

```
 public void Delete(Domain.Entities.Book entity)
    {
        Book newBook = _mapper.Map<Domain.Entities.Book, Book>(entity);
        ObjectStateEntry cacheEntry;
        if (_dataContext.ObjectStateManager.TryGetObjectStateEntry(_dataContext.CreateEntityKey("Books", newBook), out cacheEntry))
        {
            _dataContext.ObjectStateManager.ChangeObjectState(cacheEntry.Entity, EntityState.Deleted);

        }
        else
        {
            _dataContext.Books.Attach(newBook);
            _dataContext.ObjectStateManager.ChangeObjectState(newBook, EntityState.Deleted);
        }
        _dataContext.SaveChanges();
    } 
```

我确信一定有更好的方法来实现我想要做的事情，但我无法为我的生活弄清楚什么！

对于上述方法的任何其他一般性评论将不胜感激，因为我即将在大型项目中使用它！

谢谢

罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:20:24.410

正如 trailmax 所说，看起来你有多个数据上下文。我会为一个数据上下文拍摄。这可以通过创建通用存储库来完成。假设您在实体和存储库之间有 1:1 的关系，这篇文章可能会帮助您实现目标：[http ://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing -the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T11:25:30.217

除非我完全误读了您的问题，否则我认为您的问题是 DatabaseContext 对象的多个实例。如果你从一个上下文实例中获取一个对象，然后尝试在不同的上下文实例中使用它，你会得到很多异常：第二个上下文实例会看到该对象已经附加，但它不能使用它，因为它附加到不同的上下文实例。

如果您只有一个上下文实例来管理您的附加对象，它会看到该对象已经附加并且将使用它。而且您不需要使用 AutoMapper 将对象克隆（顺便说一下，成员级克隆的好技术！）到新实例和任何其他可怕的“TryingToAttachObject”东西中。

在我发现依赖注入之前，我在多个上下文实例中遇到了很多类似的问题，它很神奇：它会创建一个 DBContext 实例并将其用于您的所有请求和 EF 管理。

# google-maps - 获取信息窗口以显示在聚集标记集中单击正常标记的时间

> ID：11972827
> 
> 赞同：0
> 
> 时间：2012-08-15T16:02:01.953
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

我有一个 Google Maps 实现，它使用 Google Maps Utility Library v3 (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/docs/reference.html) 对标记进行聚类。它完美地工作。

不过，现在我想将 infowindows 添加到标记中。集群标记按原样工作正常，所以我想保持这些行为（即，当您单击它们时它们会放大）但是当单击普通的单个标记时，我想显示一个信息窗口。

完整代码如下：

```
var _iconCenter = new google.maps.MarkerImage('/css/img/map-marker.png',
  new google.maps.Size(38, 48),
  new google.maps.Point(0,0),
  new google.maps.Point(19, 44));

var shadow = new google.maps.MarkerImage('/css/img/map-marker-shadow.png',
  new google.maps.Size(57, 49),
  new google.maps.Point(0,0),
  new google.maps.Point(7, 44));

var _icon = '/css/img/map-marker-purple.png';
var infowindow;
var markersArray = [];
var map;
var currentPosition = 0;
var currentmarker;
var firstload = true;
var maploaded = false;
var interval = 5000;
var geocoder;

var stylez = [];

function initialize(items,loop,zoom) {
  geocoder = new google.maps.Geocoder();
  if (items.length > 0) {
    var latlng = new google.maps.LatLng(items[0].Lat, items[0].Lng);
    var myOptions = {
      zoom: zoom,
      center: latlng,
      //mapTypeControl: false,
      streetViewControl: false,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    map = new google.maps.Map(document.getElementById("map"), myOptions);
    map.setOptions({styles: stylez});

    for (var i = 0; i < items.length; i++) {
      var marker = new google.maps.Marker({
        position: new google.maps.LatLng(items[i].Lat, items[i].Lng),
        title: items[i].Title,
        icon: _icon,
        shadow: shadow,
        infocontent: items[i].Description
      });
      marker.setMap(map);
      markersArray.push(marker);
    }

    //set style options for marker clusters (these are the default styles)
    mcOptions = {
      gridSize: 44
    }

    var markerCluster = new MarkerClusterer(map, markersArray, mcOptions);
    google.maps.event.addListener(map, "tilesloaded", function () {
      if(loop == true){
        SetLoop();
      }
    });

    google.maps.event.addListener(marker, "click", function () {
      alert('test');
      //infowindow.setContent('test');
      //infowindow.open(map,this);
    });

  }
}

function SetLoop() {
//This will fire everytime map loads or recenteres
  maploaded = true;
  if (firstload) {
    firstload = false;
    Recenter();
  }
}

function Recenter() {
  //If previous iteration is not loaded completely, wait to avoid errors
  //It could happen for slow internet connection
  if (maploaded) {
    maploaded = false;
  } else {
    //keep adding 1 second to interval for slow connection till page loads
    interval = interval + 1;
    setTimeout("Recenter()", interval);
    return;
  }

  if (infowindow != null && currentmarker != null) {
    //currentmarker.icon = _icon;
    currentmarker.icon = _iconCenter;
    currentmarker.setMap(map);
    infowindow.close(map, currentmarker);
  }

  markersArray[currentPosition].icon = _iconCenter;
  markersArray[currentPosition].setMap(map);
  map.setCenter(new google.maps.LatLng(markersArray[currentPosition].getPosition().lat(), markersArray[currentPosition].getPosition().lng()));

  infowindow = new google.maps.InfoWindow({
    content: markersArray[currentPosition].infocontent,
    size: new google.maps.Size(50, 50)
  });
  infowindow.open(map, markersArray[currentPosition]);
  currentmarker = markersArray[currentPosition];
  if (currentPosition >= markersArray.length - 1) {
    currentPosition = 0;
  } else {
    currentPosition++;
  }
  if (markersArray.length > 1) {
    setTimeout("Recenter()", interval);
  }
} 
```

如您所见，仅出于演示目的，我在标记单击侦听器上调用了一个粗略的警报事件，但它根本没有触发。当我单击正常标记并且浏览器的开发人员工具控制台中没有错误时，什么也没有发生。我想知道这是否与让另一个事件监听地图加载有关，但我对这一点的理解处于边缘，并且没有任何错误，我正在努力知道如何调试它。

谁能指出我正确的方向来完成这项工作？

谢谢各位！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:24:31.717

我认为问题在于您在添加事件侦听器之前将标记交给集群器。尝试在创建标记后立即添加侦听器，这样当您将标记数组传递给集群器时，事件侦听器已经附加。所以试试：

```
for (var i = 0; i < items.length; i++) {
      var marker = new google.maps.Marker({
        position: new google.maps.LatLng(items[i].Lat, items[i].Lng),
        title: items[i].Title,
        icon: _icon,
        shadow: shadow,
        infocontent: items[i].Description
      });
      marker.setMap(map);

      //attach the listener now, before pushing into the array
      attachListener(marker,'marker:'+i);
      markersArray.push(marker);
    } 
```

接着：

```
 function attachListener(marker,content){
        google.maps.event.addListener(marker, "click", function () {
//      alert('test');
        infowindow.setContent(content);
        infowindow.open(map,this);
        });

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:04:15.637

[集群的工作示例](http://www.geocodezip.com/v3_MW_example_map3_clustered.html)（来自 xml 文件），标记上有信息窗口。

# .net - 如何从本机 COM 调用使用 .NET RijndaelManaged？

> ID：11972829
> 
> 赞同：2
> 
> 时间：2012-08-15T16:02:16.593
> 
> 标签：.net, winapi, com, rijndael

谁能给出[`System.Security.Cryptography.RijndaelManaged`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx)使用 COM 从本机 Win32 使用的示例用法？

* * *

这是一个如何使用 .NET 的功能示例[`System.Security.Cryptography.SHA256Managed`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256managed.aspx)

> **注意**：这是一个如何调用 SHA256Managed 的​​示例，而**不是**RijndaelManaged**。我展示这段代码是为了介绍一些使用早期和后期绑定调用 COM 对象的棘手概念，并展示使用 COM 可调用包装器调用 .NET 对象*是*可能的。当听到我想混合 .NET 和 Win32 COM 时，有些人可能会举手。

**注意：**语言是 Delphi（这是我编写和测试的语言），但经过转码使其看起来更像 C# 或 Java，因此更广泛的受众更容易理解这个问题：

```
public static string HashStr256(String szPlaintext)
{
   OleVariant sha = CreateOleObject('System.Security.Cryptography.SHA256Managed');

   OleVariant inputBuffer = VarByteArrayOf(szPlaintext);

   Integer l = VarArrayLowBound(inputBuffer, 1);
   Integer h = VarArrayHighBound(inputBuffer, 1);

   ICryptoTransform crypto = IDispatch(sha) as ICryptoTransform;
   crypto.TransformFinalBlock(
         PSafeArray(TVarData(inputBuffer).VArray), //inputArray,
         l,  //input array offset
         h-l+1); //input array count

   OleVariant digest := sha.Hash;

   Result := ToBase64String(BytesOfVarByteArray(digest));
end; 
```

使用辅助功能：

```
function VarByteArrayOf(const s: string): OleVariant;
var
    Data: Pointer;
begin
    //Create variant byte array to hold the bytes
    Result := VarArrayCreate([0, Length(s)-1], varByte);

    //Copy from Delphi array to Variant Array
    if Length(s) > 0 then
    begin
        Data := VarArrayLock(Result);
        try
            System.Move(s[1], Data^, Length(s));
        finally
            VarArrayUnlock(Result);
        end;
    end;
end; 
```

我展示代码调用的真正原因`SHA256Managed`是为了展示我`arrays`在 Delphi 中传递给 COM 时遇到的困难。例如，如果您只是依赖`IDispatch`后期绑定：

```
sha: OleVariant;
inputBuffer: OleVariant;
...
sha.TransformFinalBlock(inputBuffer, i, count); 
```

然后在运行时你得到*参数不正确*；关于`IDispatch`后期绑定的一些东西不支持传递一个`OleVariant`字节数组。

`safearray`这就是为什么我必须改为传递`OleVariant`. 众所周知，[**Variant**](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221627(v=vs.85).aspx)只是一个[联合结构](http://docwiki.embarcadero.com/Libraries/en/System.TVarData)，我们关心[`SAFEARRAY`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221482%28v=vs.85%29.aspx)成员：

```
data: PSafeArray;

data := PSafeArray(TVarData(inputBuffer).VArray);
sha.TransformFinalBlock(data, i, count); 
```

除了试图通过`PSafeArray`使用`IDispatch`后期绑定会导致 Delphi 抛出：

> OLE 自动化调用中不允许的类型

这就是为什么我们被迫部分放弃`IDispatch`后期绑定以进行`ICryptoTransform`早期绑定的原因：

```
ICryptoTransform_Native = interface(IDispatch)
   ['{8ABAD867-F515-3CF6-BB62-5F0C88B3BB11}']
   ...
   function TransformFinalBlock(inputBuffer: PSafeArray; inputOffset: Integer; inputCount: Integer): PSafeArray; safecall;
   ...
end; 
```

和

```
crypto: ICryptoTransform;
sha: OleVariant;
inputBuffer: OleVariant;

crypto = IDispatch(sha) as ICryptoTransform;
crypto.TransformFinalBlock(
         PSafeArray(TVarData(inputBuffer).VArray), //inputArray,
         i, n); 
```

所以应该是这样吧？我们已经解决了如何将数组传递给 COM .NET 对象？我现在应该可以使用`Rijndael`了；使用早期绑定`PSafeArray`。

这就是我们想用后期绑定来尝试的：

```
OleVariant aes := CreateOleObject('System.Security.Cryptography.RijndaelManaged');

OleVariant keyBytes = VarByteArrayOf(Key);
aes.Key := key; 
```

由于上述相同的原因而失败 - 您不能将`OleVariant`数组传递给 COM 对象（参数不正确）。

所以我们应该只使用的早期绑定[`SymmetricAlgorithm.Key`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.symmetricalgorithm.key.aspx)并将其`Key`作为 a传递`PSafeArray`：

```
var
   symmetric: ISymmetricAlgorithm;
   aes: OleVariant;
   keyBytes: OleVariant;
begin
   aes := CreateOleObject('System.Security.Cryptography.RijndaelManaged');

   symmetric:= (IDispatch(aes) as ISymmetricAlgorithm;
   symmetric.Key := PSafeArray(TVarData(inputBuffer).VArray);
   ...
end; 
```

除了没有[`ISymmetricAlgorithm`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.isymmetricalgorithm.aspx)接口；我编的。

如果从 导入类型库`mscorelib.tlb`，其中包含`ICryptoTransform`，则没有早期绑定`ISymmetricAlgorithm`。有*一个**后期* `ISymmetricAlgorithm`绑定：

```
IID__SymmetricAlgorithm: TGUID = '{05BC0E38-7136-3825-9E34-26C1CF2142C9}';
CLASS_SymmetricAlgorithm: TGUID = '{5B67EA6B-D85D-3F48-86D2-8581DB230C43}';
_SymmetricAlgorithm = interface;
SymmetricAlgorithm = _SymmetricAlgorithm;

_SymmetricAlgorithm = interface(IDispatch)
   ['{05BC0E38-7136-3825-9E34-26C1CF2142C9}']
end;
_SymmetricAlgorithmDisp = dispinterface
   ['{05BC0E38-7136-3825-9E34-26C1CF2142C9}']
end; 
```

那么如何设置**RijndaelManaged** `Key`和`IV`本地 Win32 COM？我可以使用什么后期绑定语法？

如何从本机 COM 调用使用 .NET RijndaelManaged？

## 进一步的尝试

由于没有`interface`我可以使用的早期绑定，我必须专注于如何通过`IDispatch`. 秘密是`Variant`我传递给 COM 对象的内容。

由于使用了早期绑定版本`safearrays`，我将从它开始。首先，我将自己*手动*设置`OleVariant`结构。

对于以下每种尝试，以下情况都是正确的：

```
key: OleVariant;
data: PSafeArray;

data := PSafeArray(TVarData(keyBytes).VArray); 
```

自己设置[变量枚举](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221170.aspx)。

*   **尝试 1**：`VT_ARRAY` *一个 SAFEARRAY 指针。*

    ```
    TVarData(key).VType := VT_ARRAY;
    TVarData(key).VArray := data; 
    ```

*   **尝试 2**：`VT_ARRAY` *一个 SAFEARRAY 指针。*

    ```
    TVarData(key).VType := VT_ARRAY or VT_I1;
    TVarData(key).VArray := data; 
    ```

*   **尝试 3**：`VT_SAFEARRAY` *安全数组。在 VARIANT 中使用 VT_ARRAY。*

    ```
    TVarData(key).VType := VT_SAFEARRAY or VT_I1;
    TVarData(key).VArray := data; 
    ```

*   **尝试 4**：`VT_SAFEARRAY` *一个安全的数组。在 VARIANT 中使用 VT_ARRAY。*

    ```
    TVarData(key).VType := VT_SAFEARRAY;
    TVarData(key).VArray := data; 
    ```

`The parameter is incorrect`它们都因错误而失败。

让我感觉到`VT_ARRAY`(a safearray) 和`VT_SAFEARRAY`(a safearray) 并不是 COM 可调用包装器 IDispatch 接口准备接受的。也许它需要`VT_CARRAY`。

或者可能不是。也许比我更聪明的人可以弄清楚。

## 奖金阅读

这本质上是对我 2008 年在 Borland 新闻组上提出的一个问题的重新表述

> [Delphi 编译器有内置的 COM SafeArrays 知识吗？](http://www.delphigroups.info/2/10/1029333.html)

*   [.NET mshtml：如何传递 BSTR SAFEARRAY？](https://stackoverflow.com/questions/489048/net-mshtml-how-to-pass-a-bstr-safearray)

# cocos2d-iphone - 从 CCAction 分配给 CCActionInterval 的指针类型不兼容

> ID：11972834
> 
> 赞同：0
> 
> 时间：2012-08-15T16:02:28.193
> 
> 标签：cocos2d-iphone

我目前正在通过出色的“通过 rod strogo 和 ray wenderlich 学习 cocos2D”，但我似乎遇到了障碍。我现在在第 2 章，我不断收到错误“不兼容的指针类型分配 yo CCActionInterval *”来自“CCAction *”。我下载了源代码作为测试并运行它，我似乎仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T21:01:42.123

这是较新版本的 Xcode 引入的问题。编译器检查得更彻底，在这种情况下它会正确报告错误。

您可以通过修复以下伪代码行来绕过错误：

```
CCActionInterval* action = [self getSomeAction]; 
```

并将返回的操作转换为 CCActionInterval*：

```
CCActionInterval* action = (CCActionInterval*)[self getSomeAction]; 
```

因此`(CCActionInterval*)`，在返回的任何操作之前添加并分配给左侧变量。这称为铸造。

# android - Android随机多项选择测验：如何识别正确答案

> ID：11972835
> 
> 赞同：0
> 
> 时间：2012-08-15T16:02:32.267
> 
> 标签：android, random, arrays, multiple-choice

我正在尝试为 android 创建一个随机多项选择测验。我想显示一个字符串数组中的随机问题，另一个字符串数组中的相应答案显示在四个选项之一中。其他三个选项将来自另一个字符串数组，该数组将用于随机提供所有问题的“错误”答案。

两个问题：有没有更好的方法来进行这样的多项选择测验？-and- 当玩家选择答案时，我如何识别答案来自哪个数组？

这是我用来随机化的代码：

```
String[] question = { //questions here// };  
ArrayList<String> questionList = new ArrayList(Arrays.asList(question));  

String[] answer = { //answers here// };  
ArrayList<String> answerList = new ArrayList(Arrays.asList(answer));

String[] distractor = { //distractors here// };  
ArrayList<String> distractorList = new ArrayList(Arrays.asList(distractor));  

int i = 0;  
Random r = new Random();  
public void randomize() {

        TextView word = (TextView) findViewById(R.id.textView1);
        TextView choice1 = (TextView) findViewById(R.id.textView2);
        TextView choice2 = (TextView) findViewById(R.id.textView3);
        TextView choice3 = (TextView) findViewById(R.id.textView4);
        TextView choice4 = (TextView) findViewById(R.id.textView5);
        if (i < question.length) {
            int remaining = r.nextInt(questionList.size());
            String q = questionList.get(remaining);
            word.setText(q);
            questionList.remove(remaining);
            String a = answerList.get(remaining);
            int slot = r.nextInt(4);
            TextView[] tvArray = { choice1, choice2, choice3, choice4 };
            tvArray[slot].setText(a);
            answerList.remove(remaining);
          //an if/else statement here to fill the remaining slots with distractors 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:11:56.280

我建议创建一个名为 QuestionAndAnswer 的新类。该类应该保存问题和正确答案，它还可以保存任何自定义的错误答案和用户的选择。确切的实施完全取决于您。

在您的 Activity 中有一个此 QuestionAndAnswer 类的数组，以循环浏览列表，询问问题并在完成后计算分数。

（如果您包含您尝试过的相关代码，我可能会更具体。）

* * *

**添加**

这就是我要开始的内容：（
从您的代码中，我猜测其中`distractorList`包含您要显示的错误答案。）

```
public class QuestionAndAnswer {
    public List<String> allAnswers; // distractors plus real answer
    public String answer;
    public String question;
    public String selectedAnswer;
    public int selectedId = -1;

    public QuestionAndAnswer(String question, String answer, List<String> distractors) {
        this.question = question;
        this.answer = answer;
        allAnswers = new ArrayList<String> (distractors);

        // Add real answer to false answers and shuffle them around 
        allAnswers.add(answer);
        Collections.shuffle(allAnswers);
    }

    public boolean isCorrect() {
        return answer.equals(selectedAnswer);
    }
} 
```

对于 Activity，我将您的四个答案 TextViews 更改为 RadioGroup，这样用户可以直观地选择答案。我还假设会有`prev`和`next`按钮，它们会调整`int currentQuestion`和调用`fillInQuestion()`。

```
public class Example extends Activity {
    RadioGroup answerRadioGroup;
    int currentQuestion = 0;
    TextView questionTextView;
    List<QuestionAndAnswer> quiz = new ArrayList<QuestionAndAnswer>();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        questionTextView = (TextView) findViewById(R.id.question);
        answerRadioGroup = (RadioGroup) findViewById(R.id.answers);

        // Setup a listener to save chosen answer
        answerRadioGroup.setOnCheckedChangeListener(new OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId) {
                if(checkedId > -1) {
                    QuestionAndAnswer qna = quiz.get(currentQuestion);
                    qna.selectedAnswer = ((RadioButton) group.findViewById(checkedId)).getText().toString();
                    qna.selectedId = checkedId;
                }
            }
        });

        String[] question = { //questions here// };  
        String[] answer = { //answers here// };  
        String[] distractor = { //distractors here// };  
        ArrayList<String> distractorList = Arrays.asList(distractor);  

        /* I assumed that there are 3 distractors per question and that they are organized in distractorList like so:
         *   "q1 distractor 1", "q1 distractor 2", "q1 distractor 3", 
         *   "q2 distractor 1", "q2 distractor 2", "q2 distractor 3",
         *   etc
         *   
         * If the question is: "The color of the sky", you'd see distractors:
         *   "red", "green", "violet"
         */   
        int length = question.length;
        for(int i = 0; i < length; i++)
            quiz.add(new QuestionAndAnswer(question[i], answer[i], distractorList.subList(i * 3, (i + 1) * 3)));
        Collections.shuffle(quiz);

        fillInQuestion();
    }

    public void fillInQuestion() {
        QuestionAndAnswer qna = quiz.get(currentQuestion);
        questionTextView.setText(qna.question);

        // Set all of the answers in the RadioButtons 
        int count = answerRadioGroup.getChildCount();
        for(int i = 0; i < count; i++)
            ((RadioButton) answerRadioGroup.getChildAt(i)).setText(qna.allAnswers.get(i));

        // Restore selected answer if exists otherwise clear previous question's choice
        if(qna.selectedId > -1)
            answerRadioGroup.check(qna.selectedId);
        else 
            answerRadioGroup.clearCheck();
    }
} 
```

您可能已经注意到 QuestionAndAnswer 有一个 isCorrect() 方法，当需要给测验评分时，您可以像这样计算正确答案：

```
int correct = 0;
for(QuestionAndAnswer question : quiz)
    if(question.isCorrect())
        correct++; 
```

这是我的一般想法。代码是一个完整的想法，所以它会编译。当然，您需要添加一个“下一步”按钮来查看不同的问题。但这足以让您看到一种在保持问题和答案井井有条的同时随机化问题和答案的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:16:32.540

这里有一个样本，你可以试试。这是一个数据模型，喜欢为问答事物保存东西。

```
<data-map>
    <question id="1">
        <ask>How many questions are asked on Android category daily? </ask>
        <answer-map>
            <option id="1">100 </option>
            <option id="2">111 </option>
            <option id="3">148 </option>
            <option id="4">217 </option>
        </answer-map>
        <correct id="3" />
    </question>

    <question id="2">
        <ask>Which band does John Lenon belong to? </ask>
        <answer-map>
            <option id="1">The Carpenters </option>
            <option id="2">The Beatles </option>
            <option id="3">Take That </option>
            <option id="4">Queen </option>
        </answer-map>
        <correct id="2" />
    </question>

</data-map> 
```

好的，所以你每次显示一个问题时，你都有所有要回答的选项，以及每个问题的正确答案。只需创建一个适当的数据结构来保存它们。无论如何，只是一个样本，不是一个完美的，但如果你对这些东西不熟悉，请尝试一下^^！

# xml - AS3 - 获取、创建和保存 XML 文件

> ID：11972837
> 
> 赞同：0
> 
> 时间：2012-08-15T16:02:37.053
> 
> 标签：xml, actionscript-3, file, setter, getter

我正在创建一个名为 QuizMaker 的游戏。
游戏的测验是外部 .xml 文件，QuizMaker 将通过我的 QuizXML 类导入这些文件。每个测验都包含带有答案的问题，可能是图像形式，可能是文本形式或其他形式。玩家应该能够浏览 QuizMaker 中的“我的测验”文件夹。
为此，我需要该文件夹中的文件列表。
这是未完成的 getter 函数，我的问题是：如何获取文件列表？

```
//returns an array of paths to folders and/or .xml files from the folder "My Quizzes"  
public function getFolders():Array {  
    var folders:Array = new Array();  
    //if .xml or a folder is the file looking at, add the file path to folders  
    return folders;  
}  

//returns an array of .xml file paths from an array consisting of file paths  
//if a folder, which contains .xml files, is encountered from the array, add the .xml file paths to an array  
public function getQuizzes(folders:Array):Array {  
    var validXML:Array = new Array();  
    for(var curPath:uint=0;folders.length>curPath;curPath++) {
        //if folders[curPath] is a folder  
            //somehow look through the folder's content
            //if .xml is the file looking at, add the file path to validXML
        //else if .xml is the file looking at, add the file path to validXML  
    }
    return validXML;  
} 
```

我的第二个问题是，如何将 XML 文件保存在“我的测验”文件夹中？
这些是未完成的 setter 函数：

```
//creates new folders inside "My Quizzes" from an array, which contains the folders' names as strings
//if a folder with the same name is encountered, don't override that folder
public function setFolders(folderNames:Array):void {  
    for(var curPath:uint=0;folderNames.length>curPath;curPath++) {  
        //if a folder exists as folderNames[curPath]  
            //do nothing  
        //else create a folder called folderNames[curPath]  
    }  
}  

//creates new .xml files from an array, which contains XML objects, inside a folder from a string  
//if an .xml file with the same name as an XML object's nameFile is encountered, don't override that .xml file  
public function setQuizzes(outputPath:String,objectsXML:Array):void {  
    for(var curXML:uint=0;objectsXML.length>curXML;curXML++) {  
        //if an .xml file exists as objectsXML[curXML].nameFile  
            //do nothing  
        //else create objectsXML[curXML] as an .xml file  
    }  
} 
```

感谢您阅读我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:19:32.767

[FileReference](http://www.adobe.com/devnet/flash/quickstart/filereference_class_as3.html)可能是您正在寻找的。

它允许用户浏览文件并将应用程序保存到文件系统。

```
private function save():void
{
    var bytes:ByteArray = new ByteArray();
    var fileRef:FileReference = new FileReference();
    bytes.writeMultiByte("<root>", "iso-8859-1");
    //write your xml here
    bytes.writeMultiByte("</root>", "iso-8859-1");

    fileRef.save(bytes,"savedata.xml");
} 
```

# c# - 释放一个已添加到集合中的对象，但该集合仍有对其的引用

> ID：11972841
> 
> 赞同：2
> 
> 时间：2012-08-15T16:02:45.827
> 
> 标签：c#, memory-leaks, dispose, using

从遗留系统中读取一些代码。

假设我有一个 A 类的实例，然后将其添加到集合中，然后将其丢弃。

我只是不明白在这里使用隐式处理有什么意义，因为代码仍然使用 myControlColcetion，这意味着无论如何都不会真正释放 cltCheckBoxA。

为什么？

```
using (UserControlA cltCheckBoxA = new UserControlA())
{
    //some operation
    base.myControlCollcetion.Add(cltCheckBoxA);
}

//Other operation against myControlCollcetion 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:08:26.870

释放一个对象与释放它的托管内存（这是 GC 所做的）完全不同。Dispose 明确清除垃圾收集器无法释放的所有*非托管资源。*

这意味着当对象在`Dispose`被调用之后被使用时，有很多可能性。（这不是一个详尽的清单。）

1.  许多对象在它们的非托管资源被清理后基本上就无法使用了。在这种情况下，他们通常会在访问其中一个成员时抛出异常。
2.  该对象可能只是在一个意想不到的庄园中发挥作用，因为它在被处置后被使用。它可能会导致奇怪的异常，或者只是方法的错误结果，或者实际上是任何事情。
3.  它可能从未真正拥有过非托管资源。一些对象实现 IDisposable 只是为了使它们更具可扩展性，或者尝试使它们适应未来。 `DataTable`就是一个例子；它`Dispose`什么也没做。在这种情况下，对象在处理后将正常工作。
4.  即使没有非托管资源，该对象也可能仍然可用。可能只有一部分功能在`Dispose`被调用后变得不可用，在这种情况下，只要以后只使用那些有限的方面，它就可以正常工作。
5.  某些对象在释放后访问时可能会重新创建它的非托管资源。这将是不好的做法，但这是你的课程，你可以做你想做的事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T16:03:42.300

你是对的，没有理由这样做，即使有，这也是糟糕的代码，非常令人困惑。

*开发人员*可能打算显式调用（出于某种原因。例如，在标记为的代码部分中`Dispose(..)`可能会执行一些分配非托管资源的函数），并试图避免添加额外的序列（自动处理）。`UserControlA``//some operation``try/catch``using`

但我再说一遍，这*不是*一个好的代码。

# jquery - 滚动到当前打开旁边的元素

> ID：11972842
> 
> 赞同：0
> 
> 时间：2012-08-15T16:02:51.033
> 
> 标签：jquery, html, scroll, slide

当我单击箭头按钮时，一个窗口会滚动到下一个元素，但是当我向下滚动并单击一个随机元素时，它会首先返回到我之前单击的元素，或者，如果我不单击，它会转到第一个元素。

我希望它滚动到当前单击的元素旁边。一切都在冒泡。

我工作的网站，情况出现的地方 - [http://dawidjarzabek.pl/test](http://dawidjarzabek.pl/test)

jQuery：

```
var currentElement = $(".post");

$('.post #nav a.prev').click(function() {
    currentElement = currentElement.prev();
    $.scrollTo(currentElement, 800);
});

$('.post #nav a.next').click(function() {
    currentElement = currentElement.next();
    $.scrollTo(currentElement, 800);
}); 
```

HTML：

```
<div id="1" class="section">

    <div class="post position">
        <div id="photo"><center><img src="photos/studio/1.jpg" /></center></div>
        <div id="nav"><a class="prev"><img src="images/icon_top.png" /></a><a class="next"><img src="images/icon_bottom.png" /></a></div>
        <div id="text">
            <h1>Modelka: </h1>
            <h2></h2>
            <h1>Wizaż : </h1>
            <h2></h2>
        </div>
    </div>
    <div class="post position">
        <div id="photo"><center><img src="photos/studio/2.jpg" /></center></div>
        <div id="nav"><a class="prev"><img src="images/icon_top.png" /></a><a class="next"><img src="images/icon_bottom.png" /></a></div>
        <div id="text">
            <h1>Modelka: </h1>
            <h2></h2>
            <h1>Wizaż : </h1>
            <h2></h2>
        </div>
    </div>
</div>

[the rest .post and .section] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:36:42.720

尝试这个：

```
$('.post #nav a.prev').click(function() {
    $.scrollTo($(this).closest('.post').prev(),800);
});

$('.post #nav a.next').click(function() {
    $.scrollTo($(this).closest('.post').next(),800);
}); 
```

而且您不必存储变量 currentElement。;)

# javascript - 如何使用 prettify.js 主题？

> ID：11972844
> 
> 赞同：3
> 
> 时间：2012-08-15T16:02:56.077
> 
> 标签：javascript, themes, prettify, google-code-prettify

prettify.js有[一组“主题”](http://google-code-prettify.googlecode.com/svn/trunk/styles/index.html)。

我如何实际使用它们？我`<link href="">`是选择一个选定的“主题”`.css`文件而不是`prettify.css`文件还是做其他事情？程序是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:05:11.373

只需将默认 CSS 文件替换为主题的 CSS 文件即可：

```
<link href="sunburst.css" type="text/css" rel="stylesheet" /> 
```

# php - 使用 PHP 解析 XML 特殊字符

> ID：11972847
> 
> 赞同：1
> 
> 时间：2012-08-15T16:03:05.370
> 
> 标签：php, xml, special-characters

我正在使用 PHP 从 XML 文档中提取信息并将其回显到页面。在 XMl 文档中，有一些特殊字符，例如 Éamon。当我使用 PHP 回显这些字符时，它看起来像 Ã‰amon。

谁能告诉我如何对这些字符进行转码以便它们正常解析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:07:37.863

你可以让浏览器为你做这件事。在标题中，指定您的字符集为 utf-8：

```
header('Content-Type: text/html; charset=utf-8'); 
```

在向浏览器输出任何其他内容*之前*执行此操作。现在浏览器将正确解码特殊字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:12:36.043

您可以使用

```
<meta http-equiv='Content-Type' content='Type=text/html; charset=utf-8'> 
```

# vba - 在“查找”vba 中找不到项目

> ID：11972850
> 
> 赞同：5
> 
> 时间：2012-08-15T16:03:16.523
> 
> 标签：vba, excel, find

我正在从列表中查找用户 ID #s。然而，一些用户不再存在。我试过`test`方法，`on error go to`方法，`if err.number<> 0 then`方法。我仍然收到`Run-time error '91': object variable or with block variable not set`. 该号码在列表中不存在。下面是我的代码，经过几次无果的尝试

```
On Error GoTo errorLn

If Err.Number <> 0 Then
 GoTo errorLn
End If
Cells.Find(What:=uSSO, After:=ActiveCell, LookIn:=xlFormulas, _
    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
    MatchCase:=False, SearchFormat:=False).Select 
```

还有哪些其他选择？还是我放错了“错误”行？我在“cells.Find...”之前和之后都试过了

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-15T16:12:36.713

大概你会想做一些与消息框不同的事情。

```
Dim myCell As Range

Set myCell = Cells.Find(What:=uSSO, After:=ActiveCell, LookIn:=xlFormulas, _
LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
MatchCase:=False, SearchFormat:=False)

If (Not myCell Is Nothing) Then
    MsgBox "something!"

Else
    MsgBox "nothing"
End If 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T16:08:32.087

我相信你需要稍微重组它。使用 处理错误不是*最佳*`On Error Resume Next`做法，但您可以尝试以下操作：

```
On Error Resume Next
Cells.Find(What:=uSSO, After:=ActiveCell, LookIn:=xlFormulas, _
    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
    MatchCase:=False, SearchFormat:=False).Select

If Err.Number <> 0 Then
 '''Do your error stuff'''
 GoTo errorLn
Else
    Err.Clear
End If 
```

这对你的情况有用吗？

**来源**：[http ://www.mrexcel.com/forum/excel-questions/143988-check-if-value-exists-visual-basic-applications-array.html](http://www.mrexcel.com/forum/excel-questions/143988-check-if-value-exists-visual-basic-applications-array.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-15T16:09:42.477

尝试这个

```
Sub Sample1()
    Dim oSht As Worksheet
    Dim uSSO As String
    Dim aCell As Range

    On Error GoTo Whoa

    '~~> Change this to the relevant sheet
    Set oSht = Sheets("Sheet1")

    '~~> Set User ID here
    uSSO = "User ID"

    Set aCell = oSht.Cells.Find(What:=uSSO, LookIn:=xlFormulas, _
    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
    MatchCase:=False, SearchFormat:=False)

    '~~> Check if found or not
    If Not aCell Is Nothing Then
        MsgBox "Value Found in Cell " & aCell.Address
    Else
        MsgBox "Value Not found"
    End If

    Exit Sub
Whoa:
    MsgBox Err.Description
End Sub 
```

我还建议阅读我已经介绍过的这个`.Find`链接`.FindNext`

**主题： Excel VBA 中的 .Find 和 .FindNext**

**链接**：[https ://web.archive.org/web/20160316214709/https://siddharthout.com/2011/07/14/find-and-findnext-in-excel-vba/](https://web.archive.org/web/20160316214709/https://siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-09T09:49:46.037

只是为了后代，这就是你如何在没有错误处理的情况下做到这一点（来自：[http ://www.mrexcel.com/forum/excel-questions/519070-visual-basic-applications-error-handling-when-dealing-细胞-find.html](http://www.mrexcel.com/forum/excel-questions/519070-visual-basic-applications-error-handling-when-dealing-cells-find.html) )。

```
Dim rngFound As Range

Set rngFound = Sheets("WhateverSheet").UsedRange.Find(What:="SoughtValue",LookIn:=xlFormulas)

If Not rngFound Is Nothing Then
  'you found the value - do whatever
Else
  ' you didn't find the value
End if 
```

# javascript - 添加引用现有命名空间的 XHTML 元素

> ID：11972852
> 
> 赞同：2
> 
> 时间：2012-08-15T16:03:34.620
> 
> 标签：javascript, jquery, xml, xhtml

### 问题

给定一个定义了自定义命名空间的 XHTML 文档，

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:foo="hello">…&lt;/html> 
```

如何使用 jQuery（或 vanilla JavaScript）添加具有引用该命名空间的属性的元素，指定为字符串：

```
var newElement = '<p foo:bar="please">add me</p>'; 
```

### 你试过什么？

```
var xhtml = '<p foo:bar="no">two</p>';

try     { $('div').append(xhtml); }
catch(e){ alert(e);               }
// [FFv14]     "An invalid or illegal string was specified"  code: "12"
// [Chromev21] Error: SYNTAX_ERR: DOM Exception 12
// [IE9]       DOM EXception: SYNTAX_ERR (12)

try     { $('div')[0].innerHTML += xhtml; }
catch(e){ alert(e);                       }
// [FFv14]     Works!
// [IE9]       Works!
// [Chromev21] Error: SYNTAX_ERR: DOM Exception 12 
```

### 测试页（[托管](http://phrogz.net/tmp/js_add_element_referencing_namespace.xhtml)）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:foo="hello"><head>
  <meta http-equiv='Content-Type' content='Type=text/html; charset=utf-8'/>
  <title>Using JS to add element referencing custom namespace</title>
</head><body>
  <div><p foo:bar="yes">one</p></div>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript"><![CDATA[
    var xhtml = '<p foo:bar="no">two</p>';

    try     { $('div').append(xhtml); }
    catch(e){ alert(e);               }

    try     { $('div')[0].innerHTML += xhtml; }
    catch(e){ alert(e);                       }
  ]]></script>
</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T00:09:29.713

我能想到的最好的办法是

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:foo="hello"><head>
  <title>Using JS to add element referencing custom namespace</title>
</head><body >
  <div><p foo:bar="yes">one</p></div>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript"><![CDATA[
    var xhtml = '<p foo:bar="no">two</p>';
    try { 
      var wrap = '<div xmlns:foo="' + $('div')[0].lookupNamespaceURI('foo') + '">'+ xhtml + '</div>';
      var el = document.createElement('div');
      el.innerHTML = wrap;
      $('div')[0].appendChild(el.firstChild.firstChild);
    }
    catch(e){ alert(e); }
  ]]></script>
</body></html> 
```

需要一些打包，但似乎适用于 IE9、Chrome 21、FF 14 和 Opera 12。

# javascript - 强制图像完全加载

> ID：11972853
> 
> 赞同：0
> 
> 时间：2012-08-15T16:03:37.490
> 
> 标签：javascript, jquery, html

我对Web开发相当陌生，所以请原谅我的无知。我正在处理一个生成色板的页面，这些色板只是高分辨率图像的一小部分。一次最多可生成 70 个此类样本。我的问题是我无法在第一次尝试时完全显示图像，我必须再次调用该函数才能完全加载图像。如果我设置了一个函数，使我的样本在加载时可见（我使用的是 JQuery 的 .load）它永远不会触发，我假设因为它从未实际加载。有什么方法可以强制加载包含大量内容的页面？

```
function showswatches(section, xmlHttpObj){
    for(i=0;i<xmlHttpObj.length;i++){
        if(xmlHttpObj[i].getElementsByTagName('section')[0].childNodes[0].nodeValue == section){
            $('#swatches').html();
            var colors = xmlHttpObj[i].getElementsByTagName('color');
            for(j=0;j<colors.length;j++){
                $('#swatches').append('<div class="swatch">');
                $('#swatches').append('<img src='+colors[j].childNodes[0].nodeValue+'>');
                $('#swatches').append('</div>');
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:14:43.000

我可以给你两个选择——

* * *

### 第一个选项——

为每个图像添加一个`.load()`处理程序，并且仅在图像完全加载后才显示图像（同时您可以显示各种加载器）。如果您将所有图像都归为同一类，则您可以一次将事件附加到所有图像上。例如，如果您的所有`<img>`元素都包含`preloadImg`该类，并且您在`swatch`容器 div 中放置了一个小的 loader 元素，您可以创建一个像这样的处理程序 -

```
$('img.preloadImg').on('load',function(){
  $(this).parent().find('loader').hide(); // hide loader
  $(this).show();  // images initially hidden
}); 
```

* * *

### 第二种选择——

您可以使用 JavaScript 预加载您的色板，以便它们在您的整个文档被加载并且 jQuery 触发`document.ready`回调之前开始加载。为此，您可以简单地创建一个 JavaScript`Image()`对象数组并为每个对象赋予适当的`src`属性。

```
var imagePaths = ['swatch1.png','swatch2.png','swatch3.png'];
var imageLoader = new Array();
for(var i=0;i<imagePaths.length;i++){
  var img = new Image();
  img.src = imagePaths[i];
  imageLoader.push(img);
} 
```

一旦您创建`Image()`对象并为其赋予`src`属性，图像就会开始加载，这可能会减少您的加载时间，因为正如我之前所说，一旦 JavaScript 可用，图像就会开始加载 - 在 jQuery 加载之前，甚至在加载完整的 HTML 内容之前。

# c++ - OpenGL中动态模型的实例化绘图

> ID：11972855
> 
> 赞同：8
> 
> 时间：2012-08-15T16:03:40.710
> 
> 标签：c++, opengl, opengl-3

我目前正在开发一个框架，可以方便地渲染大量动画模型。

一个模型被组织为一个简单的骨骼层次结构，根是躯干/骨盆，通常：

![我的简单建模层次结构](../Images/7031d35d76ca25e30ec82fd2c8a83d85.png)

因此，作为伪代码，我目前正在渲染这样的模型：

```
RenderBone(Bone b, Mat4x4 currentTransform){
    Mat4x4 pos = currentTransform * b.boneTransform;
    SetUniform("transformation", pos);
    Draw(bone.mesh);
    for each Bone bc in b.children do{
         RenderBone(bc, pos);
    }
} 
```

因此，对于使用具有 n 个骨骼的模型的单个演员，我需要 n 个 SetUniform（不包括设置纹理之类的东西）和 n 个绘制调用。

为了减少开销，并一次使用相同的模型渲染所有演员，我考虑切换到实例渲染。

但是，我能找到的所有信息和教程都是关于绘制立方体、球体或类似的简单对象的。我在任何地方都看不到一些关于如何使用实例绘图来渲染模型的简单易懂的信息，其中每个部分（骨骼）都需要为着色器提供不同的转换矩阵。

所以，问题是：使用`glVertexAttribDivisor`or`gl_InstanceID`我只能指定一个与实例相关的矩阵，而不是一个与骨骼相关的矩阵。那我该如何应用我的骨骼转换呢？

我能想到的唯一可行的解​​决方案是 - 我可以实例化每个骨骼，而不是实例化整个模型。从而绘制一种骨骼类型的所有实例，然后绘制另一种，等等。但是我仍然需要相对频繁地使用转换矩阵更新缓冲区，而且它是更多的家务代码。

那么这是最好的选择吗？或者，更一般地说，是否有更好的不太复杂的渲染方式？还是实例化渲染仅在与静态几何体一起使用时才真正发挥作用？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-15T16:45:48.517

*当您需要绘制同一模型的数千个*副本时，您会使用实例化。通常，带有骨骼的网格不是您需要绘制数千个的东西。

实例化是一种优化，*但并不*总是有回报。除非您知道自己*需要*它（通过分析并查看您是否达到性能目标），否则您不应该费心尝试使用它。即便如此，它何时是实际的性能改进也可能非常敏感。

有时，它只是无济于事。但这里有一些一般的经验法则：

1.  除非您要渲染数千个实例，否则实例化是不值得的。
2.  实例化不应与顶点过多或过少的网格一起使用。100-1,000左右。

请记住，这些是*一般*规则，而不是绝对规则。它们也依赖于硬件。

> 所以，问题：使用 glVertexAttribDivisor 或 gl_InstanceID 我只能指定一个与实例相关的矩阵，而不是一个与骨骼相关的矩阵。那我该如何应用我的骨骼转换呢？

就你看到的例子或你看到其他人所做的事情而言，你想的太多了。像*程序员*一样思考。

`gl_InstanceID`不是“与实例相关的矩阵”；它是一个*索引*。您如何使用该索引完全取决于您。您看到的大多数示例都使用此索引来查找矩阵数组，这些矩阵可能存储在[统一块](http://www.opengl.org/wiki/Uniform_Buffer_Object)或[缓冲区纹理](http://www.opengl.org/wiki/Buffer_Texture)中。该矩阵是您用于渲染的变换。每个索引代表单个实例的转换。

您的每个实例都有多个矩阵、多个转换。但是每个实例都有相同数量的骨骼（否则它不会被实例化渲染）。假设你有 5 块骨头。

同样，每个索引都是单个实例的转换。您的案例和标准之间的区别在于每个实例需要多少信息。常规情况需要一个矩阵；你需要五个。但无论哪种方式，想法都是一样的。

如果当前实例需要骨骼索引 3，则只需使用以下表达式访问矩阵数组：`(gl_InstanceID * 5) + 3`，其中 5 是每个实例的骨骼数。

剩下的就是使用每个顶点属性来传递用于变换每个顶点的骨骼索引的简单问题。

# php - 列出来自多个目录的 mp3 文件

> ID：11972861
> 
> 赞同：0
> 
> 时间：2012-08-15T16:04:09.353
> 
> 标签：php, html

我又遇到问题了……我的目录结构是：

```
mp3/
   /CD1/
       /test1.mp3
       /test2.mp3 ...
   /CD2/
       /test3.mp3 ... 
```

我正在尝试获取诸如 spotify 之类的输出，所有信息都取自 dir 结构：

CD1 ---- 歌曲：test1.mp3 / test2.mp3 / ...

然后扫描下一个文件夹并输出：

CD2 ---- 歌曲：test3.mp3 / ...

对于连续的文件夹。

我能够输出 mp3 目录中的所有文件，但这不是我想要的。

管理员必须能够添加新文件夹“CD3”并且 .php 页面必须显示新文件夹及其歌曲。

CD3 ---- 歌曲：test4.mp3 / ...

我不知道这是否可能......我正在尝试设置代码，以便网页管理员不需要触摸任何代码，而只需触摸文件结构。

谢谢！

我想要的想法在这里：http: [//qalbiol.x10.mx/qalbiol/sounds.php](http://qalbiol.x10.mx/qalbiol/sounds.php)

上述工作是因为我手动将 mp3/CD1 设置为搜索目录，然后将 mp3/CD2 设置为搜索目录...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:09:48.387

我对图像做了类似的事情，不确定这是否有帮助：

```
$path = WWW.'/images/user-images/public';
if(is_dir($path)){
    $dir1 = opendir($path);

    while($scan = readdir($dir1)){ 
        if(is_dir($path.'/'.$scan) && $scan != '..' && $scan != '.'){
            $dir2 = opendir($path.'/'.$scan);
            $counter = 0;
            while($images = readdir($dir2)){
                if(!is_dir($images) && $images != '..' && $images != '.'){
                    $allImages[$counter] = $images;
                    $counter++;
                }
            }   
        }
    }
} 
```

# php - fputCSV 奇怪的行为

> ID：11972864
> 
> 赞同：0
> 
> 时间：2012-08-15T16:04:19.910
> 
> 标签：php, fputcsv

我正在使用 fputcsv 创建一个 csv，但是当我在 excel 中打开它时，它输出的数据从第三行开始。为什么是这样？

我想使用 fputcsv 创建一行列标题，最好的方法是什么？

```
public function indexAction()
    {
        $this->outputCSV();
        //$this->view->navigation = $navigation = Engine_Api::_()->getApi('menus', 'core')->getNavigation('passport_admin_main', array(), 'passport_admin_main_outofarea');
        $this->_helper->layout()->disableLayout();
        $this->_helper->viewRenderer->setNoRender(true);

        header('Content-Disposition: attachment; filename="OutOfAreaReport.csv"');
        header('Content-type: application/excel');
        readfile('OutOfAreaReport.csv');
    }

    public function outputCSV(){
        $list = array (
                array('aaa', 'saasasbbb', 'ccdddc', 'dddd')
                );
        $fp = fopen('php://output', 'w');

        foreach ($list as $fields) {
            fputcsv($fp, $fields);
        }

        fclose($fp);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T16:15:34.100

因为您正在将数据写入`php://output`，所以我假设您正在提供文件以供下载？

好吧，文件中额外的新行来自您的脚本，您已经输出了它们。

`<?php`这里最常见的罪魁祸首是脚本中开始标记之前的空白：

错误的：

```

<?php
  // 你的代码在这里

```

对：

```
<?php
  // 你的代码在这里

```

**编辑**感谢@SDC 提醒我这也适用于您包含的任何文件。对于这些文件，您还需要确保结束`?>`标记后没有尾随空格，或者最好完全删除结束标记，因为脚本不需要正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-17T18:56:45.437

我知道这已被标记为已回答，但是当我遇到类似的问题时，我有很多包含，所以我添加了 ob_clean; 清除缓冲区并解决空间问题。例子：

> 公共函数输出CSV（）{
> 
> $list = array (array('aaa', 'saasasbbb', 'ccdddc', 'dddd') );

```
//add here  
ob_clean; 
```

> ```
>  $fp = fopen('php://output', 'w');
> 
>    foreach ($list as $fields) {
>        fputcsv($fp, $fields);
>    }
> 
>    fclose($fp); 
> ```
> 
> }

# netbeans - 如何在 Sublime Text 2 中做这两件事？

> ID：11972867
> 
> 赞同：5
> 
> 时间：2012-08-15T16:04:32.347
> 
> 标签：netbeans, ide, editor, sublimetext, sublimetext2

我最近将编辑器从 Netbeans IDE 切换到 Sublime Text 2。在 Netbeans 中编码 PHP 时，如果我有语法错误，它会在该行的开头有一个错误图标。

**Sublime Text 2 似乎并没有开箱即用。我必须安装什么插件才能获得此功能？**

在 Netbeans 中，您可以设置代码模板。例如，您将基本上编写如下内容：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script> 
```

并调用模板`jquery`。然后，每次您需要在页面上使用 jquery 时，您只需`jquery`点击并点击`tab`，脚本标签就会插入该位置。

**如何在 Sublime 中做这种类型的代码模板/快捷方式？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T19:13:05.700

**php语法检查**

SublimeLinter 插件支持自动 php 语法检查：

[https://github.com/SublimeLinter/SublimeLinter](https://github.com/SublimeLinter/SublimeLinter)

**模板**

对于 javascript 源，您可以使用 cdnjs 插件：

[https://github.com/dafrancis/Sublime-Text--cdnjs](https://github.com/dafrancis/Sublime-Text--cdnjs)

更一般地说，您可以创建自己的模板。这是一个完成你想要的东西。将其保存在包目录的用户文件夹中（转到 Preferences -> Browse Packages），名称为“jquery.sublime-snippet”

```
<snippet>
    <content><![CDATA[
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
]]></content>
    <tabTrigger>jquery</tabTrigger>
</snippet> 
```

# azure - 使用 Solr 在 Azure VM 上构建专用搜索服务器

> ID：11972868
> 
> 赞同：1
> 
> 时间：2012-08-15T16:04:36.447
> 
> 标签：azure, solr, lucene

我是一个不了解 Linux、Apache、Java 和 Solr 的 .NET 人员。但经过研究，我仍然认为建立一个专用的搜索服务器是要走的路。

我想要实现的是：建立一个基于Solr的专用搜索服务器，并托管在Azure虚拟机上。我将使用 REST api 来更新索引和查询。所以对于服务器本身的设置和忘记（我希望）。

以下是研究后的方案，请指教。

问题 1：获取 Azure 虚拟机，按照[本文建议](http://www.interoperabilitybridges.com/Azure/Getting_Started_Guide_Solr_Lucene.asp)安装 Solr 。然后是持久化存储位置（放置索引），如何确保它不会在服务器重新启动或重新部署后消失。

问题2：我只想我在Azure中的另一个实例可以查询，那么虚拟网络来玩吗？

问题3：这个设置真的免维护吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:22:12.253

*   问题 1：数据将使用云驱动器（Blob 存储中的页 blob）进行持久化，并且在服务器重新启动或重新部署后持久化。

*   问题 2：如果您向同一个托管服务/云服务添加更多角色，您甚至不需要使用虚拟网络，您可以简单地使用内部端点。如果您尝试从不同的托管服务/云服务或虚拟机访问托管 Solr 的托管服务/云服务，那么您需要使用虚拟网络。

*   问题 3：我不相信这个设置真的是免维护的。想想自动缩放您的从属设备，......您是否考虑过[LucidWorks](http://blogs.msdn.com/b/interoperability/archive/2012/06/11/solr-and-lucidworks-enterprise-search-for-windows-azure.aspx)（它是 Solr 的 Windows Azure 合作伙伴）？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T14:21:20.253

替代解决方案：使用 VM 库在几分钟内部署 Solr

![在此处输入图像描述](../Images/fd659f8b0f5c5ca9ce44563b0d06ae21.png)

更多信息： http: [//fabriccontroller.net/blog/posts/browse-and-use-images-from-the-vm-depot/](http://fabriccontroller.net/blog/posts/browse-and-use-images-from-the-vm-depot/)

# database - 在 DB2 Express-C 中找不到命令编辑器

> ID：11972869
> 
> 赞同：0
> 
> 时间：2012-08-15T16:04:48.690
> 
> 标签：database, db2

我在我的系统中安装了 DB2 Express-C 最新版本。安装后，我找不到任何命令编辑器/控制中心。我所能看到的只是一个命令编辑器。是不是我必须使用该命令编辑器执行我的查询，而没有任何用户友好的 UI，例如命令编辑器或其他一些 UI？

请建议

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:49:15.807

如果您拥有 v10.1（我假设您是，因为您说的是“最新版本”），那么这些应用程序已被弃用，取而代之的是[IBM Data Studio](http://www.ibm.com/developerworks/downloads/im/data/)。

如果您想在 DB2 v10 中使用 GUI，您应该下载并安装 Data Studio。

# java - 为什么我会收到无法解析的日期错误？

> ID：11972875
> 
> 赞同：-5
> 
> 时间：2012-08-15T16:05:12.347
> 
> 标签：java, android

我的代码告诉我我有一个无法解析的日期，但我找不到它，有人可以帮我吗？

```
public class TaskReminderActivity extends ListActivity 
{
private static final int ACTIVITY_CREATE=0;
private static final int ACTIVITY_EDIT=1;
private static final int START_PICKER_DIALOG = 1;
private static final int END_PICKER_DIALOG = 2;

//Date Time Format
private static final String DATE_FORMAT = "yyyy-MM-dd"; 
private static final String TIME_FORMAT = "kk:mm";
public static final String DATE_TIME_FORMAT = "yyyy-MM-dd kk:mm:ss";

private RemindersDbAdapter mDbHelper;
private EditText mName;
private Button mSend;
final Context context = this;
private String inputName;
private String inputPassword;
private Editable editName;
private Editable editPassword;
private Calendar mCalendar; 
private Calendar mCalendarEnd;
private Button mStartTimeButton;
private Button mEndTimeButton;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.reminder_list);
    StrictMode.ThreadPolicy policy = new     StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);

    mName = (EditText) findViewById(R.id.user_name);
    mSend = (Button) findViewById(R.id.send);
    mStartTimeButton = (Button) findViewById(R.id.main_startTime);
    mEndTimeButton = (Button) findViewById(R.id.main_endTime);

    mDbHelper = new RemindersDbAdapter(this);
    mCalendar = Calendar.getInstance();
    mCalendarEnd = Calendar.getInstance();

    //Code to increase size of buttons

    mDbHelper.open();
    fillData();
    registerForContextMenu(getListView());
    registerButtonListeners();

 }

@Override
protected Dialog onCreateDialog(int id) {
    switch(id) {
        case START_PICKER_DIALOG: 
            return startTimePicker();
        case END_PICKER_DIALOG: 
            return endTimePicker();
    }
    return super.onCreateDialog(id);
}

//Code for Picking start and end time
private TimePickerDialog startTimePicker() {

    TimePickerDialog timePicker = new TimePickerDialog(this, new   TimePickerDialog.OnTimeSetListener() {

        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
            mCalendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
            mCalendar.set(Calendar.MINUTE, minute); 
            updateStartTimeButtonText(); 
        }
    }, mCalendar.get(Calendar.HOUR_OF_DAY), mCalendar.get(Calendar.MINUTE),   true); 

    return timePicker; 
}

 private TimePickerDialog endTimePicker() {

TimePickerDialog timePicker = new TimePickerDialog(this, new TimePickerDialog.OnTimeSetListener() {

        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
            mCalendarEnd.set(Calendar.HOUR_OF_DAY, hourOfDay);
            mCalendarEnd.set(Calendar.MINUTE, minute); 
            updateEndTimeButtonText(); 
        }
    }, mCalendarEnd.get(Calendar.HOUR_OF_DAY), mCalendarEnd.get(Calendar.MINUTE), true); 

return timePicker; 
}

private void registerButtonListeners() 
{
    //Time Listeners
    mStartTimeButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            showDialog(START_PICKER_DIALOG); 
        }
    });

    mEndTimeButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            showDialog(END_PICKER_DIALOG); 
        }
    });

    // add button listener
            mSend.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View arg0) {

                    // get prompts.xml view
                    LayoutInflater li = LayoutInflater.from(context);
                    View promptsView = li.inflate(R.layout.prompts,     null);

                    AlertDialog.Builder alertDialogBuilder = new     AlertDialog.Builder(
                            context);

                    // set prompts.xml to alertdialog builder
                    alertDialogBuilder.setView(promptsView);

                    final EditText userInput = (EditText) promptsView
                                .findViewById(R.id.usernameTextDialogUserInput);

                    final EditText passwordInput = (EditText) promptsView
                            .findViewById(R.id.passwordTextDialogUserInput);

                    // set dialog message
                    alertDialogBuilder
                        .setCancelable(false)
                        .setPositiveButton("OK",
                          new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,int id) {
                            // get user input and set it to result
                            // edit text
                                FileWrite();

                                editName = userInput.getText();
                                editPassword =   passwordInput.getText();

                                inputName = editName.toString();
                                inputPassword = editPassword.toString();

                                Mailing(inputName, inputPassword);
                            }
                          })
                        .setNegativeButton("Cancel",
                          new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,int id) {
                            dialog.cancel();
                            }
                          });

                    // create alert dialog
                    AlertDialog alertDialog = alertDialogBuilder.create();

                    // show it
                    alertDialog.show();

                }
            });

            updateStartTimeButtonText();
            updateEndTimeButtonText();
}

//Code for updating time buttons
private void updateStartTimeButtonText() {
    // Set the time button text based upon the value from the database
    SimpleDateFormat timeFormat = new SimpleDateFormat(TIME_FORMAT); 
    String timeForButton = timeFormat.format(mCalendar.getTime()); 

    mStartTimeButton.setText(timeForButton);
}

private void updateEndTimeButtonText() {
    // Set the time button text based upon the value from the database
    SimpleDateFormat timeFormat = new SimpleDateFormat(TIME_FORMAT); 
    String timeForButton = timeFormat.format(mCalendarEnd.getTime());

    mEndTimeButton.setText(timeForButton);
}

private void fillData() 
{
    Cursor remindersCursor = mDbHelper.fetchAllReminders();
    startManagingCursor(remindersCursor);

    // Create an array to specify the fields we want to display in the list (only   TITLE)
    String[] from = new String[]{RemindersDbAdapter.KEY_TITLE};

    // and an array of the fields we want to bind those fields to (in this case just text1)
    int[] to = new int[]{R.id.text1};

    // Now create a simple cursor adapter and set it to display
    SimpleCursorAdapter reminders = 
            new SimpleCursorAdapter(this, R.layout.reminder_row, remindersCursor, from, to);
    setListAdapter(reminders);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    MenuInflater mi = getMenuInflater();
    mi.inflate(R.menu.list_menu, menu); 
    return true;
}

@Override
public boolean onMenuItemSelected(int featureId, MenuItem item) {
    switch(item.getItemId()) {
    case R.id.menu_insert: 
        createReminder();
        return true; 
    case R.id.menu_settings: 
        Intent i = new Intent(this, TaskPreferences.class); 
        startActivity(i); 
        return true;
    }

    return super.onMenuItemSelected(featureId, item);
}

@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater mi = getMenuInflater(); 
    mi.inflate(R.menu.list_menu_item_longpress, menu); 
}

@Override
public boolean onContextItemSelected(MenuItem item) {
    switch(item.getItemId()) {
        case R.id.menu_delete:
            AdapterContextMenuInfo info = (AdapterContextMenuInfo)   item.getMenuInfo();
            mDbHelper.deleteReminder(info.id);
            fillData();
            return true;
    }
    return super.onContextItemSelected(item);
}

private void createReminder() {
    Intent i = new Intent(this, ReminderEditActivity.class);
    startActivityForResult(i, ACTIVITY_CREATE);
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    Intent i = new Intent(this, ReminderEditActivity.class);
    i.putExtra(RemindersDbAdapter.KEY_ROWID, id);
    startActivityForResult(i, ACTIVITY_EDIT); 
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);
    fillData();
}

  //Prepares the email to be sent
public void Mailing(String inputName, String inputPassword)
{
    Mail m = new Mail(inputName, inputPassword); 

    String[] toArr = {"brittany@schoellersinc.com"}; 
    m.setTo(toArr); 
    m.setFrom(inputName); 
    m.setSubject("Daily Time Card"); 
    m.setBody(""); 

    try { 
      m.addAttachment(Environment.getExternalStorageDirectory().toString() + "/test"); 

      if(m.send()) 
      { 
        Toast.makeText(TaskReminderActivity.this, "Email was sent successfully.", Toast.LENGTH_LONG).show(); 
      }

    } catch(Exception e) { 
      Toast.makeText(TaskReminderActivity.this, "There was a problem sending the email.", Toast.LENGTH_LONG).show();
      Toast.makeText(TaskReminderActivity.this, "Value of User Name is " + inputName, Toast.LENGTH_LONG).show();
      Toast.makeText(TaskReminderActivity.this, "Value of Password is " + inputPassword, Toast.LENGTH_LONG).show();
      Toast.makeText(TaskReminderActivity.this, "Value of Attachment is " +   Environment.getExternalStorageDirectory().toString() + "/test.txt", Toast.LENGTH_LONG).show();
      Log.e("MailApp", "Could not send email", e); 
    } 
}

public void FileWrite()
{
    Cursor remindersCursor = mDbHelper.fetchAllReminders();
    startManagingCursor(remindersCursor);

    try 
    { // catches IOException below
        String[] from = new String[]{RemindersDbAdapter.KEY_TITLE};
        final String TESTSTRING = new String(RemindersDbAdapter.KEY_TITLE + "   ");
        File sdCard = Environment.getExternalStorageDirectory();
        File myFile = new File(sdCard, "test");
        FileWriter writer = new FileWriter(myFile);
        writer.append(showEvents(remindersCursor));
        writer.flush();
        writer.close();

        Toast.makeText(TaskReminderActivity.this, "Program Successfully went through FileWrite!", Toast.LENGTH_LONG).show();
    } catch(Exception e) 
    { 
          Toast.makeText(TaskReminderActivity.this, "Had Problems with file!", Toast.LENGTH_LONG).show();
          Log.e("FileWrite", "Had Problems with file!", e); 
    }
}

private StringBuilder showEvents(Cursor cursor) throws ParseException 
{

    Editable EditName = mName.getText();
    String Name = EditName.toString();
    SimpleDateFormat dateTimeFormat = new SimpleDateFormat(DATE_TIME_FORMAT);
    SimpleDateFormat TimeFormat = new SimpleDateFormat(TIME_FORMAT);
    SimpleDateFormat DateFormat = new SimpleDateFormat(DATE_FORMAT);

    Date startTimer;
    Date endTimer;
    Date timeConverter;
    long totalBillable = 0;
    long hours;
    long minutes;
    String thisBill;
    String dateTimeString;
    String startString;
    String endString;
    boolean Lunch = false;

    StringBuilder ret = new StringBuilder(Name + "'s Time Card:\n\n");

    dateTimeString = DateFormat.format(mCalendar.getTime());
    startString = TimeFormat.format(mCalendar.getTime());
    endString = TimeFormat.format(mCalendarEnd.getTime());

    Toast.makeText(TaskReminderActivity.this, "startString = " + startString, Toast.LENGTH_LONG).show();
    Toast.makeText(TaskReminderActivity.this, "endString = " + endString, Toast.LENGTH_LONG).show();

    ret.append("Today's Date: " + dateTimeString + "\n");
    ret.append("Start Time: " + startString + "\n");
    ret.append("Finish Time: " + endString + "\n\n");

    cursor.moveToPosition(-1);
    //loop for lunch
    while (cursor.moveToNext())
    {

        if(cursor.getString(1).equals("lunch") ||   cursor.getString(1).equals("Lunch") || cursor.getString(1).equals("LUNCH"))
        {
            Lunch = true;
        }
        else
        {
            Lunch = false;
        }

    }

    cursor.moveToPosition(-1);

    //Find the payable hours.
    startTimer = mCalendar.getTime();
    endTimer = mCalendarEnd.getTime();  

    //Condition to see what payable hours is with lunch break
    if(Lunch == false)
    {
        totalBillable += endTimer.getTime() - startTimer.getTime();

        totalBillable = (totalBillable/1000);
        hours = (totalBillable/3600);
        minutes = (totalBillable/60);
        totalBillable = totalBillable - (hours * 3600);
        minutes = totalBillable / 60;
        thisBill = ("Total Payable Hours: " + hours + " hours "  + minutes + " minutes");
        ret.append(thisBill + "\n");
    }
    else
    {
        totalBillable += endTimer.getTime() - startTimer.getTime();

        totalBillable = ((totalBillable-1800000)/1000);
        hours = (totalBillable/3600);
        minutes = (totalBillable/60);
        totalBillable = totalBillable - (hours * 3600);
        minutes = totalBillable / 60;
        thisBill = ("Total Payable Hours: " + hours + " hours "  + minutes + " minutes");
        ret.append(thisBill + "\n");
    }

    cursor.moveToPosition(-1);

    //Loop for calculating total billable
    while (cursor.moveToNext()) 
    {   
        if(cursor.getString(1).equals("lunch") ||    cursor.getString(1).equals("Lunch") || cursor.getString(1).equals("LUNCH") || cursor.getString(1).equals("shop") || cursor.getString(1).equals("SHOP") || cursor.getString(1).equals("Shop"))
        {

        }
        else
        {
            try
            {
                String dateString = cursor.getString(6); 
                startTimer = TimeFormat.parse(dateString); 

                //Code for End Time
                String endDateString = cursor.getString(7); 
                endTimer = TimeFormat.parse(endDateString);

                totalBillable += endTimer.getTime() - startTimer.getTime();           

            }catch (ParseException e) {
                Log.e("ReminderEditActivity", e.getMessage(), e);
            }   
        }

    }

    totalBillable = (totalBillable/1000);
    hours = (totalBillable/3600);
    minutes = (totalBillable/60);
    totalBillable = totalBillable - (hours * 3600);
    minutes = totalBillable / 60;
    thisBill = ("Total Billable Hours: " + hours + " hours "  + minutes + " minutes");
    ret.append(thisBill + "\n\n");

    //Enters the main entries into the file
    cursor.moveToPosition(-1);
    ret.append("Customer Name   " + "Customer Number    " + "Job Number " +     "Preparation Time   " + "Travel Time    " + "Start Time " + "End Time   " + "Billed Time    " + "Job Completed  \n");
    while (cursor.moveToNext()) 
    {

      String title = cursor.getString(1);
      String customer = cursor.getString(2);
      String job = cursor.getString(3);
      String prepare = cursor.getString(4);
      String travel = cursor.getString(5);
      String dateTime = cursor.getString(6);
      String endTime = cursor.getString(7);
      String billed = cursor.getString(8);
      String completed = cursor.getString(9);

      //Loop to make file more readable
      if(completed.equals("1"))
      {
          completed = "Yes";
      }
      else
      {
          completed = "No";
      }

      ret.append(title + "  " + customer + "    " + job + " " + prepare + " " +       travel + "    " + dateTime + "    " + endTime + " " + billed + "  " + completed + "       " + "\n");
    }
    return ret;
  }
 }` 
```

日志：

```
08-15 15:41:37.070: E/ReminderEditActivity(582): Unparseable date: "2012-07-02 14:17:25" (at offset 4)
08-15 15:41:37.070: E/ReminderEditActivity(582): java.text.ParseException: Unparseable date: "2012-07-02 14:17:25" (at offset 4)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at java.text.DateFormat.parse(DateFormat.java:626)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.dummies.android.TaskReminder.TaskReminderActivity.showEvents(TaskReminderActivity.java:464)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.dummies.android.TaskReminder.TaskReminderActivity.FileWrite(TaskReminderActivity.java:354)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.dummies.android.TaskReminder.TaskReminderActivity$5$1.onClick(TaskReminderActivity.java:186)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:166)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at android.os.Looper.loop(Looper.java:137)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at android.app.ActivityThread.main(ActivityThread.java:4424)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at java.lang.reflect.Method.invokeNative(Native Method)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at java.lang.reflect.Method.invoke(Method.java:511)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-15 15:41:37.070: E/ReminderEditActivity(582):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:18:08.690

看看这段代码...

```
try
{
    String dateString = cursor.getString(6); 
    startTimer = TimeFormat.parse(dateString); 

    //Code for End Time
    String endDateString = cursor.getString(7); 
    endTimer = TimeFormat.parse(endDateString);

    totalBillable += endTimer.getTime() - startTimer.getTime();           

}catch (ParseException e) {
    Log.e("ReminderEditActivity", e.getMessage(), e);
} 
```

很难确定，因为您的问题中有很多帖子，但是您的意思是`dateTimeFormat`不是`TimeFormat`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T18:05:32.863

转储“只有 519 行代码”，甚至不费心指出**哪一行代码是引发异常的代码行**，这无助于我们回答您的问题。

此外，Java 命名约定不使用前导大写字母命名数据成员和局部变量。`TimeFormat`看起来像是一个类名，让我们这种人很难理解“只有519行代码”。

话虽这么说，`TimeFormat`基于`kk:mm`，并且您的数据 ( `2012-07-02 14:17:25`) 不是该格式。要么您不应该使用`TimeFormat`，要么您的数据库中的数据有误。

# sql-server-2008 - 如何在没有 Management Studio 的情况下更改 SQL Server 授权模式

> ID：11972876
> 
> 赞同：8
> 
> 时间：2012-08-15T16:05:14.493
> 
> 标签：sql-server-2008, sql-server-2012

有没有办法在不使用 SQL Server Management Studio 的情况下更改 SQL Server 2008 或 2012 中的授权模式？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-15T16:24:09.703

以下是 Management Studio 将身份验证模式从混合更改为仅 Windows 所做的操作：

```
EXEC xp_instance_regwrite 
    N'HKEY_LOCAL_MACHINE', 
    N'Software\Microsoft\MSSQLServer\MSSQLServer', 
    N'LoginMode', 
    REG_DWORD, 
    1; 
```

而从 Windows 只回到混合：

```
EXEC xp_instance_regwrite 
    N'HKEY_LOCAL_MACHINE', 
    N'Software\Microsoft\MSSQLServer\MSSQLServer', 
    N'LoginMode', 
    REG_DWORD, 
    2; -- only difference is right here 
```

您可以从可以连接到 SQL Server 的各种源（例如 SQLCMD、PowerShell、VBScript、C# 等）调用相同的命令。或者您可以直接登录到服务器，导航到该注册表项，然后手动更改值（如 @ marc_s 建议）。

请注意，在所有情况下，您都必须重新启动 SQL Server 才能使更改生效。您可以在重新启动时查看新错误日志中的前几个条目，以验证身份验证模式是否正确。它会说（混合）：

```
date/time    Server    Authentication Mode is MIXED. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-19T16:52:06.663

I found out that if you installed your SQL express 32bit (in my case) on 64bit Windows, the reg path has to be HKEY_LOCAL_MACHINE\ `SOFTWARE\Wow6432Node\Microsoft\MSSQLServer\MSSQLServer`. the change here is the `Wow6432Node` key.

# jquery - 使用 jQuery 工具指定动态工具提示

> ID：11972880
> 
> 赞同：1
> 
> 时间：2012-08-15T16:05:32.130
> 
> 标签：jquery, jquery-tools, tooltip

我正在尝试使用 jQuery Tools 动态设置一些工具提示，但我遇到了很大的麻烦。

默认情况下，当您使用 jQuery 工具以最基本的形式设置工具提示时，它会将工具提示触发后的下一个元素作为实际的工具提示。

```
$("#someElement").tooltip(); 
```

在我正在处理的当前应用程序中，我有一个链接，我需要加载一个不是下一个元素的工具提示。

使用 jQuery 工具，您可以通过以下方式执行此操作：

```
$("#someElement").tooltip({tip: '#tooltipElement'}); 
```

这很好，但我需要能够动态设置小费，我似乎无法做到这一点。

在应用程序上，我的链接设置如下所示：

```
<a href="Javascript:void(0);" class="tooltip-preview" data-tooltip-id="#tooltip-1">Quick Preview</a>
<a href="Javascript:void(0);" class="tooltip-preview" data-tooltip-id="#tooltip-2">Quick Preview</a>
<a href="Javascript:void(0);" class="tooltip-preview" data-tooltip-id="#tooltip-3">Quick Preview</a>... 
```

然后工具提示位于页面底部，如下所示：

```
<div id="tooltip-1">Some random content here!</div>
<div id="tooltip-1">Some random content here!</div>
<div id="tooltip-1">Some random content here!</div>... 
```

所以我后来尝试做的是：

```
$(".tooltip-preview").tooltip({tip: $(this).attr("data-tooltip-id")}); 
```

我觉得这不起作用，因为 $(this) 没有用作 $(".tooltip-preview") 对象。如果是这种情况，我该如何让它工作？

相反，每个链接上的下一个元素被用作工具提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T18:40:20.397

这对我有用：

```
$(".tooltip-preview").each(function(){
    $(this).tooltip({tip: $(this).attr("data-tooltip-id")});            
}); 
```

这个答案假设在这个块中：

```
<div id="tooltip-1">Some random content here!</div>
<div id="tooltip-1">Some random content here!</div>
<div id="tooltip-1">Some random content here!</div>... 
```

您的意思是（增加 id 值是这里的关键点。请注意，我还区分了随机内容）：

```
<div id="tooltip-1">Some random content here! (1)</div>
<div id="tooltip-2">Some random content here! (2)</div>
<div id="tooltip-3">Some random content here! (3)</div>... 
```

我能够复制问题，起初我尝试过：

```
$(".tooltip-preview").tooltip({tip: $(".tooltip-preview").attr("data-tooltip-id")}); 
```

这让你更接近，但它使所有三个工具提示“这里有一些随机内容！(1)”，因为该选择器只找到具有属性“data-tooltip-id”的第一个元素。

所以你必须遍历上面指出的元素。

# javascript - 为什么不（如何）document.getElementsByClassName("*")？

> ID：11972882
> 
> 赞同：-2
> 
> 时间：2012-08-15T16:05:50.257
> 
> 标签：javascript, dom

我们可以得到所有的dom

```
document.getElementsByTagName("*") 
```

为什么我们不能使用

```
document.getElementsByClassName("*") 
```

获取具有`class`属性集的所有标签？

同样使用

```
document.getElementById("*") 
```

获取带有`id`属性集的标签？

虽然这些功能不是很有必要，也可能没有需求，但我希望有人告诉我如何实现。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T16:08:47.033

答案是因为`getElementsByClassName()`并且`getElementById()`不使用通配符。它们没有指定或编写来执行此操作，因此您不能那样使用它们。

此外`getElementById()`，它只返回一个 DOM 元素，而不是一个元素数组，因此它永远不会那样工作。

如果你想获取所有具有类名的元素或所有具有 id 的元素，你可以这样做：

```
function getAllElementsWithAttribute(attr) {
    var results = [];
    var all = document.getElementsByTagName("*");
    for (var i = 0, len = all.length; i < len; i++) {
        if (all[i][attr]) {
            results.push(all[i]);
        }
    }
    return(results);
} 
```

然后，您可以使用以下方法获取所有具有类名的元素：

```
var items = getAllElementsWithAttribute("className"); 
```

或者，使用以下命令获取所有具有 ID 的元素：

```
var items = getAllElementsWithAttribute("id"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:13:18.757

正如@jfriend00 在[之前的答案](https://stackoverflow.com/a/11972919/476786)中所建议的那样，该功能在浏览器的 javascript 实现中本机不存在。同样，答案还包含一种使用纯 JavaScript 的方法。

或者，您必须使用框架而不是位于 javascript 之上并为您提供更好的选择器。

因此，考虑到这样一个框架[jQuery](http://jquery.com)，您可以：

选择所有带有 a 的元素`class`：

```
$('[class]') 
```

选择所有带有 的元素`id`：

```
$('[id]') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:13:46.153

`getElementsByClassName()`并非在所有浏览器上都实现，尤其是 Internet Explorer。但是，您可以使用各种 javascript 库，例如[jQuery](http://jquery.com/)，以跨浏览器的方式实现此功能。没有一个默认函数使用通配符`*`来获取所有值。尽管您可以再次使用 jquery 来执行此操作`$('[id]')`，如此 SO 帖子中所示：[jquery get only all html elements with ids](https://stackoverflow.com/questions/1163888/jquery-get-only-all-html-elements-with-ids)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-15T16:10:26.143

这是 getElementByClass 的快速链接 - [http://www.actiononline.biz/web/code/how-to-getelementsbyclass-in-javascript-the-code/](http://www.actiononline.biz/web/code/how-to-getelementsbyclass-in-javascript-the-code/) - 您可以修改代码以返回所有非空白元素通过将 if 语句修改为

```
if (allHTMLTags[i].className!="") { 
```

要获取所有具有 id 的元素，只需获取所有元素并丢弃那些没有 id 的元素。

# php - preg_replace 使用包含相似关键字的数组

> ID：11972884
> 
> 赞同：0
> 
> 时间：2012-08-15T16:05:56.110
> 
> 标签：php, preg-replace

我有两个数组，一个包含关键字，一个包含 URL。我编写的代码是将关键字链接到 URL。除非我添加包含关键字的关键字（我希望它有意义），否则它工作正常。

例如，如果我同时添加关键字`happy`和关键字`happy man`，并且我有这个字符串：`He is happy, he is a happy man.`，则链接结果将是：`He is <b>happy</b>, he is a <b>happy</b> man.`

我正在寻找的结果是`He is <b>happy</b>, he is a <b>happy man</b>.`我希望 preg_replace 相应地替换`happy`两者`happy man`。

我的问题是，有没有办法做到这一点？

这是我目前使用的正则表达式：`/\b keyword \b/i`

# asp.net - 构建成功后如何自动发布 web api web 服务？

> ID：11972887
> 
> 赞同：2
> 
> 时间：2012-08-15T16:06:07.727
> 
> 标签：asp.net, asp.net-web-api

我正在使用 ASP.NET MVC Web API (VS 2010) 创建没有关联网页的 REST-ful Web 服务。它们是同时运行的一套工具（包括 Windows 服务、胖客户端，可能还有一些网页）的一部分。因此，在调试期间，我想在每次构建后自动将 Web 服务发布到我的本地 IIS，以便它始终可用。

“发布...”上下文菜单执行此操作，但我希望它作为构建后事件（或其他内容）自动完成。为了这个简单的目的，我不想让解决方案与其他 Web 部署项目混为一谈。我也不想将虚拟目录映射到我的构建树，因为在使用不同的分支时这是有问题的。

提前致谢！

# php - 使用 FlexSlider JS 的多个 Vimeo 视频

> ID：11972890
> 
> 赞同：2
> 
> 时间：2012-08-15T16:06:45.493
> 
> 标签：php, javascript, vimeo, flexslider, froogaloop

我希望有人能帮帮忙。我已经搜索并搜索了一个解决方案，并且我已经使用了 Javascript，但它超出了我的范围。我希望其他人能理解这一点。

[FlexSlider](http://www.woothemes.com/flexslider/)作为轮播做得很好，但如果你想要多个视频，我无法让他们停止 FlexSlider 动画，或者如果用户触发下一个轮播幻灯片，则无法自动停止播放。

很容易做到这一点。以下 Javascript 显示了这是如何完成的。但正如您所见，它依赖于具有 ID 的元素。问题是我的视频数量未知。有时可能有一个。有时可能有 20 个。

如果有任何方法可以修改下面的代码以便它可以处理任意数量的视频？

```
var player = document.getElementById('player_1');

$f(player).addEvent('ready', ready);

function addEvent(element, eventName, callback) {
    if (element.addEventListener) {
        element.addEventListener(eventName, callback, false)
    } else {
        element.attachEvent(eventName, callback, false);
    }
}

function ready(player_id) {
    var froogaloop = $f(player_id);
    froogaloop.addEvent('play', function(data) {
        $('.flexslider').flexslider("pause");
    });
    froogaloop.addEvent('pause', function(data) {
        $('.flexslider').flexslider("play");
    });
}    

$(".flexslider").flexslider({
    animation: "slide",
    animationSpeed: Modernizr.touch ? 600 : 1000,
    slideshowSpeed: 3500,
    controlsContainer: "#carousel",
    useCSS: false,
    start: function(){
        $(".flex-control-nav").css("margin-left", "-" + $(".flex-control-nav").width()/2 + "px");
    },
    before: function(slider){
        $f(player).api('pause');
    }
}); 
```

PHP/HTML 看起来像这样：

```
<div class="flexslider">
    <ul class="slides">
    <?php  for($i=0;$i<$slideCount;$i++) { ?>
        <li>
            <?php if($slides[$i]["type"] == "1") { ?>
                <div class="video">
                    <iframe id="player_1" width="1000" height="500" frameborder="0" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen src="http://player.vimeo.com/video/<?php echo $slides[$i]["URL"]; ?>?api=1&player_id=player_1"></iframe>
                </div>
            <?php } else { ?>
                <a href="explore.php?item=<?php echo $slides[$i]["slideID"]; ?>">
                <img src="static/images/slides/<?php echo $slides[$i]["slideID"]; ?>/<?php echo $slides[$i]["URL"]; ?>" alt="<?php echo htmlspecialchars($slides[$i]["headline"], ENT_QUOTES, "UTF-8"); ?>" width="868" height="488"  /></a>
            <?php } ?>
<       /li>
    </ul>
</div> 
```

**可能的解决方案：**`$f(player)`运行 FOR 循环并计算视频的数量，然后在 Javascript 中创建多个不同的实例。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:57:32.937

我知道你说你已经继续前进了，但是当我转到下一张幻灯片时，我很难让所有视频能够自动暂停，并且从 Juanfra Aldasoro ( [http://juanfra.me/ ) 看到了这段代码2012/08/flexslider-multiple-videos-v2/](http://juanfra.me/2012/08/flexslider-multiple-videos-v2/)）为每个视频创建必要的 jQuery，那么我相信剩下要做的就是计算和命名 iframe id。这是他的代码：

```
jQuery(window).load(function() { 
    var vimeoPlayers = jQuery('.flexslider').find('iframe'), player;        

    for (var i = 0, length = vimeoPlayers.length; i < length; i++) {            
            player = vimeoPlayers[i];           
            $f(player).addEvent('ready', ready);        
    }       

    function addEvent(element, eventName, callback) {           
        if (element.addEventListener) {                 
            element.addEventListener(eventName, callback, false)            
        } else {                
            element.attachEvent(eventName, callback, false);            
        }       
    }       

    function ready(player_id) {             
        var froogaloop = $f(player_id);             
        froogaloop.addEvent('play', function(data) {                
            jQuery('.flexslider').flexslider("pause");          
        });             
        froogaloop.addEvent('pause', function(data) {               
            jQuery('.flexslider').flexslider("play");           
        });         
    }  

    jQuery(".flexslider")     
    .flexslider({       
        animation: "slide",
        useCSS: false,       
        animationLoop: false,       
        smoothHeight: true,       
        before: function(slider){         
            if (slider.slides.eq(slider.currentSlide).find('iframe').length !== 0)
                  $f( slider.slides.eq(slider.currentSlide).find('iframe').attr('id') ).api('pause');       
        }   
    });

}); 
```

希望这有助于有人登陆这里:)

# security - 阻止直接访问 Struts2 中的 *.jsp 和 *.action

> ID：11972892
> 
> 赞同：2
> 
> 时间：2012-08-15T16:06:47.093
> 
> 标签：security, jsp, struts2

我在 Tomcat 中使用 Struts2+Spring+Hibernate。

我遇到了用户能够直接输入 .jsp 或 .action url 的问题。他们需要访问的所有内容都可以从主页访问，所以我想阻止这种访问。

我一直在寻找答案，并且发现了一些东西，尤其是与 .jsp 阻塞有关的东西。我已经添加

```
<security-constraint>
<web-resource-collection>
<web-resource-name>Deny Direct Access</web-resource-name>
<description></description>
<url-pattern>*.jsp</url-pattern>
</web-resource-collection>
<auth-constraint>
<role-name>Denied</role-name>
</auth-constraint>
</security-constraint>
<security-role>
<role-name>Denied</role-name>
</security-role> 
```

到我的 web.xml ，但这似乎没有任何作用。然后我变了

```
<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>*</url-pattern>
</filter-mapping> 
```

到

```
<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>*.action</url-pattern>
    <url-pattern>*.html</url-pattern>
    <url-pattern>/index.jsp</url-pattern>
</filter-mapping> 
```

这会阻止一些 .jsp 文件，但不会阻止其他文件。我确定不放

```
<url-pattern>*.jsp</url-pattern> 
```

在我的任何安全角色中。

我听说我可以将所有 jsps 放在 /Web-inf 中，但这似乎很麻烦，因为我必须在我引用它们的每个应用程序实例中更改路径。

我也找不到任何涉及阻止直接访问 .action 类的内容。如果有人可以指点我找到此信息，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T16:12:30.980

如果您将 JSP 放在 /WEB-INF 目录下，那么它们将无法直接访问。

至于 .actions，那你就不走运了——你无法阻止某人直接访问网页的 URL（这就是 .action 的最终含义）。

为什么要阻止人们直接访问 URL？能够直接链接到事物是网络的一个非常基本的部分。

**更新**

由于您正在寻找一种控制访问的方法，因此您可以创建一个接口，然后创建一个拦截器。在拦截器中，检查当前动作是否实现了接口，如果是，则调用接口上的方法。

这是一个例子：

```
public interface SecurableAction {
  void checkSecurity();
}

public class SecurityInterceptor extends AbstractInterceptor {
  @Override
  public String intercept(ActionInvocation invocation) throws Exception {
    Object action = invocation.getAction();
    if (action instanceof SecurableAction) {
        ((SecurableAction) action).checkSecurity();
    }

    return invocation.invoke();
  }
} 
```

最后，在您的操作`checkSecurity()`方法中，检查当前用户是否有权调用该操作。如果用户无权访问，则抛出某种异常（我通常创建一个被调用的异常，`AccessViolation`然后将其映射到自定义错误页面）。

```
public class YourAction implements SecurableAction {
  @Override
  public void checkSecurity() {
    if (!currentUser.hasPermission("MANAGE_OTHER_USERS")) {
      throw new AccessViolation();
    }
  }
} 
```

请记住将此新拦截器添加到您的堆栈中。

作为所有这些的替代方案，您也可以使用`Preparable`接口来提供所有这些，但我发现有一个单独的方法来封装安全检查会更好。

# sharepoint-2010 - 信息路径形式的编程

> ID：11972893
> 
> 赞同：1
> 
> 时间：2012-08-15T16:06:48.037
> 
> 标签：sharepoint-2010, infopath2010

我在共享点列表上发布了一个功能齐全的 Infopath 表单。现在我打算通过在 vb 中编程在表单中包含一些功能。但是，当我单击“自定义”表单时，我在信息路径设计器中看不到“开发人员”选项卡。是不是因为它在列表中。如果是，我如何将其迁移到图书馆。我可以重新创建表单，但我不知道究竟需要做什么才能将代码添加到 infopath 表单。我希望包括简单的功能，例如当用户在表单上进行选择时从列表值中预填充表单字段。

# qt - 如何在 Qt Creator 中指定文件特定的定义

> ID：11972915
> 
> 赞同：2
> 
> 时间：2012-08-15T16:08:35.273
> 
> 标签：qt, g++, qt-creator

在我当前的项目中，有一种情况是在编译大多数文件时需要定义 UNICODE，但必须特别不定义它才能编译项目中的两个文件。可能很难将这两个文件完全放在不同的文件夹中。有没有在我的 .pro 文件中指定这样的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:53:42.020

QMake 并不真正支持这一点。

我能想到的唯一解决方案：在同一目录中创建第二个 .pro 文件（其中没有 DEFINES），在其中将这些特殊文件链接到静态库中，然后在主 .pro 文件中链接该静态库（其中有定义）。像这样创建一个顶级 .pro 文件：

```
TEMPLATE = subdirs     
SUBDIRS += staticlib.pro main.pro
CONFIG += ordered 
```

# c# - 更改我的对象列表上的顺序

> ID：11972916
> 
> 赞同：2
> 
> 时间：2012-08-15T16:08:36.773
> 
> 标签：c#, linq, entity-framework

我有一个对象列表如下：

```
ID   Name       PageOrder
1    Home       1
2    Product    2
3    Link       3
4    Help       4 
```

期望：

```
ID    Name      PageOrder
1     Home      1
3     Link      2
2     Product   3
4     Help      4 
```

我在 C# 中对此进行编码，如下所示。但我不认为我这样做的方式不是最佳实践。请指教。

```
public void OrderUp(int favouriteId)
    {
        UsFavourite currentFav = db.UsFavourites.FirstOrDefault(m => m.FavouriteID == favouriteId);

        // Get favourite by current favourite's order - 1
        UsFavourite tempFav = db.UsFavourites.FirstOrDefault(m => m.FavouriteOrder == (currentFav.FavouriteOrder - 1));

        if (tempFav != null)
        {
            //update tempFav
            tempFav.FavouriteOrder = currentFav.FavouriteOrder;
            Save();

            //update currentFav
            currentFav.FavouriteOrder = currentFav.FavouriteOrder - 1;
            Save();
        }

    }

    public void OrderDown(int favouriteId)
    {
        UsFavourite currentFav = db.UsFavourites.FirstOrDefault(m => m.FavouriteID == favouriteId);

        // Get favourite by current favourite's order + 1
        UsFavourite tempFav = db.UsFavourites.FirstOrDefault(m => m.FavouriteOrder == (currentFav.FavouriteOrder + 1));

        if (tempFav != null)
        {
            //update tempFav
            tempFav.FavouriteOrder = currentFav.FavouriteOrder;
            Save();

            //update currentFav
            currentFav.FavouriteOrder = currentFav.FavouriteOrder + 1;
            Save();
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:21:26.817

代码看起来不错。正如保罗所说，您不应该使用 save 两次。我也很想用以下内容删除一些重复

```
 public void OrderUp(int favouriteId)
    {
        ChangeOrder(false, favouriteId);

    }

    public void OrderDown(int favouriteId)
    {
        ChangeOrder(true, favouriteId);
    }
    private void ChangeOrder(bool OrderDown, int favouriteId)
    {           
        UsFavourite currentFav = db.UsFavourites.FirstOrDefault(m => m.FavouriteID == favouriteId);

        // Get favourite by current favourite's order + 1
        UsFavourite tempFav;
        if (OrderDown)
        {
            tempFav = db.UsFavourites.OrderBy(m => m.FavouriteOrder).FirstOrDefault(m => m.FavouriteOrder > (currentFav.FavouriteOrder));
        }
        else
        {
            tempFav = db.UsFavourites.OrderByDescending(m => m.FavouriteOrder).FirstOrDefault(m => m.FavouriteOrder < (currentFav.FavouriteOrder));

        }
        if (tempFav != null)
        {
            //update tempFav
            tempFav.FavouriteOrder = currentFav.FavouriteOrder;

            //update currentFav
            currentFav.FavouriteOrder = currentFav.FavouriteOrder + change;
            Save();
        }
    } 
```

# javascript - 如何使用 XML 数据检查文本字段中的重复值（用于唯一 url）

> ID：11972917
> 
> 赞同：0
> 
> 时间：2012-08-15T16:08:37.890
> 
> 标签：javascript, xml, ajax, xml-parsing, duplicates

假设我有这个**alias-url.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<aliases>
 <alias>the-plaza-1</alias>
 <alias>the-subway</alias>
 <alias>metro-mall-1</alias>
 <alias>metro-mall-2</alias>
</aliases> 
```

我有以下文本字段输入表单

```
<input name="place_name" id="place" type="text"/>
<input name="url_alias" id="alias" type="text"/> 
```

所以，真正的交易： - 当我在**input#place**上键入一个地方时，例如：“ **The Subway** ”，它将通过以下脚本在**input#alias上同步返回“** **the-subway** ” ：

 **```
$("#place").keyup(function () {
 var value = $(this).val();
 $("#alias").val(value.replace(/\W+/g, '-').toLowerCase());
    }).keyup(); 
```

所以它会形成一个友好的url模式。

**我的问题是：**如何在我的 xml 文件中检查 input#alias 是否重复，所以当我输入例如：“ **The Subway** ”时，它将返回“ **the-subway-1** ”，因此“ **The Plaza** ”变成**“the-plaza- 2”**和“ **Metro Mall** ”成为“ **Metro-Mall-3** ”。**

# php - RegEx - 获取未包装元素的数量

> ID：11972918
> 
> 赞同：2
> 
> 时间：2012-08-15T16:08:41.077
> 
> 标签：php, regex

例如我有一个这样的字符串：

```
first:second:third"test:test":fourth 
```

我想计算 ':' 并稍后拆分每个 ':' 以获取字符串。

这是我的正则表达式：

```
/(.*):(.*)/iU 
```

我不知道这是否是最好的解决方案，但它确实有效。'.' 之间有区别。和 "[...] : [...]" 所以我需要将它们分开。我意识到我的正则表达式计算 : 但当 : 介于“.

我试图用这个正则表达式解决这个问题：

```
/(((.*)[^"]):((.*)[^"]))/iU 
```

我认为这是正确的方法，但事实并非如此。我试图学习正则表达式语法，但我不明白这个问题。

这个正则表达式只是意味着：搜索'：' - 每个想法都可以是infornt并且在它之后，除了“在它前面并且”在它之后。

也许你可以帮助我。

编辑：我在 PHP 中使用我的正则表达式 - 也许这是一个重要信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:13:45.770

怎么用

```
$result = preg_split(
    '/:       # Match a colon
    (?=       # only if followed by
     (?:      # the following group:
      [^"]*"  #  Any number of characters except ", followed by one "
      [^"]*"  #  twice in a row (to ensure even number of "s)
     )*       # (repeated zero or more times)
     [^"]*    # followed by any number of non-quotes until...
     $        # the end of the string.
    )         # End of lookahead assertion
    /x', 
    $subject); 
```

这会给你结果

```
first
second
third"test:test"
fourth 
```

直接地？

`:`此正则表达式仅在其后跟偶数个引号时才拆分。这意味着它不会在`:`字符串内部拆分：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T19:27:29.530

这个正则表达式应该可以做到，如果它符合您的需求并且您需要额外的解释，请询问:)

```
(?<=:|^)(?<!"[^:][^"]+:)\w+?(?=:|"|$) 
```

那是我使用的测试字符串

> "test1:test2:test3":first:second:third"test1:test2:test3":fourth:fifth"test1:test2:test3":sixth

这些是以下6场比赛：

```
first
second
third
fourth
fifth
sixth 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:22:12.097

我喜欢解析文本。所以我为你写了一个解析器。

```
$sample = 'first:second:third"test:test":fourth';
$len = strlen($sample);
$c =0;
$buffer="";
$output = array();
$instr = false;
for($i =0; $i< $len; $i++){
    if($sample[$i]=='"' or $sample[$i]=="'"){
        $c++;
        $instr= $c%2==0 ? false: true;
        $buffer.=$sample[$i];
    }elseif(!$instr and $sample[$i]==':'){
        $output[]=$buffer;
        $buffer = "";
    }else{
        $buffer.=$sample[$i];
    }
}
if($buffer) $output[] = $buffer;

print_r($output); 
```

请参阅实际[代码](http://codepad.viper-7.com/sAIXYm)。另请注意，对于巨大的字符串正则表达式将表现不佳。

# ruby-on-rails - rake 在 Rails 中中止，因为它说缺少主动支持

> ID：11972920
> 
> 赞同：0
> 
> 时间：2012-08-15T16:08:47.083
> 
> 标签：ruby-on-rails, rake

嗨，我试图在一台机器上运行 rails 服务器，它说没有这样的文件可以加载错误

所以我尝试运行 rake，发现 rake 中止了没有要加载的文件——下面的主动支持是错误

```
rake aborted!
no such file to load -- active_support

(See full trace by running task with --trace) 
```

请帮忙

这就是我尝试开始一个新的 Rails 项目时所说的

```
[username]$ rails new blog
LoadError: no such file to load -- active_support/core_ext/object/inclusion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:27:10.323

你用的是rvm吗？你确定安装rails了吗？

`gem install rails`

`bundle install`

`rails new blog`

# android - Android clipPath 等效于硬件加速视图

> ID：11972926
> 
> 赞同：16
> 
> 时间：2012-08-15T16:09:21.000
> 
> 标签：android

我的应用程序中唯一仍然是软件渲染的部分是渲染一个需要绘制圆形位图的视图。我正在使用 clipPath 将需要渲染为圆形的位图剪辑。

我知道 clipPath 不是硬件加速的，但我正在寻找一种算法，允许我使用硬件加速提供等效功能。

具体来说，我需要创建源位图的圆形剪切区域并将其渲染到我的画布上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-10T08:11:53.390

如果您必须使用 clipPath，您可以关闭硬件加速，如下所示。

```
<application
    android:label="@string/application_name"
    android:hardwareAccelerated="false"> 
```

您还可以控制应用程序、活动、窗口和视图层之间的硬件加速。详细信息[在 Android 开发网站上的这篇硬件加速文章中](http://developer.android.com/guide/topics/graphics/hardware-accel.html#controlling)描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-11T12:05:12.103

如果您的位图没有太大变化，请将其剪裁一次到形状成一个新的位图，然后在您的 onDraw 中绘制剪裁的位图。

这是一个如何从源位图中剪切圆的示例

```
Bitmap bitmap = Bitmap.createBitmap(source.getWidth(), source.getHeight(), Bitmap.Config.ARGB_8888);
Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);
Canvas canvas = new Canvas(bitmap);
paint.setColor(Color.RED);
// Draw your shape here
canvas.drawCircle(cx, cy, radius, paint);
paint.setXfermode(new PorterDuffXfermode(Mode.SRC_IN));    
canvas.drawBitmap(sourceBitmap, 0, 0, paint); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-11T11:50:55.957

你可以试试这个，虽然我不确定它是硬件加速的：

在 onCreate ：

*   创建使用 setXfermode 的绘画（称为 bitmapPaint）：http: [//developer.android.com/reference/android/graphics/Paint.html#setXfermode(android.graphics.Xfermode)](http://developer.android.com/reference/android/graphics/Paint.html#setXfermode(android.graphics.Xfermode))
*   放一个[AvoidXfermode](http://developer.android.com/reference/android/graphics/AvoidXfermode.html)，它也被弃用了，它工作得很好。将其传递给具有高容差的白色和目标模式（如 240）

在 onLayout ：

*   创建与视图大小相同的位图
*   在画布上用白色画出你的圆圈，使用反别名作为干净的边框

在 onDraw ：

*   在你的画布上用白色圆圈绘制位图
*   现在，使用您在 onCreate 中创建的 bitmapPaint 在您的画布中绘制您的位图

位图应仅在圆圈内呈现。

# actionscript-3 - AS3 - 正确引用 MovieClip

> ID：11972929
> 
> 赞同：0
> 
> 时间：2012-08-15T16:09:25.947
> 
> 标签：actionscript-3, scope, movieclip

所以，我有这个 Player.as 类文件，代码如下：

```
private function PressAKey(event:KeyboardEvent):void
 {
   getDistance();
   if(event.keyCode == 32 && placedBomb == false && bombNumber == 0)//space
 {
   xKey = true;
   placeBomb();
   placedBomb = true;
}
} 
```

将其与以下 placeBomb() 函数结合使用：

```
private function placeBomb():void{

 MainClass.container.addChildAt(bomb,0);
 bomb.x = this.x;
 bomb.y = this.y+20;
 bombNumber ++;
} 
```

问题来自这个函数，它试图计算玩家和炸弹之间的距离，以便我可以开始建立交互：

```
private function getDistance():void{
 distance = Math.sqrt( ( this.x - MainClass.container.bomb.x ) * ( this.x - MainClass.container.bomb.x ) + ( this.y - MainClass.container.bomb.y ) * ( this.y - MainClass.container.bomb.y ) );
 trace(distance);
} 
```

尝试此操作时出现此错误：

```
TypeError: Error #1010: A term is undefined and has no properties.
at Player/getDistance()
at Player/PressAKey() 
```

你知道我错过了什么吗？这绝对是一个范围界定问题，那么我需要包括什么才能让整个班级都识别炸弹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:23:29.933

`bomb`不是 的财产`MainClass.container`。`bomb`是独生子。

参考以下代码。

```
private function getDistance():void
{
   var bomb:DisplayObject = MainClass.container.getChildAt(0);

   distance = Math.sqrt( ( this.x - bomb.x ) * ( this.x - bomb.x ) + ( this.y - bomb.y ) * ( this.y - bomb.y ) );
   trace(distance);
} 
```

## 如何引用所有的孩子。

```
for(var i:int = 0; i<parentObject.numChildren; i++)
{ 
   var object:DisplayObject = parentObject.getChildAt(i);
   /*
   p.s: if a child object type is MovieClip. must be typecasting.
   var object:MovieClip = parentObject.getChildAt(i) as MovieClip;
   */
} 
```

# iphone - 创建 EGOTextView 后更改框架高度

> ID：11972931
> 
> 赞同：0
> 
> 时间：2012-08-15T16:09:35.633
> 
> 标签：iphone, richtextbox

我正在尝试在 iphone dev 中使用 EGOTextView，我想在创建 EGOTextView 后通过代码更改高度，我尝试了 setFrame 或 frame = newframe，两者都不起作用，您能否提供一些建议。

最好的，

松香

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:25:34.243

如果你想改变整个框架的`EGOTextView`（位置和大小），那么使用：

```
EGOTextView.frame = CGRectMake(new x, new y, new width, new height); 
```

如果您只想更改大小，请使用：

```
EGOTextView.size = CGSizeMake(new width, new height); 
```

上面的每个“新”对象都应该是一个数字（例如`CGSizeMake(320, 480)`）。

# hadoop - 蜂巢 ngram 停用词列表？

> ID：11972932
> 
> 赞同：3
> 
> 时间：2012-08-15T16:09:38.560
> 
> 标签：hadoop, hive, n-gram

虽然被列为[示例用例](https://cwiki.apache.org/Hive/statisticsanddatamining.html)之一......我还没有找到从 Hive n-gram 中过滤掉垃圾词（and、or 等）的示例。

```
SELECT explode(context_ngrams(sentences(lower(description)), array("criminal", null), 10)) AS x FROM mapped_discussions;

{"ngram":["justice"],"estfrequency":274.0}
{"ngram":["behavior"],"estfrequency":121.0}
{"ngram":["law"],"estfrequency":92.0}
{"ngram":["activity"],"estfrequency":69.0}
{"ngram":["acts"],"estfrequency":41.0}
{"ngram":["procedure"],"estfrequency":35.0}
{"ngram":["and"],"estfrequency":29.0}
{"ngram":["or"],"estfrequency":27.0}
{"ngram":["case"],"estfrequency":26.0}
{"ngram":["cases"],"estfrequency":25.0} 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T01:39:31.473

这里有一篇关于这个主题的优秀文章。[http://bigdatabloggin.blogspot.com/2012/08/trending-topics-in-hive-ngrams.html](http://bigdatabloggin.blogspot.com/2012/08/trending-topics-in-hive-ngrams.html)

# ios - UIViewController 中的子视图控制器

> ID：11972941
> 
> 赞同：0
> 
> 时间：2012-08-15T16:10:01.113
> 
> 标签：ios, uisplitviewcontroller

我有一个屏幕要显示主从界面。但我需要主人可以隐藏动画。据我所知 UISplitViewController 不支持。

因此，我制作了一个 UIViewController 并向他添加了两个子控制器。

在这个容器视图控制器中，我这样做：

```
- (id)init
{
    self = [super init];
    if (self) {
        self.masterViewController = [[MasterViewController alloc] init];
        [self addChildViewController:self.masterViewController];

        self.detailViewController = [[DetailViewController alloc] init];
        [self addChildViewController:self.detailViewController];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.masterViewController.view.frame = CGRectMake(0, 0, 256, 748);
    [self.view addSubview:self.masterViewController.view];

    self.detailViewController.view.frame = CGRectMake(256, 0, 768, 748);
    [self.view addSubview:self.detailViewController.view];
} 
```

但结果是一团糟。它没有正确改变框架。

当我有两个视图控制器（每个都有自己的超类）时，正确模拟主细节的正确方法是什么？

# macos - 如何根据自动布局 contentView 的最小尺寸自动调整 NSWindow

> ID：11972944
> 
> 赞同：2
> 
> 时间：2012-08-15T16:10:07.073
> 
> 标签：macos, cocoa, nswindow, autolayout

目前，我的应用程序的行为允许我调用我编写的这个额外函数，该函数将窗口大小调整为 FittingSize。

```
- (void)fitToMinimumSize
{
    NSRect frame = [self frame];
    frame.size = [[self contentView] fittingSize];
    int originalHeight = [self frame].size.height;
    int diff = originalHeight - frame.size.height;
    frame.origin.y += diff;
    [self setFrame:frame display:YES];
} 
```

但是我可以通过一些内置的自动布局代码来自动化这种行为，以便窗口始终是它的 contentView 的最小值而不是这个万能的黑客吗？

编辑：我发现我可以检查 [[self contentView]fittingSize]，但是我如何观察它以防它发生变化，或者我应该自己触发它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:33:30.097

通常，如果您的布局完全由`NSConstraint`窗口的内容视图及其子项上的 ' 设置确定，那么一切都应该是“自动的”。

在您的情况下，我会尝试在内容视图上安装高度和宽度约束，尺寸足够小（甚至可能为零），但优先级低于子视图上设置的“内容压缩阻力优先级”。为了让一切正常工作，您可能必须使用约束优先级和/或在内容视图的子项上安装额外的约束。

这应该在没有任何其他代码的情况下工作，只要您的子视图被限制为抵抗崩溃为零。我还认为在这种情况下，窗口不应该是用户可调整大小的。

# excel - 如果单元格行包含“z”，则有条件地格式化列 A

> ID：11972947
> 
> 赞同：0
> 
> 时间：2012-08-15T16:10:19.257
> 
> 标签：excel, excel-2010, worksheet-function, conditional-formatting, countif

`z`如果单元格的相应行包含该行中的任何位置的字母，我想突出显示 A 列中的单元格（使用条件格式工具） 。我想这样做，以便如果数据在 A 列中突出显示，我可以将数据排序到顶部。

我正在使用公式：

```
=COUNTIF($A1:$AA1,"*z*") 
```

但我不想突出显示整行，只突出显示该行 A 列中的相应单元格。

这样做的公式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-14T00:56:21.673

选择 ColumnA 然后 HOME > Styles - Conditional Formatting, New Rule..., *Use a formula to determine which cells to format* and **Format values where this formula is true:** :

```
=COUNTIF($A1:$AA1,"*z*")>0 
```

`Format...`，选择高亮OK，OK。

这将仅适用于 A 列（由于选择）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-15T17:44:33.783

在使用 3x3 单元格表进行测试时，这似乎对我有用：

1.  突出显示 A1:A3
2.  条件格式>新规则>使用公式确定要格式化的单元格
3.  公式：

    =COUNTIF($B1:$C1," *z* ")

然后仅突出显示 A 中的单元格。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-15T17:00:28.997

> “我想这样做，以便如果数据在 A 列中突出显示，我可以将数据排序到顶部。”

好的，首先，您不需要使用条件格式进行排序。其次，您不想在公式中引用 A1 `=COUNTIF($A1:$AA1,"z")`- 它是一个循环引用，并且您放在 A 列中的任何公式都不会返回“z”，因为您将它用于您的 COUNTIF 公式。

您要使用的公式是：

```
=IF(COUNTIF($B1:$AA1,"z")>0,1,0) 
```

如果要查找字符串中任意位置包含 az 的任何行，则需要执行通配符计数：

```
=IF(COUNTIF($B1:$AA1,"*z")>0,1,0) 
```

然后，您可以对所有数据的 A 列进行排序 - 从高到低。

基本上，您已经证明了对如何在 excel 中进行排序的基本误解（无意冒犯）。这应该可以帮助你。祝你好运。

# ubuntu - Ubuntu Linux 上的 Aptana + XDebug

> ID：11972949
> 
> 赞同：1
> 
> 时间：2012-08-15T16:10:30.687
> 
> 标签：ubuntu, xampp, aptana, xdebug, aptana3

我试图让 XDebug 在 Aptana 3 Studio 上运行，在 Ubuntu Linux 中运行。我正在为 Apache + PHP 使用 xampp 安装。我一直在阅读，直到最近才知道 studio 3.0 中不支持 XDebug。似乎我已经能够按照这张票的一些内容安装 XDebug [https://jira.appcelerator.org/browse/APSTUD-769](https://jira.appcelerator.org/browse/APSTUD-769)但是-我在这件事上没有很多经验-我'我是一个使用 Ubuntu 的新手 - 票证对在 Windows 中配置所有内容进行了彻底的解释，这不一样

我的 Xampp 服务器安装在 /opt/lampp 中，带有默认选项（我要调试的站点位于 /opt/lampp/htdocs/mysite）

显然我可以调试单个文件，运行 Debug/Debug as/PHP Script，但我试图在我的 localhost 上调试 WordPress 安装（我正在处理自定义插件）所以我尝试了 Debug>Firefox - internal Server。

然后打开一个新的 Firefox 窗口，显示“Aptana Firefox 扩展正在启动......请稍候”（但尽管它在 Firefox 上，但 url 显示 chrome://aptanadebugger/skin/init.html），然后我收到一条错误消息：

启动 Firefox - 内部服务器遇到问题 套接字连接错误。请尝试关闭并重新启动您的网络浏览器，然后再次运行“调试”

我知道我可能缺少一些需要的信息，我完全迷失在这里。如果有人可以帮助我了解如何配置我的环境，我将非常感谢提示或任何形式的启发。

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T07:20:53.113

我刚刚下载并开始在 Linux Mint 上运行 Aptana Studio 3。在我真正“激活” Firefox 右上角的萤火虫图标之前，我遇到了同样的 Socket 连接问题。小错误图标旁边有一个下拉箭头，其中一个选项是“对所有网页启用”。一旦我打开它，我不再收到套接字连接错误。祝你好运！

# linux - Linux：如何检测进程是否抖动过多？

> ID：11972950
> 
> 赞同：8
> 
> 时间：2012-08-15T16:10:31.800
> 
> 标签：linux, process, virtual-memory

有没有办法以编程方式检测？

另外，检测哪些进程正在抖动的 linux 命令是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-01-16T15:57:49.270

我假设这里的“抖动”是指所有进程的活动内存集太大而无法放入内存的情况。在这种情况下，每次上下文切换都会导致读取和写入磁盘，最终服务器可能会变得如此颠簸，以至于硬件重新启动是重新获得对机器的控制权的唯一选择。

/proc/vmstat 中有全局计数器 swin 和 swout - 如果它们在某个较短的时间间隔内都增加，则该框可能会遇到抖动问题。

在流程级别，它是不平凡的 AFAIK。/proc/$pid/status 包含一些有用的东西，但没有 swin 和 swout。从 2.6.34 开始，有一个 VmSwap 条目，使用的交换总量，/proc/$pid/state 中的变量 #12 是主要页面错误的数量。/proc/$pid/oom_score 也值得研究。如果 VmSwap 正在增加和/或主要页面错误的数量正在增加和/或 oom_score 非常高，则该过程可能会导致抖动。

我编写了一个脚本 thrash-protect - 它可在[https://github.com/tobixen/thrash-protect](https://github.com/tobixen/thrash-protect)获得- 它试图找出导致抖动和临时挂起进程的进程。它对我来说效果很好，最终使我免于重新启动一些服务器。

**更新**：较新版本的内核在 /proc/pressure 下有有用的统计信息。此外，没有交换的计算机也将在内存变满时开始“抖动”，因为缺乏缓冲区空间往往会导致磁盘上的过多读取操作。

# android - 带有复选框和更改背景颜色的 Android 自定义 ListView

> ID：11972951
> 
> 赞同：0
> 
> 时间：2012-08-15T16:10:39.600
> 
> 标签：android, listview, android-listview

我有一个带有复选框和 3 个 TextView 的自定义 ListView。这是我的列表项布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/listviewitem_layout"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal">
<CheckBox
    android:id="@+id/faxCheckBox"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:focusable="false"
    android:focusableInTouchMode="false" />

    <LinearLayout android:orientation="horizontal"
        android:id="@+id/faxbox_item_first_row"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/faxCheckBox"
        android:paddingTop="8dp"
        android:paddingLeft="8dp"
        android:paddingRight="8dp">
        <TextView android:id="@+id/fax_number_textView"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="wrap_content"
            android:lines="1"
            android:ellipsize="start"
            android:textSize="12sp"
            android:paddingRight="5dp"/>
        <TextView android:id="@+id/fax_send_date_textView"
            android:layout_width="wrap_content"
            android:layout_weight="0"
            android:layout_height="wrap_content"
            android:textSize="9sp"/> 
    </LinearLayout>
    <TextView android:id="@+id/more_fax_info_textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="9sp"
        android:textColor="@color/gray"
        android:layout_toRightOf="@id/faxCheckBox"
        android:layout_below="@id/faxbox_item_first_row"
        android:paddingLeft="8dp"/>
</RelativeLayout> 
```

我还有一个用于列表视图的自定义数组适配器：

```
private class MyAdapter extends ArrayAdapter<Order> {
    private ArrayList<Order> mOrders;
    private Context mContext;
    private int mResourceId;

    public MyAdapter(Context context, int resourceId, ArrayList<Order> orders) {
        super(context, resourceId, orders);
        this.mContext = context;
        this.mOrders = orders;
        this.mResourceId = resourceId;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View view = convertView;

        if (view == null) {
            LayoutInflater vi = (LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            view = vi.inflate(mResourceId, parent, false);
        }

        final Order order = mOrders.get(position);

        if (order != null) {
            TextView sender = (TextView)view.findViewById(R.id.number_textView);
            TextView date = (TextView)view.findViewById(R.id.send_date_textView);
            TextView moreInfo = (TextView)view.findViewById(R.id.more_info_textView);
            CheckBox checkBox = (CheckBox)view.findViewById(R.id.checkBox);

            final int itemPosition = position;
            final RelativeLayout rowLayout = (RelativeLayout)view.findViewById(R.id.listviewitem_layout);

            view.setTag(order.getId());

            if (sender != null) {
                sender.setText(order.getSender());
            }

             rowLayout.setBackgroundResource(R.drawable.listview_item_selector);

            if (mSelectedIds.contains(order.getId())) {
                rowLayout.setBackgroundColor(Color.parseColor("#9CD7EF"));
            }

            if (date != null) {
                date.setText(Utils.getStringDateForBox(order.getSendDate(), mContext));
            }

            if (moreInfo != null) {
                moreInfo.setText(getResources().getQuantityString(R.plurals.number_of_pages, order.getPages(), order.getPages()));
            }

            if (checkBox != null) {
                checkBox.setTag(order.getId());

                checkBox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                    @Override
                    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                        if (mSelectedIds.contains(buttonView.getTag()) == true) {
                            if (isChecked == false) {
                                mSelectedIds.remove(buttonView.getTag());
                            }
                        } else {
                            if (isChecked) {
                                mSelectedIds.add((Long) buttonView.getTag());
                            }
                        }

                        showHideActionMode();
                        setActionModeTitle();
                        mListView.setItemChecked(position, true);
                    }
                });

                if (mSelectedIds.contains(order.getId())) {
                    checkBox.setChecked(true);
                } else {
                    checkBox.setChecked(false);
                }
            }
        }

        return view;
    }
} 
```

listview_item_selector.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_focused="true"
      android:drawable="@color/blue" />
<item android:state_pressed="true"
      android:drawable="@color/blue" />
<item android:state_selected="true"
      android:state_activated="true"
      android:drawable="@color/light_blue" />
<item android:state_activated="true"
      android:drawable="@color/light_blue" />
<item android:state_selected="true"
      android:drawable="@color/light_blue" />
<item android:state_focused="false" android:state_selected="false" android:state_pressed="false" 
     android:drawable="@android:color/white" />
<item android:drawable="@android:color/transparent" />
</selector> 
```

问题是，如果我按一行，那么它会将背景颜色更改为蓝色，但没有复选框，则复选框始终具有橙色背景颜色。我怎样才能改变它？也许我应该做的一切都不同吗？我最喜欢ICS上的gmail应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T12:36:00.740

我只发现如何制作自定义复选框，但这不是最好的解决方案。

checkbox_selector.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_focused="true"
      android:drawable="@drawable/btn_check_off_pressed_holo_light" />
<item android:state_checked="true"
      android:state_pressed="true"
      android:drawable="@drawable/btn_check_on_pressed_holo_light" />
<item android:state_pressed="true"
      android:drawable="@drawable/btn_check_off_pressed_holo_light" />
<item android:state_checked="true"
      android:state_activated="true"
      android:drawable="@drawable/btn_check_on_holo_light" />
<item android:state_activated="true"
      android:drawable="@drawable/btn_check_on_holo_light" />
<item android:state_checked="true"
      android:drawable="@drawable/btn_check_on_holo_light" />
<item android:state_focused="false" android:state_selected="false" android:state_pressed="false" 
     android:drawable="@drawable/btn_check_off_holo_light" />
<item android:drawable="@drawable/btn_check_off_holo_light" /> 
```

在我的列表项布局中，我将其添加到我的复选框中：

```
android:button="@drawable/checkbox_selector" 
```

# java - assertTrue/assertFalse if 语句

> ID：11972952
> 
> 赞同：0
> 
> 时间：2012-08-15T16:10:53.957
> 
> 标签：java, jna

如何在 if 语句中使用 assertTrue 和 assertFalse？只是在前面加上 if 语句不起作用，给我一个语法错误，但值得一试。我试图将其设为字符串并使用 value.equals() 检查值，但 assert 给出错误提示您无法转换为字符串。

```
public class JNAWinRegTest extends TestCase {

    public static void main(String[] args) { 

    try { assertEquals("Windows 7 Professional", Advapi32Util.registryGetStringValue(WinReg.HKEY_LOCAL_MACHINE, 
            "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "ProductName"));
        if(True) ){
            System.out.println("True");
        }else{
            if(False) ){
                System.out.println("False");    
            }
        }
    } catch (IllegalArgumentException e) {
                e.printStackTrace();
    } catch (IllegalAccessException e) {
                e.printStackTrace();
    } catch (InvocationTargetException e) {
                e.printStackTrace();
            }                                              
        }  
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:14:17.977

您只需调用`assertEquals(expected, actual)`- if `expected.equals(actual)`，测试将继续到下一行（并在到达最后一行时通过），如果条件为假，则测试失败。

不需要额外的 if / else。

# java - java中的文件标记化

> ID：11972957
> 
> 赞同：-1
> 
> 时间：2012-08-15T16:11:30.393
> 
> 标签：java, tokenize

以下代码用于 java 中的标记化。我有一个小错误，我无法修复。这是关于文件标记化的。在此代码中，如果用户在文件中输入四个大写单词。它不应该被标记化并且应该保留在同一行。如果没有大写字母或其他任何内容，则必须对其余单词进行标记。

例如

> 美利坚合众国 大家好，我是沃尔特。

O/P 应该如下所示。

> 美国
> 
> 你好
> 
> 我
> 
> 是
> 
> 沃尔特。

这就是它应该看起来的样子。写完代码后，我面临一个小错误。O/P 就是这样出现的。

> 美国
> 
> 状态
> 
> 的
> 
> 美国
> 
> 你好
> 
> 我
> 
> 是
> 
> 沃尔特。

基本上我需要摆脱“美国”。在我检查大写的代码中。你能帮我解决这个问题吗，因为我无法解决这个问题？任何使这成为可能的事情都会有所帮助。

请随时更改我的代码并尝试获取我的输出。

```
import java.io.*;
import java.util.*;

public class Tokenize {
  public static void main (String[] args) {
    try {
      BufferedReader inputReader=new BufferedReader(new FileReader("C:/Users/Advait/Desktop/nlp_wikipedia.txt"));
      String currentLine;
      while ((currentLine = inputReader.readLine())!=null) {
      // START STUDENT CODE
        char atUpper;
        char atUpper1;
        int keeper = 1;
        int keeper1 = 0;
        String temp = "";
        int j;
        int i;
        int counter = 0;
        int m=0;
        int n=0;
        String temp1 = "";
        boolean boolKeeper,boolKeeper1;
        String Delimeter = "[\\s,:;'!?()\"]+";
        for(j=0;j<(currentLine.length()-1);j++) {
          if(currentLine.contains("://")) {
            currentLine=currentLine.replace("://","#");
          }
        }
        String token1[] = currentLine.split(Delimeter);
        for(j=0;j<(token1.length)-1;j++) {
          if(j>0) {
            if(keeper==0) {
              atUpper = token1[j+1].charAt(0);
              atUpper1 = token1[keeper].charAt(0);
              boolKeeper = Character.isUpperCase(atUpper);
              boolKeeper1 = Character.isUpperCase(atUpper1);
              if(boolKeeper==true && boolKeeper1==true) {
                m++;
                temp1 = token1[keeper].concat(" ").concat(token1[j+1]);
                token1[keeper] = temp1;
              }
            } else {
              i=j+1;
              atUpper = token1[j].charAt(0);
              atUpper1 = token1[i].charAt(0);
              boolKeeper = Character.isUpperCase(atUpper);
              boolKeeper1 = Character.isUpperCase(atUpper1);
              if(boolKeeper==true && boolKeeper1==true) {
                counter=counter+1;
                if(counter == 1) {
                  keeper1 = j;
                }
                n++;
                temp = token1[keeper1].concat(" ").concat(token1[i]);
                token1[keeper1] = temp;
              }
            }
          } else {
            i=j+1;
            atUpper = token1[j].charAt(0);
            atUpper1 = token1[i].charAt(0);
            boolKeeper = Character.isUpperCase(atUpper);
            boolKeeper1 = Character.isUpperCase(atUpper1);
            if(boolKeeper==true && boolKeeper1==true) {
              keeper = 0;
              m++;
              temp = token1[j].concat(" ").concat(token1[i]);
              token1[j] = temp;
            }
          }
          ArrayList<String> LineList = new ArrayList<String>();
          for (String token : token1) {
            if (!token.equals("%")) {
              LineList.add(token);
            }
          }
          token1 = LineList.toArray(new String[LineList.size()]);
          String token2 = token1[j];
          for (int l=0;l<(token2.length()-1);l++) {
            if(token2.charAt(l) == '-' && token2.charAt(l+1) == '\n') {
              String token3[] = token2.split("-");
              token1[j] = token3[0] + token3[1];
            }
          }
        }
        for(int k=0;k<(token1.length);k++) {
          if(token1[k].contains(".") && token1[k].contains("@")) {
            token1[k] = token1[k].replace(".", "*");
          }
          if(token1[k].contains("#") && token1[k].contains(".")) {
            token1[k] = token1[k].replace("#","://");
            token1[k] = token1[k].replace(".","*");
          }
        }
        for(int k=0;k<(token1.length);k++) {
          StringTokenizer st = new StringTokenizer(token1[k],".");
          while (st.hasMoreTokens()) {
            token1[k] = st.nextToken();
          }
        }
        for(int k=0;k<(token1.length);k++) {
          String token4 = token1[k];
          for (int l=0;l<(token4.length()-1);l++) {
            if(token4.contains("@") && token4.contains("*")) {
              token1[k] = token4.replace("*",".");
            }
            if(token1[k].contains("://") && token1[k].contains("*")) {
              token1[k] = token4.replace("*",".");
            }
          }
        }
        for(int k=0;k<(token1.length);k++) {
          System.out.println(token1[k]);
        }
        // END STUDENT CODE
      }
    }
    catch (IOException e) {
      System.err.println("Caught IOException: "+e.getMessage());
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:35:28.833

你的第一个问题是你把所有东西都塞进了一个巨大的函数中。您需要将代码拆分为有意义的单元，每个单元执行定义明确、易于理解的操作。对于大写单词的具体问题，我推荐一个函数`int capitalizedWordStreakLength(String[] tokens, int i)`。您可以在循环中使用该函数，该循环`List<String>`通过迭代`String[]`您的“原始”标记来组装结果标记，如果该函数返回四个或更多，则将这些单词连接到单个标记中。

# php - 定义了一个常量但内存没有变化

> ID：11972958
> 
> 赞同：0
> 
> 时间：2012-08-15T16:11:38.507
> 
> 标签：php

我试图比较内存中使用的常量和变量，但发现了一个奇怪的现象。

测试代码：

```
<?php
var_dump( memory_get_usage() );  // int(129100)
// I don't understand: I don't do someting but why there has the changed
var_dump( memory_get_usage() );  // int(129156)  
var_dump( memory_get_usage() );  // int(129156)

define('hello', 'WORLD');
// why here hasn't changed
var_dump( memory_get_usage() );  // int(129156)

$hello = 'WORLD';
var_dump( memory_get_usage() );  // int(129304)
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:14:47.017

你并不是什么都不做。该`var_dump`调用可能正在初始化某些东西或留下一些东西。

[请](https://github.com/php/php-src/blob/master/ext/standard/var.c)参阅`php_var_dump`https://github.com/php/php-src/blob/master/ext/standard/var.c

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T16:35:07.560

第一：PHP有很多内存泄漏。这意味着，它确实在某处分配内存，但不会释放它。所以不要害怕看到这样的效果。但这一次可能是别的东西：

看这个例子：

```
<?php

$data = array(0,0,0,0);
$data[0] = memory_get_usage();
$data[1] = memory_get_usage();

echo $data[0];
echo "\n";
echo $data[1];
echo "\n";

$data[2] = memory_get_usage();
echo $data[2];
echo "\n";
$data[3] = memory_get_usage();
echo $data[3];
echo "\n";

?> 
```

输出将如下所示：

```
626464
626464
626528
626528 
```

您会看到它在第一次调用“echo”后发生了变化，这必须为输出缓冲区或类似的东西分配内存。也许它在内部使用 printf(buffer, "...", ...) 来生成发送到标准输出的字符串。该字符串在以后的调用中被重用，如果需要，只需将其大小调整为更长的缓冲区。

您对 var_dump 的调用间接使用了 echo 函数，并且可能还使用了一些内部缓冲区，这是在第一次调用时分配的。

解决方案：为了更准确地测量事物，您应该在“测量”之前调用每个输出函数一次，或者在结果的最终输出之前永远不要调用它们。

# javascript - 接受从另一个浏览器窗口拖放图像

> ID：11972963
> 
> 赞同：33
> 
> 时间：2012-08-15T16:11:57.447
> 
> 标签：javascript, html

在 Javascript 中，我知道如何设置一个拖放目标，以接受从用户计算机上传的文件。如何设置接受从另一个网站拖动的图像的放置目标？我只需要知道他们拖动的图像的 URL。

我知道这是可能的，因为 Google Docs 接受来自其他网站的图片。知道他们是怎么做的吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-15T16:41:54.030

更新：

看起来 Windows 和 MacOS 上的 Chrome 之间存在差异。在 Windows`dataTransfer.getData('Text');`上有效，但在 MacOS 上无效。`dataTransfer.getData('URL');`应该适用于两者。

* * *

旧答案：

您可以定义一个拖放区：

```
<div id="dropbox">DropZone => you could drop any image from any page here</div> 
```

然后处理`dragenter`、`dragexit`和`dragover`事件`drop`：

```
var dropbox = document.getElementById('dropbox');

dropbox.addEventListener('dragenter', noopHandler, false);
dropbox.addEventListener('dragexit', noopHandler, false);
dropbox.addEventListener('dragover', noopHandler, false);
dropbox.addEventListener('drop', drop, false);

function noopHandler(evt) {
    evt.stopPropagation();
    evt.preventDefault();
}
function drop(evt) {
    evt.stopPropagation();
    evt.preventDefault(); 
    var imageUrl = evt.dataTransfer.getData('Text');
    alert(imageUrl);
} 
```

​ 在`drop`事件处理程序中，我们从`dataTransfer`对象中读取图像数据作为文本。如果我们从其他网页中删除图像，则此文本将代表图像的 url。

这是一个[`live demo`](http://jsfiddle.net/kkcMH/7/).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T04:50:00.593

```
function drop(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    var imageUrl = evt.dataTransfer.getData('URL');  // instead of 'Text'
    alert(imageUrl);
} 
```

似乎可以在 Mac 上的 Firefox、Safari 和 Chrome 中使用。也适用于 Windows 中的 Firefox、IE 和 Chrome。

[更新的小提琴](http://jsfiddle.net/zever/EcxSm/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-21T16:36:57.170

虽然您可以接受从另一个网站拖放图像，但您无法对其进行任何处理（例如使用画布将其转换为 base64 字符串）（截至 2014 年 8 月 21 日），因为各种交叉原产地政策问题。

```
var dt = event.dataTransfer;
var url = dt.getData('url');
if (!url) {
    url = dt.getData('text/plain');
    if (!url) {
        url = dt.getData('text/uri-list');
            if (!url) {
                // We have tried all that we can to get this url but we can't. Abort mission
                 return;
             }
         }
     } 
```

甚至 Google 也无法解决这个问题 - 如果您使用 gmail，您可以将图像从另一个位置拖放到电子邮件正文中，但这所做的只是创建一个设置为的`<img/>`元素（来自上面的代码）。`src``url`

但是，我创建了一个插件，允许您伪造它的跨域拖放。它需要一个 PHP 后端。

阅读我在这里写的文章[https://coderwall.com/p/doco6w/html5-cross-origin-drag-and-drop](https://coderwall.com/p/doco6w/html5-cross-origin-drag-and-drop)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-27T09:05:05.043

这是我对问题的解决方案：[Dropzone js - 从同一页面拖放文件](https://stackoverflow.com/questions/30816375/dropzone-js-drag-n-drop-file-from-same-page/43041683#43041683)

请记住，从*另一个*域中拖动图像的能力取决于他们的 CORS 设置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-16T01:29:29.823

一些浏览器使用 text/plain 一些也使用 text/html

此代码应在最新的 Chrome、Mac 和 PC 上的 FF 上提取任何文本或图像源 URL。

Safari 似乎没有给出 URL，所以如果有人知道如何获取它，请告诉我。

我还在研究IE。

```
function getAnyText(theevent) {
//see if we have anything in the text or img src tag
    var insert_text;
    var location = theevent.target;
    var etext;
    var ehtml;
    try {
            etext = theevent.dataTransfer.getData("text/plain");
    } catch (_error) {}
    try {
            ehtml = theevent.dataTransfer.getData("text/html");
    } catch (_error) {}
    if (etext) {
            insert_text = etext;
    } else if (ehtml) {
            object = $('<div/>').html(ehtml).contents();
            if (object) {
                    insert_text =  object.closest('img').prop('src');
            }
    }
    if (insert_text) {
            insertText(insert_text,location);
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-09T12:41:31.187

正如其他答案正确指出的那样：如果可以从另一个浏览器窗口拖放（[`Access-Control-Allow-Origin`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)必须设置），它通常取决于服务器的 CORS 设置。

但是，我偶然发现可以将任何图像从 Firefox（当前版本 68.0.1）拖放到 Chrome 窗口（当前版本 76.0.3809）并在 Javascript 中处理它，无论 CORS 标头是否是设置与否。

请参阅[工作示例](http://jsfiddle.net/y1qert8L/)（基于 Darin Dimitrov 的 jsfiddle），该示例接受并直接显示来自以下位置的图像：

1.  从本地计算机拖放（例如从文件资源管理器）
2.  如果设置了 CORS 标头，则从其他网站拖放，例如来自[https://imgur.com/的图像](https://imgur.com/)
3.  将任何图像从 Firefox 窗口拖放到 Chrome 窗口：
    *   在 Chrome 中打开 jsfiddle 演示
    *   在 Firefox 中打开例如谷歌图片搜索并搜索任何图片
    *   点击图片放大预览
    *   将预览图像拖放到 Chrome 中的 jsfiddle 演示中

然而，这似乎是 Firefox 的一种错误，因此我不会在生产应用程序中依赖这种行为。

# objective-c - 如何将传递给 performSelector:withObject: 的参数从类型 id 转换回来？

> ID：11972973
> 
> 赞同：1
> 
> 时间：2012-08-15T16:12:44.480
> 
> 标签：objective-c

我想将 NSInteger 参数传递给使用 performSelector:WithObject:afterDelay 调用的方法，所以我有以下代码：

```
 id arg = [NSNumber numberWithInt:myIdentifier]; 
   [self performSelector:@selector(myMethod:) withObject:arg afterDelay:kDuration];

    - (void) myMethod: (id) identifier
    {
    ...
    } 
```

在 myMethod: 中，如何将标识符从 id 转换为 NSInteger？

我见过这个以前的问题： [SEL performSelector and arguments](https://stackoverflow.com/questions/2716143/sel-performselector-and-arguments)

但我不明白 myMethodForNumber: - 它是如何用来拆箱号码的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:17:42.313

`myMethod`可以接受`NSNumber`作为参数。然后，您可以使用`NSNumber`实例方法获取整数值。

```
- (void)myMethod:(NSNumber *)number {
    NSInteger value = [number integerValue];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-18T07:59:33.197

更新：请参考[问题](https://stackoverflow.com/q/8088145/1107242)

读或写`performSelector:`如下，

```
@import os.log;

- (void)testSEL
{
    os_log(OS_LOG_DEFAULT, "Original NSObject.version is %zd", NSObject.version); // original 0
    NSObject.version = 1;
    os_log(OS_LOG_DEFAULT, "Custom NSObject.version is %zd (should be 1)", NSObject.version); // custom 1

    // Reading
    NSInteger v = (NSInteger)[NSObject performSelector:@selector(version)];
    os_log(OS_LOG_DEFAULT, "Reading: version is %zd", v);

    // Writing
    [NSObject performSelector:@selector(setVersion:) withObject:(__bridge id)(void *)2];
    os_log(OS_LOG_DEFAULT, "Writing: NSObject.version is %zd", NSObject.version);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:17:14.513

如果你知道它的类型，你可以只转换值：

```
- (void) myMethod: (id)identifier
{
    NSNumber *myNumber = (NSNumber *)identifier;
} 
```

或者，您可以只指定该方法采用的类型：

```
- (void) myMethod:(NSNumber *)myNumber
{
    // Use myNumber
} 
```

# javascript - 如何从 JavaScript 中的子类透明地访问父类成员

> ID：11972974
> 
> 赞同：1
> 
> 时间：2012-08-15T16:12:46.990
> 
> 标签：javascript

我有以下代码：

```
 var Person = function () {
        this.Id = 0;
        this.Name = "";
    };

    var Emp = function () {
        this.OfficeEmail = "";
    };

    Emp.prototype = new Person();
    Emp.prototype.constructor = Emp; 

    var oEmp = new Emp();

    alert(oEmp.hasOwnProperty('OfficeEmail'));//true
    alert(oEmp.hasOwnProperty('Id'));//false
    alert(oEmp.hasOwnProperty('Name'));//false

    alert("Id" in oEmp); //true - inherited property
    alert("Name" in oEmp); //true - inherited property
    alert("OfficeEmail" in oEmp); //true - direct property

    //----------------The following screws up-------------------------
    oEmp.Id = 9999; //creates a new property in Emp instead of accessing from Person
    oEmp.Name = "Scott"; //creates a new property in Emp instead of accessing from Person
    oEmp.OfficeEmail = "Scott@yahoo.com";

    //Now the output is different here
    alert(oEmp.hasOwnProperty('OfficeEmail'));//true
    alert(oEmp.hasOwnProperty('Id'));//true - supposed to be false
    alert(oEmp.hasOwnProperty('Name'));//true - supposed to be false 
```

虽然我知道我可以创建另一个属性（比如“父”）并将其添加到“Emp”原型（并使用“父”访问父成员），但我只是想知道我是否可以实现对基类属性的透明访问“childObject.parentProperty”表示法（没有在子项中创建任何新的“父”属性，以访问父成员）。

# wicket - 在 Wicket 中包含香草文件？

> ID：11972975
> 
> 赞同：0
> 
> 时间：2012-08-15T16:12:49.590
> 
> 标签：wicket

能够在我的 Wicket 门户的 HTML 页面中包含一些包含简单脚本（没有 HTML 相关内容）的普通文本文件会很有用。对 .css 和 .js 的支持没有尽头，但我只想将简单的文本放在一个

```
<pre>
...
</pre> 
```

段落，这样我就不必在这些更改时继续复制和粘贴。或者，我是不是太着急了，问错了问题？

非常感谢您的任何和所有评论。

之后， ...

我得到的答案为我触发了它。这正是我所需要的。尽管我对 Wicket 不熟悉，但我几乎无法接受。然而，多亏了谷歌的奇迹和一位知识渊博的朋友，我才得以做到这一点。可以在[http://www.javahotchocolate.com/notes/wicket.html](http://www.javahotchocolate.com/notes/wicket.html)找到对我的完整解决方案的非常详尽的描述。感谢尼克塔！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:37:43.960

只需给您的预标签一个 wicket-id 并用标签填充它，将标签的 EscapeModelStrings 设置为 false ...

# oracle - 快照太旧错误

> ID：11972979
> 
> 赞同：1
> 
> 时间：2012-08-15T16:13:05.180
> 
> 标签：oracle, teradata, informatica

当我运行工作流超过 5 小时时，我经常收到“快照太旧错误”。我的源是 oracle，目标是 Teradata。请帮助解决这个问题。在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:19:50.420

*快照太旧*错误或多或少直接与查询的运行时间相关（通常是 FOR 循环的游标）。所以最好的解决方案是优化你的查询，让它们运行得更快。

作为一个短期解决方案，您可以尝试增加 UNDO 日志的大小。

**更新：**

UNDO 日志在更新之前存储记录的先前版本。它用于回滚事务并检索旧版本的记录以获得一致的数据快照以进行长时间运行的查询。

如果您想通过增加 UNDO 日志来解决它，您可能需要深入研究 Oracle DB 管理。基本上你做（作为SYSDBA）：

```
 ALTER SYSTEM SET UNDO_RETENTION = 21600; 
```

21600 是以秒为单位的 6 小时。

但是，如果 UNDO 日志文件足够大，Oracle 只会保留 6 小时的旧数据，这取决于回滚段的大小和在数据库上执行的更新量。

因此，除了更改撤消保留时间之外，您还应该确保在作业运行时执行的并发更新很少。特别是，应尽量减少对您的工作正在读取的数据的更新。

如果一切都失败了，增加 UNDO 日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T15:36:09.747

我读过的 ORA-01555 快照太旧错误的最佳解释是在[这个 AskTom 线程中找到](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:275215756923)

问候。

# sox - SOX 在填充操作后产生“爆裂”或“噼啪”噪声

> ID：11972981
> 
> 赞同：-1
> 
> 时间：2012-08-15T16:13:21.247
> 
> 标签：sox

我正在尝试使用以下命令用静音填充 .wav 文件的开头

```
 sox infile.wav padded.wav pad 14 0 
```

但是，在第 14 秒（静音填充结束的地方），原始 .wav 文件中没有发现非常严重的爆裂声。我在 Ubuntu 11 上运行这个命令。关于为什么会发生这种情况以及如何解决它有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:37:10.623

也许您的 wav 文件的开头以一个既不为零也不接近零的样本值开始，并且您的播放系统在开始播放时采用了反弹出算法（当然，这对填充没有影响，因为弹出然后是 14 秒，而不是在开始时）。您可以大胆地检查波形，看看是否是这种情况。

尝试

```
sox infile.wav padded.wav fade h 0.005 pad 14 0 
```

看看是否能解决问题。

# symfony - 为什么我没有收到身份验证令牌错误？

> ID：11972982
> 
> 赞同：1
> 
> 时间：2012-08-15T16:13:22.123
> 
> 标签：symfony

我有以下代码片段来检查使用角色，但是它返回给我一个

> 安全上下文不包含身份验证令牌。一个可能的原因可能是没有为此 URL 配置防火墙。

```
public function loginAction(){
        $request = $this->getRequest();
        $session = $request->getSession();
        var_dump($this->get("security.context")->isGranted('ROLE_ADMIN'));
        $response =  new Response();
        $response -> setContent("login facebook");
        $response->send();
        return array('name'=>'login facebook');
    } 
```

为什么我收到此错误，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:53:20.517

异常消息非常清楚：`One possible reason may be that there is no firewall configured for this URL`. 要检查用户角色，您需要一个包含用户（匿名或非匿名）的令牌。默认情况下，如果您没有为给定路径配置身份验证提供程序，您将不会获得任何安全上下文。

此处的解决方案是添加身份验证提供程序。

# perl - 调试调用 DynaLoader 库的 AUTOLOAD

> ID：11972983
> 
> 赞同：3
> 
> 时间：2012-08-15T16:13:32.777
> 
> 标签：perl, debugging

单步执行供应商提供的库，调用被`AUTOLOAD`'ed，coderef 由 a 捕获`UNIVERSAL::can()`，然后调用该 coderef。我相信调用是通过 DynaLoader 从编译库调用例程。

问题是，当它到达这一行时`$result = &$coderef(@args)`，调试器不会介入任何 coderef，它只是将我带到模块本身的下一行。但是，我被警告`Use of uninitialized value in string ne at (eval 1) line 1670`了，这让我认为 coderef 不仅仅是对外部库的调用。

我已经`s $coderef->(@args)`手动尝试并“介入”了它，这是相同的警告，并且与呼叫没有其他交互。

有没有办法证明这是一个包装器，甚至可能强制调试器在其中查看？

**编辑**更多代码上下文（从 CQPerlExt.pm、IBM ClearQuest Perl API 中大量修剪的例程）：

```
sub AUTOLOAD {
    my @args = @_;
    (my $sub = $AUTOLOAD) =~ s/::/_/g;
    my $coderef = UNIVERSAL::can(__PACKAGE__."c", $sub)
        or Carp::croak "Undefined subroutine &$AUTOLOAD called";

    my $result = &$coderef(@args);
    return $result;
} 
```

它起作用了，预期的例程做了它应该做的事情，但是在执行第 7 行时会警告我。调试器跳到第 8 行。

有一个 CQPerlExtc 包，它是外部库的引导程序。

在这种情况下，@args 包含对 ClearQuest“实体”对象的引用和字符串“修改”（两者都适用于该调用）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T18:31:03.143

最好的方法是简单地用 C 语言编写一个测试程序，然后模拟您在 Perl 中尝试执行的操作。我希望有一种更好的方法来调试通过 DynaLoader 运行的 C 代码，但到目前为止我还没有见过。我还刚刚破解了 Perl 调试器的袖珍参考资料，我没有看到任何提到 DynaLoader。

我只需将其拉入调试器，将传递给 C 函数的值复制到 C 程序中，然后在其上运行 gdb。

# regex - AS3 split() 命令

> ID：11972990
> 
> 赞同：2
> 
> 时间：2012-08-15T16:13:53.043
> 
> 标签：regex, arrays, actionscript, split, combinations

有没有办法可以分割多个字符？我不是指字符的组合，而是一系列特定的选择。例如：

```
s = "john is tall,sue is small";
s.split(" ");
trace(s); 
```

在这种情况下的输出将是：

```
'john' 'is' 'tall,sue' 'is' 'small' 
```

但是，如果我也想编辑逗号以使输出为：

```
'john' 'is' 'tall' 'sue' 'is' 'small' 
```

我怎样才能做到这一点？我很确定它是用正则表达式完成的，但我有点迷茫。先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:21:58.990

AS3 的[`split()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/String.html#split%28%29)方法接受正则表达式作为输入，因此您应该能够使用以下内容：

```
var str:String = "john is tall,sue is small";
var re:RegExp = /[, ]/;
var results:Array = str.split(re); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T16:21:54.210

您只需要一个匹配`','`或`' '`字符的正则表达式。很简单就是：

```
/[, ]/g 
```

# arrays - 删除两个 wordpress 查询之间的重复值

> ID：11972991
> 
> 赞同：0
> 
> 时间：2012-08-15T16:13:58.093
> 
> 标签：arrays, wordpress

我正在解决 Wordpress 中的一个众所周知的问题，我想在其中显示“精选”帖子，并在其下显示其余帖子。
我有一个`$query1`包含 2 个精选帖子，而我`query_posts`的则包含网站上的所有帖子（包括来自 的那两个`$query1`）。
我现在希望从这`query_posts`两个帖子中删除，以便我可以使用常规 Wordpress 循环以以下形式显示它：

```
while (have_posts ()) : the_post();
the_title();
the_content();
endwhile; 
```

我有在上述循环中删除这些重复帖子的解决方案，但是由于分页，我希望在此之前没有重复的查询，因此将在**没有**这两个精选帖子的情况下对`query_posts`数组进行分页。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T07:13:35.253

我已经找到了一个很好的答案，基于 wordpress.stackexchange.com - 你可以在[这里](https://wordpress.stackexchange.com/questions/61936/removing-duplicate-values-between-two-wordpress-queries/61940)找到它。**

# javascript - 多个 socket.io 客户端连接不起作用（Google Chrome、Firefox）

> ID：11972993
> 
> 赞同：0
> 
> 时间：2012-08-15T16:14:13.610
> 
> 标签：javascript, node.js, socket.io

我有一个包含 Javascript 代码的网页，使用 socket.io 连接到两个 NodeJS 服务器（也运行相同版本的 socket.io）。这些服务器位于相同的 IP 上，但端口不同。第一个连接工作正常，但第二个连接似乎不起作用（永远不会调用 on("connect") 回调）。知道为什么会这样吗？

我正在使用 Google Chrome 21.0.1180.79 和 Firefox 14.01。连接服务器的代码类似于：

```
socket = io.connect("http://server", {port:some_port_number});
socket.on("connect", function() {
                       // process connection.
                     }); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:34:06.743

没有选项“端口”，您应该将其附加到 url (http://server:port)。因为 socket.io 忽略了 'port' 选项，所以它不会再次连接到相同的 url（默认）。 [https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO)

# android - 需要为 basic4android 集成 Airpush 广告

> ID：11972994
> 
> 赞同：1
> 
> 时间：2012-08-15T16:14:14.397
> 
> 标签：android, basic4android

[http://www.basic4ppc.com/forum/additional-libraries-classes-official-updates/11832-airpush-library.html](http://www.basic4ppc.com/forum/additional-libraries-classes-official-updates/11832-airpush-library.html)

我按照这些说明进行操作，但它不会让我编译应用程序。我正在使用 1.9 版。看起来代码已更改，但帮助论坛未更新正确的代码。

# ios - 设置 textFields inputView 以防止键盘出现不适用于拆分键盘

> ID：11972996
> 
> 赞同：1
> 
> 时间：2012-08-15T16:14:21.297
> 
> 标签：ios

我有一个 textField，我想通过在 popOver 中使用自定义输入视图来编辑它。所以我阻止键盘出现，但为 textViews 输入视图设置一个虚拟视图，即

```
UIView* dummyView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 1, 1)];    
[self.textFieldStartBid setInputView:dummyView]; 
```

这很好用，我点击 textField，键盘保持隐藏状态，popoverController 出现。如果您之前拆分了键盘，则会出现问题，现在当您点击 textField 时，我会在屏幕底部看到一个带边框的透明视图，它覆盖了整个宽度，大约 50 像素高。

我有不止一个 viewController 使用这种技术来隐藏键盘，并且所有 VC 都有与拆分键盘完全相同的问题。

似乎我已经成功阻止拆分键盘出现但不完全，有没有经历过这种或没有或任何可能的解决方案？

谢谢，斯图尔特。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T16:48:05.977

尝试使用`CGRectMake(0, 0, 0, 0)`您的`dummyView`初始化：

```
UIView* dummyView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 0, 0)]; 
```

这对我来说很好。

# java - 如何使用 Apache FOP 1.0 从带有日文字符的 XML 创建 PCL 文档？

> ID：11972997
> 
> 赞同：0
> 
> 时间：2012-08-15T16:14:21.377
> 
> 标签：java, fonts, internationalization, apache-fop

我知道这应该是一件容易的事，但是当我尝试从 XML（通过 XSL）生成 PCL 文档时，日文字符显示得非常像素化。

Apache FOP 1.0 Java 1.6.0_27

我已经为 pdf 设置了一个 userconfig.xml，并且效果很好：

```
<renderer mime="application/pdf">
  <fonts>
     <font metrics-url="IPAexGothic.xml" kerning="yes" embed-url="ipaexg.ttf">
       <font-triplet name="IPAexGothic" style="normal" weight="normal"/>
     </font>
  </fonts>
</renderer> 
```

但我在 FOP 文档中读到 PCL 的字体是完全不同的球类游戏：

```
"Non-standard fonts for the PCL renderer are made available through the Java2D
subsystem  which means that you don't have to do any custom font configuration in this
case but you have to use the font names offered by Java." 
```

我试图将字体放到我的 jre/lib/fonts/ 目录中。我试图设置逻辑字体。（[http://docs.oracle.com/javase/tutorial/2d/text/fonts.html](http://docs.oracle.com/javase/tutorial/2d/text/fonts.html)）

我在 AWT 中创建了一个程序来尝试显示日文字符。他们也没有显示。

我错过了什么愚蠢的东西吗？如果有帮助，这里有一些日文字符。东京都</p>

谢谢，约书亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T04:14:14.963

通常情况下，一旦你非常擅长记录你的问题，你通常会非常接近解决方案。为了防止这些 un​​icode 字符在 PCL 中被像素化，您需要将 FOP 配置中的 DPI 设置为远高于默认的 72 dpi。我将我的设置为 600 并且可读性提高了。

```
<fop version="1.0">
  <source-resolution>600</source-resolution>
  <target-resolution>600</target-resolution>
  <renderers>
    <renderer mime="application/vnd.hp-PCL">
      <rendering>quality</rendering>
      <text-rendering>bitmap</text-rendering>
    </renderer>
  </renderers>
</fop> 
```

# jquery - window.confirm 内的变量

> ID：11972998
> 
> 赞同：0
> 
> 时间：2012-08-15T16:14:32.173
> 
> 标签：jquery

我有这段代码：

```
use_result = window.confirm("You have 1 registration credits. Do you wish to use a registration credit for this player?"); 
```

那里的数字`1`不是动态的，它是手动分配的。我想要的是我将放置一个变量而不是 digit `1`，这样它的值就是动态的。那可能吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T16:15:55.270

是的; 最简单的方法是使用字符串连接：

```
use_result = window.confirm("You have " + n + " registration credits. Do you wish to use a registration credit for this player?"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:15:46.247

您可以简单地用变量替换该静态值 -

```
var numberOfRegistrations = 1;
use_result = window.confirm("You have "+ numberOfRegistrations +" registration credits. Do you wish to use a registration credit for this player?"); 
```

确认对话框中显示的最终字符串将是周围字符串和预定义动态变量的串联。

### [这是一个非常简单的 jsFiddle 演示](http://jsfiddle.net/fqxhK/)

* * *

同样，当您将数值相加时，您将使用字符串获得这些值的总和，使用`+`运算符将​​简单地组合两个字符串。

```
var firstWord = "Stack";
var secondWord = "Overflow";

alert(firstWord + seconfWord); // This will alert the string - "StackOverflow"; 
```

您可以将任意数量的字符串组合在一起以创建最终字符串 -

```
alert('Hello' + ' ' + 'World'); // This will alert the string - "Hello World" 
```

请注意，在最后一个示例中，我加入了 3 个字符串。

*   `Hello`
*   一个空格
*   `World`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T16:17:10.237

将字符串连接与 + 运算符一起使用。

```
var a = /*... */;
use_result = window.confirm("You have "+ a +" registration credits. Do you wish to use a registration credit for this player?"); 
```