# StackOverflow 问答 12253000-12253999

# c++ - 提升路径指向的目录中文件的路径

> ID：12253002
> 
> 赞同：4
> 
> 时间：2012-09-03T19:17:15.687
> 
> 标签：c++, boost, boost-filesystem

我有一个指向某个目录的提升路径。如何构造指向该目录中文件的路径？

如果这是显而易见的事情，请发表评论。我是 C++ 新手，在 Java 中就这么简单：

```
File file = new File(theDirectory, "filename.txt"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:21:40.830

使用[附加](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/reference.html#path-appends)例如

```
path /= filename; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:20:44.273

Path 有一个方便的地方`operator/`，你可能会发现它对这个目的有用：

```
auto file = directory / "filename"; 
```

# javascript - meaning mode: 'abort' in JS Ajax request

> ID：12253009
> 
> 赞同：1
> 
> 时间：2012-09-03T19:18:03.577
> 
> 标签：javascript, ajax, jquery, abort

I am not sure I understand the purpose of the `'abort'` option in JQ Ajax requests.
What is it used for?

```
$.ajax({
                **mode: 'abort',**

                dataType: 'html',
                url: baseUrl + '/books/search/isbn/' + value + '/current_status/dropped',
                success: function(data) {
                    $('#found-books').html(data);
                }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:16:01.617

它不包含在[jQuery](http://jquery.com)的核心中，它带有一个名为[ajaxQueue](http://www.bvbcode.com/code/82iamsqt-867838)的插件。mode:abort，中止所有当前的ajax请求，可选的你可以使用一个端口来限制你正在中止的组。[带有jQ​​uery 自动完成](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)插件的代码示例：

```
$.ajax({
    // try to leverage ajaxQueue plugin to abort previous requests
    mode: "abort",
    // limit abortion to this input
    port: "autocomplete" + input.name,
    .... 
```

# python - 如果“env”参数包含 unicode 对象，为什么 Popen 在 Windows 上会失败？

> ID：12253014
> 
> 赞同：11
> 
> 时间：2012-09-03T19:18:28.260
> 
> 标签：python, windows

考虑这个例子：

```
>>> import subprocess as sp
>>> sp.Popen("notepad2.exe",env={"PATH":"C:\\users\\guillermo\\smallapps\\bin"})
<subprocess.Popen object at 0x030DF430>
>>> sp.Popen("notepad2.exe",env={"PATH":u"C:\\users\\guillermo\\smallapps\\bin"})
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python26\lib\subprocess.py", line 633, in __init__
    errread, errwrite)
 File "C:\Python26\lib\subprocess.py", line 842, in _execute_child
   startupinfo)
TypeError: environment can only contain strings 
```

我已将错误追溯到此 CPython 代码：

[http://hg.python.org/cpython/file/ca54c27a9045/Modules/_winapi.c#l511](http://hg.python.org/cpython/file/ca54c27a9045/Modules/_winapi.c#l511)

但是，我无法理解`PyUnicode_Check`它的作用：

[http://hg.python.org/cpython/file/26af48f65ef3/Objects/unicodeobject.c#l73](http://hg.python.org/cpython/file/26af48f65ef3/Objects/unicodeobject.c#l73)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T19:27:24.247

正如错误消息所说，环境只能包含字符串。您的第一个`Popen`调用满足此条件，但第二个调用不满足此条件，因为您正在映射到使用该语法`PATH`创建的 Unicode 对象。`u"..."`提供环境字典时仅使用字节字符串`Popen`，您不会收到此错误。

请注意，根据回溯判断，您使用的是 Python 2.6，因此链接代码实际上并不适用，因为它来自[Python 3.3.0 beta2](http://hg.python.org/cpython/file/ca54c27a9045/README)。`PyUnicode_Check`检查该对象是否为 unicode 对象，这在 Python 3 中是有意义的，其中字符串*是*（内部实现为）unicode 对象。但是，在 Python 2.6 中，[等效的行](http://hg.python.org/cpython/file/f130ce67387d/PC/_subprocess.c#l359)是 using `PyString_Check`，这将使其在您的第二个示例中失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-13T16:40:47.157

我在为 pyspark 配置 jupyter 内核时遇到了类似的情况： kernel.json 被读取为 unicode，然后打包到 **kwargs 传递给 C:\Anaconda2\Lib\site 中的 proc = Popen(cmd, **kwargs) -packages\jupyter_client\launcher.py

因此，我不得不像这样修改launcher.py：

```
 try:
        # Ihor Bobak:  fix to convert all env keys and values to str
        klist = kwargs['env'].keys()[:]
        for key in klist:
            value = kwargs['env'][key]
            if isinstance(key, unicode) or isinstance(value, unicode):
                newkey = key.encode('ascii','ignore')
                newvalue = value.encode('ascii','ignore')
                del kwargs['env'][key]
                kwargs['env'][newkey] = newvalue
        # regular code
        proc = Popen(cmd, **kwargs) 
    except Exception as exc:
        msg = (
            "Failed to run command:\n{}\n"
            "    PATH={!r}\n"
            "    with kwargs:\n{!r}\n"
        ) 
```

# jquery - jQuery 偏移在 Firefox / Safari 中返回错误

> ID：12253016
> 
> 赞同：2
> 
> 时间：2012-09-03T19:18:33.580
> 
> 标签：jquery, position, offset

我正在尝试通过传递偏移量将一个元素与另一个元素垂直对齐。它在 Chrome 中排成一行，但 FF / Safari 将它推得比它应该的更远......例如：[http ://campaignreport2012.rogerhutchings.co.uk/cinema-verite/](http://campaignreport2012.rogerhutchings.co.uk/cinema-verite/)

```
function headalign() {
    var original_offset = ( $("#header").offset() );
    var custom_offset_top = ( $(".wp-post-image").offset().top );
    var custom_offset_left = ( $("#header").offset().left );

    if ( $(window).width() > 768 ) {
        $("#maintitle").offset({
            top: custom_offset_top,
            left: custom_offset_left,
        });
    } else {
        $("#maintitle").offset( original_offset );
    }   

}

if ( $("body").hasClass("single") ) {
    headalign();
    $(window).resize(function() { headalign(); });
} 
```

它在调整大小时会重新计算它，但在第一次加载时它太低了。谁能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T10:11:31.420

作为正确答案（而不是评论）：

您的 javascript 在浏览器收到后立即执行。根据该脚本在文档中的位置，这甚至会在 DOM 完全加载之前发生。

`$(document).ready(function(){ headalign(); });`会在 DOM-load 上执行你的函数。但此时，图像和“BlockGothic”字体均未呈现。因此`custom_offset_top`是`0`或其他一些值（没有图像，没有自定义字体）。

您需要等到页面完全呈现：

`$(window).load(function(){ headalign(); });`

这会导致您的`"#maintitle"`. 您可以首先“修复”隐藏`"#maintitle"`并在呈现页面后将其淡入：

CSS：

```
#maintitle {
    display: none;
} 
```

javascript:

```
$(window).load(function(){
    headalign();
    $("#maintitle").fadeIn(200);
}); 
```

希望这有帮助！

# java - 保龄球得分和异常处理

> ID：12253017
> 
> 赞同：1
> 
> 时间：2012-09-03T19:18:45.857
> 
> 标签：java, arrays, string, primitive-types

这是一个计算保龄球得分的代码，我需要帮助来解决这个错误：

线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：0

这是我的输入（我存储在名为 Bowling.txt 的文本文件中）。

0 4 5 3 4 2 4 4 3 5 0 8 3 1 2 1 6 4 3 4

0 P 5 3 4 2 4 4 3 5 0 8 3 1 2 1 6 4 3 4

游戏有 10 帧，每帧尝试两次，所以我想我需要在文本文件中包含 20 个数字（分数）。

这就是我得到的：

```
The score is 66
The score is 77
Exception in thread "main" java.lang.StringIndexOutOfBoundsException: String index out of range: 2
    at java.lang.String.charAt(Unknown Source)
    at pin.main(pin.java:77) 
```

注意：我会给所有有用的答案+1！

```
import java.io.BufferedReader;   
import java.io.FileNotFoundException;   
import java.io.FileReader;    
import java.io.IOException;    

public class pin     
{
    static String tries;    
    public static int value(int index) 
    {    
        int i = 0;
        if (tries.charAt(index) == 'T')
            i = 10;
        else if (tries.charAt(index) == 'P')
            i =10 -(tries.charAt(index-2)-'0');
        else
            i = tries.charAt(index)-'0' ;
        return i;
    }

    public static void main(String[] args) throws FileNotFoundException, IOException    
    {
        int score = 0;    
        int frameIndex;    
        int i = 0;    
        FileReader fr = new FileReader("C:/Users/PC4599/Desktop/programming/bowling.txt");
        BufferedReader br = new BufferedReader(fr);
        tries = br.readLine();

        while (tries != null) 
        {
            score = 0;
            frameIndex = 0;
            i = 0;
            while (frameIndex != 10) 
            {
                if (tries.charAt(i)=='T') //Strike 
                {
                    score =(score + 10 + value(i + 2) + value(i + 4));
                    i = i + 2;
                } 
                else if (tries.charAt(i+2)=='P') //Spare 
                {
                    score =(score + 10 + value(i + 4));
                    i = i + 4;
                }
                else 
                {
                    score =(score + (tries.charAt(i)-'0') + (tries.charAt(i + 2)-'0'));//Neither Strike nor Spare 
                    i = i + 4;
                }
                frameIndex = frameIndex + 1;

            }

            System.out.println("The score is "+score);
            tries = br.readLine();    
        }    
        br.close();    
        fr.close();    
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:26:22.280

似乎`while (tries != null)`循环运行了三遍。您的输入文件末尾可能有一个额外的行，可能只是空格。

给定数据输入的格式，最少的正确分数行将包含 23 个字符（12 个以空格分隔的打击），因此您可以将该检查更改为类似`while ((tries != null) && (tries.length() >= 23))`. 这应该可以解决这个问题，并且无论如何似乎都是一件非常合理的事情。（如果我不记得如何正确打保龄球，您可能可以进行适当的调整。）

# php - php $this->view->$someVar 有可能吗？

> ID：12253023
> 
> 赞同：2
> 
> 时间：2012-09-03T19:19:12.417
> 
> 标签：php, oop, variable-assignment

我正在创建一个模型视图控制器框架，我对此有点陌生。我想将变量从控制器传递到视图。我的 View.php 构造函数如下所示：

```
 function __construct($file, $args) {
        $this->view = $file;
         foreach($args as $key => $arg) {
            $this->view->$key = 'awda';
         }
    } 
```

它给了我错误原因

```
 $this->view->$key is not a valid statement. 
```

如果我从控制器做类似

```
 $this->view->hello = 'hello world' 
```

我做回声

```
 $this->hello 
```

鉴于它工作正常，但我希望能够传入多个变量。有谁知道这样做的更好方法？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:26:18.143

您正在尝试将属性分配给我怀疑是字符串 ( `$file`) 的内容。由于您在视图的构造函数中，您可以简单地使用`$this`来引用视图：

```
function __construct($file, $args) {
    $this->view = $file;
     foreach($args as $key => $arg) {
        $this->view->$key = 'awda'; // HERE is the issue.. isn't $this->view a string?
     }
}

function __construct($file, $args) {
    $this->view = $file;
     foreach($args as $key => $arg) {
        $this->$key = 'awda'; // assign $key as property of $this instead...
     }
} 
```

# xtk - 如何从 XTK 中的一组三平面 2D 图像中获取体积坐标？

> ID：12253038
> 
> 赞同：0
> 
> 时间：2012-09-03T19:21:15.180
> 
> 标签：xtk

我有一个应用程序，我想从一组二维图像（轴向、矢状、冠状）中获取体积坐标，类似于[第 13 课](http://lessons.goxtk.com/13/)底部面板中显示的内容。我目前不需要 3D 视图，所以这感觉就像[find-world-coordinates-from-screen-coordinates](https://stackoverflow.com/questions/11530198/finding-world-coordinates-from-screen-coordinates)的简化版本。

[在最近的问题xtk-2d-renderer-linking-with-onmousedown-position](https://stackoverflow.com/questions/12231442/xtk-2d-renderer-linking-with-onmousedown-position)中，获取体积坐标 onMouseDown 似乎也是必需的步骤。

非常感谢任何有关如何获取体积坐标的帮助或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T02:04:17.897

我刚刚回答了[https://stackoverflow.com/a/12255899/1183453](https://stackoverflow.com/a/12255899/1183453)。简而言之：这现在是不可能的，但肯定应该是。我认为在 2D 情况下可能会更容易。我们需要将屏幕位置映射到卷空间的功能。我们应该创建一个 GitHub 问题并进行讨论。

# rest - 单页 Web 应用程序 + REST api 组合：服务器还是客户端方法？

> ID：12253039
> 
> 赞同：1
> 
> 时间：2012-09-03T19:21:23.750
> 
> 标签：rest, angularjs

**语境**

我正在使用 AngularJS 和使用 REST api 作为后端构建一个单页 Web 应用程序。

其余后端具有以下服务（简化）：

*   /accounts/:id -- 管理账户
*   /transactions/:id -- 管理与账户相关的交易
*   /sms/:id -- 管理发送短信并列出发送的短信

**问题**

当我想调节发送到当前账户余额的短信时，问题就出现了。

如何在保持 REST 理念的同时实现账户余额验证？

**替代解决方案**

在我看来，我有两种选择：

*   服务器端：短信路由处理短信发送请求（POST /短信）的账户和余额检查
*   客户端：控制器首先询问账户余额，只有余额才调用短信路由

服务器端优缺点：

*   优点：账户余额检查对网络应用程序是透明的；客户端没有账户余额验证意味着没有黑客攻击的机会（？）
*   缺点：意味着 sms 路由也将负责余额检查

客户端的优缺点：

*   优点：保持 REST apis 正交
*   缺点：将验证逻辑移至客户端使其容易被黑客攻击

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T16:06:50.680

您的数据有多有价值/敏感？根据经验，永远不要相信客户会保护您的数据。除了您在客户端执行的任何验证之外，任何值得保护的东西都应该在服务器端进行验证。两者都没有错，并且在客户端和服务器上都进行验证的常见做法，它为您的用户提供更丰富的体验，同时保护您的域。

祝你好运，

马特

# ghostscript - 将 EPS 图像插入 PostScript 文档

> ID：12253041
> 
> 赞同：5
> 
> 时间：2012-09-03T19:21:27.773
> 
> 标签：ghostscript, postscript, eps

要将外部 EPS 文件插入 PostScript 文档，指示使用文本编辑器打开 EPS 文件并在 PostScript 文件中复制/粘贴基于文本的数据。

我想知道是否有一种标准方法可以将外部 EPS 文件包含在 PostScript 文档中？我的意思是链接到 EPS 文件，因为 PS 可以在运行 PostScript 文档时捕获并读取其内容。我读过一些关于`run`命令的东西，但不知道如何使用它在主 PostScript 文档中包含外部 EPS 文件。

**更新：**将 EPS 图像插入为

```
%!PS-Adobe-3.0

/Times-Roman findfont
14 scalefont setfont

72 700 moveto
(Thi is a text) show

72 300 translate
(1.eps)run

72 100 moveto
(Another text bellow image) show
showpage 
```

它发送到下一页。在此示例中，第二个文本转到第 2 页，而不是显示在位置 )72 100。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T00:34:55.007

由于您扩展了原始问题，因此我最好添加另一个答案...

**首先**，不要`%!PS-Adobe-3.0`在第一行使用（它*表示*您的文件符合某个标准，但它*不这样做*）。仅使用`%!PS`（甚至仅使用`%!`）。

**其次**，您必须确保您的`1.eps`文件确实是*有效*的EPS。由于你不包括你的`1.eps`，我无法检查这个。

**第三**，不，这不是`translate`导致创建新页面的语句——这个翻译*本身*在语法上是可以的（取决于你想要达到的效果）。

**第四**，您的EPS不应该使用`showpage`运算符，否则我在其他答案中给出的简单行将无法单独工作。如果 EPS 本身弹出，您需要在运行 EPS*之前*将运算符`showpage`重新定义为无操作，并在运行后恢复原始语义：`showpage`*`showpage`*

 *```
save
/showpage {} bind def
(my.eps) run
restore 
```

**第五**，第二个文字不一定出现在EPS*下方。*根据 EPS 的实际尺寸，它很可能会打印在 EPS 的空间中。

**第六**，第一个文本可能被 EPS 的笔触和填充覆盖（取决于 EPS 的实际绘图大小），因此可能根本不存在。

**第七**，真正的 PostScript 大师（我不是其中之一），可能会找到 第 0*条*、第*8*条、第 9 条、*第 10*条甚至更多关于这个主题的项目来指出...... *;-)*

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T21:10:39.753

假设您的 EPS 文件与您的主 PostScript 文件位于同一目录中，并且名为`my.eps`. 然后您可以将此行放入 PostScript 文件的代码中：

```
(my.eps) run 
```

你必须弄清楚这条线应该在哪个确切位置产生想要的效果。可能就在`showpage`操作员之前是一个不错的起点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T07:41:21.380

为了帮助您更深入地了解 EPS，请运行以下命令（根据您自己的情况调整路径）：

```
sudo gs                                                  \
  -o /opt/local/share/ghostscript/9.05/examples/tigr.eps \
  -sDEVICE=epswrite                                      \
   /opt/local/share/ghostscript/9.05/examples/tiger.eps 
```

然后考虑这个示例 PostScript 文件，名为`so#12253041.ps`：

```
%!

/Times-Roman findfont 14 scalefont setfont

% Page 1
72 680 moveto (This is a text on page 1) show

72 200 translate
save
.5 .5 scale
  /showpage {} bind def
  (/opt/local/share/ghostscript/9.05/examples/tigr.eps) run
2 2 scale
restore

72 100 moveto (Another text \(across image\)) show
showpage

% Page 2
72 680 moveto (This is a text on page 3...) show

.5 .5 scale
72 200 translate
save
  /showpage {} bind def
  (/opt/local/share/ghostscript/9.05/examples/tigr.eps) run
restore
2 2 scale

72 100 moveto
(Another text \(across image\)) show
showpage

% Page 3
72 680 moveto (This is more text on page 3\. But it is not visible... Why?) show

.25 .25 scale
72 200 translate
save
  /showpage {} bind def
  (/opt/local/share/ghostscript/9.05/examples/tiger.eps) run
restore
4 4 scale

72 100 moveto
(Another text \(across image\)) show
showpage

% Page 4 (empty)
showpage 
```

并运行：

```
gs -o so#12253041.pdf -sDEVICE=pdfwrite so#12253041.ps 
```

**Last**,

1.  ...try to understand what happens in each line of the PS;
2.  ...take into account the differences in the code for each page (also the order of operators);
3.  ...also look at the differences between the two EPS files.**

# php - 将本地时间转换为 GMT

> ID：12253042
> 
> 赞同：2
> 
> 时间：2012-09-03T19:21:32.763
> 
> 标签：php, date, datetime, time

我有这些数据可供使用：

```
Timezone of local time as integer: 8.75 (which is UTC+8.75)
1) 2012-09-04 03:15:03
2) 2012-09-03 18:30:03 (GMT)
3) 1346728503
4) 1346697003 (GMT) 
```

现在，我想知道如何将本地时间 (1) 转换为 GMT 一 (2)（反之亦然），同时考虑到夏季时间、1970-2038 时间限制等所有可能的例外情况？无论如何，它们重要吗？

PHP 函数主要不允许指定本地时间的时区来转换时间 - 它们采用服务器的本地时间，这不是我想要的（我也不想改变它）。**我显然可以`8.75*60*60`从 1346728503 (3) 中减去，但这无论如何都会产生准确的值吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:40:06.820

好的，首先：接受时间戳的 PHP 函数不接受时区，因为*UNIX 时间戳不知道也不关心时区*。

当我输入时，时间是 2012 年 9 月 3 日星期一 15:30:10，在美国东部时区，目前正在遵守夏令时（“夏令时”）。在 UTC 时区中，这对应于 19:30:10。无论哪种方式，它都是 UNIX 时间戳（`time_t`值）1,346,700,610。根据您在地球表面的位置，您当时的当地时间可能落在 26 小时范围内的任何时间，从 9 月 3 日上午 7:30:10 到 9 月 4 日上午 9:30:10 (2012-09- 03T07:30:10-12:00 至 2012-09-04T09:30:10+14:00）。但是无论您的本地标签是什么，对于 UNIX 和 PHP，时间问题仍然是 1,346,700,610。

看起来您试图`time_t`根据时区计算不同的值，但这并不计算。时区偏移量永远不会应用于`time_t`不会改变的值；它们仅适用于人类可读的表示。

如果可能，请不要尝试进行自己的时区转换。规则往往会改变。现在，对我来说，当地时间比 UTC 早四个小时；再过几个月，就会提前5个小时。此外，今年发生这种变化的规则与五年前不同。因此，根据我尝试转换的特定时间戳值，我必须应用不同的规则。

使用库函数。

要将时间的字符串表示形式转换为`time_t`值，请使用[`strtotime`](http://php.net/manual/en/function.strtotime.php). 如果字符串包含时区引用，`strtotime`将为您进行转换。如果没有，您可以[`date_default_timezone_set`](http://www.php.net/manual/en/function.date-default-timezone-set.php)按照 Connie 的建议使用 来告诉 PHP 在解释字符串时使用哪个时区。

要将`time_t`值转换回字符串，请使用[`date`](http://php.net/manual/en/function.date.php)获取“本地”时间（即，根据使用 设置的时区的时间`date_default_timezone_set`；您可以使用 询问 PHP 该时区是什么[`date_default_timezone_get`](http://www.php.net/manual/en/function.date-default-timezone-get.php)），或[`gmdate`](http://www.php.net/manual/en/function.gmdate.php)获取 UTC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:54:19.307

您已经内置了它`gmdate()`以获取 GMT 的日期/时间并`gmstrftime()`从给定的日期/时间字符串转换。

或者您可以使用 timezone_offset_get() 并手动执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:23:36.610

你在找这个吗？

```
date_default_timezone_set('America/Denver'); 
```

如需使用此功能的完整时区列表，[请单击此处](http://www.php.net/manual/en/timezones.php)

# c++ - 有没有办法在 C++ 中指定指针指向始终有效的数据？

> ID：12253044
> 
> 赞同：4
> 
> 时间：2012-09-03T19:21:41.450
> 
> 标签：c++, constants

在作为指针 (foo(void *bar)) 的函数参数中，您可以使用 const 来指定指针（参数）本身是常量（foo(void * const bar)），和/或指向的指针是常量 (foo(void const *bar))。

但是在 foo(void const *bar) 的情况下，这只是向调用者保证 foo 不会尝试修改 bar 指向的数据。它不给 bar 任何保证 foo 指向的内存位置将始终有效。

如果您正在使用可执行映像中的常量数据，如果您可以向 foo 提供该保证，并且如果 foo 需要保留对该数据的引用超过函数调用的持续时间，则 foo 可以简单地保留指针，而不必复制数据。

有没有办法在 C++ 类型系统中编码这个保证？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:29:24.520

不是使用原始指针，但您可以使用 shared_ptr 或 unique_ptr 来代替它来传达函数拥有指针的所有权。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T19:24:09.033

问：有没有办法在 C++ 中指定指针指向始终有效的数据？

A: 不。你总是有能力射自己的脚 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T19:28:41.547

如果您接受指针作为输入，则没有真正的方法可以保证它。但是，您可以维护一个有效指针表，并让您的输入成为该表的索引；您可以通过确保索引位于表内来验证这一点。

除此之外，您能做的最好的事情就是捕获使用错误指针时发生的异常/信号并尝试从中恢复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T19:28:49.767

我采用的方法是创建一个类表示，它引入了一种语义，指定支持数据是`static`. 然后只需确保它不能被简单地构建，或者它的数据重新分配。

所以不，没有直接的语言特征，但引入语义很容易。

下面是一个关于如何防止客户端意外将标准数据提升到不朽数据容器的说明：

```
template <typename T>
class t_immortal_data_container {
public:
  // how clients create t_immortal_data_container<T>,
  // avoiding implicit promotions:
  static t_immortal_data_container Create(T& pImmortalData) {
    return t_immortal_data_container(pImmortalData);
  }

  ~t_immortal_data_container() {
  }
public:
  ...
private:
  // private: ensure t_immortal_data_container<T> only can use
  // this constructor:
  t_immortal_data_container(T& pData) : d_immortalData(pData) {
  }
private:
  T d_immortalData; /* << as pointer or reference */
private:
  // prohibited -- no definition
  t_immortal_data_container() /* = delete */ ;
}; 
```

然后您更新您的程序以接受此类型作为参数，并相应地处理这些情况。

# javascript - jQuery Mobile：如何在 $.mobile.changePage 之前运行回调函数？

> ID：12253047
> 
> 赞同：1
> 
> 时间：2012-09-03T19:21:47.537
> 
> 标签：javascript, jquery, cordova, jquery-mobile

我正在使用 jQuery Mobile 和 PhoneGap 建立一个移动应用程序。我想要做的是，当我单击 ID 为“news_link”的链接时，我希望 jQuery 从数据库中获取数据并将其放入 jQm 的可折叠集。在我的解决方案中，我想在回调函数中使用 $.mobile.changePage，因为我想等到数据被提取并放入容器中，然后代码更改页面。这是代码：

```
$(function() { 
  $('#news_link').click(function(){
    loadNewsFromDB(function(){
       $.mobile.changePage( $("#news"), { transition: "slideup"} );
    });
}); 
```

loadNewsFromDB 是 PhoneGap 的 SQLite 数据库函数，它可以从数据库中获取具有更多回调函数的数据。内容将使用 .html-function 放入所需的容器中

```
function loadNewsFromDB(){
//some code here
theDB.transaction(function(tx) {
    tx.executeSql(sqlStr, [], onLoadNewsSuccess, onLoadNewsError);
},onTxError, onTxSuccess);

function onLoadNewsSuccess(tx, results){
    //some code here
    $("#newsSet").html(htmlCodeAndContentToPut); 
```

Html 是 jQm 的基本 ui 模块：

```
<!-- some html code here --!>
<div data-role="page" id="news">
    <div data-role="content">
        <div id="newsSet" data-role="collapsible-set" data-mini="true"> 
```

通过调试，我知道代码可以正常运行，直到它到达 $.mobile.changePage-function 为止。不知何故，它不会改变页面。我已经检查过它在其他情况下运行良好的函数，但在回调函数中却没有。

如果有人帮助我，我将非常感激我是否没有看到明显错误的东西或更具体的东西？从 SQLite 获取数据、等待获取数据、将数据放入容器然后更改页面还有哪些其他解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:18:54.770

*   我从来没有遇到过**`$.mobile.changePage`**来自**Ajax**的回调函数问题，因此可以从回调函数更改页面

*   您`loadNewsFromDB`使用函数作为参数调用该函数。但我看不到您在函数本身
    的何处/如何使用此参数。`loadNewsFromDB`您不必在`loadNewsFromDB`函数上定义参数吗？
    定义回调函数后，您应该在数据准备好时调用它。
*   我会尝试**`$.mobile.changePage`**直接在你的`onLoadNewsSuccess`函数中使用。

我相信代码应该是这样的：

```
function loadNewsFromDB(callback){
//some code here
theDB.transaction(function(tx) {
    tx.executeSql(sqlStr, [], function(tx, result) {
            ...some code here...;
            if (callback) {
                callback();
            }    
        },onLoadNewsError);
},onTxError, onTxSuccess); 
```

* * *

编辑：
回答评论中的问题：

*   在您的代码中，您正在为事件`$(function()`添加侦听器 。`$('#news_link').click`
*   在此侦听器中，您告诉 Jquery 调用`loadNewsFromDB`函数并将以下回调函数作为参数发送给它：`function(){ $.mobile.changePage( $("#news"), { transition: "slideup"}`.

发送回调函数是不够的，你应该在你的代码中使用它（调用它）。
为了使用它，我做了以下事情：

*   现在更改了函数定义 ，它确实有一个新参数：（这是您可以用来回调回调函数的名称）。**`function loadNewsFromDB(callback)`**
    **`callback`**

*   在您的`loadNewsFromDB`函数中，您正在调用该 **`transaction`**函数，并向其发送 3 个参数：**内联函数**、onTxError、onTxSuccess。
    您的**内联函数**只需调用该`tx.executeSql`函数并向其发送 4 个参数：`sqlStr, [], onLoadNewsSuccess, onLoadNewsError`.
    我更改了第三个参数。
    我没有调用`onLoadNewsSuccess`函数，而是**内联编写了所需的函数**

*   在内联函数中，我检查了回调函数`if (callback)`
    是否存在，如果存在，我调用它！ 调用回调函数，应该改变页面...**`callback();`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:34:38.780

你的意思是在 changePage 触发之前？

然后使用`pagebeforechange`事件，该事件在`changePage`. 我正在使用这个：

```
 $(document).on( "pagebeforechange", function( e, data ) {
  // do stuff
  console.log( e )
  console.log( data )
  }); 
```

对于我所有的 changePage 重定向。该`data`对象将包含所有 changePage 参数（如 toPage、options.fromPage...），因此您几乎可以根据需要重新配置 changePage 调用。

**编辑**`pushstate`：还要注意如果启用此事件会触发两次。一个事件是由实际转换（在 hashChange 上）触发的，这将传递`toPage`你将要作为`string`. 第二个事件将由 pushState 触发，并将传递`toPage`as `object`。您可以通过检查以下内容来定义要做什么：

```
 typeof data.toPage == 'string' 
```

**编辑**：在您的具体情况下，我会根据从数据库中获取数据所需的时间来`preventDefault()`选择原始文件。`changePage`最好从 pageBeforeChange 内部，当您加载数据后，`preventDefault`创建一个新的 changePage。有关更多信息，请参阅 JQM 文档中的此[示例](http://jquerymobile.com/test/docs/pages/page-dynamic.html)。`trigger your database call``trigger`

# nbug - N错误文档

> ID：12253051
> 
> 赞同：2
> 
> 时间：2012-09-03T19:21:53.063
> 
> 标签：nbug

有谁知道在哪里可以找到 NBug 1.1.1 的文档？

我发现了几个断开的链接，包括 N Bug 网站上的链接。我无法发布到 NBug 网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:21:53.063

我下载了最新的源代码，安装了 SandCastle 并构建了一个 .chm 文件。你可以在这里找到它：http: [//tinyurl.com/c5uxyho](http://tinyurl.com/c5uxyho)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-08T15:34:26.927

已编译的 CHM 可从 GitHub[站点](https://github.com/soygul/NBug/tree/master/Documentation/chm)获得。

下载查看时不要忘记“取消阻止”RAW文件。

# javascript - 仅在编辑非空文本框时生成警报的脚本

> ID：12253055
> 
> 赞同：-2
> 
> 时间：2012-09-03T19:22:34.413
> 
> 标签：javascript

我想找到并使用仅在编辑非空文本框时才产生警报的脚本。此外，我希望警报询问他的用户是否真的想要进行编辑并恢复文本，如果不是。这种存在还是可以用javascript开发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:46:14.323

试试这个[小提琴](http://jsfiddle.net/SNAG12/5Sp4d/)

也尝试发布您尝试过的内容

# php - 通过变量值获取常量值

> ID：12253057
> 
> 赞同：2
> 
> 时间：2012-09-03T19:23:00.913
> 
> 标签：php

我需要获取一个常量值。常量名存储在变量中。

```
<?php

define('SomeConstant', 12345);

$variable = 'SomeConstant';

?> 
```

我将如何使用变量回显“12345”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T19:27:19.127

使用[常量函数](http://php.net/manual/en/function.constant.php)

```
echo constant($variable); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:26:41.780

```
<?php

define('SomeConstant', 12345);

$variable = SomeConstant;

echo $variable;

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T19:27:21.580

使用[`constant`](http://php.net/manual/en/function.constant.php)：

```
<?php
define('SomeConstant', 12345);
$variable = 'SomeConstant';
assert(SomeConstant == constant($variable));
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T19:49:14.350

为什么不按照它的意思使用定义：

```
define('SomeConstant', 12345);

$variable = SomeConstant;
echo  SomeConstant; 
```

# php - 我必须对数据库中的西班牙语字符使用什么类型的排序规则？

> ID：12253058
> 
> 赞同：3
> 
> 时间：2012-09-03T19:23:02.560
> 
> 标签：php, html, database

我需要在我的数据库中存储一个带有西班牙语问题和答案的表格，但我遇到的问题是我尝试的任何方式都无法使用西班牙语字母表中的特殊字符（¿，ñ， á、é 等）显示在我的字符串输出中。我看到一些字符在我的数据库中（á、é、í、ó、ú），但没有显示在我的字符串中。¿ 甚至无法进入我的数据库。然后 ñ 不在我的数据库中，而是我看到了 ? 象征。在所有情况下，我在 php 文件输出中的字符串都为空。我应该怎么做才能解决这个问题并获得正确的输出？谢谢。

这是我的数据库的样子：

![在此处输入图像描述](../Images/f828d3f649c13b71ea063534c065a205.png)

这是我在我的 php 文件中使用的代码

```
<?php

$databasehost = "localhost";
$databasename = "Cuestionario";
$databaseusername ="user";
$databasepassword = "password";

$con = mysql_connect($databasehost,$databaseusername,$databasepassword) or  die(mysql_error());
mysql_select_db($databasename) or die(mysql_error());

$query = "SELECT * FROM Cuestionario_Spanish";
$sth = mysql_query($query);

if (mysql_errno()) { 
header("HTTP/1.1 500 Internal Server Error");
echo $query.'\n';
echo mysql_error(); 
}
else
{
$rows = array();
while($r = mysql_fetch_assoc($sth)) {
    $rows[] = $r;
}
print json_encode($rows);
}

?> 
```

这是我得到的结果：

![在此处输入图像描述](../Images/6ab9a7c1da26b5f36bb6f917ee8f1ead.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:29:33.933

您只需要定义字符集。

```
<?php

$databasehost = "localhost";
$databasename = "Cuestionario";
$databaseusername ="user";
$databasepassword = "password";

$con = mysql_connect($databasehost,$databaseusername,$databasepassword) or  die(mysql_error());
mysql_select_db($databasename) or die(mysql_error());
mysql_query("SET NAMES 'utf8'"); //This will FORCE SET CHARSET to utf-8

$query = "SELECT * FROM Cuestionario_Spanish";
$sth = mysql_query($query);

if (mysql_errno()) { 
header("HTTP/1.1 500 Internal Server Error");
echo $query.'\n';
echo mysql_error(); 
}
else
{
$rows = array();
while($r = mysql_fetch_assoc($sth)) {
    $rows[] = $r;
}
print json_encode($rows);
}

?> 
```

享受！:)

# python - 在 Python 中排队 HTTP、电子邮件和 TCP 消息

> ID：12253063
> 
> 赞同：0
> 
> 时间：2012-09-03T19:23:21.273
> 
> 标签：python, rabbitmq, message-queue, django-celery

我有一个将不同类型的消息（HTTP、SMTP、POP、IMAP 和常规 TCP）发送到不同系统的系统，并且我需要在我的系统中对所有这些消息进行排队，以防其他系统不可用。

我对消息队列概念有点陌生。所以我不知道我应该去的最好的python库。

Django-celery（以及下属组件——RabbitMQ、MySql、django、apache）是我的最佳选择吗？这个图书馆能满足我的所有需求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:42:43.603

试试 Pika 客户端或 Kombu 客户端。Celery 是一个完整的作业队列框架，您可能不需要它 - 但如果您想了解队列用例，值得一看。

# java - 尝试将 JButton 用作 InputStream

> ID：12253065
> 
> 赞同：1
> 
> 时间：2012-09-03T19:23:26.643
> 
> 标签：java, swing, gdb, inputstream, runtime.exec

目前我正在尝试制作自己的 GDB 前端。到目前为止，一切都在顺利进行，除了一部分。管道输入到过程中，一旦它被打开。我将在下面的代码中包含一个示例：

```
 private JButton run = new JButton("Run");
    JToolBar vertical = new JToolBar(JToolBar.VERTICAL);
    vertical.add(run);
    add(vertical, BorderLayout.WEST);

    run.addActionListener(new ActionListner()
    {
        public void actionPerformed(ActionEvent arg0)
        {
            Process proc;
            proc = Runtime.getRuntime().exec("gdb");
            proc = Runtime.getRuntime().exec("r");
        }
    } 
```

这将允许我运行命令“gdb”并将其所有输出通过管道传输到我的 TextArea，但在那之后，该进程关闭并且我不能再对同一进程运行诸如“r”之类的命令，而是打开另一个一个并尝试自己执行命令“r”；那么我有什么办法可以在同一个过程中执行这些吗？另外，因为这将是一个 GUI，我需要多个按钮能够与同一个进程交互，即按钮“运行”需要能够执行“r”，而“断点”按钮需要对同一个进程执行'b'，这可能吗？

TL;DR：需要通过使用 GUI 从 Java 中的同一进程运行多个系统命令，这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T19:29:10.187

```
final PrintWriter out = new PrintWriter(proc.getOutputStream());
out.println("r"); 
```

它们不是单独的进程，而是输入到`gdb`. :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:29:48.367

您需要抽象您与 GDB 的交互。我会制作特殊的接口“DebugWithGDB”并声明诸如启动/停止/断点/等的方法

在您的情况下，您正试图将 GDB 与事件调用（actionPerformed）结合起来，此外 - 产生两个不同的进程。

我的类中有一个变量，这个变量将保存该接口的实现。因此，所有按钮都将引用该变量，并能够在其上调用命令。

还可以考虑使用[http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html)以免冻结您的 GUI（它会为您将操作放入主队列线程）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:30:39.753

You just need to get the streams of the process to manipulate it. You must read this: [http://www.javaworld.com/jw-12-2000/jw-1229-traps.html](http://www.javaworld.com/jw-12-2000/jw-1229-traps.html).

Here is an example of executind commands in one process: [Sending commands to a console application?](https://stackoverflow.com/questions/12013721/sending-commands-to-a-console-application/12013910#12013910)

# magento - 为什么我会收到 _setActiveMenu 和 _addBreadcrumb 的错误？

> ID：12253068
> 
> 赞同：0
> 
> 时间：2012-09-03T19:23:32.137
> 
> 标签：magento

> 致命错误：在第 8 行的 /home/desbest/public_html/clients/magentofull/app/code/local/Desbest/Brands/controllers/Adminhtml/BrandsController.php 中调用未定义的方法 Desbest_Brands_Adminhtml_BrandsController::_addBreadcrumb()
> 
> 致命错误：在第 7 行的 /home/desbest/public_html/clients/magentofull/app/code/local/Desbest/Brands/controllers/Adminhtml/BrandsController.php 中调用未定义的方法 Desbest_Brands_Adminhtml_BrandsController::_setActiveMenu()

据我所知，`Data.php`文件夹内的`Helpers/`文件应该保留，因为它是空白的，就像教程所说的那样。

那么这些错误是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T19:37:31.590

似乎您的控制器类是从`Mage_Core_Controller_Front_Action`. 您应该`Mage_Adminhtml_Controller_Action`改为从类中扩展它，因为只有它具有称为`_addBreadcrumb()`和的方法`_setActiveMenu()`。

# windows - 如何将软件注册为 Windows 7 的防病毒软件？

> ID：12253069
> 
> 赞同：4
> 
> 时间：2012-09-03T19:23:35.160
> 
> 标签：windows, registry, wmi, antivirus

我知道我们可以使用 WMI 来检索有关已安装安全应用程序及其状态的信息（如果有），就像此处链接中的答案[1](https://stackoverflow.com/questions/1331887/detect-antivirus-on-windows-using-c-sharp)一样。问题是：如何走相反的路？

我的意思是，我正在尝试制作我的个人防病毒软件（我知道，大、巨大、难，有些人会认为我在开玩笑，我对所有这些都很好）。我想知道如何将我的软件注册为 Windows 7 的防病毒软件？我正在使用 C# 顺便说一句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-03T20:42:04.810

我猜你可以通过在 SecurityCenter 中添加一个密钥来使用注册表来做到这一点。

在 Windows XP 上称为 SecurityCenter 在 Windows Vista、7、8 上称为 SecurityCenter2

# apache-camel - Tanuki 服务包装器启动 Camel OK 并立即将其关闭

> ID：12253074
> 
> 赞同：1
> 
> 时间：2012-09-03T19:24:11.547
> 
> 标签：apache-camel, java-service-wrapper

我正在尝试将 tanuki 服务包装器上的 Camel（基于 Spring）项目作为 Windows 服务运行。我尝试了集成方法 #1 和 #2：WrapperSimpleApp、WrapperStartStopApp 并且都导致了以下行为：

**骆驼开始正常，包装器立即将其关闭！**

起初我怀疑这与 Camel 非守护线程有关，但在使用了集成方法和 org.tanukisoftware.wrapper.WrapperStartStopApp.systemThreadCount 系统属性之后，我意识到 wrapper 关闭 JVM 肯定还有另一个原因。

**有人会知道为什么吗？**

这是包装器和骆驼日志 - 注意第 2 行和第 3 行：

```
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | 2012-09-01 20:39:45,596     INFO  spring.SpringCamelContext Apache Camel 2.6.0 (CamelContext: main-camel-context) started in 1.450 seconds
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | WrapperSimpleApp Debug: main method completed
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | WrapperManager Debug: ShutdownHook started
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | WrapperManager Debug: WrapperManager.stop(0) called by thread: Wrapper-Shutdown-Hook
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | WrapperManager Debug: Send a packet STOP : 0
INFO   | jvm 1    | 2012/09/01 20:39:45.643 | srvmain | WrapperManager Debug: Pausing for 1,000ms to allow a clean shutdown...
DEBUG  | wrapperp | 2012/09/01 20:39:45.643 | srvmain | read a packet STOP : 0
DEBUG  | wrapper  | 2012/09/01 20:39:45.643 | srvmain | JVM requested a shutdown. (0)
DEBUG  | wrapper  | 2012/09/01 20:39:45.643 | srvmain | wrapperStopProcess(0, FALSE) called.
DEBUG  | wrapper  | 2012/09/01 20:39:45.643 | srvmain | Sending stop signal to JVM
DEBUG  | wrapperp | 2012/09/01 20:39:45.643 | srvmain | send a packet STOP : NULL
INFO   | jvm 1    | 2012/09/01 20:39:45.752 | srvmain | WrapperManager Debug: Received a packet STOP :
INFO   | jvm 1    | 2012/09/01 20:39:45.752 | srvmain | WrapperManager Debug: Stopped checking for control events.
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: Thread, Wrapper-Shutdown-Hook, handling the shutdown process.
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: calling listener.stop()
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperSimpleApp Debug: stop(0)
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: returned from listener.stop() -> 0
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: shutdownJVM(0) Thread: Wrapper-Shutdown-Hook
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: wait for 0 shutdown locks to be released.
INFO   | jvm 1    | 2012/09/01 20:39:46.735 | srvmain | WrapperManager Debug: Send a packet STOPPED : 0
DEBUG  | wrapperp | 2012/09/01 20:39:46.735 | srvmain | read a packet STOPPED : 0
DEBUG  | wrapper  | 2012/09/01 20:39:46.735 | srvmain | JVM signaled that it was stopped.
INFO   | jvm 1    | 2012/09/01 20:39:46.954 | srvmain | WrapperManager Debug: Closing backend connection.
INFO   | jvm 1    | 2012/09/01 20:39:46.954 | srvmain | WrapperManager Debug: Closed backend socket (Normal): java.net.SocketException: socket closed
INFO   | jvm 1    | 2012/09/01 20:39:46.954 | srvmain | WrapperManager Debug: Returned from backend handler.
DEBUG  | wrapperp | 2012/09/01 20:39:46.954 | srvmain | socket read no code (closed?).
DEBUG  | wrapperp | 2012/09/01 20:39:46.954 | srvmain | Closing backend socket.
INFO   | jvm 1    | 2012/09/01 20:39:47.500 | srvmain | WrapperManager Debug: Server daemon shut down
INFO   | jvm 1    | 2012/09/01 20:39:47.500 | srvmain | WrapperManager Debug: ShutdownHook complete
ERROR  | wrapper  | 2012/09/01 20:40:07.608 | srvmain | Shutdown failed: Timed out waiting for the JVM to terminate.
ERROR  | wrapper  | 2012/09/01 20:40:07.827 | srvmain | JVM did not exit on request, terminated
STATUS | wrapper  | 2012/09/01 20:40:08.778 | srvmain | <-- Wrapper Stopped 
```

这是我在 Camel（独立）上运行的线程转储：

```
"RMI TCP Connection(idle)" daemon prio=6 tid=0x000000000f194800 nid=0x1a24 waiting on condition [0x000000001062e000]
"RMI TCP Connection(6)-10.244.123.73" daemon prio=6 tid=0x000000000f194000 nid=0x1218 runnable [0x000000001038e000]
"RMI TCP Connection(4)-10.244.123.73" daemon prio=6 tid=0x000000000f193000 nid=0x188c in Object.wait() [0x00000000104ad000]
"RMI TCP Connection(idle)" daemon prio=6 tid=0x000000000eb1f000 nid=0xbf8 waiting on condition [0x000000001020f000]
"JMX server connection timeout 20" daemon prio=6 tid=0x000000000e4e1800 nid=0x1804 in Object.wait() [0x00000000100af000]
"RMI TCP Connection(idle)" daemon prio=6 tid=0x000000000eba3000 nid=0x10e8 waiting on condition [0x000000000fe7e000]
"RMI Scheduler(0)" daemon prio=6 tid=0x000000000f5c3000 nid=0x103c waiting on condition [0x000000000ff8f000]
"RMI TCP Connection(idle)" daemon prio=6 tid=0x000000000e0d0800 nid=0xd5c waiting on condition [0x000000000fd1e000]
"Camel (main-camel-context) thread #1 - file://./toAggregator" daemon prio=6 tid=0x000000000e0bf800 nid=0x18e4 runnable [0x000000000dcaf000]
"Camel (main-camel-context) thread #0 - AggregateTimeoutChecker" daemon prio=6 tid=0x000000000ecad800 nid=0x1b54 waiting on condition [0x000000000fb6f
"RMI TCP Accept-0" daemon prio=6 tid=0x000000000d4e6800 nid=0x1ba0 runnable [0x000000000de0e000]
"RMI TCP Accept-7780" daemon prio=6 tid=0x000000000d586800 nid=0xff0 runnable [0x000000000e8fe000]
"RMI TCP Accept-0" daemon prio=6 tid=0x000000000d55e000 nid=0x38c runnable [0x000000000e7df000]
"Service Thread" daemon prio=6 tid=0x000000000b7d3800 nid=0x1980 runnable [0x0000000000000000]
"C2 CompilerThread1" daemon prio=10 tid=0x000000000b7d0800 nid=0x1be4 waiting on condition [0x0000000000000000]
"C2 CompilerThread0" daemon prio=10 tid=0x000000000b7c3800 nid=0x594 waiting on condition [0x0000000000000000]
"Attach Listener" daemon prio=10 tid=0x000000000b7c2800 nid=0x10bc runnable [0x0000000000000000]
"Signal Dispatcher" daemon prio=10 tid=0x000000000b7bb000 nid=0x1b2c waiting on condition [0x0000000000000000]
"Finalizer" daemon prio=8 tid=0x0000000002416000 nid=0x1b94 in Object.wait() [0x000000000cd5e000]
"Reference Handler" daemon prio=10 tid=0x000000000240f000 nid=0x9a0 in Object.wait() [0x000000000caae000]
"Thread-1" prio=6 tid=0x000000000e530800 nid=0xc50 runnable [0x000000000da7f000]
"DestroyJavaVM" prio=6 tid=0x000000000231f000 nid=0x199c in Object.wait() [0x00000000026ff000]
"VM Thread" prio=10 tid=0x000000000b732800 nid=0x17a0 runnable
"GC task thread#0 (ParallelGC)" prio=6 tid=0x0000000002365000 nid=0x1a94 runnable
"GC task thread#1 (ParallelGC)" prio=6 tid=0x0000000002367000 nid=0x4e8 runnable
"GC task thread#2 (ParallelGC)" prio=6 tid=0x0000000002368800 nid=0xf44 runnable
"GC task thread#3 (ParallelGC)" prio=6 tid=0x000000000236a000 nid=0xd30 runnable
"VM Periodic Task Thread" prio=10 tid=0x000000000d4fb800 nid=0x384 waiting on condition 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T05:21:14.487

从 Apache Camel 阅读此常见问题解答：http: [//camel.apache.org/running-camel-standalone-and-have-it-keep-running.html](http://camel.apache.org/running-camel-standalone-and-have-it-keep-running.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:39:11.310

好吧，由于骆驼的启动方式，问题确实是非守护线程湖。

Camel 是使用 oeg.apache.camel.spring.Main.start() 而不是 run() 启动的。

start() 只是在主线程上启动 Camel 以某种方式继续运行。这适用于在应用程序中运行时。另一方面，run() 会阻塞主线程，直到 Camel 或 JVM 退出。

调用 enableHangupSupport() 来注册一个关闭钩子以允许 Camel 在 JVM 退出时正常关闭也很有用。

我必须在应得的地方给予赞扬 :-) 感谢 tanuki java service wrapper 的超级专业团队为我解决了这个问题。

# css - CSS前缀实现跨浏览器渐变

> ID：12253075
> 
> 赞同：0
> 
> 时间：2012-09-03T19:24:14.797
> 
> 标签：css

我希望实现跨浏览器渐变，如果您检查右上角的锚点与我的移动网站的品牌内联运行，它已使用 Firefox 的前缀 moz 进行样式设置：

[www.test-bed.co.uk/mobile/](http://www.test-bed.co.uk/mobile/)

```
background: -moz-linear-gradient(center top , #4A4A4A, #2C2C2C) repeat scroll 0 0 transparent; 
```

请问有没有类似的方法可以实现IE、Opera和webkit前缀的跨浏览器渐变方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:29:43.377

为所有现代浏览器自动生成 CSS 渐变规则的在线工具：[little link](http://www.colorzilla.com/gradient-editor/)。

但一般来说，这是主要语法：

```
background: #color; /*fallback*/
background: -moz-linear-gradient(...);/*Firefox*/
background: -webkit-gradient(...);/*Chrome + Safari*/
background: -webkit-linear-gradient(...);/*Another Chrome + Safari*/
background: -o-linear-gradient(...); /*Opera*/
background: -ms-linear-gradient(...); /*IE10+*/
background: linear-gradient(...); /*W3C standards*/
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#color', endColorstr='#color',GradientType=0); /*IE6-9*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:15:00.247

如果您使用 firefox 作为浏览器。那么您可能需要使用名为 colorzilla 的插件。这是一个不错的工具，带有颜色选择器、滴管、调色板浏览器、**CSS 渐变生成器**、网页 DOM 代码分析器、检查最后一个元素以及缩放等选项。

但是，您可以在以下链接中生成 css 渐变：

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:50:42.067

请看一下[CSS3](http://css3please.com/)。我个人喜欢他们的缩进风格。

```
.box-gradient {
  background-color: #444444;
  background-image: -webkit-gradient(linear, left top, left bottom, from(#444444), to(#999999)); /* Safari 4+, Chrome */
  background-image: -webkit-linear-gradient(top, #444444, #999999); /* Chrome 10+, Safari 5.1+, iOS 5+ */
  background-image:    -moz-linear-gradient(top, #444444, #999999); /* Firefox 3.6-15 */
  background-image:      -o-linear-gradient(top, #444444, #999999); /* Opera 11.10-12.00 */
  background-image:         linear-gradient(to bottom, #444444, #999999); /* Firefox 16+, IE10, Opera 12.50+ */
} 
```

如您所见，由于[IE10 立即支持 W3C 语法](http://blogs.msdn.com/b/ie/archive/2012/06/25/unprefixed-css3-gradients-in-ie10.aspx)`-ms-`，因此不需要前缀。请确保您使用正确的W3C[语法](http://www.w3.org/TR/2012/CR-css3-images-20120417/#linear-gradients)！`linear-gradient()`

# java - Android Java GoogleMap 如何判断 AVD 中正在运行的活动

> ID：12253077
> 
> 赞同：1
> 
> 时间：2012-09-03T19:24:29.080
> 
> 标签：java, android, google-maps

我在 Eclipse（google-map Android）中有一个项目，它有三个 Activity 类。当我单击运行时，我希望 mainActivity 首先打开，但我不认为它是打开的，因为当这个人在 AVD 中运行时，它会打开一个未在下面的类中定义的位置。如何在我的 Eclipse 项目中指定启动 Activity？

```
public class LocalGeoPoints {

    public Vector<OverlayItem> overlayitems;

    public LocalGeoPoints()
    {
        overlayitems = new Vector<OverlayItem>();
        populate();
    }

    void populate()
    {
           GeoPoint point = new GeoPoint(19240000,-99120000);
            //OverlayItem overlayitem = new OverlayItem(point, "Hola, Mundo!", "I'm in Mexico City!");
            CustomOverlayItem overlayItem = new CustomOverlayItem(point, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
          //try adding another one 
            GeoPoint point2 = new GeoPoint(419027880,  -876874637);
           // OverlayItem overlayitem2 = new OverlayItem(point2, "Sekai, konichiwa!", "I'm in Japan!");
           CustomOverlayItem overlayItem2 = new CustomOverlayItem(point2, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point3 = new GeoPoint( 419143417,  -876520184);
           // OverlayItem overlayitem3 = new OverlayItem(point3, "Chicago, WrigleyVile!", "I'm in Japan!");
           CustomOverlayItem overlayItem3 = new CustomOverlayItem(point3, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point4 = new GeoPoint(419054711, -87673388);
            //OverlayItem overlayitem4 = new OverlayItem(point4, "Chicago, BuckTown!", "I'm in Japan!");
           CustomOverlayItem overlayItem4 = new CustomOverlayItem(point4, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point5 = new GeoPoint( 419054431, -876697719);
            //OverlayItem overlayitem5 = new OverlayItem(point5, "Chicago, Ukrainian Village!", "I'm in Japan!");
           CustomOverlayItem overlayItem5 = new CustomOverlayItem(point5, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point6 = new GeoPoint(419095912, -876762629);
            //OverlayItem overlayitem6 = new OverlayItem(point6, "Chicago, Wicker Park!", "I'm in Japan!");
           CustomOverlayItem overlayItem6 = new CustomOverlayItem(point6, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point7 = new GeoPoint(419104535, -876774752);
           //OverlayItem overlayitem7 = new OverlayItem(point7, "Chicago, Damen & Milwaukee!", "I'm in Japan!");
           CustomOverlayItem overlayItem7 = new CustomOverlayItem(point7, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point8 = new GeoPoint(419118028, -876642466);
            //OverlayItem overlayitem8 = new OverlayItem(point8, "Chicago, Division!", "I'm in Japan!");
           CustomOverlayItem overlayItem8 = new CustomOverlayItem(point8, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point9 = new GeoPoint(419143617,  -876532656);
           // OverlayItem overlayitem9 = new OverlayItem(point9, "Chicago, Humboldt Park!", "I'm in Japan!");
           CustomOverlayItem overlayItem9 = new CustomOverlayItem(point9, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point10 = new GeoPoint(419141102,  -876567471);
            //OverlayItem overlayitem10 = new OverlayItem(point10, "Chicago, Ashland!", "I'm in Japan!");
           CustomOverlayItem overlayItem10 = new CustomOverlayItem(point10, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");
            //try adding another one 
            GeoPoint point11= new GeoPoint(419032033, -876770782);
            //OverlayItem overlayitem11 = new OverlayItem(point11, "Chicago, Levitt!", "I'm in Japan!");
           CustomOverlayItem overlayItem11 = new CustomOverlayItem(point11, "Tomorrow Never Dies (1997)", 
                    "(M gives Bond his mission in Daimler car)", 
                    "http://ia.media-imdb.com/images/M/MV5BMTM1MTk2ODQxNV5BMl5BanBnXkFtZTcwOTY5MDg0NA@@._V1._SX40_CR0,0,40,54_.jpg");

            overlayitems.add(overlayItem);
            overlayitems.add(overlayItem2);
            overlayitems.add(overlayItem3);
            overlayitems.add(overlayItem4);
            overlayitems.add(overlayItem5);
            overlayitems.add(overlayItem6);
            overlayitems.add(overlayItem7);
            overlayitems.add(overlayItem8);
            overlayitems.add(overlayItem9);
            overlayitems.add(overlayItem10);
            overlayitems.add(overlayItem11);

    }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:42:54.537

通过在项目的 AndroidManifest.xml 文件中定义意图过滤器来指定应用程序启动时应首先启动的活动的方式。这是一个例子

```
<activity
        android:label="MainActivity"
        android:name="yourprojectname.thenameoftheclass" >
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
</activity> 
```

# c# - 生成命名空间的 XML

> ID：12253082
> 
> 赞同：3
> 
> 时间：2012-09-03T19:25:13.573
> 
> 标签：c#, xml, linq-to-xml, xml-namespaces

我正在尝试向 ClaimTypesOffered 元素添加更多声明，如下所示：

```
<fed:ClaimTypesOffered>
  <auth:ClaimType Uri="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" Optional="true" xmlns:auth="http://docs.oasis-open.org/wsfed/authorization/200706">
    <auth:DisplayName>Name</auth:DisplayName>
    <auth:Description>The name of the subject.</auth:Description>
  </auth:ClaimType>
</fed:ClaimTypesOffered> 
```

那里有很多命名空间的魔法，我正在努力解决它。仅仅获得正确的元素名称是很困难的。我已经尝试了以下所有方法：

```
new XElement(XNamespace.Get("auth") + "ClaimType", "somedata"); 
```

给

```
<ClaimType xmlns="auth">somedata</ClaimType> 
```

**和**

```
new XElement(XName.Get("{http://docs.oasis-open.org/wsfed/authorization/200706}auth"), "somedata"); 
```

给

```
<auth xmlns="http://docs.oasis-open.org/wsfed/authorization/200706">somedata</auth> 
```

**和**

```
new XElement("auth:ClaimType", "somedata"); 
```

给

```
System.Xml.XmlException : The ':' character, hexadecimal value 0x3A, cannot be included in a name. 
```

我正在寻求帮助以进一步解决这个问题，生成包含属性和内部元素的声明的完整示例将非常棒，即使朝着正确的方向进行小幅推动也将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:06:11.647

关键是在父元素上定义命名空间，然后子元素可以使用该命名空间。如果没有*新的 XAttribute(XNamespace.Xmlns + "auth", auth.NamespaceName)*，则命名空间以原始问题中所见的其他方式定义。

```
 XNamespace fed = "http://docs.oasis-open.org/wsfed/federation/200706";
        XNamespace auth = "http://docs.oasis-open.org/wsfed/authorization/200706";

        XElement root = new XElement(auth + "ClaimType",
            new XAttribute(XNamespace.Xmlns + "auth", auth.NamespaceName),
            new XAttribute("Uri", "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"),
            new XAttribute("Optional", "true"),
            new XElement(auth+"DisplayName", "EmployeeID"),
            new XElement(auth+"Description", "The employee's designated ID number.")
        );

        Console.WriteLine(root); 
```

# jmx - 将 MBeanServerConnection 注册为 MBeanServer 中的 MBean

> ID：12253083
> 
> 赞同：1
> 
> 时间：2012-09-03T19:25:34.383
> 
> 标签：jmx, mbeans

我认为聚合 JMX 聚合服务器已连接的远程 MBeanServer 会很有用，但我发现将 MBeanServerConnection 注册为 MBeanServer 中的 MBean 会引发不兼容的 MBean 异常。

肯定有人以前做过这个，因此我想知道是否有标准的方法来完成这个。当然，我可以为 MBeanServerConnection 创建所需的动态 MBean 或一些包装器，但是 - 正如我所说 - 这肯定是以前已经解决的问题，希望在标准包中。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T23:43:15.873

想通了。不是真正的标准（AFAIK），但已通过[级联或 MBeanServers 联合](https://blogs.oracle.com/jmxetc/entry/federating_mbeanservers_with_opendmk)解决了 比我想要的更复杂的问题，但提供了我需要的功能。

# rest - RestEasy 打开 html/jsp 页面

> ID：12253086
> 
> 赞同：2
> 
> 时间：2012-09-03T19:26:07.763
> 
> 标签：rest, resteasy, webpage-rendering, requesthandler

有一个 RestEasy 方法，它处理 @GET 请求。如何从该方法打开 jsp/html 页面？

```
@GET
@Path("/")
public void getMainPage(){
   //... 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T13:36:54.153

**[HtmlEasy](http://code.google.com/p/htmleasy/)**是一个通过 RestEasy 渲染 jsp 文件的好工具。

```
@Path("/")
public class Welcome {
    @GET @Path("/welcome/{name}")
    public View sayHi(@PathParm("name") String name) {
        return new View("/welcome.jsp", name);
    }
} 
```

有关所有选项，请参阅[文档](http://code.google.com/p/htmleasy/wiki/UsingHtmleasy)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-19T16:28:06.017

使用[org.jboss.resteasy.resteasy-html 3.0.6.Final 版本，](http://mvnrepository.com/artifact/org.jboss.resteasy/resteasy-html)您可以直接访问 HttpServletRequest 并在将输出定向到 RESTEasy 视图之前注入您自己的属性。

```
@GET
@Path("{eventid}")
@Produces("text/html")
public View getEvent(@Context HttpServletResponse response,
                     @Context HttpServletRequest request,
                     @PathParam("eventid") Long eventid){

    EventDao eventdao = DaoFactory.getEventDao();
    Event event = eventdao.find(eventid);

    request.setAttribute("event", event);
    return new View("eventView.jsp");
} 
```

这模拟了 Htmleasy 插件的某些行为，而无需重新连接您的 web.xml。

# python - 如何检查z3中的const是变量还是值？

> ID：12253088
> 
> 赞同：6
> 
> 时间：2012-09-03T19:26:17.643
> 
> 标签：python, z3

只是想在[z3py](http://rise4fun.com/z3py)中，如何检查给定的常量表达式是变量还是值？例如

```
x = Int('x')
x_ = IntVal(7)
ColorVal, (White,Black)  = EnumSort("ColorVal",["While","Black"])
mycolor = Const("mycolor",ColorVal) 
```

所以 x,mycolor 都是 variables 而 x_,True,False,White,Black 是 values 而不是 variables 。

z3py 有 is_var 谓词，但目的不同。如果我想将公式中的所有变量重命名为其他变量，这很有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T19:52:08.383

您所说的变量（技术上）在 Z3 中称为未解释的常量。值（例如`1`, `true`, `#x01`）称为解释常量。`a`因此，原则上，可以使用以下代码来快速检查是否是“变量”：

```
is_const(a) and a.decl().kind() == Z3_OP_UNINTERPRETED 
```

这段代码适用于所有东西，但数据类型除外。在尝试了您的示例后，我意识到 Z3 错误地返回`Z3_OP_UNINTERPRETED`了数据类型构造函数。我为 Z3 4.2 修复了这个问题。同时，您可以使用以下解决方法，其中函数`is_datatype_const_value(a)`返回`True`的`a`是一个常量构造函数。

```
def is_datatype_sort(s):
  return s.kind() == Z3_DATATYPE_SORT

def is_datatype_constructor(x):
  s = x.sort()
  if is_datatype_sort(s):
    n = s.num_constructors()
    f = x.decl()
    for i in range(n):
      c = s.constructor(i)
      if eq(c, f):
        return True
  return False 

# Return True if x is a constant constructor, that is, a constructor without arguments.
def is_datatype_const_value(x):
  return is_const(x) and is_datatype_constructor(x) 
```

然后，以下代码捕获所有未解释的常量：

```
 is_const(a) and a.decl().kind() == Z3_OP_UNINTERPRETED and not is_datatype_const_value(a) 
```

以下链接包含一个完整的示例。 [http://rise4fun.com/Z3Py/vjb](http://rise4fun.com/Z3Py/vjb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T17:26:33.460

对整数执行此操作的一种方法是使用`is_int`and `is_int_value`：

```
x = Int('x')
print "x types"
print is_int(x) # true, is of sort int
print is_int_value(x) # false, not a "value"

x_ = IntVal(7)
print "x_ types"
print is_int(x_) # true, is also of sort int
print is_int_value(x_) # true, is a value 
```

对于实数，您可以使用`is_real`来检查变量排序，并使用（的析取）`is_algebraic_value`和`is_rational_value`值（我没有`is_real_value`在 API 中看到类似的函数，但我认为这种析取会做到这一点）。对于位向量，您可以使用`is_bv_value`值，并`is_bv`检查变量排序。

.NET API 具有`Expr.IsNumeral`，您可以在此处查看这些 API 是如何实现的（例如，`Expr.IsIntNum`[相当于 Python `is_int_value`] 检查两者`Expr.IsNumeral`是否`Expr.IsInt`为真）：[http ://research.microsoft.com/en-us/嗯/redmond/projects/z3/_expr_8cs_source.html](http://research.microsoft.com/en-us/um/redmond/projects/z3/_expr_8cs_source.html)

我没有立即看到为自定义枚举排序执行此操作的方法。作为一种选择，您可以使用位向量对枚举进行编码，并使用`is_bv_value`. 不过，作为一种更好的解决方法，您似乎需要使用更通用的代数数据类型及其自动创建的“识别器”。如果您将它们声明为枚举排序，Python API 似乎无法正确创建识别器。这是一种有效的枚举排序方法（但声明为更通用的数据类型）。

Z3Py 编码如下：[http ://rise4fun.com/Z3Py/ELtn](http://rise4fun.com/Z3Py/ELtn)

```
ColorVal = Datatype('ColorVal')
ColorVal.declare('white')
ColorVal.declare('black')
ColorVal = ColorVal.create()

mycolor = Const("mycolor", ColorVal)

print ColorVal.recognizer(0) # is_white
print ColorVal.recognizer(1) # is_black

print simplify(ColorVal.is_white(mycolor)) # returns is_white(mycolor)
print simplify(ColorVal.is_black(mycolor)) # returns is_black(mycolor)

mycolorVal = ColorVal.white # set to value white
print simplify(ColorVal.is_white(mycolorVal)) # true
print simplify(ColorVal.is_black(mycolorVal)) # false

# compare "variable" versus "value" with return of is_white, is_black, etc.: if it gives a boolean value, it's a value, if not, it's a variable
print "var vs. value"
x = simplify(ColorVal.is_white(mycolor))
print is_true(x) or is_false(x) # returns false, since x is is_white(mycolor)
y = simplify(ColorVal.is_white(mycolorVal))
print is_true(y) or is_false(y) # true

ColorValEnum, (whiteEnum,blackEnum)  = EnumSort("ColorValEnum",["whiteEnum","blackEnum"])
mycolorEnum = Const("mycolorEnum",ColorValEnum)

print ColorValEnum.recognizer(0) # is_whiteEnum
print ColorValEnum.recognizer(1) # is_blackEnum

# it appears that declaring an enum does not properly create the recognizers in the Python API:
#print simplify(ColorValEnum.is_whiteEnum(mycolorEnum)) # error: gives DatatypeSortRef instance has no attribute 'is_whiteEnum'
#print simplify(ColorValEnum.is_blackEnum(mycolorEnum)) # error: gives DatatypeSortRef instance has no attribute 'is_blackEnum' 
```

# datatables - 如何更改分页链接宽度

> ID：12253100
> 
> 赞同：0
> 
> 时间：2012-09-03T19:27:35.073
> 
> 标签：datatables

我将 DataTables 链接翻译成巴西葡萄牙语，现在我遇到了链接宽度的问题，因为一些使用的单词比原来的英文单词长。如何调整这些链接的大小？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:38:49.970

你是怎么翻译的？
我试着翻译它，效果很好。
文本位于`span`哪个类中，`paginate_button`因此内容宽度没有问题，顺便说一句，您可以使用 css 对其进行样式设置。

只是一个例子：

```
.dataTables_paginate span.first,
.dataTables_paginate span.last {
    background-color: red;
} 
```

# linux - 用于访问 Linux 服务器上所有用户帐户目录的 Perl 脚本

> ID：12253108
> 
> 赞同：0
> 
> 时间：2012-09-03T19:28:30.923
> 
> 标签：linux, perl, accounts

我有一个专用的 Linux Web 服务器，上面有许多用户帐户。用户帐户都位于`/home/[userid]`目录中。我能够创建在我的每个用户帐户中运行的 Perl 脚本，这些脚本只能在他们自己的帐户中访问文件，但是现在我需要创建一个可以在用户帐户“上方”运行并能够访问任何指定用户的帐户中的文件。

目前，我有一个脚本用于`Net::FTP`从每个帐户中检索所需的文件，以便从中提取必要的数据，但当然，将 FTP 传输到每个帐户的速度很慢。由于帐户只是服务器上的目录，因此我正在寻找一种方法来运行 Perl 脚本，以便它可以访问每个帐户目录并简单地打开所需的文件并返回指定帐户的请求数据。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:34:42.030

您应该以有权访问所有用户目录的用户身份登录（例如`root`）。`sftp`出于安全原因，使用或其他一些加密连接可能更安全。

# spring-mvc - WELD-001408 注入点具有来自 org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter 的不满足依赖关系

> ID：12253110
> 
> 赞同：0
> 
> 时间：2012-09-03T19:28:38.547
> 
> 标签：spring-mvc

春季新手来了。我的 Spring MVC 3.0.2 应用程序从 Glassfish 3.0.1 收到以下错误：

```
rg.glassfish.deployment.common.DeploymentException: WELD-001408 Injection point has unsatisfied dependencies.  Injection point:  parameter 0 of constructor public controller.CustomWebArgumentResolverInstaller(org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter);  Qualifiers:  [@javax.enterprise.inject.Default()] 
```

我的 applicationContext.xml 有

```
<mvc:annotation-driven /> 
```

CustomWebArgumentResolverInstaller.java 如下：

```
package controller;

import javax.inject.Inject;

import org.springframework.stereotype.Component;
import org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter;
import org.springframework.web.bind.support.WebArgumentResolver;
import org.springframework.mobile.device.mvc.DeviceWebArgumentResolver;

@Component
public class CustomWebArgumentResolverInstaller {

@Inject
public CustomWebArgumentResolverInstaller(AnnotationMethodHandlerAdapter controllerInvoker) {
    WebArgumentResolver[] resolvers = new WebArgumentResolver[1];
    resolvers[0] = new DeviceWebArgumentResolver();
    controllerInvoker.setCustomArgumentResolvers(resolvers);
}
} 
```

任何关于寻找什么的想法都非常受欢迎。由于我是新手，因此我不确定与发布相关的内容，因此如果您需要其他信息，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T00:02:22.630

在您的情况下，看起来 JSR-330 注释（`@Inject`等`@Named`）是由 Glassfish 而不是 Spring 解决的。我不确定如何抑制这种情况，但一种解决方法可能是简单地使用 Spring 本机注释 ( `@Autowired`)。

# asp.net - 仅显示第一个系列数据的流程图

> ID：12253113
> 
> 赞同：1
> 
> 时间：2012-09-03T19:29:02.093
> 
> 标签：asp.net, asp.net-mvc, json, flot

我正在使用 flot 并返回 JSON，并提供了初始化，图表上只有第一个系列可见，但是，图例显示了所有 3 个系列标签。知道我做错了什么吗？

```
var data = [];

    function onDataReceived(seriesData) {

        var options = {
            series: { stack: false,
                lines: { show: true, steps: false },
                bars: { show: false, barWidth: 0.5, align: 'center', horizontal: true },
                points: { show: true, radius: 3, symbol: 'circle' }
            },
            yaxis: { show: true, tickLength: 0 },
            xaxis: { tickSize: [1, "month"], tickLength: 0, mode: 'time', timeformat: '%b %y' },
            legend: { show: true, container: $('#@(ctlId)chartLegend'), noColumns: 3 },
            grid: { borderWidth: 0, hoverable: true, clickable: true }

        };

        var p = $.plot($('#@(ctlId)'), seriesData.seriesData, options); 
```

还有我的 MVC 处理程序：

```
return Json(new
        {
            axisNames = new List<string[]>() { },
            seriesData = new[]
        {
            new {
            color = "#e17009",
            label = "RN",
            data = new List<string[]>() {
                new string[] {DateTime.Parse("7/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "4.2"},
                new string[] {DateTime.Parse("8/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "4.8"},
                new string[] {DateTime.Parse("9/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.5"},
                new string[] {DateTime.Parse("10/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "5.0"},
                new string[] {DateTime.Parse("11/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "3.6"}
                }
            },
            new {
            color = "#ff0000",
            label = "RA",
            data = new List<string[]>() {
                new string[] {DateTime.Parse("7/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "3.2"},
                new string[] {DateTime.Parse("8/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "3.8"},
                new string[] {DateTime.Parse("9/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "3.5"},
                new string[] {DateTime.Parse("10/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.0"},
                new string[] {DateTime.Parse("11/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.6"}
                }
            }
            ,
            new {
            color = "#5c9ccc",
            label = "RA",
            data = new List<string[]>() {
                new string[] {DateTime.Parse("7/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.2"},
                new string[] {DateTime.Parse("8/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.8"},
                new string[] {DateTime.Parse("9/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.5"},
                new string[] {DateTime.Parse("10/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "1.0"},
                new string[] {DateTime.Parse("11/12/2012", System.Globalization.CultureInfo.InvariantCulture).GetJavascriptTimestamp().ToString(System.Globalization.CultureInfo.InvariantCulture), "2.4"}
                }
            }
        }
        },
        JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:01:53.873

我终于解决了这个问题。Flot似乎没有希望在设置为FALSE时使用该选项呈现多个系列，`stack: false`并且您也引用`jquery.flot.stack.js`插件。删除`stack`下面代码中的属性解决了我的问题。如果您没有引用堆栈插件，您可以保留该`stack: false`属性，它也会正确显示附加系列。希望它可以帮助某人。

返回的 JSON 是正确的。

```
var data = [];

function onDataReceived(seriesData) {

    var options = {
        series: { 
            lines: { show: true, steps: false },
            bars: { show: false, barWidth: 0.5, align: 'center', horizontal: true },
            points: { show: true, radius: 3, symbol: 'circle' }
        },
        yaxis: { show: true, tickLength: 0 },
        xaxis: { tickSize: [1, "month"], tickLength: 0, mode: 'time', timeformat: '%b %y' },
        legend: { show: true, container: $('#@(ctlId)chartLegend'), noColumns: 3 },
        grid: { borderWidth: 0, hoverable: true, clickable: true }

    };

    var p = $.plot($('#@(ctlId)'), seriesData.seriesData, options); 
```

# visual-studio-2012 - 完全卸载 vs 2012 的任何快速修复

> ID：12253115
> 
> 赞同：5
> 
> 时间：2012-09-03T19:29:13.810
> 
> 标签：visual-studio-2012

Microsoft Visual Studio Professional 2012 RC - ENU 安装过程中出现致命错误。

Microsoft Visual Studio 2012 SharePoint 开发人员工具 RC enu 语言包包失败。

Microsoft Visual Studio 准备 系统找不到指定的文件

Microsoft Visual Studio Ultimate 2012 RC XAML UI Designer 核心包失败。Microsoft Visual Studio Team Foundation Server 2012 RC Team Explorer 语言包 - ENU 包失败。

# emacs - 如何让 emacs 将其备份文件与符号链接一起保存？

> ID：12253118
> 
> 赞同：1
> 
> 时间：2012-09-03T19:29:21.637
> 
> 标签：emacs

我在某个位置有文件：

```
location_a/doc.tex
location_a/doc.cls
... 
```

我想通过符号链接在另一个目录中处理它们：

```
work_directory/doc.tex -> location_a/doc.tex
work_directory/doc.cls -> location_a/doc.cls
work_directory/doc.pdf
work_directory/doc.log
... 
```

但是，当我`emacs doc.tex`在工作目录中运行并进行一些编辑时，emacs 会在`location_a/doc.tex~`. 不过，我希望将备份文件存储在工作目录中。我不希望在`location_a`.

我怎样才能让emacs做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T21:34:54.493

这比看起来应该的要棘手，因为在调用任何备份文件名构造机制*之前*`backup-buffer`，它坚持追逐缓冲区文件名的链接，例如. 结果是 Emacs 不允许自定义这种行为，除非重新定义，这是一段相当复杂的代码。*`make-backup-file-name-function``backup-buffer`*

 *我想出的一个折衷解决方案是安装一个“建议” ，在评估时`backup-buffer`暂时禁用它。这允许备份文件位于符号链接所在的目录中。但是，它也会导致 Emacs 通过重命名原始符号链接来创建备份，留下一个符号链接指向! 幸运的是，这很容易通过设置为来防止。`file-chase-links``backup-buffer``work_directory/doc.tex~``location_a/doc.tex``backup-by-copying``t`

这是代码。一个警告：虽然我已经尝试过它来验证它是否有效，但我不能保证它不会产生不良副作用，例如上述对所需的备份机制的干扰`backup-by-copying`。但是，它也可以正常工作 - 使用时要小心。

```
(require 'cl)  ; for flet
(defadvice backup-buffer (around disable-chase-links)
  (flet ((file-chase-links (file) file))
    ad-do-it))
(ad-activate 'backup-buffer) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T11:30:56.873

为了好玩，让我描述一种完全不同的方法，基于目录变量。

简而言之，您将放入`work-directory/`一个名为的文件`.dir-locals.el`，其中包含：

```
((nil . ((eval . (set (make-local-variable 'backup-directory-alist)
                      (list (cons "."
                                  (file-relative-name
                                   (file-name-directory (buffer-file-name))
                                   (file-name-directory (file-truename
                                                         (buffer-file-name))))))))))) 
```

这样做有点滥用`backup-directory-alist`. 并为您在`work-directory/`. 该本地版本将反过来确保任何备份文件都保存在`work-directory`.

为了实现这一点，我们需要两件事：

*   有类似`'(("." . "path/to/work-directory/"))`本地价值的东西
*   确保此路径相对于`location_a/`

第二点的原因是，正如其他地方所指出的，一旦符号链接被解析，起点`backup-buffer`确实是实际文件的位置。而且我们不能简单地放置绝对路径而不改变备份文件的形状（如果备份目录是绝对路径，备份文件名编码完整路径，这样就不会发生冲突）

笔记：

*   您需要确保特定的局部变量记录在`safe-local-variable-values`. 因为它是一种通用形式，所以它是一次性的工作（只需点击“！”第一次被问到它）
*   这假设`find-file-visit-truename`设置为 nil，但我想如果不是这种情况，你不会问这个问题 :)

该方法的优点：

*   不需要建议（这总是一件好事）
*   尽管它假定您的 Emacs 支持目录变量，但还是相当可移植的
*   您可以灵活地将其放置在您需要的地方

该方法的缺点：

*   好吧，显然你可能不得不`.dir-locals.el`在几个地方复制它

另请注意，如果您想要一种一次性方法，则可以使其更简单，例如：

```
((nil . ((backup-directory-alist (("." . "../path/to/work-directory")))))) 
```

您实际上在其中一劳永逸地自己计算相对名称。*

# java - Android Java Googlemap 找不到 android-mapviewballoons.apk

> ID：12253121
> 
> 赞同：1
> 
> 时间：2012-09-03T19:29:27.943
> 
> 标签：java, android, eclipse, google-maps

我在 Eclipse 中有一个 Android google-map 项目，我正在尝试使用在[https://github.com/jgilfelt/android-mapviewballoons](https://github.com/jgilfelt/android-mapviewballoons)中定义的气球类。我已经成功构建项目，并且我相信链接，但是当我去运行我的项目时，我收到错误消息

```
[2012-09-03 14:07:30 - android-mapviewballoons] Could not find android-mapviewballoons.apk! 
```

我不完全确定这意味着什么，因为我对 Android/Eclipse 和 Eclipse/Java 中的链接文件相当。因此，我将不胜感激任何有关如何解决此问题的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T10:36:19.497

我有这个完全相同的问题。如果您使用多个库，请确保 MapBalloons 是最上面的一个。不要问我为什么它不工作。

右键单击项目>>属性>> Android>>单击直到库位于顶部。

**确保也**添加了库单击添加>>选择库。清洁项目

![在此处输入图像描述](../Images/4b8ed62af56b36e84bce08797480454b.png)

# ruby-on-rails - 如何实现引用用户的多态关系？

> ID：12253124
> 
> 赞同：1
> 
> 时间：2012-09-03T19:29:34.217
> 
> 标签：ruby-on-rails, ruby, model, polymorphism

首先，我有一个多态关联设置，因为评论可以属于任何对象（在我的例子中是帖子和文章）。

我想能够说：

```
u = user.first
u.comments #This will list all comments from a user
u.comments.where(:commentable_type => "Post") 
```

上面这行不起作用。它生成一个 sql: SELECT "comments".* FROM "comments" WHERE "comments"."commentable_id" = 1 AND "comments"."commentable_type" = 'User' AND "comments"."commentable_type" = 'Post'

显然这将返回一个空列表，因为评论不能属于 2 种类型。我也想能够说：

```
f = Food.first
f.comments.first.user #give me the user that posted the first comment 
```

这是我的基本模型......关于改变这个的任何提示？

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
end

class Post < ActiveRecord::Base
  has_many :comments, :as => :commentable
end

class Article < ActiveRecord::Base
  has_many :comments, :as => :commentable
end

class User < ActiveRecord::Base
    has_many :comments, :as => :commentable
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:11:18.907

我认为您应该查看您的评论模型，它应该如下所示：

```
class Comment < ActiveRecord::Base
  belongs_to :user
  belongs_to :commentable, :polymorphic => true
end 
```

所以你会有两个关系，第一个将指向发表评论的人，另一个将指向被评论的对象。

```
Comment.first.user # this will return the user

Comment.first.commentable # this will return the object which the comment was attached (Post, Article or ?Food?) 
```

如果您想尝试这种方法，请不要忘记迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:24:56.347

您应该能够执行以下操作来实现您想要的：

`u.comments.map { |cmt| Post.find(cmt.commentable) }`

同样适用于文章。这将返回一组帖子或文章。如果它们不存在，它将给出错误，因此您必须为此进行修改。

我不完全理解你的第二个问题。如果 f.comments.first 只返回一条评论，那么 .user 应该返回该评论的用户，假设您正确设置了 User 和 Comment 类（用户 has_many comments / Comment belongs_to user，正如 Alexandre Abreu 指出的那样出），但也许我误解了你的问题。

# r - 从函数调用中提取函数调用名称

> ID：12253131
> 
> 赞同：6
> 
> 时间：2012-09-03T19:30:16.180
> 
> 标签：r, function, call

有谁知道如何编写一个函数*F*，它将函数调用（例如，mean(x = 1:10)）作为参数，并仅返回被调用函数的名称（mean）？

到目前为止，我的最佳尝试总结如下

```
(function(x1){

    return(deparse(substitute(x1)))

})(mean(x = 1:10))
### 'mean(x = 1:10)' 
```

在反解析之前将 x1 （函数调用）更改为表达式似乎没有多大帮助：返回

```
(function(x1){

    return(deparse(as.expression(substitute(x1))))

})(mean(x = 1:10))
# "expression(mean(x = 1:10))" 
```

如果可能的话，我也希望能够使用匿名函数作为参数，所以*F*应该为 (function(x) print (x))(1) 返回 (function(x) print (x))。如果您需要任何澄清，请随时发表评论。谢谢。

编辑1：请注意，我想避免检查第一个括号并删除它之前的代码（对于“mean（x = 1:10）”将返回“mean”），作为“bad（Fun_nAme”实际上是 R 中的合法函数名。

**已回答的问题：** Josh O'Brien 的回答很完美：满足上述条件的函数*F*是

```
F <- function(x) deparse(substitute(x)[[1]]) 
```

它适用于二元运算符、标准函数和匿名函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T20:15:19.687

这是一个简单的功能，可以满足您的要求：

```
F <- function(x) deparse(substitute(x)[[1]])

F(mean(x=1:10))
# [1] "mean"

F((function(x) print (x))(1))
# [1] "(function(x) print(x))"

F(9+7)
# [1] "+" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:41:11.703

我不知道您要做什么，或者这是否是一个好主意，或者这是否是您想要的，但这里有一个正则表达式：

```
FUN <- function(x1){
    z <- deparse(substitute(x1))
    list(fun=strsplit(z, "\\(")[[c(1, 1)]],
    eval=x1)
}

FUN(mean(x = 1:10)) 
```

# php - 列出每个类别的帖子数

> ID：12253132
> 
> 赞同：0
> 
> 时间：2012-09-03T19:30:16.677
> 
> 标签：php

试图获取一个代码来显示我的帖子的类别，但我在显示每个类别的帖子数量时遇到了问题。

好吧，您在查看代码时明白了我的意思，现在每个类别都列出了类别总数...

开始了：

```
<?php 
$listresult = mysql_query("SELECT distinct category FROM test_blog") 
or die(mysql_error());

$totalpostspercategory = mysql_num_rows($listresult); 

echo "<ul>";
  while($row = mysql_fetch_array( $listresult )) {

if (strlen($row['category']) > 45) {
    $row['category'] = substr($row['category'],0,45) . " ...";
} 

echo "<li><a href='index.php?category=" . $row['id'] . "'>" . $row['category'] ."</a> (" . $totalpostspercategory . ")</li>";
}
echo "</ul>";

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:39:38.113

假设您的表看起来像这样。. .

```
create table your_table (
  blog_post_id integer not null,
  category varchar(35) not null,
  primary key (blog_post_id, category)
);

insert into your_table values (1, 'food');
insert into your_table values (1, 'recipes');
insert into your_table values (1, 'tofu');
insert into your_table values (2, 'food');
insert into your_table values (3, 'tofu');
insert into your_table values (3, 'vacation'); 
```

您可以通过以下方式直接使用 SQL 获取计数

```
select category, count(*) num_posts
from your_table
group by category
order by category;

category  count
--
food      2
recipes   1
tofu      2
vacation  1 
```

# c++ - 使用指针访问类的私有或受保护数据

> ID：12253133
> 
> 赞同：0
> 
> 时间：2012-09-03T19:30:22.540
> 
> 标签：c++, class, pointers

假设我们有两个函数（不是任何类成员）：

```
int input_int (int *p)
{
 p[0] = 10;
 return p[0];
}

char input_char (char *p)
{
 p[0] = 5;
 return p[0];
} 
```

还有一些课程：

```
class foo {
   public:
      foo();
      void some_usefull_stuff() {
           int i = input_int( &(this->A) );
      }
   protected:
      void feature_for_usefull_stuff() {
           char chr = input_char( &(this->B) );
      }
      int A;
   private:
      char B;
}; 
```

函数 input_char 和 input_int 能正常工作吗？他们不会产生分段错误或任何异常吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:32:38.100

是的，它们会正常工作，传递给方法的地址是正确的，并且指向正确的数据类型。

# java - 为 OSX 导出 Jar 时出现 PNG 错误

> ID：12253135
> 
> 赞同：1
> 
> 时间：2012-09-03T19:30:29.863
> 
> 标签：java, macos, png, lwjgl

我正在使用 LWJGL 和 Slick 来加载我的图像。我导出了我的 jar 并使用 JarSplice 创建了一个胖 jar，其中包含 Windows 和 OSX 的依赖项。该 jar 在 Windows 上完美运行，但在 OSX 上我收到以下错误，涉及我的 PNG 资产。

```
java.io.IOException: unsupported interlace method
 at org.newdawn.slick.opengl.PNGImageData.readIHDR(PNGImageData.java:398)
 at org.newdawn.slick.opengl.PNGImageData.init(PNGImageData.java:106)
 at org.newdawn.slick.opengl.PNGImageData.loadImage(PNGImageData.java:680)
 at org.newdawn.slick.opengl.CompositeImageData.loadImage(CompositeImageData.java:62)
 at org.newdawn.slick.opengl.CompositeImageData.loadImage(CompositeImageData.java:43)
 at     org.newdawn.slick.opengl.InternalTextureLoader.getTexture(InternalTextureLoader.java:277)
 at     org.newdawn.slick.opengl.InternalTextureLoader.getTexture(InternalTextureLoader.java:231)
 at     org.newdawn.slick.opengl.InternalTextureLoader.getTexture(InternalTextureLoader.java:171)
 at org.newdawn.slick.Image.<init>(Image.java:196)
 at org.newdawn.slick.Image.<init>(Image.java:170)
 at org.newdawn.slick.Image.<init>(Image.java:158)
 at org.newdawn.slick.Image.<init>(Image.java:136)
 at com.danielmessias.spaceshooter.SpaceShooter.loadImages(SpaceShooter.java:137)
 at com.danielmessias.spaceshooter.SpaceShooter.start(SpaceShooter.java:131)
 at com.danielmessias.spaceshooter.SpaceShooter.main(SpaceShooter.java:81) 
```

我已经重新保存了所有资产并重新导出而不隔行扫描，所以我不知道问题出在哪里。

感谢所有帮助，谢谢！

# php - PHP 的 MySQLi 模块

> ID：12253140
> 
> 赞同：0
> 
> 时间：2012-09-03T19:31:11.517
> 
> 标签：php, mysql, mysqli

我正在尝试安装具有以下安装要求的开源分类程序：

*   PHP 版本：5.x 或更高版本
*   MySQL数据库（或访问创建一个）
*   PHP 的 MySQLi 模块
*   PHP的GD模块

我在 Windows 7 上使用 XAMPP, 1.7.7 [PHP: 5.3.8]。

当我通过访问（按照指示）执行安装脚本时`index.php`，我收到以下错误消息：

警告：`mysqli::close() [mysqli.close]: Couldn't fetch mysqli in C:\xampp\htdocs\oc-includes\classes\database\DBConnectionClass.php on line 530`

注意：我使用的上述平台可以流畅地执行用 PHP、MySQL 等编写的其他代码。

我无法从 Xampp 或脚本的发布者那里找到有关上述内容的任何信息。我的问题是如何打开 PHP 的 MySQLi 模块，如果它默认没有打开？

# cakephp - cakePHP 从 hasMany 2.1 版获取数据

> ID：12253142
> 
> 赞同：0
> 
> 时间：2012-09-03T19:31:20.037
> 
> 标签：cakephp, join, model

我的模型1有很多模型2，我需要在模型2上做条件语句，换句话说：

```
 $result = $this->Model1->find("all",array("conditions" => array("Model2"."field" => $outsideValue))); 
```

然而，我得到了一个未知的列 Model2.field，它看起来是由于 Model1 不包括 Model2 作为连接。我如何做 cakePHP 与 hasMany 的连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:43:41.233

您可以使用[临时连接](http://bakery.cakephp.org/articles/view/quick-tip-doing-ad-hoc-joins-in-model-find)或[可链接行为](https://github.com/Terr/linkable/wiki)来获取连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:38:07.213

尝试：

> $result= $this->Model1->find('all',array('recursive'=>1,"conditions" => array("Model2"."field" => $outsideValue)));

或者：

> $result= $this->Model1->find('all',array("contains" => array("Model2"=>array('conditions'=>array("field" => $outsideValue)))) ;

第一个将为您提供所有模型 1 元素，这些元素链接到模型 2 以验证条件。

第二个将为您提供所有模型 1 元素，只有关联的模型 2 验证条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T04:49:51.207

试试这个：

```
$this->Model1->bindModel(array(
    'hasMany' => array(
        'Model2' => array('conditions'=>array('Model2.field'=>$outsidevalue))
)));
$data = $this->Model1->find('all'); 
```

# ruby-on-rails-3 - @font-face 导轨 3.2

> ID：12253146
> 
> 赞同：7
> 
> 时间：2012-09-03T19:31:42.683
> 
> 标签：ruby-on-rails-3, font-face

我正在考虑尝试使用@font-face 在我的rails 应用程序中使用font-squirrels 字体。希望这是解释它的正确方法。我对此比较陌生，所以希望有人可以建议我如何让它在 rails 应用程序中工作

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-03T20:21:24.127

好的，所以我想我会给出答案，这样它可以帮助其他人解决我的情况。我只是在谷歌上搜索并将所有部分放在一起，我很懒/害怕这个未知，所以为此道歉。尝试它真的有助于理解

反正

1）在 app/assets 中创建一个名为 fonts 的文件夹
2）将所有 svg .eot .woff .ttf 放入此文件夹中
3）在 config/application.rb 中放入以下内容

```
# Add the fonts path
config.assets.paths << "#{Rails.root}/app/assets/fonts"

# Precompile additional assets
config.assets.precompile += %w( .svg .eot .woff .ttf ) 
```

4）在您的应用程序样式表中，您可以放置​​ @font-face 样式，例如

```
 @font-face {
font-family: 'DearestRegular';
src: url('Dearest-webfont.eot');
src: url('Dearest-webfont.eot?#iefix') format('embedded-opentype'),
     url('Dearest-webfont.woff') format('woff'),
     url('Dearest-webfont.ttf') format('truetype'),
     url('Dearest-webfont.svg#DearestRegular') format('svg');
font-weight: normal;
font-style: normal; 
```

}

5）然后无论你想在哪里使用字体，只需正常使用 font-family 6）哦，然后重新启动服务器以将它们组合在一起 :)

# delphi - Delphi 7、FastMM 和 DUnit GUITesting 错误的内存泄漏测试失败

> ID：12253147
> 
> 赞同：3
> 
> 时间：2012-09-03T19:31:45.133
> 
> 标签：delphi, memory-leaks, delphi-7, fastmm, dunit

我在 FastMM 误报方面遇到了一些问题。这一次，泄漏是在案例测试表格中。[它与我在这里](https://stackoverflow.com/questions/11083350/delphi-7-dunit-and-fastmm-reporting-strings-incorrectly)描述的非常相似。

我有一个表单和一些普通的旧 VCL 控件。第一次测试运行显示实际上不存在的泄漏。第二次运行没有泄漏。我搜索了所有 DUnit 源代码，但找不到修复它的原因。有人可以帮助我吗？

我不能运行两次测试，因为： 1\. 它将在持续集成中运行；2.有些测试确实需要一些时间，加倍它是不明智的。

我检查了 DUnit GUI 中的最后 3 个选项： - 在关机时报告内存泄漏类型 - 如果内存泄漏，则测试用例失败 - 在 SetUp/TearDown 中忽略内存泄漏

以下是示例代码：

```
 // form
    type

    TForm2 = class(TForm)
      button1: TButton;
    end;

    implementation

    {$R *.dfm}

    // test
    type

    TTest = class(TGUITestCase)
    private
      a: TForm2;
    public
      procedure SetUp; override;
      procedure TearDown; override;
    published
      procedure Test;
    end;

    implementation

    procedure TTest.Setup;
    begin
      a := TForm2.Create(nil);
    end;

    procedure TTest.TearDown;
    begin
      FreeAndNil(a);
    end;

    procedure TTest.Test;
    begin
      a.Show;
      a.close;
    end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T23:15:56.740

您可以释放表单两次。将操作设置为 caFree 会使表单自动释放。因此，要么删除 OnClose 方法，要么更好地在测试本身中创建表单并删除 setup 和 teardown 方法而不释放表单。CaFree 会解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:12:47.980

下载的版本偶尔会出现这种情况。看起来很荒谬，根本原因是：如果我在加载 DUnit GUI 后按“F9”太快，就会出现问题。等待几秒钟，没有报告泄漏。

由于这里我们覆盖了 FormShow 事件以自动启动测试，在我的情况下，问题总是发生。因此，将执行延迟 2 秒解决了我的问题。

感谢@balazs 帮助我。

# jsf - PrimeFaces 推送组件

> ID：12253149
> 
> 赞同：1
> 
> 时间：2012-09-03T19:32:09.043
> 
> 标签：jsf, primefaces

我使用 RichFaces 3.3.3 有一段时间了，它有一个组件在需要一些时间的大型操作中非常有用：它是推送组件。

[http://livedemo.exadel.com/richfaces-demo/richfaces/push.jsf?c=push&tab=usage](http://livedemo.exadel.com/richfaces-demo/richfaces/push.jsf?c=push&tab=usage)

PrimeFaces 是否有类似的东西，我可以更新一个对象值而不仅仅是一个字符串。我看到你可以用一个字符串来做这个。但我想将一个对象传递给它。

# python - 区分过拟合与良好预测

> ID：12253151
> 
> 赞同：33
> 
> 时间：2012-09-03T19:32:23.940
> 
> 标签：python, numpy, machine-learning, regression, scikit-learn

这些是关于如何计算和减少机器学习中的过度拟合的问题。我认为许多机器学习新手都会有同样的问题，所以我试着用我的例子和问题说清楚，希望这里的答案可以帮助其他人。

我有一个非常小的文本样本，我正在尝试预测与它们相关的值。我已经使用 sklearn 来计算 tf-idf，并将它们插入到回归模型中进行预测。这给了我 26 个具有 6323 个特征的样本 - 不是很多。我知道：

```
>> count_vectorizer = CountVectorizer(min_n=1, max_n=1)
>> term_freq = count_vectorizer.fit_transform(texts)
>> transformer = TfidfTransformer()
>> X = transformer.fit_transform(term_freq) 
>> print X.shape

(26, 6323) 
```

将 6323 个特征 (X) 和相关分数 (y) 的这 26 个样本插入到`LinearRegression`模型中，可以得到很好的预测。这些是使用留一法交叉验证获得的，来自`cross_validation.LeaveOneOut(X.shape[0], indices=True)`：

```
using ngrams (n=1):
     human  machine  points-off  %error
      8.67    8.27    0.40       1.98
      8.00    7.33    0.67       3.34
      ...     ...     ...        ...
      5.00    6.61    1.61       8.06
      9.00    7.50    1.50       7.50
mean: 7.59    7.64    1.29       6.47
std : 1.94    0.56    1.38       6.91 
```

非常好！使用 ngrams (n=300) 而不是 unigrams (n=1) 会出现类似的结果，这显然是不对的。任何文本中都没有出现 300 个单词，因此预测应该失败，但它不会：

```
using ngrams (n=300):
      human  machine  points-off  %error
       8.67    7.55    1.12       5.60
       8.00    7.57    0.43       2.13
       ...     ...     ...        ...
mean:  7.59    7.59    1.52       7.59
std :  1.94    0.08    1.32       6.61 
```

***问题 1：***这可能意味着预测模型**过度拟合**数据。我只知道这一点，因为我为我知道不能产生好的结果的 ngrams (n=300) 选择了一个极值。但如果我没有这方面的知识，你通常如何判断模型过度拟合？换句话说，如果使用了合理的度量（n=1），你怎么知道好的预测是过度拟合的结果，而模型只是运行良好？

***问题 2：***防止过度拟合（在这种情况下）以确保预测结果好坏的最佳方法是什么？

***问题3：***如果`LeaveOneOut`使用交叉验证，模型怎么可能过拟合得到好的结果？过度拟合意味着预测准确性会受到影响 - 那么为什么它不会影响对被遗漏文本的预测呢？我能想到的唯一原因：在主要为 0 的 tf-idf 稀疏矩阵中，文本之间有很强的重叠，因为有很多术语是 0 - 然后回归认为文本高度相关。

请回答任何问题，即使您不知道所有问题。谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-03T22:06:01.153

> 您通常如何判断模型过度拟合？

[一个有用的经验法则](http://digitheadslabnotebook.blogspot.nl/2011/12/practical-advice-for-applying-machine.html)是，当您的模型在其自己的训练集上的性能比在其保留验证集或交叉验证设置中的表现要好得多时，您可能会过度拟合。不过，这还不是全部。

我链接到的博客条目描述了一个测试过拟合的过程：绘制训练集和验证集误差作为训练集大小的函数。如果它们在图的右端显示出稳定的间隙，则您可能过度拟合。

> 防止过度拟合（在这种情况下）以确保预测结果好坏的最佳方法是什么？

使用**保留的测试集**。仅在您完全完成模型选择（超参数调整）后才对这个集合进行评估；不要训练它，不要在（交叉）验证中使用它。你在测试集上得到的分数就是模型的最终评价。这应该显示您是否不小心过度拟合了验证集。

[机器学习会议有时会像比赛一样设置，直到研究人员将最终模型交付给组织者*之后才会将测试集提供给研究人员。*同时，他们可以随意使用训练集，例如使用交叉验证测试模型。[Kaggle](http://www.kaggle.com)做了类似的事情。]

> 如果`LeaveOneOut`使用交叉验证，模型怎么可能过拟合而得到好的结果？

因为您可以在此交叉验证设置中尽可能多地调整模型，直到它在 CV 中表现得几乎完美。

作为一个极端的例子，假设您已经实现了一个本质上是一个随机数生成器的估计器。您可以继续尝试随机种子，直到您找到一个在交叉验证中产生非常低错误的“模型”，但这并不是您找到了正确的模型。这意味着您已经过度适应交叉验证。

另见[这个有趣的战争故事](http://www.gregorypark.org/?p=359)。

# ios - NSURLConnection 委托方法未执行

> ID：12253152
> 
> 赞同：0
> 
> 时间：2012-09-03T19:32:24.487
> 
> 标签：ios, nsurlconnection, scrollview

我正在尝试从服务器中提取图像以获取滚动视图。用户放大或缩小视图后，应下载图像：

```
- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {

Ymin=365000+375000*_scrollView.contentOffset.x/(scale*1024);
Ymax=365000+375000*(_scrollView.contentOffset.x/scale+1024/scale)/1024;
Xmin=6635000-260000*(_scrollView.contentOffset.y/scale+748/scale)/748;
Xmax=6635000-260000*_scrollView.contentOffset.y/(scale*748);

[self looYhendus];  //Creates NSURLConnection and downloads the image according to scale, Ymin, Ymax, Xmin and Xmax values

UIImage *saadudPilt=_kaardiPilt;
imageView=[[UIImageView alloc] initWithImage:saadudPilt];
imageView.frame=CGRectMake(_scrollView.contentOffset.x,_scrollView.contentOffset.y,1024,748);
[_scrollView addSubview:imageView];

} 
```

在某些情况下（我不知道在什么条件下），它可以工作，但在某些情况下 NSURLConnection 委托方法不会被触发，并且设置为子视图的图像仍然是最初下载的图像（当应用程序发射）。然后，只有在我再次触摸屏幕（滚动视图滚动）后，NSLog 消息才显示图像已下载。这种行为的原因可能是什么？

编辑：添加了 NSURLConnection 委托方法。我尝试了其他一些方法，但它们最终都没有执行委托方法。这让我认为这不是关于 NSURConnection 而是关于 UIScrollView （显然，我可能错了）。

```
- (void)looYhendus
{   
yhendused=CFDictionaryCreateMutable(
                                    kCFAllocatorDefault, 
                                    0,
                                    &kCFTypeDictionaryKeyCallBacks,
                                    &kCFTypeDictionaryValueCallBacks);

NSString *aadress = [NSString stringWithFormat:@"http://xgis.maaamet.ee/wms-pub/alus?version=1.1.1&service=WMS&request=GetMap&layers=MA-ALUSKAART&styles=default&srs=EPSG:3301&BBOX=%d,%d,%d,%d&width=%d&height=%d&format=image/png",Ymin,Xmin,Ymax,Xmax,512,374];
NSURL *url = [[NSURL alloc] initWithString:aadress];
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];
NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

if( theConnection )
{
    andmedServerist = [NSMutableData data];
    CFDictionaryAddValue(
                         yhendused,
                         (__bridge void *)theConnection,
                         (__bridge_retained CFMutableDictionaryRef)[NSMutableDictionary
                                                                    dictionaryWithObject:[NSMutableData data]
                                                                    forKey:@"receivedData"]);
}
CFRunLoopRun();
}

-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
[andmedServerist setLength: 0];
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
NSMutableDictionary *connectionInfo =
(NSMutableDictionary*)objc_unretainedObject(CFDictionaryGetValue(yhendused, (__bridge void *)connection));
[[connectionInfo objectForKey:@"receivedData"] appendData:data];

}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Ühenduse viga" message:@"Kõige tõenäolisemalt on kaardiserveril probleeme või puudub seadmel internetiühendus" delegate:self cancelButtonTitle:@"Sulge" otherButtonTitles:nil];
[alert show];
CFRunLoopStop(CFRunLoopGetCurrent());
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
NSMutableDictionary *connectionInfo =
(NSMutableDictionary*)objc_unretainedObject(CFDictionaryGetValue(yhendused, (__bridge void *)connection));
[connectionInfo objectForKey:@"receivedData"];
andmedServerist=[connectionInfo objectForKey:@"receivedData"];

_kaardiPilt = [UIImage imageWithData: andmedServerist];
CFDictionaryRemoveValue(yhendused, (__bridge void *)connection);

CFRunLoopStop(CFRunLoopGetCurrent());

} 
```

编辑：添加了这个：

```
- (void)viewDidLoad
{
[super viewDidLoad];
Ymin=365000;
Ymax=740000;
Xmin=6375000;
Xmax=6635000;
[self looYhendus];
UIImage *saadudPilt=_kaardiPilt;
imageView=[[UIImageView alloc] initWithImage:saadudPilt];
imageView.frame=CGRectMake(0,0,1024,748);
[_scrollView addSubview:imageView];
[_scrollView setContentSize: CGSizeMake(1024, 748)];
_scrollView.minimumZoomScale = 1.0;
_scrollView.maximumZoomScale = 50.0;
_scrollView.delegate = self;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T03:49:02.213

我最近遇到了同样的问题。问题是我将连接放在异步线程中，而连接已经是异步的。

我在这里找到了解决方案：[NSURLConnection delegate methods are not called](https://stackoverflow.com/questions/5787170/nsurlconnection-delegate-methods-are-not-called)

还有一些链接指向在该线程中遇到类似问题的其他人。

如果我是你，我会尝试简单地使用`[theConnection start]`并使用设置的超时初始化请求，这样你就不必担心在下载图像之前后台线程会关闭。

例如：

```
[request setTimeoutInterval:30]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:45:06.060

为什么要在or方法中显式调用`CFRunLoopRun();`和停止它？( )`connectionDidFinishLoading:``didFailWithError:``CFRunLoopStop(CFRunLoopGetCurrent());`

假设您在主线程上执行此操作。您正在停止主线程的运行循环。可以有计时器，ScrollView 使用停止响应的事件，因为您停止了主线程的运行循环。

如果您`NSURLConnection`在主线程上调用，则不需要显式运行它（或停止它）。您可以安排在当前运行循环上运行，这是主线程运行循环。如果您在后台线程上执行此操作，那么您的代码似乎是有效的（尽管如果在单独的线程上调用它，您不应该显示`UIAlertView`）`didFailWithError:`。

**更新的答案（基于@Shiim 的评论）：**

在`viewDidLoad`您正在调用的方法中，该方法`[self looYhendus];`立即返回（因为您正在使用异步 URL 连接进行加载）。所以它按预期工作。移至下载完成后将下载的 imageView 数据添加到 scrollView 的 subView 的方法`[scrollView addSubview:imageView]`。`connectionDidFinishLoading:`或者您可以考虑使用`dispatch_queue`'s 创建一个线程并同步加载 URL 请求，然后使用`dispatch_queue`'s 主队列将作为子视图添加到 ScrollView 的 imageView 的绘图调度到主线程上。

在您的情况下，我的建议是使用 dispatch_queue 重新设计方法。这将使您更好地理解解决问题（在这种情况下），并提高您的代码可读性。

# html - 在页面加载时根据 div 大小缩放硬编码的 SVG 图像

> ID：12253153
> 
> 赞同：0
> 
> 时间：2012-09-03T19:32:24.730
> 
> 标签：html, css, svg, scale, viewbox

我有一个`div`包含`svg`图形（一堆圆圈和边）的元素，我还在元素上设置`viewBox`了属性`svg`。图中节点和边的坐标是针对指定的屏幕尺寸（因此也是指定的`div`尺寸）硬编码在`px`. 使用所需的`div`大小，图形可以很好地加载，并且在调整浏览器窗口大小时也可以放大和缩小。

`div`但是，每当在不同的屏幕/尺寸下加载页面时，我的问题就会出现，因为之前`svg`指定`div`尺寸的图像保持不变。这会创建一个对于较小的浏览器/屏幕尺寸来说太大的图像。

我为元素设置了以下`svg`内容：

```
<svg id="mygraph" preserveAspectRatio="xMidYMid meet"> 
```

并在元素`viewBox`之后立即使用 Javascript设置其属性：`div`

```
<script type="text/javascript">
    document.getElementById("mygraph").setAttribute("viewBox", "0 0 " + $("#graphdiv").width() + " " + $("#graphdiv").height());
</script> 
```

这不能解决问题。那我还能尝试什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T09:25:04.397

viewBox 定义了 svg 内部使用的坐标系，它不会改变 svg 的大小。如果您有一个 viewBox，您只需要设置 svg 的宽度和高度（例如使用 CSS），它就会呈现为该大小。

# android - 未添加权限的 LVL 的 Android 许可 DeviceId

> ID：12253157
> 
> 赞同：1
> 
> 时间：2012-09-03T19:33:00.440
> 
> 标签：android, android-lvl

如何在不需要额外权限的情况下正确构建设备 ID？你应该遵守什么规则？

这个问题参考了这个[示例代码：](http://developer.android.com/guide/google/play/licensing/adding-licensing.html#impl-Obfuscator)

```
// Construct the LicenseChecker with a Policy.
mChecker = new LicenseChecker(
this, new ServerManagedPolicy(this,
      new AESObfuscator(SALT, getPackageName(), deviceId)),
      BASE64_PUBLIC_KEY  // Your public licensing key.
      ); 
```

以及随附的文字：

> 在仅出于获取设备特定信息以在您的混淆器中使用的目的而请求新权限之前，请考虑这样做可能会如何影响您的应用程序或其在 Google Play 上的过滤（因为某些权限可能会导致 SDK 构建工具添加相关的 .

那么如何在不使用任何权限的情况下生成一个好的 ID 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:33:00.440

一个答案是在应用程序第一次运行时生成一个唯一的应用程序安装 ID。[android 开发者博客](http://android-developers.blogspot.com/2011/03/identifying-app-installations.html)上提供了一个示例。

# json - 使用 d3.js 从 JSON 文件中获取图形属性

> ID：12253159
> 
> 赞同：2
> 
> 时间：2012-09-03T19:33:07.367
> 
> 标签：json, d3.js

您可以使用 d3.js 库轻松地从 json 文件中获取节点/链接属性。是否可以获得**图形**属性？示例 JSON 文件：

```
{"directed": true, "graph": 
[["name", "()"], ["label", "Graph Attribute"]], 
"nodes": [
{"node_attr": 1.0, "id": "001"}, 
{"node_attr": 0.5, "id": "002"} 
```

...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:53:23.867

`d3.json`返回一个 JSON，你可以做任何你想做的事情。在回调中，只需访问您需要的键（`mydata.graph`例如）。您是否有需要帮助的特定代码？

# ios - 当我单击 TableView 单元格时，表格视图崩溃

> ID：12253162
> 
> 赞同：1
> 
> 时间：2012-09-03T19:33:22.327
> 
> 标签：ios, xcode, uitableview

当我单击一个单元格时，我遇到了崩溃（应用程序在 iOS 模拟器中退出）。错误代码是

> “EXC_BAD_ACCESS（代码 = 1，地址 = 0x310cc493）

这是代码：

```
// .h

#import <UIKit/UIKit.h>

@interface ChecklistsViewController : UITableViewController

@end

// .m

#import "ChecklistsViewController.h"

@interface ChecklistsViewController ()

@end

@implementation ChecklistsViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 100;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"ChecklistItem"];

    UILabel *label = (UILabel *)[cell viewWithTag:1000];

    if (indexPath.row % 5 == 0) {
        label.text = @"Walk the dog";
    } else if (indexPath.row % 5 == 1) {
        label.text = @"Brush my teeth";
    } else if (indexPath.row % 5 == 2) {
        label.text = @"Learn iOS development";
    } else if (indexPath.row % 5 == 3) {
        label.text = @"Soccer practice";
    } else if (indexPath.row % 5 == 4)
        label.text = @"Eat ice cream";       

    return cell;
}

- tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath    
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
}  // Control reaches end of non-function

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:42:08.337

`UITableViewCell`在您的示例中，如果没有出队，则不分配 a 。你需要做这样的事情：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"ChecklistItem"];
if( cell == nil ) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:@"ChecklistItem"] autorelease];

    // whatever additional initialization
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T10:14:27.083

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

   static NSString *CellIdentifier = @"Cell";
   UItableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

   if (cell == nil) {
       cell = [[UItableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
   } 
//write your code here

return cell;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:45:36.293

您需要分配`UITableViewCell`in`tableView: cellForRowAtIndexPath:`方法。

你的方法应该是这样的：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

   static NSString *CellIdentifier = @"Cell";
   UItableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

   if (cell == nil) {
       cell = [[UItableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
   } 

//INSERT YOUR CODE

} 
```

# c - ＃包括 它不工作

> ID：12253164
> 
> 赞同：1
> 
> 时间：2012-09-03T19:33:34.040
> 
> 标签：c, ruby, visual-c++, include, ruby-c-extension

我已经多次尝试通过谷歌、这个网站和其他一些网站在互联网上找到这些信息；我似乎找不到一个好的教程和/或答案。

我将如何在 Visual C++ 2010 中使用 Ruby C API？我已将 Ruby 包含文件夹添加到我的项目的包含路径中，并且我还添加了 Ruby devkit 包含文件夹。但是，当我`#include <ruby.h>`仍然找不到`inttypes.h`时，并且在添加 devkit 路径之前，它找不到其他各种头文件。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:49:28.680

Visual Studio 不附带 inttypes.h，因为它没有适当的 C99 支持。

您需要从第三方来源获取此标头，例如[http://code.google.com/p/msinttypes/](http://code.google.com/p/msinttypes/)

# lua - Lua：使用本地安装的 rock（或 .zip/.tar.gz）中的 luarocks 安装 Rock

> ID：12253165
> 
> 赞同：12
> 
> 时间：2012-09-03T19:33:38.207
> 
> 标签：lua, luarocks

我四处寻找，但我无法确定这是否可能。

基本上，[http](http://luarocks.org) ://luarocks.org 已经关闭，我已经在本地的另一台机器上安装了 luafilesystem 的副本。使用 Ruby，可以在本地使用“gem”命令交叉安装 ruby​​ gem。我想知道rocks和luarocks是否也可以这样做。

有没有办法通过使用该岩石的另一个本地安装来“交叉安装”岩石（例如，luafilesystem）？

就像是：

`luarocks install //10.0.1.123/machine/path/to/luafilesystem/on/other/machine`

是我希望能够做到的。

更新：我什至会很高兴如何从 .t​​ar.gz 或 .zip 安装岩石，例如，如果我从[这个位置](http://files.luaforge.net/releases/luafilesystem/luafilesystem/luafilesystem-1.4.2)下载了一个图像（在 LuaFileSystem 的情况下）。

在这种情况下，安装的“源”将/可能是机器本地的，而不是远程的（并且不一定已经安装为岩石）。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-15T15:28:39.703

如果你有源 zip，你可以解压它并将 luarocks 指向 rockspec 文件。这是我从源代码安装“破坏”的方法。

```
git clone https://github.com/Olivine-Labs/busted.git
luarocks install busted/busted-1.3-1.rockspec 
```

或者直接从源码安装

```
cd busted
luarocks make 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-06-05T08:48:55.467

LuaRocks 有一个`pack`子命令，它将创建一个二进制 Rock（一个包含已安装模块的所有文件的 zip 文件）。如果架构匹配，您可以使用该二进制 Rock 在另一台计算机上安装相同的模块。

例如

```
luarocks pack luafilesystem 
```

`luafilesystem-1.6.2-2.linux-x86_64.rock`在我的机器上生产，并且

```
luarocks install luafilesystem-1.6.2-2.linux-x86_64.rock 
```

`luafilesystem`无需互联网连接即可重新安装。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-04-10T11:11:52.877

如果有人想要从本地源岩安装。

只需这样做：

```
cd /path/to/source-rock
luarocks make source-rock.rockspec 
```

**笔记：**

使用**`make`**而不是`install`. 原因在[这里](http://lua-users.org/lists/lua-l/2011-08/msg00836.html)（引用如下）。

> > LuaRocks 提供了这个：
> > 
> > `make` 使用 rockspec 在当前目录编译包。
> > 
> > `install`安装一块石头。
> > 
> > 但是，`install`不使用现在的制作。它尝试从服务器下载并重新编译相同的包，而不是我在本地自定义的包。
> > 
> > 有办法解决这个问题吗？
> 
> 该`make`命令将实际构建和安装您自定义的 rockspec。我知道，糟糕的命名选择会时不时地引起混乱。

# php - 编辑 URL 以在 TLD 之后不显示任何内容

> ID：12253166
> 
> 赞同：-1
> 
> 时间：2012-09-03T19:33:39.380
> 
> 标签：php, html

变量`$rowad["1site"]`是一个 URL。如何将整个 URL 保留在超链接中，但锚文本是 URL 的编辑版本，在 TLD 之后什么也不显示？

```
echo '<td style="" class="pointlink"><span class="pointlink"><a href="http://'.$rowad["1site"].'">'.$rowad["1site"].'</a></td>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:43:49.297

您可以分解 URL，例如：

```
$newUrl = explode('/', $rowad['1site']); 
```

然后`$newUrl[0]`在你想要的地方添加。

# c# - 控制台应用程序中的 Google Oauth2.0 身份验证

> ID：12253168
> 
> 赞同：1
> 
> 时间：2012-09-03T19:33:58.917
> 
> 标签：c#, oauth-2.0

我正在尝试使用 Google 购物 API。为了使用 API，我的应用程序应该使用 OAuth2.0 进行身份验证。看起来这种方法涉及用户交互（用户允许应用程序访问资源）是否可以在没有用户交互的非 Web 应用程序中进行 OAuth 授权？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T10:37:17.163

这可能是使用[服务帐户](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)的好案例。这意味着您的应用程序不是以*用户*身份运行，而是*以自身身份*运行。也就是说，作为与您的 API 控制台项目相对应的虚构帐户。

各种官方客户端库都支持上面链接中描述的Service Account流程，但是C#没有在其中列出，所以你可能需要自己编写。（虽然[这个问题](http://code.google.com/p/google-api-dotnet-client/issues/detail?id=203)声称它在 google-api-dotnet-client 库中受支持，但我在查找一两分钟后找不到此功能的来源）。

# language-agnostic - 在现代浏览器的地址栏中按 Enter 时，是否有处理该事件的中断？

> ID：12253170
> 
> 赞同：0
> 
> 时间：2012-09-03T19:34:31.497
> 
> 标签：language-agnostic, interrupt

一些背景：不久前，我见证了一次采访，采访者问受访者当用户按下 Enter 按钮时会发生什么。长长的解释之后，面试官解释说这个动作实际上触发了一个*中断*，以便 CPU 可以处理事件（*事件*是用户在地址栏中按 Enter 键）。

这让我开始思考这是否真的会导致中断。虽然这种低级系统/操作系统语义不是我的专长，但我一直认为中断主要（仅？）用于硬件设备。

那么，当用户按下地址栏中的 Enter 按钮时，最终是否会出现中断导致 CPU 执行加载网页的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:48:45.827

并非最终，在您按下键或移动鼠标的那一刻，输入设备会生成一个中断，CPU 在专用的中断处理程序例程中提供服务，在该例程中它会从设备读取数据（键码或移动的距离）。这与浏览器本身无关。

# java - 如何在 Ext GWT 中的 RequestBuilder 中发送网格过滤器参数？

> ID：12253172
> 
> 赞同：1
> 
> 时间：2012-09-03T19:34:34.323
> 
> 标签：java, gwt, gxt

分页功能和本地过滤是完美的，但我需要远程过滤器，我想将过滤器参数发送到请求方法。

谢谢！

我有这个代码：

```
String path =  GWT.getHostPageBaseURL() + (Examples.isExplorer() ? "" : "../../" ) + "backend/index.php?action=getLines";  

RequestBuilder builder = new RequestBuilder(RequestBuilder.GET, path);  
HttpProxy<String> proxy = new HttpProxy<String>(builder);  

JsonPagingLoadResultReader<PagingLoadResult<ModelData>> reader = new JsonPagingLoadResultReader<PagingLoadResult<ModelData>>(type);  

final PagingLoader<PagingLoadResult<ModelData>> loader = new BasePagingLoader<PagingLoadResult<ModelData>>(proxy,  
    reader);

[...]

NumericFilter sorszamFilter = new NumericFilter("Sorszam");

StringFilter nevFilter = new StringFilter("Nev");

DateFilter datumFilter = new DateFilter("Datum");
NumericFilter szamFilter = new NumericFilter("Szam");

GridFilters filters = new GridFilters();
filters.setLocal(true);
filters.addFilter(sorszamFilter);
filters.addFilter(nevFilter);
filters.addFilter(datumFilter);
filters.addFilter(szamFilter);

//example
sorszamFilter.addListener(Events.Update, new Listener<FilterEvent>() {
    @Override
    public void handleEvent(FilterEvent be) {
        ???
    }

});

[...]

final PagingToolBar toolBar = new PagingToolBar(10);  
toolBar.bind(loader);  

loader.load(0, 10); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T15:48:55.107

看起来*BasePagingLoader*可以使用 loadConfig 对象进行自定义。loadConfig 应该是 ModelData 类型的 Object，更具体地说是 PagingLoadConfig。使用

```
final ModelData loadConfig = (ModelData) ((BasePagingLoader).loader).newLoadConfig(); 
```

方法。然后强制加载器使用这个 loadConfig：

```
((BasePagingLoader).loader).useLoadConfig(loadConfig); 
```

loadConfig 应该是 ModelData 的可变实例。这就是为什么您可以使用

```
loadConfig.set("selectedFilter", "what_ever_you_like_here")
loadConfig.set("direction", "ASC"); 
```

这应该代替您输入的问号完成，并且应该强制 HttpProxy 将您设置的任何内容添加到 loadConfig 属性。（有关如何借助 loadConfig 构建请求，请参阅[HttpProxy#generateUrl](http://grepcode.com/file/repo1.maven.org/maven2/com.extjs/gxt/2.2.0/com/extjs/gxt/ui/client/data/HttpProxy.java#91)方法）。然后你必须在服务器端相应地处理请求。我假设你使用 GXT 2.2.x，老实说我还没有编译它，希望它能正常工作。

# java - 图像识别黑莓？

> ID：12253178
> 
> 赞同：1
> 
> 时间：2012-09-03T19:35:14.820
> 
> 标签：java, blackberry, image-processing, blackberry-jde, image-recognition

**我正在尝试为BlackBerry 设备**开发一种 AR 。尝试实现对旧设备的最佳兼容性，如果可能的话，我想为 BlackBerry OS 5 / 6 制作它。由于缺乏硬件性能，我不想在屏幕上显示实时解决方案。现在我只想识别相机看到的一些符号，在识别符号的那一刻我想捕捉当前视图的照片。

之后，我想裁剪部分捕获的照片并将其与图像进行比较，并确定它是否与某些图像匹配。

我在研究替代方案方面非常先进，对于图像比较步骤，我知道有两种常用技术**histogram 和 keypoints**。我几乎决定使用直方图方法，但我担心相机捕获的颜色可能与我在数据库中获得的颜色略有不同（由于光源、颜色等）

有什么想法是实现我想要做的最好的方法吗？

谢谢！

# c++ - std::ios_base::ate 和 std::ios_base::trunc

> ID：12253183
> 
> 赞同：26
> 
> 时间：2012-09-03T19:36:36.120
> 
> 标签：c++

`std::ios_base::ate`（`std::ios_base::app`例如，以外）和`std::ios_base::trunc`（例如，以外）有什么意义`std::ios_base::out`？

我应该更喜欢写`std::ios_base::smth`而不是`std::ios::smth`？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-03T19:44:35.283

std::ios_base::ate 将光标定位在文本的末尾，而 std::ios_base_app 在末尾附加文本（带有写操作），尽管您仍然可以从头开始阅读:)

std::ios_base::trunc 截断文件以将其清空，而 std::ios_base::out 仅指定您要写入流。

我目前无法引用该标准（在我的平板电脑和 Acrobat Reader 上不会复制），但从 ISO 14882:1998 的第 27.4.2.1.4 段中，您可以在链接上看到的信息几乎是准确的：[http:// /cplusplus.com/reference/iostream/ios_base/openmode/](http://cplusplus.com/reference/iostream/ios_base/openmode/)

总结一下：

```
std::ios_base::app = append 
```

通过“寻求[ing]在每次写入之前结束”附加在流的末尾

```
std::ios_base::ate = At The End 
```

打开后立即打开并在末尾查找

```
std::ios_base::binary = binary 
```

以二进制而不是文本执行操作

```
std::ios_base::in = input 
```

以读取模式打开

```
std::ios_base::out = output 
```

以写入模式打开

```
std::ios_base::trunc = truncate 
```

在打开时截断流。

这些值只是标志，因此您可以在末尾以读/写二进制文件打开流：

```
std::ios_base::in | std::ios_base::out | std::ios_base::ate | std::ios_base::binary 
```

* * *

关于使用这些值的方式，如你所愿。它们在`std::ios_base`类中被声明为公共静态字段（参见 27.4.2），因此可以使用`std::ios::ate`甚至类似的东西来访问它们`cout.binary`！

* * *

您必须注意的点是`std::ios_base::ate`不暗示`std::ios_base::app`也不`std::ios_base::out`暗示`std::ios_base::trunc`。每个字段都有不同的含义和不同的使用情况，尽管它们中的大多数不能单独使用:)

# coffeescript - 如何做一个非常简单的for循环

> ID：12253187
> 
> 赞同：0
> 
> 时间：2012-09-03T19:37:17.943
> 
> 标签：coffeescript

我想在咖啡脚本中完成这个：

```
for (i = 0, i < count, i++) {
 doSomething();
} // count is a number 
```

但它总是作为数组处理。

有没有办法防止这种情况？我尝试了一个while循环，但它对我没有用。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:45:46.693

首先，你要实现这个：

```
for(i = 0; i < count; i++) { ... } 
```

在 CoffeeScript 中，而不是`for(i = 0, ...)`.

[在文档](http://coffeescript.org/#loops)中有一个这样的例子：

```
countdown = (num for num in [10..1]) 
```

和 JavaScript 版本：

```
var countdown, num;

countdown = (function() {
  var _i, _results;
  _results = [];
  for (num = _i = 10; _i >= 1; num = --_i) {
    _results.push(num);
  }
  return _results;
})(); 
```

所以你只想用这个：

```
for i in [1..count]
  doSomething() 
```

或者

```
doSomething() for i in [1..count] 
```

请注意范围从 1 开始，以便`[1..count]`为您提供`count`迭代。

# java - 处理应用程序上下文

> ID：12253189
> 
> 赞同：0
> 
> 时间：2012-09-03T19:37:32.480
> 
> 标签：java, android

我是android和java的新手。

我正在将我的应用程序中的一些类重新排列到单独的类文件中。我的主要活动类文件中有一个 onLocationListener 类。我将该类移动到一个单独的 java 类文件中。然后，但是下面的代码将无法编译。. .

```
public void onProviderDisabled(String provider)
{
     Toast.makeText( getApplicationContext(),
     "Gps Disabled",
     Toast.LENGTH_SHORT ).show();
} 
```

当此代码位于单独的文件中时，getApplicationContext 不会编译。我试过*这个。*和*主要活动名称。*但似乎没有任何效果。所以我想这个问题可以形成以下问题：

您如何从存在于主活动文件之外的单独 java 类文件中的代码中声明应用程序上下文？谢谢，加里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:44:35.370

[getApplicationContext()](http://developer.android.com/reference/android/content/Context.html#getApplicationContext%28%29)是类[Context](http://developer.android.com/reference/android/content/Context.html)的一个方法，因此您只能从以某种方式扩展的类或对象调用它`Context`。您将代码从[Activity](http://developer.android.com/reference/android/app/Activity.html)中分解出来，这是一个类。那么，您的解决方案是`Context`让包含您的新类或对象的类传递其上下文，以便您的新类可以使用它。

您在主 Activity 中的代码如下所示：

```
MyOwnClass ownObject = new MyOwnClass();
// you have to implement setApplicationContext
ownObject.setApplicationContext( this.getApplicationContext() ); 
```

立即获取应用程序上下文可能是一个好主意，因为它会在您的应用程序的整个生命周期内保持稳定，这与 Activity 上下文不同，它可以在诸如方向更改之类的简单事情上消失。

# c - 初始化时是否需要调用pointer = NULL？

> ID：12253191
> 
> 赞同：16
> 
> 时间：2012-09-03T19:37:50.707
> 
> 标签：c, pointers, alloc

当我创建指向某个结构的指针时，是否必须将其设置为 NULL，然后分配它然后使用它？为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-03T19:38:27.440

不，您不必将其设置为`NULL`，但有些人认为这是一种很好的做法，因为它为新指针提供了一个值，使其*明确表示*它没有指向任何东西（还）。

如果您正在创建一个指针，然后*立即*为其分配另一个值，那么将其设置为`NULL`.

`NULL`不过，在释放它指向的内存之后设置一个指针是个好主意。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-03T19:47:03.563

不，没有要求（就语言而言）在声明指针变量时将其初始化为任何内容。因此

```
T* ptr; 
```

是一个有效的声明，它引入了一个以`ptr`不确定值命名的变量。您甚至可以以某些方式使用该变量，而无需先分配任何内容或将其设置为任何特定值：

```
func(&ptr); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-07-17T10:41:43.080

根据 C 标准，不初始化自动存储变量会导致其值不确定。

当您的指针具有不确定值时，绝对鼓励您将指针设置为 NULL。使用具有不确定值的指针是**未定义的行为**，如果您习惯于 C 编程并且来自更高级别的语言，您可能无法正确掌握这个概念。

**未定义的行为意味着任何事情都可能发生**，这是 C 标准的一部分，因为 C 的哲学是让程序员有责任控制事物，而不是保护他免受错误的影响。

你想避免代码中未定义的行为：当任何行为可能发生时，调试东西是非常困难的。它不会被编译器捕获，并且您的测试可能总是通过，而不会注意到错误，直到纠正它的成本非常高。

如果你做这样的事情：

```
char *p;
if(!p) puts("Pointer is NULL"); 
```

您实际上并不知道该`if`控制是对还是错。这在大型程序中是极其危险的，您可以在其中声明变量，然后在空间和时间很远的地方使用它。

引用释放的内存时的概念相同。

```
free(p);
printf("%s\n", p);
p = q; 
```

您实际上并不知道最后两个语句会得到什么。你不能正确地测试它，你不能确定你的结果。您的代码似乎可以工作，因为释放的内存被回收，即使它可能已被更改......您甚至可以覆盖内存，或破坏共享相同内存的其他变量。所以你仍然有一个迟早会出现的错误，并且可能很难调试它。

如果将指针设置为 NULL，则可以保护自己免受这些危险情况的影响：在测试期间，您的程序将具有确定性、可预测的行为，这种行为会快速而廉价地失败。你得到一个段错误，你抓住了这个错误，你修复了这个错误。干净简单：

```
#include <stdio.h>
#include <stdlib.h>

int main(){
  char* q;
  if(!q) puts("This may or may not happen, who knows");
  q = malloc(10);
  free(q);
  printf("%s\n", q); // this is probably don't going to crash, but you still have a bug

  char* p = NULL;
  if(!p) puts("This is always going to happen");
  p = malloc(10);
  free(p);
  p = NULL;
  printf("%s\n", p); // this is always going to crash

  return 0;
} 
```

因此，当您初始化指针时，尤其是在大型程序中，您希望它们被显式地初始化或设置为 NULL。你不希望他们得到一个不确定的价值，永远不要。我应该说*，除非你知道你在做什么*，但我更喜欢*从不*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-03T22:25:21.177

不，不要忘记初始化必须是空指针。现代 C 中一个非常方便的习惯用法是在第一次使用时声明变量

```
T * ptr = malloc(sizeof *ptr); 
```

这避免了你记住类型以及变量是否已经初始化的麻烦。只有当你不知道它后来在哪里（或者即使）它被初始化时，你才应该明确地将它初始化为一个空指针。

因此，根据经验，始终将变量初始化为适当的值。`0`如果您手头没有更好的选择，“适合类型”总是一个不错的选择。对于所有类型，C 都是这样制作的，因此它可以工作。

在大多数情况下，不初始化变量是过早的优化。仅当您发现那里存在真正的性能瓶颈时，才检查您的变量。特别是如果在使用初始值之前在同一个函数内部进行了赋值，那么现代编译器会优化你的初始化。首先考虑程序的正确性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T19:39:33.073

除非您不希望它悬空一会儿，否则您不必这样做。你知道你*应该*在释放（防守风格）之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T19:44:34.403

您不必初始化为 NULL。如果您打算立即分配它，您可以跳过它。

At 可用于错误处理，如下例所示。`p`在这种情况下，分配后中断到最后会导致`q`未初始化。

```
int func(void)
{
    char *p;
    char *q;

    p = malloc(100);
    if (!p)
        goto end;

    q = malloc(100);
    if (!q)
        goto end;

    /* Do something */

end:
    free(p);
    free(q);

    return 0;
} 
```

另外，这是我个人的喜好，总是用`calloc`. 可以分配未初始化的字符串`malloc`

# python - 如何在类中使函数的变量成为全局变量？

> ID：12253195
> 
> 赞同：1
> 
> 时间：2012-09-03T19:38:20.327
> 
> 标签：python, function, tkinter, global-variables

所以，我很难理解如何从类中的另一个函数访问函数变量的值。

```
 import Tkinter as tk, tkFileDialog

    class test:
        def __init__(self):
            root = tk.Tk()
            song_button = tk.Button(root, text = 'Select Song', fg = 'blue', command = self.loadfile).pack()
            #how do I access the value of filename now?

        def loadfile(self):
            filename = tkFileDialog.askopenfilename(filetypes=[("allfiles","*"),("pythonfiles","*.py")]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:39:46.773

现在文件名只是`loadfile`函数中的一个局部变量。您需要使文件名成为对象的属性。做`self.filename = ...`，然后在其他方法中您可以将其作为`self.filename`.

（在这种特殊情况下，您所问的似乎有点奇怪，因为`loadfile`在您似乎想要访问时不会被调用`filename`，因此`filename`甚至不存在。但这是一般的想法。无论如何，您显然需要先调用定义变量的函数，然后才能对其进行任何操作。）

# c++ - 一个 .cpp 文件中的多个类

> ID：12253197
> 
> 赞同：5
> 
> 时间：2012-09-03T19:38:39.563
> 
> 标签：c++

我想知道在一个 .cpp 文件中包含多个类是否被认为是不好的做法。我有 Objective-C 的背景，在这方面很少这样做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T19:40:24.047

它使代码的可读性降低，因为您通常希望类的定义位于具有相同名称的标头中，而实现位于具有相同名称的实现文件中。

在实践中有些情况下，一个类相对较小，并且密切相关的小类可以组合在一起，但它是根据具体情况而定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:48:09.687

正如另一个答案指出的那样，它使代码的可读性降低。

考虑嵌套类的范围也很重要：

> 嵌套类在另一个类的范围内声明。嵌套类的名称是其封闭类的本地名称。除非您使用显式指针、引用或对象名称，否则嵌套类中的声明只能使用可见结构，包括类型名称、静态成员以及来自封闭类和全局变量的枚举数。

[资源](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/language/ref/cplr061.htm)

# javascript - 我还需要使用 type='text/javascript' 吗？

> ID：12253199
> 
> 赞同：2
> 
> 时间：2012-09-03T19:38:42.840
> 
> 标签：javascript, jquery, html, dom

> **可能重复：**
> [当服务器设置 mime 类型时，为什么要写 <script type=“text/javascript”>？](https://stackoverflow.com/questions/2706290/why-write-script-type-text-javascript-when-the-mime-type-is-set-by-the-serve)

我知道`<script type='type/javascript'></script>`不再需要 type 属性了。我的问题是，当我自己插入脚本时，我还需要使用它吗？

```
var hello = document.createElement('script');
hello.type = 'text/javascript'; // still needed?
hello.async = true;
hello.src = 'http://mysite.com/script.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hello); 
```

我看到在 Google Analytics 中他们仍然使用它`ga.type = 'text/javascript';`，Disqus 也使用它`dsq.type = 'text/javascript';`

那么，这有必要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:44:11.750

不，这是默认值，如果该属性不存在：

从[规范](http://dev.w3.org/html5/spec/the-script-element.html#attr-script-type)：

> type 属性给出了脚本的语言或数据的格式。如果该属性存在，则其值必须是有效的 MIME 类型。不得指定 charset 参数。如果该属性不存在，则使用默认值是“text/javascript”。

# python - Lisp 的 read-eval-print 循环与 Python 的有何不同？

> ID：12253200
> 
> 赞同：68
> 
> 时间：2012-09-03T19:38:45.570
> 
> 标签：python, functional-programming, lisp, read-eval-print-loop

我遇到了[Richard Stallman 的以下声明](http://stallman.org/stallman-computing.html)：

> '当你启动一个 Lisp 系统时，它会进入一个 read-eval-print 循环。大多数其他语言都无法与 read 相比，无法与 eval 相比，也无法与 print 相比。多么明显的缺陷！'

现在，我很少用 Lisp 进行编程，但我已经用 Python 编写了相当多的代码，最近还用 Erlang 编写了一些代码。我的印象是这些语言也提供 read-eval-print 循环，但 Stallman 不同意（至少关于 Python）：

> '在人们告诉我它与 Lisp 基本相似之后，我浏览了 Python 的文档。我的结论是，事实并非如此。当您启动 Lisp 时，它会执行“读取”、“评估”和“打印”，所有这些在 Python 中都没有。

Lisp 和 Python 的 read-eval-print 循环之间真的存在根本的技术差异吗？你能举例说明 Lisp REPL 使之变得容易而在 Python 中难以做到的事情吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-09-03T19:45:57.547

为了支持 Stallman 的立场，Python 在以下方面与典型的 Lisp 系统不同：

*   Lisp 中的`read`函数读取一个 S 表达式，它表示一个任意数据结构，可以将其视为数据，也可以将其计算为代码。Python 中最接近的东西读取单个字符串，如果您希望它表示任何含义，您必须自己解析它。

*   Lisp 中的`eval`函数可以执行任何 Lisp 代码。`eval`Python 中的函数*只*计算表达式，并且需要`exec`语句来运行语句。但是这两种方法都适用于以文本形式表示的 Python 源代码，并且您必须跳过一堆障碍才能“评估”Python AST。

*   Lisp 中的函数以与接受`print`的完全相同的形式写出一个 S 表达式。在 Python 中打印出由您尝试打印的数据定义的内容，这当然并不总是可逆的。`read``print`

Stallman 的陈述有点虚伪，因为很明显 Python*确实*有精确命名的函数`eval`and `print`，但它们做的事情与他所期望的不同（和劣等）。

在我看来，Python*确实*在某些方面与 Lisp 相似，我可以理解为什么人们可能会建议 Stallman 研究 Python。然而，正如[Paul Graham 在 What Made Lisp 的不同之处所指出的](http://www.paulgraham.com/diff.html)，任何包含 Lisp 所有功能的编程语言也必须*是*Lisp。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-03T20:01:04.187

Stallman 的观点是，与 Lisps 相比，不实现显式的“阅读器”会使 Python 的 REPL 显得残缺不全，因为它从 REPL 过程中删除了一个关键步骤。Reader 是将文本输入流转换到内存中的组件——想想像 XML 解析器这样的东西，内置在语言中，用于源代码*和*数据。这不仅对编写宏很有用（理论上在 Python 中可以使用该`ast`模块），而且对调试和自省也很有用。

假设您对`incf`特殊表单的实现方式感兴趣。你可以像这样测试它：

```
[4]> (macroexpand '(incf a))
(SETQ A (+ A 1)) ; 
```

但`incf`可以做的不仅仅是增加符号值。当被要求增加哈希表条目时，它到底做了什么？让我们来看看：

```
[2]> (macroexpand '(incf (gethash htable key)))
(LET* ((#:G3069 HTABLE) (#:G3070 KEY) (#:G3071 (+ (GETHASH #:G3069 #:G3070) 1)))
 (SYSTEM::PUTHASH #:G3069 #:G3070 #:G3071)) ; 
```

在这里我们了解到`incf`调用了一个系统特定的`puthash`函数，这是这个 Common Lisp 系统的一个实现细节。请注意“打印机”如何利用“读者”已知的功能，例如在`#:`语法中引入匿名符号，并在扩展表达式的范围内引用相同的符号。在 Python 中模拟这种检查会更加冗长且不易访问。

除了在 REPL 中的明显用途之外，经验丰富的 Lispers 在代码中使用`print`和`read`在代码中作为一种简单且易于使用的序列化工具，可与 XML 或 json 相媲美。虽然 Python 有这个`str`功能，相当于 Lisp 的`print`，但它缺少 的等价物`read`，最接近的等价物是`eval`。`eval`当然混合*了两个*不同的概念，解析和评估，这会导致这样的[问题和这样](https://stackoverflow.com/questions/988228/converting-a-string-to-dictionary)的[解决方案](http://code.activestate.com/recipes/364469-safe-eval/)，并且是 Python 论坛上反复出现的话题。这在 Lisp 中不会成为问题，因为读者和评估者是完全分开的。

最后，阅读器工具的高级特性使程序员能够以甚至宏无法提供的方式扩展语言。[Mark Kantrowitz的`infix`包](http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/code/syntax/infix/infix.cl)就是一个完美的例子，它实现了一个全功能的中缀语法作为阅读器宏。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-09-03T20:03:07.377

在基于 Lisp 的系统中，通常在程序从 REPL（读取 eval 打印循环）运行时开发程序。所以它集成了一堆工具：完成，编辑器，命令行解释器，调试器，......默认是有的。键入带有错误的表达式 - 您处于另一个 REPL 级别并启用了一些调试命令。你实际上必须做一些事情来摆脱这种行为。

REPL 概念可以有两种不同的含义：

*   像 Lisp（或其他一些类似语言）中的 Read Eval Print Loop。它读取程序和数据，评估并打印结果数据。Python 不能以这种方式工作。Lisp 的 REPL 允许您直接以元编程方式工作，编写生成（代码）的代码、检查扩展、转换实际代码等。Lisp 具有 read/eval/print 作为顶部循环。Python 有类似 readstring/evaluate/printstring 作为顶层循环。

*   命令行界面。交互式外壳。参见例如[IPython](http://ipython.org/ipython-doc/stable/interactive/index.html)。将其与 Common Lisp 的[SLIME](http://common-lisp.net/project/slime/doc/html/index.html#Top)进行比较。

默认模式下 Python 的默认 shell 对于交互使用来说并不是那么强大：

```
Python 2.7.2 (default, Jun 20 2012, 16:23:33) 
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> a+2
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
NameError: name 'a' is not defined
>>> 
```

您收到一条错误消息，仅此而已。

将其与 CLISP REPL 进行比较：

```
rjmba:~ joswig$ clisp
  i i i i i i i       ooooo    o        ooooooo   ooooo   ooooo
  I I I I I I I      8     8   8           8     8     o  8    8
  I  \ `+' /  I      8         8           8     8        8    8
   \  `-+-'  /       8         8           8      ooooo   8oooo
    `-__|__-'        8         8           8           8  8
        |            8     o   8           8     o     8  8
  ------+------       ooooo    8oooooo  ooo8ooo   ooooo   8

Welcome to GNU CLISP 2.49 (2010-07-07) <http://clisp.cons.org/>

Copyright (c) Bruno Haible, Michael Stoll 1992, 1993
Copyright (c) Bruno Haible, Marcus Daniels 1994-1997
Copyright (c) Bruno Haible, Pierpaolo Bernardi, Sam Steingold 1998
Copyright (c) Bruno Haible, Sam Steingold 1999-2000
Copyright (c) Sam Steingold, Bruno Haible 2001-2010

Type :h and hit Enter for context help.

[1]> (+ a 2)

*** - SYSTEM::READ-EVAL-PRINT: variable A has no value
The following restarts are available:
USE-VALUE      :R1      Input a value to be used instead of A.
STORE-VALUE    :R2      Input a new value for A.
ABORT          :R3      Abort main loop
Break 1 [2]> 
```

CLISP 使用 Lisp 的条件系统闯入调试器 REPL。它提出了一些重新启动。在错误上下文中，新的 REPL 提供了扩展命令。

让我们使用`:R1`重启：

```
Break 1 [2]> :r1
Use instead of A> 2
4
[3]> 
```

因此，您可以获得程序的交互式修复和执行运行......

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-07T13:53:20.120

Python 的交互模式与 Python 的“从文件读取代码”模式在几个小而关键的方面不同，这可能是该语言的文本表示所固有的。Python 也不是同义词，这让我将其称为“交互模式”而不是“读取-评估-打印循环”。除此之外，我会说这更多的是等级差异而不是种类差异。

现在，在 Python 代码文件中，有些东西实际上接近于“种类差异”，您可以轻松地插入空行：

```
def foo(n):
  m = n + 1

  return m 
```

如果您尝试将相同的代码粘贴到解释器中，它会认为该函数已“关闭”并抱怨您在错误的缩进处有一个赤裸裸的 return 语句。这在（通用）Lisp 中不会发生。

此外，Common Lisp (CL) 中有一些相当方便的便利变量在 Python 中不可用（至少据我所知）。CL 和 Python 都有“最后一个表达式的值”（`*`在 CL 中，`_`在 Python 中），但 CL 也有`**`(在最后一个表达式之前`***`的值) 和 (前一个表达式的值) and `+`, `++`and `+++`(表达式本身)。CL 也不区分表达式和语句（本质上，一切都是表达式），所有这些都有助于构建更丰富的 REPL 体验。

就像我一开始说的，与其说是种类的不同，不如说是等级的不同。但是，如果他们之间的差距只是稍微大一点，那也可能是种类上的差异。

# mongodb - mongoDB中具有时间间隔的增量MapReduce

> ID：12253205
> 
> 赞同：2
> 
> 时间：2012-09-03T19:39:32.613
> 
> 标签：mongodb, mongoid, mongoose, mongodb-.net-driver, mongomapper

我从服务器获得了一些时间间隔为 10 分钟的记录（在 1 小时内我将获得 6 个文件）我想在接下来的几个小时内每 1 小时执行一次 map reduce 我将不得不在最后一个文件上执行下一组的 map reduce小时文件我将如何解决这个问题？帮助我在过去 1 个月里混淆了 frm 谢谢 Sushil Kr Singh

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T02:27:31.350

为了按小时汇总 10 分钟的日志文件，您可以在 map 函数中将每个日志文件的时间戳四舍五入到最接近的小时，并在 reduce 函数中按小时对结果进行分组。

这是一个从 mongo shell 说明这一点的小虚拟示例：

1.  创建 100 个日志文件，每间隔 10 分钟，包含一个 0-10 之间的随机数，并将它们插入到`logs`数据库中的集合中：

    ```
    for (var i = 0; i < 100; i++) { 
        d = new ISODate();
        d.setMinutes(d.getMinutes() + i*10);
        r = Math.floor(Math.random()*11)
        db.logs.insert({timestamp: d, number: r})
    } 
    ```

    要检查`logs`集合的外观，请发送类似 的查询`db.logs.find().limit(3).pretty()`，其结果是：

    ```
    {
        "_id" : ObjectId("50455a3570537f9433c1efb2"),
        "timestamp" : ISODate("2012-09-04T01:32:37.370Z"),
        "number" : 2
    }
    {
        "_id" : ObjectId("50455a3570537f9433c1efb3"),
        "timestamp" : ISODate("2012-09-04T01:42:37.370Z"),
        "number" : 3
    }
    {
        "_id" : ObjectId("50455a3570537f9433c1efb4"),
        "timestamp" : ISODate("2012-09-04T01:52:37.370Z"),
        "number" : 8
    } 
    ```

2.  定义一个映射函数（在本例中称为`mapf`），将时间戳四舍五入到最接近的小时（向下舍入），用于发出键。发出值是该日志文件的编号。

    ```
    mapf = function () { 
        // round down to nearest hour
        d = this.timestamp;
        d.setMinutes(0);
        d.setSeconds(0);
        d.setMilliseconds(0);
        emit(d, this.number); 
    } 
    ```

3.  定义一个 reduce 函数，对所有发出的值（即数字）求和。

    ```
    reducef = function (key, values) {
        var sum = 0;
        for (var v in values) {
            sum += values[v];
        }
        return sum;
    } 
    ```

4.  现在对日志集合执行 map/reduce。这里的`out`参数指定我们要将结果写入`hourly_logs`集合并将现有文档与新结果合并。这确保了稍后提交的日志文件（例如，在服务器故障或其他延迟之后）一旦出现在日志中就会包含在结果中。

    ```
    db.logs.mapReduce(mapf, reducef, {out: { merge : "hourly_logs" }}) 
    ```

5.  最后，要查看结果，您可以查询一个简单的 find `hourly_logs`：

    ```
    db.hourly_logs.find()

    { "_id" : ISODate("2012-09-04T02:00:00Z"), "value" : 33 }
    { "_id" : ISODate("2012-09-04T03:00:00Z"), "value" : 31 }
    { "_id" : ISODate("2012-09-04T04:00:00Z"), "value" : 21 }
    { "_id" : ISODate("2012-09-04T05:00:00Z"), "value" : 40 }
    { "_id" : ISODate("2012-09-04T06:00:00Z"), "value" : 26 }
    { "_id" : ISODate("2012-09-04T07:00:00Z"), "value" : 26 }
    { "_id" : ISODate("2012-09-04T08:00:00Z"), "value" : 25 }
    { "_id" : ISODate("2012-09-04T09:00:00Z"), "value" : 46 }
    { "_id" : ISODate("2012-09-04T10:00:00Z"), "value" : 27 }
    { "_id" : ISODate("2012-09-04T11:00:00Z"), "value" : 42 }
    { "_id" : ISODate("2012-09-04T12:00:00Z"), "value" : 43 }
    { "_id" : ISODate("2012-09-04T13:00:00Z"), "value" : 35 }
    { "_id" : ISODate("2012-09-04T14:00:00Z"), "value" : 22 }
    { "_id" : ISODate("2012-09-04T15:00:00Z"), "value" : 34 }
    { "_id" : ISODate("2012-09-04T16:00:00Z"), "value" : 18 }
    { "_id" : ISODate("2012-09-04T01:00:00Z"), "value" : 13 }
    { "_id" : ISODate("2012-09-04T17:00:00Z"), "value" : 25 }
    { "_id" : ISODate("2012-09-04T18:00:00Z"), "value" : 7 } 
    ```

结果是 10 分钟日志的每小时摘要，其中 _id 字段包含小时的开始，值字段包含随机数的总和。在您的情况下，您可能有不同的聚合运算符；根据您的需要修改reduce函数。

正如 Sammaye 在评论中提到的，您可以使用 cron 作业条目自动执行 map/reduce 调用，以每小时运行一次。

如果您不想每次都处理完整的日志集合，您可以通过将文档限制为每小时时间窗口来运行增量更新，如下所示：

```
var q = { $and: [ {timestamp: {$gte: new Date(2012, 8, 4, 12, 0, 0) }},                                                  
                  {timestamp: {$lt:  new Date(2012, 8, 4, 13, 0, 0) }} ] }

db.logs.mapReduce(mapf, reducef, {query: q, out: { merge : "hourly_logs" }}) 
```

这将仅包括 12 到 13 小时之间的日志文件。请注意，Date() 对象中的月份值从 0 开始（8 = 九月）。由于该`merge`选项，在已处理的日志文件上运行 m/r 是安全的。

# mongodb - OSX Lion 上的 imagick 和 mongo 与 brew

> ID：12253215
> 
> 赞同：1
> 
> 时间：2012-09-03T19:40:30.560
> 
> 标签：mongodb, osx-lion, homebrew, imagick

我正在尝试在 osx lion 上安装 imagick 和 mongo。请注意，我的 php 安装是通过自制软件完成的。我已经正确安装了软件包，它应该可以工作，但是 php 返回以下内容

警告：PHP 启动：imagick：无法初始化模块 使用模块 API=20090626 编译的模块 使用模块 API=20100525 编译的 PHP 这些选项需要在第 0 行的未知中匹配

PHP 警告：PHP 启动：mongo：无法初始化模块 使用模块 API=20090626 编译的模块 使用模块 API=20100525 编译的 PHP 这些选项需要在第 0 行的未知中匹配

关于如何解决这个问题的任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:31:43.537

PHP 错误表明您已经从您尝试使用扩展的服务器（*20100525 API 是 PHP 5.4）编译了不同 API 版本的扩展（* *20090626* API 是 PHP 5.3）。

 *我怀疑您已经通过自制软件安装了 PHP 5.4，但在编译扩展时设法获取了 OS X 默认标头（PHP 5.3）。您需要使用 PHP 5.4 重新编译您的扩展，或者将您的 Web 服务器降级到 PHP 5.3。

您可以使用以下命令检查路径中 PHP 标头的版本`php-config`：

```
php-config --version 
```

以及 PHP 和扩展 API 的版本：

```
php -i | egrep "PHP (Extension|Version)" 
```

可能的修复：

1.  首先包含`/usr/local/bin`在您的路径中，以便优先于系统默认值找到自制 PHP 版本：

    ```
    export PATH=/usr/local/bin:$PATH 
    ```

2.  通过 Homebrew 安装 PHP 5.3：

    ```
    brew uninstall php54

    brew install php53 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:53:20.840

作为参考，我想补充一点，当 brew 安装 php 时，它将附加的 ini 文件读取文件夹设置为 /usr/local/etc/php/5.4/php5/conf.d

虽然它实际上是 /usr/local/etc/php/5.4/conf.d

您可以通过符号链接轻松解决该问题

```
cd /usr/local/etc/php/5.4/
mkdir php5
cd php5
ln -s ../conf.d . 
```*

# php - 需要 CodeIgniter Active Records 帮助

> ID：12253216
> 
> 赞同：0
> 
> 时间：2012-09-03T19:40:31.437
> 
> 标签：php, mysql, codeigniter, activerecord

我试图从数据库结构所在的数据库中找出每个网站类别中上传的最新图像：

tbl_cat：cat_id、cat_name、noi（该猫中的总图像数） tbl_img：img_id、cat_id、img_path、imag_caption

知道如何使用活动记录来做到这一点。我也很想用 sql 查询来理解它。我知道它很蹩脚，但我才刚刚开始。对于那个很抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:46:40.497

给出的数据库模式没有在类别或图像表中记录创建日期。我认为获取此信息的唯一合法方法是命令行`cd`进入图像目录并执行`ls --full-time --sort=time`（在基于 Debian 的系统上）或等效的方法。

**评论后更新1：**

跑：`SELECT c.cat_id, c.cat_name, i.doc, i.img_path FROM tbl_cat c LEFT JOIN tbl_img i ON i.cat_id = c.cat_id WHERE doc = (SELECT MAX(doc) FROM tbl_img i2 WHERE i2.cat_id = c.cat_id`

# python - 如何比较两个非ASCII字符串

> ID：12253220
> 
> 赞同：0
> 
> 时间：2012-09-03T19:41:08.457
> 
> 标签：python, unicode, python-2.7, ascii

我想`Technical Diploma (±12 years)`与浏览器中存在的相同字符串进行比较。我在 Python 中运行 webdriver 测试，它`Technical Diploma (±12 years)`从数据库中获取并尝试与浏览器中存在的字符串进行比较。当我尝试比较时出现此错误

> UnicodeWarning: Unicode 相等比较未能将两个参数转换为 Unicode - 将它们解释为不相等

如何在 Python 中比较这些非 ASCII 字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T19:44:03.610

您的字符串之一不是 unicode 值，而是字节串。您想通过首先解码将其转换为 unicode：

```
'Non-ASCII value containing UTF8: \xc2\xb1'.decode('utf8') 
```

但是您首先必须弄清楚字节串的编码是什么。

如果您已经定义了源文件编码并且您在代码中将字符串定义为文字，请确保通过在字符串前面加上前缀将其定义为 Unicode 文字`u''`：

```
u'Technical Diploma (±12 years)' 
```

但是，我强烈建议您在继续之前阅读[Python Unicode HOWTO 。](http://docs.python.org/howto/unicode.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:47:31.380

Python 告诉你问题：首先转换为 UTF-8。

例子：

```
>>> u1='Technical Diploma (±12 years)'
>>> u2=u'Technical Diploma (±12 years)'
>>> u1==u2
__main__:1: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
False
>>> u1.decode('utf-8')==u2
True
>>> 
```

# sql-server - 在 SQL Server 2008 中创建调用存储过程的表

> ID：12253223
> 
> 赞同：1
> 
> 时间：2012-09-03T19:41:19.297
> 
> 标签：sql-server, sql-server-2008, proxy, migration, sybase

我正在将 SP 从 Sybase 迁移到 SQL Server，并且我有一个案例，他们使用“代理表”，这些表用于在查询中使用它们时在内部调用 SP...

用于创建代理表的语法是这样的：

```
USE myDatabase
go
sp_addobjectdef proxy_table_name, 'loopback.myDatabase..sp_name', 'rpc'
go
CREATE EXISTING TABLE proxy_table_name
(
    col1       int NOT NULL,
    col2       char(2) NOT NULL,
    col3       varchar(20) NOT NULL,
    _id_sp     int NULL
)
LOCK ALLPAGES
go 
```

SP 定义是这样的：

```
CREATE procedure sp_search_intermediary_agent
(
      @param_default_1      char(1)  = 'N',  
      @param_default_2      bit      = 0, 
      @i_id_query           int 
)
as
begin
........ (some code here)

  select col1, col2, col3 from table_where_data_is 
  where  id_table = @i_id_query
  return 0
end
go 
```

并且在查询中使用代理表，就好像它是一个普通表......

```
select col1, col2, col3,....
from  table_1, proxy_table_name
where table_1.id_field = proxy_table_name._id_sp 
```

请，关于如何将此“代理表”迁移到 SQL Server 2008 的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:06:56.377

看起来像一个[表值函数](http://msdn.microsoft.com/en-us/library/ms191165%28v=sql.105%29.aspx)。

# android - 在 Android 中取消 AsyncTask

> ID：12253226
> 
> 赞同：0
> 
> 时间：2012-09-03T19:41:39.513
> 
> 标签：android, android-asynctask

我想取消一个`Asynctask`in android 但我的实现有问题：

我的代码是：

私有类 SynchroTask 扩展 AsyncTask{ 私有 volatile boolean running = true;

```
 @Override
    protected void onPreExecute() {
        super.onPreExecute();
        //INITIALIZATIONS
    }

    @Override
    protected Void doInBackground(Void... params) {
        while (running) {
            //TASK
        }

        return null;
    }

    @Override
    protected void onCancelled(){
        super.onCancelled();
        running = false;
    }

    @Override
    protected void onPostExecute(Void result) {
        super.onPostExecute(result);
        Intent intent = AccountAddActivity.getIntent(getActivity());
        startActivity(intent);
        getActivity().finish();
        }
    }
} 
```

和 ：

```
mSynchroTask = new SynchroTask();

cancelButton.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View v) {

                if (mSynchroTask != null && mSynchroTask.getStatus() != AsyncTask.Status.FINISHED){
                    HDCApplication.hdcAppManager.mSynchroManager.removeAllTask();
                    mSynchroTask.cancel(true);
                    mSynchroTask = null;

                }   
            }

        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:54:04.953

这是您所做工作的一半实施

```
 mSynchroTask.cancel(true); 
```

> 可以通过调用 cancel(boolean) 随时取消任务。调用此方法将导致对 isCancelled() 的后续调用返回 true。调用此方法后，将在 doInBackground(Object[]) 返回后调用 onCancelled(Object)，而不是 onPostExecute(Object)。

这就是你所缺少的

> 为了确保尽快取消任务，如果可能（例如在循环内），您应该始终从 doInBackground(Object[]) 定期检查 isCancelled() 的返回值。

来源：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:48:21.973

```
if (mSynchroTask != null && mSynchroTask.getStatus() != AsyncTask.Status.FINISHED){
                mSynchroTask.cancel(true);
                mSynchroTask = null;

                HDCApplication.hdcAppManager.mSynchroManager.removeAllTask();

            } 
```

# css - 吉他和弦和歌词的降价

> ID：12253228
> 
> 赞同：16
> 
> 时间：2012-09-03T19:41:47.380
> 
> 标签：css, markdown, guitar, music-notation

我正在尝试找出一种能够存储带有同步吉他和弦的纯文本音乐歌词的好方法。显示时，我希望看到歌词在相应单词上方的“空白”行中以双倍行距呈现。这是我自己的个人歌词书，因此最终渲染将最常见于死树和屏幕上，但这最终可能会改变。我想我会给 Markdown 一个机会，当与一些 CSS 结合以使 <a> 标记呈现为准上标时，我能够得到以下格式“某种”的工作。我有点喜欢使用 <a> 标签的效果，因为我可以在文件底部为任何包含的和弦提供参考链接：

```
#Supertramp - Give A Little Bit

[A]

[D]Give a little bit[A][] [D]

  Give a little bit[G] of your[A] love to me[G][][A]

[D]: http://guitar.about.com/library/blchord_dmajor.htm  "D major"
[G]: http://guitar.about.com/library/blchord_gmajor.htm  "G major"
[A]: http://guitar.about.com/library/blchord_amajor.htm  "A major" 
```

CSS 和转换后的降价在这里：http: [//jsfiddle.net/654ct/13/](http://jsfiddle.net/654ct/13/)

```
h1 {
    font-family: Arial;
    font-size: 2em;
    margin-bottom: 1em;
}
p { 
    line-height:1em; 
    margin-bottom:1.1em;  
    font-family: Arial;
} 
a {
    position: relative;
    top: -1em;
    display:inline-block; 
    width: 0;
    overflow:visible; 
    color:#00F;
    font-weight:bold;
    font-family: Arial;
    text-decoration: none;
} 
```

我从这里借了很多 CSS： [样式化文本以使其出现在行上方（用于歌词上方的和弦）](https://stackoverflow.com/questions/4154014/styling-text-to-make-it-appear-above-the-line-for-chords-above-the-lyrics) 我正在写一个新主题，因为这主要是为了寻求降价帮助。

到目前为止，这种格式的好处是和弦可以与歌词“内联”编写，因此无论使用什么字体，歌词和音乐都保持同步。此外，我还获得了降价本身相当易读的额外好处。

唯一的问题是：

1.  如果有两个和弦需要播放而中间没有任何单词，则在 HTML 中呈现时，和弦字符会相互“重叠”。（我相信这是由宽度：0 引起的；但据我所知，这是在和弦变化时消除歌词中的间隙所必需的。）
2.  在相同的场景中，除了最后一个和弦之外的所有和弦都需要在和弦字母之后有一个 [] ，否则第二个和弦将被解释为对第一个和弦的描述。这使得降价比我想要的更忙。

有没有一种好方法可以通过 CSS 或通过更改降价来解决这些问题中的一个或两个？如果没有，除了为此编写我自己的吉他和弦特定标记语言之外，是否有人知道完全不同的替代方案？（即使我确实为此编写了自己的标记语言，我仍然需要解决问题 1 的帮助。）我知道选项卡格式，并且我正在寻找一些不太复杂的东西，因为我需要的只是提醒何时每个和弦都不是我手指需要放在哪里的明确图表。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T23:42:23.643

试试[Lilypond](http://lilypond.org/)，它使用一种特定于音乐的语言，并生成漂亮的输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-17T16:16:18.637

有一个很棒的软件可以很好地处理和打印歌本： http: [//www.patacrep.com/en/index.php](http://www.patacrep.com/en/index.php) 整个设置不是很容易，但结果令人印象深刻！

如果您需要将原始文本歌曲转换为该应用程序所需的格式，我只是编写了一个小 JS 脚本：[https](https://github.com/oliverpool/guitar-tabs_songtex.js) ://github.com/oliverpool/guitar-tabs_songtex.js （自述文件中提供了演示链接）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T19:50:19.350

如果您只是想打印出歌曲集，而不是开发自己的应用程序来创建样式化的乐谱，那么您应该查看这个 [移调应用程序](http://www.logue.net/xp/)。

如果您粘贴和弦/歌词文本文件，然后将旧键和新键设置为相同，它将为您提供所需的输出。

您可以选择和弦名称或完整的和弦指法图表（单击图表以在打印之前更改位置）。

我没有以任何方式参与这个应用程序——我只是在演出前打印出我自己的音乐时经常使用它。

输出示例：

[只有和弦字母。](http://nichoy.co.uk/chords/PHM.pdf)

[和弦指法图](http://nichoy.co.uk/chords/PHMChart.pdf)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-04T11:31:27.027

有几个类似的程序，但我最喜欢“Songsheet Generator”。

我已经使用它多年了，它非常可靠、良好的开发人员支持和扩展的 chordpro 代码，允许添加一些不错的小附加功能，例如“脚注”，即。文本放置在打印页面的页脚和屏幕投影中。

如果您需要与其他人共享歌曲表 - 或者只是给自己的提醒 - 并且您想要指定特定的和弦变化甚至特定的手指在品格上的位置，那么定义自定义和弦定义也非常容易。

歌曲表生成器：[http ://www.tenbyten.com/software/songsgen/](http://www.tenbyten.com/software/songsgen/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-02T12:22:27.713

您可以查看我的 G-Songbook： [https](https://my-gsongbook-2-app.appspot.com/) ://my-gsongbook-2-app.appspot.com/ 它涉及放置和渲染和弦的前后，可选的图表。它是一个 Google Drive 应用程序。

# java - 使用缺少字段的杰克逊反序列化json

> ID：12253233
> 
> 赞同：2
> 
> 时间：2012-09-03T19:42:07.540
> 
> 标签：java, json, jackson, deserialization

我正在尝试使用 Jackson 反序列化此 JSON，但我遇到了数组部分的问题，如您所见，它没有字段名称。java代码需要什么样的反序列化？

```
 {
       "foo":[
          [
             "11.25",
             "0.88"
          ],
          [
             "11.49",
             "0.78976802"
          ]
       ],
       "bar":[
          [
             "10.0",
             "0.869"
          ],
          [
             "9.544503",
             "0.00546545"
          ],
          [
             "9.5",
             "0.14146579"
          ]
       ]
    } 
```

谢谢，

公元前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:46:34.113

`foo`最接近的映射（没有更多上下文）将是`bar`每个双数组（二维数组）的数组。

```
public class FooBarContainer {

    private final double[][] foo;
    private final double[][] bar;

    @JsonCreator
    public FooBarContainer(@JsonProperty("foo") double[][] foo, @JsonProperty("bar") double[][] bar) {
        this.bar = bar;
        this.foo = foo;
    }
} 
```

要使用：

```
public static void main(String[] args) throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    FooBarContainer fooBarContainer = mapper.readValue(CONTENT, FooBarContainer.class);

    //note: bar is visible only if main is in same class
    System.out.println(fooBarContainer.bar[2][1]); //0.14146579
} 
```

Jackson 可以轻松地将这些数据反序列化到此类中。

# cakephp - Cakephp 路由：使用破折号破坏了它

> ID：12253234
> 
> 赞同：0
> 
> 时间：2012-09-03T19:42:13.213
> 
> 标签：cakephp, routing

我有以下两条路线。

```
Router::connect('/photo-gallery/:slug-:id', 
                    array('controller' => 'company_categories', 'action' => 'photo_gallery'),
                    array(
                        'pass' => array('id'),
                        'id' => "[0-9]+"
                    )
    );

Router::connect('/:slug-my-string-:id',
                    array('controller' => 'company_categories', 'action' => 'category_companies'),
                    array(
                        'id' => "[0-9]+",
                        'pass' => array('id')
                    )
    ); 
```

虽然第一个有效，但第二个无效。

我究竟做错了什么 ？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:07:10.927

您的第二条路线不起作用，因为整个字符串 ":slug-my-string" 被解析为路线元素，而不仅仅是您所期望的 ":slug"。[参考](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Routing/Route/CakeRoute.php#L135)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T16:01:44.453

我最终找到并按预期工作的解决方案如下：

```
Router::connect('/:slug-:string-:id',
                    array('controller' => 'company_categories', 'action' => 'category_companies'),
                    array(
                        'id' => "[0-9]+",
                        'string' => "my-string"
                        'pass' => array('id')
                    )
    ); 
```

这样我就可以处理路由 url 模式中使用的所有类型的静态字符串，并且关于破折号（“-”）的解析不再有问题，我认为这是问题所在。

# c++ - 检查灰度图像中的像素是否为黑色（OpenCV）

> ID：12253237
> 
> 赞同：1
> 
> 时间：2012-09-03T19:42:29.373
> 
> 标签：c++, image-processing, opencv

我需要弄清楚我之前通过阈值算法处理的灰度图像上的任何给定像素是黑色还是白色。图像基本上变成白色背景上的黑色斑点。

```
Mat falsetest;

...

cv::cvtColor(detected_edges, falsetest, CV_BGR2GRAY);    
threshold(falsetest, falsetest,128, 255,THRESH_BINARY);

...

printf("x:%d y:%d %d\n",x,y,falsetest.at<uchar>(x,y)); 
```

我预计结果是 0 或 255，但事实并非如此。不同像素的输出如下所示：

```
x:1259 y:175 111
x:1243 y:189 184
x:1229 y:969 203
x:293 y:619 255
x:1123 y:339 183 
```

我是否试图以错误的方式做到这一点，或者似乎错误出在其他地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:06:41.100

你确定它`falsetest`包含 uchar 像素，而不是浮点数吗？在这种情况下，您需要访问以下值`falsetest`：

```
falsetest.at<float>(x,y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:20:29.810

CV 代码看起来不错。但是，您在 printf 中使用 %d 来显示 uchar。

要么使用 %hhd 要么做

```
static_cast<int>(falsetest.at<uchar>(x,y)). 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T16:57:56.747

我终于弄清楚了问题所在。我以为我打电话的时候

```
cv::cvtColor(detected_edges, falsetest, CV_BGR2GRAY); 
```

所有的矩阵数据都被复制到 falsetest。然而，似乎并非如此，当我着手修改检测到的边缘时，错误测试也被污染了。克隆矩阵解决了这个问题。

# ruby-on-rails - thumbs_up 中的路由错误

> ID：12253238
> 
> 赞同：0
> 
> 时间：2012-09-03T19:42:34.170
> 
> 标签：ruby-on-rails, rails-routing

我按照此答案中指示的步骤设置 thumbs_up

[https://stackoverflow.com/a/4963297/1643048](https://stackoverflow.com/a/4963297/1643048)

但是我不断收到此错误并且不知道如何解决它：

没有路线匹配 {:action=>"vote_up", :controller=>"posts", :id=>nil}

任何人都可以帮忙吗？

更新：

确切的错误-

> 路由错误
> 
> 没有路线匹配 {:action=>"vote_up", :controller=>"posts", :id=>nil}
> 
> 尝试运行 rake 路线以获取有关可用路线的更多信息。

**配置/路由.rb：**

```
Projectmadrone::Application.routes.draw do
  devise_for :admins
  #devise_for :users
  devise_for :users do get '/users/sign_out' => 'devise/sessions#destroy' end
  resources :posts do
    member do
        post :vote_up
       end
     end
  root :to => 'posts#index'
 end 
```

**我的观点：app/views/posts/index.html.erb**

```
<li><%= link_to('vote for this post!', vote_up_post_path(@post), :method => :post) %></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:11:59.210

您的 @post-variable 似乎为零。可能是因为您在索引视图而不是显示视图中使用它。因此，您应该尝试将 link_to-code 放入 app/views/posts/show.html.erb 中。

# r - ggplot2点之间的垂直线

> ID：12253239
> 
> 赞同：5
> 
> 时间：2012-09-03T19:42:42.063
> 
> 标签：r, ggplot2

我是新手，`ggplot2`无法弄清楚如何在

沿 x 轴的点/点。这是我的示例代码：

```
d1 <- runif(10,10,15)

d2 <- runif(10,25,30)

d3 <- rep(1:10,2)

df <- data.frame(x = d3, y = c(d1,d2))

ggplot(df, aes(x=x, y=y)) +

geom_point() 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-03T20:33:13.963

如果您的实际数据的结构与示例中使用的数据类似，只需添加`geom_line(aes(group = d3))`到图中即可。

```
ggplot(df, aes(x=x, y=y)) +  
 geom_point() + geom_line(aes(group = d3)) 
```

![在此处输入图像描述](../Images/cb5c5f8c0c3ffda12ab96826c45d8d86.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:59:50.890

肯定有比这更好的方法，但是：

```
d1 <- runif(10,10,15)
d2 <- runif(10,25,30)
d3 <- rep(1:10,2)
df <- data.frame(x = d3, y = c(d1,d2))
df$place <- rep(c("min", "max") , each=10)

df_wide <- reshape(df, direction = "wide", v.names="y", timevar="place", idvar="x") 

ggplot(df, aes(x=x, y=y)) +
    geom_segment(aes(x=x, xend=x, y=y.min, yend=y.max), 
        size=1, data=df_wide, colour="grey70", linetype="dotted") +
    geom_point() 
```

虽然我不确定“沿 x 轴”是什么意思，但也许您希望它从上到下延伸，而不仅仅是在点之间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:45:46.280

您应该使用它`geom_vline()`来执行此操作。

```
 d1 <- runif(10,10,15)
        d2 <- runif(10,25,30)
        d3 <- rep(1:10,2)
        df <- data.frame(x = d3, y = c(d1,d2))
       ggplot(df, aes(x=x, y=y)) + geom_point() + 
geom_vline(xintercept = df$x, linetype= 3, colour = "#919191") 
```

# ruby-on-rails-3 - 如何强制 Rails 预编译 SCSS 样式表？

> ID：12253244
> 
> 赞同：4
> 
> 时间：2012-09-03T19:43:15.043
> 
> 标签：ruby-on-rails-3, asset-pipeline

我正在尝试运行一个显然还没有准备好迎接黄金时段的 CRM gem。我正在尝试通过添加我发现程序有问题的所有内容来回馈该项目。

但我被困在资产预编译问题上。我在资产管道上大约有一英里宽和一英寸深。我跑了：

bundle exec rake assets:precompile

但是当尝试在浏览器中启动应用程序时，以下错误会写入日志文件：

```
ActionView::Template::Error (print.css isn't precompiled):
    5:     %title Not Ready Yet CRM
    6:     == <!-- #{controller.controller_name} : #{controller.action_name} -->
    7:     = stylesheet_link_tag :application
    8:     = stylesheet_link_tag :print, :media => 'print'
    9:     %style= yield :styles
    10:
    11:     = javascript_include_tag :application 
```

gem 中的实际文件不称为“print.css”。它被称为“print.css.scss”。

我在哪里告诉 Rails 在资产预编译中获取这些文件？如果我这样做了，它会自动知道如何解释 SCSS 文件吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T20:10:38.677

将其添加到`config.assets.precompile`config/application.rb 或`config/environments/production.rb`.

```
# Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
config.assets.precompile += %w( print.css ) 
```

# javascript - AddThis：Facebook 分享忽略分享配置

> ID：12253245
> 
> 赞同：3
> 
> 时间：2012-09-03T19:43:19.627
> 
> 标签：javascript, jquery, facebook, facebook-opengraph, addthis

我正在尝试动态添加 AddThis 工具箱。Twitter 和电子邮件从共享配置文件中接收到一些变量，但 Facebook 共享没有从那里获得任何信息。

我错过了什么？

HTML：

```
<span class="toolbox1 addthis_toolbox">
  <a class="addthis_button_facebook"></a>
  <a class="addthis_button_twitter"></a>
  <a class="addthis_button_linkedin"></a>
  <a class="addthis_button_email"></a>
</span> 
```

JS：

```
toolbox_obj = $('.toolbox1').get(0);
addthis.toolbox(toolbox_obj,sharing_config,{title: 'aaa'}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:23:43.800

你可以试试这个

**HTML**

```
<span class="toolbox1 addthis_toolbox"></span>​ 
```

**JS**

```
var tbx = $(".toolbox1").get(0),
svcs = {facebook: 'Facebook', twitter: 'Twitter', linkedin:'Linkedin', email: 'Email'};
$.each(svcs, function(k, v){
    $('<a></a>', { class:'addthis_button_'+k }).appendTo(tbx);
}); 
```

[**工作示例在这里。**](http://jsfiddle.net/7jv2H/1/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T14:19:10.817

[正如AddThis 文档](http://support.addthis.com/customer/portal/articles/381242-url-title#.UkrXdXe18h4)中所写：

> 一些服务，尤其是 Facebook 和 LinkedIn，不使用我们发送给它们的参数。相反，他们使用元标记来确定要共享的 URL、标题和描述。

一些服务（例如 Facebook 和 Linkedin）只是忽略这些配置信息，因为从 Open Graph 元标记中获取数据。

所以你应该在你的 HTML 中添加 Open Graph 元标记（尝试阅读[这个有用的资源](http://www.addthis.com/blog/2012/09/27/debugging-sharing-to-facebook/)），如果你遇到 AJAX 加载内容的问题，也许你可以通过特定的 addthis 方法强制 URL 来解决（显然在新内容已经加载）：

```
addthis.update('share', 'url', window.location.href); // re-parse the url
addthis.ready(); // re-render the buttons. 
```

现在，通过 Facebook 分享将正确地从页面中打开的 Graph 元标记中获取其数据。

这是解决我遇到的类似问题的好资源：

[AddThis 按钮不会更新以包含片段（#Hash 标签）](https://stackoverflow.com/questions/7514878/addthis-buttons-wont-update-to-include-fragment-hash-tag)

希望这可以帮助，再见！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-02T22:57:47.667

```
<HEAD>
<script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
<script src="http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script>

<meta property="og:title" content="Your Title" />
<meta property="og:type" content="website" />
<meta property="og:image" content="Your Thumbnail Image Link" />
<meta property="og:url" content="Your URL" />
<meta name="description" content="Your Description" />

<HEAD>

<a name="fb_share" type="button_count" href="http://www.facebook.com/sharer.php">Share</a> 
```

# ruby - 与另一个项目并行开发 gem

> ID：12253248
> 
> 赞同：3
> 
> 时间：2012-09-03T19:43:34.210
> 
> 标签：ruby, rubygems

假设您正在开发一个产品，并且您意识到某些代码足够通用，可以提取到 gem 中。

因此，您创建一个新项目，构建 gem，将其发布到 Rubygems，然后在主项目的 Gemfile 中引用它。

然后您会发现 gem 如何与您的产品交互的一个小错误。每次进行修复时，在本地构建和安装 gem 大约需要 15 秒。您如何最大限度地减少这种情况以实现快速的开发/测试周期？

（此外，本地构建的 gem 的版本号似乎与您推送到 Rubygems 的内容相矛盾，从而导致混淆。）

关于这个主题的任何最佳实践指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:01:13.397

bundler 不仅知道如何从 ruby​​gems 中获取宝石。您可以将其指向 git 存储库

```
gem  'mygem', :git => 'git => 'git://github.com/...' 
```

或者，在这种情况下更方便

```
gem 'mygem', :path => '~/work/mygem' 
```

其中 path 选项指向带有 gem 源的文件夹

# javascript - ExtJs 4 回调

> ID：12253249
> 
> 赞同：2
> 
> 时间：2012-09-03T19:43:37.893
> 
> 标签：javascript, extjs, extjs4, extjs4.1, extjs4.2

我很难找出我的作业丢失的原因，并发现回调范围与我想象的不同。

我所做的是在控制器中创建一个变量，然后尝试将回调传递给控制器​​创建的窗口，然后在该窗口上的事件上，回调控制器中的函数。

例如，在我的控制器中，我有：

```
callWindow: function(){
  var myWin = Ext.Create('MyApp.view.myWin', {doSomething: this.doSomething});
},

doSomething: function(data){
  this.myData = data;
},

useTheData: function(){
  console.log(this.myData);
} 
```

在 myWin 的控制器中，我有一个以这种方式调用 doSomething 的偶数处理程序：

```
onBtnClick: function(button){
  var win = button.up('window');
  var data = {id: 1, name: "John"}; // please, don't pay attention to this, it's a record I'm passing to the caller.
  win.doSomething(data);
} 
```

如您所见，在“doSomething”函数中，我分配了控制器 var myData，其值由窗口的控制器传递。最初我认为“doSomething”的范围是调用者控制器，但它是窗口的控制器，这就是为什么 useTheData 给出错误说 this.myData 为空。

我通过传递一个名为“caller:this”的新参数解决了这个问题，在doSomething中，接收该参数，并使用它而不是“this”。

问题是，是否有一种简单（步骤更少）的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:07:21.663

您需要将回调范围应用于窗口并使用[Ext.callback](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-callback)

```
callWindow: function(){
  var myWin = Ext.Create('MyApp.view.myWin', {doSomething: this.doSomething, scope: this});
},

onBtnClick: function(button){
  var win = button.up('window');
  var data = {id: 1, name: "John"}; // please, don't pay attention to this, it's a record I'm passing to the caller.
  Ext.callback(win.doSomething, win.scope, [data]);
} 
```

这是一种方式，您的解决方案是另一种方式，还有更多。

# javascript - 迁移到 requirejs 时如何调试 3rd 方库

> ID：12253253
> 
> 赞同：0
> 
> 时间：2012-09-03T19:43:56.410
> 
> 标签：javascript, requirejs, kendo-ui

我将一个项目移至 requirejs ，除了第 3 方库（不是 AMD 模块）的细节外，一切正常。我想知道关于在使用 requirejs 时解决这些类型问题的技术的任何建议。

第 3 方库是 kendo-ui，问题在于尝试通过调用 kendo.culture("es-MX") 来更改语言环境。正在调用该函数而没有错误，但它不能按预期工作。

使用剑道的方法是：加载剑道：加载语言环境：调用函数：kendo.culture("es-MX");

我检查了一下，唯一导出的全局变量被剑道脚本命名为剑道。我看不到 kendo.culture.es-MX.min.js 添加的任何全局变量

我在 requirejs 的主脚本中所做的设置是：

```
 require.config({
                 paths: {
                     jquery: 'lib/jquery-1.7.2.min',
                     signals: 'lib/signals',
                     hasher: 'lib/hasher',
                     crossroads: 'lib/crossroads',
                     kendo: 'lib/kendo.web.min',
                     kendoCulture: 'lib/cultures/kendo.culture.es-MX.min',
                     knockout: 'lib/knockout-2.1.0',
                     knockout_kendo: 'lib/knockout-kendo.min',
                     underscore: 'lib/underscore-min',
                     json2: 'lib/json2',
                     faclptController: 'faclpt/faclptController',
                     FacturaViewModel: 'faclpt/FacturaViewModel',
                     ConfigViewModel: 'faclpt/ConfigViewModel',
                     domReady: 'lib/domReady'
                 },
                 shim: {
                     'kendoCulture': {
                         deps: ['kendo']
                     },
                     'kendo' : {
                         exports: 'kendo'
                     }
                 }

               });

               require([
                   'require',
                   'jquery',
                   'knockout',
                   'knockout_kendo',
                   'underscore',
                   'json2',
                   'faclptController',
                   'FacturaViewModel',
                   'ConfigViewModel',
                   'domReady'
                   ], function (
                       require,
                       $,
                       ko,
                       knockout_kendo,
                       _,
                       json2,
                       faclptController,
                       FacturaViewModel,
                       ConfigViewModel,
                       domReady) {

                           // Start of Main Function
                           domReady(function () {

                           kendo.culture("es-MX");

                               // knockout Bindings
                               ko.applyBindings(FacturaViewModel, document.getElementById('Proceso'));

                               ko.applyBindings(ConfigViewModel, document.getElementById('Configuracion'));

                           });

               }); 
```

那么我还应该寻找什么？

我将不胜感激有关如何调试 requirejs 的任何技术或提示

# java - 如何制作无限平铺地图？（爪哇）

> ID：12253255
> 
> 赞同：0
> 
> 时间：2012-09-03T19:44:05.403
> 
> 标签：java, image, swing, awt

我正在制作平铺地图，但遇到了这个问题：当我移动我的角色时，它会离开地图然后掉落（由于重力） 我如何使这张地图无限？另外，我如何存储哪些块被破坏，哪些没有？这样我就可以用相同的地图重新绘制屏幕，​​当你回到起点时，破碎的块仍然在那里。

如果我需要提供代码，请告诉我。

我给你我的world.java

```
package game.test.src;

import java.awt.Graphics;
import java.awt.Image;
import java.awt.Rectangle;

import javax.swing.ImageIcon;

public class World {

    public Rectangle[] blocks;
    public boolean[] isSolid;
    public Image[] blockImg;
    public final int arrayNum = 500;

    //Block Images
    public Image BLOCK_GRASS, BLOCK_DIRT, BLOCK_STONE, BLOCK_SKY;

    private int x, y, xDirection, yDirection;;

    //map navigation
    static final int PAN_UP = 0, PAN_DOWN = 1, PAN_LEFT= 2, PAN_RIGHT = 3;

    public World(){
        BLOCK_GRASS = new ImageIcon("H:/2D game test/Game test 2/src/game/test/src/images/tile_grass.png").getImage();
        BLOCK_DIRT = new ImageIcon("H:/2D game test/Game test 2/src/game/test/src/images/tile_dirt.png").getImage();
        BLOCK_STONE = new ImageIcon("H:/2D game test/Game test 2/src/game/test/src/images/tile_stone.png").getImage();
        BLOCK_SKY = new ImageIcon("H:/2D game test/Game test 2/src/game/test/src/images/tile_sky.png").getImage();
        blocks = new Rectangle[500];
        blockImg = new Image[500];
        isSolid = new boolean[arrayNum];
        loadArrays();
    }

    private void loadArrays(){
        for(int i = 0; i < arrayNum; i++){
            if(x >= 500){
                x = 0;
                y += 20;
            }
            if(i >= 0 && i < 100){
                blockImg[i] = BLOCK_SKY;
                isSolid[i] = false;
                blocks[i] = new Rectangle(x, y, 20, 20);
            }
            if(i >= 100 && i < 125){
                blockImg[i] = BLOCK_GRASS;
                isSolid[i] = true;
                blocks[i] = new Rectangle(x, y, 20, 20);
            }
            if(i >= 125 && i < 225){
                blockImg[i] = BLOCK_DIRT;
                isSolid[i] = true;
                blocks[i] = new Rectangle(x, y, 20, 20);
            }
            if(i >= 225 && i < 500){
                blockImg[i] = BLOCK_STONE;
                isSolid[i] = true;
                blocks[i] = new Rectangle(x, y, 20, 20);
            }
            x += 20;
        }
    }

    public void draw(Graphics g){
        for(int i = 0; i < arrayNum; i++){
            g.drawImage(blockImg[i], blocks[i].x, blocks[i].y, null);
        }
    }

    public void moveMap(){
        for(Rectangle r : blocks){
            r.x += xDirection;
            r.y += yDirection;
        }
    }
    public void stopMoveMap(){
        setXDirection(0);
        setYDirection(0);
    }
    private void setXDirection(int dir){
        xDirection = dir;
    }
    private void setYDirection(int dir){
        yDirection = dir;
    }
    public void navigateMap(int nav){
        switch(nav){
            default:
                System.out.println("default case entered... Doing nothing.");
                break;
            case PAN_UP:
                setYDirection(-1);
                break;
            case PAN_DOWN:
                setYDirection(1);
                break;
            case PAN_LEFT:
                setXDirection(-1);
                break;
            case PAN_RIGHT:
                setXDirection(1);
                break;
        }
    }
} 
```

这是我的 Player.java

```
package game.test.src;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.event.MouseEvent;

import javax.swing.ImageIcon;

public class Player {

    static final int MOVE_UP = 0, MOVE_DOWN = 1, MOVE_LEFT= 2, MOVE_RIGHT = 3;
    private World world;

    private Rectangle playerRect;
    private Image playerImg;

    //Block Variables
    private int hoverX, hoverY;
    private boolean hovering = false;

    protected static int xDirection;
    protected static int yDirection;
    private Weapon weapon;

    public Player(World world){
        this.world = world;
        playerImg = new ImageIcon("H:/2D game test/Game test 2/src/game/test/src/images/Character.png").getImage();
        playerRect = new Rectangle(50, 0, 10, 36);
        weapon = new Weapon(weapon.PICKAXE);
    }
    private static void setXDirection(int d){
        xDirection = d;

    }
    private static void setYDirection(int d){
        yDirection = d;

    }
    public void update()
    {
        move();
        checkForCollision();

    }
    private void checkForCollision() {

    }
    private void move()
    {
        playerRect.x += xDirection;
        playerRect.y += yDirection;
        gravity();
    }
    private void gravity()
    {
        for(int i=0;i<world.arrayNum; i++)
        {
            if(!world.isSolid[i])
            {
                setYDirection(1);

            }
            else if(world.isSolid[i] && playerRect.intersects(world.blocks[i]))
            {
                setYDirection(0);
            }
        }
    }
    //MotionEvents

    public void mousePressed(MouseEvent e)
    {

    }

    public void mouseReleased(MouseEvent e)
    {

    }

    public void mouseClicked(MouseEvent e)
    {

    }

    public void mouseMoved(MouseEvent e)
    {
        int x = e.getX();
        int y = e.getY();
        int px = playerRect.x;
        int py = playerRect.y;
        for(int i = 0; i < world.arrayNum; i++)
        {
            if(weapon.isEquipped(Weapon.PICKAXE) &&
                    x > world.blocks[i].x && x < world.blocks[i].x + world.blocks[i].width && 
                    y > world.blocks[i].x && y < world.blocks[i].y + world.blocks[i].height && world.isSolid[i] && 
                    (world.blocks[i].x + (world.blocks[i].width / 2) ) <= (px + playerRect.width/2) + weapon.WEAPON_RADIUS &&
                    (world.blocks[i].x + (world.blocks[i].width / 2) ) >= (px + playerRect.width/2) - weapon.WEAPON_RADIUS &&
                    (world.blocks[i].y + (world.blocks[i].height / 2) ) <= (py + playerRect.height/2) + weapon.WEAPON_RADIUS &&
                    (world.blocks[i].y + (world.blocks[i].height / 2) ) >= (py + playerRect.height/2) - weapon.WEAPON_RADIUS)

            {
                hovering = true;
                hoverX = world.blocks[i].x;
                hoverY = world.blocks[i].y;
                break;
            }
            else
                hovering = false;
        }
    }
    public void mouseDragged(MouseEvent e)
    {

    }
    public void mouseEntered(MouseEvent e)
    {

    }
    public void mouseExited(MouseEvent e)
    {

    }

    //Drawing Methods
    public void draw(Graphics g)
    {
        g.drawImage(playerImg, playerRect.x, playerRect.y, null);
        if(hovering)
            drawBlockOutline(g);

    }

    private void drawBlockOutline(Graphics g)
    {
        g.setColor(Color.black);
        g.drawRect(hoverX, hoverY, world.blocks[0].width,world.blocks[0].height);
    }

    private class Weapon
    {
        public static final int UNARMED = 0;
        public static final int PICKAXE = 1; 
        public static final int GUN = 2;

        public int CURRENT_WEAPON;

        public int WEAPON_RADIUS;

        public Weapon(int w)

        {
            switch(w)
            {
                default:
                    System.out.println("No weapon selected");
                    break;
                case UNARMED:
                    CURRENT_WEAPON = UNARMED;
                    WEAPON_RADIUS = 100;
                    break;

                case PICKAXE:
                    CURRENT_WEAPON = PICKAXE;
                    WEAPON_RADIUS = 100;
                    break;

                case GUN:
                    CURRENT_WEAPON = GUN;
                    WEAPON_RADIUS = 100;
                    break;

            }

        }

        public void selectWeapon(int w)
        {
            switch(w)
            {
                default:
                    System.out.println("No weapon selected");
                    break;
                case UNARMED:
                    CURRENT_WEAPON = UNARMED;
                    WEAPON_RADIUS = 100;
                    break;

                case PICKAXE:
                    CURRENT_WEAPON = PICKAXE;
                    WEAPON_RADIUS = 100;
                    break;

                case GUN:
                    CURRENT_WEAPON = GUN;
                    WEAPON_RADIUS = 100;
                    break;

            }

        }

        public boolean isEquipped(int w)

        {
            if(w == CURRENT_WEAPON)
            {
                return true;
            }
            else
                return false;

        }

    }
    public void moveMap(){
        for(Rectangle r : world.blocks){
            r.x += xDirection;
            r.y += yDirection;
        }
    }
    public static void stopMoveMap(){
        setXDirection(0);
        setYDirection(0);
    }
    private static void setXDirection1(int dir){
        xDirection = dir;
    }
    private static void setYDirection1(int dir){
        yDirection = dir;
    }

    public static void navigatePlayer(int nav){
        switch(nav){
            default:
                System.out.println("default case entered... Doing nothing.");
                break;
            case MOVE_UP:
                setYDirection1(-1);
                break;
            case MOVE_DOWN:
                setYDirection1(1);
                break;
            case MOVE_LEFT:
                setXDirection1(-1);
                break;
            case MOVE_RIGHT:
                setXDirection1(1);
                break;
        }
    }
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:54:31.923

在基本级别上，您需要一个 3 维数组来存储每个块。问题是，这不会给你一个“无限”的世界，它会让你受限于记忆。

Notch 通过使用“块”解决了这个问题——这些块是固定大小的 3D 数组，可以在必要时交换到磁盘。

您还应该了解如何使用位来打包存储，对于您需要的任何大的东西——例如，每个块可以保存在 3 位中，2 位用于块，1 位用于“损坏”。如果您使用它而不是字节数组，您将使用不到 1/2 的存储空间，这意味着在需要从磁盘读取另一个块之前，您可能会在您的世界中走两倍的距离。

如果您想更轻松地介绍如何编写此类应用程序，请考虑使用 Bukkit 编写我的世界模组——大部分细节工作都已为您处理，您实际上可以在尝试之前获得很多关于如何完成工作的知识从头开始编写 Minecraft 克隆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:00:24.057

所以你需要的本质上是一个二维数据结构，它可以无限扩展（或直到内存耗尽）到两个维度。

有无数种方法可以解决这个问题。

一种方法是二维双链表（双链网？），其中每个地图图块都有对四个相邻图块的引用。这意味着您可以跟踪视口中心的图块并通过迭代到所有四个方向来渲染场景，直到您离开屏幕。当您点击未初始化的图块时，就该生成它了。

# python - {%block content%} 内烧瓶中的新行

> ID：12253259
> 
> 赞同：1
> 
> 时间：2012-09-03T19:44:25.503
> 
> 标签：python, flask, jinja2

因此，如果我要`{% block content %} {{variable}} {% endblock %}` 在我的 HTML 中执行类似的操作，并且`variable`等于`"Test <br /> test2"`如何
打印出来并且不换行？有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T22:05:06.383

Jinja2[自动为您转义特殊字符](http://flask.pocoo.org/docs/templating/#controlling-autoescaping)。可能最简单的方法是使用`safe`过滤器：

```
{{ variable|safe }} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T19:50:00.990

如果您的输出被转义并且您`<br />`在浏览器中看到文字文本，请关闭变量的自动转义：

```
{% block content %}{% autoescape false %} {{variable}} {% endautoescape %}{% endblock %} 
```

或告诉 Jinja2 该变量对于插值是安全的：

```
{% block content %} {{variable|safe}} {% endblock %} 
```

# python - 使用 Python 通过浏览器并行上传文件

> ID：12253267
> 
> 赞同：3
> 
> 时间：2012-09-03T19:45:33.540
> 
> 标签：python

以下代码以串行方式将多个文件从浏览器上传到主机。为了使过程更快，如何并行处理文件以便将多个流发送到服务器？如果将文件发送到同一主机，这是否值得追求？浏览器是否允许多个上传流到同一主机？如果是这样，这将如何工作？

我认为不可能将文件分成几部分并将它们并行编写，类似于此[示例](https://bitbucket.org/fabian/filechunkio/changeset/1960eeb8df4c5d9d5f916dd76534aa9c552de6cc)，因为它们是由浏览器而不是 Python 客户端提交的。

```
#!/usr/bin/python
import cgi, os
import shutil
import cgitb; cgitb.enable()  # for troubleshooting

form = cgi.FieldStorage()

print """\
Content-Type: text/html\n
<html><body>
"""

if 'file' in form:
   filefield = form['file']
   if not isinstance(filefield, list):
      filefield = [filefield]

   for fileitem in filefield:
       if fileitem.filename:
          fn = os.path.basename(fileitem.filename)
          # save file
          with open('/var/www/site/files/' + fn, 'wb') as f:
              shutil.copyfileobj(fileitem.file, f)
          # line breaks are not occuring between interations
          print 'File "' + fn + '" was uploaded successfully<br/>'
          message = 'All files uploaded'
else:
   message = 'No file was uploaded'

print """
<p>%s</p>
</body></html>
""" % (message) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T19:55:04.950

表单提交产生一个 HTTP 请求，该请求自然使用单个 TCP 连接来传递请求。

要并行上传多个文件，请并行发出多个请求。您可能需要客户端上的 flash 或 java applet。检查 javascript (AJAX) 是否允许并发多个表单提交。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-12T19:16:19.240

总体而言，提高性能是一个有趣的主题。关键是测量以找出瓶颈到底是什么。

我想瓶颈要么是浏览器加载要上传的文件，要么是加载期间的可用带宽（或两者兼而有之）。

如果瓶颈是从缓冲区保存文件（或将临时文件移动到它们的最终位置），那么将 for 循环转换为线程**可能会**有所帮助 - 假设 Web 服务器具有写入所有这些文件的 I/O 容量。但是只有在有大量文件要写入的情况下，线程才会有所帮助，否则重复生成线程（或加载队列并启动一组线程）的工作将比循环处理几个小文件要慢。

为了好玩，这里有一篇关于 python 线程和工作队列的文章：http: [//www.ibm.com/developerworks/aix/library/au-threadingpython/](http://www.ibm.com/developerworks/aix/library/au-threadingpython/)

Python CGI 和文件上传以及通过 POST 上传多个文件的参考：

*   [http://www.tutorialspoint.com/python/python_cgi_programming.htm](http://www.tutorialspoint.com/python/python_cgi_programming.htm)
*   [http://php.net/manual/en/features.file-upload.multiple.php](http://php.net/manual/en/features.file-upload.multiple.php)

# ruby-on-rails - Rails 中的尺寸、长度和数量

> ID：12253277
> 
> 赞同：25
> 
> 时间：2012-09-03T19:46:27.770
> 
> 标签：ruby-on-rails, ruby

```
1.9.3p194 :002 > u = User.find_by_email("email@mail.ru")
1.9.3p194 :005 > u.addresses.size
 => 1 
1.9.3p194 :006 > u.addresses.length
 => 1 
1.9.3p194 :007 > u.addresses.count 
```

Rails 3.2.3 中的大小、长度和计数没有区别，不是吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-04T06:04:46.387

**长度**将加载所有对象只是为了计算它们；就像是：

```
select * from addresses... 
```

然后返回结果计数。你可以想象 - 这是糟糕的表现

**计数**只会发出

```
select count(*) from addresses... 
```

哪个更好，因为我们加载所有地址并不是为了计算它们

**size**更智能 - 它会检查关联是否已加载，如果为 true，则返回长度（不调用数据库）。

**如果您的用户模型中有一个名为**address_count的字段，** **size**还会检查**counter_cache**，然后 size 将使用该字段进行计数，因此无需在地址表上发出计数。**

 ****如果全部失败，**size**`select count(*)`将在数据库上发出

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-18T17:17:49.457

1) 在 rails count 是一个 ActiveRecord 方法，因此 count 可以直接应用于模型名称：

```
> User.count
   (1.4ms)  SELECT COUNT(*) FROM "users"
=> 1 
```

但是 size 不是 ActiveRecord 方法，因此它会抛出错误

```
> User.size
"NoMethodError". 
```

2) Rails 中的大小可以与 ActiveRecord 数组一起使用（即 size 是 Array 方法）

```
> User.all.size
   (1.2ms)  SELECT COUNT(*) FROM "users"
=> 1 
```

3) count 将始终触发 ActiveRecord 查询。但 size 不会触发 ActiveRecord 查询，仅当记录或 ActiveRecord 数组已加载（执行）为：

```
 > d=User.all
  User Load (18.1ms)  SELECT "users".* FROM "users"
 => #<ActiveRecord::Relation [#<User id: 1, email: "fasf@f.df", name: "mano", dob: "2017-02-16", address: "fasfafasf", created_at: "2017-02-12 08:16:12", updated_at: "2017-02-12 09:34:07", online: false>]> 
2.3.3 :009 > 
2.3.3 :010 >   d.count
   (1.3ms)  SELECT COUNT(*) FROM "users"
 => 1 
2.3.3 :011 > d.size
 => 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T04:49:24.843

如果“地址”是一个看起来像的关联，那么它们是不同的，但它们应该返回相同的结果。

#count 由 ActiveRecord 提供，将执行类似“select count(*) from addresses where user_id =”之类的操作。

在其他情况下，#addresses 将构建一个包含实际模型对象的数组，并且 #size 和 #length 由 Array 类或 Enumerable 提供。

所以#count 可能更快，因为计数发生在数据库中。如果您确实需要地址，那就不好了:)****

# eclipse - 使用 LWJGL 版本 2.8.4，添加 lwjgl_util 到项目找不到导入？

> ID：12253284
> 
> 赞同：1
> 
> 时间：2012-09-03T19:47:20.177
> 
> 标签：eclipse, opengl, lwjgl

我整个早上都在为此绞尽脑汁。我正在使用 Eclipse 并尝试导入这个 'org.lwjgl.opengl.glu.Sphere;' 到我的课。但是 Eclipse 找不到这个类。在我的研究中，我被告知此类位于 lwjgl_util.jar 中，我已将其包含在 Eclipse 中该项目的 java 构建路径中。除 .glu 类外，其他所有内容均导入。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T07:15:59.563

首先，要使用 LWJGL 设置 Eclipse，请访问 LWJGL Wiki[页面](http://www.lwjgl.org/wiki/index.php?title=Setting_Up_LWJGL_with_Eclipse)，在那里您可以找到很好的详细教程。对于 OpenGL 现代管道教程。一个好人将示例从“OpenGL SuperBible 5”移植到 LWJGL。[在这里](https://code.google.com/r/zaphosmatthewnicholls-opengl-superbible-java/)您可以找到它们。教程使用 OpenGL 3.3，这意味着您可能在 NEHE 教程中看到的所有旧（固定）功能都被忽略了。希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T08:28:37.187

我刚刚使用 lwjgl 2.8.5 为我的项目解决了这个问题，`org.lwjgl.util.glu.Sphere`它位于`lwjgl_util-2.8.5.jar`maven 依赖项中的类路径是

```
 <dependency>
        <groupId>org.lwjgl.lwjgl</groupId>
        <artifactId>lwjgl</artifactId>
        <version>${org.lwjgl.version}</version>
    </dependency>
    <dependency>
        <groupId>org.lwjgl.lwjgl</groupId>
        <artifactId>lwjgl_util</artifactId>
        <version>${org.lwjgl.version}</version>
    </dependency> 
```

# mysql - 对分组元素的乘积进行 Sql SUM

> ID：12253287
> 
> 赞同：1
> 
> 时间：2012-09-03T19:47:34.820
> 
> 标签：mysql, sql

我有以下数据结构：

**表1（组）：**

```
ID  | Group
=============
1   | Sample
2   | Data 
```

**表2（项目）：**

```
ID  | GroupID | Cost | Amount
==============================
 1  |       1 |   1  | 12
 2  |       1 |   7  | 15
 3  |       1 |   3  |  8
 4  |       2 |   2  | 12 
```

并想要以下（查询）**结果**：

```
groups.ID | groups.Name | total
        1 | Sample      | 141
        2 | Data        |  24 
```

总计是组中所有项目的成本和金额的乘积之和，即组 1：`1*12+7*15+3*8=141`

我想我必须做点什么

```
SELECT g.ID, g.Group, SUM(Products) 
FROM groups AS g, items AS i 
WHERE g.ID=i.GroupID 
GROUP BY i.GroupID 
```

但不知道具体是什么。在带有循环的客户端软件中做 iit 没问题，但我很好奇（并且确定）这可以在（我的）Sql 中完成

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:50:08.167

```
SELECT g.ID as ID, g.Group as Name, SUM(i.Cost * i.Amount) as total
FROM groups g
INNER JOIN items i ON i.GroupID = g.ID
GROUP BY g.Group, g.ID 
```

在 SQL 中拥有一个名为“Group”的字段是一个非常糟糕的主意（保留关键字）

# intellij-idea - 是否有 IdeaJ 的代码配色方案库

> ID：12253288
> 
> 赞同：3
> 
> 时间：2012-09-03T19:47:34.893
> 
> 标签：intellij-idea, color-scheme

[..就像http://studiostyl.es/](http://studiostyl.es/)上的VS一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T03:53:01.743

有一个[第三方插件](http://plugins.intellij.net/plugin/?idea&pluginId=6892)和存储库站点：http: [//ideacolorschemes.com/](http://ideacolorschemes.com/)。

# android - 使用工厂方法创建片段和 Fragment.instantiate 有什么区别？

> ID：12253291
> 
> 赞同：0
> 
> 时间：2012-09-03T19:48:12.293
> 
> 标签：android, android-fragments

嗨，伙计，我正在使用综合浏览量“JakeWharton-lib”，我在网上看到了一个示例，并且在某些示例中使用了工厂方法来创建片段。

```
 @Override
    public Fragment getItem(int position) {
        return TestFragment.newInstance(CONTENT[position % CONTENT.length]);
    } 
```

在其他示例中使用 Fragment.Instantiate(...) 有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:04:15.353

`newInstance`不是 Fragments API 的一部分，它是一个方便的辅助方法。它可以具有在特定情况下方便的任何签名。而是API`instantiate`的一部分。它有一个固定的签名。

# jquery - jquery自动完成返回自定义列表？

> ID：12253294
> 
> 赞同：0
> 
> 时间：2012-09-03T19:48:38.820
> 
> 标签：jquery, list, autocomplete, fixed

我正在使用 jquery 自动完成插件，效果很好。

但是，我想自定义我的数据，以便我可以返回一组固定的数据。

示例：它的典型工作方式 - 您只需输入一个像 'a' 这样的字母，它就会返回匹配的 'j'（'aloe'、'babe'、'car'）。

但是，我想要一个功能，以便无论您输入什么，它都会返回一个固定列表，例如“一”、“二”、“三”——无论您输入什么字母。

我该如何修改才能做到这一点？

# c++ - Qt 编译器标志顺序

> ID：12253297
> 
> 赞同：4
> 
> 时间：2012-09-03T19:48:46.187
> 
> 标签：c++, qt, gcc, compilation, clang

我的目标是摆脱某些类型的编译器警告。我发现我可以通过在我的 .pro 文件中添加编译器标志来做到这一点：

```
QMAKE_CXXFLAGS += -Wno-unused-variable -Wno-reorder 
```

问题是它们是在 Qt 构建系统生成的标志之前添加的。我检查了我的编译器输出：

> g++-4.2 -c -pipe -Wno-unused-variable -Wno-reorder -g -gdwarf-2 -arch x86_64 -Xarch_x86_64 -mmacosx-version-min=10.5 -Wall -W -DQT_OPENGL_LIB -DQT_GUI_LIB -DQT_CORE_LIB

所以你可以看到*-Wall 追随*我的标志并丢弃它们。我应该怎么做才能在之后添加这些标志？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:24:36.503

不要使用`QMAKE_CXXFLAGS`而是`QMAKE_CXXFLAGS_WARN_ON`用您自己的警告覆盖：

```
QMAKE_CXXFLAGS_WARN_ON = -Wno-unused-variable -Wno-reorder 
```

# asp.net-mvc - 我应该如何声明与默认创建的 MVC .NET Memberships/Users 表的外键（UserId）关系？

> ID：12253300
> 
> 赞同：0
> 
> 时间：2012-09-03T19:49:27.920
> 
> 标签：asp.net-mvc, entity-framework-4.1, entity-framework-migrations

想到的是做这样的事情：

```
public class UserProfile
{
    [Key]
    [Column(Order = 0)]
    [ForeignKey("User")]
    public Guid UserId { get; set; }

    public virtual User User { get; set; }

    // Additional user info
} 
```

但我收到此错误：

> \tSystem.Data.Entity.Edm.EdmEntityType: : EntityType 'User' 没有定义键。定义此 EntityType 的键。\tSystem.Data.Entity.Edm.EdmEntitySet: EntityType: EntitySet 'Users' 基于没有定义键的类型'User'。

我错过了什么？反正没有写一个自动迁移到sql表的类（代码优先）吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:00:55.260

如果不清楚什么是主键，则只需要 [Key] 注释。但约定是它的类名以 Id 结尾，并且您需要 User 类中的 UserId 属性。所以恕我直言，我认为应该是这样的：

```
 public class UserProfile
    {
        [Key]
        public UserProfileId
        public Guid UserId { get; set; }
      [ForeignKey("UserId")]
        public virtual User User { get; set; }
        // Additional user info
    } 
```

> 我错过了什么？反正没有写一个自动迁移到sql表的类（代码优先）吗？

是的，当您的代码需要使用将创建的类时，或者您可以使用脚手架。我现在使用迁移工具来强制快速创建所有表。参见例如这里[关于迁移工具的 MSDN 文章 关于迁移](http://msdn.microsoft.com/en-US/data/jj591621) [的博客](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)

# android - notifyDataSetChanged 没有更新我的微调器

> ID：12253301
> 
> 赞同：1
> 
> 时间：2012-09-03T19:49:36.613
> 
> 标签：android, android-listview, android-spinner, android-adapter

我有 2 个带有两个不同适配器（`adapter`和`adapter2`）的微调器。根据我选择的第一个适配器 ( `adapter`)，我正在填充我的第二个微调器 ( `adapter2`)。在我要求更改第一个微调器中的数据后，`adapter2.notifyDataSetChanged();`但这并没有更新我的第二个微调器。有任何想法吗？

更新：如果我要求一个新的适配器并将其设置为这样，它正在更新：

```
adapter2 = new ArrayAdapter<String> (this, android.R.layout.simple_spinner_item, objectList);
playerSpinner.setAdapter(adapter2); 
```

但我认为这不是正确的做法......

```
ArrayAdapter<String> adapter = new ArrayAdapter<String> (this, android.R.layout.simple_spinner_item, sDefaultPositions);
positionSpinner.setAdapter(adapter);

adapter2 = new ArrayAdapter<String> (this, android.R.layout.simple_spinner_item, objectList);
playerSpinner.setAdapter(adapter2);

positionSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    @Override
    public void onItemSelected(AdapterView<?> parent, View arg1, int pos, long arg3)
    {
        changeSpinnerView(parent.getItemAtPosition(pos).toString());
        Log.i("YourTeam", "ItemSlected"+objectList.toString());
        adapter2.notifyDataSetChanged();
    }
});

    private void changeSpinnerView(String position)
{
    objectList = getResults(playerkey);
    Collections.sort(objectList);

}

public ArrayList<String> getResults(int key)
{
    BLLPlayer playerdatasource = new BLLPlayer(this);
    playerdatasource.open();

    ArrayList<PlayerBean> resultList = new ArrayList<PlayerBean>();

    resultList = (ArrayList<PlayerBean>) playerdatasource.getAllFunctionList(key);

    playerdatasource.close();

    return getPlayerName(resultList);
}

private ArrayList<String> getPlayerName(ArrayList<PlayerBean> resultList)
{
    ArrayList<String> nameList = new ArrayList<String>();

    for (int iIndex = 0; iIndex < resultList.size(); iIndex++)
    {
        String beanName = resultList.get(iIndex).getName();

        if (beanName.equals("1"))
        {
            beanName = "";
        }
        else
        {
            nameList.add(beanName);
        }
    }

    return nameList;

} 
```

# android - Android 应用不想做 HttpClient 请求

> ID：12253305
> 
> 赞同：1
> 
> 时间：2012-09-03T19:50:16.843
> 
> 标签：android, httpclient

我正在尝试启动第一个处理 Http 请求的应用程序。以下代码来自教程书，它不起作用：

```
package com.example.httpgetdemo;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;

public class Main extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        BufferedReader in = null;
        System.out.println("Before");
        try {
            HttpClient client = new DefaultHttpClient();
            HttpGet request = new HttpGet("http://google.com/");
            HttpResponse response = client.execute(request);

            in = new BufferedReader(new InputStreamReader(response.getEntity()
                    .getContent()));

            StringBuffer sb = new StringBuffer("");
            String line = "";

            String NL = System.getProperty("line.separator");
            while ((line = in.readLine()) != null) {
                sb.append(line + NL);
            }

            in.close();
            String page = sb.toString();

            System.out.println(page);
        } catch (Exception e) {
            e.printStackTrace();
        }

        finally {
            if (in != null) {
                try {
                    in.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

我说它不起作用是什么意思 - 我在手机上运行它，LogCat 显示第一个 System.out.println 但不显示第二个，错误提示：E/(1755): Can't open用于阅读的文件

我在这里阅读了一些关于以异步方式制作它的线程，但如果是这样，那么应用程序会崩溃，而且，更重要的是，这是一个书籍示例，所以它应该可以工作，不是吗？瞄准手机运行 ICS 怎么了？谢谢

# javascript - 'this' 不等于原型中的 Bar

> ID：12253311
> 
> 赞同：1
> 
> 时间：2012-09-03T19:50:36.593
> 
> 标签：javascript, arrays, object, callback

在下面的代码片段中，“this.x()”只能在情况 2 中调用（参见*main()*）。Bar 在情况 1 中也不等于此值，但在情况 2 中等于。

```
function Class_Bar() {
    this.panel = null;
    this.init = function () {
        // do some stuff
        this.panel = 20;
    }
    this.apply = function () {
        alert(Bar == this);
        Bar.x();
        this.x();
    }
    this.x = function() {
        alert("Some friendly message");
        alert(Bar.panel);
    }
}

var Bar = new Class_Bar();

function Class_Factory() {
    this.factories = new Array();
    this.add = function (init, apply) {
        this.factories.push({"init":init, "apply":apply});
    }
    this.init = function () {
        for (var i = 0; i < this.factories.length; ++i) {
            this.factories[i]["init"]();
        }
    }
    this.apply = function () {
        for (var i = 0; i < this.factories.length; ++i) {
            this.factories[i]["apply"]();
        }
    }
}

var Factory = new Class_Factory();

function main() {
    // Case 1
    Factory.add(Bar.init, Bar.apply);

    Factory.init();
    Factory.apply();

    // Case 2
    Bar.init();
    Bar.apply();
}

main(); 
```

[http://pastebin.com/fpjPNphx](http://pastebin.com/fpjPNphx)

任何想法如何“修复”/解决此行为？

我找到了一个可能的解决方案，但它似乎是一个“坏”的黑客。：[Javascript：如何从事件回调函数访问对象成员](https://stackoverflow.com/questions/4344287/javascript-how-to-access-object-member-from-event-callback-function)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:00:43.663

通过传递`Bar.init`，您实际上只是传递了函数，而不传递它所属的信息`Bar`（即`this`值应该是什么）。您可以做的是绑定该信息：

```
Factory.add(Bar.init.bind(Bar), Bar.apply.bind(Bar)); 
```

# mysql - SQL，连接表本身，在特定时间跨度内创建的顺序

> ID：12253313
> 
> 赞同：1
> 
> 时间：2012-09-03T19:50:41.823
> 
> 标签：mysql, sql, sql-server

我创建了一个包含 4 列的表，并根据大量 dataID 进行了排序：

```
 ID           Type             Item                Date
   AU761201      12.37.47         121212322     2012-07-12 22:21:12
   AU761201      12.37.42         157856388     2012-05-12 23:21:05
   AU761201      12.37.42         164687782     2009-02-12 12:37:24
   BD871015      15.31.62         651564488     2007-10-25 15:12:23
   DU551023      19.35.14         048040408     2011-11-05 14:15:23
   DU551023      19.35.14         056505654     2011-11-04 23:23:23
      .              .                .                   .
      .              .                .                   .
      .              .                .                   .
      .              .                .                   .
      .              .                .                   . 
```

我要做的是检查是否有任何“ID”在 24 小时的时间空间内购买了两件相同的商品（相同的“类型”编号）（在给出的示例中为 DU 551023），并整理出适用的 ID。

我的大脑目前正在因处理这个问题而流血，我们深表感谢所有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:59:50.707

对于**MySQL**

```
SELECT T1.id
FROM TableName T1 INNER JOIN TableName T2 
   ON T1.id = T2.id AND T1.Type = T2.Type AND T1.Item > T2.Item
WHERE ABS(HOUR(TIMEDIFF(T1.date, T2.date))) <= 24 
```

对于**SQL 服务器**

```
SELECT T1.id
FROM TableName T1 INNER JOIN TableName T2 
   ON T1.id = T2.id AND T1.Type = T2.Type AND T1.Item > T2.Item
WHERE ABS(DATEDIFF(hh, T1.date, T2.date)) <= 24 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:57:24.560

首先，您需要此表中的唯一键（用于区分记录）。假设它是 Item（否则在 T1.Item 中更改它！= T2.Item）。

```
select distinct T1.ID from Table T1, Table T2
where T1.ID = T2.ID and T1.Type = T2.Type 
  and Abs(T1.Date - T2.Date) < 1 and T1.Item != T2.Item
order by T1.ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:05:57.683

如果它的 SQL 服务器，那么你可以使用存在

```
SELECT DISTINCT
    a.ID
FROM    MyTable AS a
WHERE   EXISTS ( SELECT 1
             FROM   MyTable AS b
             WHERE  a.ID = b.ID
                    AND a.TYPE = b.Type
                    AND ABS(DATEDIFF(hour, a.Date, b.Date)) <= 24 )
ORDER BY a.ID 
```

或者你可以使用加入

```
SELECT DISTINCT a.ID
FROM MyTable AS a
INNER JOIN MyTable AS b
ON a.ID=b.ID AND a.TYPE=b.Type
WHERE ABS(DATEDIFF ( hour , a.Date , b.Date ))<=24
ORDER BY a.ID 
```

# javascript - jQuery JSON 错误：语法错误，无法识别的表达式

> ID：12253314
> 
> 赞同：6
> 
> 时间：2012-09-03T19:51:09.220
> 
> 标签：javascript, jquery, json

这是我第一次使用 JSON 的经验，所以我可能在做一些非常愚蠢的事情。

我构建了一个应用程序来抓取页面并返回一个 JSON 对象。

我返回的 JSON 如下所示（以 Facebook 为例）：

```
{"urlTitle":"Welcome to Facebook \u2014 Log in, sign up or learn more","urlDescription":" Facebook is a social utility that connects people with friends and others who work, study and live around them. People use Facebook to keep up with friends, upload an unlimited number of photos, post links and videos, and learn more about the people they meet."} 
```

但是，在 FireBug 中，我收到了上述错误（另见屏幕截图）。

我的 jQuery 代码通过 AJAX 获取 JSON，现在看起来很简单：

```
$("#submitButton").on("click", function(){ 

        $.ajax({

           url: '/miscellaneous/scrape/scrape.cfm',
           dataType: 'json',
           data: {
              strURL:  $.param( $("#submitURL").attr("value") )
           },
           type: 'POST',
           success: function(data) {
               alert("yes!");
           }

        });

    return false;

}); 
```

我从来没有收到我的成功信息:(只是错误！

我在这里做一些明显错误的事情吗？

谢谢，迈克尔。

![在此处输入图像描述](../Images/abf41f7f94d9cb3ec15ec13f43eb35c8.png)

编辑

这是我要求的整个 JSON：

```
{"urlTitle":"Welcome to Facebook \u2014 Log in, sign up or learn more","urlImages":{"image_8":"http:\/\/static.ak.fbcdn.net\/rsrc.php\/v2\/yb\/r\/GsNJNwuI-UM.gif","image_6":"http:\/\/photos-g.ak.fbcdn.net\/photos-ak-snc7\/v85005\/226\/255889644513526\/app_104_255889644513526_1061222291.png","image_7":"http:\/\/secure-us.imrworldwide.com\/cgi-bin\/m?ci=ent156564&am=3&ep=1&at=view&rt=banner&st=image&ca=cmp7747&cr=crv72918&pc=plc220331&r=1346702536","image_4":"http:\/\/photos-a.ak.fbcdn.net\/photos-ak-snc7\/v85006\/156\/156324174503268\/app_104_156324174503268_1504955413.png","image_5":"http:\/\/photos-b.ak.fbcdn.net\/photos-ak-snc7\/v85005\/78\/344521295633922\/app_104_344521295633922_1943760717.png","image_3":"http:\/\/photos-c.ak.fbcdn.net\/photos-ak-snc7\/v85005\/14\/298987460188718\/app_104_298987460188718_170436975.png","image_2":"http:\/\/photos-g.ak.fbcdn.net\/photos-ak-snc7\/v85006\/196\/287530028007964\/app_104_287530028007964_853932327.png","image_1":"http:\/\/static.ak.fbcdn.net\/rsrc.php\/v2\/yY\/r\/2LiCtrj0cdC.png"},"urlDescription":" Facebook is a social utility that connects people with friends and others who work, study and live around them. People use Facebook to keep up with friends, upload an unlimited number of photos, post links and videos, and learn more about the people they meet."} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-25T13:26:19.987

嗨根据您对问题的评论.. 看起来您正在寻找一种方法来避免 AJAX 请求进行缓存。为此，您可以尝试这样的事情..

```
$.ajax({
       url: url,
       data: inputs + '&ran=' + Math.rand(),
    )}; 
```

或者

```
$.ajaxSetup ({
    // Disable caching of AJAX responses
    cache: false
}); 
```

我希望这能帮到您。

# java - 简单的uml图到java代码

> ID：12253315
> 
> 赞同：1
> 
> 时间：2012-09-03T19:51:14.907
> 
> 标签：java, uml

暑假后，我正在尝试更新我的编程和 UML。这是我想转换成 Java 代码的 UMLdiagram。

![UML 图](../Images/c1ebe055e384805d897d851a56159203.png)

到目前为止，这是我的代码，我不确定它是否接近正确。

```
public class Money {
public int money;
public int kronor, öre;
public Money(int kronor, int öre){
}

public int getKronor(){
    return kronor;
}

public int getÖre(){
    return öre;
}

public boolean isPositive(){
    return (money>0);
}

public boolean isNegative(){
    return (money<0);
}

public boolean isZero(){
    return (money==0);
}

public String toString(){

}

} 
```

最大的问题是我不完全确定这些方法是什么？意思/做。

```
+Money(in money : Money)
+Money(in kronor : int, in öre : int)
+add(in addend : Money) : Money
+subtract(in subtrahend : Money) : Money 
```

这可能是我不确定的“在”事情！

作为奖励，我将不胜感激任何好的链接，或者如果你能指出一些如何实现这些方法的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:58:06.957

```
+Money(in money : Money) 
```

这是一个构造函数 - 它创建一个新的 Money 对象，其值与传入的 Money 对象相同。

```
+Money(in kronor : int, in öre : int) 
```

这是一个构造函数 - 它使用传入的相同值创建一个 Money 对象（主要单位和次要单位（克朗/öre、美元/美分、英镑/便士等）

```
+add(in addend : Money) : Money 
```

此方法将作为参数传入该方法的 Money 对象添加*到此*Money 对象，并返回一个新的 Money 对象，该对象是两者的总和。“添加”是指添加到此对象的对象。

```
+subtract(in subtrahend : Money) : Money 
```

希望到现在为止，您可以猜到这个是做什么的。“减数”是指从这个对象中减去的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:59:27.253

+金钱（金钱：金钱）

它是一个构造函数

+Money(in kronor : int, in öre : int) 它是一个contructor

+add(in addend : Money) : Money 它是一个函数

+subtract(in subtrahend : Money) : Money 它是一个函数

```
public Money(Money money) 
{
// a copy contructor
}

public Money(int kronor, int ore){
// an initializer contructor
}

public Money add(Money addend){
// add the param, return the value
}
public Money subtract(Money subtrahend){
// substract subtrahend and return the value
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:01:33.493

方法参数前面的`in`意思是它只用于方法的输入。该方法生成的返回给调用者的任何输出都只会通过`return`. 如果参数前面`out`有方法本身会改变参数，在调用它之后你会在传递的对象中找到它的输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:01:51.690

+Money(in money : Money) 和 +Money(in kronor : int, in öre : int) 是您班级的结构

+add(in addend : Money) : Money (把钱加到旧的钱上) +subtract(in subtrahend : Money) : Money(从旧的钱中减去钱)

您可以使用模型驱动的 UML 工具（[http://www.sparxsystems.com.au/](http://www.sparxsystems.com.au/)），因此您只需添加模型并生成类。

# azure - ACS 不会将安全令牌回发到返回 url

> ID：12253317
> 
> 赞同：0
> 
> 时间：2012-09-03T19:51:39.650
> 
> 标签：azure, visual-studio-2012, acs, azure-acs

我已经使用带有标准登录页面的 .NET4.0 + ACS2.0 成功设置了一个测试应用程序。一切正常。我单击我的登录按钮，重定向到 acs 登录页面，并且安全令牌已成功发布到 localhost:7777/Account/SignIn 到目前为止，一切顺利。

现在，我已经在 .NET4.5（使用 System.IdentityModel...）和带有标准登录页面的 ACS2.0 中设置了与上面相同的测试应用程序。我遵循向导身份和访问权限：

```
<system.identityModel>
    <identityConfiguration>
      <audienceUris>
        <add value="http://localhost:7777/" />
      </audienceUris>
      <issuerNameRegistry type="System.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <trustedIssuers>
          <add thumbprint="1111111111111111111111111111111111111" name="https://***********.accesscontrol.windows.net/" />
        </trustedIssuers>
      </issuerNameRegistry>
      <certificateValidation certificateValidationMode="None" />
    </identityConfiguration>
  </system.identityModel>
  <system.identityModel.services>
    <federationConfiguration>
      <cookieHandler requireSsl="false" />
      <wsFederation passiveRedirectEnabled="true" issuer="https://*************.accesscontrol.windows.net/v2/wsfederation" realm="http://localhost:7777/" reply="http://localhost:7777/Account/SignIn" requireHttps="false" />
    </federationConfiguration>
  </system.identityModel.services>

[HttpPost]
[ValidateInput(false)]
public ActionResult SignIn(FormCollection forms)
{
    var ip = ClaimsPrincipal.Current.IdentityProvider();
    var ni = ClaimsPrincipal.Current.NameIdentifier(); 
```

现在，当我单击我的登录按钮时，我成功重定向到标准登录页面，但 ACS 从未向我的登录页面发送回传...这是新 System.IdentityModel 中的错误...？还是我错过了什么。

# javascript - 单击 Enter 时发出消息

> ID：12253319
> 
> 赞同：2
> 
> 时间：2012-09-03T19:52:24.157
> 
> 标签：javascript, jquery

我有这个代码：

```
<html>
    <title>a</title>
    <head>
        <script type="text/javascript" src="jquery-1.8.0.js"></script>
        <script type="text/javascript">
            $("#target").keypress(function(event) {
                if ( event.which == 13 ) {
                    alert("Enter has been clicked.");
                }
            }
        </script>
    </head>
<body>
    <input type="text" id="target"></input>
</body>
</html> 
```

我希望在输入框中单击输入后出现一个消息框。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:55:56.513

```
 // DOM ready handler
$(function() {
    $("#target").keypress(function(event) {
        if ( event.which == 13 ) {
            alert("Enter has been clicked.");
        }
    }); // missing ")"
}); 
```

还要记住顶部的文档类型。

```
<!DOCTYPE html> 
```

并删除结束输入标签。

```
<input type="text" id="target"> 
```

正如@David 指出的那样，如果您使用`==`vs`===`进行相等比较，可能会有不同的结果。在这种情况下，它不会有什么不同，但为了安全起见，通常使用 是一个好主意`===`，并`==`在需要特定类型强制时使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:55:35.103

您的代码在`<input>`元素存在之前运行。您可以使用 domready 事件：

```
<script type="text/javascript">
$(function(){
  $("#target").keypress(function(event) {
    if ( event.which == 13 ) {
      alert("Enter has been clicked.");
    }
  });
});
</script> 
```

或者只是将该脚本标记放在文件的后面，可能就在`</body>`结束标记之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:00:17.627

见：http: [//jsfiddle.net/M8y5J/](http://jsfiddle.net/M8y5J/)

*   修复语法错误
*   [文件准备好](http://api.jquery.com/ready/)时加载（注意有多种方法）
*   [用于`on()`附加事件处理程序](http://api.jquery.com/on/)

## JavaScript

```
$(function(){
    $("#target").on("keypress", function(e){   
        if ( e.which === 13 ) {
            alert("Enter has been clicked.");
        }
    });
}); 
```

## 完整的 HTML

```
<!DOCTYPE html>
<html>
    <head>
        <title>Demo</title>
        <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.0.js'></script>
        <script type="text/javascript">
            $(function () {
                $("#target").on("keypress", function (e) {
                    if (e.which === 13) {
                        alert("Enter has been clicked.");
                    }
                });
            });
        </script>
    </head>
    <body>
        <input type="text" id="target" />
    </body>
</html> 
```

# jsf-2 - setPropertyActionListener 无法正常工作

> ID：12253321
> 
> 赞同：1
> 
> 时间：2012-09-03T19:52:56.450
> 
> 标签：jsf-2, primefaces

> **可能重复：**
> [primefaces selectOneMenu 在应该的时候不起作用](https://stackoverflow.com/questions/10726716/primefaces-selectonemenu-doesnt-working-when-it-should)

我的 setPropertyActionListener 没有设置相应的 bean 属性。**单击相应的删除按钮（ cbViewExcluir** ）后，我需要选择公开，该按钮在删除前显示确认对话框。下面是我的xhtml：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
            xmlns:h="http://java.sun.com/jsf/html"
            xmlns:f="http://java.sun.com/jsf/core"
            xmlns:p="http://primefaces.org/ui"
            template="./../../resources/templates/baseTemplate.xhtml">

<ui:define name="content">
    <f:view id="vRoot">
        <p:fieldset legend="Manage publics">
            <h:form id="frmPublics">

                <!-- Global messages -->
                <p:growl id="gMessages" sticky="false" globalOnly="true" />

                <!-- Public list on dataTable -->
                <p:dataTable id="dtPublics" 
                             value="#{publicBean.lstPublics}"
                             paginator="true" rows="5" 
                             rowsPerPageTemplate="5,10"
                             paginatorPosition="bottom"
                             paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             var="actual">

                    <f:facet name="header">
                        <p:commandButton id="cbViewNew" value="New" type="button"  onclick="dlgNew.show();" />
                    </f:facet>
                    <!-- Colunas de edição e exclusão -->
                    <p:column>
                        <f:facet name="header">
                            <h:outputLabel value="Edit"/>
                        </f:facet>
                        <p:commandButton id="cbViewEdit"  
                                         image="ui-icon-pencil" 
                                         title="Edit"
                                         update=":frmEdit:pEditPublic"
                                         oncomplete="dlgEdit.show();">
                            <f:setPropertyActionListener value="#{actual}" target="#{publicBean.selectedPublic}" />
                        </p:commandButton>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputLabel value="Delete"/>
                        </f:facet>
                        <p:commandButton id="cbViewDelete" onclick="dlgDelete.show();" 
                                         icon="ui-icon-close" title="Delete">
                            <f:setPropertyActionListener value="#{actual}" target="#{publicBean.selectedPublic}" />
                        </p:commandButton> 
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            Name
                        </f:facet>
                        <h:outputLabel id="olViewPublicName" value="#{actual.publicName}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            Public Type
                        </f:facet>
                        <h:outputLabel id="olViewPublicType" value="#{actual.publicType}"/>
                    </p:column>
                </p:dataTable>
            </h:form>

            <!-- New dialog -->
            <p:dialog id="dlgNewPublic" widgetVar="dlgNew" modal="true" header="New Public"
                      resizable="false">
                <h:form id="frmNew">
                    <p:panel id="pNewPublico">
                        <p:messages id="mNewMessages" redisplay="false" />
                        <p:panelGrid columns="2">
                            <p:outputLabel id="olNewPublicName" value="Name:" for="itNewPublicName"/>
                            <p:inputText id="itNewPublicName" value="#{publicBean.name}" required="true"
                                         requiredMessage="Enter the public name."/>

                            <p:outputLabel id="olNewPublicType" for="somNewPublicType" value="Public type:"/>
                            <p:selectOneMenu id="somNewPublicType" value="#{publicBean.publicType}" effect="fade" 
                                             converter="#{publicBean.converter}" 
                                             required="true" requiredMessage="Enter the public type."
                                             > 
                                <f:selectItem itemLabel="-- Select --" itemValue=""/>
                                <f:selectItems value="#{publicBean.publicTypes}" var="actual" itemLabel="#{actual.label}" itemValue="#{actual}"></f:selectItems>
                            </p:selectOneMenu>
                            <p:commandButton value="Cancel" immediate="true" onclick="dlgNew.hide()"/>
                            <p:commandButton id="cbSaveNew" value="Save" 
                                             actionListener="#{publicBean.save}"
                                             oncomplete="handleSave(xhr, status, args);" 
                                             update=":frmPublics:dtPublics :frmNew :frmPublics:gMessages"
                                             ajax="true"/>
                        </p:panelGrid>
                    </p:panel>
                </h:form>
            </p:dialog>

            <!-- Delete dialog -->
            <p:confirmDialog id="dialogDelete" message="Are you sure?"
                             header="Delete public" severity="alert" 
                             widgetVar="dlgDelete">
                <h:form id="frmDelete">
                    <p:commandButton id="cbDeleteCancel" value="Cancel" onclick="dlgDelete.hide()" type="button" /> 
                    <p:commandButton id="cbDeleteContinue" value="Continue"
                                     update=":frmPublics:dtPublics :frmPublics:gMessages" 
                                     oncomplete="dlgDelete.hide()"
                                     actionListener="#{publicBean.delete}"/>
                </h:form>
            </p:confirmDialog>

            <!-- Edit dialog -->
            <p:dialog id="dialogEdit" widgetVar="dlgEdit" header="Edit public"
                      resizable="false" modal="true">
                <h:form id="frmEdit">
                    <p:panel id="pEditPublic">
                        <p:messages id="mEditMessages" redisplay="false" />
                        <p:panelGrid columns="2">
                            <p:outputLabel id="olEditPublicName" value="Name:" for="itEditPublicName"/>
                            <p:inputText id="itEditPublicName" value="#{publicBean.selectedPublic.publicName}" required="true"
                                         requiredMessage="Enter the public name."/>

                            <p:outputLabel id="olEditPublicType" for="somEditPublicType" value="Public type:"/>
                            <p:selectOneMenu id="somEditPublicType" 
                                             value="#{publicBean.selectedPublic.publicType}" 
                                             effect="fade" 
                                             converter="#{publicBean.converter}" 
                                             required="true" 
                                             requiredMessage="Select a public type."
                                             > 
                                <f:selectItem itemLabel="-- Select --" itemValue=""/>
                                <f:selectItems value="#{publicBean.publicTypes}" 
                                               var="actual" 
                                               itemLabel="#{actual.label}" 
                                               itemValue="#{actual}"></f:selectItems>
                            </p:selectOneMenu>
                            <p:commandButton value="Cancel" immediate="true" onclick="dlgEdit.hide()"/>
                            <p:commandButton id="cbEditSave" value="Save" 
                                             actionListener="#{publicBean.alter}"
                                             oncomplete="dlgEdit.hide();" 
                                             update=":frmPublics :frmEdit"/>
                        </p:panelGrid>
                    </p:panel>
                </h:form>
            </p:dialog>
        </p:fieldset>
    </f:view>

    <!-- Javascript callbacks -->
    <script type="text/javascript">
        function handleSaved(xhr, status, args){
            if(args.saved){
                dlgNew.hide();
            }
        }
        function handleEdited(xhr, status, args){
            if(args.edited){
                dlgEdit.hide();
            }
        }
    </script>
</ui:define> 
```

我的bean如下：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
*/
package br.siseventos.managed;

import br.siseventos.dao.da.PublicoDAO;
import br.siseventos.dao.da.TipoPublicoDAO;
import br.siseventos.model.TbPublico;
import br.siseventos.model.TdTipoPublico;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.event.ActionEvent;
import javax.faces.model.SelectItem;
import org.primefaces.context.RequestContext;

@ManagedBean(name = "publicoBean")
@SessionScoped
public class PublicoBean {

    // Campos
    private TipoPublicoDAO daoTipoPublico = null;
    private PublicoDAO daoPublico = null;

    private String nome;
    private List<SelectItem> lstMenuTipoPublico = new ArrayList<SelectItem>();
    private TdTipoPublico tipoPublicoSelecionado = null;

    private List<TbPublico> lstDataTablePublico = null;
    private TbPublico publicoSelecionado;

    // Util
    private int maximoLinhasTablePublico = 5;
    private boolean mostrarMsg = false;

    // Construtor
    public PublicoBean() {
        // Inicializando as daos
        daoPublico = new PublicoDAO();
        daoTipoPublico = new TipoPublicoDAO();

        // Carregando o datatable de publicos
        lstDataTablePublico = daoPublico.consultarTodos();

        // Carregando o menu de tipos de público
        List<TdTipoPublico> l = getDaoTipoPublico().consultarTodos();
        Iterator<TdTipoPublico> i = l.iterator();
        while (i.hasNext()) {
            TdTipoPublico atual = (TdTipoPublico) i.next();
            lstMenuTipoPublico.add(new SelectItem(atual, atual.getNmeTipoPublico()));
        }
    }

    public TipoPublicoDAO getDaoTipoPublico() {
        return daoTipoPublico;
    }

    public void setDaoTipoPublico(TipoPublicoDAO daoTipoPublico) {
        this.daoTipoPublico = daoTipoPublico;
    }

    public PublicoDAO getDaoPublico() {
        return daoPublico;
    }

    public void setDaoPublico(PublicoDAO daoPublico) {
        this.daoPublico = daoPublico;
    }

    // Getters e Setters
    public String getNome() {
        return nome;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public List<SelectItem> getLstMenuTipoPublico() {
        return lstMenuTipoPublico;
    }

    public void setLstMenuTipoPublico(List<SelectItem> lstMenuTipoPublico) {
        this.lstMenuTipoPublico = lstMenuTipoPublico;
    }

    public TdTipoPublico getTipoPublicoSelecionado() {
        return tipoPublicoSelecionado;
    }

    public void setTipoPublicoSelecionado(TdTipoPublico tipoPublicoSelecionado) {
        this.tipoPublicoSelecionado = tipoPublicoSelecionado;
    }

    public List<TbPublico> getLstDataTablePublico() {
        return lstDataTablePublico;
    }

    public void setLstDataTablePublico(List<TbPublico> lstDataTablePublico) {
        this.lstDataTablePublico = lstDataTablePublico;
    }

    public int getMaximoLinhasTablePublico() {
        return maximoLinhasTablePublico;
    }

    public void setMaximoLinhasTablePublico(int maximoLinhasTablePublico) {
        this.maximoLinhasTablePublico = maximoLinhasTablePublico;
    }

    public boolean isMostrarMsg() {
        return mostrarMsg;
    }

    public void setMostrarMsg(boolean mostrarMsg) {
        this.mostrarMsg = mostrarMsg;
    }

    public TbPublico getPublicoSelecionado() {
        return publicoSelecionado;
    }

    public void setPublicoSelecionado(TbPublico publicoSelecionado) {
        this.publicoSelecionado = publicoSelecionado;
    }

    // Actions e listeners
    public void cadastrarPublico(ActionEvent ex) {
        FacesContext contexto = FacesContext.getCurrentInstance();
        FacesMessage msg = new FacesMessage();
        try {
            TbPublico p = new TbPublico();
            p.setNmePublico(getNome());
            p.setTdTipoPublico(getTipoPublicoSelecionado());

            getDaoPublico().incluir(p);

            // Carregar a lista de publicos novamente
            lstDataTablePublico = getDaoPublico().consultarTodos();

            // Mostrando msg de sucesso!
            msg.setSummary("Público cadastrado com sucesso!");
            msg.setSeverity(FacesMessage.SEVERITY_INFO);
            contexto.addMessage(null, msg);

            // Invocando script no cliente
            RequestContext rc = RequestContext.getCurrentInstance();
            rc.addCallbackParam("salvo", true);

        } catch (Exception e) {
            msg.setSummary("Erro ao cadastrar público!");
            msg.setSeverity(FacesMessage.SEVERITY_ERROR);
            contexto.addMessage(null, msg);
        }
    }

    public void excluirPublico(ActionEvent e) {
        FacesMessage msg = new FacesMessage();
        FacesContext contexto = FacesContext.getCurrentInstance();
        // Mostrando msg de sucesso!
        msg.setSummary(publicoSelecionado.getNmePublico());
        msg.setSeverity(FacesMessage.SEVERITY_INFO);
        contexto.addMessage(null, msg);
        /*try {
            // Excluindo o publico selecionado
            daoPublico.excluir(getPublicoSelecionado().getIdtPublico());
        } catch (Exception ex) {
            msg.setSummary("Erro ao cadastrar público!");
            msg.setSeverity(FacesMessage.SEVERITY_ERROR);
            contexto.addMessage(null, msg);
        }*/
    }

    public void alterarPublico() {
        FacesMessage msg = new FacesMessage("Publico alterado!");
        FacesContext.getCurrentInstance().addMessage(null, msg);
    }
    // Converters

    public Converter getConversor() {
        return new Converter() {

            @Override
            public Object getAsObject(FacesContext context, UIComponent component, String value) {
                // Transformar string em objeto
                TdTipoPublico r = null;
                try {
                    r = getDaoTipoPublico().consultarPorIdt(Integer.parseInt(value));
                } catch (NumberFormatException e) {
                }

                return r;

            }

            @Override
            public String getAsString(FacesContext context, UIComponent component, Object value) {
                // Transformar objeto em string
                String r = null;
                if (value instanceof TdTipoPublico) {
                    r = ((TdTipoPublico) value).getIdtTipoPublico().toString();
                }
                return r;
            }
        };

    }
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T22:13:14.340

这是因为属性 type="button" 没有触发 actionlistener。当您声明此属性 (type="button") 时，它不再是 ap:commandButton。type="button" 是按钮用途，它不做任何动作或提交表单尝试删除 type="button" 属性。它会触发动作监听器。

```
 <p:commandButton id="cbViewExcluir" 

                                     image="ui-icon-circle-close" 
                                     onclick="dlgExcluir.show()" 
                                     title="Excluir"
                                     update=":frmExcluir">

                        <!-- This is not working properly -->
                        <f:setPropertyActionListener value="#{atual}" target="#   {publicoBean.publicoSelecionado}" />
                    </p:commandButton> 
```

让我知道这是否有帮助:)

# java - 带有 UTF-8 的 getBytes() 不适用于大写德语变音符号

> ID：12253322
> 
> 赞同：6
> 
> 时间：2012-09-03T19:52:59.603
> 
> 标签：java, character-encoding, resourcebundle

对于开发，我`ResourceBundle`用来直接从 IDE 中的资源目录中读取 UTF-8 编码的属性文件（我在该文件的 Eclipse 文件属性中设置）（native2ascii 用于生产方式），例如：

```
menu.file.open.label=&Öffnen...
label.btn.add.name=&Hinzufügen
label.btn.remove.name=&Löschen 
```

由于在使用非 ASCII 字符时会导致字符编码出现问题，我认为我会很高兴：

```
ResourceBundle resourceBundle = ResourceBundle.getBundle("messages", Locale.getDefault());
String value = resourceBundle.getString(key);
value = new String(value.getBytes(), "UTF-8"); 
```

好吧，它确实适用于小写的德语变音符号，但不适用于大写的变音符号，`ß`也不起作用。这是读取`getString(key)`的值和转换后的值`new String(value.getBytes(), "UTF-8")`：

```
&LÃ¶schen => &Löschen
&HinzufÃ¼gen => &Hinzufügen

&Ã?ber => &??ber
&SchlieÃ?en => &Schlie??en
&Ã?ffnen... => &??ffnen... 
```

最后三个应该是：

```
&Ã?ber => &Über
&SchlieÃ?en => &Schließen
&Ã?ffnen... => &Öffnen... 
```

我想我离真相并不太远，但我在这里错过了什么？

*谷歌发现[了类似](http://osdir.com/ml/text.xml.xindice.user/2003-10/msg00056.html)的东西，但仍未得到答复。*

编辑：更多代码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T19:56:49.767

问题是您在`String.getBytes()` *没有*指定编码的情况下调用 - 这将使用默认平台编码。然后，您可以像使用UTF-8*一样使用该操作的二进制结果。*

如果您在两个方向上都使用 UTF-8，那就没问题了：

```
// Should be a round-trip
value = new String(value.getBytes("UTF-8"), "UTF-8"); 
```

...但是如果您尝试使用它来读取 UTF-8 编码的属性文件而不告诉执行*初始*读取的代码，那将无法正常工作。

您提供的代码基本上*总是*错误的方法。您的“因为这会导致字符编码出现问题”表明您已经遇到了较早的问题 - 所以我会回到那个问题，而不是尝试应用损坏的修复程序。如果您在构建时已经丢失了数据`ResourceBundle`，那么以后再回去就太晚了……您需要确保`ResourceBundle`自己正确加载。

*请准确*告诉我们您使用`ResourceBundle`.

编辑：目前尚不清楚您是如何运行 native2ascii 的。修复*可能*就像更改为使用一样简单：

```
native2ascii -encoding UTF-8 input.properties output.properties 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T20:26:13.393

一些注意事项：

*   如果是`String`，则为 UTF-16，如果不是，则为损坏的字符串（修复为时已晚。）
*   `new String(value.getBytes(), "UTF-8");`- 此代码（充其量）在使用 UTF-8 作为默认编码的系统上什么也不做；否则会损坏字符串。
*   .properties 文件必须是 ISO 8859-1 （该`Properties`类型支持其他格式和编码，但我不知道你会怎么看`ResourceBundle`。）
*   `System.out`可能会引入自己的转码错误（`PrintStream`将 UTF-16 字符串编码为默认编码；接收设备必须使用相同的编码解码字节。）

我怀疑你试图在错误的地方解决你的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T19:57:46.633

您正在使用与您正在解码的编码不同的编码对文本进行编码。

尝试使用相同的字符集进行编码和解码。

```
value = new String(value.getBytes("UTF-8"), "UTF-8"); 
```

* * *

```
String s = "ßßßßß";
s += s.toUpperCase();
s = new String(s.getBytes("UTF-8"), "UTF-8");
System.out.println(s); 
```

印刷

```
ßßßßßSSSSSSSSSS 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T17:13:55.490

今天我正在和我的一位同事交谈，他与其他答案提到的几乎相同。所以我试图实现 Jon Skeet 提到的，这意味着创建与生产中相同的文件。由于在每次更改资源后重建项目是不可能的，而且我还没有做任何解决这个问题的方法（我想这对某些人来说是新的）让我把它排成一行（即使它可能只是为了个人参考 ;） ）。简而言之，这使用了 Eclipse 的项目构建器。

1.  创建一个 Ant 风格的 build.xml

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <project>
        <property name="dir.resources" value="src/main/resources" />
        <property name="dir.target" value="bin/main" />

        <target name="native-to-ascii">
            <delete dir="${dir.target}" includes="**/*.properties" />
            <native2ascii src="${dir.resources}" dest="${dir.target}" includes="**/*.properties" />
        </target>
    </project> 
    ```

    其目的是删除目标目录中的属性文件并用于`native2ascii`重新创建它们。删除是必要的，因为`native2ascii`不会覆盖现有文件。

2.  在 Eclipse 中，转到项目属性并选择“Builders”，单击“New...”，选择“Ant Builder”（这是运行配置的略微增强的编辑器）
3.  在“Main”中让“Buildfile”指向 Ant 脚本，将“Base Directory”设置为`${project_loc}`
4.  在“刷新”中勾选“完成后刷新资源”并选择“包含所选资源的项目”
5.  在“目标”中，单击“自动构建”旁边的“设置目标”并选择`native-to-ascii`那里（请注意，由于某种原因，我必须稍后再执行此操作）
6.  这可能不是每个人都需要的，但是在“JRE”中选择一个合适的执行环境
7.  在“构建选项”中勾选“分配控制台”（但是，您可能希望保持勾选，直到您看到一切正常）
8.  “应用”、“确定”
9.  有人告诉我，新创建的构建器应该位于 Java Builder 下方（使用向上/向下按钮）
10.  在“Java Build Path”中选择包含资源的源文件夹（`src/main/resources`对我来说）并添加排除项`**/*.properties`

应该是这样的。如果您编辑属性文件并保存它，它应该会在输出文件夹中自动转换为 ASCII。您可以尝试输入`ü`，它应该以`\u00fc`.

请注意，如果您有很多属性文件，这可能需要一些时间。只是不要在每次按键后保存。:)

# python - 在 python beautifulsoup 中加入如何工作

> ID：12253325
> 
> 赞同：3
> 
> 时间：2012-09-03T19:53:08.370
> 
> 标签：python, beautifulsoup

我正在学习python和beautifulsoup，并在网上看到了这段代码：

```
from BeautifulSoup import BeautifulSoup, SoupStrainer
import re

html = ['<html><body><p align="center"><b><font size="2">Table 1</font></b><table><tr><td>1\. row 1, cell 1</td><td>1\. row 1, cell 2</td></tr><tr><td>1\. row 2, cell 1</td><td>1\. row 2, cell 2</td></tr></table><p align="center"><b><font size="2">Table 2</font></b><table><tr><td>2\. row 1, cell 1</td><td>2\. row 1, cell 2</td></tr><tr><td>2\. row 2, cell 1</td><td>2\. row 2, cell 2</td></tr></table></html>']
soup = BeautifulSoup(''.join(html))
searchtext = re.compile(r'Table\s+1',re.IGNORECASE)
foundtext = soup.find('p',text=searchtext) # Find the first <p> tag with the search text
table = foundtext.findNext('table') # Find the first <table> tag that follows it
rows = table.findAll('tr')
for tr in rows:
    cols = tr.findAll('td')
    for td in cols:
        try:
            text = ''.join(td.find(text=True))
        except Exception:
            text = ""
        print text+"|",
    print 
```

虽然其他一切都很清楚，但我不明白加入是如何工作的。

```
 text = ''.join(td.find(text=True)) 
```

我尝试在 BS 文档中搜索 join，但我找不到任何东西，也无法真正在线找到有关如何在 BS 中使用 join 的帮助。

请让我知道那条线是如何工作的。谢谢！

PS：上面的代码来自另一个stackoverflow页面，它不是我的作业：） [如何在Python中使用BeautifulSoup在文本字符串之后找到一个表格？](https://stackoverflow.com/questions/5711483/how-can-i-find-a-table-after-a-text-string-using-beautifulsoup-in-python)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T19:54:43.030

[`''.join()`](http://docs.python.org/library/stdtypes.html#str.join)是一个 python 函数，而不是任何特定于 BS 的函数。它让您以字符串作为连接值连接一个序列：

```
>>> '-'.join(map(str, range(3)))
'0-1-2'
>>> ' and '.join(('bangers', 'mash'))
'bangers and mash' 
```

`''`只是一个空字符串，并且可以更容易地将一整组字符串连接成一个大字符串：

```
>>> ''.join(('5', '4', 'apple', 'pie'))
'54applepie' 
```

在您的示例的特定情况下，该语句查找元素中包含的所有文本`<td>`，包括任何包含的 HTML 元素，例如`<b>`or `<i>`，`<a href="">`并将它们全部放在一个长字符串中。所以`td.find(text=True)`找到一系列 python 字符串，`''.join()`然后将它们连接成一个长字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:54:57.167

Join 不是 BeautifulSoup 的一部分，而是 Python 中内置的字符串方法。它将一系列元素与给定的字符串连接在一起；例如，`'+'.join(['a', 'b', 'c'])`是`a+b+c`。请参阅[文档](http://docs.python.org/library/stdtypes.html#str.join)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T05:31:23.460

代码不正确。这一行：

```
text = ''.join(td.find(text=True)) 
```

使用 find，它返回 td 标记的第一个字符串子项并尝试对其使用 join。它可以正常工作，因为 ''.join() 只是迭代第一个字符串子项，创建一个副本。

所以这：

```
<td>foo<b>bar</b></td> 
```

只需运行 ''.join("foo")。

相反，请使用 td.text 属性。它会自动查找 td 中的所有字符串并将它们连接起来。

```
text = td.text 
```

# azure - 在Azure中创建“虚拟机”时会创建一个同名的“云服务”，我可以删除它吗？

> ID：12253326
> 
> 赞同：11
> 
> 时间：2012-09-03T19:53:08.930
> 
> 标签：azure, azure-virtual-machine

在 Azure 中创建“虚拟机”时会创建一个同名的“云服务”。

我的问题是：

A：同名“云服务”有什么用？

B：我可以删除“云服务”中存在的那个，它是空的，在生产和阶段都没有部署。

C：如果我删除它，会不会影响我创建的“虚拟机”？

D：如果我删除它，我以后可以用相同的名称重新创建它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T22:46:33.977

答：它是虚拟机部署的包装器，本质上与您在 PaaS 模型中用于 Web 和 Worker 角色部署的构造相同。

当您从门户创建新虚拟机时，您实际上不会看到还创建了云服务，除非您切换回“旧”Silverlight 门户。

B. 如果云服务是空的，你实际上并没有在其中运行虚拟机，所以你可以删除它。

您是否从中创建了映像（sysprep）？这会将其与云服务分离，并且由于它已分离，门户现在将显示您有一个空的云服务。 *“新”门户曾经显示“空”的云服务，但我只是试了一下，它没有出现；当然，它确实出现在“旧”门户中。*

云服务一直存在，但门户网站认为您不需要了解它时会将其隐藏 :)。如果您创建一些“连接的 VM”，您还将在“新”门户中看到云服务，因为现在该服务不仅仅是单个 VM 的简单包装器。

C. 如果云服务现在显示部署，您可以将其删除而无需担心。

D. 有点。删除云服务后，您可以重新使用该云服务的名称；但是，如果您决定创建另一个同名的 VM 和该 VM 的资产 - 映像和/或磁盘仍然存在，如果您使用“快速创建”选项，则可能会失败。这是因为这些选项将根据您提供的 DNS（又名云服务）名称为磁盘和映像创建名称。如果旧 VM 的磁盘/映像仍然存在，您将遇到冲突并且创建将失败。不过，它并没有因为云服务名称本身而失败。

您可能会发现我在使用 CouchBase[的 VM 上所做的一篇博文很有帮助，因为我介绍了各种场景并触及了您的一些问题。](http://blogs.msdn.com/b/jimoneil/archive/2012/06/16/couchbase-on-azure-creating-virtual-machines.aspx)它是 CouchBase 的事实是次要的。

# python - Django 的 objects.all() 杀死 python

> ID：12253328
> 
> 赞同：1
> 
> 时间：2012-09-03T19:53:33.977
> 
> 标签：python, django

我有一个 Django 项目。里面有`MyModel`。`models.py`该模型有 4 000 000 个实例。

我执行这个脚本：

```
for m in MyModel.objects.all():
    if len(m.phone) < 10 or len(set(m.phone)) <= 2:
        m.delete() 
```

但是，它杀死了 python（只是打印'Killed'）。

我知道，问题在于实例数量。但是我怎样才能迭代所有这些？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:09:47.980

您可以先尝试对对象进行计数，然后使用切片版本对其进行迭代。就像是：

```
step = 10
count = MyModel.objects.count()/step
for i in xrange(count):
    for m in MyModel.objects.all()[i*step:(i+1)*step]:
        # doing something with m 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T20:39:59.730

如果你使用[`iterator()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#iterator)而不是`all()`，Django 将不会缓存查询集，这应该会减少内存使用并提高性能。

```
for m in MyModel.objects.iterator():
    # doing something with m 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-21T07:42:28.820

Alexey 的回答非常好，但他认为余数`MyModel.objects.count()/step`为零
所以，他可能会遗漏一些字段......

```
step = 10
total = MyModel.objects.count()  
count = total//step  
if (total % step != 0):    
    count += 1 

for i in xrange(count):  
    first = i*step  
    last = first + step - 1  
    if last >= total:  
        last = total  

    for m in MyModel.objects.all()[first:last]:
        # doing something with m 
```

# java - Android ListView 中的自定义日期（Java 格式化）

> ID：12253332
> 
> 赞同：1
> 
> 时间：2012-09-03T19:53:49.437
> 
> 标签：java, android, date, android-listview

我有一个`ListView`用户将发表评论。当他们点击附加到框的“提交”时，新评论与当前时间一起`EditText`进入数据库。`MySQL`

我希望评论出现在列表视图中，日期类似于 Youtube 格式。例如：“10 秒前”、“1 天前”、“52 天前”。

我会使用 Calendar 对象 SimpleDateFormat 吗？

另外，我将如何将日期存储在数据库中？我假设一些容易转换的东西，比如 UNIX 日期戳。然后它会在我根据当前时间动态更改日期的 ArrayAdapter 中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:57:19.067

您可以使用[PrettyTime](http://ocpsoft.org/prettytime/)来实现。

为了节省时间，我通常以毫秒为单位节省时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:59:37.723

为此，您需要计算时间戳和当前时间戳之间的差异（为简单起见，以毫秒为单位）。结果将是“之前”的毫秒数。然后使用简单的数学，如减法和除法，你可以得到分钟数、天数、周数和任何你想要的。

编辑：我用这个：

```
public static final long MILLIS_PER_SECOND  = 1000;
public static final long MILLIS_PER_MINUTE  = (MILLIS_PER_SECOND * 60);
public static final long MILLIS_PER_HOUR    = (MILLIS_PER_MINUTE * 60);
public static final long MILLIS_PER_DAY     = (MILLIS_PER_HOUR * 24);
public static final long MILLIS_PER_WEEK    = (MILLIS_PER_DAY * 7);
public static final long MILLIS_PER_MONTH   = (MILLIS_PER_DAY * 30);
public static final long MILLIS_PER_YEAR    = (MILLIS_PER_MONTH * 12); 
```

请注意，这不是 100% 正确的，因为我（为了简单起见）做了**错误**的假设，月份总是 30 天，这也会影响`MILLIS_PER_YEAR`. 但我并不在乎——我用这些不是火箭科学。但是您可以通过以下方式设置来减少影响`MILLIS_PER_YEAR`：

```
public static final long MILLIS_PER_YEAR = (MILLIS_PER_DAY * (7*31 + 4*30 + 28)); 
```

`28`是 2 月的，在这种情况下，闰年你只有 1 天的假期，而不是之前版本的 5 天。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T16:03:21.790

尝试 DateUtils.getRelativeTimeSpanString 格式化显示日期。

# android - TouchImageView 是否支持缩小？

> ID：12253333
> 
> 赞同：0
> 
> 时间：2012-09-03T19:53:59.447
> 
> 标签：android

我已经下载了 TouchImageView 的示例代码并将 minScale 设置为 .80 以便能够缩小图像。这会导致图像与屏幕的底部或顶部对齐，并且不会像放大图像时那样流畅地移动。

源/示例 [https://github.com/MikeOrtiz/TouchImageView](https://github.com/MikeOrtiz/TouchImageView)

Touchview 支持缩小吗？如果没有，有没有办法解决这个问题？

谢谢，符文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:09:28.890

通过将以下内容添加到 onScale 方法，我能够进行收缩工作

```
if (saveScale < 1){
    matrix.postScale(mScaleFactor, mScaleFactor, width / 2, height / 2);
}else if (origWidth * saveScale <= width || origHeight * saveScale <= height) { 
```

问题是，一旦你这样做，拖动就会被搞砸。要在 onTouch 案例中解决此问题：MotionEvent.ACTION_MOVE：将条件更改为在 scaleWidth < width && scaleHeight < height 时不执行任何操作。

# ruby - 防止红宝石中的“没有可用的缓冲区空间”错误

> ID：12253342
> 
> 赞同：0
> 
> 时间：2012-09-03T19:54:54.897
> 
> 标签：ruby, sockets, error-handling

我有一个小脚本，它扫描端口 411 上从 192.168.190.xxx 到 192.168.220.xxx 的所有 ip。

该脚本有时工作正常，但有时我收到错误“没有可用的缓冲区空间” `dcport.rb:8:in`初始化'：没有可用的缓冲区空间 - 连接（2）（Errno::ENOBUFS）`

我已经读过，当套接字没有正确关闭时会发生这种情况，但我曾经用来`mysocket.close`防止我认为不能正常工作的情况。

如何防止这种情况发生，我的意思是如何正确关闭套接字？

我的代码如下

```
require 'socket'
require 'timeout'
(190...216).each do |i|
  (0...255).each do |j|
    begin
      #puts "Scanning 192.168.#{i}.#{j}"
      scan=Timeout::timeout(10/1000.0) {
        s=TCPSocket.new("192.168.#{i}.#{j}",411)
        s.close
        puts "192.168.#{i}.#{j} => Hub running"
      }
    rescue Timeout::Error
    rescue Errno::ENETUNREACH
    rescue Errno::ECONNREFUSED
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:09:24.473

我的猜测是，有时，在套接字创建和套接字关闭之间会触发超时，这会使您泄漏一些套接字。因为（据快速谷歌搜索告诉我），ENOBUFS 默认情况下会在打开 1024 个套接字后发生，这肯定是它。

超时以及 Thread.raise 在您需要确保发生某些事情的情况下（在您的情况下为 s.close）是非常有害的，因为您实际上无法再保证它：异常可能在任何地方引发，甚至在一个确保块。

在你的情况下，我认为你可以通过在超时块**之外**添加一个确保子句来修复它（下面是未经测试的代码）：

```
require 'socket'
require 'timeout'
(190...216).each do |i|
  (0...255).each do |j|
    begin
      #puts "Scanning 192.168.#{i}.#{j}"
      s = nil
      scan=Timeout::timeout(10/1000.0) do
        s=TCPSocket.new("192.168.#{i}.#{j}",411)
        puts "192.168.#{i}.#{j} => Hub running"
      end
    rescue Timeout::Error
    rescue Errno::ENETUNREACH
    rescue Errno::ECONNREFUSED
    ensure
      s.close if s
    end
  end
end 
```

# c# - 创建单文件和多文件程序集的步骤？

> ID：12253356
> 
> 赞同：1
> 
> 时间：2012-09-03T19:56:18.850
> 
> 标签：c#, .net

我知道单个文件程序集由 Manifest + IL + Resources 组成。还有一种程序集类型将其元素分组到多个文件中，称为多文件程序集。Visual Studio .NET IDE 只能用于创建单文件程序集，但可以使用命令行编译器创建多文件程序集。

这是我能找到的两种程序集的所有信息，google 只返回[http://msdn.microsoft.com/en-us/library/z38d5bzk(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/z38d5bzk(v=vs.71).aspx)

但我并不满意，我无法清楚地说出它们到底是什么。我想知道：

1.  究竟什么是单​​文件汇编？如何创建，创建步骤，它看起来如何？
2.  究竟什么是多文件程序集？如何创建、创建步骤、外观如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:02:30.643

基本上，“单文件”程序集是将所有内容都包含在一个文件中的程序集。这将是一个具有 .DLL 或 .EXE 扩展名的文件，并且是已编译的 .NET 项目。Visual Studio 从 C# 项目（库或应用程序）创建这些。

使用命令行编译器，您可以将程序集拆分为多个部分 - 其中单个程序集的[清单](http://msdn.microsoft.com/en-us/library/1w45z383%28v=vs.100%29.aspx)包含查找属于程序集的信息所需的信息，但存储在单独的文件中。例如，您可以在其自己的文件中保留一个大型资源的资源图像（即：.bmp），这样就不必为了打开程序集而加载它。Visual Studio 不支持创建多文件程序集，但它们看起来像 DLL 或 EXE，加上零个或多个 netmodule 文件，加上零个或多个资源文件（可以是任何东西）。主 DLL 或 EXE 包含指定其他文件所在位置的清单。[How to: Build a Multifile Assembly](http://msdn.microsoft.com/en-us/library/226t7yxe%28v=vs.100%29.aspx)中详细介绍了构建它所需的步骤。

# php - php OR 操作数似乎不适用于 WordPress 模板文件

> ID：12253357
> 
> 赞同：1
> 
> 时间：2012-09-03T19:56:19.390
> 
> 标签：php, wordpress, wordpress-theming

这是一个奇怪的问题。我在 WordPress 中的 PHP 主题文件中工作。

```
$a = false;
$b = true;

$c = $a OR $b; 
```

$c 是`false`

但

```
$c = $a || $b; 
```

$c 正确地是`true`.

我可以创建一个函数

```
function checkor($a, $b)
{
  return $a OR $b;
} 
```

这将正确返回`true`上述值。

知道为什么 php`OR`操作数在 WordPress 主题模板文件中似乎不起作用吗？（我在 Mac 上运行 MAMP Pro，PHP 版本 5.2.13。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:01:36.410

查看 PHP 手册[http://www.php.net/manual/en/language.operators.logical.php](http://www.php.net/manual/en/language.operators.logical.php)

```
// "||" has a greater precedence than "or"

// The result of the expression (false || true) is assigned to $e
// Acts like: ($e = (false || true))
$e = false || true;

// The constant false is assigned to $f and then true is ignored
// Acts like: (($f = false) or true)
$f = false or true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:01:09.410

这与 Wordpress 无关，[实际上是 PHP 的工作方式](http://viper-7.com/sVVL94)。
这称为**运算符优先级**。

引用[PHP 文档](http://php.net/manual/en/language.operators.logical.php#example-122)：

```
// "||" has a greater precedence than "or"

// The result of the expression (false || true) is assigned to $e
// Acts like: ($e = (false || true))
$e = false || true;

// The constant false is assigned to $f and then true is ignored
// Acts like: (($f = false) or true)
$f = false or true; 
```

# java - Android，仅在通过意图操作关闭时才打开应用程序

> ID：12253358
> 
> 赞同：2
> 
> 时间：2012-09-03T19:56:21.560
> 
> 标签：java, android, cordova

我正在开发一个 phonegap 应用程序，其中包含一些本地组件。
到目前为止，我有本地运行的通知，以确保根本不需要 javascript 和 phonegap。但是，我遇到的问题是，当单击通知时，我想打开应用程序，或者只是将应用程序放在前面。

我该怎么做呢？我尝试在意图中设置主要活动，但每次都会重新启动我的应用程序。

```
 Intent notificationIntent = new Intent(context, main.app.class);
      notificationIntent.putExtra(NOTIF_RESPOND, runThis);
      notificationIntent.setAction(Intent.ACTION_VIEW);
      notificationIntent = notificationIntent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:26:55.453

实际上在Android中几乎没有“重启应用程序”这样的东西。基本上，应用程序 - 是您所有服务/活动/提供者等的捆绑。它要么正在运行，要么没有。

如果用户启动一个新的活动 - 系统将检查，如果应用程序正在运行 - 它将在应用程序内创建此活动。如果没有 - 将创建新的应用程序实例。

所以我认为您的意思是，如果您为 Main 活动设置意图 - 另一个 Activity 实例正在启动，对吗？

如果是这样 - 请查看以下活动标志，您应该尝试在 Manifest 中设置（或在 PhoneGap 中的任何内容，抱歉）。[http://developer.android.com/guide/topics/manifest/activity-element.html#lmode](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)

```
<activity android:name=".YourActivity"
    android:launchMode="singleTask" 
    ... 
```

这个标志将告诉系统不要为每个需要的类型创建一个新的 Activity，而是重用已经存在的一个。请注意，`onNewIntent`在这种情况下，您应该正确实施方法来处理这种“重新启动”，而且我不能 100% 确定它是否在 PhoneGap 中实施。

祝你好运

# wcf - 要在 WCF Web 服务中导入的标记类

> ID：12253359
> 
> 赞同：1
> 
> 时间：2012-09-03T19:56:29.973
> 
> 标签：wcf, web-services, import

我有一个 WCF Web 服务，并且在每个方法中我都返回一个 Response 类，其中我有一个 ResponseCode（OK、Error 等）和一个数据属性（我将返回的实际对象，这些因 Web 服务而异方法），但现在我返回了这个对象的列表（SearchResult），但是当我更新客户端上的引用时，SearchResult 类被遗漏了。是否有任何 Import 属性可以用来标记该类，以便将其添加到 Reference.cs 文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:12:08.410

您必须使用`[DataContract]`属性标记类。

此外，当您的服务发生异常时，将响应对象中的错误代码返回给调用者不是一个好习惯，因为您正在为调用者创建额外的工作，他们需要询问响应对象以了解调用是否成功与否。

最好使用[Fault Contracts](http://msdn.microsoft.com/en-us/library/ms752208.aspx)定义已知异常。这将意味着您的消费者可以将对您的服务的调用包装在 try 中，并以更自然的方式捕获他们想要的任何异常。

# c# - C# COM => 指针 => delphi 接口

> ID：12253360
> 
> 赞同：2
> 
> 时间：2012-09-03T19:56:35.473
> 
> 标签：c#, delphi, delphi-xe2, com-interop

几天我无法解决我的问题。我在 C# 中有接口和类，它们作为 COM 服务器可见。我有需要访问此界面的 Delphi 应用程序。但在我的情况下，我需要在 C# 端将 32 位指针返回到接口，在 Delphi 端 - 将指针转换为接口。做什么？c# 方面。所有属性都写得很好，因为原始类要大得多，所以源代码被剪掉了，但是想法是可以理解的：

```
[ComVisible(true)]
[CLSCompliant(true)]
[Guid("C1A57BD0-AAA2-4AB8-BA2F-ADFA04275AD5")]
[ClassInterface(ClassInterfaceType.None),
 ComSourceInterfaces(typeof(IProcPreviewEndArgs))]
public class ProcPreviewEndArgs : IProcPreviewEndArgs
{

   [ComVisible(true), PreserveSig]
   public IntPtr CreateNew()
   {
       var obj = new ProcPreviewEndArgs();
       GC.SuppressFinalize(obj);
       return Marshal.GetComInterfaceForObject(obj, typeof (IProcPreviewEndArgs));
   }
} 
```

德尔福方面：

```
type
  PIProcPreviewEndArgs = ^IProcPreviewEndArgs;

 Index, Res: Integer;
 ppa : IProcPreviewEndArgs;
 pppa : PIProcPreviewEndArgs;

  ppa := CoProcPreviewEndArgs.Create;   // Creates COM object via Delphi services
  ppa.CreateNew(Res);                   // Creates object of the same type, returns as Ret (Integer)
  pppa := PIProcPreviewEndArgs(Res);    // Trying to cast Intereger to interface
  pppa^.CreateNew(Res); // just to test calling posibility 
```

在 pppa^ （通过指针获取实例）上抛出 ACCESS VIOLATION 异常。指针 Res 不为空。它大约是 60 000 000。基本上它是内核空间区域。

**UPD**

```
[CLSCompliant(true), ComVisible(true),
 InterfaceType(ComInterfaceType.InterfaceIsIUnknown),
 Guid("10572D64-B612-468F-86B3-D12F0B6E3CD2")]
public interface IProcPreviewEndArgs
{
    IntPtr CreateNew();
    IntPtr Get(int aMin, int aMax, uint cMin, uint cMax);
    void ToAngle(int x, int y, int w, int h, out int nx, out int ny, out int nw, out int nh);
    IntPtr GetImage();
} 
```

Delphi（由 Delphi 生成，在使用标准 Delphi 方法操作 COM 对象时运行良好）：

```
 IProcPreviewEndArgs = interface(IUnknown)
    ['{10572D64-B612-468F-86B3-D12F0B6E3CD2}']
    function CreateNew(out pRetVal: Integer): HResult; stdcall;
    function Get(aMin: Integer; aMax: Integer; cMin: LongWord; cMax: LongWord; out pRetVal: Integer): HResult; stdcall;
    function ToAngle(x: Integer; y: Integer; w: Integer; h: Integer; out nx: Integer; 
                     out ny: Integer; out nw: Integer; out nh: Integer): HResult; stdcall;
    function GetImage(out pRetVal: Integer): HResult; stdcall;
  end; 
```

德尔福版本：**德尔福XE2**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:27:57.123

我相信`CreateNew`回报`IProcPreviewEndArgs`而不是`^IProcPreviewEndArgs`。所以你的代码应该是：

```
var
  ppa1, ppa2: IProcPreviewEndArgs;
....
ppa1 := CoProcPreviewEndArgs.Create;   
ppa1.CreateNew(Res);                   
ppa2 := IProcPreviewEndArgs(Res);    
ppa2.CreateNew(Res); 
```

如果我是你，我会声明那些`Integer`映射到 C# 的返回值，`IntPtr`就像`Pointer`在 Delphi 中一样。这样，如果您编译 64 位版本，您的代码就可以工作。

我还考虑使用`safecall`而不是`stdcall`让编译器将任何错误转换`HRESULT`为 Delphi 异常。

```
IProcPreviewEndArgs = interface(IUnknown)
  ['{10572D64-B612-468F-86B3-D12F0B6E3CD2}']
  function CreateNew: Pointer; safecall;
  function Get(aMin: Integer; aMax: Integer; cMin: LongWord; cMax: LongWord): Pointer; safecall
  procedure ToAngle(x: Integer; y: Integer; w: Integer; h: Integer; out nx: Integer; 
                    out ny: Integer; out nw: Integer; out nh: Integer); safecall;
  function GetImage: Pointer; safecall;
end; 
```

我也想知道为什么你必须返回无类型的指针，例如，`CreateNew`. 为什么不能声明该函数`IProcPreviewEndArgs`在双方都返回？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:08:52.883

Delphi 完全支持 COM/ActiveX，无论指针来自何处。

问：您使用的是什么版本的 Delphi？

建议：

1) 创建一个 C# 测试客户端来测试您的 ProcPreviewEndArgs.CreateNew() 方法。看看它是否有效。

2) 回顾这篇文章：

*   [http://delphi.about.com/library/weekly/aa121404a.htm](http://delphi.about.com/library/weekly/aa121404a.htm)

    更改您的 Delphi 代码以使用 COM/ActiveX 类和 GUIDS（而不是 Delphi 指针）。使其与您在第 1 步中使用的 C# 测试客户端一样工作。确保您正在执行所有“基础”操作，包括在开始使用 COM/ActiveX 之前在 Delphi .exe 中的某处调用 CoInitialize()。

3) 请考虑您是否需要 COM/ActiveX。也许您的设计可以在没有 COM/ActiveX 的情况下使用 PInvoke？

# python - Python列表与非唯一项的交集

> ID：12253361
> 
> 赞同：13
> 
> 时间：2012-09-03T19:56:45.270
> 
> 标签：python, intersection, multiset

我有两个字符串，我希望它们上有交叉点，*包括*重复项：

```
str_a = "aabbcc"
str_b = "aabd"

list(set(str_a) & set(str_b))
>> "ab" 
```

我想让它返回：

```
>> "aab" 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-03T19:58:29.257

多重集在 python 2.7 或更高版本中作为（可变）`Counter`对象实现。您可以对集合执行许多相同的操作，例如并集、交集、差集（尽管计数可能变为负数）等：

```
from collections import Counter as mset 
```

解决方案：

```
(mset("aabbcc") & mset("aabd")).elements() 
```

更多细节：

```
>>> intersection = mset("aabbcc") & mset("aabd")
Counter({'a': 2, 'b': 1})

>>> list(intersection.elements())
['a', 'a', 'b']

>>> ''.join(intersection.elements())
'aab' 
```

`''.join`如果你想要一个字符串，或者如果你想要一个列表，你可以使用`list()`，尽管我只是将它保持为可迭代的格式为`intersection.elements()`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-03T20:05:03.483

用于[`collections.Counter`](http://docs.python.org/library/collections.html#counter-objects)每个单词并将它们用作集合：

```
>>> from collections import Counter
>>> str_a, str_b = 'aabbcc', 'aabd'
>>> Counter(str_a) & Counter(str_b)
Counter({'a': 2, 'b': 1})
>>> ''.join((Counter(str_a) & Counter(str_b)).elements())
'aab' 
```

`Counter`是一个子类，但它会计算您初始化它的序列的`dict`所有元素。因此，`"aabbcc"`变为`Counter({'a': 2, 'b': 2, 'c': 2})`。

计数器的作用类似于多重集，因为当您在上述交叉点中使用 2 时，它们的计数设置为任一计数器中的最小值，忽略计数降至 0 的任何内容。如果您要计算它们的并集，则*最大*计数将改为使用。

# qt - 在执行之间持久化/序列化 QPrinter (QPrintDialog)

> ID：12253363
> 
> 赞同：2
> 
> 时间：2012-09-03T19:56:57.270
> 
> 标签：qt, serialization, printing, qprinter

在 Qt Desktop 应用程序中，如何在应用程序运行之间保持 QPrinter 选择？

考虑以下代码：

```
printDialog = new QPrintDialog();
if (printDialog->exec() == QDialog::Accepted) {
    qDebug() << printDialog->printer(); // Gives just a pointer value,
                                        // no real use for serializing.
    view->print(printDialog->printer());
} 
```

我希望能够做到这两点：

```
printDialog = new QPrintDialog("some-previously stored settings") 
```

并且，甚至不调用 QPrintDialog，只需像这样打印到预先选择的打印机：

```
view->print(new QPrinter("some previously stored settings")) 
```

有一个处理 QPrinterInfo 的函数，但它只返回打印机名称。还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T12:23:07.607

你被 Qt 冷落了。您要求的功能不可用。相关 Qt 功能请求（观察请求的年龄和优先级）：

[QPrinter：添加 << 和 >> 运算符，以便可以保存和加载设置](https://bugreports.qt.io/browse/QTBUG-3567)

[QPrinter 应该提供一种存储/恢复设置的方法](https://bugreports.qt.io/browse/QTBUG-6469)

[从当前的 Qt 版本开始，您必须手动](http://www.qtcentre.org/threads/50408-Save-Printer-Page-Settings-to-show-on-next-print)将相关的 QPrintDialog 和 QPrinter 值保存/加载到 QSettings（或可序列化为文件）。从两个提到的 QTBUG 中最后一个有用的评论中猜测，Qt 5.0 没有任何改进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T12:04:25.687

我编写了以下代码来读取 QPrinter 的所有可用设置并将其写入 QDataStream。不幸的是，到目前为止，这并不能保存/恢复**所有**可用的打印机选项（即在 Windows 上）。但打印机名称、页面大小等已正确恢复。

随意重复使用。

```
 ///////////////////////////////////////////////////////////////////////////////
    // Write all available Attributes from QPrinter into stream
    ///////////////////////////////////////////////////////////////////////////////

    template <typename t> void  writeStreamElement(QDataStream &os, t param)
    {
        int i = static_cast<int>(param);
        os << i;
    }
    template <>           void writeStreamElement<QString>(QDataStream &os, QString s)
    {
        os << s;
    }

    QDataStream& operator<<(QDataStream &os, const QPrinter &printer)
    {
        writeStreamElement(os, printer.printerName         ());
        writeStreamElement(os, printer.pageSize            ());
        writeStreamElement(os, printer.collateCopies       ());
        writeStreamElement(os, printer.colorMode           ());
        writeStreamElement(os, printer.copyCount           ());
        writeStreamElement(os, printer.creator             ());
        writeStreamElement(os, printer.docName             ());
        writeStreamElement(os, printer.doubleSidedPrinting ());
        writeStreamElement(os, printer.duplex              ());
        writeStreamElement(os, printer.fontEmbeddingEnabled());
        writeStreamElement(os, printer.fullPage            ());
        writeStreamElement(os, printer.orientation         ());
        writeStreamElement(os, printer.outputFileName      ());
        writeStreamElement(os, printer.outputFormat        ());
        writeStreamElement(os, printer.pageOrder           ());
        writeStreamElement(os, printer.paperSize           ());
        writeStreamElement(os, printer.paperSource         ());
        writeStreamElement(os, printer.printProgram        ());
        writeStreamElement(os, printer.printRange          ());
        writeStreamElement(os, printer.printerName         ());
        writeStreamElement(os, printer.resolution          ());
        writeStreamElement(os, printer.winPageSize         ());

        qreal left, top, right, bottom;
        printer.getPageMargins(&left, &top, &right, &bottom, QPrinter::Millimeter);
        os << left << top << right << bottom;

        Q_ASSERT_X(os.status() == QDataStream::Ok, __FUNCTION__, QString("Stream status = %1").arg(os.status()).toStdString().c_str());
        return os;
    }
    ///////////////////////////////////////////////////////////////////////////////
    // Read all available Attributes from tream into QPrinter
    ///////////////////////////////////////////////////////////////////////////////

    template <typename t> t readStreamElement(QDataStream &is)
    {
        int i;
        is >> i;
        return static_cast<t>(i);
    }
    template <> QString readStreamElement<QString>(QDataStream &is)
    {
        QString s;
        is >> s;
        return s;
    }

    QDataStream& operator>>(QDataStream &is,  QPrinter &printer)
    {

        printer.setPrinterName              (readStreamElement<QString>                (is));
        printer.setPageSize                 (readStreamElement<QPrinter::PaperSize>    (is));
        printer.setCollateCopies            (readStreamElement<bool>                   (is));
        printer.setColorMode                (readStreamElement<QPrinter::ColorMode>    (is));
        printer.setCopyCount                (readStreamElement<int>                    (is));
        printer.setCreator                  (readStreamElement<QString>                (is));
        printer.setDocName                  (readStreamElement<QString>                (is));
        printer.setDoubleSidedPrinting      (readStreamElement<bool>                   (is));
        printer.setDuplex                   (readStreamElement<QPrinter::DuplexMode>   (is));
        printer.setFontEmbeddingEnabled     (readStreamElement<bool>                   (is));
        printer.setFullPage                 (readStreamElement<bool>                   (is));
        printer.setOrientation              (readStreamElement<QPrinter::Orientation>  (is));
        printer.setOutputFileName           (readStreamElement< QString >              (is));
        printer.setOutputFormat             (readStreamElement<QPrinter::OutputFormat> (is));
        printer.setPageOrder                (readStreamElement<QPrinter::PageOrder>    (is));
        printer.setPaperSize                (readStreamElement<QPrinter::PaperSize>    (is));
        printer.setPaperSource              (readStreamElement<QPrinter::PaperSource>  (is));
        printer.setPrintProgram             (readStreamElement<QString>                (is));
        printer.setPrintRange               (readStreamElement<QPrinter::PrintRange>   (is));
        printer.setPrinterName              (readStreamElement<QString>                (is));
        printer.setResolution               (readStreamElement<int>                    (is));
        printer.setWinPageSize              (readStreamElement<int>                    (is));

        qreal left, top, right, bottom;
        is >> left >> top >> right >> bottom;

        printer.setPageMargins(left, top, right, bottom, QPrinter::Millimeter);

        Q_ASSERT_X(is.status() == QDataStream::Ok, __FUNCTION__, QString("Stream status = %1").arg(is.status()).toStdString().c_str());

        return is;
    }

    ///////////////////////////////////////////////////////////////////////////////
    // persist settings
    ///////////////////////////////////////////////////////////////////////////////
    QPrinter *sgPrinter =...;
...
    QByteArray byteArr;
    QDataStream os(&byteArr, QIODevice::WriteOnly);
    os << *sgPrinter;
    QSettings settings("justMe", "myApp"));
    settings.setValue("printerSetup", byteArr.toHex());

    ///////////////////////////////////////////////////////////////////////////////
    // restore settings
    ///////////////////////////////////////////////////////////////////////////////
    QByteArray printSetUp = settings.value("printerSetup").toByteArray();
    printSetUp = QByteArray::fromHex(printSetUp);
    QDataStream is(&printSetUp, QIODevice::ReadOnly);
    is >> *sgPrinter; 
```

# javascript - slideToggle：+ 符号未更新为 -

> ID：12253364
> 
> 赞同：1
> 
> 时间：2012-09-03T19:57:18.257
> 
> 标签：javascript, jquery

如何解决以下问题？

1)`+`符号未正确更新为“-”，反之亦然；

2）第一次`My Settings`点击标志后测试消失。`+`

```
$(function(){
    $('.myToggler').click(function(e){
        $(this).next().slideToggle();
        var sign=$(this).children(':first');
        sign.text(sign.text() == '+'?'+':'-');
        e.preventDefault;
    });
});

<div class="myToggler">
    <h3><span class="togglerSign">+</span>
    My Settings</h3>
</div>
<div class="mySlider">
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:01:55.147

## *[jsBin 演示](http://jsbin.com/ukomuz/1/edit)*

*   您应该使用以下方法查找元素：`.find()`
*   并使用：`sign.text() == '+'?'-':'+'`

刷新关于***三元运算符***的知识：

```
[statement]  ?  [if is true]   :  [if is false] ;
sign is '+'  ?  YES?set to'-'  :  NO?set to'+'  ; 
```

jQuery：

```
$(function(){
    $('.myToggler').click(function(e){
        $(this).next().slideToggle();
        var sign=$(this).find('span');
        sign.text(sign.text() == '+'?'-':'+');
        e.preventDefault;
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:59:45.040

```
var sign=$(this).children(':first'); 
```

应该

```
var sign=$(this).children('span:first'); 
```

和

```
sign.text(sign.text() == '+'?'+':'-'); 
```

应该

```
sign.text(sign.text() == '+'?'-':'+'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:15:28.693

有很多解决方案可以做到这一点。你也可以试试这个：

```
$(function(){
    $('.myToggler').click(function(e){
        $(this).next().slideToggle();
        sign = $('.'+this.className+' span:first-child');
        sign.text((sign.text() == "+") ? "-" : "+");
        e.preventDefault;
    });
});​

<div class="myToggler">
    <h3><span class="togglerSign">+</span>My Settings</h3>
</div>
<div class="mySlider"></div> 
```

# google-app-engine - 如何使用 GAE 获取接受语言属性？

> ID：12253368
> 
> 赞同：0
> 
> 时间：2012-09-03T19:57:40.357
> 
> 标签：google-app-engine, gwt, httpclient

那么，有没有办法用 Google Appengine 读取客户的接受语言属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:31:50.380

在服务器端，它就像读取[请求标头](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getHeader%28java.lang.String%29)一样简单：

```
String acceptLanguage = request.getHeader("Accept-Language"); 
```

# android - 为 Android 预先创建一个 sqlite 数据库是否安全？

> ID：12253370
> 
> 赞同：2
> 
> 时间：2012-09-03T19:57:49.223
> 
> 标签：android, sqlite

我在这里关注了有关如何预先创建 sqlite 数据库并将其从资产文件夹复制到系统数据库以在 Android 应用程序中使用的文章：[http ://www.reigndesign.com/blog/using-your-own-sqlite-数据库在-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

然后我发现这个 Stackoverflow 答案说这样做是个坏主意：[https ://stackoverflow.com/a/6948334/211457](https://stackoverflow.com/a/6948334/211457)

我还发现这个答案和评论说这种技术不适用于三星 Galaxy S、摩托罗拉仿生和 Evo 4G：[https ://stackoverflow.com/a/620086/211457](https://stackoverflow.com/a/620086/211457)

我只有一个摩托罗拉 Droid 来测试，它工作正常。我希望我的应用可以在所有 Android 手机上运行。这种技术比通过 sql 插入和创建表加载数据库更可取的原因是它在初始加载时更快。

你认为预先创建一个数据库并在 Android 上加载它是一件好事，还是应该始终使用 insert 语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:07:13.503

如果您根本不关心安全性，那么您可以随意存储在 Android 上。如果您有 1 个不应该被所有网络访问的单一信息，那么您应该使用远程存储：网络服务 + 服务器端数据库。如果密钥在您的应用程序中，则如果存储在 Android 中，则加密不安全。

# java - Android + SSL：错误不受信任的服务器证书

> ID：12253372
> 
> 赞同：1
> 
> 时间：2012-09-03T19:57:55.910
> 
> 标签：java, android, ssl

为了解决这个问题，我去过很多地方，但没有去做。

尝试 SSL 连接“不受信任的服务器证书”时，Android 会返回错误。 [https://google.cl/](https://google.cl/)工作，但[https](https://autoservicio.movistar.cl/) ://autoservicio.movi​​star.cl/ 不工作：-/ 我的项目：

```
package com.drawcoders.saldomovistarchile;

import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.util.ArrayList;
import java.util.List;

import javax.net.ssl.HostnameVerifier;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.conn.scheme.PlainSocketFactory;
import org.apache.http.conn.scheme.Scheme;
import org.apache.http.conn.scheme.SchemeRegistry;
import org.apache.http.conn.ssl.SSLSocketFactory;
import org.apache.http.conn.ssl.X509HostnameVerifier;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.impl.conn.SingleClientConnManager;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.util.EntityUtils;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class SaldoMovistarChileActivity extends Activity {
    TextView statusText;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        statusText = (TextView) findViewById(R.id.statusText);
        login();
    }

    void login(){       
        try {
            HostnameVerifier hostnameVerifier = SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER;
            DefaultHttpClient client = new DefaultHttpClient();

            SchemeRegistry registry = new SchemeRegistry();
            SSLSocketFactory socketFactory = SSLSocketFactory.getSocketFactory();
            socketFactory.setHostnameVerifier((X509HostnameVerifier)hostnameVerifier);
            registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
            registry.register(new Scheme("https", socketFactory, 443));
            SingleClientConnManager mngr = new SingleClientConnManager(client.getParams(), registry);
            DefaultHttpClient httpClient = new DefaultHttpClient(mngr, client.getParams());

            HttpPost post = new HttpPost("https://autoservicio.movistar.cl/login/loginTop");
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(4);
            nameValuePairs.add(new BasicNameValuePair("rut", "1000000"));
            nameValuePairs.add(new BasicNameValuePair("dv", "0"));
            nameValuePairs.add(new BasicNameValuePair("idRut", "10000000-0"));
            nameValuePairs.add(new BasicNameValuePair("clave", "00000000"));
            post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            HttpResponse response = httpClient.execute(post);

            // HttpResponse response = client.execute(post);
            HttpEntity entity = response.getEntity();
            String responseText = EntityUtils.toString(entity);
            statusText.setText("Finalizado!");

        } catch (UnsupportedEncodingException e) {
            statusText.setText("Error: " + e.getMessage().toString());
        } catch (ClientProtocolException e) {
            statusText.setText("Error: " + e.getMessage().toString());
        } catch (IOException e) {
            statusText.setText("Error: " + e.getMessage().toString());
        }
    }
} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:33:33.317

看来（从我的 Android 设备判断：Galaxy Nexus，Android 4.1.1）用于域*autoservicio.movi​​star.cl*的 CA 根证书未在此版本的 Android 上提供，可能是 4.1.1 之前的版本.

对于您信任的站点，请尝试此处提供的解决方案：[Trusting all certificate using HttpClient over HTTPS](https://stackoverflow.com/questions/2642777/trusting-all-certificates-using-httpclient-over-https)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T07:55:59.090

该网站[https://autoservicio.movi](https://autoservicio.movistar.cl) ​​star.cl 不返回中间证书，因此客户端无法构建到受信任根的链。Firefox 也会出错。

此 SSL 检查器显示仅返回服务器证书：

[http://certlogik.com/ssl-checker/autoservicio.movi​​star.cl](http://certlogik.com/ssl-checker/autoservicio.movistar.cl)

缺少的中间证书是这个：

CN = VeriSign Class 3 International Server CA - G3,OU = [https://www.verisign.com/rpa](https://www.verisign.com/rpa) (c)10 上的使用条款,OU = VeriSign Trust Network,O = "VeriSign, Inc.",C =我们

> ----- BEGIN CERTIFICATE ----- MIIGKTCCBRGgAwIBAgIQZBvoIM4CCBPzLU0tldZ + ZzANBgkqhkiG9w0BAQUFADCB yjELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTowOAYDVQQLEzEoYykgMjAwNiBWZXJp U2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5MUUwQwYDVQQDEzxW ZXJpU2lnbiBDbGFzcyAzIFB1YmxpYyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0 aG9yaXR5IC0gRzUwHhcNMTAwMjA4MDAwMDAwWhcNMjAwMjA3MjM1OTU5WjCBvDEL MAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQLExZW ZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2UgYXQg aHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL3JwYSAoYykxMDE2MDQGA1UEAxMtVmVy aVNpZ24gQ2xhc3MgMyBJbnRlcm5hdGlvbmFsIFNlcnZlciBDQSAtIEczMIIBIjAN BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmdacYvAV9IGaQQhZjxOdF8mfUdza sVLv / + + NB3eDfxCjG4615HycQmLi7IJfBKERBD qpqFLPTU4bi7u1xHbZzFYG7rNVICreFY1xy1TIbxfNiQDk3P / hwB9ocenHKS5 + vDv85burJlSLZpDN9pK5MSSAvJ5s 1fx + 0uFLjNxC + kRLX / gYtS4w9D0SmNNiBXNUppyiHb5SgzoHRsQ7AlYhv / JRT9Cm mTnprqU / iZucff5NYAclIPe712mDK4KTQzfZg0EbawurSmaET0qO3n40mY5o1so5 BptMs5pITRNGtFghBMT7oE2sLktiEuP7TfbJUQABH / weaoEqOOC5T9YtRQIDAQAB o4ICFTCCAhEwEgYDVR0TAQH / BAgwBgEB / wIBADBwBgNVHSAEaTBnMGUGC2CGSAGG + EUBBxcDMFYwKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LnZlcmlzaWduLmNvbS9j cHMwKgYIKwYBBQUHAgIwHhocaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL3JwYTAO BgNVHQ8BAf8EBAMCAQYwbQYIKwYBBQUHAQwEYTBfoV2gWzBZMFcwVRYJaW1hZ2Uv Z2lmMCEwHzAHBgUrDgMCGgQUj + XTGoasjY5rw8 + AatRIGCx7GS4wJRYjaHR0cDov L2xvZ28udmVyaXNpZ24uY29tL3ZzbG9nby5naWYwNAYDVR0lBC0wKwYIKwYBBQUH AwEGCCsGAQUFBwMCBglghkgBhvhCBAEGCmCGSAGG + EUBCAEwNAYIKwYBBQUHAQEE KDAmMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC52ZXJpc2lnbi5jb20wNAYDVR0fBC0wKzApoCegJYYjaHR0cDovL2NybC52ZXJpc2lnbi5jb20vcGNhMy1nNS5jcmww KAYDVR0RBCEwH6QdMBsxGTAXBgNVBAMTEFZlcmlTaWduTVBLSS0yLTcwHQYDVR0O BBYEFNebfNgioBX33a1fzimbWMO8RgC1MB8GA1UdIwQYMBaAFH / TZafC3ey78DAJ 80M5 + gKvMzEzMA0GCSqGSIb3DQEBBQUAA4IBAQBxtX1zUkrd1000Ky6vlEalSVAC T / gvF3DyE9wfIYaqwk98NzzURniuXXhv0bpavBCrWDbFjGIVRWAXIeLVQqh3oVXY QwRR9m66SOZdTLdE0z6k1dYzmp8N5tdOlkSVWmzWoxZTDphDzqS4w2Z6BVxiEOgb Ett9LnZQ / 9 / XaxvMisxx + rNAVnwzeneUW / ULU / sOX7xo + 68q7jA3eRaTJX9NEP9X + 79uOzMh3nnchhdZLUNkt6Zmh + q8lkYZGoaLb9e3SQBb26O / KZru99MzrqP0nkzK XmnUG623kHdq2FlveasB + lXwiiFm5WVu / XzT3x7rfj8GkPsZC9MGAht4Q5mo ----- END CERTIFICATE -----T / gvF3DyE9wfIYaqwk98NzzURniuXXhv0bpavBCrWDbFjGIVRWAXIeLVQqh3oVXY QwRR9m66SOZdTLdE0z6k1dYzmp8N5tdOlkSVWmzWoxZTDphDzqS4w2Z6BVxiEOgb Ett9LnZQ / 9 / XaxvMisxx + rNAVnwzeneUW / ULU / sOX7xo + 68q7jA3eRaTJX9NEP9X + 79uOzMh3nnchhdZLUNkt6Zmh + q8lkYZGoaLb9e3SQBb26O / KZru99MzrqP0nkzK XmnUG623kHdq2FlveasB + lXwiiFm5WVu / XzT3x7rfj8GkPsZC9MGAht4Q5mo ----- END CERTIFICATE -----T / gvF3DyE9wfIYaqwk98NzzURniuXXhv0bpavBCrWDbFjGIVRWAXIeLVQqh3oVXY QwRR9m66SOZdTLdE0z6k1dYzmp8N5tdOlkSVWmzWoxZTDphDzqS4w2Z6BVxiEOgb Ett9LnZQ / 9 / XaxvMisxx + rNAVnwzeneUW / ULU / sOX7xo + 68q7jA3eRaTJX9NEP9X + 79uOzMh3nnchhdZLUNkt6Zmh + q8lkYZGoaLb9e3SQBb26O / KZru99MzrqP0nkzK XmnUG623kHdq2FlveasB + lXwiiFm5WVu / XzT3x7rfj8GkPsZC9MGAht4Q5mo ----- END CERTIFICATE -----

# php - 从 PHP 中的 From 电子邮件标头中提取名称和电子邮件

> ID：12253381
> 
> 赞同：0
> 
> 时间：2012-09-03T19:59:10.310
> 
> 标签：php, string, parsing, split

我正在用 PHP 解析电子邮件。我已经完成了解析器，但现在我很好奇是否有任何简单的方法可以从 From 标头中提取名称和电子邮件，如下所示：

**从：** `John Doe <john.doe@hotmail.com>`

有没有获取`John Doe`和`john.doe@hotmail.com`分离的捷径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:15:13.530

您可以尝试使用[preg_match()](http://php.net/manual/en/function.preg-match.php)的正则表达式。

```
/From:\s*(.*[^\s])\s*<\s*(.*[^\s])\s*>/ 
```

这应该会在索引一和索引二中为您提供姓名和电子邮件地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:02:41.557

如果`mailparse`可以安装 PECL 扩展程序，您可以尝试使用它。如果没有，请提取`From:`标题并解析它。发件人的名字是可选的，所以它可能不存在，但电子邮件应该（但要小心垃圾邮件发送者）。有关详细信息，请参阅[RFC 822](http://www.ietf.org/rfc/rfc822.txt)和[RFC 2822](http://www.ietf.org/rfc/rfc2822.txt)

# sql - 在多列主键中选择最后一行版本的更好方法

> ID：12253383
> 
> 赞同：2
> 
> 时间：2012-09-03T19:59:15.463
> 
> 标签：sql, postgresql

我有一个 Postgres 表，其中 PK 由 UUID（id）和整数（版本）组成。大多数查询都希望选择特定 ID 的最新版本。我现在使用的查询如下所示：

```
select * from dataset
where id = '0faa6a7b-587c-4106-9b1e-3cf155c2ee41' and 
version = (select max(version) from dataset where id = '0faa6a7b-587c-4106-9b1e-3cf155c2ee41') 
```

我想知道是否有更好、更有效的方式来处理这种类型的查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T00:23:38.220

哪种方法最快取决于索引和数据分布。PostgreSQL中*最短*的（通常也是最快的）是：

```
SELECT DISTINCT ON (id) *
FROM   dataset
WHERE  id = '0faa6a7b-587c-4106-9b1e-3cf155c2ee41'
ORDER  BY id, version DESC; 
```

可以扩展以一次获取具有最新版本的多行。对于单行，这也可以：

```
SELECT *
FROM   dataset
WHERE  id = '0faa6a7b-587c-4106-9b1e-3cf155c2ee41'
ORDER  version DESC
LIMIT  1; 
```

该案例的完美索引将是一个[多列索引](http://www.postgresql.org/docs/current/interactive/indexes-multicolumn.html)，例如：

```
CREATE INDEX dataset_id_version_idx ON dataset(id, version DESC); 
```

更多关于`DISTINCT ON`：

[在每个 GROUP BY 组中选择第一行？](https://stackoverflow.com/questions/3800551/select-first-row-in-each-group-by-group/7630564#7630564)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T00:09:45.287

你可以使用反连接，

这是一个示例，返回所有的最新版本

```
SELECT
    d.*   
FROM
    "dataset" AS d
    LEFT JOIN "dataset" As d_ ON d_."id" = d."id" AND d_."version" > d."version"
WHERE
    d_."id" IS NULL
; 
```

如果您在版本字段上也有索引，此查询还为您提供速度。你也可以过滤任何你想要的。

# asp.net - ASP.NET 中文件名的正则表达式

> ID：12253387
> 
> 赞同：0
> 
> 时间：2012-09-03T19:59:38.207
> 
> 标签：asp.net, .net, regex

我有一个表格，我上传了一个文件，我必须验证文件名是否具有这种格式`input##.txt`，`##`数字在哪里。

到目前为止，我对上传输入和正则表达式都有一个验证器`input\d{2}\.txt`，但我发现它还不够，因为 FileUpload 控件的文件名如下所示：

**C:\Documents and Settings\xyz\Desktop\input01.txt**

我只需要验证带有`input01.txt`.

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:03:55.890

试试这个：

```
var fileName = Path.GetFileName(path);
var regex = new Regex("input\d{2}.txt", RegexOptions.IgnoreCase);
var isValid = regex.Matches(fileName); 
```

# python - Numpy C API：链接几个目标文件

> ID：12253389
> 
> 赞同：8
> 
> 时间：2012-09-03T19:59:47.803
> 
> 标签：python, c, api, gcc, numpy

我正在使用 numpy 的 C API 编写一些用于矩阵计算的函数。今天我想将我的函数的某些部分移动到一个单独的 .c 文件中，并使用标题来声明它们。现在我有一个与 numpy 的`import_array`函数有关的奇怪问题。我试图尽可能地简化问题。首先是工作程序：

**我的测试.c**

```
#include "mytest.h"

PyObject* my_sub_function() {
    npy_intp dims[2] = {2, 2};
    double data[] = {0.1, 0.2, 0.3, 0.4};

    PyArrayObject* matrix = (PyArrayObject*)PyArray_SimpleNew(2, dims, NPY_FLOAT64);
    memcpy(PyArray_DATA(matrix), data, sizeof(double) * dims[0] * dims[1]);

    return (PyObject*)matrix;
}

static PyObject* my_test_function(PyObject* self, PyObject* args) {
    return my_sub_function();
}

static PyMethodDef methods[] = {
    {"my_test_function", my_test_function, METH_VARARGS, ""},
    {0, 0, 0, 0}
};

static struct PyModuleDef module = {
    PyModuleDef_HEAD_INIT, "mytest", 0, -1, methods
};

PyMODINIT_FUNC PyInit_mytest() {
    import_array();
    return PyModule_Create(&module);
} 
```

**我的测试.h**

```
#ifndef mytest_h
#define mytest_h

#include <Python.h>
#include <numpy/arrayobject.h>
#include <numpy/npy_common.h>

PyObject* my_sub_function();

#endif 
```

**生成文件**

```
all: mytest.o sub.o
    gcc -shared -Wl,-soname,mytest.so -o mytest.so mytest.o

mytest.o: sub.o
    gcc -fPIC -c mytest.c `pkg-config --cflags python3`

clean:
    rm -rf *.so
    rm -rf *.o 
```

一切都按预期工作。我可以调用`make`然后加载模块并调用函数：

**测试.py**

```
import mytest
print(mytest.my_test_function()) 
```

如果我`import_array`从 init 函数中删除，则会出现段错误，这是许多邮件列表和论坛中报告的行为。

现在我只想`my_sub_function`从**mytest.c**中删除整个函数并将其移动到一个名为**sub.c**的文件中：

```
#include "mytest.h"

PyObject* my_sub_function() {
    npy_intp dims[2] = {2, 2};
    double data[] = {0.1, 0.2, 0.3, 0.4};

    PyArrayObject* matrix = (PyArrayObject*)PyArray_SimpleNew(2, dims, NPY_FLOAT64);
    memcpy(PyArray_DATA(matrix), data, sizeof(double) * dims[0] * dims[1]);

    return (PyObject*)matrix;
} 
```

新的**Makefile**是：

```
all: mytest.o sub.o
    gcc -shared -Wl,-soname,mytest.so -o mytest.so mytest.o sub.o

mytest.o:
    gcc -fPIC -c mytest.c `pkg-config --cflags python3`

sub.o:
    gcc -fPIC -c sub.c `pkg-config --cflags python3`

clean:
    rm -rf *.so
    rm -rf *.o 
```

如果我现在尝试加载模块并调用函数，函数调用会给我一个段错误。如果我调用 to`import_array`的顶部，我可以解决问题`my_sub_function`，但我认为这不是应该使用该函数的方式。

所以我想知道为什么会发生这种情况，以及将 numpy 模块拆分为多个源文件的“干净”方法是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T08:35:35.447

默认情况下，该`import_array`例程只会使 NumPy C API 在单个文件中可用。这是因为它通过存储在静态全局变量中的函数指针表工作（即不导出，仅在同一文件中可见）。

如[文档中所述](http://docs.scipy.org/doc/numpy/reference/c-api.array.html#importing-the-api)，您可以使用一些预处理器定义来更改此行为：

1.  在您的扩展的所有文件中，定义`PY_ARRAY_UNIQUE_SYMBOL`一个不可能与其他扩展冲突的唯一变量。在变量名中包含扩展的模块名称是个好主意。

2.  在除您调用的文件之外的每个文件中`import_array`，定义符号`NO_IMPORT_ARRAY`

这些符号需要在包含之前定义`arrayobject.h`，以使它们生效。

# magento-1.5 - 服务器配置更改后，许多后端页面中的...lib/Zend/Date.php(1078) 中没有日期部分

> ID：12253398
> 
> 赞同：4
> 
> 时间：2012-09-03T20:00:27.873
> 
> 标签：magento-1.5, magento

在我们客户的商店托管公司进行了一些未报告的更改之后，我们在 magento 日期格式和许多管理屏幕中断（销售订单视图、客户、索引管理等）方面遇到了许多错误。

在报告文件夹日志中，我得到：

```
a:5:{i:0;s:44:"No date part in '2012-09-03 19:36:17' found.";i:1;s:6218:"#0 /public_html/sp/lib/Zend/Date.php(1078): Zend_Date->_calculate('set', '2012-09-03 19:3...', 'yyyy-MM-dd HH:m...', 'pt_BR')
#1 /public_html/sp/lib/Zend/Date.php(197): Zend_Date->set('2012-09-03 19:3...', 'yyyy-MM-dd HH:m...', 'pt_BR')
#2 /public_html/sp/app/code/core/Mage/Core/Model/Locale.php(478): Zend_Date->__construct('2012-09-03 19:3...', 'yyyy-MM-dd HH:m...', Object(Zend_Locale))
#3 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Widget/Grid/Column/Renderer/Datetime.php(81): Mage_Core_Model_Locale->date('2012-09-03 19:3...', 'yyyy-MM-dd HH:m...')
#4 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Widget/Grid/Column.php(128): Mage_Adminhtml_Block_Widget_Grid_Column_Renderer_Datetime->render(Object(Mage_Index_Model_Process))
#5 /public_html/sp/app/design/adminhtml/default/casadosaber/template/widget/grid.phtml(161): Mage_Adminhtml_Block_Widget_Grid_Column->getRowField(Object(Mage_Index_Model_Process))
#6 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(235): include('/public_html/s...')
#7 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(266): Mage_Core_Block_Template->fetchView('adminhtml/defau...')
#8 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(280): Mage_Core_Block_Template->renderView()
#9 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Template.php(81): Mage_Core_Block_Template->_toHtml()
#10 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(758): Mage_Adminhtml_Block_Template->_toHtml()
#11 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(525): Mage_Core_Block_Abstract->toHtml()
#12 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(476): Mage_Core_Block_Abstract->_getChildHtml('grid', true)
#13 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Widget/Grid/Container.php(70): Mage_Core_Block_Abstract->getChildHtml('grid')
#14 /public_html/sp/app/design/adminhtml/default/default/template/widget/grid/container.phtml(36): Mage_Adminhtml_Block_Widget_Grid_Container->getGridHtml()
#15 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(235): include('/home/storage/5...')
#16 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(266): Mage_Core_Block_Template->fetchView('adminhtml/defau...')
#17 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(280): Mage_Core_Block_Template->renderView()
#18 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Template.php(81): Mage_Core_Block_Template->_toHtml()
#19 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Widget/Container.php(295): Mage_Adminhtml_Block_Template->_toHtml()
#20 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(758): Mage_Adminhtml_Block_Widget_Container->_toHtml()
#21 /public_html/sp/app/code/core/Mage/Core/Block/Text/List.php(43): Mage_Core_Block_Abstract->toHtml()
#22 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(758): Mage_Core_Block_Text_List->_toHtml()
#23 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(525): Mage_Core_Block_Abstract->toHtml()
#24 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(476): Mage_Core_Block_Abstract->_getChildHtml('content', true)
#25 /public_html/sp/app/design/adminhtml/default/default/template/page.phtml(74): Mage_Core_Block_Abstract->getChildHtml('content')
#26 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(235): include('/home/storage/5...')
#27 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(266): Mage_Core_Block_Template->fetchView('adminhtml/defau...')
#28 /public_html/sp/app/code/core/Mage/Core/Block/Template.php(280): Mage_Core_Block_Template->renderView()
#29 /public_html/sp/app/code/core/Mage/Adminhtml/Block/Template.php(81): Mage_Core_Block_Template->_toHtml()
#30 /public_html/sp/app/code/core/Mage/Core/Block/Abstract.php(758): Mage_Adminhtml_Block_Template->_toHtml()
#31 /public_html/sp/app/code/core/Mage/Core/Model/Layout.php(529): Mage_Core_Block_Abstract->toHtml()
#32 /public_html/sp/app/code/core/Mage/Core/Controller/Varien/Action.php(391): Mage_Core_Model_Layout->getOutput()
#33 /public_html/sp/app/code/core/Mage/Index/controllers/Adminhtml/ProcessController.php(55): Mage_Core_Controller_Varien_Action->renderLayout()
#34 /public_html/sp/app/code/core/Mage/Core/Controller/Varien/Action.php(420): Mage_Index_Adminhtml_ProcessController->listAction()
#35 /public_html/sp/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(253): Mage_Core_Controller_Varien_Action->dispatch('list')
#36 /public_html/sp/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#37 /public_html/sp/app/code/core/Mage/Core/Model/App.php(340): Mage_Core_Controller_Varien_Front->dispatch()
#38 /public_html/sp/app/Mage.php(630): Mage_Core_Model_App->run(Array)
#39 /public_html/sp/index.php(84): Mage::run('', 'store')
#40 {main}";s:3:"url";s:39:"/sp/index.php/cs_mg_admin/process/list/";s:11:"script_name";s:13:"/sp/index.php";s:4:"skin";s:5:"admin";} 
```

在开发环境中它运行良好，并且在昨天之前，当主机进行了许多更改时，它也可以在那里运行。

我们使用 America/Sao_Paulo 作为时区，并且在*customer_entity*表中没有在 created_at 或 updated_at 处具有 NULL 值的客户，在*sales_flat_order*和*sales_flat_order_grid*表中也没有。

我还尝试更新*eav_attribute表中的 created_at 属性以及我在*[本主题](https://stackoverflow.com/questions/8505003/get-error-while-editing-customers-from-back-end-in-magento/8620783#8620783)中看到的其他内容。

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T21:08:10.313

查看上面的转储，您的异常消息是

```
"No date part in" 
```

如果您搜索 Magento 代码库，则此异常消息显示的唯一位置是

```
#File: lib/Zend/Locale/Format.php 
$split = false;
preg_match_all('/\d+/u', $number, $splitted);

if (count($splitted[0]) == 0) {
    iconv_set_encoding('internal_encoding', $oenc);
    #require_once 'Zend/Locale/Exception.php';
    throw new Zend_Locale_Exception("No date part in '$date' found.");
} 
```

对该函数进行了一些研究，我很确定您的服务器上发生的事情是该`pcre_match_all`函数在运行以下代码时未能找到任何匹配项（您可以通过调试确认这一点）

```
preg_match_all('/\d+/u', '2012-09-03 19:36:17', $splitted); 
```

这似乎不合逻辑，因为那里有数字要拆分，所以可能发生的事情是通过 PHP 更改或 MySQL 更改，此函数正在接收**非 utf8**编码的文本，并且使用该`/u`选项正则表达式无法解析字符串正确。

如果我正在咨询这个项目，我建议使用一些调试代码确认上述内容（尝试`preg_match_all`使用纯文本运行该函数，然后使用从数据库中提取的文本）。然后我会对主机大喊大叫，告诉他们配置他们的应用程序，这样就不会发生这种情况。然后，如果这不起作用，我将专注于如何将数据库中的所有日期文本转换为当前配置可以理解的格式。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:08:48.953

首先，感谢 Alan Storm 帮助找出了它几乎真正的问题。我试图从该 REG EXP 中删除“/u”，但我意识到 Magento 和 Zend 框架在许多地方使用带有 /u 的正则表达式，例如核心/字符串助手和许多其他地方。

因此，我使用以下代码制作了一个 PHP，并尝试在两种环境中运行它。

```
<?php
$number = '2012-08-23 22:15:48';

preg_match_all('/\d+/u', $number, $splitted);

echo "<pre>";
var_dump($splitted);
echo "</pre>"; 
```

因此，在有问题的服务器上，我收到了警告...

> 警告：preg_match_all() [function.preg-match-all]：编译失败：在第 4 行的 /.../public_html/test.php 中的偏移量 -1 处设置了未知选项位 NULL

在网上搜索，我发现这个（[phpinfo 报告不正确的 pcre 版本](https://stackoverflow.com/questions/9323228/phpinfo-is-reporting-incorrect-pcre-version)）简而言之告诉我们验证 PCRE 版本（在 phpinfo() 中）。

所以......所有这些问题都是因为***PCRE lib 版本***......在我的生产环境中太旧了......使用 *6.6 06-Feb-2006*而其他人使用*8.xx*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-29T21:25:34.300

感谢它，因为它主要是当某些主机使用带有 suexec 的安全 php 时，我不太了解，但 PCRE 存在一些冲突

# c - printf 右对齐括号内的数字

> ID：12253400
> 
> 赞同：5
> 
> 时间：2012-09-03T20:00:51.187
> 
> 标签：c, format, printf

我正在编写一个程序，将所有信息显示在一个数组中。它必须从括号中的数组索引开始（例如`[2]`），并且它们必须彼此右对齐。

如果只是数字，我知道你可以这样做：

```
printf("%-10d", index); 
```

但是将括号括起来会给出以下输出

```
[         1]
[         2]
...
[        10]
[        11] 
```

当我真的想要它时：

```
 [1]
         [2]
...
        [10]
        [11] 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T20:03:58.043

分两步完成：首先在临时缓冲区中构建一个未对齐的字符串，然后打印右对齐的字符串。

```
char buf[sizeof(index) * (CHAR_BITS + 2) / 3 + 4];
sprintf(buf, "[%d]", index);
printf("%-12s", buf); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:04:29.190

一件简单的事情是将其分解为两步过程：

```
char tmp[128];
sprintf(tmp, "[%d]", index);
printf("%-10s", tmp); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T21:09:18.347

您只需要一行，**不需要**临时字符缓冲区：

```
printf("%*s[%d]\n",12-(int)log10(index),"",index); 
```

# python - 干草堆 sqs 无法与 django 分页一起正常工作

> ID：12253403
> 
> 赞同：1
> 
> 时间：2012-09-03T20:01:07.283
> 
> 标签：python, django, pagination, django-haystack

所以这里是视图：

```
def search(request, template_name='search/search.html'):
    filters = {}
    status = None
    query = request.GET.get('q')
    form = FilterForm(request.GET or None)
    sqs = SearchQuerySet().models(Tutor).order_by('-overall_rating')
    paginator = Paginator(sqs, 10)
    page = request.GET.get('page')

    try:
        results = paginator.page(page)
    except PageNotAnInteger:
        results = paginator.page(1)
    except EmptyPage:
        results = paginator.page(paginator.num_pages)

    context = {
        'results': results,
        'form':    form,
    }

    return render(request, template_name, context) 
```

现在ipdb中的sqs显示为：

```
[<SearchResult: tutoring.tutor (pk=u'2')>, <SearchResult: tutoring.tutor (pk=u'1')>] 
```

它的计数是2。但是分页结果显示为：

```
paginator = Paginator(sqs, 10)
results = paginator.page(1)
results.object_list
[<SearchResult: tutoring.tutor (pk=u'2')>, None] 
```

其中第二个结果实例更改为无。我在 django 1.4.1 和来自 github 的最新 haystack 上。可能是什么问题呢？

# mysql - 具有 DEFAULT NULL 的 MySQL 列 - 风格选择，或者是它？

> ID：12253415
> 
> 赞同：27
> 
> 时间：2012-09-03T20:02:39.653
> 
> 标签：mysql, sql, postgresql, database-migration, sql-scripts

在许多 SQL 风格中，您可以通过三种方式在每次插入行时将列隐式设置为 NULL。这些都是：

```
columnname type NULL
columnname type DEFAULT NULL
columnname type NULL DEFAULT NULL 
```

即第一个设置 NULL 标志（与 NOT NULL 相对），第二个将 NULL 标志保留为默认值，第三个设置 NULL 标志并将隐式值设置为 NULL。

我听说在 Microsoft SQL 中，第二个变体并不完全相同，因为您还可以为表或模式自定义 NULL 标志的默认值。

但是对于 MySQL，我不相信有这样的功能。此外，在 MySQL 中，与 NOT NULL 列不同，带有 NULL 标志的列在没有显式值的情况下总是在插入时隐式设置为 NULL，即使打开了严格模式也是如此。因此，所有这些列声明都是相同的。

在我的 MySQL 脚本中，对于每个 NOT NULL 列，我为我不希望在我的应用程序的某些插入中设置的列指定一个 DEFAULT 值，以避免在启用严格模式时出现任何问题。因此，我觉得如果我选择第三种变体会更加对称，即使它是最冗长和明确的。像第三个变体这样的声明是常见的，还是第一个或第二个变体更频繁地出现在其他人的脚本中？

我正在考虑倾向于第二种方法，因为这是 MySQL 转储使用的别名，但我不确定这是一个好主意，因为它还在列声明的默认子句中将整数文字转储为字符串（单引号）。

这个问题似乎比有解决方案的问题更具意见，但我也想知道我不知道的任何潜在问题。将来我可能会选择从 MySQL 迁移到 PostgreSQL，我也可以参考那些专家的一些建议，例如，如果 PostgreSQL 能像 MS-SQL 那样区分这些情况。如果我做了任何不正确的假设，请纠正我。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-03T20:21:20.763

如[数据类型默认值](http://dev.mysql.com/doc/en/data-type-defaults.html)下所述：

> 如果列可以`NULL`作为值，则使用显式`DEFAULT NULL`子句定义该列。

（我认为他们的意思是*隐式*的，而不是*显式*的）。

此外，如[`CREATE TABLE`语法](http://dev.mysql.com/doc/en/create-table.html)中所述：

> 如果既未指定`NULL`也未`NOT NULL`指定，则将该列视为`NULL`已指定。

因此，在 MySQL 中，以下列定义都是相同的：

```
columnname type
columnname type NULL
columnname type DEFAULT NULL
columnname type NULL DEFAULT NULL 
```

选择使用哪个是明确和简洁之间的平衡。根据情况，我可能会使用上述任何一种。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-03T20:21:34.877

我遇到的每个数据库都按照您描述它们的方式处理 NULL。当列接受 NULL 值时，如果在 INSERT 上不提供值，则默认值为 NULL。我相信这是 ANSI 标准行为的一部分。

至于指定“NULL”本身。这是一个偏好问题。该标准确实说，*除非*指定 NOT NULL（在数据定义语言级别），否则列允许 NULL。因此，NULL 本身是不必要的，您还有第四个等效选项：

```
columnname type 
```

NULL 通过 ANSI 标准完全嵌入在 SQL 语言中。您的第三个选项是最明确的，但它看起来也有点不寻常。

如果您计划在整个系统中保持超级一致，那么我会选择您正在走的路。对于每个表中的每一列都有 NULL 或 NOT NULL。对于所有采用默认值的列，请使用 DEFAULT 语句。

但是，不要指望与您一起工作的其他人（现在或将来）很容易效仿这个例子。在这种情况下，许多人更喜欢第四个选项，因为它需要更少的输入，并且是所有（或几乎所有）SQL 方言的行为方式。

# vim - 如何使 vim 中的 netrw 像 Visual Studio 中的解决方案资源管理器一样工作

> ID：12253419
> 
> 赞同：15
> 
> 时间：2012-09-03T20:02:50.030
> 
> 标签：vim, netrw

好的，我会在这里更清楚地说明这一点.. 假设我在垂直拆分窗口中列出了目录，以及我正在编辑的文件..

我可以使用 Ctrl+w 从一个拆分到另一个拆分，并使用 netrw 插件以四种方式打开文件列表中的文件.. 使用返回键、v、o、t..

使用返回键，它在当前（netrw）拆分窗口中打开.. 使用 v，它创建一个新的垂直拆分..（与 o（水平拆分），t（新标签）相同）

但我希望在已经存在的另一个拆分中打开文件，在那里我进行所有编辑..而不是打开新拆分..我希望我的问题很清楚..说通过输入命令，突出显示的文件将在编辑拆分而不是 netrw 拆分中打开.. 必须有一些简单的解决方案.. 或者有人可以告诉我使用 netrw 的最佳方法.. 我会尝试适应..

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-03T20:32:46.453

答案在文档中：`:h netrw`. 照常。

您正在寻找`P`：

```
To edit a file or directory in the previously used (last accessed) window (see
:he CTRL-W_p), press a "P".  If there's only one window, then the one window
will be horizontally split (above/below splitting is controlled by
g:netrw_alto, and its initial size is controlled by g:netrw_winsize).

If there's more than one window, the previous window will be re-used on
the selected file/directory.  If the previous window's associated buffer
has been modified, and there's only one window with that buffer, then
the user will be asked if s/he wishes to save the buffer first (yes,
no, or cancel). 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-18T19:58:24.073

另一种方法：使用 :let g:netrw_chgwin=2 （或您喜欢的任何窗口编号）。随后在 netrw 中选择文件将使用该窗口进行编辑。

# android - 看不出为什么 onActivityResult 不起作用

> ID：12253422
> 
> 赞同：0
> 
> 时间：2012-09-03T20:03:07.347
> 
> 标签：android, android-intent

第二个活动上的“setResult”要么没有在第一个活动中将数据传递回 onActivityResult，要么甚至没有调用 onActivityResult ......我不知道是哪个

* * *

第一个活动：

```
//-- Handle item selection
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menu_settings:
            Intent i = new Intent(this, Options.class);
            Bundle counters = new Bundle();
            counters.putInt("plWin", plWin);
            counters.putInt("plLoss", plLoss);
            counters.putInt("plDraw", plDraw);
            i.putExtras(counters);
            startActivityForResult(i, RESULT_OK);
            return true;
        case R.id.menu_reset:

//-- Data being passed from "Options" --
protected void onActivityResult(int requestCode, int resultCode, Intent i){
    Bundle counts = i.getExtras();
    if (resultCode == RESULT_OK) {
        Toast.makeText(getApplicationContext(), "BOOM SHAKA LAKA!",Toast.LENGTH_SHORT).show();

        plWin = counts.getInt("Win", 100);
        plLoss = counts.getInt("Loss", 100);
        plDraw = counts.getInt("Draw", 100);
    }
}
} 
```

* * *

第二个活动：

```
}
//-- Data being passed back to "Main" -- 
public void onBackPressed() {
    Bundle counters = new Bundle();
    Intent i = new Intent();
    counters.putInt("Win", wins);
    counters.putInt("Loss", losses);
    counters.putInt("Draw", draws);
    i.putExtras(counters);
    setResult(RESULT_OK, i);
    finish();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:05:22.953

将代码更改为：

```
Bundle counts = data.getExtras();
if (resultCode == RESULT_OK) {  
    plWin = counts.getInt("Win");
    plLoss = counts.getInt("Loss");
    plDraw = counts.getInt("Draw");
} 
```

getIntent() 在您的情况下返回了启动第一个活动的意图。调用者活动，因此无需从第二个活动返回数据。

UPD：另外我想强调一下，`onBackPressed()`在第二个活动中实施非常奇怪。它正在调用`super.onBackPressed()`，默认情况下设置“取消”结果，因此不能保证您的 RESULT_OK 将是真正的返回值。

我建议更改代码，例如：

```
public void onBackPressed() {
    Bundle counters = new Bundle();
    Intent i = new Intent();
    counters.putInt("Win", wins);
    counters.putInt("Loss", losses);
    counters.putInt("Draw", draws);
    i.putExtras(counters);
    setResult(RESULT_OK, i);
    finish();
} 
```

请让我们知道它是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:28:05.550

尝试使用这个

```
plWin=data.getIntExtra("Win",0);
plLoss=data.getIntExtra("Loss",0);
plDraw=data.getIntExtra("Draw",0); 
```

并检查值是否返回零，这意味着从活动传递额外或捆绑时存在一些问题。

如果有任何类似的情况可以通过代码处理，但我认为这些函数不会出现任何异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T21:09:10.350

您的错误是在您正在编写结果代码的请求代码的位置（RESULT_OK）

```
startActivityForResult(i, RESULT_OK); //incorrect 
```

我建议做一个像这样的静态变量

```
public static final int REQUEST_SECOND=100; 
```

并通过它像

```
statrtActivityForResult(i,REQUEST_SECOND); 
```

然后在第二个活动中为结果创建一个静态变量

```
public static final int MY_RESULT=101; 
```

并调用第二个活动

```
setResult(MY_RESULT); 
```

并像这样写 onActivityResult ：

```
protected void onActivityResult(int requestCode, int resultCode, Intent i){

if(requestcod==REQUEST_SECOND){

    Bundle counts = i.getExtras();
    if (resultCode == MY_RESULT) {
        Toast.makeText(getApplicationContext(), "BOOM SHAKA LAKA!",Toast.LENGTH_SHORT).show();

        plWin = counts.getInt("Win", 100);
        plLoss = counts.getInt("Loss", 100);
        plDraw = counts.getInt("Draw", 100);
    }
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T21:17:43.097

我的“startActivityForResult”中有“RESULT_OK”而不是int。

将其从 OP 中显示的内容更改为：

```
startActivityForResult(i, 100); 
```

修复。

感谢大家的贡献！

# python - Django 1.4.1 'settings.DATABASES 配置不正确' 错误

> ID：12253424
> 
> 赞同：1
> 
> 时间：2012-09-03T20:03:23.040
> 
> 标签：python, django, django-settings

我正在浏览 Django Book 并在尝试执行“cursor = connection.cursor()”命令来测试数据库配置时遇到了问题。我是一个完全的菜鸟，但我确实花了几个小时试图找出问题 - 无济于事。（抱歉，下面的终端输出显示混乱 - 所以不允许新用户发布图片）。

* * *

```
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from django.db import connection
>>> cursor = connection.cursor()
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/backends/dummy/base.py", line 15, in complain
    raise ImproperlyConfigured("settings.DATABASES is improperly configured. "
ImproperlyConfigured: settings.DATABASES is improperly configured. Please supply the ENGINE value. Check settings documentation for more details.
>>> from django.conf import settings
>>> settings.DATABASES
{'default': {'ENGINE': 'django.db.backends.dummy', 'TEST_MIRROR': None, 'NAME': '', 'TEST_CHARSET': None, 'TIME_ZONE': 'UTC', 'TEST_COLLATION': None, 'OPTIONS': {}, 'HOST': '', 'USER': '', 'TEST_NAME': None, 'PASSWORD': '', 'PORT': ''}}
>>> 
```

* * *

我做了 settings.DATABASE 检查，结果与我保存在 settings.py 文件中的结果不同——这是问题的来源吗？

我看到这里有几个关于这个问题的类似问题 - 但没有一个为我解决了这个问题。

这是我从 settings.py 设置的数据库：

```
***
ADMINS = (
    # ('Your Name', 'your_email@example.com'),
)

MANAGERS = ADMINS

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'mydb',                      # Or path to database file if using sqlite3.
        'USER': 'paul',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
}

*** 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T07:41:54.223

我怀疑这可能是因为这本书已经过时了（Django 发展得相当快，并且自本书编写以来发生了许多向后不兼容的更改）。请参阅 The Django Book 的首页注释：

> 这本书最初由 Apress 于 2009 年出版，涵盖了 Django 1.0。从那时起，它就萎靡不振。我们正在努力更新本书以涵盖 Django 1.4、1.5 及更高版本。

因此，出现此错误可能不是您的错！:)

如果您还没有这样做，我建议您阅读官方 Django 教程（可通过 Django 主页获得链接）并阅读[文档](https://docs.djangoproject.com/)。教程和文档保持最新。但是，请注意查看已安装的 Django 版本的文档（文档可能因发布的每个 Django 版本而异）。您可以通过网站右下角的切换器 ( ![查看屏幕截图](../Images/42e3c4ff4e17ff40470c61d99730de8f.png)) 切换文档版本。

Django Book 仍然有价值，因为它揭示了 Django 背后的许多哲学——但请注意，提供的代码可能不适用于当前的 Django 版本。

# colors - 以 16 位编码 RGB 颜色

> ID：12253425
> 
> 赞同：2
> 
> 时间：2012-09-03T20:03:24.543
> 
> 标签：colors, bits

我正在阅读一本 android 游戏开发书，并且遇到了 RGB 三元组： (31, 31, 45) 使用 16 位（红色为 5 位，绿色为 6 位，蓝色为 5 位）。

我对三元组中的最后一个数字有点困惑：45。如果最后一个坐标是蓝色的，而蓝色只有 5 位，那么最后一个坐标点怎么可能有 45？蓝色的最高数字不应该是 31 吗？

顺便说一句，据说这个三元组创造了粉红色。

有人可以帮助消除混乱吗？

谢谢！

编辑：如果它有助于颜色的十六进制是 0xFC0D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:13:13.137

您的十六进制代码显示发生了什么：45 = 0x2d，但十六进制代码的低位只有 0xd，基本上高位被切掉，因为您是正确的，最高可能值为 0x1F。

可能是测试人员/编辑人员刚刚漏掉的东西。

RGB 代码很可能是这样构建的：

```
RGB(r,g,b)
{
    code = (r & 0x1f) << 11;
    code |= (g & 0x3f) << 5;
    code |= (b & 0x1f) << 0;
} 
```

所以任何额外的位都会被屏蔽掉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:13:42.773

十六进制的 FC0D 是

1111110000001101 二进制

所以

R=b11111=31 G=b100000=32 B=b01101=13

# printf - printf 显示行尾字符

> ID：12253426
> 
> 赞同：0
> 
> 时间：2012-09-03T20:03:38.127
> 
> 标签：printf

我有一个指向字符串的 char 指针：“123 \\n”。如果我执行 printf ("%s", char_pointer) 我会看到 123 \n。而不是 123 。假设我无法更改原始字符串的格式，那么摆脱多余的 \ 以使其正确显示的最简单方法是什么？

这是我正在处理的字符串的一个示例

```
const char *source = \
" printf (\"This is a test %d %d \\n.\",4,3);                                       \n"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:01:06.747

你有两个斜线。这意味着在`\\n`第一个`\`转义第二个`\`，并按原样打印。以下`n`被解释为独立字符而不是`\n`.

如果您希望`\`在行尾打印 ，则需要在`\`此处添加一个。

# php - 翻转多维数组的更好方法？

> ID：12253429
> 
> 赞同：2
> 
> 时间：2012-09-03T20:03:51.247
> 
> 标签：php, arrays, multidimensional-array

我从数据库中检索了一些数据，其结构如下：

```
[0]
  [item_id] = 197
  [dice_chat_css] = "foo"
  [dice_image] = "bar.png"
[1]
  [item_id] = 128
  [dice_chat_css] = "foo"
  [dice_image] = "bar.png" 
```

对我来说，将这些数据传递给我的 (PHP) 应用程序的其余部分的最方便且计算成本低廉的方法是使用`item_id`作为索引，因为它无需遍历数组来查找值。如果这是一个平面数组，我可以用 来轻松完成`array_flip`，但既然不是，我选择使用[PHP.net 评论中列出的多维 array_flip，](http://www.php.net/manual/en/function.array-flip.php#107097)或者使用我自己的逻辑：

```
for ($i = 0; $i < sizeOf($r); $i++){
    $s[$r[$i]['item_id']]['dice_image'] = $r[$i]['dice_image'];
    $s[$r[$i]['item_id']]['dice_chat_css'] = $r[$i]['dice_chat_css'];
} 
```

我知道这很简单，但感觉就像我在这里重新发明轮子一样。是否有一种可接受的、更优化的方法可用，还是我对此感到奇怪？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T21:36:25.137

为什么不只是做

```
$indexed = array();
foreach ($r as $row) {
    $indexed[$row['item_id']] = $row;
}

// or if you're concerned about memory (e.g. result set is large), less smooth version:
foreach ($r as $index => $row) {
    $r[$row['item_id']] = $row;
    unset($r[$index]);    // it works ok, foreach doesn't traverse over added elements, but it isn't a good way
}

// or smoother alternative for unset(), have second array contain links to first:
$indexed = array();
foreach ($r as &$row) {
    $indexed[$row['item_id']] = &$row;
} 
```

# c# - 在 Silverlight 类库中创建 xml 文件

> ID：12253432
> 
> 赞同：0
> 
> 时间：2012-09-03T20:04:11.460
> 
> 标签：c#, silverlight-5.0

我有一个项目，我想在其中创建几个文件来保存数据。当我想保存此文件时，我收到拒绝操作错误，因为我的 SL 应用程序没有保存权限。

如何将此文件保存在其他项目代码中的类库项目文件或 Web ClientBin 文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T08:25:17.807

如果你想从 Silverlight 创建文件，你应该写信给 IsolatedStorage：http: [//msdn.microsoft.com/en-us/library/system.io.isolatedstorage%28v=VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage%28v=VS.80%29.aspx)

您将有权访问该文件夹，默认情况下配额有限。

# java - 这在java中有什么作用？我不明白--变量

> ID：12253435
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:04:28.763
> 
> 标签：java

```
array[i] = array[--size]; 
```

我知道 variable-- 等于 variable - 1 但 --variable 等于什么，当它位于数组括号中时它会做一些特殊的事情吗？我想这会从数组中删除一些我真的不明白这里的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:07:04.360

代码设置`size = size - 1`并随后将元素复制`size`到`i`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:07:29.070

它简单地等同于：

```
size-=1;
array[i] = array[size]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T20:08:34.053

您的代码与以下内容相同：

```
size--;
array[i] = array[size]; 
```

前缀减量与后缀非常相似，唯一的区别是它计算的是减量*之后*的结果，而不是*之前*的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T20:09:03.690

变量大小是在您的代码前面定义的。变量名前面的 -- 导致在执行该行代码之前减少 1。例如，如果 size 变量设置为 5，则在赋值发生之前，size 变量将减少到 4，然后执行 array[i] = array[4] 的赋值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-03T20:09:06.360

它只是这样做：

```
size-=1;
array[i] = array[size]; 
```

`--variable`表示预减量。那是首先该值将递减然后使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-03T20:10:16.593

`--`从变量中减去 1，但`--`( 或`++`) 的位置控制变量何时递减

*   `array[--size]`在访问数组之前减一

*   `array[size--]`数组被访问后会减一

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-03T20:08:29.570

返回at位置中的`array[index]`元素。`array``index`

该`--value`方法将值评估为`value = value - 1`，然后在操作中应用新值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-03T20:09:51.180

i-- 和 --i 本质上做同样的事情：它们从 i 中减去 1。不同之处在于 i-- 将在动作完成后减 1，而 --i 将在动作完成前减 1。这在 for 循环的情况下更有意义：

```
for (i = 5; i > 0; i--) {...} 
```

在这种情况下，for 循环将运行 i 等于 5，然后在循环结束时，它将重复，但减去 1。如果情况是这样：

```
for (i = 5; i > 0; --i) {...} 
```

在循环运行之前，我会从中减去 1，因此它会立即以 0 开始，但另一方面，它也会在 i = 0 时运行在末尾。

说`--size`起来就像说`size`负1的值。

# gnuplot - 直方图条隐藏抽动

> ID：12253438
> 
> 赞同：4
> 
> 时间：2012-09-03T20:05:01.227
> 
> 标签：gnuplot, histogram

我正在绘制一个直方图，`gnuplot`条形图最终覆盖了 x 轴上的抽动，如下所示：

![在此处输入图像描述](../Images/ee38f6b3f22fa36872e1c7bfc601c76f.png)

有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:09:00.537

我不确定这是否可行，但你可以试试这个：

```
 set grid noxtics noytics noztics front 
```

从阅读文档来看，在绘图时似乎会将抽动推到对象堆栈的顶部（即，它们将在使它们可见的条形之后被绘制*（我认为）*）。另一种选择是在您的填充样式中使用透明度，但这可能不适用于您的终端（并且可能不理想）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:47:21.437

您可以在脚本中添加一些行，例如

```
plot 'data.dat' # whatever your plot command is
set yrange [0:GPVAL_DATA_Y_MAX*1.05]
replot 
```

这将最高数据点上方的 y 范围扩大了一点。要找出最高 y 点，您必须绘制一次，然后在设置 y 范围后再次绘制。另一种选择是做

```
set xtics out 
```

这使得 xtics 指出而不是 in。

# multithreading - Lwiit J2ME 中的等待屏幕

> ID：12253441
> 
> 赞同：1
> 
> 时间：2012-09-03T20:05:16.093
> 
> 标签：multithreading, java-me, loading, lwuit

我只想在我的 Lwiit J2ME 应用程序中解析一些 Xml 时显示加载屏幕。我看到有很多例子，例如滑块和仪表，我找到了这个简单的代码，但我不知道如何在解析操作时显示对话框。如果我使用 dialog.showDialog(); 它会阻止用户界面

```
passenger p = new passenger();
p.start();
synchronized (p) {
System.out.println("passenger is waiting for the bus ");    

        try {
            p.wait();
        } catch (InterruptedException ex) {
            ex.printStackTrace();
        }
                    System.out.println("passenger  got notification");
                    // I think that i must use the loading thing here but i don't know    
                    // what to do.

            }
            System.out.println("after "+p.total+" time");

    class passenger  extends Thread {
    int total = 0;

    public void run() {
            synchronized (this) { 

                    System.out.println("wait .... ");
                    for (int i = 0; i <= 3000; i++){
                            total = total + i;
                            System.out.println(total+"");
                    }
                    System.out.println("passenger  is given  notification call");
                    notify();
            }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T12:48:52.137

您需要在后台线程中进行解析，然后在完成后处理对话框。

# python - 将整数列表、元组转换为 numpy 数组

> ID：12253447
> 
> 赞同：0
> 
> 时间：2012-09-03T20:06:04.437
> 
> 标签：python, arrays, list, numpy, tuples

我有一个 [float, (float,float,float..) ] 的列表...基本上是一个 n 维点以及每个点的适应度值。例如。

```
4.3, (2,3,4)
3.2, (1,3,5)
.
.
48.2, (23,1,32) 
```

我希望根据适应度值随机抽样一个点。我决定最好的方法是使用`numpy.random.choice(range(n), 1, plist[:,:1,:1])`

但是，我需要将其转换为一个 numpy 数组，为此我尝试过

```
>> pArr = np.array( plist ) 
ValueError: setting an array element with a sequence 
```

我对 np.asarray(plist) 也有同样的错误..有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:11:43.860

你的问题很难理解。这是你想要做的吗？

```
>>> x
[[4.3, (2, 3, 4)], [3.2, (1, 3, 5)], [48.2, (23, 1, 32)]]
>>> np.array([(a, b, c, d) for a, (b, c, d) in x])
array([[  4.3,   2\. ,   3\. ,   4\. ],
       [  3.2,   1\. ,   3\. ,   5\. ],
       [ 48.2,  23\. ,   1\. ,  32\. ]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:12:16.373

以下应该有效：

```
A = np.array([tuple(i) for i in initial_list],dtype=[('fitness',float),('point',(float,3))]) 
```

与`initial_list = [[4.3, (2, 3, 4)], [3.2, (1, 3, 5)], ...]`. 请注意，我们需要将 的每个项目`initial_list`转换为一个元组才能使该技巧起作用，否则 NumPy 无法识别该结构。

您的健身条目现在可以访问为`A['fitness']`，对应的点为`A['point']`。如果您选择实际适应度条目列表`indices`，则对应点由 给出`A['point'][indices]`，这是一个简单的`(n,3)`数组。

# jakarta-ee - 如何回滚事务并继续处理更新？

> ID：12253448
> 
> 赞同：4
> 
> 时间：2012-09-03T20:06:05.950
> 
> 标签：jakarta-ee, transactions, ejb

我正在尝试围绕事务管理进行思考，但我很难弄清楚我应该如何从事务回滚中恢复并继续提交新事务。下面的代码是我正在尝试做的简化版本：

```
@Stateless
public class MyStatelessBean1 implements MyStatelessLocal1 {

@EJB
private MyStatelessLocal1 myBean1;

@TransationAttribute(TransactionAttributeType.NEVER)
public void processObjects(List<Object> objs) {
    // this method just processes the data; no need for a transaction
    for(Object obj : objs) {
        // If the call to process results in the transaction being rolled back,
        // how do I rollback the transaction and continue to iterate over objs?
        this.myBean1.process(obj);
    }
}

@TransationAttribute(TransactionAttributeType.REQUIRES_NEW)
public void process(Object obj) {
    // do some work with obj that must be in the scope of a transaction
}
} 
```

如果在对 的调用中发生事务回滚`process(Object obj)`，则会引发异常，`objs`并且不会迭代中的其余对象，也不会提交任何更新。如果我想回滚发生错误的事务，但继续迭代`objs`列表，我应该怎么做呢？如果我只是捕获下面代码中的异常，我需要做些什么来确保事务回滚吗？

```
public void processObjects(List<Object> objs) {
    // this method just processes the data; no need for a transaction
    for(Object obj : objs) {
        // If the call to process results in the transaction being rolled back,
        // how do I rollback the transaction and continue to iterate over objs?
        try {
            this.myBean1.process(obj);
        } catch(RuntimeException e) {
            // Do I need to do anything here to clean up the transaction before continuing to iterate over the objs?
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T22:03:46.997

对 processObjects 的调用在（单独的）事务中。您正在捕获所有`RuntimeException`s，让我们将这些异常分为两组。

第一组： `EJBException`或任何其他带有注释的异常`@ApplicationException(rollback=true)`-> 容器将为您回滚该异常。

第二组：所有其他例外。（基本上那些不会被容器自动回滚的异常：（）。->除非您这样做，否则事务不会回滚。

要强制回滚，您总是可以`throw new EJBException`......等等......

另外，请注意，一旦`@ApplicationException(rollback=true)`抛出带有注释的异常，容器将回滚当前事务，如果有一个（EJB-Beans 默认在一个事务中），无论你做什么（例如捕获和忽略）如果Bean 带有注释，`@TransactionManagement(TransactionManagementType.CONTAINER)`在 EJB 中是默认的。

# php - Codeigniter：模型查询不检索任何数据

> ID：12253450
> 
> 赞同：0
> 
> 时间：2012-09-03T20:06:15.843
> 
> 标签：php, codeigniter

在我的数据库中，我的字段值为

1蓝白

2白蓝

3 蓝色

4 白色

对于每个 ID。

我有一个控制器，我在其中声明 $color="White Blue" 并将其传递给模型。在我的模型中，我使用“explode”来分隔这两个词并使用 for-each 来提取。

这是我的模型：

```
 public function test($color){

    $arry = explode(" ", $color); 

    foreach($arry as $colr){
    $this->db->where("tags like '%$colr%' or 
            tags like '%$colr'or 
            tags like '$colr%' ");
            }

    $q=$this->db->get('test');
    return $q;

    } 
```

当我尝试在 localhost 上运行它时，它给了我 Call to a member function result() 错误。我知道这种错误意味着它不会从我的数据库中检索任何数据。当我尝试在查询中出错时，我发现如果在第一个 for-each 之后使用“OR”，它会使用“AND”。您对我如何使这项工作有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:19:55.683

```
public function test($color){

    $arry = explode(" ", $color); 
    foreach($arry as $colr) $this->db->or_where("tags like '%$colr%' "); 
    $q=$this->db->get('test');
    return $q;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:09:01.500

```
tags like '%$colr'or 
```

缺少空格？

```
tags like '%$colr' or 
```

此外，将 $colr 放在 '%' 之间就足够了。不需要其他线路。

所以，这应该可以解决问题：

```
public function test($color){

    $arry = explode(" ", $color); 

    foreach($arry as $colr){
      $this->db->where("tags like '%$colr%' "); 
    }

    $q=$this->db->get('test');
    return $q;

} 
```

# drupal - 带有图像和视频的 Drupal 和 flex 滑块

> ID：12253455
> 
> 赞同：0
> 
> 时间：2012-09-03T20:06:58.743
> 
> 标签：drupal, flexslider

是否可以让 Drupal + Flex 滑块同时处理图像和视频？

使用 Drupal 7 和最新的 Flex 滑块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T18:26:22.603

我现在正在尝试自己解决这个问题。

我目前的解决方案是使用带有“Views Slideshow”和“Flex Slider Views Slideshow”的视图块。我还在使用“客户端自适应图像”和“Omega”主题（加上“FitVid”用于响应式视频……但不确定是否有必要）。

对于幻灯片的图像部分，我的“滑块”内容类型中的每个（未发布的）节点都有一个图像，并且我正在使用正文字段作为标题。为了包含视频，我创建了一个没有图像的新节点，并将 YouTube iFrame 粘贴到正文中。我有一些问题需要解决，但我认为这可能是一个可行的选择，至少对于使用视频共享服务在场外托管的视频而言。

# android - 设置 android:targetSdkVersion > 10 时，Android 上的 HTTP 请求缓慢

> ID：12253457
> 
> 赞同：3
> 
> 时间：2012-09-03T20:07:00.390
> 
> 标签：android, apache-httpclient-4.x

我有一个奇怪的问题。如果不设置`android:targetSdkVersion`我的 http 请求大约需要 1.. 2 秒才能完成，`android:targetSdkVersion="16"`例如设置，请求大约需要 20...30 秒！

我在请求开始时登录，我注意到当我启动时`Activity`，系统一直处于空闲状态，直到发出请求。

所有请求都在`AsyncTask`.

这是代码：

```
BasicHttpParams httpParameters = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(httpParameters, HTTP_POST_CONNECTION_TIMEOUT);
HttpConnectionParams.setSoTimeout(httpParameters, HTTP_POST_SOCKET_CONNECTION_TIMEOUT);
HttpPost httpPost = new HttpPost(url);
httpPost.addHeader("Accept-Encoding", "gzip");
HttpClient httpClient = new DefaultHttpClient(httpParameters);
...
HttpResponse response = httpClient.execute(request); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:08:49.693

一般来说，你不应该`DefaultHttpClient`在 Android 中使用。请尝试使用`AndroidHttpClient`。它包含针对移动设备的多项更改和改进，因此可能会对您有所帮助。

# php - mysql插入不起作用

> ID：12253458
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:07:03.430
> 
> 标签：php, mysql

我知道这是一个非常基本的问题，但我已经被困了 3 个小时，无法弄清楚什么是错的。任何人都可以告诉我这个查询有什么问题吗？

```
insert into user_to_deliverable set d_id = 1 u_id = 4 
```

我有以下错误

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'u_id = 4' at line 1 
```

我根据答案更正了查询，但它仅在 phpmyadmin 上运行，而不是通过代码插入，这是我的代码

```
foreach($_POST['user'] as $k=>$v) {

      echo    $ins_u_deliverable =   "insert into user_to_deliverable set d_id = ".$_POST['dlvrbl_id'].", u_id    =   $v "."<br />";

      mysql_query($ins_u_deliverable);
    } 
```

用户的数组是

```
[user] => Array
    (
        [0] => 4
        [1] => 5
    ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:09:35.077

集合语法通常如下所示：

```
INSERT INTO table SET a=1, b=2, c=3 
```

我猜您缺少逗号，即您的查询应该是：

```
insert into user_to_deliverable set d_id = 1, u_id = 4 
```

如果这不起作用，请确保您指定的所有元素都存在。

编辑：您的语法现在似乎是正确的，为了进行故障排除，我会确保您获得准确的值

```
$_POST['dlvrbl_id'] and $v 
```

以确保您的变量都是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:10:42.300

您正在组合来自两个不同命令 INSERT 和 UPDATE 的语法来创建 SQL 中不存在的新命令。

INSERT 的正确语法：

```
 INSERT INTO user_to_deliverable (d_id, u_id) VALUES (1, 4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:09:02.957

您是否要**插入记录**？

你必须做这样的事情：

```
INSERT INTO user_to_deliverable (d_id, u_id)
VALUES (1, 4) 
```

见[http://www.w3schools.com/sql/sql_insert.asp](http://www.w3schools.com/sql/sql_insert.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:28:36.890

解决了导致问题`<br />`的问题，将其删除并查询一切正常:) 谢谢大家:)

# c# - 在 ac# 项目中使用超过 1 个表单

> ID：12253464
> 
> 赞同：0
> 
> 时间：2012-09-03T20:07:17.040
> 
> 标签：c#, winforms, visual-studio

> **可能重复：**
> [在表单之间传递数据](https://stackoverflow.com/questions/7464625/passing-data-between-forms)

我是 Visual Studio 2012 和 c# 编程的新手，如果我的问题很简单，请原谅。

我的 form1 已经很满了，所以我添加了第二个表单 (form2) 我有一个单击按钮事件将显示它，但我无法在表单之间传输信息。在文件`Form1.cs`中，它似乎不知道 Form2，反之亦然。

```
 private void button4_Click(object sender, EventArgs e)
   {
       OneDimLife.Form2 Form = new OneDimLife.Form2();
       Form.Show();
       //int i, j, N, M;
       //N = panel1.Width; M = panel1.Height;

   } 
```

我可能希望将 form1 上的 panel1 复制到 form2 上的 panel1（甚至可能是原来的三倍）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:26:17.853

不要那样做。拥有一个保存数据的类的通用实例。在每个表格上显示您想要的部分。除了最微不足道的实现之外，您所走的路线总是以混乱的混乱告终。

更好的当然是一个界面，但这离你的未来有点远。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:21:31.763

这是您的第一个表单 ( `SimpleForm`) 上的代码：

```
 Form2 frm = new Form2();
        frm.SourceForm = this;
        frm.ShowDialog(); 
```

第二个（`Form2`）上的代码：

```
public partial class Form2 : Form
{
    public SimpleForm SourceForm { get; set; }

    public Form2()
    {
        InitializeComponent();
    }

    private void Form2_Load(object sender, EventArgs e)
    {
        //i'am changing Title property on first form...
        SourceForm.Text = "Changed title on SourceForm";
    }
} 
```

# c# - 使用 Xml 创建列表

> ID：12253468
> 
> 赞同：1
> 
> 时间：2012-09-03T20:07:44.733
> 
> 标签：c#, xml, xna

我想像这样阅读 XML。

```
<?xml version="1.0" encoding="utf-8" ?>
<parent>
  <path>
    <pathPoints>
     <point>
        2 0
      </point>
      <point>
        2 1
      </point>
        3 1
      <point>
        3 2
      </point>
      <point>
        4 2
      </point>
      <point>
        4 4
      </point>
      <point>
        3 4
      </point>
      <point>
        3 5
      </point>
      <point>
      2 5
      </point>
      <point>
        2 7
      </point>
      <point>
          7 7
      </point>
      <point>
          7 5
      </point>
      <point>
        10 5
      </point>
      <point>
        10 2
      <point>
      </point>
      15 2
      </point>
      <point>
        15 6
      </point>
      <point>
        16 6
      </point>
      <point>
        16 7
      </point>
      <point>
        17 7
      </point>
      <point>
        17 10
      </point>
      <point>
        19 10
      </point>
    </pathPoints>
  </parent>
</path> 
```

现在我正在尝试阅读它：

```
 paths = (from path in doc.Descendants("path")
                 select new AIPath()
                 {
                     waypoints = (from i in path.Descendants("pathPoints")
                     {
                         int j = Convert.ToInt32(i.Element("point").Value),
                     }).ToList();
                 }
                 ).ToList(); 
```

我的 AIPath 包含一个名为 waypoints 的 vector2 列表。

我想知道的是我做错了什么。我想在每次更改它正在查看的路径时创建一个新路径，这看起来不错。不过，我感到困惑的是下一步该做什么。在路点 =（来自路径中的 i 。后代（“路径点”）之后，我期待我必须做点什么，但我对什么一无所知。

任何帮助将不胜感激。

编辑

我忘了添加一两个细节。

```
public class AIPath
{
    //public Vector2
    public List<Vector2> waypoints { get; set; }
    public int linkNumber { get; set; }
    public int[] potentialLinks { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:33:10.137

目前，您的 XML 输出相对难以解析。我会像这样重写你的代码：

```
public sealed class AIPath
{
    // TODO: Consider trying to make this immutable, or
    // at least not exposing the collections so widely. Exposing an array
    // property is almost always a bad idea.
    public List<Vector2> Waypoints { get; set; }
    public int LinkNumber { get; set; }
    public int[] PotentialLinks { get; set; }

    public XElement ToElement()
    {
        return new XElement("path",
            WayPoints.Select(v2 => new XElement("point",
                                       new XAttribute("X", (int) v2.X),
                                       new XAttribute("Y", (int) v2.Y))));
    }

    public static AIPath FromXElement(XElement path)
    {
        return new AIPath
        {
            WayPoints = path.Elements("point")
                            .Select(p => new Vector2((int) p.Attribute("X"),
                                                     (int) p.Attribute("Y")))
                            .ToList();
        };
    }
} 
```

然后：

```
paths = doc.Descendants("path")
           .Select(x => AIPath.FromXElement(x))
           .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T17:03:02.050

Jon Skeet 的回答可能会奏效，但 XNA 框架提供了一种更简单的方法，可以通过内容管道将 XML 读入您的对象。

示例 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<XnaContent>
  <Asset Type="MyDataTypes.CatData[]">
    <Item>
      <Name>Rhys</Name>
      <Weight>17</Weight>
      <Lives>9</Lives>
    </Item>
    <Item>
      <Name>Boo</Name>
      <Weight>11</Weight>
      <Lives>5</Lives>
    </Item>
  </Asset>
</XnaContent> 
```

示例类：

```
namespace MyDataTypes
{
    public class CatData
    {
        public string Name;
        public float Weight;
        public int Lives;
    }
} 
```

假设您已正确标记资产类型元素，则内容管道的内置 XML 导入器和处理器将在构建 .xnb 文件时将 XML 元素与正确命名的类成员相关联。

请参阅：http: [//msdn.microsoft.com/en-us/library/ff604981.aspx](http://msdn.microsoft.com/en-us/library/ff604981.aspx)

# scala - 测试电梯休息服务的最佳方法是什么？

> ID：12253470
> 
> 赞同：1
> 
> 时间：2012-09-03T20:08:25.930
> 
> 标签：scala, lift

我看到一个可以模拟[HTTP 请求](https://www.assembla.com/spaces/liftweb/wiki/Mocking_HTTP_Requests)

最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T02:28:03.487

那篇 wiki 文章显示了一种对 Lift 应用程序进行单元测试的方法，但它取决于 specs1，您仍然可以将它的一部分与 specs2 一起使用，但是更好的`withSFor`, etc 调用不起作用。

[这里](https://gist.github.com/2235088)有 specs2 的版本。

还有一个版本将很快成为 Lift 本身的一部分。

从我发布的要点来看，最后看看如何测试 REST 端点的示例。

[更新] 而且我倾向于尽可能地将我的逻辑移出 REST 对象，因此我可以针对简单对象编写大量单元测试，并传递他们期望的信息。

诸如验证之类的事情会进入这些单独的对象中。

我最喜欢的测试工具是 specs2 和 scalacheck

希望有所帮助。

# android - 适用于 Android 和 Mysql 的最佳 Web 服务

> ID：12253473
> 
> 赞同：1
> 
> 时间：2012-09-03T20:08:31.313
> 
> 标签：android, json, web-services

我正在开发 android 应用程序，并且需要一些 web 服务来与我的远程 mysql 数据库进行通信。我做了同样的工作，我用 php 创建了 json webservice。但这对我来说似乎很复杂。因为我想在 webservice 中使用方法，比如 .net webservice (asmx)。有没有解决这个问题的方法。我的服务器运行 mysql 和 php。Json 是这个问题的最佳解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T14:09:34.580

看看这个[链接](http://www.codeproject.com/Articles/267023/Send-and-receive-json-between-android-and-php)。它提供了使用 php 向 MySql 数据库发送和接收数据的所有步骤。当我开发 GPS 追踪器应用程序时，它帮助了我很多。试试看！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:28:50.427

如果您的应用程序使用文本数据，那么 JSON 是一个很好的解决方案，因为 android SDK 对它以及 PHP 都提供了很好的支持。由于 PHP 与 MySQL 的强大集成，您可以轻松地将 PHP 和 MySQL 一起使用。

# android - 在 Android 进程之间获取数据

> ID：12253477
> 
> 赞同：0
> 
> 时间：2012-09-03T20:08:46.727
> 
> 标签：android, process, shared

在我正在设计的应用程序中，我有一个连接到通信总线的后端服务，它收集大量数据并与远程设备通信。我在另一个 APK 和进程中有一个前端 (UI)。

我需要在这两个进程之间以非常高的速度（微秒）流动大量数据、通信事件和用户事件。下面是一个示例：进程 A 可能会通过通信总线接收组成位图图像的数据块。由于这个过程不在主 UI 线程中，我不能使用 Canvas 和 Bitmap 类来创建实际的位图，我所能做的就是存储数据。进程 B（UI 线程）需要这些数据来实际创建和显示位图图像。将数据从进程 B 传递到进程 A 需要非常快速地进行 - 希望就像从一个方法调用另一个方法在同一进程中发生的时间一样。

作为 Android 的新手，我正在为这个概念而苦苦挣扎。我看过 AIDL，它看起来很有希望，但我还不知道。

有没有人对如何以相当高的速度在两个进程之间来回共享数据有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:13:56.990

你是对的，Android 中进程之间通信的最佳方式是 AIDL。

我能想象到的唯一可能提高性能的方法是在进程之间共享内存。但是，我认为您需要为此降低级别。例如，您可以查看这篇文章：[http ://www.androidenea.com/2010/03/share-memory-using-ashmem-and-binder-in.html](http://www.androidenea.com/2010/03/share-memory-using-ashmem-and-binder-in.html)

但是，在大多数情况下，AIDL 应该很快。

祝你好运

# ruby-on-rails-3.2 - 无法在 Ruby on Rails 中将变量写入会话

> ID：12253478
> 
> 赞同：2
> 
> 时间：2012-09-03T20:08:48.723
> 
> 标签：ruby-on-rails-3.2

这是我用来避免硬编码会话变量的一些代码。

```
#application_controller
  def redirect_to_new_order?
    session[:redirect_to_new_order]
  end

  def redirect_to_new_order=(value)
    session[:redirect_to_new_order] = value
  end

#another_controller
#.............
def some_action
   redirect_to_new_order = true
   #viewed by debugger
   # redirect_to_new_order? is equal to nil 
   # session[:redirect_to_new_order] is equal to nil as well
end 
```

正如你所看到的，并且`redirect_to_new_order?`出于某种原因。`session[:redirect_to_new_order]``nil`

为什么会这样？

更新：这是类似于上面给出的代码。但它确实调用了一个方法并且不创建局部变量。为什么？

```
class SomeClass

    def initialize
        @some_var = "999"
    end
    def var1
        @some_var
    end

    def var1=(value)
        @some_var=value
    end

    def method1
      var1 = 111
      puts var1
      puts @some_var  
    end
end

a = SomeClass.new
a.method1 # prints 111 and 999 but why? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:06:34.277

原因是您没有调用该`redirect_to_new_order=`方法。`redirect_to_new_order`相反，您正在设置一个值为 true的局部变量。作为健全性检查，`raise "BOOM"`在分配方法中添加一行，您会看到该方法没有被调用。

您需要一个显式接收器，否则您正在控制器中设置一个局部变量。

`self.redirect_to_new_order = true`

会成功的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T04:02:01.193

因为不清楚是要设置局部变量还是调用setter方法。在这种情况下，Ruby 选择设置一个局部变量。看到这两个答案：

*   [https://stackoverflow.com/a/5183917/84631](https://stackoverflow.com/a/5183917/84631)
*   [https://stackoverflow.com/a/44779/84631](https://stackoverflow.com/a/44779/84631)

# video-streaming - 如何使用 Java 在 NAT 后面执行 P2P 流视频

> ID：12253487
> 
> 赞同：2
> 
> 时间：2012-09-03T20:09:28.297
> 
> 标签：video-streaming, p2p

我们有一个使用 XMPP 在两个客户端之间进行通信的应用程序；目标系统和智能手机（Android 或 iPhone）。两个客户端在 XMPP 服务器上使用相同的帐户来查找和发送消息给对方。该架构运行良好，但现在我们需要设置流式视频（目标到手机）。使用 XMPP 速度太慢，因此需要点对点 (P2P) 解决方案。由于两个客户端（目标和电话）都位于本地网络路由器之后，因此该解决方案需要处理 NAT/防火墙穿越，因此需要使用 TCP 来确保数据包按顺序传递。

使用另一台公共服务器，我们可以获得客户端路由器的全局 IP 地址和端口。此信息使用 XMPP 消息在客户端之间进行通信。天真的方法是使用用于访问公共服务器的相同端口在目标客户端上设置服务器套接字。因此，电话客户端被设置为使用目标客户端的全局地址和端口与目标客户端建立连接。

永远不会建立连接。谁能告诉我这种方法的缺陷或建议一种不需要专用服务器的替代方法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:12:45.287

你可以试试[Ice4j](http://code.google.com/p/ice4j/)。它几乎支持您正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-23T04:22:24.150

[Ice4J 教程](http://stellarbuild.com/blog/article/ice4j-networking-tutorial-part-1)，但在新位置获取 Ice4J：[https ://github.com/jitsi/ice4j](https://github.com/jitsi/ice4j)

这个包几乎可以让你做你想做的事。

# c - 基于宏参数的预编译时间决策

> ID：12253490
> 
> 赞同：1
> 
> 时间：2012-09-03T20:09:38.900
> 
> 标签：c, macros, c-preprocessor

我得到了将事件发布到某个事件队列的宏。

```
POST_(myTarget, event) 
```

事件可以直接发布到本地队列，也可以序列化并发布到 I2C 服务的事件队列，该 I2C 服务将事件发送到另一个微控制器。接收服务是本地服务还是远程服务的定义如下：

```
#define myTarget_REMOTE
#define anotherTarget_LOCAL 
```

我想做的是这样的（这当然是不允许的）：

```
#define POST(target, e) \
    #ifdef target##_REMOTE \
        /* create a i2c request-event with serialized(e) 
           as parameter and post to I2c-Manager */
    #else \
        /* post directly */
        POST_(target, event) \
    #endif 
```

所以，所有信息在编译时都在那里，但我不知道如何告诉预处理器该做什么。

*   我可以根据其本地/远程定义为每个目标创建两个宏，但这会很麻烦。
*   我可以在运行时进行测试，但这也是一个悲伤的故事。

编辑：

程序看起来更清晰的示例：

```
#define target1_LOCAL
#define target2_REMOTE

POST(target1, e) ==preprocessor==> POST_(target1, e)

POST(target2, e) ==preprocessor==> 
    do { \
        req = createI2cRequest(serialize(e)); \
        POST_(I2cManager, req); \
    }while(0) 
```

所以，在我刚刚使用的程序`POST(target, event)`中，目标的位置是完全透明的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:10:36.747

宏内的条件编程有点棘手，但可以使用 C99。在[P99](http://p99.gforge.inria.fr)中，我编写了一系列条件语句，在这里可能会有所帮助。

```
#define myTarget_TYPE 0
#define anotherTarget_TYPE 1

#define POST(target, e)                                   \
    P99_IF_EQ_1(P99_PASTE2(target, _TYPE))                \
      (                                                   \
        /* create a i2c request-event with serialized(e)  \
           as parameter and post to I2c-Manager */        \
      )(                                                  \
        /* post directly */                               \
        POST_(target, event)                              \
      ) 
```

诀窍是您应该始终为每个目标拥有一个宏。对于那些你想要第一个替代方案的人来说，你可以使用 token `1`。你甚至可以省略声明其他人是 to `0`。

一般形式类似于

```
P99_IF_COND( /* expression(s) for condition */ )(/* case true */)(/* case false*/) 
```

您可以在上面做很多事情`COND`，测试与特定标记的相等性、十进制数的相等性、参数列表的空性......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T08:40:59.753

所以我终于想通了。诀窍是使用预处理器为编译器提供所有需要的信息，并依靠编译器来优化 if/else 。

```
#define REMOTE  1
#define LOCAL   0

#define TARGET0_LOCATION REMOTE
#define TARGET1_LOCATION LOCAL

#define TEST(target) do { \
        if(target##_LOCATION == REMOTE) printf("REMOTE\n"); \
        else printf("LOCAL\n"); \
    }while(0)

main(){
    TEST(TARGET0);
    TEST(TARGET1);
} 
```

输出：

```
REMOTE
LOCAL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:23:22.037

拉出一些定义，例如：-

```
#ifdef I2C
#define TARGETFUNC _REMOTE
#else
#define TARGETFUNC _LOCAL
#endif
#define POST(target, e) POST(target##TARGETFUNC,e) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:42:13.350

```
#define post_myTarget(x)       remote_post(x)
#define post_anotherTarget(x)  local_post(x)

#define POST(target, e) post_##target(e) 
```

# javascript - 判断元素是否存在

> ID：12253491
> 
> 赞同：1
> 
> 时间：2012-09-03T20:09:44.163
> 
> 标签：javascript, jquery, html, jquery-mobile

> **可能重复：**
> [使用 jQuery 检查元素是否在 DOM 中？](https://stackoverflow.com/questions/7119308/check-that-element-is-in-dom-or-not-with-jquery)

所以我有一个函数，用于向上导航两个级别`.parent().parent()`，然后它移动到文档中的下一个节点，`.next()`最后从嵌套的 a 中获取我需要的属性`.find('a').attr('data-record-id')`，这一切都很好，但现在我需要查找`<a></a>`元素是否存在，如果不存在，我需要隐藏与之相关的标题。布局的模型是这样的：

```
<html>
    <head><title>My Title</title></head>
    <body>
        <h4 class="dragable">2012-08-20<span style='display: none'><a class='delete-btn'></a></span></h4>
        <ul>
           <li>
             <div>
                 <div>
                    <a data-record-id="9">97 bpm</a>
                 </div>
              </div>
           </li>
         </ul>
      </body>
  </html> 
```

因此，鉴于该布局，确定`<a></a>`元素是否存在的最佳方法是什么，如果不是，则隐藏/删除与其相关的 h4 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:12:34.177

利用`length`

```
if($next.find('a').length > 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:13:14.460

`$(selector).find('a')`正在返回一个数组，无论 a 是否存在。您可以轻松地使用`$(select).find('a').length (or .size() )`. 这有什么帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:12:07.443

您可以使用该`length`属性来确定元素是否存在：

```
if ($(body).find('a[data-record-id]').length) {
    // element exists
} else {
    // element does not exist
} 
```

# scala - Scala 标准库对 toString() 和 hashCode() 的使用

> ID：12253493
> 
> 赞同：1
> 
> 时间：2012-09-03T20:09:50.913
> 
> 标签：scala, consistency

可以安全地假设：

*因为由于与 Java 的互操作性，scala.AnyRef用一对括号*定义了 toString() 和 hashCode() （正如 Martin 在：[https](https://groups.google.com/forum/#!topic/scala-language/RlV9O1RDmis) ://groups.google.com/forum/#!topic/scala-language/RlV9O1RDmis 中所建议的那样),

*Scala 标准库中作为 scala.AnyRef 后代的*每个类都**使用一对括号*定义 toString() 和 hashCode() ？*

 *换句话说，我可以相信标准库的开发人员在使用 toString() 和 hashCode() 作为 AnyRef 的后代类方面是一致的吗？

编辑 - 将问题更改为仅询问 AnyRef 的后代类

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:14:40.607

由于您只需要一个反例，因此[您可以](https://github.com/scala/scala/blob/v2.9.2/src/library/scala/Int.scala#L178)：

```
object Int extends AnyValCompanion {
  ...
  override def toString = "object scala.Int"
} 
```

但是`"toString[^(]"`在标准库源代码上的 grepping 会出现数百个其他的。

请注意，使用无参数列表覆盖具有空参数列表的方法的能力[已明确添加](https://stackoverflow.com/a/12232273/334519)到 Scala 2.0 中的 Scala 语言规范中。*

# android - 在android中将数据从文件插入到sqlite

> ID：12253496
> 
> 赞同：0
> 
> 时间：2012-09-03T20:09:51.213
> 
> 标签：android, performance

我有包含插入语句的文件，例如

```
INSERT INTO MyTable1 VALUES(31402,33,1332602460,0.72,'Description');

INSERT INTO MyTable2 VALUES(31402,33,1332602460,0.72,'Description', 'Name'); 
```

文件包含 44667 行。

将此文件插入android数据库的最佳方法是什么？

逐行阅读并插入或其他内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:14:57.987

1.  禁用索引。如果你不知道怎么做，谷歌它是另一个问题
2.  插入所有行（执行您的 SQL）
3.  启用索引

插入没有索引的表总是比有索引更快。

# php - 主键数据不连续时随机选择一行

> ID：12253497
> 
> 赞同：2
> 
> 时间：2012-09-03T20:09:53.660
> 
> 标签：php, mysql

[根据此链接， ORDER BY RAND() 是无能的](http://akinas.com/pages/en/blog/mysql_random_row/)

`Id`考虑到这一点，如果我的（主键）不连续（AKA，我不能这样做，我该如何优化对 mysql 的随机行查询`rand(1, max())`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T21:10:11.800

让表随机排序的最佳方法是添加一个额外的字段并使用任意 md5 散列填充它，然后在该字段上创建一个索引。

这些散列可以是任何你喜欢的散列，只要它们都不同。我建议散列主键 ID 字段，加上任意盐字符串。

```
UPDATE myTable SET rand_hash = md5(concat(id,'anything here')) 
```

有了这些，你的表就会有一个几乎完全随机的排序顺序。您可以通过创建另一个任意 md5 哈希并查询最接近该值的记录来在随机点查询表。MD5 哈希是随机分布的，因此每条记录都有相同的机会被选中。像这样的东西可以解决问题：

```
SELECT * FROM myTable WHERE rand_hash >= md5(now()) LIMIT 1 
```

最好的一点是，这将在索引上进行查询，因此无论记录在表中的哪个位置，都会非常快。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:29:03.520

您可以使用 mysql_fetch_array() 随机次数

```
$query=sprintf("SELECT * FROM acb");
$check=mysql_query($query);
for($i=1,$i<=rand($min_id,$max_id,$i++)
$row=mysql_fetch_array($check, MYSQL_ASSOC); 
```

现在 $row 包含一个随机行 注意：这种方法对我来说似乎非常低效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:19:29.153

您可以 ORDER BY id ASC，然后选择 rand() 行或下一个更高的行：

```
...
WHERE id >= rand(1, $max_id)
ORDER BY id ASC
LIMIT 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:42:44.517

您可以`mysql_data_seek(resource $result, int $row_number)`改为在 php 中使用。

```
$result = mysql_query( 'SELECT * FROM `table`' );
mysql_data_seek( $result , mt_rand( 0 , mysql_num_rows( $result ) ) ); 
```

但是`mysql_data_seek`并且`mysql_num_rows`不适用于无缓冲的查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T22:42:32.203

我尝试了以下查询。它比 ORDER BY RAND () 更快：

```
SELECT * FROM table WHERE (id >= RAND() * (SELECT MAX(id) FROM table) LIMIT 1; 
```

如果“id”列是 auto_increment，我测试这个查询比以前快得多：

```
SELECT * FROM table WHERE (id >= RAND() * (SELECT id FROM table ORDER BY id DESC LIMIT 1)) LIMIT 1; 
```

# postgresql - Placeholder templates with PostgreSQL

> ID：12253501
> 
> 赞同：2
> 
> 时间：2012-09-03T20:10:02.350
> 
> 标签：postgresql, formatting

I need a function like

```
SELECT vformat('Hello %%! Bye %%...', array['John','Maria'], '%%');
-- 'Hello John! Bye Maria...' 
```

Supplying a string with placeholders (a template), and corresponding inputs into a vector, it returns a text. The "placeholder mark" is a free string.

I can't use the pg9.1 format (like sprintf) function, because it does not allow other mark than '%' (see ex. [Python formatter](http://docs.python.org/library/string.html#formatstrings)) and not allow array parameter (see ex. [vsprintf](http://www.php.net/manual/en/function.vsprintf.php)). The SIMPLEST solution with PostgreSQL 9.0 (I think 8.4+) is

```
CREATE FUNCTION array_zipper_string(anyarray,anyarray) RETURNS text AS $$ 
  -- use with bigger array at left
  SELECT string_agg(t.val||coalesce($2[t.idx],''),'')  
  FROM  (SELECT generate_subscripts($1, 1) AS idx, unnest($1) AS val) AS t;
$$ LANGUAGE SQL IMMUTABLE;

CREATE FUNCTION tpl_positional(text,anyarray,varchar DEFAULT '%%') 
RETURNS text AS $$ 
  SELECT array_zipper_string(string_to_array($1,$3),$2);
$$ LANGUAGE SQL IMMUTABLE;
CREATE FUNCTION tpl_positional(
   text, text, varchar DEFAULT '%%',varchar DEFAULT '|' 
) RETURNS text AS $$ 
  SELECT tpl_positional($1,string_to_array($2,$4),$3);
$$ LANGUAGE SQL IMMUTABLE;

-- TESTING:
SELECT tpl_positional('Hello %%! Bye %%...', 'John|Maria');
SELECT tpl_positional('Hello %%!',array['John']); 
```

There are well-knowed (open source) *function* or *library* for do the same?

PS: that do this and also something more (!) ... My wishes list:

*   open source from a standard library
*   option to indexable placeholders, 'Hello %%{1}! Bye %%{2}...'
*   option to use formatters, 'There are %%2d monkeys.' or 'There are %%{1|2d} monkeys.';

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-04-10T16:32:06.157

PostgreSQL FORMAT() function formats arguments based on a format string.

If you have worked with C programming language, you will find that the FORMAT() function is similar to the sprintf() function.

```
SELECT FORMAT('Hello, %s','PostgreSQL');

      format
-------------------
 Hello, PostgreSQL
(1 row) 
```

For details, see [http://www.postgresqltutorial.com/postgresql-format/](http://www.postgresqltutorial.com/postgresql-format/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T22:55:32.523

If Python's formatting function does what you need, wrap it via PL/Python, and use that. You'll need to:

```
CREATE LANGUAGE plpythonu; 
```

... which may require you to install an additional package containing the python language support or re-compile using `--with-python`, depending on how you installed Pg or the packages you're using. For me using the Fedora 17 packages it was `yum install postgresql-plpython`.

You'll need a signature like:

```
CREATE OR REPLACE FUNCTION my_format(formatstr text, placeholder text, args VARIADIC text) RETURNS text LANGUAGE 'plpythonu' IMMUTABLE AS $$
 .... body here ....
 $$; 
```

Note the usage `plpython`**u**. Here **u** means "untrusted", ie "has no security model". Code running in untrusted languages can't be restricted, so the server only permits the superuser to create functions in such languages. They must be written so that they can't be tricked into doing things other than the author intended if the database is exposed to less-trusted users.

Unfortunately the procedural languages' handling of arrays was, last I checked, less than wonderful. See the depesz article at the bottom of this post, and its comments. It's workable, just clumsier than would be nice.

If Python's format functionality *doesn't* do what you want, consider Perl. PL/Perl is very popular, partly because unlike Python it has a security model and there's a "trusted" version of `plperl`. I'll be very surprised if you can't find a suitable CPAN module to do what you want. The function signature would be much the same, just with `plperl`.

See this [excellent-as-usual depesz article on plperl and sprintf](http://www.depesz.com/2008/08/01/writing-sprintf-and-overcoming-limitations-in-plperl/).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T05:14:33.227

Other possibility is using *orafce* [http://postgres.cz/wiki/Oracle_functionality_%28en%29](http://postgres.cz/wiki/Oracle_functionality_%28en%29) - functions from schema ''PLVsubst'' does exactly what you want. Orafce is in redhat, centos repositories, but it is not enabled on any hosting usually.

# java - 从 processing 到 processing.js 的端口是否支持 Java 集合？

> ID：12253503
> 
> 赞同：1
> 
> 时间：2012-09-03T20:10:13.760
> 
> 标签：java, processing, processing.js

文档中不清楚这一点：从 processing 到 processing.js 的端口是否支持 Java 集合？我有一些使用集合和映射的处理代码，如果可能的话，我希望避免将其重构为数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T02:04:06.210

由于 Java 集合（在大多数情况下）在 JavaScript 中没有直接等价物，因此在 Processing.js 中支持它们需要大量工作。

ArrayList 和 HashMap 最有可能得到支持，因为它们最接近原生 JavaScript 中的任何实现，即[Arrays](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)和[Objects](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object)。我看到[Processing.js 参考](http://processingjs.org/reference/)说他们“正在努力实现 100% 兼容的 API，允许所有本机 Java 代码在 Javascript 中运行”，但我认为这是指 Processing 及其核心类使用的所有本机 Java 代码. 尝试移植[所有原生 Java](http://docs.oracle.com/javase/6/docs/api/)以在 JavaScript 中运行肯定超出了 Processing.js 项目的范围。

也就是说，在 JavaScript 中强制执行 Set 和 Map 等 Java 集合接口的规则在技术上*是*可行的，因此它并没有超出未来的可能性范围......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:18:56.067

根据[参考资料](http://processingjs.org/reference/)`ArrayList`，仅提供和的等价物`HashMap`。

# javascript - chrome.socket 如何用于广播或多播？

> ID：12253507
> 
> 赞同：9
> 
> 时间：2012-09-03T20:10:37.567
> 
> 标签：javascript, google-chrome-extension, broadcast, multicast, multiplayer

我想创建一个仅用于 LAN 的 Chrome 打包应用程序，其中一个实例用作服务器（会话主机），其他实例必须发现服务器并加入会话。这可以通过[chrome.socket](http://developer.chrome.com/beta/apps/socket.html)实现吗？

我已经设置了这样的服务器：

```
var socket = chrome.socket || chrome.experimental.socket;
socket.create('udp', {}, function(createInfo) {
    var publish_socket = createInfo.socketId;
    socket.bind(publish_socket, '225.0.0.42', 42424, function (result) {
        if (result < 0) console.error(result); // this works fine
        socket.recvFrom(publish_socket, null, function(recvFromInfo) {
            console.log(recvFromInfo); // UNABLE TO MAKE THIS HAPPEN
        });
    });
    // Chrome won't let me listen for app window closing
    var cleanup_timer;
    cleanup_timer = setInterval(function(){
            if (requesting_window.closed) {
                socket.destroy(publish_socket);
                clearInterval(cleanup_timer);
            }
        },
        5000
    );
}); 
```

套接字已绑定，我可以在以下位置看到它`ss -ua`：

```
State      Recv-Q Send-Q      Local Address:Port          Peer Address:Port
UNCONN     0      0           225.0.0.42:42424            *:* 
```

但是服务器似乎从来没有收到任何数据。我尝试使用`nc -uv 225.0.0.42 42424`chrome.socket API 发送一些数据，但没有成功：

```
socket.create('udp', {}, function(socketInfo) {
   var socketId = socketInfo.socketId;
   socket.sendTo(socketId, str2ab("discovering"), '225.0.0.42', 42424, function(writeInfo) {
       if (writeInfo.bytesWritten < 0) console.error(writeInfo);
   });
}); 
```

这会导致客户端出现错误代码`-15`，而服务器端则没有。

我怀疑应该在某处设置了多播标志，但我找不到它。

我正在使用 Chrome 版本 23.0.1246.0 开发

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T07:43:12.467

要发送多播数据包，您需要做的就是绑定到本地接口（`0.0.0.0`使用随机端口，正如您所发现的那样），然后将数据包寻址到正确的组/端口（这就是`sendTo`将要做的）。

要接收多播数据，您需要绑定到正确的端口（打开`0.0.0.0`很好），然后加入正确的多播组。你可以用 来做第一个位`socket.bind`，但第二个通常用`setsockopt`和标志来做`IP_ADD_MEMBERSHIP`。不幸的是，Chrome 套接字 API 不提供对此的访问。

当您进行此调用时，系统会向网络发送 IGMP，指示路由器将特定组的多播数据包转发到您的接口，绑定到正确的端口就足以接收它们。您通常还可以指示操作系统使用环回接口复制多播数据包（因此您可以在同一台机器上使用多播）。如果机器直接连接在一起，您可能会发现您现有的代码可以工作，但如果您通过交换机连接（因为它会丢弃您尚未订阅的数据包），而不是如果您在同一台机器（因为数据包不通过环回接口路由）。

对此的传统解决方案是自己创建一个 IGMP 数据包，这将允许多播通过交换机工作，而不是在本地机器上工作。不幸的是，这需要访问以发送原始 IP 数据包（不是 TCP 或 UDP）并且`chrome.socket`不提供。

这意味着如果没有另一个程序代表您加入多播组，您将无法接收任何内容。

# sqlite - Windows7中数据库的Sqlite3位置

> ID：12253518
> 
> 赞同：0
> 
> 时间：2012-09-03T20:11:57.553
> 
> 标签：sqlite

在 Sqlite3 的 Windows 中安装 .exe 文件（或者更确切地说是缺少安装）让我想知道数据库实际存储在哪里以供以后使用？它不会将任何文件输出到硬盘驱动器。

在使用 GUI 时，它允许您将数据库保存为文件，然后在 Sqlite3 的命令终端中打开它。但令我困惑的是，Sqlite3 本身似乎并没有以同样的方式存储它的数据。那么数据在哪里呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:31:28.523

您必须将数据库文件指定为 sqlite 二进制文件的参数。如果不这样做，数据库将在内存中创建。

请参阅有关如何使用[命令行 Shell](https://www.sqlite.org/sqlite.html)的文档。

**编辑：**

```
> sqlite3.exe database-file
sqlite> create table t (f integer);
sqlite> .exit
> dir database-file 
```

# php - 将附加数据传递到 Zend_Paginator 元素

> ID：12253520
> 
> 赞同：0
> 
> 时间：2012-09-03T20:12:02.597
> 
> 标签：php, zend-framework, zend-paginator

我有`Problems`模型，每个问题都与`Category`模型有关系，所以每个问题都有一个类别。这是我的代码，它很好地将问题和类别名称返回到我的视图中。

```
public function getPaginatorAdapter($category = null) {
        $select = $this->select();
        $select->setIntegrityCheck(false);
        $select->from(array('p' => 'problems', 'c' => 'categories'));
        $select->join(array('c' => 'categories'), 'c.id = p.category', array('c.category AS category_name'));
        $select->order('p.created DESC');
        if($category !== null) {
            $select->where('p.category = ?', $category);
        }

        return $adapter = new Zend_Paginator_Adapter_DbTableSelect($select); 
```

然后我创建了额外的`Tags`表和`ProblemsTags`多对多表，所以每个问题都可以有很多标签。我的问题是如何将带有问题相关标签的数组从 ProblemsTags 表传递给分页器的每个元素？

在普通的 PHP 中，我只会遍历所有问题，并且对于每个问题，我都会对标签进行数据库查询。如何在 Zend Framework 中实现这一点？

# wordpress - 站点根目录上的 Wordpress 重定向循环。Nginx 代理阿帕奇

> ID：12253539
> 
> 赞同：1
> 
> 时间：2012-09-03T20:13:47.907
> 
> 标签：wordpress, apache, web-applications, nginx

我将 Nginx 设置为 apache2 的代理，为 Wordpress 安装服务。问题是在根 url appsrd.devmbs.com 上我得到了一个重定向循环。当我点击服务器时，我在日志中看到了 12-15 次以下内容。

```
127.0.0.1 - - [03/Sep/2012:12:29:25 +0000] "GET /index.php HTTP/1.0" 301 529 "http://appsrd.devmbs.com/wp-admin/options-general.php" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_0) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1" 
```

但是 /wp-admin 运行良好。没有重定向问题。我尝试删除数据库，虽然 db 不可用，但根显示了错误建立数据库连接的消息，这很好，因为这是预期的行为，但没有重定向问题。然后我再次创建了数据库并运行了 wordpress 设置，当一切都完成后，重定向问题又回来了。

Beloe 我的 nginx 服务器配置：

```
server {
        listen       80 default_server;
        server_name  appsrd.devmbs.com;
        root /home/ubuntu/projecs/APPS-RD;
        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   /home/ubuntu/projects/APPS-RD;
            index  index.html index.htm index.php;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        location ~ \.php$ {
        proxy_pass   http://127.0.0.1:3000;
        proxy_buffering on;
        proxy_buffers 12 12k;
        proxy_set_header Host $host;
        }
} 
```

网址是appsrd.devmbs.com，appsrd.devmbs.com/wp-admin 工作正常。

任何人都知道可能会发生什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-30T12:53:57.027

对于任何可能遇到此问题的未来人......</p>

1.  走这条路并不是最实际的方法。
2.  我决心让它发挥作用。

出于我实验的目的，我希望 Nginx 显示任何和所有现有的非 PHP 文件，并将 PHP 文件和动态 URL 代理到 Apache 以便 WordPress 完成它的工作。我还希望 WordPress 能够使用普通的 .htaccess 文件。

Luis 最初发布的初始代码的问题在于 Nginx 明确声明使用 index.php，因为它是 WordPress 环境中提供的唯一索引。结果是，当您转到“domain.com/”时，Nginx 会将其发送给 Apache，看起来与“domain.com/index.php”一模一样。当 WordPress 收到“domain.com/index.php”时，它会自动缩短并将您重定向到“domain.com/”；因此你最终得到了那个循环。

适用于 WordPress 环境的最佳解决方法（对于确定的）是将任何目录也发送到 WordPress。此设置的缺点是它将忽略任何不是 index.php 的索引。

```
server {
        listen       80;
    server_name  domain.com;
    root   /path/to/web/root/;

    # Proxy anything that isn't a file.
    location / {
        try_files $uri @apache;
    }

    # Proxy directories (This fixes the loop)
    # This will kill any other indexes like index.html if they're not explicitly used in the URL.
    location ~[^?]*/$ {
        include proxy_apache;
    }

    # Proxy any .php file.
    location ~ \.php$ {
        include proxy_apache;
    }

        # Proxy to apache, used by location / {...}
    location @apache {
        include proxy_apache;
    }

    # this will prevent files like .htaccess .htpassword .secret etc from being served
    # You can remove the log directives if you wish to
    # log any attempts at a client trying to access a hidden file
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }   
} 
```

如果您注意到上面多次包含的名为 *proxy_apache* 的文件的内容，

```
proxy_set_header X-Real-IP  $remote_addr;
proxy_set_header X-Forwarded-For $remote_addr;
proxy_set_header Host $host;
proxy_pass http://127.0.0.1:8080; 
```

同样，不一定是最实用的解决方案，但它确实具有以下优点，

1.  使用 Nginx 显示任何非 PHP 文件，而不必在正则表达式中定义显式静态文件列表。
2.  使用 WordPress 钟爱的 .htaccess 文件；尽管您不太可能在初始设置后更改 .htaccess 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T22:39:50.463

使用 Nginx + php-fpm 时我放弃了 Nginx + Apache

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-10T22:24:51.830

我想要卢卡斯做的同样的事情，我得到了它的工作。这是我的一个基本例子。

```
# A basic configuration with reverse proxy to apache2

server {
  listen 80;

  server_name someurl.com www.someurl.com;

  root /var/www/someurl.com/html/;

  index index.php index.html index.html;

  access_log /var/log/nginx/someurl.com.access.log;
  error_log /var/log/nginx/someurl.com.error.log;

  # send anything with .php in it to apache
  location ~* \.php$ {
    try_files /dev/null @proxy;
  }

  # for everything else, 
  location / {
    try_files $uri $uri/ @proxy;
    error_page 404 = @proxy;
  }

  # Deny access to all dotfiles
  location ~ /\. {
    deny all;
  }

  # Named location for reverse proxy
  location @proxy {
    if ( $uri = /index.php ) {
      rewrite /index.php / break;
    }
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header Host $host;
    proxy_pass http://127.0.0.1:8080;
  }
}

# need to add https support 
```

关键是我的@proxy 位置中的 if 语句。我检查 $uri 并使用中断标志将请求 URI 重写回 / 。这避免了重定向循环。

奇怪的是问题只发生在根索引上，而不是子目录索引上。感谢您对我的配置提供任何反馈。它可能有我尚未发现的问题，但到目前为止，它为我提供了 WordPress 部署所需的东西。

GL！

# gwt - GWT celltable：键盘导航无法访问的列

> ID：12253543
> 
> 赞同：2
> 
> 时间：2012-09-03T20:14:11.557
> 
> 标签：gwt, celltable, gwt-celltable

在 CellTable 的展示示例中：http://gwt.google.com/samples/Showcase/Showcase.html#! [CwCellTable](http://gwt.google.com/samples/Showcase/Showcase.html#!CwCellTable)

可以单击（最右侧）地址列，该行变为黄色，单元格为灰色框。通过按 UP 和 DOWN 键，我可以选择不同的行，并且地址被框起来。通过点击 LEFT 和 RIGHT 键，可以在不同列的灰色单元格中进行构图。

但是... 使用 LEFT 或 RIGHT 键离开地址栏后，无法返回。跳过地址列，可能是因为它不可编辑或其他原因。

有没有办法让键盘可以访问不可编辑的列？我知道这可能没有用，但我有一张类似的桌子，我觉得这种行为很烦人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:33:54.917

查看 的代码[`AbstractCellTable`](http://code.google.com/p/google-web-toolkit/source/browse/trunk/user/src/com/google/gwt/user/cellview/client/AbstractCellTable.java)，如果列是“交互式”的，即如果`Cell`列*消耗*一些事件，它只会在处理左/右键时将焦点移动到列。在展示中，地址列使用`TextCell`不处理任何事件的 a，因此无法使用键盘将焦点移动到该列。

# javascript - 从异步请求中显示 div 内的推文

> ID：12253544
> 
> 赞同：0
> 
> 时间：2012-09-03T20:14:16.080
> 
> 标签：javascript

在从雅虎 placemaker 循环推文后，我试图将推文加载到 div 中。他们正在加载 div 但他们显示的信息是 placemaker 的最后结果。

这是代码..

```
 function getLocation(user, date, profile_img, text,url) {
            var templates = [];
            templates[0] = '<div><div></div><h2 class="firstHeading">'+user+'</h2><div>'+text+'</div><div><p><a href="' + url + '"target="_blank">'+url+'</a></p></div><p>Date Posted- '+date+'</p></div>';
            templates[1] = '<table width="320" border="0"><tr><td class="user"  colspan="2" rowspan="1">'+user+'</td></tr><tr><td width="45"><a href="'+profile_img+'"><img src="'+profile_img+'" width="55" height="50"/></a></td><td width="186">'+text+'<p><a href="' + url + '"target="_blank">'+url+'</a></p></td></tr></table><hr>';
            templates[2] = '<div><div></div><h2 class="firstHeading">'+user+'</h2><div>'+text+'</div><div><p><a href="' + url + '"target="_blank">'+url+'</a></p></div><p>Date Posted- '+date+'</p></div>';
            templates[3] = '<table width="320" border="0"><tr><td class="user"  colspan="2" rowspan="1">'+user+'</td></tr><tr><td width="45"><a href="'+profile_img+'"><img src="'+profile_img+'" width="55" height="50"/></a></td><td width="186">'+text+'<p><a href="' + url + '"target="_blank">'+url+'</a></p></td></tr></table><hr>';
                        var geocoder = new google.maps.Geocoder();
                Placemaker.getPlaces(text, function (o) {
                    console.log(o);
                    if (!$.isArray(o.match)) {
                        var latitude = o.match.place.centroid.latitude;
                        var longitude = o.match.place.centroid.longitude;
                        var myLatLng = new google.maps.LatLng(latitude, longitude);
                        var marker = new google.maps.Marker({
                            icon: profile_img,
                            title: user,
                            map: map,
                            position: myLatLng
                        });

                      var infowindow = new google.maps.InfoWindow({
                          content: templates[0].replace('user',user).replace('text',text).replace('url',url).replace('date',date)
                      });
                      var $tweet = $(templates[1].replace('%user',user).replace(/%profile_img/g,profile_img).replace('%text',text).replace('%url',url));
                      $('#user-banner').css("visibility","visible");$('#news-banner').css("visibility","visible");
                      $('#news-tweets').css("overflow","scroll").append($tweet);
                      function openInfoWindow() {
                          infowindow.open(map, marker);
                      }
                      google.maps.event.addListener(marker, 'click', openInfoWindow);
                      $tweet.find(".user").on('click', openInfoWindow);
                        bounds.extend(myLatLng);
                    }
                });
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:07:43.277

啊，

经过一些实验，我找到了`Placemaker.js`无法同时处理多个请求的问题。很容易认为您可以克服闭包的问题来记住循环生成的数据，但这不起作用。修复需要在`Placemaker`其中，我选择将其重构为 jQuery 插件。`promise`jQuery 提供了从方法返回 a 的可能性`getPlaces`，使其类似于 jQuery 的 native`$.ajax()`等`$.get()`。

## 雅虎！Placemaker.js 作为 jQuery 插件

```
/* ******************************************************************************
 * Yahoo! Placemaker.js factored as a jQuery Plugin
 * ******************************************************************************
 * by Beetroot-Beetroot: http://stackoverflow.com/users/1142252/beetroot-beetroot
 * ******************************************************************************
 * For example of usage, see : http://stackoverflow.com/questions/12253544/
 * ******************************************************************************
 * All rights reserved
 * Please keep this attribution intact
 * ******************************************************************************
 */
(function($){
    // **********************************
    // ***** Start: Private Members *****
    var pluginName = 'Placemaker';
    var config = {
        appID: ''
    }
    // ***** Fin: Private Members *****
    // ********************************

    // *********************************
    // ***** Start: Public Methods *****
    var methods = {
        config: function(obj) {
            $.extend(config, obj);
        },
        getPlaces: function(data) {
            var that = this;//jQuery object
            var def = new $.Deferred();
            if(config.appID === '') {
                def.rejectWith(this, [{message: pluginName + ' plugin application ID is not set'}]);
                return def.promise();
            }
            var query = [
                'select * from geo.placemaker where documentContent="' + data.text + '" and documentType="text/plain"'
            ];
            if(data.locale) {
                query.push('and inputLanguage="' + data.locale + '"');
            }
            query.push('and appid="' + config.appID + '"');
            var url = [
                'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query.join(' ')),
                'format=json',
                'env=http%3A%2F%2Fdatatables.org%2Falltables.env',
                'callback=?' // callback=Placemaker.retrieve ????
            ];
            $.ajax({
                url: url.join('&'),
                type: 'GET',
                dataType: 'JSON',
                cache: false
            }).done(function(o) {
            if(o.query && o.query.results && o.query.results.matches) {
                    def.resolveWith(that, [o.query.results.matches, data]);
                }
                else {
                    def.rejectWith(that, [{message:'no locations found'}]);
                }
            }).fail(function(jqXHR, textStatus, errorThrown) {
                def.rejectWith(that, [{message: textStatus}]);
            });
            return def.promise();
        }
    };
    // ***** Fin: Public Methods *****
    // *******************************

    // *****************************
    // ***** Start: Supervisor *****
    $.fn[pluginName] = function( method ) {
        if ( methods[method] ) {
            return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || !method ) {
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' + method + ' does not exist in jQuery.' + pluginName );
        }
    };
    // ***** Fin: Supervisor *****
    // ***************************
})( jQuery ); 
```

## 设置应用ID

```
You can hard-code your appID in your own copy of the plugin or set it like this :

    $().Placemaker('config', {'appID': '..........'}); 
```

请注意，`.Placemaker()`需要在 jQuery 对象上调用。对于 'config' 方法，任何选择器都可以，所以一个空的 jQuery 对象`$()`就足够了。

## 使用插件

您的其余代码，包括插件调用，将如下所示：

```
$(function() {
    // *** fixed data ***
    var mapOptions = {
        center: new google.maps.LatLng(35.74651, -39.46289),
        zoom: 2,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var templates = [];
    templates[0] = '<div><h2 class="firstHeading">%user</h2><div>%text</div><div><a href="%url" target="_blank">%url</a></div><div>Date Posted- %date</div></div>';
    templates[1] = '<table width="320" border="0"><tr><td class="user" colspan="2">%user</td></tr><tr><td width="45"><a href="%profile_img"><img src="%profile_img" width="55" height="50"/></a></td><td width="186">%text<p><a href="%url" target="_blank">%url</a></p></td></tr></table><hr/>';
    templates[3] = "https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=false&screen_name=%val&count=10&callback=?";
    $$ = { //cache of jQuery objects
        news_tweets: $("#news-tweets"),
        user_banner: $('#user-banner')
    };

    // *** functions ***
    function news_tweets(value1) {
        $$.news_tweets.empty();
        var bounds = new google.maps.LatLngBounds(); //??
        var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
        $.getJSON(templates[3].replace('%val', value1), function(data) {
            var d, len = data.length;
            for (var i = 0; i < len; i++) {
                var item = data[i];
                d = {
                    text: item.text,
                    user : item.user.name,
                    date: item.created_at,
                    profile_img: item.user.profile_image_url,
                    url: (item.entities && item.entities.urls && item.entities.urls.length) ? item.entities.urls[0].url : '',
                    locale: null
                }
                d.$tweet = $(templates[1].replace('%user', d.user).replace(/%profile_img/g, d.profile_img).replace('%text', d.text).replace(/%url/g, d.url))
                    .appendTo($$.news_tweets.css("overflow", "scroll"))
                    .find(".user")
                    .Placemaker('getPlaces', d)  //.Placemaker('getPlaces') returns a promise
                    .done(function(o, d) {
                        var m = ($.isArray(o.match) ? o.match[0] : o.match) || {};
                        if(m.place) {
                            var myLatLng = new google.maps.LatLng(m.place.centroid.latitude, m.place.centroid.longitude);
                            var marker = new google.maps.Marker({
                                icon: d.profile_img,
                                title: d.user,
                                map: map,
                                position: myLatLng
                            });
                            var infowindow = new google.maps.InfoWindow({
                                content: templates[0].replace('%user', d.user).replace('%text', d.text).replace(/%url/g, d.url).replace('%date', d.date)
                            });
                            function openInfoWindow() {
                                infowindow.open(map, marker);
                            }
                            google.maps.event.addListener(marker, 'click', openInfoWindow);
                            this.each(function() { //`this` is already a jQuery object. Re-wrapping as `$(this)` is not necessary.
                                $(this).on('click', openInfoWindow).css({'color':'#900', 'text-decoration':'underline', 'cursor':'pointer'});//$(this) is an individual tweet in #news_tweets.
                            });
                            bounds.extend(myLatLng); //??
                        }
                    }).fail(function(err) {
                        console.log(err.message);
                });
            }
        });
    }

    // *** event handlers ***
    $("#newsTypes").on('click', 'img', function() {
        news_tweets($(this).data('type'));
        //user_tweets("euronews");
    });
}); 
```

在此的核心，您会发现以下结构：

```
for(...) {
    var d = {...}; //object map comprising both data and options
    $(htmlString).appendTo(...).find(...).Placemaker('getPlaces', d).done(fn{}).fail(fn{});
} 
```

需要注意的是：

*   jQuery 方法链从一个标准的 jQuery 对象开始。
*   from `.Placemaker('getPlaces', d)`, 链中的方法返回一个 jQuery 承诺对象。
*   在`.done()`和`.fail()`处理程序中，`this`都等价于原始的标准 jQuery 对象。
*   作为表达式中的第二个参数传递的数据映射`.Placemaker('getPlaces', d)`，作为处理程序的第二个参数重新出现`.done()`。此功能允许我们调用`.Placemaker('getPlaces', d)`for 循环，而无需专门将数据放入闭包或将其存储在 DOM 中`.data()`。在这方面，“getPlaces”方法有效地充当了一个闭包，并提供了所需的异步查找行为。

根据您的观点，所有这些都将被视为完全令人困惑或完全聪明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:41:34.590

从我看到的情况来看，您的代码`.replace()`通过每次迭代写入 div 的内容。您需要为模板数组添加一些索引。

尝试类似：

```
var index=0;

var templates = [];
templates[index]={
'0':'<div><div></div><h2....',
'1':'<table width="320".....',
'2':'<div><div></div><h2....',
'3':'<table width="320"....'
} 
```

然后把你的`Placemaker.getPlaces`块放在`for loop` 你更新你的模板中`templates[index]["0"]=whatever`。我认为这是您应该追求的逻辑。希望这一切都有帮助。

# regex - 用于在 cpanel 中阻止电子邮件的正则表达式

> ID：12253552
> 
> 赞同：0
> 
> 时间：2012-09-03T20:15:12.743
> 
> 标签：regex, cpanel

我可以在 cpanel 中选择阻止主题等于某些单词或包含某些单词的电子邮件，这很好用……但最近我收到了诸如“s$e^x(y and s!e*) 之类的主题的电子邮件(x@yg$ir-ls" 例如，cpanel 可以选择使用正则表达式来检查电子邮件，所以基本上我将如何去除所有正则字符的字符串并查看它是否包含某个单词，基本上我想要一个与以下字符串匹配的正则表达式：

`s$e^x(y` 包含性感，还夹杂着特殊字符

或者

`s$e^x(y g$ir-ls`包含“sexy Girls”，并混有特殊字符

谢谢！我尝试查找一些东西，但无法真正匹配这个确切的条件（我是正则表达式的新手），尽管我确实找到了我使用的其他一些有用的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:41:48.857

这应该工作

```
s[^a-z]*e[^a-z]*x[^a-z]*y[^a-z]*|g[^a-z]*i[^a-z]*r[^a-z]*l[^a-z]*s[^a-z]* 
```

# java - Java - 如何将对象转换为变量？

> ID：12253556
> 
> 赞同：3
> 
> 时间：2012-09-03T20:15:30.447
> 
> 标签：java, string, object, int

我正在研究一种编程语言，我需要将一个对象（如javascript中的var）转换为它应该是的变量类型。前任：

```
if(object == variabletypes.string)
{
//convert object to string
}
else if(object ==variabletypes.int)
{
//convert to integer
} 
```

感谢您的时间，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T20:18:13.770

假设你有一个`java.lang.Object`，这是一个开始：

```
Object o = /* ??? */;
if (o instanceof String)
{
    String s = (String) o;
}
else if (o instanceof Integer)
{
    Integer integer = (Integer) o;
    int i = integer.intValue();
} 
```

这里的“转换”主要是[强制转换](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)，假设对象已经具有正确的运行时类型，并且您不需要实际更改内部表示 - 例如，通过将 a 更改`String`为`int`with [`Integer#parseInt()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#parseInt%28java.lang.String%29)。

其他可能有用的方法（因为问题并不完全清楚）可能包括：

*   [`Object#getClass()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#getClass%28%29)
*   [`Class#cast(Object)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#cast%28java.lang.Object%29)
*   [`Class#isAssignableFrom(Class)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#isAssignableFrom%28java.lang.Class%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:21:16.937

```
if(yourObject instanceof String){
    String str = (String)yourObject;
}
else if (yourObject instanceof Integer){
    Integer yourInt = (Integer)yourObject;
}
else if{
     System.out.println("My object is a class of: "+ yourObject.getClass().getName());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:18:23.143

你可以做：

```
object.toString(); // Returns the string value of the object, if it exists. 
```

[http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T20:20:29.637

Java 中有几个可用的工具：

1.  运营`instanceof`商
2.  `getClass().getName()`调用，它将为您提供对象的实际类的名称作为字符串。

我不知道您所说的“转换”是什么意思，但这些是您可用的基本工具。

# c# - 如何使用 Linq 从 xml 数据中检索某些元素？

> ID：12253559
> 
> 赞同：0
> 
> 时间：2012-09-03T20:16:07.903
> 
> 标签：c#, xml, linq

这个 xml 数据对我来说有点棘手，它的结构如下：

```
<site time="local">
    <key>000-000-000</key>
    <valid-time period-name="Monday">2012-09-03T06:00:00-04:00</valid-time>
    <valid-time period-name="Tuesday">2012-09-04T06:00:00-04:00</valid-time>
    <valid-time period-name="Wednesday">2012-09-05T06:00:00-04:00</valid-time>
    <valid-time period-name="Thursday">2012-09-06T06:00:00-04:00</valid-time>
 </site>
 <site time="local">
    <key>123-456-789</key>
    <valid-time period-name="Monday">2012-09-03T06:00:00-04:00</valid-time>
    <valid-time period-name="Tuesday">2012-09-04T06:00:00-04:00</valid-time>
    <valid-time period-name="Wednesday">2012-09-05T06:00:00-04:00</valid-time>
    <valid-time period-name="Thursday">2012-09-06T06:00:00-04:00</valid-time>
 </site>
...more <site time="">... 
```

我这样做是为了获取数据：

```
xmlCurrent = from d in Xmldata.Descendants("site")
                        .Where(s => s.Element("key").Value.Equals("123-456-789"))
                        .Select(x => new { content = x.Value})
                        .ToList(); 
```

但是所有内容都作为单个字符串进入列表的一个索引，如何将每个值放入不同的索引？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:22:59.823

您当前的代码选择`<site>`元素。

您可能想要更多类似的东西：

```
 xmlCurrent = from d in Xmldata.Descendants("site")
               where d.Element("key").Value.Equals("123-456-789")
               select d.Elements("valid-time"); 
```

那会给你一个`IEnumerable<IEnumerable<XElement>>`，也许你会想要把它弄平。

```
//untested
IEnumerable<XElement> current =  Xmldata
     .Descendants("site")
     .Where(s => s.Element("key").Value.Equals("123-456-789") )
     .SelectMany(s => s.Elements("valid-time") ); 
```

# php - 如何使用mysql显示即将到来的生日？

> ID：12253560
> 
> 赞同：0
> 
> 时间：2012-09-03T20:16:16.393
> 
> 标签：php, mysql

我想在我的网站上显示未来即将到来的生日，因此使用出生日期（dateofb）对它们进行排序，以下查询未按 dateofb 顺序显示 bateof 出生。它使用id按顺序显示。

" dateofb 包含 1970 年 9 月 2 日这种格式的一组出生日期。"

```
<?php $sel = $db->query("select * from mov_biography order by dateofb asc limit 0,5"); 
while($row=mysql_fetch_array($sel)){

echo ($row['name']); } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:26:27.667

你可以做这样的事情......

```
SELECT

  , MONTH(dateofb)  AS month
  , DAY(dateofb ) AS day  

FROM <table_name>
WHERE  birthday BETWEEN NOW() AND DATE_ADD(NOW, INTERVAL 90 DAY)  
ORDER BY Birthday DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:11:27.553

使用默认排序，它将如下所示：

```
mysql> SELECT column FROM table_name ORDER BY column; 

column
======
100
1000
10000
200
2000
20000
...

Now with "... ORDER BY column+0", I get it sorted right:

mysql> SELECT column FROM table_name ORDER BY column+0; 

column
======
100
200
1000
2000
10000
20000
...

This is a quick fix instead of sorting to CAST operator. 
```

# javascript - Microsoft Metro 风格网格，动态构建

> ID：12253561
> 
> 赞同：0
> 
> 时间：2012-09-03T20:16:30.627
> 
> 标签：javascript, jquery, css, microsoft-metro, calculated-columns

我想制作某种可以填充 3 X 3 网格的 jQuery 插件（如 microsoft-metro 样式）。它应该是这样的：

*   如果我有 1 个图块，它应该占用整个网格 (1-9)。
*   如果我有 2 个图块，它应该是一个图块 (1-6) 和另一个图块 (7-9)。
*   如果我有 3 块瓷砖，则需要 (1-2 和 4-5)、(3 和 6)、(7-9)
*   如果我有 5 个图块，则需要 (1-2)、(3)、(4-6)、(7)、(8-9)

等等！

```
-------------
| 1 | 2 | 3 |
-------------
| 4 | 5 | 6 |
-------------
| 7 | 8 | 9 |
------------- 
```

是否可以根据图块的数量（最多 9 个）动态填充我的网格。有某种计算吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:08:36.283

使用`display: -ms-flex`, 与`-ms-flex-Wrap: wrap`. 这将让您自动换行。你需要根据你想要的数量来调整你的物品的大小。

另一种选择是使用`-ms-grid`，并根据项目配置列/行（和跨度）。

# database - 如何在线而不是在我的电脑上练习 SQL 语句？

> ID：12253566
> 
> 赞同：3
> 
> 时间：2012-09-03T20:17:21.353
> 
> 标签：database

我不想在我的电脑上安装 3-4 个数据库。我看过一个网站，我可以在其中创建一个网站上的数据库，将其存储在网站本身并对其运行 SQL 查询。我忘记了那个网站的名字。

现在，我正在寻找一个可以让我做这一切的网站。你能推荐一些可以做到这一点的网站吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:22:53.680

在这里练习... [http://www.sql-ex.ru/](http://www.sql-ex.ru/)

# iphone - UIImage从左到右和从右到左卷曲

> ID：12253568
> 
> 赞同：1
> 
> 时间：2012-09-03T20:17:38.460
> 
> 标签：iphone, ios, uianimation

我有这个代码来卷曲页面，但我需要从左到右或从右到左卷曲页面。请帮忙！

```
[UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:1.0];
        //[UIView setAnimationBeginsFromCurrentState:NO];
        [UIView setAnimationTransition:UIViewAnimationTransitionCurlUp forView:imagePage cache:YES];

        //UIView *parent = self.view.superview;
        //[self.view removeFromSuperview];

        //[parent addSubview:moreInfo];
        [imagePage setImage:[UIImage imageNamed:[collectionOfImages objectAtIndex:countForPages]]];

        [UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:18:41.107

您是否尝试过将 UIViewAnimationTransitionCurlUp 替换为其他动画类型之一，例如 UIViewAnimationTransitionFlipFromLeft 或 UIViewAnimationTransitionFlipFromRight ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T08:58:38.187

只需使用`UIViewAnimationTransitionFlipFromLeft`and`UIViewAnimationTransitionFlipFromRight`而不是左右`UIViewAnimationTransitionCurlUp`翻转。[在此处](http://www.roseindia.net/tutorial/iphone/examples/iphone-FlipImage.html)查找示例以获取指导。对于左右卷曲，请查看[此处](http://github.com/brow/leaves)提供的示例。

# cygwin - 如何解决 cygwin/opencobol 中的过程入口点_impure_ptr 错误？

> ID：12253569
> 
> 赞同：1
> 
> 时间：2012-09-03T20:18:01.463
> 
> 标签：cygwin, exe, cobol

每当我尝试运行我的 .exe cobol 文件时，我都会收到此错误。

> fileName.exe 未找到入口点 无法在动态链接库 cygwin1.dll 中找到过程入口点_impure_ptr

我正在使用 OpenCObol 和 cygwin ver1.7.15.thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T15:52:34.307

您需要为下面的命令指定正确的路径，但 Cygwin 似乎对入口点地址和更新非常挑剔，系统包含一个**rebaseall**命令来帮助解决此问题。大多数情况下，我看到它是在**setup.exe pass**之后，而 Cygwin 系统仍然处于活动状态（并且可能仅在后台并且不可见）。

```
C:\Users\btiffin\cygwin\bin\dash -c '/usr/bin/rebaseall' 
```

从 Windows CMD shell 运行它（当 Cygwin 不活动时，比如在干净启动之后和运行 Cygwin shell 之前。基本上 cygwin1.dll 无法打开）。您需要使用正确的 Windows 路径来为您的特定安装**破折号**。Google Cygwin rebase 获取详细文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:30:33.993

I had a similar error message after upgrading from cygwin version 1.5 to 1.7\. I solved it by completely removing and reinstalling 1.7 from scratch. I was told there might have been a problem with multiple versions of dlls.

# jquery - $ 未在 Firefox 中使用 jQuery 1.7.2 定义

> ID：12253572
> 
> 赞同：1
> 
> 时间：2012-09-03T20:18:07.760
> 
> 标签：jquery, firefox

我只在 Firefox 中遇到此错误，在 IE 和 Chrome 中一切正常，我使用的是 Firefox v 15.0。这是我的代码

```
<script type="text/javascript" src="/_layouts/Scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
    $(function () {
       // some code here
    }); 
```

第一行发生异常（文档准备好），页面似乎根本无法引用 jQuery 库，但是如果我从错误控制台单击源链接，我可以在浏览器 jQuery 库的代码中看到。这很奇怪，因为我在 IE 或 Chrome 中没有错误。

任何想法为什么会发生这种情况？

**编辑：** 这是整个 js 代码

```
$(function () {

        var digitCode;

        $('input[type=submit][id*=btnCancel]').on('click', function (e) {
            e.preventDefault();
            closeModalDialog('Cancel');
        });

        $("select[id*=ddlContacts]").on('change', function () {
            var contactID = $(this).val();
            if (parseInt(contactID) == 0) {
                $('span[id*=lblCEOTitle]').text("");
                return;
            }

            var data = { contactId: contactID };

            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "AddCompany.aspx/CeoTitle",
                data: JSON.stringify(data),
                dataType: "json",
                success: function (result) {
                    $('span[id*=lblCEOTitle]').text(result.d);
                    $('input[type=hidden][id*=hdnFieldCeoTitle]').val(result.d);
                },
                error: function () {
                    alert('error');
                }
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:36:48.987

除非您离线工作，否则您应该让 CDN 为您的用户托管这些文件。与在您的服务器上托管 jQuery 相比，这样做有几个优点：减少延迟、增加并行性和更好的缓存。有关更多详细信息，请查看这篇文章：[http ://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)

这也节省了您刚刚遇到的一些麻烦（路径文件管理、损坏的文件、错误版本等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:28:51.613

您能否提供一些有关网页的内容（例如：它是 ASP.NET 吗？）是否正确解析了脚本引用？（如果脚本已加载，您可以使用 firebug 检查）您是否使用任何其他可能与 jquery 冲突的 javascript 框架，确保未定义 $？

# garbage-collection - 如何计算出 MonoDroid 中使用了哪些 GREF？

> ID：12253574
> 
> 赞同：3
> 
> 时间：2012-09-03T20:18:10.770
> 
> 标签：garbage-collection, xamarin.android

在此项目上使用模拟器时 - [https://github.com/davidhauck/MvxSampleCode](https://github.com/davidhauck/MvxSampleCode) - 我看到很多消息，例如：

```
 09-03 19:08:47.015 I/monodroid-gc(  473): 1813 outstanding GREFs. Performing a full GC! 
```

该文档 - [http://docs.xamarin.com/android/advanced_topics/garbage_collection](http://docs.xamarin.com/android/advanced_topics/garbage_collection) - 提供了为什么会发生这种情况的良好背景，但它并不能帮助我弄清楚实际引用了哪些对象。

在 MonoTouch 中，我知道有一个很好的分析器，但我认为 Mono for Android 中没有类似的东西吗？有什么方法可以遍历当前堆以找出 GREF 是什么？

# ios - 修复工作区 xcode 中的“查找选定文本”

> ID：12253579
> 
> 赞同：1
> 
> 时间：2012-09-03T20:18:42.477
> 
> 标签：ios, xcode, keyboard-shortcuts

如果我在 xcode 中双击一个单词，然后使用“在工作区中查找选定的文本”它不起作用。当我转到工作区中的编辑->查找->在选定文本中查找时，它未启用。

一旦我选择了比单词本身更多的词，它将能够搜索，有没有人只选择一个词来工作？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T02:33:10.867

实际上，在我退出 Xcode 并重新启动后，它现在可以工作了。我还在 xcode 的管理器中删除了所有派生数据。

# c - 在没有 DLL 的情况下全局使用 WH_MOUSE

> ID：12253585
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:19:14.093
> 
> 标签：c, winapi, hook, mouseevent, mousemove

我有一个代码可以在鼠标移动时显示屏幕的一部分。但是 WH_MOUSE 不起作用。我需要更改`GetModuleHandle(0), 0`为`hInst, GetCurrentThreadId()`.

但是只有当鼠标悬停在应用程序本身上时，该应用程序才能工作。

我希望它是全局的，我尝试了 WH_MOUSE_LL，它比 WH_MOUSE 慢。

可以在没有 DLL 的情况下全局使用 WH_MOUSE 吗？

```
void SetHook()
{
    gMouseHook = SetWindowsHookEx(WH_MOUSE, MouseProc, GetModuleHandle(0), 0);
}   

//================================================================================
// Mouse Hook

static LRESULT CALLBACK MouseProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode < 0) {
    return CallNextHookEx(gMouseHook, nCode, wParam, lParam);
    }

    if (wParam == WM_MOUSEMOVE) {

    MOUSEHOOKSTRUCT *mouseInfo = (MOUSEHOOKSTRUCT*)lParam;

    int x = mouseInfo->pt.x;
    int y = mouseInfo->pt.y;

    PrintScreen(x, y);
    }

    return CallNextHookEx(gMouseHook, nCode, wParam, lParam);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T22:18:23.123

> 可以在没有 DLL 的情况下全局使用 WH_MOUSE 吗？

不，挂钩过程需要在 DLL 中，以便可以将其注入其他进程。

> 我试过 WH_MOUSE_LL，它比 WH_MOUSE 慢。

这可能意味着你的钩子程序很慢。

# sql - 结合 distinct 和 cast 函数的数据库查询

> ID：12253586
> 
> 赞同：3
> 
> 时间：2012-09-03T20:19:17.127
> 
> 标签：sql, sqlalchemy

我有一个带有日期时间字段的 SQLAlchemy 声明性类，例如：

```
class Logon(Base):
    id = Column(Integer, primary_key=True)
    timestamp = Column(types.DateTime)
    event_type = Column(types.Integer) 
```

我有兴趣获取至少有一个事件的所有日期，因此我使用一个不同的子句来玩：

```
session.query(sqlalchemy.func.distinct(Logon.timestamp)) 
```

显然这是虚假的，因为时间戳在同一天内并不是唯一的。然而奇怪的是，我得到的是 unicode 字符串而不是 datetime 实例：

```
 (u'2012-07-26 11:05:01.000000',), (u'2012-07-26 11:12:53.000000',), (u'2012-07-27 16:53:28.000000',) 
```

我真正想要的是使用日期而不是日期时间的独特运算符：

```
session.query(sqlalchemy.func.distinct(sqlalchemy.cast(Logon.timestamp,sqlalchemy.Date))) 
```

SQL 在我看来也不错：

```
SELECT distinct(CAST(logons.timestamp AS DATE)) AS distinct_1 
FROM logons 
```

然而令我惊讶的是，我的查询结果是一个带有年份的条目：

```
[(2012,)] 
```

我可以通过简单的循环获得我的日期列表，但我有兴趣学习如何在 SQL 和/或 SQLAlchemy 中组合强制转换和不同的运算符

# javascript - 意外断电恢复 JS 定时器

> ID：12253587
> 
> 赞同：0
> 
> 时间：2012-09-03T20:19:25.957
> 
> 标签：javascript

我正在制作一个在线测验应用程序，它有一个通过 JavaScript 实现的计时器。如果不小心，浏览器因电源故障而关闭，我打算从浏览器关闭的时间点恢复计时器。现在，我只在使用 PHP/AJAX 的数据库中记录测验结束时的时间。如何从用户关闭浏览器的确切时间恢复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:26:12.460

您可以订阅窗口卸载事件，但我不能 100% 确定这会在电源故障关闭时触发。

也许更好的解决方案是在测验过程中通过`setInterval`可以每 1000 毫秒（或无论多么频繁）触发并设置/更新 cookie 的方式来轮询用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:14:58.893

电源故障的问题是不会提前通知您断电，因此在电源故障时没有机会保存状态。

因此，要想知道何时断电，唯一的方法就是每隔 N 个时间间隔连续保存状态。然后，当电源熄灭并恢复时，您可以查看上次保存的状态。它不会是完美的，但会是你能做到的最好的。

您保存状态的三个选项是：

1.  每分钟设置一个cookie（或在其中运行时间计数的某个时间段）。
2.  将相同的状态保存到本地存储（较新的浏览器）。
3.  使用常规 ajax 调用（每隔几分钟）将运行时间“自动保存”到您的服务器。

选项 1 和 2 的优点是它都是客户端的，因此保存速度很快并且不会加载您的服务器。选项 1 和 2 的缺点是它们可能会被试图玩弄系统的客户端操纵。

有一个小危险，即使选项 1 和 2 中的本地状态在断电时也可能无法正确保存，但据我所知，大多数浏览器会在保存时将其保存到磁盘，这样即使浏览器以后崩溃，它也是可靠的。

# css - 主菜单影响子菜单

> ID：12253589
> 
> 赞同：0
> 
> 时间：2012-09-03T20:19:30.750
> 
> 标签：css

我将边框样式应用于我的主菜单 li。但我的子菜单 li 也受到主菜单 li 样式的影响。这是示例代码，请让我知道如何解决此问题。

```
ul.menu li {
        border-left:1px solid #fcfcfc;
        border-right:1px solid #e8e8e8;
    } 
```

上面的样式也呈现在我的子菜单 li 上。我不想使用 class 或 id 我想直接标记样式。有什么办法可以停止在我的子菜单上呈现边框。

```
 ul.menu ul li {
         min-width: 200px;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:31:41.957

如果您只想影响`<ul>`with 类的直接子级`menu`，则需要使用此选择器：

```
ul.menu > li {
    ...
} 
```

所以如果你有这个结构：

```
<ul class="menu">
    <li>One</li>
    <li>Two
        <ul>
            <li>Three</li>
        </ul>
    </li>
</ul> 
```

`<li>`然后这将使用内容 1 和 2 设置元素的样式，但不会`<li>`使用 3 设置子菜单。

# javascript - 浏览器支持某些 if 语句

> ID：12253590
> 
> 赞同：-6
> 
> 时间：2012-09-03T20:19:49.327
> 
> 标签：javascript

我想知道哪些浏览器（在 jquery 的支持范围内）支持这种 if 语句：

`var a = true; if(a) { alert('a') }`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:21:07.260

所有支持 JavaScript 1.3 的浏览器都是在`===`引入操作符时。

`(a === true)`评估为`true`给定 a 为真。

并且因为`true`是完全一样`true`的行为是完全一样的。

因此，不支持 JavaScript 的浏览器示例可以在此页面中看到：[http ://en.wikipedia.org/wiki/Comparison_of_web_browsers#JavaScript_support](http://en.wikipedia.org/wiki/Comparison_of_web_browsers#JavaScript_support)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:22:16.593

不。

例如 Mosaic 和 lynx，即使是最新版本，也无法通过这些测试。Netscape Navigator 在版本 2 之前也完全无法做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:39:10.793

NN2（第一个 javascript 浏览器）的所有 javascript 浏览器都支持第一个。

`===`与 NN4.06 和 IE4 中使用的 javascript 1.3（ECMA-262 第一版）一起引入。

Opera 和 Safari 从它们的第一个 javascript 实现中都支持；分别为 7.0 和 3.0-5。

Firefox、Chrome 和 Chromium 都在此之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:21:46.167

这是两个不同的东西：

```
var a = true; if(a) { alert('a') } 
```

检查`a`“评估”的值是否为真。又是真的。

```
var a = true; if(a === true) { alert('a') } 
```

这也检查类型。所以它检查是否`a`包含布尔值`true`。

然而，它们都在相当现代的用户代理中得到支持（尽管大多数文本浏览器不支持它）。

# mysql - created_at 在 where 语句和时区

> ID：12253593
> 
> 赞同：0
> 
> 时间：2012-09-03T20:20:03.880
> 
> 标签：mysql, ruby-on-rails, date, timezone

我正在尝试在我的模型中检索当天的所有条目：

```
where('date(created_at) = date(?)', Date.today) 
```

但是，由于时区（我的当地时间是 UTC+2），我没有预期的结果。例如，如果在午夜后一分钟创建了一个条目，则在数据库中，它将存储在 22:01（因此不是“Date.today”）。

有没有办法做到这一点 ？

**编辑：**

作为网站管理员，我想在当地时间“今天”显示条目数（仅用于统计目的！）。因此，我想将时间戳存储在 UTC 中，但在此请求期间将它们转换为我的本地时区！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T05:18:48.227

```
where('date(created_at) = ?', Time.zone.now.to_date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:30:33.890

您可以通过多种方式设置正确的时区。此答案中描述了一个：

[https://stackoverflow.com/a/6118837/567126](https://stackoverflow.com/a/6118837/567126)

> 将以下内容添加到 application.rb 作品
> 
> config.time_zone = '东部时间（美国和加拿大）'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T05:50:24.307

数据库中的时间应存储为 UTC。这样，当你做一个全球网站时，你可以为每个用户提供他们自己的时区。

显示用户本地时区的时间是 UI（视图）的职责。

对于您**应该**使用**Time.now.utc** 这种方式，您正在使用通用 UTC 搜索数据库。

# objective-c - NSLocale 货币符号，显示在金额值之前或之后

> ID：12253594
> 
> 赞同：13
> 
> 时间：2012-09-03T20:20:12.753
> 
> 标签：objective-c, ios, storekit, nsnumberformatter, nslocale

我正在使用`StoreKit`在我的应用程序中实现应用内购买商店。

我有一个定制设计，这意味着价格的价值应该是白色的和大的，货币符号更小、更暗并与价格价值的顶部对齐。

`NSLocale`通过使用in`SKproduct`的`priceLocale`属性和属性中的价格值，我可以毫无问题地获取货币符号`price`。

我的问题是知道何时应该将货币符号放在价格之前以及何时将其放在价格之后。

例子：

*   5,99 美元
*   0,79€</li>

我可以很容易地使用`NSNumberFormatter`“开箱即用”来解决这个问题，但是由于我的布局为价值和货币符号定义了不同的样式，我发现自己处于需要更多手动解决方法的位置。

有什么想法吗 ？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-30T21:31:14.487

您拥有`SKProduct`实例中所需的一切。只需`NSNumberFormatter`结合使用即可。

```
NSNumberFormatter *priceFormatter = [[NSNumberFormatter alloc] init];
[priceFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];        

for (SKProduct *product in response.products) {
    [priceFormatter setLocale:product.priceLocale];
    NSLog(@"Price for %@ is: %@",product.localizedTitle,[priceFormatter stringFromNumber:product.price]);
} 
```

### 斯威夫特 3+

```
let priceFormatter = NumberFormatter()
priceFormatter.numberStyle = .currency

for product in response.products {
    priceFormatter.locale = product.priceLocale
    let localizedPrice = priceFormatter.string(from: product.price)
    print("Price for \(product.localizedTitle) is: \(localizedPrice)")
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-03T21:45:49.273

locale 对象似乎没有直接提供此信息，但数字格式化程序当然必须知道它。您不应该直接询问（新型）数字格式化程序`format`，尽管这可能会起作用，然后您可以`¤`在格式字符串中查找货币符号 , 。

可能更好的是创建一个`CFNumberFormatter`，它确实允许您查看其格式，然后检查该字符串：

```
// NSLocale and CFLocale are toll-free bridged, so if you have an existing
// NSNumberFormatter, you can get its locale and use that instead.
CFLocaleRef usLocale = CFLocaleCreate(NULL, CFSTR("en_US"));
CFNumberFormatterRef usFormatter = CFNumberFormatterCreate(NULL, usLocale, kCFNumberFormatterCurrencyStyle);
CFLocaleRef frLocale = CFLocaleCreate(NULL, CFSTR("fr_FR"));
CFNumberFormatterRef frFormatter = CFNumberFormatterCreate(NULL, frLocale, kCFNumberFormatterCurrencyStyle);

NSString * usString = (__bridge NSString *)CFNumberFormatterGetFormat(usFormatter);
NSString * frString = (__bridge NSString *)CFNumberFormatterGetFormat(frFormatter);

NSUInteger loc = ([usString rangeOfString:@"¤"]).location;
NSLog(@"Currency marker at beginning for US? %@", (loc == 0) ? @"YES" : @"NO");
loc = ([frString rangeOfString:@"¤"]).location;
NSLog(@"Currency marker at end for FR? %@", (loc == [frString length] - 1) ? @"YES" : @"NO"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-26T17:20:15.343

我使用这个解决方案（Swift）：

```
let currencyFormat = CFNumberFormatterGetFormat(CFNumberFormatterCreate(nil, locale, .CurrencyStyle)) as NSString
let positiveNumberFormat = currencyFormat.componentsSeparatedByString(";")[0] as NSString
let currencySymbolLocation = positiveNumberFormat.rangeOfString("¤").location
return (currencySymbolLocation == 0) ? .Before : .After 
```

接受的答案应该是固定的，因为`CFNumberFormatterGetFormat`有时（对于某些语言环境）返回双精度值：`¤##,#00.0;-¤##,#00.0`其中包括负数格式。确保解析该字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T12:49:02.963

我的解决方案是设置小数样式并设置有效数字的最小数量。

```
static NSNumberFormatter *NumberFormatter;

if (!NumberFormatter) {
    NumberFormatter = [[NSNumberFormatter alloc] init];
    [NumberFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
    [NumberFormatter setUsesSignificantDigits:YES];
    [NumberFormatter setMinimumSignificantDigits:2];
}

NSString *formattedNumberString = [NumberFormatter stringFromNumber:@(valueInEuro)];

NSString *stringInEuro = [NSString stringWithFormat:@"€ %@", formattedNumberString]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-22T07:57:00.977

我创建了 SKProduct 的扩展，把东西放在它们所属的地方。

```
extension SKProduct
{
    var localizedPrice: String {
        let numberFormatter = NSNumberFormatter()
        numberFormatter.numberStyle = .CurrencyStyle
        numberFormatter.locale = self.priceLocale
        numberFormatter.formatterBehavior = .Behavior10_4
        return numberFormatter.stringFromNumber(self.price)!
    }
} 
```

顺便说一句，这种格式化方式也正是 Apple 在[In-App Purchase Programming Guide](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html)部分[Retrieving Product Information](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/ShowUI.html#//apple_ref/doc/uid/TP40008267-CH3-SW5)中建议的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-11T12:06:02.533

**斯威夫特 3**

上的扩展功能`Locale`：

```
extension Locale {
    func IsCurrenySymbolAtStart() -> Bool {
        let currencyFormatter = NumberFormatter()
        currencyFormatter.numberStyle = .currency
        currencyFormatter.locale = self

        let positiveFormat = currencyFormatter.positiveFormat as NSString
        let currencySymbolLocation = positiveFormat.range(of: "¤").location

        return (currencySymbolLocation == 0)
    }
} 
```

用法：

```
let displayCurrencySymbolAtStart = NSLocale.current.IsCurrenySymbolAtStart() 
```

# javascript - IndexedDB 同步 api + web 工作者 - 有什么意义？

> ID：12253599
> 
> 赞同：4
> 
> 时间：2012-09-03T20:20:49.717
> 
> 标签：javascript, html, web-worker, indexeddb

[IndexedDB 的](https://developer.mozilla.org/en-US/docs/IndexedDB)同步API 旨在用于[Web 工作者](http://www.w3.org/TR/workers/)内部：

> 同步 API 旨在仅在 Web Workers 内部使用。

但既然有一个异步 API，那么在 Web Worker 中使用同步 API 有什么意义。异步 API 无论如何都不会影响 UI 线程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T03:56:53.987

同步 API 比异步 API 更易于使用。Web Worker 不需要异步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T00:47:35.700

经过思考，web Worker 中需要异步，甚至认为后台线程同步 API 上看似不错的想法被证明是一个可怕的陷阱。

事实上，同步对于 IO 等待来说是假的。无论是异步还是同步，[在内部它们都是相同的异步进程](http://www.chromium.org/developers/design-documents/indexeddb)。Worker 应该在 IO 等待期间做一些有趣的 CPU 工作。

此外，我们可能已经有了 UI 线程的异步代码。重用异步代码比同时为前台编写异步代码和为后台编写同步代码更好。

Async API 可以使用不同的范围和模式创建多个事务。这些事务异步流是交错的。无法在同步 API 中交错交易。

我们在同步 API 上获得的唯一优势是易于使用。但是使用 promise/deferred 模式的异步工作流已经很好地解决了。

可能好的同步 API 是关键光标扫描过程（也适用于 UI 线程），因为它不涉及序列化并且可能不需要 IO。然而，尽管用例不同，但用于同步 API 的 IDBCursor 和用于异步 API 的 IDBCursorWithValue 会令人困惑。

对于编写高性能程序的开发人员来说，似乎同步 API 的好主意是一个可怕的陷阱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T13:11:10.917

到目前为止，同步 API 尚未在任何浏览器中实现，它被标记为 IndexedDB 标准的风险部分，可能会被删除。目前只有 Google Chrome 使用异步 API 在 Web Worker 中实现了 IndexedDB 访问。

参考[W3C](http://www.w3.org/TR/IndexedDB/#sync-database)，[Mozilla](https://developer.mozilla.org/en-US/docs/IndexedDB)：

> 由于可能缺乏实现，以下功能存在风险并且可能会被删除。

# java - 数据库信息->对象：应该怎么做？

> ID：12253600
> 
> 赞同：4
> 
> 时间：2012-09-03T20:21:02.120
> 
> 标签：java, oop, design-patterns

我的应用程序将根据请求从数据库中检索信息并从该信息中生成一个对象。我目前正在考虑两种不同的技术（但我也向其他人开放！）来完成这项任务：

方法一：

```
class Book {

    private int id;
    private String author;
    private String title;

    public Book(int id) {

        ResultSet book = getBookFromDatabaseById(id);

        this.id = book.id;
        this.author = book.author;
        // ...

    }

} 
```

方法二：

```
public class Book {

    private HashMap<String, Object> propertyContainer;

    public Book(int id) {

        this.propertyContainer = getBookFromDatabaseById(id);

    }

    public Object getProperty(String propertyKey) {

        return this.propertyContainer.get(propertyKey);

    }

} 
```

使用方法一，我相信更容易控制、限制和可能访问属性，但是添加新属性，使用方法二会变得更顺畅。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:26:25.783

我认为这个问题已经在很多方面得到了解决：ORM、DAO、行和表映射器，还有很多其他的。没有必要再重做一次。

您必须认真考虑的一个问题是包之间的耦合和循环依赖。您可能认为通过告诉模型对象如何持久化自己是在做一些聪明的事情，但这种设计选择的一个结果是模型对象和持久层之间的耦合。如果你这样做，你就不能使用没有持久性的模型对象。它们真的变成了一个大而笨重的包裹。没有分层。

另一种选择是让模型对象不知道它们是否被持久化。这是一种单向依赖：持久性知道模型对象，但反之则不然。

谷歌寻找其他解决方案。没必要再打败那匹死马了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:28:03.943

第一种方法将为您提供关联访问器的类型安全性，因此您将知道要返回的对象类型，并且不必强制转换为您期望的类型（这在提供除原语以外的任何内容时变得更加重要） .

出于这个原因（加上它会使生成的代码更简单、更容易阅读），我会选择第一个。在任何大型应用程序中，您还可以快速、轻松、整齐地在代码中获取参数值，以便在对象本身内进行调试等。

如果其他人也将使用此代码（或者您在忘记它之后计划使用它），第一个也将帮助您了解参数等。第二个只会为您提供广泛的 javadoc。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:27:20.790

第一个是经典的方式。第二个真的很棘手。

# javascript - 使 div 在文本区域的焦点上淡出

> ID：12253602
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:21:12.773
> 
> 标签：javascript, jquery, css, fadeout

我有一个 div，当单击/聚焦某个文本区域时，我想使用 JavaScript 淡出。这可能吗？

**文本区域 HTML**

```
<label for="message">Message:</label>
    <textarea name="message" id="message" wrap="physical" 
         placeholder="What's on your mind?">
    </textarea> 
```

**div的HTML我想淡出**

```
<div id="bubble">
    <img src="images/hire_me_bubble.png" alt="Hire me" />
</div> 
```

**气泡的 CSS**

```
#bubble{
    width:201px;
    height:189px;
    position:absolute;
    left:416px; 
    top:300px; 
    z-index: 99;
    overflow:visible;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:26:09.450

尝试这个：

```
$("#message").focus(function() {
    $("#bubble").fadeOut();
}).blur(function() {
    $("#bubble").fadeIn();
});​ 
```

它将两个事件绑定到 textarea，一个绑定到`focus`事件，一个绑定到`blur`事件。 [http://jsfiddle.net/FzmW2/](http://jsfiddle.net/FzmW2/)

如果您不希望它重新淡入，请移除该`.blur`部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:25:57.683

```
$('#message').bind('focus', function(){
    $('#bubble').fadeOut();
 }); 
```

# c# - 将相对网址替换为绝对网址

> ID：12253608
> 
> 赞同：2
> 
> 时间：2012-09-03T20:21:34.457
> 
> 标签：c#, asp.net, regex, .net-4.0

我有**一个字符串形式的**页面的 html 源代码：

```
<html>
    <head>
          <link rel="stylesheet" type="text/css" href="/css/all.css" /> 
    </head>
    <body>
        <a href="/test.aspx">Test</a>
        <a href="http://mysite.com">Test</a>
        <img src="/images/test.jpg"/>
        <img src="http://mysite.com/images/test.jpg"/>
    </body>
</html> 
```

我想将所有相对路径转换为绝对路径。我希望输出是：

```
<html>
    <head>
          <link rel="stylesheet" type="text/css" href="http://mysite.com/css/all.css" /> 
    </head>
    <body>
        <a href="http://mysite.com/test.aspx">Test</a>
        <a href="http://mysite.com">Test</a>
        <img src="http://mysite.com/images/test.jpg"/>
        <img src="http://mysite.com/images/test.jpg"/>
    </body>
</html> 
```

**注意：我只希望将该字符串**中的相对路径转换为绝对路径。不应该触及已经在该字符串中的绝对值，它们对我来说很好，因为它们已经是绝对的。这可以通过正则表达式或其他方式完成吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-03T21:40:45.230

**不要尝试使用正则表达式解析 html，**如下所示[https://stackoverflow.com/a/1732454/932418](https://stackoverflow.com/a/1732454/932418)和[https://stackoverflow.com/a/1758162/932418](https://stackoverflow.com/a/1758162/932418)

改用[HtmlAgilityPack](http://html-agility-pack.net/?z=codeplex)之类的 html 解析器

```
string html = 
@"<html>
    <head>
            <link rel=""stylesheet"" type=""text/css"" href=""/css/all.css"" /> 
    </head>
    <body>
        <a href=""/test.aspx"">Test</a>
        <a href=""http://example.com"">Test</a>
        <img src=""/images/test.jpg""/>
        <img src=""http://example.com/images/test.jpg""/>
    </body>
</html>";

StringWriter writer = new StringWriter();
string baseUrl= "http://example.com";
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

foreach(var img in doc.DocumentNode.Descendants("img"))
{
    img.Attributes["src"].Value = new Uri(new Uri(baseUrl), img.Attributes["src"].Value).AbsoluteUri;
}

foreach (var a in doc.DocumentNode.Descendants("a"))
{
    a.Attributes["href"].Value = new Uri(new Uri(baseUrl), a.Attributes["href"].Value).AbsoluteUri;
}

doc.Save(writer);

string newHtml = writer.ToString(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T20:29:33.117

添加

```
<base href="http://mysite.com/images/" /> 
```

到页首

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T21:35:12.353

为此使用正则表达式。这是一个简短的例子

```
static void Main(string[] args)
    {
        string input = "<html>\n<head>\n<link rel=\"stylesheet\" type=\"text/css\" href=\"/css/all.css\" /> \n</head>\n<body>\n<a href=\"/test.aspx\">Test</a>\n<a href=\"http://mysite.com\">Test</a>\n<img src=\"/images/test.jpg\"/>\n<img src=\"http://mysite.com/images/test.jpg\"/>\n</body>\n</html>";
        string pattern = "((?:src|href)[\\s]*?)(?:\\=[\\s]*?[\\\"\\\'])[\\/*\\\\*]?(?!..+[s]?\\:[\\/]*)(.*?)(?:[\\s\\\"\\\'])";
        var reg = new Regex(pattern, RegexOptions.IgnoreCase);
        string prefix = @"http://mysite.com";
        var result = reg.Replace(input, "$1=\""+prefix+"$2\"");
    } 
```

结果是

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="http://mysite.com/css/all.css" /> 
</head>
<body>
<a href="http://mysite.com/test.aspx">Test</a>
<a href="http://mysite.com">Test</a>
<img src="http://mysite.com/images/test.jpg"/>
<img src="http://mysite.com/images/test.jpg"/>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:33:10.120

看看这个，它可以帮助你。

它采用以下格式：**http(s)://domain(:port)/AppPath** )

```
HttpContext.Current.Request.Url.Scheme + "://" + HttpContext.Current.Request.Url.Authority + HttpContext.Current.Request.ApplicationPath; 
```

或者你可以使用：

```
Page.ResolveUrl("img/youFile"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-20T19:55:05.617

看看这个函数：

```
Private Function ConvertALLrelativeLinksToAbsoluteUri(ByVal html As String, ByVal PageURL As String)
    Dim result As String = Nothing
    ' Getting all Href
    Dim opt As New RegexOptions
    Dim XpHref As New Regex("(href="".*?"")", RegexOptions.IgnoreCase)
    Dim i As Integer
    Dim NewSTR As String = html
    For i = 0 To XpHref.Matches(html).Count - 1
        Application.DoEvents()
        Dim Oldurl As String = Nothing
        Dim OldHREF As String = Nothing
        Dim MainURL As New Uri(PageURL)
        OldHREF = XpHref.Matches(html).Item(i).Value
        Oldurl = OldHREF.Replace("href=", "").Replace("HREF=", "").Replace("""", "")
        Dim NEWURL As New Uri(MainURL, Oldurl)
        Dim NewHREF As String = "href=""" & NEWURL.AbsoluteUri & """"
        NewSTR = NewSTR.Replace(OldHREF, NewHREF)
    Next
    html = NewSTR
    Dim XpSRC As New Regex("(src="".*?"")", RegexOptions.IgnoreCase)
    For i = 0 To XpSRC.Matches(html).Count - 1
        Application.DoEvents()
        Dim Oldurl As String = Nothing
        Dim OldHREF As String = Nothing
        Dim MainURL As New Uri(PageURL)
        OldHREF = XpSRC.Matches(html).Item(i).Value
        Oldurl = OldHREF.Replace("src=", "").Replace("src=", "").Replace("""", "")
        Dim NEWURL As New Uri(MainURL, Oldurl)
        Dim NewHREF As String = "src=""" & NEWURL.AbsoluteUri & """"
        NewSTR = NewSTR.Replace(OldHREF, NewHREF)
    Next
    Return NewSTR
End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-09T07:23:03.693

这对我很有用。我在电子邮件模板上使用它。我在每个链接的开头使用 MVC/Razor“~/”。

```
' Parse HTML and make relative links absolute with p_basepath
Public Function ParseHTMLLinks(ByVal MailBodyHTML As String) As String
    ' Declare & intialize variables
    Dim strHTMLBody As String = MailBodyHTML

    ' Set regex variables 
    Dim strSrcSubMatch As String = ""
    Dim strSrcFullUrl As String = ""
    Dim srcPattern As String = "[=""]\/?([^""\s]*(\.gif|\.jpg|\.jpeg|\.png|\.css|\.js))[""\s]"
    Dim srcOptions As RegexOptions = RegexOptions.IgnoreCase
    Dim regex As Regex = New Regex(srcPattern, srcOptions)
    Dim regexSub As Regex = New Regex(srcPattern, srcOptions)
    Dim Matches As MatchCollection = regex.Matches(strHTMLBody)

    Try
        For Each Match As Match In Matches
            ' filter out absolute links
            If InStr(Match.ToString, "://") = 0 And InStr(LCase(Match.ToString), "mailto:") = 0 And InStr(LCase(Match.ToString), "javascript:") = 0 Then
                ' Remove the " at each end of relative path
                strSrcSubMatch = regexSub.Replace(Match.ToString, "$1")
                ' Concatenate the FullPath
                strSrcFullUrl = p_basePath & strSrcSubMatch
                ' Execute the replace
                strHTMLBody = Replace(strHTMLBody, "/" & strSrcSubMatch, strSrcFullUrl)
            End If
        Next

    Catch e As WebException
        'Add errors to List(Of WebException), if any.
        ErrorCodes.Add(e)
    End Try

    Return strHTMLBody 'MailBodyHTML
End Function 
```

# c++ - 用于设置相关类属性的映射的合理键类型？

> ID：12253613
> 
> 赞同：1
> 
> 时间：2012-09-03T20:21:48.527
> 
> 标签：c++

我打算编写一个代码，其类具有如下继承关系并具有与材料类型相关的各种属性：

1.  抽象基类`Foo`。没有与之相关的属性。
2.  `Foo1GeneralElastic`继承自类 Foo 并具有与*可能*的各向异性弹性材料相关的属性。
3.  `Foo2GeneralElastic`也继承自类 Foo 并具有与 相同种类的材料属性`Foo1GeneralElastic`，但在其他方面有所不同。
4.  `Foo1PiezoElastic`继承自`Foo1GeneralElastic`并具有压电特性以及通用弹性特性。
5.  `Foo1IsotropicElastic`继承自`Foo1GeneralElastic`，但不共享其属性。

我决定抽象基类将具有一个或多个采用类型映射的方法`MyPropMap`，定义为：

```
typedef std::map<PropertyLabel,std::vector<double> > MyPropMap 
```

关于 PropertyLabel 类型可能是什么，我有几个不同的选项，我正在尝试权衡每种选项的优缺点：

**让 PropertyLabel 成为`enum`**：这将是轻量级的，但它基本上是一袋标签，用于我正在考虑的每种材料的所有不同属性。

**让 PropertyLabel 只是一个`int`**: 在这里，我将为每种材料类型提供单独的头文件，每个头文件都包含静态整数常量的定义，这些常量将是相关材料属性的标签。例如，`MatPropKeyGenElastic.hpp`将定义整数常量`ELASTICITY_MATRIX`，`MatPropKeyIsotropicElastic.hpp`将定义常量`ELASTIC_MODULUS`和`POISSONS_RATIO`，并将`MatPropKeyPiezoElastic.hpp`文件`#include`和`MatPropKeyGenElastic.hpp`另外定义常量`PIEZO_CONST_MATRIX`。

棘手的事情是确保可以一起使用的所有常量都不具有相同的值。这可以通过使用脚本生成头文件来实现，该脚本将这些常量的值设置为唯一值。

**让 PropertyLabel 成为一个`std::string`**从这里我可以采取几种不同的方式。我可以只`"ELASTICITY_MATRIX"`在代码中使用字符串文字，并依赖这些文字永远不会拼写错误——一个会在运行时而不是编译时捕获的错误。我可以用类似于上述整数常量方案的方式定义字符串常量，并且保持常量唯一的任务将是微不足道的：只需设置to的值、 `ELASTICITY_MATRIX`to`"ELASTICITY_MATRIX"`的值等。`POISSONS_RATIO``"POISSONS_RATIO"`

除了额外的开销之外，我看到的问题是我看到了与非 POD 的全局静态常量相关的恐怖故事，例如[非整数常量](https://stackoverflow.com/questions/2151831/non-integral-constants/)和[定义类字符串常量主题中的评论中的那些C++？](https://stackoverflow.com/questions/459942/defining-class-string-constants-in-c/). 我想我可以让全局静态常量是数组，它们是当用作映射键时`const char[]`会隐式转换为 s 的 POD （并且，*不*，我不打算让映射键本身成为）。我还可以使用预处理器定义字符串文字，但是我无法将它们保存在命名空间中。`std::string`*`const char*`*

 *您会推荐上述任何一种方法吗？里面有没有我没注意到的隐藏陷阱？您还有其他方法可以推荐吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T23:00:59.310

我不建议使用字符串。对于这么简单的任务来说太贵了。我投票给枚举。

但是，如果将所有标签常量放在一个地方看起来太难看，您可以制定更复杂的方法 - 使用像两个数字对的复合键 - （类 ID，属性 ID）。

两者都可以定义为枚举，也可以是嵌套的。此外，类 ID 可以自动生成 - 例如使用`reinterpret_cast`on`std::type_info`指针或仅使用`std::type_info`指针或`std::type_index`如果支持。用代码说明想法：

```
// PropertyLabel type, could be used as associative container key
struct PropertyLabel: std::pair<const std::type_info*, int>
{
  // Template ctor allows implicit conversion from enums
  // (actually not only from enums but from any int-compatible types)
  // Uncomment explicit keyword if implicit conversions scares you and use
  // explicit conversion syntax - PropertyLabel(smth).
  template <typename T> /*explicit*/ PropertyLabel(T label):
     std::pair<const std::type_info*, int>(&typeid(T), label)
  {
  }
};

// First property holder 
class PropertyUser1
{
public:
  enum Labels
  {
     eProperty1,
     eProperty2,
     eProperty3,
  };
 };

// Second property holder 
class PropertyUser2
{
public:
  enum Labels
  {
     eProperty1,// Due to class scope you could use same names for different properties
     eProperty2,
     eProperty3,
  };
 };

// Usage. A bit dangerous due to implicit conversions, but intuitive and handy:
MyPropMap properties;
properties[PropertyUser1::eProperty1].push_back(42.0);
properties[PropertyUser2::eProperty1].push_back(42.42);
// Will be with explicit ctor:
// properties[PropertyLabel(PropertyUser1::eProperty1)].push_back(42.0);
// properties[PropertyLabel(PropertyUser2::eProperty1)].push_back(42.42); 
```

看起来它可以通过更多的类型安全性来改进，消除使用非枚举类型的可能性`int`，例如禁用调用`PropertyLabel(42)`。但这只是为了说明想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T21:55:48.537

我刚刚意识到一个相对简单的解决方案，它可以给我几乎我想要的东西，而不必大惊小怪。对于该`MyPropMap`类型的任何特定实例，我正在处理*一种*特定材料的属性：各向同性弹性、压电、各向异性弹性等。鉴于此，我可以将每种材料类型对应的枚举包装在自己的命名空间中，并将它们放在适当的头文件中，例如，

```
// MatPropKey/IsotropicElastic.hpp:
namespace IsotropicElastic {
   enum { ELASTIC_MODULUS, POISSONS_RATIO };
}

// MatPropKey/GenElastic.hpp
namespace GenElastic {
   enum { ELASTICITY_MATRIX }
}

// MatPropKey/PiezoElastic.hpp
namespace PiezoElastic {
   enum { PIEZO_CONST_MATRIX, ELASTICITY_MATRIX }
} 
```

这里有一些冗余，但我可以忍受。只要我坚持上述约定，那么在每个命名空间中，`enum`值都是唯一的，并且只要我只`enum`为每个实例使用特定命名空间中的值`MyPropMap`---无论如何我都想做---我没事。（实际上，我还想将这些命名空间中的每一个都包装在一个公共`MPKey`命名空间中。）当然，这并不是万无一失的。例如，一个足够有创意的傻瓜可能会决定`#include`两者都使用`GenElastic.hpp`，`PiezoElastic.hpp`然后`GenElastic::ELASTICITY_MATRIX`与`PiezoElastic::PIEZO_CONST_MATRIX`. 坏事可能会发生。尽管如此，代码还是传达了命名常量应该如何分组，避免不必要的名称冲突是微不足道的。

希望我早点想到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T02:17:26.987

经过一番思考，我意识到了一些事情：

1.  最好将地图包装在一个类中，这样我就可以更好地控制它的编写方式。
2.  甚至包装的地图也是通用的，并且必须能够适应任何材质参数类型，因此我只能提供这么多的编译类型安全性。

鉴于此，我决定`MatProp`大致设计一个类如下：

```
#include <vector>
#include <map>

class MatProp {
public:
   // Skipping the constructor details ...

   void setProp_Raw(int propId, double val);
   void getProp_Raw(int propId, double & val) const;

   void setProp_Raw(int propId, const std::vector<double> & vals);
   void getProp_Raw(int propId, std::vector<double> & vals) const;

   // More overloaded set/get funcs for complex scalars and vectors ...

private:
   // The typedef allows me to write MatPropMap_::iterator, etc. in the
   // implementation of the member functions, which is handy if, say, 
   // I want to swap the std::map for an unordered_map later on.
   typedef std::map<PropertyLabel,std::vector<double> > MatPropMap_;

   MatPropMap_ matPropMap_;

}; 
```

set/get 函数带有后缀，`_Raw`因为很容易将属性 ID 和值的错误组合放入。我可以将信息传递给 的构造函数，`MatProp`以便可以在运行时验证这些函数的输入，但是设置它可能会变得笨重并使类更难使用。为了增加一些额外的安全性，我可以这样做，例如：

```
void setIsotropicLinearElasticParameter(MatProps mProp,
          ElasPropEnum propId, // ELASTIC_MODULUS and POISSONS_RATIO are the 
                               // *only* valid values of this parameter.
          double val) {
    mProp.setParam_Raw(propId, val);
} 
```

该功能很简单，但我明确声明（1）只允许两个键和（2）它们确实应该是 type `double`。该界面并非完全万无一失，但正确使用它相当容易，并且需要一些努力才能使用错误。FWIW，在这里做了类似的事情：[http](http://blog.knatten.org/2010/04/23/make-apis-hard-to-use-incorrectly/) ://blog.knatten.org/2010/04/23/make-apis-hard-to-use-incorrectly/ 。*

# crc - 推荐用于数据记录应用的 CRC16 多项式

> ID：12253614
> 
> 赞同：0
> 
> 时间：2012-09-03T20:21:49.777
> 
> 标签：crc, error-detection

我正在编写一个数据记录应用程序（在微控制器上运行），它将数据写入普通的嵌入式 NOR 型串行闪存（在本例中为 AT25DF161。）

每个数据包（240 或 496 字节）将一个接一个地单独记录到闪存中。我认为闪存中最常见的故障是卡住位 - 通常是“0”，即未擦除状态。我需要能够检测单个位事件，通常每条记录最多两个（我假设这是 100,000 次写入周期后的最坏情况。）

我正在使用具有内置 16 位 CRC 计算模块的处理器，因此使用更少或更多项对性能没有影响 - 那么我需要做出哪些决定来确定最佳多项式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:16:29.060

查看 Philip Koopman 的论文“用于嵌入式网络的循环冗余码 (CRC) 多项式选择”。他分析了许多 16 位多项式，测量了它们对不同消息长度的错误检测能力。正如您从他的论文中看到的那样，它们并非都是平等的。对于少量错误（在您的情况下为 HD=2）和相当大的块，0xBAAD 可能是一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:27:56.253

使用标准多项式。[您可以在此处](http://reveng.sourceforge.net/crc-catalogue/16.htm)找到可供选择的列表。

# .htaccess - htaccess 从不再存在的文件夹中重定向 301

> ID：12253615
> 
> 赞同：0
> 
> 时间：2012-09-03T20:21:51.273
> 
> 标签：.htaccess

我已经阅读了许多网站，他们都说不同的东西。在我的朋友网站上，他的博客以前是 www.bellastairs.com/news 现在它只是主页，所以 www.bellastairs.com。

将不再存在的任何点击重定向到新闻以重定向到主页的最简单方法是什么？

例如[谷歌](http://www.google.com/search?client=safari&rls=en&q=glass%20stairs%20miami&ie=UTF-8&oe=UTF-8)搜索玻璃楼梯迈阿密。

他是第二个环节，但现在已经死了。有没有一种简单的方法可以更改 htaccess 以将其永久重定向到他的主页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:27:04.337

将其放入文档根目录的 htaccess 文件中：

```
RedirectMatch 301 ^/news / 
```

# c++ - A* 什么是开放集的最佳数据结构？

> ID：12253616
> 
> 赞同：8
> 
> 时间：2012-09-03T20:21:59.803
> 
> 标签：c++, data-structures, a-star

我是第一次开发 A*，并且我使用 priority_queue 作为开放集，直到我意识到您需要检查节点是否也在开放集中，而不仅仅是关闭集。

问题是，您不能迭代优先级队列..那么为什么每个人都推荐开放集的优先级队列？它还是最好的选择吗？我认为迭代它的唯一方法是制作一个副本，以便我可以从中弹出所有内容（巨大的成本）。

在 A* 上使用的最佳数据结构是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T22:54:16.037

优先级队列 (PQ) 是一种抽象数据结构 (ADS)。有很多实现它们的可能性。不幸的是，C++ 标准库提供的 priority_queue 相当有限，其他实现更适合实现 A*。剧透：你可以使用 std::set/multiset 代替 std::priority_queue。但请继续阅读：

那么你需要从优先级队列中实现 A* 的是：

1.  获取成本最低的节点
2.  降低任意元素的成本

任何优先级队列都可以做到 1.，但对于 2.，您需要一个“可变”优先级队列。标准库不能做到这一点。此外，您需要一种简单的方法来查找优先级队列中的条目，以找出减少密钥的位置（当 A* 找到通往已打开节点的更好路径时）。有两种基本方法：您在图形节点中存储优先级队列元素的句柄（或使用映射来存储每个图形节点的句柄） - 或者您自己插入图形节点。

对于第一种情况，您存储每个节点的句柄，您可以使用 std::multiset 作为优先级队列。std::multiset::first() 将始终是您的“最低成本”键，您可以通过从集合中删除键、更改值并重新插入以及更新句柄来减少键。或者，您可以使用 Boost.Heap 中的可变优先级队列，它直接支持“减少键”。

对于第二种情况，您将需要某种“侵入式”二叉树 - 因为您的寻路节点本身需要位于优先级队列中。如果您不想自己滚动，请参阅 Boost.Intrusive 中的有序关联容器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T20:37:15.333

主题非常大，如果您想了解不同的可能性并很好地了解哪种数据结构适合您的情况，我建议您阅读此页面：http: [//theory.stanford.edu/~amitp/GameProgramming/ ImplementationNotes.html#set-representation](http://theory.stanford.edu/~amitp/GameProgramming/ImplementationNotes.html#set-representation)

就我而言，二叉堆在实现难度和性能之间取得了很好的平衡，这完全是我想要的。但也许你正在寻找不同的东西？

文档的其余部分是 A* 游戏开发的很好参考 [http://theory.stanford.edu/~amitp/GameProgramming/index.html](http://theory.stanford.edu/~amitp/GameProgramming/index.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-03T21:46:53.557

它们的意思是优先级队列不一定是语言附带的 std::priority_queue 类。如果内置的没有做你需要它来写你自己的，或者找到另一个。

# ios - 单击更新 iOS 证书时出错

> ID：12253618
> 
> 赞同：22
> 
> 时间：2012-09-03T20:22:00.743
> 
> 标签：ios, xcode

当我使用管理器并单击“更新”按钮时，我收到以下错误：

1.  Ad Hoc：“没有带有‘XP...在这个团队’的 iOS 证书”

2.  App Store：“没有为参数‘deviceids’提供值”

我不确定为什么会收到这些错误，并希望得到任何帮助/指导。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T01:51:31.423

我有同样的问题，我什至无法在开发者门户中在线修改它。我是这样解决的：

在配置文件选项卡的组织者中，我单击了右下角的刷新。它为我生成了一些东西（比如开发者资料）。我仍然必须为应用程序更新我的配置文件，但按钮仍然不起作用（但现在错误是：“没有为参数 'certificateids' 提供值”）。

但是如果我可以手动进行，现在可以在 Developer Portal 中单击修改。

我希望它会帮助某人。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-05T13:59:03.610

使用开发者门户而不是 xcode 来更新您的证书。 [https://developer.apple.com/devcenter/ios/index.action](https://developer.apple.com/devcenter/ios/index.action)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-04T15:18:00.397

我有一个类似的错误：

> 没有为参数“appIdName”提供值。

解决方案类似。通过浏览器下载配置文件。干杯。

# javascript - 如何测试 CasperJS 中是否存在选择器？

> ID：12253623
> 
> 赞同：16
> 
> 时间：2012-09-03T20:22:27.370
> 
> 标签：javascript, casperjs

我知道我可以使用：

```
casper.test.assertExists(#selector); 
```

但我想实际存储它是否存在于布尔变量中。

即是这样的：

```
var exists = SelectorExists(#selector); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-03T20:47:48.330

我刚发现：

```
if(!casper.exists('#selector')){
   #selector doesn't exist
} 
```

# ios - 按下按钮后传递参数以在 IOS 中查看

> ID：12253626
> 
> 赞同：1
> 
> 时间：2012-09-03T20:22:47.153
> 
> 标签：ios, xcode

我是IOS编程的新手。到目前为止，我一直在用 android 编程。所以在android中，当按下按钮传递参数时，代码会是这样的：

```
Intent i = new Intent(MainScreen.this,OtherScreen.class);
Bundle b = new Bundle();
b.putString("data_1",data);
i.putExtras(b);
startActivity(i); 
```

在打开的活动中，我会写这样的东西：

```
Bundle b = getIntent().getExtras();
ski_center=b.getString("data_1"); 
```

我应该在 IOS 的 MainScreen 和 OtherScreen 中更改哪些方法才能实现上述目的。

基本上我将在我的 MainScreen 中有 3 个按钮，每个按钮都会打开 Otherview，但每次都会传递不同的参数。

每个按钮的敌人示例我在 MainScreen.m 中有这样的代码

```
@synthesize fl;
-(IBAction) ifl:(id) sender {
} 
```

所以我也需要你的帮助来放置“丢失”的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:27:54.060

为您的 UIViewController（Android 的 Activity）声明一个 iVar，就像 Java 中的一个属性一样。

在 MainViewController.m

```
OtherUIViewController * contr = [[OtherUIViewController alloc] initWithNibname...];
contr.data = yourData; 
```

编辑：添加完整代码...

Intent i = new Intent(MainScreen.this,OtherScreen.class); 捆绑 b = 新捆绑（）；b.putString("data_1",data);

这里 MainScreen 是调用代码，现在在 iOS 中它将是 MainUIViewcontroller

*   像这样创建一个 OtherUIViewController：

其他UIViewController.h

```
@interface OtherUIViewController : UIViewController
{
       NSData* data;
}
@property (strong, nonatomic) NSData* data; 
```

在 OtherUIViewController.m

```
@implementation OtherUIViewController.m
@synthetize data;

// override
- (void)viewDidLoad
{
    [super viewDidLoad];
// do something with data here
} 
```

要具有 3 种不同的行为，数据可以是 int 或 NSString。在其中， `- (void)viewDidLoad`您将检查`data`值并做 3 件不同的事情。

我希望它有帮助

# ruby-on-rails-3 - 在应用程序控制器中找不到方法

> ID：12253631
> 
> 赞同：0
> 
> 时间：2012-09-03T20:23:01.463
> 
> 标签：ruby-on-rails-3, omniauth

我一直在尝试使用设计进行身份验证，然后使用omniauth，但我无法获得用户会话。

在我的应用程序控制器中，我有

```
类 ApplicationController < ActionController::Base

    防止伪造

私人的
    定义当前用户
        @current_user ||= User.find(session[:user_id]) if session[:user_id]
    结尾
    helper_method :current_user

结尾

```

我从更新后的 railscast [https://github.com/railscasts/241-simple-omniauth/blob/master/revised/blog-after/app/controllers/application_controller.rb](https://github.com/railscasts/241-simple-omniauth/blob/master/revised/blog-after/app/controllers/application_controller.rb)

在我的应用程序中，我调用

```
<% if current_user %>

```

但这总是错误为`undefined local variable or method 'current_user'`

为什么是这样？这是我的应用程序控制器的问题，还是rails的会话错误？

# actionscript-3 - as3 使用 airxzip 压缩和解压缩文件

> ID：12253633
> 
> 赞同：1
> 
> 时间：2012-09-03T20:23:20.367
> 
> 标签：actionscript-3, flash, actionscript, zip, unzip

我想使用 airxzip，但我不知道如何下载源文件以及如果我下载源文件的位置。

我很抱歉在这方面是个新手。

谢谢你的尽心帮助。

下面是我试图访问的 zip/unzip as3 代码的链接。

[http://flex.coltware.com/2010/05/01/as3-zip-unzip-lib-airxzip/](http://flex.coltware.com/2010/05/01/as3-zip-unzip-lib-airxzip/)

下面是“解压缩”的示例，但我不知道如何下载文件以进行导入。

```
// ActionScript file
import com.coltware.airxzip.ZipEntry;
import com.coltware.airxzip.ZipError;
import com.coltware.airxzip.ZipFileReader;
import com.coltware.airxzip.*;

import flash.filesystem.File;
import flash.utils.ByteArray;

use namespace zip_internal;

public function unzip_init(filename:String):ZipFileReader{
        var reader:ZipFileReader = new ZipFileReader();
        var file:File = File.desktopDirectory.resolvePath(filename);
        reader.open(file);
        return reader;
}

public function unzip_sample1():void{
        var reader:ZipFileReader = unzip_init("new_airxzip.zip");
        var list:Array = reader.getEntries();

        for each(var entry:ZipEntry in list){

                if(entry.isDirectory()){
                        log.debug("DIR  --->" + entry.getFilename());
                }
                else{
                        log.debug("FILE --->" + entry.getFilename() + "(" + entry.getCompressRate() + ")");
                }
        }
}

public function unzip_sample2():void{
        var reader:ZipFileReader = unzip_init("new_airxzip.zip");
        var list:Array = reader.getEntries();

        for each(var entry:ZipEntry in list){
                if(!entry.isDirectory()){
                        if(entry.getFilename() == "sample.txt"){
                                var bytes:ByteArray = reader.unzip(entry);
                                log.debug("sample.txt : " + bytes);
                        }
                }
        }
}

public function unzip_sample3():void{
        var reader:ZipFileReader = unzip_init("crypto_airxzip.zip");
        reader.setPassword("pass");
        var list:Array = reader.getEntries();

        for each(var entry:ZipEntry in list){
                if(!entry.isDirectory()){
                        if(entry.getFilename() == "sample.txt"){
                                try{
                                        var bytes:ByteArray = reader.unzip(entry);
                                        log.debug("sample.txt : " + bytes);
                                }
                                catch(e:ZipError){
                                        log.warn(entry.getFilename() + ":" + e.message);
                                }
                        }
                }
        }
}
public function unzip_sample4():void{
        var reader:ZipFileReader = unzip_init("abc.zip");
        var list:Array = reader.getEntries();
        for each(var entry:ZipEntry in list){
                entry.dumpLogInfo();
        }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T21:45:13.557

## **`Flash Builder`**

* * *

**`1\. Download the SWC File.` [压缩包](http://code.google.com/p/airxzip/downloads/detail?name=coltware_airxzip_v1_0_1.swc&can=2&q=)**

![在此处输入图像描述](../Images/967ea5ba0eaed3eac17dc54af1fd6b4f.png)

* * *

**`2\. In your flash builder project make a`库`folder. and downloaded SWC files drag and drop or copy.`**

![在此处输入图像描述](../Images/63c1095b963165022b1a3c8baab51258.png) ![在此处输入图像描述](../Images/f63748fbf407400f067a10f5a1bb4ac4.png)

* * *

**`3\. In your project mouse right click and Properties click.`**

![在此处输入图像描述](../Images/b0207c7e89bbab89e9e5f38a3c5541e8.png)

* * *

**`4\. Actionscript Build Path - Library Path - Add SWC Folder click and input a libs`**

![在此处输入图像描述](../Images/77efd6fb6a5b220cd60c828d8c61541d.png) ![在此处输入图像描述](../Images/ddfe0814ef2f51a267d1a84f558f2dd8.png)

* * *

* * *

## **`Flash (below image Mac OS)`**

**`1\. File-ActionScript Settings Click`**

![在此处输入图像描述](../Images/3997e6c5d2d35d0af424a2526429d1b3.png)

* * *

**`2\. Browse to SWC File icon Click. and downloaded your SWC File link.`** ![在此处输入图像描述](../Images/fcb872c723cbb7f41222922e0c592131.png) ![在此处输入图像描述](../Images/58b7151ce1e11a2bd7b0b7a83a26c4c1.png)

* * *

**`3\. publish setting, Target set a AIR2.5 or AIR 3.X ios or AIR 3.X Android.`**

![在此处输入图像描述](../Images/da8a0bc4750563775ae47352f151d840.png)

* * *

**`4\. check out below my sample code. I tested.`** 这是一个示例代码。[simple_unzip](http://www.datafilehost.com/download-ee5e9ef7.html)

```
import com.coltware.airxzip.ZipEntry;
import com.coltware.airxzip.ZipError;
import com.coltware.airxzip.ZipFileReader;
import com.coltware.airxzip.*;

import flash.filesystem.File;
import flash.utils.ByteArray;
import flash.net.FileReference;
import flash.net.FileFilter;

var file:File;
var fileReference:FileReference;
var fileFilter:FileFilter;

function unzip_init():void{

    fileFilter = new FileFilter("selected your zip file.", "*.zip; .gz2; .bz2;");
    file = new File();
    file.browseForOpen("\Users", [fileFilter]);
    file.addEventListener(Event.SELECT, onSelectedFile);
}

function onSelectedFile(e:Event):void
{
    var reader:ZipFileReader = new ZipFileReader();
    reader.open(file);

    var list:Array = reader.getEntries();

        for each(var entry:ZipEntry in list){

                if(entry.isDirectory()){
                        trace("DIR  --->" + entry.getFilename());
                }
                else{
                        trace("FILE --->" + entry.getFilename() + "(" + entry.getCompressRate() + ")");
                }
        }
}

unzip_init(); 
```

从现在开始，可以查看示例代码。默认环境已完成。

`What's the SWC?`

> Adobe SWC 文件是预编译的 Flash 符号和 ActionScript 代码包，允许 Flash 或 Flex 开发人员分发类和资产，或避免重新编译不会更改的符号和代码。

# python - Python在for循环中添加对象

> ID：12253635
> 
> 赞同：0
> 
> 时间：2012-09-03T20:23:22.013
> 
> 标签：python, list, for-loop

我有以下代码

```
 old_county_code = -1
    old_placement_id = -1
    placements = []
    for row in raw_data: #raw_data is one line from the database retrieved by cursor.fetchall()

        placement_id = row[1]
        if placement_id != old_placement_id:
            placement = Objects.placement()
            placement.placement_id = placement_id
            placements.append( placement )

        country_code = row[3]
        if old_county_code != country_code:
            country = Objects.country()
            country.country_id = country_code 
            placement.countries.append( country )                

        creative = Objects.creative( row[2], row[0], row[4], row[5], row[6], row[7] )
        country.creatives.append( creative )

        old_placement_id = placement_id
        old_county_code = country_code 
```

对象放置包含一个国家列表，这些国家本身包含一个广告素材列表。因此，当我运行此代码时，我注意到每个展示位置具有完全相同数量的国家/地区对象，包含在列表对象placement.countries 中。其实这不可能。我想我在代码中做错了，但我不知道是什么。

这是对象代码

```
class placement(object):
    placement_id = 0
    countries = []

class country(object):
    country_id = 0
    creatives = []

class creative(object):
    creative_id = 0
    matching_id = 0
    clicks = 0
    impressions = 0
    ctr = 0.0
    rank = 0.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:36:51.760

使内部变量基于实例而不是基于类....

```
class placement(object):
  def __init__(self):
    self.placement_id = 0
    self.countries = []

class country(object):
  def __init__(self):
    self.country_id = 0
    self.creatives = []

class creative(object):
  def __init__(self)
    self.creative_id = 0
    self.matching_id = 0
    self.clicks = 0
    self.impressions = 0
    self.ctr = 0.0
    self.rank = 0.0 
```

# java - SQLiteOpenHelper - 数据库是如何创建的？

> ID：12253636
> 
> 赞同：11
> 
> 时间：2012-09-03T20:23:38.247
> 
> 标签：java, android, database, sqlite, sqliteopenhelper

我正在制作一个数据库应用程序，我的程序可以运行，并且我已经理解了我一直在关注的大部分教程。但是，我仍然不清楚一个方面。

MyDBHelper 有一个内部类扩展 SQLiteOpenHelper。*外部*变量包括名为 d 的 SQLiteDatabase。MyDBHelper 的代码是：

```
private static class MyDBHelper extends SQLiteOpenHelper {
        MyDBHelper(Context c) {
            super(c, DB_NAME, null, DB_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            try {
                db.execSQL(DATABASE_CREATE);
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVers, int newVers) {
            Log.w(TAG, "Upgrading database from version " + oldVers + " to " + newVers + ", which will destroy all old data.");
            db.execSQL("DROP TABLE IF EXISTS GM");
            onCreate(db);
        }
    } 
```

我的问题是这实际上是如何创建初始数据库的。它发生在 onCreate() 方法中，但据我所知，它**从未**被调用过。我知道第一次创建数据库时会调用它，但是在哪里呢？此外，它是如何传递一个 SQLiteDatabase 数据库的？我没有将任何数据库传递给该方法。我的 SQLiteDatabase db 变量如何从*外部*类设置为创建的数据库？有人能像白痴一样告诉我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T20:33:16.050

`onCreate()`和`onUpgrade()`方法真的是在创建 Db 时第一次调用。事实上，它是在`getReadableDatabase() or getWritebleDatabase()`方法中检查的`SQLiteOpenHelper`。它将检查数据库是否已经存在于数据目录中以及它的版本是什么。据此，它要么调用`onCreate(), or onUpgrade()`. 或者什么都没有，如果 db 文件存在并且版本正确。

您可以搜索您的代码以执行`myDBHelper.getReadable(Writable)Database()`. 这就是将执行此检查的时间。

如果需要更多详细信息，请告诉我。祝你好运

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T20:33:39.740

`getReadableDatabase()`请记住，您正在扩展 SQLiteOpenHelper，所有的魔法都发生在这个超类中，特别是当您调用或时最初创建（或只是重新打开）数据库`getWritableDatabase()`。这两种方法：

*   定义`SQLiteDatabase db`变量（和控制传递`db`给你的回调方法）
*   `db`通过调用您的`onCreate(db)`方法或打开现有数据库进行初始化
*   检查版本号，如有必要，请致电您的`onUpgrade(db)`或`onDowngrade(db)`

他们还调用了更多的回调方法，例如`onConfigure(db)`,`onOpen(db)`等。（[阅读](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)有关这些方法的更多信息。）如果有帮助，您可以自己阅读[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/database/sqlite/SQLiteOpenHelper.java#SQLiteOpenHelper)以了解所有这些发生的方式和时间的结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:40:08.170

onCreate() 方法不是此类的构造函数。创建数据库时会调用 onCreate。

这里 PeopleDB 扩展了 SQLiteOpenHelper。此代码来自不同的类，并且在 getWritableDatabase() 或 getReadableDatabase() 或任何此类调用时调用 onCreate

```
 PeopleDB db = null; //onCreate NOT called here
  db=new PeopleDB(getContext());
  db.getWritableDatabase();  //onCreate is called here! 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T20:48:07.660

看到我们的数据库是在 openhelper 的构造函数本身中创建的，而不是在覆盖的 onCreate 方法中创建的。在 onCreate 方法中，我们正在触发一个查询以在数据库中创建一个表，该表是在 open helper 的构造函数中创建的，用于插入数据而不是创建数据库。

另一件事是 SQLiteDatabase 对象未在 SQLiteOpenHelper 类中实例化。它在您要使用数据库执行数据库操作的类中实例化，您需要编写这样的函数来初始化或打开数据库以准备插入。

```
SQLiteDatabase database;

YourOpenHelper yourOpenHelper=new YourOpenHelper(); //to creating database using openhelper and automatically call onCreate to make a table in that

    public void open() throws SQLException {
            database = profiloHelper.getWritableDatabase();
        } 
```

这是您必须为数据库中的任何操作（如插入删除任何内容）编写的代码，您只需更改 QUERY

```
SQLiteStatement insert_stmt = null;

        try {
            insert_stmt = database.compileStatement(YOUR_QUERY);

            insert_stmt.bindString(1,   field1);
            insert_stmt.bindString(2,   field2);
            insert_stmt.executeInsert();
        }
        finally {
            if (insert_stmt != null) insert_stmt.close();
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T20:33:35.247

可能，在他们第一次被召唤时`getReadableDatabase()`或`getWriteableDatabase()`当他们第一次被召唤时

* * *

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-02T19:40:43.687

您创建一个实现 onCreate(SQLiteDatabase)、onUpgrade(SQLiteDatabase, int, int) 和可选的 onOpen(SQLiteDatabase) 的子类，并且此类负责打开数据库（如果存在），如果不存在则创建它，并根据需要进行升级. （Android 开发者网站）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-25T03:48:45.063

这门课`SQLiteOpenHelper`被称为“助手”是有充分理由的。它为我们的应用程序编写者节省了大量的精力。

第**一次**为实现调用`getWritableDatabase`（或`getReadableDatabase`）时`SQLiteOpenHelper`，构造函数中的`super`语句将当前和您喜欢`Context`的数据库传递给 的超类构造函数。`NAME``SQLiteOpenHelper`

然后，超类构造函数为您设置初始空间`SQLiteDatabase`并为其分配您传递的名称`super`。

完成后，超类构造函数调用并传递它通过唯一参数创建`onCreate`的命名。由于只被调用一次，它是一个非常好的调用来定义数据库结构的地方。`SQLiteDatabase``onCreate``onCreate``execSQL`

`getReadableDatabase`（或）的后续执行`getWritableDatabase`只是为您打开数据库而不再调用`onCreate`. （当超类构造函数注意到`super`已经发送了不同的版本号时，`onUpgrade`被调用。）

了解`SQLiteOpenHelper`如何在没有明显代码的情况下创建数据库以及如何`onCreate`“突然”传递一个参数对我来说是一件真正的苦差事。现在我不敢相信这会很难。

# iphone - 如何在推送视图时显示 UINavigationbar 项目

> ID：12253637
> 
> 赞同：0
> 
> 时间：2012-09-03T20:24:19.200
> 
> 标签：iphone, ios, xcode, navbar

在我的 appdelagate 我有这个：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:    (NSDictionary *)launchOptions
{
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    MasterViewController *masterViewController = [[MasterViewController alloc] initWithNibName:@"MasterViewController_iPhone" bundle:nil];
    self.navigationController = [[UINavigationController alloc] initWithRootViewController:masterViewController];
    self.window.rootViewController = self.navigationController;

[self.window makeKeyAndVisible];
return YES;
} 
```

我有一个 masterview 和 detailview，masterview 是一个表格，当我在 masterview 中单击一行时会推送到 detailview，但是我添加到 detailview 的 barbutton 项目不会显示。它看起来像这样：

```
DetailViewController *detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController_iPhone" bundle:nil];

[self.navigationController pushViewController: detailViewController animated:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T23:50:25.347

我将提供您正在做的事情的替代方案，因为我不确定为什么您的项目没有显示。我的猜测是，在您推送视图控制器后，**detailViewController**中的导航栏被它的干净副本覆盖。

在`-viewDidLoad()`方法中，在**detailViewController.m**中手动添加 UIBarButtonItem。

// 创建一个标准的保存按钮 `UIBarButtonItem *saveButton = [[UIBarButtonItem alloc]`

 ````
 initWithBarButtonSystemItem:UIBarButtonSystemItemSave
              target:self
              action:@selector(saveAction:)];

saveButton.style = UIBarButtonItemStyleBordered;  
[buttons addObject:saveButton];  
[saveButton release]; 
````

# javascript - Javascript：为页面上的所有图像制作模式弹出窗口

> ID：12253640
> 
> 赞同：0
> 
> 时间：2012-09-03T20:24:44.957
> 
> 标签：javascript, wordpress, modal-dialog

我正在尝试为 Wordpress 页面上的所有图像实现弹出模式。我不想手动指定哪些图像名称将使用模态弹出窗口。我有几百页已经嵌入了图像。

有人知道我如何开始这样做吗？这可能仅与Javascript有关吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T09:08:53.150

如果您需要在弹出模式中处理所有图像，那么您可以简单地使用这个名为“Easy Fancybox”的插件。

在此处下载插件：[http ://wordpress.org/extend/plugins/easy-fancybox/](http://wordpress.org/extend/plugins/easy-fancybox/)

# jquery - jQuery移动按钮元素href没有链接到页脚

> ID：12253641
> 
> 赞同：0
> 
> 时间：2012-09-03T20:24:48.713
> 
> 标签：jquery, jquery-mobile

我正在使用 jQuery 移动框架来构建一个移动网站，并认为我的按钮 href 属性不起作用，这是与标题中的网站品牌内联运行的菜单按钮。

当用户点击以下代码时，该按钮应该将用户发送到页面的页脚：

```
<a data-role="button" href="#mainFooter" data-icon="arrow-d" data-iconpos="left" class="headerbutton">Menu</a> 
```

那么对应的 div 标签的 id 为“mainFooter”就出现在页脚中：

```
<div id="mainFooter" name="mainFooter"></div> 
```

我不明白为什么单击按钮时用户没有发送到页脚。请在下面找到指向该网页的链接。

[http://www.test-bed.co.uk/mobile/chatlive.php](http://www.test-bed.co.uk/mobile/chatlive.php)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:45:13.893

从 JQM Docs -> [Page Anatomy Section](http://jquerymobile.com/demos/1.1.1/docs/pages/page-anatomy.html)：

> 请注意：由于我们使用哈希来跟踪所有 Ajax“页面”的导航历史记录，因此目前无法在 jQuery Mobile 中深度链接到页面上的锚点 (index.html#foo)，因为框架看起来对于 ID 为 #foo 的“页面”，而不是滚动到具有该 ID 的内容的本机行为。

您可能需要使用[$.animate()](http://api.jquery.com/animate/)或类似方法来实现自定义滚动。

**编辑**

类似的东西可能对你有用：

```
$(document).delegate('.headerbutton', 'click', function(e){
    e.preventDefault();
    $("html, body").animate({ scrollTop: $('#mainFooter').offset().top }, 1000);
}); 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:50:41.053

尝试将 id 属性（id="menu-button"）添加到菜单锚点并添加以下代码：

```
$(document).on("click", "#menu-button", function(event){
    $('html,body').animate({ scrollTop: $('#mainFooter').offset().top }, { duration: 'slow', easing: 'swing'});
}); 
```

# google-apps-script - 电子邮件谷歌应用程序出错时继续使用脚本

> ID：12253645
> 
> 赞同：1
> 
> 时间：2012-09-03T20:25:13.410
> 
> 标签：google-apps-script

我在循环中使用以下代码从用户填写的电子表格发送电子邮件：

```
MailApp.sendEmail(Email, subject, body, {htmlBody: body, attachments: pdf}); 
```

问题是用户有时会误用电子邮件地址，当脚本运行并找到不正确的电子邮件地址时，它会停止脚本。

是否可以继续循环并跳过错误？谁能给我一个解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:29:32.740

您可以使用正则表达式来验证电子邮件地址。我用这个：

```
regex_mail = re.compile('^[a-z0-9][a-z0-9_.\-]*@([a-z0-9]+\.)*[a-z0-9][a-z0-9\-]+\.([a-z]{2,6})$') 
```

您可以使用 Python 异常处理和 try-except 来处理脚本错误。请参阅此问题： [AppEngine 会产生哪些邮件服务错误？](https://stackoverflow.com/questions/10283352/what-mail-service-errors-can-appengine-produce)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T01:13:17.733

如果用户使用 Google 表单填写电子表格，您应该为电子邮件字段启用验证。这不能确保地址存在，只能确保地址格式正确，但应该避免您看到的错误。

正如 voscausa 所建议的那样，在发送之前使用正则表达式进行验证仍然是明智的。

在 JavaScript 中使用`validateEmail()`来自[验证电子邮件地址？](https://stackoverflow.com/questions/46155/validate-email-address-in-javascript/46181#46181)：

```
if (validateEmail(Email)) {
  MailApp.sendEmail(Email, subject, body, {htmlBody: body, attachments: pdf});
} 
```

# css - Windows 版 Google Chrome 上 Droid 阿拉伯语的奇怪问题

> ID：12253649
> 
> 赞同：1
> 
> 时间：2012-09-03T20:25:41.307
> 
> 标签：css, font-face, arabic, webfonts

我想在我的网站上使用 Android 字体“Droid Arabic Kufi”和“Droid Arabic Naskh”，但现在我遇到了一个奇怪的问题......单词之间有换行符！

[截屏](https://dl.dropbox.com/u/4935139/ardroid.JPG)

这可能是字体的问题吗？或者它是一个浏览器错误？这个问题没有出现在 chrome for linux 上。

我已经使用[http://font2web.com](http://font2web.com)转换了字体。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T16:46:41.280

这完全是关于将间距字母设置为正常 [代码]

```
letter-spacing:normal; 
```

[/代码]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-19T11:01:03.197

在你的 CSS 中试试这个。它对我有用

```
 white-space: nowrap !important 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-07T08:26:39.650

你应该使用`class { text-rendering: geometricPrecision; }`

这将解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T14:48:37.437

在我看来，这就像`width`对包含文本的容器的声明。文本可能会向下换行以不溢出容器的边缘。

# ruby-on-rails - 未定义的属性 Task_ID

> ID：12253660
> 
> 赞同：1
> 
> 时间：2012-09-03T20:26:45.067
> 
> 标签：ruby-on-rails, ruby

所以我认为由于下面的代码而遗漏了一些东西，我已经包含了错误消息，我认为任务表没有 task_id，但是当我运行迁移以将 task_id 添加到任务时，它仍然给了我这个错误。

**路线**

```
 resources :tasks do
       resources :comment
   end 
```

**模型 - 评论**

```
class Comment < ActiveRecord::Base  
  attr_accessible :author, :comment
  belongs_to :tasks
  has_one :author
  validates :comment, :presence => true
end 
```

**模型任务**

```
class Task < ActiveRecord::Base
  attr_accessible :name, :task
  has_many :comments, :dependent => :destroy
  validates :name, :presence => true
end 
```

**评论控制器**

```
class CommentsController < ApplicationController
  def index
    @comment = Comment.new
    @comments = Comment.all
  end

  def create
    @task = Task.find(params[:id])
    @comment = @task.Comment.create(params[:task])
    redirect_to post_path(@task)
  end

end 
```

**形式 - 部分**

```
<%= form_for ([@task, @task.comments.build]) do |f| %>
    <%= f.text_area :comment %>
    <%= f.submit %>
<% end %> 
```

**什么问题？**

```
unknown attribute: task_id

Extracted source (around line #1):

1: <%= form_for ([@task, @task.comments.build]) do |f| %>
2:  <%= f.text_area :comment %>
3:  <%= f.submit %>
4: <% end %>

Trace of template inclusion: app/views/tasks/show.html.erb

Rails.root: /home/adam/Documents/Aptana Studio 3 Workspace/StartPoint
Application Trace | Framework Trace | Full Trace

app/views/forms/_comments.html.erb:1:in `_app_views_forms__comments_html_erb___445541804__622889658'
app/views/tasks/show.html.erb:5:in `_app_views_tasks_show_html_erb___428009053_87363420'

Request

Parameters:

{"id"=>"3"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:35:55.150

> 我认为任务表没有task_id，但是当我迁移以将task_id添加到任务时，它仍然给了我这个错误

你在考虑错误的表。当你这样说时：

```
class Comment < ActiveRecord::Base  
  belongs_to :task # Note that this should be singular as zeacuss notes below
end 
```

ActiveRecord 假定该`comments`表将有一`task_id`列链接回该`tasks`表。您不需要迁移来添加`tasks.task_id`，您需要迁移来添加`comments.task_id`。

[ActiveRecord 关联指南](http://guides.rubyonrails.org/association_basics.html#the-belongs_to-association)可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:45:43.307

你应该试试

```
class Comment < ActiveRecord::Base  
  belongs_to :task
end 
```

`task`不是`tasks`因为它是一对一的通信。

在此处阅读有关 belongs_to 关联的更多信息：

[属于](http://guides.rubyonrails.org/association_basics.html#the-belongs_to-association)

# android - Vuforia 图像识别是如何工作的？

> ID：12253664
> 
> 赞同：7
> 
> 时间：2012-09-03T20:27:19.617
> 
> 标签：android, computer-vision, augmented-reality

我正在使用 Vuforia SDK 构建一个 Android 应用程序，并且很好奇标记跟踪的工作原理。应用程序是否将视频帧转换为字节码，然后将它们与创建标记生成的 .dat 文件进行比较？此外，这段代码在 Vuforia 示例应用程序中的哪里找到，它在 C++ 中吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T09:40:51.650

好吧，您看不到用于识别和跟踪的代码，因为它们是高通的知识产权，通常不应透露。`Vuforia`不是开源库。

Vuforia首先检测目标图像中的“特征点”[基于Web的目标管理]，然后使用数据比较目标图像中的特征和来自相机的接收帧。

谷歌“自然特征检测和跟踪”属于计算机视觉领域，你会发现有趣的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T09:17:16.230

不，检测和跟踪代码放在 libQCAR.so 中，但是“它的工作原理”这个问题在这里很难回答。如果您想熟悉对象检测和跟踪 - 开始学习 mser、surf、sift、ferns 等方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-25T10:13:42.890

Vuforia 使用边缘检测技术。如果高对比度图像中有更多的顶点或线条，那么它对于 Vuforia 的评价很高。所以，我们可以说他们的算法有点类似于 SIFT。

# excel - 如果工作表包含下拉列表，则在访问中导入 Excel 数据时出现问题

> ID：12253667
> 
> 赞同：0
> 
> 时间：2012-09-03T20:27:43.037
> 
> 标签：excel, vba, ms-access, ms-access-2007, import-from-excel

我创建了一个 Excel 工作表，用户可以插入一些行（最多 100 行）。

某些字段的值是从下拉列表中选择的。

我把公式放在所有 100 行上。

问题是，如果用户插入的行数少于 100，则数据不会在 access 中导入。在这种情况下，仅当我从剩余行中删除下拉列表的公式时才会导入数据。

要在访问中导入 excel 数据，我使用：

```
DoCmd.TransferSpreadsheet [Transfer Type], [Spreadsheet Type], [Table Name], [File Name], [Has Field Names], [Range] 
```

我该如何解决这个问题？

**编辑**

在 Remou 的回答之后，我尝试了：

```
Private Sub import_Click()

Dim openDialog As FileDialog
Dim FileChosen As Integer

Set openDialog = Application.FileDialog(msoFileDialogFilePicker)
On Error GoTo DoNothing
With openDialog
  .title = "Import"
  .AllowMultiSelect = False
  .Show
End With

filename = openDialog.SelectedItems.Item(1)

Dim xl As Excel.Application
Dim wb As Excel.Workbook
Dim rng As Excel.Range

Set xl = CreateObject("Excel.Application")
xl.Visible = True
Set wb = xl.Workbooks.Open(nomeFile)

c = wb.Worksheets("Sheet1").Range("1:1").end(-4161).Address
r = wb.Worksheets("Sheet1").Range("A:A").end(-4121).Row

ImportRange = "Sheet1!" & "A1:" _
   & Replace(Mid(c, 1, InStrRev(c, "$")) & r, "$", "")

DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, _
"ImportTable", filename, True, ImportRange

DoNothing:
    If Err.Number = cdlCANCEL Then
    End If

End Sub 
```

但我在**Dim xl As Excel.Application上有一个调试错误**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:46:16.507

注意在使用 Excel 下拉列表和验证下拉列表进行了测试后，我发现导入带有已验证单元格或未使用范围内的下拉列表的数据没有任何问题，除了这些行被导入，即使所有其他单元格都是空的。问题可能出在数据类型和导入到现有表中。您可能必须导入到临时表，然后追加。

我建议您使用自动化来获取使用的范围并将其添加为要导入的范围。

此示例代码使用后期绑定。您可以添加对 Microsoft Excel xx 对象库的引用，因此我保留了各种定义，但如果您在多台 PC 上使用代码，则后期绑定是最好的。

```
Dim xl As Object ''Excel.Application
Dim wb As Object ''Excel.Workbook
Dim rng As Object ''Excel.Range

Set xl = CreateObject("Excel.Application")
xl.Visible = True
Set wb = xl.Workbooks.Open("z:\docs\test.xlsx")

'Choosing a column that is fully filled on sheet5
'xldown=-4121,xltoright=-4161
c = wb.Worksheets("Sheet5").Range("1:1").end(-4161).Address
r = wb.Worksheets("Sheet5").Range("A:A").end(-4121).Row

ImportRange = "Sheet5!" & "A1:" _
    & Replace(Mid(c, 1, InStrRev(c, "$")) & r, "$", "")

DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, _
    "ImportSheet2", "Z:\Docs\csharp.xlsm", True, ImportRange 
```

# javascript - simpleCart js 缩略图图像未定义

> ID：12253668
> 
> 赞同：5
> 
> 时间：2012-09-03T20:27:45.377
> 
> 标签：javascript

如果我发现有很多人问同样的问题，那是为了利益。获取要显示的缩略图。

物品设置：

```
<div class="simpleCart_shelfItem">
        <img src="images/buttons.png" alt="Sample Product" class="item_thumb" thumb="images/buttonsthumb.png">
          <h2 class="item_name"> Awesome T-shirt </h2>
        <p>  <input type="text" value="1" class="item_Quantity"><br>
          <span class="item_price">$35.99</span><br>
          <a class="item_add" href="javascript:;"> Add to Cart </a></p>
        </div> 
```

注意：图像具有类 item_thumb 和属性 thumb，其中值是缩略图图像的 url。

购物车设置：

```
simpleCart({
cartColumns: [
    { view: "image" , attr: "thumb", label: false },
    { attr: "name" , label: "Name" } ,
    { attr: "price" , label: "Price", view: 'currency' } ,
    { view: "decrement" , label: false , text: "-" } ,
    { attr: "quantity" , label: "Qty" } ,
    { view: "increment" , label: false , text: "+" } ,
    { attr: "total" , label: "SubTotal", view: 'currency' } ,
    { view: "remove" , text: "Remove" , label: false }
]
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:30:59.197

我不是专家，但这就是我让它工作的方式。希望对某人有所帮助。如果有人有更好的方法/解释，请告诉我。

# php - 预先填写的联系表格（Constant Contact 和 WordPress）

> ID：12253674
> 
> 赞同：0
> 
> 时间：2012-09-03T20:28:10.053
> 
> 标签：php, wordpress, constantcontact

客户对自定义联系表单有一个很酷的想法，但我不太确定如何设置它，也许如果我提供一些关于我们正在尝试做的事情的信息，有人可以让我知道这是否可行并指出我正确的方向。（我不太确定如何访问 API，或者是否有必要）

所以无论如何，客户都会向几个大型订阅者列表发送电子邮件通讯，它们通常包括特色产品和销售的产品信息（它们是一家葡萄酒商店）。网站上还有一个“葡萄酒定位器”表格（使用 wordpress 中的 cForms 插件），人们可以在这里查询某种葡萄酒或其他产品的可用性，或获得一般产品建议。

客户想要的是网站上的一个表格，他们可以在电子邮件活动中链接到产品信息，以便联系人可以单击产品链接并被带到客户网站上预先填充的定位器表格使用联系人的电子邮件以及从持续联系中获取的名字和姓氏，以及在葡萄酒名称文本字段中输入的特定产品名称。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:32:36.760

为什么不像这样预先填充链接：

```
http://yourdomain.gov?firstName=Name&amp;lastName=Surname&amp;email=email.address.gov@thedomain.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:34:47.833

如果链接在表格上

```
http://winecompany.com/formurl?email=name@domain.com&name=name&wine=productname 
```

然后你可以从 URI 填充表单（就像`$_GET`在 PHP 中一样）

# http - 将查询参数传递给 Erlang HTTP 请求

> ID：12253675
> 
> 赞同：1
> 
> 时间：2012-09-03T20:28:33.813
> 
> 标签：http, erlang, url-parameters

我正在尝试使用 URL 发送参数，例如`http://localhost:3000/register?name=Chris&job=typist`. 我可以将其作为字符串一次性发送`httpc:request`，但我找不到将查询参数放入 URL 的函数（给定字典）。

我应该使用另一个具有此功能的 HTTP 库吗？

我想给它一个带有哈希/字典/映射的根 URL（在 json {"a" : "b", "c" : "d"} 中），然后将其正确附加到 URL 的末尾。例如，给定`"www.facebook.com"`和`[{"a", "b"}, {"c", "d"}]`将给`"www.facebook.com?a=b&c=d"`。

这是 Ruby 的一个类似问题：[Ruby: How to turn a hash into HTTP parameters?](https://stackoverflow.com/questions/798710/how-to-turn-a-ruby-hash-into-http-params)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:27:18.053

试试这个功能

```
test(URL,QP)->URL++"?"++loop(QP,[]).

loop([{A,B}],QP)->QP++A++"="++B;
loop([{A,B}|T],QP)->loop(T,QP++A++"="++B++"&"). 
```

称`test("www.facebook.com",[{"a", "b"}, {"c", "d"}]).` 它返回`"www.facebook.com?a=b&c=d"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T22:01:17.963

我不确定您所说的“哈希”*到底*是什么意思，但是如果您想从元组构造一个查询字符串，那是一项相当艰巨的任务。

我不熟悉 httpc 中提供您想要的功能的方法。您可以非常轻松地围绕 request/4 编写一个包装器，类似于此。

（这个程序是仓促构建的，给你的想法，原谅任何错误）。

```
request(Method, Domain, {Path, Query, Fragment}, HTTPOptions, Options) -> 
    QueryString = lists:flatten([Path,
                   case Query of "" -> ""; _ -> [$? | Query] end,
                   case Fragment of "" -> ""; _ -> [$# | Fragment] end]);
    Request = concat(Domain, QueryString);
    httpc:request(Method, {Request, []}, HTTPOptions, Options). 
```

你可以像这样调用它

`request(get, "http://www.example.com", {"/path", "", "bar?baz}, HTTPOptions, Options)`

# java - 计算 java.util.hash 的 hashcode 值时使用的常量说明

> ID：12253679
> 
> 赞同：10
> 
> 时间：2012-09-03T20:28:48.310
> 
> 标签：java, hash

有人可以解释这些常数的意义以及为什么选择它们吗？

```
static int hash(int h) {
        // This function ensures that hashCodes that differ only by
        // constant multiples at each bit position have a bounded
        // number of collisions (approximately 8 at default load factor).
        h ^= (h >>> 20) ^ (h >>> 12);
        return h ^ (h >>> 7) ^ (h >>> 4);
    } 
```

来源：java-se6 库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:18:51.590

理解什么是好的散列函数是很棘手的，因为实际上有很多不同的函数被使用并且用于稍微不同的目的。

Java 的哈希表的工作方式如下：

1.  他们要求关键对象产生其哈希码。该`hashCode()`方法的实现可能具有明显可变的质量（在最坏的情况下，返回一个常量值！）并且绝对不会适应您正在使用的特定哈希表。
2.  然后他们使用上述函数将位混合一点，以便高位中存在的信息也向下移动到低位。这很重要，因为接下来……</li>
3.  他们采用哈希码的 mod（wrt 哈希表数组条目的数量）来获取哈希表链数组的索引。*哈希表数组的大小很可能等于 2 的幂，因此步骤 2 中的位混合对于确保它们不会被丢弃很重要。*
4.  然后他们遍历链，直到他们到达具有相同键的条目（根据`equals()`方法）。

完成图片，哈希表数组中的条目数是非恒定的；如果链变得太长，则数组将替换为新的更大的数组，并且所有内容都会重新散列。这相对较快，并且对于正常使用模式（例如，很多`put()`s 后跟很多`get()`s）具有良好的性能影响。

实际使用的常量是相当随意的（可能是通过对一些简单的语料库进行实验来选择的，包括大量的`Integer`和`String`值之类的东西），但它们的目的不是：将整个值中的信息传播到值中的大部分低位确保`hashCode()`尽可能好地使用输出中存在的此类信息。

（您不会使用完美散列或加密散列来执行此操作；尽管名称相似，但它们具有非常不同的实现策略。前者需要了解密钥空间以便避免/减少冲突，而后者需要移动信息大约在各个方向，而不仅仅是低位。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:12:43.230

我也想知道这样的“神奇”数字。据我所知，它们*是*神奇的数字。
广泛的测试已经证明，奇数和素数具有可用于散列的有趣优先级（避免主/次聚类等）。
我相信大多数数字都是在研究和测试之后得出的，这些数据在统计上证明可以提供良好的分布。为什么*具体*这些数字会这样做，我不知道，但我有印象（希望这里的同事可以纠正我，如果我离题了），实施者都不知道为什么这些*具体*数字会呈现这些品质

# substring - 帕斯卡 substr 等效

> ID：12253682
> 
> 赞同：13
> 
> 时间：2012-09-03T20:28:58.710
> 
> 标签：substring, pascal, substr

我正在寻找（例如）php 的 substr 函数的 Pascal 等价物，它的工作原理如下：

```
$new_string = substr('abcdef', 1, 3);  // returns 'bcd' 
```

我已经找到了，但我总是花很长时间才能找到它，所以我将答案发布给像我这样的其他人，以便能够轻松找到它。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-03T20:28:58.710

您可以使用功能[*复制*](https://www.freepascal.org/docs-html/rtl/system/copy.html)。语法如下：

```
copy(string, start, length); 
```

Pascal 中的字符串似乎从 1 开始索引，因此如下：

```
s1 := 'abcdef';
s2 := copy(s1, 2, 3); 
```

将导致 s2 == 'bcd'。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-18T18:45:27.220

```
 function substring(s: string; a, b: integer): string;
    var len: integer;
      procedure swap(var a, b: integer);
      var temp: integer;
      begin
        temp:= a;
        a:= b;
        b:= temp;
      end;
    begin
      if (a > b) then
        swap(a, b);
      len:= length(s);
      if ((len = 0) or ((a < 1) and (b < 1)) or 
          ((a > len) and (b > len))) then
      begin
        substring:= '';
      end
      else
      begin
        if (a < 1) then
          a:= 1;
        if (b > len) then
          b:= len;
        substring:= copy(s, a, b);
      end;
    end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-21T20:19:53.783

[Freepascal](https://www.freepascal.org/docs-html/rtl/system/copy.html)还有一个 Copy 功能：

```
T:='1234567';
S:=Copy (T,1,2);   { S:='12'   }
S:=Copy (T,4,2);   { S:='45'   }
S:=Copy (T,4,8);   { S:='4567' } 
```

我建议您查看[Lazarus IDE](http://www.lazarus-ide.org/)。

# sql-server - SQL Server 死锁清晰？

> ID：12253685
> 
> 赞同：3
> 
> 时间：2012-09-03T20:29:03.237
> 
> 标签：sql-server, sql-server-2005, deadlock

阅读[**这篇**](http://blogs.msdn.com/b/sqlserverstorageengine/archive/2006/06/05/617960.aspx)有趣的文章后，我有一些问题。

下表显示了死锁情况：

![在此处输入图像描述](../Images/004e343a1ad7f2696b287e3dec56d416.png)

> T1 在表 t_lock1 上对所有 c1=5 的行持有 X 锁，而 T2 在表 t_lock2 上对所有 C1=1 的行持有 X 锁。
> 
> 现在这些事务中的每一个都希望更新先前被另一个锁定的行。这会导致死锁。

问题 #1

*   事务是否获得锁？我知道从表中*读取*是通过*共享*锁完成的，而对表的*写入*是使用*排他*锁完成的（我说的是*默认*锁定设置）。

所以从这个例子看来，事务*也*持有一个锁……它是正确的吗？

问题2

> ...T1 对表 t_lock1 上 c1=5 的所有行持有 X 锁...

*   恕我直言，正如我所说，锁定不是每行（尽管可以进行，但作者没有提到） - 那么他为什么说：*在所有行上 C1=5*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:36:11.807

对于问题 1：SQL Server 使用 U 锁读取源表行，然后更新它们，仅在符合更新条件的行上将它们转换为 X 锁。请注意读取多行之间的区别，然后将它们过滤到那些被写入的行。这两组的锁定方式不同。

由于您的查询中没有选择，因此只使用 U 和 X 锁。对正在更新的表的更新查询不采用 S 锁。这是一种启发式死锁避免方案。

问题 2：可以以不同的粒度进行锁定，但对于低行数，通常是每行（这可以强制执行）。也许作者假设 C1 上有一个索引，这意味着只有 C1=1 的行需要被读取和锁定。所有其他行都不会被触及。

如果没有索引，SQL Server 确实会读取表的所有行，在执行此操作时对它们进行 U 锁定，然后对满足 C1=1 的那些进行 X 锁定。作者确实提到只有 C1=1 的行是 x 锁定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T00:53:22.793

> *事务是否获得锁？*

不。您执行的语句 - a`SELECT`或 an`UPDATE`将获取锁。根据您的事务隔离级别设置，（共享）锁定（用于读取`SELECT`）将保持多长时间的持续时间会有所不同 - 仅此而已。共享锁通常只持有非常短暂的时间，而更新锁和排他锁会一直持有到事务结束。事务可能*持有*锁 - 但获取锁的*不是事务......*

> *...T1 对表 t_lock1 上 c1=5 的所有行持有 X 锁...*
> *恕我直言，我说过锁定不是每行（虽然可以进行，但作者没有提到它）那么他为什么说：在所有 C1=5 的行上？*

锁定**是**每行 - 默认情况下。但是为什么你认为只有一行`C1=5`？可能有多个（可能是数千个），并且该`UPDATE`语句将锁定**所有受**该`UPDATE`语句影响的行。

# javascript - Google caja - 阻止恶意代码

> ID：12253686
> 
> 赞同：1
> 
> 时间：2012-09-03T20:29:06.470
> 
> 标签：javascript, html, security, google-caja

我的网站需要安全的 html。

我阅读了 caja 指南，但我不确定我是否理解 conecpt。

[https://developers.google.com/caja/docs/gettingstarted/](https://developers.google.com/caja/docs/gettingstarted/)

我认为它是这样的：

*   用户向我的数据库提交恶意内容
*   我想渲染它。Caja 识别恶意代码并阻止它。

但是我如何通过 caja 渲染它？他们没有在他们的页面上解释这一点，他们只展示了如何替换代码。

```
<script type="text/javascript">
      document.getElementById('dynamicContent').innerHTML = 'Dynamic hello world';
</script> 
```

假设我们的文档看起来像这样

```
<body>
    <div class="input">
        <h3>User Input </h3>
        <script> alert("I am really bad!"); </script>
    </div>

    <div class="input">
        <h3>User Input </h3>
        <p> I am safe HTML!</p>
    </div>
</body> 
```

我将如何告诉 caja 阻止脚本标签？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T17:28:51.593

如果你只想清理 html（即根本不执行脚本），你不需要所有的 Caja，只需要 html-sanitizer。

要使用：

```
<script src="http://caja.appspot.com/html-css-sanitizer-minified.js"></script>
<script>
  var sanitized = html_sanitize(untrustedCode,
    /* optional */ function(url) { return url /* rewrite urls if needed */ },
    /* optional */ function(id) { return id; /* rewrite ids, names and classes if needed */ })
</script> 
```

如果您不想允许经过净化的 css 样式，请改用[http://caja.appspot.com/html-sanitizer-minified.js](http://caja.appspot.com/html-sanitizer-minified.js)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:21:54.347

在我看来，AntiSamy 是一种更好的方法。

[https://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project#What_is_it.3F](https://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project#What_is_it.3F)

这真的很简单

# awesome-wm - 任务栏中的应用程序始终以相同的顺序排列。在其他人的右侧打开应用程序

> ID：12253688
> 
> 赞同：1
> 
> 时间：2012-09-03T20:29:14.907
> 
> 标签：awesome-wm

我想在任务栏中始终以相同的顺序有一些应用程序（我在开始会话时打开）。那可能吗？

```
Vim | Chrome | Terminal 
```

另一个问题：现在，当我打开一个应用程序时，它是在任务栏的左侧打开的，在已经打开的应用程序之后，有没有办法在右侧打开它？

我在 rc.lua 中有这几行：

```
-- Add widgets to the wibox - order matters
mywibox[s].widgets = {
    {
        mylauncher,
        mytaglist[s],
        mypromptbox[s],
        layout = awful.widget.layout.horizontal.leftright
    },
    mylayoutbox[s],
    mytextclock,
    s == 1 and mysystray or nil,
    mytasklist[s],
    layout = awful.widget.layout.horizontal.rightleft
} 
```

哈维

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:22:37.710

要将新窗口放在列表的末尾（使它们成为从属窗口），您可以将规则添加到 rc.lua 文件

```
{ rule = { }, properties = { }, callback = awful.client.setslave } 
```

要自动启动应用程序，请使用

```
awful.util.spawn_with_shell("App1 -with -keys")
awful.util.spawn_with_shell("App2 -with -keys") 
```

我相信他们会按照这个顺序运行。并确保您在 rc.lua 中添加了可怕的内容。你可以通过函数 require("awful")

[看看常见问题解答](http://awesome.naquadah.org/wiki/FAQ#How_to_start_clients_as_slave_windows_instead_of_master.3F)

PS对不起，我不确定我是否理解你的正确。

# asp.net - 单击选择时，如何在第二个 GridView 中显示数据取决于第一个 GridView？

> ID：12253691
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:29:43.063
> 
> 标签：asp.net, gridview

我有两个实例`GridView`和两个`DataSources`. 我的关系为 1:(many)。当我点击“ *SELECT*`GridView` ”时，我需要根据第一个显示数据。我需要使用 ASP.NET 但直接在标记文档（即 ASPX）上解决这个问题，而不是在后面的代码中（即 CS）。`GridView`

 *第一个`GridView`对象：

```
<asp:GridView 
     ID = "GridView1" 
     runat = "server" 
     DataKeyNames = "ID_Segment" 
     DataSourceID = "DSSegment">
     <Columns>
       ...
     </Columns>
</asp:GridView> 
```

第一个`DataSource`对象：

```
<asp:SqlDataSource
     ID = "DSSegment"
     runat = "server" 
     ConnectionString = "<%$ ConnectionStrings:PraxeConnectionString %>"
     ... 
</asp:SqlDataSource> 
```

第二个`GridView`对象：

```
<asp:GridView 
     ID = "GridView2" 
     runat = "server" 
     DataKeyNames = "ID_Podsit" 
     DataSourceID = "DSPodsit">
     <Columns>
       ...
     </Columns>
</asp:GridView> 
```

第二个`DataSource`对象：

```
<asp:SqlDataSource
     ID = "DSPodsit"
     runat = "server" 
     ConnectionString = "<%$ ConnectionStrings:PraxeConnectionString %>" 
     ...
</asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:25:45.877

尝试这个

第一个 GridView - 使用新的 QueryString 重定向回页面

```
<asp:GridView 
        ID="GridView1" 
        runat="server" 
        DataKeyNames="ID_Segment" 
        DataSourceID="DSSegment">
        <Columns>
           <asp:TemplateField>
               <a href='/?SegmentID=<%#Eval("ID_Segment")%>'>Select this</a>
           </asp:TemplateField>
        </Columns>

</asp:GridView> 
```

第二个数据源 - 使用查询字符串

```
<asp:SqlDataSource ID="DSPodsit" runat="server" 

     ConnectionString="<%$ ConnectionStrings:PraxeConnectionString %>" 
        ... SelectCommand="SELECT * FROM tTable WHERE SegmentID=@SegmentID">

   <asp:QueryStringParameter name="SegmentID" QueryStringField="SegmentID" />

</asp:SqlDataSource> 
```

您还可以在此处找到更多线索[Master GridView with a Details DetailView](http://msdn.microsoft.com/en-us/library/aa581796.aspx)*

# html - HTML 目标属性在 Internet Explorer 中无法正常工作

> ID：12253696
> 
> 赞同：2
> 
> 时间：2012-09-03T20:30:51.837
> 
> 标签：html, internet-explorer

我最近开始学习 HTML，并尝试使用带有链接的目标属性来控制它们的打开位置，但是当我在 Internet Explorer 9 中尝试时它无法正常工作。

以下是带有链接的代码：

```
<a href="http://www.apogeephoto.com" target="new">Apogee Photo</a>
<a href="http://www.outdoorphotographer.com" target="new">Outdoor Photographer</a>
<a href="http://www.dpmag.com" target="new">Digital Photo</a>
<a href="http://www.popphoto.com" target="new">Popular Photography and Imaging</a> 
```

目标设置为在窗口中一次只打开一个链接，而原始窗口保持打开状态。然而，每个链接都是一个打开一个新窗口。

我也测试过这是 Firefox 和 Chrome。它在这两种浏览器中都能正常工作，所以我不明白为什么它不能在 Internet Explorer 9 中工作。我弄乱了 Internet Explorer 的设置，但没有任何改变。我还在 html 文件上使用了验证器，它发现该文件没有任何问题。

如果其他人遇到过这个问题，并且至少可以指导我解决问题的正确方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:00:56.843

在正常使用中，`target="new"`（其中`new`只是一个名称，没有预定义的含义）首先打开一个新窗口或选项卡，但在 IE 9 以及其他浏览器上，具有相同属性的后续链接单击会重用该窗口或选项卡。所以问题显然与您浏览器中的一些特殊设置有关。

微软的[文档`target`](http://msdn.microsoft.com/en-us/library/ie/ms534659%28v=vs.85%29.aspx)说：“Windows Internet Explorer 8 及更高版本。如果启用保护模式并且网页包含具有指定目标的锚链接，则当目标的完整性级别与包含该链接的网页不同时，Windows Internet Explorer 会在新窗口中打开链接的目标。”</p>

# java - CodeNameOne 动态创建的表单，如何“返回”

> ID：12253698
> 
> 赞同：7
> 
> 时间：2012-09-03T20:31:12.453
> 
> 标签：java, lwuit, codenameone

在按钮的 actionListener 中，我们想动态创建一个表单。

例如类似的东西

```
Button b = new Button("Clickme");
b.setActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent evt) {
        Form f = new Form();
        Container c = new Container();
        ...
        f.addComponent(c);
        f.show();
    }
}); 
```

哪个工作正常.....但是“后退”按钮不起作用

有谁知道在 actionListener 中实现动态表单或通过 action Listener 跳转到预定义表单的正确方法？

谢谢

詹姆士

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T05:06:48.557

您需要创建一个返回命令并将其与表单相关联：

```
Command back = new Command("Back") {
     public void actionPerformed(ActionEvent ev) {
         // notice that when showing a previous form it is best to use showBack() so the 
         // transition runs in reverse
         showPreviousForm();
     }
};
f.setBackCommand(back); 
```

您可以在完全手工编码的厨房水槽演示中看到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T01:18:42.293

您也可以将表单作为参数

```
chooseDB(c.getComponentForm());

private void chooseDB(final Form main) {
    Form f = new Form("Choose a Database");
    ...
    Command backCommand = new Command("Back") {
        public void actionPerformed(ActionEvent ev) {
            main.showBack();
        }};
    f.addCommand(backCommand);
    f.setBackCommand(backCommand);
    f.show();
} 
```

所以对于你的例子：

```
Button b = new Button("Clickme");
b.setActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent evt) {
        Form f = new Form();
        Container c = new Container();
        Command backCommand = new Command("Settings") {
        public void actionPerformed(ActionEvent ev) {
            b.getComponentForm().showBack();
        }};
    f.addCommand(backCommand);
    f.setBackCommand(backCommand);
        f.addComponent(c);
        f.show();
    }
}); 
```

Shai，如果我做错了什么，请纠正这个。谢谢。

# php - 通过静态方法使用 CodeIgniter 库

> ID：12253700
> 
> 赞同：0
> 
> 时间：2012-09-03T20:31:36.553
> 
> 标签：php, codeigniter

我在尝试在静态函数中调用 CodeIgniter 方法时遇到问题，仅使用 $this 不起作用，因为它不在对象上下文中，static 关键字也不起作用。这是我的核心模型中的代码示例，$table 变量是从另一个模型（如帖子）成功定义的。

```
class MY_Model extends CI_Model {

    protected static $table;

    public function __construct() {
        parent::__construct();
    }

    public static function find_all() {
        $this->db->select('*');
        $sql = $this->db->get(static::$table);
        return $sql->result();
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:42:12.617

如果 $this 不起作用，您可以像这样解决这个问题：

```
$CI =& get_instance();
$CI->db->...
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T08:19:33.227

加载器类中内置的 codeigniter 会自动实例化该类。不支持在不实例化的情况下使用类。您可以手动将文件包含在模型文件中，然后就可以使用它。有关更多详细信息，请查看此线程： [http ://codeigniter.com/forums/viewthread/73583/](http://codeigniter.com/forums/viewthread/73583/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:38:24.583

你想要的是对类中静态变量的引用，所以使用：

```
class MY_Model extends CI_Model {

    protected static $table;

    public function __construct() {
        parent::__construct();
    }

    public static function find_all() {
        $this->db->select('*');
        $sql = $this->db->get(self::$table);
        return $sql->result();
    }

} 
```

当然，$table 确实需要有一个值！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-18T22:25:07.393

我相信 Codeigniter 通常不支持静态方法，它们实际上是试图将过程代码硬塞进面向对象的代码中。

无论如何，我认为您最好的选择是使用没有静态方法的类，或者将您的代码变成“帮助器”。助手只是一个老式的函数库。您可以在 helpers 文件夹下创建它，并且可以使用 $this->load->helper('helper_name') 加载它。然后，您可以像在普通程序代码中一样调用该函数，换句话说，“find_all()”

希望这可以帮助。第一次投稿：）

# java - 如何在某个月做某事？

> ID：12253703
> 
> 赞同：2
> 
> 时间：2012-09-03T20:31:44.437
> 
> 标签：java, android, date, webview

我有这个 WebView 可以显示我学校的午餐菜单。有没有办法每个月使用 switch 和 case 调出一个新菜单，或者如果 an then？这是我的 webview 的代码。

```
webPDF.loadUrl("https://docs.google.com/gview?embedded=true&url=" +
"http://www.longcountyhs.com/files/Menus/Aug_Lunch_WMS_LCHS.pdf"); 
```

也许不这样做，是否可以做这样的事情？

```
webPDF.loadUrl("https://docs.google.com/gview?embedded=true&url=" +
"http://www.longcountyhs.com/files/Menus/" + "MONTH" + "_Lunch_WMS_LCHS.pdf"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:38:36.437

要获取月份，您可以`DateFormatSymbols`与日历实例一起使用。

所以像：

```
String[] monthNames = new DateFormatSymbols().getShortMonths();
int month = Calendar.getInstance().get(Calendar.MONTH);
String myMonth = monthNames[month]; 
```

# c# - 使用 Code First 和实体框架的实体字段的可空属性

> ID：12253705
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:31:53.267
> 
> 标签：c#, asp.net-mvc-3, entity-framework, ef-code-first, nullable

我正在构建一个名为“User”的类，它有一个“Category”类型的字段。

```
public class User
{
     public long Id { get; set; }
     public virtual Category Category{ get; set; }
}

public class Category
{
     public long Id { get; set;}
     public string Name { get; set; }
} 
```

每当此字段获得值时，就无法再设置空值。

如何再次将此字段设置为空？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:58:57.310

我认为这与延迟加载有关。由于您没有为用户请求类别，因此它仍然为空，因此将其设置为空，不会触发 EF，即类别上有更改。您需要在用户中包含类别，然后更改该值。这样 EF 将看到 Category 上的更改并将其设置为 null。

尝试这样的事情：

```
var user = Context.User.Include(x => x.Category).FirstOrDefault(x => x.Id == yourUserid);
// now user knows about Category, so you can set it to null
user.Category = null;
Context.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:38:50.640

只需将属性设置为 null：

```
 User user = new User();
        user.Category = new Category();
        user.Category.Id = 1;
        user.Category.Name = "test";
        user.Category = null; 
```

你有这个想法吗？

# css - 难以使用 css 和 html 创建内容网格布局

> ID：12253707
> 
> 赞同：4
> 
> 时间：2012-09-03T20:31:54.903
> 
> 标签：css, html, grid, css-float

我正在尝试使用标签和 css 创建网格布局。我需要网格系统来容纳四个主要块，如下图所示。我创建了一个在 safari 和 chrome 中效果很好的解决方案，但在 Firefox 中效果不佳，因为标题重叠。

请在下面查看我的代码，也许有人可以看到我哪里出错了！我一辈子都找不到问题所在。

![在此处输入图像描述](../Images/9d85d4738e3162559b6285284495759a.png)

HTML 代码：-

```
<div class="elements_wrapper">

         <div id="element1">
           <img class="align-image" src="img/image1"/>                                          
               <span class="element-title">Title</span>
                   <p class="element-explain">Main text goes here</p>
         </div>

         <div id="element2">
           <img class="align-image" src="img/image2"/>                                          
               <span class="element-title">Title</span>
                   <p class="element-explain">Main text goes here</p>
         </div>

         <div id="element3">
           <img class="align-image" src="img/image3"/>                                          
               <span class="element-title">Title</span>
                   <p class="element-explain">Main text goes here</p>
         </div>

         <div id="element4">
           <img class="align-image" src="img/image4"/>                                          
               <span class="element-title">Title</span>
                   <p class="element-explain">Main text goes here</p>
         </div>                                          
    </div> 
```

CSS 代码：-

```
.elements_wrapper {
    width:100%;
    margin-left:-65px;
    margin-top:110px;   
    padding-bottom:30px;
}

#element1{
    position:absolute;
    display:inline-block;
    margin-left:30px;
    padding-bottom:20px;

}

#element2 {
    position:absolute;
    display:inline-block;
    margin-top:200px;
    margin-left:30px;
    padding-bottom:20px;
}

#element3 {
    position:absolute;
    display:inline-block;
    margin-left:545px;
    margin-top:200px;
    padding-bottom:20px;

}

#element4 {
    position:absolute;
    display:inline-block;
    margin-left:545px;
    padding-bottom:20px;
}

.element-title {
    font-family:helvetica, arial, serif;
    color:black;
    display:inline;
    font-size:14pt;
    font-weight:bold;
    padding-top:15px;
}

.element-explain {
    font-family:helvetica, arial, serif;
    font-size:10pt;
    float:left;
    width:280px;
}

.align-image {
    border: none; 
    float:left; 
    padding-right:15px;
} 
```

我的代码在 safari 和 chrome 中运行良好，但在 Firefox 中效果不佳，请帮忙。另外，如果我已经使用的代码不好或需要更改以确保跨浏览器兼容性，请告诉我。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:00:45.737

```
.element-explain {
    font-family:helvetica, arial, serif;
    font-size:10pt;
    float:left; 
    width:280px;
} 
```

在此处浮动会导致此错误。与 Chrome 和 IE 相比，Firefox 对浮动元素有点挑剔。删除它应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:05:58.290

请参阅下一个示例：http: [//jsfiddle.net/ZNSAX/2/](http://jsfiddle.net/ZNSAX/2/)

# java - Java 显式构造函数调用和实例初始化器

> ID：12253712
> 
> 赞同：4
> 
> 时间：2012-09-03T20:32:43.473
> 
> 标签：java, constructor, this, super, invocation

在 The Java Tutorials - [Initializing Fields](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)中，有关于实例初始化块（Instance Initializer）的描述：

> **Java 编译器将初始化程序块复制到每个构造函数**中。因此，这种方法可用于在多个构造函数之间共享代码块。

如果释义正确，则为以下代码：</p>

```
public class ConstructorTest {

    public static void main(String[] args) {
        Child c = new Child();
    }
}

class Parent {
    Parent() {
        System.out.println("Parent non-argument Constructor");
    }
}

class Child extends Parent {

    {
        System.out.println("Child Instance Initialization Block");
    }

    Child() {
        this(2);
        System.out.println("Child no-argument Constructor");

    }

    Child(int i) {
        this(10, i);
        System.out.println("Child 1-argument Constructor");
    }

    Child(int i, int j) {
        System.out.println("Child 2-argument Constructor");
    }
} 
```

输出应该是：</p>

```
Parent non-parm Constructor
Child Instance Initialization Block
Child 2-argument Constructor
Child Instance Initialization Block
Child 1-argument Constructor
Child Instance Initialization Block
Child no-argument Constructor 
```

但实际输出的是：</p>

```
Parent non-argument Constructor
Child Instance Initialization Block
Child 2-argument Constructor
Child 1-argument Constructor
Child no-argument Constructor 
```

是我误解了那句话的意思，还是描述不够准确？</p>

还有一个关于显式构造函数调用的疑问：

基于两个基础：</p>

*   如果存在，另一个构造函数的调用必须是构造函数的第一行。
*   在一个构造函数内部，使用 this() 调用另一个构造函数，使用 super() 直接调用超类对应的构造函数。

MEANS 在子类的构造函数中使用 this() 是否会隐式删除对超类的无参数构造函数的默认调用？

谢谢回复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:38:53.523

编辑：事实证明 JLS 毕竟是准确的，尽管它很难阅读。这在[第 12.5 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)中有详细说明：

> 就在对新创建对象的引用作为结果返回之前，使用以下过程处理指示的构造函数以初始化新对象：
> 
> 1.  将构造函数的参数分配给此构造函数调用的新创建的参数变量。
>     
>     
> 2.  如果此构造函数以同一类中另一个构造函数的显式构造函数调用（第 8.8.7.1 节）开始（使用 this），则评估参数并使用这五个相同的步骤递归地处理该构造函数调用。如果该构造函数调用突然完成，则此过程出于相同原因而突然完成；**否则，继续执行步骤 5**。
>     
>     
> 3.  此构造函数不以显式构造函数调用同一类中的另一个构造函数开始（使用 this）。如果此构造函数用于 Object 以外的类，则此构造函数将以显式或隐式调用超类构造函数（使用 super）开始。使用这五个相同的步骤递归地评估超类构造函数调用的参数和过程。如果该构造函数调用突然完成，则此过程出于相同的原因突然完成。否则，继续执行步骤 4。
>     
>     
> 4.  执行该类的实例初始化程序和实例变量初始化程序，将实例变量初始化程序的值分配给相应的实例变量，按照它们在源代码中以文本形式出现的从左到右的顺序。如果执行这些初始化程序中的任何一个导致异常，则不会处理更多初始化程序，并且此过程会突然完成相同的异常。否则，继续执行步骤 5。
>     
>     
> 5.  执行此构造函数的其余部分。如果该执行突然完成，则此过程出于同样的原因突然完成。否则，此过程正常完成。

注意突出显示的部分 - 链式构造函数被执行，*然后我们跳过第 4 步，这将执行实例初始化程序*。

现实是实例和字段初始化器只执行一次，从输出中可以看出。

非正式地，我认为将程序描述为是准确的：

*   继续在同一个类 ( `this(...)`) 中链接构造函数，直到到达不以 . 开头的构造函数主体`this`。
*   执行相应的超级构造函数
*   执行实例变量初始化器和实例初始化器
*   执行“最里面”构造函数的主体
*   继续弹出构造函数体的堆栈，直到你最终得到“入口”构造函数

> MEANS 在子类的构造函数中使用 this() 是否会隐式删除对超类的无参数构造函数的默认调用？

是的。*在*类中的构造函数链中的某个位置，可以保证最终得到一个`super`隐式或显式调用的构造函数。这是*唯一*被调用的超类构造函数。

编辑：请注意，您引用的教程显然是不正确的。

示例类：

```
public class Test {
    {
        System.out.println("Foo");
    }

    public Test() {
    }

    public Test(int i)  {
        this();
    }
} 
```

输出`javap -c`：

```
public class Test {
  public Test();
    Code:
       0: aload_0
       1: invokespecial #1  // Method java/lang/Object."<init>": ()V
       4: getstatic     #2  // Field java/lang/System.out:Ljava/io/PrintStream;
       7: ldc           #3  // String Foo
       9: invokevirtual #4  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      12: return

  public Test(int);
    Code:
       0: aload_0
       1: invokespecial #5                  // Method "<init>":()V
       4: return
} 
```

如您所见，构造函数*中没有*`Test(int)`编译实例构造函数的代码。

 *基本上，只有直接调用超类构造函数的构造函数才会将实例初始化代码复制到其中。当然，所有其他构造函数最终将*导致实例初始化程序代码*通过调用超类构造函数的构造函数执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:38:21.230

当您实例化类的对象时，初始化块只运行一次（使用任何构造函数 <= 这是您的疑问）。当类被类加载器加载时，静态初始化块只运行一次。

> MEANS 在子类的构造函数中使用 this() 是否会隐式删除对超类的无参数构造函数的默认调用？

不，this() 将调用同一类的另一个构造函数，在这种情况下是默认构造函数（如果存在）。此构造函数（默认构造函数）将调用 super()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:53:21.650

我认为Java语言规范更准确：[http ://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6)

> 在创建类的实例时执行在类中声明的实例初始化程序

并在[http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)步骤 4 和 5 中描述您观察到的输出：

> 4\. 执行此类的实例初始化程序和实例变量初始化程序...
> 
> 5\. 执行此构造函数的其余部分...*

# c# - 根据解决方案文件夹内容动态创建控件

> ID：12253714
> 
> 赞同：0
> 
> 时间：2012-09-03T20:32:46.750
> 
> 标签：c#, silverlight

我正在尝试为解决方案中特定文件夹中的每个图像动态创建一个按钮控件。

该文件夹位于 ProjectName/Images/Slideshow/SectionOne。

我在想这样的事情：

```
 foreach (Image image in "~/Images/Slideshow/SectionOne")
    {
        // My button initialization syntax here.
    } 
```

这行不通。我是否不知道访问解决方案文件夹的正确语法，或者这完全是执行此任务的错误方式？

所有的想法/意见表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:52:19.777

猜猜你可以做这样的事情

但是为了使用这样的路径，您必须使用 Server.MapPath 并且您还需要为文件设置正确的 web url，而不仅仅是使用从文件路径中获得的内容！

```
Control myControl = new Control();
string[] filePaths = Directory.GetFiles(@"c:\images\");

foreach (string file in filePaths)
{
    Image image = new Image();
    image.ImageUrl = file;
    myControl.Controls.Add(image);
}

Page.Controls.Add(myControl); 
```

# java - Java - 解析文本文件 - 扫描仪、阅读器或其他？

> ID：12253719
> 
> 赞同：3
> 
> 时间：2012-09-03T20:33:12.273
> 
> 标签：java, parsing, java.util.scanner

我想解析一个 UTF8 编码的文本文件，它可能包含这样的内容：

```
int 1
text " some text with \" and \\ "
int list[-45,54, 435 ,-65]
float list [ 4.0, 5.2,-5.2342e+4] 
```

列表中的数字用逗号分隔。此处允许在任何数字和任何符号（如逗号和括号）之间使用空格，但不需要空格。对于单词和符号也是如此，例如`list[`

我通过强制 Scanner 给我单个字符（将其分隔符设置为空模式）来完成引用字符串的读取，因为我仍然认为它对于读取整数和浮点数很有用，但我不确定了。

Scanner 总是获取一个完整的令牌，然后尝试匹配它。我需要的是尝试尽可能多（或尽可能少地）匹配，而不考虑分隔符。

基本上对于这个输入

```
int list[-45,54, 435 ,-65] 
```

我希望能够打电话并得到这个

```
s.nextWord()   // int 
s.nextWord()   // list
s.nextSymbol() // [
s.nextInt()    // -45
s.nextSymbol() // ,
s.nextInt()    // 54
s.nextSymbol() // ,
s.nextInt()    // 435
s.nextSymbol() // ,
s.nextInt()    // -65
s.nextSymbol() // ] 
```

等等。

或者，如果它本身无法解析双精度数和其他类型，则至少有一个采用正则表达式的方法，返回与其匹配的最大字符串（或错误）并将流位置设置为紧随其匹配的位置。

扫描仪可以以某种方式用于此目的吗？还是有其他方法？我觉得这一定是一件很常见的事情，但我似乎无法找到合适的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:38:47.043

我不是 ANTLR 专家，但这个[ANTLR](http://www.antlr.org/)语法能够解析您的代码：

```
grammar Expressions;

expressions 
    :   expression+ EOF
    ;

expression 
    :   intExpression
    |   intListExpression
    |   floatExpression
    |   floatListExpression
    |   textExpression
    |   textListExpression
    ;

intExpression        :  intType INT;
intListExpression    :  intType listType '[' ( INT (',' INT)* )? ']';
floatExpression      :  floatType FLOAT;
floatListExpression  :  floatType listType '[' ( (INT|FLOAT) (',' (INT|FLOAT))* )? ']';
textExpression       :  textType STRING;
textListExpression   :  textType listType '[' ( STRING (',' STRING)* )? ']';

intType   :  'int';
floatType :  'float';
textType  :  'text';
listType  :  'list';

INT :   '0'..'9'+
    ;

FLOAT
    :   ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
    |   '.' ('0'..'9')+ EXPONENT?
    |   ('0'..'9')+ EXPONENT
    ;

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;

fragment
HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;

fragment
ESC_SEQ
    :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    |   UNICODE_ESC
    |   OCTAL_ESC
    ;

fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        ) {$channel=HIDDEN;}
    ; 
```

当然你需要改进它，但我认为使用这种结构很容易在解析器中插入代码来做你想做的事情（一种令牌流）。[在ANTLRWorks](http://www.antlr.org/works/index.html)调试中尝试一下，看看会发生什么。

对于您的输入，这是解析树：

![OP 输入的解析树](../Images/ccae59332a3ec4a242f6e90c548f2f25.png)

**编辑：我将其更改为支持空列表。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:15:23.320

使用类构造函数中的文件启动扫描程序。然后对于 nextWord 方法，执行此操作，

```
public static nextWord(){
return(sc.findInLine("\\w+"));
} 
```

您可以使用上面的示例以及 Scanner 类的 findInLine 方法并更改正则表达式模式来派生其他方法的代码。

# ruby - 获取范围之间的项目

> ID：12253722
> 
> 赞同：1
> 
> 时间：2012-09-03T20:33:15.620
> 
> 标签：ruby, arrays

我在 Ruby 中有一个如下所示的数组：

```
[ 0] "Red",
[ 1] "Green",
[ 2] "Blue",
[ 3] "Yellow",
[ 4] "Cyan",
[ 5] "Magenta",
[ 6] "Orange",
[ 7] "Purple",
[ 8] "Pink",
[ 9] "White",
[10] "Black" 
```

我需要搜索黄色和紫色之间的值并重建数组，使其看起来像这样：

```
[ 0] "Red",
[ 1] "Green",
[ 2] "Blue",
[ 3] [[0] "Cyan",[1] "Magenta",[2] "Orange" ],
[ 4] "Cyan",
[ 5] "Magenta",
[ 6] "Orange",
[ 7] "Purple",
[ 8] "Pink",
[ 9] "White",
[10] "Black" 
```

在 Ruby 中有一个简单的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:50:17.853

## 将 Array#index 值传递给 Array#slice

如果要按单元格的值而不是索引位置对数组进行切片，可以将 Array#index 值作为参数传递给 Array#slice。例如：

```
colors = ["Red", "Green", "Blue", "Yellow", "Cyan", "Magenta", 
          "Orange", "Purple", "Pink", "White", "Black"]

colors.slice colors.index('Yellow'), colors.index('Purple')
# => ["Yellow", "Cyan", "Magenta", "Orange", "Purple", "Pink", "White"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:52:15.417

```
ar = %w(red green blue yellow cyan magenta orange purple pink white black)
i = ar.index('yellow')
ar[i] = ar[i+1 ... ar.index('purple')]
p ar #=> ["red", "green", "blue", ["cyan", "magenta", "orange"], "cyan", "magenta", "orange", "purple", "pink", "white", "black"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:55:09.183

关键是通过数组的索引助手获取起点和终点，并在它之间获取数组并将其替换为起始位置

```
def rearrange arr,from,to
  sidx = arr.index from
  eidx = arr.index to
  arr[sidx] = arr[sidx+1..eidx]
end

arr= ["Red", "Green", "Blue", "Yellow", "Cyan", "Magenta", "Orange", "Purple", "Pink", "White", "Black"]
start = "Yellow"
stop = "Orange"

puts arr.inspect
#=> ["Red", "Green", "Blue", "Yellow", "Cyan", "Magenta", "Orange", "Purple", "Pink", "White", "Black"]
rearrange arr,start,stop
puts arr.inspect
#=> ["Red", "Green", "Blue", ["Cyan", "Magenta", "Orange"], "Cyan", "Magenta", "Orange", "Purple", "Pink", "White", "Black"] 
```

# ruby-on-rails - Phusion 乘客：`没有要加载的文件--bundler`

> ID：12253724
> 
> 赞同：0
> 
> 时间：2012-09-03T20:33:20.550
> 
> 标签：ruby-on-rails, apache, passenger

所以这就是问题所在。我正在尝试让我的 Rails 3.2.8 应用程序在 justhost.com 的网络托管平台上运行。当我 ssh 进入服务器并运行时，该应用程序在 WEBrick 上运行良好`rails s`，但乘客（justhost 提供的服务器平台）遇到了一些问题。

Stackoverflow 上似乎还有很多其他帖子，用户遇到了同样的问题。我尝试了尽可能多的建议解决方案，但没有一个能够解决我的问题。我的网络托管服务的客户支持也无法提供帮助：

> 您请求的支持类型在设计和开发您的网站时比我们能够提供的更深入。

所以，是的，如果这里有人可以帮助我，我将非常感激。这是我收到的错误消息：

![我真的开始讨厌的错误消息。](../Images/06181b04c372fd539ba3a0252d338e70.png)

以下是您可能会发现相关的其他一些信息：

```
webgemla@webgemlabs.com [~]# which rails
/home3/webgemla/.rvm/gems/ruby-1.9.3-p194/bin/rails
webgemla@webgemlabs.com [~]# which ruby
/home3/webgemla/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
webgemla@webgemlabs.com [~]# which bundle
/home3/webgemla/.rvm/gems/ruby-1.9.3-p194/bin/bundle
webgemla@webgemlabs.com [~]# which rake
/home3/webgemla/.rvm/gems/ruby-1.9.3-p194/bin/rake
webgemla@webgemlabs.com [~]# which gem
webgemla@webgemlabs.com [~]# which rvm
webgemla@webgemlabs.com [~]# gem -v
1.8.24
webgemla@webgemlabs.com [~]# rvm -v

rvm 1.15.8 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

webgemla@webgemlabs.com [~]# echo $PATH
/home3/webgemla/.rvm/gems/ruby-1.9.3-p194/bin:/home3/webgemla/.rvm/gems/ruby-1.9.3-p194@global/bin:/home3/webgemla/.rvm/rubies/ruby-1.9.3-p194/bin:/home3/webgemla/.rvm/bin:/usr/local/jdk/bin:/home3/webgemla/perl5/bin:/usr/lib64/qt-3.3/bin:/ramdisk/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin:/home3/webgemla/ruby/gems/bin:/home3/webgemla/ruby/gems:/home3/webgemla/bin
webgemla@webgemlabs.com [~]# ls -ld .rvm
drwxr-xr-x 24 webgemla webgemla 4096 Sep  3 13:51 .rvm/ 
```

奇怪的是，`which rvm`什么`which gem`都不打印（这可能与我的问题有关吗？），但是`rvm`and`gem`命令运行得很好。我真的可以在这个方面使用一些帮助...... =（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:49:15.077

我可以通过在我的 .htaccess 文件中设置 GEM_HOME 来解决这个问题：

```
SetEnv GEM_HOME /home3/webgemla/.rvm/gems/ruby-1.9.3-p194 
```

我现在遇到了其他问题（[i.imgur.com/cMMmW.png](http://i.imgur.com/cMMmW.png)），但至少这个问题似乎得到了解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:55:36.537

这记录在 rvm 文档[https://rvm.io/integration/passenger/](https://rvm.io/integration/passenger/)

# android - 从父级移除视图中的 android

> ID：12253726
> 
> 赞同：8
> 
> 时间：2012-09-03T20:33:29.690
> 
> 标签：android, view, viewgroup

在子布局（视图）上，当视图从其父级中删除时是否有回调？视图完成后，我需要回收一些图像。我一直在网上四处寻找该怎么做，但还没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-11T11:27:10.387

我也一直在寻找这样的东西。我能找到的最好的是 View.OnAttachStateChangeListener。我怀疑它是否理想，因为它是在窗口中添加和删除视图时的回调 - 不是父级，但它足以满足我的需要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-05T08:44:23.883

`onDetachedFromWindow`您可以在自定义`View`代码中覆盖，而不是注册新的侦听器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-05-06T10:28:12.200

我掉进了marmor所说的那个陷阱：）

```
@Override
protected void onDetachedFromWindow() { I want to do something here, sometimes called sometimes not!!}

protected void onAttachedToWindow() {It is working fine, always} 
```

此代码位于`CustomView`.

调用代码是：

```
 contentHolder.removeAllViews();
    // ... init my  CustomView   ...
    contentHolder.addView(myCustomView);
    contentHolder.requestLayout();// useless, not need
    contentHolder.invalidate();// useless, not need 
```

要了解为什么不起作用，您必须进入 Android API：

```
public void removeAllViews() {
    removeAllViewsInLayout();
    requestLayout();
    invalidate(true);
}

public void removeAllViewsInLayout() {
    final int count = mChildrenCount;
    if (count <= 0) {
        return;
    }

    final View[] children = mChildren;
    mChildrenCount = 0;

    final View focused = mFocused;
    final boolean detach = mAttachInfo != null;
    boolean clearChildFocus = false;

    needGlobalAttributesUpdate(false);

    for (int i = count - 1; i >= 0; i--) {
        final View view = children[i];

        if (mTransition != null) {
            mTransition.removeChild(this, view);
        }

        if (view == focused) {
            view.unFocus(null);
            clearChildFocus = true;
        }

        view.clearAccessibilityFocus();

        cancelTouchTarget(view);
        cancelHoverTarget(view);

        if (view.getAnimation() != null ||
                (mTransitioningViews != null && mTransitioningViews.contains(view))) {
            addDisappearingView(view);
        } else if (detach) {
           view.dispatchDetachedFromWindow();
        }

        if (view.hasTransientState()) {
            childHasTransientStateChanged(view, false);
        }

        dispatchViewRemoved(view);

        view.mParent = null;
        children[i] = null;
    }

    if (clearChildFocus) {
        clearChildFocus(focused);
        if (!rootViewRequestFocus()) {
            notifyGlobalFocusCleared(focused);
        }
    }
} 
```

关键在这里：

```
 if (view.getAnimation() != null ||
                (mTransitioningViews != null && mTransitioningViews.contains(view))) { 
```

所以，如果你有动画（在 1 种情况下我有，在 9 种情况下没有）它不会调用它`onDetachedFromWindow()`，它会弄乱整个 UI :)

```
public void endViewTransition(View view) {
    if (mTransitioningViews != null) {
        mTransitioningViews.remove(view);
        final ArrayList<View> disappearingChildren = mDisappearingChildren;
        if (disappearingChildren != null && disappearingChildren.contains(view)) {
            disappearingChildren.remove(view);
            if (mVisibilityChangingChildren != null &&
                    mVisibilityChangingChildren.contains(view)) {
                mVisibilityChangingChildren.remove(view);
            } else {
                if (view.mAttachInfo != null) {
                    view.dispatchDetachedFromWindow();
                }
                if (view.mParent != null) {
                    view.mParent = null;
                }
            }
            invalidate();
        }
    }
} 
```

在某些情况下，即使使用动画也会再次调用。addDisappearingView(视图);

接受的答案建议如下：

```
 addOnAttachStateChangeListener(new OnAttachStateChangeListener() {
        @Override
        public void onViewAttachedToWindow(View v) {
        }

        @Override
        public void onViewDetachedFromWindow(View v) {
            System.out.println("MyCustomView.onViewDetachedFromWindow");
        }
    }); 
```

可悲的是动画不会打印所需的文本。

来自 android.view.ViewGroup API 的一些重要代码：

```
void dispatchViewRemoved(View child) {
    onViewRemoved(child);
    if (mOnHierarchyChangeListener != null) {
        mOnHierarchyChangeListener.onChildViewRemoved(this, child);
    }
}

public void onViewRemoved(View child) {
} 
```

因此，您可以覆盖您的`RelativeLayout`for 此方法。我的动画是无限动画，不会很快调用任何方法！

如果您有无限动画，正确的方法是编写此代码，当您调用删除所有视图时：

```
 if(contentHolder.getChildCount() > 0 ){
        View child0 = contentHolder.getChildAt(0);
        Animation animation = child0.getAnimation();
        if(animation != null) {
            animation.cancel();
            child0.clearAnimation();
        }
    }
    contentHolder.removeAllViews(); 
```

现在它将被称为`protected void onDetachedFromWindow()`！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-21T09:30:23.987

**Android KTX** (Core KTX) 库为此提供了一个很好的解决方案。

你需要这个依赖：androidx.core:core-ktx:1.3.0

然后，您可以调用函数“doOnDetach”来表示您希望在从窗口中删除视图时（一次）运行一些代码：

```
fun myInitCode() {
    ...
    myView.doOnDetach(this::doOnMyViewDetachFromWindow)
    ...
}

fun doOnMyViewDetachFromWindow(view: View) {
    ... put your image cleanup code here ...
} 
```

您可以将 lambda 传递给“doOnDetach”，但如上所示的方法引用可能更简洁，具体取决于您需要做多少工作。

doOnDetach 的描述如下：

> androidx.core.view ViewKt.class public inline fun View.doOnDetach(crossinline action: (View) → Unit): Unit
> 
> 当此视图与窗口分离时执行给定的操作。如果视图未附加到窗口，则该操作将立即执行，否则该操作将在视图与其当前窗口分离后执行。该操作只会被调用一次，然后将删除所有侦听器。

# xquery - 如何查找访问的文档以回答我的 Xquery 查询？

> ID：12253732
> 
> 赞同：2
> 
> 时间：2012-09-03T20:34:00.783
> 
> 标签：xquery

我有以下目标。我想在执行任何类型的 Xquery 或 XPath 时查找哪些文档包含我的数据。换句话说，我需要为给定查询提供结果数据的每个文档。我尝试在 eXist-db 环境中执行此操作，但我认为 Xquery 级别应该有一些东西。

我发现 op:context-document() 运算符似乎具有我想要的功能，但是，作为运算符，它对我不可用。fn:document-uri 也不能解决问题，因为它的 $arg 必须是一个文档节点，否则它返回一个空序列。

你有什么想法吗？所有的帮助都受到高度赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:48:52.090

使用标准的 XPath/XQuery 函数**[`collection()`](http://www.w3.org/TR/xpath-functions/#func-collection)**。

**例如**，使用撒克逊语：

```
collection('file:///a/b/c/d?select=*.xml')[yourBooleanExpression] 
```

选择所有 XML 文档的文档节点，驻留在文件系统的`/a/b/c/d`目录中，满足您的条件（`yourBooleanExpression`评估为`true()`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T21:05:35.573

[fn:base-uri()](http://www.w3.org/TR/xpath-functions/#func-base-uri)可能会有所帮助；它返回节点的基本 URI 属性：

```
for $d in doc('....')/your[query]
return base-uri($d) 
```

您还可以使用它来过滤特定类型的文档：

```
collection('/path/to/documents')[ends-with(base-uri(), '.xml')] 
```

# python - Django 应用间导入的公认做法是什么

> ID：12253734
> 
> 赞同：6
> 
> 时间：2012-09-03T20:34:17.117
> 
> 标签：python, django

Django 和相互交互的应用程序很容易遇到导入问题。我的问题很简单：

**最小化循环进口的公认流程是什么，或者有没有人提出一个公认的编码标准来减少他们愿意分享的这些。**

我正在寻找可以标准化的良好原则。

楷模

```
class Program(models.Model):
    group = models.ForeignKey(Group, related_name="%(app_label)s_%(class)s_related") 
```

对比

```
class Program(models.Model):
    group = models.ForeignKey('auth.Group', related_name="%(app_label)s_%(class)s_related") 
```

意见：

```
class ProgramDetailView(DetailView):
    """Detail view of the EEP Program"""

    def get_queryset(self):
        """Narrow this based on your company"""
        from apps.company.models import Company
        company = Company.objects.get(name="foo")
        return Program.objects.filter(company = company) 
```

vs（这往往会导致问题..

```
from apps.company.models import Company
class ProgramDetailView(DetailView):
    """Detail view of the EEP Program"""

    def get_queryset(self):
        """Narrow this based on your company"""
        company = Company.objects.get(name="foo")
        return Program.objects.filter(company = company) 
```

这样做的问题是您倾向于在整个地方进行大量导入..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:44:31.970

多年来，根据我对如何开发 Web 应用程序的观察，我对一些模式进行了标准化。

我不知道您对模块化和代码重用的标准是什么，但以下简单的规则/模式对我的一些相当大的项目有很大帮助。

我注意到我的许多模型都有一些共同的属性。例如，我更喜欢使用 UUID 而不是简单的自动递增整数作为主键。

所以我有这个抽象模型。

```
class UUIDModel(models.Model):
    id = UUIDField(primary_key=True, auto=True)  # There are many implementation of this on the web. Choose your favorite.

    class Meta:
        abstract = True 
```

我的许多模型都需要`activation`. 所以我有另一个抽象模型，类似于：

```
class ActivatedModel(Model):
    is_active = models.BooleanField(default=False)

    def activate(self, save=True):
        if self.is_active:
            raise Exception('Already activated')
        self.is_active = True
        if save:
            self.save()

    class Meta:
        abstract = True 
```

我使用许多其他抽象模型来跟踪创建时间和修改，或者是否`finalized`可以进一步修改某些内容等。

所有这些抽象模型都存在于`core`应用程序中。我就是这样称呼它的。除了`core`应用程序，我还有一个`tasks`应用程序。该`tasks`应用程序提供了抽象模型，可以增强我与[芹菜](http://celeryproject.org/)相关的任何接口，我经常使用它。

该`tasks`应用程序可以从应用程序中导入模型`core`，但反之则不行。

我还有一个`mms`应用程序，它处理多媒体创建和转换（缩略图等）。`mms`可以从以前的应用程序中导入模型。所以我们现在的导入关系是这样的：core -> tasks -> mms。

我创建的每个其他应用程序都特定于我正在处理的当前项目，并基于以前的应用程序构建。所以基本上我会尝试“**单向进口**”，如果你可以这么称呼的话。

我最终得到了与此类似的模型：

```
# models.py of an app called  "articles"

from core.models import UUIDModel, ActivatedModel
from tasks.models import ManagedTasksModel

class Article(UUIDModel, ActivatedModel, ManagedTasksModel):
    title = models.CharField()
    # blah... 
```

如果一个应用程序变得太大，我会**按照**上述规则将`models.py`模块分解成更小的模块来“微观管理”该应用程序。我发现这可以满足我的大部分需求。

 **我不能评论基于类的视图，因为老实说我不喜欢它们，而且它几乎总是让我写更多的代码而不是更少的代码。各有各的。我更喜欢使用辅助实用程序函数，并在我的视图函数中充分利用[上下文处理器之类的东西。](https://docs.djangoproject.com/en/1.4/ref/settings/#std%3asetting-TEMPLATE_CONTEXT_PROCESSORS)

我希望我的回答是在你的问题的范围内。

编辑：我刚刚注意到您的使用`related_name`我认为错过了该选项的要点。请参见以下示例：

```
class Message(models.Model):
    sender   = models.ForeignKey(User, related_name='messages_sent')
    receiver = models.ForeignKey(User, related_name='messages_received')
    body     = models.Textfield() 
```

使用上面的模型我们可以做到这一点，可读性很强：

```
u1 = User.objects.get(...)
received = u1.messages_received.all() 
```

...它描述了这种关系的功能目的。所以`related_name`不仅用于具有唯一的相关名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T22:23:25.880

# 关于查看代码

我认为来自应用程序 A 的视图代码不太可能以导致循环导入的方式从应用程序 B 导入视图代码。
如果您碰巧在应用 A 的视图中使用来自另一个应用 B 的视图代码，那么该代码应该属于一个`views.py`文件，但属于`utils.py`（或类似）文件。

应用 A 的模型代码更不可能从应用 B 导入视图代码，因此在应用 B 的视图代码中对应用 A 的模型代码使用顶级导入是完全可以的。

# 关于型号代码

但是，正如您所提到的，`ForeignKey`来自不同应用程序的模型之间存在关系可能会导致循环导入。
使用字符串表示法来`ForeignKey`挑战您的地址，正如 Django 文档所说：

> 如果您需要在尚未定义的模型上创建关系，您可以使用模型的名称，而不是模型对象本身。

这也适用于`ManyToMany`和`OneToOne`关系。

# 关于是否存在公认标准

我不认为真的存在一个，但我认为也许查看`django.contrib`应用程序是相关的。他们使用模型导入。

您可能想查看：

*   [django.contrib.admin.models](https://github.com/django/django/blob/master/django/contrib/admin/models.py)
*   [django.contrib.auth.models](https://github.com/django/django/blob/master/django/contrib/auth/models.py)
*   [django.contrib.comments.models](https://github.com/django/django/blob/master/django/contrib/comments/models.py)

流行的应用程序也使用相同的功能：

*   [美味派.models](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/models.py)
*   [注册模型](https://bitbucket.org/ubernostrum/django-registration/src/27bccd108cde/registration/models.py)

您可能还想查看以下`social_auth`变体的来源：

*   [social_auth.db.django_models.py](https://github.com/omab/django-social-auth/blob/master/social_auth/db/django_models.py)

我认为一般的经验法则是尽可能使用模型导入，但如果需要，请准备好使用字符串表示法。**

# objective-c - 用于排查嵌套块的推荐工具

> ID：12253735
> 
> 赞同：0
> 
> 时间：2012-09-03T20:34:23.960
> 
> 标签：objective-c, debugging, objective-c-blocks

可能存在哪些工具来解决嵌套块的问题（例如 - 识别捕获的变量、保留周期等）？我也有兴趣了解您推荐的使用嵌套块的参考材料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T02:24:28.583

听起来您在询问使用哪些工具进行内存管理分析。

我从 Allocations 工具开始，特别是[Heapshot Analysis](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)。它非常擅长识别重复事件的任何永久性增长（但也可以用于非重复情况）。

您可以打开对保留/释放事件的跟踪，并查看是否有任何块辅助函数（由编译器生成）是保留的来源。

当然，“构建和分析”您的代码。编译器已经非常擅长通过块拾取保留周期，尤其是在启用 ARC 的情况下。（虽然还有很长的路要走）。

识别块中捕获状态的工具并不多。

* * *

在 Allocations 工具上，单击小 (i) 并打开*Only track active allocations*和*Record reference counts*。

前者将显着减少 Instruments 跟踪的数据集，使其更加快捷，而后者将跟踪任何给定对象的所有保留/释放事件，包括事件源的回溯。

# java - java.util.vector 不能转换为 javax.collections.observablelist

> ID：12253737
> 
> 赞同：0
> 
> 时间：2012-09-03T20:34:34.317
> 
> 标签：java, tableview, javafx, observable

我收到此错误：

> java.util.vector 不能转换为 javax.collections.observablelist

尝试使用 List 填充 TableView 时

这是我的代码错误发生在最后一行

```
try {
   emf = Persistence.createEntityManagerFactory("shopPu");
   em = emf.createEntityManager();
   List<Products> proList = em.createQuery("select p from Products p").getResultList();
   tableView.setItems((ObservableList<Products>)proList);
} catch (Exception e) {
   JOptionPane.showMessageDialog(null, e.getMessage());
} 
```

我如何将 List 绑定到我的表或将 List 转换为 ObservableList 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:37:33.943

用于[`FXCollections`](http://docs.oracle.com/javafx/2/api/javafx/collections/FXCollections.html)创建`ObservableList`.

```
ObservableList<E> observableList = FXCollections.observableList(list); 
```

# java - 如何从图像中删除宽度未知的边框

> ID：12253739
> 
> 赞同：1
> 
> 时间：2012-09-03T20:34:41.437
> 
> 标签：java, android, image-processing

我正在尝试构建一个可以从图像中删除单色边框的程序。

边框始终为白色，但左侧和右侧的边框宽度可能与顶部和底部的边框宽度不同。所以我要提取的图像位于源图像的中心。

所以从下图中我想提取绿色矩形。

![在此处输入图像描述](../Images/82cb114c9f6d800a663880300453d7ee.png)

目前我不知道如何开始解决这个问题。

**更新**

所以最后calsign的代码片段和一些改进，解决了我的问题。我意识到内部图像周围的边框可能不是完全单一的颜色，但可能会略有不同。这导致某些图像留下小边框的行为。

我通过将两种颜色的颜色距离与阈值进行比较来改进两个像素颜色的比较，从而解决了这个问题。当距离低于阈值时，颜色将被同等处理。

```
public Bitmap cropBorderFromBitmap(Bitmap bmp) {
            //Convenience variables
    int width = bmp.getWidth();
    int height = bmp.getHeight();

    int[] pixels = new int[height * width];

    //Load the pixel data into the pixels array
    bmp.getPixels(pixels, 0, width, 0, 0, width, height);

    int length = pixels.length;

    int borderColor = pixels[0];

    //Locate the start of the border
    int borderStart = 0;
    for(int i = 0; i < length; i ++) {

        // 1\. Compare the color of two pixels whether they differ
        // 2\. Check whether the difference is significant    
        if(pixels[i] != borderColor && !sameColor(borderColor, pixels[i])) {
            Log.i(TAG,"Current Color: " + pixels[i]);                   
            borderStart = i;
            break;
        }
    }

    //Locate the end of the border
    int borderEnd = 0;
    for(int i = length - 1; i >= 0; i --) {
        if(pixels[i] != borderColor && !sameColor(borderColor, pixels[i])) {
            Log.i(TAG,"Current Color: " + pixels[i]);
            borderEnd = length - i;
            break;
        }
    }

    //Calculate the margins
    int leftMargin = borderStart % width;
    int rightMargin = borderEnd % width;
    int topMargin = borderStart / width;
    int bottomMargin = borderEnd / width;

    //Create the new, cropped version of the Bitmap
    bmp = Bitmap.createBitmap(bmp, leftMargin, topMargin, width - leftMargin - rightMargin, height - topMargin - bottomMargin);
    return bmp;
}

private boolean sameColor(int color1, int color2){
    // Split colors into RGB values
    long r1 = (color1)&0xFF;
    long g1 = (color1 >>8)&0xFF;
    long b1 = (color1 >>16)&0xFF;

    long r2 = (color2)&0xFF;
    long g2 = (color2 >>8)&0xFF;
    long b2 = (color2 >>16)&0xFF;

    long dist = (r2 - r1) * (r2 - r1) + (g2 - g1) * (g2 - g1) + (b2 - b1) *(b2 - b1);

    // Check vs. threshold 
    return dist < 200;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:13:51.530

如果图片周围的边框是统一的，那么您需要做的就是调查图像中的像素何时发生变化。但首先是第一 - 你需要有一个 BufferedImage 对象来使用。这是一个允许您遍历图像位图的类（[http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html](http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html)）。如果您将图像保存为文件，则需要调用此方法：

```
BufferedImage bimage = ImageIO.read(new File(file)); 
```

现在您可以从 bimage 中获取位图数组：

```
bimage.getRGB(int startX, int startY, int w, int h, int[] rgbArray, int offset, int scansize) 
```

像这样：

```
int[] rgb = bimage.getRGB(0, 0, bimage.getWidth(), bimage.getHeight(), null, 0, bimage.getWidth()); 
```

ColorModel 可能存在一些问题，因此请务必阅读有关如何从不同文件类型中获取适当 rgb 的文档。

现在您已经有了 rgb 数组，您应该开始搜索框架从图片中间延伸了多远。请记住，这是一个一维数组——所有的行都一个接一个地按顺序写在这里——就好像你把图片切成1个像素高的行，然后把它们粘在一起形成一条长线。

这实际上对我们有利，因为我们在此表中遇到的第一个不同像素将作为一个很好的参考点。

所以现在我们只做这样的事情：

```
int pixel1=0,pixel2=0, i=0;
while(pixel1==pixel2 && i<bimage.getWidth()*bimage.getHeight()){
    pixel1=pixel2;
    pixel2=rgb[i++];
} 
```

所以现在如果你的图像的框架是统一的，顶部偏移量与底部偏移量相同，左侧偏移量与右侧偏移量相同，那么变量 i 中的数字很可能是绿色中的第一个像素长方形。

为了知道它是哪一行和哪一列，您需要以下代码：

```
 int row= i%bimage.getWidth();
 int column= i - row*bimage.getWidth(); 
```

现在的问题是，您可能在框架中嵌入了一个图像，该图像的左上角与框架的颜色相同 - 例如，一个绿色矩形的图像，在白色框架中带有白色角。是这样吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:55:38.323

也许不是最好地使用 API 来找到解决方案，而是想到的一个：直接修改图像的像素。

您可以获取 a`Bitmap`的像素，[`getPixels()`](http://developer.android.com/reference/android/graphics/Bitmap.html#getPixels%28int%5B%5D,%20int,%20int,%20int,%20int,%20int,%20int%29)然后创建一个新的、裁剪`Bitmap`的[`createBitmap()`](http://developer.android.com/reference/android/graphics/Bitmap.html#createBitmap%28android.graphics.Bitmap,%20int,%20int,%20int,%20int%29 "创建位图（） |  参考 |  安卓开发者"). 然后，只需找到边界的尺寸即可。

您可以通过访问位于 position 的像素找到边框的颜色，`0`然后将该值 (an `int`) 与每个后续像素的值进行比较，直到到达边框（不是该颜色的像素）。稍加一点数学，就可以做到。

下面是一些简单的代码来说明这一点：

```
private void cropBorderFromBitmap(Bitmap bmp) {
    int[] pixels;
    //Load the pixel data into the pixels array
    bmp.getPixels(pixels, 0, width, 0, 0, width, height);

    //Convenience variables
    int width = bmp.getWidth();
    int height = bmp.getHeight();
    int length = pixels.length;

    int borderColor = pixels[0];

    //Locate the start of the border
    int borderStart;
    for(int i = 0; i < length; i ++) {
        if(pixels[i] != borderColor) {
            borderStart = i;
            break;
        }
    }

    //Locate the end of the border
    int borderEnd;
    for(int i = length - 1; i >= 0; i --) {
        if(pixels[i] != borderColor) {
            borderEnd = length - i;
            break;
        }
    }

    //Calculate the margins
    int leftMargin = borderStart % width;
    int rightMargin = borderEnd % width;
    int topMargin = borderStart / width;
    int bottomMargin = borderEnd / width;

    //Create the new, cropped version of the Bitmap
    bmp = createBitmap(bmp, leftMargin, topMargin, width - leftMargin - rightMargin, height - topMargin - bottomMargin);
} 
```

这是未经测试的并且缺乏错误检查（例如，如果宽度为 0 怎么办？），但它应该用作概念验证。

编辑：我刚刚意识到我未能完成该`getPixels()`方法。测试你的代码的奇迹......它现在已经修复了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:54:25.880

您可以使用**`public int getPixel (int x, int y)`**为每个像素返回其颜色的函数
它应该很容易穿过边界线并验证颜色是否仍然相同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-10T07:30:24.207

这是我的解决方案：

```
 private Bitmap cropBorderFromBitmap(Bitmap bmp) {

        final int borderWidth = 10; //preserved border width
        final int borderColor = -1; //WHITE

        int width = bmp.getWidth();
        int height = bmp.getHeight();

        int[] pixels = new int[width * height];
        bmp.getPixels(pixels, 0, width, 0, 0, width, height);

        int minX = -1;
        int minY = -1;
        int maxX = -1;
        int maxY = -1;

        for(int y = 0; y < height; y++) {
            for(int x = 0; x < width; x++) {
                if(bmp.getPixel(x,y) != borderColor) {
                    minX = (minX == -1) ? x : Math.min(x, minX);
                    minY = (minY == -1) ? y : Math.min(y, minY);

                    maxX = (maxX == -1) ? x : Math.max(x, maxX);
                    maxY = (maxY == -1) ? y : Math.max(y, maxY);
                }
            }
        }

        minX = Math.max(0, minX - borderWidth);
        maxX = Math.min(width, maxX + borderWidth);
        minY = Math.max(0, minY - borderWidth);
        maxY = Math.min(height, maxY + borderWidth);

        //Create the new, cropped version of the Bitmap
        return Bitmap.createBitmap(bmp, minX, minY, maxX - minX, maxY-minY);
    } 
```

# php - 使用 PHP 正则表达式部分隐藏电子邮件地址？

> ID：12253740
> 
> 赞同：5
> 
> 时间：2012-09-03T20:34:45.167
> 
> 标签：php, regex, email

> **可能重复：**
> [正则表达式部分隐藏电子邮件？](https://stackoverflow.com/questions/11708565/regexp-to-partly-hide-email)

我目前正在编写一个隐藏电子邮件地址的脚本（因此 test@domain.com 变为 t~~~@~~~~~~.com）。

在遵循有关此问题的说明时 - 正则[表达式部分隐藏电子邮件？](https://stackoverflow.com/questions/11708565/regexp-to-partly-hide-email)- 我设法让它显示 t~~~@domain.com，但在删除“域”时遇到了麻烦。

这是我到目前为止所拥有的（假设 $row->email 是“test@domain.com”）：-

```
$string = preg_replace("(?<=.).(?=.*@)","~", $row->email);
$string = preg_replace("(?<=@).[a-zA-Z0-9]*","~", $string); 
```

然而，它返回的只是 t~~~@~omain.com

我对如何获得域的其余部分感到困惑。想法？

理想情况下，如果有人可以提供解决方案，使其变为 t~~~@d~~~~~~.com，那就太好了。

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:43:52.880

这是 ..

*   匹配（和跳过）`"@"`然后；
*   匹配`.`（任何字符：即`"d"`in `"domain"`）然后；
*   匹配以下字符类的**0（零）** ，这是匹配提供的正则表达式*所需的最小值。*

也就是说，匹配后的*第一个也是唯一的第一个*字符`@`被匹配并替换为`~`.

以下

```
(?<=@.)[a-zA-Z0-9-]*(?=(?:[.]|$)) 
```

强制字符类匹配第一个`"."`（句`".com"`点，如 ）或输入结尾。

请注意，将`.`移动到 -look-behind 子句内部，*这*`(?<=@.)`会导致它跳过 . 之后的第一个字母`"@"`。我还在`"-"`字符类中添加了一个连字符 ( )，因为它们在域名中是有效的（并且并不少见）。

此外，并非所有电子邮件地址都采用普通`"a@b.c"`格式，并且[国际化域名（或 IDN）在不传输时](http://en.wikipedia.org/wiki/Internationalized_domain_name) *可以*在本地以非[punycode](https://www.rfc-editor.org/rfc/rfc3492)形式表示（例如，未在限制性上下文中使用），但这是另一个主题。（由于 IDN 没有进一步说明，`[a-zA-Z0-9-]*`替换为可能更合适。）`[^.]*`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:15:01.773

你也可以这样做，如果没有的话，至少很容易阅读和修改：

```
$email = $row->email;
$atPos = strpos( $email, "@" );
preg_match('/(\..*?)$/', $email, $topDomain, PREG_OFFSET_CAPTURE);
$emailLength = strlen($email);

$hiddenEmail = $email[0] . 
               str_repeat('~', $atPos-1) . 
               "@" . 
               $email[$atPos + 1] . 
               str_repeat('~', $topDomain[1][1]-$atPos-2) . 
               $topDomain[1][0]; 
```

# algorithm - 二叉搜索树中删除节点的伪代码和条件

> ID：12253746
> 
> 赞同：2
> 
> 时间：2012-09-03T20:35:18.607
> 
> 标签：algorithm, data-structures, pseudocode, binary-search-tree

我正在尝试编写一个函数来从二叉树中删除一个节点。我还没有对函数进行编码，我正在尝试考虑删除节点时应该考虑的不同条件。我猜可能的条件是：

1.  该节点没有子节点

2.  该节点有一个孩子

3.  该节点有 2 个孩子

在每种情况下，执行删除功能的算法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T21:08:35.590

这是您在任何有关算法的标准教科书中都可以找到的内容，但假设您对不平衡情况感兴趣（平衡树通常在移除后执行一些称为“旋转”的重新平衡操作）并且您使用“明显”数据结构（一种`tree_node`结构保存值和两个指向 other 的指针`tree_node`）：

1.  **无子**节点：释放节点持有的内存，并将指向它的父节点的子链接设置为`NULL`；
2.  **一个子**节点：释放节点持有的内存，并将指向它的父节点的子链接设置为其唯一子节点的地址；
3.  **两个孩子**：这确实是一个“复杂”的案例。找到左孩子的最右边的节点（或右孩子的最左边的节点），取其值，将其移除（是“case 1”，所以很简单，可以递归完成）并将当前节点的值设置为该节点之一。这是`O(tree_height) = O(n)`，但它不是问题（至少在理论上），因为这将是查找节点的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:48:42.660

你的树有任何额外的属性吗？是AVL吗？

如果没有，有一些非常明显和直接的方法可以做你想做的事（这将取决于你的数据表示，正如 Vitalij 所说）。

例如，如果它是 AVL，还有一些众所周知的方法可以做到这一点（维基百科会告诉你更多关于该主题的信息）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T20:52:09.593

第一个任务是查找节点是否存在，这将在搜索期间完成，并且您的其余条件是否正确。

1.  **叶节点：**将父节点的子节点（右/左）设置为 NULL。

2.  **有一个子**节点：只需将要删除的节点的子节点设置为其父节点的子节点。

3.  **有两个孩子：**基本上必须通过为要删除的节点找到新的孩子来修剪子树来重新排序整个子树。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T21:24:21.753

假设您正在处理一般二叉树，请执行以下操作，

1.  节点没有子节点-即它是叶子：方便地删除它..

2.  节点有一个子节点 - 将要删除的节点的父节点设为其子节点的父节点，然后删除该节点。即，如果`A->Parent = B; C->Parent = A;`并且`A`必须删除，则 1\. Make `C->Parent = B`；2.删除`A`；

3.  棘手的一个....是的，将要删除的节点替换为右子树的最左边的子树，或者替换为左子树的最右边的树，都可以......因为可以这样看，

当一个节点被删除时，它必须被一个满足某些属性的节点替换......假设我们的二叉树在中序遍历中表示排序数字（按递增顺序），那么被删除的节点应该被某个节点替换它的任何一个子树。这应该大于整个剩余的左子树，并且小于整个剩余的右子树（剩余意味着在成功调整删除节点后剩余的子树）。只有两个这样的节点存在，右子树的最左边的叶子，或者左边的最右边的节点。

因此，从任一节点替换已删除的节点就足够了……！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-26T08:35:43.360

从二叉搜索树中一次删除一个给定的键。可能的相等键被插入到现有节点的左分支中。请注意，插入策略也会影响删除的执行方式

BinarySearchTree-删除

```
Node Delete(Node root, Key k)
1  if (root == null) // failed search
2    return null;
3  if (k == root.key) // successful search
4    return DeleteThis(root);
5  if (k < root.key) // k in the left branch
6    root.left = Delete(root.left, k);
7  else // k > root.key, i.e., k in the right branch
8    root.right = Delete(root.right, k);
9  return root;

Node DeleteThis(Node root)
1  if root has two children
2    p = Largest(root.left); // replace root with its immediate predecessor p
3    root.key = p.key;
4    root.left = Delete(root.left, p)
5    return root;
6  if root has only left child
7    return root.left
8  if root has only right child
9    return root.right
10  else root has no children
11   return null

Node Largest(Node root)
1  if root has no right child
2    return root
3  return Largest(root.right) 
```

# c# - 两个 ulong（无符号长）值之差的 Math.Abs

> ID：12253750
> 
> 赞同：6
> 
> 时间：2012-09-03T20:36:38.910
> 
> 标签：c#, .net, math

我正在寻找返回类型为 ulong 的 Math.Abs​​(ulong,ulong)。但似乎微软只实现了 long、int 等。还有另一种快速的方法吗？

对不起，需要更正：

```
Math.Abs(ulong - ulong) 
```

所以它可能会变成负数，并且超出长期的范围。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-03T20:38:28.270

无符号长整型值始终为正，因为它们不包含符号。因此，`Math.Abs`对于`ulong`.

* * *

鉴于您的新问题，您可以使用：

```
ulong difference = first > second ? first-second : second-first; 
```

这将为您提供两个值之间的差异，这实际上是您通过减去两个值得到的结果的绝对值，就好像它们已签名一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:41:58.840

为了避免超出范围，我认为你想要这样的东西：

```
a > b ? a-b : b-a 
```

# request - 无法使用 Appcelerator 将图像上传到远程服务器

> ID：12253752
> 
> 赞同：0
> 
> 时间：2012-09-03T20:36:47.897
> 
> 标签：request, titanium, appcelerator, image-uploading

我正在使用的应用程序使用由另一个团队开发的 API。我正在开发 Titanium 2.1.2，并且正在尝试使用所述 API 上传照片。我正在使用 Appcelerator 的 HTTPClient 发出请求。这是我的代码：

```
 var url = 'http://api.veramiko.com/albums/' + album.veramiko_id + '/photos';
    var photo = imageView.toBlob();

    var args = { //parameters sent to post photo
        file : photo,
        description : descriptionText
    };

    var client = Ti.Network.createHTTPClient({
        onload : function(e){
            Ti.API.info(this.responseText); //Print the result
        },
        onerror : function(e){
            Ti.API.error(this.responseText); //Print the result
        },
        timeout : 60000
    });
    client.open('POST', url);
    client.setRequestHeader('Authorization', 'Bearer ' + token);
    client.setRequestHeader('Content-type', "multipart/form-data");
    client.send(args); 
```

令牌是我们用来授权对服务器发出的任何请求的变量。我认为仅将图像从 ImageView 转换为 Blob 就足以发送照片，但照片并未上传。帖子是使用描述创建的，但照片未正确发送。

我需要添加其他东西吗？将照片作为 Blob 发送是否正确？

**编辑：**我阅读了这个[链接](http://www.smokycogs.com/blog/titanium-tutorial-how-to-upload-a-file-to-a-server/)，我尝试了以下没有结果：

```
 var url = 'http://api.veramiko.com/albums/' + album.veramiko_id + '/photos';
    var boundary = '-_1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var photo = imageView.toBlob();

    var args = {
        file : photo,
        description : descriptionText.value
    };      

    var contentDisposition = "--" + boundary + "\r\n"; 
    contentDisposition += "Content-Disposition: form-data; name=\"file\";";
    contentDisposition += "filename=\"" + imageView.image + "\"\r\n\";";
    contentDisposition += "Content-Type: application/octet-stream\r\n\r\n";

    var fullContent = contentDisposition + photo  + "\r\n--" + boundary + "--";

    alert(JSON.stringify(args));
    var token = JSON.parse(Ti.App.Properties.getString('loggedUser', 'No existe')).networks[0].token;
    var client = Ti.Network.createHTTPClient({
        onload : function(e){
            Ti.API.info(this.responseText); //Print the result
        },
        onerror : function(e){
            Ti.API.error(this.responseText); //Print the result
        },
        timeout : 60000
    });
    client.open('POST', url);
    client.setRequestHeader('Authorization', 'Bearer ' + token);
    client.setRequestHeader('Content-Type', "multipart/form-data; boundary=\"" + boundary + "\"");
    client.setRequestHeader('Connection', 'close');
    client.send(fullContent); 
```

我试图用 Content-Disposition 和 Content-Type 标头包装文件，但没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T19:09:06.260

我终于找到了解决这个问题的方法。请参考以下[链接](http://developer.appcelerator.com/question/88371/image-upload-directly-from-camera)。

这就是我的代码最终的样子：

```
 // I put the contents of my image into a variable
var f = imageHolder.toImage();
    // I create a random name for the image
var tmpName = (new Date()).getTime().toString() + '.png';
    // I create a folder where I will store the photo temporally
var g = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, 'picturesToUpload');
if (!g.exists()) {
    // If the directory doesn't exist, make it
    g.createDirectory();
};
var photo = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, 'picturesToUpload', tmpName);
    // write the contents of the image into the file
photo.write(f);
    // I create my url with the albumId where I'll upload the picture
var url = 'http://api.veramiko.com/albums/' + albumId + '/photos';
var args = {
    file : photo.read(), // I read the contents of the file
    description : ''
}
var token = JSON.parse(Ti.App.Properties.getString('loggedUser', 'No existe')).networks[0].token;
var client = Ti.Network.createHTTPClient({
    onload : function(e){
        Ti.API.info('Info received from the uploading: ' + this.responseText);
    },
    onerror : function(e){
        Ti.API.debug('Error: ' + this.responseText);
    },
        timeout : 60000
});
client.open('POST', url);
    // these headers are important
client.setRequestHeader('enctype', 'multipart/form-data');
client.setRequestHeader('Content-Type', 'image/png');
client.setRequestHeader('Authorization', 'Bearer ' + token);
client.send(args); 
```

希望这个信息可以帮助更多的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T05:21:20.473

首先你清楚你的 API 参数是什么。以及您想在哪里使用 TOKEN。

```
var imageView = Ti.UI.createImageView({
    backgroundImage : "image.png",
});
    var url = 'http://api.veramiko.com/albums/' + album.veramiko_id + '/photos';

        var args = { //parameters sent to post photo
            file : imageView.backgroundImage,
            description : descriptionText,
            token : "Token",
        };

        var client = Ti.Network.createHTTPClient({
            onload : function(e){
                Ti.API.info(this.responseText); //Print the result
            },
            onerror : function(e){
                Ti.API.error(this.responseText); //Print the result
            },
            timeout : 60000
        });
        client.open('POST', url);
        client.setRequestHeader("Content-type","multipart/form-data");
        client.setRequestHeader("Content-length", args.length);
        client.send(args); 
```

试试这个，我认为这对你有用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T16:25:00.133

我找到了本教程，其中介绍了如何构建上传器。

[Titanium Mobile：构建图像上传器](http://mobile.tutsplus.com/tutorials/appcelerator/titanium-mobile-build-an-image-uploader/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-05T05:44:49.173

您可以使用此代码在 form-data 中上传文件：

```
var baseurlAPI = "YOUR API BASEURL HERE";
var file = Ti.Filesystem.getFile(pathToFile);

 if(file.exists()){
    var xhr = Ti.Network.createHTTPClient({
        onload: function(e) {
                Ti.API.log('success '+this.responseText);
       },
       onerror: function(e) {
                Ti.API.error(this.responseText);
        },
            timeout : -1
    });
    xhr.open('POST', baseurlAPI);
    xhr.send({
       file: file
    });
 }else{
    console.log('didnt exist ' + file.nativePath);
 } 
```

# java - 在java中生成随机顺序但有约束

> ID：12253759
> 
> 赞同：4
> 
> 时间：2012-09-03T20:37:24.757
> 
> 标签：java, sequence

当我放置一个整数列表时，如何生成另一个随机顺序但有约束？

例如，我将整数 1、2、3、4 放入集合中，当我尝试打印结果时，例如 "1 2 3 4","1 2 4 3","1 3 2 4" ,"2 1 3 4" 或 "2 1 4 3"（1 必须在 3 之前，2 必须在 4 之前）

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:43:05.233

您可以考虑的一件事是随机交换元素。您可以在集合中选择一个随机位置，然后将该位置的元素与下一个元素交换。这样，您可以防止将 1 与 3 或 2 与 4 交换。您可以重复执行此操作，直到数字被正确打乱：

`[1, 2, 3, 4]`随机数为 0，与位置 1 的元素交换。

`[2, 1, 3, 4]`随机数为 1，与位置 2 的元素交换。

元素是 1 和 3，所以不要交换。

`[2, 1, 3, 4]`随机数为 2，与位置 3 的元素交换。

`[2, 1, 4, 3]`等等

如果您想概括约束，您可以简单地更改条件。当元素是 1 和 3 或 2 和 4 时（如上面的示例），您可以确保要交换的位置处的两个元素彼此不在 2 之内，而不是拒绝交换，例如`if(b==a+2)continue;`：

元素是 5 和 7，所以不要交换。

```
if(7==5+2)continue; // ie don't swap. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:26:24.607

您在此处定义的内容称为[偏序](http://en.wikipedia.org/wiki/Partially_ordered_set_)。您希望生成仍然满足偏序的随机排列，即随机线性扩展。

幸运的是，Java API 指定了[`Collections.shuffle`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)，它实现了 Fisher-Yates 算法来生成随机排列。不幸的是，标准的 Java 技术 via[`Collections.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)是*比较排序*，因此专注于全序——不像我们想要的偏序。事实上，Java API 缺少我们可以在这里使用的排序算法。

[“通过转置生成 Posets 的线性扩展”中](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.47.8966)介绍的一种方法涉及以类似于 Hassan 的解决方案的方式交换集合中的相邻元素。对于手头的局部问题，这似乎是一种有效的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T21:05:49.557

如果将其用作字符串，则可以使用[此](https://stackoverflow.com/questions/4240080/generating-all-permutations-of-a-given-string)答案的算法来交换所有数字

当您输入所有数字时，只需将它们连接在一起即可。无需将它们视为数字或字符串。您要做的就是重新排序它们。

当你得到结果时，你可以检查你的约束是否匹配，然后打印出另一个列表。可能是这样的

```
private boolean isConstraintSatisfied(String wholeString, String firstNum, String secondNum){
    return wholeString.indexOf(firstNum) <= wholeString.indexOf(secondNum);
} 
```

不是最优雅的解决方案，但我认为它会起作用。对于小型输入集，它不应该太低效。

# html - HTML5 Websocket + Node.js 实时通知系统

> ID：12253762
> 
> 赞同：0
> 
> 时间：2012-09-03T20:38:04.837
> 
> 标签：html, node.js, facebook-graph-api, notifications, websocket

在过去的几周里，我使用**HTML5 Websockets 和 node.js 和 socket.io 构建了一个小型通知系统。** 还有一些事情我还没有解决。

我已经读过使用 node.js 的实时通知应该是最好的性能解决方案，而不是长轮询等，因为非阻塞 i/o 操作。

现在假设我们必须通知这个用户的朋友。诸如“我买了一部新 iPhone”之类的东西。如何教 node.js 实时通知特定用户 1:n？直到知道我只有发送和接收消息 1-1 通信。这意味着我必须先检查 facebook api 好友列表并找出哪个 facebook_id 以某种方式与哪个 socket_id 连接。然后检查用户的隐私设置，如果他想接收通知，然后发送并保存到数据库中。

所以对我来说，这似乎不是最有效的解决方案......

目前**我会为 node.js 使用 mongo-db 本机驱动程序，并通过服务器端的 javascript 完成数据库操作。我仍然需要实现 facebooks javascript sdk 来获取好友列表，但我会遇到用户隐私设置的问题。**这不会破坏非阻塞 I/O 的所有优点吗？

你如何实际解决这个问题。对我来说，这似乎很复杂。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:51:57.147

你不应该去 Facebook 检查朋友列表等等。你应该缓存它们，我假设用户已经登录，如果这样，解决方案似乎很容易。

1.  获取用户。
2.  检查发件人是否是他的朋友
3.  检查收件人是否想收到邮件。

顺便说一句，redis 要快得多。

编辑：如果您担心用户数据不会被更新，这就是您不缓存的原因，您应该检查[Real-time Updates](https://developers.facebook.com/docs/reference/api/realtime/)。

# android - 使用 dexclassloader 使用外部库编译的 Android 加载类

> ID：12253770
> 
> 赞同：2
> 
> 时间：2012-09-03T20:38:45.597
> 
> 标签：android, classloader

我想在我的案例 JadeAndroid.jar 中加载使用外部库编译的 Android 中的类（使用 dexClassLoader）。此类（dex）在包含所有 JadeAndroid 类的 jar 中导出（我正在使用 ant 脚本）。我的类扩展了玉类行为。当我加载这个类时，我有一个例外：

```
09-03 21:53:05.319: W/dalvikvm(23201): Class resolved by unexpected DEX:Lcom/example/dex/lib/LibraryProvider;(0x40d80838):0x411aa8 ref[Ljade/core/behaviours/Behaviour;] Ljade/core/behaviours/Behaviour;(0x40d81d18):0x419158
09-03 21:53:05.319: W/dalvikvm(23201): (Lcom/example/dex/lib/LibraryProvider; had used a different Ljade/core/behaviours/Behaviour; during pre-verification)
09-03 21:53:05.319: W/dalvikvm(23201): Unable to resolve superclass of Lcom/example/dex/lib/LibraryProvider; (337)
09-03 21:53:05.319: W/dalvikvm(23201): Link of class 'Lcom/example/dex/lib/LibraryProvider;' failed
09-03 21:53:05.319: W/System.err(23201): ***  Uncaught Exception for agent buyer1  ***
09-03 21:53:05.319: W/System.err(23201): java.lang.IllegalAccessError: Class ref in pre-verified class resolved to unexpected implementation
09-03 21:53:05.319: W/System.err(23201):    at dalvik.system.DexFile.defineClass(Native Method)
09-03 21:53:05.329: W/System.err(23201):    at dalvik.system.DexFile.loadClassBinaryName(DexFile.java:195)
09-03 21:53:05.329: W/System.err(23201):    at dalvik.system.DexPathList.findClass(DexPathList.java:315)
09-03 21:53:05.329: W/System.err(23201):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:58)
09-03 21:53:05.329: W/System.err(23201):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
09-03 21:53:05.329: W/System.err(23201):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
09-03 21:53:05.329: W/System.err(23201):    at pl.edu.kosttek.jadebook.agent.AgentBuyerLoader$GetJarBehaviour.getBehaviour(AgentBuyerLoader.java:227)
09-03 21:53:05.329: W/System.err(23201):    at pl.edu.kosttek.jadebook.agent.AgentBuyerLoader$GetJarBehaviour.action(AgentBuyerLoader.java:166)
09-03 21:53:05.329: W/System.err(23201):    at jade.core.behaviours.Behaviour.actionWrapper(Behaviour.java:344)
09-03 21:53:05.329: W/System.err(23201):    at jade.core.Agent$ActiveLifeCycle.execute(Agent.java:1532)
09-03 21:53:05.329: W/System.err(23201):    at jade.core.Agent.run(Agent.java:1471)
09-03 21:53:05.329: W/System.err(23201):    at java.lang.Thread.run(Thread.java:864) 
```

我如何将我的类编译为 jar：

1.  把 JadeAndroid.jarto libs 文件夹

2.  使用创建 dex 并将其放入 jar 的 ant 脚本

可以排除这个 AndroidJade 类吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:50:08.380

我认为问题在于 Jar 中有 Jade 类，而 Classloader 中已有相同的 Jade 文件，这对 JVM 具有误导性。

也许您可以尝试编译 JAR，但不编译 Jade 类呢？所以只需包含它进行编译，但它们不会出现在 JAR 中吗？在这种情况下，您在加载类时不会出现问题，并且可以实现目标。

**Upd** : 如果你是用 Android 方式编译 Jar，所以我会建议链接 Jade 进行编译，但不要把它放到 libs/ 文件夹中。它将阻止它被编译到 jar 中。

祝你好运

# openid - OpenID Provider 和 OpenID WebRing SSO Provider 有什么区别？

> ID：12253774
> 
> 赞同：5
> 
> 时间：2012-09-03T20:39:20.703
> 
> 标签：openid, dotnetopenauth, openid-provider

我正在查看[DotNetOpenAuth 示例](https://github.com/DotNetOpenAuth/DotNetOpenAuth.Samples)，并且有两个 OpenID 提供程序示例；和 OpenID Provider 和 OpenID Web Ring SSO Provider。

有谁知道两者之间的区别，以及应该在哪种情况下使用它们？我特别想看看什么时候应该使用 Web Ring SSO Provider。我知道 OpenID Provider 提供什么。

给出一些背景；我需要整合一个 OpenID 提供程序，以便为我正在开发的多个 Web 应用程序提供单点登录解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T23:23:52.917

SSO 示例从声音中展示了您正在寻找的更多内容。OpenIdProvider 更像是面向 Internet 的提供商，为所有依赖方提供服务，而 WebRingSSOProvider 仅针对特定 RP 对用户进行身份验证，如果用户已经登录，则允许他们在受信任的站点网络中隐式登录用户.

# html - 下拉菜单出现在 div 之外的其他内容后面

> ID：12253775
> 
> 赞同：0
> 
> 时间：2012-09-03T20:39:22.663
> 
> 标签：html, css, drop-down-menu

我创建了一个使用 javascript 的导航菜单。我在主菜单的某些部分有下拉菜单，但是当我单击箭头时，它只显示下拉到 div 的末尾（见图）：

![在此处输入图像描述](../Images/3ae2856382f8aa90cfb135b0c7b38e27.png)

我怎样才能得到它，以便下拉出现在顶部。我试过溢出：可见，但这似乎不起作用。

HTML：

```
<div id="top_bar">
<div id="top_inner">
<div id="logo"> <a href="http://www.edosbornephotography.com"><img src="images/logo.gif" alt="Ed Osborne" width="220" height="100" class="logo"></a></div>
<div class="nav">
<ul class = "menu" >
            <li> <a href = "#" > Home </a> </li>
            <li><a href = "#" > Tutorials </a>
        <ul class = "submenu" >
            <li> <a href = "#" > CSS </a> </li>
            <li> <a href = "#"> Javascript </a> </li>
            <li> <a href = "#" > jQuery </a> </li>
            <li> <a href = "#"> HTML </a> </li>
            <li> <a href = "#" > PHP </a> </li>
        </ul>
        </li> 
```

CSS：

```
.nav {
margin: 0 auto;
position: relative;
padding-top: 85px;
}

ul.menu {
list-style: none;
padding: 0 22px;
margin: 0;
float: left;
background: #222;
font-size: 1.2em;
background: url(../images/topnav_bg.gif) repeat-x;
}

ul.menu li {
float: left;
margin: 0;  
padding: 0 15px 0 0;
position: relative; 
}

ul.menu li ul.submenu {
list-style: none;
position: absolute; 
left: 0; top: 35px;
background: #333;
margin: 0; padding: 0;
display: none;
float: left;
width: 170px;
-moz-border-radius-bottomleft: 5px;
-moz-border-radius-bottomright: 5px;
-webkit-border-bottom-left-radius: 5px;
-webkit-border-bottom-right-radius: 5px;
border: 1px solid #111;
}

ul.menu li ul.submenu li{
margin: 0; padding: 0;
border-top: 1px solid #252525; 
border-bottom: 1px solid #444; 
clear: both;
width: 170px;
}

html ul.menu li ul.submenu li a {
float: left;
width: 145px;
background: #333 url(../images/dropdown_linkbg.gif) no-repeat 10px center;
padding-left: 20px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:42:11.637

您需要在子菜单标签中使用 Z-index

```
ul.menu li ul.submenu {
z-index: 5000; // <-- ADD THIS
list-style: none;
position: absolute; 
left: 0; top: 35px;
background: #333;
margin: 0; padding: 0;
display: none;
float: left;
width: 170px;
-moz-border-radius-bottomleft: 5px;
-moz-border-radius-bottomright: 5px;
-webkit-border-bottom-left-radius: 5px;
-webkit-border-bottom-right-radius: 5px;
border: 1px solid #111;
} 
```

**----根据您在下面的评论进行编辑----**

等等-我认为我们根据您的评论误解了您-您希望子菜单向上移动，使其位于现有菜单之上？（与页面上的内容相反？）如果是这样，您需要在子菜单上执行负边距顶部，如下所示：

```
ul.submenu {
    margin-top:-2em; // adjust me (use 'em' to scale w/ font size adjustments)
} 
```

您需要“位置：绝对；”才能使其正常工作，但您已经在 CSS 的此类中使用了它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-24T20:05:11.117

我相信答案是 z-index，但 z-index 仅适用于定位元素。如果你添加它应该可以工作

```
ul.menu li ul.submenu {
    z-index: 5000;
    position: relative; 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-31T05:56:47.613

确保您的`overflow`设置设置为`:show`。

当我看到我的设置为`hidden`.

# ios - iOS - 应用内购买 - 恢复按钮？

> ID：12253783
> 
> 赞同：1
> 
> 时间：2012-09-03T20:40:31.930
> 
> 标签：ios, in-app-purchase

如果您不提供“恢复购买”选项，我已经看到有关 Apple 拒绝您的应用程序的一些事情。我从未在应用程序中看到过这种情况，但我承认我自己并没有做太多的应用程序内购买。我的问题是，你们是如何实现这个的？不是代码，而是你把按钮放在哪里？您是否只是在应用程序中的某个随机位置放置了“恢复应用内购买”按钮？还是您等待他们进行购买，然后以某种方式检查他们是否进行了购买并为他们提供恢复所有内容的选项？

其他应用程序中的任何此类示例也值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-12T09:19:17.190

我就是这样实现的。在 AppDelegate 调用 isIAPRestoreNeeded 时应用启动并激活：

```
if ([[NSUserDefaults standardUserDefaults] boolForKey:@"SettingsKeyIAPRestoreNeeded"]) {
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"SettingsKeyIAPRestoreNeeded"];

    // IAP restore
    [[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
} 
```

相应的设置条目当然必须在应用程序的设置包中。在我看来是最好的解决方案，因为它不会破坏应用程序的 UI 和 UX。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:45:56.090

[Adobe Photoshop Express](http://itunes.apple.com/en/app/adobe-photoshop-express/id331975235?mt=8)在设置（在应用程序中）中有一个部分，您可以在其中购买项目或恢复购买。您可以免费下载并查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T20:57:21.200

我见过的大多数应用程序都将它放在应用程序设置的帐户部分。由于它通常与您在应用程序中使用您的帐户进行的购买有关，因此我认为这将是您的应用程序用户检查的最佳位置，并且最有可能在需要此类功能时进行检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T21:14:27.313

您应该始终显示它，因为它的要点是如果您删除并重新安装您的应用程序，您将失去您的应用程序内购买。所以你按下按钮让他们回来。我会把它放在与应用内购买本身相同的观点上。只需一个小按钮或一行文本就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T03:48:12.690

如何在设置应用程序中显示它？也许您希望在导航栏中将您的内容作为按钮出售的页面上？或者，如果您在应用程序中对设置进行了分类，请创建一个与您的 IAP 相关的新类别并在其中添加一个恢复按钮？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-08T11:57:29.733

有一个例子：

[http://itunes.com/apps/snowboardlingo](http://itunes.com/apps/snowboardlingo)

（应用内购买的免费应用滑雪板测验/参考）

恢复按钮位于应用程序“信息页面”（i 符号）上。苹果文档说用户会“四处寻找”这个按钮。

# database - Cakephp 多对多递归

> ID：12253785
> 
> 赞同：-2
> 
> 时间：2012-09-03T20:40:42.710
> 
> 标签：database, cakephp

我正在尝试为我的网站创建一个关注功能，以便用户可以互相关注，我正在使用 Cakephp 我应该使用什么样的关系，我应该给表格命名。

注意：我创建了一个包含 user_id 和 follower_id 的用户表 + 关注表！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T23:50:37.287

如果您不需要保存有关关系的任何信息，那么 hasAndBelongsToMany 是在这种情况下使用的自然关系。尝试这个：

```
// User Model
var $hasAndBelonsToMany = array(
    'Follower' => array(
        'className' => 'User',
        'foreignKey' => 'user_id',
        'associationForeignKey' => 'follower_id'
        'joinTable' => 'followers_users'
    )
) 
```

那么您必须像往常一样创建 users 表，并创建一个包含`'followers_users'`列的表：`'id'`, `'user_id'`, `'follower_id'`（如果需要的话）。`'created'``'updated'`

**编辑：** 要检索您的数据（[在此处](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)阅读），您照常进行：

```
$this->User->find('all', array('conditions' => array('id' => 1))); 
```

然后你会得到一个像这样的数组：

```
Array(
    [User] => array(
        [id] => 1
        [name] => xxxx
    )
    [Follower] => array(
        [0] => array(
            [id] => 2
            [name] => yyyy
        )
        [1] => array(
            [id] => 3
            [name] => zzzz
        )
    )
) 
```

要保存数据（[在此处](http://book.cakephp.org/2.0/en/models/saving-your-data.html#saving-related-model-data-habtm)和[此处](https://stackoverflow.com/questions/11665239/cakephp-habtm-dont-save)阅读），您需要创建一个数组，例如：

```
array(
    [User] => array(
        [id] => 1
        [name] => xxx
    )
    [Follower] => array(
        [0] => array(
            [id] => 2
        )
        [1] => array(
            [id] => 3
        )
    )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:12:58.633

**书中对您正在查看的内容/示例的解释是正确的：**

[http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#multiple-relations-to-the-same-model](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#multiple-relations-to-the-same-model)

**每本书的类似示例：**

“也可以创建自我关联，如下所示：”

```
<?php
class Post extends AppModel {
    public $name = 'Post';

    public $belongsTo = array(
        'Parent' => array(
            'className' => 'Post',
            'foreignKey' => 'parent_id'
        )
    );

    public $hasMany = array(
        'Children' => array(
            'className' => 'Post',
            'foreignKey' => 'parent_id'
        )
    );
} 
```

# java - 小物体的像素级碰撞检测失败。（爪哇）

> ID：12253786
> 
> 赞同：3
> 
> 时间：2012-09-03T20:40:59.353
> 
> 标签：java, collision-detection

对于一个项目，我们得到了一个游戏引擎来创建游戏。作为其中的一部分，我们必须在通过边界框检测方法发现可能的碰撞后实施像素级碰撞检测。我已经实现了这两个，但我的像素级测试对于小物体（在这种情况下是子弹）失败了。我已经检查过它是否适用于慢速子弹，但也失败了。

对于我的像素级实现，我使用可用的 IntBuffer（也可以使用 ByteBuffer？）为每个纹理创建位掩码。IntBuffer 是 RGBA 格式，它的大小是宽度*高度，我将它放在一个 2D 数组中，并将所有非零数字替换为 1 以创建掩码。在边界框发生碰撞后，我找到了由重叠表示的矩形（使用 .createIntersection），然后使用按位与检查该交叉点内的两个精灵的贴图是否有非零像素。

这是我的像素级测试代码：

```
/**
 * Pixel level test
 *
 * @param rect the rectangle representing the intersection of the bounding
 * boxes
 * @param index1 the index at which the first objects texture is stored
 * @param index the index at which the second objects texture is stored
 */
public static boolean isBitCollision(Rectangle2D rect, int index1, int index2)
{
    int height = (int) rect.getHeight();
    int width = (int) rect.getWidth();

    long mask1 = 0;
    long mask2 = 0;

    for (int i = 0; i < width; i++)
    {
        for (int j = 0; j < height; j++)
        {
            mask1 = mask1 + bitmaskArr[index1].bitmask[i][j];//add up the current column of "pixels"
            mask2 = mask2 + bitmaskArr[index2].bitmask[i][j];

            if (((mask1) & (mask2)) != 0)//bitwise and, if both are nonzero there is a collsion
            {
                return true;
            }
            mask1 = 0;
            mask2 = 0;
        }

    }

    return false;
} 
```

我已经为此苦苦挣扎了好几天，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T16:33:25.807

我设法解决了我自己的问题，现在它可以正常工作了。对于任何感兴趣的人，我所做的是找到由两个精灵的两个边界框重叠创建的矩形。然后我将每个对象连同它一起放到原点，相对地，相交的矩形。应该注意的是，我将每个对象都放到了一个“单独的”原点——也就是说，之后我实际上有两个相交的矩形——每个对象一个。每个相交矩形的坐标，现在位于两个对象的位掩码 2D 数组的范围内，用于检查两个对象重叠的正确区域：

我通过位掩码从下到上从左到右循环，作为向上提供的图像数据 - 显然这是图像数据的规范。

```
 /**
 * My Pixel level test - 2D
 *
 * @param rect the rectangle representing the intersection of the bounding
 * boxes
 * @param index1 the index at which the first objects texture is stored
 * @param index2 the index at which the second objects texture is stored
 * @param p1 the position of object 1
 * @param p2 the position of object 2
 * @return true if there is a collision at a pixel level false if not
 */
//public static boolean isPixelCollision(Rectangle2D rect, Point2D.Float p1, Bitmask bm1, Point2D.Float p2, Bitmask bm2)
public static boolean isPixelCollision(Rectangle2D rect, Point2D.Float p1, int index1, Point2D.Float p2, int index2)
{
    int height = (int) rect.getHeight();
    int width = (int) rect.getWidth();

    byte mask1 = 0;
    byte mask2 = 0;

    //drop both objects to the origin and drop a rectangle of intersection for each along with them
    //this allows for us to have the co-ords of the rect on intersection within them at number that are inbounds.
    Point2D.Float origP1 = new Point2D.Float((float) Math.abs(rect.getX() - p1.x), (float) Math.abs(rect.getY() - p1.y));//rect for object one
    Point2D.Float origP2 = new Point2D.Float((float) Math.abs(rect.getX() - p2.x), (float) Math.abs(rect.getY() - p2.y));//rect for object two

    //to avoid casting with every iteration
    int start1y = (int) origP1.y;
    int start1x = (int) origP1.x;
    int start2y = (int) origP2.y;
    int start2x = (int) origP2.x;

    //we need to loop within the rect of intersection
    //goind bottom up and left to right
    for (int i = height - 1; i > 0; i--)
    {
        for (int j = 0; j < width; j++)
        {
            mask1 = bitmaskArr[index1].bitmask[start1y + i][start1x + j];
            mask2 = bitmaskArr[index2].bitmask[start2y + i][start2x + j];
            if ((mask1 & mask2) > 0)
            {
                return true;
            }
        }

    }
    //no collsion was found
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:09:59.417

问题可能出在这部分代码上：

```
if (((mask1) & (mask2)) != 0)//bitwise and, if both are nonzero there is a collsion
{
    return true;
} 
```

您似乎正在使用按位并检查两个值是否都非零 - 但这可能无法以这种方式工作。

例如以下表达式的值：

```
3 & 4 == 0 
```

是真的

这是因为当您执行按位运算时，您需要将数字视为它们的位表示并逐位执行操作。

所以：

```
 3 = 0000 0011
& 4 = 0000 0100
---------------
  0 = 0000 0000 
```

这是因为 1 位值如何相互对齐。对于位中的位并具有 1 的值 - 不同数字中同一位置的两个位需要为 1。

另一个例子是：

```
 3 = 0000 0011
& 2 = 0000 0010
---------------
  2 = 0000 0010 
```

因此，在您的情况下，更好的检查是：

```
if ( mask1>0 && mask2>0 )//logical and if both are nonzero there is a collsion
{
    return true;
} 
```

# .net - C++ CLI .net 表单 Ideling 事件

> ID：12253790
> 
> 赞同：1
> 
> 时间：2012-09-03T20:41:42.303
> 
> 标签：.net, forms, c++-cli, directx, python-idle

你好，来自被称为互联网的黑社会的亲爱的人们，

我正在为 Directx 11 创建一个编辑器，到目前为止运行良好，但只有一个小问题：

这就是我如何让我的表单调用渲染函数：

```
Application::Idle += gcnew EventHandler(&Ideling); 
```

现在这实际上有效，但是，只有当我将鼠标悬停在它上面时它才有效，如果我将鼠标仍然放在它上面（并且焦点在它上面），它不会做任何事情。所以只有当鼠标悬停在它上面时才会调用idling函数。我的问题是：我怎样才能避免这种情况？使其始终呈现。

现在这对我来说是一个巨大的痛苦。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:02:24.470

规则是在从消息队列中检索到最后一条消息后调用*一次。*因此，保持它继续运行需要不断生成消息，例如通过移动鼠标。或者通过让您的空闲事件生成一条消息。调用表单的 Invalidate() 方法。这会生成一个 Paint 事件。如果不需要做任何其他事情，则紧随其后的是 Idle 事件。

通过谷歌搜索“Winforms 游戏循环”找到更多方法。

# python - 带有 lxml treebuilder 的 html5lib 无法正确解析命名空间

> ID：12253791
> 
> 赞同：2
> 
> 时间：2012-09-03T20:41:43.427
> 
> 标签：python, lxml, html5lib

我正在尝试`html5lib`使用`lxml`treebuilder 解析一些 HTML 内容。注意：我正在使用`requests`库来获取内容，内容是 HTML5（尝试使用 XHTML - 结果相同）。

当我简单地输出 HTML 源代码时，它看起来还不错：

```
response = requests.get(url)
return response.text 
```

返回

```
<html xmlns:foo="http://www.example.com/ns/foo"> 
```

但是当我实际使用 html5lib 解析它时，会发生一些奇怪的事情：

```
tree = html5lib.parse(response.text, treebuilder = 'lxml', namespaceHTMLElements = True)
html = tree.getroot()
return lxml.etree.tostring(html, pretty_print = False) 
```

返回

```
<html:html xmlns:html="http://www.w3.org/1999/xhtml" xmlnsU0003Afoo="http://www.example.com/ns/foo"> 
```

注意这`xmlnsU0003Afoo`件事。

此外，`html.nsmap`dict 不包含`foo`命名空间，仅包含`html`.

有谁知道发生了什么以及我该如何解决这个问题？

**后期编辑：**

这似乎是预期的行为：

> 如果正在使用的 XML API 限制了元素和属性的本地名称中允许的字符，那么该工具可以将所有元素和属性的本地名称 [...] 映射到一组允许的名称，方法是替换任何不符合条件的字符。 '不支持大写字母 U 和字符的 Unicode 代码的六位数字 [...] -[将 HTML DOM 强制转换为信息集](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#coercing-an-html-dom-into-an-infoset)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:38:58.570

几点观察：

*   HTML5 似乎不支持 xmlns 属性。引用[最新 HTML5 规范的第 1.6 节](http://www.w3.org/TR/html5/introduction.html#html-vs-xhtml)：“......命名空间不能使用 HTML 语法表示，但它们在 DOM 和 XHTML 语法中受支持。” 我看到您也尝试过使用 XHTML，但您当前使用的是 HTML5，因此可能存在问题。`U+003A`是冒号的Unicode，所以不知何故`xmlns`被注意到但被弄乱了。

*   至少 PHP 版本的[自定义命名空间元素](http://code.google.com/p/html5lib/issues/detail?id=131&q=xmlns&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary%20Port)存在一个未解决的问题。

*   我不明白`html5lib`这里的作用。为什么不直接使用`lxml`：

```
from lxml import etree

tree = etree.fromstring(resp_text)
print etree.tostring(tree, pretty_print=True) 
```

这似乎做你想做的事，没有`html5lib`和没有愚蠢的`xmlnsU0003Afoo`错误。使用我使用的测试 HTML，我得到了正确的输出（如下），并`tree.nsmap`包含一个`'foo'`.

```
<html xmlns:foo="http://www.example.com/ns/foo">
    <head>
        <title>yo</title>
    </head>
    <body>
        <p>test</p>
    </body>
</html> 
```

或者，如果你想使用 pure `html5lib`，你可以使用包含的`simpletree`：

```
tree = html5lib.parse(resp_text, namespaceHTMLElements=True)
print tree.toxml() 
```

虽然这不会破坏`xmlns`属性，但`simpletree`不幸的是缺少更强大的`ElementTree`功能，例如`xpath()`.

# apache - 如何使用来自所有域和页面的 rewriterule 进行重定向？

> ID：12253793
> 
> 赞同：0
> 
> 时间：2012-09-03T20:41:47.717
> 
> 标签：apache, mod-rewrite, apache2

假设我有两个域：mydomain.com 和 my.domain

我想从 mydomain.com 上的所有页面（包括其任何子域）重定向到 my.domain 但保留 url，例如：

```
text.mydomain.com/goahead/ -> http://my.domain/goahead/ 
```

我尝试过这种方式，但它似乎根本不起作用：

```
RewriteEngine on
RewriteRule ^.*?mydomain\.com\/?(.*)$ "http\:\/\/my\.domain\/$1" [R=301,L] 
```

错误在哪里？这样做的更好做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:00:11.640

哦，现在我明白了：

```
RewriteCond %{HTTP_HOST} ^[A-Za-z0-9.]*mydomain\.com$
RewriteRule ^(.*)$ "http\:\/\/my\.domain\/$1" [R=301,L] 
```

# algorithm - Giraph、Graphchi 或 Pregel 中的广度优先实现

> ID：12253794
> 
> 赞同：2
> 
> 时间：2012-09-03T20:41:52.677
> 
> 标签：algorithm, graph, breadth-first-search, graphchi

有谁知道在任何一个图形处理系统——Giraph、Pregel 或 Graphchi 中是否存在广度优先（来自多个来源）实现。

或者请告诉任何一个系统上的一些更简单的实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-04T16:04:45.533

在 Giraph 用户邮件列表中，可以找到一些关于 BFS 实现的讨论——我猜也是一种实现。

我过去曾对 Giraph 进行过此类搜索，它们可在以下位置获得：

[https://github.com/MarcoLotz/GiraphBFSSO](https://github.com/MarcoLotz/GiraphBFSSO)

[https://github.com/MarcoLotz/GiraphBFSTO](https://github.com/MarcoLotz/GiraphBFSTO)

它们之间的区别在于，一种是面向目标的，另一种是面向结构的。

虽然它们不是从多个起始顶点开始，但可以轻松修改代码以支持它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-02T12:57:15.677

您正在寻找多种子广度优先搜索 (BFS) 算法。

对于 Giraph，这仍然是一个悬而未决的问题，可以在此 [功能请求](https://issues.apache.org/jira/browse/GIRAPH-1032)中阅读。

对于 Pregel，你不能指望找到任何开放的算法，因为 Pregel 是 Google 的一个闭源图系统。

我想最简单的方法是使用[Github](https://github.com/MarcoLotz/GiraphBFSTO)中的代码并分别为每个源执行它。优化算法运行时复杂度的一个想法是对第一个种子顶点执行 BFS，并将结果重用于后续顶点种子（第一个 BFS 生成生成树，可以轻松地将其转换为任何给定种子顶点的 BFS 顺序）。

尽管如此，KISS 建议对 k 个种子顶点简单地执行 k 次 BFS，直到遇到性能问题（由于 BFS 的线性运行时复杂性，这不太可能）。

# php - 从子类初始化父类变量

> ID：12253796
> 
> 赞同：2
> 
> 时间：2012-09-03T20:41:55.647
> 
> 标签：php

我有 2 个类：一个是包含一般数据库查询的 DBobject，另一个是每个子类都有特定的数据库查询。现在的问题是当我尝试初始化父类 table_name 变量时，它没有被初始化。我尝试了很多方法，但它显示执行查询时表为空。这是代码：

```
<?php
class DBobject {

 public static $table_name="";

 public static function find_all(){
  global $database;
  return self::find_by_sql("SELECT * FROM ".self::$table_name);
 }

 }
?>

<?php
class Catagory extends DBobject{
 public static $table_name ="catagory";
}
?>

?> 
```

主要应用：

```
<?php
$cata = Catagory::find_all();
     foreach($cata as $catag){
     echo "Catagory Name :" . $catag->name."<br/>";
} 

 ?> 
```

我希望能够初始化 DBobject 函数 find_all() 将处理的表的类型。请帮我解决一下这个。这是我得到的错误。请注意，查询不包含表的名称。

```
 Database query Failed You have an error in your SQL syntax; check the manual that corresponds to  your MySQL server version for the right syntax to use near '' at line 1

last SQL query: SELECT * FROM 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:48:37.410

如果您使用的是 php 5.3 或更高版本，则可以这样做，因为他们添加了“后期静态绑定”

[http://php.net/manual/en/language.oop5.late-static-bindings.php](http://php.net/manual/en/language.oop5.late-static-bindings.php)

您可以使用 get_call_class() 或 static:: (而不是 self::) 来引用被调用的类而不是代码所在的类

# gwt - 如何在多个 CellTables 中进行唯一选择

> ID：12253797
> 
> 赞同：1
> 
> 时间：2012-09-03T20:41:57.513
> 
> 标签：gwt, celltable, gwt-celltable

在同一页面中拥有多个 CellTable 的最简单方法是什么，以便在一个 CellTable 中选择一行会清除其他 CellTable 中的任何选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:41:57.513

没有什么比这更容易了。只需创建一个唯一的 SelectionModel，并使用该`setSelectionModel`函数将其分配给每个 CellTables。

尽管回想起来这似乎很明显，但我花了一段时间才想到它。

# jquery - js/css : 禁用滚动条但保持滚动位置

> ID：12253802
> 
> 赞同：21
> 
> 时间：2012-09-03T20:42:09.680
> 
> 标签：jquery, css

我正在使用 Jquery 对话框在页面顶部打开一个弹出框窗口。当我打开对话框时，我希望禁用常规页面滚动。为此，我正在做：

```
$('body').css({overflow:'hidden'}); 
```

当对话框打开时，并且：

```
$('body').css({overflow:'auto'}); 
```

当对话框关闭时。

这可行，但是当滚动条被移除时，后面的内容会向右移动，结果并不好。

我尝试了另一种方法，通过创建一个 css 类“noscroll”，如下所示：

```
body.noscroll
{
    position: fixed; 
    overflow-y: scroll;
    width: 100%;
} 
```

然后，而不是以前的 js 代码，我在对话框打开/关闭时将此类添加和删除到正文中。

现在这适用于滚动条，后面的内容不会向右移动，但是使用这种方法，后面的内容会回到顶部。

所以基本上method1使内容向右移动，method2使内容回到顶部。

有谁知道这个的解决方案？对话框打开时没有滚动后面的内容，并且没有移动禁用滚动...？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-26T14:08:30.807

我为我的解决方案做了一个非常简单的例子。

[http://jsfiddle.net/6eyJm/1/](http://jsfiddle.net/6eyJm/1/)

**你的弹出窗口应该在一个盒子里**

```
<div id="shadow">
<div id="popup">
    <a id='close' href="#">Close</a>
</div> 
```

**然后把那些CSS放在de root div上**

```
#shadow{
    display: none;
    position: fixed;
    top:0;
    bottom: 0;
    width: 100%;
    height:100%;
    background-color: rgba(0,0,0,0.6);
} 
```

固定位置非常重要，因为您不想看到白色边框，它将占用整个窗口宽度而不是正文。

**然后是 JS 小技巧**

```
$('#open').click(function(e){
    e.preventDefault()
    $('body').width($('body').width());
    $('body').css('overflow', 'hidden');
    $('#shadow').css('display', 'block');
})
$('#close').click(function(e){
    e.preventDefault()
    $('body, #shadow').removeAttr('style')
}) 
```

这里的目标是在移除滚动条之前获取主体宽度。您的内容不会移动。

希望对您有所帮助！

对不起我的英语，不是我的母语。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-21T18:53:49.783

记住偏移量应该可以避免弹出窗口；

[JSfiddle](http://jsfiddle.net/Allendar/TeQdb/)

**HTML**

```
<div id="popupholder">
    <button id="close">Close me</button>
</div>

asd <br />asd <br />asd <br />asd <br />asd <br />
<button class="open">Popup</button>
<br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd<br />
<button class="open">Popup</button>
<br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />
<button class="open">Popup</button>
<br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd<br />
<button class="open">Popup</button>
<br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br />asd <br /> 
```

**CSS**

```
html, body {
    margin: 0px;
}

#popupholder {
    width: 100%;
    height: 100%;
    position: absolute;
    display: box;
    display: -webkit-box;
    display: -moz-box;
    background-color: rgba(0,0,0,0.75);
    display: none;
}

#close {
    display: block;
    height: 20px;
    margin: 75px auto 0px auto;
} 
```

**JavaScript**

```
$(document).ready(function() {
    $('.open').click(function() {
        // Block scrolling
        $('body').css('overflow', 'hidden');

        // Show popup
        var offset = window.pageYOffset;
        //console.log(offset);
        $('#popupholder').css({
            'display': 'block',
            'top': offset + 'px'
        });
    });

    $('#close').click(function() {
        // Enable scrolling
        $('body').css('overflow', 'auto');

        // Hide popup
        $('#popupholder').css('display', 'none');
    });
}); 
```

出于安全原因，您可以在 中添加一个非常高`z-index`的值`#popupholder`，但这与问题并不真正相关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-17T16:53:36.910

我有同样的问题这个存储库帮助我[无滚动](https://github.com/davidtheclark/no-scroll)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-09-13T13:59:59.543

这是迄今为止我得到的最好的解决方案。相信我，我尝试了所有其他方法，这是我想出的最好和最简单的解决方案。它**在 Windows 设备上**运行良好，从右侧推动页面为系统滚动条和**IOS 设备**留出空间，而 IOS 设备在浏览器中不需要滚动条空间。**因此，通过使用它，您不需要在右侧添加填充，这样当您使用 css 隐藏 body 或 html 的溢出**时，页面不会闪烁。

如果您考虑一下，解决方案非常简单。这个想法是在打开弹出窗口的那一刻给**window.scrollTop()**相同的确切位置。当窗口调整大小时也更改该位置（因为一旦发生滚动位置就会更改）。

所以我们开始...

首先让我们创建一个变量，让您知道弹出窗口已打开并将其命名为**stopWindowScroll**。如果我们不这样做，那么您将在页面上收到未定义变量的错误并将其设置为 0 - 未激活。

```
$(document).ready(function(){
    stopWindowScroll = 0;
}); 
```

现在让打开的弹出函数可以是代码中的任何函数，它可以触发您作为插件或自定义使用的任何弹出窗口。在这种情况下，它将是一个简单的自定义弹出窗口，带有一个简单的单击功能文档。

```
$(document).on('click','.open-popup', function(){
    // Saving the scroll position once opening the popup.
    stopWindowScrollPosition = $(window).scrollTop();
    // Setting the stopWindowScroll to 1 to know the popup is open.
    stopWindowScroll = 1;
    // Displaying your popup.
    $('.your-popup').fadeIn(300);
}); 
```

所以接下来我们要做的是创建关闭弹出功能，我再重复一遍，它可以是您已经创建或正在插件中使用的任何功能。重要的是我们需要这 2 个函数将**stopWindowScroll**变量设置为 1 或 0 以了解它何时打开或关闭。

```
$(document).on('click','.open-popup', function(){
    // Setting the stopWindowScroll to 0 to know the popup is closed.
    stopWindowScroll = 0;
    // Hiding your popup
    $('.your-popup').fadeOut(300);
}); 
```

然后让我们创建 window.scroll 函数，这样我们就可以在上面提到的**stopWindowScroll**设置为 1 时阻止滚动 - 激活。

```
$(window).scroll(function(){
    if(stopWindowScroll == 1) {
         // Giving the window scrollTop() function the position on which
         // the popup was opened, this way it will stay in its place.
         $(window).scrollTop(stopWindowScrollPosition);
    }
}); 
```

就是这样。除了您自己的页面样式外，无需任何 CSS 即可工作。这对我来说就像一个魅力，我希望它可以帮助你和其他人。

这是一个关于 JSFiddle 的工作示例：

**[JS 小提琴示例](https://jsfiddle.net/BinaryForest/rhucyp50/)**

让我知道这是否有帮助。问候。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-30T13:31:11.540

您可以计算溢出隐藏之前和之后的正文宽度之间的差异，并将其作为 padding-right 应用于正文

```
var bodyStartW = $("body").width();
$("body").css("overflow-y" , "hidden");
var bodyEndW = $("body").width();
var bodyMarginL = bodyEndW - bodyStartW;
$("body").css("padding-right" , bodyMarginL); 
```

在 Safari 中，您对“html”标签有相同的技巧，并且使用 margin-right 而不是 padding-right

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-02T21:15:20.720

我出于相同的目的使用这两个函数：

```
function enableBodyScroll() {
  if (document.readyState === 'complete') {
    document.body.style.position = '';
    document.body.style.overflowY = '';

    if (document.body.style.marginTop) {
      const scrollTop = -parseInt(document.body.style.marginTop, 10);
      document.body.style.marginTop = '';
      window.scrollTo(window.pageXOffset, scrollTop);
    }
  } else {
    window.addEventListener('load', enableBodyScroll);
  }
}

function disableBodyScroll({ savePosition = false } = {}) {
  if (document.readyState === 'complete') {
    if (document.body.scrollHeight > window.innerHeight) {
      if (savePosition) document.body.style.marginTop = `-${window.pageYOffset}px`;
      document.body.style.position = 'fixed';
      document.body.style.overflowY = 'scroll';
    }
  } else {
    window.addEventListener('load', () => disableBodyScroll({ savePosition }));
  }
} 
```

这个怎么运作：

1.  当您想通过保存当前位置来禁用滚动时，请运行`disableBodyScroll({ savePosition: true })`.

2.  该函数检查页面是否加载（因为用户可能会在加载过程中触发对话框打开）。

3.  如果页面已加载，它会通过设置保存当前滚动位置`margin-top`on `body`，然后设置`position: fixed; overflow-y: scroll`它以删除滚动条。

4.  如果页面未加载，它会添加事件侦听器以在页面加载时运行 (3.)。

为了启用滚动，一切都是一样的，但功能是删除样式而不是设置它们。

代码来源：[https ://github.com/funbox/diamonds/blob/master/lib/body-scroll.ts](https://github.com/funbox/diamonds/blob/master/lib/body-scroll.ts)

# css - 流体宽度固定位置

> ID：12253803
> 
> 赞同：19
> 
> 时间：2012-09-03T20:42:10.657
> 
> 标签：css, css-position, fluid-layout

想象：

```
<div class="outer">
    <div class="inner">
    </div>
</div> 
```

在哪里：

*   `.outer`是列结构的一部分，它的宽度是百分位数，因此是流动的。
*   `.inner`表示`fixed`应该以 100% 宽度填充元素的位置`.outer`元素。然而，它的垂直位置保持不变，因此`fixed`。

我尝试使用以下 CSS 实现此布局：

```
.outer {
    position: relative;
    width: %;
}
.inner {
    position: fixed;
    width: 100%;
} 
```

但是，`.inner`不会将其宽度计算为`relative`其父级的百分比。相反，它填充了窗口/文档的整个宽度。尝试任何`left`或`right`属性都会导致相同的忽略父级的品质。

有没有办法解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-10-08T20:39:59.380

```
.outer {
    position: relative;
    width: %;
}
.inner {
    position: fixed;
    width: inherit;
} 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-20T08:53:20.140

`position: fixed`总是相对于窗口/浏览器，因此它不能用来解决你的问题。固定定位将元素从 DOM 的自然顺序中移除，因此不再保留在您的外部 div 中，因此它占用了浏览器的整个宽度而不是容器的整个宽度。您需要使用的是`position: absolute`相`.inner`对于`.outer`. 您将能够定位您的元素以及将其宽度包含在`.outer`div 中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-10T10:01:56.863

用这个 ：

.inner { 位置：固定；左：0；对：0；

}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-20T00:53:43.493

固定元素仅采用绝对值作为宽度。如果你的父容器是流体的（宽度是百分比），你需要动态设置固定元素的宽度。您需要获取包装容器的宽度并将其设置在粘性元素上。

CSS

```
.outer {width: 25%;}
.inner {position: fixed;} 
```

JS

```
var fixedWidth = $('.outer').css('width');
$('.inner').css('width', fixedWidth); 
```

此外，您可以在窗口调整大小时添加事件侦听器。

JS

```
window.addEventListener('resize', resize);
function resize() {
    var fixedWidth = $('.outer').css('width');
    $('.inner').css('width', fixedWidth);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-08T05:41:59.167

使用这样的[小提琴](http://jsfiddle.net/DVuTY/135/)怎么样？

```
.outer {
    width: 20%;
    height: 1200px;
    margin-left: 5%;
    float: left;
}
.inner {
    height: 200px;
    position: fixed;
    top: 0;
    background: orange;
    right: 75%;
    left: 5%;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T22:31:07.550

您可以查看我制作的这个[jsfiddle](http://jsfiddle.net/DVuTY/12/)，它说明了您的问题的解决方法，您可以完全按照您想要的方式使用此代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-28T06:34:04.400

`position:fixed`总是相对于视口/浏览器窗口，而不是祖先。

# java - 需要帮助实现两个 android 活动？

> ID：12253809
> 
> 赞同：-1
> 
> 时间：2012-09-03T20:42:46.920
> 
> 标签：java, android

我正在尝试两个使用两个按钮和点击监听器启动两个不同的活动我收到以下错误*此行的多个标记 - 语法错误，插入“}”以完成 ClassBody - 语法错误，插入“;” 完成 FieldDeclaration*

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.safaricom);

    Button button1 = (Button)findViewById(R.id.button1);
    Button button2 = (Button)findViewById(R.id.button2);

    button1.setOnClickListener(buttonClickListener);
    button2.setOnClickListener(buttonClickListener);
}

private OnClickListener buttonClickListener = new View.OnClickListener() {

     @Override
     public void onClick(View v) {

          switch(v.getId()){

          case R.id.button1: 
               Intent intent = new Intent(this, Second.class);
               this.startActivity(intent);
               break;

          case R.id.button2:
              Intent intent = new Intent(this, SignUp.class);
           this.startActivity(intent);
           break;

          }

     }     
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:47:08.927

`;`最后缺少A。

```
private OnClickListener buttonClickListener = new View.OnClickListener() {

    ...

}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T00:09:37.587

您可能应该更改 onClick 方法以避免**重复的局部变量**

```
private OnClickListener buttonClickListener = new View.OnClickListener() {
     @Override
     public void onClick(View v) {
          Intent intent = null;
          switch(v.getId()){
          case R.id.button1: 
               intent = new Intent(this, Second.class);
               break;
          case R.id.button2:
               intent = new Intent(this, SignUp.class);
               break;
          }
          if (intent != null)
              this.startActivity(intent);
     }     
}; 
```

如果您在 switch 内声明一个变量**，则无论在哪种****情况下**声明它都无关紧要，它始终在**switch**内。这就是为什么你必须使用**break；**当您不想执行其他代码行时。您是否在开关内。

# php - 从本地主机 php 错误的 AWS S3 批量上传

> ID：12253812
> 
> 赞同：3
> 
> 时间：2012-09-03T20:43:10.370
> 
> 标签：php, amazon-s3, curl-multi

我正在尝试从本地主机（xampp）**批量/批量**上传到我的`S3`存储桶。
它似乎适用于大约 6 个项目，然后我收到一条错误消息：

cURL 错误`Failed sending network data.`来自[http://curl.haxx.se/libcurl/c/libcurl-errors.html](http://curl.haxx.se/libcurl/c/libcurl-errors.html)

```
Fatal error: Uncaught exception 'cURL_Multi_Exception' with message 'cURL resource: Resource id #34; cURL error: SSL_write() returned SYSCALL, errno = 0 (cURL error code 55). See http://curl.haxx.se/libcurl/c/libcurl-errors.html for an explanation of error codes.' in D:\xampp\htdocs\path\to\my\files\sdk-1.5.14\lib\requestcore\requestcore.class.php on line 902 
```

和

```
cURL_Multi_Exception: cURL resource: Resource id #34; cURL error: SSL_write() returned SYSCALL, errno = 0 (cURL error code 55). See http://curl.haxx.se/libcurl/c/libcurl-errors.html for an explanation of error codes. in D:\xampp\htdocs\path\to\my\files\sdk-1.5.14\lib\requestcore\requestcore.class.php on line 902 
```

继承人我的PHP。它从目录中获取图像列表，并从该循环中获取我希望将这些项目批量上传到`S3`.

```
require_once('sdk-1.5.14/sdk.class.php');
$s3 = new AmazonS3();
//$s3->disable_ssl_verification(); //this didnt fix it

$folder = "./../"; 
$handle = opendir($folder); 

# Making an array of files in a directory to upload to S3
while ($file = readdir($handle)) 
{ 
        $files[] = $file; 
} 
closedir($handle);

foreach ($files as $file) { 
        $path_parts = pathinfo($file);
        if(isset($path_parts['extension']) && $path_parts['extension'] != '') {

                // local path
                $fileTempName = "D:/xampp/htdocs/path/to/my/files/";

                //batch
                $response = $s3->batch()->create_object('bucketname', "tempdirectory/" . $file, array(
                        'fileUpload' => fopen($fileTempName . $file, 'r'),
                        'acl' => AmazonS3::ACL_PUBLIC
                ));

        }

}
$s3->batch()->send(); 
```

**更新：**对我 进行更改后，`congig.inc.php`我现在收到错误消息：

`Fatal error: Uncaught exception 'cURL_Multi_Exception' with message 'cURL resource: Resource id #149; cURL error: Failed connect to mybucket.s3.amazonaws.com:443; No error (cURL error code 7). See http://curl.haxx.se/libcurl/c/libcurl-errors.html for an explanation of error codes.' in D:\xampp\htdocs\sdk-1.5.14\lib\requestcore\requestcore.class.php on line 902`

`cURL_Multi_Exception: cURL resource: Resource id #149; cURL error: Failed connect to prayerbucket.s3.amazonaws.com:443; No error (cURL error code 7). See http://curl.haxx.se/libcurl/c/libcurl-errors.html for an explanation of error codes. in D:\xampp\htdocs\sdk-1.5.14\lib\requestcore\requestcore.class.php on line 902`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T04:18:17.960

尝试在 config.inc.php 中将 'certificate_authority' 设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T04:33:59.193

尝试为批次设置限制：

```
$batch = new CFBatchRequest(2); // only two instance at once

foreach ($files as $file) { 
        $path_parts = pathinfo($file);
        if(isset($path_parts['extension']) && $path_parts['extension'] != '') {

                // local path
                $fileTempName = "D:/xampp/htdocs/path/to/my/files/";

                // if batch, it have to return curl's resource
                $curl_handler = $s3->batch($batch)->create_object('bucketname', "tempdirectory/" . $file, array(
                        'fileUpload' => fopen($fileTempName . $file, 'r'),
                        'acl' => AmazonS3::ACL_PUBLIC
                ));

        }

}
// batch object send queue
$batch->send(); 
```

# google-app-engine - 我如何找到将 Scribe 与 GWT/GAE 一起使用的示例

> ID：12253813
> 
> 赞同：0
> 
> 时间：2012-09-03T20:43:30.810
> 
> 标签：google-app-engine, gwt, scribe

我正在寻找如何将 Scribe 与 GWT/GAE 一起使用的分步教程。有什么有用的手册吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:12:59.747

首先，您需要了解[OAuth 服务器和客户端流程](http://community.constantcontact.com/t5/Documentation/Authentication-using-OAuth-2-0-Server-and-Client-Flows/ba-p/38313)之间的区别。在服务器流程中，您的服务器将直接获得 OAuth 资源的授权，而在客户端流程中，只有客户端（浏览器）将获得授权。基本区别在于谁可以收到令牌。

对于 GWT 中的客户端流程，请参阅[`gwt-oauth2`](http://code.google.com/p/gwt-oauth2/)

对于服务器流程，您似乎需要自己动手。基本上你需要实现一个回调处理程序。注意：服务器流程是通过浏览器重定向完成的，因此在不喜欢页面重新加载的 GWT 中使用它有点麻烦。

# javascript - 错误：域包含无效字符

> ID：12253821
> 
> 赞同：1
> 
> 时间：2012-09-03T20:44:45.310
> 
> 标签：javascript, facebook, api, dns, facebook-javascript-sdk

我正在使用 Facebook Javascript SDK 开发智能电视应用程序。

我想实现在我的提要上上传消息的功能，所以我像这样使用 FB.api：

```
function FacebookUpload(msg){
var path = '/me/feed'; 
FB.api(path, 'Post', { message: msg, access_token: token}, function(response) {
    if (!response || response.error) {
        alert("error");
     } else {
        alert("successful with id [" + response.id + "]");
     }
});
} 
```

它在 PC 上运行良好，但在智能电视中不起作用。错误信息是这样的。

文件： [http](http://connect.facebook.net/en_US/all.js)
://connect.facebook.net/en_US/all.js 行号：62
错误详细信息：错误：域包含无效字符。

为什么会出现此消息以及如何解决此错误？

# mongodb - 如何指定要在 MongoDB 副本集中复制的数据库？

> ID：12253823
> 
> 赞同：0
> 
> 时间：2012-09-03T20:45:03.490
> 
> 标签：mongodb

我对 MongoDB 很陌生。

我知道 MongoDB 可以复制节点。

有没有办法选择要复制的特定数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:53:59.190

不，在副本集中，每个节点都包含与其他节点完全相同的数据，因此在任何时候辅助节点都可以升级并无缝地成为主节点。没有办法挑选和选择包含哪些数据库，也没有任何方法可以使它们工作以实现冗余。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T20:53:51.873

在 MongoDB 副本集中，整个节点在副本集的所有成员之间复制。通过这种方式，您无需选择要复制的特定数据库，而是将主节点上的所有数据库复制到所有辅助节点。

# .net - 在控制台应用程序中使用 ClaimsAuthenticationManager

> ID：12253828
> 
> 赞同：10
> 
> 时间：2012-09-03T20:45:38.057
> 
> 标签：.net, authentication, claims-based-identity, claims

我正在玩 4.5 中的新东西，并编写了一个简单的控制台应用程序，它应该检查新的基于声明的安全模型中的一些东西。我已经创建了 ClaimsAuthorizationManager 和 ClaimsAuthenticationManager 的自定义实现，将它们添加到应用程序配置文件中，将 AppDomain 主体策略设置为 Windows 主体，除了调用 AuthenticationManager.Authenticate 方法之外，几乎所有东西都运行良好。

AuthorizationManager.CheckAccess 正在按预期调用。

我想这是正确的行为，因为在运行控制台应用程序时，用户已经过身份验证，无需在应用程序启动时执行此操作。但是，我想根据 - 让我们说存储在数据库中的配置文件来转换一些声明。当然，我可以手动完成并自己处理 CurrentPrinciapal 对象。但是我想知道是否有办法强制应用程序使用 AuthManager 为我做这件事。

只是好奇:)

所以，这里有两个经理。他们基本上什么都不做，只是为了设置断点而存在:)

```
 public class AuthorizationManager : ClaimsAuthorizationManager  
{
    public override bool CheckAccess(AuthorizationContext context)
    {
        return base.CheckAccess(context);
    }
}

 public class Authenticationmanager : ClaimsAuthenticationManager 
{
    public override ClaimsPrincipal Authenticate(string resourceName, ClaimsPrincipal incomingPrincipal)
    {            
        return base.Authenticate(resourceName, incomingPrincipal);
    }
} 
```

App.config 看起来像这样：

```
 <configuration>
  <configSections>
    <section name="system.identityModel" type="System.IdentityModel.Configuration.SystemIdentityModelSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
    <section name="system.identityModel.services" type="System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
  </configSections>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
    </startup>
  <system.identityModel>
    <identityConfiguration>
      <claimsAuthenticationManager type="ClaimsSandbox.Authenticationmanager, ClaimsSandbox"/>
      <claimsAuthorizationManager type="ClaimsSandbox.AuthorizationManager, ClaimsSandbox"/>
    </identityConfiguration>    
  </system.identityModel>  
</configuration> 
```

没有什么特别的代码：

```
 class Program
{
    static void Main(string[] args)
    {            
        AppDomain.CurrentDomain.SetPrincipalPolicy(PrincipalPolicy.WindowsPrincipal);

        var principal = Thread.CurrentPrincipal;
        DescribeMe(principal);
        ClaimsPrincipalPermission.CheckAccess("foo ", "bar");
        Console.ReadLine();
    }

    private static void DescribeMe(System.Security.Principal.IPrincipal principal)
    {
        Console.WriteLine(principal);
        var claimsPrincipal = principal as ClaimsPrincipal;
        claimsPrincipal.IsInRole("Foo");
        Console.WriteLine(claimsPrincipal.Identity.IsAuthenticated);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T14:03:41.497

在控制台应用程序中，您必须像这样显式调用 Authenticate()。在 .NET 4.5 中，您使用 IdentityConfiguration。在 .NET 4.0 中，它应该是 FederatedAuthentication.ServiceConfiguration.ClaimsAuthenticationManager。

```
var cam = IdentityConfiguration.ClaimsAuthenticationManager;
Thread.CurrentPrincipal = cam.Authenticate
                                 ("http://badri/MyResource",
                                         incomingPrincipal); 
```

煞费苦心地提供自己的 CAM 实现背后的想法是，您需要在 STS 的令牌上添加、修改删除声明。您可以拥有自己的逻辑来根据您的数据库以及此处的所有内容添加内容，并丰富根据 STS (incomingPrincipal) 的声明创建的主体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T18:46:09.163

`ClaimsAuthenticationManager`是 WIF 处理管道的一部分。您可以从此类派生以在此管道内提供声明转换。不需要显式调用`Authenticate`方法，因为它在它的基本实现中什么都不做。

要调用此方法，您必须将 WIF 与 WCF 或 ASP.NET 应用程序（可以是 MVC）集成。

引用msdn：

> WIF 还为开发人员提供一致的编程体验，无论他们选择在 ASP.NET 还是在 WCF 环境中构建应用程序。

[你可以在这里](http://msdn.microsoft.com/en-us/library/hh291066)阅读更多。

# c - 使用 OpenGL 绘制费马螺旋

> ID：12253832
> 
> 赞同：2
> 
> 时间：2012-09-03T20:45:48.477
> 
> 标签：c, opengl, spiral

我正在做一个使用 OpenGL 绘制它的方法，绘图是 2D 的。

我知道这个理论，你可以在维基百科中找到定义，但我不知道我做错了什么。问题是当我使用平方根的负解来绘制点时。

```
//-----------------------------------------
//           ESPIRAL DE FERMAT
//-----------------------------------------
// float a --> x-inicio
// float b --> y-inicio
// float thetaStart --> angulo de comienzo
// float thetaEnd --> angulo de fin.
// unsigned int samples --> número de muestras, por defecto 200.
//------------------------------------------------------------------
void glFermatSpiral(float a, float b, float thetaStart, float thetaEnd, unsigned int samples = 200 )
{
    glBegin( GL_LINE_STRIP );

    float dt = (thetaEnd - thetaStart) / (float)samples;

    for( unsigned int i = 0; i <= samples; ++i )
    {
        // archimedean spiral
        float theta = thetaStart + (i * dt);
        // Specific to made a Fermat Spiral.
        float r = sqrt( theta );

        // polar to cartesian
        float x = r * cos( theta );
        float y = r * sin( theta );

        // Square root means two solutions, one positive and other negative. 2 points to be drawn.
        glVertex2f( x, y );

        x = -r * cos( theta );
        y = -r * sin( theta );

        glVertex2f( x, y );
    }

    glEnd();
} 
```

这就是我调用此方法的方式，并且定义了我的绘图空间。

```
glFermatSpiral(0.05, 0.2, 1.0, 25.0);

gluOrtho2D(-4, 4, -4, 4);   //  left, right, bottom, top 
```

就像解决方案一样。 ![在此处输入图像描述](../Images/5a80c5a5eada53dd6093df0712953e57.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:53:46.547

您正在使用线带来绘制点，但您一直在螺旋的正面和负面之间来回弹跳。

除非您想在这些点之间画一条线，否则不应将它们按顺序排列成一条带状。

我建议绘制所有正解的一条线，然后用所有负解开始一条新的线。您需要单独绘制线条。

# java - 在 MySQL 表中存储毫秒（使用 Java 存储/检索）

> ID：12253835
> 
> 赞同：0
> 
> 时间：2012-09-03T20:45:56.047
> 
> 标签：java, mysql, time

我正在使用这个 Java 代码：

```
Calendar lCDateTime = Calendar.getInstance();
    date = lCDateTime.getTimeInMillis(); 
```

它给了我毫秒。我需要把它放在 MySQL 表中，然后检索相同的信息；这可能吗？或者由于 MySQL 的限制，我应该使用不同的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:53:40.737

我会使用 BigInteger unsigned 来获得最大精度，尽管 BigInteger 签名可能就足够了。

BigInteger unsigned 的最大值为 18446744073709551615，这在未来还有很长的路要走！（超过 31000 AD！）这对你来说应该足够大了......;）

目前截至今天，自 1970 年以来的 ms 约为 134670551800，因此您有足够的空间来玩。

[这](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html#integer-types)是MySql的整数值的链接

我认为最好将其映射到 Java 中的 long 进行存储。Long 的最大值为 9223372036854775807，这对于未来还有很长的路要走

# java - 控制器的方法应该采用哪些参数，即从数据库中删除记录？

> ID：12253836
> 
> 赞同：0
> 
> 时间：2012-09-03T20:46:08.110
> 
> 标签：java, spring, jsp, spring-mvc

我正在创建一个简单的培训项目。我已经实现了一个控制器方法，它从列表中删除一个项目。该方法如下所示：

```
@Controller
@RequestMapping(value = "/topic")
public class TopicController {

    @Autowired
    private TopicService service;

    ...

    @RequestMapping(value = "/deleteComment/{commentId}", method = RequestMethod.POST)
    public String deleteComment(@PathVariable int commentId, BindingResult result, Model model){

        Comment deletedComment = commentService.findCommentByID(commentId);
        if (deletedComment != null) {
            commentService.deleteComment(deletedComment);
        }

        return "refresh:";
   }

} 
```

这个方法是从按钮标签中调用的，它的外观如下：

```
<form><button formaction = "../deleteComment/1" formmethod = "post">delete</button></form> 
```

在我的项目中，表单标签看起来像一个可点击的按钮。但是有一个严重的问题：控制器的方法永远不会被触发。如何使用按钮标签触发它？

PS 调用是从带有 URI **http://localhost:8080/simpleblog/topic/details/2**的页面执行的，控制器的 URI 是**http://localhost:8080/simpleblog/topic/deleteComment/2**

**更新：**

我创建了超链接“删除”，点击应该删除评论，我收到了一个异常

```
java.lang.IllegalStateException: Errors/BindingResult argument declared without preceding model attribute. Check your handler method signature! 
```

这是真的：我的控制器方法中确实没有**@ModelAttribute ，在****BindingResult**参数之前。但我不知道，应该是哪种类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:36:41.490

`<form>`的`method`属性是`GET`默认的。我不知道你想做什么`formmethod`和`formaction`属性，但在默认的[HTML](http://www.w3schools.com/tags/tag_button.asp)中它们没有任何意义。

您必须尝试以下方法：

```
<form action="../deleteComment/1" method="post">
    <button>delete</button>
</form> 
```

**编辑：**

您在方法中声明了一些未使用的参数。BindingResult 必须与带`@Valid`注释的属性一起使用（`@Valid` [在此处](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html)搜索以查看一些示例），但这不是您的情况。所以，请尝试：

```
@RequestMapping(value = "/deleteComment/{commentId}", method = RequestMethod.POST)
public String deleteComment(@PathVariable int commentId){
    ...
} 
```

# php - 使用 pdo 获取 mysql 用户定义的变量

> ID：12253837
> 
> 赞同：4
> 
> 时间：2012-09-03T20:46:09.277
> 
> 标签：php, mysql, pdo

我正在使用 pdo，我有这样的查询

```
$stmt=$db->query("SET @update_id := 0;  
                    UPDATE table SET column = something, id = (SELECT @update_id := id)  
                    WHERE condition  
                    LIMIT 1;   
                    SELECT @update_id;"); 
```

它应该更新一行并返回 id。
我确定查询本身正在工作，因为我在 phpmyadmin 中运行它并返回一个名为 @updated_id 的列，其中包含更新行的值，如下所示：

```
|   @updated_id    |  
|------------------|   
|  *correct id*    | 
```

我想获取 @updated_id 的值并将其存储在 php 变量中。
我试过了`$stmt->fetchColumn();`，`$stmt->fetchColumn();`但我得到了`SQLSTATE[HY000]: General error`。
我一直在寻找可以工作的东西，但找不到任何东西。
所以有人知道如何将@updated_id 的值存储在 php 变量中吗？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-09T06:17:28.343

正如 Petah 在评论中建议的那样，您需要遍历每个行集，直到您到达要获取的 SELECT 语句。

给你上面的例子，这应该工作：

```
$stmt=$db->query("SET @update_id := 0;  
                UPDATE table SET column = something, id = (SELECT @update_id := id)  
                WHERE condition  
                LIMIT 1;   
                SELECT @update_id;"); 
$stmt->nextRowset();
$stmt->nextRowset();
$update_id =  $stmt->fetchColumn(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:08:52.070

```
<?php
$id = 123;
$query = "UPDATE table SET column = something, id = ? WHERE condition LIMIT 1;"
$st = $db->prepare($query);
$st->execute(array(
 $id
));

$result = $st->fetch(PDO::FETCH_ASSOC);

var_dump($result); 
```

你尝试过这样的事情吗？，获取修改后的语句

# debugging - komodo edit 7.1 在 php 模式下无法识别 html5 标签

> ID：12253843
> 
> 赞同：3
> 
> 时间：2012-09-03T20:47:08.777
> 
> 标签：debugging, komodoedit, code-editor

标题很明确！在 php 模式下，komodo 编辑假定 html4 并在使用 html5 标签（如文章、时间、部分）时引发错误。

这可能会很麻烦，因为它可能会覆盖 php 错误。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T23:19:11.673

也许找到了解决方案：

首选项 -> 语言 -> HTML -> 默认 HTML 文档类型 -> HTML5

# objective-c - 尽管有数据，但无法从 NSMutableDictionary 检索键的值

> ID：12253844
> 
> 赞同：0
> 
> 时间：2012-09-03T20:47:08.547
> 
> 标签：objective-c, nsmutabledictionary

我有如下代码：

1.我有以下方法作为一个按钮的操作。

```
(IBAction)enableDisableFB:(id)sender {//have below local variable
NSMutableDictionary *fbLocationLatitude = [[NSMutableDictionary alloc] init]; 
```

2.有一个循环，我在这个字典中设置对象，比如

```
[fbLocationLatitude setObject:latitude forKey:locID]; //here latitude and locID both are NSString 
```

3.在同一方法的另一个循环中，我试图检索值，但它在 NSLog 中给出（null）

```
NSLog(@"latitude for key %@ = %@",locID, [fbLocationLatitude objectForKey:locID]);
//above statement gives me output -> latitude for key 114943251851302 = (null) 
```

但是在循环之后我打印完整的字典使用

```
NSLog(@"location dictionary = %@",fbLocationLatitude);
//which gives me below output. Sample given

location dictionary = {
    114943251851302 = "40.4414";
    109782595706984 = "38.9966";
    108867759137051 = "22.47";
    110148382341970 = "25.7877";
    107611279261754 = "43.1655";
    111803735513513 = "27.1828";
    109155699106505 = "18.3167";
    103734539665100 = "19.09"; 
```

这具有我正在搜索的键的值，但同样我无法使用 objectForKey。请帮我解决这个问题。

```
for (NSUInteger i =0; i< [fbLocationID count];i++)
{
    // NSLog(@"person creation");
    NSString *locID = [NSString stringWithString:[fbLocationID objectAtIndex:i]];
    NSLog(@"latitude for key %@ = %@",locID, [fbLocationLatitude objectForKey:locID]);                             
}
NSLog(@"location dictionary = %@",fbLocationLatitude); 
```

代码就是这样。我还尝试使用以下代码打印键类

```
for (id ik in [fbLocationLatitude allKeys])
{
const char* classname=class_getName([ik class]);
NSLog(@"class of key %s",classname);
} 
```

我得到的答案是：键类 NSDecimalNumber 虽然将 locID 类型转换为 NSDecimalNumber，但我没有得到键的确切值，而只有 null。请帮助解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T06:33:53.883

键是 NSDecimalNumber，但您从 NSString 开始，因此您可以像这样提取数据：

```
NSDecimalNumber locIDnumber = [NSDecimalNumber decimalNumberWithString: locID];
id latitude = [fbLocationLatitude objectForKey:locIDnumber];
NSLog(@"latitude for key %@ = %@", locID, latitude); 
```

您说您尝试了强制转换，但这不会执行从一种对象类型到另一种对象类型的任何转换；你需要一个方法`decimalNumberWithString:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T04:33:06.530

像这样检查：

```
if([[fbLocationLatitude objectForKey:locID] isKindofClass:[NSNumber class]])
{
   NSNumber *num = fbLocationLatitude objectForKey:locID];
}
else if([[fbLocationLatitude objectForKey:locID] isKindofClass:[NSString class]])
{
   NSString *strnum = fbLocationLatitude objectForKey:locID];
} 
```

# facebook - 从 express.js 重定向到外部 URL 不起作用

> ID：12253848
> 
> 赞同：0
> 
> 时间：2012-09-03T20:47:35.023
> 
> 标签：facebook, redirect, express

我正在努力使 Facebook“在画布页面中进行身份验证”正常工作， [如 PHP 此处所述](https://developers.facebook.com/docs/authentication/canvas/)。我终于得到了 base64_decode 的东西，但我在将用户重定向到第 2a 节中描述的 URL 时确实失败了。我尝试了 response.redirect(url) 以及 response.setHeader('Location', url) 和我在 SO 上找到的其他选项，但这些都不起作用：/

如果我直接通过浏览器访问 URL，一切似乎都按预期工作。如果我重定向到同一域上的 URL，它也可以。也许我错过了一些基本的东西？是否可以重定向到外部域？完成这项工作的正确方法是什么？

先感谢您！

更新：我刚刚发现重定向到[http://heise.de](http://heise.de)或[http://orf.at](http://orf.at)等页面有效，但不适用于[http://www.google.com](http://www.google.com)或[http://www.facebook.com](http://www.facebook.com) . 我不知道这里发生了什么：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T08:36:50.303

> 我刚刚发现重定向到类似`http://heise.de`or的页面`http://orf.at`有效，但不适用于`http://www.google.com`or `http://www.facebook.com`。我不知道这里发生了什么：/

后者发送一个`X-Frame-Options`HTTP 响应头，它告诉客户端页面是否要显示在 (i) 帧中。

Google 发送 value `SAMEORIGIN`，这意味着只允许来自域 google.com 的页面在 (i) 框架中显示来自 google.com 的其他页面，而 Facebook 发送`DENY`，这意味着该页面永远不允许在任何类型的框架中显示，无论在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T08:12:13.320

由于我无法解决问题，因此我想与您分享我使用的解决方法。问题似乎是，Facebook 将页面包含在 iframe 中，因此只允许使用 window.top.location 进行重定向，这显然不能从服务器端完成。我现在使用了一种解决方法并渲染了一个除了 window.top.location = url 什么都不做的翡翠视图。不是很漂亮，但它有效。为什么有些页面有效而其他页面无效，这对我来说仍然是一个问题。

# javascript - jquery validate 插件的提交处理程序在 ie 中不起作用（包括 ie9）

> ID：12253851
> 
> 赞同：0
> 
> 时间：2012-09-03T20:47:58.193
> 
> 标签：javascript, jquery, internet-explorer, jquery-validate

我有一个简单的注册表单，其中使用了 jquery validate 插件。我进行了所有验证，它们在所有 Internet Explorer 中都能正常工作，问题是验证后，该功能在 submitHandler 中不起作用，并且表单被发送到默认操作。

提交处理函数在 Firefox、chrome、safari、opera 中工作在 Internet Explorer 中最少。

这是我尝试的示例代码：

```
$("#Myform").validate({
    rules:{
       name:{ required: true },
       email:{ required: true },
       phone:{ required: true, email: true }
    },
    submitHandler: function(form){
       alert("Form sent");
    }
}); 
```

有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-04T16:12:12.903

你试过这个吗？

```
submitHanlder: function(form) {
    form.submit();
} 
```

# c#-4.0 - c#各种按钮调用同一个函数

> ID：12253853
> 
> 赞同：0
> 
> 时间：2012-09-03T20:48:11.060
> 
> 标签：c#-4.0

我创建了一个程序来通过 UltraVNC 更轻松地管理一些计算机，因为它们并不多（<25），每台 PC 都有自己的按钮，并且根据切换工具条，我可以查看或管理该计算机等。

我已经有一个运行良好的版本，但我想添加一些功能来完善我的旧代码。我目前用来代表计算机的所有 15 个按钮都调用相同的功能。我想知道有没有更好的方法来做到这一点：

```
private void PC1_Click(object sender, EventArgs e)
{
    Viewer("01", activeButton);
}

private void PC2_Click(object sender, EventArgs e)
{
    Viewer("02", activeButton);
}
private void PC3_Click(object sender, EventArgs e)
{
    Viewer("03", activeButton);
}

private void PC4_Click(object sender, EventArgs e)
{
    Viewer("04", activeButton);
}

private void PC5_Click(object sender, EventArgs e)
{
    Viewer("05", activeButton);
} 
```

我一直在寻找一段时间，但找不到任何东西。我只是想不出我需要什么。按钮已经创建，但我找不到添加此函数调用的方法，我似乎只找到如何在启动时创建按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:39:20.353

您可以简单地订阅与每个点击处理程序相同的方法。

例如，在设计器中，您可以转到按钮的属性，选择事件选项卡，单击单击按钮下拉菜单并选择现有方法（例如 PC1_Click 用于 PC2 按钮）。您不必创建新的处理程序（例如双击按钮）。

# javascript - SVG Path.getPointAtLength 返回错误值

> ID：12253855
> 
> 赞同：5
> 
> 时间：2012-09-03T20:48:12.393
> 
> 标签：javascript, svg

我正在编写一个应用程序，它使用 SVG 来显示信息并使用 a`<path>`在椭圆上安排动态数量的位置。然而，左下角的点超出了它们应该在的位置。所以我写了一个快速脚本来检查点的位置并做了这个（通过 Chrome JS 控制台插入：

```
a = document.getElementById("svg-table-underlay");
len = a.getTotalLength();
for (i = 0; i < len - 1; i++) {
    line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttributeNS(null, "x1", a.getPointAtLength(i).x);
    line.setAttributeNS(null, "y1", a.getPointAtLength(i).y);
    line.setAttributeNS(null, "x2", a.getPointAtLength(i + 1).x);
    line.setAttributeNS(null, "y2", a.getPointAtLength(i + 1).y);
    line.setAttributeNS(null, "style", "stroke:#ff0000; stroke-width:3;");
    document.getElementById("svg-dragto").appendChild(line);
} 
```

带有椭圆的路径表示为

```
<path d="M 212,250 A 300,140 0 1 0 212,249 Z" id="svg-table-underlay" fill="url(#wood)" /> 
```

我发现了我的问题：左下角的点被奇怪地计算，导致 getPointAtLength() 函数返回不正确的点。然而，椭圆本身是正确绘制的。这可能是什么原因，有什么办法可以解决吗？（我使用的是 Chrome 21，这只适用于 WebKit 浏览器）

![路径追踪奇数](../Images/26dea9c91a9507a6d78aca18fd43ba99.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:04:38.647

您可以用两条弧线绘制椭圆...

```
<path d="M 20, 200
        a 300,140 0 1,0 600,0
        a 300,140 0 1,0 -600,0
        z " id="svg-table-underlay" fill="#000" /> 
```

其中 300 是`rx`, 140 是`ry`, 600 是`rx * 2`

[http://jsfiddle.net/z6tTY/](http://jsfiddle.net/z6tTY/)

# python - EnumChildWindows 在 pywin32 中不起作用

> ID：12253858
> 
> 赞同：5
> 
> 时间：2012-09-03T20:48:41.780
> 
> 标签：python, winapi, pywin32

我想获取特定 IE 实例的子级以查看是否有任何弹出窗口。

我制作了一个弹出窗口的 .html 页面。弹出窗口的标题是“来自网页的消息”，与此版本的 IE 一样。

我可以从子窗口获取父级：

```
>>> child_handle = 15208472
>>> win32gui.GetWindowText(child_handle)
'Message from webpage'
>>> win32gui.GetParent(child_handle)
33230502
>>> parent_handle = 33230502
>>> win32gui.GetWindowText(parent_handle)
'pop-up example - Windows Internet Explorer' 
```

但是，似乎我无法从父窗口获取子窗口：

```
>>> def all_ok(hwnd, param): return True
>>> win32.EnumChildWindows(parent_handle, all_ok, None)
>>> 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T20:48:41.780

确实为每个孩子调用了处理程序：

```
>>> def all_ok(hwnd, param):
...     print hwnd
...     return True
...

>>> win32gui.EnumChildWindows(parent_handle, all_ok, None)
17630538
12911940
8260536
4131432
14356400
11471888
9048526
18942076
8523526
#etc... 
```

只是它`EnumChildWindows`本身不返回任何东西。如果您想将所有子窗口句柄放在一个列表中，请在处理程序中执行此操作：

```
>>> parent_handle = 33230502
>>> child_handles = []
>>> def all_ok(hwnd, param):
...     child_handles.append(hwnd)
...
>>> win32gui.EnumChildWindows(parent_handle, all_ok, None)
>>> child_handles
[17630538, 12911940, 8260536, 4131432, 14356400, 11471888, 9048526, 18942076, 8523526, 6951400, 5968556, 19203900, 4459544, 15208240, 9700614, 5769012, 11277176, 7409598, 10225510, 8392342, 19270296, 32377256, 7276984, 20449052, 8262502, 11734380, 14749460, 5310608, 3935978, 125374254, 8457268, 2621704, 24840652, 5706936, 35261636, 10357170, 5641372, 8260848, 6559366]
>>> 
```

# jquery - JQueryMobile 选择文本未正确显示

> ID：12253862
> 
> 赞同：0
> 
> 时间：2012-09-03T20:48:47.457
> 
> 标签：jquery, ajax, html, jquery-mobile

我有一个通过 Ajax 加载的选择，然后渲染到 JQueryMobile，一切看起来都正确，但有时当我们滚动时选择的文本会消失和返回！（有点疯狂）价值仍然被选中

可能是什么原因？

正确的组合框在这里 [http://s18.postimage.org/oeg0rd0a1/correct_combo.png](http://s18.postimage.org/oeg0rd0a1/correct_combo.png)

上下滚动后，这是正确的（文本未显示，但值仍被选中！！！） [http://s9.postimage.org/pnhwrkue7/incorrect_combo.png](http://s9.postimage.org/pnhwrkue7/incorrect_combo.png)

真的很奇怪！！

# oauth - 我应该在哪里安装 elgg 社交登录插件？

> ID：12253863
> 
> 赞同：1
> 
> 时间：2012-09-03T20:48:49.530
> 
> 标签：oauth, facebook-social-plugins, elgg

我想知道我需要在哪里安装 elgg 社交登录插件。我已经下载了最新的1.8版本的插件，解压到和elgg index.php同级。我如何使用这个插件？也就是说，安装步骤是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T23:19:56.567

所有 Elgg 插件都在 /mod 目录中。将其放在那里后，您需要转到管理页面的插件区域，然后启用该插件。

# javascript - 如何在网页中放置 Google 图表？

> ID：12253866
> 
> 赞同：10
> 
> 时间：2012-09-03T20:49:10.643
> 
> 标签：javascript, html, google-visualization

我正在使用谷歌图表。定位让我望而却步。我没有在文档中找到该部分。我只想在 div 中创建一个谷歌图表，左上角位于 div 的 (x, y) 中。帮助控制尺寸的额外积分。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

如果我使用像萤火虫这样的工具在“运行时”中查看 html，我会看到：

```
rect x="161" y="96" width="579" height="309" 
```

但我没有选择任何这些值。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-04T00:17:17.243

例如，要将图表定位在 DIV 内的 (0,0) 处，请添加到图表选项：

```
var options = {
          ...,
          chartArea:{left:0,top:0,width:"50%",height:"50%"}
} 
```

并根据需要调整宽度和高度；完整的选项在[这里](https://google-developers.appspot.com/chart/interactive/docs/gallery/columnchart#Configuration_Options)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T22:47:47.313

好的，您需要添加一些额外的 HTML：

```
<body>
    <div style="position:relative;width:100%">
        <div id="chart_div" style="position:absolute;right:0px;top:0px;width: 400px; height: 300px;"></div>
    </div>
</body> 
```

图表的高度可以通过div的宽度和高度来控制。可以通过改变、右、上、左/下等来控制放置。

您可能想要浮动 chart_div，或使用任何其他定位方法。

根据您的要求，这可能就足够了：如果没有，请告诉我。

# php - 下拉菜单中的 PHP 变量

> ID：12253868
> 
> 赞同：1
> 
> 时间：2012-09-03T20:49:16.617
> 
> 标签：php, mysql, variables, dropdownbox

您好，我现在在页面上运行一个查询。

最终，我需要通过下拉菜单选择国家代码（变量），以便查询使用选定的国家代码（变量）运行。

即使我转到另一个页面，我也希望国家代码保持选中状态，以便查询自动使用预选变量运行。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:29:49.907

您的表格应类似于以下内容：

```
<form name="country_list" method="POST" action="http://examplewebsite.com/script.php" target="_blank">
        Country:     <select name="Country" tabindex="1">
                     <optgroup label="Continent">
                        <option value="Country 1">Country 1</option>
                        <option value="Country 2">Country 2</option>
                        <option value="Country 3">Country 3</option>
                     </optgroup>
                </select>
        <input type="submit" value="Filter" />
    </form> 
```

要输入所选国家/地区，您需要使用 $_POST[]

```
<?php
$selected = $_POST['Country'];
?> 
```

一个冗长但相当简单的方法来确保所选国家仍然被选中，每个选项如下：

```
<option value="Country 1" <? if($selected == 'Country 1'){ echo 'selected="selected"';} ?> >Country 1</option>
<option value="Country 2" <? if($selected == 'Country 2'){ echo 'selected="selected"'; ?> }>Country 2</option> 
```

我意识到对于个别国家，这可能需要很长时间，但它应该可以工作 - 您的问题是需要在列表中每个选项的开始标记中使用“selected="selected"' 表达式。

这仅在您从脚本中重新加载页面时才有效 - 例如，如果您正在检查整个表单并希望保留提交的结果。如果您要转移到一个完全不同的页面，那么 cookie 将是存储数据的一种方式，但是存在安全问题和法律问题，尤其是在欧洲，管理 cookie 的使用。

# vb.net - Async httpListener 是在 UI 线程上发起的回调吗？

> ID：12253870
> 
> 赞同：1
> 
> 时间：2012-09-03T20:49:34.900
> 
> 标签：vb.net, asynchronous, httplistener

我希望将 httpListener 构建到一个小型服务器应用程序中。在阅读它时，我[在stackoverflow上的这个问题中遇到了以下代码片段](https://stackoverflow.com/questions/6907841/httplistener-performance-optimization)

```
Public Class HTTPServer

Shared Listener As HttpListener = New HttpListener

Public Shared Sub Start()

    ServicePointManager.DefaultConnectionLimit = 500
    ServicePointManager.Expect100Continue = False
    ServicePointManager.MaxServicePoints = 500

    Listener.Prefixes.Add("http://localhost/")
    Listener.Start()

    For i As Integer = 1 To (System.Environment.ProcessorCount * 2)

        Dim NewThread As New System.Threading.Thread(AddressOf ListenerThread)
        NewThread.Priority = ThreadPriority.Normal
        NewThread.IsBackground = True
        NewThread.Start()

    Next

End Sub

Private Shared Sub ListenerThread()

    Dim SyncResult As IAsyncResult

    While True

        SyncResult = Listener.BeginGetContext(New AsyncCallback(AddressOf ListenerCallback), Listener)
        SyncResult.AsyncWaitHandle.WaitOne()

    End While

End Sub

Private Shared Sub ListenerCallback(ByVal StateObject As IAsyncResult)

    Dim Listener As HttpListener = DirectCast(StateObject.AsyncState, HttpListener)

    Dim Context As HttpListenerContext = Listener.EndGetContext(StateObject)
    Dim Request As HttpListenerRequest = Context.Request

    Dim Response As HttpListenerResponse = Context.Response

    Dim ResponseString As String = "OK"

    Dim Buffer As Byte() = System.Text.Encoding.UTF8.GetBytes(ResponseString)
    Response.ContentLength64 = Buffer.Length
    Dim OutputStream As System.IO.Stream = Response.OutputStream
    OutputStream.Write(Buffer, 0, Buffer.Length)

    OutputStream.Close()
    OutputStream.Dispose()

End Sub

End Class 
```

这看起来很简单，看起来很像[msdn 示例](http://msdn.microsoft.com/en-us/library/system.net.httplistener.begingetcontext.aspx)。然而，在一个虚拟项目中测试它时，我发现了一些让我感到困惑的事情，例如 UI 对象可以直接从回调子访问，我认为这应该会导致跨线程异常。

为了澄清，我稍微修改了这段代码以在一个简单的 winforms 项目的主窗体中运行。

似乎我不完全理解代码，例如 AsyncWaitHandle.WaitOne() 对我来说是全新的。

有人可以简要介绍一下这个片段吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T07:46:15.597

此片段代码如下所示：

1.  它创建一个 HttpListener 并在 uri 处开始 linsening；
2.  它创建一些线程（System.Environment.ProcessorCount * 2 的数量）向侦听器发送异步请求以尝试获取上下文；
3.  然后线程被调用 SyncResult.AsyncWaitHandle.WaitOne() 阻塞，关于 AsyncWaitHandle.WaitOne 请查看[AsyncWaitHandle.WaitOne 的详细信息](https://stackoverflow.com/questions/1816099/details-of-asyncwaithandle-waitone)
4.  如果有客户端请求进来，ListenerCallback() 将被触发，并尝试将响应发送回客户端
5.  然后进入下一轮循环。

因为它调用了 SyncResult.AsyncWaitHandle.WaitOne() 来阻塞该线程，所以它会通过**Synchronously**调用获得相同的结果。

在我看来，它只是返回一个简单的 OK 响应，所以我们甚至不需要任何其他线程。我会尽快给你看代码（如果我们有繁重的操作，我的代码将不能很好地工作，请不要在表单应用程序中这样做。）

```
 static void Main(string[] args)
    {
        ServicePointManager.DefaultConnectionLimit = 500;
        ServicePointManager.Expect100Continue = false;
        ServicePointManager.MaxServicePoints = 500;

        HttpListener listener = new HttpListener();
        listener.Prefixes.Add("http://localhost:999/");
        listener.Start();
        listener.BeginGetContext(ListenerCallBack, listener);

        Console.ReadLine();
    }

    private static void ListenerCallBack(IAsyncResult result)
    {
        HttpListener httpListener = (HttpListener) result.AsyncState;
        // Call EndGetContext to complete the asynchronous operation.
        HttpListenerContext context = httpListener.EndGetContext(result);
        HttpListenerRequest request = context.Request;
        // Obtain a response object.
        HttpListenerResponse response = context.Response;
        // Construct a response. 
        string responseString = "<HTML><BODY> Hello world!</BODY></HTML>";
        byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseString);
        // Get a response stream and write the response to it.
        response.ContentLength64 = buffer.Length;
        System.IO.Stream output = response.OutputStream;
        output.Write(buffer,0,buffer.Length);
        // You must close the output stream.
        output.Close();

        // we call BeginGetContext() to send async request again for next coming client
        httpListener.BeginGetContext(ListenerCallBack, httpListener);
    } 
```

在 C#5 和 Net 4.5 中，我们有同步方法，它会更容易：

```
static void Main(string[] args)
    {
        ServicePointManager.DefaultConnectionLimit = 500;
        ServicePointManager.Expect100Continue = false;
        ServicePointManager.MaxServicePoints = 500;

        HttpListener listener = new HttpListener();
        listener.Prefixes.Add("http://localhost:999/");
        listener.Start();

        while (true)
        {
            var t = listener.GetContextAsync();
            HttpListenerContext context = t.Result;
            HttpListenerRequest request = context.Request;
            // Obtain a response object.
            HttpListenerResponse response = context.Response;
            // Construct a response. 
            string responseString = "<HTML><BODY> Hello world!</BODY></HTML>";
            byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseString);
            // Get a response stream and write the response to it.
            response.ContentLength64 = buffer.Length;
            System.IO.Stream output = response.OutputStream;
            output.Write(buffer, 0, buffer.Length);
            // You must close the output stream.
            output.Close();
        }
    } 
```

对于您关于 UI 的“跨线程异常”的另一个问题，您是对的，创建的新线程将为 SynchronizationContext.Current 具有空值，因为它是线程池线程，我们需要在表单的 SynchronizationContext 中执行 post()。以下是更多信息[http://msdn.microsoft.com/en-us/magazine/gg598924.aspx](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)和[http://blogs.msdn.com/b/pfxteam/archive/2012/01/20/10259049.aspx](http://blogs.msdn.com/b/pfxteam/archive/2012/01/20/10259049.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-05T09:20:52.290

带有 HttpListener（名称：server）、BackgroundWorker（名称：bw_server）、2 个按钮（名称：btn_start & btn_stop）和 TextBox（名称：tb_log）的简单 C# WebServer：

```
public partial class Form1 : Form
{
    HttpListener server;
    private void btn_start_Click(object sender, EventArgs e)
    {
        bw_server.RunWorkerAsync(@"http://+:80/");
    }

    private void bw_server_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
    {
        string prefix = e.Argument.ToString();
        bw_server.ReportProgress(0, "Starting server...");
        if (!bw_server.CancellationPending)
        {
            try
            {
                start_server(prefix);
            }
            catch (Exception ex)
            {
                bw_server.ReportProgress(0, ex.Message);
                bw_server.CancelAsync();
            }
        }
        else
        {
            e.Cancel = true;
            return;
        }
    }

    private void bw_server_ProgressChanged(object sender, System.ComponentModel.ProgressChangedEventArgs e)
    {
        log(e.UserState.ToString());
    }

    private void bw_server_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
    {
        if (e.Cancelled)
        {
            log("Server was stopped");
        }
        else
        {
            log("Server work was completed");
        }
    }

    private void log(string msg)
    {
        if (String.IsNullOrEmpty(msg)) return;
        tb_log.AppendText((tb_log.Text == String.Empty ? String.Empty : Environment.NewLine) + DateTime.Now.ToLongTimeString() + " " + msg);
    }

    private void btn_stop_Click(object sender, EventArgs e)
    {
        WebRequest.Create("http://localhost:" + port + "/?stop=1").GetResponse();
        bw_server.CancelAsync();
    }

    private void start_server(string prefix)
    {
        server = new HttpListener();
        if (!HttpListener.IsSupported) return;
        if (String.IsNullOrEmpty(prefix))
        {
            throw new ArgumentException("prefix");
        }
        server.Prefixes.Add(prefix);
        server.Start();
        while (server.IsListening)
        {
            HttpListenerContext context = server.GetContext();
            HttpListenerRequest request = context.Request;
            if (request.HttpMethod == "GET")
            {
                HttpListenerResponse response = context.Response;
                response.ContentType = "text/html; charset=UTF-8";
                if (request.QueryString["stop"] == "1")
                {
                    write_to_resp(response, "server was stopped");
                    server.Stop();
                }
                else
                {
                    write_to_resp(response, "bad params");
                }
            }
        }
    }

    private static void write_to_resp(HttpListenerResponse response, string str_resp)
    {
        byte[] buffer = Encoding.UTF8.GetBytes(str_resp);
        response.ContentLength64 = buffer.Length;
        response.OutputStream.Write(buffer, 0, buffer.Length);
    }
} 
```

# asp.net - 会话过期后如何保留数据

> ID：12253872
> 
> 赞同：1
> 
> 时间：2012-09-03T20:49:50.923
> 
> 标签：asp.net, vb.net, session

如果他们的会话已过期，我想将用户重定向到自定义页面。

```
On PageLoad
If Session("OrgID") = Nothing Then
    Response.Redirect("SchoolLogin.aspx?schoolID="+[schoolid])
End If 
```

我可以将 schoolID 存储在每个页面的隐藏字段中，但这似乎不太优雅。我想尝试在每个页面上都有的用户控件中使用隐藏字段，但是用户控件 PageLoad 在主 PageLoad 之后触发，所以在检查会话到期之前我会收到一个错误。有一个通用的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:06:21.300

您可以使用 QueryString、ViewState（ASP.NET 的内置隐藏字段）或将其设置为 cookie 值。

我对你的场景了解不够。我能提供的最好的例子是我如何处理（我猜的）与你的情况相似的例子。

为您的所有页面类创建一个基类以继承（更多在这里oldy but goody [http://www.4guysfromrolla.com/articles/041305-1.aspx](http://www.4guysfromrolla.com/articles/041305-1.aspx)），将您的 SchoolId 属性添加到它。这是在 c# 中，我很抱歉，不幸的是 VB.NET 语法确实让我牙疼。翻译起来应该不会太难，因为这是非常基本的东西。

使用 QuertString，您需要测试 -1 并在这种情况下重定向。

```
public class BasePage : System.Web.UI.Page
{
    public int SchoolId
    {
        get
        {
            if (Request.QueryString["schoolId"] != null)
            {
                return Convert.ToInt32(Request.QueryString["schoolId"]);
            }
            else
            {
                return -1;
            }
        }
    }
} 
```

使用 ViewState

```
public class BasePage : System.Web.UI.Page
{
    public int SchoolId
    {
        get
        {
            if (ViewState["schoolId"] != null)
            {
                return (int)ViewState["schoolId"];
            }
            else
            {
                int schoolId = someDataLayer.SelectUsersSchoolId(User.Identity.Name);
                ViewState["schoolId"] = schoolId;
                return schoolId;
            }
        }
    }
} 
```

使用 cookie（更多信息）[http://msdn.microsoft.com/en-us/library/aa289495 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa289495%28v=vs.71%29.aspx)

```
public class BasePage : System.Web.UI.Page
{
    public int SchoolId
    {
        get
        {
            if (Request.Cookies["schoolId"] != null)
            {
                return (int)Request.Cookies["schoolId"].Value;
            }
            else
            {
                int schoolId = someDataLayer.SelectUsersSchoolId(User.Identity.Name);
                Request.Cookies["schoolId"].Value = schoolId;
                Request.Cookies["schoolId"].Expires = DateTime.Now.AddDays(1);
                return schoolId;
            }
        }
    }
} 
```

# html - 如果我的域在 IE 兼容性视图列表中，是否仍可以强制它处于标准模式？

> ID：12253875
> 
> 赞同：1
> 
> 时间：2012-09-03T20:50:03.017
> 
> 标签：html, internet-explorer, ie-compatibility-mode

它是有效的 html5，它在该部分中具有 the`<!doctype html>`和 meta 标签`<head>`

```
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
```

# python - 查找从 SQLAlchemy 中的自定义查询类查询的类？

> ID：12253877
> 
> 赞同：2
> 
> 时间：2012-09-03T20:50:16.210
> 
> 标签：python, sqlalchemy, polymorphism

我目前在 SQLA 中做这样的事情：

```
class Base(object):
    query = DBSession.query_property()
    @classmethod
    def _get_fulltext_query(cls, terms):
        # Search is a method which runs a fulltext search in Whoosh for objects of the given type, returning all ids which match the given terms
        ids = search(terms, cls.__name__)
        return cls.query.filter(cls.id.in_(ids)) 
```

我想设置一个自定义查询类并执行以下操作：

```
class BaseQuery(Query):
    def fulltext(self, terms):
        # Need a way to find out what class we're querying so that I can run the fulltext search and return the proper query

class Base(object):
    query = DBSession.query_property(BaseQuery) 
```

它对我来说似乎更干净。我还有其他用例需要知道正在查询什么类——例如，一系列通知类，我需要知道要返回什么通知类型。

有没有办法找出从 BaseQuery.fulltext 中查询的类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T23:02:20.777

这应该有效：

```
class BaseQuery(Query):
    def fulltext(self, terms):
        # assuming query is always created with `cls.query` or `DBSession.query(cls)`
        cls = self._entities[0].type
        ... 
```

# php - 通过 POST 发送给 PHP 的值都是空字符串

> ID：12253882
> 
> 赞同：0
> 
> 时间：2012-09-03T20:50:55.753
> 
> 标签：php, html, forms, post

我有以下表格：

```
<FORM action="http://url.to.mysite.com/doc.php" method="post">
    <INPUT type="text" id="name">
    <INPUT type="text" id="id">
    <INPUT type="submit" value="Send">
    </P>
 </FORM> 
```

不幸的是，无论在文本字段中输入什么，PHP 脚本在每个`$_POST`变量中都只接收空字符串。所有的变量都设置好了，只是空的。这可能是什么原因？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-03T20:53:16.673

您在 html 中缺少名称属性：

```
<FORM action="http://url.to.mysite.com/doc.php" method="post">
    <INPUT type="text" name="name" id="name">
    <INPUT type="text" name="id" id="id">
    <INPUT type="submit" value="Send">
</FORM> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T20:54:09.393

只有具有`name`属性的表单元素才会发送到 PHP 脚本（与 POST 相同）试试这个：

```
<form action="http://url.to.mysite.com/doc.php" method="post">
    <input type="text" id="name" name="name">
    <input type="text" id="id" name="id">
    <input type="submit" value="Send">
</form> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-03T20:54:05.453

您需要将 name 属性添加到输入标签。例子：`<input type="text" name="name" id="name" />`

# python - 下载 PDF 并使用 Allias（标题、描述、日期...）将提取的文本发送到另一个脚本

> ID：12253884
> 
> 赞同：0
> 
> 时间：2012-09-03T20:51:03.383
> 
> 标签：python, pdf, connection, pdf-generation

我使用了模块板岩，它基于 pdfminer。

下面的脚本可以正确阅读第1页和第2页的文章，但是页面多，pdf文件多所以布局可能会变化pdf有点多变，有时会在下一页跑一篇文章，所以没有放下是-so它没有很好地显示出来。可能必须构建一个for循环，但我不知道具体如何。一个 for 循环可能是必须构建的，但我不知道具体是如何构建的。

还打算将项目留在数据库中，但首先仍必须将其发送到过滤器脚本。那么，如果可以将项目分类为标题、描述、日期文章、添加日期、url 和 regio_land 是否有用？

PDF 文件：

*   [DHS_Daily_Report_2012-08-30](http://www.dhs.gov/sites/default/files/publications/DHS_Daily_Report_2012-08-30.pdf)
*   [DHS_Daily_Report_2012-08-29](http://www.dhs.gov/sites/default/files/publications/DHS_Daily_Report_2012-08-29.pdf)
*   [DHS_Daily_Report_2012-08-28](http://www.dhs.gov/sites/default/files/publications/DHS_Daily_Report_2012-08-28.pdf)
*   [DHS_Daily_Report_2012-08-27](http://www.dhs.gov/sites/default/files/publications/DHS_Daily_Report_2012-08-27.pdf)
*   [更多每日报告](http://www.dhs.gov/dhs-daily-open-source-infrastructure-report)

* * *

```
import slate

global artikelIndexStr

with open('report.pdf') as f:
doc = slate.PDF(f)

report = slate.PDF(f)

pdfstring = doc[1] + doc[2] + doc[3] + doc[4] + doc[5] + doc[6] + doc[7] + doc[8] + doc[9] + doc[10] + doc[11] + doc[12] + doc[13] + doc[14] + doc[15] + doc[16] + doc[17] + doc[18] + doc[19] + doc[20]

# print pdfstring

f3 = 'Even iets'        
f3 = pdfstring
temparray = []
temparray2 = []
artikelIndex = 1
artikelIndexStr = ""

while f3 != "":

    f1, f2, f3 = f3.partition("[Return to top]")

    temparray.append(f1)

    print len(temparray)

nieuweIndex = "" + temparray[0]

print nieuweIndex

a1, a2, a3 = nieuweIndex.partition("1\. ")
b1, b2, b3 = a3.partition("Source: ")
c1, c2, c3 = b3.partition("2\. ")
d1, d2, d3 = c3.partition("Source: ") 
e1, e2, e3 = d3.partition("3.") 
g1, g2, g3 = e3.partition("Source: ") 
h1, h2, h3 = g3.partition("4.") 
i1, i2, i3 = h3.partition("Source: ") 
j1, j2, j3 = i3.partition("5.") 
k1, k2, k3 = h3.partition("Source: ") 
l1, l2, l3 = i3.partition("6.")

print ""
print b1
print ""
print c1
print ""
print d1
print ""
print e1
print ""
print g1
print ""
print h1
print ""
print i1
print ""
print j1
print ""
print k1
print ""
print l1 
```

# ruby-on-rails - 不同顶级域重定向RSpec/Capybara测试

> ID：12253885
> 
> 赞同：1
> 
> 时间：2012-09-03T20:51:06.097
> 
> 标签：ruby-on-rails, rspec, capybara

关于 RSpec/Capybara，我有一个相当普遍的问题。如果应用程序基于 TLD 进行重定向（例如，example.com 和 example.net 都解析为相同的 IP，但对第一个的请求被重定向到 example.com/locale_com，而对第二个的请求被重定向 -到 example.net/locale_net)，请求测试会是什么样子？该应用程序是用 Rails 编写的。

我可以想到一种方法——为两个主机（example.com 和 example.net）添加条目以在 /etc/hosts 中解析为 127.0.0.1——但这对我不起作用，因为会运行测试在没有root访问权限的不同机器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:46:06.633

我会在我的 Rspec 控制器测试中对此进行测试：

```
describe MyController do
  describe "GET index" do
    before(:each) do
      request.host = "example.net"
      get :index
    end

    it "should redirect .net to .com" do
      uri = URI.parse(response.headers["Location"])
      expect(uri.host).to eq "example.com"
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:26:46.173

如果重定向是通过路由文件发生的，您可以使用以下代码在控制器规范之外进行测试：

```
describe "Route Redirects" do
  describe "GET example.net" do
    before(:each) do
      request.host = "example.net"
      get "/"
    end

    it "redirect to example.com" do
      expect(response.code).to eq 302
      uri = URI.parse(response.location)
      expect(uri.host).to eq "example.com"
    end
  end
end 
```

# r - 在循环中替换变量？

> ID：12253889
> 
> 赞同：-8
> 
> 时间：2012-09-03T20:51:45.573
> 
> 标签：r, variables, loops

我正在尝试在 R 中编写一个循环，但我认为命名法不正确，因为它不会创建新对象，这是我正在尝试做的一个简化示例：

```
for i in (1:8) {

List_i <-List
colsToGrab_i <-grep(predefinedRegex_i, colnames(List_i$table))
List_i$table <-  List_i$table[,predefinedRegex_i]
} 
```

我创建了 'predefinedRegex'es 1:8，grep 应该使用它来搜索循环创建一个名为“List_i”的对象，然后找不到“predefinedRegex_i”。

我曾尝试在 i 前面加上 "i" 和 $ 引号，也 [i] 但这些不起作用。

非常感谢任何帮助。谢谢你。

#

在下面使用@RyanGrammel 的答案::

```
#CREATING regular expressions for grabbing sets groups 1 -7 ::::
g_1 <- "DC*"
g_2 <- "BN_._X.*"
g_3 <- "BN_a*"
g_4 <- "BN_b*"
g_5 <- "BN_a_X.*"
g_6 <- "BN_b_X.*"
g_7 <- "BN_._Y.*"

for i in (1:8) 
{
assign(x = paste("tableA_", i, sep=""), value = BigList$tableA)
assign(x = paste("Forgrep_", i, sep=""), value = colnames(get(x = paste("tableA_", i, sep=""))))
assign(x = paste("grab_", i, sep=""), value = grep((get(x = paste("g_",i, sep=""))), (get(x = paste("Forgrep_",i, sep="")))))
assign(x = paste("tableA_", i, sep=""), value = BigList$tableA[,get(x = paste("grab_",i, sep=""))])
} 
```

对“BigList”中的每个表重复此循环。我发现我无法从 (get(x = paste("BigList_", i, "$tableA" sep="")))) 中提取列名

或 from (get(x = paste("BigList_", i, "[[2]]" sep="")))) 所以更容易先提取表格。我现在将编写一个循环来重新打包列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T08:01:04.590

**问题**

您的语法已关闭：您似乎不了解 R 究竟如何处理变量名。

```
for(i in 1:10) name_i <- 1 
```

上面的代码没有指定name_1、name_2、....、name_10。它一遍又一遍地分配“name_i”

*   要创建一个列表，你调用 'list()'，而不是 List

*   在循环中创建变量 List_i*不会*分配 List_1、List_2、...、List_8。

它重复地将一个空列表分配给名称“List_i”。想想看；如果 R 以您尝试的方式命名变量，则同样可能将您的变量命名为 L1st_1、L2st_2 ...有关一些有效的 R 代码，请参见“解决方案”执行类似操作

*   'predefinedRegex_i' 不会被解释为尝试获取变量 'predefinedRegex_1'、'predefinedRegex_2' 等等。

但是，get(paste0("predefinedRegex_", i)) 就是以这种方式解释的。只要确保*我*在使用它时确实有价值。见下文。

**解决方案：**

通常，使用它来动态*分配*变量（List_1、List_2、..）

```
assign(x = paste0("prefix_", i), value = i) 
```

如果*i*等于 199，则此代码将值 199 分配给变量 prefix_199。

通常，使用它来动态*获取*您使用上述代码片段分配的变量。

```
get(x = paste0("prefix_", i)) 
```

如果*i*等于 199，则此代码获取变量 prefix_199。

那应该可以解决您问题的症结；如果您需要任何进一步的帮助，请随时在此处要求澄清，或通过我的 Twitter 订阅源与我联系。

# google-plus - 如何访问 Google+ 环聊？

> ID：12253890
> 
> 赞同：18
> 
> 时间：2012-09-03T20:51:48.810
> 
> 标签：google-plus, hangout

我想实现一个在聊天之外工作的扬声器队列管理器 - 有关更多详细信息，请参阅 GitHub repo [Q Bot](https://github.com/mhausenblas/q-bot) - 但无法找到一种方法来收听聊天事件（然后对它们做出反应）。有什么提示吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T23:13:59.747

无法从环聊 API 访问聊天。

但是，对此有一个[开放的功能请求](http://code.google.com/p/google-plus-platform/issues/detail?id=29)。如果您为问题加注星标，您会在问题更新时收到通知。

您可以通过在环聊扩展程序中创建自己的界面来控制此应用程序的输入来解决此问题，而不是重载聊天功能。

# actionscript-3 - Flex mx:DateChooser 粗体单元格边框问题

> ID：12253899
> 
> 赞同：2
> 
> 时间：2012-09-03T20:52:42.913
> 
> 标签：actionscript-3, apache-flex, actionscript, datechooser

![在此处输入图像描述](../Images/7a0f9e908c6f0ff63d899ee1a17aa6f0.png)

```
 <mx:Script>
        <![CDATA[
            import mx.core.UITextField;

            private function setDayStyles():void{
                var dateField  :UITextField;
                var colIndex : int;
                var rowIndex : int;
                dateChooser.mx_internal::dateGrid.height = 148;
                dateChooser.mx_internal::dateGrid.width = 176;

                //Change background for weekday name row
                for(colIndex = 0; colIndex < 7; colIndex++){
                    dateField = dateChooser.mx_internal::dateGrid.mx_internal::dayBlocksArray[colIndex][0] as UITextField;
                    dateField.background = true;
                    dateField.border = true;
                    dateField.backgroundColor = 0xCCCCCC;
                    dateField.borderColor = 0xCCCCCC;

                } 
                //set border for day labels
                for(rowIndex = 1; rowIndex < 7; rowIndex++){
                    for(colIndex = 0;  colIndex < 7; colIndex++){
                        dateField = dateChooser.mx_internal::dateGrid.mx_internal::dayBlocksArray[colIndex][rowIndex] as UITextField;
                        dateField.border = true;
                        dateField.borderColor = 0xCCCCCC;
                    }
                } 
            }

        ]]>
    </mx:Script>

    <mx:HBox  horizontalGap="15" styleName="padding10Style">
        <mx:DateChooser id="dateChooser" initialize="setDayStyles()"/>
    </mx:HBox>

</mx:Application> 
```

我正面临大胆的边界问题。以下是供您参考的代码片段：

我试图动态设置边界，因为这是 UITextFiled ，这是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T13:42:00.387

终于找到解决办法了……呵呵！！！
实际上行为是有线的...... :(
最初我认为问题是因为边框重叠......然后我突然意识到粗体边框的数量不是固定的，它们在不同的机器上是不同的...... Babun的（我的朋友。 ..多亏了他）观察也是一样的...
它基本上是DateChooser的渲染问题...边框宽度根据高度和宽度自动调整....
玩了宽度和高度，得到了预期的结果。修改宽度高度是：

```
dateChooser.mx_internal::dateGrid.height = 147;
dateChooser.mx_internal::dateGrid.width = 175; 
```

![粗体边框不再存在](../Images/48ac262e8ee8054dffadba3f0c2c3dde.png)

痛苦结束了:)

@Flextras 感谢您的时间

继续玩-S

# java - 获取按上次修改排序的目录中的文件？

> ID：12253908
> 
> 赞同：18
> 
> 时间：2012-09-03T20:53:50.783
> 
> 标签：java, java-7

在具有新 I/O API 的 Java 7 中，是否有一种按上次修改日期列出目录内容的简单方法？基本上我只需要获取最长时间未修改的文件（按最后修改的升序排序，取第一个文件名）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-03T21:03:09.227

没有真正的“简单方法”可以做到这一点，但有可能：

```
List<Path> files = new ArrayList<>();
try(DirectoryStream<Path> stream = Files.newDirectoryStream(dir)) {
    for(Path p : stream) {
        files.add(p);
    }
}

Collections.sort(files, new Comparator<Path>() {
    public int compare(Path o1, Path o2) {
        try {
            return Files.getLastModifiedTime(o1).compareTo(Files.getLastModifiedTime(o2));
        } catch (IOException e) {
            // handle exception
        }
    }
}); 
```

这将排序文件最快修改文件最后。`DirectoryStream`s 不遍历子目录。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-02T14:42:38.443

杰弗里的答案稍微“流”变，有些人可能会觉得更容易。发布以确保完整性。

```
try (DirectoryStream<Path> files = Files.newDirectoryStream(path)) {
    StreamSupport.stream(files.spliterator(), false)
        .sorted((o1, o2) -> {
            try {
                return Files.getLastModifiedTime(o1).compareTo(Files.getLastModifiedTime(o2));
            } catch (IOException ex) {
                ...
            }
        })
        .filter(file -> Files.isRegularFile(file))
        .forEach(file -> {
        });
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T21:00:33.957

在目录的 File 对象上使用 listFiles()。将数组转换为数组列表。然后使用 Collections 类上的静态排序方法和自定义 Comparator 对它们进行排序，该 Comparator 使用 Files 上的 getTotalSpace() 方法。编辑：使用 lastModified 而不是 getTotalSpace。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T20:57:40.383

```
lastModified() 
```

返回此抽象路径名表示的文件最后一次修改的时间。

[Java 7 - IO API](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T20:59:48.230

您可以使用[http://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html#listFiles(java.io.FileFilter](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html#listFiles(java.io.FileFilter) ) 并提供[http://docs.oracle.com /javase/1.5.0/docs/api/java/io/FileFilter.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/FileFilter.html)

然后比较[http://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html#lastModified](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/File.html#lastModified) () 就大功告成了

如果您确实关心性能-那么只需从文件列表中取一个具有最大/最小值的值，这将为您带来 O(n) 复杂性

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-17T07:48:26.160

注意：此解决方案需要 Guava。

Java IO/NIO API 提供对目录列表*的低级访问*，但没有完成任何处理，这留给调用者。在访问目录列表以进行进一步处理（例如排序）时，新的 J *ava7 NIO DirectoryStream占用空间最小。*

这是我的**解决方案：从****DirectoryStream**读取文件并从流中构建一个（可选）有限大小的排序队列。从队列中返回最旧/最新的元素。

```
private void listFilesOldestFirst(final File directory, final Integer maxNumberOfFiles) {

    final Builder<File> builder =
            MinMaxPriorityQueue
            .orderedBy(LastModifiedFileComparator.LASTMODIFIED_COMPARATOR);
    if( maxNumberOfFiles != null ) {
        builder.maximumSize(maxNumberOfFiles);
    }

    // queue with constant space, if maxNumberOfFiles is set, otherwise behaves like an unbound queue with an O(log n) penalty for insertion
    final MinMaxPriorityQueue<File> oldestFiles = builder.create();

    try(DirectoryStream<Path> stream = Files.newDirectoryStream(directory.toPath())) {
        for(final Path p : stream) {
            oldestFiles.add(p.toFile());
        }
    } catch (final IOException e) {
        throw new RuntimeException(e);
    }

    final File[] fileArray = oldestFiles.toArray(new File[]{});
    Arrays.sort(fileArray, oldestFiles.comparator());
    // ... use fileArray

    final ArrayList<File> arrayList = Lists.newArrayList(oldestFiles);
    Collections.sort(arrayList, oldestFiles.comparator());
    // ... use arrayList

} 
```

**Guava MinMaxPriorityQueue**和**FileComparator**需要这些依赖项：

```
 <dependency>
        <groupId>com.google.guava</groupId>
        <artifactId>guava</artifactId>
        <version>18.0</version>
    </dependency>
    <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
        <version>2.4</version>
    </dependency> 
```

您可能还会发现*Files.newDirectoryStream的***filter**参数很有用：

 *```
 final Filter<Path> sampleFilter = new Filter<Path>() {
        @Override
        public boolean accept(final Path entry) throws IOException {
            return true; // see commons-io -> FileFilterUtils
        }
    };

    ...
    Files.newDirectoryStream(directory.toPath(), sampleFilter) 
```*

# ruby-on-rails-3 - belongs_to / has_many 在 Rails 控制台中的行为不符合预期

> ID：12253914
> 
> 赞同：1
> 
> 时间：2012-09-03T20:54:13.087
> 
> 标签：ruby-on-rails-3, activerecord, one-to-many

楷模：

```
class Person < ActiveRecord::Base
  attr_accessible :email, :first, :last, :uuid, :books
  has_many :books
end

class Book < ActiveRecord::Base
  belongs_to :person
  attr_accessor :blurb, :published, :title, :person
  attr_accessible :person
end 
```

我`Person`使用**Rails 3.2.8 控制台**创建了一个这样的：

```
person = Person.create!( {:first => "John", :last => "Doe"} ) 
```

然后创建了一个`Book`

```
book = Book.create!( {:title => "Ruby for Dummies"} ) 
```

然后我尝试像这样关联它们：

```
person.books << book 
```

当我向这个人查询书籍时，我得到了一个包含我创建的书籍的数组，但是当我查询这本书的所属人时，我得到了 nil。鉴于所有信息都已持久化，我希望能找到此人（我看到 SQL 命令并检查了数据库并且数据是正确的，即 book 表中的行指向它应该返回的人员 ID。）

我错过了什么？

谢谢

编辑模式：

```
CREATE TABLE `persons` (
    `id` INT(11) NOT NULL AUTO_INCREMENT,
    `first` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
    `last` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
    `uuid` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
    `email` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
    `created_at` DATETIME NOT NULL,
    `updated_at` DATETIME NOT NULL,
    PRIMARY KEY (`id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
AUTO_INCREMENT=2;

CREATE TABLE `books` (
    `id` INT(11) NOT NULL AUTO_INCREMENT,
    `title` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8_unicode_ci',
    `blurb` TEXT NULL COLLATE 'utf8_unicode_ci',
    `published` TINYINT(1) NULL DEFAULT NULL,
    `person_id` INT(11) NULL DEFAULT NULL,
    `created_at` DATETIME NOT NULL,
    `updated_at` DATETIME NOT NULL,
    PRIMARY KEY (`id`)
)
COLLATE='utf8_unicode_ci'
ENGINE=InnoDB
AUTO_INCREMENT=3; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:40:40.860

假设您的迁移是正确的，那么您的代码没有任何问题，应该会产生以下结果：

```
1.9.3p194 :001 > person = Person.create!( {:first => "John", :last => "Doe"} )
   (0.1ms)  begin transaction
  SQL (145.9ms)  INSERT INTO "people" ("book_id", "created_at", "email", "first", "last", "updated_at", "uuid") VALUES (?, ?, ?, ?, ?, ?, ?)  [["book_id", nil], ["created_at", Mon, 03 Sep 2012 21:35:53 UTC +00:00], ["email", nil], ["first", "John"], ["last", "Doe"], ["updated_at", Mon, 03 Sep 2012 21:35:53 UTC +00:00], ["uuid", nil]]
   (43.5ms)  commit transaction
 => #<Person id: 1, email: nil, first: "John", last: "Doe", uuid: nil, book_id: nil, created_at: "2012-09-03 21:35:53", updated_at: "2012-09-03 21:35:53"> 
1.9.3p194 :005 > book = Book.create!( {:title => "Ruby for Dummies"} )
   (0.1ms)  begin transaction
  SQL (1.4ms)  INSERT INTO "books" ("blurb", "created_at", "person_id", "published", "title", "updated_at") VALUES (?, ?, ?, ?, ?, ?)  [["blurb", nil], ["created_at", Mon, 03 Sep 2012 21:36:25 UTC +00:00], ["person_id", nil], ["published", nil], ["title", nil], ["updated_at", Mon, 03 Sep 2012 21:36:25 UTC +00:00]]
   (4.4ms)  commit transaction
 => #<Book id: 1, blurb: nil, published: nil, title: nil, person_id: nil, created_at: "2012-09-03 21:36:25", updated_at: "2012-09-03 21:36:25"> 
1.9.3p194 :006 > person.books << book
   (0.1ms)  begin transaction
   (0.3ms)  UPDATE "books" SET "person_id" = 1, "updated_at" = '2012-09-03 21:36:39.566387' WHERE "books"."id" = 1
   (4.4ms)  commit transaction
  Book Load (0.3ms)  SELECT "books".* FROM "books" WHERE "books"."person_id" = 1
 => [#<Book id: 1, blurb: nil, published: nil, title: nil, person_id: 1, created_at: "2012-09-03 21:36:25", updated_at: "2012-09-03 21:36:39">] 
1.9.3p194 :007 > Book.all
  Book Load (0.5ms)  SELECT "books".* FROM "books" 
 => [#<Book id: 1, blurb: nil, published: nil, title: nil, person_id: 1, created_at: "2012-09-03 21:36:25", updated_at: "2012-09-03 21:36:39">] 
```

问题出在您的 Book 模型上，请尝试以下操作：

```
class Book < ActiveRecord::Base
  attr_accessible :person, :title, :person

  belongs_to :person
end 
```

**之前**：

```
1.9.3p194 :002 > Book.last
  Book Load (0.1ms)  SELECT "books".* FROM "books" ORDER BY "books"."id" DESC LIMIT 1
 => #<Book id: 4, blurb: nil, published: nil, title: nil, person_id: 1, created_at: "2012-09-03 21:55:33", updated_at: "2012-09-03 21:55:33"> 
1.9.3p194 :003 > Book.last.person
  Book Load (0.2ms)  SELECT "books".* FROM "books" ORDER BY "books"."id" DESC LIMIT 1
 => nil 
```

**之后**：

```
1.9.3p194 :001 > Book.last
  Book Load (0.4ms)  SELECT "books".* FROM "books" ORDER BY "books"."id" DESC LIMIT 1
 => #<Book id: 4, blurb: nil, published: nil, title: nil, person_id: 1, created_at: "2012-09-03 21:55:33", updated_at: "2012-09-03 21:55:33"> 
1.9.3p194 :002 > Book.last.person
  Book Load (1.0ms)  SELECT "books".* FROM "books" ORDER BY "books"."id" DESC LIMIT 1
  Person Load (0.1ms)  SELECT "people".* FROM "people" WHERE "people"."id" = 1 LIMIT 1
 => #<Person id: 1, email: nil, first: "John", last: "Doe", uuid: nil, created_at: "2012-09-03 21:48:02", updated_at: "2012-09-03 21:48:02"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:08:57.450

您是否尝试过执行以下操作？如果是这样， book.person 会给你什么？

```
person = Person.create!( {:first => "John", :last => "Doe"} )
book = Book.create!( {:title => "Ruby for Dummies"} )
book.person_id = person.id

person.books 
book.person 
```

# php - 推特引导下拉菜单

> ID：12253916
> 
> 赞同：0
> 
> 时间：2012-09-03T20:54:30.650
> 
> 标签：php, html, drop-down-menu, twitter-bootstrap

如何使用**twitter bootstrap**创建下拉菜单。我目前的导航是

```
<ul class="nav nav-tabs " style="width: 860px;">
<li >
    <a href="#" >Employees</a>
</li>
<li >
    <a href="#" >Projects</a>
</li>
<li >
    <a href="#" >Clients</a>
</li>
<li >
    <a href="#" >Assign Projects</a>
</li>
<li >
    <a href="#" > Reports</a>

</li>
<li><a href="logout.php" >Logout</a></li> 
```

**这里我想要一个报告**链接的下拉菜单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:15:24.540

看那个例子：http: [//jsfiddle.net/jrV6u/](http://jsfiddle.net/jrV6u/)

并将此脚本包含到您的页面中：

[jQuery](http://code.jquery.com/jquery-1.8.1.min.js)

[引导下拉插件](http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:16:25.497

Boostrap 已经有了[http://twitter.github.com/bootstrap/components.html#dropdowns](http://twitter.github.com/bootstrap/components.html#dropdowns)

```
<div class="dropdown">
<!-- Link or button to toggle dropdown -->
<a href="#">Drop me!</a>
<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
<li><a tabindex="-1" href="#">Action</a></li>
<li><a tabindex="-1" href="#">Another action</a></li>
<li><a tabindex="-1" href="#">Something else here</a></li>
<li class="divider"></li>
<li><a tabindex="-1" href="#">Separated link</a></li>
</ul>
</div> 
```

# vb.net - 如何将 datagridview 数据传递给新表单上的控件？

> ID：12253918
> 
> 赞同：0
> 
> 时间：2012-09-03T20:54:37.210
> 
> 标签：vb.net, vb.net-2010

如何将数据从一个窗体上的 datagridview 控件传递到另一个窗体上的控件？我正在使用以下代码从我的数据库中检索信息 - 然后当用户选择适当的行时，我希望另一个表单上的控件显示与该行对应的数据。这可能吗？如果可以，我该怎么做？

**这是我的代码：**

```
If TextBox1.Text = "" Then
            MessageBox.Show("You must enter an account number to proceed!")
            TextBox1.Focus()
            Me.Refresh()
        Else
            Try
                dbConn = New MySqlConnection("Server=" & FormLogin.ComboBoxServerIP.SelectedItem & ";Port=3306;Uid=123456;Password=234567;Database=accounting")
                If dbConn.State = ConnectionState.Open Then
                    dbConn.Close()
                End If
                dbConn.Open()
                Dim dbAdapter As New MySqlDataAdapter("SELECT ccNumber, ccExpireMonth, ccExpireYear, ccZipcode FROM cc_master WHERE customer_accountNumber = " & TextBox1.Text, dbConn)
                Dim myDatatable As New DataTable
                dbAdapter.Fill(myDatatable)
                If myDatatable.Rows.Count > 0 Then
                    DataGridView1.DataSource = myDatatable
                Else
                    MessageBox.Show("No Customer Records Found!  Please try again!")
                    TextBox1.Clear()
                    TextBox1.Focus()
                End If

            Catch ex As Exception
                MessageBox.Show("A DATABASE ERROR HAS OCCURED" & vbCrLf & vbCrLf & ex.Message & vbCrLf & _
                            vbCrLf + "Please report this to the IT/Systems Helpdesk at Ext 131.")
            End Try

        End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T19:23:28.403

更好的是制作静态类并将所选行的数据放入其中，然后将该类中的数据访问到另一个表单。

# .htaccess - .htaccess - 如何在没有参数的情况下重写 url

> ID：12253919
> 
> 赞同：2
> 
> 时间：2012-09-03T20:54:40.570
> 
> 标签：.htaccess, url, permalinks

你好我还有一个问题

我有最简单的htaccess

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

它给了我友好的网址，例如。www.mysite.loc/blog/

但我想走得更远，例如。`www.mysite.loc/blog/?page=1`和`www.mysite.loc/blog/?page=1&id=1`

我怎样才能做到这一点 ？

PS我尝试了很多我在谷歌找到的解决方案，但没有任何效果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:00:18.337

也许你想要这样的东西：

```
RewriteRule ^(.*)$ /index.php?url=$1&%{query_string} [L] 
```

这样，对的请求`/blog/?page=1`将被映射到`/index.php?url=/blog/&page=1`并被`/blog/abc/?page=3`映射到`/index.php?url=/blog/abc/&page=3`.

然后，您将解析`$_GET['url']`以找出浏览器要求的资源。

# c++ - 使用文件 I/O 正确创建和运行 win32 服务

> ID：12253921
> 
> 赞同：4
> 
> 时间：2012-09-03T20:55:05.343
> 
> 标签：c++, c, winapi, service

我已经基于此[代码示例](http://code.msdn.microsoft.com/windowsdesktop/CppWindowsService-cacf4948)编写了一个非常简单的服务应用程序。

作为其正常运行的一部分，应用程序假定在它找到的目录中或其执行路径中存在一个文件。

当我“安装”服务，然后从控制面板中的服务管理器“启动”服务时。应用程序失败，因为它找不到要打开和读取的文件（即使该文件与已安装的可执行文件位于同一目录中）。

我的问题是当 Windows 服务运行时，预期的运行路径应该是什么？

调用“CreateService”时，似乎只有二进制文件的路径参数，而不是执行。有没有办法指出应该从哪里执行二进制文件？

我在 windows vista 和 windows 7 上试过这个。遇到同样的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T21:37:40.653

由于 Windows 服务在不同于普通用户模式应用程序的上下文中运行，因此最好不要对工作目录或相对路径做出任何假设。除了工作目录的差异之外，服务可以使用完全不同的权限集等运行。

使用服务所需文件的*绝对路径应该可以完全避免这个问题。*无论工作目录如何，绝对路径都将被解释为相同的，因此这应该使您的服务的工作目录无关紧要。有几种方法可以解决这个问题：

1.  **硬编码绝对路径**- 这可能是避免问题的最简单方法，但它也是最不灵活的。这种方法可能适用于基本的开发和测试工作，但在其他人开始使用您的程序之前，您可能需要一些更复杂的东西。
2.  **将绝对路径存储在环境变量中**- 这为您提供了额外的灵活性，因为现在可以将路径设置为任意值并根据需要进行更改。由于服务可以作为具有不同环境变量集的不同用户运行，因此这种方法仍然存在一些问题。
3.  **在注册表中存储绝对路径**——这可能是最简单的方法。从注册表中检索路径将为所有用户帐户提供相同的结果，而且这在安装时相对容易设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T21:22:08.930

默认情况下，Windows 服务的当前目录是 System32 文件夹。

一个有前途的解决方案是创建一个环境变量来保存输入位置的完整路径，并在运行时从该变量中检索路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T21:38:48.760

如果你使用与二进制相同的路径，你可以只读取二进制路径并相应地修改它。但这是相当快速的解决方案，而不是设计的解决方案。如果我是你，我会创建系统范围的环境变量并在那里存储值，或者（甚至更好）使用 Windows 注册表来存储服务配置。

笔记：

您需要使用[AdjustTokenPrivileges 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375202%28v=vs.85%29.aspx)为自己添加一些权限，您可以在函数中[看到](http://www.aspfree.com/c/a/Windows-Scripting/Working-with-the-Windows-Registry-in-C-plus-plus/)一个示例`ModifyPrivilege`。

还要确保使用 HKEY_LOCAL_MACHINE 而不是 HKEY_CURRENT_USER。服务在不同的用户帐户下运行，因此它的 HKCU 将与您在注册​​表编辑器中看到的不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-19T07:15:16.270

今天我解决了这个问题，因为我正在开发的一些软件需要它。

正如上面的人所说; 您可以将目录硬编码为特定文件 - 但这意味着任何需要加载的配置文件都必须放置在那里。

对我来说，这项服务安装在超过 50,000 台计算机上。我们将其设计为从运行服务可执行文件的目录加载。

现在，这很容易作为非系统进程设置和实现（我的大部分测试都是作为非系统进程进行的）。但问题是您使用的系统包装器（我也使用过）使用 Unicode 格式（并且依赖于它），因此传统的执行方式无法正常工作。

代码的注释部分应该解释这一点。有一些冗余，我知道，但是当我写这篇文章时，我只是想要一个工作版本。幸运的是，您可以使用 GetModuleFileNameA 以 ASCII 格式处理它

我使用的代码是：

```
char buffer[MAX_PATH]; // create buffer
DWORD size = GetModuleFileNameA(NULL, buffer, MAX_PATH); // Get file path in ASCII

std::string configLoc; // make string

for (int i = 0; i < strlen(buffer); i++) // iterate through characters of buffer
{
    if (buffer[i] == '\\') // if buffer has a '\' in it, replace with doubles
    {
        configLoc = configLoc + "\\\\"; // doubles needed for parsing. 4 = 2(str)
    }
    else
    {
        configLoc = configLoc + buffer[i]; // else just add char as normal
    }
}

// Complete location
configLoc = configLoc.substr(0, configLoc.length() - 17); //cut the .exe off the end
                                                          //(change this to fit needs)   
configLoc += "\\\\login.cfg"; // add config file to end of string 
```

从这里开始，您可以简单地将 configLoc 解析为新的 ifsteam - 然后处理内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-30T11:35:23.223

使用此功能将服务的工作目录调整为与其运行的 exe 的工作目录相同。

```
void AdjustCurrentWorkingDir() {
    TCHAR szBuff[1024];
    DWORD dwRet = 0;
    dwRet = GetModuleFileName(NULL, szBuff, 1024); //gets path of exe

    if (dwRet != 0 && GetLastError() != ERROR_INSUFFICIENT_BUFFER) {
        *(_tcsrchr(szBuff, '\\') + 1) = 0; //get parent directory of exe

        if (SetCurrentDirectory(szBuff) == 0) {
            //Error
        }
    }
} 
```

# javascript - Express.js 应用程序最大化 CPU

> ID：12253922
> 
> 赞同：0
> 
> 时间：2012-09-03T20:55:05.740
> 
> 标签：javascript, node.js, express, faye

我已经构建了一个 Express.js 应用程序，在带有 Intel Xeon CPU E5540 2.53Ghz 的 Ubuntu 上运行。

该应用程序使用 MongoDB 进行会话存储 ( `express-session-mongo`)，使用 EJS 进行视图渲染，使用 MySQL 进行数据存储，使用[Faye](http://faye.jcoglan.com/)进行内部消息传递。所有静态文件都由 Apache 在不同的端口上提供服务。

这是一个具有大量长轮询的实时应用程序，Faye 在这方面有很大帮助。它需要扩展到至少 500 个并发用户，每个用户将监听两个不同的长轮询连接。

但是，该应用程序将 CPU 最大化为大约 80-100 个用户，这会导致`500`错误。

关于可能是什么问题的任何想法或关于如何调试和解决此类问题的任何一般性建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:07:21.140

您需要分析您的应用程序以找到瓶颈。您可以使用[look](https://github.com/baryshev/look)或[nodetime](https://nodetime.com)来收集 CPU 配置文件并查找代码中的热点。

# c++ - 对大量使用 pow()

> ID：12253931
> 
> 赞同：0
> 
> 时间：2012-09-03T20:56:15.993
> 
> 标签：c++, type-conversion

我正在尝试解决一个问题，其中一部分需要我计算 (2^n)%1000000007 ，其中 n<=10^9。但是我的以下代码即使对于像 n = 99 这样的输入也会给我输出“0”。

除了有一个循环每次将输出乘以 2 并且每次都找到模数之外还有其他方法吗（这不是我要寻找的，因为这对于大量数字来说会非常慢）。

```
#include<stdio.h>
#include<math.h>
#include<iostream>
using namespace std;
int main()
{
    unsigned long long gaps,total;
    while(1)
    {
        cin>>gaps;
        total=(unsigned long long)powf(2,gaps)%1000000007;
        cout<<total<<endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:58:56.947

你需要一个“big num”库，不清楚你在哪个平台上，但从这里开始：http: [//gmplib.org/](http://gmplib.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T21:35:43.953

> 这不是我要找的，因为这对于大量的人来说会很慢

几乎任何其他解决方案都使用 bigint 库要慢得多。

不要在每次循环中都取模：而是只在输出增长大于模数时取模，如下所示：

```
#include <iostream>

int main() {
    int modulus = 1000000007;
    int n = 88888888;
    long res = 1;
    for(long i=0; i < n; ++i) {
        res *= 2;
        if(res > modulus)
            res %= modulus;
    }
    std::cout << res << std::endl;
} 
```

这实际上非常快：

```
$ time ./t
./t  1.19s user 0.00s system 99% cpu 1.197 total 
```

我应该提到，这样做的原因是，如果*a*和*b*是等价的 mod *m*（即*a % m = b % m*），那么这个等式包含*a*和*b*的多个*k*（也就是说，上述等式意味着*( a*k)%m = (b*k)%m* )。

 **** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T21:13:59.110

*Chris*提出了 GMP，但如果您只需要它并且想要以 C++ 方式而不是 C 方式来做事，并且没有不必要的复杂性，您可能只想检查[一下](https://mattmccutchen.net/bigint/)- 它在编译时生成的警告很少，但非常简单和只是作品™。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T03:41:05.107

您可以将您`2^n`的`2^m`. 你需要找到：`

```
2^m * 2^m * ... 2^(less than m) 
```

数字`m`应该`31`是 32 位 CPU。那么你的答案是：

```
chunk1 % k  * chunk2 * k ...    where k=1000000007 
```

你还在`O(N)`。`chunk % k` 但是，您可以利用除最后一个之外所有人都平等的事实，您可以做到`O(1)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-12T11:17:02.773

我写了这个函数。它的效率非常低，但它适用于非常大的数字。它使用我自制的算法使用类似十进制的系统将大数字存储在数组中。

mpfr2.cpp

```
#include "mpfr2.h"

void mpfr2::mpfr::setNumber(std::string a) {
    for (int i = a.length() - 1, j = 0; i >= 0; ++j, --i) {
        _a[j] = a[i] - '0';
    }
    res_size = a.length();
}

int mpfr2::mpfr::multiply(mpfr& a, mpfr b)
{
    mpfr ans = mpfr();
    // One by one multiply n with individual digits of res[] 
    int i = 0;
    for (i = 0; i < b.res_size; ++i)
    {
        for (int j = 0; j < a.res_size; ++j) {
            ans._a[i + j] += b._a[i] * a._a[j];
        }
    }
    for (i = 0; i < a.res_size + b.res_size; i++)
    {
        int tmp = ans._a[i] / 10;
        ans._a[i] = ans._a[i] % 10;
        ans._a[i + 1] = ans._a[i + 1] + tmp;
    }
    for (i = a.res_size + b.res_size; i >= 0; i--)
    {
        if (ans._a[i] > 0) break;
    }
    ans.res_size = i+1;
    a = ans;
    return a.res_size;
}

mpfr2::mpfr mpfr2::mpfr::pow(mpfr a, mpfr b) {
    mpfr t = a;
    std::string bStr = "";
    for (int i = b.res_size - 1; i >= 0; --i) {
        bStr += std::to_string(b._a[i]);
    }

    int i = 1;
    while (!0) {
        if (bStr == std::to_string(i)) break;
        a.res_size = multiply(a, t);

        // Debugging
        std::cout << "\npow() iteration " << i << std::endl;
        ++i;
    }
    return a;
} 
```

mpfr2.h

```
#pragma once
//#infdef MPFR2_H
//#define MPFR2_H
// C standard includes
#include <iostream>
#include <string>
#define MAX 0x7fffffff/32/4 // 2147483647
namespace mpfr2 {
    class mpfr
    {
    public:
        int _a[MAX];
        int res_size;
        void setNumber(std::string);
        static int multiply(mpfr&, mpfr);
        static mpfr pow(mpfr, mpfr);
    };
}
//#endif 
```

主文件

```
#include <iostream>
#include <fstream>
// Local headers
#include "mpfr2.h" // Defines local mpfr algorithm library
// Namespaces
namespace m = mpfr2;     // Reduce the typing a bit later...

m::mpfr tetration(m::mpfr, int);

int main() {
// Hardcoded tests
    int x = 7;
    std::ofstream f("out.txt");
    m::mpfr t;
    for(int b=1; b<x;b++) {
        std::cout << "2^^" << b << std::endl; // Hardcoded message
        t.setNumber("2");
        m::mpfr res = tetration(t, b);

        for (int i = res.res_size - 1; i >= 0; i--) {
            std::cout << res._a[i];
            f << res._a[i];
        }
        f << std::endl << std::endl;
        std::cout << std::endl << std::endl;
    }

    char c; std::cin.ignore(); std::cin >> c;
    return 0;
}

m::mpfr tetration(m::mpfr a, int b)
{
    m::mpfr tmp = a;
    if (b <= 0) return m::mpfr();
    for (; b > 1; b--) tmp = m::mpfr::pow(a, tmp);
    return tmp;
} 
```

我为 tetration 和最终的超操作创建了这个。当数字变得非常大时，计算可能需要很长时间和大量内存。是`#define MAX 0x7fffffff/32/4`一个数字可以有的小数位数。稍后我可能会制作另一种算法，将这些数组中的多个组合成一个数字。在我的系统上，最大数组长度是 0x7fffffff aka 2147486347 aka 2^31-1 aka int32_max （通常是标准 int 大小）所以我必须将 int32_max 除以 32 才能创建这个数组。我还将它除以 4 以减少`multiply()`函数中的内存使用。

- 朱比曼***

# python - 适用于 Python 的 Youtube API v2 客户端

> ID：12253934
> 
> 赞同：3
> 
> 时间：2012-09-03T20:56:52.000
> 
> 标签：python, youtube-api

YouTube API v1 已被[弃用](https://developers.google.com/youtube/v1_deprecation_notice)，建议切换到 v2 或更高版本。然而，Python 似乎是 v1 客户端剩下的唯一语言。PHP、Java 等获得了 v2。

1.  YT团队放弃了python客户端吗？（类似于 Facebook 如何撤回他们的 Python SDK）
2.  v2 是否还有其他 3rd 方 YT 客户端？
3.  我真的必须从头开始开发才能获得 v2 兼容性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T20:06:44.670

不幸的是，atm Python SDK 仅支持 v1，YouTube API 论坛的更多细节在[这里](https://groups.google.com/d/topic/youtube-api-gdata/EQJKi-gjxX8/discussion)

# asp.net - 如何将 SOAP::Lite 与 WCF 一起使用？

> ID：12253941
> 
> 赞同：4
> 
> 时间：2012-09-03T20:57:42.927
> 
> 标签：asp.net, .net, wcf, perl, soaplite

我只是想开始使用 WCF。听起来它应该超级简单，但是使用像 SOAP::Lite 这样的简单 API，我无法让任何东西正常工作。googlesphere 中有很多过时的例子，我尝试了很多都无济于事。所以现在我正试图将问题分解到最低水平。我创建了由 Visual Web Developer 2008 Express 模板生成的 WCF 应用程序。这是它的服务合同：

```
[ServiceContract]
public interface IService1
{

    [OperationContract]
    string GetData(int value);

    [OperationContract]
    CompositeType GetDataUsingDataContract(CompositeType composite);

    // TODO: Add your service operations here
}

// Use a data contract as illustrated in the sample below to add composite types to service operations.
[DataContract]
public class CompositeType
{
    bool boolValue = true;
    string stringValue = "Hello ";

    [DataMember]
    public bool BoolValue
    {
        get { return boolValue; }
        set { boolValue = value; }
    }

    [DataMember]
    public string StringValue
    {
        get { return stringValue; }
        set { stringValue = value; }
    }
} 
```

我以调试模式启动它并尝试联系。使用调试 url 使用浏览器这样做`http://localhost:59315/Service1.svc`会给我一个页面，上面写着：

> 您已经创建了一个服务。
> 
> 要测试此服务，您需要创建一个客户端并使用它来调用该服务。您可以使用命令行中的 svcutil.exe 工具执行此操作，语法如下：
> 
> svcutil.exe`http://localhost:59315/Service1.svc?wsdl`

所以，然后我浏览那个 wsdl 并得到这个：

```
<wsdl:definitions name="Service1" targetNamespace="http://tempuri.org/">
  <wsp:Policy wsu:Id="WSHttpBinding_IService1_policy">
    <wsp:ExactlyOne>
      <wsp:All>
        <sp:SymmetricBinding>
          <wsp:Policy>
            <sp:ProtectionToken>
              <wsp:Policy>
                <sp:SecureConversationToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
                  <wsp:Policy>
                    <sp:RequireDerivedKeys/>
                    <sp:BootstrapPolicy>
                      <wsp:Policy>
                        <sp:SignedParts>
                          <sp:Body/>
                          <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                          <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
                        </sp:SignedParts>
                        <sp:EncryptedParts>
                          <sp:Body/>
                        </sp:EncryptedParts>
                        <sp:SymmetricBinding>
                          <wsp:Policy>
                            <sp:ProtectionToken>
                              <wsp:Policy>
                                <sp:SpnegoContextToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
                                  <wsp:Policy>
                                    <sp:RequireDerivedKeys/>
                                  </wsp:Policy>
                                </sp:SpnegoContextToken>
                              </wsp:Policy>
                            </sp:ProtectionToken>
                            <sp:AlgorithmSuite>
                              <wsp:Policy>
                                <sp:Basic256/>
                              </wsp:Policy>
                            </sp:AlgorithmSuite>
                            <sp:Layout>
                              <wsp:Policy>
                                <sp:Strict/>
                              </wsp:Policy>
                            </sp:Layout>
                            <sp:IncludeTimestamp/>
                            <sp:EncryptSignature/>
                            <sp:OnlySignEntireHeadersAndBody/>
                          </wsp:Policy>
                        </sp:SymmetricBinding>
                        <sp:Wss11>
                          <wsp:Policy>
                            <sp:MustSupportRefKeyIdentifier/>
                            <sp:MustSupportRefIssuerSerial/>
                            <sp:MustSupportRefThumbprint/>
                            <sp:MustSupportRefEncryptedKey/>
                          </wsp:Policy>
                        </sp:Wss11>
                        <sp:Trust10>
                          <wsp:Policy>
                            <sp:MustSupportIssuedTokens/>
                            <sp:RequireClientEntropy/>
                            <sp:RequireServerEntropy/>
                          </wsp:Policy>
                        </sp:Trust10>
                      </wsp:Policy>
                    </sp:BootstrapPolicy>
                  </wsp:Policy>
                </sp:SecureConversationToken>
              </wsp:Policy>
            </sp:ProtectionToken>
            <sp:AlgorithmSuite>
              <wsp:Policy>
                <sp:Basic256/>
              </wsp:Policy>
            </sp:AlgorithmSuite>
            <sp:Layout>
              <wsp:Policy>
                <sp:Strict/>
              </wsp:Policy>
            </sp:Layout>
            <sp:IncludeTimestamp/>
            <sp:EncryptSignature/>
            <sp:OnlySignEntireHeadersAndBody/>
          </wsp:Policy>
        </sp:SymmetricBinding>
        <sp:Wss11>
          <wsp:Policy>
            <sp:MustSupportRefKeyIdentifier/>
            <sp:MustSupportRefIssuerSerial/>
            <sp:MustSupportRefThumbprint/>
            <sp:MustSupportRefEncryptedKey/>
          </wsp:Policy>
        </sp:Wss11>
        <sp:Trust10>
          <wsp:Policy>
            <sp:MustSupportIssuedTokens/>
            <sp:RequireClientEntropy/>
            <sp:RequireServerEntropy/>
          </wsp:Policy>
        </sp:Trust10>
        <wsaw:UsingAddressing/>
      </wsp:All>
    </wsp:ExactlyOne>
  </wsp:Policy>
  <wsp:Policy wsu:Id="WSHttpBinding_IService1_GetData_Input_policy">
    <wsp:ExactlyOne>
      <wsp:All>
        <sp:SignedParts>
          <sp:Body/>
          <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
        </sp:SignedParts>
        <sp:EncryptedParts>
          <sp:Body/>
        </sp:EncryptedParts>
      </wsp:All>
    </wsp:ExactlyOne>
  </wsp:Policy>
  <wsp:Policy wsu:Id="WSHttpBinding_IService1_GetData_output_policy">
    <wsp:ExactlyOne>
      <wsp:All>
        <sp:SignedParts>
          <sp:Body/>
          <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
        </sp:SignedParts>
        <sp:EncryptedParts>
          <sp:Body/>
        </sp:EncryptedParts>
      </wsp:All>
    </wsp:ExactlyOne>
  </wsp:Policy>
  <wsp:Policy wsu:Id="WSHttpBinding_IService1_GetDataUsingDataContract_Input_policy">
    <wsp:ExactlyOne>
      <wsp:All>
        <sp:SignedParts>
          <sp:Body/>
          <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
        </sp:SignedParts>
        <sp:EncryptedParts>
          <sp:Body/>
        </sp:EncryptedParts>
      </wsp:All>
    </wsp:ExactlyOne>
  </wsp:Policy>
  <wsp:Policy wsu:Id="WSHttpBinding_IService1_GetDataUsingDataContract_output_policy">
    <wsp:ExactlyOne>
      <wsp:All>
        <sp:SignedParts>
          <sp:Body/>
          <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
          <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
        </sp:SignedParts>
        <sp:EncryptedParts>
          <sp:Body/>
        </sp:EncryptedParts>
      </wsp:All>
    </wsp:ExactlyOne>
  </wsp:Policy>
  <wsdl:types>
    <xsd:schema targetNamespace="http://tempuri.org/Imports">
      <xsd:import schemaLocation="http://localhost:59315/Service1.svc?xsd=xsd0" namespace="http://tempuri.org/"/>
      <xsd:import schemaLocation="http://localhost:59315/Service1.svc?xsd=xsd1" namespace="http://schemas.microsoft.com/2003/10/Serialization/"/>
      <xsd:import schemaLocation="http://localhost:59315/Service1.svc?xsd=xsd2" namespace="http://schemas.datacontract.org/2004/07/RossDominosService"/>
    </xsd:schema>
  </wsdl:types>
  <wsdl:message name="IService1_GetData_InputMessage">
    <wsdl:part name="parameters" element="tns:GetData"/>
  </wsdl:message>
  <wsdl:message name="IService1_GetData_OutputMessage">
    <wsdl:part name="parameters" element="tns:GetDataResponse"/>
  </wsdl:message>
  <wsdl:message name="IService1_GetDataUsingDataContract_InputMessage">
    <wsdl:part name="parameters" element="tns:GetDataUsingDataContract"/>
  </wsdl:message>
  <wsdl:message name="IService1_GetDataUsingDataContract_OutputMessage">
    <wsdl:part name="parameters" element="tns:GetDataUsingDataContractResponse"/>
  </wsdl:message>
  <wsdl:portType name="IService1">
    <wsdl:operation name="GetData">
      <wsdl:input wsaw:Action="http://tempuri.org/IService1/GetData" message="tns:IService1_GetData_InputMessage"/>
      <wsdl:output wsaw:Action="http://tempuri.org/IService1/GetDataResponse" message="tns:IService1_GetData_OutputMessage"/>
    </wsdl:operation>
    <wsdl:operation name="GetDataUsingDataContract">
      <wsdl:input wsaw:Action="http://tempuri.org/IService1/GetDataUsingDataContract" message="tns:IService1_GetDataUsingDataContract_InputMessage"/>
      <wsdl:output wsaw:Action="http://tempuri.org/IService1/GetDataUsingDataContractResponse" message="tns:IService1_GetDataUsingDataContract_OutputMessage"/>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="WSHttpBinding_IService1" type="tns:IService1">
    <wsp:PolicyReference URI="#WSHttpBinding_IService1_policy"/>
    <soap12:binding transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="GetData">
      <soap12:operation soapAction="http://tempuri.org/IService1/GetData" style="document"/>
      <wsdl:input>
        <wsp:PolicyReference URI="#WSHttpBinding_IService1_GetData_Input_policy"/>
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output>
        <wsp:PolicyReference URI="#WSHttpBinding_IService1_GetData_output_policy"/>
        <soap12:body use="literal"/>
      </wsdl:output>
    </wsdl:operation>
    <wsdl:operation name="GetDataUsingDataContract">
      <soap12:operation soapAction="http://tempuri.org/IService1/GetDataUsingDataContract" style="document"/>
      <wsdl:input>
        <wsp:PolicyReference URI="#WSHttpBinding_IService1_GetDataUsingDataContract_Input_policy"/>
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output>
        <wsp:PolicyReference URI="#WSHttpBinding_IService1_GetDataUsingDataContract_output_policy"/>
        <soap12:body use="literal"/>
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="Service1">
    <wsdl:port name="WSHttpBinding_IService1" binding="tns:WSHttpBinding_IService1">
      <soap12:address location="http://localhost:59315/Service1.svc"/>
      <wsa10:EndpointReference>
        <wsa10:Address>http://localhost:59315/Service1.svc</wsa10:Address>
        <Identity>
          <Dns>localhost</Dns>
        </Identity>
      </wsa10:EndpointReference>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions> 
```

没什么太疯狂的（除了 SOAP 本身）......无论如何，现在我尝试一个简单的 SOAP::Lite 应用程序：

```
#!/cygdrive/C/Perl64/bin/perl.exe -w

use strict;
use warnings;

use Data::Dumper;
use SOAP::Lite +trace => [ transport => sub {
    my ($in) = @_;
    if ( ref($in) eq "HTTP::Request") {
        print( "REQUEST\n" . $in->content() . "\nEND REQUEST\n" );
    } 
    elsif ( ref($in) eq "HTTP::Response") {
        print( "RESPONSE\n" . $in->content() . "\nEND RESPONSE\n" );
    }
} ];

my $server = 'http://localhost:59315/Service1.svc';
my $url = "$server?wsdl";
my $xmlns = 'http://schemas.datacontract.org/2004/07/RossDominosService';

# Setup Network Connection
my $service = SOAP::Lite
    ->ns( $url )
    ->proxy( $server )
    ->on_fault( sub {
        my ($soap, $res) = @_;
        die ref $res ? $res->faultstring() : $soap->transport()->status(), "\n";
    } );
;

print( Dumper( $service ) );

eval {
    print( "making request\n" );
    my $response = $service->GetData( 
        SOAP::Data->new( name => 'value', value => 5 ) 
    );
    print( "got response:\n$response\n" );
};
if ( $@ ) {
    print( "failed:\n**************************\n$@\n*****************************\n" );
} 
```

调试中的哪个发出了这个 SOAP 请求：

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:namesp1="http://localhost:59315/Service1.svc?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <namesp1:GetData>
      <value xsi:type="xsd:int">5</value>
    </namesp1:GetData>
  </soap:Body>
</soap:Envelope> 
```

但响应回来了：

```
failed:
**************************
415 Unsupported Media Type

***************************** 
```

到底是怎么回事？这就是“你好，世界！” SOAP 应用程序，我想不通。

**- - - - - - - - - - - -更新 - - - - - - - - - - - - - -----**

我发现我需要将绑定从其默认值更改`wsHttpBinding`为：

```
 <endpoint address="" binding="basicHttpBinding" 
              contract="RossDominosService.IService1"> 
```

现在它似乎可以连接，但我收到了这个新错误：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <s:Fault>
      <faultcode xmlns:a="http://schemas.microsoft.com/ws/2005/05/addressing/none">a:ActionNotSupported</faultcode>
      <faultstring xml:lang="en-US">The message with Action 'http://tempuri.org/GetData' cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcher. This may be because of either a contract mismatch (mismatched Actions between sender and receiver) or a binding/security mismatch between the sender and the receiver.  Check that sender and receiver have the same contract and the same binding (including security requirements, e.g. Message, Transport, None).</faultstring>
    </s:Fault>
  </s:Body>
</s:Envelope> 
```

这似乎不应该那么难......

**- - - - - - - - - - - -更新 - - - - - - - - - - - - - -----**

知道了！在进行了一些修改并得到了[soapUI](http://www.soapui.org/)的一些帮助之后，我发现需要修改该操作，以便它是：

```
<namespace>/<serviceContract>/<method> 
```

在这种情况下：

```
http://tempuri.org/IService1/GetData 
```

使用 SOAP::Lite 时，默认的 SOAPAction 是

```
<namespace>#<method> 
```

所以你必须修改你的肥皂对象：

```
$soap->on_action( sub { sprintf( '%sIService1/%s', @_ ) } ); 
```

我将在下面写下答案，以便我们可以关闭这个问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T00:34:14.570

这就是我使用 perl SOAP::Lite 客户端启动并运行 WCF Web 服务的方法。 *请注意，我将 Visual Web Developer Express 2008 和 perl 5.14 与 SOAP::Lite 0.715 一起使用。*

1.  打开 Visual Web Developer
2.  文件 -> 新项目...
    1.  Visual C# -> 网页
    2.  WCF 服务应用程序
    3.  名称：WcfService1
    4.  地点：
    5.  解决方案：新解决方案
    6.  解决方案名称：
3.  打开 Web.config
    *   更改`<compilation debug="false">`为`<compilation debug="true">`
    *   更改`<endpoint address="" binding="wsHttpBinding" contract="WcfService1.IService1">`为`<endpoint address="" binding="basicHttpBinding" contract="WcfService1.IService1">`
4.  打开Service1.svc.cs
    *   按 f5（开始调试）

现在应该会弹出一个浏览器窗口，打开您的服务页面。记下 url 中的端口，客户端需要它。然后创建这个脚本：

```
#!/cygdrive/C/Perl64/bin/perl.exe -w

use strict;
use warnings;

use Data::Dumper;
use SOAP::Lite +trace => [ transport => sub {
    my ($in) = @_;
    if ( ref($in) eq "HTTP::Request") {
        print( "**** REQUEST ****\n" . $in->content() . "\n**** END REQUEST ****\n" );
    } 
    elsif ( ref($in) eq "HTTP::Response") {
        print( "**** RESPONSE ****\n" . $in->content() . "\n**** END RESPONSE ****\n" );
    }
} ];

my $port = 63181;
my $server = "http://localhost:$port/Service1.svc";
my $namespace = 'http://tempuri.org/';

# Setup Network Connection
my $service = SOAP::Lite
    ->ns( $namespace, 'my' )
    ->proxy( $server )
    ->on_action( sub { 
        my $action = sprintf( '%sIService1/%s', @_ );
        print( "action: '$action'\n" ); 
        return $action;
    } );

print( Dumper( $service ) );

eval {
    print( "making request\n" );
    my $response = $service->GetData( 
        SOAP::Data->new( prefix => 'my', name => 'value', value => 5 ) 
    );
    print( "got response:\n$response\n" );
};
if ( $@ ) {
    print( "failed:\n**************************\n$@\n*****************************\n" );
} 
```

您需要更改端口号以匹配您的端口号。另外，我留下了一堆调试代码，这样你就可以看到发生了什么。

我希望这对其他人有帮助。

# windows - 在 Windows 上运行 zopeskel 后缺少本地命令

> ID：12253942
> 
> 赞同：2
> 
> 时间：2012-09-03T20:57:59.063
> 
> 标签：windows, plone, paster, zopeskel

我尝试在我新安装的 plone 4.2 上使用 zopskel/paster 创建一个原型。我已调整 buildout.cfg（见下文）以在 bin 文件夹中生成 zopeskel.exe 和 paster.exe。

但是，当我按如下方式运行 zopeskel 时（在 develop-eggs 文件夹中）： ..\bin\zopeskel.exe 原型我得到一个 IOError （见下文输出）

据我了解，我现在应该在运行 paste 时使用本地命令（如添加）。但是，当我现在运行 paste（在 develop-eggs/nortek.test03 中）文件夹时，没有命令。

zopeskel 中是否有错误/缺陷或者我做错了什么？我该如何进行？

```
 Traceback (most recent call last):
  File "C:\Plone42\bin\zopeskel-script.py", line 16, in <module>
    zopeskel.zopeskel_script.run()
  File "c:\plone42\eggs\zopeskel-2.21.2-py2.6.egg\zopeskel\zopeskel_script.py", line 397, in run
    command.run( [ '-q', '-t', template_name ] + optslist )
  File "c:\plone42\eggs\pastescript-1.7.5-py2.6.egg\paste\script\command.py", line 238, in run
    result = self.command()
  File "c:\plone42\eggs\pastescript-1.7.5-py2.6.egg\paste\script\create_distro.py", line 170, in command
    egg_info_dir = pluginlib.egg_info_dir(output_dir, dist_name)
  File "c:\plone42\eggs\pastescript-1.7.5-py2.6.egg\paste\script\pluginlib.py", line 135, in egg_info_dir
    % ', '.join(all))
IOError: No egg-info directory found (looked in .\nortek.test03\.\nortek.test03.egg-info, .\nortek.test03\CHAN
GES.txt\nortek.test03.egg-info, .\nortek.test03\CONTRIBUTORS.txt\nortek.test03.egg-info, .\nortek.test03\docs\
nortek.test03.egg-info, .\nortek.test03\MANIFEST.in\nortek.test03.egg-info, .\nortek.test03\nortek\nortek.test
03.egg-info, .\nortek.test03\README.txt\nortek.test03.egg-info, .\nortek.test03\setup.cfg\nortek.test03.egg-in
fo, .\nortek.test03\setup.py\nortek.test03.egg-info) 
```

我的 buildout.cfg 与默认值相同，但以下内容除外：

```
parts =
    zeo
    instance
    run-instance
    run-zeo
    service
    service-zeo
    zopeskel

[zopeskel]
recipe = zc.recipe.egg
unzip = true
eggs =
    Paste
    PasteScript
    ZopeSkel 
```

**[编辑]** 我尝试按照提供的链接中的说明进行操作。但是有几个问题发生了： * bin 文件夹中没有生成粘贴脚本 * 我仍然得到完全相同的 IOError 问题 * 没有本地命令

我将运行的不同命令的输出放在此链接上：http: [//pastie.org/4664202](http://pastie.org/4664202)

所以请帮助我，因为我仍然有同样的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:52:49.967

请使用升级后的说明：

[http://collective-docs.readthedocs.org/en/latest/getstarted/paste.html](http://collective-docs.readthedocs.org/en/latest/getstarted/paste.html)

无论您在哪里找到这些说明，请告诉我们，我们将尝试删除错误说明。

# vb.net - 跨表单使用变量 - VB

> ID：12253944
> 
> 赞同：2
> 
> 时间：2012-09-03T20:58:33.707
> 
> 标签：vb.net, radio-button, global-variables

关于使用 Visual Basic 在表单之间传递变量，我有一个相当简单的问题（我认为）。

我有一个包含 2 个表单（Form1 和 Form2）的程序。Form1 有 3 个单选按钮，用户必须选择其中一个，然后加载 Form2。

现在我已经做到了，如果选择radiobutton1，公共变量“radio_select”将等于“radiobutton1”，如果选择radiobutton2，“radio_select”将等于“radiobutton2”。

但是每当我尝试以第二种形式调用“radio_select”时，它就会出现空白。为什么会这样？我该如何解决它。

我尝试过使用`if form1.radiobutton1.checked = true`，但我不断获得第一个单选按钮，无论我选择了哪个单选按钮。

我认为表单正在被卸载，或者那里存在问题，因为一旦初始化，似乎没有任何变量被传递给第二个表单。`Me.Hide()`另请注意，调用第二个表单时，第一个表单会被隐藏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:37:29.373

您是否考虑过进行轻微的重新设计，从而在 Form2 上创建一个名为 RadioSelect 的属性，然后在显示 Form2 之前从 Form1 设置它：

```
Class Form2
    Public Property RadioSelect As String
    ...
End Class

...

Dim f2 as new Form2()
f2.RadioSelect = "radiobutton2"

f2.Show() ' Or f2.ShowDialog() 
```

这使您远离不必要的公共变量，并且还应该确保 Form2 可以从 Form1 或调用它的任何人那里看到它需要什么。

**编辑：** 以下对我有用：

```
Public Class Form1
    Public Test As String

    Private Sub Button1_Click(sender As Object, e As System.EventArgs) Handles Button1.Click
        Test = "I'm Here"
        Me.Hide()
        Form2.ShowDialog()
    End Sub
End Class

Public Class Form2
    Private Sub Form2_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        Text = Form1.Test
    End Sub
End Class 
```

# java - 将字符串从 RadioButton android:text="@string/blue" 传递到 android 中的下一个活动

> ID：12253946
> 
> 赞同：0
> 
> 时间：2012-09-03T20:58:53.940
> 
> 标签：java, android

我有

```
<RadioGroup
    android:id="@+id/sign_up_select_colour"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"

    <RadioButton
        android:id="@+id/rdbtn_red"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/red" />

    <RadioButton
        android:id="@+id/rdbtn_blue"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/blue" />
</RadioGroup> 
```

我想以与此处使用 EditText 相同的方式将字符串*blue发送到下一个活动（在您之前的帮助下）；*

```
EditText editTextSignUpUserName = (EditText) findViewById(R.id.sign_up_user_name);
String signUpUserName = editTextSignUpUserName.getText().toString();
intent.putExtra("username", signUpUserName); 
```

我试过这个；

```
RadioButton selectedRadioButton = (RadioButton)   findViewById(R.id.sign_up_select_colour);
String signUpColour = selectedRadioButton.getCheckedRadioButtonText().toString();
intent.putExtra("colour", signUpColour); 
```

请和谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:06:52.643

好的，你快到了。但是 RadioGroup 不是 RadioButton。试试这个：

```
RadioGroup colourGroup = (RadioGroup) findViewById(R.id.sign_up_select_colour);
RadioButton button = (RadioButton) colourGroup.findViewById(colourGroup.getCheckedRadioButtonId());
String signUpColour = button.getText().toString();
intent.putExtra("gender", signUpColour); 
```

# ruby-on-rails - compass-rails gem 没有在heroku 中运行？

> ID：12253949
> 
> 赞同：4
> 
> 时间：2012-09-03T20:59:05.480
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, heroku, compass-sass

我的 gemfile 最近升级了我的 compass-rails gem。我开始收到以下错误（仅在 heroku 上生产 - 在本地工作正常），并且已经坚持了几个小时：

```
Completed 500 Internal Server Error in 14284ms
2012-09-03T20:53:25+00:00 app[web.1]: 
2012-09-03T20:53:25+00:00 app[web.1]: ActionView::Template::Error (File to import not found or unreadable: compass/css3.
2012-09-03T20:53:25+00:00 app[web.1]: Load path: Sass::Rails::Importer(/app/app/assets/stylesheets/application.css.scss) 
```

我认为部分问题必须在于 /app/app/ 出现在此处的路径中 - 但我不明白为什么。当我将下面的指南针配置更改为“资产/样式表”时，我仍然在跟踪错误中看到 /app/app/。

生产.rb：

```
 # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false 
```

指南针.rb

```
# Require any additional compass plugins here.
project_type = :rails
sass_dir = "app/assets/stylesheets" 
```

宝石文件

```
group :assets do
  gem 'sass-rails'
  gem 'coffee-rails'
  gem 'uglifier', '1.2.4'
  gem 'yui-compressor', '0.9.6'
  gem 'compass-rails'
end 
```

在我的 application.css.scss 文件中：

```
@import "compass/css3"; 
```

到目前为止，我一直在尝试所有我能找到的解决方案，但没有任何运气

有什么突出的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T23:55:57.613

是的，将指南针移出 :assets 是可行的，但不是理想的解决方案。

检查从推送到heroku的输出我发现

```
Preparing app for Rails asset pipeline
Running: rake assets:precompile
rake aborted! 
```

但它在本地编译

```
RAILS_ENV=production rake assets:precompile 
```

解决方案是在预编译资产时不实例化数据库。在 config/application.rb 中：

```
config.assets.initialize_on_precompile = false 
```

在 compass-rails 项目中查看此问题：

[https://github.com/Compass/compass-rails/issues/19](https://github.com/Compass/compass-rails/issues/19)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T03:41:41.763

我将我的 rails 升级到 3.2+ 并最终将 compass-rails 移出资产组以使其正常工作。我真的不明白为什么它会起作用，但它似乎起到了作用。

# c# - 如何从 Linq 中的查询中获取特定值

> ID：12253951
> 
> 赞同：0
> 
> 时间：2012-09-03T20:59:22.567
> 
> 标签：c#, sql, linq

我刚开始学习Linq。我写了一些例子，但有一个疑问我无法解决。

我正在使用`Northwind`数据库，我只是使用调用的工具`SqlMetal`来进行所有建模。

现在我刚刚写了以下查询：

```
var q = from c in db.Customers
        from o in c.Orders
        where c.City == "London"
        select new { c, o }; 
```

我知道这个查询给我带来了一组结果数据，其中包含给定条件 ( )的所有列`Customers`和表。但我的问题是：`Orders``c.City == "London"`

执行该查询后，**如何获取列的值`Customers.CustomerID`和`Orders.OrderID`FROM THE VARIABLE `q`？**

也许这是一个愚蠢的问题，但我已经为此苦苦挣扎了几个小时，在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:02:53.863

```
var theSoleItem = q.First();
theSoleItem.CustomerID
theSoleItem.OrderID 
```

此外，如果这是您关心的唯一列，那么您的初始查询会更快：

```
select new {c.CustomerID, o.OrderID} 
```

您还可以随时更改名称：

```
select new {CustID = c.CustomerID, OrdID = o.OrderID} 
```

如果不是直接引用属性，而是引用方法调用，则后者是唯一的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T21:07:24.937

变量 q 现在是一个匿名对象序列，其中包含两个对象：Customer 和 Order。您可以轻松地对其进行迭代：

```
foreach(var item in q)
{
    Console.WriteLine("CustomerID = " + item.CustomerID + " order ID = " + item.OrderID);
} 
```

# java - Android View Canvas onDraw 未执行

> ID：12253952
> 
> 赞同：3
> 
> 时间：2012-09-03T20:59:32.363
> 
> 标签：java, android, view, android-canvas, invalidation

我目前正在开发一个在画布上绘制一些图块的自定义视图。这些图块是从多个文件中加载的，并会在需要时加载。

它们将由 AsyncTask 加载。如果它们已经加载，它们只会被绘制在画布上。**这工作正常！**

如果加载了这些图片，则 AsyncTask 正在触发**view.postInvalidate()** 问题是我的自定义视图在每次触发 view.postInvalidate() 时**都不会触发onDraw(Canvas canvas)。**

view.postInvalidate仅**在第一次加载图片****时**触发 onDraw() 方法，然后仅当我在 CustomView 内的 onTouchEvent 中触发 this.invalidate() 时

 **视图是否有可能决定它是否会再次绘制画布？有没有办法**强制**视图重绘？我认为 invalidate 方法告诉 View 如果 View 考虑重绘会很酷-.-

这些无效方法是否有可能有限制？

我希望你们中的任何人都对这个问题有更多的了解。

**编辑：**

我只是将**每个 postInvalidate()**更改为**invalidate()**因为图像都是由从主线程执行的 AsyncTask 加载的但是仍然存在执行的**invalidate()**没有执行**onDraw()**方法的问题。我发现**view.invalidate()**是通过覆盖原始方法触发的：

```
@Override
public void invalidate() {
    super.invalidate();
    Log.d(TAG, "invalidate executed");
} 
```

我不知道现在该怎么办。我正在触发 view.invalidate() 和 view.postInvalidate() 但绝对没有任何组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:33:01.217

这里有点误会。invalidate 和 postInvalidate 方法用于告诉 View 在最早的绘制周期内需要刷新和重绘。不同之处在于 invalidate 方法应该从 UI 线程内调用，而 postInvalidate 应该从 UI 线程外调用。

这些方法在这里简要描述：

*   [http://developer.android.com/reference/android/view/View.html#postInvalidate()](http://developer.android.com/reference/android/view/View.html#postInvalidate())
*   [http://developer.android.com/reference/android/view/View.html#invalidate()](http://developer.android.com/reference/android/view/View.html#invalidate())

另一方面， AsyncTask 是专门针对您面临的问题而设计的类[。](http://developer.android.com/reference/android/os/AsyncTask.html)当您需要在后台执行一项大任务时，您需要异步执行 AsyncTask，但是！AsyncTask 的回调方法是在 UIThread 中运行的！

看看这里对 AsyncTask 方法的解释：

当一个异步任务被执行时，任务会经过 4 个步骤：

> 1.  onPreExecute()，在任务执行后立即在 UI 线程上调用。此步骤通常用于设置任务，例如通过在用户界面中显示进度条。
>     
>     
> 2.  doInBackground(Params...)，在 onPreExecute() 完成执行后立即在后台线程上调用。此步骤用于执行可能需要很长时间的后台计算。异步任务的参数传递到这一步。计算的结果必须由这一步返回，并将传递回最后一步。此步骤还可以使用 publishProgress(Progress...) 来发布一个或多个进度单位。这些值在 UI 线程上的 onProgressUpdate(Progress...) 步骤中发布。
>     
>     
> 3.  onProgressUpdate(Progress...)，在调用 publishProgress(Progress...) 后在 UI 线程上调用。执行的时间是不确定的。此方法用于在后台计算仍在执行时在用户界面中显示任何形式的进度。例如，它可用于动画进度条或在文本字段中显示日志。
>     
>     
> 4.  onPostExecute(Result)，在后台计算完成后在 UI 线程上调用。后台计算的结果作为参数传递给该步骤。

这意味着在 onPostExecute 方法中，您应该尝试使用 invalidate 方法而不是从 UIThread 调用的 postInvalidate 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-04T16:04:09.027

你听说过调用 setWillNotDraw(boolean) 的方法吗？

[在这里](http://developer.android.com/reference/android/view/View.html#setWillNotDraw(boolean))查看

将其设置为false，您会看到

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-02T11:56:37.960

我已经解决了请求`view.invalidate()`或`view.postInvalidate()`不单独使每个子视图无效的问题（这些子视图中的每一个都包含自己的 AsyncTask），而是使它们的共同父 ViewGroup 无效。

现在详细介绍。我有

```
public class mViewGroup extends RelativeLayout {...} 
```

以及里面的几个View，每个View如下：

```
public class mView extends View {

private mViewGroup mContext = null;

//with a little bit modified standard constructors:
public mView (Context context, mViewGroup ParentViewGroup) {
        super(context);
        mContext = ParentViewGroup;
}

//and also with an AsyncTask:
private class mViewAsyncTask extends AsyncTask<Integer, Void, Void> {
public mAsyncTask() {
   @Override
   protected Void doInBackground(Integer... a) {
       //which does its work and sometimes publishes progress:
       publishProgress();
       return null;
   }

   protected void onProgressUpdate(Void... progress) {
       invalidate();
   }

} 
```

调用`invalidate();`有时有效，有时无效（如果调用是`AsyncTask`从属于不同s 的不同`mView`s 但在非常接近的时刻进行的）。

改变

```
invalidate(); //i.e. invalidating individual View 
```

至

`mContext.invalidate(); //i.e. invalidating the whole ViewGroup`

解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T13:13:38.040

只是为了将来和可能的谷歌搜索者保存这个；）

我创建了一个新类，为我的视图提供数据。此类扩展 Thread 并在后台运行。它检查我的视图必须显示哪些图块。

长话短说：每次必须显示新图块时，我的提供程序类都会收集一些更新请求。如果“收集”了 3 个或更多更新请求，或者距离第一个更新请求超过 1 秒，则视图将获取 view.postInvalidate()。

问题是，如果您一次触发其中几个请求，视图会忽略一些无效请求。如果您收集这些无效请求并仅使用一个 invalidate() 触发其中几个请求，则只需一小段时间即可看到最新信息 - 但您可以看到它；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-10T04:44:37.877

就我而言，目标自定义视图当时具有 height = 0 属性。（我的错误）并且 postInvalidate() 和 invalidate 也没有触发 onDraw() 和 Log。

当我正确地改变高度时，所有问题都解决了。**

# php - 将变量限制为仅显示 50 个字符

> ID：12253953
> 
> 赞同：1
> 
> 时间：2012-09-03T20:59:38.747
> 
> 标签：php, html

如何将下面的锚文本限制为仅显示 50 个字符？

```
echo '<td style="" class="pointlink"><span class="pointlink"><a href="http://'.$rowad["1site"].'">'.$rowad["1site"].'</a></td>'; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T21:02:55.857

[`substr`](http://php.net/substr)

或者，您可以使用 CSS：

```
.pointlink {
    width: 150px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
} 
```

根据需要调整宽度，将自动使用省略号将文本截断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T21:01:34.547

您可以使用该[`substr`](http://php.net/manual/en/function.substr.php)功能将文本减少到 50 个字符

```
function cut_text( $text, $len ) {
    return strlen( $text ) > $len ?
        substr( $text, 0, $len ) + '...' :
        $text;
}
echo '<td style="" class="pointlink"><span class="pointlink"><a href="http://'.$rowad["1site"].'">' . cut_text( $rowad["1site"], 50 ) . '</a></td>'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T21:02:13.233

你可以使用`substr`函数，比如

`echo '<td style="" class="pointlink"><span class="pointlink"><a href="http://'.$rowad["1site"].'">'.substr($rowad["1site"],0,50).'</a></td>';`

# mysql - 使用 EXISTS 插入 MySQL 5.x

> ID：12253960
> 
> 赞同：1
> 
> 时间：2012-09-03T21:00:22.940
> 
> 标签：mysql, insert

这个问题已经被问过很多次了，但我还是很困惑。如果列中尚不存在值，我要做的就是运行插入语句。请注意，此列中的值不构成主键，因此`replace`or`update`方法不起作用。

`word_id (PK, auto-complete) | word | timestamp (autocomplete)`
`1--sinecure--25th March`
`2--demotic--3rd April`
`3--atavism--5th May`

在向此表添加另一个单词之前，我首先要检查它是否已经存在。考虑到这一点，这个例子应该保持表格不变。

`INSERT INTO word_table(word) VALUES "sinecure"`
`WHERE NOT EXISTS (SELECT word FROM word_table WHERE word LIKE "sinecure")`

当然，这个查询之后表没有变化，只是因为它抛出了一个错误。这不是我尝试过的唯一语法，但它是我看过的各种论坛/教程中最常提倡的语法。我也尝试过各种技巧，例如使用变量来存储 EXISTS 语句产生的 bool 值，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:11:14.340

如果我没记错的话，您不能对要更新的表进行嵌套查询。您可以做的是运行选择，如果没有得到任何结果，请插入数据。

否则，您可能已经在该`word`列上有一个索引。使该索引唯一，您的问题将得到解决，因为如果该词已经存在，数据库将返回错误。这个词不会是你的主键，但它实际上是一个备用（唯一）键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T21:19:07.840

你可以使用这个：

```
INSERT INTO word_table (word) 
SELECT 'sinecure'
FROM dual
WHERE NOT EXISTS (SELECT word FROM word_table WHERE word LIKE 'sinecure') ; 
```

如果始终需要这种行为而不是偶尔需要，请`word`按照其他人的建议在列上添加唯一约束。那么你可以使用一个简单的插入，如果这个词是重复的，它会抛出一个错误：

```
INSERT INTO word_table (word) 
VALUES ('sinecure') ; 
```

或`INSERT IGNORE`将忽略错误：

```
INSERT IGNORE INTO word_table (word) 
VALUES ('sinecure') ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T21:16:04.020

字段词应该有一个唯一的键约束。只需创建索引，您就会拥有它。

# mysql - 如何优先考虑某些查询？

> ID：12253963
> 
> 赞同：8
> 
> 时间：2012-09-03T21:00:43.213
> 
> 标签：mysql, locking, thread-priority

在某些情况下，当几个后端进程碰巧同时运行时（队列管理是另外一回事，我可以这样解决，但这不是这里的问题），我得到`General error: 1205 Lock wait timeout exceeded; try restarting transaction ROLLING BACK`

优先级较低的进程是锁定表的进程，因为它比高优先级的进程早几分钟启动。

**如何将查询优先于已运行的进程？**

希望它足够清楚。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T21:22:01.097

一旦查询开始执行，就不能暂停/中断。唯一的例外是在数据库管理级别，您基本上可以强制停止查询（如果您愿意，可以将其视为杀死 Windows 中正在运行的进程）。但是，您不想这样做，所以忘记它。

您最好的选择是使用 LOW PRIORITY 分块操作。基本上，这意味着如果 LOW PRIORITY 上的查询执行时间过长，请考虑如何将其拆分得更快，而不会在数据库中创建孤立数据或非法数据。

一个非常基本的用例是想象一个插入 10,000 个新行的插入。通过“分块”插入，以便它使用较小的数据集（即一次 500 个）多次运行插入，每个将更快地完成，因此允许以更及时的方式执行任何非低优先级操作.

**如何**

将某些东西设置为低优先级就像添加 LOW_PRIORITY 标志一样简单。

`INSERT LOW_PRIORITY INTO xxx(a,b,c,) VALUES()`

`UPDATE LOW_PRIORITY xxx SET a=b`

`DELETE LOW_PRIORITY FROM xxx WHERE a="value"`

# android - Gmail 三段动画场景的完整工作示例？

> ID：12253965
> 
> 赞同：130
> 
> 时间：2012-09-03T21:00:51.520
> 
> 标签：android, android-fragments, android-animation

TL;DR：我正在寻找我称之为“Gmail 三片段动画”场景的**完整工作示例。**具体来说，我们希望从两个片段开始，如下所示：

![两个片段](../Images/e46807d0c17e8f0bbeb6987c1387be69.png)

对于一些 UI 事件（例如，点击片段 B 中的某些内容），我们希望：

*   片段 A 从屏幕向左滑出
*   Fragment B 滑动到屏幕的左边缘并缩小以占据 Fragment A 腾出的位置
*   片段 C 从屏幕右侧滑入并占据片段 B 腾出的位置

而且，在按下 BACK 按钮时，我们希望反转这组操作。

现在，我已经看到了很多部分实现；我将在下面回顾其中的四个。除了不完整之外，它们都有自己的问题。

* * *

@Reto Meier 为同一个基本问题提供了[这个流行的答案](https://stackoverflow.com/a/4819665/115145)，表明您将`setCustomAnimations()`使用`FragmentTransaction`. 对于两个片段的场景（例如，您最初只看到片段 A，并希望将其替换为使用动画效果的新片段 B），我完全同意。然而：

*   由于您只能指定一个“进”和一个“出”动画，我看不出您将如何处理三片段场景所需的所有不同动画
*   在`<objectAnimator>`他的示例代码中使用以像素为单位的硬连线位置，考虑到不同的屏幕尺寸，这似乎不切实际，但`setCustomAnimations()`需要动画资源，排除了在 Java 中定义这些东西的可能性
*   我不知道缩放的对象动画师如何与按百分比分配空间之类`android:layout_weight`的事情联系起来`LinearLayout`
*   我不知道一开始是如何处理片段 C 的（`GONE`？`android:layout_weight`的`0`？预先动画到 0 的比例？还有别的吗？）

* * *

@Roman Nurik 指出[您可以为任何属性设置动画](https://stackoverflow.com/a/4936159/115145)，包括您自己定义的属性。这可以帮助解决硬连线位置的问题，代价是发明您自己的自定义布局管理器子类。这对一些人有帮助，但我仍然对 Reto 的其他解决方案感到困惑。

* * *

[这个 pastebin 条目](http://pastebin.com/gh2eDkFS)的作者展示了一些诱人的伪代码，基本上说所有三个片段最初都将驻留在容器中，片段 C 一开始通过`hide()`事务操作隐藏。然后我们在`show()`C 和`hide()`A 发生 UI 事件时。但是，我看不出它如何处理 B 改变大小的事实。它还依赖于您显然可以将多个片段添加到同一个容器的事实，我不确定从长远来看这是否是可靠的行为（更不用说它应该 break `findFragmentById()`，尽管我可以忍受）。

* * *

[这篇博](http://android.amberfog.com/?p=758)文的作者表示，Gmail 根本没有使用`setCustomAnimations()`，而是直接使用对象动画器（“你只需更改根视图的左边距 + 更改右视图的宽度”）。然而，这仍然是一个两片段解决方案 AFAICT，并且再次显示的实现以像素为单位硬线尺寸。

* * *

我将继续解决这个问题，所以有一天我可能会自己回答这个问题，但我真的希望有人已经为这个动画场景制定了三片段解决方案并可以发布代码（或链接）。Android 中的动画让我想把头发拔掉，而那些看过我的人都知道，这在很大程度上是徒劳的。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-09-07T00:38:30.787

[在github 上](https://github.com/weakwire/3PaneLayout)上传了我的建议 （正在使用所有 android 版本，尽管强烈建议对此类动画使用视图硬件加速。对于非硬件加速设备，位图缓存实现应该更适合）

带有动画的演示视频在[这里](http://www.youtube.com/watch?v=5lZuyY6DFXQ)（屏幕投射的帧速率慢。实际性能非常快）

* * *

**用法：**

```
layout = new ThreeLayout(this, 3);
layout.setAnimationDuration(1000);
setContentView(layout);
layout.getLeftView();   //<---inflate FragmentA here
layout.getMiddleView(); //<---inflate FragmentB here
layout.getRightView();  //<---inflate FragmentC here

//Left Animation set
layout.startLeftAnimation();

//Right Animation set
layout.startRightAnimation();

//You can even set interpolators 
```

* * *

**说明**：

创建了一个新的自定义**RelativeLayout(ThreeLayout)**和 2 个自定义动画(MyScalAnimation, MyTranslateAnimation)

`ThreeLayout`假设其他可见视图具有，将左窗格的权重作为参数`weight=1`。

因此，`new ThreeLayout(context,3)`创建一个包含 3 个子项的新视图，左窗格占总屏幕的 1/3。另一个视图占据了所有可用空间。

> 它在运行时计算宽度，一个更安全的实现是在draw()中第一次计算尺寸。而不是在 post()

缩放和平移动画实际上会调整视图大小和移动视图，而不是伪 [scale,move]。请注意，`fillAfter(true)`它不在任何地方使用。

View2 是 View1 的 right_of

和

View3 是 View2 的 right_of

设置这些规则之后，RelativeLayout 会处理其他所有事情。动画改变`margins`（移动）和`[width,height]`规模

要访问每个孩子（这样你就可以用你的 Fragment 给它充气，你可以打电话

```
public FrameLayout getLeftLayout() {}

public FrameLayout getMiddleLayout() {}

public FrameLayout getRightLayout() {} 
```

下面展示了2个动画

* * *

阶段1

> ---IN 屏幕----------！-----OUT----
> 
> [查看1][_____查看2____][_____查看3_____]

第二阶段

> --OUT-!--------IN 屏幕------
> 
> [查看1][查看2][_____查看3____]

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-09-07T12:45:52.943

好的，这是我自己的解决方案，根据@Christopher 在问题评论中的建议，源自电子邮件 AOSP 应用程序。

[https://github.com/commonsguy/cw-omnibus/tree/master/Animation/ThreePane](https://github.com/commonsguy/cw-omnibus/tree/master/Animation/ThreePane)

@weakwire 的解决方案让我想起了我，尽管他使用的是经典`Animation`而不是动画师，并且他使用`RelativeLayout`规则来强制定位。从赏金的角度来看，他可能会得到赏金，除非其他人有更巧妙的解决方案但发布了答案。

* * *

简而言之，该`ThreePaneLayout`项目中的 是一个`LinearLayout`子类，旨在与三个孩子一起在景观中工作。这些孩子的宽度可以通过任何所需的方式在布局 XML 中设置——我使用权重显示，但您可以通过维度资源或其他方式设置特定的宽度。第三个孩子——问题中的片段 C——的宽度应该为零。

```
package com.commonsware.android.anim.threepane;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.animation.ObjectAnimator;
import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.widget.LinearLayout;

public class ThreePaneLayout extends LinearLayout {
  private static final int ANIM_DURATION=500;
  private View left=null;
  private View middle=null;
  private View right=null;
  private int leftWidth=-1;
  private int middleWidthNormal=-1;

  public ThreePaneLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
    initSelf();
  }

  void initSelf() {
    setOrientation(HORIZONTAL);
  }

  @Override
  public void onFinishInflate() {
    super.onFinishInflate();

    left=getChildAt(0);
    middle=getChildAt(1);
    right=getChildAt(2);
  }

  public View getLeftView() {
    return(left);
  }

  public View getMiddleView() {
    return(middle);
  }

  public View getRightView() {
    return(right);
  }

  public void hideLeft() {
    if (leftWidth == -1) {
      leftWidth=left.getWidth();
      middleWidthNormal=middle.getWidth();
      resetWidget(left, leftWidth);
      resetWidget(middle, middleWidthNormal);
      resetWidget(right, middleWidthNormal);
      requestLayout();
    }

    translateWidgets(-1 * leftWidth, left, middle, right);

    ObjectAnimator.ofInt(this, "middleWidth", middleWidthNormal,
                         leftWidth).setDuration(ANIM_DURATION).start();
  }

  public void showLeft() {
    translateWidgets(leftWidth, left, middle, right);

    ObjectAnimator.ofInt(this, "middleWidth", leftWidth,
                         middleWidthNormal).setDuration(ANIM_DURATION)
                  .start();
  }

  public void setMiddleWidth(int value) {
    middle.getLayoutParams().width=value;
    requestLayout();
  }

  private void translateWidgets(int deltaX, View... views) {
    for (final View v : views) {
      v.setLayerType(View.LAYER_TYPE_HARDWARE, null);

      v.animate().translationXBy(deltaX).setDuration(ANIM_DURATION)
       .setListener(new AnimatorListenerAdapter() {
         @Override
         public void onAnimationEnd(Animator animation) {
           v.setLayerType(View.LAYER_TYPE_NONE, null);
         }
       });
    }
  }

  private void resetWidget(View v, int width) {
    LinearLayout.LayoutParams p=
        (LinearLayout.LayoutParams)v.getLayoutParams();

    p.width=width;
    p.weight=0;
  }
} 
```

但是，在运行时，无论您最初如何设置宽度，宽度管理都会在`ThreePaneLayout`您第一次用于`hideLeft()`从显示问题称为片段 A 和 B 切换到片段 B 和 C 时接管。`ThreePaneLayout`- 与片段没有特定联系 - 这三个部分是`left`,`middle`和`right`. 在您致电 时`hideLeft()`，我们会记录这三者中使用的任何权重的大小`left`并将其归零，因此我们可以完全控制大小。`middle`在 的时间点`hideLeft()`，我们将 的大小设置`right`为 的原始大小`middle`。

动画分为两部分：

*   使用 a`ViewPropertyAnimator`将三个小部件向左平移 的宽度`left`，使用硬件层
*   `ObjectAnimator`在自定义伪属性上使用a`middleWidth`将`middle`宽度从它开始的任何位置更改为原始宽度`left`

（可能对所有这些都使用`AnimatorSet`and是一个更好的主意`ObjectAnimators`，尽管这目前有效）

（也有可能`middleWidth` `ObjectAnimator`否定硬件层的值，因为这需要相当连续的失效）

（*绝对*有可能我对动画的理解仍然存在差距，而且我喜欢括号内的陈述）

最终效果是`left`滑出屏幕，`middle`滑到 的原始位置和大小`left`，并`right`在 的正后方平移`middle`。

`showLeft()`只需反转过程，使用相同的动画师组合，只是方向相反。

该活动使用 a`ThreePaneLayout`来保存一对`ListFragment`小部件和一个`Button`. 选择左侧片段中的某些内容会添加（或更新）中间片段的内容。选择中间片段中的内容设置 的标题`Button`，并`hideLeft()`在`ThreePaneLayout`. 按 BACK，如果我们隐藏左侧，将执行`showLeft()`；否则，BACK 退出活动。由于这不`FragmentTransactions`用于影响动画，我们被困在自己管理那个“回栈”中。

上面链接到的项目使用原生片段和原生动画框架。我有另一个版本的同一项目，它使用 Android 支持片段 backport 和[NineOldAndroids](http://nineoldandroids.com/)动画：

[https://github.com/commonsguy/cw-omnibus/tree/master/Animation/ThreePaneBC](https://github.com/commonsguy/cw-omnibus/tree/master/Animation/ThreePaneBC)

backport 在第一代 Kindle Fire 上运行良好，但由于硬件规格较低且缺乏硬件加速支持，动画有点生涩。在 Nexus 7 和其他当代平板电脑上，这两种实现似乎都很顺利。

我当然愿意接受有关如何改进此解决方案的想法，或者其他与我在这里所做的（或@weakwire 使用的）相比具有明显优势的解决方案。

再次感谢所有做出贡献的人！

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-02-19T16:51:07.507

我们构建了一个名为 PanesLibrary 的库来解决这个问题。它比以前提供的更灵活，因为：

*   每个窗格都可以动态调整大小
*   它允许任意数量的窗格（不仅仅是 2 个或 3 个）
*   窗格内的片段在方向更改时正确保留。

你可以在这里查看：[https ://github.com/Mapsaurus/Android-PanesLibrary](https://github.com/Mapsaurus/Android-PanesLibrary)

这是一个演示：[http ://www.youtube.com/watch?v=UA-lAGVXoLU&feature=youtu.be](http://www.youtube.com/watch?v=UA-lAGVXoLU&feature=youtu.be)

它基本上允许您轻松添加任意数量的动态大小的窗格并将片段附加到这些窗格。希望你觉得它有用！:)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-06T15:44:01.687

基于您链接到的示例之一 ( [http://android.amberfog.com/?p=758](http://android.amberfog.com/?p=758) )，如何为`layout_weight`属性设置动画？这样，您可以将 3 个片段的重量变化动画在一起，并且您会获得它们都很好地滑动在一起的奖励：

从简单的布局开始。由于我们要制作动画`layout_weight`，我们需要一个`LinearLayout`作为 3 个面板的根视图：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/container"
android:orientation="horizontal"
android:layout_width="match_parent"
android:layout_height="match_parent">

<LinearLayout
    android:id="@+id/panel1"
    android:layout_width="0dip"
    android:layout_weight="1"
    android:layout_height="match_parent"/>

<LinearLayout
    android:id="@+id/panel2"
    android:layout_width="0dip"
    android:layout_weight="2"
    android:layout_height="match_parent"/>

<LinearLayout
    android:id="@+id/panel3"
    android:layout_width="0dip"
    android:layout_weight="0"
    android:layout_height="match_parent"/>
</LinearLayout> 
```

然后是演示类：

```
public class DemoActivity extends Activity implements View.OnClickListener {
    public static final int ANIM_DURATION = 500;
    private static final Interpolator interpolator = new DecelerateInterpolator();

    boolean isCollapsed = false;

    private Fragment frag1, frag2, frag3;
    private ViewGroup panel1, panel2, panel3;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        panel1 = (ViewGroup) findViewById(R.id.panel1);
        panel2 = (ViewGroup) findViewById(R.id.panel2);
        panel3 = (ViewGroup) findViewById(R.id.panel3);

        frag1 = new ColorFrag(Color.BLUE);
        frag2 = new InfoFrag();
        frag3 = new ColorFrag(Color.RED);

        final FragmentManager fm = getFragmentManager();
        final FragmentTransaction trans = fm.beginTransaction();

        trans.replace(R.id.panel1, frag1);
        trans.replace(R.id.panel2, frag2);
        trans.replace(R.id.panel3, frag3);

        trans.commit();
    }

    @Override
    public void onClick(View view) {
        toggleCollapseState();
    }

    private void toggleCollapseState() {
        //Most of the magic here can be attributed to: http://android.amberfog.com/?p=758

        if (isCollapsed) {
            PropertyValuesHolder[] arrayOfPropertyValuesHolder = new PropertyValuesHolder[3];
            arrayOfPropertyValuesHolder[0] = PropertyValuesHolder.ofFloat("Panel1Weight", 0.0f, 1.0f);
            arrayOfPropertyValuesHolder[1] = PropertyValuesHolder.ofFloat("Panel2Weight", 1.0f, 2.0f);
            arrayOfPropertyValuesHolder[2] = PropertyValuesHolder.ofFloat("Panel3Weight", 2.0f, 0.0f);
            ObjectAnimator localObjectAnimator = ObjectAnimator.ofPropertyValuesHolder(this, arrayOfPropertyValuesHolder).setDuration(ANIM_DURATION);
            localObjectAnimator.setInterpolator(interpolator);
            localObjectAnimator.start();
        } else {
            PropertyValuesHolder[] arrayOfPropertyValuesHolder = new PropertyValuesHolder[3];
            arrayOfPropertyValuesHolder[0] = PropertyValuesHolder.ofFloat("Panel1Weight", 1.0f, 0.0f);
            arrayOfPropertyValuesHolder[1] = PropertyValuesHolder.ofFloat("Panel2Weight", 2.0f, 1.0f);
            arrayOfPropertyValuesHolder[2] = PropertyValuesHolder.ofFloat("Panel3Weight", 0.0f, 2.0f);
            ObjectAnimator localObjectAnimator = ObjectAnimator.ofPropertyValuesHolder(this, arrayOfPropertyValuesHolder).setDuration(ANIM_DURATION);
            localObjectAnimator.setInterpolator(interpolator);
            localObjectAnimator.start();
        }
        isCollapsed = !isCollapsed;
    }

    @Override
    public void onBackPressed() {
        //TODO: Very basic stack handling. Would probably want to do something relating to fragments here..
        if(isCollapsed) {
            toggleCollapseState();
        } else {
            super.onBackPressed();
        }
    }

    /*
     * Our magic getters/setters below!
     */

    public float getPanel1Weight() {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams)     panel1.getLayoutParams();
        return params.weight;
    }

    public void setPanel1Weight(float newWeight) {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) panel1.getLayoutParams();
        params.weight = newWeight;
        panel1.setLayoutParams(params);
    }

    public float getPanel2Weight() {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) panel2.getLayoutParams();
        return params.weight;
    }

    public void setPanel2Weight(float newWeight) {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) panel2.getLayoutParams();
        params.weight = newWeight;
        panel2.setLayoutParams(params);
    }

    public float getPanel3Weight() {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) panel3.getLayoutParams();
        return params.weight;
    }

    public void setPanel3Weight(float newWeight) {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) panel3.getLayoutParams();
        params.weight = newWeight;
        panel3.setLayoutParams(params);
    }

    /**
     * Crappy fragment which displays a toggle button
     */
    public static class InfoFrag extends Fragment {
        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle     savedInstanceState) {
            LinearLayout layout = new LinearLayout(getActivity());
            layout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
            layout.setBackgroundColor(Color.DKGRAY);

            Button b = new Button(getActivity());
            b.setOnClickListener((DemoActivity) getActivity());
            b.setText("Toggle Me!");

            layout.addView(b);

            return layout;
        }
    }

    /**
     * Crappy fragment which just fills the screen with a color
     */
    public static class ColorFrag extends Fragment {
        private int mColor;

        public ColorFrag() {
            mColor = Color.BLUE; //Default
        }

        public ColorFrag(int color) {
            mColor = color;
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
            FrameLayout layout = new FrameLayout(getActivity());
            layout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));

            layout.setBackgroundColor(mColor);
            return layout;
        }
    }
} 
```

此外，此示例不使用 FragmentTransactions 来实现动画（相反，它为片段附加到的视图设置动画），因此您需要自己完成所有 backstack/fragment 事务，但与让动画工作的努力相比很好，这似乎不是一个糟糕的权衡:)

可怕的低分辨率视频：http: [//youtu.be/Zm517j3bFCo](http://youtu.be/Zm517j3bFCo)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-09-06T15:26:52.787

这不是使用片段......这是一个有 3 个孩子的自定义布局。当你点击一条消息时，你抵消了 3 个孩子的使用`offsetLeftAndRight()`和一个动画师。

您可以在`JellyBean`“开发人员选项”设置中启用“显示布局边界”。幻灯片动画完成后，您仍然可以看到左侧菜单仍然存在，但位于中间面板下方。

它类似于[Cyril Mottier 的 Fly-in 应用程序菜单](http://android.cyrilmottier.com/?p=658)，但有 3 个元素而不是 2 个。

此外，`ViewPager`第三个孩子的 是这种行为的另一个迹象：`ViewPager`通常使用片段（我知道他们不必这样做，但我从未见过其他的实现`Fragment`），并且由于您不能`Fragments`在另一个内部使用`Fragment`3 个孩子可能不是碎片....

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-06T19:25:47.963

我目前正在尝试做类似的事情，除了 Fragment B 缩放以占用可用空间并且如果有足够的空间可以同时打开 3 窗格。到目前为止，这是我的解决方案，但我不确定我是否会坚持下去。我希望有人会提供一个显示正确方式的答案。

我没有使用 LinearLayout 并为权重设置动画，而是使用 RelativeLayout 并为边距设置动画。我不确定这是不是最好的方法，因为它需要在每次更新时调用 requestLayout()。不过在我所有的设备上都很流畅。

所以，我为布局设置动画，我没有使用片段事务。如果片段 C 打开，我手动处理后退按钮以关闭片段 C。

FragmentB 使用 layout_toLeftOf/ToRightOf 保持它与片段 A 和 C 对齐。

当我的应用程序触发显示片段 C 的事件时，我同时滑入片段 C 和滑出片段 A。（2个单独的动画）。相反，当片段 A 打开时，我同时关闭 C。

在纵向模式或较小的屏幕上，我使用稍微不同的布局并在屏幕上滑动片段 C。

要将百分比用于片段 A 和 C 的宽度，我认为您必须在运行时计算它...（？）

这是活动的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rootpane"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <!-- FRAGMENT A -->
    <fragment
        android:id="@+id/fragment_A"
        android:layout_width="300dp"
        android:layout_height="fill_parent"
        class="com.xyz.fragA" />

    <!-- FRAGMENT C -->
    <fragment
        android:id="@+id/fragment_C"
        android:layout_width="600dp"
        android:layout_height="match_parent"
        android:layout_alignParentRight="true"
        class="com.xyz.fragC"/>

    <!-- FRAGMENT B -->
    <fragment
        android:id="@+id/fragment_B"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_marginLeft="0dip"
        android:layout_marginRight="0dip"
        android:layout_toLeftOf="@id/fragment_C"
        android:layout_toRightOf="@id/fragment_A"
        class="com.xyz.fragB" />

</RelativeLayout> 
```

将 FragmentC 滑入或滑出的动画：

```
private ValueAnimator createFragmentCAnimation(final View fragmentCRootView, boolean slideIn) {

    ValueAnimator anim = null;

    final RelativeLayout.LayoutParams lp = (RelativeLayout.LayoutParams) fragmentCRootView.getLayoutParams();
    if (slideIn) {
        // set the rightMargin so the view is just outside the right edge of the screen.
        lp.rightMargin = -(lp.width);
        // the view's visibility was GONE, make it VISIBLE
        fragmentCRootView.setVisibility(View.VISIBLE);
        anim = ValueAnimator.ofInt(lp.rightMargin, 0);
    } else
        // slide out: animate rightMargin until the view is outside the screen
        anim = ValueAnimator.ofInt(0, -(lp.width));

    anim.setInterpolator(new DecelerateInterpolator(5));
    anim.setDuration(300);
    anim.addUpdateListener(new AnimatorUpdateListener() {

        @Override
        public void onAnimationUpdate(ValueAnimator animation) {
            Integer rightMargin = (Integer) animation.getAnimatedValue();
            lp.rightMargin = rightMargin;
            fragmentCRootView.requestLayout();
        }
    });

    if (!slideIn) {
        // if the view was sliding out, set visibility to GONE once the animation is done
        anim.addListener(new AnimatorListenerAdapter() {

            @Override
            public void onAnimationEnd(Animator animation) {
                fragmentCRootView.setVisibility(View.GONE);
            }
        });
    }
    return anim;
} 
```

# ruby-on-rails - thumbs_up 中的 vote_up 进入空白页

> ID：12253971
> 
> 赞同：0
> 
> 时间：2012-09-03T21:01:36.990
> 
> 标签：ruby-on-rails

我正在使用 thumbs_up gem，似乎我有一些工作要做，直到投票给一个帖子完全没有做任何事情。现在，单击此帖子链接的投票会导致一个空白页面，其 URL 为：localhost:3000/posts/1/vote_up

理想情况下，我会通过增加帖子的投票数来完成这项工作

**我的路线文件**

```
Projectmadrone::Application.routes.draw do

  #devise_for :users
  devise_for :users do get '/users/sign_out' => 'devise/sessions#destroy' end

  resources :posts do
     member do
         post :vote_up
      end
     end

   root :to => 'posts#index'
 end 
```

**我的控制器方法**

```
def vote_up
    begin
       current_user.vote_for(@post = Post.find(params[:id]))
       render :nothing => true, :status => 200
    rescue ActiveRecord::RecordInvalid
      render :nothing => true, :status => 404
    end
  end 
```

**app/views/post/index.html.erb**

```
<% @posts.each do |post| %>

 <li><%= post.content %></li>
<li><%= post.attribution %> in <%= post.neighborhood %> 
<span class="post-date"><%=time_ago_in_words(post.created_at) %> ago</span></li>
<li> <%= bucket((post.neighborhood)) %> </li> 

<li>Num votes: <%= post.votes_for %></li>

<li><%= link_to('vote this post!', vote_up_post_path(post), :method => :post) %></li>

<% end %>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:12:44.943

这条线看起来很可疑：

```
render :nothing => true, :status => 200 
```

似乎这会告诉控制器呈现您看到的空白页面。尝试将其注释掉，看看是否可以解决它。希望有帮助！

# android - 这个应用程序需要不同的线程吗？

> ID：12253972
> 
> 赞同：0
> 
> 时间：2012-09-03T21:01:41.563
> 
> 标签：android, ftp, android-asynctask, alarmmanager

我有一个应用程序，它通过 FTP 定期下载一个非常小的文本文件（10 个字节），然后上传一个更大的文件（200 个字节）。它使用警报管理器执行此操作，并且似乎运行良好。我想知道是否需要在不同的线程上运行它，以防互联网变得拥挤，还是我过于谨慎？这是FTP下载的代码：

```
 public void getFTP(Context context)
 {
  //
  // Download config.txt file from server
  //
   FTPClient ftpClient = new FTPClient();

 try{

 ftpClient.connect(InetAddress.getByName(ipAddress));  
 ftpClient.enterLocalPassiveMode();
 ftpClient.login("user", "pass");
 ftpClient.setFileType(FTP.ASCII_FILE_TYPE);

 BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream("/sdcard/config.txt"),8*1024);

 boolean status=ftpClient.retrieveFile("config.txt", bos);

 if(status){
     Toast toast = Toast.makeText(context, "Downloaded config.txt!", Toast.LENGTH_SHORT);
     toast.show();
     }
     else {
     Toast toast = Toast.makeText(context, "Cannot download config.txt!", Toast.LENGTH_SHORT);
     toast.show();  
     return;
     }

 bos.flush();
 bos.close();

 ftpClient.logout();
 ftpClient.disconnect();

 }

 catch (IOException e){
     Toast.makeText(context,"Connection error!" , Toast.LENGTH_LONG).show();
 return;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:21:44.223

如果问题是“我是否应该在非 UI 线程中进行网络连接，即使它们很小” - 那么答案肯定是肯定的。

因为从 ICS 开始，例如，Android 将禁止来自 UI 线程的网络连接，如果您尝试将抛出异常。

此外，将所有可能较长的任务分离到另一个线程只是一个很好的做法。我认为“长”大于 300 毫秒（例如，如果任何 Handler 的方法超过 300 毫秒，Android 将开始在日志中推送警告）。

**注意：**如果您将在 AlarmManager 回调中启动异步操作 - 准备好系统可能“睡眠”和休眠，即使您告诉 AlarmManager 唤醒事件。您可以在此处阅读有关此行为的信息：顶部标题第 2 段中的[http://developer.android.com/reference/android/app/AlarmManager.html 。](http://developer.android.com/reference/android/app/AlarmManager.html)

祝你好运

# jquery - 在 HTML5 样板中禁用缓存

> ID：12253973
> 
> 赞同：0
> 
> 时间：2012-09-03T21:01:56.350
> 
> 标签：jquery, html, caching, html5boilerplate

HTML5 样板文件目前正在我正在开发的网站上使用。我正在开发我的网站，有时不得不清除浏览器的缓存，这会降低我的开发速度。

Javascript 文件似乎被缓存了，我怀疑它是由于 html5 样板中的配置之一。我应该如何禁用缓存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T04:46:19.260

如果站点使用 HTML5 样板包中分发的 .htaccess 文件，请编辑该行

```
ExpiresByType application/javascript    "access plus 1 year" 
```

以便您在开发环境中替换`1 year`为`0 seconds`。

# prolog - 在 Prolog 中解决文本逻辑难题 - 查找生日和月份

> ID：12253974
> 
> 赞同：3
> 
> 时间：2012-09-03T21:01:57.347
> 
> 标签：prolog, prolog-dif, zebra-puzzle

我正在阅读“7 天内的 7 种语言”一书，并且已经读到了 Prolog 章节。作为学习练习，我试图解决一些文本逻辑难题。谜题如下：

*五姐妹的生日都在不同的月份和一周中的不同日子。使用下面的线索，确定每个姐妹的生日是星期几。*

1.  宝拉出生于三月，但不是星期六。阿比盖尔的生日不在周五或周三。
2.  星期一生日的女孩比布伦达和玛丽出生得早。
3.  塔拉不是二月份出生的，她的生日是在周末。
4.  玛丽不是在十二月出生，她的生日也不是在工作日。那个六月份生日的女孩是星期天出生的。
5.  塔拉在布伦达之前出生，布伦达的生日不是星期五。玛丽不是七月出生的。

对于有经验的 Prolog 程序员来说，我当前的实现可能看起来像是一个笑话。代码粘贴在下面。

我希望得到一些关于如何解决问题以及如何使代码既清晰又密集的意见。

IE：

1.  我怎样才能避免输入限制说天数必须是唯一的。
2.  我怎样才能避免输入月份必须是唯一的限制。
3.  添加关于生日排序的限制。

```
is_day(Day) :-
    member(Day, [sunday, monday, wednesday, friday, saturday]).

is_month(Month) :-
    member(Month, [february, march, june, july, december]).

solve(S) :-

    S = [[Name1, Month1, Day1],
         [Name2, Month2, Day2],
         [Name3, Month3, Day3],
         [Name4, Month4, Day4],
         [Name5, Month5, Day5]],

    % Five girls; Abigail, Brenda, Mary, Paula, Tara    
    Name1 = abigail,
    Name2 = brenda,
    Name3 = mary,
    Name4 = paula,
    Name5 = tara,

    is_day(Day1), is_day(Day2), is_day(Day3), is_day(Day4), is_day(Day5),
    Day1 \== Day2, Day1 \== Day3, Day1 \== Day4, Day1 \== Day5,
    Day2 \== Day1, Day2 \== Day3, Day2 \== Day4, Day2 \== Day5,
    Day3 \== Day1, Day3 \== Day2, Day3 \== Day4, Day3 \== Day5,
    Day4 \== Day1, Day4 \== Day2, Day4 \== Day3, Day4 \== Day5,

    is_month(Month1), is_month(Month2), is_month(Month3), is_month(Month4), is_month(Month5),
    Month1 \== Month2, Month1 \== Month3, Month1 \== Month4, Month1 \== Month5,
    Month2 \== Month1, Month2 \== Month3, Month2 \== Month4, Month2 \== Month5,
    Month3 \== Month1, Month3 \== Month2, Month3 \== Month4, Month3 \== Month5,
    Month4 \== Month1, Month4 \== Month2, Month4 \== Month3, Month4 \== Month5,

    % Paula was born in March but not on Saturday.  
    member([paula, march, _], S),
    Day4 \== sunday,

    % Abigail's birthday was not on Friday or Wednesday.    
    Day1 \== friday,
    Day1 \== wednesday,

    % The girl whose birthday is on Monday was born
    % earlier in the year than Brenda and Mary.

    % Tara wasn't born in February, and 
    % her birthday was on the weekend.
    Month5 \== february,
    Day5 \== monday, Day5 \== wednesday, Day5 \== friday,   

    % Mary was not born in December nor was her
    % birthday on a weekday.
    Month3 \== december,
    Day3 \== monday, Day3 \== wednesday, Day3 \== friday,

    % The girl whose birthday was in June was 
    % born on Sunday.
    member([_, june, sunday], S),

    % Tara was born before Brenda, whose birthday
    % wasn't on Friday.
    Day2 \== friday,

    % Mary wasn't born in July.
    Month3 \== july. 
```

**更新**根据 chac 的回答，我能够解决这个难题。按照同样的方法，我们（工作中的编程语言能力小组）也能够解决第二个难题。我已经[在 GitHub 上发布了完整的实现和示例输出作为要点](https://gist.github.com/3622877)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T21:34:43.623

使用 maplist/2 将大大缩短您的代码。例如：

```
maplist(is_month, [Month1,Month2,Month3,Month4,Month5]). 
```

month/1 可能是比 is_month/1 更好的谓词名称。要声明两个项不同，请使用约束 dif/2。使用 maplist/2 和 dif/2，您可以描述一个列表包含成对不同的元素：

```
all_dif([]).
all_dif([L|Ls]) :-
        maplist(dif(L), Ls),
        all_dif(Ls). 
```

例子：

```
?- all_dif([X,Y,Z]).
dif(X, Z),
dif(X, Y),
dif(Y, Z). 
```

solve/1 是一个命令式名称 - 您正在描述解决方案，因此最好将其称为 solution/1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T10:18:44.390

也许谜语没有说明，或者你的解决方案不完整：测试你的代码，我明白了

```
?- solve(X),maplist(writeln,X).
[abigail,february,monday]
[brenda,july,wednesday]
[mary,june,sunday]
[paula,march,friday]
[tara,december,saturday]
X = [[abigail, february, monday], [brenda, july, wednesday], [mary, june, sunday], [paula, march, friday], [tara, december, saturday]] ;
[abigail,february,monday]
[brenda,december,wednesday]
[mary,june,sunday]
[paula,march,friday]
[tara,july,saturday]
X = [[abigail, february, monday], [brenda, december, wednesday], [mary, june, sunday], [paula, march, friday], [tara, july, saturday]] 
```

还有更多的解决方案。那么布伦达是什么时候出生的呢？

唯一性的“交易技巧”是使用[select](http://www.swi-prolog.org/pldoc/doc_for?object=select/3) /3 谓词，或简单地[排列](http://www.swi-prolog.org/pldoc/doc_for?object=permutation/2)/2。最后使用这个代码变成了类似

```
solve(S) :-

    S = [[Name1, Month1, Day1],
         [Name2, Month2, Day2],
         [Name3, Month3, Day3],
         [Name4, Month4, Day4],
         [Name5, Month5, Day5]],

    Girls =  [abigail, brenda, mary, paula, tara],
    Girls =  [Name1, Name2, Name3, Name4, Name5],

    Months = [february, march, june, july, december],
    Days =   [sunday, monday, wednesday, friday, saturday],
    permutation(Months, [Month1, Month2, Month3, Month4, Month5]),
    permutation(Days,   [Day1, Day2, Day3, Day4, Day5]),

    % Paula was born in March but not on Saturday.
    member([paula, march, C1], S), C1 \= saturday,
   ... 
```

关于“一年前”的关系可以这样编码：

```
 ...
    % The girl whose birthday is on Monday was born
    % earlier in the year than Brenda and Mary.
    member([_, C3, monday], S),
    member([brenda, C4, C10], S), before_in_year(C3, C4, Months),
    member([mary, C5, _], S), before_in_year(C3, C5, Months),
    ... 
```

使用服务谓词

```
before_in_year(X, Y, Months) :-
    nth1(Xi, Months, X),
    nth1(Yi, Months, Y),
    Xi < Yi. 
```

“周末出生”可以这样编码

```
...
% Tara wasn't born in February, and
% her birthday was on the weekend.
member([tara, C6, C7], S), C6 \= february, (C7 = saturday ; C7 = sunday),

% Mary was not born in December nor was her
% birthday on a weekday.
member([mary, C8, C9], S), C8 \= december, (C9 = saturday ; C9 = sunday),
... 
```

等等。重写后，我得到了唯一的解决方案

```
?- solve(X),maplist(writeln,X).
[abigail,february,monday]
[brenda,december,wednesday]
[mary,june,sunday]
[paula,march,friday]
[tara,july,saturday]
X = [[abigail, february, monday], [brenda, december, wednesday], [mary, june, sunday], [paula, march, friday], [tara, july, saturday]] ;
false. 
```

**编辑**

我刚才注意到我引入了一些冗余的 member/2 和自由变量，比如`member([brenda, C4, C10], S),...`. 那些 C4、C10 可以被绑定到 Brenda 的变量替换为 Month2、Day2，就像在原始代码中一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T11:10:41.643

这是一个在问题空间上使用蛮力搜索的解决方案。说我不为此感到骄傲是不够的。当然，这个问题有更优雅的解决方案。

反正：

```
month(january).
month(february).
month(march).
month(april).
month(may).
month(june).
month(july).
month(august).
month(september).
month(october).
month(november).
month(december).

precedes(january, february).
precedes(february, march).
precedes(march, april).
precedes(april, may).
precedes(may, june).
precedes(june, july).
precedes(july, august).
precedes(august, september).
precedes(september, october).
precedes(october, november).
precedes(november, december).
earlier(M1, M2) :- precedes(M1, M2).
earlier(M1, M2) :- month(M1), month(M2), precedes(M1, X), month(X), earlier(X, M2).

weekday(monday).
weekday(tuesday).
weekday(wednesday).
weekday(thursday).
weekday(friday).
weekend(saturday).
weekend(sunday).

birthmonth(abigail, M) :- 
    month(M), 
    M \== march.
birthmonth(brenda, M) :- 
    month(M), 
    M \== march.
birthmonth(paula, march).
birthmonth(mary, M) :- 
    month(M), 
    M \== march, M \== december, M \== july.
birthmonth(tara, M) :- 
    month(M), 
    M \== march, 
    M \== february.

birthday(abigail, D) :- 
    weekday(D), 
    D \== friday, D \== wednesday.
birthday(brenda, D) :- 
    weekday(D), 
    D \== friday,
    D \== monday.
birthday(mary, D) :- weekend(D).
birthday(paula, D) :- weekday(D), D \==saturday.
birthday(tara, D) :- weekend(D).

answer(M, D):-
    candidate(M, D),
    member(june, M),
    member(sunday, D),
    nth(IM, M, june),
    nth(ID, D, sunday),
    IM =:= ID,
    nth(5, M, MTARA),
    nth(2, M, MBRENDA),
    earlier(MTARA, MBRENDA),
    nth(3, M, MMARY),
    nth(IMONDAY, D, monday),
    nth(IMONDAY, M, MMONDAY),
    earlier(MMONDAY, MBRENDA),
    earlier(MMONDAY, MMARY).

candidate([M1,M2,M3,M4,M5], [D1,D2,D3,D4,D5]):-
    birthday(abigail, D1),
    birthday(brenda, D2),
    D1 \== D2,
    birthday(mary, D3),
    D1 \== D3,
    D2 \== D3,
    birthday(paula, D4),
    D1 \== D4,
    D2 \== D4,
    D3 \== D4,
    birthday(tara, D5),
    D1 \== D5,
    D2 \== D5,
    D3 \== D5,
    D4 \== D5,
    birthmonth(abigail, M1), 
    birthmonth(brenda, M2), 
    M1 \== M2,
    birthmonth(mary, M3), 
    M1 \== M3, 
    M2 \== M3,
    birthmonth(paula, M4),
    M1 \== M4,
    M2 \== M4,
    M3 \== M4,
    birthmonth(tara, M5),
    M1 \== M5,   
    M2 \== M5,
    M3 \== M5,
    M4 \== M5. 
```

更好的答案是将排序约束作为`birthmonth/2`or`birthday/2`子句的一部分来实现。到目前为止，我还无法让它发挥作用。

`candidate/2`实现了相当于几个嵌套`for()`循环，你看不到，但 WAM（Prolog 的 Warren 抽象机）通过机制来迭代值`D1, D2, D3`......等等。

要查看可能的答案，请使用：

`answer(M,D).`

继续按分号或 gprolog 中的“a”以查看所有答案。每个列表的元素按字母顺序对应于女孩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T12:32:34.250

*唯一地*——预先从域中选择所有实体可以实现简单、“既清晰又密集”的代码。使用数字域可以轻松进行比较：

```
day(   d(_,D,_), D).   
fname( d(N,_,_), N).   % first name
month( d(_,_,M), M).   

sistersP(X):-
    maplist( fname, X, ['Paula', 'Abigail', 'Brenda', 'Mary', 'Tara']),
    maplist( month, X, [PM, AM, BM, MM, TM]),
    maplist( day,   X, [PD, AD, BD, MD, TD]),
    permutation( [PM,AM,BM,MM,TM], [2,3,6,7,12]),            % months of year
    permutation( [PD,AD,BD,MD,TD], [sun,mon,wed,fri,sat]),   % days of week

    PM = 3, PD \== sat, AD \== fri, AD \== wed,              % the five rules,
    day(G,mon), member(G,X), month(G,GM), GM < BM, GM < MM,  %   one per line
    TM =\= 2, (TD == sat ; TD == sun),
    MM =\= 12, (MD == sat ; MD == sun), month(G2,6), day(G2,sun), member(G2,X),
    TM < BM, BD \== fri, MM =\= 7. 
```

这仅找到了一个解决方案，仅使用谜题中提到的一年中的几个月和一周中的几天：

```
?- sistersP(X).
X = [d('Paula', fri, 3), d('Abigail', mon, 2), d('Brenda', wed, 12), 
     d('Mary', sun, 6), d('Tara', sat, 7)] ;
No

?- time( sistersP(_) ).
% 19,537 inferences, 0.01 CPU in 0.01 seconds (100% CPU, 2624221 Lips)
Yes

?- time( (sistersP(_),fail;true) ).  % exhaust the search space
% 56,664 inferences, 0.03 CPU in 0.04 seconds (75% CPU, 2441285 Lips)
Yes 
```

尽可能快地进行测试，逐步选择，会产生更高效的代码。我喜欢使用我自己的[`select/2`](https://stackoverflow.com/a/8270393/849891)，它可以让我从域中唯一地选择列表元素（即另一个列表，允许比第一个更长，因此`permutation/2`不能使用）。

```
select([A|As],S):- select(A,S,S1),select(As,S1).
select([],_). 

sisters(X):-
    maplist(fname, X, ['Paula', 'Abigail', 'Brenda', 'Mary', 'Tara']),
    maplist(month, X, [PM, AM, BM, MM, TM]),
    maplist(day,   X, [PD, AD, BD, MD, TD]),
    Months = [2,3,6,7,12],           %%% [1,2,3,4,5,6,7,8,9,10,11,12],
    Days = [sun,mon,wed,fri,sat],    %%% [sun,mon,tue,wed,thu,fri,sat], 

    select(3,Months,M2),  PM = 3, 
    select(PD,Days,D2),   PD \== sat,              % 1a
    select(AD,D2,D3),     AD \== fri, AD \== wed,  % 1b
    select(TM,M2,M3),     TM =\= 2,                % 3a
    select(MM,M3,M4),     MM =\= 12,  MM =\= 7,    % 4a1 % 5c
    select(TD,D3,D4),  select([TD,MD],[sat,sun]),  % 3b  % 4a2
    month(G,6), day(G,sun), member(G,X),           % 4b
    select([MD,BD],D4),   BD \== fri,              % 5a
    select([BM,AM],M4),   TM < BM,                 % 5b
    day(G2,mon),          member(G2,X),
    month(G2,G2M),        G2M < BM, G2M < MM.      % 2 
```

运行：

```
?- sisters(X).
X = [d('Paula', fri, 3), d('Abigail', mon, 2), d('Brenda', wed, 12), 
     d('Mary', sun, 6), d('Tara', sat, 7)] ;
No

?- time(sisters(_)).
% 2,071 inferences, 0.00 CPU in 0.00 seconds (?% CPU, Infinite Lips)
Yes

?- time( (sisters(_),fail;true) ).  % exhaust the search space
% 2,450 inferences, 0.00 CPU in 0.00 seconds (?% CPU, Infinite Lips)
Yes 
```

使用一年中的所有 12 个月和一周中的 7 天（不幸的是，我一开始就这样做了:)），有 4561 个解决方案，第二个代码足够快地找到它们（0.16 秒，424,600 次推理）。第一个代码用`select/2`used 代替`permutation/2`，需要***180,400,000 次***推理和 75 秒才能产生第一个答案，而第二个更快的代码需要 19,400 个 infs 在 0.01 秒内。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T16:54:23.093

在这类问题中，我喜欢按照拼图的文本（与 SWI Prolog 6.3.0 一起使用）：

```
week_end(Day) :-
    member(Day, [saturday, sunday]).

day(Day) :-
    member(Day, [monday, wednesday, friday, saturday, sunday]).

month(Month) :-
    member(Month, [february, march, june, july, december]).

before(M1, M2) :-
    nth0(I1, [february, march, june, july, december], M1),
    nth0(I2, [february, march, june, july, december], M2),
    I1 < I2.

names([person(abigail, _, _),
       person(brenda, _, _),
       person(mary, _, _),
       person(paula, _, _),
       person(tara, _, _)]).

solve(L) :-
    maplist(\X^(X = person(_, Day, Month),
            day(Day),
            month(Month)),
        L),

    forall((select(X,L, L1), select(Y, L1, _)),
           (   X = person(_, D1, M1),
           Y = person(_, D2, M2),
           D1 \= D2,
           M1 \= M2)).

/*
1.Paula was born in March but not on Saturday. Abigail's birthday was not on Friday or Wednesday.
*/
rule_1(L) :-
    member(person(paula, D, march), L),
        D \== saturday,

    member(person(abigail, D1, _M), L),
    day(D1),
    \+ member(D1, [friday, wednesday]).

/*
2.The girl whose birthday is on Monday was born earlier in the year than Brenda and Mary.
*/
rule_2(L) :-
    member(person(_N, monday, M), L),
    member(person(brenda, _D1, M1), L),
    member(person(mary, _D2, M2), L),
    before(M, M1),
    before(M, M2).

/*
3.Tara wasn't born in February and her birthday was on the weekend.
*/

rule_3(L) :-
    member(person(tara, D, M), L),
    M \== february,
    week_end(D).

/*
4.Mary was not born in December nor was her birthday on a weekday. The girl whose birthday was in June was born on Sunday.
*/

rule_4(L) :-
    member(person(mary, D, M), L),
    week_end(D),
    M \== december,
    member(person(_N, sunday, june), L).

/*
5.Tara was born before Brenda, whose birthday wasn't on Friday. Mary wasn't born in July.
*/

rule_5(L) :-
    member(person(tara, _DT, MT), L),
    member(person(brenda, DB, MB), L),
    before(MT, MB),
    % DB \== friday,
    day(DB),
    DB \= friday,    
    member(person(mary, _D, M), L),
    M \== july.

puzzle :-
    names(L),
    rule_1(L),
    rule_2(L),
    rule_3(L),
    rule_4(L),
    rule_5(L),
    solve(L),
    maplist(writeln, L). 
```

我得到：

```
 ?- time(puzzle).
person(abigail,monday,february)
person(brenda,wednesday,december)
person(mary,sunday,june)
person(paula,friday,march)
person(tara,saturday,july)
% 45,144 inferences, 0.016 CPU in 0.031 seconds (50% CPU, 3294080 Lips)
true . 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-13T20:00:04.890

#clpfd 方法序言：-

```
:-use_module(library(clpfd)).
puzzle(Sisters,Months,Days):-
Sisters=[Paula, Brenda, Abigail, Mary, Tara], Sisters ins 1..5,
Months=[Feburary, March, June, July, December], Months ins 1..5,
Days=[Monday, Wednesday, Friday, Saturday, Sunday], Days ins 1..5,

Paula#=March,
Paula#\=Saturday,
Abigail#\=Friday #\/ Abigail #\=Wednesday,
Tara#\=Feburary #/\ (Tara#=Saturday #\/ Tara#=Sunday),
Mary#\=December #/\ (Mary#\=Saturday #\/ Mary#\=Sunday),
Tara#=Brenda-1,
Brenda#\=Friday,
Mary#\=July,
June#=Sunday,
Brenda #\=Monday #/\ Mary #\=Monday,

all_different(Sisters),
all_different(Months),
all_different(Days),

labeling([], Sisters), labeling([],Months), labeling([], Days).

?-puzzle(Sisters,Months,Days).
OUTPUT:
Days = [1, 3, 4, 2, 5],
Months = [3, 1, 5, 2, 4],
Sisters = [1, 3, 4, 5, 2]
Days = [4, 3, 1, 2, 5],
Months = [3, 1, 5, 2, 4],
Sisters = [1, 3, 4, 5, 2]
Days = [1, 3, 4, 2, 5],
Months = [3, 1, 5, 4, 2],
Sisters = [1, 3, 4, 5, 2]
...... 
```

# sql - VB.NET 应用程序的 SQL 数据库部署

> ID：12253978
> 
> 赞同：0
> 
> 时间：2012-09-03T21:02:22.003
> 
> 标签：sql, vb.net, deployment

我在这里阅读了很多文章，但还没有找到解决方案。我有一个由我的 VB.NET 应用程序使用的 SQL Server Express 数据库。我已经通过 MSI 文件打包并部署了应用程序，一切正常，除了我无法弄清楚如何将我的数据库文件包含在包中。我知道有三种通用方法可以做到这一点（手动复制文件、自定义操作和 SQL 脚本）。我在这里不需要任何花哨的东西，只是一种将数据库放在客户端机器上的快速方法，以便我的应用程序可以访问它。

我决定手动复制数据库是最快的选择。我尝试将它放在工作目录和`\DATA`客户端的 SQL Server Express 安装目录中，但我的应用程序无法连接。我还尝试将项目中的连接更改为，`.\SQLEXPRESS`而不是`[my_computer_name]\SQLEXPRESS`重新构建部署项目并在客户端计算机上重新安装，但对我来说没有任何好处。同样的问题。我尝试将项目中的“UserInstance”属性更改为“True”，但我的项目不允许我保存该操作。

我是否正确地认为手动复制是完成这项工作的最快和最简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:13:28.593

你应该把`attach`你的文件放到 Sql Server 实例中。

```
CREATE DATABASE YourDatabaseName 
    ON (FILENAME = 'C:\your\data\directory\your_file.mdf'), 
    (FILENAME = 'C:\your\data\directory\your_file_Log.ldf') 
FOR ATTACH; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:08:50.993

您需要将数据库文件附加到客户端计算机上正在运行的 SQL Server。这可以使用存储在配置文件（app.config 或 web.config）中的连接字符串的这种变体轻松完成

```
Server=.\SQLExpress;AttachDbFilename=where_you_have_stored_the_mdf_file;
        Database=dbname; Trusted_Connection=Yes; 
```

或者，您可以使用`|DataDirectory|`替换字符串。
此快捷方式消除了对完整路径进行硬编码的需要。
使用 DataDirectory，您可以拥有以下连接字符串：

```
Server=.\SQLExpress;AttachDbFilename=|DataDirectory|\yourfile.mdf”
         Database=dbname; Trusted_Connection=Yes; 
```

# java - 将 JLabel 放在 JLabel 的顶部，其中包含图像

> ID：12253979
> 
> 赞同：5
> 
> 时间：2012-09-03T21:02:32.823
> 
> 标签：java, swing, jpanel, jlabel

我很确定以前有人问过这个问题，但是我的情况略有不同，因为我试图将 JLabel 放在作为背景的 JLabel 之上，我想使用 JLabel 显示不断变化的数字，并且需要的数字在背景上显示，但我有点摇摆不定，提前感谢乔纳森

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-03T21:12:43.637

在不完全了解您的要求的情况下，如果您只需要在背景图像上显示文本，最好将标签放在能够绘制背景的自定义面板上。

您可以从没有混乱的布局管理器中受益。

我会先阅读[Performing Custom Painting](http://docs.oracle.com/javase/tutorial/uiswing/painting/)和[Graphics2D Trail](http://docs.oracle.com/javase/tutorial/2d/index.html)。

如果这看起来令人生畏，`JLabel`实际上是 的一种`Container`，这意味着它实际上可以“包含”其他组件。

**例子**

背景窗格...

```
public class PaintPane extends JPanel {

    private Image background;

    public PaintPane(Image image) {     
        // This is just an example, I'd prefer to use setters/getters
        // and would also need to provide alignment options ;)
        background = image;            
    }

    @Override
    public Dimension getPreferredSize() {
        return background == null ? new Dimension(0, 0) : new Dimension(background.getWidth(this), background.getHeight(this));            
    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        if (background != null) {                
            Insets insets = getInsets();

            int width = getWidth() - 1 - (insets.left + insets.right);
            int height = getHeight() - 1 - (insets.top + insets.bottom);

            int x = (width - background.getWidth(this)) / 2;
            int y = (height - background.getHeight(this)) / 2;

            g.drawImage(background, x, y, this);                
        }

    }

} 
```

建造...

```
public TestLayoutOverlay() throws IOException { // Extends JFrame...

    setTitle("test");
    setLayout(new GridBagLayout());
    setDefaultCloseOperation(EXIT_ON_CLOSE);

    PaintPane pane = new PaintPane(ImageIO.read(new File("fire.jpg")));
    pane.setLayout(new BorderLayout());
    add(pane);

    JLabel label = new JLabel("I'm on fire");
    label.setFont(label.getFont().deriveFont(Font.BOLD, 48));
    label.setForeground(Color.WHITE);
    label.setHorizontalAlignment(JLabel.CENTER);
    pane.add(label);

    pack();
    setLocationRelativeTo(null);
    setVisible(true);

} 
```

只是为了表明我没有偏见;），一个使用标签的例子......

```
public TestLayoutOverlay() {

    setTitle("test");
    setLayout(new GridBagLayout());
    setDefaultCloseOperation(EXIT_ON_CLOSE);

    JLabel background = new JLabel(new ImageIcon("fire.jpg"));
    background.setLayout(new BorderLayout());
    add(background);

    JLabel label = new JLabel("I'm on fire");
    label.setFont(label.getFont().deriveFont(Font.BOLD, 48));
    label.setForeground(Color.WHITE);
    label.setHorizontalAlignment(JLabel.CENTER);
    background.add(label);

    pack();
    setLocationRelativeTo(null);
    setVisible(true);

} 
```

![着火](../Images/8fd16b8b1f9afd427a3b2330bddcf8ed.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:13:16.160

在运行时：

*   从其父标签中删除标签
*   添加一个容器，它支持层
*   添加 2x 层，但保持 Z 顺序

享受。（没有给出复制粘贴的完整代码）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-03T21:35:51.163

你可以这样做：

```
JLabel l1=new JLabel();
JLabel l2=new JLabel();
l1.add(l2, JLabel.NORTH); 
```

# java - 异常抛出 - 用法

> ID：12253980
> 
> 赞同：0
> 
> 时间：2012-09-03T21:02:52.127
> 
> 标签：java, exception-handling

要求用户从某个给定集合中选择一个 ID。我检查该 ID 是否存在于我的收藏中，如果不存在，我`IndexOutOfBoundsException`稍后将其扔掉并抓住它。我实际上可以为此目的使用该异常还是只是一种非常糟糕的做法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:06:01.067

如果`ID`作为参数传递给方法，并且您想将其作为前置条件的一部分进行检查，您可以抛出 an`IllegalArgumentException`或`RuntimeException`.
`IndexOutOfBounds`没有意义，因为它在这里令人困惑。这是当您越界访问时引发的异常

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T21:06:25.650

如果您面临非常特殊的情况，抛出异常确实很有意义

如果您的班级合同假设用户永远不会查询不在集合中的值，那么例外是好的。也许 IllegalArgumentException 或类似的东西。

否则会导致样板代码，有时由于堆栈展开和异常传播而导致性能显着下降

所以这是一种权衡是抛出异常还是返回一些预定义的值

我建议在您的情况下返回“null”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T21:10:38.740

就我个人而言，我会抛出一个检查异常，因此调用方法被迫捕获它。你能做的就是打电话

```
initCause 
```

在异常上并将其设置为 IllegalArgumentException

例如

```
public method(int i) throws MyException {
    if (i < 0) {
       MyException e = new MyException();
       e.initCause(new IllegalArugmentException());
       throw e;
    }
} 
```

我可能还会调用正确的辅助器来传递消息，以便在抛出异常时很清楚发生了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T21:07:16.920

取决于上下文，但 IMO 如果您正在查找一个 ID，一个与位置引用无关的概念，这将是对该特定异常的滥用——可能是特定于应用程序的 ItemNotFound 或等效项。

如果您的 API 具有指定您将返回有效对象或引发异常的协定，则引发异常。如果有意义，也可以考虑使用 NullObject 模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T21:08:59.350

如果调用适用于`23`并且调用适用于`47`，同时没有任何变化，那么它不起作用的原因`35`不能是索引超出范围。

# virtualenv - 在山狮上安装 virtualenvwrapper 的问题

> ID：12253983
> 
> 赞同：2
> 
> 时间：2012-09-03T21:02:58.977
> 
> 标签：virtualenv, pip, setuptools, osx-mountain-lion

我最近丢失了我的硬盘，目前正在重建我的笔记本电脑（运行 Mountain Lion）开发系统。今天下午我去安装virtualenvwrapper，遇到了一些奇怪的事情，阻止我安装virtualenvwrapper。

*我做了以下事情：*

1.  已安装设置工具。
2.  使用 easy_install-2.7 安装 pip。
3.  使用 pip-2.7 安装虚拟环境。

当我使用 pip-2.7 安装 virtualenvwrapper 时，我得到以下信息（见下文）。*-2.5,-2.6,-2.7*后缀对山狮来说似乎是新事物？我已经尝试过没有后缀的相同过程，但这也不起作用。

我之所以发帖，是因为我怀疑这里有些地方出了问题，并且想在它成为一个更隐蔽的问题之前深入了解它。

*下载并安装 2.7 的新版本并设置我的路径以使用它对我来说更好吗？*

* * *

```
Downloads  sudo pip-2.7 install virtualenvwrapper   
Requirement already satisfied (use --upgrade to upgrade): virtualenvwrapper in /Library/Python/2.7/site-packages
Requirement already satisfied (use --upgrade to upgrade): virtualenv in /Library/Python/2.7/site-packages (from virtualenvwrapper)
Requirement already satisfied (use --upgrade to upgrade): virtualenv-clone in /Library/Python/2.7/site-packages (from virtualenvwrapper)
Requirement already satisfied (use --upgrade to upgrade): stevedore in /Library/Python/2.7/site-packages (from virtualenvwrapper)
Downloading/unpacking distribute (from stevedore->virtualenvwrapper)
  Downloading distribute-0.6.28.tar.gz (627kB): 627kB downloaded
  Running setup.py egg_info for package distribute

Installing collected packages: distribute
  Running setup.py install for distribute
    Before install bootstrap.
    Scanning installed packages
    Setuptools installation detected at /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg
    Egg installation
    Patching...
    Renaming /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg into /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg.OLD.1346705360.93
    Patched done.
    Relaunching...
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
    NameError: name 'install' is not defined
    Complete output from command /System/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python -c "import setuptools;__file__='/tmp/pip-build/distribute/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-RMDd1X-record/install-record.txt --single-version-externally-managed:
    Before install bootstrap.

Scanning installed packages

Setuptools installation detected at /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg

Egg installation

Patching...

Renaming /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg into /Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg.OLD.1346705360.93

Patched done.

Relaunching...

Traceback (most recent call last):

  File "<string>", line 1, in <module>

NameError: name 'install' is not defined 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T16:04:02.687

[p4tux](https://stackoverflow.com/users/1607964/p4tux)说了什么

> virtualenv 现在使用的是分发而不是 setuptools
> 
> `export VIRTUALENV_DISTRIBUTE=true`

在创建环境之前

```
virtualenv ENV 
```

或者做

```
$ python virtualenv.py --distribute ENV 
```

请参阅[virtualenv 文档](http://www.virtualenv.org/en/latest/#usage)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-10T23:07:50.393

virtualenv 现在使用的是分发而不是 setuptools

导出 VIRTUALENV_DISTRIBUTE=true

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T23:51:58.520

这个链接：

[https://gist.github.com/3179227](https://gist.github.com/3179227)

（使用pythonbrew）似乎暂时为我解决了这个问题。我不想在组合中加入另一个组件（pythonbrew），所以希望其他人会重视如何让 virtualenv 与 ML 很好地配合。

# matlab - 使用傅里叶域卷积复制 MATLAB 的 `conv2()`

> ID：12253984
> 
> 赞同：7
> 
> 时间：2012-09-03T21:03:06.253
> 
> 标签：matlab, image-processing, fft, convolution

我想拍摄两张图像并在 Matlab 中使用 2D FFT 将它们卷积在一起而不求助于该`conv2`函数。但是，我不确定应该如何正确填充矩阵并为卷积做准备。

数学运算如下：

**A** * **B** = **C**

在上面，* 是卷积算子（[维基百科链接](http://en.wikipedia.org/wiki/Convolution)）。

下面的 Matlab 程序显示了填充和不填充矩阵之间的区别。我怀疑不填充矩阵会导致循环卷积，*但我想执行没有混叠的线性卷积*。

如果我确实填充了这两个矩阵，那么如何截断卷积的输出以使**C与****A**和**B**的大小相同？

```
A = rgb2gray(im2double(imread('1.png'))); % input A
B = rgb2gray(im2double(imread('2.png'))); % kernel B

figure;
imagesc(A); colormap gray;
title ('A')

figure;
imagesc(B); colormap gray;
title ('B')

[m,n] = size(A);
mm = 2*m - 1;
nn = 2*n - 1;

C = (ifft2(fft2(A,mm,nn).* fft2(B,mm,nn)));

figure;
imagesc(C); colormap gray;
title ('C with padding')

C0 = (ifft2(fft2(A).* fft2(B)));

figure;
imagesc(C0); colormap gray;
title ('C without padding') 
```

这是程序的输出：

![一个](../Images/f4155618c605ee7606c9f53e780cc206.png) ![乙](../Images/401f817c10e9d0edae19c0804881959c.png) ![C](../Images/c83990e7dc61336c8eb2232e3ce3f7f9.png) ![C0](../Images/200e69b587dd988ced82eb8603b34e5b.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T22:40:07.927

正如您所指出的，如果没有填充，结果将等同于**循环卷积。**对于**线性卷积**，在卷积 2 个图像（2D 信号）A*B 时，完整输出的大小为`Ma+Mb-1 x Na+Nb-1`，其中`Ma x Na, Mb x Nb`图像 A 和 B 的大小分别为 。

在填充到预期大小、相乘和变换回来后，通过`ifft2`，您可以保留结果图像的中心部分（通常对应于 A 和 B 中最大的一个）。

```
A = double(imread('cameraman.tif'))./255; % image
B = fspecial('gaussian', [15 15], 2); % some 2D filter function

[m,n] = size(A);
[mb,nb] = size(B); 
% output size 
mm = m + mb - 1;
nn = n + nb - 1;

% pad, multiply and transform back
C = ifft2(fft2(A,mm,nn).* fft2(B,mm,nn));

% padding constants (for output of size == size(A))
padC_m = ceil((mb-1)./2);
padC_n = ceil((nb-1)./2);

% frequency-domain convolution result
D = C(padC_m+1:m+padC_m, padC_n+1:n+padC_n); 
figure; imshow(D,[]); 
```

现在，将上述方法与进行空间域卷积进行比较，使用`conv2D`

```
 % space-domain convolution result
 F = conv2(A,B,'same');
 figure; imshow(F,[]); 
```

结果在视觉上是相同的，两者之间的总误差（由于四舍五入）大约为`e-10.`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-29T12:17:05.670

我创建了一个基本上`conv2()`在频域中的 MATLAB 函数：

```
function [ mO ] = ImageConvFrequencyDomain( mI, mH, convShape )
% ----------------------------------------------------------------------------------------------- %
% [ mO ] = ImageConvFrequencyDomain( mI, mH, convShape )
% Applies Image Convolution in the Frequency Domain.
% Input:
%   - mI                -   Input Image.
%                           Structure: Matrix.
%                           Type: 'Single' / 'Double' (Single Channel).
%                           Range: (-inf, inf).
%   - mH                -   Filtering Kernel.
%                           Structure: Matrix.
%                           Type: 'Single' / 'Double'.
%                           Range: (-inf, inf).
%   - convShape         -   Convolution Shape.
%                           Sets the convolution shape.
%                           Structure: Scalar.
%                           Type: 'Single' / 'Double'.
%                           Range: {1, 2, 3}.
% Output:
%   - mI                -   Output Image.
%                           Structure: Matrix (Single Channel).
%                           Type: 'Single' / 'Double'.
%                           Range: (-inf, inf).
% References:
%   1\.  MATLAB's 'conv2()' - https://www.mathworks.com/help/matlab/ref/conv2.html.
% Remarks:
%   1\.  A
% TODO:
%   1\.  
%   Release Notes:
%   -   1.0.000     29/04/2021  Royi Avital     RoyiAvital@yahoo.com
%       *   First release version.
% ----------------------------------------------------------------------------------------------- %

CONV_SHAPE_FULL     = 1;
CONV_SHAPE_SAME     = 2;
CONV_SHAPE_VALID    = 3;

numRows     = size(mI, 1);
numCols     = size(mI, 2);

numRowsKernel = size(mH, 1);
numColsKernel = size(mH, 2);

switch(convShape)
    case(CONV_SHAPE_FULL)
        numRowsFft  = numRows + numRowsKernel - 1;
        numColsFft  = numCols + numColsKernel - 1;
        firstRowIdx = 1;
        firstColIdx = 1;
        lastRowIdx  = numRowsFft;
        lastColdIdx = numColsFft;
    case(CONV_SHAPE_SAME)
        numRowsFft  = numRows + numRowsKernel;
        numColsFft  = numCols + numColsKernel;
        firstRowIdx = ceil((numRowsKernel + 1) / 2);
        firstColIdx = ceil((numColsKernel + 1) / 2);
        lastRowIdx  = firstRowIdx + numRows - 1;
        lastColdIdx = firstColIdx + numCols - 1;
    case(CONV_SHAPE_VALID)
        numRowsFft = numRows;
        numColsFft = numCols;
        firstRowIdx = numRowsKernel;
        firstColIdx = numColsKernel;
        % The Kernel when transformed is shifted (Namely its (0, 0) is top
        % left not middle).
        lastRowIdx  = numRowsFft;
        lastColdIdx = numColsFft;
end

mO = ifft2(fft2(mI, numRowsFft, numColsFft) .* fft2(mH, numRowsFft, numColsFft), 'symmetric');
mO = mO(firstRowIdx:lastRowIdx, firstColIdx:lastColdIdx);

end 
```

它完全兼容并经过验证。
完整代码可在我的[StackExchange Signal Processing Q74803 GitHub 存储库](https://github.com/RoyiAvital/StackExchangeCodes/tree/master/SignalProcessing/Q74803)中找到。

# lua - 如何以编程方式检查 LOVE2D 版本

> ID：12253993
> 
> 赞同：1
> 
> 时间：2012-09-03T21:04:24.720
> 
> 标签：lua, versioning, love2d

如何确保 .love 文件仅在当前版本的 LOVE2D 优于给定的最低版本时运行？如果不进行某种检查，产生的错误可能是模糊的，并且似乎与 LOVE 版本无关，这需要用户浪费大量时间尝试根据误导性错误来诊断问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T18:21:49.843

您可以添加`t.version = "0.8.0"`到您`conf.lua`的，如果他使用的是 0.8.0 以外的版本，它会警告用户。你不应该*阻止*不匹配的版本，你应该*警告*他们。

这是一个例子`conf.lua`：

```
function love.conf(t)
    t.title = "Game title"
    t.author = "Your name"
    t.version = "0.8.0"
end 
```

[这](https://love2d.org/wiki/love.conf)是关于 的 wiki 文章`conf.lua`。