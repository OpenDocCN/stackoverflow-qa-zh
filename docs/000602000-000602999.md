# StackOverflow 问答 000602000-000602999

# silverlight - 带有博客和论坛的社区站点 - Oxite、DNN 还是 CS？

> ID：602015
> 
> 赞同：0
> 
> 时间：2009-03-02T11:39:58.043
> 
> 标签：silverlight, live, dotnetnuke, community-server, oxite

我需要做一个带有博客和论坛的社区站点，并且正在寻找 3 个选项：Oxite、DNN 和社区服务器。前端将是 ASP.NET 和 Silverlight 的混合体。LiveID 集成将是一个加分项。有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T21:06:50.413

我推荐 DNN（DotNetNuke）。它具有您可以想象的大多数功能，包括 LiveId 和其他一些登录提供程序。DNN 最引人注目的论点是围绕该平台构建的第 3 方社区。你几乎可以找到任何你想要的东西。查看[SnowCovered](http://www.snowcovered.com "大雪覆盖")了解一些可用模块。

有一个 MS Excel 电子表格比较了几种流行的 CMS，您可能想在此处查看[CMS 比较网格](http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/1661/New-CMS-Comparison-grid.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T12:55:52.200

Oxite 是相当新的，据我所知不支持论坛，所以开箱即用它不会满足您的需求。.Net 中还有其他更成熟的博客引擎[列在 oxite 主页上](http://www.codeplex.com/oxite)

当您说“前端将是 ASP.NET 和 Silverlight 的混合体”时，您似乎是在表示您将编写自己的前端并想要一个起点？您想要自己编写多少代码？

但是 Oxite 是开源的，现在它可以作为 ASP.NET MVC 中最佳实践的样本，即其他博客项目可能没有的尖端内容。如果它对你有好处，那就是它。

[社区服务器](http://en.wikipedia.org/wiki/Community_Server)看起来更完整，但我对它的可用性没有经验。目前尚不清楚这是否是开源的，但看起来你需要为更大的版本付费。你愿意这样做吗？

DNN 是 DotNetNuke 的意思吗？它像 Oxite 一样免费，并且像社区服务器一样功能齐全。我对此了解不多。

# javascript - 如何从 JavaScript 中的 ASCII 值创建字符串或字符？

> ID：602020
> 
> 赞同：68
> 
> 时间：2009-03-02T11:41:34.343
> 
> 标签：javascript, ascii

在 JavaScript 中，如何获取 ASCII 值的字符串表示形式，例如如何转换`65`为`A`?

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-03-02T11:44:44.990

fromCharCode方法将 ASCII[转换](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode)为字符串：

```
<script type="text/javascript">
document.write(String.fromCharCode(65,66,67)); // ABC
</script> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-16T12:28:53.523

[我们这些不喜欢 w3schools 的人的参考；）](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode)

用法：

`var myAString = String.fromCharCode(65)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T11:45:12.557

您正在寻找的方法是 String.fromCharCode ( [http://www.w3schools.com/jsref/jsref_fromCharCode.asp](http://www.w3schools.com/jsref/jsref_fromCharCode.asp) )。

# asp.net - Web 应用程序 - 跨域用户身份验证

> ID：602023
> 
> 赞同：1
> 
> 时间：2009-03-02T11:42:59.753
> 
> 标签：asp.net, authentication, web-applications, federated-identity

我们的一个客户找我们开发一个应用程序，并且像往常一样，范围日益扩大。

最初，它是作为限制在其公司网络中的专用应用程序开始的。通过获取用户的 Windows 登录名并使用 SQLServer 数据库托管访问权限来建立用户身份验证。一切都很直截了当。

他们现在想要以下内容：
**- 基于 Web 的
应用程序 - 在公司网络之外托管的应用程序
- 用户身份验证以相同的方式工作（不使用密码，只使​​用 Windows 登录）**

更复杂的是，他们希望应用程序的各种功能能够被另一个只触发 HTTP 请求的应用程序使用。
**- 用户登录到企业网络
- 用户启动企业应用程序
- 用户处理客户详细信息
- 用户单击按钮
- 企业应用程序向我们托管的 Web 应用程序发出 HTTP 请求
- HTTP 请求包括必要的身份验证和客户详细信息
- 用户身份验证“自动完成” '（无需人工参与）
- 客户数据安全传输**

他们非常渴望我们为他们做这件事，因为我们最初的方法正是他们想要的。即使此类托管网络应用程序不是我们的专长，他们仍然希望我们这样做。所以我现在联系专家；
**- 有人对如何解决这个问题有任何建议吗？
- 是否有人对可能要避免的陷阱有任何警告？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T11:55:24.230

基本上他们在谈论联合访问。您将在他们的网络中托管一个身份验证点，然后将令牌转发给您的应用程序，该应用程序对其进行解析并允许（或停止访问）。[这是相当标准的，MS 在日内瓦框架](https://connect.microsoft.com/site/sitehome.aspx?SiteID=642)中为此提供了良好的基础。这也适用于 Web 服务调用，前提是它们可以更改其应用程序以使用 WSFed 作为协议并与安全令牌服务对话，该服务以静默方式发出身份验证令牌。在大多数情况下，您将为此使用 SAML。它还具有额外的好处，即永远不会超出其公司网络的身份验证详细信息。

基于证书的身份验证的建议是一个有趣的建议，但在推出 PKI 基础设施方面需要做更多的工作。这可能代价高昂。

CardSpace 不起作用——它不像他们想要的那样保持沉默。OpenID 也不是入门者，它也不是沉默的。

如果您正在查看 Azure，则额外加分 - Azure 的身份验证位也在后台使用 SAML/WSFed，并且其中包含日内瓦位。因此，如果您迁移到云端，那么您的每个客户只需要在他们的网络中配置一个登录页面 - 您所要做的就是信任该页面向您颁发身份验证令牌并根据您的规则对其进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T11:48:52.860

也许 WCF 通信与基于证书的身份验证，即使用公司为他们提供有效证书的服务的外部用户。这将不需要用户名密码，而是让用户直接通过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T11:49:23.670

您已经看过[SAML](http://en.wikipedia.org/wiki/SAML)了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T11:52:25.410

查看[Windows CardSpace](http://en.wikipedia.org/wiki/Windows_CardSpace)，因为它确实与您的 Windows 登录集成并允许他们需要的 SSO 场景。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T13:11:01.100

根据您的应用程序的构建方式，您可以在 web.config 中调整 machineKey 以允许通过单点登录 (SSO) 进行 AJAX 调用。这将涉及企业网络中的一个小型 asp.net 应用程序，仅用于分发身份验证令牌并重定向到您托管的应用程序。

如果这两个应用程序共享同一个 machineKey，那么 asp.net 身份验证系统将很高兴地允许用户进入您托管的应用程序。

这种方法存在问题：

*   您在系统中引入了另一个依赖项（企业网络中的身份验证应用程序）。这将是一个简单的应用程序，但如果您无权访问，则在尝试诊断问题时会遇到问题。
*   您需要将托管服务与身份验证应用程序放在同一域中（因此 HTTP cookie 中的身份验证票证会被传递。）
*   You'll also need an SSL certificate for your hosted service to secure the information. (Not really a downside per-se, you'd probably want to do this anyway.)
*   Because you and your client will have a shared machineKey, you will tie down an instance of your app to that particular client.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-02T11:45:28.047

我会为此使用私有 OpenID 提供程序/服务器。

# python - 将最后创建的模型行存储在内存中

> ID：602030
> 
> 赞同：0
> 
> 时间：2009-03-02T11:46:17.623
> 
> 标签：python, django

我正在开发 ajax 游戏。摘要：2+游戏玩家（浏览器）更改了一个通过json保存到数据库的变量。所有游戏玩家都由 javascript-timer+json 同步 - 定期从数据库中读取该变量。

通常，所有更改都作为历史记录存储在数据库中，但我希望最近的更改在内存中复制。

所以问题是：我希望将一个变量存储在内存而不是数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T17:11:29.120

您可以使用缓存系统：

[http://docs.djangoproject.com/en/dev/topics/cache/#topics-cache](http://docs.djangoproject.com/en/dev/topics/cache/#topics-cache)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T17:30:43.207

不幸的是，我不相信你能做到这一点，除非你只有一个 Python 实例正在运行，在这种情况下你可以使用一个全局变量。对于大多数 Web 实现，您都有一个线程服务器，因此这不起作用。您必须从数据库中提取以获取记录的最新副本。

如果这是一个非常高使用率的情况，您可能希望研究[memcached](http://www.danga.com/memcached/)（或类似的）作为降低每个请求访问数据库的性能开销的一种方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T19:27:43.020

您要么必须使用缓存，要么获取每个请求的最新更改（因为您无法在内存中的请求之间保留对象）。

根据您的描述，听起来好像经常被击中，所以缓存可能是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T21:57:34.970

像这样的东西[`memcached`](http://www.danga.com/memcached/)合适吗？

# java - 让java gui在网络浏览器中打开网页

> ID：602032
> 
> 赞同：34
> 
> 时间：2009-03-02T11:47:08.790
> 
> 标签：java, html, user-interface

我正在尝试获取一个 java gui 来打开一个网页。所以 gui 运行一些代码，然后生成一个 html 文件。然后，我希望该文件在创建后立即在 Web 浏览器（最好是 Firefox）中打开。我该怎么做呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-02T11:54:12.020

如果您使用的是 Java 6 或更高版本，请参阅[桌面](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html)API，尤其是[浏览](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#browse(java.net.URI)). 像这样使用它（未经测试）：

```
// using this in real life, you'd probably want to check that the desktop
// methods are supported using isDesktopSupported()...

String htmlFilePath = "path/to/html/file.html"; // path to your new file
File htmlFile = new File(htmlFilePath);

// open the default web browser for the HTML page
Desktop.getDesktop().browse(htmlFile.toURI());

// if a web browser is the default HTML handler, this might work too
Desktop.getDesktop().open(htmlFile); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-09-14T08:56:44.667

是的，但是如果您想通过 Java 程序在默认 Web 浏览器中打开网页，那么您可以尝试使用此代码。

```
/// file OpenPageInDefaultBrowser.java
public class OpenPageInDefaultBrowser {
   public static void main(String[] args) {
       try {
         //Set your page url in this string. For eg, I m using URL for Google Search engine
         String url = "http://www.google.com";
         java.awt.Desktop.getDesktop().browse(java.net.URI.create(url));
       }
       catch (java.io.IOException e) {
           System.out.println(e.getMessage());
       }
   }
}
/// End of file 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-07T18:35:55.170

我知道所有这些答案基本上都回答了这个问题，但这里有一个优雅失败的方法的代码。

请注意，字符串可以是 html 文件的位置

```
/**
* If possible this method opens the default browser to the specified web page.
* If not it notifies the user of webpage's url so that they may access it
* manually.
* 
* @param url
*            - this can be in the form of a web address (http://www.mywebsite.com)
*            or a path to an html file or SVG image file e.t.c 
*/
public static void openInBrowser(String url)
{
    try
        {
            URI uri = new URL(url).toURI();
            Desktop desktop = Desktop.isDesktopSupported() ? Desktop.getDesktop() : null;
            if (desktop != null && desktop.isSupported(Desktop.Action.BROWSE)) {
                desktop.browse(uri);
            } else {
                throw new Exception("Desktop not supported, cannout open browser automatically");
            }
        }
    catch (Exception e)
        {
            /*
             *  I know this is bad practice 
             *  but we don't want to do anything clever for a specific error
             */
            e.printStackTrace();

            // Copy URL to the clipboard so the user can paste it into their browser
            StringSelection stringSelection = new StringSelection(url);
            Clipboard clpbrd = Toolkit.getDefaultToolkit().getSystemClipboard();
            clpbrd.setContents(stringSelection, null);
            // Notify the user of the failure
            WindowTools.informationWindow("This program just tried to open a webpage." + "\n"
                + "The URL has been copied to your clipboard, simply paste into your browser to access.",
                    "Webpage: " + url);
        }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T12:58:59.307

我已经成功使用了[BrowserLauncher2](http://browserlaunch2.sourceforge.net/)。它将在所有测试平台上调用默认浏览器。我用它来通过 JNLP 演示软件。该软件下载、运行并将用户的浏览器驱动到信息页面/反馈等。

我相信 JDK 1.4 及更高版本。

# c# - C#中的双引号和单引号有什么区别？

> ID：602033
> 
> 赞同：71
> 
> 时间：2009-03-02T11:47:19.493
> 
> 标签：c#

C#中的双引号和单引号有什么区别？

我编写了一个程序来计算文件中有多少单词

```
using System;
using System.IO;
namespace Consoleapp05
{
    class Program
    {
        public static void Main(string[] args)
        {
            StreamReader sr = new StreamReader(@"C:\words.txt");
            string text = sr.ReadToEnd();
            int howmany = 0;
            int howmany2 = 0;

            for(int i = 0; i < text.Length; i++)
            {
                if(text[i] == " ")
                {
                howmany++;
                }
            }
            howmany2 = howmany + 1;
            Console.WriteLine("It is {0} words in the file", howmany2);
            Console.ReadKey(true);
        }
    }
} 
```

由于双引号，这给了我一个错误。我的老师告诉我改用单引号，但他没有告诉我为什么。那么C#中的双引号和单引号有什么区别呢？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-03-02T11:48:51.393

单引号对单个字符（数据类型`char`）进行编码，而双引号对由多个字符组成的字符串进行编码。区别类似于单个整数和整数数组之间的区别。

```
char c = 'c';
string s = "s"; // String containing a single character.
System.Diagnostics.Debug.Assert(s.Length == 1);
char d = s[0];

int i = 42;
int[] a = new int[] { 42 }; // Array containing a single int.
System.Diagnostics.Debug.Assert(a.Length == 1);
int j = a[0]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-02T13:28:20.763

当您说 string s = "this string" 时，s[0] 是该字符串中特定索引处的字符（在本例中为 s[0] == 't'）。

因此，要回答您的问题，请使用双引号或单引号。您可以将以下内容视为相同的含义：

```
string s = " word word";

// Check for space as first character using single quotes
if(s[0] == ' ') {
    // Do something
}

// Check for space using string notation
if(s[0] == " "[0]) {
    // Do something
} 
```

如您所见，使用单引号来确定单个字符比尝试将我们的字符串转换为仅用于测试的字符要容易得多。

```
if(s[0] == " "[0]) {
    // Do something
} 
```

真的就像在说：

```
string space = " ";
if(s[0] == space[0]) {
    // Do something
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-15T23:08:39.113

单引号表示单个字符`'A'`，双引号将空终止符附加`'\0'`到字符串文字的末尾。

`" "`实际上`" \0"`是比预期大小大一个字节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T12:04:55.363

单引号而不是双引号？

在哪里？这里？

```
if(text[i] == " ") 
```

text[i] 给出一个字符/字节，并将其与（可能是 Unicode'd??）字符/字节数组进行比较。那效果不好。

说：比较 '1' 与 1
或 "1" 与 "one"
或 (2-1) 与 "eins"

您认为正确的答案是什么，还是没有任何有意义的答案？

除此之外：给定示例“words.txt”=，该程序也不能很好地使用单引号

这里是一个词
还是两个词或
更多词？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-02T12:05:15.830

您正在寻找空间。这可以作为字符串中的空格或字符来完成。所以在我看来，这会奏效。

（顺便说一句，如果文件中包含带点的句子，并且有人忘记在点后添加空格，则该单词不会被添加到总单词量中。）

# ruby - 在 Ruby 中设置？

> ID：602034
> 
> 赞同：35
> 
> 时间：2009-03-02T11:48:34.497
> 
> 标签：ruby, data-structures, set

我需要一个像集合的集合。基本上我正在扫描一个长字符串并将单词添加到集合中，但我希望能够检测到何时有重复。

如果集合不可用，那么在 Ruby 中执行此操作的最有效方法是什么？布朗尼点示例代码。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-03-02T12:40:33.437

ruby 中有一个 Set 类。你可以像这样使用它：

```
require 'set'

set = Set.new

string = "a very very long string"

string.scan(/\w+/).each do |word|
  unless set.add?( word )
    # logic here for the duplicates
  end
end 
```

虽然，我想知道您是否想在这种情况下计算实例，但以下示例会更好：

```
instances = Hash.new { |h, k| h[k] = 0 }

string.scan(/\w+/).each do |word|
  instances[word] += 1
end 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-02T11:57:25.350

从[文档](http://www.ruby-doc.org/core/classes/Array.html#M002237)中：

```
a = [ "a", "a", "b", "b", "c" ]
a.uniq  #gets you   ["a", "b", "c"]
a.uniq.uniq! #gets you nil (no duplicates :) 
```

# eclipse - Mac 上的 Eclipse... 使用 Windows 键盘快捷键？

> ID：602040
> 
> 赞同：24
> 
> 时间：2009-03-02T11:49:28.113
> 
> 标签：eclipse, macos

我是 Linux/Windows 上的 Eclipse 高级用户，键盘快捷键实际上是肌肉记忆。最近刚开始在 Mac 上开发（喜欢它！），使用 Eclipse，但真的被`command`键的使用绊倒了……并不是所有的快捷方式都一致地映射。

我已经重新映射了所有常用的快捷方式来使用`Ctrl`，但想知道是否有人找到了更有效和更完整的方法来做到这一点？有没有善良的灵魂通过所有的快捷方式并发布了一个准备好导入的首选项文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T12:35:39.500

而不是使用命令键，

[替代文字 http://www.pajbam.com/wp-content/uploads/2008/01/organize_imports-menu_item.png](http://www.pajbam.com/wp-content/uploads/2008/01/organize_imports-menu_item.png)

，可能是这篇[文章**Mac Keys for Eclipse**](http://www.martinkahr.com/2006/02/13/mac-keys-for-eclipse/)可能包含一个带有有趣快捷方式的[首选项文件](http://www.martinkahr.com/wp-content/uploads/2006/02/eclipse-mac-keys.epf.zip)（要导入）。

（首先保存您当前的偏好；））

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-07T21:40:50.020

我也有同样的情况……Mac 对我来说只是临时测试一些东西，而在它的时候，我不能使用 Linux/Windows 上可用的键绑定真的让我很恼火（而且在短暂的会话中，尝试毫无价值重新训练我的肌肉），所以，如果有人对此有偏好文件，我也会很感激。

* * *

编辑：刚刚发现：

[https://apple.stackexchange.com/questions/16135/remap-home-and-end-to-beginning-and-end-of-line](https://apple.stackexchange.com/questions/16135/remap-home-and-end-to-beginning-and-end-of-line)

并且在全球范围内重新映射事物有很大帮助（对于 Eclipse 本身，我只是继续手动编辑缺少的绑定——在系统绑定已经修复之后）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-10T02:37:38.233

I had the same problem when switching. While this does not answer your direct question, I would really recommend you to learn the Mac shortcuts.

The command key on a Mac is located better than Ctrl key, and pressing it causes less stress for your hand. After many years of developments I gradually start to feel pain in my hands, and I know (feel) that key placement matters — so save your health while it's fine.

The following mapping table might help you:

*   Ctrl -> Command (obviously)
*   Ctrl-Shift -> Command-Option (aka Command-Alt)
*   Alt-Shift -> no change (Option-Shift)

Today, even when I switch between Mac and Windows, I still have no problem with shortcuts. Turns out Mac and Windows Eclipse shortcuts can be different kinds of muscle memory.

Also I have once drawn a set of keyboard pictures with various Mac Eclipse shortcuts, available at [www.tarantsov.com/eclipse/shortcuts-illustrated/](http://www.tarantsov.com/eclipse/shortcuts-illustrated/) — maybe this can help you too.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-26T15:34:37.777

I believe this should do the trick In your Eclipse for Windows machine

Use: File->export->General and select 'Keys Preferences'

and import that file to your Eclipse for Mac

File -> import -> General

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T03:35:14.867

我强烈建议您按照有关 mac 快捷方式的流程进行操作。我是一个 Windows 用户，他切换到 Linux，最近又切换到 Mac。我在 eclipse 中使用，大多数涉及 ctrl 的命令只是更改为命令，例如：command + c 和 command + v 用于复制和粘贴。和 Command + Shift + r 替换。Command + B 构建所有。当然 FN + F5 刷新。除了 Mac 快捷方式通常适用于几乎所有 Mac 应用程序，因此不要浪费时间将每个应用程序切换为 Windows 之类的，因为您只关注缺少的 mac/os，而不是享受使用计算机的新方法。

# python - 我应该检查构造函数参数的类型（以及其他地方）吗？

> ID：602046
> 
> 赞同：15
> 
> 时间：2009-03-02T11:55:04.513
> 
> 标签：python, typechecking

Python 不鼓励检查类型。但在许多情况下，这可能很有用：

1.  检查构造函数参数。例如检查 foe Boolean、string、dict 等。如果我不这样做并将对象的成员设置为参数，它将在以后引起问题。

2.  检查函数参数。

3.  在属性中。如果有人设置了错误的值或不同的类型，我应该迅速做出反应。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T12:04:19.437

简单的答案是否，使用多态性、异常等**。**

1.  在构造函数参数的类型错误的情况下，执行依赖于特定类型参数的代码时将引发异常。如果这是一个奇怪的特定领域的事情，请提出您自己的异常。包围可能因 try-except 而失败的代码块并处理错误。所以最好使用异常处理。（*函数参数也是如此*）

2.  在属性中，同样的论点也适用。如果您正在验证接收到的值，请使用断言来检查其范围等。如果值的类型错误，它无论如何都会失败。然后，处理 AssertionError。

在 Python 中，您将程序员视为智能生物！只需很好地记录您的代码（使事情变得明显），在适当的地方引发异常，编写多态代码等。将异常处理（仅在适当的地方）/构造中的错误留给客户端代码。

**警告**
将异常处理留给客户端并不意味着您应该向不知情的用户扔掉很多垃圾错误。如果可能，请处理由于代码本身的错误构造或任何其他原因而可能发生的异常。你的代码应该是健壮的。如果您无法处理错误，请礼貌地通知用户/客户端代码程序员！

**注意**
一般来说，构造函数的错误参数并不是我太担心的事情。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-02T12:12:01.743

答案几乎总是“不”。Python、Ruby 和其他一些语言中的一般概念我们称为“ [Duck Typing](http://en.wikipedia.org/wiki/Duck_typing) ”。你不应该关心什么是什么，只关心它是如何工作的。换句话说，“如果你想要的只是嘎嘎叫的东西，你就不需要检查它是否真的是一只鸭子。”

在现实生活中，进行所有这些类型检查的问题是无法用替代实现替换输入。你可以检查字典，但我可能想传递一些不是字典但实现字典 API 的东西。

类型检查只检查代码中许多可能的错误之一。例如，它不包括范围检查（至少在 Python 中不包括）。对需要进行类型检查的断言的现代回应是，开发单元测试更有效，以确保不仅类型正确，而且功能正确。

另一种观点是，您应该像对待同意的成年人一样对待您的 API 用户，并相信他们能够正确使用 API。当然，有时输入检查会有所帮助，但这并不像您想象的那么普遍。一个例子是来自不受信任的来源的输入，例如来自公共网络。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T12:06:35.000

检查所有你喜欢的，你只需要明确。以下示例是标准库中[模块](http://svn.python.org/view/python/trunk/Lib/csv.py?view=markup)`extrasaction`的构造函数 - 它检查arg：

```
class DictWriter:
  def __init__(self, f, fieldnames, restval="", extrasaction="raise",
               dialect="excel", *args, **kwds):
      self.fieldnames = fieldnames    # list of keys for the dict
      self.restval = restval          # for writing short dicts
      if extrasaction.lower() not in ("raise", "ignore"):
          raise ValueError, \
                ("extrasaction (%s) must be 'raise' or 'ignore'" %
                 extrasaction)
      self.extrasaction = extrasaction
      self.writer = writer(f, dialect, *args, **kwds) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T13:42:06.597

这通常是一件好事。在 Python 中检查显式类型可能不是那么有用（正如其他人所说），但检查合法值可能是一个好主意。这是一个好主意的原因是软件会在更接近错误源的地方失败（它遵循快速失败原则）。此外，这些检查充当其他程序员和您自己的文档。更好的是，它是“可执行文档”，这很好，因为它是不会说谎的文档。

检查参数的一种快速而肮脏但合理的方法是使用断言：

```
def my_sqrt(x):
    assert x >= 0, "must be greater or equal to zero"
    # ... 
```

坚持你的论点是一种穷人的契约设计。（您可能想查找按合同设计；这很有趣。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T00:02:14.623

AFAIU，您希望确保某些对象的行为（“遵循界面”）比实际使用的时间更早。在您的示例中，您想知道对象在实例创建时是合适的，而不是在实际使用它们时。

请记住，我们在这里讨论的是 Python，我不会建议`assert`（如果`python -O`您的程序运行时环境变量 PYTHONOPTIMIZE 设置为 1 怎么办？）或检查特定类型（因为这不必要地限制了您可以使用的类型） ，但我会建议早期测试*功能*，大致如下：

```
def __init__(self, a_number, a_boolean, a_duck, a_sequence):

    self.a_number= a_number + 0

    self.a_boolean= not not a_boolean

    try:
        a_duck.quack
    except AttributeError:
        raise TypeError, "can't use it if it doesn't quack"
    else:
        self.a_duck= a_duck

    try:
        iter(a_sequence)
    except TypeError:
        raise TypeError, "expected an iterable sequence"
    else:
        self.a_sequence= a_sequence 
```

我`try… except… else`在这个建议中使用了，因为我只想在测试成功时设置实例成员*，*即使代码被更改或增加。显然，您不必这样做。

对于函数参数和设置属性，我不会提前进行这些测试，我只会使用提供的对象并对抛出的异常采取行动，除非在漫长的过程之后将使用可疑对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T13:41:16.800

“如果我不这样做并将对象的成员设置为参数，它将在以后引起问题。”

请非常清楚稍后将导致的“问题”的确切列表。

*   它根本不起作用吗？这就是 try/except 块的用途。

*   它会表现得“奇怪”吗？这非常罕见，并且仅限于“near-miss”类型和运算符。标准的例子是除法。如果您期望整数，但得到了浮点数，那么除法可能不会达到您想要的效果。但这可以通过 //, vs. / 除法运算符来解决。

*   会不会是完全错误，但似乎仍然完整？这真的很罕见，需要一个非常精心制作的类型，使用标准名称，但做了非标准的事情。例如

    ```
    class MyMaliciousList( list ):
        def append( self, value ):
            super( MyMaliciousList, self ).remove( value ) 
    ```

除此之外，很难有“以后引起问题”的事情。请用“问题”的具体示例更新您的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T00:14:47.090

正如 dalke 所说，答案几乎总是“不”。在 Python 中，您通常不关心 aa 参数*是*某种类型，而是关心它的*行为*类似于某种类型。这被称为“[鸭子打字](http://en.wikipedia.org/wiki/Duck%5Ftyping)”。有两种方法可以测试参数的*行为*是否与给定类型相似：（1）您可以按照预期的方式使用它，并在/如果没有时抛出异常，或者（2）您可以定义一个接口描述该类型应如何*表现*并测试与该接口的一致性。

[zope.interface](http://apidoc.zope.org/++apidoc++/Book/ifaceschema/interface/show.html)是我首选的 Python 接口系统，但还有其他几个。使用其中任何一个，您定义一个接口，然后声明给定类型符合该接口或定义一个适配器，将您的类型转换为符合该接口的东西。然后，您可以断言（或根据需要测试）参数提供（在 zope.interface 术语中）该接口。

# php - PHP 对象保持

> ID：602047
> 
> 赞同：2
> 
> 时间：2009-03-02T11:55:10.567
> 
> 标签：php, session, object, instance

假设在我的应用程序中，我在第 1 页创建了一个对象实例。然后用户转到应用程序的其他部分，我希望该实例保留。如何“保存”实例？会议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T11:59:50.460

是的，使用[会话](http://uk.php.net/manual/en/features.sessions.php)。

在页面开头调用[session_start() ，然后将对象存储为类似](http://php.net/session_start)`$_SESSION['myobject']=$myobject;`

后面的页面`$_SESSION['myobject']`也调用 session_start() 后才能访问

您需要确保使用该会话的任何页面都具有定义的对象类或能够[自动加载](http://uk.php.net/manual/en/language.oop5.autoload.php)它。

您的类还可以定义魔术方法[__sleep](http://uk.php.net/manual/en/language.oop5.magic.php#language.oop5.magic.sleep)和[__wakeup](http://uk.php.net/manual/en/language.oop5.magic.php#language.oop5.magic.sleep)，它们允许您清理您不想序列化的任何成员变量（例如资源，例如数据库句柄）。在 __wakeup 期间，您可以恢复这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T11:58:05.690

我的应用程序有两种方法：会话和数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T11:59:12.570

会话是的，但它将是具有相同属性而不是*相同*实例的新实例。其他选项是使用 O/R-Mapper 将对象存储在数据库中并将密钥保留在会话中，或者使用带有唯一密钥（例如会话 ID）的 memcached - 但这仍然不是*同一个*实例- 只是一个具有相同属性的实例。

如果您在 PHP 中的两个请求之间需要*完全相同*的对象实例，恐怕这是不可能的（并非*不可能*，一切都是可行的 - 但您必须在某种类型的应用程序服务器上运行 PHP）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T12:32:18.667

您基本上有两个选择：*服务器端状态*或*客户端状态*。

服务器端状态通常通过会话完成。这是最简单和最强大的解决方案，但它有一些缺点（并发性、无法随时间保持状态等）。

客户端状态可以通过 URL 维护 - 通常在查询字符串参数中。例如，要“记住”`$name`两个页面之间的变量，您可以在第一页上创建一个链接，如下所示：`http://www.example.org/second_page.php?name=Jimbo`，然后第二页可以通过`$_GET`. 这很难做到正确，并且它对您可以在页面之间传输多少状态有一些限制。出于这个原因，人们倾向于使用服务器端状态，即使客户端状态更合适。

# apache-flex - 在 Flex / Actionscript 中加载和播放嵌入的 SWF 文件

> ID：602057
> 
> 赞同：2
> 
> 时间：2009-03-02T11:58:24.350
> 
> 标签：apache-flex, actionscript, flash, embed, preloader

我正在尝试在我的 flex 应用程序中创建/使用预加载器。预加载器是一个 SWF 文件，它有 100 帧（加载器进度的每个百分比为 1）。基本上我试图在我的应用程序中嵌入这个 SWF 文件，将其显示在屏幕上，并在进度完成时更改显示的帧号。

我到目前为止的代码是（它扩展了 Canvas）：

```
[Embed("/../assets/preLoader.swf")]
private var SWFClass:Class;

private var _preLoader:MovieClip;

private var _progress:Number;

public function set progress(value:Number) : void {
    _progress = value;

    if(progress < 100) {
        _preLoader.gotoAndPlay(progress, null);
    }else {
        _preLoader.gotoAndStop(0, null);
    }
}   

[Bindable]
public function get progress() : Number {
    return _progress;
}

(Called on creationComplete event)          
private function init() : void {
    _preLoader = MovieClip(new SWFClass());

    this.addChild(_preLoader);

    _preLoader.play();
} 
```

我得到的错误是：

```
TypeError: Error #1034: Type Coercion failed: cannot convert widgets::PreLoader_SWFClass@30b3be51 to mx.core.IUIComponent.at mx.core::Container/http://www.adobe.com/2006/flex/mx/internal::addingChild()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:3259] 
```

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T12:01:07.337

您需要有一个`MovieClip`实现 的包装器`IUIComponent`才能传递给`addChild()`. 从`addChild()` [文档](http://livedocs.adobe.com/flex/3/langref/mx/core/Container.html#addChild())中：

> 注意：虽然该方法的子参数指定为 DisplayObject 类型，但该参数必须实现 IUIComponent 接口才能添加为容器的子级。所有 Flex 组件都实现了这个接口。

你将需要这样的东西：

```
public class MovieClipUIComponent extends UIComponent {
   public function MovieClipUIComponent (mc:MovieClip) {
      super ();

      mcHeight = mc.height;
      mcWidth = mc.width;

      // add your own magic

      addChild (mc);
   }
} 
```

警告：未经测试的代码，应该只给你一个想法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-27T14:57:05.063

希望这项工作我试过了。

```
[Embed(source="assets/yourSWF.swf", mimeType="application/octet-stream")]
public var SWF:Class; 
```

* * *

```
_swfLoader = new Loader();
//nothing to do onComplete or onProgress method just to debug
// Add complete event listener
_swfLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);
// Add progress event listener
_swfLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);

// Add error event listener. Critical if you don't want run time errors if there
// are problems loading the file.
_swfLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onError);

// Incase of loading Flex. Very important.
_swfLoader.addEventListener("mx.managers.SystemManager.isBootstrapRoot", systemManagerHandler);
_swfLoader.addEventListener("mx.managers.SystemManager.isStageRoot", systemManagerHandler);

// Load on the loader with a new URLRequest instance passing the path to
// it's constructor.
_swfLoader.loadBytes(new SWF());

// We have to addd the loader so it creation is done.
addChild(_swfLoader); 
```

* * *

```
private function systemManagerHandler(e:Event):void {
            // Prevent default stops default behaviour here and thus stops some potential
            // run time errors.         
            e.preventDefault();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T23:53:38.737

使用 sprite 而不是 Canvas 作为基类。这样做的两个原因：

1.  Canvas 有很多依赖项（多达 10 万多个 flex 组件）。在显示预加载器之前，您不想等待所有这些加载

2.  Canvas 是 UIComponent 容器。当你想要布局 UIComponents 时使用它。在您的情况下，您不需要复杂的画布布局逻辑 - 您只需要显示一个 MovieClip。所以不要使用画布。

为了回答您最初的问题，SWFLoader 和 Image 是知道如何显示位图和影片剪辑的 UIComponent。改为执行以下操作：

```
var img:Image = new Image();
img.source = _preloader;
this.addChild(img); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T02:27:59.980

查看[Preloader](http://livedocs.adobe.com/flex/3/langref/mx/preloaders/Preloader.html)类和 Application 类的[preloader](http://livedocs.adobe.com/flex/3/langref/mx/core/Application.html#preloader)属性。

正如文档所说，您绝对不应该为预加载器扩展 Flex UIComponent（或 Image 或 SWFLoader）类。

以下是一些有关如何自定义预加载器的示例：

[http://www.pathf.com/blogs/2008/08/custom-flex-3-lightweight-preloader-with-source-code/](http://www.pathf.com/blogs/2008/08/custom-flex-3-lightweight-preloader-with-source-code/)

[http://groups.adobe.com/posts/15d371c71d](http://groups.adobe.com/posts/15d371c71d)

[http://www.webapper.net/index.cfm/2008/1/17/Flex-NotSo-Custom-Preloader](http://www.webapper.net/index.cfm/2008/1/17/Flex-NotSo-Custom-Preloader)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T08:55:22.643

[我从这个链接http://askmeflash.com/article_m.php?p=article&id=7](http://askmeflash.com/article_m.php?p=article&id=7)找到了使用外部 swf 代码的自定义预加载器

# powershell - 针对 powershell 的 x64 与 x86 可变性进行编程的最佳方法是什么

> ID：602060
> 
> 赞同：9
> 
> 时间：2009-03-02T11:59:08.917
> 
> 标签：powershell

我们有几个脚本用于安装和配置支持我们维护的系统的依赖项。每当我们建立开发、测试、演示、训练、生产等环境时，我们都会运行这些。我们经常发现我们必须处理 x64 与 x86 架构，尤其是在涉及 powershell 脚本的地方。

例如，我有一个脚本，它使用[Windows Installer PowerShell Extensions](http://www.codeplex.com/psmsi)来确定是否已安装程序/补丁。如果不显式调用 PowerShell (x86)，则该脚本无法在 x64 环境中运行，默认情况下，PowerShell 不在路径中。当我们将这些脚本移植到 x64 平台时，最好维护一组脚本，这些脚本可以在两种架构的 powershell 中工作，并且只在需要时调用 x86 代码。

有谁知道这样做的策略？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-02T13:03:41.103

我的配置脚本经常遇到这个问题。我采取的基本方法是

1.  使用几个函数来测试我是否在 64 位环境中（[http://blogs.msdn.com/jaredpar/archive/2008/10/16/powershell-and-64-bit-windows-helper-functions.aspx](http://blogs.msdn.com/jaredpar/archive/2008/10/16/powershell-and-64-bit-windows-helper-functions.aspx) )
2.  根据特定脚本的需要调用 x86/x64 PowerShell

不幸的是，其中很多都是以蛮力的方式完成的。每个与 x86/x64 相关的特定配置条目本质上都有 2 个代码路径（每个架构一个）。

我能做的唯一真正的例外是测试磁盘上某些程序的存在。我有一个方便的函数（Get-ProgramFiles32），它可以很容易地测试程序。

```
if ( test-path (join-path Get-ProgramFiles32 "subversion") ) { ... 
```

以下是我在通用库中处理 32/64 位差异的所有辅助函数。

```
# Get the path where powershell resides.  If the caller passes -use32 then 
# make sure we are returning back a 32 bit version of powershell regardless
# of the current machine architecture
function Get-PowerShellPath() {
    param ( [switch]$use32=$false,
            [string]$version="1.0" )

    if ( $use32 -and (test-win64machine) ) {
        return (join-path $env:windir "syswow64\WindowsPowerShell\v$version\powershell.exe")
    }

    return (join-path $env:windir "System32\WindowsPowerShell\v$version\powershell.exe")
}

# Is this a Win64 machine regardless of whether or not we are currently 
# running in a 64 bit mode 
function Test-Win64Machine() {
    return test-path (join-path $env:WinDir "SysWow64") 
}

# Is this a Wow64 powershell host
function Test-Wow64() {
    return (Test-Win32) -and (test-path env:\PROCESSOR_ARCHITEW6432)
}

# Is this a 64 bit process
function Test-Win64() {
    return [IntPtr]::size -eq 8
}

# Is this a 32 bit process
function Test-Win32() {
    return [IntPtr]::size -eq 4
}

function Get-ProgramFiles32() {
    if (Test-Win64 ) {
        return ${env:ProgramFiles(x86)}
    }

    return $env:ProgramFiles
}

function Invoke-Admin() {
    param ( [string]$program = $(throw "Please specify a program" ),
            [string]$argumentString = "",
            [switch]$waitForExit )

    $psi = new-object "Diagnostics.ProcessStartInfo"
    $psi.FileName = $program 
    $psi.Arguments = $argumentString
    $psi.Verb = "runas"
    $proc = [Diagnostics.Process]::Start($psi)
    if ( $waitForExit ) {
        $proc.WaitForExit();
    }
}

# Run the specified script as an administrator
function Invoke-ScriptAdmin() {
    param ( [string]$scriptPath = $(throw "Please specify a script"),
            [switch]$waitForExit,
            [switch]$use32=$false )

    $argString = ""
    for ( $i = 0; $i -lt $args.Length; $i++ ) {
        $argString += $args[$i]
        if ( ($i + 1) -lt $args.Length ) {
            $argString += " "
        }
    }

    $p = "-Command & "
    $p += resolve-path($scriptPath)
    $p += " $argString" 

    $psPath = Get-PowershellPath -use32:$use32
    write-debug ("Running: $psPath $p")
    Invoke-Admin $psPath $p -waitForExit:$waitForExit
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T12:04:03.977

[msgoodies 博客](http://msgoodies.blogspot.com/)有[这个关于确定架构的](http://msgoodies.blogspot.com/2008/05/is-this-powershell-session-32-bit-or-64.html)建议。可以使用这种方法来确定架构并在已知不兼容时调用 x86 powershell。

# sharepoint - 如何在 SharePoint 中跨站点和文档库移动文件夹和文件并维护其版本历史记录？

> ID：602062
> 
> 赞同：5
> 
> 时间：2009-03-02T11:59:27.497
> 
> 标签：sharepoint

我正在尝试在同一 SharePoint 2007 安装中跨站点移动文件夹。一个关键的要求是维护版本历史。

我尝试过的一种方法是在源站点中创建一个新的文档库并将文件夹移动到其中，然后将文档库移动到目标站点。我已经在资源管理器视图中使用剪切和粘贴完成了文件移动。

不幸的是，它破坏了文件的版本历史记录——文件历史记录中的每个版本都以相同的日期结束（谁知道日期来自哪里——它不在文件的原始历史记录中），尽管修改者和其他元数据很好。

我使用以下内容来移动文档库：

*   SP 内容部署向导 1.1 由 Chris O'Brien ([网站](http://www.codeplex.com/SPDeploymentWizard))
*   STSADM.exe 使用 Gary Lapointe 的扩展 ( [site](http://stsadm.blogspot.com/) )，特别是以下命令：gl-exportlist、gl-importlist、gl-copylist。

不幸的是，这些工具不适用于文件夹级别。

我的下一步是着眼于为解决方案编程，这是我一直在避免的，因为我是 SharePoint 新手，对它的编程一无所知。

谁能帮我？具体来说，我欢迎：

*   关于如何在不编写自定义解决方案的情况下执行移动的任何建议
*   任何可以做到这一点的工具的建议，无论是否免费（到目前为止，我所看到的只是 AvePoint 的 DocAve，它只能在站点级别管理内容，所以它对我没有帮助）
*   任何可以帮助我开发自定义解决方案的技巧、文章、代码等。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-26T14:11:52.167

[http://dandd.codeplex.com/](http://dandd.codeplex.com/)这个解决方案可以做到这一点，但它只适用于 sp2010 无论如何看看它可能会给你一个提示如何使用 Web 服务来解决你的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T17:05:10.743

SharePoint 不支持您需要执行的操作，以及许多其他跨站点和跨场操作。让我们希望这将在未来的版本中得到改善。

您应该查看来自[AvePoint](http://www.avepoint.com/)的产品。它们具有许多这些功能以及更多功能，但据称价格昂贵。如果您对第 3 方依赖项没有疑虑，它们会提供 API。您提到 DocAve 只是单站点，但事实并非如此。您可能想联系该公司以了解更多信息。

编程方法要求您使用对象模型 API 或 Web 服务 API 构建所有自己的脚手架。Web 服务 API 更易于使用，并允许您的代码更加独立于位置，但如果您需要精细控制，它缺少太多功能。除了文件和文件夹之外，您还需要担心用户、内容类型和应用程序需要的任何其他列表项。

对象模型方法要求代码在作为农场成员的机器上运行。这意味着您将需要在多场部署中使用本地“代理”并创建关联的分发逻辑。

所有这些听起来可能令人生畏，虽然它不是微不足道的，但可以做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T18:53:07.673

不幸的是，当我为 MOSS 创建归档工具时，我不得不编写这个解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T16:19:02.367

在 spListItem 对象上使用 CopyTo() 方法的一个不错的 PowerShell 脚本应该是一个很好的起点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T10:10:58.420

你有发布页面还是只有项目。我团队中一些技术更高的人在移动版本历史记录中的发布页面和日期时遇到了问题。我想我们花了 5 天时间尝试使用 Elevated privs、webservices 等使用 Timer 作业。

有时您只是希望 Sharepoint 是一个简单的 SQL Server 应用程序，您只需要更改一个字段......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T22:38:07.723

在这种情况下，我使用 Tzunami Deployer 取得了成功。在我的博客上，我[发布了一些我的截图经验](http://blogs.microlinkllc.com/tresing/archive/2008/10/02/sharepoint-2007-upgrade-with-a-domain-migration.aspx)。我发现他们的支持非常好，即使在试用期间也是如此。可以免费试用。

# oop - 在设计对象及其关系时如何在组合和泛化之间做出决定？

> ID：602063
> 
> 赞同：1
> 
> 时间：2009-03-02T11:59:38.683
> 
> 标签：oop, class-design

我想从 stackoverflow 社区寻求这个答案，即我们在设计类时如何决定进行组合或泛化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T12:23:53.460

问问自己这两个类之间的关系是“is-a”还是“has-a”类型

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T15:32:43.413

当您有一个包含一组其他对象的类时，您可以使用组合，无论数量。当您的类与一组对象共享公共属性但也可以具有其他不同的属性或行为时，请使用泛化。

例如，汽车具有引擎、车轮等组件。这是一种组合关系。但是 Vehicle 是 Car 的概括，因为您可以拥有具有不同属性的其他类型的 Vehicle，例如 Truck。Car 和 Truck 是 Vehicle 的派生类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T20:25:40.933

如果我们谈论公共继承 (IS_A)，关键是要了解 Liskov 替换原则以及它对继承的含义。特别是，这意味着 IS-A 关系依赖于上下文，这是公共继承中经常被忽视的一个方面。

要使用上面的示例，Car 和 Truck 类只能从 Vehicle 派生，前提是它们可以在任何为使用 Vehicle 类而编写的程序中替换 Vehicle 类而不影响调用代码。

如果我们谈论的是实现继承（也就是 C++ 中的私有继承），您应该更喜欢组合而不是继承作为重用机制。

# javascript - 如何清除 AJAX GET 调用的 HTTP 标头？

> ID：602065
> 
> 赞同：1
> 
> 时间：2009-03-02T12:00:02.737
> 
> 标签：javascript, ajax, internet-explorer, http-headers, xmlhttprequest

我开发了一个解决方案，它依赖于 AJAX 调用来检索信息并每 10 秒更新一次客户端页面。这工作正常，但我担心代码的可伸缩性，因为标头的数量和长度从客户端传递到服务器并再次返回。我已经删除了服务器端的一些冗余标头，主要是与 ASP.NET 相关的，现在我正试图减少来自客户端的标头。

我公司使用的浏览器是IE（6版本，即将升级到7）。这是我当前代码的近似值：

```
var xmlHTTP = new ActiveXObject('Microsoft.XMLHTTP');

xmlHTTP.onreadystatechange = function() {
    if ((xmlHTTP.readyState == 4) && (xmlHTTP.status == 200)) {
        myCallbackFunction(xmlHTTP);
    }
};

xmlHTTP.open('GET', 'myUrl.aspx');

try {
    xmlHTTP.setRequestHeader("User-Agent", ".");
    xmlHTTP.setRequestHeader("Accept", ".");
    xmlHTTP.setRequestHeader("Accept-Language", ".");
    xmlHTTP.setRequestHeader("Content-Type", ".");
} catch(e) {}

xmlHTTP.send(); 
```

虽然[我已经读过](http://blog.mibbit.com/?p=143)可以清除其中一些标头，但我还没有找到一种在 IE6 中有效的方法。将它们设置为 null 会导致类型不匹配异常，因此我最终将它们替换为 '.' 暂且。是否有另一种清除它们的方法或减少提交的 HTTP 标头的替代方法？

此外，似乎根本无法替换或缩短“推荐人”标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T12:21:41.173

根据[WD 规格](http://www.w3.org/TR/XMLHttpRequest/#setrequestheader)

> 如果作为参数给出的 HTTP 标头已经是请求标头列表的一部分，则 setRequestHeader() 方法会附加一个值。

也就是说，您只能添加标题，而不能替换它们。

This doesn't completely match current browser behaviour, but it may be where browsers will be headed, in which case any efforts on this front are a waste of time in the long term. In any case current browser behaviour with setting headers is very varied and generally can't be relied upon.

> There seems to be no way of replacing or shortening the 'Referrer' header at all.

That wouldn't surprise me, given that some people misguidedly use ‘Referer’ [sic] as an access-control mechanism.

You could try to make sure that the current page URL wasn't excessively long, but to be honest all this smells of premature optimisation to me. Whatever you do your request is going to fit within one IP packet, so there's not gonig to be a big visible performance difference.

It may be worthwhile for Mibbit (as mentioned on the blog you linked) to try this stuff, because Mibbit draws a quite staggering amount of traffic, but for a simple company-wide application I don't think the cross-browser-and-proxy-testing-burden:end-user-benefit ratio of messing with the headers is worth it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T12:47:29.847

IE 6 and older versions use the ActiveXObject created from `MSXML.XMLHTTP` (actually derived from [IXMLHTTPRequest](http://msdn.microsoft.com/en-us/library/ms759148.aspx)), whereas IE 7 and other modern browsers such as Mozilla use an intrinsic object called `XmlHttpRequest`. This is probably the reason why you cannot set the Request headers to `null` for the MSXML implementation but you can for the in-built object.

Therefore, I do not believe that there is any way to collectively clear all the headers. The link to Mibbit that you present only provides a function to set all the headers to null one by one. For normal scenarios, cutting down on headers may prove to be a very very insignificant of reducing traffic load.

That said, I am curious to know why you are setting the request headers to `"."` rather than an empty string `""`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:33:58.400

I would forgo this kind of micro-optimizations and look into a push model instead. By way of a starting place:

*   Flash can create persistent sockets, and broker the events into javascript.
*   You could implement Bidirectional-streams Over Synchronous HTTP (BOSH). See [http://xmpp.org/extensions/xep-0124.html](http://xmpp.org/extensions/xep-0124.html)

Both of these are typically paired with an XMPP server on the back-end.

# c# - 为什么 C# 不支持首次通过异常过滤？

> ID：602066
> 
> 赞同：30
> 
> 时间：2009-03-02T12:00:12.677
> 
> 标签：c#, vb.net, exception, finally

注意：这不是[Jeff 问题的重复](https://stackoverflow.com/questions/181188/c-equivalent-to-vb-net-catch-when)。

那个问题问“是等价的吗？” 我知道没有，我想知道为什么！

我问的原因是我才刚刚清楚它的重要性，结论对我来说似乎很奇怪。

Microsoft 企业库的异常处理块建议我们使用这种模式：

```
catch (Exception x)
{
    if (ExceptionPolicy.HandleException(x, ExceptionPolicies.MyPolicy))
        throw;

    // recover from x somehow
} 
```

该政策是在 XML 文件中定义的，这意味着如果客户有问题，我们可以修改政策以帮助追踪（或可能掩盖）问题，以便快速解决问题，直到我们妥善处理- 这可能涉及与第 3 方争论，这一切都是谁的错。

这基本上承认了一个简单的事实，即在实际应用程序中，如果没有这样的工具，几乎不可能管理异常类型的数量及其“可恢复性”状态。

与此同时，MS 的 CLR 团队表示这不是一个选项，事实证明这些人知道他们在说什么！问题是在`catch`块运行之前，`finally`嵌套在块内的任何块`try`都将被执行。因此，这些`finally`块可以执行以下任何操作：

*   无害地修改程序状态（呸，幸运）。
*   丢弃客户数据中的一些重要内容，因为程序状态被搞砸到了未知的程度。
*   伪装或破坏我们需要诊断问题的重要证据——尤其是当我们谈论对本机代码的调用时。
*   抛出*另一个*例外，增加了普遍的混乱和痛苦。

请注意，`using`语句和 C++/CLI 析构函数是基于`try`/构建的`finally`，因此它们也会受到影响。

很明显，过滤异常的`catch`/`throw`模式并不好。真正需要的是一种通过策略过滤异常的方法，而不是实际捕获它们并因此触发`finally`块的执行，除非我们找到一个告诉我们异常可以安全恢复的策略。

CLR 团队最近在博客中谈到了这一点：

*   [Catch、Rethrow 和 Filters - 你为什么要关心？](http://blogs.msdn.com/clrteam/archive/2009/02/05/catch-rethrow-and-filters-why-you-should-care.aspx)
*   [为什么 catch(Exception)/empty catch 不好](http://blogs.msdn.com/clrteam/archive/2009/02/19/why-catch-exception-empty-catch-is-bad.aspx)

结果是我们必须在 VB.NET 中编写一个辅助函数，以允许我们从 C# 访问这一重要功能。存在问题的重要线索是 BCL 中有执行此操作的代码。很多人都写过关于这样做的博客，但他们很少提到关于`try`/`finally`块的事情，这是杀手。

我想知道的是：

*   人们是否从 C# 团队收到了有关此主题的任何公开声明或直接电子邮件？
*   是否有任何现有的 Microsoft Connect 建议要求这样做？我听说过关于它们的谣言，但没有任何可能的关键词出现。

**更新：**如上所述，我已经在 Microsoft Connect 上进行了搜索，但没有找到任何东西。我也（毫不奇怪）谷歌搜索。我只发现有人[解释他们为什么需要这个特性](http://www.codeproject.com/KB/cs/csmverrorhandling.aspx)，或者指出[它在 VB.NET 中的优点](http://blogs.msdn.com/vbteam/archive/2008/10/09/vb-catch-when-why-so-special.aspx)，或者徒劳地希望它会被[添加到未来的 C# 版本中](http://gregbeech.com/blogs/tech/archive/2006/01/03/why-doesn-t-c-have-exception-filters.aspx)，或者[解决它](http://blogs.msdn.com/junfeng/archive/2008/12/08/exception-filter.aspx)，以及大量[误导性的建议](http://msdn.microsoft.com/en-us/magazine/cc300489.aspx). 但没有说明从所有当前版本的 C# 中省略它的理由。我询问现有 Connect 问题的原因是（a）我不会创建不必要的副本，并且（b）如果我必须创建一个，我可以告诉感兴趣的人。

**更新 2：**从C# 团队的前任Eric Gunnerson 那里找到[一篇有趣的旧博客文章：](http://blogs.msdn.com/ericgu/archive/2004/01/12/57985.aspx)

> “是的，能够对 catch 设置条件比必须自己编写测试更方便一些，但它并不能真正让你做任何新的事情。”

在向我正确解释之前，这是我的假设！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-07T20:22:33.160

至于任何现有的连接错误。以下问题处理异常过滤器。用户没有明确声明他们希望它们在执行时成为一个实际的过滤器，但恕我直言，这是逻辑所暗示的。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=401668](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=401668)

但是，除了那个问题之外，我找不到或知道与您正在寻找的内容相关的任何问题。我认为最好有一个单独的问题，明确指出需要 VB.Net 样式的异常过滤器。

如果您已经尽职尽责地寻找现有问题，我不会太担心引入重复问题。如果存在欺骗，Mads 将相应地欺骗它并将您链接到主要请求。

至于从 C# 团队获得官方回复的部分，当您 1) 提交连接错误或 2) 被主要错误欺骗时，您可能会得到。我真的怀疑现在有一个官方的理由/理由。

以下是我对这个问题的**猜测**：我的猜测是，这个特性根本不在最初的 C# 1.0 特性集中，并且从那时起，就没有足够的需求将其融入语言。C# 和 VB 团队在每个船周期开始时花费了令人难以置信的大量时间对语言特性进行排序。我们有时不得不做出一些**非常**困难的削减。如果没有足够的需求，一个特性很少有机会进入语言。

直到最近，我敢打赌，你很难找到十分之一的人了解 VB.Net 的 Try/When 和在 C# catch 块中使用普通的旧 if 语句之间的区别。最近它似乎更多地出现在人们的脑海中，所以也许它会成为未来版本的语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T06:07:08.927

使用[异常过滤器注入](http://code.msdn.microsoft.com/ExceptionFilterInjct)可能比使用委托解决方法更简单。

要真正回答您的问题，您需要来自 Anders Hejlsberg 或参加原始设计会议的人员的回复。下次面试[C# 设计团队时，](http://channel9.msdn.com/posts/Charles/C-40-Meet-the-Design-Team/)您可以尝试看看是否可以让第 9 频道的面试官问到它。

我猜想在做出最初的决定时，异常过滤器被视为一种不必要的并发症，可能弊大于利。在这次采访中，关于不支持受检异常的决定，您当然可以看到对未经证实的功能保持“沉默”的愿望：[受检异常的麻烦](http://www.artima.com/intv/handcuffsP.html) 。

我认为 postmoterm 诊断场景强烈支持以语言提供对异常过滤器的访问。但是，当时可能尚未阐明这些情况。此外，这些场景确实需要适当的工具支持，这在 V1 中肯定不可用。最后，添加这个我们没有考虑的功能可能会有很大的负面影响。

如果没有关于此的连接错误，您应该输入一个并鼓励其他人投票。[我建议要求访问 CLR 功能，而不是尝试设计它如何适应语言。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T18:00:12.237

我也不相信 Java 有过滤器选项。猜测如果是这样，我们也会在 C# 中看到一个。鉴于 VB 团队从一张白纸开始，VB.net 可能有一个机会。

就在 C# 的未来版本中获得此选项而言，可能对您有利的一件事是，Microsoft 的既定目标是在 C# 和 VB.net 的未来版本中保持语言特性之间的一致性。我会在此基础上提出我的论点。

[http://www.chriseargle.com/post/2009/01/Parity-Between-Languages.aspx](http://www.chriseargle.com/post/2009/01/Parity-Between-Languages.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T17:29:30.077

关于第一个问题，如果有公开声明，那么它很可能被放在网络上的某个地方，在这种情况下，谷歌应该出现一些东西（如果存在的话）。

如果它是与 C# 团队的直接电子邮件，那么它很可能处于 NDA 之下，因此无论如何它都无法发布。

对于第二个问题，Microsoft Connect 上有一个搜索功能，他们会在输入新建议之前提示您使用该功能。如果你找不到它，那么可能没有一个。

我的建议是提出建议，然后推广它以让其他人参与进来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T08:01:58.417

据我了解，在重新抛出的那一刻，内部函数中的 finally 处理程序被执行，这就是给你带来问题的原因。

但是，假设您有一个异常过滤器，它通过异常而不实际重新抛出它。您仍然必须在某个地方以某种方式处理它，并且您将在那里遇到相同类型的问题（最终效果）。

因此，除非我误解了某些东西，否则拥有语言支持的异常过滤器并没有很大的好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-21T22:02:21.367

我可以想到 C# 中没有异常过滤的至少两个原因

1.  允许异常过滤器可能会鼓励程序员在第一次异常处理期间做一些当时不安全的事情，即使它们可以在“catch”或“finally”中安全地完成。例如，如果“try”块中的代码获取了一个锁并在持有该锁时抛出了一个异常，则该锁将在执行外部异常过滤器期间被持有，但会在外部“catch”或“finally”之前被释放" 块运行。此外，至少在我上次检查时，发生在异常过滤器中但未在其中捕获的异常被默默地扼杀了——这是一种丑陋的情况。
2.  C# 的实现者的愿景是让他们的语言“与框架无关”。如果 C# 支持 .net 首次通过异常过滤，则使用该功能的程序可能无法在以不同方式处理异常的框架上使用。这与 C# 禁止程序覆盖 `Object.Finalize()` 的原因相同。虽然围绕 `Object.Finalize()` 的推理是有缺陷的（正确使用析构函数需要使用其他特定于平台的方法，因此要求对 `Object.Finalize()` 使用析构函数语法除了 t77o 鼓励编写有缺陷的软件）关于异常过滤器的推理确实有一定的意义。另一方面，处理该问题的正确方法是公开一些与异常过滤器相关的功能，即使没有

我真的很想在 C# 和 vb 中看到的一个功能，它需要使用异常过滤器来实现，但不需要直接公开它们，它将是`Exception`一个块的可选参数`finally`。`null`如果没有发生未捕获的异常，则此参数将是；否则它将持有有问题的例外。这将允许程序在发生异常时想要做某事但实际上并没有“处理”它的情况。在大多数情况下，该`Exception`参数不会用于除检查之外的任何事情`null`（这意味着该功能将等同于公开`fault`块），但它会在清理期间发生异常的情况下提供优势。目前，如果在一个过程中发生异常`finally`块，有必要要么扼杀`finally`-block 异常或覆盖预先存在的异常。让`finally`块代码可以使用较早的异常将使其能够包装或记录它。

# ruby - 使用 ruby (watir) 进行自动完成下拉测试

> ID：602069
> 
> 赞同：3
> 
> 时间：2009-03-02T12:02:03.093
> 
> 标签：ruby, watir

我正在尝试通过编写 feks 创建填充文本字段的 watir 测试

“lon”并等待下拉菜单被触发，然后单击列表中的第一个元素。

写“lon”应该会触发许多选项，例如“London, England, Storbritannia”, London, Kentucky, USA 等等。watir 有可能做到这一点吗？提前谢谢。

到目前为止，这就是我的代码的样子，尽管它不起作用，我想知道我在哪里遗漏了一些东西。

def test_scriptflight_autocomplete @site.navigate_to(:travel, :flight) from_field = @site.ie.text_field(:id, "locOriginName") to_field = @site.ie.text_field(:id, 'locDestinationName') from_field.set('奥斯陆')

```
# need to fire a key press event after setting the text since the js is handling
# trigger the autocomplete (requires a 'keydown')
from_field.fire_event('onkeydown')   

# wait until the autocomplete gets populated with the AJAX call
@site.ie.wait_until{@site.ie.div(:id, 'onlinesearch').lis.length > 0}
puts @site.ie.div(:id, 'locOriginName ').lis.length
puts @site.ie.div(:id, 'locOriginName').li(:index, 5).text

# find the li you want to select in the autocomplete list and click it
@site.ie.div(:id, 'from-field').li(:text, 'Oslo, Oslo, Norge').click 
```

结尾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T14:55:02.497

我和工作中的一位同事（Magnar）发现了这个博客，帮助我们找到了我正在寻找的答案。

[http://blog.saush.com/2008/05/using-rspec-and-watir-for-functional-testing-in-web-applications/](http://blog.saush.com/2008/05/using-rspec-and-watir-for-functional-testing-in-web-applications/)

```
class Watir::IE  
    def fire_keydown_on(element_id, key)  
        ie.Document.parentWindow.execScript("key = document.createEventObject(); key.keyCode = #{key}")  
        ie.Document.parentWindow.execScript("document.getElementById('#{element_id}').fireEvent('onkeydown', key)")  
    end  
end 
```

从博客：

我们刚刚为 IE 类添加了一个新方法“fire_keydown_on”，它接受元素 id 和键。此方法调用 Javascript 来创建事件对象（顺便说一下，这只适用于 IE）并将键代码设置为“13”，即回车键（回车键）。它调用 Javascript 来获取 HTML 元素（使用元素 id）并在其上触发 'onkeydown' 事件，同时传递它刚刚创建的事件对象。

# css - 更改禁用的 IE 文本框中的字体颜色

> ID：602070
> 
> 赞同：34
> 
> 时间：2009-03-02T12:02:26.697
> 
> 标签：css

我注意到您可以更改在 Firefox 中禁用的文本框中的文本颜色，应用一个简单的类，但在 IE 6/7 中无法做到这一点。有没有人有一个优雅的解决方案来实现这一点。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-03-02T13:09:42.430

> 我注意到您可以更改在 Firefox 中禁用的文本框中的文本颜色

我认为这个问题想说的是：

```
<textarea disabled="disabled" style="color: red;">Hello</textarea> 
```

结果在 IE 中显示为灰色文本，而在 Fox 中显示为红色。FWIW，Opera 也给出灰色，而 WebKit 浏览器给出红色。

这是一个纯 CSS 问题，与根据操作系统的小部件集呈现多少表单字段以及根据 CSS 规则呈现多少表单字段有关。这一直是跨浏览器差异很大的一个领域。脚本是不相关的，尽管 SO 希望“使用 jQuery”作为每个问题的答案。

通常的解决方法是使用 'readonly' 而不是 'disabled'，然后使用样式（例如，基于 'class="disabled"'）来重现您想要的任何阴影禁用效果。'readonly' 控件不会变成操作系统级禁用的小部件，让您有更多的自由度来设置它们的样式。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-11T15:31:11.267

     应该注意的是，使用该属性会导致在表单提交期间不提交**`disabled`**底层元素，因为控件被提交给服务器。因此，如果您的服务器代码不期望来自该控件的值，则不应使用。**`<input>`****`readonly`****`readonly`**

     根据我的经验，试图破解某些东西以获得可接受的演示通常是不值得的。我建议您更改您的 CSS，以便固定的 IE 禁用文本样式不会与您的底层控件样式冲突，或者您使用样式文本代替控件（因为禁用的控件无论如何都不能成功提交）。使用浏览器而不是反对它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-26T02:23:00.413

我对`<select>`IE10 中的元素有同样的问题并找到了解决方案：

[http://jsbin.com/ujapog/90](http://jsbin.com/ujapog/90)

有一个 Microsoft psuedo-element 允许修改文本颜色：

```
select[disabled='disabled']::-ms-value {
    color: #000;
} 
```

规则必须是独立的，否则其他浏览器会因为语法错误而忽略整个规则。有关其他 Internet Explorer 仅伪元素，请参阅[http://msdn.microsoft.com/en-us/library/ie/hh869604(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh869604(v=vs.85).aspx)。

编辑：`-ms-value`伪元素是在 IE10 中引入的，因此不适用于早期版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-30T12:11:35.140

IE 的问题是它不能为禁用的控件应用样式，这就是为什么我们首先需要从我们的文本框中删除它，然后添加我们的样式并禁用对控件的关注。我也试过 unbind('focus') 但它没有用。

所以我为此使用了 JQUERY：

```
var disabledControls = $("input:disabled, textarea:disabled");
    disabledControls.removeAttr('disabled');
    disabledControls.addClass("is-disabled");
    disabledControls.focus(function() {
    this.blur();
}); 
```

CSS类：

```
.is-disabled {
    background-color: #EBEBEB;
    color: black !important;   
} 
```

在 IE8\9 和 Chrome 中完美运行...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-13T13:15:47.703

您可以使用以下代码来模拟禁用字段的行为：

```
// find all disabled fields
$("input:disabled, textarea:disabled, select:disabled").each(function(index){
    // add the class is_disabled
    $(this).addClass("is_disabled");
    // remove the attribut disabled
    $(this).removeAttr('disabled');
    // add new attribut readonly
    $(this).attr('readOnly', 'readOnly');
});
// on submit remove all fields which are still with class is_disabled
$('form').submit(function() {
    // find all fields with class is_isabled
    $("input.is_disabled, textarea.is_disabled, select.is_disabled").each(function(index){
        //  and remove them entirely
        $(this).remove();
    });
    return true;
});
// now don't let anyone click into the fields
// this will simulate the 'disabled' functionality
$('.is_disabled').click(function() {
  $('.is_disabled').blur();
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-24T16:51:10.240

我想你可以为此编写css，而不是继续使用JQuery。我还没有测试出来。但是如果你禁用一个文本区域，它应该会自动处理样式。将此添加到您的样式表中并让我知道....

```
input[disabled][type='text'], textarea[disabled]{ color: rgb(0,0,0); background-color:Silver;} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-03T21:00:36.717

我还寻找了一个简单的、无脚本的解决方案。以下在 IE 8 中对我有用。这个想法是使用背景透明度和过滤器来转换和着色文本。这会使禁用的文本变暗以使其可读。

```
textarea[disabled], select[disabled], input[type='text'][disabled] {    
  /*required*/
  background-color:transparent; 
  filter: light;

  /*fine tuning*/
  font-weight:100;
  font-family: Tahoma;
  border: 1px solid;
  letter-spacing:1px;
} 
```

`select`没有阴影，因此使文本非常粗以获得类似的字体粗细效果。

```
select[disabled] {
  font-weight:900;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T12:15:30.890

Afaicr 在 HTML 中看起来有点像`<textarea disabled="disabled">`对吧？您可以在 IE7 中侥幸逃脱`textarea[disabled="disabled"]`（但在 IE6 中可能无法使用）。

[fredrikholmstrom](https://stackoverflow.com/questions/602070/changing-font-colour-in-textboxes-in-ie-which-are-disabled/602085#602085)的答案是最好的跨浏览器解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-03T09:08:57.610

当您将此行添加到 html 文件时，input[disabled] 和 input[readonly] 在 IE 7、8 和 9 中有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-02-19T21:16:16.803

使用标签覆盖：

```
<asp:Label ID="lblTxtHider" runat="server" Text=""    CssClass="hidden" Enabled="false"></asp:Label>
<asp:TextBox ID="TextBox1" runat="server" CssClass="frmItem" Visible="false" OnTextChanged="TextBox1_TextChanged"></asp:TextBox> 
```

然后在 CSS 中：

```
.disabledColorChanger {
position: absolute;
font-family: Arial;
font-size: 13px;
margin-top: 3px;
margin-left: 4px;
}
.disabledColorChanger[disabled] {
    display:none;
} 
```

在设置或禁用代码时：

```
private void SetEnabled(bool enabled)
{
   lblTxtHider.Enabled = !enabled;
   TextBox1.Enabled = enabled;
   lblTxtHider.Text = TextBox1.Text;
} 
```

以及用于检测的更正代码，即：

```
<script>
    $(document).ready(function () {
        var isIE = /*@cc_on!@*/false || !!document.documentMode;
        if (isIE) {
            document.getElementById("<%=lblTxtHider.ClientID%>").className = "disabledColorChanger";
        }
    });
</script> 
```

只需设置标签 = 输入值。为我工作。

* * *

## 回答 #11

> 赞同：-12
> 
> 时间：2009-03-02T12:06:14.767

你有两个选择（因为 IE 6/7 不支持 :disabled css-selector）

1.  使用 jQuery（或您选择的其他一些 js-lib）并将一个类应用于所有禁用的输入元素，例如： $("input:disabled, textarea:disabled").addClass("is-disabled");
2.  在服务器端手动添加“is-disabled”类，这当然只有在您事先知道哪些元素将被禁用以及哪些元素不会被禁用时才可行。

# mysql - Mysql - Unix时间与日期时间

> ID：602074
> 
> 赞同：3
> 
> 时间：2009-03-02T12:03:28.207
> 
> 标签：mysql, datetime

我正在编写一个类似于网站访问者跟踪解决方案的 php/mysql 应用程序。它将每天处理 100,000 次插入，并且能够通过计算页面浏览量/天等来进行查询......

我想知道从性能方面来看，将时间保持为整数（unix 时间）还是 mysql 时间更好。对性能影响有任何想法吗？

似乎使用 mysql 时间检索数据更容易，因为我可以使用 DAYOFYEAR() 等 mysql 函数而无需 FROM_UNIXTIME()。

任何建议都是最受欢迎的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T12:27:50.597

与 DATETIME 字段相比，TIMESTAMP 占用的存储空间（4 个字节）略少。在性能方面，它们应该大致相同。

如果您正在考虑执行 GROUP BY DAYOFYEAR(...) 那么您最好将 DAYOFYEAR 值存储在其自己的列中以获得更好的性能。

# windows - 如何构建 PyQT 项目？

> ID：602076
> 
> 赞同：7
> 
> 时间：2009-03-02T12:04:07.317
> 
> 标签：windows, pyqt, py2exe

我有一个简单的 PyQT 项目。我想知道如何在 Windows 中以这种方式构建它，使其成为可运行的可执行文件。我不想要求用户为他的计算机安装重型 QT 框架。如何仅使用 QT 的必要部分使可执行文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T02:21:09.953

我`py2exe`用于部署 Windows 独立 GUI 跨平台（在 Linux 下，所有 python 库都在 Linux 主机上可用）。您运行 py2exe“设置”来构建一个 .exe+，然后 py2exe 提取二进制位和您的 python 代码并构建成一个可加载、可运行的 Windows 可执行包。

Windows 上的 Python 2.5 是长期的需求，但最近的[0.6.9 版本](http://sourceforge.net/project/shownotes.php?release_id=640751&group_id=15583)增加了对 python2.6（和 python2.7？）的支持。还没有python3。

此外，您可能想在 py2exe wiki 上咨询[Py2exeAndPyQt 。](http://www.py2exe.org/index.cgi/Py2exeAndPyQt)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-15T22:12:57.213

除了 py2exe 和 cx-Freeze，还可以查看 PyInstaller。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T21:04:18.873

你看过 py2exe、cxFreeze 或其他 python 打包应用程序吗？他们通过查看您使用的内容来淘汰所需的 dll。

# java - Java 对象序列化性能提示

> ID：602079
> 
> 赞同：6
> 
> 时间：2009-03-02T12:04:34.583
> 
> 标签：java, serialization

我必须将一个巨大的对象树（7,000）序列化到磁盘中。最初我们使用 Kodo 将这棵树保存在一个数据库中，但是将这棵树加载到内存中会产生成千上万的查询，并且会占用本地宇宙的很大一部分可用时间。

我为此尝试了序列化，实际上我得到了性能提升。但是，我觉得我可以通过编写自己的自定义序列化代码来改进这一点。我需要尽快加载这个序列化对象。

在我的机器中，序列化/反序列化这些对象大约需要 15 秒。从数据库加载它们时，大约需要 40 秒。

考虑到因为对象在树中，它们相互引用，关于我可以做些什么来提高这种性能的任何提示？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T12:31:02.117

不要忘记对不必序列化的实例变量使用“瞬态”关键字。这可以提高性能，因为您不再读取/写入不必要的数据。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-02T12:23:51.107

一种优化是自定义类描述符，以便您将类描述符存储在不同的数据库中，并且在对象流中您只能通过 ID 引用它们。这减少了序列化数据所需的空间。例如，请参阅一个项目中的[SerialUtil](http://fisheye4.atlassian.com/browse/sgs-server/trunk/sgs-server/src/main/java/com/sun/sgs/impl/service/data/SerialUtil.java?r=4884)和[ClassesTable](http://fisheye4.atlassian.com/browse/sgs-server/trunk/sgs-server/src/main/java/com/sun/sgs/impl/service/data/ClassesTable.java?r=4607)类如何做到这一点。

使类 Externalizable 而不是 Serializable 可以带来一些性能优势。缺点是它需要大量的手动工作。

然后还有其他的序列化库，例如[jserial](http://jserial.sourceforge.net/)，它可以提供比 Java 的默认序列化更好的性能。此外，如果对象图不包含循环，那么它可以更快地序列化，因为序列化程序不需要跟踪它所看到的对象（请参阅[jserial 的常见问题解答](http://jserial.sourceforge.net/faq.html)中的“它是如何工作的？” ）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T12:31:02.790

我建议您实现自定义*writeObject()*和*readObject()*方法。通过这种方式，您将能够为树中的每个节点消除写入子节点。当您使用默认序列化时，每个节点都将与它的所有子节点一起序列化。

例如，*Tree*类的*writeObject()*应该遍历树的所有节点，并且只写入带有一些标记的节点数据（不包括节点本身），这些标记标识树级别。

 *您可以查看*LinkedList*，了解这些方法是如何在那里实现的。它使用相同的方法来防止为每个条目写入上一个和下一个条目。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T12:43:22.853

为避免编写自己的序列化代码，请尝试使用[Google Protocol Buffers 。](http://code.google.com/apis/protocolbuffers/)根据他们的网站：

> 协议缓冲区是 Google 用于序列化结构化数据的语言中立、平台中立、可扩展机制——想想 XML，但更小、更快、更简单。您只需定义一次数据的结构化方式，然后就可以使用特殊生成的源代码轻松地在各种数据流中写入和读取结构化数据，并使用各种语言（Java、C++ 或 Python）

我没有使用过它，但听到了很多关于它的积极消息。另外，我必须维护一些自定义序列化代码，这绝对是一场噩梦（更不用说追踪错误了），所以让别人为你做这件事总是一件好事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T12:13:49.867

这就是我会做的，形成我的头顶

序列化

1.  分别序列化每个对象
2.  为每个对象分配一个唯一键
3.  当一个对象持有对另一个对象的引用时，将该对象的唯一键放在序列化中的对象位置中。（我会使用转换为二进制的 UUID）
4.  使用唯一键将每个对象保存到文件/数据库/存储中

反序列化

1.  开始形成一个任意对象（通常是我怀疑的根）反序列化它并将它的唯一键作为索引放在一个映射中并返回它
2.  当您在序列化流中踩到对象键时，首先通过在映射中查找它的唯一键来**检查它是否已经被反序列化**，如果它只是从那里抓取它，如果没有放置延迟加载代理（重复这两个步骤对于该对象）而不是具有钩子的真实对象，可以在需要时加载正确的对象。

**编辑**，如果你有循环引用，你可能需要使用两遍序列化和反序列化，这会使事情变得有点复杂 - 但不是那么多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T12:13:41.347

您是否尝试过压缩流（GZIPOutputStream）？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T12:24:08.077

为了性能，我建议根本不使用 java.io 序列化。而是自己着手处理字节。

如果您要使用 java.io 序列化树，您可能需要确保递归不会变得太深，方法是展平（如所说`TreeSet`）或安排首先序列化最深的节点（因此您有反向引用而不是嵌套`readObject`调用）。

如果在 Kodo 中没有办法一次（或几次）读取整棵树，我会感到惊讶。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T13:15:36.333

另外，看看[XStream](http://xstream.codehaus.org/)，一个将对象序列化为 XML 并再次返回的库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-08T22:11:35.940

您可以使用[Colfer](https://github.com/pascaldekloe/colfer)生成 bean，Java 的标准序列化性能将获得 10 - 1000 倍的提升。除非大小达到超过 GB 的机会，否则您将远低于一秒。

# jquery - $.blockUI 加载掩码

> ID：602090
> 
> 赞同：1
> 
> 时间：2009-03-02T12:09:21.750
> 
> 标签：jquery, jquery-plugins

我正在使用 jQuery BlockUI 插件（v2）在加载和单击某些按钮时阻止和解除阻止。但我的问题是在加载页面时屏蔽工作正常，但当我们单击按钮时它不起作用，这是我的代码

```
$("input[name^=filtera]").click(function(){
 $.blockUI({message:'<h3><img src="images/spinner.gif" /> Please Wait...</h3>'});
 $.ajax({
    url : "ChangeRequestSearch.action?last_date_modified=" + modifiedDate ,
    cache: false,
    success : function (data) {
      $("#tableLoader").html(data);
    }
 });
 $().ajaxStop($.unblockUI); 
}); 
```

我收到错误消息：$.blockUI 不是函数

让我知道有什么问题

感谢 Usman.sk

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-08T18:49:35.147

[`$.ajaxStart()`](http://api.jquery.com/ajaxStart/)您可以在此处重新排列代码，以便像这样使用它来调用它[`$.ajaxStop()`](http://api.jquery.com/ajaxStop/)：

```
$(document).ajaxStart(function() {
 $.blockUI({message:'<h3><img src="images/spinner.gif" /> Please Wait...</h3>'});
}).ajaxStop(function() {
 $.unblockUI();
}); 
```

请注意，在 jQuery 1.4+ 中，您应该使用这些绑定`$(document)`来代替`$()`，因为`$()`不再返回`document`包装在 jQuery 对象中的内容。

# c# - 如何在 DataSet C# 中加入多个表

> ID：602102
> 
> 赞同：2
> 
> 时间：2009-03-02T12:13:54.593
> 
> 标签：c#, ado.net

我已经将一个 xml 文档转换为一个包含关系信息的 DataTables 的 DataSet。

我需要利用关系信息将表合并到一个表中是否有一种方法可以在数据集上执行类似 SQL 的查询以获取随后可用于填充数据网格的数据表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T12:32:51.083

您可能想查看 DataRelation 类。

我不会重复所有[MSDN](http://msdn.microsoft.com/en-us/library/system.data.datarelation(vs.71).aspx)文档。

# asp.net-mvc - 如何在 ASP.NET MVC RC1 中使用 FileResult 返回 304 状态

> ID：602104
> 
> 赞同：13
> 
> 时间：2009-03-02T12:14:39.177
> 
> 标签：asp.net-mvc, caching, http-status-codes

您可能知道，我们在 RC1 版本的 ASP.NET MVC 中有一个名为**FileResult的新****ActionResult 。**

 **使用它，您的操作方法可以动态地将图像返回到浏览器。像这样的东西：

```
public ActionResult DisplayPhoto(int id)
{
   Photo photo = GetPhotoFromDatabase(id);
   return File(photo.Content, photo.ContentType);
} 
```

在 HTML 代码中，我们可以使用如下内容：

```
<img src="http://mysite.com/controller/DisplayPhoto/657"> 
```

由于图像是动态返回的，我们需要一种方法来缓存返回的流，这样我们就不需要再次从数据库中读取图像。我想我们可以用这样的东西来做到这一点，我不确定：

```
Response.StatusCode = 304; 
```

这告诉浏览器您的缓存中已经有图像。在将 StatusCode 设置为 304 后，我只是不知道在我的操作方法中返回什么。我应该返回 null 还是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-05-30T08:11:01.987

这个博客为我回答了这个问题；[http://weblogs.asp.net/jeff/archive/2009/07/01/304-your-images-from-a-database.aspx](http://weblogs.asp.net/jeff/archive/2009/07/01/304-your-images-from-a-database.aspx)

基本上，您需要读取请求标头，比较最后修改的日期，如果匹配则返回 304，否则返回图像（状态为 200）并适当地设置缓存标头。

来自博客的代码片段：

```
public ActionResult Image(int id)
{
    var image = _imageRepository.Get(id);
    if (image == null)
        throw new HttpException(404, "Image not found");
    if (!String.IsNullOrEmpty(Request.Headers["If-Modified-Since"]))
    {
        CultureInfo provider = CultureInfo.InvariantCulture;
        var lastMod = DateTime.ParseExact(Request.Headers["If-Modified-Since"], "r", provider).ToLocalTime();
        if (lastMod == image.TimeStamp.AddMilliseconds(-image.TimeStamp.Millisecond))
        {
            Response.StatusCode = 304;
            Response.StatusDescription = "Not Modified";
            return Content(String.Empty);
        }
    }
    var stream = new MemoryStream(image.GetImage());
    Response.Cache.SetCacheability(HttpCacheability.Public);
    Response.Cache.SetLastModified(image.TimeStamp);
    return File(stream, image.MimeType);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-02T12:54:56.710

不要将 304 与 FileResult 一起使用。从[规格](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.5)：

> 304 响应不能包含消息体，因此总是由头字段之后的第一个空行终止。

从你的问题中不清楚你想做什么。服务器不知道浏览器缓存中有什么。浏览器决定了。如果您试图告诉浏览器不要在需要时重新获取图像（如果它已经有副本），请设置响应[Cache-Control 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)。

如果需要返回 304，请改用 EmptyResult。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-31T18:51:15.463

在较新版本的 MVC 中，您最好返回一个 HttpStatusCodeResult。这样您就不需要设置 Response.StatusCode 或弄乱其他任何东西。

```
public ActionResult DisplayPhoto(int id)
{
    //Your code to check your cache and get the image goes here 
    //...
    if (isChanged)
    {
         return File(photo.Content, photo.ContentType);
    }
    return new HttpStatusCodeResult(HttpStatusCode.NotModified);
} 
```

# c++ - Design for generic options to algorithms

> ID：602108
> 
> 赞同：3
> 
> 时间：2009-03-02T12:17:53.773
> 
> 标签：c++, design-patterns

I want to know if there is a design pattern for specifying options to a set of algorithms. I am using C++. Let me describe my problem. I am having a set of algorithms and these algorithms have different options. I want to design a single point access to these algorithms. Something similar to a strategy pattern. This single point access is a controller class which takes input as a generic options class. Depending upon the options, a suitable algorithm will be used. I want to generalize these options so that i can extend algorithms and the client. Thanks, Amol

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T12:21:56.837

An often-used pattern is to create a policy class which is passed as a template type to your class and then inherited from privately:

```
template <typename Policy>
class fancy_algorithm : private Policy {
}; 
```

One famous example of this is the `std::allocator` class which is often inherited in that manner:

```
template <typename T, typename Alloc = std::allocator<T> >
class my_container : private Alloc {
public:
    typedef Alloc allocator;

    // It's necessary to make the base class names available explicitly.
    typedef typename allocator::pointer pointer;

    using allocator::construct;
    // …
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T12:44:35.080

I agree with Konrad on policy-based design. I also recommend [Modern C++ Design: Generic Programming and Design Patterns Applied](https://rads.stackoverflow.com/amzn/click/com/0201704315). After this book your vision of C++ will be changed forever ;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T04:49:59.073

Building on [Konrad's suggestion of using policy types](https://stackoverflow.com/questions/602108/design-for-generic-options-to-algorithms/602119#602119), if your algorithms require parameters at construction time, you can handle this cleanly by requiring that any `Policy` class has a nested type called `Params`, and then provide a constructor inside `fancy_algorithm<Policy>` that takes an argument of this type and passes it to the contained `Policy` object:

```
template <typename Policy>
class fancy_algorithm : private Policy {
public:
    typedef typename Policy::Params Params;    // Need to redeclare :(

    explicit fancy_algorithm(Params params = Params()) : Policy(params) {}
}; 
```

Any relevant parameters need to be packaged into a single object of type `Policy::Params`.

The `Policy` class is always constructed with a single argument of type `Policy::Params`. To work with policy classes that (may) require no parameters, provide a default constructor (or use the implicitly declared one) in `Params`, not in `Policy`. This way, by using a default value for the `fancy_algorithm<Policy>` constructor as above, we enable convenient default-construction of a `fancy_algorithm<Policy>` whenever `Policy::Params` has a default constructor (i.e. when the `Policy` doesn't require any parameters). No safety is lost: if `Policy::Params` lacks a default constructor (indicating that some parameters are *required*), any attempt to default-construct a `fancy_algorithm<Policy>` object will fail at compile time.

Example:

```
struct multiply_by_params {
    multiply_by_params(int x /* = 42 */) : _x(x) {}     // See bottom
    int get() const { return _x; }    // Or, just make multiply_by a friend

private:
    int _x;
};

struct multiply_by {
    typedef multiply_by_params Params;
    multiply_by(Params p) : _x(p.get()) { /* Other initialisation */ }

    // Other code implementing the strategy (e.g. an operator()())
    ...

private:
    int _x;
};

fancy_algorithm<multiply_by> a(69); // Always compiles
fancy_algorithm<multiply_by> b;     // Compiles iff /* = 42 */ is uncommented 
```

# c++ - 模板函数传递给共享库 (c++)

> ID：602112
> 
> 赞同：2
> 
> 时间：2009-03-02T12:19:23.737
> 
> 标签：c++, function, templates, shared

一个思想实验......成分1：（预编译的）共享库中的一个类，它具有一个函数，该函数接受一个指向从ostream派生的对象的指针：

```
void ClassName::SetDefaultStream(std::ostream *stream) 
```

成分2：

我自己的类派生自 std::ostream，带有一些通用的模板化流运算符：

```
class MyStream : public std::ostream
{
   public:
      template <typename T> MyStream &operator<<(const T &data)
      {
         std::cout << data;
         return *this;
      }
} 
```

现在，如果我将这个类的实例化地址传递给 SetDefaultStream 方法，会发生什么？在编译时，编译器不知道共享类中的流会应用什么类型，所以肯定不会合成代码吗？会不会编译失败，会不会编译然后运行时崩溃，电脑会冒烟吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T12:29:04.680

您的模板化成员在库中不可见，因为它不是基本 std::ostream 的虚拟成员。不会出现任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T12:29:21.420

它会编译，但不会调用您的操作员。

# netbeans6.5 - 在opensolaris2008.11上安装jdk1.6和netbeans

> ID：602114
> 
> 赞同：0
> 
> 时间：2009-03-02T12:19:34.937
> 
> 标签：netbeans6.5, jdk1.6

我使用 .sh( jdk-6u12-solaris-x64.sh ) 和 .tar.Z(jdk-6u12-solaris-x64.tar.Z) 文件安装了 jdk 1.6，但命令提示符和 netbeans 安装程序都不是检测安装。wat是在opensolaris上安装jdk的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T17:36:16.233

您是否尝试设置 JAVA_HOME？

导出 JAVA_HOME = /path/to/java

然后在命令提示符下尝试 java -version 看看你得到了什么。

# asp.net - 如何修复 ASP.NET 错误“文件 'nnn.aspx' 尚未预编译，无法请求。”？

> ID：602117
> 
> 赞同：44
> 
> 时间：2009-03-02T12:21:34.013
> 
> 标签：asp.net, deployment, webforms

我有一个使用“发布网站”发布的 VS 2005 网站，我清除了所有三个复选框。我还有一个部署项目，可以获取已发布的文件并创建一个 MSI。然后我将包安装在单独的测试服务器上。

换句话说，整个网站都是预编译的。但是，当我转到名为“Services”的特定子文件夹中的任何 .aspx 文件时，我会收到一个 HttpException：

> System.Web.HttpException：文件“/myapp/Services/mypage.aspx”尚未预编译，无法请求。

如果我转到其他文件夹中的 .aspx 文件，无论是根文件夹还是其他子文件夹，它都能正常工作。

mypage.aspx 本身的内容是：`<%@ Page Language="C#" AutoEventWireup="true" CodeFile="mypage.aspx.cs" Inherits="Services_mypage" %>"`

在`/myapp/bin`文件夹中，我可以看到一个`mypage.aspx.989dc2fb.compiled`文件。其内容似乎指向 bin 文件夹中也存在的某个程序集。

为什么会出现这个错误？.compiled 文件在那里，程序集在那里，并且该程序集中存在相关类型（我可以在对象浏览器中看到它）。与 .compiled 文件的名称或内容有关吗？我有错误的版本吗？.compiled 文件名中看似随机的数字是什么意思，它是否重要？

我还想提一下，这个问题是突然出现的，我不确定自从它在几天前正常工作以来可以进行哪些更改（但据我所知，没有）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-02T12:47:37.897

我没有出现这个错误，但经过一番谷歌搜索后，我发现了这个链接，我不确定你是否看过它：[http ://forums.asp.net/t/956297.aspx](http://forums.asp.net/t/956297.aspx)

编辑（添加关键文本）：

> 当在 web.config 中指定引用并且部署文件夹/站点不包含系统中安装的这些 dll 或 bin 文件夹不包含它们（如果它们是私有程序集）时，将出现此错误。例如： (add assembly="Namespace1.NameSpace2, Version=xxxx, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/) 如果您的 web.config 包含任何这样的程序集并且部署的服务器在 bin 或 GAC 中不包含这些程序集，那么这个会发生错误。

人们报告说，在他们的情况下，目标服务器上缺少的程序集最终是根本原因，但他们和你有同样的错误。奇怪的。

也许这就是问题所在？

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-09-20T09:42:39.320

当我将站点从 2.0 升级到 4.0 时出现此错误。该错误是由`PrecompiledApp.config`站点`root`目录中的文件引起的。删除该文件后，该站点开始工作。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-07-03T04:56:21.620

就像上述所有答案的脚注一样，通过重新发布以替换丢失的程序集来解决问题......虽然我以前用相同的解决方案解决了这个问题，但我刚刚遇到了另一个可能帮助其他人的原因。

我的站点在其下运行的 AppPool 将“启用 32 位应用程序”设置设置为 false。通过应用程序池的“高级设置”对话框将其更改为 true，我解决了我的问题。

希望能帮助其他一些可怜的傻瓜。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-06-27T14:02:36.977

我遇到了同样的问题。我的问题已通过删除此文件夹中的临时 asp.net 文件夹中的文件得到解决：

```
C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-12-04T23:21:00.670

过去几天我一直在努力解决这个问题。至少在我的情况下，错误消息完全具有误导性，与预编译的网站无关。那里有许多文章或帖子给出了许多不同的答案，这只会增加混乱。我个人认为这个错误主要是由于缺少引用或不正确的版本控制造成的。为了尽快解决问题，您必须排除这一点，或者以其他方式修复丢失/错误的参考。

为此，您需要使用名为“Assembly Binding Log Viewer”的工具。该工具会告诉您哪些参考文献缺失或版本错误。如果缺少/不匹配的参考，请继续修复它；否则，您需要执行其他魔术技巧，例如检查 App Pool 是否为 32 位或权限。

脚步：

1.  在您的服务器上创建以下文件夹

    C:\fuslog C:\fuslog\logs

2.  将程序集绑定日志查看器复制到位于 C:\fuslog 的服务器：

    您可以在这样的位置找到该程序

    C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\fuslogvw.exe

    您可能需要查看“程序文件”而不是“程序文件（x86）”或查看不同的版本而不是“v7.0A”

3.  在服务器上执行 fuslogvw.exe

4.  点击“设置...”

5.  确保选中“将失败记录到磁盘”

6.  选中启用自定义日志路径并在框中输入以下内容：C:\fuslog\logs

7.  点击确定

8.  回收/重置您的应用程序池以强制执行新绑定

9.  单击刷新。现在你可以在这里看到失败的绑定

10.  找到确切绑定的更好方法是转到 c:\fuslog\logs\Default。在这里，您可以找到确切的绑定失败。有些是无关紧要的，您需要通过反复试验找到关键的。我的是以下失败：

    ```
     System.Web.Mvc, Version=4.0.0.1, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
    ```

我通过在我的网站 web.config 中添加以下条目来解决此问题：

```
<configuration>
    ...
    <runtime>
        ...
        <!-- Added this entry to fix the issue -->
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="0.0.0.0-4.0.0.1" newVersion="4.0.0.0" />
        </dependentAssembly>
        ...
    </runtime>
    ...
</configuration> 
```

我希望这可以帮助其他人快速解决问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-03-24T10:36:04.073

这个错误发生在我身上，我解决了。

当您想要发布您的站点时，请检查在 Visual Studio 中使用固定命名和单页程序集

你会看到这个问题将得到解决！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T16:58:39.230

结果证明是 MSI 中缺少的（非 Web）DLL，我认为该 DLL 被给出错误的页面使用。我会说一个非常误导性的错误消息，因为该页面肯定是预编译的，但缺少对该 DLL 的引用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-29T12:58:04.500

在尝试了其他几种解决方案后，我们通过重新启动 AppPool 来解决此问题。在这种情况下，重新发布不是一种选择。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-12-01T03:01:21.450

我今天遇到了同样的问题。一些论坛告诉您的网站缺少参考，在您的情况下确实如此。尽管您已经包含了所有必要的程序集，但您可能已经将您的网站部署在具有 3.5 框架的 IIS 服务器中，对吧？

好吧，这是我的情况，所以我从原始 ASPX 3.5 网站复制了 web.config 文件并修改了一些部分（删除了其他 3.5 程序集引用）并尝试再次部署它。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-07-03T11:15:08.167

这个选项为我解决了这个问题。基本上，它会删除之前部署后留下的每个孤立文件。

![删除目的地的其他文件](https://i.stack.imgur.com/zsOh4.png)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-10-25T01:03:26.763

对我来说，我有一个脚本可以删除生产文件夹，然后复制新文件。

该脚本未能正确删除生产文件夹，导致新旧文件混合在一起导致错误。

我手动删除了整个文件夹并成功重新部署......然后更新了脚本。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-09-04T15:07:59.523

这个问题可能是由许多不同的原因引起的。我的页面是零星的，醒了一会儿，突然给出了提到的错误。这是一个与内存压力相关的问题
[，这个线程](https://stackoverflow.com/a/55272599/5427648)对我来说有正确的答案，我也在那里发布了我的解决方法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-01-28T08:50:00.187

在我的情况下，重新部署相同的文件也解决了这个问题。

因此，也许在尝试其他任何事情之前先尝试再次部署您的应用程序（bin 文件夹内容应该足够了）

顺便说一句：在我的情况下，当 C 驱动器空间不足时，错误就开始了。

快乐编码！中科

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-12-12T09:22:57.413

我知道该错误是在抱怨其他问题，但我保证在我的情况下，问题只是asp.net 帐户无法使用该特定文件的**访问权限（网络服务或应用程序池标识或 IUSR）不足。**

这是由于在我们的 VPS 环境中**不寻常的部署**和混合 bin 文件与新发布的文件。

**解决方案**：

需要将特定文件权限替换为正确的 Bin 文件夹权限，例如 Bin 内正常工作的其他文件（以及该错误）。

![在此处输入图像描述](https://i.stack.imgur.com/meL8K.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-09-11T07:44:18.857

首先检查可用的磁盘空间。当托管 IIS 的硬盘空间不足时，我收到此错误。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-03-08T19:52:08.047

如果您在 bin 中有一个不再属于项目一部分的页面的 .compiled 文件，也会发生此错误。您基本上会收到这个代替 404。删除 .compiled 文件，然后得到 404。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2022-01-30T05:21:01.267

在网站根文件夹下，有一个名为 PrecompiledApp.config 的文件，更新 updatable="true" 后，网站又可以正常工作了。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-10-07T11:43:26.307

当我对现有站点进行一些更改时，我遇到了这个问题。

为了从问题中恢复，我从 bin 文件夹中删除了所有文件并重新部署了它们。

然后问题就解决了。

我希望这可能对某人有所帮助。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-06-08T01:40:58.493

如果您在运行 MSBuild 脚本时收到此错误，则很可能您的项目是 2.0 或 3.5 项目，并且 MSBuild 使用的是 4.0 编译器。尝试添加：

```
TargetFrameworkMoniker="3.5" 
```

到您的 AspNetCompiler 指令。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-09-27T18:19:39.400

就我而言，我没有上传常见的 DLL，如 AjaxControlToolkit.dll、Telerik.dll 等。我上传了整个已发布的文件夹并为我修复了它。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-12-12T18:14:04.087

万一更新了再重新编译。再次从 bin 文件夹复制所有文件，以及从其各自文件夹更新的特定文件。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-04-10T00:29:23.210

在我的 asp.net mvc razor 视图 (.cshtml) 错误的情况下，/bin 文件夹包含两个用于同一视图的 .compiled 文件。其中一个是旧的，需要删除。

我在控制器视图子文件夹中还有第二个视图，也需要删除。

出现问题的原因是我将视图从控制器视图子文件夹移动到共享文件夹中，但是我的部署过程（Visual Studio 发布）没有从服务器中删除过时的视图和 view.compiled 文件。您可以指示 Visual Studio 始终清理目标文件夹，但这会使部署过程变慢。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-05-14T04:38:56.607

最后，我发现了问题。如果您像我一样使用 MVC 框架，请更新您的 MVC 版本。在我的情况下，我将 MVC 4.0.0.0 更改为 4.0.0.1，并将所有项目引用的“本地复制”属性检查为“真”。之后我的问题解决了。请检查所有配置文件中的 MVC 版本（4.0.0.0->4.0.0.1）

并注意 asp 编译器警告消息。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-03-02T11:33:39.963

当我开始使用 VWD Express 2012 时遇到了同样的问题（在我使用 Express 2010 之后，它曾经可以正常工作）进入我的主机控制面板并将 ASP.NET 版本从 2.0-Classic 更改为 4.0 Classic，如图所示。问题消失了。

![](https://i.stack.imgur.com/XzmWi.jpg)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-09-08T05:15:02.800

在我的例子中，'nnn.aspx.xxxxxxxx.compiled' 文件已被 WebDeploy 删除，因为我在同一个 Jenkins 工作区中同时运行了 2 个作业。第二个作业在 WebDeploy 包创建期间删除了一些文件。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-04-30T12:24:18.327

这是 VS 2008 的解决方案。

请勾选如下所示的框以解决问题。

[![在此处输入图像描述](https://i.stack.imgur.com/y5X9K.jpg)](https://i.stack.imgur.com/y5X9K.jpg)

# oop - 检查财产价值的最佳地点

> ID：602120
> 
> 赞同：1
> 
> 时间：2009-03-02T12:22:27.363
> 
> 标签：oop, class-design

假设你有一张班级照片：

```
class Photo
{
  public string Title {get; set;}
  public string FileExtension {get; set;}
  public void Save() 
  { 
    // Save to backing store here 
  }
} 
```

这将是检查值是否设置正确的最佳位置。在属性设置器或 Save 方法中。

编辑：如果它是一个更新方法怎么办？如果照片是通过 PhotoManager 添加的，使用像 PhotoManager.Add(Photo p) 这样的方法，那么这是进行验证的最佳位置。

亲切的问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T12:25:41.430

如果这些是唯一的选项，那么在属性设置器中。[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)表明`Save`应该进行保存，而不是其他任何事情。

此外，这就是属性之美。它们看起来像字段，但它们可以在支持字段中获取和设置值的背后具有增强的逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T12:27:15.840

不要让您的实例陷入无效状态：在 setter 中进行验证，这就是它的用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T12:57:13.427

这取决于，你什么时候有足够的数据来检查正确性：如果 FileExtension 的正确性不依赖于 Title 的值，并且 Title 的正确性不依赖于 FileExtension 的值，你可以检查它们里面的每一个二传手。

但是如果其中一个依赖于另一个的值，并且您不知道 setter 的执行顺序是什么，则只有在同时获得 Title 和 FileExtension 时才需要检查它们。这可以在 Save 中，或者在一些新的 Check 方法中。

此外，也许在保存之前，您必须检查是否设置了 Title 和 FileExtenstion。

因此，总而言之，您可能需要以下检查：

*   检查 Title 的正确性：在 Title.set
*   检查 FileExtension 的正确性：在 FileExtension.set
*   检查 Title.set 和 FileExtension.set 是否已执行：在 Save
*   在 Save

**关于更新方法**：我知道您收到了一个已经设置了 Title 和 FileExtenstion 的 Photo 对象。在这种情况下，您必须决定是否相信 Title 和 FileExtension 已经由设置它们的人在照片中进行了检查。如果您信任它，您不必更改我上面的建议中的任何内容。但是，如果您不信任，那么您还必须在 Save 中检查 Title 的正确性和 FileExtension 的正确性（或者，再次，在一些新的 Check 方法中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T12:26:21.990

这么少的细节很难说。如果您认为对象在更新时处于无效状态是有效的，那么我会说您必须在 Save 方法中进行验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T12:26:22.923

如果我正确理解了您的问题，您可以简单地使用`private boolean Validate(title, fileExtension)`从设置器和存储方法中调用的方法来完成。如果这个验证是假的，你可以抛出一个`Exception`并从那里处理它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T12:29:55.833

```
public void Save()
{
  try
  {
    // saving
  }
  catch(Exception ex)
  {
    MessageBox(ex.Message); // roughly
  }
} 
```

或者

```
public void Save()
{
  if(!IsDataValid) // !(String.IsNullOrEmpty(this.Title) && String.IsNullOrEmpty(this.Extension))
  {
    throw new Exception(); //in fact you need to throw something more concrete
  }
  // saving
} 
```

我也可以使用：

```
public string Title { get; private set; }

public string Extension { get; private set; }

public Photo(string title, string extension)
{
  this.Title = title;
  this.Extension = extension;
} 
```

# .net - 推荐的 Prism v2 Silverlight/WPF 项目结构

> ID：602121
> 
> 赞同：2
> 
> 时间：2009-03-02T12:22:40.250
> 
> 标签：.net, wpf, silverlight, .net-3.5, prism

我目前的任务是向我所在公司的所有开发人员介绍 Silverlight (v2)。唯一的问题是我自己没有任何真正的 Silverlight 经验。当然，我已经研究了有关数据绑定、布局等的所有技术细节，因此我可以帮助我的同事。但是很难找到任何信息的一件事是一般项目结构。

我决定遵循 P&P Prism 2 的道路（甚至可能在以后加入一些 WPF），所以我想知道你们中是否有聪明人有使用 Prism 2 甚至只是 WPF 开发真实项目的经验，如果您对项目/解决方案结构有任何建议？例如“你把视图放在哪里？” 或“您有任何模块项目命名约定吗？” 等等

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T12:56:15.270

这纯粹是基于我使用 Prism for WPF 的经验，而不是 Silverlight。我不是 Prism 的专家，并且可以很容易地改变我对其中一些的想法。:-)

*   为所有东西制作一个模块是很诱人的。不。您的构建时间将很快耗尽，您将面临一个非常零散的解决方案。相反，我有一个主模块，它是静态加载的，并且在基本包中包含我想要的所有内容。任何附加组件或附加组件都会成为动态加载的其他模块。将一个模块分解一下可能是值得的，但要保持较小的数量。这也有助于加载时间。

*   不确定这是否是个好主意，但我喜欢将 View 和 ViewModel 接口与 View/ViewModel 本身放在同一个文件中。我喜欢这个，因为 MVVM 模式可以生成很多文件，这可以让文件倒计时。缺点是接口和它的实现更难分离，但我不太可能需要这样做，而且这种技术不会干扰测试，这是另一个好处。

*   视图倾向于进入视图文件夹，然后是每个视图的文件夹。每个视图的文件夹包括视图、视图模型和演示者（如果需要）。

*   从参考实现中，为需要在模块之间共享的所有公共类创建一个基础架构项目。参考实现有更多细节，但这可以用于各种事情，如公共服务接口、常量等。

# php - 我如何在 cakephp 中实现这个

> ID：602122
> 
> 赞同：-1
> 
> 时间：2009-03-02T12:22:44.807
> 
> 标签：php, cakephp

> **可能重复：**
> [如何在 CakePHP 中提供附加条件的同时查询基于 HABTM 关系的表？](https://stackoverflow.com/questions/602227/how-do-i-query-a-table-based-with-habtm-relationship-while-providing-additional)

请帮我在 cakephp 中实现这个

```
table safari:
id
name
duration

table region:
id
name

table regions_safaris:
safari_id
region_id

select s.name
from region r, safaris_regions sr, region r, safari s
where r.name='yourRegion'
and sr.region_id=r.id and s.id=sr.safari_id and s.duration=5; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T07:38:57.597

您应该将区域表更改为区域，并将 safari 表更改为 safaries 以使其与 cakephp 一起使用。在模型中建立关系后，您将使用查找。

```
//safaries_controller.php 
$this->Safari->find('all', array('fields'=>'Safari.name', 'conditions'=>array('Region.name'=>'yourRegion')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T12:34:16.493

我不确定您具体在努力解决什么问题，但是您可以通过将连接条件与选择条件分开来使您的查询更清晰：

```
select s.name
from safari s 
inner join regions_safaris sr on(s.id=sr.safari_id)
inner join region r on(sr.region_id=r.id)
where r.name='yourRegion' 
and s.duration=5; 
```

您的查询也有使用 safaris_regions 而不是 region_safaris 的错误，并且两次对区域表进行别名。

# iphone - 如何在 iPhone 上连接字符和字符串？

> ID：602133
> 
> 赞同：7
> 
> 时间：2009-03-02T12:25:46.810
> 
> 标签：iphone, objective-c, cocoa, string

我想添加一些标记来分隔一些字符串。如何将字符添加到字符串？

例如在“Hello”中添加'\x01'，在“World”之前添加'\x02'，在“World”之后添加'\x03'。

所以我可以创建一个字符串“\x01 Hello \x02 World \x03”，它有一些单独的标记。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-02T13:11:07.920

如果要修改字符串，则必须使用`NSMutableString`而不是`NSString`. 如果您想从头开始创建字符串，则不需要这样。

例如，您可能想要使用`+stringWithFormat:`方法：

```
NSString * myString = [NSString stringWithFormat:@"%c %@ %c %@ %c",
                                                 0x01,
                                                 @"Hello",
                                                 0x02,
                                                 @"World",
                                                 0x03]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T12:41:46.197

嗯..

你可以这样做：

```
NSString *hello = @"hello";
char ch [] = {'\x01'};
hello = [hello stringByAppendingString:[NSString stringWithUTF8String:(char*)ch]]; 
```

我制作 aa char* 以附加您的单个 char 并使用 stringWithUTF8String 添加它。

然而，可能有一种不那么冗长的方法来解决它！

缺口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T13:10:32.570

不完全确定你在问什么......但 stringWithFormat 可能会帮助你吗？

例如，

```
[NSString stringWithFormat:@"%c%@%c%@%c", 1, @"hello", 2, @"world", 3]; 
```

# javascript - Rails 中每个视图的 JavaScript 文件

> ID：602147
> 
> 赞同：57
> 
> 时间：2009-03-02T12:30:23.413
> 
> 标签：javascript, ruby-on-rails, ruby

根据“不显眼的 JavaScript”建议，我想将我的 JavaScript 逻辑分离到
单独的文件中。但是我不知道如何组织它们。

我是不是该：

1.  只需将所有应用程序 javascript 放入 Application.js 文件并使用布局页面加载它？这是一种简单的方法，但我最终会得到一个臃肿的 Application.js。一些用户可能只想访问几个页面，但整个文件会被预加载，这并不好。
2.  或者我应该为每个视图创建一个单独的 JavaScript 文件并独立加载它们？这会产生一组问题。如何将每个js文件链接到相应的视图？
    谢谢。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-03-02T12:40:59.800

每次都在 application.js 中加载主 JavaScript。现在为不同的需求创建文件。创建一个 form.js 文件、一个 myfancypart.js 文件等。不要在 application.html.erb 布局中加载它们。在需要时动态加载它们：

应用程序.html.erb：

```
<%= javascript_include_tag "application" %>
<%= yield :javascript_includes %> 
```

view.html.erb 的顶部：

```
<% content_for :javascript_includes do %>
  <%= javascript_include_tag "forms.js" %>
<% end %> 
```

content_for 块中的所有内容都将在 yield :javascript_includes 处加载。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-02T12:37:10.917

我建议将它们全部放入一个文件中，然后您可以对其进行压缩和 gzip。客户端只需下载一次，因为它将被缓存在所有后续请求中。

您可能感兴趣的另一件事是 sprockets，一个 javascript 依赖项管理器，您可以使用 gem 安装它。[您可以从网站 ( http://getsprockets.org/](http://getsprockets.org/) ) 或 github 页面 ( [https://github.com/rails/sprockets](https://github.com/rails/sprockets) )获得有关 sprockets 的更多信息。它使编写大型 javascript 应用程序更易于管理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-13T00:57:59.160

这随着 Rails 3.1 和资产管道而改变！！！

如您所指，最好使用单独的文件。关于如何引用它们并链接它们的问题随着 rails 3.1 的出现而消失，它旨在将它们全部编译成单个文件以用于生产。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-23T19:28:46.963

可以使用 Jammit 包含 css 和 javascripts 文件

详情：[http ://documentcloud.github.com/jammit/](http://documentcloud.github.com/jammit/)

采用：

**第1步：**

在 assets.yml 中添加 js 文件（参见下面的代码）

javascript:

```
footer:

- app/javascripts/lib/*.js
- app/javascripts/jquery-plugins/*.js
- app/javascripts/custom/*.js
- app/javascripts/application.js 
```

标题：

```
- app/javascripts/core/*.js
- app/javascripts/head/*.js 
```

**第2步：**

在应用程序布局中添加简单代码：

```
<%= include_javascripts :header %>
<%= include_javascripts :footer %> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-19T22:51:43.963

也许你想使用 application_helper

```
def javascript(*files)
  content_for(:head) { javascript_include_tag(*files) }
end

def stylesheet(*files)
  content_for(:head) { stylesheet_link_tag(*files) }
end 
```

# design-patterns - 什么是解决此调度问题的好方法/模式

> ID：602155
> 
> 赞同：0
> 
> 时间：2009-03-02T12:33:03.627
> 
> 标签：design-patterns

我有一个对象

```
public class Task
{
    public TimeSpan Length { get; set; }
    public IList<Task> Dependencies { get; set; }

    public DateTime? StartDate { get; set; }
} 
```

它依赖于其他实例。例如：

（将“<-”读作“取决于”）

*   B <- A
*   C <- A
*   D <- B,C

和

*   Q <- P
*   R <- Q

给定任务列表* 和结束日期，我需要在每个任务上设置开始日期，以便它们都将在结束日期之前完成。任务可能会在可能的情况下并行运行，所以....

A 必须在 B 和 C 之前完成（可以同时完成），而 D 只能在 B 和 C 都完成之后运行。

R 必须在 Q、P 之后运行，但这些可以与 ABC 和 D 并行运行。

* 列表将是完整的，所有依赖项都将出现在列表中

感谢您的任何建议安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T12:40:10.270

[DAG](http://en.wikipedia.org/wiki/Directed_acyclic_graph)和拓扑[排序](http://en.wikipedia.org/wiki/Topological_sort)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T12:47:27.040

您需要计算关键路径。如果有帮助，请参阅[此问题。](https://stackoverflow.com/questions/107660/how-to-compute-the-critical-path-of-a-directional-acyclic-graph)

否则，这是一个简单的动态规划问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T13:12:36.387

```
 public class Task
    {
        public long Length;
        public List<Task> Dependencies = new List<Task>();
        public DateTime StartDate;
        public DateTime EndDate;

        public void CompleteBaseSchedule()
        {
            DateTime startDate = DateTime.MinValue;
            foreach (Task task in Dependencies)
            {
             startDate = (startDate < task.EndDate) ? task.EndDate : startDate;
                task.CompleteBaseSchedule();

            }
            this.StartDate = startDate;
            this.Length = this.EndDate.Ticks - this.StartDate.Ticks;
        } 
```

主要的某处：

```
 Task task1 = new Task();
            task1.EndDate = new DateTime(2009, 3, 3);
            Task task2 = new Task();
            task1.EndDate = new DateTime(2009, 3, 5);
            Task task3 = new Task();
            task1.EndDate = new DateTime(2009, 3, 2);
            Task task4 = new Task();
            task1.EndDate = new DateTime(2009, 3, 6);
            task4.Dependencies.AddRange(new Task[]{ task1, task2, task3 });

            task4.CompleteBaseSchedule();
            Console.WriteLine(task4.StartDate);
            Console.ReadLine(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:44:42.330

Thanks for everyones' advice, the Topological sort stuff was useful, but I think i've solved it an easier way...

```
public class Scheduler
{
    private readonly IEnumerable<Task> tasks;
    private readonly DateTime endDate;

    public Scheduler(IEnumerable<Task> tasks, DateTime endDate)
    {
        this.tasks = tasks;
        this.endDate = endDate;
    }

    public void Schedule()
    {
        var terminators = FindTerminators();
        SetStartDatesRecursively(terminators, endDate);
    }

    public ICollection<Task> FindTerminators()
    {
        IList<Task> terminators = new List<Task>();

        foreach(var task in tasks)
        {
            var dependencies = this.tasks.Where(x => x.Dependencies.Contains(task));
            if (dependencies.Count() == 0)
                terminators.Add(task);
        }

        return terminators;
    }

    public void SetStartDatesRecursively(IEnumerable<Task> tasks, DateTime endDate)
    {
        foreach(var task in tasks)
        {
            var startDate = endDate - task.Length;

            if (task.StartDate.HasValue)
                task.StartDate = startDate < task.StartDate ? startDate : task.StartDate;
            else
                task.StartDate = startDate;

            SetStartDatesRecursively(task.Dependencies, task.StartDate.Value);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T12:41:38.317

这听起来更像是一种同步活动。即在线程中你会使用WaitHandles。

A 启动并传递 B 一个等待句柄 AND C 一个等待句柄

一旦 A 完成 B 和 C 由于等待句柄发出信号而开始

D 有一个等待句柄，等待 B 和 C 上的 ANY ，所以先完成的人将向 D 发出信号

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T12:43:42.400

对于小图，只需递归计算开始日期 - D 的开始日期将是`min(B.StartDate,C.StartDate) - D.Length`.

对于大图，执行拓扑排序，然后您可以迭代地执行计算。

# ruby-on-rails - Rails：ActiveResource - 我可以明确设置 ID 吗？

> ID：602162
> 
> 赞同：6
> 
> 时间：2009-03-02T12:35:12.263
> 
> 标签：ruby-on-rails, rest, activeresource

我在 Rails 中使用 ActiveResource 通过 REST 管理单独数据库中的实体。

我一直在尝试显式管理远程资源的 ID，就当前情况而言，最简单的方法是重新使用本地资源的 ID，而不是维护不同的字段。

不幸的是，我无法使其正常工作，因为`new?`in的代码`ActiveResource::Base`是

```
 def new?
    id.nil?
  end 
```

并且`save`是

```
 def save
   new? ? create : update
 end 
```

因此，根据定义，不可能设置资源的 ID 并将其保存为新资源。

`create`并且`update`是受保护的方法，所以如果我破解了 ActiveResource::Base 代码，也许这会让它工作，但我不愿意这样做。

有这样做的正确方法吗？还是我想做的事情很糟糕，我不应该这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-22T09:44:53.677

在新的 rails（测试 2.3.2）中，可以设置 id，因为保存逻辑发生了一些变化（现在记录有布尔字段 @newrecord 来消除那个 id.nil？）。

```
record = Model.new
record.id = 123
record.save! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T20:09:49.130

您正在违背 ActiveResource 的意图。ActiveResource 为 REST Web 服务提供了一个接口，按照惯例，它会在您创建时返回分配的 ID。

也就是说，如果您控制正在使用的资源，并且在保存新记录时已修改其行为以获取 ID，则可以修改 ActiveResource::Base 以符合要求。Rails 中的人对基类进行添加和更改并不少见。您只需将补丁放入 lib 并将其包含在您的启动内容中。

我认为这不一定是个好主意，但这是可能的。:)

# css - 在 CSS 中，“.”有什么区别？和“#”声明一组样式时？

> ID：602168
> 
> 赞同：250
> 
> 时间：2009-03-02T12:36:51.543
> 
> 标签：css, css-selectors

`#`为一个元素声明一组样式以及`.`在决定使用哪个样式时发挥作用的语义有什么区别？

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2009-03-02T12:38:13.940

## 是的，他们不一样……

`#`是一个[id 选择器](http://css.maxdesign.com.au/selectutorial/selectors_id.htm)，用于定位具有唯一 id 的*单个*特定元素，但是 . 是一个[类选择器](http://css.maxdesign.com.au/selectutorial/selectors_class.htm)，用于定位具有特定类的*多个元素。*换一种方式：

*   `#foo {}`*将为使用属性声明的单个*元素设置样式`id="foo"`
*   `.foo {}`*将使用属性设置所有*元素的样式`class="foo"`（您也可以将多个类分配给一个元素，只需用空格分隔它们，例如`class="foo bar"`）

## 典型用途

一般来说，您使用# 来设置您知道只会出现一次的东西，例如，诸如侧边栏、横幅区域等高级布局 div 之类的东西。

类用于重复样式的地方，例如，假设您使用特殊形式的错误消息标题，您可以创建`h1.error {}`仅适用于的样式`<h1 class="error">`

## 特异性

选择器不同的另一个方面是它们的特异性 - id 选择器被认为比类选择器更具体。这意味着当元素上的样式[发生冲突](http://css.maxdesign.com.au/selectutorial/advanced_conflict.htm)时，使用更具体的选择器定义的样式将覆盖不太具体的选择器。例如，给定`<div id="sidebar" class="box">`任何规则`#sidebar`与覆盖冲突规则`.box`

## 了解有关 CSS 选择器的更多信息

有关 CSS 选择器的更多精彩入门，请参阅[Selectutorial](http://css.maxdesign.com.au/selectutorial/) - 它们非常强大，如果您的概念只是“# 用于 DIV”，那么您最好仔细阅读如何更有效地使用 CSS。

编辑：看起来 Selectutorial 可能已经去了天空中的大网站，所以试试这个[存档链接](https://web.archive.org/web/20180313224235/http://css.maxdesign.com.au/selectutorial/)。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-02T12:40:09.287

这`#`意味着它与`id`元素的 匹配。表示类`.`名：

```
<div id="myRedText">This will be red.</div>
<div class="blueText">this will be blue.</div>

#myRedText {
    color: red;
}
.blueText {
    color: blue;
} 
```

请注意，在 HTML 文档中，**id 属性必须是唯一的**，因此如果您有多个元素需要特定样式，则应使用类名。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-02T12:38:00.633

dot( `.`) 表示**类**名，而 hash( `#`) 表示具有特定**id**属性的元素。该类将应用于使用该特定类装饰的任何元素，而 # 样式将仅应用于具有该特定 id 的元素。

班级名称：

```
<style>
   .class { ... }
</style>

<div class="class"></div>
<span class="class></span>
<a href="..." class="class">...</a> 
```

命名元素：

```
<style>
   #name { ... }
</style>

<div id="name"></div> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-02T18:26:59.687

还值得注意的是，在[cascade](http://www.w3.org/TR/CSS2/cascade.html)中，**id** ( ) 选择器比 ab( ) 选择`#`器更[具体](http://www.w3.org/TR/CSS2/cascade.html#specificity)`.`。因此，id 语句中的规则将覆盖 class 语句中的规则。

例如，如果以下两个语句：

```
.headline {
  color:red;
  font-size: 3em;
}

#specials {
  color:blue;
  font-style: italic;
} 
```

应用于相同的 HTML 元素：

```
<h1 id="specials" class="headline">Today's Specials</h1> 
```

**color:blue**规则将覆盖**color:red**规则。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-02T14:25:27.927

对已经说过的内容进行了一些快速扩展...

An`id`必须是唯一的，但是您可以使用相同的 id 来使不同的样式更具体。

例如，给定这个 HTML 提取：

```
<div id="sidebar">
    <h2>Heading</h2>
    <ul class="menu">
        ...
    </ul>
</div>
<div id="content">
    <h2>Heading</h2>
    ...
</div>
<div id="footer">
    <ul class="menu">
        ...
    </ul>
</div> 
```

您可以使用这些应用不同的样式：

```
#sidebar h2
{ ... }

#sidebar .menu
{ ... }

#content h2
{ ... }

#footer .menu
{ ... } 
```

另一件有用的事情：你可以在一个元素上有多个类，通过空格分隔它们......

```
<ul class="main menu">...</ul>
<ul class="other menu">...</ul> 
```

它允许您`.menu`使用`.main.menu`和`.sub.menu`

```
.menu
{ ... }

.main.menu
{ ... }

.other.menu
{ ... } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-02T18:37:14.250

就像几乎每个人已经说过的那样：

句点 ( `.`) 表示**类别**，哈希 ( `#`) 表示**ID**。

两者的根本区别在于您可以在页面上反复重用一个类，而一个 ID 可以使用一次。当然，如果你坚持 WC3 标准的话。

如果您有多个具有相同 ID 的元素，页面仍然会呈现，但是如果/当您尝试通过使用其 ID 调用这些元素来动态更新所述元素时，您会遇到问题，因为它们不是唯一的。

注意 ID 属性将取代类属性也很有用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-02T12:40:40.627

`.class`针对以下元素：

```
<div class="class"></div> 
```

`#class`针对以下元素：

```
<div id="class"></div> 
```

请注意，id 在整个文档中必须是唯一的，而任意数量的元素可以共享一个类。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T12:40:35.510

# 是一个 id 选择器。它仅匹配具有匹配 id 的元素。下一个样式规则将匹配 id 属性值为“green”的元素：

```
#green {color: green} 
```

有关详细信息，请参阅[http://www.w3schools.com/css/css_syntax.asp](http://www.w3schools.com/css/css_syntax.asp)

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-05-20T07:25:11.880

这是我解释规则的方法`.style`，并且`#style`是矩阵的一部分。如果顺序不正确，它们可能会相互覆盖，或引起冲突。

这里是排队。

矩阵

```
#style 0,0,1,0 id

.style 0,1,0,0 class 
```

如果您想覆盖这两个，您可以使用`<style></style>`具有矩阵级别的女巫或`1,0,0,0.` @media 查询将覆盖上面的所有内容...我不确定这一点，但我认为 ID 选择器`#`只能在页面中使用一次。

# c++ - 在 VS2005 (C++) 中调试 DLL

> ID：602175
> 
> 赞同：1
> 
> 时间：2009-03-02T12:37:59.387
> 
> 标签：c++, debugging, dll, visual-studio-2005

我在要调试的解决方案中有一个 dll 项目。调用应用程序位于不同的路径中，并且 DLL 必须放置在该路径中。当我构建调试版本并将生成的 DLL 复制并粘贴到调用应用程序的路径中时，我收到一条错误消息，指出没有符号并且二进制文件不是由项目构建的。它问我是否要继续。此方法曾经在 Visual c++ 6.0 中工作，但现在它从未遇到任何断点。我如何在 VS2005 中执行此操作？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T12:49:59.140

确保 dll 的 pdb 文件也在应用程序的路径中。

或者使用 /Z7 编译器选项编译您的 dll，这将触发 MSVC 6.0 中使用的旧式调试信​​息。如果你像这样编译，你将能够只复制 dll。

或者在“模块”窗口中，右键单击您的 dll 并选择“加载符号”，然后将对话框指向 dll 的*原始*位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T12:44:00.073

同时复制 <你的 dll>。**数据库**

# iphone - 何时在 iPhone 中释放 NSString

> ID：602178
> 
> 赞同：13
> 
> 时间：2009-03-02T12:38:30.400
> 
> 标签：iphone, objective-c, cocoa

我有以下方法

```
 -(NSMutableArray *) getPaises {
     NSMutableArray * paises;
     paises = [[NSMutableArray alloc] init];
     while( get new row ) {
      NSString *aPais =  [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 0)];
      [paises addObject:aPais];
     }
     return paises;
    } 
```

我没有发布 aPais，因为如果我这样做，应用程序就会崩溃。我不知道何时或是否应该在使用后将其释放到某个地方，如果是，我该怎么做。仅仅释放 NSMutableArray 就够了吗？还是我必须遍历它并释放每个对象？

如果我不必发布它，谁负责发布？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-02T13:01:14.340

正如 epatel 所说，您不需要释放该特定字符串。如果你想更主动一些，你可以这样做：

```
-(NSMutableArray *) getPaises {
    NSMutableArray * paises;
    paises = [[[NSMutableArray alloc] init] autorelease];
    while( get new row ) {
        NSString *aPais =  [[NSString alloc] initWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 0)];
        [paises addObject:aPais];
        [aPais release];
    }
    return paises;
} 
```

总之：

*   [[NSString alloc] initWith...] -> 你必须释放或自动释放。

*   [NSString stringWith...] -> 无需释放。

- 编辑：添加`autorelease`了 paises，因为你正在返回它。当您返回一个对象时，如果您已分配并初始化它，请始终自动释放它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T12:48:38.347

`stringWithUTF8String:`返回一个自动释放字符串，它将在下一个事件循环中由 Cocoa 自动释放。但是当你这样做时，字符串也会保留在数组中`addObject:`......所以只要它在数组中，它就会被保留。

# html - 哪个是最好的免费可分发代码到 html 转换器

> ID：602193
> 
> 赞同：1
> 
> 时间：2009-03-02T12:41:12.047
> 
> 标签：html, syntax-highlighting, converter, formatter

在我的应用程序中，我需要将 Java/VB/VB.net/etc 程序转换为 HTML，然后使用该 HTML 页面（插入 Word 文档）。

当然我们可以为此编写代码，但这也需要为此进行编程，并且需要使用不止一种编程语言，并处理错误。而它需要尽快发布。使用 3rd 方工具生成此 HTML 不是问题。

然而，这个第 3 方工具，代码到 html 格式化程序，应该是免费的、健壮的，并且应该转换到 Java 1.5 和其他语言的最新版本。

您是否知道任何免费、可分发、健壮且可转换为多种语言（包括 Java）的最新版本的此类转换器（代码到 html 转换器/格式化程序）？

为了进一步阐述，我对一个将源代码文件作为输入并生成 HTML 文件作为输出的实用程序感兴趣。HTML 文件不应使用 javascript 为代码着色，因为在 Word 中插入着色将丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:00:07.977

[Pygments](http://pygments.org/)

Java 示例： http: [//pygments.org/demo/1476/](http://pygments.org/demo/1476/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T12:49:35.367

[Javadoc](http://java.sun.com/j2se/javadoc/)会将您的代码转换为 HTML（以及相关的类树和链接等），但遗憾的是不会语法高亮代码。您可以做的是将[Google Code Prettifier](http://code.google.com/p/google-code-prettify/)添加到每个页面，这可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T13:13:09.363

如果您想使用 JavaDoc 方式，我建议您使用[Natural Docs](http://www.naturaldocs.org/)。但是，如果您只想在页面上显示 Java 并转换为 CSS 格式的 HTML 部分，我建议您使用 Google 的[Code Prettify](http://code.google.com/p/google-code-prettify/)。查看 README 的链接以获取示例。您还可以查看[Java 测试页面](http://google-code-prettify.googlecode.com/svn/trunk/tests/prettify_test.html#java)以了解 Java 的外观。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T19:29:38.573

我正在使用[Java2HTML](http://www.java2html.de/)。它作为 Eclipse 插件运行，也可以从命令行或 ant 脚本运行。

它还可以转换为 TeX 和 XML。

# mercurial - 使用 Mercurial 分离私有和公共版本

> ID：602202
> 
> 赞同：11
> 
> 时间：2009-03-02T12:44:31.993
> 
> 标签：mercurial

您将如何使用 Mercurial 解决以下问题。

假设我有一个图书馆核心。我现在想为该库开发一个名为 Extension 的扩展。我想让 Core 在物理上与 Extension 分开，也就是说，Core 是一个开源库，而 Extension 是一个基于 Core 构建的私有库（也许它包含一些我想保持个人的东西。无论如何。）。显然，我不想将 Extension 中的整个源代码推送到公共存储库。但另一方面，我可能想将某些更改从扩展推送到核心（如果我决定将扩展的一部分“捐赠”到核心），反之亦然（如果我想合并错误修复，比如说）。

您将如何解决这个问题，最大限度地减少将 Extension 泄漏到 Core 的风险（一旦历史被推送到公共服务器，就没有回头路了！），同时保持灵活地为某些更改执行此操作。分支机构？克隆人？MQ？还有什么？

我目前只熟悉克隆存储库，非常喜欢它的简单性。

**编辑：** 我想出了这个方案，但我不能让它在 Windows 下工作。两个存储库（核心和扩展）。在 Extension 中有两个*分支*，也是 Core 和 extension。现在，您可以在 Mercurial 中为每个存储库注册一个钩子，因此我想在核心存储库中注册一个“pretxnchangegroup”钩子，该钩子不允许从扩展分支签入，如[Mercurial book 中所述](http://hgbook.red-bean.com/hgbookch8.html#x12-1680008.8)。除了我不太明白它在 Windows 下工作。所以：

*   任何人都有这样的例子（事实上，任何改变交易结果的钩子）在windows下？
*   我仍然可以使用移植来挑选从扩展到核心分支的更改，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T19:07:44.410

经过一些测试，我将尝试这个方案。两个主要存储库和两个命名分支，核心和扩展。

一个主要的核心存储库，它应该只包含核心变更集和源代码。因此，它应该只包含来自核心分支的变更集。这是使用该 repo 的 hgrc 中的以下存储库挂钩检查的：

`pretxnchangegroup.branch = hg heads --template "current branches: {branches} " | find "Extension" && exit 1 || exit 0`

看起来有点奇怪，但基本上它在推送或拉取完成后，但在提交之前被触发。此时，如果钩子失败，事务将回滚。所以钩子寻找扩展分支的变更集，如果找到它就会失败——有效地禁止扩展更改进入核心存储库。

第二个 repo 包含核心和扩展分支以及变更集，并且是在两个分支之间交换变更集的地方。正常从Core合并到Extension，从Extension移植到Core。

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:40:06.420

> （历史一推，就没有回头路了！）

当然有......这就是版本控制的全部内容！

我以前没有做过这样的事情，但听起来[移植](http://www.selenic.com/mercurial/wiki/index.cgi/TransplantExtension)命令会有所帮助。此外，您可以拥有克隆的克隆，并推送到其中的任何一个，等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T21:02:49.500

[Forest 扩展](http://www.selenic.com/mercurial/wiki/index.cgi/ForestExtension)允许您将多个存储库作为一个大存储库的一部分。听起来这可能会有所帮助。

# objective-c - Objective-C NSString 问题

> ID：602211
> 
> 赞同：4
> 
> 时间：2009-03-02T12:48:13.077
> 
> 标签：objective-c, nsstring

我需要从函数返回一个 NSString：

```
NSString myfunc ( int x )
{
    // do something with x  
    NSString* myString = [NSString string];
    myString = @"MYDATA";   
    // NSLog(myString);

    return *myString;       
} 
```

所以，我调用这个函数并得到 *myString。那是指向数据的指针吗？如何获取数据“MYDATA”？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T12:58:30.133

我会用以下方式重写这个函数：

```
NSString* myfunc( int x )
{
   NSString *myString = @"MYDATA";

   // do something with myString
   return myString;        
} 
```

在 Objective-C 中，更常见的是使用指向对象的指针，而不是对象本身，即在您的示例中使用`NSString*`, not `NSString`。

而且，`@"MYDATA"`已经是一个字符串，所以你不需要在赋值之前分配和初始化myString。

# linux - Linux终端中的双倍行距

> ID：602212
> 
> 赞同：0
> 
> 时间：2009-03-02T12:48:16.850
> 
> 标签：linux, debugging

有谁知道是否可以强制终端将 \n 附加到它打印的每一行（或类似的东西）？

我正在尝试调试一些疯狂的代码，这些代码给我的错误是我的（24 英寸）屏幕的全宽和三行长，所以我很感激不必将内容复制到 gedit 并在每次按下 make 时手动将它们分开.

干杯，埃德

注意我正在使用“make 2>&1 | more”所以我不能只做“| sed G”

（为清楚起见进行了编辑）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T12:52:12.050

如果您只想将命令或其他内容的输出加倍，则可以通过 sed 将其通过管道传输到加倍空格：

$> 你的命令 | sed G

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T13:16:50.213

如果你想在整个终端上改变它，你可以在你的 .bash_rc 文件中的 PS1 变量上附加 '\n' 。

例如：

```
PS1 = '\n> ' 
```

**编辑：**这将在您在命令提示符下输入的命令之间添加换行符，但不会影响应用程序的输出。

# model - 建模消息队列

> ID：602222
> 
> 赞同：1
> 
> 时间：2009-03-02T12:51:16.843
> 
> 标签：model, tcp, queue, simulator

我有这个系统，它由许多不同的阶段组成。具体来说，我有很多不同的进程通过 tcp-ip 进行通信；消息通过面向数据包的协议进行交换（如果满足某些条件，可以将更多消息填充到单个有线协议数据单元中）；我也控制了流队列——套接字是非阻塞的，如果我无法发送我的队列消息，甚至将它们合并到发送队列中；当然，运行时发生的事情取决于下面的 tcp ip 控制流，所以我也想对 tcp ip 队列进行建模。所以问题是 - 任何人都可以分享他们对如何为我的系统进行模拟的想法吗？我想为它制作一个模拟器 - 即：一个为我的模型中的每个队列提供队列数据结构的程序，对于每次滴答，我都会根据我对系统的理解使模型演变，即如果我的模型中 tcp 缓冲区的数据结构说它有足够的空间，我会减少输出队列中的消息编号并减少可用空间计数器tcp 缓冲区模型由消息的大小等等 - 然后我根据 tcp 链路的带宽以一定的速率使 tcp 缓冲区为空（当然我假设我正在抽取大量数据和tcp 链路的唯一参数是带宽）。构建这样的东西似乎需要付出很多努力，我不确定它是否是我需要的。也许我最好使用某种 excel 电子表格模型，但我不确定如何构建它。如果我的模型中的 tcp 缓冲区的数据结构表明它有足够的空间，我会减少输出队列中的消息编号，并将 tcp 缓冲区模型中的可用空间计数器减少消息的大小，等等 - 然后我做tcp 缓冲区以基于 tcp 链路带宽的速率清空（当然，我假设我正在抽取大量数据并且 tcp 链路的唯一参数是带宽）。构建这样的东西似乎需要付出很多努力，我不确定它是否是我需要的。也许我最好使用某种 excel 电子表格模型，但我不确定如何构建它。如果我的模型中的 tcp 缓冲区的数据结构表明它有足够的空间，我会减少输出队列中的消息编号，并将 tcp 缓冲区模型中的可用空间计数器减少消息的大小，等等 - 然后我做tcp 缓冲区以基于 tcp 链路带宽的速率清空（当然，我假设我正在抽取大量数据并且 tcp 链路的唯一参数是带宽）。构建这样的东西似乎需要付出很多努力，我不确定它是否是我需要的。也许我最好使用某种 excel 电子表格模型，但我不确定如何构建它。依此类推 - 然后我根据 tcp 链路的带宽以一定的速率使 tcp 缓冲区清空（当然，我假设我正在抽取大量数据并且 tcp 链路的唯一参数是带宽）。构建这样的东西似乎需要付出很多努力，我不确定它是否是我需要的。也许我最好使用某种 excel 电子表格模型，但我不确定如何构建它。依此类推 - 然后我根据 tcp 链路的带宽以一定的速率使 tcp 缓冲区清空（当然，我假设我正在抽取大量数据并且 tcp 链路的唯一参数是带宽）。构建这样的东西似乎需要付出很多努力，我不确定它是否是我需要的。也许我最好使用某种 excel 电子表格模型，但我不确定如何构建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T13:26:58.660

[通过使用离散事件仿真](http://en.wikipedia.org/wiki/Discrete_event_simulation)工具或库，您可能会得到一个仍然有用但更简单的模型。您仍然必须以模型理解的形式复制应用程序的大部分结构，但要获得用于注入不同分布的消息速率的工具，并且可能更容易处理不同的场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T14:14:05.660

You could use [Ronald Szeto's TCP Simulator](http://www.csse.monash.edu.au/hons/projects/2002/Siuwing.Szeto/). It has a Java interface to it. I wouldn't try to get so complicated with paired queues. Just model your system, and then use this simulator to model the underlying network conditions, and link them together as you would have in your OS. I'm assuming you probably don't have separate network queues on your real system for every one in your application.

# cakephp - 如何在 CakePHP 中提供附加条件的同时查询基于 HABTM 关系的表？

> ID：602227
> 
> 赞同：1
> 
> 时间：2009-03-02T12:52:11.443
> 
> 标签：cakephp

我如何在 CakePHP 中做到这一点：我正在使用具有多对多关系的两个表 (`regions`和)。`safaris`这些表由另一个名为`regions_safaris`（带有字段`region_id`& `safari_id`）的表连接。我想获取所有`safaris`满足给定标准的信息，例如 5 天的持续时间和给定区域。这应该在 CakePHP 中实现

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T17:46:22.250

朱马，

请抵制这么快多次发帖。

如需更多参考，请参阅 Cakebook Has-And-Belongs-To-Many 关系。这正是你所描述的。见[http://book.cakephp.org/view/83/hasAndBelongsToMany-HABTM](http://book.cakephp.org/view/83/hasAndBelongsToMany-HABTM)

简而言之，假设您正确设置了 Cake 模型（在区域、safaris 和 region_safaris 之间建立了 HABTM 关系；检查模型中 var $hasAndBelongsToMany 数组上的“joinTable”索引），您可以这样做：

```
 class SafariModel extends AppModel
   { 
     var $name = 'Safari';
     var $hasAndBelongsToMany = array( 'Tag'=>array( ..., 'joinTable'=>'regions_safaris', ... );

     function findSafaris( $duration = 5, $region = null )
     {
       return $this->find('all', array('conditions'=>array('Region.region_name'=>$region, 'Safari.duration'=>$duration) );
     }
     ... // rest of class
   } 
```

# iphone - 在我的 iPod Touch（不是 iPhone）上测试我的 iPhone / iPod 应用程序需要做什么？

> ID：602231
> 
> 赞同：3
> 
> 时间：2009-03-02T12:54:03.247
> 
> 标签：iphone, ipod-touch

我正在为我的 iPod Touch 开发一个应用程序，它不使用 iPhone 专用硬件，如电话或摄像头。我想在我的 iPod touch 上测试它。我已经是注册开发者（免费帐户，不收费）。让我的应用程序在我的 iPod touch 上运行的步骤是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T03:42:19.703

您需要支付 99 美元的费用才能在任何设备（iPhone 或 iPod Touch）上进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T03:55:09.890

你需要支付 99 美元的开发者费用，成为 iPhone 开发者。这将让您在 iPhone 或 iPod 上安装您的应用程序。如果您越狱了 iPod touch 或 iPhone，您也可以免费执行此操作。

# c# - 对从网络摄像头拍摄的照片进行形状识别

> ID：602232
> 
> 赞同：4
> 
> 时间：2009-03-02T12:54:30.190
> 
> 标签：c#, image

我想提取信息是否有人在从本地网络摄像头拍摄的一些照片上。我知道如何提取光信息，找到最亮的点或其中的几个，但是如何识别某些图像上的形状？

我已经开始了 C# 项目，我正在使用 AForge 库将一些过滤器应用于捕获的图像，但我非常坚持形状识别。

我应该从哪里开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T12:59:33.360

您可能会在 codeplex 上查看图像识别项目。

[http://www.codeplex.com/IR](http://www.codeplex.com/IR)

它是一个用 C# 编写的开源 .NET 项目。这应该是一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T13:09:41.777

您可以通过使用 haar 级联的[OpenCV来做到这一点。](http://www.youtube.com/watch?v=o1WNb0g0f9Q)

甚至还有一个可用于非商业用途的分类器 - 请参阅[http://code.google.com/p/ehci/wiki/HandTracking](http://code.google.com/p/ehci/wiki/HandTracking)

# history - “你好世界”从何而来？

> ID：602237
> 
> 赞同：118
> 
> 时间：2009-03-02T12:55:27.487
> 
> 标签：history

' `hello, world`' 通常是任何编程语言的第一个示例。我一直想知道这句话是从哪里来的，它最初是在哪里使用的。

曾经有人告诉我，这是有史以来第一个出现在电脑屏幕上的句子，但我找不到任何关于它的参考资料。

所以我的问题是：
使用 ' `hello, world`' 作为计算机语言的第一个示例的做法从何而来？
它最初是在哪里使用的？

**更新**
虽然答案很有趣，但我应该注意到我已经阅读了维基百科的文章。它确实回答了有关文献中第一次使用的问题，但没有回答“ `hello world`”何时首次*使用*。
所以我认为可以断定这不是第一个出现在电脑屏幕上的句子，也没有关于它何时首次使用的记录？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-10-08T15:54:42.590

Brian Kernighan 实际上编写了第一个“hello, world”程序，作为 Martin Richards 开发的 BCPL 编程语言文档的一部分。在 1972 年 Kernighan 和 Ritchie 的 C 书出版前几年，贝尔实验室正在开发 C 语言时使用了 BCPL。

[![在此处输入图像描述](https://i.stack.imgur.com/wU0xv.png)](https://i.stack.imgur.com/wU0xv.png)

作为我正在撰写的关于 Alice 编程环境的一本书的研究的一部分，我与普林斯顿大学的 Kernighan 教授和剑桥大学的 Martin Richards 都进行了通信（当我在 1990 年代在那里教授一个研讨会时）。他们帮助我追踪了第一次记录使用的代码来打印消息“Hello, World!”。Brian Kernighan 记得为 BCPL 手册的 I/O 部分编写代码。Martin Richards——他似乎拥有大量笔记、旧文档等——找到了该手册并确认这是原版程序的外观。该代码用于 C 编译器的早期测试，并进入 Kernighan 和 Ritchie 的书中。后来，它是用于测试 Bjarne Stroustrup 的 C++ 编译器的首批程序之一。

在出现在 Kernighan 和 Ritchie 之后，它成为了新程序员的标准，这可能是有史以来最畅销的编程介绍。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-02T12:58:41.117

根据[维基百科](http://en.wikipedia.org/wiki/Hello_world_program#History)：

> 虽然自可编程计算机开发以来就存在小型测试程序，但使用短语“Hello world！”的传统 作为测试消息，它受到开创性书籍 The C Programming Language 中的示例程序的影响。该书中的示例程序打印“hello, world”（没有大写字母或感叹号），并继承自 Brian Kernighan 1974 年贝尔实验室的内部备忘录，《C 语言编程：教程》，其中包含第一个已知版本：
> 
> ```
>  main() {
>         printf("hello, world");
>  } 
> ```
> 
> 第一个已知的在计算机文献中同时使用“hello”和“world”这两个词的实例发生在 Kernighan 1972 年的语言 B 教程简介 [1] 中，代码如下：
> 
> ```
> main( ) {
>   extrn a, b, c;
>   putchar(a); putchar(b); putchar(c); putchar('!*n');
> }
> a 'hell';
> b 'o, w';
> c 'orld'; 
> ```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-02T12:57:33.707

《The C Programming Language》一书中的第一个 C 程序是打印“hello world！”。屏幕上。

从那时起，它被用作第一个介绍编程语言基本细节的程序。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-02T13:00:32.453

来自[http://en.wikipedia.org/wiki/Hello_world_program](http://en.wikipedia.org/wiki/Hello_world_program)：

> 第一个已知的在计算机文献中同时使用“hello”和“world”这两个词的实例发生在 Kernighan 1972 年的语言 B 教程简介 [1] 中，代码如下：
> 
> ```
> main( ) {
>   extrn a, b, c;
>   putchar(a); putchar(b); putchar(c); putchar('!*n');
> }
> a 'hell';
> b 'o, w';
> c 'orld'; 
> ```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-20T03:29:11.920

我应该在我原来的帖子中对语言更加小心——

当然，*巴洛普*是对的，K&R 于 1978 年出版。我的帖子中缺少昏迷。我的意思是，带有 Kernighan 博士的 Hello World 代码的 BCPL 手册的日期为 1972 年。提及此内容的备忘录是 1974 年的。

马丁理查兹有这些文件。我有一份不好的手册复印件和一份备忘录复印件。

我相信原文没有标点符号。

BCPL 和 B 码几乎同时出现。我一直认为这里引用的 B 代码是第一位的，但 Martin Richards 似乎认为 BCPL 代码是第一位的*。*无论哪种情况，“Hello Word！” 早于 K&R，它在代码中的首次记录使用似乎是由贝尔实验室的 Brian Kernighan 编写的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T12:59:39.087

我第一次看到它是（我认为）K&R 的第一版，所以应该是 1982 年左右，但在那之前很久我就一直在编写自己的“Hello world”程序，就像其他人一样。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T13:00:32.407

来自维基百科

> 虽然自可编程计算机开发以来就存在小型测试程序，但使用短语“Hello world！”的传统 作为测试消息，它受到开创性书籍 The C Programming Language 中的示例程序的影响。该书中的示例程序打印“hello, world”（没有大写字母或感叹号），并继承自 Brian Kernighan 1974 年贝尔实验室的内部备忘录，《C 语言编程：教程》，其中包含第一个已知版本：

[http://en.wikipedia.org/wiki/Hello_world_program](http://en.wikipedia.org/wiki/Hello_world_program)

# c# - 覆盖窗口菜单

> ID：602239
> 
> 赞同：0
> 
> 时间：2009-03-02T12:55:53.370
> 
> 标签：c#, menu

我需要阻止 windows 菜单：当我按下键盘上的 windows 按钮时，我不希望执行任何操作，我应该如何以编程方式执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T12:59:32.657

它实际上是一个注册表黑客。请阅读 MS 的[支持页面](http://support.microsoft.com/kb/216893)。您可以尝试通过您的程序添加注册表项。

或者干脆从键盘上取下钥匙。

编辑：花了 5 秒在 Google 中搜索您的答案。这比您输入问题所花费的时间要少。

# performance - 如何使用 SQL 选择给定工作日的条目？

> ID：602245
> 
> 赞同：0
> 
> 时间：2009-03-02T12:56:51.433
> 
> 标签：performance, sqlite

我可以使用此查询来选择日期为星期一的所有订单：

```
SELECT * from orders WHERE strftime("%w", date)="1"; 
```

但据我所知，这不能使用索引来加快速度，因为`strftime`必须计算每一行。

我可以添加一个额外的字段来存储工作日，但我想避免它。有没有使用索引的解决方案，或者我错了，这个查询实际上工作正常？（这意味着它不必遍历每一行来计算结果。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:08:36.210

如果您想要**所有**星期一，则需要进行现场扫描或顺序扫描。您可以做的是计算一年内所有星期一的实际日期。条件`WHERE date IN ('2009-03-02', '2009-02-23', ...)`将使用索引

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:13:39.457

或者作为 vartec 建议的替代方案，构建一个日历表，该表仅包含一年中每一天的日期和日期名称（均已编入索引），然后通过对此表执行 JOIN 来执行查询。

# java - AttributedString 的“内容”可以保存在文件中吗？

> ID：602249
> 
> 赞同：1
> 
> 时间：2009-03-02T12:58:03.177
> 
> 标签：java, swing, graphics

我正在研究如何在 Graphics2D 上“绘制”一些属性文本。

所以，我很感兴趣是否可以以某种格式保存 AttributedString 的内容？

我知道它可以是 Java 序列化的，但是，我在这里不需要那个解决方案。

另外，如果有人知道一些显示如何编辑 AttributedString 的示例？

这是一些Java代码，只是为了了解一下：

```
public void paint(Graphics g) {

Graphics2D g2 = (Graphics2D) g;

AttributedString as new AttributedString( "Lorem ipsum dolor sit amet..." );
Font font1 = new Font( "SansSerif" , Font.PLAIN , 20 );
as.addAttribute( TextAttribute.FONT       , font1       );
as.addAttribute( TextAttribute.FOREGROUND , Color.black );
as.addAttribute( TextAttribute.FOREGROUND , Color.blue , 4 , 9 );

AttributedCharacterIterator aci = as.getIterator();
FontRenderContext           frc = g2.getFontRenderContext();
LineBreakMeasurer           lbm = new LineBreakMeasurer( aci , frc );

TextLayout  textLayout = lbm.nextLayout( wrappingWidth );

int x = 50 , y = 50 ;
textLayout.draw( g2 , x , y );

} 
```

感谢任何帮助或建议:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:16:21.807

显然，最简单的方法是 java 序列化，否则您将需要处理所有可能的文本属性。如果你想要一个例子，这里是我编写的一个报告生成器，它广泛使用了 AttributedString。希望它会有所帮助： [http ://www.perry.ch/mo/pureport.zip](http://www.perry.ch/mo/pureport.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T01:42:32.100

AttributedString 没有文本序列化格式，您必须自己编写。

AttributedString/AttributedCharacterIterator 是在 Java 1.2 中首次引入的旧 API，并且从未被“加强”以提供良好样式的文本模型。例如，您会注意到它缺少一些明显的东西，例如“length()”方法或实现 Externalizable/Serializable。您可以通过为其获取 AttributedCharacterIterator 来对其进行迭代，但是由于可以存在 AttributedCharacterIterator.Attribute 的自定义子类，因此如果没有本机序列化，您将无法可靠地记录所有内容。

最好只使用 AttributedString 作为与 InputMethod 或 TextLayout API 对话的中间格式，并以其他方式存储您的样式文本。

# ruby-on-rails - 使用 Warbler，我如何从捆绑的 gem 中排除 Active Record？

> ID：602259
> 
> 赞同：1
> 
> 时间：2009-03-02T13:00:01.003
> 
> 标签：ruby-on-rails, ruby, rubygems, jruby

使用 Warbler 时，我需要添加哪些行`config/warble.rb`以防止它在捆绑的 gem 中包含 Active Record。我已经排除了 Active Record，`config/environment.rb`如下所示。

```
config.frameworks -= [ :active_record ] 
```

我只使用`config.gems`in尝试了同样的事情`config/warble.rb`，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T20:29:23.327

我无法尝试这些想法中的任何一个，但看看[Nick Sieger 的例子](http://github.com/nicksieger/jruby-rack/)：-

*   宝石名称是否必须是字符串而不是符号？
*   看起来`activerecord`可能被隐式包含，因为`config.gems`包含`rails`和`config.gem_dependencies = true`. 也许您需要更改`config.gem_dependencies`为`false`并明确包含`rails`,`actioncontroller`等`config.gems`。

在文件中打印或记录`config.gems`from的值可能是有益的`warble.rb`。

# c# - 在 Web 项目使用的库中获取正确的绝对路径

> ID：602265
> 
> 赞同：1
> 
> 时间：2009-03-02T13:01:10.737
> 
> 标签：c#, absolute-path

我有一个 asp.net mvc 项目，它在单独的库中使用一些搜索方法。这个库需要知道我的 lucene 索引文件的位置。

```
 private static string lucenePath = ConfigurationManager.AppSettings["lucenePath"];

    public static ColorList SearchColors(Query query) {
        return new ColorList(
            new IndexSearcher(Path.GetFullPath(lucenePath)),
            query);
    } 
```

这会从 web.config 的应用程序密钥节点正确读取我配置的 lucenePath。但是我怎样才能从这个相对路径中得到正确的完整路径呢？Path.GetFullPath 给了我一个完全不正确的路径。

**--结论--**
如果您想全力以赴，[tvanfosson](https://stackoverflow.com/questions/602265/getting-correct-absolute-path-in-library-used-by-web-project/602304#602304)的答案可能适合您。
但是，我通过使用以下方法使其脑死亡更多：

```
Path.Combine(AppDomain.CurrentDomain.BaseDirectory,
    ConfigurationManager.AppSettings["luceneIndex"].TrimStart('\\')); 
```

这将在调用者的 app.config 中查找名为“path”的 appkey，并将其值与调用者的路径结合起来。TrimStart() 确保配置文件都可以包含前导 \ 或不包含。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:02:39.343

```
Server.MapPath(string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T13:11:13.177

由于您是从一个单独的库中引用它，因此您可能必须跳过一堆圈才能访问 HttpServerUtitity 或引入一些与难以模拟的类的耦合。您可能需要考虑使用一个配置类，该类从 Web 配置中加载属性，这些属性通过构造函数/设置器注入到您的库中。为了更容易进行测试，您可以定义一个可以在单元测试中模拟的接口并让它实现它。配置类可以使用 HttpServerUtility 获取绝对路径并将其存储在内部以供重用。

# mobile - 针对各种移动设备的最佳框架

> ID：602269
> 
> 赞同：1
> 
> 时间：2009-03-02T13:02:31.667
> 
> 标签：mobile, frameworks, client-server, bluetooth, mobile-phones

我正在尝试在客户端 - 服务器模型上构建移动应用程序，其中客户端是人们的移动设备，服务器是 PC - 全部通过蓝牙连接。

我希望客户端非常瘦——足以建立通信、显示一些文本和中继用户输入。

最好的开发框架是什么？我想要最大可能的设备兼容性（例如，不仅仅是 60 系列的 capabale 设备），而不是很酷的功能 - 但是能够轻松扩展到彩色设备或具有更高显示分辨率的设备会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:24:36.590

最简单的方法可能是编写使用[蓝牙 API 的 MIDP 应用程序。](http://developers.sun.com/mobility/midp/articles/bluetooth2/)这以最少的努力涵盖了最广泛的设备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T11:59:54.383

在当前的移动领域，最大的安装基础 + 有限的功能 = 使用 JavaME。请参阅[http://java.sun.com](http://java.sun.com)以及 stackoverflow j2me 和 javame 标签。

# installation - 如何使用 InstallScript InstallShield 设置 PATH（环境变量）

> ID：602274
> 
> 赞同：2
> 
> 时间：2009-03-02T13:03:17.907
> 
> 标签：installation, installshield

我正在尝试使用 InstallScript 为 InstallShield 8 设置路径（环境变量）。函数 EzBatchAddPath("PATH", "C:\Windows", "", AFTER); 只能在 autoexec.bat 设置为 ReadOnly=false 和 Hidden=false 时使用。

是否有其他方法可以在没有这些限制的情况下执行相同的操作

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T23:17:04.453

为什么不使用包装脚本或类似脚本在运行时更新路径，如果用户路径中的其他可执行文件与您的可执行文件的名称冲突怎么办？这是一个非常不可靠的解决方案

# .net - StringWriter 或 StringBuilder

> ID：602279
> 
> 赞同：76
> 
> 时间：2009-03-02T13:04:53.003
> 
> 标签：.net, stringbuilder, stringwriter

我应该使用其中一个或另一个之间有什么区别`StringWriter`以及`StringBuilder`何时使用？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-06-15T10:29:28.890

我认为任何现有的答案都不能真正回答这个问题。两个类之间的实际关系是[适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)的一个例子。

`StringWriter`通过转发到它存储在字段中`Write...`的实例来实现其所有方法。`StringBuilder`这不仅仅是一个内部细节，因为`StringWriter`有一个返回内部字符串构建器的公共方法[GetStringBuilder](http://msdn.microsoft.com/en-us/library/system.io.stringwriter.getstringbuilder.aspx)，还有[一个](http://msdn.microsoft.com/en-us/library/5hshta06.aspx)允许您传入现有`StringBuilder`.

一个适配器也是如此`StringWriter`，它允许`StringBuilder`被期望与`TextWriter`. 就基本行为而言，它们之间显然没有任何选择......除非您可以测量转发呼叫的开销，在这种情况下`StringWriter`会稍微慢一些，但这似乎不太可能是重要的。

那么他们为什么不直接制作`StringBuilder`工具呢？`TextWriter`这是一个灰色地带，因为界面背后的意图并不一定总是乍一看很清楚。

`TextWriter`几乎是接受字符流的接口*。*但它还有一个额外的问题：一个名为[Encoding](http://msdn.microsoft.com/en-us/library/system.io.stringwriter.encoding.aspx)的属性。这意味着它`TextWriter`是一个接受字符流*并将它们转换为字节*的东西的接口。

这是一个无用的痕迹，`StringWriter`因为它不执行编码。[文档](http://msdn.microsoft.com/en-us/library/system.io.stringwriter.encoding.aspx)说：

> 对于某些必须写入包含 StringWriter 使用的编码的标头的 XML 方案，此属性是必需的。这允许 XML 代码使用任意 StringWriter 并生成正确的 XML 标头。

但这不可能是正确的，因为我们无法指定 for 的`Encoding`值`StringWriter`。该属性始终具有值`UnicodeEncoding`。因此，任何检查此属性以在其中构建 XML 标头的代码总是会说`utf-16`. 例如：

```
var stringWriter = new StringWriter();
using (var xmlWriter = XmlWriter.Create(stringWriter))
    xDocument.WriteTo(xmlWriter); 
```

这会产生标题：

```
<?xml version="1.0" encoding="utf-16"?> 
```

如果您使用[File.WriteAllText](http://msdn.microsoft.com/en-us/library/ms143375)将 XML 字符串写入文件会怎样？默认情况下，您将拥有一个`utf-8`带有`utf-16`标题的文件。

`StreamWriter`在这种情况下，使用，并使用文件路径或 a 构造它会更安全`FileStream`，或者如果您想检查数据然后使用 a`MemoryStream`并[获得一个字节数组](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)。所有这些组合将确保字节编码和标头生成由`Encoding`您的`StreamWriter`.

该`Encoding`属性的目的是允许字符流的生成器将有关编码的准确信息包含到字符流本身中（例如在 XML 示例中；其他示例包括电子邮件标题等）。

但是通过引入`StringWriter`，内容生成和编码之间的联系被打破，因此这种自动机制停止工作并变得容易出错。

然而，`StringWriter`如果您小心，它是一个有用的适配器，即您了解您的内容生成代码不应依赖于无意义的`Encoding`属性值。但是这种警告通常与适配器模式有关。这通常是一种技巧，可以让您将方形但几乎是圆形的钉子安装到圆孔中。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-02T13:13:32.220

[`StringWriter`](http://msdn.microsoft.com/en-us/library/system.io.stringwriter.aspx)派生自[`TextWriter`](http://msdn.microsoft.com/en-us/library/system.io.textwriter.aspx)，它允许各种类编写文本而不关心它的去向。在 的情况下`StringWriter`，输出只是进入内存。如果您正在调用需要 a`TextWriter`但您只想在内存中建立结果的 API，则可以使用它。

[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)本质上是一个缓冲区，它允许您对“逻辑字符串”执行多个操作（通常是追加），而无需每次都创建新的字符串对象。您将使用它在多个操作中构造一个字符串。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-07-22T09:49:39.250

建立在以前的（好的）答案的基础上，`StringWriter`实际上比`StringBuilder`提供了很多重载。

例如：

虽然`StringBuilder`只接受一个字符串或什么都不接受`AppendLine`

```
StringBuilder sb = new StringBuilder();
sb.AppendLine("A string"); 
```

`StringWriter`可以直接取字符串格式

```
StringWriter sw = new StringWriter();
sw.WriteLine("A formatted string {0}", DateTime.Now); 
```

使用`StringBuilder`, 必须这样做（或使用`string.Format`, 或`$""`）

```
sb.AppendFormat("A formatted string {0}", DateTime.Now);
sb.AppendLine(); 
```

不做或死的东西，但仍然有区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T13:09:46.753

该类`StringBuilder`基本上是一个可变字符串，一个*构造*不可变字符串的辅助类。`StringWriter`构建在顶部以添加更多方便的字符串格式化功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T13:07:36.727

A[`StringWriter`](http://msdn.microsoft.com/en-us/library/system.io.stringwriter.aspx)用于将文本写入~~一份文件~~memory 和 a[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)用于以节省内存的方式将字符串附加在一起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T13:07:52.827

`StringBuilder`用于批量字符串连接。它对超过 5 个字符串更有效，据我所知，然后`String.Concat()`. 也可以与特定格式（`.AppendFormat()`）一起使用

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-11-13T01:48:02.460

`StringBuilder`并`StringReader`用于在不同情况下提高性能。
**用于** `StringBuilder`提高字符串操作的性能，例如连接、重复修改字符串。

```
Random rnd = new Random();
StringBuilder sb = new StringBuilder();

// Generate 10 random numbers and store in sb.
for (int i = 0; i < 10; i++)
{
    sb.Append(rnd.Next().ToString("N5"));
}
Console.WriteLine("The original string:");
Console.WriteLine(sb.ToString());

// Decrease each number by one.
for (int ctr = 0; ctr < sb.Length; ctr++)
{
    if (Char.GetUnicodeCategory(sb[ctr]) == System.Globalization.UnicodeCategory.DecimalDigitNumber)
    {
        int number = (int)Char.GetNumericValue(sb[ctr]);
        number--;
        if (number < 0)
            number = 9;

        sb[ctr] = number.ToString()[0];
    }
}
Console.WriteLine("\nThe new string:");
Console.WriteLine(sb.ToString()); 
```

**用于** `StringReader`在单独的行中解析大量文本，并在处理数据时最大限度地减少内存使用。请参阅下一个示例，其中 StringReader 上的 ReadLine 方法仅扫描从当前位置开始的下一个换行符，然后根据字段字符串返回一个 sbstring。

```
using (StringReader sr = new StringReader("input.txt"))
{
    // Loop over the lines in the string or txt file.
    int count = 0;
    string line;
    while((line = sr.ReadLine()) != null)
    {
        count++;
        Console.WriteLine("Line {0}: {1}", count, line);
    }
} 
```

# tfs - 我应该在哪里存储团队构建的通用目标？

> ID：602281
> 
> 赞同：2
> 
> 时间：2009-03-02T13:05:31.817
> 
> 标签：tfs, msbuild, tfsbuild, targets

我正在尝试设置一个 common.targets 文件，其中包含一些我想在团队构建中使用的常见 msbuild 目标，因此导入到我的 TFSBuild.proj 文件中。我想知道实现这一目标的最佳方法是什么？我是否需要将 common.targets 存储在每个 TFSBuild.proj 文件旁边，因此每个团队构建都有目标文件的副本，还是有其他方法？我宁愿不将目标文件放在每台构建机器上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T18:25:22.167

将它放在源代码管理中您喜欢的公共位置。在使用目标之前，请像这样从 TFSBuild.proj 文件中获取：

```
<PropertyGroup>
  <!--Path to the TFS Command Line (used for checkin and out)-->
  <TxTf>&quot;C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\tf&quot;</TxTf>

  <WorkingDirectory>C:\YourPathHere<WorkingDirectory>
  <CustomProjTFSDir>&quot;$/YourProj/YourCustomProjPath&quot;</CustomProjTFSDir>
</PropertyGroup>

<Exec WorkingDirectory="$(WorkingDirectory)"
      Command="$(TxTf) get $(CustomProjTFSDir)"/> 
```

这项工作的关键是为您的构建代理用户设置一个指向您的自定义内容的工作区。此目录不应与您的正常构建位于同一空间。

瓦卡诺

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T00:54:27.013

在调用 TFSBuild.proj 之前，Team Build 有一个引导阶段，在该阶段仅从源代码管理下载同一目录中的 TFSBuild.proj 和其他文件。因此，如果您希望您的目标文件受源代码控制，则需要将其放在与 TFSBuild.proj 相同的位置

[此答案中的更多详细信息](https://stackoverflow.com/questions/97349/tfsbuild-proj-and-importing-external-targets/100493#100493)

我从未尝试过，但您可以将目标文件放在网络共享上，然后使用 unc 共享导入它。就像是

```
<Import Project="\\anothermachine\share\something.targets"/> 
```

但这需要构建帐户和所有运行桌面构建的人都可以访问该网络共享。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T14:36:34.407

通用 .targets 文件的目标是减少脚本的重复。如果您在源代码管理下有此文件的多个副本，当您需要更改它们时会发生什么（可能更新 .exe 路径）？就个人而言，我更喜欢任何/所有其他构建脚本可以引用的公共文件的单独位置。唯一的缺点是您可能会硬编码此文件的路径。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T15:48:03.423

您可以将它们与 MS 目标一起存储在 $Volume\Program Files\MSBuild 中。这样做的好处是您可以使用内置的已知元数据“$(MSBuildExtensionsPath)\Path\To\Your\Targets”创建相对路径

# jquery - 如何强制没有内容的 TD 呈现其边框？

> ID：602285
> 
> 赞同：1
> 
> 时间：2009-03-02T13:07:30.597
> 
> 标签：jquery, internet-explorer, fadeout, html-table

TD有一个DIV，我使用jQuery的fadeOut函数删除了它，但是当它完成时边框也消失了。

我想避免这种情况，除了添加“ ”之外还有其他方法吗？（这导致它很丑）？

编辑：我正在使用 Internet Explorer（6 和 7）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T13:08:44.803

CSS：

```
table {
  empty-cells: show;
} 
```

您还需要将 IE 置于标准渲染模式才能正常工作。添加 doctype 后，至少 IE8（Beta 2 和更高版本）可以正常运行。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
 "http://www.w3.org/TR/html4/loose.dtd"> 
```

IE7及以下仍然不会这样做。[在 MS CSS 兼容性声明](http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx)中，支持`empty-cells`被称为“部分”（针对 IE7 和 IE8 Beta 1）。无论“偏”是什么意思，不执行“秀”都很难称得上是“偏支持”。这些浏览器可以通过通常折叠表格边框来强制绘制单元格边框：

```
table {
  border-collapse: collapse;   
} 
```

的设置`empty-cells`被忽略。但是一旦你折叠了边框，你无论如何都不需要设置它，因为所有的浏览器都会显示折叠的边框。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T13:46:12.313

向单元格添加不间断空格：

`<td>&nbsp;</td>`

一个 hack，但比添加图像更好的 hack。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T13:48:46.317

<td style="font-size: 1pt"> <td>

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T13:22:41.493

我最终按照 [Jukka "Yucca" Korpela 的建议](http://www.cs.tut.fi/~jkorpela/HTML/emptycells.html)向单元格添加了一个透明的 1px 图像。现在，如果没有更好的选择，我将使用此解决方案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T13:37:07.153

根据您要完成的具体任务，您可以将`visibility`div 的 -property设置为，`hidden`而不是将其`display`-property 设置为`none`，即您必须恢复`display` ~~和`opacity`~~并`visibility`在调用后手动设置`fadeOut()`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T14:18:12.563

因此，如果您有如下表格：

```
<table border="1">
<tr>
 <td>Breakfast</td>
 <td><div id="foo">Lunch</div></td>
 <td>Dinner</td></tr>
</table> 
```

而你用 jQuery 淡出，午餐，为什么不用淡入带回一个空白的空呢？

如下所示：

```
$("#foo").fadeOut("slow").html('').fadeIn("fast"); 
```

# c# - .Net Crystal Report 打印应用程序在会话断开时在终端服务连接错误上运行

> ID：602295
> 
> 赞同：4
> 
> 时间：2009-03-02T13:08:53.587
> 
> 标签：c#, crystal-reports, remote-desktop

我创建了一个 .Net 应用程序以在应用程序服务器上运行，该应用程序服务器获取报告请求并打印出请求的报告。

C# 应用程序使用 Crystal Reports 加载报表并随后将其打印出来。

该应用程序在服务器上运行，该服务器通过特定用户帐户下的远程桌面连接（旧应用程序需要）连接到该服务器。当我从远程会话断开连接时，应用程序开始引发异常，例如：

*消息：CrystalDecisions.Shared.CrystalReportsException：加载报告失败*

当远程会话处于活动状态时，永远不会引发此类错误。运行该应用程序的服务器正在运行 Windows Server 2003，我创建连接的机器是 Windows XP。

我很欣赏这很奇怪，但是我看不到我创建的应用程序部署有任何问题。

有谁知道可能导致此问题的原因是什么？

编辑：我硬着头皮将应用程序创建为 Windows 服务，显然这不会花很长时间，我只是不相信它会解决问题。反正不行！！！

我还尝试删除异步调用打印函数的多线程代码。我这样做是为了简化应用程序并缩小它可能失败的原因。无论如何，这也没有改善情况！

编辑：我得到的两个错误是：

> System.Runtime.InteropServices.COMException (0x80000201)：指定的打印机无效。在 CrystalDecisions.ReportAppServer.Controllers.PrintOutputControllerClass.ModifyPrinterName(String newVal) 在 CrystalDecisions.CrystalReports.Engine.PrintOptions.set_PrinterName(String value) 在 Dsa.PrintServer.Service.Service.PrintCrystalReport(报告报告)

打印机没有失效，60秒后时间滴答即确认，报告打印成功。

和

> 无法提交请求以进行后台处理。在 CrystalDecisions.ReportAppServer.Controllers.ReportSourceClass.GetLastPageNumber(RequestContext pRequestContext) 在 CrystalDecisions.ReportSource.EromReportSourceBase.GetLastPageNumber(ReportPageRequestContext reqContext) --- 内部异常堆栈跟踪结束 --- 在 CrystalDecisions.ReportAppServer.ConvertDotNetToErom.ThrowDotNetException(Exception e)在 CrystalDecisions.ReportSource.EromReportSourceBase.GetLastPageNumber(ReportPageRequestContext reqContext) 在 CrystalDecisions.CrystalReports.Engine.FormatEngine.PrintToPrinter(Int32 nCopies, Boolean collat​​ed, Int32 startPageN, Int32 endPageN) 在 CrystalDecisions.CrystalReports.Engine.ReportDocument.PrintToPrinter(Int32 nCopies, Boolean整理，Int32 startPageN，

编辑：

我运行了 filemon 来检查是否有任何访问问题。发生错误时文件 mon 报告

请求：打开 | 路径：C:\windows\assembly\gac_msil\system\2.0.0.0__b77a5c561934e089\ws2_32.dll | 结果：未找到 | 其他：属性错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-21T10:28:42.723

我们的特殊问题已经解决。基本上，当创建报告时，它们会保存有关打印机的信息。基本上，已为报告设置并保存了特定的打印机。

这台打印机不再存在，这就是报告开始失败的原因。基本上，我们必须打开报表设计器并删除报表中与打印机的任何关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T19:28:23.380

在过去的几年中，我们多次遇到这些错误。很多时候，我希望得到一些更具体的错误信息。

首先，我将验证没有安装多个 Crystal Reports 版本。根据我们的经验，我们发现 Crystal Reports 9.0 似乎与 10 不兼容。卸载版本 9 似乎对我们的一些客户有所帮助。如果两者都安装了，我强烈建议将*两者*都卸载，然后重新安装 Crystal Reports 10。

我们最早的 Crystal Reports 错误之一是可怕的“无法提交请求以进行后台处理”。报告会在一段时间内正常工作，然后突然停止。查看代码后，我发现我们没有处理 ReportDocument 的地方。正确处理此文档解决了该问题。

最近，我们遇到了“无法提交请求以进行后台处理”的争吵。和“无效的打印机”错误。一位客户的服务器有几台由 IP 地址定义的网络打印机。打印一段时间可以正常工作，然后突然，*bam*，客户收到“无效打印机”错误并致电我们的支持。

一位开发人员通过执行以下所有操作修复了“无效打印机”问题：

1.  在 Visual Studio 2005 中编辑并保存 .rpt 文件。我们一直保持报表格式与 Crystal Reports 9 兼容，因为我们希望我们的更改能够分发给仍在使用旧版本的客户。
2.  使用“无打印机”选项保存 Crystal Reports 文件。从 Visual Studio 2005 菜单中，选择 Crystal Reports/Design/Printer Setup，然后选择“No Printer”复选框。
3.  我们更改了一个显示“第 N 页，共 M”的公式，如下所示：

 `````
"Page " + Left (CStr (PageNumber), Length (CStr (PageNumber)) - 3) +
" of " + Left (CStr (TotalPageCount), Length (CStr (TotalPageCount)) - 3) 
````  `对此：

```
"Page " + CStr(PageNumber,0) + " of " + CStr(TotalPageCount,0) 
```

不幸的是，我不知道上述哪些（任何或全部）操作可以修复错误。我说“可能”，因为据我所知，由于一些 IT 网络更改，错误神奇地消失了。

最后，你读过 [这份白皮书吗？](https://www.sdn.sap.com/irj/sdn/go/portal/prtroot/docs/library/uuid/50a6f5e8-8164-2b10-7ca4-b5089df76b33) 虽然它不一定能解决我们的问题，但它非常有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T13:16:21.493

如果您为您的应用程序创建了一个窗口服务包装器，这意味着无论用户是否登录，它都会继续运行。它也可以设置为自动启动。我认为因为您使用的是实际应用程序，而不是 Windows 服务，所以一旦您注销服务器上的会话，它实际上并没有运行。

这是代码项目的示例：

[http://www.codeproject.com/KB/system/WindowsService.aspx](http://www.codeproject.com/KB/system/WindowsService.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T17:31:27.650

您确定要“断开”远程会话而不是“注销”。我一直断开与 nt server 2003 的会话，一切都继续运行良好。另一方面，注销会杀死应用程序在该会话中运行。

你的操作系统服务器在运行什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T22:55:49.033

为了解决您所描述的问题，您需要专注于您的问题是什么。

我收到了消息：CrystalDecisions.Shared.CrystalReportsException：加载报告多次失败，这是由于您无法访问该报告。它不存在，或者在您的情况下您没有连接到机器。该错误不是由于任何与打印相关的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T03:04:52.367

我遇到了一个与此类似的模糊问题，除了它是 Excel 的（令人震惊的）自动化问题。当我连接远程桌面会话时，我发现该应用程序运行良好，但一旦断开连接，就会出现与默认打印机相关的自动化错误。

我相信这个问题与您连接远程桌面时默认打印机的设置方式有关。假设您有一个用于启动远程桌面会话的 .rdp 文件，如果您编辑它，然后选择“本地资源”选项卡，您可以查看您是否在远程会话中共享本地打印机。

如果启用，这意味着当您连接时，您的本地默认打印机将成为远程机器上的默认打印机。当您断开连接时，您的应用程序的默认打印机仍可能会引用本地计算机上现在不可用的默认打印机。

您应该能够解决此问题，方法是确保您不共享本地打印机，方法是取消选择“本地资源”选项卡中的打印机复选框。

一个更简单的解决方案是在服务器上禁用“打印机重定向”。有关详细信息，请参阅[https://serverfault.com/questions/5646/how-do-i-disable-remote-printers-using-group-policy](https://serverfault.com/questions/5646/how-do-i-disable-remote-printers-using-group-policy)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-18T12:11:36.623

如果您正在详细查看如何

在布尔字段的水晶报告中添加复选框，如果布尔字段为假

取消选中其他选中复选框看看这篇文章

[http://checkboxcrystalreport.blogspot.com/2009/07/printing-checkbox-in-crystal-report-for.html](http://checkboxcrystalreport.blogspot.com/2009/07/printing-checkbox-in-crystal-report-for.html)

# wpf - 子项的 WPF/XAML 样式集属性？

> ID：602305
> 
> 赞同：12
> 
> 时间：2009-03-02T13:11:15.267
> 
> 标签：wpf, xaml, wpf-controls, styles

我正在为我的控件使用 XAML 样式。下面的代码用于设置堆栈面板的颜色。它工作正常，但我还有其他事情要做。如果触发器被激活，我想为堆栈面板内的所有子项设置字体颜色。

目前我在堆栈面板中只有文本块，我知道我可以轻松地为文本块创建单独的样式。但是如果触发了这种风格，它只会影响一个而不是所有的文本块。但是，一旦我获得面板的鼠标悬停触发器，我想更改堆栈面板内的所有项目。

这在 XAML 中是否可行，还是我必须编写常规事件？

```
<Style x:Key="XStack" TargetType="StackPanel">
    <Setter Property="Background">
        <Setter.Value>
            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                <GradientStop Color="White" Offset="0"/>
                <GradientStop Color="SkyBlue" Offset="6"/>                    
            </LinearGradientBrush>
        </Setter.Value>
    </Setter>
    <!-- Trigger-->
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True" >
            <Setter Property="Background" Value="SkyBlue"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-02T13:47:17.253

将此添加到您的触发器中：

`<Setter Property="TextElement.Foreground" Value="Blue"></Setter>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T14:14:03.743

就像 Olle 所说，您可以将附加属性设置`TextElement.Foreground`为自定义值。对于可视树中的子控件/UI 节点，如果未设置该属性，WPF 将向上遍历 UI 层次结构，直到找到一个值并使用它。*这意味着所有子控件都可以共享在父级别定义的属性值。*

这应该适用于所有 TextBlocks...但是如果您的 StackPanel 包含一个 TextBox，则其文本颜色不会受到影响。它使用 Control 基类中的 Foreground 属性...因此请务必使用所有可能的子元素类型对其进行测试。

# thread-safety - 线程安全的统一随机数生成器

> ID：602311
> 
> 赞同：5
> 
> 时间：2009-03-02T13:14:35.413
> 
> 标签：thread-safety, random, fortran

我有一些并行的 Fortran90 代码，其中每个线程都需要生成相同的随机数序列。

我有一个似乎是线程不安全的随机数生成器，因为对于给定的种子，我完全无法在每次运行程序时重复相同的结果。

我（几乎）浏览了整个网络以寻找线程安全 RNG 的一些代码，但没有成功。任何人都可以向我提供（链接到）一个代码吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T13:59:35.463

Fortran90的一个很好的[伪随机数生成器](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)可以在[英特尔数学核心向量统计库](http://www.intel.com/cd/software/products/asmo-na/eng/266864.htm)中找到。它们是线程安全的。另外，为什么它需要是线程安全的？如果您希望每个线程获得相同的列表，请为每个具有相同种子的线程实例化一个新的 PRNG。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T13:37:00.743

大多数可重复的随机数生成器需要某种形式的状态。没有状态，他们就无法做接下来的事情。为了线程安全，您需要一种方法来自己保持状态（即，它不能是全局的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:11:27.127

当您说“需要生成相同的随机数序列”时，您的意思是

*   每个线程都需要生成一个与另一个线程相同的数字流吗？*这意味着在剥离线程之前选择种子，然后在每个线程中使用相同的种子实例化线程本地 PRNG。*

或者

*   您希望能够在程序的不同运行之间重复相同的数字序列，但每个线程生成它自己的独立序列？*在这种情况下，您仍然无法共享单个 PRNG，因为线程操作顺序是不确定的。因此，在启动线程之前使用已知种子为单个 PRNG 播种，并使用它为线程生成初始种子。**然后**在每个线程中实例化线程本地生成器......*

在每种情况下，您都应该注意[Neil Butterworth](https://stackoverflow.com/questions/602311/thread-safe-uniform-random-number-generator/602400#602400)对统计数据的看法：当以这种方式生成混合流时，PRNG 喜欢声称的大多数通常保证*都不可靠。*

* * *

在这两种情况下，您都需要一个线程本地 PRNG。我不知道 f90 中有什么可用...但您也可以自己编写（查找[Mersenne Twister](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html)，并编写一个将保存状态作为参数的例程...）。

在 fortran 77 中，这看起来像

```
 function PRNGthread (state)

      double state(statesize)

c stuff happens here which uses and manipulates the state vector...

      PRNGthread = result
      return 
```

并且您的每个线程都应该维护一个单独的状态向量，尽管所有线程都将使用相同的初始值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T16:23:10.313

我了解您需要每个线程来产生相同的随机数流。

[MT19937](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/FORTRAN/fortran.html)是一个非常好的 Pseudo Random Generator，它可以生成可重现的数字流并且速度非常快。只需确保在产生线程之前生成种子，但在每个线程中生成一个单独的 MT 实例（使 MT 线程的实例本地化）。这样就可以保证每个 MT 都会产生相同的数字流。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T17:20:28.053

[SPRNG](http://sprng.cs.fsu.edu/)怎么样？我自己还没有尝试过。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-06T04:08:58.253

我编写了 Mersenne Twister/MT19973 的线程安全 Fortran 90 版本。PRNG 的状态保存在派生类型 (randomNumberSequence) 中，您可以使用过程为生成器播种或获取序列中的下一个元素。

请参阅[http://code.google.com/p/i3rc-monte-carlo-model/source/browse/trunk/Code/RandomNumbersForMC.f95](http://code.google.com/p/i3rc-monte-carlo-model/source/browse/trunk/Code/RandomNumbersForMC.f95)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T13:43:45.610

替代方案似乎是：

*   在生成器的种子值上使用同步对象（例如互斥锁）。不幸的是，这将在访问生成器时序列化您的代码
*   在生成器中使用线程本地存储，以便每个线程都有自己的种子 - 这可能会导致您的应用出现统计问题
*   如果您的平台支持合适的原子操作，请在种子上使用它（但它可能不会）

我知道，这不是一个非常令人鼓舞的清单。除此之外，我不知道如何在 FORTRAN 中实现它们中的任何一个！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-18T17:45:22.953

这篇文章[https://www.cmiss.org/openCMISS/wiki/RandomNumberGenerationWithOpenMP](https://www.cmiss.org/openCMISS/wiki/RandomNumberGenerationWithOpenMP)不仅链接到 Fortran 实现，还提到了使 PRNG 可用于线程所需的关键点。最重要的一点是：

Fortran90 版本的 Ziggurat 有几个带有“SAVE”属性的变量和数组。为了使统一的 RNG 并行化，似乎所需的更改是使这些变量数组具有每个线程的单独值（谨防错误共享）。那么当调用PRNG函数时，我们必须传递线程号，并使用对应的状态值。

# java - 如何从 JAX-WS Web 服务中访问 ApplicationContext？

> ID：602319
> 
> 赞同：10
> 
> 时间：2009-03-02T13:16:29.090
> 
> 标签：java, web-services, spring, jax-ws

类似于[如何从 JAX-WS Web 服务中访问 ServletContext？](https://stackoverflow.com/questions/261348/how-can-i-access-the-servletcontext-from-within-a-jax-ws-web-service)，有没有办法访问applicationContext，比这更容易？

```
import javax.annotation.Resource;
import javax.jws.WebService;
import javax.servlet.ServletContext;
import javax.xml.ws.WebServiceContext;
import javax.xml.ws.handler.MessageContext;

import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.support.WebApplicationContextUtils;

@WebService
public class MyWebService {
    // boilerplate code begins :(

    @Resource
    private WebServiceContext context;
    private WebApplicationContext webApplicationContext = null;

    /**
     * @return
     * @throws IllegalStateException
     */
    private WebApplicationContext getWebApplicationContext()
            throws IllegalStateException {
        if (webApplicationContext != null)
            return webApplicationContext;
        ServletContext servletContext =
                (ServletContext) context.getMessageContext().get(
                        MessageContext.SERVLET_CONTEXT);
        webApplicationContext =
                WebApplicationContextUtils.getRequiredWebApplicationContext(servletContext);
        return webApplicationContext;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-12-03T01:08:23.133

```
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.web.context.support.SpringBeanAutowiringSupport;

@WebService( 
    endpointInterface = "Bla", 
    targetNamespace = "http://bla/v001", 
    wsdlLocation = "WEB-INF/wsdl/bla.wsdl",    
    serviceName = "BlaService",
    portName = "BlaPort")
public class BlaWs extends SpringBeanAutowiringSupport implements BlaPort {

  @Autowired
  @Qualifier("dao") 
  private Dao dao;
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T14:08:19.777

我认为 Web 服务不必了解 Web 或 servlet 上下文或其应用程序上下文。我不明白为什么它必须知道这些。不应该更被动吗？注入它需要的东西，让它完成它的工作。与客户的服务交互应基于预先定义的合同。如果它必须从某种上下文中获取未知值，客户端如何知道需要设置什么或如何设置？

我会进一步说，Web 服务应该是 Spring 服务接口的包装器。这只是所有可能的暴露方式中的一种选择。您的 Web 服务应该做的只是编组和解组 XML 请求/响应对象并与 Spring 服务协作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-20T14:23:10.943

让您的 Web 服务 bean 扩展一个 spring bean。

像[这样](https://stackoverflow.com/questions/1199047/something-like-ejb-wiring-in-spring-for-non-ejbs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:31:06.857

我会在链接到 ThreadLocal 之前安装一个保存 ServletContext 的过滤器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-03T16:42:53.680

根据 SpringBeanAutowiringSupport 类的 JavaDoc，请参见： [http ://docs.spring.io/autorepo/docs/spring-framework/3.0.x/api/org/springframework/web/context/support/SpringBeanAutowiringSupport.html](http://docs.spring.io/autorepo/docs/spring-framework/3.0.x/api/org/springframework/web/context/support/SpringBeanAutowiringSupport.html)

阅读注释：在 javadoc 的末尾。

实际上，最初的问题可能是应该实施的方式。

# jquery - HTML表的差异AJAX更新？

> ID：602322
> 
> 赞同：2
> 
> 时间：2009-03-02T13:17:57.183
> 
> 标签：jquery, python, html, dhtml

我有一个基于 25x20 HTML 表（游戏板）的游戏。用户每 3 秒可以“移动”一次，这会向服务器发送一个 AJAX 请求，此时服务器会重新呈现整个 HTML 表并将其发送给用户。

这很容易写，但它浪费了大量的带宽。是否有任何库、客户端（最好是 jquery）或服务器端，可以帮助发送差异而不是大型表的完整更新？通常在给定的重新加载时只有 5-10 个图块会发生变化，所以我觉得我可以通过仅发送这些图块而不是每 3 秒发送全部 500 个图块来将带宽使用减少一个数量级。

如果你能提出更好的选择，我也愿意接受“你这个白痴，你为什么要使用 HTML 表格”类型的评论。例如，是否有任何 CSS/DOM 操作技术我应该考虑而不是使用 HTML 表格？我应该使用表格但为每个 td 提供一个 id 坐标（如“12x08”），然后使用 jquery 用 id 替换单元格吗？

澄清：瓷砖是文本，而不是图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:42:54.147

如果您知道服务器端刷新之间的状态（请参阅问题评论），您可以像这样使用 JSON 发送数据（不确定确切的语法）：

```
[
    { x: 3, y: 5, class: "asdf", content: "1234" },
    { x: 6, y: 5, class: "asdf", content: "8156" },
    { x: 2, y: 2, class: "qwer", content: "1337" }
] 
```

压缩它（删除多余的空格等），gzip 它，然后将它发送到您的 Javascript。令人惊讶的是，读取它的 Javascript 代码并没有那么复杂（只是 DOM 操作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T19:47:12.477

您可以将游戏板建模为多维 javascript 数组：

```
[[x0, x1, x2, x3 ... xn],
.....
.....] 
```

每个条目是一个代表一行的数组。每个单元格保存游戏棋子/方块的数值。

该模型可以是您通过 ajax 作为 JSON 发送到服务器的“合同”。服务器计算相同的数组并将其发送回 UI。您可以将该数组呈现为表格、div 或任何您喜欢的内容。Prototype.js 和 jQuery 让创建 dhtml 变得超级简单。

这种数组格式将比一个带有标记的整个 HTML 响应小得多。它还使您可以自由地以您喜欢的任何方式渲染电路板。

You can further compress this format and just send the deltas. For example: save the coordinates of tiles changed by the user and send those to the server:

```
[(x1, y2),.....(xn, yn)] 
```

Or you can do it the other way around: send the full model array to the server, and have the server calculate the deltas.

Check out Sponty, and watch the ajax traffic every few minutes or so, we do something very similar: [http://www.thesponty.com/](http://www.thesponty.com/stackoverflow) The client sends the full model to the server, and the server sends the diffs.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T13:38:00.257

不考虑增量：

你可以很容易地使用 JSON 来做这种事情。您也可以推出自己的压缩格式。

我认为使用 gzip 压缩数据会有很大帮助。现在大多数浏览器都支持它，它将大大减少您的响应大小。

# c# - NHibernate 代码完成 Visual Studio

> ID：602324
> 
> 赞同：1
> 
> 时间：2009-03-02T13:18:36.870
> 
> 标签：c#, .net, visual-studio-2008, nhibernate

我知道有一种方法可以为休眠映射文件启用代码完成。但我不记得我必须如何做到这一点。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:21:44.163

尝试将以下文件复制到：C:\Program Files\Microsoft Visual Studio 9.0\Common7\Packages\schemas\xml，或复制到 C:\Program Files\Microsoft Visual Studio 9.0\Xml\Schemas。

我不确定哪个是正确的地方，我把它们都放进了我的两个地方，但它对我有用。

nhibernate-configuration.xsd
nhibernate-generic.xsd
nhibernate-mapping.xsd

您可以从 nHibernate 的源代码中获取文件

# .net - ISerialization 构造函数没有被调用

> ID：602326
> 
> 赞同：1
> 
> 时间：2009-03-02T13:19:10.973
> 
> 标签：.net, serialization

编辑：我的问题的解决方案是实现 IXMLSerializer。感谢大家的快速回复。

大家好，我有这个问题，我似乎没有找到合适的解决方案。

我有以下课程

```
public class Child
        {
            private int _id;

            public int Id
            {
                get { return _id; }
                set { _id = value; }
            }

        }
        [Serializable]
        public class Test: ISerializable
        {
            private int _id;

            public int Id
            {
                get { return _id; }
                set { _id = value; }
            }

            private Child _child = new Child();

            public Child Child
            {
                get { return _child; }
                set { _child = value; }
            }

            public Test()
            {
            }
            protected Test(SerializationInfo info, StreamingContext context)
            {
                if (info.MemberCount > 1)
                    Child.Id = info.GetInt32("ChildId");
            }

            #region ISerializable Members

            public void GetObjectData(SerializationInfo info, StreamingContext context)
            {
                info.AddValue("ChildId", Child.Id);
            }

            #endregion
        } 
```

如果我发送以下 XML 进行反序列化

```
<?xml version="1.0" encoding="utf-16"?><Test><Id>0</Id><ChildId>10</ChildId></Test> 
```

使用以下代码反序列化

```
serializer.Deserialize(new StringReader("<?xml version="1.0" encoding="utf-16"?><Test><Id>0</Id><ChildId>10</ChildId></Test>"); 
```

我想这会调用我的序列化构造函数，但问题是它永远不会被调用。

我正在使用上面发布的 XML 而不是这个

```
<?xml version="1.0" encoding="utf-16"?><Test><Id>0</Id><Child><Id>10</Id></Child></Test> 
```

因为我从另一个应用程序获取 xml，所以我需要手动创建子对象并从构造函数中手动分配它的值。

我将非常感谢您为我提供的所有帮助和指导。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T13:24:37.310

要自定义 XML 序列化我相信你需要使用[`IXmlSerializable`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)而不是`ISerializable`.

我认为这需要一个无参数的构造函数，然后你需要实现`ReadXml`and `WriteXml`。换句话说，它不使用与二进制序列化相同的构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T13:25:03.843

您使用的序列化程序变量是什么？如果它是`XmlSerializer`，则不会调用您的序列化挂钩，因为 XmlSerializer 不支持它们（请参阅 参考资料`IXmlSerializable`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T13:42:58.670

XmlSerializer 不使用 SerializableAttribute、ISerializable 也不使用采用 SerializationInfo 信息和 StreamingContext 参数的构造函数。在使用 SoapFormatter（已过时）和 BinaryFormatter 进行序列化时使用这些构造。

```
 BinaryFormatter bf = new BinaryFormatter();
        using (MemoryStream ms = new MemoryStream())
        {
            Class1 c1 = new Class1();
            bf.Serialize(ms, c1);

            ms.Position = 0;
            Class1 c2 = bf.Deserialize(ms) as Class1;
        } 
```

# .net - 使用 FindByThumbprint 找不到 X.509 证书

> ID：602329
> 
> 赞同：8
> 
> 时间：2009-03-02T13:20:23.153
> 
> 标签：.net, x509

当我尝试实例化第三方 Web 服务客户端的实例时出现以下错误...

```
无法使用以下搜索条件找到 X.509 证书：
StoreName 'My'，StoreLocation 'LocalMachine'，FindType 'FindByThumbprint'，
FindValue '[此处的值]'。
```

奇怪的是，我们在另一台开发机器上工作，但它坚决拒绝在我的机器上工作。我们已经在每台机器上以相同的方式（据我们所知）将证书添加到机器的证书存储中。

任何人都可以提供有关如何解决此问题的任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-24T18:57:13.747

也许您没有在该机器上安装证书。查看 Internet Explorer（工具 | Internet 选项 | 内容选项卡 | 证书）安装的客户端证书。

在“个人”选项卡下，您可以看到为您的用户帐户安装的证书（因为您使用的是“我的”商店名称）。双击详细信息选项卡下的已安装证书，您可以在查找值属性上使用所有信息，例如指纹。

请注意，在 Windows 10 上，证书位于本地“计算机”存储中。在 Windows Server 2008 R2 及更低版本上，它们将在“个人”中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-05T13:21:22.600

这对我有用：

**无效**-`252967BFBCD543D93A79AFD86D4A5117A9C6767B`

添加`0x`（十六进制数字常量的前缀）

**有效**-`**0x**252967BFBCD543D93A79AFD86D4A5117A9C6767B`

# apache - 模组改写问题

> ID：602330
> 
> 赞同：6
> 
> 时间：2009-03-02T13:20:39.720
> 
> 标签：apache, mod-rewrite

和其他许多人一样，我在 apache 中做一些非常简单的 mod_rewriting 时遇到问题。

我的 .htaccess 中有以下内容：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule ^view/([0-9]+)/([0-9]+)$ view.php?advertId=$1&publisherId=$2 [NC,QSA,L] 
```

哪个应该翻译 /view/4093/203?qs=val -> /view.php?advertId=4093&publisherId=203?qs=val

现在，当使用 /View... 调用它时它可以工作，但是在执行小写 /view 时，它会重定向到正确的文件，但是我的 PHP 脚本中没有设置 advertId 和 publisherId ，因为它与第一个字母大写视图一样而且我只是对这方面发生的事情一无所知（我一直在测试和观察这种行为，只需在我的 view.php 上做一个）。

有谁知道为什么会这样？

我可能想补充一下，我的服务器信息如下：

```
Apache/2.2.9 (Debian) PHP/5.2.6-1+lenny2 with Suhosin-Patch mod_python/3.3.1 Python/2.5.2 mod_perl/2.0.4 Perl/v5.10.0 
```

IE。带有默认 debian 软件包 + php-mssql 的全新 debian 库存。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T13:29:14.460

[`MultiViews`](http://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews)可能会导致这种行为，即在将请求传递给 mod_rewrite 之前尝试将请求映射到类似的现有文件。尝试禁用它：

```
Options -MultiViews 
```

# firefox - 你认为 Firefox 项目应该分叉成开发者目标版本吗？

> ID：602335
> 
> 赞同：-6
> 
> 时间：2009-03-02T13:22:40.840
> 
> 标签：firefox, open-source, firefox-addon, fork

我刚刚有了一个想法，即需要一个分叉版本的 Firefox，它可以为 Web 开发提供开箱即用的工具。像 FireBug、YSlow、FireCookie、LiveHTTPHeaders 等。

也许 fork 应该只包含这些扩展，或者采取进一步措施并在现有的 chrome 中实现它们。

我考虑这个的原因是现在我有两个 Firefox 配置文件。一种只有一个扩展的“浏览”和一个具有大量扩展的“开发”。优势显然是前者比后者快。也许如果从一开始就针对开发人员，分叉版本会带来一些速度改进和其他细节。

你怎么看？有志愿者吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T13:26:32.467

通过扩展向 FireFox 添加功能是 IMO成为如此受欢迎的浏览器**的原因。**如果您通过向人们提供“预烘焙”解决方案来“远离”人们的自由，那将不是最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:30:46.373

与扩展相比，这有什么优势？您实际上并不相信有人会将代码移植到 C 中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T13:32:23.780

I fear that pulling mentioned extensions into an official, maybe even Mozilla-branded, distribution would cause a slowdown in the development of those extensions because their authors would have to worry about coordinating their development with the provider of the browser distribution.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T13:35:29.077

You can always prepare your own Firefox installator...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T14:42:45.063

我认为没有必要为此分叉，因为您已经可以同时拥有这两种东西——即拥有多个配置文件，并将所有开发人员工具作为扩展。

您甚至可以安装两个不同的配置文件并从两个不同的可执行文件运行它们（便携式 Firefox 使这很容易），从而允许您拥有完全不同的插件集以及两者的扩展集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T12:40:19.920

再想一想，我看不出它会有什么帮助。

假设您将 Firefox 分叉为开发版本，然后由扩展开发人员使用。

但目标平台是什么？开发平台（好吧）或“标准”平台——如果是后者，他们不会使用它，因此开发和测试会加倍或更糟。只是针对 Gnu Emacs 进行映像，但在 XEmacs 中进行开发。

在您的目标平台上进行开发和测试，否则会遇到不愉快的意外......

# regex - 如何找到分号分隔值的计数？

> ID：602337
> 
> 赞同：2
> 
> 时间：2009-03-02T13:22:54.943
> 
> 标签：regex, scripting

我有一个我从“收件人”字段中复制的所有电子邮件 ID 的列表，来自我在 MS Outlook 中收到的一封电子邮件。这些值（电子邮件 ID）用分号分隔。我已将这个电子邮件 ID 的大列表复制到 Excel 中。现在我想在这个列表中找到电子邮件 ID 的数量；基本上是通过计算分号的数量。

我可以做到这一点的一种方法是编写 C 代码。即将大列表存储为字符串缓冲区，并不断将字符与“;”进行比较 在一个`while(char == ';') loop`。但我想快点做。

有没有什么快速的方法可以使用以下任一方法找到它：

1.) 正则表达式（我使用 powergrep 来处理正则表达式）

2.）在excel本身中（任何excel宏/插件吗？）

3.) DOS脚本方法

4.) 还有其他快速完成的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T13:27:16.757

我相信以下内容应该在 Excel 中工作：

```
= Len(A1) - Len(Substitute(A1, ";", "")) + 1 
```

/编辑：如果您已将电子邮件地址粘贴到多个单元格中，则可以使用以下函数计算单元格：

```
= CountA(A1:BY1) 
```

`CountA`计算给定范围内的非空单元格。您可以通过在单元格中键入**`=CountA(`**内容然后用鼠标光标选择单元格范围来指定范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T16:12:36.220

## Bash/[Cygwin](http://www.cygwin.com/) One-Liner

```
$ echo "user@domain.tld;user@domain.tld;user@domain.tld" | sed -e 's/;/\n/g' | wc -l
3 
```

If you already have Cygwin installed it's effectively instant. If not, cygwin is worth installing IMHO. It basically provides a Linux bash prompt overlaid over your Windows system.

As an aside, stuff like this is why I prefer *nix over Windows for work stuff, I can't live on a windows box without Cygwin since bash scripts are so much more powerful than batch scripts.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T13:24:48.977

如果计算分号的数量对您来说足够好，您可以在 Perl 中使用以下解决方案进行计算：[Perl FAQ 4.24：如何计算字符串中子字符串的出现次数](http://www.perl.com/doc/FAQs/FAQ/oldfaq-html/Q4.24.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:30:44.537

PowerShell:

```
> $a = 'blah;blah;blah'
> $a.Split(';').Count  
3 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T18:53:13.290

3) if you don't have neither cygwin, nor powershell installed try this .cmd

```
@echo off
set /a i = 0
for %%i in (name1@mail.com;name2@mail.com;name3@mail.com) do set /a i = i + 1
@echo %i% 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T13:41:06.630

If you are using Excel you can use this code and expose it.

```
Public Function CountSubString(ByVal RHS As String, ByVal Delimiter As String) As Integer
    Dim V As Variant
    V = Split(RHS, Delimiter)
    CountSubString = UBound(V) + 1
End Function 
```

If you have .NET you can make a little command line utility

```
Module CountSubString

    Public Sub Main(ByVal Args() As String)

        If Args.Length <> 2 Then
            Console.WriteLine("wrong arguments passed->")
        Else
            Dim I As Integer = 0
            Dim Items() = Split(Args(0), Args(1))
            Console.WriteLine("There are " & CStr(UBound(Items) + 1) & " 
        End If

    End Sub
End Module 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T13:43:28.090

Load the list in your favorite (not Notepad!) editor, replace ; by \n, see in the status bar how many lines you have, remove the last line if needed.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T16:22:51.000

C# 3.0 with LINQ would make this easy if it is an option for you over C

myString.ToCharArray().Count(char => char = ';')

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T19:06:55.380

If awk, echo is awailable (and [it is, even on windows](http://gnuwin32.sourceforge.net/packages/gawk.htm)):

```
echo "addr1;addr2;addr3...." | awk -F ";" "{print NF}" 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T13:35:23.897

用一个while循环循环它并计算';' 可能是最快的，也是最易读的。

Consider Konrad's suggestions, that too will loop through the string and check every char and see if it is a simicolon, and then in modifies the string (may or may not be mutable, I don't know with excel), and then it counts the length between it and the original string.

# .net - CryptographicException 'Keyset 不存在'，但只能通过 WCF

> ID：602345
> 
> 赞同：176
> 
> 时间：2009-03-02T13:25:15.047
> 
> 标签：.net, wcf, x509

我有一些代码可以调用使用 X.509 认证保护的第三方 Web 服务。

如果我直接调用代码（使用单元测试），它可以正常工作。

部署后，此代码将通过 WCF 服务调用。我添加了第二个调用 WCF 服务的单元测试，但是当我调用第三方 Web 服务上的方法时，这会失败并显示一条`CryptographicException`消息。`"Keyset does not exist"`

我认为这是因为我的 WCF 服务将尝试使用与我不同的用户来调用第三方 Web 服务。

任何人都可以对这个问题有更多的了解吗？

* * *

## 回答 #1

> 赞同：300
> 
> 时间：2010-07-04T21:18:04.483

这很可能是因为 IIS 用户无权访问您的证书的私钥。您可以按照以下步骤进行设置...

1.  开始→运行→MMC
2.  文件 → 添加/删除管理单元
3.  添加证书管理单元
4.  选择计算机帐户，然后点击下一步
5.  选择本地计算机（默认），然后单击完成
6.  在控制台根的左侧面板上，导航到证书（本地计算机）→个人→证书
7.  您的证书很可能会在这里。
8.  右键单击您的证书→所有任务→管理私钥
9.  在此处设置您的私钥设置。

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2009-03-02T13:40:43.293

这可能是证书上的权限问题。

运行单元测试时，您将在自己的用户上下文中执行这些测试，其中（取决于*客户端*证书所在的存储）将有权访问该证书的私钥。

但是，如果您的 WCF 服务托管在 IIS 下，或者作为 Windows 服务，它很可能会在服务帐户（网络服务、本地服务或其他一些受限帐户）下运行。

您需要在私钥上设置适当的权限，以允许该服务帐户访问它。MSDN有[详细信息](http://msdn.microsoft.com/en-us/library/aa702621.aspx)

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-12-07T10:52:42.327

我昨晚也有同样的问题。正确设置了私钥的权限，除了 Keyset 不存在错误之外，一切显然都很好。最后发现证书首先导入到当前用户存储，然后移动到本地机器存储。但是 - 这并没有移动私钥，它仍然在

C:\Documents and settngs\Administrator...

代替

C:\Documents and settngs\所有用户...

尽管对密钥的权限设置正确，但 ASPNET 无法访问它。当我们重新导入证书以便将私钥放在所有用户分支中时，问题就消失了。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2016-08-30T09:09:22.787

**解决IIS浏览时“Keyset不存在”的问题：** ***可能是私有权限***

查看和授予权限：

1.  运行>mmc>是
2.  点击文件
3.  点击添加/删除管理单元...</li>
4.  双击证书
5.  电脑账户
6.  下一个
7.  结束
8.  行
9.  单击证书（本地计算机）
10.  点击个人
11.  单击证书

授予权限：

1.  右键单击证书名称
2.  所有任务>管理私钥…</li>
3.  添加并授予权限（添加 IIS_IUSRS 并授予它权限对我有用）

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-01-11T21:51:42.507

尝试从 Visual Studio 运行 WCF 应用程序时遇到了同样的问题。通过以管理员身份运行 Visual Studio 解决了这个问题。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-07-09T14:07:56.763

我遇到了这个问题，我的证书有私钥但我收到了这个错误（**“密钥集不存在”**）

**原因：**您的网站在“网络服务”帐户下运行或权限较低。

**解决方案**：将应用程序池标识更改为“本地系统”，重置 IIS 并再次检查。如果它开始工作，那就是权限/较少权限问题，您也可以模拟然后使用其他帐户。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-07-17T13:29:41.970

完全令人沮丧，我遇到了同样的问题并尝试了上述大部分内容。导出的证书正确地具有读取文件的权限`C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys`，但事实证明它没有对该文件夹的权限。添加它并且它有效

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-08-23T16:04:29.363

我收到错误消息：当我运行 MVC 应用程序时，CryptographicException 'Keyset does not exist'。

解决方案是：授予运行应用程序池的帐户访问个人证书的权限。就我而言，它是添加 IIS_IUSRS 并选择正确的位置解决了这个问题。

```
RC on the Certificate - > All tasks -> Manage Private Keys -> Add->  
For the From this location : Click on Locations and make sure to select the Server name. 
In the Enter the object names to select : IIS_IUSRS and click ok. 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-10-25T10:09:52.737

我也有完全相同的问题。我已经使用了命令

```
findprivatekey root localmachine -n "CN="CertName" 
```

结果显示私钥在 c:\ProgramData 文件夹中，而不是 C:\Documents 和 settngs\All users..

当我从 c:\ProgramData 文件夹中删除密钥时，再次运行 findPrivatekey 命令不成功。IE。它没有找到钥匙。

但是，如果我搜索先前命令返回的相同密钥，我仍然可以在

C:\Documents and settngs\所有用户..

所以据我了解，IIS 或托管的 WCF 没有从 C:\Documents 和 settngs\All users 中找到私钥。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-10-01T08:28:09.010

Steve Sheldon 的回答为我解决了这个问题，但是，由于我在没有 gui 的情况下编写证书权限的脚本，我需要一个可编写脚本的解决方案。我很难找到我的私钥存储在哪里。私钥不在`-C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys`，最后我发现它居然在`C:\ProgramData\Microsoft\Crypto\Keys`。下面我描述了我是如何发现的：

我试过`FindPrivateKey`但它找不到私钥，并且使用 powershell`$cert.privatekey.cspkeycontainerinfo.uniquekeycontainername`是空/空的。

幸运的是，`certutil -store my`列出了证书并给了我编写解决方案脚本所需的详细信息。

> `================ Certificate 1 ================ Serial Number: 162f1b54fe78c7c8fa9df09 Issuer: CN=*.internal.xxxxxxx.net NotBefore: 23/08/2019 14:04 NotAfter: 23/02/2020 14:24 Subject: CN=*.xxxxxxxnet Signature matches Public Key Root Certificate: Subject matches Issuer Cert Hash(sha1): xxxxa5f0e9f0ac8b7dd634xx Key Container = {407EC7EF-8701-42BF-993F-CDEF8328DD} Unique container name: 8787033f8ccb5836115b87acb_ca96c65a-4b42-a145-eee62128a ##* ^-- filename for private key*## Provider = Microsoft Software Key Storage Provider Private key is NOT plain text exportable Encryption test passed CertUtil: -store command completed successfully.`

然后我扫描文件夹并在**C:\ProgramData\Microsoft\Crypto\Keys**`c\ProgramData\Microsoft\Crypto\`中找到文件**8787033f8ccb5836115b87acb_ca96c65a-4b42-a145-eee62128a**。

 **授予我的服务帐户读取权限此文件为我解决了问题

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-26T16:18:42.797

我发现了一些缺失的信息，这些信息帮助我获得了具有消息级别安全性的 WCF 服务，尽管授予了从 Internet 上的示例生成的所有密钥的权限，但我仍然遇到了“密钥集不存在”。

我最终将私钥导入本地计算机上的受信任人员存储中，然后授予私钥正确的权限。

这为我填补了空白，最终让我能够实现具有消息级别安全性的 WCF 服务。我正在构建一个必须符合 HIPPA 的 WCF。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-07-31T16:24:49.167

我刚刚在本地机器上重新安装了我的证书，然后它工作正常

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-09-02T19:42:00.590

我在我的 PowerShell 脚本中遇到了同样的错误。对我来说，解决方法就是以管理员身份运行脚本。因此，请确保您正在运行的任何试图检索证书的应用程序都以管理员身份运行。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-08-09T13:38:29.853

如果您将 ApplicationPoolIdentity 用于您的应用程序池，您可能无法在注册表编辑器中为该“虚拟”用户指定权限（系统中没有这样的用户）。

因此，使用[subinacl](http://www.microsoft.com/download/en/details.aspx?id=23510) - 启用设置注册表 ACL 的命令行工具，或类似的东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-02T16:44:29.297

我只是想添加一个健全性检查答案。即使在我的机器上将证书安装到正确的商店并为客户端拥有所有正确的安全权限后，我也遇到了完全相同的错误。原来我混淆了我的 clientCertificate 和我的服务证书。如果您已经尝试了以上所有方法，我会仔细检查您是否有这两个。一旦我这样做了，我的应用程序就成功地调用了 Web 服务。同样，只是一个健全的检查器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-09-26T20:51:16.850

在 IIS7 上使用 openAM Fedlet 时收到此错误

更改默认网站的用户帐户解决了该问题。理想情况下，您希望这是一个服务帐户。也许甚至是IUSR帐户。建议查找 IIS 加固方法以完全确定。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-04-02T02:30:51.553

在用于对我们的密钥库进行身份验证的证书过期并被轮换后，我在我的服务结构项目中点击了这个，这改变了指纹。我收到此错误是因为我错过了在此块中更新 applicationManifest.xml 文件中的指纹，这正是其他答案所建议的 - 授予 NETWORK SERVICE（我所有的 exe 运行为 azure servicefabric 集群的标准配置）权限访问 LOCALMACHINE\MY 证书存储位置。

请注意“X509FindValue”属性值。

```
<!-- this block added to allow low priv processes (such as service fabric processes) that run as NETWORK SERVICE to read certificates from the store -->
  <Principals>
    <Users>
      <User Name="NetworkService" AccountType="NetworkService" />
    </Users>
  </Principals>
  <Policies>
    <SecurityAccessPolicies>
      <SecurityAccessPolicy ResourceRef="AzureKeyvaultClientCertificate" PrincipalRef="NetworkService" GrantRights="Full" ResourceType="Certificate" />
    </SecurityAccessPolicies>
  </Policies>
  <Certificates>
    <SecretsCertificate X509FindValue="[[THIS KEY ALSO NEEDS TO BE UPDATED]]" Name="AzureKeyvaultClientCertificate" />
  </Certificates>
  <!-- end block -->
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-27T04:42:23.483

这是唯一对我有用的解决方案。

```
 // creates the CspParameters object and sets the key container name used to store the RSA key pair
    CspParameters cp = new CspParameters();
    cp.KeyContainerName = "MyKeyContainerName"; //Eg: Friendly name

    // instantiates the rsa instance accessing the key container MyKeyContainerName
    RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(cp);
    // add the below line to delete the key entry in MyKeyContainerName
    // rsa.PersistKeyInCsp = false;

    //writes out the current key pair used in the rsa instance
    Console.WriteLine("Key is : \n" + rsa.ToXmlString(true)); 
```

[参考1](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.cspparameters.keycontainername?view=netframework-4.8)

[参考文献 2](https://docs.microsoft.com/en-us/dotnet/standard/security/how-to-store-asymmetric-keys-in-a-key-container?view=netframework-4.8)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-02-25T07:07:50.140

```
This issue is got resolved after adding network service role.

CERTIFICATE ISSUES 
Error :Keyset does not exist means System might not have access to private key
Error :Enveloped data … 
Step 1:Install certificate in local machine not in current user store
Step 2:Run certificate manager
Step 3:Find your certificate in the local machine tab and right click manage privatekey and check in allowed personnel following have been added:
a>Administrators
b>yourself
c>'Network service'
And then provide respective permissions.

## You need to add 'Network Service' and then it will start working. 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-11-17T00:23:38.747

这个问题很老，但它今天浮出水面，我所做的所有阅读都提到了许可，但我的情况并非如此。事实证明，我创建的新（Windows 服务）项目默认启用了此选项。属性--> 构建--> 首选 32 位。

通过取消选中此选项并重新部署此错误消失了，一切正常。

希望这可以帮助那些问题与权限无关的人。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-12-23T12:31:57.710

使用 SNK 数据签署文件时遇到此异常。诀窍是在 CspParameters 中将 KeyNumber 设置为 2（签名），例如：

```
$params = New-Object System.Security.Cryptography.CspParameters
$params.KeyNumber = 2

$rsa = New-Object System.Security.Cryptography.RSACryptoServiceProvider($params)
$rsa.ImportCspBlob($snk)
$signature = $rsa.SignData($inputBytes, [Security.Cryptography.HashAlgorithmName]::SHA256, [Security.Cryptography.RSASignaturePadding]::Pkcs1) 
```

# function - 如何找到未执行的功能？

> ID：602347
> 
> 赞同：2
> 
> 时间：2009-03-02T13:25:47.370
> 
> 标签：function

我有一个 MS Visual Studio 2005 工作区，全是 C 代码。我想找到该代码中的所有函数，这些函数在执行某个测试用例时不会被调用/执行。

使用它的方法是什么

1.) MS VS 2005 本身还是 MSVC6.0？

2.) 使用其他工具？

-广告

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:31:32.207

Might want to look into the code coverage tool in VS 2005 Team Edition. There's an FAQ on it [here](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/a8c8ddab-f517-4e67-ae38-37489ab21427/)

There's another tool out there called [ncover](http://www.ncover.com) that looks like it does something similar as well. Seem's pretty expensive, but they do have a 30 day trial.

I'm sure others will chime in with other tools that might fit the bill as well.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:33:48.830

Assuming your test case is in a VS2005 test project, you should be able to use the 'code coverage' feature.

On the menu choose Test->Edit Test Run Configuration ()

From here select CodeCoverage tab to the left, then check the DLLs or EXEs that contain the code you wish profiled.

Next run your test, and on completion, you should be able to select Test->Windows->Code Coverage

This gives you some metrics on the coverage such as lines executed, and you call also double click entries, to jump in to a file and have onscreen highlighting of the code that was or was note executed

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T13:32:31.597

Use a code profiler. Any good code profiler should include coverage tools to give you an idea of what was called and what was not called.

# java - 字符串数组到对象数组

> ID：602356
> 
> 赞同：1
> 
> 时间：2009-03-02T13:29:15.300
> 
> 标签：java, arrays

也许有一种我不知道的方法可以做到这一点-尽管我对此表示怀疑-但我正在尝试将字符串数组转换为对象数组。这是问题所在：我正在从命令行读取文件。该文件代表以下类型的几个类，每个类都有自己的数据字段。Vehicle 是所有跟随者的父类：Vehicle,Car,American Car, Foreign car, Truck, Bicycle。

我将文件读入字符串数组没有问题。但是，我需要创建所有这些类型的对象并将它们存储在 Vehicle[] 类型的数组中。例如，文件的一部分如下所示：

*   车辆
*   金斯坦利·罗宾逊
*   2344法院驱动器
*   (221)885-7777
*   stackoverflow@overflow.com

*   美国汽车
*   约翰·邦扬
*   1010二进制车道
*   (221)885-55643
*   bgt.com
*   可转换
*   底特律制造
*   联合工厂

其中类类型是第一行，后跟所有者姓名、地址、电话号码、电子邮件地址……每种类型都有特定的字段。所以外国汽车不是在底特律制造的。这些字段中的每一个都出现在文件中的单独一行上。所以我所做的就是将整个文件读入一个字符串数组。但是，我需要在字符串数组中找到我的类型，创建这些类型的对象，并将它们存储在 Vehicle 数组中。我的主要问题是每个数据字段都在单独的行上。我应该如何解决这个问题？顺便说一下，这是java代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:40:04.837

最初将数据读入字符串数组是可以的。然后您需要遍历该数组，并根据每个循环的“第一行”（“Vehicle”、“American car”等），您将知道数组的后续元素有多少属于相同的。

像这样的东西（我会让你自己填空）：

```
int i = 0;
ArrayList<vehicle> vehicles = new ArrayList();
while (i < data.length)
{
  if (data[i].equalsIgnoreCase("vehicle"))
  {
    Vehicle vehicle = new Vehicle();
    vehicle.setOwner(data[++i]);
    ...
    vehicles.add(vehicle);
  }
  else if (data[i].equalsIgnoreCase("american car"))
  {
    ...
  }
  i++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:38:54.577

问题不清楚。您想知道如何解析文件并使用每一行上的单词来创建它的对象吗？

伪：

```
Vehicle_ptr myVeh = null;
for each line in file
switch line
{
case vehicle: myVeh = new Vehicle();
case American Car : myVeh = new AmericanCar();
default:
if (line.startswithaninteger && (myVeh != NULL)) myVeh.address = line;
etcetc.
} 
```

提示：在文本文件中使用类型标识符。例如：car:americancar address:12345 bla etcetc

或者使用序列化程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T13:40:09.613

您可以像刚才一样读取文件，但是当您读取 Class 类型的字符串时，会创建正确 Vehicle 类型的实例。看起来您会知道文件的下 x 行是该特定类型的属性，因此您将读取属性并将它们设置在您的 Vehicle 实例上。然后，您可以将 Vehicle 实例添加到 Vehicle 数组中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:55:19.247

我会使用创建适配器的工厂模式。工厂将获取字符串 (Vehicle, American Car)，适配器将获取字符串数组和当前索引。适配器将负责了解要读取和返回具体对象（或接口）的索引数。

```
IAdapter adapter = AdapterFactory.Create( "American Car" );
Object concreteObject = adapter.Popluate( stringArray, currentIndex ); 
```

现在，如果您可以控制数据的存储方式，您可能需要研究标准序列化，甚至 JSON，以简化处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T13:58:05.233

在我看来，您需要一个[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)来根据输入构建您的车辆类型集。工厂可以确定一种汽车规格从哪里开始，另一种在哪里结束。然后它将确定汽车的字段集，并确定汽车类型。然后它可以调用适当的构造函数，传入所有相关字段。

这意味着（例如）美国汽车的构造函数指定了它感兴趣的所有字段。欧洲汽车构造函数也会这样做。每个构造函数都可以断言给定的内容，这样您就不会错误地创建任何汽车。

工厂将负责解析和分离输入，并确定要构建的内容。每种类型的汽车的构造函数*只处理该汽车*的信息，并执行适当的断言。

工厂将维护创建的汽车清单，并在完成后返回该清单（美国/欧洲/日本）。

在伪代码中：

```
whilst(!done) {
   fields.add(fieldFromFile);

   if (carSpecificationCompleted) {
       type = getType(fields);
       if (type == 'American') {
          car = new AmericanCar(fields);
       }
       else if (type == 'European') {
          car = new EuropeanCar(fields);
       }
       cars.add(car);
       clearStoredFields();
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T14:20:54.163

您是否可以控制传入的文件？如果是这样，我是否建议使用 XML 对其进行格式化，然后使用[JDOM](http://www.jdom.org/)对其进行解析？就解析而言，这将使您的生活更轻松。例如，您可以像这样格式化所有车辆条目：

```
 <node type="vehicle>
       <attributes location="detroit" color="red" />
    </node> 
```

或者你想出的任何格式。这样做的好处是您可以只读取车辆（或任何您想要的），或使用 XPath 或其他一些技术来有效地获取您想要/需要的信息并将其加载到正确的数据类型。

如果您无法控制文件格式，请忽略此建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T14:29:26.763

当您有选择时，请更改您的文件格式。

您可以使用[xstream](http://xstream.codehaus.org/)序列化您的对象。然后，您只需存储完整的 Java 对象，而无需检查某个值是否存在。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T14:35:18.420

我会在这里使用[Builder](http://en.wikipedia.org/wiki/Builder_pattern)模式而不是 Factory。没有太大的区别，但是当参数变化时会更容易一些，就像在他的例子中所做的那样。

# javascript - 如何知道 url 是否已添加书签

> ID：602359
> 
> 赞同：0
> 
> 时间：2009-03-02T13:30:20.820
> 
> 标签：javascript, firefox, bookmarks

我正在从代码中添加书签。现在在 Firefox 中，如果用户已经将 url 添加为书签，他应该无法再次添加书签。我该怎么做？现在，每次创建新书签时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:36:35.143

如果您想阻止人们第二次点击您网站上的书签链接，您可以尝试使用 cookie 来隐藏链接（如果客户端上有 cookie）。

据我所知，尝试在您的网站上使用 javascript 检查 FireFox 中的书签库（地点），这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:39:55.197

显然，你不能，除了以上两个好的建议：使用 cookie。或用户信息（尽管如果他们注册了，他们可能已经为该网站添加了书签！）。但是，Cookie 解决方案很脆弱，因为用户可以删除它们。

为什么不能：如果 JavaScript 程序可以读取用户的书签列表，那将是一个明显的安全漏洞：除了隐私问题之外，URL 参数中还可以包含一些敏感信息……

旁注：添加书签是在用户操作时完成的（或者应该是！）。所以用户应该知道他们是否已经添加了书签，不是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T13:44:34.750

[getBookmarkIdsForURI()](https://developer.mozilla.org/en/nsINavBookmarksService#getBookmarkIdsForURI())

*“此方法检索包含给定 URI 的书签 ID 列表。”*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:36:15.487

作为替代方案，每当用户使用您的 Javascript 为您的网站添加书签时，请尝试设置一个 cookie。如果 cookie 存在，请删除书签按钮（或其他）。

# c# - 如何创建一个类而不在 JavaScript 中定义它？

> ID：602371
> 
> 赞同：2
> 
> 时间：2009-03-02T13:35:07.987
> 
> 标签：c#, asp.net, javascript

我在服务器端有这样的课程：

```
public class Address
{
    public Address(string countryCode)
    {
        this._CountryCode = countryCode;
    }

    private string _CountryCode = string.Empty;
    public string CountryCode
    {
        get { return _CountryCode; }
        set { _CountryCode = value; }
    }

} 
```

我有一个由 Ajax 方法调用的方法：

```
[AjaxMethod]
public static Address ValidateAddress(Address address)
{
   // Some logic here...
   return address;
} 
```

我想在客户端调用这个方法，但是如何在客户端实例化 Address 类？我不想定义`Address`在 JavaScript 文件中命名的类。

```
<script>

function valaddress(){ 

  var address = new Address(); // I'm asking here ??
  address.CountryCode = 90;

  // This part is ok, no problem in here : 
  var validatedAddress = AddressControlDataHelper.ValidateAddress(address).value; 

}

</script> 
```

有没有办法做到这一点？或者我需要用 JavaScript 编写我的地址类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T13:41:40.543

```
var address = { 
    CountryCode: "1"
} 
```

这应该够了吧

```
<script>
  function valaddress(){ 

      var address = { 
          CountryCode: "90"
      };

      // This part is ok, no problem in here : 
      var validatedAddress = 
       AddressControlDataHelper.ValidateAddress(address).value; 

  }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T13:36:56.500

您将必须首先序列化对象。一种方法是使用[JSON](http://www.json.org/)（Javascript 对象表示法） -~~[这是有关其工作原理的教程。](http://www.hanselman.com/blog/SerializingObjectsAsJavaScriptUsingAtlasJSONNETAndAjaxPro.aspx)~~ **编辑：（**实际上，该教程非常令人困惑且有点过时 - 尝试使用[此教程以获得更直接、最新的方法。](http://pietschsoft.com/post/2008/02/NET-35-JSON-Serialization-using-the-DataContractJsonSerializer.aspx)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T00:14:46.623

使用 .net AJAX 扩展，您可以在上面添加 GenerateScriptType 标签，例如，您的服务器端 ValidateAddress()

```
[GeneratScriptType(typeof(Address)] 
```

服务器会将必要的 js 发送到客户端，以便您可以进行 js 调用

```
var address = new nameofyournamespace.Address() 
```

请参阅 [msdn GenerateScriptTypeAttribute 参考](http://msdn.microsoft.com/en-us/library/system.web.script.services.generatescripttypeattribute.aspx)

# c# - 我可以在运行时向对象属性添加属性吗？

> ID：602384
> 
> 赞同：11
> 
> 时间：2009-03-02T13:39:43.560
> 
> 标签：c#, serialization, attributes

例如，我想删除或更改以下属性属性或添加新属性。是否可以？

```
[XmlElement("bill_info")]
[XmlIgnore]
public BillInfo BillInfo
{
  get { return billInfo; }
  set { billInfo = value; }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-02T13:44:59.413

（编辑 - 我误读了原来的问题）

您不能添加实际属性（它们被刻录到 IL 中）；但是，`XmlSerializer`您不必这样做 - 您可以在构造函数中为`XmlSerializer`. 但是，如果您这样做，您需要小心缓存`XmlSerializer`实例，否则它将为每个实例创建一个额外的程序集，这有点泄漏。（如果您使用只接受 a 的简单构造函数，它不会这样做`Type`）。看[`XmlAttributeOverrides`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeoverrides.aspx)。

例如：

```
using System;
using System.Xml.Serialization;
 public class Person
{
    static void Main()
    {
        XmlAttributeOverrides overrides = new XmlAttributeOverrides();
        XmlAttributes attribs = new XmlAttributes();
        attribs.XmlIgnore = false;
        attribs.XmlElements.Add(new XmlElementAttribute("personName"));
        overrides.Add(typeof(Person), "Name", attribs);

        XmlSerializer ser = new XmlSerializer(typeof(Person), overrides);
        Person person = new Person();
        person.Name = "Marc";
        ser.Serialize(Console.Out, person);
    }
    private string name;
    [XmlElement("name")]
    [XmlIgnore]
    public string Name { get { return name; } set { name = value; } }
} 
```

注意也；如果 xml 属性只是说明性的，那么还有*第二种*方法可以为与数据绑定相关的事物添加属性，方法是使用`TypeDescriptor.CreateProperty`and`ICustomTypeDescriptor`或`TypeDescriptionProvider`。恐怕比 xml 案例复杂得多——并且不适用于所有代码——只是使用组件模型的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T13:45:26.963

无法在运行时从类中添加/删除属性。

但是，可以在运行时更新 XML 序列化的工作方式，而无需编辑属性。见马克的帖子。

**编辑**更新

# svn - 带有时间戳的二进制文件的版本控制

> ID：602387
> 
> 赞同：3
> 
> 时间：2009-03-02T13:40:04.900
> 
> 标签：svn, version-control

我需要一个版本控制系统，它像 Subversion 一样工作，但能够保留每个文件的“修改”时间戳（日期）。

我们需要对我们的设置项目进行版本控制。在这种情况下，输入文件（dll/exe）保持它们的时间戳是很重要的。

执行此操作的最佳工具是什么？（操作系统：Windows）

更新：

这是我想要它做的一个例子：

*   将“foo.dll”（2009 年 1 月 1 日修改）和“bar.dll”（2009 年 2 月 2 日修改）放入工作目录
*   创建/测试设置并执行一次提交
*   当另一个开发人员签出项目时， foo.dll 和 bar.dll 都应该有他们的原始修改日期（2009 年 1 月 1 日和 2009 年 2 月 2 日）

我们目前的解决方法是压缩每个 dll（修改后的日期保存在 zip 中），但我更喜欢更简单的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:57:33.737

Subversion 具有[`use-commit-times`](http://svnbook.red-bean.com/en/1.5/svn.advanced.confarea.html#svn.advanced.confarea.opts.config)使本地副本使用每个文件的最后提交时间的时间戳的选项。也`svn export`总是设置最后提交时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T13:44:15.560

在[git](http://git-scm.com/)中，“提交”指向一棵树，将其标记为项目在某个时间点的样子。它包含有关该时间点的元信息，**例如时间戳、**自上次提交以来更改的作者、指向先前提交的指针等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:24:01.720

您可以尝试使用自己定义的颠覆属性来存储时间戳。如果您更改此时间戳，您将拥有文件的“已更改”状态并且可以提交它。您可以使用命令行访问属性的内容。你也有每个文件的不同时间。

但是，您可能需要一些小的附加脚本来设置/读取属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:54:05.490

这是 Subversion 开发人员在雷达上提出但尚未实施的请求之一。正如 'Nerdling' 所暗示的，git 或 mercurial 可能是更好的选择，但您在 Subversion 中有几个选择（因为您正在寻找类似 SVN 的东西）：

1.  SVN 网站上有一个讨论和 perl 脚本，其中有一些解决方法。它保留了初始提交的修改日期......此后，它使用提交时间，但您可能会修改脚本以使用修改后的时间。它是 perl，因此您在 Windows 上的使用情况可能会有所不同（我没有在 Windows 上使用过 cygwin 和/或 perl）：[http ://svn.haxx.se/users/archive-2006-10/1345.shtml](http://svn.haxx.se/users/archive-2006-10/1345.shtml)

2.  您可以在提交后更改每个修订版的 svn:date 属性以匹配修改时间。但是，这将更改提交中每个文件的修改时间，因此，如果不希望这样做，请务必自行提交二进制文件：http: [//svnbook.red-bean.com/en/1.5/svn.ref。 properties.html](http://svnbook.red-bean.com/en/1.5/svn.ref.properties.html)和[http://svnbook.red-bean.com/en/1.5/svn.advanced.props.html](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.html)

3.  我认为 Windows 上的 Tortoise SVN 可能有一些选项来处理在提交时设置日期属性。我只听说过这个谣言，并没有使用它，所以这是道听途说:-)

这些都不是特别优雅，并且需要您付出一些额外的努力，但是如果您想坚持使用 SVN，它们将起作用，这当然是一个很好的产品。如果您决定探索另一个 SCM，例如 git 或 mercurial，请注意您可以像 SVN 一样使用它们，而忽略它们的其他功能以帮助简化过渡。

# c# - Progress bar in uploading Xml file

> ID：602394
> 
> 赞同：1
> 
> 时间：2009-03-02T13:41:45.740
> 
> 标签：c#, file, upload, progress-bar, backgroundworker

i want to use a background thread for the process of loading the XML data, possibly with a progress bar to let the user know that the application is actively doing something. i have written this code through searching the net.
i want to load a XML tree in treeview on winform when a user cliks a Browse button. In case of a large XML file the winform freezes.So to let the user know that in background the work is going on i want to add a progress bar.i have used a background worker here.

But it is raising an exception of System.ArgumentException showing this message "The URL cannot be empty.\r\nParameter name: url" on ***xmlDocument.Load(txtFileName.Text);*** this line.
My xml file is in correct format and is at the proper location where i selected. But i am unable to find the cause of this exception. Can you please help out or tell me the correction in my code?
Thanks....

```
 private void btnBrowse_Click(object sender,EventArgs e)
        {
            bgWorker1.RunWorkerAsync();
            StripProgressBar.Value = 0;
            toolStripStatusLabel1.Text = "Browsing for a  Xml file";

            if (open.ShowDialog(this) == DialogResult.OK)
            {
                txtFileName.Text = open.FileName;
                initiatingTree(open.FileName); //this variable gives the name of selected file
            }
            while (this.bgWorker1.IsBusy)
            {
                StripProgressBar.Increment(1);
                // Keep UI messages moving, so the form remains
                // responsive during the asynchronous operation.
                Application.DoEvents();
            }
        }//Browse button      
        private void bgWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            xmlDocument = new XmlDocument();
            Thread.Sleep(5000);
            xmlDocument.Load(txtFileName.Text);
            btnBrowse.Enabled = false;
        }
        private void bgworker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
         {
             // Set progress bar to 100% in case it's not already there.
             StripProgressBar.Value = 100;
             if (e.Error == null)
             {
                 MessageBox.Show(xmlDocument.InnerXml, "Download Complete");
             }
             else
             {
                 MessageBox.Show("Failed to download file");
             }
             // Enable the Browse button and reset the progress bar.
             this.btnBrowse.Enabled = true;
             StripProgressBar.Value = 0;
             toolStripStatusLabel1.Text = "work finished processing request.";  
         }//workerCompleted 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T14:47:45.673

当用户单击“浏览”时，您将立即启动异步过程，方法是调用

```
bgWorker1.RunWorkerAsync(); 
```

这将调用`DoWork`您的后台工作程序的方法，该工作程序会休眠 5 秒，并从`txtFileName.Text`用户是否已完成他们在`FileOpenDialog`.

你最好把`byWorker1.RunWorkerAsync()`（和忙碌的等待）搬到`if (open.ShowDialog(this) == DialogResult.OK)`街区里。

```
 private void btnBrowse_Click(object sender,EventArgs e)
    {
        StripProgressBar.Value = 0;
        toolStripStatusLabel1.Text = "Browsing for a  Xml file";

        if (open.ShowDialog(this) == DialogResult.OK)
        {
            txtFileName.Text = open.FileName;
            initiatingTree(open.FileName); 

            bgWorker1.RunWorkerAsync();

            while (this.bgWorker1.IsBusy)
            {
                StripProgressBar.Increment(1);
                // Keep UI messages moving, so the form remains
                // responsive during the asynchronous operation.
                Application.DoEvents();
            }
        }
    } 
```

对于这些类型的问题，在要加载文件的位置放置一个断点会很有帮助，并查看发生这种情况时的值是什么......你可能会注意到它被一个空字符串调用。

您也可以考虑`RunWorkerAsync`使用参数的版本；您可以以这种方式传递文件，而不是尝试从文本框中异步读取它。

就个人而言，我不会使用调用`Application.DoEvents()`;的循环。相反，我会将控制权返回给 UI 线程，然后`Invoke()`从异步线程返回到它以影响进度条更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:02:55.107

当方法 bgWorker1.RunWorkerAsync(); 被称为事件 DoWork 被触发。

因为该方法是在应用程序开始时调用的，所以文件名文本框为空。

我希望你已经明白了。

# java - 如何在 Hibernate 注释应用程序中外部化命名查询？

> ID：602397
> 
> 赞同：10
> 
> 时间：2009-03-02T13:42:56.330
> 
> 标签：java, hibernate, hql

有没有办法将 HQL 命名查询外部化到外部文件。我有太多的命名查询，并且在我的实体类的头部使用`@NamedQueries`和伤害。`@NamedQuery`

有没有办法将多个文件外部化？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T15:43:58.353

您可以将查询放入`package-info.java`类中，例如，在域对象的根包中。但是，您必须使用 Hibernate 自己的`@NamedQueries`和`@NamedQuery`注释，而不是来自`javax.persistence`.

示例`package-info.java`文件：

```
@org.hibernate.annotations.NamedQueries({
    @org.hibernate.annotations.NamedQuery(
        name = "foo.findAllUsers", 
        query="from Users") 
}) 

package com.foo.domain; 
```

然后，您必须将包添加到您的`AnnotationConfiguration`. 我使用 Spring，所以这是设置`annonatedPackages`属性的问题：

```
<bean id="sessionFactory" 
class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
<property name="annotatedClasses">
      <list>
      ...
      </list>
</property>
<property name="annotatedPackages">
  <list>
      <value>com.foo.domain</value>
  </list>
</property> 
```

您也可以将类型和过滤器定义放在同一个文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T22:34:08.703

我认为这是不可能的，因为注释属性/属性值必须在编译时可用。因此，字符串不能外化为需要通过某种进程读取的文件。

我试图查找 package-info.java 是否可以提供某些东西，但找不到任何东西。

组织的另一种策略可能是将查询作为常量存储在类中。

**在您的实体类中：**

```
@NamedQuery(name="plane.getAll", query=NamedQueries.PLANE_GET_ALL) 
```

**然后为您的查询常量定义一个类：**

```
public class NamedQueries {
    ...
    public static final String PLANE_GET_ALL = "select p from Plane p";
    ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T18:13:45.337

也许这不是作者所要求的（外部化到非 java 文件），但这就是我解决它的方法：

1.) 在我添加`mappingResources`到 sessionFactory的应用程序上下文 xml 文件中

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="mappingResources">
      <list>
        <value>META-INF/Country.hbm.xml</value>
      </list>
    </property>
    <property name="annotatedClasses">
        <util:list>
            <value>com.example.Country</value>
        </util:list>
    </property>
    <property name="hibernateProperties" ref="hibernateProperties" />
</bean> 
```

在那个 Country.hbm.xml 我有

```
<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings 
    xmlns="http://java.sun.com/xml/ns/persistence/orm"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
    version="2.0">

    <entity class="com.example.Country">

        <named-query name="countryFindByCode">
            <query><![CDATA[
                select c
                  from Country c
                 where c.code = :code
            ]]></query>
        </named-query>

        <named-query name="countryFindByName">
            <query><![CDATA[
                select c
                  from Country c
                 where c.name = :name
            ]]></query>
        </named-query>

    </entity>

</entity-mappings> 
```

我用它来定义命名查询，实体配置的其余部分在注释中。

也许这对某人有帮助。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-09-07T05:41:35.997

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="mappingResources">
      <list>
        <value>META-INF/Country.hbm.xml</value>
      </list>
    </property>
    <property name="annotatedCla 
                  from Country c
                 where c.name = :name
            ]]></query>
        </named-query>

    </entity>

</entity-mappings> 
```

# c++ - COM 服务器可以重新分配 ([in, out] CACLSID * arg) 吗？

> ID：602410
> 
> 赞同：0
> 
> 时间：2009-03-02T13:46:28.160
> 
> 标签：c++, com, marshalling, midl

使用这样声明的 COM 接口方法：

```
[ object,
  uuid(....),
]
interface IFoo : IUnknown 
{
  HRESULT Foo([in, out] CACLSID * items);
} 
```

关于编组，是否允许服务器重新分配计数数组？（我*认为*是，但我不确定了）

它当前的实现只替换了现有的 ID，但我想实现一个更改（不会破坏合同），可以返回更多项目而不引入新接口。

**[编辑]**请注意[CACLSID](http://msdn.microsoft.com/en-us/library/bb401564.aspx)已经是一个数组，包含一个计数和一个指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T13:52:59.720

我已经很久没有做 COM 了，但它甚至可以分配一个新的数组吗？在那种情况下不应该`CACLSID ** items`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T15:43:17.553

您应该将 Count 作为第二个参数，它指示这么多元素的空间，使用这个 COM 库编组元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T15:58:24.007

首先，如果你想`Foo`接受一个 in 数组，你应该添加一个给出计数的参数，例如：

```
HRESULT Foo([in] int cItems, [in, out, size_is(cItems)] CACLSID * items); 
```

警告：此代码尚未编译，只是关闭文档。

其次，您不能在不更改其声明的情况下修改此方法的外部行为。要支持调整大小，您需要能够重新分配数组并传回其地址。您可以使用 a `SAFEARRAY`or declare `cItems`and`items`作为指向原始类型的指针`Foo`，例如：

```
HRESULT FooMutate([in, out] int *cItems, [in, out, size_is(*cItems)] CACLSID **items); 
```

同样，没有编译，所以如果你使用它，你实际上必须知道你在做什么。

# sql-server - 如何使用 LINQ 将记录添加到数据库中？

> ID：602414
> 
> 赞同：4
> 
> 时间：2009-03-02T13:47:49.297
> 
> 标签：sql-server, vb.net, linq, linq-to-sql

我一直在利用[Scott Gu 的 LINQ to SQL 教程](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)来尝试学习一些 LINQ。我已经能够查看、检索和更新记录，但无法将新记录写入数据库 (MSSQL)。Scott 在教程集的[第四部分](http://weblogs.asp.net/scottgu/archive/2007/07/11/linq-to-sql-part-4-updating-our-database.aspx)开始着手插入行。正如您在该页面上看到的（或可能已经知道），为了添加记录，您必须执行以下操作（VB.NET）：

```
Dim db as New LINQtoSQLDataContext

Dim oArticle as New article // table name
oArticle.Body = "Some Text"
oArticle.Title = "Some Title"
oArticle.Author = "Some Author"

db.articles.Add(oArticle) // this is the line that does not work. 
```

Visual Studio 2008 返回我“ `'add' is not a member of 'System.Data.Linq.Table(Of article)`”。

谁能给我推动正确的方向？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T13:49:03.037

```
db.articles.InsertOnSubmit(oArticle)
db.SubmitChanges() 
```

# algorithm - 公平地对较新的项目进行排名？

> ID：602417
> 
> 赞同：2
> 
> 时间：2009-03-02T13:50:19.540
> 
> 标签：algorithm, sorting

以 StackOverflow 本身为例，如果您有任何这样的系统，其中条目是基于此按排名顺序进行投票和查看的，您如何补偿以公平地对新条目进行排序？也就是说，如果给出了十个不好的答案并投票赞成，你如何确保人们看到可能更好但没有时间收集选票甚至一直被看到在底部的新条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T14:17:19.133

您可以在新帖子中添加 10 个“虚拟点赞”，该帖子会随着时间或视图而衰减。

例如，您可以将答案每小时或答案的每 100 次视图减少 1 虚拟赞成票（假设如果 100 人看到该帖子并且没有为它投票，则它可能被正确地评估为 0真实选票。

由于屏幕一直在变大和变宽，您还可以将所有答案列出两次，左侧按排名排序，右侧按年龄排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T14:55:08.713

您应该根据相对于最新帖子的年龄按比例降低旧帖子的实际排名。实际排名将来自调节排名、基于时间的排名和任何其他自定义修饰符。在发布每个新帖子时更新。不过，您应该将其留给用户来打开此功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-01T09:01:38.983

您可能会发现这篇文章很有趣：[如何构建流行度算法](http://blog.linkibol.com/post/How-to-Build-a-Popularity-Algorithm-You-can-be-Proud-of.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T13:52:41.843

提供“按最新排序”功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T13:57:37.887

或“未回答”部分 - 以 StackOverflow 为例。

由于您的“坏”答案已被投票，因此根据您网站的规则，按排名排序时应该看起来更高。

# jquery - Animation in jquery similar to marquee

> ID：602419
> 
> 赞同：0
> 
> 时间：2009-03-02T13:51:28.913
> 
> 标签：jquery, marquee

I want to move more than one ball image in alternative behavior of HTML.(exactly like the screen saver ball m If i use marquee tag means, it doesn't cross each other. Both moving around separately with the div.

It should move around the div and if i place more than one image, those both images should cross each other..

Please give me the code snippet for this along with the jquery version.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T10:22:28.667

[jScroller 是实现类似效果的好工具。](http://jscroller.markusbordihn.de/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-06-27T13:50:49.127

我建议你和这个一起去。它真的很轻！

[http://tonysamperi.github.io/endlessRiver/](http://tonysamperi.github.io/endlessRiver/)

Endless River 是一个 jQuery 插件，它可以为内容设置动画并使其无限滚动！

有用的功能是您不必为元素设置宽度，因为速度以像素/秒为单位！

EndlessRiver 将计算*<li>*元素的最佳宽度并保持速度不变！

# iphone - 如何在 iPhone 上初始化 NSObject 的子类？

> ID：602420
> 
> 赞同：18
> 
> 时间：2009-03-02T13:51:50.317
> 
> 标签：iphone, initialization, class-design, subclass

我想在一个类中编写一些方法，以便其他类可以使用`[instance methodName:Parameter]`.

如果该类是 的子类`UIViewController`，我可以使用`initWithNibName`它来初始化它。但是我想在**NSObject 的**子类中编写方法，如何初始化它？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-02T18:23:24.487

iphony 是正确的，但他或她并没有说您需要自己编写 init 方法。您的 init 方法通常应如下所示：

```
- (id) init
    {
    if (self = [super init])
         {
         myMember1 = 0; // do your own initialisation here
         myMember2 = 0;
         }
    return self;
    } 
```

虽然[苹果文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/init)说

> NSObject 类中定义的 init 方法不进行初始化；它只是返回自我。

一个人可能会想写

```
- (id) init
  {
    myMember1 = 0; // do your own initialisation here
    myMember2 = 0;
    return self;
  } 
```

这是错误的，并且不遵循文档中明确说明的内容：

> 在此 (init) 方法的自定义实现中，您必须调用 super 的指定初始化程序，然后初始化并返回新对象。

必须。不应该，可以，应该，等等。

你不应该假设 NSObject 的 init 在未来不会改变；也不是您的自定义类派生自的超类。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-02T14:04:34.343

我发现这可能有效：

```
TheClass *newObject = [[TheClass alloc] init];
//do something here
[newObject release];
```

# .net - Transactions with typed dataset and Sql Server CE

> ID：602421
> 
> 赞同：1
> 
> 时间：2009-03-02T13:51:55.323
> 
> 标签：.net, winforms, transactions, sql-server-ce, strongly-typed-dataset

I have a WinForms application that interacts with a SqlCe local database. I manage db operations using BindingSources, TableAdapters and typed datasets.I have several operations scattered through several methods in two different classes that I need to perform in a transaction and I was thinking of using System.Transactions.Transaction or CommitableTransaction. My question is, would Transaction or CommittableTransaction work successfully in a transaction and rollback in an error in this example code or do I have to also use transaction in *OtherClass* methods too?:

```
OtherClass othercls = new OtherClass();  
...  

private void DoAll()  
{  
/* begin transaction here */
this.tableAdapter.DoSomeDBWork();  
othercls.DeleteSomeRecords(); //uses tableadapter+sql code to delete. throws exception on error. doesn't have transaction  
othercls.DeletOtherRecords(); //uses tableAdapter.Rows.Find(id).Delete(). throws exception on error. doesn't have transaction  
othercls.Update(); //uses tableadapter.Update(). throws exception on error. doesn't have transaction  
this.DeleteSomeFiles(); //throws exception on fail 
/* end transaction here */ 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:48:49.020

试试*System.Transactions。**[交易范围](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)***。

根据 System.Transaction.TransactionScope[备注](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)部分，

> 如果事务范围内确实发生了异常，则它所参与的事务将被**回滚**。

# java - Java 优先级队列

> ID：602427
> 
> 赞同：2
> 
> 时间：2009-03-02T13:54:10.000
> 
> 标签：java, c++, data-structures, priority-queue, multimap

Java 的[优先级队列](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html)是一种数据结构，`O(log n)`对于 put（插入）和`O(log n)`poll（检索和删除 min 元素）具有复杂性。

C++ STL 的[多重映射](http://en.cppreference.com/w/cpp/container/multimap)具有相同的功能，但`O(1)`在检索和删除最小元素（开始和擦除）方面很复杂。Java中是否有等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T13:57:50.880

试试[Apache Commons Collections](http://commons.apache.org/collections/api-release/org/apache/commons/collections/MultiMap.html)。

MultiHashMap 和 MultiValueMap（从该页面链接）实际上实现了该接口。

实际上那里也有一个[Priority Queue](http://commons.apache.org/collections/api-release/org/apache/commons/collections/PriorityQueue.html)，但它被贬值了，有利于[buffer package](http://commons.apache.org/collections/api-release/org/apache/commons/collections/buffer/package-summary.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T14:02:24.597

[Google Collections](http://code.google.com/p/google-collections/)提供了 Multimap 实现。具体来说，TreeMultimap 可以使用比较器根据键、值或两者进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T16:33:56.417

首先，我会检查 C++ 的 multimap 是否确实给出了 O(1) 来*删除*min 元素。最常见的映射/优先级队列结构是树结构，其中*查询*最小元素具有 O(1) 复杂度，但*删除*它是 O(log n)。

也就是说，我认为跳过列表（由 Java 的**ConcurrentSkipListMap**实现）*可能*会给你 O(1) 来删除最小元素，但我不确定。评估 ConcurrentSkipListMap 性能时的问题之一是遍历操作“整理”先前删除留下的标记。因此，操作的复杂性实际上可能取决于之前的操作是什么。（另一方面，在某种程度上，几乎所有算法都是如此：某些数据是否在 CPU 缓存中可能取决于先前的操作是否将其放在那里......）

PS忘了说：看看**ConcurrentSkipListMap.pollFirstEntry()**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T14:12:43.497

`std:multimap`将是一个树结构，这意味着一起添加和删除将是 O(log n)。

# f# - "do" in "do Application.Run(form)" sentence

> ID：602428
> 
> 赞同：2
> 
> 时间：2009-03-02T13:54:11.717
> 
> 标签：f#

What is the difference between

```
do Application.Run(form) 
```

and, simply:

```
Application.Run(form) ? 
```

What is the role of `do` keyword in the first sentence?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T14:32:41.903

在某些早期版本中，“do”在该语言的许多地方都是必需的关键字，而现在您很少需要“do”。我能想到的其余例外是“do”仍然是循环语法的一部分（例如“while e1 do e2”），如果你想在启动方法上放置一个程序集级属性或属性，你可以把模块中最终代码块的显式“执行”之前的属性。经常在 F# 示例中你会看到

```
[<STAThread>]
do Application.Run(form) 
```

作为文件的最后两行，我认为仍然需要“do”，以便能够在其上方的行上附加属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T13:58:07.027

I think it's just a holdover - like how you can still CALL a sub or SET a variable instead of just doing those things directly, as in:

```
SET varname = 5
CALL mysub() 
```

Versus just:

```
varname = 5
mysub() 
```

In other words, I don't think it matters, and the compiler just discards it.

# visual-studio-2008 - Visual Studio.NET 2008 没有给我英文异常消息

> ID：602429
> 
> 赞同：10
> 
> 时间：2009-03-02T13:55:13.053
> 
> 标签：visual-studio-2008, exception

在以前版本的 VS.NET 或 .NET 框架中，默认情况下您会收到英文异常消息。如果您安装了“语言包”，您会收到以该语言包的语言显示的异常消息。

现在，我在荷兰语 Windows Vista 上使用英语 VS.NET 2008（未安装语言包）。

当我在开发时，我编写了一些触发异常的代码，我收到的异常消息是荷兰语（我的操作系统的语言）。我不希望它是荷兰语；我希望它是英文的。（原因很明显：谷歌更容易，而且那些翻译的错误信息很垃圾）。

在 VS.NET 中，我的国际设置设置为“英语”，在 Windows Vista 中，我的区域设置设置为“荷兰语/比利时”。如何在不更改 Windows 中的区域设置的情况下获得英文异常消息？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T14:20:32.790

在网上的 Stackoverflow 和其他网站上进行一些搜索后，似乎 Windows Vista 决定应该安装哪些语言包，并且似乎没有办法卸载这些语言包（在 XP 中这是可能的）。

我没有 Vista Ultimate（它允许您并排安装多个语言包）。

所以，我现在所做的是：

我创建了一个自定义条件编译符号 (DEVELOPER)，在我的应用程序中，我有以下代码：

```
#if DEVELOPER

Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo("en-us");

#endif 
```

我只需要确保，当我构建我的部署应用程序时，我不包括这个条件定义......（但是，我可以很容易地做到这一点，因为我的应用程序在 CI 下）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T15:07:18.153

`Thread.CurrentThread.CurrentUICulture`取决于您安装的操作系统的语言。因此，安装英文版操作系统是您唯一的选择。

或者就像您所说的那样，在您编写的每个应用程序中将 Thread.CurrentThread.CurrentUICulture 设置为“en-Us”，这在我看来“非常尴尬”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-05T11:21:39.830

几乎所有语言都有可用于 .Net Framework 的语言包。

查看您在已安装软件下找到的内容并卸载此语言包。这会导致VS2008会带来英文的错误信息等。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-02T13:57:04.970

这（很可能）是因为您安装了 Dutch NetFX。

# jquery - jQuery中的字符串操作

> ID：602438
> 
> 赞同：6
> 
> 时间：2009-03-02T13:58:23.733
> 
> 标签：jquery, string

我有一个 div 折叠单击文本标题。我想相应地将标题从“+过滤器”更改为“-过滤器”（当div折叠或展开时）

如何使用 jQuery 执行此操作？

```
if (headerDiv.text() starts with "+")
    replace "+" with "-" 
else 
    replace "-" with "+" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T14:09:03.130

没关系，我想通了

```
if ($(header).text().trim().charAt(0) == "+")
    $(header).text($(header).text().replace("+", "-"));
else
    $(header).text($(header).text().replace("-", "+")); 
```

如果这不是正确的方法，我将不胜感激

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T14:05:55.713

我会做：

```
var plus_string = "<span class=/"plus/">+</span>";
var minus_string = "<span class=/"minus/">-</span>";

if($("div.header").hasClass("plus")){
    $("div.header").removeClass("plus");
    $("div.header").addClass("minus");
    $("div.header").append(plus_string);
    $("span.plus").remove();
 } else (... the reverse of the above...) 
```

这是因为我会使用 plus 和 minus 类来处理一些 css 来更改标题 div 的外观。因为你可能已经这样做了，你可以像这样玩一点：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T21:13:47.633

保持简单，为什么需要解析它？你只是用另一个替换一个字符串。

```
if(headerDiv.text() == '+ filters')
{
    headerDiv.text() == '- filters';
}
elseif(headerDiv.text() == '- filters')
{
    headerDiv.text() == '+ filters';
} 
```

# .net - ASP.NET AJAX pageLoad() 和 JavaScript window.onload 有什么区别？

> ID：602441
> 
> 赞同：17
> 
> 时间：2009-03-02T14:01:30.653
> 
> 标签：.net, asp.net, javascript, asp.net-ajax

我正在使用 ASP.NET AJAX 并想了解这两个片段之间的区别：

```
function pageLoad(sender, eventArgs) { } 
```

和

```
window.onload = function() { } 
```

*   他们的行为一样吗？
*   还是一个在另一个之前被调用？
*   还是会自动调用一个而另一个不会？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-02T17:10:02.650

首先要注意几点。MS 发明了一种“客户端运行时对象”，称为[`Sys.Application`](http://msdn.microsoft.com/en-us/library/bb310856(loband).aspx). 它在整个页面的 [clientside] 生命周期中处理 raise `init`、`load`和`unload`事件，如下所示：

1.  [`Sys.Application.initialize()`](http://msdn.microsoft.com/en-us/library/bb311012(loband).aspx)开始`init`生命周期的一部分。这`initialize()`是所有客户端 AJAX 控件，之后它们就可以以编程方式进行交互了
2.  `Sys.Application`开始`load`生命周期的一部分，调用所有订阅此事件的处理程序
3.  最后，它调用全局函数`pageLoad`（如果已定义）

对每个部分（即 AJAX + UpdatePanel）回发重复步骤 2) 和 3)。

**所以最后的答案**是：`pageLoad`只是一个方便的捷径[`Sys.Application.add_load()`](http://msdn.microsoft.com/en-us/library/bb383829(loband).aspx)。

然而，关于它的关系`window.onload`，事情开始变得有趣。本质上，MS 只需要在阶段完成*后*`window.onload`触发。但是您无法控制浏览器何时触发，因为它与*“内容加载”*相关联。这被称为[“](http://dean.edwards.name/weblog/2005/09/busted/)[问题”](http://dean.edwards.name/weblog/2005/09/busted/)：*`init``onload`*[`window.onload`](http://dean.edwards.name/weblog/2005/09/busted/)**

 **> onload 事件在所有页面内容加载后触发（包括图像和其他二进制内容）。如果您的页面包含大量图像，那么您可能会在页面变为活动状态之前看到明显的延迟。

因此，他们只是发明了自己的“特殊”功能，在事件生命周期中的正确时间触发并调用它`"pageLoad"`。他们用来启动这个自定义事件生命周期的技巧是[将调用`Sys.Application.initialize()`放在结束`</form>`标记](http://msdn.microsoft.com/en-us/library/bb311012(loband).aspx)之前。服务器端运行时执行此操作。精明的读者会注意到这个技巧允许 MS 解决`window.onload`问题，因为您输入的任何代码`pageLoad`都会独立于二进制内容触发（[对于 IE 有一个罕见的捕获](http://seejoelprogram.wordpress.com/2008/06/08/when-sysapplicationinitialize-causes-operation-aborted-in-ie/)）。

**> 他们的行为是否相同？**

从概念上讲是的，实际上根本不是由于上述`window.onload`问题。唯一的规则是您应该只放入与您的 AJAX 控件交互的代码`pageLoad`，因为`window.onload`它遵循它自己的事件轨迹。

**> 或者是一个在另一个之前被调用？**

他们是完全、100% 独立的。

**> 或者一个会被自动调用而另一个不会？**

如果你定义了它们，它们都会被调用。

# terminology - Functional, Declarative, and Imperative Programming

> ID：602444
> 
> 赞同：476
> 
> 时间：2009-03-02T14:03:07.310
> 
> 标签：terminology, paradigms

What do the terms functional, declarative, and imperative programming mean?

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2011-12-02T14:11:45.293

在写这篇文章的时候，这个页面上投票最多的答案是不精确的，并且在声明性与命令性的定义上混淆了，包括引用维基百科的答案。一些答案以不同的方式混淆了这些术语。

另请参阅[我对](https://stackoverflow.com/questions/129628/what-is-declarative-programming/8365840#8365840)电子表格编程为何是声明性的解释，而不管公式是否会改变单元格。

此外，一些答案声称函数式编程必须是声明式的子集。在这一点上，这取决于我们是否将“功能”与“程序”区分开来。让我们先处理命令​​式与声明式。

***声明性表达*的定义**

 ***唯一**可以将*声明*式表达式与*命令式*表达式区分开来的属性是其子表达式的引用透明度 (RT)。所有其他属性要么在两种类型的表达式之间共享，要么从 RT 派生。

100% 的声明性语言（即所有可能的表达式都是 RT 的语言）不允许（以及其他 RT 要求）存储值的突变，例如 HTML 和大多数 Haskell。

***RT 表达式*的定义**

 *RT 通常被称为“没有副作用”。*效果*一词没有精确的定义，因此有些人不同意“无副作用”与 RT 相同。RT 有一个[精确的定义](https://stackoverflow.com/a/8346779)：

> 如果对于所有程序，表达式`e`是引用透明的，如果`p`每次出现的`e`in`p`都可以替换为评估的结果`e`，而不影响 的可观察结果`p`。

由于每个子表达式在概念上都是一个函数调用，RT 要求函数的实现（即被调用函数内部的表达式）不能访问函数*外部*的可变状态（访问[可变*局部*状态](https://stackoverflow.com/a/8346779)是允许）。简而言之，函数（实现）应该是*pure*。

***纯函数*的定义**

 *纯函数通常被称为“没有副作用”。*效果*这个词没有一个准确的定义，所以有些人不同意。

纯函数具有以下属性。

*   唯一可观察的输出是返回值。
*   唯一的输出依赖是参数。
*   在生成任何输出之前，参数已完全确定。

请记住，RT 适用于表达式（包括函数调用），而纯度适用于（实现）函数。

产生 RT 表达式的不纯函数的一个不起眼的例子是并发，但这是因为纯度在中断抽象层被破坏了。你真的不需要知道这一点。要制作 RT 表达式，请调用纯函数。

**RT的导数属性**

声明式编程引用的任何其他属性，例如Wikipedia 使用的[1999 年的引用](http://www.csc.liv.ac.uk/%7Efrans/OldLectures/2CS24/declarative.html#detail)，要么源自 RT，要么与命令式编程共享。从而证明我的精确定义是正确的。

请注意，[外部值](https://stackoverflow.com/a/8346779)的不变性是 RT 要求的一个子集。

*   声明性语言没有循环控制结构，例如`for`and `while`，因为**由于不可变性**，循环条件永远不会改变。

*   声明性语言除了嵌套函数顺序（也称为逻辑依赖项）之外不表达控制流，因为 **由于不可变性**，评估顺序的其他选择不会改变结果（见下文）。

*   声明式语言表达逻辑“步骤”（即嵌套的 RT 函数调用顺序），但每个函数调用是否是更高级别的语义（即“做什么”）并不是声明式编程的要求。与命令式的区别在于，**由于不可变性**（即更普遍的 RT），这些“步骤”不能依赖于可变状态，而仅依赖于所表达逻辑的关系顺序（即函数调用的嵌套顺序，也就是子表达式）。

例如，在对段落`<p>`中的子表达式（即标签）进行评估之前，无法显示 HTML 段落。[由于标签层次的逻辑关系（子表达式的嵌套，类似嵌套的函数调用](http://confluence.jetbrains.net/display/Kotlin/Type-safe+Groovy-style+builders?focusedCommentId=41488185#comment-41488185)），没有可变状态，只有顺序依赖。

*   因此存在不变性（更一般地 RT）的派生属性，即声明性表达式*仅*表达组成部分的*逻辑*关系（即子表达式函数参数的）而不是*可变状态*关系。

**评估顺序**

子表达式求值顺序的选择只能在任何函数调用不是 RT（即函数不是纯函数）时给出不同的结果，例如在函数内部访问函数外部的一些可变状态。

例如，给定一些嵌套表达式，例如，如果函数、和是纯函数，`f( g(a, b), h(c, d) )`则函数参数的急切和惰性求值将给出相同的结果。`f``g``h`

然而，如果函数`f`、`g`和`h`不是纯函数，则评估顺序的选择会给出不同的结果。

请注意，嵌套表达式在概念上是嵌套函数，因为表达式运算符只是伪装成一元前缀、一元后缀或二元中缀表示法的函数调用。

切线地，如果所有标识符，例如`a`, `b`, `c`, `d`，在任何地方都是*不可变*的，则程序外部的状态不能被访问（即 I/O），并且没有抽象层中断，那么函数总是纯函数。

顺便说一句，Haskell 有不同的语法，`f (g a b) (h c d)`.

**评估订单详情**

函数是从输入到输出的状态转换（不是可变的存储值）。对于*纯*函数调用的 RT 组合，这些状态转换的执行顺序是独立的。由于没有副作用以及[RT 函数可以被其缓存值替换](https://stackoverflow.com/a/8346779)的原理，每个函数调用的状态转换都独立于其他函数调用。为了[纠正一个流行的误解](http://goldwetrust.up-with.com/t112p180-computers#4434)，纯单子组合**[总是声明性和 RT](http://candleapp.blogspot.com/2011/12/2-misconcepts-about-functional.html?showComment=1323267588192#c5825897491390894567)**，尽管 Haskell 的`IO`单子[可以说是不纯](https://stackoverflow.com/a/4392603/615784)的，因此`World`对于程序外部的状态是必要的（但在下面的警告的意义上，副作用被隔离）。

急切求值意味着函数参数在调用函数之前被求值，而惰性求值意味着直到（并且如果）它们在函数中被访问时才[求值。](http://augustss.blogspot.com/2011/04/ugly-memoization-heres-problem-that-i.html#c7176854531514039037)

**定义**：函数*参数*在函数*定义*站点声明，函数*参数*在函数*调用*站点提供。*了解参数*和*参数*之间的区别。

从概念上讲，所有表达式都是函数调用的（一个组合），例如，常量是没有输入的函数，一元运算符是具有一个输入的函数，二元中缀运算符是具有两个输入的函数，构造函数是函数，甚至是控制语句（例如`if`, `for`, `while`）可以用函数建模。[评估这些](http://augustss.blogspot.com/2011/04/ugly-memoization-heres-problem-that-i.html#c7176854531514039037) *参数*函数的顺序（不要与嵌套函数调用顺序混淆）不是由语法声明的，例如`f( g() )`可以急切地评估`g`then`f`的`g`结果，或者它可以评估`f`并且只有`g`在 需要它的结果时才懒惰地评估`f`。

警告，没有[图灵完备](https://stackoverflow.com/a/8283566)的语言（即允许无限递归）是完全声明性的，例如惰性求值引入了内存和时间不确定性。但是由于评估顺序的选择，这些副作用仅限于内存消耗、执行时间、延迟、不终止和[外部滞后](https://stackoverflow.com/questions/5357918/what-does-hysteresis-mean-and-how-does-it-apply-to-computer-science-or-programmi)，因此是外部同步。

**函数式编程**

因为声明式编程不能有循环，所以迭代的唯一方法是函数递归。从这个意义上说，函数式编程与声明式编程有关。

但**函数式编程并不局限于声明式编程**。功能组合可以[与子类型形成对比](https://stackoverflow.com/a/8352969)，特别是在[表达式问题](https://stackoverflow.com/questions/3596366/what-is-the-expression-problem)方面，可以通过[添加子类型或功能分解](http://www.scala-lang.org/docu/files/IC_TECH_REPORT_200433.pdf#)来实现扩展。[扩展可以是](http://beust.com/weblog2/archives/000490.html)两种方法的混合。

函数式编程通常使函数成为一等对象，这意味着函数类型可以出现在语法中任何其他类型可能出现的任何位置。结果是函数可以输入和操作函数，从而通过强调函数组合来提供关注点分离，即分离确定性计算的子计算之间的依赖关系。

例如，不是为可以应用于集合的每个元素的无限数量的可能的专门操作中的每一个[编写单独的函数](http://www.unsafeperformio.com/papers/thesis.pdf#page=18)（如果函数还必须是声明性的，则使用递归而不是循环），函数式编程采用可重用迭代函数，例如`map`, `fold`, `filter`. 这些迭代函数输入一个一流的专用动作函数。这些迭代函数迭代集合并为每个元素调用输入专用操作函数。这些动作函数更简洁，因为它们不再需要包含循环语句来迭代集合。

但是，请注意，如果一个函数不是纯函数，那么它实际上是一个过程。我们或许可以争辩说，使用不纯函数的函数式编程实际上是过程式编程。因此，如果我们同意声明式表达式是 RT，那么我们可以说过程式编程不是声明式编程，因此我们可能会争辩说函数式编程始终是 RT，并且必须是声明式编程的子集。

**并行性**

这种具有一流功能的功能组合可以通过分离独立功能来表达[并行性的深度。](http://existentialtype.wordpress.com/2011/03/17/parallelism-is-not-concurrency/)

> 布伦特原则：工作 w 和深度 d 的计算可以在时间 O(max(w/p, d)) 中在 p 处理器 PRAM 中实现。

并发性和并行性[都需要声明式编程](http://ghcmutterings.wordpress.com/2009/10/06/parallelism-concurrency/)，即不变性和 RT。

> 那么并行==并发这个危险的假设是从哪里来的呢？这是具有副作用的语言的自然结果：当您的语言到处都有副作用时，任何时候您尝试一次做不止一件事时，您基本上都会因每个操作的效果交错而导致不确定性. 所以在副作用语言中，获得并行性的唯一方法是并发。因此，我们经常看到两者混为一谈也就不足为奇了。

## FP评估顺序

请注意，评估顺序也会影响功能组合的终止和性能副作用。

Eager (CBV) 和lazy (CBN) 是分类决斗[ [10](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ]，因为它们具有颠倒的评估顺序，即分别先评估外部函数还是内部函数。想象一棵倒置的树，然后从功能树分支提示向上到分支层次结构到顶层功能主干进行渴望评估；然而，lazy 从树干到分支尖端进行评估。Eager 没有合取积（“and”，a/k/a 分类“products”），lazy 没有析取副积（“or”，a/k/a 分类“sums”）[ [11](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ]。

**表现**

*   渴望的

与非终止一样，eager 对合取函数组合过于急切，即组合控制结构做了惰性没有完成的不必要的工作。例如，当它由终止于第[一个](http://augustss.blogspot.com/2011/05/more-points-for-lazy-evaluation-in.html)真正元素的折叠组成时，急切且不必要地将整个列表映射为布尔值。

这种不必要的工作是在急切与懒惰的顺序时间复杂度中声称的“最多”一个额外的[log n 因素的原因，两者都具有纯函数。](http://goldwetrust.up-with.com/t112p180-computers#4437)一个解决方案是使用带有惰性构造函数的函子（例如列表）（即使用可选的惰性产品进行急切），因为急切不正确源自内部函数。这是因为产品是构造类型，即在初始固定点上具有初始代数的归纳类型[ [11](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ]

*   懒惰的

与非终止一样，懒惰对于析取函数组合来说太懒了，即共归纳终结性可能比必要的晚发生，从而导致不必要的工作和迟到的不确定性，而 eager[ [10](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ][ [11](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ]不是这种情况. 最终性的示例是状态、计时、非终止和运行时异常。这些是命令式的副作用，但即使在纯声明式语言（例如 Haskell）中，命令式 IO monad 中也存在状态（注意：并非所有 monad 都是命令式的！）隐含在空间分配中，并且时间是相对于命令式的状态真实世界。即使与可选的渴望副产品一起使用惰性也会将“惰性”泄漏到内部副产品中，因为使用惰性时，惰性不正确性[源于外部函数](http://lambda-the-ultimate.org/node/2273#comment-40174)（请参阅非终止部分中的示例，其中 == 是外部二元运算符函数）。这是因为联积受终结性的限制，即在最终对象上具有最终代数的协约类型[ [11](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ]。

Lazy 会导致函数设计和调试时出现延迟和空间的不确定性，由于声明的函数层次结构和运行时求值顺序[之间的不协调，其调试可能超出了大多数程序员的能力。](http://goldwetrust.up-with.com/t112p195-computers#4487)使用 eager 评估的惰性纯函数可能会在运行时引入以前看不见的非终止。相反，使用惰性求值的渴望纯函数可能会在运行时引入以前看不见的空间和延迟不确定性。

**不终止**

在编译时，由于图灵完备语言中的停机问题和相互递归，通常不能保证函数终止。

*   渴望的

用急切但不懒惰，对于`Head`"and"的连词`Tail`，如果要么`Head`或`Tail`不终止，则分别为要么`List( Head(), Tail() ).tail == Tail()`或`List( Head(), Tail() ).head == Head()`不为真，因为左侧不终止，而右侧不终止。

然而，懒惰的双方都终止了。因此，eager 对合取积过于急切，并且在不需要的情况下不终止（包括运行时异常）。

*   懒惰的

懒惰但不急切，对于`1`“或”的析取`2`，如果`f`不终止，`List( f ? 1 : 2, 3 ).tail == (f ? List( 1, 3 ) : List( 2, 3 )).tail`则不正确，因为左侧终止，而右侧不终止。

然而，由于渴望双方都不会终止，所以永远不会达到平等测试。因此，lazy 对析取副产品太懒了，并且在这些情况下，在完成比渴望更多的工作后无法终止（包括运行时异常）。

[ [10](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ] 声明性连续性和分类对偶性，Filinski，第 2.5.4 节 CBV 和 CBN 的比较，以及 SCL 中的 3.6.1 CBV 和 CBN。

[ [11](http://www.diku.dk/hjemmesider/ansatte/andrzej/papers/DCaCD.ps.gz) ] 声明性连续性和分类对偶性，Filinski，第 2.2.1 节产品和副产品，2.2.2 终端和初始对象，2.5.2 带有惰性产品的 CBV，以及 2.5.3 带有热切副产品的 CBN。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-03-02T14:11:23.703

There's not really any non-ambiguous, objective definition for these. Here is how *I* would define them:

**Imperative** - The focus is on what steps the computer should take rather than what the computer will *do* (ex. C, C++, Java).

**Declarative** - The focus is on what the computer should do rather than how it should do it (ex. SQL).

**Functional** - a subset of declarative languages that has heavy focus on recursion

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2011-09-05T02:36:05.303

**命令式**和**声明**式描述了两种相反的编程风格。命令式是传统的“循序渐进”的方法，而声明式则更多的是“这就是我想要的，现在你知道如何去做”。

这两种方法贯穿于整个编程过程——即使使用相同的语言和相同的程序。通常，声明式方法被认为是可取的，因为它使程序员不必指定这么多细节，同时也减少了出现错误的机会（如果你描述了你想要的结果，并且一些经过良好测试的自动过程可以从那个向后工作到定义步骤然后您可能希望事情比必须手动指定每个步骤更可靠）。

另一方面，命令式方法为您提供了更多的低级控制 - 它是编程的“微观管理者方法”。这可以让程序员利用有关问题的知识来给出更有效的答案。因此，程序的某些部分以更具声明性的风格编写并不罕见，但对速度至关重要的部分则更加迫切。

正如您可能想象的那样，您用于编写程序的语言会影响您的声明性 - 一种具有内置“智能”功能的语言，可以根据结果描述确定要做什么，这将允许更具声明性这种方法比程序员需要先用命令式代码添加这种智能，然后才能在上面构建更具声明性的层。因此，例如，像 prolog 这样的语言被认为是非常具有声明性的，因为它内置了一个搜索答案的过程。

到目前为止，您会注意到我没有提到**函数**式编程。那是因为它是一个术语，其含义与其他两个没有直接关系。在最简单的情况下，函数式编程意味着您使用函数。特别是，您使用支持函数作为“第一类值”的语言 - 这意味着您不仅可以编写函数，而且可以编写编写函数的函数（编写函数......），并将函数传递给功能。简而言之 - 函数与字符串和数字一样灵活和通用。

那么，函数式、命令式和声明式经常被一起提到，这似乎很奇怪。其原因是将函数式编程的想法“发挥到极致”的结果。从最纯粹的意义上说，函数是数学中的东西——一种“黑匣子”，它接受一些输入并总是给出相同的输出。并且这种行为不需要存储变化的变量。因此，如果您设计一种编程语言，其目的是实现一个非常纯粹的、受数学影响的函数式编程理念，那么您最终会在很大程度上拒绝可以改变的值的理念（在一定的、有限的、技术意义上）。

如果你这样做了——如果你限制了变量的变化方式——那么你几乎会意外地迫使程序员编写更具声明性的程序，因为大部分命令式编程都在描述变量是如何变化的，而你不能再去做！所以事实证明，函数式编程——尤其是用函数式语言编程——往往会给出更多的声明性代码。

总结一下，那么：

*   命令式和声明式是两种相反的编程风格（相同的名称用于鼓励这些风格的编程语言）

*   函数式编程是一种编程风格，其中函数变得非常重要，因此改变值变得不那么重要。指定值更改的有限能力迫使采用更具声明性的样式。

所以“函数式编程”通常被描述为“声明式”。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-03-02T17:18:51.740

简而言之：

**命令式语言**指定计算机按顺序执行的一系列指令（执行此操作，然后执行此操作）。

**声明性语言**声明了一组关于哪些输出应该由哪些输入产生的规则（例如，如果你有 A，那么结果就是 B）。引擎会将这些规则应用于输入，并给出输出。

**函数式语言**声明了一组数学/逻辑函数，这些函数定义了如何将输入转换为输出。例如。f(y) = y * y。它是一种声明性语言。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2011-10-23T18:45:57.033

势在必行：***如何***实现我们的目标

```
 Take the next customer from a list.
   If the customer lives in Spain, show their details.
   If there are more customers in the list, go to the beginning 
```

声明式：***我们***想要实现的目标

```
 Show customer details of every customer living in Spain 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2011-05-03T11:07:19.107

**命令式编程**是指任何编程风格，其中您的程序由**描述计算机执行的操作将如何发生**的指令构成。

**声明式编程**是指任何编程风格，其中您的程序是对问题或解决方案的描述——但**没有明确说明工作将如何完成**。

**函数式编程**是通过评估函数和函数的函数来编程......因为（严格定义的）函数式编程意味着通过定义无副作用的数学函数进行编程，所以它**是一种声明式编程，但它不是唯一一种声明式编程**.

**逻辑编程**（例如在 Prolog 中）是另一种形式的声明式编程。它涉及通过确定逻辑语句是否为真（或是否可以满足）来进行计算。程序通常是一系列事实和规则——即描述而不是一系列指令。

**术语重写**（例如 CASL）是另一种形式的声明式编程。它涉及代数项的符号变换。它与逻辑编程和函数式编程完全不同。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2012-08-07T01:27:38.480

**imperative** - expressions describe sequence of actions to perform (associative)

**declarative** - expressions are declarations that contribute to behavior of program (associative, commutative, idempotent, monotonic)

**functional** - expressions have *value* as only effect; semantics support equational reasoning

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-03-13T10:06:30.587

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-12-19T18:21:22.487

命令式编程：告诉“机器”如何做某事，结果你想要发生的事情就会发生。

声明式编程：告诉“机器”你想发生什么，让计算机弄清楚如何去做。

### 命令式示例

```
function makeWidget(options) {
    const element = document.createElement('div');
    element.style.backgroundColor = options.bgColor;
    element.style.width = options.width;
    element.style.height = options.height;
    element.textContent = options.txt;

    return element;
} 
```

### 声明式示例

```
function makeWidget(type, txt) {
    return new Element(type, txt);
} 
```

注意：区别不在于简洁、复杂或抽象。如前所述，区别在于*how*与*what*。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-03-02T15:00:44.643

我认为您的分类不正确。有两种相反的类型命令式和声明式。函数式只是声明式的一个子类型。顺便说一句，维基百科陈述了同样的事实。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-07-01T15:07:27.230

## 如今，新的焦点：我们需要旧的分类吗？

过去， *命令式/声明式/功能性*方面很好地对通用语言进行分类，但现在所有“大语言”（如 Java、Python、Javascript 等）都有一些选项（通常是[框架](https://en.wikipedia.org/wiki/Software_framework)）来表达“其他焦点”比其主要的（通常的命令式），并表达并行过程，声明性函数，lambdas等。

所以这个问题的一个很好的变体是*“今天对框架进行分类有什么好处？”* ...一个重要的方面是我们可以标记为*“编程风格”* ...

## 专注于数据与算法的融合

一个很好的例子来解释。正如您可以[在 Wikipedia 上阅读有关 jQuery 的内容](http://en.wikipedia.org/wiki/JQuery)，

> jQuery 核心特性集——DOM 元素选择、遍历和操作——由其选择器引擎 (...) 启用，创建了一种新的“编程风格”，融合了算法和 DOM 数据结构

因此，jQuery 是专注于*“新编程风格”*的最佳（流行）示例，这不仅是面向对象，而且是“**融合** [算法和数据结构](http://en.wikipedia.org/wiki/Algorithms_%2B_Data_Structures_%3D_Programs)”。jQuery 在电子表格中有些反应，但不是“面向单元格”，是“*面向 DOM 节点*”......比较此上下文中的主要*样式：*

1.  **不融合**：在所有“大语言”中，在任何函数式/声明式/命令式表达式中，通常是数据和算法的“不融合”，除了某些面向对象，即[严格代数结构](https://en.wikipedia.org/wiki/Algebraic_structure)观点的*融合*。

2.  **一些融合**：所有经典的融合策略，现在都有一些框架使用它作为范例...... [数据流](http://en.wikipedia.org/wiki/Dataflow_programming)， [事件驱动编程](http://en.wikipedia.org/wiki/Event-driven_programming)（或旧的领域特定语言，如[awk](http://en.wikipedia.org/wiki/Awk)和[XSLT](http://en.wikipedia.org/wiki/XSLT)）......就像使用现代电子表格进行编程一样，它们也是**[反应式编程](http://en.wikipedia.org/wiki/Reactive_programming)**风格的例子。

3.  **大融合**：是“jQuery 风格”... jQuery 是一种专注于“*融合*算法和[DOM 数据结构](https://www.w3.org/TR/DOM-Level-2-Core/introduction.html)”的领域特定语言。
    PS：其他“查询语言”，如 XQuery、SQL（使用 PL 作为命令式表达式选项）也是数据算法融合示例，但它们是*孤岛*，与其他系统模块没有融合... [Spring](https://projects.spring.io/spring-framework/)，当使用 `find()`-variants和*规范*条款，是另一个很好的融合例子。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-06-08T14:21:54.427

Declarative programming is programming by expressing some timeless logic between the input and the output, for instance, in pseudocode, the following example would be declarative:

```
def factorial(n):
  if n < 2:
    return 1
  else:
    return factorial(n-1)

output = factorial(argvec[0]) 
```

We just define a relationship called the 'factorial' here, and defined the relationship between the output and the input as the that relationship. As should be evident here, about any structured language allows declarative programming to some extend. A central idea of declarative programming is immutable data, if you assign to a variable, you only do so once, and then never again. Other, stricter definitions entail that there may be no side-effects at all, these languages are some times called 'purely declarative'.

The same result in an imperative style would be:

```
a = 1
b = argvec[0]
while(b < 2):
  a * b--

output = a 
```

In this example, we expressed no timeless static logical relationship between the input and the output, we changed memory addresses manually until one of them held the desired result. It should be evident that all languages allow declarative semantics to some extend, but not all allow imperative, some 'purely' declarative languages permit side effects and mutation altogether.

Declarative languages are often said to specify 'what must be done', as opposed to 'how to do it', I think that is a misnomer, declarative programs still specify how one must get from input to output, but in another way, the relationship you specify must be *effectively computable* (important term, look it up if you don't know it). Another approach is *nondeterministic* programming, that really just specifies what conditions a result much meet, before your implementation just goes to exhaust all paths on trial and error until it succeeds.

Purely declarative languages include Haskell and Pure Prolog. A sliding scale from one and to the other would be: Pure Prolog, Haskell, OCaml, Scheme/Lisp, Python, Javascript, C--, Perl, PHP, C++, Pascall, C, Fortran, Assembly

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-04-09T21:13:13.737

这里有一些关于提到的“类型”的好答案。

我提交了一些额外的、更“异国情调”的概念，这些概念通常与函数式编程人群相关：

*   **领域特定语言**或**DSL**编程：创建一种新语言来处理手头的问题。
*   **元编程**：当您的程序编写其他程序时。
*   **进化编程**：您构建一个不断改进自身或生成连续更好的子程序代的系统。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-08-20T21:29:53.387

简而言之，一种编程风格越强调什么（做什么）抽象出如何（做什么）的细节，这种风格就越被认为是声明性的。命令式的情况正好相反。函数式编程与声明式风格相关联。

# python - 来自 Python 标准库的恶意代码

> ID：602445
> 
> 赞同：5
> 
> 时间：2009-03-02T14:03:39.790
> 
> 标签：python, standard-library

所以，我们得到了这个：[1000% 的加速，或者说，stdlib 很烂](http://lucumr.pocoo.org/2009/3/1/the-1000-speedup-or-the-stdlib-sucks)。它展示了一个相当糟糕的错误，即使在我们说话的时候，它也可能使宇宙付出了很多周期的代价。现在修好了，太好了。

那么你注意到标准库的哪些部分是邪恶的？

我希望所有负责任的人都能将答案与错误报告（如果合适）和补丁（如果超人）相匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T14:15:54.970

[rexec](http://docs.python.org/library/rexec.html)模块中有很多安全漏洞，几乎没用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T14:27:51.010

（因为这是一个不同的模块，所以把它放在不同的答案中）

[cgitb](http://docs.python.org/library/cgitb.html)有一些奇怪的线程问题。请参阅[此错误报告](http://bugs.python.org/issue1665206)。

# perl - 预增 $#array 是什么意思？

> ID：602451
> 
> 赞同：5
> 
> 时间：2009-03-02T14:06:47.520
> 
> 标签：perl, arrays, syntax

我遇到了以下代码行。它有问题：

*   它的目的与 push 相同
*   它应该使用 push
*   很难阅读，理解
*   从那以后，我将其更改为使用推送
*   它做了我认为是非法的事情，但显然不是

这里是：

```
$array [++$#array] = 'data'; 
```

我的问题是：预递增 $#array 是什么意思？我一直认为 $#array 是数组的属性，而不是可写的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-02T16:03:16.943

[perldata](http://perldoc.perl.org/perldata.html)说：

“数组的长度是一个标量值。您可以通过评估 $#days 来找到数组 @days 的长度，就像在 csh 中一样。但是，这不是数组的长度；它是最后一个元素的下标，这是一个不同的值，因为通常有第 0 个元素。分配给 $#days 实际上会更改数组的长度。以这种方式缩短数组会破坏中间值。延长先前缩短的数组不会恢复那些值元素。”

修改 $#array 在某些情况下很有用，但在这种情况下，显然 push 更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T14:21:56.143

分配一个大于当前数组长度的值来`$#array`扩展数组。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T17:08:43.963

后增量将首先返回变量，然后再增加它。

如果您使用后增量，您将修改最后一个元素，因为它首先返回，然后将一个空元素推到最后。在第二个循环中，您将修改该空值并推送一个新的空值以供以后使用。所以它根本不会像推动一样起作用。

预增量将增加变量然后返回它。这样，您的示例将始终写入数组的最后一个新元素，并且像 push 一样工作。下面的例子：

```
my (@pre, @post);

$pre[$#pre++] = '1';
$pre[$#pre++] = '2';
$pre[$#pre++] = '3';

$post[++$#post] = '1';
$post[++$#post] = '2';
$post[++$#post] = '3';

print "pre keys: ".@pre."\n";
print "pre: @pre\n";
print "post keys: ".@post."\n";
print "post: @post\n"; 
```

输出：

```
pre keys: 3
pre: 2 3
post keys: 3
post: 1 2 3 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T14:26:03.213

此代码也有效：

```
$ perl -le 'my @a; $a[@a]="Hello"; $a[@a]=" world!"; print @a'
Hello world! 
```

Perl 数组是动态的，并且在分配超出限制时会增长。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T15:57:15.820

首先，这是犯规的。

也就是说，我也很惊讶它的工作原理。我猜想`++$#array`在尝试增加数字时会出现“无法修改常量”错误。（当然，并不是说我不小心这样做了。）但是，我想这正是我们错的地方：`$#array`不是一个常数（一个数字）；这是一个变量表达式。因此，您可以弄乱它。考虑以下：

```
my @array = qw/1 2 3/;

++$#array;
$array[$#array] = qw/4/;

print "@array\n" 
```

甚至，为了额外的乐趣，这个：

```
my @array = qw/1 2 3/;

$#array += 5;

foreach my $wtf (@array) {
  if (defined $wtf) {
    print "$wtf\n";
  }
  else {
    print "undef\n";
  }
} 
```

而且，是的，*Perl Cookbook*很乐意用来`$#array`增加或截断数组（第 4 章，配方 3）。我仍然觉得它很丑，但也许这只是一种挥之不去的“但它是一个数字”的偏见。

# .net - 您如何处理检查以查看用户是否在对话框中更改了某些内容

> ID：602464
> 
> 赞同：2
> 
> 时间：2009-03-02T14:14:02.247
> 
> 标签：.net, winforms

在这里谈论 .NET WinForms：

例如，如果您有一个应用程序，其中某人可以使用某些属性对话框更改项目，那么您如何确定用户在单击取消时是否更改了某些内容（以决定是否显示取消确认消息框）。

我可以想到2种方法：

1.  定义脏位并处理所有“更改”事件以将该位设置为真。
2.  克隆原始对象并编写一些比较代码，以确定修改后的对象与原始对象相比是否真的被修改了

有没有更优雅和/或更通用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T14:37:55.417

这两个选项都有效。

但是请考虑以下情况：用户更改了一个值，然后将其更改回原来的值。

根据脏位方法，它被改变了。但根据克隆和比较方法，它不是。所以首选这种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T14:15:41.400

我的 DAL 做了你在 2 中提到的事情。所以我可以盲目地将所有值分配回我的 DAO，它只负责提交实际更改的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T14:41:23.553

实际上，在对话框中，单击取消应该只是关闭对话框。单击确定/保存应保存所有更改。

因此，这两种方法都存在轻微缺陷，因为它们假设您在用户单击“确定”*之前更改了模型！*

我会做以下事情：将一个伪模型对象附加到对话框。让更改反映在此对象中，然后在*Cancel上将其废弃或在**Save*上将其传递给您的 DAL 。如果您只在第一次更改时创建伪模型，那么为什么您需要取消确认对话框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T14:44:05.823

如果您想知道是否有任何更改（不特定于确切更改的内容），那么在加载表单时，`GetHashCode`在您的对象上，然后关闭，`GetHashCode`再次调用，看看结果是否不同。

但是，您将需要覆盖对象中的 GetHashcode 函数：

```
Public Class Person

    Private _firstName as string = string.empty
    Private _lastName as string = string.empty
    Private _dob as Datetime = Date.MinVal
    private _weight as single = 0.0

    ...

    Public Overrides GetHashCode as Integer

        Dim sb as new System.Text.StringBuilder

        sb.append(_firstName)
        sb.append(_lastName)
        sb.append(_dob)
        ...
        sb.append(_weight)

        Return sb.ToString.GetHashCode

    End Function

End Class 
```

这适用于我们的对象和 DAL :)

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T14:51:14.277

重新考虑要在其中显示确认对话框的设计。确认框在很大程度上是无用的，因为用户习惯于总是按“是的，这就是我的意思”。相反，如果用户在进行更改后取消，请为用户提供恢复该数据的机制。如果数据中的对话对于用户来说难以重现或很耗时，这一点尤其重要，如果用户可以在几秒钟内重新完成他们的工作，那么这一点就不那么重要了。

不过，要回答您的具体问题，我建议您选择 (2)，您可以在其中克隆对象。将原始数据与新数据进行比较是了解“数据是否已更改？”的最可靠方法。如果您使用脏位概念，请确保您处理用户更改值然后将其更改回来的情况。但通常要做到这一点，无论如何您都必须保留原始版本的副本，以便您返回保留原始对象的副本。有了原始对象的副本，比较两个对象可能比管理跟踪脏位更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T19:52:49.723

就我个人而言，我会选择选项 2。创建克隆的“原始值”对象的成本将是最低的，除非您有大量字段，或者除非某些字段包含大型数据对象（大型文本块、图像、 ETC。）。

一个关键的好处是，当用户更改值然后将其更改回来时，您不会得到“误报”。

此外，这将允许您实现重置功能，以便用户可以放弃所有更改，而无需取消并重新启动。

如果您不想维护完整的“克隆”，请考虑只为更改的字段保存旧值。如果用户改回一个，请将其从您的 OldValues 结构中删除。如果您有很多字段，这将使您的重置更快，因为您只需恢复 OldValues 中存在的字段。

# c# - What should I know about C# before walking into an interview for a .NET job?

> ID：602467
> 
> 赞同：4
> 
> 时间：2009-03-02T14:14:15.037
> 
> 标签：c#

Sure, we all have written tons of C# code. So walking into an interview for a .NET job should be a no-brainer, right? And then you read some stackoverflow posts and it hits you: You don't know squat!

Remember that site with the cram sessions to go through, before taking an exam? I think stackoverflow could be used to make a sorted (voting) list of topics to know about.

Please only put **one topic per post**. Please also add some information about the topic. Links, reference material etc.

**EDIT**: I guess some of you misunderstood the reason for the post - I'm hoping to generate a list of stuff to know about .NET, a sort of cram session that can be reviewed by everyone on the planet to regularly review. This should help us all remember arcane stuff we never really use.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T14:18:21.003

他们可能会问你更多基于面向对象设计和编程的问题，而不是明确针对 C# 的问题。所以如果你能解释抽象、多态、接口等。你应该很高兴。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T14:18:49.627

引用与值类型。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T14:40:19.763

了解您的代表。**我参加的每一次**.Net 采访都向我询问了有关代表的问题。知道它们为什么存在，知道如何声明它们，以及如何使用它们，了解多播委托是什么。了解当其中一个处理程序引发异常时如何使用多播委托。了解编译器对委托的作用。了解委托如何为您提供“自动”异步 API。熟悉更新更方便的泛型委托 - Action 和 Func。

奖励：代表与事件。有什么区别？您什么时候会使用其中一种？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T14:19:04.887

我不明白这个问题对您的情况有何价值。这个问题的结果将是 30 篇文章，列出 C# 语言的特性。

我认为您需要通过提示我们您申请的工作类型来完善您的问题。或者你的技能水平或者你熟悉的领域。否则这篇文章将不会真正包含有价值的答案。

**编辑**

[OP] 这（30 篇文章列出了 C# 语言的特性）正是我所追求的

然后我建议 C# 语言规范。 [http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T14:23:33.470

泛型。（另外——不要试图在某事上死记硬背，假装自己是专家。一个好的面试官会非常非常快地弄清楚这一点。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-02T14:34:59.777

ScottHa 有两个很棒的面试问题清单：

*   [ASP.NET 面试问题](http://www.hanselman.com/blog/ASPNETInterviewQuestions.aspx)
*   [伟大的 .NET 开发人员应该知道什么](http://www.hanselman.com/blog/WhatGreatNETDevelopersOughtToKnowMoreNETInterviewQuestions.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-02T14:24:52.890

**泛型**，为什么首选泛型列表而不是数组列表或哈希表。**顺便添加了性能问题**和**强类型**。

奖励：通用非集合类型的好处。为什么要使用这些？如何？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T14:26:14.477

**反思**。以及反射中自定义属性的力量。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-02T14:30:23.640

**堆栈**与**堆**：什么去哪里，什么导致了**StackOverflowException**以及什么导致了**OutOfMemoryException**。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T14:25:01.627

我希望工作面试是关于编码本身。c# 只是一种编程语法。请务必阅读一些特定的 C# 内容，例如引用与值类型

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-05T14:32:45.067

如果您一直在一个学科（在本例中为 .NET）编写代码，那么您应该对您不知道的技术问题有一个非常标准的答案：

问：那么，你对 [technobabble] 了解多少？

A：嗯，我在以前的项目中没有使用过这个特定的方面，但是，我有一辆小型大众汽车，里面装满了在线资源，我会检查类似的答案。换句话说，如果我不知道它，我知道我可以从哪里了解它。

可选附录：“这是我做的一个例子，当我有一个需要 [technobabble-2] 的项目时......”

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-02T15:07:51.787

我将从查看最新的 c# 增强功能开始。此外，这实际上取决于它是什么类型的工作，因为 ASP.Net 开发人员对于 Winforms 有很多事情是不知道的，反之亦然。

假设使用 asp.net，在过去 18 个月的采访中，我被问到以下问题：

*   页面生命周期
*   泛型
*   接口/基本面向对象设计
*   SQL; 例如连接、更新、插入等。另外，如何使用 DataReader 和 sqlcommand。
*   LINQ 语法；不是因为有人真的在使用它，而是因为他们读到了它。
*   Web 服务（asmx 和 wcf）
*   基本的html/css
*   单服务器/负载均衡的会话策略
*   gridview、repeater等的区别

我发现大多数.net“web”开发人员对sql或html一无所知。如果您能证明您不仅仅知道如何在 Web 表单上“拖放”控件，那么您已经比 90% 的人要好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-02T14:18:34.043

你知道，如果你刚刚通过[ECMA-334 规范](http://www.ecma-international.org/publications/standards/Ecma-334.htm)，你应该已经准备好了。这就是语言......但是在外面，你仍然会受到你对框架的了解和经验的限制。来之不易的经验。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-13T10:55:44.257

*   OOPS 概念
*   网络
*   会话管理和缓存
*   SQL Server 分布式事务管理
*   .NET 2.0 中的新功能

# virtual-machine - MAMP/LAMP 原生还是虚拟（Virtualbox/VMware）？

> ID：602488
> 
> 赞同：5
> 
> 时间：2009-03-02T14:18:56.227
> 
> 标签：virtual-machine, virtualbox, lamp

您首选的开发环境是什么？

**本国的**

*   Windows/MacOS/Linux 上的 WAMP/MAMP/LAMP（Apache、MySQL、PHP）
*   本地工作副本，服务器上的 SVN/CVS
*   同一系统上的 IDE/Editor（Eclipse、Aptana、Zend...）

**虚拟/本机（VM 上的服务器）**

*   VirtualBox/VMware 上的 LAMP
*   虚拟机中的工作副本
*   主机上的 IDE/Editor，使用 Samba、FTP、SFTP 访问 VM（最终使用 WebDrive 等工具进行映射）

**虚拟 (VM)**

*   在 VM 中运行的完整开发环境（服务器、工具、IDE）
*   主机仅用于在 VM 中运行的操作系统上不可用的特殊工具

都有优点和缺点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T21:58:20.877

使用[BitNami](http://bitnami.org)堆栈，您可以在本地或远程运行完全相同的 XAMP 环境（并确保团队中的每个人都在运行完全相同的堆栈）。它是免费的，可在 Windows、Linux、Mac 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-24T17:00:46.370

我喜欢在 Web 服务器的某个地方拥有 SVN 存储库。

它相当安全（使用 Apache WebDAV），它让我有很好的机会从可能发生在我的主要开发机器上的任何灾难中快速恢复。我可以控制自己的网络服务器，但是有很多便宜的主机可以以低成本完成这项工作。

关于 VM 或没有 VM：

VM 的优势 - 从搞砸开发环境中快速恢复 能够快速尝试不同的版本或升级 如果您有许多系统运行 VM 主机，则能够快速移动整个环境 可以选择任何主机

VM的缺点——性能影响；额外的设置复杂性。

总的来说，如果我的主机系统上所有工具都可用，我会选择“无 VM”，但是当我需要运行不同的操作系统时我会使用 VM（主机系统是 Mac Pro，所以如果我需要 Visual Studio，我用 Parallels 来做）。

# visual-studio-2008 - Visual Studio 2008 不会即时检测错误

> ID：602493
> 
> 赞同：0
> 
> 时间：2009-03-02T14:20:33.430
> 
> 标签：visual-studio-2008, intellisense

我在工作中的 Visual Studio 没有即时检测错误……我只是在构建解决方案时看到错误。

有谁知道我该如何配置这个？Intellisense 工作得很好，但这种即时错误检测却不行。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T14:26:28.767

我认为您需要 Service Pack 1，但即便如此，是否检测到错误也取决于错误的类型：语法错误可以被拾取，但是（例如）没有实现接口的类需要重建。

# c# - ThreadAbortException 与 C# 中的优雅事件句柄退出

> ID：602494
> 
> 赞同：2
> 
> 时间：2009-03-02T14:20:42.290
> 
> 标签：c#, multithreading, exception, exception-handling

当中止线程的执行时，我总是怀疑优雅退出与事件处理程序之间的关系，如下所示：

```
int result = WaitHandle.WaitAny(handles);
if (result = WAIT_FINALIZE)
  FinalizeAndExit(); 
```

并使用事件来通知它必须终止的线程

或者只是处理 ThreadAbortException 来完成线程......

```
try
{
  // Main execution
}
catch(ThreadAbortException e)
{
  // FinalizeAndExit();
}
finally
{
} 
```

我通常倾向于使用 ThreadAbortException 方法，因为它可以被处理，但它会在 catch 块的末尾重新引发，并且它还避免了线程被“背叛”的方法保持活动状态，但我见过两种方法。

你怎么看？在任何情况下最好使用一个，还是最好总是使用接近 x？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T14:52:14.400

一般来说，第一种方法比较好。

编写始终优雅地处理 ThreadAbortException 的代码很难（如果不是不可能的话）。异常可能发生在线程正在执行的任何操作的中间，因此某些情况可能难以处理。

例如，在您创建 FileStream 对象之后，但在将引用分配给变量之前，可能会发生异常。这意味着您有一个应该被释放的对象，但是对它的唯一引用丢失在某个地方的堆栈中......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T14:44:10.440

如果可以的话，我会尽量避免使用 Thread.Abort。Thread.Abort 的问题在于它可能发生在（几乎）执行代码的任何行中，并且可能导致一些“有趣”的行为（阅读：错误）。Intead 我更喜欢在我的代码上设置一个退出点来检查事件或变量，以查看线程是否应该停止运行并正常退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T14:57:28.537

当然，如果终止事件是预期的，那么它不是例外（根据术语的严格定义），因此您应该使用第一种方法。优雅的退出也表明你在控制之中。

虽然异常很有用，并且在某些情况下是必要的，但它们可以而且确实会被过度使用。

# c# - 如何通过将树视图中的节点绑定到 XML 文档的节点来显示树节点

> ID：602495
> 
> 赞同：0
> 
> 时间：2009-03-02T14:20:43.197
> 
> 标签：c#, treeview, events, xmlnode

我有一个 Treeview，在选择节点时，属性和值必须显示在列表框中。
在treeView1_AfterSelect中，文本解析代码依赖于树视图中某个节点的文本表示，可以随时更改，打破了列表显示的整个逻辑。树视图和列表显示之间的这种强依赖关系应该通过将树视图中的节点绑定到 XML 文档的节点来消除，以便可以使用原始 Xml 数据在列表中显示文本。我应该在这里写什么？

```
private static void AddingNodesToTree(XmlNode xmlNode,TreeNode tnode)  
        {  
            //Adding nodes to tree while looping through the entire XML file  
            if (xmlNode.HasChildNodes)  
            {  
                XmlNodeList nodeList = xmlNode.ChildNodes;                 
                for (int i = 0; i <= nodeList.Count - 1; i++)  
                {  
                    XmlNode xmladdtreeNode = xmlNode.ChildNodes[i];  
                    String nodetype = "" + xmladdtreeNode.NodeType;  
                    if (nodetype.Equals("Text") || nodetype.Equals("Comment"))    
                    {  
                    tnode.Nodes.Add(new TreeNode(xmladdtreeNode.InnerText));           
                    }  
                    else                                                    
                    {  
                        String name = "<" + xmladdtreeNode.Name;  
                        XmlAttributeCollection attCol = xmladdtreeNode.Attributes; 
                        foreach (XmlAttribute xmlatt in attCol)  
                        {  
                        name += " " + xmlatt.Name + "=\"" + xmlatt.Value + "\"";  
                        }  
                        name +=  ">";  
                        TreeNode tn = new TreeNode(xmladdtreeNode.Name);  
                        tn.Text = name;  
                        tnode.Nodes.Add(tn);  
                        TreeNode treeNode = tnode.Nodes[i];  
                        AddingNodesToTree(xmladdtreeNode,treeNode);   
                        }  
                }//for  
            }//if  
          else 
            {  
                tnode.Text = xmlNode.OuterXml.Trim();
            }//else   
        }//AddingNodesToTree  
        //To show Attributes and values of selected Nodes.  
        private void treeView1_AfterSelect(object sender,TreeViewEventArgs e)  
        {  
            TreeNode treenode = e.Node;   //Node selected in Treeview            
            String text = treenode.Text;  
            String relevent = text;  
            Boolean flag = true;  
            while (flag)  
            {  
                int SpaceIndex = relevent.IndexOf(" ");  
                if (SpaceIndex != -1)  
                {  
                    int indexofEqual = relevent.IndexOf('=', SpaceIndex);  
                    if (indexofEqual != -1)  
                    {  
                        int indexOFValue = relevent.IndexOf("\"", indexofEqual + 2);  
                        if (indexOFValue != -1)  
                        {  
  String attribute = relevent.Substring(SpaceIndex + 1, indexofEqual - SpaceIndex - 1);   
  String value = relevent.Substring(indexofEqual + 2, indexOFValue - indexofEqual - 2);   
  listBox1.Items.Add("Attribute : " + attribute + "   Value : " + value);                 
                            relevent = relevent.Substring(indexOFValue);
                        }
                        else
                        {
                         listBox1.Items.Add("Bad format of the xml file for this node");
                         flag = false;
                        }
                    }
                    else
                    {
                        flag = false;
                    }
                }
                else
                {
                    flag = false;
                }
            }
        }//AfterSelect() 
```

谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T21:13:30.333

如果我正确理解了这个问题，您希望在选择 TreeNode 时返回 XmlNode。通常的解决方案是将 XmlNode 存储在 Tag 属性中：

```
TreeNode tn = new TreeNode();  
tn.Text = name;  
tn.Tag = xmladdtreeNode; 
```

并在 AfterSelect

```
TreeNode treenode = e.Node; 
XmlNode xmlNode = (XmlNode) treeNode.Tag; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T13:34:54.997

我尝试了这个，但在 attcol 上的这一行 **foreach (XmlAttribute xmlatt in attCol)**得到 了 NullRefrenceException

这是我写的代码..

```
private void treeView1_AfterSelect(object sender, System.Windows.Forms.TreeViewEventArgs e)
    {
        listBox1.Items.Clear();
        XmlNode xNode = e.Node.Tag as XmlNode;
        XmlAttributeCollection attCol = xNode.Attributes; 
        foreach (XmlAttribute xmlatt in attCol)
        {
            listBox1.Items.Add(xmlatt.Name);
            listBox1.Items.Add(xmlatt.Value);

        }
    } //AfterSelect() 
```

# java - Maven：如何使用部署文件和自定义货车进行部署

> ID：602511
> 
> 赞同：9
> 
> 时间：2009-03-02T14:24:20.037
> 
> 标签：java, maven-2, maven-scm

我正在尝试使用自定义 maven wagon 扩展将 jar 部署到我自己的存储库。我可以在 settings.xml 中以某种方式配置它识别要与特定 wagon 一起使用的自定义 url 方案，还是我必须始终修改 pom 文件以包含 wagon 扩展名？

* * *

使用部署文件时不需要基础 pom 或任何可用的 pom。Settings.xml 是唯一保证存在的地方，但我不知道如何使用它来定义扩展。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T10:33:15.113

好的，好的，更正一下：您不能在定义的 in 中定义`<build>`元素。您可以在 中激活配置文件，但在您的.`<profile>``settings.xml``settings.xml``base-pom`

对不起，我能想到的唯一其他方法（可能是你在找什么），就是将扩展 jar 直接复制到`$M2_HOME/lib`. 所有`$M2_HOME/lib/*.jar`都放在类路径中，所以这实际上必须与`<extension>`.

然而，扩展更好，因为您可以更轻松地控制使用哪个版本的扩展（例如通过 base-pom）。

好的，只需尝试将扩展 jar 复制到

```
 $M2_HOME/lib 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-12T23:51:58.610

我不知道[Brian Fox 上面的评论](https://stackoverflow.com/questions/602511/maven-how-to-deploy-with-deploy-file-and-custom-wagon#comment650287_619123)在 2013 年是否仍然有效。但最后我不得不在我尝试上传工件的目录中创建一个最小的 pom.xml 以启用 wagon 构建扩展。

我必须将 groupId、artifactId 和 version 添加到 pom.xml 以便 Maven 不会抱怨，尽管我在命令行上将它们提供给 deploy-file 目标（我猜 deploy-file 只会关心命令行参数）：

```
<project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"><modelVersion>4.0.0</modelVersion>
<groupId>your-groupId</groupId>
<artifactId>your-artifactId</artifactId>
<version>your-version</version>
<build>
  <extensions>
    <extension>
      <groupId>org.apache.maven.wagon</groupId>
      <artifactId>wagon-ssh</artifactId>
      <version>2.4</version>
    </extension>
  </extensions>
</build>
</project> 
```

有了这个简单的“pom.xml”，我最终可以使用 scp 作为协议来执行部署文件：

```
mvn deploy:deploy-file -Durl=scp://shell.sourceforge.net:/home/project-web/... -DrepositoryId=repoId -Dfile=my-file.jar -DgroupId=your-groupId -DartifactId=your-artifactId -Dversion=your-version -Dpackaging=jar 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T14:52:03.820

您需要[将 wagon 扩展添加到您的顶级 pom.xml](http://maven.apache.org/wagon/wagon-providers/wagon-scm/usage.html)。大多数环境在所有项目的顶部都有一个企业环境（最佳实践），所以这对于个人开发人员来说通常不会太痛苦——他们只是从企业 pom.xml 继承。

```
<build>
  <extensions>
    <extension>
      <groupId>org.apache.maven.wagon</groupId>
      <artifactId>wagon-scm</artifactId>
      <version>1.0-alpha-7-SNAPSHOT</version>
    </extension>
    <extension>
      <groupId>org.apache.maven.scm</groupId>
      <artifactId>maven-scm-manager-plexus</artifactId>
      <version>1.0-beta-3-SNAPSHOT</version>
    </extension>
    <extension>
      <groupId>org.apache.maven.scm</groupId>
      <artifactId>maven-scm-provider-svnexe</artifactId>
      <version>1.0-beta-3-SNAPSHOT</version>
    </extension>
  </extensions>
</build>
<distributionManagement>
  <site>
    <id>my.svn.server</id>
    <url>scm:svn:https://username@svn.apache.org/svn/root/module</url>
  </site>
</distributionManagement> 
```

当您注册您的提供者时，我相信它也会注册协议模式。您可以[在此处查看现有提供商的完整列表](http://maven.apache.org/scm/maven-scm-providers/dependency-convergence.html)。

我相信注册扩展的是 getScmType() 方法，但我不是 100% 确定的。

```
/** {@inheritDoc} */
public String getScmType()
{
    return "git";
} 
```

[可以在此处找到 Git 提供程序源的链接。](https://svn.apache.org/repos/asf/maven/scm/tags/maven-scm-1.1/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-git-commons/src/main/java/org/apache/maven/scm/provider/git/AbstractGitScmProvider.java)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T19:14:22.707

siddhadev 是对的，但还有一些额外的东西......（我会把它放在评论中，但我没有足够的声誉）

您可以通过将它们放在以下位置来保持 JAR 干净地分开： $M2_HOME/lib/ext

您需要所有依赖项，因此请执行以下操作：

1.  cd ~/.m2/repository/org/apache/maven/wagon/wagon-ssh-external/2.2
2.  cp wagon-ssh-external-2.2.jar $M2_HOME/lib/ext
3.  cp wagon-ssh-external-2.2.pom pom.xml
4.  mvn 依赖：复制依赖 -DoutputDirectory=$M2_HOME/lib/ext

# .net - WPF - 如何结合 DataTrigger 和 Trigger？

> ID：602517
> 
> 赞同：55
> 
> 时间：2009-03-02T14:25:47.660
> 
> 标签：.net, wpf, triggers, selection, listboxitem

> **注意**我已经问过相关问题：[如何结合 DataTrigger 和 EventTrigger？](https://stackoverflow.com/questions/1679391/wpf-how-to-combine-datatrigger-and-eventtrigger)

我有一个包含几个项目的列表框。该项目的类实现`INotifyPropertyChanged`并具有一个属性`IsAvailable`。我使用该属性以使用不同的颜色指示列表中不可用的选项。

但是，如果所选项目不可用，则前景色应为红色。

```
<ListBox>
  <ListBox.Resources>
    <DataTemplate DataType="{x:Type local:InstitutionViewModel}">
      <TextBlock Name="Name" Text="{Binding Name}"/>
      <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding IsAvailable}" Value="False">
          <Setter TargetName="Name" Property="Foreground" Value="#888"/>
        </DataTrigger>
      </DataTemplate.Triggers>
    </DataTemplate>
  </ListBox.Resources>
</ListBox> 
```

我使用上述数据触发器将不可用的项目变灰。

我面临的问题是，选择该项目的事实与模板绑定到的基础数据无关。我真正想要的是某种多触发器，它支持`Trigger`依赖属性 ( `ListBoxItem.IsSelected`)上的常规以及`DataTrigger`绑定数据项上的 a。

这可以在不将选择概念引入我的视图模型的情况下完成吗？

*对于任何想知道我为什么不禁用不可用项目的人，请了解应用程序要求可以选择不可用选项。实际上有几个列表框，其中一个选择会影响其他列表框的可用内容。我无法禁用这些项目，因为如果项目基于之前的选择被禁用，用户将无法改变主意或探索不同的组合。*

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-03-02T15:05:09.127

对于遇到此问题的其他人，我找到了适合我的解决方案。当然，我仍然有兴趣看到其他有趣的答案。

这是我所做的：

```
<MultiDataTrigger>
  <MultiDataTrigger.Conditions>
    <Condition Binding="{Binding
      RelativeSource={
        RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBoxItem}},
        Path=IsSelected}" Value="True"/>
    <Condition Binding="{Binding IsAvailable}" Value="False"/>
  </MultiDataTrigger.Conditions>
  <Setter TargetName="Name" Property="Foreground" Value="#F00"/>
</MultiDataTrigger> 
```

不过，这是一个多触发器并没有什么特别之处。如果您只是想在数据模板中以不同的方式设置所选项目的样式，您可以使用：

```
<DataTrigger Binding="{Binding 
  RelativeSource={
    RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBoxItem}},
    Path=IsSelected}" Value="True">
  <Setter TargetName="Name" Property="Foreground" Value="#888"/>
</DataTrigger> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-12-01T04:33:40.087

要将其与`DataGridRow`更改绑定模式一起使用`Self`：

```
Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-16T12:15:53.773

对于 DevExpress GridControl，有一个组合字段值格式条件和行 IsFocused 属性的[示例。](https://docs.devexpress.com/WPF/116513/controls-and-libraries/data-grid/conditional-formatting/conditional-formats/formatting-focused-cells-and-rows)

XAML：

```
<dxg:GridControl.View>
    <dxg:TableView CustomRowAppearance="CustomRowAppearance" NavigationStyle="Row"> 
        <dxg:TableView.FormatConditions> 
            <dxg:DataBarFormatCondition FieldName="Profit" PredefinedFormatName="GreenGradientDataBar" /> 
            <dxg:FormatCondition FieldName="Profit" Expression="[Profit]&lt;0" PredefinedFormatName="RedText"/> 
            <dxg:FormatCondition FieldName="Profit" Expression="[Profit]&gt;=0" PredefinedFormatName="GreenText"/> 
            <dxg:FormatCondition FieldName="Profit" Expression="[Profit]&lt;=0" PredefinedFormatName="LightRedFillWithDarkRedText" ApplyToRow="True"/> 
        </dxg:TableView.FormatConditions> 
    </dxg:TableView>
</dxg:GridControl.View> 
```

C＃：

```
void CustomRowAppearance(object sender, CustomRowAppearanceEventArgs e) {
    if (e.RowSelectionState != SelectionState.None) {
        object result = e.ConditionalValue;
        if (e.Property == TextBlock.ForegroundProperty || e.Property == TextBlock.BackgroundProperty) {
            SolidColorBrush original = e.OriginalValue as SolidColorBrush;
            SolidColorBrush conditional = e.ConditionalValue as SolidColorBrush;
            if (conditional != null && (original == null || original.Color != conditional.Color))
                result = ShadeBrush(conditional);
        }
        e.Result = result;
        e.Handled = true;
    }
}

SolidColorBrush ShadeBrush(SolidColorBrush brush) {
    Color originalColor = brush.Color;
    float coefficient = 0.75f;
    byte a = originalColor.A;
    if (!grid.IsKeyboardFocusWithin) // I commented this line in WPF
        a = (byte)(originalColor.A / 2);
    byte r = (byte)(originalColor.R * coefficient);
    byte g = (byte)(originalColor.G * coefficient);
    byte b = (byte)(originalColor.B * coefficient);
    return new SolidColorBrush(Color.FromArgb(a, r, g, b));
} 
```

# java - 在 NetBeans 中生成可执行 jar

> ID：602537
> 
> 赞同：19
> 
> 时间：2009-03-02T14:34:02.260
> 
> 标签：java, netbeans, jar, executable, manifest

我使用的是 NetBeans 6.5，由于某种原因，它不会“开箱即用”生成可执行 jar。

我将我的项目设置为主项目，在项目属性“运行”菜单中定义了主类，当我按 F6 运行它时它可以完美运行。

我查看了清单文件，它确实没有在那里定义主类，也省略了库依赖项。

**我错过了什么吗？有没有办法（除了手动更改清单文件）来生成可执行的 jar 文件？**

编辑：是的，我尝试清理和重建，它在 dist 文件夹中生成了 jar，仍然具有相同的 manifest.mf

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.7.1
Created-By: 10.0-b23 (Sun Microsystems Inc.) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:48:05.370

我刚刚在 NetBeans 7.2.1 中遇到了与 Maven Java 应用程序项目相同的问题。修改 pom.xml 文件以包含[maven 程序集插件](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html "Maven 程序集插件使用")，并对 myrho 的答案进行一次调整（需要引用预定义的描述符“jar-with-dependencies”）：

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.4</version>
    <configuration>
        <descriptorRefs>
            <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
        <archive>
            <manifest>
                <mainClass>your.app.MainClass</mainClass>
            </manifest>
        </archive>
    </configuration>
    <executions>
        <execution>
            <id>make-assembly</id>
            <phase>package</phase>
            <goals>
                <goal>single</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

另一种方法是在不使用 Maven 的 NetBeans 中构建 Java 应用程序项目。选择 File -> Project Properties -> Build -> Packaging 并选中“Copy Dependent Libraries”复选框。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-13T12:46:49.403

尝试这个：

1.  在“项目”面板上右键单击您的项目，选择“属性”

2.  在新窗口中单击“运行”。

3.  编辑“主类：”字段（单击浏览）。

这样，您将选择作为应用程序入口点的主类，并且将正确创建清单。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-14T17:36:30.233

如果您正在使用 maven 程序集插件并希望构建一个带有依赖项的可执行 jar，则需要将此部分添加到 pom.xml 中 maven-assembly-plugin 部分的配置中：

```
<plugin>
  <artifactId>maven-assembly-plugin</artifactId>
  <configuration>
    <!-- ... -->
    <archive>
      <manifest>
        <mainClass>your.app.SampleClass</mainClass>
      </manifest>
    </archive>
  </configuration>
</plugin> 
```

来源： [Maven 程序集插件使用](https://maven.apache.org/plugins/maven-assembly-plugin/usage.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-18T10:22:42.093

很简单，.jar 和 .jad 文件在`dist`文件夹中

我也在寻找答案，并从[http://forums.netbeans.org/ptopic3465.html得到这个答案](http://forums.netbeans.org/ptopic3465.html)

解决了 ：）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T14:38:04.450

你清理项目并重建了吗？听起来你做得对。以下是一些参考资料，以防万一：

[http://www.velocityreviews.com/forums/t141385-how-to-create-executable-jar-in-netbeans-ide.html](http://www.velocityreviews.com/forums/t141385-how-to-create-executable-jar-in-netbeans-ide.html) [http://dr.berkeley.edu/REM/wiki/index.php/Making_a_Java_executable_jar_in_Netbeans](http://dr.berkeley.edu/REM/wiki/index.php/Making_a_Java_executable_jar_in_Netbeans)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-21T22:46:24.180

也许您*使用现有源*而不是*Java 应用程序*创建了 Java 项目？

我有类似的问题，创建新的 Java 应用程序，然后手动复制 src 文件解决了这个问题——一切都“开箱即用”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T14:39:43.830

如果你清理并构建你的项目，它应该在“dist”目录中创建 jar。

它应该在项目目录的顶层创建 manifest.mf。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-23T21:09:46.347

在遇到同样的问题后，我实际上遇到了这个页面，我编辑了 manifest.mf 文件，但更改没有显示在 jar MANIFEST.MF 文件中。我发现了我遇到的问题，并认为我会传递信息以防万一。

我做错的是我没有将我正在处理的项目设置为主项目，所以当我编辑正确的清单时，我正在编译错误的项目。

所以我想你有没有检查一下你是否为你正在编辑的 manifest.mf 文件选择了正确的项目？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T17:21:14.530

转到文件视图。在根目录中创建 manifest.mf。

```
/project_folder
    build.xml
    manifest.mf(edit here)
    /dist
    /src
    /test
    /build 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T18:09:49.057

确实很奇怪，它应该开箱即用，包括类路径。

你是从以前的版本升级的吗？升级的时候，NB会升级工程文件，但是有时候这个迁移没有做好，会出现这种情况。只需关闭项目，将 nbproject 目录重命名为 nbproject_old 并使用现有源执行新项目 -> Java 项目。再次设置主类并添加依赖项并重试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-05T15:52:32.810

另一种方法完全是在 NetBeans 中开发、运行单元测试等，然后使用 maven 或 ant 脚本进行“真正的”构建。似乎这些类型的构建工具可以让您更好地控制事物的构建方式，并且还可以让您自动化构建。

对于 maven，您可以使用 maven jar 插件轻松地将条目添加到清单中：

[http://maven.apache.org/plugins/maven-jar-plugin/](http://maven.apache.org/plugins/maven-jar-plugin/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-04-15T20:54:32.853

使用 NetBeans IDE 8.0.2手动强制创建**包**...

1.  在 Project navigator 中，展开您的 < *project* > 并右键单击 Project Files / pom.xml
2.  单击运行 Maven / 目标
3.  在目标字段中键入“包”
4.  点击确定

然后输出窗口将显示（在 Mac 上）...

```
Building jar: /Users/<username>/NetBeansProjects/<project>/target/<project>-1.0-SNAPSHOT.jar 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-29T09:58:18.443

我有经验，构建过程会有所不同，具体取决于项目类型。

我想，您已经创建了“Java 类库”项目。

所以只需创建一个“Java Application”项目，然后将所有类合并到它。

然后，Netbeans**不会覆盖，而是增强**到`"manifest.mf"`JAR 中。

*当然，这是一个愚蠢的 Netbeans 错误。当然，之后应该可以添加主类。*

**编辑：**请参阅我的其他答案。这更容易。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-29T10:01:36.990

更好的解决方案：

编辑 nbproject/project.properties 并**添加条目**：

```
manifest.file=manifest.mf 
```

`manifest.mf`应该在项目的根目录中并且只包含：

```
Manifest-Version: 1.0
X-COMMENT: Main-Class will be added automatically by build 
```

作品。经测试。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-22T14:57:07.390

有趣的信息可能在这里：

[http://wiki.netbeans.org/FaqNoMainClass](http://wiki.netbeans.org/FaqNoMainClass)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-04-20T01:37:16.263

在 7.3 中，只需启用 Properties/Build/Package/Copy Dependent Libraries 和主类（取决于所选目标）将在构建时添加到清单中。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-07-16T02:18:40.313

好的，你可以执行以下步骤： 1\. 右键单击**​​项目名称**选择项目**Set Configuration**并选择**Customize**
2\. 选择**Run**并注意**Main Class**
3.如果要运行，请选择**Browse并设置类。**点击确定后。
4\. 完成。

# php - 阻止人们通过表单上传恶意 PHP 文件

> ID：602539
> 
> 赞同：29
> 
> 时间：2009-03-02T14:34:15.690
> 
> 标签：php, security, upload, zip

我在我的网站上用 php 创建了一个上传表单，人们可以上传一个 zip 文件。然后提取 zip 文件并将所有文件位置添加到数据库中。上传表格仅供人们上传图片，显然，文件位于 zip 文件夹中，在文件被提取之前我无法检查正在上传的文件。我需要一段代码来删除所有不是图像格式的文件（.png、.jpeg 等）。我真的很担心人们能够上传恶意的php文件，安全风险很大！我还需要注意人们更改 php 文件的扩展名以试图绕过此安全功能。

这是我使用的原始脚本[http://net.tutsplus.com/videos/screencasts/how-to-open-zip-files-with-php/](http://net.tutsplus.com/videos/screencasts/how-to-open-zip-files-with-php/)

这是实际提取 .zip 文件的代码：

```
function openZip($file_to_open) {
    global $target;

    $zip = new ZipArchive();
    $x = $zip->open($file_to_open);
    if($x === true) {
        $zip->extractTo($target);
        $zip->close();

        unlink($file_to_open);
    } else {
        die("There was a problem. Please try again!");
    }
} 
```

谢谢，本。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-02T16:09:11.470

> 我真的很担心人们能够上传恶意的php文件，安全风险很大！

冰山一角！

> 我还需要注意人们更改 php 文件的扩展名以试图绕过此安全功能。

通常更改扩展名将阻止 PHP 将这些文件解释为脚本。但这不是唯一的问题。除了 '...php' 之外，还有更多的东西会损坏服务器端；'.htaccess' 和设置了 X 位的文件是显而易见的，但绝不是您需要担心的全部。即使忽略服务器端的东西，也存在一个巨大的客户端问题。

例如，如果有人可以上传一个 '.html' 文件，他们可以在其中包含一个 <script> 标签来劫持第三方用户的会话，并删除他们所有上传的文件或更改他们的密码或其他东西。这是典型的跨站点脚本 (XSS) 攻击。

另外，由于某些浏览器（主要是 IE）的“内容嗅探”行为，以“.gif”形式上传的文件实际上可能包含诸如此类的恶意 HTML。如果 IE 在文件开头附近看到类似（但不限于）“<html>”之类的信息，它可以忽略提供的“Content-Type”并显示为 HTML，从而导致 XSS。

此外，可以制作一个文件，该文件*既是*您的图像解析器将接受的有效图像，*又*包含嵌入的 HTML。根据用户浏览器的确切版本和图像文件的确切格式（尤其是 JPEG 具有一组非常可变的可能标题格式），可能会出现各种结果。IE8 中有一些[缓解措施](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)，但现在没有用，你不得不想知道为什么他们不能简单地**停止进行内容嗅探，你们这些白痴 MS，**而不是给我们负担本应具有的 HTTP 标头的不合格的非标准扩展刚开始工作。

我又陷入了咆哮。我会停下来。安全地提供用户提供的图像的策略：

1：永远不要使用取自用户输入的文件名将文件存储在服务器的文件系统上。这可以防止错误和攻击：不同的文件系统对于文件名中允许哪些字符有不同的规则，而且“清理”文件名比您想象的要困难得多。

即使你使用了一些非常严格的东西，比如“只有 ASCII 字母”，你仍然需要担心太长、太短和保留的名称：尝试将一个像“com.txt”这样无害的名称保存在Windows 服务器并观察您的应用程序出现故障。认为您知道您的应用程序可能在其上运行的每个文件系统的路径名的所有奇怪缺点吗？自信的？

相反，将文件详细信息（例如名称和媒体类型）存储在数据库中，并使用主键作为文件存储中的名称（例如“74293.dat”）。然后，您需要一种方法来为它们提供不同的明显文件名，例如将文件吐出的下载器脚本、执行 Web 服务器内部重定向的下载器脚本或 URL 重写。

2：使用 ZipArchive 时要非常非常小心。extractTo 中存在相同类型的遍历[漏洞](http://www.sektioneins.de/advisories/SE-2008-06.txt)，这些漏洞影响了大多数基于路径的 ZIP 提取器。此外，您还可以接受[ZIP 炸弹](http://en.wikipedia.org/wiki/Zip_bomb)的攻击。最好通过逐步检查存档中的每个文件条目（例如，使用[zip_read/zip_entry_*](http://de.php.net/manual/en/function.zip-read.php)）并检查其详细信息，然后手动将其流解压缩到具有已知良好名称和模式标志的文件，从而避免任何错误文件名的危险，您在没有存档帮助的情况下生成。忽略 ZIP 中的文件夹路径。

3：如果您可以加载图像文件并*再次将其保存回来*，特别是如果您在两者之间以某种方式处理它（例如调整大小/缩略图或添加水印），您可以合理地确定结果将是干净的。从理论上讲，可以制作一个针对特定图像压缩器的图像，这样当它被压缩时，结果也看起来像 HTML，但这对我来说似乎是一个非常困难的攻击。

4：如果您可以将所有图像作为下载提供（即在下载脚本中使用“Content-Disposition：附件”），那么您可能是安全的。但这对用户来说可能太不方便了。不过，这可以与 (3) 协同工作，提供更小的、已处理的内联图像，并且原始的高质量图像仅可作为下载使用。

5：如果您必须在线提供未更改的图像，您可以通过从不同的域提供它们来消除跨站点脚本风险。例如，对不受信任的图像使用“images.example.com”，对包含所有逻辑的主站点使用“www.example.com”。确保 cookie 仅限于正确的虚拟主机，并且设置了虚拟主机，以便它们除了正确的名称之外无法响应任何内容（另请参阅：DNS 重新绑定攻击）。这就是许多网络邮件服务所做的。

总之，用户提交的媒体内容是一个问题。

总结总结，AAAARRRRRRRGGGGHHH。

ETA 重新评论：

> 在顶部您提到“设置了 X 位的文件”，这是什么意思？

我不能说`ZipArchive.extractTo()`因为我还没有测试过，但是许多提取器，当被要求从档案中转储文件时，将重新创建与每个文件关联的 [一些] Unix 文件模式标志（如果档案是在一个 Unix，所以实际上有模式标志）。如果缺少所有者读取权限，这可能会导致您出现权限问题。但是，如果您的服务器启用了 CGI，这也可能是一个安全问题：X 位可以允许将文件解释为脚本并传递给第一行 hashbang 中列出的任何脚本解释器。

> 我以为 .htaccess 必须在主根目录中，不是这样吗？

取决于 Apache 的设置方式，尤其是 AllowOverride 指令。通用主机在任何目录上允许覆盖是很常见的。

> 如果有人仍然上传像 ../var/www/wr_dir/evil.php 这样的文件会发生什么？

我希望领先的“..”会被丢弃，这就是遭受相同漏洞的其他工具所做的。

但是我仍然不相信`extractTo()`恶意输入，有太多奇怪的小文件名/目录树的东西可能会出错 - 特别是如果你期望在 Windows 服务器上运行。`zip_read()`使您可以更好地控制取消归档过程，从而减少攻击者。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-02T14:46:38.797

首先，您应该禁止每个没有正确图像文件扩展名的文件。之后，您可以使用该[`getimagesize`功能](http://docs.php.net/getimagesize)检查文件是否为常规图像文件。

但此外，您应该知道某些图像格式允许评论和其他元信息。这可用于恶意代码，例如某些浏览器将在某些情况下执行的 JavaScript（请参阅[Internet Explorer 中的风险 MIME 嗅探](http://www.h-online.com/security/Risky-MIME-sniffing-in-Internet-Explorer--/features/112589)）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-02T14:39:49.423

那么，您可能不应该只依赖文件扩展名。尝试通过图像库传递每个文件以验证它是否真的是图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T20:55:20.377

您可能还想考虑使用以下库进行 mime 类型检测：

[http://ca.php.net/manual/en/ref.fileinfo.php](http://ca.php.net/manual/en/ref.fileinfo.php)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T14:40:23.587

我没有看到在您的数据库中重命名 php 文件的风险......只要您不将它们评估为 PHP 文件（或根本不评估它们），它们就不会造成太大的伤害，并且由于没有 .php 扩展名，php 引擎不会触及它们。

我想你也可以搜索文件`<?php`...

**另外**：假设上传到您机器的文件最糟糕。将保存它们的文件夹重命名为“病毒”并相应地对待它。不要公开，不要授予任何文件启动权限（尤其是 php 用户）等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T19:29:13.657

就个人而言，我会在 Apache 配置中添加一些内容，以确保它将 PHP 文件作为文件上传到的位置的文本提供，这样您就安全了，并且可以允许将来上传其他文件类型。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T14:43:40.550

现在您依靠硬盘空间进行提取。您可以检查文件头以确定它们是什么类型的文件。可能有图书馆。

题外话：让用户选择几张图片而不是上传一个 zip 文件不是更好吗？更适合不知道 zip 是什么的人（是的，它们存在）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T14:52:35.727

如果您将 php 设置为仅解析以 .php 结尾的文件，那么您只需将文件从 somename.php 重命名为 somename.php.jpeg 就可以了。

如果你真的想删除文件，php 有一个可用的[zip 库。](http://www.php.net/zip)您可以使用它来检查上传的 zip 存档中所有文件的名称和扩展名，如果它包含 php 文件，则给用户一条错误消息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-31T21:55:34.373

当心**通过 getimagesize() 传递恶意 PHP**

> 通过图像函数注入 PHP，尝试使用 getimagesize() 函数确保图像安全

在这里阅读更多[http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/](http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/)

更适合您的用户徽标使用 gravatar，如 Stackoverflow 使用的此处；）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-12T09:29:36.833

使用 getimagesize 函数。完整程序：- 1.) 提取图像/上传文件的扩展名，然后将扩展名与允许的扩展名进行比较。2.) 现在创建一个用于重命名上传文件的随机字符串。最好的想法是。`md5(session_id().microtime())`它不能被复制，并且如果您的服务器非常快并且可以处理不到一微秒而不是使用增量变量并使用字符串添加它们。现在移动那个文件。

**提示** 在上传目录中禁用 PHP 文件处理，它将始终防止您受到任何服务器端攻击，如果可能的话，将您的 htaccess 添加到根目录或 httpd 配置文件中并从那里禁用 htaccess 文件现在它可以解决您的最大问题

# .net - SQL 选择列表中的值

> ID：602544
> 
> 赞同：12
> 
> 时间：2009-03-02T14:35:47.013
> 
> 标签：.net, sql, ado.net

有没有一种方法可以针对具有指向 ArrayList 或 List 的 where 子句的数据源（可能是 sql、oracle 或 access）创建查询？

例子：

```
Select * from Table where RecordID in (RecordIDList) 
```

我已经看到了一些使用 Linq 的方法，但如果可以避免，我宁愿不使用它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T14:39:11.967

你可以使用`String.Join`. 尝试这样的事情：

```
String query = "select * from table where RecordId in ({0});";
String formatted = String.Format(query, String.Join(",", list.ToArray())); 
```

作为旁注，这不会保护您免受 SQL 注入 - 希望这个示例将为您指明正确的方向。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-02T14:40:43.070

我只做了你试图用逗号分隔的列表做的事情

```
Select * from Table where RecordID in (1,2,34,45,76,34,457,34) 
```

或者结果来自单独的选择

```
Select * from Table where RecordID in (select recordId from otherTable where afieldtype=1) 
```

我很确定你无法实现你所追求的......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-02T14:56:56.433

Linq 到 Sql。RecordList 应该是 a `List<T>`，而不是 an`ArrayList`或 an`IList<T>`

```
IEnumerable<TableRow> query =
  from t in db.Table
  where RecordList.Any(r => t.RecordId == r)
  select t; 
```

这将生成带有参数的 sql：

```
SELECT *
FROM Table
WHERE RecordId in (@p0, @p1, @p2, @p3, @p4) 
```

Linq 将根据需要生成尽可能多的参数。一些数据库实现在可以接受的参数数量方面受到限制。SqlServer2005 的限制是超过 2000 个参数...所以不要使用超过 2000 个元素的列表。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T16:36:33.527

您可以迭代您的数组并为每个数组添加一个参数到您的 SQL 中。这可以帮助您绕过 SQL 注入，但请确保在构建 SQL 语句时使用 StringBuilder 而不是字符串连接。

例如

```
StringBuilder sql = new StrignBuilder("select * from Table where ");
for  (int i = 0; i < RecordIDLis.Length; i++)
{
    if (i > 0) sql.Append (" OR ");
    sql.Append(" RecordID = @param" + i.ToString() + " ");
    IDbDataParameter param = new Param();
    param.value etc.
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T16:33:15.093

您可以编写一个表值用户定义函数，该函数接受一个 ID 列表并创建一个表，然后再次连接该函数的结果。[Erland Sommarskog 的](http://www.sommarskog.se/arrays-in-sql-2000.html)这篇文章描述了如何做到这一点。

或者，您可以使用 SQL Server 2008 中的新表参数（我认为）。

或者，正如 Manu 所说，您可以使用 XML。

但是，我建议不要在接受的答案中使用 IN String.Join 方法，因为它就像要求 SQL 注入一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T14:40:35.410

如果使用动态 SQL，则可以将括号的内容作为文字逗号分隔列表发送。否则，您可以使用 XML 变量发送多个值。请参阅[http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T15:12:30.047

使用 Linq to SQL，我假设实体框架可以执行以下操作：

```
dataContext.Table.Where(t => RecordIDList.Contains(t.RecordID)); 
```

将与 List<> 和 ArrayList 一起使用，因为它们都实现了 IEnumerable。

Linq 和 Lambdas 要求您反转 Contains 方法，但它确实有效并生成 SQL“IN ()”子句。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-12T16:41:01.360

您可以使用以逗号分隔的示例颜色字符串列表来执行此操作：

```
SELECT value
FROM STRING_SPLIT('red,green,blue', ',')
WHERE TRIM(value) <> '' 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-03-02T16:19:44.550

请注意 Linq to SQL = dead，来源：http: [//blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap。 aspx](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)

如果你想实现这样的架构，实体框架是你目前应该使用的。

此外，如果您对“in”子句使用另一个选择查询（如 GordonB 建议），最好使用“exists”而不是“in”，例如：

```
select * from tablename where exists (select id from othertablename where fieldtype=1) 
```

# jquery - jQuery 下拉列表 - CSS 问题

> ID：602553
> 
> 赞同：2
> 
> 时间：2009-03-02T14:38:04.917
> 
> 标签：jquery, css, menu

嘿，如果你去：[http](http://catonthecouchproductions.com/fish/) ://catonthecouchproductions.com/fish/并且下拉列表下的那些图像应该被隐藏然后出现在悬停时，我到目前为止有这个：

```
$(document).ready(function() {
    $('.btn-fishing-trip').hover(function() {
        $('.fishing-trip').slideDown("slow");
    }, function() {
        $('.fishing-trip').slideUp("slow");
    });
    $('.btn-combo').hover(function() {
        $('.combo').slideDown("slow");
    }, function() {
        $('.combo').slideUp("slow");
    });
}); 
```

但它的行为很奇怪。关于我能做什么的任何建议？我认为自从一次上升后，其他幻灯片就取代了它的位置。我应该使用 animate() 而不是 slideDown 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T14:44:15.230

试试这个：

```
$(document).ready(function() {
    $('.btn-fishing-trip').hover(function() {
        $('.fishing-trip').slideDown("slow");
        $('.combo').slideUp("slow");
    });    
    $('.btn-combo').hover(function() {
        $('.combo').slideDown("slow");
        $('.fishing-trip').slideUp("slow");
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T14:44:50.517

还是可以用slideDown、slideUp，真的好用。我认为您的问题出在 .hover 上，请尝试使用 .mouseover，然后将 mouseout 作为回调。因为现在似乎没有正确调用停止滑块的事件，因为它一次又一次地循环。另外，我不明白应该发生的事情，我认为你混淆了一些元素或其他东西。您可以尝试在应该隐藏或显示的项目上添加一个类，然后使用 .hasClass(); 当您想检查他们是否有某个班级时，您可以确定是否应该向上或向下滑动它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T03:44:26.603

首先，没有针对单个项目的课程。您可以使用 id 单独设置它们的样式，并且对于具有相同类的所有对象只有一个悬停功能（而不是复制和粘贴四次）。

其次，这是您应该具有的基本结构：

```
<div class="button" id="btn1">
  <div class="info"><img src="info1"></img></div>
</div>
<div class="button" id="btn2">
  <div class="info"><img src="info2"></img></div>
</div>
... 
```

您不需要将“.info”元素作为按钮的子元素，但它们需要在没有唯一 ID 的情况下可访问（即下一个元素或子元素）。

这使得 javascript 变得简单：

```
$(".button").hover(function() {
  $(this).find(".info").slideDown();
}, function() {
  $(this).find(".info").slideUp();
}); 
```

或者，您可以像这样修改它以使其更好地工作：

```
$(".button").hover(function() {
  $(".info").not(".info", $(this)).slideUp(); // Not sure if valid JQ
  $(this).find(".info").slideDown();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T11:54:35.067

而不是`.slideDown()`并`.slideUp()`尝试分别使用：

```
$(yourElementHere).stop().animate({ top: "20px", opacity: "1" }, 500, "swing"); 
```

和

```
$(yourElementHere).stop().animate({ top: "-180px", opacity: "0" }, 500, "swing"); 
```

# asp.net - SSL 是按机器还是按连接设置的

> ID：602554
> 
> 赞同：1
> 
> 时间：2009-03-02T14:39:00.187
> 
> 标签：asp.net, ssl, ftp

是否可以在不使用 SSL 的应用程序服务器上拥有使用 SSL 的 FTP 服务器？

您将如何设置 ASP.NET 2.0 来使用 SSL 证书？

这当然听起来可能，但它是可取的，是好的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T14:47:16.800

FTP 位于应用层，而 SSL 较低，位于表示层。SSL 会话基于每个连接。看看[维基百科页面](http://en.wikipedia.org/wiki/Transport_Layer_Security)。SSL 连接是在您的应用程序发生任何事情之前建立的。您的 FTP 服务器可能没有在您的 .NET 应用程序服务器中运行，是吗？您应该能够设置一个 SSH 服务器分别侦听 SCP 连接。如果它确实从您的应用服务器内部运行，您应该能够在单独的端口上侦听 SSL 连接。

除此之外，这里有一个在 IIS 中配置 SSL[的好链接](http://www.petri.co.il/configure_ssl_on_your_website_with_iis.htm)。您不必强制要求证书。这样，如果适合您的应用程序模型，您就可以允许不安全的流量和安全流量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T14:52:07.147

我们在每个连接级别上选择使用 SSL，通常由所使用的 IP 端口决定（即在涉及任何应用程序代码之前在客户端和服务器之间设置）。

可以在多个端口上设置相同的服务/内容，每个端口都有不同的 SSL 选择。

证书是每个主机名的，但服务器通常可以支持以不同的名称出现。

将 SSL 与 ASP.NET 一起使用没有什么特别的，只要将 IIS 网站配置为支持 SSL（或要求它：当 HTTP 到端口 80 的连接被重定向到 SSL 端口时）就可以工作；可以在每个文件夹的基础上进行此选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T14:46:22.573

虽然使用 SSL 保护应用程序始终是一个好主意，但从技术上讲它并非易事。

使用 SSL 保护 Web 应用程序需要可在新端口（443/https 而不是 80/http）上访问 Web 服务器。这必须配置为“系统范围”。此外，每个 IP 地址可能只有一个证书，这在同一台服务器上托管多个域时通常是一个问题。

# user-interface - 图像查看器 - 标准 gui 控件，自下而上还是什么？

> ID：602557
> 
> 赞同：3
> 
> 时间：2009-03-02T14:40:03.867
> 
> 标签：user-interface, image

我需要制作一个**基本的图像查看器**。主要关注的是如何实现（在 gui 组件和图像处理方面）诸如：放大、滚动和“手动工具”等功能。

实现这一目标似乎有多种选择，主要区别在于将责任放在图形界面框架上的程度，而不是手动实现事物。

对我来说很明显的两个解决方案是：

**1）**调整和裁剪图像的可见部分是使用某些图像处理库的功能自行制作的。*然后在重写的onPaint()*方法中将图像（或其一部分）绘制在某个窗口/控件上。滚动条更新（使用“手动工具”时）和操作（直接使用时）代码需要编写。

**2)**将包含图像的超大控件（StaticBitmap 或其他）放在具有自动滚动功能的窗口内。然后需要弄清楚如何将图像坐标转换为滚动坐标。

**两种方式看起来都很尴尬。**任何想法如何以一种简洁的方式做到这一点？还是我觉得丑只是唯一的出路？

我将 Python 与 wxPython/wxWidgets 和 PIL 一起使用，但问题在很大程度上与语言和平台无关。

欢迎使用示例代码和源链接（不太臃肿的东西）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T16:29:23.013

这是一个可能会有所帮助的教程。 [构建一个 wxPython 图像查看器](http://showmedo.com/videos/series?name=To3wW0reK)

我实际上并没有观看所有视频，所以我不能说它如何解决你的具体问题。

此外，这是 Jeff Atwood 关于编码恐怖的博客文章，可能适用。[编程很难，我们去购物吧！](http://www.codinghorror.com/blog/archives/001172.html) 它说明了何时应该花时间编写自己的代码以及何时只使用第三方解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T02:49:14.410

我是新来的，搜索了一段时间后仍然找不到上传文件的方法。哦，好吧，这是帖子中的代码。对不起，非描述性的变量名称和缺乏评论。我想您要查看的主要功能是 processPicture 和 showPicture。

编辑：重申一下，我从[本教程](http://paulthom12345.blogspot.com/2008/07/wxpython-tutorial-part-6.html)中的示例开始。

```
import wx, os, string, sys
from PIL import Image

# Scroll wheel and +/- do zoom in/out. f toggles full screen. r rotates.
# m changes PIL mode from low quality (fast) to high quality (slow).
# Images under 1000x1000 are automatically on high quality.
# Middle button down while dragging moves image around, as do arrow
# keys (if image is bigger than window).
# Left and right mouse buttons are next and previous image.

# There is no functionality to load an image. When an executeable is made, the
# viewer is started by opening an image with it. 
# To run this file from command line, comment out line 55 and uncomment 
# line 54, then do "viewer.py sampleImage"

# There are several lines that are Windows specific. They (probably) all have
# to do with paths, i.e, "/" vs "\". 

class ImageFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self,None,title = "viewer")
        self.Centre()
        self.Size = (450,450)
        self.imageBox = wx.Window(self)
        self.vbox = wx.BoxSizer(wx.VERTICAL)
        self.CreateStatusBar(5) 
        self.SetStatusWidths([-1, 70, 50, 50, 30])
        self.cursor = wx.StockCursor(wx.CURSOR_ARROW)
        self.moveCursor = wx.StockCursor(wx.CURSOR_SIZING)
        self.vbox.Add(self.imageBox,proportion=1,flag = wx.EXPAND)
        self.SetSizer(self.vbox)
        self.Show()
        self.sbm = 0
        self.sbmList = []
        self.name = ''
        self.url = ''
        self.dir = ''
        self.factor = 1.0
        self.rotation = 0
        self.width = 0
        self.height = 0
        self.count = 0
        self.size = 0
        self.numOfPics = 0
        self.mc = False
        self.fs = False
        self.mode = 0
        self.SetStatusText(str(self.mode), 4)
        if len(sys.argv) == 2:
            #self.url = os.getcwd() + '\\' + sys.argv[1]
            self.url = sys.argv[1]
            self.name = self.url.split('\\')[len(self.url.split('\\'))-1]
            self.dir = self.url.replace('\\' + self.name,'')
            self.loadDirectory(self.dir)
            self.processPicture()
        self.imageBox.Bind(wx.EVT_SIZE, lambda evt: self.rescale(evt,1))
        self.imageBox.Bind(wx.EVT_MOUSEWHEEL,self.zoom)
        self.imageBox.Bind(wx.EVT_KEY_DOWN, self.keyEvent)
        self.imageBox.Bind(wx.EVT_MIDDLE_UP, self.endDrag)
        self.imageBox.SetBackgroundColour((0,0,0,0))
        self.imageBox.Bind(wx.EVT_LEFT_DOWN, self.next)
        self.imageBox.Bind(wx.EVT_RIGHT_DOWN, self.prev)

    def nameFromUrl(self,url):
        name = url.split('\\')
        name = name[len(name)-1]
        return name

    def processPicture(self, factor = 0):

        img = Image.open(self.url)
        self.width = img.size[0]
        self.height = img.size[1]
        ogHeight = self.height
        ogWidth = self.width
        xWin = self.imageBox.Size[0]
        yWin = self.imageBox.Size[1]
        winRatio = 1.0*xWin/yWin
        imgRatio = 1.0*self.width/self.height

        self.factor = factor*self.factor
        if factor == 0:
            self.factor = 1
        mode = 0
        if (ogWidth <=1000 and ogHeight <= 1000) or self.mode == 1:
            mode = 1

        if imgRatio >= winRatio: #match widths
            self.width = self.factor*xWin
            self.height = self.factor*xWin/imgRatio
            img = img.resize((int(self.width),int(self.height)),mode)
        else:   #match heights
            self.height = self.factor*yWin
            self.width = self.factor*yWin*imgRatio
            img = img.resize((int(self.width),int(self.height)),mode)

        label = str(int(100*self.width/ogWidth))
        name = self.nameFromUrl(self.url)
        index = self.sbmList.index(name)
        self.SetStatusText(name, 0)
        self.SetStatusText(str(ogWidth) + 'x' + str(ogHeight), 1)
        self.SetStatusText(label + '%', 2)
        self.SetStatusText(str(index+1) + '/' + str(self.numOfPics), 3)

        if self.rotation % 360 != 0:
            img = img.rotate(self.rotation)
            self.width = img.size[0]
            self.height = img.size[1]

        wximg = wx.EmptyImage(img.size[0],img.size[1])
        wximg.SetData(img.convert("RGB").tostring())
        wximg.SetAlphaData(img.convert("RGBA").tostring()[3::4])

        self.showPicture(wximg)

    def showPicture(self,img):
        bmp = wx.BitmapFromImage(img)
        x = (self.imageBox.Size[0] - self.width)/2.0
        y = (self.imageBox.Size[1] - self.height)/2.0
        tmp = wx.StaticBitmap(self.imageBox,wx.ID_ANY,bmp,(x,y))
        tmp.Bind(wx.EVT_LEFT_DOWN, self.next)
        tmp.Bind(wx.EVT_RIGHT_DOWN, self.prev)
        tmp.Bind(wx.EVT_MOTION, self.drag)
        tmp.Bind(wx.EVT_MIDDLE_UP, self.endDrag)
        tmp.SetBackgroundColour((180,180,180,180))
        if self.sbm:
            self.sbm.Destroy()
        self.sbm = tmp
        self.imageBox.Refresh()

    def loadDirectory(self,dir):
        self.sbmList = []
        for image in os.listdir(dir):
            if image.lower().endswith('jpg') or image.lower().endswith('png') or image.lower().endswith('jpeg') or image.lower().endswith('gif') or image.lower().endswith('bmp'):
                self.sbmList.append(image)
        self.numOfPics = len(self.sbmList)

    def next(self,event):
        if self.name in self.sbmList:
            n = self.sbmList.index(self.name)
            if n == len(self.sbmList) - 1:
                n = -1
            self.name = self.sbmList[n + 1]
            self.url = self.dir + '\\' + self.name
            self.rotation = 0
            self.processPicture()

    def prev(self,event):
        if self.name in self.sbmList:
            n = self.sbmList.index(self.name)
            if n == 0:
                n = len(self.sbmList)
            self.name = self.sbmList[n - 1]
            self.url = self.dir + '\\' + self.name 
            self.rotation = 0
            self.processPicture()

    def rescale(self,event,factor):
        if self.url and self.GetStatusBar(): #close is seen as a size event.
            self.processPicture(factor)

    def zoom(self,event):
        factor = 1.25
        if event.GetWheelRotation() < 0:
                factor = 0.8
        self.rescale(event,factor)

    def keyEvent(self,event):
        code = event.GetKeyCode()
        if code == 43: #plus
            self.rescale(event,1.25)
        elif code == 45: #minus
            self.rescale(event,0.8)
        elif code == 82 and self.url: #r
            self.rotation = self.rotation + 90
            self.processPicture(1)
        elif code == 70: #f
            self.toggleFS()
        elif (code == 314 or code == 315 or code == 316 or code == 317) and self.sbm:
            #left, up, right, down
            self.scroll(code)
        elif code == 77: #m
            if self.mode == 0:
                self.mode = 1
            else:
                self.mode = 0
            self.SetStatusText(str(self.mode), 4)
            self.processPicture(1)

    def scroll(self,code):
        boxPos = self.imageBox.GetScreenPositionTuple()
        imgPos = self.sbm.GetScreenPositionTuple()
        delta = 20
        if code == 314 and self.width > self.imageBox.Size[0]:
            compare = boxPos[0] - imgPos[0]
            if compare <= delta:
                delta = max(compare,0)
            self.imageBox.ScrollWindow(delta,0)
        if code == 315 and self.height > self.imageBox.Size[1]:
            compare = boxPos[1] - imgPos[1]
            if compare <= delta:
                delta = max(compare,0)
            self.imageBox.ScrollWindow(0,delta)
        if code == 316 and self.width > self.imageBox.Size[0]:
            compare =  imgPos[0] + self.sbm.Size[0] - boxPos[0] - self.imageBox.Size[0]
            if compare <= delta:
                delta = max(compare,0)
            self.imageBox.ScrollWindow(-delta,0)
        if code == 317 and self.height > self.imageBox.Size[1]:
            compare =  imgPos[1] + self.sbm.Size[1] - boxPos[1] - self.imageBox.Size[1]
            if compare <= delta:
                delta = max(compare,0)
            self.imageBox.ScrollWindow(0,-delta)

    def drag(self,event):
        if event.MiddleIsDown():
            if not self.mc:
                self.SetCursor(self.moveCursor)
                self.mc = True
            boxPos = self.imageBox.GetScreenPositionTuple()
            imgPos = self.sbm.GetScreenPositionTuple()
            if self.count == 0:
                self.x = event.GetX()
                self.y = event.GetY()
            self.count = self.count + 1
            if self.count > 1:
                deltaX = event.GetX() - self.x
                deltaY = event.GetY() - self.y
                if imgPos[0] >= boxPos[0] and deltaX > 0:
                    deltaX = 0
                if imgPos[0] + self.width <= boxPos[0] + self.imageBox.Size[0] and deltaX < 0:
                    deltaX = 0
                if imgPos[1] >= boxPos[1] and deltaY > 0:
                    deltaY = 0
                if imgPos[1] + self.height <= boxPos[1] + self.imageBox.Size[1] and deltaY < 0:
                    deltaY = 0
                self.imageBox.ScrollWindow(2*deltaX,2*deltaY)
                self.count = 0

    def endDrag(self,event):
        self.count = 0
        self.SetCursor(self.cursor)
        self.mc = False

    def toggleFS(self):
        if self.fs:
            self.ShowFullScreen(False)
            self.fs = False
        else:
            self.ShowFullScreen(True)
            self.fs = True

app = wx.App(redirect = False)
frame = ImageFrame()
app.MainLoop() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T07:19:19.387

还有[Cornice](http://wxglade.sourceforge.net/extra/cornice.html)一个用 wxPython 编写的开源图像查看器，它可能会对您有所帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-08T19:00:50.820

您可以尝试文档/视图架构。我认为它应该在 Python 中可用。您可以看一下[本教程](http://wxwidgets.info/getting_aquainted_with_doc_view_architecture_part_3_en/)，它适用于 C++，但方法应该类似。它还展示了如何实现选择矩形。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:23:51.303

我实际上只是用 wxPython 和 PIL 做了一个简单的图像查看器。我不想，但我很难找到像我想要的那样简单的观众。无论如何，我从[这个页面](http://paulthom12345.blogspot.com/2008/07/wxpython-tutorial-part-6.html)开始，自己开发了一个应用程序，它可以缩放、旋转和浏览它开始的文件夹中的所有图像。当我回到家时，如果你愿意，我可以发布完整的代码。

# eclipse - 如何在 Rational Business Developer 中安装 UML2Tools

> ID：602562
> 
> 赞同：0
> 
> 时间：2009-03-02T14:41:04.910
> 
> 标签：eclipse, uml

我正在尝试在 Rational Business Developer 7.5.1 中安装 Eclipse UML2Tools 插件

最兼容的版本似乎是 UML2Tools 0.8.0 - 但我无法让它工作。

我无法通过本地更新站点机制或将其放置在 dropins 文件夹中来使 UML2Tools 正常工作。

使用本地站点更新时报告的错误之一是：

找不到 Match[requiredCapability: org.eclipse.equinox.p2.iu/org.eclipse.emf/[2.4.0.v200806091234,2.4.0.v200806091234]] 和 Match[requiredCapability: org.eclipse.equinox] 的解决方案.p2.iu/org.eclipse.emf/[2.4.0.v200808251517,2.4.0.v200808251517]]可以满足。

然后我在 RBD 7.5.1 中强制使用 UML2Tools，方法是放在它的 features 和 plugins 文件夹中。这让它工作了，但是在尝试类图时——生成的图有很大的形状，布局不正确，并且类没有连接。

可以做些什么来让 UML2Tools 在 RBD 7.5.1 中工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T12:50:15.187

我会质疑是否有一些 UML2Tools 已经在运行，这与您的安装冲突。我只会在旁边使用 eclipse 或获取 RSM/RSA。根据文档，RBD 可以从 ULM2 进行模型转换，这意味着它已经安装了一些 emf/gmf/equinox 库。谁知道 IBM 如何削弱 RBD 以不提供更多 UML2 特性。如果您真的想挖掘，我会使用插件注册表视图来查看高级别的运行情况。（需要时间打开）输入Equinox，我的RSA当然有很多围绕UML2等的插件。

![插件查看器](https://lh5.ggpht.com/_WOVuHMLDMuw/ScooakiwCEI/AAAAAAAAABc/M80De1weHro/plug-in-example.jpg)

# c# - 使用 webBrowser 浏览目录时更改视图

> ID：602568
> 
> 赞同：1
> 
> 时间：2009-03-02T14:43:58.710
> 
> 标签：c#, browser

假设您正在使用 webBrowser 控件浏览本地文件系统，因此它的行为类似于 Explorer

`WebBrowser wb = new WebBrowser();
wb.Navigate(@"c:\");`

现在它显示 c:\ 目录的内容。但我希望它以**编程**方式将视图模式设置为“详细信息”视图，而不是显示登录用户当前使用的任何模式。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T16:37:25.927

您可能想查看 IShellBrowser 接口的文档：

[http://msdn.microsoft.com/en-us/library/bb775123(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb775123(VS.85).aspx)

您可能必须在 Web 浏览器上找到 IServiceProvider 接口实现才能访问该接口，而所有这些很可能都必须通过 COM 互操作来完成。

# c++ - 如何在 Python 中使用 C++ 类？

> ID：602580
> 
> 赞同：43
> 
> 时间：2009-03-02T14:47:11.480
> 
> 标签：c++, python, class

我已经用 C++ 实现了一个类。我想将它与 Python 一起使用。 **请建议逐步方法并详细说明每个步骤。** 像这样的东西...

```
class Test{
     private:
        int n;
     public:
        Test(int k){
            n=k;
        }
        void setInt(int k){
            n = k; 
        }
        int getInt(){
            return n;
        }
}; 
```

现在，在 Python 中

```
>>> T1 = Test(12)
>>> T1.getInt()
12
>>> T1.setInt(32)
>>> T1.getInt()
32 
```

请建议。我该怎么做？注意：我想知道手动方式来做到这一点。我不想要任何第三方库依赖。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-02T14:49:48.493

查看[Boost.Python](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)。这是一个用 C++ 编写 python 模块的库。

还可以查看[SWIG](http://www.swig.org/)，它也可以处理其他脚本语言的模块。我过去曾用它为我的班级编写模块并在 python 中使用它们。效果很好。

您可以使用[Python/C API](http://docs.python.org/c-api/)手动完成，自己编写接口。这是相当低级的，但是您将获得很多关于 Python 如何在幕后工作的额外知识（无论如何，当您使用 SWIG 时，您将需要它）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-02T15:06:33.570

[ctypes](https://docs.python.org/2/library/ctypes.html)很好。它非常易于使用，并且是 Python 的标准配置。不幸的是，它只能与具有 C 样式接口的共享库 (Unix) 或 DLL (Windows) 通信，这意味着您不能直接与 C++ 对象交互。但是您可以使用句柄系统，其中句柄引用特定对象。

```
>>> getInt(h)
12 
```

我认为这很简单，易于理解，并且不需要额外的库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T14:49:39.087

我建议您尝试 SWIG 或 sip (KDE/PyQt)。

SWIG 链接：[http](http://www.swig.org/)
://www.swig.org/ SIP 链接： http: [//freshmeat.net/projects/python-sip/](http://freshmeat.net/projects/python-sip/)

这些可用于包装 C++ 类并为它们提供 Pythonic 接口。

# php - PHP 函数包含文件的设计技巧

> ID：602583
> 
> 赞同：4
> 
> 时间：2009-03-02T14:47:42.007
> 
> 标签：php, include, server-side-includes

好的设计要求每个函数只写一次。在 PHP 中，我通过使用包含文件（如 Utils.php 和 Authenticate.php）和 PHP 命令 include_once 来执行此操作。但是，我无法找到 PHP 包含文件的任何标准或最佳实践。你在 StackOverflow 有什么建议？

我在找：

*   命名标准
*   代码标准
*   设计模式
*   定义常用函数的返回类型的建议（现在我只是使用关联数组）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T15:12:56.410

我喜欢使用的一种约定是将每个类放在自己的名为 ClassName.class.php 的文件中，然后设置[自动加载器](http://ca.php.net/manual/en/language.oop5.autoload.php)以包含类文件。或者有时我会将它们全部放在一个类/子目录中，然后将它们命名为 ClassName.php。取决于我期望有多少类与非类包括。

如果您将实用程序函数组织到类中并改为将它们设为静态方法，那么您可以在顶级文件中只编写一个[require_once()](http://ca.php.net/manual/en/function.require-once.php)来摆脱困境。这种方法可能适合也可能不适合您的代码或编码风格。

至于返回类型，我尝试遵循内置函数中使用的约定。返回适合请求的类型，或在失败时返回 false。只需确保在结果中检查 false 时使用[=== 运算符。](http://ca.php.net/manual/en/language.operators.comparison.php)

您关心约定的事实表明您已经走在正确的轨道上。如果您熟悉任何其他 OOP 语言，如 Java、C++、C# 等，那么您会发现由于[PHP5 中的 OOP 优点，](http://ca.php.net/manual/en/language.oop5.php)您可以遵循许多相同的约定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T14:52:41.777

无论您最终使用哪种命名约定（我更喜欢尽可能从 Java 或 C# 中获取线索），请确保您是否将包含文件用于函数，它们实际上不会在包含时执行任何代码，并且永远不要包含两次相同的文件。（使用[include-once](http://nl2.php.net/include_once)或[require-once](http://nl2.php.net/require_once)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T14:51:36.150

已经编写了一些这样的标准。大多数大型项目将遵循自己的标准。

这是 Zend 编写的，是 Zend 框架中使用的标准。 [http://framework.zend.com/manual/en/coding-standard.html](http://framework.zend.com/manual/en/coding-standard.html)

此外，PEAR 总是有一些相当严格的编码标准： http: [//pear.php.net/manual/en/standards.php](http://pear.php.net/manual/en/standards.php)

不过我更喜欢的答案是，对于你自己的项目，你应该使用你觉得舒服的东西，并且在内部保持一致。对于其他项目，请遵循他们的规则。一致性允许最大的代码可读性。我自己的标准和 PEAR 的标准不一样。我不使用四个空格缩进（我使用制表符），并且我从不使用函数名称之类的驼峰式大小写，但尽管如此，如果我正在编辑另一个项目中的某些内容，我将使用该项目所做的任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:14:53.943

我做了以下事情。首先，我创建了一个拦截过滤器，以拦截所有 Web 请求，我还创建了一个可以使用命令行命令的版本。

两个拦截器都将进入一个引导文件，该文件将设置一个自动加载器。这个文件作为自动加载函数和一个哈希。对于散列，键是类名，值是类文件的文件路径。自动加载功能将简单地获取类名并对文件运行要求。

如果您需要一些性能提示，请在定义文件时使用单引号，因为它们不会被解释，因此速度会稍快一些，还可以使用 require/include，而不是它们的 _once 版本，这样可以保证运行一次，并且前者要快一些。

上面的内容很棒，事实上，即使有一个包含大量类的大型代码库，散列也没有那么大，性能从来都不是问题。更重要的是，我们并没有与一些疯狂的伪名称空间类命名约定结婚，见下文。

另一个选项是分隔名称，伪名称空间技巧。这不那么有吸引力，因为名称空间将随 5.3 一起提供，我认为这很恶心，因为在代码库中重命名这些名称空间会不那么有趣。无论如何，这就是它的工作原理，假设您的所有代码都有根。然后所有类都根据到达那里所需的目录遍历来命名，用字符分隔，例如'_'，然后是类名本身，但是文件将以类命名。这样类的位置在名称中进行编码，自动加载器可以使用它。除了 real_long_crazy_class_names_MyClass 之外，此方法的问题在于每次调用都有相当多的处理，但这可能是过早的优化，并且名称空间再次出现。

例如。

```
/code root
ClassA ClassA.php
  /subfolder
  subFolder_ClassB ClassB.php 
```

# 64-bit - 在 32 位程序中使用 64 位驱动程序。视窗

> ID：602587
> 
> 赞同：4
> 
> 时间：2009-03-02T14:48:09.073
> 
> 标签：64-bit, 32-bit

这只是一个中途编程问题。首先，我有一张 PCI-Express 卡和 32/64 位驱动程序。目标操作系统必须是 Windows 64 位系统。我读到在 Vista64 下，所有驱动程序都必须是经过认证的 64 位驱动程序。这是 64 位操作系统下的一般限制吗？这是否也适用于“XP 64”或任何 Linux 系统？

因此，为简单起见，假设我在 Vista64 下为我的 PCIe 卡使用 64 位驱动程序，并有一堆 64 位 DLL 来使用卡功能。另一方面，有一个大型的、遗留的 32 位 exe 程序需要使用 PCIe 设备。将程序转换为 64 位将是一项巨大的工作。

那么如何将 32 位程序和 64 位驱动程序结合在一起呢？我读到混合 32/64 位二进制文​​件和 DLL 根本不可能，但这对我来说很难相信。我确定您可以在 32 位应用程序中打印出 Vista64 下的文档，Windows 会以某种方式将其包装到 64 位打印机驱动程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T15:57:37.160

您的 32 位应用程序是否直接调用驱动程序？（我猜是司机模拟器！）

在 32 位和 64 位 dll 之间进行通信的唯一方法是编写一个管理通信的 COM 服务器（阅读：包装应用程序调用或 64 位驱动程序响应）。

有件事让我很反感：当我第一次编写这个 COM 服务器时（是的，我也不得不忍受许多不眠之夜才知道这个技巧）我只构建了 32 位版本的（自动生成的） ) 代理/存根 dll。在我知道解决方案之前，又是一阵不眠之夜：为 32 位和 64 位构建代理/存根 dll。32 位端处理 32 位端（在您的情况下是应用程序），64 位端处理 64 位端（驱动程序）。COM 管理代理/存根的不同版本如何相互通信。哦，请务必在您的系统上注册服务器。容易，对吧？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T16:41:26.337

只有在 Vista 下才需要 64 位认证；非 Windows 平台没有认证机构，我不相信 XP 或 Windows Server 会检查认证（虽然不确定，它可能取决于您使用的服务包）。

如果您通过 Windows API 使用驱动程序，那么应该没有任何问题；Windows 将在内核中进行 32<->64 位转换。如果您尝试在自己的进程中加载​​驱动程序，那可能是不可能的。正如 Dirk 所说，您必须在自己的进程中运行它并通过 COM 服务器进行通信。如果您必须以更高权限的执行级别运行驱动程序并希望从用户模式调用它，我不确定您必须跳过哪些障碍。

希望您的 64 位 DLL 提供 32 位 API，或者 Windows 提供标准驱动程序接口（如果它是常见的 I/O 设备，如显示器或网卡）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T15:00:52.053

我认为驱动程序的全部意义在于抽象出硬件的实际工作，并为软件提供一个通用接口。在这种情况下，PCIe 驱动程序需要是 64 位的，这样它才能充当 Windows 和硬件的中间人，但我认为 32 位应用程序可以毫无问题地访问设备。

您所读到的不兼容意味着 32 位和 64 位程序集不能属于同一个应用程序 - 应用程序必须针对其中一个或另一个，尽管 32 位应用程序*通常*可以在 Windows x64 上使用WoW64，它只是充当翻译器。

您目前是否遇到问题，或者您只是假设性地询问？

# javascript - 你能用jquery做到这一点吗？

> ID：602588
> 
> 赞同：2
> 
> 时间：2009-03-02T14:48:15.127
> 
> 标签：javascript, jquery, events

是否可以在课堂上做到这一点？

```
 $("#" + field).click(this.validate); 
```

所以基本上我想传递一个对象的函数，只要单击某些东西就应该执行该函数。此外，如果该对象的实例超过 1 个，则应执行正确的实例（即为给定字段运行此代码的实例）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T15:00:02.027

我不确定一个简单的方法，但你总是可以走关闭路线：

```
var that = this;
$("#" + field).click(function() {
    that.validate();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:14:10.603

> 是否可以在课堂上做到这一点？
> 
> $("#" + 字段).click(this.validate);

“this.validate”是有问题的。JavaScript 没有绑定方法，因此当您传递该引用时，它仅指向一个普通函数。调用时，'this' 将无法正确设置。有关绑定丢失问题的相当详尽的讨论，请参见[ALA 。](http://www.alistapart.com/articles/getoutbindingsituations)

一些框架提供了内置的方法绑定功能；jQuery 没有，因为它倾向于更多地关注闭包而不是 JavaScript 对象。无论如何，使用闭包创建绑定包装器非常简单；Andrey 的回答是 jQuery 用户的常用方法。

使用事件处理程序的闭包（无论您是否使用 jQuery）要注意的一件事是它往往会导致 IE 中的内存泄漏。对于简单、短暂的网页，您可能不在乎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T14:50:42.267

是的，有可能。

10 分钟前正在写一个片段，因为我遇到了这个问题

```
$("div.myalarms_delete").click(function(){
    var mid = this.id;
    $("li#"+mid).fadeOut("fast");
}); 
```

div.myalarms_delete 也是我需要的 id

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T15:07:53.863

在类内部，您通常最好使用 .find 函数。

```
var child = this.find('.someChildClass');
var child2 = this.find('#someChildId'); 
```

# actionscript - 如何在动作脚本中在运行时覆盖 setter 函数？

> ID：602590
> 
> 赞同：1
> 
> 时间：2009-03-02T14:49:01.007
> 
> 标签：actionscript, runtime, overriding

我有一个带有 setter 和 getter 函数的 AS 类。我需要调整这个类的一个实例，以便它的 setter 函数在将输入分配给局部变量之前对其进行处理。

或者，以更详细的方式，在下面的示例中我应该使用什么来代替 $$$？

```
class MyClass{
    private var _legend:Array;
    function set legend(legend:Array):void{
        _legend= legend;
    }
    function get legend():Array{
        return _legend;
    }
    function someFunction():void{
        foo();
    }
}
var mc:MyClass = new MyClass();
mc.someFunction = function():void{
    bar();
}
mc.$$$ = new function(legend:Array):void{
    _legend = process(legend);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T15:31:25.163

为什么不将经过处理的输入传递给实例？

```
mc.legend = process(legend); 
```

如果这不可能，您可以修改 MyClass 中的设置器并采用可选的布尔值进行处理。

```
function set legend(legend:Array, flag:bool = false):void{
            _legend = flag ? process(legend) : legend;
} 
```

请注意，原型继承并不局限于特定的实例。从文档中：

> 原型继承 - 是先前版本的 ActionScript 中唯一的继承机制，并且在 ActionScript 3.0 中用作另一种继承形式。每个类都有一个关联的原型对象，原型对象的属性由该类的所有实例共享。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T20:10:01.267

通常你会继承 MyClass 来修改 MyClass 的行为（多态性）。

```
class MySubClass extends MyClass {
        function set legend(legend:Array):void{
                // do your checking here. Then call the 
                // setter in the super class.

                super.legend = legend;
        }
} 
```

# iphone - 如何在 iPhone 上的类之间传递值？

> ID：602591
> 
> 赞同：0
> 
> 时间：2009-03-02T14:49:38.853
> 
> 标签：iphone, class-design, data-transfer, transfer

我想将一个字符串从一个类发送到另一个类：

1）在class1中，我添加一个属性来保存字符串：

```
@property (nonatomic, retain) NSString *str; 
```

2) 和一个发回字符串的方法：

```
 -(NSString *)sendBackStr:(NSString *)strURL
{
    NSString *str = [[NSString alloc] stringWithString:strURL];
    return str;
} 
```

3）在class2中，我添加了一个属性来保存接收到的字符串：

```
@property (nonatomic, retain) NSString *returnStr; 
```

4）和以下代码：

```
Class1 *c1 = [[Class1 alloc] init]; 
returnStr = [c1 sendBackStr:@"URL"];
```

但程序停在 returnStr = [c1 sendBackStr:@"URL"]; 关于它有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:27:17.403

stringWithString: 是需要发送到 NSString 类的消息，而不是你的类的实例（通过 alloc 返回）。

正确的代码应该是：

```
-(NSString *)sendBackStr:(NSString *)strURL
{
    return [NSString stringWithString:strURL];
} 
```

您可能想更多地了解有关指针分配、保留和自动释放的习惯用法。如果您出于某种原因想要分配此字符串并从 sendBackStr: 消息中返回它，那么您可能需要以下代码：

```
-(NSString *)sendBackStr:(NSString *)strURL
{
    return [[[NSString alloc] initWithString:strURL] autorelease];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:15:55.173

stringWithString 是一个返回自动释放字符串的类方法。你应该这样称呼它：

```
myProperty = [NSString stringWithString:strURL]; 
```

在这里，我假设您的属性进行了复制，以增加从 stringWithString 方法返回的自动释放字符串的保留计数。（从 alloc 调用返回的对象的保留计数为 1，并且不会自动释放。）为字符串提供复制属性而不是保留属性更为常见 - 您通常只想要自己的字符串副本，而不是对 a 的共享引用别人拥有的字符串。

我也无法理解的是你为什么写这样的代码，除非它只是一个例子。在第 2 课中，你需要做的就是写

```
returnStr = [NSString stringWithString:@"URL"]; 
```

# c++ - 模板还是抽象基类？

> ID：602593
> 
> 赞同：39
> 
> 时间：2009-03-02T14:49:41.240
> 
> 标签：c++, design-patterns, templates, abstract-class, virtual-functions

如果我想让一个类具有适应性，并且可以从外部选择不同的算法——C++ 中最好的实现是什么？

我主要看到两种可能性：

*   使用抽象基类并传入具体对象
*   使用模板

这是一个小例子，在各种版本中实现：

**版本 1：**抽象基类

```
class Brake {
public: virtual void stopCar() = 0;  
};

class BrakeWithABS : public Brake {
public: void stopCar() { ... }
};

class Car {
  Brake* _brake;
public:
  Car(Brake* brake) : _brake(brake) { brake->stopCar(); }
}; 
```

**版本 2a：**模板

```
template<class Brake>
class Car {
  Brake brake;
public:
  Car(){ brake.stopCar(); }
}; 
```

**版本 2b：**模板和私有继承

```
template<class Brake>
class Car : private Brake {
  using Brake::stopCar;
public:
  Car(){ stopCar(); }
}; 
```

来自 Java，我自然倾向于总是使用版本 1，但模板版本似乎更受欢迎，例如在 STL 代码中？如果这是真的，仅仅是因为内存效率等（没有继承，没有虚函数调用）吗？

我意识到版本 2a 和 2b 之间没有太大区别，请参阅[C++ FAQ](http://www.parashift.com/c++-faq-lite/private-inheritance.html#faq-24.2)。

你能评论一下这些可能性吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-02T15:31:08.207

这取决于你的目标。如果您可以使用版本 1

*   打算更换汽车的制动器（在运行时）
*   打算将 Car 传递给非模板函数

我通常更喜欢使用运行时多态性的版本 1，因为它仍然很灵活，并且允许您让 Car 仍然具有相同的类型：`Car<Opel>`是另一种类型而不是`Car<Nissan>`. 如果您的目标是在频繁使用刹车时表现出色，我建议您使用模板化方法。顺便说一下，这称为基于策略的设计。你提供一个*刹车政策*。例如，因为您说您使用 Java 编程，可能您对 C++ 还没有太多经验。一种方法：

```
template<typename Accelerator, typename Brakes>
class Car {
    Accelerator accelerator;
    Brakes brakes;

public:
    void brake() {
        brakes.brake();
    }
} 
```

如果你有很多策略，你可以将它们组合到它们自己的结构中，然后传递那个，例如作为`SpeedConfiguration`collection`Accelerator`等等`Brakes`。在我的项目中，我尝试保持大量代码无模板，允许它们一次编译到自己的目标文件中，而不需要它们的代码在头文件中，但仍然允许多态性（通过虚拟函数）。例如，您可能希望在基类中保留非模板代码可能会在很多情况下调用的通用数据和函数：

```
class VehicleBase {
protected:
    std::string model;
    std::string manufacturer;
    // ...

public:
    ~VehicleBase() { }
    virtual bool checkHealth() = 0;
};

template<typename Accelerator, typename Breaks>
class Car : public VehicleBase {
    Accelerator accelerator;
    Breaks breaks;
    // ...

    virtual bool checkHealth() { ... }
}; 
```

顺便说一句，这也是 C++ 流使用的方法：`std::ios_base`包含不依赖于 char 类型或特征的标志和东西，如 openmode、格式标志和东西，而`std::basic_ios`then 是继承它的类模板。这还通过共享类模板的所有实例所共有的代码来减少代码膨胀。

### 私人继承？

一般应避免私有继承。它很少有用，在大多数情况下，遏制是一个更好的主意。当大小非常重要时（例如基于策略的字符串类），通常情况相反：当从空策略类（仅包含函数）派生时，可以应用空基类优化。

阅读Herb Sutter[的《继承的使用和滥用》 。](http://www.gotw.ca/publications/mill06.htm)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-02T15:10:18.693

经验法则是：

1) 如果具体类型的选择是在编译时进行的，则首选模板。它会更安全（编译时错误与运行时错误）并且可能会得到更好的优化。2) 如果选择是在运行时做出的（即作为用户操作的结果），则实际上别无选择——使用继承和虚函数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T14:58:12.887

其他选项：

1.  使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)（让外部代码在你的类上工作）。
2.  将类的某些部分外部化，例如通过迭代器，基于通用迭代器的代码可以在它们上工作。如果您的对象是其他对象的容器，则此方法效果最佳。
3.  另见[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)（里面有 c++ 示例）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-02T14:57:47.227

模板是一种让类使用您并不真正关心类型的变量的方法。继承是一种基于属性定义类的方法。它是[“is-a”与“has-a”的](http://weblog.raganwald.com/2008/03/is-is-has.html)问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T16:00:15.720

您的大部分问题已经得到解答，但我想详细说明这一点：

> 来自 Java，我自然倾向于总是使用版本 1，但模板版本似乎更受欢迎，例如在 STL 代码中？如果这是真的，仅仅是因为内存效率等（没有继承，没有虚函数调用）吗？

这是其中的一部分。但另一个因素是增加的类型安全性。当您将 a`BrakeWithABS`视为 a`Brake`时，您会丢失类型信息。您不再知道该对象实际上是一个`BrakeWithABS`. 如果它是模板参数，则您有可用的确切类型，这在某些情况下可能使编译器能够执行更好的类型检查。或者它可能有助于确保调用正确的函数重载。（如果`stopCar()`将 Brake 对象传递给第二个函数，该函数可能具有单独的重载 for `BrakeWithABS`，如果您使用继承并且您`BrakeWithABS`已被强制转换为`Brake`.

另一个因素是它允许更大的灵活性。为什么所有的 Brake 实现都必须继承自同一个基类？基类实际上有什么要提出来的吗？如果我编写一个公开预期成员函数的类，那还不足以起到刹车的作用吗？通常，显式使用接口或抽象基类会过度限制您的代码。

（注意，我并不是说模板应该始终是首选解决方案。还有其他可能会影响这一点的问题，从编译速度到“我团队中的程序员熟悉什么”或只是“我喜欢什么”。有时，您*需要*运行时多态性，在这种情况下，模板解决方案根本不可能）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T15:54:23.440

[这个答案](https://stackoverflow.com/questions/602593/template-or-abstract-base-class/602675#602675)或多或少是正确的。当您想要在编译时参数化某些东西时 - 您应该更喜欢模板。当您希望在运行时参数化某些东西时，您应该更喜欢覆盖虚函数。

*但是*，使用模板并不妨碍您同时执行这两种操作（使模板版本更加灵活）：

```
struct Brake {
    virtual void stopCar() = 0;
};

struct BrakeChooser {
    BrakeChooser(Brake *brake) : brake(brake) {}
    void stopCar() { brake->stopCar(); }

    Brake *brake;
};

template<class Brake>
struct Car
{
    Car(Brake brake = Brake()) : brake(brake) {}
    void slamTheBrakePedal() { brake.stopCar(); }

    Brake brake;
};

// instantiation
Car<BrakeChooser> car(BrakeChooser(new AntiLockBrakes())); 
```

话虽如此，我可能不会为此使用模板......但这真的只是个人品味。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-02T14:59:44.210

抽象基类具有虚拟调用的开销，但它的优点是所有派生类都是真正的基类。当您使用模板时并非如此—— Car<Brake> 和 Car<BrakeWithABS> 彼此无关，您必须进行 dynamic_cast 并检查 null 或为所有处理 Car 的代码提供模板。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T14:59:03.667

如果您想同时支持不同的 Break 类及其层次结构，请使用接口。

```
Car( new Brake() )
Car( new BrakeABC() )
Car( new CoolBrake() ) 
```

而且您在编译时不知道这些信息。

如果您知道要使用哪个 Break 2b 是您指定不同 Car 类的正确选择。在这种情况下，刹车将是您的汽车“策略”，您可以设置默认值。

我不会用2a。相反，您可以将静态方法添加到 Break 并在没有实例的情况下调用它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T10:42:38.573

就个人而言，由于以下几个原因，我总是更喜欢使用接口而不是模板：

1.  模板编译和链接错误有时很神秘
2.  很难调试基于模板的代码（至少在 Visual Studio IDE 中）
3.  模板可以使您的二进制文件更大。
4.  模板要求您将其所有代码放在头文件中，这使得模板类更难理解。
5.  新手程序员很难维护模板。

我只在虚拟表产生某种开销时使用模板。

当然，这只是我个人的看法。

# python - 输入每个命令后如何在python pdb中显示'l'的输出

> ID：602599
> 
> 赞同：5
> 
> 时间：2009-03-02T14:51:11.390
> 
> 标签：python, debugging, pdb

在交互式调试会话中输入的每个命令之后，我希望将 python pdb 'l' 命令的输出打印到屏幕上。

有没有办法设置 python pdb 来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T15:29:38.117

一种方法是为您喜欢的命令设置别名以运行该命令，然后使用 l。

例如

```
(Pdb) alias s step ;; l
(Pdb) s
> /usr/lib/python2.5/distutils/core.py(14)<module>()
-> from types import *
 9      # This module should be kept compatible with Python 2.1.
10      
11      __revision__ = "$Id: core.py 38672 2005-03-20 22:19:47Z fdrake $"
12      
13      import sys, os
14  ->  from types import *
15      
16      from distutils.debug import DEBUG
17      from distutils.errors import *
18      from distutils.util import grok_environment_error
19 
```

在您的 ~/.pdbrc 中，您可以添加别名，以便每次都拥有它们：

```
alias s step ;; l 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T15:25:19.093

';;' 允许分开命令

```
 [crchemist@test tmp]$ python t.py
> /home/crchemist/tmp/t.py(7)()
-> a()
(Pdb) p a ;; l
function a at 0xb7e96df4
  2         b = 49 + 45
  3         v = 'fff'
  4         return v
  5
  6     import pdb; pdb.set_trace()
  7  -> a() [EOF]
(Pdb) s ;; l
--Call--
> /home/crchemist/tmp/t.py(1)a()
-> def a():
  1  -> def a():
  2         b = 49 + 45
  3         v = 'fff'
  4         return v
  5
  6     import pdb; pdb.set_trace()
  7     a() [EOF]
(Pdb) s ;; l
> /home/crchemist/tmp/t.py(2)a()
-> b = 49 + 45
  1     def a():
  2  ->     b = 49 + 45
  3         v = 'fff'
  4         return v
  5
  6     import pdb; pdb.set_trace()
  7     a() [EOF]
(Pdb) 

```

# c# - 用于创建工作项模板的 TFS 客户端 API？

> ID：602610
> 
> 赞同：3
> 
> 时间：2009-03-02T14:53:05.333
> 
> 标签：c#, .net, visual-studio, tfs, visual-studio-sdk

当然，很可能在 TFS 中创建工作项、获取工作项列表等。

除此之外，我们还需要允许用户为各种文件类型创建自己的工作项模板的功能。

TFS 客户端 API 是否能够将工作项模板上传到 TFS 服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T15:03:16.667

有一种获取（XML）定义的方法：[`Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemType.Export`](http://msdn.microsoft.com/en-gb/library/microsoft.teamfoundation.workitemtracking.client.workitemtype.export.aspx)

而且，[`Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemTypeCollection.Import`](http://msdn.microsoft.com/en-gb/library/microsoft.teamfoundation.workitemtracking.client.workitemtypecollection.import.aspx)看起来您可以上传 XML 来创建新的工作项类型。

建议，设置一个带有 TFS Workgroup 实例的 VM 并执行大量测试。

# java - Java2d 有哪些更快的替代方案？

> ID：602614
> 
> 赞同：17
> 
> 时间：2009-03-02T14:55:04.207
> 
> 标签：java, performance, rendering, jogl, java-2d

我想做一些物理模拟，我需要用 Java 快速渲染。

我过去曾遇到过 Java2d 的性能问题，那么快速的替代方案是什么？JOGL 是否比 Java2d 快得多？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T17:58:50.957

我对 Java2D 的经验是，如果您遵守规则，它会非常快。只需更改一些简单的事情，我就有一个应用程序从 90% 的 CPU 变为不到 5% 的 CPU。例如，使用大的透明 PNG 是不行的。

Java-Gaming.org 论坛是一个非常好的资源：很多人，包括 Sun 2D 专家，都在那里闲逛，并提供了许多关于 2D 绘图性能问题的示例和解决方案。

请参阅：[http](http://www.javagaming.org/) ://www.javagaming.org/ ，然后是“性能调优”主题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T13:26:40.113

JOGL 可能比 Java2D 快得多，即使你只用它来做 2D 图形：正如 Clayworth 提到的，它通常取决于你需要做什么。

我的猜测是，对于 2D 物理模拟，您有（纹理或非纹理）对象以 2 个自由度旋转和平移，JOGL 应该提供最佳性能，并且还可以轻松地让您提供可缩放的界面。这是用于 2D 图形的 OpenGL[教程](http://basic4gl.wikispaces.com/2D+Drawing+in+OpenGL)（C，但很容易适应 JOGL）。

JOGL 将比 Java2D 花费更多的时间来学习，但获得良好的性能很可能不需要像 Java2D 中那样专门的优化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T17:12:17.073

我不知道——过去我会说是的——特别是如果您使用显示列表而不是每次显示屏幕时都通过 API 进行大量调用。但是更新 10 的 1.6 JVM 添加了加速的 Java2D 图形，所以现在可能有优势。真正确定的唯一方法是尝试在两者中渲染典型场景并进行测量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T18:02:53.743

另请查看基于[LWJGL](http://www.lwjgl.org)并且在某些方面类似于 Java2D的[Slick 。](http://slick.cokeandcode.com/)它使用 OpenGL，因此速度更快。

# .net - System.MissingMethodException - 3.5 SP1 版本控制地狱

> ID：602619
> 
> 赞同：14
> 
> 时间：2009-03-02T14:55:46.967
> 
> 标签：.net, exception

将 ASP.net webservice 部署到我的生产服务器后，我得到了这个异常：

> **System.MissingMethodException**
> 
> 找不到方法：'Boolean System.Threading.WaitHandle.WaitOne(Int32)'

MSDN[文档](http://msdn.microsoft.com/en-us/library/cc189907.aspx)指出：

> 版本信息 .NET Framework 受以下版本支持：**3.5 SP1、3.0** SP2、2.0 SP2

所以这个错误的原因是我的服务器没有更新到最新的服务包。

问题是：

为什么代码开始？IMO 如果目标框架版本不同，则应用程序根本不应该启动。

如何确保我的代码可以在 JIT 之前的目标机器框架版本上运行？

这太疯狂了。我认为微软应该更认真地对待版本问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-05-04T16:20:22.710

虽然方法：

```
Boolean System.Threading.WaitHandle.WaitOne(Int32) 
```

不存在，方法：

```
Boolean System.Threading.WaitHandle.WaitOne(Int32, bool) 
```

确实存在。

使用反射器查看 -作为布尔值的`WaitOne(Int32)`调用。所以只需使用第二个签名，作为布尔值提供，你应该没问题。`WaitOne(Int32,bool)``false``false`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T15:04:32.450

我同意。问题是程序集版本号没有改变。

在过渡到 .NET 3.5 SP1 时，我通过确保构建服务器没有安装 SP（即构建服务器框架版本与目标机器框架版本匹配）来确保开发人员没有使用特定于 SP1 的 API。然后，一旦我们准备好，SP1 就安装在构建服务器上。类似的方法可以使您免于痛苦。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T15:01:04.520

很久以前的 1.1 和 1.1 SP1 也发生了同样的情况......我想没有一个好的解决方案，因为程序集具有相同的版本，您可以尝试通过手动阅读 .net 安装版本来验证它，或者只是安装所有开发和生产机器中的最后一个服务包。

# java - 检测两张连续图片的变化

> ID：602624
> 
> 赞同：4
> 
> 时间：2009-03-02T14:57:33.887
> 
> 标签：java, image-processing

作为一个玩具项目，我想编写一个应用程序，该应用程序将从网络摄像头拍摄照片，然后检测其中的变化。我想检测是否有人走到网络摄像头前。

你们能告诉我一些关于如何在连续两次拍摄中检测到重大变化的指示吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T15:00:30.357

从一个图像减去另一个图像的每像素亮度值。

这将为您提供移动物体的每个像素的高值，以及相同物体的低值。合计这些值并检查它是否高于某个阈值以查看是否发生了重大变化。

我从笔记本电脑上拍了一张手的照片来展示这一点：

![替代文字](https://brains.s3.amazonaws.com/posts/2008/hands.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T11:32:54.660

我会首先将图像缩小到 30K 到 60K 像素。这不仅可以加快计算速度，还可以消除微小的无关更改。例如，您不想检测被风移动的打开窗户附近的窗帘。

接下来，求和像素值的平方差。如果要彻底做，可以对R、G、B分别做：

```
Delta := 0;
for y := 0 to Im1.Height do begin
  for x := 0 to Im1.Width do begin
    DeltaR := ( Im1[x,y].Red   - Im2[x,y].Red ) ^ 2;
    DeltaG := ( Im1[x,y].Green - Im2[x,y].Green ) ^ 2;
    DeltaB := ( Im1[x,y].Blue  - Im2[x,y].Blue ) ^ 2;
    Delta := Delta + DeltaR + DeltaG + DeltaB;
  end;
end;

if (Delta > Treshold) then
  Say( 'Hi Bob!' ); 
```

（这只是伪代码，因为代码处理速度相当慢，如果您想快速处理图像中的所有像素，请在谷歌搜索“扫描线”）

您可能希望根据经验定义阈值：慢慢地走过相机，最好穿着与背景颜色相匹配的衣服，看看您得到了什么增量。
跳帧应该会增加灵敏度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T15:00:22.400

Over at [Code Project](http://www.codeproject.com/KB/audio-video/Motion_Detection.aspx)是一篇很好的文章，解释了一个可能的解决方案。

# c# - C# 程序集注入检查

> ID：602625
> 
> 赞同：1
> 
> 时间：2009-03-02T14:57:42.047
> 
> 标签：c#, sql-server, stored-procedures, assemblies, sql-injection

我正在用 C# 为 MS SQL 2005 创建一个程序集。该程序集创建一个存储过程并根据传递给存储过程的参数运行动态查询。

C#中是否有一个简单的函数来防止SQL注入？

例如

```
string myQuery = "SELECT * FROM dbo.MyTable WHERE lastName = '" + injectionCheck(arg1) + "'"; 
```

这个问题是针对标准查询回答的......但是在无法构建真正动态查询的情况下，我可以在 C# 中使用什么来进行注入检查？

例如，这些可能不起作用：

使用@dbName；

选择 * 从 @table

打开对称密钥@keyName

ETC

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T15:01:18.730

使用绑定参数：

```
SqlCommand cmd = new SqlCommand(myQuery, conn);
cmd.Parameters.Add("@lastname", SqlDbType.NVarChar, 10, lastName); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T15:01:30.853

使用参数 ....

（这个已经经常发了）

```
string myQuery = "SELECT * FROM myTable WHERE lastname = @p_name";

SqlCommand cmd = new SqlCommand();
cmd.CommandText = myQuery;
cmd.Parameters.Add ("@p_name", SqlDbType.Varchar).Value = "melp"; 
```

# java - 为什么会抛出 ConcurrentModificationException 以及如何调试它

> ID：602636
> 
> 赞同：152
> 
> 时间：2009-03-02T14:59:53.710
> 
> 标签：java, exception, collections, concurrentmodification

我正在使用 a `Collection`（`HashMap`由 JPA 间接使用，它确实如此），但显然代码随机抛出一个`ConcurrentModificationException`. 是什么原因造成的，我该如何解决这个问题？通过使用一些同步，也许？

这是完整的堆栈跟踪：

```
Exception in thread "pool-1-thread-1" java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextEntry(Unknown Source)
        at java.util.HashMap$ValueIterator.next(Unknown Source)
        at org.hibernate.collection.AbstractPersistentCollection$IteratorProxy.next(AbstractPersistentCollection.java:555)
        at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:296)
        at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:242)
        at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:219)
        at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)
        at org.hibernate.engine.Cascade.cascade(Cascade.java:130) 
```

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-03-02T15:04:45.027

这不是同步问题。如果被迭代的底层集合被迭代器本身以外的任何东西修改，就会发生这种情况。

```
Iterator it = map.entrySet().iterator();
while (it.hasNext()) {
    Entry item = it.next();
    map.remove(item.getKey());
} 
```

这将在第二次调用`ConcurrentModificationException`时抛出一个。`it.hasNext()`

正确的方法是

```
Iterator it = map.entrySet().iterator();
while (it.hasNext()) {
    Entry item = it.next();
    it.remove();
} 
```

假设此迭代器支持该`remove()`操作。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-03-02T16:40:37.137

尝试使用 a`ConcurrentHashMap`而不是普通的`HashMap`

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2019-03-13T11:57:02.633

大多数类都*不允许*修改使用 an[`Collection`](https://docs.oracle.com/javase/10/docs/api/java/util/Collection.html)迭代的 while 。Java 库将在迭代时尝试修改它称为“并发修改”。不幸的是，这表明唯一可能的原因是多个线程同时修改，但事实并非如此。仅使用一个线程就可以为（使用，或[增强](https://stackoverflow.com/questions/18410035/ways-to-iterate-over-a-list-in-java)[循环](https://stackoverflow.com/questions/18410035/ways-to-iterate-over-a-list-in-java)）创建迭代器，开始迭代（使用，或等效地进入增强循环的主体），修改，然后继续迭代。`Collection`[`Iterator`](https://docs.oracle.com/javase/10/docs/api/java/util/Iterator.html)*`Collection``Collection``Collection`[`Collection.iterator()`](https://docs.oracle.com/javase/10/docs/api/java/util/Collection.html#iterator())[`for`](https://stackoverflow.com/questions/18410035/ways-to-iterate-over-a-list-in-java)[`Iterator.next()`](https://docs.oracle.com/javase/10/docs/api/java/util/Iterator.html#next())`for``Collection`*

 *为了帮助程序员，这些类的*一些*实现*尝试*检测错误的并发修改，如果检测到则抛出一个错误。然而，保证检测到所有并发修改通常是不可能和实际的。因此，错误使用并不总是导致抛出.`Collection`*`ConcurrentModificationException``Collection``ConcurrentModificationException`*

 *的文档[`ConcurrentModificationException`](https://docs.oracle.com/javase/10/docs/api/java/util/ConcurrentModificationException.html)说：

> 当这种修改是不允许的时，检测到对象的并发修改的方法可能会抛出此异常...
> 
> 请注意，此异常并不总是表示对象已被不同的线程同时修改。如果单个线程发出一系列违反对象约定的方法调用，则该对象可能会抛出此异常...
> 
> 请注意，不能保证快速失败的行为，因为一般来说，在存在不同步的并发修改的情况下，不可能做出任何硬保证。快速失败的操作`ConcurrentModificationException`是在尽力而为的基础上进行的。

注意

*   异常**可能会**被抛出，而不是**必须**被抛出
*   不需要不同的线程
*   不能保证抛出异常
*   抛出异常是尽最大努力的基础
*   [*检测到*](https://stackoverflow.com/a/29723542/545127)[并发修改时](https://stackoverflow.com/a/29723542/545127)抛出异常[，而不是](https://stackoverflow.com/a/29723542/545127)[*引起异常时*](https://stackoverflow.com/a/29723542/545127)[](https://stackoverflow.com/a/29723542/545127)

 **[`HashSet`](https://docs.oracle.com/javase/10/docs/api/java/util/HashSet.html)、[`HashMap`](https://docs.oracle.com/javase/10/docs/api/java/util/HashMap.html)和[`TreeSet`](https://docs.oracle.com/javase/10/docs/api/java/util/TreeSet.html)类的文档是这样[`ArrayList`](https://docs.oracle.com/javase/10/docs/api/java/util/ArrayList.html)说的：

> [从此类直接或间接] 返回的迭代器是快速失败的：如果在创建迭代器后的任何时间修改 [集合]，除了通过迭代器自己的 remove 方法之外的任何方式，`Iterator`抛出一个`ConcurrentModificationException`. 因此，面对并发修改，迭代器快速而干净地失败，而不是在未来不确定的时间冒任意的、非确定性的行为。
> 
> 请注意，不能保证迭代器的快速失败行为，因为一般来说，在存在不同步的并发修改的情况下，不可能做出任何硬保证。快速失败的迭代器`ConcurrentModificationException`在尽力而为的基础上抛出。因此，编写一个依赖于这个异常的正确性的程序是错误的：*迭代器的快速失败行为应该只用于检测错误*。

再次注意，行为“无法得到保证”并且只是“在尽力而为的基础上”。

接口的几种方法的文档是[`Map`](https://docs.oracle.com/javase/10/docs/api/java/util/Map.html)这样说的：

> 非并发实现应覆盖此方法，并尽最大努力`ConcurrentModificationException`在计算期间检测到映射函数修改此映射时抛出 a。并发实现应该覆盖这个方法，并且在最大努力的基础上，`IllegalStateException`如果检测到映射函数在计算期间修改了这个映射并且因此计算永远不会完成，则抛出一个。

再次注意，检测只需要“尽力而为基础”，并且`ConcurrentModificationException`仅针对非并发（非线程安全）类明确建议使用 a。

# 调试`ConcurrentModificationException`

因此，当您看到由于 a 导致的堆栈跟踪时`ConcurrentModificationException`，您不能立即假设原因是对 a 的不安全多线程访问`Collection`。您必须[检查堆栈跟踪](https://stackoverflow.com/questions/3988788/what-is-a-stack-trace-and-how-can-i-use-it-to-debug-my-application-errors)以确定哪个类`Collection`引发了异常（该类的方法将直接或间接引发它）以及哪个`Collection`对象。然后您必须检查可以从何处修改该对象。

*   最常见的原因是`Collection`在. 仅仅因为您在源代码中没有看到对象并不意味着不存在！幸运的是，错误循环的其中一条语句通常会在堆栈跟踪中，因此跟踪错误通常很容易。`for``Collection``Iterator``Iterator``for`
*   更棘手的情况是您的代码传递对`Collection`对象的引用。请注意，集合的*不可修改*视图（例如由 生成[`Collections.unmodifiableList()`](https://docs.oracle.com/javase/10/docs/api/java/util/Collections.html#unmodifiableList(java.util.List))）保留对可修改集合的引用，因此[对“不可修改”集合的迭代可能会引发异常](https://stackoverflow.com/questions/19726337/concurrentmodificationexception-in-unmodifiable-collection)（修改已在其他地方完成）。您的其他*视图*`Collection`，例如[子列表](https://docs.oracle.com/javase/10/docs/api/java/util/List.html#subList(int,int))、[`Map`条目集](https://docs.oracle.com/javase/10/docs/api/java/util/Map.html#entrySet())和[`Map`键集](https://docs.oracle.com/javase/10/docs/api/java/util/Map.html#keySet())也保留对原始（可修改）的引用`Collection`。即使对于线程安全的 ; 这也可能是一个问题`Collection`，例如[`CopyOnWriteList`](https://stackoverflow.com/questions/1527519/copyonwritearraylist-throwing-currentmodificationexception); 不要假设线程安全（并发）集合永远不会抛出异常。
*   在某些情况下，哪些操作可以修改 a`Collection`可能是意料之外的。例如，[`LinkedHashMap.get()`修改其集合](https://stackoverflow.com/a/16180833/545127)。
*   最困难的情况是异常*是*由于多个线程的并发修改引起的。

# 防止并发修改错误的编程

如果可能，限制对`Collection`对象的所有引用，这样更容易防止并发修改。制作`Collection`一个`private`对象或一个局部变量，并且不要`Collection`从方法返回对 the 或其迭代器的引用。*然后检查所有*`Collection`可以修改的地方要容易得多。如果`Collection`要由多个线程使用，那么确保线程`Collection`仅通过适当的同步和锁定访问 是切实可行的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-11-20T07:08:47.227

在 Java 8 中，您可以使用 lambda 表达式：

```
map.keySet().removeIf(key -> key condition); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T15:04:28.317

这听起来不像是 Java 同步问题，而更像是数据库锁定问题。

我不知道向所有持久类添加一个版本是否会解决它，但这是 Hibernate 可以提供对表中行的独占访问的一种方式。

可能是隔离级别需要更高。如果您允许“脏读”，也许您需要升级到可序列化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T16:04:01.967

根据您要执行的操作，尝试 CopyOnWriteArrayList 或 CopyOnWriteArraySet。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-06T08:02:19.433

> 请注意，如果您像我一样在迭代地图时尝试从地图中删除一些条目，则所选答案不能在某些修改之前直接应用于您的上下文。

我只是在这里为新手提供我的工作示例以节省他们的时间：

```
HashMap<Character,Integer> map=new HashMap();
//adding some entries to the map
...
int threshold;
//initialize the threshold
...
Iterator it=map.entrySet().iterator();
while(it.hasNext()){
    Map.Entry<Character,Integer> item=(Map.Entry<Character,Integer>)it.next();
    //it.remove() will delete the item from the map
    if((Integer)item.getValue()<threshold){
        it.remove();
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-15T14:03:30.087

我在尝试从列表中删除最后 x 个项目时遇到了这个异常。 `myList.subList(lastIndex, myList.size()).clear();`是唯一对我有用的解决方案。

# asp.net - Server.UrlEncode 与 HttpUtility.UrlEncode

> ID：602642
> 
> 赞同：192
> 
> 时间：2009-03-02T15:00:57.577
> 
> 标签：asp.net, .net, urlencode

Server.UrlEncode 和 HttpUtility.UrlEncode 有区别吗？

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2009-07-18T19:10:43.040

我以前对这些方法感到非常头疼，**我建议您*避免*使用的任何变体`UrlEncode`，而是使用[`Uri.EscapeDataString`](http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring.aspx)**- 至少该方法具有可理解的行为。

让我们来看看...

```
HttpUtility.UrlEncode(" ") == "+" //breaks ASP.NET when used in paths, non-
                                  //standard, undocumented.
Uri.EscapeUriString("a?b=e") == "a?b=e" // makes sense, but rarely what you
                                        // want, since you still need to
                                        // escape special characters yourself 
```

但我个人最喜欢的一定是**HttpUtility.UrlPathEncode** - 这东西真的是难以理解。它编码：

*   " " ==> "%20"
*   "100% true" ==> "100%%20true"（好的，你的网址现在坏了）
*   "测试 A.aspx#anchor B" ==> "测试%20A.aspx **#anchor%20B** "
*   "test A.aspx?hmm#anchor B" ==> "test%20A.aspx?hmm **#anchor B** "（*注意与前面转义序列的区别！*）

它还具有可爱的特定 MSDN 文档“对 URL 字符串的路径部分进行编码，以实现从 Web 服务器到客户端的可靠 HTTP 传输”。- 没有实际解释它的作用。你不太可能用 Uzi 开枪打自己的脚......

简而言之，坚持**[Uri.EscapeDataString](http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring.aspx)**。

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2009-03-02T15:03:07.027

`HttpServerUtility.UrlEncode`将在`HttpUtility.UrlEncode`内部使用。没有具体的区别。存在的原因`Server.UrlEncode`是与经典的 ASP 兼容。

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2017-12-18T22:49:02.680

自从第一次被问到这个问题已经快 9 年了，在 .NET Core 和 .NET Standard 的世界中，我们对 URL 编码最常见的选项似乎是**WebUtility.UrlEncode**（在 下`System.Net`）和**Uri.EscapeDataString**。从这里和其他地方最流行的答案来看，**Uri.EscapeDataString**似乎更可取。但是是吗？我做了一些分析以了解差异，这就是我想出的：

*   `WebUtility.UrlEncode`将空间编码为`+`; `Uri.EscapeDataString`将其编码为`%20`.
*   `Uri.EscapeDataString`百分比编码`!`, `(`, `)`, 和`*`; `WebUtility.UrlEncode`才不是。
*   `WebUtility.UrlEncode`百分比编码`~`；`Uri.EscapeDataString`才不是。
*   `Uri.EscapeDataString``UriFormatException`在超过 65,520 个字符的字符串上抛出 a ；`WebUtility.UrlEncode`才不是。（[一个比您想象的更常见的问题，尤其是在处理 URL 编码的表单数据时](https://github.com/dotnet/corefx/issues/1936)。）
*   `Uri.EscapeDataString``UriFormatException`在[高代理字符](https://msdn.microsoft.com/en-us/library/xcwwfbb8.aspx)上抛出一个；`WebUtility.UrlEncode`才不是。（这是 UTF-16 的东西，可能不太常见。）

出于 URL 编码的目的，字符属于 3 类之一： 未保留（在 URL 中是合法的）；保留（合法但具有特殊含义，因此您*可能*需要对其进行编码）；以及其他所有内容（必须始终进行编码）。

根据[RFC](https://www.rfc-editor.org/rfc/rfc3986#section-2)，保留字符是：`:/?#[]@!$&'()*+,;=`

并且未保留的字符是字母数字和`-._~`

## 判决

**Uri.EscapeDataString**明确定义了它的使命：%-编码所有保留和非法字符。**WebUtility.UrlEncode**在定义和实现上都比较模糊。奇怪的是，它编码了一些保留字符，但没有编码其他字符（为什么是括号而不是括号？？），更奇怪的是，它仍然编码了那个无辜的未保留`~`字符。

因此，我同意流行的建议 - 尽可能使用**Uri.EscapeDataString**，并理解保留字符`/`和`?`将被编码。如果您需要处理可能较大的字符串，尤其是 URL 编码的表单内容，则需要退回到**WebUtility.UrlEncode**并接受它的怪癖，或者以其他方式解决该问题。

* * *

**编辑：**我[试图](https://github.com/tmenier/Flurl/issues/262)通过、和static 方法纠正上述[Flurl中提到的所有怪癖。](https://flurl.io)这些在[核心包](https://www.nuget.org/packages/Flurl)中（很小，不包括所有的 HTTP 内容），或者随意从源代码中删除它们。我欢迎您对这些提出任何意见/反馈。`Url.Encode``Url.EncodeIllegalCharacters``Url.Decode`

* * *

这是我用来发现哪些字符编码不同的代码：

```
var diffs =
    from i in Enumerable.Range(0, char.MaxValue + 1)
    let c = (char)i
    where !char.IsHighSurrogate(c)
    let diff = new {
        Original = c,
        UrlEncode = WebUtility.UrlEncode(c.ToString()),
        EscapeDataString = Uri.EscapeDataString(c.ToString()),
    }
    where diff.UrlEncode != diff.EscapeDataString
    select diff;

foreach (var diff in diffs)
    Console.WriteLine($"{diff.Original}\t{diff.UrlEncode}\t{diff.EscapeDataString}"); 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-03-02T20:56:49.080

请记住，您可能不应该使用其中任何一种方法。Microsoft 的[Anti-Cross Site Scripting Library](https://www.microsoft.com/en-au/download/details.aspx?id=28589)包括更符合标准且更安全的`HttpUtility.UrlEncode`替代品。`HttpUtility.HtmlEncode`作为奖励，您还可以获得一种`JavaScriptEncode`方法。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-02T15:11:36.850

Server.UrlEncode() 用于提供与经典 ASP 的向后兼容性，

```
Server.UrlEncode(str); 
```

相当于：

```
HttpUtility.UrlEncode(str, Response.ContentEncoding); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-02T15:05:51.933

同样，`Server.UrlEncode()`调用`HttpUtility.UrlEncode()`

# java - 如何在 Linux 上设置类路径？

> ID：602651
> 
> 赞同：2
> 
> 时间：2009-03-02T15:02:30.740
> 
> 标签：java, linux

我需要标题中问题的答案。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T15:08:40.180

```
export CLASSPATH=/your/stuff/ 
```

或保留系统范围的设置：

```
export CLASSPATH=$CLASSPATH:/your/addition/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T15:04:02.233

这是我通过谷歌找到的两个很好的教程：

[http://www.linuxheadquarters.com/howto/basic/classpath.shtml](http://www.linuxheadquarters.com/howto/basic/classpath.shtml)
[http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/classpath.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/classpath.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T15:11:58.783

If you mean the *Java classpath* (from your tag), then this is only different from Windows in terms of path-separators (: instead of ;). For example

```
java -classpath /mydir/mylib.jar:/otherdir/otherlib.jar com.MyProgram -Xmx64m 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T15:13:25.393

I don't think you should have a system classpath environment variable on Linux or any other operating system.

Each and every project should have its own classpath settings. They're usually set by scripts or convention, so there's no need for a system environment variable.

Besides, what would you do if two projects had conflicting JARs required?

Will that environment classpath include every JAR needed by every project on your machine? That's not practical.

A classpath environment variable might have been the standard with Java 1.0, but I don't think it should be now.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T15:17:28.410

Create a small shell script which sets the classpath:

```
#!/bin/bash
export JAVA_HOME=...

cp=$(find lib -name "*.jar" -exec printf :{} ';')
if [[ -n "$CLASSPATH" ]]; then
    cp="$cp;CLASSPATH"
fi

"$JAVA_HOME/bin/java" -classpath "$cp" ... 
```

# sharepoint - Sharepoint+RtWebParts 如何处理时区？

> ID：602656
> 
> 赞同：3
> 
> 时间：2009-03-02T15:03:45.510
> 
> 标签：sharepoint, timezone

我想将一些 OSIsoft RtWebParts 添加到 Sharepoint 页面。我希望这些趋势在不同的时区为不同的用户显示。我发现它们总是显示在 EDT 中。

理想情况下，我想要一个按页面或按用户配置呈现的时区的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:22:22.210

OSIsoft 的官方回应是：**这做不到**。

RtWebparts 对象*始终*使用托管它们的*Sharepoint 站点的时区。*时期。

除了为您关心的每个时区创建一个新的共享点站点之外，还有一个没有吸引力的解决方法：

1.  在 ProcessBook 中创建显示，您可以在其中根据需要配置时间偏移
2.  在 RtActiveView Web 部件中包含 ProcessBook PDI 文件
3.  对每个时区重复

您仍然坚持使用一个时区（在 SVG 中设置），但现在至少您可以在没有多个服务器的情况下获得多个时区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-16T21:47:16.803

迈克尔，

我是 OSIsoft 的 RtWebParts 产品经理。

时区由 SharePoint 网站而非 Web 服务器控制。一种可能的解决方法是为您希望支持的每个时区创建一个 SP 站点。不幸的是，您将面临维护多个站点的内容的挑战。

我还想对上述解决方法进行更正。解决方法应使用 RtActiveView Web 部件（使用 ProcessBook .pdi 文件），而不是 RtGraphic（使用 ProcessBook .svg 文件）。

谢谢，塔玛拉

# c++ - 计算单色 BMP 的 BITMAPINFOHEADER biCompression 值

> ID：602663
> 
> 赞同：0
> 
> 时间：2009-03-02T15:05:45.677
> 
> 标签：c++, windows, winapi, bitmap

希望有人有答案，而且不是太复杂。我正在研究一个 C++ dll（没有 C# 或 .Net，完全静态的 DLL）。

无论如何，它在内置单色位图上工作。除了决议，我所有的一切都在工作。我得到设备上下文，获取兼容的设备上下文，构建位图，绘制我需要的东西（黑色/白色），并且可以保存。这一切都很好。但是，我不知道如何设置位图的分辨率。

在 C# 下从另一个实用程序进行一些测试时，我可以创建一个位图并设置分辨率。在这样做的过程中，我运行了一个例程来生成相同的文件内容，其参数从 1 到 300 用于分辨率。除了“biCompression”DWORD 属性中的值之外，每个图像的输出完全相同。默认是96x96的屏幕分辨率，但是对于300x300的打印机需要明显改变，甚至有些是203x203的分辨率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T16:05:08.110

您确定不想设置`biXPelsPerMeter`and`biYPelsPerMeter`吗？这两个字段告诉您 X 和 Y 中每米有多少像素，您可以使用它们来设置 DPI。`biCompression`只处理位图的压缩类型，如RLE、JPG、PNG等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:21:18.183

Are you absolutely sure? The description of the behavior you observe sounds fishy to me and I would suspect the code that you're using to write your bitmaps or your code that reads them back in.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T01:08:24.450

感谢您的输入，但我也会研究 biXPelsPerMeter 和 biYPels ...。我会仔细检查格式，以及设置的内容......如果是这样，你可能已经对我的问题有了第二组眼睛（头脑）。

谢谢

# php - 如何让 Flash 共享浏览器 cookie/会话？

> ID：602665
> 
> 赞同：3
> 
> 时间：2009-03-02T15:06:23.210
> 
> 标签：php, flash, session

我正在构建一个基于 PHP 的 Web 应用程序，并且正在集成一个基于 Flash 的图表引擎。Flash 图表需要对其数据进行 AJAX 请求。此请求失败，因为它被视为新的用户代理并且不包含用于识别它的 PHP 会话 cookie。因此，它被重定向到登录页面。

我已经阅读了一些技巧来完成这项工作，包括在查询字符串上提供会话 ID，但这会带来安全漏洞。如何让 Flash 和 PHP 自动共享基于 cookie 的会话状态并保持安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T20:53:52.080

在 IE 中它会天真地工作。在 Firefox 中，实现此目的的唯一方法是将会话 ID 发布到 flash 脚本（即 php 处理器）中，并让它从中恢复会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T06:43:41.327

您应该知道，在 Cookie: 标头或 GET HTTP 指令的参数字段中传输会话 ID 的安全性没有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:24:03.883

如果会话 cookie 启动得足够早，那么应该没问题。我在 JavaScript AJAX 和 Flash 请求之间共享 cookie 时遇到了类似的问题（如果您也想调用该 AJAX，请继续 :-)），我们通过确保 JavaSCript 完成早期启动 cookie 的请求来解决它们足以让当 Flash 发送请求时，浏览器已经有了会话 cookie。

确保 cookie 路径设置为“/”也是一个好主意。

话虽如此，如果你不能让它工作——正如俗话说的那样——你可以使用 JavaScript AJAX 调用将信息存储在 HTML DOM 中，然后使用 ExternalInterface 调用从 Flash 对象中获取它。但请确保在您的 Flash 对象上至少设置“allowScriptAccess=sameDomain”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T15:14:52.223

Use `ExternalInterface` to talk to the Flex chart. Some browser related information can be passed around via the `LoaderContext` and `BrowserManager` classes as well. Dig in a bit into the AS3 documentation.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-05T22:24:54.817

您可以尝试将 php 2 参数发送到一个 session_id 和第二个参数，它是一个组合来自客户端（前 ip）的一些信息的密钥，并使用存储在服务器上的密钥和来自闪存的请求对其进行加密，您检查查看第二个参数匹配客户端请求，这样如果有人试图做一个会话窃取他们不能，因为他们不会匹配第二个参数

# html - 在有序列表的列表项中嵌套列表项？

> ID：602667
> 
> 赞同：5
> 
> 时间：2009-03-02T15:06:40.013
> 
> 标签：html, css, html-lists

我试图弄清楚如何创建一个当前针对 IE6 和 IE7 的递增有序列表。

EG 它应该呈现如下内容：

```
1.0
    1.1
    1.2
    1.3
2.0
    2.1
    2.2 
```

据我了解，这可以在 CSS 中创建，如下所示：

```
UL, OL { counter-reset: item; }
LI { display: block }
LI:before { content: counters(item, "."); counter-increment: item } 
```

但是，当然，IE6 和 IE7 不支持这一点。

哪些选项可用于在 IE6/7 中创建适当的递增列表？我是否不得不硬编码这个。？不幸的是，使用 JavaScript 不是一种选择。

是否有适用于较新浏览器的更新方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:27:24.613

XSLT（包括 XSLT 1.0）可以使用`<xsl:number>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:51:37.643

这是一个纯 CSS 的解决方案（应该在 IE8 及更高版本中工作）：

```
<ol>
    <li>
        Heading
        <ol>
            <li>list</li>
            <li>list</li>
        </ol>
    </li>
    <li>
        Heading
        <ol>
            <li>list</li>
            <li>list</li>
        </ol>
    </li>
</ol>

ol{
    list-style-position:inside;
    list-style-type: none;
    counter-reset:mainNum;
}

ol li:before{
    content: counter(mainNum) ".0";
    counter-increment:mainNum;
}

ol ol{
    counter-reset:item;
}

ol ol li{
    list-style-type:none
}

ol ol li:before{
    content: counter(mainNum) "." counter(item) "  ";
    counter-increment:item;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T15:26:29.917

如果 JavaScript 不是一个选项，您将不得不在服务器端对其进行硬编码/实现。

积极的一面是：它将立即适用于其他功能较弱的用户代理/设备（想想黑莓浏览器等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T15:23:42.170

If javascript is not an option (and therefore also I assume no flash), I'm sorry to say you're out of options for a client-side solution. If you have a server-side script that is generating your HTML, you can push the ordering to the server and simply style the output on the client using CSS as an unordered-list with no bullet. IE6 is your limiting factor here, and there aren't many ways around that. Sorry to be the bearer of bad news.

# windows - 您将如何以编程方式测试文件中的病毒？

> ID：602670
> 
> 赞同：5
> 
> 时间：2009-03-02T15:07:33.553
> 
> 标签：windows, antivirus

我想以编程方式测试文件中的病毒。

我知道[这个线程](https://stackoverflow.com/questions/446999/is-there-any-anti-virus-product-which-provides-a-net-or-com-api)，我认为它没有得到令人满意的答案，但我不是在这里寻找 API。任何可以测试文件的解决方法都可以。

当然，API 可能是最好的解决方案（我在 Windows 平台上使用 .net），但也许可以将文件放到文件夹中，然后检查我是否仍然可以打开它或者它是否已经打开被杀毒软件隔离。

有人遇到过同样的情况吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T15:57:35.350

假设您希望与系统上已经存在的任何防病毒软件集成，而不是捆绑您自己的，您应该查看 Firefox 3 执行此操作的方式。

> 错误 103487 和 408153 - 当 Firefox 下载可执行文件时通知防病毒软件（使用 Windows“ [IOfficeAntiVirus](http://msdn.microsoft.com/en-us/library/ms537365%28VS.85%29.aspx) ”和“IAttachmentExecute”API）。

（当然，如果您想捆绑自己的，请查看 ClamAV/ClamWin，但随后您必须处理更新等，您可能应该首先检查目标系统上没有完全更新的解决方案以示礼貌）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T15:28:35.357

视窗？没问题。查看[ClamWin](http://www.clamwin.com)。它基于 ClamAV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-31T15:58:19.057

您可以使用调试器或反汇编器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T15:28:40.770

也许你可以使用这个网络服务，假设文件小于 1MB：

[http://www.kaspersky.com/scanforvirus](http://www.kaspersky.com/scanforvirus)

> 如果您在计算机上发现可疑文件，或者怀疑您从 Internet 下载的程序可能是恶意的，您可以在此处查看这些文件。
> 
> 指明要检查的文件；它将自动从您的计算机上传到专用服务器，然后使用卡巴斯基反病毒软件对其进行扫描。多项独立测试和出版物承认该解决方案具有出色的检测率。每三个小时更新一次，确保即使是最新的病毒也能被检测到。
> 
> 一次只能检查一个最大为 1 MB 的文件。如果文件太大，将显示一个带有错误消息的窗口。在本页顶部的窗口中键入文件名，或使用“浏览”查找文件。然后点击“提交”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T15:12:14.633

Platform?

Most Windows anti-virus provide shell integration (right click on a file in explorer to scan that file), which will either mean running an executable, DDE or COM. All of which provide an entry point to another program to call the same mechanism.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T15:15:52.470

Check out [ClamAV](http://www.clamav.net/).

> Clam AntiVirus is an open source (GPL) anti-virus toolkit for UNIX, designed especially for e-mail scanning on mail gateways.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T15:25:16.490

这实际上取决于您要使用的 AV 程序。阅读您选择的任何解决方案的文档，您可能会找到一个命令行界面或其他一些您可以调用的 API。没有“通用”的方式来做到这一点（跨 AV）。

# sql - 以编程方式检测 SQL Server 版本

> ID：602677
> 
> 赞同：8
> 
> 时间：2009-03-02T15:10:26.150
> 
> 标签：sql, sql-server, smo

我将 C# 与 SMO 一起使用，并尝试检测我正在连接的 SQL Server 版本（例如，企业版、标准版）。我知道如何获取版本信息，但这只能告诉我 SQL Server 的版本（例如，SQL Server 2008 与 SQL Server 2005）。

有谁知道如何获得实际的产品版本（例如，企业版、标准版）？

我需要此信息，因为某些 SQL Server 功能仅适用于企业。因此，我可以尝试调用它们并捕获异常，但我更喜欢预先检测。

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-02T15:19:28.953

```
SELECT  SERVERPROPERTY('productversion'), 
        SERVERPROPERTY ('productlevel'), 
        SERVERPROPERTY ('edition') 
```

在我的系统返回

```
9.00.1399.06, RTM, Express Edition 
```

似乎这种技术只适用于 SQL Server 2000 或更高版本，如果您的任何数据库是 7.0 或更低版本，您将不得不使用 @@Version 并按照其他人发布的那样操作结果

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-02T15:22:11.363

看起来您可以通过 SMO 和 Server 对象来做到这一点。有像 Information.Edition 这样的属性，看起来它应该做你想做的事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T15:15:11.413

我一直使用@@Version（例如 SELECT @@Version 并在代码中处理结果），但这篇文章看起来很方便； [http://support.microsoft.com/kb/321185](http://support.microsoft.com/kb/321185)

根据链接，使用 SERVERPROPERTY 的唯一问题是……这不适用于旧版本的 SQL Server。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T15:15:26.077

```
select @@version 
```

返回版本和哪个版本。这里：

```
Microsoft SQL Server 2005 - 9.00.4035.00（英特尔 X86）
    2008 年 11 月 24 日 13:01:59
    版权所有 (c) 1988-2005 Microsoft Corporation
    Windows NT 5.2 上的开发人员版（内部版本 3790：Service Pack 2）

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-21T11:38:15.277

检查注册表。这个问题有一个很好的方法，你可以从 PowerShell 脚本中调整：

[如何使用 Powershell 检查 SQL Server 版本？](https://stackoverflow.com/questions/7587077/how-do-i-check-for-the-sql-server-version-using-powershell)

# jquery - 如何在 Windows 上的 Firefox 中停止 Flash 内容透亮 jQuery UI 对话框

> ID：602678
> 
> 赞同：7
> 
> 时间：2009-03-02T15:11:13.823
> 
> 标签：jquery, windows, flash, internet-explorer, firefox

我正在使用 jQuery UI 对话框，在 Windows 上的 IE 和 FF 中，我正在通过对话框获取底层 Flash 内容。

我在 IE 上通过启用`bgiframe`jQuery 对话窗口上的选项并更改`bgiframe`脚本以应用于任何 Windows 浏览器解决了这个问题，但是我仍然在 FF 上得到了启发。

请注意，我无法确切知道 Flash 内容将显示在哪里，因为它通常是用户添加到页面中的 Flash 小部件，尽管我曾考虑在显示对话框时暂时隐藏 Flash 内容 - 这是剩下的唯一选项吗对我来说？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T22:32:20.190

试试`wmode=transparent`or`wmode=opaque`参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-17T16:48:26.927

```
<object ...>
  ...
  <param name="wmode" value="opaque" />
  ...
  <embed ... wmode="opaque" ...></embed>
</object> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T06:01:21.800

我曾经遇到过类似的问题。我只是隐藏闪光灯并在对话框关闭时再次显示它：

```
<script type="text/javascript">
    /*notification dialog setup*/
        function SetupDialog()
        {
            $("div#divNotice").dialog(
                {  autoOpen: false,
                   modal: true,
                   overlay: { opacity: 0.5, background: '#050505' },
                   buttons: {
                              "I Agree": function(){
                                            $("#Movie").css("display","inline")//Show movie when dialog is closed
                                            .......
                                        },
                              "Close" : function(){
                                            $("#Movie").css("display","inline") //Show Movie if dialog is closed
                                            $(this).dialog("close");
                                        }
                            },
                   title: "",
                   height: 500,
                   width: 600,
                   dialogClass: 'myDialog',
                   position: 'center'
                 }
            );
        }
    </script>
    <script type="text/javascript">
    function ShowDialog()
    {
        /*for Notice dialog */
        $("#divDialog").css("display","block");
        $("#Movie").css("display","none");
        $("div#divDialog").dialog("open");
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-30T09:18:45.557

jquery ui 对话框使用一个名为 jquery-ui-xxcss 的 css 文件，其中 xx 表示版本

在这个文件中你可以给 .ui-dialog 类 overflow:auto; 这将解决问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-08T00:54:43.570

请注意，更改 Flash 动画的 wmode 会严重增加机器的 CPU 负载并减慢动画速度。Flash 播放器在浏览器窗口顶部使用自己的窗口是有充分理由的。当 wmode 设置为 opaque 时，Flash 会被强制渲染到浏览器窗口中。使用 wmode=transparent 它甚至必须将其渲染与现有的浏览器阶段内容合并。

我通常使用许多灯箱脚本也使用的相同技术：只要对话框可见，就将所有 Flash 电影切换为不可见。这不应该通过设置 display:none 来完成。如果 Flash 矩形不再在舞台上，结果可能会在页面的其余部分中移动内容。出于同样的原因，您不应该使用 jQueries hide() 方法。相反，使用可见性：隐藏仍然占据隐藏元素的空间。

这是我的做法：

```
$('#myDialogId').dialog({
    open: function(){
        // hide any flash objects
        $('object').css('visibility', 'hidden');
        // hide any flash embeds
        $('embed').css('visibility', 'hidden');
    },
    close: function(){
        // show any flash objects
        $('object').css('visibility', 'visible');
        // show any flash embeds
        $('embed').css('visibility', 'visible');
        //
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T15:16:34.280

在对话框中使用 iFrame 或在触发对话框时隐藏页面上的 Flash 内容。

# sql-server - Migrating MOSS 2007 from SQL 2000 to SQL 2005 - Addendum

> ID：602686
> 
> 赞同：0
> 
> 时间：2009-03-02T15:13:00.917
> 
> 标签：sql-server, sql-server-2005, sharepoint, sharepoint-2007

This is a continuation of an earlier question I had about moving the databases for a MOSS 2007 installation from SQL 2000 to SQL 2005\. Here's the URL for the original question: [Migrating MOSS 2007 from SQL 2000 to SQL 2005](https://stackoverflow.com/questions/254517/migrating-moss-2007-from-sql-2000-to-sql-2005)

In my test environment, I've successfully moved the databases to the SQL 2005 test machine and things appear to be working fine. But, on the "Servers in Farm" page of the Central Admin | Operations, it still shows the old (i.e. SQL 2000) server as the Configuration Database Server. Also, it shows the old config database as being the Configuration Database. I know that the SQL2000 server and old config database (that are showing on this page) are NOT being used, because we've deactived the SQL instance in SQL2000.

I've tried "removing" the server, and get a message about "Uninstalling SharePoint products and technologies" being the better route. So, I disconnected from the test databases, uninstalled SharePoint from the test WFE server, and reinstalled it. That didn't do anything. Before uninstalling/reinstalling I also tried simply rerunning the SharePoint Configuration wizard, and that didn't do anything either.

Does anyone know how to update the Config Server and Config Database on the "Servers in Farm" page after having moved the Config and Content DBs? Is there something I'm missing or overlooking?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T15:25:31.450

```
stsadm setconfigdb 
```

?

```
stsadm -help setconfigdb 
```

显示：

```
stsadm.exe -o setconfigdb
           [-连接]
           -数据库服务器
           [-数据库用户]
           [-数据库密码]
           [-数据库名称 ]
           [-hh]
           [-创作]
           [-addomain]
           [-阿杜]

```

另请参阅[Technet](http://technet.microsoft.com/en-us/library/cc261712.aspx)，它说 PSConfig 已取代 stsadm。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T18:05:13.293

嘿，我完全理解你的问题。您已将配置数据库从以前的 sql server 移动到新的 sql server。让我在这篇文章中非常清楚地说明一件事，即配置数据库不能移动到另一个 sql server。

因此，您需要运行 psconfig 并断开与当前场的连接。再次运行 psconfig 并创建一个新的服务器场。完成后，创建新的 Web 应用程序/应用程序，然后将站点内容数据库/数据库附加回它们。这是使用新的 sql 服务器正确恢复您的场的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-04T17:29:15.260

我们发现的最佳方法是使用 SQL 客户端或 SQL 服务器的 DNS 别名，以便您可以轻松地将 SP 数据库移动到新服务器，只需更新别名以指向新服务器。在您的情况下，您可以尝试以下步骤，服务器名称已更改以保护无辜者。在这种情况下，您将需要具有相同的实例名称（或使用默认名称）并且可能需要相同的端口。

*   关闭 SharePoint 服务
*   将旧 SQL 服务器从 SQL2000 重命名为 SQL2000OLD
*   创建一个名为 SQL2000 的 DNS CNAME 记录，该记录指向名为 SQL2005 的新服务器
*   从 SQL2000 到 SQL2005 分离/附加或备份/恢复所有数据库
*   在 SharePoint 服务器上 Ping SQL2000 以确保它解析为 SQL2005，如果没有，则运行“ipconfig /flushdns”并重复测试，直到它解析为新服务器
*   备份 SharePoint 服务，应使用 DNS 别名连接到新服务器

# java - 处理 AWT 图形上下文的最佳方法是什么？

> ID：602688
> 
> 赞同：4
> 
> 时间：2009-03-02T15:14:08.730
> 
> 标签：java, swing, graphics, awt

我们的 Swing 应用程序的一些用户报告了显示屏上出现的奇怪伪影。这包括组件在一两秒钟内没有正确地重新绘制自身，直到应用程序的整个部分被重新绘制，就像窗口区域的平铺墙纸一样。

在五年左右的时间里，从经验丰富的 Java 小伙到刚从大学毕业的年轻小伙子，各个级别的开发人员都在开发该应用程序，正如您所料，一些 AWT 代码完全是一团糟。我现在面临的任务是在接下来的几个月左右的时间里尽可能多地纠正错误。

其中一些很容易处理。仅在事件调度线程上处理组件，异步 IO 之类的事情，我希望将消息传递给团队的其他成员。

我想知道的是处理图形上下文的最佳方式，尤其是在paintComponent() 上下文中。我看到很多...

```
public void paintComponent( Graphics g ) {
    super.paintComponent( g );
    Graphics2D gfx = (Graphics2D)g;
    // ...Whole lotta drawing code...
} 
```

这样做更好吗？

```
public void paintComponent( Graphics g ) {
    super.paintComponent( g );
    Graphics2D gfx = (Graphics2D)g.create();
    // ...Whole lotta drawing code...
    gfx.dispose();
} 
```

如果 g 参数要在其他绘画中重复使用，那么我不需要将其恢复到良好状态，撤消 AffineTransforms 等吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T15:41:21.817

根据肮脏的富客户端的说法，您不应该更改`Graphics`传递给您的对象（这很糟糕，因为 API，IMO）。

处理它的正确方法稍微冗长：

```
public void paintComponent(Graphics g1) {
    super.paintComponent(g1);
    final Graphics2D g = (Graphics2D)g1.create();
    try {
         // ...Whole lotta drawing code...
    } finally {
         g.dispose();
    }
} 
```

IIRC，在 Sun 实现中，如果您不处理“子图形”对象并不重要。（不要引用我的话。）

您可能希望将该注释位委托给另一个对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-02T15:21:37.933

听说jdk-1.6.12已经修复了这个，但是没试过。

# c# - 具有返回类型的 try-catch 块

> ID：602699
> 
> 赞同：15
> 
> 时间：2009-03-02T15:18:04.103
> 
> 标签：c#, error-handling

如果我有一个返回某些东西的方法，比如

```
public DataTable ReturnSomething()
{
   try
   {  
      //logic here
     return ds.Tables[0];
   }
   catch (Exception e)
   {
      ErrorString=e.Message;
   }
} 
```

这会产生编译器错误，显然是因为`catch{}`block 不返回任何内容。

因此，当我有返回值的方法时，我不使用 try-catch 块，这是一种不好的做法。如果有错误，我想将错误字符串设置为该错误。但是我也需要一个返回值。建议？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-02T15:22:26.947

将您的返回值存储在一个临时变量中，如下所示：

```
public DataTable ReturnSomething()
{
    DataTable returnValue = null;

    try
    {
        //logic here
        returnValue = ds.Tables[0]; 
    }
    catch (Exception e)
    {
        ErrorString=e.Message;
    }

    return returnValue;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-02T15:19:37.347

您应该在 catch 块中引发/抛出异常并在调用方法中处理它。

```
public void invokeFaultyCode()
{
    try
    {
        DataTable dt = ReturnSomething();
    }
    catch(Exception e)
    {
        // Print the error message, cleanup, whatever
    }    
}
public DataTable ReturnSomething() throws Exception
{
   try
   {  
      //logic here
     return ds.Tables[0];
   }
   catch (Exception e)
   {
      ErrorString=e.Message;
      throw;
   }
} 
```

PS：抱歉有任何语法错误，我对 C# 有点生疏。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-02T15:21:25.203

你应该用 try catch 包装调用者......在被调用的例程中发生的任何异常都会冒泡到调用者，你可以在那里捕获它们。

就个人而言，我认为在此例程中尝试捕获是过大的，因为您应该让调用者处理异常。

对于我的例子，这将被编码如下......

```
private void DoSomething() {
    try {
        DataTable dt = ReturnSomething();
    }
    catch (Exception ex) {
    }    
}

public DataTable ReturnSomething() {
    DataTable dt = new DataTable();

    // logic here
    return dt;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-02T15:36:11.160

ErrorString 变量看起来很像错误代码变量。推荐的做法是在必要时使用异常直接传递错误信息，而不是将内容存储到错误代码中。

您实际上对 ErrorString 做了同样的事情，就像您只是让调用者捕获异常一样：从方法本身移除响应错误的责任。这是一个很好的目标。但是使用错误字符串不会比使用异常获得任何好处。事实上，您会以这种方式丢失信息。可能会发生多种类型的错误，并且许多都有与之相关的特殊异常，它们具有自己的特殊属性来保存有关故障的上下文信息。通过将消息存储在字符串中，您将丢失此信息。

因此，除非您的目标是专门隐藏调用者正在发生的错误类型，否则您只能通过让异常通过来获得收益。

要考虑的另一件事是这是否真的是一个错误场景。如果是，那么您的调用方法就不太可能关心返回值是什么。在这种情况下，您无需担心，只需让异常消失而不返回任何内容。如果这不是一个真正的错误场景，而调用者只是继续做其他事情，那么那是由调用者决定的，对吧？通过返回错误字符串和虚拟 DataTable 或 null 仍然没有太多好处，而不是抛出带有所有上下文失败信息的异常。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T15:25:25.600

如果您打算采用“不要抛出异常路线”（我不一定推荐），您可以遵循 MS 使用的 TryParse 方法。

就像是：

```
private string FillDataTable(out DataTable results)
{

  try
{
  results = new DataTable(); //something like this;
  return String.Empty;
}
catch (Exception ex)
{
  results = null;
 return ex.Message;

} 
```

}

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T15:20:56.077

这取决于您的应用程序。您可以 return `null`，一个空的`DataTable`或任何情况下合适的东西。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T15:23:50.113

我假设您仍然可以设置消息，然后返回 null 或任何 c# 等效项

```
public DataTable ReturnSomething(){ 
   try {
        //logic here 
        return ds.Tables[0]; 
   } catch (Exception e) {
        ErrorString=e.Message;
        return null;
   }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T15:23:51.080

这个怎么样 ：

```
public DataTable ReturnSomething(out string errorString)
{
   errorString = string.Empty;
   DataTable dt = new DataTable();
   try
   {  
      //logic here
     dt = ds.Tables[0];
   }
   catch (Exception e)
   {
      errorString = e.Message;
   }
   return dt;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T15:23:02.860

由于您在示例中捕获了异常（而不是再次抛出），因此外部代码假定一切正常，因此您应该返回一些有用的东西。

如果你需要在那里捕获异常并做一些事情，那一切都很好，但如果它仍然是一个错误情况，你也应该抛出它，或者一个不同的异常，也许是你刚刚作为 InnerException 捕获的那个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T15:22:38.663

我认为您的代码在调用堆栈的足够高级别上运行，并且与 UI 代码混合在一起。如果确实如此，您可以`return null`在 catch 块中。但是，如果您正在编写可重用代码，则应重构它，使其不包含 UI 操作并在调用堆栈中的更高级别处理异常。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-14T11:18:39.857

您可以像下面的示例代码一样进行操作。

```
public DataTable ReturnSomething(out string OutputDesc)
{
   try
      {
         //logic here
         OutputDesc = string.Format("Your Successful Message Here...");
         return ds.Tables[0];
      }
      catch (Exception e)
      {
         OutputDesc =e.Message;
         return null;
      }

} 
```

# bash - 使用 Bash 批量重命名文件

> ID：602706
> 
> 赞同：115
> 
> 时间：2009-03-02T15:20:44.830
> 
> 标签：bash, shell, file-rename

Bash 如何重命名一系列包以删除它们的版本号？我一直在玩弄`expr`和`%%`，但无济于事。

例子：

`Xft2-2.1.13.pkg`变成`Xft2.pkg`

`jasper-1.900.1.pkg`变成`jasper.pkg`

`xorg-libXrandr-1.2.3.pkg`变成`xorg-libXrandr.pkg`

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-03-02T15:33:46.907

您可以使用 bash 的参数扩展功能

```
for i in ./*.pkg ; do mv "$i" "${i/-[0-9.]*.pkg/.pkg}" ; done 
```

带空格的文件名需要引号。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-02T15:54:22.097

如果所有文件都在同一目录中，则顺序

```
ls | 
sed -n 's/\(.*\)\(-[0-9.]*\.pkg\)/mv "\1\2" "\1.pkg"/p' | 
sh 
```

会做你的工作。*sed*命令将创建一系列*mv*命令，然后您可以将其通过管道传输到 shell。最好先运行不带尾随的管道`| sh`，以验证该命令是否符合您的要求。

要通过多个目录进行递归，请使用类似

```
find . -type f |
sed -n 's/\(.*\)\(-[0-9.]*\.pkg\)/mv "\1\2" "\1.pkg"/p' |
sh 
```

请注意，在*sed*中，正则表达式分组序列是括号前面有反斜杠 `\(`和`\)`，而不是单括号`(`和`)`。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-02T15:35:54.687

我会做这样的事情：

```
for file in *.pkg ; do
    mv $file $(echo $file | rev | cut -f2- -d- | rev).pkg
done 
```

假设您的所有文件都在当前目录中。如果没有，请尝试按照 Javier 上面的建议使用 find 。

**编辑**：此外，此版本不使用任何特定于 bash 的功能，就像上面的其他功能一样，这会导致您获得更多的可移植性。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-03-11T01:50:21.803

我们可以假设`sed`在任何 *nix 上都可用，但我们不能确定它是否支持`sed -n`生成 mv 命令。（**注意：**只有 GNU`sed`这样做。）

即便如此，使用 bash 内置函数和 sed，我们可以快速启动一个 shell 函数来执行此操作。

```
sedrename() {
  if [ $# -gt 1 ]; then
    sed_pattern=$1
    shift
    for file in $(ls $@); do
      mv -v "$file" "$(sed $sed_pattern <<< $file)"
    done
  else
    echo "usage: $0 sed_pattern files..."
  fi
} 
```

# 用法

```
sedrename 's|\(.*\)\(-[0-9.]*\.pkg\)|\1\2|' *.pkg

before:

./Xft2-2.1.13.pkg
./jasper-1.900.1.pkg
./xorg-libXrandr-1.2.3.pkg

after:

./Xft2.pkg
./jasper.pkg
./xorg-libXrandr.pkg 
```

# 创建目标文件夹：

由于`mv`不会自动创建目标文件夹，因此我们无法使用初始版本的`sedrename`.

这是一个相当小的变化，因此最好包含该功能：

我们需要一个实用函数`abspath`（或绝对路径），因为 bash 没有这个内置函数。

```
abspath () { case "$1" in
               /*)printf "%s\n" "$1";;
               *)printf "%s\n" "$PWD/$1";;
             esac; } 
```

一旦我们有了它，我们就可以为包含新文件夹结构的 sed/rename 模式生成目标文件夹。

这将确保我们知道目标文件夹的名称。当我们重命名时，我们需要在目标文件名上使用它。

```
# generate the rename target
target="$(sed $sed_pattern <<< $file)"

# Use absolute path of the rename target to make target folder structure
mkdir -p "$(dirname $(abspath $target))"

# finally move the file to the target name/folders
mv -v "$file" "$target" 
```

这是完整的文件夹感知脚本...

```
sedrename() {
  if [ $# -gt 1 ]; then
    sed_pattern=$1
    shift
    for file in $(ls $@); do
      target="$(sed $sed_pattern <<< $file)"
      mkdir -p "$(dirname $(abspath $target))"
      mv -v "$file" "$target"
    done
  else
    echo "usage: $0 sed_pattern files..."
  fi
} 
```

当然，当我们也没有特定的目标文件夹时，它仍然有效。

如果我们想将所有歌曲放入一个文件夹，`./Beethoven/`我们可以这样做：

# 用法

```
sedrename 's|Beethoven - |Beethoven/|g' *.mp3

before:

./Beethoven - Fur Elise.mp3
./Beethoven - Moonlight Sonata.mp3
./Beethoven - Ode to Joy.mp3
./Beethoven - Rage Over the Lost Penny.mp3

after:

./Beethoven/Fur Elise.mp3
./Beethoven/Moonlight Sonata.mp3
./Beethoven/Ode to Joy.mp3
./Beethoven/Rage Over the Lost Penny.mp3 
```

# 奖金回合...

使用此脚本将文件从文件夹移动到单个文件夹中：

假设我们想收集所有匹配的文件，并将它们放在当前文件夹中，我们可以这样做：

```
sedrename 's|.*/||' **/*.mp3

before:

./Beethoven/Fur Elise.mp3
./Beethoven/Moonlight Sonata.mp3
./Beethoven/Ode to Joy.mp3
./Beethoven/Rage Over the Lost Penny.mp3

after:

./Beethoven/ # (now empty)
./Fur Elise.mp3
./Moonlight Sonata.mp3
./Ode to Joy.mp3
./Rage Over the Lost Penny.mp3 
```

# sed 正则表达式模式的注意事项

正则 sed 模式规则适用于此脚本，这些模式不是 PCRE（Perl 兼容正则表达式）。 您可以根据您的平台使用`sed -r`或使用 sed 扩展的正则表达式语法。`sed -E`

有关 sed 基本和扩展正则表达式模式的完整描述，请参阅 POSIX 兼容`man re_format`。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-03-04T19:41:55.443

[这是与当前接受的答案](https://stackoverflow.com/a/602770/874188)几乎等效的 POSIX 。这将 Bash-only`${variable/substring/replacement}`参数扩展换成了任何 Bourne 兼容 shell 中可用的参数扩展。

```
for i in ./*.pkg; do
    mv "$i" "${i%-[0-9.]*.pkg}.pkg"
done 
```

参数扩展`${variable%pattern}`产生的值带有删除`variable`匹配的任何后缀。`pattern`（还有`${variable#pattern}`要删除前缀。）

我保留了`-[0-9.]*`已接受答案的子模式，尽管它可能具有误导性。它不是正则表达式，而是全局模式；所以它并不意味着“一个破折号后跟零个或多个数字或点”。相反，它的意思是“一个破折号，后跟一个数字或一个点，然后是任何东西”。“任何东西”将是最短的匹配，而不是最长的匹配。（Bash 提供`##`并`%%`用于修剪可能的最长前缀或后缀，而不是最短的。）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-08-22T09:05:25.937

我发现重命名是用于此类事情的更直接的工具。我在 OSX 的 Homebrew 上找到了它

对于您的示例，我会这样做：

```
rename 's/\d*?\.\d*?\.\d*?//' *.pkg 
```

's' 表示替代。形式是 s/searchPattern/replacement/files_to_apply。您需要为此使用正则表达式，这需要一些研究，但值得付出努力。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T15:30:15.150

更好地使用`sed`它，例如：

```
find . -type f -name "*.pkg" |
 sed -e 's/((.*)-[0-9.]*\.pkg)/\1 \2.pkg/g' |
 while read nameA nameB; do
    mv $nameA $nameB;
 done 
```

找出正则表达式作为练习（与处理包含空格的文件名一样）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T15:33:35.907

假设这似乎有效

*   一切都以 $pkg 结尾
*   你的版本号总是以“-”开头

剥离.pkg，然后剥离-..

```
for x in $(ls); do echo $x $(echo $x | sed 's/\.pkg//g' | sed 's/-.*//g').pkg; done 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-11-05T17:22:40.543

我有多个`*.txt`文件要重命名为`.sql`同一个文件夹。以下为我工作：

```
for i in \`ls *.txt | awk -F "." '{print $1}'\` ;do mv $i.txt $i.sql; done 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-30T08:53:22.487

谢谢你的回答。我也遇到了一些问题。将 .nzb.queued 文件移动到 .nzb 文件。它的文件名中有空格和其他杂物，这解决了我的问题：

```
find . -type f -name "*.nzb.queued" |
sed -ne "s/^\(\(.*\).nzb.queued\)$/mv -v \"\1\" \"\2.nzb\"/p" |
sh 
```

它基于 Diomidis Spinellis 的回答。

正则表达式为整个文件名创建一组，为 .nzb.queued 之前的部分创建一组，然后创建一个 shell 移动命令。带引号的字符串。这也避免了在 shell 脚本中创建循环，因为这已经由 sed 完成。

# language-agnostic - 处理纸质文件

> ID：602708
> 
> 赞同：1
> 
> 时间：2009-03-02T15:20:54.957
> 
> 标签：language-agnostic, documentation

在编写完每个新程序后，都会留下大量纸质文档。

除了程序员通常的涂鸦笔记之外，通常还有一大堆包含物理模型解释、计算等的论文（方程式、表格、图表、描述变量的小图片......）

我们通常在控制台应用程序中进行数值密集型计算，这些计算不会向公众发布（留在家里，只有结果出来）。在每个项目完成之前，所有这些文件都必须以某种方式与应用程序一起打包，以便有一天，当有人将重用它的一部分时，可以知道里面是什么。到目前为止，我们一直在使用“肮脏”的解决方案，即只扫描所有内容，然后将其与应用程序一起打包到光盘上。

所以我想知道......对于所有处于类似情况的科学人员......您如何处理需要但未向公众发布的项目文档？（那个，去 dtp 女士们，他们让它变得漂亮和闪亮 - 不再是我们的问题了 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T15:34:31.427

在我从事的项目中，我们在程序中进行了很多物理计算，因此我们有很多关于我们正在研究的方程式的白板会议。

我们为每个主要项目保留一个 wiki，在每次白板会议之后，我们用数码相机对白板进行物理拍摄，并在 wiki 中上传/组织它。如果它很重要，我们还会从开发人员的笔记本中扫描纸质文档，并将其包含在 wiki 中。

然后，我们将 wiki 备份到磁盘上进行存储。因此，我们的解决方案与您的解决方案非常相似，除了我们使用项目 wiki 进行组织。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T15:50:57.800

我使用三个选项之一：

*   将所有内容保存在我自己存档的实验室笔记本中，用于低级别的东西
*   扫描纸质文档，并添加到 pdf 的源代码管理中。它很丑，但如果有人需要它，它就在那里
*   以干净的格式（通常是乳胶）转录方程式、结果等，以供将来参考，并再次添加到源代码管理中。正式纸质副本被签署（我在一个高度监管的领域工作）并归档在活页夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T15:35:27.337

如果它很重要，在我看来，您应该像对待公共文档一样谨慎对待内部文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T15:48:55.137

在设计应用程序的 UI 时，我创建了 UI 纸张原型，该应用程序会生成大量 A3 大小的纸张（在一个项目中，我们有许多桌子上覆盖着纸张）。当设计准备好或需要邮寄给某人时，我会用数码相机拍摄它，这样我就可以制作一系列图片来展示如何在 UI 上执行某些任务，这些图片可以作为文档说明应用程序旨在工作。这也可以作为备份，以防有人窃取/清理原始文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T15:31:29.453

这是一些想法......虽然不是那么实用:)

1.  我们可以将其作为我们入住记录的一部分。这可能有助于开发人员维护应用程序。
2.  使用这些项目更新需求文档/低级设计文档

# sql-server - 我们如何才能知道复制作业或正常复制是否在特定时间运行

> ID：602714
> 
> 赞同：1
> 
> 时间：2009-03-02T15:21:37.527
> 
> 标签：sql-server

我们如何确定复制作业或正常复制是否在特定时间运行。请帮忙弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-01-24T22:56:55.637

假设您指的是 Microsoft SQL Server 复制，这里有一个快速观察复制状态的方法。

在托管出版物的数据库中，转到对象资源管理器树视图： 1\. 打开 Replication 下的 Local Publications 文件夹 2\. 右键单击​​出版物选择 Log Reader Status

日志读取器代理将读取事务日志并使用需要推送给订阅者的更改填充分发数据库。

一个活动的日志代理将在状态窗口中显示消息，例如： 63 个事务与 439 命令已交付

尽管如此，这张图很快解释了事务复制是如何工作的。复制架构（BOL：http: [//msdn.microsoft.com/en-us/library/ms151176.aspx](http://msdn.microsoft.com/en-us/library/ms151176.aspx)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-08T15:29:06.453

在 MS SQL 中，如果您需要以编程方式检查作业状态（例如通过监视工具），您可以触发以下查询。对于推送复制，目标将是复制分发者（如果您尚未扩展分发，则为发布者）。对于拉式复制，目标将是复制订阅者。

```
EXEC msdb..sp_help_job @job_name='<job name here>', @job_aspect = N'job' 
```

您可以在分发者/订阅者的 SQL 服务器代理下找到作业名称。

您正在寻找第 26 列（“current_execution_status”），如果作业当前正在运行，它将是“1”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:09:07.987

为了监控复制，您需要使用 Replication Monitor 工具。

以下文章介绍了如何使用此工具。

[http://msdn.microsoft.com/en-us/library/ms151780(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms151780(SQL.90).aspx)

干杯，约翰

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-27T07:14:44.033

sp_distcounters 告诉您当前状态。如果给定订阅的交付命令计数发生变化，则您的复制正在工作，否则不会。

# ios - 对齐 UIToolBar 项

> ID：602717
> 
> 赞同：115
> 
> 时间：2009-03-02T15:21:45.547
> 
> 标签：ios, cocoa-touch, uitoolbar

我`UIBarButtonItem`创建了三个如下。它们向左对齐，我想对齐中心，所以右侧没有间隙。我没有看到 align 属性`UIToolBar`。还有另一种方法可以做到这一点吗？

```
//create some buttons
UIBarButtonItem *aboutButton = [[UIBarButtonItem alloc] initWithTitle:@"About" style:UIBarButtonItemStyleBordered target:self action:@selector(showAbout:)];
[toolbar setItems:[NSArray arrayWithObjects:settingsButton,deleteButton,aboutButton,nil]];
//Add the toolbar as a subview to the navigation controller.
[self.navigationController.view addSubview:toolbar]; 
```

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-03-02T15:42:29.037

将两个 UIBarButtonSystemItemFlexibleSpace 项目添加到您的工具栏，在项目的左侧和右侧

```
UIBarButtonItem *flexibleSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
[toolbar setItems:[NSArray arrayWithObjects:flexibleSpace, settingsButton,deleteButton,aboutButton, flexibleSpace, nil]]; 
```

像添加任何其他工具栏项一样添加这些项将在它们两者之间平均分配空间。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-11-28T14:55:47.583

这也可以直接从情节提要中完成。

只需在工具栏中拖放项目，将其中一些变成灵活或固定的空间即可获得所需的效果。请参阅下面的两个示例。

![均匀分布的](https://i.stack.imgur.com/kJX1B.png)

![居中](https://i.stack.imgur.com/ifT1g.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-24T07:10:45.790

在 Xamarin iOS 中

右对齐：

```
yourBar.SetItems(new [] { new UIBarButtonItem(UIBarButtonSystemItem.FlexibleSpace), yourButton }, false); 
```

居中对齐：

```
var flexibleSpace = new UIBarButtonItem(UIBarButtonSystemItem.FlexibleSpace);
yourBar.SetItems(new [] { flexibleSpace, yourButton, flexibleSpace}, false); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-05-06T05:43:24.487

**斯威夫特版本：**

```
 let toolbar = UIToolbar(frame: CGRect(x: 0, y: 0, width: viewController.view.frame.size.width, height: 35.0))
    let flexibleSpace = UIBarButtonItem(barButtonSystemItem: UIBarButtonItem.SystemItem.flexibleSpace, target: viewController, action: nil)
    let button1 = UIBarButtonItem(title: "A", style: UIBarButtonItem.Style.Plain, target: viewController, action: foo)
    let button2 = UIBarButtonItem(title: "B", style: UIBarButtonItem.Style.Plain, target: viewController, action: bar)
    let button3 = UIBarButtonItem(title: "C", style: UIBarButtonItem.Style.Plain, target: viewController, action: blah)
    toolbar.items = [button1, flexibleSpace, button2, flexibleSpace, button3] 
```

# graphics - WIC和GDI+是什么关系？

> ID：602727
> 
> 赞同：6
> 
> 时间：2009-03-02T15:23:52.357
> 
> 标签：graphics, image-processing, gdi+, wic

我对 Windows 映像组件 (WIC) 和 GDI+ 之间的关系很模糊。我过去做过一些工作，表明，例如，WIC 产生了视觉上优越的 GIF 编码，但我很惊讶我没有看到更多的人使用它来进行图像处理而不是 GDI+。我知道它没有 GDI+ 的绘制操作，但对于编码/解码来说，它似乎更胜一筹。那么为什么我们看不到迁移呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T01:10:00.110

WIC 和 GDI+ 之间的关系（或者说区别）在于 WIC 是一个可扩展的成像编解码器框架，它允许实现该框架的应用程序通过提供的编解码器接收对新图像格式的支持。GDI+是Windows的核心组件，支持线条、字体、渐变等绘制操作。

虽然 GDI+ 对几种常见的图像格式具有原生支持，但可以为任何图像格式提供 WIC 编解码器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T12:02:59.500

我了解 GDI+ 使用 WIC 来执行某些任务。至少，在 Windows 7 中是这样。

请考虑以下代码：

```
image.Write(target, ImageFormat.Gif); 
```

当我在 Windows XP 下运行此代码时，它将使用 GDI+ Gif 编码器将图像写入 Gif。当我在 Windows 7 下运行相同的代码时，它将使用 WIC Gif 编码器。

# database - 我可以选择性地创建 Postgres 数据库的备份，只有某些表吗？

> ID：602730
> 
> 赞同：3
> 
> 时间：2009-03-02T15:24:38.533
> 
> 标签：database, postgresql, dump, pg-dump

我可以以编程方式（或任何一种方式都可以）创建数据库的备份，只使用我想要的表吗？我的数据库中有大约 100 个表，我只想要 10 个表备份（当然，所有表都是相互依赖的）。我怎样才能做到这一点？顺便说一句，我有一个 postgresql 数据库。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T15:27:12.740

当然。[pg_dump](http://www.postgresql.org/docs/8.3/interactive/app-pgdump.html)允许您传递带有参数的表列表`-t`

解开一些疑惑。确实，该`-t`参数只接受一种模式。但它是一种非常类似于正则表达式的[模式，所以如果你想转储表 A、B 和 C，你可以这样做：](http://www.postgresql.org/docs/8.3/interactive/app-psql.html#APP-PSQL-PATTERNS)

```
pg_dump -t '(A|B|C)' 
```

# iphone - iPhone 开发者标准计划（99 美元）和企业计划（299 美元）有什么区别？

> ID：602731
> 
> 赞同：3
> 
> 时间：2009-03-02T15:25:01.047
> 
> 标签：iphone, objective-c, ipod-touch

有人可以指出有什么区别吗？

用我们的辛勤工作来支持 iPhone 时，我们到底花这么多钱是为了什么？

当我想出售应用程序以赚钱时，我必须拥有企业会员资格（299 美元）是否正确？或者，当我“仅”拥有更便宜的标准会员资格（99 美元）时，我也可以销售应用程序吗？

每次我想将新应用上传到 App Store 时都需要付费吗？标准会员的钩子在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T15:28:00.553

企业会员资格仅适用于企业 - 没有应用商店分发，但您可以在企业内分发您的程序（临时）。使用标准版，您可以将您的应用程序放在应用程序商店，但只能使用 ad-hoc 分发您的程序的 100 个副本。
拥有标准会员资格后，向 App Store 提交应用程序是免费的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T16:17:57.730

如果您想通过 adhoc 向您的组织分发并通过 App Store 向公众分发，您需要注册两个单独的帐户。这在 Apple Dev Support 的电子邮件中得到了证实。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T20:46:44.540

来自[苹果](http://developer.apple.com/iphone/program/apply.html)：

标准计划不允许分发到应用商店之外的 iPhone（少数开发手机除外）。

企业计划不允许通过应用商店分发到 iPhone，但允许开发人员在他们自己的组织内部署他们自己的程序，而无需将这些手机指定为“开发”手机。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T21:22:10.060

“标准计划不允许分发到 iPhone（少数开发手机除外）”

几部手机？？

# winforms - WinForms多线程数据绑定场景，最佳实践？

> ID：602735
> 
> 赞同：11
> 
> 时间：2009-03-02T15:25:28.157
> 
> 标签：winforms, multithreading, data-binding

我目前正在设计/修改应用程序的数据绑定部分，该应用程序大量使用来自后台线程的 winforms 数据绑定和更新（每秒一次，超过 100 条记录）。

假设该应用程序是一个股票交易应用程序，其中一个后台线程监视数据更改并将它们放入数据对象中。这些对象存储在 a 中`BindingList<>`并实现`INotifyPropertyChanged`通过数据绑定将更改传播到 winforms 控件。此外，数据对象当前正在通过`WinformsSynchronizationContext.Send`UI 线程编组更改。用户可以在 UI 中输入一些值，这意味着可以从双方更改一些值。并且用户值不应该被更新覆盖。

所以我想到了几个问题：

*   是否有通用的设计准则如何做到这一点（数据绑定中的背景更新）？
*   何时以及如何在 UI 线程上编组？
*   后台线程与绑定/数据对象交互的最佳方式是什么？
*   应该使用哪些类/接口？（绑定源，...）
*   ...

UI 并不真正知道有一个后台线程来更新控件，并且根据我在数据绑定场景中的理解，UI 不应该知道数据来自哪里......您可以将后台线程视为将数据推送到 UI 的东西，所以我不确定 backgroundworker 是否是我正在搜索的选项。

有时您希望在数据/业务对象中的操作期间获得一些 UI 响应（例如，在重新计算期间设置背景）。在绑定到背景的状态属性上提高 propertychanged 是不够的，因为在计算完成后控件会重新绘制？我的想法是挂钩 propertychanged 事件并在控件上调用 .update() ......还有其他想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T12:20:33.007

这是一个难题，因为大多数“解决方案”会导致大量自定义代码和大量对`BeginInvoke()`or的调用`System.ComponentModel.BackgroundWorker`（它本身只是对 的一个薄包装`BeginInvoke`）。

过去，我还发现您很快希望延迟发送`INotifyPropertyChanged`事件，直到数据稳定。处理一个属性更改事件的代码通常需要读取其他属性。您还经常有一个控件需要在许多属性之一的状态发生更改时重新绘制自身，并且您不希望控件经常重新绘制自身。

首先，每个自定义 WinForms 控件都应该在事件处理程序中读取它绘制自身所需的所有数据，因此当它是( ) 消息`PropertyChanged`时它不需要锁定任何数据对象。控件在获取新数据时不应立即重新绘制自己；相反，它应该调用. Windows 会将消息组合成尽可能少的请求，并且仅在 UI 线程无事可做时发送它们。这最大限度地减少了重绘次数和数据对象被锁定的时间。（无论如何，标准控件大多通过数据绑定来实现）`WM_PAINT``OnPaint``Control.Invalidate()``WM_PAINT`

数据对象需要记录在进行更改时发生的更改，然后在完成一组更改后，“启动” UI 线程调用该`SendChangeEvents`方法，然后调用`PropertyChanged`所有属性的事件处理程序（在 UI 线程上）那已经改变了。当`SendChangeEvents()`方法运行时，必须锁定数据对象以阻止后台线程更新它们。

`BeginInvoke`每当一组更新从数据库读取 bean 时，都可以通过调用来“踢” UI 线程。通常最好使用计时器让 UI 线程轮询，因为 Windows 仅`WM_TIMER`在 UI 消息队列为空时发送消息，从而使 UI 感觉更灵敏。

还要考虑根本不使用数据绑定，并让 UI 在每次计时器触发时询问每个数据对象“发生了什么变化”。数据绑定总是看起来不错，但很快就会成为问题的一部分，而不是解决方案的一部分。

由于数据对象的锁定/解锁很麻烦，并且可能无法足够快地从数据库中读取更新，因此您可能希望向 UI 线程传递数据对象的（虚拟）副本。使数据对象是持久的/不可变的，以便对数据对象的任何更改都返回一个新的数据对象，而不是更改当前的数据对象可以实现这一点。

持久对象听起来很慢，但不必如此，请参阅[this](http://blogs.msdn.com/ericlippert/archive/2007/11/13/immutability-in-c-part-one-kinds-of-immutability.aspx)和[that](http://blogs.msdn.com/ericlippert/archive/tags/Immutability/default.aspx?p=2)以获得一些指针。还要在 Stack Overflow 上查看[这个](https://stackoverflow.com/questions/263585/immutable-object-pattern-in-c-what-do-you-think)和[那个。](https://stackoverflow.com/questions/303426/efficient-persistent-data-structures-for-relational-database)

还可以查看[retlang - *.NET 中基于消息的并发*](http://code.google.com/p/retlang/)。它的消息批处理可能很有用。

（对于 WPF，我将在 UI 线程中设置一个 View-Model，然后由后台线程从多线程模型中“批量”更新。但是，WPF 在组合数据绑定事件方面要好得多，然后是 WinForms .)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T16:01:01.177

有一篇关于该主题的[MSDN 文章。](https://web.archive.org/web/20150114082421/http://msdn.microsoft.com/en-us/magazine/cc188732.aspx)但是准备好看看 VB.NET。;)

此外，也许您可​​以使用[System.ComponentModel.BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，而不是通用的第二个线程，因为它很好地形式化了与您描述的生成的后台线程的交互类型。MSDN 库中给出的示例相当不错，因此请查看它以获取有关如何使用它的提示。

编辑：请注意：如果您使用 ProgressChanged 事件与 UI 线程进行通信，则不需要编组。后台线程在需要与 UI 通信时调用 ReportProgress。由于可以将任何对象附加到该事件，因此没有理由进行手动编组。进度是通过另一个异步操作传达的——因此无需担心 UI 处理进度事件的速度有多快，也无需担心后台线程是否因等待事件完成而中断。

如果您证明后台线程以太快的方式提升进度更改事件，那么您可能需要查看[用于 UI 更新的 Pull 与 Push 模型，](http://ayende.com/Blog/archive/2009/02/16/pull-vs.-push-models-for-ui-updates.aspx)这是 Ayende 的一篇优秀文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T08:09:00.617

是的，所有的书都显示了线程结构和调用等。这是完全正确的等等，但是编码可能会很痛苦，而且通常很难组织，因此您可以对其进行体面的测试

一个 UI 只需要每秒刷新这么多次，所以性能永远不是问题，轮询可以正常工作

我喜欢使用由后台线程池不断更新的对象图。他们检查数据值的实际变化，当他们注意到实际变化时，他们会更新对象图根上的版本计数器（或在每个主要项目上更有意义）并更新值

然后你的前台进程可以有一个计时器（默认情况下与 UI 线程相同）每秒触发一次左右并检查版本计数器，如果它发生变化，锁定它（停止部分更新）然后刷新显示

这种简单的技术将 UI 线程与后台线程完全隔离

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-07T07:25:45.240

我刚刚遇到了类似的情况 - badkground 线程通过 BeginInvokes 更新 UI。背景在每个循环上都有 10 毫秒的延迟，但是在接下来的过程中，我遇到了 UI 更新有时会在该循环上每次都被触发的问题，无法跟上更新的频率，并且应用程序有效地停止工作（不确定会发生什么——炸了一堆？）。

我最终在通过调用的对象中添加了一个标志，这只是一个就绪标志。在调用调用之前，我将其设置为 false，然后 bg 线程将不再进行 ui 更新，直到此标志切换回 true。UI 线程会执行它的屏幕更新等，然后将此 var 设置为 true。

这允许 bg 线程继续运行，但允许 ui 关闭流，直到它准备好更多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-30T12:59:20.217

创建一个新的 UserControl，添加您的控件并对其进行格式化（也许停靠 = 填充）并添加一个属性。现在配置属性以调用用户控件并更新您的元素，每次您更改属性表单任何您想要的线程！

这就是我的解决方案：

```
 private long value;
    public long Value
    {
        get { return this.value; }
        set
        {
            this.value = value;

            UpdateTextBox();
        }
    }

    private delegate void Delegate();
    private void UpdateTextBox()
    {
        if (this.InvokeRequired)
        {
            this.Invoke(new Delegate(UpdateTextBox), new object[] {});
        }
        else
        {
            textBox1.Text = this.value.ToString();
        }
    } 
```

在我的表单上，我绑定了我的视图

```
viewTx.DataBindings.Add(new Binding("Value", ptx.CounterTX, "ReturnValue")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T16:18:26.923

这是我在[Update Controls](http://codeplex.com/updatecontrols)中解决的问题。我提出这个不是建议你重写你的代码，而是给你一些资源来寻找想法。

我在 WPF 中使用的技术是使用 Dispatcher.BeginInvoke 来通知前台线程发生了变化。您可以在 Winforms 中使用 Control.BeginInvoke 执行相同的操作。不幸的是，您必须将对 Form 对象的引用传递给您的数据对象。

完成后，您可以将一个 Action 传递给触发 PropertyChanged 的​​ BeginInvoke。例如：

```
_form.BeginInvoke(new Action(() => NotifyPropertyChanged(propertyName))) ); 
```

您将需要锁定数据对象中的属性以使其成为线程安全的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-22T10:31:56.193

这篇文章很旧，但我想我会给其他人一些选择。似乎一旦您开始进行异步编程和 Windows 窗体数据绑定，您最终会遇到更新 Bindingsource 数据源或更新绑定到 Windows 窗体控件的列表的问题。我将尝试在 wintellect 上使用他的 powerthreading 工具中的 Jeffrey Richters AsyncEnumerator 类。

原因： 1\. 他的 AsyncEnumerator 类自动将后台线程编组为 UI 线程，因此您可以像执行同步代码一样更新控件。2\. AsyncEnumerator 简化了异步编程。它会自动执行此操作，因此您以同步方式编写代码，但代码仍以异步方式运行。

Jeffrey Richter 在 Channel 9 MSDN 上有一个视频，解释了 AsyncEnumerator。

祝我好运。

-R

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-11T15:23:33.250

我迟到了，但我相信这仍然是一个有效的问题。

我建议您完全避免使用数据绑定，`Observable`而是使用对象。

原因是，数据绑定看起来很酷，并且在实现时代码看起来不错，但是当您的情况有很多操作系统异步 UI 更新或多线程时，数据绑定会惨遭失败。

我在 prod 中亲身经历过异步和数据绑定的这个问题，我们甚至在测试中都没有发现它，当用户开始使用所有不同的场景时，事情就开始崩溃了。

# iphone - Apple 是否有可能不接受我作为申请的 iPhone 开发者（具有付费会员资格）？

> ID：602744
> 
> 赞同：1
> 
> 时间：2009-03-02T15:28:29.540
> 
> 标签：iphone, ipod-touch

我必须“申请”是什么意思？天能说：“不，我们不喜欢你的鼻子。做点别的吧！”？他们过去这样做过吗？

我现在已经投资了整整两个月，价值约 20.000 美元用于学习 iPhone 编程，但我还没有申请...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T15:35:55.870

我从来没有听说过他们拒绝开发者许可证的申请。但我听说过很多他们拒绝代码的故事。这是苹果控制 iPhone 市场的更大风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T16:31:50.947

他们没有理由不接受您作为 iPhone 开发人员。我不知道他们在哪里拒绝了在 iPhone 上测试的应用程序配置。在某些情况下，他们可以并且会拒绝您的应用提交到应用商店。通常这些情况包括：

*   使用您没有许可的受版权保护的资产
*   与他们的一款应用竞争（邮件客户端是我所知道的唯一一款）
*   没有增值（又一个“手电筒”应用程序——非常罕见）
*   通过下载打开 iPhone 进行脚本攻击。
*   不符合他们的 UI 指南

最后一个是最棘手的。我的一个朋友的应用被拒绝了，因为他以一种意想不到的方式使用了 UI 小部件。这是非常主观的 IMO，但他们确实告诉了他为什么在他解决问题时他们否认并接受了它。

还有大约20,000，我在这里不能同意。作为一名程序员，除了学习和提高自己之外，你还假设你会为你花在学习上的每一小时获得报酬——这不是很现实。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T15:31:42.697

Apple 有权不按他们的意愿接受您的应用程序，因此您必须承担风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T15:42:30.660

是的，他们可以。这就是为任何紧密锁定的环境开发背后的风险。

当然，在实践中，他们不太可能无缘无故地拒绝你。

投资 2 万美元用于 iPhone 开发，你已经承担了巨大的风险。我不禁想知道这是否是一个饱和的市场，虽然有一些广为人知的成功故事，但每个人和他的狗现在都在研究一个宝石般的克隆，让我们面对现实吧，即使是买 iPhone 的人也会随着市场的发展，希望尽快减少在毫无意义的琐事上的支出

# java - 将 NamedQuery 与复合类一起使用

> ID：602749
> 
> 赞同：1
> 
> 时间：2009-03-02T15:29:03.093
> 
> 标签：java, hibernate

我在映射 XML 文件中定义了以下类：

```
<class name="com.data.StateRefData" table="STATE_REF">
   <composite-id name="primaryKey" class="com.data.StateRefPkData">
       <key-property name="countryCode">
           <column name="COUNTRY_CODE"  />
        </key-property>

        <key-property name="state">
            <column name="STATE"  />
        </key-property>
    </composite-id>

   <property name="dialingCode" column="DIALING_CODE"></property>
   <property name="isActive" column="IS_ACTIVE"></property>
   <property name="localeCode" column="LOCALE_CODE"></property>
   <property name="stName" column="ST_NAME"></property>
</class> 
```

我正在尝试为此类定义一个 NameQuery。我尝试的是：

```
<query name="findState">
    <![CDATA[ from
      com.data.StateRefData
        WHERE primaryKey = :primaryKey
    ]]>
 </query> 
```

我用来调用它的 Java 代码是：

```
Query stateQuery = null;
List<StateRefData> stateList = null;
StateRefPkData primaryKey = new StateRefPkData();
StateRefData filter = new StateRefData();

primaryKey.setCountryCode(inCountryCode);
primaryKey.setState(inStateProvince);
filter.setPrimaryKey(primaryKey);

stateQuery = session.getNamedQuery("findState");
stateQuery.setProperties(filter); 
```

但是，我在“stateQuery.list()”部分得到了这些错误：

```
[ERROR JDBCExceptionReporter:72] Line 1: Incorrect syntax near ','.
org.hibernate.exception.SQLGrammarException: could not execute query

        at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:59)
   at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
   at org.hibernate.loader.Loader.doList(Loader.java:1596)
   at org.hibernate.loader.Loader.list(Loader.java:1577)
   at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:395)
   at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:271)
   at org.hibernate.impl.SessionImpl.list(SessionImpl.java:844)
   at org.hibernate.impl.QueryImpl.list(QueryImpl.java:74) 
```

关于如何将 NamedQuery 与复合材料一起使用的任何想法？

**注意：**我也尝试过这样做：

```
stateQuery.setParameter("primaryKey", primaryKey); 
```

它仍然有错误。

**新（已编辑）：** 这是我执行代码时发生的 HQL 和 SQL：

```
[DEBUG AST:223] --- HQL AST ---
 \-[QUERY] 'query'
    +-[SELECT_FROM] 'SELECT_FROM'
    |  \-[FROM] 'from'
    |     \-[RANGE] 'RANGE'
    |        +-[DOT] '.'
    |        |  +-[DOT] '.'
    |        |  |  +-[DOT] '.'
    |        |  |  |  +-[DOT] '.'
    |        |  |  |  |  +-[IDENT] 'com'
    |        |  |  \-[IDENT] 'data'
    |        |  \-[IDENT] 'StateRefData'
    |        \-[ALIAS] 'd'
    \-[WHERE] 'WHERE'
       \-[EQ] '='
          +-[DOT] '.'
          |  +-[IDENT] 'd'
          |  \-[IDENT] 'primaryKey'
          \-[COLON] ':'
             \-[IDENT] 'primaryKey'

[DEBUG AST:193] --- SQL AST ---
 \-[SELECT] QueryNode: 'SELECT'  querySpaces (STATE_REF)
    +-[SELECT_CLAUSE] SelectClause: '{derived select clause}'
    |  +-[SELECT_EXPR] SelectExpressionImpl: 'statere0_.COUNTRY_CODE as COUNTRY1_, statere0_.STATE as STATE' {FromElement{explicit,not a collection join,not a fetch join,fetch non-lazy properties,classAlias=d,role=null,tableName=STATE_REF,tableAlias=statere0_,colums={,className=com.data.StateRefData}}}
    |  \-[SQL_TOKEN] SqlFragment: 'statere0_.DIALING_CODE as DIALING3_60_, statere0_.IS_ACTIVE as IS4_60_, statere0_.LOCALE_CODE as LOCALE5_60_, statere0_.ST_NAME as ST6_60_'
    +-[FROM] FromClause: 'from' FromClause{level=1, fromElementCounter=1, fromElements=1, fromElementByClassAlias=[d], fromElementByTableAlias=[statere0_], fromElementsByPath=[], collectionJoinFromElementsByPath=[], impliedElements=[]}
    |  \-[FROM_FRAGMENT] FromElement: 'STATE_REF statere0_' FromElement{explicit,not a collection join,not a fetch join,fetch non-lazy properties,classAlias=d,role=null,tableName=STATE_REF,tableAlias=statere0_,colums={,className=com.data.StateRefData}}
    \-[WHERE] SqlNode: 'WHERE'
       \-[EQ] SqlNode: '='
          +-[DOT] DotNode: '(statere0_.COUNTRY_CODE, statere0_.STATE)' {propertyName=primaryKey,dereferenceType=2,propertyPath=primaryKey,path=d.primaryKey,tableAlias=statere0_,className=com.data.StateRefData,classAlias=d}
          |  +-[ALIAS_REF] IdentNode: '(statere0_.COUNTRY_CODE, statere0_.STATE)' {alias=d, className=com.data.StateRefData, tableAlias=statere0_}
          |  \-[IDENT] IdentNode: 'primaryKey' {originalText=primaryKey}
          \-[NAMED_PARAM] SqlNode: '?' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:54:31.373

您能否提供通过打开 SQL 日志记录生成的 SQL 代码？

如果您使用的是 log4j.properties，这是一个示例：

log4j.logger.org.hibernate.SQL=调试

**更新#1**

我不确定为什么现有查询不起作用，但您也应该尝试一下。无需更新任何其他代码，因为传递 POJO 应该会自动将 getter 绑定到命名参数。

```
<query name="findState">
    <![CDATA[ from
      com.data.StateRefData
        WHERE primaryKey.countryCode = :countryCode AND primaryKey.state = :state
    ]]>
</query> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T16:22:49.173

inCountryCode 或 inStateProvince 是否有可能为空或 null？

# c++ - 你会推荐我什么项目来加快使用 C++

> ID：602758
> 
> 赞同：5
> 
> 时间：2009-03-02T15:30:49.830
> 
> 标签：c++, project

我知道 C++ 是一种非常复杂的语言，需要多年的实践才能掌握。

考虑到这一点，您是否知道一个测试所有 C++ 主要特性（继承、指针、内存管理等）的小项目（大约 1k 的 loc）。

问题是我是一名 Java/Python 程序员，我真的很想学习 C++，所以我学习 C++ 已经有一段时间了，但除了小练习之外，我还没有测试过我学到的任何东西。

我想把所有这些知识付诸实践。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T15:36:31.267

单独这样做，您将获得许多有害的习惯。最好到一家C++开发**能力**强的公司实习，并在指导下进行培训。

C++ 就像没有安全别针的手榴弹——看起来很酷，你听说所有“真正的专业人士”都在使用它，但你不知道它什么时候会爆炸。大量的功能可以用于善或恶，而不知道它是真的好还是坏。这就是为什么这里必须提供指导。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-02T15:37:37.520

内存管理器。这应该让你思考：

*   免费店铺管理
*   指针（当然！）
*   继承（您将希望您的驱动程序代码使用它）
*   模板（另一种传递管理器的方式——驱动程序#2）
*   设计用户定义的数据结构（内存块）
*   有效使用标准容器
*   算法（四处走动，找出空块，碎片整理）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T16:26:03.097

[有效的 C++](https://rads.stackoverflow.com/amzn/click/com/0201924889)和[更有效的 C++](https://rads.stackoverflow.com/amzn/click/com/020163371X)

除此之外，选择一个（小？）你想用 C++ 编写的个人项目。您不会通过阅读 1000 行项目来学习 C++。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-02T15:40:31.633

我不确定测试*所有*主要功能的任何东西。它们有很多，有些很少一起使用（想到模板和虚函数。两者都实现了一种形式的多态性，因此您经常根据需要使用其中一个。）

一个涉及所有重要特性的合适项目可能是一些*看起来很*简单的事情，比如编写一个正确的容器类，类似于 std::vector 或 std::list。确保异常安全、迭代器有效性、所有操作的适当时间复杂度以及标准中规定的所有其他要求。

这个问题以及大多数其他项目的问题是，你不会真正知道什么时候完成。制作一个可调整大小的数组可能需要 50 行代码和 20 分钟的时间。然后初学者会认为他已经完成了。使其异常安全要求您能够发现类可能因异常而陷入不一致状态的所有地方。

这是 C++ 的一种普遍问题。很容易*认为*你明白了，编译器当然不会通知你忘记处理的方面。所以你可能认为你的代码是完美的，但它会在各种奇怪的特殊情况下崩溃。

正如尖牙所说，对于像 C++ 这样乱七八糟的语言，自己编写代码是有风险的。很容易陷入“我写了一些代码，它可以编译，它似乎可以运行。因此它是正确的”的陷阱。当然，您可以在此处或其他站点上发布您的代码以供审查，或者只是通过阅读文档来补充您的编码以获取实际的高质量 C++ 代码（大多数 boost 库往往具有全面的文档，指定各种设计决策的基本原理，以及它如何安全地处理 C++ 中容易出现的所有奇怪的特殊情况。当然，C++ 标准本身将是另一个极好的资源。无论哪种情况，这些都可以帮助您确定要注意的问题）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T15:41:33.393

当我学习 C++ 时，我用它来编写自己的语言来编写 Colossal Cave 风格的冒险。像大多数计算机语言一样，它从未出现过，但它确实教会了我很多关于 C++ 的知识。

无论您选择学习 C++ 时要避免的事情都是 GUI 编程，这是一个陷阱，会耗尽您的所有进取心，并可能在此过程中教给您不良的 C++ 习惯。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T18:01:32.883

为了学习 C++，看看很多写得很好的 C++ 代码是很有用的。我认为 Qt 库对此非常好，所以我建议：编写一个 Qt 应用程序。

看看他们如何使用 C++ 并以类似的方式创建您自己的图形组件。

想法： - 股票图表查看器小部件，可连接到金融网站之一并刮取历史数据。- 简单的 Excel，如电子表格小部件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T15:36:56.337

我建议创建一个基于文本的游戏。这真的帮助我巩固了我的 C++。不需要太长时间，您可以使用您想要的所有功能。自己想出游戏。这样更有趣。

另一个好主意是编写一个简单的数学库，支持向量矩阵等。但是对于今天的库，这只是学术用途。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T15:37:13.433

取决于您想在哪个领域工作。但是，少于 1000 行的代码没有什么值得做的正确的事情。

如果您要编写游戏，请尝试编写俄罗斯方块克隆。

如果您认为您将使用套接字等，那么编写一个简单的聊天/irc 客户端会有所帮助。

您是否有需要抓挠的特定瘙痒？你最后一次认为“这很糟糕，我可以做得更好？”是什么时候。你能做得更好吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T15:49:55.993

我建议编写一个俄罗斯方块克隆。您可以通过它学习很多 c++ 概念，并通过 SDL 学习像 SDL 甚至 OpenGL 这样的 2d 库。

拥有一个具有视觉效果的项目总是好的，并且在它结束时您可以播放它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T16:52:51.880

答案似乎有两个主题：

1.  您需要选择一个可能涉及超过 1K LOC 的项目，才能获得该项目的真实体验。

2.  您还需要与经验丰富的 C++ 开发人员合作，他们可以帮助您思考问题并避免与该语言相关的陷阱。

你可以通过 sourceforge.net 和注册来帮助现有的 C++ 项目来解决这两个问题。只要你不介意你的代码是开源的，你应该能够找到一个现有的项目来学习，以及经验丰富的开发人员，他们可以通过审查你的代码和提供指导来提供帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T21:37:11.027

如果你从一本书中学习，它必须有大量经过深思熟虑的练习，你可以实施和学习。还可以查看大学网站及其 C++ 实验室/作业。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T16:33:07.607

An interactive world: A matrix where each position can be a Void or a Being. A Being is something with a few attributes: age, Time left, gender, neigbor connections, etc. Capable a few interactions: fights, having sex and kids, friendships, etc. Some have special Skills, depending on their fathers (inherited trades)... like ability to kill, ability to make food,, etc... Possible outcomes of those interactions and skills are changes on the self attributes, or creating offspring (when possible), or change neigbor attributes.

At each iteration, print the matrix as symbols/numbers on the console (depending on the attributes, etc), starting from a Biblical iteration 0 (initial conditions of your choice... you're God here).

Now you got some real-life pattern simulator, and learned something about inheritance, polimorfism, virtual functions, instantiation of classes, etc.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-02T16:42:55.070

I would suggest a simple text editor would be a reasonable goal.

It's a problem domain that you have a good grasp of.

You have memory management issues, library class reuse issues (stl/curses?), pointer issues, and lots of options where derived classes can be used.

For polymorphism, perhaps, you can have the editor read from a keyboard, or suck commands in from a text file.

There is another good one.... dealing with files.

You don't have to cross platform it. You don't have to open source it. You don't have to show it to anyone. You don't even have to finish it. It can be an exercise just for you.

# .net - 什么时候应该将 copy-local 设置为 true，什么时候不应该？

> ID：602765
> 
> 赞同：79
> 
> 时间：2009-03-02T15:32:23.943
> 
> 标签：.net, msbuild, reference, copy-local

我想知道何时设置`copy-local=true`参考是否有任何启发式方法？

如果引用类型仅在内部使用，我可以设置`copy-local`为，`true`但如果引用类型作为参数或返回值公开，我设置`copy-local`为`false`并指示在使用我的库时应该引用特定版本的依赖项？

任何人都可以为我澄清这一点吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-02T15:35:01.740

本地复制对于部署方案和工具很重要。作为一般规则，如果引用不包含在 GAC 中，则应使用 CopyLocal=True。

Copy Local 本质上意味着我必须手动部署此 DLL 才能使我的应用程序正常工作。当它为假时，它本质上意味着“我依赖另一个必须单独安装或链接的组件，DLL 将已经存在”。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-01-07T21:57:37.683

真正实现了复制本地以支持本地调试。当你为你的应用程序打包和部署时，你应该将你的项目构建到相同的输出文件夹中，并确保你在那里有你需要的所有引用。

在构建大型源代码树时，CopyLocal 尤其令人头疼。有一个关于如何在此处禁用 CopyLocal 的相关问题，您可以在[How do I override CopyLocal (Private) setting for references in .NET from MSBUILD](https://stackoverflow.com/questions/1682096/how-do-i-override-copylocal-private-setting-for-references-in-net-from-msbuild)中看到它。以及[Visual Studio (2008) 中大型解决方案的最佳实践。](https://stackoverflow.com/questions/690033/best-practices-for-large-solutions-in-visual-studio-2008)

[我在文章MSBuild: Best Practices For Creating Reliable Builds, Part 2](http://msdn.microsoft.com/en-us/magazine/dd483291.aspx)中写过如何处理构建大型源代码树。

所以简而言之，当文件复制导致您的构建花费更多时间时，我会说禁用 CopyLocal，然后您愿意为每个构建花费更多时间。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-02T15:35:38.507

这实际上与目标环境有关。如果 copy local 为 false，则表示程序集已经存在于目标环境中（通常在 GAC 中）。将其设置为 true 可确保它出现在构建的输出中，从而更容易部署到目标环境。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-10T05:40:32.550

查看以下 MSDN 参考，其中详细解释了 CopyLocal 行为。

[项目参考](https://docs.microsoft.com/en-us/visualstudio/ide/managing-references-in-a-project)

不幸的是，对于二级程序集中的程序集引用，存在一些怪癖，CopyLocal 不会像预期的那样工作，如下所示。

*   主应用程序
    *   我的图书馆.dll
        *   ThirdPartyLibrary.dll（如果在 GAC CopyLocal 中不会复制到 MainApp bin 文件夹）

如果您不打算将第三方程序集安装到目标机器上的 GAC 中，这会使 xcopy 部署变得困难。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T15:34:30.023

此选项仅影响构建阶段。它只是将引用复制到已构建程序集的本地目录。

如果另一个程序集 (T) 想要使用您正在构建的程序集 (A) 中具有来自另一个引用程序集 (R) 的返回类型或参数的方法，它 (T) 应该能够访问该程序集 (R)。如果引用的程序集 (R) 安装在 GAC 中，它可能无需执行任何特殊操作即可执行此操作。否则，它需要一个本地副本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-09T02:26:01.417

设置 CopyLocal=false 将缩短构建时间，但在部署期间可能会导致不同的问题。

我设置 CopyLocal=false 的经验并不成功。[请参阅我的博客文章“不要将“复制本地”项目引用更改为 false](http://geekswithblogs.net/mnf/archive/2012/12/09/do-not-change-copy-local-project-references-to-false-unless.aspx)中的优缺点摘要，除非了解子序列。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-21T18:23:28.907

将 CopyLocal 设置为 false 的保守方法是检查是否在项目的输出路径中找到了引用。这应该可以让您避开一些令人讨厌的运行时问题，同时仍然减少 IO 量。

在此过程中，我创建了[CopyLocalFixer](https://github.com/ollipekka/CopyLocalFixer)，您可以为文件夹运行它。我尝试了一个大型构建，但说实话，结果并没有那么令人印象深刻。我想这归结为项目的文件夹结构。

# sql-server - 如何从脚本创建 SQL Server 2008 数据库

> ID：602768
> 
> 赞同：6
> 
> 时间：2009-03-02T15:33:20.480
> 
> 标签：sql-server

我正在尝试进行实体框架演练，所以我：

*   在此处下载 SQL 脚本：http: [//www.learnentityframework.com](http://www.learnentityframework.com)
*   在 SQL Server Management Studio 中，我右键单击数据库，创建数据库，将其命名为
*   右键单击新数据库，New Query
*   单击“打开文件”并打开脚本文件：Create_ProgrammingEFDB1_SQLServer2008.sql
*   点击“！执行”
*   但是脚本（756K）现在已经运行了 10 分钟，仍然显示“正在执行...”

我的问题是：

*   这是将 SQL 脚本读入 SQL Server的**标准方法吗？**
*   应该**花这么长时间**吗？这就是我在 MySQL/PHPMyAdmin 中的做法，它可能需要几秒钟，所以我认为我做的不对。

这是脚本的开头，我更改了文件路径，使它们指向正确的 .mdf 和 .ldf 文件：

```
****/

--PART ONE  CREATE THE DATABASE. Note the file paths in the first few commands. 
--Change them for your own computer.--
USE [master]
GO

    /****** Object:  Database [ProgrammingEFDB1]    Script Date: 01/28/2009 10:17:44 ******/
    CREATE DATABASE [ProgrammingEFDB1] ON  PRIMARY 
    ( NAME = N'ProgrammingEFDB1', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\DATA\ProgrammingEFDB1.mdf' , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB )
     LOG ON 
    ( NAME = N'ProgrammingEFDB1_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\DATA\ProgrammingEFDB1_log.LDF' , MAXSIZE = UNLIMITED, FILEGROWTH = 10%)
    GO

    ALTER DATABASE [ProgrammingEFDB1] SET COMPATIBILITY_LEVEL = 90
    GO

    IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
    begin
    EXEC [ProgrammingEFDB1].[dbo].[sp_fulltext_database] @action = 'disable'
    end
    ... 
```

## 回答：

我已经创建了一个同名的数据库，所以它试图创建一个已经存在的数据库，这使它由于某种原因挂起。我删除了那个数据库，重新运行了脚本，它在 3 秒内成功完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T15:43:34.027

我不知道您的脚本在 next 中究竟做了什么`754K`，但您发布的行似乎很无害。

尝试将以下内容添加到您的脚本中：

```
SET STATISTICS TIME ON 
```

这将在查询运行时显示查询执行时间，并帮助您更准确地定位问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T15:39:58.653

> 但是脚本（756K）

一定比`CREATE DATABASE`脚本中的一个要多得多，所以很难说脚本什么时候做的。

您可以将脚本中的进度报告写回客户端，或使用 SQL Profiler 查看正在执行的命令。

# lucene - 哪些是 Lucene 的最佳替代品？

> ID：602787
> 
> 赞同：29
> 
> 时间：2009-03-02T15:39:08.047
> 
> 标签：lucene, search-engine

它可以在 Unix 上运行，并将用于电子邮件搜索（Dovecot、Postfix 和 maildir）。

Lucene 不是问题，我只是在分析一些替代方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T15:47:50.180

对于简单的事情，您的 RDBMS 的本地全文搜索。

*   [PostgreSQL 中的全文搜索](http://www.postgresql.org/docs/8.3/interactive/textsearch.html)
*   [SQLite 中的 FTS2](http://www.sqlite.org/cvstrac/wiki?p=FtsTwo)
*   [MySQL中的全文搜索](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)
*   [Oracle DB 中的 Oracle 文本](https://docs.oracle.com/cd/B19306_01/server.102/b14220/content.htm#sthref2643)
*   [Microsoft SQL Server 中的全文搜索](http://msdn.microsoft.com/en-us/library/ms142571.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-02T15:51:26.113

需要知道您在使用 Lucene 时遇到了什么问题，但[Xapian](http://xapian.org)值得一看。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T15:45:10.420

我现在能想到的是原生 DBMS-full-text-indexing（MSSQL、MySQL 都有它的实现）以及 Sphinx [http://www.sphinxsearch.com/about.html](http://www.sphinxsearch.com/about.html)

Sphinx 的优势在于更容易与 MySQL 和 PostgreSQL 集成，但 Lucene 功能更丰富。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-17T09:30:22.563

[Oracle Labs 的Minion](http://minion.java.net/)是 Lucene 和 Xapian 的一个非常有趣的替代品。

除其他有趣的功能外，它还支持搜索结果聚类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T15:46:59.777

这里提到了一些替代索引器：

> [ASP.NET 使用哪种搜索技术？](https://stackoverflow.com/questions/120965/which-search-technology-to-use-with-asp-net)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-09T20:07:35.710

我不知道你是否认为 Solr 是一个替代方案，因为它是建立在 lucene 之上的。

但其他人是：

*   狮身人面像
*   索引罐
*   RDBM 全文索引（MySql、Oracle、Postgre 等）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-27T16:16:19.080

我建议[为 Java(mg4j) 管理千兆字节以](http://mg4j.di.unimi.it/)提高其压缩性能。另请参阅我自己的问题的描述：[mg4j vs. apache lucene](https://stackoverflow.com/questions/5028314/mg4j-vs-apache-lucene)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-08T07:50:12.987

查看节点的搜索索引模块（[https://github.com/fergiemcdowall/search-index](https://github.com/fergiemcdowall/search-index)）。它就像 Node.js 的简化、精简的 lucene。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-15T12:48:24.743

现在还有[Elastic Search](http://www.elasticsearch.org/)。AFAIK Stackexchange 已切换到它或正在这样做。（如我错了请纠正我）

# asp.net - 带有锚点的 ASP.Net MVC RedirectToAction

> ID：602788
> 
> 赞同：85
> 
> 时间：2009-03-02T15:39:44.567
> 
> 标签：asp.net, asp.net-mvc, fragment-identifier

我有以下问题：例如我有这样的路线：

```
routes.Add(new Route("forums/thread/{threadOid}/last", new MvcRouteHandler())
           Defaults = new RouteValueDictionary(
             new { controller = "Thread", action ="ShowThreadLastPostPage"}),
        Constraints = new RouteValueDictionary(new { threadOid = @"^\d+$" })
    }
); 
```

有没有办法使用 RedirectToAction 方法导航到这样的 URL：

> `forums/thread/{threadOid}/last#postOid`

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-03-02T15:44:39.750

我认为您应该使用该`Redirect`方法`Url.RouteUrl`来完成它。

```
return Redirect(Url.RouteUrl(new { controller = "Thread", action = "ShowThreadLastPostPage", threadOid = threadId }) + "#" + postOid); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-02-04T00:49:21.433

另一种选择`Url.Action`：

```
return Redirect(Url.Action("ShowThreadLastPostPage", "Thread", new { threadOid = threadOid }) + "last#" + postOid); 
```

# ms-access - MS Access 下拉列表/组合框

> ID：602794
> 
> 赞同：2
> 
> 时间：2009-03-02T15:42:18.087
> 
> 标签：ms-access

这应该很简单，但我的 Google-Fu 还没有找到答案。我只是想在 Access 中创建一个下拉列表，以便在选择时我可以根据选择的值执行一些操作。例如，我有一个人员列表，我想填充组合框，以便他们的姓名出现在列表中，但“值”设置为他们的 ID（主键）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T16:05:48.217

听起来您可能会问如何在下拉列表中显示除 ID 之外的其他内容，同时将 ID 保留为下拉列表返回的数据。如果是这种情况，请将 Bound Column 设置为 ID 字段（通常为 1）并（假设 name 字段是下一个）将 Column Count 设置为 2 并将 Column Widths 设置为 0";1" 或 0";[无论宽度你需要]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:54:50.427

您将需要挂钩到下拉列表的[onchange](http://www.blueclaw-db.com/access_event_programming/onchange.htm)事件。

并来自[MSDN](http://msdn.microsoft.com/en-us/library/aa165368(office.10).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T16:04:33.680

您如何设置组合框的属性？

也许您可以尝试设置（假设您正在使用字段*ID*和*Field1从**Table1*中提取数据

 ***   行源：SELECT [Table1].[ID], [Table1].[Field1] FROM Table1；
*   行源类型：表/查询
*   绑定列：1
*   列数：2
*   列宽：0"、1"

然后按照[Chris Ballance](https://stackoverflow.com/questions/602794/ms-access-dropdown-list-combo-box/602842#602842)的建议加入*onchange*事件。组合框的 value 属性是*ID*；*文本*将是*Field1*中的内容。

 **** * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T16:13:14.220

好的，即使这有点违反直觉，我也想通了。Access Combobox 可以有任意多的值（而不是只有一个键值）。默认情况下，所有值都显示在列表中，因此您需要通过将其宽度设置为 0 来隐藏某些列。这是通过属性窗格中的 ColumnsWidths 属性完成的。ColumnWidths 采用逗号分隔的值列表，该列表对应于列表中列的顺序。我希望这可以帮助别人。

# java - 休眠：标识符

> ID：602800
> 
> 赞同：0
> 
> 时间：2009-03-02T15:44:26.537
> 
> 标签：java, database, hibernate, orm, rdbms

使用休眠时：

我必须为每个实体标识一个 id 或复合 id，如果我想使用没有任何主键且没有复合键的表怎么办......

提前感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T15:46:57.483

没有键的表不是一个好的关系模型。我不会推荐它。

Hibernate 的最佳实践说你应该有一个 id。复合 ID 适用于遗留应用程序，但并不总是最好的主意。

如果你真的必须有一张没有钥匙的桌子，我建议你不应该使用 Hibernate。这是一个 ORM 工具，听起来您既没有正确考虑对象，也没有正确考虑关系表。从 JDBC 开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:16:33.590

如果您正在使用旧模式，那么您需要查看[composite-id](http://www.hibernate.org/hib_docs/reference/en/html/mapping.html#mapping-declaration-compositeid)。

# dll - 转储 Windows DLL 版本的命令行工具？

> ID：602802
> 
> 赞同：68
> 
> 时间：2009-03-02T15:44:50.157
> 
> 标签：dll, command-line, manifest, versioninfo

我需要一个命令行工具来转储标准 Windows DLL 版本信息，以便我可以通过 bash 脚本 (Cygwin) 来处理它。

作为一名 Java 开发人员，我不太习惯 Microsoft 开发工具（尽管我对 Microsoft Visual Embedded C++ 4.0 和 Microsoft Visual Basic 6.0 有一点经验）。

如[SO 所述](https://stackoverflow.com/questions/420852/reading-an-applications-manifest-file)，适当的工具似乎是[mt.exe](http://msdn.microsoft.com/en-us/library/aa375649.aspx)。然而，我发现获得这个小应用程序的唯一机会是下载 1.29 GB ISO 的[Windows SDK for Windows Server 2008 和 .NET Framework](http://www.microsoft.com/downloads/thankyou.aspx?familyId=f26b1aa4-741a-433a-9be5-fa919850bdbf&displayLang=en)。我不敢相信这是唯一的方法。

我还在 Internet 上找到了一个名为[PEView](http://www.magma.ca/~wjr/)的小应用程序，但它显示的信息太多（在我的情况下是无用的），而且它不是命令行应用程序。

Cygwin 中捆绑的标准[objdump](http://en.wikipedia.org/wiki/Objdump)也可以转储有关 DLL 文件的一些信息，但我看不到转储 DLL 版本的选项。请注意，此工具转储的 MajorImageVersion、MinorImageVersion 和其他字段（带有 -p 选项）与自己的 DLL 版本无关。

关于做什么的任何替代方案？也许我错过了一些重要的 objdump 选项？mt.exe 是我唯一的选择吗？如果是这种情况，是否可以将其与 Windows SDK 分开获取？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-10-29T09:01:17.040

您可以使用 PowerShell 获取所需的信息。

```
(Get-Item C:\Path\To\MyFile.dll).VersionInfo 
```

默认情况下，这将显示 ProductVersion 和 FileVersion 但完整的[VERSIONINFO](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa381058%28v=vs.85%29.aspx)可用。即返回评论

```
(Get-Item C:\Path\To\MyFile.dll).VersionInfo.Comments 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-11-04T14:04:50.953

使用[Microsoft Sysinternals Sigcheck](http://technet.microsoft.com/en-us/sysinternals/bb897441.aspx)。此示例仅输出版本：

```
sigcheck -q -n foo.dll 
```

解压后的 sigcheck.exe 只有 228 KB。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-03-02T22:52:23.857

您可以编写一个 VBScript 脚本来获取文件版本信息：

**版本信息.vbs**

```
set args = WScript.Arguments
Set fso = CreateObject("Scripting.FileSystemObject")
WScript.Echo fso.GetFileVersion(args(0))
Wscript.Quit 
```

您可以像这样从命令行调用它：

```
cscript //nologo VersionInfo.vbs C:\Path\To\MyFile.dll 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-12-04T19:44:50.980

```
C:\>wmic datafile where name="C:\\Windows\\System32\\kernel32.dll" get version
Version
6.1.7601.18229 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-02T16:01:29.523

您还可以查看 filever.exe，它可以作为[Windows XP SP2 支持工具](http://www.microsoft.com/downloads/details.aspx?FamilyID=49ae8576-9bb9-4126-9761-ba8011fabf38&displaylang=en)包的一部分下载 - 仅 4.7MB 的下载量。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-02T23:25:57.317

或者你可以自己建造一个。打开VS，新建一个控制台应用程序。创建一个不支持 ATL 或 MFC 的简单项目，选中 stdafx 选项但不要选中“空项目”并将其命名为 VersionInfo。

您将获得一个包含 2 个文件的简单项目：VersionInfo.cpp 和 VersionInfo.h

打开cpp文件并将以下内容粘贴到其中，然后编译。您将能够运行它，第一个参数是完整的文件名，它将根据版本资源块打印出**“产品：5.6.7.8 文件：1.2.3.4” 。**如果没有版本资源，它将返回 -1，否则返回 0。

使用 dll CRT 编译为 8k 二进制文件，60k 静态链接所有内容（在 C++ 选项中设置，将“代码生成页面，运行时选项”更改为“/MT”）

HTH。

PS。如果您不想使用 Visual Studio，它仍将使用任何 c++ 编译器（手指交叉）进行编译，但您几乎肯定必须更改 #pragma - 只需在链接器设置中指定该 lib，pragma 的只是自动链接到该库的简写。

* * *

```
// VersionInfo.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <windows.h>

#pragma comment(lib, "version.lib")

int _tmain(int argc, _TCHAR* argv[])
{
    DWORD handle = 0;
    DWORD size = GetFileVersionInfoSize(argv[1], &handle);
    BYTE* versionInfo = new BYTE[size];
    if (!GetFileVersionInfo(argv[1], handle, size, versionInfo))
    {
        delete[] versionInfo;
        return -1;
    }
    // we have version information
    UINT    len = 0;
    VS_FIXEDFILEINFO*   vsfi = NULL;
    VerQueryValue(versionInfo, L"\\", (void**)&vsfi, &len);

    WORD fVersion[4], pVersion[4];
    fVersion[0] = HIWORD(vsfi->dwFileVersionMS);
    fVersion[1] = LOWORD(vsfi->dwFileVersionMS);
    fVersion[2] = HIWORD(vsfi->dwFileVersionLS);
    fVersion[3] = LOWORD(vsfi->dwFileVersionLS);
    pVersion[0] = HIWORD(vsfi->dwProductVersionMS);
    pVersion[1] = LOWORD(vsfi->dwProductVersionMS);
    pVersion[2] = HIWORD(vsfi->dwProductVersionLS);
    pVersion[3] = LOWORD(vsfi->dwProductVersionLS);

    printf("Product: %d.%d.%d.%d File: %d.%d.%d.%d\n", 
        pVersion[0], pVersion[1], 
        pVersion[2], pVersion[3], 
        fVersion[0], fVersion[1], 
        fVersion[2], fVersion[3]);
    delete[] versionInfo;

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-06-07T09:35:14.750

使用 Powershell 可以使用以下命令从任何 dll 或 exe 获取版本字符串，即 2.3.4

```
(Get-Item "C:\program files\OpenVPN\bin\openvpn.exe").VersionInfo.ProductVersion 
```

在 Windows 10 上测试

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-12-12T08:03:12.467

Systernals 的 listdlls 工具可能会完成这项工作：[http ://technet.microsoft.com/en-us/sysinternals/bb896656.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896656.aspx)

```
listdlls -v -d mylib.dll 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-01-02T11:34:10.897

此函数将使用 Cygwin bash（实际 r-click-properties-info）的任何文件的 ntfs Windows 文件详细信息返回到术语

将文件路径传递给 finfo()，可以是 unix 路径、dos 路径、相对或绝对路径。该文件被转换为绝对 nix 路径，然后检查它是否实际上是常规/现有文件。然后转换成一个绝对的windows路径并发送到“wmic”。然后神奇的是，你在终端中就有了 windows 文件的详细信息。用途：cygwin、cygpath、sed 和 awk。需要 Windows WMI“wmic.exe”才能运行。更正输出以方便...

```
$ finfo notepad.exe
$ finfo "C:\windows\system32\notepad.exe" 
$ finfo /cygdrive/c/Windows/System32/notepad.exe 
$ finfo "/cygdrive/c/Program Files/notepad.exe"
$ finfo ../notepad.exe

finfo() {
    [[ -e "$(cygpath -wa "$@")" ]] || { echo "bad-file"; return 1; }
    echo "$(wmic datafile where name=\""$(echo "$(cygpath -wa "$@")" | sed 's/\\/\\\\/g')"\" get /value)" |\
    sed 's/\r//g;s/^M$//;/^$/d' | awk -F"=" '{print $1"=""\033[1m"$2"\033[0m" }'
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-09-12T14:45:12.493

CodeProject 中有一个名为“ShowVer”的命令行应用程序：

[ShowVer.exe 命令行 VERSIONINFO 显示程序](http://www.codeproject.com/KB/DLL/showver.aspx)

像往常一样，该应用程序带有一个 exe 和源代码 (VisualC++ 6)。

Out 输出所有可用的元数据：

在德国 Win7 系统上，user32.dll 的输出是这样的：

```
VERSIONINFO for file "C:\Windows\system32\user32.dll":  (type:0)
  Signature:       feef04bd
  StrucVersion:    1.0
  FileVersion:     6.1.7601.17514
  ProductVersion:  6.1.7601.17514
  FileFlagsMask:   0x3f
  FileFlags:       0
  FileOS:          VOS_NT_WINDOWS32
  FileType:        VFT_DLL
  FileDate:        0.0
 LangID: 040704B0
  CompanyName       : Microsoft Corporation
  FileDescription   : Multi-User Windows USER API Client DLL
  FileVersion       : 6.1.7601.17514 (win7sp1_rtm.101119-1850)
  InternalName      : user32
  LegalCopyright    : ® Microsoft Corporation. Alle Rechte vorbehalten.
  OriginalFilename  : user32
  ProductName       : Betriebssystem Microsoft« Windows«
  ProductVersion    : 6.1.7601.17514
 Translation: 040704b0 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-04T15:02:36.067

一种方法`makecab`：

```
; @echo off
;;goto :end_help
;;setlocal DsiableDelayedExpansion
;;;
;;;
;;; fileinf /l list of full file paths separated with ;
;;; fileinf /f text file with a list of files to be processed ( one on each line )
;;; fileinf /? prints the help
;;;
;;:end_help

; REM Creating a Newline variable (the two blank lines are required!)
; set NLM=^

; set NL=^^^%NLM%%NLM%^%NLM%%NLM%
; if "%~1" equ "/?" type "%~f0" | find ";;;" | find /v "find" && exit /b 0
; if "%~2" equ "" type "%~f0" | find ";;;" | find /v "find" && exit /b 0
; setlocal enableDelayedExpansion
; if "%~1" equ "/l" (
;  set "_files=%~2"
;  echo !_files:;=%NL%!>"%TEMP%\file.paths"
;  set _process_file="%TEMP%\file.paths"
;  goto :get_info
; )

; if "%~1" equ "/f" if exist "%~2" (
;  set _process_file="%~2"
;  goto :get_info
; )

; echo incorect parameters & exit /b 1
; :get_info
; set "file_info="

; makecab /d InfFileName=%TEMP%\file.inf /d "DiskDirectory1=%TEMP%" /f "%~f0"  /f %_process_file% /v0>nul

; for /f "usebackq skip=4 delims=" %%f in ("%TEMP%\file.inf") do (
;  set "file_info=%%f"
;  echo !file_info:,=%nl%!
; )

; endlocal
;endlocal
; del /q /f %TEMP%\file.inf 2>nul
; del /q /f %TEMP%\file.path 2>nul
; exit /b 0

.set DoNotCopyFiles=on
.set DestinationDir=;
.set RptFileName=nul
.set InfFooter=;
.set InfHeader=;
.Set ChecksumWidth=8
.Set InfDiskLineFormat=;
.Set Cabinet=off
.Set Compress=off
.Set GenerateInf=ON
.Set InfDiskHeader=;
.Set InfFileHeader=;
.set InfCabinetHeader=;
.Set InfFileLineFormat=",file:*file*,date:*date*,size:*size*,csum:*csum*,time:*time*,vern:*ver*,vers:*vers*,lang:*lang*" 
```

示例输出（它有一个字符串版本，它是 wmic 方法的一个小补充 :)）：

```
c:> fileinfo.bat /l C:\install.exe
    file:install.exe
    date:11/07/07
    size:562688
    csum:380ef239
    time:07:03:18a
    vern:9.0.21022.8
    vers:9.0.21022.8 built by: RTM
    lang:1033 
```

还有一个使用***shell.application***和混合 batch\jscript.Here's **tooptipInfo.bat**：

```
@if (@X)==(@Y) @end /* JScript comment
    @echo off

    rem :: the first argument is the script name as it will be used for proper help message
    cscript //E:JScript //nologo "%~f0" %*

    exit /b %errorlevel%

@if (@X)==(@Y) @end JScript comment */

////// 
FSOObj = new ActiveXObject("Scripting.FileSystemObject");
var ARGS = WScript.Arguments;
if (ARGS.Length < 1 ) {
 WScript.Echo("No file passed");
 WScript.Quit(1);
}
var filename=ARGS.Item(0);
var objShell=new ActiveXObject("Shell.Application");
/////

//fso
ExistsItem = function (path) {
    return FSOObj.FolderExists(path)||FSOObj.FileExists(path);
}

getFullPath = function (path) {
    return FSOObj.GetAbsolutePathName(path);
}
//

//paths
getParent = function(path){
    var splitted=path.split("\\");
    var result="";
    for (var s=0;s<splitted.length-1;s++){
        if (s==0) {
            result=splitted[s];
        } else {
            result=result+"\\"+splitted[s];
        }
    }
    return result;
}

getName = function(path){
    var splitted=path.split("\\");
    return splitted[splitted.length-1];
}
//

function main(){
    if (!ExistsItem(filename)) {
        WScript.Echo(filename + " does not exist");
        WScript.Quit(2);
    }
    var fullFilename=getFullPath(filename);
    var namespace=getParent(fullFilename);
    var name=getName(fullFilename);
    var objFolder=objShell.NameSpace(namespace);
    var objItem=objFolder.ParseName(name);
    //https://msdn.microsoft.com/en-us/library/windows/desktop/bb787870(v=vs.85).aspx
    WScript.Echo(fullFilename + " : ");
    WScript.Echo(objFolder.GetDetailsOf(objItem,-1));

}

main(); 
```

用于 cmd.exe ：

```
C:\Windows\System32\cmd.exe :
File description: Windows Command Processor
Company: Microsoft Corporation
File version: 6.3.9600.16384
Date created: ?22-?Aug-?13 ??13:03
Size: 347 KB 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-05T01:24:28.797

对于某些 DLL，我`objdump`在[.rsrc](https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#the-rsrc-section)中手动找到了版本信息。与`objdump -s -j .rsrc zlib1.dll`：

```
zlib1.dll:     file format pei-x86-64

Contents of section .rsrc:
 62e9e000 00000000 00000000 00000000 00000100  ................
 62e9e010 10000000 18000080 00000000 00000000  ................
 62e9e020 00000000 00000100 01000000 30000080  ............0...
 62e9e030 00000000 00000000 00000000 00000100  ................
 62e9e040 09040000 48000000 58e00100 34030000  ....H...X...4...
 62e9e050 00000000 00000000 34033400 00005600  ........4.4...V.
 62e9e060 53005f00 56004500 52005300 49004f00  S._.V.E.R.S.I.O.
 62e9e070 4e005f00 49004e00 46004f00 00000000  N._.I.N.F.O.....
 62e9e080 bd04effe 00000100 02000100 00000b00  ................
 62e9e090 02000100 00000b00 3f000000 00000000  ........?.......
 62e9e0a0 04000000 02000000 00000000 00000000  ................
 62e9e0b0 00000000 94020000 01005300 74007200  ..........S.t.r.
 62e9e0c0 69006e00 67004600 69006c00 65004900  i.n.g.F.i.l.e.I.
 62e9e0d0 6e006600 6f000000 70020000 01003000  n.f.o...p.....0.
 62e9e0e0 34003000 39003000 34004500 34000000  4.0.9.0.4.E.4...
 62e9e0f0 64001e00 01004600 69006c00 65004400  d.....F.i.l.e.D.
 62e9e100 65007300 63007200 69007000 74006900  e.s.c.r.i.p.t.i.
 62e9e110 6f006e00 00000000 7a006c00 69006200  o.n.....z.l.i.b.
 62e9e120 20006400 61007400 61002000 63006f00   .d.a.t.a. .c.o.
 62e9e130 6d007000 72006500 73007300 69006f00  m.p.r.e.s.s.i.o.
 62e9e140 6e002000 6c006900 62007200 61007200  n. .l.i.b.r.a.r.
 62e9e150 79000000 2e000700 01004600 69006c00  y.........F.i.l.
 62e9e160 65005600 65007200 73006900 6f006e00  e.V.e.r.s.i.o.n.
 62e9e170 00000000 31002e00 32002e00 31003100  ....1...2...1.1.
 62e9e180 00000000 34000a00 01004900 6e007400  ....4.....I.n.t.
 62e9e190 65007200 6e006100 6c004e00 61006d00  e.r.n.a.l.N.a.m.
 62e9e1a0 65000000 7a006c00 69006200 31002e00  e...z.l.i.b.1...
 62e9e1b0 64006c00 6c000000 7c002c00 01004c00  d.l.l...|.,...L.
 62e9e1c0 65006700 61006c00 43006f00 70007900  e.g.a.l.C.o.p.y.
 62e9e1d0 72006900 67006800 74000000 28004300  r.i.g.h.t...(.C.
 62e9e1e0 29002000 31003900 39003500 2d003200  ). .1.9.9.5.-.2.
 62e9e1f0 30003100 37002000 4a006500 61006e00  0.1.7\. .J.e.a.n.
 62e9e200 2d006c00 6f007500 70002000 47006100  -.l.o.u.p. .G.a.
 62e9e210 69006c00 6c007900 20002600 20004d00  i.l.l.y. .&. .M.
 62e9e220 61007200 6b002000 41006400 6c006500  a.r.k. .A.d.l.e.
 62e9e230 72000000 3c000a00 01004f00 72006900  r...<.....O.r.i.
 62e9e240 67006900 6e006100 6c004600 69006c00  g.i.n.a.l.F.i.l.
 62e9e250 65006e00 61006d00 65000000 7a006c00  e.n.a.m.e...z.l.
 62e9e260 69006200 31002e00 64006c00 6c000000  i.b.1...d.l.l...
 62e9e270 2a000500 01005000 72006f00 64007500  *.....P.r.o.d.u.
 62e9e280 63007400 4e006100 6d006500 00000000  c.t.N.a.m.e.....
 62e9e290 7a006c00 69006200 00000000 32000700  z.l.i.b.....2...
 62e9e2a0 01005000 72006f00 64007500 63007400  ..P.r.o.d.u.c.t.
 62e9e2b0 56006500 72007300 69006f00 6e000000  V.e.r.s.i.o.n...
 62e9e2c0 31002e00 32002e00 31003100 00000000  1...2...1.1.....
 62e9e2d0 78003000 01004300 6f006d00 6d006500  x.0...C.o.m.m.e.
 62e9e2e0 6e007400 73000000 46006f00 72002000  n.t.s...F.o.r. .
 62e9e2f0 6d006f00 72006500 20006900 6e006600  m.o.r.e. .i.n.f.
 62e9e300 6f007200 6d006100 74006900 6f006e00  o.r.m.a.t.i.o.n.
 62e9e310 20007600 69007300 69007400 20006800   .v.i.s.i.t. .h.
 62e9e320 74007400 70003a00 2f002f00 77007700  t.t.p.:././.w.w.
 62e9e330 77002e00 7a006c00 69006200 2e006e00  w...z.l.i.b...n.
 62e9e340 65007400 2f000000 44000000 01005600  e.t./...D.....V.
 62e9e350 61007200 46006900 6c006500 49006e00  a.r.F.i.l.e.I.n.
 62e9e360 66006f00 00000000 24000400 00005400  f.o.....$.....T.
 62e9e370 72006100 6e007300 6c006100 74006900  r.a.n.s.l.a.t.i.
 62e9e380 6f006e00 00000000 0904e404 00000000  o.n............. 
```

# reporting-services - 报告服务报告中的组分隔符

> ID：602808
> 
> 赞同：3
> 
> 时间：2009-03-02T15:46:11.243
> 
> 标签：reporting-services

我的 SSRS 报告使用组来分组数据。我想在组的最后一行有一个行分隔符。我确实隐藏了组页脚和页眉，因为它在将报表呈现为 Excel 时给了我一个额外的行，因此组页眉或页脚的边框不起作用。我想避免excel中的额外行。还有其他方法可以尝试完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-03T03:56:59.923

Reporting Services 最强大的功能可能是对任何对象属性使用表达式的能力。将此与开箱即用的 Previous 功能相结合，该功能允许您访问字段的先前值并获得解决方案。

选择整个详细信息行。展开 BorderStyle 属性并为 Top 属性输入以下代码（假设我们想要一条分隔所有部门的线）：

```
=IIF(Previous(Fields!Department.Value) <> Fields!Department.Value, "Solid", "None") 
```

这会将部门字段的先前值与当前值进行比较，如果它们不同，则使此详细信息行的上边框为实心。

虽然这会将一行放在下一组的顶行而不是前一组的底行，但它在视觉和功能上与您所追求的相同，并且非常容易实现。

# visual-studio - 您可以禁用为调试和编辑保留单独窗口位置的 VS 功能吗？

> ID：602809
> 
> 赞同：1
> 
> 时间：2009-03-02T15:46:46.593
> 
> 标签：visual-studio, visual-studio-2005

在编辑和调试时，我不需要将我的 Visual Studio 窗口放在不同的位置。事实上，我更希望我的窗口留在我放置它们的地方，而不是在我在编辑和调试之间切换时跳来跳去。

有没有办法告诉 VS 不要为两种模式保留不同的窗口设置？

如果这很重要，我目前正在使用 VS 2005。

谢谢，-
戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:49:41.580

除了手动编辑导出的设置文件，将一个布局复制到另一个布局然后导入，没有。

请记住，不仅仅是窗口位置，还有哪些是打开的，调试通常包括额外的仅调试窗口（调用堆栈、线程、监视......）。

# mysql - 多个 MySQL 版本

> ID：602810
> 
> 赞同：1
> 
> 时间：2009-03-02T15:46:56.763
> 
> 标签：mysql, redhat

我们有一台运行 Red Hat Enterprise 3 和 MySQL 3.23 的 Linux 服务器。该服务器上有许多网站。

我们有一个新网站，我们想把它放在这个使用 MySQL 4/5 的服务器上。是否可以并行运行两个版本的 MySQL？

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:51:07.380

是的，这是可能的，但很棘手。

首先，最好不要使用 RedHat 提供的 RPMS——它们会导致各种依赖问题。

本质上，您需要做的就是构建这两个版本，并将它们安装到完全不同的目录中。

然后你需要确保它们被单独配置：

*   数据目录
*   TCP 端口
*   本地连接套接字
*   PID 状态文件

在实践中，我可以创建两个`my.cnf`文件，并确保在守护程序启动脚本的命令行参数中选择了这些文件。

另请注意，您需要*非常*小心可能构建的任何共享库，尤其是当您在同一台服务器上运行任何客户端应用程序时。

例如，如果您希望 Perl::DBD::mysql 运行，这会变得很糟糕，因为安排有两个副本并不简单，每个副本都链接到不同版本的共享库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:52:16.317

是的你可以。当然，在服务器上必须使用非标准端口号。

请参阅文档[http://dev.mysql.com/doc/refman/5.1/en/multiple-unix-servers.html](http://dev.mysql.com/doc/refman/5.1/en/multiple-unix-servers.html)

# c# - 无效参数

> ID：602816
> 
> 赞同：0
> 
> 时间：2009-03-02T15:48:21.147
> 
> 标签：c#, xna, arguments

我正在扩展 XNA 游戏工作室 2D 教程并添加来自 microsoft XNA 游戏工作室网站的菜单。我以为它只是插入并运行，但比我想象的要复杂得多。这是一个错误，当我得到它们时，我会发布更多。这是调试窗口：

> C:\Users\Ian\Desktop\GameStateManagementSample - Copy\GameStateManagement\Screens\GameplayScreen.cs(81,24): 错误 CS1502: 'Microsoft.Xna.Framework.GraphicsDeviceManager.GraphicsDeviceManager(Microsoft.Xna. Framework.Game)' 有一些无效参数 C:\Users\Ian\Desktop\GameStateManagementSample - Copy\GameStateManagement\Screens\GameplayScreen.cs(81,50): error CS1503: Argument '1': cannot convert from 'GameStateManagement.GameplayScreen ' 到 'Microsoft.Xna.Framework.Game'
> 
> 编译完成 -- 2 个错误，0 个警告 ========== 构建：0 个成功或最新，1 个失败，0 个跳过 ==========

这是代码：

```
public GameplayScreen()

        {
            //new GraphicsDeviceManager(this) has the error line under it!!!
            graphics = new GraphicsDeviceManager(this);
            content.RootDirectory = "Content";
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T15:52:27.377

您需要`GraphicsDeviceManager`使用有效的[Microsoft.Xna.Framework.Game](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.game.aspx)对象而不是当前类传递构造函数`this`

此外，可能有助于创建[您的第一个游戏的演练](http://msdn.microsoft.com/en-us/library/bb203893.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:36:59.133

I guess you're working on the `GameStateManagmentSample`. If so, since the graphics device is already available in `ScreenManager` so the only thing you need to do is call the graphics device instead of define a new graphic.

```
ScreenManager.GraphicsDevice.Viewport.AspectRatio; 
```

# php - “无限”的sql语句？

> ID：602818
> 
> 赞同：1
> 
> 时间：2009-03-02T15:49:10.190
> 
> 标签：php, sql, sql-server, sql-server-2005, tsql

我有一个非常奇怪的与 sql 相关的问题。

我正在使用 PHP (odbc) 访问 MSSQL Server 2005，当我分析 sql 语句时，将执行以下操作：

```
declare @p1 int
set @p1=180150003
declare @p3 int
set @p3=2
declare @p4 int
set @p4=1
declare @p5 int
set @p5=-1
exec sp_cursoropen @p1 output,N'SELECT  fieldA,  fieldB, fieldC, fieldD, fieldE FROM mytable WHERE fieldB IS NULL',@p3 output,@p4 output,@p5 output
select @p1, @p3, @p4, @p5

exec sp_cursorfetch 180150003,2,1,1 
```

在我自己的服务器上它工作正常，在客户服务器上 sp_cursorfetch 读取无限行并加载完整的 cpu。当我尝试执行语句本身时

```
SELECT  fieldA,  fieldB, fieldC, fieldD, fieldE FROM mytable WHERE fieldB IS NULL 
```

在 SQL Server Management Studio 中它工作正常（不到 1 秒）。

有任何想法吗？

编辑：服务器之间的主要区别是我的服务器是 x86 (Win2003) 而客户的服务器是 x64 (Win2008)。

Edit2：添加了 Where 子句

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T15:55:44.480

该 SELECT 语句中没有 WHERE 子句，因此您将对该表中的每一行进行表扫描。如果您的客户的行数比您的本地服务器多得多，则可以解释时间差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T16:10:19.563

我不了解 SQL 服务器，但 Oracle 甚至不索引 NULL 值。即使是这样，字段 IS NULL 也不是一个选择性标准，因此您可能会进行全表扫描，如果您的客户有大量数据，这可能需要很长时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:28:06.730

数据集越大，所需的时间就越长。您将希望使用 where 子句来限制结果集。不要让您的应用程序服务器完成所有工作。向您要过滤的列添加索引将允许数据库服务器只为您提供您想要的内容，因此您以后不必循环遍历它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T07:23:08.480

好吧，我不确定（我的公司）是否允许我在这里放置完整的 sql 语句。

这就是我在 PHP 中实际执行的操作：

```
SELECT 
A.id, A.empl, A.valid_from,
A.salutation, A.account
FROM persons A
LEFT JOIN persons_comp B 
ON
A.id = B.id 
AND A.empl = B.empl 
AND A.valid_from = B.valid_from 
AND A.salutation = B.salutation 
AND A.account = B.account 
WHERE 
B.empl IS NULL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T15:56:30.703

您的光标被声明为`DYNAMIC`( `@p3 =2`)。在 中`Management Studio`，尝试将其声明为`FAST FORWARD`( `@p3=16`) 并查看是否有帮助。

将您发布的探查器输出粘贴到`Management Studio`中，替换以下参数`sp_cursorfecth`：

```
exec sp_cursorfetch @p1, 2, 1, 1 
```

并查看问题是否仍然存在。

# xml - ExecuteXmlReader 和 null 结果集引发 TargetInvocationException

> ID：602820
> 
> 赞同：0
> 
> 时间：2009-03-02T15:49:40.860
> 
> 标签：xml, sql-server-2005, exception, null, resultset

我在返回 XML 结果集的 SQL Server 2005 数据库上调用存储过程。有时它会返回一个空结果集，因为没有要返回的行。发生这种情况时，ExecuteXmlReader 方法会引发 TargetInvocationException。这似乎是一个已知问题（参见：[http](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/5e90e3c0-605b-406d-848a-dea7b16f458e/) ://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/5e90e3c0-605b-406d-848a-dea7b16f458e/ ）。
处理此异常的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:42:09.990

我能想到3个选择

1.  修改**存储过程**以返回一个虚拟/空值
2.  修改**代码**- 捕获异常并且什么都不做 - 或记录错误
3.  使用**DataSet** - 你应该得到一个空的 DataSet，所以只需检查 DataSet 是否为空。

作为第三选择的相关 SO 帖子，这里有一个关于如何检查 DataSet 是否为空的 SO 问题

[在 C# 中，测试数据集是否为空的最佳方法是什么？](https://stackoverflow.com/questions/47833/in-c-what-is-the-best-way-to-test-if-a-dataset-is-empty)

# language-agnostic - “用户数据指针”的良好定义是什么？

> ID：602826
> 
> 赞同：4
> 
> 时间：2009-03-02T15:51:08.987
> 
> 标签：language-agnostic, callback, user-data

我已经搜索了一个很好的解释，但找不到。

我可以尝试自己写一个，但如果有更好*英语的人可以帮助我在*[此处](https://stackoverflow.com/questions/599365/what-is-your-favorite-c-programming-trick/600523#600523)的评论中为 Zan Lynx 解释这一点，我会更喜欢。

...似乎应该在某个地方有一个很好的解释，为什么不在这里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:02:47.460

查看[sqlite3_exec()](http://www.sqlite.org/c3ref/exec.html) - 它为每个检索到的行调用一个回调（第三个参数）并将您提供的指针（第四个参数）传递给这个回调。这可以是指向您想要的任何对象的指针——您必须在访问指向的对象之前适当地转换它。该对象称为 userdata 对象，指向它的指针称为 userdata 指针。

在 sqlite3_exec() 的情况下，您可以将指针传递给一个容器，该容器将在请求完成时存储所有检索到的表行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T16:30:46.457

当库代表程序管理某些数据结构时（例如，GUI 应用程序中的窗口由操作系统管理），它通常将这些结构的内容保密。但是，程序维护一些特定于程序使用这些结构的附加数据通常很有用。因此，库通常会提供对与每个结构一起存储的字段（通常称为*用户数据）的访问权限。*

程序对用户数据字段的常见用途是每次程序请求库创建结构时分配一些内存，并将指向该内存的指针存储在库提供的用户数据字段中，因此术语用户*数据指针*。

# directory - 禁用 Thunderbird 文件夹扩展

> ID：602829
> 
> 赞同：0
> 
> 时间：2009-03-02T15:51:36.487
> 
> 标签：directory, hide, account, thunderbird

我最近在我的机器上安装了 Thunderbird。

我设置了两个帐户，一个给我，另一个给我的兄弟。

当我未登录 gmail 帐户时，是否可以禁用我的文件夹的节点扩展？

我要求这在我们的文件夹之间提供隐私。

或者是否可以设置 Thunderbird，以便在您打开 Thunderbird 时，您可以选择要打开的帐户并输入密码。只有这样才能查看您选择打开的帐户。

如果您为某个帐户提供的密码不正确，则您无法查看该帐户的文件夹或电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T15:55:59.490

呃...这不是多个计算机用户帐户的用途吗？

为什么您要共享您的计算机帐户，但又想要邮件中的隐私？

# apache-flex - 如何使用 Flash 9 在 Flex 中保存文件

> ID：602835
> 
> 赞同：0
> 
> 时间：2009-03-02T15:53:04.380
> 
> 标签：apache-flex, actionscript-3

我在 Flash Player 9 下使用 Flex 3。

我有一个要导出到 Excel 的数据网格。我在 Actionscript 中构造了 Excel 对象 ( `ByteArray`)，现在我想使用`FileReference`. 但是，在 FlashPlayer 9 下，`FileReference`只有一个`download`方法。我可以以某种方式将此下载方法指向 Excel 对象吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:00:33.580

我认为您需要将数据上传到您的服务器，然后将其下载到您的客户端。查看[此示例](http://designreviver.com/tutorials/actionscript-3-jpeg-encoder-revealed-saving-images-from-flash/)，将在 as3 中创建的图像保存到客户端。

或者*（这很骇人听闻，但可能会完成您需要的工作）*您可以将数据打印到调试控制台。

# c# - 在 DataView 的 RowFilter 中选择 DISTINCT

> ID：602836
> 
> 赞同：4
> 
> 时间：2009-03-02T15:53:28.607
> 
> 标签：c#, sql, dataview

我正在尝试根据与另一个表的关系来缩小我的 DataView 中的行，我正在使用的 RowFilter 如下；

```
dv = new DataView(myDS.myTable,
                 "id IN (SELECT DISTINCT parentID FROM myOtherTable)",
                 "name asc",
                 DataViewRowState.CurrentRows); 
```

“myTable”和“myOther”表通过 myTable.ID 和 myOtherTable.parentID 关联，因此该想法是 DataView 应该只包含来自“myTable”的行，这些行在“myOtherTable”中有相应的子行。

不幸的是，我遇到了这个错误；

> 语法错误：“DISTINCT”运算符后缺少操作数。

据我所知，SQL 很好，所以我想知道在 RowFilter 的 SQL 中使用 DISTINCT 关键字是否有一些限制？有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T16:30:52.993

不幸的是，我认为您不能在 DataView 的过滤器表达式中执行子查询。您只能在某些表达式中使用 SQL 的子集（[在此处](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)记录）。

您可能需要`SELECT DISTINCT parentID FROM myOtherTable`单独执行子查询 ( )。

[本文](http://bytes.com/groups/net-vb/364272-rowfilter-help-please)描述了问题和可能的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-19T10:28:03.543

不幸的是，您不能这样做，因为 RowFilter 属性不支持 distinct 关键字。以下是您可以在 RowFilter 中执行的表达式列表（它只是一个 DataColumn 表达式）：http: [//msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)

DataViews 有一个 ToTable 方法，并且几个重载使用一个布尔值来指定是否只返回不同的行。

这是一种方法：http: [//msdn.microsoft.com/en-us/library/wec2b2e6.aspx](http://msdn.microsoft.com/en-us/library/wec2b2e6.aspx)

以下是您将如何使用它：

DataTable newDataTable = myDataView.ToTable(true, [作为字符串的列名数组]);

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-05T11:20:52.543

以下代码从表/数据视图中提取不同的值/记录，即（PROD_DESP_TRN）具有字段（CONTAINER_NO）最后，此代码正在用唯一值/记录填充组合框（cmbContainerNo）

表单级别声明：

```
Dim dsLocal As DataSet 
Dim dvm As DataViewManager
Private Sub FillcomboContainer()

    Try
        Dim dv As DataView = New DataView

        cmbContainerNo.DataSource = Nothing
        dv = dvm.CreateDataView(dsLocal.Tables("PROD_DESP_TRN"))
        dv.Sort = "CONTAINER_NO"

        cmbContainerNo.DataSource = dv.ToTable(True, "CONTAINER_NO")
        cmbContainerNo.DisplayMember = "CONTAINER_NO"

    Catch ex As Exception
        MsgBox(ex.Message)
    Finally
    End Try
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-20T10:55:37.863

```
DataView dvBindAssignedByDropDown = new DataView();

DataTable dtBindAssignedByDropDown = new DataTable();

dvBindAssignedByDropDown = ds.Tables[0].DefaultView;

string[] strColnames=new string[2];

strColnames[0] = "RedNames";

strColnames[1] = "RedValues";

dtBindAssignedByDropDown = dvBindAssignedByDropDown.ToTable(true, strColnames);

ddlAssignedby.DataTextField = "RedNamesNames";
ddlAssignedby.DataValueField = "RedNames";
ddlAssignedby.DataSource = dtBindAssignedByDropDown;
ddlAssignedby.DataBind();
ddlAssignedby.Items.Insert(0, "Assigned By");
ddlAssignedby.Items[0].Value = "0"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T16:27:27.150

尝试忽略“DISTINCT”。在这种情况下，无论有无，结果都应该相同。从那里进行故障排除。

# xml - 使用“保存”方法使用 ado 对象更改 xml 导出的字段精度

> ID：602839
> 
> 赞同：2
> 
> 时间：2009-03-02T15:54:20.087
> 
> 标签：xml, vb6, ado

我正在开发一个 VB6 应用程序，该应用程序使用 ADODB.Recordset 对象通过“保存”方法将数据转储到 .xml 文件，如下所示：

```
adoRecordset.Save strDst, adPersistXML 
```

其中 strDst 是描述目的地的字符串。

现在，对于某些表，数据库中有一些行是浮点数/双精度数。例如，表 TABLE 包含一个浮点类型的 MEASURE 列。

**问题：** 是否可以控制写入 .xml 文件的 MEASURE 的压力？

例如，如果度量为 1.23456789，是否可以在输出文件中包含 measure="1.234" ？

**想法：** ADO 记录集对于数据库的每条记录都有一个“字段”类型的“字段”集合。字段的“精度”属性存在，但“大部分”是只读的。通过查看 MSDN 的帮助，还不清楚何时可以编写它。它可以以某种方式使用吗？

**限制：** 我确实想使用“保存”方法。我想知道是否可以使用它以避免编写我自己的方法。

**背景：** 目的是将从数据库中提取的大量数据通过长距离通道传输到另一个系统。在该系统中，数据被加载到数据库中进行*初步*分析。瓶颈是通道和现有的数据提取应用程序，该应用程序通过某种算法选择要传输的表。.xml 文件以高压缩率压缩，但数量仍然太多，因此我们决定*删除*一些不太重要的数据。

**边问题（参考 onedaywhen 的解决方案）** 感谢 onedaywhen 到目前为止的回答。我以不同的方式使用它，但它已经有很大帮助（+1）。出现的问题是大部分值都在所需位置四舍五入，但是写入.xml时，出现了一种二进制到十进制的转换错误。例如 3.123 变为“3.1230000000000002”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T08:36:40.877

简单的解决方案是使用 SQL 对值进行舍入，并将其作为记录集的附加列返回。因此，假设您有一个复杂的舍入算法，需要客户端代码。

您可以使用 MSDataShape 提供程序将新列“附加”到您的记录集，例如数字类型（即固定精度十进制），然后在保存之前遍历记录集以填充值：

```
 Dim rs As ADODB.Recordset
  Set rs = CreateObject("ADODB.Recordset")
  With rs
    .ActiveConnection = _
    "Provider=MSDataShape;" & _
    "Data Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=C:\Tempo\New_Jet_DB.mdb"
    .Source = _
    "SHAPE {" & _
    " SELECT ExistingField" & _
    " FROM ExistingTable" & _
    " ORDER BY ExistingField" & _
    "} APPEND NEW adNumeric(5, 4) AS NewField"
    .LockType = 4  ' adLockBatchOptimistic

    .Open

    Dim i As Long
    For i = 0 To .RecordCount - 1
      .Fields("NewField").value = Round(.Fields("ExistingField").value, 4)
      .MoveNext
    Next

    rs.Save "C:\rs.xml", adPersistXML

  End With 
```

当然，这些行将在 XML 中显示为已更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T13:24:56.967

“保存”方法不是很灵活。它的目的是持久保存数据，仅此而已。无法更改值的格式或影响数据的存储方式（只能设置*PersistFormat*）。

我采用的解决方案是对生成的 XML 文件进行后处理，将我感兴趣的所有浮点值四舍五入。这样我就有了我需要的灵活性。

# python - 如何在 Python 中访问当前正在执行的模块或类名？

> ID：602846
> 
> 赞同：61
> 
> 时间：2009-03-02T15:55:53.483
> 
> 标签：python, module

我希望能够从导入的模块中动态检索当前执行的模块或类名。这是一些代码：

**foo.py：**

```
def f():
    print __name__ 
```

**酒吧.py：**

```
from foo import f

def b(): f() 
```

这显然不起作用`__name__`，因为包含该函数的模块的名称。我想在模块内部访问的`foo`是正在使用的当前执行模块的名称`foo`。因此，在上述情况下，它会是`bar`，但如果导入任何其他模块`foo`，我希望`foo`动态访问该模块的名称。

**编辑：**该`inspect`模块看起来很有希望，但它并不是我想要的。我希望的是某种可以访问的全局或环境级变量，其中包含当前执行模块的名称。并不是说我不愿意遍历堆栈来查找该信息——我只是认为 Python 可能已经暴露了该数据。

**编辑：**这是我尝试使用它的方式。我有两个不同的 Django 应用程序，它们都需要将错误记录到文件中。可以说它们被称为“AppOne”和“AppTwo”。我也有一个我想记录这些文件的地方：“ `/home/hare/app_logs`”。在任何给定点的每个应用程序中，我都希望能够导入我的记录器模块并调用将日志字符串写入文件的日志函数。但是我想做的是`app_logs`在当前应用程序的名称下创建一个目录（“AppOne”或“AppTwo”），以便每个应用程序的日志文件将进入它们各自的日志目录。

为了做到这一点，我认为最好的方法是让 logger 模块访问某种表示当前应用程序名称的全局变量，因为它负责了解父日志目录的位置并创建应用程序的日志记录目录，如果它还不存在。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-02T18:36:31.100

从评论 - 不是问题。

> 我只是想看看我想做的事情是否可行。

“有可能”的答案总是“是”。总是。除非您的问题涉及时间旅行、反重力或永动机。

由于答案总是“是”，因此您的问题不正确。真正的问题是“让我的日志记录模块知道客户端名称的好方法是什么？” 或类似的东西。

答案是“接受它作为参数”。不要乱检查或寻找神秘的全局变量或其他技巧。

只需遵循`logging.getLogger()`并使用明确命名的记录器的设计模式。一个常见的成语如下

```
logger= logging.getLogger( __name__ ) 
```

这可以完美地处理几乎所有的日志命名。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2011-10-18T16:27:55.703

这应该适用于引用当前模块：

```
import sys
sys.modules[__name__] 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-02T16:27:58.117

“当前执行的模块”显然是 foo，因为它包含当前正在运行的函数 - 我认为关于你想要的更好的描述是 foo 的直接调用者的模块（如果你调用 af() 它本身可能是 foo从 foo 中的函数被 bar 中的函数调用。你想上升多远取决于你想要这个。

在任何情况下，假设您想要直接调用者，您可以通过向上调用堆栈来获得它。这可以通过调用 来完成，并[`sys._getframe`](http://docs.python.org/library/sys.html#sys._getframe)带有适当数量的要行走的关卡。

```
def f():
    caller = sys._getframe(1)  # Obtain calling frame
    print "Called from module", caller.f_globals['__name__'] 
```

**[编辑]**：实际上，使用上面建议的[检查](http://docs.python.org/library/inspect.htm)模块可能是获取堆栈帧的更简洁的方法。等效代码是：

```
def f():
    caller = inspect.currentframe().f_back
    print "Called from module", caller.f_globals['__name__'] 
```

（sys._getframe 被记录为供内部使用 - 检查模块是更可靠的 API）

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-02T18:49:32.753

`__file__`是进行调用的当前模块的路径。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-12-20T00:30:08.953

要在另一个模块中获取对“_ *main _”模块的引用：*

```
import sys
sys.modules['__main__'] 
```

然后获取模块的文件路径，其中包括其名称：

```
sys.modules['__main__'].__file__  # type: str 
```

如果在“__main__”模块中，只需使用：`__file__`

要从文件路径中获取文件名：

```
import os
os.path.basename(file_path) 
```

要将文件名与其扩展名分开：

```
file_name.split(".")[0] 
```

获取类实例的名称：

```
instance.__class__.__name__ 
```

获取类名：

```
class.__name__ 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-02T16:04:33.820

我认为您要使用的是[检查](http://docs.python.org/library/inspect.html)模块，以检查 python 运行时堆栈。看看这个[教程](https://pymotw.com/2/inspect/)。我认为它提供了一个几乎准确的例子来说明你想要做什么。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-01-09T18:02:45.067

单独使用`__file__`会为您提供主模块的相对路径和导入模块的绝对路径。意识到这一点，我们可以在`os.path`工具的帮助下不断地获取模块文件。

仅对于文件名使用`__file__.split(os.path.sep)[-1]`.

对于完整路径使用`os.path.abspath(__file__)`。

演示：

```
/tmp $ cat f.py
from pprint import pprint
import os
import sys

pprint({
    'sys.modules[__name__]': sys.modules[__name__],
    '__file__': __file__,
    '__file__.split(os.path.sep)[-1]': __file__.split(os.path.sep)[-1],
    'os.path.abspath(__file__)': os.path.abspath(__file__),
})

/tmp $ cat i.py
import f 
```

结果：

```
## on *Nix ##

/tmp $ python3 f.py
{'sys.modules[__name__]': <module '__main__' from 'f.py'>,
 '__file__': 'f.py',
 '__file__.split(os.path.sep)[-1]': 'f.py',
 'os.path.abspath(__file__)': '/tmp/f.py'}

/tmp $ python3 i.py
{'sys.modules[__name__]': <module 'f' from '/tmp/f.pyc'>,
 '__file__': '/tmp/f.pyc',
 '__file__.split(os.path.sep)[-1]': 'f.pyc',
 'os.path.abspath(__file__)': '/tmp/f.pyc'}

## on Windows ##

PS C:\tmp> python3.exe f.py
{'sys.modules[__name__]': <module '__main__' from 'f.py'>,
 '__file__': 'f.py',
 '__file__.split(os.path.sep)[-1]': 'f.py',
 'os.path.abspath(__file__)': 'C:\\tools\\cygwin\\tmp\\f.py'}

PS C:\tmp> python3.exe i.py
{'sys.modules[__name__]': <module 'f' from 'C:\\tools\\cygwin\\tmp\\f.py'>,
 '__file__': 'C:\\tools\\cygwin\\tmp\\f.py',
 '__file__.split(os.path.sep)[-1]': 'f.py',
 'os.path.abspath(__file__)': 'C:\\tools\\cygwin\\tmp\\f.py'} 
```

如果您想从末尾剥离“.py”，您可以轻松做到这一点。（但不要忘记你可以运行一个 '.pyc' 来代替。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-02T15:59:54.813

我不相信这是可能的，因为这超出了`foo`' 的范围。foo 只会知道它的内部范围，因为它可能被无数其他模块和应用程序调用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-11-03T14:06:59.690

如果您只想要文件名：

```
file_name = __file__.split("/")[len(__file__.split("/"))-1] 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-02T16:28:00.783

自从我做 python 以来已经有一段时间了，但我相信你可以通过它的[traceback](http://docs.python.org/library/traceback.html)访问调用者的全局变量和局部变量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-18T17:42:48.160

要获取包含文件夹的当前文件模块，这对我有用：

```
 import os
 parts = os.path.splitext(__name__)
 module_name = parts[len(parts) - 2] 
```

# sql - 如何在 SQL 中实现布尔标记搜索？

> ID：602849
> 
> 赞同：3
> 
> 时间：2009-03-02T15:56:35.883
> 
> 标签：sql, database, search, tags

给定一个项目表，一个标签表和它们之间的连接表，什么是实现表单查询的好且有效的方法：

`p1 AND p2 AND ... AND pn AND NOT n1 AND NOT n2 ... AND NOT nk`

我正在使用 SQL。因此，要找到与所有标签 p1...pn 匹配且不匹配 n1...nk 的所有项目？

有没有一个好的“标准”解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T15:59:34.363

我想这就是你要找的：

```
SELECT * FROM TABLE_NAME WHERE COLUMN1 IN ('value1','value2','value3') AND COLUMN1 NOT IN ('value4','value5','value6') 
```

如果没有，请告诉我。我可能误解了你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T15:59:44.143

这取决于您如何在数据库中存储标签，但您可能需要`IN`运算符：

```
SELECT tag FROM myTags WHERE tag IN ('p1','p2',...)
SELECT tag FROM myTags WHERE tag NOT IN ('p1','p2',...) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:06:29.667

在不知道您的架构的情况下很难说，但这样的事情会起作用：

```
select article_id from articles
inner join tag t1 on t1.article_id=articles.article_id and t1.tag='included_tag'
inner join tag t2 on t2.article_id=articles.article_id and t2.tag='another_included_tag'
left outer join tag t3 on t3.article_id=articles.article_id and t3.tag='dont_include_tag'
left outer join tag t4 on t4.article_id=articles.article_id and t4.tag='also_dont_include_tag'
where t3.tag_id is null and t4.tag_id is null 
```

对要包含的标签进行内连接，并对不包含的标签执行反连接（外连接 + 其中必填列为空）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T16:02:30.113

```
SELECT DISTINCT itemID FROM ItemsTags it, Tags t 
WHERE it.tagID = t.ID AND t.tag IN ('p1','p2','p3') AND t.tag NOT IN ('p4','p5','p6') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T16:23:18.300

```
SELECT i.title
  FROM items i
 WHERE EXISTS(SELECT * FROM join_table j JOIN tags t ON t.id = j.tag_id WHERE j.item_id = i.id AND t.name = 'tag1')
   AND NOT EXISTS(SELECT * FROM join_table j JOIN tags t ON t.id = j.tag_id WHERE j.item_id = i.id AND t.name = 'tag2') 
```

SQL Server 在这个结构方面做得很好，但 Oracle 可能需要一些提示才能让它正确（至少 5 年前它做到了）。

# tomcat - Solr 容器

> ID：602857
> 
> 赞同：6
> 
> 时间：2009-03-02T15:59:43.427
> 
> 标签：tomcat, solr, jetty

什么是 SOLR 更好的容器：Tomcat 或 Jetty

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-03-18T02:27:51.813

由于它的[大小](http://wiki.apache.org/solr/FAQ#Solr_Comes_with_Jetty.2C_is_Jetty_the_recommended_Servlet_Container_to_use_when_running_Solr.3F)，Jetty 与 Solr 捆绑在一起：

> Solr 示例应用程序中包含 Jetty 只是因为在我们设置它时，Jetty 是我们发现可以以跨平台方式轻松运行的最简单/最小的 servlet 容器（即：“java -jar start.jar”） . 这并不意味着 Solr 在 Jetty 下运行得更好，或者 Jetty 仅适用于演示 - 只是 Jetty 使我们的演示设置更容易。
> 
> 用户应根据自己的需求/经验自行决定他们认为最适合其用例的 Servlet 容器。对于高流量场景，花时间调整 servlet 容器通常会产生很大的不同。

几个月来，我一直在使用 Jetty 为几个小型站点运行 Solr，并且没有遇到任何问题。

我投票给 Jetty。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-14T19:57:52.457

Tomcat. We had some large documents truncated and dropped using Jetty.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T16:08:30.707

> 它在 Java servlet 容器（如 Tomcat）中运行。

没关系，因为它们都是 servlet 容器。使用你觉得最舒服的任何东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-08T20:06:24.930

我将 Solr 与 Tomcat6 一起使用，没有任何问题。

Solr 和 Tomcat 都是 Apache 产品，而且 Solr 仍然带有轻量级的 Jetty，这一事实一定意味着什么。

以下是一些 Tomcat 与 Jetty 的链接：
[http ://www.slideshare.net/noriaki/jetty-vs-tomcat](http://www.slideshare.net/noriaki/jetty-vs-tomcat)
[http://www.asjava.com/jetty/jetty-vs-tomcat-performance-comparison/](http://www.asjava.com/jetty/jetty-vs-tomcat-performance-comparison/)

从 Jetty 布道者的角度来看：
[http ://www.webtide.com/choose/jetty.jsp](http://www.webtide.com/choose/jetty.jsp)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-05T17:13:27.743

在使用 Solr 进行快速原型设计时，我主要使用 jetty。因为 Jetty 是用 Solr 打包的，所以使用起来非常方便。但是，我们在生产中使用 Tomcat6。过渡很容易。

我想说的是你最初最舒服的。

根据 Solr Wiki：“对于重要的安装，建议使用 JettyPlus。” [http://wiki.apache.org/solr/SolrJetty](http://wiki.apache.org/solr/SolrJetty)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-08T15:13:57.517

码头有一些关于 unicode 文本的问题（或者至少在我上次处理它时有）。所以如果你有非英文文档要索引，你唯一的选择是 Tomcat。此外，如果您正在考虑在 64 位 Windows Server 上运行 solr - 您可以获得 64 位 Tomcat，但我认为没有可用的 64 位 Jetty 服务器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T16:07:15.467

不要认为这特别重要，它们都会起作用。

如果您已经在使用其中任何一个，请坚持使用。

如果不是……好吧，鉴于[Solr](http://lucene.apache.org/solr/)和[Lucene都是 Apache 项目，与](http://lucene.apache.org/)[Tomcat](http://tomcat.apache.org/)一起使用似乎更简单。

如果你确实想和[Jetty](http://www.mortbay.org/jetty/)一起去，[你可以](http://wiki.apache.org/solr/SolrJetty)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-03T16:45:10.867

与 tomcat6 一起使用没问题，但是您需要在每次架构更改时重新加载 tomcat

# c# - 我应该从函数返回数组还是集合？

> ID：602860
> 
> 赞同：16
> 
> 时间：2009-03-02T16:00:11.490
> 
> 标签：c#, .net, return-type

从函数返回多个相同类型的对象时，首选的容器类型是什么？

返回一个简单的数组（如 MyType[]）是否违反良好习惯，还是应该将其包装在某个通用容器中（如 ICollection<MyType>）？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-02T16:02:47.757

Eric Lippert 对此有一篇很好的[文章](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)。万一你懒得看整篇文章，答案是：返回接口。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-24T01:20:52.443

`IEnumerable<T>`使用 a返回一个[`yield return`](http://msdn.microsoft.com/en-us/library/9k7k7cf0.aspx)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-24T01:22:19.227

我会返回一个`IList<T>`，因为它可以为您的函数的使用者提供最大的灵活性。这样，如果您的函数的使用者只需要枚举他们可以这样做的序列，但如果他们想将序列用作列表，他们也可以这样做。

我的一般经验法则是接受限制最少的类型作为参数并返回我能返回的最丰富的类型。当然，这是一种平衡行为，因为您不想将自己锁定在任何特定的接口或实现中（但总是，总是尝试使用接口）。

这是 API 开发人员可以采取的最不冒昧的方法。您不能决定函数的使用者如何使用他们发送给您的内容——这就是为什么`IList<T>`在这种情况下您将返回 an 以给予他们最大的灵活性。同样出于同样的原因，您永远不会假设知道消费者会发送给您什么类型的参数。如果您只需要迭代作为参数发送给您的序列，则将参数设为 an`IEnumerable<T>`而不是 a `List<T>`。

* * *

**编辑（一氧化碳）：**由于看起来问题不会被关闭，我只想添加另一个问题的链接：[Why arrays are dangerous](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-02T16:02:41.157

为什么不`List<T>`呢？

从其他人提到的 Eric Lippert 帖子中，我想我会强调这一点：

> 如果我需要一个序列，我将使用 `IEnumerable<T>`，如果我需要从连续数字到数据的映射，我将使用 a `List<T>`，如果我需要跨任意数据的映射，我将使用 a `Dictionary<K,V>`，如果我需要一个集合，我将使用 a `HashSet<T>`. 我根本不需要任何数组，所以我几乎从不使用它们。他们没有比我可以使用的其他工具更好地解决我的问题。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-02T16:06:50.400

如果返回的集合是只读的，这意味着您永远不希望集合中的元素被更改，然后使用`IEnumerable<T>`. 这是不可变（至少从枚举本身的角度）元素的只读序列的最基本表示。

如果您希望它是一个可以更改的独立集合，请使用`ICollection<T>`或`IList<T>`。

例如，如果您想返回搜索特定文件集的结果，则返回`IEnumerable<FileInfo>`.

但是，如果您想公开目录中的文件，那么您将公开`IList/ICollection<FileInfo>`，因为您可能希望更改集合的内容。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-24T01:30:20.037

我经常听到的一个很好的建议是：

> 在你接受的东西上要自由，在你提供的东西上要精确。

在设计你的 API 方面，我建议你应该返回一个接口，而不是一个具体的类型。

以您的示例方法为例，我将其重写如下：

```
public IList<object> Foo() 
{
    List<object> retList = new List<object>();
    // Blah, blah, [snip]
    return retList;
} 
```

关键是您的内部实现选择 - 使用 List - 不会向调用者透露，但您正在返回一个适当的接口。

Microsoft 自己的框架开发指南建议不要返回特定类型，而偏向于接口。（对不起，我找不到这个链接）

同样，您的参数应该尽可能通用 - 而不是接受数组，而是接受适当类型的 IEnumerable。这与数组以及列表和其他有用的类型兼容。

再次采用您的示例方法：

```
public IList<object> Foo(IEnumerable<object> bar) 
{
    List<object> retList = new List<object>();
    // Blah, blah, [snip]
    return retList;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-02T16:04:34.600

```
return ICollection<type> 
```

泛型返回类型的优点是您可以更改底层实现而不更改使用它的代码。返回特定类型的好处是您可以使用更多类型特定的方法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-02T16:02:29.537

始终返回向调用者提供最多功能的接口类型。所以在你的情况下`ICollection<YourType>`应该使用。

值得注意的是，BCL 开发人员实际上在 .NET 框架的某个地方犯了这个错误 - 请参阅[这篇 Eric Lippert 博客文章](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)了解该故事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T16:04:46.083

为什么不`IList<MyType>`呢？

它支持直接索引，这是数组的标志，而不会消除返回`List<MyType>`某一天的可能性。如果你想抑制这个特性，你可能想返回`IEnumerable<MyType>`.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-24T01:23:45.433

这取决于您打算如何处理要返回的集合。如果您只是在迭代，或者您只希望用户进行迭代，那么我同意@Daniel，return `IEnumerable<T>`。但是，如果您真的想允许基于列表的操作，我会返回`IList<T>`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T16:02:03.187

使用泛型。与其他集合类互操作更容易，类型系统更能帮助您解决潜在的错误。

返回数组的旧样式是泛型之前的拐杖。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T16:02:57.193

是什么让您的代码对您来说更易读、更易于维护和更容易。大多数时候我会使用简单的数组，更简单==更好。虽然我真的必须看到上下文才能给出正确的答案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-02T16:14:32.377

IEnumerable 优于其他任何东西都有很大的优势，因为这为您提供了最大的实现灵活性，并允许您使用`yield return`或 Linq 运算符进行惰性实现。

如果调用者想要 a`List<T>`相反，他们可以简单地调用`ToList()`您返回的任何内容，整体性能将与您从方法中创建并返回一个新的大致相同`List<T>`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-02T16:14:50.007

数组是有害的，但`ICollection<T>`也是有害的。

`ICollection<T>`不能保证对象是不可变的。

我的建议是用`ReadOnlyCollection<T>`

# c# - 生成 licenses.licx

> ID：602867
> 
> 赞同：9
> 
> 时间：2009-03-02T16:01:50.863
> 
> 标签：c#, visual-studio-2008, licensing, licenses.licx, emptylicenseslicx

我有一点问题。我正在将我的源存储库从一台机器移动到另一台机器，并且在此过程中，我正在对存储的内容进行一些挑选，因为我从一开始就了解了有关创建/管理存储库的更多信息。

问题是我们使用的是 devexpress 的 dxperience 工具，它使用 .net 许可系统 (licenses.licx)。最初我在存储库中有这个许可证，[我听说](https://stackoverflow.com/questions/51363/how-does-the-licenses-licx-based-net-component-licensing-model-work)这不一定是最好的主意。所以我没有将它包含在存储库中。但是现在，当我从我的机器上的存储库中签出项目时（我在移动之前签出的同一台机器），它正在寻找许可证文件，而不是按照（我认为）它应该的那样生成它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T16:08:07.230

我们在使用 Infragistics 控件时遇到了同样的问题。

我们的解决方案是在我们的源存储库（Source Gear Vault）中保留一个空白的 licnenses.licx 文件，然后在我们的本地工作中将该文件的属性更改为 Read Only false。这样，我们就不会最终使用该文件相互踩踏，而是使用我们工作站上的正确密钥生成它。

当然，这是一个可能不适合您的手动工作，但这就是我们一直在做的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-24T22:28:04.740

或者，您可以安装[EmptyLicensesLicx](https://github.com/caioproiete/EmptyLicensesLicx) nuget 包，它会在编译之前确保`Licenses.licx`您的项目中有一个空包（这就是您所需要的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T16:06:17.763

通过将 licenses.licx 作为**嵌入式资源**包含在内，该文件应自动编译到您的部署程序集中。在后台，Visual Studio 使用 lc.exe 将其包含在您的程序集中。

[http://www.atalasoft.com/kb/Article.aspx?id=10103](http://www.atalasoft.com/kb/Article.aspx?id=10103)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-10-23T13:52:55.140

1.  删除现有的许可证文件
2.  解决所有错误
3.  检查解决方案的属性、DLL 名称、源名称
4.  重建项目

# c# - 根据活动控件更改 AcceptButton

> ID：602876
> 
> 赞同：1
> 
> 时间：2009-03-02T16:03:29.393
> 
> 标签：c#, .net, winforms, visual-studio-2008

我有一个有效的 WinForm 来处理我的客户数据库中的搜索功能。它包含以下控件：

*   输入搜索字符串的文本框 (A)
*   “搜索”按钮 (B)
*   返回搜索结果的 DataGridView (C)
*   “确定”按钮 (D) 和“取消”按钮 (E)

我接下来要尝试的是：

1.  当 A 处于活动状态时，AcceptButton (enter) 应该链接到 B
2.  当 B 或 enter 被按下时 C 应该被激活
3.  当 C 处于活动状态时，AcceptButton 应链接到 D

我意识到这是一个有点大的问题，所以如果你知道答案，请不要犹豫，只回答一个项目符号。

编辑：我已经解决了上面要求 1 和 3 的实现，但我仍在寻找第二个的答案。澄清一下，当搜索开始时（意味着我已经按下键盘上的 Enter 或鼠标的搜索按钮）我希望焦点转移到 DataGridView 中的第一行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:15:34.107

当您获得 textBox 的文本更改事件时，将 AcceptButton 设置为“搜索”：

```
 private void textBox1_TextChanged(object sender, EventArgs e)
    {
        this.AcceptButton = SearchButton;
    } 
```

这里可能需要更多代码，检查字符串的长度等。

然后，一旦您完成搜索并填写 DataGridView，您就可以将 AcceptButton 设置为“OK”。

```
 private void dataGridView1_DataMemberChanged(object sender, EventArgs e)
    {
        this.AcceptButton = OKButton;
    } 
```

尽管您可能不想使用此事件。

“取消”始终是取消按钮。

编辑：对于第 2 部分，您需要以下代码：

```
 private void SearchButton_Click(object sender, EventArgs e)
    {
        dataGridView1.Focus();
    } 
```

这将在按下搜索按钮后立即激活它，但您可能希望在填充 DataGridView 时执行此操作 - 以防搜索未返回任何结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:07:24.187

设置处理程序以跟踪`Control.Enter`特定控件的事件。当进入时尝试：

```
this.AcceptButton = ControlThatShouldBeAcceptButton; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T16:08:21.317

```
private void WhateverControl_Enter(...)
{
    this.AcceptButton = myButton;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T12:25:34.977

您应该为 DataGridViewBindingCompleteEventHandler 实现一个事件侦听器。在这种情况下，您可以添加以下代码：

```
{
    if(grid.Rows.Count > 0)
    {
        grid.ClearSelection();
        grid.Rows[0].Selected = true;
    }
    grid.Focus();
} 
```

# wcf - 您将如何将 wcf 服务与 Windows 服务进行通信？

> ID：602877
> 
> 赞同：2
> 
> 时间：2009-03-02T16:03:33.527
> 
> 标签：wcf, windows-services, ipc

两周前，我需要一种方法来将 wcf 服务与运行在同一台计算机上的 Windows 服务进行通信。Windows 服务必须从外部源获取数据并与 wcf 服务（托管在 IIS 中）共享，后者必须在客户端发出请求时提供数据。我选择用ipc来做。

我做到了，现在windows服务是ipc服务器，wcf服务是ipc客户端。这很顺利，但我认为我这样做是错误的，因为要使其正常运行，必须使用 ASPNET 帐户执行 Windows 服务，为此必须分配 ASPNET 密码帐户，当我这样做时，IIS 无法正常工作.

我正在考虑不同的选择，但在所有这些选择中，问题仍然存在。一些想法？

* * *

### 编辑：

我需要的是一个公开的系统，在 IIS 中托管的 Web 服务中，通过 telnet 从另一个旧系统获取数据，有点不稳定。这第二个系统的响应速度有多慢我选择在 Web 服务和旧系统之间放置一个进程（Windows 服务）。Windows 服务必须保存从旧系统收集的数据，当 wcf 服务要求它通过 ipc 一次性提供所有数据时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T02:12:18.120

为什么windows服务需要以ASPNET用户身份运行？那是因为您使用的 IPC 连接需要来自调用者的身份验证吗？

另一种选择（如果您可以控制 Windows 服务代码）也将其设为 WCF 服务（在 Windows 服务中使用 ServiceHost）。如果您需要类似 IPC 的性能，IIS 服务可以使用 NetTcp 或 NetNamedPipe 绑定连接到 Windows 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T16:08:00.380

为什么不直接创建另一个具有与 WCF 服务和您的其他服务运行的 ASPNET 用户相同的权限集的帐户？这样，您就可以控制密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T02:17:57.387

理想情况下，windows 服务应该作为 WCF 服务运行，这样客户端很容易与它通信。

下一个问题是“客户端”需要成为 WCF 服务的天气。如果此客户端需要为其他应用程序提供服务，那么它是合适的，否则它可能不是必需的。我对您的系统知之甚少，所以由您决定什么是最好的！

# jquery - 如何获取子元素的位置

> ID：602886
> 
> 赞同：15
> 
> 时间：2009-03-02T16:05:25.130
> 
> 标签：jquery, html

我需要找到一个子元素的位置。

我有一张桌子，当点击 td 时，我想要 td 的位置（0,1 或 2）

```
<table>
<tr>
 <td>   

 </td>
 <td>   

 </td>
 <td>

 </td>
</tr>
</table> 
```

和这样的脚本

```
<script>
$("td").click(function(){
  //how do i get the position of the td?
  alert("column " + columnPosition + "is clicked")
});
</script> 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-02T16:10:43.417

```
<script>
$("td").click(function(){
  //how do i get the position of the td?
  alert("column " + $(this).parent().children().index(this) + " is clicked")
});
</script> 
```

编辑：我测试了它，它可以工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T16:46:03.623

仅供参考，这个不错

```
<div>First div</div>
<div>Second div</div>
<div>Third div</div>
<div>Fourth div</div>

<script>
 $( "div" ).click(function() {
    // `this` is the DOM element that was clicked
    var index = $( "div" ).index( this );
    $( "span" ).text( "That was div index #" + index );
 });
</script> 
```

* * *

[参考这里](http://api.jquery.com/index/)

# asp.net - ASP.NET 安装项目 - 如何包含不在 VS 中的静态文件？

> ID：602894
> 
> 赞同：4
> 
> 时间：2009-03-02T16:07:13.720
> 
> 标签：asp.net, svn, file, installation

我正在开发一个 ASP.NET MVC Web 应用程序，并且正在开发 Web 设置部分。我们使用 SVN 进行版本控制。其中一个问题是我们目前遇到的问题是网页设计人员修改并添加了许多最终位于 Content 文件夹中的 html、css 和 js 文件，但他们没有将它们添加到 VS 项目中，所以新文件不会包含在安装程序中。

一种选择是我们必须尝试教他们始终进入 VS 并手动添加文件，但我们正在进行一个大型项目，并且正处于紧要关头，因此试图让人们学习技术中的新东西他们不知道会导致太多错误，所以如果可能的话，我想解决这个问题。

有没有办法让安装项目只包含文件系统上文件夹中的文件，而不是项目的指定内容文件？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:10:03.150

我想我已经弄清楚了：

确保安装程序项目包含 Web 应用程序的内容文件。然后使用文本编辑器进入 Web 应用程序的 csproj 文件并找到列出静态内容文件的 ItemGroup。然后添加一个带有通配符的条目，安装程序会将它们打包进去。

```
<ItemGroup>
    <Content Include="Content\test.html" />
    <Content Include="Content\*.html" />
        <Content Include="Content\*.gif" />
       <Content Include="Content\*.css" />
       <Content Include="Content\*.jpg" />
       <Content Include="Content\*\*.js" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:49:05.210

右键单击 Web 设置项目的文件系统视图中的文件夹，然后选择添加、文件...

不过，您似乎无法通过这种方式添加整个文件夹，因此您必须将每个文件单独添加到安装程序中。

编辑：

项目文件夹中的所有文件不是都包含在 Visual Studio 的网站项目中吗？然后就是你的WebSite项目和Web Setup项目在同一个解决方案中的情况，然后右键单击Web Setup项目中的Web Application Folder，选择Add，Project Output...，然后选择WebSite Project中的从列表框中下拉和内容文件，然后单击确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T16:13:47.637

不幸的是，我认为没有现成的方法可以做到这一点，因为项目单独维护对文件的引用。

您可以通过自定义宏来实现您的需要，或者要求您的其他团队编辑 .csproj XML 文件（可能更简单或更冒险，具体取决于他们的背景）。

# java - 如何在兄弟项目之间实现 Maven 源依赖？

> ID：602905
> 
> 赞同：1
> 
> 时间：2009-03-02T16:09:46.553
> 
> 标签：java, maven-2, dependencies

我有一个 java 项目，它由 3 个子项目组成，每个子项目生成一个 .jar 工件（并且它们之间有子依赖项）。另外还有一个 web 项目，它依赖于前 3 个项目并生成一个 war 文件。战争文件是我的最终产物，即我发送给我的客户的东西。

此外，我有一个包含所有其他项目的父模块：

```
<modules>
    <module>../core</module>
    <module>../commons</module>
    <module>../api</module>
    <module>../web</module>
</modules> 
```

我生成 eclipse 文件 (mvn eclipse:eclipse) 并使用 eclipse。问题是如果我修改其中一个非 Web 项目，我必须在将 Web 项目部署到我的 Web 容器之前手动安装它。如何使 Web 项目直接依赖于其他项目的源代码，而不是依赖于存储库中安装的版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T16:41:38.413

在您的 Web 应用程序属性中（在 Package explorer 中右键单击项目，然后单击“属性”），在“J2EE 模块依赖项”中添加三个模块（core、commons 和 api）（其他模块必须在 Eclipse 中打开工作区）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T20:21:52.383

您想添加对部署到存储库的源 jar 的依赖吗？

如果是这样，您可以通过将*源*分类器添加到依赖项来实现。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/1191336/how-to-check-and-access-javadoc-source-for-maven-artifacts/1193313#1193313)。

如果没有，请您进一步澄清。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-05T18:08:59.967

我认为您的问题是您只是在构建战争项目。如果您是从命令行构建它，那么您必须构建的是父模块。包含父模块的目录中的“mvn package”应该足够了。当然这意味着你必须每次都构建所有的包，但这就是 maven 的工作方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-15T08:14:43.533

dependency:tree 目标本身将在存储库而不是反应器中查找内容。您可以按照前面的建议通过 mvn 安装来解决这个问题，或者做一些不那么繁琐的事情来调用反应器，例如

> mvn 编译依赖：树

为我工作。

编辑：哦！将此答案发布到错误的问题。本来是要回答[这个的](https://stackoverflow.com/questions/1677473/maven-doesnt-recognize-sibling-modules-when-running-mvn-dependencytree)

# asp.net - 将特定于网站的 ConnectionString 与 DLL 一起使用

> ID：602910
> 
> 赞同：2
> 
> 时间：2009-03-02T16:12:13.693
> 
> 标签：asp.net, dll, connection-string

**设置：**

我有一个使用 ConnectionString 连接到 SQL 数据库的 DLL。当我将 DLL 添加到我的网站时，我必须将连接字符串添加到我的 web.config 中，以使我的 DLL 正常运行（这是设计使然）。一旦我将它添加到 web.config 中，那么一切正常（如预期的那样）。

**问题：**

当我想将连接字符串移动到在 IIS > 默认网站 > 属性 > ASP.NET 选项卡 > 编辑全局配置... > 连接字符串管理器中找到的网站的 ASP.NET 应用程序设置中时，问题就开始了

如果我将它从我的 web.config 中删除并将其放在那里，我的 DLL 将无法工作。如果我在我网站的其他任何地方（而不是来自 DLL）使用连接字符串，我可以通过这种方法很好地访问数据库，但由于某种原因，我的 DLL 只能在 web.config 中访问它。

**问题：**

如何让我的 DLL 使用 ASP.NET 配置设置连接字符串管理器而不是 web.config 中列出的连接字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:28:56.633

您必须从通用 ASP.Net 配置设置中查找该部分，该部分可以通过 WebConfigurationManager 类检索，而不是通过 ConfigurationManager.ConnectionStrings 查找连接字符串。

```
 // Get the connectionStrings section.
ConnectionStringsSection connectionStringsSection =
    WebConfigurationManager.GetSection("connectionStrings")
    as ConnectionStringsSection;

// Get the connectionStrings key,value pairs collection.
ConnectionStringSettingsCollection connectionStrings =
    connectionStringsSection.ConnectionStrings;

// Get the collection enumerator.
IEnumerator connectionStringsEnum =
    connectionStrings.GetEnumerator(); 
```

# bash - 你如何在 Bash 中回显一个 4 位 Unicode 字符？

> ID：602912
> 
> 赞同：253
> 
> 时间：2009-03-02T16:12:56.250
> 
> 标签：bash, shell, unicode, character-encoding

我想将 Unicode 骷髅和交叉骨添加到我的 shell 提示符中（特别是**'SKULL AND CROSSBONES' (U+2620)**），但我无法弄清楚使 echo 吐出它的魔法咒语，或任何其他， 4 位 Unicode 字符。两位数的很容易。例如，`echo -e "\x55"`， 。

除了下面的答案之外，还应注意，显然，您的终端需要支持 Unicode 才能使输出达到您的预期。gnome-terminal 在这方面做得很好，但它不一定默认打开。

在 macOS 的终端应用程序上，转到 Preferences-> Encodings 并选择 Unicode (UTF-8)。

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2009-03-02T16:16:43.230

在 UTF-8 中，它实际上是 6 位数字（或 3 个字节）。

```
$ printf '\xE2\x98\xA0'
☠ 
```

要检查控制台如何对其进行编码，请使用 hexdump：

```
$ printf ☠ | hexdump
0000000 98e2 00a0                              
0000003 
```

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2009-03-02T16:29:14.043

```
% echo -e '\u2620'     # \u takes four hexadecimal digits
☠
% echo -e '\U0001f602' # \U takes eight hexadecimal digits 
```

这适用于 Zsh（我检查了 4.3 版）和[Bash 4.2](https://lists.gnu.org/archive/html/info-gnu/2011-02/msg00012.html#:%7E:text=UXXXXXXXX%20escape%20sequences)或更高版本。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2011-05-10T19:45:58.403

只要您的文本编辑器可以处理 Unicode（可能以 UTF-8 编码），您就可以直接输入 Unicode 代码点。

例如，在[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)文本编辑器中，您将进入插入模式并按`Ctrl`+ `V`+ `U`，然后按 4 位十六进制数的代码点编号（必要时用零填充）。所以你会输入`Ctrl`++ 。请参阅：[将 Unicode 字符插入文档的最简单方法是什么？](https://vi.stackexchange.com/q/2254/467)`V``U` `2` `6` `2` `0`

在运行 Bash 的终端上，您将键入`CTRL`++并键入`SHIFT`所需`U`字符的十六进制代码点。在输入过程中，您的光标应显示带下划线的`u`。您键入的第一个非数字结束输入，并呈现字符。因此，您可以使用以下命令在 Bash 中打印 U+2620：

`e``c``h``o``CTRL`+ `SHIFT`+`U``2``6``2``0``ENTER``ENTER`

（第一个输入结束 Unicode 输入，第二个运行`echo`命令。）

学分：[询问 Ubuntu SE](https://askubuntu.com/questions/32764/using-alt-keycode-for-accents/32768#32768)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2013-05-12T16:12:14.533

这是一个完全内部的 Bash 实现，没有分叉，Unicode 字符的大小不受限制。

```
fast_chr() {
    local __octal
    local __char
    printf -v __octal '%03o' $1
    printf -v __char \\$__octal
    REPLY=$__char
}

function unichr {
    local c=$1    # Ordinal of char
    local l=0    # Byte ctr
    local o=63    # Ceiling
    local p=128    # Accum. bits
    local s=''    # Output string

    (( c < 0x80 )) && { fast_chr "$c"; echo -n "$REPLY"; return; }

    while (( c > o )); do
        fast_chr $(( t = 0x80 | c & 0x3f ))
        s="$REPLY$s"
        (( c >>= 6, l++, p += o+1, o>>=1 ))
    done

    fast_chr $(( t = p | c ))
    echo -n "$REPLY$s"
}

## test harness
for (( i=0x2500; i<0x2600; i++ )); do
    unichr $i
done 
```

输出是：

```
─━│┃┄┅┆┇┈┉┊┋┌┍┎┏
┐┑┒┓└┕┖┗┘┙┚┛├┝┞┟
┠┡┢┣┤┥┦┧┨┩┪┫┬┭┮┯
┰┱┲┳┴┵┶┷┸┹┺┻┼┽┾┿
╀╁╂╃╄╅╆╇╈╉╊╋╌╍╎╏
═║╒╓╔╕╖╗╘╙╚╛╜╝╞╟
╠╡╢╣╤╥╦╧╨╩╪╫╬╭╮╯
╰╱╲╳╴╵╶╷╸╹╺╻╼╽╾╿
▀▁▂▃▄▅▆▇█▉▊▋▌▍▎▏
▐░▒▓▔▕▖▗▘▙▚▛▜▝▞▟
■□▢▣▤▥▦▧▨▩▪▫▬▭▮▯
▰▱▲△▴▵▶▷▸▹►▻▼▽▾▿
◀◁◂◃◄◅◆◇◈◉◊○◌◍◎●
◐◑◒◓◔◕◖◗◘◙◚◛◜◝◞◟
◠◡◢◣◤◥◦◧◨◩◪◫◬◭◮◯
◰◱◲◳◴◵◶◷◸◹◺◻◼◽◾◿ 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-04-22T21:48:29.983

将 UTF-8 字符转换为 3 字节格式的快速单行器：

```
var="$(echo -n '☠' | od -An -tx1)"; printf '\\x%s' ${var^^}; echo 
```

或者

```
echo -n '☠' | od -An -tx1 | sed 's/ /\\x/g' 
```

两者的输出都是`\xE2\x98\xA0`，所以你可以反过来写：

```
echo $'\xe2\x98\xa0'   # ☠ 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-03-02T16:16:31.843

只需在您的 shell 脚本中输入“☠”即可。在正确的语言环境和支持 Unicode 的控制台上，它会打印得很好：

```
$ echo ☠
☠
$ 
```

一个丑陋的“解决方法”是输出 UTF-8 序列，但这也取决于使用的编码：

```
$ echo -e '\xE2\x98\xA0'
☠
$ 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-06-08T15:05:29.383

在 bash 中打印 Unicode 字符以输出使用 \x,\u 或 \U （第一个用于 2 位十六进制，第二个用于 4 位十六进制，第三个用于任何长度）

```
echo -e '\U1f602' 
```

我想将它分配给变量使用 $'...' 语法

```
x=$'\U1f602'
echo $x 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2019-04-11T18:49:28.973

以下是所有可用的 unicode 表情符号的列表：

[https://en.wikipedia.org/wiki/Emoji#Unicode_blocks](https://en.wikipedia.org/wiki/Emoji#Unicode_blocks)

例子：

```
echo -e "\U1F304" 
```

要获取此字符的 ASCII 值，请使用 hexdump

```
echo -e "" | hexdump -C

00000000  f0 9f 8c 84 0a                                    |.....|
00000005 
```

然后使用以十六进制格式通知的值

```
echo -e "\xF0\x9F\x8C\x84\x0A" 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-12-01T08:55:59.740

我正在使用这个：

```
$ echo -e '\u2620'
☠ 
```

这比搜索十六进制表示要容易得多……我在我的 shell 脚本中使用它。这适用于 gnome-term 和 urxvt AFAIK。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-02-18T04:44:11.037

这三个命令中的任何一个都将在控制台中打印您想要的字符，前提是控制台确实接受[UTF-8](http://en.wikipedia.org/wiki/UTF-8)字符（大多数当前的都接受）：

```
echo -e "SKULL AND CROSSBONES (U+2620) \U02620"
echo $'SKULL AND CROSSBONES (U+2620) \U02620'
printf "%b" "SKULL AND CROSSBONES (U+2620) \U02620\n"

SKULL AND CROSSBONES (U+2620) ☠ 
```

之后，您可以将实际字形（图像、字符）复制并粘贴到任何（启用 UTF-8 的）文本编辑器中。

如果您需要查看此类 Unicode 代码点如何以 UTF-8 编码，请使用 xxd（比 od 更好的十六进制查看器）：

```
echo $'(U+2620) \U02620' | xxd
0000000: 2855 2b32 3632 3029 20e2 98a0 0a         (U+2620) ....

That means that the UTF8 encoding is: e2 98 a0 
```

或者，在 HEX 中避免错误：0xE2 0x98 0xA0。也就是说，空格（HEX 20）和换行符（Hex 0A）之间的值。

如果您想深入了解将数字转换为字符：[请在此处](http://mywiki.wooledge.org/BashFAQ/071)查看 Greg 的 wiki (BashFAQ) 中关于 Bash 中的 ASCII 编码的文章！

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-04-09T13:45:12.847

您可能需要将代码点编码为八进制，以便快速扩展以正确解码它。

编码为 UTF-8 的 U+2620 是 E2 98 A0。

所以在 Bash 中，

```
export PS1="\342\230\240" 
```

会让你的shell提示成头骨和骨头。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-10-17T16:23:55.207

如果你不介意 Perl 单行：

```
$ perl -CS -E 'say "\x{2620}"'
☠ 
```

`-CS`在输入上启用 UTF-8 解码，在输出上启用 UTF-8 编码。`-E`将下一个参数评估为 Perl，具有启用等现代功能`say`。如果您不希望最后有换行符，请使用`print`而不是`say`.

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-03-17T10:04:43.283

很抱歉再次提出这个老问题。但是当使用时，`bash`有一种非常简单的方法可以从纯 ASCII 输入创建 Unicode 代码点，甚至**根本不分叉**：

```
unicode() { local -n a="$1"; local c; printf -vc '\\U%08x' "$2"; printf -va "$c"; }
unicodes() { local a c; for a; do printf -vc '\\U%08x' "$a"; printf "$c"; done; }; 
```

如下使用它来定义某些代码点

```
unicode crossbones 0x2620
echo "$crossbones" 
```

或将前 65536 个 unicode 代码点转储到标准输出（在我的机器上花费不到 2 秒。额外的空间是为了防止某些字符由于 shell 的等宽字体而相互流入）：

```
for a in {0..65535}; do unicodes "$a"; printf ' '; done 
```

或者讲一个非常典型的父母故事（这需要 Unicode 2010）：

```
unicodes 0x1F6BC 32 43 32 0x1F62D 32 32 43 32 0x1F37C 32 61 32 0x263A 32 32 43 32 0x1F4A9 10 
```

解释：

*   `printf '\UXXXXXXXX'`打印出任何 Unicode 字符
*   `printf '\\U%08x' number`打印`\UXXXXXXXX`转换为十六进制的数字，然后将其馈送到另一个`printf`以实际打印出 Unicode 字符
*   `printf`将八进制 (0oct)、十六进制 (0xHEX) 和十进制（0 或以 1 到 9 开头的数字）识别为数字，因此您可以选择最适合的表示
*   `printf -v var ..`将 的输出收集`printf`到一个变量中，**没有分叉**（这极大地加快了速度）
*   `local variable`有没有污染全局命名空间
*   `local -n var=other``var`给的别名`other`，这样对`var`改变的赋值`other`。这里一个有趣的部分是，它`var`是本地命名空间`other`的一部分，而它是全局命名空间的一部分。
    *   请注意`local`，`global`在`bash`. 变量保存在环境中，并且始终是全局的。Local 只是将当前值收起，并在再次离开该函数时将其恢复。从函数内部调用的其他函数`local`仍将看到“本地”值。这是一个与在其他语言中发现的所有正常范围规则完全不同的概念（并且这样`bash`做非常强大，但如果您是不了解这一点的程序员，可能会导致错误）。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-11-25T21:01:30.140

在 Bash 中：

```
UnicodePointToUtf8()
{
    local x="$1"               # ok if '0x2620'
    x=${x/\\u/0x}              # '\u2620' -> '0x2620'
    x=${x/U+/0x}; x=${x/u+/0x} # 'U-2620' -> '0x2620'
    x=$((x)) # from hex to decimal
    local y=$x n=0
    [ $x -ge 0 ] || return 1
    while [ $y -gt 0 ]; do y=$((y>>1)); n=$((n+1)); done
    if [ $n -le 7 ]; then       # 7
        y=$x
    elif [ $n -le 11 ]; then    # 5+6
        y=" $(( ((x>> 6)&0x1F)+0xC0 )) \
            $(( (x&0x3F)+0x80 ))" 
    elif [ $n -le 16 ]; then    # 4+6+6
        y=" $(( ((x>>12)&0x0F)+0xE0 )) \
            $(( ((x>> 6)&0x3F)+0x80 )) \
            $(( (x&0x3F)+0x80 ))"
    else                        # 3+6+6+6
        y=" $(( ((x>>18)&0x07)+0xF0 )) \
            $(( ((x>>12)&0x3F)+0x80 )) \
            $(( ((x>> 6)&0x3F)+0x80 )) \
            $(( (x&0x3F)+0x80 ))"
    fi
    printf -v y '\\x%x' $y
    echo -n -e $y
}

# test
for (( i=0x2500; i<0x2600; i++ )); do
    UnicodePointToUtf8 $i
    [ "$(( i+1 & 0x1f ))" != 0 ] || echo ""
done
x='U+2620'
echo "$x -> $(UnicodePointToUtf8 $x)" 
```

输出：

```
─━│┃┄┅┆┇┈┉┊┋┌┍┎┏┐┑┒┓└┕┖┗┘┙┚┛├┝┞┟
┠┡┢┣┤┥┦┧┨┩┪┫┬┭┮┯┰┱┲┳┴┵┶┷┸┹┺┻┼┽┾┿
╀╁╂╃╄╅╆╇╈╉╊╋╌╍╎╏═║╒╓╔╕╖╗╘╙╚╛╜╝╞╟
╠╡╢╣╤╥╦╧╨╩╪╫╬╭╮╯╰╱╲╳╴╵╶╷╸╹╺╻╼╽╾╿
▀▁▂▃▄▅▆▇█▉▊▋▌▍▎▏▐░▒▓▔▕▖▗▘▙▚▛▜▝▞▟
■□▢▣▤▥▦▧▨▩▪▫▬▭▮▯▰▱▲△▴▵▶▷▸▹►▻▼▽▾▿
◀◁◂◃◄◅◆◇◈◉◊○◌◍◎●◐◑◒◓◔◕◖◗◘◙◚◛◜◝◞◟
◠◡◢◣◤◥◦◧◨◩◪◫◬◭◮◯◰◱◲◳◴◵◶◷◸◹◺◻◼◽◾◿
U+2620 -> ☠ 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-04-18T23:32:41.187

`printf`内置（就像 coreutils' `printf`）知道`\u`接受 4 位 Unicode 字符的转义序列：

```
 \uHHHH Unicode (ISO/IEC 10646) character with hex value HHHH (4 digits) 
```

使用 Bash 4.2.37(1) 进行测试：

```
$ printf '\u2620\n'
☠ 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-05-02T20:01:17.697

基于堆栈溢出问题*[Unix cut，删除第一个令牌](https://stackoverflow.com/questions/2428443)*和*[https://stackoverflow.com/a/15903654/781312](https://stackoverflow.com/a/15903654/781312)*：

```
(octal=$(echo -n ☠ | od -t o1 | head -1 | cut -d' ' -f2- | sed -e 's#\([0-9]\+\) *#\\0\1#g')
echo Octal representation is following $octal
echo -e "$octal") 
```

输出如下。

```
Octal representation is following \0342\0230\0240
☠ 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-10-26T19:49:05.317

使用 Python2/3 单行代码很容易：

```
$ python -c 'print u"\u2620"'    # python2
$ python3 -c 'print(u"\u2620")'  # python3 
```

结果是：

```
☠ 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-07-20T11:26:40.280

如果 unicode 字符的十六进制值已知

```
H="2620"
printf "%b" "\u$H" 
```

如果已知 unicode 字符的十进制值

```
declare -i U=2*4096+6*256+2*16
printf -vH "%x" $U              # convert to hex
printf "%b" "\u$H" 
```

# asp.net - 为什么嵌入的页面找不到我的 javascript 函数？

> ID：602918
> 
> 赞同：3
> 
> 时间：2009-03-02T16:14:55.840
> 
> 标签：asp.net, javascript

我有一个页面在页面的标题部分有一个简单的 javascript：

```
<script type="text/javascript">
    function doLogout() {
        var conf = confirm("Really log out?");
        if (conf === true) {      //changed == to === for boolean comparison
            $.post("logout.aspx");
        }
    }
</script> 
```

它使用 jQuery 将 AJAX 发布到我的注销页面。现在唯一的问题是，当我单击链接 ( `<a href="#" onclick="doLogout();">logout</a>`) 来触发此功能时，什么也没有发生。我检查了 FireBug 的控制台，它告诉我该函数没有定义。*这曾经发生在我身上，但我想我有时会*搞砸一堆代码来修复它。

有谁知道解决此问题的正确方法？

# 编辑

在做了很多谷歌搜索和尝试不同的事情之后，我发现这篇非常[简洁和信息丰富的帖子](http://forums.asp.net/p/1155910/1899157.aspx)。显然，正如链接文章所述，在网站中引用脚本的方式很重要，否则它将无法正常运行！希望这些信息对更多的人有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T16:19:30.073

如果您的 javascript 代码早期存在语法错误，也会发生这种情况。通常这只会被解释为不存在的函数（错误之后也没有任何函数）。检查此代码上方的代码（如果有）和此代码是否存在语法错误。

判断缓存是否错误的一种方法是打开 Firebug 并查看脚本源。如果页面被缓存，您将看不到您的代码。如果它已加载但有语法错误，则会显示代码，尽管它不会“找到”它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:16:47.677

我在页面被缓存时发生了这种情况，因此它没有加载新脚本。因此要修复它，请清除 Firefox 中的所有私有数据。不确定这是否有帮助，但它确实发生在我身上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:07:11.987

要测试的东西：

1）你能从别的东西调用这个函数吗？喜欢`<script>`在页面底部添加一个来调用它？

2）页面是否验证？有时，如果有一些像丢失的 HTML`</b>`

3）我已经开始包装我的javascript，`<![CDATA[ ]]>`以防万一我的javascript中有愚蠢的字符。

4）我假设你已经在其他浏览器中测试过这个并且有相同的行为，对吧？

5) 如果您还没有安装它，请安装[Web Developer](http://chrispederick.com/work/web-developer/) firefox 插件。它有一个漂亮的工具栏菜单，可以为您禁用缓存，以便重新加载所有内容。

6) 听起来很奇怪，我曾经遇到过一个 javascript 问题，这是因为我的文本编辑器如何保存 UTF-8 文件。我忘记了细节，但它添加了一些字节顺序标记或一些扰乱浏览器的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T16:43:44.867

The issue might occur if you have NoScript. You should check and make sure it's not blocking said script.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:46:56.770

供您测试的其他想法：

1.  FireBug 的 DOM 选项卡中定义的函数是什么？

2.  如果您从 FireBug 控制台调用 doLogout()，会发生什么？

3.  我认为这不是该页面上唯一的脚本。确保稍后的某些脚本没有修改`doLogout`为其他内容

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-23T13:50:12.290

I had the same issue and tried all that's been suggested here without success.

The only way I fixed it was by discovering that in the `<script src="jquery.js">` tag I was using in the head of the page I forgot to close it with its **`</script>`** causing the page to ignore all Javascript functions. So please check that your includes look like:

```
<script src="jquery.js"></script> 
```

I hope that helps. Ross.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-02T13:08:04.543

如果您使用 DevExpress 控件，这些链接可能会对您有所帮助：[如何注册和执行通过回调下载到客户端的 JavaScript](https://www.devexpress.com/Support/Center/Example/Details/E1138)以及[如何注册和执行通过回调（独立 JS 文件）下载到客户端的 JavaScript](https://www.devexpress.com/Support/Center/Example/Details/E4662)和[执行来自通过 ASPxCallback 面板动态创建的用户控件](https://www.devexpress.com/Support/Center/Question/Details/KA18783)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-11T23:49:08.137

我遇到了这个问题，发现问题只是名称中的一个错误的大小写字母。

调用：filterCheckbox()

对比

功能过滤检查框（）{}

问题：小写“box”与大写“Box”。

所以检查名称是否完全相同。

# unix - 我们可以使用什么 unix 命令将一些文本附加到文件中的特定行？

> ID：602921
> 
> 赞同：1
> 
> 时间：2009-03-02T16:16:14.480
> 
> 标签：unix, file, line, editing

有谁知道允许某人将一些文本附加到文件中特定行的末尾的一系列 unix 命令？

例如

1号线

2号线

3号线

4号线

我希望将文本“，额外信息”附加到第 3 行，以便文件现在看起来像这样：

1号线

2号线

第 3 行，额外信息

4号线

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T16:25:38.623

在 awk 中是：

```
awk '{s=$0; if( NR==3 ){ s=s ", Extra Information" } print s;}' myfile > newfile 
```

正确的 sed 版本：

```
sed -e '3s/$/, Extra Information/' -i myfile 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T16:20:19.010

这是一个可移植的版本`sed`（没有 -i 选项）：

```
sed '3s/$/Hello World/' myfile 
```

请注意，`myfile`未修改，因此您可以从可能的错误中恢复。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T16:26:34.720

```
awk 'NR == 3 { print $0 ", extra information" } NR != 3' myfile 
```

大括号之前的部分是*条件*：如果我们在第 3 行，我们附加一些文本。如果省略大括号，则默认操作是打印出来`$0`。根据需要重定向到新文件或管道到另一个程序。您不能重定向到您正在阅读的同一个文件。一个常见的解决方法是重定向到一个新文件，然后在命令成功时移动：

```
somecommand > oldfile.tmp && mv oldfile.tmp oldfile 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:23:01.700

```
sed -e "s/^Line 3/\0, extra info/" -i text.txt 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T16:32:15.500

珀尔：

```
perl -p -e's{\n}{, extra information\n} if $. ==3' myfile 
```

美元。是行号

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T17:09:20.310

如果您希望仅将额外信息附加到一行，则任何 sed/awk 单行代码都可以。

如果您想在文件中的（几乎）每一行附加一些内容，您应该创建第二个文件，其中包含每行的额外信息并使用`paste`：

```
$ cat myfile
line 1
line 2
line 3
line 4
$ cat extra 
something

something else
$ paste myfile extra
line 1  something
line 2
line 3  something else
line 4 
```

# c# - C# 编译器警告 1685

> ID：602927
> 
> 赞同：46
> 
> 时间：2009-03-02T16:18:02.773
> 
> 标签：c#, .net, compiler-warnings

因此，（似乎）出乎意料的是，我的项目开始收到编译器警告 1685：

> 预定义类型 'System.Runtime.CompilerServices.ExtensionAttribute' 在全局别名中的多个程序集中定义；使用来自 'c:\Program Files\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll' 的定义

感到困惑的是，我研究了 MSDN 文章以找出其原因。这是我找到的信息：

> Visual C# 参考：错误和警告编译器警告（级别 1）CS1685
> 
> 错误信息 预定义类型“System.type name”在全局别名中的多个程序集中定义；使用“文件名”中的定义
> 
> 当在两个程序集中找到预定义的系统类型（如 System.int32）时，会发生此错误。发生这种情况的一种方法是，如果您从两个不同的地方引用 mscorlib，例如尝试并排运行 .Net Framework 版本 1.0 和 1.1。
> 
> 编译器将仅使用其中一个程序集的定义。编译器仅搜索全局别名，不搜索定义/引用的库。如果您指定了 /nostdlib，编译器将搜索 Object，并在以后开始在找到 Object 的文件中搜索预定义类型。

现在我真的很摸不着头脑。

1.  我没有运行两个不同版本的 .NET Framework（除非您计算 2.0 和 3.5）。

2.  我没有引用任何可能让我怀疑的奇怪程序集。

3.  我不记得对我的应用程序进行任何会刺激这种变化的更改。

4.  我已验证所有组件都以 .NET Framework 版本 v2.0.50727 为目标。

我愿意接受有关如何纠正此问题的建议或想法。我将警告视为错误，这让我发疯。

真正让我烦恼的是我不知道它*为什么*会发生。发生的事情应该有一个可辨别的原因，我应该知道它们发生的原因。如果我不能解释它，我就无法准确地补救它。猜测永远不会令人满意。

该应用程序很简单，由一个类库和一个 Windows 窗体应用程序组成。

*   AC# 类库 DLL 提供封装数据库访问的基本功能。此 DLL 引用以下组件：

    *   系统
    *   系统核心
    *   系统核心数据
    *   系统数据
    *   System.Data.DataSetExtensions
    *   System.Data.OracleClient
    *   系统绘图
    *   System.Windows.Forms
    *   系统文件
    *   System.Xml.Linq
*   AC# Windows 窗体应用程序提供 UI。此应用程序引用以下组件：

    *   清洁代码
    *   CleanCodeControls（两者都提供语法编辑器支持，并且是针对 .NET 3.5 在本地构建的）。
    *   灵桥
    *   Roswell.Framework（上面的类库）
    *   系统
    *   系统核心
    *   系统数据
    *   System.Data.DataSetExtensions
    *   System.Data.OracleClient
    *   系统部署
    *   系统设计
    *   系统绘图
    *   System.Windows.Forms
    *   系统文件
    *   System.Xml.Linq

如果您需要更多信息，请告诉我，我很乐意提供。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2011-06-29T09:22:04.677

另一种简单的验证方法：在您的代码中，在某处临时使用该类。例子：

```
System.Runtime.CompilerServices.ExtensionAttribute x = null; 
```

在构建时，这将产生错误：

> 'c:\Program Files\Reference Assemblies\Microsoft\Framework\v3.5\System.Core.dll' 和......

并立即向您展示导致冲突的 2 个来源。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-02T16:20:29.320

LINQBridge 让我立即产生怀疑。这样做的全部目的是为 2.0 用户提供扩展属性/方法等。如果您有 3.5 (System.Core.dll)，请不要使用 LINQBridge。如果您出于某种模糊的原因*确实*需要 3.5 中的 LINQBridge（我想不出一个），那么您可能必须使用外部别名。但我**真的**怀疑你需要它！

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-02T16:32:50.337

马克几乎肯定是正确的。这是一种验证方法

1.  打开反射器.exe
2.  添加所有非系统程序集
3.  F3 并搜索 ExtensionAttribute

如果它出现在 System.Core 之外的任何地方，那么您就知道它来自哪里。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-11-09T13:48:01.680

此问题的另一个解决方案是为整个程序集使用全局别名：

参考 -> 属性 -> 别名 -> 将“全局”替换为其他内容

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-05-03T09:19:36.680

仅供参考：我遇到了同样的问题，并且能够通过使用 Resharper 的“优化引用”命令解决它，然后删除所有未使用的引用。不完全确定*为什么*会这样，但确实如此。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2015-01-08T14:13:49.150

此问题的另一个解决方案 => 右键单击​​项目 -> 属性 -> 构建 -> 将警告视为错误 -> 无

# jquery - 干燥 js.erb 文件（包括另一个 js.erb 文件）

> ID：602934
> 
> 赞同：8
> 
> 时间：2009-03-02T16:20:33.970
> 
> 标签：jquery, ruby-on-rails

我的大部分 js.erb 文件在底部都包含这样的内容：

```
$("#flash_message").html("<%= escape_javascript(content_tag(:p, flash[:note], :class => "note")) %>");
$("#flash_message").fadeOut(2000);
$("#loading").remove(); 
```

我想将这些行移动到一个单独的文件中，然后从我的每个 js.erb 文件中调用该文件。这样的事情可能吗？

最好的祝福。阿斯伯恩莫雷尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T18:25:58.067

是的，您可以创建一个`app/views/shared/_flash_messages.js.rjs`局部，然后您可以从任何地方（例如从其他局部）渲染它`rjs`。

我在这些类型的应用程序中的方法如下：

*   对于可能有 flash 的非 AJAX 响应：

    *   在布局（例如`layouts/application.erb`）中，添加例如：
        `render :partial => 'shared/flash_messages.html.erb'`
*   对于可能还需要显示 flash 消息的 AJAX 响应，我添加了以下`rjs`代码：

    *   在每个`rjs`响应（例如`controller/action.js.rjs`）中，添加例如：
        `render :partial => 'shared/flash_messages.js.rjs'`

如果这两个部分做了必要的渲染闪光灯，则调用`flash.discard(:error)`或`flash.discard(:notice)`酌情。

示例`app/views/shared/flash_messages.html.erb`文件：

```
<% if flash[:error] %>
<div id="flash_message" class="error"><%= h(flash[:error]) %></div>
<% flash.discard(:error) %>
<% elsif flash[:notice] %>
<div id="flash_message" class="notice"><%= h(flash[:notice]) %></div>
<% flash.discard(:notice) %>
<% else %>
<div id="flash_message" style="display: none;" />
<% end %> 
```

示例`app/views/shared/flash_messages.html.rjs`文件：

```
if !flash[:error].blank?
  page['flash_message'].
    replace_html(flash[:error]).
    removeClassName('notice').
    addClassName('error').
    show()
else
  page['flash_message'].
    replace_html(flash[:notice]).
    removeClassName('error').
    addClassName('notice').
    show()
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T18:25:15.887

`<%= render :partial => 'common' %>`， 也许？

[http://api.rubyonrails.org/classes/ActionController/Base.html#M000633](http://api.rubyonrails.org/classes/ActionController/Base.html#M000633)

# c++ - 在 Visual Studio C++ 构建中打印日期和时间？

> ID：602936
> 
> 赞同：9
> 
> 时间：2009-03-02T16:21:07.820
> 
> 标签：c++, visual-studio, datetime, compiler-construction

为了构建的目的，我将如何打印日期和时间。即：当我的应用程序的控制台启动时，我想这样做：

> ```
> Binary Build date: 03/03/2009 @ 10:00AM 
> ```

我认为这对于所有应用程序在后台对程序员来说都是一个非常有用的功能，尤其是在团队环境中。

有没有一种简单的方法可以在 C++ 中使用 Visual Studio 2008 来做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T16:30:30.000

使用预处理器`__DATE__`和`__TIME__`.

```
printf("Binary build date: %s @ %s\n", __DATE__, __TIME__); 
```

为了确保包含此代码的 cpp 文件被真正编译，我使用 touch-utility for file 作为预构建步骤：touch file.cpp

触摸.bat：

```
@copy nul: /b +%1 tmp.$$$
@move tmp.$$$ %1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T16:26:29.587

您可以使用宏`__TIME__`和`__DATE__`. 注意双下划线。这些在编译时展开，因此您将获得保存在文件中的最后编译时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T16:33:52.173

请注意，时间和日期宏只有在包含它们的特定文件保证在每次构建期间都被编译时才能按需要工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:26:48.603

一种方法是使用内置`__DATE__`和`__TIME__`宏。来自 MSDN（对于 VS 2005）：

> `__DATE__`：当前源文件的编译日期。日期是 Mmm dd yyyy 形式的字符串文字。月份名称 Mmm 与 TIME.H 中声明的库函数 asctime 生成的日期相同。
> 
> `__TIME__`：当前源文件的最近编译时间。时间是 hh:mm:ss 形式的字符串文字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-05T22:14:10.903

与 Virne 的回答类似，我创建了一个名为“BuildDate.h”的简单头文件，其内容如下：

```
#define BUILD_DATE __DATE__ " " __TIME__ 
```

I touch the file using [GnuWin32](http://gnuwin32.sourceforge.net/) touch command in my pre-build event:

```
touch.exe BuildDate.h 
```

Then I include the header file in any code where I want access to the `BUILD_DATE` string. E.g.:

```
#include "BuildDate.h"
...
logger->Log("Build Date: " BUILD_DATE); 
```

# c++ - 使用来自 cygwin 的 g++ C++ 编译器

> ID：602937
> 
> 赞同：8
> 
> 时间：2009-03-02T16:21:22.907
> 
> 标签：c++, cygwin, g++

我正在尝试执行我的第一个“Hello World！” 在 C++ 中。我使用的是 Windows XP，并且我已经安装了 cygwin，其中安装了 g++ C++ 编译器。我写了一个小 hello-world 程序，并保存在 hello.cpp 中。从命令提示符我写：

> g++你好.cpp

但我得到：

> 'g++' 不是内部或外部命令、可运行程序或批处理文件。

我已经在我的 D:\programs\cygwin 中安装了 cygwin。我在 D:\cpp 中用我的 hello-world 文件创建了另一个目录。我的安装或路径似乎不太好，但我不知道是什么。我已经运行了 cygwin 的 exe 文件，并且在安装目录中我得到了所有必要的文件，我认为：bin 文件夹、lib、Cygwin.bat 等。

我已经阅读过，如果出现此类错误消息，我应该检查 cygwin1.dll 文件是否已复制到 Windows 的主文件夹中。这是 C:\WINDOWS 目录吗？我看过那里，我那里没有这样的文件。我在cygwin的bin文件夹中有cygwin1.dll：D:\programs\cygwin\bin。另外，如何检查命令的搜索路径中是否考虑了 bin 文件夹（D:\programs\cygwin\bin）？

我认为 hello-world 程序不应该包含任何语法错误，我只是复制了它。另外，当我写

g++ -v

我收到相同的错误消息：该命令无法识别。如果有人给我提示我应该看什么，我将不胜感激。谢谢你。

下面是 hello-world 程序的代码：

```
#include <iostream>
using namespace std;

int main() {
  cout <<"Hello World!"<<endl;
  return 0;
} 
```

我已经安装了 g++，现在当我输入 g++ -v 时，我得到：Reading specs from: \d\cygnus\cygwin-b20\H-i586-cygwin32\bin..\lib\gcc-lib\i586-cygwin32\ egcs-2.91.57\specs gcc 版本 egcs-2.91.57 19980901（egcs-1.1 版本）

在 bin 目录中，我有 g++.exe 和 gcc.exe。我不明白为什么我在上面得到“gcc”而不是“g++”。我不知道这有多重要，但是当我尝试在 DOS 命令提示符下编译程序时收到错误消息：

### g++你好.cpp

我得到：

```
hello.cpp:1: parse error before character 0357
hello.cpp: In function 'int main()':
hello.cpp:'cout' undeclared (first use this function)
hello.cpp: (Each undeclared identifier is reported only once
hello.cpp: for each function it appears in.)
hello.cpp: 'endl' undeclared (first use this function) 
```

这是我尝试在 cygwin shell 中编译程序时得到的结果：

```
hello.cpp:1: parse error before character 0357
hello.cpp: In function 'int main()':
hello.cpp:'cout' undeclared (first use this function)
hello.cpp: (Each undeclared identifier is reported only once
hello.cpp: for each function it appears in.)
hello.cpp: 'endl' undeclared (first use this function)
g++.exe: hello.cpp: No such file or directory
g++.exe: No input files
g++.exe: hello.cpp: No such file or directory
g++.exe: No input files
g++.exe: hello.cpp: No such file or directory
g++.exe: No input files
g++.exe: hello.cpp: No such file or directory
g++.exe: No input files
g++.exe: hello.cpp: No such file or directory
g++.exe: No input files 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:27:16.857

正如人们所说，检查路径。不要开始复制 cygwin DLL - 这不是必需的，以后可能会出现问题并且不会解决问题。

在设置 Windows PATH 变量（和其他变量）时，我发现[这个小程序](http://www.rapidee.com/en/about)非常有用，而且比眯着眼看 MS 控制面板 aplet 更好。

**编辑：**似乎 OP 错误地没有安装 g++ - 对于我们所有人来说都是一个教训，他们首先回答了这个明显的问题 :-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T17:05:43.720

啊，我以为安装cygwin的时候就安装了g++。所以，在这种情况下，我实际上应该首先安装 g++，不是吗？

（然后重新启动）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:24:22.417

我假设您在这里使用的是 Windows Shell。如果您从 cygwin Bash shell 调用编译器，则应为您设置所有路径。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:25:55.627

几年前我写了一个关于这个的教程，这可能会有所帮助：

[http://www.codeguru.com/cpp/misc/misc/compilerandpre-compiler/print.php/c8107__1/](http://www.codeguru.com/cpp/misc/misc/compilerandpre-compiler/print.php/c8107__1/)

你安装了g++吗？Cygwin 安装程序的默认设置未安装它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T16:44:52.740

确保它在路径上，或者您正在运行 bash shell cmd 提示符。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T17:18:46.497

你确定你安装了g++？G++ 是 C++ 编译器，而不是 C 编译器。如果你只安装了 C 编译器，你会得到命令**gcc**而不是命令**g++**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T16:22:31.657

确保它们 c:\cygwin\bin 在 PATH 中。

希望能帮助到你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T16:28:02.923

在 cygwin 中获取路径：

```
echo $PATH 
```

这将使我们走上理解问题的道路。

**编辑**：

下一个命令将告诉我们 cygwin 认为它应该在 Windows 中查找所有这些文件的位置

```
mount 
```

包含 /usr/bin 的行是我们需要复制的行。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T17:10:41.837

调出dos shell。

cd c:\cygwin\bin

输入 c++ 或 cpp

或执行目录命令查看内容。寻找 cpp 或 c++。

如果他们不在那里，你还没有下载它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T16:29:28.440

除了将其添加到路径（这将解决您的问题）之外，您可能还需要下载 make 和 dbg，它们也在开发路径上，但默认情况下未选中。确保选择“保留”作为整体安装选项，这样它就不会重新下载所有内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T17:02:46.957

正如其他人提到的，这可能是路径问题，因此您需要查看环境变量 PATH。为此，请右键单击`My Computer`并单击“属性”。转到“高级”选项卡，然后单击“环境变量”按钮。从这里，查看您提到的路径是否包含在 PATH 变量中。如果不是，请使用您在此处看到的相同语法添加它们以分隔路径（我认为它是路径之间的分号或冒号。）

**编辑：**啊，我看到你已经这样做了（比我的帖子快了几秒钟。）我认为你现在需要做的就是重新启动。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-07T00:01:04.063

尝试创建一个新文件并自己输入代码，而不是复制和粘贴它。您的代码中可能有一个非法字符，在您选择的编辑器中可能看不到。

# java - “修复” SWT 表中的前几列以防止它们水平滚动

> ID：602939
> 
> 赞同：1
> 
> 时间：2009-03-02T16:22:23.980
> 
> 标签：java, swt

我们已经使用 SWT 树表实现了一个基于表的编辑器。它几乎可以满足我们的要求，只是我们无法找到一种方法来确保当用户水平滚动时前几列保持在其位置（以便人们可以识别正在编辑的行）。

有许多第三方表格控件在不同程度上不完整或被遗弃，还有一个片段显示了如何使用两个表格（垂直滚动时它们会不同步）。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T22:21:16.347

至少在我的机器上，这个“官方”SWT[片段](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet234.java?view=co)可以完成您想做的事情 - 它不会在垂直滚动时不同步。但价格是第二个滚动条 - 很难看。为了防止这种情况，您可以`SWT.NO_SCROLL`在左表的构造函数中添加样式。

为了改进这件事，您必须在`SWT.Traverse`两个表上添加一个侦听器，如果用户使用键导航，它会同步它们，如下所示：

```
 leftTable.addListener(SWT.Traverse, new Listener() {

     public void handleEvent( Event event ) {
        rightTable.setTopIndex(leftTable.getTopIndex());
     }
  }); 
```

我不会使用另一个 Table 实现，因为您失去了使用 SWT 的最大优势：使用本机小部件，它在每个操作系统中看起来和感觉都“正确”。无论如何，如果你想这样做，来自 Nebula 项目的[Grid](http://www.eclipse.org/nebula/widgets/grid/grid.php)比 alpha 标签所暗示的要成熟得多。不过，不知道它是否可以做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T20:25:36.430

“同步问题”仅出现在基于 MacOs 的 SWT 上。如果您的目标平台是 windows，那么给定的 SWT-Snippet 应该没有问题。将有更多的监听器在两个表上注册，以同步所有发生的事件（折叠、展开、鼠标滚动等）

# mysql - MySQL查询为每一行分配一个唯一的随机数

> ID：602952
> 
> 赞同：12
> 
> 时间：2009-03-02T16:24:36.753
> 
> 标签：mysql, random

我希望将一列附加到我的表中，该列将是顺序列表中的随机数 = 到行数。

因此，如果我的表有**999 行**，那么**数字 1 到 999 将被随机且唯一地分配**。

现在，我想我可以添加一个虚拟 TempRandomColumn=Rand()，按此排序并使用 PHP 按顺序添加数字。但这意味着 999 条 MySQL 语句。

有没有办法使用单个 MySQL 语句来做到这一点？

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-02T16:30:53.197

```
SET @r := 0;
UPDATE  items2
SET     author_id = (@r := @r + 1)
ORDER BY
        RAND() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:38:44.533

```
SET @i=1;
SELECT t.*, @i:=@i+1 as RAND_NUM FROM your_table t ORDER BY RAND(); 
```

# sql - 有没有办法将 SQL 脚本导入 Visual Studio 中的 MDF 数据库？

> ID：602954
> 
> 赞同：3
> 
> 时间：2009-03-02T16:25:39.293
> 
> 标签：sql, visual-studio, visual-studio-2008, sql-server-2008

我在 Visual Studio 中创建了一个“基于服务的数据库”（.MDF），现在想将 SQL 脚本导入其中，但找不到任何方法：

*   我可以右键单击 .mdf 文件并选择“新查询”，但没有像在 Management Studio 中那样复制查询文本的地方

Visual Studio 2008 数据库资源管理器是否可以输入或导入 SQL 查询文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-18T21:28:23.137

当您选择“新建查询”时，默认行为是打开查询编辑器。所以你必须关闭添加表。之后，您应该会看到一个包含四个窗格的窗口——图表、条件、SQL 和结果窗格。您应该能够将脚本放到 SQL 窗格中并从中运行。Studio 可能会抱怨无法解析脚本，忽略它并点击确定，脚本应该运行。

如果看不到这些窗格，请确保启用了“查询设计器”工具栏并按下了“SQL 窗格”按钮。

但是，我建议安装 SQL Management Studio，有一个免费的快速版本可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-11T15:47:06.643

为什么不直接将数据库附加到 SQL Server（或 SQLExpress），然后复制数据库对象。再次与 sql server 分离。

# asp.net-mvc - MVC Action 是否必须返回 actionResult？

> ID：602956
> 
> 赞同：2
> 
> 时间：2009-03-02T16:25:59.573
> 
> 标签：asp.net-mvc, actionresult

我的控制器中所谓的动作可以只是一个常规函数，它返回我想要的任何东西，还是 ActionResult 的返回声明它是否是一个“动作”？

我想知道是否可以在未返回的“actionname”中调用 ActionLink 中的函数`actionresults`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T16:39:40.007

默认情况下，控制器的所有公共方法都是操作，无论返回类型如何。所以，是的，你可以打电话给他们。使用 [NonActionAttribute] 覆盖此默认值。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-02T16:43:15.070

是的，所有操作都应该返回一个 ActionResult。MVC 引擎只知道处理 ActionResult（或派生类）。

我不明白“在我的 ActionLink 中调用不返回 ActionResults 的函数”是什么意思。即使你不想返回任何意义，你仍然必须返回一个 ActionResult。

你想完成什么？

# forms - Acrobat 的交互式 PDF 创建替代方案？

> ID：602977
> 
> 赞同：7
> 
> 时间：2009-03-02T16:29:31.747
> 
> 标签：forms, pdf, pdf-generation

Adobe Acrobat 有什么好的替代品来创建交互式 PDF 吗？这里的术语有点模糊——交互式，我的意思是“可以填写”，不一定是“可编写脚本的”。所以这个表格将用于数据收集，而不是报告生成，这似乎是关于 SO 的 pdf 相关问题的常见场景。

诀窍是它们需要使用 Adob​​e Reader 进行填充。对于那些没有经历过 Acrobat 的许多挫折的人 - 默认情况下，除非它是使用 Acrobat Pro >8.0 创建的并且特别启用了使用权限，否则 Reader 无法填写表单。没关系，它基本上可以工作（除了 Pro 用户无法保存*他们的*数据 - WTF？）。

因为我感到沮丧，所以我最好完全避免使用 Adob​​e 产品（即在设计方面，对于用户来说，阅读器仍然是必需品，或者我只是将它作为一个 db 支持的 Web 表单来做）。我想知道是否有人对替代品有很好的经验？是软件库还是产品？

谢谢！

编辑 - 谢谢，马特 b - 我以前见过 iText，但不知道它可以创建表单。不幸的是，Reader 似乎无法*将*填写的数据保存到 iText 生成的表单（或 OO Writer 生成的表单）。我有一种讨厌的感觉，我想要的东西根本不可能，除非使用 Adob​​e 自己的权限管理工具。如果有其他想法。我很想听听他们的意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T10:32:19.377

开源页面布局工具[Scribus](http://www.scribus.net/)具有许多面向创建交互式 PDF 表单的功能。我没有亲自使用过它们，但它们看起来相当完整，并且在本教程中有所介绍。

如果您在任何情况下都需要进行认真的页面布局，Scribus 值得了解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T15:33:41.840

**您可以使用OpenOffice.org**和**LibreOffice**创建可填写的 PDF 表单。

要在 *.odt 文档中创建初始表单元素，请启用*View* --> *Toolbars* --> *Form Controls*工具，它允许您向页面添加可点击的复选框 + 单选按钮、可填充的文本字段、按钮等等（s ）。

完成文档后，使用*文件*-->*导出为 PDF*并启用复选框*创建 PDF 表单*。

现在，您的 PDF 表单将可以使用任何非 Adob​​e PDF 查看器进行编辑（并且可以保存！）。

**但是请注意：** Adobe 使用自己的专有方式来创建和填写 PDF 表单。Adobe Reader 仅支持填写由 Adob​​e 产品创建的 PDF 表单（并且已被分配“扩展权限”，因此 Reader 确实可以将表单数据与文档一起保存）。

Adobe Reader 不适用于您使用 OpenOffice.org 或 LibreOffice 创建的 PDF 表单（“工作”的含义是：“允许您填写+保存表单数据”。）。这背后的技术机制是 Adob​​e 使用自己的密钥对表单文档进行数字签名（Adobe Reader 知道，并且您在接受 Adob​​e Reader EULA 时同意不进行逆向工程......）。--

这表示：

*   非 Adob​​e PDF 阅读器将无法“填充+保存”使用 Adob​​e 产品创建的表单（但他们可以“填充+打印”它们）。
*   Adobe PDF 阅读器将拒绝“填充+保存”使用非 Adob​​e 产品创建的表单（但他们会“填充+打印”它们）。

对于该问题的其他答案中提到的*所有*工具和实用程序，后两点都是正确的。如果我在这里弄错了，请在评论中告诉我...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:31:44.630

[iText](http://www.lowagie.com/iText/)几乎是 Java 世界中以编程方式生成 PDF 文件的标准。也许它也可以用来创建您想要的带有表单的 PDF？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T21:47:05.697

XSL FO 是我们用来从现有表单数据创建 PDF 文件的东西。除非您希望将可填写的 pdf 发送给客户端，否则这是一个有效的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T16:20:47.940

IText lets you create Annotations (there are essentially 3 types of 'interactive' components - forms (old style FDF and new XFA) and Annotations. Acrobat and lots of third party tools should let you modify the Annotations values.

There is also a DotNet version of IText called ISharp - both are freeand extremely powerful.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T14:48:22.250

Foxit reader allows you to save *any* pdf with the filled in fields.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T19:34:07.877

CutePDF Pro 允许您将 PDF 转换为交互式表单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-10T01:56:13.047

我最近涉足了 Scribus。如果有人有足够的时间来配置和使用它，我发现它是一个很好的工具。我强烈推荐它。五福也很好。

我不是 Acrobat / Adob​​e 的粉丝。软件应该让我的生活更轻松，而不是每一步都挑战我。

如果您使用这些关键字搜索网络 - FREE FORM CREATOR，您可以添加单词 HTML5。您会发现一系列网站，您可以在其中在线登录，所有客户都可以单独登录，填写数据，表格保留在云端并整理您的硬盘。所有利益相关者都可以随时访问表格并进行编辑。该帐户可用作您业务的文件夹。这些表格可以在任何设备和任何平台上访问。

其中许多表单都是 HTML5 驱动的，它们非常漂亮和流畅。远离宏，它们携带病毒。

www.homebasedofficeservices.com

# c# - 您可以在 C# 中使用 XPath 将 xml 文档过滤到节点的子集吗？

> ID：602987
> 
> 赞同：2
> 
> 时间：2009-03-02T16:31:32.447
> 
> 标签：c#, xml

我正在尝试使用 XPath 将 Xml 文档过滤为自身的子集。

我已经使用 XPath 获取了一个 XmlNodeList，但我需要将其转换为 XML 文档。

有没有办法将 XMLNodeList 转换为 XmlDocument 或通过直接过滤另一个 XmlDocument 来生成 XmlDocument？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T16:36:07.800

使用 XmlDocument，您需要将这些节点导入到第二个文档中；

```
 XmlDocument doc = new XmlDocument();
    XmlElement root = (XmlElement)doc.AppendChild(doc.CreateElement("root"));
    XmlNodeList list = // your query
    foreach (XmlElement child in list)
    {
        root.AppendChild(doc.ImportNode(child, true));
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T09:42:52.543

这是使用 XSLT 的一个非常典型的原因，它是一种高效而强大的工具，用于将一个 XML 文档转换为另一个（或 HTML 或文本）文档。

这是一个执行 XSLT 转换并将结果发送到控制台的最小程序：

```
using System;
using System.Xml;
using System.Xml.Xsl;

namespace XsltTest
{
    class Program
    {
        static void Main(string[] args)
        {
            XslCompiledTransform xslt = new XslCompiledTransform();
            xslt.Load("test.xslt");

            XmlWriter xw = XmlWriter.Create(Console.Out);
            xslt.Transform("input.xml", xw);
            xw.Flush();
            xw.Close();

            Console.ReadKey();
        }
    }
} 
```

这是实际的 XSLT，它保存在`test.xslt`程序目录中。这很简单：给定一个顶级元素名为 的输入文档`input`，它会创建一个`output`元素并复制每个`value`属性设置为的子元素`true`。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/input">
      <output>
        <xsl:apply-templates select="*[@value='true']"/>
      </output>
    </xsl:template>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

这是`input.xml`：

```
<?xml version="1.0" encoding="utf-8" ?>
<input>
  <element value="true">
    <p>This will get copied to the output.</p>
    <p>Note that the use of the identity transform means that all of this content
    gets copied to the output simply because templates were applied to the 
    <em>element</em> element.
  </p>
  </element>
  <element value="false">
    <p>This, on the other hand, won't get copied to the output.</p>
  </element>
</input> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T16:34:23.093

我实际上只是想到了一种方法来做到这一点，但它似乎不是很优雅。

使用 StringBuilder 组合 XmlNodeList 中每个 XmlNodes 的 OuterXml ...

正如我所说，它不优雅，但我认为它可能会起作用。我会很感激任何其他建议...

# project-management - 您如何应对设计复杂性？

> ID：602990
> 
> 赞同：8
> 
> 时间：2009-03-02T16:31:52.773
> 
> 标签：project-management, complexity-theory

我经常发现自己在与过度工程作斗争——负责设计软件的人提出的架构过于复杂。

拥有所有用户永远不会知道的深奥功能并获得成就感，当您做所有杂志文章都告诉您的最新，很酷的事情时，这一切都很好，但我们将花费我们在这座纪念碑上的一半工程时间是为了我们的聪明才智，而不是，你知道，我们的用户和高层管理人员期望在合理或至少有限制的时间框架内完成的实际产品。

当你开始用完时间时，你可能只需要恢复到更简单的解决方案，也就是说，如果你有机会的话。

我们都听过这样的副歌：保持简单，愚蠢™。

您如何应对团队中的过度复杂性？

* * *

最近我不得不反复使用的一个例子是，当决定采用完全非规范化的数据库设计而不是 RDBMS 时。“因为它更快！” 完全非规范化的数据库真的很难做到正确，并且只适用于像 Flickr 或 ebay 这样的真正专业的数据问题，并且相对于您的其余开发，这在开发人员时间方面可能非常昂贵。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T16:38:18.687

牙齿和指甲，有时你会失去。问题是总是很容易被诱惑去构建一些*很酷*的东西。

> *既然可以复杂而美妙，为什么还要构建简单而高效的东西呢？*

尝试提醒人们构建可能可行的最简单的东西的 XP 规则。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-02T17:38:35.233

确保从其他人那里获得任何想法。通常，我们如此专注于以某种方式做事，以至于需要另一双眼睛才能让你正确。有很多次，我通过让其他人说“我们*真的*需要那个吗？”来解决难题。这有助于使我的代码更简单。

关于与你不同意的人打交道，沃德坎宁安有一个很好的观点：

> 当我意识到我不必赢得所有争论时，这是我编程生涯的一个转折点。我会和某人谈论代码，我会说，“我认为最好的方法是 A。” 他们会说，“我认为最好的方法是 B。我会说，“不，这真的是 A。”他们会说，“好吧，我们想做 B。”当我可以说：“好吧。做 B。如果我错了，它不会对我们造成太大伤害。如果我是对的而你做 B，这不会对我们造成太大伤害，因为我们可以纠正错误。所以让我们看看它是否是一个错误。... 通常结果是 C。这对我们俩来说都是一次学习经历。如果我们在没有经验的情况下做出决定，我们都不会真正学到东西。沃德赢了，而其他人没有。或相反亦然。这是一场太多的战斗。为什么不说，“好吧，让我们编写代码，看看会发生什么。如果它不起作用，我们会改变它。”

我的建议？如果你想做更好的事情，想出一个简单的原型来证明它更好。意见很好，但代码会说话。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T17:16:40.980

我在某处看到过这个公式：

[技能=问题的复杂性/解决方案的复杂性 http://img39.imageshack.us/img39/1586/whatisskill.png](http://img39.imageshack.us/img39/1586/whatisskill.png)

换句话说，它需要技巧来为复杂问题创建简单的解决方案。如果有人故意设计并以复杂的过度设计解决方案为荣，那么他在不知不觉中无能。

就个人而言，帮助我保持设计简单的是 TDD 循环。首先编写一个测试来指定您要达到的目标，然后生成[“可能工作的最简单的东西”](http://www.xprogramming.com/practices/pracsimplest.htm)。并且时不时地反思一下你制作的东西，并思考如何让它变得更简单。

Never build extra flexibility and abstraction layers into the system, until it is required by something that you have now. Changing the code is easy, when you have a good unit test suite, so you can add those abstraction layers later, when the need arises, *if* it ever arises. Otherwise, ["you ain't gonna need it"](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It).

Some symptoms of too complex design are when writing tests is complicated. If the tests require a long setup code, maybe you have too many dependencies or in some other way too much complexity. If you run into concurrency bugs, then maybe you should think about how to design the system so that concurrency is restricted to the absolute minimum number of classes. Maybe use a message-passing architecture, such as the Actor model, and make practically every component single-threaded, even though the system as a whole is multi-threaded.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T16:48:33.480

至少对我来说，更大的问题是，由于其流行语友好、杂志企业的优点，通常很难说出其中有什么功能，而其中有哪些功能是因为它增加了一定程度的灵活性，在未来会有用。

研究表明，人们通常很难预测未来的复杂性以及当前决策的副作用。不幸的是，这并不总是意味着最简单就是最好的——就我而言，有很多事情一开始我认为太复杂了，直到很久以后（呃......春天）才看到它的价值。还有一些我认为是有道理的事情，结果被证明过于复杂（EJB1）。所以我知道我对这些事情的直觉是错误的。

最好的选择——任何类型的间接层都应该得到支持它增加的灵活性的价值与增加的开发复杂性的论据。

但是，在抽象的基础上教条地维护特定数据库设置的人可能属于“构建它，因为我读到它是正确的”阵营。这可能不切实际，但是如果您构建了一个测试版本和基准测试，有些人可能会相信，特别是如果结果显示更多的努力导致性能提升微不足道。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-02T17:01:25.773

> 拥有用户永远不会知道的所有深奥的功能，这一切都很好，而且......

这将是[功能蠕变](http://en.wikipedia.org/wiki/Feature_creep)，而不是不必要的复杂设计。它与您在数据库上的示例不同。

> 最近我不得不反复使用的一个例子是，当决定采用完全非规范化的数据库设计而不是 RDBMS 时。“因为它更快！”

在这种情况下，可能会发生几件事。其中之一是，你可能错了，这些人可能真的知道他们在说什么，因为他们使用了非常相似的例子。另一个是他们可能是错误的，即他们的设计没有提供他们声称的速度优势。在这种情况下，可能有两种不同的情况：（1）他们在设计中过于重视速度，或者（2）速度真的很关键。如果速度确实如此重要，那么团队不应该仅仅依赖于假设——他们应该尝试不同的原型并评估他们在关键路径中的速度。您不会仅仅“因为它更快”而以一种方式制造 F1 赛车，而是不断尝试几种替代设计解决方案，并选择速度最快且仍不会增加太多维护成本的解决方案。

有时你可以争论并达成协议，有时你不能。这是生活。

不过，最后一句话。**你不会*对抗*复杂性。你对待它。**你确定真正重要的事情并采取相应的行动。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T16:43:23.867

我假设您的意思是“完全非规范化的数据库设计，而不是规范化的（例如，第三或第四范式）模型”，因为关系模型由 RDBMS 管理，而不管它的规范化程度如何。

如果不了解更多关于您的要求、您的能力和您的队友的能力，就无法判断。

我担心你的 KISS 警告在这种情况下可能不起作用，因为一个大的、非规范化的表可能会被认为是最简单的东西。

有人如何解决这些问题？沟通、说服、更好的数据、替代技术和技术的原型。这就是软件开发如此困难的原因。如果只有一种方法可以做这些事情，并且每个人都同意它们，我们真的可以编写脚本或让任何人开发系统并完成它。

获取一些数据。你的话可能还不够。如果一个快速原型可以证明您的观点，请创建它。

“强烈的意见，轻举妄动”应该是你的座右铭。

有时一个技术点不值得疏远整个团队。有时是的。你的来电。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-02T17:34:13.667

您可以通过以下几种方式与**其他人的**过度设计/功能蠕变作斗争：

1.  根据实际用户需求请求功能优先级。为 Alpha 和 Beta 测试人员模拟功能，并询问他们是否愿意为此延迟 N 个月。

2.  积极重构以避免特殊情况。适当时将代码分解为层或模块化组件。在“现在可以正常工作”和“以后易于扩展”之间找到平衡点。

3.  当您不同意设计决策、准备被否决并接受决策时，请通知您的管理层。不要越过任何人的头脑或破坏代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T18:45:19.613

我发现最好的方法是无情地问——一次又一次——“我们试图解决的业务问题是什么”和“这个决定如何帮助解决这个问题”。

我发现人们经常跳到解决方案上，而不是清楚地知道问题是什么。

因此，在您关于如何组织数据库的示例中，我的问题是“我们认为这个项目今天、下个月、明年、五年后的交易要求是什么”。花大量时间来正确构建数据模型可能是有意义的，这可能是浪费时间。在明确问题定义之前，您不知道参数是什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T16:39:16.483

您可能患有“团队中有太多架构师”综合症。最多一两个人应该设计/架构一个系统，该系统将由 5 到 10 人的团队进行编码。欢迎大家提出意见，但架构决策者应该很少且经验丰富。

（数字是半随机的，也可能因其他因素而有所不同）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T16:39:29.603

我在讨论问题时尽量保持开放。但是当我和别人在一件看似简单的事情和另一件复杂的事情之间进行讨论时，我会变得很固执。只要您从一个决定到另一个决定非常连贯，它就会有很大帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T17:18:12.240

您的示例实际上并不是一个复杂的设计，而是您不同意的设计选择。由于您正在编写代码，因此您很可能是正确的，因为其中许多决定是由阅读文章中的文章并认为这听起来像是一个好目标的人做出的，或者该决定可能是由遇到的人做出的之前的问题，并试图防止它再次发生。

就个人而言，我做过很多简单的事情，也做过很多困难的事情，当我选择用简单的方式而不是艰难的方式做某事时，我从不快乐。现在我学会了诸如“永远不要传递裸体系列，总是把它包裹在商务舱中”这样的技巧。

如果我要向没有经历过相同经历的人解释其背后的原因，直到他们尝试将“简单方法”与“困难方法”进行几次比较后，他们才会理解。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T17:23:29.497

解决方案不应该比问题更复杂。

这个问题与本质复杂性的思想交织在一起。排序*必须*触及每个元素，就其本质而言。考虑到存在的技术限制，它必须变得复杂多少才能解决问题？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-02T17:24:35.330

相关人员是否有足够的时间和动力来找到简单的解决方案？不小心，复杂性会增加。如果您花费大部分时间尝试尽可能快地修复错误或添加功能，那么说“保持简单”是不够的。

确保团队中有一些因维护大程序而受过战争创伤的人，以及有重构经验的人，然后给他们时间整理软件。如果您可以安排某些功能和机会超出范围，那将有助于人们删除不需要的代码。如果你想要一个度量标准，目标是减少代码行数；但尽量不要沉迷于此。提高测试覆盖率；考虑消除难以测试的代码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-02T17:34:03.403

不要试图一口气做所有事情。将每个问题/任务分解成可管理的块。然后优先考虑，记住 KISS 和 YAGNI。这将帮助您专注于构建您*需要*的东西。如果你做得对，你将拥有一个很好的核心，你可以在以后添加时间、金钱、资源和灵感。

# ruby - 当一个变量超出范围时，这是否意味着它不存在？

> ID：602991
> 
> 赞同：4
> 
> 时间：2009-03-02T16:32:10.337
> 
> 标签：ruby, variables, scope

我不确定我是否理解范围 - 范围外的变量（我正在使用 Ruby）是否存在于内存中的某个地方，或者它是否停止存在（我知道你无法访问它）。**说一个超出范围的变量不再存在是不准确的吗？**

也许这是一个哲学问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T17:40:35.400

If you are using managed language then you don't allocate and unallocate memory so as far as you are concerned it no longer exists.

Technically it does but GCs tend not to be deterministic so technically it's hard to say when it actually vanishes.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T17:24:15.360

变量与其所持有的值不同。

当变量超出范围时，变量本身将不复存在。变量持有的*值*可能代表一个对象，并且该对象可能在变量的生命周期之后继续存在。垃圾收集器稍后会回收该对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:35:23.450

当它超出范围时，它仍然存在（从某种意义上说，它分配了一些内存）一段时间，直到垃圾收集清理它。但正如您所暗示的那样，它已经失去了它的名字并且无法到达。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:36:58.157

当变量超出范围时，周围是否有人听到它的尖叫声？

这不是一个红宝石问题，而是一个关于垃圾收集的一般问题。在 Ruby 或 C# 等垃圾收集语言中，当变量超出范围时，它会以某种方式被标记为不再使用。发生这种情况时，您将无法再使用它，它会四处转动拇指-但它仍然分配有内存。

在某个时候，垃圾收集器会唤醒并查找标记为未使用的变量。它会处理掉它们，到那时它们就不再存在于记忆中了。

它可能比这更复杂，这取决于垃圾收集器的工作方式，但它已经足够接近了:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T16:34:55.153

它存在一段时间，直到垃圾收集器处理它（如果可以的话）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T17:37:15.937

Rob Kennedy 对此进行了适当的回答，但我想我会添加更多细节。

要认识到的重要一点是变量与其所代表的值之间的差异。

这是一个示例（在 C# 中，因为我不了解 Ruby）：

```
object c = null;
if (1 == 1) // Just to get a different scope
{
    var newObj = new SomeClass();
    newObj.SomeProperty = true;
    c = newObj;
} 
```

在上面的代码中，newObj 在 if 语句的末尾超出了范围，因此“不存在”，但它所引用的值仍然存在并且被 c 引用。一旦对对象的所有引用都消失了，垃圾收集器将负责清理它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T22:09:36.907

If you're talking about file objects, it becomes more than a philosophical question. If I recall correctly, files do not close automatically when they go out of scope - they only close if you ask them to close, or if you use a `File.open do |file|` style block, or if they get garbage collected. This can be an issue if other code (or unit tests) try to read the contents of that file and it hasn't yet been flushed.****************``***